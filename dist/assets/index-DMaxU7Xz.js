var eY=Object.defineProperty;var tY=(t,s,n)=>s in t?eY(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n;var Dw=(t,s,n)=>tY(t,typeof s!="symbol"?s+"":s,n);function l6(t,s){for(var n=0;n<s.length;n++){const a=s[n];if(typeof a!="string"&&!Array.isArray(a)){for(const i in a)if(i!=="default"&&!(i in t)){const l=Object.getOwnPropertyDescriptor(a,i);l&&Object.defineProperty(t,i,l.get?l:{enumerable:!0,get:()=>a[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(i){if(i.ep)return;i.ep=!0;const l=n(i);fetch(i.href,l)}})();var am=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Mi(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var o6={exports:{}},rb={},c6={exports:{}},es={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fx=Symbol.for("react.element"),sY=Symbol.for("react.portal"),nY=Symbol.for("react.fragment"),rY=Symbol.for("react.strict_mode"),aY=Symbol.for("react.profiler"),iY=Symbol.for("react.provider"),lY=Symbol.for("react.context"),oY=Symbol.for("react.forward_ref"),cY=Symbol.for("react.suspense"),dY=Symbol.for("react.memo"),uY=Symbol.for("react.lazy"),kE=Symbol.iterator;function hY(t){return t===null||typeof t!="object"?null:(t=kE&&t[kE]||t["@@iterator"],typeof t=="function"?t:null)}var d6={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},u6=Object.assign,h6={};function yf(t,s,n){this.props=t,this.context=s,this.refs=h6,this.updater=n||d6}yf.prototype.isReactComponent={};yf.prototype.setState=function(t,s){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,s,"setState")};yf.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function f6(){}f6.prototype=yf.prototype;function bC(t,s,n){this.props=t,this.context=s,this.refs=h6,this.updater=n||d6}var vC=bC.prototype=new f6;vC.constructor=bC;u6(vC,yf.prototype);vC.isPureReactComponent=!0;var AE=Array.isArray,m6=Object.prototype.hasOwnProperty,wC={current:null},p6={key:!0,ref:!0,__self:!0,__source:!0};function x6(t,s,n){var a,i={},l=null,o=null;if(s!=null)for(a in s.ref!==void 0&&(o=s.ref),s.key!==void 0&&(l=""+s.key),s)m6.call(s,a)&&!p6.hasOwnProperty(a)&&(i[a]=s[a]);var c=arguments.length-2;if(c===1)i.children=n;else if(1<c){for(var d=Array(c),u=0;u<c;u++)d[u]=arguments[u+2];i.children=d}if(t&&t.defaultProps)for(a in c=t.defaultProps,c)i[a]===void 0&&(i[a]=c[a]);return{$$typeof:fx,type:t,key:l,ref:o,props:i,_owner:wC.current}}function fY(t,s){return{$$typeof:fx,type:t.type,key:s,ref:t.ref,props:t.props,_owner:t._owner}}function NC(t){return typeof t=="object"&&t!==null&&t.$$typeof===fx}function mY(t){var s={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return s[n]})}var EE=/\/+/g;function Ow(t,s){return typeof t=="object"&&t!==null&&t.key!=null?mY(""+t.key):s.toString(36)}function bg(t,s,n,a,i){var l=typeof t;(l==="undefined"||l==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(l){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case fx:case sY:o=!0}}if(o)return o=t,i=i(o),t=a===""?"."+Ow(o,0):a,AE(i)?(n="",t!=null&&(n=t.replace(EE,"$&/")+"/"),bg(i,s,n,"",function(u){return u})):i!=null&&(NC(i)&&(i=fY(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(EE,"$&/")+"/")+t)),s.push(i)),1;if(o=0,a=a===""?".":a+":",AE(t))for(var c=0;c<t.length;c++){l=t[c];var d=a+Ow(l,c);o+=bg(l,s,n,d,i)}else if(d=hY(t),typeof d=="function")for(t=d.call(t),c=0;!(l=t.next()).done;)l=l.value,d=a+Ow(l,c++),o+=bg(l,s,n,d,i);else if(l==="object")throw s=String(t),Error("Objects are not valid as a React child (found: "+(s==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":s)+"). If you meant to render a collection of children, use an array instead.");return o}function s0(t,s,n){if(t==null)return t;var a=[],i=0;return bg(t,a,"","",function(l){return s.call(n,l,i++)}),a}function pY(t){if(t._status===-1){var s=t._result;s=s(),s.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=s)}if(t._status===1)return t._result.default;throw t._result}var la={current:null},vg={transition:null},xY={ReactCurrentDispatcher:la,ReactCurrentBatchConfig:vg,ReactCurrentOwner:wC};function g6(){throw Error("act(...) is not supported in production builds of React.")}es.Children={map:s0,forEach:function(t,s,n){s0(t,function(){s.apply(this,arguments)},n)},count:function(t){var s=0;return s0(t,function(){s++}),s},toArray:function(t){return s0(t,function(s){return s})||[]},only:function(t){if(!NC(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};es.Component=yf;es.Fragment=nY;es.Profiler=aY;es.PureComponent=bC;es.StrictMode=rY;es.Suspense=cY;es.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xY;es.act=g6;es.cloneElement=function(t,s,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var a=u6({},t.props),i=t.key,l=t.ref,o=t._owner;if(s!=null){if(s.ref!==void 0&&(l=s.ref,o=wC.current),s.key!==void 0&&(i=""+s.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(d in s)m6.call(s,d)&&!p6.hasOwnProperty(d)&&(a[d]=s[d]===void 0&&c!==void 0?c[d]:s[d])}var d=arguments.length-2;if(d===1)a.children=n;else if(1<d){c=Array(d);for(var u=0;u<d;u++)c[u]=arguments[u+2];a.children=c}return{$$typeof:fx,type:t.type,key:i,ref:l,props:a,_owner:o}};es.createContext=function(t){return t={$$typeof:lY,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:iY,_context:t},t.Consumer=t};es.createElement=x6;es.createFactory=function(t){var s=x6.bind(null,t);return s.type=t,s};es.createRef=function(){return{current:null}};es.forwardRef=function(t){return{$$typeof:oY,render:t}};es.isValidElement=NC;es.lazy=function(t){return{$$typeof:uY,_payload:{_status:-1,_result:t},_init:pY}};es.memo=function(t,s){return{$$typeof:dY,type:t,compare:s===void 0?null:s}};es.startTransition=function(t){var s=vg.transition;vg.transition={};try{t()}finally{vg.transition=s}};es.unstable_act=g6;es.useCallback=function(t,s){return la.current.useCallback(t,s)};es.useContext=function(t){return la.current.useContext(t)};es.useDebugValue=function(){};es.useDeferredValue=function(t){return la.current.useDeferredValue(t)};es.useEffect=function(t,s){return la.current.useEffect(t,s)};es.useId=function(){return la.current.useId()};es.useImperativeHandle=function(t,s,n){return la.current.useImperativeHandle(t,s,n)};es.useInsertionEffect=function(t,s){return la.current.useInsertionEffect(t,s)};es.useLayoutEffect=function(t,s){return la.current.useLayoutEffect(t,s)};es.useMemo=function(t,s){return la.current.useMemo(t,s)};es.useReducer=function(t,s,n){return la.current.useReducer(t,s,n)};es.useRef=function(t){return la.current.useRef(t)};es.useState=function(t){return la.current.useState(t)};es.useSyncExternalStore=function(t,s,n){return la.current.useSyncExternalStore(t,s,n)};es.useTransition=function(){return la.current.useTransition()};es.version="18.3.1";c6.exports=es;var y=c6.exports;const Qe=Mi(y),ab=l6({__proto__:null,default:Qe},[y]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gY=y,yY=Symbol.for("react.element"),bY=Symbol.for("react.fragment"),vY=Object.prototype.hasOwnProperty,wY=gY.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,NY={key:!0,ref:!0,__self:!0,__source:!0};function y6(t,s,n){var a,i={},l=null,o=null;n!==void 0&&(l=""+n),s.key!==void 0&&(l=""+s.key),s.ref!==void 0&&(o=s.ref);for(a in s)vY.call(s,a)&&!NY.hasOwnProperty(a)&&(i[a]=s[a]);if(t&&t.defaultProps)for(a in s=t.defaultProps,s)i[a]===void 0&&(i[a]=s[a]);return{$$typeof:yY,type:t,key:l,ref:o,props:i,_owner:wY.current}}rb.Fragment=bY;rb.jsx=y6;rb.jsxs=y6;o6.exports=rb;var r=o6.exports,o2={},b6={exports:{}},si={},v6={exports:{}},w6={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function s(G,se){var ge=G.length;G.push(se);e:for(;0<ge;){var ke=ge-1>>>1,ee=G[ke];if(0<i(ee,se))G[ke]=se,G[ge]=ee,ge=ke;else break e}}function n(G){return G.length===0?null:G[0]}function a(G){if(G.length===0)return null;var se=G[0],ge=G.pop();if(ge!==se){G[0]=ge;e:for(var ke=0,ee=G.length,pe=ee>>>1;ke<pe;){var ue=2*(ke+1)-1,ye=G[ue],X=ue+1,oe=G[X];if(0>i(ye,ge))X<ee&&0>i(oe,ye)?(G[ke]=oe,G[X]=ge,ke=X):(G[ke]=ye,G[ue]=ge,ke=ue);else if(X<ee&&0>i(oe,ge))G[ke]=oe,G[X]=ge,ke=X;else break e}}return se}function i(G,se){var ge=G.sortIndex-se.sortIndex;return ge!==0?ge:G.id-se.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var d=[],u=[],f=1,m=null,x=3,b=!1,w=!1,j=!1,_=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(G){for(var se=n(u);se!==null;){if(se.callback===null)a(u);else if(se.startTime<=G)a(u),se.sortIndex=se.expirationTime,s(d,se);else break;se=n(u)}}function T(G){if(j=!1,A(G),!w)if(n(d)!==null)w=!0,W(P);else{var se=n(u);se!==null&&q(T,se.startTime-G)}}function P(G,se){w=!1,j&&(j=!1,C(O),O=-1),b=!0;var ge=x;try{for(A(se),m=n(d);m!==null&&(!(m.expirationTime>se)||G&&!L());){var ke=m.callback;if(typeof ke=="function"){m.callback=null,x=m.priorityLevel;var ee=ke(m.expirationTime<=se);se=t.unstable_now(),typeof ee=="function"?m.callback=ee:m===n(d)&&a(d),A(se)}else a(d);m=n(d)}if(m!==null)var pe=!0;else{var ue=n(u);ue!==null&&q(T,ue.startTime-se),pe=!1}return pe}finally{m=null,x=ge,b=!1}}var R=!1,I=null,O=-1,M=5,B=-1;function L(){return!(t.unstable_now()-B<M)}function F(){if(I!==null){var G=t.unstable_now();B=G;var se=!0;try{se=I(!0,G)}finally{se?V():(R=!1,I=null)}}else R=!1}var V;if(typeof k=="function")V=function(){k(F)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,z=U.port2;U.port1.onmessage=F,V=function(){z.postMessage(null)}}else V=function(){_(F,0)};function W(G){I=G,R||(R=!0,V())}function q(G,se){O=_(function(){G(t.unstable_now())},se)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(G){G.callback=null},t.unstable_continueExecution=function(){w||b||(w=!0,W(P))},t.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<G?Math.floor(1e3/G):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_getFirstCallbackNode=function(){return n(d)},t.unstable_next=function(G){switch(x){case 1:case 2:case 3:var se=3;break;default:se=x}var ge=x;x=se;try{return G()}finally{x=ge}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(G,se){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var ge=x;x=G;try{return se()}finally{x=ge}},t.unstable_scheduleCallback=function(G,se,ge){var ke=t.unstable_now();switch(typeof ge=="object"&&ge!==null?(ge=ge.delay,ge=typeof ge=="number"&&0<ge?ke+ge:ke):ge=ke,G){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=ge+ee,G={id:f++,callback:se,priorityLevel:G,startTime:ge,expirationTime:ee,sortIndex:-1},ge>ke?(G.sortIndex=ge,s(u,G),n(d)===null&&G===n(u)&&(j?(C(O),O=-1):j=!0,q(T,ge-ke))):(G.sortIndex=ee,s(d,G),w||b||(w=!0,W(P))),G},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(G){var se=x;return function(){var ge=x;x=se;try{return G.apply(this,arguments)}finally{x=ge}}}})(w6);v6.exports=w6;var jY=v6.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _Y=y,Za=jY;function Ye(t){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)s+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var N6=new Set,dp={};function Tu(t,s){zh(t,s),zh(t+"Capture",s)}function zh(t,s){for(dp[t]=s,t=0;t<s.length;t++)N6.add(s[t])}var wo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c2=Object.prototype.hasOwnProperty,SY=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,TE={},PE={};function CY(t){return c2.call(PE,t)?!0:c2.call(TE,t)?!1:SY.test(t)?PE[t]=!0:(TE[t]=!0,!1)}function kY(t,s,n,a){if(n!==null&&n.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return a?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function AY(t,s,n,a){if(s===null||typeof s>"u"||kY(t,s,n,a))return!0;if(a)return!1;if(n!==null)switch(n.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function oa(t,s,n,a,i,l,o){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=a,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=s,this.sanitizeURL=l,this.removeEmptyString=o}var Tr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Tr[t]=new oa(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var s=t[0];Tr[s]=new oa(s,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Tr[t]=new oa(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Tr[t]=new oa(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Tr[t]=new oa(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Tr[t]=new oa(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Tr[t]=new oa(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Tr[t]=new oa(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Tr[t]=new oa(t,5,!1,t.toLowerCase(),null,!1,!1)});var jC=/[\-:]([a-z])/g;function _C(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var s=t.replace(jC,_C);Tr[s]=new oa(s,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var s=t.replace(jC,_C);Tr[s]=new oa(s,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var s=t.replace(jC,_C);Tr[s]=new oa(s,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Tr[t]=new oa(t,1,!1,t.toLowerCase(),null,!1,!1)});Tr.xlinkHref=new oa("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Tr[t]=new oa(t,1,!1,t.toLowerCase(),null,!0,!0)});function SC(t,s,n,a){var i=Tr.hasOwnProperty(s)?Tr[s]:null;(i!==null?i.type!==0:a||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(AY(s,n,i,a)&&(n=null),a||i===null?CY(s)&&(n===null?t.removeAttribute(s):t.setAttribute(s,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(s=i.attributeName,a=i.attributeNamespace,n===null?t.removeAttribute(s):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,a?t.setAttributeNS(a,s,n):t.setAttribute(s,n))))}var Lo=_Y.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,n0=Symbol.for("react.element"),ih=Symbol.for("react.portal"),lh=Symbol.for("react.fragment"),CC=Symbol.for("react.strict_mode"),d2=Symbol.for("react.profiler"),j6=Symbol.for("react.provider"),_6=Symbol.for("react.context"),kC=Symbol.for("react.forward_ref"),u2=Symbol.for("react.suspense"),h2=Symbol.for("react.suspense_list"),AC=Symbol.for("react.memo"),lc=Symbol.for("react.lazy"),S6=Symbol.for("react.offscreen"),IE=Symbol.iterator;function im(t){return t===null||typeof t!="object"?null:(t=IE&&t[IE]||t["@@iterator"],typeof t=="function"?t:null)}var ln=Object.assign,Rw;function Pm(t){if(Rw===void 0)try{throw Error()}catch(n){var s=n.stack.trim().match(/\n( *(at )?)/);Rw=s&&s[1]||""}return`
`+Rw+t}var Lw=!1;function Bw(t,s){if(!t||Lw)return"";Lw=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(u){var a=u}Reflect.construct(t,[],s)}else{try{s.call()}catch(u){a=u}t.call(s.prototype)}else{try{throw Error()}catch(u){a=u}t()}}catch(u){if(u&&a&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),l=a.stack.split(`
`),o=i.length-1,c=l.length-1;1<=o&&0<=c&&i[o]!==l[c];)c--;for(;1<=o&&0<=c;o--,c--)if(i[o]!==l[c]){if(o!==1||c!==1)do if(o--,c--,0>c||i[o]!==l[c]){var d=`
`+i[o].replace(" at new "," at ");return t.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",t.displayName)),d}while(1<=o&&0<=c);break}}}finally{Lw=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Pm(t):""}function EY(t){switch(t.tag){case 5:return Pm(t.type);case 16:return Pm("Lazy");case 13:return Pm("Suspense");case 19:return Pm("SuspenseList");case 0:case 2:case 15:return t=Bw(t.type,!1),t;case 11:return t=Bw(t.type.render,!1),t;case 1:return t=Bw(t.type,!0),t;default:return""}}function f2(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case lh:return"Fragment";case ih:return"Portal";case d2:return"Profiler";case CC:return"StrictMode";case u2:return"Suspense";case h2:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case _6:return(t.displayName||"Context")+".Consumer";case j6:return(t._context.displayName||"Context")+".Provider";case kC:var s=t.render;return t=t.displayName,t||(t=s.displayName||s.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case AC:return s=t.displayName||null,s!==null?s:f2(t.type)||"Memo";case lc:s=t._payload,t=t._init;try{return f2(t(s))}catch{}}return null}function TY(t){var s=t.type;switch(t.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=s.render,t=t.displayName||t.name||"",s.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return f2(s);case 8:return s===CC?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function Rc(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function C6(t){var s=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function PY(t){var s=C6(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,s),a=""+t[s];if(!t.hasOwnProperty(s)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,l=n.set;return Object.defineProperty(t,s,{configurable:!0,get:function(){return i.call(this)},set:function(o){a=""+o,l.call(this,o)}}),Object.defineProperty(t,s,{enumerable:n.enumerable}),{getValue:function(){return a},setValue:function(o){a=""+o},stopTracking:function(){t._valueTracker=null,delete t[s]}}}}function r0(t){t._valueTracker||(t._valueTracker=PY(t))}function k6(t){if(!t)return!1;var s=t._valueTracker;if(!s)return!0;var n=s.getValue(),a="";return t&&(a=C6(t)?t.checked?"true":"false":t.value),t=a,t!==n?(s.setValue(t),!0):!1}function iy(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function m2(t,s){var n=s.checked;return ln({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function ME(t,s){var n=s.defaultValue==null?"":s.defaultValue,a=s.checked!=null?s.checked:s.defaultChecked;n=Rc(s.value!=null?s.value:n),t._wrapperState={initialChecked:a,initialValue:n,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function A6(t,s){s=s.checked,s!=null&&SC(t,"checked",s,!1)}function p2(t,s){A6(t,s);var n=Rc(s.value),a=s.type;if(n!=null)a==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(a==="submit"||a==="reset"){t.removeAttribute("value");return}s.hasOwnProperty("value")?x2(t,s.type,n):s.hasOwnProperty("defaultValue")&&x2(t,s.type,Rc(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(t.defaultChecked=!!s.defaultChecked)}function DE(t,s,n){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var a=s.type;if(!(a!=="submit"&&a!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+t._wrapperState.initialValue,n||s===t.value||(t.value=s),t.defaultValue=s}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function x2(t,s,n){(s!=="number"||iy(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Im=Array.isArray;function Ah(t,s,n,a){if(t=t.options,s){s={};for(var i=0;i<n.length;i++)s["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=s.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&a&&(t[n].defaultSelected=!0)}else{for(n=""+Rc(n),s=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,a&&(t[i].defaultSelected=!0);return}s!==null||t[i].disabled||(s=t[i])}s!==null&&(s.selected=!0)}}function g2(t,s){if(s.dangerouslySetInnerHTML!=null)throw Error(Ye(91));return ln({},s,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function OE(t,s){var n=s.value;if(n==null){if(n=s.children,s=s.defaultValue,n!=null){if(s!=null)throw Error(Ye(92));if(Im(n)){if(1<n.length)throw Error(Ye(93));n=n[0]}s=n}s==null&&(s=""),n=s}t._wrapperState={initialValue:Rc(n)}}function E6(t,s){var n=Rc(s.value),a=Rc(s.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),s.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),a!=null&&(t.defaultValue=""+a)}function RE(t){var s=t.textContent;s===t._wrapperState.initialValue&&s!==""&&s!==null&&(t.value=s)}function T6(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function y2(t,s){return t==null||t==="http://www.w3.org/1999/xhtml"?T6(s):t==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var a0,P6=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,n,a,i){MSApp.execUnsafeLocalFunction(function(){return t(s,n,a,i)})}:t}(function(t,s){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=s;else{for(a0=a0||document.createElement("div"),a0.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=a0.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;s.firstChild;)t.appendChild(s.firstChild)}});function up(t,s){if(s){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=s;return}}t.textContent=s}var Vm={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},IY=["Webkit","ms","Moz","O"];Object.keys(Vm).forEach(function(t){IY.forEach(function(s){s=s+t.charAt(0).toUpperCase()+t.substring(1),Vm[s]=Vm[t]})});function I6(t,s,n){return s==null||typeof s=="boolean"||s===""?"":n||typeof s!="number"||s===0||Vm.hasOwnProperty(t)&&Vm[t]?(""+s).trim():s+"px"}function M6(t,s){t=t.style;for(var n in s)if(s.hasOwnProperty(n)){var a=n.indexOf("--")===0,i=I6(n,s[n],a);n==="float"&&(n="cssFloat"),a?t.setProperty(n,i):t[n]=i}}var MY=ln({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function b2(t,s){if(s){if(MY[t]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(Ye(137,t));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(Ye(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(Ye(61))}if(s.style!=null&&typeof s.style!="object")throw Error(Ye(62))}}function v2(t,s){if(t.indexOf("-")===-1)return typeof s.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var w2=null;function EC(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var N2=null,Eh=null,Th=null;function LE(t){if(t=xx(t)){if(typeof N2!="function")throw Error(Ye(280));var s=t.stateNode;s&&(s=db(s),N2(t.stateNode,t.type,s))}}function D6(t){Eh?Th?Th.push(t):Th=[t]:Eh=t}function O6(){if(Eh){var t=Eh,s=Th;if(Th=Eh=null,LE(t),s)for(t=0;t<s.length;t++)LE(s[t])}}function R6(t,s){return t(s)}function L6(){}var Fw=!1;function B6(t,s,n){if(Fw)return t(s,n);Fw=!0;try{return R6(t,s,n)}finally{Fw=!1,(Eh!==null||Th!==null)&&(L6(),O6())}}function hp(t,s){var n=t.stateNode;if(n===null)return null;var a=db(n);if(a===null)return null;n=a[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(t=t.type,a=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!a;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Ye(231,s,typeof n));return n}var j2=!1;if(wo)try{var lm={};Object.defineProperty(lm,"passive",{get:function(){j2=!0}}),window.addEventListener("test",lm,lm),window.removeEventListener("test",lm,lm)}catch{j2=!1}function DY(t,s,n,a,i,l,o,c,d){var u=Array.prototype.slice.call(arguments,3);try{s.apply(n,u)}catch(f){this.onError(f)}}var Hm=!1,ly=null,oy=!1,_2=null,OY={onError:function(t){Hm=!0,ly=t}};function RY(t,s,n,a,i,l,o,c,d){Hm=!1,ly=null,DY.apply(OY,arguments)}function LY(t,s,n,a,i,l,o,c,d){if(RY.apply(this,arguments),Hm){if(Hm){var u=ly;Hm=!1,ly=null}else throw Error(Ye(198));oy||(oy=!0,_2=u)}}function Pu(t){var s=t,n=t;if(t.alternate)for(;s.return;)s=s.return;else{t=s;do s=t,s.flags&4098&&(n=s.return),t=s.return;while(t)}return s.tag===3?n:null}function F6(t){if(t.tag===13){var s=t.memoizedState;if(s===null&&(t=t.alternate,t!==null&&(s=t.memoizedState)),s!==null)return s.dehydrated}return null}function BE(t){if(Pu(t)!==t)throw Error(Ye(188))}function BY(t){var s=t.alternate;if(!s){if(s=Pu(t),s===null)throw Error(Ye(188));return s!==t?null:t}for(var n=t,a=s;;){var i=n.return;if(i===null)break;var l=i.alternate;if(l===null){if(a=i.return,a!==null){n=a;continue}break}if(i.child===l.child){for(l=i.child;l;){if(l===n)return BE(i),t;if(l===a)return BE(i),s;l=l.sibling}throw Error(Ye(188))}if(n.return!==a.return)n=i,a=l;else{for(var o=!1,c=i.child;c;){if(c===n){o=!0,n=i,a=l;break}if(c===a){o=!0,a=i,n=l;break}c=c.sibling}if(!o){for(c=l.child;c;){if(c===n){o=!0,n=l,a=i;break}if(c===a){o=!0,a=l,n=i;break}c=c.sibling}if(!o)throw Error(Ye(189))}}if(n.alternate!==a)throw Error(Ye(190))}if(n.tag!==3)throw Error(Ye(188));return n.stateNode.current===n?t:s}function $6(t){return t=BY(t),t!==null?z6(t):null}function z6(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var s=z6(t);if(s!==null)return s;t=t.sibling}return null}var U6=Za.unstable_scheduleCallback,FE=Za.unstable_cancelCallback,FY=Za.unstable_shouldYield,$Y=Za.unstable_requestPaint,_n=Za.unstable_now,zY=Za.unstable_getCurrentPriorityLevel,TC=Za.unstable_ImmediatePriority,V6=Za.unstable_UserBlockingPriority,cy=Za.unstable_NormalPriority,UY=Za.unstable_LowPriority,H6=Za.unstable_IdlePriority,ib=null,Ol=null;function VY(t){if(Ol&&typeof Ol.onCommitFiberRoot=="function")try{Ol.onCommitFiberRoot(ib,t,void 0,(t.current.flags&128)===128)}catch{}}var Ji=Math.clz32?Math.clz32:qY,HY=Math.log,WY=Math.LN2;function qY(t){return t>>>=0,t===0?32:31-(HY(t)/WY|0)|0}var i0=64,l0=4194304;function Mm(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function dy(t,s){var n=t.pendingLanes;if(n===0)return 0;var a=0,i=t.suspendedLanes,l=t.pingedLanes,o=n&268435455;if(o!==0){var c=o&~i;c!==0?a=Mm(c):(l&=o,l!==0&&(a=Mm(l)))}else o=n&~i,o!==0?a=Mm(o):l!==0&&(a=Mm(l));if(a===0)return 0;if(s!==0&&s!==a&&!(s&i)&&(i=a&-a,l=s&-s,i>=l||i===16&&(l&4194240)!==0))return s;if(a&4&&(a|=n&16),s=t.entangledLanes,s!==0)for(t=t.entanglements,s&=a;0<s;)n=31-Ji(s),i=1<<n,a|=t[n],s&=~i;return a}function GY(t,s){switch(t){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function KY(t,s){for(var n=t.suspendedLanes,a=t.pingedLanes,i=t.expirationTimes,l=t.pendingLanes;0<l;){var o=31-Ji(l),c=1<<o,d=i[o];d===-1?(!(c&n)||c&a)&&(i[o]=GY(c,s)):d<=s&&(t.expiredLanes|=c),l&=~c}}function S2(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function W6(){var t=i0;return i0<<=1,!(i0&4194240)&&(i0=64),t}function $w(t){for(var s=[],n=0;31>n;n++)s.push(t);return s}function mx(t,s,n){t.pendingLanes|=s,s!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,s=31-Ji(s),t[s]=n}function YY(t,s){var n=t.pendingLanes&~s;t.pendingLanes=s,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=s,t.mutableReadLanes&=s,t.entangledLanes&=s,s=t.entanglements;var a=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Ji(n),l=1<<i;s[i]=0,a[i]=-1,t[i]=-1,n&=~l}}function PC(t,s){var n=t.entangledLanes|=s;for(t=t.entanglements;n;){var a=31-Ji(n),i=1<<a;i&s|t[a]&s&&(t[a]|=s),n&=~i}}var ys=0;function q6(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var G6,IC,K6,Y6,X6,C2=!1,o0=[],jc=null,_c=null,Sc=null,fp=new Map,mp=new Map,fc=[],XY="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $E(t,s){switch(t){case"focusin":case"focusout":jc=null;break;case"dragenter":case"dragleave":_c=null;break;case"mouseover":case"mouseout":Sc=null;break;case"pointerover":case"pointerout":fp.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":mp.delete(s.pointerId)}}function om(t,s,n,a,i,l){return t===null||t.nativeEvent!==l?(t={blockedOn:s,domEventName:n,eventSystemFlags:a,nativeEvent:l,targetContainers:[i]},s!==null&&(s=xx(s),s!==null&&IC(s)),t):(t.eventSystemFlags|=a,s=t.targetContainers,i!==null&&s.indexOf(i)===-1&&s.push(i),t)}function QY(t,s,n,a,i){switch(s){case"focusin":return jc=om(jc,t,s,n,a,i),!0;case"dragenter":return _c=om(_c,t,s,n,a,i),!0;case"mouseover":return Sc=om(Sc,t,s,n,a,i),!0;case"pointerover":var l=i.pointerId;return fp.set(l,om(fp.get(l)||null,t,s,n,a,i)),!0;case"gotpointercapture":return l=i.pointerId,mp.set(l,om(mp.get(l)||null,t,s,n,a,i)),!0}return!1}function Q6(t){var s=Dd(t.target);if(s!==null){var n=Pu(s);if(n!==null){if(s=n.tag,s===13){if(s=F6(n),s!==null){t.blockedOn=s,X6(t.priority,function(){K6(n)});return}}else if(s===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function wg(t){if(t.blockedOn!==null)return!1;for(var s=t.targetContainers;0<s.length;){var n=k2(t.domEventName,t.eventSystemFlags,s[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var a=new n.constructor(n.type,n);w2=a,n.target.dispatchEvent(a),w2=null}else return s=xx(n),s!==null&&IC(s),t.blockedOn=n,!1;s.shift()}return!0}function zE(t,s,n){wg(t)&&n.delete(s)}function ZY(){C2=!1,jc!==null&&wg(jc)&&(jc=null),_c!==null&&wg(_c)&&(_c=null),Sc!==null&&wg(Sc)&&(Sc=null),fp.forEach(zE),mp.forEach(zE)}function cm(t,s){t.blockedOn===s&&(t.blockedOn=null,C2||(C2=!0,Za.unstable_scheduleCallback(Za.unstable_NormalPriority,ZY)))}function pp(t){function s(i){return cm(i,t)}if(0<o0.length){cm(o0[0],t);for(var n=1;n<o0.length;n++){var a=o0[n];a.blockedOn===t&&(a.blockedOn=null)}}for(jc!==null&&cm(jc,t),_c!==null&&cm(_c,t),Sc!==null&&cm(Sc,t),fp.forEach(s),mp.forEach(s),n=0;n<fc.length;n++)a=fc[n],a.blockedOn===t&&(a.blockedOn=null);for(;0<fc.length&&(n=fc[0],n.blockedOn===null);)Q6(n),n.blockedOn===null&&fc.shift()}var Ph=Lo.ReactCurrentBatchConfig,uy=!0;function JY(t,s,n,a){var i=ys,l=Ph.transition;Ph.transition=null;try{ys=1,MC(t,s,n,a)}finally{ys=i,Ph.transition=l}}function eX(t,s,n,a){var i=ys,l=Ph.transition;Ph.transition=null;try{ys=4,MC(t,s,n,a)}finally{ys=i,Ph.transition=l}}function MC(t,s,n,a){if(uy){var i=k2(t,s,n,a);if(i===null)Xw(t,s,a,hy,n),$E(t,a);else if(QY(i,t,s,n,a))a.stopPropagation();else if($E(t,a),s&4&&-1<XY.indexOf(t)){for(;i!==null;){var l=xx(i);if(l!==null&&G6(l),l=k2(t,s,n,a),l===null&&Xw(t,s,a,hy,n),l===i)break;i=l}i!==null&&a.stopPropagation()}else Xw(t,s,a,null,n)}}var hy=null;function k2(t,s,n,a){if(hy=null,t=EC(a),t=Dd(t),t!==null)if(s=Pu(t),s===null)t=null;else if(n=s.tag,n===13){if(t=F6(s),t!==null)return t;t=null}else if(n===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;t=null}else s!==t&&(t=null);return hy=t,null}function Z6(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zY()){case TC:return 1;case V6:return 4;case cy:case UY:return 16;case H6:return 536870912;default:return 16}default:return 16}}var gc=null,DC=null,Ng=null;function J6(){if(Ng)return Ng;var t,s=DC,n=s.length,a,i="value"in gc?gc.value:gc.textContent,l=i.length;for(t=0;t<n&&s[t]===i[t];t++);var o=n-t;for(a=1;a<=o&&s[n-a]===i[l-a];a++);return Ng=i.slice(t,1<a?1-a:void 0)}function jg(t){var s=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&s===13&&(t=13)):t=s,t===10&&(t=13),32<=t||t===13?t:0}function c0(){return!0}function UE(){return!1}function ni(t){function s(n,a,i,l,o){this._reactName=n,this._targetInst=i,this.type=a,this.nativeEvent=l,this.target=o,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(l):l[c]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?c0:UE,this.isPropagationStopped=UE,this}return ln(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=c0)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=c0)},persist:function(){},isPersistent:c0}),s}var bf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},OC=ni(bf),px=ln({},bf,{view:0,detail:0}),tX=ni(px),zw,Uw,dm,lb=ln({},px,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:RC,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==dm&&(dm&&t.type==="mousemove"?(zw=t.screenX-dm.screenX,Uw=t.screenY-dm.screenY):Uw=zw=0,dm=t),zw)},movementY:function(t){return"movementY"in t?t.movementY:Uw}}),VE=ni(lb),sX=ln({},lb,{dataTransfer:0}),nX=ni(sX),rX=ln({},px,{relatedTarget:0}),Vw=ni(rX),aX=ln({},bf,{animationName:0,elapsedTime:0,pseudoElement:0}),iX=ni(aX),lX=ln({},bf,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),oX=ni(lX),cX=ln({},bf,{data:0}),HE=ni(cX),dX={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uX={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hX={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fX(t){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(t):(t=hX[t])?!!s[t]:!1}function RC(){return fX}var mX=ln({},px,{key:function(t){if(t.key){var s=dX[t.key]||t.key;if(s!=="Unidentified")return s}return t.type==="keypress"?(t=jg(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?uX[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:RC,charCode:function(t){return t.type==="keypress"?jg(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?jg(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),pX=ni(mX),xX=ln({},lb,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),WE=ni(xX),gX=ln({},px,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:RC}),yX=ni(gX),bX=ln({},bf,{propertyName:0,elapsedTime:0,pseudoElement:0}),vX=ni(bX),wX=ln({},lb,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),NX=ni(wX),jX=[9,13,27,32],LC=wo&&"CompositionEvent"in window,Wm=null;wo&&"documentMode"in document&&(Wm=document.documentMode);var _X=wo&&"TextEvent"in window&&!Wm,e8=wo&&(!LC||Wm&&8<Wm&&11>=Wm),qE=" ",GE=!1;function t8(t,s){switch(t){case"keyup":return jX.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function s8(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var oh=!1;function SX(t,s){switch(t){case"compositionend":return s8(s);case"keypress":return s.which!==32?null:(GE=!0,qE);case"textInput":return t=s.data,t===qE&&GE?null:t;default:return null}}function CX(t,s){if(oh)return t==="compositionend"||!LC&&t8(t,s)?(t=J6(),Ng=DC=gc=null,oh=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return e8&&s.locale!=="ko"?null:s.data;default:return null}}var kX={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function KE(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s==="input"?!!kX[t.type]:s==="textarea"}function n8(t,s,n,a){D6(a),s=fy(s,"onChange"),0<s.length&&(n=new OC("onChange","change",null,n,a),t.push({event:n,listeners:s}))}var qm=null,xp=null;function AX(t){m8(t,0)}function ob(t){var s=uh(t);if(k6(s))return t}function EX(t,s){if(t==="change")return s}var r8=!1;if(wo){var Hw;if(wo){var Ww="oninput"in document;if(!Ww){var YE=document.createElement("div");YE.setAttribute("oninput","return;"),Ww=typeof YE.oninput=="function"}Hw=Ww}else Hw=!1;r8=Hw&&(!document.documentMode||9<document.documentMode)}function XE(){qm&&(qm.detachEvent("onpropertychange",a8),xp=qm=null)}function a8(t){if(t.propertyName==="value"&&ob(xp)){var s=[];n8(s,xp,t,EC(t)),B6(AX,s)}}function TX(t,s,n){t==="focusin"?(XE(),qm=s,xp=n,qm.attachEvent("onpropertychange",a8)):t==="focusout"&&XE()}function PX(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ob(xp)}function IX(t,s){if(t==="click")return ob(s)}function MX(t,s){if(t==="input"||t==="change")return ob(s)}function DX(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var sl=typeof Object.is=="function"?Object.is:DX;function gp(t,s){if(sl(t,s))return!0;if(typeof t!="object"||t===null||typeof s!="object"||s===null)return!1;var n=Object.keys(t),a=Object.keys(s);if(n.length!==a.length)return!1;for(a=0;a<n.length;a++){var i=n[a];if(!c2.call(s,i)||!sl(t[i],s[i]))return!1}return!0}function QE(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ZE(t,s){var n=QE(t);t=0;for(var a;n;){if(n.nodeType===3){if(a=t+n.textContent.length,t<=s&&a>=s)return{node:n,offset:s-t};t=a}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=QE(n)}}function i8(t,s){return t&&s?t===s?!0:t&&t.nodeType===3?!1:s&&s.nodeType===3?i8(t,s.parentNode):"contains"in t?t.contains(s):t.compareDocumentPosition?!!(t.compareDocumentPosition(s)&16):!1:!1}function l8(){for(var t=window,s=iy();s instanceof t.HTMLIFrameElement;){try{var n=typeof s.contentWindow.location.href=="string"}catch{n=!1}if(n)t=s.contentWindow;else break;s=iy(t.document)}return s}function BC(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s&&(s==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||s==="textarea"||t.contentEditable==="true")}function OX(t){var s=l8(),n=t.focusedElem,a=t.selectionRange;if(s!==n&&n&&n.ownerDocument&&i8(n.ownerDocument.documentElement,n)){if(a!==null&&BC(n)){if(s=a.start,t=a.end,t===void 0&&(t=s),"selectionStart"in n)n.selectionStart=s,n.selectionEnd=Math.min(t,n.value.length);else if(t=(s=n.ownerDocument||document)&&s.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,l=Math.min(a.start,i);a=a.end===void 0?l:Math.min(a.end,i),!t.extend&&l>a&&(i=a,a=l,l=i),i=ZE(n,l);var o=ZE(n,a);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(s=s.createRange(),s.setStart(i.node,i.offset),t.removeAllRanges(),l>a?(t.addRange(s),t.extend(o.node,o.offset)):(s.setEnd(o.node,o.offset),t.addRange(s)))}}for(s=[],t=n;t=t.parentNode;)t.nodeType===1&&s.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<s.length;n++)t=s[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var RX=wo&&"documentMode"in document&&11>=document.documentMode,ch=null,A2=null,Gm=null,E2=!1;function JE(t,s,n){var a=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;E2||ch==null||ch!==iy(a)||(a=ch,"selectionStart"in a&&BC(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),Gm&&gp(Gm,a)||(Gm=a,a=fy(A2,"onSelect"),0<a.length&&(s=new OC("onSelect","select",null,s,n),t.push({event:s,listeners:a}),s.target=ch)))}function d0(t,s){var n={};return n[t.toLowerCase()]=s.toLowerCase(),n["Webkit"+t]="webkit"+s,n["Moz"+t]="moz"+s,n}var dh={animationend:d0("Animation","AnimationEnd"),animationiteration:d0("Animation","AnimationIteration"),animationstart:d0("Animation","AnimationStart"),transitionend:d0("Transition","TransitionEnd")},qw={},o8={};wo&&(o8=document.createElement("div").style,"AnimationEvent"in window||(delete dh.animationend.animation,delete dh.animationiteration.animation,delete dh.animationstart.animation),"TransitionEvent"in window||delete dh.transitionend.transition);function cb(t){if(qw[t])return qw[t];if(!dh[t])return t;var s=dh[t],n;for(n in s)if(s.hasOwnProperty(n)&&n in o8)return qw[t]=s[n];return t}var c8=cb("animationend"),d8=cb("animationiteration"),u8=cb("animationstart"),h8=cb("transitionend"),f8=new Map,eT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Zc(t,s){f8.set(t,s),Tu(s,[t])}for(var Gw=0;Gw<eT.length;Gw++){var Kw=eT[Gw],LX=Kw.toLowerCase(),BX=Kw[0].toUpperCase()+Kw.slice(1);Zc(LX,"on"+BX)}Zc(c8,"onAnimationEnd");Zc(d8,"onAnimationIteration");Zc(u8,"onAnimationStart");Zc("dblclick","onDoubleClick");Zc("focusin","onFocus");Zc("focusout","onBlur");Zc(h8,"onTransitionEnd");zh("onMouseEnter",["mouseout","mouseover"]);zh("onMouseLeave",["mouseout","mouseover"]);zh("onPointerEnter",["pointerout","pointerover"]);zh("onPointerLeave",["pointerout","pointerover"]);Tu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Tu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Tu("onBeforeInput",["compositionend","keypress","textInput","paste"]);Tu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Tu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Tu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),FX=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dm));function tT(t,s,n){var a=t.type||"unknown-event";t.currentTarget=n,LY(a,s,void 0,t),t.currentTarget=null}function m8(t,s){s=(s&4)!==0;for(var n=0;n<t.length;n++){var a=t[n],i=a.event;a=a.listeners;e:{var l=void 0;if(s)for(var o=a.length-1;0<=o;o--){var c=a[o],d=c.instance,u=c.currentTarget;if(c=c.listener,d!==l&&i.isPropagationStopped())break e;tT(i,c,u),l=d}else for(o=0;o<a.length;o++){if(c=a[o],d=c.instance,u=c.currentTarget,c=c.listener,d!==l&&i.isPropagationStopped())break e;tT(i,c,u),l=d}}}if(oy)throw t=_2,oy=!1,_2=null,t}function Fs(t,s){var n=s[D2];n===void 0&&(n=s[D2]=new Set);var a=t+"__bubble";n.has(a)||(p8(s,t,2,!1),n.add(a))}function Yw(t,s,n){var a=0;s&&(a|=4),p8(n,t,a,s)}var u0="_reactListening"+Math.random().toString(36).slice(2);function yp(t){if(!t[u0]){t[u0]=!0,N6.forEach(function(n){n!=="selectionchange"&&(FX.has(n)||Yw(n,!1,t),Yw(n,!0,t))});var s=t.nodeType===9?t:t.ownerDocument;s===null||s[u0]||(s[u0]=!0,Yw("selectionchange",!1,s))}}function p8(t,s,n,a){switch(Z6(s)){case 1:var i=JY;break;case 4:i=eX;break;default:i=MC}n=i.bind(null,s,n,t),i=void 0,!j2||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(i=!0),a?i!==void 0?t.addEventListener(s,n,{capture:!0,passive:i}):t.addEventListener(s,n,!0):i!==void 0?t.addEventListener(s,n,{passive:i}):t.addEventListener(s,n,!1)}function Xw(t,s,n,a,i){var l=a;if(!(s&1)&&!(s&2)&&a!==null)e:for(;;){if(a===null)return;var o=a.tag;if(o===3||o===4){var c=a.stateNode.containerInfo;if(c===i||c.nodeType===8&&c.parentNode===i)break;if(o===4)for(o=a.return;o!==null;){var d=o.tag;if((d===3||d===4)&&(d=o.stateNode.containerInfo,d===i||d.nodeType===8&&d.parentNode===i))return;o=o.return}for(;c!==null;){if(o=Dd(c),o===null)return;if(d=o.tag,d===5||d===6){a=l=o;continue e}c=c.parentNode}}a=a.return}B6(function(){var u=l,f=EC(n),m=[];e:{var x=f8.get(t);if(x!==void 0){var b=OC,w=t;switch(t){case"keypress":if(jg(n)===0)break e;case"keydown":case"keyup":b=pX;break;case"focusin":w="focus",b=Vw;break;case"focusout":w="blur",b=Vw;break;case"beforeblur":case"afterblur":b=Vw;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":b=VE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":b=nX;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":b=yX;break;case c8:case d8:case u8:b=iX;break;case h8:b=vX;break;case"scroll":b=tX;break;case"wheel":b=NX;break;case"copy":case"cut":case"paste":b=oX;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":b=WE}var j=(s&4)!==0,_=!j&&t==="scroll",C=j?x!==null?x+"Capture":null:x;j=[];for(var k=u,A;k!==null;){A=k;var T=A.stateNode;if(A.tag===5&&T!==null&&(A=T,C!==null&&(T=hp(k,C),T!=null&&j.push(bp(k,T,A)))),_)break;k=k.return}0<j.length&&(x=new b(x,w,null,n,f),m.push({event:x,listeners:j}))}}if(!(s&7)){e:{if(x=t==="mouseover"||t==="pointerover",b=t==="mouseout"||t==="pointerout",x&&n!==w2&&(w=n.relatedTarget||n.fromElement)&&(Dd(w)||w[No]))break e;if((b||x)&&(x=f.window===f?f:(x=f.ownerDocument)?x.defaultView||x.parentWindow:window,b?(w=n.relatedTarget||n.toElement,b=u,w=w?Dd(w):null,w!==null&&(_=Pu(w),w!==_||w.tag!==5&&w.tag!==6)&&(w=null)):(b=null,w=u),b!==w)){if(j=VE,T="onMouseLeave",C="onMouseEnter",k="mouse",(t==="pointerout"||t==="pointerover")&&(j=WE,T="onPointerLeave",C="onPointerEnter",k="pointer"),_=b==null?x:uh(b),A=w==null?x:uh(w),x=new j(T,k+"leave",b,n,f),x.target=_,x.relatedTarget=A,T=null,Dd(f)===u&&(j=new j(C,k+"enter",w,n,f),j.target=A,j.relatedTarget=_,T=j),_=T,b&&w)t:{for(j=b,C=w,k=0,A=j;A;A=Ku(A))k++;for(A=0,T=C;T;T=Ku(T))A++;for(;0<k-A;)j=Ku(j),k--;for(;0<A-k;)C=Ku(C),A--;for(;k--;){if(j===C||C!==null&&j===C.alternate)break t;j=Ku(j),C=Ku(C)}j=null}else j=null;b!==null&&sT(m,x,b,j,!1),w!==null&&_!==null&&sT(m,_,w,j,!0)}}e:{if(x=u?uh(u):window,b=x.nodeName&&x.nodeName.toLowerCase(),b==="select"||b==="input"&&x.type==="file")var P=EX;else if(KE(x))if(r8)P=MX;else{P=PX;var R=TX}else(b=x.nodeName)&&b.toLowerCase()==="input"&&(x.type==="checkbox"||x.type==="radio")&&(P=IX);if(P&&(P=P(t,u))){n8(m,P,n,f);break e}R&&R(t,x,u),t==="focusout"&&(R=x._wrapperState)&&R.controlled&&x.type==="number"&&x2(x,"number",x.value)}switch(R=u?uh(u):window,t){case"focusin":(KE(R)||R.contentEditable==="true")&&(ch=R,A2=u,Gm=null);break;case"focusout":Gm=A2=ch=null;break;case"mousedown":E2=!0;break;case"contextmenu":case"mouseup":case"dragend":E2=!1,JE(m,n,f);break;case"selectionchange":if(RX)break;case"keydown":case"keyup":JE(m,n,f)}var I;if(LC)e:{switch(t){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else oh?t8(t,n)&&(O="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(O="onCompositionStart");O&&(e8&&n.locale!=="ko"&&(oh||O!=="onCompositionStart"?O==="onCompositionEnd"&&oh&&(I=J6()):(gc=f,DC="value"in gc?gc.value:gc.textContent,oh=!0)),R=fy(u,O),0<R.length&&(O=new HE(O,t,null,n,f),m.push({event:O,listeners:R}),I?O.data=I:(I=s8(n),I!==null&&(O.data=I)))),(I=_X?SX(t,n):CX(t,n))&&(u=fy(u,"onBeforeInput"),0<u.length&&(f=new HE("onBeforeInput","beforeinput",null,n,f),m.push({event:f,listeners:u}),f.data=I))}m8(m,s)})}function bp(t,s,n){return{instance:t,listener:s,currentTarget:n}}function fy(t,s){for(var n=s+"Capture",a=[];t!==null;){var i=t,l=i.stateNode;i.tag===5&&l!==null&&(i=l,l=hp(t,n),l!=null&&a.unshift(bp(t,l,i)),l=hp(t,s),l!=null&&a.push(bp(t,l,i))),t=t.return}return a}function Ku(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function sT(t,s,n,a,i){for(var l=s._reactName,o=[];n!==null&&n!==a;){var c=n,d=c.alternate,u=c.stateNode;if(d!==null&&d===a)break;c.tag===5&&u!==null&&(c=u,i?(d=hp(n,l),d!=null&&o.unshift(bp(n,d,c))):i||(d=hp(n,l),d!=null&&o.push(bp(n,d,c)))),n=n.return}o.length!==0&&t.push({event:s,listeners:o})}var $X=/\r\n?/g,zX=/\u0000|\uFFFD/g;function nT(t){return(typeof t=="string"?t:""+t).replace($X,`
`).replace(zX,"")}function h0(t,s,n){if(s=nT(s),nT(t)!==s&&n)throw Error(Ye(425))}function my(){}var T2=null,P2=null;function I2(t,s){return t==="textarea"||t==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var M2=typeof setTimeout=="function"?setTimeout:void 0,UX=typeof clearTimeout=="function"?clearTimeout:void 0,rT=typeof Promise=="function"?Promise:void 0,VX=typeof queueMicrotask=="function"?queueMicrotask:typeof rT<"u"?function(t){return rT.resolve(null).then(t).catch(HX)}:M2;function HX(t){setTimeout(function(){throw t})}function Qw(t,s){var n=s,a=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(a===0){t.removeChild(i),pp(s);return}a--}else n!=="$"&&n!=="$?"&&n!=="$!"||a++;n=i}while(n);pp(s)}function Cc(t){for(;t!=null;t=t.nextSibling){var s=t.nodeType;if(s===1||s===3)break;if(s===8){if(s=t.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return t}function aT(t){t=t.previousSibling;for(var s=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(s===0)return t;s--}else n==="/$"&&s++}t=t.previousSibling}return null}var vf=Math.random().toString(36).slice(2),Al="__reactFiber$"+vf,vp="__reactProps$"+vf,No="__reactContainer$"+vf,D2="__reactEvents$"+vf,WX="__reactListeners$"+vf,qX="__reactHandles$"+vf;function Dd(t){var s=t[Al];if(s)return s;for(var n=t.parentNode;n;){if(s=n[No]||n[Al]){if(n=s.alternate,s.child!==null||n!==null&&n.child!==null)for(t=aT(t);t!==null;){if(n=t[Al])return n;t=aT(t)}return s}t=n,n=t.parentNode}return null}function xx(t){return t=t[Al]||t[No],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function uh(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Ye(33))}function db(t){return t[vp]||null}var O2=[],hh=-1;function Jc(t){return{current:t}}function Us(t){0>hh||(t.current=O2[hh],O2[hh]=null,hh--)}function Rs(t,s){hh++,O2[hh]=t.current,t.current=s}var Lc={},Wr=Jc(Lc),va=Jc(!1),iu=Lc;function Uh(t,s){var n=t.type.contextTypes;if(!n)return Lc;var a=t.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===s)return a.__reactInternalMemoizedMaskedChildContext;var i={},l;for(l in n)i[l]=s[l];return a&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),i}function wa(t){return t=t.childContextTypes,t!=null}function py(){Us(va),Us(Wr)}function iT(t,s,n){if(Wr.current!==Lc)throw Error(Ye(168));Rs(Wr,s),Rs(va,n)}function x8(t,s,n){var a=t.stateNode;if(s=s.childContextTypes,typeof a.getChildContext!="function")return n;a=a.getChildContext();for(var i in a)if(!(i in s))throw Error(Ye(108,TY(t)||"Unknown",i));return ln({},n,a)}function xy(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Lc,iu=Wr.current,Rs(Wr,t),Rs(va,va.current),!0}function lT(t,s,n){var a=t.stateNode;if(!a)throw Error(Ye(169));n?(t=x8(t,s,iu),a.__reactInternalMemoizedMergedChildContext=t,Us(va),Us(Wr),Rs(Wr,t)):Us(va),Rs(va,n)}var co=null,ub=!1,Zw=!1;function g8(t){co===null?co=[t]:co.push(t)}function GX(t){ub=!0,g8(t)}function ed(){if(!Zw&&co!==null){Zw=!0;var t=0,s=ys;try{var n=co;for(ys=1;t<n.length;t++){var a=n[t];do a=a(!0);while(a!==null)}co=null,ub=!1}catch(i){throw co!==null&&(co=co.slice(t+1)),U6(TC,ed),i}finally{ys=s,Zw=!1}}return null}var fh=[],mh=0,gy=null,yy=0,bi=[],vi=0,lu=null,fo=1,mo="";function Nd(t,s){fh[mh++]=yy,fh[mh++]=gy,gy=t,yy=s}function y8(t,s,n){bi[vi++]=fo,bi[vi++]=mo,bi[vi++]=lu,lu=t;var a=fo;t=mo;var i=32-Ji(a)-1;a&=~(1<<i),n+=1;var l=32-Ji(s)+i;if(30<l){var o=i-i%5;l=(a&(1<<o)-1).toString(32),a>>=o,i-=o,fo=1<<32-Ji(s)+i|n<<i|a,mo=l+t}else fo=1<<l|n<<i|a,mo=t}function FC(t){t.return!==null&&(Nd(t,1),y8(t,1,0))}function $C(t){for(;t===gy;)gy=fh[--mh],fh[mh]=null,yy=fh[--mh],fh[mh]=null;for(;t===lu;)lu=bi[--vi],bi[vi]=null,mo=bi[--vi],bi[vi]=null,fo=bi[--vi],bi[vi]=null}var Ka=null,qa=null,Ws=!1,Ki=null;function b8(t,s){var n=wi(5,null,null,0);n.elementType="DELETED",n.stateNode=s,n.return=t,s=t.deletions,s===null?(t.deletions=[n],t.flags|=16):s.push(n)}function oT(t,s){switch(t.tag){case 5:var n=t.type;return s=s.nodeType!==1||n.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(t.stateNode=s,Ka=t,qa=Cc(s.firstChild),!0):!1;case 6:return s=t.pendingProps===""||s.nodeType!==3?null:s,s!==null?(t.stateNode=s,Ka=t,qa=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(n=lu!==null?{id:fo,overflow:mo}:null,t.memoizedState={dehydrated:s,treeContext:n,retryLane:1073741824},n=wi(18,null,null,0),n.stateNode=s,n.return=t,t.child=n,Ka=t,qa=null,!0):!1;default:return!1}}function R2(t){return(t.mode&1)!==0&&(t.flags&128)===0}function L2(t){if(Ws){var s=qa;if(s){var n=s;if(!oT(t,s)){if(R2(t))throw Error(Ye(418));s=Cc(n.nextSibling);var a=Ka;s&&oT(t,s)?b8(a,n):(t.flags=t.flags&-4097|2,Ws=!1,Ka=t)}}else{if(R2(t))throw Error(Ye(418));t.flags=t.flags&-4097|2,Ws=!1,Ka=t}}}function cT(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ka=t}function f0(t){if(t!==Ka)return!1;if(!Ws)return cT(t),Ws=!0,!1;var s;if((s=t.tag!==3)&&!(s=t.tag!==5)&&(s=t.type,s=s!=="head"&&s!=="body"&&!I2(t.type,t.memoizedProps)),s&&(s=qa)){if(R2(t))throw v8(),Error(Ye(418));for(;s;)b8(t,s),s=Cc(s.nextSibling)}if(cT(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Ye(317));e:{for(t=t.nextSibling,s=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(s===0){qa=Cc(t.nextSibling);break e}s--}else n!=="$"&&n!=="$!"&&n!=="$?"||s++}t=t.nextSibling}qa=null}}else qa=Ka?Cc(t.stateNode.nextSibling):null;return!0}function v8(){for(var t=qa;t;)t=Cc(t.nextSibling)}function Vh(){qa=Ka=null,Ws=!1}function zC(t){Ki===null?Ki=[t]:Ki.push(t)}var KX=Lo.ReactCurrentBatchConfig;function um(t,s,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Ye(309));var a=n.stateNode}if(!a)throw Error(Ye(147,t));var i=a,l=""+t;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===l?s.ref:(s=function(o){var c=i.refs;o===null?delete c[l]:c[l]=o},s._stringRef=l,s)}if(typeof t!="string")throw Error(Ye(284));if(!n._owner)throw Error(Ye(290,t))}return t}function m0(t,s){throw t=Object.prototype.toString.call(s),Error(Ye(31,t==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":t))}function dT(t){var s=t._init;return s(t._payload)}function w8(t){function s(C,k){if(t){var A=C.deletions;A===null?(C.deletions=[k],C.flags|=16):A.push(k)}}function n(C,k){if(!t)return null;for(;k!==null;)s(C,k),k=k.sibling;return null}function a(C,k){for(C=new Map;k!==null;)k.key!==null?C.set(k.key,k):C.set(k.index,k),k=k.sibling;return C}function i(C,k){return C=Tc(C,k),C.index=0,C.sibling=null,C}function l(C,k,A){return C.index=A,t?(A=C.alternate,A!==null?(A=A.index,A<k?(C.flags|=2,k):A):(C.flags|=2,k)):(C.flags|=1048576,k)}function o(C){return t&&C.alternate===null&&(C.flags|=2),C}function c(C,k,A,T){return k===null||k.tag!==6?(k=aN(A,C.mode,T),k.return=C,k):(k=i(k,A),k.return=C,k)}function d(C,k,A,T){var P=A.type;return P===lh?f(C,k,A.props.children,T,A.key):k!==null&&(k.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===lc&&dT(P)===k.type)?(T=i(k,A.props),T.ref=um(C,k,A),T.return=C,T):(T=Tg(A.type,A.key,A.props,null,C.mode,T),T.ref=um(C,k,A),T.return=C,T)}function u(C,k,A,T){return k===null||k.tag!==4||k.stateNode.containerInfo!==A.containerInfo||k.stateNode.implementation!==A.implementation?(k=iN(A,C.mode,T),k.return=C,k):(k=i(k,A.children||[]),k.return=C,k)}function f(C,k,A,T,P){return k===null||k.tag!==7?(k=Gd(A,C.mode,T,P),k.return=C,k):(k=i(k,A),k.return=C,k)}function m(C,k,A){if(typeof k=="string"&&k!==""||typeof k=="number")return k=aN(""+k,C.mode,A),k.return=C,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case n0:return A=Tg(k.type,k.key,k.props,null,C.mode,A),A.ref=um(C,null,k),A.return=C,A;case ih:return k=iN(k,C.mode,A),k.return=C,k;case lc:var T=k._init;return m(C,T(k._payload),A)}if(Im(k)||im(k))return k=Gd(k,C.mode,A,null),k.return=C,k;m0(C,k)}return null}function x(C,k,A,T){var P=k!==null?k.key:null;if(typeof A=="string"&&A!==""||typeof A=="number")return P!==null?null:c(C,k,""+A,T);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case n0:return A.key===P?d(C,k,A,T):null;case ih:return A.key===P?u(C,k,A,T):null;case lc:return P=A._init,x(C,k,P(A._payload),T)}if(Im(A)||im(A))return P!==null?null:f(C,k,A,T,null);m0(C,A)}return null}function b(C,k,A,T,P){if(typeof T=="string"&&T!==""||typeof T=="number")return C=C.get(A)||null,c(k,C,""+T,P);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case n0:return C=C.get(T.key===null?A:T.key)||null,d(k,C,T,P);case ih:return C=C.get(T.key===null?A:T.key)||null,u(k,C,T,P);case lc:var R=T._init;return b(C,k,A,R(T._payload),P)}if(Im(T)||im(T))return C=C.get(A)||null,f(k,C,T,P,null);m0(k,T)}return null}function w(C,k,A,T){for(var P=null,R=null,I=k,O=k=0,M=null;I!==null&&O<A.length;O++){I.index>O?(M=I,I=null):M=I.sibling;var B=x(C,I,A[O],T);if(B===null){I===null&&(I=M);break}t&&I&&B.alternate===null&&s(C,I),k=l(B,k,O),R===null?P=B:R.sibling=B,R=B,I=M}if(O===A.length)return n(C,I),Ws&&Nd(C,O),P;if(I===null){for(;O<A.length;O++)I=m(C,A[O],T),I!==null&&(k=l(I,k,O),R===null?P=I:R.sibling=I,R=I);return Ws&&Nd(C,O),P}for(I=a(C,I);O<A.length;O++)M=b(I,C,O,A[O],T),M!==null&&(t&&M.alternate!==null&&I.delete(M.key===null?O:M.key),k=l(M,k,O),R===null?P=M:R.sibling=M,R=M);return t&&I.forEach(function(L){return s(C,L)}),Ws&&Nd(C,O),P}function j(C,k,A,T){var P=im(A);if(typeof P!="function")throw Error(Ye(150));if(A=P.call(A),A==null)throw Error(Ye(151));for(var R=P=null,I=k,O=k=0,M=null,B=A.next();I!==null&&!B.done;O++,B=A.next()){I.index>O?(M=I,I=null):M=I.sibling;var L=x(C,I,B.value,T);if(L===null){I===null&&(I=M);break}t&&I&&L.alternate===null&&s(C,I),k=l(L,k,O),R===null?P=L:R.sibling=L,R=L,I=M}if(B.done)return n(C,I),Ws&&Nd(C,O),P;if(I===null){for(;!B.done;O++,B=A.next())B=m(C,B.value,T),B!==null&&(k=l(B,k,O),R===null?P=B:R.sibling=B,R=B);return Ws&&Nd(C,O),P}for(I=a(C,I);!B.done;O++,B=A.next())B=b(I,C,O,B.value,T),B!==null&&(t&&B.alternate!==null&&I.delete(B.key===null?O:B.key),k=l(B,k,O),R===null?P=B:R.sibling=B,R=B);return t&&I.forEach(function(F){return s(C,F)}),Ws&&Nd(C,O),P}function _(C,k,A,T){if(typeof A=="object"&&A!==null&&A.type===lh&&A.key===null&&(A=A.props.children),typeof A=="object"&&A!==null){switch(A.$$typeof){case n0:e:{for(var P=A.key,R=k;R!==null;){if(R.key===P){if(P=A.type,P===lh){if(R.tag===7){n(C,R.sibling),k=i(R,A.props.children),k.return=C,C=k;break e}}else if(R.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===lc&&dT(P)===R.type){n(C,R.sibling),k=i(R,A.props),k.ref=um(C,R,A),k.return=C,C=k;break e}n(C,R);break}else s(C,R);R=R.sibling}A.type===lh?(k=Gd(A.props.children,C.mode,T,A.key),k.return=C,C=k):(T=Tg(A.type,A.key,A.props,null,C.mode,T),T.ref=um(C,k,A),T.return=C,C=T)}return o(C);case ih:e:{for(R=A.key;k!==null;){if(k.key===R)if(k.tag===4&&k.stateNode.containerInfo===A.containerInfo&&k.stateNode.implementation===A.implementation){n(C,k.sibling),k=i(k,A.children||[]),k.return=C,C=k;break e}else{n(C,k);break}else s(C,k);k=k.sibling}k=iN(A,C.mode,T),k.return=C,C=k}return o(C);case lc:return R=A._init,_(C,k,R(A._payload),T)}if(Im(A))return w(C,k,A,T);if(im(A))return j(C,k,A,T);m0(C,A)}return typeof A=="string"&&A!==""||typeof A=="number"?(A=""+A,k!==null&&k.tag===6?(n(C,k.sibling),k=i(k,A),k.return=C,C=k):(n(C,k),k=aN(A,C.mode,T),k.return=C,C=k),o(C)):n(C,k)}return _}var Hh=w8(!0),N8=w8(!1),by=Jc(null),vy=null,ph=null,UC=null;function VC(){UC=ph=vy=null}function HC(t){var s=by.current;Us(by),t._currentValue=s}function B2(t,s,n){for(;t!==null;){var a=t.alternate;if((t.childLanes&s)!==s?(t.childLanes|=s,a!==null&&(a.childLanes|=s)):a!==null&&(a.childLanes&s)!==s&&(a.childLanes|=s),t===n)break;t=t.return}}function Ih(t,s){vy=t,UC=ph=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&s&&(ga=!0),t.firstContext=null)}function ki(t){var s=t._currentValue;if(UC!==t)if(t={context:t,memoizedValue:s,next:null},ph===null){if(vy===null)throw Error(Ye(308));ph=t,vy.dependencies={lanes:0,firstContext:t}}else ph=ph.next=t;return s}var Od=null;function WC(t){Od===null?Od=[t]:Od.push(t)}function j8(t,s,n,a){var i=s.interleaved;return i===null?(n.next=n,WC(s)):(n.next=i.next,i.next=n),s.interleaved=n,jo(t,a)}function jo(t,s){t.lanes|=s;var n=t.alternate;for(n!==null&&(n.lanes|=s),n=t,t=t.return;t!==null;)t.childLanes|=s,n=t.alternate,n!==null&&(n.childLanes|=s),n=t,t=t.return;return n.tag===3?n.stateNode:null}var oc=!1;function qC(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _8(t,s){t=t.updateQueue,s.updateQueue===t&&(s.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function yo(t,s){return{eventTime:t,lane:s,tag:0,payload:null,callback:null,next:null}}function kc(t,s,n){var a=t.updateQueue;if(a===null)return null;if(a=a.shared,as&2){var i=a.pending;return i===null?s.next=s:(s.next=i.next,i.next=s),a.pending=s,jo(t,n)}return i=a.interleaved,i===null?(s.next=s,WC(a)):(s.next=i.next,i.next=s),a.interleaved=s,jo(t,n)}function _g(t,s,n){if(s=s.updateQueue,s!==null&&(s=s.shared,(n&4194240)!==0)){var a=s.lanes;a&=t.pendingLanes,n|=a,s.lanes=n,PC(t,n)}}function uT(t,s){var n=t.updateQueue,a=t.alternate;if(a!==null&&(a=a.updateQueue,n===a)){var i=null,l=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};l===null?i=l=o:l=l.next=o,n=n.next}while(n!==null);l===null?i=l=s:l=l.next=s}else i=l=s;n={baseState:a.baseState,firstBaseUpdate:i,lastBaseUpdate:l,shared:a.shared,effects:a.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=s:t.next=s,n.lastBaseUpdate=s}function wy(t,s,n,a){var i=t.updateQueue;oc=!1;var l=i.firstBaseUpdate,o=i.lastBaseUpdate,c=i.shared.pending;if(c!==null){i.shared.pending=null;var d=c,u=d.next;d.next=null,o===null?l=u:o.next=u,o=d;var f=t.alternate;f!==null&&(f=f.updateQueue,c=f.lastBaseUpdate,c!==o&&(c===null?f.firstBaseUpdate=u:c.next=u,f.lastBaseUpdate=d))}if(l!==null){var m=i.baseState;o=0,f=u=d=null,c=l;do{var x=c.lane,b=c.eventTime;if((a&x)===x){f!==null&&(f=f.next={eventTime:b,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var w=t,j=c;switch(x=s,b=n,j.tag){case 1:if(w=j.payload,typeof w=="function"){m=w.call(b,m,x);break e}m=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=j.payload,x=typeof w=="function"?w.call(b,m,x):w,x==null)break e;m=ln({},m,x);break e;case 2:oc=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,x=i.effects,x===null?i.effects=[c]:x.push(c))}else b={eventTime:b,lane:x,tag:c.tag,payload:c.payload,callback:c.callback,next:null},f===null?(u=f=b,d=m):f=f.next=b,o|=x;if(c=c.next,c===null){if(c=i.shared.pending,c===null)break;x=c,c=x.next,x.next=null,i.lastBaseUpdate=x,i.shared.pending=null}}while(!0);if(f===null&&(d=m),i.baseState=d,i.firstBaseUpdate=u,i.lastBaseUpdate=f,s=i.shared.interleaved,s!==null){i=s;do o|=i.lane,i=i.next;while(i!==s)}else l===null&&(i.shared.lanes=0);cu|=o,t.lanes=o,t.memoizedState=m}}function hT(t,s,n){if(t=s.effects,s.effects=null,t!==null)for(s=0;s<t.length;s++){var a=t[s],i=a.callback;if(i!==null){if(a.callback=null,a=n,typeof i!="function")throw Error(Ye(191,i));i.call(a)}}}var gx={},Rl=Jc(gx),wp=Jc(gx),Np=Jc(gx);function Rd(t){if(t===gx)throw Error(Ye(174));return t}function GC(t,s){switch(Rs(Np,s),Rs(wp,t),Rs(Rl,gx),t=s.nodeType,t){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:y2(null,"");break;default:t=t===8?s.parentNode:s,s=t.namespaceURI||null,t=t.tagName,s=y2(s,t)}Us(Rl),Rs(Rl,s)}function Wh(){Us(Rl),Us(wp),Us(Np)}function S8(t){Rd(Np.current);var s=Rd(Rl.current),n=y2(s,t.type);s!==n&&(Rs(wp,t),Rs(Rl,n))}function KC(t){wp.current===t&&(Us(Rl),Us(wp))}var en=Jc(0);function Ny(t){for(var s=t;s!==null;){if(s.tag===13){var n=s.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Jw=[];function YC(){for(var t=0;t<Jw.length;t++)Jw[t]._workInProgressVersionPrimary=null;Jw.length=0}var Sg=Lo.ReactCurrentDispatcher,eN=Lo.ReactCurrentBatchConfig,ou=0,rn=null,Vn=null,cr=null,jy=!1,Km=!1,jp=0,YX=0;function Mr(){throw Error(Ye(321))}function XC(t,s){if(s===null)return!1;for(var n=0;n<s.length&&n<t.length;n++)if(!sl(t[n],s[n]))return!1;return!0}function QC(t,s,n,a,i,l){if(ou=l,rn=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Sg.current=t===null||t.memoizedState===null?JX:eQ,t=n(a,i),Km){l=0;do{if(Km=!1,jp=0,25<=l)throw Error(Ye(301));l+=1,cr=Vn=null,s.updateQueue=null,Sg.current=tQ,t=n(a,i)}while(Km)}if(Sg.current=_y,s=Vn!==null&&Vn.next!==null,ou=0,cr=Vn=rn=null,jy=!1,s)throw Error(Ye(300));return t}function ZC(){var t=jp!==0;return jp=0,t}function Sl(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return cr===null?rn.memoizedState=cr=t:cr=cr.next=t,cr}function Ai(){if(Vn===null){var t=rn.alternate;t=t!==null?t.memoizedState:null}else t=Vn.next;var s=cr===null?rn.memoizedState:cr.next;if(s!==null)cr=s,Vn=t;else{if(t===null)throw Error(Ye(310));Vn=t,t={memoizedState:Vn.memoizedState,baseState:Vn.baseState,baseQueue:Vn.baseQueue,queue:Vn.queue,next:null},cr===null?rn.memoizedState=cr=t:cr=cr.next=t}return cr}function _p(t,s){return typeof s=="function"?s(t):s}function tN(t){var s=Ai(),n=s.queue;if(n===null)throw Error(Ye(311));n.lastRenderedReducer=t;var a=Vn,i=a.baseQueue,l=n.pending;if(l!==null){if(i!==null){var o=i.next;i.next=l.next,l.next=o}a.baseQueue=i=l,n.pending=null}if(i!==null){l=i.next,a=a.baseState;var c=o=null,d=null,u=l;do{var f=u.lane;if((ou&f)===f)d!==null&&(d=d.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),a=u.hasEagerState?u.eagerState:t(a,u.action);else{var m={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};d===null?(c=d=m,o=a):d=d.next=m,rn.lanes|=f,cu|=f}u=u.next}while(u!==null&&u!==l);d===null?o=a:d.next=c,sl(a,s.memoizedState)||(ga=!0),s.memoizedState=a,s.baseState=o,s.baseQueue=d,n.lastRenderedState=a}if(t=n.interleaved,t!==null){i=t;do l=i.lane,rn.lanes|=l,cu|=l,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[s.memoizedState,n.dispatch]}function sN(t){var s=Ai(),n=s.queue;if(n===null)throw Error(Ye(311));n.lastRenderedReducer=t;var a=n.dispatch,i=n.pending,l=s.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do l=t(l,o.action),o=o.next;while(o!==i);sl(l,s.memoizedState)||(ga=!0),s.memoizedState=l,s.baseQueue===null&&(s.baseState=l),n.lastRenderedState=l}return[l,a]}function C8(){}function k8(t,s){var n=rn,a=Ai(),i=s(),l=!sl(a.memoizedState,i);if(l&&(a.memoizedState=i,ga=!0),a=a.queue,JC(T8.bind(null,n,a,t),[t]),a.getSnapshot!==s||l||cr!==null&&cr.memoizedState.tag&1){if(n.flags|=2048,Sp(9,E8.bind(null,n,a,i,s),void 0,null),ur===null)throw Error(Ye(349));ou&30||A8(n,s,i)}return i}function A8(t,s,n){t.flags|=16384,t={getSnapshot:s,value:n},s=rn.updateQueue,s===null?(s={lastEffect:null,stores:null},rn.updateQueue=s,s.stores=[t]):(n=s.stores,n===null?s.stores=[t]:n.push(t))}function E8(t,s,n,a){s.value=n,s.getSnapshot=a,P8(s)&&I8(t)}function T8(t,s,n){return n(function(){P8(s)&&I8(t)})}function P8(t){var s=t.getSnapshot;t=t.value;try{var n=s();return!sl(t,n)}catch{return!0}}function I8(t){var s=jo(t,1);s!==null&&el(s,t,1,-1)}function fT(t){var s=Sl();return typeof t=="function"&&(t=t()),s.memoizedState=s.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_p,lastRenderedState:t},s.queue=t,t=t.dispatch=ZX.bind(null,rn,t),[s.memoizedState,t]}function Sp(t,s,n,a){return t={tag:t,create:s,destroy:n,deps:a,next:null},s=rn.updateQueue,s===null?(s={lastEffect:null,stores:null},rn.updateQueue=s,s.lastEffect=t.next=t):(n=s.lastEffect,n===null?s.lastEffect=t.next=t:(a=n.next,n.next=t,t.next=a,s.lastEffect=t)),t}function M8(){return Ai().memoizedState}function Cg(t,s,n,a){var i=Sl();rn.flags|=t,i.memoizedState=Sp(1|s,n,void 0,a===void 0?null:a)}function hb(t,s,n,a){var i=Ai();a=a===void 0?null:a;var l=void 0;if(Vn!==null){var o=Vn.memoizedState;if(l=o.destroy,a!==null&&XC(a,o.deps)){i.memoizedState=Sp(s,n,l,a);return}}rn.flags|=t,i.memoizedState=Sp(1|s,n,l,a)}function mT(t,s){return Cg(8390656,8,t,s)}function JC(t,s){return hb(2048,8,t,s)}function D8(t,s){return hb(4,2,t,s)}function O8(t,s){return hb(4,4,t,s)}function R8(t,s){if(typeof s=="function")return t=t(),s(t),function(){s(null)};if(s!=null)return t=t(),s.current=t,function(){s.current=null}}function L8(t,s,n){return n=n!=null?n.concat([t]):null,hb(4,4,R8.bind(null,s,t),n)}function e3(){}function B8(t,s){var n=Ai();s=s===void 0?null:s;var a=n.memoizedState;return a!==null&&s!==null&&XC(s,a[1])?a[0]:(n.memoizedState=[t,s],t)}function F8(t,s){var n=Ai();s=s===void 0?null:s;var a=n.memoizedState;return a!==null&&s!==null&&XC(s,a[1])?a[0]:(t=t(),n.memoizedState=[t,s],t)}function $8(t,s,n){return ou&21?(sl(n,s)||(n=W6(),rn.lanes|=n,cu|=n,t.baseState=!0),s):(t.baseState&&(t.baseState=!1,ga=!0),t.memoizedState=n)}function XX(t,s){var n=ys;ys=n!==0&&4>n?n:4,t(!0);var a=eN.transition;eN.transition={};try{t(!1),s()}finally{ys=n,eN.transition=a}}function z8(){return Ai().memoizedState}function QX(t,s,n){var a=Ec(t);if(n={lane:a,action:n,hasEagerState:!1,eagerState:null,next:null},U8(t))V8(s,n);else if(n=j8(t,s,n,a),n!==null){var i=na();el(n,t,a,i),H8(n,s,a)}}function ZX(t,s,n){var a=Ec(t),i={lane:a,action:n,hasEagerState:!1,eagerState:null,next:null};if(U8(t))V8(s,i);else{var l=t.alternate;if(t.lanes===0&&(l===null||l.lanes===0)&&(l=s.lastRenderedReducer,l!==null))try{var o=s.lastRenderedState,c=l(o,n);if(i.hasEagerState=!0,i.eagerState=c,sl(c,o)){var d=s.interleaved;d===null?(i.next=i,WC(s)):(i.next=d.next,d.next=i),s.interleaved=i;return}}catch{}finally{}n=j8(t,s,i,a),n!==null&&(i=na(),el(n,t,a,i),H8(n,s,a))}}function U8(t){var s=t.alternate;return t===rn||s!==null&&s===rn}function V8(t,s){Km=jy=!0;var n=t.pending;n===null?s.next=s:(s.next=n.next,n.next=s),t.pending=s}function H8(t,s,n){if(n&4194240){var a=s.lanes;a&=t.pendingLanes,n|=a,s.lanes=n,PC(t,n)}}var _y={readContext:ki,useCallback:Mr,useContext:Mr,useEffect:Mr,useImperativeHandle:Mr,useInsertionEffect:Mr,useLayoutEffect:Mr,useMemo:Mr,useReducer:Mr,useRef:Mr,useState:Mr,useDebugValue:Mr,useDeferredValue:Mr,useTransition:Mr,useMutableSource:Mr,useSyncExternalStore:Mr,useId:Mr,unstable_isNewReconciler:!1},JX={readContext:ki,useCallback:function(t,s){return Sl().memoizedState=[t,s===void 0?null:s],t},useContext:ki,useEffect:mT,useImperativeHandle:function(t,s,n){return n=n!=null?n.concat([t]):null,Cg(4194308,4,R8.bind(null,s,t),n)},useLayoutEffect:function(t,s){return Cg(4194308,4,t,s)},useInsertionEffect:function(t,s){return Cg(4,2,t,s)},useMemo:function(t,s){var n=Sl();return s=s===void 0?null:s,t=t(),n.memoizedState=[t,s],t},useReducer:function(t,s,n){var a=Sl();return s=n!==void 0?n(s):s,a.memoizedState=a.baseState=s,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:s},a.queue=t,t=t.dispatch=QX.bind(null,rn,t),[a.memoizedState,t]},useRef:function(t){var s=Sl();return t={current:t},s.memoizedState=t},useState:fT,useDebugValue:e3,useDeferredValue:function(t){return Sl().memoizedState=t},useTransition:function(){var t=fT(!1),s=t[0];return t=XX.bind(null,t[1]),Sl().memoizedState=t,[s,t]},useMutableSource:function(){},useSyncExternalStore:function(t,s,n){var a=rn,i=Sl();if(Ws){if(n===void 0)throw Error(Ye(407));n=n()}else{if(n=s(),ur===null)throw Error(Ye(349));ou&30||A8(a,s,n)}i.memoizedState=n;var l={value:n,getSnapshot:s};return i.queue=l,mT(T8.bind(null,a,l,t),[t]),a.flags|=2048,Sp(9,E8.bind(null,a,l,n,s),void 0,null),n},useId:function(){var t=Sl(),s=ur.identifierPrefix;if(Ws){var n=mo,a=fo;n=(a&~(1<<32-Ji(a)-1)).toString(32)+n,s=":"+s+"R"+n,n=jp++,0<n&&(s+="H"+n.toString(32)),s+=":"}else n=YX++,s=":"+s+"r"+n.toString(32)+":";return t.memoizedState=s},unstable_isNewReconciler:!1},eQ={readContext:ki,useCallback:B8,useContext:ki,useEffect:JC,useImperativeHandle:L8,useInsertionEffect:D8,useLayoutEffect:O8,useMemo:F8,useReducer:tN,useRef:M8,useState:function(){return tN(_p)},useDebugValue:e3,useDeferredValue:function(t){var s=Ai();return $8(s,Vn.memoizedState,t)},useTransition:function(){var t=tN(_p)[0],s=Ai().memoizedState;return[t,s]},useMutableSource:C8,useSyncExternalStore:k8,useId:z8,unstable_isNewReconciler:!1},tQ={readContext:ki,useCallback:B8,useContext:ki,useEffect:JC,useImperativeHandle:L8,useInsertionEffect:D8,useLayoutEffect:O8,useMemo:F8,useReducer:sN,useRef:M8,useState:function(){return sN(_p)},useDebugValue:e3,useDeferredValue:function(t){var s=Ai();return Vn===null?s.memoizedState=t:$8(s,Vn.memoizedState,t)},useTransition:function(){var t=sN(_p)[0],s=Ai().memoizedState;return[t,s]},useMutableSource:C8,useSyncExternalStore:k8,useId:z8,unstable_isNewReconciler:!1};function Wi(t,s){if(t&&t.defaultProps){s=ln({},s),t=t.defaultProps;for(var n in t)s[n]===void 0&&(s[n]=t[n]);return s}return s}function F2(t,s,n,a){s=t.memoizedState,n=n(a,s),n=n==null?s:ln({},s,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var fb={isMounted:function(t){return(t=t._reactInternals)?Pu(t)===t:!1},enqueueSetState:function(t,s,n){t=t._reactInternals;var a=na(),i=Ec(t),l=yo(a,i);l.payload=s,n!=null&&(l.callback=n),s=kc(t,l,i),s!==null&&(el(s,t,i,a),_g(s,t,i))},enqueueReplaceState:function(t,s,n){t=t._reactInternals;var a=na(),i=Ec(t),l=yo(a,i);l.tag=1,l.payload=s,n!=null&&(l.callback=n),s=kc(t,l,i),s!==null&&(el(s,t,i,a),_g(s,t,i))},enqueueForceUpdate:function(t,s){t=t._reactInternals;var n=na(),a=Ec(t),i=yo(n,a);i.tag=2,s!=null&&(i.callback=s),s=kc(t,i,a),s!==null&&(el(s,t,a,n),_g(s,t,a))}};function pT(t,s,n,a,i,l,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(a,l,o):s.prototype&&s.prototype.isPureReactComponent?!gp(n,a)||!gp(i,l):!0}function W8(t,s,n){var a=!1,i=Lc,l=s.contextType;return typeof l=="object"&&l!==null?l=ki(l):(i=wa(s)?iu:Wr.current,a=s.contextTypes,l=(a=a!=null)?Uh(t,i):Lc),s=new s(n,l),t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=fb,t.stateNode=s,s._reactInternals=t,a&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=l),s}function xT(t,s,n,a){t=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(n,a),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(n,a),s.state!==t&&fb.enqueueReplaceState(s,s.state,null)}function $2(t,s,n,a){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},qC(t);var l=s.contextType;typeof l=="object"&&l!==null?i.context=ki(l):(l=wa(s)?iu:Wr.current,i.context=Uh(t,l)),i.state=t.memoizedState,l=s.getDerivedStateFromProps,typeof l=="function"&&(F2(t,s,l,n),i.state=t.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(s=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),s!==i.state&&fb.enqueueReplaceState(i,i.state,null),wy(t,n,i,a),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function qh(t,s){try{var n="",a=s;do n+=EY(a),a=a.return;while(a);var i=n}catch(l){i=`
Error generating stack: `+l.message+`
`+l.stack}return{value:t,source:s,stack:i,digest:null}}function nN(t,s,n){return{value:t,source:null,stack:n??null,digest:s??null}}function z2(t,s){try{console.error(s.value)}catch(n){setTimeout(function(){throw n})}}var sQ=typeof WeakMap=="function"?WeakMap:Map;function q8(t,s,n){n=yo(-1,n),n.tag=3,n.payload={element:null};var a=s.value;return n.callback=function(){Cy||(Cy=!0,Q2=a),z2(t,s)},n}function G8(t,s,n){n=yo(-1,n),n.tag=3;var a=t.type.getDerivedStateFromError;if(typeof a=="function"){var i=s.value;n.payload=function(){return a(i)},n.callback=function(){z2(t,s)}}var l=t.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(n.callback=function(){z2(t,s),typeof a!="function"&&(Ac===null?Ac=new Set([this]):Ac.add(this));var o=s.stack;this.componentDidCatch(s.value,{componentStack:o!==null?o:""})}),n}function gT(t,s,n){var a=t.pingCache;if(a===null){a=t.pingCache=new sQ;var i=new Set;a.set(s,i)}else i=a.get(s),i===void 0&&(i=new Set,a.set(s,i));i.has(n)||(i.add(n),t=xQ.bind(null,t,s,n),s.then(t,t))}function yT(t){do{var s;if((s=t.tag===13)&&(s=t.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return t;t=t.return}while(t!==null);return null}function bT(t,s,n,a,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===s?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(s=yo(-1,1),s.tag=2,kc(n,s,1))),n.lanes|=1),t)}var nQ=Lo.ReactCurrentOwner,ga=!1;function Zr(t,s,n,a){s.child=t===null?N8(s,null,n,a):Hh(s,t.child,n,a)}function vT(t,s,n,a,i){n=n.render;var l=s.ref;return Ih(s,i),a=QC(t,s,n,a,l,i),n=ZC(),t!==null&&!ga?(s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~i,_o(t,s,i)):(Ws&&n&&FC(s),s.flags|=1,Zr(t,s,a,i),s.child)}function wT(t,s,n,a,i){if(t===null){var l=n.type;return typeof l=="function"&&!o3(l)&&l.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(s.tag=15,s.type=l,K8(t,s,l,a,i)):(t=Tg(n.type,null,a,s,s.mode,i),t.ref=s.ref,t.return=s,s.child=t)}if(l=t.child,!(t.lanes&i)){var o=l.memoizedProps;if(n=n.compare,n=n!==null?n:gp,n(o,a)&&t.ref===s.ref)return _o(t,s,i)}return s.flags|=1,t=Tc(l,a),t.ref=s.ref,t.return=s,s.child=t}function K8(t,s,n,a,i){if(t!==null){var l=t.memoizedProps;if(gp(l,a)&&t.ref===s.ref)if(ga=!1,s.pendingProps=a=l,(t.lanes&i)!==0)t.flags&131072&&(ga=!0);else return s.lanes=t.lanes,_o(t,s,i)}return U2(t,s,n,a,i)}function Y8(t,s,n){var a=s.pendingProps,i=a.children,l=t!==null?t.memoizedState:null;if(a.mode==="hidden")if(!(s.mode&1))s.memoizedState={baseLanes:0,cachePool:null,transitions:null},Rs(gh,Fa),Fa|=n;else{if(!(n&1073741824))return t=l!==null?l.baseLanes|n:n,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:t,cachePool:null,transitions:null},s.updateQueue=null,Rs(gh,Fa),Fa|=t,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=l!==null?l.baseLanes:n,Rs(gh,Fa),Fa|=a}else l!==null?(a=l.baseLanes|n,s.memoizedState=null):a=n,Rs(gh,Fa),Fa|=a;return Zr(t,s,i,n),s.child}function X8(t,s){var n=s.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(s.flags|=512,s.flags|=2097152)}function U2(t,s,n,a,i){var l=wa(n)?iu:Wr.current;return l=Uh(s,l),Ih(s,i),n=QC(t,s,n,a,l,i),a=ZC(),t!==null&&!ga?(s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~i,_o(t,s,i)):(Ws&&a&&FC(s),s.flags|=1,Zr(t,s,n,i),s.child)}function NT(t,s,n,a,i){if(wa(n)){var l=!0;xy(s)}else l=!1;if(Ih(s,i),s.stateNode===null)kg(t,s),W8(s,n,a),$2(s,n,a,i),a=!0;else if(t===null){var o=s.stateNode,c=s.memoizedProps;o.props=c;var d=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=ki(u):(u=wa(n)?iu:Wr.current,u=Uh(s,u));var f=n.getDerivedStateFromProps,m=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==a||d!==u)&&xT(s,o,a,u),oc=!1;var x=s.memoizedState;o.state=x,wy(s,a,o,i),d=s.memoizedState,c!==a||x!==d||va.current||oc?(typeof f=="function"&&(F2(s,n,f,a),d=s.memoizedState),(c=oc||pT(s,n,c,a,x,d,u))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(s.flags|=4194308)):(typeof o.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=a,s.memoizedState=d),o.props=a,o.state=d,o.context=u,a=c):(typeof o.componentDidMount=="function"&&(s.flags|=4194308),a=!1)}else{o=s.stateNode,_8(t,s),c=s.memoizedProps,u=s.type===s.elementType?c:Wi(s.type,c),o.props=u,m=s.pendingProps,x=o.context,d=n.contextType,typeof d=="object"&&d!==null?d=ki(d):(d=wa(n)?iu:Wr.current,d=Uh(s,d));var b=n.getDerivedStateFromProps;(f=typeof b=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==m||x!==d)&&xT(s,o,a,d),oc=!1,x=s.memoizedState,o.state=x,wy(s,a,o,i);var w=s.memoizedState;c!==m||x!==w||va.current||oc?(typeof b=="function"&&(F2(s,n,b,a),w=s.memoizedState),(u=oc||pT(s,n,u,a,x,w,d)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(a,w,d),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(a,w,d)),typeof o.componentDidUpdate=="function"&&(s.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&x===t.memoizedState||(s.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&x===t.memoizedState||(s.flags|=1024),s.memoizedProps=a,s.memoizedState=w),o.props=a,o.state=w,o.context=d,a=u):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&x===t.memoizedState||(s.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&x===t.memoizedState||(s.flags|=1024),a=!1)}return V2(t,s,n,a,l,i)}function V2(t,s,n,a,i,l){X8(t,s);var o=(s.flags&128)!==0;if(!a&&!o)return i&&lT(s,n,!1),_o(t,s,l);a=s.stateNode,nQ.current=s;var c=o&&typeof n.getDerivedStateFromError!="function"?null:a.render();return s.flags|=1,t!==null&&o?(s.child=Hh(s,t.child,null,l),s.child=Hh(s,null,c,l)):Zr(t,s,c,l),s.memoizedState=a.state,i&&lT(s,n,!0),s.child}function Q8(t){var s=t.stateNode;s.pendingContext?iT(t,s.pendingContext,s.pendingContext!==s.context):s.context&&iT(t,s.context,!1),GC(t,s.containerInfo)}function jT(t,s,n,a,i){return Vh(),zC(i),s.flags|=256,Zr(t,s,n,a),s.child}var H2={dehydrated:null,treeContext:null,retryLane:0};function W2(t){return{baseLanes:t,cachePool:null,transitions:null}}function Z8(t,s,n){var a=s.pendingProps,i=en.current,l=!1,o=(s.flags&128)!==0,c;if((c=o)||(c=t!==null&&t.memoizedState===null?!1:(i&2)!==0),c?(l=!0,s.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Rs(en,i&1),t===null)return L2(s),t=s.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(s.mode&1?t.data==="$!"?s.lanes=8:s.lanes=1073741824:s.lanes=1,null):(o=a.children,t=a.fallback,l?(a=s.mode,l=s.child,o={mode:"hidden",children:o},!(a&1)&&l!==null?(l.childLanes=0,l.pendingProps=o):l=xb(o,a,0,null),t=Gd(t,a,n,null),l.return=s,t.return=s,l.sibling=t,s.child=l,s.child.memoizedState=W2(n),s.memoizedState=H2,t):t3(s,o));if(i=t.memoizedState,i!==null&&(c=i.dehydrated,c!==null))return rQ(t,s,o,a,c,i,n);if(l){l=a.fallback,o=s.mode,i=t.child,c=i.sibling;var d={mode:"hidden",children:a.children};return!(o&1)&&s.child!==i?(a=s.child,a.childLanes=0,a.pendingProps=d,s.deletions=null):(a=Tc(i,d),a.subtreeFlags=i.subtreeFlags&14680064),c!==null?l=Tc(c,l):(l=Gd(l,o,n,null),l.flags|=2),l.return=s,a.return=s,a.sibling=l,s.child=a,a=l,l=s.child,o=t.child.memoizedState,o=o===null?W2(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},l.memoizedState=o,l.childLanes=t.childLanes&~n,s.memoizedState=H2,a}return l=t.child,t=l.sibling,a=Tc(l,{mode:"visible",children:a.children}),!(s.mode&1)&&(a.lanes=n),a.return=s,a.sibling=null,t!==null&&(n=s.deletions,n===null?(s.deletions=[t],s.flags|=16):n.push(t)),s.child=a,s.memoizedState=null,a}function t3(t,s){return s=xb({mode:"visible",children:s},t.mode,0,null),s.return=t,t.child=s}function p0(t,s,n,a){return a!==null&&zC(a),Hh(s,t.child,null,n),t=t3(s,s.pendingProps.children),t.flags|=2,s.memoizedState=null,t}function rQ(t,s,n,a,i,l,o){if(n)return s.flags&256?(s.flags&=-257,a=nN(Error(Ye(422))),p0(t,s,o,a)):s.memoizedState!==null?(s.child=t.child,s.flags|=128,null):(l=a.fallback,i=s.mode,a=xb({mode:"visible",children:a.children},i,0,null),l=Gd(l,i,o,null),l.flags|=2,a.return=s,l.return=s,a.sibling=l,s.child=a,s.mode&1&&Hh(s,t.child,null,o),s.child.memoizedState=W2(o),s.memoizedState=H2,l);if(!(s.mode&1))return p0(t,s,o,null);if(i.data==="$!"){if(a=i.nextSibling&&i.nextSibling.dataset,a)var c=a.dgst;return a=c,l=Error(Ye(419)),a=nN(l,a,void 0),p0(t,s,o,a)}if(c=(o&t.childLanes)!==0,ga||c){if(a=ur,a!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(a.suspendedLanes|o)?0:i,i!==0&&i!==l.retryLane&&(l.retryLane=i,jo(t,i),el(a,t,i,-1))}return l3(),a=nN(Error(Ye(421))),p0(t,s,o,a)}return i.data==="$?"?(s.flags|=128,s.child=t.child,s=gQ.bind(null,t),i._reactRetry=s,null):(t=l.treeContext,qa=Cc(i.nextSibling),Ka=s,Ws=!0,Ki=null,t!==null&&(bi[vi++]=fo,bi[vi++]=mo,bi[vi++]=lu,fo=t.id,mo=t.overflow,lu=s),s=t3(s,a.children),s.flags|=4096,s)}function _T(t,s,n){t.lanes|=s;var a=t.alternate;a!==null&&(a.lanes|=s),B2(t.return,s,n)}function rN(t,s,n,a,i){var l=t.memoizedState;l===null?t.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:a,tail:n,tailMode:i}:(l.isBackwards=s,l.rendering=null,l.renderingStartTime=0,l.last=a,l.tail=n,l.tailMode=i)}function J8(t,s,n){var a=s.pendingProps,i=a.revealOrder,l=a.tail;if(Zr(t,s,a.children,n),a=en.current,a&2)a=a&1|2,s.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=s.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&_T(t,n,s);else if(t.tag===19)_T(t,n,s);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break e;for(;t.sibling===null;){if(t.return===null||t.return===s)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}a&=1}if(Rs(en,a),!(s.mode&1))s.memoizedState=null;else switch(i){case"forwards":for(n=s.child,i=null;n!==null;)t=n.alternate,t!==null&&Ny(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=s.child,s.child=null):(i=n.sibling,n.sibling=null),rN(s,!1,i,n,l);break;case"backwards":for(n=null,i=s.child,s.child=null;i!==null;){if(t=i.alternate,t!==null&&Ny(t)===null){s.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}rN(s,!0,n,null,l);break;case"together":rN(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function kg(t,s){!(s.mode&1)&&t!==null&&(t.alternate=null,s.alternate=null,s.flags|=2)}function _o(t,s,n){if(t!==null&&(s.dependencies=t.dependencies),cu|=s.lanes,!(n&s.childLanes))return null;if(t!==null&&s.child!==t.child)throw Error(Ye(153));if(s.child!==null){for(t=s.child,n=Tc(t,t.pendingProps),s.child=n,n.return=s;t.sibling!==null;)t=t.sibling,n=n.sibling=Tc(t,t.pendingProps),n.return=s;n.sibling=null}return s.child}function aQ(t,s,n){switch(s.tag){case 3:Q8(s),Vh();break;case 5:S8(s);break;case 1:wa(s.type)&&xy(s);break;case 4:GC(s,s.stateNode.containerInfo);break;case 10:var a=s.type._context,i=s.memoizedProps.value;Rs(by,a._currentValue),a._currentValue=i;break;case 13:if(a=s.memoizedState,a!==null)return a.dehydrated!==null?(Rs(en,en.current&1),s.flags|=128,null):n&s.child.childLanes?Z8(t,s,n):(Rs(en,en.current&1),t=_o(t,s,n),t!==null?t.sibling:null);Rs(en,en.current&1);break;case 19:if(a=(n&s.childLanes)!==0,t.flags&128){if(a)return J8(t,s,n);s.flags|=128}if(i=s.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Rs(en,en.current),a)break;return null;case 22:case 23:return s.lanes=0,Y8(t,s,n)}return _o(t,s,n)}var eL,q2,tL,sL;eL=function(t,s){for(var n=s.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===s)break;for(;n.sibling===null;){if(n.return===null||n.return===s)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};q2=function(){};tL=function(t,s,n,a){var i=t.memoizedProps;if(i!==a){t=s.stateNode,Rd(Rl.current);var l=null;switch(n){case"input":i=m2(t,i),a=m2(t,a),l=[];break;case"select":i=ln({},i,{value:void 0}),a=ln({},a,{value:void 0}),l=[];break;case"textarea":i=g2(t,i),a=g2(t,a),l=[];break;default:typeof i.onClick!="function"&&typeof a.onClick=="function"&&(t.onclick=my)}b2(n,a);var o;n=null;for(u in i)if(!a.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var c=i[u];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(dp.hasOwnProperty(u)?l||(l=[]):(l=l||[]).push(u,null));for(u in a){var d=a[u];if(c=i!=null?i[u]:void 0,a.hasOwnProperty(u)&&d!==c&&(d!=null||c!=null))if(u==="style")if(c){for(o in c)!c.hasOwnProperty(o)||d&&d.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in d)d.hasOwnProperty(o)&&c[o]!==d[o]&&(n||(n={}),n[o]=d[o])}else n||(l||(l=[]),l.push(u,n)),n=d;else u==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,c=c?c.__html:void 0,d!=null&&c!==d&&(l=l||[]).push(u,d)):u==="children"?typeof d!="string"&&typeof d!="number"||(l=l||[]).push(u,""+d):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(dp.hasOwnProperty(u)?(d!=null&&u==="onScroll"&&Fs("scroll",t),l||c===d||(l=[])):(l=l||[]).push(u,d))}n&&(l=l||[]).push("style",n);var u=l;(s.updateQueue=u)&&(s.flags|=4)}};sL=function(t,s,n,a){n!==a&&(s.flags|=4)};function hm(t,s){if(!Ws)switch(t.tailMode){case"hidden":s=t.tail;for(var n=null;s!==null;)s.alternate!==null&&(n=s),s=s.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var a=null;n!==null;)n.alternate!==null&&(a=n),n=n.sibling;a===null?s||t.tail===null?t.tail=null:t.tail.sibling=null:a.sibling=null}}function Dr(t){var s=t.alternate!==null&&t.alternate.child===t.child,n=0,a=0;if(s)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,a|=i.subtreeFlags&14680064,a|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,a|=i.subtreeFlags,a|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=a,t.childLanes=n,s}function iQ(t,s,n){var a=s.pendingProps;switch($C(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dr(s),null;case 1:return wa(s.type)&&py(),Dr(s),null;case 3:return a=s.stateNode,Wh(),Us(va),Us(Wr),YC(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(t===null||t.child===null)&&(f0(s)?s.flags|=4:t===null||t.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,Ki!==null&&(e_(Ki),Ki=null))),q2(t,s),Dr(s),null;case 5:KC(s);var i=Rd(Np.current);if(n=s.type,t!==null&&s.stateNode!=null)tL(t,s,n,a,i),t.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!a){if(s.stateNode===null)throw Error(Ye(166));return Dr(s),null}if(t=Rd(Rl.current),f0(s)){a=s.stateNode,n=s.type;var l=s.memoizedProps;switch(a[Al]=s,a[vp]=l,t=(s.mode&1)!==0,n){case"dialog":Fs("cancel",a),Fs("close",a);break;case"iframe":case"object":case"embed":Fs("load",a);break;case"video":case"audio":for(i=0;i<Dm.length;i++)Fs(Dm[i],a);break;case"source":Fs("error",a);break;case"img":case"image":case"link":Fs("error",a),Fs("load",a);break;case"details":Fs("toggle",a);break;case"input":ME(a,l),Fs("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!l.multiple},Fs("invalid",a);break;case"textarea":OE(a,l),Fs("invalid",a)}b2(n,l),i=null;for(var o in l)if(l.hasOwnProperty(o)){var c=l[o];o==="children"?typeof c=="string"?a.textContent!==c&&(l.suppressHydrationWarning!==!0&&h0(a.textContent,c,t),i=["children",c]):typeof c=="number"&&a.textContent!==""+c&&(l.suppressHydrationWarning!==!0&&h0(a.textContent,c,t),i=["children",""+c]):dp.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&Fs("scroll",a)}switch(n){case"input":r0(a),DE(a,l,!0);break;case"textarea":r0(a),RE(a);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(a.onclick=my)}a=i,s.updateQueue=a,a!==null&&(s.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=T6(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof a.is=="string"?t=o.createElement(n,{is:a.is}):(t=o.createElement(n),n==="select"&&(o=t,a.multiple?o.multiple=!0:a.size&&(o.size=a.size))):t=o.createElementNS(t,n),t[Al]=s,t[vp]=a,eL(t,s,!1,!1),s.stateNode=t;e:{switch(o=v2(n,a),n){case"dialog":Fs("cancel",t),Fs("close",t),i=a;break;case"iframe":case"object":case"embed":Fs("load",t),i=a;break;case"video":case"audio":for(i=0;i<Dm.length;i++)Fs(Dm[i],t);i=a;break;case"source":Fs("error",t),i=a;break;case"img":case"image":case"link":Fs("error",t),Fs("load",t),i=a;break;case"details":Fs("toggle",t),i=a;break;case"input":ME(t,a),i=m2(t,a),Fs("invalid",t);break;case"option":i=a;break;case"select":t._wrapperState={wasMultiple:!!a.multiple},i=ln({},a,{value:void 0}),Fs("invalid",t);break;case"textarea":OE(t,a),i=g2(t,a),Fs("invalid",t);break;default:i=a}b2(n,i),c=i;for(l in c)if(c.hasOwnProperty(l)){var d=c[l];l==="style"?M6(t,d):l==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&P6(t,d)):l==="children"?typeof d=="string"?(n!=="textarea"||d!=="")&&up(t,d):typeof d=="number"&&up(t,""+d):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(dp.hasOwnProperty(l)?d!=null&&l==="onScroll"&&Fs("scroll",t):d!=null&&SC(t,l,d,o))}switch(n){case"input":r0(t),DE(t,a,!1);break;case"textarea":r0(t),RE(t);break;case"option":a.value!=null&&t.setAttribute("value",""+Rc(a.value));break;case"select":t.multiple=!!a.multiple,l=a.value,l!=null?Ah(t,!!a.multiple,l,!1):a.defaultValue!=null&&Ah(t,!!a.multiple,a.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=my)}switch(n){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return Dr(s),null;case 6:if(t&&s.stateNode!=null)sL(t,s,t.memoizedProps,a);else{if(typeof a!="string"&&s.stateNode===null)throw Error(Ye(166));if(n=Rd(Np.current),Rd(Rl.current),f0(s)){if(a=s.stateNode,n=s.memoizedProps,a[Al]=s,(l=a.nodeValue!==n)&&(t=Ka,t!==null))switch(t.tag){case 3:h0(a.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&h0(a.nodeValue,n,(t.mode&1)!==0)}l&&(s.flags|=4)}else a=(n.nodeType===9?n:n.ownerDocument).createTextNode(a),a[Al]=s,s.stateNode=a}return Dr(s),null;case 13:if(Us(en),a=s.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ws&&qa!==null&&s.mode&1&&!(s.flags&128))v8(),Vh(),s.flags|=98560,l=!1;else if(l=f0(s),a!==null&&a.dehydrated!==null){if(t===null){if(!l)throw Error(Ye(318));if(l=s.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(Ye(317));l[Al]=s}else Vh(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;Dr(s),l=!1}else Ki!==null&&(e_(Ki),Ki=null),l=!0;if(!l)return s.flags&65536?s:null}return s.flags&128?(s.lanes=n,s):(a=a!==null,a!==(t!==null&&t.memoizedState!==null)&&a&&(s.child.flags|=8192,s.mode&1&&(t===null||en.current&1?Yn===0&&(Yn=3):l3())),s.updateQueue!==null&&(s.flags|=4),Dr(s),null);case 4:return Wh(),q2(t,s),t===null&&yp(s.stateNode.containerInfo),Dr(s),null;case 10:return HC(s.type._context),Dr(s),null;case 17:return wa(s.type)&&py(),Dr(s),null;case 19:if(Us(en),l=s.memoizedState,l===null)return Dr(s),null;if(a=(s.flags&128)!==0,o=l.rendering,o===null)if(a)hm(l,!1);else{if(Yn!==0||t!==null&&t.flags&128)for(t=s.child;t!==null;){if(o=Ny(t),o!==null){for(s.flags|=128,hm(l,!1),a=o.updateQueue,a!==null&&(s.updateQueue=a,s.flags|=4),s.subtreeFlags=0,a=n,n=s.child;n!==null;)l=n,t=a,l.flags&=14680066,o=l.alternate,o===null?(l.childLanes=0,l.lanes=t,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=o.childLanes,l.lanes=o.lanes,l.child=o.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=o.memoizedProps,l.memoizedState=o.memoizedState,l.updateQueue=o.updateQueue,l.type=o.type,t=o.dependencies,l.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Rs(en,en.current&1|2),s.child}t=t.sibling}l.tail!==null&&_n()>Gh&&(s.flags|=128,a=!0,hm(l,!1),s.lanes=4194304)}else{if(!a)if(t=Ny(o),t!==null){if(s.flags|=128,a=!0,n=t.updateQueue,n!==null&&(s.updateQueue=n,s.flags|=4),hm(l,!0),l.tail===null&&l.tailMode==="hidden"&&!o.alternate&&!Ws)return Dr(s),null}else 2*_n()-l.renderingStartTime>Gh&&n!==1073741824&&(s.flags|=128,a=!0,hm(l,!1),s.lanes=4194304);l.isBackwards?(o.sibling=s.child,s.child=o):(n=l.last,n!==null?n.sibling=o:s.child=o,l.last=o)}return l.tail!==null?(s=l.tail,l.rendering=s,l.tail=s.sibling,l.renderingStartTime=_n(),s.sibling=null,n=en.current,Rs(en,a?n&1|2:n&1),s):(Dr(s),null);case 22:case 23:return i3(),a=s.memoizedState!==null,t!==null&&t.memoizedState!==null!==a&&(s.flags|=8192),a&&s.mode&1?Fa&1073741824&&(Dr(s),s.subtreeFlags&6&&(s.flags|=8192)):Dr(s),null;case 24:return null;case 25:return null}throw Error(Ye(156,s.tag))}function lQ(t,s){switch($C(s),s.tag){case 1:return wa(s.type)&&py(),t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 3:return Wh(),Us(va),Us(Wr),YC(),t=s.flags,t&65536&&!(t&128)?(s.flags=t&-65537|128,s):null;case 5:return KC(s),null;case 13:if(Us(en),t=s.memoizedState,t!==null&&t.dehydrated!==null){if(s.alternate===null)throw Error(Ye(340));Vh()}return t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 19:return Us(en),null;case 4:return Wh(),null;case 10:return HC(s.type._context),null;case 22:case 23:return i3(),null;case 24:return null;default:return null}}var x0=!1,Lr=!1,oQ=typeof WeakSet=="function"?WeakSet:Set,ht=null;function xh(t,s){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(a){mn(t,s,a)}else n.current=null}function G2(t,s,n){try{n()}catch(a){mn(t,s,a)}}var ST=!1;function cQ(t,s){if(T2=uy,t=l8(),BC(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var a=n.getSelection&&n.getSelection();if(a&&a.rangeCount!==0){n=a.anchorNode;var i=a.anchorOffset,l=a.focusNode;a=a.focusOffset;try{n.nodeType,l.nodeType}catch{n=null;break e}var o=0,c=-1,d=-1,u=0,f=0,m=t,x=null;t:for(;;){for(var b;m!==n||i!==0&&m.nodeType!==3||(c=o+i),m!==l||a!==0&&m.nodeType!==3||(d=o+a),m.nodeType===3&&(o+=m.nodeValue.length),(b=m.firstChild)!==null;)x=m,m=b;for(;;){if(m===t)break t;if(x===n&&++u===i&&(c=o),x===l&&++f===a&&(d=o),(b=m.nextSibling)!==null)break;m=x,x=m.parentNode}m=b}n=c===-1||d===-1?null:{start:c,end:d}}else n=null}n=n||{start:0,end:0}}else n=null;for(P2={focusedElem:t,selectionRange:n},uy=!1,ht=s;ht!==null;)if(s=ht,t=s.child,(s.subtreeFlags&1028)!==0&&t!==null)t.return=s,ht=t;else for(;ht!==null;){s=ht;try{var w=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var j=w.memoizedProps,_=w.memoizedState,C=s.stateNode,k=C.getSnapshotBeforeUpdate(s.elementType===s.type?j:Wi(s.type,j),_);C.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var A=s.stateNode.containerInfo;A.nodeType===1?A.textContent="":A.nodeType===9&&A.documentElement&&A.removeChild(A.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ye(163))}}catch(T){mn(s,s.return,T)}if(t=s.sibling,t!==null){t.return=s.return,ht=t;break}ht=s.return}return w=ST,ST=!1,w}function Ym(t,s,n){var a=s.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var i=a=a.next;do{if((i.tag&t)===t){var l=i.destroy;i.destroy=void 0,l!==void 0&&G2(s,n,l)}i=i.next}while(i!==a)}}function mb(t,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var n=s=s.next;do{if((n.tag&t)===t){var a=n.create;n.destroy=a()}n=n.next}while(n!==s)}}function K2(t){var s=t.ref;if(s!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof s=="function"?s(t):s.current=t}}function nL(t){var s=t.alternate;s!==null&&(t.alternate=null,nL(s)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(s=t.stateNode,s!==null&&(delete s[Al],delete s[vp],delete s[D2],delete s[WX],delete s[qX])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function rL(t){return t.tag===5||t.tag===3||t.tag===4}function CT(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||rL(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Y2(t,s,n){var a=t.tag;if(a===5||a===6)t=t.stateNode,s?n.nodeType===8?n.parentNode.insertBefore(t,s):n.insertBefore(t,s):(n.nodeType===8?(s=n.parentNode,s.insertBefore(t,n)):(s=n,s.appendChild(t)),n=n._reactRootContainer,n!=null||s.onclick!==null||(s.onclick=my));else if(a!==4&&(t=t.child,t!==null))for(Y2(t,s,n),t=t.sibling;t!==null;)Y2(t,s,n),t=t.sibling}function X2(t,s,n){var a=t.tag;if(a===5||a===6)t=t.stateNode,s?n.insertBefore(t,s):n.appendChild(t);else if(a!==4&&(t=t.child,t!==null))for(X2(t,s,n),t=t.sibling;t!==null;)X2(t,s,n),t=t.sibling}var _r=null,qi=!1;function Jo(t,s,n){for(n=n.child;n!==null;)aL(t,s,n),n=n.sibling}function aL(t,s,n){if(Ol&&typeof Ol.onCommitFiberUnmount=="function")try{Ol.onCommitFiberUnmount(ib,n)}catch{}switch(n.tag){case 5:Lr||xh(n,s);case 6:var a=_r,i=qi;_r=null,Jo(t,s,n),_r=a,qi=i,_r!==null&&(qi?(t=_r,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):_r.removeChild(n.stateNode));break;case 18:_r!==null&&(qi?(t=_r,n=n.stateNode,t.nodeType===8?Qw(t.parentNode,n):t.nodeType===1&&Qw(t,n),pp(t)):Qw(_r,n.stateNode));break;case 4:a=_r,i=qi,_r=n.stateNode.containerInfo,qi=!0,Jo(t,s,n),_r=a,qi=i;break;case 0:case 11:case 14:case 15:if(!Lr&&(a=n.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){i=a=a.next;do{var l=i,o=l.destroy;l=l.tag,o!==void 0&&(l&2||l&4)&&G2(n,s,o),i=i.next}while(i!==a)}Jo(t,s,n);break;case 1:if(!Lr&&(xh(n,s),a=n.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=n.memoizedProps,a.state=n.memoizedState,a.componentWillUnmount()}catch(c){mn(n,s,c)}Jo(t,s,n);break;case 21:Jo(t,s,n);break;case 22:n.mode&1?(Lr=(a=Lr)||n.memoizedState!==null,Jo(t,s,n),Lr=a):Jo(t,s,n);break;default:Jo(t,s,n)}}function kT(t){var s=t.updateQueue;if(s!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new oQ),s.forEach(function(a){var i=yQ.bind(null,t,a);n.has(a)||(n.add(a),a.then(i,i))})}}function zi(t,s){var n=s.deletions;if(n!==null)for(var a=0;a<n.length;a++){var i=n[a];try{var l=t,o=s,c=o;e:for(;c!==null;){switch(c.tag){case 5:_r=c.stateNode,qi=!1;break e;case 3:_r=c.stateNode.containerInfo,qi=!0;break e;case 4:_r=c.stateNode.containerInfo,qi=!0;break e}c=c.return}if(_r===null)throw Error(Ye(160));aL(l,o,i),_r=null,qi=!1;var d=i.alternate;d!==null&&(d.return=null),i.return=null}catch(u){mn(i,s,u)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)iL(s,t),s=s.sibling}function iL(t,s){var n=t.alternate,a=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(zi(s,t),bl(t),a&4){try{Ym(3,t,t.return),mb(3,t)}catch(j){mn(t,t.return,j)}try{Ym(5,t,t.return)}catch(j){mn(t,t.return,j)}}break;case 1:zi(s,t),bl(t),a&512&&n!==null&&xh(n,n.return);break;case 5:if(zi(s,t),bl(t),a&512&&n!==null&&xh(n,n.return),t.flags&32){var i=t.stateNode;try{up(i,"")}catch(j){mn(t,t.return,j)}}if(a&4&&(i=t.stateNode,i!=null)){var l=t.memoizedProps,o=n!==null?n.memoizedProps:l,c=t.type,d=t.updateQueue;if(t.updateQueue=null,d!==null)try{c==="input"&&l.type==="radio"&&l.name!=null&&A6(i,l),v2(c,o);var u=v2(c,l);for(o=0;o<d.length;o+=2){var f=d[o],m=d[o+1];f==="style"?M6(i,m):f==="dangerouslySetInnerHTML"?P6(i,m):f==="children"?up(i,m):SC(i,f,m,u)}switch(c){case"input":p2(i,l);break;case"textarea":E6(i,l);break;case"select":var x=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!l.multiple;var b=l.value;b!=null?Ah(i,!!l.multiple,b,!1):x!==!!l.multiple&&(l.defaultValue!=null?Ah(i,!!l.multiple,l.defaultValue,!0):Ah(i,!!l.multiple,l.multiple?[]:"",!1))}i[vp]=l}catch(j){mn(t,t.return,j)}}break;case 6:if(zi(s,t),bl(t),a&4){if(t.stateNode===null)throw Error(Ye(162));i=t.stateNode,l=t.memoizedProps;try{i.nodeValue=l}catch(j){mn(t,t.return,j)}}break;case 3:if(zi(s,t),bl(t),a&4&&n!==null&&n.memoizedState.isDehydrated)try{pp(s.containerInfo)}catch(j){mn(t,t.return,j)}break;case 4:zi(s,t),bl(t);break;case 13:zi(s,t),bl(t),i=t.child,i.flags&8192&&(l=i.memoizedState!==null,i.stateNode.isHidden=l,!l||i.alternate!==null&&i.alternate.memoizedState!==null||(r3=_n())),a&4&&kT(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(Lr=(u=Lr)||f,zi(s,t),Lr=u):zi(s,t),bl(t),a&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(ht=t,f=t.child;f!==null;){for(m=ht=f;ht!==null;){switch(x=ht,b=x.child,x.tag){case 0:case 11:case 14:case 15:Ym(4,x,x.return);break;case 1:xh(x,x.return);var w=x.stateNode;if(typeof w.componentWillUnmount=="function"){a=x,n=x.return;try{s=a,w.props=s.memoizedProps,w.state=s.memoizedState,w.componentWillUnmount()}catch(j){mn(a,n,j)}}break;case 5:xh(x,x.return);break;case 22:if(x.memoizedState!==null){ET(m);continue}}b!==null?(b.return=x,ht=b):ET(m)}f=f.sibling}e:for(f=null,m=t;;){if(m.tag===5){if(f===null){f=m;try{i=m.stateNode,u?(l=i.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(c=m.stateNode,d=m.memoizedProps.style,o=d!=null&&d.hasOwnProperty("display")?d.display:null,c.style.display=I6("display",o))}catch(j){mn(t,t.return,j)}}}else if(m.tag===6){if(f===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(j){mn(t,t.return,j)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;f===m&&(f=null),m=m.return}f===m&&(f=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:zi(s,t),bl(t),a&4&&kT(t);break;case 21:break;default:zi(s,t),bl(t)}}function bl(t){var s=t.flags;if(s&2){try{e:{for(var n=t.return;n!==null;){if(rL(n)){var a=n;break e}n=n.return}throw Error(Ye(160))}switch(a.tag){case 5:var i=a.stateNode;a.flags&32&&(up(i,""),a.flags&=-33);var l=CT(t);X2(t,l,i);break;case 3:case 4:var o=a.stateNode.containerInfo,c=CT(t);Y2(t,c,o);break;default:throw Error(Ye(161))}}catch(d){mn(t,t.return,d)}t.flags&=-3}s&4096&&(t.flags&=-4097)}function dQ(t,s,n){ht=t,lL(t)}function lL(t,s,n){for(var a=(t.mode&1)!==0;ht!==null;){var i=ht,l=i.child;if(i.tag===22&&a){var o=i.memoizedState!==null||x0;if(!o){var c=i.alternate,d=c!==null&&c.memoizedState!==null||Lr;c=x0;var u=Lr;if(x0=o,(Lr=d)&&!u)for(ht=i;ht!==null;)o=ht,d=o.child,o.tag===22&&o.memoizedState!==null?TT(i):d!==null?(d.return=o,ht=d):TT(i);for(;l!==null;)ht=l,lL(l),l=l.sibling;ht=i,x0=c,Lr=u}AT(t)}else i.subtreeFlags&8772&&l!==null?(l.return=i,ht=l):AT(t)}}function AT(t){for(;ht!==null;){var s=ht;if(s.flags&8772){var n=s.alternate;try{if(s.flags&8772)switch(s.tag){case 0:case 11:case 15:Lr||mb(5,s);break;case 1:var a=s.stateNode;if(s.flags&4&&!Lr)if(n===null)a.componentDidMount();else{var i=s.elementType===s.type?n.memoizedProps:Wi(s.type,n.memoizedProps);a.componentDidUpdate(i,n.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var l=s.updateQueue;l!==null&&hT(s,l,a);break;case 3:var o=s.updateQueue;if(o!==null){if(n=null,s.child!==null)switch(s.child.tag){case 5:n=s.child.stateNode;break;case 1:n=s.child.stateNode}hT(s,o,n)}break;case 5:var c=s.stateNode;if(n===null&&s.flags&4){n=c;var d=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&n.focus();break;case"img":d.src&&(n.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var u=s.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var m=f.dehydrated;m!==null&&pp(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ye(163))}Lr||s.flags&512&&K2(s)}catch(x){mn(s,s.return,x)}}if(s===t){ht=null;break}if(n=s.sibling,n!==null){n.return=s.return,ht=n;break}ht=s.return}}function ET(t){for(;ht!==null;){var s=ht;if(s===t){ht=null;break}var n=s.sibling;if(n!==null){n.return=s.return,ht=n;break}ht=s.return}}function TT(t){for(;ht!==null;){var s=ht;try{switch(s.tag){case 0:case 11:case 15:var n=s.return;try{mb(4,s)}catch(d){mn(s,n,d)}break;case 1:var a=s.stateNode;if(typeof a.componentDidMount=="function"){var i=s.return;try{a.componentDidMount()}catch(d){mn(s,i,d)}}var l=s.return;try{K2(s)}catch(d){mn(s,l,d)}break;case 5:var o=s.return;try{K2(s)}catch(d){mn(s,o,d)}}}catch(d){mn(s,s.return,d)}if(s===t){ht=null;break}var c=s.sibling;if(c!==null){c.return=s.return,ht=c;break}ht=s.return}}var uQ=Math.ceil,Sy=Lo.ReactCurrentDispatcher,s3=Lo.ReactCurrentOwner,_i=Lo.ReactCurrentBatchConfig,as=0,ur=null,Mn=null,Er=0,Fa=0,gh=Jc(0),Yn=0,Cp=null,cu=0,pb=0,n3=0,Xm=null,pa=null,r3=0,Gh=1/0,oo=null,Cy=!1,Q2=null,Ac=null,g0=!1,yc=null,ky=0,Qm=0,Z2=null,Ag=-1,Eg=0;function na(){return as&6?_n():Ag!==-1?Ag:Ag=_n()}function Ec(t){return t.mode&1?as&2&&Er!==0?Er&-Er:KX.transition!==null?(Eg===0&&(Eg=W6()),Eg):(t=ys,t!==0||(t=window.event,t=t===void 0?16:Z6(t.type)),t):1}function el(t,s,n,a){if(50<Qm)throw Qm=0,Z2=null,Error(Ye(185));mx(t,n,a),(!(as&2)||t!==ur)&&(t===ur&&(!(as&2)&&(pb|=n),Yn===4&&mc(t,Er)),Na(t,a),n===1&&as===0&&!(s.mode&1)&&(Gh=_n()+500,ub&&ed()))}function Na(t,s){var n=t.callbackNode;KY(t,s);var a=dy(t,t===ur?Er:0);if(a===0)n!==null&&FE(n),t.callbackNode=null,t.callbackPriority=0;else if(s=a&-a,t.callbackPriority!==s){if(n!=null&&FE(n),s===1)t.tag===0?GX(PT.bind(null,t)):g8(PT.bind(null,t)),VX(function(){!(as&6)&&ed()}),n=null;else{switch(q6(a)){case 1:n=TC;break;case 4:n=V6;break;case 16:n=cy;break;case 536870912:n=H6;break;default:n=cy}n=pL(n,oL.bind(null,t))}t.callbackPriority=s,t.callbackNode=n}}function oL(t,s){if(Ag=-1,Eg=0,as&6)throw Error(Ye(327));var n=t.callbackNode;if(Mh()&&t.callbackNode!==n)return null;var a=dy(t,t===ur?Er:0);if(a===0)return null;if(a&30||a&t.expiredLanes||s)s=Ay(t,a);else{s=a;var i=as;as|=2;var l=dL();(ur!==t||Er!==s)&&(oo=null,Gh=_n()+500,qd(t,s));do try{mQ();break}catch(c){cL(t,c)}while(!0);VC(),Sy.current=l,as=i,Mn!==null?s=0:(ur=null,Er=0,s=Yn)}if(s!==0){if(s===2&&(i=S2(t),i!==0&&(a=i,s=J2(t,i))),s===1)throw n=Cp,qd(t,0),mc(t,a),Na(t,_n()),n;if(s===6)mc(t,a);else{if(i=t.current.alternate,!(a&30)&&!hQ(i)&&(s=Ay(t,a),s===2&&(l=S2(t),l!==0&&(a=l,s=J2(t,l))),s===1))throw n=Cp,qd(t,0),mc(t,a),Na(t,_n()),n;switch(t.finishedWork=i,t.finishedLanes=a,s){case 0:case 1:throw Error(Ye(345));case 2:jd(t,pa,oo);break;case 3:if(mc(t,a),(a&130023424)===a&&(s=r3+500-_n(),10<s)){if(dy(t,0)!==0)break;if(i=t.suspendedLanes,(i&a)!==a){na(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=M2(jd.bind(null,t,pa,oo),s);break}jd(t,pa,oo);break;case 4:if(mc(t,a),(a&4194240)===a)break;for(s=t.eventTimes,i=-1;0<a;){var o=31-Ji(a);l=1<<o,o=s[o],o>i&&(i=o),a&=~l}if(a=i,a=_n()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*uQ(a/1960))-a,10<a){t.timeoutHandle=M2(jd.bind(null,t,pa,oo),a);break}jd(t,pa,oo);break;case 5:jd(t,pa,oo);break;default:throw Error(Ye(329))}}}return Na(t,_n()),t.callbackNode===n?oL.bind(null,t):null}function J2(t,s){var n=Xm;return t.current.memoizedState.isDehydrated&&(qd(t,s).flags|=256),t=Ay(t,s),t!==2&&(s=pa,pa=n,s!==null&&e_(s)),t}function e_(t){pa===null?pa=t:pa.push.apply(pa,t)}function hQ(t){for(var s=t;;){if(s.flags&16384){var n=s.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var a=0;a<n.length;a++){var i=n[a],l=i.getSnapshot;i=i.value;try{if(!sl(l(),i))return!1}catch{return!1}}}if(n=s.child,s.subtreeFlags&16384&&n!==null)n.return=s,s=n;else{if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function mc(t,s){for(s&=~n3,s&=~pb,t.suspendedLanes|=s,t.pingedLanes&=~s,t=t.expirationTimes;0<s;){var n=31-Ji(s),a=1<<n;t[n]=-1,s&=~a}}function PT(t){if(as&6)throw Error(Ye(327));Mh();var s=dy(t,0);if(!(s&1))return Na(t,_n()),null;var n=Ay(t,s);if(t.tag!==0&&n===2){var a=S2(t);a!==0&&(s=a,n=J2(t,a))}if(n===1)throw n=Cp,qd(t,0),mc(t,s),Na(t,_n()),n;if(n===6)throw Error(Ye(345));return t.finishedWork=t.current.alternate,t.finishedLanes=s,jd(t,pa,oo),Na(t,_n()),null}function a3(t,s){var n=as;as|=1;try{return t(s)}finally{as=n,as===0&&(Gh=_n()+500,ub&&ed())}}function du(t){yc!==null&&yc.tag===0&&!(as&6)&&Mh();var s=as;as|=1;var n=_i.transition,a=ys;try{if(_i.transition=null,ys=1,t)return t()}finally{ys=a,_i.transition=n,as=s,!(as&6)&&ed()}}function i3(){Fa=gh.current,Us(gh)}function qd(t,s){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,UX(n)),Mn!==null)for(n=Mn.return;n!==null;){var a=n;switch($C(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&py();break;case 3:Wh(),Us(va),Us(Wr),YC();break;case 5:KC(a);break;case 4:Wh();break;case 13:Us(en);break;case 19:Us(en);break;case 10:HC(a.type._context);break;case 22:case 23:i3()}n=n.return}if(ur=t,Mn=t=Tc(t.current,null),Er=Fa=s,Yn=0,Cp=null,n3=pb=cu=0,pa=Xm=null,Od!==null){for(s=0;s<Od.length;s++)if(n=Od[s],a=n.interleaved,a!==null){n.interleaved=null;var i=a.next,l=n.pending;if(l!==null){var o=l.next;l.next=i,a.next=o}n.pending=a}Od=null}return t}function cL(t,s){do{var n=Mn;try{if(VC(),Sg.current=_y,jy){for(var a=rn.memoizedState;a!==null;){var i=a.queue;i!==null&&(i.pending=null),a=a.next}jy=!1}if(ou=0,cr=Vn=rn=null,Km=!1,jp=0,s3.current=null,n===null||n.return===null){Yn=1,Cp=s,Mn=null;break}e:{var l=t,o=n.return,c=n,d=s;if(s=Er,c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var u=d,f=c,m=f.tag;if(!(f.mode&1)&&(m===0||m===11||m===15)){var x=f.alternate;x?(f.updateQueue=x.updateQueue,f.memoizedState=x.memoizedState,f.lanes=x.lanes):(f.updateQueue=null,f.memoizedState=null)}var b=yT(o);if(b!==null){b.flags&=-257,bT(b,o,c,l,s),b.mode&1&&gT(l,u,s),s=b,d=u;var w=s.updateQueue;if(w===null){var j=new Set;j.add(d),s.updateQueue=j}else w.add(d);break e}else{if(!(s&1)){gT(l,u,s),l3();break e}d=Error(Ye(426))}}else if(Ws&&c.mode&1){var _=yT(o);if(_!==null){!(_.flags&65536)&&(_.flags|=256),bT(_,o,c,l,s),zC(qh(d,c));break e}}l=d=qh(d,c),Yn!==4&&(Yn=2),Xm===null?Xm=[l]:Xm.push(l),l=o;do{switch(l.tag){case 3:l.flags|=65536,s&=-s,l.lanes|=s;var C=q8(l,d,s);uT(l,C);break e;case 1:c=d;var k=l.type,A=l.stateNode;if(!(l.flags&128)&&(typeof k.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Ac===null||!Ac.has(A)))){l.flags|=65536,s&=-s,l.lanes|=s;var T=G8(l,c,s);uT(l,T);break e}}l=l.return}while(l!==null)}hL(n)}catch(P){s=P,Mn===n&&n!==null&&(Mn=n=n.return);continue}break}while(!0)}function dL(){var t=Sy.current;return Sy.current=_y,t===null?_y:t}function l3(){(Yn===0||Yn===3||Yn===2)&&(Yn=4),ur===null||!(cu&268435455)&&!(pb&268435455)||mc(ur,Er)}function Ay(t,s){var n=as;as|=2;var a=dL();(ur!==t||Er!==s)&&(oo=null,qd(t,s));do try{fQ();break}catch(i){cL(t,i)}while(!0);if(VC(),as=n,Sy.current=a,Mn!==null)throw Error(Ye(261));return ur=null,Er=0,Yn}function fQ(){for(;Mn!==null;)uL(Mn)}function mQ(){for(;Mn!==null&&!FY();)uL(Mn)}function uL(t){var s=mL(t.alternate,t,Fa);t.memoizedProps=t.pendingProps,s===null?hL(t):Mn=s,s3.current=null}function hL(t){var s=t;do{var n=s.alternate;if(t=s.return,s.flags&32768){if(n=lQ(n,s),n!==null){n.flags&=32767,Mn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Yn=6,Mn=null;return}}else if(n=iQ(n,s,Fa),n!==null){Mn=n;return}if(s=s.sibling,s!==null){Mn=s;return}Mn=s=t}while(s!==null);Yn===0&&(Yn=5)}function jd(t,s,n){var a=ys,i=_i.transition;try{_i.transition=null,ys=1,pQ(t,s,n,a)}finally{_i.transition=i,ys=a}return null}function pQ(t,s,n,a){do Mh();while(yc!==null);if(as&6)throw Error(Ye(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Ye(177));t.callbackNode=null,t.callbackPriority=0;var l=n.lanes|n.childLanes;if(YY(t,l),t===ur&&(Mn=ur=null,Er=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||g0||(g0=!0,pL(cy,function(){return Mh(),null})),l=(n.flags&15990)!==0,n.subtreeFlags&15990||l){l=_i.transition,_i.transition=null;var o=ys;ys=1;var c=as;as|=4,s3.current=null,cQ(t,n),iL(n,t),OX(P2),uy=!!T2,P2=T2=null,t.current=n,dQ(n),$Y(),as=c,ys=o,_i.transition=l}else t.current=n;if(g0&&(g0=!1,yc=t,ky=i),l=t.pendingLanes,l===0&&(Ac=null),VY(n.stateNode),Na(t,_n()),s!==null)for(a=t.onRecoverableError,n=0;n<s.length;n++)i=s[n],a(i.value,{componentStack:i.stack,digest:i.digest});if(Cy)throw Cy=!1,t=Q2,Q2=null,t;return ky&1&&t.tag!==0&&Mh(),l=t.pendingLanes,l&1?t===Z2?Qm++:(Qm=0,Z2=t):Qm=0,ed(),null}function Mh(){if(yc!==null){var t=q6(ky),s=_i.transition,n=ys;try{if(_i.transition=null,ys=16>t?16:t,yc===null)var a=!1;else{if(t=yc,yc=null,ky=0,as&6)throw Error(Ye(331));var i=as;for(as|=4,ht=t.current;ht!==null;){var l=ht,o=l.child;if(ht.flags&16){var c=l.deletions;if(c!==null){for(var d=0;d<c.length;d++){var u=c[d];for(ht=u;ht!==null;){var f=ht;switch(f.tag){case 0:case 11:case 15:Ym(8,f,l)}var m=f.child;if(m!==null)m.return=f,ht=m;else for(;ht!==null;){f=ht;var x=f.sibling,b=f.return;if(nL(f),f===u){ht=null;break}if(x!==null){x.return=b,ht=x;break}ht=b}}}var w=l.alternate;if(w!==null){var j=w.child;if(j!==null){w.child=null;do{var _=j.sibling;j.sibling=null,j=_}while(j!==null)}}ht=l}}if(l.subtreeFlags&2064&&o!==null)o.return=l,ht=o;else e:for(;ht!==null;){if(l=ht,l.flags&2048)switch(l.tag){case 0:case 11:case 15:Ym(9,l,l.return)}var C=l.sibling;if(C!==null){C.return=l.return,ht=C;break e}ht=l.return}}var k=t.current;for(ht=k;ht!==null;){o=ht;var A=o.child;if(o.subtreeFlags&2064&&A!==null)A.return=o,ht=A;else e:for(o=k;ht!==null;){if(c=ht,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:mb(9,c)}}catch(P){mn(c,c.return,P)}if(c===o){ht=null;break e}var T=c.sibling;if(T!==null){T.return=c.return,ht=T;break e}ht=c.return}}if(as=i,ed(),Ol&&typeof Ol.onPostCommitFiberRoot=="function")try{Ol.onPostCommitFiberRoot(ib,t)}catch{}a=!0}return a}finally{ys=n,_i.transition=s}}return!1}function IT(t,s,n){s=qh(n,s),s=q8(t,s,1),t=kc(t,s,1),s=na(),t!==null&&(mx(t,1,s),Na(t,s))}function mn(t,s,n){if(t.tag===3)IT(t,t,n);else for(;s!==null;){if(s.tag===3){IT(s,t,n);break}else if(s.tag===1){var a=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(Ac===null||!Ac.has(a))){t=qh(n,t),t=G8(s,t,1),s=kc(s,t,1),t=na(),s!==null&&(mx(s,1,t),Na(s,t));break}}s=s.return}}function xQ(t,s,n){var a=t.pingCache;a!==null&&a.delete(s),s=na(),t.pingedLanes|=t.suspendedLanes&n,ur===t&&(Er&n)===n&&(Yn===4||Yn===3&&(Er&130023424)===Er&&500>_n()-r3?qd(t,0):n3|=n),Na(t,s)}function fL(t,s){s===0&&(t.mode&1?(s=l0,l0<<=1,!(l0&130023424)&&(l0=4194304)):s=1);var n=na();t=jo(t,s),t!==null&&(mx(t,s,n),Na(t,n))}function gQ(t){var s=t.memoizedState,n=0;s!==null&&(n=s.retryLane),fL(t,n)}function yQ(t,s){var n=0;switch(t.tag){case 13:var a=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:a=t.stateNode;break;default:throw Error(Ye(314))}a!==null&&a.delete(s),fL(t,n)}var mL;mL=function(t,s,n){if(t!==null)if(t.memoizedProps!==s.pendingProps||va.current)ga=!0;else{if(!(t.lanes&n)&&!(s.flags&128))return ga=!1,aQ(t,s,n);ga=!!(t.flags&131072)}else ga=!1,Ws&&s.flags&1048576&&y8(s,yy,s.index);switch(s.lanes=0,s.tag){case 2:var a=s.type;kg(t,s),t=s.pendingProps;var i=Uh(s,Wr.current);Ih(s,n),i=QC(null,s,a,t,i,n);var l=ZC();return s.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,wa(a)?(l=!0,xy(s)):l=!1,s.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,qC(s),i.updater=fb,s.stateNode=i,i._reactInternals=s,$2(s,a,t,n),s=V2(null,s,a,!0,l,n)):(s.tag=0,Ws&&l&&FC(s),Zr(null,s,i,n),s=s.child),s;case 16:a=s.elementType;e:{switch(kg(t,s),t=s.pendingProps,i=a._init,a=i(a._payload),s.type=a,i=s.tag=vQ(a),t=Wi(a,t),i){case 0:s=U2(null,s,a,t,n);break e;case 1:s=NT(null,s,a,t,n);break e;case 11:s=vT(null,s,a,t,n);break e;case 14:s=wT(null,s,a,Wi(a.type,t),n);break e}throw Error(Ye(306,a,""))}return s;case 0:return a=s.type,i=s.pendingProps,i=s.elementType===a?i:Wi(a,i),U2(t,s,a,i,n);case 1:return a=s.type,i=s.pendingProps,i=s.elementType===a?i:Wi(a,i),NT(t,s,a,i,n);case 3:e:{if(Q8(s),t===null)throw Error(Ye(387));a=s.pendingProps,l=s.memoizedState,i=l.element,_8(t,s),wy(s,a,null,n);var o=s.memoizedState;if(a=o.element,l.isDehydrated)if(l={element:a,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},s.updateQueue.baseState=l,s.memoizedState=l,s.flags&256){i=qh(Error(Ye(423)),s),s=jT(t,s,a,n,i);break e}else if(a!==i){i=qh(Error(Ye(424)),s),s=jT(t,s,a,n,i);break e}else for(qa=Cc(s.stateNode.containerInfo.firstChild),Ka=s,Ws=!0,Ki=null,n=N8(s,null,a,n),s.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Vh(),a===i){s=_o(t,s,n);break e}Zr(t,s,a,n)}s=s.child}return s;case 5:return S8(s),t===null&&L2(s),a=s.type,i=s.pendingProps,l=t!==null?t.memoizedProps:null,o=i.children,I2(a,i)?o=null:l!==null&&I2(a,l)&&(s.flags|=32),X8(t,s),Zr(t,s,o,n),s.child;case 6:return t===null&&L2(s),null;case 13:return Z8(t,s,n);case 4:return GC(s,s.stateNode.containerInfo),a=s.pendingProps,t===null?s.child=Hh(s,null,a,n):Zr(t,s,a,n),s.child;case 11:return a=s.type,i=s.pendingProps,i=s.elementType===a?i:Wi(a,i),vT(t,s,a,i,n);case 7:return Zr(t,s,s.pendingProps,n),s.child;case 8:return Zr(t,s,s.pendingProps.children,n),s.child;case 12:return Zr(t,s,s.pendingProps.children,n),s.child;case 10:e:{if(a=s.type._context,i=s.pendingProps,l=s.memoizedProps,o=i.value,Rs(by,a._currentValue),a._currentValue=o,l!==null)if(sl(l.value,o)){if(l.children===i.children&&!va.current){s=_o(t,s,n);break e}}else for(l=s.child,l!==null&&(l.return=s);l!==null;){var c=l.dependencies;if(c!==null){o=l.child;for(var d=c.firstContext;d!==null;){if(d.context===a){if(l.tag===1){d=yo(-1,n&-n),d.tag=2;var u=l.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?d.next=d:(d.next=f.next,f.next=d),u.pending=d}}l.lanes|=n,d=l.alternate,d!==null&&(d.lanes|=n),B2(l.return,n,s),c.lanes|=n;break}d=d.next}}else if(l.tag===10)o=l.type===s.type?null:l.child;else if(l.tag===18){if(o=l.return,o===null)throw Error(Ye(341));o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),B2(o,n,s),o=l.sibling}else o=l.child;if(o!==null)o.return=l;else for(o=l;o!==null;){if(o===s){o=null;break}if(l=o.sibling,l!==null){l.return=o.return,o=l;break}o=o.return}l=o}Zr(t,s,i.children,n),s=s.child}return s;case 9:return i=s.type,a=s.pendingProps.children,Ih(s,n),i=ki(i),a=a(i),s.flags|=1,Zr(t,s,a,n),s.child;case 14:return a=s.type,i=Wi(a,s.pendingProps),i=Wi(a.type,i),wT(t,s,a,i,n);case 15:return K8(t,s,s.type,s.pendingProps,n);case 17:return a=s.type,i=s.pendingProps,i=s.elementType===a?i:Wi(a,i),kg(t,s),s.tag=1,wa(a)?(t=!0,xy(s)):t=!1,Ih(s,n),W8(s,a,i),$2(s,a,i,n),V2(null,s,a,!0,t,n);case 19:return J8(t,s,n);case 22:return Y8(t,s,n)}throw Error(Ye(156,s.tag))};function pL(t,s){return U6(t,s)}function bQ(t,s,n,a){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wi(t,s,n,a){return new bQ(t,s,n,a)}function o3(t){return t=t.prototype,!(!t||!t.isReactComponent)}function vQ(t){if(typeof t=="function")return o3(t)?1:0;if(t!=null){if(t=t.$$typeof,t===kC)return 11;if(t===AC)return 14}return 2}function Tc(t,s){var n=t.alternate;return n===null?(n=wi(t.tag,s,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=s,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,s=t.dependencies,n.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Tg(t,s,n,a,i,l){var o=2;if(a=t,typeof t=="function")o3(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case lh:return Gd(n.children,i,l,s);case CC:o=8,i|=8;break;case d2:return t=wi(12,n,s,i|2),t.elementType=d2,t.lanes=l,t;case u2:return t=wi(13,n,s,i),t.elementType=u2,t.lanes=l,t;case h2:return t=wi(19,n,s,i),t.elementType=h2,t.lanes=l,t;case S6:return xb(n,i,l,s);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case j6:o=10;break e;case _6:o=9;break e;case kC:o=11;break e;case AC:o=14;break e;case lc:o=16,a=null;break e}throw Error(Ye(130,t==null?t:typeof t,""))}return s=wi(o,n,s,i),s.elementType=t,s.type=a,s.lanes=l,s}function Gd(t,s,n,a){return t=wi(7,t,a,s),t.lanes=n,t}function xb(t,s,n,a){return t=wi(22,t,a,s),t.elementType=S6,t.lanes=n,t.stateNode={isHidden:!1},t}function aN(t,s,n){return t=wi(6,t,null,s),t.lanes=n,t}function iN(t,s,n){return s=wi(4,t.children!==null?t.children:[],t.key,s),s.lanes=n,s.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},s}function wQ(t,s,n,a,i){this.tag=s,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$w(0),this.expirationTimes=$w(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$w(0),this.identifierPrefix=a,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function c3(t,s,n,a,i,l,o,c,d){return t=new wQ(t,s,n,c,d),s===1?(s=1,l===!0&&(s|=8)):s=0,l=wi(3,null,null,s),t.current=l,l.stateNode=t,l.memoizedState={element:a,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},qC(l),t}function NQ(t,s,n){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ih,key:a==null?null:""+a,children:t,containerInfo:s,implementation:n}}function xL(t){if(!t)return Lc;t=t._reactInternals;e:{if(Pu(t)!==t||t.tag!==1)throw Error(Ye(170));var s=t;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(wa(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(Ye(171))}if(t.tag===1){var n=t.type;if(wa(n))return x8(t,n,s)}return s}function gL(t,s,n,a,i,l,o,c,d){return t=c3(n,a,!0,t,i,l,o,c,d),t.context=xL(null),n=t.current,a=na(),i=Ec(n),l=yo(a,i),l.callback=s??null,kc(n,l,i),t.current.lanes=i,mx(t,i,a),Na(t,a),t}function gb(t,s,n,a){var i=s.current,l=na(),o=Ec(i);return n=xL(n),s.context===null?s.context=n:s.pendingContext=n,s=yo(l,o),s.payload={element:t},a=a===void 0?null:a,a!==null&&(s.callback=a),t=kc(i,s,o),t!==null&&(el(t,i,o,l),_g(t,i,o)),o}function Ey(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function MT(t,s){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<s?n:s}}function d3(t,s){MT(t,s),(t=t.alternate)&&MT(t,s)}function jQ(){return null}var yL=typeof reportError=="function"?reportError:function(t){console.error(t)};function u3(t){this._internalRoot=t}yb.prototype.render=u3.prototype.render=function(t){var s=this._internalRoot;if(s===null)throw Error(Ye(409));gb(t,s,null,null)};yb.prototype.unmount=u3.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var s=t.containerInfo;du(function(){gb(null,t,null,null)}),s[No]=null}};function yb(t){this._internalRoot=t}yb.prototype.unstable_scheduleHydration=function(t){if(t){var s=Y6();t={blockedOn:null,target:t,priority:s};for(var n=0;n<fc.length&&s!==0&&s<fc[n].priority;n++);fc.splice(n,0,t),n===0&&Q6(t)}};function h3(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function bb(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function DT(){}function _Q(t,s,n,a,i){if(i){if(typeof a=="function"){var l=a;a=function(){var u=Ey(o);l.call(u)}}var o=gL(s,a,t,0,null,!1,!1,"",DT);return t._reactRootContainer=o,t[No]=o.current,yp(t.nodeType===8?t.parentNode:t),du(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof a=="function"){var c=a;a=function(){var u=Ey(d);c.call(u)}}var d=c3(t,0,!1,null,null,!1,!1,"",DT);return t._reactRootContainer=d,t[No]=d.current,yp(t.nodeType===8?t.parentNode:t),du(function(){gb(s,d,n,a)}),d}function vb(t,s,n,a,i){var l=n._reactRootContainer;if(l){var o=l;if(typeof i=="function"){var c=i;i=function(){var d=Ey(o);c.call(d)}}gb(s,o,t,i)}else o=_Q(n,s,t,i,a);return Ey(o)}G6=function(t){switch(t.tag){case 3:var s=t.stateNode;if(s.current.memoizedState.isDehydrated){var n=Mm(s.pendingLanes);n!==0&&(PC(s,n|1),Na(s,_n()),!(as&6)&&(Gh=_n()+500,ed()))}break;case 13:du(function(){var a=jo(t,1);if(a!==null){var i=na();el(a,t,1,i)}}),d3(t,1)}};IC=function(t){if(t.tag===13){var s=jo(t,134217728);if(s!==null){var n=na();el(s,t,134217728,n)}d3(t,134217728)}};K6=function(t){if(t.tag===13){var s=Ec(t),n=jo(t,s);if(n!==null){var a=na();el(n,t,s,a)}d3(t,s)}};Y6=function(){return ys};X6=function(t,s){var n=ys;try{return ys=t,s()}finally{ys=n}};N2=function(t,s,n){switch(s){case"input":if(p2(t,n),s=n.name,n.type==="radio"&&s!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<n.length;s++){var a=n[s];if(a!==t&&a.form===t.form){var i=db(a);if(!i)throw Error(Ye(90));k6(a),p2(a,i)}}}break;case"textarea":E6(t,n);break;case"select":s=n.value,s!=null&&Ah(t,!!n.multiple,s,!1)}};R6=a3;L6=du;var SQ={usingClientEntryPoint:!1,Events:[xx,uh,db,D6,O6,a3]},fm={findFiberByHostInstance:Dd,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},CQ={bundleType:fm.bundleType,version:fm.version,rendererPackageName:fm.rendererPackageName,rendererConfig:fm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Lo.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=$6(t),t===null?null:t.stateNode},findFiberByHostInstance:fm.findFiberByHostInstance||jQ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var y0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!y0.isDisabled&&y0.supportsFiber)try{ib=y0.inject(CQ),Ol=y0}catch{}}si.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=SQ;si.createPortal=function(t,s){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h3(s))throw Error(Ye(200));return NQ(t,s,null,n)};si.createRoot=function(t,s){if(!h3(t))throw Error(Ye(299));var n=!1,a="",i=yL;return s!=null&&(s.unstable_strictMode===!0&&(n=!0),s.identifierPrefix!==void 0&&(a=s.identifierPrefix),s.onRecoverableError!==void 0&&(i=s.onRecoverableError)),s=c3(t,1,!1,null,null,n,!1,a,i),t[No]=s.current,yp(t.nodeType===8?t.parentNode:t),new u3(s)};si.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var s=t._reactInternals;if(s===void 0)throw typeof t.render=="function"?Error(Ye(188)):(t=Object.keys(t).join(","),Error(Ye(268,t)));return t=$6(s),t=t===null?null:t.stateNode,t};si.flushSync=function(t){return du(t)};si.hydrate=function(t,s,n){if(!bb(s))throw Error(Ye(200));return vb(null,t,s,!0,n)};si.hydrateRoot=function(t,s,n){if(!h3(t))throw Error(Ye(405));var a=n!=null&&n.hydratedSources||null,i=!1,l="",o=yL;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),s=gL(s,null,t,1,n??null,i,!1,l,o),t[No]=s.current,yp(t),a)for(t=0;t<a.length;t++)n=a[t],i=n._getVersion,i=i(n._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[n,i]:s.mutableSourceEagerHydrationData.push(n,i);return new yb(s)};si.render=function(t,s,n){if(!bb(s))throw Error(Ye(200));return vb(null,t,s,!1,n)};si.unmountComponentAtNode=function(t){if(!bb(t))throw Error(Ye(40));return t._reactRootContainer?(du(function(){vb(null,null,t,!1,function(){t._reactRootContainer=null,t[No]=null})}),!0):!1};si.unstable_batchedUpdates=a3;si.unstable_renderSubtreeIntoContainer=function(t,s,n,a){if(!bb(n))throw Error(Ye(200));if(t==null||t._reactInternals===void 0)throw Error(Ye(38));return vb(t,s,n,!1,a)};si.version="18.3.1-next-f1338f8080-20240426";function bL(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(bL)}catch(t){console.error(t)}}bL(),b6.exports=si;var td=b6.exports;const vL=Mi(td);var OT=td;o2.createRoot=OT.createRoot,o2.hydrateRoot=OT.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function kp(){return kp=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},kp.apply(this,arguments)}var bc;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(bc||(bc={}));const RT="popstate";function kQ(t){t===void 0&&(t={});function s(a,i){let{pathname:l,search:o,hash:c}=a.location;return t_("",{pathname:l,search:o,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(a,i){return typeof i=="string"?i:Ty(i)}return EQ(s,n,null,t)}function an(t,s){if(t===!1||t===null||typeof t>"u")throw new Error(s)}function wL(t,s){if(!t){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function AQ(){return Math.random().toString(36).substr(2,8)}function LT(t,s){return{usr:t.state,key:t.key,idx:s}}function t_(t,s,n,a){return n===void 0&&(n=null),kp({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof s=="string"?wf(s):s,{state:n,key:s&&s.key||a||AQ()})}function Ty(t){let{pathname:s="/",search:n="",hash:a=""}=t;return n&&n!=="?"&&(s+=n.charAt(0)==="?"?n:"?"+n),a&&a!=="#"&&(s+=a.charAt(0)==="#"?a:"#"+a),s}function wf(t){let s={};if(t){let n=t.indexOf("#");n>=0&&(s.hash=t.substr(n),t=t.substr(0,n));let a=t.indexOf("?");a>=0&&(s.search=t.substr(a),t=t.substr(0,a)),t&&(s.pathname=t)}return s}function EQ(t,s,n,a){a===void 0&&(a={});let{window:i=document.defaultView,v5Compat:l=!1}=a,o=i.history,c=bc.Pop,d=null,u=f();u==null&&(u=0,o.replaceState(kp({},o.state,{idx:u}),""));function f(){return(o.state||{idx:null}).idx}function m(){c=bc.Pop;let _=f(),C=_==null?null:_-u;u=_,d&&d({action:c,location:j.location,delta:C})}function x(_,C){c=bc.Push;let k=t_(j.location,_,C);u=f()+1;let A=LT(k,u),T=j.createHref(k);try{o.pushState(A,"",T)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;i.location.assign(T)}l&&d&&d({action:c,location:j.location,delta:1})}function b(_,C){c=bc.Replace;let k=t_(j.location,_,C);u=f();let A=LT(k,u),T=j.createHref(k);o.replaceState(A,"",T),l&&d&&d({action:c,location:j.location,delta:0})}function w(_){let C=i.location.origin!=="null"?i.location.origin:i.location.href,k=typeof _=="string"?_:Ty(_);return k=k.replace(/ $/,"%20"),an(C,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,C)}let j={get action(){return c},get location(){return t(i,o)},listen(_){if(d)throw new Error("A history only accepts one active listener");return i.addEventListener(RT,m),d=_,()=>{i.removeEventListener(RT,m),d=null}},createHref(_){return s(i,_)},createURL:w,encodeLocation(_){let C=w(_);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:x,replace:b,go(_){return o.go(_)}};return j}var BT;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(BT||(BT={}));function TQ(t,s,n){return n===void 0&&(n="/"),PQ(t,s,n)}function PQ(t,s,n,a){let i=typeof s=="string"?wf(s):s,l=Kh(i.pathname||"/",n);if(l==null)return null;let o=NL(t);IQ(o);let c=null;for(let d=0;c==null&&d<o.length;++d){let u=VQ(l);c=zQ(o[d],u)}return c}function NL(t,s,n,a){s===void 0&&(s=[]),n===void 0&&(n=[]),a===void 0&&(a="");let i=(l,o,c)=>{let d={relativePath:c===void 0?l.path||"":c,caseSensitive:l.caseSensitive===!0,childrenIndex:o,route:l};d.relativePath.startsWith("/")&&(an(d.relativePath.startsWith(a),'Absolute route path "'+d.relativePath+'" nested under path '+('"'+a+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),d.relativePath=d.relativePath.slice(a.length));let u=Pc([a,d.relativePath]),f=n.concat(d);l.children&&l.children.length>0&&(an(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),NL(l.children,s,f,u)),!(l.path==null&&!l.index)&&s.push({path:u,score:FQ(u,l.index),routesMeta:f})};return t.forEach((l,o)=>{var c;if(l.path===""||!((c=l.path)!=null&&c.includes("?")))i(l,o);else for(let d of jL(l.path))i(l,o,d)}),s}function jL(t){let s=t.split("/");if(s.length===0)return[];let[n,...a]=s,i=n.endsWith("?"),l=n.replace(/\?$/,"");if(a.length===0)return i?[l,""]:[l];let o=jL(a.join("/")),c=[];return c.push(...o.map(d=>d===""?l:[l,d].join("/"))),i&&c.push(...o),c.map(d=>t.startsWith("/")&&d===""?"/":d)}function IQ(t){t.sort((s,n)=>s.score!==n.score?n.score-s.score:$Q(s.routesMeta.map(a=>a.childrenIndex),n.routesMeta.map(a=>a.childrenIndex)))}const MQ=/^:[\w-]+$/,DQ=3,OQ=2,RQ=1,LQ=10,BQ=-2,FT=t=>t==="*";function FQ(t,s){let n=t.split("/"),a=n.length;return n.some(FT)&&(a+=BQ),s&&(a+=OQ),n.filter(i=>!FT(i)).reduce((i,l)=>i+(MQ.test(l)?DQ:l===""?RQ:LQ),a)}function $Q(t,s){return t.length===s.length&&t.slice(0,-1).every((a,i)=>a===s[i])?t[t.length-1]-s[s.length-1]:0}function zQ(t,s,n){let{routesMeta:a}=t,i={},l="/",o=[];for(let c=0;c<a.length;++c){let d=a[c],u=c===a.length-1,f=l==="/"?s:s.slice(l.length)||"/",m=s_({path:d.relativePath,caseSensitive:d.caseSensitive,end:u},f),x=d.route;if(!m)return null;Object.assign(i,m.params),o.push({params:i,pathname:Pc([l,m.pathname]),pathnameBase:GQ(Pc([l,m.pathnameBase])),route:x}),m.pathnameBase!=="/"&&(l=Pc([l,m.pathnameBase]))}return o}function s_(t,s){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,a]=UQ(t.path,t.caseSensitive,t.end),i=s.match(n);if(!i)return null;let l=i[0],o=l.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:a.reduce((u,f,m)=>{let{paramName:x,isOptional:b}=f;if(x==="*"){let j=c[m]||"";o=l.slice(0,l.length-j.length).replace(/(.)\/+$/,"$1")}const w=c[m];return b&&!w?u[x]=void 0:u[x]=(w||"").replace(/%2F/g,"/"),u},{}),pathname:l,pathnameBase:o,pattern:t}}function UQ(t,s,n){s===void 0&&(s=!1),n===void 0&&(n=!0),wL(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let a=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,d)=>(a.push({paramName:c,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(a.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,s?void 0:"i"),a]}function VQ(t){try{return t.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return wL(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+s+").")),t}}function Kh(t,s){if(s==="/")return t;if(!t.toLowerCase().startsWith(s.toLowerCase()))return null;let n=s.endsWith("/")?s.length-1:s.length,a=t.charAt(n);return a&&a!=="/"?null:t.slice(n)||"/"}function HQ(t,s){s===void 0&&(s="/");let{pathname:n,search:a="",hash:i=""}=typeof t=="string"?wf(t):t;return{pathname:n?n.startsWith("/")?n:WQ(n,s):s,search:KQ(a),hash:YQ(i)}}function WQ(t,s){let n=s.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function lN(t,s,n,a){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+s+"` field ["+JSON.stringify(a)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function qQ(t){return t.filter((s,n)=>n===0||s.route.path&&s.route.path.length>0)}function f3(t,s){let n=qQ(t);return s?n.map((a,i)=>i===n.length-1?a.pathname:a.pathnameBase):n.map(a=>a.pathnameBase)}function m3(t,s,n,a){a===void 0&&(a=!1);let i;typeof t=="string"?i=wf(t):(i=kp({},t),an(!i.pathname||!i.pathname.includes("?"),lN("?","pathname","search",i)),an(!i.pathname||!i.pathname.includes("#"),lN("#","pathname","hash",i)),an(!i.search||!i.search.includes("#"),lN("#","search","hash",i)));let l=t===""||i.pathname==="",o=l?"/":i.pathname,c;if(o==null)c=n;else{let m=s.length-1;if(!a&&o.startsWith("..")){let x=o.split("/");for(;x[0]==="..";)x.shift(),m-=1;i.pathname=x.join("/")}c=m>=0?s[m]:"/"}let d=HQ(i,c),u=o&&o!=="/"&&o.endsWith("/"),f=(l||o===".")&&n.endsWith("/");return!d.pathname.endsWith("/")&&(u||f)&&(d.pathname+="/"),d}const Pc=t=>t.join("/").replace(/\/\/+/g,"/"),GQ=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),KQ=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,YQ=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function XQ(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const _L=["post","put","patch","delete"];new Set(_L);const QQ=["get",..._L];new Set(QQ);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ap(){return Ap=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Ap.apply(this,arguments)}const wb=y.createContext(null),SL=y.createContext(null),Bo=y.createContext(null),Nb=y.createContext(null),Xl=y.createContext({outlet:null,matches:[],isDataRoute:!1}),CL=y.createContext(null);function ZQ(t,s){let{relative:n}=s===void 0?{}:s;Nf()||an(!1);let{basename:a,navigator:i}=y.useContext(Bo),{hash:l,pathname:o,search:c}=jb(t,{relative:n}),d=o;return a!=="/"&&(d=o==="/"?a:Pc([a,o])),i.createHref({pathname:d,search:c,hash:l})}function Nf(){return y.useContext(Nb)!=null}function Di(){return Nf()||an(!1),y.useContext(Nb).location}function kL(t){y.useContext(Bo).static||y.useLayoutEffect(t)}function Ta(){let{isDataRoute:t}=y.useContext(Xl);return t?fZ():JQ()}function JQ(){Nf()||an(!1);let t=y.useContext(wb),{basename:s,future:n,navigator:a}=y.useContext(Bo),{matches:i}=y.useContext(Xl),{pathname:l}=Di(),o=JSON.stringify(f3(i,n.v7_relativeSplatPath)),c=y.useRef(!1);return kL(()=>{c.current=!0}),y.useCallback(function(u,f){if(f===void 0&&(f={}),!c.current)return;if(typeof u=="number"){a.go(u);return}let m=m3(u,JSON.parse(o),l,f.relative==="path");t==null&&s!=="/"&&(m.pathname=m.pathname==="/"?s:Pc([s,m.pathname])),(f.replace?a.replace:a.push)(m,f.state,f)},[s,a,o,l,t])}const eZ=y.createContext(null);function tZ(t){let s=y.useContext(Xl).outlet;return s&&y.createElement(eZ.Provider,{value:t},s)}function sd(){let{matches:t}=y.useContext(Xl),s=t[t.length-1];return s?s.params:{}}function jb(t,s){let{relative:n}=s===void 0?{}:s,{future:a}=y.useContext(Bo),{matches:i}=y.useContext(Xl),{pathname:l}=Di(),o=JSON.stringify(f3(i,a.v7_relativeSplatPath));return y.useMemo(()=>m3(t,JSON.parse(o),l,n==="path"),[t,o,l,n])}function sZ(t,s){return nZ(t,s)}function nZ(t,s,n,a){Nf()||an(!1);let{navigator:i}=y.useContext(Bo),{matches:l}=y.useContext(Xl),o=l[l.length-1],c=o?o.params:{};o&&o.pathname;let d=o?o.pathnameBase:"/";o&&o.route;let u=Di(),f;if(s){var m;let _=typeof s=="string"?wf(s):s;d==="/"||(m=_.pathname)!=null&&m.startsWith(d)||an(!1),f=_}else f=u;let x=f.pathname||"/",b=x;if(d!=="/"){let _=d.replace(/^\//,"").split("/");b="/"+x.replace(/^\//,"").split("/").slice(_.length).join("/")}let w=TQ(t,{pathname:b}),j=oZ(w&&w.map(_=>Object.assign({},_,{params:Object.assign({},c,_.params),pathname:Pc([d,i.encodeLocation?i.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?d:Pc([d,i.encodeLocation?i.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),l,n,a);return s&&j?y.createElement(Nb.Provider,{value:{location:Ap({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:bc.Pop}},j):j}function rZ(){let t=hZ(),s=XQ(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return y.createElement(y.Fragment,null,y.createElement("h2",null,"Unexpected Application Error!"),y.createElement("h3",{style:{fontStyle:"italic"}},s),n?y.createElement("pre",{style:i},n):null,null)}const aZ=y.createElement(rZ,null);class iZ extends y.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,n){return n.location!==s.location||n.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:n.error,location:n.location,revalidation:s.revalidation||n.revalidation}}componentDidCatch(s,n){console.error("React Router caught the following error during render",s,n)}render(){return this.state.error!==void 0?y.createElement(Xl.Provider,{value:this.props.routeContext},y.createElement(CL.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function lZ(t){let{routeContext:s,match:n,children:a}=t,i=y.useContext(wb);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),y.createElement(Xl.Provider,{value:s},a)}function oZ(t,s,n,a){var i;if(s===void 0&&(s=[]),n===void 0&&(n=null),a===void 0&&(a=null),t==null){var l;if(!n)return null;if(n.errors)t=n.matches;else if((l=a)!=null&&l.v7_partialHydration&&s.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,c=(i=n)==null?void 0:i.errors;if(c!=null){let f=o.findIndex(m=>m.route.id&&(c==null?void 0:c[m.route.id])!==void 0);f>=0||an(!1),o=o.slice(0,Math.min(o.length,f+1))}let d=!1,u=-1;if(n&&a&&a.v7_partialHydration)for(let f=0;f<o.length;f++){let m=o[f];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(u=f),m.route.id){let{loaderData:x,errors:b}=n,w=m.route.loader&&x[m.route.id]===void 0&&(!b||b[m.route.id]===void 0);if(m.route.lazy||w){d=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((f,m,x)=>{let b,w=!1,j=null,_=null;n&&(b=c&&m.route.id?c[m.route.id]:void 0,j=m.route.errorElement||aZ,d&&(u<0&&x===0?(mZ("route-fallback"),w=!0,_=null):u===x&&(w=!0,_=m.route.hydrateFallbackElement||null)));let C=s.concat(o.slice(0,x+1)),k=()=>{let A;return b?A=j:w?A=_:m.route.Component?A=y.createElement(m.route.Component,null):m.route.element?A=m.route.element:A=f,y.createElement(lZ,{match:m,routeContext:{outlet:f,matches:C,isDataRoute:n!=null},children:A})};return n&&(m.route.ErrorBoundary||m.route.errorElement||x===0)?y.createElement(iZ,{location:n.location,revalidation:n.revalidation,component:j,error:b,children:k(),routeContext:{outlet:null,matches:C,isDataRoute:!0}}):k()},null)}var AL=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(AL||{}),EL=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(EL||{});function cZ(t){let s=y.useContext(wb);return s||an(!1),s}function dZ(t){let s=y.useContext(SL);return s||an(!1),s}function uZ(t){let s=y.useContext(Xl);return s||an(!1),s}function TL(t){let s=uZ(),n=s.matches[s.matches.length-1];return n.route.id||an(!1),n.route.id}function hZ(){var t;let s=y.useContext(CL),n=dZ(),a=TL();return s!==void 0?s:(t=n.errors)==null?void 0:t[a]}function fZ(){let{router:t}=cZ(AL.UseNavigateStable),s=TL(EL.UseNavigateStable),n=y.useRef(!1);return kL(()=>{n.current=!0}),y.useCallback(function(i,l){l===void 0&&(l={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Ap({fromRouteId:s},l)))},[t,s])}const $T={};function mZ(t,s,n){$T[t]||($T[t]=!0)}function pZ(t,s){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function PL(t){let{to:s,replace:n,state:a,relative:i}=t;Nf()||an(!1);let{future:l,static:o}=y.useContext(Bo),{matches:c}=y.useContext(Xl),{pathname:d}=Di(),u=Ta(),f=m3(s,f3(c,l.v7_relativeSplatPath),d,i==="path"),m=JSON.stringify(f);return y.useEffect(()=>u(JSON.parse(m),{replace:n,state:a,relative:i}),[u,m,i,n,a]),null}function IL(t){return tZ(t.context)}function ut(t){an(!1)}function xZ(t){let{basename:s="/",children:n=null,location:a,navigationType:i=bc.Pop,navigator:l,static:o=!1,future:c}=t;Nf()&&an(!1);let d=s.replace(/^\/*/,"/"),u=y.useMemo(()=>({basename:d,navigator:l,static:o,future:Ap({v7_relativeSplatPath:!1},c)}),[d,c,l,o]);typeof a=="string"&&(a=wf(a));let{pathname:f="/",search:m="",hash:x="",state:b=null,key:w="default"}=a,j=y.useMemo(()=>{let _=Kh(f,d);return _==null?null:{location:{pathname:_,search:m,hash:x,state:b,key:w},navigationType:i}},[d,f,m,x,b,w,i]);return j==null?null:y.createElement(Bo.Provider,{value:u},y.createElement(Nb.Provider,{children:n,value:j}))}function gZ(t){let{children:s,location:n}=t;return sZ(n_(s),n)}new Promise(()=>{});function n_(t,s){s===void 0&&(s=[]);let n=[];return y.Children.forEach(t,(a,i)=>{if(!y.isValidElement(a))return;let l=[...s,i];if(a.type===y.Fragment){n.push.apply(n,n_(a.props.children,l));return}a.type!==ut&&an(!1),!a.props.index||!a.props.children||an(!1);let o={id:a.props.id||l.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(o.children=n_(a.props.children,l)),n.push(o)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Py(){return Py=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Py.apply(this,arguments)}function ML(t,s){if(t==null)return{};var n={},a=Object.keys(t),i,l;for(l=0;l<a.length;l++)i=a[l],!(s.indexOf(i)>=0)&&(n[i]=t[i]);return n}function yZ(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function bZ(t,s){return t.button===0&&(!s||s==="_self")&&!yZ(t)}const vZ=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],wZ=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],NZ="6";try{window.__reactRouterVersion=NZ}catch{}const jZ=y.createContext({isTransitioning:!1}),_Z="startTransition",zT=ab[_Z];function SZ(t){let{basename:s,children:n,future:a,window:i}=t,l=y.useRef();l.current==null&&(l.current=kQ({window:i,v5Compat:!0}));let o=l.current,[c,d]=y.useState({action:o.action,location:o.location}),{v7_startTransition:u}=a||{},f=y.useCallback(m=>{u&&zT?zT(()=>d(m)):d(m)},[d,u]);return y.useLayoutEffect(()=>o.listen(f),[o,f]),y.useEffect(()=>pZ(a),[a]),y.createElement(xZ,{basename:s,children:n,location:c.location,navigationType:c.action,navigator:o,future:a})}const CZ=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",kZ=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,nl=y.forwardRef(function(s,n){let{onClick:a,relative:i,reloadDocument:l,replace:o,state:c,target:d,to:u,preventScrollReset:f,viewTransition:m}=s,x=ML(s,vZ),{basename:b}=y.useContext(Bo),w,j=!1;if(typeof u=="string"&&kZ.test(u)&&(w=u,CZ))try{let A=new URL(window.location.href),T=u.startsWith("//")?new URL(A.protocol+u):new URL(u),P=Kh(T.pathname,b);T.origin===A.origin&&P!=null?u=P+T.search+T.hash:j=!0}catch{}let _=ZQ(u,{relative:i}),C=EZ(u,{replace:o,state:c,target:d,preventScrollReset:f,relative:i,viewTransition:m});function k(A){a&&a(A),A.defaultPrevented||C(A)}return y.createElement("a",Py({},x,{href:w||_,onClick:j||l?a:k,ref:n,target:d}))}),UT=y.forwardRef(function(s,n){let{"aria-current":a="page",caseSensitive:i=!1,className:l="",end:o=!1,style:c,to:d,viewTransition:u,children:f}=s,m=ML(s,wZ),x=jb(d,{relative:m.relative}),b=Di(),w=y.useContext(SL),{navigator:j,basename:_}=y.useContext(Bo),C=w!=null&&TZ(x)&&u===!0,k=j.encodeLocation?j.encodeLocation(x).pathname:x.pathname,A=b.pathname,T=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;i||(A=A.toLowerCase(),T=T?T.toLowerCase():null,k=k.toLowerCase()),T&&_&&(T=Kh(T,_)||T);const P=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let R=A===k||!o&&A.startsWith(k)&&A.charAt(P)==="/",I=T!=null&&(T===k||!o&&T.startsWith(k)&&T.charAt(k.length)==="/"),O={isActive:R,isPending:I,isTransitioning:C},M=R?a:void 0,B;typeof l=="function"?B=l(O):B=[l,R?"active":null,I?"pending":null,C?"transitioning":null].filter(Boolean).join(" ");let L=typeof c=="function"?c(O):c;return y.createElement(nl,Py({},m,{"aria-current":M,className:B,ref:n,style:L,to:d,viewTransition:u}),typeof f=="function"?f(O):f)});var r_;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(r_||(r_={}));var VT;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(VT||(VT={}));function AZ(t){let s=y.useContext(wb);return s||an(!1),s}function EZ(t,s){let{target:n,replace:a,state:i,preventScrollReset:l,relative:o,viewTransition:c}=s===void 0?{}:s,d=Ta(),u=Di(),f=jb(t,{relative:o});return y.useCallback(m=>{if(bZ(m,n)){m.preventDefault();let x=a!==void 0?a:Ty(u)===Ty(f);d(t,{replace:x,state:i,preventScrollReset:l,relative:o,viewTransition:c})}},[u,d,f,a,i,n,t,l,o,c])}function TZ(t,s){s===void 0&&(s={});let n=y.useContext(jZ);n==null&&an(!1);let{basename:a}=AZ(r_.useViewTransitionState),i=jb(t,{relative:s.relative});if(!n.isTransitioning)return!1;let l=Kh(n.currentLocation.pathname,a)||n.currentLocation.pathname,o=Kh(n.nextLocation.pathname,a)||n.nextLocation.pathname;return s_(i.pathname,o)!=null||s_(i.pathname,l)!=null}function DL(t,s){return function(){return t.apply(s,arguments)}}const{toString:PZ}=Object.prototype,{getPrototypeOf:p3}=Object,{iterator:_b,toStringTag:OL}=Symbol,Sb=(t=>s=>{const n=PZ.call(s);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),ol=t=>(t=t.toLowerCase(),s=>Sb(s)===t),Cb=t=>s=>typeof s===t,{isArray:jf}=Array,Yh=Cb("undefined");function yx(t){return t!==null&&!Yh(t)&&t.constructor!==null&&!Yh(t.constructor)&&ja(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const RL=ol("ArrayBuffer");function IZ(t){let s;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?s=ArrayBuffer.isView(t):s=t&&t.buffer&&RL(t.buffer),s}const MZ=Cb("string"),ja=Cb("function"),LL=Cb("number"),bx=t=>t!==null&&typeof t=="object",DZ=t=>t===!0||t===!1,Pg=t=>{if(Sb(t)!=="object")return!1;const s=p3(t);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(OL in t)&&!(_b in t)},OZ=t=>{if(!bx(t)||yx(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},RZ=ol("Date"),LZ=ol("File"),BZ=ol("Blob"),FZ=ol("FileList"),$Z=t=>bx(t)&&ja(t.pipe),zZ=t=>{let s;return t&&(typeof FormData=="function"&&t instanceof FormData||ja(t.append)&&((s=Sb(t))==="formdata"||s==="object"&&ja(t.toString)&&t.toString()==="[object FormData]"))},UZ=ol("URLSearchParams"),[VZ,HZ,WZ,qZ]=["ReadableStream","Request","Response","Headers"].map(ol),GZ=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function vx(t,s,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let a,i;if(typeof t!="object"&&(t=[t]),jf(t))for(a=0,i=t.length;a<i;a++)s.call(null,t[a],a,t);else{if(yx(t))return;const l=n?Object.getOwnPropertyNames(t):Object.keys(t),o=l.length;let c;for(a=0;a<o;a++)c=l[a],s.call(null,t[c],c,t)}}function BL(t,s){if(yx(t))return null;s=s.toLowerCase();const n=Object.keys(t);let a=n.length,i;for(;a-- >0;)if(i=n[a],s===i.toLowerCase())return i;return null}const Ld=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,FL=t=>!Yh(t)&&t!==Ld;function a_(){const{caseless:t,skipUndefined:s}=FL(this)&&this||{},n={},a=(i,l)=>{const o=t&&BL(n,l)||l;Pg(n[o])&&Pg(i)?n[o]=a_(n[o],i):Pg(i)?n[o]=a_({},i):jf(i)?n[o]=i.slice():(!s||!Yh(i))&&(n[o]=i)};for(let i=0,l=arguments.length;i<l;i++)arguments[i]&&vx(arguments[i],a);return n}const KZ=(t,s,n,{allOwnKeys:a}={})=>(vx(s,(i,l)=>{n&&ja(i)?t[l]=DL(i,n):t[l]=i},{allOwnKeys:a}),t),YZ=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),XZ=(t,s,n,a)=>{t.prototype=Object.create(s.prototype,a),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:s.prototype}),n&&Object.assign(t.prototype,n)},QZ=(t,s,n,a)=>{let i,l,o;const c={};if(s=s||{},t==null)return s;do{for(i=Object.getOwnPropertyNames(t),l=i.length;l-- >0;)o=i[l],(!a||a(o,t,s))&&!c[o]&&(s[o]=t[o],c[o]=!0);t=n!==!1&&p3(t)}while(t&&(!n||n(t,s))&&t!==Object.prototype);return s},ZZ=(t,s,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=s.length;const a=t.indexOf(s,n);return a!==-1&&a===n},JZ=t=>{if(!t)return null;if(jf(t))return t;let s=t.length;if(!LL(s))return null;const n=new Array(s);for(;s-- >0;)n[s]=t[s];return n},eJ=(t=>s=>t&&s instanceof t)(typeof Uint8Array<"u"&&p3(Uint8Array)),tJ=(t,s)=>{const a=(t&&t[_b]).call(t);let i;for(;(i=a.next())&&!i.done;){const l=i.value;s.call(t,l[0],l[1])}},sJ=(t,s)=>{let n;const a=[];for(;(n=t.exec(s))!==null;)a.push(n);return a},nJ=ol("HTMLFormElement"),rJ=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,a,i){return a.toUpperCase()+i}),HT=(({hasOwnProperty:t})=>(s,n)=>t.call(s,n))(Object.prototype),aJ=ol("RegExp"),$L=(t,s)=>{const n=Object.getOwnPropertyDescriptors(t),a={};vx(n,(i,l)=>{let o;(o=s(i,l,t))!==!1&&(a[l]=o||i)}),Object.defineProperties(t,a)},iJ=t=>{$L(t,(s,n)=>{if(ja(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const a=t[n];if(ja(a)){if(s.enumerable=!1,"writable"in s){s.writable=!1;return}s.set||(s.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},lJ=(t,s)=>{const n={},a=i=>{i.forEach(l=>{n[l]=!0})};return jf(t)?a(t):a(String(t).split(s)),n},oJ=()=>{},cJ=(t,s)=>t!=null&&Number.isFinite(t=+t)?t:s;function dJ(t){return!!(t&&ja(t.append)&&t[OL]==="FormData"&&t[_b])}const uJ=t=>{const s=new Array(10),n=(a,i)=>{if(bx(a)){if(s.indexOf(a)>=0)return;if(yx(a))return a;if(!("toJSON"in a)){s[i]=a;const l=jf(a)?[]:{};return vx(a,(o,c)=>{const d=n(o,i+1);!Yh(d)&&(l[c]=d)}),s[i]=void 0,l}}return a};return n(t,0)},hJ=ol("AsyncFunction"),fJ=t=>t&&(bx(t)||ja(t))&&ja(t.then)&&ja(t.catch),zL=((t,s)=>t?setImmediate:s?((n,a)=>(Ld.addEventListener("message",({source:i,data:l})=>{i===Ld&&l===n&&a.length&&a.shift()()},!1),i=>{a.push(i),Ld.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",ja(Ld.postMessage)),mJ=typeof queueMicrotask<"u"?queueMicrotask.bind(Ld):typeof process<"u"&&process.nextTick||zL,pJ=t=>t!=null&&ja(t[_b]),De={isArray:jf,isArrayBuffer:RL,isBuffer:yx,isFormData:zZ,isArrayBufferView:IZ,isString:MZ,isNumber:LL,isBoolean:DZ,isObject:bx,isPlainObject:Pg,isEmptyObject:OZ,isReadableStream:VZ,isRequest:HZ,isResponse:WZ,isHeaders:qZ,isUndefined:Yh,isDate:RZ,isFile:LZ,isBlob:BZ,isRegExp:aJ,isFunction:ja,isStream:$Z,isURLSearchParams:UZ,isTypedArray:eJ,isFileList:FZ,forEach:vx,merge:a_,extend:KZ,trim:GZ,stripBOM:YZ,inherits:XZ,toFlatObject:QZ,kindOf:Sb,kindOfTest:ol,endsWith:ZZ,toArray:JZ,forEachEntry:tJ,matchAll:sJ,isHTMLForm:nJ,hasOwnProperty:HT,hasOwnProp:HT,reduceDescriptors:$L,freezeMethods:iJ,toObjectSet:lJ,toCamelCase:rJ,noop:oJ,toFiniteNumber:cJ,findKey:BL,global:Ld,isContextDefined:FL,isSpecCompliantForm:dJ,toJSONObject:uJ,isAsyncFn:hJ,isThenable:fJ,setImmediate:zL,asap:mJ,isIterable:pJ};function Ht(t,s,n,a,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",s&&(this.code=s),n&&(this.config=n),a&&(this.request=a),i&&(this.response=i,this.status=i.status?i.status:null)}De.inherits(Ht,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:De.toJSONObject(this.config),code:this.code,status:this.status}}});const UL=Ht.prototype,VL={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{VL[t]={value:t}});Object.defineProperties(Ht,VL);Object.defineProperty(UL,"isAxiosError",{value:!0});Ht.from=(t,s,n,a,i,l)=>{const o=Object.create(UL);De.toFlatObject(t,o,function(f){return f!==Error.prototype},u=>u!=="isAxiosError");const c=t&&t.message?t.message:"Error",d=s==null&&t?t.code:s;return Ht.call(o,c,d,n,a,i),t&&o.cause==null&&Object.defineProperty(o,"cause",{value:t,configurable:!0}),o.name=t&&t.name||"Error",l&&Object.assign(o,l),o};const xJ=null;function i_(t){return De.isPlainObject(t)||De.isArray(t)}function HL(t){return De.endsWith(t,"[]")?t.slice(0,-2):t}function WT(t,s,n){return t?t.concat(s).map(function(i,l){return i=HL(i),!n&&l?"["+i+"]":i}).join(n?".":""):s}function gJ(t){return De.isArray(t)&&!t.some(i_)}const yJ=De.toFlatObject(De,{},null,function(s){return/^is[A-Z]/.test(s)});function kb(t,s,n){if(!De.isObject(t))throw new TypeError("target must be an object");s=s||new FormData,n=De.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(j,_){return!De.isUndefined(_[j])});const a=n.metaTokens,i=n.visitor||f,l=n.dots,o=n.indexes,d=(n.Blob||typeof Blob<"u"&&Blob)&&De.isSpecCompliantForm(s);if(!De.isFunction(i))throw new TypeError("visitor must be a function");function u(w){if(w===null)return"";if(De.isDate(w))return w.toISOString();if(De.isBoolean(w))return w.toString();if(!d&&De.isBlob(w))throw new Ht("Blob is not supported. Use a Buffer instead.");return De.isArrayBuffer(w)||De.isTypedArray(w)?d&&typeof Blob=="function"?new Blob([w]):Buffer.from(w):w}function f(w,j,_){let C=w;if(w&&!_&&typeof w=="object"){if(De.endsWith(j,"{}"))j=a?j:j.slice(0,-2),w=JSON.stringify(w);else if(De.isArray(w)&&gJ(w)||(De.isFileList(w)||De.endsWith(j,"[]"))&&(C=De.toArray(w)))return j=HL(j),C.forEach(function(A,T){!(De.isUndefined(A)||A===null)&&s.append(o===!0?WT([j],T,l):o===null?j:j+"[]",u(A))}),!1}return i_(w)?!0:(s.append(WT(_,j,l),u(w)),!1)}const m=[],x=Object.assign(yJ,{defaultVisitor:f,convertValue:u,isVisitable:i_});function b(w,j){if(!De.isUndefined(w)){if(m.indexOf(w)!==-1)throw Error("Circular reference detected in "+j.join("."));m.push(w),De.forEach(w,function(C,k){(!(De.isUndefined(C)||C===null)&&i.call(s,C,De.isString(k)?k.trim():k,j,x))===!0&&b(C,j?j.concat(k):[k])}),m.pop()}}if(!De.isObject(t))throw new TypeError("data must be an object");return b(t),s}function qT(t){const s={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(a){return s[a]})}function x3(t,s){this._pairs=[],t&&kb(t,this,s)}const WL=x3.prototype;WL.append=function(s,n){this._pairs.push([s,n])};WL.toString=function(s){const n=s?function(a){return s.call(this,a,qT)}:qT;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function bJ(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function qL(t,s,n){if(!s)return t;const a=n&&n.encode||bJ;De.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let l;if(i?l=i(s,n):l=De.isURLSearchParams(s)?s.toString():new x3(s,n).toString(a),l){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+l}return t}class GT{constructor(){this.handlers=[]}use(s,n,a){return this.handlers.push({fulfilled:s,rejected:n,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(s){this.handlers[s]&&(this.handlers[s]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(s){De.forEach(this.handlers,function(a){a!==null&&s(a)})}}const GL={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},vJ=typeof URLSearchParams<"u"?URLSearchParams:x3,wJ=typeof FormData<"u"?FormData:null,NJ=typeof Blob<"u"?Blob:null,jJ={isBrowser:!0,classes:{URLSearchParams:vJ,FormData:wJ,Blob:NJ},protocols:["http","https","file","blob","url","data"]},g3=typeof window<"u"&&typeof document<"u",l_=typeof navigator=="object"&&navigator||void 0,_J=g3&&(!l_||["ReactNative","NativeScript","NS"].indexOf(l_.product)<0),SJ=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",CJ=g3&&window.location.href||"http://localhost",kJ=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:g3,hasStandardBrowserEnv:_J,hasStandardBrowserWebWorkerEnv:SJ,navigator:l_,origin:CJ},Symbol.toStringTag,{value:"Module"})),Br={...kJ,...jJ};function AJ(t,s){return kb(t,new Br.classes.URLSearchParams,{visitor:function(n,a,i,l){return Br.isNode&&De.isBuffer(n)?(this.append(a,n.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...s})}function EJ(t){return De.matchAll(/\w+|\[(\w*)]/g,t).map(s=>s[0]==="[]"?"":s[1]||s[0])}function TJ(t){const s={},n=Object.keys(t);let a;const i=n.length;let l;for(a=0;a<i;a++)l=n[a],s[l]=t[l];return s}function KL(t){function s(n,a,i,l){let o=n[l++];if(o==="__proto__")return!0;const c=Number.isFinite(+o),d=l>=n.length;return o=!o&&De.isArray(i)?i.length:o,d?(De.hasOwnProp(i,o)?i[o]=[i[o],a]:i[o]=a,!c):((!i[o]||!De.isObject(i[o]))&&(i[o]=[]),s(n,a,i[o],l)&&De.isArray(i[o])&&(i[o]=TJ(i[o])),!c)}if(De.isFormData(t)&&De.isFunction(t.entries)){const n={};return De.forEachEntry(t,(a,i)=>{s(EJ(a),i,n,0)}),n}return null}function PJ(t,s,n){if(De.isString(t))try{return(s||JSON.parse)(t),De.trim(t)}catch(a){if(a.name!=="SyntaxError")throw a}return(n||JSON.stringify)(t)}const wx={transitional:GL,adapter:["xhr","http","fetch"],transformRequest:[function(s,n){const a=n.getContentType()||"",i=a.indexOf("application/json")>-1,l=De.isObject(s);if(l&&De.isHTMLForm(s)&&(s=new FormData(s)),De.isFormData(s))return i?JSON.stringify(KL(s)):s;if(De.isArrayBuffer(s)||De.isBuffer(s)||De.isStream(s)||De.isFile(s)||De.isBlob(s)||De.isReadableStream(s))return s;if(De.isArrayBufferView(s))return s.buffer;if(De.isURLSearchParams(s))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),s.toString();let c;if(l){if(a.indexOf("application/x-www-form-urlencoded")>-1)return AJ(s,this.formSerializer).toString();if((c=De.isFileList(s))||a.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return kb(c?{"files[]":s}:s,d&&new d,this.formSerializer)}}return l||i?(n.setContentType("application/json",!1),PJ(s)):s}],transformResponse:[function(s){const n=this.transitional||wx.transitional,a=n&&n.forcedJSONParsing,i=this.responseType==="json";if(De.isResponse(s)||De.isReadableStream(s))return s;if(s&&De.isString(s)&&(a&&!this.responseType||i)){const o=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(s,this.parseReviver)}catch(c){if(o)throw c.name==="SyntaxError"?Ht.from(c,Ht.ERR_BAD_RESPONSE,this,null,this.response):c}}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Br.classes.FormData,Blob:Br.classes.Blob},validateStatus:function(s){return s>=200&&s<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};De.forEach(["delete","get","head","post","put","patch"],t=>{wx.headers[t]={}});const IJ=De.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),MJ=t=>{const s={};let n,a,i;return t&&t.split(`
`).forEach(function(o){i=o.indexOf(":"),n=o.substring(0,i).trim().toLowerCase(),a=o.substring(i+1).trim(),!(!n||s[n]&&IJ[n])&&(n==="set-cookie"?s[n]?s[n].push(a):s[n]=[a]:s[n]=s[n]?s[n]+", "+a:a)}),s},KT=Symbol("internals");function mm(t){return t&&String(t).trim().toLowerCase()}function Ig(t){return t===!1||t==null?t:De.isArray(t)?t.map(Ig):String(t)}function DJ(t){const s=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=n.exec(t);)s[a[1]]=a[2];return s}const OJ=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function oN(t,s,n,a,i){if(De.isFunction(a))return a.call(this,s,n);if(i&&(s=n),!!De.isString(s)){if(De.isString(a))return s.indexOf(a)!==-1;if(De.isRegExp(a))return a.test(s)}}function RJ(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(s,n,a)=>n.toUpperCase()+a)}function LJ(t,s){const n=De.toCamelCase(" "+s);["get","set","has"].forEach(a=>{Object.defineProperty(t,a+n,{value:function(i,l,o){return this[a].call(this,s,i,l,o)},configurable:!0})})}let _a=class{constructor(s){s&&this.set(s)}set(s,n,a){const i=this;function l(c,d,u){const f=mm(d);if(!f)throw new Error("header name must be a non-empty string");const m=De.findKey(i,f);(!m||i[m]===void 0||u===!0||u===void 0&&i[m]!==!1)&&(i[m||d]=Ig(c))}const o=(c,d)=>De.forEach(c,(u,f)=>l(u,f,d));if(De.isPlainObject(s)||s instanceof this.constructor)o(s,n);else if(De.isString(s)&&(s=s.trim())&&!OJ(s))o(MJ(s),n);else if(De.isObject(s)&&De.isIterable(s)){let c={},d,u;for(const f of s){if(!De.isArray(f))throw TypeError("Object iterator must return a key-value pair");c[u=f[0]]=(d=c[u])?De.isArray(d)?[...d,f[1]]:[d,f[1]]:f[1]}o(c,n)}else s!=null&&l(n,s,a);return this}get(s,n){if(s=mm(s),s){const a=De.findKey(this,s);if(a){const i=this[a];if(!n)return i;if(n===!0)return DJ(i);if(De.isFunction(n))return n.call(this,i,a);if(De.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(s,n){if(s=mm(s),s){const a=De.findKey(this,s);return!!(a&&this[a]!==void 0&&(!n||oN(this,this[a],a,n)))}return!1}delete(s,n){const a=this;let i=!1;function l(o){if(o=mm(o),o){const c=De.findKey(a,o);c&&(!n||oN(a,a[c],c,n))&&(delete a[c],i=!0)}}return De.isArray(s)?s.forEach(l):l(s),i}clear(s){const n=Object.keys(this);let a=n.length,i=!1;for(;a--;){const l=n[a];(!s||oN(this,this[l],l,s,!0))&&(delete this[l],i=!0)}return i}normalize(s){const n=this,a={};return De.forEach(this,(i,l)=>{const o=De.findKey(a,l);if(o){n[o]=Ig(i),delete n[l];return}const c=s?RJ(l):String(l).trim();c!==l&&delete n[l],n[c]=Ig(i),a[c]=!0}),this}concat(...s){return this.constructor.concat(this,...s)}toJSON(s){const n=Object.create(null);return De.forEach(this,(a,i)=>{a!=null&&a!==!1&&(n[i]=s&&De.isArray(a)?a.join(", "):a)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([s,n])=>s+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(s){return s instanceof this?s:new this(s)}static concat(s,...n){const a=new this(s);return n.forEach(i=>a.set(i)),a}static accessor(s){const a=(this[KT]=this[KT]={accessors:{}}).accessors,i=this.prototype;function l(o){const c=mm(o);a[c]||(LJ(i,o),a[c]=!0)}return De.isArray(s)?s.forEach(l):l(s),this}};_a.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);De.reduceDescriptors(_a.prototype,({value:t},s)=>{let n=s[0].toUpperCase()+s.slice(1);return{get:()=>t,set(a){this[n]=a}}});De.freezeMethods(_a);function cN(t,s){const n=this||wx,a=s||n,i=_a.from(a.headers);let l=a.data;return De.forEach(t,function(c){l=c.call(n,l,i.normalize(),s?s.status:void 0)}),i.normalize(),l}function YL(t){return!!(t&&t.__CANCEL__)}function _f(t,s,n){Ht.call(this,t??"canceled",Ht.ERR_CANCELED,s,n),this.name="CanceledError"}De.inherits(_f,Ht,{__CANCEL__:!0});function XL(t,s,n){const a=n.config.validateStatus;!n.status||!a||a(n.status)?t(n):s(new Ht("Request failed with status code "+n.status,[Ht.ERR_BAD_REQUEST,Ht.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function BJ(t){const s=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return s&&s[1]||""}function FJ(t,s){t=t||10;const n=new Array(t),a=new Array(t);let i=0,l=0,o;return s=s!==void 0?s:1e3,function(d){const u=Date.now(),f=a[l];o||(o=u),n[i]=d,a[i]=u;let m=l,x=0;for(;m!==i;)x+=n[m++],m=m%t;if(i=(i+1)%t,i===l&&(l=(l+1)%t),u-o<s)return;const b=f&&u-f;return b?Math.round(x*1e3/b):void 0}}function $J(t,s){let n=0,a=1e3/s,i,l;const o=(u,f=Date.now())=>{n=f,i=null,l&&(clearTimeout(l),l=null),t(...u)};return[(...u)=>{const f=Date.now(),m=f-n;m>=a?o(u,f):(i=u,l||(l=setTimeout(()=>{l=null,o(i)},a-m)))},()=>i&&o(i)]}const Iy=(t,s,n=3)=>{let a=0;const i=FJ(50,250);return $J(l=>{const o=l.loaded,c=l.lengthComputable?l.total:void 0,d=o-a,u=i(d),f=o<=c;a=o;const m={loaded:o,total:c,progress:c?o/c:void 0,bytes:d,rate:u||void 0,estimated:u&&c&&f?(c-o)/u:void 0,event:l,lengthComputable:c!=null,[s?"download":"upload"]:!0};t(m)},n)},YT=(t,s)=>{const n=t!=null;return[a=>s[0]({lengthComputable:n,total:t,loaded:a}),s[1]]},XT=t=>(...s)=>De.asap(()=>t(...s)),zJ=Br.hasStandardBrowserEnv?((t,s)=>n=>(n=new URL(n,Br.origin),t.protocol===n.protocol&&t.host===n.host&&(s||t.port===n.port)))(new URL(Br.origin),Br.navigator&&/(msie|trident)/i.test(Br.navigator.userAgent)):()=>!0,UJ=Br.hasStandardBrowserEnv?{write(t,s,n,a,i,l){const o=[t+"="+encodeURIComponent(s)];De.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),De.isString(a)&&o.push("path="+a),De.isString(i)&&o.push("domain="+i),l===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const s=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return s?decodeURIComponent(s[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function VJ(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function HJ(t,s){return s?t.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):t}function QL(t,s,n){let a=!VJ(s);return t&&(a||n==!1)?HJ(t,s):s}const QT=t=>t instanceof _a?{...t}:t;function uu(t,s){s=s||{};const n={};function a(u,f,m,x){return De.isPlainObject(u)&&De.isPlainObject(f)?De.merge.call({caseless:x},u,f):De.isPlainObject(f)?De.merge({},f):De.isArray(f)?f.slice():f}function i(u,f,m,x){if(De.isUndefined(f)){if(!De.isUndefined(u))return a(void 0,u,m,x)}else return a(u,f,m,x)}function l(u,f){if(!De.isUndefined(f))return a(void 0,f)}function o(u,f){if(De.isUndefined(f)){if(!De.isUndefined(u))return a(void 0,u)}else return a(void 0,f)}function c(u,f,m){if(m in s)return a(u,f);if(m in t)return a(void 0,u)}const d={url:l,method:l,data:l,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:c,headers:(u,f,m)=>i(QT(u),QT(f),m,!0)};return De.forEach(Object.keys({...t,...s}),function(f){const m=d[f]||i,x=m(t[f],s[f],f);De.isUndefined(x)&&m!==c||(n[f]=x)}),n}const ZL=t=>{const s=uu({},t);let{data:n,withXSRFToken:a,xsrfHeaderName:i,xsrfCookieName:l,headers:o,auth:c}=s;if(s.headers=o=_a.from(o),s.url=qL(QL(s.baseURL,s.url,s.allowAbsoluteUrls),t.params,t.paramsSerializer),c&&o.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),De.isFormData(n)){if(Br.hasStandardBrowserEnv||Br.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(De.isFunction(n.getHeaders)){const d=n.getHeaders(),u=["content-type","content-length"];Object.entries(d).forEach(([f,m])=>{u.includes(f.toLowerCase())&&o.set(f,m)})}}if(Br.hasStandardBrowserEnv&&(a&&De.isFunction(a)&&(a=a(s)),a||a!==!1&&zJ(s.url))){const d=i&&l&&UJ.read(l);d&&o.set(i,d)}return s},WJ=typeof XMLHttpRequest<"u",qJ=WJ&&function(t){return new Promise(function(n,a){const i=ZL(t);let l=i.data;const o=_a.from(i.headers).normalize();let{responseType:c,onUploadProgress:d,onDownloadProgress:u}=i,f,m,x,b,w;function j(){b&&b(),w&&w(),i.cancelToken&&i.cancelToken.unsubscribe(f),i.signal&&i.signal.removeEventListener("abort",f)}let _=new XMLHttpRequest;_.open(i.method.toUpperCase(),i.url,!0),_.timeout=i.timeout;function C(){if(!_)return;const A=_a.from("getAllResponseHeaders"in _&&_.getAllResponseHeaders()),P={data:!c||c==="text"||c==="json"?_.responseText:_.response,status:_.status,statusText:_.statusText,headers:A,config:t,request:_};XL(function(I){n(I),j()},function(I){a(I),j()},P),_=null}"onloadend"in _?_.onloadend=C:_.onreadystatechange=function(){!_||_.readyState!==4||_.status===0&&!(_.responseURL&&_.responseURL.indexOf("file:")===0)||setTimeout(C)},_.onabort=function(){_&&(a(new Ht("Request aborted",Ht.ECONNABORTED,t,_)),_=null)},_.onerror=function(T){const P=T&&T.message?T.message:"Network Error",R=new Ht(P,Ht.ERR_NETWORK,t,_);R.event=T||null,a(R),_=null},_.ontimeout=function(){let T=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const P=i.transitional||GL;i.timeoutErrorMessage&&(T=i.timeoutErrorMessage),a(new Ht(T,P.clarifyTimeoutError?Ht.ETIMEDOUT:Ht.ECONNABORTED,t,_)),_=null},l===void 0&&o.setContentType(null),"setRequestHeader"in _&&De.forEach(o.toJSON(),function(T,P){_.setRequestHeader(P,T)}),De.isUndefined(i.withCredentials)||(_.withCredentials=!!i.withCredentials),c&&c!=="json"&&(_.responseType=i.responseType),u&&([x,w]=Iy(u,!0),_.addEventListener("progress",x)),d&&_.upload&&([m,b]=Iy(d),_.upload.addEventListener("progress",m),_.upload.addEventListener("loadend",b)),(i.cancelToken||i.signal)&&(f=A=>{_&&(a(!A||A.type?new _f(null,t,_):A),_.abort(),_=null)},i.cancelToken&&i.cancelToken.subscribe(f),i.signal&&(i.signal.aborted?f():i.signal.addEventListener("abort",f)));const k=BJ(i.url);if(k&&Br.protocols.indexOf(k)===-1){a(new Ht("Unsupported protocol "+k+":",Ht.ERR_BAD_REQUEST,t));return}_.send(l||null)})},GJ=(t,s)=>{const{length:n}=t=t?t.filter(Boolean):[];if(s||n){let a=new AbortController,i;const l=function(u){if(!i){i=!0,c();const f=u instanceof Error?u:this.reason;a.abort(f instanceof Ht?f:new _f(f instanceof Error?f.message:f))}};let o=s&&setTimeout(()=>{o=null,l(new Ht(`timeout ${s} of ms exceeded`,Ht.ETIMEDOUT))},s);const c=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(l):u.removeEventListener("abort",l)}),t=null)};t.forEach(u=>u.addEventListener("abort",l));const{signal:d}=a;return d.unsubscribe=()=>De.asap(c),d}},KJ=function*(t,s){let n=t.byteLength;if(n<s){yield t;return}let a=0,i;for(;a<n;)i=a+s,yield t.slice(a,i),a=i},YJ=async function*(t,s){for await(const n of XJ(t))yield*KJ(n,s)},XJ=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const s=t.getReader();try{for(;;){const{done:n,value:a}=await s.read();if(n)break;yield a}}finally{await s.cancel()}},ZT=(t,s,n,a)=>{const i=YJ(t,s);let l=0,o,c=d=>{o||(o=!0,a&&a(d))};return new ReadableStream({async pull(d){try{const{done:u,value:f}=await i.next();if(u){c(),d.close();return}let m=f.byteLength;if(n){let x=l+=m;n(x)}d.enqueue(new Uint8Array(f))}catch(u){throw c(u),u}},cancel(d){return c(d),i.return()}},{highWaterMark:2})},JT=64*1024,{isFunction:b0}=De,QJ=(({Request:t,Response:s})=>({Request:t,Response:s}))(De.global),{ReadableStream:e4,TextEncoder:t4}=De.global,s4=(t,...s)=>{try{return!!t(...s)}catch{return!1}},ZJ=t=>{t=De.merge.call({skipUndefined:!0},QJ,t);const{fetch:s,Request:n,Response:a}=t,i=s?b0(s):typeof fetch=="function",l=b0(n),o=b0(a);if(!i)return!1;const c=i&&b0(e4),d=i&&(typeof t4=="function"?(w=>j=>w.encode(j))(new t4):async w=>new Uint8Array(await new n(w).arrayBuffer())),u=l&&c&&s4(()=>{let w=!1;const j=new n(Br.origin,{body:new e4,method:"POST",get duplex(){return w=!0,"half"}}).headers.has("Content-Type");return w&&!j}),f=o&&c&&s4(()=>De.isReadableStream(new a("").body)),m={stream:f&&(w=>w.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(w=>{!m[w]&&(m[w]=(j,_)=>{let C=j&&j[w];if(C)return C.call(j);throw new Ht(`Response type '${w}' is not supported`,Ht.ERR_NOT_SUPPORT,_)})});const x=async w=>{if(w==null)return 0;if(De.isBlob(w))return w.size;if(De.isSpecCompliantForm(w))return(await new n(Br.origin,{method:"POST",body:w}).arrayBuffer()).byteLength;if(De.isArrayBufferView(w)||De.isArrayBuffer(w))return w.byteLength;if(De.isURLSearchParams(w)&&(w=w+""),De.isString(w))return(await d(w)).byteLength},b=async(w,j)=>{const _=De.toFiniteNumber(w.getContentLength());return _??x(j)};return async w=>{let{url:j,method:_,data:C,signal:k,cancelToken:A,timeout:T,onDownloadProgress:P,onUploadProgress:R,responseType:I,headers:O,withCredentials:M="same-origin",fetchOptions:B}=ZL(w),L=s||fetch;I=I?(I+"").toLowerCase():"text";let F=GJ([k,A&&A.toAbortSignal()],T),V=null;const U=F&&F.unsubscribe&&(()=>{F.unsubscribe()});let z;try{if(R&&u&&_!=="get"&&_!=="head"&&(z=await b(O,C))!==0){let ke=new n(j,{method:"POST",body:C,duplex:"half"}),ee;if(De.isFormData(C)&&(ee=ke.headers.get("content-type"))&&O.setContentType(ee),ke.body){const[pe,ue]=YT(z,Iy(XT(R)));C=ZT(ke.body,JT,pe,ue)}}De.isString(M)||(M=M?"include":"omit");const W=l&&"credentials"in n.prototype,q={...B,signal:F,method:_.toUpperCase(),headers:O.normalize().toJSON(),body:C,duplex:"half",credentials:W?M:void 0};V=l&&new n(j,q);let G=await(l?L(V,B):L(j,q));const se=f&&(I==="stream"||I==="response");if(f&&(P||se&&U)){const ke={};["status","statusText","headers"].forEach(ye=>{ke[ye]=G[ye]});const ee=De.toFiniteNumber(G.headers.get("content-length")),[pe,ue]=P&&YT(ee,Iy(XT(P),!0))||[];G=new a(ZT(G.body,JT,pe,()=>{ue&&ue(),U&&U()}),ke)}I=I||"text";let ge=await m[De.findKey(m,I)||"text"](G,w);return!se&&U&&U(),await new Promise((ke,ee)=>{XL(ke,ee,{data:ge,headers:_a.from(G.headers),status:G.status,statusText:G.statusText,config:w,request:V})})}catch(W){throw U&&U(),W&&W.name==="TypeError"&&/Load failed|fetch/i.test(W.message)?Object.assign(new Ht("Network Error",Ht.ERR_NETWORK,w,V),{cause:W.cause||W}):Ht.from(W,W&&W.code,w,V)}}},JJ=new Map,JL=t=>{let s=t?t.env:{};const{fetch:n,Request:a,Response:i}=s,l=[a,i,n];let o=l.length,c=o,d,u,f=JJ;for(;c--;)d=l[c],u=f.get(d),u===void 0&&f.set(d,u=c?new Map:ZJ(s)),f=u;return u};JL();const o_={http:xJ,xhr:qJ,fetch:{get:JL}};De.forEach(o_,(t,s)=>{if(t){try{Object.defineProperty(t,"name",{value:s})}catch{}Object.defineProperty(t,"adapterName",{value:s})}});const n4=t=>`- ${t}`,eee=t=>De.isFunction(t)||t===null||t===!1,e7={getAdapter:(t,s)=>{t=De.isArray(t)?t:[t];const{length:n}=t;let a,i;const l={};for(let o=0;o<n;o++){a=t[o];let c;if(i=a,!eee(a)&&(i=o_[(c=String(a)).toLowerCase()],i===void 0))throw new Ht(`Unknown adapter '${c}'`);if(i&&(De.isFunction(i)||(i=i.get(s))))break;l[c||"#"+o]=i}if(!i){const o=Object.entries(l).map(([d,u])=>`adapter ${d} `+(u===!1?"is not supported by the environment":"is not available in the build"));let c=n?o.length>1?`since :
`+o.map(n4).join(`
`):" "+n4(o[0]):"as no adapter specified";throw new Ht("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return i},adapters:o_};function dN(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new _f(null,t)}function r4(t){return dN(t),t.headers=_a.from(t.headers),t.data=cN.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),e7.getAdapter(t.adapter||wx.adapter,t)(t).then(function(a){return dN(t),a.data=cN.call(t,t.transformResponse,a),a.headers=_a.from(a.headers),a},function(a){return YL(a)||(dN(t),a&&a.response&&(a.response.data=cN.call(t,t.transformResponse,a.response),a.response.headers=_a.from(a.response.headers))),Promise.reject(a)})}const t7="1.12.2",Ab={};["object","boolean","number","function","string","symbol"].forEach((t,s)=>{Ab[t]=function(a){return typeof a===t||"a"+(s<1?"n ":" ")+t}});const a4={};Ab.transitional=function(s,n,a){function i(l,o){return"[Axios v"+t7+"] Transitional option '"+l+"'"+o+(a?". "+a:"")}return(l,o,c)=>{if(s===!1)throw new Ht(i(o," has been removed"+(n?" in "+n:"")),Ht.ERR_DEPRECATED);return n&&!a4[o]&&(a4[o]=!0,console.warn(i(o," has been deprecated since v"+n+" and will be removed in the near future"))),s?s(l,o,c):!0}};Ab.spelling=function(s){return(n,a)=>(console.warn(`${a} is likely a misspelling of ${s}`),!0)};function tee(t,s,n){if(typeof t!="object")throw new Ht("options must be an object",Ht.ERR_BAD_OPTION_VALUE);const a=Object.keys(t);let i=a.length;for(;i-- >0;){const l=a[i],o=s[l];if(o){const c=t[l],d=c===void 0||o(c,l,t);if(d!==!0)throw new Ht("option "+l+" must be "+d,Ht.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Ht("Unknown option "+l,Ht.ERR_BAD_OPTION)}}const Mg={assertOptions:tee,validators:Ab},vl=Mg.validators;let Kd=class{constructor(s){this.defaults=s||{},this.interceptors={request:new GT,response:new GT}}async request(s,n){try{return await this._request(s,n)}catch(a){if(a instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const l=i.stack?i.stack.replace(/^.+\n/,""):"";try{a.stack?l&&!String(a.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+l):a.stack=l}catch{}}throw a}}_request(s,n){typeof s=="string"?(n=n||{},n.url=s):n=s||{},n=uu(this.defaults,n);const{transitional:a,paramsSerializer:i,headers:l}=n;a!==void 0&&Mg.assertOptions(a,{silentJSONParsing:vl.transitional(vl.boolean),forcedJSONParsing:vl.transitional(vl.boolean),clarifyTimeoutError:vl.transitional(vl.boolean)},!1),i!=null&&(De.isFunction(i)?n.paramsSerializer={serialize:i}:Mg.assertOptions(i,{encode:vl.function,serialize:vl.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Mg.assertOptions(n,{baseUrl:vl.spelling("baseURL"),withXsrfToken:vl.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=l&&De.merge(l.common,l[n.method]);l&&De.forEach(["delete","get","head","post","put","patch","common"],w=>{delete l[w]}),n.headers=_a.concat(o,l);const c=[];let d=!0;this.interceptors.request.forEach(function(j){typeof j.runWhen=="function"&&j.runWhen(n)===!1||(d=d&&j.synchronous,c.unshift(j.fulfilled,j.rejected))});const u=[];this.interceptors.response.forEach(function(j){u.push(j.fulfilled,j.rejected)});let f,m=0,x;if(!d){const w=[r4.bind(this),void 0];for(w.unshift(...c),w.push(...u),x=w.length,f=Promise.resolve(n);m<x;)f=f.then(w[m++],w[m++]);return f}x=c.length;let b=n;for(;m<x;){const w=c[m++],j=c[m++];try{b=w(b)}catch(_){j.call(this,_);break}}try{f=r4.call(this,b)}catch(w){return Promise.reject(w)}for(m=0,x=u.length;m<x;)f=f.then(u[m++],u[m++]);return f}getUri(s){s=uu(this.defaults,s);const n=QL(s.baseURL,s.url,s.allowAbsoluteUrls);return qL(n,s.params,s.paramsSerializer)}};De.forEach(["delete","get","head","options"],function(s){Kd.prototype[s]=function(n,a){return this.request(uu(a||{},{method:s,url:n,data:(a||{}).data}))}});De.forEach(["post","put","patch"],function(s){function n(a){return function(l,o,c){return this.request(uu(c||{},{method:s,headers:a?{"Content-Type":"multipart/form-data"}:{},url:l,data:o}))}}Kd.prototype[s]=n(),Kd.prototype[s+"Form"]=n(!0)});let see=class s7{constructor(s){if(typeof s!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(l){n=l});const a=this;this.promise.then(i=>{if(!a._listeners)return;let l=a._listeners.length;for(;l-- >0;)a._listeners[l](i);a._listeners=null}),this.promise.then=i=>{let l;const o=new Promise(c=>{a.subscribe(c),l=c}).then(i);return o.cancel=function(){a.unsubscribe(l)},o},s(function(l,o,c){a.reason||(a.reason=new _f(l,o,c),n(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(s){if(this.reason){s(this.reason);return}this._listeners?this._listeners.push(s):this._listeners=[s]}unsubscribe(s){if(!this._listeners)return;const n=this._listeners.indexOf(s);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const s=new AbortController,n=a=>{s.abort(a)};return this.subscribe(n),s.signal.unsubscribe=()=>this.unsubscribe(n),s.signal}static source(){let s;return{token:new s7(function(i){s=i}),cancel:s}}};function nee(t){return function(n){return t.apply(null,n)}}function ree(t){return De.isObject(t)&&t.isAxiosError===!0}const c_={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(c_).forEach(([t,s])=>{c_[s]=t});function n7(t){const s=new Kd(t),n=DL(Kd.prototype.request,s);return De.extend(n,Kd.prototype,s,{allOwnKeys:!0}),De.extend(n,s,null,{allOwnKeys:!0}),n.create=function(i){return n7(uu(t,i))},n}const Sn=n7(wx);Sn.Axios=Kd;Sn.CanceledError=_f;Sn.CancelToken=see;Sn.isCancel=YL;Sn.VERSION=t7;Sn.toFormData=kb;Sn.AxiosError=Ht;Sn.Cancel=Sn.CanceledError;Sn.all=function(s){return Promise.all(s)};Sn.spread=nee;Sn.isAxiosError=ree;Sn.mergeConfig=uu;Sn.AxiosHeaders=_a;Sn.formToJSON=t=>KL(De.isHTMLForm(t)?new FormData(t):t);Sn.getAdapter=e7.getAdapter;Sn.HttpStatusCode=c_;Sn.default=Sn;const{Axios:g9e,AxiosError:y9e,CanceledError:b9e,isCancel:v9e,CancelToken:w9e,VERSION:N9e,all:j9e,Cancel:_9e,isAxiosError:S9e,spread:C9e,toFormData:k9e,AxiosHeaders:A9e,HttpStatusCode:E9e,formToJSON:T9e,getAdapter:P9e,mergeConfig:I9e}=Sn;function aee(t){if(typeof document>"u")return;let s=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",s.appendChild(n),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}const iee=t=>{switch(t){case"success":return cee;case"info":return uee;case"warning":return dee;case"error":return hee;default:return null}},lee=Array(12).fill(0),oee=({visible:t,className:s})=>Qe.createElement("div",{className:["sonner-loading-wrapper",s].filter(Boolean).join(" "),"data-visible":t},Qe.createElement("div",{className:"sonner-spinner"},lee.map((n,a)=>Qe.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${a}`})))),cee=Qe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Qe.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),dee=Qe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Qe.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),uee=Qe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Qe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),hee=Qe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Qe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),fee=Qe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Qe.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Qe.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),mee=()=>{const[t,s]=Qe.useState(document.hidden);return Qe.useEffect(()=>{const n=()=>{s(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),t};let d_=1;class pee{constructor(){this.subscribe=s=>(this.subscribers.push(s),()=>{const n=this.subscribers.indexOf(s);this.subscribers.splice(n,1)}),this.publish=s=>{this.subscribers.forEach(n=>n(s))},this.addToast=s=>{this.publish(s),this.toasts=[...this.toasts,s]},this.create=s=>{var n;const{message:a,...i}=s,l=typeof(s==null?void 0:s.id)=="number"||((n=s.id)==null?void 0:n.length)>0?s.id:d_++,o=this.toasts.find(d=>d.id===l),c=s.dismissible===void 0?!0:s.dismissible;return this.dismissedToasts.has(l)&&this.dismissedToasts.delete(l),o?this.toasts=this.toasts.map(d=>d.id===l?(this.publish({...d,...s,id:l,title:a}),{...d,...s,id:l,dismissible:c,title:a}):d):this.addToast({title:a,...i,dismissible:c,id:l}),l},this.dismiss=s=>(s?(this.dismissedToasts.add(s),requestAnimationFrame(()=>this.subscribers.forEach(n=>n({id:s,dismiss:!0})))):this.toasts.forEach(n=>{this.subscribers.forEach(a=>a({id:n.id,dismiss:!0}))}),s),this.message=(s,n)=>this.create({...n,message:s}),this.error=(s,n)=>this.create({...n,message:s,type:"error"}),this.success=(s,n)=>this.create({...n,type:"success",message:s}),this.info=(s,n)=>this.create({...n,type:"info",message:s}),this.warning=(s,n)=>this.create({...n,type:"warning",message:s}),this.loading=(s,n)=>this.create({...n,type:"loading",message:s}),this.promise=(s,n)=>{if(!n)return;let a;n.loading!==void 0&&(a=this.create({...n,promise:s,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));const i=Promise.resolve(s instanceof Function?s():s);let l=a!==void 0,o;const c=i.then(async u=>{if(o=["resolve",u],Qe.isValidElement(u))l=!1,this.create({id:a,type:"default",message:u});else if(gee(u)&&!u.ok){l=!1;const m=typeof n.error=="function"?await n.error(`HTTP error! status: ${u.status}`):n.error,x=typeof n.description=="function"?await n.description(`HTTP error! status: ${u.status}`):n.description,w=typeof m=="object"&&!Qe.isValidElement(m)?m:{message:m};this.create({id:a,type:"error",description:x,...w})}else if(u instanceof Error){l=!1;const m=typeof n.error=="function"?await n.error(u):n.error,x=typeof n.description=="function"?await n.description(u):n.description,w=typeof m=="object"&&!Qe.isValidElement(m)?m:{message:m};this.create({id:a,type:"error",description:x,...w})}else if(n.success!==void 0){l=!1;const m=typeof n.success=="function"?await n.success(u):n.success,x=typeof n.description=="function"?await n.description(u):n.description,w=typeof m=="object"&&!Qe.isValidElement(m)?m:{message:m};this.create({id:a,type:"success",description:x,...w})}}).catch(async u=>{if(o=["reject",u],n.error!==void 0){l=!1;const f=typeof n.error=="function"?await n.error(u):n.error,m=typeof n.description=="function"?await n.description(u):n.description,b=typeof f=="object"&&!Qe.isValidElement(f)?f:{message:f};this.create({id:a,type:"error",description:m,...b})}}).finally(()=>{l&&(this.dismiss(a),a=void 0),n.finally==null||n.finally.call(n)}),d=()=>new Promise((u,f)=>c.then(()=>o[0]==="reject"?f(o[1]):u(o[1])).catch(f));return typeof a!="string"&&typeof a!="number"?{unwrap:d}:Object.assign(a,{unwrap:d})},this.custom=(s,n)=>{const a=(n==null?void 0:n.id)||d_++;return this.create({jsx:s(a),id:a,...n}),a},this.getActiveToasts=()=>this.toasts.filter(s=>!this.dismissedToasts.has(s.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const fa=new pee,xee=(t,s)=>{const n=(s==null?void 0:s.id)||d_++;return fa.addToast({title:t,...s,id:n}),n},gee=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",yee=xee,bee=()=>fa.toasts,vee=()=>fa.getActiveToasts(),ie=Object.assign(yee,{success:fa.success,info:fa.info,warning:fa.warning,error:fa.error,custom:fa.custom,message:fa.message,promise:fa.promise,dismiss:fa.dismiss,loading:fa.loading},{getHistory:bee,getToasts:vee});aee("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function v0(t){return t.label!==void 0}const wee=3,Nee="24px",jee="16px",i4=4e3,_ee=356,See=14,Cee=45,kee=200;function wl(...t){return t.filter(Boolean).join(" ")}function Aee(t){const[s,n]=t.split("-"),a=[];return s&&a.push(s),n&&a.push(n),a}const Eee=t=>{var s,n,a,i,l,o,c,d,u;const{invert:f,toast:m,unstyled:x,interacting:b,setHeights:w,visibleToasts:j,heights:_,index:C,toasts:k,expanded:A,removeToast:T,defaultRichColors:P,closeButton:R,style:I,cancelButtonStyle:O,actionButtonStyle:M,className:B="",descriptionClassName:L="",duration:F,position:V,gap:U,expandByDefault:z,classNames:W,icons:q,closeButtonAriaLabel:G="Close toast"}=t,[se,ge]=Qe.useState(null),[ke,ee]=Qe.useState(null),[pe,ue]=Qe.useState(!1),[ye,X]=Qe.useState(!1),[oe,_e]=Qe.useState(!1),[ce,he]=Qe.useState(!1),[fe,le]=Qe.useState(!1),[Ve,Ke]=Qe.useState(0),[wt,mt]=Qe.useState(0),rt=Qe.useRef(m.duration||F||i4),bt=Qe.useRef(null),be=Qe.useRef(null),ne=C===0,me=C+1<=j,Ne=m.type,Be=m.dismissible!==!1,jt=m.className||"",yt=m.descriptionClassName||"",pt=Qe.useMemo(()=>_.findIndex(Ot=>Ot.toastId===m.id)||0,[_,m.id]),Cs=Qe.useMemo(()=>{var Ot;return(Ot=m.closeButton)!=null?Ot:R},[m.closeButton,R]),hs=Qe.useMemo(()=>m.duration||F||i4,[m.duration,F]),ae=Qe.useRef(0),Te=Qe.useRef(0),de=Qe.useRef(0),Pe=Qe.useRef(null),[Ue,Le]=V.split("-"),Dt=Qe.useMemo(()=>_.reduce((Ot,we,it)=>it>=pt?Ot:Ot+we.height,0),[_,pt]),Rt=mee(),Zt=m.invert||f,vs=Ne==="loading";Te.current=Qe.useMemo(()=>pt*U+Dt,[pt,Dt]),Qe.useEffect(()=>{rt.current=hs},[hs]),Qe.useEffect(()=>{ue(!0)},[]),Qe.useEffect(()=>{const Ot=be.current;if(Ot){const we=Ot.getBoundingClientRect().height;return mt(we),w(it=>[{toastId:m.id,height:we,position:m.position},...it]),()=>w(it=>it.filter(ct=>ct.toastId!==m.id))}},[w,m.id]),Qe.useLayoutEffect(()=>{if(!pe)return;const Ot=be.current,we=Ot.style.height;Ot.style.height="auto";const it=Ot.getBoundingClientRect().height;Ot.style.height=we,mt(it),w(ct=>ct.find($t=>$t.toastId===m.id)?ct.map($t=>$t.toastId===m.id?{...$t,height:it}:$t):[{toastId:m.id,height:it,position:m.position},...ct])},[pe,m.title,m.description,w,m.id,m.jsx,m.action,m.cancel]);const bn=Qe.useCallback(()=>{X(!0),Ke(Te.current),w(Ot=>Ot.filter(we=>we.toastId!==m.id)),setTimeout(()=>{T(m)},kee)},[m,T,w,Te]);Qe.useEffect(()=>{if(m.promise&&Ne==="loading"||m.duration===1/0||m.type==="loading")return;let Ot;return A||b||Rt?(()=>{if(de.current<ae.current){const ct=new Date().getTime()-ae.current;rt.current=rt.current-ct}de.current=new Date().getTime()})():(()=>{rt.current!==1/0&&(ae.current=new Date().getTime(),Ot=setTimeout(()=>{m.onAutoClose==null||m.onAutoClose.call(m,m),bn()},rt.current))})(),()=>clearTimeout(Ot)},[A,b,m,Ne,Rt,bn]),Qe.useEffect(()=>{m.delete&&(bn(),m.onDismiss==null||m.onDismiss.call(m,m))},[bn,m.delete]);function Li(){var Ot;if(q!=null&&q.loading){var we;return Qe.createElement("div",{className:wl(W==null?void 0:W.loader,m==null||(we=m.classNames)==null?void 0:we.loader,"sonner-loader"),"data-visible":Ne==="loading"},q.loading)}return Qe.createElement(oee,{className:wl(W==null?void 0:W.loader,m==null||(Ot=m.classNames)==null?void 0:Ot.loader),visible:Ne==="loading"})}const zt=m.icon||(q==null?void 0:q[Ne])||iee(Ne);var Gt,ii;return Qe.createElement("li",{tabIndex:0,ref:be,className:wl(B,jt,W==null?void 0:W.toast,m==null||(s=m.classNames)==null?void 0:s.toast,W==null?void 0:W.default,W==null?void 0:W[Ne],m==null||(n=m.classNames)==null?void 0:n[Ne]),"data-sonner-toast":"","data-rich-colors":(Gt=m.richColors)!=null?Gt:P,"data-styled":!(m.jsx||m.unstyled||x),"data-mounted":pe,"data-promise":!!m.promise,"data-swiped":fe,"data-removed":ye,"data-visible":me,"data-y-position":Ue,"data-x-position":Le,"data-index":C,"data-front":ne,"data-swiping":oe,"data-dismissible":Be,"data-type":Ne,"data-invert":Zt,"data-swipe-out":ce,"data-swipe-direction":ke,"data-expanded":!!(A||z&&pe),"data-testid":m.testId,style:{"--index":C,"--toasts-before":C,"--z-index":k.length-C,"--offset":`${ye?Ve:Te.current}px`,"--initial-height":z?"auto":`${wt}px`,...I,...m.style},onDragEnd:()=>{_e(!1),ge(null),Pe.current=null},onPointerDown:Ot=>{Ot.button!==2&&(vs||!Be||(bt.current=new Date,Ke(Te.current),Ot.target.setPointerCapture(Ot.pointerId),Ot.target.tagName!=="BUTTON"&&(_e(!0),Pe.current={x:Ot.clientX,y:Ot.clientY})))},onPointerUp:()=>{var Ot,we,it;if(ce||!Be)return;Pe.current=null;const ct=Number(((Ot=be.current)==null?void 0:Ot.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Kt=Number(((we=be.current)==null?void 0:we.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),$t=new Date().getTime()-((it=bt.current)==null?void 0:it.getTime()),Ut=se==="x"?ct:Kt,Qs=Math.abs(Ut)/$t;if(Math.abs(Ut)>=Cee||Qs>.11){Ke(Te.current),m.onDismiss==null||m.onDismiss.call(m,m),ee(se==="x"?ct>0?"right":"left":Kt>0?"down":"up"),bn(),he(!0);return}else{var ws,Bn;(ws=be.current)==null||ws.style.setProperty("--swipe-amount-x","0px"),(Bn=be.current)==null||Bn.style.setProperty("--swipe-amount-y","0px")}le(!1),_e(!1),ge(null)},onPointerMove:Ot=>{var we,it,ct;if(!Pe.current||!Be||((we=window.getSelection())==null?void 0:we.toString().length)>0)return;const $t=Ot.clientY-Pe.current.y,Ut=Ot.clientX-Pe.current.x;var Qs;const ws=(Qs=t.swipeDirections)!=null?Qs:Aee(V);!se&&(Math.abs(Ut)>1||Math.abs($t)>1)&&ge(Math.abs(Ut)>Math.abs($t)?"x":"y");let Bn={x:0,y:0};const dn=Fn=>1/(1.5+Math.abs(Fn)/20);if(se==="y"){if(ws.includes("top")||ws.includes("bottom"))if(ws.includes("top")&&$t<0||ws.includes("bottom")&&$t>0)Bn.y=$t;else{const Fn=$t*dn($t);Bn.y=Math.abs(Fn)<Math.abs($t)?Fn:$t}}else if(se==="x"&&(ws.includes("left")||ws.includes("right")))if(ws.includes("left")&&Ut<0||ws.includes("right")&&Ut>0)Bn.x=Ut;else{const Fn=Ut*dn(Ut);Bn.x=Math.abs(Fn)<Math.abs(Ut)?Fn:Ut}(Math.abs(Bn.x)>0||Math.abs(Bn.y)>0)&&le(!0),(it=be.current)==null||it.style.setProperty("--swipe-amount-x",`${Bn.x}px`),(ct=be.current)==null||ct.style.setProperty("--swipe-amount-y",`${Bn.y}px`)}},Cs&&!m.jsx&&Ne!=="loading"?Qe.createElement("button",{"aria-label":G,"data-disabled":vs,"data-close-button":!0,onClick:vs||!Be?()=>{}:()=>{bn(),m.onDismiss==null||m.onDismiss.call(m,m)},className:wl(W==null?void 0:W.closeButton,m==null||(a=m.classNames)==null?void 0:a.closeButton)},(ii=q==null?void 0:q.close)!=null?ii:fee):null,(Ne||m.icon||m.promise)&&m.icon!==null&&((q==null?void 0:q[Ne])!==null||m.icon)?Qe.createElement("div",{"data-icon":"",className:wl(W==null?void 0:W.icon,m==null||(i=m.classNames)==null?void 0:i.icon)},m.promise||m.type==="loading"&&!m.icon?m.icon||Li():null,m.type!=="loading"?zt:null):null,Qe.createElement("div",{"data-content":"",className:wl(W==null?void 0:W.content,m==null||(l=m.classNames)==null?void 0:l.content)},Qe.createElement("div",{"data-title":"",className:wl(W==null?void 0:W.title,m==null||(o=m.classNames)==null?void 0:o.title)},m.jsx?m.jsx:typeof m.title=="function"?m.title():m.title),m.description?Qe.createElement("div",{"data-description":"",className:wl(L,yt,W==null?void 0:W.description,m==null||(c=m.classNames)==null?void 0:c.description)},typeof m.description=="function"?m.description():m.description):null),Qe.isValidElement(m.cancel)?m.cancel:m.cancel&&v0(m.cancel)?Qe.createElement("button",{"data-button":!0,"data-cancel":!0,style:m.cancelButtonStyle||O,onClick:Ot=>{v0(m.cancel)&&Be&&(m.cancel.onClick==null||m.cancel.onClick.call(m.cancel,Ot),bn())},className:wl(W==null?void 0:W.cancelButton,m==null||(d=m.classNames)==null?void 0:d.cancelButton)},m.cancel.label):null,Qe.isValidElement(m.action)?m.action:m.action&&v0(m.action)?Qe.createElement("button",{"data-button":!0,"data-action":!0,style:m.actionButtonStyle||M,onClick:Ot=>{v0(m.action)&&(m.action.onClick==null||m.action.onClick.call(m.action,Ot),!Ot.defaultPrevented&&bn())},className:wl(W==null?void 0:W.actionButton,m==null||(u=m.classNames)==null?void 0:u.actionButton)},m.action.label):null)};function l4(){if(typeof window>"u"||typeof document>"u")return"ltr";const t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function Tee(t,s){const n={};return[t,s].forEach((a,i)=>{const l=i===1,o=l?"--mobile-offset":"--offset",c=l?jee:Nee;function d(u){["top","right","bottom","left"].forEach(f=>{n[`${o}-${f}`]=typeof u=="number"?`${u}px`:u})}typeof a=="number"||typeof a=="string"?d(a):typeof a=="object"?["top","right","bottom","left"].forEach(u=>{a[u]===void 0?n[`${o}-${u}`]=c:n[`${o}-${u}`]=typeof a[u]=="number"?`${a[u]}px`:a[u]}):d(c)}),n}const Pee=Qe.forwardRef(function(s,n){const{id:a,invert:i,position:l="bottom-right",hotkey:o=["altKey","KeyT"],expand:c,closeButton:d,className:u,offset:f,mobileOffset:m,theme:x="light",richColors:b,duration:w,style:j,visibleToasts:_=wee,toastOptions:C,dir:k=l4(),gap:A=See,icons:T,containerAriaLabel:P="Notifications"}=s,[R,I]=Qe.useState([]),O=Qe.useMemo(()=>a?R.filter(pe=>pe.toasterId===a):R.filter(pe=>!pe.toasterId),[R,a]),M=Qe.useMemo(()=>Array.from(new Set([l].concat(O.filter(pe=>pe.position).map(pe=>pe.position)))),[O,l]),[B,L]=Qe.useState([]),[F,V]=Qe.useState(!1),[U,z]=Qe.useState(!1),[W,q]=Qe.useState(x!=="system"?x:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),G=Qe.useRef(null),se=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),ge=Qe.useRef(null),ke=Qe.useRef(!1),ee=Qe.useCallback(pe=>{I(ue=>{var ye;return(ye=ue.find(X=>X.id===pe.id))!=null&&ye.delete||fa.dismiss(pe.id),ue.filter(({id:X})=>X!==pe.id)})},[]);return Qe.useEffect(()=>fa.subscribe(pe=>{if(pe.dismiss){requestAnimationFrame(()=>{I(ue=>ue.map(ye=>ye.id===pe.id?{...ye,delete:!0}:ye))});return}setTimeout(()=>{vL.flushSync(()=>{I(ue=>{const ye=ue.findIndex(X=>X.id===pe.id);return ye!==-1?[...ue.slice(0,ye),{...ue[ye],...pe},...ue.slice(ye+1)]:[pe,...ue]})})})}),[R]),Qe.useEffect(()=>{if(x!=="system"){q(x);return}if(x==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?q("dark"):q("light")),typeof window>"u")return;const pe=window.matchMedia("(prefers-color-scheme: dark)");try{pe.addEventListener("change",({matches:ue})=>{q(ue?"dark":"light")})}catch{pe.addListener(({matches:ye})=>{try{q(ye?"dark":"light")}catch(X){console.error(X)}})}},[x]),Qe.useEffect(()=>{R.length<=1&&V(!1)},[R]),Qe.useEffect(()=>{const pe=ue=>{var ye;if(o.every(_e=>ue[_e]||ue.code===_e)){var oe;V(!0),(oe=G.current)==null||oe.focus()}ue.code==="Escape"&&(document.activeElement===G.current||(ye=G.current)!=null&&ye.contains(document.activeElement))&&V(!1)};return document.addEventListener("keydown",pe),()=>document.removeEventListener("keydown",pe)},[o]),Qe.useEffect(()=>{if(G.current)return()=>{ge.current&&(ge.current.focus({preventScroll:!0}),ge.current=null,ke.current=!1)}},[G.current]),Qe.createElement("section",{ref:n,"aria-label":`${P} ${se}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},M.map((pe,ue)=>{var ye;const[X,oe]=pe.split("-");return O.length?Qe.createElement("ol",{key:pe,dir:k==="auto"?l4():k,tabIndex:-1,ref:G,className:u,"data-sonner-toaster":!0,"data-sonner-theme":W,"data-y-position":X,"data-x-position":oe,style:{"--front-toast-height":`${((ye=B[0])==null?void 0:ye.height)||0}px`,"--width":`${_ee}px`,"--gap":`${A}px`,...j,...Tee(f,m)},onBlur:_e=>{ke.current&&!_e.currentTarget.contains(_e.relatedTarget)&&(ke.current=!1,ge.current&&(ge.current.focus({preventScroll:!0}),ge.current=null))},onFocus:_e=>{_e.target instanceof HTMLElement&&_e.target.dataset.dismissible==="false"||ke.current||(ke.current=!0,ge.current=_e.relatedTarget)},onMouseEnter:()=>V(!0),onMouseMove:()=>V(!0),onMouseLeave:()=>{U||V(!1)},onDragEnd:()=>V(!1),onPointerDown:_e=>{_e.target instanceof HTMLElement&&_e.target.dataset.dismissible==="false"||z(!0)},onPointerUp:()=>z(!1)},O.filter(_e=>!_e.position&&ue===0||_e.position===pe).map((_e,ce)=>{var he,fe;return Qe.createElement(Eee,{key:_e.id,icons:T,index:ce,toast:_e,defaultRichColors:b,duration:(he=C==null?void 0:C.duration)!=null?he:w,className:C==null?void 0:C.className,descriptionClassName:C==null?void 0:C.descriptionClassName,invert:i,visibleToasts:_,closeButton:(fe=C==null?void 0:C.closeButton)!=null?fe:d,interacting:U,position:pe,style:C==null?void 0:C.style,unstyled:C==null?void 0:C.unstyled,classNames:C==null?void 0:C.classNames,cancelButtonStyle:C==null?void 0:C.cancelButtonStyle,actionButtonStyle:C==null?void 0:C.actionButtonStyle,closeButtonAriaLabel:C==null?void 0:C.closeButtonAriaLabel,removeToast:ee,toasts:O.filter(le=>le.position==_e.position),heights:B.filter(le=>le.position==_e.position),setHeights:L,expandByDefault:c,gap:A,expanded:F,swipeDirections:s.swipeDirections})})):null}))}),y3="https://api.nutryah.com/api",J=Sn.create({baseURL:y3,withCredentials:!0});J.interceptors.request.use(t=>{const s=localStorage.getItem("access_token"),n=localStorage.getItem("tenant_code");return s&&(t.headers=t.headers||{},t.headers.Authorization=`Bearer ${s}`),n&&(t.headers=t.headers||{},t.headers["X-Tenant-Code"]=n),t});async function Iee(t,s){var n,a,i,l,o,c;try{const d=localStorage.getItem("tenant_code")||null;let u=null;try{(n=t==null?void 0:t.config)!=null&&n.data&&(u=typeof t.config.data=="string"?JSON.parse(t.config.data):t.config.data)}catch{u={raw:(a=t==null?void 0:t.config)==null?void 0:a.data}}const f={message:s,page_url:window.location.href,request_url:((i=t==null?void 0:t.config)==null?void 0:i.url)||null,request_method:((l=t==null?void 0:t.config)==null?void 0:l.method)||null,http_status:((o=t==null?void 0:t.response)==null?void 0:o.status)||null,request_payload:u,response_payload:((c=t==null?void 0:t.response)==null?void 0:c.data)||null,stack_trace:(t==null?void 0:t.stack)||null,tenant_code:d,user_agent:navigator.userAgent,extra:{network:navigator.onLine?"online":"offline"}};await fetch(`${y3}/system/client-error`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f),keepalive:!0})}catch(d){console.error("Failed to report client error",d)}}let pm=null;async function r7(){if(pm)return pm;const t=localStorage.getItem("tenant_code")||null;return pm=(async()=>{try{const s=await fetch(`${y3}/auth/refresh`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...t?{"X-Tenant-Code":t}:{}}});if(!s.ok)throw new Error(`Refresh failed with status ${s.status}`);const n=await s.json();return n!=null&&n.access_token&&localStorage.setItem("access_token",n.access_token),(n==null?void 0:n.access_token)||null}finally{pm=null}})(),pm}J.interceptors.response.use(t=>t,async t=>{var o,c,d,u;const s=(o=t==null?void 0:t.response)==null?void 0:o.status,n=(c=t==null?void 0:t.response)==null?void 0:c.data,a=t.config||{};if(s===401&&!a._retry){a._retry=!0;try{const f=await r7();if(f)return a.headers=a.headers||{},a.headers.Authorization=`Bearer ${f}`,J(a)}catch(f){console.error("Refresh token flow failed",f)}localStorage.clear(),(u=(d=J.defaults.headers)==null?void 0:d.common)==null||delete u.Authorization}const i=n==null?void 0:n.detail;let l="Unexpected error";return Array.isArray(i)?l=i.map(f=>`${Array.isArray(f.loc)?f.loc.join("."):f.loc}: ${f.msg}`).join(`
`):typeof i=="string"?l=i:typeof(n==null?void 0:n.message)=="string"?l=n.message:t!=null&&t.message&&(l=t.message),console.error("API error:",s,n),ie.error(l),Iee(t,l),Promise.reject(t)});const Mee={},o4=t=>{let s;const n=new Set,a=(f,m)=>{const x=typeof f=="function"?f(s):f;if(!Object.is(x,s)){const b=s;s=m??(typeof x!="object"||x===null)?x:Object.assign({},s,x),n.forEach(w=>w(s,b))}},i=()=>s,d={setState:a,getState:i,getInitialState:()=>u,subscribe:f=>(n.add(f),()=>n.delete(f)),destroy:()=>{(Mee?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=s=t(a,i,d);return d},Dee=t=>t?o4(t):o4;var a7={exports:{}},i7={},l7={exports:{}},o7={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xh=y;function Oee(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var Ree=typeof Object.is=="function"?Object.is:Oee,Lee=Xh.useState,Bee=Xh.useEffect,Fee=Xh.useLayoutEffect,$ee=Xh.useDebugValue;function zee(t,s){var n=s(),a=Lee({inst:{value:n,getSnapshot:s}}),i=a[0].inst,l=a[1];return Fee(function(){i.value=n,i.getSnapshot=s,uN(i)&&l({inst:i})},[t,n,s]),Bee(function(){return uN(i)&&l({inst:i}),t(function(){uN(i)&&l({inst:i})})},[t]),$ee(n),n}function uN(t){var s=t.getSnapshot;t=t.value;try{var n=s();return!Ree(t,n)}catch{return!0}}function Uee(t,s){return s()}var Vee=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Uee:zee;o7.useSyncExternalStore=Xh.useSyncExternalStore!==void 0?Xh.useSyncExternalStore:Vee;l7.exports=o7;var Hee=l7.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eb=y,Wee=Hee;function qee(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var Gee=typeof Object.is=="function"?Object.is:qee,Kee=Wee.useSyncExternalStore,Yee=Eb.useRef,Xee=Eb.useEffect,Qee=Eb.useMemo,Zee=Eb.useDebugValue;i7.useSyncExternalStoreWithSelector=function(t,s,n,a,i){var l=Yee(null);if(l.current===null){var o={hasValue:!1,value:null};l.current=o}else o=l.current;l=Qee(function(){function d(b){if(!u){if(u=!0,f=b,b=a(b),i!==void 0&&o.hasValue){var w=o.value;if(i(w,b))return m=w}return m=b}if(w=m,Gee(f,b))return w;var j=a(b);return i!==void 0&&i(w,j)?(f=b,w):(f=b,m=j)}var u=!1,f,m,x=n===void 0?null:n;return[function(){return d(s())},x===null?void 0:function(){return d(x())}]},[s,n,a,i]);var c=Kee(t,l[0],l[1]);return Xee(function(){o.hasValue=!0,o.value=c},[c]),Zee(c),c};a7.exports=i7;var c7=a7.exports;const Jee=Mi(c7),d7={},{useDebugValue:ete}=Qe,{useSyncExternalStoreWithSelector:tte}=Jee;let c4=!1;const ste=t=>t;function nte(t,s=ste,n){(d7?"production":void 0)!=="production"&&n&&!c4&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),c4=!0);const a=tte(t.subscribe,t.getState,t.getServerState||t.getInitialState,s,n);return ete(a),a}const d4=t=>{(d7?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const s=typeof t=="function"?Dee(t):t,n=(a,i)=>nte(s,a,i);return Object.assign(n,s),n},u7=t=>t?d4(t):d4,Zn=u7((t,s)=>({user:null,modules:{},loading:!1,tenantCode:localStorage.getItem("tenant_code")||"",setTenantCode:n=>{n?localStorage.setItem("tenant_code",n):localStorage.removeItem("tenant_code"),t({tenantCode:n})},registerAdmin:async n=>{var l;const a=await J.post("/auth/register-admin",n),i=(l=a==null?void 0:a.data)==null?void 0:l.tenant_code;return i&&(localStorage.setItem("tenant_code",i),t({tenantCode:i})),a},login:async({tenant_code:n,email:a,password:i})=>{const l={tenant_code:n==null?void 0:n.trim(),email:a,password:i},{data:o}=await J.post("/auth/login",l);return n&&(localStorage.setItem("tenant_code",n.trim()),t({tenantCode:n.trim()})),o},verifyOtp:async({tenant_code:n,email:a,otp:i})=>{const l={tenant_code:n==null?void 0:n.trim(),email:a,otp:i},{data:o}=await J.post("/auth/verify-otp",l);return localStorage.setItem("access_token",o.access_token),localStorage.setItem("refresh_token",o.refresh_token),J.defaults.headers.common.Authorization=`Bearer ${o.access_token}`,n&&(localStorage.setItem("tenant_code",n.trim()),t({tenantCode:n.trim()})),o},fetchProfile:async()=>{var n;try{t({loading:!0});const a=await J.get("/auth/me"),i=await J.get("/auth/me/permissions"),l=(n=a==null?void 0:a.data)==null?void 0:n.tenant_code;l&&localStorage.setItem("tenant_code",l),t({user:a.data,modules:i.data.modules||{},tenantCode:l||s().tenantCode})}finally{t({loading:!1})}},logout:()=>{localStorage.clear(),delete J.defaults.headers.common.Authorization,t({user:null,modules:{},tenantCode:""})}}));/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rte=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ate=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(s,n,a)=>a?a.toUpperCase():n.toLowerCase()),u4=t=>{const s=ate(t);return s.charAt(0).toUpperCase()+s.slice(1)},h7=(...t)=>t.filter((s,n,a)=>!!s&&s.trim()!==""&&a.indexOf(s)===n).join(" ").trim(),ite=t=>{for(const s in t)if(s.startsWith("aria-")||s==="role"||s==="title")return!0};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var lte={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ote=y.forwardRef(({color:t="currentColor",size:s=24,strokeWidth:n=2,absoluteStrokeWidth:a,className:i="",children:l,iconNode:o,...c},d)=>y.createElement("svg",{ref:d,...lte,width:s,height:s,stroke:t,strokeWidth:a?Number(n)*24/Number(s):n,className:h7("lucide",i),...!l&&!ite(c)&&{"aria-hidden":"true"},...c},[...o.map(([u,f])=>y.createElement(u,f)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=(t,s)=>{const n=y.forwardRef(({className:a,...i},l)=>y.createElement(ote,{ref:l,iconNode:s,className:h7(`lucide-${rte(u4(t))}`,`lucide-${t}`,a),...i}));return n.displayName=u4(t),n};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cte=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],sn=$e("activity",cte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dte=[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]],ute=$e("arrow-left-right",dte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hte=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Tb=$e("arrow-left",hte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fte=[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]],mte=$e("beaker",fte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pte=[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]],Jn=$e("bed-double",pte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xte=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],gte=$e("bell",xte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yte=[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]],bte=$e("boxes",yte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vte=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],ra=$e("building-2",vte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wte=[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]],h4=$e("calendar-clock",wte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nte=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],Kn=$e("calendar-days",Nte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jte=[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]],yh=$e("calendar-range",jte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _te=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],u_=$e("calendar",_te);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ste=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],f4=$e("camera",Ste);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cte=[["path",{d:"M14.564 14.558a3 3 0 1 1-4.122-4.121",key:"1rnrzw"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M20 20H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 .819-.175",key:"1x3arw"}],["path",{d:"M9.695 4.024A2 2 0 0 1 10.004 4h3.993a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v7.344",key:"1i84u0"}]],kte=$e("camera-off",Cte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ate=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Om=$e("chart-column",Ate);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ete=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],Tte=$e("chart-no-axes-column",Ete);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pte=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],b3=$e("check",Pte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ite=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],v3=$e("chevron-down",Ite);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mte=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Nx=$e("chevron-left",Mte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dte=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Sf=$e("chevron-right",Dte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ote=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Rte=$e("chevron-up",Ote);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lte=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],yn=$e("circle-alert",Lte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bte=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Ur=$e("circle-check",Bte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fte=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],$te=$e("circle-play",Fte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zte=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],w3=$e("circle-x",zte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ute=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],Vte=$e("clipboard-check",Ute);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hte=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],dr=$e("clipboard-list",Hte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wte=[["path",{d:"M12 6v6h4",key:"135r8i"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Xn=$e("clock-3",Wte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qte=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Sa=$e("clock",qte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gte=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],xm=$e("cloud-upload",Gte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kte=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Yte=$e("credit-card",Kte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xte=[["path",{d:"M10 12h.01",key:"1kxr2c"}],["path",{d:"M18 20V6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14",key:"36qu9e"}],["path",{d:"M2 20h20",key:"owomy5"}]],f7=$e("door-closed",Xte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qte=[["circle",{cx:"12.1",cy:"12.1",r:"1",key:"18d7e5"}]],w0=$e("dot",Qte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zte=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Ll=$e("download",Zte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jte=[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]],ese=$e("droplet",Jte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tse=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],h_=$e("droplets",tse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sse=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],nse=$e("eye-off",sse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rse=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Zm=$e("eye",rse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ase=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],ise=$e("file-down",ase);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lse=[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M3 15h6",key:"4e2qda"}],["path",{d:"M6 12v6",key:"1u72j0"}]],ose=$e("file-plus-2",lse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cse=[["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]],dse=$e("file-question-mark",cse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const use=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],hse=$e("file-spreadsheet",use);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fse=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],tl=$e("file-text",fse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mse=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],pse=$e("file-up",mse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xse=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],Bc=$e("flask-conical",xse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gse=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Ei=$e("funnel",gse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yse=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],m4=$e("hash",yse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bse=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}],["path",{d:"M3.22 13H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"auskq0"}]],Qh=$e("heart-pulse",bse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vse=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],wse=$e("history",vse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nse=[["path",{d:"M12 7v4",key:"xawao1"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M14 9h-4",key:"1w2s2s"}],["path",{d:"M18 11h2a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-9a2 2 0 0 1 2-2h2",key:"1tthqt"}],["path",{d:"M18 21V5a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16",key:"dw4p4i"}]],hN=$e("hospital",Nse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jse=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],_se=$e("image",jse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sse=[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]],Dg=$e("inbox",Sse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cse=[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]],Pl=$e("indian-rupee",Cse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kse=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Ep=$e("info",kse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ase=[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]],El=$e("key-round",Ase);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ese=[["rect",{width:"18",height:"12",x:"3",y:"4",rx:"2",ry:"2",key:"1qhy41"}],["line",{x1:"2",x2:"22",y1:"20",y2:"20",key:"ni3hll"}]],Tse=$e("laptop-minimal",Ese);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pse=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],N0=$e("layout-dashboard",Pse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ise=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],m7=$e("layers",Ise);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mse=[["rect",{width:"18",height:"7",x:"3",y:"3",rx:"1",key:"f1a2em"}],["rect",{width:"9",height:"7",x:"3",y:"14",rx:"1",key:"jqznyg"}],["rect",{width:"5",height:"7",x:"16",y:"14",rx:"1",key:"q5h2i8"}]],Dse=$e("layout-template",Mse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ose=[["path",{d:"M13 5h8",key:"a7qcls"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 19h8",key:"c3s6r1"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}]],Rse=$e("list-checks",Ose);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lse=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ss=$e("loader-circle",Lse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bse=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Fse=$e("log-out",Bse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $se=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],zse=$e("lock",$se);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Use=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Zh=$e("mail",Use);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vse=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],p7=$e("map-pin",Vse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hse=[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"pqwjuv"}]],p4=$e("notebook-pen",Hse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wse=[["path",{d:"M12 22v-9",key:"x3hkom"}],["path",{d:"M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z",key:"2ntwy6"}],["path",{d:"M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13",key:"1pmm1c"}],["path",{d:"M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z",key:"12ttoo"}]],qse=$e("package-open",Wse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gse=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],x7=$e("package",Gse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kse=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],Yse=$e("paperclip",Kse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xse=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],g7=$e("pen",Xse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qse=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Ja=$e("pencil",Qse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zse=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],x4=$e("phone",Zse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jse=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],Vr=$e("pill",Jse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ene=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],us=$e("plus",ene);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tne=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],My=$e("printer",tne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sne=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]],fN=$e("qr-code",sne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nne=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M8 7h8",key:"i86dvs"}],["path",{d:"M12 17.5 8 15h1a4 4 0 0 0 0-8",key:"grpkl4"}],["path",{d:"M8 11h8",key:"vwpz6n"}]],mN=$e("receipt-indian-rupee",nne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rne=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]],f_=$e("receipt",rne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ane=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],hu=$e("refresh-ccw",ane);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ine=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],pN=$e("refresh-cw",ine);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lne=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Si=$e("rotate-ccw",lne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const one=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],g4=$e("save",one);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cne=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M8 7v10",key:"23sfjj"}],["path",{d:"M12 7v10",key:"jspqdw"}],["path",{d:"M17 7v10",key:"578dap"}]],j0=$e("scan-barcode",cne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dne=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]],Dy=$e("scan-line",dne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const une=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]],Og=$e("scan",une);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hne=[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]],y7=$e("scissors",hne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fne=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],is=$e("search",fne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mne=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],pne=$e("settings-2",mne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xne=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],gne=$e("settings",xne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yne=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],bne=$e("shield-alert",yne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vne=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Aa=$e("shield-check",vne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wne=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9 12h6",key:"1c52cq"}],["path",{d:"M12 9v6",key:"199k2o"}]],Nne=$e("shield-plus",wne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jne=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],b7=$e("shield",jne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _ne=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],Oy=$e("shopping-cart",_ne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sne=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Pb=$e("sparkles",Sne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cne=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],_s=$e("stethoscope",Cne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kne=[["path",{d:"m18 2 4 4",key:"22kx64"}],["path",{d:"m17 7 3-3",key:"1w1zoj"}],["path",{d:"M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-.6-.6c-1-1-1-2.5 0-3.4L15 5",key:"1exhtz"}],["path",{d:"m9 11 4 4",key:"rovt3i"}],["path",{d:"m5 19-3 3",key:"59f2uf"}],["path",{d:"m14 4 6 6",key:"yqp9t2"}]],y4=$e("syringe",kne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ane=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Rm=$e("tag",Ane);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ene=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],Tp=$e("thermometer",Ene);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tne=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],qr=$e("trash-2",Tne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pne=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Ine=$e("trending-up",Pne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mne=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],So=$e("triangle-alert",Mne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dne=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],One=$e("truck",Dne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rne=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],m_=$e("upload",Rne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lne=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],b4=$e("user-plus",Lne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bne=[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]],Pp=$e("user-round",Bne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fne=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Fc=$e("users",Fne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ne=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],on=$e("user",$ne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zne=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],Une=$e("wind",zne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vne=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Rn=$e("x",Vne);function Hne(){var b,w;const t=Di(),s=Ta(),n=Zn(j=>j.login),[a,i]=y.useState({tenant_code:((b=t.state)==null?void 0:b.tenant_code)||localStorage.getItem("tenant_code")||localStorage.getItem("pending_tenant_code")||"",email:((w=t.state)==null?void 0:w.email)||localStorage.getItem("pending_email")||"",password:""}),[l,o]=y.useState(""),[c,d]=y.useState(!1),[u,f]=y.useState(!1),m=y.useMemo(()=>a.tenant_code.trim()&&a.email.trim()&&a.password.trim()&&!c,[a,c]),x=async j=>{var _,C;if(j.preventDefault(),!!m){o(""),d(!0);try{await n({tenant_code:a.tenant_code.trim(),email:a.email.trim(),password:a.password}),localStorage.setItem("pending_email",a.email.trim()),localStorage.setItem("pending_tenant_code",a.tenant_code.trim()),s("/auth/verify",{state:{email:a.email.trim(),tenant_code:a.tenant_code.trim()}})}catch(k){o(((C=(_=k==null?void 0:k.response)==null?void 0:_.data)==null?void 0:C.detail)||"Invalid credentials")}finally{d(!1)}}};return r.jsxs("div",{className:"relative min-h-screen overflow-hidden bg-gradient-to-b from-gray-50 to-white",children:[r.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[r.jsx("div",{className:"absolute -left-24 -top-24 h-64 w-64 rounded-full bg-blue-100 blur-3xl animate-pulse"}),r.jsx("div",{className:"absolute -right-24 -bottom-24 h-72 w-72 rounded-full bg-indigo-100 blur-3xl animate-pulse"})]}),r.jsx("div",{className:"relative z-10 grid min-h-screen place-items-center px-4 py-10",children:r.jsxs("div",{className:"w-full max-w-md",children:[r.jsxs("div",{className:"relative overflow-hidden rounded-2xl border border-gray-100 bg-white/80 p-6 shadow-sm backdrop-blur",children:[r.jsx("div",{className:"pointer-events-none absolute -right-12 -top-12 h-32 w-32 rotate-45 bg-gradient-to-br from-blue-50 to-indigo-50"}),r.jsxs("div",{className:"mb-6 flex items-center justify-between gap-3",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-blue-600 text-white ring-8 ring-blue-50",children:r.jsx("span",{className:"text-sm font-bold tracking-tight",children:"NDH"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-semibold tracking-tight",children:"NUTRYAH's HIMS & EMR"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Multi-tenant login with Hospital Code + Email + OTP"})]})]}),r.jsx(Aa,{className:"h-6 w-6 text-emerald-600"})]}),r.jsxs("form",{onSubmit:x,className:"space-y-4","aria-busy":c,children:[r.jsxs("label",{className:"block",children:[r.jsx("span",{className:"mb-1 block text-sm text-gray-600",children:"Hospital Code"}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-gray-200 bg-white px-3 py-2 focus-within:ring-2 focus-within:ring-blue-200",children:[r.jsx(ra,{className:"h-4 w-4 text-gray-400"}),r.jsx("input",{className:"w-full bg-transparent outline-none placeholder:text-gray-400 uppercase",placeholder:"KGH001",value:a.tenant_code,onChange:j=>i(_=>({..._,tenant_code:j.target.value.toUpperCase()})),required:!0,disabled:c})]}),r.jsx("p",{className:"mt-1 text-[11px] text-gray-500",children:"Hospital / Clinic code assigned by NUTRYAH (Tenant Code)."})]}),r.jsxs("label",{className:"block",children:[r.jsx("span",{className:"mb-1 block text-sm text-gray-600",children:"Email"}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-gray-200 bg-white px-3 py-2 focus-within:ring-2 focus-within:ring-blue-200",children:[r.jsx(Zh,{className:"h-4 w-4 text-gray-400"}),r.jsx("input",{className:"w-full bg-transparent outline-none placeholder:text-gray-400",placeholder:"you@hospital.org",type:"email",autoComplete:"email",value:a.email,onChange:j=>i(_=>({..._,email:j.target.value})),required:!0,disabled:c})]})]}),r.jsxs("label",{className:"block",children:[r.jsx("span",{className:"mb-1 block text-sm text-gray-600",children:"Password"}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-gray-200 bg-white px-3 py-2 focus-within:ring-2 focus-within:ring-blue-200",children:[r.jsx(zse,{className:"h-4 w-4 text-gray-400"}),r.jsx("input",{className:"w-full bg-transparent outline-none placeholder:text-gray-400",placeholder:"",type:u?"text":"password",autoComplete:"current-password",value:a.password,onChange:j=>i(_=>({..._,password:j.target.value})),required:!0,disabled:c}),r.jsx("button",{type:"button",onClick:()=>f(j=>!j),className:"rounded-lg p-1.5 text-gray-500 hover:bg-gray-50","aria-label":u?"Hide password":"Show password",tabIndex:-1,disabled:c,children:u?r.jsx(nse,{className:"h-4 w-4"}):r.jsx(Zm,{className:"h-4 w-4"})})]})]}),r.jsx("button",{className:"inline-flex w-full items-center justify-center gap-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 px-4 py-2.5 text-white shadow-sm transition active:scale-[0.99] disabled:cursor-not-allowed disabled:opacity-60",disabled:!m,type:"submit",children:c?r.jsxs(r.Fragment,{children:[r.jsx(ss,{className:"h-5 w-5 animate-spin"}),r.jsx("span",{children:"Sending OTP"})]}):r.jsx(r.Fragment,{children:"Send OTP"})}),l&&r.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:l}),r.jsx("p",{className:"text-center text-xs text-gray-500",children:"Tip: You'll receive a 6-digit OTP in your email. Keep this tab open."})]}),c&&r.jsx("div",{className:"absolute inset-0 grid place-items-center rounded-2xl bg-white/70 backdrop-blur-sm",children:r.jsxs("div",{className:"w-full max-w-xs rounded-xl border border-gray-100 bg-white p-4 shadow-md",children:[r.jsxs("div",{className:"mb-2 flex items-center gap-2 text-sm text-gray-700",children:[r.jsx(ss,{className:"h-4 w-4 animate-spin text-blue-600"}),"Sending OTP"]}),r.jsx("div",{className:"relative h-2 overflow-hidden rounded-full bg-gray-100",children:r.jsx("div",{className:"absolute inset-y-0 left-0 w-1/3 animate-[progress_1.2s_infinite] rounded-full bg-gradient-to-r from-blue-500 to-indigo-500"})}),r.jsxs("div",{className:"mt-3 flex items-center justify-center gap-1",children:[r.jsx("span",{className:"h-2 w-2 animate-bounce rounded-full bg-blue-500 [animation-delay:-0.2s]"}),r.jsx("span",{className:"h-2 w-2 animate-bounce rounded-full bg-blue-500 [animation-delay:-0.1s]"}),r.jsx("span",{className:"h-2 w-2 animate-bounce rounded-full bg-blue-500"})]})]})})]}),r.jsxs("div",{className:"mx-auto mt-6 text-center text-xs text-gray-500",children:[" ",new Date().getFullYear()," NUTRYAH  Multi-tenant Secure Access"]})]})}),r.jsx("style",{children:`
        @keyframes progress {
          0% { transform: translateX(-120%); }
          100% { transform: translateX(300%); }
        }
      `})]})}function Wne(){const[t,s]=y.useState({tenant_name:"",tenant_code:"",hospital_address:"",contact_person:"",contact_phone:"",subscription_plan:"standard",admin_name:"",email:"",password:"",confirm_password:""}),[n,a]=y.useState(!1),[i,l]=y.useState(""),o=Zn(f=>f.registerAdmin),c=Ta(),d=f=>m=>s(x=>({...x,[f]:m.target.value})),u=async f=>{var m,x;if(f.preventDefault(),!n){if(l(""),t.password!==t.confirm_password){l("Passwords do not match");return}a(!0);try{const b=await o(t),{tenant_code:w}=b.data||{};alert(`Hospital onboarded successfully.
Tenant Code: ${w||t.tenant_code||"Generated"}

Please login with Hospital Code + Admin email.`),c("/auth/login",{replace:!0,state:{email:t.email,tenant_code:w||t.tenant_code}})}catch(b){l(((x=(m=b==null?void 0:b.response)==null?void 0:m.data)==null?void 0:x.detail)||"Failed to register tenant admin")}finally{a(!1)}}};return r.jsxs("div",{className:"relative min-h-screen overflow-hidden bg-gradient-to-b from-slate-50 to-white",children:[r.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[r.jsx("div",{className:"absolute -left-24 -top-24 h-64 w-64 rounded-full bg-blue-100 blur-3xl"}),r.jsx("div",{className:"absolute -right-24 -bottom-24 h-72 w-72 rounded-full bg-indigo-100 blur-3xl"})]}),r.jsx("div",{className:"relative z-10 grid min-h-screen place-items-center px-4 py-8",children:r.jsxs("div",{className:"w-full max-w-2xl",children:[r.jsxs("div",{className:"mb-6 flex items-center justify-center gap-3",children:[r.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-blue-600 text-white ring-8 ring-blue-50",children:r.jsx("span",{className:"text-sm font-bold tracking-tight",children:"NDH"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl font-semibold tracking-tight",children:"Onboard a New Hospital / Clinic"}),r.jsx("p",{className:"text-xs text-slate-500",children:"This will create a dedicated NABH HIMS & EMR tenant with its own database."})]})]}),r.jsxs("form",{onSubmit:u,className:"space-y-5 rounded-2xl border border-slate-200 bg-white/80 p-6 shadow-sm backdrop-blur",children:[r.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"mb-1 block text-sm text-slate-700",children:"Hospital / Clinic Name"}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 focus-within:ring-2 focus-within:ring-blue-200",children:[r.jsx(ra,{className:"h-4 w-4 text-slate-400"}),r.jsx("input",{className:"w-full bg-transparent outline-none placeholder:text-slate-400",placeholder:"Kovai Multispeciality Hospital",value:t.tenant_name,onChange:d("tenant_name"),required:!0})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-sm text-slate-700",children:"Hospital Code (Tenant Code)"}),r.jsx("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none placeholder:text-slate-400 focus:ring-2 focus:ring-blue-200",placeholder:"KGH001",value:t.tenant_code,onChange:f=>s(m=>({...m,tenant_code:f.target.value.toUpperCase()}))}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Optional. If empty, the system will generate a code from the name."})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-sm text-slate-700",children:"Contact Person"}),r.jsx("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none placeholder:text-slate-400 focus:ring-2 focus:ring-blue-200",placeholder:"Dr. Admin / IT Head",value:t.contact_person,onChange:d("contact_person"),required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-sm text-slate-700",children:"Contact Phone"}),r.jsx("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none placeholder:text-slate-400 focus:ring-2 focus:ring-blue-200",placeholder:"+91 9XXXXXXXXX",value:t.contact_phone,onChange:d("contact_phone")})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"mb-1 block text-sm text-slate-700",children:"Hospital Address"}),r.jsx("textarea",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none placeholder:text-slate-400 focus:ring-2 focus:ring-blue-200",placeholder:"Address, City, State, Pincode",rows:2,value:t.hospital_address,onChange:d("hospital_address")})]})]}),r.jsxs("div",{className:"space-y-3 rounded-2xl border border-slate-100 bg-slate-50/70 p-4",children:[r.jsxs("div",{className:"mb-1 flex items-center gap-2 text-sm font-medium text-slate-800",children:[r.jsx(Ep,{className:"h-4 w-4 text-blue-600"}),"Subscription & License Period"]}),r.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-sm text-slate-700",children:"Subscription Plan"}),r.jsxs("select",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-blue-200",value:t.subscription_plan,onChange:d("subscription_plan"),children:[r.jsx("option",{value:"basic",children:"Basic (Monthly)"}),r.jsx("option",{value:"standard",children:"Standard (6 Months)"}),r.jsx("option",{value:"premium",children:"Premium (1 Year)"})]})]}),r.jsxs("div",{className:"text-xs text-slate-600 space-y-1",children:[r.jsx("p",{className:"font-medium text-slate-700",children:"License Duration (auto-calculated):"}),r.jsxs("ul",{className:"list-disc pl-4 space-y-0.5",children:[r.jsx("li",{children:"Basic  30 days from registration"}),r.jsx("li",{children:"Standard  6 months from registration"}),r.jsx("li",{children:"Premium  1 year from registration"})]}),r.jsx("p",{className:"pt-1 text-[11px] text-slate-500",children:"AMC, subscription amount, and renewals are configured by NUTRYAH admin in the master console. They are not editable from this screen."})]})]})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-slate-50/80 p-4",children:[r.jsxs("div",{className:"mb-3 flex items-center gap-2 text-sm font-medium text-slate-800",children:[r.jsx(Nne,{className:"h-4 w-4 text-blue-600"}),"Admin Login for this Tenant"]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs text-slate-600",children:"Admin Name"}),r.jsx("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none placeholder:text-slate-400 focus:ring-2 focus:ring-blue-200",placeholder:"Super Admin",value:t.admin_name,onChange:d("admin_name"),required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs text-slate-600",children:"Admin Email"}),r.jsx("input",{type:"email",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none placeholder:text-slate-400 focus:ring-2 focus:ring-blue-200",placeholder:"admin@hospital.org",value:t.email,onChange:d("email"),required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs text-slate-600",children:"Password"}),r.jsx("input",{type:"password",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-blue-200",value:t.password,onChange:d("password"),required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs text-slate-600",children:"Confirm Password"}),r.jsx("input",{type:"password",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-blue-200",value:t.confirm_password,onChange:d("confirm_password"),required:!0})]})]})]}),i&&r.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:i}),r.jsx("button",{type:"submit",disabled:n,className:"inline-flex w-full items-center justify-center gap-2 rounded-xl bg-slate-900 px-4 py-2.5 text-sm font-medium text-white shadow-sm transition active:scale-[0.99] disabled:cursor-not-allowed disabled:opacity-60",children:n?r.jsxs(r.Fragment,{children:[r.jsx(ss,{className:"h-4 w-4 animate-spin"}),"Creating Tenant"]}):"Create Tenant & Admin"}),r.jsx("p",{className:"text-center text-[11px] text-slate-500",children:"After this step, use the Hospital Code + Admin Email to login and access the dedicated HIMS database."})]})]})})]})}function qne(){var M,B;const t=Di(),s=Ta(),n=Zn(L=>L.verifyOtp),a=Zn(L=>L.fetchProfile),[i]=y.useState(((M=t.state)==null?void 0:M.email)||localStorage.getItem("pending_email")||""),[l]=y.useState(((B=t.state)==null?void 0:B.tenant_code)||localStorage.getItem("pending_tenant_code")||localStorage.getItem("tenant_code")||""),[o,c]=y.useState(["","","","","",""]),[d,u]=y.useState(""),[f,m]=y.useState(!1),[x,b]=y.useState(60),[w,j]=y.useState(!1),_=y.useRef([]);y.useEffect(()=>{(!i||!l)&&s("/auth/login",{replace:!0})},[i,l,s]),y.useEffect(()=>{if(x<=0)return;const L=setInterval(()=>b(F=>F-1),1e3);return()=>clearInterval(L)},[x]);const C=y.useMemo(()=>o.join(""),[o]),k=C.length===6&&!o.includes("")&&!f,A=(L,F)=>{var U;const V=(F||"").replace(/\D/g,"").slice(-1);c(z=>{const W=[...z];return W[L]=V,W}),V&&L<5&&((U=_.current[L+1])==null||U.focus())},T=(L,F)=>{var V,U,z;F.key==="Backspace"?o[L]?c(W=>{const q=[...W];return q[L]="",q}):L>0&&((V=_.current[L-1])==null||V.focus(),c(W=>{const q=[...W];return q[L-1]="",q})):F.key==="ArrowLeft"&&L>0?(U=_.current[L-1])==null||U.focus():F.key==="ArrowRight"&&L<5&&((z=_.current[L+1])==null||z.focus())},P=L=>{var U;L.preventDefault();const F=(L.clipboardData.getData("text")||"").replace(/\D/g,"").slice(0,6);if(!F)return;const V=F.split("");c([V[0]||"",V[1]||"",V[2]||"",V[3]||"",V[4]||"",V[5]||""]),(U=_.current[Math.min(F.length,5)])==null||U.focus()},R=async L=>{var F,V;if(L.preventDefault(),!!k){u(""),m(!0);try{await n({tenant_code:l,email:i,otp:C}),await a(),j(!0),setTimeout(()=>{const U=Zn.getState().user;U!=null&&U.is_admin?s("/admin",{replace:!0}):s("/dashboard",{replace:!0})},400)}catch(U){u(((V=(F=U==null?void 0:U.response)==null?void 0:F.data)==null?void 0:V.detail)||"Invalid or expired OTP")}finally{m(!1)}}},I=()=>{s("/auth/login",{state:{email:i,tenant_code:l},replace:!0})},O=()=>{I()};return r.jsxs("div",{className:"relative min-h-screen overflow-hidden bg-gradient-to-b from-gray-50 to-white",children:[r.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[r.jsx("div",{className:"absolute -left-24 -top-24 h-64 w-64 rounded-full bg-blue-100 blur-3xl animate-pulse"}),r.jsx("div",{className:"absolute -right-24 -bottom-24 h-72 w-72 rounded-full bg-indigo-100 blur-3xl animate-pulse"})]}),r.jsx("div",{className:"relative z-10 grid min-h-screen place-items-center px-4 py-8",children:r.jsxs("div",{className:"w-full max-w-md",children:[r.jsxs("div",{className:"relative overflow-hidden rounded-2xl border border-gray-100 bg-white/80 p-6 shadow-sm backdrop-blur",children:[r.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-blue-600 text-white ring-8 ring-blue-50",children:r.jsx("span",{className:"text-sm font-bold",children:"NDH"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-semibold tracking-tight",children:"Verify OTP"}),r.jsx("p",{className:"text-xs text-gray-500",children:"We sent a 6-digit code to your email"})]})]}),r.jsx(Aa,{className:"h-6 w-6 text-emerald-600"})]}),r.jsxs("div",{className:"mb-4 space-y-2 text-sm",children:[r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-gray-100 bg-gray-50 px-3 py-2 text-gray-700",children:[r.jsx(Zh,{className:"h-4 w-4 text-gray-400"}),r.jsx("span",{className:"truncate",children:i}),r.jsx("button",{type:"button",onClick:I,className:"ml-auto text-xs text-blue-700 underline-offset-2 hover:underline",children:"Change"})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-gray-100 bg-gray-50 px-3 py-2 text-gray-700",children:[r.jsx(ra,{className:"h-4 w-4 text-gray-400"}),r.jsxs("span",{className:"text-xs font-medium uppercase",children:["Hospital Code: ",l]})]})]}),r.jsxs("form",{onSubmit:R,className:"space-y-4",children:[r.jsx("div",{className:"grid grid-cols-6 gap-2 sm:gap-3",onPaste:P,children:o.map((L,F)=>r.jsx("input",{ref:V=>_.current[F]=V,value:L,inputMode:"numeric",pattern:"[0-9]*",maxLength:1,autoFocus:F===0,onChange:V=>A(F,V.target.value),onKeyDown:V=>T(F,V),className:`h-12 rounded-xl border border-gray-200 text-center text-lg tracking-[0.2em] outline-none transition\r
                               focus:border-blue-400 focus:ring-2 focus:ring-blue-200 sm:h-14`,"aria-label":`OTP digit ${F+1}`},F))}),r.jsx("button",{className:"inline-flex w-full items-center justify-center gap-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 px-4 py-2.5 text-white shadow-sm transition active:scale-[0.99] disabled:cursor-not-allowed disabled:opacity-60",disabled:!k,type:"submit",children:f?r.jsxs(r.Fragment,{children:[r.jsx(ss,{className:"h-5 w-5 animate-spin"}),"Verifying"]}):w?r.jsxs(r.Fragment,{children:[r.jsx(Ur,{className:"h-5 w-5"}),"Verified"]}):"Verify & Continue"}),r.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600",children:[r.jsxs("button",{type:"button",onClick:I,className:"inline-flex items-center gap-1 rounded-lg px-2 py-1 hover:bg-gray-50",children:[r.jsx(Tb,{className:"h-3.5 w-3.5"}),"Back to login"]}),r.jsx("div",{className:"flex items-center gap-2",children:x>0?r.jsxs("span",{className:"rounded-lg bg-gray-50 px-2 py-1 tabular-nums",children:["Resend in ",x,"s"]}):r.jsx("button",{type:"button",onClick:O,className:"rounded-lg bg-gray-900 px-2 py-1 text-white hover:bg-gray-800",children:"Resend OTP"})})]}),d&&r.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",role:"alert","aria-live":"polite",children:d})]}),f&&r.jsx("div",{className:"absolute inset-0 grid place-items-center rounded-2xl bg-white/70 backdrop-blur-sm",children:r.jsxs("div",{className:"w-full max-w-xs rounded-xl border border-gray-100 bg-white p-4 shadow-md",children:[r.jsxs("div",{className:"mb-2 flex items-center gap-2 text-sm text-gray-700",children:[r.jsx(ss,{className:"h-4 w-4 animate-spin text-blue-600"}),"Verifying"]}),r.jsx("div",{className:"relative h-2 overflow-hidden rounded-full bg-gray-100",children:r.jsx("div",{className:"absolute inset-y-0 left-0 w-1/3 animate-[progress_1.1s_infinite_linear] rounded-full bg-gradient-to-r from-blue-500 to-indigo-500"})})]})})]}),r.jsx("div",{className:"mx-auto mt-6 text-center text-xs text-gray-500",children:"Didnt receive the mail? Check Spam/Junk folder."})]})}),r.jsx("style",{children:`
        @keyframes progress {
          0% { transform: translateX(-120%); }
          100% { transform: translateX(300%); }
        }
      `})]})}const N3=y.createContext({});function j3(t){const s=y.useRef(null);return s.current===null&&(s.current=t()),s.current}const _3=typeof window<"u",v7=_3?y.useLayoutEffect:y.useEffect,Ib=y.createContext(null);function S3(t,s){t.indexOf(s)===-1&&t.push(s)}function C3(t,s){const n=t.indexOf(s);n>-1&&t.splice(n,1)}const Co=(t,s,n)=>n>s?s:n<t?t:n;let k3=()=>{};const ko={},w7=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function N7(t){return typeof t=="object"&&t!==null}const j7=t=>/^0[^.\s]+$/u.test(t);function A3(t){let s;return()=>(s===void 0&&(s=t()),s)}const Ci=t=>t,Gne=(t,s)=>n=>s(t(n)),jx=(...t)=>t.reduce(Gne),Ip=(t,s,n)=>{const a=s-t;return a===0?1:(n-t)/a};class E3{constructor(){this.subscriptions=[]}add(s){return S3(this.subscriptions,s),()=>C3(this.subscriptions,s)}notify(s,n,a){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](s,n,a);else for(let l=0;l<i;l++){const o=this.subscriptions[l];o&&o(s,n,a)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Bl=t=>t*1e3,Ni=t=>t/1e3;function _7(t,s){return s?t*(1e3/s):0}const S7=(t,s,n)=>(((1-3*n+3*s)*t+(3*n-6*s))*t+3*s)*t,Kne=1e-7,Yne=12;function Xne(t,s,n,a,i){let l,o,c=0;do o=s+(n-s)/2,l=S7(o,a,i)-t,l>0?n=o:s=o;while(Math.abs(l)>Kne&&++c<Yne);return o}function _x(t,s,n,a){if(t===s&&n===a)return Ci;const i=l=>Xne(l,0,1,t,n);return l=>l===0||l===1?l:S7(i(l),s,a)}const C7=t=>s=>s<=.5?t(2*s)/2:(2-t(2*(1-s)))/2,k7=t=>s=>1-t(1-s),A7=_x(.33,1.53,.69,.99),T3=k7(A7),E7=C7(T3),T7=t=>(t*=2)<1?.5*T3(t):.5*(2-Math.pow(2,-10*(t-1))),P3=t=>1-Math.sin(Math.acos(t)),P7=k7(P3),I7=C7(P3),Qne=_x(.42,0,1,1),Zne=_x(0,0,.58,1),M7=_x(.42,0,.58,1),Jne=t=>Array.isArray(t)&&typeof t[0]!="number",D7=t=>Array.isArray(t)&&typeof t[0]=="number",ere={linear:Ci,easeIn:Qne,easeInOut:M7,easeOut:Zne,circIn:P3,circInOut:I7,circOut:P7,backIn:T3,backInOut:E7,backOut:A7,anticipate:T7},tre=t=>typeof t=="string",v4=t=>{if(D7(t)){k3(t.length===4);const[s,n,a,i]=t;return _x(s,n,a,i)}else if(tre(t))return ere[t];return t},_0=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function sre(t,s){let n=new Set,a=new Set,i=!1,l=!1;const o=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1};function d(f){o.has(f)&&(u.schedule(f),t()),f(c)}const u={schedule:(f,m=!1,x=!1)=>{const w=x&&i?n:a;return m&&o.add(f),w.has(f)||w.add(f),f},cancel:f=>{a.delete(f),o.delete(f)},process:f=>{if(c=f,i){l=!0;return}i=!0,[n,a]=[a,n],n.forEach(d),n.clear(),i=!1,l&&(l=!1,u.process(f))}};return u}const nre=40;function O7(t,s){let n=!1,a=!0;const i={delta:0,timestamp:0,isProcessing:!1},l=()=>n=!0,o=_0.reduce((A,T)=>(A[T]=sre(l),A),{}),{setup:c,read:d,resolveKeyframes:u,preUpdate:f,update:m,preRender:x,render:b,postRender:w}=o,j=()=>{const A=ko.useManualTiming?i.timestamp:performance.now();n=!1,ko.useManualTiming||(i.delta=a?1e3/60:Math.max(Math.min(A-i.timestamp,nre),1)),i.timestamp=A,i.isProcessing=!0,c.process(i),d.process(i),u.process(i),f.process(i),m.process(i),x.process(i),b.process(i),w.process(i),i.isProcessing=!1,n&&s&&(a=!1,t(j))},_=()=>{n=!0,a=!0,i.isProcessing||t(j)};return{schedule:_0.reduce((A,T)=>{const P=o[T];return A[T]=(R,I=!1,O=!1)=>(n||_(),P.schedule(R,I,O)),A},{}),cancel:A=>{for(let T=0;T<_0.length;T++)o[_0[T]].cancel(A)},state:i,steps:o}}const{schedule:Gs,cancel:$c,state:Cr,steps:xN}=O7(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ci,!0);let Rg;function rre(){Rg=void 0}const ya={now:()=>(Rg===void 0&&ya.set(Cr.isProcessing||ko.useManualTiming?Cr.timestamp:performance.now()),Rg),set:t=>{Rg=t,queueMicrotask(rre)}},R7=t=>s=>typeof s=="string"&&s.startsWith(t),I3=R7("--"),are=R7("var(--"),M3=t=>are(t)?ire.test(t.split("/*")[0].trim()):!1,ire=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Cf={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Mp={...Cf,transform:t=>Co(0,1,t)},S0={...Cf,default:1},Jm=t=>Math.round(t*1e5)/1e5,D3=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function lre(t){return t==null}const ore=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,O3=(t,s)=>n=>!!(typeof n=="string"&&ore.test(n)&&n.startsWith(t)||s&&!lre(n)&&Object.prototype.hasOwnProperty.call(n,s)),L7=(t,s,n)=>a=>{if(typeof a!="string")return a;const[i,l,o,c]=a.match(D3);return{[t]:parseFloat(i),[s]:parseFloat(l),[n]:parseFloat(o),alpha:c!==void 0?parseFloat(c):1}},cre=t=>Co(0,255,t),gN={...Cf,transform:t=>Math.round(cre(t))},Bd={test:O3("rgb","red"),parse:L7("red","green","blue"),transform:({red:t,green:s,blue:n,alpha:a=1})=>"rgba("+gN.transform(t)+", "+gN.transform(s)+", "+gN.transform(n)+", "+Jm(Mp.transform(a))+")"};function dre(t){let s="",n="",a="",i="";return t.length>5?(s=t.substring(1,3),n=t.substring(3,5),a=t.substring(5,7),i=t.substring(7,9)):(s=t.substring(1,2),n=t.substring(2,3),a=t.substring(3,4),i=t.substring(4,5),s+=s,n+=n,a+=a,i+=i),{red:parseInt(s,16),green:parseInt(n,16),blue:parseInt(a,16),alpha:i?parseInt(i,16)/255:1}}const p_={test:O3("#"),parse:dre,transform:Bd.transform},Sx=t=>({test:s=>typeof s=="string"&&s.endsWith(t)&&s.split(" ").length===1,parse:parseFloat,transform:s=>`${s}${t}`}),ac=Sx("deg"),Fl=Sx("%"),Bt=Sx("px"),ure=Sx("vh"),hre=Sx("vw"),w4={...Fl,parse:t=>Fl.parse(t)/100,transform:t=>Fl.transform(t*100)},bh={test:O3("hsl","hue"),parse:L7("hue","saturation","lightness"),transform:({hue:t,saturation:s,lightness:n,alpha:a=1})=>"hsla("+Math.round(t)+", "+Fl.transform(Jm(s))+", "+Fl.transform(Jm(n))+", "+Jm(Mp.transform(a))+")"},Pn={test:t=>Bd.test(t)||p_.test(t)||bh.test(t),parse:t=>Bd.test(t)?Bd.parse(t):bh.test(t)?bh.parse(t):p_.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Bd.transform(t):bh.transform(t),getAnimatableNone:t=>{const s=Pn.parse(t);return s.alpha=0,Pn.transform(s)}},fre=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function mre(t){var s,n;return isNaN(t)&&typeof t=="string"&&(((s=t.match(D3))==null?void 0:s.length)||0)+(((n=t.match(fre))==null?void 0:n.length)||0)>0}const B7="number",F7="color",pre="var",xre="var(",N4="${}",gre=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Dp(t){const s=t.toString(),n=[],a={color:[],number:[],var:[]},i=[];let l=0;const c=s.replace(gre,d=>(Pn.test(d)?(a.color.push(l),i.push(F7),n.push(Pn.parse(d))):d.startsWith(xre)?(a.var.push(l),i.push(pre),n.push(d)):(a.number.push(l),i.push(B7),n.push(parseFloat(d))),++l,N4)).split(N4);return{values:n,split:c,indexes:a,types:i}}function $7(t){return Dp(t).values}function z7(t){const{split:s,types:n}=Dp(t),a=s.length;return i=>{let l="";for(let o=0;o<a;o++)if(l+=s[o],i[o]!==void 0){const c=n[o];c===B7?l+=Jm(i[o]):c===F7?l+=Pn.transform(i[o]):l+=i[o]}return l}}const yre=t=>typeof t=="number"?0:Pn.test(t)?Pn.getAnimatableNone(t):t;function bre(t){const s=$7(t);return z7(t)(s.map(yre))}const zc={test:mre,parse:$7,createTransformer:z7,getAnimatableNone:bre};function yN(t,s,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(s-t)*6*n:n<1/2?s:n<2/3?t+(s-t)*(2/3-n)*6:t}function vre({hue:t,saturation:s,lightness:n,alpha:a}){t/=360,s/=100,n/=100;let i=0,l=0,o=0;if(!s)i=l=o=n;else{const c=n<.5?n*(1+s):n+s-n*s,d=2*n-c;i=yN(d,c,t+1/3),l=yN(d,c,t),o=yN(d,c,t-1/3)}return{red:Math.round(i*255),green:Math.round(l*255),blue:Math.round(o*255),alpha:a}}function Ry(t,s){return n=>n>0?s:t}const tn=(t,s,n)=>t+(s-t)*n,bN=(t,s,n)=>{const a=t*t,i=n*(s*s-a)+a;return i<0?0:Math.sqrt(i)},wre=[p_,Bd,bh],Nre=t=>wre.find(s=>s.test(t));function j4(t){const s=Nre(t);if(!s)return!1;let n=s.parse(t);return s===bh&&(n=vre(n)),n}const _4=(t,s)=>{const n=j4(t),a=j4(s);if(!n||!a)return Ry(t,s);const i={...n};return l=>(i.red=bN(n.red,a.red,l),i.green=bN(n.green,a.green,l),i.blue=bN(n.blue,a.blue,l),i.alpha=tn(n.alpha,a.alpha,l),Bd.transform(i))},x_=new Set(["none","hidden"]);function jre(t,s){return x_.has(t)?n=>n<=0?t:s:n=>n>=1?s:t}function _re(t,s){return n=>tn(t,s,n)}function R3(t){return typeof t=="number"?_re:typeof t=="string"?M3(t)?Ry:Pn.test(t)?_4:kre:Array.isArray(t)?U7:typeof t=="object"?Pn.test(t)?_4:Sre:Ry}function U7(t,s){const n=[...t],a=n.length,i=t.map((l,o)=>R3(l)(l,s[o]));return l=>{for(let o=0;o<a;o++)n[o]=i[o](l);return n}}function Sre(t,s){const n={...t,...s},a={};for(const i in n)t[i]!==void 0&&s[i]!==void 0&&(a[i]=R3(t[i])(t[i],s[i]));return i=>{for(const l in a)n[l]=a[l](i);return n}}function Cre(t,s){const n=[],a={color:0,var:0,number:0};for(let i=0;i<s.values.length;i++){const l=s.types[i],o=t.indexes[l][a[l]],c=t.values[o]??0;n[i]=c,a[l]++}return n}const kre=(t,s)=>{const n=zc.createTransformer(s),a=Dp(t),i=Dp(s);return a.indexes.var.length===i.indexes.var.length&&a.indexes.color.length===i.indexes.color.length&&a.indexes.number.length>=i.indexes.number.length?x_.has(t)&&!i.values.length||x_.has(s)&&!a.values.length?jre(t,s):jx(U7(Cre(a,i),i.values),n):Ry(t,s)};function V7(t,s,n){return typeof t=="number"&&typeof s=="number"&&typeof n=="number"?tn(t,s,n):R3(t)(t,s)}const Are=t=>{const s=({timestamp:n})=>t(n);return{start:(n=!0)=>Gs.update(s,n),stop:()=>$c(s),now:()=>Cr.isProcessing?Cr.timestamp:ya.now()}},H7=(t,s,n=10)=>{let a="";const i=Math.max(Math.round(s/n),2);for(let l=0;l<i;l++)a+=Math.round(t(l/(i-1))*1e4)/1e4+", ";return`linear(${a.substring(0,a.length-2)})`},Ly=2e4;function L3(t){let s=0;const n=50;let a=t.next(s);for(;!a.done&&s<Ly;)s+=n,a=t.next(s);return s>=Ly?1/0:s}function Ere(t,s=100,n){const a=n({...t,keyframes:[0,s]}),i=Math.min(L3(a),Ly);return{type:"keyframes",ease:l=>a.next(i*l).value/s,duration:Ni(i)}}const Tre=5;function W7(t,s,n){const a=Math.max(s-Tre,0);return _7(n-t(a),s-a)}const fn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},vN=.001;function Pre({duration:t=fn.duration,bounce:s=fn.bounce,velocity:n=fn.velocity,mass:a=fn.mass}){let i,l,o=1-s;o=Co(fn.minDamping,fn.maxDamping,o),t=Co(fn.minDuration,fn.maxDuration,Ni(t)),o<1?(i=u=>{const f=u*o,m=f*t,x=f-n,b=g_(u,o),w=Math.exp(-m);return vN-x/b*w},l=u=>{const m=u*o*t,x=m*n+n,b=Math.pow(o,2)*Math.pow(u,2)*t,w=Math.exp(-m),j=g_(Math.pow(u,2),o);return(-i(u)+vN>0?-1:1)*((x-b)*w)/j}):(i=u=>{const f=Math.exp(-u*t),m=(u-n)*t+1;return-vN+f*m},l=u=>{const f=Math.exp(-u*t),m=(n-u)*(t*t);return f*m});const c=5/t,d=Mre(i,l,c);if(t=Bl(t),isNaN(d))return{stiffness:fn.stiffness,damping:fn.damping,duration:t};{const u=Math.pow(d,2)*a;return{stiffness:u,damping:o*2*Math.sqrt(a*u),duration:t}}}const Ire=12;function Mre(t,s,n){let a=n;for(let i=1;i<Ire;i++)a=a-t(a)/s(a);return a}function g_(t,s){return t*Math.sqrt(1-s*s)}const Dre=["duration","bounce"],Ore=["stiffness","damping","mass"];function S4(t,s){return s.some(n=>t[n]!==void 0)}function Rre(t){let s={velocity:fn.velocity,stiffness:fn.stiffness,damping:fn.damping,mass:fn.mass,isResolvedFromDuration:!1,...t};if(!S4(t,Ore)&&S4(t,Dre))if(t.visualDuration){const n=t.visualDuration,a=2*Math.PI/(n*1.2),i=a*a,l=2*Co(.05,1,1-(t.bounce||0))*Math.sqrt(i);s={...s,mass:fn.mass,stiffness:i,damping:l}}else{const n=Pre(t);s={...s,...n,mass:fn.mass},s.isResolvedFromDuration=!0}return s}function By(t=fn.visualDuration,s=fn.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:s}:t;let{restSpeed:a,restDelta:i}=n;const l=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],c={done:!1,value:l},{stiffness:d,damping:u,mass:f,duration:m,velocity:x,isResolvedFromDuration:b}=Rre({...n,velocity:-Ni(n.velocity||0)}),w=x||0,j=u/(2*Math.sqrt(d*f)),_=o-l,C=Ni(Math.sqrt(d/f)),k=Math.abs(_)<5;a||(a=k?fn.restSpeed.granular:fn.restSpeed.default),i||(i=k?fn.restDelta.granular:fn.restDelta.default);let A;if(j<1){const P=g_(C,j);A=R=>{const I=Math.exp(-j*C*R);return o-I*((w+j*C*_)/P*Math.sin(P*R)+_*Math.cos(P*R))}}else if(j===1)A=P=>o-Math.exp(-C*P)*(_+(w+C*_)*P);else{const P=C*Math.sqrt(j*j-1);A=R=>{const I=Math.exp(-j*C*R),O=Math.min(P*R,300);return o-I*((w+j*C*_)*Math.sinh(O)+P*_*Math.cosh(O))/P}}const T={calculatedDuration:b&&m||null,next:P=>{const R=A(P);if(b)c.done=P>=m;else{let I=P===0?w:0;j<1&&(I=P===0?Bl(w):W7(A,P,R));const O=Math.abs(I)<=a,M=Math.abs(o-R)<=i;c.done=O&&M}return c.value=c.done?o:R,c},toString:()=>{const P=Math.min(L3(T),Ly),R=H7(I=>T.next(P*I).value,P,30);return P+"ms "+R},toTransition:()=>{}};return T}By.applyToOptions=t=>{const s=Ere(t,100,By);return t.ease=s.ease,t.duration=Bl(s.duration),t.type="keyframes",t};function y_({keyframes:t,velocity:s=0,power:n=.8,timeConstant:a=325,bounceDamping:i=10,bounceStiffness:l=500,modifyTarget:o,min:c,max:d,restDelta:u=.5,restSpeed:f}){const m=t[0],x={done:!1,value:m},b=O=>c!==void 0&&O<c||d!==void 0&&O>d,w=O=>c===void 0?d:d===void 0||Math.abs(c-O)<Math.abs(d-O)?c:d;let j=n*s;const _=m+j,C=o===void 0?_:o(_);C!==_&&(j=C-m);const k=O=>-j*Math.exp(-O/a),A=O=>C+k(O),T=O=>{const M=k(O),B=A(O);x.done=Math.abs(M)<=u,x.value=x.done?C:B};let P,R;const I=O=>{b(x.value)&&(P=O,R=By({keyframes:[x.value,w(x.value)],velocity:W7(A,O,x.value),damping:i,stiffness:l,restDelta:u,restSpeed:f}))};return I(0),{calculatedDuration:null,next:O=>{let M=!1;return!R&&P===void 0&&(M=!0,T(O),I(O)),P!==void 0&&O>=P?R.next(O-P):(!M&&T(O),x)}}}function Lre(t,s,n){const a=[],i=n||ko.mix||V7,l=t.length-1;for(let o=0;o<l;o++){let c=i(t[o],t[o+1]);if(s){const d=Array.isArray(s)?s[o]||Ci:s;c=jx(d,c)}a.push(c)}return a}function Bre(t,s,{clamp:n=!0,ease:a,mixer:i}={}){const l=t.length;if(k3(l===s.length),l===1)return()=>s[0];if(l===2&&s[0]===s[1])return()=>s[1];const o=t[0]===t[1];t[0]>t[l-1]&&(t=[...t].reverse(),s=[...s].reverse());const c=Lre(s,a,i),d=c.length,u=f=>{if(o&&f<t[0])return s[0];let m=0;if(d>1)for(;m<t.length-2&&!(f<t[m+1]);m++);const x=Ip(t[m],t[m+1],f);return c[m](x)};return n?f=>u(Co(t[0],t[l-1],f)):u}function Fre(t,s){const n=t[t.length-1];for(let a=1;a<=s;a++){const i=Ip(0,s,a);t.push(tn(n,1,i))}}function $re(t){const s=[0];return Fre(s,t.length-1),s}function zre(t,s){return t.map(n=>n*s)}function Ure(t,s){return t.map(()=>s||M7).splice(0,t.length-1)}function ep({duration:t=300,keyframes:s,times:n,ease:a="easeInOut"}){const i=Jne(a)?a.map(v4):v4(a),l={done:!1,value:s[0]},o=zre(n&&n.length===s.length?n:$re(s),t),c=Bre(o,s,{ease:Array.isArray(i)?i:Ure(s,i)});return{calculatedDuration:t,next:d=>(l.value=c(d),l.done=d>=t,l)}}const Vre=t=>t!==null;function B3(t,{repeat:s,repeatType:n="loop"},a,i=1){const l=t.filter(Vre),c=i<0||s&&n!=="loop"&&s%2===1?0:l.length-1;return!c||a===void 0?l[c]:a}const Hre={decay:y_,inertia:y_,tween:ep,keyframes:ep,spring:By};function q7(t){typeof t.type=="string"&&(t.type=Hre[t.type])}class F3{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(s=>{this.resolve=s})}notifyFinished(){this.resolve()}then(s,n){return this.finished.then(s,n)}}const Wre=t=>t/100;class $3 extends F3{constructor(s){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var a,i;const{motionValue:n}=this.options;n&&n.updatedAt!==ya.now()&&this.tick(ya.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(i=(a=this.options).onStop)==null||i.call(a))},this.options=s,this.initAnimation(),this.play(),s.autoplay===!1&&this.pause()}initAnimation(){const{options:s}=this;q7(s);const{type:n=ep,repeat:a=0,repeatDelay:i=0,repeatType:l,velocity:o=0}=s;let{keyframes:c}=s;const d=n||ep;d!==ep&&typeof c[0]!="number"&&(this.mixKeyframes=jx(Wre,V7(c[0],c[1])),c=[0,100]);const u=d({...s,keyframes:c});l==="mirror"&&(this.mirroredGenerator=d({...s,keyframes:[...c].reverse(),velocity:-o})),u.calculatedDuration===null&&(u.calculatedDuration=L3(u));const{calculatedDuration:f}=u;this.calculatedDuration=f,this.resolvedDuration=f+i,this.totalDuration=this.resolvedDuration*(a+1)-i,this.generator=u}updateTime(s){const n=Math.round(s-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(s,n=!1){const{generator:a,totalDuration:i,mixKeyframes:l,mirroredGenerator:o,resolvedDuration:c,calculatedDuration:d}=this;if(this.startTime===null)return a.next(0);const{delay:u=0,keyframes:f,repeat:m,repeatType:x,repeatDelay:b,type:w,onUpdate:j,finalKeyframe:_}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,s):this.speed<0&&(this.startTime=Math.min(s-i/this.speed,this.startTime)),n?this.currentTime=s:this.updateTime(s);const C=this.currentTime-u*(this.playbackSpeed>=0?1:-1),k=this.playbackSpeed>=0?C<0:C>i;this.currentTime=Math.max(C,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let A=this.currentTime,T=a;if(m){const O=Math.min(this.currentTime,i)/c;let M=Math.floor(O),B=O%1;!B&&O>=1&&(B=1),B===1&&M--,M=Math.min(M,m+1),!!(M%2)&&(x==="reverse"?(B=1-B,b&&(B-=b/c)):x==="mirror"&&(T=o)),A=Co(0,1,B)*c}const P=k?{done:!1,value:f[0]}:T.next(A);l&&(P.value=l(P.value));let{done:R}=P;!k&&d!==null&&(R=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const I=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&R);return I&&w!==y_&&(P.value=B3(f,this.options,_,this.speed)),j&&j(P.value),I&&this.finish(),P}then(s,n){return this.finished.then(s,n)}get duration(){return Ni(this.calculatedDuration)}get iterationDuration(){const{delay:s=0}=this.options||{};return this.duration+Ni(s)}get time(){return Ni(this.currentTime)}set time(s){var n;s=Bl(s),this.currentTime=s,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=s:this.driver&&(this.startTime=this.driver.now()-s/this.playbackSpeed),(n=this.driver)==null||n.start(!1)}get speed(){return this.playbackSpeed}set speed(s){this.updateTime(ya.now());const n=this.playbackSpeed!==s;this.playbackSpeed=s,n&&(this.time=Ni(this.currentTime))}play(){var i,l;if(this.isStopped)return;const{driver:s=Are,startTime:n}=this.options;this.driver||(this.driver=s(o=>this.tick(o))),(l=(i=this.options).onPlay)==null||l.call(i);const a=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=a):this.holdTime!==null?this.startTime=a-this.holdTime:this.startTime||(this.startTime=n??a),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ya.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var s,n;this.notifyFinished(),this.teardown(),this.state="finished",(n=(s=this.options).onComplete)==null||n.call(s)}cancel(){var s,n;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(n=(s=this.options).onCancel)==null||n.call(s)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(s){return this.startTime=0,this.tick(s,!0)}attachTimeline(s){var n;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(n=this.driver)==null||n.stop(),s.observe(this)}}function qre(t){for(let s=1;s<t.length;s++)t[s]??(t[s]=t[s-1])}const Fd=t=>t*180/Math.PI,b_=t=>{const s=Fd(Math.atan2(t[1],t[0]));return v_(s)},Gre={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:b_,rotateZ:b_,skewX:t=>Fd(Math.atan(t[1])),skewY:t=>Fd(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},v_=t=>(t=t%360,t<0&&(t+=360),t),C4=b_,k4=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),A4=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),Kre={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:k4,scaleY:A4,scale:t=>(k4(t)+A4(t))/2,rotateX:t=>v_(Fd(Math.atan2(t[6],t[5]))),rotateY:t=>v_(Fd(Math.atan2(-t[2],t[0]))),rotateZ:C4,rotate:C4,skewX:t=>Fd(Math.atan(t[4])),skewY:t=>Fd(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function w_(t){return t.includes("scale")?1:0}function N_(t,s){if(!t||t==="none")return w_(s);const n=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let a,i;if(n)a=Kre,i=n;else{const c=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);a=Gre,i=c}if(!i)return w_(s);const l=a[s],o=i[1].split(",").map(Xre);return typeof l=="function"?l(o):o[l]}const Yre=(t,s)=>{const{transform:n="none"}=getComputedStyle(t);return N_(n,s)};function Xre(t){return parseFloat(t.trim())}const kf=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Af=new Set(kf),E4=t=>t===Cf||t===Bt,Qre=new Set(["x","y","z"]),Zre=kf.filter(t=>!Qre.has(t));function Jre(t){const s=[];return Zre.forEach(n=>{const a=t.getValue(n);a!==void 0&&(s.push([n,a.get()]),a.set(n.startsWith("scale")?1:0))}),s}const Yd={width:({x:t},{paddingLeft:s="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(s)-parseFloat(n),height:({y:t},{paddingTop:s="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(s)-parseFloat(n),top:(t,{top:s})=>parseFloat(s),left:(t,{left:s})=>parseFloat(s),bottom:({y:t},{top:s})=>parseFloat(s)+(t.max-t.min),right:({x:t},{left:s})=>parseFloat(s)+(t.max-t.min),x:(t,{transform:s})=>N_(s,"x"),y:(t,{transform:s})=>N_(s,"y")};Yd.translateX=Yd.x;Yd.translateY=Yd.y;const Xd=new Set;let j_=!1,__=!1,S_=!1;function G7(){if(__){const t=Array.from(Xd).filter(a=>a.needsMeasurement),s=new Set(t.map(a=>a.element)),n=new Map;s.forEach(a=>{const i=Jre(a);i.length&&(n.set(a,i),a.render())}),t.forEach(a=>a.measureInitialState()),s.forEach(a=>{a.render();const i=n.get(a);i&&i.forEach(([l,o])=>{var c;(c=a.getValue(l))==null||c.set(o)})}),t.forEach(a=>a.measureEndState()),t.forEach(a=>{a.suspendedScrollY!==void 0&&window.scrollTo(0,a.suspendedScrollY)})}__=!1,j_=!1,Xd.forEach(t=>t.complete(S_)),Xd.clear()}function K7(){Xd.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(__=!0)})}function eae(){S_=!0,K7(),G7(),S_=!1}class z3{constructor(s,n,a,i,l,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...s],this.onComplete=n,this.name=a,this.motionValue=i,this.element=l,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(Xd.add(this),j_||(j_=!0,Gs.read(K7),Gs.resolveKeyframes(G7))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:s,name:n,element:a,motionValue:i}=this;if(s[0]===null){const l=i==null?void 0:i.get(),o=s[s.length-1];if(l!==void 0)s[0]=l;else if(a&&n){const c=a.readValue(n,o);c!=null&&(s[0]=c)}s[0]===void 0&&(s[0]=o),i&&l===void 0&&i.set(s[0])}qre(s)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(s=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,s),Xd.delete(this)}cancel(){this.state==="scheduled"&&(Xd.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const tae=t=>t.startsWith("--");function sae(t,s,n){tae(s)?t.style.setProperty(s,n):t.style[s]=n}const nae=A3(()=>window.ScrollTimeline!==void 0),rae={};function aae(t,s){const n=A3(t);return()=>rae[s]??n()}const Y7=aae(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Lm=([t,s,n,a])=>`cubic-bezier(${t}, ${s}, ${n}, ${a})`,T4={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Lm([0,.65,.55,1]),circOut:Lm([.55,0,1,.45]),backIn:Lm([.31,.01,.66,-.59]),backOut:Lm([.33,1.53,.69,.99])};function X7(t,s){if(t)return typeof t=="function"?Y7()?H7(t,s):"ease-out":D7(t)?Lm(t):Array.isArray(t)?t.map(n=>X7(n,s)||T4.easeOut):T4[t]}function iae(t,s,n,{delay:a=0,duration:i=300,repeat:l=0,repeatType:o="loop",ease:c="easeOut",times:d}={},u=void 0){const f={[s]:n};d&&(f.offset=d);const m=X7(c,i);Array.isArray(m)&&(f.easing=m);const x={delay:a,duration:i,easing:Array.isArray(m)?"linear":m,fill:"both",iterations:l+1,direction:o==="reverse"?"alternate":"normal"};return u&&(x.pseudoElement=u),t.animate(f,x)}function Q7(t){return typeof t=="function"&&"applyToOptions"in t}function lae({type:t,...s}){return Q7(t)&&Y7()?t.applyToOptions(s):(s.duration??(s.duration=300),s.ease??(s.ease="easeOut"),s)}class oae extends F3{constructor(s){if(super(),this.finishedTime=null,this.isStopped=!1,!s)return;const{element:n,name:a,keyframes:i,pseudoElement:l,allowFlatten:o=!1,finalKeyframe:c,onComplete:d}=s;this.isPseudoElement=!!l,this.allowFlatten=o,this.options=s,k3(typeof s.type!="string");const u=lae(s);this.animation=iae(n,a,i,u,l),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!l){const f=B3(i,this.options,c,this.speed);this.updateMotionValue?this.updateMotionValue(f):sae(n,a,f),this.animation.cancel()}d==null||d(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var s,n;(n=(s=this.animation).finish)==null||n.call(s)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:s}=this;s==="idle"||s==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var s,n;this.isPseudoElement||(n=(s=this.animation).commitStyles)==null||n.call(s)}get duration(){var n,a;const s=((a=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:a.call(n).duration)||0;return Ni(Number(s))}get iterationDuration(){const{delay:s=0}=this.options||{};return this.duration+Ni(s)}get time(){return Ni(Number(this.animation.currentTime)||0)}set time(s){this.finishedTime=null,this.animation.currentTime=Bl(s)}get speed(){return this.animation.playbackRate}set speed(s){s<0&&(this.finishedTime=null),this.animation.playbackRate=s}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(s){this.animation.startTime=s}attachTimeline({timeline:s,observe:n}){var a;return this.allowFlatten&&((a=this.animation.effect)==null||a.updateTiming({easing:"linear"})),this.animation.onfinish=null,s&&nae()?(this.animation.timeline=s,Ci):n(this)}}const Z7={anticipate:T7,backInOut:E7,circInOut:I7};function cae(t){return t in Z7}function dae(t){typeof t.ease=="string"&&cae(t.ease)&&(t.ease=Z7[t.ease])}const P4=10;class uae extends oae{constructor(s){dae(s),q7(s),super(s),s.startTime&&(this.startTime=s.startTime),this.options=s}updateMotionValue(s){const{motionValue:n,onUpdate:a,onComplete:i,element:l,...o}=this.options;if(!n)return;if(s!==void 0){n.set(s);return}const c=new $3({...o,autoplay:!1}),d=Bl(this.finishedTime??this.time);n.setWithVelocity(c.sample(d-P4).value,c.sample(d).value,P4),c.stop()}}const I4=(t,s)=>s==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(zc.test(t)||t==="0")&&!t.startsWith("url("));function hae(t){const s=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==s)return!0}function fae(t,s,n,a){const i=t[0];if(i===null)return!1;if(s==="display"||s==="visibility")return!0;const l=t[t.length-1],o=I4(i,s),c=I4(l,s);return!o||!c?!1:hae(t)||(n==="spring"||Q7(n))&&a}function C_(t){t.duration=0,t.type="keyframes"}const mae=new Set(["opacity","clipPath","filter","transform"]),pae=A3(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function xae(t){var f;const{motionValue:s,name:n,repeatDelay:a,repeatType:i,damping:l,type:o}=t;if(!(((f=s==null?void 0:s.owner)==null?void 0:f.current)instanceof HTMLElement))return!1;const{onUpdate:d,transformTemplate:u}=s.owner.getProps();return pae()&&n&&mae.has(n)&&(n!=="transform"||!u)&&!d&&!a&&i!=="mirror"&&l!==0&&o!=="inertia"}const gae=40;class yae extends F3{constructor({autoplay:s=!0,delay:n=0,type:a="keyframes",repeat:i=0,repeatDelay:l=0,repeatType:o="loop",keyframes:c,name:d,motionValue:u,element:f,...m}){var w;super(),this.stop=()=>{var j,_;this._animation&&(this._animation.stop(),(j=this.stopTimeline)==null||j.call(this)),(_=this.keyframeResolver)==null||_.cancel()},this.createdAt=ya.now();const x={autoplay:s,delay:n,type:a,repeat:i,repeatDelay:l,repeatType:o,name:d,motionValue:u,element:f,...m},b=(f==null?void 0:f.KeyframeResolver)||z3;this.keyframeResolver=new b(c,(j,_,C)=>this.onKeyframesResolved(j,_,x,!C),d,u,f),(w=this.keyframeResolver)==null||w.scheduleResolve()}onKeyframesResolved(s,n,a,i){this.keyframeResolver=void 0;const{name:l,type:o,velocity:c,delay:d,isHandoff:u,onUpdate:f}=a;this.resolvedAt=ya.now(),fae(s,l,o,c)||((ko.instantAnimations||!d)&&(f==null||f(B3(s,a,n))),s[0]=s[s.length-1],C_(a),a.repeat=0);const x={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>gae?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...a,keyframes:s},b=!u&&xae(x)?new uae({...x,element:x.motionValue.owner.current}):new $3(x);b.finished.then(()=>this.notifyFinished()).catch(Ci),this.pendingTimeline&&(this.stopTimeline=b.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=b}get finished(){return this._animation?this.animation.finished:this._finished}then(s,n){return this.finished.finally(s).then(()=>{})}get animation(){var s;return this._animation||((s=this.keyframeResolver)==null||s.resume(),eae()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(s){this.animation.time=s}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(s){this.animation.speed=s}get startTime(){return this.animation.startTime}attachTimeline(s){return this._animation?this.stopTimeline=this.animation.attachTimeline(s):this.pendingTimeline=s,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var s;this._animation&&this.animation.cancel(),(s=this.keyframeResolver)==null||s.cancel()}}const bae=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function vae(t){const s=bae.exec(t);if(!s)return[,];const[,n,a,i]=s;return[`--${n??a}`,i]}function J7(t,s,n=1){const[a,i]=vae(t);if(!a)return;const l=window.getComputedStyle(s).getPropertyValue(a);if(l){const o=l.trim();return w7(o)?parseFloat(o):o}return M3(i)?J7(i,s,n+1):i}function U3(t,s){return(t==null?void 0:t[s])??(t==null?void 0:t.default)??t}const e9=new Set(["width","height","top","left","right","bottom",...kf]),wae={test:t=>t==="auto",parse:t=>t},t9=t=>s=>s.test(t),s9=[Cf,Bt,Fl,ac,hre,ure,wae],M4=t=>s9.find(t9(t));function Nae(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||j7(t):!0}const jae=new Set(["brightness","contrast","saturate","opacity"]);function _ae(t){const[s,n]=t.slice(0,-1).split("(");if(s==="drop-shadow")return t;const[a]=n.match(D3)||[];if(!a)return t;const i=n.replace(a,"");let l=jae.has(s)?1:0;return a!==n&&(l*=100),s+"("+l+i+")"}const Sae=/\b([a-z-]*)\(.*?\)/gu,k_={...zc,getAnimatableNone:t=>{const s=t.match(Sae);return s?s.map(_ae).join(" "):t}},D4={...Cf,transform:Math.round},Cae={rotate:ac,rotateX:ac,rotateY:ac,rotateZ:ac,scale:S0,scaleX:S0,scaleY:S0,scaleZ:S0,skew:ac,skewX:ac,skewY:ac,distance:Bt,translateX:Bt,translateY:Bt,translateZ:Bt,x:Bt,y:Bt,z:Bt,perspective:Bt,transformPerspective:Bt,opacity:Mp,originX:w4,originY:w4,originZ:Bt},V3={borderWidth:Bt,borderTopWidth:Bt,borderRightWidth:Bt,borderBottomWidth:Bt,borderLeftWidth:Bt,borderRadius:Bt,radius:Bt,borderTopLeftRadius:Bt,borderTopRightRadius:Bt,borderBottomRightRadius:Bt,borderBottomLeftRadius:Bt,width:Bt,maxWidth:Bt,height:Bt,maxHeight:Bt,top:Bt,right:Bt,bottom:Bt,left:Bt,padding:Bt,paddingTop:Bt,paddingRight:Bt,paddingBottom:Bt,paddingLeft:Bt,margin:Bt,marginTop:Bt,marginRight:Bt,marginBottom:Bt,marginLeft:Bt,backgroundPositionX:Bt,backgroundPositionY:Bt,...Cae,zIndex:D4,fillOpacity:Mp,strokeOpacity:Mp,numOctaves:D4},kae={...V3,color:Pn,backgroundColor:Pn,outlineColor:Pn,fill:Pn,stroke:Pn,borderColor:Pn,borderTopColor:Pn,borderRightColor:Pn,borderBottomColor:Pn,borderLeftColor:Pn,filter:k_,WebkitFilter:k_},n9=t=>kae[t];function r9(t,s){let n=n9(t);return n!==k_&&(n=zc),n.getAnimatableNone?n.getAnimatableNone(s):void 0}const Aae=new Set(["auto","none","0"]);function Eae(t,s,n){let a=0,i;for(;a<t.length&&!i;){const l=t[a];typeof l=="string"&&!Aae.has(l)&&Dp(l).values.length&&(i=t[a]),a++}if(i&&n)for(const l of s)t[l]=r9(n,i)}class Tae extends z3{constructor(s,n,a,i,l){super(s,n,a,i,l,!0)}readKeyframes(){const{unresolvedKeyframes:s,element:n,name:a}=this;if(!n||!n.current)return;super.readKeyframes();for(let d=0;d<s.length;d++){let u=s[d];if(typeof u=="string"&&(u=u.trim(),M3(u))){const f=J7(u,n.current);f!==void 0&&(s[d]=f),d===s.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!e9.has(a)||s.length!==2)return;const[i,l]=s,o=M4(i),c=M4(l);if(o!==c)if(E4(o)&&E4(c))for(let d=0;d<s.length;d++){const u=s[d];typeof u=="string"&&(s[d]=parseFloat(u))}else Yd[a]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:s,name:n}=this,a=[];for(let i=0;i<s.length;i++)(s[i]===null||Nae(s[i]))&&a.push(i);a.length&&Eae(s,a,n)}measureInitialState(){const{element:s,unresolvedKeyframes:n,name:a}=this;if(!s||!s.current)return;a==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Yd[a](s.measureViewportBox(),window.getComputedStyle(s.current)),n[0]=this.measuredOrigin;const i=n[n.length-1];i!==void 0&&s.getValue(a,i).jump(i,!1)}measureEndState(){var c;const{element:s,name:n,unresolvedKeyframes:a}=this;if(!s||!s.current)return;const i=s.getValue(n);i&&i.jump(this.measuredOrigin,!1);const l=a.length-1,o=a[l];a[l]=Yd[n](s.measureViewportBox(),window.getComputedStyle(s.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(c=this.removedTransforms)!=null&&c.length&&this.removedTransforms.forEach(([d,u])=>{s.getValue(d).set(u)}),this.resolveNoneKeyframes()}}function Pae(t,s,n){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let a=document;const i=(n==null?void 0:n[t])??a.querySelectorAll(t);return i?Array.from(i):[]}return Array.from(t)}const a9=(t,s)=>s&&typeof t=="number"?s.transform(t):t;function i9(t){return N7(t)&&"offsetHeight"in t}const O4=30,Iae=t=>!isNaN(parseFloat(t));class Mae{constructor(s,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=a=>{var l;const i=ya.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(a),this.current!==this.prev&&((l=this.events.change)==null||l.notify(this.current),this.dependents))for(const o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(s),this.owner=n.owner}setCurrent(s){this.current=s,this.updatedAt=ya.now(),this.canTrackVelocity===null&&s!==void 0&&(this.canTrackVelocity=Iae(this.current))}setPrevFrameValue(s=this.current){this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt}onChange(s){return this.on("change",s)}on(s,n){this.events[s]||(this.events[s]=new E3);const a=this.events[s].add(n);return s==="change"?()=>{a(),Gs.read(()=>{this.events.change.getSize()||this.stop()})}:a}clearListeners(){for(const s in this.events)this.events[s].clear()}attach(s,n){this.passiveEffect=s,this.stopPassiveEffect=n}set(s){this.passiveEffect?this.passiveEffect(s,this.updateAndNotify):this.updateAndNotify(s)}setWithVelocity(s,n,a){this.set(n),this.prev=void 0,this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt-a}jump(s,n=!0){this.updateAndNotify(s),this.prev=s,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var s;(s=this.events.change)==null||s.notify(this.current)}addDependent(s){this.dependents||(this.dependents=new Set),this.dependents.add(s)}removeDependent(s){this.dependents&&this.dependents.delete(s)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const s=ya.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||s-this.updatedAt>O4)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,O4);return _7(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(s){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=s(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var s,n;(s=this.dependents)==null||s.clear(),(n=this.events.destroy)==null||n.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Jh(t,s){return new Mae(t,s)}const{schedule:H3}=O7(queueMicrotask,!1),Vi={x:!1,y:!1};function l9(){return Vi.x||Vi.y}function Dae(t){return t==="x"||t==="y"?Vi[t]?null:(Vi[t]=!0,()=>{Vi[t]=!1}):Vi.x||Vi.y?null:(Vi.x=Vi.y=!0,()=>{Vi.x=Vi.y=!1})}function o9(t,s){const n=Pae(t),a=new AbortController,i={passive:!0,...s,signal:a.signal};return[n,i,()=>a.abort()]}function R4(t){return!(t.pointerType==="touch"||l9())}function Oae(t,s,n={}){const[a,i,l]=o9(t,n),o=c=>{if(!R4(c))return;const{target:d}=c,u=s(d,c);if(typeof u!="function"||!d)return;const f=m=>{R4(m)&&(u(m),d.removeEventListener("pointerleave",f))};d.addEventListener("pointerleave",f,i)};return a.forEach(c=>{c.addEventListener("pointerenter",o,i)}),l}const c9=(t,s)=>s?t===s?!0:c9(t,s.parentElement):!1,W3=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,Rae=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Lae(t){return Rae.has(t.tagName)||t.tabIndex!==-1}const Lg=new WeakSet;function L4(t){return s=>{s.key==="Enter"&&t(s)}}function wN(t,s){t.dispatchEvent(new PointerEvent("pointer"+s,{isPrimary:!0,bubbles:!0}))}const Bae=(t,s)=>{const n=t.currentTarget;if(!n)return;const a=L4(()=>{if(Lg.has(n))return;wN(n,"down");const i=L4(()=>{wN(n,"up")}),l=()=>wN(n,"cancel");n.addEventListener("keyup",i,s),n.addEventListener("blur",l,s)});n.addEventListener("keydown",a,s),n.addEventListener("blur",()=>n.removeEventListener("keydown",a),s)};function B4(t){return W3(t)&&!l9()}function Fae(t,s,n={}){const[a,i,l]=o9(t,n),o=c=>{const d=c.currentTarget;if(!B4(c))return;Lg.add(d);const u=s(d,c),f=(b,w)=>{window.removeEventListener("pointerup",m),window.removeEventListener("pointercancel",x),Lg.has(d)&&Lg.delete(d),B4(b)&&typeof u=="function"&&u(b,{success:w})},m=b=>{f(b,d===window||d===document||n.useGlobalTarget||c9(d,b.target))},x=b=>{f(b,!1)};window.addEventListener("pointerup",m,i),window.addEventListener("pointercancel",x,i)};return a.forEach(c=>{(n.useGlobalTarget?window:c).addEventListener("pointerdown",o,i),i9(c)&&(c.addEventListener("focus",u=>Bae(u,i)),!Lae(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),l}function d9(t){return N7(t)&&"ownerSVGElement"in t}function $ae(t){return d9(t)&&t.tagName==="svg"}const Fr=t=>!!(t&&t.getVelocity),zae=[...s9,Pn,zc],Uae=t=>zae.find(t9(t)),q3=y.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function F4(t,s){if(typeof t=="function")return t(s);t!=null&&(t.current=s)}function Vae(...t){return s=>{let n=!1;const a=t.map(i=>{const l=F4(i,s);return!n&&typeof l=="function"&&(n=!0),l});if(n)return()=>{for(let i=0;i<a.length;i++){const l=a[i];typeof l=="function"?l():F4(t[i],null)}}}}function Hae(...t){return y.useCallback(Vae(...t),t)}class Wae extends y.Component{getSnapshotBeforeUpdate(s){const n=this.props.childRef.current;if(n&&s.isPresent&&!this.props.isPresent){const a=n.offsetParent,i=i9(a)&&a.offsetWidth||0,l=this.props.sizeRef.current;l.height=n.offsetHeight||0,l.width=n.offsetWidth||0,l.top=n.offsetTop,l.left=n.offsetLeft,l.right=i-l.width-l.left}return null}componentDidUpdate(){}render(){return this.props.children}}function qae({children:t,isPresent:s,anchorX:n,root:a}){const i=y.useId(),l=y.useRef(null),o=y.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=y.useContext(q3),d=Hae(l,t==null?void 0:t.ref);return y.useInsertionEffect(()=>{const{width:u,height:f,top:m,left:x,right:b}=o.current;if(s||!l.current||!u||!f)return;const w=n==="left"?`left: ${x}`:`right: ${b}`;l.current.dataset.motionPopId=i;const j=document.createElement("style");c&&(j.nonce=c);const _=a??document.head;return _.appendChild(j),j.sheet&&j.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${u}px !important;
            height: ${f}px !important;
            ${w}px !important;
            top: ${m}px !important;
          }
        `),()=>{_.contains(j)&&_.removeChild(j)}},[s]),r.jsx(Wae,{isPresent:s,childRef:l,sizeRef:o,children:y.cloneElement(t,{ref:d})})}const Gae=({children:t,initial:s,isPresent:n,onExitComplete:a,custom:i,presenceAffectsLayout:l,mode:o,anchorX:c,root:d})=>{const u=j3(Kae),f=y.useId();let m=!0,x=y.useMemo(()=>(m=!1,{id:f,initial:s,isPresent:n,custom:i,onExitComplete:b=>{u.set(b,!0);for(const w of u.values())if(!w)return;a&&a()},register:b=>(u.set(b,!1),()=>u.delete(b))}),[n,u,a]);return l&&m&&(x={...x}),y.useMemo(()=>{u.forEach((b,w)=>u.set(w,!1))},[n]),y.useEffect(()=>{!n&&!u.size&&a&&a()},[n]),o==="popLayout"&&(t=r.jsx(qae,{isPresent:n,anchorX:c,root:d,children:t})),r.jsx(Ib.Provider,{value:x,children:t})};function Kae(){return new Map}function u9(t=!0){const s=y.useContext(Ib);if(s===null)return[!0,null];const{isPresent:n,onExitComplete:a,register:i}=s,l=y.useId();y.useEffect(()=>{if(t)return i(l)},[t]);const o=y.useCallback(()=>t&&a&&a(l),[l,a,t]);return!n&&a?[!1,o]:[!0]}const C0=t=>t.key||"";function $4(t){const s=[];return y.Children.forEach(t,n=>{y.isValidElement(n)&&s.push(n)}),s}const Uc=({children:t,custom:s,initial:n=!0,onExitComplete:a,presenceAffectsLayout:i=!0,mode:l="sync",propagate:o=!1,anchorX:c="left",root:d})=>{const[u,f]=u9(o),m=y.useMemo(()=>$4(t),[t]),x=o&&!u?[]:m.map(C0),b=y.useRef(!0),w=y.useRef(m),j=j3(()=>new Map),[_,C]=y.useState(m),[k,A]=y.useState(m);v7(()=>{b.current=!1,w.current=m;for(let R=0;R<k.length;R++){const I=C0(k[R]);x.includes(I)?j.delete(I):j.get(I)!==!0&&j.set(I,!1)}},[k,x.length,x.join("-")]);const T=[];if(m!==_){let R=[...m];for(let I=0;I<k.length;I++){const O=k[I],M=C0(O);x.includes(M)||(R.splice(I,0,O),T.push(O))}return l==="wait"&&T.length&&(R=T),A($4(R)),C(m),null}const{forceRender:P}=y.useContext(N3);return r.jsx(r.Fragment,{children:k.map(R=>{const I=C0(R),O=o&&!u?!1:m===k||x.includes(I),M=()=>{if(j.has(I))j.set(I,!0);else return;let B=!0;j.forEach(L=>{L||(B=!1)}),B&&(P==null||P(),A(w.current),o&&(f==null||f()),a&&a())};return r.jsx(Gae,{isPresent:O,initial:!b.current||n?void 0:!1,custom:s,presenceAffectsLayout:i,mode:l,root:d,onExitComplete:O?void 0:M,anchorX:c,children:R},I)})})},h9=y.createContext({strict:!1}),z4={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},ef={};for(const t in z4)ef[t]={isEnabled:s=>z4[t].some(n=>!!s[n])};function Yae(t){for(const s in t)ef[s]={...ef[s],...t[s]}}const Xae=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Fy(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||Xae.has(t)}let f9=t=>!Fy(t);function Qae(t){typeof t=="function"&&(f9=s=>s.startsWith("on")?!Fy(s):t(s))}try{Qae(require("@emotion/is-prop-valid").default)}catch{}function Zae(t,s,n){const a={};for(const i in t)i==="values"&&typeof t.values=="object"||(f9(i)||n===!0&&Fy(i)||!s&&!Fy(i)||t.draggable&&i.startsWith("onDrag"))&&(a[i]=t[i]);return a}const Mb=y.createContext({});function Db(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function Op(t){return typeof t=="string"||Array.isArray(t)}const G3=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],K3=["initial",...G3];function Ob(t){return Db(t.animate)||K3.some(s=>Op(t[s]))}function m9(t){return!!(Ob(t)||t.variants)}function Jae(t,s){if(Ob(t)){const{initial:n,animate:a}=t;return{initial:n===!1||Op(n)?n:void 0,animate:Op(a)?a:void 0}}return t.inherit!==!1?s:{}}function eie(t){const{initial:s,animate:n}=Jae(t,y.useContext(Mb));return y.useMemo(()=>({initial:s,animate:n}),[U4(s),U4(n)])}function U4(t){return Array.isArray(t)?t.join(" "):t}const Rp={};function tie(t){for(const s in t)Rp[s]=t[s],I3(s)&&(Rp[s].isCSSVariable=!0)}function p9(t,{layout:s,layoutId:n}){return Af.has(t)||t.startsWith("origin")||(s||n!==void 0)&&(!!Rp[t]||t==="opacity")}const sie={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},nie=kf.length;function rie(t,s,n){let a="",i=!0;for(let l=0;l<nie;l++){const o=kf[l],c=t[o];if(c===void 0)continue;let d=!0;if(typeof c=="number"?d=c===(o.startsWith("scale")?1:0):d=parseFloat(c)===0,!d||n){const u=a9(c,V3[o]);if(!d){i=!1;const f=sie[o]||o;a+=`${f}(${u}) `}n&&(s[o]=u)}}return a=a.trim(),n?a=n(s,i?"":a):i&&(a="none"),a}function Y3(t,s,n){const{style:a,vars:i,transformOrigin:l}=t;let o=!1,c=!1;for(const d in s){const u=s[d];if(Af.has(d)){o=!0;continue}else if(I3(d)){i[d]=u;continue}else{const f=a9(u,V3[d]);d.startsWith("origin")?(c=!0,l[d]=f):a[d]=f}}if(s.transform||(o||n?a.transform=rie(s,t.transform,n):a.transform&&(a.transform="none")),c){const{originX:d="50%",originY:u="50%",originZ:f=0}=l;a.transformOrigin=`${d} ${u} ${f}`}}const X3=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function x9(t,s,n){for(const a in s)!Fr(s[a])&&!p9(a,n)&&(t[a]=s[a])}function aie({transformTemplate:t},s){return y.useMemo(()=>{const n=X3();return Y3(n,s,t),Object.assign({},n.vars,n.style)},[s])}function iie(t,s){const n=t.style||{},a={};return x9(a,n,t),Object.assign(a,aie(t,s)),a}function lie(t,s){const n={},a=iie(t,s);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=a,n}const oie={offset:"stroke-dashoffset",array:"stroke-dasharray"},cie={offset:"strokeDashoffset",array:"strokeDasharray"};function die(t,s,n=1,a=0,i=!0){t.pathLength=1;const l=i?oie:cie;t[l.offset]=Bt.transform(-a);const o=Bt.transform(s),c=Bt.transform(n);t[l.array]=`${o} ${c}`}function g9(t,{attrX:s,attrY:n,attrScale:a,pathLength:i,pathSpacing:l=1,pathOffset:o=0,...c},d,u,f){if(Y3(t,c,u),d){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:m,style:x}=t;m.transform&&(x.transform=m.transform,delete m.transform),(x.transform||m.transformOrigin)&&(x.transformOrigin=m.transformOrigin??"50% 50%",delete m.transformOrigin),x.transform&&(x.transformBox=(f==null?void 0:f.transformBox)??"fill-box",delete m.transformBox),s!==void 0&&(m.x=s),n!==void 0&&(m.y=n),a!==void 0&&(m.scale=a),i!==void 0&&die(m,i,l,o,!1)}const y9=()=>({...X3(),attrs:{}}),b9=t=>typeof t=="string"&&t.toLowerCase()==="svg";function uie(t,s,n,a){const i=y.useMemo(()=>{const l=y9();return g9(l,s,b9(a),t.transformTemplate,t.style),{...l.attrs,style:{...l.style}}},[s]);if(t.style){const l={};x9(l,t.style,t),i.style={...l,...i.style}}return i}const hie=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Q3(t){return typeof t!="string"||t.includes("-")?!1:!!(hie.indexOf(t)>-1||/[A-Z]/u.test(t))}function fie(t,s,n,{latestValues:a},i,l=!1){const c=(Q3(t)?uie:lie)(s,a,i,t),d=Zae(s,typeof t=="string",l),u=t!==y.Fragment?{...d,...c,ref:n}:{},{children:f}=s,m=y.useMemo(()=>Fr(f)?f.get():f,[f]);return y.createElement(t,{...u,children:m})}function V4(t){const s=[{},{}];return t==null||t.values.forEach((n,a)=>{s[0][a]=n.get(),s[1][a]=n.getVelocity()}),s}function Z3(t,s,n,a){if(typeof s=="function"){const[i,l]=V4(a);s=s(n!==void 0?n:t.custom,i,l)}if(typeof s=="string"&&(s=t.variants&&t.variants[s]),typeof s=="function"){const[i,l]=V4(a);s=s(n!==void 0?n:t.custom,i,l)}return s}function Bg(t){return Fr(t)?t.get():t}function mie({scrapeMotionValuesFromProps:t,createRenderState:s},n,a,i){return{latestValues:pie(n,a,i,t),renderState:s()}}function pie(t,s,n,a){const i={},l=a(t,{});for(const x in l)i[x]=Bg(l[x]);let{initial:o,animate:c}=t;const d=Ob(t),u=m9(t);s&&u&&!d&&t.inherit!==!1&&(o===void 0&&(o=s.initial),c===void 0&&(c=s.animate));let f=n?n.initial===!1:!1;f=f||o===!1;const m=f?c:o;if(m&&typeof m!="boolean"&&!Db(m)){const x=Array.isArray(m)?m:[m];for(let b=0;b<x.length;b++){const w=Z3(t,x[b]);if(w){const{transitionEnd:j,transition:_,...C}=w;for(const k in C){let A=C[k];if(Array.isArray(A)){const T=f?A.length-1:0;A=A[T]}A!==null&&(i[k]=A)}for(const k in j)i[k]=j[k]}}}return i}const v9=t=>(s,n)=>{const a=y.useContext(Mb),i=y.useContext(Ib),l=()=>mie(t,s,a,i);return n?l():j3(l)};function J3(t,s,n){var l;const{style:a}=t,i={};for(const o in a)(Fr(a[o])||s.style&&Fr(s.style[o])||p9(o,t)||((l=n==null?void 0:n.getValue(o))==null?void 0:l.liveStyle)!==void 0)&&(i[o]=a[o]);return i}const xie=v9({scrapeMotionValuesFromProps:J3,createRenderState:X3});function w9(t,s,n){const a=J3(t,s,n);for(const i in t)if(Fr(t[i])||Fr(s[i])){const l=kf.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;a[l]=t[i]}return a}const gie=v9({scrapeMotionValuesFromProps:w9,createRenderState:y9}),yie=Symbol.for("motionComponentSymbol");function vh(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function bie(t,s,n){return y.useCallback(a=>{a&&t.onMount&&t.onMount(a),s&&(a?s.mount(a):s.unmount()),n&&(typeof n=="function"?n(a):vh(n)&&(n.current=a))},[s])}const ek=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),vie="framerAppearId",N9="data-"+ek(vie),j9=y.createContext({});function wie(t,s,n,a,i){var j,_;const{visualElement:l}=y.useContext(Mb),o=y.useContext(h9),c=y.useContext(Ib),d=y.useContext(q3).reducedMotion,u=y.useRef(null);a=a||o.renderer,!u.current&&a&&(u.current=a(t,{visualState:s,parent:l,props:n,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:d}));const f=u.current,m=y.useContext(j9);f&&!f.projection&&i&&(f.type==="html"||f.type==="svg")&&Nie(u.current,n,i,m);const x=y.useRef(!1);y.useInsertionEffect(()=>{f&&x.current&&f.update(n,c)});const b=n[N9],w=y.useRef(!!b&&!((j=window.MotionHandoffIsComplete)!=null&&j.call(window,b))&&((_=window.MotionHasOptimisedAnimation)==null?void 0:_.call(window,b)));return v7(()=>{f&&(x.current=!0,window.MotionIsMounted=!0,f.updateFeatures(),f.scheduleRenderMicrotask(),w.current&&f.animationState&&f.animationState.animateChanges())}),y.useEffect(()=>{f&&(!w.current&&f.animationState&&f.animationState.animateChanges(),w.current&&(queueMicrotask(()=>{var C;(C=window.MotionHandoffMarkAsComplete)==null||C.call(window,b)}),w.current=!1),f.enteringChildren=void 0)}),f}function Nie(t,s,n,a){const{layoutId:i,layout:l,drag:o,dragConstraints:c,layoutScroll:d,layoutRoot:u,layoutCrossfade:f}=s;t.projection=new n(t.latestValues,s["data-framer-portal-id"]?void 0:_9(t.parent)),t.projection.setOptions({layoutId:i,layout:l,alwaysMeasureLayout:!!o||c&&vh(c),visualElement:t,animationType:typeof l=="string"?l:"both",initialPromotionConfig:a,crossfade:f,layoutScroll:d,layoutRoot:u})}function _9(t){if(t)return t.options.allowProjection!==!1?t.projection:_9(t.parent)}function NN(t,{forwardMotionProps:s=!1}={},n,a){n&&Yae(n);const i=Q3(t)?gie:xie;function l(c,d){let u;const f={...y.useContext(q3),...c,layoutId:jie(c)},{isStatic:m}=f,x=eie(c),b=i(c,m);if(!m&&_3){_ie();const w=Sie(f);u=w.MeasureLayout,x.visualElement=wie(t,b,f,a,w.ProjectionNode)}return r.jsxs(Mb.Provider,{value:x,children:[u&&x.visualElement?r.jsx(u,{visualElement:x.visualElement,...f}):null,fie(t,c,bie(b,x.visualElement,d),b,m,s)]})}l.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const o=y.forwardRef(l);return o[yie]=t,o}function jie({layoutId:t}){const s=y.useContext(N3).id;return s&&t!==void 0?s+"-"+t:t}function _ie(t,s){y.useContext(h9).strict}function Sie(t){const{drag:s,layout:n}=ef;if(!s&&!n)return{};const a={...s,...n};return{MeasureLayout:s!=null&&s.isEnabled(t)||n!=null&&n.isEnabled(t)?a.MeasureLayout:void 0,ProjectionNode:a.ProjectionNode}}function Cie(t,s){if(typeof Proxy>"u")return NN;const n=new Map,a=(l,o)=>NN(l,o,t,s),i=(l,o)=>a(l,o);return new Proxy(i,{get:(l,o)=>o==="create"?a:(n.has(o)||n.set(o,NN(o,void 0,t,s)),n.get(o))})}function S9({top:t,left:s,right:n,bottom:a}){return{x:{min:s,max:n},y:{min:t,max:a}}}function kie({x:t,y:s}){return{top:s.min,right:t.max,bottom:s.max,left:t.min}}function Aie(t,s){if(!s)return t;const n=s({x:t.left,y:t.top}),a=s({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:a.y,right:a.x}}function jN(t){return t===void 0||t===1}function A_({scale:t,scaleX:s,scaleY:n}){return!jN(t)||!jN(s)||!jN(n)}function _d(t){return A_(t)||C9(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function C9(t){return H4(t.x)||H4(t.y)}function H4(t){return t&&t!=="0%"}function $y(t,s,n){const a=t-n,i=s*a;return n+i}function W4(t,s,n,a,i){return i!==void 0&&(t=$y(t,i,a)),$y(t,n,a)+s}function E_(t,s=0,n=1,a,i){t.min=W4(t.min,s,n,a,i),t.max=W4(t.max,s,n,a,i)}function k9(t,{x:s,y:n}){E_(t.x,s.translate,s.scale,s.originPoint),E_(t.y,n.translate,n.scale,n.originPoint)}const q4=.999999999999,G4=1.0000000000001;function Eie(t,s,n,a=!1){const i=n.length;if(!i)return;s.x=s.y=1;let l,o;for(let c=0;c<i;c++){l=n[c],o=l.projectionDelta;const{visualElement:d}=l.options;d&&d.props.style&&d.props.style.display==="contents"||(a&&l.options.layoutScroll&&l.scroll&&l!==l.root&&Nh(t,{x:-l.scroll.offset.x,y:-l.scroll.offset.y}),o&&(s.x*=o.x.scale,s.y*=o.y.scale,k9(t,o)),a&&_d(l.latestValues)&&Nh(t,l.latestValues))}s.x<G4&&s.x>q4&&(s.x=1),s.y<G4&&s.y>q4&&(s.y=1)}function wh(t,s){t.min=t.min+s,t.max=t.max+s}function K4(t,s,n,a,i=.5){const l=tn(t.min,t.max,i);E_(t,s,n,l,a)}function Nh(t,s){K4(t.x,s.x,s.scaleX,s.scale,s.originX),K4(t.y,s.y,s.scaleY,s.scale,s.originY)}function A9(t,s){return S9(Aie(t.getBoundingClientRect(),s))}function Tie(t,s,n){const a=A9(t,n),{scroll:i}=s;return i&&(wh(a.x,i.offset.x),wh(a.y,i.offset.y)),a}const Y4=()=>({translate:0,scale:1,origin:0,originPoint:0}),jh=()=>({x:Y4(),y:Y4()}),X4=()=>({min:0,max:0}),Nn=()=>({x:X4(),y:X4()}),T_={current:null},E9={current:!1};function Pie(){if(E9.current=!0,!!_3)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),s=()=>T_.current=t.matches;t.addEventListener("change",s),s()}else T_.current=!1}const Iie=new WeakMap;function Mie(t,s,n){for(const a in s){const i=s[a],l=n[a];if(Fr(i))t.addValue(a,i);else if(Fr(l))t.addValue(a,Jh(i,{owner:t}));else if(l!==i)if(t.hasValue(a)){const o=t.getValue(a);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=t.getStaticValue(a);t.addValue(a,Jh(o!==void 0?o:i,{owner:t}))}}for(const a in n)s[a]===void 0&&t.removeValue(a);return s}const Q4=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Die{scrapeMotionValuesFromProps(s,n,a){return{}}constructor({parent:s,props:n,presenceContext:a,reducedMotionConfig:i,blockInitialAnimation:l,visualState:o},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=z3,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const x=ya.now();this.renderScheduledAt<x&&(this.renderScheduledAt=x,Gs.render(this.render,!1,!0))};const{latestValues:d,renderState:u}=o;this.latestValues=d,this.baseTarget={...d},this.initialValues=n.initial?{...d}:{},this.renderState=u,this.parent=s,this.props=n,this.presenceContext=a,this.depth=s?s.depth+1:0,this.reducedMotionConfig=i,this.options=c,this.blockInitialAnimation=!!l,this.isControllingVariants=Ob(n),this.isVariantNode=m9(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(s&&s.current);const{willChange:f,...m}=this.scrapeMotionValuesFromProps(n,{},this);for(const x in m){const b=m[x];d[x]!==void 0&&Fr(b)&&b.set(d[x])}}mount(s){var n;this.current=s,Iie.set(s,this),this.projection&&!this.projection.instance&&this.projection.mount(s),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,i)=>this.bindToMotionValue(i,a)),E9.current||Pie(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:T_.current,(n=this.parent)==null||n.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var s;this.projection&&this.projection.unmount(),$c(this.notifyUpdate),$c(this.render),this.valueSubscriptions.forEach(n=>n()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(s=this.parent)==null||s.removeChild(this);for(const n in this.events)this.events[n].clear();for(const n in this.features){const a=this.features[n];a&&(a.unmount(),a.isMounted=!1)}this.current=null}addChild(s){this.children.add(s),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(s)}removeChild(s){this.children.delete(s),this.enteringChildren&&this.enteringChildren.delete(s)}bindToMotionValue(s,n){this.valueSubscriptions.has(s)&&this.valueSubscriptions.get(s)();const a=Af.has(s);a&&this.onBindTransform&&this.onBindTransform();const i=n.on("change",o=>{this.latestValues[s]=o,this.props.onUpdate&&Gs.preRender(this.notifyUpdate),a&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let l;window.MotionCheckAppearSync&&(l=window.MotionCheckAppearSync(this,s,n)),this.valueSubscriptions.set(s,()=>{i(),l&&l(),n.owner&&n.stop()})}sortNodePosition(s){return!this.current||!this.sortInstanceNodePosition||this.type!==s.type?0:this.sortInstanceNodePosition(this.current,s.current)}updateFeatures(){let s="animation";for(s in ef){const n=ef[s];if(!n)continue;const{isEnabled:a,Feature:i}=n;if(!this.features[s]&&i&&a(this.props)&&(this.features[s]=new i(this)),this.features[s]){const l=this.features[s];l.isMounted?l.update():(l.mount(),l.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Nn()}getStaticValue(s){return this.latestValues[s]}setStaticValue(s,n){this.latestValues[s]=n}update(s,n){(s.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=s,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let a=0;a<Q4.length;a++){const i=Q4[a];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const l="on"+i,o=s[l];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=Mie(this,this.scrapeMotionValuesFromProps(s,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(s){return this.props.variants?this.props.variants[s]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(s){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(s),()=>n.variantChildren.delete(s)}addValue(s,n){const a=this.values.get(s);n!==a&&(a&&this.removeValue(s),this.bindToMotionValue(s,n),this.values.set(s,n),this.latestValues[s]=n.get())}removeValue(s){this.values.delete(s);const n=this.valueSubscriptions.get(s);n&&(n(),this.valueSubscriptions.delete(s)),delete this.latestValues[s],this.removeValueFromRenderState(s,this.renderState)}hasValue(s){return this.values.has(s)}getValue(s,n){if(this.props.values&&this.props.values[s])return this.props.values[s];let a=this.values.get(s);return a===void 0&&n!==void 0&&(a=Jh(n===null?void 0:n,{owner:this}),this.addValue(s,a)),a}readValue(s,n){let a=this.latestValues[s]!==void 0||!this.current?this.latestValues[s]:this.getBaseTargetFromProps(this.props,s)??this.readValueFromInstance(this.current,s,this.options);return a!=null&&(typeof a=="string"&&(w7(a)||j7(a))?a=parseFloat(a):!Uae(a)&&zc.test(n)&&(a=r9(s,n)),this.setBaseTarget(s,Fr(a)?a.get():a)),Fr(a)?a.get():a}setBaseTarget(s,n){this.baseTarget[s]=n}getBaseTarget(s){var l;const{initial:n}=this.props;let a;if(typeof n=="string"||typeof n=="object"){const o=Z3(this.props,n,(l=this.presenceContext)==null?void 0:l.custom);o&&(a=o[s])}if(n&&a!==void 0)return a;const i=this.getBaseTargetFromProps(this.props,s);return i!==void 0&&!Fr(i)?i:this.initialValues[s]!==void 0&&a===void 0?void 0:this.baseTarget[s]}on(s,n){return this.events[s]||(this.events[s]=new E3),this.events[s].add(n)}notify(s,...n){this.events[s]&&this.events[s].notify(...n)}scheduleRenderMicrotask(){H3.render(this.render)}}class T9 extends Die{constructor(){super(...arguments),this.KeyframeResolver=Tae}sortInstanceNodePosition(s,n){return s.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(s,n){return s.style?s.style[n]:void 0}removeValueFromRenderState(s,{vars:n,style:a}){delete n[s],delete a[s]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:s}=this.props;Fr(s)&&(this.childSubscription=s.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function P9(t,{style:s,vars:n},a,i){const l=t.style;let o;for(o in s)l[o]=s[o];i==null||i.applyProjectionStyles(l,a);for(o in n)l.setProperty(o,n[o])}function Oie(t){return window.getComputedStyle(t)}class Rie extends T9{constructor(){super(...arguments),this.type="html",this.renderInstance=P9}readValueFromInstance(s,n){var a;if(Af.has(n))return(a=this.projection)!=null&&a.isProjecting?w_(n):Yre(s,n);{const i=Oie(s),l=(I3(n)?i.getPropertyValue(n):i[n])||0;return typeof l=="string"?l.trim():l}}measureInstanceViewportBox(s,{transformPagePoint:n}){return A9(s,n)}build(s,n,a){Y3(s,n,a.transformTemplate)}scrapeMotionValuesFromProps(s,n,a){return J3(s,n,a)}}const I9=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Lie(t,s,n,a){P9(t,s,void 0,a);for(const i in s.attrs)t.setAttribute(I9.has(i)?i:ek(i),s.attrs[i])}class Bie extends T9{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Nn}getBaseTargetFromProps(s,n){return s[n]}readValueFromInstance(s,n){if(Af.has(n)){const a=n9(n);return a&&a.default||0}return n=I9.has(n)?n:ek(n),s.getAttribute(n)}scrapeMotionValuesFromProps(s,n,a){return w9(s,n,a)}build(s,n,a){g9(s,n,this.isSVGTag,a.transformTemplate,a.style)}renderInstance(s,n,a,i){Lie(s,n,a,i)}mount(s){this.isSVGTag=b9(s.tagName),super.mount(s)}}const Fie=(t,s)=>Q3(t)?new Bie(s):new Rie(s,{allowProjection:t!==y.Fragment});function Dh(t,s,n){const a=t.getProps();return Z3(a,s,n!==void 0?n:a.custom,t)}const P_=t=>Array.isArray(t);function $ie(t,s,n){t.hasValue(s)?t.getValue(s).set(n):t.addValue(s,Jh(n))}function zie(t){return P_(t)?t[t.length-1]||0:t}function Uie(t,s){const n=Dh(t,s);let{transitionEnd:a={},transition:i={},...l}=n||{};l={...l,...a};for(const o in l){const c=zie(l[o]);$ie(t,o,c)}}function Vie(t){return!!(Fr(t)&&t.add)}function I_(t,s){const n=t.getValue("willChange");if(Vie(n))return n.add(s);if(!n&&ko.WillChange){const a=new ko.WillChange("auto");t.addValue("willChange",a),a.add(s)}}function M9(t){return t.props[N9]}const Hie=t=>t!==null;function Wie(t,{repeat:s,repeatType:n="loop"},a){const i=t.filter(Hie),l=s&&n!=="loop"&&s%2===1?0:i.length-1;return i[l]}const qie={type:"spring",stiffness:500,damping:25,restSpeed:10},Gie=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),Kie={type:"keyframes",duration:.8},Yie={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Xie=(t,{keyframes:s})=>s.length>2?Kie:Af.has(t)?t.startsWith("scale")?Gie(s[1]):qie:Yie;function Qie({when:t,delay:s,delayChildren:n,staggerChildren:a,staggerDirection:i,repeat:l,repeatType:o,repeatDelay:c,from:d,elapsed:u,...f}){return!!Object.keys(f).length}const tk=(t,s,n,a={},i,l)=>o=>{const c=U3(a,t)||{},d=c.delay||a.delay||0;let{elapsed:u=0}=a;u=u-Bl(d);const f={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:s.getVelocity(),...c,delay:-u,onUpdate:x=>{s.set(x),c.onUpdate&&c.onUpdate(x)},onComplete:()=>{o(),c.onComplete&&c.onComplete()},name:t,motionValue:s,element:l?void 0:i};Qie(c)||Object.assign(f,Xie(t,f)),f.duration&&(f.duration=Bl(f.duration)),f.repeatDelay&&(f.repeatDelay=Bl(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let m=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(C_(f),f.delay===0&&(m=!0)),(ko.instantAnimations||ko.skipAnimations)&&(m=!0,C_(f),f.delay=0),f.allowFlatten=!c.type&&!c.ease,m&&!l&&s.get()!==void 0){const x=Wie(f.keyframes,c);if(x!==void 0){Gs.update(()=>{f.onUpdate(x),f.onComplete()});return}}return c.isSync?new $3(f):new yae(f)};function Zie({protectedKeys:t,needsAnimating:s},n){const a=t.hasOwnProperty(n)&&s[n]!==!0;return s[n]=!1,a}function D9(t,s,{delay:n=0,transitionOverride:a,type:i}={}){let{transition:l=t.getDefaultTransition(),transitionEnd:o,...c}=s;a&&(l=a);const d=[],u=i&&t.animationState&&t.animationState.getState()[i];for(const f in c){const m=t.getValue(f,t.latestValues[f]??null),x=c[f];if(x===void 0||u&&Zie(u,f))continue;const b={delay:n,...U3(l||{},f)},w=m.get();if(w!==void 0&&!m.isAnimating&&!Array.isArray(x)&&x===w&&!b.velocity)continue;let j=!1;if(window.MotionHandoffAnimation){const C=M9(t);if(C){const k=window.MotionHandoffAnimation(C,f,Gs);k!==null&&(b.startTime=k,j=!0)}}I_(t,f),m.start(tk(f,m,x,t.shouldReduceMotion&&e9.has(f)?{type:!1}:b,t,j));const _=m.animation;_&&d.push(_)}return o&&Promise.all(d).then(()=>{Gs.update(()=>{o&&Uie(t,o)})}),d}function O9(t,s,n,a=0,i=1){const l=Array.from(t).sort((u,f)=>u.sortNodePosition(f)).indexOf(s),o=t.size,c=(o-1)*a;return typeof n=="function"?n(l,o):i===1?l*a:c-l*a}function M_(t,s,n={}){var d;const a=Dh(t,s,n.type==="exit"?(d=t.presenceContext)==null?void 0:d.custom:void 0);let{transition:i=t.getDefaultTransition()||{}}=a||{};n.transitionOverride&&(i=n.transitionOverride);const l=a?()=>Promise.all(D9(t,a,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(u=0)=>{const{delayChildren:f=0,staggerChildren:m,staggerDirection:x}=i;return Jie(t,s,u,f,m,x,n)}:()=>Promise.resolve(),{when:c}=i;if(c){const[u,f]=c==="beforeChildren"?[l,o]:[o,l];return u().then(()=>f())}else return Promise.all([l(),o(n.delay)])}function Jie(t,s,n=0,a=0,i=0,l=1,o){const c=[];for(const d of t.variantChildren)d.notify("AnimationStart",s),c.push(M_(d,s,{...o,delay:n+(typeof a=="function"?0:a)+O9(t.variantChildren,d,a,i,l)}).then(()=>d.notify("AnimationComplete",s)));return Promise.all(c)}function ele(t,s,n={}){t.notify("AnimationStart",s);let a;if(Array.isArray(s)){const i=s.map(l=>M_(t,l,n));a=Promise.all(i)}else if(typeof s=="string")a=M_(t,s,n);else{const i=typeof s=="function"?Dh(t,s,n.custom):s;a=Promise.all(D9(t,i,n))}return a.then(()=>{t.notify("AnimationComplete",s)})}function R9(t,s){if(!Array.isArray(s))return!1;const n=s.length;if(n!==t.length)return!1;for(let a=0;a<n;a++)if(s[a]!==t[a])return!1;return!0}const tle=K3.length;function L9(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?L9(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const s={};for(let n=0;n<tle;n++){const a=K3[n],i=t.props[a];(Op(i)||i===!1)&&(s[a]=i)}return s}const sle=[...G3].reverse(),nle=G3.length;function rle(t){return s=>Promise.all(s.map(({animation:n,options:a})=>ele(t,n,a)))}function ale(t){let s=rle(t),n=Z4(),a=!0;const i=d=>(u,f)=>{var x;const m=Dh(t,f,d==="exit"?(x=t.presenceContext)==null?void 0:x.custom:void 0);if(m){const{transition:b,transitionEnd:w,...j}=m;u={...u,...j,...w}}return u};function l(d){s=d(t)}function o(d){const{props:u}=t,f=L9(t.parent)||{},m=[],x=new Set;let b={},w=1/0;for(let _=0;_<nle;_++){const C=sle[_],k=n[C],A=u[C]!==void 0?u[C]:f[C],T=Op(A),P=C===d?k.isActive:null;P===!1&&(w=_);let R=A===f[C]&&A!==u[C]&&T;if(R&&a&&t.manuallyAnimateOnMount&&(R=!1),k.protectedKeys={...b},!k.isActive&&P===null||!A&&!k.prevProp||Db(A)||typeof A=="boolean")continue;const I=ile(k.prevProp,A);let O=I||C===d&&k.isActive&&!R&&T||_>w&&T,M=!1;const B=Array.isArray(A)?A:[A];let L=B.reduce(i(C),{});P===!1&&(L={});const{prevResolvedValues:F={}}=k,V={...F,...L},U=q=>{O=!0,x.has(q)&&(M=!0,x.delete(q)),k.needsAnimating[q]=!0;const G=t.getValue(q);G&&(G.liveStyle=!1)};for(const q in V){const G=L[q],se=F[q];if(b.hasOwnProperty(q))continue;let ge=!1;P_(G)&&P_(se)?ge=!R9(G,se):ge=G!==se,ge?G!=null?U(q):x.add(q):G!==void 0&&x.has(q)?U(q):k.protectedKeys[q]=!0}k.prevProp=A,k.prevResolvedValues=L,k.isActive&&(b={...b,...L}),a&&t.blockInitialAnimation&&(O=!1);const z=R&&I;O&&(!z||M)&&m.push(...B.map(q=>{const G={type:C};if(typeof q=="string"&&a&&!z&&t.manuallyAnimateOnMount&&t.parent){const{parent:se}=t,ge=Dh(se,q);if(se.enteringChildren&&ge){const{delayChildren:ke}=ge.transition||{};G.delay=O9(se.enteringChildren,t,ke)}}return{animation:q,options:G}}))}if(x.size){const _={};if(typeof u.initial!="boolean"){const C=Dh(t,Array.isArray(u.initial)?u.initial[0]:u.initial);C&&C.transition&&(_.transition=C.transition)}x.forEach(C=>{const k=t.getBaseTarget(C),A=t.getValue(C);A&&(A.liveStyle=!0),_[C]=k??null}),m.push({animation:_})}let j=!!m.length;return a&&(u.initial===!1||u.initial===u.animate)&&!t.manuallyAnimateOnMount&&(j=!1),a=!1,j?s(m):Promise.resolve()}function c(d,u){var m;if(n[d].isActive===u)return Promise.resolve();(m=t.variantChildren)==null||m.forEach(x=>{var b;return(b=x.animationState)==null?void 0:b.setActive(d,u)}),n[d].isActive=u;const f=o(d);for(const x in n)n[x].protectedKeys={};return f}return{animateChanges:o,setActive:c,setAnimateFunction:l,getState:()=>n,reset:()=>{n=Z4()}}}function ile(t,s){return typeof s=="string"?s!==t:Array.isArray(s)?!R9(s,t):!1}function bd(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Z4(){return{animate:bd(!0),whileInView:bd(),whileHover:bd(),whileTap:bd(),whileDrag:bd(),whileFocus:bd(),exit:bd()}}class nd{constructor(s){this.isMounted=!1,this.node=s}update(){}}class lle extends nd{constructor(s){super(s),s.animationState||(s.animationState=ale(s))}updateAnimationControlsSubscription(){const{animate:s}=this.node.getProps();Db(s)&&(this.unmountControls=s.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:s}=this.node.getProps(),{animate:n}=this.node.prevProps||{};s!==n&&this.updateAnimationControlsSubscription()}unmount(){var s;this.node.animationState.reset(),(s=this.unmountControls)==null||s.call(this)}}let ole=0;class cle extends nd{constructor(){super(...arguments),this.id=ole++}update(){if(!this.node.presenceContext)return;const{isPresent:s,onExitComplete:n}=this.node.presenceContext,{isPresent:a}=this.node.prevPresenceContext||{};if(!this.node.animationState||s===a)return;const i=this.node.animationState.setActive("exit",!s);n&&!s&&i.then(()=>{n(this.id)})}mount(){const{register:s,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),s&&(this.unmount=s(this.id))}unmount(){}}const dle={animation:{Feature:lle},exit:{Feature:cle}};function Lp(t,s,n,a={passive:!0}){return t.addEventListener(s,n,a),()=>t.removeEventListener(s,n)}function Cx(t){return{point:{x:t.pageX,y:t.pageY}}}const ule=t=>s=>W3(s)&&t(s,Cx(s));function tp(t,s,n,a){return Lp(t,s,ule(n),a)}const B9=1e-4,hle=1-B9,fle=1+B9,F9=.01,mle=0-F9,ple=0+F9;function ta(t){return t.max-t.min}function xle(t,s,n){return Math.abs(t-s)<=n}function J4(t,s,n,a=.5){t.origin=a,t.originPoint=tn(s.min,s.max,t.origin),t.scale=ta(n)/ta(s),t.translate=tn(n.min,n.max,t.origin)-t.originPoint,(t.scale>=hle&&t.scale<=fle||isNaN(t.scale))&&(t.scale=1),(t.translate>=mle&&t.translate<=ple||isNaN(t.translate))&&(t.translate=0)}function sp(t,s,n,a){J4(t.x,s.x,n.x,a?a.originX:void 0),J4(t.y,s.y,n.y,a?a.originY:void 0)}function eP(t,s,n){t.min=n.min+s.min,t.max=t.min+ta(s)}function gle(t,s,n){eP(t.x,s.x,n.x),eP(t.y,s.y,n.y)}function tP(t,s,n){t.min=s.min-n.min,t.max=t.min+ta(s)}function np(t,s,n){tP(t.x,s.x,n.x),tP(t.y,s.y,n.y)}function xi(t){return[t("x"),t("y")]}const $9=({current:t})=>t?t.ownerDocument.defaultView:null,sP=(t,s)=>Math.abs(t-s);function yle(t,s){const n=sP(t.x,s.x),a=sP(t.y,s.y);return Math.sqrt(n**2+a**2)}class z9{constructor(s,n,{transformPagePoint:a,contextWindow:i=window,dragSnapToOrigin:l=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const x=SN(this.lastMoveEventInfo,this.history),b=this.startEvent!==null,w=yle(x.offset,{x:0,y:0})>=this.distanceThreshold;if(!b&&!w)return;const{point:j}=x,{timestamp:_}=Cr;this.history.push({...j,timestamp:_});const{onStart:C,onMove:k}=this.handlers;b||(C&&C(this.lastMoveEvent,x),this.startEvent=this.lastMoveEvent),k&&k(this.lastMoveEvent,x)},this.handlePointerMove=(x,b)=>{this.lastMoveEvent=x,this.lastMoveEventInfo=_N(b,this.transformPagePoint),Gs.update(this.updatePoint,!0)},this.handlePointerUp=(x,b)=>{this.end();const{onEnd:w,onSessionEnd:j,resumeAnimation:_}=this.handlers;if(this.dragSnapToOrigin&&_&&_(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const C=SN(x.type==="pointercancel"?this.lastMoveEventInfo:_N(b,this.transformPagePoint),this.history);this.startEvent&&w&&w(x,C),j&&j(x,C)},!W3(s))return;this.dragSnapToOrigin=l,this.handlers=n,this.transformPagePoint=a,this.distanceThreshold=o,this.contextWindow=i||window;const c=Cx(s),d=_N(c,this.transformPagePoint),{point:u}=d,{timestamp:f}=Cr;this.history=[{...u,timestamp:f}];const{onSessionStart:m}=n;m&&m(s,SN(d,this.history)),this.removeListeners=jx(tp(this.contextWindow,"pointermove",this.handlePointerMove),tp(this.contextWindow,"pointerup",this.handlePointerUp),tp(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(s){this.handlers=s}end(){this.removeListeners&&this.removeListeners(),$c(this.updatePoint)}}function _N(t,s){return s?{point:s(t.point)}:t}function nP(t,s){return{x:t.x-s.x,y:t.y-s.y}}function SN({point:t},s){return{point:t,delta:nP(t,U9(s)),offset:nP(t,ble(s)),velocity:vle(s,.1)}}function ble(t){return t[0]}function U9(t){return t[t.length-1]}function vle(t,s){if(t.length<2)return{x:0,y:0};let n=t.length-1,a=null;const i=U9(t);for(;n>=0&&(a=t[n],!(i.timestamp-a.timestamp>Bl(s)));)n--;if(!a)return{x:0,y:0};const l=Ni(i.timestamp-a.timestamp);if(l===0)return{x:0,y:0};const o={x:(i.x-a.x)/l,y:(i.y-a.y)/l};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function wle(t,{min:s,max:n},a){return s!==void 0&&t<s?t=a?tn(s,t,a.min):Math.max(t,s):n!==void 0&&t>n&&(t=a?tn(n,t,a.max):Math.min(t,n)),t}function rP(t,s,n){return{min:s!==void 0?t.min+s:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function Nle(t,{top:s,left:n,bottom:a,right:i}){return{x:rP(t.x,n,i),y:rP(t.y,s,a)}}function aP(t,s){let n=s.min-t.min,a=s.max-t.max;return s.max-s.min<t.max-t.min&&([n,a]=[a,n]),{min:n,max:a}}function jle(t,s){return{x:aP(t.x,s.x),y:aP(t.y,s.y)}}function _le(t,s){let n=.5;const a=ta(t),i=ta(s);return i>a?n=Ip(s.min,s.max-a,t.min):a>i&&(n=Ip(t.min,t.max-i,s.min)),Co(0,1,n)}function Sle(t,s){const n={};return s.min!==void 0&&(n.min=s.min-t.min),s.max!==void 0&&(n.max=s.max-t.min),n}const D_=.35;function Cle(t=D_){return t===!1?t=0:t===!0&&(t=D_),{x:iP(t,"left","right"),y:iP(t,"top","bottom")}}function iP(t,s,n){return{min:lP(t,s),max:lP(t,n)}}function lP(t,s){return typeof t=="number"?t:t[s]||0}const kle=new WeakMap;class Ale{constructor(s){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Nn(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=s}start(s,{snapToCursor:n=!1,distanceThreshold:a}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const l=m=>{const{dragSnapToOrigin:x}=this.getProps();x?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Cx(m).point)},o=(m,x)=>{const{drag:b,dragPropagation:w,onDragStart:j}=this.getProps();if(b&&!w&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Dae(b),!this.openDragLock))return;this.latestPointerEvent=m,this.latestPanInfo=x,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),xi(C=>{let k=this.getAxisMotionValue(C).get()||0;if(Fl.test(k)){const{projection:A}=this.visualElement;if(A&&A.layout){const T=A.layout.layoutBox[C];T&&(k=ta(T)*(parseFloat(k)/100))}}this.originPoint[C]=k}),j&&Gs.postRender(()=>j(m,x)),I_(this.visualElement,"transform");const{animationState:_}=this.visualElement;_&&_.setActive("whileDrag",!0)},c=(m,x)=>{this.latestPointerEvent=m,this.latestPanInfo=x;const{dragPropagation:b,dragDirectionLock:w,onDirectionLock:j,onDrag:_}=this.getProps();if(!b&&!this.openDragLock)return;const{offset:C}=x;if(w&&this.currentDirection===null){this.currentDirection=Ele(C),this.currentDirection!==null&&j&&j(this.currentDirection);return}this.updateAxis("x",x.point,C),this.updateAxis("y",x.point,C),this.visualElement.render(),_&&_(m,x)},d=(m,x)=>{this.latestPointerEvent=m,this.latestPanInfo=x,this.stop(m,x),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>xi(m=>{var x;return this.getAnimationState(m)==="paused"&&((x=this.getAxisMotionValue(m).animation)==null?void 0:x.play())}),{dragSnapToOrigin:f}=this.getProps();this.panSession=new z9(s,{onSessionStart:l,onStart:o,onMove:c,onSessionEnd:d,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:f,distanceThreshold:a,contextWindow:$9(this.visualElement)})}stop(s,n){const a=s||this.latestPointerEvent,i=n||this.latestPanInfo,l=this.isDragging;if(this.cancel(),!l||!i||!a)return;const{velocity:o}=i;this.startAnimation(o);const{onDragEnd:c}=this.getProps();c&&Gs.postRender(()=>c(a,i))}cancel(){this.isDragging=!1;const{projection:s,animationState:n}=this.visualElement;s&&(s.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:a}=this.getProps();!a&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(s,n,a){const{drag:i}=this.getProps();if(!a||!k0(s,i,this.currentDirection))return;const l=this.getAxisMotionValue(s);let o=this.originPoint[s]+a[s];this.constraints&&this.constraints[s]&&(o=wle(o,this.constraints[s],this.elastic[s])),l.set(o)}resolveConstraints(){var l;const{dragConstraints:s,dragElastic:n}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(l=this.visualElement.projection)==null?void 0:l.layout,i=this.constraints;s&&vh(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&a?this.constraints=Nle(a.layoutBox,s):this.constraints=!1,this.elastic=Cle(n),i!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&xi(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=Sle(a.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:s,onMeasureDragConstraints:n}=this.getProps();if(!s||!vh(s))return!1;const a=s.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const l=Tie(a,i.root,this.visualElement.getTransformPagePoint());let o=jle(i.layout.layoutBox,l);if(n){const c=n(kie(o));this.hasMutatedConstraints=!!c,c&&(o=S9(c))}return o}startAnimation(s){const{drag:n,dragMomentum:a,dragElastic:i,dragTransition:l,dragSnapToOrigin:o,onDragTransitionEnd:c}=this.getProps(),d=this.constraints||{},u=xi(f=>{if(!k0(f,n,this.currentDirection))return;let m=d&&d[f]||{};o&&(m={min:0,max:0});const x=i?200:1e6,b=i?40:1e7,w={type:"inertia",velocity:a?s[f]:0,bounceStiffness:x,bounceDamping:b,timeConstant:750,restDelta:1,restSpeed:10,...l,...m};return this.startAxisValueAnimation(f,w)});return Promise.all(u).then(c)}startAxisValueAnimation(s,n){const a=this.getAxisMotionValue(s);return I_(this.visualElement,s),a.start(tk(s,a,0,n,this.visualElement,!1))}stopAnimation(){xi(s=>this.getAxisMotionValue(s).stop())}pauseAnimation(){xi(s=>{var n;return(n=this.getAxisMotionValue(s).animation)==null?void 0:n.pause()})}getAnimationState(s){var n;return(n=this.getAxisMotionValue(s).animation)==null?void 0:n.state}getAxisMotionValue(s){const n=`_drag${s.toUpperCase()}`,a=this.visualElement.getProps(),i=a[n];return i||this.visualElement.getValue(s,(a.initial?a.initial[s]:void 0)||0)}snapToCursor(s){xi(n=>{const{drag:a}=this.getProps();if(!k0(n,a,this.currentDirection))return;const{projection:i}=this.visualElement,l=this.getAxisMotionValue(n);if(i&&i.layout){const{min:o,max:c}=i.layout.layoutBox[n];l.set(s[n]-tn(o,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:s,dragConstraints:n}=this.getProps(),{projection:a}=this.visualElement;if(!vh(n)||!a||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};xi(o=>{const c=this.getAxisMotionValue(o);if(c&&this.constraints!==!1){const d=c.get();i[o]=_le({min:d,max:d},this.constraints[o])}});const{transformTemplate:l}=this.visualElement.getProps();this.visualElement.current.style.transform=l?l({},""):"none",a.root&&a.root.updateScroll(),a.updateLayout(),this.resolveConstraints(),xi(o=>{if(!k0(o,s,null))return;const c=this.getAxisMotionValue(o),{min:d,max:u}=this.constraints[o];c.set(tn(d,u,i[o]))})}addListeners(){if(!this.visualElement.current)return;kle.set(this.visualElement,this);const s=this.visualElement.current,n=tp(s,"pointerdown",d=>{const{drag:u,dragListener:f=!0}=this.getProps();u&&f&&this.start(d)}),a=()=>{const{dragConstraints:d}=this.getProps();vh(d)&&d.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,l=i.addEventListener("measure",a);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),Gs.read(a);const o=Lp(window,"resize",()=>this.scalePositionWithinConstraints()),c=i.addEventListener("didUpdate",({delta:d,hasLayoutChanged:u})=>{this.isDragging&&u&&(xi(f=>{const m=this.getAxisMotionValue(f);m&&(this.originPoint[f]+=d[f].translate,m.set(m.get()+d[f].translate))}),this.visualElement.render())});return()=>{o(),n(),l(),c&&c()}}getProps(){const s=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:a=!1,dragPropagation:i=!1,dragConstraints:l=!1,dragElastic:o=D_,dragMomentum:c=!0}=s;return{...s,drag:n,dragDirectionLock:a,dragPropagation:i,dragConstraints:l,dragElastic:o,dragMomentum:c}}}function k0(t,s,n){return(s===!0||s===t)&&(n===null||n===t)}function Ele(t,s=10){let n=null;return Math.abs(t.y)>s?n="y":Math.abs(t.x)>s&&(n="x"),n}class Tle extends nd{constructor(s){super(s),this.removeGroupControls=Ci,this.removeListeners=Ci,this.controls=new Ale(s)}mount(){const{dragControls:s}=this.node.getProps();s&&(this.removeGroupControls=s.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ci}unmount(){this.removeGroupControls(),this.removeListeners()}}const oP=t=>(s,n)=>{t&&Gs.postRender(()=>t(s,n))};class Ple extends nd{constructor(){super(...arguments),this.removePointerDownListener=Ci}onPointerDown(s){this.session=new z9(s,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:$9(this.node)})}createPanHandlers(){const{onPanSessionStart:s,onPanStart:n,onPan:a,onPanEnd:i}=this.node.getProps();return{onSessionStart:oP(s),onStart:oP(n),onMove:a,onEnd:(l,o)=>{delete this.session,i&&Gs.postRender(()=>i(l,o))}}}mount(){this.removePointerDownListener=tp(this.node.current,"pointerdown",s=>this.onPointerDown(s))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Fg={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function cP(t,s){return s.max===s.min?0:t/(s.max-s.min)*100}const gm={correct:(t,s)=>{if(!s.target)return t;if(typeof t=="string")if(Bt.test(t))t=parseFloat(t);else return t;const n=cP(t,s.target.x),a=cP(t,s.target.y);return`${n}% ${a}%`}},Ile={correct:(t,{treeScale:s,projectionDelta:n})=>{const a=t,i=zc.parse(t);if(i.length>5)return a;const l=zc.createTransformer(t),o=typeof i[0]!="number"?1:0,c=n.x.scale*s.x,d=n.y.scale*s.y;i[0+o]/=c,i[1+o]/=d;const u=tn(c,d,.5);return typeof i[2+o]=="number"&&(i[2+o]/=u),typeof i[3+o]=="number"&&(i[3+o]/=u),l(i)}};let CN=!1;class Mle extends y.Component{componentDidMount(){const{visualElement:s,layoutGroup:n,switchLayoutGroup:a,layoutId:i}=this.props,{projection:l}=s;tie(Dle),l&&(n.group&&n.group.add(l),a&&a.register&&i&&a.register(l),CN&&l.root.didUpdate(),l.addEventListener("animationComplete",()=>{this.safeToRemove()}),l.setOptions({...l.options,onExitComplete:()=>this.safeToRemove()})),Fg.hasEverUpdated=!0}getSnapshotBeforeUpdate(s){const{layoutDependency:n,visualElement:a,drag:i,isPresent:l}=this.props,{projection:o}=a;return o&&(o.isPresent=l,CN=!0,i||s.layoutDependency!==n||n===void 0||s.isPresent!==l?o.willUpdate():this.safeToRemove(),s.isPresent!==l&&(l?o.promote():o.relegate()||Gs.postRender(()=>{const c=o.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:s}=this.props.visualElement;s&&(s.root.didUpdate(),H3.postRender(()=>{!s.currentAnimation&&s.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:s,layoutGroup:n,switchLayoutGroup:a}=this.props,{projection:i}=s;CN=!0,i&&(i.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(i),a&&a.deregister&&a.deregister(i))}safeToRemove(){const{safeToRemove:s}=this.props;s&&s()}render(){return null}}function V9(t){const[s,n]=u9(),a=y.useContext(N3);return r.jsx(Mle,{...t,layoutGroup:a,switchLayoutGroup:y.useContext(j9),isPresent:s,safeToRemove:n})}const Dle={borderRadius:{...gm,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:gm,borderTopRightRadius:gm,borderBottomLeftRadius:gm,borderBottomRightRadius:gm,boxShadow:Ile};function Ole(t,s,n){const a=Fr(t)?t:Jh(t);return a.start(tk("",a,s,n)),a.animation}const Rle=(t,s)=>t.depth-s.depth;class Lle{constructor(){this.children=[],this.isDirty=!1}add(s){S3(this.children,s),this.isDirty=!0}remove(s){C3(this.children,s),this.isDirty=!0}forEach(s){this.isDirty&&this.children.sort(Rle),this.isDirty=!1,this.children.forEach(s)}}function Ble(t,s){const n=ya.now(),a=({timestamp:i})=>{const l=i-n;l>=s&&($c(a),t(l-s))};return Gs.setup(a,!0),()=>$c(a)}const H9=["TopLeft","TopRight","BottomLeft","BottomRight"],Fle=H9.length,dP=t=>typeof t=="string"?parseFloat(t):t,uP=t=>typeof t=="number"||Bt.test(t);function $le(t,s,n,a,i,l){i?(t.opacity=tn(0,n.opacity??1,zle(a)),t.opacityExit=tn(s.opacity??1,0,Ule(a))):l&&(t.opacity=tn(s.opacity??1,n.opacity??1,a));for(let o=0;o<Fle;o++){const c=`border${H9[o]}Radius`;let d=hP(s,c),u=hP(n,c);if(d===void 0&&u===void 0)continue;d||(d=0),u||(u=0),d===0||u===0||uP(d)===uP(u)?(t[c]=Math.max(tn(dP(d),dP(u),a),0),(Fl.test(u)||Fl.test(d))&&(t[c]+="%")):t[c]=u}(s.rotate||n.rotate)&&(t.rotate=tn(s.rotate||0,n.rotate||0,a))}function hP(t,s){return t[s]!==void 0?t[s]:t.borderRadius}const zle=W9(0,.5,P7),Ule=W9(.5,.95,Ci);function W9(t,s,n){return a=>a<t?0:a>s?1:n(Ip(t,s,a))}function fP(t,s){t.min=s.min,t.max=s.max}function hi(t,s){fP(t.x,s.x),fP(t.y,s.y)}function mP(t,s){t.translate=s.translate,t.scale=s.scale,t.originPoint=s.originPoint,t.origin=s.origin}function pP(t,s,n,a,i){return t-=s,t=$y(t,1/n,a),i!==void 0&&(t=$y(t,1/i,a)),t}function Vle(t,s=0,n=1,a=.5,i,l=t,o=t){if(Fl.test(s)&&(s=parseFloat(s),s=tn(o.min,o.max,s/100)-o.min),typeof s!="number")return;let c=tn(l.min,l.max,a);t===l&&(c-=s),t.min=pP(t.min,s,n,c,i),t.max=pP(t.max,s,n,c,i)}function xP(t,s,[n,a,i],l,o){Vle(t,s[n],s[a],s[i],s.scale,l,o)}const Hle=["x","scaleX","originX"],Wle=["y","scaleY","originY"];function gP(t,s,n,a){xP(t.x,s,Hle,n?n.x:void 0,a?a.x:void 0),xP(t.y,s,Wle,n?n.y:void 0,a?a.y:void 0)}function yP(t){return t.translate===0&&t.scale===1}function q9(t){return yP(t.x)&&yP(t.y)}function bP(t,s){return t.min===s.min&&t.max===s.max}function qle(t,s){return bP(t.x,s.x)&&bP(t.y,s.y)}function vP(t,s){return Math.round(t.min)===Math.round(s.min)&&Math.round(t.max)===Math.round(s.max)}function G9(t,s){return vP(t.x,s.x)&&vP(t.y,s.y)}function wP(t){return ta(t.x)/ta(t.y)}function NP(t,s){return t.translate===s.translate&&t.scale===s.scale&&t.originPoint===s.originPoint}class Gle{constructor(){this.members=[]}add(s){S3(this.members,s),s.scheduleRender()}remove(s){if(C3(this.members,s),s===this.prevLead&&(this.prevLead=void 0),s===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(s){const n=this.members.findIndex(i=>s===i);if(n===0)return!1;let a;for(let i=n;i>=0;i--){const l=this.members[i];if(l.isPresent!==!1){a=l;break}}return a?(this.promote(a),!0):!1}promote(s,n){const a=this.lead;if(s!==a&&(this.prevLead=a,this.lead=s,s.show(),a)){a.instance&&a.scheduleRender(),s.scheduleRender(),s.resumeFrom=a,n&&(s.resumeFrom.preserveOpacity=!0),a.snapshot&&(s.snapshot=a.snapshot,s.snapshot.latestValues=a.animationValues||a.latestValues),s.root&&s.root.isUpdating&&(s.isLayoutDirty=!0);const{crossfade:i}=s.options;i===!1&&a.hide()}}exitAnimationComplete(){this.members.forEach(s=>{const{options:n,resumingFrom:a}=s;n.onExitComplete&&n.onExitComplete(),a&&a.options.onExitComplete&&a.options.onExitComplete()})}scheduleRender(){this.members.forEach(s=>{s.instance&&s.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Kle(t,s,n){let a="";const i=t.x.translate/s.x,l=t.y.translate/s.y,o=(n==null?void 0:n.z)||0;if((i||l||o)&&(a=`translate3d(${i}px, ${l}px, ${o}px) `),(s.x!==1||s.y!==1)&&(a+=`scale(${1/s.x}, ${1/s.y}) `),n){const{transformPerspective:u,rotate:f,rotateX:m,rotateY:x,skewX:b,skewY:w}=n;u&&(a=`perspective(${u}px) ${a}`),f&&(a+=`rotate(${f}deg) `),m&&(a+=`rotateX(${m}deg) `),x&&(a+=`rotateY(${x}deg) `),b&&(a+=`skewX(${b}deg) `),w&&(a+=`skewY(${w}deg) `)}const c=t.x.scale*s.x,d=t.y.scale*s.y;return(c!==1||d!==1)&&(a+=`scale(${c}, ${d})`),a||"none"}const kN=["","X","Y","Z"],Yle=1e3;let Xle=0;function AN(t,s,n,a){const{latestValues:i}=s;i[t]&&(n[t]=i[t],s.setStaticValue(t,0),a&&(a[t]=0))}function K9(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:s}=t.options;if(!s)return;const n=M9(s);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:i,layoutId:l}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",Gs,!(i||l))}const{parent:a}=t;a&&!a.hasCheckedOptimisedAppear&&K9(a)}function Y9({attachResizeListener:t,defaultParent:s,measureScroll:n,checkIsScrollRoot:a,resetTransform:i}){return class{constructor(o={},c=s==null?void 0:s()){this.id=Xle++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(Jle),this.nodes.forEach(noe),this.nodes.forEach(roe),this.nodes.forEach(eoe)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let d=0;d<this.path.length;d++)this.path[d].shouldResetTransform=!0;this.root===this&&(this.nodes=new Lle)}addEventListener(o,c){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new E3),this.eventHandlers.get(o).add(c)}notifyListeners(o,...c){const d=this.eventHandlers.get(o);d&&d.notify(...c)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=d9(o)&&!$ae(o),this.instance=o;const{layoutId:c,layout:d,visualElement:u}=this.options;if(u&&!u.current&&u.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(d||c)&&(this.isLayoutDirty=!0),t){let f,m=0;const x=()=>this.root.updateBlockedByResize=!1;Gs.read(()=>{m=window.innerWidth}),t(o,()=>{const b=window.innerWidth;b!==m&&(m=b,this.root.updateBlockedByResize=!0,f&&f(),f=Ble(x,250),Fg.hasAnimatedSinceResize&&(Fg.hasAnimatedSinceResize=!1,this.nodes.forEach(SP)))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&u&&(c||d)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:m,hasRelativeLayoutChanged:x,layout:b})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const w=this.options.transition||u.getDefaultTransition()||coe,{onLayoutAnimationStart:j,onLayoutAnimationComplete:_}=u.getProps(),C=!this.targetLayout||!G9(this.targetLayout,b),k=!m&&x;if(this.options.layoutRoot||this.resumeFrom||k||m&&(C||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const A={...U3(w,"layout"),onPlay:j,onComplete:_};(u.shouldReduceMotion||this.options.layoutRoot)&&(A.delay=0,A.type=!1),this.startAnimation(A),this.setAnimationOrigin(f,k)}else m||SP(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=b})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),$c(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(aoe),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&K9(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const m=this.path[f];m.shouldResetTransform=!0,m.updateScroll("snapshot"),m.options.layoutRoot&&m.willUpdate(!1)}const{layoutId:c,layout:d}=this.options;if(c===void 0&&!d)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(jP);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(_P);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(soe),this.nodes.forEach(Qle),this.nodes.forEach(Zle)):this.nodes.forEach(_P),this.clearAllSnapshots();const c=ya.now();Cr.delta=Co(0,1e3/60,c-Cr.timestamp),Cr.timestamp=c,Cr.isProcessing=!0,xN.update.process(Cr),xN.preRender.process(Cr),xN.render.process(Cr),Cr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,H3.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(toe),this.sharedNodes.forEach(ioe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Gs.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Gs.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!ta(this.snapshot.measuredBox.x)&&!ta(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let d=0;d<this.path.length;d++)this.path[d].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Nn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(c=!1),c&&this.instance){const d=a(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:d,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:d}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!q9(this.projectionDelta),d=this.getTransformTemplate(),u=d?d(this.latestValues,""):void 0,f=u!==this.prevTransformTemplateValue;o&&this.instance&&(c||_d(this.latestValues)||f)&&(i(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const c=this.measurePageBox();let d=this.removeElementScroll(c);return o&&(d=this.removeTransform(d)),doe(d),{animationId:this.root.animationId,measuredBox:c,layoutBox:d,latestValues:{},source:this.id}}measurePageBox(){var u;const{visualElement:o}=this.options;if(!o)return Nn();const c=o.measureViewportBox();if(!(((u=this.scroll)==null?void 0:u.wasRoot)||this.path.some(uoe))){const{scroll:f}=this.root;f&&(wh(c.x,f.offset.x),wh(c.y,f.offset.y))}return c}removeElementScroll(o){var d;const c=Nn();if(hi(c,o),(d=this.scroll)!=null&&d.wasRoot)return c;for(let u=0;u<this.path.length;u++){const f=this.path[u],{scroll:m,options:x}=f;f!==this.root&&m&&x.layoutScroll&&(m.wasRoot&&hi(c,o),wh(c.x,m.offset.x),wh(c.y,m.offset.y))}return c}applyTransform(o,c=!1){const d=Nn();hi(d,o);for(let u=0;u<this.path.length;u++){const f=this.path[u];!c&&f.options.layoutScroll&&f.scroll&&f!==f.root&&Nh(d,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),_d(f.latestValues)&&Nh(d,f.latestValues)}return _d(this.latestValues)&&Nh(d,this.latestValues),d}removeTransform(o){const c=Nn();hi(c,o);for(let d=0;d<this.path.length;d++){const u=this.path[d];if(!u.instance||!_d(u.latestValues))continue;A_(u.latestValues)&&u.updateSnapshot();const f=Nn(),m=u.measurePageBox();hi(f,m),gP(c,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,f)}return _d(this.latestValues)&&gP(c,this.latestValues),c}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Cr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var x;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==c;if(!(o||d&&this.isSharedProjectionDirty||this.isProjectionDirty||(x=this.parent)!=null&&x.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:f,layoutId:m}=this.options;if(!(!this.layout||!(f||m))){if(this.resolvedRelativeTargetAt=Cr.timestamp,!this.targetDelta&&!this.relativeTarget){const b=this.getClosestProjectingParent();b&&b.layout&&this.animationProgress!==1?(this.relativeParent=b,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Nn(),this.relativeTargetOrigin=Nn(),np(this.relativeTargetOrigin,this.layout.layoutBox,b.layout.layoutBox),hi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Nn(),this.targetWithTransforms=Nn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),gle(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):hi(this.target,this.layout.layoutBox),k9(this.target,this.targetDelta)):hi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const b=this.getClosestProjectingParent();b&&!!b.resumingFrom==!!this.resumingFrom&&!b.options.layoutScroll&&b.target&&this.animationProgress!==1?(this.relativeParent=b,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Nn(),this.relativeTargetOrigin=Nn(),np(this.relativeTargetOrigin,this.target,b.target),hi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||A_(this.parent.latestValues)||C9(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var w;const o=this.getLead(),c=!!this.resumingFrom||this!==o;let d=!0;if((this.isProjectionDirty||(w=this.parent)!=null&&w.isProjectionDirty)&&(d=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===Cr.timestamp&&(d=!1),d)return;const{layout:u,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||f))return;hi(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,x=this.treeScale.y;Eie(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Nn());const{target:b}=o;if(!b){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(mP(this.prevProjectionDelta.x,this.projectionDelta.x),mP(this.prevProjectionDelta.y,this.projectionDelta.y)),sp(this.projectionDelta,this.layoutCorrected,b,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==x||!NP(this.projectionDelta.x,this.prevProjectionDelta.x)||!NP(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",b))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var c;if((c=this.options.visualElement)==null||c.scheduleRender(),o){const d=this.getStack();d&&d.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=jh(),this.projectionDelta=jh(),this.projectionDeltaWithTransform=jh()}setAnimationOrigin(o,c=!1){const d=this.snapshot,u=d?d.latestValues:{},f={...this.latestValues},m=jh();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const x=Nn(),b=d?d.source:void 0,w=this.layout?this.layout.source:void 0,j=b!==w,_=this.getStack(),C=!_||_.members.length<=1,k=!!(j&&!C&&this.options.crossfade===!0&&!this.path.some(ooe));this.animationProgress=0;let A;this.mixTargetDelta=T=>{const P=T/1e3;CP(m.x,o.x,P),CP(m.y,o.y,P),this.setTargetDelta(m),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(np(x,this.layout.layoutBox,this.relativeParent.layout.layoutBox),loe(this.relativeTarget,this.relativeTargetOrigin,x,P),A&&qle(this.relativeTarget,A)&&(this.isProjectionDirty=!1),A||(A=Nn()),hi(A,this.relativeTarget)),j&&(this.animationValues=f,$le(f,u,this.latestValues,P,k,C)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=P},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){var c,d,u;this.notifyListeners("animationStart"),(c=this.currentAnimation)==null||c.stop(),(u=(d=this.resumingFrom)==null?void 0:d.currentAnimation)==null||u.stop(),this.pendingAnimation&&($c(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Gs.update(()=>{Fg.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Jh(0)),this.currentAnimation=Ole(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:f=>{this.mixTargetDelta(f),o.onUpdate&&o.onUpdate(f)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Yle),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:c,target:d,layout:u,latestValues:f}=o;if(!(!c||!d||!u)){if(this!==o&&this.layout&&u&&X9(this.options.animationType,this.layout.layoutBox,u.layoutBox)){d=this.target||Nn();const m=ta(this.layout.layoutBox.x);d.x.min=o.target.x.min,d.x.max=d.x.min+m;const x=ta(this.layout.layoutBox.y);d.y.min=o.target.y.min,d.y.max=d.y.min+x}hi(c,d),Nh(c,f),sp(this.projectionDeltaWithTransform,this.layoutCorrected,c,f)}}registerSharedNode(o,c){this.sharedNodes.has(o)||this.sharedNodes.set(o,new Gle),this.sharedNodes.get(o).add(c);const u=c.options.initialPromotionConfig;c.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(c):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var c;const{layoutId:o}=this.options;return o?((c=this.getStack())==null?void 0:c.lead)||this:this}getPrevLead(){var c;const{layoutId:o}=this.options;return o?(c=this.getStack())==null?void 0:c.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:c,preserveFollowOpacity:d}={}){const u=this.getStack();u&&u.promote(this,d),o&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let c=!1;const{latestValues:d}=o;if((d.z||d.rotate||d.rotateX||d.rotateY||d.rotateZ||d.skewX||d.skewY)&&(c=!0),!c)return;const u={};d.z&&AN("z",o,u,this.animationValues);for(let f=0;f<kN.length;f++)AN(`rotate${kN[f]}`,o,u,this.animationValues),AN(`skew${kN[f]}`,o,u,this.animationValues);o.render();for(const f in u)o.setStaticValue(f,u[f]),this.animationValues&&(this.animationValues[f]=u[f]);o.scheduleRender()}applyProjectionStyles(o,c){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const d=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=Bg(c==null?void 0:c.pointerEvents)||"",o.transform=d?d(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=Bg(c==null?void 0:c.pointerEvents)||""),this.hasProjected&&!_d(this.latestValues)&&(o.transform=d?d({},""):"none",this.hasProjected=!1);return}o.visibility="";const f=u.animationValues||u.latestValues;this.applyTransformsToTarget();let m=Kle(this.projectionDeltaWithTransform,this.treeScale,f);d&&(m=d(f,m)),o.transform=m;const{x,y:b}=this.projectionDelta;o.transformOrigin=`${x.origin*100}% ${b.origin*100}% 0`,u.animationValues?o.opacity=u===this?f.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:o.opacity=u===this?f.opacity!==void 0?f.opacity:"":f.opacityExit!==void 0?f.opacityExit:0;for(const w in Rp){if(f[w]===void 0)continue;const{correct:j,applyTo:_,isCSSVariable:C}=Rp[w],k=m==="none"?f[w]:j(f[w],u);if(_){const A=_.length;for(let T=0;T<A;T++)o[_[T]]=k}else C?this.options.visualElement.renderState.vars[w]=k:o[w]=k}this.options.layoutId&&(o.pointerEvents=u===this?Bg(c==null?void 0:c.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var c;return(c=o.currentAnimation)==null?void 0:c.stop()}),this.root.nodes.forEach(jP),this.root.sharedNodes.clear()}}}function Qle(t){t.updateLayout()}function Zle(t){var n;const s=((n=t.resumeFrom)==null?void 0:n.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&s&&t.hasListeners("didUpdate")){const{layoutBox:a,measuredBox:i}=t.layout,{animationType:l}=t.options,o=s.source!==t.layout.source;l==="size"?xi(m=>{const x=o?s.measuredBox[m]:s.layoutBox[m],b=ta(x);x.min=a[m].min,x.max=x.min+b}):X9(l,s.layoutBox,a)&&xi(m=>{const x=o?s.measuredBox[m]:s.layoutBox[m],b=ta(a[m]);x.max=x.min+b,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[m].max=t.relativeTarget[m].min+b)});const c=jh();sp(c,a,s.layoutBox);const d=jh();o?sp(d,t.applyTransform(i,!0),s.measuredBox):sp(d,a,s.layoutBox);const u=!q9(c);let f=!1;if(!t.resumeFrom){const m=t.getClosestProjectingParent();if(m&&!m.resumeFrom){const{snapshot:x,layout:b}=m;if(x&&b){const w=Nn();np(w,s.layoutBox,x.layoutBox);const j=Nn();np(j,a,b.layoutBox),G9(w,j)||(f=!0),m.options.layoutRoot&&(t.relativeTarget=j,t.relativeTargetOrigin=w,t.relativeParent=m)}}}t.notifyListeners("didUpdate",{layout:a,snapshot:s,delta:d,layoutDelta:c,hasLayoutChanged:u,hasRelativeLayoutChanged:f})}else if(t.isLead()){const{onExitComplete:a}=t.options;a&&a()}t.options.transition=void 0}function Jle(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function eoe(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function toe(t){t.clearSnapshot()}function jP(t){t.clearMeasurements()}function _P(t){t.isLayoutDirty=!1}function soe(t){const{visualElement:s}=t.options;s&&s.getProps().onBeforeLayoutMeasure&&s.notify("BeforeLayoutMeasure"),t.resetTransform()}function SP(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function noe(t){t.resolveTargetDelta()}function roe(t){t.calcProjection()}function aoe(t){t.resetSkewAndRotation()}function ioe(t){t.removeLeadSnapshot()}function CP(t,s,n){t.translate=tn(s.translate,0,n),t.scale=tn(s.scale,1,n),t.origin=s.origin,t.originPoint=s.originPoint}function kP(t,s,n,a){t.min=tn(s.min,n.min,a),t.max=tn(s.max,n.max,a)}function loe(t,s,n,a){kP(t.x,s.x,n.x,a),kP(t.y,s.y,n.y,a)}function ooe(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const coe={duration:.45,ease:[.4,0,.1,1]},AP=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),EP=AP("applewebkit/")&&!AP("chrome/")?Math.round:Ci;function TP(t){t.min=EP(t.min),t.max=EP(t.max)}function doe(t){TP(t.x),TP(t.y)}function X9(t,s,n){return t==="position"||t==="preserve-aspect"&&!xle(wP(s),wP(n),.2)}function uoe(t){var s;return t!==t.root&&((s=t.scroll)==null?void 0:s.wasRoot)}const hoe=Y9({attachResizeListener:(t,s)=>Lp(t,"resize",s),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),EN={current:void 0},Q9=Y9({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!EN.current){const t=new hoe({});t.mount(window),t.setOptions({layoutScroll:!0}),EN.current=t}return EN.current},resetTransform:(t,s)=>{t.style.transform=s!==void 0?s:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),foe={pan:{Feature:Ple},drag:{Feature:Tle,ProjectionNode:Q9,MeasureLayout:V9}};function PP(t,s,n){const{props:a}=t;t.animationState&&a.whileHover&&t.animationState.setActive("whileHover",n==="Start");const i="onHover"+n,l=a[i];l&&Gs.postRender(()=>l(s,Cx(s)))}class moe extends nd{mount(){const{current:s}=this.node;s&&(this.unmount=Oae(s,(n,a)=>(PP(this.node,a,"Start"),i=>PP(this.node,i,"End"))))}unmount(){}}class poe extends nd{constructor(){super(...arguments),this.isActive=!1}onFocus(){let s=!1;try{s=this.node.current.matches(":focus-visible")}catch{s=!0}!s||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=jx(Lp(this.node.current,"focus",()=>this.onFocus()),Lp(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function IP(t,s,n){const{props:a}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&a.whileTap&&t.animationState.setActive("whileTap",n==="Start");const i="onTap"+(n==="End"?"":n),l=a[i];l&&Gs.postRender(()=>l(s,Cx(s)))}class xoe extends nd{mount(){const{current:s}=this.node;s&&(this.unmount=Fae(s,(n,a)=>(IP(this.node,a,"Start"),(i,{success:l})=>IP(this.node,i,l?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const O_=new WeakMap,TN=new WeakMap,goe=t=>{const s=O_.get(t.target);s&&s(t)},yoe=t=>{t.forEach(goe)};function boe({root:t,...s}){const n=t||document;TN.has(n)||TN.set(n,{});const a=TN.get(n),i=JSON.stringify(s);return a[i]||(a[i]=new IntersectionObserver(yoe,{root:t,...s})),a[i]}function voe(t,s,n){const a=boe(s);return O_.set(t,n),a.observe(t),()=>{O_.delete(t),a.unobserve(t)}}const woe={some:0,all:1};class Noe extends nd{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:s={}}=this.node.getProps(),{root:n,margin:a,amount:i="some",once:l}=s,o={root:n?n.current:void 0,rootMargin:a,threshold:typeof i=="number"?i:woe[i]},c=d=>{const{isIntersecting:u}=d;if(this.isInView===u||(this.isInView=u,l&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:f,onViewportLeave:m}=this.node.getProps(),x=u?f:m;x&&x(d)};return voe(this.node.current,o,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:s,prevProps:n}=this.node;["amount","margin","root"].some(joe(s,n))&&this.startObserver()}unmount(){}}function joe({viewport:t={}},{viewport:s={}}={}){return n=>t[n]!==s[n]}const _oe={inView:{Feature:Noe},tap:{Feature:xoe},focus:{Feature:poe},hover:{Feature:moe}},Soe={layout:{ProjectionNode:Q9,MeasureLayout:V9}},Coe={...dle,..._oe,...foe,...Soe},Nt=Cie(Coe,Fie);function Rb(t){const s=Zn(d=>d.modules)||{},n=Zn(d=>d.user),a=(n==null?void 0:n.is_admin)&&Object.keys(s).length===0,i=s[t]||[],l=y.useMemo(()=>new Set(i.map(d=>d.code.split(".").pop())),[i]),o=a||i.length>0,c=d=>a||l.has(d);return{hasAny:o,canView:c("view"),canCreate:c("create"),canUpdate:c("update"),canDelete:c("delete")}}function Z9(t){var s,n,a="";if(typeof t=="string"||typeof t=="number")a+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(s=0;s<i;s++)t[s]&&(n=Z9(t[s]))&&(a&&(a+=" "),a+=n)}else for(n in t)t[n]&&(a&&(a+=" "),a+=n);return a}function ms(){for(var t,s,n=0,a="",i=arguments.length;n<i;n++)(t=arguments[n])&&(s=Z9(t))&&(a&&(a+=" "),a+=s);return a}const sk="-",koe=t=>{const s=Eoe(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:a}=t;return{getClassGroupId:o=>{const c=o.split(sk);return c[0]===""&&c.length!==1&&c.shift(),J9(c,s)||Aoe(o)},getConflictingClassGroupIds:(o,c)=>{const d=n[o]||[];return c&&a[o]?[...d,...a[o]]:d}}},J9=(t,s)=>{var o;if(t.length===0)return s.classGroupId;const n=t[0],a=s.nextPart.get(n),i=a?J9(t.slice(1),a):void 0;if(i)return i;if(s.validators.length===0)return;const l=t.join(sk);return(o=s.validators.find(({validator:c})=>c(l)))==null?void 0:o.classGroupId},MP=/^\[(.+)\]$/,Aoe=t=>{if(MP.test(t)){const s=MP.exec(t)[1],n=s==null?void 0:s.substring(0,s.indexOf(":"));if(n)return"arbitrary.."+n}},Eoe=t=>{const{theme:s,classGroups:n}=t,a={nextPart:new Map,validators:[]};for(const i in n)R_(n[i],a,i,s);return a},R_=(t,s,n,a)=>{t.forEach(i=>{if(typeof i=="string"){const l=i===""?s:DP(s,i);l.classGroupId=n;return}if(typeof i=="function"){if(Toe(i)){R_(i(a),s,n,a);return}s.validators.push({validator:i,classGroupId:n});return}Object.entries(i).forEach(([l,o])=>{R_(o,DP(s,l),n,a)})})},DP=(t,s)=>{let n=t;return s.split(sk).forEach(a=>{n.nextPart.has(a)||n.nextPart.set(a,{nextPart:new Map,validators:[]}),n=n.nextPart.get(a)}),n},Toe=t=>t.isThemeGetter,Poe=t=>{if(t<1)return{get:()=>{},set:()=>{}};let s=0,n=new Map,a=new Map;const i=(l,o)=>{n.set(l,o),s++,s>t&&(s=0,a=n,n=new Map)};return{get(l){let o=n.get(l);if(o!==void 0)return o;if((o=a.get(l))!==void 0)return i(l,o),o},set(l,o){n.has(l)?n.set(l,o):i(l,o)}}},L_="!",B_=":",Ioe=B_.length,Moe=t=>{const{prefix:s,experimentalParseClassName:n}=t;let a=i=>{const l=[];let o=0,c=0,d=0,u;for(let w=0;w<i.length;w++){let j=i[w];if(o===0&&c===0){if(j===B_){l.push(i.slice(d,w)),d=w+Ioe;continue}if(j==="/"){u=w;continue}}j==="["?o++:j==="]"?o--:j==="("?c++:j===")"&&c--}const f=l.length===0?i:i.substring(d),m=Doe(f),x=m!==f,b=u&&u>d?u-d:void 0;return{modifiers:l,hasImportantModifier:x,baseClassName:m,maybePostfixModifierPosition:b}};if(s){const i=s+B_,l=a;a=o=>o.startsWith(i)?l(o.substring(i.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:o,maybePostfixModifierPosition:void 0}}if(n){const i=a;a=l=>n({className:l,parseClassName:i})}return a},Doe=t=>t.endsWith(L_)?t.substring(0,t.length-1):t.startsWith(L_)?t.substring(1):t,Ooe=t=>{const s=Object.fromEntries(t.orderSensitiveModifiers.map(a=>[a,!0]));return a=>{if(a.length<=1)return a;const i=[];let l=[];return a.forEach(o=>{o[0]==="["||s[o]?(i.push(...l.sort(),o),l=[]):l.push(o)}),i.push(...l.sort()),i}},Roe=t=>({cache:Poe(t.cacheSize),parseClassName:Moe(t),sortModifiers:Ooe(t),...koe(t)}),Loe=/\s+/,Boe=(t,s)=>{const{parseClassName:n,getClassGroupId:a,getConflictingClassGroupIds:i,sortModifiers:l}=s,o=[],c=t.trim().split(Loe);let d="";for(let u=c.length-1;u>=0;u-=1){const f=c[u],{isExternal:m,modifiers:x,hasImportantModifier:b,baseClassName:w,maybePostfixModifierPosition:j}=n(f);if(m){d=f+(d.length>0?" "+d:d);continue}let _=!!j,C=a(_?w.substring(0,j):w);if(!C){if(!_){d=f+(d.length>0?" "+d:d);continue}if(C=a(w),!C){d=f+(d.length>0?" "+d:d);continue}_=!1}const k=l(x).join(":"),A=b?k+L_:k,T=A+C;if(o.includes(T))continue;o.push(T);const P=i(C,_);for(let R=0;R<P.length;++R){const I=P[R];o.push(A+I)}d=f+(d.length>0?" "+d:d)}return d};function Foe(){let t=0,s,n,a="";for(;t<arguments.length;)(s=arguments[t++])&&(n=eB(s))&&(a&&(a+=" "),a+=n);return a}const eB=t=>{if(typeof t=="string")return t;let s,n="";for(let a=0;a<t.length;a++)t[a]&&(s=eB(t[a]))&&(n&&(n+=" "),n+=s);return n};function $oe(t,...s){let n,a,i,l=o;function o(d){const u=s.reduce((f,m)=>m(f),t());return n=Roe(u),a=n.cache.get,i=n.cache.set,l=c,c(d)}function c(d){const u=a(d);if(u)return u;const f=Boe(d,n);return i(d,f),f}return function(){return l(Foe.apply(null,arguments))}}const zn=t=>{const s=n=>n[t]||[];return s.isThemeGetter=!0,s},tB=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,sB=/^\((?:(\w[\w-]*):)?(.+)\)$/i,zoe=/^\d+\/\d+$/,Uoe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Voe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Hoe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,Woe=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,qoe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Yu=t=>zoe.test(t),Xt=t=>!!t&&!Number.isNaN(Number(t)),ec=t=>!!t&&Number.isInteger(Number(t)),PN=t=>t.endsWith("%")&&Xt(t.slice(0,-1)),so=t=>Uoe.test(t),Goe=()=>!0,Koe=t=>Voe.test(t)&&!Hoe.test(t),nB=()=>!1,Yoe=t=>Woe.test(t),Xoe=t=>qoe.test(t),Qoe=t=>!xt(t)&&!gt(t),Zoe=t=>Ef(t,iB,nB),xt=t=>tB.test(t),vd=t=>Ef(t,lB,Koe),IN=t=>Ef(t,nce,Xt),OP=t=>Ef(t,rB,nB),Joe=t=>Ef(t,aB,Xoe),A0=t=>Ef(t,oB,Yoe),gt=t=>sB.test(t),ym=t=>Tf(t,lB),ece=t=>Tf(t,rce),RP=t=>Tf(t,rB),tce=t=>Tf(t,iB),sce=t=>Tf(t,aB),E0=t=>Tf(t,oB,!0),Ef=(t,s,n)=>{const a=tB.exec(t);return a?a[1]?s(a[1]):n(a[2]):!1},Tf=(t,s,n=!1)=>{const a=sB.exec(t);return a?a[1]?s(a[1]):n:!1},rB=t=>t==="position"||t==="percentage",aB=t=>t==="image"||t==="url",iB=t=>t==="length"||t==="size"||t==="bg-size",lB=t=>t==="length",nce=t=>t==="number",rce=t=>t==="family-name",oB=t=>t==="shadow",ace=()=>{const t=zn("color"),s=zn("font"),n=zn("text"),a=zn("font-weight"),i=zn("tracking"),l=zn("leading"),o=zn("breakpoint"),c=zn("container"),d=zn("spacing"),u=zn("radius"),f=zn("shadow"),m=zn("inset-shadow"),x=zn("text-shadow"),b=zn("drop-shadow"),w=zn("blur"),j=zn("perspective"),_=zn("aspect"),C=zn("ease"),k=zn("animate"),A=()=>["auto","avoid","all","avoid-page","page","left","right","column"],T=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],P=()=>[...T(),gt,xt],R=()=>["auto","hidden","clip","visible","scroll"],I=()=>["auto","contain","none"],O=()=>[gt,xt,d],M=()=>[Yu,"full","auto",...O()],B=()=>[ec,"none","subgrid",gt,xt],L=()=>["auto",{span:["full",ec,gt,xt]},ec,gt,xt],F=()=>[ec,"auto",gt,xt],V=()=>["auto","min","max","fr",gt,xt],U=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],z=()=>["start","end","center","stretch","center-safe","end-safe"],W=()=>["auto",...O()],q=()=>[Yu,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...O()],G=()=>[t,gt,xt],se=()=>[...T(),RP,OP,{position:[gt,xt]}],ge=()=>["no-repeat",{repeat:["","x","y","space","round"]}],ke=()=>["auto","cover","contain",tce,Zoe,{size:[gt,xt]}],ee=()=>[PN,ym,vd],pe=()=>["","none","full",u,gt,xt],ue=()=>["",Xt,ym,vd],ye=()=>["solid","dashed","dotted","double"],X=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],oe=()=>[Xt,PN,RP,OP],_e=()=>["","none",w,gt,xt],ce=()=>["none",Xt,gt,xt],he=()=>["none",Xt,gt,xt],fe=()=>[Xt,gt,xt],le=()=>[Yu,"full",...O()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[so],breakpoint:[so],color:[Goe],container:[so],"drop-shadow":[so],ease:["in","out","in-out"],font:[Qoe],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[so],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[so],shadow:[so],spacing:["px",Xt],text:[so],"text-shadow":[so],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Yu,xt,gt,_]}],container:["container"],columns:[{columns:[Xt,xt,gt,c]}],"break-after":[{"break-after":A()}],"break-before":[{"break-before":A()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:P()}],overflow:[{overflow:R()}],"overflow-x":[{"overflow-x":R()}],"overflow-y":[{"overflow-y":R()}],overscroll:[{overscroll:I()}],"overscroll-x":[{"overscroll-x":I()}],"overscroll-y":[{"overscroll-y":I()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:M()}],"inset-x":[{"inset-x":M()}],"inset-y":[{"inset-y":M()}],start:[{start:M()}],end:[{end:M()}],top:[{top:M()}],right:[{right:M()}],bottom:[{bottom:M()}],left:[{left:M()}],visibility:["visible","invisible","collapse"],z:[{z:[ec,"auto",gt,xt]}],basis:[{basis:[Yu,"full","auto",c,...O()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Xt,Yu,"auto","initial","none",xt]}],grow:[{grow:["",Xt,gt,xt]}],shrink:[{shrink:["",Xt,gt,xt]}],order:[{order:[ec,"first","last","none",gt,xt]}],"grid-cols":[{"grid-cols":B()}],"col-start-end":[{col:L()}],"col-start":[{"col-start":F()}],"col-end":[{"col-end":F()}],"grid-rows":[{"grid-rows":B()}],"row-start-end":[{row:L()}],"row-start":[{"row-start":F()}],"row-end":[{"row-end":F()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":V()}],"auto-rows":[{"auto-rows":V()}],gap:[{gap:O()}],"gap-x":[{"gap-x":O()}],"gap-y":[{"gap-y":O()}],"justify-content":[{justify:[...U(),"normal"]}],"justify-items":[{"justify-items":[...z(),"normal"]}],"justify-self":[{"justify-self":["auto",...z()]}],"align-content":[{content:["normal",...U()]}],"align-items":[{items:[...z(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...z(),{baseline:["","last"]}]}],"place-content":[{"place-content":U()}],"place-items":[{"place-items":[...z(),"baseline"]}],"place-self":[{"place-self":["auto",...z()]}],p:[{p:O()}],px:[{px:O()}],py:[{py:O()}],ps:[{ps:O()}],pe:[{pe:O()}],pt:[{pt:O()}],pr:[{pr:O()}],pb:[{pb:O()}],pl:[{pl:O()}],m:[{m:W()}],mx:[{mx:W()}],my:[{my:W()}],ms:[{ms:W()}],me:[{me:W()}],mt:[{mt:W()}],mr:[{mr:W()}],mb:[{mb:W()}],ml:[{ml:W()}],"space-x":[{"space-x":O()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":O()}],"space-y-reverse":["space-y-reverse"],size:[{size:q()}],w:[{w:[c,"screen",...q()]}],"min-w":[{"min-w":[c,"screen","none",...q()]}],"max-w":[{"max-w":[c,"screen","none","prose",{screen:[o]},...q()]}],h:[{h:["screen","lh",...q()]}],"min-h":[{"min-h":["screen","lh","none",...q()]}],"max-h":[{"max-h":["screen","lh",...q()]}],"font-size":[{text:["base",n,ym,vd]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[a,gt,IN]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",PN,xt]}],"font-family":[{font:[ece,xt,s]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,gt,xt]}],"line-clamp":[{"line-clamp":[Xt,"none",gt,IN]}],leading:[{leading:[l,...O()]}],"list-image":[{"list-image":["none",gt,xt]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",gt,xt]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:G()}],"text-color":[{text:G()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ye(),"wavy"]}],"text-decoration-thickness":[{decoration:[Xt,"from-font","auto",gt,vd]}],"text-decoration-color":[{decoration:G()}],"underline-offset":[{"underline-offset":[Xt,"auto",gt,xt]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:O()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",gt,xt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",gt,xt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:se()}],"bg-repeat":[{bg:ge()}],"bg-size":[{bg:ke()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},ec,gt,xt],radial:["",gt,xt],conic:[ec,gt,xt]},sce,Joe]}],"bg-color":[{bg:G()}],"gradient-from-pos":[{from:ee()}],"gradient-via-pos":[{via:ee()}],"gradient-to-pos":[{to:ee()}],"gradient-from":[{from:G()}],"gradient-via":[{via:G()}],"gradient-to":[{to:G()}],rounded:[{rounded:pe()}],"rounded-s":[{"rounded-s":pe()}],"rounded-e":[{"rounded-e":pe()}],"rounded-t":[{"rounded-t":pe()}],"rounded-r":[{"rounded-r":pe()}],"rounded-b":[{"rounded-b":pe()}],"rounded-l":[{"rounded-l":pe()}],"rounded-ss":[{"rounded-ss":pe()}],"rounded-se":[{"rounded-se":pe()}],"rounded-ee":[{"rounded-ee":pe()}],"rounded-es":[{"rounded-es":pe()}],"rounded-tl":[{"rounded-tl":pe()}],"rounded-tr":[{"rounded-tr":pe()}],"rounded-br":[{"rounded-br":pe()}],"rounded-bl":[{"rounded-bl":pe()}],"border-w":[{border:ue()}],"border-w-x":[{"border-x":ue()}],"border-w-y":[{"border-y":ue()}],"border-w-s":[{"border-s":ue()}],"border-w-e":[{"border-e":ue()}],"border-w-t":[{"border-t":ue()}],"border-w-r":[{"border-r":ue()}],"border-w-b":[{"border-b":ue()}],"border-w-l":[{"border-l":ue()}],"divide-x":[{"divide-x":ue()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":ue()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ye(),"hidden","none"]}],"divide-style":[{divide:[...ye(),"hidden","none"]}],"border-color":[{border:G()}],"border-color-x":[{"border-x":G()}],"border-color-y":[{"border-y":G()}],"border-color-s":[{"border-s":G()}],"border-color-e":[{"border-e":G()}],"border-color-t":[{"border-t":G()}],"border-color-r":[{"border-r":G()}],"border-color-b":[{"border-b":G()}],"border-color-l":[{"border-l":G()}],"divide-color":[{divide:G()}],"outline-style":[{outline:[...ye(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Xt,gt,xt]}],"outline-w":[{outline:["",Xt,ym,vd]}],"outline-color":[{outline:G()}],shadow:[{shadow:["","none",f,E0,A0]}],"shadow-color":[{shadow:G()}],"inset-shadow":[{"inset-shadow":["none",m,E0,A0]}],"inset-shadow-color":[{"inset-shadow":G()}],"ring-w":[{ring:ue()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:G()}],"ring-offset-w":[{"ring-offset":[Xt,vd]}],"ring-offset-color":[{"ring-offset":G()}],"inset-ring-w":[{"inset-ring":ue()}],"inset-ring-color":[{"inset-ring":G()}],"text-shadow":[{"text-shadow":["none",x,E0,A0]}],"text-shadow-color":[{"text-shadow":G()}],opacity:[{opacity:[Xt,gt,xt]}],"mix-blend":[{"mix-blend":[...X(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":X()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Xt]}],"mask-image-linear-from-pos":[{"mask-linear-from":oe()}],"mask-image-linear-to-pos":[{"mask-linear-to":oe()}],"mask-image-linear-from-color":[{"mask-linear-from":G()}],"mask-image-linear-to-color":[{"mask-linear-to":G()}],"mask-image-t-from-pos":[{"mask-t-from":oe()}],"mask-image-t-to-pos":[{"mask-t-to":oe()}],"mask-image-t-from-color":[{"mask-t-from":G()}],"mask-image-t-to-color":[{"mask-t-to":G()}],"mask-image-r-from-pos":[{"mask-r-from":oe()}],"mask-image-r-to-pos":[{"mask-r-to":oe()}],"mask-image-r-from-color":[{"mask-r-from":G()}],"mask-image-r-to-color":[{"mask-r-to":G()}],"mask-image-b-from-pos":[{"mask-b-from":oe()}],"mask-image-b-to-pos":[{"mask-b-to":oe()}],"mask-image-b-from-color":[{"mask-b-from":G()}],"mask-image-b-to-color":[{"mask-b-to":G()}],"mask-image-l-from-pos":[{"mask-l-from":oe()}],"mask-image-l-to-pos":[{"mask-l-to":oe()}],"mask-image-l-from-color":[{"mask-l-from":G()}],"mask-image-l-to-color":[{"mask-l-to":G()}],"mask-image-x-from-pos":[{"mask-x-from":oe()}],"mask-image-x-to-pos":[{"mask-x-to":oe()}],"mask-image-x-from-color":[{"mask-x-from":G()}],"mask-image-x-to-color":[{"mask-x-to":G()}],"mask-image-y-from-pos":[{"mask-y-from":oe()}],"mask-image-y-to-pos":[{"mask-y-to":oe()}],"mask-image-y-from-color":[{"mask-y-from":G()}],"mask-image-y-to-color":[{"mask-y-to":G()}],"mask-image-radial":[{"mask-radial":[gt,xt]}],"mask-image-radial-from-pos":[{"mask-radial-from":oe()}],"mask-image-radial-to-pos":[{"mask-radial-to":oe()}],"mask-image-radial-from-color":[{"mask-radial-from":G()}],"mask-image-radial-to-color":[{"mask-radial-to":G()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":T()}],"mask-image-conic-pos":[{"mask-conic":[Xt]}],"mask-image-conic-from-pos":[{"mask-conic-from":oe()}],"mask-image-conic-to-pos":[{"mask-conic-to":oe()}],"mask-image-conic-from-color":[{"mask-conic-from":G()}],"mask-image-conic-to-color":[{"mask-conic-to":G()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:se()}],"mask-repeat":[{mask:ge()}],"mask-size":[{mask:ke()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",gt,xt]}],filter:[{filter:["","none",gt,xt]}],blur:[{blur:_e()}],brightness:[{brightness:[Xt,gt,xt]}],contrast:[{contrast:[Xt,gt,xt]}],"drop-shadow":[{"drop-shadow":["","none",b,E0,A0]}],"drop-shadow-color":[{"drop-shadow":G()}],grayscale:[{grayscale:["",Xt,gt,xt]}],"hue-rotate":[{"hue-rotate":[Xt,gt,xt]}],invert:[{invert:["",Xt,gt,xt]}],saturate:[{saturate:[Xt,gt,xt]}],sepia:[{sepia:["",Xt,gt,xt]}],"backdrop-filter":[{"backdrop-filter":["","none",gt,xt]}],"backdrop-blur":[{"backdrop-blur":_e()}],"backdrop-brightness":[{"backdrop-brightness":[Xt,gt,xt]}],"backdrop-contrast":[{"backdrop-contrast":[Xt,gt,xt]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Xt,gt,xt]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Xt,gt,xt]}],"backdrop-invert":[{"backdrop-invert":["",Xt,gt,xt]}],"backdrop-opacity":[{"backdrop-opacity":[Xt,gt,xt]}],"backdrop-saturate":[{"backdrop-saturate":[Xt,gt,xt]}],"backdrop-sepia":[{"backdrop-sepia":["",Xt,gt,xt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":O()}],"border-spacing-x":[{"border-spacing-x":O()}],"border-spacing-y":[{"border-spacing-y":O()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",gt,xt]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Xt,"initial",gt,xt]}],ease:[{ease:["linear","initial",C,gt,xt]}],delay:[{delay:[Xt,gt,xt]}],animate:[{animate:["none",k,gt,xt]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[j,gt,xt]}],"perspective-origin":[{"perspective-origin":P()}],rotate:[{rotate:ce()}],"rotate-x":[{"rotate-x":ce()}],"rotate-y":[{"rotate-y":ce()}],"rotate-z":[{"rotate-z":ce()}],scale:[{scale:he()}],"scale-x":[{"scale-x":he()}],"scale-y":[{"scale-y":he()}],"scale-z":[{"scale-z":he()}],"scale-3d":["scale-3d"],skew:[{skew:fe()}],"skew-x":[{"skew-x":fe()}],"skew-y":[{"skew-y":fe()}],transform:[{transform:[gt,xt,"","none","gpu","cpu"]}],"transform-origin":[{origin:P()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:le()}],"translate-x":[{"translate-x":le()}],"translate-y":[{"translate-y":le()}],"translate-z":[{"translate-z":le()}],"translate-none":["translate-none"],accent:[{accent:G()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:G()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",gt,xt]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":O()}],"scroll-mx":[{"scroll-mx":O()}],"scroll-my":[{"scroll-my":O()}],"scroll-ms":[{"scroll-ms":O()}],"scroll-me":[{"scroll-me":O()}],"scroll-mt":[{"scroll-mt":O()}],"scroll-mr":[{"scroll-mr":O()}],"scroll-mb":[{"scroll-mb":O()}],"scroll-ml":[{"scroll-ml":O()}],"scroll-p":[{"scroll-p":O()}],"scroll-px":[{"scroll-px":O()}],"scroll-py":[{"scroll-py":O()}],"scroll-ps":[{"scroll-ps":O()}],"scroll-pe":[{"scroll-pe":O()}],"scroll-pt":[{"scroll-pt":O()}],"scroll-pr":[{"scroll-pr":O()}],"scroll-pb":[{"scroll-pb":O()}],"scroll-pl":[{"scroll-pl":O()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",gt,xt]}],fill:[{fill:["none",...G()]}],"stroke-w":[{stroke:[Xt,ym,vd,IN]}],stroke:[{stroke:["none",...G()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},ice=$oe(ace);function Pt(...t){return ice(ms(t))}const We=y.forwardRef(({className:t,...s},n)=>r.jsx("div",{ref:n,className:Pt("rounded-xl border bg-card text-card-foreground shadow",t),...s}));We.displayName="Card";const st=y.forwardRef(({className:t,...s},n)=>r.jsx("div",{ref:n,className:Pt("flex flex-col space-y-1.5 p-6",t),...s}));st.displayName="CardHeader";const lt=y.forwardRef(({className:t,...s},n)=>r.jsx("div",{ref:n,className:Pt("font-semibold leading-none tracking-tight",t),...s}));lt.displayName="CardTitle";const Ca=y.forwardRef(({className:t,...s},n)=>r.jsx("div",{ref:n,className:Pt("text-sm text-muted-foreground",t),...s}));Ca.displayName="CardDescription";const qe=y.forwardRef(({className:t,...s},n)=>r.jsx("div",{ref:n,className:Pt("p-6 pt-0",t),...s}));qe.displayName="CardContent";const lce=y.forwardRef(({className:t,...s},n)=>r.jsx("div",{ref:n,className:Pt("flex items-center p-6 pt-0",t),...s}));lce.displayName="CardFooter";const LP=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,BP=ms,Lb=(t,s)=>n=>{var a;if((s==null?void 0:s.variants)==null)return BP(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:i,defaultVariants:l}=s,o=Object.keys(i).map(u=>{const f=n==null?void 0:n[u],m=l==null?void 0:l[u];if(f===null)return null;const x=LP(f)||LP(m);return i[u][x]}),c=n&&Object.entries(n).reduce((u,f)=>{let[m,x]=f;return x===void 0||(u[m]=x),u},{}),d=s==null||(a=s.compoundVariants)===null||a===void 0?void 0:a.reduce((u,f)=>{let{class:m,className:x,...b}=f;return Object.entries(b).every(w=>{let[j,_]=w;return Array.isArray(_)?_.includes({...l,...c}[j]):{...l,...c}[j]===_})?[...u,m,x]:u},[]);return BP(t,o,d,n==null?void 0:n.class,n==null?void 0:n.className)},oce=Lb("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Ge({className:t,variant:s,...n}){return r.jsx("div",{className:Pt(oce({variant:s}),t),...n})}function FP(t,s){if(typeof t=="function")return t(s);t!=null&&(t.current=s)}function cB(...t){return s=>{let n=!1;const a=t.map(i=>{const l=FP(i,s);return!n&&typeof l=="function"&&(n=!0),l});if(n)return()=>{for(let i=0;i<a.length;i++){const l=a[i];typeof l=="function"?l():FP(t[i],null)}}}}function Ss(...t){return y.useCallback(cB(...t),t)}function tf(t){const s=dce(t),n=y.forwardRef((a,i)=>{const{children:l,...o}=a,c=y.Children.toArray(l),d=c.find(hce);if(d){const u=d.props.children,f=c.map(m=>m===d?y.Children.count(u)>1?y.Children.only(null):y.isValidElement(u)?u.props.children:null:m);return r.jsx(s,{...o,ref:i,children:y.isValidElement(u)?y.cloneElement(u,void 0,f):null})}return r.jsx(s,{...o,ref:i,children:l})});return n.displayName=`${t}.Slot`,n}var cce=tf("Slot");function dce(t){const s=y.forwardRef((n,a)=>{const{children:i,...l}=n;if(y.isValidElement(i)){const o=mce(i),c=fce(l,i.props);return i.type!==y.Fragment&&(c.ref=a?cB(a,o):o),y.cloneElement(i,c)}return y.Children.count(i)>1?y.Children.only(null):null});return s.displayName=`${t}.SlotClone`,s}var uce=Symbol("radix.slottable");function hce(t){return y.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===uce}function fce(t,s){const n={...s};for(const a in s){const i=t[a],l=s[a];/^on[A-Z]/.test(a)?i&&l?n[a]=(...c)=>{const d=l(...c);return i(...c),d}:i&&(n[a]=i):a==="style"?n[a]={...i,...l}:a==="className"&&(n[a]=[i,l].filter(Boolean).join(" "))}return{...t,...n}}function mce(t){var a,i;let s=(a=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:a.get,n=s&&"isReactWarning"in s&&s.isReactWarning;return n?t.ref:(s=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=s&&"isReactWarning"in s&&s.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}const pce=Lb("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Re=y.forwardRef(({className:t,variant:s,size:n,asChild:a=!1,...i},l)=>{const o=a?cce:"button";return r.jsx(o,{className:Pt(pce({variant:s,size:n,className:t})),ref:l,...i})});Re.displayName="Button";const Ee=y.forwardRef(({className:t,type:s,...n},a)=>r.jsx("input",{type:s,className:Pt("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:a,...n}));Ee.displayName="Input";function Vc({variant:t="default",className:s,children:n,...a}){const i="relative w-full rounded-lg border px-4 py-3 text-sm flex gap-3 items-start",l={default:"bg-slate-50 border-slate-200 text-slate-800",destructive:"bg-rose-50 border-rose-200 text-rose-800"};return r.jsx("div",{role:"alert",className:Pt(i,l[t]||l.default,s),...a,children:n})}function Hc({className:t,children:s,...n}){return r.jsx("div",{className:Pt("font-semibold leading-tight text-sm",t),...n,children:s})}function Wc({className:t,children:s,...n}){return r.jsx("div",{className:Pt("text-xs mt-1 text-slate-700",t),...n,children:s})}function Je({className:t,...s}){return r.jsx("div",{className:Pt("animate-pulse rounded-md bg-primary/10",t),...s})}const T0={initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.18}};function xce(){const{hasAny:t,canView:s,canCreate:n,canUpdate:a,canDelete:i}=Rb("departments"),[l,o]=y.useState([]),[c,d]=y.useState({name:"",description:""}),[u,f]=y.useState(null),[m,x]=y.useState(""),[b,w]=y.useState(!1),[j,_]=y.useState(!1),[C,k]=y.useState(""),[A,T]=y.useState("all"),P=y.useCallback(async()=>{var L,F,V;if(s){x(""),_(!0);try{const{data:U}=await J.get("/departments/");o(U||[])}catch(U){const z=(L=U==null?void 0:U.response)==null?void 0:L.status;x(z===403?"Access denied for Departments.":z===401?"Session expired. Please login again.":((V=(F=U==null?void 0:U.response)==null?void 0:F.data)==null?void 0:V.detail)||"Failed to load departments.")}finally{_(!1)}}},[s]);y.useEffect(()=>{P()},[P]);const R=async L=>{var F,V,U;if(L.preventDefault(),!(!u&&!n)&&!(u&&!a)){w(!0),x("");try{u?await J.put(`/departments/${u}`,c):await J.post("/departments/",c),d({name:"",description:""}),f(null),P()}catch(z){const W=(F=z==null?void 0:z.response)==null?void 0:F.status;x(W===403?"Access denied.":W===401?"Session expired. Please login again.":((U=(V=z==null?void 0:z.response)==null?void 0:V.data)==null?void 0:U.detail)||"Failed to save department.")}finally{w(!1)}}},I=async L=>{var F,V,U;if(i&&window.confirm("Delete this department?"))try{await J.delete(`/departments/${L}`),P()}catch(z){const W=(F=z==null?void 0:z.response)==null?void 0:F.status;x(W===403?"Access denied.":W===401?"Session expired. Please login again.":((U=(V=z==null?void 0:z.response)==null?void 0:V.data)==null?void 0:U.detail)||"Failed to delete department.")}},O=L=>{a&&(f(L.id),d({name:L.name,description:L.description||""}))},M=()=>{f(null),d({name:"",description:""})},B=y.useMemo(()=>(l||[]).filter(L=>{if(!L)return!1;const F=(L.name||"").toLowerCase(),V=(L.description||"").toLowerCase(),U=C.toLowerCase().trim();return!(U&&!`${F} ${V}`.includes(U)||A==="withDesc"&&!L.description||A==="withoutDesc"&&L.description)}),[l,C,A]);return!t||!s?r.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-4 md:px-6 md:py-6 lg:px-8",children:r.jsxs("div",{className:"mx-auto max-w-6xl space-y-4",children:[r.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-r from-slate-800 via-slate-700 to-slate-900 text-white shadow-md",children:[r.jsx("div",{className:"absolute inset-0 opacity-20 bg-[radial-gradient(circle_at_top,_#e5e7eb,_transparent_55%)]"}),r.jsxs("div",{className:"relative px-5 py-6 sm:px-7 sm:py-7 md:px-9 md:py-8 flex items-center gap-3",children:[r.jsx("div",{className:"inline-flex h-11 w-11 items-center justify-center rounded-3xl bg-white/10 border border-white/20",children:r.jsx(ra,{className:"w-6 h-6"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg md:text-xl font-semibold tracking-tight",children:"Departments module"}),r.jsx("p",{className:"mt-1 text-xs sm:text-sm text-slate-100/90",children:"Configure clinical and support departments for your hospital."})]})]})]}),r.jsxs(We,{className:"rounded-3xl border-amber-200 bg-amber-50 shadow-sm",children:[r.jsx(st,{children:r.jsx(lt,{className:"text-base text-amber-900",children:"Access restricted"})}),r.jsx(qe,{children:r.jsxs(Vc,{className:"border-amber-200 bg-amber-50 text-amber-900 rounded-2xl",children:[r.jsx(Hc,{className:"font-semibold",children:"You dont have permission"}),r.jsx(Wc,{className:"text-sm",children:"Your role does not currently include access to the Departments configuration. Please contact the system administrator if you believe this is a mistake."})]})})]})]})}):r.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-4 md:px-6 md:py-6 lg:px-8",children:r.jsxs("div",{className:"mx-auto max-w-6xl space-y-4 md:space-y-5 lg:space-y-6",children:[r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 text-xs",children:[r.jsx(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-white px-2.5 py-1 text-[11px] font-medium tracking-wide text-slate-700",children:"Admin  Departments"}),r.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-slate-500",children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 shadow-sm animate-pulse"}),r.jsx("span",{className:"hidden sm:inline",children:"Desktop workspace"}),r.jsx("span",{className:"sm:hidden",children:"Responsive view"})]})]}),r.jsx(Nt.div,{...T0,children:r.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-r from-teal-700 via-teal-600 to-blue-600 text-white shadow-md",children:[r.jsx("div",{className:"absolute inset-0 opacity-25 pointer-events-none bg-[radial-gradient(circle_at_top,_#e0f2fe,_transparent_55%)]"}),r.jsxs("div",{className:"relative flex flex-col gap-4 md:flex-row md:items-center md:justify-between px-4 py-5 sm:px-6 sm:py-6 md:px-8 md:py-7 lg:px-10 lg:py-8",children:[r.jsxs("div",{className:"space-y-3 max-w-xl",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-white/10 px-3 py-1 text-xs font-medium backdrop-blur-sm border border-white/20",children:[r.jsx("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-white/20 text-[11px]",children:r.jsx(ra,{className:"w-3.5 h-3.5"})}),"Core clinical & support structure"]}),r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"inline-flex h-11 w-11 md:h-12 md:w-12 items-center justify-center rounded-3xl bg-white/10 text-white shadow-sm border border-white/20",children:r.jsx(ra,{className:"w-6 h-6"})}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("h1",{className:"text-xl md:text-2xl lg:text-3xl font-semibold tracking-tight",children:"Clinical & Support Departments"}),r.jsxs("p",{className:"text-sm md:text-base text-teal-50/90 leading-relaxed",children:["Configure ",r.jsx("span",{className:"font-semibold",children:"OPD, IPD, diagnostics and support"})," departments so that doctors, staff and services stay aligned across your hospital."]})]})]})]}),r.jsxs("div",{className:"w-full md:w-auto space-y-3",children:[r.jsxs("div",{className:"flex flex-wrap gap-2 justify-start md:justify-end",children:[r.jsx(Ge,{className:"bg-white/15 text-xs font-semibold border border-white/25 text-white rounded-full px-3 py-1",children:"Master configuration"}),r.jsx(Ge,{className:"bg-white/10 text-xs border border-white/20 text-teal-50 rounded-full px-3 py-1",children:"Used by OPD / IPD / Lab / OT"})]}),r.jsx("div",{className:"grid grid-cols-1 gap-2 md:min-w-[220px]",children:r.jsx(gce,{label:"Departments",value:l.length,hint:"Mapped across OPD, IPD, lab, radiology, etc."})})]})]})]})}),m&&r.jsx(Nt.div,{...T0,children:r.jsxs(Vc,{className:"rounded-2xl border-red-200 bg-red-50 text-red-800",children:[r.jsx(Hc,{className:"font-semibold",children:"Issue"}),r.jsx(Wc,{className:"text-sm",children:m})]})}),r.jsxs("div",{className:"grid items-start gap-4 lg:grid-cols-[minmax(0,260px)_minmax(0,1fr)]",children:[r.jsx(Nt.div,{...T0,children:r.jsxs(We,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsxs(st,{className:"pb-3",children:[r.jsx(lt,{className:"text-sm font-semibold text-slate-900",children:u?"Edit department":"Create department"}),r.jsx("p",{className:"mt-1 text-xs text-slate-600",children:"Add or update hospital departments that will be used across modules."})]}),r.jsx(qe,{children:r.jsxs("form",{onSubmit:R,className:"space-y-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("label",{className:"text-xs font-medium text-slate-800",children:["Department name",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx(Ee,{placeholder:"e.g., General Medicine",value:c.name,onChange:L=>d({...c,name:L.target.value}),required:!0,disabled:!(u?a:n),className:"h-9 rounded-xl border-slate-200 bg-slate-50 text-sm text-slate-900 focus-visible:ring-2 focus-visible:ring-teal-100 focus-visible:border-teal-500"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("label",{className:"text-xs font-medium text-slate-800",children:["Description",r.jsx("span",{className:"text-slate-400",children:" (optional)"})]}),r.jsx(Ee,{placeholder:"Short description to help staff identify this department",value:c.description,onChange:L=>d({...c,description:L.target.value}),disabled:!(u?a:n),className:"h-9 rounded-xl border-slate-200 bg-slate-50 text-sm text-slate-900 focus-visible:ring-2 focus-visible:ring-teal-100 focus-visible:border-teal-500"})]}),r.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[u&&r.jsx("button",{type:"button",onClick:M,className:"text-xs text-slate-500 underline underline-offset-2",children:"Cancel edit & reset"}),r.jsx(Re,{type:"submit",className:"ml-auto rounded-full bg-blue-600 px-4 py-2 text-xs sm:text-sm font-semibold text-white hover:bg-blue-700 active:scale-95",disabled:b||(u?!a:!n),children:b?"Saving":u?"Update department":"Create department"})]})]})})]})}),r.jsx(Nt.div,{...T0,children:r.jsxs(We,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsxs(st,{className:"border-b border-slate-100 pb-3",children:[r.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{children:[r.jsx(lt,{className:"text-sm font-semibold text-slate-900",children:"Department list"}),r.jsxs("p",{className:"mt-1 text-[11px] text-slate-500",children:[l.length," configured department",l.length===1?"":"s","."]})]}),r.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:items-center sm:justify-end",children:[r.jsxs("div",{className:"relative w-full sm:w-52",children:[r.jsx(is,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-slate-400"}),r.jsx("input",{type:"text",value:C,onChange:L=>k(L.target.value),placeholder:"Search by name or description",className:"w-full rounded-xl border border-slate-200 bg-slate-50 pl-8 pr-3 py-1.5 text-xs sm:text-sm text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500"})]}),n&&r.jsxs(Re,{type:"button",onClick:M,className:"inline-flex items-center justify-center gap-1.5 rounded-full bg-blue-600 px-3 py-1.5 text-xs sm:text-sm font-semibold text-white hover:bg-blue-700 active:scale-95",children:[r.jsx(us,{className:"w-3.5 h-3.5"}),"New department"]})]})]}),r.jsx("div",{className:"mt-3 flex flex-wrap gap-1.5",children:[{key:"all",label:"All"},{key:"withDesc",label:"With description"},{key:"withoutDesc",label:"Without description"}].map(L=>r.jsx("button",{type:"button",onClick:()=>T(L.key),className:["inline-flex items-center rounded-full px-3 py-1 text-[11px] sm:text-xs transition",A===L.key?"bg-blue-600 text-white shadow-sm":"bg-slate-100 text-slate-600 hover:bg-slate-200"].join(" "),children:L.label},L.key))})]}),r.jsx(qe,{className:"pt-4",children:j?r.jsx("div",{className:"space-y-2",children:[0,1,2].map(L=>r.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-3",children:[r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsx(Je,{className:"h-3 w-1/3 rounded-full bg-slate-100"}),r.jsx(Je,{className:"h-2.5 w-1/2 rounded-full bg-slate-100"})]}),r.jsx(Je,{className:"h-6 w-20 rounded-full bg-slate-100"})]},L))}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"hidden md:block",children:r.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:r.jsxs("table",{className:"min-w-full text-xs",children:[r.jsx("thead",{className:"bg-slate-50 text-[11px] font-medium text-slate-600",children:r.jsxs("tr",{children:[r.jsx("th",{className:"p-2 text-left",children:"#"}),r.jsx("th",{className:"p-2 text-left",children:"Name"}),r.jsx("th",{className:"p-2 text-left",children:"Description"}),r.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[B.map((L,F)=>r.jsxs("tr",{className:"border-t border-slate-100 text-xs text-slate-800 hover:bg-slate-50/80 transition-colors",children:[r.jsx("td",{className:"p-2 align-top",children:F+1}),r.jsx("td",{className:"p-2 align-top font-semibold text-slate-900",children:L.name}),r.jsx("td",{className:"p-2 align-top text-slate-500",children:r.jsx("span",{className:"line-clamp-2 text-[11px]",children:L.description||""})}),r.jsx("td",{className:"p-2 align-top text-right",children:r.jsxs("div",{className:"inline-flex gap-2",children:[a&&r.jsx(Re,{type:"button",variant:"outline",size:"sm",className:"h-7 rounded-full border-slate-200 px-3 text-[11px] font-semibold text-slate-700 hover:bg-slate-50",onClick:()=>O(L),children:"Edit"}),i&&r.jsx(Re,{type:"button",variant:"outline",size:"sm",className:"h-7 rounded-full border border-rose-200 px-3 text-[11px] font-semibold text-rose-700 hover:bg-rose-50",onClick:()=>I(L.id),children:"Delete"})]})})]},L.id)),!B.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:4,className:"p-4",children:r.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-4 py-5 text-center",children:[r.jsx("p",{className:"text-sm font-medium text-slate-700",children:"No departments match your filters."}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Adjust search or filter, or create a new department from the left panel."})]})})})]})]})})}),r.jsxs("div",{className:"grid gap-3 md:hidden",children:[B.map((L,F)=>r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm flex flex-col gap-2",children:[r.jsx("div",{className:"flex items-start justify-between gap-2",children:r.jsxs("div",{className:"space-y-0.5",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"inline-flex h-5 w-5 items-center justify-center rounded-full bg-slate-100 text-[11px] text-slate-600",children:F+1}),r.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:L.name})]}),r.jsx("p",{className:"text-[11px] text-slate-600 line-clamp-2",children:L.description||"No description"})]})}),r.jsxs("div",{className:"flex items-center justify-end gap-2 pt-1",children:[a&&r.jsx("button",{type:"button",onClick:()=>O(L),className:"inline-flex items-center rounded-full border border-slate-200 px-3 py-1 text-[11px] font-semibold text-slate-700 hover:bg-slate-50",children:"Edit"}),i&&r.jsx("button",{type:"button",onClick:()=>I(L.id),className:"inline-flex items-center rounded-full border border-rose-200 px-3 py-1 text-[11px] font-semibold text-rose-700 hover:bg-rose-50",children:"Delete"})]})]},L.id)),!B.length&&r.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-4 py-5 text-center",children:[r.jsx("p",{className:"text-sm font-medium text-slate-700",children:"No departments match your filters."}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Adjust search or filters, or create a new department from the form above."})]})]})]})})]})})]})]})})}function gce({label:t,value:s,hint:n}){return r.jsxs(Nt.div,{whileHover:{y:-2,scale:1.01},transition:{type:"spring",stiffness:240,damping:22},className:"rounded-2xl border border-white/40 bg-white/10 px-3 py-2 text-[11px] text-teal-50/90",children:[r.jsx("div",{className:"text-[10px] font-medium uppercase tracking-wide text-teal-100/90",children:t}),r.jsx("div",{className:"mt-1 text-sm font-semibold text-white",children:s}),n&&r.jsx("div",{className:"mt-0.5 text-[10px] text-teal-100/80",children:n})]})}const P0={initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.18}};function yce(){const{hasAny:t,canView:s,canCreate:n,canUpdate:a,canDelete:i}=Rb("roles"),[l,o]=y.useState([]),[c,d]=y.useState([]),[u,f]=y.useState({name:"",description:"",permission_ids:[]}),[m,x]=y.useState(null),[b,w]=y.useState(!1),[j,_]=y.useState(!1),[C,k]=y.useState(""),[A,T]=y.useState(""),[P,R]=y.useState("all"),I=y.useCallback(async()=>{var U,z,W;if(s){k(""),_(!0);try{const[q,G]=await Promise.all([J.get("/roles/"),J.get("/permissions/")]);o(q.data||[]),d(G.data||[])}catch(q){const G=(U=q==null?void 0:q.response)==null?void 0:U.status;k(G===403?"Access denied for Roles.":G===401?"Session expired. Please login again.":((W=(z=q==null?void 0:q.response)==null?void 0:z.data)==null?void 0:W.detail)||"Failed to load roles.")}finally{_(!1)}}},[s]);y.useEffect(()=>{I()},[I]);const O=U=>{f(z=>({...z,permission_ids:z.permission_ids.includes(U)?z.permission_ids.filter(W=>W!==U):[...z.permission_ids,U]}))},M=()=>{x(null),f({name:"",description:"",permission_ids:[]})},B=async U=>{var z,W,q;if(U.preventDefault(),!(!m&&!n)&&!(m&&!a)){w(!0),k("");try{m?await J.put(`/roles/${m}`,u):await J.post("/roles/",u),M(),I()}catch(G){const se=(z=G==null?void 0:G.response)==null?void 0:z.status;k(se===403?"Access denied.":se===401?"Session expired. Please login again.":((q=(W=G==null?void 0:G.response)==null?void 0:W.data)==null?void 0:q.detail)||"Failed to save role.")}finally{w(!1)}}},L=U=>{a&&(x(U.id),f({name:U.name,description:U.description||"",permission_ids:U.permission_ids||[]}))},F=async U=>{var z,W,q;if(i&&window.confirm("Delete this role?"))try{await J.delete(`/roles/${U}`),I()}catch(G){const se=(z=G==null?void 0:G.response)==null?void 0:z.status;k(se===403?"Access denied.":se===401?"Session expired. Please login again.":((q=(W=G==null?void 0:G.response)==null?void 0:W.data)==null?void 0:q.detail)||"Failed to delete role.")}},V=y.useMemo(()=>(l||[]).filter(U=>{var se;if(!U)return!1;const z=(U.name||"").toLowerCase(),W=(U.description||"").toLowerCase(),q=A.toLowerCase().trim();if(q&&!`${z} ${W}`.includes(q))return!1;const G=((se=U.permission_ids)==null?void 0:se.length)||0;return!(P==="withPerms"&&G===0||P==="noPerms"&&G>0)}),[l,A,P]);return!t||!s?r.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-4 md:px-6 md:py-6 lg:px-8",children:r.jsxs("div",{className:"mx-auto max-w-6xl space-y-4",children:[r.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-r from-slate-800 via-slate-700 to-slate-900 text-white shadow-md",children:[r.jsx("div",{className:"absolute inset-0 opacity-20 bg-[radial-gradient(circle_at_top,_#e5e7eb,_transparent_55%)]"}),r.jsxs("div",{className:"relative px-5 py-6 sm:px-7 sm:py-7 md:px-9 md:py-8 flex items-center gap-3",children:[r.jsx("div",{className:"inline-flex h-11 w-11 items-center justify-center rounded-3xl bg-white/10 border border-white/20",children:r.jsx(Aa,{className:"w-6 h-6"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl md:text-2xl font-semibold tracking-tight",children:"Roles & Permissions"}),r.jsx("p",{className:"mt-1 text-sm text-slate-100/90",children:"Manage access profiles and permission sets across modules."})]})]})]}),r.jsxs(We,{className:"rounded-3xl border-amber-200 bg-amber-50 shadow-sm",children:[r.jsx(st,{children:r.jsx(lt,{className:"text-base font-semibold text-amber-900",children:"Access restricted"})}),r.jsx(qe,{children:r.jsxs(Vc,{className:"border-amber-200 bg-amber-50 text-amber-900 rounded-2xl",children:[r.jsx(Hc,{className:"font-semibold",children:"You dont have permission"}),r.jsx(Wc,{className:"text-sm",children:"Your role does not currently include access to the Roles module. Please contact the system administrator if you believe this is a mistake."})]})})]})]})}):r.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-4 md:px-6 md:py-6 lg:px-8",children:r.jsxs("div",{className:"mx-auto max-w-6xl space-y-4 md:space-y-5 lg:space-y-6",children:[r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 text-sm",children:[r.jsx(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-white px-3 py-1 text-xs font-semibold tracking-wide text-slate-700",children:"Admin  Roles & permissions"}),r.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 shadow-sm animate-pulse"}),r.jsx("span",{className:"hidden sm:inline",children:"Desktop workspace"}),r.jsx("span",{className:"sm:hidden",children:"Responsive view"})]})]}),r.jsx(Nt.div,{...P0,children:r.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-r from-teal-700 via-teal-600 to-blue-600 text-white shadow-md",children:[r.jsx("div",{className:"absolute inset-0 opacity-25 pointer-events-none bg-[radial-gradient(circle_at_top,_#e0f2fe,_transparent_55%)]"}),r.jsxs("div",{className:"relative flex flex-col gap-4 md:flex-row md:items-center md:justify-between px-4 py-5 sm:px-6 sm:py-6 md:px-8 md:py-7 lg:px-10 lg:py-8",children:[r.jsxs("div",{className:"space-y-3 max-w-xl",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-white/10 px-3 py-1 text-xs font-semibold backdrop-blur-sm border border-white/20",children:[r.jsx("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-white/20 text-[11px]",children:r.jsx(Aa,{className:"w-3.5 h-3.5"})}),"Centralised access control"]}),r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"inline-flex h-12 w-12 items-center justify-center rounded-3xl bg-white/10 text-white shadow-sm border border-white/20",children:r.jsx(El,{className:"w-6 h-6"})}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("h1",{className:"text-2xl md:text-3xl font-semibold tracking-tight",children:"Roles & Permission Sets"}),r.jsxs("p",{className:"text-sm md:text-base text-teal-50/90 leading-relaxed",children:["Define reusable ",r.jsx("span",{className:"font-semibold",children:"roles"})," and attach granular ",r.jsx("span",{className:"font-semibold",children:"permission codes"})," for OPD, IPD, pharmacy, lab, billing, OT, and more."]})]})]})]}),r.jsxs("div",{className:"w-full md:w-auto space-y-3",children:[r.jsxs("div",{className:"flex flex-wrap gap-2 justify-start md:justify-end",children:[r.jsx(Ge,{className:"bg-white/15 text-xs font-semibold border border-white/25 text-white rounded-full px-3 py-1",children:"RBAC ready"}),r.jsx(Ge,{className:"bg-white/10 text-xs border border-white/20 text-teal-50 rounded-full px-3 py-1",children:"Multi-module permissions"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 md:min-w-[260px]",children:[r.jsx($P,{label:"Roles",value:l.length,hint:"Reusable access profiles"}),r.jsx($P,{label:"Permissions",value:c.length,hint:"Atomic permission codes"})]})]})]})]})}),C&&r.jsx(Nt.div,{...P0,children:r.jsxs(Vc,{className:"rounded-2xl border-red-200 bg-red-50 text-red-800",children:[r.jsx(Hc,{className:"font-semibold text-sm",children:"Issue"}),r.jsx(Wc,{className:"text-sm",children:C})]})}),r.jsxs("div",{className:"grid items-start gap-4 lg:grid-cols-[minmax(0,320px)_minmax(0,1fr)]",children:[r.jsx(Nt.div,{...P0,children:r.jsxs(We,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsx(st,{className:"pb-3",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-2xl bg-slate-900 text-slate-50",children:r.jsx(El,{className:"h-4 w-4"})}),r.jsxs("div",{children:[r.jsx(lt,{className:"text-base sm:text-lg font-semibold text-slate-900",children:m?"Edit role":"Create role"}),r.jsx("p",{className:"mt-1 text-xs sm:text-sm text-slate-600",children:"Group permissions into named roles and assign them to users."})]})]})}),r.jsx(qe,{className:"space-y-4",children:r.jsxs("form",{onSubmit:B,className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-sm font-semibold text-slate-800",children:["Role name",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx(Ee,{placeholder:"e.g., OPD Doctor, IPD Nurse",value:u.name,onChange:U=>f({...u,name:U.target.value}),required:!0,disabled:!(m?a:n),className:"h-10 rounded-xl border-slate-200 bg-slate-50 text-sm text-slate-900 focus-visible:ring-2 focus-visible:ring-teal-100 focus-visible:border-teal-500"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-sm font-semibold text-slate-800",children:["Description",r.jsx("span",{className:"text-slate-400 font-normal",children:" (optional)"})]}),r.jsx(Ee,{placeholder:"Short description (e.g., OPD-only consulting doctor)",value:u.description,onChange:U=>f({...u,description:U.target.value}),disabled:!(m?a:n),className:"h-10 rounded-xl border-slate-200 bg-slate-50 text-sm text-slate-900 focus-visible:ring-2 focus-visible:ring-teal-100 focus-visible:border-teal-500"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm font-semibold text-slate-800",children:"Permissions"}),r.jsxs("span",{className:"text-xs text-slate-500",children:[u.permission_ids.length||0," selected"]})]}),r.jsxs("div",{className:"max-h-64 space-y-1 overflow-y-auto rounded-2xl border border-slate-100 bg-slate-50 px-2 py-2",children:[c.map(U=>r.jsxs("label",{className:`flex cursor-pointer items-start gap-2 rounded-2xl px-2.5 py-1.5 text-xs transition-colors ${u.permission_ids.includes(U.id)?"bg-white shadow-sm":"bg-slate-50 hover:bg-white"}`,children:[r.jsx("input",{type:"checkbox",checked:u.permission_ids.includes(U.id),onChange:()=>O(U.id),disabled:!(m?a:n),className:"mt-0.5 h-3.5 w-3.5 rounded border-slate-300 text-teal-600"}),r.jsxs("span",{children:[r.jsx("span",{className:"block font-semibold text-slate-800",children:U.label}),r.jsx("span",{className:"block text-[11px] text-slate-500 font-mono",children:U.code})]})]},U.id)),!c.length&&!j&&r.jsx("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-3 py-2 text-xs text-slate-500",children:"No permissions configured yet."}),j&&r.jsx("div",{className:"space-y-2",children:[0,1,2].map(U=>r.jsxs("div",{className:"flex items-center gap-2 rounded-2xl px-2 py-1.5",children:[r.jsx(Je,{className:"h-3 w-3 rounded bg-slate-100"}),r.jsxs("div",{className:"flex-1 space-y-1",children:[r.jsx(Je,{className:"h-3 w-1/2 rounded-full bg-slate-100"}),r.jsx(Je,{className:"h-2 w-1/3 rounded-full bg-slate-100"})]})]},U))})]})]}),r.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[m&&r.jsx("button",{type:"button",onClick:M,className:"text-xs sm:text-sm text-slate-500 underline underline-offset-2 font-medium",children:"Cancel edit & reset"}),r.jsx(Re,{type:"submit",className:"ml-auto rounded-full bg-blue-600 px-4 py-2 text-xs sm:text-sm font-semibold text-white hover:bg-blue-700 active:scale-95",disabled:b||(m?!a:!n),children:b?"Saving":m?"Update role":"Create role"})]})]})})]})}),r.jsx(Nt.div,{...P0,children:r.jsxs(We,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsxs(st,{className:"border-b border-slate-100 pb-3",children:[r.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{children:[r.jsx(lt,{className:"text-base sm:text-lg font-semibold text-slate-900",children:"Role list"}),r.jsx("p",{className:"mt-1 text-xs sm:text-sm text-slate-600",children:"Overview of all defined roles and number of attached permissions."})]}),r.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:items-center sm:justify-end",children:[r.jsxs("div",{className:"relative w-full sm:w-56",children:[r.jsx(is,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),r.jsx("input",{type:"text",value:A,onChange:U=>T(U.target.value),placeholder:"Search by role name / description",className:"w-full rounded-xl border border-slate-200 bg-slate-50 pl-9 pr-3 py-2 text-xs sm:text-sm font-medium text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500"})]}),n&&r.jsxs(Re,{type:"button",onClick:M,className:"inline-flex items-center justify-center gap-1.5 rounded-full bg-blue-600 px-4 py-2 text-xs sm:text-sm font-semibold text-white hover:bg-blue-700 active:scale-95",children:[r.jsx(us,{className:"w-4 h-4"}),"New role"]})]})]}),r.jsx("div",{className:"mt-3 flex flex-wrap gap-1.5",children:[{key:"all",label:"All"},{key:"withPerms",label:"With permissions"},{key:"noPerms",label:"No permissions"}].map(U=>r.jsx("button",{type:"button",onClick:()=>R(U.key),className:["inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold transition",P===U.key?"bg-blue-600 text-white shadow-sm":"bg-slate-100 text-slate-600 hover:bg-slate-200"].join(" "),children:U.label},U.key))})]}),r.jsx(qe,{className:"pt-4",children:j?r.jsx("div",{className:"space-y-2",children:[0,1,2].map(U=>r.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-3",children:[r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsx(Je,{className:"h-3.5 w-1/3 rounded-full bg-slate-100"}),r.jsx(Je,{className:"h-3 w-1/4 rounded-full bg-slate-100"})]}),r.jsx(Je,{className:"h-8 w-24 rounded-full bg-slate-100"})]},U))}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"hidden md:block",children:r.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-slate-50 text-xs font-semibold text-slate-600 uppercase tracking-wide",children:r.jsxs("tr",{children:[r.jsx("th",{className:"p-2 text-left",children:"#"}),r.jsx("th",{className:"p-2 text-left",children:"Role name"}),r.jsx("th",{className:"p-2 text-left",children:"Description"}),r.jsx("th",{className:"p-2 text-left",children:"Permissions"}),r.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[V.map((U,z)=>{var W,q;return r.jsxs("tr",{className:"border-t border-slate-100 text-sm text-slate-800 hover:bg-slate-50/80 transition-colors",children:[r.jsx("td",{className:"p-2 align-top",children:z+1}),r.jsx("td",{className:"p-2 align-top font-semibold text-slate-900",children:U.name}),r.jsx("td",{className:"p-2 align-top text-slate-600",children:r.jsx("span",{className:"line-clamp-2 text-xs sm:text-sm",children:U.description||""})}),r.jsx("td",{className:"p-2 align-top text-slate-700",children:(((W=U.permission_ids)==null?void 0:W.length)||0)===0?r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2.5 py-0.5 text-xs font-medium text-slate-600",children:"No permissions"}):r.jsxs("span",{className:"inline-flex items-center rounded-full bg-teal-50 px-2.5 py-0.5 text-xs font-semibold text-teal-700 border border-teal-100",children:[((q=U.permission_ids)==null?void 0:q.length)||0," ",r.jsx("span",{className:"ml-1 hidden sm:inline",children:"permissions"})]})}),r.jsx("td",{className:"p-2 align-top text-right",children:r.jsxs("div",{className:"inline-flex gap-2",children:[a&&r.jsx(Re,{type:"button",size:"sm",className:"h-8 rounded-full bg-slate-900 px-3 text-xs font-semibold text-white hover:bg-slate-800",onClick:()=>L(U),children:"Edit"}),i&&r.jsx(Re,{type:"button",size:"sm",className:"h-8 rounded-full bg-rose-600 px-3 text-xs font-semibold text-white hover:bg-rose-700",onClick:()=>F(U.id),children:"Delete"})]})})]},U.id)}),!V.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"p-4",children:r.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-4 py-5 text-center",children:[r.jsx("p",{className:"text-sm font-semibold text-slate-700",children:"No roles match your filters."}),r.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Adjust search or filters, or create a new role using the form on the left."})]})})})]})]})})}),r.jsxs("div",{className:"grid gap-3 md:hidden",children:[V.map((U,z)=>{var W,q;return r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm flex flex-col gap-2",children:[r.jsx("div",{className:"flex items-start justify-between gap-2",children:r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"inline-flex h-5 w-5 items-center justify-center rounded-full bg-slate-100 text-xs font-semibold text-slate-600",children:z+1}),r.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:U.name})]}),r.jsx("p",{className:"text-xs text-slate-600 line-clamp-2",children:U.description||"No description"})]})}),r.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[r.jsx("div",{className:"text-xs text-slate-600",children:(((W=U.permission_ids)==null?void 0:W.length)||0)===0?r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2.5 py-0.5 font-medium",children:"No permissions"}):r.jsxs("span",{className:"inline-flex items-center rounded-full bg-teal-50 px-2.5 py-0.5 text-teal-700 border border-teal-100 font-semibold",children:[((q=U.permission_ids)==null?void 0:q.length)||0," perms"]})}),r.jsxs("div",{className:"flex items-center gap-2",children:[a&&r.jsx("button",{type:"button",onClick:()=>L(U),className:"inline-flex items-center rounded-full bg-slate-900 px-3 py-1 text-xs font-semibold text-white hover:bg-slate-800",children:"Edit"}),i&&r.jsx("button",{type:"button",onClick:()=>F(U.id),className:"inline-flex items-center rounded-full bg-rose-600 px-3 py-1 text-xs font-semibold text-white hover:bg-rose-700",children:"Delete"})]})]})]},U.id)}),!V.length&&r.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-4 py-5 text-center",children:[r.jsx("p",{className:"text-sm font-semibold text-slate-700",children:"No roles match your filters."}),r.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Adjust search or filters, or create a new role using the form above."})]})]})]})})]})})]})]})})}function $P({label:t,value:s,hint:n}){return r.jsxs(Nt.div,{whileHover:{y:-2,scale:1.01},transition:{type:"spring",stiffness:240,damping:22},className:"rounded-2xl border border-white/40 bg-white/10 px-3 py-2 text-xs text-teal-50/90",children:[r.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-teal-100/90",children:t}),r.jsx("div",{className:"mt-1 text-sm font-bold text-white",children:s}),n&&r.jsx("div",{className:"mt-0.5 text-[11px] text-teal-100/80",children:n})]})}function bce(){const{hasAny:t,canView:s,canCreate:n,canUpdate:a,canDelete:i}=Rb("permissions"),[l,o]=y.useState([]),[c,d]=y.useState({code:"",label:"",module:""}),[u,f]=y.useState(null),[m,x]=y.useState(!1),[b,w]=y.useState(""),j=y.useCallback(async()=>{var A,T,P;if(s){w("");try{const R=await J.get("/permissions/");o(R.data)}catch(R){const I=(A=R==null?void 0:R.response)==null?void 0:A.status;w(I===403?"Access denied for Permissions.":I===401?"Session expired. Please login again.":((P=(T=R==null?void 0:R.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to load")}}},[s]);y.useEffect(()=>{j()},[j]);const _=async A=>{var T,P;if(A.preventDefault(),!(!u&&!n)&&!(u&&!a)){x(!0),w("");try{u?await J.put(`/permissions/${u}`,c):await J.post("/permissions/",c),d({code:"",label:"",module:""}),f(null),j()}catch(R){w(((P=(T=R==null?void 0:R.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to save")}finally{x(!1)}}},C=async A=>{var T,P;if(i&&confirm("Delete this permission?"))try{await J.delete(`/permissions/${A}`),j()}catch(R){w(((P=(T=R==null?void 0:R.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to delete")}},k=A=>{a&&(f(A.id),d({code:A.code,label:A.label,module:A.module}))};return!t||!s?r.jsxs("section",{className:"card",children:[r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Permissions"}),r.jsx("div",{className:"rounded-xl border border-amber-200 bg-amber-50 p-3 text-sm text-amber-700",children:"You dont have access to view this module."})]}):r.jsxs("section",{className:"card text-black",children:[r.jsx("div",{className:"flex items-center justify-between mb-4",children:r.jsx("h3",{className:"text-lg font-semibold",children:"Permissions"})}),r.jsxs("form",{onSubmit:_,className:"grid md:grid-cols-4 gap-3 mb-4",children:[r.jsx("input",{className:"input",placeholder:"code (e.g. users.view)",value:c.code,onChange:A=>d({...c,code:A.target.value}),required:!0,disabled:!(u?a:n)}),r.jsx("input",{className:"input",placeholder:"label (Users  View)",value:c.label,onChange:A=>d({...c,label:A.target.value}),required:!0,disabled:!(u?a:n)}),r.jsx("input",{className:"input",placeholder:"module (users)",value:c.module,onChange:A=>d({...c,module:A.target.value}),required:!0,disabled:!(u?a:n)}),r.jsx("button",{className:"btn",disabled:m||(u?!a:!n),children:u?"Update":"Create"})]}),b&&r.jsx("div",{className:"mb-4 rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:b}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"text-left",children:[r.jsx("th",{className:"p-2",children:"#"}),r.jsx("th",{className:"p-2",children:"Code"}),r.jsx("th",{className:"p-2",children:"Label"}),r.jsx("th",{className:"p-2",children:"Module"}),r.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[l.map((A,T)=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"p-2",children:T+1}),r.jsx("td",{className:"p-2 font-mono text-xs",children:A.code}),r.jsx("td",{className:"p-2",children:A.label}),r.jsx("td",{className:"p-2",children:A.module}),r.jsxs("td",{className:"p-2 text-right space-x-2",children:[a&&r.jsx("button",{className:"px-3 py-2 rounded-xl border",onClick:()=>k(A),children:"Edit"}),i&&r.jsx("button",{className:"px-3 py-2 rounded-xl border",onClick:()=>C(A.id),children:"Delete"})]})]},A.id)),!l.length&&r.jsx("tr",{children:r.jsx("td",{className:"p-4 text-sm text-gray-500",colSpan:"5",children:"No permissions yet."})})]})]})})]})}const MN={initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.18}};function vce(){const{hasAny:t,canView:s,canCreate:n,canUpdate:a,canDelete:i}=Rb("users"),[l,o]=y.useState([]),[c,d]=y.useState([]),[u,f]=y.useState([]),[m,x]=y.useState({name:"",email:"",password:"",department_id:"",role_ids:[],is_doctor:!1,is_active:!0}),[b,w]=y.useState(null),[j,_]=y.useState(!1),[C,k]=y.useState(!1),[A,T]=y.useState(""),[P,R]=y.useState("all"),[I,O]=y.useState(""),[M,B]=y.useState(!1),L=b?a:n,F=y.useCallback(async()=>{var ue,ye,X;if(s){T(""),k(!0);try{const[oe,_e,ce]=await Promise.all([J.get("/users/"),J.get("/roles/").catch(()=>({data:[]})),J.get("/departments/").catch(()=>({data:[]}))]);o(oe.data||[]),d(_e.data||[]),f(ce.data||[])}catch(oe){const _e=(ue=oe==null?void 0:oe.response)==null?void 0:ue.status;T(_e===403?"Access denied for Users.":_e===401?"Session expired. Please login again.":((X=(ye=oe==null?void 0:oe.response)==null?void 0:ye.data)==null?void 0:X.detail)||"Failed to load users.")}finally{k(!1)}}},[s]);y.useEffect(()=>{F()},[F]);const V=y.useMemo(()=>{const ue={};return u.forEach(ye=>{ue[ye.id]=ye.name}),ue},[u]),U=ue=>{x(ye=>({...ye,role_ids:ye.role_ids.includes(ue)?ye.role_ids.filter(X=>X!==ue):[...ye.role_ids,ue]}))},z=()=>{x({name:"",email:"",password:"",department_id:"",role_ids:[],is_doctor:!1,is_active:!0}),w(null)},W=()=>{z(),B(!0)},q=ue=>{a&&(w(ue.id),x({name:ue.name||"",email:ue.email||"",password:"",department_id:ue.department_id||"",role_ids:ue.role_ids||[],is_doctor:!!ue.is_doctor,is_active:ue.is_active??!0}),B(!0))},G=()=>{B(!1)},se=async ue=>{var X,oe,_e;if(ue.preventDefault(),!b&&!n||b&&!a)return;_(!0),T("");const ye={...m,department_id:m.department_id?Number(m.department_id):null};try{b?await J.put(`/users/${b}`,ye):await J.post("/users/",ye),z(),B(!1),F()}catch(ce){const he=(X=ce==null?void 0:ce.response)==null?void 0:X.status;T(he===403?"Access denied.":he===401?"Session expired. Please login again.":((_e=(oe=ce==null?void 0:ce.response)==null?void 0:oe.data)==null?void 0:_e.detail)||"Failed to save user.")}finally{_(!1)}},ge=async ue=>{var ye,X,oe;if(i&&window.confirm("Delete this user?"))try{await J.delete(`/users/${ue}`),F()}catch(_e){const ce=(ye=_e==null?void 0:_e.response)==null?void 0:ye.status;T(ce===403?"Access denied.":ce===401?"Session expired. Please login again.":((oe=(X=_e==null?void 0:_e.response)==null?void 0:X.data)==null?void 0:oe.detail)||"Failed to delete user.")}},ke=y.useMemo(()=>l.filter(ue=>ue.is_doctor).length,[l]),ee=y.useMemo(()=>l.filter(ue=>ue.is_active).length,[l]),pe=y.useMemo(()=>{let ue=l;if(P==="doctors"&&(ue=ue.filter(ye=>ye.is_doctor)),I.trim()){const ye=I.toLowerCase();ue=ue.filter(X=>(X.name||"").toLowerCase().includes(ye)||(X.email||"").toLowerCase().includes(ye))}return ue},[l,P,I]);return!t||!s?r.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-4 md:px-6 md:py-6 lg:px-8",children:r.jsxs("div",{className:"mx-auto max-w-6xl space-y-4",children:[r.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-r from-teal-700 via-teal-600 to-blue-600 text-white shadow-md",children:[r.jsx("div",{className:"absolute inset-0 opacity-25 bg-[radial-gradient(circle_at_top,_#e0f2fe,_transparent_55%)]"}),r.jsxs("div",{className:"relative px-5 py-6 sm:px-7 sm:py-7 md:px-9 md:py-8 flex items-center gap-3",children:[r.jsx("div",{className:"inline-flex h-11 w-11 items-center justify-center rounded-3xl bg-white/10 border border-white/20",children:r.jsx(Fc,{className:"w-6 h-6"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg md:text-xl font-semibold tracking-tight",children:"Users & Doctors"}),r.jsx("p",{className:"mt-1 text-xs sm:text-sm text-teal-50/90",children:"Centralised staff management for OPD, IPD, diagnostics and support."})]})]})]}),r.jsxs(We,{className:"rounded-3xl border-amber-200 bg-amber-50 shadow-sm",children:[r.jsx(st,{children:r.jsx(lt,{className:"text-base text-amber-900",children:"Access restricted"})}),r.jsx(qe,{children:r.jsxs(Vc,{className:"border-amber-200 bg-amber-50 text-amber-900 rounded-2xl",children:[r.jsx(Hc,{className:"font-semibold",children:"You dont have permission"}),r.jsx(Wc,{className:"text-sm",children:"You dont have permission to view the Users module. Contact your administrator for access."})]})})]})]})}):r.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-4 md:px-6 md:py-6 lg:px-8",children:r.jsxs("div",{className:"mx-auto max-w-6xl space-y-4 md:space-y-5 lg:space-y-6",children:[r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 text-xs",children:[r.jsx(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-white px-2.5 py-1 text-[11px] font-medium tracking-wide text-slate-700",children:"Admin  User management"}),r.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-slate-500",children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 shadow-sm animate-pulse"}),r.jsx("span",{className:"hidden sm:inline",children:"Desktop workspace"}),r.jsx("span",{className:"sm:hidden",children:"Responsive view"})]})]}),r.jsx(Nt.div,{...MN,children:r.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-r from-teal-700 via-teal-600 to-blue-600 text-white shadow-md",children:[r.jsx("div",{className:"absolute inset-0 opacity-25 bg-[radial-gradient(circle_at_top,_#e0f2fe,_transparent_55%)]"}),r.jsxs("div",{className:"relative flex flex-col gap-4 md:flex-row md:items-center md:justify-between px-4 py-5 sm:px-6 sm:py-6 md:px-8 md:py-7 lg:px-10 lg:py-8",children:[r.jsxs("div",{className:"space-y-3 max-w-xl",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-white/10 px-3 py-1 text-xs font-medium backdrop-blur-sm border border-white/20",children:[r.jsx("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-white/20 text-[11px]",children:r.jsx(Fc,{className:"w-3.5 h-3.5"})}),"Staff & access directory"]}),r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"inline-flex h-11 w-11 md:h-12 md:w-12 items-center justify-center rounded-3xl bg-white/10 text-white shadow-sm border border-white/20",children:r.jsx(b4,{className:"w-6 h-6"})}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("h1",{className:"text-xl md:text-2xl lg:text-3xl font-semibold tracking-tight",children:"Users & Doctors Management"}),r.jsxs("p",{className:"text-sm md:text-base text-teal-50/90 leading-relaxed",children:["Create staff accounts, map them to"," ",r.jsx("span",{className:"font-semibold",children:"departments"}),", attach"," ",r.jsx("span",{className:"font-semibold",children:"roles"})," and mark doctors for OPD/IPD routing."]})]})]})]}),r.jsxs("div",{className:"w-full md:w-auto space-y-3",children:[r.jsxs("div",{className:"flex flex-wrap gap-2 justify-start md:justify-end",children:[r.jsx(Ge,{className:"bg-white/15 text-xs font-semibold border border-white/25 text-white rounded-full px-3 py-1",children:"Multi-module access"}),r.jsx(Ge,{className:"bg-white/10 text-xs border border-white/20 text-teal-50 rounded-full px-3 py-1",children:"OPD / IPD ready"})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 md:min-w-[260px]",children:[r.jsx(DN,{label:"Total users",value:l.length}),r.jsx(DN,{label:"Doctors",value:ke}),r.jsx(DN,{label:"Active users",value:ee})]})]})]})]})}),A&&r.jsx(Nt.div,{...MN,children:r.jsxs(Vc,{className:"rounded-2xl border-red-200 bg-red-50 text-red-800",children:[r.jsx(Hc,{className:"font-semibold",children:"Issue"}),r.jsx(Wc,{className:"text-sm",children:A})]})}),r.jsx(Nt.div,{...MN,children:r.jsxs(We,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsxs(st,{className:"border-b border-slate-100 pb-3",children:[r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{children:[r.jsx(lt,{className:"text-sm sm:text-base font-semibold text-slate-900",children:"User directory"}),r.jsxs("p",{className:"mt-1 text-[11px] text-slate-500",children:[pe.length," of ",l.length," records visible in this view."]})]}),r.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:items-center sm:justify-end",children:[r.jsxs("div",{className:"relative w-full sm:w-60",children:[r.jsx(is,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-slate-400"}),r.jsx("input",{type:"text",value:I,onChange:ue=>O(ue.target.value),placeholder:"Search by name or email",className:"w-full rounded-xl border border-slate-200 bg-slate-50 pl-8 pr-3 py-1.5 text-xs sm:text-sm text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500"})]}),n&&r.jsxs(Re,{type:"button",onClick:W,className:"inline-flex items-center justify-center gap-1.5 rounded-full bg-blue-600 px-3 py-1.5 text-xs sm:text-sm font-semibold text-white hover:bg-blue-700 active:scale-95",children:[r.jsx(b4,{className:"w-3.5 h-3.5"}),"New user"]})]})]}),r.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-2.5 py-1 text-[10px] font-medium text-slate-600",children:[r.jsx(Ei,{className:"h-3 w-3"}),r.jsx("span",{children:"Filter"})]}),r.jsx("button",{type:"button",onClick:()=>R("all"),className:`inline-flex items-center rounded-full px-3 py-1 text-[11px] sm:text-xs transition ${P==="all"?"bg-blue-600 text-white shadow-sm":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"All users"}),r.jsxs("button",{type:"button",onClick:()=>R("doctors"),className:`inline-flex items-center gap-1 rounded-full px-3 py-1 text-[11px] sm:text-xs transition ${P==="doctors"?"bg-blue-600 text-white shadow-sm":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:[r.jsx(_s,{className:"h-3.5 w-3.5"}),"Doctors only"]})]})]}),r.jsx(qe,{className:"pt-4",children:C?r.jsx(Nce,{}):pe.length===0?r.jsx(wce,{title:"No users match this view"}):r.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",children:pe.map((ue,ye)=>{const X=c.filter(_e=>(ue.role_ids||[]).includes(_e.id)).map(_e=>_e.name),oe=(ue.name||"?").split(" ").map(_e=>_e[0]).join("").slice(0,2).toUpperCase();return r.jsxs(Nt.div,{whileHover:{y:-2,scale:1.01},transition:{duration:.15,ease:"easeOut"},className:"flex flex-col justify-between rounded-2xl border border-slate-200 bg-slate-50 px-3.5 py-3.5 shadow-sm",children:[r.jsxs("div",{className:"flex items-start justify-between gap-2",children:[r.jsxs("div",{className:"flex items-start gap-2.5",children:[r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"h-9 w-9 rounded-full bg-slate-200 flex items-center justify-center text-xs font-semibold text-slate-800",children:oe}),ue.is_doctor&&r.jsx("span",{className:"absolute -top-0.5 -right-0.5 h-2.5 w-2.5 rounded-full bg-emerald-500 ring-2 ring-slate-50"})]}),r.jsxs("div",{className:"space-y-0.5",children:[r.jsx("div",{className:"text-sm font-semibold text-slate-900",children:ue.name}),r.jsx("div",{className:"text-[11px] text-slate-500",children:X.length?X.join(", "):"No roles"})]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-1",children:[ue.is_active?r.jsx("span",{className:"inline-flex items-center rounded-full bg-emerald-50 px-2 py-0.5 text-[10px] font-semibold text-emerald-700",children:"ACTIVE"}):r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2 py-0.5 text-[10px] font-semibold text-slate-600",children:"INACTIVE"}),ue.is_admin&&r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-900 px-2 py-0.5 text-[10px] font-semibold text-white",children:"ADMIN"}),ue.is_doctor&&r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-sky-50 px-2 py-0.5 text-[10px] font-semibold text-sky-700",children:[r.jsx(_s,{className:"h-3 w-3"}),"DOCTOR"]})]})]}),r.jsxs("div",{className:"mt-3 space-y-1.5 text-[11px] text-slate-600",children:[r.jsxs("div",{className:"flex justify-between gap-2",children:[r.jsx("span",{className:"text-slate-400",children:"DEPARTMENT"}),r.jsx("span",{className:"font-medium text-slate-700",children:V[ue.department_id]||"-"})]}),r.jsxs("div",{className:"flex justify-between gap-2",children:[r.jsx("span",{className:"text-slate-400",children:"EMAIL"}),r.jsx("span",{className:"max-w-[60%] truncate text-right",children:ue.email})]})]}),r.jsxs("div",{className:"mt-3 flex justify-between gap-2",children:[a&&r.jsx(Re,{type:"button",variant:"outline",size:"sm",className:"flex-1 h-8 rounded-full border-slate-200 text-[11px] font-semibold text-slate-700 hover:bg-slate-50",onClick:()=>q(ue),children:"Edit"}),i&&r.jsx(Re,{type:"button",variant:"outline",size:"sm",className:"flex-1 h-8 rounded-full border border-rose-200 text-[11px] font-semibold text-rose-700 hover:bg-rose-50",onClick:()=>ge(ue.id),children:"Delete"})]})]},ue.id)})})})]})}),r.jsx(Uc,{children:M&&r.jsx(jce,{isOpen:M,onClose:G,onSubmit:se,form:m,setForm:x,depts:u,roles:c,canEditOrCreate:L,loadingSave:j,editId:b,toggleRole:U})})]})})}function DN({label:t,value:s}){return r.jsxs(Nt.div,{whileHover:{y:-2,scale:1.01},transition:{type:"spring",stiffness:240,damping:22},className:"rounded-2xl border border-white/40 bg-white/10 px-3 py-2 text-[11px] text-teal-50/90",children:[r.jsx("div",{className:"text-[10px] font-medium uppercase tracking-wide text-teal-100/90",children:t}),r.jsx("div",{className:"mt-1 text-sm font-semibold text-white",children:s})]})}function wce({title:t}){return r.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-4 py-5 text-center",children:[r.jsx("p",{className:"text-sm font-semibold text-slate-700",children:t}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Try changing filters, clearing the search, or creating a new user."})]})}function Nce(){return r.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",children:[0,1,2,3,4,5].map(t=>r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3.5 py-3.5 shadow-sm",children:[r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx(Je,{className:"h-9 w-9 rounded-full bg-slate-100"}),r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsx(Je,{className:"h-3 w-1/2 rounded-full bg-slate-100"}),r.jsx(Je,{className:"h-2.5 w-2/3 rounded-full bg-slate-100"})]})]}),r.jsxs("div",{className:"mt-3 space-y-2",children:[r.jsx(Je,{className:"h-2.5 w-full rounded-full bg-slate-100"}),r.jsx(Je,{className:"h-2.5 w-5/6 rounded-full bg-slate-100"})]}),r.jsxs("div",{className:"mt-3 flex gap-2",children:[r.jsx(Je,{className:"h-8 w-full rounded-full bg-slate-100"}),r.jsx(Je,{className:"h-8 w-full rounded-full bg-slate-100"})]})]},t))})}function jce({isOpen:t,onClose:s,onSubmit:n,form:a,setForm:i,depts:l,roles:o,canEditOrCreate:c,loadingSave:d,editId:u,toggleRole:f}){if(!t)return null;const m=x=>{x.target===x.currentTarget&&s()};return r.jsx(Nt.div,{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black/40 backdrop-blur-sm",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onMouseDown:m,children:r.jsxs(Nt.div,{onMouseDown:x=>x.stopPropagation(),initial:{y:40,opacity:0},animate:{y:0,opacity:1},exit:{y:40,opacity:0},transition:{duration:.2,ease:"easeOut"},className:"w-full sm:max-w-lg bg-white rounded-t-3xl sm:rounded-2xl shadow-2xl max-h-[90vh] overflow-y-auto px-4 py-4 sm:px-6 sm:py-5",children:[r.jsxs("div",{className:"flex items-start justify-between gap-2 border-b border-slate-100 pb-3",children:[r.jsxs("div",{className:"space-y-0.5",children:[r.jsx("h2",{className:"text-base sm:text-lg font-semibold text-slate-900",children:u?"Edit user":"Add new user"}),r.jsx("p",{className:"text-xs sm:text-sm text-slate-500",children:"Fill basic details, map department and attach roles."})]}),r.jsx("button",{type:"button",onClick:s,className:"inline-flex h-7 w-7 items-center justify-center rounded-full border border-slate-200 bg-white text-slate-500 hover:bg-slate-100",children:r.jsx(Rn,{className:"h-3.5 w-3.5"})})]}),r.jsxs("form",{onSubmit:n,className:"mt-3 space-y-3",children:[r.jsxs("div",{className:"grid gap-2",children:[r.jsx(Ee,{placeholder:"Full name",value:a.name,onChange:x=>i({...a,name:x.target.value}),required:!0,disabled:!c,className:"h-9 rounded-xl border-slate-200 bg-slate-50 text-sm text-slate-900 focus-visible:ring-2 focus-visible:ring-teal-100 focus-visible:border-teal-500"}),r.jsx(Ee,{placeholder:"Email",type:"email",value:a.email,onChange:x=>i({...a,email:x.target.value}),required:!0,disabled:!c,className:"h-9 rounded-xl border-slate-200 bg-slate-50 text-sm text-slate-900 focus-visible:ring-2 focus-visible:ring-teal-100 focus-visible:border-teal-500"})]}),r.jsx(Ee,{placeholder:u?"Password (leave blank to keep)":"Password",type:"password",value:a.password,onChange:x=>i({...a,password:x.target.value}),required:!u,disabled:!c,className:"h-9 rounded-xl border-slate-200 bg-slate-50 text-sm text-slate-900 focus-visible:ring-2 focus-visible:ring-teal-100 focus-visible:border-teal-500"}),r.jsxs("div",{className:"space-y-1 text-xs",children:[r.jsx("label",{className:"font-medium text-slate-700",children:"Department"}),r.jsxs("select",{value:a.department_id,onChange:x=>i({...a,department_id:x.target.value}),disabled:!c,className:"h-9 w-full rounded-xl border border-slate-200 bg-slate-50 px-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500",children:[r.jsx("option",{value:"",children:"No department"}),l.map(x=>r.jsx("option",{value:x.id,children:x.name},x.id))]})]}),r.jsxs("div",{className:"flex flex-wrap gap-2 text-[11px]",children:[r.jsxs("label",{className:`inline-flex flex-1 min-w-[150px] cursor-pointer items-center gap-2 rounded-2xl border px-3 py-2 transition-colors ${a.is_doctor?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"}`,children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300",checked:a.is_doctor,onChange:x=>i({...a,is_doctor:x.target.checked}),disabled:!c}),r.jsxs("span",{className:"inline-flex items-center gap-1 text-slate-700",children:[r.jsx(_s,{className:"h-3.5 w-3.5 text-emerald-600"}),r.jsx("span",{children:"Mark as doctor"})]})]}),r.jsxs("label",{className:`inline-flex flex-1 min-w-[150px] cursor-pointer items-center gap-2 rounded-2xl border px-3 py-2 transition-colors ${a.is_active?"border-slate-300 bg-slate-50":"border-slate-200 bg-white hover:bg-slate-50"}`,children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300",checked:a.is_active,onChange:x=>i({...a,is_active:x.target.checked}),disabled:!c}),r.jsxs("span",{className:"inline-flex items-center gap-1 text-slate-700",children:[r.jsx(Aa,{className:"h-3.5 w-3.5 text-slate-700"}),r.jsx("span",{children:"Active user"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between text-[11px]",children:[r.jsx("span",{className:"font-medium text-slate-700",children:"Roles"}),r.jsxs("span",{className:"text-slate-400",children:[a.role_ids.length||0," selected"]})]}),r.jsxs("div",{className:"grid gap-1.5 sm:grid-cols-2 max-h-44 overflow-y-auto rounded-2xl border border-slate-100 bg-slate-50 px-2 py-2",children:[o.map(x=>r.jsxs("label",{className:`flex cursor-pointer items-center gap-2 rounded-2xl border px-2.5 py-2 text-[11px] transition-colors ${a.role_ids.includes(x.id)?"border-slate-300 bg-white":"border-slate-200 bg-slate-50 hover:bg-white"}`,children:[r.jsx("input",{type:"checkbox",checked:a.role_ids.includes(x.id),onChange:()=>f(x.id),disabled:!c,className:"h-3.5 w-3.5 rounded border-slate-300"}),r.jsx("span",{className:"text-slate-800",children:x.name})]},x.id)),!o.length&&r.jsx("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-3 py-2 text-[11px] text-slate-500",children:"No roles configured yet."})]})]}),r.jsxs("div",{className:"mt-2 flex items-center justify-end gap-2 pt-2 border-t border-slate-100",children:[r.jsx(Re,{type:"button",variant:"outline",className:"rounded-full border-slate-200 text-xs sm:text-sm font-semibold text-slate-700 hover:bg-slate-50",onClick:s,children:"Cancel"}),r.jsx(Re,{type:"submit",className:"rounded-full bg-blue-600 px-4 py-2 text-xs sm:text-sm font-semibold text-white hover:bg-blue-700 active:scale-95",disabled:d||!c,children:d?"Saving":u?"Update user":"Create user"})]})]})]})})}const _ce=(()=>{try{return JSON.parse(localStorage.getItem("sidebarCollapsed")||"false")}catch{return!1}})(),dB=u7(t=>({sidebarCollapsed:_ce,sidebarMobileOpen:!1,toggleCollapse:()=>t(s=>{const n=!s.sidebarCollapsed;return localStorage.setItem("sidebarCollapsed",JSON.stringify(n)),{sidebarCollapsed:n}}),openMobile:()=>t({sidebarMobileOpen:!0}),closeMobile:()=>t({sidebarMobileOpen:!1}),toggleMobile:()=>t(s=>({sidebarMobileOpen:!s.sidebarMobileOpen}))}));function Sce(){return J.get("/settings/ui-branding/public")}function Cce(){return J.get("/settings/ui-branding")}function kce(t){return J.put("/settings/ui-branding",t)}function Ace(t){return J.post("/settings/ui-branding/assets",t,{headers:{"Content-Type":"multipart/form-data"}})}function Ece(t){return J.post("/settings/ui-branding/letterhead",t,{headers:{"Content-Type":"multipart/form-data"}})}const uB=y.createContext({branding:null,setBranding:()=>{},loading:!0}),Tce="http://localhost:8000/api",Pce=Tce.replace(/\/api\/?$/,"");function Nl(t){if(!t)return;const s=String(t).trim();if(!s)return;if(/^https?:\/\//i.test(s))return s;if(s.startsWith("//"))return`${window.location.protocol}${s}`;const n=s.startsWith("/")?s:`/${s}`;return`${Pce}${n}`}function ON(t){if(!t)return null;const s={...t};return s.primary_color=s.primary_color||"#2563eb",s.primary_color_dark=s.primary_color_dark||null,s.sidebar_bg_color=s.sidebar_bg_color||"#ffffff",s.content_bg_color=s.content_bg_color||"#f9fafb",s.card_bg_color=s.card_bg_color||"#ffffff",s.border_color=s.border_color||"#e5e7eb",s.text_color=s.text_color||"#111827",s.text_muted_color=s.text_muted_color||"#e5e7eb",s.icon_color=s.icon_color||s.text_color||"#2563eb",s.icon_bg_color=s.icon_bg_color||"rgba(37,99,235,0.08)",s.logo_path&&!s.logo_url?s.logo_url=Nl(`/media/${String(s.logo_path).replace(/^\/+/,"")}`):s.logo_url&&(s.logo_url=Nl(s.logo_url)),s.login_logo_path&&!s.login_logo_url?s.login_logo_url=Nl(`/media/${String(s.login_logo_path).replace(/^\/+/,"")}`):s.login_logo_url&&(s.login_logo_url=Nl(s.login_logo_url)),s.favicon_path&&!s.favicon_url?s.favicon_url=Nl(`/media/${String(s.favicon_path).replace(/^\/+/,"")}`):s.favicon_url&&(s.favicon_url=Nl(s.favicon_url)),s.pdf_header_path&&!s.pdf_header_url?s.pdf_header_url=Nl(`/media/${String(s.pdf_header_path).replace(/^\/+/,"")}`):s.pdf_header_url&&(s.pdf_header_url=Nl(s.pdf_header_url)),s.pdf_footer_path&&!s.pdf_footer_url?s.pdf_footer_url=Nl(`/media/${String(s.pdf_footer_path).replace(/^\/+/,"")}`):s.pdf_footer_url&&(s.pdf_footer_url=Nl(s.pdf_footer_url)),s}function Ice({children:t}){const[s,n]=y.useState(null),[a,i]=y.useState(!0),l=o=>{n(typeof o=="function"?c=>ON(o(c)):ON(o))};return y.useEffect(()=>{let o=!0;return(async()=>{try{let d;try{d=(await Sce()).data}catch(f){console.warn("Public branding failed, falling back to /settings/ui-branding",f),d=(await Cce()).data}if(!o)return;console.log("[BrandingProvider] raw branding from API:",d);const u=ON(d);console.log("[BrandingProvider] normalized branding:",u),n(u)}catch(d){console.error("Failed to load branding",d),ie.error("Failed to load customization settings")}finally{o&&i(!1)}})(),()=>{o=!1}},[]),r.jsx(uB.Provider,{value:{branding:s,setBranding:l,loading:a},children:t})}function Pf(){return y.useContext(uB)}const Mce="#2563eb",Dce=t=>!t.startsWith("#")||t.length!==7?"#eff6ff":`${t}1A`,Oce=t=>!t.startsWith("#")||t.length!==7?"#bfdbfe":`${t}33`,Rce=[{key:"Dashboard",label:"Dashboard",icon:N0,flatLink:{to:"/dashboard",reqAny:["patients.view"]}},{key:"patients",label:"Patients management",icon:Fc,flatLink:{to:"/patients",reqAny:["patients.view","patients.create","patients.update"]}},{key:"patients masters",label:"Patients masters",icon:dr,flatLink:{to:"/patients/masters",reqAny:["patients.masters.view"]}},{key:"MIS",label:"MIS & Analytics",icon:Tte,flatLink:{to:"/mis",reqAny:["mis.view"]}},{key:"emr",label:"Patients EMR",icon:tl,flatLink:{to:"/emr",reqAny:["emr.view"]}},{key:"pharmacy",label:"Pharmacy",icon:Vr,items:[{key:"pharmacy-inventory",label:"Inventory & Stock",to:"/pharmacy/inventory",icon:bte,reqAny:["pharmacy.inventory.stock.view","pharmacy.inventory.items.view","pharmacy.inventory.po.view"]},{key:"pharmacy-barcode",label:"Barcode / QR Lookup",to:"/inventory/barcode-lookup",icon:Og,reqAny:["pharmacy.inventory.stock.view"]},{key:"pharmacy RX",label:"Pharmacy RX",to:"/pharmacy/rx",icon:p4,reqAny:["pharmacy.inventory.stock.view"]},{key:"pharmacy dispense",label:"Pharmacy Dispense",to:"/pharmacy/dispense",icon:Oy,reqAny:["pharmacy.inventory.stock.view"]}]},{key:"user-mgmt",label:"User Management",icon:Aa,items:[{key:"departments",label:"Departments",to:"/admin/departments",icon:ra,reqAny:["departments.view","departments.create","departments.update","departments.delete"]},{key:"roles",label:"Roles",to:"/admin/roles",icon:Aa,reqAny:["roles.view","roles.create","roles.update","roles.delete"]},{key:"users",label:"Users",to:"/admin/users",icon:Fc,reqAny:["users.view","users.create","users.update","users.delete"]}]},{key:"op",label:"OP",icon:_s,items:[{key:"op-dashboard",label:"Dashboard",to:"/opd/dashboard",icon:N0,reqAny:["appointments.view","mis.opd.view"]},{key:"appointments",label:"Appointments",to:"/opd/appointments",icon:h4,reqAny:["appointments.view","appointments.create"]},{key:"triage",label:"Vitals (Triage)",to:"/opd/triage",icon:sn,reqAny:["vitals.create"]},{key:"queue",label:"Queue",to:"/opd/queue",icon:Rse,reqAny:["appointments.view","visits.view"]},{key:"followups",label:"Follow-ups (Waiting)",to:"/opd/followups",icon:Xn,reqAny:["appointments.view","appointments.update"]},{key:"no-shows",label:"No-show Reschedule",to:"/opd/no-shows",icon:wse,reqAny:["appointments.view","appointments.update"]},{key:"Doctor Fees",label:"Doctor Fees",to:"/opd/doctor-fees",icon:f_,reqAny:["appointments.view","appointments.update"]}]},{key:"ip",label:"IP",icon:Jn,items:[{key:"ipd-admissions",label:"Admissions",to:"/ipd/admissions",icon:ose,reqAny:["ipd.view","ipd.manage"]},{key:"ipd-tracking",label:"Tracking",to:"/ipd/tracking",icon:N0,reqAny:["ipd.tracking.view"]},{key:"ipd-my",label:"My Admissions",to:"/ipd/my",icon:p4,reqAny:["ipd.my.view","ipd.doctor"]},{key:"ipd-discharged",label:"Discharged",to:"/ipd/discharged",icon:x7,reqAny:["ipd.discharged.view"]},{key:"ipd-bedboard",label:"Bedboard",to:"/ipd/bedboard",icon:Jn,reqAny:["ipd.bedboard.view"]},{key:"ipd-masters",label:"IPD Masters",to:"/ipd/masters",icon:El,reqAny:["ipd.masters.manage","ipd.packages.manage"]}]},{key:"lab",label:"Laboratory",icon:Bc,items:[{key:"lab-orders",label:"Orders & Reporting",to:"/lab/orders",icon:Bc,reqAny:["lab.orders.view","lab.orders.create","orders.lab.view","orders.lab.create"]},{key:"lab-masters",label:"Lab Masters (NABL)",to:"/lab/masters",icon:El,reqAny:["lab.masters.manage"]},{key:"LAB_SERVICE MASTER",label:"LAB_SERVICE MASTER",to:"/lab/service/masters",icon:El,reqAny:["lab.masters.manage"]}]},{key:"ris",label:"Radiology",icon:Og,items:[{key:"ris-orders",label:"Orders & Reporting",to:"/ris/orders",icon:Og,reqAny:["radiology.orders.view","radiology.orders.create","orders.ris.view","orders.ris.create","radiology.report.create","radiology.report.approve","radiology.schedule.manage","radiology.scan.update"]},{key:"ris-masters",label:"RIS Masters",to:"/ris/masters",icon:El,reqAny:["radiology.masters.manage"]}]},{key:"ot",label:"Operation Theatre",icon:y7,items:[{key:"ot-masters",label:"OT Masters",to:"/ot/masters",icon:pne,reqAny:["ot.cases.view","ot.cases.create","ipd.view"]},{key:"ot-schedule",label:"OT Schedule",to:"/ot/schedule",icon:Kn,reqAny:["ot.cases.view","ot.cases.create","ipd.view"]},{key:"ot-logs",label:"OT Logs / Register",to:"/ot/logs",icon:dr,reqAny:["ot.cases.view","ot.cases.create","ipd.view"]}]},{key:"billing",label:"Billing",icon:f_,items:[{key:"billing-console",label:"Billing Console",to:"/billing",icon:N0,reqAny:["billing.invoices.view","billing.invoices.create"]}]},{key:"settings",label:"Settings",icon:gne,items:[{key:"schedules",label:"Schedules",to:"/opd/schedules",icon:h4,reqAny:["schedules.manage"]},{key:"ui-branding",label:"Customization & Templates",to:"/settings/branding",icon:Dse,reqAny:["settings.customization.view","settings.customization.manage"]},{key:"perm-logs",label:"Permissions (Access Logs)",to:"/admin/permissions",icon:El,reqAny:["permissions.view","permissions.create","permissions.update","permissions.delete"]}]}];function Lce(){const t=Zn(L=>L.user),s=Zn(L=>L.modules)||{},n=Di(),{sidebarCollapsed:a,toggleCollapse:i,sidebarMobileOpen:l,closeMobile:o}=dB(),{branding:c}=Pf()||{},d=(c==null?void 0:c.primary_color)||Mce,u=(c==null?void 0:c.sidebar_bg_color)||"#ffffff",f=(c==null?void 0:c.text_color)||"#111827",m=(c==null?void 0:c.icon_color)||f,x=(c==null?void 0:c.icon_bg_color)||"rgba(37,99,235,0.08)",b=Dce(d),w=Oce(d),j=((c==null?void 0:c.org_name)||"").trim()||"NABH HIMS",_=((c==null?void 0:c.org_tagline)||"").trim()||"Smart  Secure  NABH-Standard",C=y.useMemo(()=>{var V;const L=(V=c==null?void 0:c.org_name)==null?void 0:V.trim();if(!L)return"NH";const F=L.split(/\s+/).filter(Boolean);return F.length?F.length===1?F[0].slice(0,2).toUpperCase():(F[0][0]+F[1][0]).toUpperCase():"NH"},[c==null?void 0:c.org_name]);y.useEffect(()=>{if(!l)return;const L=window.scrollY,F={position:document.body.style.position,top:document.body.style.top,width:document.body.style.width,overflow:document.body.style.overflow,ob:document.documentElement.style.overscrollBehavior};return document.body.style.position="fixed",document.body.style.top=`-${L}px`,document.body.style.width="100%",document.body.style.overflow="hidden",document.documentElement.style.overscrollBehavior="none",()=>{document.body.style.position=F.position||"",document.body.style.top=F.top||"",document.body.style.width=F.width||"",document.body.style.overflow=F.overflow||"",document.documentElement.style.overscrollBehavior=F.ob||"",window.scrollTo(0,L)}},[l]);const k=!!(t!=null&&t.is_admin),A=y.useMemo(()=>{const L=Object.values(s).flat().map(V=>typeof V=="string"?V:V==null?void 0:V.code).filter(Boolean),F=((t==null?void 0:t.permissions)||[]).map(V=>typeof V=="string"?V:V==null?void 0:V.code).filter(Boolean);return new Set([...L||[],...F||[]])},[s,t]),T=(L=[])=>k?!0:L.some(F=>A.has(F)),P=y.useMemo(()=>Rce.map(L=>{if(L.flatLink){const U=T(L.flatLink.reqAny);return{...L,_visible:U}}const F=(L.items||[]).map(U=>({...U,_visible:T(U.reqAny)})),V=F.some(U=>U._visible);return{...L,items:F,_visible:V}}).filter(L=>L._visible),[A,k]),R=L=>L.flatLink?n.pathname.startsWith(L.flatLink.to):(L.items||[]).some(F=>n.pathname.startsWith(F.to)),[I,O]=y.useState({});y.useEffect(()=>{const L={};P.forEach(F=>{L[F.key]=R(F)}),O(F=>({...F,...L}))},[n.pathname]);const M=L=>O(F=>({...F,[L]:!F[L]})),B=a?"md:w-16":"md:w-64";return r.jsxs(r.Fragment,{children:[r.jsx("div",{onClick:o,className:`fixed inset-0 z-40 bg-black/35 backdrop-blur-sm transition-opacity md:hidden ${l?"opacity-100":"pointer-events-none opacity-0"}`}),r.jsxs("aside",{className:["z-50 border-r transition-all duration-300 ease-out","fixed left-0 top-0 h-[100dvh] w-[86vw] max-w-sm md:w-auto",l?"translate-x-0":"-translate-x-full","md:static md:translate-x-0 md:sticky md:top-0 md:h-[100dvh]",B,"grid grid-rows-[auto,1fr,auto] min-h-0","overflow-x-hidden overflow-y-hidden"].join(" "),style:{backgroundColor:u,color:f},children:[r.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-3",children:[r.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[c!=null&&c.logo_url?r.jsx("img",{src:c.logo_url,alt:"Logo",className:"h-8 w-auto rounded-md border border-slate-200 bg-white"}):r.jsx("div",{className:"grid h-8 w-8 place-items-center rounded-xl ring-1",style:{backgroundColor:x,borderColor:w},children:r.jsx("span",{className:"text-xs font-bold",style:{color:m},children:C})}),!a&&r.jsxs("div",{className:"truncate",children:[r.jsx("div",{className:"text-xs font-semibold tracking-tight leading-snug",children:j}),r.jsx("div",{className:"text-[10px] leading-tight",children:_})]})]}),r.jsx("button",{onClick:o,className:"md:hidden inline-flex h-8 w-8 items-center justify-center rounded-xl hover:bg-gray-50 active:scale-95 transition","aria-label":"Close sidebar",children:r.jsx(Rn,{className:"h-5 w-5",style:{color:m}})}),r.jsx("button",{onClick:i,className:"hidden md:inline-flex h-8 w-8 items-center justify-center rounded-xl hover:bg-gray-50 active:scale-95 transition","aria-label":a?"Expand sidebar":"Collapse sidebar",title:a?"Expand":"Collapse",children:a?r.jsx(Sf,{className:"h-5 w-5",style:{color:m}}):r.jsx(Nx,{className:"h-5 w-5",style:{color:m}})})]}),r.jsxs("nav",{className:"min-h-0 flex-1 overflow-y-auto no-scrollbar y-fade px-2 pb-4 pt-1 space-y-1 overscroll-contain touch-pan-y",children:[P.map(L=>{if(L.flatLink){const z=L.icon||El;return r.jsxs(UT,{to:L.flatLink.to,onClick:o,className:({isActive:W})=>["group relative flex h-10 items-center gap-3 rounded-xl px-3 text-sm leading-none transition-colors duration-200 ease-out active:scale-[0.99]",a?"justify-center":""].join(" "),style:({isActive:W})=>W?{color:"#ffffff",backgroundColor:d,boxShadow:`0 0 0 1px ${w}`}:{color:f},title:a?L.label:void 0,children:[r.jsx(z,{className:"h-5 w-5 shrink-0",style:{color:R(L)?"#ffffff":m}}),!a&&r.jsx("span",{className:"transition-all duration-300",children:L.label})]},L.key)}const F=L.icon||El,V=!!I[L.key]&&!a,U=R(L);return r.jsxs("div",{className:"rounded-xl",children:[r.jsxs("button",{type:"button",onClick:()=>a?null:M(L.key),className:["w-full flex items-center gap-3 rounded-xl px-3 h-10 text-sm transition-colors duration-200 ease-out",a?"justify-center":"justify-between"].join(" "),title:a?L.label:void 0,style:{color:U?d:f,backgroundColor:U?b:"transparent",boxShadow:U?`0 0 0 1px ${w}`:void 0},children:[r.jsxs("span",{className:"flex items-center gap-3",children:[r.jsx(F,{className:"h-5 w-5 shrink-0",style:{color:m}}),!a&&r.jsx("span",{className:"font-medium",children:L.label})]}),!a&&r.jsx(v3,{className:"h-4 w-4 transition-transform",style:{color:m}})]}),V&&r.jsx("div",{className:"mt-1 space-y-1 pl-9",children:L.items.filter(z=>z._visible).map(z=>{const W=z.icon||El;return r.jsxs(UT,{to:z.to,onClick:o,className:()=>"group relative flex h-9 items-center gap-2 rounded-lg px-2 text-sm leading-none transition-colors duration-200 ease-out active:scale-[0.99]",style:({isActive:q})=>q?{color:d,backgroundColor:b,boxShadow:`0 0 0 1px ${w}`}:{color:f},children:[r.jsx(W,{className:"h-[18px] w-[18px] shrink-0",style:{color:m}}),r.jsx("span",{children:z.label})]},z.key)})})]},L.key)}),P.length===0&&r.jsx("div",{className:"px-3 py-2 text-xs text-gray-500",children:"No modules granted. Contact administrator."})]}),r.jsx("div",{className:"px-3 pb-3",children:a?r.jsx("div",{className:"grid place-items-center text-[10px] text-gray-400",children:"v1.0"}):r.jsx("div",{className:"rounded-xl border border-gray-100 bg-gray-50 p-3 text-[11px] text-gray-500",children:"Tip: Click the chevron to collapse the sidebar."})})]})]})}function Bce(){const{user:t,logout:s,fetchProfile:n}=Zn(),{toggleMobile:a}=dB(),{branding:i}=Pf()||{},[l,o]=y.useState(new Date),[c,d]=y.useState(typeof navigator<"u"?navigator.onLine:!0),[u,f]=y.useState(!1),[m,x]=y.useState(!1),[b,w]=y.useState(!1),j=(i==null?void 0:i.primary_color)||"#0f172a",C=(i==null?void 0:i.primary_color_dark)||null||j,k=(i==null?void 0:i.text_muted_color)||"#e5e7eb",A=(i==null?void 0:i.icon_color)||k,T=((i==null?void 0:i.org_name)||"").trim()||"NUTRYAH",P=((i==null?void 0:i.org_tagline)||"").trim()||"Smart  Secure  NABH-Standard";y.useEffect(()=>{const F=setInterval(()=>o(new Date),1e3);return()=>clearInterval(F)},[]),y.useEffect(()=>{const F=()=>d(navigator.onLine);return window.addEventListener("online",F),window.addEventListener("offline",F),()=>{window.removeEventListener("online",F),window.removeEventListener("offline",F)}},[]);const R=y.useMemo(()=>t?t.is_admin?"Admin":Array.isArray(t.roles)&&t.roles.length?t.roles[0]:"User":"",[t]),I=y.useMemo(()=>{try{return l.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return l.toTimeString().slice(0,8)}},[l]),O=()=>{x(!0),setTimeout(()=>window.location.reload(),120)},M=async()=>{w(!0);try{await n()}finally{setTimeout(()=>w(!1),500)}},B=r.jsx("svg",{viewBox:"0 0 24 24",className:"h-9 w-9","aria-hidden":"true",fill:"none",stroke:"currentColor",strokeWidth:"1.5",style:{color:A},children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6.75a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.5 20.25a8.25 8.25 0 1 1 15 0v.75H4.5v-.75Z"})}),L=({ok:F})=>r.jsx("span",{title:F?"Online":"Offline",className:`inline-block h-2.5 w-2.5 rounded-full ${F?"bg-emerald-500":"bg-rose-500"} ring-2 ring-white`});return r.jsx("header",{className:"sticky top-0 z-30",style:{backgroundColor:C,color:k},children:r.jsxs("div",{className:"mx-auto flex max-w-7xl items-center justify-between gap-3 px-4 py-2 sm:px-6",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{className:"md:hidden inline-flex items-center justify-center rounded-xl p-2 ring-1 ring-white/20 hover:bg-white/10 active:scale-95 transition",onClick:a,"aria-label":"Open menu",children:r.jsx("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",stroke:"currentColor",strokeWidth:"1.5",fill:"none",style:{color:A},children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 7h16M4 12h16M4 17h16"})})}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-lg font-semibold tracking-tight sm:text-xl",style:{color:k},children:T}),r.jsx("span",{className:"hidden text-[11px] sm:inline-block",style:{color:k},children:P})]})]}),r.jsxs("div",{className:"hidden items-center gap-3 sm:flex",children:[r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-white/15 bg-white/10 px-3 py-1.5 text-sm",children:[r.jsx(L,{ok:c}),r.jsx("span",{className:"tabular-nums",style:{color:k},children:I})]}),r.jsxs("button",{onClick:M,className:`group inline-flex items-center gap-2 rounded-xl border border-white/15 bg-white/10 px-3 py-1.5 text-sm transition ${b?"animate-pulse":"hover:bg-white/15"}`,title:"Sync data",children:[r.jsx("svg",{viewBox:"0 0 24 24",className:`h-5 w-5 ${b?"animate-spin":"group-hover:rotate-90"} transition`,stroke:"currentColor",strokeWidth:"1.5",fill:"none",style:{color:A},children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16 8V4m0 0h4m-4 0l2 2M8 16v4m0 0H4m4 0-2-2M6 8a6 6 0 1 1 12 0 6 6 0 0 1-12 0Z"})}),r.jsx("span",{style:{color:k},children:"Sync"})]}),r.jsxs("button",{onClick:O,className:"inline-flex items-center gap-2 rounded-xl border border-white/15 bg-white/10 px-3 py-1.5 text-sm transition hover:bg-white/15 active:scale-95",title:"Refresh page",children:[r.jsx("svg",{viewBox:"0 0 24 24",className:`h-5 w-5 ${m?"animate-spin":""} transition`,stroke:"currentColor",strokeWidth:"1.5",fill:"none",style:{color:A},children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992V4.356M21 12a9 9 0 1 1-3-6.708"})}),r.jsx("span",{style:{color:k},children:"Refresh"})]})]}),r.jsxs("div",{className:"relative",children:[r.jsxs("button",{onClick:()=>f(F=>!F),className:"group inline-flex items-center gap-3 rounded-2xl border border-white/15 bg-white/10 px-2.5 py-1.5 transition hover:bg-white/15","aria-haspopup":"menu","aria-expanded":u,title:"Account",children:[r.jsxs("div",{className:"relative",children:[r.jsx("span",{className:"absolute -right-0.5 -top-0.5 rounded-full bg-emerald-500 p-1 ring-2 ring-[rgba(0,0,0,0.2)]"}),B]}),r.jsx("div",{className:"hidden min-w-[9rem] text-left sm:block",children:r.jsxs("div",{className:"leading-tight",children:[r.jsx("div",{className:"truncate text-sm font-medium",style:{color:k},children:(t==null?void 0:t.name)||""}),r.jsx("div",{className:"truncate text-[11px]",style:{color:k},children:R})]})}),r.jsx("svg",{viewBox:"0 0 24 24",className:`hidden h-4 w-4 sm:block transition ${u?"rotate-180":""}`,fill:"none",stroke:"currentColor",strokeWidth:"1.5",style:{color:A},children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 9l6 6 6-6"})})]}),r.jsxs("div",{className:`absolute right-0 mt-2 w-64 origin-top-right rounded-2xl border border-gray-200 bg-gray-900 p-3 shadow-lg transition ${u?"scale-100 opacity-100":"pointer-events-none scale-95 opacity-0"}`,children:[r.jsxs("div",{className:"mb-3 flex items-center gap-3",children:[r.jsx("div",{className:"shrink-0",children:B}),r.jsxs("div",{className:"min-w-0",children:[r.jsx("div",{className:"truncate text-sm font-semibold text-gray-100",children:(t==null?void 0:t.name)||""}),r.jsx("div",{className:"truncate text-xs text-gray-300",children:R}),r.jsx("div",{className:"truncate text-[11px] text-gray-300",children:t==null?void 0:t.email})]})]}),r.jsxs("div",{className:"grid gap-2",children:[r.jsxs("button",{onClick:M,className:"flex w-full items-center gap-2 rounded-xl px-3 py-2 text-left text-sm hover:bg-gray-50 hover:text-black/90",children:[r.jsx("svg",{viewBox:"0 0 24 24",className:`h-5 w-5 ${b?"animate-spin":""}`,fill:"none",stroke:"currentColor",strokeWidth:"1.5",style:{color:A},children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12a7.5 7.5 0 0 1 13.5-4.5M19.5 12A7.5 7.5 0 0 1 6 16.5M3 12h3m12 0h3"})}),r.jsx("span",{children:"Sync data"})]}),r.jsxs("button",{onClick:O,className:"flex w-full items-center gap-2 rounded-xl px-3 py-2 text-left text-sm hover:bg-gray-50 hover:text-black/90",children:[r.jsx("svg",{viewBox:"0 0 24 24",className:`h-5 w-5 ${m?"animate-spin":""}`,fill:"none",stroke:"currentColor",strokeWidth:"1.5",style:{color:A},children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992V4.356M21 12a9 9 0 1 1-3-6.708"})}),r.jsx("span",{children:"Refresh page"})]}),r.jsx("div",{className:"my-1 h-px bg-gray-100"}),r.jsxs("button",{onClick:s,className:"flex w-full items-center gap-2 rounded-xl px-3 py-2 text-left text-sm text-rose-600 hover:bg-rose-50",children:[r.jsx("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",fill:"none",stroke:"currentColor",strokeWidth:"1.5",style:{color:A},children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6A2.25 2.25 0 0 0 5.25 5.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15M12 8l-4 4m0 0 4 4m-4-4h12"})}),r.jsx("span",{children:"Logout"})]})]})]})]})]})})}const Fce="#2563eb";function $ce(){const{branding:t}=Pf()||{},s=(t==null?void 0:t.primary_color)||Fce,n=(t==null?void 0:t.sidebar_bg_color)||"#f9fafb",a=(t==null?void 0:t.text_color)||"#4b5563";return r.jsx("footer",{className:"w-full border-t text-xs sm:text-[13px]",style:{borderTopColor:s,background:n,color:a},children:r.jsxs("div",{className:"mx-auto flex max-w-6xl flex-col gap-2 px-4 py-3 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"font-medium",children:["Powered by"," ",r.jsx("span",{className:"font-semibold",style:{color:s},children:"NUTRYAH DIGITAL HEALTH"})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1",children:[r.jsx("span",{className:"font-medium",children:"Support:"}),r.jsx("a",{href:"tel:+918870787448",className:"hover:underline",style:{color:s},children:"Mobile: +91 88707 87448"}),r.jsx("span",{className:"hidden text-slate-300 md:inline",children:""}),r.jsx("a",{href:"mailto:support@nutryah.com",className:"hover:underline",style:{color:s},children:"Email: support@nutryah.com"}),r.jsx("span",{className:"hidden text-slate-300 md:inline",children:""}),r.jsx("a",{href:"https://www.nutryah.com",target:"_blank",rel:"noreferrer",className:"hover:underline",style:{color:s},children:"Website: www.nutryah.com"})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1",children:[r.jsx("a",{href:"/privacy-policy",className:"hover:underline",style:{color:s},children:"Privacy Policy"}),r.jsx("span",{className:"text-slate-300",children:"|"}),r.jsx("a",{href:"/terms-and-conditions",className:"hover:underline",style:{color:s},children:"Terms & Conditions"})]})]})})}function zce(){const{branding:t}=Pf()||{},s=!!(t!=null&&t.content_bg_color),n=s?"min-h-dvh":"min-h-dvh bg-gradient-to-b from-gray-50 to-white",a=s?{backgroundColor:t.content_bg_color,color:t.text_color||void 0}:void 0;return r.jsxs("div",{className:n,style:a,children:[r.jsxs("div",{className:"flex min-h-dvh",children:[r.jsx(Lce,{}),r.jsxs("div",{className:"flex min-h-dvh flex-1 flex-col",children:[r.jsx(Bce,{}),r.jsx("main",{className:"flex-1",children:r.jsx("div",{className:"mx-auto w-full max-w-7xl px-4 py-4 sm:px-6 lg:px-8",children:r.jsx(IL,{})})})]})]}),r.jsx($ce,{})]})}function Uce(){const{user:t,loading:s,fetchProfile:n}=Zn(),[a,i]=y.useState(!1),l=localStorage.getItem("access_token"),o=Di();return y.useEffect(()=>{l&&!t&&!s&&(i(!0),n().finally(()=>i(!1)))},[l,t,s,n]),l?a||s||!t&&l?r.jsx("div",{className:"min-h-screen grid place-items-center text-sm",children:"Loading"}):r.jsx(IL,{}):r.jsx(PL,{to:"/auth/login",state:{from:o},replace:!0})}function gn({anyOf:t=[],fallback:s=null,children:n}){const a=Zn(d=>d.user),i=Zn(d=>d.modules)||{};if(!!(a!=null&&a.is_admin))return n;const o=new Set(Object.values(i).flat().map(d=>typeof d=="string"?d:d==null?void 0:d.code).filter(Boolean));return t.length===0||t.some(d=>o.has(d))?n:s}const If=(t={})=>{const s={};return Object.entries(t).forEach(([n,a])=>{a!=null&&a!==""&&(s[n]=a)}),s},Bb=()=>J.get("/ipd/wards"),Vce=t=>J.post("/ipd/wards",t),Hce=t=>J.delete(`/ipd/wards/${t}`),kx=(t={})=>J.get("/ipd/rooms",{params:If(t)}),Wce=t=>J.post("/ipd/rooms",t),qce=t=>J.delete(`/ipd/rooms/${t}`),rl=(t={})=>J.get("/ipd/beds",{params:If(t)}),Gce=t=>J.post("/ipd/beds",t),Kce=t=>J.delete(`/ipd/beds/${t}`),Yce=(t,s)=>J.patch(`/ipd/beds/${t}/state`,null,{params:If(s)}),hB=()=>J.get("/ipd/packages"),Xce=t=>J.post("/ipd/packages",t),Qce=t=>J.delete(`/ipd/packages/${t}`),Zce=(t={})=>J.get("/ipd/bed-rates",{params:If(t)}),Jce=t=>J.post("/ipd/bed-rates",t),ede=t=>J.delete(`/ipd/bed-rates/${t}`),Fb=(t={})=>J.get("/ipd/admissions",{params:If(t)}),tde=t=>J.post("/ipd/admissions",t),fB=async t=>{var s,n;try{return await J.get(`/ipd/admissions/${t}`)}catch(a){const i=(s=a==null?void 0:a.response)==null?void 0:s.status;if(i===404||i===405)try{return await J.get(`/ipd/admission/${t}`)}catch(l){const o=(n=l==null?void 0:l.response)==null?void 0:n.status;if(o===404||o===405){const{data:c=[]}=await J.get("/ipd/admissions",{params:{limit:500}}),d=(c||[]).find(u=>Number(u==null?void 0:u.id)===Number(t));if(!d){const u=new Error("Not found");throw u.status=404,u}return{data:d}}throw l}throw a}},sde=t=>J.patch(`/ipd/admissions/${t}/cancel`),nde=(t,s)=>J.post(`/ipd/admissions/${t}/transfer`,s),rde=t=>J.get(`/ipd/admissions/${t}/nursing-notes`),ade=(t,s)=>J.post(`/ipd/admissions/${t}/nursing-notes`,s),ide=t=>J.get(`/ipd/admissions/${t}/vitals/latest`),lde=t=>J.get(`/ipd/admissions/${t}/vitals`),ode=(t,s)=>J.post(`/ipd/admissions/${t}/vitals`,s),cde=t=>J.get(`/ipd/admissions/${t}/io`),dde=(t,s)=>J.post(`/ipd/admissions/${t}/io`,s),ude=t=>J.get(`/ipd/admissions/${t}/shift-handovers`),hde=(t,s)=>J.post(`/ipd/admissions/${t}/shift-handovers`,s),fde=t=>J.get(`/ipd/admissions/${t}/rounds`),mde=(t,s)=>J.post(`/ipd/admissions/${t}/rounds`,s),pde=t=>J.get(`/ipd/admissions/${t}/progress-notes`),xde=(t,s)=>J.post(`/ipd/admissions/${t}/progress-notes`,s),gde=t=>J.get(`/ipd/admissions/${t}/referrals`),yde=(t,s)=>J.post(`/ipd/admissions/${t}/referrals`,s),bde=t=>J.get(`/ipd/admissions/${t}/assessments/pain`),vde=(t,s)=>J.post(`/ipd/admissions/${t}/assessments/pain`,s),wde=t=>J.get(`/ipd/admissions/${t}/assessments/fall-risk`),Nde=(t,s)=>J.post(`/ipd/admissions/${t}/assessments/fall-risk`,s),jde=t=>J.get(`/ipd/admissions/${t}/assessments/pressure-ulcer`),_de=(t,s)=>J.post(`/ipd/admissions/${t}/assessments/pressure-ulcer`,s),Sde=t=>J.get(`/ipd/admissions/${t}/assessments/nutrition`),Cde=(t,s)=>J.post(`/ipd/admissions/${t}/assessments/nutrition`,s),kde=t=>J.get(`/ipd/admissions/${t}/medications`),Ade=(t,s)=>J.post(`/ipd/admissions/${t}/medications`,s),Ede=(t,s)=>J.put(`/ipd/medications/${t}`,s),Tde=t=>J.get(`/ipd/admissions/${t}/drug-chart/meta`),Pde=(t,s)=>J.put(`/ipd/admissions/${t}/drug-chart/meta`,s),Ide=t=>J.get(`/ipd/admissions/${t}/drug-chart/iv-fluids`),Mde=(t,s)=>J.post(`/ipd/admissions/${t}/drug-chart/iv-fluids`,s),Dde=t=>J.delete(`/ipd/iv-fluids/${t}`),Ode=t=>J.get(`/ipd/admissions/${t}/drug-chart/nurses`),Rde=(t,s)=>J.post(`/ipd/admissions/${t}/drug-chart/nurses`,s),Lde=t=>J.delete(`/ipd/drug-chart/nurses/${t}`),Bde=t=>J.get(`/ipd/admissions/${t}/drug-chart/doctor-auth`),Fde=(t,s)=>J.post(`/ipd/admissions/${t}/drug-chart/doctor-auth`,s),$de=t=>J.delete(`/ipd/drug-chart/doctor-auth/${t}`),zde=t=>J.get(`/ipd/admissions/${t}/drug-chart/pdf`,{responseType:"blob"}),Ude=t=>J.get(`/ipd/admissions/${t}/discharge-summary`),Vde=(t,s)=>J.post(`/ipd/admissions/${t}/discharge-summary`,s),Hde=t=>J.get(`/ipd/admissions/${t}/discharge-checklist`),Wde=(t,s)=>J.post(`/ipd/admissions/${t}/discharge-checklist`,s),mB=t=>J.get(`/ipd/admissions/${t}/discharge-meds`),qde=(t,s)=>J.post(`/ipd/admissions/${t}/discharge-meds`,s),Gde=(t,s={})=>J.get("/ipd/bed-charges/preview",{params:{admission_id:t,...If(s)}}),Kde=t=>J.get(`/ipd/admissions/${t}/feedback`),Yde=(t,s)=>J.post(`/ipd/admissions/${t}/feedback`,s),$b=t=>J.get(`/patients/${t}`),Xde=(...t)=>ode(...t),Qde=(t,s)=>J.post(`/ipd/admissions / ${t} / dressing - transfusion, payload`),Zde=t=>J.get(`/ipd/admissions/${t}/dressing-transfusion`),zy=["General Ward","Semi-Private","Private","Deluxe","Suite","ICU","HDU","PICU","NICU","Isolation Room","Day Care","Observation","Emergency / ER"];function Jde(){return r.jsx(gn,{anyOf:["ipd.masters.manage","ipd.packages.manage"],children:r.jsxs("div",{className:"min-h-screen bg-slate-50 px-4 py-4 text-black md:px-6 md:py-6 space-y-6",children:[r.jsxs("div",{className:"mx-auto max-w-6xl space-y-1",children:[r.jsx("h1",{className:"text-xl font-semibold tracking-tight text-slate-900",children:"IPD Masters"}),r.jsx("p",{className:"text-sm text-slate-600",children:"Configure wards, rooms, beds and their tariffs. This setup drives the Admission, Bedboard, Billing and Bed Occupancy workflows for your hospital."})]}),r.jsxs("div",{className:"mx-auto max-w-6xl space-y-6",children:[r.jsx(eue,{}),r.jsx(sue,{}),r.jsx(rue,{})]})]})})}function eue(){const[t,s]=y.useState([]),[n,a]=y.useState([]),[i,l]=y.useState([]),[o,c]=y.useState(!1),[d,u]=y.useState(""),f=async()=>{var b,w;c(!0),u("");try{const[j,_,C]=await Promise.all([Bb(),kx(),rl()]);s(j.data||[]),a(_.data||[]),l(C.data||[])}catch(j){u(((w=(b=j==null?void 0:j.response)==null?void 0:b.data)==null?void 0:w.detail)||"Failed to load ward/room/bed data.")}finally{c(!1)}};y.useEffect(()=>{f()},[]);const m=y.useMemo(()=>Array.from(new Set((n||[]).map(b=>b.type).filter(Boolean).map(b=>b.trim()))),[n]),x=y.useMemo(()=>Array.from(new Set([...zy,...m])),[m]);return r.jsxs("section",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm space-y-5",children:[r.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ra,{className:"h-5 w-5 text-slate-500"}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Ward  Room  Bed"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Define the physical structure of the IPD: wards, room types and individual beds. Room type drives bed tariffs and reporting."})]})]}),r.jsxs("div",{className:"flex flex-wrap gap-1 text-[11px]",children:[x.slice(0,6).map(b=>r.jsx($_,{type:b},b)),x.length>6&&r.jsxs("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-slate-600",children:["+",x.length-6," more types"]})]})]}),d&&r.jsx(nk,{message:d}),r.jsxs("div",{className:"space-y-3",children:[r.jsx(F_,{title:"New Ward",description:"Create a new ward or block (e.g. GW Block, ICU Block, Labour Ward).",fields:[{name:"code",label:"Ward code",placeholder:"e.g. GW-1",required:!0},{name:"name",label:"Ward name",placeholder:"e.g. General Ward Block 1",required:!0},{name:"floor",label:"Floor / Level",placeholder:"e.g. 1st Floor"}],onSubmit:async b=>{await Vce(b),await f()}}),r.jsx(tue,{wards:t,allRoomTypes:x,onCreated:f}),r.jsx(F_,{title:"New Bed",description:"Add individual beds to rooms. Bed codes should be easy for staff to identify (e.g. GW-101-A).",fields:[{name:"room_id",label:"Room",type:"select",required:!0,options:n.map(b=>({value:b.id,label:`Ward ${b.ward_id}  Room ${b.number} (${b.type||"Unspecified"})`})),placeholder:"Select room"},{name:"code",label:"Bed code",placeholder:"e.g. GW-101-A",required:!0}],onSubmit:async b=>{await Gce(b),await f()}})]}),r.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[r.jsx(rp,{title:"Wards",items:t,cols:[["code","Code"],["name","Name"],["floor","Floor"]],onDelete:b=>Hce(b).then(f)}),r.jsx(rp,{title:"Rooms",items:n,cols:[["ward_id","Ward ID"],["number","Room No"],["type","Room Type"]],renderValue:(b,w)=>b==="type"?r.jsx($_,{type:w}):String(w??""),onDelete:b=>qce(b).then(f)}),r.jsx(rp,{title:"Beds",items:i,cols:[["room_id","Room ID"],["code","Bed code"],["state","Status"]],renderValue:(b,w)=>b==="state"?r.jsx(aue,{state:w}):String(w??""),onDelete:b=>Kce(b).then(f)})]}),o&&r.jsx(rk,{})]})}function tue({wards:t=[],allRoomTypes:s=[],onCreated:n}){const[a,i]=y.useState({ward_id:"",number:"",typeChoice:"",customType:""}),[l,o]=y.useState(!1),[c,d]=y.useState(""),u=(m,x)=>{i(b=>({...b,[m]:x})),c&&d("")},f=async m=>{if(m.preventDefault(),d(""),!a.ward_id||!a.number){d("Ward and Room number are required.");return}let x="";if(a.typeChoice==="__custom"){if(!a.customType.trim()){d("Please enter a custom room type.");return}x=a.customType.trim()}else a.typeChoice&&(x=a.typeChoice);o(!0);try{const b={ward_id:a.ward_id,number:a.number,type:x||void 0};await Wce(b),i({ward_id:"",number:"",typeChoice:"",customType:""}),n==null||n()}finally{o(!1)}};return r.jsxs("form",{onSubmit:f,className:"rounded-2xl border border-slate-200 bg-slate-50 p-4 grid gap-3 md:grid-cols-4 text-sm",children:[r.jsxs("div",{className:"md:col-span-4",children:[r.jsx("div",{className:"text-sm font-medium text-slate-800",children:"New Room"}),r.jsx("p",{className:"mt-0.5 text-[11px] text-slate-500",children:"Link the room to a ward and assign a room type. Custom room types can be created on the fly when needed."})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs text-slate-500",children:"Ward"}),r.jsxs("select",{className:"input rounded-xl",value:a.ward_id,onChange:m=>u("ward_id",m.target.value),required:!0,children:[r.jsx("option",{value:"",children:"Select ward"}),t.map(m=>r.jsxs("option",{value:m.id,children:[m.code,"  ",m.name]},m.id))]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs text-slate-500",children:"Room number"}),r.jsx("input",{className:"input rounded-xl",placeholder:"e.g. 101",value:a.number,onChange:m=>u("number",m.target.value),required:!0})]}),r.jsxs("div",{className:"space-y-1 md:col-span-2",children:[r.jsx("label",{className:"text-xs text-slate-500",children:"Room type"}),r.jsxs("select",{className:"input rounded-xl",value:a.typeChoice,onChange:m=>u("typeChoice",m.target.value),children:[r.jsx("option",{value:"",children:"(Optional) Select room type"}),zy.map(m=>r.jsx("option",{value:m,children:m},m)),s.filter(m=>!zy.includes(m)).map(m=>r.jsxs("option",{value:m,children:[m," (existing)"]},m)),r.jsx("option",{value:"__custom",children:"Other (custom)"})]}),a.typeChoice==="__custom"&&r.jsx("input",{className:"mt-2 input rounded-xl",placeholder:"Enter custom room type (e.g. Chemotherapy Day Care)",value:a.customType,onChange:m=>u("customType",m.target.value)}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Standard types include General Ward, Semi-Private, Private, Deluxe, ICU, NICU, PICU, HDU, Isolation Room and Suite. Use custom type for special units."})]}),c&&r.jsx("div",{className:"md:col-span-4 text-xs text-rose-600",children:c}),r.jsx("div",{className:"md:col-span-4 flex justify-end",children:r.jsx("button",{type:"submit",className:"btn min-w-[120px]",disabled:l,children:l?"Saving":"Save room"})})]})}function sue(){const[t,s]=y.useState([]),[n,a]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(""),d=async()=>{var f,m;l(!0),c("");try{const[x,b]=await Promise.all([Zce(),kx()]);s(x.data||[]),a(b.data||[])}catch(x){c(((m=(f=x==null?void 0:x.response)==null?void 0:f.data)==null?void 0:m.detail)||"Failed to load bed rates.")}finally{l(!1)}};y.useEffect(()=>{d()},[]);const u=y.useMemo(()=>{const f=(n||[]).map(x=>x.type).filter(Boolean).map(x=>x.trim()),m=(t||[]).map(x=>zP(x.room_type).baseType).filter(Boolean);return Array.from(new Set([...zy,...f,...m]))},[n,t]);return r.jsxs("section",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm space-y-5",children:[r.jsx("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Jn,{className:"h-5 w-5 text-slate-500"}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Bed Rates (Daily & Hourly)"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Configure bed tariffs for each room type. Support both daily and hourly tariffs for day care, observation, emergency and short-stay scenarios."})]})]})}),o&&r.jsx(nk,{message:o}),r.jsx(nue,{roomTypeOptions:u,onCreated:d}),r.jsx(rp,{title:"Configured Bed Rates",items:t,cols:[["room_type","Room type"],["daily_rate","Tariff ()"],["effective_from","From"],["effective_to","To"],["is_active","Active"]],renderValue:(f,m,x)=>{if(f==="room_type"){const b=zP(m);return r.jsxs("div",{className:"flex flex-wrap items-center gap-1",children:[r.jsx($_,{type:b.baseType||m}),r.jsx(iue,{basis:b.basis})]})}return f==="is_active"?r.jsx("span",{className:"text-xs",children:m?"Yes":"No"}):String(m??"")},onDelete:f=>ede(f).then(d)}),i&&r.jsx(rk,{})]})}function nue({roomTypeOptions:t=[],onCreated:s}){const[n,a]=y.useState({baseRoomType:"",basis:"daily",amount:"",effective_from:"",effective_to:""}),[i,l]=y.useState(!1),[o,c]=y.useState(""),d=(m,x)=>{a(b=>({...b,[m]:x})),o&&c("")},u=async m=>{if(m.preventDefault(),c(""),!n.baseRoomType){c("Please select a room type.");return}if(!n.amount||Number(n.amount)<=0){c("Tariff amount must be greater than 0.");return}if(!n.effective_from){c("Please select the effective from date.");return}const x=n.basis==="hourly"?"Hourly":"Daily",w={room_type:`${n.baseRoomType} (${x})`,daily_rate:Number(n.amount),effective_from:n.effective_from,effective_to:n.effective_to||void 0};l(!0);try{await Jce(w),a({baseRoomType:"",basis:"daily",amount:"",effective_from:"",effective_to:""}),s==null||s()}finally{l(!1)}},f=n.basis==="hourly"?"Use hourly tariff for day care, observation, ER and short stays.":"Use daily tariff for standard in-patient stays (24 hours basis).";return r.jsxs("form",{onSubmit:u,className:"rounded-2xl border border-slate-200 bg-slate-50 p-4 grid gap-3 md:grid-cols-4 text-sm",children:[r.jsxs("div",{className:"md:col-span-4",children:[r.jsx("div",{className:"text-sm font-medium text-slate-800",children:"New Bed Rate"}),r.jsx("p",{className:"mt-0.5 text-[11px] text-slate-500",children:"Select a room type, choose whether this is a daily or hourly tariff, and enter the amount and effective dates."})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs text-slate-500",children:"Room type"}),r.jsxs("select",{className:"input rounded-xl",value:n.baseRoomType,onChange:m=>d("baseRoomType",m.target.value),children:[r.jsx("option",{value:"",children:"Select room type"}),t.map(m=>r.jsx("option",{value:m,children:m},m))]}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"Includes standard types like General Ward, Private, ICU, NICU, PICU, HDU, Isolation, Suite and Day Care."})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs text-slate-500",children:"Tariff basis"}),r.jsxs("div",{className:"inline-flex rounded-full border border-slate-200 bg-white p-0.5 text-xs",children:[r.jsx("button",{type:"button",onClick:()=>d("basis","daily"),className:`px-3 py-1.5 rounded-full transition ${n.basis==="daily"?"bg-slate-900 text-white shadow-sm":"text-slate-600 hover:bg-slate-50"}`,children:"Daily"}),r.jsx("button",{type:"button",onClick:()=>d("basis","hourly"),className:`px-3 py-1.5 rounded-full transition ${n.basis==="hourly"?"bg-slate-900 text-white shadow-sm":"text-slate-600 hover:bg-slate-50"}`,children:"Hourly"})]}),r.jsx("p",{className:"text-[11px] text-slate-500",children:f})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs text-slate-500",children:"Tariff amount ()"}),r.jsx("input",{type:"number",min:"0",className:"input rounded-xl",placeholder:"e.g. 2500",value:n.amount,onChange:m=>d("amount",m.target.value)}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"Base amount charged based on the selected tariff basis."})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs text-slate-500",children:"Effective from"}),r.jsx("input",{type:"date",className:"input rounded-xl",value:n.effective_from,onChange:m=>d("effective_from",m.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"text-xs text-slate-500",children:["Effective to ",r.jsx("span",{className:"text-slate-400",children:"(optional)"})]}),r.jsx("input",{type:"date",className:"input rounded-xl",value:n.effective_to,onChange:m=>d("effective_to",m.target.value)})]}),o&&r.jsx("div",{className:"md:col-span-4 text-xs text-rose-600",children:o}),r.jsx("div",{className:"md:col-span-4 flex justify-end",children:r.jsx("button",{type:"submit",className:"btn min-w-[140px]",disabled:i,children:i?"Saving":"Save bed rate"})})]})}function zP(t){if(!t)return{baseType:"",basis:"Daily"};const s=String(t);return/\(hourly\)/i.test(s)?{baseType:s.replace(/\(hourly\)/i,"").trim(),basis:"Hourly"}:/\(daily\)/i.test(s)?{baseType:s.replace(/\(daily\)/i,"").trim(),basis:"Daily"}:{baseType:s.trim(),basis:"Daily"}}function rue(){const[t,s]=y.useState([]),[n,a]=y.useState(!1),[i,l]=y.useState(""),o=async()=>{var c,d;a(!0),l("");try{const{data:u}=await hB();s(u||[])}catch(u){l(((d=(c=u==null?void 0:u.response)==null?void 0:c.data)==null?void 0:d.detail)||"Failed to load packages.")}finally{a(!1)}};return y.useEffect(()=>{o()},[]),r.jsxs("section",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm space-y-5",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Packages"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Define IPD packages like Normal Delivery, LSCS, Medical Management with inclusive and exclusive items and package charges."})]}),i&&r.jsx(nk,{message:i}),r.jsx(F_,{title:"New Package",description:"Create a new IPD package with overall charges and inclusions/exclusions.",fields:[{name:"name",label:"Package name",placeholder:"e.g. Normal Delivery",required:!0},{name:"included",label:"Included",placeholder:"e.g. bed, nursing, OT, routine labs"},{name:"excluded",label:"Excluded",placeholder:"e.g. blood, implants, high-value drugs"},{name:"charges",label:"Package charges ()",placeholder:"e.g. 25000",type:"number"}],onSubmit:async c=>{await Xce(c),await o()}}),r.jsx(rp,{title:"Package List",items:t,cols:[["name","Name"],["charges","Charges"],["included","Included"],["excluded","Excluded"]],onDelete:c=>Qce(c).then(o)}),n&&r.jsx(rk,{})]})}function nk({message:t}){return r.jsxs("div",{className:"flex items-start gap-2 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[r.jsx(yn,{className:"mt-0.5 h-4 w-4"}),r.jsx("span",{children:t})]})}function F_({title:t,description:s,fields:n,onSubmit:a}){const[i,l]=y.useState({}),[o,c]=y.useState(!1),d=(f,m)=>{l(x=>({...x,[f]:m}))},u=async f=>{f.preventDefault(),c(!0);try{const m={...i};Object.keys(m).forEach(x=>m[x]===""&&delete m[x]),await a(m),l({})}finally{c(!1)}};return r.jsxs("form",{onSubmit:u,className:"rounded-2xl border border-slate-200 bg-slate-50 p-4 grid gap-3 md:grid-cols-4 text-sm",children:[r.jsxs("div",{className:"md:col-span-4 space-y-1",children:[r.jsx("div",{className:"text-sm font-medium text-slate-800",children:t}),s&&r.jsx("p",{className:"text-[11px] text-slate-500",children:s})]}),n.map(f=>{var m;return r.jsxs("div",{className:"space-y-1",children:[f.label&&r.jsx("label",{className:"text-xs text-slate-500",children:f.label}),f.type==="select"?r.jsxs("select",{className:"input rounded-xl",value:i[f.name]||"",onChange:x=>d(f.name,x.target.value),required:f.required,children:[r.jsx("option",{value:"",children:f.placeholder||"Select"}),(m=f.options)==null?void 0:m.map(x=>r.jsx("option",{value:x.value,children:x.label},x.value))]}):r.jsx("input",{className:"input rounded-xl",type:f.type||"text",placeholder:f.placeholder||f.name,value:i[f.name]||"",onChange:x=>d(f.name,x.target.value),required:f.required})]},f.name)}),r.jsx("div",{className:"md:col-span-4 flex justify-end pt-1",children:r.jsx("button",{type:"submit",className:"btn min-w-[100px]",disabled:o,children:o?"Saving":"Save"})})]})}function rp({title:t,items:s=[],cols:n=[],onDelete:a,renderValue:i}){return r.jsxs("div",{className:"space-y-2",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:t})}),r.jsx("div",{className:"hidden md:block rounded-xl border border-slate-200 overflow-hidden",children:r.jsxs("table",{className:"w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-slate-50 text-xs text-slate-500",children:[n.map(([l,o])=>r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:o||l},l)),r.jsx("th",{className:"px-3 py-2"})]})}),r.jsxs("tbody",{children:[s.map(l=>r.jsxs("tr",{className:"border-t hover:bg-slate-50",children:[n.map(([o])=>r.jsx("td",{className:"px-3 py-2 align-middle",children:i?i(o,l[o],l):String(l[o]??"")},o)),r.jsx("td",{className:"px-3 py-2 text-right",children:r.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full bg-rose-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-rose-700",onClick:()=>a(l.id),children:[r.jsx(qr,{className:"h-4 w-4"}),"Delete"]})})]},l.id)),!s.length&&r.jsx("tr",{children:r.jsx("td",{className:"p-3 text-sm text-slate-500",colSpan:n.length+1,children:"No records found."})})]})]})}),r.jsxs("div",{className:"space-y-3 md:hidden",children:[s.map(l=>r.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-3 shadow-sm space-y-2",children:[n.map(([o,c])=>r.jsxs("div",{className:"text-xs",children:[r.jsxs("span",{className:"text-slate-500",children:[c||o,": "]}),i?i(o,l[o],l):r.jsx("span",{className:"text-slate-900",children:String(l[o]??"")})]},o)),r.jsx("div",{className:"pt-1",children:r.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full bg-rose-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-rose-700",onClick:()=>a(l.id),children:[r.jsx(qr,{className:"h-4 w-4"}),"Delete"]})})]},l.id)),!s.length&&r.jsx("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 p-3 text-center text-xs text-slate-500",children:"No records yet."})]})]})}function $_({type:t}){return t?r.jsx("span",{className:"inline-flex items-center rounded-full bg-sky-50 px-2 py-0.5 text-[11px] font-medium text-sky-700 border border-sky-200",children:t}):null}function aue({state:t}){if(!t)return r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2 py-0.5 text-[11px] text-slate-600 border border-slate-200",children:"Unknown"});const s=String(t).toLowerCase();let n="bg-slate-100 text-slate-700 border-slate-200";return s==="vacant"||s==="available"?n="bg-emerald-50 text-emerald-700 border-emerald-200":s==="occupied"?n="bg-rose-50 text-rose-700 border-rose-200":(s==="reserved"||s==="cleaning")&&(n="bg-amber-50 text-amber-700 border-amber-200"),r.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[11px] capitalize border ${n}`,children:t})}function iue({basis:t}){const n=(t||"Daily").toLowerCase()==="hourly";return r.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[11px] border ${n?"bg-purple-50 text-purple-700 border-purple-200":"bg-emerald-50 text-emerald-700 border-emerald-200"}`,children:n?"Hourly":"Daily"})}function rk(){return r.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500 pt-1",children:[r.jsx(ss,{className:"h-4 w-4 animate-spin"}),"Loading"]})}const Iu=(t={})=>{const s={};return Object.entries(t).forEach(([n,a])=>{a!=null&&a!==""&&(s[n]=a)}),s};function pB(){return J.get("/opd/departments")}function xB({departmentId:t,roleId:s,roleName:n,isDoctor:a}={}){const i=Iu({department_id:t,role_id:s,role:n,is_doctor:typeof a=="boolean"?a:void 0});return J.get("/opd/users",{params:i})}function UP({doctorUserId:t,date:s,detailed:n=!0}){return J.get("/opd/slots",{params:{doctor_user_id:t,date:s,detailed:n}})}function lue({doctorUserId:t,date:s}){return J.get("/opd/slots/free",{params:{doctor_user_id:t,date:s}})}function oue(t){return J.get("/opd/schedules",{params:{doctor_user_id:t}})}function cue(t){return J.post("/opd/schedules",t)}function due(t){return J.delete(`/opd/schedules/${t}`)}function ak(t=""){const s=t?{q:t}:{};return J.get("/patients",{params:s})}function uue(t){return J.post("/opd/appointments",t)}function VP(t={}){return J.get("/opd/appointments",{params:Iu(t)})}function hue(t,s){return J.patch(`/opd/appointments/${t}/status`,{status:s})}function fue(t,s){return J.post(`/opd/appointments/${t}/reschedule`,s)}function mue(t={}){return J.get("/opd/appointments/noshow",{params:Iu(t)})}function gB(t={}){return J.get("/opd/queue",{params:Iu(t)})}function pue(t){return J.get(`/opd/visits/${t}`)}function xue(t,s){return J.put(`/opd/visits/${t}`,s)}function gue(t){return J.post("/opd/vitals",t)}function yue(t,s){return J.post(`/opd/visits/${t}/followup`,s)}function bue(t={}){return J.get("/opd/followups",{params:Iu(t)})}function vue(t,s){return J.put(`/opd/followups/${t}`,s)}function wue(t,s){return J.post(`/opd/followups/${t}/schedule`,s)}function Nue(t={}){return J.get("/opd/doctor-fees",{params:Iu(t)})}function jue(t){return J.post("/opd/doctor-fees",t)}function _ue(t,s){return J.put(`/opd/doctor-fees/${t}`,s)}function HP(t){if(t.id){const{id:s,...n}=t;return _ue(s,n)}return jue(t)}function Sue(t){return J.delete(`/opd/doctor-fees/${t}`)}function yB(){return pB()}function bB({departmentId:t,roleId:s,isDoctor:n}={}){return xB({departmentId:t,roleId:s,isDoctor:n})}function Cue({dateFrom:t,dateTo:s,doctorId:n}={}){return J.get("/opd/dashboard",{params:Iu({date_from:t,date_to:s,doctor_id:n})})}const RN=10;function kue({value:t,onChange:s}){const[n,a]=y.useState(""),[i,l]=y.useState(""),[o,c]=y.useState([]),[d,u]=y.useState(0),[f,m]=y.useState(!1),[x,b]=y.useState(null);y.useEffect(()=>{const P=setTimeout(()=>l(n.trim()),300);return()=>clearTimeout(P)},[n]),y.useEffect(()=>{let P=!0;return(async()=>{var I,O;m(!0),b(null);try{const{data:M}=await ak(i||"");if(!P)return;c(Array.isArray(M)?M:[]),u(0)}catch(M){if(!P)return;const B=((O=(I=M==null?void 0:M.response)==null?void 0:I.data)==null?void 0:O.detail)||(M==null?void 0:M.message)||"Could not load patients. Please try again.";b(B),c([]),u(0)}finally{P&&m(!1)}})(),()=>{P=!1}},[i]);const w=Math.max(1,Math.ceil(((o==null?void 0:o.length)||0)/RN)),j=d*RN,_=y.useMemo(()=>(o||[]).slice(j,j+RN),[o,j]),C=P=>{s&&s(P)},k=d===0||f,A=d>=w-1||f,T=t??null;return r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Patient"}),r.jsx("span",{className:"text-sm font-medium text-slate-900",children:"Search and select patient for admission"})]}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"Search by UHID, name, phone or email and choose the correct patient."})]}),r.jsxs("div",{className:"relative",children:[r.jsx(is,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),r.jsx("input",{className:"w-full rounded-2xl border border-slate-200 bg-white px-9 py-2.5 text-sm text-slate-900 placeholder:text-slate-400 shadow-sm outline-none transition focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Search by UHID, name, phone, email",value:n,onChange:P=>a(P.target.value)})]}),r.jsxs("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm",children:[r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-slate-50 text-xs text-slate-500",children:[r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"UHID"}),r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Name"}),r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Phone"}),r.jsx("th",{className:"px-4 py-2 text-right font-medium",children:"Action"})]})}),r.jsxs("tbody",{children:[f&&r.jsx("tr",{children:r.jsx("td",{colSpan:4,className:"px-4 py-6 text-center text-sm text-slate-500",children:r.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 px-3 py-1.5 text-xs text-slate-600",children:[r.jsx(ss,{className:"h-4 w-4 animate-spin"}),"Loading patients"]})})}),!f&&x&&r.jsx("tr",{children:r.jsx("td",{colSpan:4,className:"px-4 py-6 text-center text-sm text-rose-600",children:x})}),!f&&!x&&_.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:4,className:"px-4 py-6 text-center text-sm text-slate-500",children:"No patients found. Try a different search."})}),!f&&!x&&_.map(P=>{const R=T===P.id,I=`${P.first_name||""} ${P.last_name||""}`.trim();return r.jsxs("tr",{className:`border-t text-sm transition hover:bg-slate-50 ${R?"bg-sky-50":""}`,children:[r.jsx("td",{className:"px-4 py-2 align-middle text-slate-800",children:r.jsxs("div",{className:"flex items-center gap-2",children:[R&&r.jsx(Ur,{className:"h-4 w-4 text-sky-500"}),r.jsx("span",{className:"font-medium",children:P.uhid||""})]})}),r.jsx("td",{className:"px-4 py-2 align-middle text-slate-800",children:I||P.name||""}),r.jsx("td",{className:"px-4 py-2 align-middle text-slate-700",children:P.phone||""}),r.jsx("td",{className:"px-4 py-2 align-middle text-right",children:r.jsx("button",{type:"button",onClick:()=>C(P.id),className:`inline-flex items-center rounded-full px-4 py-1.5 text-xs font-semibold shadow-sm transition ${R?"bg-sky-600 text-white hover:bg-sky-700":"bg-slate-900 text-white hover:bg-slate-800"}`,children:R?"Selected":"Select"})})]},P.id)})]})]})}),r.jsxs("div",{className:"flex flex-col items-center justify-between gap-3 border-t border-slate-100 px-4 py-3 text-xs text-slate-600 sm:flex-row",children:[r.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-3 py-1.5 font-medium shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",onClick:()=>u(P=>Math.max(0,P-1)),disabled:k,children:[r.jsx(Nx,{className:"h-4 w-4"}),"Prev"]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Page ",r.jsx("span",{className:"font-medium",children:d+1})," / ",w]}),r.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-3 py-1.5 font-medium shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",onClick:()=>u(P=>Math.min(w-1,P+1)),disabled:A,children:["Next",r.jsx(Sf,{className:"h-4 w-4"})]})]})]})]})}function vB({value:t,onChange:s,label:n="Allocate Bed (Ward  Room  Bed)"}){const[a,i]=y.useState([]),[l,o]=y.useState([]),[c,d]=y.useState([]),[u,f]=y.useState(""),[m,x]=y.useState(""),[b,w]=y.useState(!1),[j,_]=y.useState(!1),[C,k]=y.useState(!1),[A,T]=y.useState("");y.useEffect(()=>{let M=!0;return(async()=>{var L,F;w(!0),T("");try{const{data:V}=await Bb();if(!M)return;i(V||[])}catch(V){if(!M)return;console.error("listWards error",V),T(((F=(L=V==null?void 0:V.response)==null?void 0:L.data)==null?void 0:F.detail)||"Failed to load wards. Please refresh and try again."),i([])}finally{M&&w(!1)}})(),()=>{M=!1}},[]),y.useEffect(()=>{let M=!0;return o([]),x(""),d([]),T(""),s==null||s(null),u?((async()=>{var L,F;_(!0);try{const{data:V}=await kx({ward_id:Number(u)});if(!M)return;o(V||[])}catch(V){if(!M)return;console.error("listRooms error",V),T(((F=(L=V==null?void 0:V.response)==null?void 0:L.data)==null?void 0:F.detail)||"Failed to load rooms for this ward."),o([])}finally{M&&_(!1)}})(),()=>{M=!1}):void 0},[u]),y.useEffect(()=>{let M=!0;return d([]),T(""),s==null||s(null),m?((async()=>{var L,F;k(!0);try{const{data:V}=await rl({room_id:Number(m)});if(!M)return;d(V||[])}catch(V){if(!M)return;console.error("listBeds error",V),T(((F=(L=V==null?void 0:V.response)==null?void 0:L.data)==null?void 0:F.detail)||"Failed to load beds for this room."),d([])}finally{M&&k(!1)}})(),()=>{M=!1}):void 0},[m]);const P=y.useMemo(()=>{const M=t?Number(t):null;return M&&c.find(B=>B.id===M)||null},[c,t]),R=M=>{f(M.target.value)},I=M=>{x(M.target.value)},O=M=>{const B=M.target.value,L=B?Number(B):null;s==null||s(L)};return r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Bed Allocation"}),r.jsx("span",{className:"text-sm font-medium text-slate-900",children:n})]}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"Select ward, then room, then an available bed for this admission."})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[r.jsx(ra,{className:"h-4 w-4 text-slate-500"}),r.jsx("span",{className:"font-medium",children:"Ward"})]}),r.jsxs("div",{className:"relative",children:[b&&r.jsx(ss,{className:"absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 animate-spin text-slate-400"}),r.jsxs("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:u,onChange:R,disabled:b,children:[r.jsx("option",{value:"",children:b?"Loading wards":"Select ward"}),a.map(M=>r.jsxs("option",{value:M.id,children:[M.code,"  ",M.name]},M.id))]})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[r.jsx(f7,{className:"h-4 w-4 text-slate-500"}),r.jsx("span",{className:"font-medium",children:"Room"})]}),r.jsxs("div",{className:"relative",children:[j&&r.jsx(ss,{className:"absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 animate-spin text-slate-400"}),r.jsxs("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:m,onChange:I,disabled:!u||j||a.length===0,children:[r.jsx("option",{value:"",children:u?j?"Loading rooms":l.length===0?"No rooms in this ward":"Select room":"Select ward first"}),l.map(M=>r.jsxs("option",{value:M.id,children:[M.number,"  ",M.type]},M.id))]})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[r.jsx(Jn,{className:"h-4 w-4 text-slate-500"}),r.jsx("span",{className:"font-medium",children:"Bed"})]}),r.jsxs("div",{className:"relative",children:[C&&r.jsx(ss,{className:"absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 animate-spin text-slate-400"}),r.jsxs("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:t||"",onChange:O,disabled:!m||C||l.length===0,children:[r.jsx("option",{value:"",children:m?C?"Loading beds":c.length===0?"No beds in this room":"Select bed":"Select room first"}),c.map(M=>r.jsxs("option",{value:M.id,children:[M.code,M.state&&M.state!=="vacant"?`  ${M.state}`:""]},M.id))]})]})]})]}),P&&r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-2xl border border-emerald-200 bg-emerald-50 px-3 py-2 text-xs text-emerald-800",children:[r.jsx(Ur,{className:"h-4 w-4"}),r.jsx("span",{className:"font-semibold",children:"Selected bed:"}),r.jsx("span",{className:"font-medium",children:P.code}),P.state&&r.jsxs("span",{className:"text-emerald-700",children:[" ",P.state]})]}),A&&r.jsxs("div",{className:"mt-1 flex items-start gap-2 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[r.jsx(yn,{className:"mt-0.5 h-4 w-4"}),r.jsx("span",{children:A})]})]})}function Fo({value:t,onChange:s,label:n="Primary Doctor  Department  Role  User"}){const[a,i]=y.useState([]),[l,o]=y.useState(""),[c,d]=y.useState([]),[u,f]=y.useState(!1),[m,x]=y.useState(!1),[b,w]=y.useState("");y.useEffect(()=>{let k=!0;return f(!0),yB().then(A=>{k&&i(A.data||[])}).catch(A=>{var P,R;if(!k)return;console.error("fetchDepartments error",A);const T=((R=(P=A==null?void 0:A.response)==null?void 0:P.data)==null?void 0:R.detail)||"Failed to load departments.";i([]),w(T),ie.error(T)}).finally(()=>{k&&f(!1)}),()=>{k=!1}},[]),y.useEffect(()=>{let k=!0;w(""),d([]);const A=l?Number(l):null;if(s==null||s(null,{department_id:A}),!!l)return x(!0),bB({departmentId:A,isDoctor:!0}).then(T=>{k&&d(T.data||[])}).catch(T=>{var R,I;if(!k)return;console.error("fetchDepartmentUsers error",T);const P=((I=(R=T==null?void 0:T.response)==null?void 0:R.data)==null?void 0:I.detail)||"Failed to load doctors.";w(P),d([]),ie.error(P)}).finally(()=>{k&&x(!1)}),()=>{k=!1}},[l]);const j=y.useMemo(()=>c.find(k=>k.id===t)||null,[c,t]),_=k=>{const A=k.target.value;o(A)},C=k=>{const A=k.target.value,T=A?Number(A):null,P=l?Number(l):null;s==null||s(T,{department_id:P})};return r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Doctor & Department"}),r.jsx("span",{className:"text-sm font-medium text-slate-900",children:n})]}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"Choose the admitting department and responsible doctor for this stay."})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[r.jsx(ra,{className:"h-4 w-4 text-slate-500"}),r.jsx("span",{className:"font-medium",children:"Department"})]}),r.jsxs("div",{className:"relative",children:[u&&r.jsx(ss,{className:"absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 animate-spin text-slate-400"}),r.jsxs("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:l,onChange:_,disabled:u,children:[r.jsx("option",{value:"",children:u?"Loading departments":"Select department"}),a.map(k=>r.jsx("option",{value:k.id,children:k.name},k.id))]})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[r.jsx(_s,{className:"h-4 w-4 text-slate-500"}),r.jsx("span",{className:"font-medium",children:"Doctor"})]}),r.jsxs("div",{className:"relative",children:[m&&r.jsx(ss,{className:"absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 animate-spin text-slate-400"}),r.jsxs("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:t||"",onChange:C,disabled:!l||m||c.length===0,children:[r.jsx("option",{value:"",children:m?"Loading doctors":l?c.length===0?"No doctors in this department":"Select doctor":"Select department first"}),c.map(k=>r.jsxs("option",{value:k.id,children:[k.name,k.email?` (${k.email})`:""]},k.id))]})]})]})]}),j&&r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-2xl border border-emerald-200 bg-emerald-50 px-3 py-2 text-xs text-emerald-800",children:[r.jsx(Ur,{className:"h-4 w-4"}),r.jsx("span",{className:"font-semibold",children:"Selected doctor:"}),r.jsx("span",{className:"font-medium",children:j.name}),j.email&&r.jsxs("span",{className:"text-emerald-700",children:[" ",j.email]})]}),b&&r.jsxs("div",{className:"flex items-start gap-2 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[r.jsx(yn,{className:"mt-0.5 h-4 w-4"}),r.jsx("span",{children:b})]})]})}function Aue({kind:t="success",title:s,message:n,onClose:a}){const i={success:{bg:"bg-emerald-50",border:"border-emerald-200",text:"text-emerald-700",Icon:Ur},warn:{bg:"bg-amber-50",border:"border-amber-200",text:"text-amber-800",Icon:So},error:{bg:"bg-rose-50",border:"border-rose-200",text:"text-rose-700",Icon:w3}},l=i[t]||i.success;return r.jsxs("div",{className:`flex w-full max-w-md items-start gap-3 rounded-xl border ${l.border} ${l.bg} p-3 shadow-lg`,children:[r.jsx(l.Icon,{className:`mt-0.5 h-5 w-5 ${l.text}`}),r.jsxs("div",{className:"text-sm",children:[r.jsx("div",{className:"font-medium",children:s}),n?r.jsx("div",{className:"mt-0.5 text-[13px] opacity-90",children:n}):null]}),r.jsx("button",{className:"ml-auto inline-flex h-7 w-7 items-center justify-center rounded-lg hover:bg-black/5",onClick:a,"aria-label":"Close",type:"button",children:r.jsx(Rn,{className:"h-4 w-4"})})]})}const no=t=>typeof t=="number"?Number.isInteger(t)&&t>0:typeof t=="string"&&t.trim()!==""&&/^\d+$/.test(t)?Number(t)>0:!1,Eue=t=>t?t.length===16?`${t}:00`:t:void 0;function Tue(){const[t,s]=y.useState([]),[n,a]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(null),[d,u]=y.useState(null),[f,m]=y.useState(null),[x,b]=y.useState(null),[w,j]=y.useState({admission_type:"planned",expected_discharge_at:"",package_id:"",payor_type:"cash",insurer_name:"",policy_number:"",preliminary_diagnosis:"",history:"",care_plan:""}),[_,C]=y.useState(null),k=y.useRef(null),A=I=>{k.current&&clearTimeout(k.current),C(I),k.current=setTimeout(()=>C(null),4500)},T=y.useMemo(()=>t.find(I=>I.id===Number(x))||null,[t,x]);y.useEffect(()=>{let I=!0;return(async()=>{var O,M;l(!0);try{const[B,L]=await Promise.all([rl(),hB()]);if(!I)return;s(B.data||[]),a(L.data||[])}catch(B){A({kind:"error",title:"Failed to load data",message:((M=(O=B==null?void 0:B.response)==null?void 0:O.data)==null?void 0:M.detail)||"Could not load beds / packages. Please refresh and try again."})}finally{I&&l(!1)}})(),()=>{I=!1}},[]);const P=async I=>{try{const{data:O}=await Fb({status:"admitted",patient_id:I});return Array.isArray(O)&&O.length>0?O[0]:null}catch{return null}},R=async I=>{var M;if(I.preventDefault(),i)return;if(!no(o)){A({kind:"warn",title:"Select a patient",message:"Pick a patient before admitting."});return}if(!no(x)){A({kind:"warn",title:"Select a bed",message:"Choose Ward  Room  Bed."});return}if(!t.find(B=>B.id===Number(x))){A({kind:"warn",title:"Selected bed is unavailable",message:"Refresh beds and select again."});return}l(!0);try{const B=await P(Number(o));if(B!=null&&B.id){const V=`ADM-${String(B.id).padStart(6,"0")}`;A({kind:"warn",title:"Patient already admitted",message:`Active admission ${V} exists. Open Tracking / My Admissions to view.`});return}const L={patient_id:Number(o),bed_id:Number(x),admission_type:w.admission_type||"planned",expected_discharge_at:Eue(w.expected_discharge_at),department_id:no(d)?Number(d):void 0,practitioner_user_id:no(f)?Number(f):void 0,package_id:no(w.package_id)?Number(w.package_id):void 0,payor_type:w.payor_type||"cash",insurer_name:w.insurer_name||"",policy_number:w.policy_number||"",preliminary_diagnosis:w.preliminary_diagnosis||"",history:w.history||"",care_plan:w.care_plan||""};Object.keys(L).forEach(V=>L[V]===void 0&&delete L[V]);const{data:F}=await tde(L);A({kind:"success",title:"Admission created",message:`Admission ADM-${String(F.id).padStart(6,"0")} has been created successfully.`});try{const V=await rl();s(V.data||[])}catch{}b(null),j(V=>({...V,expected_discharge_at:"",preliminary_diagnosis:"",history:"",care_plan:"",package_id:"",payor_type:"cash",insurer_name:"",policy_number:""}))}catch(B){const L=(M=B==null?void 0:B.response)==null?void 0:M.data,F=Array.isArray(L==null?void 0:L.detail)?L.detail.map(U=>U==null?void 0:U.msg).filter(Boolean).join(", "):(L==null?void 0:L.detail)||B.message||"Failed to create admission",V=/Bed not found/i.test(F)?"Please select a valid bed.":/Bed not available/i.test(F)?"That bed is not available. Pick another one.":F;A({kind:"error",title:"Admission failed",message:V})}finally{l(!1)}};return r.jsxs("div",{className:"min-h-screen bg-slate-50 px-4 py-4 md:px-6 md:py-6 text-black",children:[_&&r.jsx("div",{className:"fixed inset-x-0 top-16 z-50 flex justify-center px-4 sm:justify-end sm:px-6",children:r.jsx(Aue,{kind:_.kind,title:_.title,message:_.message,onClose:()=>C(null)})}),r.jsxs("div",{className:"mx-auto flex max-w-6xl flex-col gap-3 md:flex-row md:items-center md:justify-between mb-4",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl font-semibold tracking-tight text-slate-900",children:"IPD Admission"}),r.jsx("p",{className:"mt-1 max-w-2xl text-sm text-slate-600",children:"Use this screen to admit an in-patient. Select the patient, assign a primary doctor and bed, and capture admission details and payer information. The system will automatically prevent duplicate active admissions for the same patient."})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[r.jsx(on,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{className:"leading-tight",children:[r.jsx("span",{className:"font-medium text-slate-800",children:"Step 1"}),r.jsx("br",{}),"Pick patient"]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[r.jsx(dr,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{className:"leading-tight",children:[r.jsx("span",{className:"font-medium text-slate-800",children:"Step 2"}),r.jsx("br",{}),"Doctor & details"]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[r.jsx(Jn,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{className:"leading-tight",children:[r.jsx("span",{className:"font-medium text-slate-800",children:"Step 3"}),r.jsx("br",{}),"Assign bed"]})]})]})]}),r.jsx("div",{className:"mx-auto max-w-6xl",children:r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm",children:[r.jsx("div",{className:"border-b border-slate-200 px-4 py-3",children:r.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:items-center sm:justify-between",children:[r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"New Admission"}),r.jsx("span",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:"IPD  Admission Management"})]})}),r.jsx(gn,{anyOf:["ipd.manage"],fallback:r.jsxs("div",{className:"p-4 text-xs text-amber-700 bg-amber-50 border-t border-amber-200 rounded-b-2xl",children:["You do not have permission to create admissions. Please contact the administrator to enable ",r.jsx("span",{className:"font-semibold",children:"IPD Manage"})," access."]}),children:r.jsxs("form",{onSubmit:R,className:"space-y-6 p-4 md:p-6 text-sm",children:[r.jsxs("section",{className:"space-y-2",children:[r.jsx(kue,{value:o??void 0,onChange:c}),no(o)&&r.jsx("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-600",children:"Tip: If this patient already has an active admission, you will see a warning and the system will block duplicate admission."})]}),r.jsx("section",{className:"space-y-2",children:r.jsx(Fo,{label:"Primary doctor  Department  Role  User",value:f??void 0,onChange:(I,O)=>{m(I||null),u((O==null?void 0:O.department_id)||null)}})}),r.jsxs("section",{className:"space-y-2",children:[r.jsx(vB,{value:x??"",onChange:I=>b(no(I)?Number(I):null)}),T&&r.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-700",children:[r.jsx("span",{className:"text-slate-500",children:"Selected bed: "}),r.jsx("span",{className:"font-medium text-slate-900",children:T.code}),r.jsx("span",{className:"mx-1 text-slate-400",children:""}),r.jsx("span",{className:"text-slate-500",children:"State: "}),r.jsx("span",{className:["inline-flex items-center rounded-md border px-1.5 py-0.5 text-[11px]",T.state==="vacant"?"border-emerald-200 bg-emerald-50 text-emerald-700":T.state==="reserved"?"border-amber-200 bg-amber-50 text-amber-700":"border-slate-200 bg-slate-100 text-slate-700"].join(" "),children:T.state}),T.reserved_until&&r.jsxs("span",{className:"ml-2 text-slate-500",children:["until"," ",new Date(T.reserved_until).toLocaleString()]})]})]}),r.jsxs("section",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Admission details"}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"Choose admission type, expected discharge and payer details."})]}),(()=>{const I=["insurance","tpa"].includes(w.payor_type);return r.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs text-slate-500",children:"Admission type"}),r.jsx("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:w.admission_type,onChange:O=>j(M=>({...M,admission_type:O.target.value})),children:["planned","emergency","daycare"].map(O=>r.jsx("option",{value:O,children:O},O))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs text-slate-500",children:"Expected discharge"}),r.jsx("input",{type:"datetime-local",className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:w.expected_discharge_at,onChange:O=>j(M=>({...M,expected_discharge_at:O.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs text-slate-500",children:"Package"}),r.jsxs("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:w.package_id,onChange:O=>j(M=>({...M,package_id:O.target.value})),children:[r.jsx("option",{value:"",children:""}),n.map(O=>r.jsx("option",{value:O.id,children:O.name},O.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs text-slate-500",children:"Payor type"}),r.jsx("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:w.payor_type,onChange:O=>j(M=>({...M,payor_type:O.target.value})),children:["cash","insurance","tpa"].map(O=>r.jsx("option",{value:O,children:O},O))})]}),I&&r.jsxs(r.Fragment,{children:[r.jsx("input",{className:"input md:col-span-2 rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Insurer name",value:w.insurer_name,onChange:O=>j(M=>({...M,insurer_name:O.target.value}))}),r.jsx("input",{className:"input rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Policy number",value:w.policy_number,onChange:O=>j(M=>({...M,policy_number:O.target.value}))})]}),r.jsx("input",{className:"input md:col-span-2 rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Preliminary diagnosis",value:w.preliminary_diagnosis,onChange:O=>j(M=>({...M,preliminary_diagnosis:O.target.value}))}),r.jsx("input",{className:"input rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"History",value:w.history,onChange:O=>j(M=>({...M,history:O.target.value}))}),r.jsx("input",{className:"input md:col-span-3 rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Care plan",value:w.care_plan,onChange:O=>j(M=>({...M,care_plan:O.target.value}))})]})})()]}),r.jsxs("div",{className:"flex flex-col gap-2 border-t border-slate-100 pt-4 sm:flex-row sm:items-center sm:justify-end",children:[r.jsx("p",{className:"text-[11px] text-slate-500",children:"Once admitted, you can manage vitals, nursing notes and discharge from the Admission Detail screen."}),r.jsx("button",{type:"submit",className:"btn sm:min-w-[140px]",disabled:i||!no(o)||!no(x),children:i?"Admitting":"Admit patient"})]})]})})]})})]})}function tt(t){const s=Zn(o=>o.user),n=Zn(o=>o.modules)||{};if(!t||!s)return!1;if(s.is_admin||(s.roles||[]).some(o=>o.name==="Admin"||o.code==="admin"))return!0;const[i]=t.split(".");return(n[i]||[]).some(o=>o.code===t)}function z_(t){const s=Zn(l=>l.user),n=Zn(l=>l.modules)||{};if(!t||!s)return!1;if(s.is_admin)return!0;const[a]=t.split(".");return(n[a]||[]).some(l=>l.code===t)}const Pue=["Conscious, oriented, stable","Conscious, disoriented","Drowsy but arousable","Unconscious","Restless / agitated","Breathless / tachypnoeic","Post-op stable","Critical, on ventilator"],Iue=["Dressing clean, dry, intact","Dressing slightly soaked","Dressing soaked  change required","Oozing serous discharge","Oozing blood","Redness / swelling around wound","Signs of infection  pus / foul smell"],Mue=["Room air","Nasal cannula 2 L/min","Nasal cannula 4 L/min","Simple face mask 5 L/min","NRBM 10 L/min","HFNC","BiPAP","Ventilator  pressure mode","Ventilator  volume mode"],Due=["None","Foley catheter in situ","Ryles tube in situ","Intercostal drain (ICD) in situ","Wound drain in situ","Central line in situ","Multiple drains / tubes present"],Oue=[{value:"routine",label:"Routine note"},{value:"incident",label:"Incident note"},{value:"shift_handover",label:"Shift handover note"}];function Rue({admissionId:t,canWrite:s}){const n=z_("ipd.nursing.create"),a=(s??!0)&&n,[i,l]=y.useState([]),[o,c]=y.useState(null),[d,u]=y.useState({entry_time:"",note_type:"routine",patient_condition:"",wound_status:"",oxygen_support:"",urine_output:"",drains_tubes:"",pain_score:"",other_findings:"",significant_events:"",nursing_interventions:"",response_progress:"",handover_note:"",shift:"",is_icu:!1,vital_signs_summary:"",todays_procedures:"",current_condition:"",recent_changes:"",ongoing_treatment:"",watch_next_shift:""}),[f,m]=y.useState(!1),[x,b]=y.useState(!1),[w,j]=y.useState(""),_=d.note_type==="shift_handover",C=()=>u({entry_time:"",note_type:"routine",patient_condition:"",wound_status:"",oxygen_support:"",urine_output:"",drains_tubes:"",pain_score:"",other_findings:"",significant_events:"",nursing_interventions:"",response_progress:"",handover_note:"",shift:"",is_icu:!1,vital_signs_summary:"",todays_procedures:"",current_condition:"",recent_changes:"",ongoing_treatment:"",watch_next_shift:""}),k=O=>{if(!O)return"";const M=new Date(O);return Number.isNaN(M.getTime())?"":M.toLocaleString()},A=y.useMemo(()=>!!(o&&(o.bp_systolic||o.temp_c||o.pulse)),[o]),T=async()=>{var O,M,B;if(t){m(!0),j("");try{const[L,F]=await Promise.allSettled([rde(t),ide(t)]);L.status==="fulfilled"?l(L.value.data||[]):j(((B=(M=(O=L.reason)==null?void 0:O.response)==null?void 0:M.data)==null?void 0:B.detail)||"Failed to load nursing notes"),F.status==="fulfilled"&&c(F.value.data||null)}finally{m(!1)}}};y.useEffect(()=>{T()},[t]);const P=O=>M=>{const B=M.target.type==="checkbox"?M.target.checked:M.target.value;u(L=>({...L,[O]:B}))},R=async O=>{var M,B;O.preventDefault(),j(""),b(!0);try{const L={entry_time:d.entry_time?new Date(d.entry_time).toISOString():void 0,note_type:d.note_type||"routine",patient_condition:d.patient_condition||"",wound_status:d.wound_status||"",oxygen_support:d.oxygen_support||"",urine_output:d.urine_output||"",drains_tubes:d.drains_tubes||"",pain_score:d.pain_score||"",other_findings:d.other_findings||"",significant_events:d.significant_events||"",nursing_interventions:d.nursing_interventions||"",response_progress:d.response_progress||"",handover_note:d.handover_note||"",shift:d.shift||null,is_icu:!!d.is_icu,vital_signs_summary:d.vital_signs_summary||"",todays_procedures:d.todays_procedures||"",current_condition:d.current_condition||"",recent_changes:d.recent_changes||"",ongoing_treatment:d.ongoing_treatment||"",watch_next_shift:d.watch_next_shift||"",linked_vital_id:(o==null?void 0:o.id)||void 0};await ade(t,L),C(),await T()}catch(L){j(((B=(M=L==null?void 0:L.response)==null?void 0:M.data)==null?void 0:B.detail)||"Failed to save nursing note")}finally{b(!1)}},I=O=>{const M=O.note_type||"routine";return M==="incident"?r.jsx("span",{className:"inline-flex items-center rounded-full bg-rose-50 px-2 py-0.5 text-[10px] font-medium uppercase tracking-wide text-rose-700",children:"Incident"}):M==="shift_handover"?r.jsx("span",{className:"inline-flex items-center rounded-full bg-amber-50 px-2 py-0.5 text-[10px] font-medium uppercase tracking-wide text-amber-700",children:"Shift Handover"}):r.jsx("span",{className:"inline-flex items-center rounded-full bg-emerald-50 px-2 py-0.5 text-[10px] font-medium uppercase tracking-wide text-emerald-700",children:"Routine"})};return r.jsxs("div",{className:"space-y-4",children:[!a&&r.jsxs("div",{className:"flex items-start gap-2 rounded-xl border border-amber-200 bg-amber-50 p-3 text-xs text-amber-800",children:[r.jsx(So,{className:"mt-0.5 h-4 w-4"}),r.jsxs("div",{children:[r.jsx("div",{className:"font-semibold",children:"View-only access"}),r.jsx("div",{children:"You dont have permission to add nursing notes."})]})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/80 p-3 md:p-4",children:[r.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Qh,{className:"h-4 w-4 text-slate-700"}),r.jsx("span",{className:"text-sm font-semibold text-slate-800",children:"Latest Vitals Snapshot"})]}),r.jsxs("div",{className:"flex items-center gap-1 text-xs text-slate-500",children:[r.jsx(Sa,{className:"h-3 w-3"}),r.jsx("span",{children:o!=null&&o.recorded_at?k(o.recorded_at):"No recent vitals"})]})]}),A?r.jsxs("div",{className:"grid gap-2 text-xs md:grid-cols-5",children:[r.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-white px-2 py-1.5 shadow-sm",children:[r.jsx(sn,{className:"h-3.5 w-3.5 text-slate-700"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[10px] uppercase tracking-wide text-slate-400",children:"BP"}),r.jsxs("div",{className:"font-semibold text-slate-800",children:[o.bp_systolic??"","/",o.bp_diastolic??""," mmHg"]})]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-white px-2 py-1.5 shadow-sm",children:[r.jsx(Tp,{className:"h-3.5 w-3.5 text-slate-700"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[10px] uppercase tracking-wide text-slate-400",children:"Temp"}),r.jsxs("div",{className:"font-semibold text-slate-800",children:[o.temp_c??""," C"]})]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-white px-2 py-1.5 shadow-sm",children:[r.jsx(Une,{className:"h-3.5 w-3.5 text-slate-700"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[10px] uppercase tracking-wide text-slate-400",children:"RR"}),r.jsxs("div",{className:"font-semibold text-slate-800",children:[o.rr??"","/min"]})]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-white px-2 py-1.5 shadow-sm",children:[r.jsx(h_,{className:"h-3.5 w-3.5 text-slate-700"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[10px] uppercase tracking-wide text-slate-400",children:"SpO"}),r.jsxs("div",{className:"font-semibold text-slate-800",children:[o.spo2??""," %"]})]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-white px-2 py-1.5 shadow-sm",children:[r.jsx(sn,{className:"h-3.5 w-3.5 text-slate-700"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[10px] uppercase tracking-wide text-slate-400",children:"Pulse"}),r.jsxs("div",{className:"font-semibold text-slate-800",children:[o.pulse??"","/min"]})]})]})]}):r.jsx("div",{className:"rounded-lg border border-dashed border-slate-200 bg-white px-3 py-2 text-xs text-slate-500",children:"No vitals recorded yet for this admission. Vitals should be entered in the Vitals tab  nursing notes will automatically link to the latest record."})]}),a&&r.jsxs("form",{onSubmit:R,className:"rounded-2xl border border-slate-200 bg-white p-3 shadow-sm md:p-4",children:[r.jsxs("div",{className:"mb-3 flex flex-wrap items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(dr,{className:"h-4 w-4 text-slate-700"}),r.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Add Nursing Note"})]}),r.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-500",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-600",children:"Note type"}),r.jsx("select",{className:"rounded-full border border-slate-200 bg-slate-50 px-2 py-1 text-[11px] text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",value:d.note_type,onChange:P("note_type"),children:Oue.map(O=>r.jsx("option",{value:O.value,children:O.label},O.value))})]}),r.jsxs("label",{className:"flex items-center gap-1",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300",checked:d.is_icu,onChange:P("is_icu")}),r.jsx("span",{children:"ICU note"})]})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Entry time"}),r.jsx("input",{type:"datetime-local",className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",value:d.entry_time,onChange:P("entry_time")}),r.jsx("p",{className:"text-[10px] text-slate-400",children:"Leave blank to use current date & time."})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Patient condition"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",value:d.patient_condition,onChange:P("patient_condition"),children:[r.jsx("option",{value:"",children:"Select condition"}),Pue.map(O=>r.jsx("option",{value:O,children:O},O))]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Wound status"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",value:d.wound_status,onChange:P("wound_status"),children:[r.jsx("option",{value:"",children:"Select wound status"}),Iue.map(O=>r.jsx("option",{value:O,children:O},O))]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Oxygen support"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",value:d.oxygen_support,onChange:P("oxygen_support"),children:[r.jsx("option",{value:"",children:"Select oxygen support"}),Mue.map(O=>r.jsx("option",{value:O,children:O},O))]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Urine output"}),r.jsx("input",{className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",placeholder:"E.g. 200 ml clear in last 4 hrs; catheter in situ",value:d.urine_output,onChange:P("urine_output")})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Drains / Tubes"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",value:d.drains_tubes,onChange:P("drains_tubes"),children:[r.jsx("option",{value:"",children:"Select drains / tubes"}),Due.map(O=>r.jsx("option",{value:O,children:O},O))]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Pain score"}),r.jsx("input",{className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",placeholder:"E.g. 3/10 on VAS",value:d.pain_score,onChange:P("pain_score")})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Shift"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",value:d.shift,onChange:P("shift"),children:[r.jsx("option",{value:"",children:"Select shift"}),r.jsx("option",{value:"Morning",children:"Morning"}),r.jsx("option",{value:"Evening",children:"Evening"}),r.jsx("option",{value:"Night",children:"Night"})]})]}),r.jsxs("div",{className:"md:col-span-2 space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Significant events"}),r.jsx("textarea",{className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",rows:2,placeholder:"Shifting, fall, vomiting, seizure, desaturation, transfusion",value:d.significant_events,onChange:P("significant_events")})]}),r.jsxs("div",{className:"md:col-span-2 space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Nursing interventions"}),r.jsx("textarea",{className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",rows:2,placeholder:"Medications given, oxygen started, IV fluids, dressing, catheter care",value:d.nursing_interventions,onChange:P("nursing_interventions")})]}),r.jsxs("div",{className:"md:col-span-2 space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Patient response / progress"}),r.jsx("textarea",{className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",rows:2,placeholder:"Improved / no change / worsened, tolerance to interventions",value:d.response_progress,onChange:P("response_progress")})]}),r.jsxs("div",{className:"md:col-span-2 space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Handover note"}),r.jsx("textarea",{className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",rows:2,placeholder:"What next nurse must watch / continue",value:d.handover_note,onChange:P("handover_note")})]}),r.jsxs("div",{className:"md:col-span-2 space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Other findings"}),r.jsx("textarea",{className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",rows:2,placeholder:"Any other clinical observations",value:d.other_findings,onChange:P("other_findings")})]})]}),_&&r.jsxs("div",{className:"mt-4 rounded-2xl border border-amber-200 bg-amber-50/60 p-3 md:p-4",children:[r.jsx("div",{className:"mb-2 text-xs font-semibold uppercase tracking-wide text-amber-700",children:"Shift Handover Details"}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"md:col-span-2 space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Vital signs summary"}),r.jsx("textarea",{className:"w-full rounded-lg border border-amber-200 bg-white px-2 py-1.5 text-xs text-slate-800 focus:border-amber-400 focus:outline-none focus:ring-1 focus:ring-amber-300",rows:2,placeholder:"E.g. Vitals stable, BP 120/80, HR 80/min, SpO 98% on room air",value:d.vital_signs_summary,onChange:P("vital_signs_summary")})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Todays procedures"}),r.jsx("textarea",{className:"w-full rounded-lg border border-amber-200 bg-white px-2 py-1.5 text-xs text-slate-800 focus:border-amber-400 focus:outline-none focus:ring-1 focus:ring-amber-300",rows:2,placeholder:"Dressings, transfusions, physiotherapy, procedures done this shift",value:d.todays_procedures,onChange:P("todays_procedures")})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Current condition"}),r.jsx("textarea",{className:"w-full rounded-lg border border-amber-200 bg-white px-2 py-1.5 text-xs text-slate-800 focus:border-amber-400 focus:outline-none focus:ring-1 focus:ring-amber-300",rows:2,placeholder:"Short summary: stable / critical / pain level / oxygen support",value:d.current_condition,onChange:P("current_condition")})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Recent changes"}),r.jsx("textarea",{className:"w-full rounded-lg border border-amber-200 bg-white px-2 py-1.5 text-xs text-slate-800 focus:border-amber-400 focus:outline-none focus:ring-1 focus:ring-amber-300",rows:2,placeholder:"New symptoms, change in vitals, changes in orders this shift",value:d.recent_changes,onChange:P("recent_changes")})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Ongoing treatment"}),r.jsx("textarea",{className:"w-full rounded-lg border border-amber-200 bg-white px-2 py-1.5 text-xs text-slate-800 focus:border-amber-400 focus:outline-none focus:ring-1 focus:ring-amber-300",rows:2,placeholder:"IV fluids, antibiotics, oxygen therapy, infusions",value:d.ongoing_treatment,onChange:P("ongoing_treatment")})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"To be watched next shift"}),r.jsx("textarea",{className:"w-full rounded-lg border border-amber-200 bg-white px-2 py-1.5 text-xs text-slate-800 focus:border-amber-400 focus:outline-none focus:ring-1 focus:ring-amber-300",rows:2,placeholder:"Risks, observations, next dose timings, lab results to follow up",value:d.watch_next_shift,onChange:P("watch_next_shift")})]})]})]}),r.jsxs("div",{className:"mt-4 flex items-center justify-between gap-2",children:[w&&r.jsx("div",{className:"text-xs text-rose-600",children:w}),r.jsx("button",{type:"submit",disabled:x,className:"ml-auto inline-flex items-center gap-1 rounded-full bg-sky-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-sky-700 disabled:cursor-not-allowed disabled:bg-sky-300",children:x?"Saving":"Add Nursing Note"})]})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm",children:[r.jsxs("div",{className:"flex items-center justify-between px-3 py-2 md:px-4",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(dr,{className:"h-4 w-4 text-slate-700"}),r.jsx("span",{className:"text-sm font-semibold text-slate-800",children:"Recent Nursing Notes"})]}),f&&r.jsx("span",{className:"text-xs text-slate-500",children:"Loading"})]}),!f&&(!i||i.length===0)&&r.jsx("div",{className:"px-3 py-4 text-sm text-slate-500 md:px-4",children:"No nursing notes recorded yet."}),!f&&i&&i.length>0&&r.jsx("div",{className:"divide-y divide-slate-100",children:i.map(O=>r.jsxs("div",{className:"px-3 py-3 text-xs text-slate-800 md:px-4",children:[r.jsxs("div",{className:"mb-1 flex flex-wrap items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-100 px-2 py-0.5 text-[11px] font-medium text-slate-700",children:[r.jsx(Sa,{className:"h-3 w-3"}),k(O.entry_time)]}),I(O),O.shift&&r.jsx("span",{className:"inline-flex items-center rounded-full bg-sky-50 px-2 py-0.5 text-[10px] font-medium uppercase tracking-wide text-sky-700",children:O.shift}),O.is_icu&&r.jsx("span",{className:"inline-flex items-center rounded-full bg-rose-50 px-2 py-0.5 text-[10px] font-medium uppercase tracking-wide text-rose-700",children:"ICU"})]}),O.nurse&&r.jsxs("div",{className:"flex items-center gap-1 text-[11px] text-slate-500",children:[r.jsx(on,{className:"h-3 w-3"}),r.jsx("span",{children:O.nurse.full_name})]})]}),O.vitals&&r.jsxs("div",{className:"mb-2 flex flex-wrap gap-1.5 text-[11px] text-slate-600",children:[r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-50 px-1.5 py-0.5",children:[r.jsx(sn,{className:"h-3 w-3"}),"BP:"," ",O.vitals.bp_systolic??"","/",O.vitals.bp_diastolic??""]}),r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-50 px-1.5 py-0.5",children:[r.jsx(Tp,{className:"h-3 w-3"}),"Temp: ",O.vitals.temp_c??""," C"]}),r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-50 px-1.5 py-0.5",children:[r.jsx(sn,{className:"h-3 w-3"}),"Pulse: ",O.vitals.pulse??"","/min"]}),r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-50 px-1.5 py-0.5",children:[r.jsx(h_,{className:"h-3 w-3"}),"SpO: ",O.vitals.spo2??""," %"]})]}),r.jsxs("div",{className:"space-y-0.5",children:[O.patient_condition&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Condition: "}),r.jsx("span",{children:O.patient_condition})]}),O.wound_status&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Wound: "}),r.jsx("span",{children:O.wound_status})]}),O.oxygen_support&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Oxygen: "}),r.jsx("span",{children:O.oxygen_support})]}),O.urine_output&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Urine: "}),r.jsx("span",{children:O.urine_output})]}),O.drains_tubes&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Drains/Tubes: "}),r.jsx("span",{children:O.drains_tubes})]}),O.pain_score&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Pain: "}),r.jsx("span",{children:O.pain_score})]}),O.significant_events&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Events: "}),r.jsx("span",{children:O.significant_events})]}),O.nursing_interventions&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Interventions: "}),r.jsx("span",{children:O.nursing_interventions})]}),O.response_progress&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Response: "}),r.jsx("span",{children:O.response_progress})]}),O.handover_note&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Handover: "}),r.jsx("span",{children:O.handover_note})]}),O.other_findings&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Other: "}),r.jsx("span",{children:O.other_findings})]}),O.note_type==="shift_handover"&&r.jsxs("div",{className:"mt-2 rounded-xl border border-amber-100 bg-amber-50/60 p-2 space-y-0.5",children:[O.vital_signs_summary&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Vital signs summary: "}),r.jsx("span",{children:O.vital_signs_summary})]}),O.todays_procedures&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Todays procedures: "}),r.jsx("span",{children:O.todays_procedures})]}),O.current_condition&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Current condition: "}),r.jsx("span",{children:O.current_condition})]}),O.recent_changes&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Recent changes: "}),r.jsx("span",{children:O.recent_changes})]}),O.ongoing_treatment&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Ongoing treatment: "}),r.jsx("span",{children:O.ongoing_treatment})]}),O.watch_next_shift&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"To be watched next shift: "}),r.jsx("span",{children:O.watch_next_shift})]})]})]})]},O.id))})]}),w&&!a&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 p-2 text-xs text-rose-700",children:w})]})}function Lue({admissionId:t,canWrite:s}){const n=tt("ipd.nursing"),a=typeof s=="boolean"?s:n,[i,l]=y.useState([]),[o,c]=y.useState({recorded_at:"",bp_systolic:"",bp_diastolic:"",temp_c:"",rr:"",spo2:"",pulse:""}),[d,u]=y.useState(""),[f,m]=y.useState(!1),[x,b]=y.useState(!1),w=y.useMemo(()=>i&&i.length>0?i[0]:null,[i]),j=async()=>{var A,T;if(t){m(!0),u("");try{const{data:P}=await lde(t),R=Array.isArray(P)?P:[];R.sort((I,O)=>new Date(O.recorded_at||0)-new Date(I.recorded_at||0)),l(R)}catch(P){console.error("Vitals load error:",P),u(((T=(A=P==null?void 0:P.response)==null?void 0:A.data)==null?void 0:T.detail)||"Failed to load vitals"),l([])}finally{m(!1)}}};y.useEffect(()=>{j()},[t]);const _=(A,T)=>{c(P=>({...P,[A]:T}))},C=async A=>{var P,R;if(A.preventDefault(),u(""),!(o.recorded_at||o.bp_systolic||o.bp_diastolic||o.temp_c||o.rr||o.spo2||o.pulse)){u("Please enter at least one vital value before saving.");return}try{b(!0);const I={recorded_at:o.recorded_at?new Date(o.recorded_at).toISOString():void 0,bp_systolic:o.bp_systolic?Number(o.bp_systolic):void 0,bp_diastolic:o.bp_diastolic?Number(o.bp_diastolic):void 0,temp_c:o.temp_c?Number(o.temp_c):void 0,rr:o.rr?Number(o.rr):void 0,spo2:o.spo2?Number(o.spo2):void 0,pulse:o.pulse?Number(o.pulse):void 0};await Xde(t,I),c({recorded_at:"",bp_systolic:"",bp_diastolic:"",temp_c:"",rr:"",spo2:"",pulse:""}),await j()}catch(I){console.error("Vitals save error:",I),u(((R=(P=I==null?void 0:I.response)==null?void 0:P.data)==null?void 0:R.detail)||"Failed to save vitals")}finally{b(!1)}},k=A=>{if(!A)return"";try{const T=new Date(A);return Number.isNaN(T.getTime())?"":T.toLocaleString(void 0,{dateStyle:"short",timeStyle:"short"})}catch{return""}};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-base font-semibold text-slate-900",children:"Vitals"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Track blood pressure, temperature, pulse, SpO and respiratory rate."})]}),w&&r.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-700",children:[r.jsx("div",{className:"font-medium text-[11px] uppercase tracking-wide text-slate-500",children:"Last recorded"}),r.jsx("div",{className:"mt-0.5 text-[13px]",children:k(w.recorded_at)}),r.jsxs("div",{className:"mt-1 flex flex-wrap gap-2 text-[11px]",children:[r.jsxs("span",{className:"rounded-full bg-white px-2 py-0.5 border border-slate-200",children:["BP:"," ",[w.bp_systolic,w.bp_diastolic].filter(Boolean).join("/")||""]}),r.jsxs("span",{className:"rounded-full bg-white px-2 py-0.5 border border-slate-200",children:["Temp: ",w.temp_c??""," C"]}),r.jsxs("span",{className:"rounded-full bg-white px-2 py-0.5 border border-slate-200",children:["SpO: ",w.spo2??""," %"]}),r.jsxs("span",{className:"rounded-full bg-white px-2 py-0.5 border border-slate-200",children:["Pulse: ",w.pulse??""," /min"]})]})]})]}),!a&&r.jsx("div",{className:"rounded-lg border border-amber-200 bg-amber-50 px-3 py-2 text-xs text-amber-700",children:"View only. You dont have permission to record vitals."}),a&&r.jsxs("form",{onSubmit:C,className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("h3",{className:"text-sm font-medium text-slate-900",children:"Record new vitals"}),r.jsx("span",{className:"text-[11px] text-slate-500",children:"Fields are optional  fill what is measured."})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-4 lg:grid-cols-6",children:[r.jsxs("div",{className:"md:col-span-2 lg:col-span-2",children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"Recorded at"}),r.jsx("input",{type:"datetime-local",className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2.5 py-1.5 text-xs text-slate-900 outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",value:o.recorded_at,onChange:A=>_("recorded_at",A.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"BP (Systolic)"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",placeholder:"mmHg",value:o.bp_systolic,onChange:A=>_("bp_systolic",A.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"BP (Diastolic)"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",placeholder:"mmHg",value:o.bp_diastolic,onChange:A=>_("bp_diastolic",A.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"Temp (C)"}),r.jsx("input",{type:"number",step:"0.1",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",placeholder:"C",value:o.temp_c,onChange:A=>_("temp_c",A.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"RR (/min)"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",placeholder:"breaths/min",value:o.rr,onChange:A=>_("rr",A.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"SpO (%)"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",placeholder:"%",value:o.spo2,onChange:A=>_("spo2",A.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"Pulse (/min)"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",placeholder:"/min",value:o.pulse,onChange:A=>_("pulse",A.target.value)})]})]}),r.jsxs("div",{className:"flex items-center justify-between pt-1",children:[d&&r.jsx("div",{className:"text-xs text-rose-600",children:d}),r.jsxs("button",{type:"submit",disabled:x,className:"inline-flex items-center gap-1 rounded-lg bg-sky-600 px-4 py-1.5 text-xs font-medium text-white shadow-sm hover:bg-sky-700 disabled:cursor-not-allowed disabled:opacity-60",children:[x&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border border-white border-t-transparent"}),r.jsx("span",{children:x?"Saving":"Record vitals"})]})]})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between border-b border-slate-100 px-3 py-2",children:[r.jsx("div",{className:"text-xs font-medium text-slate-700",children:"Vitals history"}),r.jsx("div",{className:"text-[11px] text-slate-500",children:f?"Loading":`${(i==null?void 0:i.length)||0} record${((i==null?void 0:i.length)||0)===1?"":"s"}`})]}),r.jsx("div",{className:"max-h-[320px] overflow-auto text-xs",children:r.jsxs("table",{className:"min-w-full border-collapse",children:[r.jsx("thead",{className:"sticky top-0 bg-slate-50 text-[11px] uppercase tracking-wide text-slate-500",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Time"}),r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"BP (mmHg)"}),r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Temp (C)"}),r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"RR (/min)"}),r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"SpO (%)"}),r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Pulse (/min)"})]})}),r.jsxs("tbody",{children:[!f&&i&&i.map(A=>r.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:k(A.recorded_at)}),r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:[A.bp_systolic,A.bp_diastolic].filter(Boolean).join("/")||""}),r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:A.temp_c??""}),r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:A.rr??""}),r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:A.spo2??""}),r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:A.pulse??""})]},A.id)),!f&&(!i||i.length===0)&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-3 py-4 text-center text-slate-400",children:"No vitals recorded yet."})}),f&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-3 py-4 text-center text-slate-400",children:"Loading vitals"})})]})]})})]})]})}function Bue({admissionId:t}){const[s,n]=y.useState([]),[a,i]=y.useState(""),[l,o]=y.useState(!1),[c,d]=y.useState(!1),[u,f]=y.useState({recorded_at:"",intake_ml:"",urine_ml:"",drains_ml:"",stools_count:"",remarks:""}),m=(T,P)=>{f(R=>({...R,[T]:P}))},x=T=>{if(T)return T.length===16?`${T}:00`:T},b=async()=>{var T,P;if(t){i(""),o(!0);try{const{data:R}=await cde(t),I=(R||[]).slice().sort((O,M)=>new Date(M.recorded_at||0)-new Date(O.recorded_at||0));n(I)}catch(R){console.error("I/O load error:",R),i(((P=(T=R==null?void 0:R.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to load intake / output"),n([])}finally{o(!1)}}};y.useEffect(()=>{b()},[t]);const w=async T=>{var R,I;if(T.preventDefault(),i(""),!(u.intake_ml||u.urine_ml||u.drains_ml||u.stools_count)){i("Enter at least one value (Intake / Urine / Drains / Stools).");return}try{d(!0);const O={recorded_at:x(u.recorded_at),intake_ml:u.intake_ml?Number(u.intake_ml):0,urine_ml:u.urine_ml?Number(u.urine_ml):0,drains_ml:u.drains_ml?Number(u.drains_ml):0,stools_count:u.stools_count?Number(u.stools_count):0,remarks:u.remarks||""};await dde(t,O),f({recorded_at:"",intake_ml:"",urine_ml:"",drains_ml:"",stools_count:"",remarks:""}),await b()}catch(O){console.error("I/O save error:",O),i(((I=(R=O==null?void 0:O.response)==null?void 0:R.data)==null?void 0:I.detail)||"Failed to add intake / output")}finally{d(!1)}},j=T=>{if(!T)return"";try{const P=new Date(T);return Number.isNaN(P.getTime())?"":P.toLocaleString(void 0,{dateStyle:"short",timeStyle:"short"})}catch{return""}},_=T=>{if(!T)return"Night";const P=new Date(T);if(Number.isNaN(P.getTime()))return"Night";const R=P.getHours();return R>=6&&R<14?"Morning":R>=14&&R<22?"Evening":"Night"},C=y.useMemo(()=>{if(!s||s.length===0)return null;const T=new Date,P=new Date(T);P.setHours(0,0,0,0);const R=new Date(P);R.setDate(R.getDate()+1);const I={Morning:{intake:0,output:0},Evening:{intake:0,output:0},Night:{intake:0,output:0}};let O=0,M=0;return s.forEach(B=>{const L=new Date(B.recorded_at);if(Number.isNaN(L.getTime())||L<P||L>=R)return;const F=Number(B.intake_ml||0),V=Number(B.urine_ml||0)+Number(B.drains_ml||0);O+=F,M+=V;const U=_(B.recorded_at);I[U].intake+=F,I[U].output+=V}),{date:P,intake:O,output:M,net:O-M,shifts:I}},[s]),k=T=>!T||Number(T)===0?"":`${Number(T)} ml`,A=T=>T===0?"0 ml":`${T>0?"+":""}${T} ml`;return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-base font-semibold text-slate-900",children:"Intake / Output Chart"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Track fluids over 24 hours. Automatically shows total intake, total output, and net balance for today."})]}),r.jsxs("div",{className:"flex flex-col gap-2 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-800",children:[r.jsxs("div",{className:"flex items-center justify-between gap-3",children:[r.jsx("span",{className:"font-medium text-[11px] uppercase tracking-wide text-slate-500",children:"Today's 24-hr balance"}),r.jsx("span",{className:"text-[11px] text-slate-500",children:C?C.date.toLocaleDateString():"No data"})]}),r.jsxs("div",{className:"mt-1 grid grid-cols-3 gap-2",children:[r.jsxs("div",{className:"rounded-xl bg-white px-2 py-1.5 text-center shadow-sm",children:[r.jsx("div",{className:"text-[10px] font-medium text-slate-500",children:"Total Intake"}),r.jsx("div",{className:"text-xs font-semibold text-sky-700",children:C?`${C.intake} ml`:"0 ml"})]}),r.jsxs("div",{className:"rounded-xl bg-white px-2 py-1.5 text-center shadow-sm",children:[r.jsx("div",{className:"text-[10px] font-medium text-slate-500",children:"Total Output"}),r.jsx("div",{className:"text-xs font-semibold text-emerald-700",children:C?`${C.output} ml`:"0 ml"})]}),r.jsxs("div",{className:"rounded-xl bg-white px-2 py-1.5 text-center shadow-sm",children:[r.jsx("div",{className:"text-[10px] font-medium text-slate-500",children:"Net Balance"}),r.jsx("div",{className:`text-xs font-semibold ${C?C.net>=0?"text-sky-800":"text-rose-700":"text-slate-400"}`,children:C?A(C.net):"0 ml"})]})]}),C&&r.jsx("div",{className:"mt-1 grid grid-cols-3 gap-1 text-[10px] text-slate-600",children:["Morning","Evening","Night"].map(T=>r.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white px-1.5 py-1",children:[r.jsx("div",{className:"font-medium text-[10px]",children:T}),r.jsxs("div",{className:"mt-0.5 flex flex-col gap-0.5",children:[r.jsxs("span",{children:["In:"," ",C.shifts[T].intake||C.shifts[T].output?`${C.shifts[T].intake} ml`:""]}),r.jsxs("span",{children:["Out:"," ",C.shifts[T].output||C.shifts[T].intake?`${C.shifts[T].output} ml`:""]})]})]},T))})]})]}),r.jsx(gn,{anyOf:["ipd.nursing"],children:r.jsxs("form",{onSubmit:w,className:"space-y-3 rounded-2xl border border-slate-200 bg-white p-4 shadow-sm",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("h3",{className:"text-sm font-medium text-slate-900",children:"Record Intake / Output"}),r.jsx("span",{className:"text-[11px] text-slate-500",children:"Enter what is measured; others can be left blank."})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-6",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"Date & Time"}),r.jsx("input",{type:"datetime-local",className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2.5 py-1.5 text-xs text-slate-900 outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",value:u.recorded_at,onChange:T=>m("recorded_at",T.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"Intake (ml)"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",placeholder:"Oral / IV / Blood",value:u.intake_ml,onChange:T=>m("intake_ml",T.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"Urine (ml)"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",placeholder:"Foley / voided",value:u.urine_ml,onChange:T=>m("urine_ml",T.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"Drains (ml)"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",placeholder:"Abdominal / chest",value:u.drains_ml,onChange:T=>m("drains_ml",T.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"Stools (count)"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",placeholder:"Number of times",value:u.stools_count,onChange:T=>m("stools_count",T.target.value)})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"Remarks / Description"}),r.jsx("input",{className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",placeholder:"RL, NS, Water, Urine via Foley, Abdominal drain...",value:u.remarks,onChange:T=>m("remarks",T.target.value)})]})]}),r.jsxs("div",{className:"flex items-center justify-between pt-1",children:[a&&r.jsx("div",{className:"text-xs text-rose-600",children:a}),r.jsxs("button",{type:"submit",disabled:c,className:"inline-flex items-center gap-1 rounded-lg bg-sky-600 px-4 py-1.5 text-xs font-medium text-white shadow-sm hover:bg-sky-700 disabled:cursor-not-allowed disabled:opacity-60",children:[c&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border border-white border-t-transparent"}),r.jsx("span",{children:c?"Saving":"Save entry"})]})]})]})}),r.jsxs("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm",children:[r.jsxs("div",{className:"flex items-center justify-between border-b border-slate-100 px-3 py-2 text-xs",children:[r.jsx("div",{className:"font-medium text-slate-700",children:"I/O history"}),r.jsx("div",{className:"text-[11px] text-slate-500",children:l?"Loading":`${(s==null?void 0:s.length)||0} record${((s==null?void 0:s.length)||0)===1?"":"s"}`})]}),r.jsx("div",{className:"max-h-[320px] overflow-auto text-xs",children:r.jsxs("table",{className:"min-w-[680px] w-full border-collapse",children:[r.jsx("thead",{className:"sticky top-0 bg-slate-50 text-[11px] uppercase tracking-wide text-slate-500",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Time"}),r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Intake (ml)"}),r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Urine (ml)"}),r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Drains (ml)"}),r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Stools (count)"}),r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Shift"}),r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Remarks"})]})}),r.jsxs("tbody",{children:[!l&&s&&s.map(T=>r.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:j(T.recorded_at)}),r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:k(T.intake_ml)}),r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:k(T.urine_ml)}),r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:k(T.drains_ml)}),r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:T.stools_count||""}),r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:_(T.recorded_at)}),r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:T.remarks||""})]},T.id)),!l&&(!s||s.length===0)&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"px-3 py-4 text-center text-slate-400",children:"No intake / output entries yet."})}),l&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"px-3 py-4 text-center text-slate-400",children:"Loading intake / output"})})]})]})})]})]})}function Fue({admissionId:t}){const[s,n]=y.useState([]),[a,i]=y.useState(""),[l,o]=y.useState({vital_signs:"",procedure_undergone:"",todays_diagnostics:"",current_condition:"",recent_changes:"",ongoing_treatment:"",possible_changes:"",other_info:""}),c=async()=>{var u,f;i("");try{const{data:m}=await ude(t);n((m||[]).sort((x,b)=>new Date(b.created_at)-new Date(x.created_at)))}catch(m){i(((f=(u=m==null?void 0:m.response)==null?void 0:u.data)==null?void 0:f.detail)||"Failed to load handovers")}};y.useEffect(()=>{c()},[t]);const d=async u=>{var f,m;u.preventDefault(),i("");try{await hde(t,{...l}),o({vital_signs:"",procedure_undergone:"",todays_diagnostics:"",current_condition:"",recent_changes:"",ongoing_treatment:"",possible_changes:"",other_info:""}),await c()}catch(x){i(((m=(f=x==null?void 0:x.response)==null?void 0:f.data)==null?void 0:m.detail)||"Failed to add handover")}};return r.jsxs("div",{className:"space-y-3",children:[r.jsx(gn,{anyOf:["ipd.nursing"],children:r.jsxs("form",{onSubmit:d,className:"rounded-xl border bg-white p-3 grid gap-3 md:grid-cols-2 text-sm",children:[r.jsx("div",{className:"md:col-span-2 font-medium",children:"Shift Handover"}),r.jsx("input",{className:"input",placeholder:"Vital signs",value:l.vital_signs,onChange:u=>o(f=>({...f,vital_signs:u.target.value}))}),r.jsx("input",{className:"input",placeholder:"Procedure undergone",value:l.procedure_undergone,onChange:u=>o(f=>({...f,procedure_undergone:u.target.value}))}),r.jsx("input",{className:"input md:col-span-2",placeholder:"Today's diagnostics/procedures",value:l.todays_diagnostics,onChange:u=>o(f=>({...f,todays_diagnostics:u.target.value}))}),r.jsx("input",{className:"input",placeholder:"Current condition",value:l.current_condition,onChange:u=>o(f=>({...f,current_condition:u.target.value}))}),r.jsx("input",{className:"input",placeholder:"Recent changes",value:l.recent_changes,onChange:u=>o(f=>({...f,recent_changes:u.target.value}))}),r.jsx("input",{className:"input",placeholder:"Ongoing treatment",value:l.ongoing_treatment,onChange:u=>o(f=>({...f,ongoing_treatment:u.target.value}))}),r.jsx("input",{className:"input",placeholder:"Possible changes/complications",value:l.possible_changes,onChange:u=>o(f=>({...f,possible_changes:u.target.value}))}),r.jsx("input",{className:"input md:col-span-2",placeholder:"Other info",value:l.other_info,onChange:u=>o(f=>({...f,other_info:u.target.value}))}),r.jsx("div",{className:"md:col-span-2 flex justify-end",children:r.jsx("button",{className:"btn",children:"Save"})}),a&&r.jsx("div",{className:"md:col-span-2 rounded-xl border border-rose-200 bg-rose-50 p-2 text-rose-700",children:a})]})}),r.jsx("div",{className:"rounded-xl border overflow-hidden",children:r.jsxs("table",{className:"w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"text-left text-xs text-gray-500 bg-gray-50",children:[r.jsx("th",{className:"px-3 py-2",children:"Time"}),r.jsx("th",{className:"px-3 py-2",children:"Vitals"}),r.jsx("th",{className:"px-3 py-2",children:"Procedure"}),r.jsx("th",{className:"px-3 py-2",children:"Diagnostics"}),r.jsx("th",{className:"px-3 py-2",children:"Condition"})]})}),r.jsxs("tbody",{children:[(s||[]).map(u=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-3 py-2",children:new Date(u.created_at).toLocaleString()}),r.jsx("td",{className:"px-3 py-2",children:u.vital_signs||""}),r.jsx("td",{className:"px-3 py-2",children:u.procedure_undergone||""}),r.jsx("td",{className:"px-3 py-2",children:u.todays_diagnostics||""}),r.jsx("td",{className:"px-3 py-2",children:u.current_condition||""})]},u.id)),!(s!=null&&s.length)&&r.jsx("tr",{children:r.jsx("td",{className:"p-3 text-sm text-gray-500",colSpan:5,children:"No handovers"})})]})]})})]})}function $ue({admissionId:t}){const[s,n]=y.useState([]),[a,i]=y.useState(""),[l,o]=y.useState(""),c=async()=>{var u,f;i("");try{const{data:m}=await fde(t);n((m||[]).sort((x,b)=>new Date(b.created_at)-new Date(x.created_at)))}catch(m){i(((f=(u=m==null?void 0:m.response)==null?void 0:u.data)==null?void 0:f.detail)||"Failed to load rounds")}};y.useEffect(()=>{c()},[t]);const d=async u=>{var f,m;u.preventDefault(),i("");try{await mde(t,{notes:l||""}),o(""),await c()}catch(x){i(((m=(f=x==null?void 0:x.response)==null?void 0:f.data)==null?void 0:m.detail)||"Failed to add round")}};return r.jsxs("div",{className:"space-y-3",children:[r.jsx(gn,{anyOf:["ipd.doctor"],children:r.jsxs("form",{onSubmit:d,className:"rounded-xl border bg-white p-3 text-sm space-y-2",children:[r.jsx("div",{className:"font-medium",children:"Add Round Note"}),r.jsx("textarea",{className:"input",rows:3,placeholder:"Notes",value:l,onChange:u=>o(u.target.value)}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{className:"btn",children:"Save"})}),a&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 p-2 text-rose-700",children:a})]})}),r.jsx("div",{className:"rounded-xl border overflow-hidden",children:r.jsxs("table",{className:"w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"text-left text-xs text-gray-500 bg-gray-50",children:[r.jsx("th",{className:"px-3 py-2",children:"Time"}),r.jsx("th",{className:"px-3 py-2",children:"Notes"})]})}),r.jsxs("tbody",{children:[(s||[]).map(u=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-3 py-2",children:new Date(u.created_at).toLocaleString()}),r.jsx("td",{className:"px-3 py-2",children:u.notes||""})]},u.id)),!(s!=null&&s.length)&&r.jsx("tr",{children:r.jsx("td",{className:"p-3 text-sm text-gray-500",colSpan:2,children:"No rounds"})})]})]})})]})}function zue({admissionId:t}){const[s,n]=y.useState([]),[a,i]=y.useState(""),[l,o]=y.useState({observation:"",plan:""}),c=async()=>{var u,f;i("");try{const{data:m}=await pde(t);n((m||[]).sort((x,b)=>new Date(b.created_at)-new Date(x.created_at)))}catch(m){i(((f=(u=m==null?void 0:m.response)==null?void 0:u.data)==null?void 0:f.detail)||"Failed to load progress notes")}};y.useEffect(()=>{c()},[t]);const d=async u=>{var f,m;u.preventDefault(),i("");try{await xde(t,{observation:l.observation||"",plan:l.plan||""}),o({observation:"",plan:""}),await c()}catch(x){i(((m=(f=x==null?void 0:x.response)==null?void 0:f.data)==null?void 0:m.detail)||"Failed to add progress note")}};return r.jsxs("div",{className:"space-y-3",children:[r.jsx(gn,{anyOf:["ipd.doctor"],children:r.jsxs("form",{onSubmit:d,className:"rounded-xl border bg-white p-3 grid gap-3 md:grid-cols-2 text-sm",children:[r.jsx("div",{className:"md:col-span-2 font-medium",children:"New Progress Note"}),r.jsx("textarea",{className:"input",rows:3,placeholder:"Observation",value:l.observation,onChange:u=>o(f=>({...f,observation:u.target.value}))}),r.jsx("textarea",{className:"input",rows:3,placeholder:"Plan",value:l.plan,onChange:u=>o(f=>({...f,plan:u.target.value}))}),r.jsx("div",{className:"md:col-span-2 flex justify-end",children:r.jsx("button",{className:"btn",children:"Save"})}),a&&r.jsx("div",{className:"md:col-span-2 rounded-xl border border-rose-200 bg-rose-50 p-2 text-rose-700",children:a})]})}),r.jsx("div",{className:"rounded-xl border overflow-hidden",children:r.jsxs("table",{className:"w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"text-left text-xs text-gray-500 bg-gray-50",children:[r.jsx("th",{className:"px-3 py-2",children:"Time"}),r.jsx("th",{className:"px-3 py-2",children:"Observation"}),r.jsx("th",{className:"px-3 py-2",children:"Plan"})]})}),r.jsxs("tbody",{children:[(s||[]).map(u=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-3 py-2",children:new Date(u.created_at).toLocaleString()}),r.jsx("td",{className:"px-3 py-2",children:u.observation||""}),r.jsx("td",{className:"px-3 py-2",children:u.plan||""})]},u.id)),!(s!=null&&s.length)&&r.jsx("tr",{children:r.jsx("td",{className:"p-3 text-sm text-gray-500",colSpan:3,children:"No progress notes"})})]})]})})]})}function Uue({label:t="Department  Doctor",value:s,onChange:n}){const[a,i]=y.useState([]),[l,o]=y.useState([]),[c,d]=y.useState(null),[u,f]=y.useState(null),[m,x]=y.useState(!1),[b,w]=y.useState("");y.useEffect(()=>{let C=!0;return(async()=>{var k,A;x(!0),w("");try{const{data:T}=await pB();if(!C)return;i(T||[])}catch(T){if(!C)return;w(((A=(k=T==null?void 0:T.response)==null?void 0:k.data)==null?void 0:A.detail)||"Failed to load departments")}finally{C&&x(!1)}})(),()=>{C=!1}},[]),y.useEffect(()=>{if(!c){o([]);return}let C=!0;return(async()=>{var k,A;x(!0),w("");try{const{data:T}=await xB({departmentId:c,isDoctor:!0});if(!C)return;o(T||[])}catch(T){if(!C)return;w(((A=(k=T==null?void 0:T.response)==null?void 0:k.data)==null?void 0:A.detail)||"Failed to load doctors")}finally{C&&x(!1)}})(),()=>{C=!1}},[c]),y.useEffect(()=>{if(s==null||s===""){f(null);return}const C=Number(s);Number.isFinite(C)&&f(k=>k===C?k:C)},[s]),y.useMemo(()=>l.find(C=>C.id===u)||null,[l,u]);const j=y.useCallback(C=>{const k=C.target.value,A=k?Number(k):null;d(A),f(null),n&&n(null,{department_id:A})},[n]),_=y.useCallback(C=>{const k=C.target.value,A=k?Number(k):null;if(f(A),n){const T={department_id:c,user:l.find(P=>P.id===A)||null};n(A,T)}},[n,c,l]);return r.jsxs("div",{className:"space-y-1 text-sm",children:[t&&r.jsx("label",{className:"block text-xs font-medium text-gray-600",children:t}),r.jsxs("div",{className:"grid gap-2 md:grid-cols-2",children:[r.jsxs("select",{className:"input",value:c??"",onChange:j,children:[r.jsx("option",{value:"",children:"Select department"}),a.map(C=>r.jsx("option",{value:C.id,children:C.name},C.id))]}),r.jsxs("select",{className:"input",value:u??"",onChange:_,disabled:!c||m,children:[r.jsx("option",{value:"",children:c?m?"Loading doctors":"Select doctor":"Select department first"}),l.map(C=>r.jsx("option",{value:C.id,children:C.full_name||C.name||`User #${C.id}`},C.id))]})]}),b&&r.jsx("div",{className:"rounded-md border border-rose-200 bg-rose-50 px-2 py-1 text-xs text-rose-700",children:b})]})}function Vue({admissionId:t}){const[s,n]=y.useState([]),[a,i]=y.useState(""),[l,o]=y.useState(null),[c,d]=y.useState(null),[u,f]=y.useState({type:"internal",to_department:"",external_org:"",reason:""}),m=async()=>{var b,w;i("");try{const{data:j}=await gde(t);n(j||[])}catch(j){i(((w=(b=j==null?void 0:j.response)==null?void 0:b.data)==null?void 0:w.detail)||"Failed to load referrals")}};y.useEffect(()=>{m()},[t]);const x=async b=>{var w,j;b.preventDefault();try{const _={type:u.type,to_department:u.to_department||"",to_user_id:l||void 0,external_org:u.external_org||"",reason:u.reason||""};await yde(t,_),f({type:"internal",to_department:"",external_org:"",reason:""}),o(null),d(null),await m()}catch(_){i(((j=(w=_==null?void 0:_.response)==null?void 0:w.data)==null?void 0:j.detail)||"Failed to create referral")}};return r.jsxs("div",{className:"space-y-3",children:[r.jsxs("form",{onSubmit:x,className:"rounded-xl border bg-white p-3 text-sm space-y-3",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Type"}),r.jsxs("select",{className:"input",value:u.type,onChange:b=>f(w=>({...w,type:b.target.value})),children:[r.jsx("option",{value:"internal",children:"Internal"}),r.jsx("option",{value:"external",children:"External"})]})]}),u.type==="internal"?r.jsx("div",{className:"md:col-span-2",children:r.jsx(Uue,{label:"Department  Role  User",value:l||void 0,onChange:(b,w)=>{o(b||null),d((w==null?void 0:w.department_id)||null),f(j=>({...j,to_department:w!=null&&w.department_id?String(w.department_id):""}))}})}):r.jsx("input",{className:"input md:col-span-2",placeholder:"External organization",value:u.external_org,onChange:b=>f(w=>({...w,external_org:b.target.value}))})]}),r.jsx("input",{className:"input",placeholder:"Reason",value:u.reason,onChange:b=>f(w=>({...w,reason:b.target.value}))}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{className:"btn",children:"Save"})}),a&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 p-2 text-rose-700 text-sm",children:a})]}),r.jsx("div",{className:"rounded-xl border overflow-hidden",children:r.jsxs("table",{className:"w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"text-left text-xs text-gray-500 bg-gray-50",children:[r.jsx("th",{className:"px-3 py-2",children:"Type"}),r.jsx("th",{className:"px-3 py-2",children:"To"}),r.jsx("th",{className:"px-3 py-2",children:"Status"})]})}),r.jsxs("tbody",{children:[(s||[]).map(b=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-3 py-2",children:b.type}),r.jsx("td",{className:"px-3 py-2",children:b.type==="internal"?b.to_user_id?`User#${b.to_user_id}`:`Dept ${b.to_department}`:b.external_org||""}),r.jsx("td",{className:"px-3 py-2",children:b.status})]},b.id)),!(s!=null&&s.length)&&r.jsx("tr",{children:r.jsx("td",{className:"p-3 text-sm text-gray-500",colSpan:3,children:"No referrals"})})]})]})})]})}const WP=t=>{if(!t)return"";const s=new Date(t);if(Number.isNaN(s.getTime()))return"";const n=d=>String(d).padStart(2,"0"),a=s.getFullYear(),i=n(s.getMonth()+1),l=n(s.getDate()),o=n(s.getHours()),c=n(s.getMinutes());return`${a}-${i}-${l}T${o}:${c}`},qP=t=>t?t.length===16?`${t}:00`:t:null,LN=[{code:"A90",name:"Dengue fever"},{code:"I10",name:"Essential (primary) hypertension"},{code:"E11",name:"Type 2 diabetes mellitus"},{code:"J45",name:"Asthma"},{code:"K35",name:"Acute appendicitis"}];function Hue({admissionId:t,admission:s,patient:n,canWrite:a=!0,followupOptions:i=[]}){const[l,o]=y.useState(null),[c,d]=y.useState(null),[u,f]=y.useState(""),[m,x]=y.useState(!1),[b,w]=y.useState(!1),[j]=y.useState(!1),[_,C]=y.useState(""),[k,A]=y.useState(LN),T=Array.isArray(i)&&i.length>0,[P,R]=y.useState(!1),[I,O]=y.useState({medical_history:"",treatment_summary:"",medications:"",follow_up:"",icd10_codes:"",final_diagnosis_primary:"",final_diagnosis_secondary:"",hospital_course:"",discharge_condition:"stable",discharge_type:"routine",allergies:"",procedures:"",investigations:"",diet_instructions:"",activity_instructions:"",warning_signs:"",referral_details:"",insurance_details:"",stay_summary:"",patient_ack_name:"",patient_ack_datetime:"",prepared_by_name:"",reviewed_by_name:"",reviewed_by_regno:"",discharge_datetime:"",implants:"",pending_reports:"",patient_education:"",followup_appointment_ref:"",finalize:!1}),[M,B]=y.useState({financial_clearance:!1,clinical_clearance:!1,delay_reason:"",submit:!1}),[L,F]=y.useState([]),V=!!(l!=null&&l.finalized),U=V||a===!1,z=y.useMemo(()=>{if(!(l!=null&&l.finalized_at))return"";try{return new Date(l.finalized_at).toLocaleString()}catch{return String(l.finalized_at)}},[l]),W=y.useMemo(()=>{if(!(c!=null&&c.submitted_at))return"";try{return new Date(c.submitted_at).toLocaleString()}catch{return String(c.submitted_at)}},[c]),q=(s==null?void 0:s.display_code)||(s==null?void 0:s.admission_code)||(l==null?void 0:l.admission_no)||(l==null?void 0:l.admission_code)||"",G=(n==null?void 0:n.uhid)||(n==null?void 0:n.patient_code)||(l==null?void 0:l.patient_code)||(l==null?void 0:l.uhid)||"",se=(s==null?void 0:s.bed_label)||(s==null?void 0:s.bed_code)||(l==null?void 0:l.bed_label)||(l==null?void 0:l.bed_code)||"",ge=n?[n.prefix,n.first_name,n.last_name].filter(Boolean).join(" "):"",ke=(n==null?void 0:n.age_years)??(n==null?void 0:n.age)??null,ee=(n==null?void 0:n.gender)||(n==null?void 0:n.sex)||"",pe=[ke!=null?`${ke} yrs`:null,ee].filter(Boolean).join(" / "),ue=(s==null?void 0:s.ward_name)||(s==null?void 0:s.ward)||(s==null?void 0:s.ward_display)||"";function ye(be){if(!be)return"";const ne=be.drug_name||be.medicine_name||be.item_name||"",me=be.strength||"",Ne=be.dose!=null&&be.dose!==""?`${be.dose}${be.dose_unit?` ${be.dose_unit}`:""}`:"",Be=be.frequency_label||be.frequency||be.freq||"",jt=be.route||"",yt=be.duration_days!=null&&be.duration_days!==""?`${be.duration_days} days`:be.duration||"";return[ne,me&&`(${me})`,Ne&&`Dose: ${Ne}`,Be&&`Freq: ${Be}`,jt&&`Route: ${jt}`,yt&&`For ${yt}`].filter(Boolean).join("  ")}const X=y.useMemo(()=>Array.isArray(L)&&L.length?L.map(ye).filter(Boolean).join(`
`):"",[L]),oe=()=>{if(!U){if(!X){ie.info("No active medications found for this admission.");return}O(be=>({...be,medications:X})),ie.success("Discharge medications auto-filled from IPD medication chart.")}},_e=async()=>{var be,ne;if(t){f("");try{const[me,Ne]=await Promise.all([Ude(t),Hde(t)]),Be=(me==null?void 0:me.data)||null;o(Be),Be?(R(!!(Be.follow_up&&Be.follow_up.trim())),O(yt=>({...yt,medical_history:Be.medical_history||"",treatment_summary:Be.treatment_summary||"",medications:Be.medications||"",follow_up:Be.follow_up||"",icd10_codes:Be.icd10_codes||"",final_diagnosis_primary:Be.final_diagnosis_primary||"",final_diagnosis_secondary:Be.final_diagnosis_secondary||"",hospital_course:Be.hospital_course||"",discharge_condition:Be.discharge_condition||"stable",discharge_type:Be.discharge_type||"routine",allergies:Be.allergies||"",procedures:Be.procedures||"",investigations:Be.investigations||"",diet_instructions:Be.diet_instructions||"",activity_instructions:Be.activity_instructions||"",warning_signs:Be.warning_signs||"",referral_details:Be.referral_details||"",insurance_details:Be.insurance_details||"",stay_summary:Be.stay_summary||"",implants:Be.implants||"",pending_reports:Be.pending_reports||"",patient_education:Be.patient_education||"",followup_appointment_ref:Be.followup_appointment_ref||"",prepared_by_name:Be.prepared_by_name||"",reviewed_by_name:Be.reviewed_by_name||"",reviewed_by_regno:Be.reviewed_by_regno||"",discharge_datetime:WP(Be.discharge_datetime),patient_ack_name:Be.patient_ack_name||"",patient_ack_datetime:WP(Be.patient_ack_datetime),finalize:!1}))):R(!1);const jt=(Ne==null?void 0:Ne.data)||null;d(jt),jt&&B({financial_clearance:!!jt.financial_clearance,clinical_clearance:!!jt.clinical_clearance,delay_reason:jt.delay_reason||"",submit:!1});try{const yt=await mB(t);console.log("``````````````````````````````````````````"),console.log(yt),console.log("``````````````````````````````````````````");const pt=Array.isArray(yt==null?void 0:yt.data)?yt.data:[];F(pt)}catch(yt){console.error("Failed to load IPD medications for discharge",yt)}}catch(me){const Ne=((ne=(be=me==null?void 0:me.response)==null?void 0:be.data)==null?void 0:ne.detail)||(me==null?void 0:me.message)||"Failed to load discharge data";f(Ne),ie.error(Ne)}}};y.useEffect(()=>{_e()},[t]);const ce=async be=>{var ne,me;if(be.preventDefault(),!!t&&!(I.finalize&&!V&&!window.confirm("Once finalized, this discharge summary cannot be edited. Do you want to continue?"))){x(!0),f("");try{const Ne={...I,discharge_datetime:qP(I.discharge_datetime),patient_ack_datetime:qP(I.patient_ack_datetime)};await Vde(t,Ne),await _e(),I.finalize&&!V?ie.success("Discharge summary finalized successfully. You can now print and hand over to the patient."):ie.success("Discharge draft saved successfully.")}catch(Ne){const Be=((me=(ne=Ne==null?void 0:Ne.response)==null?void 0:ne.data)==null?void 0:me.detail)||(Ne==null?void 0:Ne.message)||"Failed to save discharge summary";f(Be),ie.error(Be)}finally{x(!1)}}},he=async be=>{var ne,me;if(be.preventDefault(),!!t){w(!0),f("");try{await Wde(t,{...M}),await _e(),ie.success("Discharge checklist submitted successfully.")}catch(Ne){const Be=((me=(ne=Ne==null?void 0:Ne.response)==null?void 0:ne.data)==null?void 0:me.detail)||(Ne==null?void 0:Ne.message)||"Failed to save checklist";f(Be),ie.error(Be)}finally{w(!1)}}},fe=be=>ne=>{var Ne;const me=((Ne=ne==null?void 0:ne.target)==null?void 0:Ne.type)==="checkbox"?ne.target.checked:ne.target.value;be==="follow_up"&&R(!1),O(Be=>({...Be,[be]:me}))},le=be=>ne=>{var Ne;const me=((Ne=ne==null?void 0:ne.target)==null?void 0:Ne.type)==="checkbox"?ne.target.checked:ne.target.value;B(Be=>({...Be,[be]:me}))},Ve=async()=>{var be,ne,me;if(t)try{const Ne=await J.get(`/ipd/admissions/${t}/discharge-summary/pdf`,{responseType:"blob"}),Be=new Blob([Ne.data],{type:"application/pdf"}),jt=window.URL.createObjectURL(Be),yt=document.createElement("a");yt.href=jt,yt.download=`discharge-summary-${t}.pdf`,document.body.appendChild(yt),yt.click(),yt.remove(),window.URL.revokeObjectURL(jt)}catch(Ne){console.error("PDF download error:",Ne);const Be=((ne=(be=Ne==null?void 0:Ne.response)==null?void 0:be.data)==null?void 0:ne.detail)||(((me=Ne==null?void 0:Ne.response)==null?void 0:me.status)===401?"Session expired. Please login again.":"Failed to download discharge summary PDF.");alert(Be)}},Ke=be=>{const ne=be.trim().toLowerCase();if(!ne){A(LN);return}A(LN.filter(me=>me.code.toLowerCase().includes(ne)||me.name.toLowerCase().includes(ne)))},wt=be=>{const ne=be.target.value;C(ne),Ke(ne)},mt=be=>{if(!be)return;const ne=(I.icd10_codes||"").split(`
`).map(Ne=>Ne.trim()).filter(Boolean),me=`${be.code}  ${be.name}`;ne.includes(me)||ne.push(me),O(Ne=>({...Ne,icd10_codes:ne.join(`
`)})),ie.success(`Added ICD-10: ${me}`)},rt=be=>{const me=(I.icd10_codes||"").split(`
`).map(Ne=>Ne.trim()).filter(Boolean).filter(Ne=>Ne!==be);O(Ne=>({...Ne,icd10_codes:me.join(`
`)}))},bt=V?r.jsxs("span",{className:"rounded-full bg-emerald-100 px-3 py-1 font-medium text-emerald-800",children:["Finalized ",z&&` ${z}`]}):r.jsx("span",{className:"rounded-full bg-amber-100 px-3 py-1 font-medium text-amber-800",children:"Draft  Not yet finalized"});return r.jsxs("div",{className:"space-y-4 text-sm text-black",children:[r.jsxs("div",{className:"flex flex-col gap-2 rounded-2xl border bg-gradient-to-r from-sky-50 to-emerald-50 p-3 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-xs font-semibold text-sky-900",children:"Discharge  Medico-Legal Summary"}),r.jsx("div",{className:"text-[11px] text-slate-600",children:"Capture final diagnosis, hospital course, instructions & clearances as per NABH / medico-legal best practice."})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-[11px]",children:[bt,r.jsx("button",{type:"button",onClick:Ve,className:"btn btn-sm whitespace-nowrap",children:"Download Discharge PDF"})]})]}),r.jsxs("div",{className:"grid gap-2 md:grid-cols-3",children:[r.jsx(gn,{anyOf:["ipd.doctor"],children:r.jsxs("div",{className:"rounded-xl border bg-white p-2.5 text-[11px] text-slate-700",children:[r.jsx("div",{className:"mb-0.5 font-semibold",children:"Doctor view"}),r.jsxs("div",{children:["Please complete ",r.jsx("strong",{children:"diagnosis"}),","," ",r.jsx("strong",{children:"hospital course"}),","," ",r.jsx("strong",{children:"discharge medications"}),", and approve discharge."]})]})}),r.jsx(gn,{anyOf:["ipd.nurse"],children:r.jsxs("div",{className:"rounded-xl border bg-white p-2.5 text-[11px] text-slate-700",children:[r.jsx("div",{className:"mb-0.5 font-semibold",children:"Nurse view"}),r.jsx("div",{children:"Please complete nursing checklist, education, vitals & pending reports before discharge."})]})}),r.jsx(gn,{anyOf:["billing.manage","billing.view"],children:r.jsxs("div",{className:"rounded-xl border bg-white p-2.5 text-[11px] text-slate-700",children:[r.jsx("div",{className:"mb-0.5 font-semibold",children:"Billing view"}),r.jsx("div",{children:"Confirm all bills and insurance claims are settled to enable final discharge."})]})})]}),r.jsxs("div",{className:"flex flex-wrap gap-x-6 gap-y-1 rounded-2xl border bg-white px-3 py-2 text-[11px] md:text-xs",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-slate-700",children:"Admission:"})," ",r.jsx("span",{className:"text-slate-800",children:q||t||""})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-slate-700",children:"Patient:"})," ",r.jsx("span",{className:"text-slate-800",children:ge||G||""})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-slate-700",children:"UHID:"})," ",r.jsx("span",{className:"text-slate-800",children:G||""})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-slate-700",children:"Age / Sex:"})," ",r.jsx("span",{className:"text-slate-800",children:pe||""})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-slate-700",children:"Ward / Bed:"})," ",r.jsx("span",{className:"text-slate-800",children:[ue,se].filter(Boolean).join(" / ")||""})]}),r.jsx("div",{className:"mt-1 w-full text-[10px] text-slate-500 md:mt-0 md:w-auto",children:"Patient demographics are auto-filled from IPD admission. Editing not allowed in this screen."})]}),u&&r.jsx("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:u}),r.jsx(gn,{anyOf:["ipd.manage","ipd.doctor"],children:r.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[r.jsxs("form",{onSubmit:ce,className:"lg:col-span-2 space-y-4 rounded-2xl border bg-white p-3 md:p-4",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:"Discharge Summary  Clinical Details"}),m&&r.jsx("span",{className:"text-[11px] text-gray-500",children:"Saving"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Medical history"}),r.jsx("span",{className:"text-[10px] text-gray-400",children:"Select known conditions or type to add new history (Diabetes, HTN, Asthma, Surgery, Smoking, Alcohol, etc.)"})]}),r.jsx("textarea",{className:"input min-h-[60px]",placeholder:"Known diabetes, hypertension, CAD, past surgeries, addictions",value:I.medical_history,onChange:fe("medical_history"),disabled:U})]}),r.jsxs("div",{className:"space-y-3 rounded-xl border bg-slate-50/80 p-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-xs font-semibold text-slate-700",children:"A. Final Diagnosis & Hospital Course"}),r.jsx("span",{className:"text-[10px] text-slate-500",children:"Core medico-legal section"})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Final primary diagnosis"}),r.jsx("input",{className:"input",placeholder:"Search diagnosis by name or ICD-10 code (e.g., Dengue, A90)",value:I.final_diagnosis_primary,onChange:fe("final_diagnosis_primary"),disabled:U})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Secondary / comorbid diagnoses"}),r.jsx("input",{className:"input",placeholder:"Add comorbid conditions (optional)",value:I.final_diagnosis_secondary,onChange:fe("final_diagnosis_secondary"),disabled:U})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Hospital course / clinical summary"}),r.jsx("textarea",{className:"input min-h-[90px]",placeholder:"Brief day-wise summary of treatment, response & complications (if any)",value:I.hospital_course,onChange:fe("hospital_course"),disabled:U})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Discharge condition"}),r.jsxs("select",{className:"input",value:I.discharge_condition,onChange:fe("discharge_condition"),disabled:U,children:[r.jsx("option",{value:"stable",children:"Stable"}),r.jsx("option",{value:"improved",children:"Improved"}),r.jsx("option",{value:"unchanged",children:"Unchanged"}),r.jsx("option",{value:"dama",children:"DAMA"}),r.jsx("option",{value:"expired",children:"Expired"})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Discharge type"}),r.jsxs("select",{className:"input",value:I.discharge_type,onChange:fe("discharge_type"),disabled:U,children:[r.jsx("option",{value:"routine",children:"Routine"}),r.jsx("option",{value:"dama",children:"DAMA"}),r.jsx("option",{value:"lama",children:"LAMA"}),r.jsx("option",{value:"referred",children:"Referred"}),r.jsx("option",{value:"absconded",children:"Absconded"})]})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Allergies"}),r.jsx("textarea",{className:"input min-h-[60px]",placeholder:"Search allergy or select NKDA if no known allergies",value:I.allergies,onChange:fe("allergies"),disabled:U}),r.jsx("div",{className:"flex flex-wrap gap-2 pt-1 text-[10px]",children:r.jsx("button",{type:"button",className:"rounded-full border px-2 py-0.5 text-[10px]",onClick:()=>!U&&O(be=>({...be,allergies:"No known drug allergy (NKDA)"})),children:" Set NKDA"})})]})]}),r.jsxs("div",{className:"space-y-3 rounded-xl border bg-slate-50/40 p-3",children:[r.jsx("div",{className:"text-xs font-semibold text-slate-700",children:"B. Procedures, Investigations & Instructions"}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Procedures / surgeries performed"}),r.jsx("textarea",{className:"input min-h-[70px]",placeholder:"Search and select performed procedures, then summarise (procedure, date, surgeon)",value:I.procedures,onChange:fe("procedures"),disabled:U})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Investigation highlights"}),r.jsx("textarea",{className:"input min-h-[70px]",placeholder:"Select key abnormal reports to display (labs, imaging) and summarise here",value:I.investigations,onChange:fe("investigations"),disabled:U})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Diet instructions"}),r.jsxs("select",{className:"input",value:I.diet_instructions,onChange:fe("diet_instructions"),disabled:U,children:[r.jsx("option",{value:"",children:"Select diet"}),r.jsx("option",{value:"normal",children:"Normal diet"}),r.jsx("option",{value:"soft",children:"Soft diet"}),r.jsx("option",{value:"diabetic",children:"Diabetic diet"}),r.jsx("option",{value:"renal",children:"Renal diet"}),r.jsx("option",{value:"cardiac",children:"Cardiac diet"}),r.jsx("option",{value:"other",children:"Other / see notes"})]}),r.jsx("div",{className:"text-[10px] text-gray-400",children:"Select recommended discharge diet; details will appear in the summary."})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Activity instructions"}),r.jsxs("select",{className:"input",value:I.activity_instructions,onChange:fe("activity_instructions"),disabled:U,children:[r.jsx("option",{value:"",children:"Select activity"}),r.jsx("option",{value:"bed_rest",children:"Bed rest"}),r.jsx("option",{value:"assisted_walk",children:"Assisted walking / short walks"}),r.jsx("option",{value:"normal_activity",children:"Normal activity as tolerated"}),r.jsx("option",{value:"avoid_heavy_lifting",children:"Avoid heavy lifting / strenuous activity"}),r.jsx("option",{value:"other",children:"Other / see notes"})]})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Warning / red-flag symptoms"}),r.jsx("textarea",{className:"input min-h-[60px]",placeholder:"Select symptoms that require immediate hospital visit and list here",value:I.warning_signs,onChange:fe("warning_signs"),disabled:U})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Referral / transfer details (if referred)"}),r.jsx("textarea",{className:"input min-h-[60px]",placeholder:"Search referred hospital / doctor and note reason for transfer",value:I.referral_details,onChange:fe("referral_details"),disabled:U})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Discharge medications"}),!U&&r.jsx("button",{type:"button",onClick:oe,className:"rounded-full border px-2 py-0.5 text-[10px] text-sky-700 hover:bg-sky-50",children:"Use IPD medication chart"})]}),r.jsx("textarea",{className:"input min-h-[70px]",placeholder:"Search drug name to auto-fill dose & frequency, then summarise (name, dose, frequency, duration)",value:I.medications,onChange:fe("medications"),disabled:U}),Array.isArray(L)&&L.length>0&&r.jsxs("div",{className:"mt-1 rounded-lg border bg-slate-50 p-2",children:[r.jsx("div",{className:"mb-1 text-[10px] text-slate-500",children:"IPD medication chart (preview):"}),r.jsx("ul",{className:"max-h-32 space-y-0.5 overflow-auto text-[11px] text-slate-700",children:L.slice(0,10).map((be,ne)=>r.jsx("li",{children:ye(be)},be.id||ne))})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Follow-up advice"}),r.jsxs("div",{className:"flex flex-col items-end",children:[r.jsx("span",{className:"text-[10px] text-gray-400",children:"Follow-up auto-linked from OPD appointment (backend)."}),P&&!V&&r.jsx("span",{className:"text-[10px] text-emerald-600",children:"Auto-filled from records  editable"})]})]}),r.jsx("textarea",{className:"input min-h-[70px]",placeholder:"Follow-up date, department, OPD number, additional instructions",value:I.follow_up,onChange:fe("follow_up"),disabled:U})]})]}),r.jsxs("div",{className:"space-y-3 rounded-xl border bg-slate-50/60 p-3",children:[r.jsx("div",{className:"text-xs font-semibold text-slate-700",children:"E. Safety & Quality"}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Implants used (if any)"}),r.jsx("textarea",{className:"input min-h-[50px]",placeholder:"Search implant by name or serial number (optional), then record details here",value:I.implants,onChange:fe("implants"),disabled:U})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Pending reports"}),r.jsx("textarea",{className:"input min-h-[50px]",placeholder:"Select pending test reports and note how / when patient will receive them",value:I.pending_reports,onChange:fe("pending_reports"),disabled:U})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Patient education provided"}),r.jsx("textarea",{className:"input min-h-[60px]",placeholder:"Select education provided (wound care, insulin injection, physiotherapy, lifestyle advice) and summarise here",value:I.patient_education,onChange:fe("patient_education"),disabled:U})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Follow-up appointment ID / token"}),T?r.jsxs("select",{className:"input",value:I.followup_appointment_ref,onChange:fe("followup_appointment_ref"),disabled:U||j,children:[r.jsx("option",{value:"",children:j?"Loading follow-ups":"Select linked OPD follow-up"}),i.map(be=>r.jsx("option",{value:be.value,children:be.label},be.value))]}):r.jsx("input",{className:"input",placeholder:"Linked OPD appointment ID / token",value:I.followup_appointment_ref,onChange:fe("followup_appointment_ref"),disabled:U}),r.jsx("div",{className:"text-[10px] text-gray-400",children:"Dropdown will show OPD follow-ups for this patient (to be wired from OPD module)."})]})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"ICD-10 codes"}),r.jsxs("div",{className:"space-y-1 rounded-lg border bg-slate-50/70 p-2",children:[r.jsx("div",{className:"mb-1 text-[11px] text-slate-600",children:'Search ICD-10 by diagnosis name or code (e.g., "Dengue"  A90). Start typing to see suggestions.'}),r.jsx("input",{className:"input h-8 text-[12px]",placeholder:'Type to search (e.g., "dengue", "A90")',value:_,onChange:wt,disabled:U}),!U&&r.jsxs("div",{className:"mt-1 flex flex-wrap gap-1",children:[k.length===0&&r.jsx("span",{className:"text-[10px] text-slate-400",children:"No matches. Try a different spelling."}),k.map(be=>r.jsxs("button",{type:"button",className:"rounded-full border px-2 py-0.5 text-[10px] hover:bg-slate-100",onClick:()=>mt(be),children:[be.code,"  ",be.name]},be.code))]})]}),r.jsx("textarea",{className:"input mt-2 min-h-[70px] text-[12px]",placeholder:"Selected ICD-10 codes will appear here, one per line (e.g., A90  Dengue fever).",value:I.icd10_codes,onChange:fe("icd10_codes"),disabled:U}),!U&&I.icd10_codes&&r.jsx("div",{className:"mt-1 flex flex-wrap gap-1 text-[10px] text-slate-500",children:(I.icd10_codes||"").split(`
`).map(be=>be.trim()).filter(Boolean).map(be=>r.jsxs("button",{type:"button",className:"rounded-full border px-2 py-0.5 hover:bg-rose-50",onClick:()=>rt(be),children:[" ",be]},be))})]}),r.jsxs("div",{className:"flex flex-col gap-2 border-t pt-2 text-xs text-gray-600 md:flex-row md:items-center md:justify-between",children:[r.jsx("div",{children:V?r.jsxs("span",{children:["Finalized at"," ",r.jsx("span",{className:"font-medium text-emerald-700",children:z})]}):r.jsx("span",{children:"Fill mandatory details before finalizing. Once finalized, this summary cannot be edited."})}),r.jsxs("div",{className:"flex items-center gap-3",children:[!V&&r.jsxs("label",{className:"inline-flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:I.finalize,onChange:fe("finalize"),disabled:U}),r.jsx("span",{className:"text-xs",children:"Mark as finalized"})]}),r.jsx("button",{className:"btn",disabled:m||V||!a,children:m?"Saving":"Save summary"})]})]})]})]}),r.jsx("div",{className:"space-y-4",children:r.jsxs("form",{onSubmit:he,className:"space-y-4 rounded-2xl border bg-white p-3 md:p-4",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:"Discharge Checklist & Clearance"}),b&&r.jsx("span",{className:"text-[11px] text-gray-500",children:"Saving"})]}),r.jsxs("div",{className:"space-y-2 rounded-xl bg-slate-50/80 p-3",children:[r.jsx("div",{className:"text-[11px] font-medium text-slate-700",children:"Financial & clinical clearance"}),r.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[r.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:M.financial_clearance,onChange:le("financial_clearance")}),r.jsx("span",{children:"Financial clearance completed  confirm all bills and insurance claims are settled."})]}),r.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[r.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:M.clinical_clearance,onChange:le("clinical_clearance")}),r.jsx("span",{children:"Clinical discharge clearance given by doctor."})]}),r.jsx("input",{className:"input mt-1",placeholder:"Delay reason (if any)",value:M.delay_reason,onChange:le("delay_reason")})]}),r.jsxs("div",{className:"space-y-3 rounded-xl bg-slate-50/80 p-3",children:[r.jsx("div",{className:"text-[11px] font-medium text-slate-700",children:"Insurance / TPA & stay summary"}),r.jsx("textarea",{className:"input min-h-[70px]",placeholder:"Payer name, claim number, pre-auth number, claim status",value:I.insurance_details,onChange:fe("insurance_details"),disabled:U}),r.jsx("textarea",{className:"input min-h-[60px]",placeholder:"Total days admitted, ICU days (if any), ward type (general / semi-private / private)",value:I.stay_summary,onChange:fe("stay_summary"),disabled:U})]}),r.jsxs("div",{className:"space-y-3 rounded-xl bg-slate-50/80 p-3",children:[r.jsx("div",{className:"text-[11px] font-medium text-slate-700",children:"Patient acknowledgement"}),r.jsx("input",{className:"input",placeholder:"Patient / attendant name",value:I.patient_ack_name,onChange:fe("patient_ack_name"),disabled:U}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-gray-600",children:"Acknowledgement date & time"}),r.jsx("input",{type:"datetime-local",className:"input",value:I.patient_ack_datetime,onChange:fe("patient_ack_datetime"),disabled:U})]})]}),r.jsxs("div",{className:"space-y-3 rounded-xl bg-slate-50/80 p-3",children:[r.jsx("div",{className:"text-[11px] font-medium text-slate-700",children:"Doctor & system validation"}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-gray-600",children:"Prepared by (nurse / junior doctor)"}),r.jsx("input",{className:"input",placeholder:"Name of nurse / intern",value:I.prepared_by_name,onChange:fe("prepared_by_name"),disabled:U})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-gray-600",children:"Reviewed & approved by"}),r.jsx("input",{className:"input mb-1",placeholder:"Consultant doctor name",value:I.reviewed_by_name,onChange:fe("reviewed_by_name"),disabled:U}),r.jsx("input",{className:"input",placeholder:"Registration number",value:I.reviewed_by_regno,onChange:fe("reviewed_by_regno"),disabled:U})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-gray-600",children:"Discharge date & time"}),r.jsx("input",{type:"datetime-local",className:"input",value:I.discharge_datetime,onChange:fe("discharge_datetime"),disabled:U})]}),r.jsx("div",{className:"text-[10px] text-slate-500",children:"Clinical clearance confirms the patient is medically fit for discharge."})]}),r.jsxs("div",{className:"flex items-center justify-between border-t pt-2 text-xs",children:[r.jsxs("label",{className:"inline-flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:M.submit,onChange:le("submit")}),r.jsx("span",{children:"Submit discharge checklist"})]}),r.jsx("button",{className:"btn",disabled:b,children:b?"Saving":"Save checklist"})]}),(c==null?void 0:c.submitted)&&r.jsxs("div",{className:"text-[11px] text-emerald-700",children:["Checklist submitted at"," ",r.jsx("span",{className:"font-medium",children:W})]})]})})]})})]})}function Wue({admissionId:t}){const s=z_("ipd.view")||z_("ipd.manage"),[n,a]=y.useState(""),[i,l]=y.useState(""),[o,c]=y.useState(null),[d,u]=y.useState(""),[f,m]=y.useState([]),x=y.useMemo(()=>{const w=new Map;for(const j of f||[])w.set(j.id,j.code);return w},[f]);y.useEffect(()=>{let w=!0;return(async()=>{try{const j=await rl();w&&m((j==null?void 0:j.data)||[])}catch{}try{const{data:j}=await fB(t);if(!w)return;const _=j!=null&&j.admitted_at?new Date(j.admitted_at).toISOString().slice(0,10):"",C=new Date().toISOString().slice(0,10);a(_),l(C)}catch{}})(),()=>{w=!1}},[t]);const b=async()=>{var w,j;u(""),c(null);try{const{data:_}=await Gde(t,{...n?{from_date:n}:{},...i?{to_date:i}:{}});c(_)}catch(_){u(((j=(w=_==null?void 0:_.response)==null?void 0:w.data)==null?void 0:j.detail)||"Failed to preview charges")}};return s?r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"rounded-xl border bg-white p-3 grid gap-3 md:grid-cols-5 text-sm",children:[r.jsx("div",{className:"md:col-span-5 font-medium",children:"Bed Charge Preview"}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"From"}),r.jsx("input",{type:"date",className:"input",value:n,onChange:w=>a(w.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"To"}),r.jsx("input",{type:"date",className:"input",value:i,onChange:w=>l(w.target.value)})]}),r.jsx("div",{className:"md:col-span-3 flex items-end justify-end",children:r.jsx("button",{className:"btn",onClick:b,children:"Preview"})}),d&&r.jsx("div",{className:"md:col-span-5 rounded-xl border border-rose-200 bg-rose-50 p-2 text-rose-700",children:d})]}),o&&r.jsxs("div",{className:"rounded-xl border overflow-hidden bg-white",children:[r.jsxs("table",{className:"w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"text-left text-xs text-gray-500 bg-gray-50",children:[r.jsx("th",{className:"px-3 py-2",children:"Date"}),r.jsx("th",{className:"px-3 py-2",children:"Room Type"}),r.jsx("th",{className:"px-3 py-2",children:"Bed"}),r.jsx("th",{className:"px-3 py-2",children:"Rate"})]})}),r.jsxs("tbody",{children:[(o.days||[]).map((w,j)=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-3 py-2",children:new Date(w.date).toLocaleDateString()}),r.jsx("td",{className:"px-3 py-2",children:w.room_type||""}),r.jsx("td",{className:"px-3 py-2",children:w.bed_id&&x.get(w.bed_id)||""}),r.jsx("td",{className:"px-3 py-2",children:Number(w.rate).toFixed(2)})]},j)),r.jsxs("tr",{className:"bg-gray-50 font-medium",children:[r.jsx("td",{className:"px-3 py-2",colSpan:3,children:"Total"}),r.jsx("td",{className:"px-3 py-2",children:Number(o.total_amount||0).toFixed(2)})]})]})]}),!!o.missing_rate_days&&r.jsxs("div",{className:"px-3 py-2 text-xs text-amber-700 bg-amber-50 border-t",children:["Note: ",o.missing_rate_days," day(s) had no bed rate set for the room type."]})]})]}):r.jsx("div",{className:"rounded-lg border border-rose-200 bg-rose-50 p-2 text-sm text-rose-700",children:"Access denied (need ipd.view)."})}function zb(){return J.get("/inventory/locations")}function que(t){return J.post("/inventory/locations",t)}function Gue(t,s){return J.put(`/inventory/locations/${t}`,s)}function Kue(t=""){const s=t?{q:t}:{};return J.get("/inventory/suppliers",{params:s})}function Yue(t){return J.post("/inventory/suppliers",t)}function Xue(t,s){return J.put(`/inventory/suppliers/${t}`,s)}function ik(t={}){return J.get("/inventory/items",{params:t})}function Que(t){return J.post("/inventory/items",t)}function Zue(t,s){return J.put(`/inventory/items/${t}`,s)}function Jue(){return J.get("/inventory/items/sample-csv",{responseType:"blob"})}function ehe(t){const s=new FormData;return s.append("file",t),J.post("/inventory/items/bulk-upload",s,{headers:{"Content-Type":"multipart/form-data"}})}function the(t={}){return J.get("/inventory/stock",{params:t})}function she(t={}){return J.get("/inventory/alerts/expiry",{params:t})}function nhe(t={}){return J.get("/inventory/alerts/expired",{params:t})}function rhe(t={}){return J.get("/inventory/stock/quarantine",{params:t})}function ahe(t={}){return J.get("/inventory/alerts/low-stock",{params:t})}function ihe(t={}){return J.get("/inventory/alerts/max-stock",{params:t})}function lhe(t){return J.post("/inventory/purchase-orders",t)}function ohe(t={}){return J.get("/inventory/purchase-orders",{params:t})}function che(t,s){return J.post(`/inventory/purchase-orders/${t}/status`,null,{params:{status:s}})}function dhe(t){return J.get(`/inventory/purchase-orders/${t}/pdf`,{responseType:"blob"})}function uhe(t,s){return J.post(`/inventory/purchase-orders/${t}/mark-sent`,null,{params:{email_to:s}})}function hhe(t){return J.post("/inventory/grn",t)}function fhe(t={}){return J.get("/inventory/grn",{params:t})}function mhe(t){return J.post(`/inventory/grn/${t}/post`)}function phe(t){return J.post("/inventory/returns",t)}function xhe(t={}){return J.get("/inventory/returns",{params:t})}function ghe(t){return J.post(`/inventory/returns/${t}/post`)}function yhe(t={}){return J.get("/inventory/transactions",{params:t})}function bhe(t){return J.get(`/inventory/items/by-qr/${encodeURIComponent(t)}`)}function vhe(t){return J.get("/inventory/items/by-qr-number",{params:{qr_number:t}})}function GP(t){return J.get(`/inventory/items/${t}/qr`,{responseType:"blob"})}function whe(t){return J.post("/pharmacy/prescriptions",t)}function Nhe(t={}){return J.get("/pharmacy/prescriptions",{params:t})}function jhe(t,s){return J.post(`/pharmacy/prescriptions/${t}/dispense`,s)}function _he(t){return J.post(`/pharmacy/prescriptions/${t}/bill`)}function She(t={}){return J.get("/pharmacy/billing",{params:t})}function Che(t={}){return J.get("/pharmacy/billing/returns/list",{params:t})}function U_(t,[s,n]){return Math.min(n,Math.max(s,t))}function Wt(t,s,{checkForDefaultPrevented:n=!0}={}){return function(i){if(t==null||t(i),n===!1||!i.defaultPrevented)return s==null?void 0:s(i)}}function khe(t,s){const n=y.createContext(s),a=l=>{const{children:o,...c}=l,d=y.useMemo(()=>c,Object.values(c));return r.jsx(n.Provider,{value:d,children:o})};a.displayName=t+"Provider";function i(l){const o=y.useContext(n);if(o)return o;if(s!==void 0)return s;throw new Error(`\`${l}\` must be used within \`${t}\``)}return[a,i]}function Mu(t,s=[]){let n=[];function a(l,o){const c=y.createContext(o),d=n.length;n=[...n,o];const u=m=>{var C;const{scope:x,children:b,...w}=m,j=((C=x==null?void 0:x[t])==null?void 0:C[d])||c,_=y.useMemo(()=>w,Object.values(w));return r.jsx(j.Provider,{value:_,children:b})};u.displayName=l+"Provider";function f(m,x){var j;const b=((j=x==null?void 0:x[t])==null?void 0:j[d])||c,w=y.useContext(b);if(w)return w;if(o!==void 0)return o;throw new Error(`\`${m}\` must be used within \`${l}\``)}return[u,f]}const i=()=>{const l=n.map(o=>y.createContext(o));return function(c){const d=(c==null?void 0:c[t])||l;return y.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return i.scopeName=t,[a,Ahe(i,...s)]}function Ahe(...t){const s=t[0];if(t.length===1)return s;const n=()=>{const a=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(l){const o=a.reduce((c,{useScope:d,scopeName:u})=>{const m=d(l)[`__scope${u}`];return{...c,...m}},{});return y.useMemo(()=>({[`__scope${s.scopeName}`]:o}),[o])}};return n.scopeName=s.scopeName,n}function wB(t){const s=t+"CollectionProvider",[n,a]=Mu(s),[i,l]=n(s,{collectionRef:{current:null},itemMap:new Map}),o=j=>{const{scope:_,children:C}=j,k=Qe.useRef(null),A=Qe.useRef(new Map).current;return r.jsx(i,{scope:_,itemMap:A,collectionRef:k,children:C})};o.displayName=s;const c=t+"CollectionSlot",d=tf(c),u=Qe.forwardRef((j,_)=>{const{scope:C,children:k}=j,A=l(c,C),T=Ss(_,A.collectionRef);return r.jsx(d,{ref:T,children:k})});u.displayName=c;const f=t+"CollectionItemSlot",m="data-radix-collection-item",x=tf(f),b=Qe.forwardRef((j,_)=>{const{scope:C,children:k,...A}=j,T=Qe.useRef(null),P=Ss(_,T),R=l(f,C);return Qe.useEffect(()=>(R.itemMap.set(T,{ref:T,...A}),()=>void R.itemMap.delete(T))),r.jsx(x,{[m]:"",ref:P,children:k})});b.displayName=f;function w(j){const _=l(t+"CollectionConsumer",j);return Qe.useCallback(()=>{const k=_.collectionRef.current;if(!k)return[];const A=Array.from(k.querySelectorAll(`[${m}]`));return Array.from(_.itemMap.values()).sort((R,I)=>A.indexOf(R.ref.current)-A.indexOf(I.ref.current))},[_.collectionRef,_.itemMap])}return[{Provider:o,Slot:u,ItemSlot:b},w,a]}var Ehe=y.createContext(void 0);function Ub(t){const s=y.useContext(Ehe);return t||s||"ltr"}var The=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Qt=The.reduce((t,s)=>{const n=tf(`Primitive.${s}`),a=y.forwardRef((i,l)=>{const{asChild:o,...c}=i,d=o?n:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),r.jsx(d,{...c,ref:l})});return a.displayName=`Primitive.${s}`,{...t,[s]:a}},{});function Phe(t,s){t&&td.flushSync(()=>t.dispatchEvent(s))}function ea(t){const s=y.useRef(t);return y.useEffect(()=>{s.current=t}),y.useMemo(()=>(...n)=>{var a;return(a=s.current)==null?void 0:a.call(s,...n)},[])}function Ihe(t,s=globalThis==null?void 0:globalThis.document){const n=ea(t);y.useEffect(()=>{const a=i=>{i.key==="Escape"&&n(i)};return s.addEventListener("keydown",a,{capture:!0}),()=>s.removeEventListener("keydown",a,{capture:!0})},[n,s])}var Mhe="DismissableLayer",V_="dismissableLayer.update",Dhe="dismissableLayer.pointerDownOutside",Ohe="dismissableLayer.focusOutside",KP,NB=y.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),lk=y.forwardRef((t,s)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:a,onPointerDownOutside:i,onFocusOutside:l,onInteractOutside:o,onDismiss:c,...d}=t,u=y.useContext(NB),[f,m]=y.useState(null),x=(f==null?void 0:f.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,b]=y.useState({}),w=Ss(s,I=>m(I)),j=Array.from(u.layers),[_]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),C=j.indexOf(_),k=f?j.indexOf(f):-1,A=u.layersWithOutsidePointerEventsDisabled.size>0,T=k>=C,P=Bhe(I=>{const O=I.target,M=[...u.branches].some(B=>B.contains(O));!T||M||(i==null||i(I),o==null||o(I),I.defaultPrevented||c==null||c())},x),R=Fhe(I=>{const O=I.target;[...u.branches].some(B=>B.contains(O))||(l==null||l(I),o==null||o(I),I.defaultPrevented||c==null||c())},x);return Ihe(I=>{k===u.layers.size-1&&(a==null||a(I),!I.defaultPrevented&&c&&(I.preventDefault(),c()))},x),y.useEffect(()=>{if(f)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(KP=x.body.style.pointerEvents,x.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(f)),u.layers.add(f),YP(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(x.body.style.pointerEvents=KP)}},[f,x,n,u]),y.useEffect(()=>()=>{f&&(u.layers.delete(f),u.layersWithOutsidePointerEventsDisabled.delete(f),YP())},[f,u]),y.useEffect(()=>{const I=()=>b({});return document.addEventListener(V_,I),()=>document.removeEventListener(V_,I)},[]),r.jsx(Qt.div,{...d,ref:w,style:{pointerEvents:A?T?"auto":"none":void 0,...t.style},onFocusCapture:Wt(t.onFocusCapture,R.onFocusCapture),onBlurCapture:Wt(t.onBlurCapture,R.onBlurCapture),onPointerDownCapture:Wt(t.onPointerDownCapture,P.onPointerDownCapture)})});lk.displayName=Mhe;var Rhe="DismissableLayerBranch",Lhe=y.forwardRef((t,s)=>{const n=y.useContext(NB),a=y.useRef(null),i=Ss(s,a);return y.useEffect(()=>{const l=a.current;if(l)return n.branches.add(l),()=>{n.branches.delete(l)}},[n.branches]),r.jsx(Qt.div,{...t,ref:i})});Lhe.displayName=Rhe;function Bhe(t,s=globalThis==null?void 0:globalThis.document){const n=ea(t),a=y.useRef(!1),i=y.useRef(()=>{});return y.useEffect(()=>{const l=c=>{if(c.target&&!a.current){let d=function(){jB(Dhe,n,u,{discrete:!0})};const u={originalEvent:c};c.pointerType==="touch"?(s.removeEventListener("click",i.current),i.current=d,s.addEventListener("click",i.current,{once:!0})):d()}else s.removeEventListener("click",i.current);a.current=!1},o=window.setTimeout(()=>{s.addEventListener("pointerdown",l)},0);return()=>{window.clearTimeout(o),s.removeEventListener("pointerdown",l),s.removeEventListener("click",i.current)}},[s,n]),{onPointerDownCapture:()=>a.current=!0}}function Fhe(t,s=globalThis==null?void 0:globalThis.document){const n=ea(t),a=y.useRef(!1);return y.useEffect(()=>{const i=l=>{l.target&&!a.current&&jB(Ohe,n,{originalEvent:l},{discrete:!1})};return s.addEventListener("focusin",i),()=>s.removeEventListener("focusin",i)},[s,n]),{onFocusCapture:()=>a.current=!0,onBlurCapture:()=>a.current=!1}}function YP(){const t=new CustomEvent(V_);document.dispatchEvent(t)}function jB(t,s,n,{discrete:a}){const i=n.originalEvent.target,l=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});s&&i.addEventListener(t,s,{once:!0}),a?Phe(i,l):i.dispatchEvent(l)}var BN=0;function _B(){y.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??XP()),document.body.insertAdjacentElement("beforeend",t[1]??XP()),BN++,()=>{BN===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(s=>s.remove()),BN--}},[])}function XP(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var FN="focusScope.autoFocusOnMount",$N="focusScope.autoFocusOnUnmount",QP={bubbles:!1,cancelable:!0},$he="FocusScope",ok=y.forwardRef((t,s)=>{const{loop:n=!1,trapped:a=!1,onMountAutoFocus:i,onUnmountAutoFocus:l,...o}=t,[c,d]=y.useState(null),u=ea(i),f=ea(l),m=y.useRef(null),x=Ss(s,j=>d(j)),b=y.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;y.useEffect(()=>{if(a){let j=function(A){if(b.paused||!c)return;const T=A.target;c.contains(T)?m.current=T:ic(m.current,{select:!0})},_=function(A){if(b.paused||!c)return;const T=A.relatedTarget;T!==null&&(c.contains(T)||ic(m.current,{select:!0}))},C=function(A){if(document.activeElement===document.body)for(const P of A)P.removedNodes.length>0&&ic(c)};document.addEventListener("focusin",j),document.addEventListener("focusout",_);const k=new MutationObserver(C);return c&&k.observe(c,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",j),document.removeEventListener("focusout",_),k.disconnect()}}},[a,c,b.paused]),y.useEffect(()=>{if(c){JP.add(b);const j=document.activeElement;if(!c.contains(j)){const C=new CustomEvent(FN,QP);c.addEventListener(FN,u),c.dispatchEvent(C),C.defaultPrevented||(zhe(qhe(SB(c)),{select:!0}),document.activeElement===j&&ic(c))}return()=>{c.removeEventListener(FN,u),setTimeout(()=>{const C=new CustomEvent($N,QP);c.addEventListener($N,f),c.dispatchEvent(C),C.defaultPrevented||ic(j??document.body,{select:!0}),c.removeEventListener($N,f),JP.remove(b)},0)}}},[c,u,f,b]);const w=y.useCallback(j=>{if(!n&&!a||b.paused)return;const _=j.key==="Tab"&&!j.altKey&&!j.ctrlKey&&!j.metaKey,C=document.activeElement;if(_&&C){const k=j.currentTarget,[A,T]=Uhe(k);A&&T?!j.shiftKey&&C===T?(j.preventDefault(),n&&ic(A,{select:!0})):j.shiftKey&&C===A&&(j.preventDefault(),n&&ic(T,{select:!0})):C===k&&j.preventDefault()}},[n,a,b.paused]);return r.jsx(Qt.div,{tabIndex:-1,...o,ref:x,onKeyDown:w})});ok.displayName=$he;function zhe(t,{select:s=!1}={}){const n=document.activeElement;for(const a of t)if(ic(a,{select:s}),document.activeElement!==n)return}function Uhe(t){const s=SB(t),n=ZP(s,t),a=ZP(s.reverse(),t);return[n,a]}function SB(t){const s=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:a=>{const i=a.tagName==="INPUT"&&a.type==="hidden";return a.disabled||a.hidden||i?NodeFilter.FILTER_SKIP:a.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)s.push(n.currentNode);return s}function ZP(t,s){for(const n of t)if(!Vhe(n,{upTo:s}))return n}function Vhe(t,{upTo:s}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(s!==void 0&&t===s)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function Hhe(t){return t instanceof HTMLInputElement&&"select"in t}function ic(t,{select:s=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&Hhe(t)&&s&&t.select()}}var JP=Whe();function Whe(){let t=[];return{add(s){const n=t[0];s!==n&&(n==null||n.pause()),t=eI(t,s),t.unshift(s)},remove(s){var n;t=eI(t,s),(n=t[0])==null||n.resume()}}}function eI(t,s){const n=[...t],a=n.indexOf(s);return a!==-1&&n.splice(a,1),n}function qhe(t){return t.filter(s=>s.tagName!=="A")}var Pr=globalThis!=null&&globalThis.document?y.useLayoutEffect:()=>{},Ghe=ab[" useId ".trim().toString()]||(()=>{}),Khe=0;function Ic(t){const[s,n]=y.useState(Ghe());return Pr(()=>{n(a=>a??String(Khe++))},[t]),s?`radix-${s}`:""}const Yhe=["top","right","bottom","left"],qc=Math.min,za=Math.max,Uy=Math.round,I0=Math.floor,$l=t=>({x:t,y:t}),Xhe={left:"right",right:"left",bottom:"top",top:"bottom"},Qhe={start:"end",end:"start"};function H_(t,s,n){return za(t,qc(s,n))}function Ao(t,s){return typeof t=="function"?t(s):t}function Eo(t){return t.split("-")[0]}function Mf(t){return t.split("-")[1]}function ck(t){return t==="x"?"y":"x"}function dk(t){return t==="y"?"height":"width"}const Zhe=new Set(["top","bottom"]);function Il(t){return Zhe.has(Eo(t))?"y":"x"}function uk(t){return ck(Il(t))}function Jhe(t,s,n){n===void 0&&(n=!1);const a=Mf(t),i=uk(t),l=dk(i);let o=i==="x"?a===(n?"end":"start")?"right":"left":a==="start"?"bottom":"top";return s.reference[l]>s.floating[l]&&(o=Vy(o)),[o,Vy(o)]}function efe(t){const s=Vy(t);return[W_(t),s,W_(s)]}function W_(t){return t.replace(/start|end/g,s=>Qhe[s])}const tI=["left","right"],sI=["right","left"],tfe=["top","bottom"],sfe=["bottom","top"];function nfe(t,s,n){switch(t){case"top":case"bottom":return n?s?sI:tI:s?tI:sI;case"left":case"right":return s?tfe:sfe;default:return[]}}function rfe(t,s,n,a){const i=Mf(t);let l=nfe(Eo(t),n==="start",a);return i&&(l=l.map(o=>o+"-"+i),s&&(l=l.concat(l.map(W_)))),l}function Vy(t){return t.replace(/left|right|bottom|top/g,s=>Xhe[s])}function afe(t){return{top:0,right:0,bottom:0,left:0,...t}}function CB(t){return typeof t!="number"?afe(t):{top:t,right:t,bottom:t,left:t}}function Hy(t){const{x:s,y:n,width:a,height:i}=t;return{width:a,height:i,top:n,left:s,right:s+a,bottom:n+i,x:s,y:n}}function nI(t,s,n){let{reference:a,floating:i}=t;const l=Il(s),o=uk(s),c=dk(o),d=Eo(s),u=l==="y",f=a.x+a.width/2-i.width/2,m=a.y+a.height/2-i.height/2,x=a[c]/2-i[c]/2;let b;switch(d){case"top":b={x:f,y:a.y-i.height};break;case"bottom":b={x:f,y:a.y+a.height};break;case"right":b={x:a.x+a.width,y:m};break;case"left":b={x:a.x-i.width,y:m};break;default:b={x:a.x,y:a.y}}switch(Mf(s)){case"start":b[o]-=x*(n&&u?-1:1);break;case"end":b[o]+=x*(n&&u?-1:1);break}return b}const ife=async(t,s,n)=>{const{placement:a="bottom",strategy:i="absolute",middleware:l=[],platform:o}=n,c=l.filter(Boolean),d=await(o.isRTL==null?void 0:o.isRTL(s));let u=await o.getElementRects({reference:t,floating:s,strategy:i}),{x:f,y:m}=nI(u,a,d),x=a,b={},w=0;for(let j=0;j<c.length;j++){const{name:_,fn:C}=c[j],{x:k,y:A,data:T,reset:P}=await C({x:f,y:m,initialPlacement:a,placement:x,strategy:i,middlewareData:b,rects:u,platform:o,elements:{reference:t,floating:s}});f=k??f,m=A??m,b={...b,[_]:{...b[_],...T}},P&&w<=50&&(w++,typeof P=="object"&&(P.placement&&(x=P.placement),P.rects&&(u=P.rects===!0?await o.getElementRects({reference:t,floating:s,strategy:i}):P.rects),{x:f,y:m}=nI(u,x,d)),j=-1)}return{x:f,y:m,placement:x,strategy:i,middlewareData:b}};async function Bp(t,s){var n;s===void 0&&(s={});const{x:a,y:i,platform:l,rects:o,elements:c,strategy:d}=t,{boundary:u="clippingAncestors",rootBoundary:f="viewport",elementContext:m="floating",altBoundary:x=!1,padding:b=0}=Ao(s,t),w=CB(b),_=c[x?m==="floating"?"reference":"floating":m],C=Hy(await l.getClippingRect({element:(n=await(l.isElement==null?void 0:l.isElement(_)))==null||n?_:_.contextElement||await(l.getDocumentElement==null?void 0:l.getDocumentElement(c.floating)),boundary:u,rootBoundary:f,strategy:d})),k=m==="floating"?{x:a,y:i,width:o.floating.width,height:o.floating.height}:o.reference,A=await(l.getOffsetParent==null?void 0:l.getOffsetParent(c.floating)),T=await(l.isElement==null?void 0:l.isElement(A))?await(l.getScale==null?void 0:l.getScale(A))||{x:1,y:1}:{x:1,y:1},P=Hy(l.convertOffsetParentRelativeRectToViewportRelativeRect?await l.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:k,offsetParent:A,strategy:d}):k);return{top:(C.top-P.top+w.top)/T.y,bottom:(P.bottom-C.bottom+w.bottom)/T.y,left:(C.left-P.left+w.left)/T.x,right:(P.right-C.right+w.right)/T.x}}const lfe=t=>({name:"arrow",options:t,async fn(s){const{x:n,y:a,placement:i,rects:l,platform:o,elements:c,middlewareData:d}=s,{element:u,padding:f=0}=Ao(t,s)||{};if(u==null)return{};const m=CB(f),x={x:n,y:a},b=uk(i),w=dk(b),j=await o.getDimensions(u),_=b==="y",C=_?"top":"left",k=_?"bottom":"right",A=_?"clientHeight":"clientWidth",T=l.reference[w]+l.reference[b]-x[b]-l.floating[w],P=x[b]-l.reference[b],R=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let I=R?R[A]:0;(!I||!await(o.isElement==null?void 0:o.isElement(R)))&&(I=c.floating[A]||l.floating[w]);const O=T/2-P/2,M=I/2-j[w]/2-1,B=qc(m[C],M),L=qc(m[k],M),F=B,V=I-j[w]-L,U=I/2-j[w]/2+O,z=H_(F,U,V),W=!d.arrow&&Mf(i)!=null&&U!==z&&l.reference[w]/2-(U<F?B:L)-j[w]/2<0,q=W?U<F?U-F:U-V:0;return{[b]:x[b]+q,data:{[b]:z,centerOffset:U-z-q,...W&&{alignmentOffset:q}},reset:W}}}),ofe=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(s){var n,a;const{placement:i,middlewareData:l,rects:o,initialPlacement:c,platform:d,elements:u}=s,{mainAxis:f=!0,crossAxis:m=!0,fallbackPlacements:x,fallbackStrategy:b="bestFit",fallbackAxisSideDirection:w="none",flipAlignment:j=!0,..._}=Ao(t,s);if((n=l.arrow)!=null&&n.alignmentOffset)return{};const C=Eo(i),k=Il(c),A=Eo(c)===c,T=await(d.isRTL==null?void 0:d.isRTL(u.floating)),P=x||(A||!j?[Vy(c)]:efe(c)),R=w!=="none";!x&&R&&P.push(...rfe(c,j,w,T));const I=[c,...P],O=await Bp(s,_),M=[];let B=((a=l.flip)==null?void 0:a.overflows)||[];if(f&&M.push(O[C]),m){const U=Jhe(i,o,T);M.push(O[U[0]],O[U[1]])}if(B=[...B,{placement:i,overflows:M}],!M.every(U=>U<=0)){var L,F;const U=(((L=l.flip)==null?void 0:L.index)||0)+1,z=I[U];if(z&&(!(m==="alignment"?k!==Il(z):!1)||B.every(G=>Il(G.placement)===k?G.overflows[0]>0:!0)))return{data:{index:U,overflows:B},reset:{placement:z}};let W=(F=B.filter(q=>q.overflows[0]<=0).sort((q,G)=>q.overflows[1]-G.overflows[1])[0])==null?void 0:F.placement;if(!W)switch(b){case"bestFit":{var V;const q=(V=B.filter(G=>{if(R){const se=Il(G.placement);return se===k||se==="y"}return!0}).map(G=>[G.placement,G.overflows.filter(se=>se>0).reduce((se,ge)=>se+ge,0)]).sort((G,se)=>G[1]-se[1])[0])==null?void 0:V[0];q&&(W=q);break}case"initialPlacement":W=c;break}if(i!==W)return{reset:{placement:W}}}return{}}}};function rI(t,s){return{top:t.top-s.height,right:t.right-s.width,bottom:t.bottom-s.height,left:t.left-s.width}}function aI(t){return Yhe.some(s=>t[s]>=0)}const cfe=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(s){const{rects:n}=s,{strategy:a="referenceHidden",...i}=Ao(t,s);switch(a){case"referenceHidden":{const l=await Bp(s,{...i,elementContext:"reference"}),o=rI(l,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:aI(o)}}}case"escaped":{const l=await Bp(s,{...i,altBoundary:!0}),o=rI(l,n.floating);return{data:{escapedOffsets:o,escaped:aI(o)}}}default:return{}}}}},kB=new Set(["left","top"]);async function dfe(t,s){const{placement:n,platform:a,elements:i}=t,l=await(a.isRTL==null?void 0:a.isRTL(i.floating)),o=Eo(n),c=Mf(n),d=Il(n)==="y",u=kB.has(o)?-1:1,f=l&&d?-1:1,m=Ao(s,t);let{mainAxis:x,crossAxis:b,alignmentAxis:w}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return c&&typeof w=="number"&&(b=c==="end"?w*-1:w),d?{x:b*f,y:x*u}:{x:x*u,y:b*f}}const ufe=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(s){var n,a;const{x:i,y:l,placement:o,middlewareData:c}=s,d=await dfe(s,t);return o===((n=c.offset)==null?void 0:n.placement)&&(a=c.arrow)!=null&&a.alignmentOffset?{}:{x:i+d.x,y:l+d.y,data:{...d,placement:o}}}}},hfe=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(s){const{x:n,y:a,placement:i}=s,{mainAxis:l=!0,crossAxis:o=!1,limiter:c={fn:_=>{let{x:C,y:k}=_;return{x:C,y:k}}},...d}=Ao(t,s),u={x:n,y:a},f=await Bp(s,d),m=Il(Eo(i)),x=ck(m);let b=u[x],w=u[m];if(l){const _=x==="y"?"top":"left",C=x==="y"?"bottom":"right",k=b+f[_],A=b-f[C];b=H_(k,b,A)}if(o){const _=m==="y"?"top":"left",C=m==="y"?"bottom":"right",k=w+f[_],A=w-f[C];w=H_(k,w,A)}const j=c.fn({...s,[x]:b,[m]:w});return{...j,data:{x:j.x-n,y:j.y-a,enabled:{[x]:l,[m]:o}}}}}},ffe=function(t){return t===void 0&&(t={}),{options:t,fn(s){const{x:n,y:a,placement:i,rects:l,middlewareData:o}=s,{offset:c=0,mainAxis:d=!0,crossAxis:u=!0}=Ao(t,s),f={x:n,y:a},m=Il(i),x=ck(m);let b=f[x],w=f[m];const j=Ao(c,s),_=typeof j=="number"?{mainAxis:j,crossAxis:0}:{mainAxis:0,crossAxis:0,...j};if(d){const A=x==="y"?"height":"width",T=l.reference[x]-l.floating[A]+_.mainAxis,P=l.reference[x]+l.reference[A]-_.mainAxis;b<T?b=T:b>P&&(b=P)}if(u){var C,k;const A=x==="y"?"width":"height",T=kB.has(Eo(i)),P=l.reference[m]-l.floating[A]+(T&&((C=o.offset)==null?void 0:C[m])||0)+(T?0:_.crossAxis),R=l.reference[m]+l.reference[A]+(T?0:((k=o.offset)==null?void 0:k[m])||0)-(T?_.crossAxis:0);w<P?w=P:w>R&&(w=R)}return{[x]:b,[m]:w}}}},mfe=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(s){var n,a;const{placement:i,rects:l,platform:o,elements:c}=s,{apply:d=()=>{},...u}=Ao(t,s),f=await Bp(s,u),m=Eo(i),x=Mf(i),b=Il(i)==="y",{width:w,height:j}=l.floating;let _,C;m==="top"||m==="bottom"?(_=m,C=x===(await(o.isRTL==null?void 0:o.isRTL(c.floating))?"start":"end")?"left":"right"):(C=m,_=x==="end"?"top":"bottom");const k=j-f.top-f.bottom,A=w-f.left-f.right,T=qc(j-f[_],k),P=qc(w-f[C],A),R=!s.middlewareData.shift;let I=T,O=P;if((n=s.middlewareData.shift)!=null&&n.enabled.x&&(O=A),(a=s.middlewareData.shift)!=null&&a.enabled.y&&(I=k),R&&!x){const B=za(f.left,0),L=za(f.right,0),F=za(f.top,0),V=za(f.bottom,0);b?O=w-2*(B!==0||L!==0?B+L:za(f.left,f.right)):I=j-2*(F!==0||V!==0?F+V:za(f.top,f.bottom))}await d({...s,availableWidth:O,availableHeight:I});const M=await o.getDimensions(c.floating);return w!==M.width||j!==M.height?{reset:{rects:!0}}:{}}}};function Vb(){return typeof window<"u"}function Df(t){return AB(t)?(t.nodeName||"").toLowerCase():"#document"}function Ya(t){var s;return(t==null||(s=t.ownerDocument)==null?void 0:s.defaultView)||window}function Ql(t){var s;return(s=(AB(t)?t.ownerDocument:t.document)||window.document)==null?void 0:s.documentElement}function AB(t){return Vb()?t instanceof Node||t instanceof Ya(t).Node:!1}function al(t){return Vb()?t instanceof Element||t instanceof Ya(t).Element:!1}function Vl(t){return Vb()?t instanceof HTMLElement||t instanceof Ya(t).HTMLElement:!1}function iI(t){return!Vb()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ya(t).ShadowRoot}const pfe=new Set(["inline","contents"]);function Ax(t){const{overflow:s,overflowX:n,overflowY:a,display:i}=il(t);return/auto|scroll|overlay|hidden|clip/.test(s+a+n)&&!pfe.has(i)}const xfe=new Set(["table","td","th"]);function gfe(t){return xfe.has(Df(t))}const yfe=[":popover-open",":modal"];function Hb(t){return yfe.some(s=>{try{return t.matches(s)}catch{return!1}})}const bfe=["transform","translate","scale","rotate","perspective"],vfe=["transform","translate","scale","rotate","perspective","filter"],wfe=["paint","layout","strict","content"];function hk(t){const s=fk(),n=al(t)?il(t):t;return bfe.some(a=>n[a]?n[a]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!s&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!s&&(n.filter?n.filter!=="none":!1)||vfe.some(a=>(n.willChange||"").includes(a))||wfe.some(a=>(n.contain||"").includes(a))}function Nfe(t){let s=Gc(t);for(;Vl(s)&&!sf(s);){if(hk(s))return s;if(Hb(s))return null;s=Gc(s)}return null}function fk(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const jfe=new Set(["html","body","#document"]);function sf(t){return jfe.has(Df(t))}function il(t){return Ya(t).getComputedStyle(t)}function Wb(t){return al(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Gc(t){if(Df(t)==="html")return t;const s=t.assignedSlot||t.parentNode||iI(t)&&t.host||Ql(t);return iI(s)?s.host:s}function EB(t){const s=Gc(t);return sf(s)?t.ownerDocument?t.ownerDocument.body:t.body:Vl(s)&&Ax(s)?s:EB(s)}function Fp(t,s,n){var a;s===void 0&&(s=[]),n===void 0&&(n=!0);const i=EB(t),l=i===((a=t.ownerDocument)==null?void 0:a.body),o=Ya(i);if(l){const c=q_(o);return s.concat(o,o.visualViewport||[],Ax(i)?i:[],c&&n?Fp(c):[])}return s.concat(i,Fp(i,[],n))}function q_(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function TB(t){const s=il(t);let n=parseFloat(s.width)||0,a=parseFloat(s.height)||0;const i=Vl(t),l=i?t.offsetWidth:n,o=i?t.offsetHeight:a,c=Uy(n)!==l||Uy(a)!==o;return c&&(n=l,a=o),{width:n,height:a,$:c}}function mk(t){return al(t)?t:t.contextElement}function Oh(t){const s=mk(t);if(!Vl(s))return $l(1);const n=s.getBoundingClientRect(),{width:a,height:i,$:l}=TB(s);let o=(l?Uy(n.width):n.width)/a,c=(l?Uy(n.height):n.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!c||!Number.isFinite(c))&&(c=1),{x:o,y:c}}const _fe=$l(0);function PB(t){const s=Ya(t);return!fk()||!s.visualViewport?_fe:{x:s.visualViewport.offsetLeft,y:s.visualViewport.offsetTop}}function Sfe(t,s,n){return s===void 0&&(s=!1),!n||s&&n!==Ya(t)?!1:s}function fu(t,s,n,a){s===void 0&&(s=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),l=mk(t);let o=$l(1);s&&(a?al(a)&&(o=Oh(a)):o=Oh(t));const c=Sfe(l,n,a)?PB(l):$l(0);let d=(i.left+c.x)/o.x,u=(i.top+c.y)/o.y,f=i.width/o.x,m=i.height/o.y;if(l){const x=Ya(l),b=a&&al(a)?Ya(a):a;let w=x,j=q_(w);for(;j&&a&&b!==w;){const _=Oh(j),C=j.getBoundingClientRect(),k=il(j),A=C.left+(j.clientLeft+parseFloat(k.paddingLeft))*_.x,T=C.top+(j.clientTop+parseFloat(k.paddingTop))*_.y;d*=_.x,u*=_.y,f*=_.x,m*=_.y,d+=A,u+=T,w=Ya(j),j=q_(w)}}return Hy({width:f,height:m,x:d,y:u})}function qb(t,s){const n=Wb(t).scrollLeft;return s?s.left+n:fu(Ql(t)).left+n}function IB(t,s){const n=t.getBoundingClientRect(),a=n.left+s.scrollLeft-qb(t,n),i=n.top+s.scrollTop;return{x:a,y:i}}function Cfe(t){let{elements:s,rect:n,offsetParent:a,strategy:i}=t;const l=i==="fixed",o=Ql(a),c=s?Hb(s.floating):!1;if(a===o||c&&l)return n;let d={scrollLeft:0,scrollTop:0},u=$l(1);const f=$l(0),m=Vl(a);if((m||!m&&!l)&&((Df(a)!=="body"||Ax(o))&&(d=Wb(a)),Vl(a))){const b=fu(a);u=Oh(a),f.x=b.x+a.clientLeft,f.y=b.y+a.clientTop}const x=o&&!m&&!l?IB(o,d):$l(0);return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-d.scrollLeft*u.x+f.x+x.x,y:n.y*u.y-d.scrollTop*u.y+f.y+x.y}}function kfe(t){return Array.from(t.getClientRects())}function Afe(t){const s=Ql(t),n=Wb(t),a=t.ownerDocument.body,i=za(s.scrollWidth,s.clientWidth,a.scrollWidth,a.clientWidth),l=za(s.scrollHeight,s.clientHeight,a.scrollHeight,a.clientHeight);let o=-n.scrollLeft+qb(t);const c=-n.scrollTop;return il(a).direction==="rtl"&&(o+=za(s.clientWidth,a.clientWidth)-i),{width:i,height:l,x:o,y:c}}const lI=25;function Efe(t,s){const n=Ya(t),a=Ql(t),i=n.visualViewport;let l=a.clientWidth,o=a.clientHeight,c=0,d=0;if(i){l=i.width,o=i.height;const f=fk();(!f||f&&s==="fixed")&&(c=i.offsetLeft,d=i.offsetTop)}const u=qb(a);if(u<=0){const f=a.ownerDocument,m=f.body,x=getComputedStyle(m),b=f.compatMode==="CSS1Compat"&&parseFloat(x.marginLeft)+parseFloat(x.marginRight)||0,w=Math.abs(a.clientWidth-m.clientWidth-b);w<=lI&&(l-=w)}else u<=lI&&(l+=u);return{width:l,height:o,x:c,y:d}}const Tfe=new Set(["absolute","fixed"]);function Pfe(t,s){const n=fu(t,!0,s==="fixed"),a=n.top+t.clientTop,i=n.left+t.clientLeft,l=Vl(t)?Oh(t):$l(1),o=t.clientWidth*l.x,c=t.clientHeight*l.y,d=i*l.x,u=a*l.y;return{width:o,height:c,x:d,y:u}}function oI(t,s,n){let a;if(s==="viewport")a=Efe(t,n);else if(s==="document")a=Afe(Ql(t));else if(al(s))a=Pfe(s,n);else{const i=PB(t);a={x:s.x-i.x,y:s.y-i.y,width:s.width,height:s.height}}return Hy(a)}function MB(t,s){const n=Gc(t);return n===s||!al(n)||sf(n)?!1:il(n).position==="fixed"||MB(n,s)}function Ife(t,s){const n=s.get(t);if(n)return n;let a=Fp(t,[],!1).filter(c=>al(c)&&Df(c)!=="body"),i=null;const l=il(t).position==="fixed";let o=l?Gc(t):t;for(;al(o)&&!sf(o);){const c=il(o),d=hk(o);!d&&c.position==="fixed"&&(i=null),(l?!d&&!i:!d&&c.position==="static"&&!!i&&Tfe.has(i.position)||Ax(o)&&!d&&MB(t,o))?a=a.filter(f=>f!==o):i=c,o=Gc(o)}return s.set(t,a),a}function Mfe(t){let{element:s,boundary:n,rootBoundary:a,strategy:i}=t;const o=[...n==="clippingAncestors"?Hb(s)?[]:Ife(s,this._c):[].concat(n),a],c=o[0],d=o.reduce((u,f)=>{const m=oI(s,f,i);return u.top=za(m.top,u.top),u.right=qc(m.right,u.right),u.bottom=qc(m.bottom,u.bottom),u.left=za(m.left,u.left),u},oI(s,c,i));return{width:d.right-d.left,height:d.bottom-d.top,x:d.left,y:d.top}}function Dfe(t){const{width:s,height:n}=TB(t);return{width:s,height:n}}function Ofe(t,s,n){const a=Vl(s),i=Ql(s),l=n==="fixed",o=fu(t,!0,l,s);let c={scrollLeft:0,scrollTop:0};const d=$l(0);function u(){d.x=qb(i)}if(a||!a&&!l)if((Df(s)!=="body"||Ax(i))&&(c=Wb(s)),a){const b=fu(s,!0,l,s);d.x=b.x+s.clientLeft,d.y=b.y+s.clientTop}else i&&u();l&&!a&&i&&u();const f=i&&!a&&!l?IB(i,c):$l(0),m=o.left+c.scrollLeft-d.x-f.x,x=o.top+c.scrollTop-d.y-f.y;return{x:m,y:x,width:o.width,height:o.height}}function zN(t){return il(t).position==="static"}function cI(t,s){if(!Vl(t)||il(t).position==="fixed")return null;if(s)return s(t);let n=t.offsetParent;return Ql(t)===n&&(n=n.ownerDocument.body),n}function DB(t,s){const n=Ya(t);if(Hb(t))return n;if(!Vl(t)){let i=Gc(t);for(;i&&!sf(i);){if(al(i)&&!zN(i))return i;i=Gc(i)}return n}let a=cI(t,s);for(;a&&gfe(a)&&zN(a);)a=cI(a,s);return a&&sf(a)&&zN(a)&&!hk(a)?n:a||Nfe(t)||n}const Rfe=async function(t){const s=this.getOffsetParent||DB,n=this.getDimensions,a=await n(t.floating);return{reference:Ofe(t.reference,await s(t.floating),t.strategy),floating:{x:0,y:0,width:a.width,height:a.height}}};function Lfe(t){return il(t).direction==="rtl"}const Bfe={convertOffsetParentRelativeRectToViewportRelativeRect:Cfe,getDocumentElement:Ql,getClippingRect:Mfe,getOffsetParent:DB,getElementRects:Rfe,getClientRects:kfe,getDimensions:Dfe,getScale:Oh,isElement:al,isRTL:Lfe};function OB(t,s){return t.x===s.x&&t.y===s.y&&t.width===s.width&&t.height===s.height}function Ffe(t,s){let n=null,a;const i=Ql(t);function l(){var c;clearTimeout(a),(c=n)==null||c.disconnect(),n=null}function o(c,d){c===void 0&&(c=!1),d===void 0&&(d=1),l();const u=t.getBoundingClientRect(),{left:f,top:m,width:x,height:b}=u;if(c||s(),!x||!b)return;const w=I0(m),j=I0(i.clientWidth-(f+x)),_=I0(i.clientHeight-(m+b)),C=I0(f),A={rootMargin:-w+"px "+-j+"px "+-_+"px "+-C+"px",threshold:za(0,qc(1,d))||1};let T=!0;function P(R){const I=R[0].intersectionRatio;if(I!==d){if(!T)return o();I?o(!1,I):a=setTimeout(()=>{o(!1,1e-7)},1e3)}I===1&&!OB(u,t.getBoundingClientRect())&&o(),T=!1}try{n=new IntersectionObserver(P,{...A,root:i.ownerDocument})}catch{n=new IntersectionObserver(P,A)}n.observe(t)}return o(!0),l}function $fe(t,s,n,a){a===void 0&&(a={});const{ancestorScroll:i=!0,ancestorResize:l=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:d=!1}=a,u=mk(t),f=i||l?[...u?Fp(u):[],...Fp(s)]:[];f.forEach(C=>{i&&C.addEventListener("scroll",n,{passive:!0}),l&&C.addEventListener("resize",n)});const m=u&&c?Ffe(u,n):null;let x=-1,b=null;o&&(b=new ResizeObserver(C=>{let[k]=C;k&&k.target===u&&b&&(b.unobserve(s),cancelAnimationFrame(x),x=requestAnimationFrame(()=>{var A;(A=b)==null||A.observe(s)})),n()}),u&&!d&&b.observe(u),b.observe(s));let w,j=d?fu(t):null;d&&_();function _(){const C=fu(t);j&&!OB(j,C)&&n(),j=C,w=requestAnimationFrame(_)}return n(),()=>{var C;f.forEach(k=>{i&&k.removeEventListener("scroll",n),l&&k.removeEventListener("resize",n)}),m==null||m(),(C=b)==null||C.disconnect(),b=null,d&&cancelAnimationFrame(w)}}const zfe=ufe,Ufe=hfe,Vfe=ofe,Hfe=mfe,Wfe=cfe,dI=lfe,qfe=ffe,Gfe=(t,s,n)=>{const a=new Map,i={platform:Bfe,...n},l={...i.platform,_c:a};return ife(t,s,{...i,platform:l})};var Kfe=typeof document<"u",Yfe=function(){},$g=Kfe?y.useLayoutEffect:Yfe;function Wy(t,s){if(t===s)return!0;if(typeof t!=typeof s)return!1;if(typeof t=="function"&&t.toString()===s.toString())return!0;let n,a,i;if(t&&s&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==s.length)return!1;for(a=n;a--!==0;)if(!Wy(t[a],s[a]))return!1;return!0}if(i=Object.keys(t),n=i.length,n!==Object.keys(s).length)return!1;for(a=n;a--!==0;)if(!{}.hasOwnProperty.call(s,i[a]))return!1;for(a=n;a--!==0;){const l=i[a];if(!(l==="_owner"&&t.$$typeof)&&!Wy(t[l],s[l]))return!1}return!0}return t!==t&&s!==s}function RB(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function uI(t,s){const n=RB(t);return Math.round(s*n)/n}function UN(t){const s=y.useRef(t);return $g(()=>{s.current=t}),s}function Xfe(t){t===void 0&&(t={});const{placement:s="bottom",strategy:n="absolute",middleware:a=[],platform:i,elements:{reference:l,floating:o}={},transform:c=!0,whileElementsMounted:d,open:u}=t,[f,m]=y.useState({x:0,y:0,strategy:n,placement:s,middlewareData:{},isPositioned:!1}),[x,b]=y.useState(a);Wy(x,a)||b(a);const[w,j]=y.useState(null),[_,C]=y.useState(null),k=y.useCallback(G=>{G!==R.current&&(R.current=G,j(G))},[]),A=y.useCallback(G=>{G!==I.current&&(I.current=G,C(G))},[]),T=l||w,P=o||_,R=y.useRef(null),I=y.useRef(null),O=y.useRef(f),M=d!=null,B=UN(d),L=UN(i),F=UN(u),V=y.useCallback(()=>{if(!R.current||!I.current)return;const G={placement:s,strategy:n,middleware:x};L.current&&(G.platform=L.current),Gfe(R.current,I.current,G).then(se=>{const ge={...se,isPositioned:F.current!==!1};U.current&&!Wy(O.current,ge)&&(O.current=ge,td.flushSync(()=>{m(ge)}))})},[x,s,n,L,F]);$g(()=>{u===!1&&O.current.isPositioned&&(O.current.isPositioned=!1,m(G=>({...G,isPositioned:!1})))},[u]);const U=y.useRef(!1);$g(()=>(U.current=!0,()=>{U.current=!1}),[]),$g(()=>{if(T&&(R.current=T),P&&(I.current=P),T&&P){if(B.current)return B.current(T,P,V);V()}},[T,P,V,B,M]);const z=y.useMemo(()=>({reference:R,floating:I,setReference:k,setFloating:A}),[k,A]),W=y.useMemo(()=>({reference:T,floating:P}),[T,P]),q=y.useMemo(()=>{const G={position:n,left:0,top:0};if(!W.floating)return G;const se=uI(W.floating,f.x),ge=uI(W.floating,f.y);return c?{...G,transform:"translate("+se+"px, "+ge+"px)",...RB(W.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:se,top:ge}},[n,c,W.floating,f.x,f.y]);return y.useMemo(()=>({...f,update:V,refs:z,elements:W,floatingStyles:q}),[f,V,z,W,q])}const Qfe=t=>{function s(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:a,padding:i}=typeof t=="function"?t(n):t;return a&&s(a)?a.current!=null?dI({element:a.current,padding:i}).fn(n):{}:a?dI({element:a,padding:i}).fn(n):{}}}},Zfe=(t,s)=>({...zfe(t),options:[t,s]}),Jfe=(t,s)=>({...Ufe(t),options:[t,s]}),eme=(t,s)=>({...qfe(t),options:[t,s]}),tme=(t,s)=>({...Vfe(t),options:[t,s]}),sme=(t,s)=>({...Hfe(t),options:[t,s]}),nme=(t,s)=>({...Wfe(t),options:[t,s]}),rme=(t,s)=>({...Qfe(t),options:[t,s]});var ame="Arrow",LB=y.forwardRef((t,s)=>{const{children:n,width:a=10,height:i=5,...l}=t;return r.jsx(Qt.svg,{...l,ref:s,width:a,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:r.jsx("polygon",{points:"0,0 30,0 15,10"})})});LB.displayName=ame;var ime=LB;function lme(t){const[s,n]=y.useState(void 0);return Pr(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const a=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const l=i[0];let o,c;if("borderBoxSize"in l){const d=l.borderBoxSize,u=Array.isArray(d)?d[0]:d;o=u.inlineSize,c=u.blockSize}else o=t.offsetWidth,c=t.offsetHeight;n({width:o,height:c})});return a.observe(t,{box:"border-box"}),()=>a.unobserve(t)}else n(void 0)},[t]),s}var pk="Popper",[BB,FB]=Mu(pk),[ome,$B]=BB(pk),zB=t=>{const{__scopePopper:s,children:n}=t,[a,i]=y.useState(null);return r.jsx(ome,{scope:s,anchor:a,onAnchorChange:i,children:n})};zB.displayName=pk;var UB="PopperAnchor",VB=y.forwardRef((t,s)=>{const{__scopePopper:n,virtualRef:a,...i}=t,l=$B(UB,n),o=y.useRef(null),c=Ss(s,o),d=y.useRef(null);return y.useEffect(()=>{const u=d.current;d.current=(a==null?void 0:a.current)||o.current,u!==d.current&&l.onAnchorChange(d.current)}),a?null:r.jsx(Qt.div,{...i,ref:c})});VB.displayName=UB;var xk="PopperContent",[cme,dme]=BB(xk),HB=y.forwardRef((t,s)=>{var oe,_e,ce,he,fe,le;const{__scopePopper:n,side:a="bottom",sideOffset:i=0,align:l="center",alignOffset:o=0,arrowPadding:c=0,avoidCollisions:d=!0,collisionBoundary:u=[],collisionPadding:f=0,sticky:m="partial",hideWhenDetached:x=!1,updatePositionStrategy:b="optimized",onPlaced:w,...j}=t,_=$B(xk,n),[C,k]=y.useState(null),A=Ss(s,Ve=>k(Ve)),[T,P]=y.useState(null),R=lme(T),I=(R==null?void 0:R.width)??0,O=(R==null?void 0:R.height)??0,M=a+(l!=="center"?"-"+l:""),B=typeof f=="number"?f:{top:0,right:0,bottom:0,left:0,...f},L=Array.isArray(u)?u:[u],F=L.length>0,V={padding:B,boundary:L.filter(hme),altBoundary:F},{refs:U,floatingStyles:z,placement:W,isPositioned:q,middlewareData:G}=Xfe({strategy:"fixed",placement:M,whileElementsMounted:(...Ve)=>$fe(...Ve,{animationFrame:b==="always"}),elements:{reference:_.anchor},middleware:[Zfe({mainAxis:i+O,alignmentAxis:o}),d&&Jfe({mainAxis:!0,crossAxis:!1,limiter:m==="partial"?eme():void 0,...V}),d&&tme({...V}),sme({...V,apply:({elements:Ve,rects:Ke,availableWidth:wt,availableHeight:mt})=>{const{width:rt,height:bt}=Ke.reference,be=Ve.floating.style;be.setProperty("--radix-popper-available-width",`${wt}px`),be.setProperty("--radix-popper-available-height",`${mt}px`),be.setProperty("--radix-popper-anchor-width",`${rt}px`),be.setProperty("--radix-popper-anchor-height",`${bt}px`)}}),T&&rme({element:T,padding:c}),fme({arrowWidth:I,arrowHeight:O}),x&&nme({strategy:"referenceHidden",...V})]}),[se,ge]=GB(W),ke=ea(w);Pr(()=>{q&&(ke==null||ke())},[q,ke]);const ee=(oe=G.arrow)==null?void 0:oe.x,pe=(_e=G.arrow)==null?void 0:_e.y,ue=((ce=G.arrow)==null?void 0:ce.centerOffset)!==0,[ye,X]=y.useState();return Pr(()=>{C&&X(window.getComputedStyle(C).zIndex)},[C]),r.jsx("div",{ref:U.setFloating,"data-radix-popper-content-wrapper":"",style:{...z,transform:q?z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ye,"--radix-popper-transform-origin":[(he=G.transformOrigin)==null?void 0:he.x,(fe=G.transformOrigin)==null?void 0:fe.y].join(" "),...((le=G.hide)==null?void 0:le.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:r.jsx(cme,{scope:n,placedSide:se,onArrowChange:P,arrowX:ee,arrowY:pe,shouldHideArrow:ue,children:r.jsx(Qt.div,{"data-side":se,"data-align":ge,...j,ref:A,style:{...j.style,animation:q?void 0:"none"}})})})});HB.displayName=xk;var WB="PopperArrow",ume={top:"bottom",right:"left",bottom:"top",left:"right"},qB=y.forwardRef(function(s,n){const{__scopePopper:a,...i}=s,l=dme(WB,a),o=ume[l.placedSide];return r.jsx("span",{ref:l.onArrowChange,style:{position:"absolute",left:l.arrowX,top:l.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[l.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[l.placedSide],visibility:l.shouldHideArrow?"hidden":void 0},children:r.jsx(ime,{...i,ref:n,style:{...i.style,display:"block"}})})});qB.displayName=WB;function hme(t){return t!==null}var fme=t=>({name:"transformOrigin",options:t,fn(s){var _,C,k;const{placement:n,rects:a,middlewareData:i}=s,o=((_=i.arrow)==null?void 0:_.centerOffset)!==0,c=o?0:t.arrowWidth,d=o?0:t.arrowHeight,[u,f]=GB(n),m={start:"0%",center:"50%",end:"100%"}[f],x=(((C=i.arrow)==null?void 0:C.x)??0)+c/2,b=(((k=i.arrow)==null?void 0:k.y)??0)+d/2;let w="",j="";return u==="bottom"?(w=o?m:`${x}px`,j=`${-d}px`):u==="top"?(w=o?m:`${x}px`,j=`${a.floating.height+d}px`):u==="right"?(w=`${-d}px`,j=o?m:`${b}px`):u==="left"&&(w=`${a.floating.width+d}px`,j=o?m:`${b}px`),{data:{x:w,y:j}}}});function GB(t){const[s,n="center"]=t.split("-");return[s,n]}var mme=zB,pme=VB,xme=HB,gme=qB,yme="Portal",gk=y.forwardRef((t,s)=>{var c;const{container:n,...a}=t,[i,l]=y.useState(!1);Pr(()=>l(!0),[]);const o=n||i&&((c=globalThis==null?void 0:globalThis.document)==null?void 0:c.body);return o?vL.createPortal(r.jsx(Qt.div,{...a,ref:s}),o):null});gk.displayName=yme;var bme=ab[" useInsertionEffect ".trim().toString()]||Pr;function $p({prop:t,defaultProp:s,onChange:n=()=>{},caller:a}){const[i,l,o]=vme({defaultProp:s,onChange:n}),c=t!==void 0,d=c?t:i;{const f=y.useRef(t!==void 0);y.useEffect(()=>{const m=f.current;m!==c&&console.warn(`${a} is changing from ${m?"controlled":"uncontrolled"} to ${c?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),f.current=c},[c,a])}const u=y.useCallback(f=>{var m;if(c){const x=wme(f)?f(t):f;x!==t&&((m=o.current)==null||m.call(o,x))}else l(f)},[c,t,l,o]);return[d,u]}function vme({defaultProp:t,onChange:s}){const[n,a]=y.useState(t),i=y.useRef(n),l=y.useRef(s);return bme(()=>{l.current=s},[s]),y.useEffect(()=>{var o;i.current!==n&&((o=l.current)==null||o.call(l,n),i.current=n)},[n,i]),[n,a,l]}function wme(t){return typeof t=="function"}function Nme(t){const s=y.useRef({value:t,previous:t});return y.useMemo(()=>(s.current.value!==t&&(s.current.previous=s.current.value,s.current.value=t),s.current.previous),[t])}var KB=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),jme="VisuallyHidden",_me=y.forwardRef((t,s)=>r.jsx(Qt.span,{...t,ref:s,style:{...KB,...t.style}}));_me.displayName=jme;var Sme=function(t){if(typeof document>"u")return null;var s=Array.isArray(t)?t[0]:t;return s.ownerDocument.body},Xu=new WeakMap,M0=new WeakMap,D0={},VN=0,YB=function(t){return t&&(t.host||YB(t.parentNode))},Cme=function(t,s){return s.map(function(n){if(t.contains(n))return n;var a=YB(n);return a&&t.contains(a)?a:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},kme=function(t,s,n,a){var i=Cme(s,Array.isArray(t)?t:[t]);D0[n]||(D0[n]=new WeakMap);var l=D0[n],o=[],c=new Set,d=new Set(i),u=function(m){!m||c.has(m)||(c.add(m),u(m.parentNode))};i.forEach(u);var f=function(m){!m||d.has(m)||Array.prototype.forEach.call(m.children,function(x){if(c.has(x))f(x);else try{var b=x.getAttribute(a),w=b!==null&&b!=="false",j=(Xu.get(x)||0)+1,_=(l.get(x)||0)+1;Xu.set(x,j),l.set(x,_),o.push(x),j===1&&w&&M0.set(x,!0),_===1&&x.setAttribute(n,"true"),w||x.setAttribute(a,"true")}catch(C){console.error("aria-hidden: cannot operate on ",x,C)}})};return f(s),c.clear(),VN++,function(){o.forEach(function(m){var x=Xu.get(m)-1,b=l.get(m)-1;Xu.set(m,x),l.set(m,b),x||(M0.has(m)||m.removeAttribute(a),M0.delete(m)),b||m.removeAttribute(n)}),VN--,VN||(Xu=new WeakMap,Xu=new WeakMap,M0=new WeakMap,D0={})}},XB=function(t,s,n){n===void 0&&(n="data-aria-hidden");var a=Array.from(Array.isArray(t)?t:[t]),i=Sme(t);return i?(a.push.apply(a,Array.from(i.querySelectorAll("[aria-live], script"))),kme(a,i,n,"aria-hidden")):function(){return null}},Tl=function(){return Tl=Object.assign||function(s){for(var n,a=1,i=arguments.length;a<i;a++){n=arguments[a];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(s[l]=n[l])}return s},Tl.apply(this,arguments)};function QB(t,s){var n={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&s.indexOf(a)<0&&(n[a]=t[a]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,a=Object.getOwnPropertySymbols(t);i<a.length;i++)s.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(t,a[i])&&(n[a[i]]=t[a[i]]);return n}function Ame(t,s,n){if(n||arguments.length===2)for(var a=0,i=s.length,l;a<i;a++)(l||!(a in s))&&(l||(l=Array.prototype.slice.call(s,0,a)),l[a]=s[a]);return t.concat(l||Array.prototype.slice.call(s))}var zg="right-scroll-bar-position",Ug="width-before-scroll-bar",Eme="with-scroll-bars-hidden",Tme="--removed-body-scroll-bar-size";function HN(t,s){return typeof t=="function"?t(s):t&&(t.current=s),t}function Pme(t,s){var n=y.useState(function(){return{value:t,callback:s,facade:{get current(){return n.value},set current(a){var i=n.value;i!==a&&(n.value=a,n.callback(a,i))}}}})[0];return n.callback=s,n.facade}var Ime=typeof window<"u"?y.useLayoutEffect:y.useEffect,hI=new WeakMap;function Mme(t,s){var n=Pme(null,function(a){return t.forEach(function(i){return HN(i,a)})});return Ime(function(){var a=hI.get(n);if(a){var i=new Set(a),l=new Set(t),o=n.current;i.forEach(function(c){l.has(c)||HN(c,null)}),l.forEach(function(c){i.has(c)||HN(c,o)})}hI.set(n,t)},[t]),n}function Dme(t){return t}function Ome(t,s){s===void 0&&(s=Dme);var n=[],a=!1,i={read:function(){if(a)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(l){var o=s(l,a);return n.push(o),function(){n=n.filter(function(c){return c!==o})}},assignSyncMedium:function(l){for(a=!0;n.length;){var o=n;n=[],o.forEach(l)}n={push:function(c){return l(c)},filter:function(){return n}}},assignMedium:function(l){a=!0;var o=[];if(n.length){var c=n;n=[],c.forEach(l),o=n}var d=function(){var f=o;o=[],f.forEach(l)},u=function(){return Promise.resolve().then(d)};u(),n={push:function(f){o.push(f),u()},filter:function(f){return o=o.filter(f),n}}}};return i}function Rme(t){t===void 0&&(t={});var s=Ome(null);return s.options=Tl({async:!0,ssr:!1},t),s}var ZB=function(t){var s=t.sideCar,n=QB(t,["sideCar"]);if(!s)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var a=s.read();if(!a)throw new Error("Sidecar medium not found");return y.createElement(a,Tl({},n))};ZB.isSideCarExport=!0;function Lme(t,s){return t.useMedium(s),ZB}var JB=Rme(),WN=function(){},Gb=y.forwardRef(function(t,s){var n=y.useRef(null),a=y.useState({onScrollCapture:WN,onWheelCapture:WN,onTouchMoveCapture:WN}),i=a[0],l=a[1],o=t.forwardProps,c=t.children,d=t.className,u=t.removeScrollBar,f=t.enabled,m=t.shards,x=t.sideCar,b=t.noRelative,w=t.noIsolation,j=t.inert,_=t.allowPinchZoom,C=t.as,k=C===void 0?"div":C,A=t.gapMode,T=QB(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),P=x,R=Mme([n,s]),I=Tl(Tl({},T),i);return y.createElement(y.Fragment,null,f&&y.createElement(P,{sideCar:JB,removeScrollBar:u,shards:m,noRelative:b,noIsolation:w,inert:j,setCallbacks:l,allowPinchZoom:!!_,lockRef:n,gapMode:A}),o?y.cloneElement(y.Children.only(c),Tl(Tl({},I),{ref:R})):y.createElement(k,Tl({},I,{className:d,ref:R}),c))});Gb.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Gb.classNames={fullWidth:Ug,zeroRight:zg};var Bme=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Fme(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var s=Bme();return s&&t.setAttribute("nonce",s),t}function $me(t,s){t.styleSheet?t.styleSheet.cssText=s:t.appendChild(document.createTextNode(s))}function zme(t){var s=document.head||document.getElementsByTagName("head")[0];s.appendChild(t)}var Ume=function(){var t=0,s=null;return{add:function(n){t==0&&(s=Fme())&&($me(s,n),zme(s)),t++},remove:function(){t--,!t&&s&&(s.parentNode&&s.parentNode.removeChild(s),s=null)}}},Vme=function(){var t=Ume();return function(s,n){y.useEffect(function(){return t.add(s),function(){t.remove()}},[s&&n])}},eF=function(){var t=Vme(),s=function(n){var a=n.styles,i=n.dynamic;return t(a,i),null};return s},Hme={left:0,top:0,right:0,gap:0},qN=function(t){return parseInt(t||"",10)||0},Wme=function(t){var s=window.getComputedStyle(document.body),n=s[t==="padding"?"paddingLeft":"marginLeft"],a=s[t==="padding"?"paddingTop":"marginTop"],i=s[t==="padding"?"paddingRight":"marginRight"];return[qN(n),qN(a),qN(i)]},qme=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return Hme;var s=Wme(t),n=document.documentElement.clientWidth,a=window.innerWidth;return{left:s[0],top:s[1],right:s[2],gap:Math.max(0,a-n+s[2]-s[0])}},Gme=eF(),Rh="data-scroll-locked",Kme=function(t,s,n,a){var i=t.left,l=t.top,o=t.right,c=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(Eme,` {
   overflow: hidden `).concat(a,`;
   padding-right: `).concat(c,"px ").concat(a,`;
  }
  body[`).concat(Rh,`] {
    overflow: hidden `).concat(a,`;
    overscroll-behavior: contain;
    `).concat([s&&"position: relative ".concat(a,";"),n==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(l,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(c,"px ").concat(a,`;
    `),n==="padding"&&"padding-right: ".concat(c,"px ").concat(a,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(zg,` {
    right: `).concat(c,"px ").concat(a,`;
  }
  
  .`).concat(Ug,` {
    margin-right: `).concat(c,"px ").concat(a,`;
  }
  
  .`).concat(zg," .").concat(zg,` {
    right: 0 `).concat(a,`;
  }
  
  .`).concat(Ug," .").concat(Ug,` {
    margin-right: 0 `).concat(a,`;
  }
  
  body[`).concat(Rh,`] {
    `).concat(Tme,": ").concat(c,`px;
  }
`)},fI=function(){var t=parseInt(document.body.getAttribute(Rh)||"0",10);return isFinite(t)?t:0},Yme=function(){y.useEffect(function(){return document.body.setAttribute(Rh,(fI()+1).toString()),function(){var t=fI()-1;t<=0?document.body.removeAttribute(Rh):document.body.setAttribute(Rh,t.toString())}},[])},Xme=function(t){var s=t.noRelative,n=t.noImportant,a=t.gapMode,i=a===void 0?"margin":a;Yme();var l=y.useMemo(function(){return qme(i)},[i]);return y.createElement(Gme,{styles:Kme(l,!s,i,n?"":"!important")})},G_=!1;if(typeof window<"u")try{var O0=Object.defineProperty({},"passive",{get:function(){return G_=!0,!0}});window.addEventListener("test",O0,O0),window.removeEventListener("test",O0,O0)}catch{G_=!1}var Qu=G_?{passive:!1}:!1,Qme=function(t){return t.tagName==="TEXTAREA"},tF=function(t,s){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[s]!=="hidden"&&!(n.overflowY===n.overflowX&&!Qme(t)&&n[s]==="visible")},Zme=function(t){return tF(t,"overflowY")},Jme=function(t){return tF(t,"overflowX")},mI=function(t,s){var n=s.ownerDocument,a=s;do{typeof ShadowRoot<"u"&&a instanceof ShadowRoot&&(a=a.host);var i=sF(t,a);if(i){var l=nF(t,a),o=l[1],c=l[2];if(o>c)return!0}a=a.parentNode}while(a&&a!==n.body);return!1},epe=function(t){var s=t.scrollTop,n=t.scrollHeight,a=t.clientHeight;return[s,n,a]},tpe=function(t){var s=t.scrollLeft,n=t.scrollWidth,a=t.clientWidth;return[s,n,a]},sF=function(t,s){return t==="v"?Zme(s):Jme(s)},nF=function(t,s){return t==="v"?epe(s):tpe(s)},spe=function(t,s){return t==="h"&&s==="rtl"?-1:1},npe=function(t,s,n,a,i){var l=spe(t,window.getComputedStyle(s).direction),o=l*a,c=n.target,d=s.contains(c),u=!1,f=o>0,m=0,x=0;do{if(!c)break;var b=nF(t,c),w=b[0],j=b[1],_=b[2],C=j-_-l*w;(w||C)&&sF(t,c)&&(m+=C,x+=w);var k=c.parentNode;c=k&&k.nodeType===Node.DOCUMENT_FRAGMENT_NODE?k.host:k}while(!d&&c!==document.body||d&&(s.contains(c)||s===c));return(f&&Math.abs(m)<1||!f&&Math.abs(x)<1)&&(u=!0),u},R0=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},pI=function(t){return[t.deltaX,t.deltaY]},xI=function(t){return t&&"current"in t?t.current:t},rpe=function(t,s){return t[0]===s[0]&&t[1]===s[1]},ape=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},ipe=0,Zu=[];function lpe(t){var s=y.useRef([]),n=y.useRef([0,0]),a=y.useRef(),i=y.useState(ipe++)[0],l=y.useState(eF)[0],o=y.useRef(t);y.useEffect(function(){o.current=t},[t]),y.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(i));var j=Ame([t.lockRef.current],(t.shards||[]).map(xI),!0).filter(Boolean);return j.forEach(function(_){return _.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),j.forEach(function(_){return _.classList.remove("allow-interactivity-".concat(i))})}}},[t.inert,t.lockRef.current,t.shards]);var c=y.useCallback(function(j,_){if("touches"in j&&j.touches.length===2||j.type==="wheel"&&j.ctrlKey)return!o.current.allowPinchZoom;var C=R0(j),k=n.current,A="deltaX"in j?j.deltaX:k[0]-C[0],T="deltaY"in j?j.deltaY:k[1]-C[1],P,R=j.target,I=Math.abs(A)>Math.abs(T)?"h":"v";if("touches"in j&&I==="h"&&R.type==="range")return!1;var O=mI(I,R);if(!O)return!0;if(O?P=I:(P=I==="v"?"h":"v",O=mI(I,R)),!O)return!1;if(!a.current&&"changedTouches"in j&&(A||T)&&(a.current=P),!P)return!0;var M=a.current||P;return npe(M,_,j,M==="h"?A:T)},[]),d=y.useCallback(function(j){var _=j;if(!(!Zu.length||Zu[Zu.length-1]!==l)){var C="deltaY"in _?pI(_):R0(_),k=s.current.filter(function(P){return P.name===_.type&&(P.target===_.target||_.target===P.shadowParent)&&rpe(P.delta,C)})[0];if(k&&k.should){_.cancelable&&_.preventDefault();return}if(!k){var A=(o.current.shards||[]).map(xI).filter(Boolean).filter(function(P){return P.contains(_.target)}),T=A.length>0?c(_,A[0]):!o.current.noIsolation;T&&_.cancelable&&_.preventDefault()}}},[]),u=y.useCallback(function(j,_,C,k){var A={name:j,delta:_,target:C,should:k,shadowParent:ope(C)};s.current.push(A),setTimeout(function(){s.current=s.current.filter(function(T){return T!==A})},1)},[]),f=y.useCallback(function(j){n.current=R0(j),a.current=void 0},[]),m=y.useCallback(function(j){u(j.type,pI(j),j.target,c(j,t.lockRef.current))},[]),x=y.useCallback(function(j){u(j.type,R0(j),j.target,c(j,t.lockRef.current))},[]);y.useEffect(function(){return Zu.push(l),t.setCallbacks({onScrollCapture:m,onWheelCapture:m,onTouchMoveCapture:x}),document.addEventListener("wheel",d,Qu),document.addEventListener("touchmove",d,Qu),document.addEventListener("touchstart",f,Qu),function(){Zu=Zu.filter(function(j){return j!==l}),document.removeEventListener("wheel",d,Qu),document.removeEventListener("touchmove",d,Qu),document.removeEventListener("touchstart",f,Qu)}},[]);var b=t.removeScrollBar,w=t.inert;return y.createElement(y.Fragment,null,w?y.createElement(l,{styles:ape(i)}):null,b?y.createElement(Xme,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function ope(t){for(var s=null;t!==null;)t instanceof ShadowRoot&&(s=t.host,t=t.host),t=t.parentNode;return s}const cpe=Lme(JB,lpe);var yk=y.forwardRef(function(t,s){return y.createElement(Gb,Tl({},t,{ref:s,sideCar:cpe}))});yk.classNames=Gb.classNames;var dpe=[" ","Enter","ArrowUp","ArrowDown"],upe=[" ","Enter"],mu="Select",[Kb,Yb,hpe]=wB(mu),[Of]=Mu(mu,[hpe,FB]),Xb=FB(),[fpe,rd]=Of(mu),[mpe,ppe]=Of(mu),rF=t=>{const{__scopeSelect:s,children:n,open:a,defaultOpen:i,onOpenChange:l,value:o,defaultValue:c,onValueChange:d,dir:u,name:f,autoComplete:m,disabled:x,required:b,form:w}=t,j=Xb(s),[_,C]=y.useState(null),[k,A]=y.useState(null),[T,P]=y.useState(!1),R=Ub(u),[I,O]=$p({prop:a,defaultProp:i??!1,onChange:l,caller:mu}),[M,B]=$p({prop:o,defaultProp:c,onChange:d,caller:mu}),L=y.useRef(null),F=_?w||!!_.closest("form"):!0,[V,U]=y.useState(new Set),z=Array.from(V).map(W=>W.props.value).join(";");return r.jsx(mme,{...j,children:r.jsxs(fpe,{required:b,scope:s,trigger:_,onTriggerChange:C,valueNode:k,onValueNodeChange:A,valueNodeHasChildren:T,onValueNodeHasChildrenChange:P,contentId:Ic(),value:M,onValueChange:B,open:I,onOpenChange:O,dir:R,triggerPointerDownPosRef:L,disabled:x,children:[r.jsx(Kb.Provider,{scope:s,children:r.jsx(mpe,{scope:t.__scopeSelect,onNativeOptionAdd:y.useCallback(W=>{U(q=>new Set(q).add(W))},[]),onNativeOptionRemove:y.useCallback(W=>{U(q=>{const G=new Set(q);return G.delete(W),G})},[]),children:n})}),F?r.jsxs(AF,{"aria-hidden":!0,required:b,tabIndex:-1,name:f,autoComplete:m,value:M,onChange:W=>B(W.target.value),disabled:x,form:w,children:[M===void 0?r.jsx("option",{value:""}):null,Array.from(V)]},z):null]})})};rF.displayName=mu;var aF="SelectTrigger",iF=y.forwardRef((t,s)=>{const{__scopeSelect:n,disabled:a=!1,...i}=t,l=Xb(n),o=rd(aF,n),c=o.disabled||a,d=Ss(s,o.onTriggerChange),u=Yb(n),f=y.useRef("touch"),[m,x,b]=TF(j=>{const _=u().filter(A=>!A.disabled),C=_.find(A=>A.value===o.value),k=PF(_,j,C);k!==void 0&&o.onValueChange(k.value)}),w=j=>{c||(o.onOpenChange(!0),b()),j&&(o.triggerPointerDownPosRef.current={x:Math.round(j.pageX),y:Math.round(j.pageY)})};return r.jsx(pme,{asChild:!0,...l,children:r.jsx(Qt.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:c,"data-disabled":c?"":void 0,"data-placeholder":EF(o.value)?"":void 0,...i,ref:d,onClick:Wt(i.onClick,j=>{j.currentTarget.focus(),f.current!=="mouse"&&w(j)}),onPointerDown:Wt(i.onPointerDown,j=>{f.current=j.pointerType;const _=j.target;_.hasPointerCapture(j.pointerId)&&_.releasePointerCapture(j.pointerId),j.button===0&&j.ctrlKey===!1&&j.pointerType==="mouse"&&(w(j),j.preventDefault())}),onKeyDown:Wt(i.onKeyDown,j=>{const _=m.current!=="";!(j.ctrlKey||j.altKey||j.metaKey)&&j.key.length===1&&x(j.key),!(_&&j.key===" ")&&dpe.includes(j.key)&&(w(),j.preventDefault())})})})});iF.displayName=aF;var lF="SelectValue",oF=y.forwardRef((t,s)=>{const{__scopeSelect:n,className:a,style:i,children:l,placeholder:o="",...c}=t,d=rd(lF,n),{onValueNodeHasChildrenChange:u}=d,f=l!==void 0,m=Ss(s,d.onValueNodeChange);return Pr(()=>{u(f)},[u,f]),r.jsx(Qt.span,{...c,ref:m,style:{pointerEvents:"none"},children:EF(d.value)?r.jsx(r.Fragment,{children:o}):l})});oF.displayName=lF;var xpe="SelectIcon",cF=y.forwardRef((t,s)=>{const{__scopeSelect:n,children:a,...i}=t;return r.jsx(Qt.span,{"aria-hidden":!0,...i,ref:s,children:a||""})});cF.displayName=xpe;var gpe="SelectPortal",dF=t=>r.jsx(gk,{asChild:!0,...t});dF.displayName=gpe;var pu="SelectContent",uF=y.forwardRef((t,s)=>{const n=rd(pu,t.__scopeSelect),[a,i]=y.useState();if(Pr(()=>{i(new DocumentFragment)},[]),!n.open){const l=a;return l?td.createPortal(r.jsx(hF,{scope:t.__scopeSelect,children:r.jsx(Kb.Slot,{scope:t.__scopeSelect,children:r.jsx("div",{children:t.children})})}),l):null}return r.jsx(fF,{...t,ref:s})});uF.displayName=pu;var Hi=10,[hF,ad]=Of(pu),ype="SelectContentImpl",bpe=tf("SelectContent.RemoveScroll"),fF=y.forwardRef((t,s)=>{const{__scopeSelect:n,position:a="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:l,onPointerDownOutside:o,side:c,sideOffset:d,align:u,alignOffset:f,arrowPadding:m,collisionBoundary:x,collisionPadding:b,sticky:w,hideWhenDetached:j,avoidCollisions:_,...C}=t,k=rd(pu,n),[A,T]=y.useState(null),[P,R]=y.useState(null),I=Ss(s,oe=>T(oe)),[O,M]=y.useState(null),[B,L]=y.useState(null),F=Yb(n),[V,U]=y.useState(!1),z=y.useRef(!1);y.useEffect(()=>{if(A)return XB(A)},[A]),_B();const W=y.useCallback(oe=>{const[_e,...ce]=F().map(le=>le.ref.current),[he]=ce.slice(-1),fe=document.activeElement;for(const le of oe)if(le===fe||(le==null||le.scrollIntoView({block:"nearest"}),le===_e&&P&&(P.scrollTop=0),le===he&&P&&(P.scrollTop=P.scrollHeight),le==null||le.focus(),document.activeElement!==fe))return},[F,P]),q=y.useCallback(()=>W([O,A]),[W,O,A]);y.useEffect(()=>{V&&q()},[V,q]);const{onOpenChange:G,triggerPointerDownPosRef:se}=k;y.useEffect(()=>{if(A){let oe={x:0,y:0};const _e=he=>{var fe,le;oe={x:Math.abs(Math.round(he.pageX)-(((fe=se.current)==null?void 0:fe.x)??0)),y:Math.abs(Math.round(he.pageY)-(((le=se.current)==null?void 0:le.y)??0))}},ce=he=>{oe.x<=10&&oe.y<=10?he.preventDefault():A.contains(he.target)||G(!1),document.removeEventListener("pointermove",_e),se.current=null};return se.current!==null&&(document.addEventListener("pointermove",_e),document.addEventListener("pointerup",ce,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",_e),document.removeEventListener("pointerup",ce,{capture:!0})}}},[A,G,se]),y.useEffect(()=>{const oe=()=>G(!1);return window.addEventListener("blur",oe),window.addEventListener("resize",oe),()=>{window.removeEventListener("blur",oe),window.removeEventListener("resize",oe)}},[G]);const[ge,ke]=TF(oe=>{const _e=F().filter(fe=>!fe.disabled),ce=_e.find(fe=>fe.ref.current===document.activeElement),he=PF(_e,oe,ce);he&&setTimeout(()=>he.ref.current.focus())}),ee=y.useCallback((oe,_e,ce)=>{const he=!z.current&&!ce;(k.value!==void 0&&k.value===_e||he)&&(M(oe),he&&(z.current=!0))},[k.value]),pe=y.useCallback(()=>A==null?void 0:A.focus(),[A]),ue=y.useCallback((oe,_e,ce)=>{const he=!z.current&&!ce;(k.value!==void 0&&k.value===_e||he)&&L(oe)},[k.value]),ye=a==="popper"?K_:mF,X=ye===K_?{side:c,sideOffset:d,align:u,alignOffset:f,arrowPadding:m,collisionBoundary:x,collisionPadding:b,sticky:w,hideWhenDetached:j,avoidCollisions:_}:{};return r.jsx(hF,{scope:n,content:A,viewport:P,onViewportChange:R,itemRefCallback:ee,selectedItem:O,onItemLeave:pe,itemTextRefCallback:ue,focusSelectedItem:q,selectedItemText:B,position:a,isPositioned:V,searchRef:ge,children:r.jsx(yk,{as:bpe,allowPinchZoom:!0,children:r.jsx(ok,{asChild:!0,trapped:k.open,onMountAutoFocus:oe=>{oe.preventDefault()},onUnmountAutoFocus:Wt(i,oe=>{var _e;(_e=k.trigger)==null||_e.focus({preventScroll:!0}),oe.preventDefault()}),children:r.jsx(lk,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:l,onPointerDownOutside:o,onFocusOutside:oe=>oe.preventDefault(),onDismiss:()=>k.onOpenChange(!1),children:r.jsx(ye,{role:"listbox",id:k.contentId,"data-state":k.open?"open":"closed",dir:k.dir,onContextMenu:oe=>oe.preventDefault(),...C,...X,onPlaced:()=>U(!0),ref:I,style:{display:"flex",flexDirection:"column",outline:"none",...C.style},onKeyDown:Wt(C.onKeyDown,oe=>{const _e=oe.ctrlKey||oe.altKey||oe.metaKey;if(oe.key==="Tab"&&oe.preventDefault(),!_e&&oe.key.length===1&&ke(oe.key),["ArrowUp","ArrowDown","Home","End"].includes(oe.key)){let he=F().filter(fe=>!fe.disabled).map(fe=>fe.ref.current);if(["ArrowUp","End"].includes(oe.key)&&(he=he.slice().reverse()),["ArrowUp","ArrowDown"].includes(oe.key)){const fe=oe.target,le=he.indexOf(fe);he=he.slice(le+1)}setTimeout(()=>W(he)),oe.preventDefault()}})})})})})})});fF.displayName=ype;var vpe="SelectItemAlignedPosition",mF=y.forwardRef((t,s)=>{const{__scopeSelect:n,onPlaced:a,...i}=t,l=rd(pu,n),o=ad(pu,n),[c,d]=y.useState(null),[u,f]=y.useState(null),m=Ss(s,I=>f(I)),x=Yb(n),b=y.useRef(!1),w=y.useRef(!0),{viewport:j,selectedItem:_,selectedItemText:C,focusSelectedItem:k}=o,A=y.useCallback(()=>{if(l.trigger&&l.valueNode&&c&&u&&j&&_&&C){const I=l.trigger.getBoundingClientRect(),O=u.getBoundingClientRect(),M=l.valueNode.getBoundingClientRect(),B=C.getBoundingClientRect();if(l.dir!=="rtl"){const fe=B.left-O.left,le=M.left-fe,Ve=I.left-le,Ke=I.width+Ve,wt=Math.max(Ke,O.width),mt=window.innerWidth-Hi,rt=U_(le,[Hi,Math.max(Hi,mt-wt)]);c.style.minWidth=Ke+"px",c.style.left=rt+"px"}else{const fe=O.right-B.right,le=window.innerWidth-M.right-fe,Ve=window.innerWidth-I.right-le,Ke=I.width+Ve,wt=Math.max(Ke,O.width),mt=window.innerWidth-Hi,rt=U_(le,[Hi,Math.max(Hi,mt-wt)]);c.style.minWidth=Ke+"px",c.style.right=rt+"px"}const L=x(),F=window.innerHeight-Hi*2,V=j.scrollHeight,U=window.getComputedStyle(u),z=parseInt(U.borderTopWidth,10),W=parseInt(U.paddingTop,10),q=parseInt(U.borderBottomWidth,10),G=parseInt(U.paddingBottom,10),se=z+W+V+G+q,ge=Math.min(_.offsetHeight*5,se),ke=window.getComputedStyle(j),ee=parseInt(ke.paddingTop,10),pe=parseInt(ke.paddingBottom,10),ue=I.top+I.height/2-Hi,ye=F-ue,X=_.offsetHeight/2,oe=_.offsetTop+X,_e=z+W+oe,ce=se-_e;if(_e<=ue){const fe=L.length>0&&_===L[L.length-1].ref.current;c.style.bottom="0px";const le=u.clientHeight-j.offsetTop-j.offsetHeight,Ve=Math.max(ye,X+(fe?pe:0)+le+q),Ke=_e+Ve;c.style.height=Ke+"px"}else{const fe=L.length>0&&_===L[0].ref.current;c.style.top="0px";const Ve=Math.max(ue,z+j.offsetTop+(fe?ee:0)+X)+ce;c.style.height=Ve+"px",j.scrollTop=_e-ue+j.offsetTop}c.style.margin=`${Hi}px 0`,c.style.minHeight=ge+"px",c.style.maxHeight=F+"px",a==null||a(),requestAnimationFrame(()=>b.current=!0)}},[x,l.trigger,l.valueNode,c,u,j,_,C,l.dir,a]);Pr(()=>A(),[A]);const[T,P]=y.useState();Pr(()=>{u&&P(window.getComputedStyle(u).zIndex)},[u]);const R=y.useCallback(I=>{I&&w.current===!0&&(A(),k==null||k(),w.current=!1)},[A,k]);return r.jsx(Npe,{scope:n,contentWrapper:c,shouldExpandOnScrollRef:b,onScrollButtonChange:R,children:r.jsx("div",{ref:d,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:T},children:r.jsx(Qt.div,{...i,ref:m,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});mF.displayName=vpe;var wpe="SelectPopperPosition",K_=y.forwardRef((t,s)=>{const{__scopeSelect:n,align:a="start",collisionPadding:i=Hi,...l}=t,o=Xb(n);return r.jsx(xme,{...o,...l,ref:s,align:a,collisionPadding:i,style:{boxSizing:"border-box",...l.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});K_.displayName=wpe;var[Npe,bk]=Of(pu,{}),Y_="SelectViewport",pF=y.forwardRef((t,s)=>{const{__scopeSelect:n,nonce:a,...i}=t,l=ad(Y_,n),o=bk(Y_,n),c=Ss(s,l.onViewportChange),d=y.useRef(0);return r.jsxs(r.Fragment,{children:[r.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),r.jsx(Kb.Slot,{scope:n,children:r.jsx(Qt.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:c,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:Wt(i.onScroll,u=>{const f=u.currentTarget,{contentWrapper:m,shouldExpandOnScrollRef:x}=o;if(x!=null&&x.current&&m){const b=Math.abs(d.current-f.scrollTop);if(b>0){const w=window.innerHeight-Hi*2,j=parseFloat(m.style.minHeight),_=parseFloat(m.style.height),C=Math.max(j,_);if(C<w){const k=C+b,A=Math.min(w,k),T=k-A;m.style.height=A+"px",m.style.bottom==="0px"&&(f.scrollTop=T>0?T:0,m.style.justifyContent="flex-end")}}}d.current=f.scrollTop})})})]})});pF.displayName=Y_;var xF="SelectGroup",[jpe,_pe]=Of(xF),Spe=y.forwardRef((t,s)=>{const{__scopeSelect:n,...a}=t,i=Ic();return r.jsx(jpe,{scope:n,id:i,children:r.jsx(Qt.div,{role:"group","aria-labelledby":i,...a,ref:s})})});Spe.displayName=xF;var gF="SelectLabel",yF=y.forwardRef((t,s)=>{const{__scopeSelect:n,...a}=t,i=_pe(gF,n);return r.jsx(Qt.div,{id:i.id,...a,ref:s})});yF.displayName=gF;var qy="SelectItem",[Cpe,bF]=Of(qy),vF=y.forwardRef((t,s)=>{const{__scopeSelect:n,value:a,disabled:i=!1,textValue:l,...o}=t,c=rd(qy,n),d=ad(qy,n),u=c.value===a,[f,m]=y.useState(l??""),[x,b]=y.useState(!1),w=Ss(s,k=>{var A;return(A=d.itemRefCallback)==null?void 0:A.call(d,k,a,i)}),j=Ic(),_=y.useRef("touch"),C=()=>{i||(c.onValueChange(a),c.onOpenChange(!1))};if(a==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return r.jsx(Cpe,{scope:n,value:a,disabled:i,textId:j,isSelected:u,onItemTextChange:y.useCallback(k=>{m(A=>A||((k==null?void 0:k.textContent)??"").trim())},[]),children:r.jsx(Kb.ItemSlot,{scope:n,value:a,disabled:i,textValue:f,children:r.jsx(Qt.div,{role:"option","aria-labelledby":j,"data-highlighted":x?"":void 0,"aria-selected":u&&x,"data-state":u?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...o,ref:w,onFocus:Wt(o.onFocus,()=>b(!0)),onBlur:Wt(o.onBlur,()=>b(!1)),onClick:Wt(o.onClick,()=>{_.current!=="mouse"&&C()}),onPointerUp:Wt(o.onPointerUp,()=>{_.current==="mouse"&&C()}),onPointerDown:Wt(o.onPointerDown,k=>{_.current=k.pointerType}),onPointerMove:Wt(o.onPointerMove,k=>{var A;_.current=k.pointerType,i?(A=d.onItemLeave)==null||A.call(d):_.current==="mouse"&&k.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Wt(o.onPointerLeave,k=>{var A;k.currentTarget===document.activeElement&&((A=d.onItemLeave)==null||A.call(d))}),onKeyDown:Wt(o.onKeyDown,k=>{var T;((T=d.searchRef)==null?void 0:T.current)!==""&&k.key===" "||(upe.includes(k.key)&&C(),k.key===" "&&k.preventDefault())})})})})});vF.displayName=qy;var Bm="SelectItemText",wF=y.forwardRef((t,s)=>{const{__scopeSelect:n,className:a,style:i,...l}=t,o=rd(Bm,n),c=ad(Bm,n),d=bF(Bm,n),u=ppe(Bm,n),[f,m]=y.useState(null),x=Ss(s,C=>m(C),d.onItemTextChange,C=>{var k;return(k=c.itemTextRefCallback)==null?void 0:k.call(c,C,d.value,d.disabled)}),b=f==null?void 0:f.textContent,w=y.useMemo(()=>r.jsx("option",{value:d.value,disabled:d.disabled,children:b},d.value),[d.disabled,d.value,b]),{onNativeOptionAdd:j,onNativeOptionRemove:_}=u;return Pr(()=>(j(w),()=>_(w)),[j,_,w]),r.jsxs(r.Fragment,{children:[r.jsx(Qt.span,{id:d.textId,...l,ref:x}),d.isSelected&&o.valueNode&&!o.valueNodeHasChildren?td.createPortal(l.children,o.valueNode):null]})});wF.displayName=Bm;var NF="SelectItemIndicator",jF=y.forwardRef((t,s)=>{const{__scopeSelect:n,...a}=t;return bF(NF,n).isSelected?r.jsx(Qt.span,{"aria-hidden":!0,...a,ref:s}):null});jF.displayName=NF;var X_="SelectScrollUpButton",_F=y.forwardRef((t,s)=>{const n=ad(X_,t.__scopeSelect),a=bk(X_,t.__scopeSelect),[i,l]=y.useState(!1),o=Ss(s,a.onScrollButtonChange);return Pr(()=>{if(n.viewport&&n.isPositioned){let c=function(){const u=d.scrollTop>0;l(u)};const d=n.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),i?r.jsx(CF,{...t,ref:o,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=n;c&&d&&(c.scrollTop=c.scrollTop-d.offsetHeight)}}):null});_F.displayName=X_;var Q_="SelectScrollDownButton",SF=y.forwardRef((t,s)=>{const n=ad(Q_,t.__scopeSelect),a=bk(Q_,t.__scopeSelect),[i,l]=y.useState(!1),o=Ss(s,a.onScrollButtonChange);return Pr(()=>{if(n.viewport&&n.isPositioned){let c=function(){const u=d.scrollHeight-d.clientHeight,f=Math.ceil(d.scrollTop)<u;l(f)};const d=n.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),i?r.jsx(CF,{...t,ref:o,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=n;c&&d&&(c.scrollTop=c.scrollTop+d.offsetHeight)}}):null});SF.displayName=Q_;var CF=y.forwardRef((t,s)=>{const{__scopeSelect:n,onAutoScroll:a,...i}=t,l=ad("SelectScrollButton",n),o=y.useRef(null),c=Yb(n),d=y.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return y.useEffect(()=>()=>d(),[d]),Pr(()=>{var f;const u=c().find(m=>m.ref.current===document.activeElement);(f=u==null?void 0:u.ref.current)==null||f.scrollIntoView({block:"nearest"})},[c]),r.jsx(Qt.div,{"aria-hidden":!0,...i,ref:s,style:{flexShrink:0,...i.style},onPointerDown:Wt(i.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(a,50))}),onPointerMove:Wt(i.onPointerMove,()=>{var u;(u=l.onItemLeave)==null||u.call(l),o.current===null&&(o.current=window.setInterval(a,50))}),onPointerLeave:Wt(i.onPointerLeave,()=>{d()})})}),kpe="SelectSeparator",kF=y.forwardRef((t,s)=>{const{__scopeSelect:n,...a}=t;return r.jsx(Qt.div,{"aria-hidden":!0,...a,ref:s})});kF.displayName=kpe;var Z_="SelectArrow",Ape=y.forwardRef((t,s)=>{const{__scopeSelect:n,...a}=t,i=Xb(n),l=rd(Z_,n),o=ad(Z_,n);return l.open&&o.position==="popper"?r.jsx(gme,{...i,...a,ref:s}):null});Ape.displayName=Z_;var Epe="SelectBubbleInput",AF=y.forwardRef(({__scopeSelect:t,value:s,...n},a)=>{const i=y.useRef(null),l=Ss(a,i),o=Nme(s);return y.useEffect(()=>{const c=i.current;if(!c)return;const d=window.HTMLSelectElement.prototype,f=Object.getOwnPropertyDescriptor(d,"value").set;if(o!==s&&f){const m=new Event("change",{bubbles:!0});f.call(c,s),c.dispatchEvent(m)}},[o,s]),r.jsx(Qt.select,{...n,style:{...KB,...n.style},ref:l,defaultValue:s})});AF.displayName=Epe;function EF(t){return t===""||t===void 0}function TF(t){const s=ea(t),n=y.useRef(""),a=y.useRef(0),i=y.useCallback(o=>{const c=n.current+o;s(c),function d(u){n.current=u,window.clearTimeout(a.current),u!==""&&(a.current=window.setTimeout(()=>d(""),1e3))}(c)},[s]),l=y.useCallback(()=>{n.current="",window.clearTimeout(a.current)},[]);return y.useEffect(()=>()=>window.clearTimeout(a.current),[]),[n,i,l]}function PF(t,s,n){const i=s.length>1&&Array.from(s).every(u=>u===s[0])?s[0]:s,l=n?t.indexOf(n):-1;let o=Tpe(t,Math.max(l,0));i.length===1&&(o=o.filter(u=>u!==n));const d=o.find(u=>u.textValue.toLowerCase().startsWith(i.toLowerCase()));return d!==n?d:void 0}function Tpe(t,s){return t.map((n,a)=>t[(s+a)%t.length])}var Ppe=rF,IF=iF,Ipe=oF,Mpe=cF,Dpe=dF,MF=uF,Ope=pF,DF=yF,OF=vF,Rpe=wF,Lpe=jF,RF=_F,LF=SF,BF=kF;const Ms=Ppe,Ds=Ipe,Es=y.forwardRef(({className:t,children:s,...n},a)=>r.jsxs(IF,{ref:a,className:Pt("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[s,r.jsx(Mpe,{asChild:!0,children:r.jsx(v3,{className:"h-4 w-4 opacity-50"})})]}));Es.displayName=IF.displayName;const FF=y.forwardRef(({className:t,...s},n)=>r.jsx(RF,{ref:n,className:Pt("flex cursor-default items-center justify-center py-1",t),...s,children:r.jsx(Rte,{className:"h-4 w-4"})}));FF.displayName=RF.displayName;const $F=y.forwardRef(({className:t,...s},n)=>r.jsx(LF,{ref:n,className:Pt("flex cursor-default items-center justify-center py-1",t),...s,children:r.jsx(v3,{className:"h-4 w-4"})}));$F.displayName=LF.displayName;const Ts=y.forwardRef(({className:t,children:s,position:n="popper",...a},i)=>r.jsx(Dpe,{children:r.jsxs(MF,{ref:i,className:Pt("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...a,children:[r.jsx(FF,{}),r.jsx(Ope,{className:Pt("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),r.jsx($F,{})]})}));Ts.displayName=MF.displayName;const Bpe=y.forwardRef(({className:t,...s},n)=>r.jsx(DF,{ref:n,className:Pt("px-2 py-1.5 text-sm font-semibold",t),...s}));Bpe.displayName=DF.displayName;const Mt=y.forwardRef(({className:t,children:s,...n},a)=>r.jsxs(OF,{ref:a,className:Pt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[r.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:r.jsx(Lpe,{children:r.jsx(b3,{className:"h-4 w-4"})})}),r.jsx(Rpe,{children:s})]}));Mt.displayName=OF.displayName;const Fpe=y.forwardRef(({className:t,...s},n)=>r.jsx(BF,{ref:n,className:Pt("-mx-1 my-1 h-px bg-muted",t),...s}));Fpe.displayName=BF.displayName;const L0=t=>t?t.length===16?`${t}:00`:t:null;function $pe({admissionId:t,canWrite:s}){const[n,a]=y.useState("pain"),[i,l]=y.useState(!1),[o,c]=y.useState(""),[d,u]=y.useState([]),[f,m]=y.useState([]),[x,b]=y.useState([]),[w,j]=y.useState([]),[_,C]=y.useState({recorded_at:"",scale_type:"",score:"",location:"",character:"",intervention:"",post_intervention_score:""}),[k,A]=y.useState({recorded_at:"",tool:"",score:"",risk_level:"",precautions:""}),[T,P]=y.useState({recorded_at:"",tool:"",score:"",risk_level:"",existing_ulcer:!1,site:"",stage:"",management_plan:""}),[R,I]=y.useState({recorded_at:"",bmi:"",weight_kg:"",height_cm:"",screening_tool:"",score:"",risk_level:"",dietician_referral:!1}),O=async()=>{var U,z;if(t){l(!0),c("");try{const[W,q,G,se]=await Promise.all([bde(t),wde(t),jde(t),Sde(t)]);u(W.data||[]),m(q.data||[]),b(G.data||[]),j(se.data||[])}catch(W){c(((z=(U=W==null?void 0:W.response)==null?void 0:U.data)==null?void 0:z.detail)||"Failed to load assessments")}finally{l(!1)}}};y.useEffect(()=>{O()},[t]);const M=async U=>{var z,W;if(U.preventDefault(),!(!s||!t))try{const q={recorded_at:L0(_.recorded_at),scale_type:_.scale_type||"",score:_.score!==""?Number(_.score):null,location:_.location||"",character:_.character||"",intervention:_.intervention||"",post_intervention_score:_.post_intervention_score!==""?Number(_.post_intervention_score):null};await vde(t,q),C({recorded_at:"",scale_type:"",score:"",location:"",character:"",intervention:"",post_intervention_score:""}),await O()}catch(q){alert(((W=(z=q==null?void 0:q.response)==null?void 0:z.data)==null?void 0:W.detail)||"Failed to add pain assessment")}},B=async U=>{var z,W;if(U.preventDefault(),!(!s||!t))try{const q={recorded_at:L0(k.recorded_at),tool:k.tool||"",score:k.score!==""?Number(k.score):null,risk_level:k.risk_level||"",precautions:k.precautions||""};await Nde(t,q),A({recorded_at:"",tool:"",score:"",risk_level:"",precautions:""}),await O()}catch(q){alert(((W=(z=q==null?void 0:q.response)==null?void 0:z.data)==null?void 0:W.detail)||"Failed to add fall risk assessment")}},L=async U=>{var z,W;if(U.preventDefault(),!(!s||!t))try{const q={recorded_at:L0(T.recorded_at),tool:T.tool||"",score:T.score!==""?Number(T.score):null,risk_level:T.risk_level||"",existing_ulcer:!!T.existing_ulcer,site:T.site||"",stage:T.stage||"",management_plan:T.management_plan||""};await _de(t,q),P({recorded_at:"",tool:"",score:"",risk_level:"",existing_ulcer:!1,site:"",stage:"",management_plan:""}),await O()}catch(q){alert(((W=(z=q==null?void 0:q.response)==null?void 0:z.data)==null?void 0:W.detail)||"Failed to add pressure-ulcer assessment")}},F=async U=>{var z,W;if(U.preventDefault(),!(!s||!t))try{const q={recorded_at:L0(R.recorded_at),bmi:R.bmi!==""?Number(R.bmi):null,weight_kg:R.weight_kg!==""?Number(R.weight_kg):null,height_cm:R.height_cm!==""?Number(R.height_cm):null,screening_tool:R.screening_tool||"",score:R.score!==""?Number(R.score):null,risk_level:R.risk_level||"",dietician_referral:!!R.dietician_referral};await Cde(t,q),I({recorded_at:"",bmi:"",weight_kg:"",height_cm:"",screening_tool:"",score:"",risk_level:"",dietician_referral:!1}),await O()}catch(q){alert(((W=(z=q==null?void 0:q.response)==null?void 0:z.data)==null?void 0:W.detail)||"Failed to add nutrition assessment")}},V=[{key:"pain",label:"Pain"},{key:"fall",label:"Fall Risk"},{key:"pressure",label:"Pressure Ulcer"},{key:"nutrition",label:"Nutrition"}];return r.jsxs("div",{className:"space-y-4 text-sm text-black",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsx("h2",{className:"font-semibold",children:"Risk & Clinical Assessments"})}),o&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:o}),r.jsx("div",{className:"flex flex-wrap gap-2",children:V.map(U=>r.jsx("button",{type:"button",onClick:()=>a(U.key),className:["rounded-full px-3 py-1 text-xs md:text-sm border",n===U.key?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-200 hover:bg-slate-50"].join(" "),children:U.label},U.key))}),i&&r.jsx("div",{className:"text-xs text-gray-500",children:"Loading assessments"}),n==="pain"&&r.jsxs("section",{className:"space-y-3",children:[s&&r.jsxs("form",{onSubmit:M,className:"rounded-xl border bg-gray-50 p-3 space-y-3",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Recorded at"}),r.jsx("input",{type:"datetime-local",className:"input",value:_.recorded_at,onChange:U=>C(z=>({...z,recorded_at:U.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Scale"}),r.jsx("input",{className:"input",placeholder:"NRS / VAS / Wong-Baker",value:_.scale_type,onChange:U=>C(z=>({...z,scale_type:U.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Score"}),r.jsx("input",{className:"input",type:"number",min:"0",max:"10",value:_.score,onChange:U=>C(z=>({...z,score:U.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Location"}),r.jsx("input",{className:"input",placeholder:"Site",value:_.location,onChange:U=>C(z=>({...z,location:U.target.value}))})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Character"}),r.jsx("input",{className:"input",placeholder:"sharp / dull / throbbing",value:_.character,onChange:U=>C(z=>({...z,character:U.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Post-intervention score"}),r.jsx("input",{className:"input",type:"number",min:"0",max:"10",value:_.post_intervention_score,onChange:U=>C(z=>({...z,post_intervention_score:U.target.value}))})]})]}),r.jsx("textarea",{className:"input min-h-[70px]",placeholder:"Interventions / remarks",value:_.intervention,onChange:U=>C(z=>({...z,intervention:U.target.value}))}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{className:"btn",children:"Save pain assessment"})})]}),r.jsx("div",{className:"rounded-xl border bg-white overflow-hidden",children:r.jsxs("table",{className:"w-full text-xs md:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 text-gray-500 text-[11px] md:text-xs",children:[r.jsx("th",{className:"px-2 md:px-3 py-2",children:"When"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Scale"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Score"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Location / Character"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Intervention"})]})}),r.jsxs("tbody",{children:[d.map(U=>r.jsxs("tr",{className:"border-t align-top",children:[r.jsx("td",{className:"px-2 md:px-3 py-2",children:U.recorded_at?new Date(U.recorded_at).toLocaleString():""}),r.jsx("td",{className:"px-2 md:px-3 py-2",children:U.scale_type||""}),r.jsx("td",{className:"px-2 md:px-3 py-2",children:U.score??""}),r.jsxs("td",{className:"px-2 md:px-3 py-2 whitespace-pre-wrap",children:[U.location||"",U.character?` (${U.character})`:""]}),r.jsx("td",{className:"px-2 md:px-3 py-2 whitespace-pre-wrap",children:U.intervention||""})]},U.id)),!d.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-3 py-3 text-gray-500 text-xs",children:"No pain assessments recorded."})})]})]})})]}),n==="fall"&&r.jsxs("section",{className:"space-y-3",children:[s&&r.jsxs("form",{onSubmit:B,className:"rounded-xl border bg-gray-50 p-3 space-y-3",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Recorded at"}),r.jsx("input",{type:"datetime-local",className:"input",value:k.recorded_at,onChange:U=>A(z=>({...z,recorded_at:U.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Tool"}),r.jsx("input",{className:"input",placeholder:"Morse, etc.",value:k.tool,onChange:U=>A(z=>({...z,tool:U.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Score"}),r.jsx("input",{className:"input",type:"number",value:k.score,onChange:U=>A(z=>({...z,score:U.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Risk level"}),r.jsx("input",{className:"input",placeholder:"low / moderate / high",value:k.risk_level,onChange:U=>A(z=>({...z,risk_level:U.target.value}))})]})]}),r.jsx("textarea",{className:"input min-h-[70px]",placeholder:"Precautions / instructions",value:k.precautions,onChange:U=>A(z=>({...z,precautions:U.target.value}))}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{className:"btn",children:"Save fall risk assessment"})})]}),r.jsx("div",{className:"rounded-xl border bg-white overflow-hidden",children:r.jsxs("table",{className:"w-full text-xs md:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 text-gray-500 text-[11px] md:text-xs",children:[r.jsx("th",{className:"px-2 md:px-3 py-2",children:"When"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Tool"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Score"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Risk"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Precautions"})]})}),r.jsxs("tbody",{children:[f.map(U=>r.jsxs("tr",{className:"border-t align-top",children:[r.jsx("td",{className:"px-2 md:px-3 py-2",children:U.recorded_at?new Date(U.recorded_at).toLocaleString():""}),r.jsx("td",{className:"px-2 md:px-3 py-2",children:U.tool||""}),r.jsx("td",{className:"px-2 md:px-3 py-2",children:U.score??""}),r.jsx("td",{className:"px-2 md:px-3 py-2",children:U.risk_level||""}),r.jsx("td",{className:"px-2 md:px-3 py-2 whitespace-pre-wrap",children:U.precautions||""})]},U.id)),!f.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-3 py-3 text-gray-500 text-xs",children:"No fall risk assessments recorded."})})]})]})})]}),n==="pressure"&&r.jsxs("section",{className:"space-y-3",children:[s&&r.jsxs("form",{onSubmit:L,className:"rounded-xl border bg-gray-50 p-3 space-y-3",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Recorded at"}),r.jsx("input",{type:"datetime-local",className:"input",value:T.recorded_at,onChange:U=>P(z=>({...z,recorded_at:U.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Tool"}),r.jsx("input",{className:"input",placeholder:"Braden, etc.",value:T.tool,onChange:U=>P(z=>({...z,tool:U.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Score"}),r.jsx("input",{className:"input",type:"number",value:T.score,onChange:U=>P(z=>({...z,score:U.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Risk level"}),r.jsx("input",{className:"input",placeholder:"low / moderate / high",value:T.risk_level,onChange:U=>P(z=>({...z,risk_level:U.target.value}))})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-700",children:[r.jsx("input",{type:"checkbox",className:"h-3 w-3",checked:!!T.existing_ulcer,onChange:U=>P(z=>({...z,existing_ulcer:U.target.checked}))}),"Existing ulcer"]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Site"}),r.jsx("input",{className:"input",value:T.site,onChange:U=>P(z=>({...z,site:U.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Stage"}),r.jsx("input",{className:"input",placeholder:"Stage IIV",value:T.stage,onChange:U=>P(z=>({...z,stage:U.target.value}))})]})]}),r.jsx("textarea",{className:"input min-h-[70px]",placeholder:"Management plan",value:T.management_plan,onChange:U=>P(z=>({...z,management_plan:U.target.value}))}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{className:"btn",children:"Save pressure-ulcer assessment"})})]}),r.jsx("div",{className:"rounded-xl border bg-white overflow-hidden",children:r.jsxs("table",{className:"w-full text-xs md:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 text-gray-500 text-[11px] md:text-xs",children:[r.jsx("th",{className:"px-2 md:px-3 py-2",children:"When"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Tool"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Score"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Risk / Site / Stage"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Management plan"})]})}),r.jsxs("tbody",{children:[x.map(U=>r.jsxs("tr",{className:"border-t align-top",children:[r.jsx("td",{className:"px-2 md:px-3 py-2",children:U.recorded_at?new Date(U.recorded_at).toLocaleString():""}),r.jsx("td",{className:"px-2 md:px-3 py-2",children:U.tool||""}),r.jsx("td",{className:"px-2 md:px-3 py-2",children:U.score??""}),r.jsxs("td",{className:"px-2 md:px-3 py-2 whitespace-pre-wrap",children:[U.risk_level||"",U.site?`  ${U.site}`:"",U.stage?` (Stage ${U.stage})`:"",U.existing_ulcer?"  Existing":""]}),r.jsx("td",{className:"px-2 md:px-3 py-2 whitespace-pre-wrap",children:U.management_plan||""})]},U.id)),!x.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-3 py-3 text-gray-500 text-xs",children:"No pressure-ulcer assessments recorded."})})]})]})})]}),n==="nutrition"&&r.jsxs("section",{className:"space-y-3",children:[s&&r.jsxs("form",{onSubmit:F,className:"rounded-xl border bg-gray-50 p-3 space-y-3",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Recorded at"}),r.jsx("input",{type:"datetime-local",className:"input",value:R.recorded_at,onChange:U=>I(z=>({...z,recorded_at:U.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"BMI"}),r.jsx("input",{className:"input",type:"number",step:"0.1",value:R.bmi,onChange:U=>I(z=>({...z,bmi:U.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Weight (kg)"}),r.jsx("input",{className:"input",type:"number",step:"0.1",value:R.weight_kg,onChange:U=>I(z=>({...z,weight_kg:U.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Height (cm)"}),r.jsx("input",{className:"input",type:"number",step:"0.1",value:R.height_cm,onChange:U=>I(z=>({...z,height_cm:U.target.value}))})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Screening tool"}),r.jsx("input",{className:"input",placeholder:"MUST, etc.",value:R.screening_tool,onChange:U=>I(z=>({...z,screening_tool:U.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Score"}),r.jsx("input",{className:"input",type:"number",value:R.score,onChange:U=>I(z=>({...z,score:U.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Risk level"}),r.jsx("input",{className:"input",placeholder:"low / moderate / high",value:R.risk_level,onChange:U=>I(z=>({...z,risk_level:U.target.value}))})]})]}),r.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-700",children:[r.jsx("input",{type:"checkbox",className:"h-3 w-3",checked:!!R.dietician_referral,onChange:U=>I(z=>({...z,dietician_referral:U.target.checked}))}),"Dietician referral required"]}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{className:"btn",children:"Save nutrition assessment"})})]}),r.jsx("div",{className:"rounded-xl border bg-white overflow-hidden",children:r.jsxs("table",{className:"w-full text-xs md:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 text-gray-500 text-[11px] md:text-xs",children:[r.jsx("th",{className:"px-2 md:px-3 py-2",children:"When"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"BMI"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Wt / Ht"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Tool / Score / Risk"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Dietician referral"})]})}),r.jsxs("tbody",{children:[w.map(U=>r.jsxs("tr",{className:"border-t align-top",children:[r.jsx("td",{className:"px-2 md:px-3 py-2",children:U.recorded_at?new Date(U.recorded_at).toLocaleString():""}),r.jsx("td",{className:"px-2 md:px-3 py-2",children:U.bmi!=null?String(U.bmi):""}),r.jsxs("td",{className:"px-2 md:px-3 py-2",children:[U.weight_kg!=null?`${U.weight_kg} kg`:"",U.height_cm!=null?` / ${U.height_cm} cm`:""]}),r.jsxs("td",{className:"px-2 md:px-3 py-2 whitespace-pre-wrap",children:[U.screening_tool||"",U.score!=null?`  Score ${U.score}`:"",U.risk_level?`  ${U.risk_level}`:""]}),r.jsx("td",{className:"px-2 md:px-3 py-2",children:U.dietician_referral?"Yes":"No"})]},U.id)),!w.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-3 py-3 text-gray-500 text-xs",children:"No nutrition assessments recorded."})})]})]})})]})]})}const zpe=["po","iv","im","sc","topical","nebulisation"],Upe=["od","bd","tds","qid","stat","prn"],Vpe=["mg","g","ml","units","drops","puffs","tab","cap","sachet"],gI=[{value:"regular",label:"Regular"},{value:"sos",label:"SOS"},{value:"stat_premed",label:"STAT / Premed"}];function Hpe({admissionId:t,canWrite:s=!0}){const[n,a]=y.useState(!1),[i,l]=y.useState(!1),[o,c]=y.useState({allergies:"",diagnosis:"",weight_kg:"",height_cm:"",blood_group:"",bsa:"",bmi:"",diet_oral_fluid_per_day:"",diet_salt_gm_per_day:"",diet_calorie_per_day:"",diet_protein_gm_per_day:"",diet_remarks:""}),[d,u]=y.useState([]),[f,m]=y.useState({date:"",fluid:"",additive:"",dose:"",rate_ml_per_hr:"",start_time:"",stop_time:"",remarks:""}),[x,b]=y.useState(!1),[w,j]=y.useState([]),[_,C]=y.useState({name:"",specimen:"",emp_no:""}),[k,A]=y.useState(!1),[T,P]=y.useState([]),[R,I]=y.useState({date:"",remarks:""}),[O,M]=y.useState(!1),[B,L]=y.useState([]),[F,V]=y.useState(""),[U,z]=y.useState(!1),[W,q]=y.useState(!1),[G,se]=y.useState(!0),[ge,ke]=y.useState("all"),[ee,pe]=y.useState({drug_name:"",order_type:"regular",route:"iv",frequency:"bd",dose_value:"",dose_unit:"mg",start_date:"",end_date:"",duration_days:"",instructions:""});y.useMemo(()=>Array.isArray(B)&&B.length>0,[B]);const ue=y.useMemo(()=>{let de=B;return G&&(de=de.filter(Pe=>(Pe.order_status||"active")!=="stopped")),ge!=="all"&&(de=de.filter(Pe=>(Pe.order_type||"regular")===ge)),de},[B,G,ge]),ye=de=>{if(!de)return"";const Pe=new Date(de);return Number.isNaN(Pe.getTime())?"":Pe.toLocaleDateString()},X=de=>de.dose==null&&!de.dose_unit?"":de.dose==null?de.dose_unit||"":`${de.dose} ${de.dose_unit||""}`.trim(),oe=de=>{const Pe=de||"active";return Pe==="stopped"?"inline-flex rounded-full bg-slate-100 px-2 py-0.5 text-[11px] text-slate-600":Pe==="completed"?"inline-flex rounded-full bg-blue-50 px-2 py-0.5 text-[11px] text-blue-700":"inline-flex rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] text-emerald-700"};y.useEffect(()=>{const de=Number(o.weight_kg),Pe=Number(o.height_cm);if(!de||!Pe||Number.isNaN(de)||Number.isNaN(Pe)){c(Dt=>({...Dt,bmi:""}));return}const Ue=Pe/100;if(!Ue){c(Dt=>({...Dt,bmi:""}));return}const Le=de/(Ue*Ue);c(Dt=>({...Dt,bmi:Le.toFixed(1)}))},[o.weight_kg,o.height_cm]);const _e=async()=>{if(t)try{const{data:de}=await Tde(t);de&&c({allergies:de.allergies||"",diagnosis:de.diagnosis||"",weight_kg:de.weight_kg??"",height_cm:de.height_cm??"",blood_group:de.blood_group||"",bsa:de.bsa??"",bmi:de.bmi??"",diet_oral_fluid_per_day:de.diet_oral_fluid_per_day??"",diet_salt_gm_per_day:de.diet_salt_gm_per_day??"",diet_calorie_per_day:de.diet_calorie_per_day??"",diet_protein_gm_per_day:de.diet_protein_gm_per_day??"",diet_remarks:de.diet_remarks||""})}catch(de){const Pe=Ma(de,"Failed to load medications");ie.error(Pe)}},ce=async()=>{if(t)try{const{data:de}=await Ide(t);u(Array.isArray(de)?de:[])}catch(de){const Pe=Ma(de,"Failed to load medications");ie.error(Pe)}},he=async()=>{if(t)try{const{data:de}=await Ode(t);j(Array.isArray(de)?de:[])}catch{}},fe=async()=>{if(t)try{const{data:de}=await Bde(t);P(Array.isArray(de)?de:[])}catch(de){const Pe=Ma(de,"Failed to load medications");ie.error(Pe)}},le=async()=>{if(t){z(!0),V("");try{const{data:de}=await kde(t);L(Array.isArray(de)?de:[])}catch(de){const Pe=Ma(de,"Failed to load medications");V(Pe),ie.error(Pe)}finally{z(!1)}}},Ve=async()=>{t&&(a(!0),await Promise.all([_e(),ce(),he(),fe(),le()]),a(!1))};y.useEffect(()=>{Ve()},[t]);const Ke=de=>Pe=>{const Ue=Pe.target.value;c(Le=>({...Le,[de]:Ue}))},wt=async()=>{if(t)try{const de={allergies:o.allergies||"",diagnosis:o.diagnosis||"",weight_kg:o.weight_kg!==""&&!Number.isNaN(Number(o.weight_kg))?Number(o.weight_kg):mt(o.weight_kg),height_cm:o.height_cm!==""&&!Number.isNaN(Number(o.height_cm))?Number(o.height_cm):mt(o.height_cm),blood_group:o.blood_group||"",bsa:o.bsa!==""&&!Number.isNaN(Number(o.bsa))?Number(o.bsa):mt(o.bsa),bmi:o.bmi!==""&&!Number.isNaN(Number(o.bmi))?Number(o.bmi):mt(o.bmi),diet_oral_fluid_per_day:o.diet_oral_fluid_per_day!==""&&!Number.isNaN(Number(o.diet_oral_fluid_per_day))?Number(o.diet_oral_fluid_per_day):mt(o.diet_oral_fluid_per_day),diet_salt_gm_per_day:o.diet_salt_gm_per_day!==""&&!Number.isNaN(Number(o.diet_salt_gm_per_day))?Number(o.diet_salt_gm_per_day):mt(o.diet_salt_gm_per_day),diet_calorie_per_day:o.diet_calorie_per_day!==""&&!Number.isNaN(Number(o.diet_calorie_per_day))?Number(o.diet_calorie_per_day):mt(o.diet_calorie_per_day),diet_protein_gm_per_day:o.diet_protein_gm_per_day!==""&&!Number.isNaN(Number(o.diet_protein_gm_per_day))?Number(o.diet_protein_gm_per_day):mt(o.diet_protein_gm_per_day),diet_remarks:o.diet_remarks||""};await Pde(t,de),ie.success("Drug chart header details updated")}catch(de){const Pe=Ma(de,"Failed to load medications");ie.error(Pe)}},mt=de=>de===""||de==null?null:de,rt=de=>Pe=>{const Ue=Pe.target.value;m(Le=>({...Le,[de]:Ue}))},bt=async de=>{if(de.preventDefault(),!(!s||!t)){if(!f.fluid.trim()){ie.error("Please enter IV fluid");return}try{b(!0);const Pe={date:f.date||null,fluid:f.fluid.trim(),additive:f.additive||"",dose:f.dose||"",rate_ml_per_hr:f.rate_ml_per_hr&&!Number.isNaN(Number(f.rate_ml_per_hr))?Number(f.rate_ml_per_hr):null,start_time:f.start_time||null,stop_time:f.stop_time||null,remarks:f.remarks||""};await Mde(t,Pe),m({date:"",fluid:"",additive:"",dose:"",rate_ml_per_hr:"",start_time:"",stop_time:"",remarks:""}),await ce(),ie.success("IV fluid order added")}catch(Pe){const Ue=Ma(Pe,"Failed to load medications");ie.error(Ue)}finally{b(!1)}}},be=async de=>{if(!(!s||!window.confirm(`Remove IV fluid "${de.fluid}"?`)))try{await Dde(de.id),await ce(),ie.success("IV fluid deleted")}catch(Ue){const Le=Ma(Ue,"Failed to load medications");ie.error(Le)}},ne=de=>Pe=>{const Ue=Pe.target.value;C(Le=>({...Le,[de]:Ue}))},me=async de=>{if(de.preventDefault(),!(!s||!t)){if(!_.name.trim()){ie.error("Please enter nurse name");return}try{A(!0);const Pe={name:_.name.trim(),specimen:_.specimen||"",emp_no:_.emp_no||""};await Rde(t,Pe),C({name:"",specimen:"",emp_no:""}),await he(),ie.success("Nurse row added")}catch(Pe){const Ue=Ma(Pe,"Failed to load medications");ie.error(Ue)}finally{A(!1)}}},Ne=async de=>{if(!(!s||!window.confirm(`Remove nurse "${de.name}"?`)))try{await Lde(de.id),await he(),ie.success("Nurse row deleted")}catch(Ue){const Le=Ma(Ue,"Failed to load medications");ie.error(Le)}},Be=de=>Pe=>{const Ue=Pe.target.value;I(Le=>({...Le,[de]:Ue}))},jt=async de=>{if(de.preventDefault(),!(!s||!t)){if(!R.date){ie.error("Please select date");return}try{M(!0);const Pe={date:R.date,remarks:R.remarks||""};await Fde(t,Pe),I({date:"",remarks:""}),await fe(),ie.success("Doctor's daily authorization added")}catch(Pe){const Ue=Ma(Pe,"Failed to load medications");ie.error(Ue)}finally{M(!1)}}},yt=async de=>{if(!(!s||!window.confirm(`Remove authorization entry for ${ye(de.date)}?`)))try{await $de(de.id),await fe(),ie.success("Authorization entry deleted")}catch(Ue){const Le=Ma(Ue,"Failed to load medications");ie.error(Le)}},pt=de=>Pe=>{const Ue=Pe.target.value;pe(Le=>({...Le,[de]:Ue}))},Cs=()=>pe({drug_name:"",order_type:"regular",route:"iv",frequency:"bd",dose_value:"",dose_unit:"mg",start_date:"",end_date:"",duration_days:"",instructions:""}),hs=async de=>{if(de.preventDefault(),!s||!t)return;const Pe=ee.drug_name.trim();if(!Pe){ie.error("Please enter a drug name");return}const Ue=ee.dose_value&&String(ee.dose_value).trim()!==""?String(ee.dose_value).trim():"",Le=ee.dose_value.trim()?Number(ee.dose_value):null;if(ee.dose_value&&Number.isNaN(Le)){ie.error("Dose must be a number (e.g. 500)");return}const Dt=ee.duration_days.trim()?Number(ee.duration_days):null;if(ee.duration_days&&(Number.isNaN(Dt)||!Number.isInteger(Dt))){ie.error("Duration must be whole days (e.g. 5)");return}const Rt=ee.start_date?`${ee.start_date}T00:00:00`:null,Zt=ee.end_date?`${ee.end_date}T00:00:00`:null,vs={drug_id:null,drug_name:Pe,order_type:ee.order_type||"regular",route:ee.route||"iv",frequency:ee.frequency||"bd",dose:Ue,dose_unit:ee.dose_unit||"",duration_days:Dt,start_datetime:Rt,stop_datetime:Zt,special_instructions:ee.instructions||"",order_status:"active"};try{q(!0),await Ade(t,vs),ie.success("Medication order added"),Cs(),await le()}catch(bn){const Li=Ma(bn,"Failed to add medication");ie.error(Li)}finally{q(!1)}},ae=async de=>{if(!(!s||(de.order_status||"active")==="stopped"||!window.confirm(`Stop "${de.drug_name}" for this admission?`)))try{const Ue=new Date().toISOString();await Ede(de.id,{order_status:"stopped",stop_datetime:de.stop_datetime||Ue}),ie.success("Medication stopped"),await le()}catch(Ue){const Le=Ma(Ue,"Failed to load medications");ie.error(Le)}},Te=async()=>{var de,Pe;if(t)try{l(!0);const Ue=await zde(t),Le=new Blob([Ue.data],{type:"application/pdf"}),Dt=window.URL.createObjectURL(Le),Rt=document.createElement("a");Rt.href=Dt,Rt.download=`drug-chart-${t}.pdf`,document.body.appendChild(Rt),Rt.click(),Rt.remove(),window.URL.revokeObjectURL(Dt)}catch(Ue){const Le=((Pe=(de=Ue==null?void 0:Ue.response)==null?void 0:de.data)==null?void 0:Pe.detail)||"Failed to download drug chart PDF";ie.error(Le)}finally{l(!1)}};return r.jsxs("div",{className:"space-y-4 text-sm text-slate-900",children:[r.jsxs("div",{className:"flex flex-col gap-2 rounded-2xl border bg-gradient-to-r from-sky-50 via-indigo-50 to-emerald-50 p-3 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wide text-sky-900",children:"IPD Drug Chart  NABH Format"}),r.jsxs("p",{className:"text-[11px] text-slate-700 leading-snug",children:["This page captures the complete ",r.jsx("strong",{children:"inpatient medication and drug chart"})," ","as per NABH style: patient details, allergies, diagnosis, IV fluids, main drug grid with hours/sign, SOS & STAT orders, nurse signatures and daily doctor authorisation. All entries can be used for the ",r.jsx("strong",{children:"official Drug Chart PDF"}),"."]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx("button",{type:"button",onClick:Ve,className:"rounded-full border border-slate-300 bg-white px-3 py-1 text-[11px] text-slate-700 shadow-sm hover:bg-slate-50",disabled:n,children:n?"Refreshing":"Refresh"}),r.jsx("button",{type:"button",onClick:Te,className:"rounded-full border border-slate-300 bg-white px-3 py-1 text-[11px] font-semibold text-slate-800 shadow-sm hover:bg-slate-50",disabled:i,children:i?"Preparing PDF":"Download Drug Chart PDF"})]})]}),r.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-3 shadow-sm",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsx("h3",{className:"text-xs font-semibold text-slate-800",children:"Patient details & clinical header"})}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Allergic to"}),r.jsx("input",{className:"input h-9 text-sm",placeholder:"e.g. Penicillin, NSAIDs",value:o.allergies,onChange:Ke("allergies"),disabled:!s})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Diagnosis"}),r.jsx("textarea",{className:"input min-h-[48px] text-sm",placeholder:"Primary / secondary diagnosis",value:o.diagnosis,onChange:Ke("diagnosis"),disabled:!s})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Weight (kg)"}),r.jsx("input",{type:"text",inputMode:"decimal",className:"input h-9 text-sm",value:o.weight_kg,onChange:Ke("weight_kg"),disabled:!s})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Height (cm)"}),r.jsx("input",{type:"text",inputMode:"decimal",className:"input h-9 text-sm",value:o.height_cm,onChange:Ke("height_cm"),disabled:!s})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Blood group"}),r.jsx("input",{className:"input h-9 text-sm uppercase",placeholder:"e.g. B+",value:o.blood_group,onChange:Ke("blood_group"),disabled:!s})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"BSA (m)"}),r.jsx("input",{type:"text",inputMode:"decimal",className:"input h-9 text-sm",value:o.bsa,onChange:Ke("bsa"),disabled:!s})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"BMI (kg/m)"}),r.jsx("input",{className:"input h-9 text-sm bg-slate-50",value:o.bmi,readOnly:!0}),r.jsx("p",{className:"mt-1 text-[10px] text-slate-400",children:"Auto-calculated from weight & height."})]})]}),s&&r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{type:"button",onClick:wt,className:"btn",children:"Save header"})})]}),r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-3 shadow-sm",children:[r.jsx("h3",{className:"text-xs font-semibold text-slate-800",children:"Dietary advice (per day)"}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Oral fluid (ml/day)"}),r.jsx("input",{type:"text",inputMode:"decimal",className:"input h-9 text-sm",value:o.diet_oral_fluid_per_day,onChange:Ke("diet_oral_fluid_per_day"),disabled:!s})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Salt (gm/day)"}),r.jsx("input",{type:"text",inputMode:"decimal",className:"input h-9 text-sm",value:o.diet_salt_gm_per_day,onChange:Ke("diet_salt_gm_per_day"),disabled:!s})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Calories (kcal/day)"}),r.jsx("input",{type:"text",inputMode:"decimal",className:"input h-9 text-sm",value:o.diet_calorie_per_day,onChange:Ke("diet_calorie_per_day"),disabled:!s})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Protein (gm/day)"}),r.jsx("input",{type:"text",inputMode:"decimal",className:"input h-9 text-sm",value:o.diet_protein_gm_per_day,onChange:Ke("diet_protein_gm_per_day"),disabled:!s})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Dietary remarks"}),r.jsx("textarea",{className:"input min-h-[48px] text-sm",placeholder:"Any additional diet advice / restrictions",value:o.diet_remarks,onChange:Ke("diet_remarks"),disabled:!s})]}),s&&r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{type:"button",onClick:wt,className:"rounded-full border border-slate-200 px-3 py-1 text-xs text-slate-700 hover:bg-slate-50",children:"Save diet"})})]})]}),r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-3 shadow-sm",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsx("h3",{className:"text-xs font-semibold text-slate-800",children:"Intravenous fluids"})}),s&&r.jsxs("form",{onSubmit:bt,className:"grid gap-2 md:grid-cols-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Date"}),r.jsx("input",{type:"date",className:"input h-9 text-sm",value:f.date,onChange:rt("date")})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Fluid"}),r.jsx("input",{className:"input h-9 text-sm",placeholder:"e.g. DNS 500 ml",value:f.fluid,onChange:rt("fluid")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Additive (if any)"}),r.jsx("input",{className:"input h-9 text-sm",value:f.additive,onChange:rt("additive")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Dose"}),r.jsx("input",{className:"input h-9 text-sm",placeholder:"e.g. 1 amp",value:f.dose,onChange:rt("dose")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Rate (ml/hr)"}),r.jsx("input",{type:"text",inputMode:"decimal",className:"input h-9 text-sm",value:f.rate_ml_per_hr,onChange:rt("rate_ml_per_hr")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Start time (hrs)"}),r.jsx("input",{type:"time",className:"input h-9 text-sm",value:f.start_time,onChange:rt("start_time")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Stop time (hrs)"}),r.jsx("input",{type:"time",className:"input h-9 text-sm",value:f.stop_time,onChange:rt("stop_time")})]}),r.jsxs("div",{className:"md:col-span-3",children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Remarks"}),r.jsx("input",{className:"input h-9 text-sm",placeholder:"Doctor sign / notes",value:f.remarks,onChange:rt("remarks")})]}),r.jsx("div",{className:"flex items-end justify-end",children:r.jsx("button",{type:"submit",className:"btn w-full md:w-auto",disabled:x,children:x?"Saving":"Add IV fluid"})})]}),r.jsx("div",{className:"overflow-auto rounded-xl border bg-slate-50",children:r.jsxs("table",{className:"w-full text-[11px] md:text-xs",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-slate-100 text-slate-600",children:[r.jsx("th",{className:"px-2 py-2 text-left",children:"Date"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Fluid"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Additive"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Dose"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Rate (ml/hr)"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Start"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Stop"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Remarks"}),s&&r.jsx("th",{className:"px-2 py-2"})]})}),r.jsx("tbody",{children:d.length?d.map(de=>r.jsxs("tr",{className:"border-t bg-white",children:[r.jsx("td",{className:"px-2 py-1",children:ye(de.date)}),r.jsx("td",{className:"px-2 py-1",children:de.fluid||""}),r.jsx("td",{className:"px-2 py-1",children:de.additive||""}),r.jsx("td",{className:"px-2 py-1",children:de.dose||""}),r.jsx("td",{className:"px-2 py-1",children:de.rate_ml_per_hr!=null?de.rate_ml_per_hr:""}),r.jsx("td",{className:"px-2 py-1",children:de.start_time||""}),r.jsx("td",{className:"px-2 py-1",children:de.stop_time||""}),r.jsx("td",{className:"px-2 py-1",children:de.remarks||""}),s&&r.jsx("td",{className:"px-2 py-1 text-right",children:r.jsx("button",{type:"button",onClick:()=>be(de),className:"text-[10px] text-rose-600 underline hover:text-rose-700",children:"Remove"})})]},de.id)):r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-3 text-center text-[11px] text-slate-500",colSpan:s?9:8,children:"No IV fluids recorded."})})})]})})]}),r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-3 shadow-sm",children:[r.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[r.jsx("h3",{className:"text-xs font-semibold text-slate-800",children:"Drug orders (Regular / SOS / STAT & Premed)"}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx("button",{type:"button",onClick:()=>se(de=>!de),className:`rounded-full border px-3 py-1 text-[11px] ${G?"border-emerald-500 bg-emerald-50 text-emerald-700":"border-slate-300 bg-white text-slate-600"}`,children:G?"Showing active only":"Showing all orders"}),r.jsxs("div",{className:"flex gap-1 rounded-full bg-slate-50 p-1 text-[11px]",children:[r.jsx("button",{type:"button",onClick:()=>ke("all"),className:`rounded-full px-2 py-0.5 ${ge==="all"?"bg-white text-slate-900 shadow-sm":"text-slate-600"}`,children:"All"}),gI.map(de=>r.jsx("button",{type:"button",onClick:()=>ke(de.value),className:`rounded-full px-2 py-0.5 ${ge===de.value?"bg-white text-slate-900 shadow-sm":"text-slate-600"}`,children:de.label},de.value))]})]})]}),F&&r.jsx("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:F}),s&&r.jsxs("form",{onSubmit:hs,className:"space-y-3 rounded-2xl border bg-slate-50 p-3 md:p-4",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-6",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:["Drug name ",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx("input",{className:"input h-9 text-sm",placeholder:"e.g. Tab. Paracetamol",value:ee.drug_name,onChange:pt("drug_name")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Order type"}),r.jsx("select",{className:"input h-9 text-sm",value:ee.order_type,onChange:pt("order_type"),children:gI.map(de=>r.jsx("option",{value:de.value,children:de.label},de.value))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Route"}),r.jsx("select",{className:"input h-9 text-sm",value:ee.route,onChange:pt("route"),children:zpe.map(de=>r.jsx("option",{value:de,children:de.toUpperCase()},de))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Frequency"}),r.jsx("select",{className:"input h-9 text-sm",value:ee.frequency,onChange:pt("frequency"),children:Upe.map(de=>r.jsx("option",{value:de,children:de.toUpperCase()},de))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Dose"}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("input",{className:"input h-9 w-1/2 text-sm",type:"text",inputMode:"decimal",placeholder:"e.g. 500",value:ee.dose_value,onChange:pt("dose_value")}),r.jsx("select",{className:"input h-9 w-1/2 text-sm",value:ee.dose_unit,onChange:pt("dose_unit"),children:Vpe.map(de=>r.jsx("option",{value:de,children:de},de))})]})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-5",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Start date"}),r.jsx("input",{type:"date",className:"input h-9 text-sm",value:ee.start_date,onChange:pt("start_date")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Planned end date"}),r.jsx("input",{type:"date",className:"input h-9 text-sm",value:ee.end_date,onChange:pt("end_date")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Duration (days)"}),r.jsx("input",{className:"input h-9 text-sm",type:"text",inputMode:"numeric",placeholder:"e.g. 5",value:ee.duration_days,onChange:pt("duration_days")})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Special instructions"}),r.jsx("textarea",{className:"input min-h-[48px] text-sm",placeholder:"e.g. Before food, monitor BP, tapering etc.",value:ee.instructions,onChange:pt("instructions")})]})]}),r.jsxs("div",{className:"flex items-center justify-end gap-2",children:[r.jsx("button",{type:"button",onClick:Cs,className:"rounded-full border border-slate-200 px-3 py-1 text-xs text-slate-600 hover:bg-slate-50",children:"Clear"}),r.jsx("button",{type:"submit",className:"btn",disabled:W||!s,children:W?"Saving":"Add medication"})]})]}),r.jsx("div",{className:"overflow-auto rounded-2xl border bg-white",children:r.jsxs("table",{className:"w-full text-[11px] md:text-xs",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-slate-50 text-slate-500",children:[r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Type"}),r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Drug"}),r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Route"}),r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Freq"}),r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Dose"}),r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Start"}),r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"End"}),r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Instructions"}),r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Status"}),s&&r.jsx("th",{className:"px-2 py-2 md:px-3"})]})}),r.jsx("tbody",{children:ue.length?ue.map(de=>r.jsxs("tr",{className:"border-t align-top text-slate-800",children:[r.jsx("td",{className:"px-2 py-2 md:px-3",children:de.order_type==="sos"&&"SOS"||de.order_type==="stat_premed"&&"STAT / Premed"||"Regular"}),r.jsx("td",{className:"px-2 py-2 md:px-3",children:de.drug_name||""}),r.jsx("td",{className:"px-2 py-2 uppercase md:px-3",children:de.route||""}),r.jsx("td",{className:"px-2 py-2 uppercase md:px-3",children:de.frequency||""}),r.jsx("td",{className:"px-2 py-2 md:px-3",children:X(de)}),r.jsx("td",{className:"px-2 py-2 md:px-3",children:ye(de.start_datetime)}),r.jsx("td",{className:"px-2 py-2 md:px-3",children:ye(de.stop_datetime)}),r.jsx("td",{className:"whitespace-pre-wrap px-2 py-2 md:px-3",children:de.special_instructions||""}),r.jsx("td",{className:"px-2 py-2 md:px-3",children:r.jsx("span",{className:oe(de.order_status),children:de.order_status||"active"})}),s&&r.jsx("td",{className:"px-2 py-2 text-right md:px-3",children:(de.order_status||"active")!=="stopped"&&r.jsx("button",{type:"button",onClick:()=>ae(de),className:"text-[10px] text-rose-600 underline hover:text-rose-700",children:"Stop"})})]},de.id)):r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-3 text-center text-xs text-slate-500",colSpan:s?10:9,children:U?"Loading medication orders":"No medications recorded for this admission."})})})]})}),r.jsxs("p",{className:"text-[10px] text-slate-500",children:[r.jsx("strong",{children:"Note:"})," If medicines are not administered, indicate as"," ",r.jsx("strong",{children:"NOT GIVEN"})," in the drug chart and document the reason in nurses notes. Verbal orders should be clearly marked (e.g. 'V') and read-back practiced for all orders. Verbal orders are"," ",r.jsx("strong",{children:"not accepted for high-risk drugs"})," and must be signed by the ordering doctor within 24 hours."]})]}),r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-3 shadow-sm",children:[r.jsx("h3",{className:"text-xs font-semibold text-slate-800",children:"Nurse signature register"}),s&&r.jsxs("form",{onSubmit:me,className:"grid gap-2 md:grid-cols-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Name of nurse"}),r.jsx("input",{className:"input h-9 text-sm",value:_.name,onChange:ne("name")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Specimen sign"}),r.jsx("input",{className:"input h-9 text-sm",value:_.specimen,onChange:ne("specimen")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Emp. no"}),r.jsx("input",{className:"input h-9 text-sm",value:_.emp_no,onChange:ne("emp_no")})]}),r.jsx("div",{className:"flex items-end justify-end",children:r.jsx("button",{type:"submit",className:"btn w-full md:w-auto",disabled:k,children:k?"Saving":"Add nurse"})})]}),r.jsx("div",{className:"overflow-auto rounded-xl border bg-slate-50",children:r.jsxs("table",{className:"w-full text-[11px] md:text-xs",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-slate-100 text-slate-600",children:[r.jsx("th",{className:"px-2 py-2 text-left",children:"S. No"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Name"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Specimen sign"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Emp. no"}),s&&r.jsx("th",{className:"px-2 py-2"})]})}),r.jsx("tbody",{children:w.length?w.map((de,Pe)=>r.jsxs("tr",{className:"border-t bg-white",children:[r.jsx("td",{className:"px-2 py-1",children:Pe+1}),r.jsx("td",{className:"px-2 py-1",children:de.name||""}),r.jsx("td",{className:"px-2 py-1",children:de.specimen||""}),r.jsx("td",{className:"px-2 py-1",children:de.emp_no||""}),s&&r.jsx("td",{className:"px-2 py-1 text-right",children:r.jsx("button",{type:"button",onClick:()=>Ne(de),className:"text-[10px] text-rose-600 underline hover:text-rose-700",children:"Remove"})})]},de.id)):r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-3 text-center text-xs text-slate-500",colSpan:s?5:4,children:"No nurse entries recorded."})})})]})})]}),r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-3 shadow-sm",children:[r.jsx("h3",{className:"text-xs font-semibold text-slate-800",children:"Doctor's daily authorisation"}),s&&r.jsxs("form",{onSubmit:jt,className:"grid gap-2 md:grid-cols-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Date"}),r.jsx("input",{type:"date",className:"input h-9 text-sm",value:R.date,onChange:Be("date")})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Remarks / authorisation notes"}),r.jsx("input",{className:"input h-9 text-sm",placeholder:"e.g. continue same drug chart, modify doses etc.",value:R.remarks,onChange:Be("remarks")})]}),r.jsx("div",{className:"flex items-end justify-end",children:r.jsx("button",{type:"submit",className:"btn w-full md:w-auto",disabled:O,children:O?"Saving":"Add authorisation"})})]}),r.jsx("div",{className:"overflow-auto rounded-xl border bg-slate-50",children:r.jsxs("table",{className:"w-full text-[11px] md:text-xs",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-slate-100 text-slate-600",children:[r.jsx("th",{className:"px-2 py-2 text-left",children:"Date"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Remarks"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Doctor"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Sign"}),s&&r.jsx("th",{className:"px-2 py-2"})]})}),r.jsx("tbody",{children:T.length?T.map(de=>r.jsxs("tr",{className:"border-t bg-white",children:[r.jsx("td",{className:"px-2 py-1",children:ye(de.date)}),r.jsx("td",{className:"px-2 py-1",children:de.remarks||""}),r.jsx("td",{className:"px-2 py-1",children:de.doctor_name||""}),r.jsx("td",{className:"px-2 py-1",children:de.doctor_sign||""}),s&&r.jsx("td",{className:"px-2 py-1 text-right",children:r.jsx("button",{type:"button",onClick:()=>yt(de),className:"text-[10px] text-rose-600 underline hover:text-rose-700",children:"Remove"})})]},de.id)):r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-3 text-center text-xs text-slate-500",colSpan:s?5:4,children:"No daily authorisation entries recorded."})})})]})})]})]})}function Ma(t,s="Something went wrong"){var a,i;const n=(i=(a=t==null?void 0:t.response)==null?void 0:a.data)==null?void 0:i.detail;if(!n)return s;if(typeof n=="string")return n;if(Array.isArray(n)){const l=n.map(o=>(o==null?void 0:o.msg)||(typeof o=="string"?o:"")).filter(Boolean);if(l.length)return l.join("; ")}return typeof n=="object"&&n.msg?n.msg:s}function Wpe({admissionId:t,canWrite:s}){const[n,a]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(""),[d,u]=y.useState(!1),[f,m]=y.useState({entry_type:"dressing",done_at:"",site:"",product:"",volume:"",notes:""}),x=async()=>{var C,k;if(t){l(!0),c("");try{const{data:A}=await Zde(t);a(A||[])}catch(A){c(((k=(C=A==null?void 0:A.response)==null?void 0:C.data)==null?void 0:k.detail)||"Failed to load dressing / transfusion entries")}finally{l(!1)}}};y.useEffect(()=>{x()},[t]);const b=C=>C?C.length===16?`${C}:00`:C:null,w=C=>k=>{const A=k.target.value;m(T=>({...T,[C]:A}))},j=async C=>{var k,A;if(C.preventDefault(),!(!s||!t)){if(!f.entry_type){alert("Please select type (Dressing / Transfusion)");return}u(!0);try{const T={entry_type:f.entry_type||"dressing",done_at:b(f.done_at)||new Date().toISOString(),site:f.site||"",product:f.entry_type==="transfusion"&&f.product||"",volume:f.entry_type==="transfusion"&&f.volume||"",notes:f.notes||""};await Qde(t,T),m(P=>({entry_type:P.entry_type,done_at:"",site:"",product:"",volume:"",notes:""})),await x()}catch(T){alert(((A=(k=T==null?void 0:T.response)==null?void 0:k.data)==null?void 0:A.detail)||"Failed to save entry")}finally{u(!1)}}},_=f.entry_type==="transfusion";return r.jsxs("div",{className:"space-y-4 text-sm text-black",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("h2",{className:"font-semibold",children:"Dressing / Transfusion"}),i&&r.jsx("span",{className:"text-[11px] text-gray-500",children:"Loading entries"})]}),o&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:o}),s&&r.jsxs("form",{onSubmit:j,className:"rounded-xl border bg-gray-50 p-3 space-y-3",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Type"}),r.jsxs("select",{className:"input",value:f.entry_type,onChange:w("entry_type"),children:[r.jsx("option",{value:"dressing",children:"Dressing"}),r.jsx("option",{value:"transfusion",children:"Transfusion"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Date & time"}),r.jsx("input",{type:"datetime-local",className:"input",value:f.done_at,onChange:w("done_at")})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Site"}),r.jsx("input",{className:"input",placeholder:_?"e.g. IV line / central line":"e.g. abdominal wound",value:f.site,onChange:w("site")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Product / bag"}),r.jsx("input",{className:"input",placeholder:"e.g. PRBC, FFP",value:f.product,onChange:w("product"),disabled:!_})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Volume"}),r.jsx("input",{className:"input",placeholder:"e.g. 1 unit / 300 ml",value:f.volume,onChange:w("volume"),disabled:!_})]})]}),r.jsx("textarea",{className:"input min-h-[60px]",placeholder:_?"Notes (vitals, reaction, transfusion details)":"Notes (wound status, exudate, dressing type)",value:f.notes,onChange:w("notes")}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{className:"btn",disabled:d,children:d?"Saving":"Save entry"})})]}),r.jsx("div",{className:"rounded-xl border bg-white overflow-auto",children:r.jsxs("table",{className:"w-full text-xs md:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 text-gray-500 text-[11px] md:text-xs",children:[r.jsx("th",{className:"px-2 md:px-3 py-2 text-left",children:"When"}),r.jsx("th",{className:"px-2 md:px-3 py-2 text-left",children:"Type"}),r.jsx("th",{className:"px-2 md:px-3 py-2 text-left",children:"Site"}),r.jsx("th",{className:"px-2 md:px-3 py-2 text-left",children:"Product"}),r.jsx("th",{className:"px-2 md:px-3 py-2 text-left",children:"Volume"}),r.jsx("th",{className:"px-2 md:px-3 py-2 text-left",children:"Notes"})]})}),r.jsxs("tbody",{children:[n.map(C=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-2 md:px-3 py-2 align-top",children:C.done_at?new Date(C.done_at).toLocaleString():""}),r.jsx("td",{className:"px-2 md:px-3 py-2 align-top capitalize",children:C.entry_type||""}),r.jsx("td",{className:"px-2 md:px-3 py-2 align-top",children:C.site||""}),r.jsx("td",{className:"px-2 md:px-3 py-2 align-top",children:C.product||(C.entry_type==="transfusion"?"":"")}),r.jsx("td",{className:"px-2 md:px-3 py-2 align-top",children:C.volume||(C.entry_type==="transfusion"?"":"")}),r.jsx("td",{className:"px-2 md:px-3 py-2 align-top whitespace-pre-wrap",children:C.notes||""})]},C.id)),!n.length&&!i&&r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-3 text-gray-500 text-xs",colSpan:6,children:"No dressing / transfusion entries yet."})})]})]})})]})}const qpe=["mg","g","ml","units","drops","puff","tab","cap","sachet"],Gpe=["OD","BD","TDS","QID","HS","SOS","PRN"],Kpe=[3,5,7,10,14];function Ype({admissionId:t,canWrite:s=!0}){const[n,a]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(""),[d,u]=y.useState({drugName:"",doseValue:"",doseUnit:"mg",frequency:"",durationDays:"",instructions:""}),[f,m]=y.useState(!1),x=y.useMemo(()=>Array.isArray(n)&&n.length>0,[n]),b=async()=>{var P,R;if(t){l(!0),c("");try{const{data:I}=await mB(t);console.log("======================================================"),console.log(t,"dcbjdbgjdsbcjbsd"),console.log(I,"data"),console.log("======================================================"),a(Array.isArray(I)?I:[])}catch(I){const O=((R=(P=I==null?void 0:I.response)==null?void 0:P.data)==null?void 0:R.detail)||"Failed to load discharge medicines";c(O),ie.error(O)}finally{l(!1)}}};y.useEffect(()=>{b()},[t]);const w=P=>R=>{const I=R.target.value;u(O=>({...O,[P]:I}))},j=P=>{u(R=>({...R,frequency:P}))},_=P=>{u(R=>({...R,durationDays:String(P)}))},C=()=>u({drugName:"",doseValue:"",doseUnit:"mg",frequency:"",durationDays:"",instructions:""}),k=async P=>{var B,L;if(P.preventDefault(),!s||!t)return;const R=d.drugName.trim();if(!R){ie.error("Please enter a drug name");return}const I=d.doseValue.trim()?Number(d.doseValue):null;if(d.doseValue&&Number.isNaN(I)){ie.error("Dose must be a number (e.g. 500)");return}const O=d.durationDays.trim()?Number(d.durationDays):null;if(d.durationDays&&(Number.isNaN(O)||!Number.isInteger(O))){ie.error("Duration must be a whole number of days");return}const M={drug_name:R,dose:I,dose_unit:d.doseUnit||"",route:"",frequency:d.frequency.trim(),duration_days:O,advice_text:d.instructions.trim()};try{m(!0),await qde(t,M),ie.success("Discharge medicine added"),C(),await b()}catch(F){const V=((L=(B=F==null?void 0:F.response)==null?void 0:B.data)==null?void 0:L.detail)||"Failed to save discharge medicine";ie.error(V)}finally{m(!1)}},A=P=>P.dose==null&&!P.dose_unit?"":P.dose==null?P.dose_unit||"":`${P.dose} ${P.dose_unit||""}`.trim(),T=P=>P.duration_days==null?"":P.duration_days===0?"0 days":`${P.duration_days} days`;return r.jsxs("div",{className:"space-y-4 text-sm text-slate-900",children:[r.jsxs("div",{className:"flex flex-col gap-2 rounded-2xl border bg-gradient-to-r from-sky-50 via-indigo-50 to-emerald-50 p-3 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wide text-sky-900",children:"Discharge Medications"}),r.jsx("p",{className:"text-[11px] text-slate-600",children:"Define clear post-discharge prescriptions. These lines can be merged into the discharge summary PDF."})]}),x&&r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Total medicines:"," ",r.jsx("span",{className:"font-semibold text-slate-800",children:n.length})]})]}),o&&r.jsx("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:o}),s&&r.jsxs("form",{onSubmit:k,className:"space-y-3 rounded-2xl border bg-white p-3 shadow-sm md:p-4",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("div",{className:"text-xs font-semibold text-slate-800",children:"Add / edit discharge prescription line"}),f&&r.jsx("div",{className:"text-[11px] text-slate-500",children:"Saving"})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:["Drug / formulation ",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx("input",{className:"input h-9 text-sm",placeholder:"e.g. Tab. Paracetamol",value:d.drugName,onChange:w("drugName")}),r.jsx("p",{className:"mt-1 text-[10px] text-slate-400",children:"Include form (tab / cap / syrup) for clarity."})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Dose"}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("input",{className:"input h-9 w-1/2 text-sm",type:"text",inputMode:"decimal",placeholder:"e.g. 500",value:d.doseValue,onChange:w("doseValue")}),r.jsx("select",{className:"input h-9 w-1/2 text-sm",value:d.doseUnit,onChange:w("doseUnit"),children:qpe.map(P=>r.jsx("option",{value:P,children:P},P))})]}),r.jsx("p",{className:"mt-1 text-[10px] text-slate-400",children:"Number in dose box, unit separately (mg / ml / units)."})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Frequency"}),r.jsx("input",{className:"input h-9 text-sm",placeholder:"e.g. BD, TDS, HS",value:d.frequency,onChange:w("frequency")}),r.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:Gpe.map(P=>r.jsx("button",{type:"button",onClick:()=>j(P),className:"rounded-full border border-slate-200 px-2 py-[1px] text-[10px] text-slate-600 hover:bg-slate-100",children:P},P))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Duration (days)"}),r.jsx("input",{className:"input h-9 text-sm",type:"text",inputMode:"numeric",placeholder:"e.g. 5",value:d.durationDays,onChange:w("durationDays")}),r.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:Kpe.map(P=>r.jsxs("button",{type:"button",onClick:()=>_(P),className:"rounded-full border border-slate-200 px-2 py-[1px] text-[10px] text-slate-600 hover:bg-slate-100",children:[P,"d"]},P))})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Instructions"}),r.jsx("textarea",{className:"input min-h-[60px] text-sm",placeholder:"e.g. After food; stop if rash / vomiting; avoid alcohol",value:d.instructions,onChange:w("instructions")})]}),r.jsxs("div",{className:"flex items-center justify-end gap-2",children:[r.jsx("button",{type:"button",onClick:C,className:"rounded-full border border-slate-200 px-3 py-1 text-xs text-slate-600 hover:bg-slate-50",children:"Clear"}),r.jsx("button",{type:"submit",className:"btn",disabled:f||!s,children:f?"Saving":"Add discharge med"})]})]}),r.jsx("div",{className:"overflow-auto rounded-2xl border bg-white shadow-sm",children:r.jsxs("table",{className:"w-full text-xs md:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-slate-50 text-[11px] text-slate-500 md:text-xs",children:[r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Drug"}),r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Dose"}),r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Frequency"}),r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Duration"}),r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Instructions"})]})}),r.jsx("tbody",{children:x?n.map(P=>r.jsxs("tr",{className:"border-t text-slate-800",children:[r.jsx("td",{className:"px-2 py-2 md:px-3",children:P.drug_name||""}),r.jsx("td",{className:"px-2 py-2 md:px-3",children:A(P)}),r.jsx("td",{className:"px-2 py-2 md:px-3",children:P.frequency||""}),r.jsx("td",{className:"px-2 py-2 md:px-3",children:T(P)}),r.jsx("td",{className:"whitespace-pre-wrap px-2 py-2 md:px-3",children:P.advice_text||""})]},P.id)):r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-3 text-center text-xs text-slate-500",colSpan:5,children:i?"Loading discharge medicines":"No discharge medicines added yet."})})})]})})]})}function Xpe({admissionId:t,canWrite:s}){const[n,a]=y.useState(null),[i,l]=y.useState(!1),[o,c]=y.useState(""),[d,u]=y.useState({rating_nursing:5,rating_doctor:5,rating_cleanliness:5,comments:"",suggestions:""}),f=async()=>{var w,j,_;if(t){l(!0),c("");try{const{data:C}=await Kde(t);a(C||null),C&&u({rating_nursing:C.rating_nursing??5,rating_doctor:C.rating_doctor??5,rating_cleanliness:C.rating_cleanliness??5,comments:C.comments||"",suggestions:C.suggestions||""})}catch(C){const k=(w=C==null?void 0:C.response)==null?void 0:w.status;k&&k!==404&&c(((_=(j=C==null?void 0:C.response)==null?void 0:j.data)==null?void 0:_.detail)||"Failed to load feedback")}finally{l(!1)}}};y.useEffect(()=>{f()},[t]);const m=async w=>{var j,_;if(w.preventDefault(),!(!s||!t))try{const C={rating_nursing:Number(d.rating_nursing)||0,rating_doctor:Number(d.rating_doctor)||0,rating_cleanliness:Number(d.rating_cleanliness)||0,comments:d.comments||"",suggestions:d.suggestions||""},{data:k}=await Yde(t,C);a(k||C),alert("Feedback saved")}catch(C){alert(((_=(j=C==null?void 0:C.response)==null?void 0:j.data)==null?void 0:_.detail)||"Failed to save feedback")}},x=({label:w,value:j,onChange:_,disabled:C})=>r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:w}),r.jsx("select",{className:"input",value:j,disabled:C,onChange:k=>_(Number(k.target.value)),children:[1,2,3,4,5].map(k=>r.jsxs("option",{value:k,children:[k," / 5"]},k))})]}),b=!s;return r.jsxs("div",{className:"space-y-4 text-sm text-black",children:[r.jsx("h2",{className:"font-semibold",children:"Patient Feedback"}),r.jsx("p",{className:"text-xs text-gray-600",children:"Capture patient or attendant feedback for this admission (NABH requirement  patient satisfaction)."}),i&&r.jsx("div",{className:"text-xs text-gray-500",children:"Loading"}),o&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:o}),r.jsxs("form",{onSubmit:m,className:"rounded-xl border bg-gray-50 p-3 space-y-3",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsx(x,{label:"Nursing care",value:d.rating_nursing,disabled:b,onChange:w=>u(j=>({...j,rating_nursing:w}))}),r.jsx(x,{label:"Doctor communication",value:d.rating_doctor,disabled:b,onChange:w=>u(j=>({...j,rating_doctor:w}))}),r.jsx(x,{label:"Cleanliness / facilities",value:d.rating_cleanliness,disabled:b,onChange:w=>u(j=>({...j,rating_cleanliness:w}))})]}),r.jsx("textarea",{className:"input min-h-[80px]",placeholder:"Comments",value:d.comments,disabled:b,onChange:w=>u(j=>({...j,comments:w.target.value}))}),r.jsx("textarea",{className:"input min-h-[60px]",placeholder:"Suggestions for improvement",value:d.suggestions,disabled:b,onChange:w=>u(j=>({...j,suggestions:w.target.value}))}),s&&r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{className:"btn",children:"Save feedback"})})]}),n&&r.jsxs("div",{className:"rounded-xl border bg-white p-3 text-xs text-gray-700",children:[r.jsx("div",{className:"font-semibold mb-1",children:"Snapshot"}),r.jsxs("div",{children:["Nursing care: ",r.jsxs("b",{children:[n.rating_nursing,"/5"]}),", Doctor:"," ",r.jsxs("b",{children:[n.rating_doctor,"/5"]}),", Cleanliness:"," ",r.jsxs("b",{children:[n.rating_cleanliness,"/5"]})]}),n.comments&&r.jsxs("div",{className:"mt-1",children:[r.jsx("span",{className:"font-semibold",children:"Comments:"})," ",n.comments]}),n.suggestions&&r.jsxs("div",{className:"mt-1",children:[r.jsx("span",{className:"font-semibold",children:"Suggestions:"})," ",n.suggestions]})]})]})}var GN="rovingFocusGroup.onEntryFocus",Qpe={bubbles:!1,cancelable:!0},Ex="RovingFocusGroup",[J_,zF,Zpe]=wB(Ex),[Jpe,UF]=Mu(Ex,[Zpe]),[exe,txe]=Jpe(Ex),VF=y.forwardRef((t,s)=>r.jsx(J_.Provider,{scope:t.__scopeRovingFocusGroup,children:r.jsx(J_.Slot,{scope:t.__scopeRovingFocusGroup,children:r.jsx(sxe,{...t,ref:s})})}));VF.displayName=Ex;var sxe=y.forwardRef((t,s)=>{const{__scopeRovingFocusGroup:n,orientation:a,loop:i=!1,dir:l,currentTabStopId:o,defaultCurrentTabStopId:c,onCurrentTabStopIdChange:d,onEntryFocus:u,preventScrollOnEntryFocus:f=!1,...m}=t,x=y.useRef(null),b=Ss(s,x),w=Ub(l),[j,_]=$p({prop:o,defaultProp:c??null,onChange:d,caller:Ex}),[C,k]=y.useState(!1),A=ea(u),T=zF(n),P=y.useRef(!1),[R,I]=y.useState(0);return y.useEffect(()=>{const O=x.current;if(O)return O.addEventListener(GN,A),()=>O.removeEventListener(GN,A)},[A]),r.jsx(exe,{scope:n,orientation:a,dir:w,loop:i,currentTabStopId:j,onItemFocus:y.useCallback(O=>_(O),[_]),onItemShiftTab:y.useCallback(()=>k(!0),[]),onFocusableItemAdd:y.useCallback(()=>I(O=>O+1),[]),onFocusableItemRemove:y.useCallback(()=>I(O=>O-1),[]),children:r.jsx(Qt.div,{tabIndex:C||R===0?-1:0,"data-orientation":a,...m,ref:b,style:{outline:"none",...t.style},onMouseDown:Wt(t.onMouseDown,()=>{P.current=!0}),onFocus:Wt(t.onFocus,O=>{const M=!P.current;if(O.target===O.currentTarget&&M&&!C){const B=new CustomEvent(GN,Qpe);if(O.currentTarget.dispatchEvent(B),!B.defaultPrevented){const L=T().filter(W=>W.focusable),F=L.find(W=>W.active),V=L.find(W=>W.id===j),z=[F,V,...L].filter(Boolean).map(W=>W.ref.current);qF(z,f)}}P.current=!1}),onBlur:Wt(t.onBlur,()=>k(!1))})})}),HF="RovingFocusGroupItem",WF=y.forwardRef((t,s)=>{const{__scopeRovingFocusGroup:n,focusable:a=!0,active:i=!1,tabStopId:l,children:o,...c}=t,d=Ic(),u=l||d,f=txe(HF,n),m=f.currentTabStopId===u,x=zF(n),{onFocusableItemAdd:b,onFocusableItemRemove:w,currentTabStopId:j}=f;return y.useEffect(()=>{if(a)return b(),()=>w()},[a,b,w]),r.jsx(J_.ItemSlot,{scope:n,id:u,focusable:a,active:i,children:r.jsx(Qt.span,{tabIndex:m?0:-1,"data-orientation":f.orientation,...c,ref:s,onMouseDown:Wt(t.onMouseDown,_=>{a?f.onItemFocus(u):_.preventDefault()}),onFocus:Wt(t.onFocus,()=>f.onItemFocus(u)),onKeyDown:Wt(t.onKeyDown,_=>{if(_.key==="Tab"&&_.shiftKey){f.onItemShiftTab();return}if(_.target!==_.currentTarget)return;const C=axe(_,f.orientation,f.dir);if(C!==void 0){if(_.metaKey||_.ctrlKey||_.altKey||_.shiftKey)return;_.preventDefault();let A=x().filter(T=>T.focusable).map(T=>T.ref.current);if(C==="last")A.reverse();else if(C==="prev"||C==="next"){C==="prev"&&A.reverse();const T=A.indexOf(_.currentTarget);A=f.loop?ixe(A,T+1):A.slice(T+1)}setTimeout(()=>qF(A))}}),children:typeof o=="function"?o({isCurrentTabStop:m,hasTabStop:j!=null}):o})})});WF.displayName=HF;var nxe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function rxe(t,s){return s!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function axe(t,s,n){const a=rxe(t.key,n);if(!(s==="vertical"&&["ArrowLeft","ArrowRight"].includes(a))&&!(s==="horizontal"&&["ArrowUp","ArrowDown"].includes(a)))return nxe[a]}function qF(t,s=!1){const n=document.activeElement;for(const a of t)if(a===n||(a.focus({preventScroll:s}),document.activeElement!==n))return}function ixe(t,s){return t.map((n,a)=>t[(s+a)%t.length])}var lxe=VF,oxe=WF;function cxe(t,s){return y.useReducer((n,a)=>s[n][a]??n,t)}var $o=t=>{const{present:s,children:n}=t,a=dxe(s),i=typeof n=="function"?n({present:a.isPresent}):y.Children.only(n),l=Ss(a.ref,uxe(i));return typeof n=="function"||a.isPresent?y.cloneElement(i,{ref:l}):null};$o.displayName="Presence";function dxe(t){const[s,n]=y.useState(),a=y.useRef(null),i=y.useRef(t),l=y.useRef("none"),o=t?"mounted":"unmounted",[c,d]=cxe(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return y.useEffect(()=>{const u=B0(a.current);l.current=c==="mounted"?u:"none"},[c]),Pr(()=>{const u=a.current,f=i.current;if(f!==t){const x=l.current,b=B0(u);t?d("MOUNT"):b==="none"||(u==null?void 0:u.display)==="none"?d("UNMOUNT"):d(f&&x!==b?"ANIMATION_OUT":"UNMOUNT"),i.current=t}},[t,d]),Pr(()=>{if(s){let u;const f=s.ownerDocument.defaultView??window,m=b=>{const j=B0(a.current).includes(CSS.escape(b.animationName));if(b.target===s&&j&&(d("ANIMATION_END"),!i.current)){const _=s.style.animationFillMode;s.style.animationFillMode="forwards",u=f.setTimeout(()=>{s.style.animationFillMode==="forwards"&&(s.style.animationFillMode=_)})}},x=b=>{b.target===s&&(l.current=B0(a.current))};return s.addEventListener("animationstart",x),s.addEventListener("animationcancel",m),s.addEventListener("animationend",m),()=>{f.clearTimeout(u),s.removeEventListener("animationstart",x),s.removeEventListener("animationcancel",m),s.removeEventListener("animationend",m)}}else d("ANIMATION_END")},[s,d]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:y.useCallback(u=>{a.current=u?getComputedStyle(u):null,n(u)},[])}}function B0(t){return(t==null?void 0:t.animationName)||"none"}function uxe(t){var a,i;let s=(a=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:a.get,n=s&&"isReactWarning"in s&&s.isReactWarning;return n?t.ref:(s=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=s&&"isReactWarning"in s&&s.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var Qb="Tabs",[hxe]=Mu(Qb,[UF]),GF=UF(),[fxe,vk]=hxe(Qb),KF=y.forwardRef((t,s)=>{const{__scopeTabs:n,value:a,onValueChange:i,defaultValue:l,orientation:o="horizontal",dir:c,activationMode:d="automatic",...u}=t,f=Ub(c),[m,x]=$p({prop:a,onChange:i,defaultProp:l??"",caller:Qb});return r.jsx(fxe,{scope:n,baseId:Ic(),value:m,onValueChange:x,orientation:o,dir:f,activationMode:d,children:r.jsx(Qt.div,{dir:f,"data-orientation":o,...u,ref:s})})});KF.displayName=Qb;var YF="TabsList",XF=y.forwardRef((t,s)=>{const{__scopeTabs:n,loop:a=!0,...i}=t,l=vk(YF,n),o=GF(n);return r.jsx(lxe,{asChild:!0,...o,orientation:l.orientation,dir:l.dir,loop:a,children:r.jsx(Qt.div,{role:"tablist","aria-orientation":l.orientation,...i,ref:s})})});XF.displayName=YF;var QF="TabsTrigger",ZF=y.forwardRef((t,s)=>{const{__scopeTabs:n,value:a,disabled:i=!1,...l}=t,o=vk(QF,n),c=GF(n),d=t$(o.baseId,a),u=s$(o.baseId,a),f=a===o.value;return r.jsx(oxe,{asChild:!0,...c,focusable:!i,active:f,children:r.jsx(Qt.button,{type:"button",role:"tab","aria-selected":f,"aria-controls":u,"data-state":f?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:d,...l,ref:s,onMouseDown:Wt(t.onMouseDown,m=>{!i&&m.button===0&&m.ctrlKey===!1?o.onValueChange(a):m.preventDefault()}),onKeyDown:Wt(t.onKeyDown,m=>{[" ","Enter"].includes(m.key)&&o.onValueChange(a)}),onFocus:Wt(t.onFocus,()=>{const m=o.activationMode!=="manual";!f&&!i&&m&&o.onValueChange(a)})})})});ZF.displayName=QF;var JF="TabsContent",e$=y.forwardRef((t,s)=>{const{__scopeTabs:n,value:a,forceMount:i,children:l,...o}=t,c=vk(JF,n),d=t$(c.baseId,a),u=s$(c.baseId,a),f=a===c.value,m=y.useRef(f);return y.useEffect(()=>{const x=requestAnimationFrame(()=>m.current=!1);return()=>cancelAnimationFrame(x)},[]),r.jsx($o,{present:i||f,children:({present:x})=>r.jsx(Qt.div,{"data-state":f?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":d,hidden:!x,id:u,tabIndex:0,...o,ref:s,style:{...t.style,animationDuration:m.current?"0s":void 0},children:x&&l})})});e$.displayName=JF;function t$(t,s){return`${t}-trigger-${s}`}function s$(t,s){return`${t}-content-${s}`}var mxe=KF,n$=XF,r$=ZF,a$=e$;const Hl=mxe,ll=y.forwardRef(({className:t,...s},n)=>r.jsx(n$,{ref:n,className:Pt("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",t),...s}));ll.displayName=n$.displayName;const xs=y.forwardRef(({className:t,...s},n)=>r.jsx(r$,{ref:n,className:Pt("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",t),...s}));xs.displayName=r$.displayName;const fs=y.forwardRef(({className:t,...s},n)=>r.jsx(a$,{ref:n,className:Pt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...s}));fs.displayName=a$.displayName;function pxe({admission:t,beds:s,canWrite:n,onTransfer:a}){const i=(t==null?void 0:t.current_bed_id)&&s.find(l=>l.id===t.current_bed_id);return r.jsxs("div",{className:"space-y-4 text-sm text-slate-900",children:[r.jsxs("div",{className:"flex flex-col gap-1 rounded-2xl border bg-gradient-to-r from-sky-50 via-slate-50 to-emerald-50 p-3 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wide text-sky-900",children:"Bed / Transfer"}),r.jsx("p",{className:"text-[11px] text-slate-600",children:"View current bed and transfer the patient to another available bed with proper tracking. This action affects IPD bed occupancy and billing."})]}),i?r.jsxs("div",{className:"text-[11px] text-slate-600",children:["Current bed:"," ",r.jsx("span",{className:"font-semibold text-slate-900",children:i.code}),i.ward_name&&r.jsxs("span",{className:"ml-1 text-slate-500",children:["(",i.ward_name,")"]})]}):r.jsx("div",{className:"text-[11px] text-slate-500",children:"No active bed mapped for this admission."})]}),r.jsxs("div",{className:"rounded-2xl border bg-white p-3 shadow-sm md:p-4",children:[r.jsx("div",{className:"mb-2 text-xs font-semibold text-slate-800",children:"Transfer to another bed"}),!n&&r.jsx("div",{className:"mb-3 rounded-lg border border-amber-100 bg-amber-50 px-3 py-2 text-[11px] text-amber-700",children:"You have view-only access. Contact an IPD incharge / Admin to perform transfers."}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-[minmax(0,320px)_1fr]",children:[r.jsx("div",{children:r.jsx(vB,{value:"",onChange:l=>{!n||!l||a(l)}})}),r.jsx("div",{className:"text-[11px] text-slate-500",children:r.jsxs("ul",{className:"list-disc space-y-1 pl-4",children:[r.jsx("li",{children:"Only vacant beds can be selected for transfer."}),r.jsx("li",{children:"Bed transfer will automatically update bed occupancy and subsequent bed charges."}),r.jsx("li",{children:"Ensure the new bed type is clinically appropriate for the patient's condition (ICU / HDU / Ward etc.)."})]})})]})]})]})}const yI=[{key:"nursing",label:"Nursing Notes",el:Rue,writePerm:"ipd.nursing"},{key:"vitals",label:"Vitals",el:Lue,writePerm:"ipd.nursing"},{key:"io",label:"Intake/Output",el:Bue,writePerm:"ipd.nursing"},{key:"handover",label:"Shift Handover",el:Fue,writePerm:"ipd.nursing"},{key:"rounds",label:"Doctor Rounds",el:$ue,writePerm:"ipd.doctor"},{key:"progress",label:"Progress Notes",el:zue,writePerm:"ipd.doctor"},{key:"assessments",label:"Assessments",el:$pe,writePerm:"ipd.nursing"},{key:"medications",label:"Medications / Drug Chart",el:Hpe,writePerm:"ipd.doctor"},{key:"dressing",label:"Dressing / Transfusion",el:Wpe,writePerm:"ipd.nursing"},{key:"discharge-meds",label:"Discharge Meds",el:Ype,writePerm:"ipd.doctor"},{key:"bed-transfer",label:"Bed / Transfer",el:pxe,writePerm:"ipd.manage"},{key:"referrals",label:"Referrals",el:Vue,writePerm:"ipd.manage"},{key:"discharge",label:"Discharge Summary",el:Hue,writePerm:"ipd.manage"},{key:"charges",label:"Bed Charges",el:Wue,writePerm:"ipd.manage"},{key:"feedback",label:"Feedback",el:Xpe,writePerm:"ipd.manage"}];function xxe(){var B;const{id:t}=sd(),s=Di(),n=((B=s==null?void 0:s.state)==null?void 0:B.admission)||null,[a,i]=y.useState(n),[l,o]=y.useState([]),[c,d]=y.useState("nursing"),[u,f]=y.useState(""),[m,x]=y.useState(!1),[b,w]=y.useState(null),j=tt("ipd.view"),_=tt("ipd.manage"),C=tt("ipd.nursing"),k=tt("ipd.doctor"),A={"ipd.nursing":C,"ipd.doctor":k,"ipd.manage":_},T=L=>`ADM-${String(L).padStart(6,"0")}`,P=async()=>{var L,F,V;x(!0),f("");try{const[{data:U},z]=await Promise.all([fB(Number(t)),rl()]),W=U||n||null;if(i(W),o(z.data||[]),W!=null&&W.patient_id)try{const{data:q}=await $b(W.patient_id);w(q)}catch{}}catch(U){((U==null?void 0:U.status)||((L=U==null?void 0:U.response)==null?void 0:L.status))===404&&n?i(n):f(((V=(F=U==null?void 0:U.response)==null?void 0:F.data)==null?void 0:V.detail)||"Failed to load admission details")}finally{x(!1)}};y.useEffect(()=>{P()},[t]);const R=async()=>{var L,F;if(a&&window.confirm("Are you sure you want to cancel this admission? This will mark the admission as cancelled."))try{await sde(a.id),window.location.assign("/ipd/tracking")}catch(V){f(((F=(L=V==null?void 0:V.response)==null?void 0:L.data)==null?void 0:F.detail)||"Cancel failed")}},I=async L=>{var F,V;if(!(!a||!L))try{await nde(a.id,{to_bed_id:Number(L),reason:"Transfer"}),await P()}catch(U){f(((V=(F=U==null?void 0:U.response)==null?void 0:F.data)==null?void 0:V.detail)||"Transfer failed")}};if(!j&&!_)return r.jsx("div",{className:"p-4 text-sm text-rose-700",children:"Access denied (need ipd.view)."});if(m&&!a)return r.jsx("div",{className:"p-4 text-sm",children:"Loading"});if(!a)return r.jsx("div",{className:"p-4 text-sm",children:"No data"});const O=a.current_bed_id&&l.find(L=>L.id===a.current_bed_id),M=()=>r.jsxs("div",{className:"grid gap-3 rounded-2xl border bg-white p-3 text-xs text-slate-800 md:grid-cols-4 md:p-4",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] uppercase tracking-wide text-slate-400",children:"Admission"}),r.jsx("div",{className:"font-semibold text-slate-900",children:T(a.id)}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Admitted on:"," ",a.admitted_at?new Date(a.admitted_at).toLocaleString():""]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] uppercase tracking-wide text-slate-400",children:"Patient"}),r.jsx("div",{className:"font-semibold text-slate-900",children:(b==null?void 0:b.full_name)||(b==null?void 0:b.name)||""}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID:"," ",r.jsx("span",{className:"font-medium",children:(b==null?void 0:b.uhid)||`P-${a.patient_id}`})]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] uppercase tracking-wide text-slate-400",children:"Bed / Ward"}),r.jsx("div",{className:"font-semibold text-slate-900",children:(O==null?void 0:O.code)||""}),(O==null?void 0:O.ward_name)&&r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Ward: ",O.ward_name]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] uppercase tracking-wide text-slate-400",children:"Status"}),r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-slate-100 px-3 py-1 text-[11px] font-medium capitalize text-slate-800",children:[r.jsx("span",{className:a.status==="active"?"h-2 w-2 rounded-full bg-emerald-500":"h-2 w-2 rounded-full bg-slate-400"}),a.status||""]}),a.practitioner_name&&r.jsxs("div",{className:"mt-1 text-[11px] text-slate-500",children:["Primary doctor:"," ",r.jsx("span",{className:"font-medium",children:a.practitioner_name})]})]})]});return r.jsxs("div",{className:"space-y-4 p-3 md:p-4",children:[r.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-base font-semibold text-slate-900 md:text-lg",children:"IPD Admission  Patient Tracking"}),r.jsx("p",{className:"text-xs text-slate-500 md:text-[13px]",children:"View and manage all in-patient clinical documentation for this admission  nursing notes, vitals, drug chart, handovers, discharge summary and more."})]}),r.jsx("div",{className:"flex flex-wrap items-center gap-2",children:_&&r.jsx("button",{type:"button",onClick:R,className:"rounded-full bg-rose-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-rose-700",children:"Cancel Admission"})})]}),u&&r.jsx("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700 md:text-sm",children:u}),r.jsx(M,{}),r.jsx("div",{className:"rounded-2xl border bg-white shadow-sm",children:r.jsxs(Hl,{value:c,onValueChange:d,className:"w-full",children:[r.jsx("div",{className:"border-b px-2 py-2 md:px-3",children:r.jsx(ll,{className:"h-auto flex flex-wrap gap-1 bg-transparent p-0 md:gap-2",children:yI.map(L=>{const F=A[L.writePerm]??!1;return r.jsxs(xs,{value:L.key,className:"rounded-full px-3 py-1 text-[11px] text-slate-700 data-[state=active]:bg-slate-900 data-[state=active]:text-white md:text-xs",children:[L.label,!F&&r.jsx("span",{className:"ml-2 rounded-full bg-slate-200 px-1.5 py-[1px] text-[9px] uppercase tracking-wide text-slate-700",children:"view"})]},L.key)})})}),r.jsx("div",{className:"p-2 md:p-3",children:yI.map(L=>{const F=L.el,V=A[L.writePerm]??!1;return r.jsx(fs,{value:L.key,className:"mt-2",children:r.jsx(F,{admissionId:a.id,admission:a,patient:b,canWrite:V,beds:l,onTransfer:I})},L.key)})})]})})]})}const KN=10;function gxe(){const[t,s]=y.useState([]),[n,a]=y.useState({}),[i,l]=y.useState({}),[o,c]=y.useState(!1),[d,u]=y.useState(""),[f,m]=y.useState(""),[x,b]=y.useState(1),w=B=>`ADM-${String(B).padStart(6,"0")}`,j=B=>B?B==="vacant"?"bg-emerald-50 text-emerald-700 border-emerald-200":B==="occupied"?"bg-rose-50 text-rose-700 border-rose-200":B==="reserved"?"bg-amber-50 text-amber-700 border-amber-200":B==="preoccupied"?"bg-sky-50 text-sky-700 border-sky-200":"bg-slate-50 text-slate-700 border-slate-200":"bg-slate-50 text-slate-700 border-slate-200",_=async()=>{var B,L;c(!0),u("");try{const[F,V]=await Promise.all([Fb({status:"admitted"}),rl()]),U=F.data||[],z=V.data||[];U.sort((se,ge)=>new Date(ge.admitted_at||0)-new Date(se.admitted_at||0)),s(U);const W={};for(const se of z)W[se.id]=se;a(W);const q=[...new Set(U.map(se=>se.patient_id))].slice(0,100),G={};await Promise.all(q.map(async se=>{try{const{data:ge}=await $b(se);G[se]=(ge==null?void 0:ge.uhid)||`P-${se}`}catch{G[se]=`P-${se}`}})),l(G),b(1)}catch(F){console.error("TrackingAdmissions loadData error",F),u(((L=(B=F==null?void 0:F.response)==null?void 0:B.data)==null?void 0:L.detail)||"Failed to load active admissions. Please try again."),s([]),a({}),l({})}finally{c(!1)}};y.useEffect(()=>{let B=!0;return(async()=>await _())(),()=>{B=!1}},[]);const C=y.useMemo(()=>{const B=f.trim().toLowerCase();return B?t.filter(L=>{var z;const F=w(L.id).toLowerCase(),V=(i[L.patient_id]||`P-${L.patient_id}`).toLowerCase(),U=(((z=n[L.current_bed_id])==null?void 0:z.code)||"").toLowerCase();return F.includes(B)||V.includes(B)||U.includes(B)}):t},[t,f,i,n]),k=Math.max(1,Math.ceil(C.length/KN));y.useEffect(()=>{b(1)},[f,t]);const A=(x-1)*KN,T=C.slice(A,A+KN),P=()=>b(B=>Math.max(1,B-1)),R=()=>b(B=>Math.min(k,B+1)),I=x<=1||o,O=x>=k||o,M=t.length;return r.jsxs("div",{className:"min-h-screen bg-slate-50 px-4 py-4 text-black md:px-6 md:py-6",children:[r.jsxs("div",{className:"mx-auto mb-4 flex max-w-6xl flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl font-semibold tracking-tight text-slate-900",children:"Tracking Admissions"}),r.jsx("p",{className:"mt-1 max-w-2xl text-sm text-slate-600",children:"View all currently admitted in-patients, along with their admission number, UHID and allocated bed. Use the search box to quickly find a patient or admission, and open the admission detail screen for nursing, vitals, orders and discharge."})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[r.jsx(on,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{className:"leading-tight",children:[r.jsx("span",{className:"font-medium text-slate-800",children:"Active patients"}),r.jsx("br",{}),"Track IP stays"]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[r.jsx(Jn,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{className:"leading-tight",children:[r.jsx("span",{className:"font-medium text-slate-800",children:"Bed position"}),r.jsx("br",{}),"Ward / room / bed"]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[r.jsx(Xn,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{className:"leading-tight",children:[r.jsx("span",{className:"font-medium text-slate-800",children:"Admitted since"}),r.jsx("br",{}),"Monitor length of stay"]})]})]})]}),r.jsxs("div",{className:"mx-auto max-w-6xl space-y-3",children:[r.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white p-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"w-full md:max-w-md",children:[r.jsxs("div",{className:"relative",children:[r.jsx(is,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),r.jsx("input",{className:"w-full rounded-2xl border border-slate-200 bg-white px-9 py-2 text-sm text-slate-900 placeholder:text-slate-400 outline-none transition focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Search by Admission no, UHID, Bed code",value:f,onChange:B=>m(B.target.value)})]}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Tip: Try typing admission number (ADM-000123), UHID or bed code."})]}),r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 md:justify-end",children:[r.jsxs("div",{className:"text-xs text-slate-600",children:[r.jsx("span",{className:"font-semibold text-slate-900",children:C.length})," ","of ",M," active admissions"]}),r.jsxs("button",{type:"button",onClick:_,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-60",disabled:o,children:[o?r.jsx(ss,{className:"h-3.5 w-3.5 animate-spin"}):r.jsx(Si,{className:"h-3.5 w-3.5"}),"Refresh"]})]})]}),d&&r.jsxs("div",{className:"flex items-start gap-2 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[r.jsx(yn,{className:"mt-0.5 h-4 w-4"}),r.jsx("span",{children:d})]}),o&&!t.length&&r.jsx("div",{className:"flex items-center justify-center rounded-2xl border border-slate-200 bg-white px-4 py-10 text-sm text-slate-600 shadow-sm",children:r.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 px-3 py-1.5 text-xs",children:[r.jsx(ss,{className:"h-4 w-4 animate-spin text-slate-500"}),"Loading active admissions"]})}),!o&&T.length===0&&r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-4 py-8 text-center text-sm text-slate-500 shadow-sm",children:"No active admissions found."}),!o&&T.length>0&&r.jsxs("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm",children:[r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-slate-50 text-xs text-slate-500",children:[r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Admission"}),r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Patient (UHID)"}),r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Bed"}),r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Admitted at"}),r.jsx("th",{className:"px-4 py-2 text-right font-medium",children:"Action"})]})}),r.jsx("tbody",{children:T.map(B=>{const L=n[B.current_bed_id],F=(L==null?void 0:L.code)||"",V=i[B.patient_id]||`P-${B.patient_id}`;return r.jsxs("tr",{className:"border-t text-sm hover:bg-slate-50",children:[r.jsx("td",{className:"px-4 py-2 align-middle text-slate-900",children:r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2.5 py-0.5 text-[11px] font-semibold tracking-wide text-slate-800",children:w(B.id)})}),r.jsx("td",{className:"px-4 py-2 align-middle text-slate-800",children:V}),r.jsxs("td",{className:"px-4 py-2 align-middle text-slate-800",children:[F,(L==null?void 0:L.state)&&r.jsx("span",{className:`ml-1 inline-flex items-center rounded-full border px-1.5 py-0.5 text-[10px] ${j(L.state)}`,children:L.state})]}),r.jsx("td",{className:"px-4 py-2 align-middle text-slate-700",children:B.admitted_at?new Date(B.admitted_at).toLocaleString():""}),r.jsx("td",{className:"px-4 py-2 align-middle text-right",children:r.jsx(nl,{to:`/ipd/admission/${B.id}`,state:{admission:B},className:"inline-flex items-center rounded-full bg-slate-900 px-3 py-1.5 text-xs font-semibold text-white shadow-sm transition hover:bg-slate-800",children:"Open"})})]},B.id)})})]})}),r.jsx("div",{className:"space-y-2 p-3 md:hidden",children:T.map(B=>{const L=n[B.current_bed_id],F=(L==null?void 0:L.code)||"",V=i[B.patient_id]||`P-${B.patient_id}`;return r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs shadow-sm",children:[r.jsxs("div",{className:"mb-1 flex items-center justify-between gap-2",children:[r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-900 px-2.5 py-0.5 text-[11px] font-semibold tracking-wide text-white",children:w(B.id)}),r.jsx(nl,{to:`/ipd/admission/${B.id}`,state:{admission:B},className:"inline-flex items-center rounded-full bg-slate-900 px-3 py-1 text-[11px] font-semibold text-white shadow-sm transition hover:bg-slate-800",children:"Open"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2 text-slate-800",children:[r.jsx(on,{className:"h-3.5 w-3.5 text-slate-500"}),r.jsx("span",{className:"font-medium",children:V})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-slate-800",children:[r.jsx(Jn,{className:"h-3.5 w-3.5 text-slate-500"}),r.jsx("span",{className:"font-medium",children:F}),(L==null?void 0:L.state)&&r.jsx("span",{className:`inline-flex items-center rounded-full border px-1.5 py-0.5 text-[10px] ${j(L.state)}`,children:L.state})]}),r.jsxs("div",{className:"flex items-start gap-2 text-slate-700",children:[r.jsx(Xn,{className:"mt-0.5 h-3.5 w-3.5 text-slate-500"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] text-slate-500",children:"Admitted at"}),r.jsx("div",{className:"text-[11px]",children:B.admitted_at?new Date(B.admitted_at).toLocaleString():""})]})]})]})]},B.id)})}),C.length>0&&r.jsxs("div",{className:"flex flex-col items-center justify-between gap-3 border-t border-slate-100 px-4 py-3 text-xs text-slate-600 sm:flex-row",children:[r.jsxs("button",{type:"button",onClick:P,disabled:I,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 font-medium shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",children:[r.jsx(Nx,{className:"h-4 w-4"}),"Prev"]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Page"," ",r.jsx("span",{className:"font-medium text-slate-900",children:x})," ","of ",k]}),r.jsxs("button",{type:"button",onClick:R,disabled:O,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 font-medium shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",children:["Next",r.jsx(Sf,{className:"h-4 w-4"})]})]})]})]})]})}const YN=10;function yxe(){const t=Zn(F=>F.user),[s,n]=y.useState([]),[a,i]=y.useState({}),[l,o]=y.useState({}),[c,d]=y.useState(!1),[u,f]=y.useState(""),[m,x]=y.useState(""),[b,w]=y.useState(1),j=F=>`ADM-${String(F).padStart(6,"0")}`,_=F=>F?F==="vacant"?"bg-emerald-50 text-emerald-700 border-emerald-200":F==="occupied"?"bg-rose-50 text-rose-700 border-rose-200":F==="reserved"?"bg-amber-50 text-amber-700 border-amber-200":F==="preoccupied"?"bg-sky-50 text-sky-700 border-sky-200":"bg-slate-50 text-slate-700 border-slate-200":"bg-slate-50 text-slate-700 border-slate-200",C=async()=>{var F,V;if(t!=null&&t.id){d(!0),f("");try{const[U,z]=await Promise.all([Fb({status:"admitted",practitioner_user_id:t.id}),rl()]),W=U.data||[],q=z.data||[];W.sort((ke,ee)=>new Date(ee.admitted_at||0)-new Date(ke.admitted_at||0)),n(W);const G={};for(const ke of q)G[ke.id]=ke;i(G);const se=[...new Set(W.map(ke=>ke.patient_id))].slice(0,100),ge={};await Promise.all(se.map(async ke=>{try{const{data:ee}=await $b(ke);ge[ke]=(ee==null?void 0:ee.uhid)||`P-${ke}`}catch{ge[ke]=`P-${ke}`}})),o(ge),w(1)}catch(U){console.error("MyAdmissions loadData error",U),f(((V=(F=U==null?void 0:U.response)==null?void 0:F.data)==null?void 0:V.detail)||"Failed to load your admissions. Please try again."),n([]),i({}),o({})}finally{d(!1)}}};y.useEffect(()=>{if(!(t!=null&&t.id))return;let F=!0;return(async()=>await C())(),()=>{F=!1}},[t==null?void 0:t.id]);const k=y.useMemo(()=>{const F=m.trim().toLowerCase();return F?s.filter(V=>{var q;const U=j(V.id).toLowerCase(),z=(l[V.patient_id]||`P-${V.patient_id}`).toLowerCase(),W=(((q=a[V.current_bed_id])==null?void 0:q.code)||"").toLowerCase();return U.includes(F)||z.includes(F)||W.includes(F)}):s},[s,m,l,a]),A=Math.max(1,Math.ceil(k.length/YN));y.useEffect(()=>{w(1)},[m,s]);const T=(b-1)*YN,P=k.slice(T,T+YN),R=()=>w(F=>Math.max(1,F-1)),I=()=>w(F=>Math.min(A,F+1)),O=b<=1||c,M=b>=A||c,B=s.length;if(!(t!=null&&t.id))return r.jsx("div",{className:"min-h-screen bg-slate-50 px-4 py-6 text-sm text-slate-700 md:px-6",children:r.jsx("div",{className:"mx-auto max-w-3xl rounded-2xl border border-slate-200 bg-white p-4 shadow-sm",children:"You are not logged in or your user information is missing. Please log in again to view your admissions."})});const L=(t==null?void 0:t.full_name)||(t==null?void 0:t.name)||(t==null?void 0:t.username)||(t==null?void 0:t.email)||"you";return r.jsxs("div",{className:"min-h-screen bg-slate-50 px-4 py-4 text-black md:px-6 md:py-6",children:[r.jsxs("div",{className:"mx-auto mb-4 flex max-w-6xl flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl font-semibold tracking-tight text-slate-900",children:"My Admissions"}),r.jsxs("p",{className:"mt-1 max-w-2xl text-sm text-slate-600",children:["This view shows all"," ",r.jsx("span",{className:"font-semibold",children:"active in-patient admissions"})," ","where ",r.jsx("span",{className:"font-semibold",children:L})," is set as the primary doctor / practitioner. Use it to quickly jump into your patients' admission detail screens for orders, notes, vitals and discharge planning."]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[r.jsx(on,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{className:"leading-tight",children:[r.jsx("span",{className:"font-medium text-slate-800",children:"Your in-patients"}),r.jsx("br",{}),"Assigned to you"]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[r.jsx(Jn,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{className:"leading-tight",children:[r.jsx("span",{className:"font-medium text-slate-800",children:"Bed overview"}),r.jsx("br",{}),"Ward / room / bed"]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[r.jsx(Xn,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{className:"leading-tight",children:[r.jsx("span",{className:"font-medium text-slate-800",children:"Admitted since"}),r.jsx("br",{}),"Length of stay"]})]})]})]}),r.jsxs("div",{className:"mx-auto max-w-6xl space-y-3",children:[r.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white p-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"w-full md:max-w-md",children:[r.jsxs("div",{className:"relative",children:[r.jsx(is,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),r.jsx("input",{className:"w-full rounded-2xl border border-slate-200 bg-white px-9 py-2 text-sm text-slate-900 placeholder:text-slate-400 outline-none transition focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Search by Admission no, UHID, Bed code",value:m,onChange:F=>x(F.target.value)})]}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Tip: Type an admission number (ADM-000123), UHID or bed code to quickly find a patient."})]}),r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 md:justify-end",children:[r.jsxs("div",{className:"text-xs text-slate-600",children:[r.jsx("span",{className:"font-semibold text-slate-900",children:k.length})," ","of ",B," active admissions assigned to you"]}),r.jsxs("button",{type:"button",onClick:C,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-60",disabled:c,children:[c?r.jsx(ss,{className:"h-3.5 w-3.5 animate-spin"}):r.jsx(Si,{className:"h-3.5 w-3.5"}),"Refresh"]})]})]}),u&&r.jsxs("div",{className:"flex items-start gap-2 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[r.jsx(yn,{className:"mt-0.5 h-4 w-4"}),r.jsx("span",{children:u})]}),c&&!s.length&&r.jsx("div",{className:"flex items-center justify-center rounded-2xl border border-slate-200 bg-white px-4 py-10 text-sm text-slate-600 shadow-sm",children:r.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 px-3 py-1.5 text-xs",children:[r.jsx(ss,{className:"h-4 w-4 animate-spin text-slate-500"}),"Loading your admissions"]})}),!c&&P.length===0&&r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-4 py-8 text-center text-sm text-slate-500 shadow-sm",children:"No active admissions assigned to you."}),!c&&P.length>0&&r.jsxs("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm",children:[r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-slate-50 text-xs text-slate-500",children:[r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Admission"}),r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Patient (UHID)"}),r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Bed"}),r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Admitted at"}),r.jsx("th",{className:"px-4 py-2 text-right font-medium",children:"Action"})]})}),r.jsx("tbody",{children:P.map(F=>{const V=a[F.current_bed_id],U=(V==null?void 0:V.code)||"",z=l[F.patient_id]||`P-${F.patient_id}`;return r.jsxs("tr",{className:"border-t text-sm hover:bg-slate-50",children:[r.jsx("td",{className:"px-4 py-2 align-middle text-slate-900",children:r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2.5 py-0.5 text-[11px] font-semibold tracking-wide text-slate-800",children:j(F.id)})}),r.jsx("td",{className:"px-4 py-2 align-middle text-slate-800",children:z}),r.jsxs("td",{className:"px-4 py-2 align-middle text-slate-800",children:[U,(V==null?void 0:V.state)&&r.jsx("span",{className:`ml-1 inline-flex items-center rounded-full border px-1.5 py-0.5 text-[10px] ${_(V.state)}`,children:V.state})]}),r.jsx("td",{className:"px-4 py-2 align-middle text-slate-700",children:F.admitted_at?new Date(F.admitted_at).toLocaleString():""}),r.jsx("td",{className:"px-4 py-2 align-middle text-right",children:r.jsx(nl,{to:`/ipd/admission/${F.id}`,state:{admission:F},className:"inline-flex items-center rounded-full bg-slate-900 px-3 py-1.5 text-xs font-semibold text-white shadow-sm transition hover:bg-slate-800",children:"Open"})})]},F.id)})})]})}),r.jsx("div",{className:"space-y-2 p-3 md:hidden",children:P.map(F=>{const V=a[F.current_bed_id],U=(V==null?void 0:V.code)||"",z=l[F.patient_id]||`P-${F.patient_id}`;return r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs shadow-sm",children:[r.jsxs("div",{className:"mb-1 flex items-center justify-between gap-2",children:[r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-900 px-2.5 py-0.5 text-[11px] font-semibold tracking-wide text-white",children:j(F.id)}),r.jsx(nl,{to:`/ipd/admission/${F.id}`,state:{admission:F},className:"inline-flex items-center rounded-full bg-slate-900 px-3 py-1 text-[11px] font-semibold text-white shadow-sm transition hover:bg-slate-800",children:"Open"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2 text-slate-800",children:[r.jsx(on,{className:"h-3.5 w-3.5 text-slate-500"}),r.jsx("span",{className:"font-medium",children:z})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-slate-800",children:[r.jsx(Jn,{className:"h-3.5 w-3.5 text-slate-500"}),r.jsx("span",{className:"font-medium",children:U}),(V==null?void 0:V.state)&&r.jsx("span",{className:`inline-flex items-center rounded-full border px-1.5 py-0.5 text-[10px] ${_(V.state)}`,children:V.state})]}),r.jsxs("div",{className:"flex items-start gap-2 text-slate-700",children:[r.jsx(Xn,{className:"mt-0.5 h-3.5 w-3.5 text-slate-500"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] text-slate-500",children:"Admitted at"}),r.jsx("div",{className:"text-[11px]",children:F.admitted_at?new Date(F.admitted_at).toLocaleString():""})]})]})]})]},F.id)})}),k.length>0&&r.jsxs("div",{className:"flex flex-col items-center justify-between gap-3 border-t border-slate-100 px-4 py-3 text-xs text-slate-600 sm:flex-row",children:[r.jsxs("button",{type:"button",onClick:R,disabled:O,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 font-medium shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",children:[r.jsx(Nx,{className:"h-4 w-4"}),"Prev"]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Page"," ",r.jsx("span",{className:"font-medium text-slate-900",children:b})," ","of ",A]}),r.jsxs("button",{type:"button",onClick:I,disabled:M,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 font-medium shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",children:["Next",r.jsx(Sf,{className:"h-4 w-4"})]})]})]})]})]})}const XN=10;function bxe(){const[t,s]=y.useState([]),[n,a]=y.useState({}),[i,l]=y.useState({}),[o,c]=y.useState(!1),[d,u]=y.useState(""),[f,m]=y.useState(""),[x,b]=y.useState(1),w=B=>`ADM-${String(B).padStart(6,"0")}`,j=async()=>{var B,L;c(!0),u("");try{const[F,V]=await Promise.all([Fb({status:"discharged"}),rl()]),U=F.data||[],z=V.data||[];U.sort((se,ge)=>new Date(ge.discharged_at||ge.admitted_at||0)-new Date(se.discharged_at||se.admitted_at||0)),s(U);const W={};for(const se of z)W[se.id]=se;a(W);const q=[...new Set(U.map(se=>se.patient_id))].slice(0,100),G={};await Promise.all(q.map(async se=>{try{const{data:ge}=await $b(se);G[se]=(ge==null?void 0:ge.uhid)||`P-${se}`}catch{G[se]=`P-${se}`}})),l(G),b(1)}catch(F){console.error("DischargedList loadData error",F),u(((L=(B=F==null?void 0:F.response)==null?void 0:B.data)==null?void 0:L.detail)||"Failed to load discharged admissions. Please try again."),s([]),a({}),l({})}finally{c(!1)}};y.useEffect(()=>{let B=!0;return(async()=>await j())(),()=>{B=!1}},[]);const _=y.useMemo(()=>{const B=f.trim().toLowerCase();return B?t.filter(L=>{var z;const F=w(L.id).toLowerCase(),V=(i[L.patient_id]||`P-${L.patient_id}`).toLowerCase(),U=(((z=n[L.current_bed_id])==null?void 0:z.code)||"").toLowerCase();return F.includes(B)||V.includes(B)||U.includes(B)}):t},[t,f,i,n]),C=Math.max(1,Math.ceil(_.length/XN));y.useEffect(()=>{b(1)},[f,t]);const k=(x-1)*XN,A=_.slice(k,k+XN),T=()=>b(B=>Math.max(1,B-1)),P=()=>b(B=>Math.min(C,B+1)),R=x<=1||o,I=x>=C||o,O=t.length,M=B=>B?B==="vacant"?"bg-emerald-50 text-emerald-700 border-emerald-200":B==="occupied"?"bg-rose-50 text-rose-700 border-rose-200":B==="reserved"?"bg-amber-50 text-amber-700 border-amber-200":B==="preoccupied"?"bg-sky-50 text-sky-700 border-sky-200":"bg-slate-50 text-slate-700 border-slate-200":"bg-slate-50 text-slate-700 border-slate-200";return r.jsxs("div",{className:"min-h-screen bg-slate-50 px-4 py-4 text-black md:px-6 md:py-6",children:[r.jsxs("div",{className:"mx-auto mb-4 flex max-w-6xl flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl font-semibold tracking-tight text-slate-900",children:"Discharged Patients"}),r.jsxs("p",{className:"mt-1 max-w-2xl text-sm text-slate-600",children:["This list shows all"," ",r.jsx("span",{className:"font-semibold",children:"completed in-patient admissions"})," ","that have been discharged. Use it for audit, reporting, medical record review, and follow-up planning. Search by admission number, patient UHID or bed code to quickly find a case."]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[r.jsx(on,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{className:"leading-tight",children:[r.jsx("span",{className:"font-medium text-slate-800",children:"Discharged IP"}),r.jsx("br",{}),"Completed stays"]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[r.jsx(Jn,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{className:"leading-tight",children:[r.jsx("span",{className:"font-medium text-slate-800",children:"Last bed"}),r.jsx("br",{}),"Ward / room / bed"]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[r.jsx(Xn,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{className:"leading-tight",children:[r.jsx("span",{className:"font-medium text-slate-800",children:"LOS view"}),r.jsx("br",{}),"Admit vs discharge"]})]})]})]}),r.jsxs("div",{className:"mx-auto max-w-6xl space-y-3",children:[r.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white p-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"w-full md:max-w-md",children:[r.jsxs("div",{className:"relative",children:[r.jsx(is,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),r.jsx("input",{className:"w-full rounded-2xl border border-slate-200 bg-white px-9 py-2 text-sm text-slate-900 placeholder:text-slate-400 outline-none transition focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Search by Admission no, UHID, Bed code",value:f,onChange:B=>m(B.target.value)})]}),r.jsxs("p",{className:"mt-1 text-[11px] text-slate-500",children:["Tip: Example search  ",r.jsx("span",{className:"font-mono",children:"ADM-000245"}),","," ","a UHID, or a bed code like"," ",r.jsx("span",{className:"font-mono",children:"IP-2B-05"}),"."]})]}),r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 md:justify-end",children:[r.jsxs("div",{className:"text-xs text-slate-600",children:[r.jsx("span",{className:"font-semibold text-slate-900",children:_.length})," ","of ",O," discharged admissions"]}),r.jsxs("button",{type:"button",onClick:j,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-60",disabled:o,children:[o?r.jsx(ss,{className:"h-3.5 w-3.5 animate-spin"}):r.jsx(Si,{className:"h-3.5 w-3.5"}),"Refresh"]})]})]}),d&&r.jsxs("div",{className:"flex items-start gap-2 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[r.jsx(yn,{className:"mt-0.5 h-4 w-4"}),r.jsx("span",{children:d})]}),o&&!t.length&&r.jsx("div",{className:"flex items-center justify-center rounded-2xl border border-slate-200 bg-white px-4 py-10 text-sm text-slate-600 shadow-sm",children:r.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 px-3 py-1.5 text-xs",children:[r.jsx(ss,{className:"h-4 w-4 animate-spin text-slate-500"}),"Loading discharged admissions"]})}),!o&&A.length===0&&r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-4 py-8 text-center text-sm text-slate-500 shadow-sm",children:"No discharged records found."}),!o&&A.length>0&&r.jsxs("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm",children:[r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-slate-50 text-xs text-slate-500",children:[r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Admission"}),r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Patient (UHID)"}),r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Bed"}),r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Admitted at"}),r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Status"})]})}),r.jsx("tbody",{children:A.map(B=>{const L=n[B.current_bed_id],F=(L==null?void 0:L.code)||"",V=i[B.patient_id]||`P-${B.patient_id}`;return r.jsxs("tr",{className:"border-t text-sm hover:bg-slate-50",children:[r.jsx("td",{className:"px-4 py-2 align-middle text-slate-900",children:r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2.5 py-0.5 text-[11px] font-semibold tracking-wide text-slate-800",children:w(B.id)})}),r.jsx("td",{className:"px-4 py-2 align-middle text-slate-800",children:V}),r.jsxs("td",{className:"px-4 py-2 align-middle text-slate-800",children:[F,(L==null?void 0:L.state)&&r.jsx("span",{className:`ml-1 inline-flex items-center rounded-full border px-1.5 py-0.5 text-[10px] ${M(L.state)}`,children:L.state})]}),r.jsx("td",{className:"px-4 py-2 align-middle text-slate-700",children:B.admitted_at?new Date(B.admitted_at).toLocaleString():""}),r.jsx("td",{className:"px-4 py-2 align-middle text-slate-700",children:r.jsx("span",{className:"inline-flex items-center rounded-full bg-emerald-50 px-2.5 py-0.5 text-[11px] font-semibold text-emerald-700",children:B.status||"discharged"})})]},B.id)})})]})}),r.jsx("div",{className:"space-y-2 p-3 md:hidden",children:A.map(B=>{const L=n[B.current_bed_id],F=(L==null?void 0:L.code)||"",V=i[B.patient_id]||`P-${B.patient_id}`;return r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs shadow-sm",children:[r.jsxs("div",{className:"mb-1 flex items-center justify-between gap-2",children:[r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-900 px-2.5 py-0.5 text-[11px] font-semibold tracking-wide text-white",children:w(B.id)}),r.jsx("span",{className:"inline-flex items-center rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] font-semibold text-emerald-700",children:B.status||"discharged"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2 text-slate-800",children:[r.jsx(on,{className:"h-3.5 w-3.5 text-slate-500"}),r.jsx("span",{className:"font-medium",children:V})]}),r.jsxs("div",{className:"flex items-center gap-2 text-slate-800",children:[r.jsx(Jn,{className:"h-3.5 w-3.5 text-slate-500"}),r.jsx("span",{className:"font-medium",children:F}),(L==null?void 0:L.state)&&r.jsx("span",{className:`inline-flex items-center rounded-full border px-1.5 py-0.5 text-[10px] ${M(L.state)}`,children:L.state})]}),r.jsxs("div",{className:"flex items-start gap-2 text-slate-700",children:[r.jsx(Xn,{className:"mt-0.5 h-3.5 w-3.5 text-slate-500"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] text-slate-500",children:"Admitted at"}),r.jsx("div",{className:"text-[11px]",children:B.admitted_at?new Date(B.admitted_at).toLocaleString():""})]})]})]})]},B.id)})}),_.length>0&&r.jsxs("div",{className:"flex flex-col items-center justify-between gap-3 border-t border-slate-100 px-4 py-3 text-xs text-slate-600 sm:flex-row",children:[r.jsxs("button",{type:"button",onClick:T,disabled:R,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 font-medium shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",children:[r.jsx(Nx,{className:"h-4 w-4"}),"Prev"]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Page"," ",r.jsx("span",{className:"font-medium text-slate-900",children:x})," ","of ",C]}),r.jsxs("button",{type:"button",onClick:P,disabled:I,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 font-medium shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",children:["Next",r.jsx(Sf,{className:"h-4 w-4"})]})]})]})]})]})}function vxe(){const[t,s]=y.useState([]),[n,a]=y.useState([]),[i,l]=y.useState([]),[o,c]=y.useState(!1),[d,u]=y.useState(""),[f,m]=y.useState(null),[x,b]=y.useState(""),[w,j]=y.useState(!1),[_,C]=y.useState(""),k=async()=>{var L,F;c(!0),u("");try{const[V,U,z]=await Promise.all([Bb(),kx(),rl()]);s(V.data||[]),a(U.data||[]),l(z.data||[])}catch(V){u(((F=(L=V==null?void 0:V.response)==null?void 0:L.data)==null?void 0:F.detail)||"Failed to load bedboard.")}finally{c(!1)}};y.useEffect(()=>{k()},[]);const A=y.useMemo(()=>{const L={};return n.forEach(F=>{var V;(L[V=F.ward_id]||(L[V]=[])).push(F)}),L},[n]),T=y.useMemo(()=>{const L={};return i.forEach(F=>{var V;(L[V=F.room_id]||(L[V]=[])).push(F)}),L},[i]),P=({s:L})=>{const F=L==="vacant"?"bg-emerald-50 text-emerald-700 border-emerald-200":L==="occupied"?"bg-rose-50 text-rose-700 border-rose-200":L==="reserved"?"bg-amber-50 text-amber-700 border-amber-200":L==="preoccupied"?"bg-sky-50 text-sky-700 border-sky-200":"bg-slate-50 text-slate-700 border-slate-200";return r.jsx("span",{className:`inline-flex items-center rounded-full border px-2 py-0.5 text-[11px] capitalize ${F}`,children:L||"unknown"})},R=L=>L==="vacant"?"border-emerald-200 bg-emerald-50/60":L==="occupied"?"border-rose-200 bg-rose-50/70":L==="reserved"?"border-amber-200 bg-amber-50/70":L==="preoccupied"?"border-sky-200 bg-sky-50/70":"border-slate-200 bg-white",I=(L,F,V)=>{m({id:L,code:F,action:V,dt:"",note:""}),C("")},O=async()=>{var L,F;if(f){if(C(""),f.action==="reserved"&&!f.dt){C('Please select a "Reserved until" date & time.');return}try{j(!0);const V={state:f.action};f.action==="reserved"&&(V.reserved_until=f.dt?f.dt.length===16?`${f.dt}:00`:f.dt:null),f.note&&(V.note=f.note),await Yce(f.id,V),m(null),await k()}catch(V){C(((F=(L=V==null?void 0:V.response)==null?void 0:L.data)==null?void 0:F.detail)||"Failed to update bed state.")}finally{j(!1)}}},M=x.trim().toLowerCase(),B=y.useMemo(()=>{if(!M)return t.map(F=>F.id);const L=new Set;return t.forEach(F=>{var W,q;const V=((W=F.code)==null?void 0:W.toLowerCase().includes(M))||((q=F.name)==null?void 0:q.toLowerCase().includes(M)),U=A[F.id]||[];let z=V;U.forEach(G=>{const se=String(G.number||"").toLowerCase().includes(M)||String(G.type||"").toLowerCase().includes(M),ke=(T[G.id]||[]).some(ee=>{var ue;const pe=(ee.state||"").toLowerCase();return((ue=ee.code)==null?void 0:ue.toLowerCase().includes(M))||pe.includes(M)});(se||ke)&&(z=!0)}),z&&L.add(F.id)}),Array.from(L)},[M,t,A,T]);return r.jsxs("div",{className:"min-h-screen bg-slate-50 px-4 py-4 text-black md:px-6 md:py-6",children:[r.jsxs("div",{className:"mx-auto mb-4 flex max-w-6xl flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl font-semibold tracking-tight text-slate-900",children:"Bedboard"}),r.jsxs("p",{className:"mt-1 max-w-2xl text-sm text-slate-600",children:["Live overview of ",r.jsx("span",{className:"font-semibold",children:"IPD bed occupancy"})," ","by ward and room. Colours help you quickly spot which beds are vacant, occupied, reserved or preoccupied. Use the quick actions to reserve or vacate beds in real time."]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[11px] md:grid-cols-4",children:[r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-emerald-200 bg-emerald-50 px-2.5 py-1.5 shadow-sm",children:[r.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-500"}),r.jsxs("span",{className:"leading-tight text-emerald-800",children:[r.jsx("span",{className:"font-semibold",children:"Vacant"}),r.jsx("br",{}),"Ready to allocate"]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-rose-200 bg-rose-50 px-2.5 py-1.5 shadow-sm",children:[r.jsx("span",{className:"h-2 w-2 rounded-full bg-rose-500"}),r.jsxs("span",{className:"leading-tight text-rose-800",children:[r.jsx("span",{className:"font-semibold",children:"Occupied"}),r.jsx("br",{}),"Patient in bed"]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-amber-200 bg-amber-50 px-2.5 py-1.5 shadow-sm",children:[r.jsx("span",{className:"h-2 w-2 rounded-full bg-amber-500"}),r.jsxs("span",{className:"leading-tight text-amber-800",children:[r.jsx("span",{className:"font-semibold",children:"Reserved"}),r.jsx("br",{}),"Booked for patient"]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-sky-200 bg-sky-50 px-2.5 py-1.5 shadow-sm",children:[r.jsx("span",{className:"h-2 w-2 rounded-full bg-sky-500"}),r.jsxs("span",{className:"leading-tight text-sky-800",children:[r.jsx("span",{className:"font-semibold",children:"Preoccupied"}),r.jsx("br",{}),"Pending admission"]})]})]})]}),r.jsxs("div",{className:"mx-auto max-w-6xl space-y-4",children:[r.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white p-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"w-full md:max-w-md",children:[r.jsxs("div",{className:"relative",children:[r.jsx(is,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),r.jsx("input",{className:"w-full rounded-2xl border border-slate-200 bg-white px-9 py-2 text-sm text-slate-900 placeholder:text-slate-400 outline-none transition focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Search by ward, room, bed code or state (vacant, occupied, reserved)",value:x,onChange:L=>b(L.target.value)})]}),r.jsxs("p",{className:"mt-1 text-[11px] text-slate-500",children:["Example: type ",r.jsx("span",{className:"font-mono",children:"VACANT"}),", ward code like"," ",r.jsx("span",{className:"font-mono",children:"W1"}),", or bed code like"," ",r.jsx("span",{className:"font-mono",children:"B-102"}),"."]})]}),r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 md:justify-end",children:[r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-slate-50 px-3 py-1.5 text-[11px] text-slate-700",children:[r.jsx(Jn,{className:"h-3.5 w-3.5 text-slate-500"}),r.jsxs("span",{children:["Total beds:"," ",r.jsx("span",{className:"font-semibold text-slate-900",children:i.length})]})]}),r.jsxs("button",{type:"button",onClick:k,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-60",disabled:o,children:[o?r.jsx(ss,{className:"h-3.5 w-3.5 animate-spin"}):r.jsx(Si,{className:"h-3.5 w-3.5"}),"Refresh"]})]})]}),d&&r.jsxs("div",{className:"flex items-start gap-2 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[r.jsx(yn,{className:"mt-0.5 h-4 w-4"}),r.jsx("span",{children:d})]}),o&&!i.length&&r.jsx("div",{className:"flex items-center justify-center rounded-2xl border border-slate-200 bg-white px-4 py-10 text-sm text-slate-600 shadow-sm",children:r.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 px-3 py-1.5 text-xs",children:[r.jsx(ss,{className:"h-4 w-4 animate-spin text-slate-500"}),"Loading bedboard"]})}),!o&&r.jsxs("div",{className:"space-y-4",children:[t.filter(L=>B.includes(L.id)).map(L=>r.jsxs("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm",children:[r.jsxs("div",{className:"flex items-center gap-2 border-b border-slate-100 bg-slate-50 px-3 py-2 text-sm font-semibold text-slate-900",children:[r.jsx(ra,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{children:[L.code,"  ",L.name]})]}),(A[L.id]||[]).length===0?r.jsx("div",{className:"px-3 py-3 text-sm text-slate-500",children:"No rooms configured for this ward."}):(A[L.id]||[]).map(F=>{var U;const V=(T[F.id]||[]).filter(z=>{var q;if(!M)return!0;const W=(z.state||"").toLowerCase();return((q=z.code)==null?void 0:q.toLowerCase().includes(M))||W.includes(M)});return!V.length&&M&&!(String(F.number||"").toLowerCase().includes(M)||String(F.type||"").toLowerCase().includes(M))?null:r.jsxs("div",{className:"border-t border-slate-100 px-3 py-3",children:[r.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2 text-xs text-slate-600",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(f7,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsxs("span",{className:"font-medium",children:["Room ",F.number]}),r.jsxs("span",{className:"text-[11px] text-slate-500",children:[" ",F.type]})]}),r.jsxs("span",{className:"text-[11px] text-slate-500",children:["Beds: ",((U=T[F.id])==null?void 0:U.length)||0]})]}),V.length===0?r.jsx("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 px-3 py-3 text-xs text-slate-500",children:"No beds match your search in this room."}):r.jsx("div",{className:"flex flex-wrap gap-2",children:V.map(z=>r.jsxs("div",{className:`flex w-full flex-col justify-between rounded-2xl border px-3 py-2 text-xs shadow-sm transition hover:-translate-y-0.5 hover:shadow-md sm:w-[calc(50%-0.25rem)] lg:w-[calc(25%-0.375rem)] ${R(z.state)}`,children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("div",{className:"font-semibold text-slate-900",children:z.code}),r.jsx(P,{s:z.state})]}),z.note&&r.jsx("div",{className:"mt-1 text-[11px] text-slate-600 line-clamp-2",children:z.note}),z.reserved_until&&r.jsxs("div",{className:"mt-1 text-[11px] text-slate-500",children:["Reserved until:"," ",new Date(z.reserved_until).toLocaleString()]}),r.jsxs("div",{className:"mt-2 flex flex-wrap gap-1.5",children:[r.jsx("button",{type:"button",className:"inline-flex flex-1 items-center justify-center rounded-full bg-amber-50 px-2 py-1 text-[11px] font-medium text-amber-800 ring-1 ring-amber-200 hover:bg-amber-100",onClick:()=>I(z.id,z.code,"reserved"),children:"Reserve"}),r.jsx("button",{type:"button",className:"inline-flex flex-1 items-center justify-center rounded-full bg-sky-50 px-2 py-1 text-[11px] font-medium text-sky-800 ring-1 ring-sky-200 hover:bg-sky-100",onClick:()=>I(z.id,z.code,"preoccupied"),children:"Preoccupy"}),r.jsx("button",{type:"button",className:"inline-flex flex-1 items-center justify-center rounded-full bg-emerald-50 px-2 py-1 text-[11px] font-medium text-emerald-800 ring-1 ring-emerald-200 hover:bg-emerald-100",onClick:()=>I(z.id,z.code,"vacant"),children:"Vacate"})]})]},z.id))})]},F.id)})]},L.id)),!o&&B.length===0&&r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-4 py-8 text-center text-sm text-slate-500 shadow-sm",children:"No beds match your search. Try clearing the filter or searching with a different ward, room or bed code."})]})]}),f&&r.jsx("div",{className:"fixed inset-0 z-50 grid place-items-center bg-black/40 px-4",children:r.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white p-4 text-sm shadow-xl",children:[r.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Update bed state"}),r.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:[f.code,"  ",f.action]})]}),r.jsx(P,{s:f.action})]}),f.action==="reserved"&&r.jsxs("div",{className:"mt-2 space-y-1",children:[r.jsx("label",{className:"text-xs text-slate-500",children:"Reserved until"}),r.jsx("input",{type:"datetime-local",className:"input w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:f.dt,onChange:L=>m(F=>({...F,dt:L.target.value}))})]}),r.jsxs("div",{className:"mt-3 space-y-1",children:[r.jsx("label",{className:"text-xs text-slate-500",children:"Note (optional)"}),r.jsx("input",{className:"input w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Reason for change, patient reference, etc.",value:f.note,onChange:L=>m(F=>({...F,note:L.target.value}))})]}),_&&r.jsxs("div",{className:"mt-2 flex items-start gap-2 rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[r.jsx(yn,{className:"mt-0.5 h-4 w-4"}),r.jsx("span",{children:_})]}),r.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[r.jsx("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full bg-slate-100 px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-200",onClick:()=>m(null),disabled:w,children:"Cancel"}),r.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full bg-slate-900 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-slate-800 disabled:cursor-not-allowed disabled:opacity-60",onClick:O,disabled:w,children:[w?r.jsx(ss,{className:"h-3.5 w-3.5 animate-spin"}):r.jsx(Ur,{className:"h-3.5 w-3.5"}),"Save"]})]})]})})]})}const i$=({q:t="",active:s,page:n=1,page_size:a=50}={})=>J.get("/masters/lab-tests",{params:{q:t,active:s,page:n,page_size:a}}),wxe=t=>J.post("/masters/lab-tests",t),Nxe=(t,s)=>J.put(`/masters/lab-tests/${t}`,s),jxe=t=>J.delete(`/masters/lab-tests/${t}`),_xe=({patient_id:t,context_type:s=null,context_id:n=null,priority:a="routine",test_ids:i=[]})=>{const l=(i||[]).map(o=>({test_id:o}));return J.post("/lab/orders",{patient_id:t,context_type:s,context_id:n,priority:a,items:l})},Sxe=(t={})=>J.get("/lab/orders",{params:t}),Cxe=t=>J.get(`/lab/orders/${t}`),kxe=t=>J.post(`/lab/orders/${t}/finalize`);function Axe(t={}){return J.get("/lis/masters/departments",{params:t})}function Exe(t,{department_id:s,sub_department_id:n}={}){const a={department_id:s};return n&&(a.sub_department_id=n),J.get(`/lab/orders/${t}/panel`,{params:a})}function Txe(t,s){return J.post(`/lab/orders/${t}/panel/results`,s)}function Pxe(t){return J.get(`/lab/orders/${t}/report-data`)}function zp({patient:t,patientId:s,className:n=""}){const[a,i]=y.useState(t||null);y.useEffect(()=>{let u=!1;return!t&&s&&(async()=>{try{const{data:f}=await J.get(`/patients/${s}`);u||i(f)}catch{}})(),()=>{u=!0}},[t,s]);const l=(a==null?void 0:a.uhid)||"",o=(a==null?void 0:a.name)||(a!=null&&a.first_name?`${a.first_name} ${a.last_name||""}`.trim():""),c=a!=null&&a.id?`/patients?focus=${a.id}`:void 0,d=r.jsxs("span",{className:["inline-flex items-center gap-2 rounded-md border px-2 py-0.5 text-xs","bg-gray-50 border-gray-200 text-gray-700","max-w-[18rem]",n].join(" "),title:o!==""?o:void 0,children:[r.jsx("span",{className:"font-medium",children:l}),r.jsx("span",{className:"text-gray-400",children:""}),r.jsx("span",{className:"truncate",children:o})]});return c?r.jsx(nl,{to:c,children:d}):d}const Ixe=t=>t?new Date(t).toLocaleString():"",Mxe=t=>t?`LAB-${String(t).padStart(6,"0")}`:"";function Dxe(){const{id:t}=sd(),s=Ta(),[n,a]=y.useState(!1),[i,l]=y.useState(null),[o,c]=y.useState([]),[d,u]=y.useState([]),[f,m]=y.useState([]),[x,b]=y.useState(!1),w=y.useMemo(()=>i?Mxe(i.id):"",[i]),j=async()=>{a(!0);try{const{data:B}=await Cxe(t);l(B)}catch(B){console.error(B),ie.error("Failed to load order")}finally{a(!1)}},_=async()=>{try{const{data:B}=await Axe({active_only:!0}),L=Array.isArray(B)?B:(B==null?void 0:B.items)||[];c(L)}catch(B){console.error(B),ie.error("Failed to load lab departments")}};y.useEffect(()=>{j(),_()},[t]);const C=y.useMemo(()=>{const B=o.filter(F=>!F.parent_id),L={};return o.forEach(F=>{F.parent_id&&(L[F.parent_id]||(L[F.parent_id]=[]),L[F.parent_id].push(F))}),B.map(F=>({...F,children:L[F.id]||[]}))},[o]),k=y.useMemo(()=>i?(i.status||"").toLowerCase()!=="reported":!1,[i]),A=async()=>{var B,L;try{await kxe(t),ie.success("Report finalized"),j()}catch(F){console.error(F),ie.error(((L=(B=F==null?void 0:F.response)==null?void 0:B.data)==null?void 0:L.detail)||"Finalize failed")}},T=()=>{s(`/lab/orders/${t}/print`)},P=(B,L=null)=>{const F=`${B}::${L||"root"}`;return d.some(V=>V.key===F)},R=(B,L=null,F="",V=null)=>{const U=`${B}::${L||"root"}`;u(z=>z.some(q=>q.key===U)?z.filter(q=>q.key!==U):[...z,{key:U,department_id:B,department_name:F,sub_department_id:L,sub_department_name:V}])},I=async()=>{var B,L;if(!d.length){ie.error("Select at least one Department / Panel");return}b(!0);try{const F=d.map(z=>Exe(t,{department_id:z.department_id,sub_department_id:z.sub_department_id||void 0}).then(W=>({panel:z,rows:Array.isArray(W.data)?W.data:[]}))),U=(await Promise.all(F)).map(({panel:z,rows:W})=>({key:z.key,department_id:z.department_id,department_name:z.department_name,sub_department_id:z.sub_department_id,sub_department_name:z.sub_department_name,rows:W.map(q=>({...q,result_value:q.result_value??"",flag:q.flag??"",comments:q.comments??""}))}));m(U)}catch(F){console.error(F),ie.error(((L=(B=F==null?void 0:F.response)==null?void 0:B.data)==null?void 0:L.detail)||"Failed to load panel services")}finally{b(!1)}},O=(B,L,F)=>{m(V=>V.map(U=>U.key!==B?U:{...U,rows:U.rows.map((z,W)=>W===L?{...z,...F}:z)}))},M=async()=>{var B,L;if(!f.length){ie.error("No panel rows loaded");return}try{for(const F of f){if(!F.rows.length)continue;const V={department_id:Number(F.department_id),sub_department_id:F.sub_department_id?Number(F.sub_department_id):null,results:F.rows.map(U=>({service_id:U.service_id,result_value:U.result_value??"",flag:U.flag||null,comments:U.comments||null}))};await Txe(Number(t),V)}ie.success("Panel results saved"),j()}catch(F){console.error(F),ie.error(((L=(B=F==null?void 0:F.response)==null?void 0:B.data)==null?void 0:L.detail)||"Failed to save panel results")}};return n&&!i?r.jsx("div",{className:"p-6",children:"Loading"}):i?r.jsxs("div",{className:"p-3 md:p-6 space-y-6 text-black",children:[r.jsxs("header",{className:"flex flex-wrap items-start justify-between gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("h1",{className:"text-lg md:text-xl font-semibold",children:["Lab Order ",w]}),r.jsxs("div",{className:"text-xs text-gray-500 flex flex-wrap items-center gap-2",children:[r.jsx(zp,{patient:i==null?void 0:i.patient,patientId:i==null?void 0:i.patient_id,className:"border-blue-100 bg-blue-50"}),r.jsxs("span",{children:[" Created: ",Ixe(i.created_at||i.createdAt)]})]}),r.jsxs("div",{className:"text-xs text-gray-500",children:["Priority:"," ",r.jsx("span",{className:"capitalize font-medium",children:i.priority||"routine"})," "," Status:"," ",r.jsx("span",{className:"uppercase font-semibold",children:i.status||"ORDERED"})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("button",{className:"btn-ghost flex items-center gap-1 text-xs md:text-sm",onClick:T,children:[r.jsx(tl,{className:"h-4 w-4"}),"View / Print Report"]}),r.jsx(gn,{anyOf:["lab.results.report","lab.results.enter","lab.results.approve"],children:r.jsxs("button",{className:"btn",disabled:!k,onClick:A,children:[r.jsx(b3,{className:"h-4 w-4 mr-2"})," Finalize"]})})]})]}),r.jsxs("section",{className:"rounded-xl border bg-white overflow-hidden",children:[r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 p-4 border-b",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(m7,{className:"h-4 w-4 text-gray-500"}),r.jsxs("div",{children:[r.jsx("h2",{className:"font-semibold text-sm md:text-base",children:"Result Entry (Multi Department / Panel)"}),r.jsx("p",{className:"text-[11px] text-gray-500",children:"Select department/panel, enter all values, save, then finalize."})]})]}),r.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[r.jsxs("button",{className:"btn-ghost flex items-center gap-1",onClick:I,children:[r.jsx($te,{className:"h-4 w-4"}),"Start Entry"]}),r.jsx(gn,{anyOf:["lab.results.enter"],children:r.jsx("button",{className:"btn",onClick:M,disabled:!f.length,children:"Save Panel Results"})})]})]}),r.jsxs("div",{className:"p-4 border-b bg-slate-50",children:[r.jsx("h3",{className:"text-sm font-medium mb-1",children:"Select Departments & Panels"}),r.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Tick one or more Departments / Sub-Departments. All selected tests will appear below, grouped heading-wise."}),r.jsxs("div",{className:"max-h-64 overflow-y-auto rounded-lg border bg-white p-3 space-y-2",children:[C.length===0&&r.jsx("div",{className:"text-xs text-gray-400",children:"No lab departments configured."}),C.map(B=>r.jsxs("div",{className:"border rounded-lg p-2 bg-slate-50/60",children:[r.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:[r.jsx("input",{type:"checkbox",checked:P(B.id,null),onChange:()=>R(B.id,null,B.name,null)}),r.jsx("span",{children:B.name}),r.jsx("span",{className:"text-[11px] text-gray-400",children:"(All tests in this department)"})]}),!!B.children.length&&r.jsx("div",{className:"mt-2 pl-4 space-y-1",children:B.children.map(L=>r.jsxs("label",{className:"flex items-center gap-2 text-xs text-slate-700",children:[r.jsx("input",{type:"checkbox",checked:P(B.id,L.id),onChange:()=>R(B.id,L.id,B.name,L.name)}),r.jsx("span",{children:L.name})]},L.id))})]},B.id))]}),r.jsxs("div",{className:"mt-2 text-[11px] text-gray-500",children:["Selected panels:"," ",r.jsx("span",{className:"font-semibold",children:d.length||0})]})]}),x&&r.jsx("div",{className:"px-4 py-6 text-center text-sm text-gray-500",children:"Loading selected panels"}),!x&&f.length===0&&r.jsxs("div",{className:"px-4 py-6 text-center text-xs text-gray-400",children:["Select one or more Departments / Panels above and click"," ",r.jsx("span",{className:"font-medium",children:"Start Entry"})," to load tests."]}),!x&&f.map(B=>r.jsxs("div",{className:"border-t",children:[r.jsxs("div",{className:"bg-slate-100 px-3 py-2 text-xs font-semibold text-slate-700",children:[B.department_name,B.sub_department_name?` / ${B.sub_department_name}`:""]}),r.jsxs("div",{className:"md:hidden p-3 space-y-2",children:[B.rows.length===0&&r.jsx("div",{className:"text-xs text-gray-400",children:"No services configured for this panel."}),B.rows.map((L,F)=>r.jsxs("div",{className:"border rounded-lg p-2 space-y-1 bg-white",children:[r.jsx("div",{className:"text-xs font-semibold",children:L.service_name}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[11px] text-gray-600",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-[10px] uppercase text-gray-400",children:"Result"}),r.jsx("input",{className:"input h-7 text-xs",value:L.result_value,onChange:V=>O(B.key,F,{result_value:V.target.value})})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[10px] uppercase text-gray-400",children:"Flag"}),r.jsx("input",{className:"input h-7 text-xs",placeholder:"H/L/N",value:L.flag||"",onChange:V=>O(B.key,F,{flag:V.target.value.toUpperCase()})})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-[10px] uppercase text-gray-400",children:"Unit"}),r.jsx("div",{className:"text-[11px]",children:L.unit||""})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[10px] uppercase text-gray-400",children:"Normal Range"}),r.jsx("div",{className:"text-[11px]",children:L.normal_range||""})]})]})]}),r.jsxs("div",{className:"mt-1",children:[r.jsx("div",{className:"text-[10px] uppercase text-gray-400",children:"Comments"}),r.jsx("input",{className:"input h-7 text-xs",placeholder:"Comments",value:L.comments||"",onChange:V=>O(B.key,F,{comments:V.target.value})})]})]},L.service_id))]}),r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-gray-50 text-gray-600",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left",children:"Service"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Result"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Unit"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Normal Range"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Flag"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Comments"})]})}),r.jsxs("tbody",{children:[B.rows.map((L,F)=>r.jsxs("tr",{className:"border-t hover:bg-slate-50/80",children:[r.jsx("td",{className:"px-3 py-2",children:r.jsx("div",{className:"font-medium",children:L.service_name})}),r.jsx("td",{className:"px-3 py-2",children:r.jsx("input",{className:"input",value:L.result_value,onChange:V=>O(B.key,F,{result_value:V.target.value})})}),r.jsx("td",{className:"px-3 py-2 text-xs text-gray-600",children:L.unit||""}),r.jsx("td",{className:"px-3 py-2 text-xs text-gray-600",children:L.normal_range||""}),r.jsx("td",{className:"px-3 py-2",children:r.jsx("input",{className:"input",placeholder:"Flag (H/L/N)",value:L.flag||"",onChange:V=>O(B.key,F,{flag:V.target.value.toUpperCase()})})}),r.jsx("td",{className:"px-3 py-2",children:r.jsx("input",{className:"input",placeholder:"Comments",value:L.comments||"",onChange:V=>O(B.key,F,{comments:V.target.value})})})]},L.service_id)),B.rows.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-3 py-4 text-center text-xs text-gray-400",children:"No services configured for this panel."})})]})]})})]},B.key))]})]}):r.jsx("div",{className:"p-6",children:"Order not found"})}function Oxe(){const[t,s]=y.useState(""),[n,a]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(null),[d,u]=y.useState(!1),f=async()=>{l(!0);try{const{data:_}=await i$({q:t,page_size:200});a(_||[])}catch{ie.error("Failed to load tests")}finally{l(!1)}};y.useEffect(()=>{f()},[t]);const m=()=>{c({code:"",name:"",price:0,is_active:!0}),u(!0)},x=_=>{c({..._}),u(!0)},b=async()=>{var _,C;try{o!=null&&o.id?(await Nxe(o.id,o),ie.success("Updated")):(await wxe(o),ie.success("Created")),u(!1),f()}catch(k){ie.error(((C=(_=k==null?void 0:k.response)==null?void 0:_.data)==null?void 0:C.detail)||"Save failed")}},w=async _=>{if(confirm("Delete this test?"))try{await jxe(_),ie.success("Deleted"),f()}catch{ie.error("Delete failed")}},j=y.useMemo(()=>n.length,[n]);return r.jsxs("div",{className:"p-4 md:p-6 text-black",children:[r.jsxs("header",{className:"mb-4 flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl font-semibold",children:"Lab Masters"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Manage NABL-friendly test catalogue"})]}),r.jsx(gn,{anyOf:["lab.masters.manage","masters.lab.manage"],children:r.jsxs("button",{className:"btn-primary",onClick:m,children:[r.jsx(us,{className:"h-4 w-4 mr-2"})," New Test"]})})]}),r.jsx("div",{className:"mb-3",children:r.jsxs("div",{className:"relative max-w-md",children:[r.jsx(is,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),r.jsx("input",{className:"input pl-9",placeholder:"Search code/name",value:t,onChange:_=>s(_.target.value)})]})}),r.jsx("div",{className:"rounded-xl border bg-white",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-gray-50 text-gray-600",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left",children:"Code"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Name"}),r.jsx("th",{className:"px-3 py-2 text-right",children:"Price"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Active"}),r.jsx("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[i&&r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-3",colSpan:5,children:"Loading"})}),!i&&n.map(_=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-3 py-2",children:_.code}),r.jsx("td",{className:"px-3 py-2",children:_.name}),r.jsxs("td",{className:"px-3 py-2 text-right",children:["",Number(_.price||0).toFixed(2)]}),r.jsx("td",{className:"px-3 py-2",children:_.is_active?"Yes":"No"}),r.jsx("td",{className:"px-3 py-2 text-right",children:r.jsxs(gn,{anyOf:["lab.masters.manage","masters.lab.manage"],children:[r.jsx("button",{className:"btn-ghost mr-2",onClick:()=>x(_),children:r.jsx(Ja,{className:"h-4 w-4"})}),r.jsx("button",{className:"btn-ghost text-red-600",onClick:()=>w(_.id),children:r.jsx(qr,{className:"h-4 w-4"})})]})})]},_.id)),!i&&n.length===0&&r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-6 text-center text-gray-500",colSpan:5,children:"No tests"})})]}),r.jsx("tfoot",{children:r.jsx("tr",{children:r.jsxs("td",{className:"px-3 py-2 text-xs text-gray-500",colSpan:5,children:["Total: ",j]})})})]})}),d&&r.jsxs("div",{className:"fixed inset-0 z-40",children:[r.jsx("div",{className:"absolute inset-0 bg-black/30",onClick:()=>u(!1)}),r.jsxs("div",{className:"absolute right-0 top-0 h-full w-full max-w-md bg-white shadow-xl p-4 overflow-y-auto",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4",children:o!=null&&o.id?"Edit Test":"New Test"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-sm",children:"Code"}),r.jsx("input",{className:"input",value:(o==null?void 0:o.code)||"",onChange:_=>c(C=>({...C,code:_.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm",children:"Name"}),r.jsx("input",{className:"input",value:(o==null?void 0:o.name)||"",onChange:_=>c(C=>({...C,name:_.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm",children:"Price"}),r.jsx("input",{type:"number",step:"0.01",className:"input",value:(o==null?void 0:o.price)??0,onChange:_=>c(C=>({...C,price:parseFloat(_.target.value||0)}))})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{id:"active",type:"checkbox",checked:!!(o!=null&&o.is_active),onChange:_=>c(C=>({...C,is_active:_.target.checked}))}),r.jsx("label",{htmlFor:"active",className:"text-sm",children:"Active"})]}),r.jsxs("div",{className:"flex justify-end gap-2 pt-3",children:[r.jsx("button",{className:"btn-ghost",onClick:()=>u(!1),children:"Cancel"}),r.jsx("button",{className:"btn-primary",onClick:b,children:"Save"})]})]})]})]})]})}const l$=({q:t="",active:s,page:n=1,page_size:a=50}={})=>J.get("/ris/masters/tests",{params:{q:t,active:s,page:n,page_size:a}}),Rxe=t=>J.post("/ris/masters/tests",t),Lxe=(t,s)=>J.put(`/ris/masters/tests/${t}`,s),Bxe=t=>J.delete(`/ris/masters/tests/${t}`),Fxe=({patient_id:t,test_id:s,context_type:n=null,context_id:a=null,ordering_user_id:i=null,priority:l="routine"})=>J.post("/ris/orders",{patient_id:t,test_id:s,context_type:n,context_id:a,ordering_user_id:i,priority:l}),$xe=(t={})=>J.get("/ris/orders",{params:t}),zxe=t=>J.get(`/ris/orders/${t}`),Uxe=(t,{scheduled_at:s})=>J.post(`/ris/orders/${t}/schedule`,{scheduled_at:s}),Vxe=t=>J.post(`/ris/orders/${t}/scan`),Hxe=(t,{report_text:s})=>J.post(`/ris/orders/${t}/report`,{report_text:s}),Wxe=(t,{report_text:s})=>J.put(`/ris/orders/${t}/report`,{report_text:s}),qxe=t=>J.post(`/ris/orders/${t}/approve`),Gxe=(t,s,n="")=>J.post(`/ris/attachments/${t}`,{file_url:s,note:n}),Kxe=(t,s)=>{const n=new FormData;return n.append("file",s),J.post(`/ris/orders/${t}/upload`,n,{headers:{"Content-Type":"multipart/form-data"}})};function wk({order:t,to:s,className:n="",prefix:a="LAB"}){const i=new Date((t==null?void 0:t.created_at)||(t==null?void 0:t.createdAt)||Date.now()),l=i.toISOString().slice(2,7).replace("-",""),o=Number((t==null?void 0:t.id)||0).toString(36).toUpperCase().padStart(3,"0"),c=`${a}-${l}-${o}`,d=(t==null?void 0:t.accession_no)||c,u=r.jsx("span",{className:["inline-flex items-center rounded-md border px-2 py-0.5 text-xs font-medium","bg-blue-50 border-blue-200 text-blue-700",n].join(" "),title:`Created ${i.toLocaleString()}`,children:d});return s?r.jsx(nl,{to:s,children:u}):u}function Gy({status:t}){const s=String(t||"ordered").toLowerCase(),a={ordered:"bg-amber-50 text-amber-700 border-amber-200",collected:"bg-blue-50 text-blue-700 border-blue-200",validated:"bg-purple-50 text-purple-700 border-purple-200",reported:"bg-emerald-50 text-emerald-700 border-emerald-200",cancelled:"bg-rose-50 text-rose-700 border-rose-200"}[s]||"bg-gray-50 text-gray-700 border-gray-200";return r.jsx("span",{className:`inline-flex items-center rounded-md border px-2 py-0.5 text-xs font-medium ${a}`,children:s.charAt(0).toUpperCase()+s.slice(1)})}function o$({modality:t}){const s=String(t||"").toUpperCase(),a={XR:"bg-sky-50 text-sky-700 border-sky-200",CT:"bg-purple-50 text-purple-700 border-purple-200",MRI:"bg-indigo-50 text-indigo-700 border-indigo-200",USG:"bg-emerald-50 text-emerald-700 border-emerald-200",MAMMO:"bg-rose-50 text-rose-700 border-rose-200"}[s]||"bg-gray-50 text-gray-700 border-gray-200";return r.jsx("span",{className:`inline-flex items-center rounded-md border px-2 py-0.5 text-xs font-medium ${a}`,children:s||""})}function Zb({value:t,onChange:s,label:n="Patient"}){const[a,i]=y.useState(""),[l,o]=y.useState([]),[c,d]=y.useState(!1),[u,f]=y.useState(null);y.useEffect(()=>{let x=!0;if(!a){o([]);return}return d(!0),ak(a).then(b=>{x&&o(b.data||[])}).catch(()=>{x&&o([])}).finally(()=>{x&&d(!1)}),()=>{x=!1}},[a]),y.useEffect(()=>{if(!t){f(null);return}const x=l.find(b=>b.id===t);x&&f(x)},[t,l]);const m=x=>{f(x),i(""),o([]),s==null||s(x.id,x)};return r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:n}),r.jsx("input",{className:"input",placeholder:"Search by name / UHID / phone",value:a,onChange:x=>i(x.target.value)}),c&&r.jsx("div",{className:"text-xs text-slate-500",children:"Searching"}),l.length>0&&r.jsx("div",{className:"max-h-48 overflow-auto rounded-xl border bg-white text-sm",children:l.map(x=>r.jsx("button",{type:"button",onClick:()=>m(x),className:"flex w-full items-center justify-between px-3 py-2 text-left hover:bg-slate-50",children:r.jsxs("div",{children:[r.jsxs("div",{className:"font-medium",children:[x.first_name," ",x.last_name]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID: ",x.uhid,"  ",x.phone]})]})},x.id))}),u&&r.jsxs("div",{className:"rounded-xl border bg-slate-50 px-3 py-2 text-xs text-slate-700",children:["Selected:"," ",r.jsxs("span",{className:"font-semibold",children:[u.first_name," ",u.last_name]})," "," UHID ",u.uhid,"  ",u.phone]})]})}function Yxe({onClose:t,onCreated:s}){const[n,a]=y.useState(null),[i,l]=y.useState([]),[o,c]=y.useState(""),[d,u]=y.useState(!1),[f,m]=y.useState("routine"),[x,b]=y.useState("");y.useEffect(()=>{let j=!1;return(async()=>{const{data:C}=await l$({q:o});j||l(Array.isArray(C)?C:(C==null?void 0:C.items)||[])})(),()=>{j=!0}},[o]);const w=async()=>{var j,_;if(!n)return ie.error("Select a patient");if(!x)return ie.error("Select a test");u(!0);try{const{data:C}=await Fxe({patient_id:n,test_id:Number(x),priority:f});ie.success(`Order #${C==null?void 0:C.id} created`),s==null||s(C),t==null||t()}catch(C){ie.error(((_=(j=C==null?void 0:C.response)==null?void 0:j.data)==null?void 0:_.detail)||"Failed to create order")}finally{u(!1)}};return r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Create Radiology Order"}),r.jsx(Zb,{value:n,onChange:a}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"md:col-span-2 space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:"Test"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{className:"input",placeholder:"Search tests",value:o,onChange:j=>c(j.target.value)}),r.jsxs("select",{className:"input",value:x,onChange:j=>b(j.target.value),children:[r.jsx("option",{value:"",children:"Select"}),i.map(j=>r.jsxs("option",{value:j.id,children:[j.code,"  ",j.name," ",j.modality?`(${j.modality})`:""]},j.id))]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:"Priority"}),r.jsxs("select",{className:"input",value:f,onChange:j=>m(j.target.value),children:[r.jsx("option",{value:"routine",children:"Routine"}),r.jsx("option",{value:"urgent",children:"Urgent"}),r.jsx("option",{value:"stat",children:"STAT"})]})]})]}),r.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[r.jsx("button",{className:"btn-ghost",onClick:t,children:"Cancel"}),r.jsx("button",{className:"btn",onClick:w,disabled:d,children:d?"Creating":"Create Order"})]})]})}function Xxe({open:t,onClose:s,children:n}){return t?r.jsxs("div",{className:"fixed inset-0 z-[100] grid place-items-center bg-black/40 p-4",children:[r.jsx("div",{className:"w-full max-w-3xl rounded-2xl bg-white p-4 shadow-2xl",children:n}),r.jsx("button",{className:"absolute inset-0 -z-10",onClick:s,"aria-label":"Close"})]}):null}function Qxe(){const[t,s]=y.useState([]),[n,a]=y.useState(!0),[i,l]=y.useState(""),[o,c]=y.useState(!1);return y.useEffect(()=>{let d=!1;return(async()=>{var f,m;a(!0);try{const{data:x}=await $xe({q:i});d||s(Array.isArray(x)?x:[])}catch(x){ie.error(((m=(f=x==null?void 0:x.response)==null?void 0:f.data)==null?void 0:m.detail)||"Failed to load orders")}finally{d||a(!1)}})(),()=>{d=!0}},[i]),r.jsxs("div",{className:"space-y-5 text-black",children:[r.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl font-semibold",children:"Radiology Orders"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Book, track, scan and report."})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{className:"input w-60",placeholder:"Search test, UHID or name",value:i,onChange:d=>l(d.target.value)}),r.jsx(gn,{anyOf:["orders.ris.create","radiology.orders.create"],children:r.jsxs("button",{className:"btn",onClick:()=>c(!0),children:[r.jsx(us,{className:"h-4 w-4 mr-2"})," New Order"]})})]})]}),r.jsx("div",{className:"rounded-xl border bg-white",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-gray-50 text-gray-600",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left",children:"Order"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Patient"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Modality"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Priority"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Status"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Created"}),r.jsx("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[n&&r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-3",colSpan:7,children:"Loading"})}),!n&&t.map(d=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-3 py-2",children:r.jsx(wk,{order:d,to:`/ris/orders/${d.id}`,prefix:"RAD"})}),r.jsx("td",{className:"px-3 py-2",children:r.jsx(zp,{patientId:d.patient_id})}),r.jsx("td",{className:"px-3 py-2",children:r.jsx(o$,{modality:d.modality})}),r.jsx("td",{className:"px-3 py-2 capitalize",children:d.priority||"routine"}),r.jsx("td",{className:"px-3 py-2",children:r.jsx(Gy,{status:d.status})}),r.jsx("td",{className:"px-3 py-2",children:new Date(d.created_at).toLocaleString()}),r.jsx("td",{className:"px-3 py-2 text-right",children:r.jsx(nl,{to:`/ris/orders/${d.id}`,className:"btn-ghost",children:"View"})})]},d.id)),!n&&t.length===0&&r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-6 text-center text-gray-500",colSpan:7,children:"No orders"})})]})]})}),r.jsx(Xxe,{open:o,onClose:()=>c(!1),children:r.jsx(Yxe,{onClose:()=>c(!1),onCreated:()=>c(!1)})})]})}function Zxe({t,onEdit:s,onDelete:n}){return r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-3 py-2",children:t.code}),r.jsx("td",{className:"px-3 py-2",children:t.name}),r.jsx("td",{className:"px-3 py-2",children:t.modality||""}),r.jsx("td",{className:"px-3 py-2",children:Number(t.price||0).toFixed(2)}),r.jsx("td",{className:"px-3 py-2 text-right",children:r.jsxs(gn,{anyOf:["radiology.masters.manage","masters.ris.manage"],children:[r.jsx("button",{className:"btn-ghost mr-2",onClick:()=>s(t),children:"Edit"}),r.jsx("button",{className:"btn-ghost text-rose-600",onClick:()=>n(t),children:"Delete"})]})})]})}function Jxe(){const[t,s]=y.useState([]),[n,a]=y.useState(!0),[i,l]=y.useState(""),[o,c]=y.useState({code:"",name:"",modality:"",price:0}),[d,u]=y.useState(null),f=async()=>{var w,j;a(!0);try{const{data:_}=await l$({q:i,page_size:100});s(Array.isArray(_)?_:(_==null?void 0:_.items)||[])}catch(_){ie.error(((j=(w=_==null?void 0:_.response)==null?void 0:w.data)==null?void 0:j.detail)||"Failed to load")}finally{a(!1)}};y.useEffect(()=>{f()},[i]);const m=async()=>{var w,j;try{d?(await Lxe(d,o),ie.success("Updated")):(await Rxe(o),ie.success("Created")),c({code:"",name:"",modality:"",price:0}),u(null),f()}catch(_){ie.error(((j=(w=_==null?void 0:_.response)==null?void 0:w.data)==null?void 0:j.detail)||"Save failed")}},x=w=>{u(w.id),c({code:w.code,name:w.name,modality:w.modality||"",price:w.price||0})},b=async w=>{var j,_;if(window.confirm(`Delete ${w.code}?`))try{await Bxe(w.id),ie.success("Deleted"),f()}catch(C){ie.error(((_=(j=C==null?void 0:C.response)==null?void 0:j.data)==null?void 0:_.detail)||"Delete failed")}};return r.jsxs("div",{className:"space-y-5 text-black",children:[r.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl font-semibold",children:"RIS Masters"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Manage radiology tests & modalities."})]}),r.jsx("input",{className:"input w-60",placeholder:"Search code/name",value:i,onChange:w=>l(w.target.value)})]}),r.jsx(gn,{anyOf:["radiology.masters.manage","masters.ris.manage"],children:r.jsxs("div",{className:"rounded-2xl border bg-white p-4",children:[r.jsx("h3",{className:"text-sm font-semibold mb-3",children:d?"Edit Test":"New Test"}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[r.jsx("input",{className:"input",placeholder:"Code",value:o.code,onChange:w=>c(j=>({...j,code:w.target.value}))}),r.jsx("input",{className:"input",placeholder:"Name",value:o.name,onChange:w=>c(j=>({...j,name:w.target.value}))}),r.jsx("input",{className:"input",placeholder:"Modality (XR/CT/MRI/USG)",value:o.modality,onChange:w=>c(j=>({...j,modality:w.target.value}))}),r.jsx("input",{className:"input",placeholder:"Price",type:"number",step:"0.01",value:o.price,onChange:w=>c(j=>({...j,price:w.target.value}))})]}),r.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[r.jsx("button",{className:"btn",onClick:m,children:d?"Update":"Create"}),d&&r.jsx("button",{className:"btn-ghost",onClick:()=>{u(null),c({code:"",name:"",modality:"",price:0})},children:"Cancel"})]})]})}),r.jsx("div",{className:"rounded-xl border bg-white",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-gray-50 text-gray-600",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left",children:"Code"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Name"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Modality"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Price"}),r.jsx("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[n&&r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-3",colSpan:5,children:"Loading"})}),!n&&t.map(w=>r.jsx(Zxe,{t:w,onEdit:x,onDelete:b},w.id)),!n&&t.length===0&&r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-6 text-center text-gray-500",colSpan:5,children:"No tests"})})]})]})})]})}const tc=t=>t?new Date(t).toLocaleString():"";function e0e(){const{id:t}=sd(),[s,n]=y.useState(null),[a,i]=y.useState(!0),[l,o]=y.useState(""),[c,d]=y.useState(""),[u,f]=y.useState(!1),[m,x]=y.useState([]),b=async()=>{var T,P;i(!0);try{const{data:R}=await zxe(t);n(R),d((R==null?void 0:R.report_text)||"")}catch(R){ie.error(((P=(T=R==null?void 0:R.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to load order")}finally{i(!1)}};y.useEffect(()=>{b()},[t]);const w=async()=>{var T,P;if(!l)return ie.error("Pick a date & time");try{await Uxe(s.id,{scheduled_at:l}),ie.success("Scheduled"),b()}catch(R){ie.error(((P=(T=R==null?void 0:R.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to schedule")}},j=async()=>{var T,P;try{await Vxe(s.id),ie.success("Marked scanned"),b()}catch(R){ie.error(((P=(T=R==null?void 0:R.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to mark scanned")}},_=async()=>{var T,P;f(!0);try{s.status==="reported"||s.status==="approved"?await Wxe(s.id,{report_text:c}):await Hxe(s.id,{report_text:c}),ie.success("Report saved"),b()}catch(R){ie.error(((P=(T=R==null?void 0:R.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to save report")}finally{f(!1)}},C=async()=>{var T,P;try{await qxe(s.id),ie.success("Report approved"),b()}catch(R){ie.error(((P=(T=R==null?void 0:R.response)==null?void 0:T.data)==null?void 0:P.detail)||"Approval failed")}},k=async T=>{var R,I,O;const P=(R=T.target.files)==null?void 0:R[0];if(P)try{const{data:M}=await Kxe(s.id,P);x(B=>[{file_url:M==null?void 0:M.file_url,note:P.name},...B]),ie.success("Attachment uploaded")}catch(M){ie.error(((O=(I=M==null?void 0:M.response)==null?void 0:I.data)==null?void 0:O.detail)||"Upload failed")}finally{T.target.value=""}},A=async()=>{var P,R;const T=prompt("Paste file URL");if(T)try{const{data:I}=await Gxe(s.id,T,"Link");x(O=>[{file_url:(I==null?void 0:I.file_url)||T,note:"Link"},...O]),ie.success("Attachment linked")}catch(I){ie.error(((R=(P=I==null?void 0:I.response)==null?void 0:P.data)==null?void 0:R.detail)||"Link failed")}};return a?r.jsx("div",{children:"Loading"}):s?r.jsxs("div",{className:"space-y-6 text-black",children:[r.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs("h1",{className:"text-xl font-semibold",children:["Radiology Order ",r.jsx(wk,{order:s,prefix:"RAD"})]}),r.jsxs("div",{className:"text-xs text-gray-500",children:["Patient: ",r.jsx(zp,{patientId:s.patient_id}),"  Created: ",tc(s.created_at)]}),r.jsxs("div",{className:"text-xs text-gray-500",children:["Modality: ",r.jsx(o$,{modality:s.modality}),"  Status: ",r.jsx(Gy,{status:s.status})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(gn,{anyOf:["radiology.report.create"],children:r.jsx("button",{className:"btn",onClick:_,disabled:u,children:u?"Saving":"Save Report"})}),r.jsx(gn,{anyOf:["radiology.report.approve"],children:r.jsxs("button",{className:"btn",onClick:C,children:[r.jsx(b3,{className:"h-4 w-4 mr-2"})," Approve"]})})]})]}),r.jsxs("section",{className:"rounded-2xl border bg-white p-4 space-y-4",children:[r.jsx("h2",{className:"text-sm font-semibold",children:"Workflow"}),r.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[r.jsxs("div",{className:"rounded-xl border p-3",children:[r.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[r.jsx(Sa,{className:"h-4 w-4"})," Schedule"]}),r.jsxs("div",{className:"mt-2 space-y-2",children:[r.jsx("input",{type:"datetime-local",className:"input w-full",value:l,onChange:T=>o(T.target.value)}),r.jsx(gn,{anyOf:["radiology.schedule.manage"],children:r.jsx("button",{className:"btn w-full",onClick:w,children:"Book Slot"})}),r.jsxs("div",{className:"text-xs text-gray-500",children:["Current: ",tc(s.scheduled_at)]})]})]}),r.jsxs("div",{className:"rounded-xl border p-3",children:[r.jsx("div",{className:"flex items-center gap-2 font-medium",children:"Scan"}),r.jsxs("div",{className:"mt-2 grid gap-2",children:[r.jsx(gn,{anyOf:["radiology.scan.update"],children:r.jsx("button",{className:"btn w-full",onClick:j,children:"Mark Scanned"})}),r.jsxs("div",{className:"text-xs text-gray-500",children:["Scanned: ",tc(s.scanned_at)]})]})]}),r.jsxs("div",{className:"rounded-xl border p-3",children:[r.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[r.jsx(m_,{className:"h-4 w-4"})," Attachments"]}),r.jsxs("div",{className:"mt-2 grid gap-2",children:[r.jsx("input",{type:"file",onChange:k}),r.jsx("button",{className:"btn-ghost text-left",onClick:A,children:"Add link"}),r.jsxs("div",{className:"mt-2 space-y-1",children:[m.map((T,P)=>r.jsx("a",{href:T.file_url,className:"text-xs text-blue-700 underline",target:"_blank",rel:"noreferrer",children:T.note||T.file_url},P)),m.length===0&&r.jsx("div",{className:"text-xs text-gray-500",children:"No attachments (local list)"})]})]})]})]})]}),r.jsxs("section",{className:"rounded-2xl border bg-white p-4 space-y-3",children:[r.jsx("h2",{className:"text-sm font-semibold",children:"Report"}),r.jsx("textarea",{className:"input min-h-[200px]",placeholder:"Enter radiology report text",value:c,onChange:T=>d(T.target.value)}),r.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs text-gray-600",children:[r.jsxs("div",{children:["Ordered: ",tc(s.created_at)]}),r.jsxs("div",{children:["Scheduled: ",tc(s.scheduled_at)]}),r.jsxs("div",{children:["Scanned: ",tc(s.scanned_at)]}),r.jsxs("div",{children:["Reported: ",tc(s.reported_at)]}),r.jsxs("div",{children:["Approved: ",tc(s.approved_at)]})]})]})]}):r.jsx("div",{className:"text-sm text-gray-500",children:"Order not found"})}function t0e(t){return J.post("/billing/invoices",t)}function s0e(t){return J.get(`/billing/invoices/${t}`)}function n0e(t={}){return J.get("/billing/invoices",{params:t})}function r0e(t,s){return J.put(`/billing/invoices/${t}`,s)}function a0e(t){return J.post(`/billing/invoices/${t}/finalize`)}function i0e(t){return J.post(`/billing/invoices/${t}/cancel`)}function bI(t,s){return J.post(`/billing/invoices/${t}/items/manual`,s)}function l0e(t,s,n){return J.put(`/billing/invoices/${t}/items/${s}`,n)}function o0e(t,s,n){return J.post(`/billing/invoices/${t}/items/${s}/void`,n)}function c0e(t,s){return J.post(`/billing/invoices/${t}/payments`,s)}function d0e(t,s){return J.delete(`/billing/invoices/${t}/payments/${s}`)}function u0e(t,s={}){return J.post(`/billing/invoices/${t}/apply-advances`,s)}function Nk(){return J.get("/billing/masters")}function h0e(t){return J.get(`/billing/patients/${t}/summary`)}function f0e(t){return J.get(`/billing/invoices/${t}/print`,{responseType:"blob"})}function m0e(t){return J.get(`/billing/patients/${t}/print-summary`,{responseType:"blob"})}function Un(t){return Number(t||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}function p0e(){var Cs,hs;const{invoiceId:t}=sd(),s=Ta(),[n,a]=y.useState(null),[i,l]=y.useState({doctors:[],credit_providers:[],packages:[],payers:[],tpas:[],credit_plans:[]}),[o,c]=y.useState(!0),[d,u]=y.useState(!1),[f,m]=y.useState({}),[x,b]=y.useState(!1),[w,j]=y.useState({description:"",quantity:1,unit_price:"",tax_rate:0,discount_percent:0,discount_amount:""}),[_,C]=y.useState(null),[k,A]=y.useState({description:"",quantity:1,unit_price:"",tax_rate:0,discount_percent:0,discount_amount:""}),[T,P]=y.useState(!1),[R,I]=y.useState({amount:"",mode:"cash",reference_no:"",notes:""}),[O,M]=y.useState(!1),[B,L]=y.useState(""),[F,V]=y.useState(""),[U,z]=y.useState(null),[W,q]=y.useState(!1),G=(n==null?void 0:n.status)==="finalized"||(n==null?void 0:n.status)==="cancelled";y.useEffect(()=>{se()},[]),y.useEffect(()=>{t&&ke()},[t]);async function se(){try{const{data:ae}=await Nk();l({doctors:(ae==null?void 0:ae.doctors)||[],credit_providers:(ae==null?void 0:ae.credit_providers)||[],packages:(ae==null?void 0:ae.packages)||[],payers:(ae==null?void 0:ae.payers)||[],tpas:(ae==null?void 0:ae.tpas)||[],credit_plans:(ae==null?void 0:ae.credit_plans)||[]})}catch(ae){console.error("Failed to load masters",ae)}}async function ge(ae){if(ae){q(!0);try{const{data:Te}=await h0e(ae);z(Te)}catch(Te){console.error("Failed to load patient billing summary",Te)}finally{q(!1)}}}async function ke(){c(!0),V("");try{const{data:ae}=await s0e(t);a(ae),m({billing_type:ae.billing_type||"general",consultant_id:ae.consultant_id||"",provider_id:ae.provider_id||"",visit_no:ae.visit_no||"",remarks:ae.remarks||"",header_discount_percent:ae.header_discount_percent??"",header_discount_amount:ae.header_discount_amount??"",discount_remarks:ae.discount_remarks||""}),await ge(ae.patient_id)}catch(ae){console.error("Failed to load invoice",ae),V("Unable to load invoice. Please go back and try again.")}finally{c(!1)}}function ee(ae){const{name:Te,value:de}=ae.target;m(Pe=>({...Pe,[Te]:de}))}async function pe(){if(n){u(!0),V("");try{const ae={billing_type:f.billing_type||null,consultant_id:f.consultant_id?Number(f.consultant_id):null,provider_id:f.provider_id?Number(f.provider_id):null,visit_no:f.visit_no||null,remarks:f.remarks||null,header_discount_percent:f.header_discount_percent!==""&&f.header_discount_percent!==null?Number(f.header_discount_percent):null,header_discount_amount:f.header_discount_amount!==""&&f.header_discount_amount!==null?Number(f.header_discount_amount):null,discount_remarks:f.discount_remarks||null},{data:Te}=await r0e(n.id,ae);a(Te),m(de=>({...de,header_discount_percent:Te.header_discount_percent??"",header_discount_amount:Te.header_discount_amount??""}))}catch(ae){console.error("Save header failed",ae),V("Unable to save header details.")}finally{u(!1)}}}function ue(ae){const{name:Te,value:de}=ae.target;j(Pe=>({...Pe,[Te]:Te==="quantity"||Te==="tax_rate"||Te==="discount_percent"?Number(de):de}))}async function ye(ae){if(ae.preventDefault(),!!n){V("");try{const Te={description:w.description||"",quantity:w.quantity||1,unit_price:Number(w.unit_price||0),tax_rate:Number(w.tax_rate||0),discount_percent:Number(w.discount_percent||0),discount_amount:w.discount_amount!==""?Number(w.discount_amount||0):void 0},{data:de}=await bI(n.id,Te);a(de),b(!1),j({description:"",quantity:1,unit_price:"",tax_rate:0,discount_percent:0,discount_amount:""})}catch(Te){console.error("Add manual item failed",Te),V("Unable to add manual item. Please check values.")}}}function X(ae){C(ae.id),A({description:ae.description||"",quantity:ae.quantity||1,unit_price:String(ae.unit_price||""),tax_rate:Number(ae.tax_rate||0),discount_percent:Number(ae.discount_percent||0),discount_amount:ae.discount_amount!==null&&ae.discount_amount!==void 0?String(ae.discount_amount):""})}function oe(ae){const{name:Te,value:de}=ae.target;A(Pe=>({...Pe,[Te]:Te==="quantity"||Te==="tax_rate"||Te==="discount_percent"?Number(de):de}))}async function _e(ae){if(ae.preventDefault(),!(!n||!_))try{const Te={description:k.description||"",quantity:k.quantity||1,unit_price:Number(k.unit_price||0),tax_rate:Number(k.tax_rate||0),discount_percent:Number(k.discount_percent||0),discount_amount:k.discount_amount!==""?Number(k.discount_amount||0):void 0},{data:de}=await l0e(n.id,_,Te);a(de),C(null)}catch(Te){console.error("Update item failed",Te),V("Unable to update item.")}}async function ce(ae){if(!(!n||!window.confirm("Void this line item?")))try{const{data:de}=await o0e(n.id,ae.id,{reason:"Voided from UI"});a(de)}catch(de){console.error("Void item failed",de),V("Unable to void item.")}}function he(ae){const{name:Te,value:de}=ae.target;I(Pe=>({...Pe,[Te]:de}))}async function fe(ae){if(ae.preventDefault(),!!n){V("");try{let Te=Number(R.amount||0);O&&(Te=-Math.abs(Te));const de={amount:Te,mode:O?"refund":R.mode,reference_no:R.reference_no||null,notes:R.notes||null},{data:Pe}=await c0e(n.id,de);a(Pe),P(!1),M(!1),I({amount:"",mode:"cash",reference_no:"",notes:""})}catch(Te){console.error("Add payment/refund failed",Te),V("Unable to save payment / refund.")}}}async function le(ae){if(!(!n||!window.confirm("Delete this payment?")))try{const{data:de}=await d0e(n.id,ae.id);a(de)}catch(de){console.error("Delete payment failed",de),V("Unable to delete payment.")}}async function Ve(){if(n){L("advance"),V("");try{const{data:ae}=await u0e(n.id,{});a(ae)}catch(ae){console.error("Apply advances failed",ae),V("Unable to apply advances.")}finally{L("")}}}async function Ke(){if(!(!n||!window.confirm("Finalize this invoice? You cannot edit items later."))){L("finalize"),V("");try{const{data:Te}=await a0e(n.id);a(Te)}catch(Te){console.error("Finalize failed",Te),V("Unable to finalize invoice.")}finally{L("")}}}async function wt(){if(!(!n||!window.confirm("Cancel this invoice?"))){L("cancel"),V("");try{await i0e(n.id),await ke()}catch(Te){console.error("Cancel failed",Te),V("Unable to cancel invoice.")}finally{L("")}}}async function mt(){if(n)try{const ae=await f0e(n.id),Te=new Blob([ae.data],{type:ae.headers["content-type"]||"application/pdf"}),de=URL.createObjectURL(Te);window.open(de,"_blank","noopener")}catch(ae){console.error("Print failed",ae),V("Unable to open invoice print view.")}}async function rt(){if(n)try{const ae=await m0e(n.patient_id),Te=new Blob([ae.data],{type:ae.headers["content-type"]||"application/pdf"}),de=URL.createObjectURL(Te);window.open(de,"_blank","noopener")}catch(ae){console.error("Patient summary print failed",ae),V("Unable to open patient billing summary.")}}function bt(){M(!0),P(!0)}function be(){M(!1),P(!0)}function ne(ae){if(!n||!ae)return;const Te=i.packages.find(Pe=>String(Pe.id)===String(ae));if(!Te)return;const de={description:`Package: ${Te.name}`,quantity:1,unit_price:Number(Te.charges||0),tax_rate:0,discount_percent:0};bI(n.id,de).then(({data:Pe})=>a(Pe)).catch(Pe=>{console.error("Add package charge failed",Pe),V("Unable to add package charge.")})}const me=i.packages||[],Ne=(n==null?void 0:n.status)==="finalized"?"bg-green-100 text-green-800":(n==null?void 0:n.status)==="cancelled"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800",Be=(n==null?void 0:n.payments)||[],jt=(n==null?void 0:n.items)||[],yt=y.useMemo(()=>Be.filter(ae=>Number(ae.amount||0)>=0),[Be]),pt=y.useMemo(()=>Be.filter(ae=>Number(ae.amount||0)<0),[Be]);return o?r.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 md:px-6 py-4",children:r.jsx("div",{className:"max-w-5xl mx-auto text-xs text-slate-500",children:"Loading invoice..."})}):n?r.jsxs("div",{className:"min-h-[calc(100vh-4rem)] bg-gradient-to-b from-slate-50 via-slate-100 to-slate-50 px-3 md:px-6 pb-20 md:pb-4 pt-4",children:[r.jsxs("div",{className:"max-w-5xl mx-auto space-y-4",children:[r.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{type:"button",onClick:()=>s("/billing"),className:"text-xs text-slate-500 hover:text-slate-700",children:" Billing Console"}),r.jsx("span",{className:"text-xs text-slate-400",children:"/"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("h1",{className:"text-sm md:text-base font-semibold text-slate-900",children:["Invoice #",n.invoice_number||n.id]}),r.jsx("span",{className:`inline-flex rounded-full px-2.5 py-0.5 text-[10px] font-medium ${Ne}`,children:n.status})]})]}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsx("button",{type:"button",onClick:mt,className:"text-xs rounded-full border border-slate-300 px-3 py-1.5 text-slate-700 bg-white hover:bg-slate-50 shadow-sm",children:"Print Invoice"})})]}),F&&r.jsx("div",{className:"rounded-md bg-red-50 px-3 py-2 text-xs text-red-700",children:F}),r.jsxs("div",{className:"rounded-2xl border border-indigo-100 bg-gradient-to-r from-indigo-50 via-sky-50 to-purple-50 p-3 md:p-4 shadow-sm flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("div",{className:"text-xs font-semibold text-slate-800",children:"Patient Credit Overview"}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Patient ID: ",r.jsxs("span",{className:"font-medium",children:["#",n.patient_id]})]}),(U==null?void 0:U.patient)&&r.jsxs("div",{className:"text-[11px] text-slate-600",children:[U.patient.uhid&&r.jsxs(r.Fragment,{children:["UHID:"," ",r.jsx("span",{className:"font-medium",children:U.patient.uhid})," ",""," "]}),(U.patient.first_name||U.patient.last_name)&&r.jsxs(r.Fragment,{children:[U.patient.first_name," ",U.patient.last_name," "," "]}),U.patient.phone&&r.jsxs(r.Fragment,{children:[" ",U.patient.phone]})]})]}),r.jsxs("div",{className:"flex flex-wrap gap-2 text-[11px]",children:[r.jsxs("div",{className:"rounded-full bg-white/80 border border-indigo-100 px-3 py-1 shadow-sm",children:[r.jsx("span",{className:"text-slate-500 mr-1",children:"Total Outstanding:"}),r.jsxs("span",{className:"font-semibold text-red-700",children:[""," ",Un((U==null?void 0:U.total_outstanding)??n.balance_due??0)]})]}),r.jsxs("div",{className:"rounded-full bg-white/80 border border-emerald-100 px-3 py-1 shadow-sm",children:[r.jsx("span",{className:"text-slate-500 mr-1",children:"Advance Balance:"}),r.jsxs("span",{className:"font-semibold text-emerald-700",children:[" ",Un((U==null?void 0:U.advance_balance)??0)]})]}),r.jsx("button",{type:"button",onClick:rt,disabled:W,className:"rounded-full bg-slate-900 px-3 py-1 text-[11px] font-medium text-white shadow-sm hover:bg-slate-800 disabled:opacity-60",children:W?"Loading...":"Credit Summary PDF"})]})]}),r.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[r.jsxs("div",{className:"w-full md:w-2/5 space-y-4",children:[r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 md:p-4 shadow-sm space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("h2",{className:"text-xs font-semibold text-slate-800",children:"Invoice Header"}),r.jsxs("span",{className:"text-[11px] text-slate-400",children:["Patient #",n.patient_id]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Billing Type"}),r.jsxs("select",{name:"billing_type",value:f.billing_type,onChange:ee,disabled:G,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50",children:[r.jsx("option",{value:"op_billing",children:"OP Billing"}),r.jsx("option",{value:"ip_billing",children:"IP Billing"}),r.jsx("option",{value:"lab",children:"Lab"}),r.jsx("option",{value:"pharmacy",children:"Pharmacy"}),r.jsx("option",{value:"radiology",children:"Radiology"}),r.jsx("option",{value:"general",children:"General"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Consultant"}),r.jsxs("select",{name:"consultant_id",value:f.consultant_id,onChange:ee,disabled:G,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50",children:[r.jsx("option",{value:"",children:"None"}),(Cs=i.doctors)==null?void 0:Cs.map(ae=>r.jsx("option",{value:ae.id,children:ae.name||`Doctor #${ae.id}`},ae.id))]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Credit Provider"}),r.jsxs("select",{name:"provider_id",value:f.provider_id,onChange:ee,disabled:G,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50",children:[r.jsx("option",{value:"",children:"Self pay"}),(hs=i.credit_providers)==null?void 0:hs.map(ae=>r.jsx("option",{value:ae.id,children:ae.display_name||ae.name||ae.code||`Provider #${ae.id}`},ae.id))]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Visit No (optional)"}),r.jsx("input",{type:"text",name:"visit_no",value:f.visit_no,onChange:ee,disabled:G,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Remarks"}),r.jsx("input",{type:"text",name:"remarks",value:f.remarks,onChange:ee,disabled:G,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50"})]})]}),r.jsxs("div",{className:"mt-2 border-t border-slate-100 pt-2 space-y-2",children:[r.jsx("div",{className:"text-[11px] font-semibold text-slate-700",children:"Header Discount"}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Discount %"}),r.jsx("input",{type:"number",name:"header_discount_percent",value:f.header_discount_percent,onChange:ee,disabled:G,step:"0.1",className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Discount Amount"}),r.jsx("input",{type:"number",name:"header_discount_amount",value:f.header_discount_amount,onChange:ee,disabled:G,step:"0.01",className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50"})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Discount Remarks"}),r.jsx("input",{type:"text",name:"discount_remarks",value:f.discount_remarks,onChange:ee,disabled:G,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50"})]})]}),!G&&r.jsx("div",{className:"pt-1 flex justify-end",children:r.jsx("button",{type:"button",onClick:pe,disabled:d,className:"px-3 py-1.5 rounded-full bg-slate-900 text-xs font-medium text-white hover:bg-slate-800 disabled:opacity-60",children:d?"Saving...":"Save Header"})})]})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 md:p-4 shadow-sm space-y-2 text-xs",children:[r.jsx("h2",{className:"text-xs font-semibold text-slate-800",children:"Totals"}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-slate-500",children:"Gross Amount"}),r.jsxs("span",{className:"font-medium text-slate-900",children:[" ",Un(n.gross_total)]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-slate-500",children:"Tax Total"}),r.jsxs("span",{className:"font-medium text-slate-900",children:[" ",Un(n.tax_total)]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-slate-500",children:"Header Discount"}),r.jsxs("span",{className:"font-medium text-orange-700",children:[" ",Un(n.header_discount_amount||0)," ",n.header_discount_percent?`(${n.header_discount_percent}%)`:""]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-slate-500",children:"Net Amount"}),r.jsxs("span",{className:"font-semibold text-slate-900",children:[" ",Un(n.net_total)]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-slate-500",children:"Amount Received"}),r.jsxs("span",{className:"font-medium text-emerald-700",children:[" ",Un(n.amount_paid)]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-slate-500",children:"Advance Adjusted"}),r.jsxs("span",{className:"font-medium text-slate-900",children:[" ",Un(n.advance_adjusted)]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-slate-500",children:"Previous Balance"}),r.jsxs("span",{className:"font-medium text-slate-900",children:[" ",Un(n.previous_balance_snapshot)]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-slate-500",children:"Balance Due"}),r.jsxs("span",{className:"font-semibold text-red-700",children:[" ",Un(n.balance_due)]})]})]})]}),me.length>0&&r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 md:p-4 shadow-sm space-y-2 text-xs",children:[r.jsx("div",{className:"flex items-center justify-between gap-2",children:r.jsx("h2",{className:"text-xs font-semibold text-slate-800",children:"Package Billing (IPD)"})}),r.jsx("p",{className:"text-[11px] text-slate-500 mb-1",children:"Quickly post a package charge to this invoice."}),r.jsxs("select",{onChange:ae=>ne(ae.target.value),disabled:G,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50",defaultValue:"",children:[r.jsx("option",{value:"",children:"Select package to add..."}),me.map(ae=>r.jsxs("option",{value:ae.id,children:[ae.name,"   ",Un(ae.charges)]},ae.id))]})]})]}),r.jsxs("div",{className:"w-full md:w-3/5 space-y-4",children:[r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 md:p-4 shadow-sm space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("h2",{className:"text-xs font-semibold text-slate-800",children:"Items"}),!G&&r.jsx("button",{type:"button",onClick:()=>b(!0),className:"text-[11px] rounded-full border border-slate-300 px-3 py-1 text-slate-700 hover:bg-slate-50 shadow-sm",children:"+ Add Manual Item"})]}),jt.length===0?r.jsx("p",{className:"text-xs text-slate-500",children:"No items added yet."}):r.jsx("div",{className:"overflow-x-auto text-xs",children:r.jsxs("table",{className:"min-w-full divide-y divide-slate-100",children:[r.jsx("thead",{className:"bg-slate-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"#"}),r.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Description"}),r.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"Qty"}),r.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"Price"}),r.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"GST%"}),r.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"Disc"}),r.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"Total"}),r.jsx("th",{className:"px-2 py-1.5"})]})}),r.jsx("tbody",{className:"divide-y divide-slate-100",children:jt.map((ae,Te)=>r.jsxs("tr",{className:"align-top",children:[r.jsx("td",{className:"px-2 py-1.5 whitespace-nowrap text-slate-500",children:Te+1}),r.jsx("td",{className:"px-2 py-1.5 text-slate-800",children:r.jsxs("div",{className:"max-w-xs",children:[r.jsx("div",{className:"truncate",children:ae.description}),r.jsxs("div",{className:"text-[10px] text-slate-400",children:[ae.service_type," #",ae.service_ref_id]})]})}),r.jsx("td",{className:"px-2 py-1.5 text-right text-slate-700",children:ae.quantity}),r.jsx("td",{className:"px-2 py-1.5 text-right text-slate-700",children:Un(ae.unit_price)}),r.jsxs("td",{className:"px-2 py-1.5 text-right text-slate-700",children:[Number(ae.tax_rate||0),"%"]}),r.jsxs("td",{className:"px-2 py-1.5 text-right text-slate-700",children:[ae.discount_percent?`${Number(ae.discount_percent)}%`:"",ae.discount_amount?` /  ${Un(ae.discount_amount)}`:""]}),r.jsx("td",{className:"px-2 py-1.5 text-right text-slate-800",children:Un(ae.line_total)}),r.jsx("td",{className:"px-2 py-1.5 text-right whitespace-nowrap",children:!G&&r.jsxs("div",{className:"flex justify-end gap-1",children:[r.jsx("button",{type:"button",onClick:()=>X(ae),className:"text-[10px] text-indigo-600 hover:text-indigo-800",children:"Edit"}),r.jsx("span",{className:"text-slate-300",children:"|"}),r.jsx("button",{type:"button",onClick:()=>ce(ae),className:"text-[10px] text-red-600 hover:text-red-800",children:"Void"})]})})]},ae.id))})]})})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 md:p-4 shadow-sm space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("h2",{className:"text-xs font-semibold text-slate-800",children:"Payments & Refunds"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{type:"button",onClick:Ve,disabled:B==="advance",className:"text-[11px] rounded-full border border-slate-300 px-3 py-1 text-slate-700 hover:bg-slate-50 disabled:opacity-60",children:B==="advance"?"Applying...":"Apply Advances"}),!G&&r.jsxs(r.Fragment,{children:[r.jsx("button",{type:"button",onClick:bt,className:"text-[11px] rounded-full border border-red-200 bg-red-50 px-3 py-1 text-red-700 hover:bg-red-100",children:"+ Add Refund"}),r.jsx("button",{type:"button",onClick:be,className:"text-[11px] rounded-full border border-slate-300 px-3 py-1 text-slate-700 hover:bg-slate-50",children:"+ Add Payment"})]})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("div",{className:"text-[11px] font-semibold text-slate-700",children:"Payments"}),yt.length===0?r.jsx("p",{className:"text-[11px] text-slate-500",children:"No payments recorded."}):r.jsx("div",{className:"overflow-x-auto text-xs",children:r.jsxs("table",{className:"min-w-full divide-y divide-slate-100",children:[r.jsx("thead",{className:"bg-slate-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Mode"}),r.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Reference"}),r.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Notes"}),r.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Paid At"}),r.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"Amount"}),r.jsx("th",{className:"px-2 py-1.5"})]})}),r.jsx("tbody",{className:"divide-y divide-slate-100",children:yt.map(ae=>r.jsxs("tr",{children:[r.jsx("td",{className:"px-2 py-1.5 text-slate-800",children:ae.mode}),r.jsx("td",{className:"px-2 py-1.5 text-slate-600",children:ae.reference_no||""}),r.jsx("td",{className:"px-2 py-1.5 text-slate-600",children:ae.notes||""}),r.jsx("td",{className:"px-2 py-1.5 text-slate-500",children:ae.paid_at?new Date(ae.paid_at).toLocaleString():""}),r.jsxs("td",{className:"px-2 py-1.5 text-right text-emerald-700 font-medium",children:[" ",Un(ae.amount)]}),r.jsx("td",{className:"px-2 py-1.5 text-right",children:!G&&r.jsx("button",{type:"button",onClick:()=>le(ae),className:"text-[10px] text-red-600 hover:text-red-800",children:"Delete"})})]},ae.id))})]})})]}),r.jsxs("div",{className:"space-y-1 border-t border-slate-100 pt-2",children:[r.jsx("div",{className:"text-[11px] font-semibold text-slate-700",children:"Refunds"}),pt.length===0?r.jsx("p",{className:"text-[11px] text-slate-500",children:"No refunds recorded."}):r.jsx("div",{className:"overflow-x-auto text-xs",children:r.jsxs("table",{className:"min-w-full divide-y divide-slate-100",children:[r.jsx("thead",{className:"bg-slate-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Mode"}),r.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Reference"}),r.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Notes"}),r.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Time"}),r.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"Amount"}),r.jsx("th",{className:"px-2 py-1.5"})]})}),r.jsx("tbody",{className:"divide-y divide-slate-100",children:pt.map(ae=>r.jsxs("tr",{children:[r.jsx("td",{className:"px-2 py-1.5 text-slate-800",children:ae.mode}),r.jsx("td",{className:"px-2 py-1.5 text-slate-600",children:ae.reference_no||""}),r.jsx("td",{className:"px-2 py-1.5 text-slate-600",children:ae.notes||""}),r.jsx("td",{className:"px-2 py-1.5 text-slate-500",children:ae.paid_at?new Date(ae.paid_at).toLocaleString():""}),r.jsxs("td",{className:"px-2 py-1.5 text-right text-red-700 font-medium",children:[" ",Un(ae.amount)]}),r.jsx("td",{className:"px-2 py-1.5 text-right",children:!G&&r.jsx("button",{type:"button",onClick:()=>le(ae),className:"text-[10px] text-red-600 hover:text-red-800",children:"Delete"})})]},ae.id))})]})})]})]})]})]}),r.jsx("div",{className:"fixed inset-x-0 bottom-0 z-20 bg-white border-t border-slate-200 px-3 py-2 md:static md:border-none md:px-0 md:py-0 mt-3",children:r.jsxs("div",{className:"max-w-5xl mx-auto flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between text-xs",children:[r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsxs("span",{className:"rounded-full bg-slate-100 px-2.5 py-1 text-[11px] text-slate-700",children:["Net:  ",Un(n.net_total)]}),r.jsxs("span",{className:"rounded-full bg-emerald-50 px-2.5 py-1 text-[11px] text-emerald-700",children:["Paid:  ",Un(n.amount_paid)]}),r.jsxs("span",{className:"rounded-full bg-red-50 px-2.5 py-1 text-[11px] text-red-700",children:["Balance:  ",Un(n.balance_due)]})]}),r.jsx("div",{className:"flex gap-2 justify-end",children:!G&&r.jsxs(r.Fragment,{children:[r.jsx("button",{type:"button",onClick:wt,disabled:B==="cancel",className:"rounded-full border border-slate-300 px-3 py-1.5 text-xs text-slate-700 bg-white hover:bg-slate-50 disabled:opacity-60",children:B==="cancel"?"Cancelling...":"Cancel Invoice"}),r.jsx("button",{type:"button",onClick:Ke,disabled:B==="finalize",className:"rounded-full bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-500 px-4 py-1.5 text-xs font-medium text-white shadow-md hover:shadow-lg disabled:opacity-60",children:B==="finalize"?"Finalizing...":"Finalize"})]})})]})})]}),x&&!G&&r.jsx("div",{className:"fixed inset-0 z-30 flex items-end sm:items-center justify-center bg-black/40",children:r.jsxs("div",{className:"w-full sm:max-w-md bg-white rounded-t-2xl sm:rounded-2xl shadow-lg p-4 space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Add Manual Item"}),r.jsx("button",{type:"button",onClick:()=>b(!1),className:"text-xs text-slate-400 hover:text-slate-600",children:""})]}),r.jsxs("form",{className:"space-y-3",onSubmit:ye,children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Description"}),r.jsx("input",{type:"text",name:"description",value:w.description,onChange:ue,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",required:!0})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Qty"}),r.jsx("input",{type:"number",name:"quantity",value:w.quantity,min:1,onChange:ue,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Unit Price"}),r.jsx("input",{type:"number",name:"unit_price",value:w.unit_price,step:"0.01",onChange:ue,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",required:!0})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Tax %"}),r.jsx("input",{type:"number",name:"tax_rate",value:w.tax_rate,step:"0.1",onChange:ue,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Disc %"}),r.jsx("input",{type:"number",name:"discount_percent",value:w.discount_percent,step:"0.1",onChange:ue,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Disc Amount"}),r.jsx("input",{type:"number",name:"discount_amount",value:w.discount_amount,step:"0.01",onChange:ue,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]})]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx("button",{type:"button",onClick:()=>b(!1),className:"rounded-md border border-slate-300 px-3 py-1.5 text-xs text-slate-700",children:"Cancel"}),r.jsx("button",{type:"submit",className:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-indigo-700",children:"Add Item"})]})]})]})}),_&&!G&&r.jsx("div",{className:"fixed inset-0 z-30 flex items-end sm:items-center justify-center bg-black/40",children:r.jsxs("div",{className:"w-full sm:max-w-md bg-white rounded-t-2xl sm:rounded-2xl shadow-lg p-4 space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Edit Item"}),r.jsx("button",{type:"button",onClick:()=>C(null),className:"text-xs text-slate-400 hover:text-slate-600",children:""})]}),r.jsxs("form",{className:"space-y-3",onSubmit:_e,children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Description"}),r.jsx("input",{type:"text",name:"description",value:k.description,onChange:oe,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",required:!0})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Qty"}),r.jsx("input",{type:"number",name:"quantity",value:k.quantity,min:1,onChange:oe,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Unit Price"}),r.jsx("input",{type:"number",name:"unit_price",value:k.unit_price,step:"0.01",onChange:oe,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",required:!0})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Tax %"}),r.jsx("input",{type:"number",name:"tax_rate",value:k.tax_rate,step:"0.1",onChange:oe,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Disc %"}),r.jsx("input",{type:"number",name:"discount_percent",value:k.discount_percent,step:"0.1",onChange:oe,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Disc Amount"}),r.jsx("input",{type:"number",name:"discount_amount",value:k.discount_amount,step:"0.01",onChange:oe,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]})]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx("button",{type:"button",onClick:()=>C(null),className:"rounded-md border border-slate-300 px-3 py-1.5 text-xs text-slate-700",children:"Cancel"}),r.jsx("button",{type:"submit",className:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-indigo-700",children:"Save Changes"})]})]})]})}),T&&!G&&r.jsx("div",{className:"fixed inset-0 z-30 flex items-end sm:items-center justify-center bg-black/40",children:r.jsxs("div",{className:"w-full sm:max-w-md bg-white rounded-t-2xl sm:rounded-2xl shadow-lg p-4 space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:O?"Add Refund":"Add Payment"}),r.jsx("button",{type:"button",onClick:()=>{P(!1),M(!1)},className:"text-xs text-slate-400 hover:text-slate-600",children:""})]}),r.jsxs("form",{className:"space-y-3",onSubmit:fe,children:[r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Amount"}),r.jsx("input",{type:"number",name:"amount",value:R.amount,onChange:he,step:"0.01",className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",required:!0})]}),!O&&r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Mode"}),r.jsxs("select",{name:"mode",value:R.mode,onChange:he,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",children:[r.jsx("option",{value:"cash",children:"Cash"}),r.jsx("option",{value:"card",children:"Card"}),r.jsx("option",{value:"upi",children:"UPI"}),r.jsx("option",{value:"credit",children:"Credit"}),r.jsx("option",{value:"cheque",children:"Cheque"}),r.jsx("option",{value:"neft",children:"NEFT"}),r.jsx("option",{value:"rtgs",children:"RTGS"}),r.jsx("option",{value:"wallet",children:"Wallet"}),r.jsx("option",{value:"other",children:"Other"})]})]}),O&&r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Mode (optional)"}),r.jsx("input",{type:"text",name:"mode",value:R.mode,onChange:he,placeholder:"refund / bank / cash",className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Reference No (optional)"}),r.jsx("input",{type:"text",name:"reference_no",value:R.reference_no,onChange:he,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Notes (optional)"}),r.jsx("input",{type:"text",name:"notes",value:R.notes,onChange:he,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx("button",{type:"button",onClick:()=>{P(!1),M(!1)},className:"rounded-md border border-slate-300 px-3 py-1.5 text-xs text-slate-700",children:"Cancel"}),r.jsx("button",{type:"submit",className:`rounded-md px-3 py-1.5 text-xs font-medium text-white ${O?"bg-red-600 hover:bg-red-700":"bg-indigo-600 hover:bg-indigo-700"}`,children:O?"Save Refund":"Save Payment"})]})]})]})})]}):r.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 md:px-6 py-4",children:r.jsxs("div",{className:"max-w-5xl mx-auto",children:[r.jsx("p",{className:"text-xs text-red-600 mb-2",children:F||"Invoice not found."}),r.jsx("button",{type:"button",onClick:()=>s("/billing"),className:"text-xs text-indigo-600 hover:text-indigo-800",children:" Back to Billing Console"})]})})}function c$(t){return J.get("/emr/patients/lookup",{params:{q:t}})}function x0e({patient_id:t,uhid:s,date_from:n,date_to:a,types:i}={}){let l;return Array.isArray(i)?l=i.length?i.join(","):void 0:typeof i=="string"?l=i||void 0:l=void 0,J.get("/emr/timeline",{params:{patient_id:t,uhid:s,date_from:n||void 0,date_to:a||void 0,types:l}})}function g0e(t){return J.post("/emr/export/pdf-json",t,{responseType:"blob"})}function y0e(t,s,n){return J.get(`/emr/fhir/${t}`,{params:{date_from:s,date_to:n}})}function b0e({onPick:t,placeholder:s="UHID, name, phone, email"}){const[n,a]=y.useState(""),[i,l]=y.useState([]),[o,c]=y.useState(!1);y.useEffect(()=>{let u=!0;const m=setTimeout(async()=>{if(!n||!n.trim()){l([]);return}try{c(!0);const{data:x}=await c$(n.trim());if(!u)return;l((x==null?void 0:x.results)||[])}finally{c(!1)}},250);return()=>{u=!1,clearTimeout(m)}},[n]);const d=y.useMemo(()=>i.slice(0,8),[i]);return r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:"Find Patient"}),r.jsxs("div",{className:"relative",children:[r.jsx(is,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),r.jsx("input",{className:"w-full rounded-xl border border-gray-200 bg-white px-9 py-2 text-sm outline-none ring-blue-200 focus:ring-2",placeholder:s,value:n,onChange:u=>a(u.target.value)})]}),o&&r.jsx("div",{className:"text-xs text-gray-500",children:"Searching"}),!o&&d.length>0&&r.jsx("div",{className:"grid gap-2 sm:grid-cols-2",children:d.map(u=>{var f;return r.jsxs("button",{onClick:()=>t(u),className:"rounded-xl border p-3 text-left transition hover:bg-gray-50",children:[r.jsxs("div",{className:"font-medium",children:[u.uhid,"  ",u.name]}),r.jsxs("div",{className:"text-xs text-gray-500",children:[(f=u.gender)==null?void 0:f.toUpperCase()," ",u.dob?` ${u.dob}`:""," ",u.phone?` ${u.phone}`:""]})]},u.uhid)})}),!o&&n&&d.length===0&&r.jsx("div",{className:"text-xs text-gray-500",children:"No matches."})]})}const bm=[{code:"opd_visit",label:"OPD Visit",icon:_s},{code:"opd_vitals",label:"Vitals",icon:sn},{code:"rx",label:"Prescription",icon:tl},{code:"lab",label:"Lab",icon:Bc},{code:"radiology",label:"Radiology",icon:Og},{code:"pharmacy",label:"Pharmacy",icon:Oy},{code:"ipd_admission",label:"IPD Admit",icon:Jn},{code:"ipd_transfer",label:"IPD Transfer",icon:ute},{code:"ipd_discharge",label:"IPD Discharge",icon:Fse},{code:"ot",label:"OT",icon:y7},{code:"billing",label:"Billing",icon:f_},{code:"attachment",label:"Attachment",icon:Yse},{code:"consent",label:"Consent",icon:Aa}];function _h(t){return t<10?"0"+t:""+t}function v0e(t){const s=new Date(t);return isNaN(s)?String(t||""):`${s.getFullYear()}-${_h(s.getMonth()+1)}-${_h(s.getDate())} ${_h(s.getHours())}:${_h(s.getMinutes())}`}function w0e(t){const s=new Date(t);return isNaN(s)?"":`${s.getFullYear()}-${_h(s.getMonth()+1)}-${_h(s.getDate())}`}function N0e(t){const s=new Map;return t.forEach(n=>{const a=w0e(n.ts);s.has(a)||s.set(a,[]),s.get(a).push(n)}),Array.from(s.entries()).sort((n,a)=>n[0]<a[0]?1:-1)}function j0e(t,s){const n=URL.createObjectURL(t),a=document.createElement("a");a.href=n,a.download=s,a.click(),URL.revokeObjectURL(n)}function F0(t,s){const n=document.createElement("a");n.href=t,n.download=s||"download",n.target="_blank",n.rel="noopener",n.click()}const _0e="inline-flex items-center gap-1 rounded-full border px-3 py-1 text-[11px] font-medium transition",S0e={new:"border-slate-200 bg-slate-50 text-slate-700",in_progress:"border-slate-200 bg-slate-50 text-slate-700",dispensed:"border-emerald-200 bg-emerald-50 text-emerald-700",completed:"border-emerald-200 bg-emerald-50 text-emerald-700",cancelled:"border-rose-200 bg-rose-50 text-rose-700"};function vI(t){const s=(t.content_type||"").toLowerCase(),n=String(t.url||"").toLowerCase();return s.startsWith("image/")?"image":s==="application/pdf"?"pdf":n.endsWith(".png")||n.endsWith(".jpg")||n.endsWith(".jpeg")||n.endsWith(".webp")||n.endsWith(".gif")?"image":n.endsWith(".pdf")?"pdf":"other"}function C0e(){const[t,s]=y.useState(null),[n,a]=y.useState({date_from:"",date_to:"",types:bm.map(z=>z.code),consent_required:!1}),[i,l]=y.useState(!1),[o,c]=y.useState([]),[d,u]=y.useState(0),f=y.useMemo(()=>new Set(n.types||[]),[n.types]),[m,x]=y.useState(null),[b,w]=y.useState(!1),[j,_]=y.useState(null);y.useEffect(()=>()=>{m&&URL.revokeObjectURL(m)},[m]);const C=z=>{a(W=>{const q=new Set(W.types);return q.has(z)?q.delete(z):q.add(z),{...W,types:Array.from(q)}})},k=()=>a(z=>({...z,types:bm.map(W=>W.code)})),A=()=>a(z=>({...z,types:[]}));y.useEffect(()=>{let z=!0;return(async()=>{var q,G;if(!(!(t!=null&&t.uhid)&&!(t!=null&&t.id)))try{l(!0);const se={uhid:t.uhid,patient_id:t.id,date_from:n.date_from||void 0,date_to:n.date_to||void 0};n.types&&n.types.length&&n.types.length!==bm.length&&(se.types=n.types.join(","));const{data:ge}=await x0e(se);if(!z)return;c(ge||[])}catch(se){console.error(se),ie.error(((G=(q=se==null?void 0:se.response)==null?void 0:q.data)==null?void 0:G.detail)||"Failed to load EMR timeline"),c([])}finally{l(!1)}})(),()=>{z=!1}},[t==null?void 0:t.uhid,t==null?void 0:t.id,n.date_from,n.date_to,JSON.stringify(n.types),d]);const T=y.useMemo(()=>N0e(o),[o]),P=(o==null?void 0:o.length)||0,R=n.date_from||n.date_to?`${n.date_from||""}  ${n.date_to||"Today"}`:"All available records",I=async()=>{var z,W,q;if(!t){ie.info("Select a patient first.");return}try{const se={...t!=null&&t.id?{patient_id:t.id}:{uhid:t==null?void 0:t.uhid},date_from:n.date_from||null,date_to:n.date_to||null,sections:{opd:f.has("opd_visit")||f.has("opd_vitals")||f.has("rx"),ipd:f.has("ipd_admission")||f.has("ipd_transfer")||f.has("ipd_discharge"),vitals:f.has("opd_vitals"),prescriptions:f.has("rx"),lab:f.has("lab"),radiology:f.has("radiology"),pharmacy:f.has("pharmacy"),ot:f.has("ot"),billing:f.has("billing"),attachments:f.has("attachment"),consents:f.has("consent")},consent_required:!!n.consent_required},ke=(await g0e(se)).data;if(!(ke instanceof Blob)){ie.error("PDF export failed: invalid response");return}x(ee=>(ee&&URL.revokeObjectURL(ee),URL.createObjectURL(ke))),w(!0),ie.success("EMR PDF ready for preview")}catch(G){((z=G==null?void 0:G.response)==null?void 0:z.status)===412?ie.error("Consent required. Enable consent capture or uncheck the Require consent box."):ie.error(((q=(W=G==null?void 0:G.response)==null?void 0:W.data)==null?void 0:q.detail)||"PDF export failed")}},O=async()=>{if(!(t!=null&&t.id)){ie.info("Patient id required; please pick from the search list.");return}try{const{data:z}=await y0e(t.id,n.date_from||void 0,n.date_to||void 0),W=new Blob([JSON.stringify(z,null,2)],{type:"application/json"});j0e(W,`FHIR_${t.uhid||"patient"}.json`),ie.success("FHIR bundle downloaded")}catch{ie.error("FHIR export failed")}};function M({k:z,v:W}){return W==null||W===""?null:r.jsxs("div",{className:"text-xs text-slate-700",children:[r.jsxs("span",{className:"font-medium",children:[z,":"]})," ",String(W)]})}function B(z){const W=z.data||{};switch(z.type){case"opd_visit":return r.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[r.jsx(M,{k:"Chief Complaint",v:W.chief_complaint}),r.jsx(M,{k:"Symptoms",v:W.symptoms}),r.jsx(M,{k:"Subjective",v:W.subjective}),r.jsx(M,{k:"Objective",v:W.objective}),r.jsx(M,{k:"Assessment",v:W.assessment}),r.jsx(M,{k:"Plan",v:W.plan}),r.jsx(M,{k:"Episode",v:W.episode_id}),W.appointment&&r.jsxs("div",{className:"text-xs text-slate-700",children:[r.jsx("span",{className:"font-medium",children:"Appointment:"})," ",W.appointment.date,"  ",W.appointment.slot_start,"",W.appointment.slot_end,"  ",W.appointment.purpose]})]});case"opd_vitals":return r.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-sm text-slate-800 md:grid-cols-3",children:[r.jsx(M,{k:"Recorded at",v:W.recorded_at}),r.jsx(M,{k:"Height (cm)",v:W.height_cm}),r.jsx(M,{k:"Weight (kg)",v:W.weight_kg}),r.jsx(M,{k:"BMI",v:W.bmi}),r.jsx(M,{k:"BP",v:W.bp_systolic!=null&&W.bp_diastolic!=null?`${W.bp_systolic}/${W.bp_diastolic} mmHg`:""}),r.jsx(M,{k:"Pulse",v:W.pulse}),r.jsx(M,{k:"RR",v:W.rr}),r.jsx(M,{k:"Temp (C)",v:W.temp_c}),r.jsx(M,{k:"SpO (%)",v:W.spo2}),r.jsx("div",{className:"col-span-2 md:col-span-3",children:r.jsx(M,{k:"Notes",v:W.notes})})]});case"rx":return r.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[r.jsx(M,{k:"Notes",v:W.notes}),r.jsx(M,{k:"Signed at",v:W.signed_at}),r.jsx(M,{k:"Signed by",v:W.signed_by}),Array.isArray(W.items)&&W.items.length>0&&r.jsxs("div",{className:"mt-2",children:[r.jsx("div",{className:"text-[11px] font-medium text-slate-600 uppercase tracking-wide",children:"Items"}),r.jsx("div",{className:"mt-1 divide-y rounded-2xl border border-slate-200 bg-slate-50",children:W.items.map((q,G)=>r.jsxs("div",{className:"grid gap-2 p-2.5 md:grid-cols-5",children:[r.jsxs("div",{className:"md:col-span-2 text-xs",children:[r.jsx("span",{className:"font-medium text-slate-900",children:q.drug_name})," ",q.strength?r.jsxs("span",{className:"text-slate-500",children:[" ",q.strength]}):null]}),r.jsxs("div",{className:"text-xs text-slate-600",children:["Freq: ",q.frequency||""]}),r.jsxs("div",{className:"text-xs text-slate-600",children:["Dur: ",q.duration_days,"d"]}),r.jsxs("div",{className:"text-xs text-slate-600",children:["Qty: ",q.quantity]})]},G))})]})]});case"lab":{const q=W.item||{};return r.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[r.jsx(M,{k:"Order ID",v:W.order_id}),r.jsx(M,{k:"Priority",v:W.priority}),r.jsx(M,{k:"Collected at",v:W.collected_at}),r.jsx(M,{k:"Reported at",v:W.reported_at}),r.jsx(M,{k:"Test",v:`${q.test_name} (${q.test_code})`}),r.jsx(M,{k:"Unit",v:q.unit}),r.jsx(M,{k:"Normal range",v:q.normal_range}),r.jsx(M,{k:"Specimen",v:q.specimen_type}),r.jsx(M,{k:"Status",v:q.status}),r.jsx(M,{k:"Result",v:q.result_value}),r.jsx(M,{k:"Critical",v:q.is_critical?"Yes":q.is_critical===!1?"No":""}),r.jsx(M,{k:"Result at",v:q.result_at})]})}case"radiology":return r.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[r.jsx(M,{k:"Test",v:`${W.test_name} (${W.test_code})`}),r.jsx(M,{k:"Modality",v:W.modality}),r.jsx(M,{k:"Status",v:W.status}),r.jsx(M,{k:"Scheduled at",v:W.scheduled_at}),r.jsx(M,{k:"Scanned at",v:W.scanned_at}),r.jsx(M,{k:"Reported at",v:W.reported_at}),r.jsx(M,{k:"Approved at",v:W.approved_at}),r.jsx(M,{k:"Report",v:W.report_text})]});case"pharmacy":return r.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[r.jsx(M,{k:"Sale ID",v:W.sale_id}),r.jsx(M,{k:"Context",v:W.context_type}),r.jsx(M,{k:"Payment",v:W.payment_mode}),r.jsx(M,{k:"Total",v:W.total_amount}),Array.isArray(W.items)&&W.items.length>0&&r.jsxs("div",{className:"mt-2",children:[r.jsx("div",{className:"text-[11px] font-medium text-slate-600 uppercase tracking-wide",children:"Items"}),r.jsx("div",{className:"mt-1 divide-y rounded-2xl border border-slate-200 bg-slate-50",children:W.items.map((q,G)=>r.jsxs("div",{className:"grid gap-2 p-2.5 md:grid-cols-4",children:[r.jsx("div",{className:"md:col-span-2 text-xs text-slate-800",children:q.medicine_name||`#${q.medicine_id}`}),r.jsxs("div",{className:"text-xs text-slate-600",children:["Qty: ",q.qty]}),r.jsxs("div",{className:"text-xs text-slate-600",children:["",q.amount]})]},G))})]})]});case"ipd_admission":return r.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-sm text-slate-800 md:grid-cols-3",children:[r.jsx(M,{k:"Admission Code",v:W.admission_code}),r.jsx(M,{k:"Type",v:W.admission_type}),r.jsx(M,{k:"Admitted at",v:W.admitted_at}),r.jsx(M,{k:"Expected Discharge",v:W.expected_discharge_at}),r.jsx(M,{k:"Bed",v:W.current_bed_code}),r.jsx("div",{className:"col-span-2 md:col-span-3",children:r.jsx(M,{k:"Preliminary Diagnosis",v:W.preliminary_diagnosis})}),r.jsx("div",{className:"col-span-2 md:col-span-3",children:r.jsx(M,{k:"History",v:W.history})}),r.jsx("div",{className:"col-span-2 md:col-span-3",children:r.jsx(M,{k:"Care Plan",v:W.care_plan})})]});case"ipd_transfer":return r.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[r.jsx(M,{k:"Admission",v:W.admission_id}),r.jsx(M,{k:"From Bed",v:W.from_bed_id}),r.jsx(M,{k:"To Bed",v:W.to_bed_id}),r.jsx(M,{k:"Reason",v:W.reason}),r.jsx(M,{k:"Transferred at",v:W.transferred_at})]});case"ipd_discharge":return r.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[r.jsx(M,{k:"Finalized",v:W.finalized?"Yes":"No"}),r.jsx(M,{k:"Finalized at",v:W.finalized_at}),r.jsx(M,{k:"Demographics",v:W.demographics}),r.jsx(M,{k:"Medical History",v:W.medical_history}),r.jsx(M,{k:"Treatment Summary",v:W.treatment_summary}),r.jsx(M,{k:"Medications",v:W.medications}),r.jsx(M,{k:"Follow Up",v:W.follow_up}),r.jsx(M,{k:"ICD-10 Codes",v:W.icd10_codes})]});case"ot":return r.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[r.jsx(M,{k:"Surgery",v:W.surgery_name}),r.jsx(M,{k:"Code",v:W.surgery_code}),r.jsx(M,{k:"Estimated Cost",v:W.estimated_cost}),r.jsx(M,{k:"Scheduled",v:`${W.scheduled_start||""}  ${W.scheduled_end||""}`}),r.jsx(M,{k:"Actual",v:`${W.actual_start||""}  ${W.actual_end||""}`}),r.jsx(M,{k:"Status",v:W.status}),r.jsx(M,{k:"Pre-op Notes",v:W.preop_notes}),r.jsx(M,{k:"Post-op Notes",v:W.postop_notes})]});case"billing":return r.jsxs("div",{className:"mt-2 space-y-2 text-sm text-slate-800",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-2 md:grid-cols-4",children:[r.jsx(M,{k:"Invoice ID",v:W.invoice_id}),r.jsx(M,{k:"Status",v:W.status}),r.jsx(M,{k:"Net Total",v:W.net_total}),r.jsx(M,{k:"Balance",v:W.balance_due})]}),Array.isArray(W.items)&&W.items.length>0&&r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] font-medium text-slate-600 uppercase tracking-wide",children:"Items"}),r.jsx("div",{className:"mt-1 divide-y rounded-2xl border border-slate-200 bg-slate-50",children:W.items.map((q,G)=>r.jsxs("div",{className:"grid gap-2 p-2.5 md:grid-cols-6",children:[r.jsx("div",{className:"md:col-span-2 text-xs text-slate-800",children:q.description}),r.jsx("div",{className:"text-xs text-slate-600",children:q.service_type}),r.jsxs("div",{className:"text-xs text-slate-600",children:["Qty: ",q.quantity]}),r.jsxs("div",{className:"text-xs text-slate-600",children:["Unit: ",q.unit_price]}),r.jsxs("div",{className:"text-xs text-slate-600",children:["Total: ",q.line_total]})]},G))})]}),Array.isArray(W.payments)&&W.payments.length>0&&r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] font-medium text-slate-600 uppercase tracking-wide",children:"Payments"}),r.jsx("div",{className:"mt-1 divide-y rounded-2xl border border-slate-200 bg-slate-50",children:W.payments.map((q,G)=>r.jsxs("div",{className:"grid gap-2 p-2.5 md:grid-cols-4",children:[r.jsxs("div",{className:"text-xs text-slate-600",children:["Mode: ",q.mode]}),r.jsxs("div",{className:"text-xs text-slate-600",children:["Ref: ",q.reference_no||""]}),r.jsxs("div",{className:"text-xs text-slate-600",children:["",q.amount]}),r.jsx("div",{className:"text-xs text-slate-600",children:q.paid_at})]},G))})]})]});case"attachment":return null;case"consent":return r.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[r.jsx(M,{k:"Type",v:W.type}),r.jsx(M,{k:"Captured at",v:W.captured_at}),r.jsx(M,{k:"Text",v:W.text})]});default:return null}}const L=z=>{const W=vI(z);if(W==="other"){window.open(z.url,"_blank","noopener,noreferrer");return}_({url:z.url,label:z.label||"Attachment",kind:W})},F=()=>{_(null)},V=()=>{if(!m)return;const z=window.open(m);z&&z.addEventListener("load",()=>{z.focus(),z.print()})},U=()=>{!m||!t||F0(m,`EMR_${t.uhid||"patient"}.pdf`)};return r.jsxs("div",{className:"min-h-screen bg-slate-50",children:[r.jsxs("div",{className:"mx-auto max-w-6xl px-3 py-4 md:px-6 md:py-6 lg:px-8",children:[r.jsxs("div",{className:"mb-3 flex items-center justify-between gap-2",children:[r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1 text-[10px] font-medium uppercase tracking-wide text-slate-500",children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 animate-pulse"}),"EMR  Patient record & timeline"]}),r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1 text-[10px] font-medium text-slate-500",children:[r.jsx(Tse,{className:"h-3 w-3"}),"Desktop workspace"]})]}),r.jsx(Nt.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2},children:r.jsxs(We,{className:"mb-5 rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsxs(st,{className:"flex flex-col gap-4 border-b border-slate-100 pb-4 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-3xl bg-slate-900 text-slate-50",children:r.jsx(_s,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx(lt,{className:"text-xl font-semibold text-slate-900",children:"Patient EMR Timeline"}),r.jsx(Ca,{className:"text-sm text-slate-600",children:"Unified view of OPD, IPD, lab, radiology, pharmacy, billing, attachments and consents  ready to export as a clean EMR PDF."})]})]}),r.jsxs("div",{className:"grid gap-2 text-xs text-slate-600 sm:grid-cols-3 sm:text-right",children:[r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[r.jsx("div",{className:"text-[10px] font-medium uppercase tracking-wide text-slate-500",children:"Selected patient"}),r.jsx("div",{className:"mt-1 text-[13px] font-semibold text-slate-900",children:t?t.uhid:"None"}),r.jsx("div",{className:"truncate text-[11px] text-slate-500",children:t?t.name:"Use search to pick a patient"})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[r.jsx("div",{className:"text-[10px] font-medium uppercase tracking-wide text-slate-500",children:"Total events"}),r.jsx("div",{className:"mt-1 text-[13px] font-semibold text-slate-900",children:P}),r.jsx("div",{className:"text-[11px] text-slate-500",children:"Across visits, orders & billing"})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[r.jsx("div",{className:"text-[10px] font-medium uppercase tracking-wide text-slate-500",children:"Date range"}),r.jsx("div",{className:"mt-1 text-[13px] font-semibold text-slate-900",children:R}),r.jsx("div",{className:"text-[11px] text-slate-500",children:"Filter scope for EMR export"})]})]})]}),r.jsx(qe,{className:"pt-4",children:r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-500",children:[r.jsx(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-white px-2.5 py-1 text-[10px] font-medium uppercase tracking-wide text-slate-500",children:"EMR Viewer"}),r.jsx("span",{className:"hidden text-[11px] text-slate-500 sm:inline",children:"Apply filters, review visits and export a print-aligned EMR PDF."})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs(Re,{variant:"outline",size:"sm",className:"inline-flex items-center gap-1 rounded-full border-slate-200 bg-white text-xs text-slate-700 hover:bg-slate-100",onClick:()=>u(z=>z+1),children:[r.jsx(Si,{className:"h-3.5 w-3.5"}),"Refresh"]}),r.jsxs(Re,{size:"sm",className:"inline-flex items-center gap-1 rounded-full bg-slate-900 px-3 py-2 text-xs font-medium text-white hover:bg-slate-800",onClick:I,children:[r.jsx(My,{className:"h-3.5 w-3.5"}),"Preview / Print EMR PDF"]}),r.jsxs(Re,{variant:"outline",size:"sm",className:"inline-flex items-center gap-1 rounded-full border-slate-200 bg-white text-xs text-slate-700 hover:bg-slate-100",onClick:O,children:[r.jsx(tl,{className:"h-3.5 w-3.5"}),"Export FHIR (JSON)"]})]})]})})]})}),r.jsxs("div",{className:"mt-4 lg:grid lg:grid-cols-[280px,minmax(0,1fr)] lg:gap-6",children:[r.jsxs("div",{className:"mb-4 space-y-4 lg:mb-0 lg:sticky lg:top-24",children:[r.jsx(Nt.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2,delay:.05},children:r.jsxs(We,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsxs(st,{className:"pb-3",children:[r.jsx(lt,{className:"text-sm font-semibold text-slate-900",children:"Patient"}),r.jsx(Ca,{className:"text-xs text-slate-500",children:"Search and select a patient to view their EMR timeline."})]}),r.jsxs(qe,{className:"space-y-3",children:[r.jsx(b0e,{onPick:z=>{s(z),ie.success(`Selected ${z.uhid}  ${z.name}`)}}),t&&r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-700",children:r.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[r.jsx(Pp,{className:"h-3.5 w-3.5 text-slate-500"}),r.jsx("span",{className:"font-medium text-slate-900",children:t.uhid}),r.jsx(w0,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsx("span",{className:"truncate",children:t.name}),t.gender&&r.jsxs(r.Fragment,{children:[r.jsx(w0,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsx("span",{className:"uppercase text-slate-500",children:t.gender})]}),t.dob&&r.jsxs(r.Fragment,{children:[r.jsx(w0,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsxs("span",{className:"text-slate-500",children:["DOB ",t.dob]})]}),t.phone&&r.jsxs(r.Fragment,{children:[r.jsx(w0,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsx("span",{className:"text-slate-500",children:t.phone})]})]})})]})]})}),r.jsx(Nt.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2,delay:.1},children:r.jsxs(We,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsx(st,{className:"pb-3",children:r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{children:[r.jsx(lt,{className:"text-sm font-semibold text-slate-900",children:"Filters"}),r.jsx(Ca,{className:"text-xs text-slate-500",children:"Date range, data types and consent requirement."})]})})}),r.jsxs(qe,{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"mb-1.5 flex items-center gap-2 text-xs font-semibold text-slate-900",children:[r.jsx(yh,{className:"h-3.5 w-3.5 text-slate-500"}),"Date range"]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx(yh,{className:"pointer-events-none absolute left-2.5 top-1/2 h-3.5 w-3.5 -translate-y-1/2 text-slate-400"}),r.jsx(Ee,{type:"date",className:"h-8 rounded-2xl border-slate-200 bg-slate-50 pl-8 pr-2 text-xs text-slate-700",value:n.date_from,onChange:z=>a(W=>({...W,date_from:z.target.value}))})]}),r.jsxs("div",{className:"relative",children:[r.jsx(yh,{className:"pointer-events-none absolute left-2.5 top-1/2 h-3.5 w-3.5 -translate-y-1/2 text-slate-400"}),r.jsx(Ee,{type:"date",className:"h-8 rounded-2xl border-slate-200 bg-slate-50 pl-8 pr-2 text-xs text-slate-700",value:n.date_to,onChange:z=>a(W=>({...W,date_to:z.target.value}))})]})]}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Leave blank for full EMR history."})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"mb-1.5 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold text-slate-900",children:[r.jsx(Ei,{className:"h-3.5 w-3.5 text-slate-500"}),"Types"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{type:"button",onClick:k,className:"text-[10px] font-medium text-slate-600 hover:text-slate-900",children:"All"}),r.jsx("button",{type:"button",onClick:A,className:"text-[10px] font-medium text-slate-500 hover:text-slate-900",children:"Clear"})]})]}),r.jsx("div",{className:"flex flex-wrap gap-1.5",children:bm.map(z=>{const W=z.icon,q=f.has(z.code);return r.jsxs("button",{type:"button",onClick:()=>C(z.code),className:["inline-flex items-center gap-1 rounded-full border px-2.5 py-1 text-[10px] font-medium transition",q?"border-slate-900 bg-slate-900 text-white shadow-sm":"border-slate-200 bg-white text-slate-600 hover:bg-slate-50"].join(" "),children:[r.jsx(W,{className:"h-3 w-3"}),z.label]},z.code)})})]}),r.jsxs("div",{className:"flex items-start gap-2 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[r.jsx("input",{id:"consentReq",type:"checkbox",checked:!!n.consent_required,onChange:z=>a(W=>({...W,consent_required:z.target.checked})),className:"mt-0.5 h-3.5 w-3.5 rounded border-slate-300 text-slate-900"}),r.jsxs("div",{className:"space-y-0.5",children:[r.jsx("label",{htmlFor:"consentReq",className:"block text-xs font-medium text-slate-900",children:"Require active consent for export"}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"When enabled, EMR PDF export is blocked unless a valid patient consent record exists."})]})]})]})]})})]}),r.jsx(Nt.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2,delay:.08},className:"space-y-4",children:r.jsxs(We,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsx(st,{className:"pb-3",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(_s,{className:"h-4 w-4 text-slate-500"}),r.jsx(lt,{className:"text-sm font-semibold text-slate-900",children:"Timeline"})]}),r.jsx("span",{className:"text-[11px] text-slate-500",children:"Sorted newest to oldest"})]})}),r.jsxs(qe,{children:[i&&r.jsx("div",{className:"space-y-3",children:Array.from({length:5}).map((z,W)=>r.jsx(Je,{className:"h-16 w-full rounded-2xl bg-slate-100"},W))}),!i&&(!o||o.length===0)&&r.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-6 py-8 text-center",children:[r.jsx("div",{className:"mx-auto mb-2 flex h-8 w-8 items-center justify-center rounded-full border border-slate-200 bg-white text-slate-500",children:r.jsx(_s,{className:"h-4 w-4"})}),r.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"No EMR events to display"}),r.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Pick a patient and adjust the date range or type filters to load their EMR timeline."})]}),!i&&o&&o.length>0&&r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute left-4 top-0 bottom-0 w-px bg-gradient-to-b from-slate-200 via-slate-200/70 to-transparent"}),r.jsx("div",{className:"space-y-6",children:T.map(([z,W])=>r.jsxs("div",{className:"relative pl-10",children:[r.jsxs("div",{className:"mb-2 inline-flex items-center gap-2 rounded-full border border-slate-200 bg-slate-50 px-3 py-1 text-[11px] font-medium text-slate-700",children:[r.jsx(yh,{className:"h-3.5 w-3.5 text-slate-500"}),z]}),r.jsx("div",{className:"space-y-3",children:W.map((q,G)=>{var ee,pe;const se=[q.doctor_name?`Dr. ${q.doctor_name}`:null,q.department_name||null,q.location_name||null].filter(Boolean).join("  "),ge=((ee=bm.find(ue=>ue.code===q.type))==null?void 0:ee.icon)||tl,ke=q.status&&(S0e[q.status]||"border-slate-200 bg-slate-50 text-slate-600");return r.jsxs(Nt.div,{initial:{opacity:0,y:4},animate:{opacity:1,y:0},transition:{duration:.15},className:"relative",children:[r.jsx("div",{className:"absolute -left-[9px] top-4 h-2.5 w-2.5 rounded-full border border-slate-200 bg-white"}),r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3.5 hover:shadow-[0_4px_12px_rgba(15,23,42,0.06)]",children:r.jsx("div",{className:"flex items-start justify-between gap-3",children:r.jsxs("div",{className:"flex min-w-0 items-start gap-3",children:[r.jsx("div",{className:"mt-0.5 flex h-8 w-8 items-center justify-center rounded-2xl bg-slate-900 text-slate-50",children:r.jsx(ge,{className:"h-4 w-4"})}),r.jsxs("div",{className:"min-w-0",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:q.title||"Event"}),r.jsx("div",{className:"text-[11px] text-slate-500",children:v0e(q.ts)}),q.status&&r.jsx("span",{className:`${_0e} ${ke}`,children:q.status})]}),se&&r.jsx("div",{className:"mt-0.5 text-[11px] text-slate-500",children:se}),B(q),((pe=q.attachments)==null?void 0:pe.length)>0&&r.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:q.attachments.map((ue,ye)=>{const X=vI(ue);return r.jsxs("div",{className:"inline-flex items-center gap-1.5 rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-[10px]",children:[r.jsxs("button",{type:"button",onClick:()=>L(ue),className:"inline-flex items-center gap-1 text-slate-700 hover:text-slate-900",children:[r.jsx(Zm,{className:"h-3 w-3"}),ue.label||"attachment"]}),r.jsxs("button",{type:"button",onClick:()=>F0(ue.url,ue.label||"attachment"),className:"inline-flex items-center gap-1 text-slate-400 hover:text-slate-700",children:[r.jsx(Ll,{className:"h-3 w-3"}),r.jsx("span",{className:"hidden sm:inline",children:"Download"})]}),r.jsx("span",{className:"text-[9px] uppercase text-slate-400",children:X})]},ye)})})]})]})})})]},`${q.type}-${String(q.ts)}-${G}`)})})]},z))})]})]})]})})]})]}),b&&m&&r.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/60",children:r.jsxs("div",{className:"relative flex h-[90vh] w-[95vw] max-w-6xl flex-col overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-2xl",children:[r.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 px-4 py-2.5",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"EMR PDF Preview"}),t&&r.jsxs("div",{className:"text-[11px] text-slate-500",children:[t.uhid,"  ",t.name]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs(Re,{variant:"outline",size:"sm",className:"inline-flex items-center gap-1 rounded-full border-slate-200 bg-white text-[11px] text-slate-700 hover:bg-slate-100",onClick:U,children:[r.jsx(Ll,{className:"h-3 w-3"}),"Download"]}),r.jsxs(Re,{size:"sm",className:"inline-flex items-center gap-1 rounded-full bg-slate-900 px-3 py-1.5 text-[11px] text-white hover:bg-slate-800",onClick:V,children:[r.jsx(My,{className:"h-3 w-3"}),"Print"]}),r.jsx("button",{type:"button",onClick:()=>w(!1),className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-slate-100 text-slate-600 hover:bg-slate-200",children:r.jsx(Rn,{className:"h-4 w-4"})})]})]}),r.jsx("div",{className:"flex-1 bg-slate-100",children:r.jsx("iframe",{src:m,title:"EMR PDF",className:"h-full w-full"})})]})}),j&&r.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/60",children:r.jsxs("div",{className:"relative flex h-[90vh] w-[95vw] max-w-4xl flex-col overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-2xl",children:[r.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 px-4 py-2.5",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-semibold text-slate-900",children:j.label}),r.jsxs("div",{className:"text-[11px] uppercase text-slate-400",children:[j.kind," preview"]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs(Re,{variant:"outline",size:"sm",className:"inline-flex items-center gap-1 rounded-full border-slate-200 bg-white text-[11px] text-slate-700 hover:bg-slate-100",onClick:()=>F0(j.url,j.label),children:[r.jsx(Ll,{className:"h-3 w-3"}),"Download"]}),r.jsx("button",{type:"button",onClick:F,className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-slate-100 text-slate-600 hover:bg-slate-200",children:r.jsx(Rn,{className:"h-4 w-4"})})]})]}),r.jsxs("div",{className:"flex-1 bg-slate-100",children:[j.kind==="image"&&r.jsx("div",{className:"flex h-full w-full items-center justify-center overflow-auto bg-black",children:r.jsx("img",{src:j.url,alt:j.label,className:"max-h-full max-w-full object-contain"})}),j.kind==="pdf"&&r.jsx("iframe",{src:j.url,title:j.label,className:"h-full w-full"}),j.kind==="other"&&r.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-3 p-6 text-center text-sm text-slate-600",children:[r.jsx("p",{children:"This file type cant be previewed here. You can open it in a new tab or download it."}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(Re,{size:"sm",className:"rounded-full bg-slate-900 px-4 py-1 text-[11px] text-white hover:bg-slate-800",onClick:()=>window.open(j.url,"_blank","noopener,noreferrer"),children:"Open in new tab"}),r.jsx(Re,{variant:"outline",size:"sm",className:"rounded-full border-slate-200 bg-white px-4 py-1 text-[11px] text-slate-700 hover:bg-slate-100",onClick:()=>F0(j.url,j.label),children:"Download"})]})]})]})]})})]})}const jk=(t={})=>J.get("/templates/templates",{params:t}),k0e=t=>J.get(`/templates/templates/${t}`),A0e=t=>J.post("/templates/templates",t),E0e=(t,s)=>J.patch(`/templates/templates/${t}`,s),T0e=t=>J.delete(`/templates/templates/${t}`),d$=(t,s,n=null)=>J.post(`/templates/templates/${t}/render-html`,n?{data:n}:{},{params:{patient_id:s}}),P0e=async(t,s)=>(await J.get(`/templates/templates/${t}/pdf`,{params:{patient_id:s,inline:!1},responseType:"blob"})).data,I0e=async(t,s)=>(await J.post(`/templates/templates/${t}/pdf`,s,{responseType:"blob"})).data,M0e=(t,s)=>J.post(`/templates/patients/${t}/consents`,s),D0e=t=>J.get(`/templates/patients/${t}/consents`),O0e=async t=>{const s=new FormData;return s.append("file",t),(await J.post("/files/upload",s,{headers:{"Content-Type":"multipart/form-data"}})).data};function R0e(){const[t,s]=y.useState([]),[n,a]=y.useState(""),[i,l]=y.useState(""),[o,c]=y.useState(!1),d=async()=>{c(!0);try{const m=await jk({q:n,category:i||void 0});s(m.data||[])}finally{c(!1)}};y.useEffect(()=>{d()},[]);const u=async m=>{m.preventDefault(),d()},f=async m=>{if(confirm("Delete this template?"))try{await T0e(m),ie.success("Deleted"),d()}catch{}};return r.jsxs("div",{className:"p-4",children:[r.jsxs("div",{className:"mb-4 flex items-center justify-between gap-2",children:[r.jsx("h1",{className:"text-xl font-semibold",children:"Templates"}),r.jsx(nl,{to:"/templates/new",className:"bg-blue-600 text-white px-3 py-2 rounded-lg text-sm",children:"New Template"})]}),r.jsxs("form",{onSubmit:u,className:"mb-3 flex flex-wrap gap-2",children:[r.jsx("input",{value:n,onChange:m=>a(m.target.value),placeholder:"Search name/code...",className:"border rounded px-3 py-2 text-sm"}),r.jsxs("select",{value:i,onChange:m=>l(m.target.value),className:"border rounded px-3 py-2 text-sm",children:[r.jsx("option",{value:"",children:"All"}),r.jsx("option",{value:"report",children:"Report"}),r.jsx("option",{value:"consent",children:"Consent"})]}),r.jsx("button",{className:"px-3 py-2 border rounded text-sm",children:"Filter"})]}),r.jsx("div",{className:"overflow-x-auto bg-white border rounded-lg",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left",children:"#"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Name"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Code"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Category"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Version"}),r.jsx("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[t.map(m=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-3 py-2",children:m.id}),r.jsx("td",{className:"px-3 py-2",children:m.name}),r.jsx("td",{className:"px-3 py-2",children:m.code}),r.jsx("td",{className:"px-3 py-2 capitalize",children:m.category}),r.jsx("td",{className:"px-3 py-2",children:m.version}),r.jsxs("td",{className:"px-3 py-2 text-right",children:[r.jsx(nl,{to:`/templates/${m.id}/edit`,className:"px-2 py-1 text-blue-700 hover:underline",children:"Edit"}),r.jsx("button",{onClick:()=>f(m.id),className:"px-2 py-1 text-red-600 hover:underline",children:"Delete"})]})]},m.id)),t.length===0&&!o&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-3 py-6 text-center text-gray-500",children:"No templates"})})]})]})})]})}const wI=["system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif","Arial, Helvetica, sans-serif","'Times New Roman', Times, serif","'Georgia', serif","'Courier New', Courier, monospace","'Inter', system-ui, -apple-system, sans-serif"],NI=["#000000","#444444","#666666","#999999","#CCCCCC","#EEEEEE","#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB"];function QN({value:t,onChange:s}){const n=y.useRef(null),a=y.useRef(null),[i,l]=y.useState(wI[0]);y.useEffect(()=>{n.current&&n.current.innerHTML!==(t||"")&&(n.current.innerHTML=t||"")},[t]);const o=()=>{var I;return((I=n.current)==null?void 0:I.innerHTML)||""},c=()=>s&&s(o()),d=I=>{document.execCommand("styleWithCSS",!1,!0);const O=window.getSelection();if(!O||O.rangeCount===0)return;const M=O.getRangeAt(0),B=document.createElement("span");Object.entries(I).forEach(([L,F])=>B.style[L]=F),M.surroundContents(B),c()},u=(I,O=null)=>{document.execCommand("styleWithCSS",!1,!0),document.execCommand(I,!1,O),c()},f=(I,O="",M=null)=>{const B=window.getSelection();if(!B||B.rangeCount===0)return;const L=B.getRangeAt(0),F=document.createElement(I);O&&(F.className=O),M&&Object.entries(M).forEach(([V,U])=>F.style[V]=U),L.surroundContents(F),c()},m=()=>{var I;return(I=a.current)==null?void 0:I.click()},x=async I=>{var M,B;const O=(M=I.target.files)==null?void 0:M[0];if(O)try{const L=await O0e(O),F="".replace(/\/$/,""),V=L.file_url_abs?L.file_url_abs:(B=L.file_url)!=null&&B.startsWith("http")?L.file_url:`${F}${L.file_url}`;b(`<img src="${V}" alt="${L.original_name||""}" style="max-width:100%;">`)}catch{ie.error("Upload failed")}finally{I.target.value=""}},b=I=>{var O;(O=n.current)==null||O.focus(),document.execCommand("insertHTML",!1,I),c()},w=()=>{var F;const I=window.getSelection();if(!I||I.rangeCount===0)return null;const O=I.getRangeAt(0),M=O.commonAncestorContainer.nodeType===1?O.commonAncestorContainer:O.commonAncestorContainer.parentNode;if(!M)return null;const B=M.querySelectorAll?M.querySelectorAll("img"):[],L=(F=I.anchorNode)==null?void 0:F.parentNode;if(L&&L.tagName==="IMG")return L;if(L!=null&&L.closest){const V=L.closest("img");if(V)return V}return B.length?B[0]:null},j=I=>{const O=w();if(!O)return ie.info("Select an image first");O.style.width=I,I==="100%"&&(O.style.maxWidth="100%"),c()},_=I=>{const O=w();if(!O)return ie.info("Select an image first");O.classList.remove("float-left","float-right","img-center"),O.style.removeProperty("float"),O.style.removeProperty("display"),O.style.removeProperty("margin-left"),O.style.removeProperty("margin-right"),I==="left"&&O.classList.add("float-left"),I==="right"&&O.classList.add("float-right"),I==="center"&&O.classList.add("img-center"),c()},C=I=>{var B,L;const O=window.getSelection();if(!O||O.rangeCount===0)return null;let M=((B=O.anchorNode)==null?void 0:B.nodeType)===1?O.anchorNode:(L=O.anchorNode)==null?void 0:L.parentNode;for(;M;){if(M.tagName&&I.includes(M.tagName))return M;M=M.parentNode}return null},k=I=>{var M;const O=C(["TABLE"])||((M=C(["TD","TH"]))==null?void 0:M.closest("TABLE"));if(!O)return ie.info("Place caret inside a table");O.classList.remove("tbl-border-all","tbl-border-h","tbl-border-v","tbl-border-none"),O.removeAttribute("border"),O.style.borderCollapse="collapse",O.querySelectorAll("th,td").forEach(B=>{B.style.border="",B.style.borderTop="",B.style.borderBottom="",B.style.borderLeft="",B.style.borderRight=""}),I==="all"&&O.classList.add("tbl-border-all"),I==="h"&&O.classList.add("tbl-border-h"),I==="v"&&O.classList.add("tbl-border-v"),I==="none"&&O.classList.add("tbl-border-none"),c()},A=()=>{const I=C(["TD","TH"]);if(!I)return ie.info("Place caret inside a row");I.closest("tr").classList.toggle("tr-shade"),c()},T=I=>{f("div",I===2?"cols-2":"cols-3")},P=I=>{I.preventDefault();const O=I.clipboardData.getData("text/plain");document.execCommand("insertText",!1,O),c()},R=I=>{I.preventDefault();const O=I.dataTransfer.getData("text/x-token")||I.dataTransfer.getData("text/plain");if(O){b(O);return}const M=I.dataTransfer.getData("text");M&&document.execCommand("insertText",!1,M),c()};return r.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2 p-2 border-b bg-gray-50",children:[r.jsx("select",{className:"text-sm border rounded px-2 py-1",value:i,onChange:I=>{l(I.target.value),d({fontFamily:I.target.value})},title:"Font family",children:wI.map(I=>r.jsx("option",{value:I,children:I.split(",")[0].replace(/['"]/g,"")},I))}),r.jsx("select",{className:"text-sm border rounded px-2 py-1",onChange:I=>d({fontSize:I.target.value}),children:["10px","12px","14px","16px","18px","20px","24px"].map(I=>r.jsx("option",{value:I,children:I},I))}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("bold"),children:r.jsx("b",{children:"B"})}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("italic"),children:r.jsx("i",{children:"I"})}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("underline"),children:r.jsx("u",{children:"U"})}),r.jsx("span",{className:"mx-1 w-px h-5 bg-gray-200"}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("justifyLeft"),children:"Left"}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("justifyCenter"),children:"Center"}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("justifyRight"),children:"Right"}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>f("span","text-justify"),children:"Justify"}),r.jsx("span",{className:"mx-1 w-px h-5 bg-gray-200"}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"text-xs text-gray-500 mr-1",children:"Text"}),NI.map(I=>r.jsx("button",{className:"w-4 h-4 rounded border",style:{background:I},onClick:()=>u("foreColor",I)},"fg"+I))]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"text-xs text-gray-500 ml-2 mr-1",children:"Highlight"}),NI.map(I=>r.jsx("button",{className:"w-4 h-4 rounded border",style:{background:I},onClick:()=>u("hiliteColor",I)},"bg"+I))]}),r.jsx("span",{className:"mx-1 w-px h-5 bg-gray-200"}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("insertUnorderedList"),children:" List"}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("insertOrderedList"),children:"1. List"}),r.jsx("span",{className:"mx-1 w-px h-5 bg-gray-200"}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:m,children:"Image"}),r.jsx("input",{ref:a,type:"file",accept:"image/*",className:"hidden",onChange:x}),r.jsxs("select",{className:"text-sm border rounded px-2 py-1",onChange:I=>j(I.target.value),defaultValue:"",children:[r.jsx("option",{value:"",disabled:!0,children:"Img Width"}),r.jsx("option",{value:"25%",children:"25%"}),r.jsx("option",{value:"33%",children:"33%"}),r.jsx("option",{value:"50%",children:"50%"}),r.jsx("option",{value:"75%",children:"75%"}),r.jsx("option",{value:"100%",children:"100%"})]}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>_("left"),children:"Img Left"}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>_("center"),children:"Img Center"}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>_("right"),children:"Img Right"}),r.jsx("span",{className:"mx-1 w-px h-5 bg-gray-200"}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>T(2),children:"2 Columns"}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>T(3),children:"3 Columns"}),r.jsx("span",{className:"mx-1 w-px h-5 bg-gray-200"}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>b("<table><tr><th>Header</th><th>Header</th></tr><tr><td>Cell</td><td>Cell</td></tr></table>"),children:"Insert Table"}),r.jsxs("select",{className:"text-sm border rounded px-2 py-1",onChange:I=>k(I.target.value),defaultValue:"",children:[r.jsx("option",{value:"",disabled:!0,children:"Borders"}),r.jsx("option",{value:"all",children:"All borders"}),r.jsx("option",{value:"h",children:"Horizontal only"}),r.jsx("option",{value:"v",children:"Vertical only"}),r.jsx("option",{value:"none",children:"No borders"})]}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:A,children:"Shade Row"})]}),r.jsx("div",{ref:n,className:"min-h-[320px] p-3 prose max-w-none focus:outline-none",contentEditable:!0,onInput:c,onPaste:P,suppressContentEditableWarning:!0,spellCheck:!1}),r.jsx("div",{ref:n,className:"min-h-[320px] p-3 prose max-w-none focus:outline-none",contentEditable:!0,onInput:c,onPaste:P,onDragOver:I=>I.preventDefault(),onDrop:R,suppressContentEditableWarning:!0,spellCheck:!1}),r.jsx("div",{className:"px-3 py-1 text-[10px] text-gray-500 border-t bg-gray-50",children:"Tip: select an image to resize/align; use columns for magazine-style layouts."})]})}function Sr(t){this.content=t}Sr.prototype={constructor:Sr,find:function(t){for(var s=0;s<this.content.length;s+=2)if(this.content[s]===t)return s;return-1},get:function(t){var s=this.find(t);return s==-1?void 0:this.content[s+1]},update:function(t,s,n){var a=n&&n!=t?this.remove(n):this,i=a.find(t),l=a.content.slice();return i==-1?l.push(n||t,s):(l[i+1]=s,n&&(l[i]=n)),new Sr(l)},remove:function(t){var s=this.find(t);if(s==-1)return this;var n=this.content.slice();return n.splice(s,2),new Sr(n)},addToStart:function(t,s){return new Sr([t,s].concat(this.remove(t).content))},addToEnd:function(t,s){var n=this.remove(t).content.slice();return n.push(t,s),new Sr(n)},addBefore:function(t,s,n){var a=this.remove(s),i=a.content.slice(),l=a.find(t);return i.splice(l==-1?i.length:l,0,s,n),new Sr(i)},forEach:function(t){for(var s=0;s<this.content.length;s+=2)t(this.content[s],this.content[s+1])},prepend:function(t){return t=Sr.from(t),t.size?new Sr(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=Sr.from(t),t.size?new Sr(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var s=this;t=Sr.from(t);for(var n=0;n<t.content.length;n+=2)s=s.remove(t.content[n]);return s},toObject:function(){var t={};return this.forEach(function(s,n){t[s]=n}),t},get size(){return this.content.length>>1}};Sr.from=function(t){if(t instanceof Sr)return t;var s=[];if(t)for(var n in t)s.push(n,t[n]);return new Sr(s)};function u$(t,s,n){for(let a=0;;a++){if(a==t.childCount||a==s.childCount)return t.childCount==s.childCount?null:n;let i=t.child(a),l=s.child(a);if(i==l){n+=i.nodeSize;continue}if(!i.sameMarkup(l))return n;if(i.isText&&i.text!=l.text){for(let o=0;i.text[o]==l.text[o];o++)n++;return n}if(i.content.size||l.content.size){let o=u$(i.content,l.content,n+1);if(o!=null)return o}n+=i.nodeSize}}function h$(t,s,n,a){for(let i=t.childCount,l=s.childCount;;){if(i==0||l==0)return i==l?null:{a:n,b:a};let o=t.child(--i),c=s.child(--l),d=o.nodeSize;if(o==c){n-=d,a-=d;continue}if(!o.sameMarkup(c))return{a:n,b:a};if(o.isText&&o.text!=c.text){let u=0,f=Math.min(o.text.length,c.text.length);for(;u<f&&o.text[o.text.length-u-1]==c.text[c.text.length-u-1];)u++,n--,a--;return{a:n,b:a}}if(o.content.size||c.content.size){let u=h$(o.content,c.content,n-1,a-1);if(u)return u}n-=d,a-=d}}class Fe{constructor(s,n){if(this.content=s,this.size=n||0,n==null)for(let a=0;a<s.length;a++)this.size+=s[a].nodeSize}nodesBetween(s,n,a,i=0,l){for(let o=0,c=0;c<n;o++){let d=this.content[o],u=c+d.nodeSize;if(u>s&&a(d,i+c,l||null,o)!==!1&&d.content.size){let f=c+1;d.nodesBetween(Math.max(0,s-f),Math.min(d.content.size,n-f),a,i+f)}c=u}}descendants(s){this.nodesBetween(0,this.size,s)}textBetween(s,n,a,i){let l="",o=!0;return this.nodesBetween(s,n,(c,d)=>{let u=c.isText?c.text.slice(Math.max(s,d)-d,n-d):c.isLeaf?i?typeof i=="function"?i(c):i:c.type.spec.leafText?c.type.spec.leafText(c):"":"";c.isBlock&&(c.isLeaf&&u||c.isTextblock)&&a&&(o?o=!1:l+=a),l+=u},0),l}append(s){if(!s.size)return this;if(!this.size)return s;let n=this.lastChild,a=s.firstChild,i=this.content.slice(),l=0;for(n.isText&&n.sameMarkup(a)&&(i[i.length-1]=n.withText(n.text+a.text),l=1);l<s.content.length;l++)i.push(s.content[l]);return new Fe(i,this.size+s.size)}cut(s,n=this.size){if(s==0&&n==this.size)return this;let a=[],i=0;if(n>s)for(let l=0,o=0;o<n;l++){let c=this.content[l],d=o+c.nodeSize;d>s&&((o<s||d>n)&&(c.isText?c=c.cut(Math.max(0,s-o),Math.min(c.text.length,n-o)):c=c.cut(Math.max(0,s-o-1),Math.min(c.content.size,n-o-1))),a.push(c),i+=c.nodeSize),o=d}return new Fe(a,i)}cutByIndex(s,n){return s==n?Fe.empty:s==0&&n==this.content.length?this:new Fe(this.content.slice(s,n))}replaceChild(s,n){let a=this.content[s];if(a==n)return this;let i=this.content.slice(),l=this.size+n.nodeSize-a.nodeSize;return i[s]=n,new Fe(i,l)}addToStart(s){return new Fe([s].concat(this.content),this.size+s.nodeSize)}addToEnd(s){return new Fe(this.content.concat(s),this.size+s.nodeSize)}eq(s){if(this.content.length!=s.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(s.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(s){let n=this.content[s];if(!n)throw new RangeError("Index "+s+" out of range for "+this);return n}maybeChild(s){return this.content[s]||null}forEach(s){for(let n=0,a=0;n<this.content.length;n++){let i=this.content[n];s(i,a,n),a+=i.nodeSize}}findDiffStart(s,n=0){return u$(this,s,n)}findDiffEnd(s,n=this.size,a=s.size){return h$(this,s,n,a)}findIndex(s){if(s==0)return $0(0,s);if(s==this.size)return $0(this.content.length,s);if(s>this.size||s<0)throw new RangeError(`Position ${s} outside of fragment (${this})`);for(let n=0,a=0;;n++){let i=this.child(n),l=a+i.nodeSize;if(l>=s)return l==s?$0(n+1,l):$0(n,a);a=l}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(s=>s.toJSON()):null}static fromJSON(s,n){if(!n)return Fe.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new Fe(n.map(s.nodeFromJSON))}static fromArray(s){if(!s.length)return Fe.empty;let n,a=0;for(let i=0;i<s.length;i++){let l=s[i];a+=l.nodeSize,i&&l.isText&&s[i-1].sameMarkup(l)?(n||(n=s.slice(0,i)),n[n.length-1]=l.withText(n[n.length-1].text+l.text)):n&&n.push(l)}return new Fe(n||s,a)}static from(s){if(!s)return Fe.empty;if(s instanceof Fe)return s;if(Array.isArray(s))return this.fromArray(s);if(s.attrs)return new Fe([s],s.nodeSize);throw new RangeError("Can not convert "+s+" to a Fragment"+(s.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Fe.empty=new Fe([],0);const ZN={index:0,offset:0};function $0(t,s){return ZN.index=t,ZN.offset=s,ZN}function Ky(t,s){if(t===s)return!0;if(!(t&&typeof t=="object")||!(s&&typeof s=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(s)!=n)return!1;if(n){if(t.length!=s.length)return!1;for(let a=0;a<t.length;a++)if(!Ky(t[a],s[a]))return!1}else{for(let a in t)if(!(a in s)||!Ky(t[a],s[a]))return!1;for(let a in s)if(!(a in t))return!1}return!0}let qs=class eS{constructor(s,n){this.type=s,this.attrs=n}addToSet(s){let n,a=!1;for(let i=0;i<s.length;i++){let l=s[i];if(this.eq(l))return s;if(this.type.excludes(l.type))n||(n=s.slice(0,i));else{if(l.type.excludes(this.type))return s;!a&&l.type.rank>this.type.rank&&(n||(n=s.slice(0,i)),n.push(this),a=!0),n&&n.push(l)}}return n||(n=s.slice()),a||n.push(this),n}removeFromSet(s){for(let n=0;n<s.length;n++)if(this.eq(s[n]))return s.slice(0,n).concat(s.slice(n+1));return s}isInSet(s){for(let n=0;n<s.length;n++)if(this.eq(s[n]))return!0;return!1}eq(s){return this==s||this.type==s.type&&Ky(this.attrs,s.attrs)}toJSON(){let s={type:this.type.name};for(let n in this.attrs){s.attrs=this.attrs;break}return s}static fromJSON(s,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let a=s.marks[n.type];if(!a)throw new RangeError(`There is no mark type ${n.type} in this schema`);let i=a.create(n.attrs);return a.checkAttrs(i.attrs),i}static sameSet(s,n){if(s==n)return!0;if(s.length!=n.length)return!1;for(let a=0;a<s.length;a++)if(!s[a].eq(n[a]))return!1;return!0}static setFrom(s){if(!s||Array.isArray(s)&&s.length==0)return eS.none;if(s instanceof eS)return[s];let n=s.slice();return n.sort((a,i)=>a.type.rank-i.type.rank),n}};qs.none=[];class Yy extends Error{}class nt{constructor(s,n,a){this.content=s,this.openStart=n,this.openEnd=a}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(s,n){let a=m$(this.content,s+this.openStart,n);return a&&new nt(a,this.openStart,this.openEnd)}removeBetween(s,n){return new nt(f$(this.content,s+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(s){return this.content.eq(s.content)&&this.openStart==s.openStart&&this.openEnd==s.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let s={content:this.content.toJSON()};return this.openStart>0&&(s.openStart=this.openStart),this.openEnd>0&&(s.openEnd=this.openEnd),s}static fromJSON(s,n){if(!n)return nt.empty;let a=n.openStart||0,i=n.openEnd||0;if(typeof a!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new nt(Fe.fromJSON(s,n.content),a,i)}static maxOpen(s,n=!0){let a=0,i=0;for(let l=s.firstChild;l&&!l.isLeaf&&(n||!l.type.spec.isolating);l=l.firstChild)a++;for(let l=s.lastChild;l&&!l.isLeaf&&(n||!l.type.spec.isolating);l=l.lastChild)i++;return new nt(s,a,i)}}nt.empty=new nt(Fe.empty,0,0);function f$(t,s,n){let{index:a,offset:i}=t.findIndex(s),l=t.maybeChild(a),{index:o,offset:c}=t.findIndex(n);if(i==s||l.isText){if(c!=n&&!t.child(o).isText)throw new RangeError("Removing non-flat range");return t.cut(0,s).append(t.cut(n))}if(a!=o)throw new RangeError("Removing non-flat range");return t.replaceChild(a,l.copy(f$(l.content,s-i-1,n-i-1)))}function m$(t,s,n,a){let{index:i,offset:l}=t.findIndex(s),o=t.maybeChild(i);if(l==s||o.isText)return a&&!a.canReplace(i,i,n)?null:t.cut(0,s).append(n).append(t.cut(s));let c=m$(o.content,s-l-1,n,o);return c&&t.replaceChild(i,o.copy(c))}function L0e(t,s,n){if(n.openStart>t.depth)throw new Yy("Inserted content deeper than insertion position");if(t.depth-n.openStart!=s.depth-n.openEnd)throw new Yy("Inconsistent open depths");return p$(t,s,n,0)}function p$(t,s,n,a){let i=t.index(a),l=t.node(a);if(i==s.index(a)&&a<t.depth-n.openStart){let o=p$(t,s,n,a+1);return l.copy(l.content.replaceChild(i,o))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==a&&s.depth==a){let o=t.parent,c=o.content;return Zd(o,c.cut(0,t.parentOffset).append(n.content).append(c.cut(s.parentOffset)))}else{let{start:o,end:c}=B0e(n,t);return Zd(l,g$(t,o,c,s,a))}else return Zd(l,Xy(t,s,a))}function x$(t,s){if(!s.type.compatibleContent(t.type))throw new Yy("Cannot join "+s.type.name+" onto "+t.type.name)}function tS(t,s,n){let a=t.node(n);return x$(a,s.node(n)),a}function Qd(t,s){let n=s.length-1;n>=0&&t.isText&&t.sameMarkup(s[n])?s[n]=t.withText(s[n].text+t.text):s.push(t)}function ap(t,s,n,a){let i=(s||t).node(n),l=0,o=s?s.index(n):i.childCount;t&&(l=t.index(n),t.depth>n?l++:t.textOffset&&(Qd(t.nodeAfter,a),l++));for(let c=l;c<o;c++)Qd(i.child(c),a);s&&s.depth==n&&s.textOffset&&Qd(s.nodeBefore,a)}function Zd(t,s){return t.type.checkContent(s),t.copy(s)}function g$(t,s,n,a,i){let l=t.depth>i&&tS(t,s,i+1),o=a.depth>i&&tS(n,a,i+1),c=[];return ap(null,t,i,c),l&&o&&s.index(i)==n.index(i)?(x$(l,o),Qd(Zd(l,g$(t,s,n,a,i+1)),c)):(l&&Qd(Zd(l,Xy(t,s,i+1)),c),ap(s,n,i,c),o&&Qd(Zd(o,Xy(n,a,i+1)),c)),ap(a,null,i,c),new Fe(c)}function Xy(t,s,n){let a=[];if(ap(null,t,n,a),t.depth>n){let i=tS(t,s,n+1);Qd(Zd(i,Xy(t,s,n+1)),a)}return ap(s,null,n,a),new Fe(a)}function B0e(t,s){let n=s.depth-t.openStart,i=s.node(n).copy(t.content);for(let l=n-1;l>=0;l--)i=s.node(l).copy(Fe.from(i));return{start:i.resolveNoCache(t.openStart+n),end:i.resolveNoCache(i.content.size-t.openEnd-n)}}class Up{constructor(s,n,a){this.pos=s,this.path=n,this.parentOffset=a,this.depth=n.length/3-1}resolveDepth(s){return s==null?this.depth:s<0?this.depth+s:s}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(s){return this.path[this.resolveDepth(s)*3]}index(s){return this.path[this.resolveDepth(s)*3+1]}indexAfter(s){return s=this.resolveDepth(s),this.index(s)+(s==this.depth&&!this.textOffset?0:1)}start(s){return s=this.resolveDepth(s),s==0?0:this.path[s*3-1]+1}end(s){return s=this.resolveDepth(s),this.start(s)+this.node(s).content.size}before(s){if(s=this.resolveDepth(s),!s)throw new RangeError("There is no position before the top-level node");return s==this.depth+1?this.pos:this.path[s*3-1]}after(s){if(s=this.resolveDepth(s),!s)throw new RangeError("There is no position after the top-level node");return s==this.depth+1?this.pos:this.path[s*3-1]+this.path[s*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let s=this.parent,n=this.index(this.depth);if(n==s.childCount)return null;let a=this.pos-this.path[this.path.length-1],i=s.child(n);return a?s.child(n).cut(a):i}get nodeBefore(){let s=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(s).cut(0,n):s==0?null:this.parent.child(s-1)}posAtIndex(s,n){n=this.resolveDepth(n);let a=this.path[n*3],i=n==0?0:this.path[n*3-1]+1;for(let l=0;l<s;l++)i+=a.child(l).nodeSize;return i}marks(){let s=this.parent,n=this.index();if(s.content.size==0)return qs.none;if(this.textOffset)return s.child(n).marks;let a=s.maybeChild(n-1),i=s.maybeChild(n);if(!a){let c=a;a=i,i=c}let l=a.marks;for(var o=0;o<l.length;o++)l[o].type.spec.inclusive===!1&&(!i||!l[o].isInSet(i.marks))&&(l=l[o--].removeFromSet(l));return l}marksAcross(s){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let a=n.marks,i=s.parent.maybeChild(s.index());for(var l=0;l<a.length;l++)a[l].type.spec.inclusive===!1&&(!i||!a[l].isInSet(i.marks))&&(a=a[l--].removeFromSet(a));return a}sharedDepth(s){for(let n=this.depth;n>0;n--)if(this.start(n)<=s&&this.end(n)>=s)return n;return 0}blockRange(s=this,n){if(s.pos<this.pos)return s.blockRange(this);for(let a=this.depth-(this.parent.inlineContent||this.pos==s.pos?1:0);a>=0;a--)if(s.pos<=this.end(a)&&(!n||n(this.node(a))))return new Qy(this,s,a);return null}sameParent(s){return this.pos-this.parentOffset==s.pos-s.parentOffset}max(s){return s.pos>this.pos?s:this}min(s){return s.pos<this.pos?s:this}toString(){let s="";for(let n=1;n<=this.depth;n++)s+=(s?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return s+":"+this.parentOffset}static resolve(s,n){if(!(n>=0&&n<=s.content.size))throw new RangeError("Position "+n+" out of range");let a=[],i=0,l=n;for(let o=s;;){let{index:c,offset:d}=o.content.findIndex(l),u=l-d;if(a.push(o,c,i+d),!u||(o=o.child(c),o.isText))break;l=u-1,i+=d+1}return new Up(n,a,l)}static resolveCached(s,n){let a=jI.get(s);if(a)for(let l=0;l<a.elts.length;l++){let o=a.elts[l];if(o.pos==n)return o}else jI.set(s,a=new F0e);let i=a.elts[a.i]=Up.resolve(s,n);return a.i=(a.i+1)%$0e,i}}class F0e{constructor(){this.elts=[],this.i=0}}const $0e=12,jI=new WeakMap;class Qy{constructor(s,n,a){this.$from=s,this.$to=n,this.depth=a}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const z0e=Object.create(null);let Mc=class sS{constructor(s,n,a,i=qs.none){this.type=s,this.attrs=n,this.marks=i,this.content=a||Fe.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(s){return this.content.child(s)}maybeChild(s){return this.content.maybeChild(s)}forEach(s){this.content.forEach(s)}nodesBetween(s,n,a,i=0){this.content.nodesBetween(s,n,a,i,this)}descendants(s){this.nodesBetween(0,this.content.size,s)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(s,n,a,i){return this.content.textBetween(s,n,a,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(s){return this==s||this.sameMarkup(s)&&this.content.eq(s.content)}sameMarkup(s){return this.hasMarkup(s.type,s.attrs,s.marks)}hasMarkup(s,n,a){return this.type==s&&Ky(this.attrs,n||s.defaultAttrs||z0e)&&qs.sameSet(this.marks,a||qs.none)}copy(s=null){return s==this.content?this:new sS(this.type,this.attrs,s,this.marks)}mark(s){return s==this.marks?this:new sS(this.type,this.attrs,this.content,s)}cut(s,n=this.content.size){return s==0&&n==this.content.size?this:this.copy(this.content.cut(s,n))}slice(s,n=this.content.size,a=!1){if(s==n)return nt.empty;let i=this.resolve(s),l=this.resolve(n),o=a?0:i.sharedDepth(n),c=i.start(o),u=i.node(o).content.cut(i.pos-c,l.pos-c);return new nt(u,i.depth-o,l.depth-o)}replace(s,n,a){return L0e(this.resolve(s),this.resolve(n),a)}nodeAt(s){for(let n=this;;){let{index:a,offset:i}=n.content.findIndex(s);if(n=n.maybeChild(a),!n)return null;if(i==s||n.isText)return n;s-=i+1}}childAfter(s){let{index:n,offset:a}=this.content.findIndex(s);return{node:this.content.maybeChild(n),index:n,offset:a}}childBefore(s){if(s==0)return{node:null,index:0,offset:0};let{index:n,offset:a}=this.content.findIndex(s);if(a<s)return{node:this.content.child(n),index:n,offset:a};let i=this.content.child(n-1);return{node:i,index:n-1,offset:a-i.nodeSize}}resolve(s){return Up.resolveCached(this,s)}resolveNoCache(s){return Up.resolve(this,s)}rangeHasMark(s,n,a){let i=!1;return n>s&&this.nodesBetween(s,n,l=>(a.isInSet(l.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let s=this.type.name;return this.content.size&&(s+="("+this.content.toStringInner()+")"),y$(this.marks,s)}contentMatchAt(s){let n=this.type.contentMatch.matchFragment(this.content,0,s);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(s,n,a=Fe.empty,i=0,l=a.childCount){let o=this.contentMatchAt(s).matchFragment(a,i,l),c=o&&o.matchFragment(this.content,n);if(!c||!c.validEnd)return!1;for(let d=i;d<l;d++)if(!this.type.allowsMarks(a.child(d).marks))return!1;return!0}canReplaceWith(s,n,a,i){if(i&&!this.type.allowsMarks(i))return!1;let l=this.contentMatchAt(s).matchType(a),o=l&&l.matchFragment(this.content,n);return o?o.validEnd:!1}canAppend(s){return s.content.size?this.canReplace(this.childCount,this.childCount,s.content):this.type.compatibleContent(s.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let s=qs.none;for(let n=0;n<this.marks.length;n++){let a=this.marks[n];a.type.checkAttrs(a.attrs),s=a.addToSet(s)}if(!qs.sameSet(s,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let s={type:this.type.name};for(let n in this.attrs){s.attrs=this.attrs;break}return this.content.size&&(s.content=this.content.toJSON()),this.marks.length&&(s.marks=this.marks.map(n=>n.toJSON())),s}static fromJSON(s,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let a;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");a=n.marks.map(s.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return s.text(n.text,a)}let i=Fe.fromJSON(s,n.content),l=s.nodeType(n.type).create(n.attrs,i,a);return l.type.checkAttrs(l.attrs),l}};Mc.prototype.text=void 0;class Zy extends Mc{constructor(s,n,a,i){if(super(s,n,null,i),!a)throw new RangeError("Empty text nodes are not allowed");this.text=a}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):y$(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(s,n){return this.text.slice(s,n)}get nodeSize(){return this.text.length}mark(s){return s==this.marks?this:new Zy(this.type,this.attrs,this.text,s)}withText(s){return s==this.text?this:new Zy(this.type,this.attrs,s,this.marks)}cut(s=0,n=this.text.length){return s==0&&n==this.text.length?this:this.withText(this.text.slice(s,n))}eq(s){return this.sameMarkup(s)&&this.text==s.text}toJSON(){let s=super.toJSON();return s.text=this.text,s}}function y$(t,s){for(let n=t.length-1;n>=0;n--)s=t[n].type.name+"("+s+")";return s}class xu{constructor(s){this.validEnd=s,this.next=[],this.wrapCache=[]}static parse(s,n){let a=new U0e(s,n);if(a.next==null)return xu.empty;let i=b$(a);a.next&&a.err("Unexpected trailing text");let l=Y0e(K0e(i));return X0e(l,a),l}matchType(s){for(let n=0;n<this.next.length;n++)if(this.next[n].type==s)return this.next[n].next;return null}matchFragment(s,n=0,a=s.childCount){let i=this;for(let l=n;i&&l<a;l++)i=i.matchType(s.child(l).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let s=0;s<this.next.length;s++){let{type:n}=this.next[s];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(s){for(let n=0;n<this.next.length;n++)for(let a=0;a<s.next.length;a++)if(this.next[n].type==s.next[a].type)return!0;return!1}fillBefore(s,n=!1,a=0){let i=[this];function l(o,c){let d=o.matchFragment(s,a);if(d&&(!n||d.validEnd))return Fe.from(c.map(u=>u.createAndFill()));for(let u=0;u<o.next.length;u++){let{type:f,next:m}=o.next[u];if(!(f.isText||f.hasRequiredAttrs())&&i.indexOf(m)==-1){i.push(m);let x=l(m,c.concat(f));if(x)return x}}return null}return l(this,[])}findWrapping(s){for(let a=0;a<this.wrapCache.length;a+=2)if(this.wrapCache[a]==s)return this.wrapCache[a+1];let n=this.computeWrapping(s);return this.wrapCache.push(s,n),n}computeWrapping(s){let n=Object.create(null),a=[{match:this,type:null,via:null}];for(;a.length;){let i=a.shift(),l=i.match;if(l.matchType(s)){let o=[];for(let c=i;c.type;c=c.via)o.push(c.type);return o.reverse()}for(let o=0;o<l.next.length;o++){let{type:c,next:d}=l.next[o];!c.isLeaf&&!c.hasRequiredAttrs()&&!(c.name in n)&&(!i.type||d.validEnd)&&(a.push({match:c.contentMatch,type:c,via:i}),n[c.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(s){if(s>=this.next.length)throw new RangeError(`There's no ${s}th edge in this content match`);return this.next[s]}toString(){let s=[];function n(a){s.push(a);for(let i=0;i<a.next.length;i++)s.indexOf(a.next[i].next)==-1&&n(a.next[i].next)}return n(this),s.map((a,i)=>{let l=i+(a.validEnd?"*":" ")+" ";for(let o=0;o<a.next.length;o++)l+=(o?", ":"")+a.next[o].type.name+"->"+s.indexOf(a.next[o].next);return l}).join(`
`)}}xu.empty=new xu(!0);class U0e{constructor(s,n){this.string=s,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=s.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(s){return this.next==s&&(this.pos++||!0)}err(s){throw new SyntaxError(s+" (in content expression '"+this.string+"')")}}function b$(t){let s=[];do s.push(V0e(t));while(t.eat("|"));return s.length==1?s[0]:{type:"choice",exprs:s}}function V0e(t){let s=[];do s.push(H0e(t));while(t.next&&t.next!=")"&&t.next!="|");return s.length==1?s[0]:{type:"seq",exprs:s}}function H0e(t){let s=G0e(t);for(;;)if(t.eat("+"))s={type:"plus",expr:s};else if(t.eat("*"))s={type:"star",expr:s};else if(t.eat("?"))s={type:"opt",expr:s};else if(t.eat("{"))s=W0e(t,s);else break;return s}function _I(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let s=Number(t.next);return t.pos++,s}function W0e(t,s){let n=_I(t),a=n;return t.eat(",")&&(t.next!="}"?a=_I(t):a=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:a,expr:s}}function q0e(t,s){let n=t.nodeTypes,a=n[s];if(a)return[a];let i=[];for(let l in n){let o=n[l];o.isInGroup(s)&&i.push(o)}return i.length==0&&t.err("No node type or group '"+s+"' found"),i}function G0e(t){if(t.eat("(")){let s=b$(t);return t.eat(")")||t.err("Missing closing paren"),s}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let s=q0e(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,s.length==1?s[0]:{type:"choice",exprs:s}}}function K0e(t){let s=[[]];return i(l(t,0),n()),s;function n(){return s.push([])-1}function a(o,c,d){let u={term:d,to:c};return s[o].push(u),u}function i(o,c){o.forEach(d=>d.to=c)}function l(o,c){if(o.type=="choice")return o.exprs.reduce((d,u)=>d.concat(l(u,c)),[]);if(o.type=="seq")for(let d=0;;d++){let u=l(o.exprs[d],c);if(d==o.exprs.length-1)return u;i(u,c=n())}else if(o.type=="star"){let d=n();return a(c,d),i(l(o.expr,d),d),[a(d)]}else if(o.type=="plus"){let d=n();return i(l(o.expr,c),d),i(l(o.expr,d),d),[a(d)]}else{if(o.type=="opt")return[a(c)].concat(l(o.expr,c));if(o.type=="range"){let d=c;for(let u=0;u<o.min;u++){let f=n();i(l(o.expr,d),f),d=f}if(o.max==-1)i(l(o.expr,d),d);else for(let u=o.min;u<o.max;u++){let f=n();a(d,f),i(l(o.expr,d),f),d=f}return[a(d)]}else{if(o.type=="name")return[a(c,void 0,o.value)];throw new Error("Unknown expr type")}}}}function v$(t,s){return s-t}function SI(t,s){let n=[];return a(s),n.sort(v$);function a(i){let l=t[i];if(l.length==1&&!l[0].term)return a(l[0].to);n.push(i);for(let o=0;o<l.length;o++){let{term:c,to:d}=l[o];!c&&n.indexOf(d)==-1&&a(d)}}}function Y0e(t){let s=Object.create(null);return n(SI(t,0));function n(a){let i=[];a.forEach(o=>{t[o].forEach(({term:c,to:d})=>{if(!c)return;let u;for(let f=0;f<i.length;f++)i[f][0]==c&&(u=i[f][1]);SI(t,d).forEach(f=>{u||i.push([c,u=[]]),u.indexOf(f)==-1&&u.push(f)})})});let l=s[a.join(",")]=new xu(a.indexOf(t.length-1)>-1);for(let o=0;o<i.length;o++){let c=i[o][1].sort(v$);l.next.push({type:i[o][0],next:s[c.join(",")]||n(c)})}return l}}function X0e(t,s){for(let n=0,a=[t];n<a.length;n++){let i=a[n],l=!i.validEnd,o=[];for(let c=0;c<i.next.length;c++){let{type:d,next:u}=i.next[c];o.push(d.name),l&&!(d.isText||d.hasRequiredAttrs())&&(l=!1),a.indexOf(u)==-1&&a.push(u)}l&&s.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function w$(t){let s=Object.create(null);for(let n in t){let a=t[n];if(!a.hasDefault)return null;s[n]=a.default}return s}function N$(t,s){let n=Object.create(null);for(let a in t){let i=s&&s[a];if(i===void 0){let l=t[a];if(l.hasDefault)i=l.default;else throw new RangeError("No value supplied for attribute "+a)}n[a]=i}return n}function j$(t,s,n,a){for(let i in s)if(!(i in t))throw new RangeError(`Unsupported attribute ${i} for ${n} of type ${i}`);for(let i in t){let l=t[i];l.validate&&l.validate(s[i])}}function _$(t,s){let n=Object.create(null);if(s)for(let a in s)n[a]=new Z0e(t,a,s[a]);return n}let CI=class S${constructor(s,n,a){this.name=s,this.schema=n,this.spec=a,this.markSet=null,this.groups=a.group?a.group.split(" "):[],this.attrs=_$(s,a.attrs),this.defaultAttrs=w$(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(a.inline||s=="text"),this.isText=s=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==xu.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(s){return this.groups.indexOf(s)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let s in this.attrs)if(this.attrs[s].isRequired)return!0;return!1}compatibleContent(s){return this==s||this.contentMatch.compatible(s.contentMatch)}computeAttrs(s){return!s&&this.defaultAttrs?this.defaultAttrs:N$(this.attrs,s)}create(s=null,n,a){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Mc(this,this.computeAttrs(s),Fe.from(n),qs.setFrom(a))}createChecked(s=null,n,a){return n=Fe.from(n),this.checkContent(n),new Mc(this,this.computeAttrs(s),n,qs.setFrom(a))}createAndFill(s=null,n,a){if(s=this.computeAttrs(s),n=Fe.from(n),n.size){let o=this.contentMatch.fillBefore(n);if(!o)return null;n=o.append(n)}let i=this.contentMatch.matchFragment(n),l=i&&i.fillBefore(Fe.empty,!0);return l?new Mc(this,s,n.append(l),qs.setFrom(a)):null}validContent(s){let n=this.contentMatch.matchFragment(s);if(!n||!n.validEnd)return!1;for(let a=0;a<s.childCount;a++)if(!this.allowsMarks(s.child(a).marks))return!1;return!0}checkContent(s){if(!this.validContent(s))throw new RangeError(`Invalid content for node ${this.name}: ${s.toString().slice(0,50)}`)}checkAttrs(s){j$(this.attrs,s,"node",this.name)}allowsMarkType(s){return this.markSet==null||this.markSet.indexOf(s)>-1}allowsMarks(s){if(this.markSet==null)return!0;for(let n=0;n<s.length;n++)if(!this.allowsMarkType(s[n].type))return!1;return!0}allowedMarks(s){if(this.markSet==null)return s;let n;for(let a=0;a<s.length;a++)this.allowsMarkType(s[a].type)?n&&n.push(s[a]):n||(n=s.slice(0,a));return n?n.length?n:qs.none:s}static compile(s,n){let a=Object.create(null);s.forEach((l,o)=>a[l]=new S$(l,n,o));let i=n.spec.topNode||"doc";if(!a[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!a.text)throw new RangeError("Every schema needs a 'text' type");for(let l in a.text.attrs)throw new RangeError("The text node type should not have attributes");return a}};function Q0e(t,s,n){let a=n.split("|");return i=>{let l=i===null?"null":typeof i;if(a.indexOf(l)<0)throw new RangeError(`Expected value of type ${a} for attribute ${s} on type ${t}, got ${l}`)}}class Z0e{constructor(s,n,a){this.hasDefault=Object.prototype.hasOwnProperty.call(a,"default"),this.default=a.default,this.validate=typeof a.validate=="string"?Q0e(s,n,a.validate):a.validate}get isRequired(){return!this.hasDefault}}class Jb{constructor(s,n,a,i){this.name=s,this.rank=n,this.schema=a,this.spec=i,this.attrs=_$(s,i.attrs),this.excluded=null;let l=w$(this.attrs);this.instance=l?new qs(this,l):null}create(s=null){return!s&&this.instance?this.instance:new qs(this,N$(this.attrs,s))}static compile(s,n){let a=Object.create(null),i=0;return s.forEach((l,o)=>a[l]=new Jb(l,i++,n,o)),a}removeFromSet(s){for(var n=0;n<s.length;n++)s[n].type==this&&(s=s.slice(0,n).concat(s.slice(n+1)),n--);return s}isInSet(s){for(let n=0;n<s.length;n++)if(s[n].type==this)return s[n]}checkAttrs(s){j$(this.attrs,s,"mark",this.name)}excludes(s){return this.excluded.indexOf(s)>-1}}class C${constructor(s){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let i in s)n[i]=s[i];n.nodes=Sr.from(s.nodes),n.marks=Sr.from(s.marks||{}),this.nodes=CI.compile(this.spec.nodes,this),this.marks=Jb.compile(this.spec.marks,this);let a=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let l=this.nodes[i],o=l.spec.content||"",c=l.spec.marks;if(l.contentMatch=a[o]||(a[o]=xu.parse(o,this.nodes)),l.inlineContent=l.contentMatch.inlineContent,l.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!l.isInline||!l.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=l}l.markSet=c=="_"?null:c?kI(this,c.split(" ")):c==""||!l.inlineContent?[]:null}for(let i in this.marks){let l=this.marks[i],o=l.spec.excludes;l.excluded=o==null?[l]:o==""?[]:kI(this,o.split(" "))}this.nodeFromJSON=i=>Mc.fromJSON(this,i),this.markFromJSON=i=>qs.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(s,n=null,a,i){if(typeof s=="string")s=this.nodeType(s);else if(s instanceof CI){if(s.schema!=this)throw new RangeError("Node type from different schema used ("+s.name+")")}else throw new RangeError("Invalid node type: "+s);return s.createChecked(n,a,i)}text(s,n){let a=this.nodes.text;return new Zy(a,a.defaultAttrs,s,qs.setFrom(n))}mark(s,n){return typeof s=="string"&&(s=this.marks[s]),s.create(n)}nodeType(s){let n=this.nodes[s];if(!n)throw new RangeError("Unknown node type: "+s);return n}}function kI(t,s){let n=[];for(let a=0;a<s.length;a++){let i=s[a],l=t.marks[i],o=l;if(l)n.push(l);else for(let c in t.marks){let d=t.marks[c];(i=="_"||d.spec.group&&d.spec.group.split(" ").indexOf(i)>-1)&&n.push(o=d)}if(!o)throw new SyntaxError("Unknown mark type: '"+s[a]+"'")}return n}function J0e(t){return t.tag!=null}function ege(t){return t.style!=null}class zl{constructor(s,n){this.schema=s,this.rules=n,this.tags=[],this.styles=[];let a=this.matchedStyles=[];n.forEach(i=>{if(J0e(i))this.tags.push(i);else if(ege(i)){let l=/[^=]*/.exec(i.style)[0];a.indexOf(l)<0&&a.push(l),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let l=s.nodes[i.node];return l.contentMatch.matchType(l)})}parse(s,n={}){let a=new EI(this,n,!1);return a.addAll(s,qs.none,n.from,n.to),a.finish()}parseSlice(s,n={}){let a=new EI(this,n,!0);return a.addAll(s,qs.none,n.from,n.to),nt.maxOpen(a.finish())}matchTag(s,n,a){for(let i=a?this.tags.indexOf(a)+1:0;i<this.tags.length;i++){let l=this.tags[i];if(nge(s,l.tag)&&(l.namespace===void 0||s.namespaceURI==l.namespace)&&(!l.context||n.matchesContext(l.context))){if(l.getAttrs){let o=l.getAttrs(s);if(o===!1)continue;l.attrs=o||void 0}return l}}}matchStyle(s,n,a,i){for(let l=i?this.styles.indexOf(i)+1:0;l<this.styles.length;l++){let o=this.styles[l],c=o.style;if(!(c.indexOf(s)!=0||o.context&&!a.matchesContext(o.context)||c.length>s.length&&(c.charCodeAt(s.length)!=61||c.slice(s.length+1)!=n))){if(o.getAttrs){let d=o.getAttrs(n);if(d===!1)continue;o.attrs=d||void 0}return o}}}static schemaRules(s){let n=[];function a(i){let l=i.priority==null?50:i.priority,o=0;for(;o<n.length;o++){let c=n[o];if((c.priority==null?50:c.priority)<l)break}n.splice(o,0,i)}for(let i in s.marks){let l=s.marks[i].spec.parseDOM;l&&l.forEach(o=>{a(o=TI(o)),o.mark||o.ignore||o.clearMark||(o.mark=i)})}for(let i in s.nodes){let l=s.nodes[i].spec.parseDOM;l&&l.forEach(o=>{a(o=TI(o)),o.node||o.ignore||o.mark||(o.node=i)})}return n}static fromSchema(s){return s.cached.domParser||(s.cached.domParser=new zl(s,zl.schemaRules(s)))}}const k$={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},tge={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},A$={ol:!0,ul:!0},Vp=1,nS=2,ip=4;function AI(t,s,n){return s!=null?(s?Vp:0)|(s==="full"?nS:0):t&&t.whitespace=="pre"?Vp|nS:n&~ip}class z0{constructor(s,n,a,i,l,o){this.type=s,this.attrs=n,this.marks=a,this.solid=i,this.options=o,this.content=[],this.activeMarks=qs.none,this.match=l||(o&ip?null:s.contentMatch)}findWrapping(s){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(Fe.from(s));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let a=this.type.contentMatch,i;return(i=a.findWrapping(s.type))?(this.match=a,i):null}}return this.match.findWrapping(s.type)}finish(s){if(!(this.options&Vp)){let a=this.content[this.content.length-1],i;if(a&&a.isText&&(i=/[ \t\r\n\u000c]+$/.exec(a.text))){let l=a;a.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=l.withText(l.text.slice(0,l.text.length-i[0].length))}}let n=Fe.from(this.content);return!s&&this.match&&(n=n.append(this.match.fillBefore(Fe.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(s){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:s.parentNode&&!k$.hasOwnProperty(s.parentNode.nodeName.toLowerCase())}}class EI{constructor(s,n,a){this.parser=s,this.options=n,this.isOpen=a,this.open=0,this.localPreserveWS=!1;let i=n.topNode,l,o=AI(null,n.preserveWhitespace,0)|(a?ip:0);i?l=new z0(i.type,i.attrs,qs.none,!0,n.topMatch||i.type.contentMatch,o):a?l=new z0(null,null,qs.none,!0,null,o):l=new z0(s.schema.topNodeType,null,qs.none,!0,null,o),this.nodes=[l],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(s,n){s.nodeType==3?this.addTextNode(s,n):s.nodeType==1&&this.addElement(s,n)}addTextNode(s,n){let a=s.nodeValue,i=this.top,l=i.options&nS?"full":this.localPreserveWS||(i.options&Vp)>0,{schema:o}=this.parser;if(l==="full"||i.inlineContext(s)||/[^ \t\r\n\u000c]/.test(a)){if(l)if(l==="full")a=a.replace(/\r\n?/g,`
`);else if(o.linebreakReplacement&&/[\r\n]/.test(a)&&this.top.findWrapping(o.linebreakReplacement.create())){let c=a.split(/\r?\n|\r/);for(let d=0;d<c.length;d++)d&&this.insertNode(o.linebreakReplacement.create(),n,!0),c[d]&&this.insertNode(o.text(c[d]),n,!/\S/.test(c[d]));a=""}else a=a.replace(/\r?\n|\r/g," ");else if(a=a.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(a)&&this.open==this.nodes.length-1){let c=i.content[i.content.length-1],d=s.previousSibling;(!c||d&&d.nodeName=="BR"||c.isText&&/[ \t\r\n\u000c]$/.test(c.text))&&(a=a.slice(1))}a&&this.insertNode(o.text(a),n,!/\S/.test(a)),this.findInText(s)}else this.findInside(s)}addElement(s,n,a){let i=this.localPreserveWS,l=this.top;(s.tagName=="PRE"||/pre/.test(s.style&&s.style.whiteSpace))&&(this.localPreserveWS=!0);let o=s.nodeName.toLowerCase(),c;A$.hasOwnProperty(o)&&this.parser.normalizeLists&&sge(s);let d=this.options.ruleFromNode&&this.options.ruleFromNode(s)||(c=this.parser.matchTag(s,this,a));e:if(d?d.ignore:tge.hasOwnProperty(o))this.findInside(s),this.ignoreFallback(s,n);else if(!d||d.skip||d.closeParent){d&&d.closeParent?this.open=Math.max(0,this.open-1):d&&d.skip.nodeType&&(s=d.skip);let u,f=this.needsBlock;if(k$.hasOwnProperty(o))l.content.length&&l.content[0].isInline&&this.open&&(this.open--,l=this.top),u=!0,l.type||(this.needsBlock=!0);else if(!s.firstChild){this.leafFallback(s,n);break e}let m=d&&d.skip?n:this.readStyles(s,n);m&&this.addAll(s,m),u&&this.sync(l),this.needsBlock=f}else{let u=this.readStyles(s,n);u&&this.addElementByRule(s,d,u,d.consuming===!1?c:void 0)}this.localPreserveWS=i}leafFallback(s,n){s.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(s.ownerDocument.createTextNode(`
`),n)}ignoreFallback(s,n){s.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n,!0)}readStyles(s,n){let a=s.style;if(a&&a.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let l=this.parser.matchedStyles[i],o=a.getPropertyValue(l);if(o)for(let c=void 0;;){let d=this.parser.matchStyle(l,o,this,c);if(!d)break;if(d.ignore)return null;if(d.clearMark?n=n.filter(u=>!d.clearMark(u)):n=n.concat(this.parser.schema.marks[d.mark].create(d.attrs)),d.consuming===!1)c=d;else break}}return n}addElementByRule(s,n,a,i){let l,o;if(n.node)if(o=this.parser.schema.nodes[n.node],o.isLeaf)this.insertNode(o.create(n.attrs),a,s.nodeName=="BR")||this.leafFallback(s,a);else{let d=this.enter(o,n.attrs||null,a,n.preserveWhitespace);d&&(l=!0,a=d)}else{let d=this.parser.schema.marks[n.mark];a=a.concat(d.create(n.attrs))}let c=this.top;if(o&&o.isLeaf)this.findInside(s);else if(i)this.addElement(s,a,i);else if(n.getContent)this.findInside(s),n.getContent(s,this.parser.schema).forEach(d=>this.insertNode(d,a,!1));else{let d=s;typeof n.contentElement=="string"?d=s.querySelector(n.contentElement):typeof n.contentElement=="function"?d=n.contentElement(s):n.contentElement&&(d=n.contentElement),this.findAround(s,d,!0),this.addAll(d,a),this.findAround(s,d,!1)}l&&this.sync(c)&&this.open--}addAll(s,n,a,i){let l=a||0;for(let o=a?s.childNodes[a]:s.firstChild,c=i==null?null:s.childNodes[i];o!=c;o=o.nextSibling,++l)this.findAtPoint(s,l),this.addDOM(o,n);this.findAtPoint(s,l)}findPlace(s,n,a){let i,l;for(let o=this.open,c=0;o>=0;o--){let d=this.nodes[o],u=d.findWrapping(s);if(u&&(!i||i.length>u.length+c)&&(i=u,l=d,!u.length))break;if(d.solid){if(a)break;c+=2}}if(!i)return null;this.sync(l);for(let o=0;o<i.length;o++)n=this.enterInner(i[o],null,n,!1);return n}insertNode(s,n,a){if(s.isInline&&this.needsBlock&&!this.top.type){let l=this.textblockFromContext();l&&(n=this.enterInner(l,null,n))}let i=this.findPlace(s,n,a);if(i){this.closeExtra();let l=this.top;l.match&&(l.match=l.match.matchType(s.type));let o=qs.none;for(let c of i.concat(s.marks))(l.type?l.type.allowsMarkType(c.type):PI(c.type,s.type))&&(o=c.addToSet(o));return l.content.push(s.mark(o)),!0}return!1}enter(s,n,a,i){let l=this.findPlace(s.create(n),a,!1);return l&&(l=this.enterInner(s,n,a,!0,i)),l}enterInner(s,n,a,i=!1,l){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(s);let c=AI(s,l,o.options);o.options&ip&&o.content.length==0&&(c|=ip);let d=qs.none;return a=a.filter(u=>(o.type?o.type.allowsMarkType(u.type):PI(u.type,s))?(d=u.addToSet(d),!1):!0),this.nodes.push(new z0(s,n,d,i,null,c)),this.open++,a}closeExtra(s=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(s));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(s){for(let n=this.open;n>=0;n--){if(this.nodes[n]==s)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=Vp)}return!1}get currentPos(){this.closeExtra();let s=0;for(let n=this.open;n>=0;n--){let a=this.nodes[n].content;for(let i=a.length-1;i>=0;i--)s+=a[i].nodeSize;n&&s++}return s}findAtPoint(s,n){if(this.find)for(let a=0;a<this.find.length;a++)this.find[a].node==s&&this.find[a].offset==n&&(this.find[a].pos=this.currentPos)}findInside(s){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&s.nodeType==1&&s.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(s,n,a){if(s!=n&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&s.nodeType==1&&s.contains(this.find[i].node)&&n.compareDocumentPosition(this.find[i].node)&(a?2:4)&&(this.find[i].pos=this.currentPos)}findInText(s){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==s&&(this.find[n].pos=this.currentPos-(s.nodeValue.length-this.find[n].offset))}matchesContext(s){if(s.indexOf("|")>-1)return s.split(/\s*\|\s*/).some(this.matchesContext,this);let n=s.split("/"),a=this.options.context,i=!this.isOpen&&(!a||a.parent.type==this.nodes[0].type),l=-(a?a.depth+1:0)+(i?0:1),o=(c,d)=>{for(;c>=0;c--){let u=n[c];if(u==""){if(c==n.length-1||c==0)continue;for(;d>=l;d--)if(o(c-1,d))return!0;return!1}else{let f=d>0||d==0&&i?this.nodes[d].type:a&&d>=l?a.node(d-l).type:null;if(!f||f.name!=u&&!f.isInGroup(u))return!1;d--}}return!0};return o(n.length-1,this.open)}textblockFromContext(){let s=this.options.context;if(s)for(let n=s.depth;n>=0;n--){let a=s.node(n).contentMatchAt(s.indexAfter(n)).defaultType;if(a&&a.isTextblock&&a.defaultAttrs)return a}for(let n in this.parser.schema.nodes){let a=this.parser.schema.nodes[n];if(a.isTextblock&&a.defaultAttrs)return a}}}function sge(t){for(let s=t.firstChild,n=null;s;s=s.nextSibling){let a=s.nodeType==1?s.nodeName.toLowerCase():null;a&&A$.hasOwnProperty(a)&&n?(n.appendChild(s),s=n):a=="li"?n=s:a&&(n=null)}}function nge(t,s){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,s)}function TI(t){let s={};for(let n in t)s[n]=t[n];return s}function PI(t,s){let n=s.schema.nodes;for(let a in n){let i=n[a];if(!i.allowsMarkType(t))continue;let l=[],o=c=>{l.push(c);for(let d=0;d<c.edgeCount;d++){let{type:u,next:f}=c.edge(d);if(u==s||l.indexOf(f)<0&&o(f))return!0}};if(o(i.contentMatch))return!0}}class ev{constructor(s,n){this.nodes=s,this.marks=n}serializeFragment(s,n={},a){a||(a=JN(n).createDocumentFragment());let i=a,l=[];return s.forEach(o=>{if(l.length||o.marks.length){let c=0,d=0;for(;c<l.length&&d<o.marks.length;){let u=o.marks[d];if(!this.marks[u.type.name]){d++;continue}if(!u.eq(l[c][0])||u.type.spec.spanning===!1)break;c++,d++}for(;c<l.length;)i=l.pop()[1];for(;d<o.marks.length;){let u=o.marks[d++],f=this.serializeMark(u,o.isInline,n);f&&(l.push([u,i]),i.appendChild(f.dom),i=f.contentDOM||f.dom)}}i.appendChild(this.serializeNodeInner(o,n))}),a}serializeNodeInner(s,n){let{dom:a,contentDOM:i}=Vg(JN(n),this.nodes[s.type.name](s),null,s.attrs);if(i){if(s.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(s.content,n,i)}return a}serializeNode(s,n={}){let a=this.serializeNodeInner(s,n);for(let i=s.marks.length-1;i>=0;i--){let l=this.serializeMark(s.marks[i],s.isInline,n);l&&((l.contentDOM||l.dom).appendChild(a),a=l.dom)}return a}serializeMark(s,n,a={}){let i=this.marks[s.type.name];return i&&Vg(JN(a),i(s,n),null,s.attrs)}static renderSpec(s,n,a=null,i){return Vg(s,n,a,i)}static fromSchema(s){return s.cached.domSerializer||(s.cached.domSerializer=new ev(this.nodesFromSchema(s),this.marksFromSchema(s)))}static nodesFromSchema(s){let n=II(s.nodes);return n.text||(n.text=a=>a.text),n}static marksFromSchema(s){return II(s.marks)}}function II(t){let s={};for(let n in t){let a=t[n].spec.toDOM;a&&(s[n]=a)}return s}function JN(t){return t.document||window.document}const MI=new WeakMap;function rge(t){let s=MI.get(t);return s===void 0&&MI.set(t,s=age(t)),s}function age(t){let s=null;function n(a){if(a&&typeof a=="object")if(Array.isArray(a))if(typeof a[0]=="string")s||(s=[]),s.push(a);else for(let i=0;i<a.length;i++)n(a[i]);else for(let i in a)n(a[i])}return n(t),s}function Vg(t,s,n,a){if(typeof s=="string")return{dom:t.createTextNode(s)};if(s.nodeType!=null)return{dom:s};if(s.dom&&s.dom.nodeType!=null)return s;let i=s[0],l;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(a&&(l=rge(a))&&l.indexOf(s)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=i.indexOf(" ");o>0&&(n=i.slice(0,o),i=i.slice(o+1));let c,d=n?t.createElementNS(n,i):t.createElement(i),u=s[1],f=1;if(u&&typeof u=="object"&&u.nodeType==null&&!Array.isArray(u)){f=2;for(let m in u)if(u[m]!=null){let x=m.indexOf(" ");x>0?d.setAttributeNS(m.slice(0,x),m.slice(x+1),u[m]):m=="style"&&d.style?d.style.cssText=u[m]:d.setAttribute(m,u[m])}}for(let m=f;m<s.length;m++){let x=s[m];if(x===0){if(m<s.length-1||m>f)throw new RangeError("Content hole must be the only child of its parent node");return{dom:d,contentDOM:d}}else{let{dom:b,contentDOM:w}=Vg(t,x,n,a);if(d.appendChild(b),w){if(c)throw new RangeError("Multiple content holes");c=w}}}return{dom:d,contentDOM:c}}const E$=65535,T$=Math.pow(2,16);function ige(t,s){return t+s*T$}function DI(t){return t&E$}function lge(t){return(t-(t&E$))/T$}const P$=1,I$=2,Hg=4,M$=8;class rS{constructor(s,n,a){this.pos=s,this.delInfo=n,this.recover=a}get deleted(){return(this.delInfo&M$)>0}get deletedBefore(){return(this.delInfo&(P$|Hg))>0}get deletedAfter(){return(this.delInfo&(I$|Hg))>0}get deletedAcross(){return(this.delInfo&Hg)>0}}class Ua{constructor(s,n=!1){if(this.ranges=s,this.inverted=n,!s.length&&Ua.empty)return Ua.empty}recover(s){let n=0,a=DI(s);if(!this.inverted)for(let i=0;i<a;i++)n+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[a*3]+n+lge(s)}mapResult(s,n=1){return this._map(s,n,!1)}map(s,n=1){return this._map(s,n,!0)}_map(s,n,a){let i=0,l=this.inverted?2:1,o=this.inverted?1:2;for(let c=0;c<this.ranges.length;c+=3){let d=this.ranges[c]-(this.inverted?i:0);if(d>s)break;let u=this.ranges[c+l],f=this.ranges[c+o],m=d+u;if(s<=m){let x=u?s==d?-1:s==m?1:n:n,b=d+i+(x<0?0:f);if(a)return b;let w=s==(n<0?d:m)?null:ige(c/3,s-d),j=s==d?I$:s==m?P$:Hg;return(n<0?s!=d:s!=m)&&(j|=M$),new rS(b,j,w)}i+=f-u}return a?s+i:new rS(s+i,0,null)}touches(s,n){let a=0,i=DI(n),l=this.inverted?2:1,o=this.inverted?1:2;for(let c=0;c<this.ranges.length;c+=3){let d=this.ranges[c]-(this.inverted?a:0);if(d>s)break;let u=this.ranges[c+l],f=d+u;if(s<=f&&c==i*3)return!0;a+=this.ranges[c+o]-u}return!1}forEach(s){let n=this.inverted?2:1,a=this.inverted?1:2;for(let i=0,l=0;i<this.ranges.length;i+=3){let o=this.ranges[i],c=o-(this.inverted?l:0),d=o+(this.inverted?0:l),u=this.ranges[i+n],f=this.ranges[i+a];s(c,c+u,d,d+f),l+=f-u}}invert(){return new Ua(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(s){return s==0?Ua.empty:new Ua(s<0?[0,-s,0]:[0,0,s])}}Ua.empty=new Ua([]);class Hp{constructor(s,n,a=0,i=s?s.length:0){this.mirror=n,this.from=a,this.to=i,this._maps=s||[],this.ownData=!(s||n)}get maps(){return this._maps}slice(s=0,n=this.maps.length){return new Hp(this._maps,this.mirror,s,n)}appendMap(s,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(s),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(s){for(let n=0,a=this._maps.length;n<s._maps.length;n++){let i=s.getMirror(n);this.appendMap(s._maps[n],i!=null&&i<n?a+i:void 0)}}getMirror(s){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==s)return this.mirror[n+(n%2?-1:1)]}}setMirror(s,n){this.mirror||(this.mirror=[]),this.mirror.push(s,n)}appendMappingInverted(s){for(let n=s.maps.length-1,a=this._maps.length+s._maps.length;n>=0;n--){let i=s.getMirror(n);this.appendMap(s._maps[n].invert(),i!=null&&i>n?a-i-1:void 0)}}invert(){let s=new Hp;return s.appendMappingInverted(this),s}map(s,n=1){if(this.mirror)return this._map(s,n,!0);for(let a=this.from;a<this.to;a++)s=this._maps[a].map(s,n);return s}mapResult(s,n=1){return this._map(s,n,!1)}_map(s,n,a){let i=0;for(let l=this.from;l<this.to;l++){let o=this._maps[l],c=o.mapResult(s,n);if(c.recover!=null){let d=this.getMirror(l);if(d!=null&&d>l&&d<this.to){l=d,s=this._maps[d].recover(c.recover);continue}}i|=c.delInfo,s=c.pos}return a?s:new rS(s,i,null)}}const ej=Object.create(null);let Xr=class{getMap(){return Ua.empty}merge(s){return null}static fromJSON(s,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let a=ej[n.stepType];if(!a)throw new RangeError(`No step type ${n.stepType} defined`);return a.fromJSON(s,n)}static jsonID(s,n){if(s in ej)throw new RangeError("Duplicate use of step JSON ID "+s);return ej[s]=n,n.prototype.jsonID=s,n}};class Dn{constructor(s,n){this.doc=s,this.failed=n}static ok(s){return new Dn(s,null)}static fail(s){return new Dn(null,s)}static fromReplace(s,n,a,i){try{return Dn.ok(s.replace(n,a,i))}catch(l){if(l instanceof Yy)return Dn.fail(l.message);throw l}}}function _k(t,s,n){let a=[];for(let i=0;i<t.childCount;i++){let l=t.child(i);l.content.size&&(l=l.copy(_k(l.content,s,l))),l.isInline&&(l=s(l,n,i)),a.push(l)}return Fe.fromArray(a)}class vc extends Xr{constructor(s,n,a){super(),this.from=s,this.to=n,this.mark=a}apply(s){let n=s.slice(this.from,this.to),a=s.resolve(this.from),i=a.node(a.sharedDepth(this.to)),l=new nt(_k(n.content,(o,c)=>!o.isAtom||!c.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),n.openStart,n.openEnd);return Dn.fromReplace(s,this.from,this.to,l)}invert(){return new Zi(this.from,this.to,this.mark)}map(s){let n=s.mapResult(this.from,1),a=s.mapResult(this.to,-1);return n.deleted&&a.deleted||n.pos>=a.pos?null:new vc(n.pos,a.pos,this.mark)}merge(s){return s instanceof vc&&s.mark.eq(this.mark)&&this.from<=s.to&&this.to>=s.from?new vc(Math.min(this.from,s.from),Math.max(this.to,s.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(s,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new vc(n.from,n.to,s.markFromJSON(n.mark))}}Xr.jsonID("addMark",vc);class Zi extends Xr{constructor(s,n,a){super(),this.from=s,this.to=n,this.mark=a}apply(s){let n=s.slice(this.from,this.to),a=new nt(_k(n.content,i=>i.mark(this.mark.removeFromSet(i.marks)),s),n.openStart,n.openEnd);return Dn.fromReplace(s,this.from,this.to,a)}invert(){return new vc(this.from,this.to,this.mark)}map(s){let n=s.mapResult(this.from,1),a=s.mapResult(this.to,-1);return n.deleted&&a.deleted||n.pos>=a.pos?null:new Zi(n.pos,a.pos,this.mark)}merge(s){return s instanceof Zi&&s.mark.eq(this.mark)&&this.from<=s.to&&this.to>=s.from?new Zi(Math.min(this.from,s.from),Math.max(this.to,s.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(s,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Zi(n.from,n.to,s.markFromJSON(n.mark))}}Xr.jsonID("removeMark",Zi);class wc extends Xr{constructor(s,n){super(),this.pos=s,this.mark=n}apply(s){let n=s.nodeAt(this.pos);if(!n)return Dn.fail("No node at mark step's position");let a=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return Dn.fromReplace(s,this.pos,this.pos+1,new nt(Fe.from(a),0,n.isLeaf?0:1))}invert(s){let n=s.nodeAt(this.pos);if(n){let a=this.mark.addToSet(n.marks);if(a.length==n.marks.length){for(let i=0;i<n.marks.length;i++)if(!n.marks[i].isInSet(a))return new wc(this.pos,n.marks[i]);return new wc(this.pos,this.mark)}}return new gu(this.pos,this.mark)}map(s){let n=s.mapResult(this.pos,1);return n.deletedAfter?null:new wc(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(s,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new wc(n.pos,s.markFromJSON(n.mark))}}Xr.jsonID("addNodeMark",wc);class gu extends Xr{constructor(s,n){super(),this.pos=s,this.mark=n}apply(s){let n=s.nodeAt(this.pos);if(!n)return Dn.fail("No node at mark step's position");let a=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return Dn.fromReplace(s,this.pos,this.pos+1,new nt(Fe.from(a),0,n.isLeaf?0:1))}invert(s){let n=s.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new wc(this.pos,this.mark)}map(s){let n=s.mapResult(this.pos,1);return n.deletedAfter?null:new gu(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(s,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new gu(n.pos,s.markFromJSON(n.mark))}}Xr.jsonID("removeNodeMark",gu);class qn extends Xr{constructor(s,n,a,i=!1){super(),this.from=s,this.to=n,this.slice=a,this.structure=i}apply(s){return this.structure&&aS(s,this.from,this.to)?Dn.fail("Structure replace would overwrite content"):Dn.fromReplace(s,this.from,this.to,this.slice)}getMap(){return new Ua([this.from,this.to-this.from,this.slice.size])}invert(s){return new qn(this.from,this.from+this.slice.size,s.slice(this.from,this.to))}map(s){let n=s.mapResult(this.from,1),a=s.mapResult(this.to,-1);return n.deletedAcross&&a.deletedAcross?null:new qn(n.pos,Math.max(n.pos,a.pos),this.slice,this.structure)}merge(s){if(!(s instanceof qn)||s.structure||this.structure)return null;if(this.from+this.slice.size==s.from&&!this.slice.openEnd&&!s.slice.openStart){let n=this.slice.size+s.slice.size==0?nt.empty:new nt(this.slice.content.append(s.slice.content),this.slice.openStart,s.slice.openEnd);return new qn(this.from,this.to+(s.to-s.from),n,this.structure)}else if(s.to==this.from&&!this.slice.openStart&&!s.slice.openEnd){let n=this.slice.size+s.slice.size==0?nt.empty:new nt(s.slice.content.append(this.slice.content),s.slice.openStart,this.slice.openEnd);return new qn(s.from,this.to,n,this.structure)}else return null}toJSON(){let s={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(s.slice=this.slice.toJSON()),this.structure&&(s.structure=!0),s}static fromJSON(s,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new qn(n.from,n.to,nt.fromJSON(s,n.slice),!!n.structure)}}Xr.jsonID("replace",qn);class er extends Xr{constructor(s,n,a,i,l,o,c=!1){super(),this.from=s,this.to=n,this.gapFrom=a,this.gapTo=i,this.slice=l,this.insert=o,this.structure=c}apply(s){if(this.structure&&(aS(s,this.from,this.gapFrom)||aS(s,this.gapTo,this.to)))return Dn.fail("Structure gap-replace would overwrite content");let n=s.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return Dn.fail("Gap is not a flat range");let a=this.slice.insertAt(this.insert,n.content);return a?Dn.fromReplace(s,this.from,this.to,a):Dn.fail("Content does not fit in gap")}getMap(){return new Ua([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(s){let n=this.gapTo-this.gapFrom;return new er(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,s.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(s){let n=s.mapResult(this.from,1),a=s.mapResult(this.to,-1),i=this.from==this.gapFrom?n.pos:s.map(this.gapFrom,-1),l=this.to==this.gapTo?a.pos:s.map(this.gapTo,1);return n.deletedAcross&&a.deletedAcross||i<n.pos||l>a.pos?null:new er(n.pos,a.pos,i,l,this.slice,this.insert,this.structure)}toJSON(){let s={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(s.slice=this.slice.toJSON()),this.structure&&(s.structure=!0),s}static fromJSON(s,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new er(n.from,n.to,n.gapFrom,n.gapTo,nt.fromJSON(s,n.slice),n.insert,!!n.structure)}}Xr.jsonID("replaceAround",er);function aS(t,s,n){let a=t.resolve(s),i=n-s,l=a.depth;for(;i>0&&l>0&&a.indexAfter(l)==a.node(l).childCount;)l--,i--;if(i>0){let o=a.node(l).maybeChild(a.indexAfter(l));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function oge(t,s,n,a){let i=[],l=[],o,c;t.doc.nodesBetween(s,n,(d,u,f)=>{if(!d.isInline)return;let m=d.marks;if(!a.isInSet(m)&&f.type.allowsMarkType(a.type)){let x=Math.max(u,s),b=Math.min(u+d.nodeSize,n),w=a.addToSet(m);for(let j=0;j<m.length;j++)m[j].isInSet(w)||(o&&o.to==x&&o.mark.eq(m[j])?o.to=b:i.push(o=new Zi(x,b,m[j])));c&&c.to==x?c.to=b:l.push(c=new vc(x,b,a))}}),i.forEach(d=>t.step(d)),l.forEach(d=>t.step(d))}function cge(t,s,n,a){let i=[],l=0;t.doc.nodesBetween(s,n,(o,c)=>{if(!o.isInline)return;l++;let d=null;if(a instanceof Jb){let u=o.marks,f;for(;f=a.isInSet(u);)(d||(d=[])).push(f),u=f.removeFromSet(u)}else a?a.isInSet(o.marks)&&(d=[a]):d=o.marks;if(d&&d.length){let u=Math.min(c+o.nodeSize,n);for(let f=0;f<d.length;f++){let m=d[f],x;for(let b=0;b<i.length;b++){let w=i[b];w.step==l-1&&m.eq(i[b].style)&&(x=w)}x?(x.to=u,x.step=l):i.push({style:m,from:Math.max(c,s),to:u,step:l})}}}),i.forEach(o=>t.step(new Zi(o.from,o.to,o.style)))}function Sk(t,s,n,a=n.contentMatch,i=!0){let l=t.doc.nodeAt(s),o=[],c=s+1;for(let d=0;d<l.childCount;d++){let u=l.child(d),f=c+u.nodeSize,m=a.matchType(u.type);if(!m)o.push(new qn(c,f,nt.empty));else{a=m;for(let x=0;x<u.marks.length;x++)n.allowsMarkType(u.marks[x].type)||t.step(new Zi(c,f,u.marks[x]));if(i&&u.isText&&n.whitespace!="pre"){let x,b=/\r?\n|\r/g,w;for(;x=b.exec(u.text);)w||(w=new nt(Fe.from(n.schema.text(" ",n.allowedMarks(u.marks))),0,0)),o.push(new qn(c+x.index,c+x.index+x[0].length,w))}}c=f}if(!a.validEnd){let d=a.fillBefore(Fe.empty,!0);t.replace(c,c,new nt(d,0,0))}for(let d=o.length-1;d>=0;d--)t.step(o[d])}function dge(t,s,n){return(s==0||t.canReplace(s,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function Du(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let a=t.depth;;--a){let i=t.$from.node(a),l=t.$from.index(a),o=t.$to.indexAfter(a);if(a<t.depth&&i.canReplace(l,o,n))return a;if(a==0||i.type.spec.isolating||!dge(i,l,o))break}return null}function uge(t,s,n){let{$from:a,$to:i,depth:l}=s,o=a.before(l+1),c=i.after(l+1),d=o,u=c,f=Fe.empty,m=0;for(let w=l,j=!1;w>n;w--)j||a.index(w)>0?(j=!0,f=Fe.from(a.node(w).copy(f)),m++):d--;let x=Fe.empty,b=0;for(let w=l,j=!1;w>n;w--)j||i.after(w+1)<i.end(w)?(j=!0,x=Fe.from(i.node(w).copy(x)),b++):u++;t.step(new er(d,u,o,c,new nt(f.append(x),m,b),f.size-m,!0))}function Ck(t,s,n=null,a=t){let i=hge(t,s),l=i&&fge(a,s);return l?i.map(OI).concat({type:s,attrs:n}).concat(l.map(OI)):null}function OI(t){return{type:t,attrs:null}}function hge(t,s){let{parent:n,startIndex:a,endIndex:i}=t,l=n.contentMatchAt(a).findWrapping(s);if(!l)return null;let o=l.length?l[0]:s;return n.canReplaceWith(a,i,o)?l:null}function fge(t,s){let{parent:n,startIndex:a,endIndex:i}=t,l=n.child(a),o=s.contentMatch.findWrapping(l.type);if(!o)return null;let d=(o.length?o[o.length-1]:s).contentMatch;for(let u=a;d&&u<i;u++)d=d.matchType(n.child(u).type);return!d||!d.validEnd?null:o}function mge(t,s,n){let a=Fe.empty;for(let o=n.length-1;o>=0;o--){if(a.size){let c=n[o].type.contentMatch.matchFragment(a);if(!c||!c.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}a=Fe.from(n[o].type.create(n[o].attrs,a))}let i=s.start,l=s.end;t.step(new er(i,l,i,l,new nt(a,0,0),n.length,!0))}function pge(t,s,n,a,i){if(!a.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let l=t.steps.length;t.doc.nodesBetween(s,n,(o,c)=>{let d=typeof i=="function"?i(o):i;if(o.isTextblock&&!o.hasMarkup(a,d)&&xge(t.doc,t.mapping.slice(l).map(c),a)){let u=null;if(a.schema.linebreakReplacement){let b=a.whitespace=="pre",w=!!a.contentMatch.matchType(a.schema.linebreakReplacement);b&&!w?u=!1:!b&&w&&(u=!0)}u===!1&&O$(t,o,c,l),Sk(t,t.mapping.slice(l).map(c,1),a,void 0,u===null);let f=t.mapping.slice(l),m=f.map(c,1),x=f.map(c+o.nodeSize,1);return t.step(new er(m,x,m+1,x-1,new nt(Fe.from(a.create(d,null,o.marks)),0,0),1,!0)),u===!0&&D$(t,o,c,l),!1}})}function D$(t,s,n,a){s.forEach((i,l)=>{if(i.isText){let o,c=/\r?\n|\r/g;for(;o=c.exec(i.text);){let d=t.mapping.slice(a).map(n+1+l+o.index);t.replaceWith(d,d+1,s.type.schema.linebreakReplacement.create())}}})}function O$(t,s,n,a){s.forEach((i,l)=>{if(i.type==i.type.schema.linebreakReplacement){let o=t.mapping.slice(a).map(n+1+l);t.replaceWith(o,o+1,s.type.schema.text(`
`))}})}function xge(t,s,n){let a=t.resolve(s),i=a.index();return a.parent.canReplaceWith(i,i+1,n)}function gge(t,s,n,a,i){let l=t.doc.nodeAt(s);if(!l)throw new RangeError("No node at given position");n||(n=l.type);let o=n.create(a,null,i||l.marks);if(l.isLeaf)return t.replaceWith(s,s+l.nodeSize,o);if(!n.validContent(l.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new er(s,s+l.nodeSize,s+1,s+l.nodeSize-1,new nt(Fe.from(o),0,0),1,!0))}function Xa(t,s,n=1,a){let i=t.resolve(s),l=i.depth-n,o=a&&a[a.length-1]||i.parent;if(l<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let u=i.depth-1,f=n-2;u>l;u--,f--){let m=i.node(u),x=i.index(u);if(m.type.spec.isolating)return!1;let b=m.content.cutByIndex(x,m.childCount),w=a&&a[f+1];w&&(b=b.replaceChild(0,w.type.create(w.attrs)));let j=a&&a[f]||m;if(!m.canReplace(x+1,m.childCount)||!j.type.validContent(b))return!1}let c=i.indexAfter(l),d=a&&a[0];return i.node(l).canReplaceWith(c,c,d?d.type:i.node(l+1).type)}function yge(t,s,n=1,a){let i=t.doc.resolve(s),l=Fe.empty,o=Fe.empty;for(let c=i.depth,d=i.depth-n,u=n-1;c>d;c--,u--){l=Fe.from(i.node(c).copy(l));let f=a&&a[u];o=Fe.from(f?f.type.create(f.attrs,o):i.node(c).copy(o))}t.step(new qn(s,s,new nt(l.append(o),n,n),!0))}function Zl(t,s){let n=t.resolve(s),a=n.index();return R$(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(a,a+1)}function bge(t,s){s.content.size||t.type.compatibleContent(s.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:a}=t.type.schema;for(let i=0;i<s.childCount;i++){let l=s.child(i),o=l.type==a?t.type.schema.nodes.text:l.type;if(n=n.matchType(o),!n||!t.type.allowsMarks(l.marks))return!1}return n.validEnd}function R$(t,s){return!!(t&&s&&!t.isLeaf&&bge(t,s))}function Rf(t,s,n=-1){let a=t.resolve(s);for(let i=a.depth;;i--){let l,o,c=a.index(i);if(i==a.depth?(l=a.nodeBefore,o=a.nodeAfter):n>0?(l=a.node(i+1),c++,o=a.node(i).maybeChild(c)):(l=a.node(i).maybeChild(c-1),o=a.node(i+1)),l&&!l.isTextblock&&R$(l,o)&&a.node(i).canReplace(c,c+1))return s;if(i==0)break;s=n<0?a.before(i):a.after(i)}}function vge(t,s,n){let a=null,{linebreakReplacement:i}=t.doc.type.schema,l=t.doc.resolve(s-n),o=l.node().type;if(i&&o.inlineContent){let f=o.whitespace=="pre",m=!!o.contentMatch.matchType(i);f&&!m?a=!1:!f&&m&&(a=!0)}let c=t.steps.length;if(a===!1){let f=t.doc.resolve(s+n);O$(t,f.node(),f.before(),c)}o.inlineContent&&Sk(t,s+n-1,o,l.node().contentMatchAt(l.index()),a==null);let d=t.mapping.slice(c),u=d.map(s-n);if(t.step(new qn(u,d.map(s+n,-1),nt.empty,!0)),a===!0){let f=t.doc.resolve(u);D$(t,f.node(),f.before(),t.steps.length)}return t}function wge(t,s,n){let a=t.resolve(s);if(a.parent.canReplaceWith(a.index(),a.index(),n))return s;if(a.parentOffset==0)for(let i=a.depth-1;i>=0;i--){let l=a.index(i);if(a.node(i).canReplaceWith(l,l,n))return a.before(i+1);if(l>0)return null}if(a.parentOffset==a.parent.content.size)for(let i=a.depth-1;i>=0;i--){let l=a.indexAfter(i);if(a.node(i).canReplaceWith(l,l,n))return a.after(i+1);if(l<a.node(i).childCount)return null}return null}function L$(t,s,n){let a=t.resolve(s);if(!n.content.size)return s;let i=n.content;for(let l=0;l<n.openStart;l++)i=i.firstChild.content;for(let l=1;l<=(n.openStart==0&&n.size?2:1);l++)for(let o=a.depth;o>=0;o--){let c=o==a.depth?0:a.pos<=(a.start(o+1)+a.end(o+1))/2?-1:1,d=a.index(o)+(c>0?1:0),u=a.node(o),f=!1;if(l==1)f=u.canReplace(d,d,i);else{let m=u.contentMatchAt(d).findWrapping(i.firstChild.type);f=m&&u.canReplaceWith(d,d,m[0])}if(f)return c==0?a.pos:c<0?a.before(o+1):a.after(o+1)}return null}function tv(t,s,n=s,a=nt.empty){if(s==n&&!a.size)return null;let i=t.resolve(s),l=t.resolve(n);return B$(i,l,a)?new qn(s,n,a):new Nge(i,l,a).fit()}function B$(t,s,n){return!n.openStart&&!n.openEnd&&t.start()==s.start()&&t.parent.canReplace(t.index(),s.index(),n.content)}class Nge{constructor(s,n,a){this.$from=s,this.$to=n,this.unplaced=a,this.frontier=[],this.placed=Fe.empty;for(let i=0;i<=s.depth;i++){let l=s.node(i);this.frontier.push({type:l.type,match:l.contentMatchAt(s.indexAfter(i))})}for(let i=s.depth;i>0;i--)this.placed=Fe.from(s.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let s=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,a=this.$from,i=this.close(s<0?this.$to:a.doc.resolve(s));if(!i)return null;let l=this.placed,o=a.depth,c=i.depth;for(;o&&c&&l.childCount==1;)l=l.firstChild.content,o--,c--;let d=new nt(l,o,c);return s>-1?new er(a.pos,s,this.$to.pos,this.$to.end(),d,n):d.size||a.pos!=this.$to.pos?new qn(a.pos,i.pos,d):null}findFittable(){let s=this.unplaced.openStart;for(let n=this.unplaced.content,a=0,i=this.unplaced.openEnd;a<s;a++){let l=n.firstChild;if(n.childCount>1&&(i=0),l.type.spec.isolating&&i<=a){s=a;break}n=l.content}for(let n=1;n<=2;n++)for(let a=n==1?s:this.unplaced.openStart;a>=0;a--){let i,l=null;a?(l=tj(this.unplaced.content,a-1).firstChild,i=l.content):i=this.unplaced.content;let o=i.firstChild;for(let c=this.depth;c>=0;c--){let{type:d,match:u}=this.frontier[c],f,m=null;if(n==1&&(o?u.matchType(o.type)||(m=u.fillBefore(Fe.from(o),!1)):l&&d.compatibleContent(l.type)))return{sliceDepth:a,frontierDepth:c,parent:l,inject:m};if(n==2&&o&&(f=u.findWrapping(o.type)))return{sliceDepth:a,frontierDepth:c,parent:l,wrap:f};if(l&&u.matchType(l.type))break}}}openMore(){let{content:s,openStart:n,openEnd:a}=this.unplaced,i=tj(s,n);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new nt(s,n+1,Math.max(a,i.size+n>=s.size-a?n+1:0)),!0)}dropNode(){let{content:s,openStart:n,openEnd:a}=this.unplaced,i=tj(s,n);if(i.childCount<=1&&n>0){let l=s.size-n<=n+i.size;this.unplaced=new nt(Fm(s,n-1,1),n-1,l?n-1:a)}else this.unplaced=new nt(Fm(s,n,1),n,a)}placeNodes({sliceDepth:s,frontierDepth:n,parent:a,inject:i,wrap:l}){for(;this.depth>n;)this.closeFrontierNode();if(l)for(let j=0;j<l.length;j++)this.openFrontierNode(l[j]);let o=this.unplaced,c=a?a.content:o.content,d=o.openStart-s,u=0,f=[],{match:m,type:x}=this.frontier[n];if(i){for(let j=0;j<i.childCount;j++)f.push(i.child(j));m=m.matchFragment(i)}let b=c.size+s-(o.content.size-o.openEnd);for(;u<c.childCount;){let j=c.child(u),_=m.matchType(j.type);if(!_)break;u++,(u>1||d==0||j.content.size)&&(m=_,f.push(F$(j.mark(x.allowedMarks(j.marks)),u==1?d:0,u==c.childCount?b:-1)))}let w=u==c.childCount;w||(b=-1),this.placed=$m(this.placed,n,Fe.from(f)),this.frontier[n].match=m,w&&b<0&&a&&a.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let j=0,_=c;j<b;j++){let C=_.lastChild;this.frontier.push({type:C.type,match:C.contentMatchAt(C.childCount)}),_=C.content}this.unplaced=w?s==0?nt.empty:new nt(Fm(o.content,s-1,1),s-1,b<0?o.openEnd:s-1):new nt(Fm(o.content,s,u),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let s=this.frontier[this.depth],n;if(!s.type.isTextblock||!sj(this.$to,this.$to.depth,s.type,s.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:a}=this.$to,i=this.$to.after(a);for(;a>1&&i==this.$to.end(--a);)++i;return i}findCloseLevel(s){e:for(let n=Math.min(this.depth,s.depth);n>=0;n--){let{match:a,type:i}=this.frontier[n],l=n<s.depth&&s.end(n+1)==s.pos+(s.depth-(n+1)),o=sj(s,n,i,a,l);if(o){for(let c=n-1;c>=0;c--){let{match:d,type:u}=this.frontier[c],f=sj(s,c,u,d,!0);if(!f||f.childCount)continue e}return{depth:n,fit:o,move:l?s.doc.resolve(s.after(n+1)):s}}}}close(s){let n=this.findCloseLevel(s);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=$m(this.placed,n.depth,n.fit)),s=n.move;for(let a=n.depth+1;a<=s.depth;a++){let i=s.node(a),l=i.type.contentMatch.fillBefore(i.content,!0,s.index(a));this.openFrontierNode(i.type,i.attrs,l)}return s}openFrontierNode(s,n=null,a){let i=this.frontier[this.depth];i.match=i.match.matchType(s),this.placed=$m(this.placed,this.depth,Fe.from(s.create(n,a))),this.frontier.push({type:s,match:s.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(Fe.empty,!0);n.childCount&&(this.placed=$m(this.placed,this.frontier.length,n))}}function Fm(t,s,n){return s==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(Fm(t.firstChild.content,s-1,n)))}function $m(t,s,n){return s==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy($m(t.lastChild.content,s-1,n)))}function tj(t,s){for(let n=0;n<s;n++)t=t.firstChild.content;return t}function F$(t,s,n){if(s<=0)return t;let a=t.content;return s>1&&(a=a.replaceChild(0,F$(a.firstChild,s-1,a.childCount==1?n-1:0))),s>0&&(a=t.type.contentMatch.fillBefore(a).append(a),n<=0&&(a=a.append(t.type.contentMatch.matchFragment(a).fillBefore(Fe.empty,!0)))),t.copy(a)}function sj(t,s,n,a,i){let l=t.node(s),o=i?t.indexAfter(s):t.index(s);if(o==l.childCount&&!n.compatibleContent(l.type))return null;let c=a.fillBefore(l.content,!0,o);return c&&!jge(n,l.content,o)?c:null}function jge(t,s,n){for(let a=n;a<s.childCount;a++)if(!t.allowsMarks(s.child(a).marks))return!0;return!1}function _ge(t){return t.spec.defining||t.spec.definingForContent}function Sge(t,s,n,a){if(!a.size)return t.deleteRange(s,n);let i=t.doc.resolve(s),l=t.doc.resolve(n);if(B$(i,l,a))return t.step(new qn(s,n,a));let o=z$(i,t.doc.resolve(n));o[o.length-1]==0&&o.pop();let c=-(i.depth+1);o.unshift(c);for(let x=i.depth,b=i.pos-1;x>0;x--,b--){let w=i.node(x).type.spec;if(w.defining||w.definingAsContext||w.isolating)break;o.indexOf(x)>-1?c=x:i.before(x)==b&&o.splice(1,0,-x)}let d=o.indexOf(c),u=[],f=a.openStart;for(let x=a.content,b=0;;b++){let w=x.firstChild;if(u.push(w),b==a.openStart)break;x=w.content}for(let x=f-1;x>=0;x--){let b=u[x],w=_ge(b.type);if(w&&!b.sameMarkup(i.node(Math.abs(c)-1)))f=x;else if(w||!b.type.isTextblock)break}for(let x=a.openStart;x>=0;x--){let b=(x+f+1)%(a.openStart+1),w=u[b];if(w)for(let j=0;j<o.length;j++){let _=o[(j+d)%o.length],C=!0;_<0&&(C=!1,_=-_);let k=i.node(_-1),A=i.index(_-1);if(k.canReplaceWith(A,A,w.type,w.marks))return t.replace(i.before(_),C?l.after(_):n,new nt($$(a.content,0,a.openStart,b),b,a.openEnd))}}let m=t.steps.length;for(let x=o.length-1;x>=0&&(t.replace(s,n,a),!(t.steps.length>m));x--){let b=o[x];b<0||(s=i.before(b),n=l.after(b))}}function $$(t,s,n,a,i){if(s<n){let l=t.firstChild;t=t.replaceChild(0,l.copy($$(l.content,s+1,n,a,l)))}if(s>a){let l=i.contentMatchAt(0),o=l.fillBefore(t).append(t);t=o.append(l.matchFragment(o).fillBefore(Fe.empty,!0))}return t}function Cge(t,s,n,a){if(!a.isInline&&s==n&&t.doc.resolve(s).parent.content.size){let i=wge(t.doc,s,a.type);i!=null&&(s=n=i)}t.replaceRange(s,n,new nt(Fe.from(a),0,0))}function kge(t,s,n){let a=t.doc.resolve(s),i=t.doc.resolve(n),l=z$(a,i);for(let o=0;o<l.length;o++){let c=l[o],d=o==l.length-1;if(d&&c==0||a.node(c).type.contentMatch.validEnd)return t.delete(a.start(c),i.end(c));if(c>0&&(d||a.node(c-1).canReplace(a.index(c-1),i.indexAfter(c-1))))return t.delete(a.before(c),i.after(c))}for(let o=1;o<=a.depth&&o<=i.depth;o++)if(s-a.start(o)==a.depth-o&&n>a.end(o)&&i.end(o)-n!=i.depth-o&&a.start(o-1)==i.start(o-1)&&a.node(o-1).canReplace(a.index(o-1),i.index(o-1)))return t.delete(a.before(o),n);t.delete(s,n)}function z$(t,s){let n=[],a=Math.min(t.depth,s.depth);for(let i=a;i>=0;i--){let l=t.start(i);if(l<t.pos-(t.depth-i)||s.end(i)>s.pos+(s.depth-i)||t.node(i).type.spec.isolating||s.node(i).type.spec.isolating)break;(l==s.start(i)||i==t.depth&&i==s.depth&&t.parent.inlineContent&&s.parent.inlineContent&&i&&s.start(i-1)==l-1)&&n.push(i)}return n}class Lh extends Xr{constructor(s,n,a){super(),this.pos=s,this.attr=n,this.value=a}apply(s){let n=s.nodeAt(this.pos);if(!n)return Dn.fail("No node at attribute step's position");let a=Object.create(null);for(let l in n.attrs)a[l]=n.attrs[l];a[this.attr]=this.value;let i=n.type.create(a,null,n.marks);return Dn.fromReplace(s,this.pos,this.pos+1,new nt(Fe.from(i),0,n.isLeaf?0:1))}getMap(){return Ua.empty}invert(s){return new Lh(this.pos,this.attr,s.nodeAt(this.pos).attrs[this.attr])}map(s){let n=s.mapResult(this.pos,1);return n.deletedAfter?null:new Lh(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(s,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Lh(n.pos,n.attr,n.value)}}Xr.jsonID("attr",Lh);class Wp extends Xr{constructor(s,n){super(),this.attr=s,this.value=n}apply(s){let n=Object.create(null);for(let i in s.attrs)n[i]=s.attrs[i];n[this.attr]=this.value;let a=s.type.create(n,s.content,s.marks);return Dn.ok(a)}getMap(){return Ua.empty}invert(s){return new Wp(this.attr,s.attrs[this.attr])}map(s){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(s,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Wp(n.attr,n.value)}}Xr.jsonID("docAttr",Wp);let nf=class extends Error{};nf=function t(s){let n=Error.call(this,s);return n.__proto__=t.prototype,n};nf.prototype=Object.create(Error.prototype);nf.prototype.constructor=nf;nf.prototype.name="TransformError";class U${constructor(s){this.doc=s,this.steps=[],this.docs=[],this.mapping=new Hp}get before(){return this.docs.length?this.docs[0]:this.doc}step(s){let n=this.maybeStep(s);if(n.failed)throw new nf(n.failed);return this}maybeStep(s){let n=s.apply(this.doc);return n.failed||this.addStep(s,n.doc),n}get docChanged(){return this.steps.length>0}addStep(s,n){this.docs.push(this.doc),this.steps.push(s),this.mapping.appendMap(s.getMap()),this.doc=n}replace(s,n=s,a=nt.empty){let i=tv(this.doc,s,n,a);return i&&this.step(i),this}replaceWith(s,n,a){return this.replace(s,n,new nt(Fe.from(a),0,0))}delete(s,n){return this.replace(s,n,nt.empty)}insert(s,n){return this.replaceWith(s,s,n)}replaceRange(s,n,a){return Sge(this,s,n,a),this}replaceRangeWith(s,n,a){return Cge(this,s,n,a),this}deleteRange(s,n){return kge(this,s,n),this}lift(s,n){return uge(this,s,n),this}join(s,n=1){return vge(this,s,n),this}wrap(s,n){return mge(this,s,n),this}setBlockType(s,n=s,a,i=null){return pge(this,s,n,a,i),this}setNodeMarkup(s,n,a=null,i){return gge(this,s,n,a,i),this}setNodeAttribute(s,n,a){return this.step(new Lh(s,n,a)),this}setDocAttribute(s,n){return this.step(new Wp(s,n)),this}addNodeMark(s,n){return this.step(new wc(s,n)),this}removeNodeMark(s,n){let a=this.doc.nodeAt(s);if(!a)throw new RangeError("No node at position "+s);if(n instanceof qs)n.isInSet(a.marks)&&this.step(new gu(s,n));else{let i=a.marks,l,o=[];for(;l=n.isInSet(i);)o.push(new gu(s,l)),i=l.removeFromSet(i);for(let c=o.length-1;c>=0;c--)this.step(o[c])}return this}split(s,n=1,a){return yge(this,s,n,a),this}addMark(s,n,a){return oge(this,s,n,a),this}removeMark(s,n,a){return cge(this,s,n,a),this}clearIncompatible(s,n,a){return Sk(this,s,n,a),this}}const nj=Object.create(null);class Tt{constructor(s,n,a){this.$anchor=s,this.$head=n,this.ranges=a||[new V$(s.min(n),s.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let s=this.ranges;for(let n=0;n<s.length;n++)if(s[n].$from.pos!=s[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(s,n=nt.empty){let a=n.content.lastChild,i=null;for(let c=0;c<n.openEnd;c++)i=a,a=a.lastChild;let l=s.steps.length,o=this.ranges;for(let c=0;c<o.length;c++){let{$from:d,$to:u}=o[c],f=s.mapping.slice(l);s.replaceRange(f.map(d.pos),f.map(u.pos),c?nt.empty:n),c==0&&BI(s,l,(a?a.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(s,n){let a=s.steps.length,i=this.ranges;for(let l=0;l<i.length;l++){let{$from:o,$to:c}=i[l],d=s.mapping.slice(a),u=d.map(o.pos),f=d.map(c.pos);l?s.deleteRange(u,f):(s.replaceRangeWith(u,f,n),BI(s,a,n.isInline?-1:1))}}static findFrom(s,n,a=!1){let i=s.parent.inlineContent?new vt(s):nh(s.node(0),s.parent,s.pos,s.index(),n,a);if(i)return i;for(let l=s.depth-1;l>=0;l--){let o=n<0?nh(s.node(0),s.node(l),s.before(l+1),s.index(l),n,a):nh(s.node(0),s.node(l),s.after(l+1),s.index(l)+1,n,a);if(o)return o}return null}static near(s,n=1){return this.findFrom(s,n)||this.findFrom(s,-n)||new ka(s.node(0))}static atStart(s){return nh(s,s,0,0,1)||new ka(s)}static atEnd(s){return nh(s,s,s.content.size,s.childCount,-1)||new ka(s)}static fromJSON(s,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let a=nj[n.type];if(!a)throw new RangeError(`No selection type ${n.type} defined`);return a.fromJSON(s,n)}static jsonID(s,n){if(s in nj)throw new RangeError("Duplicate use of selection JSON ID "+s);return nj[s]=n,n.prototype.jsonID=s,n}getBookmark(){return vt.between(this.$anchor,this.$head).getBookmark()}}Tt.prototype.visible=!0;class V${constructor(s,n){this.$from=s,this.$to=n}}let RI=!1;function LI(t){!RI&&!t.parent.inlineContent&&(RI=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class vt extends Tt{constructor(s,n=s){LI(s),LI(n),super(s,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(s,n){let a=s.resolve(n.map(this.head));if(!a.parent.inlineContent)return Tt.near(a);let i=s.resolve(n.map(this.anchor));return new vt(i.parent.inlineContent?i:a,a)}replace(s,n=nt.empty){if(super.replace(s,n),n==nt.empty){let a=this.$from.marksAcross(this.$to);a&&s.ensureMarks(a)}}eq(s){return s instanceof vt&&s.anchor==this.anchor&&s.head==this.head}getBookmark(){return new sv(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(s,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new vt(s.resolve(n.anchor),s.resolve(n.head))}static create(s,n,a=n){let i=s.resolve(n);return new this(i,a==n?i:s.resolve(a))}static between(s,n,a){let i=s.pos-n.pos;if((!a||i)&&(a=i>=0?1:-1),!n.parent.inlineContent){let l=Tt.findFrom(n,a,!0)||Tt.findFrom(n,-a,!0);if(l)n=l.$head;else return Tt.near(n,a)}return s.parent.inlineContent||(i==0?s=n:(s=(Tt.findFrom(s,-a,!0)||Tt.findFrom(s,a,!0)).$anchor,s.pos<n.pos!=i<0&&(s=n))),new vt(s,n)}}Tt.jsonID("text",vt);class sv{constructor(s,n){this.anchor=s,this.head=n}map(s){return new sv(s.map(this.anchor),s.map(this.head))}resolve(s){return vt.between(s.resolve(this.anchor),s.resolve(this.head))}}class Ct extends Tt{constructor(s){let n=s.nodeAfter,a=s.node(0).resolve(s.pos+n.nodeSize);super(s,a),this.node=n}map(s,n){let{deleted:a,pos:i}=n.mapResult(this.anchor),l=s.resolve(i);return a?Tt.near(l):new Ct(l)}content(){return new nt(Fe.from(this.node),0,0)}eq(s){return s instanceof Ct&&s.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new kk(this.anchor)}static fromJSON(s,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Ct(s.resolve(n.anchor))}static create(s,n){return new Ct(s.resolve(n))}static isSelectable(s){return!s.isText&&s.type.spec.selectable!==!1}}Ct.prototype.visible=!1;Tt.jsonID("node",Ct);class kk{constructor(s){this.anchor=s}map(s){let{deleted:n,pos:a}=s.mapResult(this.anchor);return n?new sv(a,a):new kk(a)}resolve(s){let n=s.resolve(this.anchor),a=n.nodeAfter;return a&&Ct.isSelectable(a)?new Ct(n):Tt.near(n)}}class ka extends Tt{constructor(s){super(s.resolve(0),s.resolve(s.content.size))}replace(s,n=nt.empty){if(n==nt.empty){s.delete(0,s.doc.content.size);let a=Tt.atStart(s.doc);a.eq(s.selection)||s.setSelection(a)}else super.replace(s,n)}toJSON(){return{type:"all"}}static fromJSON(s){return new ka(s)}map(s){return new ka(s)}eq(s){return s instanceof ka}getBookmark(){return Age}}Tt.jsonID("all",ka);const Age={map(){return this},resolve(t){return new ka(t)}};function nh(t,s,n,a,i,l=!1){if(s.inlineContent)return vt.create(t,n);for(let o=a-(i>0?0:1);i>0?o<s.childCount:o>=0;o+=i){let c=s.child(o);if(c.isAtom){if(!l&&Ct.isSelectable(c))return Ct.create(t,n-(i<0?c.nodeSize:0))}else{let d=nh(t,c,n+i,i<0?c.childCount:0,i,l);if(d)return d}n+=c.nodeSize*i}return null}function BI(t,s,n){let a=t.steps.length-1;if(a<s)return;let i=t.steps[a];if(!(i instanceof qn||i instanceof er))return;let l=t.mapping.maps[a],o;l.forEach((c,d,u,f)=>{o==null&&(o=f)}),t.setSelection(Tt.near(t.doc.resolve(o),n))}function FI(t,s){return!s||!t?t:t.bind(s)}class U0{constructor(s,n,a){this.name=s,this.init=FI(n.init,a),this.apply=FI(n.apply,a)}}new U0("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new U0("selection",{init(t,s){return t.selection||Tt.atStart(s.doc)},apply(t){return t.selection}}),new U0("storedMarks",{init(t){return t.storedMarks||null},apply(t,s,n,a){return a.selection.$cursor?t.storedMarks:null}}),new U0("scrollToSelection",{init(){return 0},apply(t,s){return t.scrolledIntoView?s+1:s}});function H$(t,s,n){for(let a in t){let i=t[a];i instanceof Function?i=i.bind(s):a=="handleDOMEvents"&&(i=H$(i,s,{})),n[a]=i}return n}class kn{constructor(s){this.spec=s,this.props={},s.props&&H$(s.props,this,this.props),this.key=s.key?s.key.key:W$("plugin")}getState(s){return s[this.key]}}const rj=Object.create(null);function W$(t){return t in rj?t+"$"+ ++rj[t]:(rj[t]=0,t+"$")}class An{constructor(s="key"){this.key=W$(s)}get(s){return s.config.pluginsByKey[this.key]}getState(s){return s[this.key]}}const nv=(t,s)=>t.selection.empty?!1:(s&&s(t.tr.deleteSelection().scrollIntoView()),!0);function q$(t,s){let{$cursor:n}=t.selection;return!n||(s?!s.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const Ak=(t,s,n)=>{let a=q$(t,n);if(!a)return!1;let i=Tk(a);if(!i){let o=a.blockRange(),c=o&&Du(o);return c==null?!1:(s&&s(t.tr.lift(o,c).scrollIntoView()),!0)}let l=i.nodeBefore;if(sz(t,i,s,-1))return!0;if(a.parent.content.size==0&&(rf(l,"end")||Ct.isSelectable(l)))for(let o=a.depth;;o--){let c=tv(t.doc,a.before(o),a.after(o),nt.empty);if(c&&c.slice.size<c.to-c.from){if(s){let d=t.tr.step(c);d.setSelection(rf(l,"end")?Tt.findFrom(d.doc.resolve(d.mapping.map(i.pos,-1)),-1):Ct.create(d.doc,i.pos-l.nodeSize)),s(d.scrollIntoView())}return!0}if(o==1||a.node(o-1).childCount>1)break}return l.isAtom&&i.depth==a.depth-1?(s&&s(t.tr.delete(i.pos-l.nodeSize,i.pos).scrollIntoView()),!0):!1},G$=(t,s,n)=>{let a=q$(t,n);if(!a)return!1;let i=Tk(a);return i?Y$(t,i,s):!1},K$=(t,s,n)=>{let a=X$(t,n);if(!a)return!1;let i=Mk(a);return i?Y$(t,i,s):!1};function Y$(t,s,n){let a=s.nodeBefore,i=a,l=s.pos-1;for(;!i.isTextblock;l--){if(i.type.spec.isolating)return!1;let f=i.lastChild;if(!f)return!1;i=f}let o=s.nodeAfter,c=o,d=s.pos+1;for(;!c.isTextblock;d++){if(c.type.spec.isolating)return!1;let f=c.firstChild;if(!f)return!1;c=f}let u=tv(t.doc,l,d,nt.empty);if(!u||u.from!=l||u instanceof qn&&u.slice.size>=d-l)return!1;if(n){let f=t.tr.step(u);f.setSelection(vt.create(f.doc,l)),n(f.scrollIntoView())}return!0}function rf(t,s,n=!1){for(let a=t;a;a=s=="start"?a.firstChild:a.lastChild){if(a.isTextblock)return!0;if(n&&a.childCount!=1)return!1}return!1}const Ek=(t,s,n)=>{let{$head:a,empty:i}=t.selection,l=a;if(!i)return!1;if(a.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):a.parentOffset>0)return!1;l=Tk(a)}let o=l&&l.nodeBefore;return!o||!Ct.isSelectable(o)?!1:(s&&s(t.tr.setSelection(Ct.create(t.doc,l.pos-o.nodeSize)).scrollIntoView()),!0)};function Tk(t){if(!t.parent.type.spec.isolating)for(let s=t.depth-1;s>=0;s--){if(t.index(s)>0)return t.doc.resolve(t.before(s+1));if(t.node(s).type.spec.isolating)break}return null}function X$(t,s){let{$cursor:n}=t.selection;return!n||(s?!s.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const Pk=(t,s,n)=>{let a=X$(t,n);if(!a)return!1;let i=Mk(a);if(!i)return!1;let l=i.nodeAfter;if(sz(t,i,s,1))return!0;if(a.parent.content.size==0&&(rf(l,"start")||Ct.isSelectable(l))){let o=tv(t.doc,a.before(),a.after(),nt.empty);if(o&&o.slice.size<o.to-o.from){if(s){let c=t.tr.step(o);c.setSelection(rf(l,"start")?Tt.findFrom(c.doc.resolve(c.mapping.map(i.pos)),1):Ct.create(c.doc,c.mapping.map(i.pos))),s(c.scrollIntoView())}return!0}}return l.isAtom&&i.depth==a.depth-1?(s&&s(t.tr.delete(i.pos,i.pos+l.nodeSize).scrollIntoView()),!0):!1},Ik=(t,s,n)=>{let{$head:a,empty:i}=t.selection,l=a;if(!i)return!1;if(a.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):a.parentOffset<a.parent.content.size)return!1;l=Mk(a)}let o=l&&l.nodeAfter;return!o||!Ct.isSelectable(o)?!1:(s&&s(t.tr.setSelection(Ct.create(t.doc,l.pos)).scrollIntoView()),!0)};function Mk(t){if(!t.parent.type.spec.isolating)for(let s=t.depth-1;s>=0;s--){let n=t.node(s);if(t.index(s)+1<n.childCount)return t.doc.resolve(t.after(s+1));if(n.type.spec.isolating)break}return null}const Q$=(t,s)=>{let n=t.selection,a=n instanceof Ct,i;if(a){if(n.node.isTextblock||!Zl(t.doc,n.from))return!1;i=n.from}else if(i=Rf(t.doc,n.from,-1),i==null)return!1;if(s){let l=t.tr.join(i);a&&l.setSelection(Ct.create(l.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),s(l.scrollIntoView())}return!0},Z$=(t,s)=>{let n=t.selection,a;if(n instanceof Ct){if(n.node.isTextblock||!Zl(t.doc,n.to))return!1;a=n.to}else if(a=Rf(t.doc,n.to,1),a==null)return!1;return s&&s(t.tr.join(a).scrollIntoView()),!0},J$=(t,s)=>{let{$from:n,$to:a}=t.selection,i=n.blockRange(a),l=i&&Du(i);return l==null?!1:(s&&s(t.tr.lift(i,l).scrollIntoView()),!0)},Dk=(t,s)=>{let{$head:n,$anchor:a}=t.selection;return!n.parent.type.spec.code||!n.sameParent(a)?!1:(s&&s(t.tr.insertText(`
`).scrollIntoView()),!0)};function Ok(t){for(let s=0;s<t.edgeCount;s++){let{type:n}=t.edge(s);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const ez=(t,s)=>{let{$head:n,$anchor:a}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(a))return!1;let i=n.node(-1),l=n.indexAfter(-1),o=Ok(i.contentMatchAt(l));if(!o||!i.canReplaceWith(l,l,o))return!1;if(s){let c=n.after(),d=t.tr.replaceWith(c,c,o.createAndFill());d.setSelection(Tt.near(d.doc.resolve(c),1)),s(d.scrollIntoView())}return!0},Rk=(t,s)=>{let n=t.selection,{$from:a,$to:i}=n;if(n instanceof ka||a.parent.inlineContent||i.parent.inlineContent)return!1;let l=Ok(i.parent.contentMatchAt(i.indexAfter()));if(!l||!l.isTextblock)return!1;if(s){let o=(!a.parentOffset&&i.index()<i.parent.childCount?a:i).pos,c=t.tr.insert(o,l.createAndFill());c.setSelection(vt.create(c.doc,o+1)),s(c.scrollIntoView())}return!0},Lk=(t,s)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let l=n.before();if(Xa(t.doc,l))return s&&s(t.tr.split(l).scrollIntoView()),!0}let a=n.blockRange(),i=a&&Du(a);return i==null?!1:(s&&s(t.tr.lift(a,i).scrollIntoView()),!0)};function Ege(t){return(s,n)=>{let{$from:a,$to:i}=s.selection;if(s.selection instanceof Ct&&s.selection.node.isBlock)return!a.parentOffset||!Xa(s.doc,a.pos)?!1:(n&&n(s.tr.split(a.pos).scrollIntoView()),!0);if(!a.depth)return!1;let l=[],o,c,d=!1,u=!1;for(let b=a.depth;;b--)if(a.node(b).isBlock){d=a.end(b)==a.pos+(a.depth-b),u=a.start(b)==a.pos-(a.depth-b),c=Ok(a.node(b-1).contentMatchAt(a.indexAfter(b-1))),l.unshift(d&&c?{type:c}:null),o=b;break}else{if(b==1)return!1;l.unshift(null)}let f=s.tr;(s.selection instanceof vt||s.selection instanceof ka)&&f.deleteSelection();let m=f.mapping.map(a.pos),x=Xa(f.doc,m,l.length,l);if(x||(l[0]=c?{type:c}:null,x=Xa(f.doc,m,l.length,l)),!x)return!1;if(f.split(m,l.length,l),!d&&u&&a.node(o).type!=c){let b=f.mapping.map(a.before(o)),w=f.doc.resolve(b);c&&a.node(o-1).canReplaceWith(w.index(),w.index()+1,c)&&f.setNodeMarkup(f.mapping.map(a.before(o)),c)}return n&&n(f.scrollIntoView()),!0}}const Tge=Ege(),tz=(t,s)=>{let{$from:n,to:a}=t.selection,i,l=n.sharedDepth(a);return l==0?!1:(i=n.before(l),s&&s(t.tr.setSelection(Ct.create(t.doc,i))),!0)};function Pge(t,s,n){let a=s.nodeBefore,i=s.nodeAfter,l=s.index();return!a||!i||!a.type.compatibleContent(i.type)?!1:!a.content.size&&s.parent.canReplace(l-1,l)?(n&&n(t.tr.delete(s.pos-a.nodeSize,s.pos).scrollIntoView()),!0):!s.parent.canReplace(l,l+1)||!(i.isTextblock||Zl(t.doc,s.pos))?!1:(n&&n(t.tr.join(s.pos).scrollIntoView()),!0)}function sz(t,s,n,a){let i=s.nodeBefore,l=s.nodeAfter,o,c,d=i.type.spec.isolating||l.type.spec.isolating;if(!d&&Pge(t,s,n))return!0;let u=!d&&s.parent.canReplace(s.index(),s.index()+1);if(u&&(o=(c=i.contentMatchAt(i.childCount)).findWrapping(l.type))&&c.matchType(o[0]||l.type).validEnd){if(n){let b=s.pos+l.nodeSize,w=Fe.empty;for(let C=o.length-1;C>=0;C--)w=Fe.from(o[C].create(null,w));w=Fe.from(i.copy(w));let j=t.tr.step(new er(s.pos-1,b,s.pos,b,new nt(w,1,0),o.length,!0)),_=j.doc.resolve(b+2*o.length);_.nodeAfter&&_.nodeAfter.type==i.type&&Zl(j.doc,_.pos)&&j.join(_.pos),n(j.scrollIntoView())}return!0}let f=l.type.spec.isolating||a>0&&d?null:Tt.findFrom(s,1),m=f&&f.$from.blockRange(f.$to),x=m&&Du(m);if(x!=null&&x>=s.depth)return n&&n(t.tr.lift(m,x).scrollIntoView()),!0;if(u&&rf(l,"start",!0)&&rf(i,"end")){let b=i,w=[];for(;w.push(b),!b.isTextblock;)b=b.lastChild;let j=l,_=1;for(;!j.isTextblock;j=j.firstChild)_++;if(b.canReplace(b.childCount,b.childCount,j.content)){if(n){let C=Fe.empty;for(let A=w.length-1;A>=0;A--)C=Fe.from(w[A].copy(C));let k=t.tr.step(new er(s.pos-w.length,s.pos+l.nodeSize,s.pos+_,s.pos+l.nodeSize-_,new nt(C,w.length,0),0,!0));n(k.scrollIntoView())}return!0}}return!1}function nz(t){return function(s,n){let a=s.selection,i=t<0?a.$from:a.$to,l=i.depth;for(;i.node(l).isInline;){if(!l)return!1;l--}return i.node(l).isTextblock?(n&&n(s.tr.setSelection(vt.create(s.doc,t<0?i.start(l):i.end(l)))),!0):!1}}const rz=nz(-1),az=nz(1);function iz(t,s=null){return function(n,a){let{$from:i,$to:l}=n.selection,o=i.blockRange(l),c=o&&Ck(o,t,s);return c?(a&&a(n.tr.wrap(o,c).scrollIntoView()),!0):!1}}function Jy(t,s=null){return function(n,a){let i=!1;for(let l=0;l<n.selection.ranges.length&&!i;l++){let{$from:{pos:o},$to:{pos:c}}=n.selection.ranges[l];n.doc.nodesBetween(o,c,(d,u)=>{if(i)return!1;if(!(!d.isTextblock||d.hasMarkup(t,s)))if(d.type==t)i=!0;else{let f=n.doc.resolve(u),m=f.index();i=f.parent.canReplaceWith(m,m+1,t)}})}if(!i)return!1;if(a){let l=n.tr;for(let o=0;o<n.selection.ranges.length;o++){let{$from:{pos:c},$to:{pos:d}}=n.selection.ranges[o];l.setBlockType(c,d,t,s)}a(l.scrollIntoView())}return!0}}function Bk(...t){return function(s,n,a){for(let i=0;i<t.length;i++)if(t[i](s,n,a))return!0;return!1}}Bk(nv,Ak,Ek);Bk(nv,Pk,Ik);Bk(Dk,Rk,Lk,Tge);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function lz(t,s=null){return function(n,a){let{$from:i,$to:l}=n.selection,o=i.blockRange(l);if(!o)return!1;let c=a?n.tr:null;return Ige(c,o,t,s)?(a&&a(c.scrollIntoView()),!0):!1}}function Ige(t,s,n,a=null){let i=!1,l=s,o=s.$from.doc;if(s.depth>=2&&s.$from.node(s.depth-1).type.compatibleContent(n)&&s.startIndex==0){if(s.$from.index(s.depth-1)==0)return!1;let d=o.resolve(s.start-2);l=new Qy(d,d,s.depth),s.endIndex<s.parent.childCount&&(s=new Qy(s.$from,o.resolve(s.$to.end(s.depth)),s.depth)),i=!0}let c=Ck(l,n,a,s);return c?(t&&Mge(t,s,c,i,n),!0):!1}function Mge(t,s,n,a,i){let l=Fe.empty;for(let f=n.length-1;f>=0;f--)l=Fe.from(n[f].type.create(n[f].attrs,l));t.step(new er(s.start-(a?2:0),s.end,s.start,s.end,new nt(l,0,0),n.length,!0));let o=0;for(let f=0;f<n.length;f++)n[f].type==i&&(o=f+1);let c=n.length-o,d=s.start+n.length-(a?2:0),u=s.parent;for(let f=s.startIndex,m=s.endIndex,x=!0;f<m;f++,x=!1)!x&&Xa(t.doc,d,c)&&(t.split(d,c),d+=2*c),d+=u.child(f).nodeSize;return t}function oz(t){return function(s,n){let{$from:a,$to:i}=s.selection,l=a.blockRange(i,o=>o.childCount>0&&o.firstChild.type==t);return l?n?a.node(l.depth-1).type==t?Dge(s,n,t,l):Oge(s,n,l):!0:!1}}function Dge(t,s,n,a){let i=t.tr,l=a.end,o=a.$to.end(a.depth);l<o&&(i.step(new er(l-1,o,l,o,new nt(Fe.from(n.create(null,a.parent.copy())),1,0),1,!0)),a=new Qy(i.doc.resolve(a.$from.pos),i.doc.resolve(o),a.depth));const c=Du(a);if(c==null)return!1;i.lift(a,c);let d=i.doc.resolve(i.mapping.map(l,-1)-1);return Zl(i.doc,d.pos)&&d.nodeBefore.type==d.nodeAfter.type&&i.join(d.pos),s(i.scrollIntoView()),!0}function Oge(t,s,n){let a=t.tr,i=n.parent;for(let b=n.end,w=n.endIndex-1,j=n.startIndex;w>j;w--)b-=i.child(w).nodeSize,a.delete(b-1,b+1);let l=a.doc.resolve(n.start),o=l.nodeAfter;if(a.mapping.map(n.end)!=n.start+l.nodeAfter.nodeSize)return!1;let c=n.startIndex==0,d=n.endIndex==i.childCount,u=l.node(-1),f=l.index(-1);if(!u.canReplace(f+(c?0:1),f+1,o.content.append(d?Fe.empty:Fe.from(i))))return!1;let m=l.pos,x=m+o.nodeSize;return a.step(new er(m-(c?1:0),x+(d?1:0),m+1,x-1,new nt((c?Fe.empty:Fe.from(i.copy(Fe.empty))).append(d?Fe.empty:Fe.from(i.copy(Fe.empty))),c?0:1,d?0:1),c?0:1)),s(a.scrollIntoView()),!0}function cz(t){return function(s,n){let{$from:a,$to:i}=s.selection,l=a.blockRange(i,u=>u.childCount>0&&u.firstChild.type==t);if(!l)return!1;let o=l.startIndex;if(o==0)return!1;let c=l.parent,d=c.child(o-1);if(d.type!=t)return!1;if(n){let u=d.lastChild&&d.lastChild.type==c.type,f=Fe.from(u?t.create():null),m=new nt(Fe.from(t.create(null,Fe.from(c.type.create(null,f)))),u?3:1,0),x=l.start,b=l.end;n(s.tr.step(new er(x-(u?3:1),b,x,b,m,1,!0)).scrollIntoView())}return!0}}const Ou=function(t){for(var s=0;;s++)if(t=t.previousSibling,!t)return s},dz=function(t,s,n,a){return n&&($I(t,s,n,a,-1)||$I(t,s,n,a,1))},Rge=/^(img|br|input|textarea|hr)$/i;function $I(t,s,n,a,i){for(var l;;){if(t==n&&s==a)return!0;if(s==(i<0?0:e1(t))){let o=t.parentNode;if(!o||o.nodeType!=1||Fk(t)||Rge.test(t.nodeName)||t.contentEditable=="false")return!1;s=Ou(t)+(i<0?0:1),t=o}else if(t.nodeType==1){let o=t.childNodes[s+(i<0?-1:0)];if(o.nodeType==1&&o.contentEditable=="false")if(!((l=o.pmViewDesc)===null||l===void 0)&&l.ignoreForSelection)s+=i;else return!1;else t=o,s=i<0?e1(t):0}else return!1}}function e1(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Lge(t,s,n){for(let a=s==0,i=s==e1(t);a||i;){if(t==n)return!0;let l=Ou(t);if(t=t.parentNode,!t)return!1;a=a&&l==0,i=i&&l==e1(t)}}function Fk(t){let s;for(let n=t;n&&!(s=n.pmViewDesc);n=n.parentNode);return s&&s.node&&s.node.isBlock&&(s.dom==t||s.contentDOM==t)}const uz=function(t){return t.focusNode&&dz(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function hz(t,s){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=s,n}const Wl=typeof navigator<"u"?navigator:null,zI=typeof document<"u"?document:null,id=Wl&&Wl.userAgent||"",iS=/Edge\/(\d+)/.exec(id),fz=/MSIE \d/.exec(id),lS=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(id),Tx=!!(fz||lS||iS),mz=fz?document.documentMode:lS?+lS[1]:iS?+iS[1]:0,rv=!Tx&&/gecko\/(\d+)/i.test(id);rv&&+(/Firefox\/(\d+)/.exec(id)||[0,0])[1];const oS=!Tx&&/Chrome\/(\d+)/.exec(id),ld=!!oS,pz=oS?+oS[1]:0,Ru=!Tx&&!!Wl&&/Apple Computer/.test(Wl.vendor),$k=Ru&&(/Mobile\/\w+/.test(id)||!!Wl&&Wl.maxTouchPoints>2),yi=$k||(Wl?/Mac/.test(Wl.platform):!1),Bge=Wl?/Win/.test(Wl.platform):!1,Px=/Android \d/.test(id),zk=!!zI&&"webkitFontSmoothing"in zI.documentElement.style,Fge=zk?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function $ge(t,s=null){let n=t.domSelectionRange(),a=t.state.doc;if(!n.focusNode)return null;let i=t.docView.nearestDesc(n.focusNode),l=i&&i.size==0,o=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(o<0)return null;let c=a.resolve(o),d,u;if(uz(n)){for(d=o;i&&!i.node;)i=i.parent;let m=i.node;if(i&&m.isAtom&&Ct.isSelectable(m)&&i.parent&&!(m.isInline&&Lge(n.focusNode,n.focusOffset,i.dom))){let x=i.posBefore;u=new Ct(o==x?c:a.resolve(x))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let m=o,x=o;for(let b=0;b<n.rangeCount;b++){let w=n.getRangeAt(b);m=Math.min(m,t.docView.posFromDOM(w.startContainer,w.startOffset,1)),x=Math.max(x,t.docView.posFromDOM(w.endContainer,w.endOffset,-1))}if(m<0)return null;[d,o]=x==t.state.selection.anchor?[x,m]:[m,x],c=a.resolve(o)}else d=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(d<0)return null}let f=a.resolve(d);if(!u){let m=s=="pointer"||t.state.selection.head<c.pos&&!l?1:-1;u=gz(t,f,c,m)}return u}function xz(t){return t.editable?t.hasFocus():Hge(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Uk(t,s=!1){let n=t.state.selection;if(Vge(t,n),!!xz(t)){if(!s&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&ld){let a=t.domSelectionRange(),i=t.domObserver.currentSelection;if(a.anchorNode&&i.anchorNode&&dz(a.anchorNode,a.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)Uge(t);else{let{anchor:a,head:i}=n,l,o;UI&&!(n instanceof vt)&&(n.$from.parent.inlineContent||(l=VI(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(o=VI(t,n.to))),t.docView.setSelection(a,i,t,s),UI&&(l&&HI(l),o&&HI(o)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&zge(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const UI=Ru||ld&&pz<63;function VI(t,s){let{node:n,offset:a}=t.docView.domFromPos(s,0),i=a<n.childNodes.length?n.childNodes[a]:null,l=a?n.childNodes[a-1]:null;if(Ru&&i&&i.contentEditable=="false")return aj(i);if((!i||i.contentEditable=="false")&&(!l||l.contentEditable=="false")){if(i)return aj(i);if(l)return aj(l)}}function aj(t){return t.contentEditable="true",Ru&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function HI(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function zge(t){let s=t.dom.ownerDocument;s.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),a=n.anchorNode,i=n.anchorOffset;s.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=a||n.anchorOffset!=i)&&(s.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!xz(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function Uge(t){let s=t.domSelection();if(!s)return;let n=t.cursorWrapper.dom,a=n.nodeName=="IMG";a?s.collapse(n.parentNode,Ou(n)+1):s.collapse(n,0),!a&&!t.state.selection.visible&&Tx&&mz<=11&&(n.disabled=!0,n.disabled=!1)}function Vge(t,s){if(s instanceof Ct){let n=t.docView.descAt(s.from);n!=t.lastSelectedViewDesc&&(WI(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else WI(t)}function WI(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function gz(t,s,n,a){return t.someProp("createSelectionBetween",i=>i(t,s,n))||vt.between(s,n,a)}function Hge(t){let s=t.domSelectionRange();if(!s.anchorNode)return!1;try{return t.dom.contains(s.anchorNode.nodeType==3?s.anchorNode.parentNode:s.anchorNode)&&(t.editable||t.dom.contains(s.focusNode.nodeType==3?s.focusNode.parentNode:s.focusNode))}catch{return!1}}function cS(t,s){let{$anchor:n,$head:a}=t.selection,i=s>0?n.max(a):n.min(a),l=i.parent.inlineContent?i.depth?t.doc.resolve(s>0?i.after():i.before()):null:i;return l&&Tt.findFrom(l,s)}function cc(t,s){return t.dispatch(t.state.tr.setSelection(s).scrollIntoView()),!0}function qI(t,s,n){let a=t.state.selection;if(a instanceof vt)if(n.indexOf("s")>-1){let{$head:i}=a,l=i.textOffset?null:s<0?i.nodeBefore:i.nodeAfter;if(!l||l.isText||!l.isLeaf)return!1;let o=t.state.doc.resolve(i.pos+l.nodeSize*(s<0?-1:1));return cc(t,new vt(a.$anchor,o))}else if(a.empty){if(t.endOfTextblock(s>0?"forward":"backward")){let i=cS(t.state,s);return i&&i instanceof Ct?cc(t,i):!1}else if(!(yi&&n.indexOf("m")>-1)){let i=a.$head,l=i.textOffset?null:s<0?i.nodeBefore:i.nodeAfter,o;if(!l||l.isText)return!1;let c=s<0?i.pos-l.nodeSize:i.pos;return l.isAtom||(o=t.docView.descAt(c))&&!o.contentDOM?Ct.isSelectable(l)?cc(t,new Ct(s<0?t.state.doc.resolve(i.pos-l.nodeSize):i)):zk?cc(t,new vt(t.state.doc.resolve(s<0?c:c+l.nodeSize))):!1:!1}}else return!1;else{if(a instanceof Ct&&a.node.isInline)return cc(t,new vt(s>0?a.$to:a.$from));{let i=cS(t.state,s);return i?cc(t,i):!1}}}function t1(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function lp(t,s){let n=t.pmViewDesc;return n&&n.size==0&&(s<0||t.nextSibling||t.nodeName!="BR")}function Ju(t,s){return s<0?Wge(t):qge(t)}function Wge(t){let s=t.domSelectionRange(),n=s.focusNode,a=s.focusOffset;if(!n)return;let i,l,o=!1;for(rv&&n.nodeType==1&&a<t1(n)&&lp(n.childNodes[a],-1)&&(o=!0);;)if(a>0){if(n.nodeType!=1)break;{let c=n.childNodes[a-1];if(lp(c,-1))i=n,l=--a;else if(c.nodeType==3)n=c,a=n.nodeValue.length;else break}}else{if(yz(n))break;{let c=n.previousSibling;for(;c&&lp(c,-1);)i=n.parentNode,l=Ou(c),c=c.previousSibling;if(c)n=c,a=t1(n);else{if(n=n.parentNode,n==t.dom)break;a=0}}}o?dS(t,n,a):i&&dS(t,i,l)}function qge(t){let s=t.domSelectionRange(),n=s.focusNode,a=s.focusOffset;if(!n)return;let i=t1(n),l,o;for(;;)if(a<i){if(n.nodeType!=1)break;let c=n.childNodes[a];if(lp(c,1))l=n,o=++a;else break}else{if(yz(n))break;{let c=n.nextSibling;for(;c&&lp(c,1);)l=c.parentNode,o=Ou(c)+1,c=c.nextSibling;if(c)n=c,a=0,i=t1(n);else{if(n=n.parentNode,n==t.dom)break;a=i=0}}}l&&dS(t,l,o)}function yz(t){let s=t.pmViewDesc;return s&&s.node&&s.node.isBlock}function Gge(t,s){for(;t&&s==t.childNodes.length&&!Fk(t);)s=Ou(t)+1,t=t.parentNode;for(;t&&s<t.childNodes.length;){let n=t.childNodes[s];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,s=0}}function Kge(t,s){for(;t&&!s&&!Fk(t);)s=Ou(t),t=t.parentNode;for(;t&&s;){let n=t.childNodes[s-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,s=t.childNodes.length}}function dS(t,s,n){if(s.nodeType!=3){let l,o;(o=Gge(s,n))?(s=o,n=0):(l=Kge(s,n))&&(s=l,n=l.nodeValue.length)}let a=t.domSelection();if(!a)return;if(uz(a)){let l=document.createRange();l.setEnd(s,n),l.setStart(s,n),a.removeAllRanges(),a.addRange(l)}else a.extend&&a.extend(s,n);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&Uk(t)},50)}function GI(t,s){let n=t.state.doc.resolve(s);if(!(ld||Bge)&&n.parent.inlineContent){let i=t.coordsAtPos(s);if(s>n.start()){let l=t.coordsAtPos(s-1),o=(l.top+l.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(l.left-i.left)>1)return l.left<i.left?"ltr":"rtl"}if(s<n.end()){let l=t.coordsAtPos(s+1),o=(l.top+l.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(l.left-i.left)>1)return l.left>i.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function KI(t,s,n){let a=t.state.selection;if(a instanceof vt&&!a.empty||n.indexOf("s")>-1||yi&&n.indexOf("m")>-1)return!1;let{$from:i,$to:l}=a;if(!i.parent.inlineContent||t.endOfTextblock(s<0?"up":"down")){let o=cS(t.state,s);if(o&&o instanceof Ct)return cc(t,o)}if(!i.parent.inlineContent){let o=s<0?i:l,c=a instanceof ka?Tt.near(o,s):Tt.findFrom(o,s);return c?cc(t,c):!1}return!1}function YI(t,s){if(!(t.state.selection instanceof vt))return!0;let{$head:n,$anchor:a,empty:i}=t.state.selection;if(!n.sameParent(a))return!0;if(!i)return!1;if(t.endOfTextblock(s>0?"forward":"backward"))return!0;let l=!n.textOffset&&(s<0?n.nodeBefore:n.nodeAfter);if(l&&!l.isText){let o=t.state.tr;return s<0?o.delete(n.pos-l.nodeSize,n.pos):o.delete(n.pos,n.pos+l.nodeSize),t.dispatch(o),!0}return!1}function XI(t,s,n){t.domObserver.stop(),s.contentEditable=n,t.domObserver.start()}function Yge(t){if(!Ru||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:s,focusOffset:n}=t.domSelectionRange();if(s&&s.nodeType==1&&n==0&&s.firstChild&&s.firstChild.contentEditable=="false"){let a=s.firstChild;XI(t,a,"true"),setTimeout(()=>XI(t,a,"false"),20)}return!1}function Xge(t){let s="";return t.ctrlKey&&(s+="c"),t.metaKey&&(s+="m"),t.altKey&&(s+="a"),t.shiftKey&&(s+="s"),s}function Qge(t,s){let n=s.keyCode,a=Xge(s);if(n==8||yi&&n==72&&a=="c")return YI(t,-1)||Ju(t,-1);if(n==46&&!s.shiftKey||yi&&n==68&&a=="c")return YI(t,1)||Ju(t,1);if(n==13||n==27)return!0;if(n==37||yi&&n==66&&a=="c"){let i=n==37?GI(t,t.state.selection.from)=="ltr"?-1:1:-1;return qI(t,i,a)||Ju(t,i)}else if(n==39||yi&&n==70&&a=="c"){let i=n==39?GI(t,t.state.selection.from)=="ltr"?1:-1:1;return qI(t,i,a)||Ju(t,i)}else{if(n==38||yi&&n==80&&a=="c")return KI(t,-1,a)||Ju(t,-1);if(n==40||yi&&n==78&&a=="c")return Yge(t)||KI(t,1,a)||Ju(t,1);if(a==(yi?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function bz(t,s){t.someProp("transformCopied",b=>{s=b(s,t)});let n=[],{content:a,openStart:i,openEnd:l}=s;for(;i>1&&l>1&&a.childCount==1&&a.firstChild.childCount==1;){i--,l--;let b=a.firstChild;n.push(b.type.name,b.attrs!=b.type.defaultAttrs?b.attrs:null),a=b.content}let o=t.someProp("clipboardSerializer")||ev.fromSchema(t.state.schema),c=Sz(),d=c.createElement("div");d.appendChild(o.serializeFragment(a,{document:c}));let u=d.firstChild,f,m=0;for(;u&&u.nodeType==1&&(f=_z[u.nodeName.toLowerCase()]);){for(let b=f.length-1;b>=0;b--){let w=c.createElement(f[b]);for(;d.firstChild;)w.appendChild(d.firstChild);d.appendChild(w),m++}u=d.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${i} ${l}${m?` -${m}`:""} ${JSON.stringify(n)}`);let x=t.someProp("clipboardTextSerializer",b=>b(s,t))||s.content.textBetween(0,s.content.size,`

`);return{dom:d,text:x,slice:s}}function vz(t,s,n,a,i){let l=i.parent.type.spec.code,o,c;if(!n&&!s)return null;let d=!!s&&(a||l||!n);if(d){if(t.someProp("transformPastedText",x=>{s=x(s,l||a,t)}),l)return c=new nt(Fe.from(t.state.schema.text(s.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",x=>{c=x(c,t,!0)}),c;let m=t.someProp("clipboardTextParser",x=>x(s,i,a,t));if(m)c=m;else{let x=i.marks(),{schema:b}=t.state,w=ev.fromSchema(b);o=document.createElement("div"),s.split(/(?:\r\n?|\n)+/).forEach(j=>{let _=o.appendChild(document.createElement("p"));j&&_.appendChild(w.serializeNode(b.text(j,x)))})}}else t.someProp("transformPastedHTML",m=>{n=m(n,t)}),o=tye(n),zk&&sye(o);let u=o&&o.querySelector("[data-pm-slice]"),f=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(f&&f[3])for(let m=+f[3];m>0;m--){let x=o.firstChild;for(;x&&x.nodeType!=1;)x=x.nextSibling;if(!x)break;o=x}if(c||(c=(t.someProp("clipboardParser")||t.someProp("domParser")||zl.fromSchema(t.state.schema)).parseSlice(o,{preserveWhitespace:!!(d||f),context:i,ruleFromNode(x){return x.nodeName=="BR"&&!x.nextSibling&&x.parentNode&&!Zge.test(x.parentNode.nodeName)?{ignore:!0}:null}})),f)c=nye(QI(c,+f[1],+f[2]),f[4]);else if(c=nt.maxOpen(Jge(c.content,i),!0),c.openStart||c.openEnd){let m=0,x=0;for(let b=c.content.firstChild;m<c.openStart&&!b.type.spec.isolating;m++,b=b.firstChild);for(let b=c.content.lastChild;x<c.openEnd&&!b.type.spec.isolating;x++,b=b.lastChild);c=QI(c,m,x)}return t.someProp("transformPasted",m=>{c=m(c,t,d)}),c}const Zge=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Jge(t,s){if(t.childCount<2)return t;for(let n=s.depth;n>=0;n--){let i=s.node(n).contentMatchAt(s.index(n)),l,o=[];if(t.forEach(c=>{if(!o)return;let d=i.findWrapping(c.type),u;if(!d)return o=null;if(u=o.length&&l.length&&Nz(d,l,c,o[o.length-1],0))o[o.length-1]=u;else{o.length&&(o[o.length-1]=jz(o[o.length-1],l.length));let f=wz(c,d);o.push(f),i=i.matchType(f.type),l=d}}),o)return Fe.from(o)}return t}function wz(t,s,n=0){for(let a=s.length-1;a>=n;a--)t=s[a].create(null,Fe.from(t));return t}function Nz(t,s,n,a,i){if(i<t.length&&i<s.length&&t[i]==s[i]){let l=Nz(t,s,n,a.lastChild,i+1);if(l)return a.copy(a.content.replaceChild(a.childCount-1,l));if(a.contentMatchAt(a.childCount).matchType(i==t.length-1?n.type:t[i+1]))return a.copy(a.content.append(Fe.from(wz(n,t,i+1))))}}function jz(t,s){if(s==0)return t;let n=t.content.replaceChild(t.childCount-1,jz(t.lastChild,s-1)),a=t.contentMatchAt(t.childCount).fillBefore(Fe.empty,!0);return t.copy(n.append(a))}function uS(t,s,n,a,i,l){let o=s<0?t.firstChild:t.lastChild,c=o.content;return t.childCount>1&&(l=0),i<a-1&&(c=uS(c,s,n,a,i+1,l)),i>=n&&(c=s<0?o.contentMatchAt(0).fillBefore(c,l<=i).append(c):c.append(o.contentMatchAt(o.childCount).fillBefore(Fe.empty,!0))),t.replaceChild(s<0?0:t.childCount-1,o.copy(c))}function QI(t,s,n){return s<t.openStart&&(t=new nt(uS(t.content,-1,s,t.openStart,0,t.openEnd),s,t.openEnd)),n<t.openEnd&&(t=new nt(uS(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const _z={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let ZI=null;function Sz(){return ZI||(ZI=document.implementation.createHTMLDocument("title"))}let ij=null;function eye(t){let s=window.trustedTypes;return s?(ij||(ij=s.defaultPolicy||s.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),ij.createHTML(t)):t}function tye(t){let s=/^(\s*<meta [^>]*>)*/.exec(t);s&&(t=t.slice(s[0].length));let n=Sz().createElement("div"),a=/<([a-z][^>\s]+)/i.exec(t),i;if((i=a&&_z[a[1].toLowerCase()])&&(t=i.map(l=>"<"+l+">").join("")+t+i.map(l=>"</"+l+">").reverse().join("")),n.innerHTML=eye(t),i)for(let l=0;l<i.length;l++)n=n.querySelector(i[l])||n;return n}function sye(t){let s=t.querySelectorAll(ld?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<s.length;n++){let a=s[n];a.childNodes.length==1&&a.textContent==""&&a.parentNode&&a.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),a)}}function nye(t,s){if(!t.size)return t;let n=t.content.firstChild.type.schema,a;try{a=JSON.parse(s)}catch{return t}let{content:i,openStart:l,openEnd:o}=t;for(let c=a.length-2;c>=0;c-=2){let d=n.nodes[a[c]];if(!d||d.hasRequiredAttrs())break;i=Fe.from(d.create(a[c+1],i)),l++,o++}return new nt(i,l,o)}const cl={},ei={};function Nc(t,s){t.input.lastSelectionOrigin=s,t.input.lastSelectionTime=Date.now()}ei.keydown=(t,s)=>{let n=s;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!kz(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(Px&&ld&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),$k&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let a=Date.now();t.input.lastIOSEnter=a,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==a&&(t.someProp("handleKeyDown",i=>i(t,hz(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",a=>a(t,n))||Qge(t,n)?n.preventDefault():Nc(t,"key")};ei.keyup=(t,s)=>{s.keyCode==16&&(t.input.shiftKey=!1)};ei.keypress=(t,s)=>{let n=s;if(kz(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||yi&&n.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,n))){n.preventDefault();return}let a=t.state.selection;if(!(a instanceof vt)||!a.$from.sameParent(a.$to)){let i=String.fromCharCode(n.charCode),l=()=>t.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",o=>o(t,a.$from.pos,a.$to.pos,i,l))&&t.dispatch(l()),n.preventDefault()}};function av(t){return{left:t.clientX,top:t.clientY}}function rye(t,s){let n=s.x-t.clientX,a=s.y-t.clientY;return n*n+a*a<100}function Vk(t,s,n,a,i){if(a==-1)return!1;let l=t.state.doc.resolve(a);for(let o=l.depth+1;o>0;o--)if(t.someProp(s,c=>o>l.depth?c(t,n,l.nodeAfter,l.before(o),i,!0):c(t,n,l.node(o),l.before(o),i,!1)))return!0;return!1}function Bh(t,s,n){if(t.focused||t.focus(),t.state.selection.eq(s))return;let a=t.state.tr.setSelection(s);a.setMeta("pointer",!0),t.dispatch(a)}function aye(t,s){if(s==-1)return!1;let n=t.state.doc.resolve(s),a=n.nodeAfter;return a&&a.isAtom&&Ct.isSelectable(a)?(Bh(t,new Ct(n)),!0):!1}function iye(t,s){if(s==-1)return!1;let n=t.state.selection,a,i;n instanceof Ct&&(a=n.node);let l=t.state.doc.resolve(s);for(let o=l.depth+1;o>0;o--){let c=o>l.depth?l.nodeAfter:l.node(o);if(Ct.isSelectable(c)){a&&n.$from.depth>0&&o>=n.$from.depth&&l.before(n.$from.depth+1)==n.$from.pos?i=l.before(n.$from.depth):i=l.before(o);break}}return i!=null?(Bh(t,Ct.create(t.state.doc,i)),!0):!1}function lye(t,s,n,a,i){return Vk(t,"handleClickOn",s,n,a)||t.someProp("handleClick",l=>l(t,s,a))||(i?iye(t,n):aye(t,n))}function oye(t,s,n,a){return Vk(t,"handleDoubleClickOn",s,n,a)||t.someProp("handleDoubleClick",i=>i(t,s,a))}function cye(t,s,n,a){return Vk(t,"handleTripleClickOn",s,n,a)||t.someProp("handleTripleClick",i=>i(t,s,a))||dye(t,n,a)}function dye(t,s,n){if(n.button!=0)return!1;let a=t.state.doc;if(s==-1)return a.inlineContent?(Bh(t,vt.create(a,0,a.content.size)),!0):!1;let i=a.resolve(s);for(let l=i.depth+1;l>0;l--){let o=l>i.depth?i.nodeAfter:i.node(l),c=i.before(l);if(o.inlineContent)Bh(t,vt.create(a,c+1,c+1+o.content.size));else if(Ct.isSelectable(o))Bh(t,Ct.create(a,c));else continue;return!0}}function Hk(t){return s1(t)}const Cz=yi?"metaKey":"ctrlKey";cl.mousedown=(t,s)=>{let n=s;t.input.shiftKey=n.shiftKey;let a=Hk(t),i=Date.now(),l="singleClick";i-t.input.lastClick.time<500&&rye(n,t.input.lastClick)&&!n[Cz]&&t.input.lastClick.button==n.button&&(t.input.lastClick.type=="singleClick"?l="doubleClick":t.input.lastClick.type=="doubleClick"&&(l="tripleClick")),t.input.lastClick={time:i,x:n.clientX,y:n.clientY,type:l,button:n.button};let o=t.posAtCoords(av(n));o&&(l=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new uye(t,o,n,!!a)):(l=="doubleClick"?oye:cye)(t,o.pos,o.inside,n)?n.preventDefault():Nc(t,"pointer"))};class uye{constructor(s,n,a,i){this.view=s,this.pos=n,this.event=a,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=s.state.doc,this.selectNode=!!a[Cz],this.allowDefault=a.shiftKey;let l,o;if(n.inside>-1)l=s.state.doc.nodeAt(n.inside),o=n.inside;else{let f=s.state.doc.resolve(n.pos);l=f.parent,o=f.depth?f.before():0}const c=i?null:a.target,d=c?s.docView.nearestDesc(c,!0):null;this.target=d&&d.nodeDOM.nodeType==1?d.nodeDOM:null;let{selection:u}=s.state;(a.button==0&&l.type.spec.draggable&&l.type.spec.selectable!==!1||u instanceof Ct&&u.from<=o&&u.to>o)&&(this.mightDrag={node:l,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&rv&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),s.root.addEventListener("mouseup",this.up=this.up.bind(this)),s.root.addEventListener("mousemove",this.move=this.move.bind(this)),Nc(s,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Uk(this.view)),this.view.input.mouseDown=null}up(s){if(this.done(),!this.view.dom.contains(s.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(av(s))),this.updateAllowDefault(s),this.allowDefault||!n?Nc(this.view,"pointer"):lye(this.view,n.pos,n.inside,s,this.selectNode)?s.preventDefault():s.button==0&&(this.flushed||Ru&&this.mightDrag&&!this.mightDrag.node.isAtom||ld&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(Bh(this.view,Tt.near(this.view.state.doc.resolve(n.pos))),s.preventDefault()):Nc(this.view,"pointer")}move(s){this.updateAllowDefault(s),Nc(this.view,"pointer"),s.buttons==0&&this.done()}updateAllowDefault(s){!this.allowDefault&&(Math.abs(this.event.x-s.clientX)>4||Math.abs(this.event.y-s.clientY)>4)&&(this.allowDefault=!0)}}cl.touchstart=t=>{t.input.lastTouch=Date.now(),Hk(t),Nc(t,"pointer")};cl.touchmove=t=>{t.input.lastTouch=Date.now(),Nc(t,"pointer")};cl.contextmenu=t=>Hk(t);function kz(t,s){return t.composing?!0:Ru&&Math.abs(s.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const hye=Px?5e3:-1;ei.compositionstart=ei.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:s}=t,n=s.selection.$to;if(s.selection instanceof vt&&(s.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(a=>a.type.spec.inclusive===!1)))t.markCursor=t.state.storedMarks||n.marks(),s1(t,!0),t.markCursor=null;else if(s1(t,!s.selection.empty),rv&&s.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let a=t.domSelectionRange();for(let i=a.focusNode,l=a.focusOffset;i&&i.nodeType==1&&l!=0;){let o=l<0?i.lastChild:i.childNodes[l-1];if(!o)break;if(o.nodeType==3){let c=t.domSelection();c&&c.collapse(o,o.nodeValue.length);break}else i=o,l=-1}}t.input.composing=!0}Az(t,hye)};ei.compositionend=(t,s)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=s.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,Az(t,20))};function Az(t,s){clearTimeout(t.input.composingTimeout),s>-1&&(t.input.composingTimeout=setTimeout(()=>s1(t),s))}function fye(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=mye());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function mye(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function s1(t,s=!1){if(!(Px&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),fye(t),s||t.docView&&t.docView.dirty){let n=$ge(t),a=t.state.selection;return n&&!n.eq(a)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||s)&&!a.$from.node(a.$from.sharedDepth(a.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function pye(t,s){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(s),n.style.cssText="position: fixed; left: -10000px; top: 10px";let a=getSelection(),i=document.createRange();i.selectNodeContents(s),t.dom.blur(),a.removeAllRanges(),a.addRange(i),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const qp=Tx&&mz<15||$k&&Fge<604;cl.copy=ei.cut=(t,s)=>{let n=s,a=t.state.selection,i=n.type=="cut";if(a.empty)return;let l=qp?null:n.clipboardData,o=a.content(),{dom:c,text:d}=bz(t,o);l?(n.preventDefault(),l.clearData(),l.setData("text/html",c.innerHTML),l.setData("text/plain",d)):pye(t,c),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function xye(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function gye(t,s){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,a=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(a.contentEditable="true"),a.style.cssText="position: fixed; left: -10000px; top: 10px",a.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),a.parentNode&&a.parentNode.removeChild(a),n?hS(t,a.value,null,i,s):hS(t,a.textContent,a.innerHTML,i,s)},50)}function hS(t,s,n,a,i){let l=vz(t,s,n,a,t.state.selection.$from);if(t.someProp("handlePaste",d=>d(t,i,l||nt.empty)))return!0;if(!l)return!1;let o=xye(l),c=o?t.state.tr.replaceSelectionWith(o,a):t.state.tr.replaceSelection(l);return t.dispatch(c.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Ez(t){let s=t.getData("text/plain")||t.getData("Text");if(s)return s;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}ei.paste=(t,s)=>{let n=s;if(t.composing&&!Px)return;let a=qp?null:n.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;a&&hS(t,Ez(a),a.getData("text/html"),i,n)?n.preventDefault():gye(t,n)};class yye{constructor(s,n,a){this.slice=s,this.move=n,this.node=a}}const bye=yi?"altKey":"ctrlKey";function Tz(t,s){let n=t.someProp("dragCopies",a=>!a(s));return n??!s[bye]}cl.dragstart=(t,s)=>{let n=s,a=t.input.mouseDown;if(a&&a.done(),!n.dataTransfer)return;let i=t.state.selection,l=i.empty?null:t.posAtCoords(av(n)),o;if(!(l&&l.pos>=i.from&&l.pos<=(i instanceof Ct?i.to-1:i.to))){if(a&&a.mightDrag)o=Ct.create(t.state.doc,a.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let m=t.docView.nearestDesc(n.target,!0);m&&m.node.type.spec.draggable&&m!=t.docView&&(o=Ct.create(t.state.doc,m.posBefore))}}let c=(o||t.state.selection).content(),{dom:d,text:u,slice:f}=bz(t,c);(!n.dataTransfer.files.length||!ld||pz>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(qp?"Text":"text/html",d.innerHTML),n.dataTransfer.effectAllowed="copyMove",qp||n.dataTransfer.setData("text/plain",u),t.dragging=new yye(f,Tz(t,n),o)};cl.dragend=t=>{let s=t.dragging;window.setTimeout(()=>{t.dragging==s&&(t.dragging=null)},50)};ei.dragover=ei.dragenter=(t,s)=>s.preventDefault();ei.drop=(t,s)=>{let n=s,a=t.dragging;if(t.dragging=null,!n.dataTransfer)return;let i=t.posAtCoords(av(n));if(!i)return;let l=t.state.doc.resolve(i.pos),o=a&&a.slice;o?t.someProp("transformPasted",w=>{o=w(o,t,!1)}):o=vz(t,Ez(n.dataTransfer),qp?null:n.dataTransfer.getData("text/html"),!1,l);let c=!!(a&&Tz(t,n));if(t.someProp("handleDrop",w=>w(t,n,o||nt.empty,c))){n.preventDefault();return}if(!o)return;n.preventDefault();let d=o?L$(t.state.doc,l.pos,o):l.pos;d==null&&(d=l.pos);let u=t.state.tr;if(c){let{node:w}=a;w?w.replace(u):u.deleteSelection()}let f=u.mapping.map(d),m=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,x=u.doc;if(m?u.replaceRangeWith(f,f,o.content.firstChild):u.replaceRange(f,f,o),u.doc.eq(x))return;let b=u.doc.resolve(f);if(m&&Ct.isSelectable(o.content.firstChild)&&b.nodeAfter&&b.nodeAfter.sameMarkup(o.content.firstChild))u.setSelection(new Ct(b));else{let w=u.mapping.map(d);u.mapping.maps[u.mapping.maps.length-1].forEach((j,_,C,k)=>w=k),u.setSelection(gz(t,b,u.doc.resolve(w)))}t.focus(),t.dispatch(u.setMeta("uiEvent","drop"))};cl.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Uk(t)},20))};cl.blur=(t,s)=>{let n=s;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};cl.beforeinput=(t,s)=>{if(ld&&Px&&s.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:a}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=a||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",l=>l(t,hz(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in ei)cl[t]=ei[t];function Gp(t,s){if(t==s)return!0;for(let n in t)if(t[n]!==s[n])return!1;for(let n in s)if(!(n in t))return!1;return!0}class n1{constructor(s,n){this.toDOM=s,this.spec=n||Jd,this.side=this.spec.side||0}map(s,n,a,i){let{pos:l,deleted:o}=s.mapResult(n.from+i,this.side<0?-1:1);return o?null:new Ga(l-a,l-a,this)}valid(){return!0}eq(s){return this==s||s instanceof n1&&(this.spec.key&&this.spec.key==s.spec.key||this.toDOM==s.toDOM&&Gp(this.spec,s.spec))}destroy(s){this.spec.destroy&&this.spec.destroy(s)}}class Dc{constructor(s,n){this.attrs=s,this.spec=n||Jd}map(s,n,a,i){let l=s.map(n.from+i,this.spec.inclusiveStart?-1:1)-a,o=s.map(n.to+i,this.spec.inclusiveEnd?1:-1)-a;return l>=o?null:new Ga(l,o,this)}valid(s,n){return n.from<n.to}eq(s){return this==s||s instanceof Dc&&Gp(this.attrs,s.attrs)&&Gp(this.spec,s.spec)}static is(s){return s.type instanceof Dc}destroy(){}}class Wk{constructor(s,n){this.attrs=s,this.spec=n||Jd}map(s,n,a,i){let l=s.mapResult(n.from+i,1);if(l.deleted)return null;let o=s.mapResult(n.to+i,-1);return o.deleted||o.pos<=l.pos?null:new Ga(l.pos-a,o.pos-a,this)}valid(s,n){let{index:a,offset:i}=s.content.findIndex(n.from),l;return i==n.from&&!(l=s.child(a)).isText&&i+l.nodeSize==n.to}eq(s){return this==s||s instanceof Wk&&Gp(this.attrs,s.attrs)&&Gp(this.spec,s.spec)}destroy(){}}class Ga{constructor(s,n,a){this.from=s,this.to=n,this.type=a}copy(s,n){return new Ga(s,n,this.type)}eq(s,n=0){return this.type.eq(s.type)&&this.from+n==s.from&&this.to+n==s.to}map(s,n,a){return this.type.map(s,this,n,a)}static widget(s,n,a){return new Ga(s,s,new n1(n,a))}static inline(s,n,a,i){return new Ga(s,n,new Dc(a,i))}static node(s,n,a,i){return new Ga(s,n,new Wk(a,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Dc}get widget(){return this.type instanceof n1}}const rh=[],Jd={};class jn{constructor(s,n){this.local=s.length?s:rh,this.children=n.length?n:rh}static create(s,n){return n.length?r1(n,s,0,Jd):Qr}find(s,n,a){let i=[];return this.findInner(s??0,n??1e9,i,0,a),i}findInner(s,n,a,i,l){for(let o=0;o<this.local.length;o++){let c=this.local[o];c.from<=n&&c.to>=s&&(!l||l(c.spec))&&a.push(c.copy(c.from+i,c.to+i))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<n&&this.children[o+1]>s){let c=this.children[o]+1;this.children[o+2].findInner(s-c,n-c,a,i+c,l)}}map(s,n,a){return this==Qr||s.maps.length==0?this:this.mapInner(s,n,0,0,a||Jd)}mapInner(s,n,a,i,l){let o;for(let c=0;c<this.local.length;c++){let d=this.local[c].map(s,a,i);d&&d.type.valid(n,d)?(o||(o=[])).push(d):l.onRemove&&l.onRemove(this.local[c].spec)}return this.children.length?vye(this.children,o||[],s,n,a,i,l):o?new jn(o.sort(eu),rh):Qr}add(s,n){return n.length?this==Qr?jn.create(s,n):this.addInner(s,n,0):this}addInner(s,n,a){let i,l=0;s.forEach((c,d)=>{let u=d+a,f;if(f=Iz(n,c,u)){for(i||(i=this.children.slice());l<i.length&&i[l]<d;)l+=3;i[l]==d?i[l+2]=i[l+2].addInner(c,f,u+1):i.splice(l,0,d,d+c.nodeSize,r1(f,c,u+1,Jd)),l+=3}});let o=Pz(l?Mz(n):n,-a);for(let c=0;c<o.length;c++)o[c].type.valid(s,o[c])||o.splice(c--,1);return new jn(o.length?this.local.concat(o).sort(eu):this.local,i||this.children)}remove(s){return s.length==0||this==Qr?this:this.removeInner(s,0)}removeInner(s,n){let a=this.children,i=this.local;for(let l=0;l<a.length;l+=3){let o,c=a[l]+n,d=a[l+1]+n;for(let f=0,m;f<s.length;f++)(m=s[f])&&m.from>c&&m.to<d&&(s[f]=null,(o||(o=[])).push(m));if(!o)continue;a==this.children&&(a=this.children.slice());let u=a[l+2].removeInner(o,c+1);u!=Qr?a[l+2]=u:(a.splice(l,3),l-=3)}if(i.length){for(let l=0,o;l<s.length;l++)if(o=s[l])for(let c=0;c<i.length;c++)i[c].eq(o,n)&&(i==this.local&&(i=this.local.slice()),i.splice(c--,1))}return a==this.children&&i==this.local?this:i.length||a.length?new jn(i,a):Qr}forChild(s,n){if(this==Qr)return this;if(n.isLeaf)return jn.empty;let a,i;for(let c=0;c<this.children.length;c+=3)if(this.children[c]>=s){this.children[c]==s&&(a=this.children[c+2]);break}let l=s+1,o=l+n.content.size;for(let c=0;c<this.local.length;c++){let d=this.local[c];if(d.from<o&&d.to>l&&d.type instanceof Dc){let u=Math.max(l,d.from)-l,f=Math.min(o,d.to)-l;u<f&&(i||(i=[])).push(d.copy(u,f))}}if(i){let c=new jn(i.sort(eu),rh);return a?new Ad([c,a]):c}return a||Qr}eq(s){if(this==s)return!0;if(!(s instanceof jn)||this.local.length!=s.local.length||this.children.length!=s.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(s.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=s.children[n]||this.children[n+1]!=s.children[n+1]||!this.children[n+2].eq(s.children[n+2]))return!1;return!0}locals(s){return qk(this.localsInner(s))}localsInner(s){if(this==Qr)return rh;if(s.inlineContent||!this.local.some(Dc.is))return this.local;let n=[];for(let a=0;a<this.local.length;a++)this.local[a].type instanceof Dc||n.push(this.local[a]);return n}forEachSet(s){s(this)}}jn.empty=new jn([],[]);jn.removeOverlap=qk;const Qr=jn.empty;class Ad{constructor(s){this.members=s}map(s,n){const a=this.members.map(i=>i.map(s,n,Jd));return Ad.from(a)}forChild(s,n){if(n.isLeaf)return jn.empty;let a=[];for(let i=0;i<this.members.length;i++){let l=this.members[i].forChild(s,n);l!=Qr&&(l instanceof Ad?a=a.concat(l.members):a.push(l))}return Ad.from(a)}eq(s){if(!(s instanceof Ad)||s.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(s.members[n]))return!1;return!0}locals(s){let n,a=!0;for(let i=0;i<this.members.length;i++){let l=this.members[i].localsInner(s);if(l.length)if(!n)n=l;else{a&&(n=n.slice(),a=!1);for(let o=0;o<l.length;o++)n.push(l[o])}}return n?qk(a?n:n.sort(eu)):rh}static from(s){switch(s.length){case 0:return Qr;case 1:return s[0];default:return new Ad(s.every(n=>n instanceof jn)?s:s.reduce((n,a)=>n.concat(a instanceof jn?a:a.members),[]))}}forEachSet(s){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(s)}}function vye(t,s,n,a,i,l,o){let c=t.slice();for(let u=0,f=l;u<n.maps.length;u++){let m=0;n.maps[u].forEach((x,b,w,j)=>{let _=j-w-(b-x);for(let C=0;C<c.length;C+=3){let k=c[C+1];if(k<0||x>k+f-m)continue;let A=c[C]+f-m;b>=A?c[C+1]=x<=A?-2:-1:x>=f&&_&&(c[C]+=_,c[C+1]+=_)}m+=_}),f=n.maps[u].map(f,-1)}let d=!1;for(let u=0;u<c.length;u+=3)if(c[u+1]<0){if(c[u+1]==-2){d=!0,c[u+1]=-1;continue}let f=n.map(t[u]+l),m=f-i;if(m<0||m>=a.content.size){d=!0;continue}let x=n.map(t[u+1]+l,-1),b=x-i,{index:w,offset:j}=a.content.findIndex(m),_=a.maybeChild(w);if(_&&j==m&&j+_.nodeSize==b){let C=c[u+2].mapInner(n,_,f+1,t[u]+l+1,o);C!=Qr?(c[u]=m,c[u+1]=b,c[u+2]=C):(c[u+1]=-2,d=!0)}else d=!0}if(d){let u=wye(c,t,s,n,i,l,o),f=r1(u,a,0,o);s=f.local;for(let m=0;m<c.length;m+=3)c[m+1]<0&&(c.splice(m,3),m-=3);for(let m=0,x=0;m<f.children.length;m+=3){let b=f.children[m];for(;x<c.length&&c[x]<b;)x+=3;c.splice(x,0,f.children[m],f.children[m+1],f.children[m+2])}}return new jn(s.sort(eu),c)}function Pz(t,s){if(!s||!t.length)return t;let n=[];for(let a=0;a<t.length;a++){let i=t[a];n.push(new Ga(i.from+s,i.to+s,i.type))}return n}function wye(t,s,n,a,i,l,o){function c(d,u){for(let f=0;f<d.local.length;f++){let m=d.local[f].map(a,i,u);m?n.push(m):o.onRemove&&o.onRemove(d.local[f].spec)}for(let f=0;f<d.children.length;f+=3)c(d.children[f+2],d.children[f]+u+1)}for(let d=0;d<t.length;d+=3)t[d+1]==-1&&c(t[d+2],s[d]+l+1);return n}function Iz(t,s,n){if(s.isLeaf)return null;let a=n+s.nodeSize,i=null;for(let l=0,o;l<t.length;l++)(o=t[l])&&o.from>n&&o.to<a&&((i||(i=[])).push(o),t[l]=null);return i}function Mz(t){let s=[];for(let n=0;n<t.length;n++)t[n]!=null&&s.push(t[n]);return s}function r1(t,s,n,a){let i=[],l=!1;s.forEach((c,d)=>{let u=Iz(t,c,d+n);if(u){l=!0;let f=r1(u,c,n+d+1,a);f!=Qr&&i.push(d,d+c.nodeSize,f)}});let o=Pz(l?Mz(t):t,-n).sort(eu);for(let c=0;c<o.length;c++)o[c].type.valid(s,o[c])||(a.onRemove&&a.onRemove(o[c].spec),o.splice(c--,1));return o.length||i.length?new jn(o,i):Qr}function eu(t,s){return t.from-s.from||t.to-s.to}function qk(t){let s=t;for(let n=0;n<s.length-1;n++){let a=s[n];if(a.from!=a.to)for(let i=n+1;i<s.length;i++){let l=s[i];if(l.from==a.from){l.to!=a.to&&(s==t&&(s=t.slice()),s[i]=l.copy(l.from,a.to),JI(s,i+1,l.copy(a.to,l.to)));continue}else{l.from<a.to&&(s==t&&(s=t.slice()),s[n]=a.copy(a.from,l.from),JI(s,i,a.copy(l.from,a.to)));break}}}return s}function JI(t,s,n){for(;s<t.length&&eu(n,t[s])>0;)s++;t.splice(s,0,n)}var Kc={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},a1={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Nye=typeof navigator<"u"&&/Mac/.test(navigator.platform),jye=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var kr=0;kr<10;kr++)Kc[48+kr]=Kc[96+kr]=String(kr);for(var kr=1;kr<=24;kr++)Kc[kr+111]="F"+kr;for(var kr=65;kr<=90;kr++)Kc[kr]=String.fromCharCode(kr+32),a1[kr]=String.fromCharCode(kr);for(var lj in Kc)a1.hasOwnProperty(lj)||(a1[lj]=Kc[lj]);function _ye(t){var s=Nye&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||jye&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!s&&t.key||(t.shiftKey?a1:Kc)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const Sye=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),Cye=typeof navigator<"u"&&/Win/.test(navigator.platform);function kye(t){let s=t.split(/-(?!$)/),n=s[s.length-1];n=="Space"&&(n=" ");let a,i,l,o;for(let c=0;c<s.length-1;c++){let d=s[c];if(/^(cmd|meta|m)$/i.test(d))o=!0;else if(/^a(lt)?$/i.test(d))a=!0;else if(/^(c|ctrl|control)$/i.test(d))i=!0;else if(/^s(hift)?$/i.test(d))l=!0;else if(/^mod$/i.test(d))Sye?o=!0:i=!0;else throw new Error("Unrecognized modifier name: "+d)}return a&&(n="Alt-"+n),i&&(n="Ctrl-"+n),o&&(n="Meta-"+n),l&&(n="Shift-"+n),n}function Aye(t){let s=Object.create(null);for(let n in t)s[kye(n)]=t[n];return s}function oj(t,s,n=!0){return s.altKey&&(t="Alt-"+t),s.ctrlKey&&(t="Ctrl-"+t),s.metaKey&&(t="Meta-"+t),n&&s.shiftKey&&(t="Shift-"+t),t}function Dz(t){let s=Aye(t);return function(n,a){let i=_ye(a),l,o=s[oj(i,a)];if(o&&o(n.state,n.dispatch,n))return!0;if(i.length==1&&i!=" "){if(a.shiftKey){let c=s[oj(i,a,!1)];if(c&&c(n.state,n.dispatch,n))return!0}if((a.altKey||a.metaKey||a.ctrlKey)&&!(Cye&&a.ctrlKey&&a.altKey)&&(l=Kc[a.keyCode])&&l!=i){let c=s[oj(l,a)];if(c&&c(n.state,n.dispatch,n))return!0}}return!1}}var Eye=Object.defineProperty,Gk=(t,s)=>{for(var n in s)Eye(t,n,{get:s[n],enumerable:!0})};function Oz(t){const{state:s,transaction:n}=t;let{selection:a}=n,{doc:i}=n,{storedMarks:l}=n;return{...s,apply:s.apply.bind(s),applyTransaction:s.applyTransaction.bind(s),plugins:s.plugins,schema:s.schema,reconfigure:s.reconfigure.bind(s),toJSON:s.toJSON.bind(s),get storedMarks(){return l},get selection(){return a},get doc(){return i},get tr(){return a=n.selection,i=n.doc,l=n.storedMarks,n}}}var Tye=class{constructor(s){this.editor=s.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=s.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:s,editor:n,state:a}=this,{view:i}=n,{tr:l}=a,o=this.buildProps(l);return Object.fromEntries(Object.entries(s).map(([c,d])=>[c,(...f)=>{const m=d(...f)(o);return!l.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(l),m}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(s,n=!0){const{rawCommands:a,editor:i,state:l}=this,{view:o}=i,c=[],d=!!s,u=s||l.tr,f=()=>(!d&&n&&!u.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(u),c.every(x=>x===!0)),m={...Object.fromEntries(Object.entries(a).map(([x,b])=>[x,(...j)=>{const _=this.buildProps(u,n),C=b(...j)(_);return c.push(C),m}])),run:f};return m}createCan(s){const{rawCommands:n,state:a}=this,i=!1,l=s||a.tr,o=this.buildProps(l,i);return{...Object.fromEntries(Object.entries(n).map(([d,u])=>[d,(...f)=>u(...f)({...o,dispatch:void 0})])),chain:()=>this.createChain(l,i)}}buildProps(s,n=!0){const{rawCommands:a,editor:i,state:l}=this,{view:o}=i,c={tr:s,editor:i,view:o,state:Oz({state:l,transaction:s}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(s,n),can:()=>this.createCan(s),get commands(){return Object.fromEntries(Object.entries(a).map(([d,u])=>[d,(...f)=>u(...f)(c)]))}};return c}},Rz={};Gk(Rz,{blur:()=>Pye,clearContent:()=>Iye,clearNodes:()=>Mye,command:()=>Dye,createParagraphNear:()=>Oye,cut:()=>Rye,deleteCurrentNode:()=>Lye,deleteNode:()=>Bye,deleteRange:()=>Fye,deleteSelection:()=>$ye,enter:()=>zye,exitCode:()=>Uye,extendMarkRange:()=>Hye,first:()=>Wye,focus:()=>Kye,forEach:()=>Yye,insertContent:()=>Xye,insertContentAt:()=>Jye,joinBackward:()=>s1e,joinDown:()=>t1e,joinForward:()=>n1e,joinItemBackward:()=>r1e,joinItemForward:()=>a1e,joinTextblockBackward:()=>i1e,joinTextblockForward:()=>l1e,joinUp:()=>e1e,keyboardShortcut:()=>c1e,lift:()=>d1e,liftEmptyBlock:()=>u1e,liftListItem:()=>h1e,newlineInCode:()=>f1e,resetAttributes:()=>m1e,scrollIntoView:()=>p1e,selectAll:()=>x1e,selectNodeBackward:()=>g1e,selectNodeForward:()=>y1e,selectParentNode:()=>b1e,selectTextblockEnd:()=>v1e,selectTextblockStart:()=>w1e,setContent:()=>j1e,setMark:()=>O1e,setMeta:()=>R1e,setNode:()=>L1e,setNodeSelection:()=>B1e,setTextDirection:()=>F1e,setTextSelection:()=>$1e,sinkListItem:()=>z1e,splitBlock:()=>U1e,splitListItem:()=>V1e,toggleList:()=>H1e,toggleMark:()=>W1e,toggleNode:()=>q1e,toggleWrap:()=>G1e,undoInputRule:()=>K1e,unsetAllMarks:()=>Y1e,unsetMark:()=>X1e,unsetTextDirection:()=>Q1e,updateAttributes:()=>Z1e,wrapIn:()=>J1e,wrapInList:()=>ebe});var Pye=()=>({editor:t,view:s})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(s.dom.blur(),(n=window==null?void 0:window.getSelection())==null||n.removeAllRanges())}),!0),Iye=(t=!0)=>({commands:s})=>s.setContent("",{emitUpdate:t}),Mye=()=>({state:t,tr:s,dispatch:n})=>{const{selection:a}=s,{ranges:i}=a;return n&&i.forEach(({$from:l,$to:o})=>{t.doc.nodesBetween(l.pos,o.pos,(c,d)=>{if(c.type.isText)return;const{doc:u,mapping:f}=s,m=u.resolve(f.map(d)),x=u.resolve(f.map(d+c.nodeSize)),b=m.blockRange(x);if(!b)return;const w=Du(b);if(c.type.isTextblock){const{defaultType:j}=m.parent.contentMatchAt(m.index());s.setNodeMarkup(b.start,j)}(w||w===0)&&s.lift(b,w)})}),!0},Dye=t=>s=>t(s),Oye=()=>({state:t,dispatch:s})=>Rk(t,s),Rye=(t,s)=>({editor:n,tr:a})=>{const{state:i}=n,l=i.doc.slice(t.from,t.to);a.deleteRange(t.from,t.to);const o=a.mapping.map(s);return a.insert(o,l.content),a.setSelection(new vt(a.doc.resolve(Math.max(o-1,0)))),!0},Lye=()=>({tr:t,dispatch:s})=>{const{selection:n}=t,a=n.$anchor.node();if(a.content.size>0)return!1;const i=t.selection.$anchor;for(let l=i.depth;l>0;l-=1)if(i.node(l).type===a.type){if(s){const c=i.before(l),d=i.after(l);t.delete(c,d).scrollIntoView()}return!0}return!1};function Gr(t,s){if(typeof t=="string"){if(!s.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return s.nodes[t]}return t}var Bye=t=>({tr:s,state:n,dispatch:a})=>{const i=Gr(t,n.schema),l=s.selection.$anchor;for(let o=l.depth;o>0;o-=1)if(l.node(o).type===i){if(a){const d=l.before(o),u=l.after(o);s.delete(d,u).scrollIntoView()}return!0}return!1},Fye=t=>({tr:s,dispatch:n})=>{const{from:a,to:i}=t;return n&&s.delete(a,i),!0},$ye=()=>({state:t,dispatch:s})=>nv(t,s),zye=()=>({commands:t})=>t.keyboardShortcut("Enter"),Uye=()=>({state:t,dispatch:s})=>ez(t,s);function Vye(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function i1(t,s,n={strict:!0}){const a=Object.keys(s);return a.length?a.every(i=>n.strict?s[i]===t[i]:Vye(s[i])?s[i].test(t[i]):s[i]===t[i]):!0}function Lz(t,s,n={}){return t.find(a=>a.type===s&&i1(Object.fromEntries(Object.keys(n).map(i=>[i,a.attrs[i]])),n))}function eM(t,s,n={}){return!!Lz(t,s,n)}function Kk(t,s,n){var a;if(!t||!s)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(f=>f.type===s))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(f=>f.type===s)||(n=n||((a=i.node.marks[0])==null?void 0:a.attrs),!Lz([...i.node.marks],s,n)))return;let o=i.index,c=t.start()+i.offset,d=o+1,u=c+i.node.nodeSize;for(;o>0&&eM([...t.parent.child(o-1).marks],s,n);)o-=1,c-=t.parent.child(o).nodeSize;for(;d<t.parent.childCount&&eM([...t.parent.child(d).marks],s,n);)u+=t.parent.child(d).nodeSize,d+=1;return{from:c,to:u}}function od(t,s){if(typeof t=="string"){if(!s.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return s.marks[t]}return t}var Hye=(t,s={})=>({tr:n,state:a,dispatch:i})=>{const l=od(t,a.schema),{doc:o,selection:c}=n,{$from:d,from:u,to:f}=c;if(i){const m=Kk(d,l,s);if(m&&m.from<=u&&m.to>=f){const x=vt.create(o,m.from,m.to);n.setSelection(x)}}return!0},Wye=t=>s=>{const n=typeof t=="function"?t(s):t;for(let a=0;a<n.length;a+=1)if(n[a](s))return!0;return!1};function Bz(t){return t instanceof vt}function $d(t=0,s=0,n=0){return Math.min(Math.max(t,s),n)}function qye(t,s=null){if(!s)return null;const n=Tt.atStart(t),a=Tt.atEnd(t);if(s==="start"||s===!0)return n;if(s==="end")return a;const i=n.from,l=a.to;return s==="all"?vt.create(t,$d(0,i,l),$d(t.content.size,i,l)):vt.create(t,$d(s,i,l),$d(s,i,l))}function Gye(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function Yk(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var Kye=(t=null,s={})=>({editor:n,view:a,tr:i,dispatch:l})=>{s={scrollIntoView:!0,...s};const o=()=>{(Yk()||Gye())&&a.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(a.focus(),s!=null&&s.scrollIntoView&&n.commands.scrollIntoView())})};if(a.hasFocus()&&t===null||t===!1)return!0;if(l&&t===null&&!Bz(n.state.selection))return o(),!0;const c=qye(i.doc,t)||n.state.selection,d=n.state.selection.eq(c);return l&&(d||i.setSelection(c),d&&i.storedMarks&&i.setStoredMarks(i.storedMarks),o()),!0},Yye=(t,s)=>n=>t.every((a,i)=>s(a,{...n,index:i})),Xye=(t,s)=>({tr:n,commands:a})=>a.insertContentAt({from:n.selection.from,to:n.selection.to},t,s),Fz=t=>{const s=t.childNodes;for(let n=s.length-1;n>=0;n-=1){const a=s[n];a.nodeType===3&&a.nodeValue&&/^(\n\s\s|\n)$/.test(a.nodeValue)?t.removeChild(a):a.nodeType===1&&Fz(a)}return t};function V0(t){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const s=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(s,"text/html").body;return Fz(n)}function Kp(t,s,n){if(t instanceof Mc||t instanceof Fe)return t;n={slice:!0,parseOptions:{},...n};const a=typeof t=="object"&&t!==null,i=typeof t=="string";if(a)try{if(Array.isArray(t)&&t.length>0)return Fe.fromArray(t.map(c=>s.nodeFromJSON(c)));const o=s.nodeFromJSON(t);return n.errorOnInvalidContent&&o.check(),o}catch(l){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:l});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",l),Kp("",s,n)}if(i){if(n.errorOnInvalidContent){let o=!1,c="";const d=new C$({topNode:s.spec.topNode,marks:s.spec.marks,nodes:s.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(o=!0,c=typeof u=="string"?u:u.outerHTML,null)}]}})});if(n.slice?zl.fromSchema(d).parseSlice(V0(t),n.parseOptions):zl.fromSchema(d).parse(V0(t),n.parseOptions),n.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${c}`)})}const l=zl.fromSchema(s);return n.slice?l.parseSlice(V0(t),n.parseOptions).content:l.parse(V0(t),n.parseOptions)}return Kp("",s,n)}function Qye(t,s,n){const a=t.steps.length-1;if(a<s)return;const i=t.steps[a];if(!(i instanceof qn||i instanceof er))return;const l=t.mapping.maps[a];let o=0;l.forEach((c,d,u,f)=>{o===0&&(o=f)}),t.setSelection(Tt.near(t.doc.resolve(o),n))}var Zye=t=>!("type"in t),Jye=(t,s,n)=>({tr:a,dispatch:i,editor:l})=>{var o;if(i){n={parseOptions:l.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let c;const d=_=>{l.emit("contentError",{editor:l,error:_,disableCollaboration:()=>{"collaboration"in l.storage&&typeof l.storage.collaboration=="object"&&l.storage.collaboration&&(l.storage.collaboration.isDisabled=!0)}})},u={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!l.options.enableContentCheck&&l.options.emitContentError)try{Kp(s,l.schema,{parseOptions:u,errorOnInvalidContent:!0})}catch(_){d(_)}try{c=Kp(s,l.schema,{parseOptions:u,errorOnInvalidContent:(o=n.errorOnInvalidContent)!=null?o:l.options.enableContentCheck})}catch(_){return d(_),!1}let{from:f,to:m}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},x=!0,b=!0;if((Zye(c)?c:[c]).forEach(_=>{_.check(),x=x?_.isText&&_.marks.length===0:!1,b=b?_.isBlock:!1}),f===m&&b){const{parent:_}=a.doc.resolve(f);_.isTextblock&&!_.type.spec.code&&!_.childCount&&(f-=1,m+=1)}let j;if(x){if(Array.isArray(s))j=s.map(_=>_.text||"").join("");else if(s instanceof Fe){let _="";s.forEach(C=>{C.text&&(_+=C.text)}),j=_}else typeof s=="object"&&s&&s.text?j=s.text:j=s;a.insertText(j,f,m)}else{j=c;const _=a.doc.resolve(f),C=_.node(),k=_.parentOffset===0,A=C.isText||C.isTextblock,T=C.content.size>0;k&&A&&T&&(f=Math.max(0,f-1)),a.replaceWith(f,m,j)}n.updateSelection&&Qye(a,a.steps.length-1,-1),n.applyInputRules&&a.setMeta("applyInputRules",{from:f,text:j}),n.applyPasteRules&&a.setMeta("applyPasteRules",{from:f,text:j})}return!0},e1e=()=>({state:t,dispatch:s})=>Q$(t,s),t1e=()=>({state:t,dispatch:s})=>Z$(t,s),s1e=()=>({state:t,dispatch:s})=>Ak(t,s),n1e=()=>({state:t,dispatch:s})=>Pk(t,s),r1e=()=>({state:t,dispatch:s,tr:n})=>{try{const a=Rf(t.doc,t.selection.$from.pos,-1);return a==null?!1:(n.join(a,2),s&&s(n),!0)}catch{return!1}},a1e=()=>({state:t,dispatch:s,tr:n})=>{try{const a=Rf(t.doc,t.selection.$from.pos,1);return a==null?!1:(n.join(a,2),s&&s(n),!0)}catch{return!1}},i1e=()=>({state:t,dispatch:s})=>G$(t,s),l1e=()=>({state:t,dispatch:s})=>K$(t,s);function $z(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function o1e(t){const s=t.split(/-(?!$)/);let n=s[s.length-1];n==="Space"&&(n=" ");let a,i,l,o;for(let c=0;c<s.length-1;c+=1){const d=s[c];if(/^(cmd|meta|m)$/i.test(d))o=!0;else if(/^a(lt)?$/i.test(d))a=!0;else if(/^(c|ctrl|control)$/i.test(d))i=!0;else if(/^s(hift)?$/i.test(d))l=!0;else if(/^mod$/i.test(d))Yk()||$z()?o=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${d}`)}return a&&(n=`Alt-${n}`),i&&(n=`Ctrl-${n}`),o&&(n=`Meta-${n}`),l&&(n=`Shift-${n}`),n}var c1e=t=>({editor:s,view:n,tr:a,dispatch:i})=>{const l=o1e(t).split(/-(?!$)/),o=l.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),c=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:l.includes("Alt"),ctrlKey:l.includes("Ctrl"),metaKey:l.includes("Meta"),shiftKey:l.includes("Shift"),bubbles:!0,cancelable:!0}),d=s.captureTransaction(()=>{n.someProp("handleKeyDown",u=>u(n,c))});return d==null||d.steps.forEach(u=>{const f=u.map(a.mapping);f&&i&&a.maybeStep(f)}),!0};function Xk(t,s,n={}){const{from:a,to:i,empty:l}=t.selection,o=s?Gr(s,t.schema):null,c=[];t.doc.nodesBetween(a,i,(m,x)=>{if(m.isText)return;const b=Math.max(a,x),w=Math.min(i,x+m.nodeSize);c.push({node:m,from:b,to:w})});const d=i-a,u=c.filter(m=>o?o.name===m.node.type.name:!0).filter(m=>i1(m.node.attrs,n,{strict:!1}));return l?!!u.length:u.reduce((m,x)=>m+x.to-x.from,0)>=d}var d1e=(t,s={})=>({state:n,dispatch:a})=>{const i=Gr(t,n.schema);return Xk(n,i,s)?J$(n,a):!1},u1e=()=>({state:t,dispatch:s})=>Lk(t,s),h1e=t=>({state:s,dispatch:n})=>{const a=Gr(t,s.schema);return oz(a)(s,n)},f1e=()=>({state:t,dispatch:s})=>Dk(t,s);function zz(t,s){return s.nodes[t]?"node":s.marks[t]?"mark":null}function tM(t,s){const n=typeof s=="string"?[s]:s;return Object.keys(t).reduce((a,i)=>(n.includes(i)||(a[i]=t[i]),a),{})}var m1e=(t,s)=>({tr:n,state:a,dispatch:i})=>{let l=null,o=null;const c=zz(typeof t=="string"?t:t.name,a.schema);if(!c)return!1;c==="node"&&(l=Gr(t,a.schema)),c==="mark"&&(o=od(t,a.schema));let d=!1;return n.selection.ranges.forEach(u=>{a.doc.nodesBetween(u.$from.pos,u.$to.pos,(f,m)=>{l&&l===f.type&&(d=!0,i&&n.setNodeMarkup(m,void 0,tM(f.attrs,s))),o&&f.marks.length&&f.marks.forEach(x=>{o===x.type&&(d=!0,i&&n.addMark(m,m+f.nodeSize,o.create(tM(x.attrs,s))))})})}),d},p1e=()=>({tr:t,dispatch:s})=>(s&&t.scrollIntoView(),!0),x1e=()=>({tr:t,dispatch:s})=>{if(s){const n=new ka(t.doc);t.setSelection(n)}return!0},g1e=()=>({state:t,dispatch:s})=>Ek(t,s),y1e=()=>({state:t,dispatch:s})=>Ik(t,s),b1e=()=>({state:t,dispatch:s})=>tz(t,s),v1e=()=>({state:t,dispatch:s})=>az(t,s),w1e=()=>({state:t,dispatch:s})=>rz(t,s);function N1e(t,s,n={},a={}){return Kp(t,s,{slice:!1,parseOptions:n,errorOnInvalidContent:a.errorOnInvalidContent})}var j1e=(t,{errorOnInvalidContent:s,emitUpdate:n=!0,parseOptions:a={}}={})=>({editor:i,tr:l,dispatch:o,commands:c})=>{const{doc:d}=l;if(a.preserveWhitespace!=="full"){const u=N1e(t,i.schema,a,{errorOnInvalidContent:s??i.options.enableContentCheck});return o&&l.replaceWith(0,d.content.size,u).setMeta("preventUpdate",!n),!0}return o&&l.setMeta("preventUpdate",!n),c.insertContentAt({from:0,to:d.content.size},t,{parseOptions:a,errorOnInvalidContent:s??i.options.enableContentCheck})};function _1e(t,s){const n=od(s,t.schema),{from:a,to:i,empty:l}=t.selection,o=[];l?(t.storedMarks&&o.push(...t.storedMarks),o.push(...t.selection.$head.marks())):t.doc.nodesBetween(a,i,d=>{o.push(...d.marks)});const c=o.find(d=>d.type.name===n.name);return c?{...c.attrs}:{}}function S1e(t,s){const n=new U$(t);return s.forEach(a=>{a.steps.forEach(i=>{n.step(i)})}),n}function C1e(t){for(let s=0;s<t.edgeCount;s+=1){const{type:n}=t.edge(s);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function Uz(t,s){for(let n=t.depth;n>0;n-=1){const a=t.node(n);if(s(a))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:a}}}function Qk(t){return s=>Uz(s.$from,t)}function af(t,s,n){return t.config[s]===void 0&&t.parent?af(t.parent,s,n):typeof t.config[s]=="function"?t.config[s].bind({...n,parent:t.parent?af(t.parent,s,n):null}):t.config[s]}function k1e(t){return typeof t=="function"}function yu(t,s=void 0,...n){return k1e(t)?s?t.bind(s)(...n):t(...n):t}function Vz(t){const s=t.filter(i=>i.type==="extension"),n=t.filter(i=>i.type==="node"),a=t.filter(i=>i.type==="mark");return{baseExtensions:s,nodeExtensions:n,markExtensions:a}}function cd(...t){return t.filter(s=>!!s).reduce((s,n)=>{const a={...s};return Object.entries(n).forEach(([i,l])=>{if(!a[i]){a[i]=l;return}if(i==="class"){const c=l?String(l).split(" "):[],d=a[i]?a[i].split(" "):[],u=c.filter(f=>!d.includes(f));a[i]=[...d,...u].join(" ")}else if(i==="style"){const c=l?l.split(";").map(f=>f.trim()).filter(Boolean):[],d=a[i]?a[i].split(";").map(f=>f.trim()).filter(Boolean):[],u=new Map;d.forEach(f=>{const[m,x]=f.split(":").map(b=>b.trim());u.set(m,x)}),c.forEach(f=>{const[m,x]=f.split(":").map(b=>b.trim());u.set(m,x)}),a[i]=Array.from(u.entries()).map(([f,m])=>`${f}: ${m}`).join("; ")}else a[i]=l}),a},{})}function A1e(t,s,n){const{from:a,to:i}=s,{blockSeparator:l=`

`,textSerializers:o={}}=n||{};let c="";return t.nodesBetween(a,i,(d,u,f,m)=>{var x;d.isBlock&&u>a&&(c+=l);const b=o==null?void 0:o[d.type.name];if(b)return f&&(c+=b({node:d,pos:u,parent:f,index:m,range:s})),!1;d.isText&&(c+=(x=d==null?void 0:d.text)==null?void 0:x.slice(Math.max(a,u)-u,i-u))}),c}function E1e(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,s])=>s.spec.toText).map(([s,n])=>[s,n.spec.toText]))}function T1e(t,s=JSON.stringify){const n={};return t.filter(a=>{const i=s(a);return Object.prototype.hasOwnProperty.call(n,i)?!1:n[i]=!0})}function P1e(t){const s=T1e(t);return s.length===1?s:s.filter((n,a)=>!s.filter((l,o)=>o!==a).some(l=>n.oldRange.from>=l.oldRange.from&&n.oldRange.to<=l.oldRange.to&&n.newRange.from>=l.newRange.from&&n.newRange.to<=l.newRange.to))}function I1e(t){const{mapping:s,steps:n}=t,a=[];return s.maps.forEach((i,l)=>{const o=[];if(i.ranges.length)i.forEach((c,d)=>{o.push({from:c,to:d})});else{const{from:c,to:d}=n[l];if(c===void 0||d===void 0)return;o.push({from:c,to:d})}o.forEach(({from:c,to:d})=>{const u=s.slice(l).map(c,-1),f=s.slice(l).map(d),m=s.invert().map(u,-1),x=s.invert().map(f);a.push({oldRange:{from:m,to:x},newRange:{from:u,to:f}})})}),P1e(a)}function Hz(t,s,n){const a=[];return t===s?n.resolve(t).marks().forEach(i=>{const l=n.resolve(t),o=Kk(l,i.type);o&&a.push({mark:i,...o})}):n.nodesBetween(t,s,(i,l)=>{!i||(i==null?void 0:i.nodeSize)===void 0||a.push(...i.marks.map(o=>({from:l,to:l+i.nodeSize,mark:o})))}),a}function Wg(t,s,n){return Object.fromEntries(Object.entries(n).filter(([a])=>{const i=t.find(l=>l.type===s&&l.name===a);return i?i.attribute.keepOnSplit:!1}))}function M1e(t,s,n={}){const{empty:a,ranges:i}=t.selection,l=s?od(s,t.schema):null;if(a)return!!(t.storedMarks||t.selection.$from.marks()).filter(m=>l?l.name===m.type.name:!0).find(m=>i1(m.attrs,n,{strict:!1}));let o=0;const c=[];if(i.forEach(({$from:m,$to:x})=>{const b=m.pos,w=x.pos;t.doc.nodesBetween(b,w,(j,_)=>{if(!j.isText&&!j.marks.length)return;const C=Math.max(b,_),k=Math.min(w,_+j.nodeSize),A=k-C;o+=A,c.push(...j.marks.map(T=>({mark:T,from:C,to:k})))})}),o===0)return!1;const d=c.filter(m=>l?l.name===m.mark.type.name:!0).filter(m=>i1(m.mark.attrs,n,{strict:!1})).reduce((m,x)=>m+x.to-x.from,0),u=c.filter(m=>l?m.mark.type!==l&&m.mark.type.excludes(l):!0).reduce((m,x)=>m+x.to-x.from,0);return(d>0?d+u:d)>=o}function sM(t,s){const{nodeExtensions:n}=Vz(s),a=n.find(o=>o.name===t);if(!a)return!1;const i={name:a.name,options:a.options,storage:a.storage},l=yu(af(a,"group",i));return typeof l!="string"?!1:l.split(" ").includes("list")}function Wz(t,{checkChildren:s=!0,ignoreWhitespace:n=!1}={}){var a;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((a=t.text)!=null?a:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(s){let i=!0;return t.content.forEach(l=>{i!==!1&&(Wz(l,{ignoreWhitespace:n,checkChildren:s})||(i=!1))}),i}return!1}function D1e(t,s,n){var a;const{selection:i}=s;let l=null;if(Bz(i)&&(l=i.$cursor),l){const c=(a=t.storedMarks)!=null?a:l.marks();return l.parent.type.allowsMarkType(n)&&(!!n.isInSet(c)||!c.some(u=>u.type.excludes(n)))}const{ranges:o}=i;return o.some(({$from:c,$to:d})=>{let u=c.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(c.pos,d.pos,(f,m,x)=>{if(u)return!1;if(f.isInline){const b=!x||x.type.allowsMarkType(n),w=!!n.isInSet(f.marks)||!f.marks.some(j=>j.type.excludes(n));u=b&&w}return!u}),u})}var O1e=(t,s={})=>({tr:n,state:a,dispatch:i})=>{const{selection:l}=n,{empty:o,ranges:c}=l,d=od(t,a.schema);if(i)if(o){const u=_1e(a,d);n.addStoredMark(d.create({...u,...s}))}else c.forEach(u=>{const f=u.$from.pos,m=u.$to.pos;a.doc.nodesBetween(f,m,(x,b)=>{const w=Math.max(b,f),j=Math.min(b+x.nodeSize,m);x.marks.find(C=>C.type===d)?x.marks.forEach(C=>{d===C.type&&n.addMark(w,j,d.create({...C.attrs,...s}))}):n.addMark(w,j,d.create(s))})});return D1e(a,n,d)},R1e=(t,s)=>({tr:n})=>(n.setMeta(t,s),!0),L1e=(t,s={})=>({state:n,dispatch:a,chain:i})=>{const l=Gr(t,n.schema);let o;return n.selection.$anchor.sameParent(n.selection.$head)&&(o=n.selection.$anchor.parent.attrs),l.isTextblock?i().command(({commands:c})=>Jy(l,{...o,...s})(n)?!0:c.clearNodes()).command(({state:c})=>Jy(l,{...o,...s})(c,a)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},B1e=t=>({tr:s,dispatch:n})=>{if(n){const{doc:a}=s,i=$d(t,0,a.content.size),l=Ct.create(a,i);s.setSelection(l)}return!0},F1e=(t,s)=>({tr:n,state:a,dispatch:i})=>{const{selection:l}=a;let o,c;return typeof s=="number"?(o=s,c=s):s&&"from"in s&&"to"in s?(o=s.from,c=s.to):(o=l.from,c=l.to),i&&n.doc.nodesBetween(o,c,(d,u)=>{d.isText||n.setNodeMarkup(u,void 0,{...d.attrs,dir:t})}),!0},$1e=t=>({tr:s,dispatch:n})=>{if(n){const{doc:a}=s,{from:i,to:l}=typeof t=="number"?{from:t,to:t}:t,o=vt.atStart(a).from,c=vt.atEnd(a).to,d=$d(i,o,c),u=$d(l,o,c),f=vt.create(a,d,u);s.setSelection(f)}return!0},z1e=t=>({state:s,dispatch:n})=>{const a=Gr(t,s.schema);return cz(a)(s,n)};function nM(t,s){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const a=n.filter(i=>s==null?void 0:s.includes(i.type.name));t.tr.ensureMarks(a)}}var U1e=({keepMarks:t=!0}={})=>({tr:s,state:n,dispatch:a,editor:i})=>{const{selection:l,doc:o}=s,{$from:c,$to:d}=l,u=i.extensionManager.attributes,f=Wg(u,c.node().type.name,c.node().attrs);if(l instanceof Ct&&l.node.isBlock)return!c.parentOffset||!Xa(o,c.pos)?!1:(a&&(t&&nM(n,i.extensionManager.splittableMarks),s.split(c.pos).scrollIntoView()),!0);if(!c.parent.isBlock)return!1;const m=d.parentOffset===d.parent.content.size,x=c.depth===0?void 0:C1e(c.node(-1).contentMatchAt(c.indexAfter(-1)));let b=m&&x?[{type:x,attrs:f}]:void 0,w=Xa(s.doc,s.mapping.map(c.pos),1,b);if(!b&&!w&&Xa(s.doc,s.mapping.map(c.pos),1,x?[{type:x}]:void 0)&&(w=!0,b=x?[{type:x,attrs:f}]:void 0),a){if(w&&(l instanceof vt&&s.deleteSelection(),s.split(s.mapping.map(c.pos),1,b),x&&!m&&!c.parentOffset&&c.parent.type!==x)){const j=s.mapping.map(c.before()),_=s.doc.resolve(j);c.node(-1).canReplaceWith(_.index(),_.index()+1,x)&&s.setNodeMarkup(s.mapping.map(c.before()),x)}t&&nM(n,i.extensionManager.splittableMarks),s.scrollIntoView()}return w},V1e=(t,s={})=>({tr:n,state:a,dispatch:i,editor:l})=>{var o;const c=Gr(t,a.schema),{$from:d,$to:u}=a.selection,f=a.selection.node;if(f&&f.isBlock||d.depth<2||!d.sameParent(u))return!1;const m=d.node(-1);if(m.type!==c)return!1;const x=l.extensionManager.attributes;if(d.parent.content.size===0&&d.node(-1).childCount===d.indexAfter(-1)){if(d.depth===2||d.node(-3).type!==c||d.index(-2)!==d.node(-2).childCount-1)return!1;if(i){let C=Fe.empty;const k=d.index(-1)?1:d.index(-2)?2:3;for(let O=d.depth-k;O>=d.depth-3;O-=1)C=Fe.from(d.node(O).copy(C));const A=d.indexAfter(-1)<d.node(-2).childCount?1:d.indexAfter(-2)<d.node(-3).childCount?2:3,T={...Wg(x,d.node().type.name,d.node().attrs),...s},P=((o=c.contentMatch.defaultType)==null?void 0:o.createAndFill(T))||void 0;C=C.append(Fe.from(c.createAndFill(null,P)||void 0));const R=d.before(d.depth-(k-1));n.replace(R,d.after(-A),new nt(C,4-k,0));let I=-1;n.doc.nodesBetween(R,n.doc.content.size,(O,M)=>{if(I>-1)return!1;O.isTextblock&&O.content.size===0&&(I=M+1)}),I>-1&&n.setSelection(vt.near(n.doc.resolve(I))),n.scrollIntoView()}return!0}const b=u.pos===d.end()?m.contentMatchAt(0).defaultType:null,w={...Wg(x,m.type.name,m.attrs),...s},j={...Wg(x,d.node().type.name,d.node().attrs),...s};n.delete(d.pos,u.pos);const _=b?[{type:c,attrs:w},{type:b,attrs:j}]:[{type:c,attrs:w}];if(!Xa(n.doc,d.pos,2))return!1;if(i){const{selection:C,storedMarks:k}=a,{splittableMarks:A}=l.extensionManager,T=k||C.$to.parentOffset&&C.$from.marks();if(n.split(d.pos,2,_).scrollIntoView(),!T||!i)return!0;const P=T.filter(R=>A.includes(R.type.name));n.ensureMarks(P)}return!0},cj=(t,s)=>{const n=Qk(o=>o.type===s)(t.selection);if(!n)return!0;const a=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(a===void 0)return!0;const i=t.doc.nodeAt(a);return n.node.type===(i==null?void 0:i.type)&&Zl(t.doc,n.pos)&&t.join(n.pos),!0},dj=(t,s)=>{const n=Qk(o=>o.type===s)(t.selection);if(!n)return!0;const a=t.doc.resolve(n.start).after(n.depth);if(a===void 0)return!0;const i=t.doc.nodeAt(a);return n.node.type===(i==null?void 0:i.type)&&Zl(t.doc,a)&&t.join(a),!0},H1e=(t,s,n,a={})=>({editor:i,tr:l,state:o,dispatch:c,chain:d,commands:u,can:f})=>{const{extensions:m,splittableMarks:x}=i.extensionManager,b=Gr(t,o.schema),w=Gr(s,o.schema),{selection:j,storedMarks:_}=o,{$from:C,$to:k}=j,A=C.blockRange(k),T=_||j.$to.parentOffset&&j.$from.marks();if(!A)return!1;const P=Qk(R=>sM(R.type.name,m))(j);if(A.depth>=1&&P&&A.depth-P.depth<=1){if(P.node.type===b)return u.liftListItem(w);if(sM(P.node.type.name,m)&&b.validContent(P.node.content)&&c)return d().command(()=>(l.setNodeMarkup(P.pos,b),!0)).command(()=>cj(l,b)).command(()=>dj(l,b)).run()}return!n||!T||!c?d().command(()=>f().wrapInList(b,a)?!0:u.clearNodes()).wrapInList(b,a).command(()=>cj(l,b)).command(()=>dj(l,b)).run():d().command(()=>{const R=f().wrapInList(b,a),I=T.filter(O=>x.includes(O.type.name));return l.ensureMarks(I),R?!0:u.clearNodes()}).wrapInList(b,a).command(()=>cj(l,b)).command(()=>dj(l,b)).run()},W1e=(t,s={},n={})=>({state:a,commands:i})=>{const{extendEmptyMarkRange:l=!1}=n,o=od(t,a.schema);return M1e(a,o,s)?i.unsetMark(o,{extendEmptyMarkRange:l}):i.setMark(o,s)},q1e=(t,s,n={})=>({state:a,commands:i})=>{const l=Gr(t,a.schema),o=Gr(s,a.schema),c=Xk(a,l,n);let d;return a.selection.$anchor.sameParent(a.selection.$head)&&(d=a.selection.$anchor.parent.attrs),c?i.setNode(o,d):i.setNode(l,{...d,...n})},G1e=(t,s={})=>({state:n,commands:a})=>{const i=Gr(t,n.schema);return Xk(n,i,s)?a.lift(i):a.wrapIn(i,s)},K1e=()=>({state:t,dispatch:s})=>{const n=t.plugins;for(let a=0;a<n.length;a+=1){const i=n[a];let l;if(i.spec.isInputRules&&(l=i.getState(t))){if(s){const o=t.tr,c=l.transform;for(let d=c.steps.length-1;d>=0;d-=1)o.step(c.steps[d].invert(c.docs[d]));if(l.text){const d=o.doc.resolve(l.from).marks();o.replaceWith(l.from,l.to,t.schema.text(l.text,d))}else o.delete(l.from,l.to)}return!0}}return!1},Y1e=()=>({tr:t,dispatch:s})=>{const{selection:n}=t,{empty:a,ranges:i}=n;return a||s&&i.forEach(l=>{t.removeMark(l.$from.pos,l.$to.pos)}),!0},X1e=(t,s={})=>({tr:n,state:a,dispatch:i})=>{var l;const{extendEmptyMarkRange:o=!1}=s,{selection:c}=n,d=od(t,a.schema),{$from:u,empty:f,ranges:m}=c;if(!i)return!0;if(f&&o){let{from:x,to:b}=c;const w=(l=u.marks().find(_=>_.type===d))==null?void 0:l.attrs,j=Kk(u,d,w);j&&(x=j.from,b=j.to),n.removeMark(x,b,d)}else m.forEach(x=>{n.removeMark(x.$from.pos,x.$to.pos,d)});return n.removeStoredMark(d),!0},Q1e=t=>({tr:s,state:n,dispatch:a})=>{const{selection:i}=n;let l,o;return typeof t=="number"?(l=t,o=t):t&&"from"in t&&"to"in t?(l=t.from,o=t.to):(l=i.from,o=i.to),a&&s.doc.nodesBetween(l,o,(c,d)=>{if(c.isText)return;const u={...c.attrs};delete u.dir,s.setNodeMarkup(d,void 0,u)}),!0},Z1e=(t,s={})=>({tr:n,state:a,dispatch:i})=>{let l=null,o=null;const c=zz(typeof t=="string"?t:t.name,a.schema);if(!c)return!1;c==="node"&&(l=Gr(t,a.schema)),c==="mark"&&(o=od(t,a.schema));let d=!1;return n.selection.ranges.forEach(u=>{const f=u.$from.pos,m=u.$to.pos;let x,b,w,j;n.selection.empty?a.doc.nodesBetween(f,m,(_,C)=>{l&&l===_.type&&(d=!0,w=Math.max(C,f),j=Math.min(C+_.nodeSize,m),x=C,b=_)}):a.doc.nodesBetween(f,m,(_,C)=>{C<f&&l&&l===_.type&&(d=!0,w=Math.max(C,f),j=Math.min(C+_.nodeSize,m),x=C,b=_),C>=f&&C<=m&&(l&&l===_.type&&(d=!0,i&&n.setNodeMarkup(C,void 0,{..._.attrs,...s})),o&&_.marks.length&&_.marks.forEach(k=>{if(o===k.type&&(d=!0,i)){const A=Math.max(C,f),T=Math.min(C+_.nodeSize,m);n.addMark(A,T,o.create({...k.attrs,...s}))}}))}),b&&(x!==void 0&&i&&n.setNodeMarkup(x,void 0,{...b.attrs,...s}),o&&b.marks.length&&b.marks.forEach(_=>{o===_.type&&i&&n.addMark(w,j,o.create({..._.attrs,...s}))}))}),d},J1e=(t,s={})=>({state:n,dispatch:a})=>{const i=Gr(t,n.schema);return iz(i,s)(n,a)},ebe=(t,s={})=>({state:n,dispatch:a})=>{const i=Gr(t,n.schema);return lz(i,s)(n,a)},qz=class{constructor(s){var n;this.find=s.find,this.handler=s.handler,this.undoable=(n=s.undoable)!=null?n:!0}};function tbe(t){return Object.prototype.toString.call(t).slice(8,-1)}function H0(t){return tbe(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function Gz(t,s){const n={...t};return H0(t)&&H0(s)&&Object.keys(s).forEach(a=>{H0(s[a])&&H0(t[a])?n[a]=Gz(t[a],s[a]):n[a]=s[a]}),n}var Zk=class{constructor(t={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...t},this.name=this.config.name}get options(){return{...yu(af(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...yu(af(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(t={}){const s=this.extend({...this.config,addOptions:()=>Gz(this.options,t)});return s.name=this.name,s.parent=this.parent,s}extend(t={}){const s=new this.constructor({...this.config,...t});return s.parent=this,this.child=s,s.name="name"in t?t.name:s.parent.name,s}},Jk=class Kz extends Zk{constructor(){super(...arguments),this.type="mark"}static create(s={}){const n=typeof s=="function"?s():s;return new Kz(n)}static handleExit({editor:s,mark:n}){const{tr:a}=s.state,i=s.state.selection.$from;if(i.pos===i.end()){const o=i.marks();if(!!!o.find(u=>(u==null?void 0:u.type.name)===n.name))return!1;const d=o.find(u=>(u==null?void 0:u.type.name)===n.name);return d&&a.removeStoredMark(d),a.insertText(" ",i.pos),s.view.dispatch(a),!0}return!1}configure(s){return super.configure(s)}extend(s){const n=typeof s=="function"?s():s;return super.extend(n)}},sbe=class{constructor(s){this.find=s.find,this.handler=s.handler}},nbe={};Gk(nbe,{ClipboardTextSerializer:()=>rbe,Commands:()=>abe,Delete:()=>ibe,Drop:()=>lbe,Editable:()=>obe,FocusEvents:()=>cbe,Keymap:()=>dbe,Paste:()=>ube,Tabindex:()=>hbe,TextDirection:()=>fbe,focusEventsPluginKey:()=>Xz});var mr=class Yz extends Zk{constructor(){super(...arguments),this.type="extension"}static create(s={}){const n=typeof s=="function"?s():s;return new Yz(n)}configure(s){return super.configure(s)}extend(s){const n=typeof s=="function"?s():s;return super.extend(n)}},rbe=mr.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new kn({key:new An("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:s,schema:n}=t,{doc:a,selection:i}=s,{ranges:l}=i,o=Math.min(...l.map(f=>f.$from.pos)),c=Math.max(...l.map(f=>f.$to.pos)),d=E1e(n);return A1e(a,{from:o,to:c},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:d})}}})]}}),abe=mr.create({name:"commands",addCommands(){return{...Rz}}}),ibe=mr.create({name:"delete",onUpdate({transaction:t,appendedTransactions:s}){var n,a,i;const l=()=>{var o,c,d,u;if((u=(d=(c=(o=this.editor.options.coreExtensionOptions)==null?void 0:o.delete)==null?void 0:c.filterTransaction)==null?void 0:d.call(c,t))!=null?u:t.getMeta("y-sync$"))return;const f=S1e(t.before,[t,...s]);I1e(f).forEach(b=>{f.mapping.mapResult(b.oldRange.from).deletedAfter&&f.mapping.mapResult(b.oldRange.to).deletedBefore&&f.before.nodesBetween(b.oldRange.from,b.oldRange.to,(w,j)=>{const _=j+w.nodeSize-2,C=b.oldRange.from<=j&&_<=b.oldRange.to;this.editor.emit("delete",{type:"node",node:w,from:j,to:_,newFrom:f.mapping.map(j),newTo:f.mapping.map(_),deletedRange:b.oldRange,newRange:b.newRange,partial:!C,editor:this.editor,transaction:t,combinedTransform:f})})});const x=f.mapping;f.steps.forEach((b,w)=>{var j,_;if(b instanceof Zi){const C=x.slice(w).map(b.from,-1),k=x.slice(w).map(b.to),A=x.invert().map(C,-1),T=x.invert().map(k),P=(j=f.doc.nodeAt(C-1))==null?void 0:j.marks.some(I=>I.eq(b.mark)),R=(_=f.doc.nodeAt(k))==null?void 0:_.marks.some(I=>I.eq(b.mark));this.editor.emit("delete",{type:"mark",mark:b.mark,from:b.from,to:b.to,deletedRange:{from:A,to:T},newRange:{from:C,to:k},partial:!!(R||P),editor:this.editor,transaction:t,combinedTransform:f})}})};(i=(a=(n=this.editor.options.coreExtensionOptions)==null?void 0:n.delete)==null?void 0:a.async)==null||i?setTimeout(l,0):l()}}),lbe=mr.create({name:"drop",addProseMirrorPlugins(){return[new kn({key:new An("tiptapDrop"),props:{handleDrop:(t,s,n,a)=>{this.editor.emit("drop",{editor:this.editor,event:s,slice:n,moved:a})}}})]}}),obe=mr.create({name:"editable",addProseMirrorPlugins(){return[new kn({key:new An("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Xz=new An("focusEvents"),cbe=mr.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new kn({key:Xz,props:{handleDOMEvents:{focus:(s,n)=>{t.isFocused=!0;const a=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return s.dispatch(a),!1},blur:(s,n)=>{t.isFocused=!1;const a=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return s.dispatch(a),!1}}}})]}}),dbe=mr.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:c})=>{const{selection:d,doc:u}=c,{empty:f,$anchor:m}=d,{pos:x,parent:b}=m,w=m.parent.isTextblock&&x>0?c.doc.resolve(x-1):m,j=w.parent.type.spec.isolating,_=m.pos-m.parentOffset,C=j&&w.parent.childCount===1?_===m.pos:Tt.atStart(u).from===x;return!f||!b.type.isTextblock||b.textContent.length||!C||C&&m.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),s=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),a={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:s,"Mod-Delete":s,"Mod-a":()=>this.editor.commands.selectAll()},i={...a},l={...a,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":s,"Ctrl-Alt-Backspace":s,"Alt-Delete":s,"Alt-d":s,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Yk()||$z()?l:i},addProseMirrorPlugins(){return[new kn({key:new An("clearDocument"),appendTransaction:(t,s,n)=>{if(t.some(j=>j.getMeta("composition")))return;const a=t.some(j=>j.docChanged)&&!s.doc.eq(n.doc),i=t.some(j=>j.getMeta("preventClearDocument"));if(!a||i)return;const{empty:l,from:o,to:c}=s.selection,d=Tt.atStart(s.doc).from,u=Tt.atEnd(s.doc).to;if(l||!(o===d&&c===u)||!Wz(n.doc))return;const x=n.tr,b=Oz({state:n,transaction:x}),{commands:w}=new Tye({editor:this.editor,state:b});if(w.clearNodes(),!!x.steps.length)return x}})]}}),ube=mr.create({name:"paste",addProseMirrorPlugins(){return[new kn({key:new An("tiptapPaste"),props:{handlePaste:(t,s,n)=>{this.editor.emit("paste",{editor:this.editor,event:s,slice:n})}}})]}}),hbe=mr.create({name:"tabindex",addProseMirrorPlugins(){return[new kn({key:new An("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),fbe=mr.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:t}=Vz(this.extensions);return[{types:t.filter(s=>s.name!=="text").map(s=>s.name),attributes:{dir:{default:this.options.direction,parseHTML:s=>{const n=s.getAttribute("dir");return n&&(n==="ltr"||n==="rtl"||n==="auto")?n:this.options.direction},renderHTML:s=>s.dir?{dir:s.dir}:{}}}}]},addProseMirrorPlugins(){return[new kn({key:new An("textDirection"),props:{attributes:()=>{const t=this.options.direction;return t?{dir:t}:{}}}})]}});function mbe(t){return new qz({find:t.find,handler:({state:s,range:n,match:a})=>{const i=yu(t.getAttributes,void 0,a);if(i===!1||i===null)return null;const{tr:l}=s,o=a[a.length-1],c=a[0];if(o){const d=c.search(/\S/),u=n.from+c.indexOf(o),f=u+o.length;if(Hz(n.from,n.to,s.doc).filter(b=>b.mark.type.excluded.find(j=>j===t.type&&j!==b.mark.type)).filter(b=>b.to>u).length)return null;f<n.to&&l.delete(f,n.to),u>n.from&&l.delete(n.from+d,u);const x=n.from+d+o.length;l.addMark(n.from+d,x,t.type.create(i||{})),l.removeStoredMark(t.type)}},undoable:t.undoable})}function pbe(t){return new qz({find:t.find,handler:({state:s,range:n,match:a})=>{const i=yu(t.getAttributes,void 0,a)||{},{tr:l}=s,o=n.from;let c=n.to;const d=t.type.create(i);if(a[1]){const u=a[0].lastIndexOf(a[1]);let f=o+u;f>c?f=c:c=f+a[1].length;const m=a[0][a[0].length-1];l.insertText(m,o+a[0].length-1),l.replaceWith(f,c,d)}else if(a[0]){const u=t.type.isInline?o:o-1;l.insert(u,t.type.create(i)).delete(l.mapping.map(o),l.mapping.map(c))}l.scrollIntoView()},undoable:t.undoable})}var xbe=t=>"touches"in t,gbe=class{constructor(t){this.directions=["bottom-left","bottom-right","top-left","top-right"],this.minSize={height:8,width:8},this.preserveAspectRatio=!1,this.classNames={container:"",wrapper:"",handle:"",resizing:""},this.initialWidth=0,this.initialHeight=0,this.aspectRatio=1,this.isResizing=!1,this.activeHandle=null,this.startX=0,this.startY=0,this.startWidth=0,this.startHeight=0,this.isShiftKeyPressed=!1,this.lastEditableState=void 0,this.handleMap=new Map,this.handleMouseMove=c=>{if(!this.isResizing||!this.activeHandle)return;const d=c.clientX-this.startX,u=c.clientY-this.startY;this.handleResize(d,u)},this.handleTouchMove=c=>{if(!this.isResizing||!this.activeHandle)return;const d=c.touches[0];if(!d)return;const u=d.clientX-this.startX,f=d.clientY-this.startY;this.handleResize(u,f)},this.handleMouseUp=()=>{if(!this.isResizing)return;const c=this.element.offsetWidth,d=this.element.offsetHeight;this.onCommit(c,d),this.isResizing=!1,this.activeHandle=null,this.container.dataset.resizeState="false",this.classNames.resizing&&this.container.classList.remove(this.classNames.resizing),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp)},this.handleKeyDown=c=>{c.key==="Shift"&&(this.isShiftKeyPressed=!0)},this.handleKeyUp=c=>{c.key==="Shift"&&(this.isShiftKeyPressed=!1)};var s,n,a,i,l,o;this.node=t.node,this.editor=t.editor,this.element=t.element,this.contentElement=t.contentElement,this.getPos=t.getPos,this.onResize=t.onResize,this.onCommit=t.onCommit,this.onUpdate=t.onUpdate,(s=t.options)!=null&&s.min&&(this.minSize={...this.minSize,...t.options.min}),(n=t.options)!=null&&n.max&&(this.maxSize=t.options.max),(a=t==null?void 0:t.options)!=null&&a.directions&&(this.directions=t.options.directions),(i=t.options)!=null&&i.preserveAspectRatio&&(this.preserveAspectRatio=t.options.preserveAspectRatio),(l=t.options)!=null&&l.className&&(this.classNames={container:t.options.className.container||"",wrapper:t.options.className.wrapper||"",handle:t.options.className.handle||"",resizing:t.options.className.resizing||""}),(o=t.options)!=null&&o.createCustomHandle&&(this.createCustomHandle=t.options.createCustomHandle),this.wrapper=this.createWrapper(),this.container=this.createContainer(),this.applyInitialSize(),this.attachHandles(),this.editor.on("update",this.handleEditorUpdate.bind(this))}get dom(){return this.container}get contentDOM(){return this.contentElement}handleEditorUpdate(){const t=this.editor.isEditable;t!==this.lastEditableState&&(this.lastEditableState=t,t?t&&this.handleMap.size===0&&this.attachHandles():this.removeHandles())}update(t,s,n){return t.type!==this.node.type?!1:(this.node=t,this.onUpdate?this.onUpdate(t,s,n):!0)}destroy(){this.isResizing&&(this.container.dataset.resizeState="false",this.classNames.resizing&&this.container.classList.remove(this.classNames.resizing),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp),this.isResizing=!1,this.activeHandle=null),this.editor.off("update",this.handleEditorUpdate.bind(this)),this.container.remove()}createContainer(){const t=document.createElement("div");return t.dataset.resizeContainer="",t.dataset.node=this.node.type.name,t.style.display="flex",this.classNames.container&&(t.className=this.classNames.container),t.appendChild(this.wrapper),t}createWrapper(){const t=document.createElement("div");return t.style.position="relative",t.style.display="block",t.dataset.resizeWrapper="",this.classNames.wrapper&&(t.className=this.classNames.wrapper),t.appendChild(this.element),t}createHandle(t){const s=document.createElement("div");return s.dataset.resizeHandle=t,s.style.position="absolute",this.classNames.handle&&(s.className=this.classNames.handle),s}positionHandle(t,s){const n=s.includes("top"),a=s.includes("bottom"),i=s.includes("left"),l=s.includes("right");n&&(t.style.top="0"),a&&(t.style.bottom="0"),i&&(t.style.left="0"),l&&(t.style.right="0"),(s==="top"||s==="bottom")&&(t.style.left="0",t.style.right="0"),(s==="left"||s==="right")&&(t.style.top="0",t.style.bottom="0")}attachHandles(){this.directions.forEach(t=>{let s;this.createCustomHandle?s=this.createCustomHandle(t):s=this.createHandle(t),s instanceof HTMLElement||(console.warn(`[ResizableNodeView] createCustomHandle("${t}") did not return an HTMLElement. Falling back to default handle.`),s=this.createHandle(t)),this.createCustomHandle||this.positionHandle(s,t),s.addEventListener("mousedown",n=>this.handleResizeStart(n,t)),s.addEventListener("touchstart",n=>this.handleResizeStart(n,t)),this.handleMap.set(t,s),this.wrapper.appendChild(s)})}removeHandles(){this.handleMap.forEach(t=>t.remove()),this.handleMap.clear()}applyInitialSize(){const t=this.node.attrs.width,s=this.node.attrs.height;t?(this.element.style.width=`${t}px`,this.initialWidth=t):this.initialWidth=this.element.offsetWidth,s?(this.element.style.height=`${s}px`,this.initialHeight=s):this.initialHeight=this.element.offsetHeight,this.initialWidth>0&&this.initialHeight>0&&(this.aspectRatio=this.initialWidth/this.initialHeight)}handleResizeStart(t,s){t.preventDefault(),t.stopPropagation(),this.isResizing=!0,this.activeHandle=s,xbe(t)?(this.startX=t.touches[0].clientX,this.startY=t.touches[0].clientY):(this.startX=t.clientX,this.startY=t.clientY),this.startWidth=this.element.offsetWidth,this.startHeight=this.element.offsetHeight,this.startWidth>0&&this.startHeight>0&&(this.aspectRatio=this.startWidth/this.startHeight),this.getPos(),this.container.dataset.resizeState="true",this.classNames.resizing&&this.container.classList.add(this.classNames.resizing),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("touchmove",this.handleTouchMove),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}handleResize(t,s){if(!this.activeHandle)return;const n=this.preserveAspectRatio||this.isShiftKeyPressed,{width:a,height:i}=this.calculateNewDimensions(this.activeHandle,t,s),l=this.applyConstraints(a,i,n);this.element.style.width=`${l.width}px`,this.element.style.height=`${l.height}px`,this.onResize&&this.onResize(l.width,l.height)}calculateNewDimensions(t,s,n){let a=this.startWidth,i=this.startHeight;const l=t.includes("right"),o=t.includes("left"),c=t.includes("bottom"),d=t.includes("top");return l?a=this.startWidth+s:o&&(a=this.startWidth-s),c?i=this.startHeight+n:d&&(i=this.startHeight-n),(t==="right"||t==="left")&&(a=this.startWidth+(l?s:-s)),(t==="top"||t==="bottom")&&(i=this.startHeight+(c?n:-n)),this.preserveAspectRatio||this.isShiftKeyPressed?this.applyAspectRatio(a,i,t):{width:a,height:i}}applyConstraints(t,s,n){var a,i,l,o;if(!n){let u=Math.max(this.minSize.width,t),f=Math.max(this.minSize.height,s);return(a=this.maxSize)!=null&&a.width&&(u=Math.min(this.maxSize.width,u)),(i=this.maxSize)!=null&&i.height&&(f=Math.min(this.maxSize.height,f)),{width:u,height:f}}let c=t,d=s;return c<this.minSize.width&&(c=this.minSize.width,d=c/this.aspectRatio),d<this.minSize.height&&(d=this.minSize.height,c=d*this.aspectRatio),(l=this.maxSize)!=null&&l.width&&c>this.maxSize.width&&(c=this.maxSize.width,d=c/this.aspectRatio),(o=this.maxSize)!=null&&o.height&&d>this.maxSize.height&&(d=this.maxSize.height,c=d*this.aspectRatio),{width:c,height:d}}applyAspectRatio(t,s,n){const a=n==="left"||n==="right",i=n==="top"||n==="bottom";return a?{width:t,height:t/this.aspectRatio}:i?{width:s*this.aspectRatio,height:s}:{width:t,height:t/this.aspectRatio}}},ybe={};Gk(ybe,{createAtomBlockMarkdownSpec:()=>bbe,createBlockMarkdownSpec:()=>vbe,createInlineMarkdownSpec:()=>jbe,parseAttributes:()=>eA,parseIndentedBlocks:()=>_be,renderNestedMarkdownContent:()=>Sbe,serializeAttributes:()=>tA});function eA(t){if(!(t!=null&&t.trim()))return{};const s={},n=[],a=t.replace(/["']([^"']*)["']/g,u=>(n.push(u),`__QUOTED_${n.length-1}__`)),i=a.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(i){const u=i.map(f=>f.trim().slice(1));s.class=u.join(" ")}const l=a.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);l&&(s.id=l[1]);const o=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(a.matchAll(o)).forEach(([,u,f])=>{var m;const x=parseInt(((m=f.match(/__QUOTED_(\d+)__/))==null?void 0:m[1])||"0",10),b=n[x];b&&(s[u]=b.slice(1,-1))});const d=a.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return d&&d.split(/\s+/).filter(Boolean).forEach(f=>{f.match(/^[a-zA-Z][\w-]*$/)&&(s[f]=!0)}),s}function tA(t){if(!t||Object.keys(t).length===0)return"";const s=[];return t.class&&String(t.class).split(/\s+/).filter(Boolean).forEach(a=>s.push(`.${a}`)),t.id&&s.push(`#${t.id}`),Object.entries(t).forEach(([n,a])=>{n==="class"||n==="id"||(a===!0?s.push(n):a!==!1&&a!=null&&s.push(`${n}="${String(a)}"`))}),s.join(" ")}function bbe(t){const{nodeName:s,name:n,parseAttributes:a=eA,serializeAttributes:i=tA,defaultAttributes:l={},requiredAttributes:o=[],allowedAttributes:c}=t,d=n||s,u=f=>{if(!c)return f;const m={};return c.forEach(x=>{x in f&&(m[x]=f[x])}),m};return{parseMarkdown:(f,m)=>{const x={...l,...f.attributes};return m.createNode(s,x,[])},markdownTokenizer:{name:s,level:"block",start(f){var m;const x=new RegExp(`^:::${d}(?:\\s|$)`,"m"),b=(m=f.match(x))==null?void 0:m.index;return b!==void 0?b:-1},tokenize(f,m,x){const b=new RegExp(`^:::${d}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),w=f.match(b);if(!w)return;const j=w[1]||"",_=a(j);if(!o.find(k=>!(k in _)))return{type:s,raw:w[0],attributes:_}}},renderMarkdown:f=>{const m=u(f.attrs||{}),x=i(m),b=x?` {${x}}`:"";return`:::${d}${b} :::`}}}function vbe(t){const{nodeName:s,name:n,getContent:a,parseAttributes:i=eA,serializeAttributes:l=tA,defaultAttributes:o={},content:c="block",allowedAttributes:d}=t,u=n||s,f=m=>{if(!d)return m;const x={};return d.forEach(b=>{b in m&&(x[b]=m[b])}),x};return{parseMarkdown:(m,x)=>{let b;if(a){const j=a(m);b=typeof j=="string"?[{type:"text",text:j}]:j}else c==="block"?b=x.parseChildren(m.tokens||[]):b=x.parseInline(m.tokens||[]);const w={...o,...m.attributes};return x.createNode(s,w,b)},markdownTokenizer:{name:s,level:"block",start(m){var x;const b=new RegExp(`^:::${u}`,"m"),w=(x=m.match(b))==null?void 0:x.index;return w!==void 0?w:-1},tokenize(m,x,b){var w;const j=new RegExp(`^:::${u}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),_=m.match(j);if(!_)return;const[C,k=""]=_,A=i(k);let T=1;const P=C.length;let R="";const I=/^:::([\w-]*)(\s.*)?/gm,O=m.slice(P);for(I.lastIndex=0;;){const M=I.exec(O);if(M===null)break;const B=M.index,L=M[1];if(!((w=M[2])!=null&&w.endsWith(":::"))){if(L)T+=1;else if(T-=1,T===0){const F=O.slice(0,B);R=F.trim();const V=m.slice(0,P+B+M[0].length);let U=[];if(R)if(c==="block")for(U=b.blockTokens(F),U.forEach(z=>{z.text&&(!z.tokens||z.tokens.length===0)&&(z.tokens=b.inlineTokens(z.text))});U.length>0;){const z=U[U.length-1];if(z.type==="paragraph"&&(!z.text||z.text.trim()===""))U.pop();else break}else U=b.inlineTokens(R);return{type:s,raw:V,attributes:A,content:R,tokens:U}}}}}},renderMarkdown:(m,x)=>{const b=f(m.attrs||{}),w=l(b),j=w?` {${w}}`:"",_=x.renderChildren(m.content||[],`

`);return`:::${u}${j}

${_}

:::`}}}function wbe(t){if(!t.trim())return{};const s={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let a=n.exec(t);for(;a!==null;){const[,i,l,o]=a;s[i]=l||o,a=n.exec(t)}return s}function Nbe(t){return Object.entries(t).filter(([,s])=>s!=null).map(([s,n])=>`${s}="${n}"`).join(" ")}function jbe(t){const{nodeName:s,name:n,getContent:a,parseAttributes:i=wbe,serializeAttributes:l=Nbe,defaultAttributes:o={},selfClosing:c=!1,allowedAttributes:d}=t,u=n||s,f=x=>{if(!d)return x;const b={};return d.forEach(w=>{const j=typeof w=="string"?w:w.name,_=typeof w=="string"?void 0:w.skipIfDefault;if(j in x){const C=x[j];if(_!==void 0&&C===_)return;b[j]=C}}),b},m=u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(x,b)=>{const w={...o,...x.attributes};if(c)return b.createNode(s,w);const j=a?a(x):x.content||"";return j?b.createNode(s,w,[b.createTextNode(j)]):b.createNode(s,w,[])},markdownTokenizer:{name:s,level:"inline",start(x){const b=c?new RegExp(`\\[${m}\\s*[^\\]]*\\]`):new RegExp(`\\[${m}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${m}\\]`),w=x.match(b),j=w==null?void 0:w.index;return j!==void 0?j:-1},tokenize(x,b,w){const j=c?new RegExp(`^\\[${m}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${m}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${m}\\]`),_=x.match(j);if(!_)return;let C="",k="";if(c){const[,T]=_;k=T}else{const[,T,P]=_;k=T,C=P||""}const A=i(k.trim());return{type:s,raw:_[0],content:C.trim(),attributes:A}}},renderMarkdown:x=>{let b="";a?b=a(x):x.content&&x.content.length>0&&(b=x.content.filter(C=>C.type==="text").map(C=>C.text).join(""));const w=f(x.attrs||{}),j=l(w),_=j?` ${j}`:"";return c?`[${u}${_}]`:`[${u}${_}]${b}[/${u}]`}}}function _be(t,s,n){var a,i,l,o;const c=t.split(`
`),d=[];let u="",f=0;const m=s.baseIndentSize||2;for(;f<c.length;){const x=c[f],b=x.match(s.itemPattern);if(!b){if(d.length>0)break;if(x.trim()===""){f+=1,u=`${u}${x}
`;continue}else return}const w=s.extractItemData(b),{indentLevel:j,mainContent:_}=w;u=`${u}${x}
`;const C=[_];for(f+=1;f<c.length;){const P=c[f];if(P.trim()===""){const I=c.slice(f+1).findIndex(B=>B.trim()!=="");if(I===-1)break;if((((i=(a=c[f+1+I].match(/^(\s*)/))==null?void 0:a[1])==null?void 0:i.length)||0)>j){C.push(P),u=`${u}${P}
`,f+=1;continue}else break}if((((o=(l=P.match(/^(\s*)/))==null?void 0:l[1])==null?void 0:o.length)||0)>j)C.push(P),u=`${u}${P}
`,f+=1;else break}let k;const A=C.slice(1);if(A.length>0){const P=A.map(R=>R.slice(j+m)).join(`
`);P.trim()&&(s.customNestedParser?k=s.customNestedParser(P):k=n.blockTokens(P))}const T=s.createToken(w,k);d.push(T)}if(d.length!==0)return{items:d,raw:u}}function Sbe(t,s,n,a){if(!t||!Array.isArray(t.content))return"";const i=typeof n=="function"?n(a):n,[l,...o]=t.content,c=s.renderChildren([l]),d=[`${i}${c}`];return o&&o.length>0&&o.forEach(u=>{const f=s.renderChildren([u]);if(f){const m=f.split(`
`).map(x=>x?s.indent(x):"").join(`
`);d.push(m)}}),d.join(`
`)}var Ix=class Qz extends Zk{constructor(){super(...arguments),this.type="node"}static create(s={}){const n=typeof s=="function"?s():s;return new Qz(n)}configure(s){return super.configure(s)}extend(s){const n=typeof s=="function"?s():s;return super.extend(n)}};function Cbe(t){return new sbe({find:t.find,handler:({state:s,range:n,match:a,pasteEvent:i})=>{const l=yu(t.getAttributes,void 0,a,i);if(l===!1||l===null)return null;const{tr:o}=s,c=a[a.length-1],d=a[0];let u=n.to;if(c){const f=d.search(/\S/),m=n.from+d.indexOf(c),x=m+c.length;if(Hz(n.from,n.to,s.doc).filter(w=>w.mark.type.excluded.find(_=>_===t.type&&_!==w.mark.type)).filter(w=>w.to>m).length)return null;x<n.to&&o.delete(x,n.to),m>n.from&&o.delete(n.from+f,m),u=n.from+f+c.length,o.addMark(n.from+f,u,t.type.create(l||{})),o.removeStoredMark(t.type)}}})}function Zz(t){const{state:s,transaction:n}=t;let{selection:a}=n,{doc:i}=n,{storedMarks:l}=n;return{...s,apply:s.apply.bind(s),applyTransaction:s.applyTransaction.bind(s),plugins:s.plugins,schema:s.schema,reconfigure:s.reconfigure.bind(s),toJSON:s.toJSON.bind(s),get storedMarks(){return l},get selection(){return a},get doc(){return i},get tr(){return a=n.selection,i=n.doc,l=n.storedMarks,n}}}class kbe{constructor(s){this.editor=s.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=s.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:s,editor:n,state:a}=this,{view:i}=n,{tr:l}=a,o=this.buildProps(l);return Object.fromEntries(Object.entries(s).map(([c,d])=>[c,(...f)=>{const m=d(...f)(o);return!l.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(l),m}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(s,n=!0){const{rawCommands:a,editor:i,state:l}=this,{view:o}=i,c=[],d=!!s,u=s||l.tr,f=()=>(!d&&n&&!u.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(u),c.every(x=>x===!0)),m={...Object.fromEntries(Object.entries(a).map(([x,b])=>[x,(...j)=>{const _=this.buildProps(u,n),C=b(...j)(_);return c.push(C),m}])),run:f};return m}createCan(s){const{rawCommands:n,state:a}=this,i=!1,l=s||a.tr,o=this.buildProps(l,i);return{...Object.fromEntries(Object.entries(n).map(([d,u])=>[d,(...f)=>u(...f)({...o,dispatch:void 0})])),chain:()=>this.createChain(l,i)}}buildProps(s,n=!0){const{rawCommands:a,editor:i,state:l}=this,{view:o}=i,c={tr:s,editor:i,view:o,state:Zz({state:l,transaction:s}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(s,n),can:()=>this.createCan(s),get commands(){return Object.fromEntries(Object.entries(a).map(([d,u])=>[d,(...f)=>u(...f)(c)]))}};return c}}function $r(t,s,n){return t.config[s]===void 0&&t.parent?$r(t.parent,s,n):typeof t.config[s]=="function"?t.config[s].bind({...n,parent:t.parent?$r(t.parent,s,n):null}):t.config[s]}function Abe(t){const s=t.filter(i=>i.type==="extension"),n=t.filter(i=>i.type==="node"),a=t.filter(i=>i.type==="mark");return{baseExtensions:s,nodeExtensions:n,markExtensions:a}}function Kr(t,s){if(typeof t=="string"){if(!s.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return s.nodes[t]}return t}function Ea(...t){return t.filter(s=>!!s).reduce((s,n)=>{const a={...s};return Object.entries(n).forEach(([i,l])=>{if(!a[i]){a[i]=l;return}if(i==="class"){const c=l?String(l).split(" "):[],d=a[i]?a[i].split(" "):[],u=c.filter(f=>!d.includes(f));a[i]=[...d,...u].join(" ")}else if(i==="style"){const c=l?l.split(";").map(f=>f.trim()).filter(Boolean):[],d=a[i]?a[i].split(";").map(f=>f.trim()).filter(Boolean):[],u=new Map;d.forEach(f=>{const[m,x]=f.split(":").map(b=>b.trim());u.set(m,x)}),c.forEach(f=>{const[m,x]=f.split(":").map(b=>b.trim());u.set(m,x)}),a[i]=Array.from(u.entries()).map(([f,m])=>`${f}: ${m}`).join("; ")}else a[i]=l}),a},{})}function Ebe(t){return typeof t=="function"}function Qn(t,s=void 0,...n){return Ebe(t)?s?t.bind(s)(...n):t(...n):t}function Tbe(t){return Object.prototype.toString.call(t)==="[object RegExp]"}class iv{constructor(s){this.find=s.find,this.handler=s.handler}}function Pbe(t){return Object.prototype.toString.call(t).slice(8,-1)}function W0(t){return Pbe(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function lv(t,s){const n={...t};return W0(t)&&W0(s)&&Object.keys(s).forEach(a=>{W0(s[a])&&W0(t[a])?n[a]=lv(t[a],s[a]):n[a]=s[a]}),n}class bu{constructor(s={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...s},this.name=this.config.name,s.defaultOptions&&Object.keys(s.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Qn($r(this,"addOptions",{name:this.name}))),this.storage=Qn($r(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(s={}){return new bu(s)}configure(s={}){const n=this.extend({...this.config,addOptions:()=>lv(this.options,s)});return n.name=this.name,n.parent=this.parent,n}extend(s={}){const n=new bu(s);return n.parent=this,this.child=n,n.name=s.name?s.name:n.parent.name,s.defaultOptions&&Object.keys(s.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Qn($r(n,"addOptions",{name:n.name})),n.storage=Qn($r(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:s,mark:n}){const{tr:a}=s.state,i=s.state.selection.$from;if(i.pos===i.end()){const o=i.marks();if(!!!o.find(u=>(u==null?void 0:u.type.name)===n.name))return!1;const d=o.find(u=>(u==null?void 0:u.type.name)===n.name);return d&&a.removeStoredMark(d),a.insertText(" ",i.pos),s.view.dispatch(a),!0}return!1}}class Ibe{constructor(s){this.find=s.find,this.handler=s.handler}}class aa{constructor(s={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...s},this.name=this.config.name,s.defaultOptions&&Object.keys(s.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Qn($r(this,"addOptions",{name:this.name}))),this.storage=Qn($r(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(s={}){return new aa(s)}configure(s={}){const n=this.extend({...this.config,addOptions:()=>lv(this.options,s)});return n.name=this.name,n.parent=this.parent,n}extend(s={}){const n=new aa({...this.config,...s});return n.parent=this,this.child=n,n.name=s.name?s.name:n.parent.name,s.defaultOptions&&Object.keys(s.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Qn($r(n,"addOptions",{name:n.name})),n.storage=Qn($r(n,"addStorage",{name:n.name,options:n.options})),n}}function Mbe(t,s,n){const{from:a,to:i}=s,{blockSeparator:l=`

`,textSerializers:o={}}=n||{};let c="";return t.nodesBetween(a,i,(d,u,f,m)=>{var x;d.isBlock&&u>a&&(c+=l);const b=o==null?void 0:o[d.type.name];if(b)return f&&(c+=b({node:d,pos:u,parent:f,index:m,range:s})),!1;d.isText&&(c+=(x=d==null?void 0:d.text)===null||x===void 0?void 0:x.slice(Math.max(a,u)-u,i-u))}),c}function Dbe(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,s])=>s.spec.toText).map(([s,n])=>[s,n.spec.toText]))}aa.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new kn({key:new An("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:s,schema:n}=t,{doc:a,selection:i}=s,{ranges:l}=i,o=Math.min(...l.map(f=>f.$from.pos)),c=Math.max(...l.map(f=>f.$to.pos)),d=Dbe(n);return Mbe(a,{from:o,to:c},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:d})}}})]}});const Obe=()=>({editor:t,view:s})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(s.dom.blur(),(n=window==null?void 0:window.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),Rbe=(t=!1)=>({commands:s})=>s.setContent("",t),Lbe=()=>({state:t,tr:s,dispatch:n})=>{const{selection:a}=s,{ranges:i}=a;return n&&i.forEach(({$from:l,$to:o})=>{t.doc.nodesBetween(l.pos,o.pos,(c,d)=>{if(c.type.isText)return;const{doc:u,mapping:f}=s,m=u.resolve(f.map(d)),x=u.resolve(f.map(d+c.nodeSize)),b=m.blockRange(x);if(!b)return;const w=Du(b);if(c.type.isTextblock){const{defaultType:j}=m.parent.contentMatchAt(m.index());s.setNodeMarkup(b.start,j)}(w||w===0)&&s.lift(b,w)})}),!0},Bbe=t=>s=>t(s),Fbe=()=>({state:t,dispatch:s})=>Rk(t,s),$be=(t,s)=>({editor:n,tr:a})=>{const{state:i}=n,l=i.doc.slice(t.from,t.to);a.deleteRange(t.from,t.to);const o=a.mapping.map(s);return a.insert(o,l.content),a.setSelection(new vt(a.doc.resolve(Math.max(o-1,0)))),!0},zbe=()=>({tr:t,dispatch:s})=>{const{selection:n}=t,a=n.$anchor.node();if(a.content.size>0)return!1;const i=t.selection.$anchor;for(let l=i.depth;l>0;l-=1)if(i.node(l).type===a.type){if(s){const c=i.before(l),d=i.after(l);t.delete(c,d).scrollIntoView()}return!0}return!1},Ube=t=>({tr:s,state:n,dispatch:a})=>{const i=Kr(t,n.schema),l=s.selection.$anchor;for(let o=l.depth;o>0;o-=1)if(l.node(o).type===i){if(a){const d=l.before(o),u=l.after(o);s.delete(d,u).scrollIntoView()}return!0}return!1},Vbe=t=>({tr:s,dispatch:n})=>{const{from:a,to:i}=t;return n&&s.delete(a,i),!0},Hbe=()=>({state:t,dispatch:s})=>nv(t,s),Wbe=()=>({commands:t})=>t.keyboardShortcut("Enter"),qbe=()=>({state:t,dispatch:s})=>ez(t,s);function l1(t,s,n={strict:!0}){const a=Object.keys(s);return a.length?a.every(i=>n.strict?s[i]===t[i]:Tbe(s[i])?s[i].test(t[i]):s[i]===t[i]):!0}function Jz(t,s,n={}){return t.find(a=>a.type===s&&l1(Object.fromEntries(Object.keys(n).map(i=>[i,a.attrs[i]])),n))}function rM(t,s,n={}){return!!Jz(t,s,n)}function sA(t,s,n){var a;if(!t||!s)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(f=>f.type===s))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(f=>f.type===s)||(n=n||((a=i.node.marks[0])===null||a===void 0?void 0:a.attrs),!Jz([...i.node.marks],s,n)))return;let o=i.index,c=t.start()+i.offset,d=o+1,u=c+i.node.nodeSize;for(;o>0&&rM([...t.parent.child(o-1).marks],s,n);)o-=1,c-=t.parent.child(o).nodeSize;for(;d<t.parent.childCount&&rM([...t.parent.child(d).marks],s,n);)u+=t.parent.child(d).nodeSize,d+=1;return{from:c,to:u}}function dd(t,s){if(typeof t=="string"){if(!s.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return s.marks[t]}return t}const Gbe=(t,s={})=>({tr:n,state:a,dispatch:i})=>{const l=dd(t,a.schema),{doc:o,selection:c}=n,{$from:d,from:u,to:f}=c;if(i){const m=sA(d,l,s);if(m&&m.from<=u&&m.to>=f){const x=vt.create(o,m.from,m.to);n.setSelection(x)}}return!0},Kbe=t=>s=>{const n=typeof t=="function"?t(s):t;for(let a=0;a<n.length;a+=1)if(n[a](s))return!0;return!1};function eU(t){return t instanceof vt}function zd(t=0,s=0,n=0){return Math.min(Math.max(t,s),n)}function Ybe(t,s=null){if(!s)return null;const n=Tt.atStart(t),a=Tt.atEnd(t);if(s==="start"||s===!0)return n;if(s==="end")return a;const i=n.from,l=a.to;return s==="all"?vt.create(t,zd(0,i,l),zd(t.content.size,i,l)):vt.create(t,zd(s,i,l),zd(s,i,l))}function Xbe(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function nA(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const Qbe=(t=null,s={})=>({editor:n,view:a,tr:i,dispatch:l})=>{s={scrollIntoView:!0,...s};const o=()=>{(nA()||Xbe())&&a.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(a.focus(),s!=null&&s.scrollIntoView&&n.commands.scrollIntoView())})};if(a.hasFocus()&&t===null||t===!1)return!0;if(l&&t===null&&!eU(n.state.selection))return o(),!0;const c=Ybe(i.doc,t)||n.state.selection,d=n.state.selection.eq(c);return l&&(d||i.setSelection(c),d&&i.storedMarks&&i.setStoredMarks(i.storedMarks),o()),!0},Zbe=(t,s)=>n=>t.every((a,i)=>s(a,{...n,index:i})),Jbe=(t,s)=>({tr:n,commands:a})=>a.insertContentAt({from:n.selection.from,to:n.selection.to},t,s),tU=t=>{const s=t.childNodes;for(let n=s.length-1;n>=0;n-=1){const a=s[n];a.nodeType===3&&a.nodeValue&&/^(\n\s\s|\n)$/.test(a.nodeValue)?t.removeChild(a):a.nodeType===1&&tU(a)}return t};function q0(t){const s=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(s,"text/html").body;return tU(n)}function Yp(t,s,n){if(t instanceof Mc||t instanceof Fe)return t;n={slice:!0,parseOptions:{},...n};const a=typeof t=="object"&&t!==null,i=typeof t=="string";if(a)try{if(Array.isArray(t)&&t.length>0)return Fe.fromArray(t.map(c=>s.nodeFromJSON(c)));const o=s.nodeFromJSON(t);return n.errorOnInvalidContent&&o.check(),o}catch(l){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:l});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",l),Yp("",s,n)}if(i){if(n.errorOnInvalidContent){let o=!1,c="";const d=new C$({topNode:s.spec.topNode,marks:s.spec.marks,nodes:s.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(o=!0,c=typeof u=="string"?u:u.outerHTML,null)}]}})});if(n.slice?zl.fromSchema(d).parseSlice(q0(t),n.parseOptions):zl.fromSchema(d).parse(q0(t),n.parseOptions),n.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${c}`)})}const l=zl.fromSchema(s);return n.slice?l.parseSlice(q0(t),n.parseOptions).content:l.parse(q0(t),n.parseOptions)}return Yp("",s,n)}function eve(t,s,n){const a=t.steps.length-1;if(a<s)return;const i=t.steps[a];if(!(i instanceof qn||i instanceof er))return;const l=t.mapping.maps[a];let o=0;l.forEach((c,d,u,f)=>{o===0&&(o=f)}),t.setSelection(Tt.near(t.doc.resolve(o),n))}const tve=t=>!("type"in t),sve=(t,s,n)=>({tr:a,dispatch:i,editor:l})=>{var o;if(i){n={parseOptions:l.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let c;const d=_=>{l.emit("contentError",{editor:l,error:_,disableCollaboration:()=>{l.storage.collaboration&&(l.storage.collaboration.isDisabled=!0)}})},u={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!l.options.enableContentCheck&&l.options.emitContentError)try{Yp(s,l.schema,{parseOptions:u,errorOnInvalidContent:!0})}catch(_){d(_)}try{c=Yp(s,l.schema,{parseOptions:u,errorOnInvalidContent:(o=n.errorOnInvalidContent)!==null&&o!==void 0?o:l.options.enableContentCheck})}catch(_){return d(_),!1}let{from:f,to:m}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},x=!0,b=!0;if((tve(c)?c:[c]).forEach(_=>{_.check(),x=x?_.isText&&_.marks.length===0:!1,b=b?_.isBlock:!1}),f===m&&b){const{parent:_}=a.doc.resolve(f);_.isTextblock&&!_.type.spec.code&&!_.childCount&&(f-=1,m+=1)}let j;if(x){if(Array.isArray(s))j=s.map(_=>_.text||"").join("");else if(s instanceof Fe){let _="";s.forEach(C=>{C.text&&(_+=C.text)}),j=_}else typeof s=="object"&&s&&s.text?j=s.text:j=s;a.insertText(j,f,m)}else j=c,a.replaceWith(f,m,j);n.updateSelection&&eve(a,a.steps.length-1,-1),n.applyInputRules&&a.setMeta("applyInputRules",{from:f,text:j}),n.applyPasteRules&&a.setMeta("applyPasteRules",{from:f,text:j})}return!0},nve=()=>({state:t,dispatch:s})=>Q$(t,s),rve=()=>({state:t,dispatch:s})=>Z$(t,s),ave=()=>({state:t,dispatch:s})=>Ak(t,s),ive=()=>({state:t,dispatch:s})=>Pk(t,s),lve=()=>({state:t,dispatch:s,tr:n})=>{try{const a=Rf(t.doc,t.selection.$from.pos,-1);return a==null?!1:(n.join(a,2),s&&s(n),!0)}catch{return!1}},ove=()=>({state:t,dispatch:s,tr:n})=>{try{const a=Rf(t.doc,t.selection.$from.pos,1);return a==null?!1:(n.join(a,2),s&&s(n),!0)}catch{return!1}},cve=()=>({state:t,dispatch:s})=>G$(t,s),dve=()=>({state:t,dispatch:s})=>K$(t,s);function sU(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function uve(t){const s=t.split(/-(?!$)/);let n=s[s.length-1];n==="Space"&&(n=" ");let a,i,l,o;for(let c=0;c<s.length-1;c+=1){const d=s[c];if(/^(cmd|meta|m)$/i.test(d))o=!0;else if(/^a(lt)?$/i.test(d))a=!0;else if(/^(c|ctrl|control)$/i.test(d))i=!0;else if(/^s(hift)?$/i.test(d))l=!0;else if(/^mod$/i.test(d))nA()||sU()?o=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${d}`)}return a&&(n=`Alt-${n}`),i&&(n=`Ctrl-${n}`),o&&(n=`Meta-${n}`),l&&(n=`Shift-${n}`),n}const hve=t=>({editor:s,view:n,tr:a,dispatch:i})=>{const l=uve(t).split(/-(?!$)/),o=l.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),c=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:l.includes("Alt"),ctrlKey:l.includes("Ctrl"),metaKey:l.includes("Meta"),shiftKey:l.includes("Shift"),bubbles:!0,cancelable:!0}),d=s.captureTransaction(()=>{n.someProp("handleKeyDown",u=>u(n,c))});return d==null||d.steps.forEach(u=>{const f=u.map(a.mapping);f&&i&&a.maybeStep(f)}),!0};function rA(t,s,n={}){const{from:a,to:i,empty:l}=t.selection,o=s?Kr(s,t.schema):null,c=[];t.doc.nodesBetween(a,i,(m,x)=>{if(m.isText)return;const b=Math.max(a,x),w=Math.min(i,x+m.nodeSize);c.push({node:m,from:b,to:w})});const d=i-a,u=c.filter(m=>o?o.name===m.node.type.name:!0).filter(m=>l1(m.node.attrs,n,{strict:!1}));return l?!!u.length:u.reduce((m,x)=>m+x.to-x.from,0)>=d}const fve=(t,s={})=>({state:n,dispatch:a})=>{const i=Kr(t,n.schema);return rA(n,i,s)?J$(n,a):!1},mve=()=>({state:t,dispatch:s})=>Lk(t,s),pve=t=>({state:s,dispatch:n})=>{const a=Kr(t,s.schema);return oz(a)(s,n)},xve=()=>({state:t,dispatch:s})=>Dk(t,s);function nU(t,s){return s.nodes[t]?"node":s.marks[t]?"mark":null}function aM(t,s){const n=typeof s=="string"?[s]:s;return Object.keys(t).reduce((a,i)=>(n.includes(i)||(a[i]=t[i]),a),{})}const gve=(t,s)=>({tr:n,state:a,dispatch:i})=>{let l=null,o=null;const c=nU(typeof t=="string"?t:t.name,a.schema);return c?(c==="node"&&(l=Kr(t,a.schema)),c==="mark"&&(o=dd(t,a.schema)),i&&n.selection.ranges.forEach(d=>{a.doc.nodesBetween(d.$from.pos,d.$to.pos,(u,f)=>{l&&l===u.type&&n.setNodeMarkup(f,void 0,aM(u.attrs,s)),o&&u.marks.length&&u.marks.forEach(m=>{o===m.type&&n.addMark(f,f+u.nodeSize,o.create(aM(m.attrs,s)))})})}),!0):!1},yve=()=>({tr:t,dispatch:s})=>(s&&t.scrollIntoView(),!0),bve=()=>({tr:t,dispatch:s})=>{if(s){const n=new ka(t.doc);t.setSelection(n)}return!0},vve=()=>({state:t,dispatch:s})=>Ek(t,s),wve=()=>({state:t,dispatch:s})=>Ik(t,s),Nve=()=>({state:t,dispatch:s})=>tz(t,s),jve=()=>({state:t,dispatch:s})=>az(t,s),_ve=()=>({state:t,dispatch:s})=>rz(t,s);function Sve(t,s,n={},a={}){return Yp(t,s,{slice:!1,parseOptions:n,errorOnInvalidContent:a.errorOnInvalidContent})}const Cve=(t,s=!1,n={},a={})=>({editor:i,tr:l,dispatch:o,commands:c})=>{var d,u;const{doc:f}=l;if(n.preserveWhitespace!=="full"){const m=Sve(t,i.schema,n,{errorOnInvalidContent:(d=a.errorOnInvalidContent)!==null&&d!==void 0?d:i.options.enableContentCheck});return o&&l.replaceWith(0,f.content.size,m).setMeta("preventUpdate",!s),!0}return o&&l.setMeta("preventUpdate",!s),c.insertContentAt({from:0,to:f.content.size},t,{parseOptions:n,errorOnInvalidContent:(u=a.errorOnInvalidContent)!==null&&u!==void 0?u:i.options.enableContentCheck})};function kve(t,s){const n=dd(s,t.schema),{from:a,to:i,empty:l}=t.selection,o=[];l?(t.storedMarks&&o.push(...t.storedMarks),o.push(...t.selection.$head.marks())):t.doc.nodesBetween(a,i,d=>{o.push(...d.marks)});const c=o.find(d=>d.type.name===n.name);return c?{...c.attrs}:{}}function Ave(t){for(let s=0;s<t.edgeCount;s+=1){const{type:n}=t.edge(s);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function Eve(t,s){for(let n=t.depth;n>0;n-=1){const a=t.node(n);if(s(a))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:a}}}function aA(t){return s=>Eve(s.$from,t)}function rU(t,s,n){const a=[];return t===s?n.resolve(t).marks().forEach(i=>{const l=n.resolve(t),o=sA(l,i.type);o&&a.push({mark:i,...o})}):n.nodesBetween(t,s,(i,l)=>{!i||(i==null?void 0:i.nodeSize)===void 0||a.push(...i.marks.map(o=>({from:l,to:l+i.nodeSize,mark:o})))}),a}function qg(t,s,n){return Object.fromEntries(Object.entries(n).filter(([a])=>{const i=t.find(l=>l.type===s&&l.name===a);return i?i.attribute.keepOnSplit:!1}))}function Tve(t,s,n={}){const{empty:a,ranges:i}=t.selection,l=s?dd(s,t.schema):null;if(a)return!!(t.storedMarks||t.selection.$from.marks()).filter(m=>l?l.name===m.type.name:!0).find(m=>l1(m.attrs,n,{strict:!1}));let o=0;const c=[];if(i.forEach(({$from:m,$to:x})=>{const b=m.pos,w=x.pos;t.doc.nodesBetween(b,w,(j,_)=>{if(!j.isText&&!j.marks.length)return;const C=Math.max(b,_),k=Math.min(w,_+j.nodeSize),A=k-C;o+=A,c.push(...j.marks.map(T=>({mark:T,from:C,to:k})))})}),o===0)return!1;const d=c.filter(m=>l?l.name===m.mark.type.name:!0).filter(m=>l1(m.mark.attrs,n,{strict:!1})).reduce((m,x)=>m+x.to-x.from,0),u=c.filter(m=>l?m.mark.type!==l&&m.mark.type.excludes(l):!0).reduce((m,x)=>m+x.to-x.from,0);return(d>0?d+u:d)>=o}function iM(t,s){const{nodeExtensions:n}=Abe(s),a=n.find(o=>o.name===t);if(!a)return!1;const i={name:a.name,options:a.options,storage:a.storage},l=Qn($r(a,"group",i));return typeof l!="string"?!1:l.split(" ").includes("list")}function aU(t,{checkChildren:s=!0,ignoreWhitespace:n=!1}={}){var a;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((a=t.text)!==null&&a!==void 0?a:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(s){let i=!0;return t.content.forEach(l=>{i!==!1&&(aU(l,{ignoreWhitespace:n,checkChildren:s})||(i=!1))}),i}return!1}function Pve(t){return t instanceof Ct}function Ive(t,s,n){var a;const{selection:i}=s;let l=null;if(eU(i)&&(l=i.$cursor),l){const c=(a=t.storedMarks)!==null&&a!==void 0?a:l.marks();return!!n.isInSet(c)||!c.some(d=>d.type.excludes(n))}const{ranges:o}=i;return o.some(({$from:c,$to:d})=>{let u=c.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(c.pos,d.pos,(f,m,x)=>{if(u)return!1;if(f.isInline){const b=!x||x.type.allowsMarkType(n),w=!!n.isInSet(f.marks)||!f.marks.some(j=>j.type.excludes(n));u=b&&w}return!u}),u})}const Mve=(t,s={})=>({tr:n,state:a,dispatch:i})=>{const{selection:l}=n,{empty:o,ranges:c}=l,d=dd(t,a.schema);if(i)if(o){const u=kve(a,d);n.addStoredMark(d.create({...u,...s}))}else c.forEach(u=>{const f=u.$from.pos,m=u.$to.pos;a.doc.nodesBetween(f,m,(x,b)=>{const w=Math.max(b,f),j=Math.min(b+x.nodeSize,m);x.marks.find(C=>C.type===d)?x.marks.forEach(C=>{d===C.type&&n.addMark(w,j,d.create({...C.attrs,...s}))}):n.addMark(w,j,d.create(s))})});return Ive(a,n,d)},Dve=(t,s)=>({tr:n})=>(n.setMeta(t,s),!0),Ove=(t,s={})=>({state:n,dispatch:a,chain:i})=>{const l=Kr(t,n.schema);let o;return n.selection.$anchor.sameParent(n.selection.$head)&&(o=n.selection.$anchor.parent.attrs),l.isTextblock?i().command(({commands:c})=>Jy(l,{...o,...s})(n)?!0:c.clearNodes()).command(({state:c})=>Jy(l,{...o,...s})(c,a)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Rve=t=>({tr:s,dispatch:n})=>{if(n){const{doc:a}=s,i=zd(t,0,a.content.size),l=Ct.create(a,i);s.setSelection(l)}return!0},Lve=t=>({tr:s,dispatch:n})=>{if(n){const{doc:a}=s,{from:i,to:l}=typeof t=="number"?{from:t,to:t}:t,o=vt.atStart(a).from,c=vt.atEnd(a).to,d=zd(i,o,c),u=zd(l,o,c),f=vt.create(a,d,u);s.setSelection(f)}return!0},Bve=t=>({state:s,dispatch:n})=>{const a=Kr(t,s.schema);return cz(a)(s,n)};function lM(t,s){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const a=n.filter(i=>s==null?void 0:s.includes(i.type.name));t.tr.ensureMarks(a)}}const Fve=({keepMarks:t=!0}={})=>({tr:s,state:n,dispatch:a,editor:i})=>{const{selection:l,doc:o}=s,{$from:c,$to:d}=l,u=i.extensionManager.attributes,f=qg(u,c.node().type.name,c.node().attrs);if(l instanceof Ct&&l.node.isBlock)return!c.parentOffset||!Xa(o,c.pos)?!1:(a&&(t&&lM(n,i.extensionManager.splittableMarks),s.split(c.pos).scrollIntoView()),!0);if(!c.parent.isBlock)return!1;const m=d.parentOffset===d.parent.content.size,x=c.depth===0?void 0:Ave(c.node(-1).contentMatchAt(c.indexAfter(-1)));let b=m&&x?[{type:x,attrs:f}]:void 0,w=Xa(s.doc,s.mapping.map(c.pos),1,b);if(!b&&!w&&Xa(s.doc,s.mapping.map(c.pos),1,x?[{type:x}]:void 0)&&(w=!0,b=x?[{type:x,attrs:f}]:void 0),a){if(w&&(l instanceof vt&&s.deleteSelection(),s.split(s.mapping.map(c.pos),1,b),x&&!m&&!c.parentOffset&&c.parent.type!==x)){const j=s.mapping.map(c.before()),_=s.doc.resolve(j);c.node(-1).canReplaceWith(_.index(),_.index()+1,x)&&s.setNodeMarkup(s.mapping.map(c.before()),x)}t&&lM(n,i.extensionManager.splittableMarks),s.scrollIntoView()}return w},$ve=(t,s={})=>({tr:n,state:a,dispatch:i,editor:l})=>{var o;const c=Kr(t,a.schema),{$from:d,$to:u}=a.selection,f=a.selection.node;if(f&&f.isBlock||d.depth<2||!d.sameParent(u))return!1;const m=d.node(-1);if(m.type!==c)return!1;const x=l.extensionManager.attributes;if(d.parent.content.size===0&&d.node(-1).childCount===d.indexAfter(-1)){if(d.depth===2||d.node(-3).type!==c||d.index(-2)!==d.node(-2).childCount-1)return!1;if(i){let C=Fe.empty;const k=d.index(-1)?1:d.index(-2)?2:3;for(let O=d.depth-k;O>=d.depth-3;O-=1)C=Fe.from(d.node(O).copy(C));const A=d.indexAfter(-1)<d.node(-2).childCount?1:d.indexAfter(-2)<d.node(-3).childCount?2:3,T={...qg(x,d.node().type.name,d.node().attrs),...s},P=((o=c.contentMatch.defaultType)===null||o===void 0?void 0:o.createAndFill(T))||void 0;C=C.append(Fe.from(c.createAndFill(null,P)||void 0));const R=d.before(d.depth-(k-1));n.replace(R,d.after(-A),new nt(C,4-k,0));let I=-1;n.doc.nodesBetween(R,n.doc.content.size,(O,M)=>{if(I>-1)return!1;O.isTextblock&&O.content.size===0&&(I=M+1)}),I>-1&&n.setSelection(vt.near(n.doc.resolve(I))),n.scrollIntoView()}return!0}const b=u.pos===d.end()?m.contentMatchAt(0).defaultType:null,w={...qg(x,m.type.name,m.attrs),...s},j={...qg(x,d.node().type.name,d.node().attrs),...s};n.delete(d.pos,u.pos);const _=b?[{type:c,attrs:w},{type:b,attrs:j}]:[{type:c,attrs:w}];if(!Xa(n.doc,d.pos,2))return!1;if(i){const{selection:C,storedMarks:k}=a,{splittableMarks:A}=l.extensionManager,T=k||C.$to.parentOffset&&C.$from.marks();if(n.split(d.pos,2,_).scrollIntoView(),!T||!i)return!0;const P=T.filter(R=>A.includes(R.type.name));n.ensureMarks(P)}return!0},uj=(t,s)=>{const n=aA(o=>o.type===s)(t.selection);if(!n)return!0;const a=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(a===void 0)return!0;const i=t.doc.nodeAt(a);return n.node.type===(i==null?void 0:i.type)&&Zl(t.doc,n.pos)&&t.join(n.pos),!0},hj=(t,s)=>{const n=aA(o=>o.type===s)(t.selection);if(!n)return!0;const a=t.doc.resolve(n.start).after(n.depth);if(a===void 0)return!0;const i=t.doc.nodeAt(a);return n.node.type===(i==null?void 0:i.type)&&Zl(t.doc,a)&&t.join(a),!0},zve=(t,s,n,a={})=>({editor:i,tr:l,state:o,dispatch:c,chain:d,commands:u,can:f})=>{const{extensions:m,splittableMarks:x}=i.extensionManager,b=Kr(t,o.schema),w=Kr(s,o.schema),{selection:j,storedMarks:_}=o,{$from:C,$to:k}=j,A=C.blockRange(k),T=_||j.$to.parentOffset&&j.$from.marks();if(!A)return!1;const P=aA(R=>iM(R.type.name,m))(j);if(A.depth>=1&&P&&A.depth-P.depth<=1){if(P.node.type===b)return u.liftListItem(w);if(iM(P.node.type.name,m)&&b.validContent(P.node.content)&&c)return d().command(()=>(l.setNodeMarkup(P.pos,b),!0)).command(()=>uj(l,b)).command(()=>hj(l,b)).run()}return!n||!T||!c?d().command(()=>f().wrapInList(b,a)?!0:u.clearNodes()).wrapInList(b,a).command(()=>uj(l,b)).command(()=>hj(l,b)).run():d().command(()=>{const R=f().wrapInList(b,a),I=T.filter(O=>x.includes(O.type.name));return l.ensureMarks(I),R?!0:u.clearNodes()}).wrapInList(b,a).command(()=>uj(l,b)).command(()=>hj(l,b)).run()},Uve=(t,s={},n={})=>({state:a,commands:i})=>{const{extendEmptyMarkRange:l=!1}=n,o=dd(t,a.schema);return Tve(a,o,s)?i.unsetMark(o,{extendEmptyMarkRange:l}):i.setMark(o,s)},Vve=(t,s,n={})=>({state:a,commands:i})=>{const l=Kr(t,a.schema),o=Kr(s,a.schema),c=rA(a,l,n);let d;return a.selection.$anchor.sameParent(a.selection.$head)&&(d=a.selection.$anchor.parent.attrs),c?i.setNode(o,d):i.setNode(l,{...d,...n})},Hve=(t,s={})=>({state:n,commands:a})=>{const i=Kr(t,n.schema);return rA(n,i,s)?a.lift(i):a.wrapIn(i,s)},Wve=()=>({state:t,dispatch:s})=>{const n=t.plugins;for(let a=0;a<n.length;a+=1){const i=n[a];let l;if(i.spec.isInputRules&&(l=i.getState(t))){if(s){const o=t.tr,c=l.transform;for(let d=c.steps.length-1;d>=0;d-=1)o.step(c.steps[d].invert(c.docs[d]));if(l.text){const d=o.doc.resolve(l.from).marks();o.replaceWith(l.from,l.to,t.schema.text(l.text,d))}else o.delete(l.from,l.to)}return!0}}return!1},qve=()=>({tr:t,dispatch:s})=>{const{selection:n}=t,{empty:a,ranges:i}=n;return a||s&&i.forEach(l=>{t.removeMark(l.$from.pos,l.$to.pos)}),!0},Gve=(t,s={})=>({tr:n,state:a,dispatch:i})=>{var l;const{extendEmptyMarkRange:o=!1}=s,{selection:c}=n,d=dd(t,a.schema),{$from:u,empty:f,ranges:m}=c;if(!i)return!0;if(f&&o){let{from:x,to:b}=c;const w=(l=u.marks().find(_=>_.type===d))===null||l===void 0?void 0:l.attrs,j=sA(u,d,w);j&&(x=j.from,b=j.to),n.removeMark(x,b,d)}else m.forEach(x=>{n.removeMark(x.$from.pos,x.$to.pos,d)});return n.removeStoredMark(d),!0},Kve=(t,s={})=>({tr:n,state:a,dispatch:i})=>{let l=null,o=null;const c=nU(typeof t=="string"?t:t.name,a.schema);return c?(c==="node"&&(l=Kr(t,a.schema)),c==="mark"&&(o=dd(t,a.schema)),i&&n.selection.ranges.forEach(d=>{const u=d.$from.pos,f=d.$to.pos;let m,x,b,w;n.selection.empty?a.doc.nodesBetween(u,f,(j,_)=>{l&&l===j.type&&(b=Math.max(_,u),w=Math.min(_+j.nodeSize,f),m=_,x=j)}):a.doc.nodesBetween(u,f,(j,_)=>{_<u&&l&&l===j.type&&(b=Math.max(_,u),w=Math.min(_+j.nodeSize,f),m=_,x=j),_>=u&&_<=f&&(l&&l===j.type&&n.setNodeMarkup(_,void 0,{...j.attrs,...s}),o&&j.marks.length&&j.marks.forEach(C=>{if(o===C.type){const k=Math.max(_,u),A=Math.min(_+j.nodeSize,f);n.addMark(k,A,o.create({...C.attrs,...s}))}}))}),x&&(m!==void 0&&n.setNodeMarkup(m,void 0,{...x.attrs,...s}),o&&x.marks.length&&x.marks.forEach(j=>{o===j.type&&n.addMark(b,w,o.create({...j.attrs,...s}))}))}),!0):!1},Yve=(t,s={})=>({state:n,dispatch:a})=>{const i=Kr(t,n.schema);return iz(i,s)(n,a)},Xve=(t,s={})=>({state:n,dispatch:a})=>{const i=Kr(t,n.schema);return lz(i,s)(n,a)};var Qve=Object.freeze({__proto__:null,blur:Obe,clearContent:Rbe,clearNodes:Lbe,command:Bbe,createParagraphNear:Fbe,cut:$be,deleteCurrentNode:zbe,deleteNode:Ube,deleteRange:Vbe,deleteSelection:Hbe,enter:Wbe,exitCode:qbe,extendMarkRange:Gbe,first:Kbe,focus:Qbe,forEach:Zbe,insertContent:Jbe,insertContentAt:sve,joinBackward:ave,joinDown:rve,joinForward:ive,joinItemBackward:lve,joinItemForward:ove,joinTextblockBackward:cve,joinTextblockForward:dve,joinUp:nve,keyboardShortcut:hve,lift:fve,liftEmptyBlock:mve,liftListItem:pve,newlineInCode:xve,resetAttributes:gve,scrollIntoView:yve,selectAll:bve,selectNodeBackward:vve,selectNodeForward:wve,selectParentNode:Nve,selectTextblockEnd:jve,selectTextblockStart:_ve,setContent:Cve,setMark:Mve,setMeta:Dve,setNode:Ove,setNodeSelection:Rve,setTextSelection:Lve,sinkListItem:Bve,splitBlock:Fve,splitListItem:$ve,toggleList:zve,toggleMark:Uve,toggleNode:Vve,toggleWrap:Hve,undoInputRule:Wve,unsetAllMarks:qve,unsetMark:Gve,updateAttributes:Kve,wrapIn:Yve,wrapInList:Xve});aa.create({name:"commands",addCommands(){return{...Qve}}});aa.create({name:"drop",addProseMirrorPlugins(){return[new kn({key:new An("tiptapDrop"),props:{handleDrop:(t,s,n,a)=>{this.editor.emit("drop",{editor:this.editor,event:s,slice:n,moved:a})}}})]}});aa.create({name:"editable",addProseMirrorPlugins(){return[new kn({key:new An("editable"),props:{editable:()=>this.editor.options.editable}})]}});const Zve=new An("focusEvents");aa.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new kn({key:Zve,props:{handleDOMEvents:{focus:(s,n)=>{t.isFocused=!0;const a=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return s.dispatch(a),!1},blur:(s,n)=>{t.isFocused=!1;const a=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return s.dispatch(a),!1}}}})]}});aa.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:c})=>{const{selection:d,doc:u}=c,{empty:f,$anchor:m}=d,{pos:x,parent:b}=m,w=m.parent.isTextblock&&x>0?c.doc.resolve(x-1):m,j=w.parent.type.spec.isolating,_=m.pos-m.parentOffset,C=j&&w.parent.childCount===1?_===m.pos:Tt.atStart(u).from===x;return!f||!b.type.isTextblock||b.textContent.length||!C||C&&m.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),s=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),a={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:s,"Mod-Delete":s,"Mod-a":()=>this.editor.commands.selectAll()},i={...a},l={...a,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":s,"Ctrl-Alt-Backspace":s,"Alt-Delete":s,"Alt-d":s,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return nA()||sU()?l:i},addProseMirrorPlugins(){return[new kn({key:new An("clearDocument"),appendTransaction:(t,s,n)=>{if(t.some(j=>j.getMeta("composition")))return;const a=t.some(j=>j.docChanged)&&!s.doc.eq(n.doc),i=t.some(j=>j.getMeta("preventClearDocument"));if(!a||i)return;const{empty:l,from:o,to:c}=s.selection,d=Tt.atStart(s.doc).from,u=Tt.atEnd(s.doc).to;if(l||!(o===d&&c===u)||!aU(n.doc))return;const x=n.tr,b=Zz({state:n,transaction:x}),{commands:w}=new kbe({editor:this.editor,state:b});if(w.clearNodes(),!!x.steps.length)return x}})]}});aa.create({name:"paste",addProseMirrorPlugins(){return[new kn({key:new An("tiptapPaste"),props:{handlePaste:(t,s,n)=>{this.editor.emit("paste",{editor:this.editor,event:s,slice:n})}}})]}});aa.create({name:"tabindex",addProseMirrorPlugins(){return[new kn({key:new An("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});function lf(t){return new iv({find:t.find,handler:({state:s,range:n,match:a})=>{const i=Qn(t.getAttributes,void 0,a);if(i===!1||i===null)return null;const{tr:l}=s,o=a[a.length-1],c=a[0];if(o){const d=c.search(/\S/),u=n.from+c.indexOf(o),f=u+o.length;if(rU(n.from,n.to,s.doc).filter(b=>b.mark.type.excluded.find(j=>j===t.type&&j!==b.mark.type)).filter(b=>b.to>u).length)return null;f<n.to&&l.delete(f,n.to),u>n.from&&l.delete(n.from+d,u);const x=n.from+d+o.length;l.addMark(n.from+d,x,t.type.create(i||{})),l.removeStoredMark(t.type)}}})}function Jve(t){return new iv({find:t.find,handler:({state:s,range:n,match:a})=>{const i=Qn(t.getAttributes,void 0,a)||{},{tr:l}=s,o=n.from;let c=n.to;const d=t.type.create(i);if(a[1]){const u=a[0].lastIndexOf(a[1]);let f=o+u;f>c?f=c:c=f+a[1].length;const m=a[0][a[0].length-1];l.insertText(m,o+a[0].length-1),l.replaceWith(f,c,d)}else if(a[0]){const u=t.type.isInline?o:o-1;l.insert(u,t.type.create(i)).delete(l.mapping.map(o),l.mapping.map(c))}l.scrollIntoView()}})}function fS(t){return new iv({find:t.find,handler:({state:s,range:n,match:a})=>{const i=s.doc.resolve(n.from),l=Qn(t.getAttributes,void 0,a)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;s.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,l)}})}function Xp(t){return new iv({find:t.find,handler:({state:s,range:n,match:a,chain:i})=>{const l=Qn(t.getAttributes,void 0,a)||{},o=s.tr.delete(n.from,n.to),d=o.doc.resolve(n.from).blockRange(),u=d&&Ck(d,t.type,l);if(!u)return null;if(o.wrap(d,u),t.keepMarks&&t.editor){const{selection:m,storedMarks:x}=s,{splittableMarks:b}=t.editor.extensionManager,w=x||m.$to.parentOffset&&m.$from.marks();if(w){const j=w.filter(_=>b.includes(_.type.name));o.ensureMarks(j)}}if(t.keepAttributes){const m=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(m,l).run()}const f=o.doc.resolve(n.from-1).nodeBefore;f&&f.type===t.type&&Zl(o.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(a,f))&&o.join(n.from-1)}})}let dl=class mS{constructor(s={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...s},this.name=this.config.name,s.defaultOptions&&Object.keys(s.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Qn($r(this,"addOptions",{name:this.name}))),this.storage=Qn($r(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(s={}){return new mS(s)}configure(s={}){const n=this.extend({...this.config,addOptions:()=>lv(this.options,s)});return n.name=this.name,n.parent=this.parent,n}extend(s={}){const n=new mS(s);return n.parent=this,this.child=n,n.name=s.name?s.name:n.parent.name,s.defaultOptions&&Object.keys(s.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Qn($r(n,"addOptions",{name:n.name})),n.storage=Qn($r(n,"addStorage",{name:n.name,options:n.options})),n}};function of(t){return new Ibe({find:t.find,handler:({state:s,range:n,match:a,pasteEvent:i})=>{const l=Qn(t.getAttributes,void 0,a,i);if(l===!1||l===null)return null;const{tr:o}=s,c=a[a.length-1],d=a[0];let u=n.to;if(c){const f=d.search(/\S/),m=n.from+d.indexOf(c),x=m+c.length;if(rU(n.from,n.to,s.doc).filter(w=>w.mark.type.excluded.find(_=>_===t.type&&_!==w.mark.type)).filter(w=>w.to>m).length)return null;x<n.to&&o.delete(x,n.to),m>n.from&&o.delete(n.from+f,m),u=n.from+f+c.length,o.addMark(n.from+f,u,t.type.create(l||{})),o.removeStoredMark(t.type)}}})}function ewe(t,s){const{selection:n}=t,{$from:a}=n;if(n instanceof Ct){const l=a.index();return a.parent.canReplaceWith(l,l+1,s)}let i=a.depth;for(;i>=0;){const l=a.index(i);if(a.node(i).contentMatchAt(l).matchType(s))return!0;i-=1}return!1}const twe=/^\s*>\s$/,swe=dl.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return["blockquote",Ea(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Xp({find:twe,type:this.type})]}}),nwe=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,rwe=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,awe=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,iwe=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,lwe=bu.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",Ea(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[lf({find:nwe,type:this.type}),lf({find:awe,type:this.type})]},addPasteRules(){return[of({find:rwe,type:this.type}),of({find:iwe,type:this.type})]}}),owe="listItem",oM="textStyle",cM=/^\s*([-+*])\s$/,cwe=dl.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",Ea(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t,chain:s})=>this.options.keepAttributes?s().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(owe,this.editor.getAttributes(oM)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=Xp({find:cM,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Xp({find:cM,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(oM),editor:this.editor})),[t]}}),dwe=/(^|[^`])`([^`]+)`(?!`)/,uwe=/(^|[^`])`([^`]+)`(?!`)/g,hwe=bu.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",Ea(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[lf({find:dwe,type:this.type})]},addPasteRules(){return[of({find:uwe,type:this.type})]}}),fwe=/^```([a-z]+)?[\s\n]$/,mwe=/^~~~([a-z]+)?[\s\n]$/,pwe=dl.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var s;const{languageClassPrefix:n}=this.options,l=[...((s=t.firstElementChild)===null||s===void 0?void 0:s.classList)||[]].filter(o=>o.startsWith(n)).map(o=>o.replace(n,""))[0];return l||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:s}){return["pre",Ea(this.options.HTMLAttributes,s),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:s})=>s.setNode(this.name,t),toggleCodeBlock:t=>({commands:s})=>s.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:s}=this.editor.state.selection,n=s.pos===1;return!t||s.parent.type.name!==this.name?!1:n||!s.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:s}=t,{selection:n}=s,{$from:a,empty:i}=n;if(!i||a.parent.type!==this.type)return!1;const l=a.parentOffset===a.parent.nodeSize-2,o=a.parent.textContent.endsWith(`

`);return!l||!o?!1:t.chain().command(({tr:c})=>(c.delete(a.pos-2,a.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:s}=t,{selection:n,doc:a}=s,{$from:i,empty:l}=n;if(!l||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const c=i.after();return c===void 0?!1:a.nodeAt(c)?t.commands.command(({tr:u})=>(u.setSelection(Tt.near(a.resolve(c))),!0)):t.commands.exitCode()}}},addInputRules(){return[fS({find:fwe,type:this.type,getAttributes:t=>({language:t[1]})}),fS({find:mwe,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new kn({key:new An("codeBlockVSCodeHandler"),props:{handlePaste:(t,s)=>{if(!s.clipboardData||this.editor.isActive(this.type.name))return!1;const n=s.clipboardData.getData("text/plain"),a=s.clipboardData.getData("vscode-editor-data"),i=a?JSON.parse(a):void 0,l=i==null?void 0:i.mode;if(!n||!l)return!1;const{tr:o,schema:c}=t.state,d=c.text(n.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:l},d)),o.selection.$from.parent.type!==this.type&&o.setSelection(vt.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),t.dispatch(o),!0}}})]}}),xwe=dl.create({name:"doc",topNode:!0,content:"block+"});function gwe(t={}){return new kn({view(s){return new ywe(s,t)}})}class ywe{constructor(s,n){var a;this.editorView=s,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(a=n.width)!==null&&a!==void 0?a:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let l=o=>{this[i](o)};return s.dom.addEventListener(i,l),{name:i,handler:l}})}destroy(){this.handlers.forEach(({name:s,handler:n})=>this.editorView.dom.removeEventListener(s,n))}update(s,n){this.cursorPos!=null&&n.doc!=s.state.doc&&(this.cursorPos>s.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(s){s!=this.cursorPos&&(this.cursorPos=s,s==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let s=this.editorView.state.doc.resolve(this.cursorPos),n=!s.parent.inlineContent,a,i=this.editorView.dom,l=i.getBoundingClientRect(),o=l.width/i.offsetWidth,c=l.height/i.offsetHeight;if(n){let m=s.nodeBefore,x=s.nodeAfter;if(m||x){let b=this.editorView.nodeDOM(this.cursorPos-(m?m.nodeSize:0));if(b){let w=b.getBoundingClientRect(),j=m?w.bottom:w.top;m&&x&&(j=(j+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let _=this.width/2*c;a={left:w.left,right:w.right,top:j-_,bottom:j+_}}}}if(!a){let m=this.editorView.coordsAtPos(this.cursorPos),x=this.width/2*o;a={left:m.left-x,right:m.left+x,top:m.top,bottom:m.bottom}}let d=this.editorView.dom.offsetParent;this.element||(this.element=d.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let u,f;if(!d||d==document.body&&getComputedStyle(d).position=="static")u=-pageXOffset,f=-pageYOffset;else{let m=d.getBoundingClientRect(),x=m.width/d.offsetWidth,b=m.height/d.offsetHeight;u=m.left-d.scrollLeft*x,f=m.top-d.scrollTop*b}this.element.style.left=(a.left-u)/o+"px",this.element.style.top=(a.top-f)/c+"px",this.element.style.width=(a.right-a.left)/o+"px",this.element.style.height=(a.bottom-a.top)/c+"px"}scheduleRemoval(s){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),s)}dragover(s){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:s.clientX,top:s.clientY}),a=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),i=a&&a.type.spec.disableDropCursor,l=typeof i=="function"?i(this.editorView,n,s):i;if(n&&!l){let o=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let c=L$(this.editorView.state.doc,o,this.editorView.dragging.slice);c!=null&&(o=c)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(s){this.editorView.dom.contains(s.relatedTarget)||this.setCursor(null)}}const bwe=aa.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[gwe(this.options)]}});class pn extends Tt{constructor(s){super(s,s)}map(s,n){let a=s.resolve(n.map(this.head));return pn.valid(a)?new pn(a):Tt.near(a)}content(){return nt.empty}eq(s){return s instanceof pn&&s.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(s,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new pn(s.resolve(n.pos))}getBookmark(){return new iA(this.anchor)}static valid(s){let n=s.parent;if(n.isTextblock||!vwe(s)||!wwe(s))return!1;let a=n.type.spec.allowGapCursor;if(a!=null)return a;let i=n.contentMatchAt(s.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(s,n,a=!1){e:for(;;){if(!a&&pn.valid(s))return s;let i=s.pos,l=null;for(let o=s.depth;;o--){let c=s.node(o);if(n>0?s.indexAfter(o)<c.childCount:s.index(o)>0){l=c.child(n>0?s.indexAfter(o):s.index(o)-1);break}else if(o==0)return null;i+=n;let d=s.doc.resolve(i);if(pn.valid(d))return d}for(;;){let o=n>0?l.firstChild:l.lastChild;if(!o){if(l.isAtom&&!l.isText&&!Ct.isSelectable(l)){s=s.doc.resolve(i+l.nodeSize*n),a=!1;continue e}break}l=o,i+=n;let c=s.doc.resolve(i);if(pn.valid(c))return c}return null}}}pn.prototype.visible=!1;pn.findFrom=pn.findGapCursorFrom;Tt.jsonID("gapcursor",pn);class iA{constructor(s){this.pos=s}map(s){return new iA(s.map(this.pos))}resolve(s){let n=s.resolve(this.pos);return pn.valid(n)?new pn(n):Tt.near(n)}}function iU(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}function vwe(t){for(let s=t.depth;s>=0;s--){let n=t.index(s),a=t.node(s);if(n==0){if(a.type.spec.isolating)return!0;continue}for(let i=a.child(n-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||iU(i.type))return!0;if(i.inlineContent)return!1}}return!0}function wwe(t){for(let s=t.depth;s>=0;s--){let n=t.indexAfter(s),a=t.node(s);if(n==a.childCount){if(a.type.spec.isolating)return!0;continue}for(let i=a.child(n);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||iU(i.type))return!0;if(i.inlineContent)return!1}}return!0}function Nwe(){return new kn({props:{decorations:Cwe,createSelectionBetween(t,s,n){return s.pos==n.pos&&pn.valid(n)?new pn(n):null},handleClick:_we,handleKeyDown:jwe,handleDOMEvents:{beforeinput:Swe}}})}const jwe=Dz({ArrowLeft:G0("horiz",-1),ArrowRight:G0("horiz",1),ArrowUp:G0("vert",-1),ArrowDown:G0("vert",1)});function G0(t,s){const n=t=="vert"?s>0?"down":"up":s>0?"right":"left";return function(a,i,l){let o=a.selection,c=s>0?o.$to:o.$from,d=o.empty;if(o instanceof vt){if(!l.endOfTextblock(n)||c.depth==0)return!1;d=!1,c=a.doc.resolve(s>0?c.after():c.before())}let u=pn.findGapCursorFrom(c,s,d);return u?(i&&i(a.tr.setSelection(new pn(u))),!0):!1}}function _we(t,s,n){if(!t||!t.editable)return!1;let a=t.state.doc.resolve(s);if(!pn.valid(a))return!1;let i=t.posAtCoords({left:n.clientX,top:n.clientY});return i&&i.inside>-1&&Ct.isSelectable(t.state.doc.nodeAt(i.inside))?!1:(t.dispatch(t.state.tr.setSelection(new pn(a))),!0)}function Swe(t,s){if(s.inputType!="insertCompositionText"||!(t.state.selection instanceof pn))return!1;let{$from:n}=t.state.selection,a=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!a)return!1;let i=Fe.empty;for(let o=a.length-1;o>=0;o--)i=Fe.from(a[o].createAndFill(null,i));let l=t.state.tr.replace(n.pos,n.pos,new nt(i,0,0));return l.setSelection(vt.near(l.doc.resolve(n.pos+1))),t.dispatch(l),!1}function Cwe(t){if(!(t.selection instanceof pn))return null;let s=document.createElement("div");return s.className="ProseMirror-gapcursor",jn.create(t.doc,[Ga.widget(t.selection.head,s,{key:"gapcursor"})])}const kwe=aa.create({name:"gapCursor",addProseMirrorPlugins(){return[Nwe()]},extendNodeSchema(t){var s;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(s=Qn($r(t,"allowGapCursor",n)))!==null&&s!==void 0?s:null}}}),Awe=dl.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",Ea(this.options.HTMLAttributes,t)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:t,chain:s,state:n,editor:a})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:i,storedMarks:l}=n;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:c}=a.extensionManager,d=l||i.$to.parentOffset&&i.$from.marks();return s().insertContent({type:this.name}).command(({tr:u,dispatch:f})=>{if(f&&d&&o){const m=d.filter(x=>c.includes(x.type.name));u.ensureMarks(m)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Ewe=dl.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:s}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,Ea(this.options.HTMLAttributes,s),0]},addCommands(){return{setHeading:t=>({commands:s})=>this.options.levels.includes(t.level)?s.setNode(this.name,t):!1,toggleHeading:t=>({commands:s})=>this.options.levels.includes(t.level)?s.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,s)=>({...t,[`Mod-Alt-${s}`]:()=>this.editor.commands.toggleHeading({level:s})}),{})},addInputRules(){return this.options.levels.map(t=>fS({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}});var o1=200,hr=function(){};hr.prototype.append=function(s){return s.length?(s=hr.from(s),!this.length&&s||s.length<o1&&this.leafAppend(s)||this.length<o1&&s.leafPrepend(this)||this.appendInner(s)):this};hr.prototype.prepend=function(s){return s.length?hr.from(s).append(this):this};hr.prototype.appendInner=function(s){return new Twe(this,s)};hr.prototype.slice=function(s,n){return s===void 0&&(s=0),n===void 0&&(n=this.length),s>=n?hr.empty:this.sliceInner(Math.max(0,s),Math.min(this.length,n))};hr.prototype.get=function(s){if(!(s<0||s>=this.length))return this.getInner(s)};hr.prototype.forEach=function(s,n,a){n===void 0&&(n=0),a===void 0&&(a=this.length),n<=a?this.forEachInner(s,n,a,0):this.forEachInvertedInner(s,n,a,0)};hr.prototype.map=function(s,n,a){n===void 0&&(n=0),a===void 0&&(a=this.length);var i=[];return this.forEach(function(l,o){return i.push(s(l,o))},n,a),i};hr.from=function(s){return s instanceof hr?s:s&&s.length?new lU(s):hr.empty};var lU=function(t){function s(a){t.call(this),this.values=a}t&&(s.__proto__=t),s.prototype=Object.create(t&&t.prototype),s.prototype.constructor=s;var n={length:{configurable:!0},depth:{configurable:!0}};return s.prototype.flatten=function(){return this.values},s.prototype.sliceInner=function(i,l){return i==0&&l==this.length?this:new s(this.values.slice(i,l))},s.prototype.getInner=function(i){return this.values[i]},s.prototype.forEachInner=function(i,l,o,c){for(var d=l;d<o;d++)if(i(this.values[d],c+d)===!1)return!1},s.prototype.forEachInvertedInner=function(i,l,o,c){for(var d=l-1;d>=o;d--)if(i(this.values[d],c+d)===!1)return!1},s.prototype.leafAppend=function(i){if(this.length+i.length<=o1)return new s(this.values.concat(i.flatten()))},s.prototype.leafPrepend=function(i){if(this.length+i.length<=o1)return new s(i.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(s.prototype,n),s}(hr);hr.empty=new lU([]);var Twe=function(t){function s(n,a){t.call(this),this.left=n,this.right=a,this.length=n.length+a.length,this.depth=Math.max(n.depth,a.depth)+1}return t&&(s.__proto__=t),s.prototype=Object.create(t&&t.prototype),s.prototype.constructor=s,s.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},s.prototype.getInner=function(a){return a<this.left.length?this.left.get(a):this.right.get(a-this.left.length)},s.prototype.forEachInner=function(a,i,l,o){var c=this.left.length;if(i<c&&this.left.forEachInner(a,i,Math.min(l,c),o)===!1||l>c&&this.right.forEachInner(a,Math.max(i-c,0),Math.min(this.length,l)-c,o+c)===!1)return!1},s.prototype.forEachInvertedInner=function(a,i,l,o){var c=this.left.length;if(i>c&&this.right.forEachInvertedInner(a,i-c,Math.max(l,c)-c,o+c)===!1||l<c&&this.left.forEachInvertedInner(a,Math.min(i,c),l,o)===!1)return!1},s.prototype.sliceInner=function(a,i){if(a==0&&i==this.length)return this;var l=this.left.length;return i<=l?this.left.slice(a,i):a>=l?this.right.slice(a-l,i-l):this.left.slice(a,l).append(this.right.slice(0,i-l))},s.prototype.leafAppend=function(a){var i=this.right.leafAppend(a);if(i)return new s(this.left,i)},s.prototype.leafPrepend=function(a){var i=this.left.leafPrepend(a);if(i)return new s(i,this.right)},s.prototype.appendInner=function(a){return this.left.depth>=Math.max(this.right.depth,a.depth)+1?new s(this.left,new s(this.right,a)):new s(this,a)},s}(hr);const Pwe=500;class Yi{constructor(s,n){this.items=s,this.eventCount=n}popEvent(s,n){if(this.eventCount==0)return null;let a=this.items.length;for(;;a--)if(this.items.get(a-1).selection){--a;break}let i,l;n&&(i=this.remapping(a,this.items.length),l=i.maps.length);let o=s.tr,c,d,u=[],f=[];return this.items.forEach((m,x)=>{if(!m.step){i||(i=this.remapping(a,x+1),l=i.maps.length),l--,f.push(m);return}if(i){f.push(new Cl(m.map));let b=m.step.map(i.slice(l)),w;b&&o.maybeStep(b).doc&&(w=o.mapping.maps[o.mapping.maps.length-1],u.push(new Cl(w,void 0,void 0,u.length+f.length))),l--,w&&i.appendMap(w,l)}else o.maybeStep(m.step);if(m.selection)return c=i?m.selection.map(i.slice(l)):m.selection,d=new Yi(this.items.slice(0,a).append(f.reverse().concat(u)),this.eventCount-1),!1},this.items.length,0),{remaining:d,transform:o,selection:c}}addTransform(s,n,a,i){let l=[],o=this.eventCount,c=this.items,d=!i&&c.length?c.get(c.length-1):null;for(let f=0;f<s.steps.length;f++){let m=s.steps[f].invert(s.docs[f]),x=new Cl(s.mapping.maps[f],m,n),b;(b=d&&d.merge(x))&&(x=b,f?l.pop():c=c.slice(0,c.length-1)),l.push(x),n&&(o++,n=void 0),i||(d=x)}let u=o-a.depth;return u>Mwe&&(c=Iwe(c,u),o-=u),new Yi(c.append(l),o)}remapping(s,n){let a=new Hp;return this.items.forEach((i,l)=>{let o=i.mirrorOffset!=null&&l-i.mirrorOffset>=s?a.maps.length-i.mirrorOffset:void 0;a.appendMap(i.map,o)},s,n),a}addMaps(s){return this.eventCount==0?this:new Yi(this.items.append(s.map(n=>new Cl(n))),this.eventCount)}rebased(s,n){if(!this.eventCount)return this;let a=[],i=Math.max(0,this.items.length-n),l=s.mapping,o=s.steps.length,c=this.eventCount;this.items.forEach(x=>{x.selection&&c--},i);let d=n;this.items.forEach(x=>{let b=l.getMirror(--d);if(b==null)return;o=Math.min(o,b);let w=l.maps[b];if(x.step){let j=s.steps[b].invert(s.docs[b]),_=x.selection&&x.selection.map(l.slice(d+1,b));_&&c++,a.push(new Cl(w,j,_))}else a.push(new Cl(w))},i);let u=[];for(let x=n;x<o;x++)u.push(new Cl(l.maps[x]));let f=this.items.slice(0,i).append(u).append(a),m=new Yi(f,c);return m.emptyItemCount()>Pwe&&(m=m.compress(this.items.length-a.length)),m}emptyItemCount(){let s=0;return this.items.forEach(n=>{n.step||s++}),s}compress(s=this.items.length){let n=this.remapping(0,s),a=n.maps.length,i=[],l=0;return this.items.forEach((o,c)=>{if(c>=s)i.push(o),o.selection&&l++;else if(o.step){let d=o.step.map(n.slice(a)),u=d&&d.getMap();if(a--,u&&n.appendMap(u,a),d){let f=o.selection&&o.selection.map(n.slice(a));f&&l++;let m=new Cl(u.invert(),d,f),x,b=i.length-1;(x=i.length&&i[b].merge(m))?i[b]=x:i.push(m)}}else o.map&&a--},this.items.length,0),new Yi(hr.from(i.reverse()),l)}}Yi.empty=new Yi(hr.empty,0);function Iwe(t,s){let n;return t.forEach((a,i)=>{if(a.selection&&s--==0)return n=i,!1}),t.slice(n)}class Cl{constructor(s,n,a,i){this.map=s,this.step=n,this.selection=a,this.mirrorOffset=i}merge(s){if(this.step&&s.step&&!s.selection){let n=s.step.merge(this.step);if(n)return new Cl(n.getMap().invert(),n,this.selection)}}}class dc{constructor(s,n,a,i,l){this.done=s,this.undone=n,this.prevRanges=a,this.prevTime=i,this.prevComposition=l}}const Mwe=20;function Dwe(t,s,n,a){let i=n.getMeta(tu),l;if(i)return i.historyState;n.getMeta(Lwe)&&(t=new dc(t.done,t.undone,null,0,-1));let o=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(o&&o.getMeta(tu))return o.getMeta(tu).redo?new dc(t.done.addTransform(n,void 0,a,Gg(s)),t.undone,dM(n.mapping.maps),t.prevTime,t.prevComposition):new dc(t.done,t.undone.addTransform(n,void 0,a,Gg(s)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let c=n.getMeta("composition"),d=t.prevTime==0||!o&&t.prevComposition!=c&&(t.prevTime<(n.time||0)-a.newGroupDelay||!Owe(n,t.prevRanges)),u=o?fj(t.prevRanges,n.mapping):dM(n.mapping.maps);return new dc(t.done.addTransform(n,d?s.selection.getBookmark():void 0,a,Gg(s)),Yi.empty,u,n.time,c??t.prevComposition)}else return(l=n.getMeta("rebased"))?new dc(t.done.rebased(n,l),t.undone.rebased(n,l),fj(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new dc(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),fj(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function Owe(t,s){if(!s)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((a,i)=>{for(let l=0;l<s.length;l+=2)a<=s[l+1]&&i>=s[l]&&(n=!0)}),n}function dM(t){let s=[];for(let n=t.length-1;n>=0&&s.length==0;n--)t[n].forEach((a,i,l,o)=>s.push(l,o));return s}function fj(t,s){if(!t)return null;let n=[];for(let a=0;a<t.length;a+=2){let i=s.map(t[a],1),l=s.map(t[a+1],-1);i<=l&&n.push(i,l)}return n}function Rwe(t,s,n){let a=Gg(s),i=tu.get(s).spec.config,l=(n?t.undone:t.done).popEvent(s,a);if(!l)return null;let o=l.selection.resolve(l.transform.doc),c=(n?t.done:t.undone).addTransform(l.transform,s.selection.getBookmark(),i,a),d=new dc(n?c:l.remaining,n?l.remaining:c,null,0,-1);return l.transform.setSelection(o).setMeta(tu,{redo:n,historyState:d})}let mj=!1,uM=null;function Gg(t){let s=t.plugins;if(uM!=s){mj=!1,uM=s;for(let n=0;n<s.length;n++)if(s[n].spec.historyPreserveItems){mj=!0;break}}return mj}const tu=new An("history"),Lwe=new An("closeHistory");function Bwe(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new kn({key:tu,state:{init(){return new dc(Yi.empty,Yi.empty,null,0,-1)},apply(s,n,a){return Dwe(n,a,s,t)}},config:t,props:{handleDOMEvents:{beforeinput(s,n){let a=n.inputType,i=a=="historyUndo"?cU:a=="historyRedo"?dU:null;return i?(n.preventDefault(),i(s.state,s.dispatch)):!1}}}})}function oU(t,s){return(n,a)=>{let i=tu.getState(n);if(!i||(t?i.undone:i.done).eventCount==0)return!1;if(a){let l=Rwe(i,n,t);l&&a(s?l.scrollIntoView():l)}return!0}}const cU=oU(!1,!0),dU=oU(!0,!0),Fwe=aa.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:s})=>cU(t,s),redo:()=>({state:t,dispatch:s})=>dU(t,s)}},addProseMirrorPlugins(){return[Bwe(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),$we=dl.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",Ea(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t,state:s})=>{if(!ewe(s,s.schema.nodes[this.name]))return!1;const{selection:n}=s,{$from:a,$to:i}=n,l=t();return a.parentOffset===0?l.insertContentAt({from:Math.max(a.pos-1,0),to:i.pos},{type:this.name}):Pve(n)?l.insertContentAt(i.pos,{type:this.name}):l.insertContent({type:this.name}),l.command(({tr:o,dispatch:c})=>{var d;if(c){const{$to:u}=o.selection,f=u.end();if(u.nodeAfter)u.nodeAfter.isTextblock?o.setSelection(vt.create(o.doc,u.pos+1)):u.nodeAfter.isBlock?o.setSelection(Ct.create(o.doc,u.pos)):o.setSelection(vt.create(o.doc,u.pos));else{const m=(d=u.parent.type.contentMatch.defaultType)===null||d===void 0?void 0:d.create();m&&(o.insert(f,m),o.setSelection(vt.create(o.doc,f+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[Jve({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),zwe=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,Uwe=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,Vwe=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,Hwe=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,Wwe=bu.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",Ea(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[lf({find:zwe,type:this.type}),lf({find:Vwe,type:this.type})]},addPasteRules(){return[of({find:Uwe,type:this.type}),of({find:Hwe,type:this.type})]}}),qwe=dl.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",Ea(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Gwe="listItem",hM="textStyle",fM=/^(\d+)\.\s$/,Kwe=dl.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:s,...n}=t;return s===1?["ol",Ea(this.options.HTMLAttributes,n),0]:["ol",Ea(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:s})=>this.options.keepAttributes?s().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Gwe,this.editor.getAttributes(hM)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=Xp({find:fM,type:this.type,getAttributes:s=>({start:+s[1]}),joinPredicate:(s,n)=>n.childCount+n.attrs.start===+s[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Xp({find:fM,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:s=>({start:+s[1],...this.editor.getAttributes(hM)}),joinPredicate:(s,n)=>n.childCount+n.attrs.start===+s[1],editor:this.editor})),[t]}}),Ywe=dl.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",Ea(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Xwe=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,Qwe=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,Zwe=bu.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",Ea(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[lf({find:Xwe,type:this.type})]},addPasteRules(){return[of({find:Qwe,type:this.type})]}}),Jwe=dl.create({name:"text",group:"inline"});aa.create({name:"starterKit",addExtensions(){const t=[];return this.options.bold!==!1&&t.push(lwe.configure(this.options.bold)),this.options.blockquote!==!1&&t.push(swe.configure(this.options.blockquote)),this.options.bulletList!==!1&&t.push(cwe.configure(this.options.bulletList)),this.options.code!==!1&&t.push(hwe.configure(this.options.code)),this.options.codeBlock!==!1&&t.push(pwe.configure(this.options.codeBlock)),this.options.document!==!1&&t.push(xwe.configure(this.options.document)),this.options.dropcursor!==!1&&t.push(bwe.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&t.push(kwe.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&t.push(Awe.configure(this.options.hardBreak)),this.options.heading!==!1&&t.push(Ewe.configure(this.options.heading)),this.options.history!==!1&&t.push(Fwe.configure(this.options.history)),this.options.horizontalRule!==!1&&t.push($we.configure(this.options.horizontalRule)),this.options.italic!==!1&&t.push(Wwe.configure(this.options.italic)),this.options.listItem!==!1&&t.push(qwe.configure(this.options.listItem)),this.options.orderedList!==!1&&t.push(Kwe.configure(this.options.orderedList)),this.options.paragraph!==!1&&t.push(Ywe.configure(this.options.paragraph)),this.options.strike!==!1&&t.push(Zwe.configure(this.options.strike)),this.options.text!==!1&&t.push(Jwe.configure(this.options.text)),t}});var eNe=20,uU=(t,s=0)=>{const n=[];return!t.children.length||s>eNe||Array.from(t.children).forEach(a=>{a.tagName==="SPAN"?n.push(a):a.children.length&&n.push(...uU(a,s+1))}),n},tNe=t=>{if(!t.children.length)return;const s=uU(t);s&&s.forEach(n=>{var a,i;const l=n.getAttribute("style"),o=(i=(a=n.parentElement)==null?void 0:a.closest("span"))==null?void 0:i.getAttribute("style");n.setAttribute("style",`${o};${l}`)})},sNe=Jk.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!0}},parseHTML(){return[{tag:"span",consuming:!1,getAttrs:t=>t.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&tNe(t),{}):!1}]},renderHTML({HTMLAttributes:t}){return["span",cd(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleTextStyle:t=>({commands:s})=>s.toggleMark(this.name,t),removeEmptyTextStyle:()=>({tr:t})=>{const{selection:s}=t;return t.doc.nodesBetween(s.from,s.to,(n,a)=>{if(n.isTextblock)return!0;n.marks.filter(i=>i.type===this.type).some(i=>Object.values(i.attrs).some(l=>!!l))||t.removeMark(a,a+n.nodeSize,this.type)}),!0}}}}),nNe=mr.create({name:"backgroundColor",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,parseHTML:t=>{var s;const n=t.getAttribute("style");if(n){const a=n.split(";").map(i=>i.trim()).filter(Boolean);for(let i=a.length-1;i>=0;i-=1){const l=a[i].split(":");if(l.length>=2){const o=l[0].trim().toLowerCase(),c=l.slice(1).join(":").trim();if(o==="background-color")return c.replace(/['"]+/g,"")}}}return(s=t.style.backgroundColor)==null?void 0:s.replace(/['"]+/g,"")},renderHTML:t=>t.backgroundColor?{style:`background-color: ${t.backgroundColor}`}:{}}}}]},addCommands(){return{setBackgroundColor:t=>({chain:s})=>s().setMark("textStyle",{backgroundColor:t}).run(),unsetBackgroundColor:()=>({chain:t})=>t().setMark("textStyle",{backgroundColor:null}).removeEmptyTextStyle().run()}}}),rNe=mr.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:t=>{var s;const n=t.getAttribute("style");if(n){const a=n.split(";").map(i=>i.trim()).filter(Boolean);for(let i=a.length-1;i>=0;i-=1){const l=a[i].split(":");if(l.length>=2){const o=l[0].trim().toLowerCase(),c=l.slice(1).join(":").trim();if(o==="color")return c.replace(/['"]+/g,"")}}}return(s=t.style.color)==null?void 0:s.replace(/['"]+/g,"")},renderHTML:t=>t.color?{style:`color: ${t.color}`}:{}}}}]},addCommands(){return{setColor:t=>({chain:s})=>s().setMark("textStyle",{color:t}).run(),unsetColor:()=>({chain:t})=>t().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),aNe=mr.create({name:"fontFamily",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:t=>t.style.fontFamily,renderHTML:t=>t.fontFamily?{style:`font-family: ${t.fontFamily}`}:{}}}}]},addCommands(){return{setFontFamily:t=>({chain:s})=>s().setMark("textStyle",{fontFamily:t}).run(),unsetFontFamily:()=>({chain:t})=>t().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}}}),iNe=mr.create({name:"fontSize",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:t=>t.style.fontSize,renderHTML:t=>t.fontSize?{style:`font-size: ${t.fontSize}`}:{}}}}]},addCommands(){return{setFontSize:t=>({chain:s})=>s().setMark("textStyle",{fontSize:t}).run(),unsetFontSize:()=>({chain:t})=>t().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()}}}),lNe=mr.create({name:"lineHeight",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{lineHeight:{default:null,parseHTML:t=>t.style.lineHeight,renderHTML:t=>t.lineHeight?{style:`line-height: ${t.lineHeight}`}:{}}}}]},addCommands(){return{setLineHeight:t=>({chain:s})=>s().setMark("textStyle",{lineHeight:t}).run(),unsetLineHeight:()=>({chain:t})=>t().setMark("textStyle",{lineHeight:null}).removeEmptyTextStyle().run()}}});mr.create({name:"textStyleKit",addExtensions(){const t=[];return this.options.backgroundColor!==!1&&t.push(nNe.configure(this.options.backgroundColor)),this.options.color!==!1&&t.push(rNe.configure(this.options.color)),this.options.fontFamily!==!1&&t.push(aNe.configure(this.options.fontFamily)),this.options.fontSize!==!1&&t.push(iNe.configure(this.options.fontSize)),this.options.lineHeight!==!1&&t.push(lNe.configure(this.options.lineHeight)),this.options.textStyle!==!1&&t.push(sNe.configure(this.options.textStyle)),t}});Jk.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",cd(this.options.HTMLAttributes,t),0]},parseMarkdown(t,s){return s.applyMark(this.name||"underline",s.parseInline(t.tokens||[]))},renderMarkdown(t,s){return`++${s.renderChildren(t)}++`},markdownTokenizer:{name:"underline",level:"inline",start(t){return t.indexOf("++")},tokenize(t,s,n){const i=/^(\+\+)([\s\S]+?)(\+\+)/.exec(t);if(!i)return;const l=i[2].trim();return{type:"underline",raw:i[0],text:l,tokens:n.inlineTokens(l)}}},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});var oNe=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,cNe=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g;Jk.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:t=>t.getAttribute("data-color")||t.style.backgroundColor,renderHTML:t=>t.color?{"data-color":t.color,style:`background-color: ${t.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:t}){return["mark",cd(this.options.HTMLAttributes,t),0]},renderMarkdown:(t,s)=>`==${s.renderChildren(t)}==`,parseMarkdown:(t,s)=>s.applyMark("highlight",s.parseInline(t.tokens||[])),markdownTokenizer:{name:"highlight",level:"inline",start:t=>t.indexOf("=="),tokenize(t,s,n){const i=/^(==)([^=]+)(==)/.exec(t);if(i){const l=i[2].trim(),o=n.inlineTokens(l);return{type:"highlight",raw:i[0],text:l,tokens:o}}}},addCommands(){return{setHighlight:t=>({commands:s})=>s.setMark(this.name,t),toggleHighlight:t=>({commands:s})=>s.toggleMark(this.name,t),unsetHighlight:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[mbe({find:oNe,type:this.type})]},addPasteRules(){return[Cbe({find:cNe,type:this.type})]}});mr.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:null}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:t=>{const s=t.style.textAlign;return this.options.alignments.includes(s)?s:this.options.defaultAlignment},renderHTML:t=>t.textAlign?{style:`text-align: ${t.textAlign}`}:{}}}}]},addCommands(){return{setTextAlign:t=>({commands:s})=>this.options.alignments.includes(t)?this.options.types.map(n=>s.updateAttributes(n,{textAlign:t})).every(n=>n):!1,unsetTextAlign:()=>({commands:t})=>this.options.types.map(s=>t.resetAttributes(s,"textAlign")).every(s=>s),toggleTextAlign:t=>({editor:s,commands:n})=>this.options.alignments.includes(t)?s.isActive({textAlign:t})?n.unsetTextAlign():n.setTextAlign(t):!1}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}});var dNe=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/;Ix.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{},resize:!1}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null},width:{default:null},height:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:t}){return["img",cd(this.options.HTMLAttributes,t)]},parseMarkdown:(t,s)=>s.createNode("image",{src:t.href,title:t.title,alt:t.text}),renderMarkdown:t=>{var s,n,a,i,l,o;const c=(n=(s=t.attrs)==null?void 0:s.src)!=null?n:"",d=(i=(a=t.attrs)==null?void 0:a.alt)!=null?i:"",u=(o=(l=t.attrs)==null?void 0:l.title)!=null?o:"";return u?`![${d}](${c} "${u}")`:`![${d}](${c})`},addNodeView(){if(!this.options.resize||!this.options.resize.enabled||typeof document>"u")return null;const{directions:t,minWidth:s,minHeight:n,alwaysPreserveAspectRatio:a}=this.options.resize;return({node:i,getPos:l,HTMLAttributes:o,editor:c})=>{const d=document.createElement("img");Object.entries(o).forEach(([m,x])=>{if(x!=null)switch(m){case"width":case"height":break;default:d.setAttribute(m,x);break}}),d.src=o.src;const u=new gbe({element:d,editor:c,node:i,getPos:l,onResize:(m,x)=>{d.style.width=`${m}px`,d.style.height=`${x}px`},onCommit:(m,x)=>{const b=l();b!==void 0&&this.editor.chain().setNodeSelection(b).updateAttributes(this.name,{width:m,height:x}).run()},onUpdate:(m,x,b)=>m.type===i.type,options:{directions:t,min:{width:s,height:n},preserveAspectRatio:a===!0}}),f=u.dom;return f.style.visibility="hidden",f.style.pointerEvents="none",d.onload=()=>{f.style.visibility="",f.style.pointerEvents=""},u}},addCommands(){return{setImage:t=>({commands:s})=>s.insertContent({type:this.name,attrs:t})}},addInputRules(){return[pbe({find:dNe,type:this.type,getAttributes:t=>{const[,,s,n,a]=t;return{src:n,alt:s,title:a}}})]}});var pS,xS;if(typeof WeakMap<"u"){let t=new WeakMap;pS=s=>t.get(s),xS=(s,n)=>(t.set(s,n),n)}else{const t=[];let n=0;pS=a=>{for(let i=0;i<t.length;i+=2)if(t[i]==a)return t[i+1]},xS=(a,i)=>(n==10&&(n=0),t[n++]=a,t[n++]=i)}var xn=class{constructor(t,s,n,a){this.width=t,this.height=s,this.map=n,this.problems=a}findCell(t){for(let s=0;s<this.map.length;s++){const n=this.map[s];if(n!=t)continue;const a=s%this.width,i=s/this.width|0;let l=a+1,o=i+1;for(let c=1;l<this.width&&this.map[s+c]==n;c++)l++;for(let c=1;o<this.height&&this.map[s+this.width*c]==n;c++)o++;return{left:a,top:i,right:l,bottom:o}}throw new RangeError(`No cell with offset ${t} found`)}colCount(t){for(let s=0;s<this.map.length;s++)if(this.map[s]==t)return s%this.width;throw new RangeError(`No cell with offset ${t} found`)}nextCell(t,s,n){const{left:a,right:i,top:l,bottom:o}=this.findCell(t);return s=="horiz"?(n<0?a==0:i==this.width)?null:this.map[l*this.width+(n<0?a-1:i)]:(n<0?l==0:o==this.height)?null:this.map[a+this.width*(n<0?l-1:o)]}rectBetween(t,s){const{left:n,right:a,top:i,bottom:l}=this.findCell(t),{left:o,right:c,top:d,bottom:u}=this.findCell(s);return{left:Math.min(n,o),top:Math.min(i,d),right:Math.max(a,c),bottom:Math.max(l,u)}}cellsInRect(t){const s=[],n={};for(let a=t.top;a<t.bottom;a++)for(let i=t.left;i<t.right;i++){const l=a*this.width+i,o=this.map[l];n[o]||(n[o]=!0,!(i==t.left&&i&&this.map[l-1]==o||a==t.top&&a&&this.map[l-this.width]==o)&&s.push(o))}return s}positionAt(t,s,n){for(let a=0,i=0;;a++){const l=i+n.child(a).nodeSize;if(a==t){let o=s+t*this.width;const c=(t+1)*this.width;for(;o<c&&this.map[o]<i;)o++;return o==c?l-1:this.map[o]}i=l}}static get(t){return pS(t)||xS(t,uNe(t))}};function uNe(t){if(t.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+t.type.name);const s=hNe(t),n=t.childCount,a=[];let i=0,l=null;const o=[];for(let u=0,f=s*n;u<f;u++)a[u]=0;for(let u=0,f=0;u<n;u++){const m=t.child(u);f++;for(let w=0;;w++){for(;i<a.length&&a[i]!=0;)i++;if(w==m.childCount)break;const j=m.child(w),{colspan:_,rowspan:C,colwidth:k}=j.attrs;for(let A=0;A<C;A++){if(A+u>=n){(l||(l=[])).push({type:"overlong_rowspan",pos:f,n:C-A});break}const T=i+A*s;for(let P=0;P<_;P++){a[T+P]==0?a[T+P]=f:(l||(l=[])).push({type:"collision",row:u,pos:f,n:_-P});const R=k&&k[P];if(R){const I=(T+P)%s*2,O=o[I];O==null||O!=R&&o[I+1]==1?(o[I]=R,o[I+1]=1):O==R&&o[I+1]++}}}i+=_,f+=j.nodeSize}const x=(u+1)*s;let b=0;for(;i<x;)a[i++]==0&&b++;b&&(l||(l=[])).push({type:"missing",row:u,n:b}),f++}(s===0||n===0)&&(l||(l=[])).push({type:"zero_sized"});const c=new xn(s,n,a,l);let d=!1;for(let u=0;!d&&u<o.length;u+=2)o[u]!=null&&o[u+1]<n&&(d=!0);return d&&fNe(c,o,t),c}function hNe(t){let s=-1,n=!1;for(let a=0;a<t.childCount;a++){const i=t.child(a);let l=0;if(n)for(let o=0;o<a;o++){const c=t.child(o);for(let d=0;d<c.childCount;d++){const u=c.child(d);o+u.attrs.rowspan>a&&(l+=u.attrs.colspan)}}for(let o=0;o<i.childCount;o++){const c=i.child(o);l+=c.attrs.colspan,c.attrs.rowspan>1&&(n=!0)}s==-1?s=l:s!=l&&(s=Math.max(s,l))}return s}function fNe(t,s,n){t.problems||(t.problems=[]);const a={};for(let i=0;i<t.map.length;i++){const l=t.map[i];if(a[l])continue;a[l]=!0;const o=n.nodeAt(l);if(!o)throw new RangeError(`No cell with offset ${l} found`);let c=null;const d=o.attrs;for(let u=0;u<d.colspan;u++){const f=(i+u)%t.width,m=s[f*2];m!=null&&(!d.colwidth||d.colwidth[u]!=m)&&((c||(c=mNe(d)))[u]=m)}c&&t.problems.unshift({type:"colwidth mismatch",pos:l,colwidth:c})}}function mNe(t){if(t.colwidth)return t.colwidth.slice();const s=[];for(let n=0;n<t.colspan;n++)s.push(0);return s}function Yr(t){let s=t.cached.tableNodeTypes;if(!s){s=t.cached.tableNodeTypes={};for(const n in t.nodes){const a=t.nodes[n],i=a.spec.tableRole;i&&(s[i]=a)}}return s}var pc=new An("selectingCells");function Lf(t){for(let s=t.depth-1;s>0;s--)if(t.node(s).type.spec.tableRole=="row")return t.node(0).resolve(t.before(s+1));return null}function pNe(t){for(let s=t.depth;s>0;s--){const n=t.node(s).type.spec.tableRole;if(n==="cell"||n==="header_cell")return t.node(s)}return null}function ul(t){const s=t.selection.$head;for(let n=s.depth;n>0;n--)if(s.node(n).type.spec.tableRole=="row")return!0;return!1}function ov(t){const s=t.selection;if("$anchorCell"in s&&s.$anchorCell)return s.$anchorCell.pos>s.$headCell.pos?s.$anchorCell:s.$headCell;if("node"in s&&s.node&&s.node.type.spec.tableRole=="cell")return s.$anchor;const n=Lf(s.$head)||xNe(s.$head);if(n)return n;throw new RangeError(`No cell found around position ${s.head}`)}function xNe(t){for(let s=t.nodeAfter,n=t.pos;s;s=s.firstChild,n++){const a=s.type.spec.tableRole;if(a=="cell"||a=="header_cell")return t.doc.resolve(n)}for(let s=t.nodeBefore,n=t.pos;s;s=s.lastChild,n--){const a=s.type.spec.tableRole;if(a=="cell"||a=="header_cell")return t.doc.resolve(n-s.nodeSize)}}function gS(t){return t.parent.type.spec.tableRole=="row"&&!!t.nodeAfter}function gNe(t){return t.node(0).resolve(t.pos+t.nodeAfter.nodeSize)}function lA(t,s){return t.depth==s.depth&&t.pos>=s.start(-1)&&t.pos<=s.end(-1)}function hU(t,s,n){const a=t.node(-1),i=xn.get(a),l=t.start(-1),o=i.nextCell(t.pos-l,s,n);return o==null?null:t.node(0).resolve(l+o)}function vu(t,s,n=1){const a={...t,colspan:t.colspan-n};return a.colwidth&&(a.colwidth=a.colwidth.slice(),a.colwidth.splice(s,n),a.colwidth.some(i=>i>0)||(a.colwidth=null)),a}function fU(t,s,n=1){const a={...t,colspan:t.colspan+n};if(a.colwidth){a.colwidth=a.colwidth.slice();for(let i=0;i<n;i++)a.colwidth.splice(s,0,0)}return a}function yNe(t,s,n){const a=Yr(s.type.schema).header_cell;for(let i=0;i<t.height;i++)if(s.nodeAt(t.map[n+i*t.width]).type!=a)return!1;return!0}var Ls=class lo extends Tt{constructor(s,n=s){const a=s.node(-1),i=xn.get(a),l=s.start(-1),o=i.rectBetween(s.pos-l,n.pos-l),c=s.node(0),d=i.cellsInRect(o).filter(f=>f!=n.pos-l);d.unshift(n.pos-l);const u=d.map(f=>{const m=a.nodeAt(f);if(!m)throw RangeError(`No cell with offset ${f} found`);const x=l+f+1;return new V$(c.resolve(x),c.resolve(x+m.content.size))});super(u[0].$from,u[0].$to,u),this.$anchorCell=s,this.$headCell=n}map(s,n){const a=s.resolve(n.map(this.$anchorCell.pos)),i=s.resolve(n.map(this.$headCell.pos));if(gS(a)&&gS(i)&&lA(a,i)){const l=this.$anchorCell.node(-1)!=a.node(-1);return l&&this.isRowSelection()?lo.rowSelection(a,i):l&&this.isColSelection()?lo.colSelection(a,i):new lo(a,i)}return vt.between(a,i)}content(){const s=this.$anchorCell.node(-1),n=xn.get(s),a=this.$anchorCell.start(-1),i=n.rectBetween(this.$anchorCell.pos-a,this.$headCell.pos-a),l={},o=[];for(let d=i.top;d<i.bottom;d++){const u=[];for(let f=d*n.width+i.left,m=i.left;m<i.right;m++,f++){const x=n.map[f];if(l[x])continue;l[x]=!0;const b=n.findCell(x);let w=s.nodeAt(x);if(!w)throw RangeError(`No cell with offset ${x} found`);const j=i.left-b.left,_=b.right-i.right;if(j>0||_>0){let C=w.attrs;if(j>0&&(C=vu(C,0,j)),_>0&&(C=vu(C,C.colspan-_,_)),b.left<i.left){if(w=w.type.createAndFill(C),!w)throw RangeError(`Could not create cell with attrs ${JSON.stringify(C)}`)}else w=w.type.create(C,w.content)}if(b.top<i.top||b.bottom>i.bottom){const C={...w.attrs,rowspan:Math.min(b.bottom,i.bottom)-Math.max(b.top,i.top)};b.top<i.top?w=w.type.createAndFill(C):w=w.type.create(C,w.content)}u.push(w)}o.push(s.child(d).copy(Fe.from(u)))}const c=this.isColSelection()&&this.isRowSelection()?s:o;return new nt(Fe.from(c),1,1)}replace(s,n=nt.empty){const a=s.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){const{$from:c,$to:d}=i[o],u=s.mapping.slice(a);s.replace(u.map(c.pos),u.map(d.pos),o?nt.empty:n)}const l=Tt.findFrom(s.doc.resolve(s.mapping.slice(a).map(this.to)),-1);l&&s.setSelection(l)}replaceWith(s,n){this.replace(s,new nt(Fe.from(n),0,0))}forEachCell(s){const n=this.$anchorCell.node(-1),a=xn.get(n),i=this.$anchorCell.start(-1),l=a.cellsInRect(a.rectBetween(this.$anchorCell.pos-i,this.$headCell.pos-i));for(let o=0;o<l.length;o++)s(n.nodeAt(l[o]),i+l[o])}isColSelection(){const s=this.$anchorCell.index(-1),n=this.$headCell.index(-1);if(Math.min(s,n)>0)return!1;const a=s+this.$anchorCell.nodeAfter.attrs.rowspan,i=n+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(a,i)==this.$headCell.node(-1).childCount}static colSelection(s,n=s){const a=s.node(-1),i=xn.get(a),l=s.start(-1),o=i.findCell(s.pos-l),c=i.findCell(n.pos-l),d=s.node(0);return o.top<=c.top?(o.top>0&&(s=d.resolve(l+i.map[o.left])),c.bottom<i.height&&(n=d.resolve(l+i.map[i.width*(i.height-1)+c.right-1]))):(c.top>0&&(n=d.resolve(l+i.map[c.left])),o.bottom<i.height&&(s=d.resolve(l+i.map[i.width*(i.height-1)+o.right-1]))),new lo(s,n)}isRowSelection(){const s=this.$anchorCell.node(-1),n=xn.get(s),a=this.$anchorCell.start(-1),i=n.colCount(this.$anchorCell.pos-a),l=n.colCount(this.$headCell.pos-a);if(Math.min(i,l)>0)return!1;const o=i+this.$anchorCell.nodeAfter.attrs.colspan,c=l+this.$headCell.nodeAfter.attrs.colspan;return Math.max(o,c)==n.width}eq(s){return s instanceof lo&&s.$anchorCell.pos==this.$anchorCell.pos&&s.$headCell.pos==this.$headCell.pos}static rowSelection(s,n=s){const a=s.node(-1),i=xn.get(a),l=s.start(-1),o=i.findCell(s.pos-l),c=i.findCell(n.pos-l),d=s.node(0);return o.left<=c.left?(o.left>0&&(s=d.resolve(l+i.map[o.top*i.width])),c.right<i.width&&(n=d.resolve(l+i.map[i.width*(c.top+1)-1]))):(c.left>0&&(n=d.resolve(l+i.map[c.top*i.width])),o.right<i.width&&(s=d.resolve(l+i.map[i.width*(o.top+1)-1]))),new lo(s,n)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(s,n){return new lo(s.resolve(n.anchor),s.resolve(n.head))}static create(s,n,a=n){return new lo(s.resolve(n),s.resolve(a))}getBookmark(){return new bNe(this.$anchorCell.pos,this.$headCell.pos)}};Ls.prototype.visible=!1;Tt.jsonID("cell",Ls);var bNe=class mU{constructor(s,n){this.anchor=s,this.head=n}map(s){return new mU(s.map(this.anchor),s.map(this.head))}resolve(s){const n=s.resolve(this.anchor),a=s.resolve(this.head);return n.parent.type.spec.tableRole=="row"&&a.parent.type.spec.tableRole=="row"&&n.index()<n.parent.childCount&&a.index()<a.parent.childCount&&lA(n,a)?new Ls(n,a):Tt.near(a,1)}};function vNe(t){if(!(t.selection instanceof Ls))return null;const s=[];return t.selection.forEachCell((n,a)=>{s.push(Ga.node(a,a+n.nodeSize,{class:"selectedCell"}))}),jn.create(t.doc,s)}function wNe({$from:t,$to:s}){if(t.pos==s.pos||t.pos<s.pos-6)return!1;let n=t.pos,a=s.pos,i=t.depth;for(;i>=0&&!(t.after(i+1)<t.end(i));i--,n++);for(let l=s.depth;l>=0&&!(s.before(l+1)>s.start(l));l--,a--);return n==a&&/row|table/.test(t.node(i).type.spec.tableRole)}function NNe({$from:t,$to:s}){let n,a;for(let i=t.depth;i>0;i--){const l=t.node(i);if(l.type.spec.tableRole==="cell"||l.type.spec.tableRole==="header_cell"){n=l;break}}for(let i=s.depth;i>0;i--){const l=s.node(i);if(l.type.spec.tableRole==="cell"||l.type.spec.tableRole==="header_cell"){a=l;break}}return n!==a&&s.parentOffset===0}function jNe(t,s,n){const a=(s||t).selection,i=(s||t).doc;let l,o;if(a instanceof Ct&&(o=a.node.type.spec.tableRole)){if(o=="cell"||o=="header_cell")l=Ls.create(i,a.from);else if(o=="row"){const c=i.resolve(a.from+1);l=Ls.rowSelection(c,c)}else if(!n){const c=xn.get(a.node),d=a.from+1,u=d+c.map[c.width*c.height-1];l=Ls.create(i,d+1,u)}}else a instanceof vt&&wNe(a)?l=vt.create(i,a.from):a instanceof vt&&NNe(a)&&(l=vt.create(i,a.$from.start(),a.$from.end()));return l&&(s||(s=t.tr)).setSelection(l),s}var _Ne=new An("fix-tables");function pU(t,s,n,a){const i=t.childCount,l=s.childCount;e:for(let o=0,c=0;o<l;o++){const d=s.child(o);for(let u=c,f=Math.min(i,o+3);u<f;u++)if(t.child(u)==d){c=u+1,n+=d.nodeSize;continue e}a(d,n),c<i&&t.child(c).sameMarkup(d)?pU(t.child(c),d,n+1,a):d.nodesBetween(0,d.content.size,a,n+1),n+=d.nodeSize}}function xU(t,s){let n;const a=(i,l)=>{i.type.spec.tableRole=="table"&&(n=SNe(t,i,l,n))};return s?s.doc!=t.doc&&pU(s.doc,t.doc,0,a):t.doc.descendants(a),n}function SNe(t,s,n,a){const i=xn.get(s);if(!i.problems)return a;a||(a=t.tr);const l=[];for(let d=0;d<i.height;d++)l.push(0);for(let d=0;d<i.problems.length;d++){const u=i.problems[d];if(u.type=="collision"){const f=s.nodeAt(u.pos);if(!f)continue;const m=f.attrs;for(let x=0;x<m.rowspan;x++)l[u.row+x]+=u.n;a.setNodeMarkup(a.mapping.map(n+1+u.pos),null,vu(m,m.colspan-u.n,u.n))}else if(u.type=="missing")l[u.row]+=u.n;else if(u.type=="overlong_rowspan"){const f=s.nodeAt(u.pos);if(!f)continue;a.setNodeMarkup(a.mapping.map(n+1+u.pos),null,{...f.attrs,rowspan:f.attrs.rowspan-u.n})}else if(u.type=="colwidth mismatch"){const f=s.nodeAt(u.pos);if(!f)continue;a.setNodeMarkup(a.mapping.map(n+1+u.pos),null,{...f.attrs,colwidth:u.colwidth})}else if(u.type=="zero_sized"){const f=a.mapping.map(n);a.delete(f,f+s.nodeSize)}}let o,c;for(let d=0;d<l.length;d++)l[d]&&(o==null&&(o=d),c=d);for(let d=0,u=n+1;d<i.height;d++){const f=s.child(d),m=u+f.nodeSize,x=l[d];if(x>0){let b="cell";f.firstChild&&(b=f.firstChild.type.spec.tableRole);const w=[];for(let _=0;_<x;_++){const C=Yr(t.schema)[b].createAndFill();C&&w.push(C)}const j=(d==0||o==d-1)&&c==d?u+1:m-1;a.insert(a.mapping.map(j),w)}u=m}return a.setMeta(_Ne,{fixTables:!0})}function Jl(t){const s=t.selection,n=ov(t),a=n.node(-1),i=n.start(-1),l=xn.get(a);return{...s instanceof Ls?l.rectBetween(s.$anchorCell.pos-i,s.$headCell.pos-i):l.findCell(n.pos-i),tableStart:i,map:l,table:a}}function gU(t,{map:s,tableStart:n,table:a},i){let l=i>0?-1:0;yNe(s,a,i+l)&&(l=i==0||i==s.width?null:0);for(let o=0;o<s.height;o++){const c=o*s.width+i;if(i>0&&i<s.width&&s.map[c-1]==s.map[c]){const d=s.map[c],u=a.nodeAt(d);t.setNodeMarkup(t.mapping.map(n+d),null,fU(u.attrs,i-s.colCount(d))),o+=u.attrs.rowspan-1}else{const d=l==null?Yr(a.type.schema).cell:a.nodeAt(s.map[c+l]).type,u=s.positionAt(o,i,a);t.insert(t.mapping.map(n+u),d.createAndFill())}}return t}function CNe(t,s){if(!ul(t))return!1;if(s){const n=Jl(t);s(gU(t.tr,n,n.left))}return!0}function kNe(t,s){if(!ul(t))return!1;if(s){const n=Jl(t);s(gU(t.tr,n,n.right))}return!0}function ANe(t,{map:s,table:n,tableStart:a},i){const l=t.mapping.maps.length;for(let o=0;o<s.height;){const c=o*s.width+i,d=s.map[c],u=n.nodeAt(d),f=u.attrs;if(i>0&&s.map[c-1]==d||i<s.width-1&&s.map[c+1]==d)t.setNodeMarkup(t.mapping.slice(l).map(a+d),null,vu(f,i-s.colCount(d)));else{const m=t.mapping.slice(l).map(a+d);t.delete(m,m+u.nodeSize)}o+=f.rowspan}}function ENe(t,s){if(!ul(t))return!1;if(s){const n=Jl(t),a=t.tr;if(n.left==0&&n.right==n.map.width)return!1;for(let i=n.right-1;ANe(a,n,i),i!=n.left;i--){const l=n.tableStart?a.doc.nodeAt(n.tableStart-1):a.doc;if(!l)throw RangeError("No table found");n.table=l,n.map=xn.get(l)}s(a)}return!0}function TNe(t,s,n){var a;const i=Yr(s.type.schema).header_cell;for(let l=0;l<t.width;l++)if(((a=s.nodeAt(t.map[l+n*t.width]))==null?void 0:a.type)!=i)return!1;return!0}function yU(t,{map:s,tableStart:n,table:a},i){var l;let o=n;for(let u=0;u<i;u++)o+=a.child(u).nodeSize;const c=[];let d=i>0?-1:0;TNe(s,a,i+d)&&(d=i==0||i==s.height?null:0);for(let u=0,f=s.width*i;u<s.width;u++,f++)if(i>0&&i<s.height&&s.map[f]==s.map[f-s.width]){const m=s.map[f],x=a.nodeAt(m).attrs;t.setNodeMarkup(n+m,null,{...x,rowspan:x.rowspan+1}),u+=x.colspan-1}else{const m=d==null?Yr(a.type.schema).cell:(l=a.nodeAt(s.map[f+d*s.width]))==null?void 0:l.type,x=m==null?void 0:m.createAndFill();x&&c.push(x)}return t.insert(o,Yr(a.type.schema).row.create(null,c)),t}function PNe(t,s){if(!ul(t))return!1;if(s){const n=Jl(t);s(yU(t.tr,n,n.top))}return!0}function INe(t,s){if(!ul(t))return!1;if(s){const n=Jl(t);s(yU(t.tr,n,n.bottom))}return!0}function MNe(t,{map:s,table:n,tableStart:a},i){let l=0;for(let u=0;u<i;u++)l+=n.child(u).nodeSize;const o=l+n.child(i).nodeSize,c=t.mapping.maps.length;t.delete(l+a,o+a);const d=new Set;for(let u=0,f=i*s.width;u<s.width;u++,f++){const m=s.map[f];if(!d.has(m)){if(d.add(m),i>0&&m==s.map[f-s.width]){const x=n.nodeAt(m).attrs;t.setNodeMarkup(t.mapping.slice(c).map(m+a),null,{...x,rowspan:x.rowspan-1}),u+=x.colspan-1}else if(i<s.height&&m==s.map[f+s.width]){const x=n.nodeAt(m),b=x.attrs,w=x.type.create({...b,rowspan:x.attrs.rowspan-1},x.content),j=s.positionAt(i+1,u,n);t.insert(t.mapping.slice(c).map(a+j),w),u+=b.colspan-1}}}}function DNe(t,s){if(!ul(t))return!1;if(s){const n=Jl(t),a=t.tr;if(n.top==0&&n.bottom==n.map.height)return!1;for(let i=n.bottom-1;MNe(a,n,i),i!=n.top;i--){const l=n.tableStart?a.doc.nodeAt(n.tableStart-1):a.doc;if(!l)throw RangeError("No table found");n.table=l,n.map=xn.get(n.table)}s(a)}return!0}function mM(t){const s=t.content;return s.childCount==1&&s.child(0).isTextblock&&s.child(0).childCount==0}function ONe({width:t,height:s,map:n},a){let i=a.top*t+a.left,l=i,o=(a.bottom-1)*t+a.left,c=i+(a.right-a.left-1);for(let d=a.top;d<a.bottom;d++){if(a.left>0&&n[l]==n[l-1]||a.right<t&&n[c]==n[c+1])return!0;l+=t,c+=t}for(let d=a.left;d<a.right;d++){if(a.top>0&&n[i]==n[i-t]||a.bottom<s&&n[o]==n[o+t])return!0;i++,o++}return!1}function pM(t,s){const n=t.selection;if(!(n instanceof Ls)||n.$anchorCell.pos==n.$headCell.pos)return!1;const a=Jl(t),{map:i}=a;if(ONe(i,a))return!1;if(s){const l=t.tr,o={};let c=Fe.empty,d,u;for(let f=a.top;f<a.bottom;f++)for(let m=a.left;m<a.right;m++){const x=i.map[f*i.width+m],b=a.table.nodeAt(x);if(!(o[x]||!b))if(o[x]=!0,d==null)d=x,u=b;else{mM(b)||(c=c.append(b.content));const w=l.mapping.map(x+a.tableStart);l.delete(w,w+b.nodeSize)}}if(d==null||u==null)return!0;if(l.setNodeMarkup(d+a.tableStart,null,{...fU(u.attrs,u.attrs.colspan,a.right-a.left-u.attrs.colspan),rowspan:a.bottom-a.top}),c.size){const f=d+1+u.content.size,m=mM(u)?d+1:f;l.replaceWith(m+a.tableStart,f+a.tableStart,c)}l.setSelection(new Ls(l.doc.resolve(d+a.tableStart))),s(l)}return!0}function xM(t,s){const n=Yr(t.schema);return RNe(({node:a})=>n[a.type.spec.tableRole])(t,s)}function RNe(t){return(s,n)=>{var a;const i=s.selection;let l,o;if(i instanceof Ls){if(i.$anchorCell.pos!=i.$headCell.pos)return!1;l=i.$anchorCell.nodeAfter,o=i.$anchorCell.pos}else{if(l=pNe(i.$from),!l)return!1;o=(a=Lf(i.$from))==null?void 0:a.pos}if(l==null||o==null||l.attrs.colspan==1&&l.attrs.rowspan==1)return!1;if(n){let c=l.attrs;const d=[],u=c.colwidth;c.rowspan>1&&(c={...c,rowspan:1}),c.colspan>1&&(c={...c,colspan:1});const f=Jl(s),m=s.tr;for(let b=0;b<f.right-f.left;b++)d.push(u?{...c,colwidth:u&&u[b]?[u[b]]:null}:c);let x;for(let b=f.top;b<f.bottom;b++){let w=f.map.positionAt(b,f.left,f.table);b==f.top&&(w+=l.nodeSize);for(let j=f.left,_=0;j<f.right;j++,_++)j==f.left&&b==f.top||m.insert(x=m.mapping.map(w+f.tableStart,1),t({node:l,row:b,col:j}).createAndFill(d[_]))}m.setNodeMarkup(o,t({node:l,row:f.top,col:f.left}),d[0]),i instanceof Ls&&m.setSelection(new Ls(m.doc.resolve(i.$anchorCell.pos),x?m.doc.resolve(x):void 0)),n(m)}return!0}}function LNe(t,s){return function(n,a){if(!ul(n))return!1;const i=ov(n);if(i.nodeAfter.attrs[t]===s)return!1;if(a){const l=n.tr;n.selection instanceof Ls?n.selection.forEachCell((o,c)=>{o.attrs[t]!==s&&l.setNodeMarkup(c,null,{...o.attrs,[t]:s})}):l.setNodeMarkup(i.pos,null,{...i.nodeAfter.attrs,[t]:s}),a(l)}return!0}}function BNe(t){return function(s,n){if(!ul(s))return!1;if(n){const a=Yr(s.schema),i=Jl(s),l=s.tr,o=i.map.cellsInRect(t=="column"?{left:i.left,top:0,right:i.right,bottom:i.map.height}:t=="row"?{left:0,top:i.top,right:i.map.width,bottom:i.bottom}:i),c=o.map(d=>i.table.nodeAt(d));for(let d=0;d<o.length;d++)c[d].type==a.header_cell&&l.setNodeMarkup(i.tableStart+o[d],a.cell,c[d].attrs);if(l.steps.length==0)for(let d=0;d<o.length;d++)l.setNodeMarkup(i.tableStart+o[d],a.header_cell,c[d].attrs);n(l)}return!0}}function gM(t,s,n){const a=s.map.cellsInRect({left:0,top:0,right:t=="row"?s.map.width:1,bottom:t=="column"?s.map.height:1});for(let i=0;i<a.length;i++){const l=s.table.nodeAt(a[i]);if(l&&l.type!==n.header_cell)return!1}return!0}function Qp(t,s){return s=s||{useDeprecatedLogic:!1},s.useDeprecatedLogic?BNe(t):function(n,a){if(!ul(n))return!1;if(a){const i=Yr(n.schema),l=Jl(n),o=n.tr,c=gM("row",l,i),d=gM("column",l,i),f=(t==="column"?c:t==="row"?d:!1)?1:0,m=t=="column"?{left:0,top:f,right:1,bottom:l.map.height}:t=="row"?{left:f,top:0,right:l.map.width,bottom:1}:l,x=t=="column"?d?i.cell:i.header_cell:t=="row"?c?i.cell:i.header_cell:i.cell;l.map.cellsInRect(m).forEach(b=>{const w=b+l.tableStart,j=o.doc.nodeAt(w);j&&o.setNodeMarkup(w,x,j.attrs)}),a(o)}return!0}}Qp("row",{useDeprecatedLogic:!0});Qp("column",{useDeprecatedLogic:!0});var FNe=Qp("cell",{useDeprecatedLogic:!0});function $Ne(t,s){if(s<0){const n=t.nodeBefore;if(n)return t.pos-n.nodeSize;for(let a=t.index(-1)-1,i=t.before();a>=0;a--){const l=t.node(-1).child(a),o=l.lastChild;if(o)return i-1-o.nodeSize;i-=l.nodeSize}}else{if(t.index()<t.parent.childCount-1)return t.pos+t.nodeAfter.nodeSize;const n=t.node(-1);for(let a=t.indexAfter(-1),i=t.after();a<n.childCount;a++){const l=n.child(a);if(l.childCount)return i+1;i+=l.nodeSize}}return null}function yM(t){return function(s,n){if(!ul(s))return!1;const a=$Ne(ov(s),t);if(a==null)return!1;if(n){const i=s.doc.resolve(a);n(s.tr.setSelection(vt.between(i,gNe(i))).scrollIntoView())}return!0}}function zNe(t,s){const n=t.selection.$anchor;for(let a=n.depth;a>0;a--)if(n.node(a).type.spec.tableRole=="table")return s&&s(t.tr.delete(n.before(a),n.after(a)).scrollIntoView()),!0;return!1}function K0(t,s){const n=t.selection;if(!(n instanceof Ls))return!1;if(s){const a=t.tr,i=Yr(t.schema).cell.createAndFill().content;n.forEachCell((l,o)=>{l.content.eq(i)||a.replace(a.mapping.map(o+1),a.mapping.map(o+l.nodeSize-1),new nt(i,0,0))}),a.docChanged&&s(a)}return!0}function UNe(t){if(!t.size)return null;let{content:s,openStart:n,openEnd:a}=t;for(;s.childCount==1&&(n>0&&a>0||s.child(0).type.spec.tableRole=="table");)n--,a--,s=s.child(0).content;const i=s.child(0),l=i.type.spec.tableRole,o=i.type.schema,c=[];if(l=="row")for(let d=0;d<s.childCount;d++){let u=s.child(d).content;const f=d?0:Math.max(0,n-1),m=d<s.childCount-1?0:Math.max(0,a-1);(f||m)&&(u=yS(Yr(o).row,new nt(u,f,m)).content),c.push(u)}else if(l=="cell"||l=="header_cell")c.push(n||a?yS(Yr(o).row,new nt(s,n,a)).content:s);else return null;return VNe(o,c)}function VNe(t,s){const n=[];for(let i=0;i<s.length;i++){const l=s[i];for(let o=l.childCount-1;o>=0;o--){const{rowspan:c,colspan:d}=l.child(o).attrs;for(let u=i;u<i+c;u++)n[u]=(n[u]||0)+d}}let a=0;for(let i=0;i<n.length;i++)a=Math.max(a,n[i]);for(let i=0;i<n.length;i++)if(i>=s.length&&s.push(Fe.empty),n[i]<a){const l=Yr(t).cell.createAndFill(),o=[];for(let c=n[i];c<a;c++)o.push(l);s[i]=s[i].append(Fe.from(o))}return{height:s.length,width:a,rows:s}}function yS(t,s){const n=t.createAndFill();return new U$(n).replace(0,n.content.size,s).doc}function HNe({width:t,height:s,rows:n},a,i){if(t!=a){const l=[],o=[];for(let c=0;c<n.length;c++){const d=n[c],u=[];for(let f=l[c]||0,m=0;f<a;m++){let x=d.child(m%d.childCount);f+x.attrs.colspan>a&&(x=x.type.createChecked(vu(x.attrs,x.attrs.colspan,f+x.attrs.colspan-a),x.content)),u.push(x),f+=x.attrs.colspan;for(let b=1;b<x.attrs.rowspan;b++)l[c+b]=(l[c+b]||0)+x.attrs.colspan}o.push(Fe.from(u))}n=o,t=a}if(s!=i){const l=[];for(let o=0,c=0;o<i;o++,c++){const d=[],u=n[c%s];for(let f=0;f<u.childCount;f++){let m=u.child(f);o+m.attrs.rowspan>i&&(m=m.type.create({...m.attrs,rowspan:Math.max(1,i-m.attrs.rowspan)},m.content)),d.push(m)}l.push(Fe.from(d))}n=l,s=i}return{width:t,height:s,rows:n}}function WNe(t,s,n,a,i,l,o){const c=t.doc.type.schema,d=Yr(c);let u,f;if(i>s.width)for(let m=0,x=0;m<s.height;m++){const b=n.child(m);x+=b.nodeSize;const w=[];let j;b.lastChild==null||b.lastChild.type==d.cell?j=u||(u=d.cell.createAndFill()):j=f||(f=d.header_cell.createAndFill());for(let _=s.width;_<i;_++)w.push(j);t.insert(t.mapping.slice(o).map(x-1+a),w)}if(l>s.height){const m=[];for(let w=0,j=(s.height-1)*s.width;w<Math.max(s.width,i);w++){const _=w>=s.width?!1:n.nodeAt(s.map[j+w]).type==d.header_cell;m.push(_?f||(f=d.header_cell.createAndFill()):u||(u=d.cell.createAndFill()))}const x=d.row.create(null,Fe.from(m)),b=[];for(let w=s.height;w<l;w++)b.push(x);t.insert(t.mapping.slice(o).map(a+n.nodeSize-2),b)}return!!(u||f)}function bM(t,s,n,a,i,l,o,c){if(o==0||o==s.height)return!1;let d=!1;for(let u=i;u<l;u++){const f=o*s.width+u,m=s.map[f];if(s.map[f-s.width]==m){d=!0;const x=n.nodeAt(m),{top:b,left:w}=s.findCell(m);t.setNodeMarkup(t.mapping.slice(c).map(m+a),null,{...x.attrs,rowspan:o-b}),t.insert(t.mapping.slice(c).map(s.positionAt(o,w,n)),x.type.createAndFill({...x.attrs,rowspan:b+x.attrs.rowspan-o})),u+=x.attrs.colspan-1}}return d}function vM(t,s,n,a,i,l,o,c){if(o==0||o==s.width)return!1;let d=!1;for(let u=i;u<l;u++){const f=u*s.width+o,m=s.map[f];if(s.map[f-1]==m){d=!0;const x=n.nodeAt(m),b=s.colCount(m),w=t.mapping.slice(c).map(m+a);t.setNodeMarkup(w,null,vu(x.attrs,o-b,x.attrs.colspan-(o-b))),t.insert(w+x.nodeSize,x.type.createAndFill(vu(x.attrs,0,o-b))),u+=x.attrs.rowspan-1}}return d}function wM(t,s,n,a,i){let l=n?t.doc.nodeAt(n-1):t.doc;if(!l)throw new Error("No table found");let o=xn.get(l);const{top:c,left:d}=a,u=d+i.width,f=c+i.height,m=t.tr;let x=0;function b(){if(l=n?m.doc.nodeAt(n-1):m.doc,!l)throw new Error("No table found");o=xn.get(l),x=m.mapping.maps.length}WNe(m,o,l,n,u,f,x)&&b(),bM(m,o,l,n,d,u,c,x)&&b(),bM(m,o,l,n,d,u,f,x)&&b(),vM(m,o,l,n,c,f,d,x)&&b(),vM(m,o,l,n,c,f,u,x)&&b();for(let w=c;w<f;w++){const j=o.positionAt(w,d,l),_=o.positionAt(w,u,l);m.replace(m.mapping.slice(x).map(j+n),m.mapping.slice(x).map(_+n),new nt(i.rows[w-c],0,0))}b(),m.setSelection(new Ls(m.doc.resolve(n+o.positionAt(c,d,l)),m.doc.resolve(n+o.positionAt(f-1,u-1,l)))),s(m)}var qNe=Dz({ArrowLeft:Y0("horiz",-1),ArrowRight:Y0("horiz",1),ArrowUp:Y0("vert",-1),ArrowDown:Y0("vert",1),"Shift-ArrowLeft":X0("horiz",-1),"Shift-ArrowRight":X0("horiz",1),"Shift-ArrowUp":X0("vert",-1),"Shift-ArrowDown":X0("vert",1),Backspace:K0,"Mod-Backspace":K0,Delete:K0,"Mod-Delete":K0});function Kg(t,s,n){return n.eq(t.selection)?!1:(s&&s(t.tr.setSelection(n).scrollIntoView()),!0)}function Y0(t,s){return(n,a,i)=>{if(!i)return!1;const l=n.selection;if(l instanceof Ls)return Kg(n,a,Tt.near(l.$headCell,s));if(t!="horiz"&&!l.empty)return!1;const o=bU(i,t,s);if(o==null)return!1;if(t=="horiz")return Kg(n,a,Tt.near(n.doc.resolve(l.head+s),s));{const c=n.doc.resolve(o),d=hU(c,t,s);let u;return d?u=Tt.near(d,1):s<0?u=Tt.near(n.doc.resolve(c.before(-1)),-1):u=Tt.near(n.doc.resolve(c.after(-1)),1),Kg(n,a,u)}}}function X0(t,s){return(n,a,i)=>{if(!i)return!1;const l=n.selection;let o;if(l instanceof Ls)o=l;else{const d=bU(i,t,s);if(d==null)return!1;o=new Ls(n.doc.resolve(d))}const c=hU(o.$headCell,t,s);return c?Kg(n,a,new Ls(o.$anchorCell,c)):!1}}function GNe(t,s){const n=t.state.doc,a=Lf(n.resolve(s));return a?(t.dispatch(t.state.tr.setSelection(new Ls(a))),!0):!1}function KNe(t,s,n){if(!ul(t.state))return!1;let a=UNe(n);const i=t.state.selection;if(i instanceof Ls){a||(a={width:1,height:1,rows:[Fe.from(yS(Yr(t.state.schema).cell,n))]});const l=i.$anchorCell.node(-1),o=i.$anchorCell.start(-1),c=xn.get(l).rectBetween(i.$anchorCell.pos-o,i.$headCell.pos-o);return a=HNe(a,c.right-c.left,c.bottom-c.top),wM(t.state,t.dispatch,o,c,a),!0}else if(a){const l=ov(t.state),o=l.start(-1);return wM(t.state,t.dispatch,o,xn.get(l.node(-1)).findCell(l.pos-o),a),!0}else return!1}function YNe(t,s){var n;if(s.ctrlKey||s.metaKey)return;const a=NM(t,s.target);let i;if(s.shiftKey&&t.state.selection instanceof Ls)l(t.state.selection.$anchorCell,s),s.preventDefault();else if(s.shiftKey&&a&&(i=Lf(t.state.selection.$anchor))!=null&&((n=pj(t,s))==null?void 0:n.pos)!=i.pos)l(i,s),s.preventDefault();else if(!a)return;function l(d,u){let f=pj(t,u);const m=pc.getState(t.state)==null;if(!f||!lA(d,f))if(m)f=d;else return;const x=new Ls(d,f);if(m||!t.state.selection.eq(x)){const b=t.state.tr.setSelection(x);m&&b.setMeta(pc,d.pos),t.dispatch(b)}}function o(){t.root.removeEventListener("mouseup",o),t.root.removeEventListener("dragstart",o),t.root.removeEventListener("mousemove",c),pc.getState(t.state)!=null&&t.dispatch(t.state.tr.setMeta(pc,-1))}function c(d){const u=d,f=pc.getState(t.state);let m;if(f!=null)m=t.state.doc.resolve(f);else if(NM(t,u.target)!=a&&(m=pj(t,s),!m))return o();m&&l(m,u)}t.root.addEventListener("mouseup",o),t.root.addEventListener("dragstart",o),t.root.addEventListener("mousemove",c)}function bU(t,s,n){if(!(t.state.selection instanceof vt))return null;const{$head:a}=t.state.selection;for(let i=a.depth-1;i>=0;i--){const l=a.node(i);if((n<0?a.index(i):a.indexAfter(i))!=(n<0?0:l.childCount))return null;if(l.type.spec.tableRole=="cell"||l.type.spec.tableRole=="header_cell"){const c=a.before(i),d=s=="vert"?n>0?"down":"up":n>0?"right":"left";return t.endOfTextblock(d)?c:null}}return null}function NM(t,s){for(;s&&s!=t.dom;s=s.parentNode)if(s.nodeName=="TD"||s.nodeName=="TH")return s;return null}function pj(t,s){const n=t.posAtCoords({left:s.clientX,top:s.clientY});return n&&n?Lf(t.state.doc.resolve(n.pos)):null}var XNe=class{constructor(s,n){this.node=s,this.defaultCellMinWidth=n,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width",`${n}px`),this.colgroup=this.table.appendChild(document.createElement("colgroup")),bS(s,this.colgroup,this.table,n),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(s){return s.type!=this.node.type?!1:(this.node=s,bS(s,this.colgroup,this.table,this.defaultCellMinWidth),!0)}ignoreMutation(s){return s.type=="attributes"&&(s.target==this.table||this.colgroup.contains(s.target))}};function bS(t,s,n,a,i,l){var o;let c=0,d=!0,u=s.firstChild;const f=t.firstChild;if(f){for(let m=0,x=0;m<f.childCount;m++){const{colspan:b,colwidth:w}=f.child(m).attrs;for(let j=0;j<b;j++,x++){const _=i==x?l:w&&w[j],C=_?_+"px":"";if(c+=_||a,_||(d=!1),u)u.style.width!=C&&(u.style.width=C),u=u.nextSibling;else{const k=document.createElement("col");k.style.width=C,s.appendChild(k)}}}for(;u;){const m=u.nextSibling;(o=u.parentNode)==null||o.removeChild(u),u=m}d?(n.style.width=c+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=c+"px")}}var Va=new An("tableColumnResizing");function QNe({handleWidth:t=5,cellMinWidth:s=25,defaultCellMinWidth:n=100,View:a=XNe,lastColumnResizable:i=!0}={}){const l=new kn({key:Va,state:{init(o,c){var d,u;const f=(u=(d=l.spec)==null?void 0:d.props)==null?void 0:u.nodeViews,m=Yr(c.schema).table.name;return a&&f&&(f[m]=(x,b)=>new a(x,n,b)),new ZNe(-1,!1)},apply(o,c){return c.apply(o)}},props:{attributes:o=>{const c=Va.getState(o);return c&&c.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(o,c)=>{JNe(o,c,t,i)},mouseleave:o=>{eje(o)},mousedown:(o,c)=>{tje(o,c,s,n)}},decorations:o=>{const c=Va.getState(o);if(c&&c.activeHandle>-1)return ije(o,c.activeHandle)},nodeViews:{}}});return l}var ZNe=class Yg{constructor(s,n){this.activeHandle=s,this.dragging=n}apply(s){const n=this,a=s.getMeta(Va);if(a&&a.setHandle!=null)return new Yg(a.setHandle,!1);if(a&&a.setDragging!==void 0)return new Yg(n.activeHandle,a.setDragging);if(n.activeHandle>-1&&s.docChanged){let i=s.mapping.map(n.activeHandle,-1);return gS(s.doc.resolve(i))||(i=-1),new Yg(i,n.dragging)}return n}};function JNe(t,s,n,a){if(!t.editable)return;const i=Va.getState(t.state);if(i&&!i.dragging){const l=nje(s.target);let o=-1;if(l){const{left:c,right:d}=l.getBoundingClientRect();s.clientX-c<=n?o=jM(t,s,"left",n):d-s.clientX<=n&&(o=jM(t,s,"right",n))}if(o!=i.activeHandle){if(!a&&o!==-1){const c=t.state.doc.resolve(o),d=c.node(-1),u=xn.get(d),f=c.start(-1);if(u.colCount(c.pos-f)+c.nodeAfter.attrs.colspan-1==u.width-1)return}vU(t,o)}}}function eje(t){if(!t.editable)return;const s=Va.getState(t.state);s&&s.activeHandle>-1&&!s.dragging&&vU(t,-1)}function tje(t,s,n,a){var i;if(!t.editable)return!1;const l=(i=t.dom.ownerDocument.defaultView)!=null?i:window,o=Va.getState(t.state);if(!o||o.activeHandle==-1||o.dragging)return!1;const c=t.state.doc.nodeAt(o.activeHandle),d=sje(t,o.activeHandle,c.attrs);t.dispatch(t.state.tr.setMeta(Va,{setDragging:{startX:s.clientX,startWidth:d}}));function u(m){l.removeEventListener("mouseup",u),l.removeEventListener("mousemove",f);const x=Va.getState(t.state);x!=null&&x.dragging&&(rje(t,x.activeHandle,_M(x.dragging,m,n)),t.dispatch(t.state.tr.setMeta(Va,{setDragging:null})))}function f(m){if(!m.which)return u(m);const x=Va.getState(t.state);if(x&&x.dragging){const b=_M(x.dragging,m,n);SM(t,x.activeHandle,b,a)}}return SM(t,o.activeHandle,d,a),l.addEventListener("mouseup",u),l.addEventListener("mousemove",f),s.preventDefault(),!0}function sje(t,s,{colspan:n,colwidth:a}){const i=a&&a[a.length-1];if(i)return i;const l=t.domAtPos(s);let c=l.node.childNodes[l.offset].offsetWidth,d=n;if(a)for(let u=0;u<n;u++)a[u]&&(c-=a[u],d--);return c/d}function nje(t){for(;t&&t.nodeName!="TD"&&t.nodeName!="TH";)t=t.classList&&t.classList.contains("ProseMirror")?null:t.parentNode;return t}function jM(t,s,n,a){const i=n=="right"?-a:a,l=t.posAtCoords({left:s.clientX+i,top:s.clientY});if(!l)return-1;const{pos:o}=l,c=Lf(t.state.doc.resolve(o));if(!c)return-1;if(n=="right")return c.pos;const d=xn.get(c.node(-1)),u=c.start(-1),f=d.map.indexOf(c.pos-u);return f%d.width==0?-1:u+d.map[f-1]}function _M(t,s,n){const a=s.clientX-t.startX;return Math.max(n,t.startWidth+a)}function vU(t,s){t.dispatch(t.state.tr.setMeta(Va,{setHandle:s}))}function rje(t,s,n){const a=t.state.doc.resolve(s),i=a.node(-1),l=xn.get(i),o=a.start(-1),c=l.colCount(a.pos-o)+a.nodeAfter.attrs.colspan-1,d=t.state.tr;for(let u=0;u<l.height;u++){const f=u*l.width+c;if(u&&l.map[f]==l.map[f-l.width])continue;const m=l.map[f],x=i.nodeAt(m).attrs,b=x.colspan==1?0:c-l.colCount(m);if(x.colwidth&&x.colwidth[b]==n)continue;const w=x.colwidth?x.colwidth.slice():aje(x.colspan);w[b]=n,d.setNodeMarkup(o+m,null,{...x,colwidth:w})}d.docChanged&&t.dispatch(d)}function SM(t,s,n,a){const i=t.state.doc.resolve(s),l=i.node(-1),o=i.start(-1),c=xn.get(l).colCount(i.pos-o)+i.nodeAfter.attrs.colspan-1;let d=t.domAtPos(i.start(-1)).node;for(;d&&d.nodeName!="TABLE";)d=d.parentNode;d&&bS(l,d.firstChild,d,a,c,n)}function aje(t){return Array(t).fill(0)}function ije(t,s){var n;const a=[],i=t.doc.resolve(s),l=i.node(-1);if(!l)return jn.empty;const o=xn.get(l),c=i.start(-1),d=o.colCount(i.pos-c)+i.nodeAfter.attrs.colspan-1;for(let u=0;u<o.height;u++){const f=d+u*o.width;if((d==o.width-1||o.map[f]!=o.map[f+1])&&(u==0||o.map[f]!=o.map[f-o.width])){const m=o.map[f],x=c+m+l.nodeAt(m).nodeSize-1,b=document.createElement("div");b.className="column-resize-handle",(n=Va.getState(t))!=null&&n.dragging&&a.push(Ga.node(c+m,c+m+l.nodeAt(m).nodeSize,{class:"column-resize-dragging"})),a.push(Ga.widget(x,b))}}return jn.create(t.doc,a)}function lje({allowTableNodeSelection:t=!1}={}){return new kn({key:pc,state:{init(){return null},apply(s,n){const a=s.getMeta(pc);if(a!=null)return a==-1?null:a;if(n==null||!s.docChanged)return n;const{deleted:i,pos:l}=s.mapping.mapResult(n);return i?null:l}},props:{decorations:vNe,handleDOMEvents:{mousedown:YNe},createSelectionBetween(s){return pc.getState(s.state)!=null?s.state.selection:null},handleTripleClick:GNe,handleKeyDown:qNe,handlePaste:KNe},appendTransaction(s,n,a){return jNe(a,xU(a,n),t)}})}var wU=Ix.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{var s,n;const a=t.getAttribute("colwidth"),i=a?a.split(",").map(l=>parseInt(l,10)):null;if(!i){const l=(s=t.closest("table"))==null?void 0:s.querySelectorAll("colgroup > col"),o=Array.from(((n=t.parentElement)==null?void 0:n.children)||[]).indexOf(t);if(o&&o>-1&&l&&l[o]){const c=l[o].getAttribute("width");return c?[parseInt(c,10)]:null}}return i}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:t}){return["td",cd(this.options.HTMLAttributes,t),0]}}),oje=Ix.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{const s=t.getAttribute("colwidth");return s?s.split(",").map(a=>parseInt(a,10)):null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:t}){return["th",cd(this.options.HTMLAttributes,t),0]}}),cje=Ix.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:t}){return["tr",cd(this.options.HTMLAttributes,t),0]}});function vS(t,s){return s?["width",`${Math.max(s,t)}px`]:["min-width",`${t}px`]}function CM(t,s,n,a,i,l){var o;let c=0,d=!0,u=s.firstChild;const f=t.firstChild;if(f!==null)for(let x=0,b=0;x<f.childCount;x+=1){const{colspan:w,colwidth:j}=f.child(x).attrs;for(let _=0;_<w;_+=1,b+=1){const C=i===b?l:j&&j[_],k=C?`${C}px`:"";if(c+=C||a,C||(d=!1),u){if(u.style.width!==k){const[A,T]=vS(a,C);u.style.setProperty(A,T)}u=u.nextSibling}else{const A=document.createElement("col"),[T,P]=vS(a,C);A.style.setProperty(T,P),s.appendChild(A)}}}for(;u;){const x=u.nextSibling;(o=u.parentNode)==null||o.removeChild(u),u=x}const m=t.attrs.style&&typeof t.attrs.style=="string"&&/\bwidth\s*:/i.test(t.attrs.style);d&&!m?(n.style.width=`${c}px`,n.style.minWidth=""):(n.style.width="",n.style.minWidth=`${c}px`)}var dje=class{constructor(t,s){this.node=t,this.cellMinWidth=s,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),t.attrs.style&&(this.table.style.cssText=t.attrs.style),this.colgroup=this.table.appendChild(document.createElement("colgroup")),CM(t,this.colgroup,this.table,s),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(t){return t.type!==this.node.type?!1:(this.node=t,CM(t,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(t){const s=t.target,n=this.dom.contains(s),a=this.contentDOM.contains(s);return!!(n&&!a&&(t.type==="attributes"||t.type==="childList"||t.type==="characterData"))}};function uje(t,s,n,a){let i=0,l=!0;const o=[],c=t.firstChild;if(!c)return{};for(let m=0,x=0;m<c.childCount;m+=1){const{colspan:b,colwidth:w}=c.child(m).attrs;for(let j=0;j<b;j+=1,x+=1){const _=n===x?a:w&&w[j];i+=_||s,_||(l=!1);const[C,k]=vS(s,_);o.push(["col",{style:`${C}: ${k}`}])}}const d=l?`${i}px`:"",u=l?"":`${i}px`;return{colgroup:["colgroup",{},...o],tableWidth:d,tableMinWidth:u}}function kM(t,s){return t.createAndFill()}function hje(t){if(t.cached.tableNodeTypes)return t.cached.tableNodeTypes;const s={};return Object.keys(t.nodes).forEach(n=>{const a=t.nodes[n];a.spec.tableRole&&(s[a.spec.tableRole]=a)}),t.cached.tableNodeTypes=s,s}function fje(t,s,n,a,i){const l=hje(t),o=[],c=[];for(let u=0;u<n;u+=1){const f=kM(l.cell);if(f&&c.push(f),a){const m=kM(l.header_cell);m&&o.push(m)}}const d=[];for(let u=0;u<s;u+=1)d.push(l.row.createChecked(null,a&&u===0?o:c));return l.table.createChecked(null,d)}function mje(t){return t instanceof Ls}var Q0=({editor:t})=>{const{selection:s}=t.state;if(!mje(s))return!1;let n=0;const a=Uz(s.ranges[0].$from,l=>l.type.name==="table");return a==null||a.node.descendants(l=>{if(l.type.name==="table")return!1;["tableCell","tableHeader"].includes(l.type.name)&&(n+=1)}),n===s.ranges.length?(t.commands.deleteTable(),!0):!1},pje="";function xje(t){return(t||"").replace(/\s+/g," ").trim()}function gje(t,s,n={}){var a;const i=(a=n.cellLineSeparator)!=null?a:pje;if(!t||!t.content||t.content.length===0)return"";const l=[];t.content.forEach(w=>{const j=[];w.content&&w.content.forEach(_=>{let C="";_.content&&Array.isArray(_.content)&&_.content.length>1?C=_.content.map(P=>s.renderChildren(P)).join(i):C=_.content?s.renderChildren(_.content):"";const k=xje(C),A=_.type==="tableHeader";j.push({text:k,isHeader:A})}),l.push(j)});const o=l.reduce((w,j)=>Math.max(w,j.length),0);if(o===0)return"";const c=new Array(o).fill(0);l.forEach(w=>{var j;for(let _=0;_<o;_+=1){const k=(((j=w[_])==null?void 0:j.text)||"").length;k>c[_]&&(c[_]=k),c[_]<3&&(c[_]=3)}});const d=(w,j)=>w+" ".repeat(Math.max(0,j-w.length)),u=l[0],f=u.some(w=>w.isHeader);let m=`
`;const x=new Array(o).fill(0).map((w,j)=>f&&u[j]&&u[j].text||"");return m+=`| ${x.map((w,j)=>d(w,c[j])).join(" | ")} |
`,m+=`| ${c.map(w=>"-".repeat(Math.max(3,w))).join(" | ")} |
`,(f?l.slice(1):l).forEach(w=>{m+=`| ${new Array(o).fill(0).map((j,_)=>d(w[_]&&w[_].text||"",c[_])).join(" | ")} |
`}),m}var yje=gje,NU=Ix.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,renderWrapper:!1,handleWidth:5,cellMinWidth:25,View:dje,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({node:t,HTMLAttributes:s}){const{colgroup:n,tableWidth:a,tableMinWidth:i}=uje(t,this.options.cellMinWidth),l=s.style;function o(){return l||(a?`width: ${a}`:`min-width: ${i}`)}const c=["table",cd(this.options.HTMLAttributes,s,{style:o()}),n,["tbody",0]];return this.options.renderWrapper?["div",{class:"tableWrapper"},c]:c},parseMarkdown:(t,s)=>{const n=[];if(t.header){const a=[];t.header.forEach(i=>{a.push(s.createNode("tableHeader",{},[{type:"paragraph",content:s.parseInline(i.tokens)}]))}),n.push(s.createNode("tableRow",{},a))}return t.rows&&t.rows.forEach(a=>{const i=[];a.forEach(l=>{i.push(s.createNode("tableCell",{},[{type:"paragraph",content:s.parseInline(l.tokens)}]))}),n.push(s.createNode("tableRow",{},i))}),s.createNode("table",void 0,n)},renderMarkdown:(t,s)=>yje(t,s),addCommands(){return{insertTable:({rows:t=3,cols:s=3,withHeaderRow:n=!0}={})=>({tr:a,dispatch:i,editor:l})=>{const o=fje(l.schema,t,s,n);if(i){const c=a.selection.from+1;a.replaceSelectionWith(o).scrollIntoView().setSelection(vt.near(a.doc.resolve(c)))}return!0},addColumnBefore:()=>({state:t,dispatch:s})=>CNe(t,s),addColumnAfter:()=>({state:t,dispatch:s})=>kNe(t,s),deleteColumn:()=>({state:t,dispatch:s})=>ENe(t,s),addRowBefore:()=>({state:t,dispatch:s})=>PNe(t,s),addRowAfter:()=>({state:t,dispatch:s})=>INe(t,s),deleteRow:()=>({state:t,dispatch:s})=>DNe(t,s),deleteTable:()=>({state:t,dispatch:s})=>zNe(t,s),mergeCells:()=>({state:t,dispatch:s})=>pM(t,s),splitCell:()=>({state:t,dispatch:s})=>xM(t,s),toggleHeaderColumn:()=>({state:t,dispatch:s})=>Qp("column")(t,s),toggleHeaderRow:()=>({state:t,dispatch:s})=>Qp("row")(t,s),toggleHeaderCell:()=>({state:t,dispatch:s})=>FNe(t,s),mergeOrSplit:()=>({state:t,dispatch:s})=>pM(t,s)?!0:xM(t,s),setCellAttribute:(t,s)=>({state:n,dispatch:a})=>LNe(t,s)(n,a),goToNextCell:()=>({state:t,dispatch:s})=>yM(1)(t,s),goToPreviousCell:()=>({state:t,dispatch:s})=>yM(-1)(t,s),fixTables:()=>({state:t,dispatch:s})=>(s&&xU(t),!0),setCellSelection:t=>({tr:s,dispatch:n})=>{if(n){const a=Ls.create(s.doc,t.anchorCell,t.headCell);s.setSelection(a)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:Q0,"Mod-Backspace":Q0,Delete:Q0,"Mod-Delete":Q0}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[QNe({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,defaultCellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],lje({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(t){const s={name:t.name,options:t.options,storage:t.storage};return{tableRole:yu(af(t,"tableRole",s))}}});mr.create({name:"tableKit",addExtensions(){const t=[];return this.options.table!==!1&&t.push(NU.configure(this.options.table)),this.options.tableCell!==!1&&t.push(wU.configure(this.options.tableCell)),this.options.tableHeader!==!1&&t.push(oje.configure(this.options.tableHeader)),this.options.tableRow!==!1&&t.push(cje.configure(this.options.tableRow)),t}});NU.extend({addAttributes(){var t;return{...(t=this.parent)==null?void 0:t.call(this),borderPreset:{default:null,parseHTML:s=>{const n=s.getAttribute("class")||"";return/\btbl-border-all\b/.test(n)?"all":/\btbl-border-h\b/.test(n)?"h":/\btbl-border-v\b/.test(n)?"v":/\btbl-border-none\b/.test(n)?"none":null},renderHTML:s=>({class:s.borderPreset?`tbl-border-${s.borderPreset}`:null,style:"border-collapse:collapse;"})}}}}).configure({resizable:!0});wU.extend({addAttributes(){var t;return{...(t=this.parent)==null?void 0:t.call(this),backgroundColor:{default:null,parseHTML:s=>s.style.backgroundColor||s.getAttribute("data-bg")||null,renderHTML:s=>{const n={};return s.backgroundColor&&(n.style=`background-color:${s.backgroundColor}`),{...n,"data-bg":s.backgroundColor||null}}}}}});const xj={Patient:[{label:"UHID",token:"{{ patient.uhid }}"},{label:"Name",token:"{{ patient.name }}"},{label:"Gender",token:"{{ patient.gender }}"},{label:"DOB",token:'{{ patient.dob | datefmt("%d-%b-%Y") }}'},{label:"Phone",token:"{{ patient.phone }}"},{label:"Email",token:"{{ patient.email }}"},{label:"Address",token:"{{ patient.address }}"}],"Clinical  Last Visit":[{label:"Visit Date",token:'{{ clinical.last_visit.date | datefmt("%d-%b-%Y") }}'},{label:"Doctor",token:"{{ clinical.last_visit.doctor }}"},{label:"Department",token:"{{ clinical.last_visit.department }}"},{label:"Chief Complaints",token:"{{ clinical.last_visit.chief_complaints }}"},{label:"Diagnosis",token:"{{ clinical.last_visit.diagnosis }}"}],"Clinical  Lab Results (loop)":[{label:"Lab Results Table",token:`<table border="1" cellspacing="0" cellpadding="6">
  <tr><th>Test</th><th>Code</th><th>Status</th><th>Result</th><th>Units</th></tr>
  {% for r in clinical.lab_results %}
    <tr>
      <td>{{ r.test }}</td><td>{{ r.code }}</td>
      <td>{{ r.status }}</td><td>{{ r.result }}</td><td>{{ r.units }}</td>
    </tr>
  {% endfor %}
</table>`}],Billing:[{label:"Invoices Count",token:"{{ billing.summary.invoices_count }}"},{label:"Total",token:"{{ billing.summary.total_net }}"},{label:"Paid",token:"{{ billing.summary.total_paid }}"},{label:"Balance",token:"{{ billing.summary.balance }}"}]};function bje({onInsert:t}){const[s,n]=y.useState(()=>new Set(Object.keys(xj))),[a,i]=y.useState(""),l=y.useMemo(()=>{const d=a.trim().toLowerCase();return Object.entries(xj).filter(([f])=>s.has(f)).map(([f,m])=>{const x=d?m.filter(b=>b.label.toLowerCase().includes(d)||b.token.toLowerCase().includes(d)):m;return{group:f,items:x}}).filter(f=>f.items.length>0)},[s,a]),o=d=>{const u=new Set(s);u.has(d)?u.delete(d):u.add(d),n(u)},c=(d,u)=>{d.dataTransfer.setData("text/x-token",u),d.dataTransfer.setData("text/plain",u)};return r.jsxs("div",{className:"border rounded-lg p-3 bg-white space-y-3",children:[r.jsx("div",{className:"text-sm font-semibold",children:"Field Catalog"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:Object.keys(xj).map(d=>r.jsxs("label",{className:"inline-flex items-center gap-1 text-xs border rounded px-2 py-1 bg-gray-50",children:[r.jsx("input",{type:"checkbox",checked:s.has(d),onChange:()=>o(d)}),d]},d))}),r.jsx("input",{value:a,onChange:d=>i(d.target.value),placeholder:"Search fields",className:"w-full border rounded px-2 py-1 text-sm"}),r.jsx("div",{className:"space-y-4",children:l.map(({group:d,items:u})=>r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] font-semibold text-gray-600 mb-1",children:d}),r.jsx("div",{className:"flex flex-wrap gap-2",children:u.map((f,m)=>r.jsx("div",{draggable:!0,onDragStart:x=>c(x,f.token),onDoubleClick:()=>t&&t(f.token),className:"cursor-grab active:cursor-grabbing text-[11px] px-2 py-1 rounded-md bg-gray-50 hover:bg-gray-100 border",title:"Drag into editor or double-click to insert",children:f.label},m))})]},d))}),r.jsxs("div",{className:"pt-2 border-t",children:[r.jsx("div",{className:"text-[11px] text-gray-600 mb-1",children:"Custom token"}),r.jsxs("form",{onSubmit:d=>{d.preventDefault();const u=d.target.elements.token.value.trim();u&&(t&&t(u),d.target.reset())},children:[r.jsx("input",{name:"token",placeholder:"e.g. {{ my.custom }}",className:"border rounded px-2 py-1 text-sm w-full"}),r.jsx("button",{className:"mt-2 w-full px-2 py-1 border rounded text-sm",children:"Insert"})]})]})]})}const Xg=`@page {
  size: A4;
  margin: 18mm 16mm 18mm 16mm;
}
header.tpl-header { position: running(doc-header); }
footer.tpl-footer { position: running(doc-footer); }
@page {
  @top-center { content: element(doc-header); }
  @bottom-center { content: element(doc-footer); }
}
body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; font-size: 12px; }
h1,h2,h3 { margin: 0 0 8px 0; }
table { width: 100%; border-collapse: collapse; }
th, td { padding: 6px; }`,gi={HeaderMinimal:`
<header class="tpl-header" style="font-size:12px;border-bottom:1px solid #ccc;padding-bottom:6px;display:flex;justify-content:space-between;align-items:center;">
  <div>
    <div style="font-weight:700">Hospital Name</div>
    <div style="font-size:11px;">Address line 1, City</div>
  </div>
  <img src="/media/uploads/sample/hospital_logo.png" alt="Logo" style="height:28px"/>
</header>`.trim(),FooterMinimal:`
<footer class="tpl-footer" style="font-size:11px;border-top:1px solid #ccc;padding-top:6px;display:flex;justify-content:space-between;">
  <div>UHID: {{ patient.uhid }} | {{ patient.name }}</div>
  <div>Page: counter(page) / counter(pages)</div>
</footer>`.trim(),SignatureBlock:`
<div style="margin-top:60px;display:flex;gap:40px;">
  <div>Patient/Guardian Signature: __________________</div>
  <div>Doctor: __________________</div>
  <div>Witness: __________________</div>
</div>`.trim(),CoverPage:`
<section style="display:flex;flex-direction:column;min-height:240mm;justify-content:center;align-items:center;text-align:center;gap:8px;">
  <img src="/media/uploads/sample/hospital_logo.png" alt="Logo" style="height:64px;opacity:0.8"/>
  <h1 style="font-size:28px;">Patient Clinical Summary</h1>
  <div style="font-size:14px">UHID: {{ patient.uhid }} &nbsp; | &nbsp; {{ patient.name }}</div>
  <div style="margin-top:40px;font-size:12px;color:#666">Generated on {{ now }}</div>
</section>`.trim()},vje=[{key:"clinical_summary_v2",title:"Clinical Summary  Header/Footer + Tables",category:"report",html:`
<h1>Clinical Summary</h1>
<p><b>UHID:</b> {{ patient.uhid }}<br/>
<b>Name:</b> {{ patient.name }}<br/>
<b>Gender:</b> {{ patient.gender }}<br/>
<b>DOB:</b> {{ patient.dob | datefmt("%d-%b-%Y") }}</p>

{% if clinical.last_visit.date %}
<h3>Last Visit</h3>
<p><b>Date:</b> {{ clinical.last_visit.date | datefmt("%d-%b-%Y") }}<br/>
<b>Doctor:</b> {{ clinical.last_visit.doctor }}<br/>
<b>Department:</b> {{ clinical.last_visit.department }}<br/>
<b>Chief Complaints:</b> {{ clinical.last_visit.chief_complaints }}<br/>
<b>Diagnosis:</b> {{ clinical.last_visit.diagnosis }}</p>
{% endif %}

{% if clinical.lab_results %}
<h3>Recent Lab Results</h3>
<table border="1" cellspacing="0" cellpadding="6">
  <tr><th>Test</th><th>Code</th><th>Status</th><th>Result</th><th>Units</th></tr>
  {% for r in clinical.lab_results %}
    <tr>
      <td>{{ r.test }}</td><td>{{ r.code }}</td><td>{{ r.status }}</td><td>{{ r.result }}</td><td>{{ r.units }}</td>
    </tr>
  {% endfor %}
</table>
{% endif %}

{% if billing.summary %}
<h3>Billing Summary</h3>
<p>
<b>Invoices:</b> {{ billing.summary.invoices_count }} |
<b>Total:</b> {{ billing.summary.total_net }} |
<b>Paid:</b> {{ billing.summary.total_paid }} |
<b>Balance:</b> {{ billing.summary.balance }}
</p>
{% endif %}
`.trim(),css:Xg,header:gi.HeaderMinimal,footer:gi.FooterMinimal},{key:"general_consent_v2",title:"General Consent  with Signature",category:"consent",html:`
<h2 style="text-align:center;">General Consent for Treatment</h2>
<p><b>UHID:</b> {{ patient.uhid }}<br/>
<b>Patient Name:</b> {{ patient.name }}<br/>
<b>Date:</b> {{ now }}</p>

<p>
I, {{ patient.name }}, hereby give consent for the proposed {{ data.procedure_name }}
under the care of {{ data.doctor_name }}.
</p>

<p><b>Risks explained:</b> {{ data.risks_text }}</p>

${gi.SignatureBlock}
`.trim(),css:Xg,header:gi.HeaderMinimal,footer:gi.FooterMinimal},{key:"cover_plus_clinical",title:"Cover Page + Clinical",category:"report",html:`${gi.CoverPage}
<div style="page-break-before:always;"></div>
<h1>Clinical Details</h1>
<p><b>UHID:</b> {{ patient.uhid }} &nbsp; <b>Name:</b> {{ patient.name }}</p>
{% if clinical.last_visit.date %}
<p><b>Last Visit:</b> {{ clinical.last_visit.date | datefmt("%d-%b-%Y") }}  {{ clinical.last_visit.doctor }}</p>
{% endif %}
`.trim(),css:Xg,header:gi.HeaderMinimal,footer:gi.FooterMinimal}];function wje({onUseLayout:t,onInsertBlock:s}){const n=y.useMemo(()=>[{key:"HeaderMinimal",title:"Header  Minimal",html:gi.HeaderMinimal},{key:"FooterMinimal",title:"Footer  Minimal",html:gi.FooterMinimal},{key:"SignatureBlock",title:"Signature Block",html:gi.SignatureBlock},{key:"CoverPage",title:"Cover Page",html:gi.CoverPage}],[]);return r.jsxs("div",{className:"border rounded-lg p-3 bg-white space-y-3",children:[r.jsx("div",{className:"text-sm font-semibold",children:"Template Gallery"}),r.jsx("div",{className:"space-y-2",children:vje.map(a=>r.jsxs("div",{className:"border rounded p-2",children:[r.jsx("div",{className:"text-sm font-medium",children:a.title}),r.jsxs("div",{className:"text-[11px] text-gray-500 mb-2",children:["Category: ",a.category]}),r.jsx("div",{className:"flex gap-2",children:r.jsx("button",{className:"px-2 py-1 rounded text-sm border",onClick:()=>t&&t(a),children:"Use Layout"})})]},a.key))}),r.jsxs("div",{className:"pt-2 border-t",children:[r.jsx("div",{className:"text-sm font-semibold mb-2",children:"Blocks"}),r.jsx("div",{className:"grid grid-cols-2 gap-2",children:n.map(a=>r.jsxs("button",{className:"border rounded p-2 text-left hover:bg-gray-50",onClick:()=>s&&s(a.html),title:"Insert into current editor",children:[r.jsx("div",{className:"text-xs font-medium",children:a.title}),r.jsx("div",{className:"text-[10px] text-gray-500",children:"Click to insert"})]},a.key))})]})]})}const Nje=[{key:"A4",label:"A4 (210297 mm)"},{key:"A5",label:"A5 (148210 mm)"},{key:"Letter",label:"Letter (8.511 in)"},{key:"Legal",label:"Legal (8.514 in)"}];function jje({css:t="",onApply:s,onClose:n}){const[a,i]=y.useState("A4"),[l,o]=y.useState("portrait"),[c,d]=y.useState(18),[u,f]=y.useState(16),[m,x]=y.useState(18),[b,w]=y.useState(16),[j,_]=y.useState(!0);y.useEffect(()=>{const k=t.match(/@page\s*{([\s\S]*?)}/);if(!k)return;const A=k[1],T=I=>(A.match(I)||[,""])[1],P=T(/size:\s*([^;]+);/i);if(P){const I=P.trim().split(/\s+/);i(I[0]),I[1]&&o(I[1])}const R=(I,O)=>{const M=T(I);return M?parseInt(M,10):O};d(R(/margin-top:\s*([0-9]+)mm/i,c)),f(R(/margin-right:\s*([0-9]+)mm/i,u)),x(R(/margin-bottom:\s*([0-9]+)mm/i,m)),w(R(/margin-left:\s*([0-9]+)mm/i,b))},[]);const C=()=>`@page {
  size: ${a} ${l};
  margin-top: ${c}mm;
  margin-right: ${u}mm;
  margin-bottom: ${m}mm;
  margin-left: ${b}mm;
  ${j?'@bottom-right { content: "Page " counter(page) " of " counter(pages); font-size:10px; }':""}
}`;return r.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:r.jsxs("div",{className:"bg-white rounded-lg w-full max-w-xl",children:[r.jsx("div",{className:"px-4 py-3 border-b font-semibold",children:"Page Setup"}),r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("label",{className:"text-sm",children:["Size",r.jsx("select",{className:"w-full border rounded px-2 py-1",value:a,onChange:k=>i(k.target.value),children:Nje.map(k=>r.jsx("option",{value:k.key,children:k.label},k.key))})]}),r.jsxs("label",{className:"text-sm",children:["Orientation",r.jsxs("select",{className:"w-full border rounded px-2 py-1",value:l,onChange:k=>o(k.target.value),children:[r.jsx("option",{value:"portrait",children:"Portrait"}),r.jsx("option",{value:"landscape",children:"Landscape"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[r.jsxs("label",{className:"text-sm",children:["Top (mm)",r.jsx("input",{type:"number",className:"w-full border rounded px-2 py-1",value:c,onChange:k=>d(+k.target.value)})]}),r.jsxs("label",{className:"text-sm",children:["Right (mm)",r.jsx("input",{type:"number",className:"w-full border rounded px-2 py-1",value:u,onChange:k=>f(+k.target.value)})]}),r.jsxs("label",{className:"text-sm",children:["Bottom (mm)",r.jsx("input",{type:"number",className:"w-full border rounded px-2 py-1",value:m,onChange:k=>x(+k.target.value)})]}),r.jsxs("label",{className:"text-sm",children:["Left (mm)",r.jsx("input",{type:"number",className:"w-full border rounded px-2 py-1",value:b,onChange:k=>w(+k.target.value)})]})]}),r.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[r.jsx("input",{type:"checkbox",checked:j,onChange:k=>_(k.target.checked)}),"Show page numbers (WeasyPrint)"]}),r.jsx("pre",{className:"text-xs bg-gray-50 border rounded p-2 overflow-auto",children:C()})]}),r.jsxs("div",{className:"px-4 py-3 border-t flex justify-end gap-2",children:[r.jsx("button",{className:"px-3 py-2 border rounded",onClick:n,children:"Cancel"}),r.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white",onClick:()=>s&&s(C()),children:"Apply"})]})]})})}const gj=Xg;function AM({mode:t="create"}){var O;const{id:s}=sd(),n=Ta(),i=((O=Di().state)==null?void 0:O.preset)||null,[l,o]=y.useState({name:"",code:"",category:"report",subcategory:"",description:"",css:gj,is_active:!0}),[c,d]=y.useState(""),[u,f]=y.useState("<h1>New Template</h1><p>Use the Field Catalog or Gallery.</p>"),[m,x]=y.useState(""),[b,w]=y.useState("body"),j=t==="edit";y.useEffect(()=>{!j||!s||(async()=>{const B=(await k0e(s)).data;o({name:B.name,code:B.code,category:B.category,subcategory:B.subcategory||"",description:B.description||"",css:B.css||gj,is_active:!!B.is_active});const L=B.html||"",F=L.match(/<header[^>]*class="[^"]*tpl-header[^"]*"[^>]*>[\s\S]*?<\/header>/i),V=L.match(/<footer[^>]*class="[^"]*tpl-footer[^"]*"[^>]*>[\s\S]*?<\/footer>/i);d(F?F[0]:""),x(V?V[0]:"");let U=L;F&&(U=U.replace(F[0],"")),V&&(U=U.replace(V[0],"")),f(U.trim()||"")})()},[j,s]),y.useEffect(()=>{!i||j||(o(M=>({...M,category:i.category||"report",name:M.name||i.title||"Untitled",code:M.code||(i.key?`${i.key}-${Date.now()}`:""),css:i.css||gj})),d(i.header||""),x(i.footer||""),f(i.html||""))},[i,j]);const _=y.useMemo(()=>[c,u,m].filter(Boolean).join(`
`),[c,u,m]),C=async()=>{if(!l.name.trim()||!l.code.trim()){ie.error("Name and unique code are required");return}const M={...l,html:_,placeholders:{header:!!c,footer:!!m}};try{j?(await E0e(s,M),ie.success("Template updated")):(await A0e(M),ie.success("Template created")),n("/templates")}catch{}},k=M=>{o(B=>({...B,category:M.category||B.category,css:M.css||B.css,name:B.name||M.title,code:B.code||(M.key?`${M.key}-${Date.now()}`:"")})),d(M.header||""),x(M.footer||""),f(M.html||""),ie.success("Layout applied")},A=M=>{b==="header"?d(B=>`${B}
${M}`):b==="footer"?x(B=>`${B}
${M}`):f(B=>`${B}
${M}`)},T=M=>{A(M)},[P,R]=y.useState(!1),I=M=>{o(B=>{const L=/@page\s*{[\s\S]*?}/.test(B.css||"");return{...B,css:L?B.css.replace(/@page\s*{[\s\S]*?}/,M):M+`
`+(B.css||"")}}),R(!1)};return r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>R(!0),className:"px-3 py-2 rounded border",children:"Page Setup"}),r.jsx("button",{onClick:C,className:"px-3 py-2 rounded bg-blue-600 text-white",children:"Save"}),P&&r.jsx(jje,{css:l.css,onApply:I,onClose:()=>R(!1)})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h1",{className:"text-xl font-semibold",children:j?"Edit Template":"Create Template"}),r.jsx("div",{className:"flex gap-2",children:r.jsx("button",{onClick:C,className:"px-3 py-2 rounded bg-blue-600 text-white",children:"Save"})})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[r.jsx("input",{value:l.name,onChange:M=>o({...l,name:M.target.value}),className:"border rounded px-3 py-2",placeholder:"Template Name"}),r.jsx("input",{value:l.code,onChange:M=>o({...l,code:M.target.value}),className:"border rounded px-3 py-2",placeholder:"Unique Code (e.g., clinical_summary_v2)",disabled:j}),r.jsxs("select",{value:l.category,onChange:M=>o({...l,category:M.target.value}),className:"border rounded px-3 py-2",children:[r.jsx("option",{value:"report",children:"Report"}),r.jsx("option",{value:"consent",children:"Consent"})]}),r.jsx("input",{value:l.subcategory,onChange:M=>o({...l,subcategory:M.target.value}),className:"border rounded px-3 py-2",placeholder:"Subcategory (optional)"}),r.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[r.jsx("input",{type:"checkbox",checked:l.is_active,onChange:M=>o({...l,is_active:M.target.checked})}),"Active"]})]}),r.jsx("textarea",{value:l.description,onChange:M=>o({...l,description:M.target.value}),placeholder:"Description (optional)",className:"border rounded px-3 py-2 w-full min-h-[80px]"}),r.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[r.jsxs("div",{className:"col-span-12 lg:col-span-8 space-y-3",children:[r.jsx("div",{className:"flex gap-2",children:["header","body","footer"].map(M=>r.jsx("button",{onClick:()=>w(M),className:["px-3 py-1 rounded border text-sm",b===M?"bg-blue-600 text-white border-blue-600":"bg-white"].join(" "),children:M.toUpperCase()},M))}),b==="header"&&r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium mb-1",children:"Header (running top)"}),r.jsx(QN,{value:c,onChange:d})]}),b==="body"&&r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium mb-1",children:"Body"}),r.jsx(QN,{value:u,onChange:f})]}),b==="footer"&&r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium mb-1",children:"Footer (running bottom)"}),r.jsx(QN,{value:m,onChange:x})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium mb-1",children:"CSS (print styles)"}),r.jsx("textarea",{value:l.css,onChange:M=>o({...l,css:M.target.value}),className:"border rounded px-3 py-2 w-full min-h-[160px] font-mono text-xs"})]})]}),r.jsxs("div",{className:"col-span-12 lg:col-span-4 space-y-3",children:[r.jsx(bje,{onInsert:T}),r.jsx(wje,{onUseLayout:k,onInsertBlock:A}),r.jsxs("div",{className:"text-[11px] text-gray-500",children:[r.jsx("b",{children:"Note:"})," Save the template to use server-side merged preview & PDF."]})]})]})]})}function _je(t,s){const n=window.URL.createObjectURL(t),a=document.createElement("a");a.href=n,a.download=s||"download",document.body.appendChild(a),a.click(),a.remove(),window.URL.revokeObjectURL(n)}function jU({value:t,onChange:s,onSelect:n}){const[a,i]=y.useState(""),[l,o]=y.useState([]),[c,d]=y.useState(!1);y.useEffect(()=>{const m=setTimeout(async()=>{const x=(a||"").trim();if(x.length<2){o([]);return}d(!0);try{const{data:b}=await c$(x),w=(b==null?void 0:b.results)||(b==null?void 0:b.items)||b||[];o(w)}catch(b){console.error("lookupPatients failed",b),o([])}finally{d(!1)}},300);return()=>clearTimeout(m)},[a]);function u(f){const m=s||n;m&&m(f.id,f)}return r.jsxs("div",{className:"space-y-1",children:[r.jsx("input",{value:a,onChange:f=>i(f.target.value),placeholder:"Search patient (UHID / Name / Phone)",className:"w-full rounded-md border border-slate-300 px-2.5 py-1.5 text-xs md:text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500"}),r.jsxs("div",{className:"mt-1 max-h-56 overflow-auto rounded-xl border border-slate-200 bg-white shadow-sm",children:[c&&r.jsx("div",{className:"px-3 py-2 text-[11px] text-slate-400",children:"Searching"}),!c&&l.length===0&&r.jsx("div",{className:"px-3 py-2 text-[11px] text-slate-400",children:"Type at least 2 characters to search."}),l.map(f=>{const m=f.uhid||`NH-${String(f.id??"").toString().padStart(6,"0")}`,x=f.name||[f.first_name,f.last_name].filter(Boolean).join(" ")||"Unnamed";return r.jsxs("button",{type:"button",onClick:()=>u(f),className:"w-full text-left px-3 py-2 text-xs md:text-sm hover:bg-indigo-50 flex flex-col gap-0.5",children:[r.jsxs("span",{className:"font-medium text-slate-800",children:[m,"  ",x]}),r.jsxs("span",{className:"text-[11px] text-slate-500",children:[f.gender?`${f.gender}  `:"",f.phone||"No phone"]})]},f.id)})]}),t&&r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Selected patient ID:"," ",r.jsx("span",{className:"font-semibold text-slate-800",children:t})]})]})}function Sje(){const[t,s]=y.useState("saved"),[n,a]=y.useState(null),[i,l]=y.useState([]),[o,c]=y.useState(""),[d,u]=y.useState(""),[f,m]=y.useState(1),[x,b]=y.useState("");y.useEffect(()=>{(async()=>{const _=await jk({category:"report",active:!0});l(_.data||[])})()},[]);const w=async()=>{if(!n||!o)return ie.info("Select template and patient");try{const _=await d$(Number(o),Number(n));u(_.data.html||"")}catch{}},j=async()=>{if(!n||!o)return ie.info("Select template and patient");try{const _=x?await I0e(Number(o),{patient_id:Number(n),inline:!1,engine:x}):await P0e(Number(o),Number(n));_je(_,`patient-${n}.pdf`)}catch{}};return r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsx("h1",{className:"text-xl font-semibold",children:"Generate Patient Reports"}),r.jsx("div",{className:"flex gap-2",children:["saved","predefined","customized"].map(_=>r.jsx("button",{onClick:()=>s(_),className:["px-3 py-1 rounded border text-sm",t===_?"bg-blue-600 text-white border-blue-600":"bg-white"].join(" "),children:_==="saved"?"Saved Formats":_==="predefined"?"Predefined":"Customized"},_))}),t==="saved"&&r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"md:col-span-1 border rounded-lg p-3 bg-white space-y-3",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-semibold mb-2",children:"1) Select Template"}),r.jsxs("select",{value:o,onChange:_=>c(_.target.value),className:"border rounded px-3 py-2 w-full",children:[r.jsx("option",{value:"",children:"-- choose report template --"}),i.map(_=>r.jsxs("option",{value:_.id,children:[_.name," (",_.code,")"]},_.id))]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-semibold mb-2",children:"2) Choose Patient"}),r.jsx(jU,{value:n,onSelect:a})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("label",{className:"text-sm",children:"Engine"}),r.jsxs("select",{value:x,onChange:_=>b(_.target.value),className:"border rounded px-2 py-1 text-sm",children:[r.jsx("option",{value:"",children:"Auto"}),r.jsx("option",{value:"weasyprint",children:"WeasyPrint"}),r.jsx("option",{value:"xhtml2pdf",children:"xhtml2pdf (fallback)"})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:w,className:"px-3 py-2 border rounded",children:"Preview"}),r.jsx("button",{onClick:j,className:"px-3 py-2 rounded bg-blue-600 text-white",children:"Download PDF"})]})]})]}),r.jsxs("div",{className:"md:col-span-2 border rounded-lg overflow-hidden bg-white",children:[r.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",children:[r.jsx("div",{className:"text-sm text-gray-600",children:"Preview"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{className:"px-2 py-1 border rounded text-sm",onClick:()=>m(_=>Math.max(.5,+(_-.1).toFixed(2))),children:""}),r.jsxs("div",{className:"text-xs w-12 text-center",children:[Math.round(f*100),"%"]}),r.jsx("button",{className:"px-2 py-1 border rounded text-sm",onClick:()=>m(_=>Math.min(2,+(_+.1).toFixed(2))),children:"+"})]})]}),r.jsx("div",{className:"w-full",style:{transform:`scale(${f})`,transformOrigin:"0 0"},children:r.jsx("iframe",{title:"report-preview",className:"w-full min-h-[900px]",srcDoc:d||""})})]})]}),t==="predefined"&&r.jsxs("div",{className:"grid md:grid-cols-3 gap-3",children:[r.jsx("div",{className:"md:col-span-1",children:r.jsx(TemplateGallery,{onUseLayout:_=>window.location.assign("/templates/new"),onInsertBlock:()=>{}})}),r.jsx("div",{className:"md:col-span-2 border rounded-lg p-4 bg-white text-sm text-gray-600",children:'Pick a layout from the left to open the editor pre-filled. Save it, then return to "Saved Formats".'})]}),t==="customized"&&r.jsxs("div",{className:"border rounded-lg p-4 bg-white",children:[r.jsx("div",{className:"text-sm mb-2",children:"Create your own template with header/footer, drag-drop fields and blocks."}),r.jsx("a",{href:"/templates/new",className:"px-3 py-2 rounded bg-blue-600 text-white inline-block",children:"Open Template Builder"})]})]})}function Cje(){const[t,s]=y.useState(""),[n,a]=y.useState([]),[i,l]=y.useState(""),[o,c]=y.useState({procedure_name:"",doctor_name:"",risks_text:"",witness_name:""}),[d,u]=y.useState(""),[f,m]=y.useState([]),x=async j=>{if(!j){m([]);return}try{const _=await D0e(Number(j));m(_.data||[])}catch{}};y.useEffect(()=>{(async()=>{const j=await jk({category:"consent",active:!0});a(j.data||[])})()},[]);const b=async()=>{if(!t||!i){ie.info("Select consent template and enter Patient ID");return}const j={data:{...o}},_=await d$(Number(i),Number(t),j);u(_.data.html||"")},w=async()=>{if(!t||!i){ie.info("Select consent template and enter Patient ID");return}try{await M0e(Number(t),{template_id:Number(i),data:{...o},finalize:!0,signed_by:o.doctor_name||void 0,witness_name:o.witness_name||void 0}),ie.success("Consent saved"),x(t)}catch{}};return r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsx("h1",{className:"text-xl font-semibold",children:"Patient Consents"}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"md:col-span-1 border rounded-lg p-3 bg-white",children:[r.jsx("div",{className:"text-sm font-semibold mb-2",children:"Consent Template"}),r.jsxs("select",{value:i,onChange:j=>l(j.target.value),className:"border rounded px-3 py-2 w-full",children:[r.jsx("option",{value:"",children:"-- choose consent template --"}),n.map(j=>r.jsxs("option",{value:j.id,children:[j.name," (",j.code,")"]},j.id))]}),r.jsx("div",{className:"mt-3 text-sm font-semibold",children:"Patient"}),r.jsx("input",{value:t,onChange:j=>s(j.target.value),className:"border rounded px-3 py-2 w-full",placeholder:"Patient ID",onBlur:()=>x(e.target.value)}),r.jsx("div",{className:"mt-3 text-sm font-semibold",children:"Extra Fields"}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("input",{value:o.procedure_name,onChange:j=>c({...o,procedure_name:j.target.value}),className:"border rounded px-3 py-2 w-full",placeholder:"Procedure name"}),r.jsx("input",{value:o.doctor_name,onChange:j=>c({...o,doctor_name:j.target.value}),className:"border rounded px-3 py-2 w-full",placeholder:"Doctor name"}),r.jsx("textarea",{value:o.risks_text,onChange:j=>c({...o,risks_text:j.target.value}),className:"border rounded px-3 py-2 w-full min-h-[80px]",placeholder:"Risks explained..."}),r.jsx("input",{value:o.witness_name,onChange:j=>c({...o,witness_name:j.target.value}),className:"border rounded px-3 py-2 w-full",placeholder:"Witness name"})]}),r.jsxs("div",{className:"mt-3 flex gap-2",children:[r.jsx("button",{onClick:b,className:"px-3 py-2 border rounded",children:"Preview"}),r.jsx("button",{onClick:w,className:"px-3 py-2 rounded bg-blue-600 text-white",children:"Save PDF"})]})]}),r.jsxs("div",{className:"md:col-span-2 space-y-3",children:[r.jsx("div",{className:"border rounded-lg overflow-hidden bg-white",children:r.jsx("iframe",{title:"consent-preview",className:"w-full min-h-[400px]",srcDoc:d||""})}),r.jsxs("div",{className:"border rounded-lg bg-white",children:[r.jsxs("div",{className:"px-3 py-2 border-b text-sm font-semibold",children:["Existing Consents (Patient #",t||"-",")"]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left",children:"#"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Template"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Status"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"PDF"})]})}),r.jsxs("tbody",{children:[f.map(j=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-3 py-2",children:j.id}),r.jsx("td",{className:"px-3 py-2",children:j.template_id}),r.jsx("td",{className:"px-3 py-2",children:j.status}),r.jsx("td",{className:"px-3 py-2",children:j.pdf_path?r.jsx("a",{href:j.pdf_path,target:"_blank",rel:"noreferrer",className:"text-blue-700 underline",children:"Open"}):r.jsx("span",{className:"text-gray-400",children:"-"})})]},j.id)),f.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:4,className:"px-3 py-6 text-center text-gray-500",children:"No consents"})})]})]})})]})]})]})]})}function kje(t={}){return J.get("/dashboard/data",{params:t})}var Aje=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function oA(t){if(typeof t!="string")return!1;var s=Aje;return s.includes(t)}var Eje=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function _U(t){if(typeof t!="string")return!1;var s=Eje;return s.includes(t)}function SU(t){return typeof t=="string"&&t.startsWith("data-")}function ql(t){var s=Object.entries(t).filter(n=>{var[a]=n;return _U(a)||SU(a)});return Object.fromEntries(s)}function Zp(t){if(t==null)return null;if(y.isValidElement(t)&&typeof t.props=="object"&&t.props!==null){var s=t.props;return ql(s)}return typeof t=="object"&&!Array.isArray(t)?ql(t):null}function Ti(t){var s=Object.entries(t).filter(n=>{var[a]=n;return _U(a)||SU(a)||oA(a)});return Object.fromEntries(s)}var Tje=["children","width","height","viewBox","className","style","title","desc"];function wS(){return wS=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},wS.apply(null,arguments)}function Pje(t,s){if(t==null)return{};var n,a,i=Ije(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function Ije(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}var CU=y.forwardRef((t,s)=>{var{children:n,width:a,height:i,viewBox:l,className:o,style:c,title:d,desc:u}=t,f=Pje(t,Tje),m=l||{width:a,height:i,x:0,y:0},x=ms("recharts-surface",o);return y.createElement("svg",wS({},Ti(f),{className:x,width:a,height:i,style:c,viewBox:"".concat(m.x," ").concat(m.y," ").concat(m.width," ").concat(m.height),ref:s}),y.createElement("title",null,d),y.createElement("desc",null,u),n)}),Mje=["children","className"];function NS(){return NS=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},NS.apply(null,arguments)}function Dje(t,s){if(t==null)return{};var n,a,i=Oje(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function Oje(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}var ia=y.forwardRef((t,s)=>{var{children:n,className:a}=t,i=Dje(t,Mje),l=ms("recharts-layer",a);return y.createElement("g",NS({className:l},Ti(i),{ref:s}),n)}),Rje=y.createContext(null);function Os(t){return function(){return t}}const kU=Math.cos,c1=Math.sin,hl=Math.sqrt,d1=Math.PI,cv=2*d1,jS=Math.PI,_S=2*jS,Sd=1e-6,Lje=_S-Sd;function AU(t){this._+=t[0];for(let s=1,n=t.length;s<n;++s)this._+=arguments[s]+t[s]}function Bje(t){let s=Math.floor(t);if(!(s>=0))throw new Error(`invalid digits: ${t}`);if(s>15)return AU;const n=10**s;return function(a){this._+=a[0];for(let i=1,l=a.length;i<l;++i)this._+=Math.round(arguments[i]*n)/n+a[i]}}class Fje{constructor(s){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=s==null?AU:Bje(s)}moveTo(s,n){this._append`M${this._x0=this._x1=+s},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(s,n){this._append`L${this._x1=+s},${this._y1=+n}`}quadraticCurveTo(s,n,a,i){this._append`Q${+s},${+n},${this._x1=+a},${this._y1=+i}`}bezierCurveTo(s,n,a,i,l,o){this._append`C${+s},${+n},${+a},${+i},${this._x1=+l},${this._y1=+o}`}arcTo(s,n,a,i,l){if(s=+s,n=+n,a=+a,i=+i,l=+l,l<0)throw new Error(`negative radius: ${l}`);let o=this._x1,c=this._y1,d=a-s,u=i-n,f=o-s,m=c-n,x=f*f+m*m;if(this._x1===null)this._append`M${this._x1=s},${this._y1=n}`;else if(x>Sd)if(!(Math.abs(m*d-u*f)>Sd)||!l)this._append`L${this._x1=s},${this._y1=n}`;else{let b=a-o,w=i-c,j=d*d+u*u,_=b*b+w*w,C=Math.sqrt(j),k=Math.sqrt(x),A=l*Math.tan((jS-Math.acos((j+x-_)/(2*C*k)))/2),T=A/k,P=A/C;Math.abs(T-1)>Sd&&this._append`L${s+T*f},${n+T*m}`,this._append`A${l},${l},0,0,${+(m*b>f*w)},${this._x1=s+P*d},${this._y1=n+P*u}`}}arc(s,n,a,i,l,o){if(s=+s,n=+n,a=+a,o=!!o,a<0)throw new Error(`negative radius: ${a}`);let c=a*Math.cos(i),d=a*Math.sin(i),u=s+c,f=n+d,m=1^o,x=o?i-l:l-i;this._x1===null?this._append`M${u},${f}`:(Math.abs(this._x1-u)>Sd||Math.abs(this._y1-f)>Sd)&&this._append`L${u},${f}`,a&&(x<0&&(x=x%_S+_S),x>Lje?this._append`A${a},${a},0,1,${m},${s-c},${n-d}A${a},${a},0,1,${m},${this._x1=u},${this._y1=f}`:x>Sd&&this._append`A${a},${a},0,${+(x>=jS)},${m},${this._x1=s+a*Math.cos(l)},${this._y1=n+a*Math.sin(l)}`)}rect(s,n,a,i){this._append`M${this._x0=this._x1=+s},${this._y0=this._y1=+n}h${a=+a}v${+i}h${-a}Z`}toString(){return this._}}function cA(t){let s=3;return t.digits=function(n){if(!arguments.length)return s;if(n==null)s=null;else{const a=Math.floor(n);if(!(a>=0))throw new RangeError(`invalid digits: ${n}`);s=a}return t},()=>new Fje(s)}function dA(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function EU(t){this._context=t}EU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,s){switch(t=+t,s=+s,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,s):this._context.moveTo(t,s);break;case 1:this._point=2;default:this._context.lineTo(t,s);break}}};function dv(t){return new EU(t)}function TU(t){return t[0]}function PU(t){return t[1]}function IU(t,s){var n=Os(!0),a=null,i=dv,l=null,o=cA(c);t=typeof t=="function"?t:t===void 0?TU:Os(t),s=typeof s=="function"?s:s===void 0?PU:Os(s);function c(d){var u,f=(d=dA(d)).length,m,x=!1,b;for(a==null&&(l=i(b=o())),u=0;u<=f;++u)!(u<f&&n(m=d[u],u,d))===x&&((x=!x)?l.lineStart():l.lineEnd()),x&&l.point(+t(m,u,d),+s(m,u,d));if(b)return l=null,b+""||null}return c.x=function(d){return arguments.length?(t=typeof d=="function"?d:Os(+d),c):t},c.y=function(d){return arguments.length?(s=typeof d=="function"?d:Os(+d),c):s},c.defined=function(d){return arguments.length?(n=typeof d=="function"?d:Os(!!d),c):n},c.curve=function(d){return arguments.length?(i=d,a!=null&&(l=i(a)),c):i},c.context=function(d){return arguments.length?(d==null?a=l=null:l=i(a=d),c):a},c}function Z0(t,s,n){var a=null,i=Os(!0),l=null,o=dv,c=null,d=cA(u);t=typeof t=="function"?t:t===void 0?TU:Os(+t),s=typeof s=="function"?s:Os(s===void 0?0:+s),n=typeof n=="function"?n:n===void 0?PU:Os(+n);function u(m){var x,b,w,j=(m=dA(m)).length,_,C=!1,k,A=new Array(j),T=new Array(j);for(l==null&&(c=o(k=d())),x=0;x<=j;++x){if(!(x<j&&i(_=m[x],x,m))===C)if(C=!C)b=x,c.areaStart(),c.lineStart();else{for(c.lineEnd(),c.lineStart(),w=x-1;w>=b;--w)c.point(A[w],T[w]);c.lineEnd(),c.areaEnd()}C&&(A[x]=+t(_,x,m),T[x]=+s(_,x,m),c.point(a?+a(_,x,m):A[x],n?+n(_,x,m):T[x]))}if(k)return c=null,k+""||null}function f(){return IU().defined(i).curve(o).context(l)}return u.x=function(m){return arguments.length?(t=typeof m=="function"?m:Os(+m),a=null,u):t},u.x0=function(m){return arguments.length?(t=typeof m=="function"?m:Os(+m),u):t},u.x1=function(m){return arguments.length?(a=m==null?null:typeof m=="function"?m:Os(+m),u):a},u.y=function(m){return arguments.length?(s=typeof m=="function"?m:Os(+m),n=null,u):s},u.y0=function(m){return arguments.length?(s=typeof m=="function"?m:Os(+m),u):s},u.y1=function(m){return arguments.length?(n=m==null?null:typeof m=="function"?m:Os(+m),u):n},u.lineX0=u.lineY0=function(){return f().x(t).y(s)},u.lineY1=function(){return f().x(t).y(n)},u.lineX1=function(){return f().x(a).y(s)},u.defined=function(m){return arguments.length?(i=typeof m=="function"?m:Os(!!m),u):i},u.curve=function(m){return arguments.length?(o=m,l!=null&&(c=o(l)),u):o},u.context=function(m){return arguments.length?(m==null?l=c=null:c=o(l=m),u):l},u}class MU{constructor(s,n){this._context=s,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(s,n){switch(s=+s,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(s,n):this._context.moveTo(s,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+s)/2,this._y0,this._x0,n,s,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,s,this._y0,s,n);break}}this._x0=s,this._y0=n}}function $je(t){return new MU(t,!0)}function zje(t){return new MU(t,!1)}const uA={draw(t,s){const n=hl(s/d1);t.moveTo(n,0),t.arc(0,0,n,0,cv)}},Uje={draw(t,s){const n=hl(s/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},DU=hl(1/3),Vje=DU*2,Hje={draw(t,s){const n=hl(s/Vje),a=n*DU;t.moveTo(0,-n),t.lineTo(a,0),t.lineTo(0,n),t.lineTo(-a,0),t.closePath()}},Wje={draw(t,s){const n=hl(s),a=-n/2;t.rect(a,a,n,n)}},qje=.8908130915292852,OU=c1(d1/10)/c1(7*d1/10),Gje=c1(cv/10)*OU,Kje=-kU(cv/10)*OU,Yje={draw(t,s){const n=hl(s*qje),a=Gje*n,i=Kje*n;t.moveTo(0,-n),t.lineTo(a,i);for(let l=1;l<5;++l){const o=cv*l/5,c=kU(o),d=c1(o);t.lineTo(d*n,-c*n),t.lineTo(c*a-d*i,d*a+c*i)}t.closePath()}},yj=hl(3),Xje={draw(t,s){const n=-hl(s/(yj*3));t.moveTo(0,n*2),t.lineTo(-yj*n,-n),t.lineTo(yj*n,-n),t.closePath()}},fi=-.5,mi=hl(3)/2,SS=1/hl(12),Qje=(SS/2+1)*3,Zje={draw(t,s){const n=hl(s/Qje),a=n/2,i=n*SS,l=a,o=n*SS+n,c=-l,d=o;t.moveTo(a,i),t.lineTo(l,o),t.lineTo(c,d),t.lineTo(fi*a-mi*i,mi*a+fi*i),t.lineTo(fi*l-mi*o,mi*l+fi*o),t.lineTo(fi*c-mi*d,mi*c+fi*d),t.lineTo(fi*a+mi*i,fi*i-mi*a),t.lineTo(fi*l+mi*o,fi*o-mi*l),t.lineTo(fi*c+mi*d,fi*d-mi*c),t.closePath()}};function Jje(t,s){let n=null,a=cA(i);t=typeof t=="function"?t:Os(t||uA),s=typeof s=="function"?s:Os(s===void 0?64:+s);function i(){let l;if(n||(n=l=a()),t.apply(this,arguments).draw(n,+s.apply(this,arguments)),l)return n=null,l+""||null}return i.type=function(l){return arguments.length?(t=typeof l=="function"?l:Os(l),i):t},i.size=function(l){return arguments.length?(s=typeof l=="function"?l:Os(+l),i):s},i.context=function(l){return arguments.length?(n=l??null,i):n},i}function u1(){}function h1(t,s,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+s)/6,(t._y0+4*t._y1+n)/6)}function RU(t){this._context=t}RU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:h1(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,s){switch(t=+t,s=+s,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,s):this._context.moveTo(t,s);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:h1(this,t,s);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=s}};function e2e(t){return new RU(t)}function LU(t){this._context=t}LU.prototype={areaStart:u1,areaEnd:u1,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,s){switch(t=+t,s=+s,this._point){case 0:this._point=1,this._x2=t,this._y2=s;break;case 1:this._point=2,this._x3=t,this._y3=s;break;case 2:this._point=3,this._x4=t,this._y4=s,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+s)/6);break;default:h1(this,t,s);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=s}};function t2e(t){return new LU(t)}function BU(t){this._context=t}BU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,s){switch(t=+t,s=+s,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,a=(this._y0+4*this._y1+s)/6;this._line?this._context.lineTo(n,a):this._context.moveTo(n,a);break;case 3:this._point=4;default:h1(this,t,s);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=s}};function s2e(t){return new BU(t)}function FU(t){this._context=t}FU.prototype={areaStart:u1,areaEnd:u1,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,s){t=+t,s=+s,this._point?this._context.lineTo(t,s):(this._point=1,this._context.moveTo(t,s))}};function n2e(t){return new FU(t)}function EM(t){return t<0?-1:1}function TM(t,s,n){var a=t._x1-t._x0,i=s-t._x1,l=(t._y1-t._y0)/(a||i<0&&-0),o=(n-t._y1)/(i||a<0&&-0),c=(l*i+o*a)/(a+i);return(EM(l)+EM(o))*Math.min(Math.abs(l),Math.abs(o),.5*Math.abs(c))||0}function PM(t,s){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-s)/2:s}function bj(t,s,n){var a=t._x0,i=t._y0,l=t._x1,o=t._y1,c=(l-a)/3;t._context.bezierCurveTo(a+c,i+c*s,l-c,o-c*n,l,o)}function f1(t){this._context=t}f1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:bj(this,this._t0,PM(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,s){var n=NaN;if(t=+t,s=+s,!(t===this._x1&&s===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,s):this._context.moveTo(t,s);break;case 1:this._point=2;break;case 2:this._point=3,bj(this,PM(this,n=TM(this,t,s)),n);break;default:bj(this,this._t0,n=TM(this,t,s));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=s,this._t0=n}}};function $U(t){this._context=new zU(t)}($U.prototype=Object.create(f1.prototype)).point=function(t,s){f1.prototype.point.call(this,s,t)};function zU(t){this._context=t}zU.prototype={moveTo:function(t,s){this._context.moveTo(s,t)},closePath:function(){this._context.closePath()},lineTo:function(t,s){this._context.lineTo(s,t)},bezierCurveTo:function(t,s,n,a,i,l){this._context.bezierCurveTo(s,t,a,n,l,i)}};function r2e(t){return new f1(t)}function a2e(t){return new $U(t)}function UU(t){this._context=t}UU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,s=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],s[0]):this._context.moveTo(t[0],s[0]),n===2)this._context.lineTo(t[1],s[1]);else for(var a=IM(t),i=IM(s),l=0,o=1;o<n;++l,++o)this._context.bezierCurveTo(a[0][l],i[0][l],a[1][l],i[1][l],t[o],s[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,s){this._x.push(+t),this._y.push(+s)}};function IM(t){var s,n=t.length-1,a,i=new Array(n),l=new Array(n),o=new Array(n);for(i[0]=0,l[0]=2,o[0]=t[0]+2*t[1],s=1;s<n-1;++s)i[s]=1,l[s]=4,o[s]=4*t[s]+2*t[s+1];for(i[n-1]=2,l[n-1]=7,o[n-1]=8*t[n-1]+t[n],s=1;s<n;++s)a=i[s]/l[s-1],l[s]-=a,o[s]-=a*o[s-1];for(i[n-1]=o[n-1]/l[n-1],s=n-2;s>=0;--s)i[s]=(o[s]-i[s+1])/l[s];for(l[n-1]=(t[n]+i[n-1])/2,s=0;s<n-1;++s)l[s]=2*t[s+1]-i[s+1];return[i,l]}function i2e(t){return new UU(t)}function uv(t,s){this._context=t,this._t=s}uv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,s){switch(t=+t,s=+s,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,s):this._context.moveTo(t,s);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,s),this._context.lineTo(t,s);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,s)}break}}this._x=t,this._y=s}};function l2e(t){return new uv(t,.5)}function o2e(t){return new uv(t,0)}function c2e(t){return new uv(t,1)}function cf(t,s){if((o=t.length)>1)for(var n=1,a,i,l=t[s[0]],o,c=l.length;n<o;++n)for(i=l,l=t[s[n]],a=0;a<c;++a)l[a][1]+=l[a][0]=isNaN(i[a][1])?i[a][0]:i[a][1]}function CS(t){for(var s=t.length,n=new Array(s);--s>=0;)n[s]=s;return n}function d2e(t,s){return t[s]}function u2e(t){const s=[];return s.key=t,s}function h2e(){var t=Os([]),s=CS,n=cf,a=d2e;function i(l){var o=Array.from(t.apply(this,arguments),u2e),c,d=o.length,u=-1,f;for(const m of l)for(c=0,++u;c<d;++c)(o[c][u]=[0,+a(m,o[c].key,u,l)]).data=m;for(c=0,f=dA(s(o));c<d;++c)o[f[c]].index=c;return n(o,f),o}return i.keys=function(l){return arguments.length?(t=typeof l=="function"?l:Os(Array.from(l)),i):t},i.value=function(l){return arguments.length?(a=typeof l=="function"?l:Os(+l),i):a},i.order=function(l){return arguments.length?(s=l==null?CS:typeof l=="function"?l:Os(Array.from(l)),i):s},i.offset=function(l){return arguments.length?(n=l??cf,i):n},i}function f2e(t,s){if((a=t.length)>0){for(var n,a,i=0,l=t[0].length,o;i<l;++i){for(o=n=0;n<a;++n)o+=t[n][i][1]||0;if(o)for(n=0;n<a;++n)t[n][i][1]/=o}cf(t,s)}}function m2e(t,s){if((i=t.length)>0){for(var n=0,a=t[s[0]],i,l=a.length;n<l;++n){for(var o=0,c=0;o<i;++o)c+=t[o][n][1]||0;a[n][1]+=a[n][0]=-c/2}cf(t,s)}}function p2e(t,s){if(!(!((o=t.length)>0)||!((l=(i=t[s[0]]).length)>0))){for(var n=0,a=1,i,l,o;a<l;++a){for(var c=0,d=0,u=0;c<o;++c){for(var f=t[s[c]],m=f[a][1]||0,x=f[a-1][1]||0,b=(m-x)/2,w=0;w<c;++w){var j=t[s[w]],_=j[a][1]||0,C=j[a-1][1]||0;b+=_-C}d+=m,u+=b*m}i[a-1][1]+=i[a-1][0]=n,d&&(n-=u/d)}i[a-1][1]+=i[a-1][0]=n,cf(t,s)}}var hv={},VU={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){return n==="__proto__"}t.isUnsafeProperty=s})(VU);var hA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){switch(typeof n){case"number":case"symbol":return!1;case"string":return n.includes(".")||n.includes("[")||n.includes("]")}}t.isDeepKey=s})(hA);var fv={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){var a;return typeof n=="string"||typeof n=="symbol"?n:Object.is((a=n==null?void 0:n.valueOf)==null?void 0:a.call(n),-0)?"-0":String(n)}t.toKey=s})(fv);var mv={},HU={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){if(n==null)return"";if(typeof n=="string")return n;if(Array.isArray(n))return n.map(s).join(",");const a=String(n);return a==="0"&&Object.is(Number(n),-0)?"-0":a}t.toString=s})(HU);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=HU,n=fv;function a(i){if(Array.isArray(i))return i.map(n.toKey);if(typeof i=="symbol")return[i];i=s.toString(i);const l=[],o=i.length;if(o===0)return l;let c=0,d="",u="",f=!1;for(i.charCodeAt(0)===46&&(l.push(""),c++);c<o;){const m=i[c];u?m==="\\"&&c+1<o?(c++,d+=i[c]):m===u?u="":d+=m:f?m==='"'||m==="'"?u=m:m==="]"?(f=!1,l.push(d),d=""):d+=m:m==="["?(f=!0,d&&(l.push(d),d="")):m==="."?d&&(l.push(d),d=""):d+=m,c++}return d&&l.push(d),l}t.toPath=a})(mv);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=VU,n=hA,a=fv,i=mv;function l(c,d,u){if(c==null)return u;switch(typeof d){case"string":{if(s.isUnsafeProperty(d))return u;const f=c[d];return f===void 0?n.isDeepKey(d)?l(c,i.toPath(d),u):u:f}case"number":case"symbol":{typeof d=="number"&&(d=a.toKey(d));const f=c[d];return f===void 0?u:f}default:{if(Array.isArray(d))return o(c,d,u);if(Object.is(d==null?void 0:d.valueOf(),-0)?d="-0":d=String(d),s.isUnsafeProperty(d))return u;const f=c[d];return f===void 0?u:f}}}function o(c,d,u){if(d.length===0)return u;let f=c;for(let m=0;m<d.length;m++){if(f==null||s.isUnsafeProperty(d[m]))return u;f=f[d[m]]}return f===void 0?u:f}t.get=l})(hv);var x2e=hv.get;const wu=Mi(x2e);var Ar=t=>t===0?0:t>0?1:-1,Gl=t=>typeof t=="number"&&t!=+t,To=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,Et=t=>(typeof t=="number"||t instanceof Number)&&!Gl(t),Kl=t=>Et(t)||typeof t=="string",g2e=0,Jp=t=>{var s=++g2e;return"".concat(t||"").concat(s)},Hr=function(s,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Et(s)&&typeof s!="string")return a;var l;if(To(s)){if(n==null)return a;var o=s.indexOf("%");l=n*parseFloat(s.slice(0,o))/100}else l=+s;return Gl(l)&&(l=a),i&&n!=null&&l>n&&(l=n),l},WU=t=>{if(!Array.isArray(t))return!1;for(var s=t.length,n={},a=0;a<s;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1};function Hn(t,s,n){return Et(t)&&Et(s)?t+n*(s-t):s}function y2e(t,s,n){if(!(!t||!t.length))return t.find(a=>a&&(typeof s=="function"?s(a):wu(a,s))===n)}var fr=t=>t===null||typeof t>"u",Mx=t=>fr(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1));function b2e(t){return t!=null}function Lu(){}var v2e=["type","size","sizeType"];function kS(){return kS=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},kS.apply(null,arguments)}function MM(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function DM(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?MM(Object(n),!0).forEach(function(a){w2e(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):MM(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function w2e(t,s,n){return(s=N2e(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function N2e(t){var s=j2e(t,"string");return typeof s=="symbol"?s:s+""}function j2e(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function _2e(t,s){if(t==null)return{};var n,a,i=S2e(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function S2e(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}var qU={symbolCircle:uA,symbolCross:Uje,symbolDiamond:Hje,symbolSquare:Wje,symbolStar:Yje,symbolTriangle:Xje,symbolWye:Zje},C2e=Math.PI/180,k2e=t=>{var s="symbol".concat(Mx(t));return qU[s]||uA},A2e=(t,s,n)=>{if(s==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*C2e;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.tan(a)**2)}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},E2e=(t,s)=>{qU["symbol".concat(Mx(t))]=s},GU=t=>{var{type:s="circle",size:n=64,sizeType:a="area"}=t,i=_2e(t,v2e),l=DM(DM({},i),{},{type:s,size:n,sizeType:a}),o="circle";typeof s=="string"&&(o=s);var c=()=>{var x=k2e(o),b=Jje().type(x).size(A2e(n,a,o)),w=b();if(w!==null)return w},{className:d,cx:u,cy:f}=l,m=Ti(l);return Et(u)&&Et(f)&&Et(n)?y.createElement("path",kS({},m,{className:ms("recharts-symbols",d),transform:"translate(".concat(u,", ").concat(f,")"),d:c()})):null};GU.registerSymbol=E2e;var KU=t=>"radius"in t&&"startAngle"in t&&"endAngle"in t,T2e=(t,s)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(y.isValidElement(t)&&(n=t.props),typeof n!="object"&&typeof n!="function")return null;var a={};return Object.keys(n).forEach(i=>{oA(i)&&(a[i]=l=>n[i](n,l))}),a},P2e=(t,s,n)=>a=>(t(s,n,a),null),pv=(t,s,n)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var a=null;return Object.keys(t).forEach(i=>{var l=t[i];oA(i)&&typeof l=="function"&&(a||(a={}),a[i]=P2e(l,s,n))}),a};function OM(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function I2e(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?OM(Object(n),!0).forEach(function(a){M2e(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):OM(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function M2e(t,s,n){return(s=D2e(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function D2e(t){var s=O2e(t,"string");return typeof s=="symbol"?s:s+""}function O2e(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function ca(t,s){var n=I2e({},t),a=s,i=Object.keys(s),l=i.reduce((o,c)=>(o[c]===void 0&&a[c]!==void 0&&(o[c]=a[c]),o),n);return l}var YU={},XU={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n,a){const i=new Map;for(let l=0;l<n.length;l++){const o=n[l],c=a(o);i.has(c)||i.set(c,o)}return Array.from(i.values())}t.uniqBy=s})(XU);var fA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){return n}t.identity=s})(fA);var QU={},xv={},ZU={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){return Number.isSafeInteger(n)&&n>=0}t.isLength=s})(ZU);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=ZU;function n(a){return a!=null&&typeof a!="function"&&s.isLength(a.length)}t.isArrayLike=n})(xv);var JU={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){return typeof n=="object"&&n!==null}t.isObjectLike=s})(JU);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=xv,n=JU;function a(i){return n.isObjectLike(i)&&s.isArrayLike(i)}t.isArrayLikeObject=a})(QU);var eV={},tV={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=hv;function n(a){return function(i){return s.get(i,a)}}t.property=n})(tV);var sV={},mA={},nV={},pA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){return n!==null&&(typeof n=="object"||typeof n=="function")}t.isObject=s})(pA);var xA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){return n==null||typeof n!="object"&&typeof n!="function"}t.isPrimitive=s})(xA);var gA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n,a){return n===a||Number.isNaN(n)&&Number.isNaN(a)}t.eq=s})(gA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=pA,n=xA,a=gA;function i(f,m,x){return typeof x!="function"?i(f,m,()=>{}):l(f,m,function b(w,j,_,C,k,A){const T=x(w,j,_,C,k,A);return T!==void 0?!!T:l(w,j,b,A)},new Map)}function l(f,m,x,b){if(m===f)return!0;switch(typeof m){case"object":return o(f,m,x,b);case"function":return Object.keys(m).length>0?l(f,{...m},x,b):a.eq(f,m);default:return s.isObject(f)?typeof m=="string"?m==="":!0:a.eq(f,m)}}function o(f,m,x,b){if(m==null)return!0;if(Array.isArray(m))return d(f,m,x,b);if(m instanceof Map)return c(f,m,x,b);if(m instanceof Set)return u(f,m,x,b);const w=Object.keys(m);if(f==null)return w.length===0;if(w.length===0)return!0;if(b!=null&&b.has(m))return b.get(m)===f;b==null||b.set(m,f);try{for(let j=0;j<w.length;j++){const _=w[j];if(!n.isPrimitive(f)&&!(_ in f)||m[_]===void 0&&f[_]!==void 0||m[_]===null&&f[_]!==null||!x(f[_],m[_],_,f,m,b))return!1}return!0}finally{b==null||b.delete(m)}}function c(f,m,x,b){if(m.size===0)return!0;if(!(f instanceof Map))return!1;for(const[w,j]of m.entries()){const _=f.get(w);if(x(_,j,w,f,m,b)===!1)return!1}return!0}function d(f,m,x,b){if(m.length===0)return!0;if(!Array.isArray(f))return!1;const w=new Set;for(let j=0;j<m.length;j++){const _=m[j];let C=!1;for(let k=0;k<f.length;k++){if(w.has(k))continue;const A=f[k];let T=!1;if(x(A,_,j,f,m,b)&&(T=!0),T){w.add(k),C=!0;break}}if(!C)return!1}return!0}function u(f,m,x,b){return m.size===0?!0:f instanceof Set?d([...f],[...m],x,b):!1}t.isMatchWith=i,t.isSetMatch=u})(nV);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=nV;function n(a,i){return s.isMatchWith(a,i,()=>{})}t.isMatch=n})(mA);var rV={},yA={},aV={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){return Object.getOwnPropertySymbols(n).filter(a=>Object.prototype.propertyIsEnumerable.call(n,a))}t.getSymbols=s})(aV);var bA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}t.getTag=s})(bA);var vA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s="[object RegExp]",n="[object String]",a="[object Number]",i="[object Boolean]",l="[object Arguments]",o="[object Symbol]",c="[object Date]",d="[object Map]",u="[object Set]",f="[object Array]",m="[object Function]",x="[object ArrayBuffer]",b="[object Object]",w="[object Error]",j="[object DataView]",_="[object Uint8Array]",C="[object Uint8ClampedArray]",k="[object Uint16Array]",A="[object Uint32Array]",T="[object BigUint64Array]",P="[object Int8Array]",R="[object Int16Array]",I="[object Int32Array]",O="[object BigInt64Array]",M="[object Float32Array]",B="[object Float64Array]";t.argumentsTag=l,t.arrayBufferTag=x,t.arrayTag=f,t.bigInt64ArrayTag=O,t.bigUint64ArrayTag=T,t.booleanTag=i,t.dataViewTag=j,t.dateTag=c,t.errorTag=w,t.float32ArrayTag=M,t.float64ArrayTag=B,t.functionTag=m,t.int16ArrayTag=R,t.int32ArrayTag=I,t.int8ArrayTag=P,t.mapTag=d,t.numberTag=a,t.objectTag=b,t.regexpTag=s,t.setTag=u,t.stringTag=n,t.symbolTag=o,t.uint16ArrayTag=k,t.uint32ArrayTag=A,t.uint8ArrayTag=_,t.uint8ClampedArrayTag=C})(vA);var iV={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}t.isTypedArray=s})(iV);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=aV,n=bA,a=vA,i=xA,l=iV;function o(f,m){return c(f,void 0,f,new Map,m)}function c(f,m,x,b=new Map,w=void 0){const j=w==null?void 0:w(f,m,x,b);if(j!==void 0)return j;if(i.isPrimitive(f))return f;if(b.has(f))return b.get(f);if(Array.isArray(f)){const _=new Array(f.length);b.set(f,_);for(let C=0;C<f.length;C++)_[C]=c(f[C],C,x,b,w);return Object.hasOwn(f,"index")&&(_.index=f.index),Object.hasOwn(f,"input")&&(_.input=f.input),_}if(f instanceof Date)return new Date(f.getTime());if(f instanceof RegExp){const _=new RegExp(f.source,f.flags);return _.lastIndex=f.lastIndex,_}if(f instanceof Map){const _=new Map;b.set(f,_);for(const[C,k]of f)_.set(C,c(k,C,x,b,w));return _}if(f instanceof Set){const _=new Set;b.set(f,_);for(const C of f)_.add(c(C,void 0,x,b,w));return _}if(typeof Buffer<"u"&&Buffer.isBuffer(f))return f.subarray();if(l.isTypedArray(f)){const _=new(Object.getPrototypeOf(f)).constructor(f.length);b.set(f,_);for(let C=0;C<f.length;C++)_[C]=c(f[C],C,x,b,w);return _}if(f instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&f instanceof SharedArrayBuffer)return f.slice(0);if(f instanceof DataView){const _=new DataView(f.buffer.slice(0),f.byteOffset,f.byteLength);return b.set(f,_),d(_,f,x,b,w),_}if(typeof File<"u"&&f instanceof File){const _=new File([f],f.name,{type:f.type});return b.set(f,_),d(_,f,x,b,w),_}if(typeof Blob<"u"&&f instanceof Blob){const _=new Blob([f],{type:f.type});return b.set(f,_),d(_,f,x,b,w),_}if(f instanceof Error){const _=new f.constructor;return b.set(f,_),_.message=f.message,_.name=f.name,_.stack=f.stack,_.cause=f.cause,d(_,f,x,b,w),_}if(f instanceof Boolean){const _=new Boolean(f.valueOf());return b.set(f,_),d(_,f,x,b,w),_}if(f instanceof Number){const _=new Number(f.valueOf());return b.set(f,_),d(_,f,x,b,w),_}if(f instanceof String){const _=new String(f.valueOf());return b.set(f,_),d(_,f,x,b,w),_}if(typeof f=="object"&&u(f)){const _=Object.create(Object.getPrototypeOf(f));return b.set(f,_),d(_,f,x,b,w),_}return f}function d(f,m,x=f,b,w){const j=[...Object.keys(m),...s.getSymbols(m)];for(let _=0;_<j.length;_++){const C=j[_],k=Object.getOwnPropertyDescriptor(f,C);(k==null||k.writable)&&(f[C]=c(m[C],C,x,b,w))}}function u(f){switch(n.getTag(f)){case a.argumentsTag:case a.arrayTag:case a.arrayBufferTag:case a.dataViewTag:case a.booleanTag:case a.dateTag:case a.float32ArrayTag:case a.float64ArrayTag:case a.int8ArrayTag:case a.int16ArrayTag:case a.int32ArrayTag:case a.mapTag:case a.numberTag:case a.objectTag:case a.regexpTag:case a.setTag:case a.stringTag:case a.symbolTag:case a.uint8ArrayTag:case a.uint8ClampedArrayTag:case a.uint16ArrayTag:case a.uint32ArrayTag:return!0;default:return!1}}t.cloneDeepWith=o,t.cloneDeepWithImpl=c,t.copyProperties=d})(yA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=yA;function n(a){return s.cloneDeepWithImpl(a,void 0,a,new Map,void 0)}t.cloneDeep=n})(rV);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=mA,n=rV;function a(i){return i=n.cloneDeep(i),l=>s.isMatch(l,i)}t.matches=a})(sV);var lV={},oV={},cV={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=yA,n=vA;function a(i,l){return s.cloneDeepWith(i,(o,c,d,u)=>{const f=l==null?void 0:l(o,c,d,u);if(f!==void 0)return f;if(typeof i=="object")switch(Object.prototype.toString.call(i)){case n.numberTag:case n.stringTag:case n.booleanTag:{const m=new i.constructor(i==null?void 0:i.valueOf());return s.copyProperties(m,i),m}case n.argumentsTag:{const m={};return s.copyProperties(m,i),m.length=i.length,m[Symbol.iterator]=i[Symbol.iterator],m}default:return}})}t.cloneDeepWith=a})(cV);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=cV;function n(a){return s.cloneDeepWith(a)}t.cloneDeep=n})(oV);var dV={},wA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=/^(?:0|[1-9]\d*)$/;function n(a,i=Number.MAX_SAFE_INTEGER){switch(typeof a){case"number":return Number.isInteger(a)&&a>=0&&a<i;case"symbol":return!1;case"string":return s.test(a)}}t.isIndex=n})(wA);var uV={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=bA;function n(a){return a!==null&&typeof a=="object"&&s.getTag(a)==="[object Arguments]"}t.isArguments=n})(uV);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=hA,n=wA,a=uV,i=mv;function l(o,c){let d;if(Array.isArray(c)?d=c:typeof c=="string"&&s.isDeepKey(c)&&(o==null?void 0:o[c])==null?d=i.toPath(c):d=[c],d.length===0)return!1;let u=o;for(let f=0;f<d.length;f++){const m=d[f];if((u==null||!Object.hasOwn(u,m))&&!((Array.isArray(u)||a.isArguments(u))&&n.isIndex(m)&&m<u.length))return!1;u=u[m]}return!0}t.has=l})(dV);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=mA,n=fv,a=oV,i=hv,l=dV;function o(c,d){switch(typeof c){case"object":{Object.is(c==null?void 0:c.valueOf(),-0)&&(c="-0");break}case"number":{c=n.toKey(c);break}}return d=a.cloneDeep(d),function(u){const f=i.get(u,c);return f===void 0?l.has(u,c):d===void 0?f===void 0:s.isMatch(f,d)}}t.matchesProperty=o})(lV);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=fA,n=tV,a=sV,i=lV;function l(o){if(o==null)return s.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?i.matchesProperty(o[0],o[1]):a.matches(o);case"string":case"symbol":case"number":return n.property(o)}}t.iteratee=l})(eV);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=XU,n=fA,a=QU,i=eV;function l(o,c=n.identity){return a.isArrayLikeObject(o)?s.uniqBy(Array.from(o),i.iteratee(c)):[]}t.uniqBy=l})(YU);var R2e=YU.uniqBy;const RM=Mi(R2e);function L2e(t,s,n){return s===!0?RM(t,n):typeof s=="function"?RM(t,s):t}var NA=y.createContext(null),B2e=t=>t,Ys=()=>{var t=y.useContext(NA);return t?t.store.dispatch:B2e},Qg=()=>{},F2e=()=>Qg,$2e=(t,s)=>t===s;function _t(t){var s=y.useContext(NA);return c7.useSyncExternalStoreWithSelector(s?s.subscription.addNestedSub:F2e,s?s.store.getState:Qg,s?s.store.getState:Qg,s?t:Qg,$2e)}function z2e(t,s=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(s)}function U2e(t,s=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(s)}function V2e(t,s="expected all items to be functions, instead received the following types: "){if(!t.every(n=>typeof n=="function")){const n=t.map(a=>typeof a=="function"?`function ${a.name||"unnamed"}()`:typeof a).join(", ");throw new TypeError(`${s}[${n}]`)}}var LM=t=>Array.isArray(t)?t:[t];function H2e(t){const s=Array.isArray(t[0])?t[0]:t;return V2e(s,"createSelector expects all input-selectors to be functions, but received the following types: "),s}function W2e(t,s){const n=[],{length:a}=t;for(let i=0;i<a;i++)n.push(t[i].apply(null,s));return n}var q2e=class{constructor(t){this.value=t}deref(){return this.value}},G2e=typeof WeakRef<"u"?WeakRef:q2e,K2e=0,BM=1;function J0(){return{s:K2e,v:void 0,o:null,p:null}}function hV(t,s={}){let n=J0();const{resultEqualityCheck:a}=s;let i,l=0;function o(){var m;let c=n;const{length:d}=arguments;for(let x=0,b=d;x<b;x++){const w=arguments[x];if(typeof w=="function"||typeof w=="object"&&w!==null){let j=c.o;j===null&&(c.o=j=new WeakMap);const _=j.get(w);_===void 0?(c=J0(),j.set(w,c)):c=_}else{let j=c.p;j===null&&(c.p=j=new Map);const _=j.get(w);_===void 0?(c=J0(),j.set(w,c)):c=_}}const u=c;let f;if(c.s===BM)f=c.v;else if(f=t.apply(null,arguments),l++,a){const x=((m=i==null?void 0:i.deref)==null?void 0:m.call(i))??i;x!=null&&a(x,f)&&(f=x,l!==0&&l--),i=typeof f=="object"&&f!==null||typeof f=="function"?new G2e(f):f}return u.s=BM,u.v=f,f}return o.clearCache=()=>{n=J0(),o.resetResultsCount()},o.resultsCount=()=>l,o.resetResultsCount=()=>{l=0},o}function Y2e(t,...s){const n=typeof t=="function"?{memoize:t,memoizeOptions:s}:t,a=(...i)=>{let l=0,o=0,c,d={},u=i.pop();typeof u=="object"&&(d=u,u=i.pop()),z2e(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const f={...n,...d},{memoize:m,memoizeOptions:x=[],argsMemoize:b=hV,argsMemoizeOptions:w=[]}=f,j=LM(x),_=LM(w),C=H2e(i),k=m(function(){return l++,u.apply(null,arguments)},...j),A=b(function(){o++;const P=W2e(C,arguments);return c=k.apply(null,P),c},..._);return Object.assign(A,{resultFunc:u,memoizedResultFunc:k,dependencies:C,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>c,recomputations:()=>l,resetRecomputations:()=>{l=0},memoize:m,argsMemoize:b})};return Object.assign(a,{withTypes:()=>a}),a}var Ae=Y2e(hV),X2e=Object.assign((t,s=Ae)=>{U2e(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const n=Object.keys(t),a=n.map(l=>t[l]);return s(a,(...l)=>l.reduce((o,c,d)=>(o[n[d]]=c,o),{}))},{withTypes:()=>X2e}),fV={},mV={},pV={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(a){return typeof a=="symbol"?1:a===null?2:a===void 0?3:a!==a?4:0}const n=(a,i,l)=>{if(a!==i){const o=s(a),c=s(i);if(o===c&&o===0){if(a<i)return l==="desc"?1:-1;if(a>i)return l==="desc"?-1:1}return l==="desc"?c-o:o-c}return 0};t.compareValues=n})(pV);var xV={},jA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){return typeof n=="symbol"||n instanceof Symbol}t.isSymbol=s})(jA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=jA,n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;function i(l,o){return Array.isArray(l)?!1:typeof l=="number"||typeof l=="boolean"||l==null||s.isSymbol(l)?!0:typeof l=="string"&&(a.test(l)||!n.test(l))||o!=null&&Object.hasOwn(o,l)}t.isKey=i})(xV);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=pV,n=xV,a=mv;function i(l,o,c,d){if(l==null)return[];c=d?void 0:c,Array.isArray(l)||(l=Object.values(l)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(c)||(c=c==null?[]:[c]),c=c.map(b=>String(b));const u=(b,w)=>{let j=b;for(let _=0;_<w.length&&j!=null;++_)j=j[w[_]];return j},f=(b,w)=>w==null||b==null?w:typeof b=="object"&&"key"in b?Object.hasOwn(w,b.key)?w[b.key]:u(w,b.path):typeof b=="function"?b(w):Array.isArray(b)?u(w,b):typeof w=="object"?w[b]:w,m=o.map(b=>(Array.isArray(b)&&b.length===1&&(b=b[0]),b==null||typeof b=="function"||Array.isArray(b)||n.isKey(b)?b:{key:b,path:a.toPath(b)}));return l.map(b=>({original:b,criteria:m.map(w=>f(w,b))})).slice().sort((b,w)=>{for(let j=0;j<m.length;j++){const _=s.compareValues(b.criteria[j],w.criteria[j],c[j]);if(_!==0)return _}return 0}).map(b=>b.original)}t.orderBy=i})(mV);var gV={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n,a=1){const i=[],l=Math.floor(a),o=(c,d)=>{for(let u=0;u<c.length;u++){const f=c[u];Array.isArray(f)&&d<l?o(f,d+1):i.push(f)}};return o(n,0),i}t.flatten=s})(gV);var _A={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=wA,n=xv,a=pA,i=gA;function l(o,c,d){return a.isObject(d)&&(typeof c=="number"&&n.isArrayLike(d)&&s.isIndex(c)&&c<d.length||typeof c=="string"&&c in d)?i.eq(d[c],o):!1}t.isIterateeCall=l})(_A);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=mV,n=gV,a=_A;function i(l,...o){const c=o.length;return c>1&&a.isIterateeCall(l,o[0],o[1])?o=[]:c>2&&a.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),s.orderBy(l,n.flatten(o),["asc"])}t.sortBy=i})(fV);var Q2e=fV.sortBy;const gv=Mi(Q2e);var yV=t=>t.legend.settings,Z2e=t=>t.legend.size,J2e=t=>t.legend.payload;Ae([J2e,yV],(t,s)=>{var{itemSorter:n}=s,a=t.flat(1);return n?gv(a,n):a});var eg=1;function e_e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[s,n]=y.useState({height:0,left:0,top:0,width:0}),a=y.useCallback(i=>{if(i!=null){var l=i.getBoundingClientRect(),o={height:l.height,left:l.left,top:l.top,width:l.width};(Math.abs(o.height-s.height)>eg||Math.abs(o.left-s.left)>eg||Math.abs(o.top-s.top)>eg||Math.abs(o.width-s.width)>eg)&&n({height:o.height,left:o.left,top:o.top,width:o.width})}},[s.width,s.height,s.top,s.left,...t]);return[s,a]}function jr(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var t_e=typeof Symbol=="function"&&Symbol.observable||"@@observable",FM=t_e,vj=()=>Math.random().toString(36).substring(7).split("").join("."),s_e={INIT:`@@redux/INIT${vj()}`,REPLACE:`@@redux/REPLACE${vj()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${vj()}`},m1=s_e;function SA(t){if(typeof t!="object"||t===null)return!1;let s=t;for(;Object.getPrototypeOf(s)!==null;)s=Object.getPrototypeOf(s);return Object.getPrototypeOf(t)===s||Object.getPrototypeOf(t)===null}function bV(t,s,n){if(typeof t!="function")throw new Error(jr(2));if(typeof s=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(jr(0));if(typeof s=="function"&&typeof n>"u"&&(n=s,s=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(jr(1));return n(bV)(t,s)}let a=t,i=s,l=new Map,o=l,c=0,d=!1;function u(){o===l&&(o=new Map,l.forEach((_,C)=>{o.set(C,_)}))}function f(){if(d)throw new Error(jr(3));return i}function m(_){if(typeof _!="function")throw new Error(jr(4));if(d)throw new Error(jr(5));let C=!0;u();const k=c++;return o.set(k,_),function(){if(C){if(d)throw new Error(jr(6));C=!1,u(),o.delete(k),l=null}}}function x(_){if(!SA(_))throw new Error(jr(7));if(typeof _.type>"u")throw new Error(jr(8));if(typeof _.type!="string")throw new Error(jr(17));if(d)throw new Error(jr(9));try{d=!0,i=a(i,_)}finally{d=!1}return(l=o).forEach(k=>{k()}),_}function b(_){if(typeof _!="function")throw new Error(jr(10));a=_,x({type:m1.REPLACE})}function w(){const _=m;return{subscribe(C){if(typeof C!="object"||C===null)throw new Error(jr(11));function k(){const T=C;T.next&&T.next(f())}return k(),{unsubscribe:_(k)}},[FM](){return this}}}return x({type:m1.INIT}),{dispatch:x,subscribe:m,getState:f,replaceReducer:b,[FM]:w}}function n_e(t){Object.keys(t).forEach(s=>{const n=t[s];if(typeof n(void 0,{type:m1.INIT})>"u")throw new Error(jr(12));if(typeof n(void 0,{type:m1.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(jr(13))})}function vV(t){const s=Object.keys(t),n={};for(let l=0;l<s.length;l++){const o=s[l];typeof t[o]=="function"&&(n[o]=t[o])}const a=Object.keys(n);let i;try{n_e(n)}catch(l){i=l}return function(o={},c){if(i)throw i;let d=!1;const u={};for(let f=0;f<a.length;f++){const m=a[f],x=n[m],b=o[m],w=x(b,c);if(typeof w>"u")throw c&&c.type,new Error(jr(14));u[m]=w,d=d||w!==b}return d=d||a.length!==Object.keys(o).length,d?u:o}}function p1(...t){return t.length===0?s=>s:t.length===1?t[0]:t.reduce((s,n)=>(...a)=>s(n(...a)))}function r_e(...t){return s=>(n,a)=>{const i=s(n,a);let l=()=>{throw new Error(jr(15))};const o={getState:i.getState,dispatch:(d,...u)=>l(d,...u)},c=t.map(d=>d(o));return l=p1(...c)(i.dispatch),{...i,dispatch:l}}}function wV(t){return SA(t)&&"type"in t&&typeof t.type=="string"}var NV=Symbol.for("immer-nothing"),$M=Symbol.for("immer-draftable"),ti=Symbol.for("immer-state");function Xi(t,...s){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var ex=Object.getPrototypeOf;function Nu(t){return!!t&&!!t[ti]}function Po(t){var s;return t?jV(t)||Array.isArray(t)||!!t[$M]||!!((s=t.constructor)!=null&&s[$M])||Dx(t)||bv(t):!1}var a_e=Object.prototype.constructor.toString(),zM=new WeakMap;function jV(t){if(!t||typeof t!="object")return!1;const s=Object.getPrototypeOf(t);if(s===null||s===Object.prototype)return!0;const n=Object.hasOwnProperty.call(s,"constructor")&&s.constructor;if(n===Object)return!0;if(typeof n!="function")return!1;let a=zM.get(n);return a===void 0&&(a=Function.toString.call(n),zM.set(n,a)),a===a_e}function x1(t,s,n=!0){yv(t)===0?(n?Reflect.ownKeys(t):Object.keys(t)).forEach(i=>{s(i,t[i],t)}):t.forEach((a,i)=>s(i,a,t))}function yv(t){const s=t[ti];return s?s.type_:Array.isArray(t)?1:Dx(t)?2:bv(t)?3:0}function AS(t,s){return yv(t)===2?t.has(s):Object.prototype.hasOwnProperty.call(t,s)}function _V(t,s,n){const a=yv(t);a===2?t.set(s,n):a===3?t.add(n):t[s]=n}function i_e(t,s){return t===s?t!==0||1/t===1/s:t!==t&&s!==s}function Dx(t){return t instanceof Map}function bv(t){return t instanceof Set}function Cd(t){return t.copy_||t.base_}function ES(t,s){if(Dx(t))return new Map(t);if(bv(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const n=jV(t);if(s===!0||s==="class_only"&&!n){const a=Object.getOwnPropertyDescriptors(t);delete a[ti];let i=Reflect.ownKeys(a);for(let l=0;l<i.length;l++){const o=i[l],c=a[o];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(a[o]={configurable:!0,writable:!0,enumerable:c.enumerable,value:t[o]})}return Object.create(ex(t),a)}else{const a=ex(t);if(a!==null&&n)return{...t};const i=Object.create(a);return Object.assign(i,t)}}function CA(t,s=!1){return vv(t)||Nu(t)||!Po(t)||(yv(t)>1&&Object.defineProperties(t,{set:tg,add:tg,clear:tg,delete:tg}),Object.freeze(t),s&&Object.values(t).forEach(n=>CA(n,!0))),t}function l_e(){Xi(2)}var tg={value:l_e};function vv(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var o_e={};function ju(t){const s=o_e[t];return s||Xi(0,t),s}var tx;function SV(){return tx}function c_e(t,s){return{drafts_:[],parent_:t,immer_:s,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function UM(t,s){s&&(ju("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=s)}function TS(t){PS(t),t.drafts_.forEach(d_e),t.drafts_=null}function PS(t){t===tx&&(tx=t.parent_)}function VM(t){return tx=c_e(tx,t)}function d_e(t){const s=t[ti];s.type_===0||s.type_===1?s.revoke_():s.revoked_=!0}function HM(t,s){s.unfinalizedDrafts_=s.drafts_.length;const n=s.drafts_[0];return t!==void 0&&t!==n?(n[ti].modified_&&(TS(s),Xi(4)),Po(t)&&(t=g1(s,t),s.parent_||y1(s,t)),s.patches_&&ju("Patches").generateReplacementPatches_(n[ti].base_,t,s.patches_,s.inversePatches_)):t=g1(s,n,[]),TS(s),s.patches_&&s.patchListener_(s.patches_,s.inversePatches_),t!==NV?t:void 0}function g1(t,s,n){if(vv(s))return s;const a=t.immer_.shouldUseStrictIteration(),i=s[ti];if(!i)return x1(s,(l,o)=>WM(t,i,s,l,o,n),a),s;if(i.scope_!==t)return s;if(!i.modified_)return y1(t,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const l=i.copy_;let o=l,c=!1;i.type_===3&&(o=new Set(l),l.clear(),c=!0),x1(o,(d,u)=>WM(t,i,l,d,u,n,c),a),y1(t,l,!1),n&&t.patches_&&ju("Patches").generatePatches_(i,n,t.patches_,t.inversePatches_)}return i.copy_}function WM(t,s,n,a,i,l,o){if(i==null||typeof i!="object"&&!o)return;const c=vv(i);if(!(c&&!o)){if(Nu(i)){const d=l&&s&&s.type_!==3&&!AS(s.assigned_,a)?l.concat(a):void 0,u=g1(t,i,d);if(_V(n,a,u),Nu(u))t.canAutoFreeze_=!1;else return}else o&&n.add(i);if(Po(i)&&!c){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||s&&s.base_&&s.base_[a]===i&&c)return;g1(t,i),(!s||!s.scope_.parent_)&&typeof a!="symbol"&&(Dx(n)?n.has(a):Object.prototype.propertyIsEnumerable.call(n,a))&&y1(t,i)}}}function y1(t,s,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&CA(s,n)}function u_e(t,s){const n=Array.isArray(t),a={type_:n?1:0,scope_:s?s.scope_:SV(),modified_:!1,finalized_:!1,assigned_:{},parent_:s,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=a,l=kA;n&&(i=[a],l=sx);const{revoke:o,proxy:c}=Proxy.revocable(i,l);return a.draft_=c,a.revoke_=o,c}var kA={get(t,s){if(s===ti)return t;const n=Cd(t);if(!AS(n,s))return h_e(t,n,s);const a=n[s];return t.finalized_||!Po(a)?a:a===wj(t.base_,s)?(Nj(t),t.copy_[s]=MS(a,t)):a},has(t,s){return s in Cd(t)},ownKeys(t){return Reflect.ownKeys(Cd(t))},set(t,s,n){const a=CV(Cd(t),s);if(a!=null&&a.set)return a.set.call(t.draft_,n),!0;if(!t.modified_){const i=wj(Cd(t),s),l=i==null?void 0:i[ti];if(l&&l.base_===n)return t.copy_[s]=n,t.assigned_[s]=!1,!0;if(i_e(n,i)&&(n!==void 0||AS(t.base_,s)))return!0;Nj(t),IS(t)}return t.copy_[s]===n&&(n!==void 0||s in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[s])||(t.copy_[s]=n,t.assigned_[s]=!0),!0},deleteProperty(t,s){return wj(t.base_,s)!==void 0||s in t.base_?(t.assigned_[s]=!1,Nj(t),IS(t)):delete t.assigned_[s],t.copy_&&delete t.copy_[s],!0},getOwnPropertyDescriptor(t,s){const n=Cd(t),a=Reflect.getOwnPropertyDescriptor(n,s);return a&&{writable:!0,configurable:t.type_!==1||s!=="length",enumerable:a.enumerable,value:n[s]}},defineProperty(){Xi(11)},getPrototypeOf(t){return ex(t.base_)},setPrototypeOf(){Xi(12)}},sx={};x1(kA,(t,s)=>{sx[t]=function(){return arguments[0]=arguments[0][0],s.apply(this,arguments)}});sx.deleteProperty=function(t,s){return sx.set.call(this,t,s,void 0)};sx.set=function(t,s,n){return kA.set.call(this,t[0],s,n,t[0])};function wj(t,s){const n=t[ti];return(n?Cd(n):t)[s]}function h_e(t,s,n){var i;const a=CV(s,n);return a?"value"in a?a.value:(i=a.get)==null?void 0:i.call(t.draft_):void 0}function CV(t,s){if(!(s in t))return;let n=ex(t);for(;n;){const a=Object.getOwnPropertyDescriptor(n,s);if(a)return a;n=ex(n)}}function IS(t){t.modified_||(t.modified_=!0,t.parent_&&IS(t.parent_))}function Nj(t){t.copy_||(t.copy_=ES(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var f_e=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(s,n,a)=>{if(typeof s=="function"&&typeof n!="function"){const l=n;n=s;const o=this;return function(d=l,...u){return o.produce(d,f=>n.call(this,f,...u))}}typeof n!="function"&&Xi(6),a!==void 0&&typeof a!="function"&&Xi(7);let i;if(Po(s)){const l=VM(this),o=MS(s,void 0);let c=!0;try{i=n(o),c=!1}finally{c?TS(l):PS(l)}return UM(l,a),HM(i,l)}else if(!s||typeof s!="object"){if(i=n(s),i===void 0&&(i=s),i===NV&&(i=void 0),this.autoFreeze_&&CA(i,!0),a){const l=[],o=[];ju("Patches").generateReplacementPatches_(s,i,l,o),a(l,o)}return i}else Xi(1,s)},this.produceWithPatches=(s,n)=>{if(typeof s=="function")return(o,...c)=>this.produceWithPatches(o,d=>s(d,...c));let a,i;return[this.produce(s,n,(o,c)=>{a=o,i=c}),a,i]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof(t==null?void 0:t.useStrictIteration)=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){Po(t)||Xi(8),Nu(t)&&(t=bo(t));const s=VM(this),n=MS(t,void 0);return n[ti].isManual_=!0,PS(s),n}finishDraft(t,s){const n=t&&t[ti];(!n||!n.isManual_)&&Xi(9);const{scope_:a}=n;return UM(a,s),HM(void 0,a)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,s){let n;for(n=s.length-1;n>=0;n--){const i=s[n];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}n>-1&&(s=s.slice(n+1));const a=ju("Patches").applyPatches_;return Nu(t)?a(t,s):this.produce(t,i=>a(i,s))}};function MS(t,s){const n=Dx(t)?ju("MapSet").proxyMap_(t,s):bv(t)?ju("MapSet").proxySet_(t,s):u_e(t,s);return(s?s.scope_:SV()).drafts_.push(n),n}function bo(t){return Nu(t)||Xi(10,t),kV(t)}function kV(t){if(!Po(t)||vv(t))return t;const s=t[ti];let n,a=!0;if(s){if(!s.modified_)return s.base_;s.finalized_=!0,n=ES(t,s.scope_.immer_.useStrictShallowCopy_),a=s.scope_.immer_.shouldUseStrictIteration()}else n=ES(t,!0);return x1(n,(i,l)=>{_V(n,i,kV(l))},a),s&&(s.finalized_=!1),n}var DS=new f_e,AV=DS.produce,m_e=DS.setUseStrictIteration.bind(DS);function EV(t){return({dispatch:n,getState:a})=>i=>l=>typeof l=="function"?l(n,a,t):i(l)}var p_e=EV(),x_e=EV,g_e=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?p1:p1.apply(null,arguments)};function Pi(t,s){function n(...a){if(s){let i=s(...a);if(!i)throw new Error(Qa(0));return{type:t,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:t,payload:a[0]}}return n.toString=()=>`${t}`,n.type=t,n.match=a=>wV(a)&&a.type===t,n}var TV=class zm extends Array{constructor(...s){super(...s),Object.setPrototypeOf(this,zm.prototype)}static get[Symbol.species](){return zm}concat(...s){return super.concat.apply(this,s)}prepend(...s){return s.length===1&&Array.isArray(s[0])?new zm(...s[0].concat(this)):new zm(...s.concat(this))}};function qM(t){return Po(t)?AV(t,()=>{}):t}function sg(t,s,n){return t.has(s)?t.get(s):t.set(s,n(s)).get(s)}function y_e(t){return typeof t=="boolean"}var b_e=()=>function(s){const{thunk:n=!0,immutableCheck:a=!0,serializableCheck:i=!0,actionCreatorCheck:l=!0}=s??{};let o=new TV;return n&&(y_e(n)?o.push(p_e):o.push(x_e(n.extraArgument))),o},PV="RTK_autoBatch",Gn=()=>t=>({payload:t,meta:{[PV]:!0}}),GM=t=>s=>{setTimeout(s,t)},IV=(t={type:"raf"})=>s=>(...n)=>{const a=s(...n);let i=!0,l=!1,o=!1;const c=new Set,d=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:GM(10):t.type==="callback"?t.queueNotification:GM(t.timeout),u=()=>{o=!1,l&&(l=!1,c.forEach(f=>f()))};return Object.assign({},a,{subscribe(f){const m=()=>i&&f(),x=a.subscribe(m);return c.add(f),()=>{x(),c.delete(f)}},dispatch(f){var m;try{return i=!((m=f==null?void 0:f.meta)!=null&&m[PV]),l=!i,l&&(o||(o=!0,d(u))),a.dispatch(f)}finally{i=!0}}})},v_e=t=>function(n){const{autoBatch:a=!0}=n??{};let i=new TV(t);return a&&i.push(IV(typeof a=="object"?a:void 0)),i};function w_e(t){const s=b_e(),{reducer:n=void 0,middleware:a,devTools:i=!0,preloadedState:l=void 0,enhancers:o=void 0}=t||{};let c;if(typeof n=="function")c=n;else if(SA(n))c=vV(n);else throw new Error(Qa(1));let d;typeof a=="function"?d=a(s):d=s();let u=p1;i&&(u=g_e({trace:!1,...typeof i=="object"&&i}));const f=r_e(...d),m=v_e(f);let x=typeof o=="function"?o(m):m();const b=u(...x);return bV(c,l,b)}function MV(t){const s={},n=[];let a;const i={addCase(l,o){const c=typeof l=="string"?l:l.type;if(!c)throw new Error(Qa(28));if(c in s)throw new Error(Qa(29));return s[c]=o,i},addAsyncThunk(l,o){return o.pending&&(s[l.pending.type]=o.pending),o.rejected&&(s[l.rejected.type]=o.rejected),o.fulfilled&&(s[l.fulfilled.type]=o.fulfilled),o.settled&&n.push({matcher:l.settled,reducer:o.settled}),i},addMatcher(l,o){return n.push({matcher:l,reducer:o}),i},addDefaultCase(l){return a=l,i}};return t(i),[s,n,a]}m_e(!1);function N_e(t){return typeof t=="function"}function j_e(t,s){let[n,a,i]=MV(s),l;if(N_e(t))l=()=>qM(t());else{const c=qM(t);l=()=>c}function o(c=l(),d){let u=[n[d.type],...a.filter(({matcher:f})=>f(d)).map(({reducer:f})=>f)];return u.filter(f=>!!f).length===0&&(u=[i]),u.reduce((f,m)=>{if(m)if(Nu(f)){const b=m(f,d);return b===void 0?f:b}else{if(Po(f))return AV(f,x=>m(x,d));{const x=m(f,d);if(x===void 0){if(f===null)return f;throw Error("A case reducer on a non-draftable value must not return undefined")}return x}}return f},c)}return o.getInitialState=l,o}var __e="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",S_e=(t=21)=>{let s="",n=t;for(;n--;)s+=__e[Math.random()*64|0];return s},C_e=Symbol.for("rtk-slice-createasyncthunk");function k_e(t,s){return`${t}/${s}`}function A_e({creators:t}={}){var n;const s=(n=t==null?void 0:t.asyncThunk)==null?void 0:n[C_e];return function(i){const{name:l,reducerPath:o=l}=i;if(!l)throw new Error(Qa(11));const c=(typeof i.reducers=="function"?i.reducers(T_e()):i.reducers)||{},d=Object.keys(c),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},f={addCase(T,P){const R=typeof T=="string"?T:T.type;if(!R)throw new Error(Qa(12));if(R in u.sliceCaseReducersByType)throw new Error(Qa(13));return u.sliceCaseReducersByType[R]=P,f},addMatcher(T,P){return u.sliceMatchers.push({matcher:T,reducer:P}),f},exposeAction(T,P){return u.actionCreators[T]=P,f},exposeCaseReducer(T,P){return u.sliceCaseReducersByName[T]=P,f}};d.forEach(T=>{const P=c[T],R={reducerName:T,type:k_e(l,T),createNotation:typeof i.reducers=="function"};I_e(P)?D_e(R,P,f,s):P_e(R,P,f)});function m(){const[T={},P=[],R=void 0]=typeof i.extraReducers=="function"?MV(i.extraReducers):[i.extraReducers],I={...T,...u.sliceCaseReducersByType};return j_e(i.initialState,O=>{for(let M in I)O.addCase(M,I[M]);for(let M of u.sliceMatchers)O.addMatcher(M.matcher,M.reducer);for(let M of P)O.addMatcher(M.matcher,M.reducer);R&&O.addDefaultCase(R)})}const x=T=>T,b=new Map,w=new WeakMap;let j;function _(T,P){return j||(j=m()),j(T,P)}function C(){return j||(j=m()),j.getInitialState()}function k(T,P=!1){function R(O){let M=O[T];return typeof M>"u"&&P&&(M=sg(w,R,C)),M}function I(O=x){const M=sg(b,P,()=>new WeakMap);return sg(M,O,()=>{const B={};for(const[L,F]of Object.entries(i.selectors??{}))B[L]=E_e(F,O,()=>sg(w,O,C),P);return B})}return{reducerPath:T,getSelectors:I,get selectors(){return I(R)},selectSlice:R}}const A={name:l,reducer:_,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:C,...k(o),injectInto(T,{reducerPath:P,...R}={}){const I=P??o;return T.inject({reducerPath:I,reducer:_},R),{...A,...k(I,!0)}}};return A}}function E_e(t,s,n,a){function i(l,...o){let c=s(l);return typeof c>"u"&&a&&(c=n()),t(c,...o)}return i.unwrapped=t,i}var Pa=A_e();function T_e(){function t(s,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:s,...n}}return t.withTypes=()=>t,{reducer(s){return Object.assign({[s.name](...n){return s(...n)}}[s.name],{_reducerDefinitionType:"reducer"})},preparedReducer(s,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:s,reducer:n}},asyncThunk:t}}function P_e({type:t,reducerName:s,createNotation:n},a,i){let l,o;if("reducer"in a){if(n&&!M_e(a))throw new Error(Qa(17));l=a.reducer,o=a.prepare}else l=a;i.addCase(t,l).exposeCaseReducer(s,l).exposeAction(s,o?Pi(t,o):Pi(t))}function I_e(t){return t._reducerDefinitionType==="asyncThunk"}function M_e(t){return t._reducerDefinitionType==="reducerWithPrepare"}function D_e({type:t,reducerName:s},n,a,i){if(!i)throw new Error(Qa(18));const{payloadCreator:l,fulfilled:o,pending:c,rejected:d,settled:u,options:f}=n,m=i(t,l,f);a.exposeAction(s,m),o&&a.addCase(m.fulfilled,o),c&&a.addCase(m.pending,c),d&&a.addCase(m.rejected,d),u&&a.addMatcher(m.settled,u),a.exposeCaseReducer(s,{fulfilled:o||ng,pending:c||ng,rejected:d||ng,settled:u||ng})}function ng(){}var O_e="task",DV="listener",OV="completed",AA="cancelled",R_e=`task-${AA}`,L_e=`task-${OV}`,OS=`${DV}-${AA}`,B_e=`${DV}-${OV}`,wv=class{constructor(t){Dw(this,"name","TaskAbortError");Dw(this,"message");this.code=t,this.message=`${O_e} ${AA} (reason: ${t})`}},EA=(t,s)=>{if(typeof t!="function")throw new TypeError(Qa(32))},b1=()=>{},RV=(t,s=b1)=>(t.catch(s),t),LV=(t,s)=>(t.addEventListener("abort",s,{once:!0}),()=>t.removeEventListener("abort",s)),su=(t,s)=>{const n=t.signal;n.aborted||("reason"in n||Object.defineProperty(n,"reason",{enumerable:!0,value:s,configurable:!0,writable:!0}),t.abort(s))},nu=t=>{if(t.aborted){const{reason:s}=t;throw new wv(s)}};function BV(t,s){let n=b1;return new Promise((a,i)=>{const l=()=>i(new wv(t.reason));if(t.aborted){l();return}n=LV(t,l),s.finally(()=>n()).then(a,i)}).finally(()=>{n=b1})}var F_e=async(t,s)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(n){return{status:n instanceof wv?"cancelled":"rejected",error:n}}finally{s==null||s()}},v1=t=>s=>RV(BV(t,s).then(n=>(nu(t),n))),FV=t=>{const s=v1(t);return n=>s(new Promise(a=>setTimeout(a,n)))},{assign:Fh}=Object,KM={},Nv="listenerMiddleware",$_e=(t,s)=>{const n=a=>LV(t,()=>su(a,t.reason));return(a,i)=>{EA(a);const l=new AbortController;n(l);const o=F_e(async()=>{nu(t),nu(l.signal);const c=await a({pause:v1(l.signal),delay:FV(l.signal),signal:l.signal});return nu(l.signal),c},()=>su(l,L_e));return i!=null&&i.autoJoin&&s.push(o.catch(b1)),{result:v1(t)(o),cancel(){su(l,R_e)}}}},z_e=(t,s)=>{const n=async(a,i)=>{nu(s);let l=()=>{};const c=[new Promise((d,u)=>{let f=t({predicate:a,effect:(m,x)=>{x.unsubscribe(),d([m,x.getState(),x.getOriginalState()])}});l=()=>{f(),u()}})];i!=null&&c.push(new Promise(d=>setTimeout(d,i,null)));try{const d=await BV(s,Promise.race(c));return nu(s),d}finally{l()}};return(a,i)=>RV(n(a,i))},$V=t=>{let{type:s,actionCreator:n,matcher:a,predicate:i,effect:l}=t;if(s)i=Pi(s).match;else if(n)s=n.type,i=n.match;else if(a)i=a;else if(!i)throw new Error(Qa(21));return EA(l),{predicate:i,type:s,effect:l}},zV=Fh(t=>{const{type:s,predicate:n,effect:a}=$V(t);return{id:S_e(),effect:a,type:s,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error(Qa(22))}}},{withTypes:()=>zV}),YM=(t,s)=>{const{type:n,effect:a,predicate:i}=$V(s);return Array.from(t.values()).find(l=>(typeof n=="string"?l.type===n:l.predicate===i)&&l.effect===a)},RS=t=>{t.pending.forEach(s=>{su(s,OS)})},U_e=(t,s)=>()=>{for(const n of s.keys())RS(n);t.clear()},XM=(t,s,n)=>{try{t(s,n)}catch(a){setTimeout(()=>{throw a},0)}},UV=Fh(Pi(`${Nv}/add`),{withTypes:()=>UV}),V_e=Pi(`${Nv}/removeAll`),VV=Fh(Pi(`${Nv}/remove`),{withTypes:()=>VV}),H_e=(...t)=>{console.error(`${Nv}/error`,...t)},Ox=(t={})=>{const s=new Map,n=new Map,a=b=>{const w=n.get(b)??0;n.set(b,w+1)},i=b=>{const w=n.get(b)??1;w===1?n.delete(b):n.set(b,w-1)},{extra:l,onError:o=H_e}=t;EA(o);const c=b=>(b.unsubscribe=()=>s.delete(b.id),s.set(b.id,b),w=>{b.unsubscribe(),w!=null&&w.cancelActive&&RS(b)}),d=b=>{const w=YM(s,b)??zV(b);return c(w)};Fh(d,{withTypes:()=>d});const u=b=>{const w=YM(s,b);return w&&(w.unsubscribe(),b.cancelActive&&RS(w)),!!w};Fh(u,{withTypes:()=>u});const f=async(b,w,j,_)=>{const C=new AbortController,k=z_e(d,C.signal),A=[];try{b.pending.add(C),a(b),await Promise.resolve(b.effect(w,Fh({},j,{getOriginalState:_,condition:(T,P)=>k(T,P).then(Boolean),take:k,delay:FV(C.signal),pause:v1(C.signal),extra:l,signal:C.signal,fork:$_e(C.signal,A),unsubscribe:b.unsubscribe,subscribe:()=>{s.set(b.id,b)},cancelActiveListeners:()=>{b.pending.forEach((T,P,R)=>{T!==C&&(su(T,OS),R.delete(T))})},cancel:()=>{su(C,OS),b.pending.delete(C)},throwIfCancelled:()=>{nu(C.signal)}})))}catch(T){T instanceof wv||XM(o,T,{raisedBy:"effect"})}finally{await Promise.all(A),su(C,B_e),i(b),b.pending.delete(C)}},m=U_e(s,n);return{middleware:b=>w=>j=>{if(!wV(j))return w(j);if(UV.match(j))return d(j.payload);if(V_e.match(j)){m();return}if(VV.match(j))return u(j.payload);let _=b.getState();const C=()=>{if(_===KM)throw new Error(Qa(23));return _};let k;try{if(k=w(j),s.size>0){const A=b.getState(),T=Array.from(s.values());for(const P of T){let R=!1;try{R=P.predicate(j,A,_)}catch(I){R=!1,XM(o,I,{raisedBy:"predicate"})}R&&f(P,j,b,C)}}}finally{_=KM}return k},startListening:d,stopListening:u,clearListeners:m}};function Qa(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var W_e={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},HV=Pa({name:"chartLayout",initialState:W_e,reducers:{setLayout(t,s){t.layoutType=s.payload},setChartSize(t,s){t.width=s.payload.width,t.height=s.payload.height},setMargin(t,s){var n,a,i,l;t.margin.top=(n=s.payload.top)!==null&&n!==void 0?n:0,t.margin.right=(a=s.payload.right)!==null&&a!==void 0?a:0,t.margin.bottom=(i=s.payload.bottom)!==null&&i!==void 0?i:0,t.margin.left=(l=s.payload.left)!==null&&l!==void 0?l:0},setScale(t,s){t.scale=s.payload}}}),{setMargin:q_e,setLayout:G_e,setChartSize:K_e,setScale:Y_e}=HV.actions,X_e=HV.reducer;function WV(t,s,n){return Array.isArray(t)&&t&&s+n!==0?t.slice(s,n+1):t}function QM(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function Sh(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?QM(Object(n),!0).forEach(function(a){Q_e(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):QM(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function Q_e(t,s,n){return(s=Z_e(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function Z_e(t){var s=J_e(t,"string");return typeof s=="symbol"?s:s+""}function J_e(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function nn(t,s,n){return fr(t)||fr(s)?n:Kl(s)?wu(t,s,n):typeof s=="function"?s(t):n}var eSe=(t,s,n)=>{if(s&&n){var{width:a,height:i}=n,{align:l,verticalAlign:o,layout:c}=s;if((c==="vertical"||c==="horizontal"&&o==="middle")&&l!=="center"&&Et(t[l]))return Sh(Sh({},t),{},{[l]:t[l]+(a||0)});if((c==="horizontal"||c==="vertical"&&l==="center")&&o!=="middle"&&Et(t[o]))return Sh(Sh({},t),{},{[o]:t[o]+(i||0)})}return t},Bu=(t,s)=>t==="horizontal"&&s==="xAxis"||t==="vertical"&&s==="yAxis"||t==="centric"&&s==="angleAxis"||t==="radial"&&s==="radiusAxis",ZM=1e-4,tSe=t=>{var s=t.domain();if(!(!s||s.length<=2)){var n=s.length,a=t.range(),i=Math.min(a[0],a[1])-ZM,l=Math.max(a[0],a[1])+ZM,o=t(s[0]),c=t(s[n-1]);(o<i||o>l||c<i||c>l)&&t.domain([s[0],s[n-1]])}},sSe=(t,s)=>{if(!s||s.length!==2||!Et(s[0])||!Et(s[1]))return t;var n=Math.min(s[0],s[1]),a=Math.max(s[0],s[1]),i=[t[0],t[1]];return(!Et(t[0])||t[0]<n)&&(i[0]=n),(!Et(t[1])||t[1]>a)&&(i[1]=a),i[0]>a&&(i[0]=a),i[1]<n&&(i[1]=n),i},nSe=t=>{var s=t.length;if(!(s<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,l=0,o=0;o<s;++o){var c=Gl(t[o][n][1])?t[o][n][0]:t[o][n][1];c>=0?(t[o][n][0]=i,t[o][n][1]=i+c,i=t[o][n][1]):(t[o][n][0]=l,t[o][n][1]=l+c,l=t[o][n][1])}},rSe=t=>{var s=t.length;if(!(s<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,l=0;l<s;++l){var o=Gl(t[l][n][1])?t[l][n][0]:t[l][n][1];o>=0?(t[l][n][0]=i,t[l][n][1]=i+o,i=t[l][n][1]):(t[l][n][0]=0,t[l][n][1]=0)}},aSe={sign:nSe,expand:f2e,none:cf,silhouette:m2e,wiggle:p2e,positive:rSe},iSe=(t,s,n)=>{var a=aSe[n],i=h2e().keys(s).value((l,o)=>Number(nn(l,o,0))).order(CS).offset(a);return i(t)};function lSe(t){return t==null?void 0:String(t)}var JM=t=>{var{axis:s,ticks:n,offset:a,bandSize:i,entry:l,index:o}=t;if(s.type==="category")return n[o]?n[o].coordinate+a:null;var c=nn(l,s.dataKey,s.scale.domain()[o]);return fr(c)?null:s.scale(c)-i/2+a},oSe=t=>{var{numericAxis:s}=t,n=s.scale.domain();if(s.type==="number"){var a=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]);return a<=0&&i>=0?0:i<0?i:a}return n[0]},cSe=t=>{var s=t.flat(2).filter(Et);return[Math.min(...s),Math.max(...s)]},dSe=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],uSe=(t,s,n)=>{if(t!=null)return dSe(Object.keys(t).reduce((a,i)=>{var l=t[i],{stackedData:o}=l,c=o.reduce((d,u)=>{var f=WV(u,s,n),m=cSe(f);return[Math.min(d[0],m[0]),Math.max(d[1],m[1])]},[1/0,-1/0]);return[Math.min(c[0],a[0]),Math.max(c[1],a[1])]},[1/0,-1/0]))},eD=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,tD=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,w1=(t,s,n)=>{if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&s&&s.length>=2){for(var i=gv(s,f=>f.coordinate),l=1/0,o=1,c=i.length;o<c;o++){var d=i[o],u=i[o-1];l=Math.min((d.coordinate||0)-(u.coordinate||0),l)}return l===1/0?0:l}return n?void 0:0};function sD(t){var{tooltipEntrySettings:s,dataKey:n,payload:a,value:i,name:l}=t;return Sh(Sh({},s),{},{dataKey:n,payload:a,value:i,name:l})}function jv(t,s){if(t)return String(t);if(typeof s=="string")return s}var hSe=(t,s)=>{if(s==="horizontal")return t.chartX;if(s==="vertical")return t.chartY},fSe=(t,s)=>s==="centric"?t.angle:t.radius,zo=t=>t.layout.width,Uo=t=>t.layout.height,mSe=t=>t.layout.scale,qV=t=>t.layout.margin,_v=Ae(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),Sv=Ae(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),GV="data-recharts-item-index",KV="data-recharts-item-data-key",Rx=60;function nD(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function rg(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?nD(Object(n),!0).forEach(function(a){pSe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nD(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function pSe(t,s,n){return(s=xSe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function xSe(t){var s=gSe(t,"string");return typeof s=="symbol"?s:s+""}function gSe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var ySe=t=>t.brush.height;function bSe(t){var s=Sv(t);return s.reduce((n,a)=>{if(a.orientation==="left"&&!a.mirror&&!a.hide){var i=typeof a.width=="number"?a.width:Rx;return n+i}return n},0)}function vSe(t){var s=Sv(t);return s.reduce((n,a)=>{if(a.orientation==="right"&&!a.mirror&&!a.hide){var i=typeof a.width=="number"?a.width:Rx;return n+i}return n},0)}function wSe(t){var s=_v(t);return s.reduce((n,a)=>a.orientation==="top"&&!a.mirror&&!a.hide?n+a.height:n,0)}function NSe(t){var s=_v(t);return s.reduce((n,a)=>a.orientation==="bottom"&&!a.mirror&&!a.hide?n+a.height:n,0)}var tr=Ae([zo,Uo,qV,ySe,bSe,vSe,wSe,NSe,yV,Z2e],(t,s,n,a,i,l,o,c,d,u)=>{var f={left:(n.left||0)+i,right:(n.right||0)+l},m={top:(n.top||0)+o,bottom:(n.bottom||0)+c},x=rg(rg({},m),f),b=x.bottom;x.bottom+=a,x=eSe(x,d,u);var w=t-x.left-x.right,j=s-x.top-x.bottom;return rg(rg({brushBottom:b},x),{},{width:Math.max(w,0),height:Math.max(j,0)})}),jSe=Ae(tr,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),TA=Ae(zo,Uo,(t,s)=>({x:0,y:0,width:t,height:s})),_Se=y.createContext(null),ri=()=>y.useContext(_Se)!=null,Cv=t=>t.brush,kv=Ae([Cv,tr,qV],(t,s,n)=>({height:t.height,x:Et(t.x)?t.x:s.left,y:Et(t.y)?t.y:s.top+s.height+s.brushBottom-((n==null?void 0:n.bottom)||0),width:Et(t.width)?t.width:s.width})),YV={},XV={},QV={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n,a,{signal:i,edges:l}={}){let o,c=null;const d=l!=null&&l.includes("leading"),u=l==null||l.includes("trailing"),f=()=>{c!==null&&(n.apply(o,c),o=void 0,c=null)},m=()=>{u&&f(),j()};let x=null;const b=()=>{x!=null&&clearTimeout(x),x=setTimeout(()=>{x=null,m()},a)},w=()=>{x!==null&&(clearTimeout(x),x=null)},j=()=>{w(),o=void 0,c=null},_=()=>{f()},C=function(...k){if(i!=null&&i.aborted)return;o=this,c=k;const A=x==null;b(),d&&A&&f()};return C.schedule=b,C.cancel=j,C.flush=_,i==null||i.addEventListener("abort",j,{once:!0}),C}t.debounce=s})(QV);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=QV;function n(a,i=0,l={}){typeof l!="object"&&(l={});const{leading:o=!1,trailing:c=!0,maxWait:d}=l,u=Array(2);o&&(u[0]="leading"),c&&(u[1]="trailing");let f,m=null;const x=s.debounce(function(...j){f=a.apply(this,j),m=null},i,{edges:u}),b=function(...j){return d!=null&&(m===null&&(m=Date.now()),Date.now()-m>=d)?(f=a.apply(this,j),m=Date.now(),x.cancel(),x.schedule(),f):(x.apply(this,j),f)},w=()=>(x.flush(),f);return b.cancel=x.cancel,b.flush=w,b}t.debounce=n})(XV);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=XV;function n(a,i=0,l={}){const{leading:o=!0,trailing:c=!0}=l;return s.debounce(a,i,{leading:o,maxWait:i,trailing:c})}t.throttle=n})(YV);var SSe=YV.throttle;const CSe=Mi(SSe);var rD=function(s,n){for(var a=arguments.length,i=new Array(a>2?a-2:0),l=2;l<a;l++)i[l-2]=arguments[l]},ZV=(t,s,n)=>{var{width:a="100%",height:i="100%",aspect:l,maxHeight:o}=n,c=To(a)?t:Number(a),d=To(i)?s:Number(i);return l&&l>0&&(c?d=c/l:d&&(c=d*l),o&&d!=null&&d>o&&(d=o)),{calculatedWidth:c,calculatedHeight:d}},kSe={width:0,height:0,overflow:"visible"},ASe={width:0,overflowX:"visible"},ESe={height:0,overflowY:"visible"},TSe={},PSe=t=>{var{width:s,height:n}=t,a=To(s),i=To(n);return a&&i?kSe:a?ASe:i?ESe:TSe};function ISe(t){var{width:s,height:n,aspect:a}=t,i=s,l=n;return i===void 0&&l===void 0?(i="100%",l="100%"):i===void 0?i=a&&a>0?void 0:"100%":l===void 0&&(l=a&&a>0?void 0:"100%"),{width:i,height:l}}function Cn(t){return Number.isFinite(t)}function Yc(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function LS(){return LS=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},LS.apply(null,arguments)}function aD(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function iD(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?aD(Object(n),!0).forEach(function(a){MSe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):aD(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function MSe(t,s,n){return(s=DSe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function DSe(t){var s=OSe(t,"string");return typeof s=="symbol"?s:s+""}function OSe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var JV=y.createContext({width:-1,height:-1});function RSe(t){return Yc(t.width)&&Yc(t.height)}function eH(t){var{children:s,width:n,height:a}=t,i=y.useMemo(()=>({width:n,height:a}),[n,a]);return RSe(i)?y.createElement(JV.Provider,{value:i},s):null}var PA=()=>y.useContext(JV),LSe=y.forwardRef((t,s)=>{var{aspect:n,initialDimension:a={width:-1,height:-1},width:i,height:l,minWidth:o=0,minHeight:c,maxHeight:d,children:u,debounce:f=0,id:m,className:x,onResize:b,style:w={}}=t,j=y.useRef(null),_=y.useRef();_.current=b,y.useImperativeHandle(s,()=>j.current);var[C,k]=y.useState({containerWidth:a.width,containerHeight:a.height}),A=y.useCallback((O,M)=>{k(B=>{var L=Math.round(O),F=Math.round(M);return B.containerWidth===L&&B.containerHeight===F?B:{containerWidth:L,containerHeight:F}})},[]);y.useEffect(()=>{if(j.current==null||typeof ResizeObserver>"u")return Lu;var O=F=>{var V,{width:U,height:z}=F[0].contentRect;A(U,z),(V=_.current)===null||V===void 0||V.call(_,U,z)};f>0&&(O=CSe(O,f,{trailing:!0,leading:!1}));var M=new ResizeObserver(O),{width:B,height:L}=j.current.getBoundingClientRect();return A(B,L),M.observe(j.current),()=>{M.disconnect()}},[A,f]);var{containerWidth:T,containerHeight:P}=C;rD(!n||n>0,"The aspect(%s) must be greater than zero.",n);var{calculatedWidth:R,calculatedHeight:I}=ZV(T,P,{width:i,height:l,aspect:n,maxHeight:d});return rD(R!=null&&R>0||I!=null&&I>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,R,I,i,l,o,c,n),y.createElement("div",{id:m?"".concat(m):void 0,className:ms("recharts-responsive-container",x),style:iD(iD({},w),{},{width:i,height:l,minWidth:o,minHeight:c,maxHeight:d}),ref:j},y.createElement("div",{style:PSe({width:i,height:l})},y.createElement(eH,{width:R,height:I},u)))}),Ud=y.forwardRef((t,s)=>{var n=PA();if(Yc(n.width)&&Yc(n.height))return t.children;var{width:a,height:i}=ISe({width:t.width,height:t.height,aspect:t.aspect}),{calculatedWidth:l,calculatedHeight:o}=ZV(void 0,void 0,{width:a,height:i,aspect:t.aspect,maxHeight:t.maxHeight});return Et(l)&&Et(o)?y.createElement(eH,{width:l,height:o},t.children):y.createElement(LSe,LS({},t,{width:a,height:i,ref:s}))});function tH(t){if(t)return{x:t.x,y:t.y,upperWidth:"upperWidth"in t?t.upperWidth:t.width,lowerWidth:"lowerWidth"in t?t.lowerWidth:t.width,width:t.width,height:t.height}}var Av=()=>{var t,s=ri(),n=_t(jSe),a=_t(kv),i=(t=_t(Cv))===null||t===void 0?void 0:t.padding;return!s||!a||!i?n:{width:a.width-i.left-i.right,height:a.height-i.top-i.bottom,x:i.left,y:i.top}},BSe={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},FSe=()=>{var t;return(t=_t(tr))!==null&&t!==void 0?t:BSe},$Se=()=>_t(zo),zSe=()=>_t(Uo),ds=t=>t.layout.layoutType,Ev=()=>_t(ds),USe=()=>{var t=Ev();return t!==void 0},Tv=t=>{var s=Ys(),n=ri(),{width:a,height:i}=t,l=PA(),o=a,c=i;return l&&(o=l.width>0?l.width:a,c=l.height>0?l.height:i),y.useEffect(()=>{!n&&Yc(o)&&Yc(c)&&s(K_e({width:o,height:c}))},[s,n,o,c]),null},VSe={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},sH=Pa({name:"legend",initialState:VSe,reducers:{setLegendSize(t,s){t.size.width=s.payload.width,t.size.height=s.payload.height},setLegendSettings(t,s){t.settings.align=s.payload.align,t.settings.layout=s.payload.layout,t.settings.verticalAlign=s.payload.verticalAlign,t.settings.itemSorter=s.payload.itemSorter},addLegendPayload:{reducer(t,s){t.payload.push(s.payload)},prepare:Gn()},removeLegendPayload:{reducer(t,s){var n=bo(t).payload.indexOf(s.payload);n>-1&&t.payload.splice(n,1)},prepare:Gn()}}}),{setLegendSize:F9e,setLegendSettings:$9e,addLegendPayload:nH,removeLegendPayload:rH}=sH.actions,HSe=sH.reducer;function BS(){return BS=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},BS.apply(null,arguments)}function lD(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function jj(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?lD(Object(n),!0).forEach(function(a){WSe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lD(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function WSe(t,s,n){return(s=qSe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function qSe(t){var s=GSe(t,"string");return typeof s=="symbol"?s:s+""}function GSe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function KSe(t){return Array.isArray(t)&&Kl(t[0])&&Kl(t[1])?t.join(" ~ "):t}var YSe=t=>{var{separator:s=" : ",contentStyle:n={},itemStyle:a={},labelStyle:i={},payload:l,formatter:o,itemSorter:c,wrapperClassName:d,labelClassName:u,label:f,labelFormatter:m,accessibilityLayer:x=!1}=t,b=()=>{if(l&&l.length){var P={padding:0,margin:0},R=(c?gv(l,c):l).map((I,O)=>{if(I.type==="none")return null;var M=I.formatter||o||KSe,{value:B,name:L}=I,F=B,V=L;if(M){var U=M(B,L,I,O,l);if(Array.isArray(U))[F,V]=U;else if(U!=null)F=U;else return null}var z=jj({display:"block",paddingTop:4,paddingBottom:4,color:I.color||"#000"},a);return y.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(O),style:z},Kl(V)?y.createElement("span",{className:"recharts-tooltip-item-name"},V):null,Kl(V)?y.createElement("span",{className:"recharts-tooltip-item-separator"},s):null,y.createElement("span",{className:"recharts-tooltip-item-value"},F),y.createElement("span",{className:"recharts-tooltip-item-unit"},I.unit||""))});return y.createElement("ul",{className:"recharts-tooltip-item-list",style:P},R)}return null},w=jj({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},n),j=jj({margin:0},i),_=!fr(f),C=_?f:"",k=ms("recharts-default-tooltip",d),A=ms("recharts-tooltip-label",u);_&&m&&l!==void 0&&l!==null&&(C=m(f,l));var T=x?{role:"status","aria-live":"assertive"}:{};return y.createElement("div",BS({className:k,style:w},T),y.createElement("p",{className:A,style:j},y.isValidElement(C)?C:"".concat(C)),b())},vm="recharts-tooltip-wrapper",XSe={visibility:"hidden"};function QSe(t){var{coordinate:s,translateX:n,translateY:a}=t;return ms(vm,{["".concat(vm,"-right")]:Et(n)&&s&&Et(s.x)&&n>=s.x,["".concat(vm,"-left")]:Et(n)&&s&&Et(s.x)&&n<s.x,["".concat(vm,"-bottom")]:Et(a)&&s&&Et(s.y)&&a>=s.y,["".concat(vm,"-top")]:Et(a)&&s&&Et(s.y)&&a<s.y})}function oD(t){var{allowEscapeViewBox:s,coordinate:n,key:a,offsetTopLeft:i,position:l,reverseDirection:o,tooltipDimension:c,viewBox:d,viewBoxDimension:u}=t;if(l&&Et(l[a]))return l[a];var f=n[a]-c-(i>0?i:0),m=n[a]+i;if(s[a])return o[a]?f:m;var x=d[a];if(x==null)return 0;if(o[a]){var b=f,w=x;return b<w?Math.max(m,x):Math.max(f,x)}if(u==null)return 0;var j=m+c,_=x+u;return j>_?Math.max(f,x):Math.max(m,x)}function ZSe(t){var{translateX:s,translateY:n,useTranslate3d:a}=t;return{transform:a?"translate3d(".concat(s,"px, ").concat(n,"px, 0)"):"translate(".concat(s,"px, ").concat(n,"px)")}}function JSe(t){var{allowEscapeViewBox:s,coordinate:n,offsetTopLeft:a,position:i,reverseDirection:l,tooltipBox:o,useTranslate3d:c,viewBox:d}=t,u,f,m;return o.height>0&&o.width>0&&n?(f=oD({allowEscapeViewBox:s,coordinate:n,key:"x",offsetTopLeft:a,position:i,reverseDirection:l,tooltipDimension:o.width,viewBox:d,viewBoxDimension:d.width}),m=oD({allowEscapeViewBox:s,coordinate:n,key:"y",offsetTopLeft:a,position:i,reverseDirection:l,tooltipDimension:o.height,viewBox:d,viewBoxDimension:d.height}),u=ZSe({translateX:f,translateY:m,useTranslate3d:c})):u=XSe,{cssProperties:u,cssClasses:QSe({translateX:f,translateY:m,coordinate:n})}}function cD(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function ag(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?cD(Object(n),!0).forEach(function(a){FS(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):cD(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function FS(t,s,n){return(s=eCe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function eCe(t){var s=tCe(t,"string");return typeof s=="symbol"?s:s+""}function tCe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}class sCe extends y.PureComponent{constructor(){super(...arguments),FS(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),FS(this,"handleKeyDown",s=>{if(s.key==="Escape"){var n,a,i,l;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(n=(a=this.props.coordinate)===null||a===void 0?void 0:a.x)!==null&&n!==void 0?n:0,y:(i=(l=this.props.coordinate)===null||l===void 0?void 0:l.y)!==null&&i!==void 0?i:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var s,n;this.state.dismissed&&(((s=this.props.coordinate)===null||s===void 0?void 0:s.x)!==this.state.dismissedAtCoordinate.x||((n=this.props.coordinate)===null||n===void 0?void 0:n.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:s,allowEscapeViewBox:n,animationDuration:a,animationEasing:i,children:l,coordinate:o,hasPayload:c,isAnimationActive:d,offset:u,position:f,reverseDirection:m,useTranslate3d:x,viewBox:b,wrapperStyle:w,lastBoundingBox:j,innerRef:_,hasPortalFromProps:C}=this.props,{cssClasses:k,cssProperties:A}=JSe({allowEscapeViewBox:n,coordinate:o,offsetTopLeft:u,position:f,reverseDirection:m,tooltipBox:{height:j.height,width:j.width},useTranslate3d:x,viewBox:b}),T=C?{}:ag(ag({transition:d&&s?"transform ".concat(a,"ms ").concat(i):void 0},A),{},{pointerEvents:"none",visibility:!this.state.dismissed&&s&&c?"visible":"hidden",position:"absolute",top:0,left:0}),P=ag(ag({},T),{},{visibility:!this.state.dismissed&&s&&c?"visible":"hidden"},w);return y.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:k,style:P,ref:_},l)}}var nCe=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Fu={devToolsEnabled:!1,isSsr:nCe()},aH=()=>{var t;return(t=_t(s=>s.rootProps.accessibilityLayer))!==null&&t!==void 0?t:!0};function $S(){return $S=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},$S.apply(null,arguments)}function dD(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function uD(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?dD(Object(n),!0).forEach(function(a){rCe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):dD(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function rCe(t,s,n){return(s=aCe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function aCe(t){var s=iCe(t,"string");return typeof s=="symbol"?s:s+""}function iCe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var hD={curveBasisClosed:t2e,curveBasisOpen:s2e,curveBasis:e2e,curveBumpX:$je,curveBumpY:zje,curveLinearClosed:n2e,curveLinear:dv,curveMonotoneX:r2e,curveMonotoneY:a2e,curveNatural:i2e,curveStep:l2e,curveStepAfter:c2e,curveStepBefore:o2e},N1=t=>Cn(t.x)&&Cn(t.y),fD=t=>t.base!=null&&N1(t.base)&&N1(t),wm=t=>t.x,Nm=t=>t.y,lCe=(t,s)=>{if(typeof t=="function")return t;var n="curve".concat(Mx(t));return(n==="curveMonotone"||n==="curveBump")&&s?hD["".concat(n).concat(s==="vertical"?"Y":"X")]:hD[n]||dv},oCe=t=>{var{type:s="linear",points:n=[],baseLine:a,layout:i,connectNulls:l=!1}=t,o=lCe(s,i),c=l?n.filter(N1):n,d;if(Array.isArray(a)){var u=n.map((b,w)=>uD(uD({},b),{},{base:a[w]}));i==="vertical"?d=Z0().y(Nm).x1(wm).x0(b=>b.base.x):d=Z0().x(wm).y1(Nm).y0(b=>b.base.y);var f=d.defined(fD).curve(o),m=l?u.filter(fD):u;return f(m)}i==="vertical"&&Et(a)?d=Z0().y(Nm).x1(wm).x0(a):Et(a)?d=Z0().x(wm).y1(Nm).y0(a):d=IU().x(wm).y(Nm);var x=d.defined(N1).curve(o);return x(c)},IA=t=>{var{className:s,points:n,path:a,pathRef:i}=t;if((!n||!n.length)&&!a)return null;var l=n&&n.length?oCe(t):a;return y.createElement("path",$S({},ql(t),T2e(t),{className:ms("recharts-curve",s),d:l===null?void 0:l,ref:i}))},cCe=["x","y","top","left","width","height","className"];function zS(){return zS=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},zS.apply(null,arguments)}function mD(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function dCe(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?mD(Object(n),!0).forEach(function(a){uCe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):mD(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function uCe(t,s,n){return(s=hCe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function hCe(t){var s=fCe(t,"string");return typeof s=="symbol"?s:s+""}function fCe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function mCe(t,s){if(t==null)return{};var n,a,i=pCe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function pCe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}var xCe=(t,s,n,a,i,l)=>"M".concat(t,",").concat(i,"v").concat(a,"M").concat(l,",").concat(s,"h").concat(n),gCe=t=>{var{x:s=0,y:n=0,top:a=0,left:i=0,width:l=0,height:o=0,className:c}=t,d=mCe(t,cCe),u=dCe({x:s,y:n,top:a,left:i,width:l,height:o},d);return!Et(s)||!Et(n)||!Et(l)||!Et(o)||!Et(a)||!Et(i)?null:y.createElement("path",zS({},Ti(u),{className:ms("recharts-cross",c),d:xCe(s,n,l,o,a,i)}))};function yCe(t,s,n,a){var i=a/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?s.x-i:n.left+.5,y:t==="horizontal"?n.top+.5:s.y-i,width:t==="horizontal"?a:n.width-1,height:t==="horizontal"?n.height-1:a}}function pD(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function xD(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?pD(Object(n),!0).forEach(function(a){bCe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pD(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function bCe(t,s,n){return(s=vCe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function vCe(t){var s=wCe(t,"string");return typeof s=="symbol"?s:s+""}function wCe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var NCe=t=>t.replace(/([A-Z])/g,s=>"-".concat(s.toLowerCase())),iH=(t,s,n)=>t.map(a=>"".concat(NCe(a)," ").concat(s,"ms ").concat(n)).join(","),jCe=(t,s)=>[Object.keys(t),Object.keys(s)].reduce((n,a)=>n.filter(i=>a.includes(i))),nx=(t,s)=>Object.keys(s).reduce((n,a)=>xD(xD({},n),{},{[a]:t(a,s[a])}),{});function gD(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function Wn(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?gD(Object(n),!0).forEach(function(a){_Ce(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):gD(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function _Ce(t,s,n){return(s=SCe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function SCe(t){var s=CCe(t,"string");return typeof s=="symbol"?s:s+""}function CCe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var j1=(t,s,n)=>t+(s-t)*n,US=t=>{var{from:s,to:n}=t;return s!==n},lH=(t,s,n)=>{var a=nx((i,l)=>{if(US(l)){var[o,c]=t(l.from,l.to,l.velocity);return Wn(Wn({},l),{},{from:o,velocity:c})}return l},s);return n<1?nx((i,l)=>US(l)?Wn(Wn({},l),{},{velocity:j1(l.velocity,a[i].velocity,n),from:j1(l.from,a[i].from,n)}):l,s):lH(t,a,n-1)};function kCe(t,s,n,a,i,l){var o,c=a.reduce((x,b)=>Wn(Wn({},x),{},{[b]:{from:t[b],velocity:0,to:s[b]}}),{}),d=()=>nx((x,b)=>b.from,c),u=()=>!Object.values(c).filter(US).length,f=null,m=x=>{o||(o=x);var b=x-o,w=b/n.dt;c=lH(n,c,w),i(Wn(Wn(Wn({},t),s),d())),o=x,u()||(f=l.setTimeout(m))};return()=>(f=l.setTimeout(m),()=>{var x;(x=f)===null||x===void 0||x()})}function ACe(t,s,n,a,i,l,o){var c=null,d=i.reduce((m,x)=>Wn(Wn({},m),{},{[x]:[t[x],s[x]]}),{}),u,f=m=>{u||(u=m);var x=(m-u)/a,b=nx((j,_)=>j1(..._,n(x)),d);if(l(Wn(Wn(Wn({},t),s),b)),x<1)c=o.setTimeout(f);else{var w=nx((j,_)=>j1(..._,n(1)),d);l(Wn(Wn(Wn({},t),s),w))}};return()=>(c=o.setTimeout(f),()=>{var m;(m=c)===null||m===void 0||m()})}const ECe=(t,s,n,a,i,l)=>{var o=jCe(t,s);return n==null?()=>(i(Wn(Wn({},t),s)),()=>{}):n.isStepper===!0?kCe(t,s,n,o,i,l):ACe(t,s,n,a,o,i,l)};var _1=1e-4,oH=(t,s)=>[0,3*t,3*s-6*t,3*t-3*s+1],cH=(t,s)=>t.map((n,a)=>n*s**a).reduce((n,a)=>n+a),yD=(t,s)=>n=>{var a=oH(t,s);return cH(a,n)},TCe=(t,s)=>n=>{var a=oH(t,s),i=[...a.map((l,o)=>l*o).slice(1),0];return cH(i,n)},PCe=function(){for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];if(n.length===1)switch(n[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var i,l=n[0].split("(");if(l[0]==="cubic-bezier"&&((i=l[1])===null||i===void 0?void 0:i.split(")")[0].split(",").length)===4){var o=l[1].split(")")[0].split(",").map(c=>parseFloat(c));return[o[0],o[1],o[2],o[3]]}}}return n.length===4?n:[0,0,1,1]},ICe=(t,s,n,a)=>{var i=yD(t,n),l=yD(s,a),o=TCe(t,n),c=u=>u>1?1:u<0?0:u,d=u=>{for(var f=u>1?1:u,m=f,x=0;x<8;++x){var b=i(m)-f,w=o(m);if(Math.abs(b-f)<_1||w<_1)return l(m);m=c(m-b/w)}return l(m)};return d.isStepper=!1,d},bD=function(){return ICe(...PCe(...arguments))},MCe=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:n=100,damping:a=8,dt:i=17}=s,l=(o,c,d)=>{var u=-(o-c)*n,f=d*a,m=d+(u-f)*i/1e3,x=d*i/1e3+o;return Math.abs(x-c)<_1&&Math.abs(m)<_1?[c,0]:[x,m]};return l.isStepper=!0,l.dt=i,l},DCe=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return bD(t);case"spring":return MCe();default:if(t.split("(")[0]==="cubic-bezier")return bD(t)}return typeof t=="function"?t:null};function OCe(t){var s,n=()=>null,a=!1,i=null,l=o=>{if(!a){if(Array.isArray(o)){if(!o.length)return;var c=o,[d,...u]=c;if(typeof d=="number"){i=t.setTimeout(l.bind(null,u),d);return}l(d),i=t.setTimeout(l.bind(null,u));return}typeof o=="string"&&(s=o,n(s)),typeof o=="object"&&(s=o,n(s)),typeof o=="function"&&o()}};return{stop:()=>{a=!0},start:o=>{a=!1,i&&(i(),i=null),l(o)},subscribe:o=>(n=o,()=>{n=()=>null}),getTimeoutController:()=>t}}class RCe{setTimeout(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=performance.now(),i=null,l=o=>{o-a>=n?s(o):typeof requestAnimationFrame=="function"&&(i=requestAnimationFrame(l))};return i=requestAnimationFrame(l),()=>{i!=null&&cancelAnimationFrame(i)}}}function LCe(){return OCe(new RCe)}var BCe=y.createContext(LCe);function FCe(t,s){var n=y.useContext(BCe);return y.useMemo(()=>s??n(t),[t,s,n])}var $Ce={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},vD={t:0},_j={t:1};function Pv(t){var s=ca(t,$Ce),{isActive:n,canBegin:a,duration:i,easing:l,begin:o,onAnimationEnd:c,onAnimationStart:d,children:u}=s,f=FCe(s.animationId,s.animationManager),[m,x]=y.useState(n?vD:_j),b=y.useRef(null);return y.useEffect(()=>{n||x(_j)},[n]),y.useEffect(()=>{if(!n||!a)return Lu;var w=ECe(vD,_j,DCe(l),i,x,f.getTimeoutController()),j=()=>{b.current=w()};return f.start([d,o,j,i,c]),()=>{f.stop(),b.current&&b.current(),c()}},[n,a,i,l,o,d,c,f]),u(m.t)}function Iv(t){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",n=y.useRef(Jp(s)),a=y.useRef(t);return a.current!==t&&(n.current=Jp(s),a.current=t),n.current}var zCe=["radius"],UCe=["radius"];function wD(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function ND(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?wD(Object(n),!0).forEach(function(a){VCe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):wD(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function VCe(t,s,n){return(s=HCe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function HCe(t){var s=WCe(t,"string");return typeof s=="symbol"?s:s+""}function WCe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function S1(){return S1=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},S1.apply(null,arguments)}function jD(t,s){if(t==null)return{};var n,a,i=qCe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function qCe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}var _D=(t,s,n,a,i)=>{var l=Math.min(Math.abs(n)/2,Math.abs(a)/2),o=a>=0?1:-1,c=n>=0?1:-1,d=a>=0&&n>=0||a<0&&n<0?1:0,u;if(l>0&&i instanceof Array){for(var f=[0,0,0,0],m=0,x=4;m<x;m++)f[m]=i[m]>l?l:i[m];u="M".concat(t,",").concat(s+o*f[0]),f[0]>0&&(u+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(d,",").concat(t+c*f[0],",").concat(s)),u+="L ".concat(t+n-c*f[1],",").concat(s),f[1]>0&&(u+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(d,`,
        `).concat(t+n,",").concat(s+o*f[1])),u+="L ".concat(t+n,",").concat(s+a-o*f[2]),f[2]>0&&(u+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(d,`,
        `).concat(t+n-c*f[2],",").concat(s+a)),u+="L ".concat(t+c*f[3],",").concat(s+a),f[3]>0&&(u+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(d,`,
        `).concat(t,",").concat(s+a-o*f[3])),u+="Z"}else if(l>0&&i===+i&&i>0){var b=Math.min(l,i);u="M ".concat(t,",").concat(s+o*b,`
            A `).concat(b,",").concat(b,",0,0,").concat(d,",").concat(t+c*b,",").concat(s,`
            L `).concat(t+n-c*b,",").concat(s,`
            A `).concat(b,",").concat(b,",0,0,").concat(d,",").concat(t+n,",").concat(s+o*b,`
            L `).concat(t+n,",").concat(s+a-o*b,`
            A `).concat(b,",").concat(b,",0,0,").concat(d,",").concat(t+n-c*b,",").concat(s+a,`
            L `).concat(t+c*b,",").concat(s+a,`
            A `).concat(b,",").concat(b,",0,0,").concat(d,",").concat(t,",").concat(s+a-o*b," Z")}else u="M ".concat(t,",").concat(s," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return u},SD={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},dH=t=>{var s=ca(t,SD),n=y.useRef(null),[a,i]=y.useState(-1);y.useEffect(()=>{if(n.current&&n.current.getTotalLength)try{var q=n.current.getTotalLength();q&&i(q)}catch{}},[]);var{x:l,y:o,width:c,height:d,radius:u,className:f}=s,{animationEasing:m,animationDuration:x,animationBegin:b,isAnimationActive:w,isUpdateAnimationActive:j}=s,_=y.useRef(c),C=y.useRef(d),k=y.useRef(l),A=y.useRef(o),T=y.useMemo(()=>({x:l,y:o,width:c,height:d,radius:u}),[l,o,c,d,u]),P=Iv(T,"rectangle-");if(l!==+l||o!==+o||c!==+c||d!==+d||c===0||d===0)return null;var R=ms("recharts-rectangle",f);if(!j){var I=Ti(s),{radius:O}=I,M=jD(I,zCe);return y.createElement("path",S1({},M,{radius:typeof u=="number"?u:void 0,className:R,d:_D(l,o,c,d,u)}))}var B=_.current,L=C.current,F=k.current,V=A.current,U="0px ".concat(a===-1?1:a,"px"),z="".concat(a,"px 0px"),W=iH(["strokeDasharray"],x,typeof m=="string"?m:SD.animationEasing);return y.createElement(Pv,{animationId:P,key:P,canBegin:a>0,duration:x,easing:m,isActive:j,begin:b},q=>{var G=Hn(B,c,q),se=Hn(L,d,q),ge=Hn(F,l,q),ke=Hn(V,o,q);n.current&&(_.current=G,C.current=se,k.current=ge,A.current=ke);var ee;w?q>0?ee={transition:W,strokeDasharray:z}:ee={strokeDasharray:U}:ee={strokeDasharray:z};var pe=Ti(s),{radius:ue}=pe,ye=jD(pe,UCe);return y.createElement("path",S1({},ye,{radius:typeof u=="number"?u:void 0,className:R,d:_D(ge,ke,G,se,u),ref:n,style:ND(ND({},ee),s.style)}))})};function CD(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function kD(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?CD(Object(n),!0).forEach(function(a){GCe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):CD(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function GCe(t,s,n){return(s=KCe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function KCe(t){var s=YCe(t,"string");return typeof s=="symbol"?s:s+""}function YCe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var C1=Math.PI/180,XCe=t=>t*180/Math.PI,On=(t,s,n,a)=>({x:t+Math.cos(-C1*a)*n,y:s+Math.sin(-C1*a)*n}),uH=function(s,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(s-(a.left||0)-(a.right||0)),Math.abs(n-(a.top||0)-(a.bottom||0)))/2},QCe=(t,s)=>{var{x:n,y:a}=t,{x:i,y:l}=s;return Math.sqrt((n-i)**2+(a-l)**2)},ZCe=(t,s)=>{var{x:n,y:a}=t,{cx:i,cy:l}=s,o=QCe({x:n,y:a},{x:i,y:l});if(o<=0)return{radius:o,angle:0};var c=(n-i)/o,d=Math.acos(c);return a>l&&(d=2*Math.PI-d),{radius:o,angle:XCe(d),angleInRadian:d}},JCe=t=>{var{startAngle:s,endAngle:n}=t,a=Math.floor(s/360),i=Math.floor(n/360),l=Math.min(a,i);return{startAngle:s-l*360,endAngle:n-l*360}},e3e=(t,s)=>{var{startAngle:n,endAngle:a}=s,i=Math.floor(n/360),l=Math.floor(a/360),o=Math.min(i,l);return t+o*360},t3e=(t,s)=>{var{chartX:n,chartY:a}=t,{radius:i,angle:l}=ZCe({x:n,y:a},s),{innerRadius:o,outerRadius:c}=s;if(i<o||i>c||i===0)return null;var{startAngle:d,endAngle:u}=JCe(s),f=l,m;if(d<=u){for(;f>u;)f-=360;for(;f<d;)f+=360;m=f>=d&&f<=u}else{for(;f>d;)f-=360;for(;f<u;)f+=360;m=f>=u&&f<=d}return m?kD(kD({},s),{},{radius:i,angle:e3e(f,s)}):null};function hH(t){var{cx:s,cy:n,radius:a,startAngle:i,endAngle:l}=t,o=On(s,n,a,i),c=On(s,n,a,l);return{points:[o,c],cx:s,cy:n,radius:a,startAngle:i,endAngle:l}}function VS(){return VS=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},VS.apply(null,arguments)}var s3e=(t,s)=>{var n=Ar(s-t),a=Math.min(Math.abs(s-t),359.999);return n*a},ig=t=>{var{cx:s,cy:n,radius:a,angle:i,sign:l,isExternal:o,cornerRadius:c,cornerIsExternal:d}=t,u=c*(o?1:-1)+a,f=Math.asin(c/u)/C1,m=d?i:i+l*f,x=On(s,n,u,m),b=On(s,n,a,m),w=d?i-l*f:i,j=On(s,n,u*Math.cos(f*C1),w);return{center:x,circleTangency:b,lineTangency:j,theta:f}},fH=t=>{var{cx:s,cy:n,innerRadius:a,outerRadius:i,startAngle:l,endAngle:o}=t,c=s3e(l,o),d=l+c,u=On(s,n,i,l),f=On(s,n,i,d),m="M ".concat(u.x,",").concat(u.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(l>d),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(a>0){var x=On(s,n,a,l),b=On(s,n,a,d);m+="L ".concat(b.x,",").concat(b.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(l<=d),`,
            `).concat(x.x,",").concat(x.y," Z")}else m+="L ".concat(s,",").concat(n," Z");return m},n3e=t=>{var{cx:s,cy:n,innerRadius:a,outerRadius:i,cornerRadius:l,forceCornerRadius:o,cornerIsExternal:c,startAngle:d,endAngle:u}=t,f=Ar(u-d),{circleTangency:m,lineTangency:x,theta:b}=ig({cx:s,cy:n,radius:i,angle:d,sign:f,cornerRadius:l,cornerIsExternal:c}),{circleTangency:w,lineTangency:j,theta:_}=ig({cx:s,cy:n,radius:i,angle:u,sign:-f,cornerRadius:l,cornerIsExternal:c}),C=c?Math.abs(d-u):Math.abs(d-u)-b-_;if(C<0)return o?"M ".concat(x.x,",").concat(x.y,`
        a`).concat(l,",").concat(l,",0,0,1,").concat(l*2,`,0
        a`).concat(l,",").concat(l,",0,0,1,").concat(-l*2,`,0
      `):fH({cx:s,cy:n,innerRadius:a,outerRadius:i,startAngle:d,endAngle:u});var k="M ".concat(x.x,",").concat(x.y,`
    A`).concat(l,",").concat(l,",0,0,").concat(+(f<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(C>180),",").concat(+(f<0),",").concat(w.x,",").concat(w.y,`
    A`).concat(l,",").concat(l,",0,0,").concat(+(f<0),",").concat(j.x,",").concat(j.y,`
  `);if(a>0){var{circleTangency:A,lineTangency:T,theta:P}=ig({cx:s,cy:n,radius:a,angle:d,sign:f,isExternal:!0,cornerRadius:l,cornerIsExternal:c}),{circleTangency:R,lineTangency:I,theta:O}=ig({cx:s,cy:n,radius:a,angle:u,sign:-f,isExternal:!0,cornerRadius:l,cornerIsExternal:c}),M=c?Math.abs(d-u):Math.abs(d-u)-P-O;if(M<0&&l===0)return"".concat(k,"L").concat(s,",").concat(n,"Z");k+="L".concat(I.x,",").concat(I.y,`
      A`).concat(l,",").concat(l,",0,0,").concat(+(f<0),",").concat(R.x,",").concat(R.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(M>180),",").concat(+(f>0),",").concat(A.x,",").concat(A.y,`
      A`).concat(l,",").concat(l,",0,0,").concat(+(f<0),",").concat(T.x,",").concat(T.y,"Z")}else k+="L".concat(s,",").concat(n,"Z");return k},r3e={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},mH=t=>{var s=ca(t,r3e),{cx:n,cy:a,innerRadius:i,outerRadius:l,cornerRadius:o,forceCornerRadius:c,cornerIsExternal:d,startAngle:u,endAngle:f,className:m}=s;if(l<i||u===f)return null;var x=ms("recharts-sector",m),b=l-i,w=Hr(o,b,0,!0),j;return w>0&&Math.abs(u-f)<360?j=n3e({cx:n,cy:a,innerRadius:i,outerRadius:l,cornerRadius:Math.min(w,b/2),forceCornerRadius:c,cornerIsExternal:d,startAngle:u,endAngle:f}):j=fH({cx:n,cy:a,innerRadius:i,outerRadius:l,startAngle:u,endAngle:f}),y.createElement("path",VS({},Ti(s),{className:x,d:j}))};function a3e(t,s,n){if(t==="horizontal")return[{x:s.x,y:n.top},{x:s.x,y:n.top+n.height}];if(t==="vertical")return[{x:n.left,y:s.y},{x:n.left+n.width,y:s.y}];if(KU(s)){if(t==="centric"){var{cx:a,cy:i,innerRadius:l,outerRadius:o,angle:c}=s,d=On(a,i,l,c),u=On(a,i,o,c);return[{x:d.x,y:d.y},{x:u.x,y:u.y}]}return hH(s)}}var pH={},xH={},gH={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=jA;function n(a){return s.isSymbol(a)?NaN:Number(a)}t.toNumber=n})(gH);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=gH;function n(a){return a?(a=s.toNumber(a),a===1/0||a===-1/0?(a<0?-1:1)*Number.MAX_VALUE:a===a?a:0):a===0?a:0}t.toFinite=n})(xH);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=_A,n=xH;function a(i,l,o){o&&typeof o!="number"&&s.isIterateeCall(i,l,o)&&(l=o=void 0),i=n.toFinite(i),l===void 0?(l=i,i=0):l=n.toFinite(l),o=o===void 0?i<l?1:-1:n.toFinite(o);const c=Math.max(Math.ceil((l-i)/(o||1)),0),d=new Array(c);for(let u=0;u<c;u++)d[u]=i,i+=o;return d}t.range=a})(pH);var i3e=pH.range;const yH=Mi(i3e);function Oc(t,s){return t==null||s==null?NaN:t<s?-1:t>s?1:t>=s?0:NaN}function l3e(t,s){return t==null||s==null?NaN:s<t?-1:s>t?1:s>=t?0:NaN}function MA(t){let s,n,a;t.length!==2?(s=Oc,n=(c,d)=>Oc(t(c),d),a=(c,d)=>t(c)-d):(s=t===Oc||t===l3e?t:o3e,n=t,a=t);function i(c,d,u=0,f=c.length){if(u<f){if(s(d,d)!==0)return f;do{const m=u+f>>>1;n(c[m],d)<0?u=m+1:f=m}while(u<f)}return u}function l(c,d,u=0,f=c.length){if(u<f){if(s(d,d)!==0)return f;do{const m=u+f>>>1;n(c[m],d)<=0?u=m+1:f=m}while(u<f)}return u}function o(c,d,u=0,f=c.length){const m=i(c,d,u,f-1);return m>u&&a(c[m-1],d)>-a(c[m],d)?m-1:m}return{left:i,center:o,right:l}}function o3e(){return 0}function bH(t){return t===null?NaN:+t}function*c3e(t,s){for(let n of t)n!=null&&(n=+n)>=n&&(yield n)}const d3e=MA(Oc),Lx=d3e.right;MA(bH).center;class AD extends Map{constructor(s,n=f3e){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),s!=null)for(const[a,i]of s)this.set(a,i)}get(s){return super.get(ED(this,s))}has(s){return super.has(ED(this,s))}set(s,n){return super.set(u3e(this,s),n)}delete(s){return super.delete(h3e(this,s))}}function ED({_intern:t,_key:s},n){const a=s(n);return t.has(a)?t.get(a):n}function u3e({_intern:t,_key:s},n){const a=s(n);return t.has(a)?t.get(a):(t.set(a,n),n)}function h3e({_intern:t,_key:s},n){const a=s(n);return t.has(a)&&(n=t.get(a),t.delete(a)),n}function f3e(t){return t!==null&&typeof t=="object"?t.valueOf():t}function m3e(t=Oc){if(t===Oc)return vH;if(typeof t!="function")throw new TypeError("compare is not a function");return(s,n)=>{const a=t(s,n);return a||a===0?a:(t(n,n)===0)-(t(s,s)===0)}}function vH(t,s){return(t==null||!(t>=t))-(s==null||!(s>=s))||(t<s?-1:t>s?1:0)}const p3e=Math.sqrt(50),x3e=Math.sqrt(10),g3e=Math.sqrt(2);function k1(t,s,n){const a=(s-t)/Math.max(0,n),i=Math.floor(Math.log10(a)),l=a/Math.pow(10,i),o=l>=p3e?10:l>=x3e?5:l>=g3e?2:1;let c,d,u;return i<0?(u=Math.pow(10,-i)/o,c=Math.round(t*u),d=Math.round(s*u),c/u<t&&++c,d/u>s&&--d,u=-u):(u=Math.pow(10,i)*o,c=Math.round(t/u),d=Math.round(s/u),c*u<t&&++c,d*u>s&&--d),d<c&&.5<=n&&n<2?k1(t,s,n*2):[c,d,u]}function HS(t,s,n){if(s=+s,t=+t,n=+n,!(n>0))return[];if(t===s)return[t];const a=s<t,[i,l,o]=a?k1(s,t,n):k1(t,s,n);if(!(l>=i))return[];const c=l-i+1,d=new Array(c);if(a)if(o<0)for(let u=0;u<c;++u)d[u]=(l-u)/-o;else for(let u=0;u<c;++u)d[u]=(l-u)*o;else if(o<0)for(let u=0;u<c;++u)d[u]=(i+u)/-o;else for(let u=0;u<c;++u)d[u]=(i+u)*o;return d}function WS(t,s,n){return s=+s,t=+t,n=+n,k1(t,s,n)[2]}function qS(t,s,n){s=+s,t=+t,n=+n;const a=s<t,i=a?WS(s,t,n):WS(t,s,n);return(a?-1:1)*(i<0?1/-i:i)}function TD(t,s){let n;for(const a of t)a!=null&&(n<a||n===void 0&&a>=a)&&(n=a);return n}function PD(t,s){let n;for(const a of t)a!=null&&(n>a||n===void 0&&a>=a)&&(n=a);return n}function wH(t,s,n=0,a=1/0,i){if(s=Math.floor(s),n=Math.floor(Math.max(0,n)),a=Math.floor(Math.min(t.length-1,a)),!(n<=s&&s<=a))return t;for(i=i===void 0?vH:m3e(i);a>n;){if(a-n>600){const d=a-n+1,u=s-n+1,f=Math.log(d),m=.5*Math.exp(2*f/3),x=.5*Math.sqrt(f*m*(d-m)/d)*(u-d/2<0?-1:1),b=Math.max(n,Math.floor(s-u*m/d+x)),w=Math.min(a,Math.floor(s+(d-u)*m/d+x));wH(t,s,b,w,i)}const l=t[s];let o=n,c=a;for(jm(t,n,s),i(t[a],l)>0&&jm(t,n,a);o<c;){for(jm(t,o,c),++o,--c;i(t[o],l)<0;)++o;for(;i(t[c],l)>0;)--c}i(t[n],l)===0?jm(t,n,c):(++c,jm(t,c,a)),c<=s&&(n=c+1),s<=c&&(a=c-1)}return t}function jm(t,s,n){const a=t[s];t[s]=t[n],t[n]=a}function y3e(t,s,n){if(t=Float64Array.from(c3e(t)),!(!(a=t.length)||isNaN(s=+s))){if(s<=0||a<2)return PD(t);if(s>=1)return TD(t);var a,i=(a-1)*s,l=Math.floor(i),o=TD(wH(t,l).subarray(0,l+1)),c=PD(t.subarray(l+1));return o+(c-o)*(i-l)}}function b3e(t,s,n=bH){if(!(!(a=t.length)||isNaN(s=+s))){if(s<=0||a<2)return+n(t[0],0,t);if(s>=1)return+n(t[a-1],a-1,t);var a,i=(a-1)*s,l=Math.floor(i),o=+n(t[l],l,t),c=+n(t[l+1],l+1,t);return o+(c-o)*(i-l)}}function v3e(t,s,n){t=+t,s=+s,n=(i=arguments.length)<2?(s=t,t=0,1):i<3?1:+n;for(var a=-1,i=Math.max(0,Math.ceil((s-t)/n))|0,l=new Array(i);++a<i;)l[a]=t+a*n;return l}function Oi(t,s){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(s).domain(t);break}return this}function Vo(t,s){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof s=="function"?this.interpolator(s):this.range(s);break}}return this}const GS=Symbol("implicit");function DA(){var t=new AD,s=[],n=[],a=GS;function i(l){let o=t.get(l);if(o===void 0){if(a!==GS)return a;t.set(l,o=s.push(l)-1)}return n[o%n.length]}return i.domain=function(l){if(!arguments.length)return s.slice();s=[],t=new AD;for(const o of l)t.has(o)||t.set(o,s.push(o)-1);return i},i.range=function(l){return arguments.length?(n=Array.from(l),i):n.slice()},i.unknown=function(l){return arguments.length?(a=l,i):a},i.copy=function(){return DA(s,n).unknown(a)},Oi.apply(i,arguments),i}function OA(){var t=DA().unknown(void 0),s=t.domain,n=t.range,a=0,i=1,l,o,c=!1,d=0,u=0,f=.5;delete t.unknown;function m(){var x=s().length,b=i<a,w=b?i:a,j=b?a:i;l=(j-w)/Math.max(1,x-d+u*2),c&&(l=Math.floor(l)),w+=(j-w-l*(x-d))*f,o=l*(1-d),c&&(w=Math.round(w),o=Math.round(o));var _=v3e(x).map(function(C){return w+l*C});return n(b?_.reverse():_)}return t.domain=function(x){return arguments.length?(s(x),m()):s()},t.range=function(x){return arguments.length?([a,i]=x,a=+a,i=+i,m()):[a,i]},t.rangeRound=function(x){return[a,i]=x,a=+a,i=+i,c=!0,m()},t.bandwidth=function(){return o},t.step=function(){return l},t.round=function(x){return arguments.length?(c=!!x,m()):c},t.padding=function(x){return arguments.length?(d=Math.min(1,u=+x),m()):d},t.paddingInner=function(x){return arguments.length?(d=Math.min(1,x),m()):d},t.paddingOuter=function(x){return arguments.length?(u=+x,m()):u},t.align=function(x){return arguments.length?(f=Math.max(0,Math.min(1,x)),m()):f},t.copy=function(){return OA(s(),[a,i]).round(c).paddingInner(d).paddingOuter(u).align(f)},Oi.apply(m(),arguments)}function NH(t){var s=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return NH(s())},t}function w3e(){return NH(OA.apply(null,arguments).paddingInner(1))}function RA(t,s,n){t.prototype=s.prototype=n,n.constructor=t}function jH(t,s){var n=Object.create(t.prototype);for(var a in s)n[a]=s[a];return n}function Bx(){}var rx=.7,A1=1/rx,$h="\\s*([+-]?\\d+)\\s*",ax="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ul="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",N3e=/^#([0-9a-f]{3,8})$/,j3e=new RegExp(`^rgb\\(${$h},${$h},${$h}\\)$`),_3e=new RegExp(`^rgb\\(${Ul},${Ul},${Ul}\\)$`),S3e=new RegExp(`^rgba\\(${$h},${$h},${$h},${ax}\\)$`),C3e=new RegExp(`^rgba\\(${Ul},${Ul},${Ul},${ax}\\)$`),k3e=new RegExp(`^hsl\\(${ax},${Ul},${Ul}\\)$`),A3e=new RegExp(`^hsla\\(${ax},${Ul},${Ul},${ax}\\)$`),ID={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};RA(Bx,ix,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:MD,formatHex:MD,formatHex8:E3e,formatHsl:T3e,formatRgb:DD,toString:DD});function MD(){return this.rgb().formatHex()}function E3e(){return this.rgb().formatHex8()}function T3e(){return _H(this).formatHsl()}function DD(){return this.rgb().formatRgb()}function ix(t){var s,n;return t=(t+"").trim().toLowerCase(),(s=N3e.exec(t))?(n=s[1].length,s=parseInt(s[1],16),n===6?OD(s):n===3?new ba(s>>8&15|s>>4&240,s>>4&15|s&240,(s&15)<<4|s&15,1):n===8?lg(s>>24&255,s>>16&255,s>>8&255,(s&255)/255):n===4?lg(s>>12&15|s>>8&240,s>>8&15|s>>4&240,s>>4&15|s&240,((s&15)<<4|s&15)/255):null):(s=j3e.exec(t))?new ba(s[1],s[2],s[3],1):(s=_3e.exec(t))?new ba(s[1]*255/100,s[2]*255/100,s[3]*255/100,1):(s=S3e.exec(t))?lg(s[1],s[2],s[3],s[4]):(s=C3e.exec(t))?lg(s[1]*255/100,s[2]*255/100,s[3]*255/100,s[4]):(s=k3e.exec(t))?BD(s[1],s[2]/100,s[3]/100,1):(s=A3e.exec(t))?BD(s[1],s[2]/100,s[3]/100,s[4]):ID.hasOwnProperty(t)?OD(ID[t]):t==="transparent"?new ba(NaN,NaN,NaN,0):null}function OD(t){return new ba(t>>16&255,t>>8&255,t&255,1)}function lg(t,s,n,a){return a<=0&&(t=s=n=NaN),new ba(t,s,n,a)}function P3e(t){return t instanceof Bx||(t=ix(t)),t?(t=t.rgb(),new ba(t.r,t.g,t.b,t.opacity)):new ba}function KS(t,s,n,a){return arguments.length===1?P3e(t):new ba(t,s,n,a??1)}function ba(t,s,n,a){this.r=+t,this.g=+s,this.b=+n,this.opacity=+a}RA(ba,KS,jH(Bx,{brighter(t){return t=t==null?A1:Math.pow(A1,t),new ba(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?rx:Math.pow(rx,t),new ba(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ba(ru(this.r),ru(this.g),ru(this.b),E1(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:RD,formatHex:RD,formatHex8:I3e,formatRgb:LD,toString:LD}));function RD(){return`#${Vd(this.r)}${Vd(this.g)}${Vd(this.b)}`}function I3e(){return`#${Vd(this.r)}${Vd(this.g)}${Vd(this.b)}${Vd((isNaN(this.opacity)?1:this.opacity)*255)}`}function LD(){const t=E1(this.opacity);return`${t===1?"rgb(":"rgba("}${ru(this.r)}, ${ru(this.g)}, ${ru(this.b)}${t===1?")":`, ${t})`}`}function E1(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ru(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Vd(t){return t=ru(t),(t<16?"0":"")+t.toString(16)}function BD(t,s,n,a){return a<=0?t=s=n=NaN:n<=0||n>=1?t=s=NaN:s<=0&&(t=NaN),new Qi(t,s,n,a)}function _H(t){if(t instanceof Qi)return new Qi(t.h,t.s,t.l,t.opacity);if(t instanceof Bx||(t=ix(t)),!t)return new Qi;if(t instanceof Qi)return t;t=t.rgb();var s=t.r/255,n=t.g/255,a=t.b/255,i=Math.min(s,n,a),l=Math.max(s,n,a),o=NaN,c=l-i,d=(l+i)/2;return c?(s===l?o=(n-a)/c+(n<a)*6:n===l?o=(a-s)/c+2:o=(s-n)/c+4,c/=d<.5?l+i:2-l-i,o*=60):c=d>0&&d<1?0:o,new Qi(o,c,d,t.opacity)}function M3e(t,s,n,a){return arguments.length===1?_H(t):new Qi(t,s,n,a??1)}function Qi(t,s,n,a){this.h=+t,this.s=+s,this.l=+n,this.opacity=+a}RA(Qi,M3e,jH(Bx,{brighter(t){return t=t==null?A1:Math.pow(A1,t),new Qi(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?rx:Math.pow(rx,t),new Qi(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,s=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,a=n+(n<.5?n:1-n)*s,i=2*n-a;return new ba(Sj(t>=240?t-240:t+120,i,a),Sj(t,i,a),Sj(t<120?t+240:t-120,i,a),this.opacity)},clamp(){return new Qi(FD(this.h),og(this.s),og(this.l),E1(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=E1(this.opacity);return`${t===1?"hsl(":"hsla("}${FD(this.h)}, ${og(this.s)*100}%, ${og(this.l)*100}%${t===1?")":`, ${t})`}`}}));function FD(t){return t=(t||0)%360,t<0?t+360:t}function og(t){return Math.max(0,Math.min(1,t||0))}function Sj(t,s,n){return(t<60?s+(n-s)*t/60:t<180?n:t<240?s+(n-s)*(240-t)/60:s)*255}const LA=t=>()=>t;function D3e(t,s){return function(n){return t+n*s}}function O3e(t,s,n){return t=Math.pow(t,n),s=Math.pow(s,n)-t,n=1/n,function(a){return Math.pow(t+a*s,n)}}function R3e(t){return(t=+t)==1?SH:function(s,n){return n-s?O3e(s,n,t):LA(isNaN(s)?n:s)}}function SH(t,s){var n=s-t;return n?D3e(t,n):LA(isNaN(t)?s:t)}const $D=function t(s){var n=R3e(s);function a(i,l){var o=n((i=KS(i)).r,(l=KS(l)).r),c=n(i.g,l.g),d=n(i.b,l.b),u=SH(i.opacity,l.opacity);return function(f){return i.r=o(f),i.g=c(f),i.b=d(f),i.opacity=u(f),i+""}}return a.gamma=t,a}(1);function L3e(t,s){s||(s=[]);var n=t?Math.min(s.length,t.length):0,a=s.slice(),i;return function(l){for(i=0;i<n;++i)a[i]=t[i]*(1-l)+s[i]*l;return a}}function B3e(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function F3e(t,s){var n=s?s.length:0,a=t?Math.min(n,t.length):0,i=new Array(a),l=new Array(n),o;for(o=0;o<a;++o)i[o]=Bf(t[o],s[o]);for(;o<n;++o)l[o]=s[o];return function(c){for(o=0;o<a;++o)l[o]=i[o](c);return l}}function $3e(t,s){var n=new Date;return t=+t,s=+s,function(a){return n.setTime(t*(1-a)+s*a),n}}function T1(t,s){return t=+t,s=+s,function(n){return t*(1-n)+s*n}}function z3e(t,s){var n={},a={},i;(t===null||typeof t!="object")&&(t={}),(s===null||typeof s!="object")&&(s={});for(i in s)i in t?n[i]=Bf(t[i],s[i]):a[i]=s[i];return function(l){for(i in n)a[i]=n[i](l);return a}}var YS=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Cj=new RegExp(YS.source,"g");function U3e(t){return function(){return t}}function V3e(t){return function(s){return t(s)+""}}function H3e(t,s){var n=YS.lastIndex=Cj.lastIndex=0,a,i,l,o=-1,c=[],d=[];for(t=t+"",s=s+"";(a=YS.exec(t))&&(i=Cj.exec(s));)(l=i.index)>n&&(l=s.slice(n,l),c[o]?c[o]+=l:c[++o]=l),(a=a[0])===(i=i[0])?c[o]?c[o]+=i:c[++o]=i:(c[++o]=null,d.push({i:o,x:T1(a,i)})),n=Cj.lastIndex;return n<s.length&&(l=s.slice(n),c[o]?c[o]+=l:c[++o]=l),c.length<2?d[0]?V3e(d[0].x):U3e(s):(s=d.length,function(u){for(var f=0,m;f<s;++f)c[(m=d[f]).i]=m.x(u);return c.join("")})}function Bf(t,s){var n=typeof s,a;return s==null||n==="boolean"?LA(s):(n==="number"?T1:n==="string"?(a=ix(s))?(s=a,$D):H3e:s instanceof ix?$D:s instanceof Date?$3e:B3e(s)?L3e:Array.isArray(s)?F3e:typeof s.valueOf!="function"&&typeof s.toString!="function"||isNaN(s)?z3e:T1)(t,s)}function BA(t,s){return t=+t,s=+s,function(n){return Math.round(t*(1-n)+s*n)}}function W3e(t,s){s===void 0&&(s=t,t=Bf);for(var n=0,a=s.length-1,i=s[0],l=new Array(a<0?0:a);n<a;)l[n]=t(i,i=s[++n]);return function(o){var c=Math.max(0,Math.min(a-1,Math.floor(o*=a)));return l[c](o-c)}}function q3e(t){return function(){return t}}function P1(t){return+t}var zD=[0,1];function sa(t){return t}function XS(t,s){return(s-=t=+t)?function(n){return(n-t)/s}:q3e(isNaN(s)?NaN:.5)}function G3e(t,s){var n;return t>s&&(n=t,t=s,s=n),function(a){return Math.max(t,Math.min(s,a))}}function K3e(t,s,n){var a=t[0],i=t[1],l=s[0],o=s[1];return i<a?(a=XS(i,a),l=n(o,l)):(a=XS(a,i),l=n(l,o)),function(c){return l(a(c))}}function Y3e(t,s,n){var a=Math.min(t.length,s.length)-1,i=new Array(a),l=new Array(a),o=-1;for(t[a]<t[0]&&(t=t.slice().reverse(),s=s.slice().reverse());++o<a;)i[o]=XS(t[o],t[o+1]),l[o]=n(s[o],s[o+1]);return function(c){var d=Lx(t,c,1,a)-1;return l[d](i[d](c))}}function Fx(t,s){return s.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Mv(){var t=zD,s=zD,n=Bf,a,i,l,o=sa,c,d,u;function f(){var x=Math.min(t.length,s.length);return o!==sa&&(o=G3e(t[0],t[x-1])),c=x>2?Y3e:K3e,d=u=null,m}function m(x){return x==null||isNaN(x=+x)?l:(d||(d=c(t.map(a),s,n)))(a(o(x)))}return m.invert=function(x){return o(i((u||(u=c(s,t.map(a),T1)))(x)))},m.domain=function(x){return arguments.length?(t=Array.from(x,P1),f()):t.slice()},m.range=function(x){return arguments.length?(s=Array.from(x),f()):s.slice()},m.rangeRound=function(x){return s=Array.from(x),n=BA,f()},m.clamp=function(x){return arguments.length?(o=x?!0:sa,f()):o!==sa},m.interpolate=function(x){return arguments.length?(n=x,f()):n},m.unknown=function(x){return arguments.length?(l=x,m):l},function(x,b){return a=x,i=b,f()}}function FA(){return Mv()(sa,sa)}function X3e(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function I1(t,s){if((n=(t=s?t.toExponential(s-1):t.toExponential()).indexOf("e"))<0)return null;var n,a=t.slice(0,n);return[a.length>1?a[0]+a.slice(2):a,+t.slice(n+1)]}function df(t){return t=I1(Math.abs(t)),t?t[1]:NaN}function Q3e(t,s){return function(n,a){for(var i=n.length,l=[],o=0,c=t[0],d=0;i>0&&c>0&&(d+c+1>a&&(c=Math.max(1,a-d)),l.push(n.substring(i-=c,i+c)),!((d+=c+1)>a));)c=t[o=(o+1)%t.length];return l.reverse().join(s)}}function Z3e(t){return function(s){return s.replace(/[0-9]/g,function(n){return t[+n]})}}var J3e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function lx(t){if(!(s=J3e.exec(t)))throw new Error("invalid format: "+t);var s;return new $A({fill:s[1],align:s[2],sign:s[3],symbol:s[4],zero:s[5],width:s[6],comma:s[7],precision:s[8]&&s[8].slice(1),trim:s[9],type:s[10]})}lx.prototype=$A.prototype;function $A(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}$A.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function eke(t){e:for(var s=t.length,n=1,a=-1,i;n<s;++n)switch(t[n]){case".":a=i=n;break;case"0":a===0&&(a=n),i=n;break;default:if(!+t[n])break e;a>0&&(a=0);break}return a>0?t.slice(0,a)+t.slice(i+1):t}var CH;function tke(t,s){var n=I1(t,s);if(!n)return t+"";var a=n[0],i=n[1],l=i-(CH=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=a.length;return l===o?a:l>o?a+new Array(l-o+1).join("0"):l>0?a.slice(0,l)+"."+a.slice(l):"0."+new Array(1-l).join("0")+I1(t,Math.max(0,s+l-1))[0]}function UD(t,s){var n=I1(t,s);if(!n)return t+"";var a=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+a:a.length>i+1?a.slice(0,i+1)+"."+a.slice(i+1):a+new Array(i-a.length+2).join("0")}const VD={"%":(t,s)=>(t*100).toFixed(s),b:t=>Math.round(t).toString(2),c:t=>t+"",d:X3e,e:(t,s)=>t.toExponential(s),f:(t,s)=>t.toFixed(s),g:(t,s)=>t.toPrecision(s),o:t=>Math.round(t).toString(8),p:(t,s)=>UD(t*100,s),r:UD,s:tke,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function HD(t){return t}var WD=Array.prototype.map,qD=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function ske(t){var s=t.grouping===void 0||t.thousands===void 0?HD:Q3e(WD.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",a=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",l=t.numerals===void 0?HD:Z3e(WD.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",c=t.minus===void 0?"":t.minus+"",d=t.nan===void 0?"NaN":t.nan+"";function u(m){m=lx(m);var x=m.fill,b=m.align,w=m.sign,j=m.symbol,_=m.zero,C=m.width,k=m.comma,A=m.precision,T=m.trim,P=m.type;P==="n"?(k=!0,P="g"):VD[P]||(A===void 0&&(A=12),T=!0,P="g"),(_||x==="0"&&b==="=")&&(_=!0,x="0",b="=");var R=j==="$"?n:j==="#"&&/[boxX]/.test(P)?"0"+P.toLowerCase():"",I=j==="$"?a:/[%p]/.test(P)?o:"",O=VD[P],M=/[defgprs%]/.test(P);A=A===void 0?6:/[gprs]/.test(P)?Math.max(1,Math.min(21,A)):Math.max(0,Math.min(20,A));function B(L){var F=R,V=I,U,z,W;if(P==="c")V=O(L)+V,L="";else{L=+L;var q=L<0||1/L<0;if(L=isNaN(L)?d:O(Math.abs(L),A),T&&(L=eke(L)),q&&+L==0&&w!=="+"&&(q=!1),F=(q?w==="("?w:c:w==="-"||w==="("?"":w)+F,V=(P==="s"?qD[8+CH/3]:"")+V+(q&&w==="("?")":""),M){for(U=-1,z=L.length;++U<z;)if(W=L.charCodeAt(U),48>W||W>57){V=(W===46?i+L.slice(U+1):L.slice(U))+V,L=L.slice(0,U);break}}}k&&!_&&(L=s(L,1/0));var G=F.length+L.length+V.length,se=G<C?new Array(C-G+1).join(x):"";switch(k&&_&&(L=s(se+L,se.length?C-V.length:1/0),se=""),b){case"<":L=F+L+V+se;break;case"=":L=F+se+L+V;break;case"^":L=se.slice(0,G=se.length>>1)+F+L+V+se.slice(G);break;default:L=se+F+L+V;break}return l(L)}return B.toString=function(){return m+""},B}function f(m,x){var b=u((m=lx(m),m.type="f",m)),w=Math.max(-8,Math.min(8,Math.floor(df(x)/3)))*3,j=Math.pow(10,-w),_=qD[8+w/3];return function(C){return b(j*C)+_}}return{format:u,formatPrefix:f}}var cg,zA,kH;nke({thousands:",",grouping:[3],currency:["$",""]});function nke(t){return cg=ske(t),zA=cg.format,kH=cg.formatPrefix,cg}function rke(t){return Math.max(0,-df(Math.abs(t)))}function ake(t,s){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(df(s)/3)))*3-df(Math.abs(t)))}function ike(t,s){return t=Math.abs(t),s=Math.abs(s)-t,Math.max(0,df(s)-df(t))+1}function AH(t,s,n,a){var i=qS(t,s,n),l;switch(a=lx(a??",f"),a.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(s));return a.precision==null&&!isNaN(l=ake(i,o))&&(a.precision=l),kH(a,o)}case"":case"e":case"g":case"p":case"r":{a.precision==null&&!isNaN(l=ike(i,Math.max(Math.abs(t),Math.abs(s))))&&(a.precision=l-(a.type==="e"));break}case"f":case"%":{a.precision==null&&!isNaN(l=rke(i))&&(a.precision=l-(a.type==="%")*2);break}}return zA(a)}function ud(t){var s=t.domain;return t.ticks=function(n){var a=s();return HS(a[0],a[a.length-1],n??10)},t.tickFormat=function(n,a){var i=s();return AH(i[0],i[i.length-1],n??10,a)},t.nice=function(n){n==null&&(n=10);var a=s(),i=0,l=a.length-1,o=a[i],c=a[l],d,u,f=10;for(c<o&&(u=o,o=c,c=u,u=i,i=l,l=u);f-- >0;){if(u=WS(o,c,n),u===d)return a[i]=o,a[l]=c,s(a);if(u>0)o=Math.floor(o/u)*u,c=Math.ceil(c/u)*u;else if(u<0)o=Math.ceil(o*u)/u,c=Math.floor(c*u)/u;else break;d=u}return t},t}function EH(){var t=FA();return t.copy=function(){return Fx(t,EH())},Oi.apply(t,arguments),ud(t)}function TH(t){var s;function n(a){return a==null||isNaN(a=+a)?s:a}return n.invert=n,n.domain=n.range=function(a){return arguments.length?(t=Array.from(a,P1),n):t.slice()},n.unknown=function(a){return arguments.length?(s=a,n):s},n.copy=function(){return TH(t).unknown(s)},t=arguments.length?Array.from(t,P1):[0,1],ud(n)}function PH(t,s){t=t.slice();var n=0,a=t.length-1,i=t[n],l=t[a],o;return l<i&&(o=n,n=a,a=o,o=i,i=l,l=o),t[n]=s.floor(i),t[a]=s.ceil(l),t}function GD(t){return Math.log(t)}function KD(t){return Math.exp(t)}function lke(t){return-Math.log(-t)}function oke(t){return-Math.exp(-t)}function cke(t){return isFinite(t)?+("1e"+t):t<0?0:t}function dke(t){return t===10?cke:t===Math.E?Math.exp:s=>Math.pow(t,s)}function uke(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),s=>Math.log(s)/t)}function YD(t){return(s,n)=>-t(-s,n)}function UA(t){const s=t(GD,KD),n=s.domain;let a=10,i,l;function o(){return i=uke(a),l=dke(a),n()[0]<0?(i=YD(i),l=YD(l),t(lke,oke)):t(GD,KD),s}return s.base=function(c){return arguments.length?(a=+c,o()):a},s.domain=function(c){return arguments.length?(n(c),o()):n()},s.ticks=c=>{const d=n();let u=d[0],f=d[d.length-1];const m=f<u;m&&([u,f]=[f,u]);let x=i(u),b=i(f),w,j;const _=c==null?10:+c;let C=[];if(!(a%1)&&b-x<_){if(x=Math.floor(x),b=Math.ceil(b),u>0){for(;x<=b;++x)for(w=1;w<a;++w)if(j=x<0?w/l(-x):w*l(x),!(j<u)){if(j>f)break;C.push(j)}}else for(;x<=b;++x)for(w=a-1;w>=1;--w)if(j=x>0?w/l(-x):w*l(x),!(j<u)){if(j>f)break;C.push(j)}C.length*2<_&&(C=HS(u,f,_))}else C=HS(x,b,Math.min(b-x,_)).map(l);return m?C.reverse():C},s.tickFormat=(c,d)=>{if(c==null&&(c=10),d==null&&(d=a===10?"s":","),typeof d!="function"&&(!(a%1)&&(d=lx(d)).precision==null&&(d.trim=!0),d=zA(d)),c===1/0)return d;const u=Math.max(1,a*c/s.ticks().length);return f=>{let m=f/l(Math.round(i(f)));return m*a<a-.5&&(m*=a),m<=u?d(f):""}},s.nice=()=>n(PH(n(),{floor:c=>l(Math.floor(i(c))),ceil:c=>l(Math.ceil(i(c)))})),s}function IH(){const t=UA(Mv()).domain([1,10]);return t.copy=()=>Fx(t,IH()).base(t.base()),Oi.apply(t,arguments),t}function XD(t){return function(s){return Math.sign(s)*Math.log1p(Math.abs(s/t))}}function QD(t){return function(s){return Math.sign(s)*Math.expm1(Math.abs(s))*t}}function VA(t){var s=1,n=t(XD(s),QD(s));return n.constant=function(a){return arguments.length?t(XD(s=+a),QD(s)):s},ud(n)}function MH(){var t=VA(Mv());return t.copy=function(){return Fx(t,MH()).constant(t.constant())},Oi.apply(t,arguments)}function ZD(t){return function(s){return s<0?-Math.pow(-s,t):Math.pow(s,t)}}function hke(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function fke(t){return t<0?-t*t:t*t}function HA(t){var s=t(sa,sa),n=1;function a(){return n===1?t(sa,sa):n===.5?t(hke,fke):t(ZD(n),ZD(1/n))}return s.exponent=function(i){return arguments.length?(n=+i,a()):n},ud(s)}function WA(){var t=HA(Mv());return t.copy=function(){return Fx(t,WA()).exponent(t.exponent())},Oi.apply(t,arguments),t}function mke(){return WA.apply(null,arguments).exponent(.5)}function JD(t){return Math.sign(t)*t*t}function pke(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function DH(){var t=FA(),s=[0,1],n=!1,a;function i(l){var o=pke(t(l));return isNaN(o)?a:n?Math.round(o):o}return i.invert=function(l){return t.invert(JD(l))},i.domain=function(l){return arguments.length?(t.domain(l),i):t.domain()},i.range=function(l){return arguments.length?(t.range((s=Array.from(l,P1)).map(JD)),i):s.slice()},i.rangeRound=function(l){return i.range(l).round(!0)},i.round=function(l){return arguments.length?(n=!!l,i):n},i.clamp=function(l){return arguments.length?(t.clamp(l),i):t.clamp()},i.unknown=function(l){return arguments.length?(a=l,i):a},i.copy=function(){return DH(t.domain(),s).round(n).clamp(t.clamp()).unknown(a)},Oi.apply(i,arguments),ud(i)}function OH(){var t=[],s=[],n=[],a;function i(){var o=0,c=Math.max(1,s.length);for(n=new Array(c-1);++o<c;)n[o-1]=b3e(t,o/c);return l}function l(o){return o==null||isNaN(o=+o)?a:s[Lx(n,o)]}return l.invertExtent=function(o){var c=s.indexOf(o);return c<0?[NaN,NaN]:[c>0?n[c-1]:t[0],c<n.length?n[c]:t[t.length-1]]},l.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let c of o)c!=null&&!isNaN(c=+c)&&t.push(c);return t.sort(Oc),i()},l.range=function(o){return arguments.length?(s=Array.from(o),i()):s.slice()},l.unknown=function(o){return arguments.length?(a=o,l):a},l.quantiles=function(){return n.slice()},l.copy=function(){return OH().domain(t).range(s).unknown(a)},Oi.apply(l,arguments)}function RH(){var t=0,s=1,n=1,a=[.5],i=[0,1],l;function o(d){return d!=null&&d<=d?i[Lx(a,d,0,n)]:l}function c(){var d=-1;for(a=new Array(n);++d<n;)a[d]=((d+1)*s-(d-n)*t)/(n+1);return o}return o.domain=function(d){return arguments.length?([t,s]=d,t=+t,s=+s,c()):[t,s]},o.range=function(d){return arguments.length?(n=(i=Array.from(d)).length-1,c()):i.slice()},o.invertExtent=function(d){var u=i.indexOf(d);return u<0?[NaN,NaN]:u<1?[t,a[0]]:u>=n?[a[n-1],s]:[a[u-1],a[u]]},o.unknown=function(d){return arguments.length&&(l=d),o},o.thresholds=function(){return a.slice()},o.copy=function(){return RH().domain([t,s]).range(i).unknown(l)},Oi.apply(ud(o),arguments)}function LH(){var t=[.5],s=[0,1],n,a=1;function i(l){return l!=null&&l<=l?s[Lx(t,l,0,a)]:n}return i.domain=function(l){return arguments.length?(t=Array.from(l),a=Math.min(t.length,s.length-1),i):t.slice()},i.range=function(l){return arguments.length?(s=Array.from(l),a=Math.min(t.length,s.length-1),i):s.slice()},i.invertExtent=function(l){var o=s.indexOf(l);return[t[o-1],t[o]]},i.unknown=function(l){return arguments.length?(n=l,i):n},i.copy=function(){return LH().domain(t).range(s).unknown(n)},Oi.apply(i,arguments)}const kj=new Date,Aj=new Date;function sr(t,s,n,a){function i(l){return t(l=arguments.length===0?new Date:new Date(+l)),l}return i.floor=l=>(t(l=new Date(+l)),l),i.ceil=l=>(t(l=new Date(l-1)),s(l,1),t(l),l),i.round=l=>{const o=i(l),c=i.ceil(l);return l-o<c-l?o:c},i.offset=(l,o)=>(s(l=new Date(+l),o==null?1:Math.floor(o)),l),i.range=(l,o,c)=>{const d=[];if(l=i.ceil(l),c=c==null?1:Math.floor(c),!(l<o)||!(c>0))return d;let u;do d.push(u=new Date(+l)),s(l,c),t(l);while(u<l&&l<o);return d},i.filter=l=>sr(o=>{if(o>=o)for(;t(o),!l(o);)o.setTime(o-1)},(o,c)=>{if(o>=o)if(c<0)for(;++c<=0;)for(;s(o,-1),!l(o););else for(;--c>=0;)for(;s(o,1),!l(o););}),n&&(i.count=(l,o)=>(kj.setTime(+l),Aj.setTime(+o),t(kj),t(Aj),Math.floor(n(kj,Aj))),i.every=l=>(l=Math.floor(l),!isFinite(l)||!(l>0)?null:l>1?i.filter(a?o=>a(o)%l===0:o=>i.count(0,o)%l===0):i)),i}const M1=sr(()=>{},(t,s)=>{t.setTime(+t+s)},(t,s)=>s-t);M1.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?sr(s=>{s.setTime(Math.floor(s/t)*t)},(s,n)=>{s.setTime(+s+n*t)},(s,n)=>(n-s)/t):M1);M1.range;const po=1e3,ji=po*60,xo=ji*60,Io=xo*24,qA=Io*7,eO=Io*30,Ej=Io*365,Hd=sr(t=>{t.setTime(t-t.getMilliseconds())},(t,s)=>{t.setTime(+t+s*po)},(t,s)=>(s-t)/po,t=>t.getUTCSeconds());Hd.range;const GA=sr(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*po)},(t,s)=>{t.setTime(+t+s*ji)},(t,s)=>(s-t)/ji,t=>t.getMinutes());GA.range;const KA=sr(t=>{t.setUTCSeconds(0,0)},(t,s)=>{t.setTime(+t+s*ji)},(t,s)=>(s-t)/ji,t=>t.getUTCMinutes());KA.range;const YA=sr(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*po-t.getMinutes()*ji)},(t,s)=>{t.setTime(+t+s*xo)},(t,s)=>(s-t)/xo,t=>t.getHours());YA.range;const XA=sr(t=>{t.setUTCMinutes(0,0,0)},(t,s)=>{t.setTime(+t+s*xo)},(t,s)=>(s-t)/xo,t=>t.getUTCHours());XA.range;const $x=sr(t=>t.setHours(0,0,0,0),(t,s)=>t.setDate(t.getDate()+s),(t,s)=>(s-t-(s.getTimezoneOffset()-t.getTimezoneOffset())*ji)/Io,t=>t.getDate()-1);$x.range;const Dv=sr(t=>{t.setUTCHours(0,0,0,0)},(t,s)=>{t.setUTCDate(t.getUTCDate()+s)},(t,s)=>(s-t)/Io,t=>t.getUTCDate()-1);Dv.range;const BH=sr(t=>{t.setUTCHours(0,0,0,0)},(t,s)=>{t.setUTCDate(t.getUTCDate()+s)},(t,s)=>(s-t)/Io,t=>Math.floor(t/Io));BH.range;function $u(t){return sr(s=>{s.setDate(s.getDate()-(s.getDay()+7-t)%7),s.setHours(0,0,0,0)},(s,n)=>{s.setDate(s.getDate()+n*7)},(s,n)=>(n-s-(n.getTimezoneOffset()-s.getTimezoneOffset())*ji)/qA)}const Ov=$u(0),D1=$u(1),xke=$u(2),gke=$u(3),uf=$u(4),yke=$u(5),bke=$u(6);Ov.range;D1.range;xke.range;gke.range;uf.range;yke.range;bke.range;function zu(t){return sr(s=>{s.setUTCDate(s.getUTCDate()-(s.getUTCDay()+7-t)%7),s.setUTCHours(0,0,0,0)},(s,n)=>{s.setUTCDate(s.getUTCDate()+n*7)},(s,n)=>(n-s)/qA)}const Rv=zu(0),O1=zu(1),vke=zu(2),wke=zu(3),hf=zu(4),Nke=zu(5),jke=zu(6);Rv.range;O1.range;vke.range;wke.range;hf.range;Nke.range;jke.range;const QA=sr(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,s)=>{t.setMonth(t.getMonth()+s)},(t,s)=>s.getMonth()-t.getMonth()+(s.getFullYear()-t.getFullYear())*12,t=>t.getMonth());QA.range;const ZA=sr(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,s)=>{t.setUTCMonth(t.getUTCMonth()+s)},(t,s)=>s.getUTCMonth()-t.getUTCMonth()+(s.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());ZA.range;const Mo=sr(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,s)=>{t.setFullYear(t.getFullYear()+s)},(t,s)=>s.getFullYear()-t.getFullYear(),t=>t.getFullYear());Mo.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:sr(s=>{s.setFullYear(Math.floor(s.getFullYear()/t)*t),s.setMonth(0,1),s.setHours(0,0,0,0)},(s,n)=>{s.setFullYear(s.getFullYear()+n*t)});Mo.range;const Do=sr(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,s)=>{t.setUTCFullYear(t.getUTCFullYear()+s)},(t,s)=>s.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());Do.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:sr(s=>{s.setUTCFullYear(Math.floor(s.getUTCFullYear()/t)*t),s.setUTCMonth(0,1),s.setUTCHours(0,0,0,0)},(s,n)=>{s.setUTCFullYear(s.getUTCFullYear()+n*t)});Do.range;function FH(t,s,n,a,i,l){const o=[[Hd,1,po],[Hd,5,5*po],[Hd,15,15*po],[Hd,30,30*po],[l,1,ji],[l,5,5*ji],[l,15,15*ji],[l,30,30*ji],[i,1,xo],[i,3,3*xo],[i,6,6*xo],[i,12,12*xo],[a,1,Io],[a,2,2*Io],[n,1,qA],[s,1,eO],[s,3,3*eO],[t,1,Ej]];function c(u,f,m){const x=f<u;x&&([u,f]=[f,u]);const b=m&&typeof m.range=="function"?m:d(u,f,m),w=b?b.range(u,+f+1):[];return x?w.reverse():w}function d(u,f,m){const x=Math.abs(f-u)/m,b=MA(([,,_])=>_).right(o,x);if(b===o.length)return t.every(qS(u/Ej,f/Ej,m));if(b===0)return M1.every(Math.max(qS(u,f,m),1));const[w,j]=o[x/o[b-1][2]<o[b][2]/x?b-1:b];return w.every(j)}return[c,d]}const[_ke,Ske]=FH(Do,ZA,Rv,BH,XA,KA),[Cke,kke]=FH(Mo,QA,Ov,$x,YA,GA);function Tj(t){if(0<=t.y&&t.y<100){var s=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return s.setFullYear(t.y),s}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Pj(t){if(0<=t.y&&t.y<100){var s=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return s.setUTCFullYear(t.y),s}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function _m(t,s,n){return{y:t,m:s,d:n,H:0,M:0,S:0,L:0}}function Ake(t){var s=t.dateTime,n=t.date,a=t.time,i=t.periods,l=t.days,o=t.shortDays,c=t.months,d=t.shortMonths,u=Sm(i),f=Cm(i),m=Sm(l),x=Cm(l),b=Sm(o),w=Cm(o),j=Sm(c),_=Cm(c),C=Sm(d),k=Cm(d),A={a:q,A:G,b:se,B:ge,c:null,d:iO,e:iO,f:Qke,g:lAe,G:cAe,H:Kke,I:Yke,j:Xke,L:$H,m:Zke,M:Jke,p:ke,q:ee,Q:cO,s:dO,S:eAe,u:tAe,U:sAe,V:nAe,w:rAe,W:aAe,x:null,X:null,y:iAe,Y:oAe,Z:dAe,"%":oO},T={a:pe,A:ue,b:ye,B:X,c:null,d:lO,e:lO,f:mAe,g:_Ae,G:CAe,H:uAe,I:hAe,j:fAe,L:UH,m:pAe,M:xAe,p:oe,q:_e,Q:cO,s:dO,S:gAe,u:yAe,U:bAe,V:vAe,w:wAe,W:NAe,x:null,X:null,y:jAe,Y:SAe,Z:kAe,"%":oO},P={a:B,A:L,b:F,B:V,c:U,d:rO,e:rO,f:Hke,g:nO,G:sO,H:aO,I:aO,j:$ke,L:Vke,m:Fke,M:zke,p:M,q:Bke,Q:qke,s:Gke,S:Uke,u:Mke,U:Dke,V:Oke,w:Ike,W:Rke,x:z,X:W,y:nO,Y:sO,Z:Lke,"%":Wke};A.x=R(n,A),A.X=R(a,A),A.c=R(s,A),T.x=R(n,T),T.X=R(a,T),T.c=R(s,T);function R(ce,he){return function(fe){var le=[],Ve=-1,Ke=0,wt=ce.length,mt,rt,bt;for(fe instanceof Date||(fe=new Date(+fe));++Ve<wt;)ce.charCodeAt(Ve)===37&&(le.push(ce.slice(Ke,Ve)),(rt=tO[mt=ce.charAt(++Ve)])!=null?mt=ce.charAt(++Ve):rt=mt==="e"?" ":"0",(bt=he[mt])&&(mt=bt(fe,rt)),le.push(mt),Ke=Ve+1);return le.push(ce.slice(Ke,Ve)),le.join("")}}function I(ce,he){return function(fe){var le=_m(1900,void 0,1),Ve=O(le,ce,fe+="",0),Ke,wt;if(Ve!=fe.length)return null;if("Q"in le)return new Date(le.Q);if("s"in le)return new Date(le.s*1e3+("L"in le?le.L:0));if(he&&!("Z"in le)&&(le.Z=0),"p"in le&&(le.H=le.H%12+le.p*12),le.m===void 0&&(le.m="q"in le?le.q:0),"V"in le){if(le.V<1||le.V>53)return null;"w"in le||(le.w=1),"Z"in le?(Ke=Pj(_m(le.y,0,1)),wt=Ke.getUTCDay(),Ke=wt>4||wt===0?O1.ceil(Ke):O1(Ke),Ke=Dv.offset(Ke,(le.V-1)*7),le.y=Ke.getUTCFullYear(),le.m=Ke.getUTCMonth(),le.d=Ke.getUTCDate()+(le.w+6)%7):(Ke=Tj(_m(le.y,0,1)),wt=Ke.getDay(),Ke=wt>4||wt===0?D1.ceil(Ke):D1(Ke),Ke=$x.offset(Ke,(le.V-1)*7),le.y=Ke.getFullYear(),le.m=Ke.getMonth(),le.d=Ke.getDate()+(le.w+6)%7)}else("W"in le||"U"in le)&&("w"in le||(le.w="u"in le?le.u%7:"W"in le?1:0),wt="Z"in le?Pj(_m(le.y,0,1)).getUTCDay():Tj(_m(le.y,0,1)).getDay(),le.m=0,le.d="W"in le?(le.w+6)%7+le.W*7-(wt+5)%7:le.w+le.U*7-(wt+6)%7);return"Z"in le?(le.H+=le.Z/100|0,le.M+=le.Z%100,Pj(le)):Tj(le)}}function O(ce,he,fe,le){for(var Ve=0,Ke=he.length,wt=fe.length,mt,rt;Ve<Ke;){if(le>=wt)return-1;if(mt=he.charCodeAt(Ve++),mt===37){if(mt=he.charAt(Ve++),rt=P[mt in tO?he.charAt(Ve++):mt],!rt||(le=rt(ce,fe,le))<0)return-1}else if(mt!=fe.charCodeAt(le++))return-1}return le}function M(ce,he,fe){var le=u.exec(he.slice(fe));return le?(ce.p=f.get(le[0].toLowerCase()),fe+le[0].length):-1}function B(ce,he,fe){var le=b.exec(he.slice(fe));return le?(ce.w=w.get(le[0].toLowerCase()),fe+le[0].length):-1}function L(ce,he,fe){var le=m.exec(he.slice(fe));return le?(ce.w=x.get(le[0].toLowerCase()),fe+le[0].length):-1}function F(ce,he,fe){var le=C.exec(he.slice(fe));return le?(ce.m=k.get(le[0].toLowerCase()),fe+le[0].length):-1}function V(ce,he,fe){var le=j.exec(he.slice(fe));return le?(ce.m=_.get(le[0].toLowerCase()),fe+le[0].length):-1}function U(ce,he,fe){return O(ce,s,he,fe)}function z(ce,he,fe){return O(ce,n,he,fe)}function W(ce,he,fe){return O(ce,a,he,fe)}function q(ce){return o[ce.getDay()]}function G(ce){return l[ce.getDay()]}function se(ce){return d[ce.getMonth()]}function ge(ce){return c[ce.getMonth()]}function ke(ce){return i[+(ce.getHours()>=12)]}function ee(ce){return 1+~~(ce.getMonth()/3)}function pe(ce){return o[ce.getUTCDay()]}function ue(ce){return l[ce.getUTCDay()]}function ye(ce){return d[ce.getUTCMonth()]}function X(ce){return c[ce.getUTCMonth()]}function oe(ce){return i[+(ce.getUTCHours()>=12)]}function _e(ce){return 1+~~(ce.getUTCMonth()/3)}return{format:function(ce){var he=R(ce+="",A);return he.toString=function(){return ce},he},parse:function(ce){var he=I(ce+="",!1);return he.toString=function(){return ce},he},utcFormat:function(ce){var he=R(ce+="",T);return he.toString=function(){return ce},he},utcParse:function(ce){var he=I(ce+="",!0);return he.toString=function(){return ce},he}}}var tO={"-":"",_:" ",0:"0"},pr=/^\s*\d+/,Eke=/^%/,Tke=/[\\^$*+?|[\]().{}]/g;function cs(t,s,n){var a=t<0?"-":"",i=(a?-t:t)+"",l=i.length;return a+(l<n?new Array(n-l+1).join(s)+i:i)}function Pke(t){return t.replace(Tke,"\\$&")}function Sm(t){return new RegExp("^(?:"+t.map(Pke).join("|")+")","i")}function Cm(t){return new Map(t.map((s,n)=>[s.toLowerCase(),n]))}function Ike(t,s,n){var a=pr.exec(s.slice(n,n+1));return a?(t.w=+a[0],n+a[0].length):-1}function Mke(t,s,n){var a=pr.exec(s.slice(n,n+1));return a?(t.u=+a[0],n+a[0].length):-1}function Dke(t,s,n){var a=pr.exec(s.slice(n,n+2));return a?(t.U=+a[0],n+a[0].length):-1}function Oke(t,s,n){var a=pr.exec(s.slice(n,n+2));return a?(t.V=+a[0],n+a[0].length):-1}function Rke(t,s,n){var a=pr.exec(s.slice(n,n+2));return a?(t.W=+a[0],n+a[0].length):-1}function sO(t,s,n){var a=pr.exec(s.slice(n,n+4));return a?(t.y=+a[0],n+a[0].length):-1}function nO(t,s,n){var a=pr.exec(s.slice(n,n+2));return a?(t.y=+a[0]+(+a[0]>68?1900:2e3),n+a[0].length):-1}function Lke(t,s,n){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(s.slice(n,n+6));return a?(t.Z=a[1]?0:-(a[2]+(a[3]||"00")),n+a[0].length):-1}function Bke(t,s,n){var a=pr.exec(s.slice(n,n+1));return a?(t.q=a[0]*3-3,n+a[0].length):-1}function Fke(t,s,n){var a=pr.exec(s.slice(n,n+2));return a?(t.m=a[0]-1,n+a[0].length):-1}function rO(t,s,n){var a=pr.exec(s.slice(n,n+2));return a?(t.d=+a[0],n+a[0].length):-1}function $ke(t,s,n){var a=pr.exec(s.slice(n,n+3));return a?(t.m=0,t.d=+a[0],n+a[0].length):-1}function aO(t,s,n){var a=pr.exec(s.slice(n,n+2));return a?(t.H=+a[0],n+a[0].length):-1}function zke(t,s,n){var a=pr.exec(s.slice(n,n+2));return a?(t.M=+a[0],n+a[0].length):-1}function Uke(t,s,n){var a=pr.exec(s.slice(n,n+2));return a?(t.S=+a[0],n+a[0].length):-1}function Vke(t,s,n){var a=pr.exec(s.slice(n,n+3));return a?(t.L=+a[0],n+a[0].length):-1}function Hke(t,s,n){var a=pr.exec(s.slice(n,n+6));return a?(t.L=Math.floor(a[0]/1e3),n+a[0].length):-1}function Wke(t,s,n){var a=Eke.exec(s.slice(n,n+1));return a?n+a[0].length:-1}function qke(t,s,n){var a=pr.exec(s.slice(n));return a?(t.Q=+a[0],n+a[0].length):-1}function Gke(t,s,n){var a=pr.exec(s.slice(n));return a?(t.s=+a[0],n+a[0].length):-1}function iO(t,s){return cs(t.getDate(),s,2)}function Kke(t,s){return cs(t.getHours(),s,2)}function Yke(t,s){return cs(t.getHours()%12||12,s,2)}function Xke(t,s){return cs(1+$x.count(Mo(t),t),s,3)}function $H(t,s){return cs(t.getMilliseconds(),s,3)}function Qke(t,s){return $H(t,s)+"000"}function Zke(t,s){return cs(t.getMonth()+1,s,2)}function Jke(t,s){return cs(t.getMinutes(),s,2)}function eAe(t,s){return cs(t.getSeconds(),s,2)}function tAe(t){var s=t.getDay();return s===0?7:s}function sAe(t,s){return cs(Ov.count(Mo(t)-1,t),s,2)}function zH(t){var s=t.getDay();return s>=4||s===0?uf(t):uf.ceil(t)}function nAe(t,s){return t=zH(t),cs(uf.count(Mo(t),t)+(Mo(t).getDay()===4),s,2)}function rAe(t){return t.getDay()}function aAe(t,s){return cs(D1.count(Mo(t)-1,t),s,2)}function iAe(t,s){return cs(t.getFullYear()%100,s,2)}function lAe(t,s){return t=zH(t),cs(t.getFullYear()%100,s,2)}function oAe(t,s){return cs(t.getFullYear()%1e4,s,4)}function cAe(t,s){var n=t.getDay();return t=n>=4||n===0?uf(t):uf.ceil(t),cs(t.getFullYear()%1e4,s,4)}function dAe(t){var s=t.getTimezoneOffset();return(s>0?"-":(s*=-1,"+"))+cs(s/60|0,"0",2)+cs(s%60,"0",2)}function lO(t,s){return cs(t.getUTCDate(),s,2)}function uAe(t,s){return cs(t.getUTCHours(),s,2)}function hAe(t,s){return cs(t.getUTCHours()%12||12,s,2)}function fAe(t,s){return cs(1+Dv.count(Do(t),t),s,3)}function UH(t,s){return cs(t.getUTCMilliseconds(),s,3)}function mAe(t,s){return UH(t,s)+"000"}function pAe(t,s){return cs(t.getUTCMonth()+1,s,2)}function xAe(t,s){return cs(t.getUTCMinutes(),s,2)}function gAe(t,s){return cs(t.getUTCSeconds(),s,2)}function yAe(t){var s=t.getUTCDay();return s===0?7:s}function bAe(t,s){return cs(Rv.count(Do(t)-1,t),s,2)}function VH(t){var s=t.getUTCDay();return s>=4||s===0?hf(t):hf.ceil(t)}function vAe(t,s){return t=VH(t),cs(hf.count(Do(t),t)+(Do(t).getUTCDay()===4),s,2)}function wAe(t){return t.getUTCDay()}function NAe(t,s){return cs(O1.count(Do(t)-1,t),s,2)}function jAe(t,s){return cs(t.getUTCFullYear()%100,s,2)}function _Ae(t,s){return t=VH(t),cs(t.getUTCFullYear()%100,s,2)}function SAe(t,s){return cs(t.getUTCFullYear()%1e4,s,4)}function CAe(t,s){var n=t.getUTCDay();return t=n>=4||n===0?hf(t):hf.ceil(t),cs(t.getUTCFullYear()%1e4,s,4)}function kAe(){return"+0000"}function oO(){return"%"}function cO(t){return+t}function dO(t){return Math.floor(+t/1e3)}var eh,HH,WH;AAe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function AAe(t){return eh=Ake(t),HH=eh.format,eh.parse,WH=eh.utcFormat,eh.utcParse,eh}function EAe(t){return new Date(t)}function TAe(t){return t instanceof Date?+t:+new Date(+t)}function JA(t,s,n,a,i,l,o,c,d,u){var f=FA(),m=f.invert,x=f.domain,b=u(".%L"),w=u(":%S"),j=u("%I:%M"),_=u("%I %p"),C=u("%a %d"),k=u("%b %d"),A=u("%B"),T=u("%Y");function P(R){return(d(R)<R?b:c(R)<R?w:o(R)<R?j:l(R)<R?_:a(R)<R?i(R)<R?C:k:n(R)<R?A:T)(R)}return f.invert=function(R){return new Date(m(R))},f.domain=function(R){return arguments.length?x(Array.from(R,TAe)):x().map(EAe)},f.ticks=function(R){var I=x();return t(I[0],I[I.length-1],R??10)},f.tickFormat=function(R,I){return I==null?P:u(I)},f.nice=function(R){var I=x();return(!R||typeof R.range!="function")&&(R=s(I[0],I[I.length-1],R??10)),R?x(PH(I,R)):f},f.copy=function(){return Fx(f,JA(t,s,n,a,i,l,o,c,d,u))},f}function PAe(){return Oi.apply(JA(Cke,kke,Mo,QA,Ov,$x,YA,GA,Hd,HH).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function IAe(){return Oi.apply(JA(_ke,Ske,Do,ZA,Rv,Dv,XA,KA,Hd,WH).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Lv(){var t=0,s=1,n,a,i,l,o=sa,c=!1,d;function u(m){return m==null||isNaN(m=+m)?d:o(i===0?.5:(m=(l(m)-n)*i,c?Math.max(0,Math.min(1,m)):m))}u.domain=function(m){return arguments.length?([t,s]=m,n=l(t=+t),a=l(s=+s),i=n===a?0:1/(a-n),u):[t,s]},u.clamp=function(m){return arguments.length?(c=!!m,u):c},u.interpolator=function(m){return arguments.length?(o=m,u):o};function f(m){return function(x){var b,w;return arguments.length?([b,w]=x,o=m(b,w),u):[o(0),o(1)]}}return u.range=f(Bf),u.rangeRound=f(BA),u.unknown=function(m){return arguments.length?(d=m,u):d},function(m){return l=m,n=m(t),a=m(s),i=n===a?0:1/(a-n),u}}function hd(t,s){return s.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function qH(){var t=ud(Lv()(sa));return t.copy=function(){return hd(t,qH())},Vo.apply(t,arguments)}function GH(){var t=UA(Lv()).domain([1,10]);return t.copy=function(){return hd(t,GH()).base(t.base())},Vo.apply(t,arguments)}function KH(){var t=VA(Lv());return t.copy=function(){return hd(t,KH()).constant(t.constant())},Vo.apply(t,arguments)}function e5(){var t=HA(Lv());return t.copy=function(){return hd(t,e5()).exponent(t.exponent())},Vo.apply(t,arguments)}function MAe(){return e5.apply(null,arguments).exponent(.5)}function YH(){var t=[],s=sa;function n(a){if(a!=null&&!isNaN(a=+a))return s((Lx(t,a,1)-1)/(t.length-1))}return n.domain=function(a){if(!arguments.length)return t.slice();t=[];for(let i of a)i!=null&&!isNaN(i=+i)&&t.push(i);return t.sort(Oc),n},n.interpolator=function(a){return arguments.length?(s=a,n):s},n.range=function(){return t.map((a,i)=>s(i/(t.length-1)))},n.quantiles=function(a){return Array.from({length:a+1},(i,l)=>y3e(t,l/a))},n.copy=function(){return YH(s).domain(t)},Vo.apply(n,arguments)}function Bv(){var t=0,s=.5,n=1,a=1,i,l,o,c,d,u=sa,f,m=!1,x;function b(j){return isNaN(j=+j)?x:(j=.5+((j=+f(j))-l)*(a*j<a*l?c:d),u(m?Math.max(0,Math.min(1,j)):j))}b.domain=function(j){return arguments.length?([t,s,n]=j,i=f(t=+t),l=f(s=+s),o=f(n=+n),c=i===l?0:.5/(l-i),d=l===o?0:.5/(o-l),a=l<i?-1:1,b):[t,s,n]},b.clamp=function(j){return arguments.length?(m=!!j,b):m},b.interpolator=function(j){return arguments.length?(u=j,b):u};function w(j){return function(_){var C,k,A;return arguments.length?([C,k,A]=_,u=W3e(j,[C,k,A]),b):[u(0),u(.5),u(1)]}}return b.range=w(Bf),b.rangeRound=w(BA),b.unknown=function(j){return arguments.length?(x=j,b):x},function(j){return f=j,i=j(t),l=j(s),o=j(n),c=i===l?0:.5/(l-i),d=l===o?0:.5/(o-l),a=l<i?-1:1,b}}function XH(){var t=ud(Bv()(sa));return t.copy=function(){return hd(t,XH())},Vo.apply(t,arguments)}function QH(){var t=UA(Bv()).domain([.1,1,10]);return t.copy=function(){return hd(t,QH()).base(t.base())},Vo.apply(t,arguments)}function ZH(){var t=VA(Bv());return t.copy=function(){return hd(t,ZH()).constant(t.constant())},Vo.apply(t,arguments)}function t5(){var t=HA(Bv());return t.copy=function(){return hd(t,t5()).exponent(t.exponent())},Vo.apply(t,arguments)}function DAe(){return t5.apply(null,arguments).exponent(.5)}const Um=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:OA,scaleDiverging:XH,scaleDivergingLog:QH,scaleDivergingPow:t5,scaleDivergingSqrt:DAe,scaleDivergingSymlog:ZH,scaleIdentity:TH,scaleImplicit:GS,scaleLinear:EH,scaleLog:IH,scaleOrdinal:DA,scalePoint:w3e,scalePow:WA,scaleQuantile:OH,scaleQuantize:RH,scaleRadial:DH,scaleSequential:qH,scaleSequentialLog:GH,scaleSequentialPow:e5,scaleSequentialQuantile:YH,scaleSequentialSqrt:MAe,scaleSequentialSymlog:KH,scaleSqrt:mke,scaleSymlog:MH,scaleThreshold:LH,scaleTime:PAe,scaleUtc:IAe,tickFormat:AH},Symbol.toStringTag,{value:"Module"}));var fd=t=>t.chartData,s5=Ae([fd],t=>{var s=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:s,dataStartIndex:0}}),n5=(t,s,n,a)=>a?s5(t):fd(t);function _u(t){if(Array.isArray(t)&&t.length===2){var[s,n]=t;if(Cn(s)&&Cn(n))return!0}return!1}function uO(t,s,n){return n?t:[Math.min(t[0],s[0]),Math.max(t[1],s[1])]}function JH(t,s){if(s&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[n,a]=t,i,l;if(Cn(n))i=n;else if(typeof n=="function")return;if(Cn(a))l=a;else if(typeof a=="function")return;var o=[i,l];if(_u(o))return o}}function OAe(t,s,n){if(!(!n&&s==null)){if(typeof t=="function"&&s!=null)try{var a=t(s,n);if(_u(a))return uO(a,s,n)}catch{}if(Array.isArray(t)&&t.length===2){var[i,l]=t,o,c;if(i==="auto")s!=null&&(o=Math.min(...s));else if(Et(i))o=i;else if(typeof i=="function")try{s!=null&&(o=i(s==null?void 0:s[0]))}catch{}else if(typeof i=="string"&&eD.test(i)){var d=eD.exec(i);if(d==null||s==null)o=void 0;else{var u=+d[1];o=s[0]-u}}else o=s==null?void 0:s[0];if(l==="auto")s!=null&&(c=Math.max(...s));else if(Et(l))c=l;else if(typeof l=="function")try{s!=null&&(c=l(s==null?void 0:s[1]))}catch{}else if(typeof l=="string"&&tD.test(l)){var f=tD.exec(l);if(f==null||s==null)c=void 0;else{var m=+f[1];c=s[1]+m}}else c=s==null?void 0:s[1];var x=[o,c];if(_u(x))return s==null?x:uO(x,s,n)}}}var Ff=1e9,RAe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},a5,Ks=!0,Ii="[DecimalError] ",au=Ii+"Invalid argument: ",r5=Ii+"Exponent out of range: ",$f=Math.floor,kd=Math.pow,LAe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ha,or=1e7,zs=7,eW=9007199254740991,R1=$f(eW/zs),ft={};ft.absoluteValue=ft.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};ft.comparedTo=ft.cmp=function(t){var s,n,a,i,l=this;if(t=new l.constructor(t),l.s!==t.s)return l.s||-t.s;if(l.e!==t.e)return l.e>t.e^l.s<0?1:-1;for(a=l.d.length,i=t.d.length,s=0,n=a<i?a:i;s<n;++s)if(l.d[s]!==t.d[s])return l.d[s]>t.d[s]^l.s<0?1:-1;return a===i?0:a>i^l.s<0?1:-1};ft.decimalPlaces=ft.dp=function(){var t=this,s=t.d.length-1,n=(s-t.e)*zs;if(s=t.d[s],s)for(;s%10==0;s/=10)n--;return n<0?0:n};ft.dividedBy=ft.div=function(t){return vo(this,new this.constructor(t))};ft.dividedToIntegerBy=ft.idiv=function(t){var s=this,n=s.constructor;return Ps(vo(s,new n(t),0,1),n.precision)};ft.equals=ft.eq=function(t){return!this.cmp(t)};ft.exponent=function(){return Ln(this)};ft.greaterThan=ft.gt=function(t){return this.cmp(t)>0};ft.greaterThanOrEqualTo=ft.gte=function(t){return this.cmp(t)>=0};ft.isInteger=ft.isint=function(){return this.e>this.d.length-2};ft.isNegative=ft.isneg=function(){return this.s<0};ft.isPositive=ft.ispos=function(){return this.s>0};ft.isZero=function(){return this.s===0};ft.lessThan=ft.lt=function(t){return this.cmp(t)<0};ft.lessThanOrEqualTo=ft.lte=function(t){return this.cmp(t)<1};ft.logarithm=ft.log=function(t){var s,n=this,a=n.constructor,i=a.precision,l=i+5;if(t===void 0)t=new a(10);else if(t=new a(t),t.s<1||t.eq(Ha))throw Error(Ii+"NaN");if(n.s<1)throw Error(Ii+(n.s?"NaN":"-Infinity"));return n.eq(Ha)?new a(0):(Ks=!1,s=vo(ox(n,l),ox(t,l),l),Ks=!0,Ps(s,i))};ft.minus=ft.sub=function(t){var s=this;return t=new s.constructor(t),s.s==t.s?nW(s,t):tW(s,(t.s=-t.s,t))};ft.modulo=ft.mod=function(t){var s,n=this,a=n.constructor,i=a.precision;if(t=new a(t),!t.s)throw Error(Ii+"NaN");return n.s?(Ks=!1,s=vo(n,t,0,1).times(t),Ks=!0,n.minus(s)):Ps(new a(n),i)};ft.naturalExponential=ft.exp=function(){return sW(this)};ft.naturalLogarithm=ft.ln=function(){return ox(this)};ft.negated=ft.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};ft.plus=ft.add=function(t){var s=this;return t=new s.constructor(t),s.s==t.s?tW(s,t):nW(s,(t.s=-t.s,t))};ft.precision=ft.sd=function(t){var s,n,a,i=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(au+t);if(s=Ln(i)+1,a=i.d.length-1,n=a*zs+1,a=i.d[a],a){for(;a%10==0;a/=10)n--;for(a=i.d[0];a>=10;a/=10)n++}return t&&s>n?s:n};ft.squareRoot=ft.sqrt=function(){var t,s,n,a,i,l,o,c=this,d=c.constructor;if(c.s<1){if(!c.s)return new d(0);throw Error(Ii+"NaN")}for(t=Ln(c),Ks=!1,i=Math.sqrt(+c),i==0||i==1/0?(s=Ml(c.d),(s.length+t)%2==0&&(s+="0"),i=Math.sqrt(s),t=$f((t+1)/2)-(t<0||t%2),i==1/0?s="5e"+t:(s=i.toExponential(),s=s.slice(0,s.indexOf("e")+1)+t),a=new d(s)):a=new d(i.toString()),n=d.precision,i=o=n+3;;)if(l=a,a=l.plus(vo(c,l,o+2)).times(.5),Ml(l.d).slice(0,o)===(s=Ml(a.d)).slice(0,o)){if(s=s.slice(o-3,o+1),i==o&&s=="4999"){if(Ps(l,n+1,0),l.times(l).eq(c)){a=l;break}}else if(s!="9999")break;o+=4}return Ks=!0,Ps(a,n)};ft.times=ft.mul=function(t){var s,n,a,i,l,o,c,d,u,f=this,m=f.constructor,x=f.d,b=(t=new m(t)).d;if(!f.s||!t.s)return new m(0);for(t.s*=f.s,n=f.e+t.e,d=x.length,u=b.length,d<u&&(l=x,x=b,b=l,o=d,d=u,u=o),l=[],o=d+u,a=o;a--;)l.push(0);for(a=u;--a>=0;){for(s=0,i=d+a;i>a;)c=l[i]+b[a]*x[i-a-1]+s,l[i--]=c%or|0,s=c/or|0;l[i]=(l[i]+s)%or|0}for(;!l[--o];)l.pop();return s?++n:l.shift(),t.d=l,t.e=n,Ks?Ps(t,m.precision):t};ft.toDecimalPlaces=ft.todp=function(t,s){var n=this,a=n.constructor;return n=new a(n),t===void 0?n:(Yl(t,0,Ff),s===void 0?s=a.rounding:Yl(s,0,8),Ps(n,t+Ln(n)+1,s))};ft.toExponential=function(t,s){var n,a=this,i=a.constructor;return t===void 0?n=Su(a,!0):(Yl(t,0,Ff),s===void 0?s=i.rounding:Yl(s,0,8),a=Ps(new i(a),t+1,s),n=Su(a,!0,t+1)),n};ft.toFixed=function(t,s){var n,a,i=this,l=i.constructor;return t===void 0?Su(i):(Yl(t,0,Ff),s===void 0?s=l.rounding:Yl(s,0,8),a=Ps(new l(i),t+Ln(i)+1,s),n=Su(a.abs(),!1,t+Ln(a)+1),i.isneg()&&!i.isZero()?"-"+n:n)};ft.toInteger=ft.toint=function(){var t=this,s=t.constructor;return Ps(new s(t),Ln(t)+1,s.rounding)};ft.toNumber=function(){return+this};ft.toPower=ft.pow=function(t){var s,n,a,i,l,o,c=this,d=c.constructor,u=12,f=+(t=new d(t));if(!t.s)return new d(Ha);if(c=new d(c),!c.s){if(t.s<1)throw Error(Ii+"Infinity");return c}if(c.eq(Ha))return c;if(a=d.precision,t.eq(Ha))return Ps(c,a);if(s=t.e,n=t.d.length-1,o=s>=n,l=c.s,o){if((n=f<0?-f:f)<=eW){for(i=new d(Ha),s=Math.ceil(a/zs+4),Ks=!1;n%2&&(i=i.times(c),fO(i.d,s)),n=$f(n/2),n!==0;)c=c.times(c),fO(c.d,s);return Ks=!0,t.s<0?new d(Ha).div(i):Ps(i,a)}}else if(l<0)throw Error(Ii+"NaN");return l=l<0&&t.d[Math.max(s,n)]&1?-1:1,c.s=1,Ks=!1,i=t.times(ox(c,a+u)),Ks=!0,i=sW(i),i.s=l,i};ft.toPrecision=function(t,s){var n,a,i=this,l=i.constructor;return t===void 0?(n=Ln(i),a=Su(i,n<=l.toExpNeg||n>=l.toExpPos)):(Yl(t,1,Ff),s===void 0?s=l.rounding:Yl(s,0,8),i=Ps(new l(i),t,s),n=Ln(i),a=Su(i,t<=n||n<=l.toExpNeg,t)),a};ft.toSignificantDigits=ft.tosd=function(t,s){var n=this,a=n.constructor;return t===void 0?(t=a.precision,s=a.rounding):(Yl(t,1,Ff),s===void 0?s=a.rounding:Yl(s,0,8)),Ps(new a(n),t,s)};ft.toString=ft.valueOf=ft.val=ft.toJSON=ft[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,s=Ln(t),n=t.constructor;return Su(t,s<=n.toExpNeg||s>=n.toExpPos)};function tW(t,s){var n,a,i,l,o,c,d,u,f=t.constructor,m=f.precision;if(!t.s||!s.s)return s.s||(s=new f(t)),Ks?Ps(s,m):s;if(d=t.d,u=s.d,o=t.e,i=s.e,d=d.slice(),l=o-i,l){for(l<0?(a=d,l=-l,c=u.length):(a=u,i=o,c=d.length),o=Math.ceil(m/zs),c=o>c?o+1:c+1,l>c&&(l=c,a.length=1),a.reverse();l--;)a.push(0);a.reverse()}for(c=d.length,l=u.length,c-l<0&&(l=c,a=u,u=d,d=a),n=0;l;)n=(d[--l]=d[l]+u[l]+n)/or|0,d[l]%=or;for(n&&(d.unshift(n),++i),c=d.length;d[--c]==0;)d.pop();return s.d=d,s.e=i,Ks?Ps(s,m):s}function Yl(t,s,n){if(t!==~~t||t<s||t>n)throw Error(au+t)}function Ml(t){var s,n,a,i=t.length-1,l="",o=t[0];if(i>0){for(l+=o,s=1;s<i;s++)a=t[s]+"",n=zs-a.length,n&&(l+=uc(n)),l+=a;o=t[s],a=o+"",n=zs-a.length,n&&(l+=uc(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return l+o}var vo=function(){function t(a,i){var l,o=0,c=a.length;for(a=a.slice();c--;)l=a[c]*i+o,a[c]=l%or|0,o=l/or|0;return o&&a.unshift(o),a}function s(a,i,l,o){var c,d;if(l!=o)d=l>o?1:-1;else for(c=d=0;c<l;c++)if(a[c]!=i[c]){d=a[c]>i[c]?1:-1;break}return d}function n(a,i,l){for(var o=0;l--;)a[l]-=o,o=a[l]<i[l]?1:0,a[l]=o*or+a[l]-i[l];for(;!a[0]&&a.length>1;)a.shift()}return function(a,i,l,o){var c,d,u,f,m,x,b,w,j,_,C,k,A,T,P,R,I,O,M=a.constructor,B=a.s==i.s?1:-1,L=a.d,F=i.d;if(!a.s)return new M(a);if(!i.s)throw Error(Ii+"Division by zero");for(d=a.e-i.e,I=F.length,P=L.length,b=new M(B),w=b.d=[],u=0;F[u]==(L[u]||0);)++u;if(F[u]>(L[u]||0)&&--d,l==null?k=l=M.precision:o?k=l+(Ln(a)-Ln(i))+1:k=l,k<0)return new M(0);if(k=k/zs+2|0,u=0,I==1)for(f=0,F=F[0],k++;(u<P||f)&&k--;u++)A=f*or+(L[u]||0),w[u]=A/F|0,f=A%F|0;else{for(f=or/(F[0]+1)|0,f>1&&(F=t(F,f),L=t(L,f),I=F.length,P=L.length),T=I,j=L.slice(0,I),_=j.length;_<I;)j[_++]=0;O=F.slice(),O.unshift(0),R=F[0],F[1]>=or/2&&++R;do f=0,c=s(F,j,I,_),c<0?(C=j[0],I!=_&&(C=C*or+(j[1]||0)),f=C/R|0,f>1?(f>=or&&(f=or-1),m=t(F,f),x=m.length,_=j.length,c=s(m,j,x,_),c==1&&(f--,n(m,I<x?O:F,x))):(f==0&&(c=f=1),m=F.slice()),x=m.length,x<_&&m.unshift(0),n(j,m,_),c==-1&&(_=j.length,c=s(F,j,I,_),c<1&&(f++,n(j,I<_?O:F,_))),_=j.length):c===0&&(f++,j=[0]),w[u++]=f,c&&j[0]?j[_++]=L[T]||0:(j=[L[T]],_=1);while((T++<P||j[0]!==void 0)&&k--)}return w[0]||w.shift(),b.e=d,Ps(b,o?l+Ln(b)+1:l)}}();function sW(t,s){var n,a,i,l,o,c,d=0,u=0,f=t.constructor,m=f.precision;if(Ln(t)>16)throw Error(r5+Ln(t));if(!t.s)return new f(Ha);for(Ks=!1,c=m,o=new f(.03125);t.abs().gte(.1);)t=t.times(o),u+=5;for(a=Math.log(kd(2,u))/Math.LN10*2+5|0,c+=a,n=i=l=new f(Ha),f.precision=c;;){if(i=Ps(i.times(t),c),n=n.times(++d),o=l.plus(vo(i,n,c)),Ml(o.d).slice(0,c)===Ml(l.d).slice(0,c)){for(;u--;)l=Ps(l.times(l),c);return f.precision=m,s==null?(Ks=!0,Ps(l,m)):l}l=o}}function Ln(t){for(var s=t.e*zs,n=t.d[0];n>=10;n/=10)s++;return s}function Ij(t,s,n){if(s>t.LN10.sd())throw Ks=!0,n&&(t.precision=n),Error(Ii+"LN10 precision limit exceeded");return Ps(new t(t.LN10),s)}function uc(t){for(var s="";t--;)s+="0";return s}function ox(t,s){var n,a,i,l,o,c,d,u,f,m=1,x=10,b=t,w=b.d,j=b.constructor,_=j.precision;if(b.s<1)throw Error(Ii+(b.s?"NaN":"-Infinity"));if(b.eq(Ha))return new j(0);if(s==null?(Ks=!1,u=_):u=s,b.eq(10))return s==null&&(Ks=!0),Ij(j,u);if(u+=x,j.precision=u,n=Ml(w),a=n.charAt(0),l=Ln(b),Math.abs(l)<15e14){for(;a<7&&a!=1||a==1&&n.charAt(1)>3;)b=b.times(t),n=Ml(b.d),a=n.charAt(0),m++;l=Ln(b),a>1?(b=new j("0."+n),l++):b=new j(a+"."+n.slice(1))}else return d=Ij(j,u+2,_).times(l+""),b=ox(new j(a+"."+n.slice(1)),u-x).plus(d),j.precision=_,s==null?(Ks=!0,Ps(b,_)):b;for(c=o=b=vo(b.minus(Ha),b.plus(Ha),u),f=Ps(b.times(b),u),i=3;;){if(o=Ps(o.times(f),u),d=c.plus(vo(o,new j(i),u)),Ml(d.d).slice(0,u)===Ml(c.d).slice(0,u))return c=c.times(2),l!==0&&(c=c.plus(Ij(j,u+2,_).times(l+""))),c=vo(c,new j(m),u),j.precision=_,s==null?(Ks=!0,Ps(c,_)):c;c=d,i+=2}}function hO(t,s){var n,a,i;for((n=s.indexOf("."))>-1&&(s=s.replace(".","")),(a=s.search(/e/i))>0?(n<0&&(n=a),n+=+s.slice(a+1),s=s.substring(0,a)):n<0&&(n=s.length),a=0;s.charCodeAt(a)===48;)++a;for(i=s.length;s.charCodeAt(i-1)===48;)--i;if(s=s.slice(a,i),s){if(i-=a,n=n-a-1,t.e=$f(n/zs),t.d=[],a=(n+1)%zs,n<0&&(a+=zs),a<i){for(a&&t.d.push(+s.slice(0,a)),i-=zs;a<i;)t.d.push(+s.slice(a,a+=zs));s=s.slice(a),a=zs-s.length}else a-=i;for(;a--;)s+="0";if(t.d.push(+s),Ks&&(t.e>R1||t.e<-R1))throw Error(r5+n)}else t.s=0,t.e=0,t.d=[0];return t}function Ps(t,s,n){var a,i,l,o,c,d,u,f,m=t.d;for(o=1,l=m[0];l>=10;l/=10)o++;if(a=s-o,a<0)a+=zs,i=s,u=m[f=0];else{if(f=Math.ceil((a+1)/zs),l=m.length,f>=l)return t;for(u=l=m[f],o=1;l>=10;l/=10)o++;a%=zs,i=a-zs+o}if(n!==void 0&&(l=kd(10,o-i-1),c=u/l%10|0,d=s<0||m[f+1]!==void 0||u%l,d=n<4?(c||d)&&(n==0||n==(t.s<0?3:2)):c>5||c==5&&(n==4||d||n==6&&(a>0?i>0?u/kd(10,o-i):0:m[f-1])%10&1||n==(t.s<0?8:7))),s<1||!m[0])return d?(l=Ln(t),m.length=1,s=s-l-1,m[0]=kd(10,(zs-s%zs)%zs),t.e=$f(-s/zs)||0):(m.length=1,m[0]=t.e=t.s=0),t;if(a==0?(m.length=f,l=1,f--):(m.length=f+1,l=kd(10,zs-a),m[f]=i>0?(u/kd(10,o-i)%kd(10,i)|0)*l:0),d)for(;;)if(f==0){(m[0]+=l)==or&&(m[0]=1,++t.e);break}else{if(m[f]+=l,m[f]!=or)break;m[f--]=0,l=1}for(a=m.length;m[--a]===0;)m.pop();if(Ks&&(t.e>R1||t.e<-R1))throw Error(r5+Ln(t));return t}function nW(t,s){var n,a,i,l,o,c,d,u,f,m,x=t.constructor,b=x.precision;if(!t.s||!s.s)return s.s?s.s=-s.s:s=new x(t),Ks?Ps(s,b):s;if(d=t.d,m=s.d,a=s.e,u=t.e,d=d.slice(),o=u-a,o){for(f=o<0,f?(n=d,o=-o,c=m.length):(n=m,a=u,c=d.length),i=Math.max(Math.ceil(b/zs),c)+2,o>i&&(o=i,n.length=1),n.reverse(),i=o;i--;)n.push(0);n.reverse()}else{for(i=d.length,c=m.length,f=i<c,f&&(c=i),i=0;i<c;i++)if(d[i]!=m[i]){f=d[i]<m[i];break}o=0}for(f&&(n=d,d=m,m=n,s.s=-s.s),c=d.length,i=m.length-c;i>0;--i)d[c++]=0;for(i=m.length;i>o;){if(d[--i]<m[i]){for(l=i;l&&d[--l]===0;)d[l]=or-1;--d[l],d[i]+=or}d[i]-=m[i]}for(;d[--c]===0;)d.pop();for(;d[0]===0;d.shift())--a;return d[0]?(s.d=d,s.e=a,Ks?Ps(s,b):s):new x(0)}function Su(t,s,n){var a,i=Ln(t),l=Ml(t.d),o=l.length;return s?(n&&(a=n-o)>0?l=l.charAt(0)+"."+l.slice(1)+uc(a):o>1&&(l=l.charAt(0)+"."+l.slice(1)),l=l+(i<0?"e":"e+")+i):i<0?(l="0."+uc(-i-1)+l,n&&(a=n-o)>0&&(l+=uc(a))):i>=o?(l+=uc(i+1-o),n&&(a=n-i-1)>0&&(l=l+"."+uc(a))):((a=i+1)<o&&(l=l.slice(0,a)+"."+l.slice(a)),n&&(a=n-o)>0&&(i+1===o&&(l+="."),l+=uc(a))),t.s<0?"-"+l:l}function fO(t,s){if(t.length>s)return t.length=s,!0}function rW(t){var s,n,a;function i(l){var o=this;if(!(o instanceof i))return new i(l);if(o.constructor=i,l instanceof i){o.s=l.s,o.e=l.e,o.d=(l=l.d)?l.slice():l;return}if(typeof l=="number"){if(l*0!==0)throw Error(au+l);if(l>0)o.s=1;else if(l<0)l=-l,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(l===~~l&&l<1e7){o.e=0,o.d=[l];return}return hO(o,l.toString())}else if(typeof l!="string")throw Error(au+l);if(l.charCodeAt(0)===45?(l=l.slice(1),o.s=-1):o.s=1,LAe.test(l))hO(o,l);else throw Error(au+l)}if(i.prototype=ft,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=rW,i.config=i.set=BAe,t===void 0&&(t={}),t)for(a=["precision","rounding","toExpNeg","toExpPos","LN10"],s=0;s<a.length;)t.hasOwnProperty(n=a[s++])||(t[n]=this[n]);return i.config(t),i}function BAe(t){if(!t||typeof t!="object")throw Error(Ii+"Object expected");var s,n,a,i=["precision",1,Ff,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(s=0;s<i.length;s+=3)if((a=t[n=i[s]])!==void 0)if($f(a)===a&&a>=i[s+1]&&a<=i[s+2])this[n]=a;else throw Error(au+n+": "+a);if((a=t[n="LN10"])!==void 0)if(a==Math.LN10)this[n]=new this(a);else throw Error(au+n+": "+a);return this}var a5=rW(RAe);Ha=new a5(1);const gs=a5;var FAe=t=>t,aW={},iW=t=>t===aW,mO=t=>function s(){return arguments.length===0||arguments.length===1&&iW(arguments.length<=0?void 0:arguments[0])?s:t(...arguments)},lW=(t,s)=>t===1?s:mO(function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var l=a.filter(o=>o!==aW).length;return l>=t?s(...a):lW(t-l,mO(function(){for(var o=arguments.length,c=new Array(o),d=0;d<o;d++)c[d]=arguments[d];var u=a.map(f=>iW(f)?c.shift():f);return s(...u,...c)}))}),Fv=t=>lW(t.length,t),QS=(t,s)=>{for(var n=[],a=t;a<s;++a)n[a-t]=a;return n},$Ae=Fv((t,s)=>Array.isArray(s)?s.map(t):Object.keys(s).map(n=>s[n]).map(t)),zAe=function(){for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];if(!n.length)return FAe;var i=n.reverse(),l=i[0],o=i.slice(1);return function(){return o.reduce((c,d)=>d(c),l(...arguments))}},ZS=t=>Array.isArray(t)?t.reverse():t.split("").reverse().join(""),oW=t=>{var s=null,n=null;return function(){for(var a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return s&&i.every((o,c)=>{var d;return o===((d=s)===null||d===void 0?void 0:d[c])})||(s=i,n=t(...i)),n}};function cW(t){var s;return t===0?s=1:s=Math.floor(new gs(t).abs().log(10).toNumber())+1,s}function dW(t,s,n){for(var a=new gs(t),i=0,l=[];a.lt(s)&&i<1e5;)l.push(a.toNumber()),a=a.add(n),i++;return l}Fv((t,s,n)=>{var a=+t,i=+s;return a+n*(i-a)});Fv((t,s,n)=>{var a=s-+t;return a=a||1/0,(n-t)/a});Fv((t,s,n)=>{var a=s-+t;return a=a||1/0,Math.max(0,Math.min(1,(n-t)/a))});var uW=t=>{var[s,n]=t,[a,i]=[s,n];return s>n&&([a,i]=[n,s]),[a,i]},hW=(t,s,n)=>{if(t.lte(0))return new gs(0);var a=cW(t.toNumber()),i=new gs(10).pow(a),l=t.div(i),o=a!==1?.05:.1,c=new gs(Math.ceil(l.div(o).toNumber())).add(n).mul(o),d=c.mul(i);return s?new gs(d.toNumber()):new gs(Math.ceil(d.toNumber()))},UAe=(t,s,n)=>{var a=new gs(1),i=new gs(t);if(!i.isint()&&n){var l=Math.abs(t);l<1?(a=new gs(10).pow(cW(t)-1),i=new gs(Math.floor(i.div(a).toNumber())).mul(a)):l>1&&(i=new gs(Math.floor(t)))}else t===0?i=new gs(Math.floor((s-1)/2)):n||(i=new gs(Math.floor(t)));var o=Math.floor((s-1)/2),c=zAe($Ae(d=>i.add(new gs(d-o).mul(a)).toNumber()),QS);return c(0,s)},fW=function(s,n,a,i){var l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((n-s)/(a-1)))return{step:new gs(0),tickMin:new gs(0),tickMax:new gs(0)};var o=hW(new gs(n).sub(s).div(a-1),i,l),c;s<=0&&n>=0?c=new gs(0):(c=new gs(s).add(n).div(2),c=c.sub(new gs(c).mod(o)));var d=Math.ceil(c.sub(s).div(o).toNumber()),u=Math.ceil(new gs(n).sub(c).div(o).toNumber()),f=d+u+1;return f>a?fW(s,n,a,i,l+1):(f<a&&(u=n>0?u+(a-f):u,d=n>0?d:d+(a-f)),{step:o,tickMin:c.sub(new gs(d).mul(o)),tickMax:c.add(new gs(u).mul(o))})};function VAe(t){var[s,n]=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=Math.max(a,2),[o,c]=uW([s,n]);if(o===-1/0||c===1/0){var d=c===1/0?[o,...QS(0,a-1).map(()=>1/0)]:[...QS(0,a-1).map(()=>-1/0),c];return s>n?ZS(d):d}if(o===c)return UAe(o,a,i);var{step:u,tickMin:f,tickMax:m}=fW(o,c,l,i,0),x=dW(f,m.add(new gs(.1).mul(u)),u);return s>n?ZS(x):x}function HAe(t,s){var[n,a]=t,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[l,o]=uW([n,a]);if(l===-1/0||o===1/0)return[n,a];if(l===o)return[l];var c=Math.max(s,2),d=hW(new gs(o).sub(l).div(c-1),i,0),u=[...dW(new gs(l),new gs(o),d),o];return i===!1&&(u=u.map(f=>Math.round(f))),n>a?ZS(u):u}var WAe=oW(VAe),qAe=oW(HAe),mW=t=>t.rootProps.maxBarSize,GAe=t=>t.rootProps.barGap,pW=t=>t.rootProps.barCategoryGap,KAe=t=>t.rootProps.barSize,zx=t=>t.rootProps.stackOffset,i5=t=>t.options.chartName,l5=t=>t.rootProps.syncId,xW=t=>t.rootProps.syncMethod,o5=t=>t.options.eventEmitter,zr={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},uo={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},$a={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},$v=(t,s)=>{if(!(!t||!s))return t!=null&&t.reversed?[s[1],s[0]]:s},YAe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:uo.angleAxisId,includeHidden:!1,name:void 0,reversed:uo.reversed,scale:uo.scale,tick:uo.tick,tickCount:void 0,ticks:void 0,type:uo.type,unit:void 0},XAe={allowDataOverflow:$a.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:$a.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:$a.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:$a.scale,tick:$a.tick,tickCount:$a.tickCount,ticks:void 0,type:$a.type,unit:void 0},QAe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:uo.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:uo.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:uo.scale,tick:uo.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},ZAe={allowDataOverflow:$a.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:$a.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:$a.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:$a.scale,tick:$a.tick,tickCount:$a.tickCount,ticks:void 0,type:"category",unit:void 0},c5=(t,s)=>t.polarAxis.angleAxis[s]!=null?t.polarAxis.angleAxis[s]:t.layout.layoutType==="radial"?QAe:YAe,d5=(t,s)=>t.polarAxis.radiusAxis[s]!=null?t.polarAxis.radiusAxis[s]:t.layout.layoutType==="radial"?ZAe:XAe,zv=t=>t.polarOptions,u5=Ae([zo,Uo,tr],uH),gW=Ae([zv,u5],(t,s)=>{if(t!=null)return Hr(t.innerRadius,s,0)}),yW=Ae([zv,u5],(t,s)=>{if(t!=null)return Hr(t.outerRadius,s,s*.8)}),JAe=t=>{if(t==null)return[0,0];var{startAngle:s,endAngle:n}=t;return[s,n]},bW=Ae([zv],JAe);Ae([c5,bW],$v);var vW=Ae([u5,gW,yW],(t,s,n)=>{if(!(t==null||s==null||n==null))return[s,n]});Ae([d5,vW],$v);var wW=Ae([ds,zv,gW,yW,zo,Uo],(t,s,n,a,i,l)=>{if(!(t!=="centric"&&t!=="radial"||s==null||n==null||a==null)){var{cx:o,cy:c,startAngle:d,endAngle:u}=s;return{cx:Hr(o,i,i/2),cy:Hr(c,l,l/2),innerRadius:n,outerRadius:a,startAngle:d,endAngle:u,clockWise:!1}}}),Xs=(t,s)=>s,Ux=(t,s,n)=>n;function h5(t){return t==null?void 0:t.id}function NW(t,s,n){var{chartData:a=[]}=s,{allowDuplicatedCategory:i,dataKey:l}=n,o=new Map;return t.forEach(c=>{var d,u=(d=c.data)!==null&&d!==void 0?d:a;if(!(u==null||u.length===0)){var f=h5(c);u.forEach((m,x)=>{var b=l==null||i?x:String(nn(m,l,null)),w=nn(m,c.dataKey,0),j;o.has(b)?j=o.get(b):j={},Object.assign(j,{[f]:w}),o.set(b,j)})}}),Array.from(o.values())}function Uv(t){return t.stackId!=null&&t.dataKey!=null}var Vv=(t,s)=>t===s?!0:t==null||s==null?!1:t[0]===s[0]&&t[1]===s[1];function Hv(t,s){return Array.isArray(t)&&Array.isArray(s)&&t.length===0&&s.length===0?!0:t===s}function e5e(t,s){if(t.length===s.length){for(var n=0;n<t.length;n++)if(t[n]!==s[n])return!1;return!0}return!1}var nr=t=>{var s=ds(t);return s==="horizontal"?"xAxis":s==="vertical"?"yAxis":s==="centric"?"angleAxis":"radiusAxis"},zf=t=>t.tooltip.settings.axisId;function pO(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function L1(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?pO(Object(n),!0).forEach(function(a){t5e(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pO(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function t5e(t,s,n){return(s=s5e(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function s5e(t){var s=n5e(t,"string");return typeof s=="symbol"?s:s+""}function n5e(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var JS=[0,"auto"],Oa={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},jW=(t,s)=>t.cartesianAxis.xAxis[s],Ho=(t,s)=>{var n=jW(t,s);return n??Oa},Ra={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:JS,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Rx},_W=(t,s)=>t.cartesianAxis.yAxis[s],Wo=(t,s)=>{var n=_W(t,s);return n??Ra},r5e={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},f5=(t,s)=>{var n=t.cartesianAxis.zAxis[s];return n??r5e},cn=(t,s,n)=>{switch(s){case"xAxis":return Ho(t,n);case"yAxis":return Wo(t,n);case"zAxis":return f5(t,n);case"angleAxis":return c5(t,n);case"radiusAxis":return d5(t,n);default:throw new Error("Unexpected axis type: ".concat(s))}},a5e=(t,s,n)=>{switch(s){case"xAxis":return Ho(t,n);case"yAxis":return Wo(t,n);default:throw new Error("Unexpected axis type: ".concat(s))}},Vx=(t,s,n)=>{switch(s){case"xAxis":return Ho(t,n);case"yAxis":return Wo(t,n);case"angleAxis":return c5(t,n);case"radiusAxis":return d5(t,n);default:throw new Error("Unexpected axis type: ".concat(s))}},SW=t=>t.graphicalItems.cartesianItems.some(s=>s.type==="bar")||t.graphicalItems.polarItems.some(s=>s.type==="radialBar");function m5(t,s){return n=>{switch(t){case"xAxis":return"xAxisId"in n&&n.xAxisId===s;case"yAxis":return"yAxisId"in n&&n.yAxisId===s;case"zAxis":return"zAxisId"in n&&n.zAxisId===s;case"angleAxis":return"angleAxisId"in n&&n.angleAxisId===s;case"radiusAxis":return"radiusAxisId"in n&&n.radiusAxisId===s;default:return!1}}}var p5=t=>t.graphicalItems.cartesianItems,i5e=Ae([Xs,Ux],m5),x5=(t,s,n)=>t.filter(n).filter(a=>(s==null?void 0:s.includeHidden)===!0?!0:!a.hide),Hx=Ae([p5,cn,i5e],x5,{memoizeOptions:{resultEqualityCheck:Hv}}),CW=Ae([Hx],t=>t.filter(s=>s.type==="area"||s.type==="bar").filter(Uv)),kW=t=>t.filter(s=>!("stackId"in s)||s.stackId===void 0),l5e=Ae([Hx],kW),g5=t=>t.map(s=>s.data).filter(Boolean).flat(1),o5e=Ae([Hx],g5,{memoizeOptions:{resultEqualityCheck:Hv}}),y5=(t,s)=>{var{chartData:n=[],dataStartIndex:a,dataEndIndex:i}=s;return t.length>0?t:n.slice(a,i+1)},b5=Ae([o5e,n5],y5),v5=(t,s,n)=>(s==null?void 0:s.dataKey)!=null?t.map(a=>({value:nn(a,s.dataKey)})):n.length>0?n.map(a=>a.dataKey).flatMap(a=>t.map(i=>({value:nn(i,a)}))):t.map(a=>({value:a})),Wv=Ae([b5,cn,Hx],v5);function AW(t,s){switch(t){case"xAxis":return s.direction==="x";case"yAxis":return s.direction==="y";default:return!1}}function Zg(t){if(Kl(t)||t instanceof Date){var s=Number(t);if(Cn(s))return s}}function xO(t){if(Array.isArray(t)){var s=[Zg(t[0]),Zg(t[1])];return _u(s)?s:void 0}var n=Zg(t);if(n!=null)return[n,n]}function Oo(t){return t.map(Zg).filter(b2e)}function c5e(t,s,n){return!n||typeof s!="number"||Gl(s)?[]:n.length?Oo(n.flatMap(a=>{var i=nn(t,a.dataKey),l,o;if(Array.isArray(i)?[l,o]=i:l=o=i,!(!Cn(l)||!Cn(o)))return[s-l,s+o]})):[]}var rr=t=>{var s=nr(t),n=zf(t);return Vx(t,s,n)},EW=Ae([rr],t=>t==null?void 0:t.dataKey),d5e=Ae([CW,n5,rr],NW),TW=(t,s,n)=>{var a={},i=s.reduce((l,o)=>(o.stackId==null||(l[o.stackId]==null&&(l[o.stackId]=[]),l[o.stackId].push(o)),l),a);return Object.fromEntries(Object.entries(i).map(l=>{var[o,c]=l,d=c.map(h5);return[o,{stackedData:iSe(t,d,n),graphicalItems:c}]}))},eC=Ae([d5e,CW,zx],TW),PW=(t,s,n,a)=>{var{dataStartIndex:i,dataEndIndex:l}=s;if(a==null&&n!=="zAxis"){var o=uSe(t,i,l);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},u5e=Ae([cn],t=>t.allowDataOverflow),w5=t=>{var s;if(t==null||!("domain"in t))return JS;if(t.domain!=null)return t.domain;if(t.ticks!=null){if(t.type==="number"){var n=Oo(t.ticks);return[Math.min(...n),Math.max(...n)]}if(t.type==="category")return t.ticks.map(String)}return(s=t==null?void 0:t.domain)!==null&&s!==void 0?s:JS},N5=Ae([cn],w5),j5=Ae([N5,u5e],JH),h5e=Ae([eC,fd,Xs,j5],PW,{memoizeOptions:{resultEqualityCheck:Vv}}),qv=t=>t.errorBars,f5e=(t,s,n)=>t.flatMap(a=>s[a.id]).filter(Boolean).filter(a=>AW(n,a)),B1=function(){for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];var i=n.filter(Boolean);if(i.length!==0){var l=i.flat(),o=Math.min(...l),c=Math.max(...l);return[o,c]}},_5=(t,s,n,a,i)=>{var l,o;if(n.length>0&&t.forEach(c=>{n.forEach(d=>{var u,f,m=(u=a[d.id])===null||u===void 0?void 0:u.filter(C=>AW(i,C)),x=nn(c,(f=s.dataKey)!==null&&f!==void 0?f:d.dataKey),b=c5e(c,x,m);if(b.length>=2){var w=Math.min(...b),j=Math.max(...b);(l==null||w<l)&&(l=w),(o==null||j>o)&&(o=j)}var _=xO(x);_!=null&&(l=l==null?_[0]:Math.min(l,_[0]),o=o==null?_[1]:Math.max(o,_[1]))})}),(s==null?void 0:s.dataKey)!=null&&t.forEach(c=>{var d=xO(nn(c,s.dataKey));d!=null&&(l=l==null?d[0]:Math.min(l,d[0]),o=o==null?d[1]:Math.max(o,d[1]))}),Cn(l)&&Cn(o))return[l,o]},m5e=Ae([b5,cn,l5e,qv,Xs],_5,{memoizeOptions:{resultEqualityCheck:Vv}});function p5e(t){var{value:s}=t;if(Kl(s)||s instanceof Date)return s}var x5e=(t,s,n)=>{var a=t.map(p5e).filter(i=>i!=null);return n&&(s.dataKey==null||s.allowDuplicatedCategory&&WU(a))?yH(0,t.length):s.allowDuplicatedCategory?a:Array.from(new Set(a))},IW=t=>t.referenceElements.dots,Uf=(t,s,n)=>t.filter(a=>a.ifOverflow==="extendDomain").filter(a=>s==="xAxis"?a.xAxisId===n:a.yAxisId===n),g5e=Ae([IW,Xs,Ux],Uf),MW=t=>t.referenceElements.areas,y5e=Ae([MW,Xs,Ux],Uf),DW=t=>t.referenceElements.lines,b5e=Ae([DW,Xs,Ux],Uf),OW=(t,s)=>{var n=Oo(t.map(a=>s==="xAxis"?a.x:a.y));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},v5e=Ae(g5e,Xs,OW),RW=(t,s)=>{var n=Oo(t.flatMap(a=>[s==="xAxis"?a.x1:a.y1,s==="xAxis"?a.x2:a.y2]));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},w5e=Ae([y5e,Xs],RW);function N5e(t){var s;if(t.x!=null)return Oo([t.x]);var n=(s=t.segment)===null||s===void 0?void 0:s.map(a=>a.x);return n==null||n.length===0?[]:Oo(n)}function j5e(t){var s;if(t.y!=null)return Oo([t.y]);var n=(s=t.segment)===null||s===void 0?void 0:s.map(a=>a.y);return n==null||n.length===0?[]:Oo(n)}var LW=(t,s)=>{var n=t.flatMap(a=>s==="xAxis"?N5e(a):j5e(a));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},_5e=Ae([b5e,Xs],LW),S5e=Ae(v5e,_5e,w5e,(t,s,n)=>B1(t,n,s)),S5=(t,s,n,a,i,l,o,c)=>{if(n!=null)return n;var d=o==="vertical"&&c==="xAxis"||o==="horizontal"&&c==="yAxis",u=d?B1(a,l,i):B1(l,i);return OAe(s,u,t.allowDataOverflow)},C5e=Ae([cn,N5,j5,h5e,m5e,S5e,ds,Xs],S5,{memoizeOptions:{resultEqualityCheck:Vv}}),k5e=[0,1],C5=(t,s,n,a,i,l,o)=>{if(!((t==null||n==null||n.length===0)&&o===void 0)){var{dataKey:c,type:d}=t,u=Bu(s,l);if(u&&c==null){var f;return yH(0,(f=n==null?void 0:n.length)!==null&&f!==void 0?f:0)}return d==="category"?x5e(a,t,u):i==="expand"?k5e:o}},k5=Ae([cn,ds,b5,Wv,zx,Xs,C5e],C5),BW=(t,s,n,a,i)=>{if(t!=null){var{scale:l,type:o}=t;if(l==="auto")return s==="radial"&&i==="radiusAxis"?"band":s==="radial"&&i==="angleAxis"?"linear":o==="category"&&a&&(a.indexOf("LineChart")>=0||a.indexOf("AreaChart")>=0||a.indexOf("ComposedChart")>=0&&!n)?"point":o==="category"?"band":"linear";if(typeof l=="string"){var c="scale".concat(Mx(l));return c in Um?c:"point"}}},Vf=Ae([cn,ds,SW,i5,Xs],BW);function A5e(t){if(t!=null){if(t in Um)return Um[t]();var s="scale".concat(Mx(t));if(s in Um)return Um[s]()}}function A5(t,s,n,a){if(!(n==null||a==null)){if(typeof t.scale=="function")return t.scale.copy().domain(n).range(a);var i=A5e(s);if(i!=null){var l=i.domain(n).range(a);return tSe(l),l}}}var E5=(t,s,n)=>{var a=w5(s);if(!(n!=="auto"&&n!=="linear")){if(s!=null&&s.tickCount&&Array.isArray(a)&&(a[0]==="auto"||a[1]==="auto")&&_u(t))return WAe(t,s.tickCount,s.allowDecimals);if(s!=null&&s.tickCount&&s.type==="number"&&_u(t))return qAe(t,s.tickCount,s.allowDecimals)}},T5=Ae([k5,Vx,Vf],E5),P5=(t,s,n,a)=>{if(a!=="angleAxis"&&(t==null?void 0:t.type)==="number"&&_u(s)&&Array.isArray(n)&&n.length>0){var i=s[0],l=n[0],o=s[1],c=n[n.length-1];return[Math.min(i,l),Math.max(o,c)]}return s},E5e=Ae([cn,k5,T5,Xs],P5),T5e=Ae(Wv,cn,(t,s)=>{if(!(!s||s.type!=="number")){var n=1/0,a=Array.from(Oo(t.map(c=>c.value))).sort((c,d)=>c-d);if(a.length<2)return 1/0;var i=a[a.length-1]-a[0];if(i===0)return 1/0;for(var l=0;l<a.length-1;l++){var o=a[l+1]-a[l];n=Math.min(n,o)}return n/i}}),FW=Ae(T5e,ds,pW,tr,(t,s,n,a)=>a,(t,s,n,a,i)=>{if(!Cn(t))return 0;var l=s==="vertical"?a.height:a.width;if(i==="gap")return t*l/2;if(i==="no-gap"){var o=Hr(n,t*l),c=t*l/2;return c-o-(c-o)/l*o}return 0}),P5e=(t,s)=>{var n=Ho(t,s);return n==null||typeof n.padding!="string"?0:FW(t,"xAxis",s,n.padding)},I5e=(t,s)=>{var n=Wo(t,s);return n==null||typeof n.padding!="string"?0:FW(t,"yAxis",s,n.padding)},M5e=Ae(Ho,P5e,(t,s)=>{var n,a;if(t==null)return{left:0,right:0};var{padding:i}=t;return typeof i=="string"?{left:s,right:s}:{left:((n=i.left)!==null&&n!==void 0?n:0)+s,right:((a=i.right)!==null&&a!==void 0?a:0)+s}}),D5e=Ae(Wo,I5e,(t,s)=>{var n,a;if(t==null)return{top:0,bottom:0};var{padding:i}=t;return typeof i=="string"?{top:s,bottom:s}:{top:((n=i.top)!==null&&n!==void 0?n:0)+s,bottom:((a=i.bottom)!==null&&a!==void 0?a:0)+s}}),O5e=Ae([tr,M5e,kv,Cv,(t,s,n)=>n],(t,s,n,a,i)=>{var{padding:l}=a;return i?[l.left,n.width-l.right]:[t.left+s.left,t.left+t.width-s.right]}),R5e=Ae([tr,ds,D5e,kv,Cv,(t,s,n)=>n],(t,s,n,a,i,l)=>{var{padding:o}=i;return l?[a.height-o.bottom,o.top]:s==="horizontal"?[t.top+t.height-n.bottom,t.top+n.top]:[t.top+n.top,t.top+t.height-n.bottom]}),Wx=(t,s,n,a)=>{var i;switch(s){case"xAxis":return O5e(t,n,a);case"yAxis":return R5e(t,n,a);case"zAxis":return(i=f5(t,n))===null||i===void 0?void 0:i.range;case"angleAxis":return bW(t);case"radiusAxis":return vW(t,n);default:return}},$W=Ae([cn,Wx],$v),Hf=Ae([cn,Vf,E5e,$W],A5);Ae([Hx,qv,Xs],f5e);function zW(t,s){return t.id<s.id?-1:t.id>s.id?1:0}var Gv=(t,s)=>s,Kv=(t,s,n)=>n,L5e=Ae(_v,Gv,Kv,(t,s,n)=>t.filter(a=>a.orientation===s).filter(a=>a.mirror===n).sort(zW)),B5e=Ae(Sv,Gv,Kv,(t,s,n)=>t.filter(a=>a.orientation===s).filter(a=>a.mirror===n).sort(zW)),UW=(t,s)=>({width:t.width,height:s.height}),F5e=(t,s)=>{var n=typeof s.width=="number"?s.width:Rx;return{width:n,height:t.height}},VW=Ae(tr,Ho,UW),$5e=(t,s,n)=>{switch(s){case"top":return t.top;case"bottom":return n-t.bottom;default:return 0}},z5e=(t,s,n)=>{switch(s){case"left":return t.left;case"right":return n-t.right;default:return 0}},U5e=Ae(Uo,tr,L5e,Gv,Kv,(t,s,n,a,i)=>{var l={},o;return n.forEach(c=>{var d=UW(s,c);o==null&&(o=$5e(s,a,t));var u=a==="top"&&!i||a==="bottom"&&i;l[c.id]=o-Number(u)*d.height,o+=(u?-1:1)*d.height}),l}),V5e=Ae(zo,tr,B5e,Gv,Kv,(t,s,n,a,i)=>{var l={},o;return n.forEach(c=>{var d=F5e(s,c);o==null&&(o=z5e(s,a,t));var u=a==="left"&&!i||a==="right"&&i;l[c.id]=o-Number(u)*d.width,o+=(u?-1:1)*d.width}),l}),H5e=(t,s)=>{var n=Ho(t,s);if(n!=null)return U5e(t,n.orientation,n.mirror)},W5e=Ae([tr,Ho,H5e,(t,s)=>s],(t,s,n,a)=>{if(s!=null){var i=n==null?void 0:n[a];return i==null?{x:t.left,y:0}:{x:t.left,y:i}}}),q5e=(t,s)=>{var n=Wo(t,s);if(n!=null)return V5e(t,n.orientation,n.mirror)},G5e=Ae([tr,Wo,q5e,(t,s)=>s],(t,s,n,a)=>{if(s!=null){var i=n==null?void 0:n[a];return i==null?{x:0,y:t.top}:{x:i,y:t.top}}}),HW=Ae(tr,Wo,(t,s)=>{var n=typeof s.width=="number"?s.width:Rx;return{width:n,height:t.height}}),gO=(t,s,n)=>{switch(s){case"xAxis":return VW(t,n).width;case"yAxis":return HW(t,n).height;default:return}},WW=(t,s,n,a)=>{if(n!=null){var{allowDuplicatedCategory:i,type:l,dataKey:o}=n,c=Bu(t,a),d=s.map(u=>u.value);if(o&&c&&l==="category"&&i&&WU(d))return d}},I5=Ae([ds,Wv,cn,Xs],WW),qW=(t,s,n,a)=>{if(!(n==null||n.dataKey==null)){var{type:i,scale:l}=n,o=Bu(t,a);if(o&&(i==="number"||l!=="auto"))return s.map(c=>c.value)}},M5=Ae([ds,Wv,Vx,Xs],qW);Ae([ds,a5e,Vf,Hf,I5,M5,Wx,T5,Xs],(t,s,n,a,i,l,o,c,d)=>{if(s!=null){var u=Bu(t,d);return{angle:s.angle,interval:s.interval,minTickGap:s.minTickGap,orientation:s.orientation,tick:s.tick,tickCount:s.tickCount,tickFormatter:s.tickFormatter,ticks:s.ticks,type:s.type,unit:s.unit,axisType:d,categoricalDomain:l,duplicateDomain:i,isCategorical:u,niceTicks:c,range:o,realScaleType:n,scale:a}}});var K5e=(t,s,n,a,i,l,o,c,d)=>{if(!(s==null||a==null)){var u=Bu(t,d),{type:f,ticks:m,tickCount:x}=s,b=n==="scaleBand"&&typeof a.bandwidth=="function"?a.bandwidth()/2:2,w=f==="category"&&a.bandwidth?a.bandwidth()/b:0;w=d==="angleAxis"&&l!=null&&l.length>=2?Ar(l[0]-l[1])*2*w:w;var j=m||i;if(j){var _=j.map((C,k)=>{var A=o?o.indexOf(C):C;return{index:k,coordinate:a(A)+w,value:C,offset:w}});return _.filter(C=>Cn(C.coordinate))}return u&&c?c.map((C,k)=>({coordinate:a(C)+w,value:C,index:k,offset:w})).filter(C=>Cn(C.coordinate)):a.ticks?a.ticks(x).map(C=>({coordinate:a(C)+w,value:C,offset:w})):a.domain().map((C,k)=>({coordinate:a(C)+w,value:o?o[C]:C,index:k,offset:w}))}},GW=Ae([ds,Vx,Vf,Hf,T5,Wx,I5,M5,Xs],K5e),Y5e=(t,s,n,a,i,l,o)=>{if(!(s==null||n==null||a==null||a[0]===a[1])){var c=Bu(t,o),{tickCount:d}=s,u=0;return u=o==="angleAxis"&&(a==null?void 0:a.length)>=2?Ar(a[0]-a[1])*2*u:u,c&&l?l.map((f,m)=>({coordinate:n(f)+u,value:f,index:m,offset:u})):n.ticks?n.ticks(d).map(f=>({coordinate:n(f)+u,value:f,offset:u})):n.domain().map((f,m)=>({coordinate:n(f)+u,value:i?i[f]:f,index:m,offset:u}))}},ff=Ae([ds,Vx,Hf,Wx,I5,M5,Xs],Y5e),mf=Ae(cn,Hf,(t,s)=>{if(!(t==null||s==null))return L1(L1({},t),{},{scale:s})}),X5e=Ae([cn,Vf,k5,$W],A5);Ae((t,s,n)=>f5(t,n),X5e,(t,s)=>{if(!(t==null||s==null))return L1(L1({},t),{},{scale:s})});var Q5e=Ae([ds,_v,Sv],(t,s,n)=>{switch(t){case"horizontal":return s.some(a=>a.reversed)?"right-to-left":"left-to-right";case"vertical":return n.some(a=>a.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),KW=t=>t.options.defaultTooltipEventType,YW=t=>t.options.validateTooltipEventTypes;function XW(t,s,n){if(t==null)return s;var a=t?"axis":"item";return n==null?s:n.includes(a)?a:s}function D5(t,s){var n=KW(t),a=YW(t);return XW(s,n,a)}function Z5e(t){return _t(s=>D5(s,t))}var QW=(t,s)=>{var n,a=Number(s);if(!(Gl(a)||s==null))return a>=0?t==null||(n=t[a])===null||n===void 0?void 0:n.value:void 0},J5e=t=>t.tooltip.settings,xc={active:!1,index:null,dataKey:void 0,coordinate:void 0},eEe={itemInteraction:{click:xc,hover:xc},axisInteraction:{click:xc,hover:xc},keyboardInteraction:xc,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},ZW=Pa({name:"tooltip",initialState:eEe,reducers:{addTooltipEntrySettings:{reducer(t,s){t.tooltipItemPayloads.push(s.payload)},prepare:Gn()},removeTooltipEntrySettings:{reducer(t,s){var n=bo(t).tooltipItemPayloads.indexOf(s.payload);n>-1&&t.tooltipItemPayloads.splice(n,1)},prepare:Gn()},setTooltipSettingsState(t,s){t.settings=s.payload},setActiveMouseOverItemIndex(t,s){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=s.payload.activeIndex,t.itemInteraction.hover.dataKey=s.payload.activeDataKey,t.itemInteraction.hover.coordinate=s.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,s){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=s.payload.activeIndex,t.itemInteraction.click.dataKey=s.payload.activeDataKey,t.itemInteraction.click.coordinate=s.payload.activeCoordinate},setMouseOverAxisIndex(t,s){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=s.payload.activeIndex,t.axisInteraction.hover.dataKey=s.payload.activeDataKey,t.axisInteraction.hover.coordinate=s.payload.activeCoordinate},setMouseClickAxisIndex(t,s){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=s.payload.activeIndex,t.axisInteraction.click.dataKey=s.payload.activeDataKey,t.axisInteraction.click.coordinate=s.payload.activeCoordinate},setSyncInteraction(t,s){t.syncInteraction=s.payload},setKeyboardInteraction(t,s){t.keyboardInteraction.active=s.payload.active,t.keyboardInteraction.index=s.payload.activeIndex,t.keyboardInteraction.coordinate=s.payload.activeCoordinate,t.keyboardInteraction.dataKey=s.payload.activeDataKey}}}),{addTooltipEntrySettings:tEe,removeTooltipEntrySettings:sEe,setTooltipSettingsState:nEe,setActiveMouseOverItemIndex:JW,mouseLeaveItem:rEe,mouseLeaveChart:eq,setActiveClickItemIndex:aEe,setMouseOverAxisIndex:tq,setMouseClickAxisIndex:iEe,setSyncInteraction:tC,setKeyboardInteraction:sC}=ZW.actions,lEe=ZW.reducer;function yO(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function dg(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?yO(Object(n),!0).forEach(function(a){oEe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yO(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function oEe(t,s,n){return(s=cEe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function cEe(t){var s=dEe(t,"string");return typeof s=="symbol"?s:s+""}function dEe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function uEe(t,s,n){return s==="axis"?n==="click"?t.axisInteraction.click:t.axisInteraction.hover:n==="click"?t.itemInteraction.click:t.itemInteraction.hover}function hEe(t){return t.index!=null}var sq=(t,s,n,a)=>{if(s==null)return xc;var i=uEe(t,s,n);if(i==null)return xc;if(i.active)return i;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var l=t.settings.active===!0;if(hEe(i)){if(l)return dg(dg({},i),{},{active:!0})}else if(a!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:a};return dg(dg({},xc),{},{coordinate:i.coordinate})},O5=(t,s)=>{var n=t==null?void 0:t.index;if(n==null)return null;var a=Number(n);if(!Cn(a))return n;var i=0,l=1/0;return s.length>0&&(l=s.length-1),String(Math.max(i,Math.min(a,l)))},nq=(t,s,n,a,i,l,o,c)=>{if(!(l==null||c==null)){var d=o[0],u=d==null?void 0:c(d.positions,l);if(u!=null)return u;var f=i==null?void 0:i[Number(l)];if(f)switch(n){case"horizontal":return{x:f.coordinate,y:(a.top+s)/2};default:return{x:(a.left+t)/2,y:f.coordinate}}}},rq=(t,s,n,a)=>{if(s==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var i;return n==="hover"?i=t.itemInteraction.hover.dataKey:i=t.itemInteraction.click.dataKey,i==null&&a!=null?[t.tooltipItemPayloads[0]]:t.tooltipItemPayloads.filter(l=>{var o;return((o=l.settings)===null||o===void 0?void 0:o.dataKey)===i})},qx=t=>t.options.tooltipPayloadSearcher,Wf=t=>t.tooltip;function bO(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function vO(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?bO(Object(n),!0).forEach(function(a){fEe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bO(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function fEe(t,s,n){return(s=mEe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function mEe(t){var s=pEe(t,"string");return typeof s=="symbol"?s:s+""}function pEe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function xEe(t,s){return t??s}var aq=(t,s,n,a,i,l,o)=>{if(!(s==null||l==null)){var{chartData:c,computedData:d,dataStartIndex:u,dataEndIndex:f}=n,m=[];return t.reduce((x,b)=>{var w,{dataDefinedOnItem:j,settings:_}=b,C=xEe(j,c),k=Array.isArray(C)?WV(C,u,f):C,A=(w=_==null?void 0:_.dataKey)!==null&&w!==void 0?w:a,T=_==null?void 0:_.nameKey,P;if(a&&Array.isArray(k)&&!Array.isArray(k[0])&&o==="axis"?P=y2e(k,a,i):P=l(k,s,d,T),Array.isArray(P))P.forEach(I=>{var O=vO(vO({},_),{},{name:I.name,unit:I.unit,color:void 0,fill:void 0});x.push(sD({tooltipEntrySettings:O,dataKey:I.dataKey,payload:I.payload,value:nn(I.payload,I.dataKey),name:I.name}))});else{var R;x.push(sD({tooltipEntrySettings:_,dataKey:A,payload:P,value:nn(P,A),name:(R=nn(P,T))!==null&&R!==void 0?R:_==null?void 0:_.name}))}return x},m)}},R5=Ae([rr,ds,SW,i5,nr],BW),gEe=Ae([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,s)=>[...t,...s]),yEe=Ae([nr,zf],m5),Gx=Ae([gEe,rr,yEe],x5,{memoizeOptions:{resultEqualityCheck:Hv}}),bEe=Ae([Gx],t=>t.filter(Uv)),vEe=Ae([Gx],g5,{memoizeOptions:{resultEqualityCheck:Hv}}),qf=Ae([vEe,fd],y5),wEe=Ae([bEe,fd,rr],NW),L5=Ae([qf,rr,Gx],v5),iq=Ae([rr],w5),NEe=Ae([rr],t=>t.allowDataOverflow),lq=Ae([iq,NEe],JH),jEe=Ae([Gx],t=>t.filter(Uv)),_Ee=Ae([wEe,jEe,zx],TW),SEe=Ae([_Ee,fd,nr,lq],PW),CEe=Ae([Gx],kW),kEe=Ae([qf,rr,CEe,qv,nr],_5,{memoizeOptions:{resultEqualityCheck:Vv}}),AEe=Ae([IW,nr,zf],Uf),EEe=Ae([AEe,nr],OW),TEe=Ae([MW,nr,zf],Uf),PEe=Ae([TEe,nr],RW),IEe=Ae([DW,nr,zf],Uf),MEe=Ae([IEe,nr],LW),DEe=Ae([EEe,MEe,PEe],B1),OEe=Ae([rr,iq,lq,SEe,kEe,DEe,ds,nr],S5),oq=Ae([rr,ds,qf,L5,zx,nr,OEe],C5),REe=Ae([oq,rr,R5],E5),LEe=Ae([rr,oq,REe,nr],P5),cq=t=>{var s=nr(t),n=zf(t),a=!1;return Wx(t,s,n,a)},dq=Ae([rr,cq],$v),uq=Ae([rr,R5,LEe,dq],A5),BEe=Ae([ds,L5,rr,nr],WW),FEe=Ae([ds,L5,rr,nr],qW),$Ee=(t,s,n,a,i,l,o,c)=>{if(s){var{type:d}=s,u=Bu(t,c);if(a){var f=n==="scaleBand"&&a.bandwidth?a.bandwidth()/2:2,m=d==="category"&&a.bandwidth?a.bandwidth()/f:0;return m=c==="angleAxis"&&i!=null&&(i==null?void 0:i.length)>=2?Ar(i[0]-i[1])*2*m:m,u&&o?o.map((x,b)=>({coordinate:a(x)+m,value:x,index:b,offset:m})):a.domain().map((x,b)=>({coordinate:a(x)+m,value:l?l[x]:x,index:b,offset:m}))}}},qo=Ae([ds,rr,R5,uq,cq,BEe,FEe,nr],$Ee),B5=Ae([KW,YW,J5e],(t,s,n)=>XW(n.shared,t,s)),hq=t=>t.tooltip.settings.trigger,F5=t=>t.tooltip.settings.defaultIndex,Yv=Ae([Wf,B5,hq,F5],sq),Cu=Ae([Yv,qf],O5),fq=Ae([qo,Cu],QW),mq=Ae([Yv],t=>{if(t)return t.dataKey}),pq=Ae([Wf,B5,hq,F5],rq),zEe=Ae([zo,Uo,ds,tr,qo,F5,pq,qx],nq),UEe=Ae([Yv,zEe],(t,s)=>t!=null&&t.coordinate?t.coordinate:s),VEe=Ae([Yv],t=>t.active),HEe=Ae([pq,Cu,fd,EW,fq,qx,B5],aq);Ae([HEe],t=>{if(t!=null){var s=t.map(n=>n.payload).filter(n=>n!=null);return Array.from(new Set(s))}});function wO(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function NO(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?wO(Object(n),!0).forEach(function(a){WEe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):wO(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function WEe(t,s,n){return(s=qEe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function qEe(t){var s=GEe(t,"string");return typeof s=="symbol"?s:s+""}function GEe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var KEe=()=>_t(rr),YEe=()=>{var t=KEe(),s=_t(qo),n=_t(uq);return w1(!t||!n?void 0:NO(NO({},t),{},{scale:n}),s)};function jO(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function th(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?jO(Object(n),!0).forEach(function(a){XEe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):jO(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function XEe(t,s,n){return(s=QEe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function QEe(t){var s=ZEe(t,"string");return typeof s=="symbol"?s:s+""}function ZEe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var JEe=(t,s,n,a)=>{var i=s.find(l=>l&&l.index===n);if(i){if(t==="horizontal")return{x:i.coordinate,y:a.chartY};if(t==="vertical")return{x:a.chartX,y:i.coordinate}}return{x:0,y:0}},eTe=(t,s,n,a)=>{var i=s.find(u=>u&&u.index===n);if(i){if(t==="centric"){var l=i.coordinate,{radius:o}=a;return th(th(th({},a),On(a.cx,a.cy,o,l)),{},{angle:l,radius:o})}var c=i.coordinate,{angle:d}=a;return th(th(th({},a),On(a.cx,a.cy,c,d)),{},{angle:d,radius:c})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function tTe(t,s){var{chartX:n,chartY:a}=t;return n>=s.left&&n<=s.left+s.width&&a>=s.top&&a<=s.top+s.height}var xq=(t,s,n,a,i)=>{var l,o=-1,c=(l=s==null?void 0:s.length)!==null&&l!==void 0?l:0;if(c<=1||t==null)return 0;if(a==="angleAxis"&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var d=0;d<c;d++){var u=d>0?n[d-1].coordinate:n[c-1].coordinate,f=n[d].coordinate,m=d>=c-1?n[0].coordinate:n[d+1].coordinate,x=void 0;if(Ar(f-u)!==Ar(m-f)){var b=[];if(Ar(m-f)===Ar(i[1]-i[0])){x=m;var w=f+i[1]-i[0];b[0]=Math.min(w,(w+u)/2),b[1]=Math.max(w,(w+u)/2)}else{x=u;var j=m+i[1]-i[0];b[0]=Math.min(f,(j+f)/2),b[1]=Math.max(f,(j+f)/2)}var _=[Math.min(f,(x+f)/2),Math.max(f,(x+f)/2)];if(t>_[0]&&t<=_[1]||t>=b[0]&&t<=b[1]){({index:o}=n[d]);break}}else{var C=Math.min(u,m),k=Math.max(u,m);if(t>(C+f)/2&&t<=(k+f)/2){({index:o}=n[d]);break}}}else if(s){for(var A=0;A<c;A++)if(A===0&&t<=(s[A].coordinate+s[A+1].coordinate)/2||A>0&&A<c-1&&t>(s[A].coordinate+s[A-1].coordinate)/2&&t<=(s[A].coordinate+s[A+1].coordinate)/2||A===c-1&&t>(s[A].coordinate+s[A-1].coordinate)/2){({index:o}=s[A]);break}}return o},sTe=()=>_t(i5),$5=(t,s)=>s,gq=(t,s,n)=>n,z5=(t,s,n,a)=>a,nTe=Ae(qo,t=>gv(t,s=>s.coordinate)),U5=Ae([Wf,$5,gq,z5],sq),yq=Ae([U5,qf],O5),rTe=(t,s,n)=>{if(s!=null){var a=Wf(t);return s==="axis"?n==="hover"?a.axisInteraction.hover.dataKey:a.axisInteraction.click.dataKey:n==="hover"?a.itemInteraction.hover.dataKey:a.itemInteraction.click.dataKey}},bq=Ae([Wf,$5,gq,z5],rq),F1=Ae([zo,Uo,ds,tr,qo,z5,bq,qx],nq),aTe=Ae([U5,F1],(t,s)=>{var n;return(n=t.coordinate)!==null&&n!==void 0?n:s}),vq=Ae([qo,yq],QW),iTe=Ae([bq,yq,fd,EW,vq,qx,$5],aq),lTe=Ae([U5],t=>({isActive:t.active,activeIndex:t.index})),oTe=(t,s,n,a,i,l,o)=>{if(!(!t||!n||!a||!i)&&tTe(t,o)){var c=hSe(t,s),d=xq(c,l,i,n,a),u=JEe(s,i,d,t);return{activeIndex:String(d),activeCoordinate:u}}},cTe=(t,s,n,a,i,l,o)=>{if(!(!t||!a||!i||!l||!n)){var c=t3e(t,n);if(c){var d=fSe(c,s),u=xq(d,o,l,a,i),f=eTe(s,l,u,c);return{activeIndex:String(u),activeCoordinate:f}}}},dTe=(t,s,n,a,i,l,o,c)=>{if(!(!t||!s||!a||!i||!l))return s==="horizontal"||s==="vertical"?oTe(t,s,a,i,l,o,c):cTe(t,s,n,a,i,l,o)},uTe=Ae(t=>t.zIndex.zIndexMap,(t,s)=>s,(t,s,n)=>n,(t,s,n)=>{if(s!=null){var a=t[s];if(a!=null)return n?a.panoramaElementId:a.elementId}}),hTe=Ae(t=>t.zIndex.zIndexMap,t=>{var s=Object.keys(t).map(a=>parseInt(a,10)).concat(Object.values(zr)),n=Array.from(new Set(s));return n.sort((a,i)=>a-i)},{memoizeOptions:{resultEqualityCheck:e5e}});function _O(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function SO(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?_O(Object(n),!0).forEach(function(a){fTe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_O(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function fTe(t,s,n){return(s=mTe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function mTe(t){var s=pTe(t,"string");return typeof s=="symbol"?s:s+""}function pTe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var xTe={},gTe={zIndexMap:Object.values(zr).reduce((t,s)=>SO(SO({},t),{},{[s]:{elementId:void 0,panoramaElementId:void 0,consumers:0}}),xTe)},yTe=new Set(Object.values(zr));function bTe(t){return yTe.has(t)}var wq=Pa({name:"zIndex",initialState:gTe,reducers:{registerZIndexPortal:{reducer:(t,s)=>{var{zIndex:n}=s.payload;t.zIndexMap[n]?t.zIndexMap[n].consumers+=1:t.zIndexMap[n]={consumers:1,elementId:void 0,panoramaElementId:void 0}},prepare:Gn()},unregisterZIndexPortal:{reducer:(t,s)=>{var{zIndex:n}=s.payload;t.zIndexMap[n]&&(t.zIndexMap[n].consumers-=1,t.zIndexMap[n].consumers<=0&&!bTe(n)&&delete t.zIndexMap[n])},prepare:Gn()},registerZIndexPortalId:{reducer:(t,s)=>{var{zIndex:n,elementId:a,isPanorama:i}=s.payload;t.zIndexMap[n]?i?t.zIndexMap[n].panoramaElementId=a:t.zIndexMap[n].elementId=a:t.zIndexMap[n]={consumers:0,elementId:i?void 0:a,panoramaElementId:i?a:void 0}},prepare:Gn()},unregisterZIndexPortalId:{reducer:(t,s)=>{var{zIndex:n}=s.payload;t.zIndexMap[n]&&(s.payload.isPanorama?t.zIndexMap[n].panoramaElementId=void 0:t.zIndexMap[n].elementId=void 0)},prepare:Gn()}}}),{registerZIndexPortal:vTe,unregisterZIndexPortal:wTe,registerZIndexPortalId:NTe,unregisterZIndexPortalId:jTe}=wq.actions,_Te=wq.reducer;function eo(t){var{zIndex:s,children:n}=t,a=USe(),i=a&&s!==void 0&&s!==0,l=ri(),o=Ys();y.useLayoutEffect(()=>i?(o(vTe({zIndex:s})),()=>{o(wTe({zIndex:s}))}):Lu,[o,s,i]);var c=_t(u=>uTe(u,s,l));if(!i)return n;if(!c)return null;var d=document.getElementById(c);return d?td.createPortal(n,d):null}function nC(){return nC=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},nC.apply(null,arguments)}function CO(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function ug(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?CO(Object(n),!0).forEach(function(a){STe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):CO(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function STe(t,s,n){return(s=CTe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function CTe(t){var s=kTe(t,"string");return typeof s=="symbol"?s:s+""}function kTe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function ATe(t){var{cursor:s,cursorComp:n,cursorProps:a}=t;return y.isValidElement(s)?y.cloneElement(s,a):y.createElement(n,a)}function ETe(t){var s,{coordinate:n,payload:a,index:i,offset:l,tooltipAxisBandSize:o,layout:c,cursor:d,tooltipEventType:u,chartName:f}=t,m=n,x=a,b=i;if(!d||!m||f!=="ScatterChart"&&u!=="axis")return null;var w,j,_;if(f==="ScatterChart")w=m,j=gCe,_=zr.cursorLine;else if(f==="BarChart")w=yCe(c,m,l,o),j=dH,_=zr.cursorRectangle;else if(c==="radial"&&KU(m)){var{cx:C,cy:k,radius:A,startAngle:T,endAngle:P}=hH(m);w={cx:C,cy:k,startAngle:T,endAngle:P,innerRadius:A,outerRadius:A},j=mH,_=zr.cursorLine}else w={points:a3e(c,m,l)},j=IA,_=zr.cursorLine;var R=typeof d=="object"&&"className"in d?d.className:void 0,I=ug(ug(ug(ug({stroke:"#ccc",pointerEvents:"none"},l),w),Zp(d)),{},{payload:x,payloadIndex:b,className:ms("recharts-tooltip-cursor",R)});return y.createElement(eo,{zIndex:(s=t.zIndex)!==null&&s!==void 0?s:_},y.createElement(ATe,{cursor:d,cursorComp:j,cursorProps:I}))}function TTe(t){var s=YEe(),n=FSe(),a=Ev(),i=sTe();return s==null||n==null||a==null||i==null?null:y.createElement(ETe,nC({},t,{offset:n,layout:a,tooltipAxisBandSize:s,chartName:i}))}var Nq=y.createContext(null),PTe=()=>y.useContext(Nq),jq={exports:{}};(function(t){var s=Object.prototype.hasOwnProperty,n="~";function a(){}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(n=!1));function i(d,u,f){this.fn=d,this.context=u,this.once=f||!1}function l(d,u,f,m,x){if(typeof f!="function")throw new TypeError("The listener must be a function");var b=new i(f,m||d,x),w=n?n+u:u;return d._events[w]?d._events[w].fn?d._events[w]=[d._events[w],b]:d._events[w].push(b):(d._events[w]=b,d._eventsCount++),d}function o(d,u){--d._eventsCount===0?d._events=new a:delete d._events[u]}function c(){this._events=new a,this._eventsCount=0}c.prototype.eventNames=function(){var u=[],f,m;if(this._eventsCount===0)return u;for(m in f=this._events)s.call(f,m)&&u.push(n?m.slice(1):m);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(f)):u},c.prototype.listeners=function(u){var f=n?n+u:u,m=this._events[f];if(!m)return[];if(m.fn)return[m.fn];for(var x=0,b=m.length,w=new Array(b);x<b;x++)w[x]=m[x].fn;return w},c.prototype.listenerCount=function(u){var f=n?n+u:u,m=this._events[f];return m?m.fn?1:m.length:0},c.prototype.emit=function(u,f,m,x,b,w){var j=n?n+u:u;if(!this._events[j])return!1;var _=this._events[j],C=arguments.length,k,A;if(_.fn){switch(_.once&&this.removeListener(u,_.fn,void 0,!0),C){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,f),!0;case 3:return _.fn.call(_.context,f,m),!0;case 4:return _.fn.call(_.context,f,m,x),!0;case 5:return _.fn.call(_.context,f,m,x,b),!0;case 6:return _.fn.call(_.context,f,m,x,b,w),!0}for(A=1,k=new Array(C-1);A<C;A++)k[A-1]=arguments[A];_.fn.apply(_.context,k)}else{var T=_.length,P;for(A=0;A<T;A++)switch(_[A].once&&this.removeListener(u,_[A].fn,void 0,!0),C){case 1:_[A].fn.call(_[A].context);break;case 2:_[A].fn.call(_[A].context,f);break;case 3:_[A].fn.call(_[A].context,f,m);break;case 4:_[A].fn.call(_[A].context,f,m,x);break;default:if(!k)for(P=1,k=new Array(C-1);P<C;P++)k[P-1]=arguments[P];_[A].fn.apply(_[A].context,k)}}return!0},c.prototype.on=function(u,f,m){return l(this,u,f,m,!1)},c.prototype.once=function(u,f,m){return l(this,u,f,m,!0)},c.prototype.removeListener=function(u,f,m,x){var b=n?n+u:u;if(!this._events[b])return this;if(!f)return o(this,b),this;var w=this._events[b];if(w.fn)w.fn===f&&(!x||w.once)&&(!m||w.context===m)&&o(this,b);else{for(var j=0,_=[],C=w.length;j<C;j++)(w[j].fn!==f||x&&!w[j].once||m&&w[j].context!==m)&&_.push(w[j]);_.length?this._events[b]=_.length===1?_[0]:_:o(this,b)}return this},c.prototype.removeAllListeners=function(u){var f;return u?(f=n?n+u:u,this._events[f]&&o(this,f)):(this._events=new a,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=n,c.EventEmitter=c,t.exports=c})(jq);var ITe=jq.exports;const MTe=Mi(ITe);var cx=new MTe,rC="recharts.syncEvent.tooltip",kO="recharts.syncEvent.brush";function _q(t,s){if(s){var n=Number.parseInt(s,10);if(!Gl(n))return t==null?void 0:t[n]}}var DTe={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},Sq=Pa({name:"options",initialState:DTe,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),OTe=Sq.reducer,{createEventEmitter:RTe}=Sq.actions;function LTe(t){return t.tooltip.syncInteraction}var BTe={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},Cq=Pa({name:"chartData",initialState:BTe,reducers:{setChartData(t,s){if(t.chartData=s.payload,s.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}s.payload.length>0&&t.dataEndIndex!==s.payload.length-1&&(t.dataEndIndex=s.payload.length-1)},setComputedData(t,s){t.computedData=s.payload},setDataStartEndIndexes(t,s){var{startIndex:n,endIndex:a}=s.payload;n!=null&&(t.dataStartIndex=n),a!=null&&(t.dataEndIndex=a)}}}),{setChartData:AO,setDataStartEndIndexes:FTe,setComputedData:z9e}=Cq.actions,$Te=Cq.reducer,zTe=["x","y"];function EO(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function sh(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?EO(Object(n),!0).forEach(function(a){UTe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):EO(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function UTe(t,s,n){return(s=VTe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function VTe(t){var s=HTe(t,"string");return typeof s=="symbol"?s:s+""}function HTe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function WTe(t,s){if(t==null)return{};var n,a,i=qTe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function qTe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}function GTe(){var t=_t(l5),s=_t(o5),n=Ys(),a=_t(xW),i=_t(qo),l=Ev(),o=Av(),c=_t(d=>d.rootProps.className);y.useEffect(()=>{if(t==null)return Lu;var d=(u,f,m)=>{if(s!==m&&t===u){if(a==="index"){var x;if(o&&f!==null&&f!==void 0&&(x=f.payload)!==null&&x!==void 0&&x.coordinate&&f.payload.sourceViewBox){var b=f.payload.coordinate,{x:w,y:j}=b,_=WTe(b,zTe),{x:C,y:k,width:A,height:T}=f.payload.sourceViewBox,P=sh(sh({},_),{},{x:o.x+(A?(w-C)/A:0)*o.width,y:o.y+(T?(j-k)/T:0)*o.height});n(sh(sh({},f),{},{payload:sh(sh({},f.payload),{},{coordinate:P})}))}else n(f);return}if(i!=null){var R;if(typeof a=="function"){var I={activeTooltipIndex:f.payload.index==null?void 0:Number(f.payload.index),isTooltipActive:f.payload.active,activeIndex:f.payload.index==null?void 0:Number(f.payload.index),activeLabel:f.payload.label,activeDataKey:f.payload.dataKey,activeCoordinate:f.payload.coordinate},O=a(i,I);R=i[O]}else a==="value"&&(R=i.find(W=>String(W.value)===f.payload.label));var{coordinate:M}=f.payload;if(R==null||f.payload.active===!1||M==null||o==null){n(tC({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0}));return}var{x:B,y:L}=M,F=Math.min(B,o.x+o.width),V=Math.min(L,o.y+o.height),U={x:l==="horizontal"?R.coordinate:F,y:l==="horizontal"?V:R.coordinate},z=tC({active:f.payload.active,coordinate:U,dataKey:f.payload.dataKey,index:String(R.index),label:f.payload.label,sourceViewBox:f.payload.sourceViewBox});n(z)}}};return cx.on(rC,d),()=>{cx.off(rC,d)}},[c,n,s,t,a,i,l,o])}function KTe(){var t=_t(l5),s=_t(o5),n=Ys();y.useEffect(()=>{if(t==null)return Lu;var a=(i,l,o)=>{s!==o&&t===i&&n(FTe(l))};return cx.on(kO,a),()=>{cx.off(kO,a)}},[n,s,t])}function YTe(){var t=Ys();y.useEffect(()=>{t(RTe())},[t]),GTe(),KTe()}function XTe(t,s,n,a,i,l){var o=_t(b=>rTe(b,t,s)),c=_t(o5),d=_t(l5),u=_t(xW),f=_t(LTe),m=f==null?void 0:f.active,x=Av();y.useEffect(()=>{if(!m&&d!=null&&c!=null){var b=tC({active:l,coordinate:n,dataKey:o,index:i,label:typeof a=="number"?String(a):a,sourceViewBox:x});cx.emit(rC,d,b,c)}},[m,n,o,i,a,c,d,u,l,x])}function TO(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function PO(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?TO(Object(n),!0).forEach(function(a){QTe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):TO(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function QTe(t,s,n){return(s=ZTe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function ZTe(t){var s=JTe(t,"string");return typeof s=="symbol"?s:s+""}function JTe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function e4e(t){return t.dataKey}function t4e(t,s){return y.isValidElement(t)?y.cloneElement(t,s):typeof t=="function"?y.createElement(t,s):y.createElement(YSe,s)}var IO=[],s4e={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Fu.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Wd(t){var s,n,a=ca(t,s4e),{active:i,allowEscapeViewBox:l,animationDuration:o,animationEasing:c,content:d,filterNull:u,isAnimationActive:f,offset:m,payloadUniqBy:x,position:b,reverseDirection:w,useTranslate3d:j,wrapperStyle:_,cursor:C,shared:k,trigger:A,defaultIndex:T,portal:P,axisId:R}=a,I=Ys(),O=typeof T=="number"?String(T):T;y.useEffect(()=>{I(nEe({shared:k,trigger:A,axisId:R,active:i,defaultIndex:O}))},[I,k,A,R,i,O]);var M=Av(),B=aH(),L=Z5e(k),{activeIndex:F,isActive:V}=(s=_t(oe=>lTe(oe,L,A,O)))!==null&&s!==void 0?s:{},U=_t(oe=>iTe(oe,L,A,O)),z=_t(oe=>vq(oe,L,A,O)),W=_t(oe=>aTe(oe,L,A,O)),q=U,G=PTe(),se=(n=i??V)!==null&&n!==void 0?n:!1,[ge,ke]=e_e([q,se]),ee=L==="axis"?z:void 0;XTe(L,A,W,ee,F,se);var pe=P??G;if(pe==null||M==null||L==null)return null;var ue=q??IO;se||(ue=IO),u&&ue.length&&(ue=L2e(ue.filter(oe=>oe.value!=null&&(oe.hide!==!0||a.includeHidden)),x,e4e));var ye=ue.length>0,X=y.createElement(sCe,{allowEscapeViewBox:l,animationDuration:o,animationEasing:c,isAnimationActive:f,active:se,coordinate:W,hasPayload:ye,offset:m,position:b,reverseDirection:w,useTranslate3d:j,viewBox:M,wrapperStyle:_,lastBoundingBox:ge,innerRef:ke,hasPortalFromProps:!!P},t4e(d,PO(PO({},a),{},{payload:ue,label:ee,active:se,activeIndex:F,coordinate:W,accessibilityLayer:B})));return y.createElement(y.Fragment,null,td.createPortal(X,pe),se&&y.createElement(TTe,{cursor:C,tooltipEventType:L,coordinate:W,payload:ue,index:F}))}var Dl=t=>null;Dl.displayName="Cell";function n4e(t,s,n){return(s=r4e(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function r4e(t){var s=a4e(t,"string");return typeof s=="symbol"?s:s+""}function a4e(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}class i4e{constructor(s){n4e(this,"cache",new Map),this.maxSize=s}get(s){var n=this.cache.get(s);return n!==void 0&&(this.cache.delete(s),this.cache.set(s,n)),n}set(s,n){if(this.cache.has(s))this.cache.delete(s);else if(this.cache.size>=this.maxSize){var a=this.cache.keys().next().value;this.cache.delete(a)}this.cache.set(s,n)}clear(){this.cache.clear()}size(){return this.cache.size}}function MO(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function l4e(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?MO(Object(n),!0).forEach(function(a){o4e(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):MO(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function o4e(t,s,n){return(s=c4e(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function c4e(t){var s=d4e(t,"string");return typeof s=="symbol"?s:s+""}function d4e(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var u4e={cacheSize:2e3,enableCache:!0},kq=l4e({},u4e),DO=new i4e(kq.cacheSize),h4e={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},OO="recharts_measurement_span";function f4e(t,s){var n=s.fontSize||"",a=s.fontFamily||"",i=s.fontWeight||"",l=s.fontStyle||"",o=s.letterSpacing||"",c=s.textTransform||"";return"".concat(t,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(l,"|").concat(o,"|").concat(c)}var RO=(t,s)=>{try{var n=document.getElementById(OO);n||(n=document.createElement("span"),n.setAttribute("id",OO),n.setAttribute("aria-hidden","true"),document.body.appendChild(n)),Object.assign(n.style,h4e,s),n.textContent="".concat(t);var a=n.getBoundingClientRect();return{width:a.width,height:a.height}}catch{return{width:0,height:0}}},op=function(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(s==null||Fu.isSsr)return{width:0,height:0};if(!kq.enableCache)return RO(s,n);var a=f4e(s,n),i=DO.get(a);if(i)return i;var l=RO(s,n);return DO.set(a,l),l},LO=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,BO=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,m4e=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,p4e=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Aq={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},x4e=Object.keys(Aq),Ch="NaN";function g4e(t,s){return t*Aq[s]}class ma{static parse(s){var n,[,a,i]=(n=p4e.exec(s))!==null&&n!==void 0?n:[];return new ma(parseFloat(a),i??"")}constructor(s,n){this.num=s,this.unit=n,this.num=s,this.unit=n,Gl(s)&&(this.unit=""),n!==""&&!m4e.test(n)&&(this.num=NaN,this.unit=""),x4e.includes(n)&&(this.num=g4e(s,n),this.unit="px")}add(s){return this.unit!==s.unit?new ma(NaN,""):new ma(this.num+s.num,this.unit)}subtract(s){return this.unit!==s.unit?new ma(NaN,""):new ma(this.num-s.num,this.unit)}multiply(s){return this.unit!==""&&s.unit!==""&&this.unit!==s.unit?new ma(NaN,""):new ma(this.num*s.num,this.unit||s.unit)}divide(s){return this.unit!==""&&s.unit!==""&&this.unit!==s.unit?new ma(NaN,""):new ma(this.num/s.num,this.unit||s.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Gl(this.num)}}function Eq(t){if(t.includes(Ch))return Ch;for(var s=t;s.includes("*")||s.includes("/");){var n,[,a,i,l]=(n=LO.exec(s))!==null&&n!==void 0?n:[],o=ma.parse(a??""),c=ma.parse(l??""),d=i==="*"?o.multiply(c):o.divide(c);if(d.isNaN())return Ch;s=s.replace(LO,d.toString())}for(;s.includes("+")||/.-\d+(?:\.\d+)?/.test(s);){var u,[,f,m,x]=(u=BO.exec(s))!==null&&u!==void 0?u:[],b=ma.parse(f??""),w=ma.parse(x??""),j=m==="+"?b.add(w):b.subtract(w);if(j.isNaN())return Ch;s=s.replace(BO,j.toString())}return s}var FO=/\(([^()]*)\)/;function y4e(t){for(var s=t,n;(n=FO.exec(s))!=null;){var[,a]=n;s=s.replace(FO,Eq(a))}return s}function b4e(t){var s=t.replace(/\s+/g,"");return s=y4e(s),s=Eq(s),s}function v4e(t){try{return b4e(t)}catch{return Ch}}function Mj(t){var s=v4e(t.slice(5,-1));return s===Ch?"":s}var w4e=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],N4e=["dx","dy","angle","className","breakAll"];function aC(){return aC=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},aC.apply(null,arguments)}function $O(t,s){if(t==null)return{};var n,a,i=j4e(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function j4e(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}var Tq=/[ \f\n\r\t\v\u2028\u2029]+/,Pq=t=>{var{children:s,breakAll:n,style:a}=t;try{var i=[];fr(s)||(n?i=s.toString().split(""):i=s.toString().split(Tq));var l=i.map(c=>({word:c,width:op(c,a).width})),o=n?0:op("",a).width;return{wordsWithComputedWidth:l,spaceWidth:o}}catch{return null}};function _4e(t){return t==="start"||t==="middle"||t==="end"||t==="inherit"}var Iq=(t,s,n,a)=>t.reduce((i,l)=>{var{word:o,width:c}=l,d=i[i.length-1];if(d&&c!=null&&(s==null||a||d.width+c+n<Number(s)))d.words.push(o),d.width+=c+n;else{var u={words:[o],width:c};i.push(u)}return i},[]),Mq=t=>t.reduce((s,n)=>s.width>n.width?s:n),S4e="",zO=(t,s,n,a,i,l,o,c)=>{var d=t.slice(0,s),u=Pq({breakAll:n,style:a,children:d+S4e});if(!u)return[!1,[]];var f=Iq(u.wordsWithComputedWidth,l,o,c),m=f.length>i||Mq(f).width>Number(l);return[m,f]},C4e=(t,s,n,a,i)=>{var{maxLines:l,children:o,style:c,breakAll:d}=t,u=Et(l),f=String(o),m=Iq(s,a,n,i);if(!u||i)return m;var x=m.length>l||Mq(m).width>Number(a);if(!x)return m;for(var b=0,w=f.length-1,j=0,_;b<=w&&j<=f.length-1;){var C=Math.floor((b+w)/2),k=C-1,[A,T]=zO(f,k,d,c,l,a,n,i),[P]=zO(f,C,d,c,l,a,n,i);if(!A&&!P&&(b=C+1),A&&P&&(w=C-1),!A&&P){_=T;break}j++}return _||m},UO=t=>{var s=fr(t)?[]:t.toString().split(Tq);return[{words:s,width:void 0}]},k4e=t=>{var{width:s,scaleToFit:n,children:a,style:i,breakAll:l,maxLines:o}=t;if((s||n)&&!Fu.isSsr){var c,d,u=Pq({breakAll:l,children:a,style:i});if(u){var{wordsWithComputedWidth:f,spaceWidth:m}=u;c=f,d=m}else return UO(a);return C4e({breakAll:l,children:a,maxLines:o,style:i},c,d,s,!!n)}return UO(a)},Dq="#808080",A4e={breakAll:!1,capHeight:"0.71em",fill:Dq,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},Xv=y.forwardRef((t,s)=>{var n=ca(t,A4e),{x:a,y:i,lineHeight:l,capHeight:o,fill:c,scaleToFit:d,textAnchor:u,verticalAnchor:f}=n,m=$O(n,w4e),x=y.useMemo(()=>k4e({breakAll:m.breakAll,children:m.children,maxLines:m.maxLines,scaleToFit:d,style:m.style,width:m.width}),[m.breakAll,m.children,m.maxLines,d,m.style,m.width]),{dx:b,dy:w,angle:j,className:_,breakAll:C}=m,k=$O(m,N4e);if(!Kl(a)||!Kl(i)||x.length===0)return null;var A=Number(a)+(Et(b)?b:0),T=Number(i)+(Et(w)?w:0);if(!Cn(A)||!Cn(T))return null;var P;switch(f){case"start":P=Mj("calc(".concat(o,")"));break;case"middle":P=Mj("calc(".concat((x.length-1)/2," * -").concat(l," + (").concat(o," / 2))"));break;default:P=Mj("calc(".concat(x.length-1," * -").concat(l,")"));break}var R=[];if(d){var I=x[0].width,{width:O}=m;R.push("scale(".concat(Et(O)&&Et(I)?O/I:1,")"))}return j&&R.push("rotate(".concat(j,", ").concat(A,", ").concat(T,")")),R.length&&(k.transform=R.join(" ")),y.createElement("text",aC({},Ti(k),{ref:s,x:A,y:T,className:ms("recharts-text",_),textAnchor:u,fill:c.includes("url")?Dq:c}),x.map((M,B)=>{var L=M.words.join(C?"":" ");return y.createElement("tspan",{x:A,dy:B===0?P:l,key:"".concat(L,"-").concat(B)},L)}))});Xv.displayName="Text";var E4e=["labelRef"];function T4e(t,s){if(t==null)return{};var n,a,i=P4e(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function P4e(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}function VO(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function wn(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?VO(Object(n),!0).forEach(function(a){I4e(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):VO(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function I4e(t,s,n){return(s=M4e(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function M4e(t){var s=D4e(t,"string");return typeof s=="symbol"?s:s+""}function D4e(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function ho(){return ho=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},ho.apply(null,arguments)}var Oq=y.createContext(null),O4e=t=>{var{x:s,y:n,upperWidth:a,lowerWidth:i,width:l,height:o,children:c}=t,d=y.useMemo(()=>({x:s,y:n,upperWidth:a,lowerWidth:i,width:l,height:o}),[s,n,a,i,l,o]);return y.createElement(Oq.Provider,{value:d},c)},Rq=()=>{var t=y.useContext(Oq),s=Av();return t||tH(s)},R4e=y.createContext(null),L4e=()=>{var t=y.useContext(R4e),s=_t(wW);return t||s},B4e=t=>{var{value:s,formatter:n}=t,a=fr(t.children)?s:t.children;return typeof n=="function"?n(a):a},V5=t=>t!=null&&typeof t=="function",F4e=(t,s)=>{var n=Ar(s-t),a=Math.min(Math.abs(s-t),360);return n*a},$4e=(t,s,n,a,i)=>{var{offset:l,className:o}=t,{cx:c,cy:d,innerRadius:u,outerRadius:f,startAngle:m,endAngle:x,clockWise:b}=i,w=(u+f)/2,j=F4e(m,x),_=j>=0?1:-1,C,k;switch(s){case"insideStart":C=m+_*l,k=b;break;case"insideEnd":C=x-_*l,k=!b;break;case"end":C=x+_*l,k=b;break;default:throw new Error("Unsupported position ".concat(s))}k=j<=0?k:!k;var A=On(c,d,w,C),T=On(c,d,w,C+(k?1:-1)*359),P="M".concat(A.x,",").concat(A.y,`
    A`).concat(w,",").concat(w,",0,1,").concat(k?0:1,`,
    `).concat(T.x,",").concat(T.y),R=fr(t.id)?Jp("recharts-radial-line-"):t.id;return y.createElement("text",ho({},a,{dominantBaseline:"central",className:ms("recharts-radial-bar-label",o)}),y.createElement("defs",null,y.createElement("path",{id:R,d:P})),y.createElement("textPath",{xlinkHref:"#".concat(R)},n))},z4e=(t,s,n)=>{var{cx:a,cy:i,innerRadius:l,outerRadius:o,startAngle:c,endAngle:d}=t,u=(c+d)/2;if(n==="outside"){var{x:f,y:m}=On(a,i,o+s,u);return{x:f,y:m,textAnchor:f>=a?"start":"end",verticalAnchor:"middle"}}if(n==="center")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(n==="centerTop")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"start"};if(n==="centerBottom")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"end"};var x=(l+o)/2,{x:b,y:w}=On(a,i,x,u);return{x:b,y:w,textAnchor:"middle",verticalAnchor:"middle"}},iC=t=>"cx"in t&&Et(t.cx),U4e=(t,s)=>{var{parentViewBox:n,offset:a,position:i}=t,l;n!=null&&!iC(n)&&(l=n);var{x:o,y:c,upperWidth:d,lowerWidth:u,height:f}=s,m=o,x=o+(d-u)/2,b=(m+x)/2,w=(d+u)/2,j=m+d/2,_=f>=0?1:-1,C=_*a,k=_>0?"end":"start",A=_>0?"start":"end",T=d>=0?1:-1,P=T*a,R=T>0?"end":"start",I=T>0?"start":"end";if(i==="top"){var O={x:m+d/2,y:c-C,textAnchor:"middle",verticalAnchor:k};return wn(wn({},O),l?{height:Math.max(c-l.y,0),width:d}:{})}if(i==="bottom"){var M={x:x+u/2,y:c+f+C,textAnchor:"middle",verticalAnchor:A};return wn(wn({},M),l?{height:Math.max(l.y+l.height-(c+f),0),width:u}:{})}if(i==="left"){var B={x:b-P,y:c+f/2,textAnchor:R,verticalAnchor:"middle"};return wn(wn({},B),l?{width:Math.max(B.x-l.x,0),height:f}:{})}if(i==="right"){var L={x:b+w+P,y:c+f/2,textAnchor:I,verticalAnchor:"middle"};return wn(wn({},L),l?{width:Math.max(l.x+l.width-L.x,0),height:f}:{})}var F=l?{width:w,height:f}:{};return i==="insideLeft"?wn({x:b+P,y:c+f/2,textAnchor:I,verticalAnchor:"middle"},F):i==="insideRight"?wn({x:b+w-P,y:c+f/2,textAnchor:R,verticalAnchor:"middle"},F):i==="insideTop"?wn({x:m+d/2,y:c+C,textAnchor:"middle",verticalAnchor:A},F):i==="insideBottom"?wn({x:x+u/2,y:c+f-C,textAnchor:"middle",verticalAnchor:k},F):i==="insideTopLeft"?wn({x:m+P,y:c+C,textAnchor:I,verticalAnchor:A},F):i==="insideTopRight"?wn({x:m+d-P,y:c+C,textAnchor:R,verticalAnchor:A},F):i==="insideBottomLeft"?wn({x:x+P,y:c+f-C,textAnchor:I,verticalAnchor:k},F):i==="insideBottomRight"?wn({x:x+u-P,y:c+f-C,textAnchor:R,verticalAnchor:k},F):i&&typeof i=="object"&&(Et(i.x)||To(i.x))&&(Et(i.y)||To(i.y))?wn({x:o+Hr(i.x,w),y:c+Hr(i.y,f),textAnchor:"end",verticalAnchor:"end"},F):wn({x:j,y:c+f/2,textAnchor:"middle",verticalAnchor:"middle"},F)},V4e={offset:5,zIndex:zr.label};function hc(t){var s=ca(t,V4e),{viewBox:n,position:a,value:i,children:l,content:o,className:c="",textBreakAll:d,labelRef:u}=s,f=L4e(),m=Rq(),x=a==="center"?m:f??m,b,w,j;if(n==null?b=x:iC(n)?b=n:b=tH(n),!b||fr(i)&&fr(l)&&!y.isValidElement(o)&&typeof o!="function")return null;var _=wn(wn({},s),{},{viewBox:b});if(y.isValidElement(o)){var{labelRef:C}=_,k=T4e(_,E4e);return y.cloneElement(o,k)}if(typeof o=="function"){if(w=y.createElement(o,_),y.isValidElement(w))return w}else w=B4e(s);var A=Ti(s);if(iC(b)){if(a==="insideStart"||a==="insideEnd"||a==="end")return $4e(s,a,w,A,b);j=z4e(b,s.offset,s.position)}else j=U4e(s,b);return y.createElement(eo,{zIndex:s.zIndex},y.createElement(Xv,ho({ref:u,className:ms("recharts-label",c)},A,j,{textAnchor:_4e(A.textAnchor)?A.textAnchor:j.textAnchor,breakAll:d}),w))}hc.displayName="Label";var H4e=(t,s,n)=>{if(!t)return null;var a={viewBox:s,labelRef:n};return t===!0?y.createElement(hc,ho({key:"label-implicit"},a)):Kl(t)?y.createElement(hc,ho({key:"label-implicit",value:t},a)):y.isValidElement(t)?t.type===hc?y.cloneElement(t,wn({key:"label-implicit"},a)):y.createElement(hc,ho({key:"label-implicit",content:t},a)):V5(t)?y.createElement(hc,ho({key:"label-implicit",content:t},a)):t&&typeof t=="object"?y.createElement(hc,ho({},t,{key:"label-implicit"},a)):null};function W4e(t){var{label:s,labelRef:n}=t,a=Rq();return H4e(s,a,n)||null}var Lq={},Bq={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){return n[n.length-1]}t.last=s})(Bq);var Fq={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){return Array.isArray(n)?n:Array.from(n)}t.toArray=s})(Fq);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=Bq,n=Fq,a=xv;function i(l){if(a.isArrayLike(l))return s.last(n.toArray(l))}t.last=i})(Lq);var q4e=Lq.last;const G4e=Mi(q4e);var K4e=["valueAccessor"],Y4e=["dataKey","clockWise","id","textBreakAll","zIndex"];function $1(){return $1=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},$1.apply(null,arguments)}function HO(t,s){if(t==null)return{};var n,a,i=X4e(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function X4e(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}var Q4e=t=>Array.isArray(t.value)?G4e(t.value):t.value,$q=y.createContext(void 0),Z4e=$q.Provider,zq=y.createContext(void 0),J4e=zq.Provider;function ePe(){return y.useContext($q)}function tPe(){return y.useContext(zq)}function Jg(t){var{valueAccessor:s=Q4e}=t,n=HO(t,K4e),{dataKey:a,clockWise:i,id:l,textBreakAll:o,zIndex:c}=n,d=HO(n,Y4e),u=ePe(),f=tPe(),m=u||f;return!m||!m.length?null:y.createElement(eo,{zIndex:c??zr.label},y.createElement(ia,{className:"recharts-label-list"},m.map((x,b)=>{var w,j=fr(a)?s(x,b):nn(x&&x.payload,a),_=fr(l)?{}:{id:"".concat(l,"-").concat(b)};return y.createElement(hc,$1({key:"label-".concat(b)},Ti(x),d,_,{fill:(w=n.fill)!==null&&w!==void 0?w:x.fill,parentViewBox:x.parentViewBox,value:j,textBreakAll:o,viewBox:x.viewBox,index:b,zIndex:0}))})))}Jg.displayName="LabelList";function Uq(t){var{label:s}=t;return s?s===!0?y.createElement(Jg,{key:"labelList-implicit"}):y.isValidElement(s)||V5(s)?y.createElement(Jg,{key:"labelList-implicit",content:s}):typeof s=="object"?y.createElement(Jg,$1({key:"labelList-implicit"},s,{type:String(s.type)})):null:null}var Vq=t=>t.graphicalItems.polarItems,sPe=Ae([Xs,Ux],m5),Qv=Ae([Vq,cn,sPe],x5),nPe=Ae([Qv],g5),Zv=Ae([nPe,s5],y5),rPe=Ae([Zv,cn,Qv],v5);Ae([Zv,cn,Qv],(t,s,n)=>n.length>0?t.flatMap(a=>n.flatMap(i=>{var l,o=nn(a,(l=s.dataKey)!==null&&l!==void 0?l:i.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):(s==null?void 0:s.dataKey)!=null?t.map(a=>({value:nn(a,s.dataKey),errorDomain:[]})):t.map(a=>({value:a,errorDomain:[]})));var WO=()=>{},aPe=Ae([Zv,cn,Qv,qv,Xs],_5),iPe=Ae([cn,N5,j5,WO,aPe,WO,ds,Xs],S5),Hq=Ae([cn,ds,Zv,rPe,zx,Xs,iPe],C5),lPe=Ae([Hq,cn,Vf],E5);Ae([cn,Hq,lPe,Xs],P5);var oPe={radiusAxis:{},angleAxis:{}},Wq=Pa({name:"polarAxis",initialState:oPe,reducers:{addRadiusAxis(t,s){t.radiusAxis[s.payload.id]=s.payload},removeRadiusAxis(t,s){delete t.radiusAxis[s.payload.id]},addAngleAxis(t,s){t.angleAxis[s.payload.id]=s.payload},removeAngleAxis(t,s){delete t.angleAxis[s.payload.id]}}}),{addRadiusAxis:U9e,removeRadiusAxis:V9e,addAngleAxis:H9e,removeAngleAxis:W9e}=Wq.actions,cPe=Wq.reducer;function qO(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function GO(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?qO(Object(n),!0).forEach(function(a){dPe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qO(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function dPe(t,s,n){return(s=uPe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function uPe(t){var s=hPe(t,"string");return typeof s=="symbol"?s:s+""}function hPe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var fPe=(t,s)=>s,H5=Ae([Vq,fPe],(t,s)=>t.filter(n=>n.type==="pie").find(n=>n.id===s)),mPe=[],W5=(t,s,n)=>(n==null?void 0:n.length)===0?mPe:n,qq=Ae([s5,H5,W5],(t,s,n)=>{var{chartData:a}=t;if(s!=null){var i;if((s==null?void 0:s.data)!=null&&s.data.length>0?i=s.data:i=a,(!i||!i.length)&&n!=null&&(i=n.map(l=>GO(GO({},s.presentationProps),l.props))),i!=null)return i}}),pPe=Ae([qq,H5,W5],(t,s,n)=>{if(!(t==null||s==null))return t.map((a,i)=>{var l,o=nn(a,s.nameKey,s.name),c;return n!=null&&(l=n[i])!==null&&l!==void 0&&(l=l.props)!==null&&l!==void 0&&l.fill?c=n[i].props.fill:typeof a=="object"&&a!=null&&"fill"in a?c=a.fill:c=s.fill,{value:jv(o,s.dataKey),color:c,payload:a,type:s.legendType}})}),xPe=Ae([qq,H5,W5,tr],(t,s,n,a)=>{if(!(s==null||t==null))return yIe({offset:a,pieSettings:s,displayedData:t,cells:n})}),Gq={exports:{}},bs={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xr=typeof Symbol=="function"&&Symbol.for,q5=xr?Symbol.for("react.element"):60103,G5=xr?Symbol.for("react.portal"):60106,Jv=xr?Symbol.for("react.fragment"):60107,ew=xr?Symbol.for("react.strict_mode"):60108,tw=xr?Symbol.for("react.profiler"):60114,sw=xr?Symbol.for("react.provider"):60109,nw=xr?Symbol.for("react.context"):60110,K5=xr?Symbol.for("react.async_mode"):60111,rw=xr?Symbol.for("react.concurrent_mode"):60111,aw=xr?Symbol.for("react.forward_ref"):60112,iw=xr?Symbol.for("react.suspense"):60113,gPe=xr?Symbol.for("react.suspense_list"):60120,lw=xr?Symbol.for("react.memo"):60115,ow=xr?Symbol.for("react.lazy"):60116,yPe=xr?Symbol.for("react.block"):60121,bPe=xr?Symbol.for("react.fundamental"):60117,vPe=xr?Symbol.for("react.responder"):60118,wPe=xr?Symbol.for("react.scope"):60119;function ai(t){if(typeof t=="object"&&t!==null){var s=t.$$typeof;switch(s){case q5:switch(t=t.type,t){case K5:case rw:case Jv:case tw:case ew:case iw:return t;default:switch(t=t&&t.$$typeof,t){case nw:case aw:case ow:case lw:case sw:return t;default:return s}}case G5:return s}}}function Kq(t){return ai(t)===rw}bs.AsyncMode=K5;bs.ConcurrentMode=rw;bs.ContextConsumer=nw;bs.ContextProvider=sw;bs.Element=q5;bs.ForwardRef=aw;bs.Fragment=Jv;bs.Lazy=ow;bs.Memo=lw;bs.Portal=G5;bs.Profiler=tw;bs.StrictMode=ew;bs.Suspense=iw;bs.isAsyncMode=function(t){return Kq(t)||ai(t)===K5};bs.isConcurrentMode=Kq;bs.isContextConsumer=function(t){return ai(t)===nw};bs.isContextProvider=function(t){return ai(t)===sw};bs.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===q5};bs.isForwardRef=function(t){return ai(t)===aw};bs.isFragment=function(t){return ai(t)===Jv};bs.isLazy=function(t){return ai(t)===ow};bs.isMemo=function(t){return ai(t)===lw};bs.isPortal=function(t){return ai(t)===G5};bs.isProfiler=function(t){return ai(t)===tw};bs.isStrictMode=function(t){return ai(t)===ew};bs.isSuspense=function(t){return ai(t)===iw};bs.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Jv||t===rw||t===tw||t===ew||t===iw||t===gPe||typeof t=="object"&&t!==null&&(t.$$typeof===ow||t.$$typeof===lw||t.$$typeof===sw||t.$$typeof===nw||t.$$typeof===aw||t.$$typeof===bPe||t.$$typeof===vPe||t.$$typeof===wPe||t.$$typeof===yPe)};bs.typeOf=ai;Gq.exports=bs;var NPe=Gq.exports,KO=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",YO=null,Dj=null,Yq=t=>{if(t===YO&&Array.isArray(Dj))return Dj;var s=[];return y.Children.forEach(t,n=>{fr(n)||(NPe.isFragment(n)?s=s.concat(Yq(n.props.children)):s.push(n))}),Dj=s,YO=t,s};function Y5(t,s){var n=[],a=[];return Array.isArray(s)?a=s.map(i=>KO(i)):a=[KO(s)],Yq(t).forEach(i=>{var l=wu(i,"type.displayName")||wu(i,"type.name");l&&a.indexOf(l)!==-1&&n.push(i)}),n}var Xq={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){var i;if(typeof n!="object"||n==null)return!1;if(Object.getPrototypeOf(n)===null)return!0;if(Object.prototype.toString.call(n)!=="[object Object]"){const l=n[Symbol.toStringTag];return l==null||!((i=Object.getOwnPropertyDescriptor(n,Symbol.toStringTag))!=null&&i.writable)?!1:n.toString()===`[object ${l}]`}let a=n;for(;Object.getPrototypeOf(a)!==null;)a=Object.getPrototypeOf(a);return Object.getPrototypeOf(n)===a}t.isPlainObject=s})(Xq);var jPe=Xq.isPlainObject;const _Pe=Mi(jPe);function XO(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function QO(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?XO(Object(n),!0).forEach(function(a){SPe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):XO(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function SPe(t,s,n){return(s=CPe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function CPe(t){var s=kPe(t,"string");return typeof s=="symbol"?s:s+""}function kPe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function z1(){return z1=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},z1.apply(null,arguments)}var ZO=(t,s,n,a,i)=>{var l=n-a,o;return o="M ".concat(t,",").concat(s),o+="L ".concat(t+n,",").concat(s),o+="L ".concat(t+n-l/2,",").concat(s+i),o+="L ".concat(t+n-l/2-a,",").concat(s+i),o+="L ".concat(t,",").concat(s," Z"),o},APe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},EPe=t=>{var s=ca(t,APe),{x:n,y:a,upperWidth:i,lowerWidth:l,height:o,className:c}=s,{animationEasing:d,animationDuration:u,animationBegin:f,isUpdateAnimationActive:m}=s,x=y.useRef(null),[b,w]=y.useState(-1),j=y.useRef(i),_=y.useRef(l),C=y.useRef(o),k=y.useRef(n),A=y.useRef(a),T=Iv(t,"trapezoid-");if(y.useEffect(()=>{if(x.current&&x.current.getTotalLength)try{var U=x.current.getTotalLength();U&&w(U)}catch{}},[]),n!==+n||a!==+a||i!==+i||l!==+l||o!==+o||i===0&&l===0||o===0)return null;var P=ms("recharts-trapezoid",c);if(!m)return y.createElement("g",null,y.createElement("path",z1({},Ti(s),{className:P,d:ZO(n,a,i,l,o)})));var R=j.current,I=_.current,O=C.current,M=k.current,B=A.current,L="0px ".concat(b===-1?1:b,"px"),F="".concat(b,"px 0px"),V=iH(["strokeDasharray"],u,d);return y.createElement(Pv,{animationId:T,key:T,canBegin:b>0,duration:u,easing:d,isActive:m,begin:f},U=>{var z=Hn(R,i,U),W=Hn(I,l,U),q=Hn(O,o,U),G=Hn(M,n,U),se=Hn(B,a,U);x.current&&(j.current=z,_.current=W,C.current=q,k.current=G,A.current=se);var ge=U>0?{transition:V,strokeDasharray:F}:{strokeDasharray:L};return y.createElement("path",z1({},Ti(s),{className:P,d:ZO(G,se,z,W,q),ref:x,style:QO(QO({},ge),s.style)}))})},TPe=["option","shapeType","propTransformer","activeClassName","isActive"];function PPe(t,s){if(t==null)return{};var n,a,i=IPe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function IPe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}function JO(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function U1(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?JO(Object(n),!0).forEach(function(a){MPe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):JO(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function MPe(t,s,n){return(s=DPe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function DPe(t){var s=OPe(t,"string");return typeof s=="symbol"?s:s+""}function OPe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function RPe(t,s){return U1(U1({},s),t)}function LPe(t,s){return t==="symbols"}function eR(t){var{shapeType:s,elementProps:n}=t;switch(s){case"rectangle":return y.createElement(dH,n);case"trapezoid":return y.createElement(EPe,n);case"sector":return y.createElement(mH,n);case"symbols":if(LPe(s))return y.createElement(GU,n);break;case"curve":return y.createElement(IA,n);default:return null}}function BPe(t){return y.isValidElement(t)?t.props:t}function Qq(t){var{option:s,shapeType:n,propTransformer:a=RPe,activeClassName:i="recharts-active-shape",isActive:l}=t,o=PPe(t,TPe),c;if(y.isValidElement(s))c=y.cloneElement(s,U1(U1({},o),BPe(s)));else if(typeof s=="function")c=s(o);else if(_Pe(s)&&typeof s!="boolean"){var d=a(s,o);c=y.createElement(eR,{shapeType:n,elementProps:d})}else{var u=o;c=y.createElement(eR,{shapeType:n,elementProps:u})}return l?y.createElement(ia,{className:i},c):c}var X5=(t,s)=>{var n=Ys();return(a,i)=>l=>{t==null||t(a,i,l),n(JW({activeIndex:String(i),activeDataKey:s,activeCoordinate:a.tooltipPosition}))}},Q5=t=>{var s=Ys();return(n,a)=>i=>{t==null||t(n,a,i),s(rEe())}},Z5=(t,s)=>{var n=Ys();return(a,i)=>l=>{t==null||t(a,i,l),n(aEe({activeIndex:String(i),activeDataKey:s,activeCoordinate:a.tooltipPosition}))}};function Zq(t){var{fn:s,args:n}=t,a=Ys(),i=ri();return y.useLayoutEffect(()=>{if(!i){var l=s(n);return a(tEe(l)),()=>{a(sEe(l))}}},[s,n,a,i]),null}function FPe(t){var{legendPayload:s}=t,n=Ys(),a=ri();return y.useLayoutEffect(()=>a?Lu:(n(nH(s)),()=>{n(rH(s))}),[n,a,s]),null}function $Pe(t){var{legendPayload:s}=t,n=Ys(),a=_t(ds);return y.useLayoutEffect(()=>a!=="centric"&&a!=="radial"?Lu:(n(nH(s)),()=>{n(rH(s))}),[n,a,s]),null}var Oj,zPe=()=>{var[t]=y.useState(()=>Jp("uid-"));return t},UPe=(Oj=ab.useId)!==null&&Oj!==void 0?Oj:zPe;function Jq(t,s){var n=UPe();return s||(t?"".concat(t,"-").concat(n):n)}var VPe=y.createContext(void 0),eG=t=>{var{id:s,type:n,children:a}=t,i=Jq("recharts-".concat(n),s);return y.createElement(VPe.Provider,{value:i},a(i))},HPe={cartesianItems:[],polarItems:[]},tG=Pa({name:"graphicalItems",initialState:HPe,reducers:{addCartesianGraphicalItem:{reducer(t,s){t.cartesianItems.push(s.payload)},prepare:Gn()},replaceCartesianGraphicalItem:{reducer(t,s){var{prev:n,next:a}=s.payload,i=bo(t).cartesianItems.indexOf(n);i>-1&&(t.cartesianItems[i]=a)},prepare:Gn()},removeCartesianGraphicalItem:{reducer(t,s){var n=bo(t).cartesianItems.indexOf(s.payload);n>-1&&t.cartesianItems.splice(n,1)},prepare:Gn()},addPolarGraphicalItem:{reducer(t,s){t.polarItems.push(s.payload)},prepare:Gn()},removePolarGraphicalItem:{reducer(t,s){var n=bo(t).polarItems.indexOf(s.payload);n>-1&&t.polarItems.splice(n,1)},prepare:Gn()}}}),{addCartesianGraphicalItem:WPe,replaceCartesianGraphicalItem:qPe,removeCartesianGraphicalItem:GPe,addPolarGraphicalItem:KPe,removePolarGraphicalItem:YPe}=tG.actions,XPe=tG.reducer;function QPe(t){var s=Ys(),n=y.useRef(null);return y.useLayoutEffect(()=>{n.current===null?s(WPe(t)):n.current!==t&&s(qPe({prev:n.current,next:t})),n.current=t},[s,t]),y.useLayoutEffect(()=>()=>{n.current&&(s(GPe(n.current)),n.current=null)},[s]),null}function ZPe(t){var s=Ys();return y.useLayoutEffect(()=>(s(KPe(t)),()=>{s(YPe(t))}),[s,t]),null}var JPe=["onMouseEnter","onClick","onMouseLeave"],eIe=["id"],tIe=["id"];function J5(t,s){if(t==null)return{};var n,a,i=sIe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function sIe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}function tR(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function Hs(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?tR(Object(n),!0).forEach(function(a){nIe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tR(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function nIe(t,s,n){return(s=rIe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function rIe(t){var s=aIe(t,"string");return typeof s=="symbol"?s:s+""}function aIe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function Xc(){return Xc=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Xc.apply(null,arguments)}function iIe(t){var s=y.useMemo(()=>Y5(t.children,Dl),[t.children]),n=_t(a=>pPe(a,t.id,s));return n==null?null:y.createElement($Pe,{legendPayload:n})}function lIe(t){var{dataKey:s,nameKey:n,sectors:a,stroke:i,strokeWidth:l,fill:o,name:c,hide:d,tooltipType:u}=t;return{dataDefinedOnItem:a.map(f=>f.tooltipPayload),positions:a.map(f=>f.tooltipPosition),settings:{stroke:i,strokeWidth:l,fill:o,dataKey:s,nameKey:n,name:jv(c,s),hide:d,type:u,color:o,unit:""}}}var oIe=(t,s)=>t>s?"start":t<s?"end":"middle",cIe=(t,s,n)=>Hr(typeof s=="function"?s(t):s,n,n*.8),dIe=(t,s,n)=>{var{top:a,left:i,width:l,height:o}=s,c=uH(l,o),d=i+Hr(t.cx,l,l/2),u=a+Hr(t.cy,o,o/2),f=Hr(t.innerRadius,c,0),m=cIe(n,t.outerRadius,c),x=t.maxRadius||Math.sqrt(l*l+o*o)/2;return{cx:d,cy:u,innerRadius:f,outerRadius:m,maxRadius:x}},uIe=(t,s)=>{var n=Ar(s-t),a=Math.min(Math.abs(s-t),360);return n*a};function hIe(t){return t&&typeof t=="object"&&"className"in t&&typeof t.className=="string"?t.className:""}var fIe=(t,s)=>{if(y.isValidElement(t))return y.cloneElement(t,s);if(typeof t=="function")return t(s);var n=ms("recharts-pie-label-line",typeof t!="boolean"?t.className:"");return y.createElement(IA,Xc({},s,{type:"linear",className:n}))},mIe=(t,s,n)=>{if(y.isValidElement(t))return y.cloneElement(t,s);var a=n;if(typeof t=="function"&&(a=t(s),y.isValidElement(a)))return a;var i=ms("recharts-pie-label-text",hIe(t));return y.createElement(Xv,Xc({},s,{alignmentBaseline:"middle",className:i}),a)};function pIe(t){var{sectors:s,props:n,showLabels:a}=t,{label:i,labelLine:l,dataKey:o}=n;if(!a||!i||!s)return null;var c=ql(n),d=Zp(i),u=Zp(l),f=typeof i=="object"&&"offsetRadius"in i&&typeof i.offsetRadius=="number"&&i.offsetRadius||20,m=s.map((x,b)=>{var w=(x.startAngle+x.endAngle)/2,j=On(x.cx,x.cy,x.outerRadius+f,w),_=Hs(Hs(Hs(Hs({},c),x),{},{stroke:"none"},d),{},{index:b,textAnchor:oIe(j.x,x.cx)},j),C=Hs(Hs(Hs(Hs({},c),x),{},{fill:"none",stroke:x.fill},u),{},{index:b,points:[On(x.cx,x.cy,x.outerRadius,w),j],key:"line"});return y.createElement(eo,{zIndex:zr.label,key:"label-".concat(x.startAngle,"-").concat(x.endAngle,"-").concat(x.midAngle,"-").concat(b)},y.createElement(ia,null,l&&fIe(l,C),mIe(i,_,nn(x,o))))});return y.createElement(ia,{className:"recharts-pie-labels"},m)}function xIe(t){var{sectors:s,props:n,showLabels:a}=t,{label:i}=n;return typeof i=="object"&&i!=null&&"position"in i?y.createElement(Uq,{label:i}):y.createElement(pIe,{sectors:s,props:n,showLabels:a})}function gIe(t){var{sectors:s,activeShape:n,inactiveShape:a,allOtherPieProps:i}=t,l=_t(Cu),{onMouseEnter:o,onClick:c,onMouseLeave:d}=i,u=J5(i,JPe),f=X5(o,i.dataKey),m=Q5(d),x=Z5(c,i.dataKey);return s==null||s.length===0?null:y.createElement(y.Fragment,null,s.map((b,w)=>{if((b==null?void 0:b.startAngle)===0&&(b==null?void 0:b.endAngle)===0&&s.length!==1)return null;var j=n&&String(w)===l,_=l?a:null,C=j?n:_,k=Hs(Hs({},b),{},{stroke:b.stroke,tabIndex:-1,[GV]:w,[KV]:i.dataKey});return y.createElement(ia,Xc({key:"sector-".concat(b==null?void 0:b.startAngle,"-").concat(b==null?void 0:b.endAngle,"-").concat(b.midAngle,"-").concat(w),tabIndex:-1,className:"recharts-pie-sector"},pv(u,b,w),{onMouseEnter:f(b,w),onMouseLeave:m(b,w),onClick:x(b,w)}),y.createElement(Qq,Xc({option:C,isActive:j,shapeType:"sector"},k)))}))}function yIe(t){var s,{pieSettings:n,displayedData:a,cells:i,offset:l}=t,{cornerRadius:o,startAngle:c,endAngle:d,dataKey:u,nameKey:f,tooltipType:m}=n,x=Math.abs(n.minAngle),b=uIe(c,d),w=Math.abs(b),j=a.length<=1?0:(s=n.paddingAngle)!==null&&s!==void 0?s:0,_=a.filter(R=>nn(R,u,0)!==0).length,C=(w>=360?_:_-1)*j,k=w-_*x-C,A=a.reduce((R,I)=>{var O=nn(I,u,0);return R+(Et(O)?O:0)},0),T;if(A>0){var P;T=a.map((R,I)=>{var O=nn(R,u,0),M=nn(R,f,I),B=dIe(n,l,R),L=(Et(O)?O:0)/A,F,V=Hs(Hs({},R),i&&i[I]&&i[I].props);I?F=P.endAngle+Ar(b)*j*(O!==0?1:0):F=c;var U=F+Ar(b)*((O!==0?x:0)+L*k),z=(F+U)/2,W=(B.innerRadius+B.outerRadius)/2,q=[{name:M,value:O,payload:V,dataKey:u,type:m}],G=On(B.cx,B.cy,W,z);return P=Hs(Hs(Hs(Hs({},n.presentationProps),{},{percent:L,cornerRadius:typeof o=="string"?parseFloat(o):o,name:M,tooltipPayload:q,midAngle:z,middleRadius:W,tooltipPosition:G},V),B),{},{value:O,startAngle:F,endAngle:U,payload:V,paddingAngle:Ar(b)*j}),P})}return T}function bIe(t){var{showLabels:s,sectors:n,children:a}=t,i=y.useMemo(()=>!s||!n?[]:n.map(l=>({value:l.value,payload:l.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:l.cx,cy:l.cy,innerRadius:l.innerRadius,outerRadius:l.outerRadius,startAngle:l.startAngle,endAngle:l.endAngle,clockWise:!1},fill:l.fill})),[n,s]);return y.createElement(J4e,{value:s?i:void 0},a)}function vIe(t){var{props:s,previousSectorsRef:n}=t,{sectors:a,isAnimationActive:i,animationBegin:l,animationDuration:o,animationEasing:c,activeShape:d,inactiveShape:u,onAnimationStart:f,onAnimationEnd:m}=s,x=Iv(s,"recharts-pie-"),b=n.current,[w,j]=y.useState(!1),_=y.useCallback(()=>{typeof m=="function"&&m(),j(!1)},[m]),C=y.useCallback(()=>{typeof f=="function"&&f(),j(!0)},[f]);return y.createElement(bIe,{showLabels:!w,sectors:a},y.createElement(Pv,{animationId:x,begin:l,duration:o,isActive:i,easing:c,onAnimationStart:C,onAnimationEnd:_,key:x},k=>{var A=[],T=a&&a[0],P=T==null?void 0:T.startAngle;return a==null||a.forEach((R,I)=>{var O=b&&b[I],M=I>0?wu(R,"paddingAngle",0):0;if(O){var B=Hn(O.endAngle-O.startAngle,R.endAngle-R.startAngle,k),L=Hs(Hs({},R),{},{startAngle:P+M,endAngle:P+B+M});A.push(L),P=L.endAngle}else{var{endAngle:F,startAngle:V}=R,U=Hn(0,F-V,k),z=Hs(Hs({},R),{},{startAngle:P+M,endAngle:P+U+M});A.push(z),P=z.endAngle}}),n.current=A,y.createElement(ia,null,y.createElement(gIe,{sectors:A,activeShape:d,inactiveShape:u,allOtherPieProps:s}))}),y.createElement(xIe,{showLabels:!w,sectors:a,props:s}),s.children)}var wIe={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!Fu.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:zr.area};function NIe(t){var{id:s}=t,n=J5(t,eIe),{hide:a,className:i,rootTabIndex:l}=t,o=y.useMemo(()=>Y5(t.children,Dl),[t.children]),c=_t(f=>xPe(f,s,o)),d=y.useRef(null),u=ms("recharts-pie",i);return a||c==null?(d.current=null,y.createElement(ia,{tabIndex:l,className:u})):y.createElement(eo,{zIndex:t.zIndex},y.createElement(Zq,{fn:lIe,args:Hs(Hs({},t),{},{sectors:c})}),y.createElement(ia,{tabIndex:l,className:u},y.createElement(vIe,{props:Hs(Hs({},n),{},{sectors:c}),previousSectorsRef:d})))}function V1(t){var s=ca(t,wIe),{id:n}=s,a=J5(s,tIe),i=ql(a);return y.createElement(eG,{id:n,type:"pie"},l=>y.createElement(y.Fragment,null,y.createElement(ZPe,{type:"pie",id:l,data:a.data,dataKey:a.dataKey,hide:a.hide,angleAxisId:0,radiusAxisId:0,name:a.name,nameKey:a.nameKey,tooltipType:a.tooltipType,legendType:a.legendType,fill:a.fill,cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,paddingAngle:a.paddingAngle,minAngle:a.minAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius,cornerRadius:a.cornerRadius,presentationProps:i,maxRadius:s.maxRadius}),y.createElement(iIe,Xc({},a,{id:l})),y.createElement(NIe,Xc({},a,{id:l}))))}V1.displayName="Pie";function sR(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function nR(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?sR(Object(n),!0).forEach(function(a){jIe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):sR(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function jIe(t,s,n){return(s=_Ie(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function _Ie(t){var s=SIe(t,"string");return typeof s=="symbol"?s:s+""}function SIe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var CIe={xAxis:{},yAxis:{},zAxis:{}},sG=Pa({name:"cartesianAxis",initialState:CIe,reducers:{addXAxis:{reducer(t,s){t.xAxis[s.payload.id]=s.payload},prepare:Gn()},removeXAxis:{reducer(t,s){delete t.xAxis[s.payload.id]},prepare:Gn()},addYAxis:{reducer(t,s){t.yAxis[s.payload.id]=s.payload},prepare:Gn()},removeYAxis:{reducer(t,s){delete t.yAxis[s.payload.id]},prepare:Gn()},addZAxis:{reducer(t,s){t.zAxis[s.payload.id]=s.payload},prepare:Gn()},removeZAxis:{reducer(t,s){delete t.zAxis[s.payload.id]},prepare:Gn()},updateYAxisWidth(t,s){var{id:n,width:a}=s.payload,i=t.yAxis[n];if(i){var l=i.widthHistory||[];if(l.length===3&&l[0]===l[2]&&a===l[1]&&a!==i.width&&Math.abs(a-l[0])<=1)return;var o=[...l,a].slice(-3);t.yAxis[n]=nR(nR({},t.yAxis[n]),{},{width:a,widthHistory:o})}}}}),{addXAxis:kIe,removeXAxis:AIe,addYAxis:EIe,removeYAxis:TIe,addZAxis:q9e,removeZAxis:G9e,updateYAxisWidth:PIe}=sG.actions,IIe=sG.reducer,MIe=Ae([tr],t=>({top:t.top,bottom:t.bottom,left:t.left,right:t.right})),DIe=Ae([MIe,zo,Uo],(t,s,n)=>{if(!(!t||s==null||n==null))return{x:t.left,y:t.top,width:Math.max(0,s-t.left-t.right),height:Math.max(0,n-t.top-t.bottom)}}),nG=()=>_t(DIe),OIe="Invariant failed";function RIe(t,s){throw new Error(OIe)}var LIe=["x","y"];function lC(){return lC=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},lC.apply(null,arguments)}function rR(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function km(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?rR(Object(n),!0).forEach(function(a){BIe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rR(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function BIe(t,s,n){return(s=FIe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function FIe(t){var s=$Ie(t,"string");return typeof s=="symbol"?s:s+""}function $Ie(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function zIe(t,s){if(t==null)return{};var n,a,i=UIe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function UIe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}function VIe(t,s){var{x:n,y:a}=t,i=zIe(t,LIe),l="".concat(n),o=parseInt(l,10),c="".concat(a),d=parseInt(c,10),u="".concat(s.height||i.height),f=parseInt(u,10),m="".concat(s.width||i.width),x=parseInt(m,10);return km(km(km(km(km({},s),i),o?{x:o}:{}),d?{y:d}:{}),{},{height:f,width:x,name:s.name,radius:s.radius})}function H1(t){return y.createElement(Qq,lC({shapeType:"rectangle",propTransformer:VIe,activeClassName:"recharts-active-bar"},t))}var HIe=function(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(a,i)=>{if(Et(s))return s;var l=Et(a)||fr(a);return l?s(a,i):(l||RIe(),n)}},WIe={},rG=Pa({name:"errorBars",initialState:WIe,reducers:{addErrorBar:(t,s)=>{var{itemId:n,errorBar:a}=s.payload;t[n]||(t[n]=[]),t[n].push(a)},replaceErrorBar:(t,s)=>{var{itemId:n,prev:a,next:i}=s.payload;t[n]&&(t[n]=t[n].map(l=>l.dataKey===a.dataKey&&l.direction===a.direction?i:l))},removeErrorBar:(t,s)=>{var{itemId:n,errorBar:a}=s.payload;t[n]&&(t[n]=t[n].filter(i=>i.dataKey!==a.dataKey||i.direction!==a.direction))}}}),{addErrorBar:K9e,replaceErrorBar:Y9e,removeErrorBar:X9e}=rG.actions,qIe=rG.reducer,GIe=["children"];function KIe(t,s){if(t==null)return{};var n,a,i=YIe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function YIe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}var XIe={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},QIe=y.createContext(XIe);function ZIe(t){var{children:s}=t,n=KIe(t,GIe);return y.createElement(QIe.Provider,{value:n},s)}function aG(t,s){var n,a,i=_t(u=>Ho(u,t)),l=_t(u=>Wo(u,s)),o=(n=i==null?void 0:i.allowDataOverflow)!==null&&n!==void 0?n:Oa.allowDataOverflow,c=(a=l==null?void 0:l.allowDataOverflow)!==null&&a!==void 0?a:Ra.allowDataOverflow,d=o||c;return{needClip:d,needClipX:o,needClipY:c}}function JIe(t){var{xAxisId:s,yAxisId:n,clipPathId:a}=t,i=nG(),{needClipX:l,needClipY:o,needClip:c}=aG(s,n);if(!c||!i)return null;var{x:d,y:u,width:f,height:m}=i;return y.createElement("clipPath",{id:"clipPath-".concat(a)},y.createElement("rect",{x:l?d:d-f/2,y:o?u:u-m/2,width:l?f:f*2,height:o?m:m*2}))}function eMe(t,s){return t&&typeof t=="object"&&"zIndex"in t&&typeof t.zIndex=="number"&&Cn(t.zIndex)?t.zIndex:s}var tMe=["onMouseEnter","onMouseLeave","onClick"],sMe=["value","background","tooltipPosition"],nMe=["id"],rMe=["onMouseEnter","onClick","onMouseLeave"];function Ro(){return Ro=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Ro.apply(null,arguments)}function aR(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function Jr(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?aR(Object(n),!0).forEach(function(a){aMe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):aR(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function aMe(t,s,n){return(s=iMe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function iMe(t){var s=lMe(t,"string");return typeof s=="symbol"?s:s+""}function lMe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function W1(t,s){if(t==null)return{};var n,a,i=oMe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function oMe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}var cMe=t=>{var{dataKey:s,name:n,fill:a,legendType:i,hide:l}=t;return[{inactive:l,dataKey:s,type:i,color:a,value:jv(n,s),payload:t}]};function dMe(t){var{dataKey:s,stroke:n,strokeWidth:a,fill:i,name:l,hide:o,unit:c}=t;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:n,strokeWidth:a,fill:i,dataKey:s,nameKey:void 0,name:jv(l,s),hide:o,type:t.tooltipType,color:t.fill,unit:c}}}function uMe(t){var s=_t(Cu),{data:n,dataKey:a,background:i,allOtherBarProps:l}=t,{onMouseEnter:o,onMouseLeave:c,onClick:d}=l,u=W1(l,tMe),f=X5(o,a),m=Q5(c),x=Z5(d,a);if(!i||n==null)return null;var b=Zp(i);return y.createElement(eo,{zIndex:eMe(i,zr.barBackground)},n.map((w,j)=>{var{value:_,background:C,tooltipPosition:k}=w,A=W1(w,sMe);if(!C)return null;var T=f(w,j),P=m(w,j),R=x(w,j),I=Jr(Jr(Jr(Jr(Jr({option:i,isActive:String(j)===s},A),{},{fill:"#eee"},C),b),pv(u,w,j)),{},{onMouseEnter:T,onMouseLeave:P,onClick:R,dataKey:a,index:j,className:"recharts-bar-background-rectangle"});return y.createElement(H1,Ro({key:"background-bar-".concat(j)},I))}))}function hMe(t){var{showLabels:s,children:n,rects:a}=t,i=a==null?void 0:a.map(l=>{var o={x:l.x,y:l.y,width:l.width,lowerWidth:l.width,upperWidth:l.width,height:l.height};return Jr(Jr({},o),{},{value:l.value,payload:l.payload,parentViewBox:l.parentViewBox,viewBox:o,fill:l.fill})});return y.createElement(Z4e,{value:s?i:void 0},n)}function fMe(t){var{shape:s,activeBar:n,baseProps:a,entry:i,index:l,dataKey:o}=t,c=_t(Cu),d=_t(mq),u=n&&String(l)===c&&(d==null||o===d),f=u?n:s;return u?y.createElement(eo,{zIndex:zr.activeBar},y.createElement(H1,Ro({},a,{name:String(a.name)},i,{isActive:u,option:f,index:l,dataKey:o}))):y.createElement(H1,Ro({},a,{name:String(a.name)},i,{isActive:u,option:f,index:l,dataKey:o}))}function mMe(t){var{shape:s,baseProps:n,entry:a,index:i,dataKey:l}=t;return y.createElement(H1,Ro({},n,{name:String(n.name)},a,{isActive:!1,option:s,index:i,dataKey:l}))}function pMe(t){var s,{data:n,props:a}=t,i=(s=ql(a))!==null&&s!==void 0?s:{},{id:l}=i,o=W1(i,nMe),{shape:c,dataKey:d,activeBar:u}=a,{onMouseEnter:f,onClick:m,onMouseLeave:x}=a,b=W1(a,rMe),w=X5(f,d),j=Q5(x),_=Z5(m,d);return n?y.createElement(y.Fragment,null,n.map((C,k)=>y.createElement(ia,Ro({key:"rectangle-".concat(C==null?void 0:C.x,"-").concat(C==null?void 0:C.y,"-").concat(C==null?void 0:C.value,"-").concat(k),className:"recharts-bar-rectangle"},pv(b,C,k),{onMouseEnter:w(C,k),onMouseLeave:j(C,k),onClick:_(C,k)}),u?y.createElement(fMe,{shape:c,activeBar:u,baseProps:o,entry:C,index:k,dataKey:d}):y.createElement(mMe,{shape:c,baseProps:o,entry:C,index:k,dataKey:d})))):null}function xMe(t){var{props:s,previousRectanglesRef:n}=t,{data:a,layout:i,isAnimationActive:l,animationBegin:o,animationDuration:c,animationEasing:d,onAnimationEnd:u,onAnimationStart:f}=s,m=n.current,x=Iv(s,"recharts-bar-"),[b,w]=y.useState(!1),j=!b,_=y.useCallback(()=>{typeof u=="function"&&u(),w(!1)},[u]),C=y.useCallback(()=>{typeof f=="function"&&f(),w(!0)},[f]);return y.createElement(hMe,{showLabels:j,rects:a},y.createElement(Pv,{animationId:x,begin:o,duration:c,isActive:l,easing:d,onAnimationEnd:_,onAnimationStart:C,key:x},k=>{var A=k===1?a:a==null?void 0:a.map((T,P)=>{var R=m&&m[P];if(R)return Jr(Jr({},T),{},{x:Hn(R.x,T.x,k),y:Hn(R.y,T.y,k),width:Hn(R.width,T.width,k),height:Hn(R.height,T.height,k)});if(i==="horizontal"){var I=Hn(0,T.height,k),O=Hn(T.stackedBarStart,T.y,k);return Jr(Jr({},T),{},{y:O,height:I})}var M=Hn(0,T.width,k),B=Hn(T.stackedBarStart,T.x,k);return Jr(Jr({},T),{},{width:M,x:B})});return k>0&&(n.current=A??null),A==null?null:y.createElement(ia,null,y.createElement(pMe,{props:s,data:A}))}),y.createElement(Uq,{label:s.label}),s.children)}function gMe(t){var s=y.useRef(null);return y.createElement(xMe,{previousRectanglesRef:s,props:t})}var iG=0,yMe=(t,s)=>{var n=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:n,errorVal:nn(t,s)}};class bMe extends y.PureComponent{render(){var{hide:s,data:n,dataKey:a,className:i,xAxisId:l,yAxisId:o,needClip:c,background:d,id:u}=this.props;if(s||n==null)return null;var f=ms("recharts-bar",i),m=u;return y.createElement(ia,{className:f,id:u},c&&y.createElement("defs",null,y.createElement(JIe,{clipPathId:m,xAxisId:l,yAxisId:o})),y.createElement(ia,{className:"recharts-bar-rectangles",clipPath:c?"url(#clipPath-".concat(m,")"):void 0},y.createElement(uMe,{data:n,dataKey:a,background:d,allOtherBarProps:this.props}),y.createElement(gMe,this.props)))}}var vMe={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!Fu.isSsr,legendType:"rect",minPointSize:iG,xAxisId:0,yAxisId:0,zIndex:zr.bar};function wMe(t){var{xAxisId:s,yAxisId:n,hide:a,legendType:i,minPointSize:l,activeBar:o,animationBegin:c,animationDuration:d,animationEasing:u,isAnimationActive:f}=t,{needClip:m}=aG(s,n),x=Ev(),b=ri(),w=Y5(t.children,Dl),j=_t(k=>YMe(k,s,n,b,t.id,w));if(x!=="vertical"&&x!=="horizontal")return null;var _,C=j==null?void 0:j[0];return C==null||C.height==null||C.width==null?_=0:_=x==="vertical"?C.height/2:C.width/2,y.createElement(ZIe,{xAxisId:s,yAxisId:n,data:j,dataPointFormatter:yMe,errorBarOffset:_},y.createElement(bMe,Ro({},t,{layout:x,needClip:m,data:j,xAxisId:s,yAxisId:n,hide:a,legendType:i,minPointSize:l,activeBar:o,animationBegin:c,animationDuration:d,animationEasing:u,isAnimationActive:f})))}function NMe(t){var{layout:s,barSettings:{dataKey:n,minPointSize:a},pos:i,bandSize:l,xAxis:o,yAxis:c,xAxisTicks:d,yAxisTicks:u,stackedData:f,displayedData:m,offset:x,cells:b,parentViewBox:w,dataStartIndex:j}=t,_=s==="horizontal"?c:o,C=f?_.scale.domain():null,k=oSe({numericAxis:_}),A=_.scale(k);return m.map((T,P)=>{var R,I,O,M,B,L;f?R=sSe(f[P+j],C):(R=nn(T,n),Array.isArray(R)||(R=[k,R]));var F=HIe(a,iG)(R[1],P);if(s==="horizontal"){var V,[U,z]=[c.scale(R[0]),c.scale(R[1])];I=JM({axis:o,ticks:d,bandSize:l,offset:i.offset,entry:T,index:P}),O=(V=z??U)!==null&&V!==void 0?V:void 0,M=i.size;var W=U-z;if(B=Gl(W)?0:W,L={x:I,y:x.top,width:M,height:x.height},Math.abs(F)>0&&Math.abs(B)<Math.abs(F)){var q=Ar(B||F)*(Math.abs(F)-Math.abs(B));O-=q,B+=q}}else{var[G,se]=[o.scale(R[0]),o.scale(R[1])];if(I=G,O=JM({axis:c,ticks:u,bandSize:l,offset:i.offset,entry:T,index:P}),M=se-G,B=i.size,L={x:x.left,y:O,width:x.width,height:B},Math.abs(F)>0&&Math.abs(M)<Math.abs(F)){var ge=Ar(M||F)*(Math.abs(F)-Math.abs(M));M+=ge}}if(I==null||O==null||M==null||B==null)return null;var ke=Jr(Jr({},T),{},{stackedBarStart:A,x:I,y:O,width:M,height:B,value:f?R:R[1],payload:T,background:L,tooltipPosition:{x:I+M/2,y:O+B/2},parentViewBox:w},b&&b[P]&&b[P].props);return ke}).filter(Boolean)}function jMe(t){var s=ca(t,vMe),n=ri();return y.createElement(eG,{id:s.id,type:"bar"},a=>y.createElement(y.Fragment,null,y.createElement(FPe,{legendPayload:cMe(s)}),y.createElement(Zq,{fn:dMe,args:s}),y.createElement(QPe,{type:"bar",id:a,data:void 0,xAxisId:s.xAxisId,yAxisId:s.yAxisId,zAxisId:0,dataKey:s.dataKey,stackId:lSe(s.stackId),hide:s.hide,barSize:s.barSize,minPointSize:s.minPointSize,maxBarSize:s.maxBarSize,isPanorama:n}),y.createElement(eo,{zIndex:s.zIndex},y.createElement(wMe,Ro({},s,{id:a})))))}var dx=y.memo(jMe);dx.displayName="Bar";function iR(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function hg(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?iR(Object(n),!0).forEach(function(a){_Me(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):iR(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function _Me(t,s,n){return(s=SMe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function SMe(t){var s=CMe(t,"string");return typeof s=="symbol"?s:s+""}function CMe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var kMe=(t,s)=>s,AMe=(t,s,n)=>n,EMe=(t,s,n,a)=>a,TMe=(t,s,n,a,i)=>i,Kx=Ae([p5,TMe],(t,s)=>t.filter(n=>n.type==="bar").find(n=>n.id===s)),PMe=Ae([Kx],t=>t==null?void 0:t.maxBarSize),IMe=(t,s,n,a,i,l)=>l,lR=(t,s,n)=>{var a=n??t;if(!fr(a))return Hr(a,s,0)},MMe=Ae([ds,p5,kMe,AMe,EMe],(t,s,n,a,i)=>s.filter(l=>t==="horizontal"?l.xAxisId===n:l.yAxisId===a).filter(l=>l.isPanorama===i).filter(l=>l.hide===!1).filter(l=>l.type==="bar")),DMe=(t,s,n,a)=>{var i=ds(t);return i==="horizontal"?eC(t,"yAxis",n,a):eC(t,"xAxis",s,a)},OMe=(t,s,n)=>{var a=ds(t);return a==="horizontal"?gO(t,"xAxis",s):gO(t,"yAxis",n)},RMe=(t,s,n)=>{var a={},i=t.filter(Uv),l=t.filter(u=>u.stackId==null),o=i.reduce((u,f)=>(u[f.stackId]||(u[f.stackId]=[]),u[f.stackId].push(f),u),a),c=Object.entries(o).map(u=>{var[f,m]=u,x=m.map(w=>w.dataKey),b=lR(s,n,m[0].barSize);return{stackId:f,dataKeys:x,barSize:b}}),d=l.map(u=>{var f=[u.dataKey].filter(x=>x!=null),m=lR(s,n,u.barSize);return{stackId:void 0,dataKeys:f,barSize:m}});return[...c,...d]},LMe=Ae([MMe,KAe,OMe],RMe),BMe=(t,s,n,a,i)=>{var l,o,c=Kx(t,s,n,a,i);if(c!=null){var d=ds(t),u=mW(t),{maxBarSize:f}=c,m=fr(f)?u:f,x,b;return d==="horizontal"?(x=mf(t,"xAxis",s,a),b=ff(t,"xAxis",s,a)):(x=mf(t,"yAxis",n,a),b=ff(t,"yAxis",n,a)),(l=(o=w1(x,b,!0))!==null&&o!==void 0?o:m)!==null&&l!==void 0?l:0}},lG=(t,s,n,a)=>{var i=ds(t),l,o;return i==="horizontal"?(l=mf(t,"xAxis",s,a),o=ff(t,"xAxis",s,a)):(l=mf(t,"yAxis",n,a),o=ff(t,"yAxis",n,a)),w1(l,o)};function FMe(t,s,n,a,i){var l=a.length;if(!(l<1)){var o=Hr(t,n,0,!0),c,d=[];if(Cn(a[0].barSize)){var u=!1,f=n/l,m=a.reduce((C,k)=>C+(k.barSize||0),0);m+=(l-1)*o,m>=n&&(m-=(l-1)*o,o=0),m>=n&&f>0&&(u=!0,f*=.9,m=l*f);var x=(n-m)/2>>0,b={offset:x-o,size:0};c=a.reduce((C,k)=>{var A,T={stackId:k.stackId,dataKeys:k.dataKeys,position:{offset:b.offset+b.size+o,size:u?f:(A=k.barSize)!==null&&A!==void 0?A:0}},P=[...C,T];return b=P[P.length-1].position,P},d)}else{var w=Hr(s,n,0,!0);n-2*w-(l-1)*o<=0&&(o=0);var j=(n-2*w-(l-1)*o)/l;j>1&&(j>>=0);var _=Cn(i)?Math.min(j,i):j;c=a.reduce((C,k,A)=>[...C,{stackId:k.stackId,dataKeys:k.dataKeys,position:{offset:w+(j+o)*A+(j-_)/2,size:_}}],d)}return c}}var $Me=(t,s,n,a,i,l,o)=>{var c=fr(o)?s:o,d=FMe(n,a,i!==l?i:l,t,c);return i!==l&&d!=null&&(d=d.map(u=>hg(hg({},u),{},{position:hg(hg({},u.position),{},{offset:u.position.offset-i/2})}))),d},zMe=Ae([LMe,mW,GAe,pW,BMe,lG,PMe],$Me),UMe=(t,s,n,a)=>mf(t,"xAxis",s,a),VMe=(t,s,n,a)=>mf(t,"yAxis",n,a),HMe=(t,s,n,a)=>ff(t,"xAxis",s,a),WMe=(t,s,n,a)=>ff(t,"yAxis",n,a),qMe=Ae([zMe,Kx],(t,s)=>{if(!(t==null||s==null)){var n=t.find(a=>a.stackId===s.stackId&&s.dataKey!=null&&a.dataKeys.includes(s.dataKey));if(n!=null)return n.position}}),GMe=(t,s)=>{var n=h5(s);if(!(!t||n==null||s==null)){var{stackId:a}=s;if(a!=null){var i=t[a];if(i){var{stackedData:l}=i;if(l)return l.find(o=>o.key===n)}}}},KMe=Ae([DMe,Kx],GMe),YMe=Ae([tr,TA,UMe,VMe,HMe,WMe,qMe,ds,n5,lG,KMe,Kx,IMe],(t,s,n,a,i,l,o,c,d,u,f,m,x)=>{var{chartData:b,dataStartIndex:w,dataEndIndex:j}=d;if(!(m==null||o==null||s==null||c!=="horizontal"&&c!=="vertical"||n==null||a==null||i==null||l==null||u==null)){var{data:_}=m,C;if(_!=null&&_.length>0?C=_:C=b==null?void 0:b.slice(w,j+1),C!=null)return NMe({layout:c,barSettings:m,pos:o,parentViewBox:s,bandSize:u,xAxis:n,yAxis:a,xAxisTicks:i,yAxisTicks:l,stackedData:f,displayedData:C,offset:t,cells:x,dataStartIndex:w})}}),oG=t=>{var{chartData:s}=t,n=Ys(),a=ri();return y.useEffect(()=>a?()=>{}:(n(AO(s)),()=>{n(AO(void 0))}),[s,n,a]),null},oR={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},cG=Pa({name:"brush",initialState:oR,reducers:{setBrushSettings(t,s){return s.payload==null?oR:s.payload}}}),{setBrushSettings:Q9e}=cG.actions,XMe=cG.reducer;function QMe(t,s,n){return(s=ZMe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function ZMe(t){var s=JMe(t,"string");return typeof s=="symbol"?s:s+""}function JMe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}class eE{static create(s){return new eE(s)}constructor(s){this.scale=s}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(s){var{bandAware:n,position:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(s!==void 0){if(a)switch(a){case"start":return this.scale(s);case"middle":{var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(s)+i}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(s)+l}default:return this.scale(s)}if(n){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(s)+o}return this.scale(s)}}isInRange(s){var n=this.range(),a=n[0],i=n[n.length-1];return a<=i?s>=a&&s<=i:s>=i&&s<=a}}QMe(eE,"EPS",1e-4);function eDe(t){return(t%180+180)%180}var tDe=function(s){var{width:n,height:a}=s,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,l=eDe(i),o=l*Math.PI/180,c=Math.atan(a/n),d=o>c&&o<Math.PI-c?a/Math.sin(o):n/Math.cos(o);return Math.abs(d)},sDe={dots:[],areas:[],lines:[]},dG=Pa({name:"referenceElements",initialState:sDe,reducers:{addDot:(t,s)=>{t.dots.push(s.payload)},removeDot:(t,s)=>{var n=bo(t).dots.findIndex(a=>a===s.payload);n!==-1&&t.dots.splice(n,1)},addArea:(t,s)=>{t.areas.push(s.payload)},removeArea:(t,s)=>{var n=bo(t).areas.findIndex(a=>a===s.payload);n!==-1&&t.areas.splice(n,1)},addLine:(t,s)=>{t.lines.push(s.payload)},removeLine:(t,s)=>{var n=bo(t).lines.findIndex(a=>a===s.payload);n!==-1&&t.lines.splice(n,1)}}}),{addDot:Z9e,removeDot:J9e,addArea:eBe,removeArea:tBe,addLine:sBe,removeLine:nBe}=dG.actions,nDe=dG.reducer,rDe=y.createContext(void 0),aDe=t=>{var{children:s}=t,[n]=y.useState("".concat(Jp("recharts"),"-clip")),a=nG();if(a==null)return null;var{x:i,y:l,width:o,height:c}=a;return y.createElement(rDe.Provider,{value:n},y.createElement("defs",null,y.createElement("clipPath",{id:n},y.createElement("rect",{x:i,y:l,height:c,width:o}))),s)};function pf(t,s){for(var n in t)if({}.hasOwnProperty.call(t,n)&&(!{}.hasOwnProperty.call(s,n)||t[n]!==s[n]))return!1;for(var a in s)if({}.hasOwnProperty.call(s,a)&&!{}.hasOwnProperty.call(t,a))return!1;return!0}function uG(t,s){if(s<1)return[];if(s===1)return t;for(var n=[],a=0;a<t.length;a+=s)n.push(t[a]);return n}function iDe(t,s,n){var a={width:t.width+s.width,height:t.height+s.height};return tDe(a,n)}function lDe(t,s,n){var a=n==="width",{x:i,y:l,width:o,height:c}=t;return s===1?{start:a?i:l,end:a?i+o:l+c}:{start:a?i+o:l+c,end:a?i:l}}function q1(t,s,n,a,i){if(t*s<t*a||t*s>t*i)return!1;var l=n();return t*(s-t*l/2-a)>=0&&t*(s+t*l/2-i)<=0}function oDe(t,s){return uG(t,s+1)}function cDe(t,s,n,a,i){for(var l=(a||[]).slice(),{start:o,end:c}=s,d=0,u=1,f=o,m=function(){var w=a==null?void 0:a[d];if(w===void 0)return{v:uG(a,u)};var j=d,_,C=()=>(_===void 0&&(_=n(w,j)),_),k=w.coordinate,A=d===0||q1(t,k,C,f,c);A||(d=0,f=o,u+=1),A&&(f=k+t*(C()/2+i),d+=u)},x;u<=l.length;)if(x=m(),x)return x.v;return[]}function cR(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function Rr(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?cR(Object(n),!0).forEach(function(a){dDe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):cR(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function dDe(t,s,n){return(s=uDe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function uDe(t){var s=hDe(t,"string");return typeof s=="symbol"?s:s+""}function hDe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function fDe(t,s,n,a,i){for(var l=(a||[]).slice(),o=l.length,{start:c}=s,{end:d}=s,u=function(x){var b=l[x],w,j=()=>(w===void 0&&(w=n(b,x)),w);if(x===o-1){var _=t*(b.coordinate+t*j()/2-d);l[x]=b=Rr(Rr({},b),{},{tickCoord:_>0?b.coordinate-_*t:b.coordinate})}else l[x]=b=Rr(Rr({},b),{},{tickCoord:b.coordinate});if(b.tickCoord!=null){var C=q1(t,b.tickCoord,j,c,d);C&&(d=b.tickCoord-t*(j()/2+i),l[x]=Rr(Rr({},b),{},{isShow:!0}))}},f=o-1;f>=0;f--)u(f);return l}function mDe(t,s,n,a,i,l){var o=(a||[]).slice(),c=o.length,{start:d,end:u}=s;if(l){var f=a[c-1],m=n(f,c-1),x=t*(f.coordinate+t*m/2-u);if(o[c-1]=f=Rr(Rr({},f),{},{tickCoord:x>0?f.coordinate-x*t:f.coordinate}),f.tickCoord!=null){var b=q1(t,f.tickCoord,()=>m,d,u);b&&(u=f.tickCoord-t*(m/2+i),o[c-1]=Rr(Rr({},f),{},{isShow:!0}))}}for(var w=l?c-1:c,j=function(k){var A=o[k],T,P=()=>(T===void 0&&(T=n(A,k)),T);if(k===0){var R=t*(A.coordinate-t*P()/2-d);o[k]=A=Rr(Rr({},A),{},{tickCoord:R<0?A.coordinate-R*t:A.coordinate})}else o[k]=A=Rr(Rr({},A),{},{tickCoord:A.coordinate});if(A.tickCoord!=null){var I=q1(t,A.tickCoord,P,d,u);I&&(d=A.tickCoord+t*(P()/2+i),o[k]=Rr(Rr({},A),{},{isShow:!0}))}},_=0;_<w;_++)j(_);return o}function pDe(t,s,n){var{tick:a,ticks:i,viewBox:l,minTickGap:o,orientation:c,interval:d,tickFormatter:u,unit:f,angle:m}=t;if(!i||!i.length||!a)return[];if(Et(d)||Fu.isSsr){var x;return(x=oDe(i,Et(d)?d:0))!==null&&x!==void 0?x:[]}var b=[],w=c==="top"||c==="bottom"?"width":"height",j=f&&w==="width"?op(f,{fontSize:s,letterSpacing:n}):{width:0,height:0},_=(A,T)=>{var P=typeof u=="function"?u(A.value,T):A.value;return w==="width"?iDe(op(P,{fontSize:s,letterSpacing:n}),j,m):op(P,{fontSize:s,letterSpacing:n})[w]},C=i.length>=2?Ar(i[1].coordinate-i[0].coordinate):1,k=lDe(l,C,w);return d==="equidistantPreserveStart"?cDe(C,k,_,i,o):(d==="preserveStart"||d==="preserveStartEnd"?b=mDe(C,k,_,i,o,d==="preserveStartEnd"):b=fDe(C,k,_,i,o),b.filter(A=>A.isShow))}var xDe=t=>{var{ticks:s,label:n,labelGapWithTick:a=5,tickSize:i=0,tickMargin:l=0}=t,o=0;if(s){Array.from(s).forEach(f=>{if(f){var m=f.getBoundingClientRect();m.width>o&&(o=m.width)}});var c=n?n.getBoundingClientRect().width:0,d=i+l,u=o+d+c+(n?a:0);return Math.round(u)}return 0},gDe=["axisLine","width","height","className","hide","ticks","axisType"],yDe=["viewBox"],bDe=["viewBox"];function oC(t,s){if(t==null)return{};var n,a,i=vDe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function vDe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}function ku(){return ku=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},ku.apply(null,arguments)}function dR(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function In(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?dR(Object(n),!0).forEach(function(a){wDe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):dR(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function wDe(t,s,n){return(s=NDe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function NDe(t){var s=jDe(t,"string");return typeof s=="symbol"?s:s+""}function jDe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var _De={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:zr.axis};function SDe(t){var{x:s,y:n,width:a,height:i,orientation:l,mirror:o,axisLine:c,otherSvgProps:d}=t;if(!c)return null;var u=In(In(In({},d),ql(c)),{},{fill:"none"});if(l==="top"||l==="bottom"){var f=+(l==="top"&&!o||l==="bottom"&&o);u=In(In({},u),{},{x1:s,y1:n+f*i,x2:s+a,y2:n+f*i})}else{var m=+(l==="left"&&!o||l==="right"&&o);u=In(In({},u),{},{x1:s+m*a,y1:n,x2:s+m*a,y2:n+i})}return y.createElement("line",ku({},u,{className:ms("recharts-cartesian-axis-line",wu(c,"className"))}))}function CDe(t,s,n,a,i,l,o,c,d){var u,f,m,x,b,w,j=c?-1:1,_=t.tickSize||o,C=Et(t.tickCoord)?t.tickCoord:t.coordinate;switch(l){case"top":u=f=t.coordinate,x=n+ +!c*i,m=x-j*_,w=m-j*d,b=C;break;case"left":m=x=t.coordinate,f=s+ +!c*a,u=f-j*_,b=u-j*d,w=C;break;case"right":m=x=t.coordinate,f=s+ +c*a,u=f+j*_,b=u+j*d,w=C;break;default:u=f=t.coordinate,x=n+ +c*i,m=x+j*_,w=m+j*d,b=C;break}return{line:{x1:u,y1:m,x2:f,y2:x},tick:{x:b,y:w}}}function kDe(t,s){switch(t){case"left":return s?"start":"end";case"right":return s?"end":"start";default:return"middle"}}function ADe(t,s){switch(t){case"left":case"right":return"middle";case"top":return s?"start":"end";default:return s?"end":"start"}}function EDe(t){var{option:s,tickProps:n,value:a}=t,i,l=ms(n.className,"recharts-cartesian-axis-tick-value");if(y.isValidElement(s))i=y.cloneElement(s,In(In({},n),{},{className:l}));else if(typeof s=="function")i=s(In(In({},n),{},{className:l}));else{var o="recharts-cartesian-axis-tick-value";typeof s!="boolean"&&(o=ms(o,s==null?void 0:s.className)),i=y.createElement(Xv,ku({},n,{className:o}),a)}return i}var TDe=y.forwardRef((t,s)=>{var{ticks:n=[],tick:a,tickLine:i,stroke:l,tickFormatter:o,unit:c,padding:d,tickTextProps:u,orientation:f,mirror:m,x,y:b,width:w,height:j,tickSize:_,tickMargin:C,fontSize:k,letterSpacing:A,getTicksConfig:T,events:P,axisType:R}=t,I=pDe(In(In({},T),{},{ticks:n}),k,A),O=kDe(f,m),M=ADe(f,m),B=ql(T),L=Zp(a),F={};typeof i=="object"&&(F=i);var V=In(In({},B),{},{fill:"none"},F),U=I.map(q=>In({entry:q},CDe(q,x,b,w,j,f,_,m,C))),z=U.map(q=>{var{entry:G,line:se}=q;return y.createElement(ia,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(G.value,"-").concat(G.coordinate,"-").concat(G.tickCoord)},i&&y.createElement("line",ku({},V,se,{className:ms("recharts-cartesian-axis-tick-line",wu(i,"className"))})))}),W=U.map((q,G)=>{var{entry:se,tick:ge}=q,ke=In(In(In(In({textAnchor:O,verticalAnchor:M},B),{},{stroke:"none",fill:l},L),ge),{},{index:G,payload:se,visibleTicksCount:I.length,tickFormatter:o,padding:d},u);return y.createElement(ia,ku({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(se.value,"-").concat(se.coordinate,"-").concat(se.tickCoord)},pv(P,se,G)),a&&y.createElement(EDe,{option:a,tickProps:ke,value:"".concat(typeof o=="function"?o(se.value,G):se.value).concat(c||"")}))});return y.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(R,"-ticks")},W.length>0&&y.createElement(eo,{zIndex:zr.label},y.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(R,"-tick-labels"),ref:s},W)),z.length>0&&y.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(R,"-tick-lines")},z))}),PDe=y.forwardRef((t,s)=>{var{axisLine:n,width:a,height:i,className:l,hide:o,ticks:c,axisType:d}=t,u=oC(t,gDe),[f,m]=y.useState(""),[x,b]=y.useState(""),w=y.useRef(null);y.useImperativeHandle(s,()=>({getCalculatedWidth:()=>{var _;return xDe({ticks:w.current,label:(_=t.labelRef)===null||_===void 0?void 0:_.current,labelGapWithTick:5,tickSize:t.tickSize,tickMargin:t.tickMargin})}}));var j=y.useCallback(_=>{if(_){var C=_.getElementsByClassName("recharts-cartesian-axis-tick-value");w.current=C;var k=C[0];if(k){var A=window.getComputedStyle(k),T=A.fontSize,P=A.letterSpacing;(T!==f||P!==x)&&(m(T),b(P))}}},[f,x]);return o||a!=null&&a<=0||i!=null&&i<=0?null:y.createElement(eo,{zIndex:t.zIndex},y.createElement(ia,{className:ms("recharts-cartesian-axis",l)},y.createElement(SDe,{x:t.x,y:t.y,width:a,height:i,orientation:t.orientation,mirror:t.mirror,axisLine:n,otherSvgProps:ql(t)}),y.createElement(TDe,{ref:j,axisType:d,events:u,fontSize:f,getTicksConfig:t,height:t.height,letterSpacing:x,mirror:t.mirror,orientation:t.orientation,padding:t.padding,stroke:t.stroke,tick:t.tick,tickFormatter:t.tickFormatter,tickLine:t.tickLine,tickMargin:t.tickMargin,tickSize:t.tickSize,tickTextProps:t.tickTextProps,ticks:c,unit:t.unit,width:t.width,x:t.x,y:t.y}),y.createElement(O4e,{x:t.x,y:t.y,width:t.width,height:t.height,lowerWidth:t.width,upperWidth:t.width},y.createElement(W4e,{label:t.label,labelRef:t.labelRef}),t.children)))}),IDe=y.memo(PDe,(t,s)=>{var{viewBox:n}=t,a=oC(t,yDe),{viewBox:i}=s,l=oC(s,bDe);return pf(n,i)&&pf(a,l)}),tE=y.forwardRef((t,s)=>{var n=ca(t,_De);return y.createElement(IDe,ku({},n,{ref:s}))});tE.displayName="CartesianAxis";var MDe=["dangerouslySetInnerHTML","ticks"],DDe=["id"],ODe=["domain"],RDe=["domain"];function cC(){return cC=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},cC.apply(null,arguments)}function G1(t,s){if(t==null)return{};var n,a,i=LDe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function LDe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}function BDe(t){var s=Ys();return y.useLayoutEffect(()=>(s(kIe(t)),()=>{s(AIe(t))}),[t,s]),null}var FDe=t=>{var{xAxisId:s,className:n}=t,a=_t(TA),i=ri(),l="xAxis",o=_t(_=>Hf(_,l,s,i)),c=_t(_=>GW(_,l,s,i)),d=_t(_=>VW(_,s)),u=_t(_=>W5e(_,s)),f=_t(_=>jW(_,s));if(d==null||u==null||f==null)return null;var{dangerouslySetInnerHTML:m,ticks:x}=t,b=G1(t,MDe),{id:w}=f,j=G1(f,DDe);return y.createElement(tE,cC({},b,j,{scale:o,x:u.x,y:u.y,width:d.width,height:d.height,className:ms("recharts-".concat(l," ").concat(l),n),viewBox:a,ticks:c,axisType:l}))},$De={allowDataOverflow:Oa.allowDataOverflow,allowDecimals:Oa.allowDecimals,allowDuplicatedCategory:Oa.allowDuplicatedCategory,height:Oa.height,hide:!1,mirror:Oa.mirror,orientation:Oa.orientation,padding:Oa.padding,reversed:Oa.reversed,scale:Oa.scale,tickCount:Oa.tickCount,type:Oa.type,xAxisId:0},zDe=t=>{var s,n,a,i,l,o=ca(t,$De);return y.createElement(y.Fragment,null,y.createElement(BDe,{interval:(s=o.interval)!==null&&s!==void 0?s:"preserveEnd",id:o.xAxisId,scale:o.scale,type:o.type,padding:o.padding,allowDataOverflow:o.allowDataOverflow,domain:o.domain,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,includeHidden:(n=o.includeHidden)!==null&&n!==void 0?n:!1,reversed:o.reversed,ticks:o.ticks,height:o.height,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(a=o.angle)!==null&&a!==void 0?a:0,minTickGap:(i=o.minTickGap)!==null&&i!==void 0?i:5,tick:(l=o.tick)!==null&&l!==void 0?l:!0,tickFormatter:o.tickFormatter}),y.createElement(FDe,o))},UDe=(t,s)=>{var{domain:n}=t,a=G1(t,ODe),{domain:i}=s,l=G1(s,RDe);return pf(a,l)?Array.isArray(n)&&n.length===2&&Array.isArray(i)&&i.length===2?n[0]===i[0]&&n[1]===i[1]:pf({domain:n},{domain:i}):!1},ux=y.memo(zDe,UDe);ux.displayName="XAxis";var VDe=["dangerouslySetInnerHTML","ticks"],HDe=["id"],WDe=["domain"],qDe=["domain"];function dC(){return dC=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},dC.apply(null,arguments)}function K1(t,s){if(t==null)return{};var n,a,i=GDe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function GDe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}function KDe(t){var s=Ys();return y.useLayoutEffect(()=>(s(EIe(t)),()=>{s(TIe(t))}),[t,s]),null}var YDe=t=>{var{yAxisId:s,className:n,width:a,label:i}=t,l=y.useRef(null),o=y.useRef(null),c=_t(TA),d=ri(),u=Ys(),f="yAxis",m=_t(P=>Hf(P,f,s,d)),x=_t(P=>HW(P,s)),b=_t(P=>G5e(P,s)),w=_t(P=>GW(P,f,s,d)),j=_t(P=>_W(P,s));if(y.useLayoutEffect(()=>{if(!(a!=="auto"||!x||V5(i)||y.isValidElement(i)||j==null)){var P=l.current;if(P){var R=P.getCalculatedWidth();Math.round(x.width)!==Math.round(R)&&u(PIe({id:s,width:R}))}}},[w,x,u,i,s,a,j]),x==null||b==null||j==null)return null;var{dangerouslySetInnerHTML:_,ticks:C}=t,k=K1(t,VDe),{id:A}=j,T=K1(j,HDe);return y.createElement(tE,dC({},k,T,{ref:l,labelRef:o,scale:m,x:b.x,y:b.y,tickTextProps:a==="auto"?{width:void 0}:{width:a},width:x.width,height:x.height,className:ms("recharts-".concat(f," ").concat(f),n),viewBox:c,ticks:w,axisType:f}))},XDe={allowDataOverflow:Ra.allowDataOverflow,allowDecimals:Ra.allowDecimals,allowDuplicatedCategory:Ra.allowDuplicatedCategory,hide:!1,mirror:Ra.mirror,orientation:Ra.orientation,padding:Ra.padding,reversed:Ra.reversed,scale:Ra.scale,tickCount:Ra.tickCount,type:Ra.type,width:Ra.width,yAxisId:0},QDe=t=>{var s,n,a,i,l,o=ca(t,XDe);return y.createElement(y.Fragment,null,y.createElement(KDe,{interval:(s=o.interval)!==null&&s!==void 0?s:"preserveEnd",id:o.yAxisId,scale:o.scale,type:o.type,domain:o.domain,allowDataOverflow:o.allowDataOverflow,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,padding:o.padding,includeHidden:(n=o.includeHidden)!==null&&n!==void 0?n:!1,reversed:o.reversed,ticks:o.ticks,width:o.width,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(a=o.angle)!==null&&a!==void 0?a:0,minTickGap:(i=o.minTickGap)!==null&&i!==void 0?i:5,tick:(l=o.tick)!==null&&l!==void 0?l:!0,tickFormatter:o.tickFormatter}),y.createElement(YDe,o))},ZDe=(t,s)=>{var{domain:n}=t,a=K1(t,WDe),{domain:i}=s,l=K1(s,qDe);return pf(a,l)?Array.isArray(n)&&n.length===2&&Array.isArray(i)&&i.length===2?n[0]===i[0]&&n[1]===i[1]:pf({domain:n},{domain:i}):!1},hx=y.memo(QDe,ZDe);hx.displayName="YAxis";var JDe={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yx=y;function eOe(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var tOe=typeof Object.is=="function"?Object.is:eOe,sOe=Yx.useSyncExternalStore,nOe=Yx.useRef,rOe=Yx.useEffect,aOe=Yx.useMemo,iOe=Yx.useDebugValue;JDe.useSyncExternalStoreWithSelector=function(t,s,n,a,i){var l=nOe(null);if(l.current===null){var o={hasValue:!1,value:null};l.current=o}else o=l.current;l=aOe(function(){function d(b){if(!u){if(u=!0,f=b,b=a(b),i!==void 0&&o.hasValue){var w=o.value;if(i(w,b))return m=w}return m=b}if(w=m,tOe(f,b))return w;var j=a(b);return i!==void 0&&i(w,j)?(f=b,w):(f=b,m=j)}var u=!1,f,m,x=n===void 0?null:n;return[function(){return d(s())},x===null?void 0:function(){return d(x())}]},[s,n,a,i]);var c=sOe(t,l[0],l[1]);return rOe(function(){o.hasValue=!0,o.value=c},[c]),iOe(c),c};function lOe(t){t()}function oOe(){let t=null,s=null;return{clear(){t=null,s=null},notify(){lOe(()=>{let n=t;for(;n;)n.callback(),n=n.next})},get(){const n=[];let a=t;for(;a;)n.push(a),a=a.next;return n},subscribe(n){let a=!0;const i=s={callback:n,next:null,prev:s};return i.prev?i.prev.next=i:t=i,function(){!a||t===null||(a=!1,i.next?i.next.prev=i.prev:s=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}var uR={notify(){},get:()=>[]};function cOe(t,s){let n,a=uR,i=0,l=!1;function o(j){f();const _=a.subscribe(j);let C=!1;return()=>{C||(C=!0,_(),m())}}function c(){a.notify()}function d(){w.onStateChange&&w.onStateChange()}function u(){return l}function f(){i++,n||(n=t.subscribe(d),a=oOe())}function m(){i--,n&&i===0&&(n(),n=void 0,a.clear(),a=uR)}function x(){l||(l=!0,f())}function b(){l&&(l=!1,m())}const w={addNestedSub:o,notifyNestedSubs:c,handleChangeWrapper:d,isSubscribed:u,trySubscribe:x,tryUnsubscribe:b,getListeners:()=>a};return w}var dOe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",uOe=dOe(),hOe=()=>typeof navigator<"u"&&navigator.product==="ReactNative",fOe=hOe(),mOe=()=>uOe||fOe?y.useLayoutEffect:y.useEffect,pOe=mOe(),Rj=Symbol.for("react-redux-context"),Lj=typeof globalThis<"u"?globalThis:{};function xOe(){if(!y.createContext)return{};const t=Lj[Rj]??(Lj[Rj]=new Map);let s=t.get(y.createContext);return s||(s=y.createContext(null),t.set(y.createContext,s)),s}var gOe=xOe();function yOe(t){const{children:s,context:n,serverState:a,store:i}=t,l=y.useMemo(()=>{const d=cOe(i);return{store:i,subscription:d,getServerState:a?()=>a:void 0}},[i,a]),o=y.useMemo(()=>i.getState(),[i]);pOe(()=>{const{subscription:d}=l;return d.onStateChange=d.notifyNestedSubs,d.trySubscribe(),o!==i.getState()&&d.notifyNestedSubs(),()=>{d.tryUnsubscribe(),d.onStateChange=void 0}},[l,o]);const c=n||gOe;return y.createElement(c.Provider,{value:l},s)}var bOe=yOe,vOe=(t,s)=>s,sE=Ae([vOe,ds,wW,nr,dq,qo,nTe,tr],dTe),nE=t=>{var s=t.currentTarget.getBoundingClientRect(),n=s.width/t.currentTarget.offsetWidth,a=s.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-s.left)/n),chartY:Math.round((t.clientY-s.top)/a)}},hG=Pi("mouseClick"),fG=Ox();fG.startListening({actionCreator:hG,effect:(t,s)=>{var n=t.payload,a=sE(s.getState(),nE(n));(a==null?void 0:a.activeIndex)!=null&&s.dispatch(iEe({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}});var uC=Pi("mouseMove"),mG=Ox();mG.startListening({actionCreator:uC,effect:(t,s)=>{var n=t.payload,a=s.getState(),i=D5(a,a.tooltip.settings.shared),l=sE(a,nE(n));i==="axis"&&((l==null?void 0:l.activeIndex)!=null?s.dispatch(tq({activeIndex:l.activeIndex,activeDataKey:void 0,activeCoordinate:l.activeCoordinate})):s.dispatch(eq()))}});var hR={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0},pG=Pa({name:"rootProps",initialState:hR,reducers:{updateOptions:(t,s)=>{var n;t.accessibilityLayer=s.payload.accessibilityLayer,t.barCategoryGap=s.payload.barCategoryGap,t.barGap=(n=s.payload.barGap)!==null&&n!==void 0?n:hR.barGap,t.barSize=s.payload.barSize,t.maxBarSize=s.payload.maxBarSize,t.stackOffset=s.payload.stackOffset,t.syncId=s.payload.syncId,t.syncMethod=s.payload.syncMethod,t.className=s.payload.className,t.baseValue=s.payload.baseValue}}}),wOe=pG.reducer,{updateOptions:NOe}=pG.actions,xG=Pa({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(t,s)=>s.payload}}),{updatePolarOptions:jOe}=xG.actions,_Oe=xG.reducer,gG=Pi("keyDown"),yG=Pi("focus"),rE=Ox();rE.startListening({actionCreator:gG,effect:(t,s)=>{var n=s.getState(),a=n.rootProps.accessibilityLayer!==!1;if(a){var{keyboardInteraction:i}=n.tooltip,l=t.payload;if(!(l!=="ArrowRight"&&l!=="ArrowLeft"&&l!=="Enter")){var o=Number(O5(i,qf(n))),c=qo(n);if(l==="Enter"){var d=F1(n,"axis","hover",String(i.index));s.dispatch(sC({active:!i.active,activeIndex:i.index,activeDataKey:i.dataKey,activeCoordinate:d}));return}var u=Q5e(n),f=u==="left-to-right"?1:-1,m=l==="ArrowRight"?1:-1,x=o+m*f;if(!(c==null||x>=c.length||x<0)){var b=F1(n,"axis","hover",String(x));s.dispatch(sC({active:!0,activeIndex:x.toString(),activeDataKey:void 0,activeCoordinate:b}))}}}}});rE.startListening({actionCreator:yG,effect:(t,s)=>{var n=s.getState(),a=n.rootProps.accessibilityLayer!==!1;if(a){var{keyboardInteraction:i}=n.tooltip;if(!i.active&&i.index==null){var l="0",o=F1(n,"axis","hover",String(l));s.dispatch(sC({activeDataKey:void 0,active:!0,activeIndex:l,activeCoordinate:o}))}}}});var pi=Pi("externalEvent"),bG=Ox();bG.startListening({actionCreator:pi,effect:(t,s)=>{if(t.payload.handler!=null){var n=s.getState(),a={activeCoordinate:UEe(n),activeDataKey:mq(n),activeIndex:Cu(n),activeLabel:fq(n),activeTooltipIndex:Cu(n),isTooltipActive:VEe(n)};t.payload.handler(a,t.payload.reactEvent)}}});var SOe=Ae([Wf],t=>t.tooltipItemPayloads),COe=Ae([SOe,qx,(t,s,n)=>s,(t,s,n)=>n],(t,s,n,a)=>{var i=t.find(c=>c.settings.dataKey===a);if(i!=null){var{positions:l}=i;if(l!=null){var o=s(l,n);return o}}}),vG=Pi("touchMove"),wG=Ox();wG.startListening({actionCreator:vG,effect:(t,s)=>{var n=t.payload;if(!(n.touches==null||n.touches.length===0)){var a=s.getState(),i=D5(a,a.tooltip.settings.shared);if(i==="axis"){var l=sE(a,nE({clientX:n.touches[0].clientX,clientY:n.touches[0].clientY,currentTarget:n.currentTarget}));(l==null?void 0:l.activeIndex)!=null&&s.dispatch(tq({activeIndex:l.activeIndex,activeDataKey:void 0,activeCoordinate:l.activeCoordinate}))}else if(i==="item"){var o,c=n.touches[0];if(document.elementFromPoint==null)return;var d=document.elementFromPoint(c.clientX,c.clientY);if(!d||!d.getAttribute)return;var u=d.getAttribute(GV),f=(o=d.getAttribute(KV))!==null&&o!==void 0?o:void 0,m=COe(s.getState(),u,f);s.dispatch(JW({activeDataKey:f,activeIndex:u,activeCoordinate:m}))}}}});var kOe=vV({brush:XMe,cartesianAxis:IIe,chartData:$Te,errorBars:qIe,graphicalItems:XPe,layout:X_e,legend:HSe,options:OTe,polarAxis:cPe,polarOptions:_Oe,referenceElements:nDe,rootProps:wOe,tooltip:lEe,zIndex:_Te}),AOe=function(s){return w_e({reducer:kOe,preloadedState:s,middleware:n=>n({serializableCheck:!1}).concat([fG.middleware,mG.middleware,rE.middleware,bG.middleware,wG.middleware]),enhancers:n=>{var a=n;return typeof n=="function"&&(a=n()),a.concat(IV({type:"raf"}))},devTools:Fu.devToolsEnabled})};function NG(t){var{preloadedState:s,children:n,reduxStoreName:a}=t,i=ri(),l=y.useRef(null);if(i)return n;l.current==null&&(l.current=AOe(s));var o=NA;return y.createElement(bOe,{context:o,store:l.current},n)}function jG(t){var{layout:s,margin:n}=t,a=Ys(),i=ri();return y.useEffect(()=>{i||(a(G_e(s)),a(q_e(n)))},[a,i,s,n]),null}function _G(t){var s=Ys();return y.useEffect(()=>{s(NOe(t))},[s,t]),null}function fR(t){var{zIndex:s,isPanorama:n}=t,a=n?"recharts-zindex-panorama-":"recharts-zindex-",i=Jq("".concat(a).concat(s)),l=Ys();return y.useLayoutEffect(()=>(l(NTe({zIndex:s,elementId:i,isPanorama:n})),()=>{l(jTe({zIndex:s,isPanorama:n}))}),[l,s,i,n]),y.createElement("g",{id:i})}function mR(t){var{children:s,isPanorama:n}=t,a=_t(hTe);if(!a||a.length===0)return s;var i=a.filter(o=>o<0),l=a.filter(o=>o>0);return y.createElement(y.Fragment,null,i.map(o=>y.createElement(fR,{key:o,zIndex:o,isPanorama:n})),s,l.map(o=>y.createElement(fR,{key:o,zIndex:o,isPanorama:n})))}var EOe=["children"];function TOe(t,s){if(t==null)return{};var n,a,i=POe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function POe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}function Y1(){return Y1=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Y1.apply(null,arguments)}var IOe={width:"100%",height:"100%",display:"block"},MOe=y.forwardRef((t,s)=>{var n=$Se(),a=zSe(),i=aH();if(!Yc(n)||!Yc(a))return null;var{children:l,otherAttributes:o,title:c,desc:d}=t,u,f;return o!=null&&(typeof o.tabIndex=="number"?u=o.tabIndex:u=i?0:void 0,typeof o.role=="string"?f=o.role:f=i?"application":void 0),y.createElement(CU,Y1({},o,{title:c,desc:d,role:f,tabIndex:u,width:n,height:a,style:IOe,ref:s}),l)}),DOe=t=>{var{children:s}=t,n=_t(kv);if(!n)return null;var{width:a,height:i,y:l,x:o}=n;return y.createElement(CU,{width:a,height:i,x:o,y:l},s)},pR=y.forwardRef((t,s)=>{var{children:n}=t,a=TOe(t,EOe),i=ri();return i?y.createElement(DOe,null,y.createElement(mR,{isPanorama:!0},n)):y.createElement(MOe,Y1({ref:s},a),y.createElement(mR,{isPanorama:!1},n))});function OOe(){var t=Ys(),[s,n]=y.useState(null),a=_t(mSe);return y.useEffect(()=>{if(s!=null){var i=s.getBoundingClientRect(),l=i.width/s.offsetWidth;Cn(l)&&l!==a&&t(Y_e(l))}},[s,t,a]),n}function xR(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function ROe(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?xR(Object(n),!0).forEach(function(a){LOe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xR(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function LOe(t,s,n){return(s=BOe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function BOe(t){var s=FOe(t,"string");return typeof s=="symbol"?s:s+""}function FOe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function Au(){return Au=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Au.apply(null,arguments)}var $Oe=()=>(YTe(),null);function X1(t){if(typeof t=="number")return t;if(typeof t=="string"){var s=parseFloat(t);if(!Number.isNaN(s))return s}return 0}var zOe=y.forwardRef((t,s)=>{var n,a,i=y.useRef(null),[l,o]=y.useState({containerWidth:X1((n=t.style)===null||n===void 0?void 0:n.width),containerHeight:X1((a=t.style)===null||a===void 0?void 0:a.height)}),c=y.useCallback((u,f)=>{o(m=>{var x=Math.round(u),b=Math.round(f);return m.containerWidth===x&&m.containerHeight===b?m:{containerWidth:x,containerHeight:b}})},[]),d=y.useCallback(u=>{if(typeof s=="function"&&s(u),u!=null&&typeof ResizeObserver<"u"){var{width:f,height:m}=u.getBoundingClientRect();c(f,m);var x=w=>{var{width:j,height:_}=w[0].contentRect;c(j,_)},b=new ResizeObserver(x);b.observe(u),i.current=b}},[s,c]);return y.useEffect(()=>()=>{var u=i.current;u!=null&&u.disconnect()},[c]),y.createElement(y.Fragment,null,y.createElement(Tv,{width:l.containerWidth,height:l.containerHeight}),y.createElement("div",Au({ref:d},t)))}),UOe=y.forwardRef((t,s)=>{var{width:n,height:a}=t,[i,l]=y.useState({containerWidth:X1(n),containerHeight:X1(a)}),o=y.useCallback((d,u)=>{l(f=>{var m=Math.round(d),x=Math.round(u);return f.containerWidth===m&&f.containerHeight===x?f:{containerWidth:m,containerHeight:x}})},[]),c=y.useCallback(d=>{if(typeof s=="function"&&s(d),d!=null){var{width:u,height:f}=d.getBoundingClientRect();o(u,f)}},[s,o]);return y.createElement(y.Fragment,null,y.createElement(Tv,{width:i.containerWidth,height:i.containerHeight}),y.createElement("div",Au({ref:c},t)))}),VOe=y.forwardRef((t,s)=>{var{width:n,height:a}=t;return y.createElement(y.Fragment,null,y.createElement(Tv,{width:n,height:a}),y.createElement("div",Au({ref:s},t)))}),HOe=y.forwardRef((t,s)=>{var{width:n,height:a}=t;return To(n)||To(a)?y.createElement(UOe,Au({},t,{ref:s})):y.createElement(VOe,Au({},t,{ref:s}))});function WOe(t){return t===!0?zOe:HOe}var qOe=y.forwardRef((t,s)=>{var{children:n,className:a,height:i,onClick:l,onContextMenu:o,onDoubleClick:c,onMouseDown:d,onMouseEnter:u,onMouseLeave:f,onMouseMove:m,onMouseUp:x,onTouchEnd:b,onTouchMove:w,onTouchStart:j,style:_,width:C,responsive:k,dispatchTouchEvents:A=!0}=t,T=y.useRef(null),P=Ys(),[R,I]=y.useState(null),[O,M]=y.useState(null),B=OOe(),L=PA(),F=(L==null?void 0:L.width)>0?L.width:C,V=(L==null?void 0:L.height)>0?L.height:i,U=y.useCallback(ce=>{B(ce),typeof s=="function"&&s(ce),I(ce),M(ce),ce!=null&&(T.current=ce)},[B,s,I,M]),z=y.useCallback(ce=>{P(hG(ce)),P(pi({handler:l,reactEvent:ce}))},[P,l]),W=y.useCallback(ce=>{P(uC(ce)),P(pi({handler:u,reactEvent:ce}))},[P,u]),q=y.useCallback(ce=>{P(eq()),P(pi({handler:f,reactEvent:ce}))},[P,f]),G=y.useCallback(ce=>{P(uC(ce)),P(pi({handler:m,reactEvent:ce}))},[P,m]),se=y.useCallback(()=>{P(yG())},[P]),ge=y.useCallback(ce=>{P(gG(ce.key))},[P]),ke=y.useCallback(ce=>{P(pi({handler:o,reactEvent:ce}))},[P,o]),ee=y.useCallback(ce=>{P(pi({handler:c,reactEvent:ce}))},[P,c]),pe=y.useCallback(ce=>{P(pi({handler:d,reactEvent:ce}))},[P,d]),ue=y.useCallback(ce=>{P(pi({handler:x,reactEvent:ce}))},[P,x]),ye=y.useCallback(ce=>{P(pi({handler:j,reactEvent:ce}))},[P,j]),X=y.useCallback(ce=>{A&&P(vG(ce)),P(pi({handler:w,reactEvent:ce}))},[P,A,w]),oe=y.useCallback(ce=>{P(pi({handler:b,reactEvent:ce}))},[P,b]),_e=WOe(k);return y.createElement(Nq.Provider,{value:R},y.createElement(Rje.Provider,{value:O},y.createElement(_e,{width:F??(_==null?void 0:_.width),height:V??(_==null?void 0:_.height),className:ms("recharts-wrapper",a),style:ROe({position:"relative",cursor:"default",width:F,height:V},_),onClick:z,onContextMenu:ke,onDoubleClick:ee,onFocus:se,onKeyDown:ge,onMouseDown:pe,onMouseEnter:W,onMouseLeave:q,onMouseMove:G,onMouseUp:ue,onTouchEnd:oe,onTouchMove:X,onTouchStart:ye,ref:U},y.createElement($Oe,null),n)))}),GOe=["width","height","responsive","children","className","style","compact","title","desc"];function KOe(t,s){if(t==null)return{};var n,a,i=YOe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function YOe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}var SG=y.forwardRef((t,s)=>{var{width:n,height:a,responsive:i,children:l,className:o,style:c,compact:d,title:u,desc:f}=t,m=KOe(t,GOe),x=ql(m);return d?y.createElement(y.Fragment,null,y.createElement(Tv,{width:n,height:a}),y.createElement(pR,{otherAttributes:x,title:u,desc:f},l)):y.createElement(qOe,{className:o,style:c,width:n,height:a,responsive:i??!1,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},y.createElement(pR,{otherAttributes:x,title:u,desc:f,ref:s},y.createElement(aDe,null,l)))});function hC(){return hC=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},hC.apply(null,arguments)}var XOe={top:5,right:5,bottom:5,left:5},QOe={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:XOe,reverseStackOrder:!1,syncMethod:"index",responsive:!1},ZOe=y.forwardRef(function(s,n){var a,i=ca(s.categoricalChartProps,QOe),{chartName:l,defaultTooltipEventType:o,validateTooltipEventTypes:c,tooltipPayloadSearcher:d,categoricalChartProps:u}=s,f={chartName:l,defaultTooltipEventType:o,validateTooltipEventTypes:c,tooltipPayloadSearcher:d,eventEmitter:void 0};return y.createElement(NG,{preloadedState:{options:f},reduxStoreName:(a=u.id)!==null&&a!==void 0?a:l},y.createElement(oG,{chartData:u.data}),y.createElement(jG,{layout:i.layout,margin:i.margin}),y.createElement(_G,{baseValue:i.baseValue,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className}),y.createElement(SG,hC({},i,{ref:n})))}),JOe=["axis","item"],Q1=y.forwardRef((t,s)=>y.createElement(ZOe,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:JOe,tooltipPayloadSearcher:_q,categoricalChartProps:t,ref:s}));function eRe(t){var s=Ys();return y.useEffect(()=>{s(jOe(t))},[s,t]),null}var tRe=["layout"];function fC(){return fC=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},fC.apply(null,arguments)}function sRe(t,s){if(t==null)return{};var n,a,i=nRe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function nRe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}var rRe={top:5,right:5,bottom:5,left:5},aRe={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:rRe,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1},iRe=y.forwardRef(function(s,n){var a,i=ca(s.categoricalChartProps,aRe),{layout:l}=i,o=sRe(i,tRe),{chartName:c,defaultTooltipEventType:d,validateTooltipEventTypes:u,tooltipPayloadSearcher:f}=s,m={chartName:c,defaultTooltipEventType:d,validateTooltipEventTypes:u,tooltipPayloadSearcher:f,eventEmitter:void 0};return y.createElement(NG,{preloadedState:{options:m},reduxStoreName:(a=i.id)!==null&&a!==void 0?a:c},y.createElement(oG,{chartData:i.data}),y.createElement(jG,{layout:l,margin:i.margin}),y.createElement(_G,{baseValue:void 0,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className}),y.createElement(eRe,{cx:i.cx,cy:i.cy,startAngle:i.startAngle,endAngle:i.endAngle,innerRadius:i.innerRadius,outerRadius:i.outerRadius}),y.createElement(SG,fC({},o,{ref:n})))}),lRe=["item"],oRe={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},mC=y.forwardRef((t,s)=>{var n=ca(t,oRe);return y.createElement(iRe,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:lRe,tooltipPayloadSearcher:_q,categoricalChartProps:n,ref:s})});const sc=["#0f172a","#0284c7","#22c55e","#e11d48","#6366f1"];function ro(t){return t.toISOString().slice(0,10)}function gR(t,s){const n=new Date(t);return n.setDate(n.getDate()+s),n}const cRe={hidden:{opacity:0,y:8},visible:{opacity:1,y:0,transition:{duration:.3,ease:"easeOut"}}},Bj={hidden:{},visible:{transition:{staggerChildren:.08,delayChildren:.05}}},Fj={hidden:{opacity:0,y:10,scale:.97},visible:{opacity:1,y:0,scale:1,transition:{duration:.25,ease:"easeOut"}}},yR={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{duration:.25,ease:"easeOut"}}};function bR(){var _e;const t=new Date,[s,n]=y.useState(()=>ro(t)),[a,i]=y.useState(()=>ro(t)),[l,o]=y.useState("today"),[c,d]=y.useState("overview"),[u,f]=y.useState(null),[m,x]=y.useState(null),[b,w]=y.useState(!0),[j,_]=y.useState(""),[C,k]=y.useState(0),A=!!(s&&a);y.useEffect(()=>{if(!A){w(!1),_(""),f(null);return}(async()=>{var he,fe;w(!0),_("");try{const Ve=await kje({date_from:s,date_to:a});console.log("DASHBOARD DATA >>>",Ve.data),f(Ve.data),x(new Date)}catch(le){console.error(le),_(((fe=(he=le==null?void 0:le.response)==null?void 0:he.data)==null?void 0:fe.detail)||"Failed to load dashboard data. Please try again."),f(null)}finally{w(!1)}})()},[s,a,C,A]);const T=((_e=u==null?void 0:u.filters)==null?void 0:_e.caps)||{},P=Object.keys(T).length>0,R=y.useMemo(()=>{if(!P)return[];const ce=[];return T.can_patients&&ce.push({key:"patients",label:"Patients",icon:sn}),T.can_opd&&ce.push({key:"opd",label:"OPD",icon:_s}),T.can_ipd&&ce.push({key:"ipd",label:"IPD / Beds",icon:Jn}),T.can_lab&&ce.push({key:"lab",label:"Lab",icon:Bc}),T.can_radiology&&ce.push({key:"radiology",label:"Radiology",icon:Dy}),T.can_pharmacy&&ce.push({key:"pharmacy",label:"Pharmacy",icon:Vr}),T.can_billing&&ce.push({key:"billing",label:"Billing",icon:Pl}),T.can_ot&&ce.push({key:"ot",label:"OT",icon:sn}),ce},[P,T]),I=y.useMemo(()=>{var ce;return((ce=u==null?void 0:u.widgets)==null?void 0:ce.filter(he=>he.widget_type==="metric"))||[]},[u]),O=y.useMemo(()=>{var ce;return((ce=u==null?void 0:u.widgets)==null?void 0:ce.filter(he=>he.widget_type==="table"))||[]},[u]),M=y.useMemo(()=>{var ce;return((ce=u==null?void 0:u.widgets)==null?void 0:ce.filter(he=>he.widget_type==="chart"))||[]},[u]),B=M.find(ce=>ce.code==="patient_flow"),L=M.find(ce=>ce.code==="ipd_bed_occupancy"),F=M.find(ce=>ce.code==="revenue_by_stream"),V=M.find(ce=>ce.code==="appointment_status"),U=M.find(ce=>ce.code==="ipd_status"),z=M.find(ce=>ce.code==="payment_modes"),W=M.find(ce=>ce.code==="top_lab_tests"),q=M.find(ce=>ce.code==="top_radiology_tests"),G=M.find(ce=>ce.code==="billing_summary"),se=M.find(ce=>ce.code==="top_medicines"),ge=O.find(ce=>ce.code==="recent_ipd_admissions"),ke=I.filter(ce=>ce.code.startsWith("revenue_")),ee=I.filter(ce=>!ce.code.startsWith("revenue_")),pe=()=>k(ce=>ce+1),ue=ce=>{o(ce);const he=new Date;if(ce==="today"){const fe=ro(he);n(fe),i(fe)}else if(ce==="7d"){const fe=ro(gR(he,-6)),le=ro(he);n(fe),i(le)}else if(ce==="30d"){const fe=ro(gR(he,-29)),le=ro(he);n(fe),i(le)}else if(ce==="month"){const fe=new Date(he.getFullYear(),he.getMonth(),1),le=ro(fe),Ve=ro(he);n(le),i(Ve)}},ye=ce=>he=>{o("custom"),ce(he.target.value)},X=y.useMemo(()=>{if(!u)return[];const ce=bt=>{var be;return((be=I.find(ne=>ne.code===bt))==null?void 0:be.data)??0},he=Number(ce("metric_new_patients"))||0,fe=Number(ce("metric_opd_visits"))||0,le=Number(ce("metric_ipd_admissions"))||0,Ke=((L==null?void 0:L.data)||{}).occupancy_pct??0,wt=(F==null?void 0:F.data)||[],mt=Array.isArray(wt)&&wt.length?[...wt].sort((bt,be)=>(be.value||0)-(bt.value||0))[0]:null,rt=[];return T.can_patients&&I.length&&rt.push({key:"patients",label:"New Patients",value:he,helper:"Registered in period",icon:sn,tone:"sky"}),T.can_opd&&I.length&&rt.push({key:"opd",label:"OPD Visits",value:fe,helper:"Completed consults",icon:_s,tone:"emerald"}),T.can_ipd&&I.length&&rt.push({key:"ipd",label:"IPD Admissions",value:le,helper:"Admitted cases",icon:Jn,tone:"violet"}),T.can_ipd&&L&&rt.push({key:"beds",label:"Bed Occupancy",value:Ke,suffix:"%",helper:"Across all wards",icon:Jn,tone:"amber"}),mt&&(T.can_billing||T.can_pharmacy||T.can_lab||T.can_radiology)&&rt.push({key:"revenue",label:"Top Revenue Stream",value:mt.value||0,helper:mt.label||"",icon:mt.label==="Pharmacy"?Vr:mt.label==="Lab"?Bc:mt.label==="Radiology"?Dy:Pl,tone:"rose"}),rt.filter(Boolean)},[u,I,L,F,T.can_patients,T.can_opd,T.can_ipd,T.can_billing,T.can_pharmacy,T.can_lab,T.can_radiology]),oe=y.useMemo(()=>[{key:"overview",label:"Overview",show:!0},{key:"clinical",label:"Clinical",show:T.can_patients||T.can_opd||T.can_ipd},{key:"revenue",label:"Revenue",show:T.can_billing||T.can_pharmacy||T.can_lab||T.can_radiology},{key:"operations",label:"Operations",show:T.can_ipd||T.can_pharmacy||T.can_lab||T.can_radiology}].filter(he=>he.show),[T]);return y.useEffect(()=>{oe.find(ce=>ce.key===c)||oe.length>0&&d(oe[0].key)},[oe,c]),r.jsxs(Nt.div,{className:"relative min-h-[calc(100vh-4rem)]  px-3 py-3 md:px-6 md:py-6 rounded",variants:cRe,initial:"hidden",animate:"visible",children:[r.jsxs("div",{className:"pointer-events-none absolute inset-0 -z-10",children:[r.jsx("div",{className:"absolute -top-24 right-0 h-40 w-40 rounded-full bg-sky-200/40 blur-3xl"}),r.jsx("div",{className:"absolute -bottom-24 left-4 h-40 w-40 rounded-full bg-emerald-200/40 blur-3xl"})]}),r.jsxs("div",{className:"mx-auto w-full max-w-6xl space-y-4",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsxs(Nt.div,{className:Pt("flex flex-col md:flex-row md:items-start md:justify-between gap-3","rounded-2xl border border-slate-200/70 bg-white/90 backdrop-blur-sm p-3 md:p-5 shadow-sm"),children:[r.jsxs("div",{className:"space-y-2 md:max-w-md",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-sky-200 bg-sky-50 px-3 py-1 text-[10px] md:text-[11px] font-medium text-sky-700",children:[r.jsxs("span",{className:"relative flex h-2 w-2",children:[r.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-emerald-400 opacity-75"}),r.jsx("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-emerald-500"})]}),"Live operations & clinical overview"]}),r.jsxs("h1",{className:"text-xl md:text-3xl font-semibold tracking-tight text-slate-900 flex items-center gap-2",children:[r.jsx("span",{className:"inline-flex h-8 w-8 md:h-9 md:w-9 items-center justify-center rounded-xl bg-sky-100 text-sky-600 border border-sky-200",children:r.jsx(Om,{className:"w-4 h-4 md:w-5 md:h-5"})}),"Dashboard"]}),r.jsx("p",{className:"text-xs md:text-sm text-slate-600",children:"Monitor patients, beds, diagnostics, pharmacy and revenue in one live dashboard designed for hospital admins & clinical teams."}),P&&R.length>0&&r.jsx("div",{className:"flex flex-wrap gap-1.5 mt-2",children:R.map(ce=>r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-100 border border-slate-200 px-2 py-0.5 text-[10px] text-slate-700",children:[r.jsx("span",{className:"flex h-4 w-4 items-center justify-center rounded-full bg-white shadow-inner",children:r.jsx(ce.icon,{className:"w-3 h-3"})}),r.jsx("span",{className:"font-medium",children:ce.label})]},ce.key))}),m&&r.jsxs("div",{className:"inline-flex items-center gap-1.5 rounded-full bg-slate-100 px-2.5 py-1 mt-1 text-[10px] text-slate-600",children:[r.jsx(Xn,{className:"w-3 h-3"}),r.jsx("span",{className:"font-medium",children:"Last updated:"}),r.jsx("span",{children:m.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"})})]})]}),r.jsxs("div",{className:"flex flex-col gap-2 w-full md:w-auto",children:[r.jsx("div",{className:"flex flex-wrap gap-1.5",children:[{key:"today",label:"Today"},{key:"7d",label:"Last 7 days"},{key:"30d",label:"Last 30 days"},{key:"month",label:"This month"},{key:"custom",label:"Custom"}].map(ce=>r.jsx("button",{type:"button",onClick:()=>ue(ce.key),className:Pt("px-2.5 py-1 rounded-full text-[10px] font-medium border transition-colors",l===ce.key?"bg-sky-600 text-white border-sky-600 shadow-sm":"bg-white text-slate-700 border-slate-200 hover:bg-slate-50"),children:ce.label},ce.key))}),r.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[r.jsxs("div",{className:"flex flex-1 items-center gap-2 rounded-xl border border-slate-200 bg-white px-2.5 py-2 shadow-inner",children:[r.jsx(u_,{className:"w-4 h-4 text-slate-500 shrink-0"}),r.jsxs("div",{className:"flex flex-col gap-1 w-full text-[11px] text-slate-700 sm:flex-row sm:items-center",children:[r.jsxs("div",{className:"flex items-center gap-1 w-full",children:[r.jsx("span",{className:"hidden sm:inline",children:"From"}),r.jsx("input",{type:"date",value:s,onChange:ye(n),className:"w-full border border-slate-200 bg-slate-50 rounded px-1.5 py-0.5 text-[11px] text-slate-800 focus:outline-none focus:ring-1 focus:ring-sky-500"})]}),r.jsxs("div",{className:"flex items-center gap-1 w-full",children:[r.jsx("span",{className:"hidden sm:inline",children:"To"}),r.jsx("input",{type:"date",value:a,onChange:ye(i),className:"w-full border border-slate-200 bg-slate-50 rounded px-1.5 py-0.5 text-[11px] text-slate-800 focus:outline-none focus:ring-1 focus:ring-sky-500"})]})]})]}),r.jsxs(Nt.button,{onClick:pe,whileTap:{scale:.96},className:Pt("inline-flex items-center justify-center gap-2 rounded-xl","border border-sky-600 bg-sky-600 text-white shadow-sm","px-3 py-2 text-xs sm:text-sm font-medium w-full sm:w-auto","hover:bg-sky-500 hover:border-sky-500 transition-colors"),children:[r.jsx(hu,{className:"w-4 h-4"}),"Refresh"]})]})]})]}),r.jsx(Uc,{children:j&&r.jsx(Nt.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},children:r.jsxs(Vc,{variant:"destructive",children:[r.jsx(yn,{className:"h-4 w-4 mt-0.5"}),r.jsxs("div",{children:[r.jsx(Hc,{children:"Dashboard error"}),r.jsx(Wc,{children:j})]})]})})}),!b&&u&&X.length>0&&r.jsxs(Nt.div,{className:"rounded-2xl border border-slate-200 bg-white px-2.5 py-3 shadow-sm",variants:yR,initial:"hidden",animate:"visible",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2 px-1",children:[r.jsx("h2",{className:"text-xs font-semibold text-slate-700",children:"At a glance"}),r.jsx("span",{className:"h-px flex-1 bg-slate-200"})]}),r.jsx("div",{className:"flex flex-wrap gap-2",children:X.map(ce=>r.jsx(dRe,{pill:ce},ce.key))})]})]}),!A&&!b&&!j&&r.jsx(We,{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50/70",children:r.jsxs(qe,{className:"py-6 flex flex-col items-center text-center gap-2",children:[r.jsx(u_,{className:"w-8 h-8 text-slate-400 mb-1"}),r.jsx("p",{className:"text-sm font-medium text-slate-700",children:"Select a date range to see live dashboard data."}),r.jsxs("p",{className:"text-xs text-slate-500 max-w-xs",children:["Choose both ",r.jsx("span",{className:"font-semibold",children:"From"})," and"," ",r.jsx("span",{className:"font-semibold",children:"To"})," dates above. Well show patient, revenue, pharmacy and diagnostics insights."]})]})}),b&&A&&!u&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4",children:[r.jsx(Je,{className:"h-20 rounded-2xl"}),r.jsx(Je,{className:"h-20 rounded-2xl"}),r.jsx(Je,{className:"h-20 rounded-2xl"}),r.jsx(Je,{className:"h-20 rounded-2xl"})]}),r.jsx(Je,{className:"h-56 rounded-2xl"}),r.jsx(Je,{className:"h-56 rounded-2xl"})]}),!b&&A&&u&&r.jsx(Nt.div,{variants:yR,initial:"hidden",animate:"visible",className:"pb-4",children:r.jsxs(Hl,{value:c,onValueChange:d,className:"w-full",children:[r.jsx("div",{className:"flex justify-between items-center mb-2",children:r.jsx(ll,{className:"flex flex-nowrap overflow-x-auto gap-1 rounded-full bg-slate-100/80 p-1",children:oe.map(ce=>r.jsx(xs,{value:ce.key,className:"px-3 py-1.5 text-xs sm:text-sm rounded-full data-[state=active]:bg-white data-[state=active]:shadow-sm",children:ce.label},ce.key))})}),r.jsxs(fs,{value:"overview",className:"space-y-4 mt-2",children:[I.length>0&&r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Key metrics"}),r.jsx(Nt.div,{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4",variants:Bj,initial:"hidden",animate:"visible",children:I.map(ce=>r.jsx(Nt.div,{variants:Fj,whileHover:{y:-2,scale:1.01,boxShadow:"0 18px 35px rgba(15, 23, 42, 0.12)"},transition:{type:"spring",stiffness:220,damping:20},children:r.jsx($j,{widget:ce})},ce.code))})]}),r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Activity & revenue mix"}),r.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-3 md:gap-4",children:[B&&r.jsx(wr,{widget:B}),F&&r.jsx(wr,{widget:F})]})]})]}),r.jsxs(fs,{value:"clinical",className:"space-y-4 mt-2",children:[ee.length>0&&r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Clinical metrics"}),r.jsx(Nt.div,{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-4",variants:Bj,initial:"hidden",animate:"visible",children:ee.map(ce=>r.jsx(Nt.div,{variants:Fj,whileHover:{y:-2,scale:1.01,boxShadow:"0 18px 35px rgba(15, 23, 42, 0.12)"},transition:{type:"spring",stiffness:220,damping:20},children:r.jsx($j,{widget:ce})},ce.code))})]}),r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Patient flow & statuses"}),r.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-3 md:gap-4",children:[B&&r.jsx(wr,{widget:B}),V&&r.jsx(wr,{widget:V})]})]}),r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"IPD beds & admissions"}),r.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-3 md:gap-4",children:[L&&r.jsx(wr,{widget:L}),U&&r.jsx(wr,{widget:U})]})]}),ge&&r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Recent IPD admissions"}),r.jsx(vR,{widget:ge})]})]}),r.jsxs(fs,{value:"revenue",className:"space-y-4 mt-2",children:[ke.length>0&&r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Revenue KPIs"}),r.jsx(Nt.div,{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-4",variants:Bj,initial:"hidden",animate:"visible",children:ke.map(ce=>r.jsx(Nt.div,{variants:Fj,whileHover:{y:-2,scale:1.01,boxShadow:"0 18px 35px rgba(15, 23, 42, 0.12)"},transition:{type:"spring",stiffness:220,damping:20},children:r.jsx($j,{widget:ce})},ce.code))})]}),r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Revenue & payment mix"}),r.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-3 md:gap-4",children:[F&&r.jsx(wr,{widget:F}),z&&r.jsx(wr,{widget:z})]})]}),r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Billed vs pending & top tests"}),r.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-3 md:gap-4",children:[G&&r.jsx(wr,{widget:G}),W&&r.jsx(wr,{widget:W}),q&&r.jsx(wr,{widget:q})]})]}),se&&r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Top 10 medicines (by quantity)"}),r.jsx(wr,{widget:se})]})]}),r.jsxs(fs,{value:"operations",className:"space-y-4 mt-2",children:[r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Capacity & utilization"}),r.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-3 md:gap-4",children:[L&&r.jsx(wr,{widget:L}),B&&r.jsx(wr,{widget:B})]})]}),r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Pharmacy & diagnostics focus"}),r.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-3 md:gap-4",children:[se&&r.jsx(wr,{widget:se}),W&&r.jsx(wr,{widget:W}),q&&r.jsx(wr,{widget:q})]})]}),ge&&r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Latest IPD activity"}),r.jsx(vR,{widget:ge})]})]})]})})]})]})}function dRe({pill:t}){const{label:s,value:n,helper:a,icon:i,tone:l,suffix:o}=t,c={sky:"bg-sky-50 border-sky-100 text-sky-800",emerald:"bg-emerald-50 border-emerald-100 text-emerald-800",violet:"bg-violet-50 border-violet-100 text-violet-800",amber:"bg-amber-50 border-amber-100 text-amber-800",rose:"bg-rose-50 border-rose-100 text-rose-800"}[l||"sky"];return r.jsxs(Nt.div,{whileHover:{y:-2,scale:1.01},transition:{type:"spring",stiffness:260,damping:18},className:Pt("flex-1 min-w-[140px] sm:min-w-[160px] rounded-2xl border px-2.5 py-2","flex items-center gap-2 sm:gap-3 shadow-[0_8px_18px_rgba(15,23,42,0.04)]",c),children:[r.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-xl bg-white/70 text-slate-700 shadow-sm shrink-0",children:i&&r.jsx(i,{className:"w-4 h-4"})}),r.jsxs("div",{className:"space-y-0.5",children:[r.jsx("div",{className:"text-[10px] uppercase tracking-wide font-semibold opacity-90",children:s}),r.jsxs("div",{className:"text-base sm:text-lg font-semibold leading-tight",children:[typeof n=="number"?n.toLocaleString("en-IN",{maximumFractionDigits:o==="%"?1:0}):n,o&&r.jsx("span",{className:"ml-0.5 text-[10px]",children:o})]}),a&&r.jsx("div",{className:"text-[10px] leading-tight opacity-80",children:a})]})]})}function $j({widget:t}){const s=t.data,n=typeof s=="number"||typeof s=="string"?s:typeof s=="object"&&s!==null?s.value??s.total??s.amount??0:0,a=typeof n=="number"?n.toLocaleString("en-IN",{maximumFractionDigits:(t.code.includes("revenue"),0)}):n;return r.jsxs(We,{className:Pt("rounded-2xl shadow-sm overflow-hidden border border-slate-200 bg-white","hover:border-sky-200 transition-colors"),children:[r.jsxs(st,{className:"flex flex-row items-start justify-between space-y-0 pb-1",children:[r.jsxs(lt,{className:"text-sm font-medium text-slate-800 flex items-center gap-1.5",children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-400 shadow-[0_0_0_3px_rgba(52,211,153,0.35)]"}),t.title]}),r.jsx(Ge,{variant:"outline",className:"text-[9px] uppercase tracking-wide border-slate-200 text-slate-500",children:t.code})]}),r.jsxs(qe,{className:"pt-0",children:[r.jsx("div",{className:"text-2xl md:text-3xl font-semibold tracking-tight mt-1 text-slate-900",children:a}),t.description&&r.jsx("p",{className:"text-[11px] text-slate-500 mt-1",children:t.description})]})]})}function wr({widget:t}){var i,l,o;const s=((i=t.config)==null?void 0:i.chart_type)||"bar";if(s==="donut"){const c=t.data||{},d=[{label:"Occupied",value:c.occupied||0},{label:"Available",value:c.available||0}];return r.jsxs(We,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[r.jsxs(st,{className:"pb-2 flex flex-row items-center justify-between",children:[r.jsx(lt,{className:"text-base font-semibold text-slate-800",children:t.title}),r.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-500",children:"Snapshot"})]}),r.jsxs(qe,{className:"h-56 sm:h-64",children:[r.jsx(Ud,{width:"100%",height:"100%",children:r.jsxs(mC,{children:[r.jsx(V1,{dataKey:"value",data:d,innerRadius:50,outerRadius:80,paddingAngle:3,children:d.map((u,f)=>r.jsx(Dl,{fill:sc[f%sc.length]},`cell-${f}`))}),r.jsx(Wd,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12}})]})}),typeof c.occupancy_pct=="number"&&r.jsxs("p",{className:"text-xs text-slate-600 text-center mt-2",children:["Occupancy:"," ",r.jsxs("span",{className:"font-medium text-emerald-600",children:[c.occupancy_pct,"%"]})," ",r.jsxs("span",{className:"opacity-80",children:["(",c.occupied,"/",c.total," beds)"]})]})]})]})}if(s==="pie"){const c=Array.isArray(t.data)?t.data:[];return r.jsxs(We,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[r.jsxs(st,{className:"pb-2 flex flex-row items-center justify-between",children:[r.jsx(lt,{className:"text-base font-semibold text-slate-800",children:t.title}),r.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-500",children:"Distribution"})]}),r.jsx(qe,{className:"h-56 sm:h-64",children:c.length===0?r.jsx("p",{className:"text-sm text-slate-500 mt-4",children:"No data to display."}):r.jsx(Ud,{width:"100%",height:"100%",children:r.jsxs(mC,{children:[r.jsx(V1,{data:c,dataKey:"value",nameKey:"label",outerRadius:80,paddingAngle:3,labelLine:!1,label:d=>`${d.label}: ${d.value??0}`,children:c.map((d,u)=>r.jsx(Dl,{fill:sc[u%sc.length]},`cell-${u}`))}),r.jsx(Wd,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12}})]})})})]})}if(s==="multi_bar"){const c=Array.isArray(t.data)?t.data:[],d=((l=t.config)==null?void 0:l.series)||[],u=((o=t.config)==null?void 0:o.x_key)||"label";return r.jsxs(We,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[r.jsx(st,{className:"pb-2",children:r.jsx(lt,{className:"text-base font-semibold text-slate-800",children:t.title})}),r.jsx(qe,{className:"h-56 sm:h-64",children:c.length===0?r.jsx("p",{className:"text-sm text-slate-500 mt-4",children:"No data to display."}):r.jsx(Ud,{width:"100%",height:"100%",children:r.jsxs(Q1,{data:c,margin:{left:8,right:8,top:8,bottom:8},children:[r.jsx(ux,{dataKey:u,stroke:"#6b7280",fontSize:11}),r.jsx(hx,{stroke:"#6b7280",fontSize:11}),r.jsx(Wd,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12}}),d.map((f,m)=>r.jsx(dx,{dataKey:f.key,name:f.label,radius:[4,4,0,0],children:c.map((x,b)=>r.jsx(Dl,{fill:sc[(m+b)%sc.length]},`cell-${f.key}-${b}`))},f.key))]})})})]})}const n=Array.isArray(t.data)?t.data:[],a=n.length>0?n.map((c,d)=>({label:c.label??c.name??`Item ${d+1}`,value:c.value??c.amount??0})):[];return r.jsxs(We,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[r.jsxs(st,{className:"pb-2 flex flex-row items-center justify-between",children:[r.jsx(lt,{className:"text-base font-semibold text-slate-800",children:t.title}),r.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-500",children:t.description?"Insight":"Summary"})]}),r.jsx(qe,{className:"h-56 sm:h-64",children:a.length===0?r.jsx("p",{className:"text-sm text-slate-500 mt-4",children:"No data to display."}):r.jsx(Ud,{width:"100%",height:"100%",children:r.jsxs(Q1,{data:a,margin:{left:8,right:8,top:8,bottom:8},children:[r.jsx(ux,{dataKey:"label",stroke:"#6b7280",fontSize:11}),r.jsx(hx,{stroke:"#6b7280",fontSize:11}),r.jsx(Wd,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12}}),r.jsx(dx,{dataKey:"value",radius:[4,4,0,0],children:a.map((c,d)=>r.jsx(Dl,{fill:sc[d%sc.length]},`cell-${d}`))})]})})})]})}function vR({widget:t}){var a;const s=Array.isArray(t.data)?t.data:[],n=((a=t.config)==null?void 0:a.columns)||(s[0]?Object.keys(s[0]):[]);return r.jsxs(We,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[r.jsxs(st,{className:"pb-2 flex flex-row items-center justify-between",children:[r.jsx(lt,{className:"text-base font-semibold text-slate-800",children:t.title}),r.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-500",children:"Latest records"})]}),r.jsx(qe,{className:"space-y-2",children:s.length===0?r.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"No records found."}):r.jsx("div",{className:"flex flex-col gap-2",children:s.map((i,l)=>r.jsx("div",{className:Pt("rounded-xl border border-slate-200 bg-slate-50/60 px-3 py-2.5","flex flex-col gap-1 text-xs md:text-sm"),children:n.map((o,c)=>r.jsxs("div",{className:Pt("flex justify-between gap-2",c===0?"font-semibold text-slate-900":"text-slate-700"),children:[r.jsx("span",{className:"text-[10px] uppercase tracking-wide text-slate-500",children:o.replace(/_/g," ")}),r.jsx("span",{className:"text-right",children:uRe(i[o])})]},o))},l))})})]})}function uRe(t){return t==null?"-":typeof t=="number"?t.toLocaleString("en-IN",{maximumFractionDigits:1}):typeof t=="string"&&t.length>40?t.slice(0,40)+"":String(t)}function hRe(){return J.get("/mis/definitions")}function fRe(t,s){return J.post(`/mis/reports/${t}`,s)}const fg=["#0f172a","#0f766e","#1e293b","#475569","#64748b"];function ao(t){return t.toISOString().slice(0,10)}function wR(t,s){const n=new Date(t);return n.setDate(n.getDate()+s),n}function mRe(t){if(!t)return"";const s=t.value!==null&&t.value!==void 0?t.value:0;return`${t.label}: ${s}`}const pRe={hidden:{opacity:0,y:12},visible:{opacity:1,y:0,transition:{duration:.35,ease:"easeOut"}}},Am={hidden:{opacity:0,y:8},visible:(t=0)=>({opacity:1,y:0,transition:{duration:.3,ease:"easeOut",delay:t}})},NR={hidden:{},visible:{transition:{staggerChildren:.06}}},zj={hidden:{opacity:0,y:6,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{duration:.25,ease:"easeOut"}}};function xRe(){const t=new Date,[s,n]=y.useState(()=>ao(t)),[a,i]=y.useState(()=>ao(t)),[l,o]=y.useState([]),[c,d]=y.useState(!0),[u,f]=y.useState(""),[m,x]=y.useState({}),[b,w]=y.useState("today"),[j,_]=y.useState(null),[C,k]=y.useState(!1),[A,T]=y.useState(""),[P,R]=y.useState("summary"),I=!!(s&&a);y.useEffect(()=>{let ee=!0;return(async()=>{var ue,ye;d(!0),T("");try{const X=await hRe();if(!ee)return;const oe=(X==null?void 0:X.data)||[];o(oe),oe.length>0&&f(oe[0].code)}catch(X){if(console.error(X),!ee)return;T(((ye=(ue=X==null?void 0:X.response)==null?void 0:ue.data)==null?void 0:ye.detail)||"Failed to load MIS report definitions.")}finally{ee&&d(!1)}})(),()=>{ee=!1}},[]);const O=y.useMemo(()=>l.find(ee=>ee.code===u)||null,[l,u]),M=ee=>{w(ee);const pe=new Date;if(ee==="today"){const ue=ao(pe);n(ue),i(ue)}else if(ee==="7d")n(ao(wR(pe,-6))),i(ao(pe));else if(ee==="30d")n(ao(wR(pe,-29))),i(ao(pe));else if(ee==="month"){const ue=new Date(pe.getFullYear(),pe.getMonth(),1);n(ao(ue)),i(ao(pe))}else ee==="custom"&&w("custom")},B=ee=>pe=>{w("custom"),ee(pe.target.value)},L=(ee,pe)=>{x(ue=>({...ue,[ee]:pe}))},F=async()=>{var ee,pe;if(!u||!I){T("Please select a report and valid date range.");return}k(!0),T(""),_(null);try{const ye=await fRe(u,{date_from:s,date_to:a,filters:m});_((ye==null?void 0:ye.data)||null)}catch(ue){console.error(ue),T(((pe=(ee=ue==null?void 0:ue.response)==null?void 0:ee.data)==null?void 0:pe.detail)||"Failed to run MIS report. Please check filters and try again.")}finally{k(!1)}},V=y.useMemo(()=>j!=null&&j.cards&&Array.isArray(j.cards)?j.cards:[],[j]),U=y.useMemo(()=>j!=null&&j.charts&&Array.isArray(j.charts)?j.charts:[],[j]),z=(O==null?void 0:O.category)||"MIS",W=U.filter(ee=>ee.type==="bar"),q=U.filter(ee=>ee.type==="pie"),G=(O==null?void 0:O.name)||"No report selected",se=I?`${s}  ${a}`:"Select a date range",ge=C?"Running report":j?"Showing latest results":"Awaiting first run",ke=[{value:"summary",label:"Summary"},{value:"charts",label:"Charts"}];return j!=null&&j.table&&ke.push({value:"details",label:"Detailed view"}),r.jsx(Nt.div,{className:"relative min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-3 sm:px-4 sm:py-4 md:px-6 md:py-6 lg:px-8",variants:pRe,initial:"hidden",animate:"visible",children:r.jsxs("div",{className:"mx-auto w-full max-w-6xl space-y-4 md:space-y-5 lg:space-y-6",children:[r.jsxs(Nt.div,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-xs md:text-sm",custom:0,variants:Am,initial:"hidden",animate:"visible",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white px-3 py-1.5 text-slate-800 shadow-sm",children:[r.jsx(hse,{className:"w-4 h-4"}),r.jsx("span",{className:"font-medium",children:"MIS  Management Information System"})]}),r.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500 text-[11px]",children:[r.jsx("span",{className:"inline-flex h-1.5 w-1.5 rounded-full bg-emerald-500 animate-pulse"}),r.jsx("span",{className:"inline-flex md:hidden rounded-full bg-white px-2 py-0.5 uppercase tracking-wide border border-slate-200",children:"Mobile view"}),r.jsx("span",{className:"hidden md:inline-flex lg:hidden rounded-full bg-white px-2 py-0.5 uppercase tracking-wide border border-slate-200",children:"Tablet / Laptop"}),r.jsx("span",{className:"hidden lg:inline-flex rounded-full bg-white px-2 py-0.5 uppercase tracking-wide border border-slate-200",children:"Desktop workspace"})]})]}),r.jsx(Nt.div,{variants:Am,custom:.05,initial:"hidden",animate:"visible",children:r.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-r from-teal-700 via-teal-600 to-blue-600 text-white shadow-md",children:[r.jsx("div",{className:"absolute inset-0 opacity-20 pointer-events-none bg-[radial-gradient(circle_at_top,_#e0f2fe,_transparent_55%)]"}),r.jsxs("div",{className:"relative flex flex-col gap-4 md:flex-row md:items-center md:justify-between px-4 py-5 sm:px-6 sm:py-6 md:px-8 md:py-7 lg:px-10 lg:py-8",children:[r.jsxs("div",{className:"space-y-3 max-w-xl",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-white/10 px-3 py-1 text-xs font-medium backdrop-blur-sm border border-white/20",children:[r.jsx("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-white/20 text-[11px]",children:"MIS"}),"Clean, focused analytics for your hospital"]}),r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"inline-flex h-11 w-11 md:h-12 md:w-12 items-center justify-center rounded-3xl bg-white/10 text-white shadow-sm border border-white/20",children:r.jsx(Om,{className:"w-6 h-6"})}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("h1",{className:"text-xl md:text-2xl lg:text-3xl font-semibold tracking-tight",children:"MIS Reports Console"}),r.jsxs("p",{className:"text-sm md:text-base text-teal-50/90 leading-relaxed",children:["Generate"," ",r.jsx("span",{className:"font-semibold",children:"clinical, operational and financial"})," ","MIS reports in a light, distraction-free workspace."]})]})]}),(O==null?void 0:O.description)&&r.jsx("p",{className:"text-xs sm:text-sm text-teal-50/90",children:O.description})]}),r.jsxs("div",{className:"w-full md:w-auto space-y-3",children:[r.jsxs("div",{className:"flex flex-wrap gap-2 justify-start md:justify-end",children:[r.jsx(Ge,{className:"bg-white/15 text-xs font-semibold border border-white/25 text-white rounded-full px-3 py-1",children:"IPD / OPD Ready"}),r.jsx(Ge,{className:"bg-white/10 text-xs border border-white/20 text-teal-50 rounded-full px-3 py-1",children:"NABH-aligned KPIs"}),r.jsx(Ge,{className:"bg-white/10 text-xs border border-white/20 text-teal-50 rounded-full px-3 py-1",children:z})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 text-xs",children:[r.jsxs("div",{className:"rounded-2xl bg-white/10 px-3 py-2.5 flex flex-col gap-1 border border-white/15",children:[r.jsx("span",{className:"text-[11px] font-medium text-teal-50/80 uppercase tracking-wide",children:"Active report"}),r.jsx("span",{className:"text-sm font-semibold line-clamp-2",children:G})]}),r.jsxs("div",{className:"rounded-2xl bg-white/10 px-3 py-2.5 flex flex-col gap-1 border border-white/15",children:[r.jsx("span",{className:"text-[11px] font-medium text-teal-50/80 uppercase tracking-wide",children:"Date range"}),r.jsx("span",{className:"text-sm font-semibold",children:se})]}),r.jsxs("div",{className:"rounded-2xl bg-white/10 px-3 py-2.5 flex flex-col gap-1 border border-white/15",children:[r.jsx("span",{className:"text-[11px] font-medium text-teal-50/80 uppercase tracking-wide",children:"Status"}),r.jsxs("span",{className:"text-sm font-semibold flex items-center gap-1.5",children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-300 animate-pulse"}),ge]})]})]})]})]})]})}),r.jsx(Uc,{children:A&&r.jsx(Nt.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},children:r.jsxs(Vc,{className:"bg-red-50 border-red-200 text-red-800 rounded-2xl",children:[r.jsx(yn,{className:"h-4 w-4 mt-0.5"}),r.jsxs("div",{children:[r.jsx(Hc,{className:"text-red-900 font-semibold",children:"MIS error"}),r.jsx(Wc,{className:"text-red-800/90 text-sm",children:A})]})]})})}),r.jsxs(Nt.div,{variants:Am,custom:.1,initial:"hidden",animate:"visible",className:"grid gap-4 lg:gap-5 lg:grid-cols-[minmax(0,320px)_minmax(0,1fr)] xl:grid-cols-[minmax(0,340px)_minmax(0,1fr)]",children:[r.jsxs("div",{className:"space-y-3 lg:space-y-4 lg:sticky lg:top-24 self-start",children:[r.jsxs(We,{className:"rounded-2xl border border-slate-200 bg-white shadow-sm",children:[r.jsx(st,{className:"pb-2 flex flex-row items-center justify-between gap-2",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"h-8 w-8 rounded-xl bg-teal-600 text-white flex items-center justify-center",children:r.jsx(Om,{className:"w-4 h-4"})}),r.jsxs("div",{children:[r.jsx(lt,{className:"text-sm font-semibold text-slate-900",children:"Report & Date"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Choose MIS view and time window"})]})]})}),r.jsxs(qe,{className:"space-y-3 pb-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("span",{className:"text-xs font-medium text-slate-800",children:"Report"}),r.jsxs("span",{className:"text-[11px] text-slate-500 flex items-center gap-1",children:[r.jsx(Ei,{className:"w-3 h-3"}),"MIS group"]})]}),c?r.jsx(Je,{className:"h-9 rounded-xl bg-slate-100"}):r.jsxs(Ms,{value:u,onValueChange:ee=>{f(ee),_(null)},children:[r.jsx(Es,{className:"h-9 rounded-xl border-slate-200 bg-white text-xs text-slate-900 focus:ring-teal-200",children:r.jsx(Ds,{placeholder:"Select report"})}),r.jsx(Ts,{className:"bg-white border-slate-200 text-slate-900 max-h-72",children:l.map(ee=>r.jsx(Mt,{value:String(ee.code),className:"text-xs",children:ee.name},ee.code))})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs font-medium text-slate-800",children:"Quick ranges"}),r.jsx("div",{className:"flex flex-wrap gap-1.5",children:[{key:"today",label:"Today"},{key:"7d",label:"Last 7 days"},{key:"30d",label:"Last 30 days"},{key:"month",label:"This month"},{key:"custom",label:"Custom"}].map(ee=>r.jsx("button",{type:"button",onClick:()=>M(ee.key),className:Pt("px-3 py-1 rounded-full text-[11px] font-medium border transition-colors",b===ee.key?"bg-blue-600 text-white border-blue-600":"bg-white text-slate-700 border-slate-200 hover:bg-slate-50"),children:ee.label},ee.key))})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("span",{className:"text-xs font-medium text-slate-800",children:"Custom date range"}),r.jsx("div",{className:"flex flex-col gap-2",children:r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-2.5 py-2",children:[r.jsx(u_,{className:"w-4 h-4 text-slate-500 shrink-0"}),r.jsxs("div",{className:"flex flex-col gap-2 w-full text-xs text-slate-800",children:[r.jsxs("div",{className:"flex items-center gap-2 w-full",children:[r.jsx("span",{className:"w-10 text-[11px] text-slate-500",children:"From"}),r.jsx(Ee,{type:"date",value:s,onChange:B(n),className:"h-8 w-full rounded-lg border-slate-200 bg-slate-50 text-xs text-slate-900"})]}),r.jsxs("div",{className:"flex items-center gap-2 w-full",children:[r.jsx("span",{className:"w-10 text-[11px] text-slate-500",children:"To"}),r.jsx(Ee,{type:"date",value:a,onChange:B(i),className:"h-8 w-full rounded-lg border-slate-200 bg-slate-50 text-xs text-slate-900"})]})]})]})})]}),r.jsx("div",{className:"pt-1",children:r.jsx(Re,{size:"sm",className:"h-9 w-full rounded-full inline-flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold text-sm",onClick:F,disabled:C||!u||!I,children:C?r.jsxs(r.Fragment,{children:[r.jsx(hu,{className:"w-4 h-4 animate-spin"}),"Running report"]}):r.jsxs(r.Fragment,{children:[r.jsx(hu,{className:"w-4 h-4"}),"Run MIS report"]})})})]})]}),O&&Array.isArray(O.filters)&&O.filters.length>0&&r.jsxs(We,{className:"rounded-2xl border border-slate-200 bg-white shadow-sm",children:[r.jsxs(st,{className:"pb-2 flex flex-row items-center justify-between gap-2",children:[r.jsxs(lt,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:[r.jsx(Ei,{className:"w-4 h-4 text-slate-500"}),"Advanced filters"]}),r.jsx("span",{className:"text-[11px] text-slate-500",children:"Tailor output for this report"})]}),r.jsx(qe,{className:"pb-3",children:r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:O.filters.map(ee=>ee.type==="select"&&Array.isArray(ee.options)?r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("span",{className:"text-xs font-medium text-slate-800",children:ee.label}),ee.required&&r.jsx("span",{className:"text-[11px] text-rose-500",children:"*"})]}),r.jsxs(Ms,{value:m[ee.key]!==void 0?String(m[ee.key]):"",onValueChange:pe=>L(ee.key,pe),children:[r.jsx(Es,{className:"h-9 rounded-xl border-slate-200 bg-slate-50 text-xs text-slate-900",children:r.jsx(Ds,{placeholder:`All ${ee.label.toLowerCase()}`})}),r.jsxs(Ts,{className:"bg-white border-slate-200 text-slate-900 max-h-64",children:[r.jsx(Mt,{value:"__ALL__",className:"text-xs text-slate-500",children:"All"}),ee.options.map(pe=>r.jsx(Mt,{value:String(pe.value),className:"text-xs",children:pe.label},pe.value))]})]})]},ee.key):r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("span",{className:"text-xs font-medium text-slate-800",children:ee.label}),ee.required&&r.jsx("span",{className:"text-[11px] text-rose-500",children:"*"})]}),r.jsx(Ee,{value:m[ee.key]??"",onChange:pe=>L(ee.key,pe.target.value),placeholder:`Filter by ${ee.label.toLowerCase()}`,className:"h-9 rounded-xl border-slate-200 bg-slate-50 text-xs text-slate-900 placeholder:text-slate-400"})]},ee.key))})})]})]}),r.jsxs("div",{className:"space-y-3 lg:space-y-4",children:[!C&&!j&&r.jsx(We,{className:"rounded-2xl border border-dashed border-slate-300 bg-white shadow-none",children:r.jsxs(qe,{className:"py-10 px-4 sm:px-8 flex flex-col items-center justify-center text-center gap-3",children:[r.jsx("div",{className:"h-12 w-12 rounded-full bg-slate-100 flex items-center justify-center border border-slate-200 mb-1",children:r.jsx(Om,{className:"w-6 h-6 text-slate-700"})}),r.jsx("h2",{className:"text-base md:text-lg font-semibold text-slate-900",children:"Run your first MIS report"}),r.jsxs("p",{className:"text-sm text-slate-600 max-w-md",children:["Select a report on the left, choose a date range, add filters if needed and click"," ",r.jsx("span",{className:"font-semibold text-slate-900",children:"Run MIS report"})," ","to see KPIs, charts and detailed records."]})]})}),C&&r.jsxs(Nt.div,{className:"space-y-4",variants:Am,custom:.15,initial:"hidden",animate:"visible",children:[r.jsx(Je,{className:"h-16 rounded-2xl bg-white/80"}),r.jsx(Je,{className:"h-64 rounded-2xl bg-white/80"}),r.jsx(Je,{className:"h-64 rounded-2xl bg-white/80"})]}),!C&&j&&r.jsx(Nt.div,{variants:Am,custom:.15,initial:"hidden",animate:"visible",children:r.jsxs(Hl,{value:P,onValueChange:R,className:"w-full",children:[r.jsx("div",{className:"sticky top-[4.25rem] z-10 mb-2 bg-slate-50/95 backdrop-blur-sm border-b border-slate-200/80 pb-2 md:hidden",children:r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("span",{className:"text-[11px] text-slate-600 font-medium",children:"Section"}),r.jsx("div",{className:"relative",children:r.jsx("select",{className:"w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500",value:P,onChange:ee=>R(ee.target.value),children:ke.map(ee=>r.jsx("option",{value:ee.value,children:ee.label},ee.value))})})]})}),r.jsxs("div",{className:"hidden md:flex md:flex-row md:items-center md:justify-between gap-2 mb-2",children:[r.jsx(ll,{className:"flex flex-nowrap overflow-x-auto gap-1 rounded-full bg-slate-100 p-1 border border-slate-200",children:ke.map(ee=>r.jsx(xs,{value:ee.value,className:"px-3 py-1.5 text-xs sm:text-sm rounded-full data-[state=active]:bg-white data-[state=active]:text-slate-900 data-[state=active]:shadow-sm",children:ee.label},ee.value))}),r.jsxs("div",{className:"hidden md:flex items-center gap-2 text-xs text-slate-500",children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 animate-pulse"}),r.jsxs("span",{children:["Generated for"," ",r.jsx("span",{className:"font-semibold text-slate-800",children:j.name})]})]})]}),r.jsxs(fs,{value:"summary",className:"space-y-4 mt-2",children:[V.length>0&&r.jsxs("section",{className:"space-y-2",children:[r.jsxs("h2",{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:[r.jsx("span",{className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-slate-100 text-slate-700 border border-slate-200",children:r.jsx(Om,{className:"w-3 h-3"})}),"Key indicators"]}),r.jsx(Nt.div,{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 md:gap-4",variants:NR,initial:"hidden",animate:"visible",children:V.map((ee,pe)=>r.jsx(Nt.div,{variants:zj,children:r.jsx(gRe,{card:ee})},pe))})]}),W[0]&&r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"Primary trend"}),r.jsx(Uj,{chart:W[0]})]})]}),r.jsx(fs,{value:"charts",className:"space-y-4 mt-2",children:r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"Chart views"}),r.jsxs(Nt.div,{className:"grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-3 md:gap-4",variants:NR,initial:"hidden",animate:"visible",children:[W.map(ee=>r.jsx(Nt.div,{variants:zj,children:r.jsx(Uj,{chart:ee})},ee.code)),q.map(ee=>r.jsx(Nt.div,{variants:zj,children:r.jsx(Uj,{chart:ee})},ee.code))]})]})}),j.table&&r.jsx(fs,{value:"details",className:"space-y-4 mt-2",children:r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"Detailed records"}),r.jsx(yRe,{table:j.table})]})})]})})]})]})]})})}function gRe({card:t}){return r.jsxs(Nt.div,{whileHover:{y:-2,scale:1.01},transition:{type:"spring",stiffness:240,damping:22},className:Pt("rounded-2xl border border-slate-200 bg-white px-4 py-3 shadow-sm","flex flex-col gap-1.5"),children:[r.jsx("div",{className:"text-[11px] uppercase tracking-wide font-semibold text-slate-500",children:t.label}),r.jsx("div",{className:"text-xl md:text-2xl font-semibold leading-tight text-slate-900",children:typeof t.value=="number"?t.value.toLocaleString("en-IN",{maximumFractionDigits:1}):t.value}),t.helper&&r.jsx("div",{className:"text-xs text-slate-500",children:t.helper})]})}function Uj({chart:t}){const s=t.type||"bar",n=Array.isArray(t.data)?t.data:[],a=t.config||{};if(s==="pie"){const l=n.length>0?n.map((o,c)=>({label:o.label??o.name??`Item ${c+1}`,value:o.value??o.amount??0})):[];return r.jsxs(We,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[r.jsxs(st,{className:"pb-2 flex flex-row items-center justify-between",children:[r.jsx(lt,{className:"text-base font-semibold text-slate-900",children:t.title}),r.jsx("span",{className:"rounded-full bg-slate-50 px-2 py-0.5 text-[11px] text-slate-600 border border-slate-200",children:"Distribution"})]}),r.jsx(qe,{className:"h-56 sm:h-64",children:l.length===0?r.jsx("p",{className:"text-sm text-slate-500 mt-4",children:"No data to display."}):r.jsx(Ud,{width:"100%",height:"100%",children:r.jsxs(mC,{children:[r.jsx(V1,{data:l,dataKey:"value",nameKey:"label",outerRadius:80,paddingAngle:3,labelLine:!1,label:mRe,children:l.map((o,c)=>r.jsx(Dl,{fill:fg[c%fg.length]},`cell-${c}`))}),r.jsx(Wd,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12,color:"#111827"}})]})})})]})}const i=n.length>0?n.map((l,o)=>({label:l.label??l.name??`Item ${o+1}`,value:l.value??l.amount??0})):[];return r.jsxs(We,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[r.jsxs(st,{className:"pb-2 flex flex-row items-center justify-between",children:[r.jsx(lt,{className:"text-base font-semibold text-slate-900",children:t.title}),r.jsx("span",{className:"rounded-full bg-slate-50 px-2 py-0.5 text-[11px] text-slate-600 border border-slate-200",children:(a==null?void 0:a.label)||"Trend"})]}),r.jsx(qe,{className:"h-56 sm:h-64",children:i.length===0?r.jsx("p",{className:"text-sm text-slate-500 mt-4",children:"No data to display."}):r.jsx(Ud,{width:"100%",height:"100%",children:r.jsxs(Q1,{data:i,margin:{left:8,right:8,top:8,bottom:8},children:[r.jsx(ux,{dataKey:"label",stroke:"#9ca3af",fontSize:11,tickLine:!1,axisLine:{stroke:"#e5e7eb"}}),r.jsx(hx,{stroke:"#9ca3af",fontSize:11,tickLine:!1,axisLine:{stroke:"#e5e7eb"}}),r.jsx(Wd,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12,color:"#111827"}}),r.jsx(dx,{dataKey:"value",radius:[4,4,0,0],children:i.map((l,o)=>r.jsx(Dl,{fill:fg[o%fg.length]},`cell-${o}`))})]})})})]})}function yRe({table:t}){const s=Array.isArray(t.rows)?t.rows:[],n=t.columns&&t.columns.length>0?t.columns:s[0]?Object.keys(s[0]):[],[a,i]=y.useState(""),[l,o]=y.useState("all");if(s.length===0)return r.jsx(We,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:r.jsx(qe,{className:"py-6 flex items-center justify-center",children:r.jsx("p",{className:"text-sm text-slate-500",children:"No records found."})})});const c=[{key:"all",label:"All"},{key:"nonZero",label:"Non-zero values"}],d=s.filter(f=>!(a&&!Object.values(f).map(x=>x==null?"":String(x)).join(" ").toLowerCase().includes(a.toLowerCase())||l==="nonZero"&&!Object.values(f).some(x=>typeof x=="number"&&x>0))),u=()=>{const f=n.join(","),m=d.map(j=>n.map(_=>{const C=j[_],k=C==null?"":String(C);return k.includes(",")||k.includes('"')||k.includes(`
`)?`"${k.replace(/"/g,'""')}"`:k}).join(",")).join(`
`),x=new Blob([f+`
`+m],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(x),w=document.createElement("a");w.href=b,w.download="mis-report.csv",w.click(),URL.revokeObjectURL(b)};return r.jsx(We,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:r.jsxs(qe,{className:"py-3 flex flex-col gap-3 max-h-[520px] md:max-h-[560px] overflow-hidden",children:[r.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"relative w-full sm:w-64",children:[r.jsx(is,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),r.jsx("input",{type:"text",value:a,onChange:f=>i(f.target.value),placeholder:"Search in records",className:"w-full rounded-xl border border-slate-200 bg-white pl-9 pr-3 py-2 text-sm text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500"})]}),r.jsx("div",{className:"flex flex-wrap gap-1.5",children:c.map(f=>r.jsx("button",{type:"button",onClick:()=>o(f.key),className:Pt("inline-flex items-center rounded-full px-3 py-1 text-xs sm:text-sm transition",l===f.key?"bg-blue-600 text-white shadow-sm":"bg-slate-100 text-slate-600 hover:bg-slate-200"),children:f.label},f.key))})]}),r.jsx("div",{className:"flex justify-start sm:justify-end",children:r.jsxs(Re,{type:"button",onClick:u,className:"inline-flex items-center gap-2 rounded-full bg-blue-600 px-4 py-2 text-xs sm:text-sm font-semibold text-white hover:bg-blue-700 active:scale-95 transition",children:[r.jsx(Ll,{className:"w-4 h-4"}),"Export CSV"]})})]}),r.jsxs("div",{className:"mt-1 flex-1 overflow-y-auto pr-1.5",children:[r.jsx("div",{className:"hidden md:block",children:r.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200",children:r.jsxs("table",{className:"min-w-full text-xs md:text-sm bg-white",children:[r.jsx("thead",{className:"bg-slate-50 sticky top-0 z-10",children:r.jsx("tr",{children:n.map(f=>r.jsx("th",{className:"px-3 py-2 text-left text-[11px] font-medium uppercase tracking-wide text-slate-600 border-b border-slate-200",children:f.replace(/_/g," ")},f))})}),r.jsx("tbody",{children:d.map((f,m)=>r.jsx("tr",{className:"border-t border-slate-100 hover:bg-slate-50/80 transition-colors",children:n.map((x,b)=>r.jsx("td",{className:Pt("px-3 py-2 text-[11px] md:text-sm text-slate-800 align-top",b===0&&"font-semibold text-slate-900"),children:r.jsx("span",{className:"line-clamp-2",children:jR(f[x])})},x))},m))})]})})}),r.jsx("div",{className:"grid gap-3 md:hidden mt-1",children:r.jsx(Uc,{children:d.map((f,m)=>r.jsx(Nt.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},transition:{duration:.2,ease:"easeOut"},className:"rounded-2xl border border-slate-200 bg-white px-3 py-2.5 shadow-sm flex flex-col gap-1",children:n.map((x,b)=>r.jsxs("div",{className:Pt("flex justify-between gap-2",b===0?"font-semibold text-slate-900":"text-slate-700"),children:[r.jsx("span",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:x.replace(/_/g," ")}),r.jsx("span",{className:"text-xs text-right truncate max-w-[60%]",children:jR(f[x])})]},x))},m))})})]})]})})}function jR(t){return t==null?"":typeof t=="number"?t.toLocaleString("en-IN",{maximumFractionDigits:1}):typeof t=="string"&&t.length>80?t.slice(0,80)+"":String(t)}const CG=t=>{let s={};return typeof t=="string"?t&&(s.q=t):t&&typeof t=="object"&&(s=t),J.get("/patients",{params:s})};function bRe(t){return J.get(`/patients/${t}`)}function vRe(t){return J.post("/patients",t)}function wRe(t,s){return J.put(`/patients/${t}`,s)}function NRe(t){return J.patch(`/patients/${t}/deactivate`)}function jRe(t,{type:s,file:n}){const a=new FormData;return a.append("type",s||"other"),a.append("file",n),J.post(`/patients/${t}/documents`,a,{headers:{"Content-Type":"multipart/form-data"}})}function _Re(t){return J.get(`/patients/${t}/documents`)}function SRe(t){return J.get(`/patients/${t}/consents`)}function CRe(t,s){return J.post(`/patients/${t}/consents`,s)}async function kRe(t){const s=await J.get(`/patients/${t}/print-info`,{responseType:"blob"}),n=s.headers["content-type"]||"application/octet-stream",a=new Blob([s.data],{type:n}),i=URL.createObjectURL(a);window.open(i,"_blank")}function ARe(){return J.get("/patient-masters/all")}function ERe(t){return J.get("/patients/export",{params:t,responseType:"blob"})}function TRe(t,s={}){const n={table_name:"patients",record_id:t,...s};return J.get("/audit-logs",{params:n})}const PRe=["","A+","A-","B+","B-","O+","O-","AB+","AB-"],IRe=["","Single","Married","Widowed","Divorced"],MRe=["","Mr","Ms","Mrs","Dr","Baby","Master"],DRe=[{code:"OPD",name:"OPD"},{code:"IPD",name:"IPD"},{code:"EMERGENCY",name:"Emergency"},{code:"HEALTH_CHECK",name:"Health Check"},{code:"CAMP",name:"Camp"},{code:"CORPORATE",name:"Corporate"},{code:"INSURANCE",name:"Insurance"}],ORe=["","insurance","corporate","govt","other"],RRe={prefix:"",first_name:"",last_name:"",gender:"",dob:"",phone:"",email:"",blood_group:"",marital_status:"",ref_source:"",ref_doctor_id:"",ref_details:"",id_proof_type:"",id_proof_no:"",guardian_name:"",guardian_phone:"",guardian_relation:"",patient_type:"",tag:"",religion:"",occupation:"",file_number:"",file_location:"",credit_type:"",credit_payer_id:"",credit_tpa_id:"",credit_plan_id:"",principal_member_name:"",principal_member_address:"",policy_number:"",policy_name:"",family_id:"",address:{type:"current",line1:"",line2:"",city:"",state:"",pincode:"",country:"India"}};function pC(){return JSON.parse(JSON.stringify(RRe))}function LRe(t){if(!t)return pC();const s=t.addresses&&t.addresses[0]||null;return{prefix:t.prefix||"",first_name:t.first_name||"",last_name:t.last_name||"",gender:t.gender||"",dob:t.dob||"",phone:t.phone||"",email:t.email||"",blood_group:t.blood_group||"",marital_status:t.marital_status||"",ref_source:t.ref_source||"",ref_doctor_id:t.ref_doctor_id||"",ref_details:t.ref_details||"",id_proof_type:t.id_proof_type||"",id_proof_no:t.id_proof_no||"",guardian_name:t.guardian_name||"",guardian_phone:t.guardian_phone||"",guardian_relation:t.guardian_relation||"",patient_type:t.patient_type||"",tag:t.tag||"",religion:t.religion||"",occupation:t.occupation||"",file_number:t.file_number||"",file_location:t.file_location||"",credit_type:t.credit_type||"",credit_payer_id:t.credit_payer_id||"",credit_tpa_id:t.credit_tpa_id||"",credit_plan_id:t.credit_plan_id||"",principal_member_name:t.principal_member_name||"",principal_member_address:t.principal_member_address||"",policy_number:t.policy_number||"",policy_name:t.policy_name||"",family_id:t.family_id||"",address:{type:(s==null?void 0:s.type)||"current",line1:(s==null?void 0:s.line1)||"",line2:(s==null?void 0:s.line2)||"",city:(s==null?void 0:s.city)||"",state:(s==null?void 0:s.state)||"",pincode:(s==null?void 0:s.pincode)||"",country:(s==null?void 0:s.country)||"India"}}}function Em(t){if(t==null||t==="")return null;const s=Number(t);return Number.isNaN(s)?null:s}function BRe(t){var i,l,o;let s="Failed to save patient";const n={},a=(l=(i=t==null?void 0:t.response)==null?void 0:i.data)==null?void 0:l.detail;if(Array.isArray(a)){s="Please correct the highlighted fields.";for(const c of a){const d=c.loc||[],u=c.msg||"Invalid value";if(d[0]==="body"&&d.length>=2)if(d[1]==="address"&&d[2]){const f=`address.${d[2]}`;n[f]=n[f]?`${n[f]}; ${u}`:u}else{const f=d[1];n[f]=n[f]?`${n[f]}; ${u}`:u}}!Object.keys(n).length&&((o=a[0])!=null&&o.msg)&&(s=a[0].msg)}else typeof a=="string"?s=a:a&&typeof a=="object"&&a.msg?s=a.msg:t!=null&&t.message&&(s=t.message);return{generalMessage:s,fieldErrors:n}}function FRe({open:t,onClose:s,onSaved:n,initialPatient:a,lookups:i}){const[l,o]=y.useState(pC),[c,d]=y.useState(!1),[u,f]=y.useState(""),[m,x]=y.useState({}),b=y.useMemo(()=>a?"edit":"create",[a]);if(y.useEffect(()=>{t&&(f(""),x({}),o(a?LRe(a):pC()))},[t,a]),!t)return null;const w=L=>F=>{let V=F.target.value;L==="phone"&&(V=V.replace(/\D/g,"").slice(0,10)),o(U=>({...U,[L]:V})),x(U=>{const z={...U};return delete z[L],z})},j=L=>F=>{const V=F.target.value;o(U=>({...U,address:{...U.address,[L]:V}})),x(U=>{const z=`address.${L}`,W={...U};return delete W[z],W})},_=async L=>{var F;L.preventDefault(),f(""),x({}),d(!0);try{const V={...l,ref_doctor_id:Em(l.ref_doctor_id),credit_payer_id:Em(l.credit_payer_id),credit_tpa_id:Em(l.credit_tpa_id),credit_plan_id:Em(l.credit_plan_id),family_id:Em(l.family_id),credit_type:l.credit_type||null,patient_type:l.patient_type||null};let U;b==="create"?U=await vRe(V):U=await wRe(a.id,V),n&&n(U.data),s&&s()}catch(V){console.error("Patient save error:",((F=V==null?void 0:V.response)==null?void 0:F.data)||V);const{generalMessage:U,fieldErrors:z}=BRe(V);f(U),x(z)}finally{d(!1)}},{refSources:C,doctors:k,payers:A,tpas:T,creditPlans:P,patientTypes:R}=i||{},I=R&&R.length?R:DRe,O=L=>!!m[L],M=L=>m[L]?r.jsx("p",{className:"mt-0.5 text-[11px] text-red-600",children:m[L]}):null,B="w-full rounded-xl border px-3 py-2 text-sm text-slate-800 bg-white focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500";return r.jsx("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black/40 backdrop-blur-sm",onClick:s,children:r.jsxs("div",{className:"w-full bg-white rounded-t-3xl sm:rounded-3xl shadow-2xl max-h-[90vh] sm:max-h-[90vh] sm:max-w-5xl mx-auto overflow-hidden flex flex-col",onClick:L=>L.stopPropagation(),children:[r.jsxs("div",{className:"px-4 sm:px-6 py-3 border-b border-slate-200 flex items-center justify-between",children:[r.jsxs("div",{className:"space-y-0.5",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("h2",{className:"text-base sm:text-lg font-semibold text-slate-900",children:b==="create"?"New Patient":"Edit Patient"}),r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-900/5 px-2 py-0.5 text-[11px] font-medium text-slate-700",children:b==="create"?"Create":"Update"}),(a==null?void 0:a.uhid)&&r.jsxs("span",{className:"inline-flex items-center rounded-full bg-slate-50 px-2 py-0.5 text-[11px] font-mono text-slate-700 border border-slate-200",children:["UHID: ",a.uhid]})]}),r.jsx("p",{className:"text-xs text-slate-500",children:"Fill basic details, address and credit / insurance information."})]}),r.jsx("button",{type:"button",onClick:s,className:"h-8 w-8 flex items-center justify-center rounded-full hover:bg-slate-100 text-slate-500 hover:text-slate-900 text-lg leading-none",children:""})]}),r.jsxs("form",{onSubmit:_,className:"flex-1 flex flex-col overflow-hidden bg-slate-50/80",children:[r.jsxs("div",{className:"flex-1 overflow-y-auto px-4 sm:px-6 py-4 space-y-5",children:[u&&r.jsx("div",{className:"rounded-2xl border border-red-200 bg-red-50/80 px-3 py-2 text-xs sm:text-sm text-red-700",children:u}),r.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-3",children:[r.jsx("div",{className:"flex items-center justify-between gap-2",children:r.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Basic Information"})}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:["Prefix",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("select",{className:`${B} ${O("prefix")?"border-red-300":"border-slate-200"}`,value:l.prefix,onChange:w("prefix"),required:!0,children:MRe.map(L=>r.jsx("option",{value:L,children:L||"Select"},L))}),M("prefix")]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:["First Name",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{className:`${B} ${O("first_name")?"border-red-300":"border-slate-200"}`,value:l.first_name,onChange:w("first_name"),required:!0}),M("first_name")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Last Name"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.last_name,onChange:w("last_name")})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:["Gender",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{className:`${B} ${O("gender")?"border-red-300":"border-slate-200"}`,value:l.gender,onChange:w("gender"),required:!0,children:[r.jsx("option",{value:"",children:"Select"}),r.jsx("option",{value:"male",children:"Male"}),r.jsx("option",{value:"female",children:"Female"}),r.jsx("option",{value:"other",children:"Other"})]}),M("gender")]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:["Date of Birth",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"date",className:`${B} ${O("dob")?"border-red-300":"border-slate-200"}`,value:l.dob||"",onChange:w("dob"),required:!0}),M("dob")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Blood Group"}),r.jsx("select",{className:`${B} border-slate-200`,value:l.blood_group,onChange:w("blood_group"),children:PRe.map(L=>r.jsx("option",{value:L,children:L||"Select"},L))})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:["Marital Status",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("select",{className:`${B} ${O("marital_status")?"border-red-300":"border-slate-200"}`,value:l.marital_status,onChange:w("marital_status"),required:!0,children:IRe.map(L=>r.jsx("option",{value:L,children:L||"Select"},L))}),M("marital_status")]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:["Mobile",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{className:`${B} ${O("phone")?"border-red-300":"border-slate-200"}`,value:l.phone,onChange:w("phone"),required:!0}),r.jsx("p",{className:"mt-0.5 text-[11px] text-slate-400",children:"10 digit mobile number"}),M("phone")]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:["Email",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"email",className:`${B} ${O("email")?"border-red-300":"border-slate-200"}`,value:l.email,onChange:w("email"),required:!0}),M("email")]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:["Patient Type",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{className:`${B} ${O("patient_type")?"border-red-300":"border-slate-200"}`,value:l.patient_type||"",onChange:w("patient_type"),required:!0,children:[r.jsx("option",{value:"",children:"Select"}),I.map(L=>r.jsx("option",{value:L.code||L.name,children:L.name||L.code},L.code||L.name))]}),M("patient_type")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Tag"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.tag,onChange:w("tag")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Religion"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.religion,onChange:w("religion")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Occupation"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.occupation,onChange:w("occupation")})]})]})]}),r.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-3",children:[r.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Reference & Guardian"}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Reference Source"}),r.jsxs("select",{className:`${B} border-slate-200`,value:l.ref_source,onChange:w("ref_source"),children:[r.jsx("option",{value:"",children:"Select"}),C==null?void 0:C.map(L=>r.jsx("option",{value:L.code,children:L.label},L.code))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Referring Doctor"}),r.jsxs("select",{className:`${B} border-slate-200`,value:l.ref_doctor_id||"",onChange:w("ref_doctor_id"),children:[r.jsx("option",{value:"",children:"Select"}),k==null?void 0:k.map(L=>r.jsxs("option",{value:L.id,children:[L.name,L.department_name?` (${L.department_name})`:""]},L.id))]})]}),r.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Reference Details"}),r.jsx("textarea",{rows:2,className:`${B} border-slate-200 min-h-[72px]`,value:l.ref_details,onChange:w("ref_details")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Guardian Name"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.guardian_name,onChange:w("guardian_name")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Guardian Phone"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.guardian_phone,onChange:w("guardian_phone")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Guardian Relation"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.guardian_relation,onChange:w("guardian_relation")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"ID Proof Type"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.id_proof_type,onChange:w("id_proof_type")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"ID Proof No"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.id_proof_no,onChange:w("id_proof_no")})]})]})]}),r.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-3",children:[r.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Address"}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[r.jsxs("div",{className:"sm:col-span-2",children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Address Line 1"}),r.jsx("input",{className:`${B} ${O("address.line1")?"border-red-300":"border-slate-200"}`,value:l.address.line1,onChange:j("line1")}),M("address.line1")]}),r.jsxs("div",{className:"sm:col-span-2",children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Address Line 2"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.address.line2,onChange:j("line2")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"City"}),r.jsx("input",{className:`${B} ${O("address.city")?"border-red-300":"border-slate-200"}`,value:l.address.city,onChange:j("city")}),M("address.city")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"State"}),r.jsx("input",{className:`${B} ${O("address.state")?"border-red-300":"border-slate-200"}`,value:l.address.state,onChange:j("state")}),M("address.state")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Pincode"}),r.jsx("input",{className:`${B} ${O("address.pincode")?"border-red-300":"border-slate-200"}`,value:l.address.pincode,onChange:j("pincode")}),M("address.pincode")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Country"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.address.country,onChange:j("country")})]})]})]}),r.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-3",children:[r.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"File & Credit / Insurance"}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"File Number"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.file_number,onChange:w("file_number")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"File Location"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.file_location,onChange:w("file_location")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Credit Type"}),r.jsx("select",{className:`${B} border-slate-200`,value:l.credit_type,onChange:w("credit_type"),children:ORe.map(L=>r.jsx("option",{value:L,children:L||"Select"},L))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Payer"}),r.jsxs("select",{className:`${B} border-slate-200`,value:l.credit_payer_id||"",onChange:w("credit_payer_id"),children:[r.jsx("option",{value:"",children:"Select"}),A==null?void 0:A.map(L=>r.jsx("option",{value:L.id,children:L.display_name||L.name},L.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"TPA"}),r.jsxs("select",{className:`${B} border-slate-200`,value:l.credit_tpa_id||"",onChange:w("credit_tpa_id"),children:[r.jsx("option",{value:"",children:"Select"}),T==null?void 0:T.map(L=>r.jsx("option",{value:L.id,children:L.display_name||L.name},L.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Credit Plan"}),r.jsxs("select",{className:`${B} border-slate-200`,value:l.credit_plan_id||"",onChange:w("credit_plan_id"),children:[r.jsx("option",{value:"",children:"Select"}),P==null?void 0:P.map(L=>r.jsx("option",{value:L.id,children:L.name},L.id))]})]}),r.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Principal Member Name"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.principal_member_name,onChange:w("principal_member_name")})]}),r.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Principal Member Address"}),r.jsx("textarea",{rows:2,className:`${B} border-slate-200 min-h-[72px]`,value:l.principal_member_address,onChange:w("principal_member_address")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Policy Number"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.policy_number,onChange:w("policy_number")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Policy Name"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.policy_name,onChange:w("policy_name")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Family ID"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.family_id,onChange:w("family_id")})]})]})]})]}),r.jsxs("div",{className:"border-t border-slate-200 px-4 sm:px-6 py-3 bg-white flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-2",children:[r.jsxs("p",{className:"text-[11px] text-slate-500",children:["Fields marked with ",r.jsx("span",{className:"text-red-500",children:"*"})," are mandatory."]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx("button",{type:"button",onClick:s,className:"inline-flex items-center justify-center rounded-full border border-slate-200 px-3 py-1.5 text-sm font-semibold text-slate-700 hover:bg-slate-50 transition disabled:opacity-60",disabled:c,children:"Cancel"}),r.jsx("button",{type:"submit",className:"inline-flex items-center justify-center rounded-full bg-blue-600 px-4 py-1.5 text-sm font-semibold text-white shadow-sm hover:bg-blue-700 active:scale-95 transition disabled:opacity-60",disabled:c,children:c?b==="create"?"Creating...":"Saving...":b==="create"?"Create Patient":"Save Changes"})]})]})]})]})})}function Js(t){return t||""}function $Re(t){return t?{doctor:"Doctor",google:"Google",social_media:"Social Media",ads:"Advertisements",other:"Other"}[t]||t:""}function _R(t){if(t==null)return"";if(typeof t=="string"){const s=t.trim();return s?s.length>24?`${s.slice(0,24)}`:s:""}if(typeof t=="number"||typeof t=="boolean")return String(t);try{const s=JSON.stringify(t);return s.length>24?`${s.slice(0,24)}`:s}catch{return""}}function zRe(t){const s=(t==null?void 0:t.old_values)||{},n=(t==null?void 0:t.new_values)||{},a=Array.from(new Set([...Object.keys(s||{}),...Object.keys(n||{})])),i=[];for(const l of a){const o=s?s[l]:void 0,c=n?n[l]:void 0,d=o===void 0?void 0:JSON.stringify(o),u=c===void 0?void 0:JSON.stringify(c);d!==u&&i.push({field:l,before:o,after:c})}return i}function URe({open:t,onClose:s,patient:n,onUpdated:a}){const[i,l]=y.useState(null),[o,c]=y.useState([]),[d,u]=y.useState([]),[f,m]=y.useState([]),[x,b]=y.useState(!1),[w,j]=y.useState(!1),[_,C]=y.useState(!1),[k,A]=y.useState(!1),[T,P]=y.useState(""),[R,I]=y.useState(null),[O,M]=y.useState("other"),[B,L]=y.useState(""),[F,V]=y.useState(""),[U,z]=y.useState(""),[W,q]=y.useState(""),[G,se]=y.useState("idle"),[ge,ke]=y.useState(null),[ee,pe]=y.useState(""),[ue,ye]=y.useState("");y.useEffect(()=>{t&&n&&X(n.id)},[t,n==null?void 0:n.id]);const X=async be=>{var ne,me;b(!0),P("");try{const[Ne,Be,jt]=await Promise.all([bRe(be),_Re(be),SRe(be)]);l(Ne.data),c(Be.data||[]),u(jt.data||[]),a&&a(Ne.data)}catch(Ne){const Be=((me=(ne=Ne==null?void 0:Ne.response)==null?void 0:ne.data)==null?void 0:me.detail)||(Ne==null?void 0:Ne.message)||"Failed to load patient details";P(Be)}finally{b(!1)}A(!0);try{const Ne=await TRe(be,{limit:30});m(Ne.data||[])}catch{}finally{A(!1)}};if(!t||!n)return null;const oe=i||n,_e=oe.addresses&&oe.addresses[0]||null,ce=oe.age_text||"",he=async be=>{var ne,me;if(be.preventDefault(),!!R){j(!0),P("");try{const Ne=await jRe(oe.id,{type:O,file:R});c(Be=>[Ne.data,...Be]),I(null),M("other")}catch(Ne){const Be=((me=(ne=Ne==null?void 0:Ne.response)==null?void 0:ne.data)==null?void 0:me.detail)||(Ne==null?void 0:Ne.message)||"Failed to upload document";P(Be)}finally{j(!1)}}},fe=async be=>{var ne,me;if(be.preventDefault(),!(!B||!F)){C(!0),P("");try{const Ne=await CRe(oe.id,{type:B,text:F});u(Be=>[Ne.data,...Be]),L(""),V("")}catch(Ne){const Be=((me=(ne=Ne==null?void 0:Ne.response)==null?void 0:ne.data)==null?void 0:me.detail)||(Ne==null?void 0:Ne.message)||"Failed to save consent";P(Be)}finally{C(!1)}}},le=async()=>{var be,ne;P("");try{await kRe(oe.id)}catch(me){const Ne=((ne=(be=me==null?void 0:me.response)==null?void 0:be.data)==null?void 0:ne.detail)||(me==null?void 0:me.message)||"Failed to open print view";P(Ne)}},Ve=async be=>{var ne,me;P("");try{const Ne=await J.get(`/patients/documents/${be.id}/file`,{responseType:"blob"}),Be=Ne.data,jt=Ne.headers["content-type"]||be.mime||be.content_type||be.mime_type||"",yt=URL.createObjectURL(jt?new Blob([Be],{type:jt}):Be);ke(be),pe(yt),ye(jt)}catch(Ne){const Be=((me=(ne=Ne==null?void 0:Ne.response)==null?void 0:ne.data)==null?void 0:me.detail)||(Ne==null?void 0:Ne.message)||"Failed to load attachment for preview";P(Be)}},Ke=()=>{ee&&URL.revokeObjectURL(ee),ke(null),pe(""),ye("")},wt=async be=>{var ne,me;P("");try{const Ne=await J.get(`/patients/documents/${be.id}/file`,{responseType:"blob"}),Be=Ne.data,jt=Ne.headers["content-type"]||be.mime||be.content_type||be.mime_type||"application/octet-stream",yt=URL.createObjectURL(jt?new Blob([Be],{type:jt}):Be),pt=document.createElement("a");pt.href=yt,pt.download=be.filename||"document",document.body.appendChild(pt),pt.click(),pt.remove(),URL.revokeObjectURL(yt)}catch(Ne){const Be=((me=(ne=Ne==null?void 0:Ne.response)==null?void 0:ne.data)==null?void 0:me.detail)||(Ne==null?void 0:Ne.message)||"Failed to download attachment";P(Be)}},mt=ge&&((ue==null?void 0:ue.startsWith("image/"))||/\.(png|jpe?g|gif|webp|bmp)$/i.test(ge.filename||"")),rt=ge&&(ue==="application/pdf"||/\.pdf$/i.test(ge.filename||"")),bt="inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium";return r.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black/40 backdrop-blur-sm",onClick:s,children:[r.jsxs("div",{className:"w-full bg-white rounded-t-3xl sm:rounded-3xl shadow-2xl max-h-[90vh] sm:max-h-[90vh] sm:max-w-5xl mx-auto overflow-hidden flex flex-col",onClick:be=>be.stopPropagation(),children:[r.jsxs("div",{className:"px-4 sm:px-6 py-3 border-b border-slate-200 flex items-center justify-between",children:[r.jsx("div",{className:"space-y-0.5",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"h-8 w-8 rounded-full bg-teal-600 text-white flex items-center justify-center shadow-sm",children:r.jsx(on,{className:"h-4 w-4"})}),r.jsxs("div",{children:[r.jsxs("h2",{className:"text-base sm:text-lg font-semibold text-slate-900",children:[oe.first_name," ",oe.last_name||""]}),r.jsxs("p",{className:"text-[11px] sm:text-xs text-slate-500",children:["UHID: ",oe.uhid,"  Age: ",ce||""]})]})]})}),r.jsxs("div",{className:"flex items-center gap-2",children:[oe.patient_type&&r.jsx("span",{className:`${bt} bg-slate-900/5 text-slate-800 border border-slate-200`,children:oe.patient_type}),oe.tag&&r.jsx("span",{className:`${bt} bg-emerald-50 text-emerald-700 border border-emerald-100`,children:oe.tag}),r.jsx("button",{type:"button",onClick:s,className:"h-8 w-8 flex items-center justify-center rounded-full hover:bg-slate-100 text-slate-500 hover:text-slate-900 text-lg leading-none",children:""})]})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto px-4 sm:px-6 py-4 space-y-4 bg-slate-50/80",children:[x&&r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-3 text-xs sm:text-sm text-slate-500 shadow-sm",children:"Loading patient details"}),T&&r.jsx("div",{className:"rounded-2xl border border-red-200 bg-red-50/80 px-3 py-2 text-xs sm:text-sm text-red-700",children:T}),r.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-3 flex flex-wrap gap-2 items-center",children:[r.jsxs("button",{type:"button",onClick:le,className:"inline-flex items-center gap-1.5 rounded-full bg-blue-600 px-4 py-1.5 text-xs sm:text-sm font-semibold text-white shadow-sm hover:bg-blue-700 active:scale-95 transition",children:[r.jsx(My,{className:"h-4 w-4"}),r.jsx("span",{children:"Print Info / PDF"})]}),r.jsxs("span",{className:"text-[11px] text-slate-500 flex items-center gap-1",children:[r.jsx(Aa,{className:"h-3.5 w-3.5 text-emerald-500"}),"Patient profile & audit-ready."]})]}),r.jsxs("section",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[r.jsx(tl,{className:"h-4 w-4 text-slate-500"}),r.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Patient Info"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-1.5 text-[11px] sm:text-xs",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-slate-600",children:"Gender: "}),r.jsx("span",{className:"font-semibold text-slate-800",children:Js(oe.gender)})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-slate-600",children:"DOB: "}),r.jsx("span",{className:"font-semibold text-slate-800",children:oe.dob||""})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-slate-600",children:"Age: "}),r.jsx("span",{className:"font-semibold text-slate-800",children:ce||""})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Blood Group:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:Js(oe.blood_group)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Marital Status:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:Js(oe.marital_status)})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-slate-600",children:"Mobile: "}),r.jsx("span",{className:"font-semibold text-slate-800",children:Js(oe.phone)})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsx("span",{className:"font-medium text-slate-600",children:"Email: "}),r.jsx("span",{className:"font-semibold text-slate-800",children:Js(oe.email)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Patient Type:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:Js(oe.patient_type)})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-slate-600",children:"Tag: "}),r.jsx("span",{className:"font-semibold text-slate-800",children:Js(oe.tag)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Religion:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:Js(oe.religion)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Occupation:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:Js(oe.occupation)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["File No:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:Js(oe.file_number)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["File Location:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:Js(oe.file_location)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Guardian:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:Js(oe.guardian_name)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Guardian Phone:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:Js(oe.guardian_phone)})]})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[r.jsx(Aa,{className:"h-4 w-4 text-slate-500"}),r.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Reference & Credit / Insurance"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-1.5 text-[11px] sm:text-xs",children:[r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Reference Source:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:$Re(oe.ref_source)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Referring Doctor:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:Js(oe.ref_doctor_name)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Credit Type:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:Js(oe.credit_type)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Payer:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:Js(oe.credit_payer_name)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["TPA:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:Js(oe.credit_tpa_name)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Credit Plan:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:Js(oe.credit_plan_name)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Policy Number:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:Js(oe.policy_number)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Policy Name:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:Js(oe.policy_name)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Principal Member:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:Js(oe.principal_member_name)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Family ID:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:Js(oe.family_id)})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Principal Member Address:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:Js(oe.principal_member_address)})]})]})]}),r.jsxs("div",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[r.jsx(tl,{className:"h-4 w-4 text-slate-500"}),r.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Address"})]}),r.jsx("p",{className:"text-xs sm:text-sm text-slate-700",children:_e?r.jsxs(r.Fragment,{children:[_e.line1,r.jsx("br",{}),_e.line2&&r.jsxs(r.Fragment,{children:[_e.line2,r.jsx("br",{})]}),[_e.city,_e.state,_e.pincode].filter(Boolean).join(", "),r.jsx("br",{}),_e.country]}):""})]})]})]}),r.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-3",children:[r.jsx("div",{className:"flex items-center justify-between gap-2",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(_se,{className:"h-4 w-4 text-slate-500"}),r.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Attachments"})]})}),r.jsxs("form",{onSubmit:he,className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 text-xs",children:[r.jsxs("select",{className:"rounded-xl border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500",value:O,onChange:be=>M(be.target.value),children:[r.jsx("option",{value:"other",children:"Other"}),r.jsx("option",{value:"id_proof",children:"ID Proof"}),r.jsx("option",{value:"report",children:"Report"}),r.jsx("option",{value:"photo",children:"Photo"})]}),r.jsx("input",{type:"file",className:"flex-1 text-xs text-slate-700 file:mr-2 file:rounded-full file:border-0 file:bg-slate-900 file:px-3 file:py-1.5 file:text-xs file:font-semibold file:text-white hover:file:bg-slate-800",onChange:be=>I(be.target.files[0]||null)}),r.jsxs("button",{type:"submit",disabled:w||!R,className:"inline-flex items-center justify-center gap-1.5 rounded-full bg-blue-600 px-3 py-1.5 text-[11px] font-semibold text-white shadow-sm hover:bg-blue-700 disabled:opacity-60 active:scale-95 transition",children:[r.jsx(pse,{className:"h-3.5 w-3.5"}),w?"Uploading":"Upload"]})]}),r.jsxs("ul",{className:"divide-y border border-slate-200 rounded-2xl bg-slate-50/80",children:[o.length===0&&r.jsxs("li",{className:"text-xs text-slate-500 px-3 py-3 flex items-center gap-2",children:[r.jsx(Dg,{className:"h-4 w-4 text-slate-300"}),r.jsx("span",{children:"No attachments yet."})]}),o.map(be=>r.jsxs("li",{className:"px-3 py-2 text-xs flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"min-w-0",children:[r.jsx("div",{className:"font-medium text-slate-800 truncate",children:be.filename}),r.jsxs("div",{className:"text-[10px] text-slate-500",children:[be.type||"other"," "," ",be.size?`${(be.size/1024).toFixed(1)} KB`:""]})]}),r.jsxs("div",{className:"flex items-center gap-1.5 shrink-0",children:[r.jsx("button",{type:"button",onClick:()=>Ve(be),className:"inline-flex items-center rounded-full border border-slate-200 bg-white px-2.5 py-1 text-[11px] font-semibold text-slate-700 hover:bg-slate-50 transition",children:"Preview"}),r.jsxs("button",{type:"button",onClick:()=>wt(be),className:"inline-flex items-center gap-1 rounded-full bg-slate-900 px-2.5 py-1 text-[11px] font-semibold text-white hover:bg-slate-800 transition",children:[r.jsx(Ll,{className:"h-3.5 w-3.5"}),"Download"]})]})]},be.id))]})]}),r.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(tl,{className:"h-4 w-4 text-slate-500"}),r.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Consents"})]}),r.jsxs("form",{onSubmit:fe,className:"space-y-2 text-xs",children:[r.jsx("div",{className:"flex flex-col sm:flex-row gap-2",children:r.jsx("input",{className:"flex-1 rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-800 focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500",placeholder:"Consent type (e.g. General, Surgery)",value:B,onChange:be=>L(be.target.value)})}),r.jsx("textarea",{rows:2,className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-800 focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500",placeholder:"Consent text",value:F,onChange:be=>V(be.target.value)}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{type:"submit",disabled:_||!B||!F,className:"inline-flex items-center justify-center rounded-full bg-blue-600 px-4 py-1.5 text-xs sm:text-sm font-semibold text-white shadow-sm hover:bg-blue-700 disabled:opacity-60 active:scale-95 transition",children:_?"Saving":"Add Consent"})})]}),r.jsxs("ul",{className:"divide-y border border-slate-200 rounded-2xl bg-slate-50/80",children:[d.length===0&&r.jsxs("li",{className:"text-xs text-slate-500 px-3 py-3 flex items-center gap-2",children:[r.jsx(Dg,{className:"h-4 w-4 text-slate-300"}),r.jsx("span",{children:"No consents captured yet."})]}),d.map(be=>r.jsxs("li",{className:"px-3 py-2 text-xs",children:[r.jsx("div",{className:"font-semibold text-slate-800",children:be.type}),r.jsx("div",{className:"text-[11px] text-slate-500 mb-0.5",children:new Date(be.captured_at).toLocaleString()}),r.jsx("div",{className:"text-xs text-slate-800 whitespace-pre-line",children:be.text})]},be.id))]})]}),r.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(sn,{className:"h-4 w-4 text-slate-500"}),r.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Activity / Audit Trail"})]}),r.jsx("div",{className:"text-[11px] text-slate-500",children:k?"Loading":f.length?`Latest ${f.length} change${f.length>1?"s":""}`:"No history yet"})]}),f.length===0&&!k&&r.jsxs("div",{className:"rounded-xl border border-slate-100 bg-slate-50 px-3 py-2 text-[11px] text-slate-500 flex items-center gap-2",children:[r.jsx(Dg,{className:"h-4 w-4 text-slate-300"}),r.jsx("span",{children:"No change history captured yet for this patient."})]}),f.length>0&&r.jsx("ol",{className:"space-y-2",children:f.map(be=>{const ne=zRe(be),me=ne.length>3?ne.length-3:0,Ne=be.user_name||be.user_email||(be.user_id?`User #${be.user_id}`:"System"),Be=be.created_at?new Date(be.created_at).toLocaleString():"";return r.jsxs("li",{className:"flex gap-2",children:[r.jsxs("div",{className:"flex flex-col items-center pt-1",children:[r.jsx("div",{className:"h-2 w-2 rounded-full bg-teal-600"}),r.jsx("div",{className:"mt-1 flex-1 w-px bg-slate-200"})]}),r.jsxs("div",{className:"flex-1 rounded-2xl border border-slate-200 bg-slate-50/80 px-2.5 py-2",children:[r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-1",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 text-[11px]",children:[r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-900 text-white px-1.5 py-0.5 text-[10px] tracking-wide",children:be.action||"UPDATE"}),r.jsx("span",{className:"text-slate-700",children:Ne})]}),Be&&r.jsx("div",{className:"text-[10px] text-slate-500",children:Be})]}),ne.length>0&&r.jsxs("ul",{className:"mt-1.5 space-y-0.5 text-[11px] text-slate-700",children:[ne.slice(0,3).map(jt=>r.jsxs("li",{className:"flex flex-wrap gap-1",children:[r.jsx("span",{className:"font-medium",children:jt.field}),r.jsx("span",{className:"text-slate-500",children:"changed"}),r.jsx("span",{className:"line-through text-slate-400",children:_R(jt.before)}),r.jsx("span",{className:"mx-1 text-slate-400",children:""}),r.jsx("span",{className:"font-medium",children:_R(jt.after)})]},jt.field)),me>0&&r.jsxs("li",{className:"text-[10px] text-slate-500",children:["+",me," more field",me>1?"s":""," updated"]})]}),ne.length===0&&(be.old_values||be.new_values)&&r.jsx("p",{className:"mt-1.5 text-[11px] text-slate-600",children:"Multiple fields updated."}),(be.ip_address||be.user_agent)&&r.jsxs("p",{className:"mt-1 text-[10px] text-slate-400",children:[be.ip_address&&r.jsxs("span",{children:["IP: ",be.ip_address]}),be.ip_address&&be.user_agent&&r.jsx("span",{className:"mx-1",children:""}),be.user_agent&&r.jsx("span",{className:"line-clamp-1",children:be.user_agent})]})]})]},be.id)})})]})]})]}),ge&&r.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm",onClick:Ke,children:r.jsxs("div",{className:"relative w-full max-w-3xl h-[80vh] bg-white rounded-2xl shadow-2xl flex flex-col overflow-hidden",onClick:be=>be.stopPropagation(),children:[r.jsxs("div",{className:"px-4 py-2 border-b border-slate-200 flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"text-sm font-semibold text-slate-900",children:["Preview  ",ge.filename]}),r.jsx("p",{className:"text-[11px] text-slate-500",children:ue||"Unknown type"})]}),r.jsx("button",{type:"button",onClick:Ke,className:"h-8 w-8 flex items-center justify-center rounded-full hover:bg-slate-100 text-slate-500 hover:text-slate-900 text-lg leading-none",children:""})]}),r.jsxs("div",{className:"flex-1 bg-slate-50 flex items-center justify-center",children:[mt&&r.jsx("img",{src:ee,alt:ge.filename,className:"max-h-full max-w-full object-contain"}),rt&&r.jsx("iframe",{src:ee,title:ge.filename,className:"w-full h-full"}),!mt&&!rt&&r.jsxs("div",{className:"text-xs text-slate-600 px-4 text-center space-y-2",children:[r.jsx("p",{children:"This file type cannot be previewed inline."}),r.jsxs("button",{type:"button",onClick:()=>wt(ge),className:"inline-flex items-center gap-1 rounded-full bg-slate-900 px-3 py-1.5 text-xs font-semibold text-white hover:bg-slate-800",children:[r.jsx(Ll,{className:"h-3.5 w-3.5"}),"Download file"]})]})]})]})})]})}function VRe(){const[t,s]=y.useState([]),[n,a]=y.useState(!1),[i,l]=y.useState(""),[o,c]=y.useState(!1),[d,u]=y.useState(!1),[f,m]=y.useState(null),[x,b]=y.useState(null),[w,j]=y.useState({refSources:[],doctors:[],payers:[],tpas:[],creditPlans:[],patientTypes:[]}),[_,C]=y.useState(""),[k,A]=y.useState(""),[T,P]=y.useState(""),[R,I]=y.useState(""),[O,M]=y.useState(!1);y.useEffect(()=>{B(),L()},[]);const B=async(ee=i,pe=k)=>{var ue,ye;a(!0),C("");try{const X={};ee&&(X.q=ee),pe&&(X.patient_type=pe);const oe=await CG(X);s(oe.data||[])}catch(X){const oe=((ye=(ue=X==null?void 0:X.response)==null?void 0:ue.data)==null?void 0:ye.detail)||(X==null?void 0:X.message)||"Failed to load patients";C(oe),ie.error("Failed to load patients",{description:oe})}finally{a(!1)}},L=async()=>{try{const pe=(await ARe()).data||{};j({refSources:pe.reference_sources||[],doctors:pe.doctors||[],payers:pe.payers||[],tpas:pe.tpas||[],creditPlans:pe.credit_plans||[],patientTypes:pe.patient_types||[]})}catch{}},F=ee=>{ee.preventDefault(),B(i)},V=ee=>{A(ee),B(i,ee)},U=()=>{A(""),l(""),B("","")},z=()=>{b(null),c(!0)},W=ee=>{b(ee),c(!0)},q=ee=>{m(ee),u(!0)},G=async ee=>{var pe,ue;if(window.confirm(`Deactivate patient ${ee.first_name}?`))try{await NRe(ee.id),ie.success("Patient deactivated successfully."),await B()}catch(ye){const X=((ue=(pe=ye==null?void 0:ye.response)==null?void 0:pe.data)==null?void 0:ue.detail)||(ye==null?void 0:ye.message)||"Failed to deactivate patient";ie.error("Failed to deactivate patient",{description:X})}},se=ee=>{s(pe=>{const ue=pe.findIndex(X=>X.id===ee.id);if(ue===-1)return pe;const ye=[...pe];return ye[ue]=ee,ye})},ge=async()=>{var ee,pe;if(!T||!R){ie.warning("Please select From and To date for Excel export.");return}if(R<T){ie.warning("To Date must be on or after From Date.");return}M(!0);try{const ue={from_date:T,to_date:R};k&&(ue.patient_type=k);const ye=await ERe(ue),X=new Blob([ye.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),oe=window.URL.createObjectURL(X),_e=document.createElement("a");_e.href=oe,_e.download=`patients_${T}_to_${R}.xlsx`,document.body.appendChild(_e),_e.click(),_e.remove(),window.URL.revokeObjectURL(oe),ie.success("Patient Excel report downloaded.")}catch(ue){const ye=((pe=(ee=ue==null?void 0:ue.response)==null?void 0:ee.data)==null?void 0:pe.detail)||(ue==null?void 0:ue.message)||"Failed to export Excel.";ie.error("Failed to export Excel.",{description:ye})}finally{M(!1)}},ke=y.useMemo(()=>w.patientTypes||[],[w.patientTypes]);return r.jsxs("div",{className:"h-full w-full flex flex-col gap-4 lg:gap-5 px-3 py-3 sm:px-5 sm:py-4 bg-slate-50/80",children:[r.jsx("div",{className:"rounded-3xl bg-gradient-to-r from-teal-700 via-teal-600 to-teal-500 text-white shadow-md px-4 py-4 sm:px-6 sm:py-5",children:r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-white/10 px-2.5 py-1 text-xs",children:[r.jsx(Fc,{className:"w-4 h-4"}),r.jsx("span",{className:"font-medium tracking-tight",children:"Patient Registry"})]}),r.jsx("h1",{className:"text-lg sm:text-xl font-semibold tracking-tight",children:"Patient Management"}),r.jsx("p",{className:"text-xs sm:text-sm text-teal-100/90 max-w-xl",children:"Register new patients, manage demographics, consents, and credit/insurance details in a single unified profile."})]}),r.jsxs("div",{className:"flex flex-wrap gap-2 sm:justify-end",children:[r.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full bg-white/10 px-2.5 py-1 text-[11px]",children:[r.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-300"}),"IPD / OPD ready"]}),r.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full bg-white/10 px-2.5 py-1 text-[11px]",children:[r.jsx("span",{className:"h-2 w-2 rounded-full bg-sky-300"}),"NABH-aligned registry"]})]})]})}),r.jsxs("div",{className:"flex flex-col gap-3 rounded-3xl bg-white shadow-sm border border-slate-200 px-3 py-3 sm:px-4 sm:py-3",children:[r.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("form",{onSubmit:F,className:"w-full flex items-center gap-2",children:[r.jsxs("div",{className:"relative w-full sm:w-64",children:[r.jsx(is,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),r.jsx("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-8 py-2 text-sm text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500",placeholder:"Search by UHID, name, mobile, email...",value:i,onChange:ee=>l(ee.target.value)})]}),r.jsx("button",{type:"submit",className:"hidden sm:inline-flex items-center justify-center rounded-full border border-slate-200 bg-slate-50 px-3 py-1.5 text-xs font-semibold text-slate-700 hover:bg-slate-100 transition duration-150",children:"Search"})]}),r.jsxs("div",{className:"flex items-center justify-between sm:justify-end gap-2",children:[r.jsx("button",{type:"button",onClick:U,className:"inline-flex items-center justify-center rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs font-semibold text-slate-600 hover:bg-slate-50 transition",children:"Reset"}),r.jsxs("button",{type:"button",onClick:z,className:"inline-flex items-center justify-center gap-1.5 rounded-full bg-blue-600 px-4 py-1.5 text-xs sm:text-sm font-semibold text-white shadow-sm hover:bg-blue-700 active:scale-95 transition duration-150",children:[r.jsx(us,{className:"h-4 w-4"}),r.jsx("span",{children:"New Patient"})]})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-500",children:"Filter by patient type:"}),r.jsx("button",{type:"button",onClick:()=>V(""),className:["inline-flex items-center rounded-full px-3 py-1 text-xs sm:text-sm transition",k===""?"bg-blue-600 text-white shadow-sm":"bg-slate-100 text-slate-600 hover:bg-slate-200"].join(" "),children:"All"}),ke.map(ee=>{const pe=ee.code||ee.name,ue=ee.name||ee.code;return r.jsx("button",{type:"button",onClick:()=>V(pe),className:["inline-flex items-center rounded-full px-3 py-1 text-xs sm:text-sm transition",k===pe?"bg-blue-600 text-white shadow-sm":"bg-slate-100 text-slate-600 hover:bg-slate-200"].join(" "),children:ue},pe)})]})]}),r.jsx("div",{className:"flex flex-col lg:flex-row gap-3 lg:items-center lg:justify-between",children:r.jsxs("div",{className:"rounded-3xl bg-white shadow-sm border border-slate-200 px-3 py-3 sm:px-4 sm:py-3 flex flex-col sm:flex-row sm:items-end gap-3",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700 mb-1",children:"From Date"}),r.jsx("input",{type:"date",className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500",value:T,onChange:ee=>P(ee.target.value)})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700 mb-1",children:"To Date"}),r.jsx("input",{type:"date",className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500",value:R,onChange:ee=>I(ee.target.value)})]}),r.jsxs("button",{type:"button",onClick:ge,disabled:O,className:"inline-flex items-center justify-center gap-1.5 rounded-full bg-emerald-600 px-4 py-2 text-xs sm:text-sm font-semibold text-white shadow-sm hover:bg-emerald-700 disabled:opacity-60 disabled:cursor-not-allowed transition",children:[r.jsx(ise,{className:"h-4 w-4"}),O?"Exporting":"Export Excel"]})]})}),_&&r.jsxs("div",{className:"rounded-2xl border border-red-200 bg-red-50/80 px-3 py-2 sm:px-4 sm:py-3 text-xs sm:text-sm text-red-700 flex items-start gap-2",children:[r.jsx(yn,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("div",{className:"font-semibold",children:"Unable to load patients"}),r.jsx("div",{className:"text-[11px] sm:text-xs",children:_})]})]}),r.jsx("div",{className:"hidden md:flex flex-1",children:r.jsx("div",{className:"w-full rounded-3xl border border-slate-200 bg-white shadow-sm overflow-hidden",children:r.jsx("div",{className:"overflow-auto max-h-[calc(100vh-280px)]",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-slate-50 border-b border-slate-200 sticky top-0 z-10",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left text-[11px] font-medium text-slate-600 uppercase",children:"UHID / Name"}),r.jsx("th",{className:"px-3 py-2 text-left text-[11px] font-medium text-slate-600 uppercase",children:"Demographics"}),r.jsx("th",{className:"px-3 py-2 text-left text-[11px] font-medium text-slate-600 uppercase",children:"Contact"}),r.jsx("th",{className:"px-3 py-2 text-left text-[11px] font-medium text-slate-600 uppercase",children:"Tags"}),r.jsx("th",{className:"px-3 py-2 text-right text-[11px] font-medium text-slate-600 uppercase",children:"Actions"})]})}),r.jsxs("tbody",{children:[n&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-3 py-6 text-center text-sm text-slate-500",children:"Loading patients"})}),!n&&t.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-3 py-6 text-center text-sm text-slate-500",children:r.jsxs("div",{className:"flex flex-col items-center gap-1.5",children:[r.jsx(Dg,{className:"h-6 w-6 text-slate-300"}),r.jsx("div",{className:"font-medium text-slate-600",children:"No patients found."}),r.jsx("p",{className:"text-[11px] text-slate-400",children:"Adjust search or filters, or click New Patient to create the first record."})]})})}),!n&&t.map((ee,pe)=>r.jsxs("tr",{className:`border-t border-slate-100 hover:bg-slate-50/70 transition ${pe%2===1?"bg-slate-50/30":""}`,children:[r.jsxs("td",{className:"px-3 py-2 align-top",children:[r.jsxs("div",{className:"font-semibold text-slate-900",children:[ee.first_name," ",ee.last_name||""]}),r.jsxs("div",{className:"flex items-center gap-1 text-[11px] text-slate-500",children:[r.jsx("span",{className:"font-mono bg-slate-100 px-1.5 py-0.5 rounded-full border border-slate-200",children:ee.uhid}),r.jsx("span",{className:"text-slate-400",children:""}),r.jsxs("span",{children:["Age: ",ee.age_text||""]})]})]}),r.jsxs("td",{className:"px-3 py-2 align-top text-xs text-slate-700",children:[r.jsxs("div",{children:["Gender: ",ee.gender]}),r.jsxs("div",{children:["Blood group: ",ee.blood_group||""]}),r.jsxs("div",{children:["Marital status: ",ee.marital_status||""]})]}),r.jsxs("td",{className:"px-3 py-2 align-top text-xs text-slate-700",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(x4,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsx("span",{children:ee.phone||""})]}),r.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[r.jsx(Zh,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsx("span",{className:"truncate max-w-[180px] text-[11px]",children:ee.email||""})]})]}),r.jsx("td",{className:"px-3 py-2 align-top text-xs text-slate-700",children:r.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[ee.patient_type&&r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-100 border border-slate-200 px-2 py-0.5 text-[11px] text-slate-800",children:[r.jsx(Rm,{className:"h-3 w-3 text-slate-400"}),ee.patient_type]}),ee.tag&&r.jsx("span",{className:"inline-flex items-center gap-1 rounded-full bg-emerald-50 border border-emerald-100 px-2 py-0.5 text-[11px] text-emerald-700",children:ee.tag})]})}),r.jsx("td",{className:"px-3 py-2 align-top text-right text-xs",children:r.jsxs("div",{className:"flex justify-end gap-1.5",children:[r.jsx("button",{type:"button",onClick:()=>q(ee),className:"inline-flex items-center rounded-full border border-slate-200 px-2.5 py-1 text-[11px] font-semibold text-slate-700 hover:bg-slate-50 transition",children:"View"}),r.jsx("button",{type:"button",onClick:()=>W(ee),className:"inline-flex items-center rounded-full border border-slate-200 px-2.5 py-1 text-[11px] font-semibold text-slate-700 hover:bg-slate-50 transition",children:"Edit"}),r.jsx("button",{type:"button",onClick:()=>G(ee),className:"inline-flex items-center rounded-full border border-rose-200 px-2.5 py-1 text-[11px] font-semibold text-rose-700 hover:bg-rose-50 transition",children:"Deactivate"})]})})]},ee.id))]})]})})})}),r.jsxs("div",{className:"md:hidden flex-1",children:[n&&r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-4 text-center text-sm text-slate-500 shadow-sm",children:"Loading patients"}),!n&&t.length===0&&r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-4 py-5 text-center text-sm text-slate-500 shadow-sm flex flex-col items-center gap-1.5",children:[r.jsx(dse,{className:"h-6 w-6 text-slate-300"}),r.jsx("div",{className:"font-medium text-slate-700",children:"No patients found."}),r.jsx("p",{className:"text-[11px] text-slate-400",children:"Use the search bar or tap New Patient to add a record."})]}),r.jsx("div",{className:"mt-2 grid gap-3",children:t.map(ee=>r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm hover:shadow-md transition",children:[r.jsxs("div",{className:"flex items-start justify-between gap-2",children:[r.jsxs("div",{className:"space-y-0.5",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:[ee.first_name," ",ee.last_name||""]}),ee.patient_type&&r.jsx("span",{className:"ml-1 inline-flex items-center rounded-full bg-slate-100 px-2 py-0.5 text-[10px] font-medium text-slate-800",children:ee.patient_type})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-1 text-[11px] text-slate-500",children:[r.jsx("span",{className:"font-mono bg-slate-100 px-1.5 py-0.5 rounded-full border border-slate-200",children:ee.uhid}),r.jsxs("span",{children:[" Age: ",ee.age_text||""]}),r.jsxs("span",{children:[" ",ee.gender]})]}),r.jsxs("div",{className:"mt-1 text-[11px] text-slate-600",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(x4,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsx("span",{children:ee.phone||"No mobile"})]}),ee.email&&r.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[r.jsx(Zh,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsx("span",{className:"truncate max-w-[180px]",children:ee.email})]})]})]}),r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("button",{type:"button",onClick:()=>q(ee),className:"px-2 py-1 text-[11px] rounded-full border border-slate-200 text-slate-700 font-semibold",children:"View"}),r.jsx("button",{type:"button",onClick:()=>W(ee),className:"px-2 py-1 text-[11px] rounded-full border border-slate-200 text-slate-700 font-semibold",children:"Edit"}),r.jsx("button",{type:"button",onClick:()=>G(ee),className:"px-2 py-1 text-[11px] rounded-full border border-rose-200 text-rose-700 font-semibold",children:"Deactivate"})]})]}),r.jsx("div",{className:"mt-2 flex flex-wrap gap-1 text-[10px] text-slate-600",children:ee.tag&&r.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-50 text-emerald-700 border border-emerald-100",children:ee.tag})})]},ee.id))})]}),r.jsx(FRe,{open:o,onClose:()=>c(!1),onSaved:()=>B(),initialPatient:x,lookups:w}),r.jsx(URe,{open:d,onClose:()=>u(!1),patient:f,onUpdated:se})]})}const kG=[{value:"insurance",label:"Insurance"},{value:"corporate",label:"Corporate"},{value:"govt",label:"Govt Scheme"},{value:"other",label:"Other"}];function cp({label:t,active:s,onClick:n}){return r.jsx("button",{type:"button",onClick:n,className:["inline-flex items-center rounded-full px-3 py-1 text-xs sm:text-sm transition-all",s?"bg-blue-600 text-white shadow-sm":"bg-slate-100 text-slate-600 hover:bg-slate-200"].join(" "),children:t})}function HRe({title:t,subtitle:s,onClose:n,children:a}){return r.jsx("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black/40 backdrop-blur-sm p-0 sm:p-4",children:r.jsxs("div",{className:`w-full max-w-xl max-h-[90vh] overflow-y-auto\r
                            rounded-t-3xl sm:rounded-2xl bg-white shadow-2xl\r
                            px-4 py-4 sm:px-5 sm:py-5\r
                            transform transition-transform duration-200 ease-out translate-y-0`,children:[r.jsxs("div",{className:"mb-4 flex items-center justify-between gap-2",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-base sm:text-lg font-semibold text-slate-900",children:t}),s&&r.jsx("p",{className:"mt-1 text-xs sm:text-sm text-slate-500",children:s})]}),r.jsx("button",{onClick:n,type:"button",className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:r.jsx(Rn,{className:"h-4 w-4"})})]}),a]})})}function WRe(){const[t,s]=y.useState("payers"),n=tt("patients.masters.view"),a=tt("patients.view");return n||a?r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"rounded-3xl bg-gradient-to-b from-teal-700 to-teal-600 text-white p-5 pb-6 shadow-sm",children:[r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-xl sm:text-2xl font-semibold",children:"Hello!"}),r.jsxs("div",{className:"mt-1 text-sm sm:text-base text-teal-50",children:["Welcome to ",r.jsx("span",{className:"font-semibold",children:"Patient Masters"})]}),r.jsx("p",{className:"mt-2 max-w-xl text-xs sm:text-sm text-teal-50/90",children:"Configure patient types, payers, TPAs & credit plans that drive registration and billing workflows."})]}),r.jsxs("div",{className:"flex gap-2 text-[11px] sm:text-xs justify-start sm:justify-end",children:[r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-white/10 px-3 py-1",children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-400"}),"IPD / OPD ready"]}),r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-white/10 px-3 py-1",children:[r.jsx(Aa,{className:"h-3 w-3"}),"NABH aligned"]})]})]}),r.jsxs("div",{className:"mt-4 hidden sm:flex gap-2",children:[r.jsx(mg,{label:"Patient Types",icon:Fc,active:t==="types",onClick:()=>s("types")}),r.jsx(mg,{label:"Payers",icon:ra,active:t==="payers",onClick:()=>s("payers")}),r.jsx(mg,{label:"TPAs",icon:b7,active:t==="tpas",onClick:()=>s("tpas")}),r.jsx(mg,{label:"Credit Plans",icon:Yte,active:t==="plans",onClick:()=>s("plans")})]})]}),r.jsxs("div",{className:"sm:hidden sticky top-0 z-20 -mt-3 -mx-3 mb-2 bg-slate-50/95 backdrop-blur px-3 pt-3 pb-2",children:[r.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Section"}),r.jsxs("select",{value:t,onChange:l=>s(l.target.value),className:"w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-800 shadow-sm outline-none focus:border-teal-500 focus:ring-2 focus:ring-teal-100",children:[r.jsx("option",{value:"types",children:"Patient Types"}),r.jsx("option",{value:"payers",children:"Payers"}),r.jsx("option",{value:"tpas",children:"TPAs"}),r.jsx("option",{value:"plans",children:"Credit Plans"})]})]}),r.jsxs("div",{className:"rounded-3xl border border-slate-100 bg-white/95 p-3 sm:p-4 shadow-sm",children:[t==="types"&&r.jsx(qRe,{}),t==="payers"&&r.jsx(KRe,{}),t==="tpas"&&r.jsx(XRe,{}),t==="plans"&&r.jsx(ZRe,{})]})]}):r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50/80 p-4 text-sm text-amber-800 shadow-sm",children:"You do not have permission to view patient masters."})}function mg({label:t,active:s,onClick:n,icon:a}){return r.jsxs("button",{onClick:n,className:["inline-flex items-center gap-1 rounded-full px-3 py-1.5 transition-all duration-150","border text-xs sm:text-[13px]",s?"border-blue-600 bg-blue-600 text-white shadow-sm":"border-slate-200 bg-white text-slate-600 hover:border-blue-200 hover:bg-blue-50"].join(" "),children:[a&&r.jsx(a,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:t})]})}function qRe(){const t=tt("patients.view")||tt("patients.masters.view"),s=tt("patients.update")||tt("patients.masters.manage"),[n,a]=y.useState("all"),[i,l]=y.useState([]),[o,c]=y.useState(!1),[d,u]=y.useState(""),[f,m]=y.useState(""),[x,b]=y.useState(!1),[w,j]=y.useState(null),_=y.useCallback(async()=>{var R,I;if(t){c(!0),u("");try{const{data:O}=await J.get("/patient-types",{params:{include_inactive:!0}});l(O||[])}catch(O){const M=((I=(R=O==null?void 0:O.response)==null?void 0:R.data)==null?void 0:I.detail)||"Failed to load patient types";u(M),ie.error(M)}finally{c(!1)}}},[t]);y.useEffect(()=>{_()},[_]);const C=y.useMemo(()=>{let R=[...i];if(n==="active"?R=R.filter(O=>O.is_active):n==="inactive"&&(R=R.filter(O=>!O.is_active)),!f)return R;const I=f.toLowerCase();return R.filter(O=>{var M,B,L;return((M=O.name)==null?void 0:M.toLowerCase().includes(I))||((B=O.code)==null?void 0:B.toLowerCase().includes(I))||((L=O.description)==null?void 0:L.toLowerCase().includes(I))})},[i,f,n]),k=()=>{j(null),b(!0)},A=R=>{s&&(j(R),b(!0))},T=R=>{b(!1),j(null),_(),ie.success(R==="update"?"Patient type updated successfully":"Patient type created successfully")},P=()=>{_(),ie.success("Patient type deactivated successfully")};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2 text-xs sm:text-sm",children:[r.jsx("span",{className:"text-[11px] sm:text-xs text-slate-500 mr-1",children:"Status:"}),r.jsx(cp,{label:"All",active:n==="all",onClick:()=>a("all")}),r.jsx(cp,{label:"Active",active:n==="active",onClick:()=>a("active")}),r.jsx(cp,{label:"Inactive",active:n==="inactive",onClick:()=>a("inactive")})]}),r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"flex items-start gap-2 text-xs text-slate-600 sm:text-sm",children:[r.jsx(Aa,{className:"mt-0.5 h-4 w-4 text-blue-600"}),r.jsxs("span",{children:["Define patient visit types like"," ",r.jsx("span",{className:"font-medium text-slate-800",children:"Emergency, OPD, IPD, Health Checkup"})," ","used in registration & triage."]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx("input",{value:f,onChange:R=>m(R.target.value),placeholder:"Search code, name, description",className:"w-60 max-w-full rounded-2xl border border-slate-200 bg-slate-50 px-8 py-1.5 text-xs text-slate-800 outline-none ring-0 transition focus:border-blue-500 focus:bg-white focus:ring-2 focus:ring-blue-100"}),r.jsx(is,{className:"pointer-events-none absolute left-2 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"})]}),s&&r.jsxs("button",{onClick:k,className:"inline-flex items-center gap-2 rounded-full bg-blue-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm transition hover:bg-blue-700 hover:shadow-md active:scale-95 sm:text-sm",children:[r.jsx(us,{className:"h-4 w-4"}),"New Patient Type"]})]})]}),d&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50/80 p-3 text-xs text-rose-700 sm:text-sm",children:d}),r.jsxs("div",{className:"grid gap-3 sm:hidden",children:[o&&r.jsx("div",{className:"rounded-2xl border border-slate-100 bg-slate-50 p-4 text-center text-xs text-slate-500 shadow-sm",children:"Loading patient types"}),!o&&C.map(R=>r.jsxs("div",{className:"group rounded-2xl border border-slate-100 bg-white p-3 shadow-sm transition hover:-translate-y-0.5 hover:shadow-md",children:[r.jsxs("div",{className:"flex items-start justify-between gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:R.name}),R.code&&r.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[11px] font-mono text-slate-600",children:R.code})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-[11px] text-slate-500",children:[r.jsxs("span",{className:["inline-flex items-center rounded-full border px-2 py-0.5",R.is_active?"border-emerald-100 bg-emerald-50 text-emerald-700":"border-slate-200 bg-slate-100 text-slate-500"].join(" "),children:[r.jsx("span",{className:["mr-1 h-1.5 w-1.5 rounded-full",R.is_active?"bg-emerald-500":"bg-slate-400"].join(" ")}),R.is_active?"Active":"Inactive"]}),r.jsxs("span",{className:"text-[11px] text-slate-400",children:["Sort: ",R.sort_order??0]})]})]}),s&&r.jsxs("button",{onClick:()=>A(R),className:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-2 py-1 text-[11px] font-semibold text-slate-700 transition hover:bg-slate-50",children:[r.jsx(Ja,{className:"h-3.5 w-3.5"}),"Edit"]})]}),R.description&&r.jsx("div",{className:"mt-2 text-[11px] text-slate-600",children:R.description})]},R.id)),!o&&C.length===0&&r.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 p-4 text-center text-xs text-slate-500",children:["No patient types found. ",s&&"Click New Patient Type to add one."]})]}),r.jsx("div",{className:"hidden overflow-x-auto rounded-2xl border border-slate-100 bg-white sm:block",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-slate-50/80",children:r.jsxs("tr",{className:"text-left text-[11px] font-medium uppercase tracking-wide text-slate-500",children:[r.jsx("th",{className:"p-2",children:"#"}),r.jsx("th",{className:"p-2",children:"Code"}),r.jsx("th",{className:"p-2",children:"Name"}),r.jsx("th",{className:"p-2",children:"Description"}),r.jsx("th",{className:"p-2",children:"Sort"}),r.jsx("th",{className:"p-2",children:"Status"}),r.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[o&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"p-4 text-center text-xs text-slate-500 sm:text-sm",children:"Loading patient types"})}),!o&&C.map((R,I)=>r.jsxs("tr",{className:["border-t border-slate-100 text-xs transition",R.is_active?"bg-white":"bg-slate-50/70 text-slate-400","hover:bg-slate-50"].join(" "),children:[r.jsx("td",{className:"p-2 text-slate-600",children:I+1}),r.jsx("td",{className:"p-2 font-mono text-[11px] text-slate-700",children:R.code}),r.jsx("td",{className:"p-2 text-slate-900",children:R.name}),r.jsx("td",{className:"p-2 max-w-xs",children:r.jsx("div",{className:"line-clamp-2 text-[11px] text-slate-600",children:R.description||""})}),r.jsx("td",{className:"p-2 text-slate-700",children:R.sort_order??0}),r.jsx("td",{className:"p-2",children:r.jsxs("span",{className:["inline-flex items-center rounded-full border px-2 py-0.5 text-[11px]",R.is_active?"border-emerald-100 bg-emerald-50 text-emerald-700":"border-slate-200 bg-slate-100 text-slate-500"].join(" "),children:[r.jsx("span",{className:["mr-1 h-1.5 w-1.5 rounded-full",R.is_active?"bg-emerald-500":"bg-slate-400"].join(" ")}),R.is_active?"Active":"Inactive"]})}),r.jsx("td",{className:"p-2 text-right",children:s&&r.jsxs("button",{onClick:()=>A(R),className:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-2 py-1 text-[11px] font-semibold text-slate-700 transition hover:bg-slate-50",children:[r.jsx(Ja,{className:"h-3.5 w-3.5"}),"Edit"]})})]},R.id)),!o&&C.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"p-6 text-center text-xs text-slate-500 sm:text-sm",children:"No patient types found."})})]})]})}),x&&r.jsx(GRe,{existing:w,onClose:()=>{b(!1),j(null)},onSaved:T,onDeleted:P})]})}function GRe({existing:t,onClose:s,onSaved:n,onDeleted:a}){const i=tt("patients.update")||tt("patients.masters.manage"),[l,o]=y.useState(()=>({code:(t==null?void 0:t.code)||"",name:(t==null?void 0:t.name)||"",description:(t==null?void 0:t.description)||"",is_active:(t==null?void 0:t.is_active)??!0,sort_order:(t==null?void 0:t.sort_order)??0})),[c,d]=y.useState(!1),[u,f]=y.useState(""),m=async b=>{var w,j;if(b.preventDefault(),!!i){d(!0),f("");try{const _={...l,sort_order:Number(l.sort_order)||0};t?(await J.put(`/patient-types/${t.id}`,_),n&&n("update")):(await J.post("/patient-types",_),n&&n("create"))}catch(_){const C=((j=(w=_==null?void 0:_.response)==null?void 0:w.data)==null?void 0:j.detail)||"Failed to save patient type";f(C),ie.error(C)}finally{d(!1)}}},x=async()=>{var b,w;if(!(!t||!i)&&window.confirm("Deactivate this patient type?")){d(!0),f("");try{await J.delete(`/patient-types/${t.id}`),a&&a(),s&&s()}catch(j){const _=((w=(b=j==null?void 0:j.response)==null?void 0:b.data)==null?void 0:w.detail)||"Failed to deactivate patient type";f(_),ie.error(_)}finally{d(!1)}}};return r.jsxs(HRe,{title:t?"Edit Patient Type":"New Patient Type",subtitle:"Define master types like Emergency, OPD, IPD, Health Checkup, etc.",onClose:s,children:[u&&r.jsx("div",{className:"mb-3 rounded-xl border border-rose-200 bg-rose-50/80 p-3 text-xs sm:text-sm text-rose-700",children:u}),r.jsxs("form",{onSubmit:m,className:"space-y-3 text-sm",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-800",children:"Code"}),r.jsx("input",{className:"input text-slate-800",value:l.code,onChange:b=>o({...l,code:b.target.value.toUpperCase()}),required:!0}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-400",children:"Example: EMERGENCY, OPD, IPD, HC"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-800",children:"Name"}),r.jsx("input",{className:"input text-slate-800",value:l.name,onChange:b=>o({...l,name:b.target.value}),required:!0})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-800",children:"Description (optional)"}),r.jsx("textarea",{className:"input min-h-[80px] text-slate-800",value:l.description,onChange:b=>o({...l,description:b.target.value})})]}),r.jsxs("div",{className:"grid items-center gap-3 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-800",children:"Sort Order"}),r.jsx("input",{className:"input text-slate-800",type:"number",value:l.sort_order,onChange:b=>o({...l,sort_order:b.target.value})}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-400",children:"Lower number shows earlier in dropdowns."})]}),r.jsxs("div",{className:"mt-2 flex items-center gap-2 md:mt-7",children:[r.jsx("input",{id:"pt-active",type:"checkbox",className:"h-4 w-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500",checked:l.is_active,onChange:b=>o({...l,is_active:b.target.checked})}),r.jsx("label",{htmlFor:"pt-active",className:"text-xs font-medium text-slate-800",children:"Active"})]})]}),r.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3",children:[t&&r.jsxs("button",{type:"button",onClick:x,className:"inline-flex items-center gap-2 rounded-full border border-rose-200 px-3 py-1.5 text-xs font-medium text-rose-700 hover:bg-rose-50",children:[r.jsx(qr,{className:"h-3.5 w-3.5"}),"Deactivate"]}),r.jsxs("div",{className:"ml-auto flex gap-2",children:[r.jsx("button",{type:"button",onClick:s,className:"rounded-full border border-slate-200 px-4 py-1.5 text-xs text-slate-700 hover:bg-slate-50",children:"Cancel"}),r.jsx("button",{className:"btn rounded-full px-4 py-1.5 text-xs",disabled:c||!i,children:c?"Saving":"Save"})]})]})]})]})}function KRe(){const t=tt("patients.masters.view"),s=tt("patients.masters.view"),n=tt("patients.masters.manage"),a=s||n,[i,l]=y.useState("all"),[o,c]=y.useState([]),[d,u]=y.useState(!1),[f,m]=y.useState(""),[x,b]=y.useState(""),[w,j]=y.useState(!1),[_,C]=y.useState(null),k=y.useCallback(async()=>{var O,M;if(t){u(!0),m("");try{const{data:B}=await J.get("/patient-masters/payers");c(B||[])}catch(B){const L=((M=(O=B==null?void 0:B.response)==null?void 0:O.data)==null?void 0:M.detail)||"Failed to load payers";m(L),ie.error(L)}finally{u(!1)}}},[t]);y.useEffect(()=>{k()},[k]);const A=y.useMemo(()=>{let O=[...o];if(i!=="all"&&(O=O.filter(B=>B.payer_type===i)),!x)return O;const M=x.toLowerCase();return O.filter(B=>{var L,F,V;return((L=B.name)==null?void 0:L.toLowerCase().includes(M))||((F=B.code)==null?void 0:F.toLowerCase().includes(M))||((V=B.payer_type)==null?void 0:V.toLowerCase().includes(M))})},[o,x,i]),T=()=>{C(null),j(!0)},P=O=>{a&&(C(O),j(!0))},R=O=>{j(!1),C(null),k(),ie.success(O==="update"?"Payer updated successfully":"Payer created successfully")},I=()=>{k(),ie.success("Payer deactivated successfully")};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2 text-xs sm:text-sm",children:[r.jsx("span",{className:"text-[11px] sm:text-xs text-slate-500 mr-1",children:"Payer type:"}),r.jsx(cp,{label:"All",active:i==="all",onClick:()=>l("all")}),kG.map(O=>r.jsx(cp,{label:O.label,active:i===O.value,onClick:()=>l(O.value)},O.value))]}),r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"flex items-start gap-2 text-xs text-slate-600 sm:text-sm",children:[r.jsx(Aa,{className:"mt-0.5 h-4 w-4 text-blue-600"}),r.jsxs("span",{children:["Payers used for"," ",r.jsx("span",{className:"font-medium text-slate-800",children:"insurance, corporate and government schemes"})," ","in OPD/IPD billing."]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx("input",{value:x,onChange:O=>b(O.target.value),placeholder:"Search code, name, type",className:"w-52 max-w-full rounded-2xl border border-slate-200 bg-slate-50 px-8 py-1.5 text-xs text-slate-800 outline-none ring-0 transition focus:border-blue-500 focus:bg-white focus:ring-2 focus:ring-blue-100"}),r.jsx(is,{className:"pointer-events-none absolute left-2 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"})]}),a&&r.jsxs("button",{onClick:T,className:"inline-flex items-center gap-2 rounded-full bg-blue-600 px-3 py-1.5 text-xs font-medium text-white shadow-sm transition hover:bg-blue-700 hover:shadow-md active:scale-95 sm:text-sm",children:[r.jsx(us,{className:"h-4 w-4"}),"New Payer"]})]})]}),f&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50/80 p-3 text-xs text-rose-700 sm:text-sm",children:f}),r.jsxs("div",{className:"grid gap-3 sm:hidden",children:[d&&r.jsx("div",{className:"rounded-2xl border border-slate-100 bg-slate-50 p-4 text-center text-xs text-slate-500 shadow-sm",children:"Loading payers"}),!d&&A.map(O=>r.jsxs("div",{className:"group rounded-2xl border border-slate-100 bg-white p-3 shadow-sm transition hover:-translate-y-0.5 hover:shadow-md",children:[r.jsxs("div",{className:"flex items-start justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:O.name}),O.code&&r.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[11px] font-mono text-slate-600",children:O.code})]}),r.jsx("div",{className:"mt-1 text-[11px] capitalize text-slate-500",children:O.payer_type||""})]}),a&&r.jsxs("button",{onClick:()=>P(O),className:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-2 py-1 text-[13px] font-bold text-slate-700 transition hover:bg-slate-50",children:[r.jsx(Ja,{className:"h-3.5 w-3.5"}),"Edit"]})]}),r.jsxs("div",{className:"mt-2 space-y-1 text-[11px] text-slate-600",children:[O.contact_person&&r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-slate-700",children:"Contact:"})," ",O.contact_person]}),O.phone&&r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-slate-700",children:"Phone:"})," ",O.phone]}),O.email&&r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-slate-700",children:"Email:"})," ",O.email]}),O.address&&r.jsxs("div",{className:"line-clamp-2",children:[r.jsx("span",{className:"font-medium text-slate-700",children:"Address:"})," ",O.address]})]})]},O.id)),!d&&A.length===0&&r.jsx("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 p-4 text-center text-xs text-slate-500",children:"No payers found."})]}),r.jsx("div",{className:"hidden overflow-x-auto rounded-2xl border border-slate-100 bg-white sm:block",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-slate-50/80",children:r.jsxs("tr",{className:"text-left text-[11px] font-medium uppercase tracking-wide text-slate-500",children:[r.jsx("th",{className:"p-2",children:"#"}),r.jsx("th",{className:"p-2",children:"Code"}),r.jsx("th",{className:"p-2",children:"Name"}),r.jsx("th",{className:"p-2",children:"Type"}),r.jsx("th",{className:"p-2",children:"Contact"}),r.jsx("th",{className:"p-2",children:"Phone / Email"}),r.jsx("th",{className:"p-2",children:"Address"}),r.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[d&&r.jsx("tr",{children:r.jsx("td",{colSpan:8,className:"p-4 text-center text-xs text-slate-500 sm:text-sm",children:"Loading payers"})}),!d&&A.map((O,M)=>r.jsxs("tr",{className:"border-t border-slate-100 text-xs text-slate-800 transition hover:bg-slate-50",children:[r.jsx("td",{className:"p-2",children:M+1}),r.jsx("td",{className:"p-2 font-mono text-[11px] text-slate-700",children:O.code}),r.jsx("td",{className:"p-2",children:O.name}),r.jsx("td",{className:"p-2 capitalize text-slate-700",children:O.payer_type||""}),r.jsx("td",{className:"p-2 text-slate-700",children:O.contact_person||""}),r.jsxs("td",{className:"p-2",children:[r.jsx("div",{children:O.phone||""}),r.jsx("div",{className:"text-[11px] text-slate-500",children:O.email||""})]}),r.jsx("td",{className:"p-2 max-w-xs",children:r.jsx("div",{className:"line-clamp-2 text-[11px] text-slate-600",children:O.address||""})}),r.jsx("td",{className:"p-2 text-right",children:a&&r.jsxs("button",{onClick:()=>P(O),className:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-2 py-1 text-[11px] text-slate-700 transition hover:bg-slate-50",children:[r.jsx(Ja,{className:"h-3.5 w-3.5"}),"Edit"]})})]},O.id)),!d&&A.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:8,className:"p-6 text-center text-xs text-slate-500 sm:text-sm",children:"No payers found."})})]})]})}),w&&r.jsx(YRe,{onClose:()=>{j(!1),C(null)},existing:_,onSaved:R,onDeleted:I})]})}function YRe({existing:t,onClose:s,onSaved:n,onDeleted:a}){const i=tt("patients.masters.manage"),[l,o]=y.useState(()=>({code:(t==null?void 0:t.code)||"",name:(t==null?void 0:t.name)||"",payer_type:(t==null?void 0:t.payer_type)||"insurance",contact_person:(t==null?void 0:t.contact_person)||"",phone:(t==null?void 0:t.phone)||"",email:(t==null?void 0:t.email)||"",address:(t==null?void 0:t.address)||""})),[c,d]=y.useState(!1),[u,f]=y.useState(""),m=async b=>{var w,j;if(b.preventDefault(),!!i){d(!0),f("");try{t?(await J.put(`/patient-masters/payers/${t.id}`,l),n&&n("update")):(await J.post("/patient-masters/payers",l),n&&n("create"))}catch(_){const C=((j=(w=_==null?void 0:_.response)==null?void 0:w.data)==null?void 0:j.detail)||"Failed to save payer";f(C),ie.error(C)}finally{d(!1)}}},x=async()=>{var b,w;if(!(!t||!i)&&window.confirm("Deactivate this payer?")){d(!0),f("");try{await J.delete(`/patient-masters/payers/${t.id}`),a&&a(),s&&s()}catch(j){const _=((w=(b=j==null?void 0:j.response)==null?void 0:b.data)==null?void 0:w.detail)||"Failed to deactivate payer";f(_),ie.error(_)}finally{d(!1)}}};return r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm p-3 sm:p-4",children:r.jsxs("div",{className:"max-h-[90vh] w-full max-w-xl overflow-y-auto rounded-2xl bg-white p-4 shadow-2xl sm:p-5",children:[r.jsxs("div",{className:"mb-4 flex items-center justify-between gap-2",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-base font-semibold text-slate-900 sm:text-lg",children:t?"Edit Payer":"New Payer"}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-500 sm:text-xs",children:"Master record used for credit / insurance patients."})]}),r.jsx("button",{onClick:s,type:"button",className:"rounded-full p-2 text-slate-500 transition hover:bg-slate-100 hover:text-slate-700",children:r.jsx(Rn,{className:"h-4 w-4"})})]}),u&&r.jsx("div",{className:"mb-3 rounded-xl border border-rose-200 bg-rose-50/80 p-3 text-xs text-rose-700 sm:text-sm",children:u}),r.jsxs("form",{onSubmit:m,className:"space-y-3 text-xs sm:text-sm",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Code"}),r.jsx("input",{className:"input text-slate-800",value:l.code,onChange:b=>o({...l,code:b.target.value.toUpperCase()}),required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Name"}),r.jsx("input",{className:"input text-slate-800",value:l.name,onChange:b=>o({...l,name:b.target.value}),required:!0})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Type"}),r.jsx("select",{className:"input text-slate-800",value:l.payer_type,onChange:b=>o({...l,payer_type:b.target.value}),children:kG.map(b=>r.jsx("option",{value:b.value,children:b.label},b.value))})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Contact Person"}),r.jsx("input",{className:"input text-slate-800",value:l.contact_person,onChange:b=>o({...l,contact_person:b.target.value})})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Phone"}),r.jsx("input",{className:"input text-slate-800",value:l.phone,onChange:b=>o({...l,phone:b.target.value})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Email"}),r.jsx("input",{className:"input text-slate-800",type:"email",value:l.email,onChange:b=>o({...l,email:b.target.value})})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Address"}),r.jsx("textarea",{className:"input min-h-[80px] text-slate-800",value:l.address,onChange:b=>o({...l,address:b.target.value})})]}),r.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3",children:[t&&r.jsxs("button",{type:"button",onClick:x,className:"inline-flex items-center gap-2 rounded-full border border-rose-200 px-3 py-1.5 text-[11px] font-medium text-rose-700 transition hover:bg-rose-50",children:[r.jsx(qr,{className:"h-3.5 w-3.5"}),"Deactivate"]}),r.jsxs("div",{className:"ml-auto flex gap-2",children:[r.jsx("button",{type:"button",onClick:s,className:"rounded-full border border-slate-200 px-4 py-1.5 text-[11px] text-slate-700 transition hover:bg-slate-50",children:"Cancel"}),r.jsx("button",{className:"btn rounded-full px-4 py-1.5 text-[11px]",disabled:c||!i,children:c?"Saving":"Save"})]})]})]})]})})}function XRe(){const t=tt("patients.masters.view"),s=tt("patients.masters.manage"),[n,a]=y.useState([]),[i,l]=y.useState([]),[o,c]=y.useState(!1),[d,u]=y.useState(""),[f,m]=y.useState(""),[x,b]=y.useState(!1),[w,j]=y.useState(null),_=y.useCallback(async()=>{var I,O;if(t){c(!0),u("");try{const[M,B]=await Promise.all([J.get("/patient-masters/tpas"),J.get("/patient-masters/payers")]);a(M.data||[]),l(B.data||[])}catch(M){const B=((O=(I=M==null?void 0:M.response)==null?void 0:I.data)==null?void 0:O.detail)||"Failed to load TPAs";u(B),ie.error(B)}finally{c(!1)}}},[t]);y.useEffect(()=>{_()},[_]);const C=y.useMemo(()=>{const I={};for(const O of i)I[O.id]=O;return I},[i]),k=y.useMemo(()=>{if(!f)return n;const I=f.toLowerCase();return n.filter(O=>{var M,B,L,F;return((M=O.name)==null?void 0:M.toLowerCase().includes(I))||((B=O.code)==null?void 0:B.toLowerCase().includes(I))||((F=(L=C[O.payer_id])==null?void 0:L.name)==null?void 0:F.toLowerCase().includes(I))})},[n,f,C]),A=()=>{j(null),b(!0)},T=I=>{s&&(j(I),b(!0))},P=I=>{b(!1),j(null),_(),ie.success(I==="update"?"TPA updated successfully":"TPA created successfully")},R=()=>{_(),ie.success("TPA deactivated successfully")};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"flex items-start gap-2 text-xs text-slate-600 sm:text-sm",children:[r.jsx(b7,{className:"mt-0.5 h-4 w-4 text-blue-600"}),r.jsx("span",{children:"Third-party administrators (TPAs) linked to payers."})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx("input",{value:f,onChange:I=>m(I.target.value),placeholder:"Search code, name, payer",className:"w-52 max-w-full rounded-2xl border border-slate-200 bg-slate-50 px-8 py-1.5 text-xs text-slate-800 outline-none ring-0 transition focus:border-blue-500 focus:bg-white focus:ring-2 focus:ring-blue-100"}),r.jsx(is,{className:"pointer-events-none absolute left-2 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"})]}),s&&r.jsxs("button",{onClick:A,className:"inline-flex items-center gap-2 rounded-full bg-blue-600 px-3 py-1.5 text-xs font-medium text-white shadow-sm transition hover:bg-blue-700 hover:shadow-md active:scale-95 sm:text-sm",children:[r.jsx(us,{className:"h-4 w-4"}),"New TPA"]})]})]}),d&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50/80 p-3 text-xs text-rose-700 sm:text-sm",children:d}),r.jsxs("div",{className:"grid gap-3 sm:hidden",children:[o&&r.jsx("div",{className:"rounded-2xl border border-slate-100 bg-slate-50 p-4 text-center text-xs text-slate-500 shadow-sm",children:"Loading TPAs"}),!o&&k.map(I=>{var O;return r.jsxs("div",{className:"group rounded-2xl border border-slate-100 bg-white p-3 shadow-sm transition hover:-translate-y-0.5 hover:shadow-md",children:[r.jsxs("div",{className:"flex items-start justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:I.name}),I.code&&r.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[11px] font-mono text-slate-600",children:I.code})]}),r.jsxs("div",{className:"mt-1 text-[11px] text-slate-500",children:["Payer: ",((O=C[I.payer_id])==null?void 0:O.name)||""]})]}),s&&r.jsxs("button",{onClick:()=>T(I),className:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-2 py-1 text-[11px] text-slate-700 hover:bg-slate-50",children:[r.jsx(Ja,{className:"h-3.5 w-3.5"}),"Edit"]})]}),r.jsxs("div",{className:"mt-2 space-y-1 text-[11px] text-slate-600",children:[I.contact_person&&r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-slate-700",children:"Contact:"})," ",I.contact_person]}),I.phone&&r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-slate-700",children:"Phone:"})," ",I.phone]}),I.email&&r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-slate-700",children:"Email:"})," ",I.email]})]})]},I.id)}),!o&&k.length===0&&r.jsx("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 p-4 text-center text-xs text-slate-500",children:"No TPAs found."})]}),r.jsx("div",{className:"hidden overflow-x-auto rounded-2xl border border-slate-100 bg-white sm:block",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-slate-50/80",children:r.jsxs("tr",{className:"text-left text-[11px] font-medium uppercase tracking-wide text-slate-500",children:[r.jsx("th",{className:"p-2",children:"#"}),r.jsx("th",{className:"p-2",children:"Code"}),r.jsx("th",{className:"p-2",children:"Name"}),r.jsx("th",{className:"p-2",children:"Payer"}),r.jsx("th",{className:"p-2",children:"Contact"}),r.jsx("th",{className:"p-2",children:"Phone / Email"}),r.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[o&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"p-4 text-center text-xs text-slate-500 sm:text-sm",children:"Loading TPAs"})}),!o&&k.map((I,O)=>{var M;return r.jsxs("tr",{className:"border-t border-slate-100 text-xs text-slate-800 transition hover:bg-slate-50",children:[r.jsx("td",{className:"p-2 text-slate-800",children:O+1}),r.jsx("td",{className:"p-2 font-mono text-[11px] text-slate-700",children:I.code}),r.jsx("td",{className:"p-2 text-slate-900",children:I.name}),r.jsx("td",{className:"p-2 text-slate-800",children:((M=C[I.payer_id])==null?void 0:M.name)||""}),r.jsx("td",{className:"p-2 text-slate-800",children:I.contact_person||""}),r.jsxs("td",{className:"p-2 text-slate-800",children:[r.jsx("div",{children:I.phone||""}),r.jsx("div",{className:"text-[11px] text-slate-500",children:I.email||""})]}),r.jsx("td",{className:"p-2 text-right",children:s&&r.jsxs("button",{onClick:()=>T(I),className:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-2 py-1 text-[11px] text-slate-700 transition hover:bg-slate-50",children:[r.jsx(Ja,{className:"h-3.5 w-3.5"}),"Edit"]})})]},I.id)}),!o&&k.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"p-6 text-center text-xs text-slate-500 sm:text-sm",children:"No TPAs found."})})]})]})}),x&&r.jsx(QRe,{existing:w,onClose:()=>{b(!1),j(null)},payers:i,onSaved:P,onDeleted:R})]})}function QRe({existing:t,payers:s,onClose:n,onSaved:a,onDeleted:i}){const l=tt("patients.masters.manage"),[o,c]=y.useState(()=>({code:(t==null?void 0:t.code)||"",name:(t==null?void 0:t.name)||"",payer_id:(t==null?void 0:t.payer_id)||"",contact_person:(t==null?void 0:t.contact_person)||"",phone:(t==null?void 0:t.phone)||"",email:(t==null?void 0:t.email)||""})),[d,u]=y.useState(!1),[f,m]=y.useState(""),x=async w=>{var j,_;if(w.preventDefault(),!!l){u(!0),m("");try{const C={...o,payer_id:o.payer_id?Number(o.payer_id):null};t?(await J.put(`/patient-masters/tpas/${t.id}`,C),a&&a("update")):(await J.post("/patient-masters/tpas",C),a&&a("create"))}catch(C){const k=((_=(j=C==null?void 0:C.response)==null?void 0:j.data)==null?void 0:_.detail)||"Failed to save TPA";m(k),ie.error(k)}finally{u(!1)}}},b=async()=>{var w,j;if(!(!t||!l)&&window.confirm("Deactivate this TPA?")){u(!0),m("");try{await J.delete(`/patient-masters/tpas/${t.id}`),i&&i(),n&&n()}catch(_){const C=((j=(w=_==null?void 0:_.response)==null?void 0:w.data)==null?void 0:j.detail)||"Failed to deactivate TPA";m(C),ie.error(C)}finally{u(!1)}}};return r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm p-3 sm:p-4",children:r.jsxs("div",{className:"max-h-[90vh] w-full max-w-xl overflow-y-auto rounded-2xl bg-white p-4 shadow-2xl sm:p-5",children:[r.jsxs("div",{className:"mb-4 flex items-center justify-between gap-2",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-base font-semibold text-slate-900 sm:text-lg",children:t?"Edit TPA":"New TPA"}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-500 sm:text-xs",children:"Third-party administrator master, mapped to payer."})]}),r.jsx("button",{onClick:n,type:"button",className:"rounded-full p-2 text-slate-500 transition hover:bg-slate-100 hover:text-slate-700",children:r.jsx(Rn,{className:"h-4 w-4"})})]}),f&&r.jsx("div",{className:"mb-3 rounded-xl border border-rose-200 bg-rose-50/80 p-3 text-xs text-rose-700 sm:text-sm",children:f}),r.jsxs("form",{onSubmit:x,className:"space-y-3 text-xs sm:text-sm",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Code"}),r.jsx("input",{className:"input text-slate-800",value:o.code,onChange:w=>c({...o,code:w.target.value.toUpperCase()}),required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Name"}),r.jsx("input",{className:"input text-slate-800",value:o.name,onChange:w=>c({...o,name:w.target.value}),required:!0})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Payer"}),r.jsxs("select",{className:"input text-slate-800",value:o.payer_id||"",onChange:w=>c({...o,payer_id:w.target.value||""}),required:!0,children:[r.jsx("option",{value:"",children:"Select payer"}),s.map(w=>r.jsx("option",{value:w.id,children:w.name},w.id))]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Contact Person"}),r.jsx("input",{className:"input text-slate-800",value:o.contact_person,onChange:w=>c({...o,contact_person:w.target.value})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Phone"}),r.jsx("input",{className:"input text-slate-800",value:o.phone,onChange:w=>c({...o,phone:w.target.value})})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Email"}),r.jsx("input",{className:"input text-slate-800",type:"email",value:o.email,onChange:w=>c({...o,email:w.target.value})})]}),r.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3",children:[t&&r.jsxs("button",{type:"button",onClick:b,className:"inline-flex items-center gap-2 rounded-full border border-rose-200 px-3 py-1.5 text-[11px] font-medium text-rose-700 transition hover:bg-rose-50",children:[r.jsx(qr,{className:"h-3.5 w-3.5"}),"Deactivate"]}),r.jsxs("div",{className:"ml-auto flex gap-2",children:[r.jsx("button",{type:"button",onClick:n,className:"rounded-full border border-slate-200 px-4 py-1.5 text-[11px] text-slate-700 transition hover:bg-slate-50",children:"Cancel"}),r.jsx("button",{className:"btn rounded-full px-4 py-1.5 text-[11px]",disabled:d||!l,children:d?"Saving":"Save"})]})]})]})]})})}function ZRe(){const t=tt("patients.masters.view"),s=tt("patients.masters.manage"),[n,a]=y.useState([]),[i,l]=y.useState([]),[o,c]=y.useState([]),[d,u]=y.useState(!1),[f,m]=y.useState(""),[x,b]=y.useState(""),[w,j]=y.useState(!1),[_,C]=y.useState(null),k=y.useCallback(async()=>{var B,L;if(t){u(!0),m("");try{const[F,V,U]=await Promise.all([J.get("/patient-masters/credit-plans"),J.get("/patient-masters/payers"),J.get("/patient-masters/tpas")]);a(F.data||[]),l(V.data||[]),c(U.data||[])}catch(F){const V=((L=(B=F==null?void 0:F.response)==null?void 0:B.data)==null?void 0:L.detail)||"Failed to load credit plans";m(V),ie.error(V)}finally{u(!1)}}},[t]);y.useEffect(()=>{k()},[k]);const A=y.useMemo(()=>{const B={};for(const L of i)B[L.id]=L;return B},[i]),T=y.useMemo(()=>{const B={};for(const L of o)B[L.id]=L;return B},[o]),P=y.useMemo(()=>{if(!x)return n;const B=x.toLowerCase();return n.filter(L=>{var F,V,U,z,W,q;return((F=L.name)==null?void 0:F.toLowerCase().includes(B))||((V=L.code)==null?void 0:V.toLowerCase().includes(B))||((z=(U=A[L.payer_id])==null?void 0:U.name)==null?void 0:z.toLowerCase().includes(B))||((q=(W=T[L.tpa_id])==null?void 0:W.name)==null?void 0:q.toLowerCase().includes(B))})},[n,x,A,T]),R=()=>{C(null),j(!0)},I=B=>{s&&(C(B),j(!0))},O=B=>{j(!1),C(null),k(),ie.success(B==="update"?"Credit plan updated successfully":"Credit plan created successfully")},M=()=>{k(),ie.success("Credit plan deactivated successfully")};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"flex items-start gap-2 text-xs text-slate-600 sm:text-sm",children:[r.jsx(m7,{className:"mt-0.5 h-4 w-4 text-blue-600"}),r.jsx("span",{children:"Credit / insurance plans used for IPD/OPD billing & authorization."})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx("input",{value:x,onChange:B=>b(B.target.value),placeholder:"Search code, name, payer, TPA",className:"w-60 max-w-full rounded-2xl border border-slate-200 bg-slate-50 px-8 py-1.5 text-xs text-slate-800 outline-none ring-0 transition focus:border-blue-500 focus:bg-white focus:ring-2 focus:ring-blue-100"}),r.jsx(is,{className:"pointer-events-none absolute left-2 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"})]}),s&&r.jsxs("button",{onClick:R,className:"inline-flex items-center gap-2 rounded-full bg-blue-600 px-3 py-1.5 text-xs font-medium text-white shadow-sm transition hover:bg-blue-700 hover:shadow-md active:scale-95 sm:text-sm",children:[r.jsx(us,{className:"h-4 w-4"}),"New Plan"]})]})]}),f&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50/80 p-3 text-xs text-rose-700 sm:text-sm",children:f}),r.jsxs("div",{className:"grid gap-3 sm:hidden",children:[d&&r.jsx("div",{className:"rounded-2xl border border-slate-100 bg-slate-50 p-4 text-center text-xs text-slate-500 shadow-sm",children:"Loading credit plans"}),!d&&P.map(B=>{var L,F;return r.jsxs("div",{className:"group rounded-2xl border border-slate-100 bg-white p-3 shadow-sm transition hover:-translate-y-0.5 hover:shadow-md",children:[r.jsxs("div",{className:"flex items-start justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:B.name}),B.code&&r.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[11px] font-mono text-slate-600",children:B.code})]}),r.jsxs("div",{className:"mt-1 text-[11px] text-slate-500",children:["Payer: ",((L=A[B.payer_id])==null?void 0:L.name)||""]}),r.jsxs("div",{className:"mt-0.5 text-[11px] text-slate-500",children:["TPA: ",((F=T[B.tpa_id])==null?void 0:F.name)||""]})]}),s&&r.jsxs("button",{onClick:()=>I(B),className:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-2 py-1 text-[11px] text-slate-700 hover:bg-slate-50",children:[r.jsx(Ja,{className:"h-3.5 w-3.5"}),"Edit"]})]}),B.description&&r.jsx("div",{className:"mt-2 text-[11px] text-slate-600",children:B.description})]},B.id)}),!d&&P.length===0&&r.jsx("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 p-4 text-center text-xs text-slate-500",children:"No credit plans found."})]}),r.jsx("div",{className:"hidden overflow-x-auto rounded-2xl border border-slate-100 bg-white sm:block",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-slate-50/80",children:r.jsxs("tr",{className:"text-left text-[11px] font-medium uppercase tracking-wide text-slate-500",children:[r.jsx("th",{className:"p-2",children:"#"}),r.jsx("th",{className:"p-2",children:"Code"}),r.jsx("th",{className:"p-2",children:"Name"}),r.jsx("th",{className:"p-2",children:"Payer"}),r.jsx("th",{className:"p-2",children:"TPA"}),r.jsx("th",{className:"p-2",children:"Description"}),r.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[d&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"p-4 text-center text-xs text-slate-500 sm:text-sm",children:"Loading credit plans"})}),!d&&P.map((B,L)=>{var F,V;return r.jsxs("tr",{className:"border-t border-slate-100 text-xs text-slate-800 transition hover:bg-slate-50",children:[r.jsx("td",{className:"p-2",children:L+1}),r.jsx("td",{className:"p-2 font-mono text-[11px] text-slate-700",children:B.code}),r.jsx("td",{className:"p-2",children:B.name}),r.jsx("td",{className:"p-2",children:((F=A[B.payer_id])==null?void 0:F.name)||""}),r.jsx("td",{className:"p-2",children:((V=T[B.tpa_id])==null?void 0:V.name)||""}),r.jsx("td",{className:"p-2 max-w-xs",children:r.jsx("div",{className:"line-clamp-2 text-[11px] text-slate-600",children:B.description||""})}),r.jsx("td",{className:"p-2 text-right",children:s&&r.jsxs("button",{onClick:()=>I(B),className:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-2 py-1 text-[11px] text-slate-700 transition hover:bg-slate-50",children:[r.jsx(Ja,{className:"h-3.5 w-3.5"}),"Edit"]})})]},B.id)}),!d&&P.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"p-6 text-center text-xs text-slate-500 sm:text-sm",children:"No credit plans found."})})]})]})}),w&&r.jsx(JRe,{existing:_,payers:i,tpas:o,onClose:()=>{j(!1),C(null)},onSaved:O,onDeleted:M})]})}function JRe({existing:t,payers:s,tpas:n,onClose:a,onSaved:i,onDeleted:l}){const o=tt("patients.masters.manage"),[c,d]=y.useState(()=>({code:(t==null?void 0:t.code)||"",name:(t==null?void 0:t.name)||"",payer_id:(t==null?void 0:t.payer_id)||"",tpa_id:(t==null?void 0:t.tpa_id)||"",description:(t==null?void 0:t.description)||""})),[u,f]=y.useState(!1),[m,x]=y.useState(""),b=async j=>{var _,C;if(j.preventDefault(),!!o){f(!0),x("");try{const k={...c,payer_id:c.payer_id?Number(c.payer_id):null,tpa_id:c.tpa_id?Number(c.tpa_id):null};t?(await J.put(`/patient-masters/credit-plans/${t.id}`,k),i&&i("update")):(await J.post("/patient-masters/credit-plans",k),i&&i("create"))}catch(k){const A=((C=(_=k==null?void 0:k.response)==null?void 0:_.data)==null?void 0:C.detail)||"Failed to save credit plan";x(A),ie.error(A)}finally{f(!1)}}},w=async()=>{var j,_;if(!(!t||!o)&&window.confirm("Deactivate this credit plan?")){f(!0),x("");try{await J.delete(`/patient-masters/credit-plans/${t.id}`),l&&l(),a&&a()}catch(C){const k=((_=(j=C==null?void 0:C.response)==null?void 0:j.data)==null?void 0:_.detail)||"Failed to deactivate credit plan";x(k),ie.error(k)}finally{f(!1)}}};return r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm p-3 sm:p-4",children:r.jsxs("div",{className:"max-h-[90vh] w-full max-w-xl overflow-y-auto rounded-2xl bg-white p-4 shadow-2xl sm:p-5",children:[r.jsxs("div",{className:"mb-4 flex items-center justify-between gap-2",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-base font-semibold text-slate-900 sm:text-lg",children:t?"Edit Credit Plan":"New Credit Plan"}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-500 sm:text-xs",children:"Map plan to payer & optional TPA for billing workflows."})]}),r.jsx("button",{onClick:a,type:"button",className:"rounded-full p-2 text-slate-500 transition hover:bg-slate-100 hover:text-slate-700",children:r.jsx(Rn,{className:"h-4 w-4"})})]}),m&&r.jsx("div",{className:"mb-3 rounded-xl border border-rose-200 bg-rose-50/80 p-3 text-xs text-rose-700 sm:text-sm",children:m}),r.jsxs("form",{onSubmit:b,className:"space-y-3 text-xs sm:text-sm",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Code"}),r.jsx("input",{className:"input text-slate-800",value:c.code,onChange:j=>d({...c,code:j.target.value.toUpperCase()}),required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Name"}),r.jsx("input",{className:"input text-slate-800",value:c.name,onChange:j=>d({...c,name:j.target.value}),required:!0})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Payer"}),r.jsxs("select",{className:"input text-slate-800",value:c.payer_id||"",onChange:j=>d({...c,payer_id:j.target.value||""}),required:!0,children:[r.jsx("option",{value:"",children:"Select payer"}),s.map(j=>r.jsx("option",{value:j.id,children:j.name},j.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"TPA (optional)"}),r.jsxs("select",{className:"input text-slate-800",value:c.tpa_id||"",onChange:j=>d({...c,tpa_id:j.target.value||""}),children:[r.jsx("option",{value:"",children:"No TPA"}),n.map(j=>r.jsx("option",{value:j.id,children:j.name},j.id))]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Description / Notes"}),r.jsx("textarea",{className:"input min-h-[80px] text-slate-800",value:c.description,onChange:j=>d({...c,description:j.target.value})})]}),r.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3",children:[t&&r.jsxs("button",{type:"button",onClick:w,className:"inline-flex items-center gap-2 rounded-full border border-rose-200 px-3 py-1.5 text-[11px] font-medium text-rose-700 transition hover:bg-rose-50",children:[r.jsx(qr,{className:"h-3.5 w-3.5"}),"Deactivate"]}),r.jsxs("div",{className:"ml-auto flex gap-2",children:[r.jsx("button",{type:"button",onClick:a,className:"rounded-full border border-slate-200 px-4 py-1.5 text-[11px] text-slate-700 transition hover:bg-slate-50",children:"Cancel"}),r.jsx("button",{className:"btn rounded-full px-4 py-1.5 text-[11px]",disabled:u||!o,children:u?"Saving":"Save"})]})]})]})]})})}const SR=[{key:"all",label:"All"},{key:"op_billing",label:"OP Billing"},{key:"ip_billing",label:"IP Billing"},{key:"lab",label:"Lab"},{key:"pharmacy",label:"Pharmacy"},{key:"radiology",label:"Radiology"},{key:"general",label:"General"}],e6e={draft:"bg-yellow-100 text-yellow-800",finalized:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"},Tm=10;function Vj(t){return Number(t||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}function t6e(){var U;const[t,s]=y.useState("all"),[n,a]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState({doctors:[],credit_providers:[],packages:[],payers:[],tpas:[],credit_plans:[]}),[d,u]=y.useState(!1),[f,m]=y.useState(""),[x,b]=y.useState(1),[w,j]=y.useState({patient_id:null,billing_type:"op_billing",context_type:"opd",context_id:"",remarks:""}),_=Ta();y.useEffect(()=>{C()},[]),y.useEffect(()=>{k()},[t]);async function C(){try{const{data:z}=await Nk();c({doctors:(z==null?void 0:z.doctors)||[],credit_providers:(z==null?void 0:z.credit_providers)||[],packages:(z==null?void 0:z.packages)||[],payers:(z==null?void 0:z.payers)||[],tpas:(z==null?void 0:z.tpas)||[],credit_plans:(z==null?void 0:z.credit_plans)||[]})}catch(z){console.error("Failed to load billing masters",z)}}async function k(){l(!0),m("");try{const z={};t!=="all"&&(z.billing_type=t);const{data:W}=await n0e(z);a(W||[]),b(1)}catch(z){console.error("Failed to load invoices",z),m("Unable to load invoices. Please try again.")}finally{l(!1)}}function A(z){_(`/billing/invoices/${z}`)}function T(z){s(z)}function P(z){const{name:W,value:q}=z.target;j(G=>({...G,[W]:q}))}function R(z){j(typeof z=="number"?W=>({...W,patient_id:z}):z&&typeof z=="object"?W=>({...W,patient_id:z.id}):W=>({...W,patient_id:null}))}async function I(z){if(z.preventDefault(),m(""),!w.patient_id){m("Please select a patient to create an invoice.");return}try{const W={patient_id:Number(w.patient_id),billing_type:w.billing_type||null,context_type:w.context_type||null,context_id:w.context_id?Number(w.context_id):null,remarks:w.remarks||null},{data:q}=await t0e(W);u(!1),j({patient_id:null,billing_type:"op_billing",context_type:"opd",context_id:"",remarks:""}),_(`/billing/invoices/${q.id}`)}catch(W){console.error("Create invoice failed",W),m("Unable to create invoice. Please check details and try again.")}}const O=y.useMemo(()=>Math.max(1,Math.ceil(n.length/Tm)),[n.length]),M=y.useMemo(()=>{const z=(x-1)*Tm;return n.slice(z,z+Tm)},[n,x]);function B(){b(z=>Math.max(1,z-1))}function L(){b(z=>Math.min(O,z+1))}const F=n.length===0?0:(x-1)*Tm+1,V=n.length===0?0:Math.min(x*Tm,n.length);return r.jsxs("div",{className:"min-h-[calc(100vh-4rem)] bg-gradient-to-b from-slate-50 via-slate-100 to-slate-50 py-4 px-3 md:px-6",children:[r.jsxs("div",{className:"max-w-6xl mx-auto space-y-4",children:[r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-slate-900",children:"Billing Console"}),r.jsx("p",{className:"text-xs md:text-sm text-slate-500",children:"One place to manage OP / IP / Lab / Pharmacy billing, refunds and credit tracking."})]}),r.jsx("button",{type:"button",onClick:()=>u(!0),className:"inline-flex items-center justify-center rounded-full bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-500 px-4 py-2 text-xs md:text-sm font-medium text-white shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:"+ New Invoice"})]}),r.jsx("div",{className:"rounded-2xl bg-gradient-to-r from-indigo-50 via-sky-50 to-purple-50 p-2 shadow-sm border border-slate-100",children:r.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1",children:SR.map(z=>{const W=t===z.key;return r.jsx("button",{type:"button",onClick:()=>T(z.key),className:`whitespace-nowrap rounded-full px-3.5 py-1.5 text-xs md:text-[13px] font-medium transition-all ${W?"bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-500 text-white shadow-md":"bg-white/70 text-slate-700 hover:bg-white hover:text-slate-900 border border-slate-200"}`,children:z.label},z.key)})})}),r.jsxs("div",{className:"rounded-2xl bg-white shadow-sm border border-slate-200 overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between px-3 md:px-4 py-2 border-b border-slate-100",children:[r.jsxs("div",{className:"flex flex-col gap-0.5",children:[r.jsx("span",{className:"text-xs font-semibold text-slate-800",children:"Invoices"}),r.jsx("span",{className:"text-[11px] text-slate-400",children:t==="all"?"All billing types":`Filtered by ${((U=SR.find(z=>z.key===t))==null?void 0:U.label)||""}`})]}),r.jsx("button",{type:"button",onClick:k,className:"text-[11px] text-indigo-600 hover:text-indigo-800",children:"Refresh"})]}),f&&r.jsx("div",{className:"px-3 md:px-4 py-2 bg-red-50 text-[11px] text-red-700",children:f}),i?r.jsx("div",{className:"px-3 md:px-4 py-8 text-center text-xs text-slate-500",children:"Loading invoices..."}):n.length===0?r.jsx("div",{className:"px-3 md:px-4 py-8 text-center text-xs text-slate-500",children:"No invoices found for this filter."}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"overflow-x-auto text-xs",children:r.jsxs("table",{className:"min-w-full divide-y divide-slate-100",children:[r.jsx("thead",{className:"bg-slate-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 md:px-4 py-2 text-left font-medium text-slate-500",children:"Inv #"}),r.jsx("th",{className:"px-3 md:px-4 py-2 text-left font-medium text-slate-500",children:"Billing Type"}),r.jsx("th",{className:"px-3 md:px-4 py-2 text-left font-medium text-slate-500",children:"Patient"}),r.jsx("th",{className:"px-3 md:px-4 py-2 text-right font-medium text-slate-500",children:"Net"}),r.jsx("th",{className:"px-3 md:px-4 py-2 text-right font-medium text-slate-500",children:"Paid"}),r.jsx("th",{className:"px-3 md:px-4 py-2 text-right font-medium text-slate-500",children:"Balance"}),r.jsx("th",{className:"px-3 md:px-4 py-2 text-left font-medium text-slate-500",children:"Status"}),r.jsx("th",{className:"px-3 md:px-4 py-2"})]})}),r.jsx("tbody",{className:"divide-y divide-slate-100",children:M.map(z=>r.jsxs("tr",{className:"hover:bg-slate-50 cursor-pointer",onClick:()=>A(z.id),children:[r.jsx("td",{className:"px-3 md:px-4 py-2 text-slate-800 whitespace-nowrap",children:z.invoice_number||z.id}),r.jsx("td",{className:"px-3 md:px-4 py-2 text-slate-600 whitespace-nowrap",children:z.billing_type||"general"}),r.jsxs("td",{className:"px-3 md:px-4 py-2 text-slate-500 whitespace-nowrap",children:["#",z.patient_id]}),r.jsxs("td",{className:"px-3 md:px-4 py-2 text-right text-slate-800 whitespace-nowrap",children:[" ",Vj(z.net_total)]}),r.jsxs("td",{className:"px-3 md:px-4 py-2 text-right text-slate-600 whitespace-nowrap",children:[" ",Vj(z.amount_paid)]}),r.jsxs("td",{className:"px-3 md:px-4 py-2 text-right text-slate-800 whitespace-nowrap",children:[" ",Vj(z.balance_due)]}),r.jsx("td",{className:"px-3 md:px-4 py-2 whitespace-nowrap",children:r.jsx("span",{className:`inline-flex rounded-full px-2.5 py-0.5 text-[10px] font-medium ${e6e[z.status]||"bg-slate-100 text-slate-700"}`,children:z.status})}),r.jsx("td",{className:"px-3 md:px-4 py-2 text-right whitespace-nowrap",children:r.jsx("span",{className:"text-[11px] text-indigo-600 hover:text-indigo-800",children:"Open "})})]},z.id))})]})}),r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2 px-3 md:px-4 py-3 border-t border-slate-100 text-[11px]",children:[r.jsxs("div",{className:"text-slate-500",children:["Showing ",r.jsx("span",{className:"font-medium",children:F}),"",r.jsx("span",{className:"font-medium",children:V})," of"," ",r.jsx("span",{className:"font-medium",children:n.length})," ","invoices"]}),r.jsxs("div",{className:"flex items-center justify-end gap-2",children:[r.jsx("button",{type:"button",onClick:B,disabled:x===1,className:`px-2.5 py-1 rounded-md border text-[11px] ${x===1?"border-slate-200 text-slate-300 cursor-not-allowed":"border-slate-300 text-slate-700 hover:bg-slate-50"}`,children:"Prev"}),r.jsxs("span",{className:"text-slate-500",children:["Page"," ",r.jsx("span",{className:"font-semibold text-slate-800",children:x})," ","/ ",O]}),r.jsx("button",{type:"button",onClick:L,disabled:x===O,className:`px-2.5 py-1 rounded-md border text-[11px] ${x===O?"border-slate-200 text-slate-300 cursor-not-allowed":"border-slate-300 text-slate-700 hover:bg-slate-50"}`,children:"Next"})]})]})]})]})]}),d&&r.jsx("div",{className:"fixed inset-0 z-30 flex items-end sm:items-center justify-center bg-black/40",children:r.jsxs("div",{className:"w-full sm:max-w-md bg-white rounded-t-2xl sm:rounded-2xl shadow-lg p-4 space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"New Invoice"}),r.jsx("button",{type:"button",onClick:()=>u(!1),className:"text-xs text-slate-400 hover:text-slate-600",children:""})]}),r.jsxs("form",{className:"space-y-3",onSubmit:I,children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Patient"}),r.jsx(jU,{value:w.patient_id,onChange:R}),r.jsx("p",{className:"text-[10px] text-slate-400",children:"Search by name / UHID / phone and pick the patient for billing."})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Billing Type"}),r.jsxs("select",{name:"billing_type",value:w.billing_type,onChange:P,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",children:[r.jsx("option",{value:"op_billing",children:"OP Billing"}),r.jsx("option",{value:"ip_billing",children:"IP Billing"}),r.jsx("option",{value:"lab",children:"Lab"}),r.jsx("option",{value:"pharmacy",children:"Pharmacy"}),r.jsx("option",{value:"radiology",children:"Radiology"}),r.jsx("option",{value:"general",children:"General"})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Context Type (optional)"}),r.jsxs("select",{name:"context_type",value:w.context_type,onChange:P,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",children:[r.jsx("option",{value:"",children:"None"}),r.jsx("option",{value:"opd",children:"OPD"}),r.jsx("option",{value:"ipd",children:"IPD"}),r.jsx("option",{value:"lab",children:"Lab"}),r.jsx("option",{value:"radiology",children:"Radiology"}),r.jsx("option",{value:"pharmacy",children:"Pharmacy"}),r.jsx("option",{value:"other",children:"Other"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Context ID (optional)"}),r.jsx("input",{type:"number",name:"context_id",value:w.context_id,onChange:P,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",placeholder:"Visit / admission / order id"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Remarks (optional)"}),r.jsx("input",{type:"text",name:"remarks",value:w.remarks,onChange:P,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",placeholder:"Any note for this invoice"})]})]}),f&&r.jsx("p",{className:"text-[11px] text-red-600",children:f}),r.jsxs("div",{className:"flex gap-2 justify-end pt-1",children:[r.jsx("button",{type:"button",onClick:()=>u(!1),className:"px-3 py-1.5 rounded-md border border-slate-300 text-xs text-slate-700",children:"Cancel"}),r.jsx("button",{type:"submit",className:"px-3 py-1.5 rounded-md bg-indigo-600 text-xs font-medium text-white hover:bg-indigo-700",children:"Create & Open"})]})]})]})})]})}var s6e="Label",AG=y.forwardRef((t,s)=>r.jsx(Qt.label,{...t,ref:s,onMouseDown:n=>{var i;n.target.closest("button, input, select, textarea")||((i=t.onMouseDown)==null||i.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));AG.displayName=s6e;var EG=AG;const n6e=Lb("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),et=y.forwardRef(({className:t,...s},n)=>r.jsx(EG,{ref:n,className:Pt(n6e(),t),...s}));et.displayName=EG.displayName;function jl({label:t,name:s,value:n,onChange:a}){return r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{className:"text-xs font-medium text-slate-600",children:t}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Ee,{type:"color",value:n||"#ffffff",onChange:i=>a(s,i.target.value),className:"w-12 h-9 p-1 cursor-pointer"}),r.jsx(Ee,{type:"text",value:n||"",onChange:i=>a(s,i.target.value),placeholder:"#0f172a",className:"flex-1"})]})]})}function r6e(){const{branding:t,setBranding:s,loading:n}=Pf()||{},[a,i]=y.useState({}),[l,o]=y.useState(!1),[c,d]=y.useState(!1),[u,f]=y.useState(null),[m,x]=y.useState(null),[b,w]=y.useState(null),[j,_]=y.useState(null),[C,k]=y.useState(null),[A,T]=y.useState(null),[P,R]=y.useState("background");y.useEffect(()=>{t&&(R(t.letterhead_position||"background"),i({org_name:t.org_name||"",org_tagline:t.org_tagline||"",org_address:t.org_address||"",org_phone:t.org_phone||"",org_email:t.org_email||"",org_website:t.org_website||"",org_gstin:t.org_gstin||"",primary_color:t.primary_color||"",primary_color_dark:t.primary_color_dark||"",sidebar_bg_color:t.sidebar_bg_color||"",content_bg_color:t.content_bg_color||"",card_bg_color:t.card_bg_color||"",border_color:t.border_color||"",text_color:t.text_color||"",text_muted_color:t.text_muted_color||"",icon_color:t.icon_color||"",icon_bg_color:t.icon_bg_color||"",pdf_header_height_mm:typeof t.pdf_header_height_mm=="number"?t.pdf_header_height_mm:"",pdf_footer_height_mm:typeof t.pdf_footer_height_mm=="number"?t.pdf_footer_height_mm:"",pdf_show_page_number:typeof t.pdf_show_page_number=="boolean"?t.pdf_show_page_number:!0}))},[t]);const I=(q,G)=>{i(se=>({...se,[q]:G}))},O=q=>G=>{I(q,G.target.value)},M=q=>G=>{const se=G.target.value;I(q,se===""?"":Number(se))},B=q=>G=>{I(q,!!G.target.checked)},L=(q,G)=>{I(q,G)},F=async()=>{var q,G,se,ge;o(!0);try{const ke={...a,pdf_header_height_mm:a.pdf_header_height_mm===""?null:Number(a.pdf_header_height_mm),pdf_footer_height_mm:a.pdf_footer_height_mm===""?null:Number(a.pdf_footer_height_mm)},{data:ee}=await kce(ke);s==null||s(ee),ie.success("Branding settings updated")}catch(ke){console.error("Failed to update branding settings",ke);const ee=((G=(q=ke==null?void 0:ke.response)==null?void 0:q.data)==null?void 0:G.detail)||((ge=(se=ke==null?void 0:ke.response)==null?void 0:se.data)==null?void 0:ge.message)||(ke==null?void 0:ke.message)||"Could not save branding settings";ie.error(ee)}finally{o(!1)}},V=async q=>{q.preventDefault(),await F()},U=async q=>{q.preventDefault(),await F()},z=async()=>{var G,se,ge,ke;if(!A){ie.warning("Select a letterhead file first");return}const q=new FormData;q.append("file",A),q.append("position",P);try{const{data:ee}=await Ece(q);s==null||s(ee),ie.success("Letterhead updated successfully"),T(null)}catch(ee){console.error("Failed to upload letterhead",ee);const pe=((se=(G=ee==null?void 0:ee.response)==null?void 0:G.data)==null?void 0:se.detail)||((ke=(ge=ee==null?void 0:ee.response)==null?void 0:ge.data)==null?void 0:ke.message)||(ee==null?void 0:ee.message)||"Could not upload letterhead";ie.error(pe)}},W=async q=>{var se,ge,ke,ee;if(q.preventDefault(),!u&&!m&&!b&&!j&&!C){ie.warning("Select at least one file to upload");return}const G=new FormData;u&&G.append("logo",u),m&&G.append("login_logo",m),b&&G.append("favicon",b),j&&G.append("pdf_header",j),C&&G.append("pdf_footer",C),d(!0);try{const{data:pe}=await Ace(G);s==null||s(pe),ie.success("Branding files uploaded"),f(null),x(null),w(null),_(null),k(null)}catch(pe){console.error("Failed to upload branding files",pe);const ue=((ge=(se=pe==null?void 0:pe.response)==null?void 0:se.data)==null?void 0:ge.detail)||((ee=(ke=pe==null?void 0:pe.response)==null?void 0:ke.data)==null?void 0:ee.message)||(pe==null?void 0:pe.message)||"Could not upload branding files";ie.error(ue)}finally{d(!1)}};return n||!t?r.jsxs("div",{className:"p-6",children:[r.jsx(Je,{className:"h-7 w-64 mb-3"}),r.jsx(Je,{className:"h-64 w-full"})]}):r.jsxs(Nt.div,{className:"p-6 space-y-4",initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2},children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl font-semibold text-slate-900",children:"Customization & Templates"}),r.jsx("p",{className:"text-sm text-slate-500",children:"Configure organisation identity, logo, UI colors, and global PDF header/footer for all NABH HIMS documents."})]})}),r.jsxs(We,{className:"border border-slate-200 rounded-2xl shadow-sm bg-white",children:[r.jsx(st,{className:"pb-2",children:r.jsx(lt,{className:"text-sm font-semibold text-slate-900",children:"Global Branding & PDF Settings"})}),r.jsx(qe,{children:r.jsxs(Hl,{defaultValue:"branding",children:[r.jsxs(ll,{className:"mb-4",children:[r.jsx(xs,{value:"branding",children:"Branding & Organisation"}),r.jsx(xs,{value:"pdf",children:"PDF Header / Footer & Behaviour"})]}),r.jsx(fs,{value:"branding",className:"space-y-6",children:r.jsxs("form",{onSubmit:V,className:"space-y-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:"Organisation details"}),r.jsx("p",{className:"text-xs text-slate-500",children:"These values appear on letterheads, EMR PDFs, discharge summaries and other NABH documents."}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{className:"text-xs text-slate-600",children:"Organisation name"}),r.jsx(Ee,{value:a.org_name||"",onChange:O("org_name"),placeholder:"Hospital / Clinic name"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{className:"text-xs text-slate-600",children:"Tagline"}),r.jsx(Ee,{value:a.org_tagline||"",onChange:O("org_tagline"),placeholder:"Smart  Secure  NABH-Standard"})]}),r.jsxs("div",{className:"space-y-1.5 md:col-span-2",children:[r.jsx(et,{className:"text-xs text-slate-600",children:"Address"}),r.jsx(Ee,{value:a.org_address||"",onChange:O("org_address"),placeholder:"Address line for letterhead & PDFs"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{className:"text-xs text-slate-600",children:"Phone"}),r.jsx(Ee,{value:a.org_phone||"",onChange:O("org_phone"),placeholder:"+91-XXXXXXXXXX"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{className:"text-xs text-slate-600",children:"Email"}),r.jsx(Ee,{type:"email",value:a.org_email||"",onChange:O("org_email"),placeholder:"info@example.com"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{className:"text-xs text-slate-600",children:"Website"}),r.jsx(Ee,{value:a.org_website||"",onChange:O("org_website"),placeholder:"https://your-hospital.com"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{className:"text-xs text-slate-600",children:"GSTIN"}),r.jsx(Ee,{value:a.org_gstin||"",onChange:O("org_gstin"),placeholder:"GSTIN (optional, for bills)"})]})]})]}),r.jsx("div",{className:"border-t border-slate-100"}),r.jsxs("div",{className:"space-y-3",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:"Color palette"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Tune application colors. These drive sidebar, primary buttons and card backgrounds."}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(jl,{label:"Primary color (buttons, highlights)",name:"primary_color",value:a.primary_color,onChange:L}),r.jsx(jl,{label:"Primary dark (topbar / hover)",name:"primary_color_dark",value:a.primary_color_dark,onChange:L}),r.jsx(jl,{label:"Sidebar background color",name:"sidebar_bg_color",value:a.sidebar_bg_color,onChange:L}),r.jsx(jl,{label:"Content background color",name:"content_bg_color",value:a.content_bg_color,onChange:L}),r.jsx(jl,{label:"Card background color",name:"card_bg_color",value:a.card_bg_color,onChange:L}),r.jsx(jl,{label:"Border color",name:"border_color",value:a.border_color,onChange:L}),r.jsx(jl,{label:"Text color",name:"text_color",value:a.text_color,onChange:L}),r.jsx(jl,{label:"Muted text color",name:"text_muted_color",value:a.text_muted_color,onChange:L}),r.jsx(jl,{label:"Icon color",name:"icon_color",value:a.icon_color,onChange:L}),r.jsx(jl,{label:"Icon background color",name:"icon_bg_color",value:a.icon_bg_color,onChange:L})]})]}),r.jsxs("div",{className:"flex items-center justify-between pt-2",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[(t==null?void 0:t.logo_url)&&r.jsx("img",{src:t.logo_url,alt:"Logo preview",className:"h-8 w-auto rounded-sm border border-slate-200 bg-white"}),r.jsxs("span",{className:"text-xs text-slate-500",children:["Logos & PDF artwork are managed in the"," ",r.jsx("span",{className:"font-medium",children:"PDF Header / Footer"})," tab."]})]}),r.jsx(Re,{type:"submit",disabled:l,className:"min-w-[140px]",children:l?"Saving":"Save branding"})]})]})}),r.jsxs(fs,{value:"pdf",className:"space-y-6",children:[r.jsxs("form",{onSubmit:W,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(et,{className:"text-xs font-medium text-slate-600",children:"Application logo (sidebar / topbar)"}),r.jsxs("div",{className:"border border-dashed border-slate-300 rounded-2xl p-3 flex flex-col items-center gap-2",children:[(t==null?void 0:t.logo_url)&&r.jsx("img",{src:t.logo_url,alt:"Logo",className:"h-8 w-auto rounded-sm border border-slate-200 bg-white mb-1"}),r.jsxs("label",{className:"w-full",children:[r.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs cursor-pointer",children:[r.jsx(xm,{className:"h-4 w-4"}),r.jsx("span",{children:"Choose logo (PNG / JPG)"})]}),r.jsx(Ee,{type:"file",accept:"image/*",className:"hidden",onChange:q=>{var G;return f(((G=q.target.files)==null?void 0:G[0])||null)}})]}),u&&r.jsx("p",{className:"text-[11px] text-slate-500 truncate w-full text-center",children:u.name})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(et,{className:"text-xs font-medium text-slate-600",children:"Login-page logo (optional)"}),r.jsxs("div",{className:"border border-dashed border-slate-300 rounded-2xl p-3 flex flex-col items-center gap-2",children:[(t==null?void 0:t.login_logo_url)&&r.jsx("img",{src:t.login_logo_url,alt:"Login logo",className:"h-8 w-auto rounded-sm border border-slate-200 bg-white mb-1"}),r.jsxs("label",{className:"w-full",children:[r.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs cursor-pointer",children:[r.jsx(xm,{className:"h-4 w-4"}),r.jsx("span",{children:"Choose login logo"})]}),r.jsx(Ee,{type:"file",accept:"image/*",className:"hidden",onChange:q=>{var G;return x(((G=q.target.files)==null?void 0:G[0])||null)}})]}),m&&r.jsx("p",{className:"text-[11px] text-slate-500 truncate w-full text-center",children:m.name})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(et,{className:"text-xs font-medium text-slate-600",children:"Favicon (browser tab icon)"}),r.jsxs("div",{className:"border border-dashed border-slate-300 rounded-2xl p-3 flex flex-col items-center gap-2",children:[(t==null?void 0:t.favicon_url)&&r.jsx("img",{src:t.favicon_url,alt:"Favicon",className:"h-6 w-6 rounded-sm border border-slate-200 bg-white mb-1"}),r.jsxs("label",{className:"w-full",children:[r.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs cursor-pointer",children:[r.jsx(xm,{className:"h-4 w-4"}),r.jsx("span",{children:"Choose favicon (PNG / ICO)"})]}),r.jsx(Ee,{type:"file",accept:"image/*,.ico",className:"hidden",onChange:q=>{var G;return w(((G=q.target.files)==null?void 0:G[0])||null)}})]}),b&&r.jsx("p",{className:"text-[11px] text-slate-500 truncate w-full text-center",children:b.name})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(et,{className:"text-xs font-medium text-slate-600",children:"PDF header template (all documents)"}),r.jsxs("div",{className:"border border-dashed border-slate-300 rounded-2xl p-3 flex flex-col items-center gap-2",children:[(t==null?void 0:t.pdf_header_url)&&r.jsx("img",{src:t.pdf_header_url,alt:"PDF header",className:"h-12 w-auto rounded-sm border border-slate-200 bg-white mb-1"}),r.jsxs("label",{className:"w-full",children:[r.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs cursor-pointer",children:[r.jsx(xm,{className:"h-4 w-4"}),r.jsx("span",{children:"Choose header image"})]}),r.jsx(Ee,{type:"file",accept:"image/*",className:"hidden",onChange:q=>{var G;return _(((G=q.target.files)==null?void 0:G[0])||null)}})]}),j&&r.jsx("p",{className:"text-[11px] text-slate-500 truncate w-full text-center",children:j.name})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(et,{className:"text-xs font-medium text-slate-600",children:"PDF footer template (all documents)"}),r.jsxs("div",{className:"border border-dashed border-slate-300 rounded-2xl p-3 flex flex-col items-center gap-2",children:[(t==null?void 0:t.pdf_footer_url)&&r.jsx("img",{src:t.pdf_footer_url,alt:"PDF footer",className:"h-12 w-auto rounded-sm border border-slate-200 bg-white mb-1"}),r.jsxs("label",{className:"w-full",children:[r.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs cursor-pointer",children:[r.jsx(xm,{className:"h-4 w-4"}),r.jsx("span",{children:"Choose footer image"})]}),r.jsx(Ee,{type:"file",accept:"image/*",className:"hidden",onChange:q=>{var G;return k(((G=q.target.files)==null?void 0:G[0])||null)}})]}),C&&r.jsx("p",{className:"text-[11px] text-slate-500 truncate w-full text-center",children:C.name})]})]})]}),r.jsxs("div",{className:"flex items-center justify-between pt-2",children:[r.jsx("p",{className:"text-[11px] text-slate-500 max-w-xl",children:"These logo/header/footer templates will be applied to all PDF downloads (EMR, discharge summary, lab reports, invoices, etc.) to keep NABH-compliant formatting."}),r.jsx(Re,{type:"submit",disabled:c,className:"min-w-[160px]",children:c?"Uploading":"Upload artwork"})]})]}),r.jsxs("form",{onSubmit:U,className:"space-y-4",children:[r.jsx("div",{className:"border-t border-slate-100 pt-4"}),r.jsxs("div",{className:"space-y-3",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:"PDF layout behaviour"}),r.jsx("p",{className:"text-xs text-slate-500",children:'Control reserved space for header/footer and whether to show "Page X of Y" in the footer.'}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{className:"text-xs text-slate-600",children:"Header height (mm)"}),r.jsx(Ee,{type:"number",min:0,value:a.pdf_header_height_mm===""?"":a.pdf_header_height_mm,onChange:M("pdf_header_height_mm"),placeholder:"Auto"}),r.jsx("p",{className:"text-[11px] text-slate-400",children:"Leave blank to auto-calc based on header image."})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{className:"text-xs text-slate-600",children:"Footer height (mm)"}),r.jsx(Ee,{type:"number",min:0,value:a.pdf_footer_height_mm===""?"":a.pdf_footer_height_mm,onChange:M("pdf_footer_height_mm"),placeholder:"Auto"}),r.jsx("p",{className:"text-[11px] text-slate-400",children:"Leave blank to auto-calc based on footer image."})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{className:"text-xs text-slate-600",children:"Page number in footer"}),r.jsxs("label",{className:"inline-flex items-center gap-2 text-xs text-slate-600",children:[r.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300",checked:!!a.pdf_show_page_number,onChange:B("pdf_show_page_number")}),r.jsx("span",{children:'Show "Page X of Y" on all PDFs'})]})]})]})]}),r.jsx("div",{className:"flex items-center justify-end pt-1",children:r.jsx(Re,{type:"submit",disabled:l,className:"min-w-[160px]",children:l?"Saving":"Save PDF settings"})})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(et,{className:"text-xs font-medium text-slate-600",children:"Upload Letterhead (PDF / JPG / PNG / DOCX)"}),r.jsxs("div",{className:"border border-dashed p-3 rounded-xl space-y-3",children:[(t==null?void 0:t.letterhead_url)&&r.jsxs("p",{className:"text-xs text-slate-600",children:["Current file:"," ",r.jsx("span",{className:"font-medium",children:t.letterhead_url.split("/").pop()})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-xs text-slate-600",children:[r.jsxs("label",{className:"inline-flex items-center gap-1",children:[r.jsx("input",{type:"radio",className:"h-3 w-3",value:"background",checked:P==="background",onChange:q=>R(q.target.value)}),r.jsx("span",{children:"Full-page background"})]}),r.jsxs("label",{className:"inline-flex items-center gap-1",children:[r.jsx("input",{type:"radio",className:"h-3 w-3",value:"none",checked:P==="none",onChange:q=>R(q.target.value)}),r.jsx("span",{children:"Disable letterhead background (use header/footer only)"})]})]}),r.jsx(Ee,{type:"file",accept:"image/*,application/pdf,.doc,.docx",onChange:q=>{var G;return T(((G=q.target.files)==null?void 0:G[0])||null)}}),A&&r.jsx("p",{className:"text-xs mt-1 text-slate-600",children:A.name}),r.jsx(Re,{disabled:!A,onClick:z,className:"mt-2",children:"Upload Letterhead"})]})]})]})]})})]})]})}const CR=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];function a6e(){const[t,s]=y.useState(null),[n,a]=y.useState("0"),[i,l]=y.useState("09:00"),[o,c]=y.useState("13:00"),[d,u]=y.useState("15"),[f,m]=y.useState([]),[x,b]=y.useState(!1),[w,j]=y.useState(!1),[_,C]=y.useState(null),k=y.useCallback(O=>{s(O)},[]),A=y.useCallback(async()=>{if(!t){m([]);return}try{b(!0);const{data:O}=await oue(t);m(O||[])}catch(O){console.error(O),ie.error("Failed to load schedules")}finally{b(!1)}},[t]);y.useEffect(()=>{A()},[A]);const T=async O=>{var B,L,F;if((B=O==null?void 0:O.preventDefault)==null||B.call(O),!t){ie.error("Select doctor first");return}const M=Number(n);if(f.some(V=>V.weekday===M)){ie.error("Schedule for this weekday already exists. Edit / delete existing slot instead.");return}try{j(!0),await cue({doctor_user_id:t,weekday:M,start_time:i,end_time:o,slot_minutes:Number(d)||15}),ie.success("Schedule saved"),A()}catch(V){console.error(V),ie.error(((F=(L=V==null?void 0:V.response)==null?void 0:L.data)==null?void 0:F.detail)||"Failed to save schedule")}finally{j(!1)}},P=async O=>{var M,B;if(window.confirm("Delete this schedule slot?"))try{C(O),await due(O),ie.success("Schedule deleted"),m(L=>L.filter(F=>F.id!==O))}catch(L){console.error(L),ie.error(((B=(M=L==null?void 0:L.response)==null?void 0:M.data)==null?void 0:B.detail)||"Failed to delete schedule")}finally{C(null)}},R=!!t,I=y.useMemo(()=>`${f.length} weekday slot${f.length===1?"":"s"} configured`,[f.length]);return r.jsx("div",{className:"min-h-[calc(100vh-5rem)] bg-slate-50 px-4 py-6 md:px-6",children:r.jsxs("div",{className:"mx-auto max-w-5xl space-y-6",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.2em] text-sky-700",children:"OPD Scheduling"}),r.jsx("h1",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"Doctor OPD Schedules"}),r.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Configure weekday-wise OPD timings for each doctor. Duplicate weekday entries are blocked to keep the roster clean."})]}),r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsx(st,{className:"border-b border-slate-100 pb-4",children:r.jsxs(lt,{className:"flex items-center justify-between text-base font-semibold text-slate-900",children:[r.jsx("span",{children:"Schedule Setup"}),r.jsx("span",{className:"text-xs font-normal text-slate-500",children:I})]})}),r.jsxs(qe,{className:"pt-4 space-y-4",children:[r.jsxs("div",{className:"grid gap-4 md:grid-cols-[2fr,1.5fr]",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:"Doctor"}),r.jsx(Fo,{value:t,onChange:k}),!t&&r.jsx("p",{className:"mt-1 text-[11px] text-amber-600",children:"Select a doctor to view and update OPD schedules."})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(Kn,{className:"h-3 w-3"}),"Weekday"]}),r.jsxs(Ms,{value:n,onValueChange:a,children:[r.jsx(Es,{className:"h-9 text-sm",children:r.jsx(Ds,{placeholder:"Select weekday"})}),r.jsx(Ts,{children:CR.map((O,M)=>r.jsx(Mt,{value:String(M),children:O},M))})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(Sa,{className:"h-3 w-3"}),"Start"]}),r.jsx(Ee,{type:"time",value:i,onChange:O=>l(O.target.value),className:"h-9 text-sm"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(Sa,{className:"h-3 w-3"}),"End"]}),r.jsx(Ee,{type:"time",value:o,onChange:O=>c(O.target.value),className:"h-9 text-sm"})]})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-[1fr,auto] md:items-end",children:[r.jsxs("div",{className:"space-y-1.5 max-w-xs",children:[r.jsx("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:"Slot duration (minutes)"}),r.jsx(Ee,{type:"number",min:5,step:5,value:d,onChange:O=>u(O.target.value),className:"h-9 text-sm"}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-400",children:"Used when generating appointment slots (e.g., 10 / 15 / 20)."})]}),r.jsx("div",{className:"flex justify-end",children:r.jsx(Re,{type:"button",className:"px-5",disabled:!R||w,onClick:T,children:w?"Saving":"Add Weekday Slot"})})]})]})]}),r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsx(st,{className:"border-b border-slate-100 pb-3",children:r.jsx(lt,{className:"text-sm font-semibold text-slate-900",children:"Existing Schedules"})}),r.jsxs(qe,{className:"pt-4",children:[x&&r.jsx("div",{className:"space-y-2",children:[1,2,3].map(O=>r.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-100 bg-slate-50 px-3 py-3",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Je,{className:"h-4 w-40"}),r.jsx(Je,{className:"h-3 w-24"})]}),r.jsx(Je,{className:"h-8 w-8 rounded-full"})]},O))}),!x&&(!f||f.length===0)&&r.jsx("p",{className:"py-6 text-sm text-slate-500",children:"No schedules configured yet for this doctor."}),!x&&f&&f.length>0&&r.jsx("div",{className:"grid gap-2 sm:grid-cols-2",children:f.map(O=>{var M,B;return r.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-3 text-sm shadow-sm",children:[r.jsxs("div",{className:"space-y-0.5",children:[r.jsx("div",{className:"flex flex-wrap items-center gap-1.5",children:r.jsxs("span",{className:"font-semibold text-slate-900",children:[CR[O.weekday]," "," ",(M=O.start_time)==null?void 0:M.slice(0,5),"",(B=O.end_time)==null?void 0:B.slice(0,5)]})}),r.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-slate-500",children:[r.jsxs(Ge,{variant:"outline",className:"border-slate-200 bg-slate-50 px-2 py-0.5 text-[11px]",children:["Slot: ",O.slot_minutes||15," min"]}),O.location&&r.jsx(Ge,{variant:"outline",className:"border-slate-200 bg-slate-50 px-2 py-0.5 text-[11px]",children:O.location})]})]}),r.jsx(Re,{variant:"ghost",size:"icon",className:"h-8 w-8 text-slate-400 hover:text-rose-600",onClick:()=>P(O.id),disabled:_===O.id,children:r.jsx(qr,{className:"h-4 w-4"})})]},O.id)})})]})]})]})})}function i6e(t,s){return y.useReducer((n,a)=>s[n][a]??n,t)}var aE="ScrollArea",[TG]=Mu(aE),[l6e,Ri]=TG(aE),PG=y.forwardRef((t,s)=>{const{__scopeScrollArea:n,type:a="hover",dir:i,scrollHideDelay:l=600,...o}=t,[c,d]=y.useState(null),[u,f]=y.useState(null),[m,x]=y.useState(null),[b,w]=y.useState(null),[j,_]=y.useState(null),[C,k]=y.useState(0),[A,T]=y.useState(0),[P,R]=y.useState(!1),[I,O]=y.useState(!1),M=Ss(s,L=>d(L)),B=Ub(i);return r.jsx(l6e,{scope:n,type:a,dir:B,scrollHideDelay:l,scrollArea:c,viewport:u,onViewportChange:f,content:m,onContentChange:x,scrollbarX:b,onScrollbarXChange:w,scrollbarXEnabled:P,onScrollbarXEnabledChange:R,scrollbarY:j,onScrollbarYChange:_,scrollbarYEnabled:I,onScrollbarYEnabledChange:O,onCornerWidthChange:k,onCornerHeightChange:T,children:r.jsx(Qt.div,{dir:B,...o,ref:M,style:{position:"relative","--radix-scroll-area-corner-width":C+"px","--radix-scroll-area-corner-height":A+"px",...t.style}})})});PG.displayName=aE;var IG="ScrollAreaViewport",MG=y.forwardRef((t,s)=>{const{__scopeScrollArea:n,children:a,nonce:i,...l}=t,o=Ri(IG,n),c=y.useRef(null),d=Ss(s,c,o.onViewportChange);return r.jsxs(r.Fragment,{children:[r.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),r.jsx(Qt.div,{"data-radix-scroll-area-viewport":"",...l,ref:d,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...t.style},children:r.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:a})})]})});MG.displayName=IG;var to="ScrollAreaScrollbar",iE=y.forwardRef((t,s)=>{const{forceMount:n,...a}=t,i=Ri(to,t.__scopeScrollArea),{onScrollbarXEnabledChange:l,onScrollbarYEnabledChange:o}=i,c=t.orientation==="horizontal";return y.useEffect(()=>(c?l(!0):o(!0),()=>{c?l(!1):o(!1)}),[c,l,o]),i.type==="hover"?r.jsx(o6e,{...a,ref:s,forceMount:n}):i.type==="scroll"?r.jsx(c6e,{...a,ref:s,forceMount:n}):i.type==="auto"?r.jsx(DG,{...a,ref:s,forceMount:n}):i.type==="always"?r.jsx(lE,{...a,ref:s}):null});iE.displayName=to;var o6e=y.forwardRef((t,s)=>{const{forceMount:n,...a}=t,i=Ri(to,t.__scopeScrollArea),[l,o]=y.useState(!1);return y.useEffect(()=>{const c=i.scrollArea;let d=0;if(c){const u=()=>{window.clearTimeout(d),o(!0)},f=()=>{d=window.setTimeout(()=>o(!1),i.scrollHideDelay)};return c.addEventListener("pointerenter",u),c.addEventListener("pointerleave",f),()=>{window.clearTimeout(d),c.removeEventListener("pointerenter",u),c.removeEventListener("pointerleave",f)}}},[i.scrollArea,i.scrollHideDelay]),r.jsx($o,{present:n||l,children:r.jsx(DG,{"data-state":l?"visible":"hidden",...a,ref:s})})}),c6e=y.forwardRef((t,s)=>{const{forceMount:n,...a}=t,i=Ri(to,t.__scopeScrollArea),l=t.orientation==="horizontal",o=dw(()=>d("SCROLL_END"),100),[c,d]=i6e("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return y.useEffect(()=>{if(c==="idle"){const u=window.setTimeout(()=>d("HIDE"),i.scrollHideDelay);return()=>window.clearTimeout(u)}},[c,i.scrollHideDelay,d]),y.useEffect(()=>{const u=i.viewport,f=l?"scrollLeft":"scrollTop";if(u){let m=u[f];const x=()=>{const b=u[f];m!==b&&(d("SCROLL"),o()),m=b};return u.addEventListener("scroll",x),()=>u.removeEventListener("scroll",x)}},[i.viewport,l,d,o]),r.jsx($o,{present:n||c!=="hidden",children:r.jsx(lE,{"data-state":c==="hidden"?"hidden":"visible",...a,ref:s,onPointerEnter:Wt(t.onPointerEnter,()=>d("POINTER_ENTER")),onPointerLeave:Wt(t.onPointerLeave,()=>d("POINTER_LEAVE"))})})}),DG=y.forwardRef((t,s)=>{const n=Ri(to,t.__scopeScrollArea),{forceMount:a,...i}=t,[l,o]=y.useState(!1),c=t.orientation==="horizontal",d=dw(()=>{if(n.viewport){const u=n.viewport.offsetWidth<n.viewport.scrollWidth,f=n.viewport.offsetHeight<n.viewport.scrollHeight;o(c?u:f)}},10);return xf(n.viewport,d),xf(n.content,d),r.jsx($o,{present:a||l,children:r.jsx(lE,{"data-state":l?"visible":"hidden",...i,ref:s})})}),lE=y.forwardRef((t,s)=>{const{orientation:n="vertical",...a}=t,i=Ri(to,t.__scopeScrollArea),l=y.useRef(null),o=y.useRef(0),[c,d]=y.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=FG(c.viewport,c.content),f={...a,sizes:c,onSizesChange:d,hasThumb:u>0&&u<1,onThumbChange:x=>l.current=x,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:x=>o.current=x};function m(x,b){return p6e(x,o.current,c,b)}return n==="horizontal"?r.jsx(d6e,{...f,ref:s,onThumbPositionChange:()=>{if(i.viewport&&l.current){const x=i.viewport.scrollLeft,b=kR(x,c,i.dir);l.current.style.transform=`translate3d(${b}px, 0, 0)`}},onWheelScroll:x=>{i.viewport&&(i.viewport.scrollLeft=x)},onDragScroll:x=>{i.viewport&&(i.viewport.scrollLeft=m(x,i.dir))}}):n==="vertical"?r.jsx(u6e,{...f,ref:s,onThumbPositionChange:()=>{if(i.viewport&&l.current){const x=i.viewport.scrollTop,b=kR(x,c);l.current.style.transform=`translate3d(0, ${b}px, 0)`}},onWheelScroll:x=>{i.viewport&&(i.viewport.scrollTop=x)},onDragScroll:x=>{i.viewport&&(i.viewport.scrollTop=m(x))}}):null}),d6e=y.forwardRef((t,s)=>{const{sizes:n,onSizesChange:a,...i}=t,l=Ri(to,t.__scopeScrollArea),[o,c]=y.useState(),d=y.useRef(null),u=Ss(s,d,l.onScrollbarXChange);return y.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),r.jsx(RG,{"data-orientation":"horizontal",...i,ref:u,sizes:n,style:{bottom:0,left:l.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:l.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":cw(n)+"px",...t.style},onThumbPointerDown:f=>t.onThumbPointerDown(f.x),onDragScroll:f=>t.onDragScroll(f.x),onWheelScroll:(f,m)=>{if(l.viewport){const x=l.viewport.scrollLeft+f.deltaX;t.onWheelScroll(x),zG(x,m)&&f.preventDefault()}},onResize:()=>{d.current&&l.viewport&&o&&a({content:l.viewport.scrollWidth,viewport:l.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:J1(o.paddingLeft),paddingEnd:J1(o.paddingRight)}})}})}),u6e=y.forwardRef((t,s)=>{const{sizes:n,onSizesChange:a,...i}=t,l=Ri(to,t.__scopeScrollArea),[o,c]=y.useState(),d=y.useRef(null),u=Ss(s,d,l.onScrollbarYChange);return y.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),r.jsx(RG,{"data-orientation":"vertical",...i,ref:u,sizes:n,style:{top:0,right:l.dir==="ltr"?0:void 0,left:l.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":cw(n)+"px",...t.style},onThumbPointerDown:f=>t.onThumbPointerDown(f.y),onDragScroll:f=>t.onDragScroll(f.y),onWheelScroll:(f,m)=>{if(l.viewport){const x=l.viewport.scrollTop+f.deltaY;t.onWheelScroll(x),zG(x,m)&&f.preventDefault()}},onResize:()=>{d.current&&l.viewport&&o&&a({content:l.viewport.scrollHeight,viewport:l.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:J1(o.paddingTop),paddingEnd:J1(o.paddingBottom)}})}})}),[h6e,OG]=TG(to),RG=y.forwardRef((t,s)=>{const{__scopeScrollArea:n,sizes:a,hasThumb:i,onThumbChange:l,onThumbPointerUp:o,onThumbPointerDown:c,onThumbPositionChange:d,onDragScroll:u,onWheelScroll:f,onResize:m,...x}=t,b=Ri(to,n),[w,j]=y.useState(null),_=Ss(s,M=>j(M)),C=y.useRef(null),k=y.useRef(""),A=b.viewport,T=a.content-a.viewport,P=ea(f),R=ea(d),I=dw(m,10);function O(M){if(C.current){const B=M.clientX-C.current.left,L=M.clientY-C.current.top;u({x:B,y:L})}}return y.useEffect(()=>{const M=B=>{const L=B.target;(w==null?void 0:w.contains(L))&&P(B,T)};return document.addEventListener("wheel",M,{passive:!1}),()=>document.removeEventListener("wheel",M,{passive:!1})},[A,w,T,P]),y.useEffect(R,[a,R]),xf(w,I),xf(b.content,I),r.jsx(h6e,{scope:n,scrollbar:w,hasThumb:i,onThumbChange:ea(l),onThumbPointerUp:ea(o),onThumbPositionChange:R,onThumbPointerDown:ea(c),children:r.jsx(Qt.div,{...x,ref:_,style:{position:"absolute",...x.style},onPointerDown:Wt(t.onPointerDown,M=>{M.button===0&&(M.target.setPointerCapture(M.pointerId),C.current=w.getBoundingClientRect(),k.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",b.viewport&&(b.viewport.style.scrollBehavior="auto"),O(M))}),onPointerMove:Wt(t.onPointerMove,O),onPointerUp:Wt(t.onPointerUp,M=>{const B=M.target;B.hasPointerCapture(M.pointerId)&&B.releasePointerCapture(M.pointerId),document.body.style.webkitUserSelect=k.current,b.viewport&&(b.viewport.style.scrollBehavior=""),C.current=null})})})}),Z1="ScrollAreaThumb",LG=y.forwardRef((t,s)=>{const{forceMount:n,...a}=t,i=OG(Z1,t.__scopeScrollArea);return r.jsx($o,{present:n||i.hasThumb,children:r.jsx(f6e,{ref:s,...a})})}),f6e=y.forwardRef((t,s)=>{const{__scopeScrollArea:n,style:a,...i}=t,l=Ri(Z1,n),o=OG(Z1,n),{onThumbPositionChange:c}=o,d=Ss(s,m=>o.onThumbChange(m)),u=y.useRef(void 0),f=dw(()=>{u.current&&(u.current(),u.current=void 0)},100);return y.useEffect(()=>{const m=l.viewport;if(m){const x=()=>{if(f(),!u.current){const b=x6e(m,c);u.current=b,c()}};return c(),m.addEventListener("scroll",x),()=>m.removeEventListener("scroll",x)}},[l.viewport,f,c]),r.jsx(Qt.div,{"data-state":o.hasThumb?"visible":"hidden",...i,ref:d,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...a},onPointerDownCapture:Wt(t.onPointerDownCapture,m=>{const b=m.target.getBoundingClientRect(),w=m.clientX-b.left,j=m.clientY-b.top;o.onThumbPointerDown({x:w,y:j})}),onPointerUp:Wt(t.onPointerUp,o.onThumbPointerUp)})});LG.displayName=Z1;var oE="ScrollAreaCorner",BG=y.forwardRef((t,s)=>{const n=Ri(oE,t.__scopeScrollArea),a=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&a?r.jsx(m6e,{...t,ref:s}):null});BG.displayName=oE;var m6e=y.forwardRef((t,s)=>{const{__scopeScrollArea:n,...a}=t,i=Ri(oE,n),[l,o]=y.useState(0),[c,d]=y.useState(0),u=!!(l&&c);return xf(i.scrollbarX,()=>{var m;const f=((m=i.scrollbarX)==null?void 0:m.offsetHeight)||0;i.onCornerHeightChange(f),d(f)}),xf(i.scrollbarY,()=>{var m;const f=((m=i.scrollbarY)==null?void 0:m.offsetWidth)||0;i.onCornerWidthChange(f),o(f)}),u?r.jsx(Qt.div,{...a,ref:s,style:{width:l,height:c,position:"absolute",right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function J1(t){return t?parseInt(t,10):0}function FG(t,s){const n=t/s;return isNaN(n)?0:n}function cw(t){const s=FG(t.viewport,t.content),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,a=(t.scrollbar.size-n)*s;return Math.max(a,18)}function p6e(t,s,n,a="ltr"){const i=cw(n),l=i/2,o=s||l,c=i-o,d=n.scrollbar.paddingStart+o,u=n.scrollbar.size-n.scrollbar.paddingEnd-c,f=n.content-n.viewport,m=a==="ltr"?[0,f]:[f*-1,0];return $G([d,u],m)(t)}function kR(t,s,n="ltr"){const a=cw(s),i=s.scrollbar.paddingStart+s.scrollbar.paddingEnd,l=s.scrollbar.size-i,o=s.content-s.viewport,c=l-a,d=n==="ltr"?[0,o]:[o*-1,0],u=U_(t,d);return $G([0,o],[0,c])(u)}function $G(t,s){return n=>{if(t[0]===t[1]||s[0]===s[1])return s[0];const a=(s[1]-s[0])/(t[1]-t[0]);return s[0]+a*(n-t[0])}}function zG(t,s){return t>0&&t<s}var x6e=(t,s=()=>{})=>{let n={left:t.scrollLeft,top:t.scrollTop},a=0;return function i(){const l={left:t.scrollLeft,top:t.scrollTop},o=n.left!==l.left,c=n.top!==l.top;(o||c)&&s(),n=l,a=window.requestAnimationFrame(i)}(),()=>window.cancelAnimationFrame(a)};function dw(t,s){const n=ea(t),a=y.useRef(0);return y.useEffect(()=>()=>window.clearTimeout(a.current),[]),y.useCallback(()=>{window.clearTimeout(a.current),a.current=window.setTimeout(n,s)},[n,s])}function xf(t,s){const n=ea(s);Pr(()=>{let a=0;if(t){const i=new ResizeObserver(()=>{cancelAnimationFrame(a),a=window.requestAnimationFrame(n)});return i.observe(t),()=>{window.cancelAnimationFrame(a),i.unobserve(t)}}},[t,n])}var UG=PG,g6e=MG,y6e=BG;const xa=y.forwardRef(({className:t,children:s,...n},a)=>r.jsxs(UG,{ref:a,className:Pt("relative overflow-hidden",t),...n,children:[r.jsx(g6e,{className:"h-full w-full rounded-[inherit]",children:s}),r.jsx(VG,{}),r.jsx(y6e,{})]}));xa.displayName=UG.displayName;const VG=y.forwardRef(({className:t,orientation:s="vertical",...n},a)=>r.jsx(iE,{ref:a,orientation:s,className:Pt("flex touch-none select-none transition-colors",s==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",s==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...n,children:r.jsx(LG,{className:"relative flex-1 rounded-full bg-border"})}));VG.displayName=iE.displayName;var b6e="Separator",AR="horizontal",v6e=["horizontal","vertical"],HG=y.forwardRef((t,s)=>{const{decorative:n,orientation:a=AR,...i}=t,l=w6e(a)?a:AR,c=n?{role:"none"}:{"aria-orientation":l==="vertical"?l:void 0,role:"separator"};return r.jsx(Qt.div,{"data-orientation":l,...c,...i,ref:s})});HG.displayName=b6e;function w6e(t){return v6e.includes(t)}var WG=HG;const eb=y.forwardRef(({className:t,orientation:s="horizontal",decorative:n=!0,...a},i)=>r.jsx(WG,{ref:i,decorative:n,orientation:s,className:Pt("shrink-0 bg-border",s==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...a}));eb.displayName=WG.displayName;const N6e=()=>new Date().toISOString().slice(0,10);function j6e(){const[t,s]=y.useState(N6e()),[n,a]=y.useState(null),[i,l]=y.useState(null),[o,c]=y.useState(null),[d,u]=y.useState("Consultation"),[f,m]=y.useState([]),[x,b]=y.useState(""),[w,j]=y.useState(!1),[_,C]=y.useState([]),[k,A]=y.useState(!1),T=(M,B)=>{a(M),l((B==null?void 0:B.department_id)||null),b("")},P=M=>{c(M)};y.useEffect(()=>{(async()=>{if(!n||!t){m([]),C([]);return}try{j(!0);const{data:B}=await UP({doctorUserId:Number(n),date:t,detailed:!0}),L=Array.isArray(B)?B:(B==null?void 0:B.slots)||[];m(L)}catch{m([])}finally{j(!1)}try{A(!0);const{data:B}=await VP({date:t,doctor_id:Number(n)});C(B||[])}catch{C([])}finally{A(!1)}})()},[n,t]);const R=y.useMemo(()=>f.filter(M=>M.status==="free"||!M.status),[f]),I=y.useMemo(()=>{var F;const M=_.length,B=R.length,L=x||((F=R[0])!=null&&F.start?`Earliest ${R[0].start}`:"Not selected");return{total:M,free:B,selected:L}},[_,R,x]),O=async M=>{if(M.preventDefault(),!o){ie.error("Please select a patient");return}if(!n||!i){ie.error("Please select department & doctor");return}if(!x){ie.error("Please choose a time slot");return}try{await uue({patient_id:o,department_id:i,doctor_user_id:n,date:t,slot_start:x,purpose:d||"Consultation"}),ie.success("Appointment booked"),b("");const{data:B}=await VP({date:t,doctor_id:Number(n)});C(B||[]);const{data:L}=await UP({doctorUserId:Number(n),date:t,detailed:!0}),F=Array.isArray(L)?L:(L==null?void 0:L.slots)||[];m(F)}catch{}};return r.jsx("div",{className:"h-full w-full bg-[#eee] rounded",children:r.jsxs("div",{className:"mx-auto flex max-w-6xl flex-col gap-4 px-3 py-4 sm:px-4 lg:px-6 lg:py-6",children:[r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white px-3 py-1 text-xs text-slate-500 shadow-sm",children:[r.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-500 animate-pulse"}),r.jsx("span",{children:"Live OPD  Booking & Queue"})]}),r.jsx("h1",{className:"text-xl font-semibold text-slate-900 sm:text-2xl",children:"OPD Appointment Booking"}),r.jsx("p",{className:"text-xs text-slate-500 sm:text-sm",children:"Quickly book patient appointments, view doctor schedule, and monitor today's queue."})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:justify-end",children:[r.jsxs(Ge,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-white px-3 py-1 text-[11px] font-normal text-slate-700 shadow-sm",children:[r.jsx(Kn,{className:"h-3 w-3"}),t]}),n&&r.jsxs(Ge,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-white px-3 py-1 text-[11px] font-normal text-slate-700 shadow-sm",children:[r.jsx(_s,{className:"h-3 w-3"}),"Doctor ID ",n]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-3",children:[r.jsx(We,{className:"rounded-2xl border-slate-200 shadow-sm",children:r.jsxs(qe,{className:"flex items-center justify-between gap-3 py-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Today's appointments"}),r.jsx("p",{className:"text-xl font-semibold text-slate-900",children:I.total})]}),r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-2",children:r.jsx(Pp,{className:"h-5 w-5 text-slate-700"})})]})}),r.jsx(We,{className:"rounded-2xl border-slate-200 shadow-sm",children:r.jsxs(qe,{className:"flex items-center justify-between gap-3 py-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Free slots"}),r.jsx("p",{className:"text-xl font-semibold text-slate-900",children:I.free})]}),r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-2",children:r.jsx(Sa,{className:"h-5 w-5 text-slate-700"})})]})}),r.jsx(We,{className:"rounded-2xl border-slate-200 shadow-sm",children:r.jsxs(qe,{className:"flex items-center justify-between gap-3 py-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Selected time"}),r.jsx("p",{className:"text-sm font-semibold text-slate-900",children:I.selected})]}),r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-2",children:r.jsx(sn,{className:"h-5 w-5 text-slate-700"})})]})})]}),r.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.6fr),minmax(0,1.4fr)] lg:gap-6",children:[r.jsx(Nt.div,{layout:!0,initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.18},children:r.jsxs(We,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsxs(st,{className:"pb-3",children:[r.jsxs(lt,{className:"flex items-center gap-2 text-base font-semibold text-slate-900 sm:text-lg",children:[r.jsx("span",{className:"inline-flex h-7 w-7 items-center justify-center rounded-2xl bg-slate-900 text-xs text-white",children:"1"}),"Book a new appointment"]}),r.jsx(Ca,{className:"text-xs text-slate-500 sm:text-sm",children:"Choose patient, doctor, date and slot. All fields are optimized for quick keyboard + mouse workflow."})]}),r.jsx(qe,{className:"space-y-4",children:r.jsxs("form",{onSubmit:O,className:"space-y-4",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/60 p-3 sm:p-4",children:[r.jsxs("div",{className:"flex items-center gap-2 pb-2",children:[r.jsx("span",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-white text-[11px] font-semibold text-slate-900 shadow-sm",children:r.jsx(Pp,{className:"h-3 w-3"})}),r.jsx("span",{className:"text-xs font-medium uppercase tracking-wide text-slate-500",children:"Patient details"})]}),r.jsx("div",{className:"space-y-2 sm:space-y-3",children:r.jsx(Zb,{value:o,onChange:P})})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/60 p-3 sm:p-4",children:[r.jsxs("div",{className:"flex items-center gap-2 pb-2",children:[r.jsx("span",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-white text-[11px] font-semibold text-slate-900 shadow-sm",children:r.jsx(_s,{className:"h-3 w-3"})}),r.jsx("span",{className:"text-xs font-medium uppercase tracking-wide text-slate-500",children:"Department & doctor"})]}),r.jsx(Fo,{value:n,onChange:T})]})]}),r.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Date"}),r.jsx(Ee,{type:"date",value:t,onChange:M=>s(M.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Purpose"}),r.jsx(Ee,{value:d,onChange:M=>u(M.target.value),placeholder:"Consultation / Review / Procedure",className:"h-9 rounded-2xl border-slate-200 text-sm"})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Time slot"}),r.jsxs("span",{className:"text-[11px] text-slate-400",children:[R.length," free slot(s) available"]})]}),w?r.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from({length:5}).map((M,B)=>r.jsx(Je,{className:"h-7 w-16 rounded-full bg-slate-100"},B))}):R.length===0?r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-3 py-2 text-xs text-amber-800",children:"No free slots for this date / doctor. Choose another date or doctor."}):r.jsx(xa,{className:"max-h-40 rounded-2xl border border-slate-100 bg-slate-50/80 px-2 py-2",children:r.jsx("div",{className:"flex flex-wrap gap-2",children:R.map(M=>r.jsxs("button",{type:"button",onClick:()=>b(M.start),className:["inline-flex items-center gap-1 rounded-full border px-3 py-1 text-[11px] font-medium transition",x===M.start?"border-slate-900 bg-slate-900 text-white":"border-slate-200 bg-white text-slate-700 hover:bg-slate-100"].join(" "),children:[r.jsx(Sa,{className:"h-3 w-3"}),M.start,"",M.end]},M.start))})})]}),r.jsx(eb,{className:"my-1"}),r.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[r.jsx("p",{className:"text-[11px] text-slate-400",children:"Booking will immediately reflect in OPD queue & doctor view."}),r.jsx(Re,{type:"submit",className:"h-9 rounded-2xl bg-slate-900 px-4 text-xs font-semibold uppercase tracking-wide text-white hover:bg-slate-800 disabled:opacity-50",disabled:!o||!n||!x,children:"Book appointment"})]})]})})]})}),r.jsx(Nt.div,{layout:!0,initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2,delay:.05},className:"lg:sticky lg:top-24",children:r.jsxs(We,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsx(st,{className:"pb-3",children:r.jsxs("div",{className:"flex items-start justify-between gap-2",children:[r.jsxs("div",{children:[r.jsxs(lt,{className:"flex items-center gap-2 text-base font-semibold text-slate-900 sm:text-lg",children:[r.jsx(Kn,{className:"h-4 w-4 text-slate-600"}),"Appointments for the day"]}),r.jsx(Ca,{className:"text-xs text-slate-500 sm:text-sm",children:"See all appointments for the selected doctor and date."})]}),(k||w)&&r.jsxs(Ge,{variant:"outline",className:"inline-flex items-center gap-1 rounded-full border-slate-200 bg-slate-50 px-2 py-1 text-[11px] text-slate-500",children:[r.jsx(ss,{className:"h-3 w-3 animate-spin"}),"Syncing"]})]})}),r.jsxs(qe,{className:"pb-3",children:[r.jsxs("div",{className:"mb-2 flex items-center justify-between text-[11px] text-slate-400",children:[r.jsxs("span",{children:[t," ",n?` Doctor ID ${n}`:""]}),r.jsxs("span",{children:[_.length," appointment(s)"]})]}),k?r.jsx("div",{className:"space-y-2",children:Array.from({length:4}).map((M,B)=>r.jsx(Je,{className:"h-14 w-full rounded-2xl bg-slate-100"},B))}):_.length===0?r.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 px-3 py-4 text-center text-xs text-slate-500",children:["No appointments for this filter yet.",r.jsx("div",{className:"mt-1 text-[11px] text-slate-400",children:"Start by booking a new appointment on the left."})]}):r.jsx(xa,{className:"max-h-[380px] pr-1",children:r.jsx("div",{className:"space-y-2 text-sm",children:r.jsx(Uc,{initial:!1,children:_.map(M=>r.jsxs(Nt.div,{initial:{opacity:0,y:4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},transition:{duration:.15},className:"flex flex-col gap-1 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-800 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"space-y-0.5",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-1",children:[r.jsxs("span",{className:"rounded-full bg-white px-2 py-0.5 text-[11px] font-medium text-slate-800 border border-slate-200",children:[M.slot_start,"",M.slot_end]}),r.jsx("span",{className:"font-medium",children:M.patient_name}),r.jsxs("span",{className:"text-[11px] text-slate-500",children:["(UHID ",M.uhid,")"]})]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:[M.department_name,"  ",M.doctor_name," ",r.jsx("span",{className:"ml-1 inline-flex items-center rounded-full bg-slate-900 px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide text-white",children:M.status})]})]}),r.jsx("div",{className:"text-[11px] text-slate-500 sm:text-right",children:M.vitals_registered?r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2 py-0.5 text-[10px] font-medium text-emerald-700 border border-emerald-100",children:[r.jsx(sn,{className:"h-3 w-3"}),"Vitals done"]}):r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-100 px-2 py-0.5 text-[10px] font-medium text-slate-600 border border-slate-200",children:[r.jsx(sn,{className:"h-3 w-3"}),"No vitals yet"]})})]},M.id))})})})]})]})})]})]})})}const _6e=()=>new Date().toISOString().slice(0,10),S6e={booked:"Booked",checked_in:"Checked-in",in_progress:"In progress",completed:"Completed",no_show:"No-show",cancelled:"Cancelled"},C6e={booked:"bg-slate-100 text-slate-700",checked_in:"bg-blue-100 text-blue-700",in_progress:"bg-amber-100 text-amber-700",completed:"bg-emerald-100 text-emerald-700",no_show:"bg-rose-100 text-rose-700",cancelled:"bg-slate-200 text-slate-600"};function k6e(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-IN",{weekday:"short",day:"2-digit",month:"short",year:"numeric"})}catch{return t}}function A6e(t,s){if(!(t!=null&&t.time)||!["booked","checked_in","in_progress"].includes(t.status))return null;try{const n=new Date;if(!(s===n.toISOString().slice(0,10)))return null;const i=new Date(`${s}T${t.time}:00`),l=n.getTime()-i.getTime(),o=Math.floor(l/(1e3*60));if(o<=0)return"0 min";if(o<60)return`${o} min`;const c=Math.floor(o/60),d=o%60;return c>=5?`${c} hrs+`:d===0?`${c} hr${c>1?"s":""}`:`${c}h ${d}m`}catch{return null}}function E6e(){const{user:t}=Zn()||{},[s,n]=y.useState(null),[a,i]=y.useState(_6e()),[l,o]=y.useState([]),[c,d]=y.useState(!1),[u,f]=y.useState("active"),m=Ta();y.useEffect(()=>{t!=null&&t.is_doctor&&!s&&n(t.id)},[t,s]);const x=!!(s&&a),b=y.useCallback(async()=>{if(!s||!a){o([]);return}try{d(!0);const k={doctor_user_id:Number(s),for_date:a};t!=null&&t.department_id&&(k.department_id=t.department_id);const{data:A}=await gB(k);o(A||[])}catch(k){console.error(k),o([])}finally{d(!1)}},[s,a,t]);y.useEffect(()=>{b()},[b]);const w=async(k,A,T={})=>{try{const{data:P}=await hue(k.appointment_id,A);ie.success(`Status updated to ${P.status.toUpperCase()}`),T.goToVisit&&P.visit_id?m(`/opd/visit/${P.visit_id}`):b()}catch{}},j=k=>{n(k)},_=y.useMemo(()=>{const k={total:l.length,booked:0,checked_in:0,in_progress:0,completed:0,no_show:0,cancelled:0};for(const A of l)k[A.status]!==void 0&&(k[A.status]+=1);return k},[l]),C=y.useMemo(()=>u==="all"?l:u==="active"?l.filter(k=>["booked","checked_in","in_progress"].includes(k.status)):l.filter(k=>k.status===u),[l,u]);return r.jsx("div",{className:"min-h-[calc(100vh-5rem)] bg-slate-50 px-4 py-6 md:px-6",children:r.jsxs("div",{className:"mx-auto max-w-5xl space-y-6",children:[r.jsxs("div",{className:"flex items-start justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"relative flex h-2 w-2",children:[r.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-emerald-500 opacity-75"}),r.jsx("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-emerald-500"})]}),r.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.2em] text-emerald-700",children:"Live OPD Queue"})]}),r.jsx("h1",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"OPD Queue Management"}),r.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Track today's appointments, check-in patients, and start / complete visits in real-time."})]}),r.jsxs("div",{className:"hidden text-right text-xs text-slate-500 md:block",children:[r.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1",children:[r.jsx(sn,{className:"h-3 w-3"}),r.jsx("span",{children:"Doctor OPD"})]}),r.jsxs("div",{className:"mt-1 flex items-center justify-end gap-1",children:[r.jsx(Kn,{className:"h-3 w-3"}),r.jsx("span",{children:k6e(a)})]})]})]}),r.jsxs(We,{className:"border-slate-200 shadow-sm rounded-3xl",children:[r.jsxs(st,{className:"border-b border-slate-100 pb-4",children:[r.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-end md:justify-between",children:[r.jsxs("div",{className:"grid w-full gap-3 md:grid-cols-[2fr,1.2fr] md:items-end",children:[r.jsxs("div",{children:[r.jsx(Fo,{value:s,onChange:j,autoSelectCurrentDoctor:!0}),(t==null?void 0:t.is_doctor)&&r.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Defaulted to your OPD queue."})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(Kn,{className:"h-3 w-3"}),"Date"]}),r.jsx(Ee,{type:"date",value:a,onChange:k=>i(k.target.value),className:"h-9"})]})]}),r.jsx("div",{className:"flex items-center gap-2 md:w-auto",children:r.jsxs(Re,{type:"button",size:"sm",variant:"outline",className:"gap-1",onClick:b,disabled:c||!x,children:[r.jsx(hu,{className:"h-3 w-3"}),"Refresh"]})})]}),r.jsxs("div",{className:"mt-4 flex flex-wrap gap-2 text-xs",children:[r.jsxs(Ge,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-slate-50",children:[r.jsx(Sa,{className:"h-3 w-3"}),r.jsx("span",{children:"Total"}),r.jsx("span",{className:"font-semibold",children:_.total})]}),r.jsxs(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-slate-50",children:["Booked: ",_.booked]}),r.jsxs(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-blue-50 text-blue-700",children:["Checked-in: ",_.checked_in]}),r.jsxs(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-amber-50 text-amber-700",children:["In progress: ",_.in_progress]}),r.jsxs(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-emerald-50 text-emerald-700",children:["Completed: ",_.completed]}),r.jsxs(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-rose-50 text-rose-700",children:["No-show: ",_.no_show]})]})]}),r.jsxs(qe,{className:"pt-4",children:[r.jsx("div",{className:"mb-3 flex flex-wrap gap-1.5 text-xs",children:[{key:"active",label:"Active (Booked / Checked-in / In progress)"},{key:"all",label:"All"},{key:"booked",label:"Booked"},{key:"checked_in",label:"Checked-in"},{key:"in_progress",label:"In progress"},{key:"completed",label:"Completed"},{key:"no_show",label:"No-show"}].map(k=>r.jsx("button",{type:"button",onClick:()=>f(k.key),className:["rounded-full border px-3 py-1 transition text-[11px]",u===k.key?"border-slate-900 bg-slate-900 text-white":"border-slate-200 bg-slate-50 text-slate-600 hover:bg-white"].join(" "),children:k.label},k.key))}),!x&&r.jsxs("div",{className:"flex flex-col items-center gap-2 py-10 text-center text-sm text-slate-500",children:[r.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-100",children:r.jsx(_s,{className:"h-5 w-5 text-slate-500"})}),r.jsx("div",{className:"font-medium text-slate-700",children:"Select doctor & date to view queue"}),r.jsx("p",{className:"max-w-md text-xs text-slate-500",children:"Choose a consultant and date above to see the live OPD queue, update statuses, and open visits."})]}),x&&c&&r.jsx("div",{className:"space-y-3 py-4",children:[1,2,3].map(k=>r.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-100 bg-slate-50/80 px-3 py-3",children:[r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsx(Je,{className:"h-4 w-40"}),r.jsx(Je,{className:"h-3 w-64"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(Je,{className:"h-7 w-16"}),r.jsx(Je,{className:"h-7 w-20"})]})]},k))}),x&&!c&&C.length===0&&r.jsxs("div",{className:"flex flex-col items-center gap-2 py-10 text-center text-sm text-slate-500",children:[r.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-100",children:r.jsx(Sa,{className:"h-5 w-5 text-slate-500"})}),r.jsx("div",{className:"font-medium text-slate-700",children:"No appointments for this doctor / date"}),r.jsx("p",{className:"max-w-md text-xs text-slate-500",children:"Try changing the status filter above or pick a different date to see previous or upcoming OPD queues."})]}),x&&!c&&C.length>0&&r.jsx("div",{className:"space-y-2 pt-1 text-sm",children:C.map(k=>{var P,R,I;const A=C6e[k.status]||"bg-slate-100 text-slate-700",T=A6e(k,a);return r.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[r.jsx("span",{className:"text-xs font-semibold text-slate-900",children:k.time}),r.jsx("span",{className:"mx-0.5 text-slate-400",children:""}),r.jsxs("span",{className:"flex items-center gap-1 text-sm font-medium text-slate-900",children:[r.jsx(on,{className:"h-3.5 w-3.5 text-slate-500"}),(P=k.patient)==null?void 0:P.name]}),r.jsx("span",{className:"mx-0.5 text-slate-400",children:""}),r.jsxs("span",{className:"text-[11px] text-slate-500",children:["UHID ",(R=k.patient)==null?void 0:R.uhid,"  ",(I=k.patient)==null?void 0:I.phone]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-1 text-[11px] text-slate-500",children:[r.jsx("span",{children:"Status:"}),r.jsx(Ge,{className:`border-none px-2 py-0.5 text-[11px] font-semibold uppercase ${A}`,children:S6e[k.status]||k.status}),r.jsx("span",{className:"mx-1 text-slate-300",children:""}),r.jsxs("span",{children:["Purpose:"," ",r.jsx("span",{className:"font-medium text-slate-700",children:k.visit_purpose||"Consultation"})]}),r.jsx("span",{className:"mx-1 text-slate-300",children:""}),r.jsxs("span",{className:"inline-flex items-center gap-1",children:[r.jsx(Qh,{className:"h-3 w-3"}),"Vitals:"," ",r.jsx("span",{className:"font-medium",children:k.has_vitals?"Yes":"No"})]}),T&&r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mx-1 text-slate-300",children:""}),r.jsxs("span",{className:"inline-flex items-center gap-1",children:[r.jsx(Sa,{className:"h-3 w-3"}),"Waiting:"," ",r.jsx("span",{className:"font-medium",children:T})]})]})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-2 text-xs",children:[k.status==="booked"&&r.jsxs(r.Fragment,{children:[r.jsx(Re,{size:"sm",onClick:()=>w(k,"checked_in"),children:"Check-in"}),r.jsx(Re,{size:"sm",variant:"outline",onClick:()=>w(k,"no_show"),children:"Mark No-show"})]}),k.status==="checked_in"&&r.jsx(Re,{size:"sm",onClick:()=>w(k,"in_progress",{goToVisit:!0}),children:"Start Visit"}),k.status==="in_progress"&&r.jsx(Re,{size:"sm",onClick:()=>w(k,"completed"),children:"Complete Visit"}),k.visit_id&&r.jsx(Re,{size:"sm",variant:"outline",onClick:()=>m(`/opd/visit/${k.visit_id}`),children:"Open Visit"})]})]},k.appointment_id)})})]})]})]})})}const gf=y.forwardRef(({className:t,...s},n)=>r.jsx("textarea",{className:Pt("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:n,...s}));gf.displayName="Textarea";const T6e=()=>new Date().toISOString().slice(0,10);function P6e(){const[t,s]=y.useState(null),[n,a]=y.useState(T6e()),[i,l]=y.useState([]),[o,c]=y.useState(!1),[d,u]=y.useState(null),[f,m]=y.useState({height_cm:"",weight_kg:"",temp_c:"",pulse:"",resp_rate:"",spo2:"",bp_sys:"",bp_dia:"",notes:""}),[x,b]=y.useState(!1),w=async()=>{if(!t||!n){l([]);return}try{c(!0);const{data:I}=await gB({doctor_user_id:Number(t),for_date:n});l(I||[])}catch{l([])}finally{c(!1)}};y.useEffect(()=>{w()},[t,n]);const j=I=>{s(I)},_=()=>({height_cm:"",weight_kg:"",temp_c:"",pulse:"",resp_rate:"",spo2:"",bp_sys:"",bp_dia:"",notes:""}),C=I=>{u(I),m(_()),setTimeout(()=>{const O=document.getElementById("triage-vitals-form");O&&O.scrollIntoView({behavior:"smooth",block:"start"})},80)},k=async I=>{if(I.preventDefault(),!!d)try{b(!0);const O={appointment_id:d.appointment_id,height_cm:f.height_cm?Number(f.height_cm):void 0,weight_kg:f.weight_kg?Number(f.weight_kg):void 0,temp_c:f.temp_c?Number(f.temp_c):void 0,pulse:f.pulse?Number(f.pulse):void 0,resp_rate:f.resp_rate?Number(f.resp_rate):void 0,spo2:f.spo2?Number(f.spo2):void 0,bp_sys:f.bp_sys?Number(f.bp_sys):void 0,bp_dia:f.bp_dia?Number(f.bp_dia):void 0,notes:f.notes||void 0};await gue(O),ie.success("Vitals recorded"),u(null),await w()}catch{}finally{b(!1)}},A=(I,O)=>m(M=>({...M,[I]:O})),T=i.length,P=i.filter(I=>I.has_vitals).length,R=T-P;return r.jsx("div",{className:"h-full w-full bg-slate-50",children:r.jsxs("div",{className:"mx-auto flex max-w-6xl flex-col gap-4 px-3 py-4 sm:px-4 lg:px-6 lg:py-6",children:[r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white px-3 py-1 text-xs text-slate-500 shadow-sm",children:[r.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-500 animate-pulse"}),r.jsx("span",{children:"Live OPD  Triage & Vitals"})]}),r.jsx("h1",{className:"text-xl font-semibold text-slate-900 sm:text-2xl",children:"OPD Triage (Vitals)"}),r.jsx("p",{className:"text-xs text-slate-500 sm:text-sm",children:"Nursing staff can quickly capture vitals for patients waiting in the doctor's queue."})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:justify-end",children:[r.jsxs(Ge,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-white px-3 py-1 text-[11px] font-normal text-slate-700 shadow-sm",children:[r.jsx(Kn,{className:"h-3 w-3"}),n]}),t&&r.jsxs(Ge,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-white px-3 py-1 text-[11px] font-normal text-slate-700 shadow-sm",children:[r.jsx(_s,{className:"h-3 w-3"}),"Doctor ID ",t]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-3",children:[r.jsx(We,{className:"rounded-2xl border-slate-200 shadow-sm",children:r.jsxs(qe,{className:"flex items-center justify-between gap-3 py-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Queue size"}),r.jsx("p",{className:"text-xl font-semibold text-slate-900",children:T})]}),r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-2",children:r.jsx(Pp,{className:"h-5 w-5 text-slate-700"})})]})}),r.jsx(We,{className:"rounded-2xl border-slate-200 shadow-sm",children:r.jsxs(qe,{className:"flex items-center justify-between gap-3 py-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Vitals completed"}),r.jsx("p",{className:"text-xl font-semibold text-slate-900",children:P})]}),r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-2",children:r.jsx(sn,{className:"h-5 w-5 text-slate-700"})})]})}),r.jsx(We,{className:"rounded-2xl border-slate-200 shadow-sm",children:r.jsxs(qe,{className:"flex items-center justify-between gap-3 py-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Pending vitals"}),r.jsx("p",{className:"text-xl font-semibold text-slate-900",children:R})]}),r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-2",children:r.jsx(Qh,{className:"h-5 w-5 text-slate-700"})})]})})]}),r.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.4fr),minmax(0,1.6fr)] lg:gap-6",children:[r.jsx(Nt.div,{layout:!0,initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.18},children:r.jsxs(We,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsxs(st,{className:"pb-3",children:[r.jsxs(lt,{className:"flex items-center gap-2 text-base font-semibold text-slate-900 sm:text-lg",children:[r.jsx("span",{className:"inline-flex h-7 w-7 items-center justify-center rounded-2xl bg-slate-900 text-xs text-white",children:"1"}),"Select doctor & view queue"]}),r.jsx(Ca,{className:"text-xs text-slate-500 sm:text-sm",children:"Pick the doctor and date to load today's OPD queue for triage."})]}),r.jsxs(qe,{className:"space-y-4",children:[r.jsxs("div",{className:"grid items-end gap-3 md:grid-cols-[2fr,1.3fr]",children:[r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/70 p-3 sm:p-4",children:[r.jsxs("div",{className:"flex items-center gap-2 pb-2",children:[r.jsx("span",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-white text-[11px] font-semibold text-slate-900 shadow-sm",children:r.jsx(_s,{className:"h-3 w-3"})}),r.jsx("span",{className:"text-xs font-medium uppercase tracking-wide text-slate-500",children:"Doctor"})]}),r.jsx(Fo,{value:t,onChange:j})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Date"}),r.jsx(Ee,{type:"date",value:n,onChange:I=>a(I.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]})]}),r.jsx(eb,{}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between text-[11px] text-slate-400",children:[r.jsx("span",{children:t?"Queue for selected doctor":"Select a doctor to load queue"}),r.jsxs("span",{children:[T," patient(s)"]})]}),o?r.jsx("div",{className:"space-y-2 mt-1",children:Array.from({length:4}).map((I,O)=>r.jsx(Je,{className:"h-14 w-full rounded-2xl bg-slate-100"},O))}):i.length===0?r.jsxs("div",{className:"mt-2 rounded-2xl border border-dashed border-slate-200 bg-slate-50 px-3 py-4 text-center text-xs text-slate-500",children:["No appointments for this doctor / date.",r.jsx("div",{className:"mt-1 text-[11px] text-slate-400",children:"Use the Appointment Booking screen to add new patients."})]}):r.jsx(xa,{className:"mt-1 max-h-[380px] pr-1",children:r.jsx("div",{className:"space-y-2 text-sm",children:r.jsx(Uc,{initial:!1,children:i.map(I=>r.jsxs(Nt.div,{initial:{opacity:0,y:4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},transition:{duration:.15},className:"flex flex-col gap-2 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-800 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"space-y-0.5",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-1",children:[r.jsx("span",{className:"rounded-full bg-white px-2 py-0.5 text-[11px] font-medium text-slate-800 border border-slate-200",children:I.time}),r.jsx("span",{className:"font-medium",children:I.patient.name}),r.jsxs("span",{className:"text-[11px] text-slate-500",children:["(UHID ",I.patient.uhid,")"]})]}),r.jsxs("div",{className:"text-[11px] text-slate-500 flex flex-wrap items-center gap-2",children:[r.jsx("span",{children:"Vitals:"}),I.has_vitals?r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2 py-0.5 text-[10px] font-medium text-emerald-700 border border-emerald-100",children:[r.jsx(sn,{className:"h-3 w-3"}),"Already recorded"]}):r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-100 px-2 py-0.5 text-[10px] font-medium text-slate-600 border border-slate-200",children:[r.jsx(sn,{className:"h-3 w-3"}),"Not recorded"]})]})]}),r.jsx("div",{className:"flex items-center justify-end",children:r.jsx(Re,{type:"button",variant:I.has_vitals?"outline":"default",size:"sm",className:`rounded-2xl text-[11px] px-3 ${I.has_vitals?"bg-white text-slate-800 border-slate-300":"bg-slate-900 text-white hover:bg-slate-800"}`,onClick:()=>C(I),children:"Record vitals"})})]},I.appointment_id))})})})]})]})]})}),r.jsx(Nt.div,{id:"triage-vitals-form",layout:!0,initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2,delay:.05},className:"lg:sticky lg:top-24",children:r.jsxs(We,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsx(st,{className:"pb-3",children:r.jsxs("div",{className:"flex items-start justify-between gap-2",children:[r.jsxs("div",{children:[r.jsxs(lt,{className:"flex items-center gap-2 text-base font-semibold text-slate-900 sm:text-lg",children:[r.jsx(Qh,{className:"h-4 w-4 text-slate-700"}),"Record patient vitals"]}),r.jsx(Ca,{className:"text-xs text-slate-500 sm:text-sm",children:"Select a patient from the queue to start capturing vitals."})]}),(x||o)&&r.jsxs(Ge,{variant:"outline",className:"inline-flex items-center gap-1 rounded-full border-slate-200 bg-slate-50 px-2 py-1 text-[11px] text-slate-500",children:[r.jsx(ss,{className:"h-3 w-3 animate-spin"}),"Syncing"]})]})}),r.jsx(qe,{className:"pb-4",children:d?r.jsxs("form",{onSubmit:k,className:"space-y-4",children:[r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/80 px-3 py-2 text-xs text-slate-700",children:r.jsxs("div",{className:"flex flex-wrap items-center gap-1 sm:gap-2",children:[r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-white px-2 py-0.5 text-[11px] font-medium text-slate-800 border border-slate-200",children:[r.jsx(Pp,{className:"h-3 w-3"}),d.patient.name]}),r.jsxs("span",{className:"text-[11px] text-slate-500",children:["UHID ",d.patient.uhid]}),r.jsxs("span",{className:"text-[11px] text-slate-500",children:[" Time ",d.time]})]})}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Height (cm)"}),r.jsx(Ee,{value:f.height_cm,onChange:I=>A("height_cm",I.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Weight (kg)"}),r.jsx(Ee,{value:f.weight_kg,onChange:I=>A("weight_kg",I.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium text-slate-600",children:["Temperature (C)",r.jsx(Tp,{className:"h-3 w-3 text-slate-500"})]}),r.jsx(Ee,{value:f.temp_c,onChange:I=>A("temp_c",I.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Pulse (bpm)"}),r.jsx(Ee,{value:f.pulse,onChange:I=>A("pulse",I.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Resp. rate"}),r.jsx(Ee,{value:f.resp_rate,onChange:I=>A("resp_rate",I.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"SpO (%)"}),r.jsx(Ee,{value:f.spo2,onChange:I=>A("spo2",I.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"BP (sys / dia)"}),r.jsxs("div",{className:"flex gap-1.5",children:[r.jsx(Ee,{value:f.bp_sys,onChange:I=>A("bp_sys",I.target.value),placeholder:"Sys",className:"h-9 rounded-2xl border-slate-200 text-sm"}),r.jsx(Ee,{value:f.bp_dia,onChange:I=>A("bp_dia",I.target.value),placeholder:"Dia",className:"h-9 rounded-2xl border-slate-200 text-sm"})]})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Notes"}),r.jsx(gf,{value:f.notes,onChange:I=>A("notes",I.target.value),className:"min-h-[70px] rounded-2xl border-slate-200 text-sm",placeholder:"Enter any triage notes, pain score, alerts"})]}),r.jsx(eb,{}),r.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[r.jsx("p",{className:"text-[11px] text-slate-400",children:"Saved vitals will be visible in the doctor's EMR view for this visit."}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Re,{type:"button",variant:"outline",size:"sm",className:"h-9 rounded-2xl border-slate-300 bg-white text-[11px]",onClick:()=>u(null),disabled:x,children:"Cancel"}),r.jsx(Re,{type:"submit",size:"sm",className:"h-9 rounded-2xl bg-slate-900 px-4 text-[11px] font-semibold uppercase tracking-wide text-white hover:bg-slate-800 disabled:opacity-50",disabled:x,children:x?"Saving":"Save vitals"})]})]})]}):r.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 px-3 py-4 text-center text-xs text-slate-500",children:["No patient selected.",r.jsxs("div",{className:"mt-1 text-[11px] text-slate-400",children:["Click ",r.jsx("span",{className:"font-medium",children:"Record vitals"})," on any patient in the queue to begin."]})]})})]})})]})]})})}function I6e(){const{id:t}=sd(),s=Number(t),[n,a]=y.useState(!0),[i,l]=y.useState(!1),[o,c]=y.useState(null),[d,u]=y.useState({chief_complaint:"",symptoms:"",soap_subjective:"",soap_objective:"",soap_assessment:"",plan:""}),[f,m]=y.useState(""),[x,b]=y.useState(""),[w,j]=y.useState(!1),_=async()=>{try{a(!0);const{data:P}=await pue(s);c(P),u({chief_complaint:P.chief_complaint||"",symptoms:P.symptoms||"",soap_subjective:P.soap_subjective||"",soap_objective:P.soap_objective||"",soap_assessment:P.soap_assessment||"",plan:P.plan||""})}catch{c(null)}finally{a(!1)}};y.useEffect(()=>{s&&_()},[s]);const C=(P,R)=>u(I=>({...I,[P]:R})),k=async()=>{try{l(!0),await xue(s,d),ie.success("Visit updated"),await _()}catch{}finally{l(!1)}},A=P=>{if(!P)return"";const R=new Date(P);return Number.isNaN(R.getTime())?P:R.toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})},T=async()=>{if(!f){ie.error("Select follow-up date");return}try{j(!0),await yue(s,{due_date:f,note:x||void 0}),ie.success("Follow-up created"),m(""),b(""),await _()}catch{}finally{j(!1)}};return s?n?r.jsx("div",{className:"p-4 text-sm text-slate-500",children:"Loading visit"}):o?r.jsxs("div",{className:"space-y-4 p-4",children:[r.jsx("h1",{className:"text-xl font-semibold",children:"OPD Visit"}),r.jsxs("div",{className:"rounded-2xl border bg-white p-4 space-y-3 text-sm",children:[r.jsxs("div",{className:"flex flex-wrap justify-between gap-2",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"font-semibold",children:[o.patient_name," ",r.jsxs("span",{className:"text-[11px] text-slate-500",children:["(UHID ",o.uhid,")"]})]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:[o.department_name,"  Dr. ",o.doctor_name]})]}),r.jsxs("div",{className:"text-[11px] text-slate-500 text-right",children:["Episode: ",o.episode_id," ",r.jsx("br",{}),"Visit at: ",A(o.visit_at)]})]}),o.current_vitals&&r.jsxs("div",{className:"rounded-xl border bg-slate-50 px-3 py-2 text-[11px] text-slate-700",children:[r.jsx("div",{className:"font-semibold mb-1",children:"Latest vitals"}),r.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1",children:[o.current_vitals.height_cm&&r.jsxs("span",{children:["Ht: ",o.current_vitals.height_cm," cm"]}),o.current_vitals.weight_kg&&r.jsxs("span",{children:["Wt: ",o.current_vitals.weight_kg," kg"]}),o.current_vitals.temp_c&&r.jsxs("span",{children:["Temp: ",o.current_vitals.temp_c," C"]}),o.current_vitals.bp_systolic&&r.jsxs("span",{children:["BP: ",o.current_vitals.bp_systolic,"/",o.current_vitals.bp_diastolic," mmHg"]}),o.current_vitals.pulse&&r.jsxs("span",{children:["Pulse: ",o.current_vitals.pulse]}),o.current_vitals.rr&&r.jsxs("span",{children:["RR: ",o.current_vitals.rr]}),o.current_vitals.spo2&&r.jsxs("span",{children:["SpO: ",o.current_vitals.spo2,"%"]})]})]})]}),r.jsxs("div",{className:"rounded-2xl border bg-white p-4 space-y-3",children:[r.jsx("h3",{className:"font-medium text-sm",children:"Clinical notes (SOAP)"}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium",children:"Chief Complaint"}),r.jsx("textarea",{className:"input min-h-[60px]",value:d.chief_complaint,onChange:P=>C("chief_complaint",P.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium",children:"Symptoms"}),r.jsx("textarea",{className:"input min-h-[60px]",value:d.symptoms,onChange:P=>C("symptoms",P.target.value)})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium",children:"Subjective"}),r.jsx("textarea",{className:"input min-h-[80px]",value:d.soap_subjective,onChange:P=>C("soap_subjective",P.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium",children:"Objective"}),r.jsx("textarea",{className:"input min-h-[80px]",value:d.soap_objective,onChange:P=>C("soap_objective",P.target.value)})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium",children:"Assessment"}),r.jsx("textarea",{className:"input min-h-[80px]",value:d.soap_assessment,onChange:P=>C("soap_assessment",P.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium",children:"Plan"}),r.jsx("textarea",{className:"input min-h-[80px]",value:d.plan,onChange:P=>C("plan",P.target.value)})]})]}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{className:"btn",onClick:k,disabled:i,children:i?"Saving":"Save notes"})})]}),r.jsxs("div",{className:"rounded-2xl border bg-white p-4 space-y-3",children:[r.jsx("h3",{className:"font-medium text-sm",children:"Follow-up"}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-[1fr,2fr,auto] items-end",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium",children:"Follow-up date"}),r.jsx("input",{type:"date",className:"input",value:f,onChange:P=>m(P.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium",children:"Note (optional)"}),r.jsx("input",{className:"input",value:x,onChange:P=>b(P.target.value),placeholder:"Review in 2 weeks / discuss reports"})]}),r.jsx("button",{className:"btn",onClick:T,disabled:w,children:w?"Creating":"Create Follow-up"})]})]})]}):r.jsx("div",{className:"p-4 text-sm text-red-600",children:"Visit not found."}):r.jsx("div",{className:"p-4 text-sm",children:"Invalid visit ID."})}const ER=()=>new Date().toISOString().slice(0,10),M6e={waiting:"Waiting",scheduled:"Scheduled",completed:"Completed",cancelled:"Cancelled","*":"All"},D6e={waiting:"bg-amber-50 text-amber-700",scheduled:"bg-blue-50 text-blue-700",completed:"bg-emerald-50 text-emerald-700",cancelled:"bg-slate-100 text-slate-700"};function Hj(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-IN",{weekday:"short",day:"2-digit",month:"short",year:"numeric"})}catch{return t}}function O6e(){const[t,s]=y.useState("waiting"),[n,a]=y.useState(null),[i,l]=y.useState(ER()),[o,c]=y.useState(ER()),[d,u]=y.useState([]),[f,m]=y.useState(!1),[x,b]=y.useState(null),[w,j]=y.useState(""),[_,C]=y.useState(""),[k,A]=y.useState(!1),[T,P]=y.useState(null),[R,I]=y.useState(""),[O,M]=y.useState(""),[B,L]=y.useState([]),[F,V]=y.useState(!1),[U,z]=y.useState(!1),W=async()=>{try{m(!0);const ye={status:t,doctor_id:n||void 0,date_from:i||void 0,date_to:o||void 0},{data:X}=await bue(ye);u(X||[])}catch{u([])}finally{m(!1)}};y.useEffect(()=>{W()},[t,n,i,o]);const q=ye=>{a(ye)},G=ye=>{b(ye),j(ye.due_date),C(ye.note||"")},se=async ye=>{if(ye.preventDefault(),!!x)try{A(!0),await vue(x.id,{due_date:w,note:_||void 0}),ie.success("Follow-up updated"),b(null),await W()}catch{}finally{A(!1)}},ge=async(ye,X)=>{if(!(ye!=null&&ye.doctor_id)||!X){L([]);return}try{z(!0);const{data:oe}=await lue({doctorUserId:ye.doctor_id,date:X});L(oe||[])}catch{L([])}finally{z(!1)}},ke=async ye=>{P(ye);const X=ye.due_date;I(X),M(""),await ge(ye,X)},ee=async ye=>{const X=ye.target.value;I(X),T&&await ge(T,X)},pe=async ye=>{if(ye.preventDefault(),!!T){if(!O){ie.error("Select a time slot");return}try{V(!0),await wue(T.id,{date:R||void 0,slot_start:O}),ie.success("Follow-up scheduled"),P(null),L([]),await W()}catch{}finally{V(!1)}}},ue=y.useMemo(()=>{const ye={total:d.length,waiting:0,scheduled:0,completed:0,cancelled:0};for(const X of d)ye[X.status]!==void 0&&(ye[X.status]+=1);return ye},[d]);return r.jsx("div",{className:"min-h-[calc(100vh-5rem)] bg-slate-50 px-4 py-6 md:px-6",children:r.jsxs("div",{className:"mx-auto max-w-5xl space-y-6",children:[r.jsxs("div",{className:"flex items-start justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"relative flex h-2 w-2",children:[r.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-sky-500 opacity-75"}),r.jsx("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-sky-500"})]}),r.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.2em] text-sky-700",children:"Follow-up Tracker"})]}),r.jsx("h1",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"OPD Follow-ups"}),r.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"View pending follow-ups, reschedule due dates, and confirm them into real OPD appointments."})]}),r.jsxs("div",{className:"hidden text-right text-xs text-slate-500 md:block",children:[r.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1",children:[r.jsx(dr,{className:"h-3 w-3"}),r.jsx("span",{children:"Continuity of care"})]}),r.jsxs("div",{className:"mt-1 flex items-center justify-end gap-1",children:[r.jsx(Kn,{className:"h-3 w-3"}),r.jsxs("span",{children:[Hj(i),"  ",Hj(o)]})]})]})]}),r.jsxs(We,{className:"border-slate-200 shadow-sm rounded-3xl",children:[r.jsxs(st,{className:"border-b border-slate-100 pb-4",children:[r.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-end md:justify-between",children:[r.jsxs("div",{className:"grid w-full gap-3 md:grid-cols-[2fr,1.3fr,1fr,1fr] md:items-end",children:[r.jsx(Fo,{value:n,onChange:q}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(gte,{className:"h-3 w-3"}),"Status"]}),r.jsxs(Ms,{value:t,onValueChange:ye=>s(ye),children:[r.jsx(Es,{className:"h-9 text-xs",children:r.jsx(Ds,{placeholder:"Select status"})}),r.jsxs(Ts,{children:[r.jsx(Mt,{value:"waiting",children:"Waiting"}),r.jsx(Mt,{value:"scheduled",children:"Scheduled"}),r.jsx(Mt,{value:"completed",children:"Completed"}),r.jsx(Mt,{value:"cancelled",children:"Cancelled"}),r.jsx(Mt,{value:"*",children:"All"})]})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(Kn,{className:"h-3 w-3"}),"From"]}),r.jsx(Ee,{type:"date",className:"h-9",value:i,onChange:ye=>l(ye.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(Kn,{className:"h-3 w-3"}),"To"]}),r.jsx(Ee,{type:"date",className:"h-9",value:o,onChange:ye=>c(ye.target.value)})]})]}),r.jsx("div",{className:"flex items-center gap-2 md:w-auto",children:r.jsxs(Re,{type:"button",size:"sm",variant:"outline",onClick:W,disabled:f,className:"gap-1",children:[r.jsx(Sa,{className:"h-3 w-3"}),"Refresh"]})})]}),r.jsxs("div",{className:"mt-4 flex flex-wrap gap-2 text-xs",children:[r.jsxs(Ge,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-slate-50",children:[r.jsx(dr,{className:"h-3 w-3"}),r.jsx("span",{children:"Total"}),r.jsx("span",{className:"font-semibold",children:ue.total})]}),r.jsxs(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-amber-50 text-amber-700",children:["Waiting: ",ue.waiting]}),r.jsxs(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-blue-50 text-blue-700",children:["Scheduled: ",ue.scheduled]}),r.jsxs(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-emerald-50 text-emerald-700",children:["Completed: ",ue.completed]}),r.jsxs(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-slate-100 text-slate-700",children:["Cancelled: ",ue.cancelled]})]})]}),r.jsx(qe,{className:"pt-4",children:f?r.jsx("div",{className:"space-y-3 py-4",children:[1,2,3].map(ye=>r.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-100 bg-slate-50/80 px-3 py-3",children:[r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsx(Je,{className:"h-4 w-52"}),r.jsx(Je,{className:"h-3 w-64"})]}),r.jsx(Je,{className:"h-7 w-20"})]},ye))}):d.length===0?r.jsxs("div",{className:"flex flex-col items-center gap-2 py-10 text-center text-sm text-slate-500",children:[r.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-100",children:r.jsx(yn,{className:"h-5 w-5 text-slate-500"})}),r.jsx("div",{className:"font-medium text-slate-700",children:"No follow-ups for this filter"}),r.jsx("p",{className:"max-w-md text-xs text-slate-500",children:"Adjust status, doctor, or date range above to see past and upcoming follow-ups."})]}):r.jsx("div",{className:"space-y-2 pt-1 text-sm",children:d.map(ye=>{const X=D6e[ye.status]||"bg-slate-100 text-slate-700";return r.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[r.jsx("span",{className:"text-xs font-semibold text-slate-900",children:Hj(ye.due_date)}),r.jsx("span",{className:"mx-0.5 text-slate-400",children:""}),r.jsxs("span",{className:"flex items-center gap-1 text-sm font-medium text-slate-900",children:[r.jsx(on,{className:"h-3.5 w-3.5 text-slate-500"}),ye.patient_name]}),r.jsx("span",{className:"mx-0.5 text-slate-400",children:""}),r.jsxs("span",{className:"text-[11px] text-slate-500",children:["UHID ",ye.patient_uhid]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-1 text-[11px] text-slate-500",children:[r.jsxs("span",{children:["Dr. ",ye.doctor_name,"  ",ye.department_name]}),r.jsx("span",{className:"mx-1 text-slate-300",children:""}),r.jsx("span",{children:"Status:"}),r.jsx(Ge,{className:`border-none px-2 py-0.5 text-[11px] font-semibold uppercase ${X}`,children:M6e[ye.status]||ye.status})]}),ye.note&&r.jsxs("div",{className:"text-[11px] text-slate-600",children:["Note: ",ye.note]}),ye.status==="scheduled"&&ye.appointment_id&&r.jsxs("div",{className:"text-[11px] text-emerald-700",children:["Linked to appointment # ",ye.appointment_id]})]}),r.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2 text-xs",children:ye.status==="waiting"&&r.jsxs(r.Fragment,{children:[r.jsx(Re,{size:"sm",variant:"outline",onClick:()=>G(ye),children:"Edit"}),r.jsx(Re,{size:"sm",onClick:()=>ke(ye),children:"Schedule"})]})})]},ye.id)})})})]}),x&&r.jsxs(We,{className:"border-slate-200 shadow-sm rounded-3xl",children:[r.jsx(st,{className:"pb-3",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx(lt,{className:"text-base",children:"Edit Follow-up Date & Note"}),r.jsxs(Ca,{className:"text-xs",children:[x.patient_name,"  UHID ",x.patient_uhid]})]}),r.jsx(Re,{variant:"ghost",size:"sm",className:"text-xs text-slate-500",type:"button",onClick:()=>b(null),children:"Close"})]})}),r.jsx(qe,{children:r.jsxs("form",{onSubmit:se,className:"grid gap-3 md:grid-cols-[1fr,2fr,auto] md:items-end",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(Kn,{className:"h-3 w-3"}),"Due date"]}),r.jsx(Ee,{type:"date",value:w,onChange:ye=>j(ye.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(_s,{className:"h-3 w-3"}),"Note"]}),r.jsx(Ee,{value:_,onChange:ye=>C(ye.target.value),placeholder:"Short instruction for next visit"})]}),r.jsx(Re,{type:"submit",disabled:k,children:k?"Saving":"Save changes"})]})})]}),T&&r.jsxs(We,{className:"border-slate-200 shadow-sm rounded-3xl",children:[r.jsx(st,{className:"pb-3",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx(lt,{className:"text-base",children:"Schedule Follow-up Appointment"}),r.jsxs(Ca,{className:"text-xs",children:[T.patient_name,"  UHID ",T.patient_uhid,"  Dr. ",T.doctor_name]})]}),r.jsx(Re,{variant:"ghost",size:"sm",className:"text-xs text-slate-500",type:"button",onClick:()=>{P(null),L([])},children:"Close"})]})}),r.jsx(qe,{children:r.jsxs("form",{onSubmit:pe,className:"space-y-4 text-sm",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-[1fr,2fr] md:items-start",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(Kn,{className:"h-3 w-3"}),"Date"]}),r.jsx(Ee,{type:"date",value:R,onChange:ee})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(Sa,{className:"h-3 w-3"}),"Time slot"]}),U?r.jsx("div",{className:"text-[11px] text-slate-500",children:"Loading slots"}):B.length===0?r.jsxs("div",{className:"flex items-start gap-2 rounded-xl border border-amber-200 bg-amber-50 px-3 py-2 text-[11px] text-amber-800",children:[r.jsx(yn,{className:"mt-[1px] h-3 w-3"}),r.jsx("span",{children:"No free slots found for this date. You can still type a custom time below."})]}):r.jsx("div",{className:"flex flex-wrap gap-2",children:B.map(ye=>r.jsx("button",{type:"button",onClick:()=>M(ye),className:["rounded-full border px-3 py-1 text-[11px] transition",O===ye?"border-slate-900 bg-slate-900 text-white":"border-slate-200 bg-slate-50 hover:bg-slate-100"].join(" "),children:ye},ye))}),r.jsx(Ee,{type:"time",className:"mt-2",value:O,onChange:ye=>M(ye.target.value)})]})]}),r.jsx("div",{className:"flex justify-end",children:r.jsx(Re,{type:"submit",disabled:F,children:F?"Scheduling":"Confirm schedule"})})]})})]})]})})}const R6e=()=>new Date().toISOString().slice(0,10);function TR(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-IN",{weekday:"short",day:"2-digit",month:"short",year:"numeric"})}catch{return t}}function L6e(){const[t,s]=y.useState(null),[n,a]=y.useState(R6e()),[i,l]=y.useState([]),[o,c]=y.useState(!1),[d,u]=y.useState(null),[f,m]=y.useState(""),[x,b]=y.useState(""),[w,j]=y.useState(!1),_=async()=>{try{c(!0);const P={for_date:n,doctor_id:t||void 0},{data:R}=await mue(P);l(R||[])}catch{l([])}finally{c(!1)}};y.useEffect(()=>{_()},[t,n]);const C=P=>{s(P)},k=P=>{u(P),m(P.date),b(P.slot_start)},A=async P=>{if(P.preventDefault(),!!d){if(!f||!x){ie.error("Select date and time");return}try{j(!0),await fue(d.id,{date:f,slot_start:x,create_new:!0}),ie.success("No-show rescheduled as new appointment"),u(null),await _()}catch{}finally{j(!1)}}},T=y.useMemo(()=>i.length,[i]);return r.jsx("div",{className:"min-h-[calc(100vh-5rem)] bg-slate-50 px-4 py-6 md:px-6",children:r.jsxs("div",{className:"mx-auto max-w-5xl space-y-6",children:[r.jsxs("div",{className:"flex items-start justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"relative flex h-2 w-2",children:[r.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-rose-500 opacity-75"}),r.jsx("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-rose-500"})]}),r.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.2em] text-rose-700",children:"No-Show Recovery"})]}),r.jsx("h1",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"No-show Appointments"}),r.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Track patients who missed their appointment and quickly reschedule them into the OPD calendar."})]}),r.jsxs("div",{className:"hidden text-right text-xs text-slate-500 md:block",children:[r.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1",children:[r.jsx(Si,{className:"h-3 w-3"}),r.jsx("span",{children:"Improve utilisation"})]}),r.jsxs("div",{className:"mt-1 flex items-center justify-end gap-1",children:[r.jsx(Kn,{className:"h-3 w-3"}),r.jsx("span",{children:TR(n)})]})]})]}),r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(st,{className:"border-b border-slate-100 pb-4",children:[r.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-end md:justify-between",children:[r.jsxs("div",{className:"grid w-full gap-3 md:grid-cols-[2fr,1fr] md:items-end",children:[r.jsx(Fo,{value:t,onChange:C}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(Kn,{className:"h-3 w-3"}),"For date"]}),r.jsx(Ee,{type:"date",className:"h-9",value:n,onChange:P=>a(P.target.value)})]})]}),r.jsx("div",{className:"flex items-center gap-2 md:w-auto",children:r.jsxs(Re,{type:"button",size:"sm",variant:"outline",onClick:_,disabled:o,className:"gap-1",children:[r.jsx(Sa,{className:"h-3 w-3"}),"Refresh"]})})]}),r.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2 text-xs",children:[r.jsxs(Ge,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-slate-50",children:[r.jsx(yn,{className:"h-3 w-3 text-rose-600"}),r.jsx("span",{children:"Total no-shows"}),r.jsx("span",{className:"font-semibold",children:T})]}),r.jsx("span",{className:"text-[11px] text-slate-500",children:"Recover missed visits by creating a fresh appointment."})]})]}),r.jsx(qe,{className:"pt-4",children:o?r.jsx("div",{className:"space-y-3 py-4",children:[1,2,3].map(P=>r.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-100 bg-slate-50/80 px-3 py-3",children:[r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsx(Je,{className:"h-4 w-52"}),r.jsx(Je,{className:"h-3 w-64"})]}),r.jsx(Je,{className:"h-7 w-28"})]},P))}):i.length===0?r.jsxs("div",{className:"flex flex-col items-center gap-2 py-10 text-center text-sm text-slate-500",children:[r.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-100",children:r.jsx(yn,{className:"h-5 w-5 text-slate-500"})}),r.jsx("div",{className:"font-medium text-slate-700",children:"No no-show appointments for this filter"}),r.jsx("p",{className:"max-w-md text-xs text-slate-500",children:"Change the doctor or date above to check other days."})]}):r.jsx("div",{className:"space-y-2 pt-1 text-sm",children:i.map(P=>r.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[r.jsxs("span",{className:"text-xs font-semibold text-slate-900",children:[TR(P.date),"  ",P.slot_start]}),r.jsx("span",{className:"mx-0.5 text-slate-300",children:""}),r.jsxs("span",{className:"flex items-center gap-1 text-sm font-medium text-slate-900",children:[r.jsx(on,{className:"h-3.5 w-3.5 text-slate-500"}),P.patient_name]}),r.jsx("span",{className:"mx-0.5 text-slate-400",children:""}),r.jsxs("span",{className:"text-[11px] text-slate-500",children:["UHID ",P.uhid]})]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:[P.department_name,"  Dr. ",P.doctor_name,"  Purpose:"," ",P.purpose||"Consultation"]})]}),r.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2 text-xs",children:r.jsxs(Re,{size:"sm",className:"gap-1",onClick:()=>k(P),children:[r.jsx(Si,{className:"h-3 w-3"}),"Reschedule"]})})]},P.id))})})]}),d&&r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsx(st,{className:"pb-3",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx(lt,{className:"text-base",children:"Reschedule No-show"}),r.jsxs(Ca,{className:"text-xs",children:[d.patient_name,"  UHID ",d.uhid,"  Dr."," ",d.doctor_name]})]}),r.jsx(Re,{type:"button",variant:"ghost",size:"sm",className:"text-xs text-slate-500",onClick:()=>u(null),children:"Close"})]})}),r.jsx(qe,{children:r.jsxs("form",{onSubmit:A,className:"grid gap-3 md:grid-cols-[1fr,1fr,auto] md:items-end text-sm",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(Kn,{className:"h-3 w-3"}),"New date"]}),r.jsx(Ee,{type:"date",value:f,onChange:P=>m(P.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(Sa,{className:"h-3 w-3"}),"New time"]}),r.jsx(Ee,{type:"time",value:x,onChange:P=>b(P.target.value)})]}),r.jsx(Re,{type:"submit",disabled:w,children:w?"Rescheduling":"Create new appointment"})]})})]})]})})}function PR(){return new Date().toISOString().slice(0,10)}function IR(t,s){const n=new Date(t);return n.setDate(n.getDate()+s),n.toISOString().slice(0,10)}function MR(t,s){if(!t||!s)return"";try{const n=new Date(t),a=new Date(s),l={day:"2-digit",month:"short",...n.getFullYear()===a.getFullYear()?{}:{year:"numeric"}},o={day:"2-digit",month:"short",year:"numeric"};return`${n.toLocaleDateString("en-IN",l)}  ${a.toLocaleDateString("en-IN",o)}`}catch{return`${t}  ${s}`}}function B6e(){const[t,s]=y.useState(""),[n,a]=y.useState(""),[i,l]=y.useState(null),[o,c]=y.useState(!1),[d,u]=y.useState(null);y.useEffect(()=>{const P=PR(),R=IR(P,-6);s(R),a(P)},[]);const f=y.useCallback(async(P={})=>{var O,M;const R=P.dateFrom||t,I=P.dateTo||n;if(!(!R||!I))try{c(!0);const{data:B}=await Cue({dateFrom:R,dateTo:I,doctorId:i||void 0});u(B)}catch(B){console.error(B),ie.error(((M=(O=B==null?void 0:B.response)==null?void 0:O.data)==null?void 0:M.detail)||"Failed to load OPD dashboard")}finally{c(!1)}},[t,n,i]);y.useEffect(()=>{t&&n&&f()},[t,n,i,f]);const m=P=>{l(P)},x=d||{},b=x.appointments||{},w=x.followups||{},j=x.doctor_stats||[],_=y.useMemo(()=>(j||[]).map(P=>({name:P.doctor_name||`#${P.doctor_id}`,total:P.total_appointments||0,completed:P.completed||0,no_show:P.no_show||0})),[j]),C=x.range||{},k=C.date_from&&C.date_to?MR(C.date_from,C.date_to):MR(t,n),A=b.total??0,T=o&&!d;return r.jsx("div",{className:"min-h-[calc(100vh-5rem)] bg-slate-50 px-4 py-6 md:px-6",children:r.jsxs("div",{className:"mx-auto max-w-6xl space-y-6",children:[r.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"relative flex h-2 w-2",children:[r.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-emerald-500 opacity-75"}),r.jsx("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-emerald-500"})]}),r.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-emerald-700",children:"OPD Analytics"})]}),r.jsx("h1",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"OPD Dashboard"}),r.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Quick view of OPD appointments, follow-ups and doctor workload for the selected date range."})]}),r.jsxs("div",{className:"flex flex-col items-start gap-2 text-xs text-slate-500 md:items-end",children:[r.jsxs(Ge,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-white px-3 py-1",children:[r.jsx(yh,{className:"h-3 w-3"}),r.jsx("span",{children:k})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-slate-50 text-[11px]",children:i?"Filtered by specific doctor":"All doctors in OPD"}),r.jsx("span",{className:"text-[11px] text-slate-400",children:o?"Refreshing":"Live clinical summary"})]})]})]}),r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(st,{className:"border-b border-slate-100 pb-3",children:[r.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:[r.jsx(yh,{className:"h-4 w-4"}),"Date & Doctor Filters"]}),r.jsx(Re,{type:"button",variant:"outline",size:"sm",onClick:()=>{const P=PR(),R=IR(P,-6);s(R),a(P),l(null)},children:"Last 7 days"})]}),r.jsx(Ca,{className:"mt-1 text-xs text-slate-500",children:"Use this view daily for clinical huddle, OPD utilisation review and doctor-wise load balancing."})]}),r.jsxs(qe,{className:"space-y-4 pt-4",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:"From date"}),r.jsx(Ee,{type:"date",value:t,onChange:P=>s(P.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:"To date"}),r.jsx(Ee,{type:"date",value:n,onChange:P=>a(P.target.value)})]}),r.jsx("div",{className:"flex items-end",children:r.jsx(Re,{type:"button",className:"w-full",variant:"outline",onClick:()=>f({dateFrom:t,dateTo:n}),disabled:o,children:o?"Refreshing":"Refresh"})})]}),r.jsx(Fo,{value:i,onChange:m,label:"Filter by doctor (optional)"})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsx(st,{className:"pb-1",children:r.jsxs(lt,{className:"flex items-center justify-between text-xs font-medium text-slate-500",children:["Total appointments",r.jsx(sn,{className:"h-4 w-4 text-slate-400"})]})}),r.jsx(qe,{children:T?r.jsxs(r.Fragment,{children:[r.jsx(Je,{className:"mb-1 h-7 w-16"}),r.jsx(Je,{className:"h-3 w-32"})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:b.total??""}),r.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["Unique patients:"," ",r.jsx("span",{className:"font-semibold",children:b.unique_patients??""})]})]})})]}),r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsx(st,{className:"pb-1",children:r.jsxs(lt,{className:"flex items-center justify-between text-xs font-medium text-slate-500",children:["Completed visits",r.jsx(Ur,{className:"h-4 w-4 text-emerald-500"})]})}),r.jsx(qe,{children:T?r.jsxs(r.Fragment,{children:[r.jsx(Je,{className:"mb-1 h-7 w-16"}),r.jsx(Je,{className:"h-3 w-40"})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:b.completed??""}),r.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["In progress:"," ",r.jsx("span",{className:"font-semibold",children:b.in_progress??0})," "," Checked-in:"," ",r.jsx("span",{className:"font-semibold",children:b.checked_in??0})]})]})})]}),r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsx(st,{className:"pb-1",children:r.jsxs(lt,{className:"flex items-center justify-between text-xs font-medium text-slate-500",children:["No-show & cancellations",r.jsx(So,{className:"h-4 w-4 text-amber-500"})]})}),r.jsx(qe,{children:T?r.jsxs(r.Fragment,{children:[r.jsx(Je,{className:"mb-1 h-7 w-16"}),r.jsx(Je,{className:"h-3 w-32"})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:b.no_show??""}),r.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["Cancelled:"," ",r.jsx("span",{className:"font-semibold",children:b.cancelled??0})]})]})})]}),r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsx(st,{className:"pb-1",children:r.jsxs(lt,{className:"flex items-center justify-between text-xs font-medium text-slate-500",children:["Follow-ups",r.jsx(_s,{className:"h-4 w-4 text-sky-500"})]})}),r.jsx(qe,{children:T?r.jsxs(r.Fragment,{children:[r.jsx(Je,{className:"mb-1 h-7 w-16"}),r.jsx(Je,{className:"h-3 w-44"})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:w.total??""}),r.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["Waiting:"," ",r.jsx("span",{className:"font-semibold",children:w.waiting??0})," "," Scheduled:"," ",r.jsx("span",{className:"font-semibold",children:w.scheduled??0})]})]})})]})]}),r.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm lg:col-span-2",children:[r.jsxs(st,{className:"pb-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs(lt,{className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:["Doctor-wise OPD load",r.jsx(Fc,{className:"h-4 w-4 text-slate-400"})]}),A>0&&r.jsxs(Ge,{className:"rounded-full bg-slate-900 text-[11px] font-normal text-white",children:["Total: ",A]})]}),r.jsx(Ca,{className:"mt-1 text-xs text-slate-500",children:"Each bar represents total appointments per doctor in the chosen period."})]}),r.jsx(qe,{className:"h-72 pt-2",children:_.length===0?r.jsx("div",{className:"flex h-full items-center justify-center text-sm text-slate-500",children:o?"Loading":"No data in selected range"}):r.jsx(Ud,{width:"100%",height:"100%",children:r.jsxs(Q1,{data:_,children:[r.jsx(ux,{dataKey:"name",tick:{fontSize:11},interval:0,height:40}),r.jsx(hx,{}),r.jsx(Wd,{}),r.jsx(dx,{dataKey:"total"})]})})})]}),r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsx(st,{className:"pb-2",children:r.jsxs(lt,{className:"flex items-center justify-between text-sm font-medium text-slate-700",children:["Highlights",r.jsx(Ine,{className:"h-4 w-4 text-slate-400"})]})}),r.jsxs(qe,{className:"space-y-4 pt-1 text-xs",children:[r.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-slate-50/60 px-3 py-2",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("span",{className:"font-semibold text-slate-800",children:"Top by appointments"}),r.jsx(Ge,{variant:"outline",className:"rounded-full border-emerald-200 bg-emerald-50 text-[10px] text-emerald-700",children:"Volume"})]}),x.top_doctor_by_appointments?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"mt-1 text-[13px] font-medium text-slate-900",children:x.top_doctor_by_appointments.doctor_name}),r.jsxs("p",{className:"mt-0.5 text-[11px] text-slate-500",children:["Dept:"," ",x.top_doctor_by_appointments.department_name||""]}),r.jsxs("p",{className:"mt-1 text-[11px] text-slate-500",children:["Total appointments:"," ",r.jsx("span",{className:"font-semibold",children:x.top_doctor_by_appointments.total_appointments}),r.jsx("br",{}),"No-show:"," ",r.jsx("span",{className:"font-semibold",children:x.top_doctor_by_appointments.no_show}),r.jsx("br",{}),"Follow-ups in range:"," ",r.jsx("span",{className:"font-semibold",children:x.top_doctor_by_appointments.followups_in_range})]})]}):r.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:o?"Calculating":"No doctor data in this range."})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-white px-3 py-2",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("span",{className:"font-semibold text-slate-800",children:"Top by completed visits"}),r.jsx(Ge,{variant:"outline",className:"rounded-full border-sky-200 bg-sky-50 text-[10px] text-sky-700",children:"Quality"})]}),x.top_doctor_by_completed?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"mt-1 text-[13px] font-medium text-slate-900",children:x.top_doctor_by_completed.doctor_name}),r.jsxs("p",{className:"mt-0.5 text-[11px] text-slate-500",children:["Dept:"," ",x.top_doctor_by_completed.department_name||""]}),r.jsxs("p",{className:"mt-1 text-[11px] text-slate-500",children:["Completed visits:"," ",r.jsx("span",{className:"font-semibold",children:x.top_doctor_by_completed.completed})]})]}):r.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:o?"Calculating":"Waiting for enough completed visits."})]}),r.jsx("p",{className:"text-[10px] leading-relaxed text-slate-500",children:"Use these insights for scheduling next weeks OPD, balancing high-load doctors and monitoring no-show trends."})]})]})]}),r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(st,{className:"pb-2",children:[r.jsxs(lt,{className:"flex items-center justify-between text-sm font-medium text-slate-700",children:["Doctor-wise breakdown",r.jsx(Fc,{className:"h-4 w-4 text-slate-400"})]}),r.jsx(Ca,{className:"mt-1 text-xs text-slate-500",children:"Each row shows total load, outcomes and follow-ups for a doctor in the selected range."})]}),r.jsx(qe,{className:"overflow-x-auto pt-2",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b text-xs text-slate-500",children:[r.jsx("th",{className:"py-2 pr-2 text-left",children:"Doctor"}),r.jsx("th",{className:"py-2 px-2 text-left",children:"Department"}),r.jsx("th",{className:"py-2 px-2 text-right",children:"Total"}),r.jsx("th",{className:"py-2 px-2 text-right",children:"Completed"}),r.jsx("th",{className:"py-2 px-2 text-right",children:"No-show"}),r.jsx("th",{className:"py-2 px-2 text-right",children:"Cancelled"}),r.jsx("th",{className:"py-2 pl-2 text-right",children:"Follow-ups"})]})}),r.jsxs("tbody",{children:[j.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"py-4 text-center text-xs text-slate-500",children:o?"Loading":"No data to show"})}),j.map(P=>r.jsxs("tr",{className:"border-b last:border-0 hover:bg-slate-50/70",children:[r.jsx("td",{className:"py-2 pr-2 text-slate-800",children:P.doctor_name}),r.jsx("td",{className:"py-2 px-2 text-slate-600",children:P.department_name||""}),r.jsx("td",{className:"py-2 px-2 text-right",children:P.total_appointments}),r.jsx("td",{className:"py-2 px-2 text-right",children:P.completed}),r.jsx("td",{className:"py-2 px-2 text-right",children:P.no_show}),r.jsx("td",{className:"py-2 px-2 text-right",children:P.cancelled}),r.jsx("td",{className:"py-2 pl-2 text-right",children:P.followups_in_range})]},P.doctor_id))]})]})})]})]})})}var uw="Dialog",[qG]=Mu(uw),[F6e,fl]=qG(uw),GG=t=>{const{__scopeDialog:s,children:n,open:a,defaultOpen:i,onOpenChange:l,modal:o=!0}=t,c=y.useRef(null),d=y.useRef(null),[u,f]=$p({prop:a,defaultProp:i??!1,onChange:l,caller:uw});return r.jsx(F6e,{scope:s,triggerRef:c,contentRef:d,contentId:Ic(),titleId:Ic(),descriptionId:Ic(),open:u,onOpenChange:f,onOpenToggle:y.useCallback(()=>f(m=>!m),[f]),modal:o,children:n})};GG.displayName=uw;var KG="DialogTrigger",$6e=y.forwardRef((t,s)=>{const{__scopeDialog:n,...a}=t,i=fl(KG,n),l=Ss(s,i.triggerRef);return r.jsx(Qt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":uE(i.open),...a,ref:l,onClick:Wt(t.onClick,i.onOpenToggle)})});$6e.displayName=KG;var cE="DialogPortal",[z6e,YG]=qG(cE,{forceMount:void 0}),XG=t=>{const{__scopeDialog:s,forceMount:n,children:a,container:i}=t,l=fl(cE,s);return r.jsx(z6e,{scope:s,forceMount:n,children:y.Children.map(a,o=>r.jsx($o,{present:n||l.open,children:r.jsx(gk,{asChild:!0,container:i,children:o})}))})};XG.displayName=cE;var tb="DialogOverlay",QG=y.forwardRef((t,s)=>{const n=YG(tb,t.__scopeDialog),{forceMount:a=n.forceMount,...i}=t,l=fl(tb,t.__scopeDialog);return l.modal?r.jsx($o,{present:a||l.open,children:r.jsx(V6e,{...i,ref:s})}):null});QG.displayName=tb;var U6e=tf("DialogOverlay.RemoveScroll"),V6e=y.forwardRef((t,s)=>{const{__scopeDialog:n,...a}=t,i=fl(tb,n);return r.jsx(yk,{as:U6e,allowPinchZoom:!0,shards:[i.contentRef],children:r.jsx(Qt.div,{"data-state":uE(i.open),...a,ref:s,style:{pointerEvents:"auto",...a.style}})})}),Eu="DialogContent",ZG=y.forwardRef((t,s)=>{const n=YG(Eu,t.__scopeDialog),{forceMount:a=n.forceMount,...i}=t,l=fl(Eu,t.__scopeDialog);return r.jsx($o,{present:a||l.open,children:l.modal?r.jsx(H6e,{...i,ref:s}):r.jsx(W6e,{...i,ref:s})})});ZG.displayName=Eu;var H6e=y.forwardRef((t,s)=>{const n=fl(Eu,t.__scopeDialog),a=y.useRef(null),i=Ss(s,n.contentRef,a);return y.useEffect(()=>{const l=a.current;if(l)return XB(l)},[]),r.jsx(JG,{...t,ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Wt(t.onCloseAutoFocus,l=>{var o;l.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Wt(t.onPointerDownOutside,l=>{const o=l.detail.originalEvent,c=o.button===0&&o.ctrlKey===!0;(o.button===2||c)&&l.preventDefault()}),onFocusOutside:Wt(t.onFocusOutside,l=>l.preventDefault())})}),W6e=y.forwardRef((t,s)=>{const n=fl(Eu,t.__scopeDialog),a=y.useRef(!1),i=y.useRef(!1);return r.jsx(JG,{...t,ref:s,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{var o,c;(o=t.onCloseAutoFocus)==null||o.call(t,l),l.defaultPrevented||(a.current||(c=n.triggerRef.current)==null||c.focus(),l.preventDefault()),a.current=!1,i.current=!1},onInteractOutside:l=>{var d,u;(d=t.onInteractOutside)==null||d.call(t,l),l.defaultPrevented||(a.current=!0,l.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const o=l.target;((u=n.triggerRef.current)==null?void 0:u.contains(o))&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&i.current&&l.preventDefault()}})}),JG=y.forwardRef((t,s)=>{const{__scopeDialog:n,trapFocus:a,onOpenAutoFocus:i,onCloseAutoFocus:l,...o}=t,c=fl(Eu,n),d=y.useRef(null),u=Ss(s,d);return _B(),r.jsxs(r.Fragment,{children:[r.jsx(ok,{asChild:!0,loop:!0,trapped:a,onMountAutoFocus:i,onUnmountAutoFocus:l,children:r.jsx(lk,{role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":uE(c.open),...o,ref:u,onDismiss:()=>c.onOpenChange(!1)})}),r.jsxs(r.Fragment,{children:[r.jsx(q6e,{titleId:c.titleId}),r.jsx(K6e,{contentRef:d,descriptionId:c.descriptionId})]})]})}),dE="DialogTitle",eK=y.forwardRef((t,s)=>{const{__scopeDialog:n,...a}=t,i=fl(dE,n);return r.jsx(Qt.h2,{id:i.titleId,...a,ref:s})});eK.displayName=dE;var tK="DialogDescription",sK=y.forwardRef((t,s)=>{const{__scopeDialog:n,...a}=t,i=fl(tK,n);return r.jsx(Qt.p,{id:i.descriptionId,...a,ref:s})});sK.displayName=tK;var nK="DialogClose",rK=y.forwardRef((t,s)=>{const{__scopeDialog:n,...a}=t,i=fl(nK,n);return r.jsx(Qt.button,{type:"button",...a,ref:s,onClick:Wt(t.onClick,()=>i.onOpenChange(!1))})});rK.displayName=nK;function uE(t){return t?"open":"closed"}var aK="DialogTitleWarning",[rBe,iK]=khe(aK,{contentName:Eu,titleName:dE,docsSlug:"dialog"}),q6e=({titleId:t})=>{const s=iK(aK),n=`\`${s.contentName}\` requires a \`${s.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${s.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${s.docsSlug}`;return y.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},G6e="DialogDescriptionWarning",K6e=({contentRef:t,descriptionId:s})=>{const a=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${iK(G6e).contentName}}.`;return y.useEffect(()=>{var l;const i=(l=t.current)==null?void 0:l.getAttribute("aria-describedby");s&&i&&(document.getElementById(s)||console.warn(a))},[a,t,s]),null},lK=GG,oK=XG,hw=QG,fw=ZG,mw=eK,pw=sK,cK=rK;const ah=lK,Y6e=oK,dK=y.forwardRef(({className:t,...s},n)=>r.jsx(hw,{ref:n,className:Pt("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s}));dK.displayName=hw.displayName;const Ed=y.forwardRef(({className:t,children:s,...n},a)=>r.jsxs(Y6e,{children:[r.jsx(dK,{}),r.jsxs(fw,{ref:a,className:Pt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[s,r.jsxs(cK,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[r.jsx(Rn,{className:"h-4 w-4"}),r.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Ed.displayName=fw.displayName;const Td=({className:t,...s})=>r.jsx("div",{className:Pt("flex flex-col space-y-1.5 text-center sm:text-left",t),...s});Td.displayName="DialogHeader";const Pd=({className:t,...s})=>r.jsx("div",{className:Pt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s});Pd.displayName="DialogFooter";const Id=y.forwardRef(({className:t,...s},n)=>r.jsx(mw,{ref:n,className:Pt("text-lg font-semibold leading-none tracking-tight",t),...s}));Id.displayName=mw.displayName;const Md=y.forwardRef(({className:t,...s},n)=>r.jsx(pw,{ref:n,className:Pt("text-sm text-muted-foreground",t),...s}));Md.displayName=pw.displayName;const Wj=lK,X6e=oK,uK=y.forwardRef(({className:t,...s},n)=>r.jsx(hw,{className:Pt("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s,ref:n}));uK.displayName=hw.displayName;const Q6e=Lb("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),ey=y.forwardRef(({side:t="right",className:s,children:n,...a},i)=>r.jsxs(X6e,{children:[r.jsx(uK,{}),r.jsxs(fw,{ref:i,className:Pt(Q6e({side:t}),s),...a,children:[r.jsxs(cK,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[r.jsx(Rn,{className:"h-4 w-4"}),r.jsx("span",{className:"sr-only",children:"Close"})]}),n]})]}));ey.displayName=fw.displayName;const ty=({className:t,...s})=>r.jsx("div",{className:Pt("flex flex-col space-y-2 text-center sm:text-left",t),...s});ty.displayName="SheetHeader";const sy=y.forwardRef(({className:t,...s},n)=>r.jsx(mw,{ref:n,className:Pt("text-lg font-semibold text-foreground",t),...s}));sy.displayName=mw.displayName;const ny=y.forwardRef(({className:t,...s},n)=>r.jsx(pw,{ref:n,className:Pt("text-sm text-muted-foreground",t),...s}));ny.displayName=pw.displayName;function Ui(t){if(!t)return"";try{return new Date(t).toLocaleDateString()}catch{return t}}function Or(t){return t==null?"0":Number(t).toLocaleString(void 0,{maximumFractionDigits:2})}function Z6e(){const[t,s]=y.useState("dashboard"),[n,a]=y.useState([]),[i,l]=y.useState([]),[o,c]=y.useState([]),[d,u]=y.useState(!1),[f,m]=y.useState([]),[x,b]=y.useState([]),[w,j]=y.useState([]),[_,C]=y.useState([]),[k,A]=y.useState([]),[T,P]=y.useState([]),[R,I]=y.useState(!1),[O,M]=y.useState([]),[B,L]=y.useState(!1),[F,V]=y.useState([]),[U,z]=y.useState(!1),[W,q]=y.useState([]),[G,se]=y.useState(!1),[ge,ke]=y.useState([]),[ee,pe]=y.useState(!1),[ue,ye]=y.useState("ALL"),[X,oe]=y.useState(""),[_e,ce]=y.useState("saleable"),[he,fe]=y.useState(!1),[le,Ve]=y.useState(null),[Ke,wt]=y.useState(!1),[mt,rt]=y.useState(!1),[bt,be]=y.useState([]),[ne,me]=y.useState({supplier_id:"",location_id:"",expected_date:"",notes:""}),[Ne,Be]=y.useState({open:!1,poId:null,email:""}),[jt,yt]=y.useState(!1),[pt,Cs]=y.useState({supplier_id:"",location_id:"",invoice_number:"",invoice_date:"",notes:""}),[hs,ae]=y.useState([]),[Te,de]=y.useState(!1),[Pe,Ue]=y.useState({type:"TO_SUPPLIER",supplier_id:"",location_id:"",reason:""}),[Le,Dt]=y.useState([]),[Rt,Zt]=y.useState(!1),[vs,bn]=y.useState(null),[Li,zt]=y.useState(!1),[Gt,ii]=y.useState(null);y.useEffect(()=>{we(),Ot()},[]);function Ot(){it(),ct(),Kt(),$t(),Ut(),Qs()}async function we(){try{const[Q,Ce]=await Promise.all([zb(),Kue()]);a(Q.data||[]),l(Ce.data||[])}catch(Q){console.error(Q)}}async function it(){u(!0);try{const Q=await ik({q:X||void 0,is_active:!0});c(Q.data||[])}catch(Q){console.error(Q)}finally{u(!1)}}async function ct(){I(!0);const Q=ue&&ue!=="ALL"?{location_id:ue}:{};try{const[Ce,Oe,ot,Ft,je,te]=await Promise.all([the(Q),she(Q),nhe(Q),rhe(Q),ahe(Q),ihe(Q)]);m(Ce.data||[]),b(Oe.data||[]),j(ot.data||[]),C(Ft.data||[]),A(je.data||[]),P(te.data||[])}catch(Ce){console.error(Ce)}finally{I(!1)}}async function Kt(){L(!0);try{const Q=await ohe({});M(Q.data||[])}catch(Q){console.error(Q)}finally{L(!1)}}async function $t(){z(!0);try{const Q=await fhe({});V(Q.data||[])}catch(Q){console.error(Q)}finally{z(!1)}}async function Ut(){se(!0);try{const Q=await xhe({});q(Q.data||[])}catch(Q){console.error(Q)}finally{se(!1)}}async function Qs(){pe(!0);try{const Q=await yhe({});ke(Q.data||[])}catch(Q){console.error(Q)}finally{pe(!1)}}const ws=y.useMemo(()=>o.length,[o]),Bn=y.useMemo(()=>x.length,[x]),dn=y.useMemo(()=>k.length,[k]),Fn=y.useMemo(()=>w.length,[w]),ar=y.useMemo(()=>_.length,[_]),at=y.useMemo(()=>O.filter(Q=>Q.status!=="COMPLETED"&&Q.status!=="CANCELLED"&&Q.status!=="CLOSED").length,[O]);function Bi(){Ve(null),fe(!0)}function ml(Q){Ve(Q),fe(!0)}const Ir=async Q=>{var Ft,je;Q.preventDefault();const Ce=Q.currentTarget,Oe={code:Ce.code.value.trim(),name:Ce.name.value.trim(),generic_name:Ce.generic_name.value.trim()||null,form:Ce.form.value.trim()||null,strength:Ce.strength.value.trim()||null,unit:Ce.unit.value.trim()||"tablet",pack_size:Ce.pack_size.value||"10",manufacturer:Ce.manufacturer.value.trim()||null,default_price:Ce.default_price.value||null,default_mrp:Ce.default_mrp.value||null,default_tax_percent:Ce.default_tax_percent.value||null,reorder_level:Ce.reorder_level.value||null,max_level:Ce.max_level.value||null,class_name:Ce.class_name.value.trim()||null,atc_code:Ce.atc_code.value.trim()||null,hsn_code:Ce.hsn_code.value.trim()||null,is_consumable:Ce.is_consumable.checked,lasa_flag:Ce.lasa_flag.checked},ot=(je=(Ft=Ce.qr_number)==null?void 0:Ft.value)==null?void 0:je.trim();ot&&(Oe.qr_number=ot);try{le!=null&&le.id?(await Zue(le.id,Oe),ie.success("Item updated")):(await Que(Oe),ie.success("Item created")),fe(!1),Ce.reset(),await Promise.all([it(),ct()])}catch(te){console.error("Failed to save item",te)}};function Go(){bn(null),Zt(!0)}function Uu(Q){bn(Q),Zt(!0)}async function Vu(Q){Q.preventDefault();const Ce=new FormData(Q.target),Oe={code:Ce.get("code")||"",name:Ce.get("name")||"",description:Ce.get("description")||"",is_active:!0};if(!Oe.name){ie.error("Location name is required");return}try{vs?(await Gue(vs.id,Oe),ie.success("Location updated")):(await que(Oe),ie.success("Location created")),Zt(!1),bn(null),await we(),await ct()}catch(ot){console.error(ot)}}function li(){ii(null),zt(!0)}function bw(Q){ii(Q),zt(!0)}async function vw(Q){Q.preventDefault();const Ce=new FormData(Q.target),Oe={code:Ce.get("code")||"",name:Ce.get("name")||"",contact_person:Ce.get("contact_person")||"",phone:Ce.get("phone")||"",email:Ce.get("email")||"",gst_number:Ce.get("gst_number")||"",address:Ce.get("address")||"",is_active:!0};if(!Oe.name){ie.error("Supplier name is required");return}try{Gt?(await Xue(Gt.id,Oe),ie.success("Supplier updated")):(await Yue(Oe),ie.success("Supplier created")),zt(!1),ii(null),await we(),await Kt(),await $t(),await Ut()}catch(ot){console.error(ot)}}async function oi(){try{const Q=await Jue(),Ce=new Blob([Q.data],{type:"text/csv"}),Oe=URL.createObjectURL(Ce),ot=document.createElement("a");ot.href=Oe,ot.download="pharmacy_items_sample.csv",ot.click(),URL.revokeObjectURL(Oe)}catch(Q){console.error(Q)}}async function gr(Q){var Oe,ot;Q.preventDefault();const Ce=(ot=(Oe=Q.target.file)==null?void 0:Oe.files)==null?void 0:ot[0];if(!Ce){ie.error("Please choose a CSV file");return}try{const Ft=await ehe(Ce);ie.success(`Items uploaded  created: ${Ft.data.created}, updated: ${Ft.data.updated}`),wt(!1),it(),ct()}catch(Ft){console.error(Ft)}}function Is(){be(Q=>[...Q,{item_id:"",ordered_qty:1,unit_cost:0,tax_percent:0,mrp:0}])}function md(Q,Ce,Oe){be(ot=>ot.map((Ft,je)=>je===Q?{...Ft,[Ce]:Oe}:Ft))}function pl(Q){be(Ce=>Ce.filter((Oe,ot)=>ot!==Q))}async function Kf(Q){if(Q.preventDefault(),!ne.supplier_id||!ne.location_id||bt.length===0){ie.error("Supplier, location and at least one line are required");return}const Ce={supplier_id:Number(ne.supplier_id),location_id:Number(ne.location_id),order_date:new Date().toISOString().slice(0,10),expected_date:ne.expected_date||null,notes:ne.notes||"",items:bt.filter(Oe=>Oe.item_id).map(Oe=>({item_id:Number(Oe.item_id),ordered_qty:Number(Oe.ordered_qty||0),unit_cost:Number(Oe.unit_cost||0),tax_percent:Number(Oe.tax_percent||0),mrp:Number(Oe.mrp||0)}))};if(Ce.items.length===0){ie.error("Add at least one valid line");return}try{await lhe(Ce),ie.success("Purchase order created"),rt(!1),be([]),me({supplier_id:"",location_id:"",expected_date:"",notes:""}),Kt()}catch(Oe){console.error(Oe)}}async function ze(Q,Ce){try{await che(Q,Ce),ie.success(`PO marked as ${Ce}`),Kt()}catch(Oe){console.error(Oe)}}async function ww(Q){try{const Ce=await dhe(Q),Oe=new Blob([Ce.data],{type:"application/pdf"}),ot=URL.createObjectURL(Oe);window.open(ot,"_blank"),setTimeout(()=>URL.revokeObjectURL(ot),1e4)}catch(Ce){console.error(Ce)}}async function Vs(Q){Q.preventDefault();const{poId:Ce,email:Oe}=Ne;if(!Oe){ie.error("Email is required");return}try{await uhe(Ce,Oe),ie.success("PO marked as SENT"),Be({open:!1,poId:null,email:""}),Kt()}catch(ot){console.error(ot)}}function Ko(){ae(Q=>[...Q,{item_id:"",po_item_id:null,batch_no:"",expiry_date:"",quantity:0,free_quantity:0,unit_cost:0,tax_percent:0,mrp:0}])}function pd(Q,Ce,Oe){ae(ot=>ot.map((Ft,je)=>je===Q?{...Ft,[Ce]:Oe}:Ft))}function ls(Q){ae(Ce=>Ce.filter((Oe,ot)=>ot!==Q))}async function ns(Q){if(Q.preventDefault(),!pt.supplier_id||!pt.location_id||hs.length===0){ie.error("Supplier, location and at least one line are required");return}const Ce={po_id:null,supplier_id:Number(pt.supplier_id),location_id:Number(pt.location_id),received_date:new Date().toISOString().slice(0,10),invoice_number:pt.invoice_number||"",invoice_date:pt.invoice_date||null,notes:pt.notes||"",items:hs.filter(Oe=>Oe.item_id&&Oe.batch_no).map(Oe=>({item_id:Number(Oe.item_id),po_item_id:Oe.po_item_id?Number(Oe.po_item_id):null,batch_no:Oe.batch_no,expiry_date:Oe.expiry_date||null,quantity:Number(Oe.quantity||0),free_quantity:Number(Oe.free_quantity||0),unit_cost:Number(Oe.unit_cost||0),tax_percent:Number(Oe.tax_percent||0),mrp:Number(Oe.mrp||0)}))};if(Ce.items.length===0){ie.error("Add at least one valid GRN line");return}try{await hhe(Ce),ie.success("GRN created in DRAFT"),yt(!1),ae([]),Cs({supplier_id:"",location_id:"",invoice_number:"",invoice_date:"",notes:""}),$t(),ct()}catch(Oe){console.error(Oe)}}async function Jt(Q){try{await mhe(Q),ie.success("GRN posted & stock updated"),$t(),ct(),Kt()}catch(Ce){console.error(Ce)}}function Yf(){Dt(Q=>[...Q,{item_id:"",batch_id:"",batch_no:"",quantity:0,reason:""}])}function Yo(Q,Ce,Oe){Dt(ot=>ot.map((Ft,je)=>je===Q?{...Ft,[Ce]:Oe}:Ft))}function Xf(Q){Dt(Ce=>Ce.filter((Oe,ot)=>ot!==Q))}async function vn(Q){if(Q.preventDefault(),!Pe.location_id||Le.length===0){ie.error("Location and at least one line are required");return}const Ce={type:Pe.type,supplier_id:Pe.supplier_id?Number(Pe.supplier_id):null,location_id:Number(Pe.location_id),return_date:new Date().toISOString().slice(0,10),reason:Pe.reason||"",items:Le.filter(Oe=>Oe.item_id&&Oe.quantity).map(Oe=>({item_id:Number(Oe.item_id),batch_id:Oe.batch_id?Number(Oe.batch_id):null,batch_no:Oe.batch_no?Oe.batch_no.trim():null,quantity:Number(Oe.quantity||0),reason:Oe.reason||""}))};if(Ce.items.length===0){ie.error("Add at least one valid return line");return}try{await phe(Ce),ie.success("Return created in DRAFT"),de(!1),Dt([]),Ue({type:"TO_SUPPLIER",supplier_id:"",location_id:"",reason:""}),Ut(),ct()}catch(Oe){console.error(Oe)}}function Fi(Q,Ce="EXPIRED"){var Ft;if(!Q)return;const Oe=((Ft=Q.item)==null?void 0:Ft.name)||Q.name||Q.item_name||`Item #${Q.item_id??""}`,ot=Ce==="EXPIRED"?`Expired batch ${Q.batch_no||""} (${Oe})`:`Quarantine batch ${Q.batch_no||""} (${Oe})`;de(!0),Ue(je=>({...je,type:Ce==="EXPIRED"?"INTERNAL":je.type,location_id:Q.location_id?String(Q.location_id):je.location_id,reason:ot})),Dt([{item_id:String(Q.item_id),batch_id:String(Q.id),batch_no:Q.batch_no||"",quantity:Number(Q.current_qty??0),reason:Ce==="EXPIRED"?"Expired":"Quarantine / quality issue"}])}async function Nw(Q){try{await ghe(Q),ie.success("Return posted & stock updated"),Ut(),ct()}catch(Ce){console.error(Ce)}}const Ns=n.find(Q=>String(Q.id)===String(ue));return r.jsxs(Nt.div,{className:"p-4 sm:p-6 lg:p-8 bg-slate-50 min-h-screen",initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.18},children:[r.jsxs("div",{className:"mb-6 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-semibold tracking-tight text-slate-900",children:"Pharmacy Inventory"}),r.jsx("p",{className:"text-sm text-slate-500",children:"Batch-wise stock, purchase  GRN  returns, and full transaction audit for NABH-compliant pharmacy management."})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[r.jsxs(Ms,{value:ue,onValueChange:Q=>{ye(Q),setTimeout(ct,0)},children:[r.jsx(Es,{className:"w-48 bg-white",children:r.jsx(Ds,{placeholder:"All locations","aria-label":"Location filter"})}),r.jsxs(Ts,{children:[r.jsx(Mt,{value:"ALL",children:"All locations"}),n.map(Q=>r.jsx(Mt,{value:String(Q.id),children:Q.code?`${Q.code}  ${Q.name}`:Q.name},Q.id))]})]}),r.jsx(Re,{variant:"outline",size:"icon",className:"rounded-full",onClick:Ot,children:r.jsx(hu,{className:"w-4 h-4"})})]})]}),r.jsxs("div",{className:"grid gap-4 mb-6 md:grid-cols-4",children:[r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(st,{className:"pb-2 flex flex-row items-center justify-between",children:[r.jsx(lt,{className:"text-xs font-medium text-slate-500",children:"Active items"}),r.jsx(Vr,{className:"w-4 h-4 text-slate-400"})]}),r.jsxs(qe,{children:[r.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:ws}),r.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Medicines & consumables in catalogue"})]})]}),r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(st,{className:"pb-2 flex flex-row items-center justify-between",children:[r.jsx(lt,{className:"text-xs font-medium text-slate-500",children:"Near-expiry batches"}),r.jsx(So,{className:"w-4 h-4 text-amber-500"})]}),r.jsxs(qe,{children:[r.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:Bn}),r.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Within alert window  Expired on shelf: ",Fn]})]})]}),r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(st,{className:"pb-2 flex flex-row items-center justify-between",children:[r.jsx(lt,{className:"text-xs font-medium text-slate-500",children:"Low-stock items"}),r.jsx(qse,{className:"w-4 h-4 text-sky-500"})]}),r.jsxs(qe,{children:[r.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:dn}),r.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Below reorder threshold  Quarantine: ",ar]})]})]}),r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(st,{className:"pb-2 flex flex-row items-center justify-between",children:[r.jsx(lt,{className:"text-xs font-medium text-slate-500",children:"Open purchase orders"}),r.jsx(One,{className:"w-4 h-4 text-emerald-500"})]}),r.jsxs(qe,{children:[r.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:at}),r.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Draft / sent / partially received"})]})]})]}),r.jsxs(Hl,{value:t,onValueChange:s,className:"space-y-4",children:[r.jsxs(ll,{className:"bg-slate-100 rounded-full p-1 flex flex-wrap gap-1",children:[r.jsx(xs,{value:"dashboard",children:"Dashboard"}),r.jsx(xs,{value:"items",children:"Items"}),r.jsx(xs,{value:"locations",children:"Locations"}),r.jsx(xs,{value:"suppliers",children:"Suppliers"}),r.jsx(xs,{value:"stock",children:"Stock & Alerts"}),r.jsx(xs,{value:"po",children:"Purchase Orders"}),r.jsx(xs,{value:"grn",children:"GRN"}),r.jsx(xs,{value:"returns",children:"Returns"}),r.jsx(xs,{value:"txns",children:"Transactions"})]}),r.jsx(fs,{value:"dashboard",children:r.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(st,{className:"flex flex-row items-center justify-between pb-2",children:[r.jsxs(lt,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Expiry alerts",r.jsx(Ge,{variant:"outline",className:"text-xs",children:x.length})]}),r.jsx(So,{className:"w-4 h-4 text-amber-500"})]}),r.jsx(qe,{className:"space-y-3 max-h-[320px] overflow-auto",children:R?r.jsxs("div",{className:"space-y-2",children:[r.jsx(Je,{className:"h-8 w-full"}),r.jsx(Je,{className:"h-8 w-full"}),r.jsx(Je,{className:"h-8 w-full"})]}):x.length===0&&w.length===0?r.jsxs("p",{className:"text-sm text-slate-500",children:["No batches approaching expiry or expired on shelf for"," ",Ns?Ns.name:"all locations","."]}):r.jsxs(r.Fragment,{children:[w.length>0&&r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-xs font-semibold text-rose-600 uppercase tracking-wide",children:"Expired on shelf"}),r.jsx("div",{className:"space-y-1.5",children:w.map(Q=>{var Ce;return r.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-rose-200 bg-rose-50 px-3 py-2",children:[r.jsxs("div",{className:"space-y-0.5",children:[r.jsxs("p",{className:"text-sm font-medium text-slate-900",children:[((Ce=Q.item)==null?void 0:Ce.name)||Q.name||Q.item_name||`Item #${Q.item_id??""}`,Q.batch_no&&r.jsxs("span",{className:"text-xs text-slate-500",children:[" ","(",Q.batch_no,")"]})]}),r.jsxs("p",{className:"text-xs text-slate-500",children:["Qty:"," ",Or(Q.current_qty)," "," Expired:"," ",Ui(Q.expiry_date)]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs(Ge,{variant:"outline",className:"text-xs border-rose-300 text-rose-700",children:["Exp:"," ",Ui(Q.expiry_date)]}),r.jsx(Re,{type:"button",variant:"outline",size:"sm",className:"h-7 px-2 text-[11px]",onClick:()=>Fi(Q,"EXPIRED"),children:"Create return"})]})]},`expired-${Q.id}`)})})]}),x.length>0&&r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-xs font-semibold text-amber-600 uppercase tracking-wide",children:"Near expiry"}),r.jsx("div",{className:"space-y-1.5",children:x.map(Q=>{var Ce;return r.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-slate-200 px-3 py-2 bg-slate-50",children:[r.jsxs("div",{className:"space-y-0.5",children:[r.jsxs("p",{className:"text-sm font-medium text-slate-900",children:[((Ce=Q.item)==null?void 0:Ce.name)||Q.name||Q.item_name||`Item #${Q.item_id??""}`,Q.batch_no&&r.jsxs("span",{className:"text-xs text-slate-500",children:[" ","(",Q.batch_no,")"]})]}),r.jsxs("p",{className:"text-xs text-slate-500",children:["Qty:"," ",Or(Q.current_qty)," "," Exp:"," ",Ui(Q.expiry_date)]})]}),r.jsxs(Ge,{variant:"outline",className:"text-xs",children:["Exp:"," ",Ui(Q.expiry_date)]})]},`near-${Q.id}`)})})]})]})})]}),r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(st,{className:"flex flex-row items-center justify-between pb-2",children:[r.jsxs(lt,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Stock alerts",r.jsx(Ge,{variant:"outline",className:"text-xs",children:k.length+T.length})]}),r.jsx(sn,{className:"w-4 h-4 text-sky-500"})]}),r.jsx(qe,{className:"space-y-2 max-h-[320px] overflow-auto",children:R?r.jsxs("div",{className:"space-y-2",children:[r.jsx(Je,{className:"h-8 w-full"}),r.jsx(Je,{className:"h-8 w-full"}),r.jsx(Je,{className:"h-8 w-full"})]}):k.length===0&&T.length===0?r.jsxs("p",{className:"text-sm text-slate-500",children:["No low / max stock issues for"," ",Ns?Ns.name:"all locations","."]}):r.jsxs(r.Fragment,{children:[k.map(Q=>r.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-amber-200 bg-amber-50 px-3 py-2",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-slate-900",children:Q.name}),r.jsxs("p",{className:"text-xs text-slate-600",children:["Qty: ",Or(Q.total_qty)," / Reorder:"," ",Or(Q.reorder_level)]})]}),r.jsx(Ge,{variant:"outline",className:"text-xs border-amber-300 text-amber-700",children:"Low stock"})]},`low-${Q.item_id}-${Q.location_id||"all"}`)),T.map(Q=>r.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-sky-200 bg-sky-50 px-3 py-2",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-slate-900",children:Q.name}),r.jsxs("p",{className:"text-xs text-slate-600",children:["Qty: ",Or(Q.total_qty)," / Max:"," ",Or(Q.max_level)]})]}),r.jsx(Ge,{variant:"outline",className:"text-xs border-sky-300 text-sky-700",children:"Over-stock"})]},`max-${Q.item_id}-${Q.location_id||"all"}`))]})})]})]})}),r.jsx(fs,{value:"items",children:r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(st,{className:"flex flex-row items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs(lt,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Pharmacy items",r.jsx(Ge,{variant:"outline",className:"text-xs",children:o.length})]}),r.jsx("p",{className:"text-xs text-slate-500",children:"Medicines & consumables master  supports manual and CSV bulk upload."})]}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsxs(Re,{variant:"outline",size:"sm",className:"gap-1",onClick:()=>wt(!0),children:[r.jsx(m_,{className:"w-3 h-3"}),"CSV upload"]}),r.jsxs(Re,{variant:"outline",size:"sm",className:"gap-1",onClick:oi,children:[r.jsx(Ll,{className:"w-3 h-3"}),"Sample CSV"]}),r.jsxs(Re,{size:"sm",className:"gap-1",onClick:Bi,children:[r.jsx(us,{className:"w-3 h-3"}),"New item"]})]})]}),r.jsxs(qe,{className:"space-y-3",children:[r.jsx("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:r.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[r.jsx(Ee,{placeholder:"Search by name / code / generic...",className:"w-full sm:w-80 bg-white",value:X,onChange:Q=>oe(Q.target.value),onKeyDown:Q=>{Q.key==="Enter"&&it()}}),r.jsx(Re,{variant:"outline",size:"icon",className:"rounded-full",onClick:it,children:r.jsx(Ei,{className:"w-4 h-4"})})]})}),r.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[r.jsxs("div",{className:"grid grid-cols-[2fr,1.2fr,1fr,1fr,0.6fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[r.jsx("span",{children:"Name / code"}),r.jsx("span",{children:"Generic / form"}),r.jsx("span",{children:"Default price / MRP"}),r.jsx("span",{children:"Reorder / Max"}),r.jsx("span",{className:"text-right",children:"Actions"})]}),r.jsx("div",{className:"max-h-[420px] overflow-auto divide-y divide-slate-100",children:d?r.jsxs("div",{className:"p-3 space-y-2",children:[r.jsx(Je,{className:"h-7 w-full"}),r.jsx(Je,{className:"h-7 w-full"}),r.jsx(Je,{className:"h-7 w-full"})]}):o.length===0?r.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No items found. Use New item or CSV upload to add catalogue."}):o.map(Q=>r.jsxs("div",{className:"grid grid-cols-[2fr,1.2fr,1fr,1fr,0.6fr] items-center px-3 py-2 text-xs",children:[r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-slate-900",children:Q.name}),r.jsxs("div",{className:"text-slate-500 flex flex-wrap items-center gap-1",children:[r.jsx("span",{children:Q.code}),Q.is_consumable&&r.jsx(Ge,{variant:"outline",className:"text-[10px]",children:"Consumable"}),Q.lasa_flag&&r.jsx(Ge,{variant:"outline",className:"text-[10px] border-rose-300 text-rose-600",children:"LASA"})]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-slate-700",children:Q.generic_name||""}),r.jsxs("div",{className:"text-slate-500",children:[Q.form||""," ",Q.strength&&` ${Q.strength}`]})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"text-slate-700",children:["Price: ",Or(Q.default_price)]}),r.jsxs("div",{className:"text-slate-500",children:["MRP: ",Or(Q.default_mrp),"  Tax:"," ",Or(Q.default_tax_percent),"%"]})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"text-slate-700",children:["Reorder: ",Or(Q.reorder_level)]}),r.jsxs("div",{className:"text-slate-500",children:["Max: ",Or(Q.max_level)]})]}),r.jsx("div",{className:"flex items-center justify-end gap-2",children:r.jsx(Re,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>ml(Q),children:r.jsx(Zm,{className:"w-3 h-3"})})})]},Q.id))})]})]})]})}),r.jsx(fs,{value:"locations",children:r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(st,{className:"flex flex-row items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs(lt,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Inventory locations",r.jsx(Ge,{variant:"outline",className:"text-xs",children:n.length})]}),r.jsx("p",{className:"text-xs text-slate-500",children:"Define pharmacy / store locations for stock segregation and reporting."})]}),r.jsxs(Re,{size:"sm",className:"gap-1",onClick:Go,children:[r.jsx(us,{className:"w-3 h-3"}),"New location"]})]}),r.jsx(qe,{children:r.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[r.jsxs("div",{className:"grid grid-cols-[0.6fr,1.4fr,1fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[r.jsx("span",{children:"Code"}),r.jsx("span",{children:"Name"}),r.jsx("span",{className:"text-right",children:"Actions"})]}),r.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:n.length===0?r.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No locations defined yet. Click New location to add."}):n.map(Q=>r.jsxs("div",{className:"grid grid-cols-[0.6fr,1.4fr,1fr] items-center px-3 py-2 text-xs",children:[r.jsx("div",{className:"text-slate-900 font-medium",children:Q.code||""}),r.jsxs("div",{className:"text-slate-900",children:[Q.name,Q.description&&r.jsx("div",{className:"text-[11px] text-slate-500",children:Q.description})]}),r.jsx("div",{className:"flex items-center justify-end gap-2",children:r.jsx(Re,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>Uu(Q),children:r.jsx(Zm,{className:"w-3 h-3"})})})]},Q.id))})]})})]})}),r.jsx(fs,{value:"suppliers",children:r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(st,{className:"flex flex-row items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs(lt,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Suppliers",r.jsx(Ge,{variant:"outline",className:"text-xs",children:i.length})]}),r.jsx("p",{className:"text-xs text-slate-500",children:"Maintain vendor master for purchase orders, GRN, and returns."})]}),r.jsxs(Re,{size:"sm",className:"gap-1",onClick:li,children:[r.jsx(us,{className:"w-3 h-3"}),"New supplier"]})]}),r.jsx(qe,{children:r.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[r.jsxs("div",{className:"grid grid-cols-[0.8fr,1.4fr,1.4fr,0.8fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[r.jsx("span",{children:"Code"}),r.jsx("span",{children:"Name / contact"}),r.jsx("span",{children:"Contact details"}),r.jsx("span",{className:"text-right",children:"Actions"})]}),r.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:i.length===0?r.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No suppliers defined yet. Click New supplier to add."}):i.map(Q=>r.jsxs("div",{className:"grid grid-cols-[0.8fr,1.4fr,1.4fr,0.8fr] items-center px-3 py-2 text-xs",children:[r.jsx("div",{className:"text-slate-900 font-medium",children:Q.code||""}),r.jsxs("div",{className:"text-slate-900",children:[Q.name,Q.contact_person&&r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Contact: ",Q.contact_person]})]}),r.jsxs("div",{className:"text-slate-700 text-[11px] space-y-0.5",children:[Q.phone&&r.jsxs("div",{children:[" ",Q.phone]}),Q.email&&r.jsxs("div",{children:[" ",Q.email]}),Q.gst_number&&r.jsxs("div",{className:"text-slate-500",children:["GST: ",Q.gst_number]})]}),r.jsx("div",{className:"flex items-center justify-end gap-2",children:r.jsx(Re,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>bw(Q),children:r.jsx(Zm,{className:"w-3 h-3"})})})]},Q.id))})]})})]})}),r.jsx(fs,{value:"stock",children:r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(st,{className:"flex flex-row items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs(lt,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Stock summary",r.jsx(Ge,{variant:"outline",className:"text-xs",children:f.length})]}),r.jsx("p",{className:"text-xs text-slate-500",children:"Location-wise quantities with low / max level indicators."})]}),r.jsx(bne,{className:"w-4 h-4 text-slate-400"})]}),r.jsx(qe,{className:"space-y-4",children:r.jsxs(Hl,{value:_e,onValueChange:ce,className:"space-y-3",children:[r.jsxs(ll,{className:"bg-slate-100 rounded-full p-1 inline-flex gap-1",children:[r.jsx(xs,{value:"saleable",children:"Saleable stock"}),r.jsx(xs,{value:"quarantine",children:"Expired & quarantine"})]}),r.jsx(fs,{value:"saleable",className:"space-y-3",children:r.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[r.jsxs("div",{className:"grid grid-cols-[2fr,1.2fr,1fr,0.8fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[r.jsx("span",{children:"Item"}),r.jsx("span",{children:"Location"}),r.jsx("span",{children:"Qty"}),r.jsx("span",{children:"Status"})]}),r.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:R?r.jsxs("div",{className:"p-3 space-y-2",children:[r.jsx(Je,{className:"h-7 w-full"}),r.jsx(Je,{className:"h-7 w-full"}),r.jsx(Je,{className:"h-7 w-full"})]}):f.length===0?r.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No stock summary yet."}):f.map(Q=>{const Ce=[];return Q.is_low&&Ce.push(r.jsx(Ge,{variant:"outline",className:"border-amber-300 text-amber-700 text-[10px]",children:"Low"},"low")),Q.is_over&&Ce.push(r.jsx(Ge,{variant:"outline",className:"border-sky-300 text-sky-700 text-[10px]",children:"Max"},"max")),Ce.length||Ce.push(r.jsx(Ge,{variant:"outline",className:"text-[10px]",children:"OK"},"ok")),r.jsxs("div",{className:"grid grid-cols-[2fr,1.2fr,1fr,0.8fr] items-center px-3 py-2 text-xs",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-slate-900",children:Q.name}),r.jsx("p",{className:"text-slate-500",children:Q.code})]}),r.jsx("div",{className:"text-slate-700",children:Q.location_name||"All locations"}),r.jsx("div",{className:"text-slate-700",children:Or(Q.total_qty)}),r.jsx("div",{className:"flex gap-1 flex-wrap",children:Ce})]},`${Q.item_id}-${Q.location_id||"all"}`)})})]})}),r.jsx(fs,{value:"quarantine",className:"space-y-3",children:r.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[r.jsxs("div",{className:"grid grid-cols-[2fr,1.2fr,1fr,1fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[r.jsx("span",{children:"Item / batch"}),r.jsx("span",{children:"Location"}),r.jsx("span",{children:"Qty / expiry"}),r.jsx("span",{className:"text-right",children:"Status / actions"})]}),r.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:R?r.jsxs("div",{className:"p-3 space-y-2",children:[r.jsx(Je,{className:"h-7 w-full"}),r.jsx(Je,{className:"h-7 w-full"}),r.jsx(Je,{className:"h-7 w-full"})]}):_.length===0?r.jsxs("div",{className:"p-4 text-sm text-slate-500",children:["No quarantine / written-off / returned batches for"," ",Ns?Ns.name:"all locations","."]}):_.map(Q=>{var ot,Ft,je;const Ce=(Q.status||"").toUpperCase();let Oe="text-[10px]";return Ce==="EXPIRED"||Ce==="WRITTEN_OFF"?Oe+=" border-rose-300 text-rose-700":Ce==="QUARANTINE"?Oe+=" border-amber-300 text-amber-700":Ce==="RETURNED"&&(Oe+=" border-slate-300 text-slate-600"),r.jsxs("div",{className:"grid grid-cols-[2fr,1.2fr,1fr,1fr] items-center px-3 py-2 text-xs",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-slate-900",children:((ot=Q.item)==null?void 0:ot.name)||Q.name||Q.item_name||`Item #${Q.item_id??""}`}),r.jsxs("p",{className:"text-[11px] text-slate-500",children:["Batch:"," ",Q.batch_no||"","  Code:"," ",((Ft=Q.item)==null?void 0:Ft.code)||""]})]}),r.jsx("div",{className:"text-slate-700",children:((je=Q.location)==null?void 0:je.name)||""}),r.jsxs("div",{children:[r.jsxs("p",{className:"text-slate-700",children:["Qty:"," ",Or(Q.current_qty)]}),r.jsxs("p",{className:"text-[11px] text-slate-500",children:["Exp:"," ",Ui(Q.expiry_date)||""]})]}),r.jsxs("div",{className:"flex items-center justify-end gap-2",children:[r.jsx(Ge,{variant:"outline",className:Oe,children:Ce||"UNKNOWN"}),Ce!=="RETURNED"&&r.jsx(Re,{type:"button",variant:"outline",size:"sm",className:"h-7 px-2 text-[11px]",onClick:()=>Fi(Q,"QUARANTINE"),children:"Create return"})]})]},`q-${Q.id}`)})})]})})]})})]})}),r.jsx(fs,{value:"po",children:r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(st,{className:"flex flex-row items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs(lt,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Purchase orders",r.jsx(Ge,{variant:"outline",className:"text-xs",children:O.length})]}),r.jsx("p",{className:"text-xs text-slate-500",children:"Create POs, print PDF, mark sent, and track status."})]}),r.jsxs(Re,{size:"sm",className:"gap-1",onClick:()=>rt(!0),children:[r.jsx(us,{className:"w-3 h-3"}),"New PO"]})]}),r.jsx(qe,{children:r.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[r.jsxs("div",{className:"grid grid-cols-[1.1fr,1.2fr,1.2fr,0.9fr,0.9fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[r.jsx("span",{children:"PO number"}),r.jsx("span",{children:"Supplier"}),r.jsx("span",{children:"Location / dates"}),r.jsx("span",{children:"Status"}),r.jsx("span",{className:"text-right",children:"Actions"})]}),r.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:B?r.jsxs("div",{className:"p-3 space-y-2",children:[r.jsx(Je,{className:"h-7 w-full"}),r.jsx(Je,{className:"h-7 w-full"}),r.jsx(Je,{className:"h-7 w-full"})]}):O.length===0?r.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No purchase orders created yet."}):O.map(Q=>{var Ce,Oe,ot,Ft;return r.jsxs("div",{className:"grid grid-cols-[1.1fr,1.2fr,1.2fr,0.9fr,0.9fr] items-center px-3 py-2 text-xs",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-slate-900",children:Q.po_number}),r.jsxs("p",{className:"text-slate-500",children:["Created: ",Ui(Q.order_date)]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-slate-900",children:(Ce=Q.supplier)==null?void 0:Ce.name}),r.jsx("p",{className:"text-slate-500 text-[11px]",children:((Oe=Q.supplier)==null?void 0:Oe.phone)||((ot=Q.supplier)==null?void 0:ot.email)||""})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-slate-900",children:(Ft=Q.location)==null?void 0:Ft.name}),r.jsxs("p",{className:"text-slate-500 text-[11px]",children:["Exp:"," ",Q.expected_date?Ui(Q.expected_date):""]})]}),r.jsx("div",{children:r.jsx(Ge,{variant:"outline",className:"text-[10px] capitalize",children:Q.status.toLowerCase()})}),r.jsxs("div",{className:"flex items-center justify-end gap-2",children:[r.jsx(Re,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>ww(Q.id),children:r.jsx(My,{className:"w-3 h-3"})}),r.jsx(Re,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>Be({open:!0,poId:Q.id,email:Q.email_sent_to||""}),children:r.jsx(Zh,{className:"w-3 h-3"})}),Q.status==="DRAFT"||Q.status==="SENT"?r.jsxs(Ms,{defaultValue:Q.status,onValueChange:je=>ze(Q.id,je),children:[r.jsx(Es,{className:"h-7 w-24 text-[11px] bg-white",children:r.jsx(Ds,{})}),r.jsxs(Ts,{children:[r.jsx(Mt,{value:"DRAFT",children:"DRAFT"}),r.jsx(Mt,{value:"SENT",children:"SENT"}),r.jsx(Mt,{value:"PARTIALLY_RECEIVED",children:"PARTIAL"}),r.jsx(Mt,{value:"COMPLETED",children:"COMPLETED"}),r.jsx(Mt,{value:"CANCELLED",children:"CANCELLED"}),r.jsx(Mt,{value:"CLOSED",children:"CLOSED"})]})]}):r.jsx(Ge,{variant:"outline",className:"text-[10px] capitalize",children:Q.status.toLowerCase()})]})]},Q.id)})})]})})]})}),r.jsx(fs,{value:"grn",children:r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(st,{className:"flex flex-row items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs(lt,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Goods Receipt Notes",r.jsx(Ge,{variant:"outline",className:"text-xs",children:F.length})]}),r.jsx("p",{className:"text-xs text-slate-500",children:"Post GRNs to create batches and update stock (GRN  Stock transactions)."})]}),r.jsxs(Re,{size:"sm",className:"gap-1",onClick:()=>yt(!0),children:[r.jsx(us,{className:"w-3 h-3"}),"New GRN"]})]}),r.jsx(qe,{children:r.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[r.jsxs("div",{className:"grid grid-cols-[1.1fr,1.2fr,1.2fr,0.9fr,0.9fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[r.jsx("span",{children:"GRN number"}),r.jsx("span",{children:"Supplier"}),r.jsx("span",{children:"Location / invoice"}),r.jsx("span",{children:"Status"}),r.jsx("span",{className:"text-right",children:"Actions"})]}),r.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:U?r.jsxs("div",{className:"p-3 space-y-2",children:[r.jsx(Je,{className:"h-7 w-full"}),r.jsx(Je,{className:"h-7 w-full"}),r.jsx(Je,{className:"h-7 w-full"})]}):F.length===0?r.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No GRNs created yet."}):F.map(Q=>{var Ce,Oe,ot,Ft;return r.jsxs("div",{className:"grid grid-cols-[1.1fr,1.2fr,1.2fr,0.9fr,0.9fr] items-center px-3 py-2 text-xs",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-slate-900",children:Q.grn_number}),r.jsxs("p",{className:"text-slate-500",children:["Received: ",Ui(Q.received_date)]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-slate-900",children:(Ce=Q.supplier)==null?void 0:Ce.name}),r.jsx("p",{className:"text-slate-500 text-[11px]",children:((Oe=Q.supplier)==null?void 0:Oe.phone)||((ot=Q.supplier)==null?void 0:ot.email)||""})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-slate-900",children:(Ft=Q.location)==null?void 0:Ft.name}),r.jsxs("p",{className:"text-slate-500 text-[11px]",children:["Inv: ",Q.invoice_number||""," ",Q.invoice_date&&` ${Ui(Q.invoice_date)}`]})]}),r.jsx("div",{children:r.jsx(Ge,{variant:"outline",className:"text-[10px] capitalize",children:Q.status.toLowerCase()})}),r.jsxs("div",{className:"flex items-center justify-end gap-2",children:[r.jsx(Re,{variant:"ghost",size:"icon",className:"h-7 w-7",children:r.jsx(dr,{className:"w-3 h-3"})}),Q.status==="DRAFT"&&r.jsx(Re,{variant:"outline",size:"sm",className:"h-7 px-2 text-[11px]",onClick:()=>Jt(Q.id),children:"Post GRN"})]})]},Q.id)})})]})})]})}),r.jsx(fs,{value:"returns",children:r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(st,{className:"flex flex-row items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs(lt,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Returns",r.jsx(Ge,{variant:"outline",className:"text-xs",children:W.length})]}),r.jsx("p",{className:"text-xs text-slate-500",children:"Manage returns to suppliers, from customers, and internal adjustments."})]}),r.jsxs(Re,{size:"sm",className:"gap-1",onClick:()=>de(!0),children:[r.jsx(us,{className:"w-3 h-3"}),"New return"]})]}),r.jsx(qe,{children:r.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[r.jsxs("div",{className:"grid grid-cols-[1.1fr,1.2fr,1.2fr,0.9fr,0.9fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[r.jsx("span",{children:"Return no."}),r.jsx("span",{children:"Type / supplier"}),r.jsx("span",{children:"Location / reason"}),r.jsx("span",{children:"Status"}),r.jsx("span",{className:"text-right",children:"Actions"})]}),r.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:G?r.jsxs("div",{className:"p-3 space-y-2",children:[r.jsx(Je,{className:"h-7 w-full"}),r.jsx(Je,{className:"h-7 w-full"}),r.jsx(Je,{className:"h-7 w-full"})]}):W.length===0?r.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No returns recorded yet."}):W.map(Q=>{var Ce,Oe;return r.jsxs("div",{className:"grid grid-cols-[1.1fr,1.2fr,1.2fr,0.9fr,0.9fr] items-center px-3 py-2 text-xs",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-slate-900",children:Q.return_number}),r.jsxs("p",{className:"text-slate-500",children:["Date: ",Ui(Q.return_date)]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-slate-900",children:Q.type.replace("_"," ")}),r.jsx("p",{className:"text-slate-500 text-[11px]",children:((Ce=Q.supplier)==null?void 0:Ce.name)||""})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-slate-900",children:(Oe=Q.location)==null?void 0:Oe.name}),r.jsx("p",{className:"text-slate-500 text-[11px]",children:Q.reason||""})]}),r.jsx("div",{children:r.jsx(Ge,{variant:"outline",className:"text-[10px] capitalize",children:Q.status.toLowerCase()})}),r.jsx("div",{className:"flex items-center justify-end gap-2",children:Q.status==="DRAFT"&&r.jsx(Re,{variant:"outline",size:"sm",className:"h-7 px-2 text-[11px]",onClick:()=>Nw(Q.id),children:"Post return"})})]},Q.id)})})]})})]})}),r.jsx(fs,{value:"txns",children:r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsx(st,{className:"flex flex-row items-center justify-between",children:r.jsxs("div",{children:[r.jsxs(lt,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Stock transactions",r.jsx(Ge,{variant:"outline",className:"text-xs",children:ge.length})]}),r.jsx("p",{className:"text-xs text-slate-500",children:"Full audit trail of every stock movement (GRN, dispense, returns, adjustments)."})]})}),r.jsx(qe,{children:r.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[r.jsxs("div",{className:"grid grid-cols-[1.1fr,1.4fr,1fr,1.1fr,0.9fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[r.jsx("span",{children:"Date / type"}),r.jsx("span",{children:"Item / batch"}),r.jsx("span",{children:"Location"}),r.jsx("span",{children:"Qty / cost"}),r.jsx("span",{children:"User / ref"})]}),r.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:ee?r.jsxs("div",{className:"p-3 space-y-2",children:[r.jsx(Je,{className:"h-7 w-full"}),r.jsx(Je,{className:"h-7 w-full"}),r.jsx(Je,{className:"h-7 w-full"})]}):ge.length===0?r.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No stock transactions yet."}):ge.map(Q=>r.jsxs("div",{className:"grid grid-cols-[1.1fr,1.4fr,1fr,1.1fr,0.9fr] items-center px-3 py-2 text-xs",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-slate-900",children:Ui(Q.txn_time)}),r.jsxs("p",{className:"text-slate-500",children:[Q.txn_type," ",Q.ref_display?` ${Q.ref_display}`:Q.ref_type&&Q.ref_id?` ${Q.ref_type} #${Q.ref_id}`:""]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-slate-900",children:Q.item_name||`Item #${Q.item_id}`}),r.jsxs("p",{className:"text-slate-500 text-[11px]",children:[Q.item_code&&r.jsxs("span",{children:["Code: ",Q.item_code,"  "]}),"Batch:"," ",Q.batch_no?Q.batch_no:Q.batch_id?`#${Q.batch_id}`:""]})]}),r.jsx("div",{className:"text-slate-700",children:Q.location_name||(Q.location_id?`Location #${Q.location_id}`:"")}),r.jsxs("div",{children:[r.jsxs("p",{className:"text-slate-900",children:["Qty: ",Or(Q.quantity_change)]}),r.jsxs("p",{className:"text-slate-500 text-[11px]",children:["Rate: ",Or(Q.unit_cost),"  MRP: ",Or(Q.mrp)]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-slate-900 text-[11px]",children:Q.user_name||(Q.user_id?`User #${Q.user_id}`:"System")}),r.jsx("p",{className:"text-slate-500 text-[11px]",children:Q.ref_display||(Q.ref_type&&Q.ref_id?`${Q.ref_type} #${Q.ref_id}`:"")})]})]},Q.id))})]})})]})})]}),r.jsx(ah,{open:he,onOpenChange:fe,children:r.jsxs(Ed,{className:"max-w-2xl",children:[r.jsxs(Td,{children:[r.jsx(Id,{className:"text-base font-semibold",children:le?"Edit item":"New item"}),r.jsx(Md,{className:"text-xs",children:"Maintain medicine / consumable master details, including LASA flag and stock thresholds."})]}),r.jsxs("form",{onSubmit:Ir,className:"space-y-4",children:[r.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"code",children:"Code"}),r.jsx(Ee,{id:"code",name:"code",defaultValue:(le==null?void 0:le.code)||"",required:!0})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"qr_number",children:"Barcode number (scan code)"}),r.jsx(Ee,{id:"qr_number",name:"qr_number",placeholder:"Leave blank to auto-generate",defaultValue:(le==null?void 0:le.qr_number)||""}),r.jsx("p",{className:"text-[11px] text-slate-400 mt-0.5",children:"Optional. Empty =system will create MD_XXXX."})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"name",children:"Name (brand)"}),r.jsx(Ee,{id:"name",name:"name",defaultValue:(le==null?void 0:le.name)||"",required:!0})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"generic_name",children:"Generic name"}),r.jsx(Ee,{id:"generic_name",name:"generic_name",defaultValue:(le==null?void 0:le.generic_name)||""})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"form",children:"Form"}),r.jsx(Ee,{id:"form",name:"form",placeholder:"tablet / capsule / syrup...",defaultValue:(le==null?void 0:le.form)||""})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"strength",children:"Strength"}),r.jsx(Ee,{id:"strength",name:"strength",placeholder:"500 mg / 5 mg/ml",defaultValue:(le==null?void 0:le.strength)||""})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"unit",children:"Unit"}),r.jsx(Ee,{id:"unit",name:"unit",placeholder:"tablet / ml / vial",defaultValue:(le==null?void 0:le.unit)||"tablet"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"pack_size",children:"Pack size"}),r.jsx(Ee,{id:"pack_size",name:"pack_size",defaultValue:(le==null?void 0:le.pack_size)||"10"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"manufacturer",children:"Manufacturer"}),r.jsx(Ee,{id:"manufacturer",name:"manufacturer",defaultValue:(le==null?void 0:le.manufacturer)||""})]})]}),r.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"default_price",children:"Default price"}),r.jsx(Ee,{id:"default_price",name:"default_price",type:"number",step:"0.01",defaultValue:(le==null?void 0:le.default_price)||""})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"default_mrp",children:"Default MRP"}),r.jsx(Ee,{id:"default_mrp",name:"default_mrp",type:"number",step:"0.01",defaultValue:(le==null?void 0:le.default_mrp)||""})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"default_tax_percent",children:"Tax %"}),r.jsx(Ee,{id:"default_tax_percent",name:"default_tax_percent",type:"number",step:"0.01",defaultValue:(le==null?void 0:le.default_tax_percent)||""})]})]}),r.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"reorder_level",children:"Reorder level"}),r.jsx(Ee,{id:"reorder_level",name:"reorder_level",type:"number",step:"0.01",defaultValue:(le==null?void 0:le.reorder_level)||""})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"max_level",children:"Max level"}),r.jsx(Ee,{id:"max_level",name:"max_level",type:"number",step:"0.01",defaultValue:(le==null?void 0:le.max_level)||""})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"class_name",children:"Therapeutic class"}),r.jsx(Ee,{id:"class_name",name:"class_name",defaultValue:(le==null?void 0:le.class_name)||""})]})]}),r.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"atc_code",children:"ATC code"}),r.jsx(Ee,{id:"atc_code",name:"atc_code",defaultValue:(le==null?void 0:le.atc_code)||""})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"hsn_code",children:"HSN code"}),r.jsx(Ee,{id:"hsn_code",name:"hsn_code",defaultValue:(le==null?void 0:le.hsn_code)||""})]}),r.jsxs("div",{className:"flex items-center gap-4 mt-6 text-xs",children:[r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",name:"is_consumable",defaultChecked:le==null?void 0:le.is_consumable,className:"rounded border-slate-300"}),"Consumable"]}),r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",name:"lasa_flag",defaultChecked:le==null?void 0:le.lasa_flag,className:"rounded border-slate-300"}),"LASA (Look-alike / Sound-alike)"]})]})]}),r.jsxs(Pd,{className:"flex justify-between",children:[r.jsx(Re,{type:"button",variant:"outline",onClick:()=>fe(!1),children:"Cancel"}),r.jsx(Re,{type:"submit",children:le?"Save changes":"Create item"})]})]})]})}),r.jsx(ah,{open:Ke,onOpenChange:wt,children:r.jsxs(Ed,{children:[r.jsxs(Td,{children:[r.jsx(Id,{className:"text-base font-semibold",children:"Bulk upload items (CSV)"}),r.jsx(Md,{className:"text-xs",children:"Download the sample template, fill with medicines / consumables, then upload here. Existing codes will be updated."})]}),r.jsxs("form",{onSubmit:gr,className:"space-y-4",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"file",children:"CSV file"}),r.jsx(Ee,{id:"file",name:"file",type:"file",accept:".csv",required:!0,className:"bg-white"})]}),r.jsxs(Pd,{className:"flex justify-between",children:[r.jsx(Re,{type:"button",variant:"outline",onClick:()=>wt(!1),children:"Cancel"}),r.jsxs(Re,{type:"submit",className:"gap-1",children:[r.jsx(m_,{className:"w-3 h-3"}),"Upload CSV"]})]})]})]})}),r.jsx(ah,{open:Rt,onOpenChange:Zt,children:r.jsxs(Ed,{className:"max-w-md",children:[r.jsxs(Td,{children:[r.jsx(Id,{className:"text-base font-semibold",children:vs?"Edit location":"New location"}),r.jsx(Md,{className:"text-xs",children:"Define pharmacy / store location used for stock and GRN posting."})]}),r.jsxs("form",{onSubmit:Vu,className:"space-y-4",children:[r.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"loc_code",children:"Code"}),r.jsx(Ee,{id:"loc_code",name:"code",defaultValue:(vs==null?void 0:vs.code)||"",placeholder:"PHARM1 / MAIN"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"loc_name",children:"Name"}),r.jsx(Ee,{id:"loc_name",name:"name",required:!0,defaultValue:(vs==null?void 0:vs.name)||"",placeholder:"Main Pharmacy"})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"loc_desc",children:"Description"}),r.jsx(Ee,{id:"loc_desc",name:"description",defaultValue:(vs==null?void 0:vs.description)||"",placeholder:"Optional description"})]}),r.jsxs(Pd,{className:"flex justify-between",children:[r.jsx(Re,{type:"button",variant:"outline",onClick:()=>Zt(!1),children:"Cancel"}),r.jsx(Re,{type:"submit",children:vs?"Save changes":"Create location"})]})]})]})}),r.jsx(ah,{open:Li,onOpenChange:zt,children:r.jsxs(Ed,{className:"max-w-xl",children:[r.jsxs(Td,{children:[r.jsx(Id,{className:"text-base font-semibold",children:Gt?"Edit supplier":"New supplier"}),r.jsx(Md,{className:"text-xs",children:"Vendor details used for purchase orders, GRNs, and returns."})]}),r.jsxs("form",{onSubmit:vw,className:"space-y-4",children:[r.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"sup_code",children:"Code"}),r.jsx(Ee,{id:"sup_code",name:"code",defaultValue:(Gt==null?void 0:Gt.code)||"",placeholder:"SUPP001"})]}),r.jsxs("div",{className:"space-y-1.5 sm:col-span-2",children:[r.jsx(et,{htmlFor:"sup_name",children:"Name"}),r.jsx(Ee,{id:"sup_name",name:"name",required:!0,defaultValue:(Gt==null?void 0:Gt.name)||"",placeholder:"ABC Pharma Distributors"})]})]}),r.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"sup_contact_person",children:"Contact person"}),r.jsx(Ee,{id:"sup_contact_person",name:"contact_person",defaultValue:(Gt==null?void 0:Gt.contact_person)||""})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"sup_phone",children:"Phone"}),r.jsx(Ee,{id:"sup_phone",name:"phone",defaultValue:(Gt==null?void 0:Gt.phone)||""})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"sup_email",children:"Email"}),r.jsx(Ee,{id:"sup_email",type:"email",name:"email",defaultValue:(Gt==null?void 0:Gt.email)||""})]})]}),r.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"sup_gst",children:"GST number"}),r.jsx(Ee,{id:"sup_gst",name:"gst_number",defaultValue:(Gt==null?void 0:Gt.gst_number)||""})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{htmlFor:"sup_address",children:"Address"}),r.jsx(Ee,{id:"sup_address",name:"address",defaultValue:(Gt==null?void 0:Gt.address)||"",placeholder:"City / area / address"})]})]}),r.jsxs(Pd,{className:"flex justify-between",children:[r.jsx(Re,{type:"button",variant:"outline",onClick:()=>zt(!1),children:"Cancel"}),r.jsx(Re,{type:"submit",children:Gt?"Save changes":"Create supplier"})]})]})]})}),r.jsx(Wj,{open:mt,onOpenChange:rt,children:r.jsxs(ey,{className:"w-full sm:max-w-xl overflow-y-auto",children:[r.jsxs(ty,{className:"mb-4",children:[r.jsx(sy,{className:"text-base font-semibold",children:"New Purchase Order"}),r.jsx(ny,{className:"text-xs",children:"Select supplier & location, then add items with quantities and pricing."})]}),r.jsxs("form",{onSubmit:Kf,className:"space-y-4 pb-6",children:[r.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{children:"Supplier"}),r.jsxs(Ms,{value:ne.supplier_id,onValueChange:Q=>me(Ce=>({...Ce,supplier_id:Q})),children:[r.jsx(Es,{className:"bg-white",children:r.jsx(Ds,{placeholder:"Select supplier"})}),r.jsx(Ts,{children:i.map(Q=>r.jsx(Mt,{value:String(Q.id),children:Q.name},Q.id))})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{children:"Location"}),r.jsxs(Ms,{value:ne.location_id,onValueChange:Q=>me(Ce=>({...Ce,location_id:Q})),children:[r.jsx(Es,{className:"bg-white",children:r.jsx(Ds,{placeholder:"Select location"})}),r.jsx(Ts,{children:n.map(Q=>r.jsx(Mt,{value:String(Q.id),children:Q.name},Q.id))})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{children:"Expected date"}),r.jsx(Ee,{type:"date",value:ne.expected_date,onChange:Q=>me(Ce=>({...Ce,expected_date:Q.target.value}))})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{children:"Notes"}),r.jsx(Ee,{placeholder:"Any special instructions",value:ne.notes,onChange:Q=>me(Ce=>({...Ce,notes:Q.target.value}))})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(et,{children:"Line items"}),r.jsxs(Re,{type:"button",size:"sm",variant:"outline",className:"gap-1",onClick:Is,children:[r.jsx(us,{className:"w-3 h-3"}),"Add line"]})]}),bt.length===0?r.jsx("p",{className:"text-xs text-slate-500",children:"No lines yet. Click Add line to start."}):r.jsx("div",{className:"space-y-2 max-h-[260px] overflow-auto pr-1",children:bt.map((Q,Ce)=>r.jsxs("div",{className:"grid gap-2 rounded-xl border border-slate-200 p-2 sm:grid-cols-[1.6fr,0.8fr,0.8fr,0.8fr,0.4fr]",children:[r.jsxs(Ms,{value:Q.item_id?String(Q.item_id):"",onValueChange:Oe=>md(Ce,"item_id",Oe),children:[r.jsx(Es,{className:"bg-white h-8",children:r.jsx(Ds,{placeholder:"Item"})}),r.jsx(Ts,{children:o.map(Oe=>r.jsx(Mt,{value:String(Oe.id),children:Oe.name},Oe.id))})]}),r.jsx(Ee,{type:"number",min:"0",step:"0.01",className:"h-8",placeholder:"Qty",value:Q.ordered_qty,onChange:Oe=>md(Ce,"ordered_qty",Oe.target.value)}),r.jsx(Ee,{type:"number",min:"0",step:"0.01",className:"h-8",placeholder:"Rate",value:Q.unit_cost,onChange:Oe=>md(Ce,"unit_cost",Oe.target.value)}),r.jsx(Ee,{type:"number",min:"0",step:"0.01",className:"h-8",placeholder:"Tax %",value:Q.tax_percent,onChange:Oe=>md(Ce,"tax_percent",Oe.target.value)}),r.jsx(Re,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>pl(Ce),children:""})]},Ce))})]}),r.jsxs("div",{className:"flex justify-between pt-2",children:[r.jsx(Re,{type:"button",variant:"outline",onClick:()=>rt(!1),children:"Cancel"}),r.jsx(Re,{type:"submit",children:"Create PO"})]})]})]})}),r.jsx(ah,{open:Ne.open,onOpenChange:Q=>Be(Ce=>({...Ce,open:Q})),children:r.jsxs(Ed,{children:[r.jsxs(Td,{children:[r.jsx(Id,{className:"text-base font-semibold",children:"Mark PO as sent"}),r.jsx(Md,{className:"text-xs",children:"Enter supplier email used to send PO PDF. This will be stored in PO history."})]}),r.jsxs("form",{onSubmit:Vs,className:"space-y-4",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{children:"Email"}),r.jsx(Ee,{type:"email",value:Ne.email,onChange:Q=>Be(Ce=>({...Ce,email:Q.target.value})),required:!0})]}),r.jsxs(Pd,{className:"flex justify-between",children:[r.jsx(Re,{type:"button",variant:"outline",onClick:()=>Be({open:!1,poId:null,email:""}),children:"Cancel"}),r.jsxs(Re,{type:"submit",className:"gap-1",children:[r.jsx(Zh,{className:"w-3 h-3"}),"Mark as sent"]})]})]})]})}),r.jsx(Wj,{open:jt,onOpenChange:yt,children:r.jsxs(ey,{className:"w-full sm:max-w-xl overflow-y-auto",children:[r.jsxs(ty,{className:"mb-4",children:[r.jsx(sy,{className:"text-base font-semibold",children:"New GRN (DRAFT)"}),r.jsx(ny,{className:"text-xs",children:"Capture invoice details, batch numbers, and quantities. Post later to update stock."})]}),r.jsxs("form",{onSubmit:ns,className:"space-y-4 pb-6",children:[r.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{children:"Supplier"}),r.jsxs(Ms,{value:pt.supplier_id,onValueChange:Q=>Cs(Ce=>({...Ce,supplier_id:Q})),children:[r.jsx(Es,{className:"bg-white",children:r.jsx(Ds,{placeholder:"Select supplier"})}),r.jsx(Ts,{children:i.map(Q=>r.jsx(Mt,{value:String(Q.id),children:Q.name},Q.id))})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{children:"Location"}),r.jsxs(Ms,{value:pt.location_id,onValueChange:Q=>Cs(Ce=>({...Ce,location_id:Q})),children:[r.jsx(Es,{className:"bg-white",children:r.jsx(Ds,{placeholder:"Select location"})}),r.jsx(Ts,{children:n.map(Q=>r.jsx(Mt,{value:String(Q.id),children:Q.name},Q.id))})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{children:"Invoice number"}),r.jsx(Ee,{value:pt.invoice_number,onChange:Q=>Cs(Ce=>({...Ce,invoice_number:Q.target.value}))})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{children:"Invoice date"}),r.jsx(Ee,{type:"date",value:pt.invoice_date,onChange:Q=>Cs(Ce=>({...Ce,invoice_date:Q.target.value}))})]}),r.jsxs("div",{className:"sm:col-span-2 space-y-1.5",children:[r.jsx(et,{children:"Notes"}),r.jsx(Ee,{value:pt.notes,onChange:Q=>Cs(Ce=>({...Ce,notes:Q.target.value}))})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(et,{children:"Line items"}),r.jsxs(Re,{type:"button",size:"sm",variant:"outline",className:"gap-1",onClick:Ko,children:[r.jsx(us,{className:"w-3 h-3"}),"Add line"]})]}),hs.length===0?r.jsx("p",{className:"text-xs text-slate-500",children:"No lines yet. Click Add line to add received batches."}):r.jsx("div",{className:"space-y-2 max-h-[260px] overflow-auto pr-1",children:hs.map((Q,Ce)=>r.jsxs("div",{className:"grid gap-2 rounded-xl border border-slate-200 p-2 sm:grid-cols-[1.6fr,1fr,0.8fr,0.8fr,0.8fr,0.4fr]",children:[r.jsxs(Ms,{value:Q.item_id?String(Q.item_id):"",onValueChange:Oe=>pd(Ce,"item_id",Oe),children:[r.jsx(Es,{className:"bg-white h-8",children:r.jsx(Ds,{placeholder:"Item"})}),r.jsx(Ts,{children:o.map(Oe=>r.jsx(Mt,{value:String(Oe.id),children:Oe.name},Oe.id))})]}),r.jsx(Ee,{className:"h-8",placeholder:"Batch no.",value:Q.batch_no,onChange:Oe=>pd(Ce,"batch_no",Oe.target.value)}),r.jsx(Ee,{type:"date",className:"h-8",value:Q.expiry_date,onChange:Oe=>pd(Ce,"expiry_date",Oe.target.value)}),r.jsx(Ee,{type:"number",min:"0",step:"0.01",className:"h-8",placeholder:"Qty",value:Q.quantity,onChange:Oe=>pd(Ce,"quantity",Oe.target.value)}),r.jsx(Ee,{type:"number",min:"0",step:"0.01",className:"h-8",placeholder:"Rate",value:Q.unit_cost,onChange:Oe=>pd(Ce,"unit_cost",Oe.target.value)}),r.jsx(Re,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>ls(Ce),children:""})]},Ce))})]}),r.jsxs("div",{className:"flex justify-between pt-2",children:[r.jsx(Re,{type:"button",variant:"outline",onClick:()=>yt(!1),children:"Cancel"}),r.jsx(Re,{type:"submit",children:"Create GRN (DRAFT)"})]})]})]})}),r.jsx(Wj,{open:Te,onOpenChange:de,children:r.jsxs(ey,{className:"w-full sm:max-w-xl overflow-y-auto",children:[r.jsxs(ty,{className:"mb-4",children:[r.jsx(sy,{className:"text-base font-semibold",children:"New Return (DRAFT)"}),r.jsx(ny,{className:"text-xs",children:"Choose return type (to supplier / from customer / internal), and specify items & quantities."})]}),r.jsxs("form",{onSubmit:vn,className:"space-y-4 pb-6",children:[r.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{children:"Return type"}),r.jsxs(Ms,{value:Pe.type,onValueChange:Q=>Ue(Ce=>({...Ce,type:Q})),children:[r.jsx(Es,{className:"bg-white",children:r.jsx(Ds,{})}),r.jsxs(Ts,{children:[r.jsx(Mt,{value:"TO_SUPPLIER",children:"To Supplier"}),r.jsx(Mt,{value:"FROM_CUSTOMER",children:"From Customer"}),r.jsx(Mt,{value:"INTERNAL",children:"Internal"})]})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{children:"Location"}),r.jsxs(Ms,{value:Pe.location_id,onValueChange:Q=>Ue(Ce=>({...Ce,location_id:Q})),children:[r.jsx(Es,{className:"bg-white",children:r.jsx(Ds,{placeholder:"Select location"})}),r.jsx(Ts,{children:n.map(Q=>r.jsx(Mt,{value:String(Q.id),children:Q.name},Q.id))})]})]}),Pe.type==="TO_SUPPLIER"&&r.jsxs("div",{className:"space-y-1.5 sm:col-span-2",children:[r.jsx(et,{children:"Supplier (for return)"}),r.jsxs(Ms,{value:Pe.supplier_id,onValueChange:Q=>Ue(Ce=>({...Ce,supplier_id:Q})),children:[r.jsx(Es,{className:"bg-white",children:r.jsx(Ds,{placeholder:"Select supplier"})}),r.jsx(Ts,{children:i.map(Q=>r.jsx(Mt,{value:String(Q.id),children:Q.name},Q.id))})]})]}),r.jsxs("div",{className:"space-y-1.5 sm:col-span-2",children:[r.jsx(et,{children:"Reason"}),r.jsx(Ee,{value:Pe.reason,onChange:Q=>Ue(Ce=>({...Ce,reason:Q.target.value}))})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(et,{children:"Line items"}),r.jsxs(Re,{type:"button",size:"sm",variant:"outline",className:"gap-1",onClick:Yf,children:[r.jsx(us,{className:"w-3 h-3"}),"Add line"]})]}),Le.length===0?r.jsx("p",{className:"text-xs text-slate-500",children:"No lines yet. Click Add line or use Create return from Expired / Quarantine batches."}):r.jsx("div",{className:"space-y-2 max-h-[260px] overflow-auto pr-1",children:Le.map((Q,Ce)=>r.jsxs("div",{className:"grid gap-2 rounded-xl border border-slate-200 p-2 sm:grid-cols-[1.6fr,1fr,0.8fr,0.8fr,0.4fr]",children:[r.jsxs(Ms,{value:Q.item_id?String(Q.item_id):"",onValueChange:Oe=>Yo(Ce,"item_id",Oe),children:[r.jsx(Es,{className:"bg-white h-8",children:r.jsx(Ds,{placeholder:"Item"})}),r.jsx(Ts,{children:o.map(Oe=>r.jsx(Mt,{value:String(Oe.id),children:Oe.name},Oe.id))})]}),r.jsx(Ee,{className:"h-8",placeholder:"Batch no.",value:Q.batch_no||"",onChange:Oe=>Yo(Ce,"batch_no",Oe.target.value)}),r.jsx(Ee,{type:"number",min:"0",step:"0.01",className:"h-8",placeholder:"Qty",value:Q.quantity,onChange:Oe=>Yo(Ce,"quantity",Oe.target.value)}),r.jsx(Ee,{className:"h-8",placeholder:"Reason",value:Q.reason,onChange:Oe=>Yo(Ce,"reason",Oe.target.value)}),r.jsx(Re,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>Xf(Ce),children:""})]},Ce))})]}),r.jsxs("div",{className:"flex justify-between pt-2",children:[r.jsx(Re,{type:"button",variant:"outline",onClick:()=>de(!1),children:"Cancel"}),r.jsx(Re,{type:"submit",children:"Create Return (DRAFT)"})]})]})]})})]})}var dt;(function(t){t[t.QR_CODE=0]="QR_CODE",t[t.AZTEC=1]="AZTEC",t[t.CODABAR=2]="CODABAR",t[t.CODE_39=3]="CODE_39",t[t.CODE_93=4]="CODE_93",t[t.CODE_128=5]="CODE_128",t[t.DATA_MATRIX=6]="DATA_MATRIX",t[t.MAXICODE=7]="MAXICODE",t[t.ITF=8]="ITF",t[t.EAN_13=9]="EAN_13",t[t.EAN_8=10]="EAN_8",t[t.PDF_417=11]="PDF_417",t[t.RSS_14=12]="RSS_14",t[t.RSS_EXPANDED=13]="RSS_EXPANDED",t[t.UPC_A=14]="UPC_A",t[t.UPC_E=15]="UPC_E",t[t.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(dt||(dt={}));var DR=new Map([[dt.QR_CODE,"QR_CODE"],[dt.AZTEC,"AZTEC"],[dt.CODABAR,"CODABAR"],[dt.CODE_39,"CODE_39"],[dt.CODE_93,"CODE_93"],[dt.CODE_128,"CODE_128"],[dt.DATA_MATRIX,"DATA_MATRIX"],[dt.MAXICODE,"MAXICODE"],[dt.ITF,"ITF"],[dt.EAN_13,"EAN_13"],[dt.EAN_8,"EAN_8"],[dt.PDF_417,"PDF_417"],[dt.RSS_14,"RSS_14"],[dt.RSS_EXPANDED,"RSS_EXPANDED"],[dt.UPC_A,"UPC_A"],[dt.UPC_E,"UPC_E"],[dt.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),OR;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.URL=1]="URL"})(OR||(OR={}));function J6e(t){return Object.values(dt).includes(t)}var Qc;(function(t){t[t.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",t[t.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Qc||(Qc={}));var Gi=function(){function t(){}return t.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",t.SCAN_DEFAULT_FPS=2,t.DEFAULT_DISABLE_FLIP=!1,t.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,t.DEFAULT_SUPPORTED_SCAN_TYPE=[Qc.SCAN_TYPE_CAMERA,Qc.SCAN_TYPE_FILE],t}(),hK=function(){function t(s,n){this.format=s,this.formatName=n}return t.prototype.toString=function(){return this.formatName},t.create=function(s){if(!DR.has(s))throw"".concat(s," not in html5QrcodeSupportedFormatsTextMap");return new t(s,DR.get(s))},t}(),RR=function(){function t(){}return t.createFromText=function(s){var n={text:s};return{decodedText:s,result:n}},t.createFromQrcodeResult=function(s){return{decodedText:s.text,result:s}},t}(),xC;(function(t){t[t.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",t[t.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",t[t.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(xC||(xC={}));var fK=function(){function t(){}return t.createFrom=function(s){return{errorMessage:s,type:xC.UNKWOWN_ERROR}},t}(),mK=function(){function t(s){this.verbose=s}return t.prototype.log=function(s){this.verbose&&console.log(s)},t.prototype.warn=function(s){this.verbose&&console.warn(s)},t.prototype.logError=function(s,n){(this.verbose||n===!0)&&console.error(s)},t.prototype.logErrors=function(s){if(s.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(s)},t}();function kl(t){return typeof t>"u"||t===null}function e8e(t,s,n){return t>n?n:t<s?s:t}var kh=function(){function t(){}return t.codeParseError=function(s){return"QR code parse error, error = ".concat(s)},t.errorGettingUserMedia=function(s){return"Error getting userMedia, error = ".concat(s)},t.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},t.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},t.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},t.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},t.scannerPaused=function(){return"Scanner paused"},t}(),ps=function(){function t(){}return t.scanningStatus=function(){return"Scanning"},t.idleStatus=function(){return"Idle"},t.errorStatus=function(){return"Error"},t.permissionStatus=function(){return"Permission"},t.noCameraFoundErrorStatus=function(){return"No Cameras"},t.lastMatch=function(s){return"Last Match: ".concat(s)},t.codeScannerTitle=function(){return"Code Scanner"},t.cameraPermissionTitle=function(){return"Request Camera Permissions"},t.cameraPermissionRequesting=function(){return"Requesting camera permissions..."},t.noCameraFound=function(){return"No camera found"},t.scanButtonStopScanningText=function(){return"Stop Scanning"},t.scanButtonStartScanningText=function(){return"Start Scanning"},t.torchOnButton=function(){return"Switch On Torch"},t.torchOffButton=function(){return"Switch Off Torch"},t.torchOnFailedMessage=function(){return"Failed to turn on torch"},t.torchOffFailedMessage=function(){return"Failed to turn off torch"},t.scanButtonScanningStarting=function(){return"Launching Camera..."},t.textIfCameraScanSelected=function(){return"Scan an Image File"},t.textIfFileScanSelected=function(){return"Scan using camera directly"},t.selectCamera=function(){return"Select Camera"},t.fileSelectionChooseImage=function(){return"Choose Image"},t.fileSelectionChooseAnother=function(){return"Choose Another"},t.fileSelectionNoImageSelected=function(){return"No image choosen"},t.anonymousCameraPrefix=function(){return"Anonymous Camera"},t.dragAndDropMessage=function(){return"Or drop an image to scan"},t.dragAndDropMessageOnlyImages=function(){return"Or drop an image to scan (other files not supported)"},t.zoom=function(){return"zoom"},t.loadingImage=function(){return"Loading image..."},t.cameraScanAltText=function(){return"Camera based scan"},t.fileScanAltText=function(){return"Fule based scan"},t}(),LR=function(){function t(){}return t.poweredBy=function(){return"Powered by "},t.reportIssues=function(){return"Report issues"},t}(),pK=function(){function t(){}return t.isMediaStreamConstraintsValid=function(s,n){if(typeof s!="object"){var a=typeof s;return n.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(a,"."),!0),!1}for(var i=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],l=new Set(i),o=Object.keys(s),c=0,d=o;c<d.length;c++){var u=d[c];if(l.has(u))return n.logError("".concat(u," is not supported videoConstaints."),!0),!1}return!0},t}(),gC={exports:{}};(function(t,s){(function(n,a){a(s)})(am,function(n){function a(K){return K==null}var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(K,h){K.__proto__=h}||function(K,h){for(var p in h)h.hasOwnProperty(p)&&(K[p]=h[p])};function l(K,h){i(K,h);function p(){this.constructor=K}K.prototype=h===null?Object.create(h):(p.prototype=h.prototype,new p)}function o(K,h){var p=Object.setPrototypeOf;p?p(K,h):K.__proto__=h}function c(K,h){h===void 0&&(h=K.constructor);var p=Error.captureStackTrace;p&&p(K,h)}var d=function(K){l(h,K);function h(p){var g=this.constructor,v=K.call(this,p)||this;return Object.defineProperty(v,"name",{value:g.name,enumerable:!1}),o(v,g.prototype),c(v),v}return h}(Error);class u extends d{constructor(h=void 0){super(h),this.message=h}getKind(){return this.constructor.kind}}u.kind="Exception";class f extends u{}f.kind="ArgumentException";class m extends u{}m.kind="IllegalArgumentException";class x{constructor(h){if(this.binarizer=h,h===null)throw new m("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(h,p){return this.binarizer.getBlackRow(h,p)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(h,p,g,v){const N=this.binarizer.getLuminanceSource().crop(h,p,g,v);return new x(this.binarizer.createBinarizer(N))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const h=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new x(this.binarizer.createBinarizer(h))}rotateCounterClockwise45(){const h=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new x(this.binarizer.createBinarizer(h))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class b extends u{static getChecksumInstance(){return new b}}b.kind="ChecksumException";class w{constructor(h){this.source=h}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class j{static arraycopy(h,p,g,v,N){for(;N--;)g[v++]=h[p++]}static currentTimeMillis(){return Date.now()}}class _ extends u{}_.kind="IndexOutOfBoundsException";class C extends _{constructor(h=void 0,p=void 0){super(p),this.index=h,this.message=p}}C.kind="ArrayIndexOutOfBoundsException";class k{static fill(h,p){for(let g=0,v=h.length;g<v;g++)h[g]=p}static fillWithin(h,p,g,v){k.rangeCheck(h.length,p,g);for(let N=p;N<g;N++)h[N]=v}static rangeCheck(h,p,g){if(p>g)throw new m("fromIndex("+p+") > toIndex("+g+")");if(p<0)throw new C(p);if(g>h)throw new C(g)}static asList(...h){return h}static create(h,p,g){return Array.from({length:h}).map(N=>Array.from({length:p}).fill(g))}static createInt32Array(h,p,g){return Array.from({length:h}).map(N=>Int32Array.from({length:p}).fill(g))}static equals(h,p){if(!h||!p||!h.length||!p.length||h.length!==p.length)return!1;for(let g=0,v=h.length;g<v;g++)if(h[g]!==p[g])return!1;return!0}static hashCode(h){if(h===null)return 0;let p=1;for(const g of h)p=31*p+g;return p}static fillUint8Array(h,p){for(let g=0;g!==h.length;g++)h[g]=p}static copyOf(h,p){return h.slice(0,p)}static copyOfUint8Array(h,p){if(h.length<=p){const g=new Uint8Array(p);return g.set(h),g}return h.slice(0,p)}static copyOfRange(h,p,g){const v=g-p,N=new Int32Array(v);return j.arraycopy(h,p,N,0,v),N}static binarySearch(h,p,g){g===void 0&&(g=k.numberComparator);let v=0,N=h.length-1;for(;v<=N;){const S=N+v>>1,E=g(p,h[S]);if(E>0)v=S+1;else if(E<0)N=S-1;else return S}return-v-1}static numberComparator(h,p){return h-p}}class A{static numberOfTrailingZeros(h){let p;if(h===0)return 32;let g=31;return p=h<<16,p!==0&&(g-=16,h=p),p=h<<8,p!==0&&(g-=8,h=p),p=h<<4,p!==0&&(g-=4,h=p),p=h<<2,p!==0&&(g-=2,h=p),g-(h<<1>>>31)}static numberOfLeadingZeros(h){if(h===0)return 32;let p=1;return h>>>16||(p+=16,h<<=16),h>>>24||(p+=8,h<<=8),h>>>28||(p+=4,h<<=4),h>>>30||(p+=2,h<<=2),p-=h>>>31,p}static toHexString(h){return h.toString(16)}static toBinaryString(h){return String(parseInt(String(h),2))}static bitCount(h){return h=h-(h>>>1&1431655765),h=(h&858993459)+(h>>>2&858993459),h=h+(h>>>4)&252645135,h=h+(h>>>8),h=h+(h>>>16),h&63}static truncDivision(h,p){return Math.trunc(h/p)}static parseInt(h,p=void 0){return parseInt(h,p)}}A.MIN_VALUE_32_BITS=-2147483648,A.MAX_VALUE=Number.MAX_SAFE_INTEGER;class T{constructor(h,p){h===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=h,p==null?this.bits=T.makeArray(h):this.bits=p)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(h){if(h>this.bits.length*32){const p=T.makeArray(h);j.arraycopy(this.bits,0,p,0,this.bits.length),this.bits=p}}get(h){return(this.bits[Math.floor(h/32)]&1<<(h&31))!==0}set(h){this.bits[Math.floor(h/32)]|=1<<(h&31)}flip(h){this.bits[Math.floor(h/32)]^=1<<(h&31)}getNextSet(h){const p=this.size;if(h>=p)return p;const g=this.bits;let v=Math.floor(h/32),N=g[v];N&=~((1<<(h&31))-1);const S=g.length;for(;N===0;){if(++v===S)return p;N=g[v]}const E=v*32+A.numberOfTrailingZeros(N);return E>p?p:E}getNextUnset(h){const p=this.size;if(h>=p)return p;const g=this.bits;let v=Math.floor(h/32),N=~g[v];N&=~((1<<(h&31))-1);const S=g.length;for(;N===0;){if(++v===S)return p;N=~g[v]}const E=v*32+A.numberOfTrailingZeros(N);return E>p?p:E}setBulk(h,p){this.bits[Math.floor(h/32)]=p}setRange(h,p){if(p<h||h<0||p>this.size)throw new m;if(p===h)return;p--;const g=Math.floor(h/32),v=Math.floor(p/32),N=this.bits;for(let S=g;S<=v;S++){const E=S>g?0:h&31,$=(2<<(S<v?31:p&31))-(1<<E);N[S]|=$}}clear(){const h=this.bits.length,p=this.bits;for(let g=0;g<h;g++)p[g]=0}isRange(h,p,g){if(p<h||h<0||p>this.size)throw new m;if(p===h)return!0;p--;const v=Math.floor(h/32),N=Math.floor(p/32),S=this.bits;for(let E=v;E<=N;E++){const D=E>v?0:h&31,H=(2<<(E<N?31:p&31))-(1<<D)&4294967295;if((S[E]&H)!==(g?H:0))return!1}return!0}appendBit(h){this.ensureCapacity(this.size+1),h&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(h,p){if(p<0||p>32)throw new m("Num bits must be between 0 and 32");this.ensureCapacity(this.size+p);for(let g=p;g>0;g--)this.appendBit((h>>g-1&1)===1)}appendBitArray(h){const p=h.size;this.ensureCapacity(this.size+p);for(let g=0;g<p;g++)this.appendBit(h.get(g))}xor(h){if(this.size!==h.size)throw new m("Sizes don't match");const p=this.bits;for(let g=0,v=p.length;g<v;g++)p[g]^=h.bits[g]}toBytes(h,p,g,v){for(let N=0;N<v;N++){let S=0;for(let E=0;E<8;E++)this.get(h)&&(S|=1<<7-E),h++;p[g+N]=S}}getBitArray(){return this.bits}reverse(){const h=new Int32Array(this.bits.length),p=Math.floor((this.size-1)/32),g=p+1,v=this.bits;for(let N=0;N<g;N++){let S=v[N];S=S>>1&1431655765|(S&1431655765)<<1,S=S>>2&858993459|(S&858993459)<<2,S=S>>4&252645135|(S&252645135)<<4,S=S>>8&16711935|(S&16711935)<<8,S=S>>16&65535|(S&65535)<<16,h[p-N]=S}if(this.size!==g*32){const N=g*32-this.size;let S=h[0]>>>N;for(let E=1;E<g;E++){const D=h[E];S|=D<<32-N,h[E-1]=S,S=D>>>N}h[g-1]=S}this.bits=h}static makeArray(h){return new Int32Array(Math.floor((h+31)/32))}equals(h){if(!(h instanceof T))return!1;const p=h;return this.size===p.size&&k.equals(this.bits,p.bits)}hashCode(){return 31*this.size+k.hashCode(this.bits)}toString(){let h="";for(let p=0,g=this.size;p<g;p++)p&7||(h+=" "),h+=this.get(p)?"X":".";return h}clone(){return new T(this.size,this.bits.slice())}}var P;(function(K){K[K.OTHER=0]="OTHER",K[K.PURE_BARCODE=1]="PURE_BARCODE",K[K.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",K[K.TRY_HARDER=3]="TRY_HARDER",K[K.CHARACTER_SET=4]="CHARACTER_SET",K[K.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",K[K.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",K[K.ASSUME_GS1=7]="ASSUME_GS1",K[K.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",K[K.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",K[K.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(P||(P={}));var R=P;class I extends u{static getFormatInstance(){return new I}}I.kind="FormatException";var O;(function(K){K[K.Cp437=0]="Cp437",K[K.ISO8859_1=1]="ISO8859_1",K[K.ISO8859_2=2]="ISO8859_2",K[K.ISO8859_3=3]="ISO8859_3",K[K.ISO8859_4=4]="ISO8859_4",K[K.ISO8859_5=5]="ISO8859_5",K[K.ISO8859_6=6]="ISO8859_6",K[K.ISO8859_7=7]="ISO8859_7",K[K.ISO8859_8=8]="ISO8859_8",K[K.ISO8859_9=9]="ISO8859_9",K[K.ISO8859_10=10]="ISO8859_10",K[K.ISO8859_11=11]="ISO8859_11",K[K.ISO8859_13=12]="ISO8859_13",K[K.ISO8859_14=13]="ISO8859_14",K[K.ISO8859_15=14]="ISO8859_15",K[K.ISO8859_16=15]="ISO8859_16",K[K.SJIS=16]="SJIS",K[K.Cp1250=17]="Cp1250",K[K.Cp1251=18]="Cp1251",K[K.Cp1252=19]="Cp1252",K[K.Cp1256=20]="Cp1256",K[K.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",K[K.UTF8=22]="UTF8",K[K.ASCII=23]="ASCII",K[K.Big5=24]="Big5",K[K.GB18030=25]="GB18030",K[K.EUC_KR=26]="EUC_KR"})(O||(O={}));class M{constructor(h,p,g,...v){this.valueIdentifier=h,this.name=g,typeof p=="number"?this.values=Int32Array.from([p]):this.values=p,this.otherEncodingNames=v,M.VALUE_IDENTIFIER_TO_ECI.set(h,this),M.NAME_TO_ECI.set(g,this);const N=this.values;for(let S=0,E=N.length;S!==E;S++){const D=N[S];M.VALUES_TO_ECI.set(D,this)}for(const S of v)M.NAME_TO_ECI.set(S,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(h){if(h<0||h>=900)throw new I("incorect value");const p=M.VALUES_TO_ECI.get(h);if(p===void 0)throw new I("incorect value");return p}static getCharacterSetECIByName(h){const p=M.NAME_TO_ECI.get(h);if(p===void 0)throw new I("incorect value");return p}equals(h){if(!(h instanceof M))return!1;const p=h;return this.getName()===p.getName()}}M.VALUE_IDENTIFIER_TO_ECI=new Map,M.VALUES_TO_ECI=new Map,M.NAME_TO_ECI=new Map,M.Cp437=new M(O.Cp437,Int32Array.from([0,2]),"Cp437"),M.ISO8859_1=new M(O.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),M.ISO8859_2=new M(O.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),M.ISO8859_3=new M(O.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),M.ISO8859_4=new M(O.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),M.ISO8859_5=new M(O.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),M.ISO8859_6=new M(O.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),M.ISO8859_7=new M(O.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),M.ISO8859_8=new M(O.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),M.ISO8859_9=new M(O.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),M.ISO8859_10=new M(O.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),M.ISO8859_11=new M(O.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),M.ISO8859_13=new M(O.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),M.ISO8859_14=new M(O.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),M.ISO8859_15=new M(O.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),M.ISO8859_16=new M(O.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),M.SJIS=new M(O.SJIS,20,"SJIS","Shift_JIS"),M.Cp1250=new M(O.Cp1250,21,"Cp1250","windows-1250"),M.Cp1251=new M(O.Cp1251,22,"Cp1251","windows-1251"),M.Cp1252=new M(O.Cp1252,23,"Cp1252","windows-1252"),M.Cp1256=new M(O.Cp1256,24,"Cp1256","windows-1256"),M.UnicodeBigUnmarked=new M(O.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),M.UTF8=new M(O.UTF8,26,"UTF8","UTF-8"),M.ASCII=new M(O.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),M.Big5=new M(O.Big5,28,"Big5"),M.GB18030=new M(O.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),M.EUC_KR=new M(O.EUC_KR,30,"EUC_KR","EUC-KR");class B extends u{}B.kind="UnsupportedOperationException";class L{static decode(h,p){const g=this.encodingName(p);return this.customDecoder?this.customDecoder(h,g):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(g)?this.decodeFallback(h,g):new TextDecoder(g).decode(h)}static shouldDecodeOnFallback(h){return!L.isBrowser()&&h==="ISO-8859-1"}static encode(h,p){const g=this.encodingName(p);return this.customEncoder?this.customEncoder(h,g):typeof TextEncoder>"u"?this.encodeFallback(h):new TextEncoder().encode(h)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(h){return typeof h=="string"?h:h.getName()}static encodingCharacterSet(h){return h instanceof M?h:M.getCharacterSetECIByName(h)}static decodeFallback(h,p){const g=this.encodingCharacterSet(p);if(L.isDecodeFallbackSupported(g)){let v="";for(let N=0,S=h.length;N<S;N++){let E=h[N].toString(16);E.length<2&&(E="0"+E),v+="%"+E}return decodeURIComponent(v)}if(g.equals(M.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(h.buffer));throw new B(`Encoding ${this.encodingName(p)} not supported by fallback.`)}static isDecodeFallbackSupported(h){return h.equals(M.UTF8)||h.equals(M.ISO8859_1)||h.equals(M.ASCII)}static encodeFallback(h){const g=btoa(unescape(encodeURIComponent(h))).split(""),v=[];for(let N=0;N<g.length;N++)v.push(g[N].charCodeAt(0));return new Uint8Array(v)}}class F{static castAsNonUtf8Char(h,p=null){const g=p?p.getName():this.ISO88591;return L.decode(new Uint8Array([h]),g)}static guessEncoding(h,p){if(p!=null&&p.get(R.CHARACTER_SET)!==void 0)return p.get(R.CHARACTER_SET).toString();const g=h.length;let v=!0,N=!0,S=!0,E=0,D=0,$=0,H=0,Y=0,Z=0,re=0,xe=0,ve=0,Se=0,Me=0;const Xe=h.length>3&&h[0]===239&&h[1]===187&&h[2]===191;for(let Ze=0;Ze<g&&(v||N||S);Ze++){const He=h[Ze]&255;S&&(E>0?He&128?E--:S=!1:He&128&&(He&64?(E++,He&32?(E++,He&16?(E++,He&8?S=!1:H++):$++):D++):S=!1)),v&&(He>127&&He<160?v=!1:He>159&&(He<192||He===215||He===247)&&Me++),N&&(Y>0?He<64||He===127||He>252?N=!1:Y--:He===128||He===160||He>239?N=!1:He>160&&He<224?(Z++,xe=0,re++,re>ve&&(ve=re)):He>127?(Y++,re=0,xe++,xe>Se&&(Se=xe)):(re=0,xe=0))}return S&&E>0&&(S=!1),N&&Y>0&&(N=!1),S&&(Xe||D+$+H>0)?F.UTF8:N&&(F.ASSUME_SHIFT_JIS||ve>=3||Se>=3)?F.SHIFT_JIS:v&&N?ve===2&&Z===2||Me*10>=g?F.SHIFT_JIS:F.ISO88591:v?F.ISO88591:N?F.SHIFT_JIS:S?F.UTF8:F.PLATFORM_DEFAULT_ENCODING}static format(h,...p){let g=-1;function v(S,E,D,$,H,Y){if(S==="%%")return"%";if(p[++g]===void 0)return;S=$?parseInt($.substr(1)):void 0;let Z=H?parseInt(H.substr(1)):void 0,re;switch(Y){case"s":re=p[g];break;case"c":re=p[g][0];break;case"f":re=parseFloat(p[g]).toFixed(S);break;case"p":re=parseFloat(p[g]).toPrecision(S);break;case"e":re=parseFloat(p[g]).toExponential(S);break;case"x":re=parseInt(p[g]).toString(Z||16);break;case"d":re=parseFloat(parseInt(p[g],Z||10).toPrecision(S)).toFixed(0);break}re=typeof re=="object"?JSON.stringify(re):(+re).toString(Z);let xe=parseInt(D),ve=D&&D[0]+""=="0"?"0":" ";for(;re.length<xe;)re=E!==void 0?re+ve:ve+re;return re}let N=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return h.replace(N,v)}static getBytes(h,p){return L.encode(h,p)}static getCharCode(h,p=0){return h.charCodeAt(p)}static getCharAt(h){return String.fromCharCode(h)}}F.SHIFT_JIS=M.SJIS.getName(),F.GB2312="GB2312",F.ISO88591=M.ISO8859_1.getName(),F.EUC_JP="EUC_JP",F.UTF8=M.UTF8.getName(),F.PLATFORM_DEFAULT_ENCODING=F.UTF8,F.ASSUME_SHIFT_JIS=!1;class V{constructor(h=""){this.value=h}enableDecoding(h){return this.encoding=h,this}append(h){return typeof h=="string"?this.value+=h.toString():this.encoding?this.value+=F.castAsNonUtf8Char(h,this.encoding):this.value+=String.fromCharCode(h),this}appendChars(h,p,g){for(let v=p;p<p+g;v++)this.append(h[v]);return this}length(){return this.value.length}charAt(h){return this.value.charAt(h)}deleteCharAt(h){this.value=this.value.substr(0,h)+this.value.substring(h+1)}setCharAt(h,p){this.value=this.value.substr(0,h)+p+this.value.substr(h+1)}substring(h,p){return this.value.substring(h,p)}setLengthToZero(){this.value=""}toString(){return this.value}insert(h,p){this.value=this.value.substr(0,h)+p+this.value.substr(h+p.length)}}class U{constructor(h,p,g,v){if(this.width=h,this.height=p,this.rowSize=g,this.bits=v,p==null&&(p=h),this.height=p,h<1||p<1)throw new m("Both dimensions must be greater than 0");g==null&&(g=Math.floor((h+31)/32)),this.rowSize=g,v==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(h){const p=h.length,g=h[0].length,v=new U(g,p);for(let N=0;N<p;N++){const S=h[N];for(let E=0;E<g;E++)S[E]&&v.set(E,N)}return v}static parseFromString(h,p,g){if(h===null)throw new m("stringRepresentation cannot be null");const v=new Array(h.length);let N=0,S=0,E=-1,D=0,$=0;for(;$<h.length;)if(h.charAt($)===`
`||h.charAt($)==="\r"){if(N>S){if(E===-1)E=N-S;else if(N-S!==E)throw new m("row lengths do not match");S=N,D++}$++}else if(h.substring($,$+p.length)===p)$+=p.length,v[N]=!0,N++;else if(h.substring($,$+g.length)===g)$+=g.length,v[N]=!1,N++;else throw new m("illegal character encountered: "+h.substring($));if(N>S){if(E===-1)E=N-S;else if(N-S!==E)throw new m("row lengths do not match");D++}const H=new U(E,D);for(let Y=0;Y<N;Y++)v[Y]&&H.set(Math.floor(Y%E),Math.floor(Y/E));return H}get(h,p){const g=p*this.rowSize+Math.floor(h/32);return(this.bits[g]>>>(h&31)&1)!==0}set(h,p){const g=p*this.rowSize+Math.floor(h/32);this.bits[g]|=1<<(h&31)&4294967295}unset(h,p){const g=p*this.rowSize+Math.floor(h/32);this.bits[g]&=~(1<<(h&31)&4294967295)}flip(h,p){const g=p*this.rowSize+Math.floor(h/32);this.bits[g]^=1<<(h&31)&4294967295}xor(h){if(this.width!==h.getWidth()||this.height!==h.getHeight()||this.rowSize!==h.getRowSize())throw new m("input matrix dimensions do not match");const p=new T(Math.floor(this.width/32)+1),g=this.rowSize,v=this.bits;for(let N=0,S=this.height;N<S;N++){const E=N*g,D=h.getRow(N,p).getBitArray();for(let $=0;$<g;$++)v[E+$]^=D[$]}}clear(){const h=this.bits,p=h.length;for(let g=0;g<p;g++)h[g]=0}setRegion(h,p,g,v){if(p<0||h<0)throw new m("Left and top must be nonnegative");if(v<1||g<1)throw new m("Height and width must be at least 1");const N=h+g,S=p+v;if(S>this.height||N>this.width)throw new m("The region must fit inside the matrix");const E=this.rowSize,D=this.bits;for(let $=p;$<S;$++){const H=$*E;for(let Y=h;Y<N;Y++)D[H+Math.floor(Y/32)]|=1<<(Y&31)&4294967295}}getRow(h,p){p==null||p.getSize()<this.width?p=new T(this.width):p.clear();const g=this.rowSize,v=this.bits,N=h*g;for(let S=0;S<g;S++)p.setBulk(S*32,v[N+S]);return p}setRow(h,p){j.arraycopy(p.getBitArray(),0,this.bits,h*this.rowSize,this.rowSize)}rotate180(){const h=this.getWidth(),p=this.getHeight();let g=new T(h),v=new T(h);for(let N=0,S=Math.floor((p+1)/2);N<S;N++)g=this.getRow(N,g),v=this.getRow(p-1-N,v),g.reverse(),v.reverse(),this.setRow(N,v),this.setRow(p-1-N,g)}getEnclosingRectangle(){const h=this.width,p=this.height,g=this.rowSize,v=this.bits;let N=h,S=p,E=-1,D=-1;for(let $=0;$<p;$++)for(let H=0;H<g;H++){const Y=v[$*g+H];if(Y!==0){if($<S&&(S=$),$>D&&(D=$),H*32<N){let Z=0;for(;!(Y<<31-Z&4294967295);)Z++;H*32+Z<N&&(N=H*32+Z)}if(H*32+31>E){let Z=31;for(;!(Y>>>Z);)Z--;H*32+Z>E&&(E=H*32+Z)}}}return E<N||D<S?null:Int32Array.from([N,S,E-N+1,D-S+1])}getTopLeftOnBit(){const h=this.rowSize,p=this.bits;let g=0;for(;g<p.length&&p[g]===0;)g++;if(g===p.length)return null;const v=g/h;let N=g%h*32;const S=p[g];let E=0;for(;!(S<<31-E&4294967295);)E++;return N+=E,Int32Array.from([N,v])}getBottomRightOnBit(){const h=this.rowSize,p=this.bits;let g=p.length-1;for(;g>=0&&p[g]===0;)g--;if(g<0)return null;const v=Math.floor(g/h);let N=Math.floor(g%h)*32;const S=p[g];let E=31;for(;!(S>>>E);)E--;return N+=E,Int32Array.from([N,v])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(h){if(!(h instanceof U))return!1;const p=h;return this.width===p.width&&this.height===p.height&&this.rowSize===p.rowSize&&k.equals(this.bits,p.bits)}hashCode(){let h=this.width;return h=31*h+this.width,h=31*h+this.height,h=31*h+this.rowSize,h=31*h+k.hashCode(this.bits),h}toString(h="X ",p="  ",g=`
`){return this.buildToString(h,p,g)}buildToString(h,p,g){let v=new V;for(let N=0,S=this.height;N<S;N++){for(let E=0,D=this.width;E<D;E++)v.append(this.get(E,N)?h:p);v.append(g)}return v.toString()}clone(){return new U(this.width,this.height,this.rowSize,this.bits.slice())}}class z extends u{static getNotFoundInstance(){return new z}}z.kind="NotFoundException";class W extends w{constructor(h){super(h),this.luminances=W.EMPTY,this.buckets=new Int32Array(W.LUMINANCE_BUCKETS)}getBlackRow(h,p){const g=this.getLuminanceSource(),v=g.getWidth();p==null||p.getSize()<v?p=new T(v):p.clear(),this.initArrays(v);const N=g.getRow(h,this.luminances),S=this.buckets;for(let D=0;D<v;D++)S[(N[D]&255)>>W.LUMINANCE_SHIFT]++;const E=W.estimateBlackPoint(S);if(v<3)for(let D=0;D<v;D++)(N[D]&255)<E&&p.set(D);else{let D=N[0]&255,$=N[1]&255;for(let H=1;H<v-1;H++){const Y=N[H+1]&255;($*4-D-Y)/2<E&&p.set(H),D=$,$=Y}}return p}getBlackMatrix(){const h=this.getLuminanceSource(),p=h.getWidth(),g=h.getHeight(),v=new U(p,g);this.initArrays(p);const N=this.buckets;for(let D=1;D<5;D++){const $=Math.floor(g*D/5),H=h.getRow($,this.luminances),Y=Math.floor(p*4/5);for(let Z=Math.floor(p/5);Z<Y;Z++){const re=H[Z]&255;N[re>>W.LUMINANCE_SHIFT]++}}const S=W.estimateBlackPoint(N),E=h.getMatrix();for(let D=0;D<g;D++){const $=D*p;for(let H=0;H<p;H++)(E[$+H]&255)<S&&v.set(H,D)}return v}createBinarizer(h){return new W(h)}initArrays(h){this.luminances.length<h&&(this.luminances=new Uint8ClampedArray(h));const p=this.buckets;for(let g=0;g<W.LUMINANCE_BUCKETS;g++)p[g]=0}static estimateBlackPoint(h){const p=h.length;let g=0,v=0,N=0;for(let H=0;H<p;H++)h[H]>N&&(v=H,N=h[H]),h[H]>g&&(g=h[H]);let S=0,E=0;for(let H=0;H<p;H++){const Y=H-v,Z=h[H]*Y*Y;Z>E&&(S=H,E=Z)}if(v>S){const H=v;v=S,S=H}if(S-v<=p/16)throw new z;let D=S-1,$=-1;for(let H=S-1;H>v;H--){const Y=H-v,Z=Y*Y*(S-H)*(g-h[H]);Z>$&&(D=H,$=Z)}return D<<W.LUMINANCE_SHIFT}}W.LUMINANCE_BITS=5,W.LUMINANCE_SHIFT=8-W.LUMINANCE_BITS,W.LUMINANCE_BUCKETS=1<<W.LUMINANCE_BITS,W.EMPTY=Uint8ClampedArray.from([0]);class q extends W{constructor(h){super(h),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const h=this.getLuminanceSource(),p=h.getWidth(),g=h.getHeight();if(p>=q.MINIMUM_DIMENSION&&g>=q.MINIMUM_DIMENSION){const v=h.getMatrix();let N=p>>q.BLOCK_SIZE_POWER;p&q.BLOCK_SIZE_MASK&&N++;let S=g>>q.BLOCK_SIZE_POWER;g&q.BLOCK_SIZE_MASK&&S++;const E=q.calculateBlackPoints(v,N,S,p,g),D=new U(p,g);q.calculateThresholdForBlock(v,N,S,p,g,E,D),this.matrix=D}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(h){return new q(h)}static calculateThresholdForBlock(h,p,g,v,N,S,E){const D=N-q.BLOCK_SIZE,$=v-q.BLOCK_SIZE;for(let H=0;H<g;H++){let Y=H<<q.BLOCK_SIZE_POWER;Y>D&&(Y=D);const Z=q.cap(H,2,g-3);for(let re=0;re<p;re++){let xe=re<<q.BLOCK_SIZE_POWER;xe>$&&(xe=$);const ve=q.cap(re,2,p-3);let Se=0;for(let Xe=-2;Xe<=2;Xe++){const Ze=S[Z+Xe];Se+=Ze[ve-2]+Ze[ve-1]+Ze[ve]+Ze[ve+1]+Ze[ve+2]}const Me=Se/25;q.thresholdBlock(h,xe,Y,Me,v,E)}}}static cap(h,p,g){return h<p?p:h>g?g:h}static thresholdBlock(h,p,g,v,N,S){for(let E=0,D=g*N+p;E<q.BLOCK_SIZE;E++,D+=N)for(let $=0;$<q.BLOCK_SIZE;$++)(h[D+$]&255)<=v&&S.set(p+$,g+E)}static calculateBlackPoints(h,p,g,v,N){const S=N-q.BLOCK_SIZE,E=v-q.BLOCK_SIZE,D=new Array(g);for(let $=0;$<g;$++){D[$]=new Int32Array(p);let H=$<<q.BLOCK_SIZE_POWER;H>S&&(H=S);for(let Y=0;Y<p;Y++){let Z=Y<<q.BLOCK_SIZE_POWER;Z>E&&(Z=E);let re=0,xe=255,ve=0;for(let Me=0,Xe=H*v+Z;Me<q.BLOCK_SIZE;Me++,Xe+=v){for(let Ze=0;Ze<q.BLOCK_SIZE;Ze++){const He=h[Xe+Ze]&255;re+=He,He<xe&&(xe=He),He>ve&&(ve=He)}if(ve-xe>q.MIN_DYNAMIC_RANGE)for(Me++,Xe+=v;Me<q.BLOCK_SIZE;Me++,Xe+=v)for(let Ze=0;Ze<q.BLOCK_SIZE;Ze++)re+=h[Xe+Ze]&255}let Se=re>>q.BLOCK_SIZE_POWER*2;if(ve-xe<=q.MIN_DYNAMIC_RANGE&&(Se=xe/2,$>0&&Y>0)){const Me=(D[$-1][Y]+2*D[$][Y-1]+D[$-1][Y-1])/4;xe<Me&&(Se=Me)}D[$][Y]=Se}}return D}}q.BLOCK_SIZE_POWER=3,q.BLOCK_SIZE=1<<q.BLOCK_SIZE_POWER,q.BLOCK_SIZE_MASK=q.BLOCK_SIZE-1,q.MINIMUM_DIMENSION=q.BLOCK_SIZE*5,q.MIN_DYNAMIC_RANGE=24;class G{constructor(h,p){this.width=h,this.height=p}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(h,p,g,v){throw new B("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new B("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new B("This luminance source does not support rotation by 45 degrees.")}toString(){const h=new Uint8ClampedArray(this.width);let p=new V;for(let g=0;g<this.height;g++){const v=this.getRow(g,h);for(let N=0;N<this.width;N++){const S=v[N]&255;let E;S<64?E="#":S<128?E="+":S<192?E=".":E=" ",p.append(E)}p.append(`
`)}return p.toString()}}class se extends G{constructor(h){super(h.getWidth(),h.getHeight()),this.delegate=h}getRow(h,p){const g=this.delegate.getRow(h,p),v=this.getWidth();for(let N=0;N<v;N++)g[N]=255-(g[N]&255);return g}getMatrix(){const h=this.delegate.getMatrix(),p=this.getWidth()*this.getHeight(),g=new Uint8ClampedArray(p);for(let v=0;v<p;v++)g[v]=255-(h[v]&255);return g}isCropSupported(){return this.delegate.isCropSupported()}crop(h,p,g,v){return new se(this.delegate.crop(h,p,g,v))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new se(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new se(this.delegate.rotateCounterClockwise45())}}class ge extends G{constructor(h){super(h.width,h.height),this.canvas=h,this.tempCanvasElement=null,this.buffer=ge.makeBufferFromCanvasImageData(h)}static makeBufferFromCanvasImageData(h){const p=h.getContext("2d").getImageData(0,0,h.width,h.height);return ge.toGrayscaleBuffer(p.data,h.width,h.height)}static toGrayscaleBuffer(h,p,g){const v=new Uint8ClampedArray(p*g);for(let N=0,S=0,E=h.length;N<E;N+=4,S++){let D;if(h[N+3]===0)D=255;else{const H=h[N],Y=h[N+1],Z=h[N+2];D=306*H+601*Y+117*Z+512>>10}v[S]=D}return v}getRow(h,p){if(h<0||h>=this.getHeight())throw new m("Requested row is outside the image: "+h);const g=this.getWidth(),v=h*g;return p===null?p=this.buffer.slice(v,v+g):(p.length<g&&(p=new Uint8ClampedArray(g)),p.set(this.buffer.slice(v,v+g))),p}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(h,p,g,v){return super.crop(h,p,g,v),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const h=this.canvas.ownerDocument.createElement("canvas");h.width=this.canvas.width,h.height=this.canvas.height,this.tempCanvasElement=h}return this.tempCanvasElement}rotate(h){const p=this.getTempCanvasElement(),g=p.getContext("2d"),v=h*ge.DEGREE_TO_RADIANS,N=this.canvas.width,S=this.canvas.height,E=Math.ceil(Math.abs(Math.cos(v))*N+Math.abs(Math.sin(v))*S),D=Math.ceil(Math.abs(Math.sin(v))*N+Math.abs(Math.cos(v))*S);return p.width=E,p.height=D,g.translate(E/2,D/2),g.rotate(v),g.drawImage(this.canvas,N/-2,S/-2),this.buffer=ge.makeBufferFromCanvasImageData(p),this}invert(){return new se(this)}}ge.DEGREE_TO_RADIANS=Math.PI/180;class ke{constructor(h,p,g){this.deviceId=h,this.label=p,this.kind="videoinput",this.groupId=g||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var ee=(globalThis||am||self||window||void 0)&&(globalThis||am||self||window||void 0).__awaiter||function(K,h,p,g){function v(N){return N instanceof p?N:new p(function(S){S(N)})}return new(p||(p=Promise))(function(N,S){function E(H){try{$(g.next(H))}catch(Y){S(Y)}}function D(H){try{$(g.throw(H))}catch(Y){S(Y)}}function $(H){H.done?N(H.value):v(H.value).then(E,D)}$((g=g.apply(K,h||[])).next())})};class pe{constructor(h,p=500,g){this.reader=h,this.timeBetweenScansMillis=p,this._hints=g,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(h){this._timeBetweenDecodingAttempts=h<0?0:h}set hints(h){this._hints=h||null}get hints(){return this._hints}listVideoInputDevices(){return ee(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const h=yield navigator.mediaDevices.enumerateDevices(),p=[];for(const g of h){const v=g.kind==="video"?"videoinput":g.kind;if(v!=="videoinput")continue;const N=g.deviceId||g.id,S=g.label||`Video device ${p.length+1}`,E=g.groupId,D={deviceId:N,label:S,kind:v,groupId:E};p.push(D)}return p})}getVideoInputDevices(){return ee(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(p=>new ke(p.deviceId,p.label))})}findDeviceById(h){return ee(this,void 0,void 0,function*(){const p=yield this.listVideoInputDevices();return p?p.find(g=>g.deviceId===h):null})}decodeFromInputVideoDevice(h,p){return ee(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(h,p)})}decodeOnceFromVideoDevice(h,p){return ee(this,void 0,void 0,function*(){this.reset();let g;h?g={deviceId:{exact:h}}:g={facingMode:"environment"};const v={video:g};return yield this.decodeOnceFromConstraints(v,p)})}decodeOnceFromConstraints(h,p){return ee(this,void 0,void 0,function*(){const g=yield navigator.mediaDevices.getUserMedia(h);return yield this.decodeOnceFromStream(g,p)})}decodeOnceFromStream(h,p){return ee(this,void 0,void 0,function*(){this.reset();const g=yield this.attachStreamToVideo(h,p);return yield this.decodeOnce(g)})}decodeFromInputVideoDeviceContinuously(h,p,g){return ee(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(h,p,g)})}decodeFromVideoDevice(h,p,g){return ee(this,void 0,void 0,function*(){let v;h?v={deviceId:{exact:h}}:v={facingMode:"environment"};const N={video:v};return yield this.decodeFromConstraints(N,p,g)})}decodeFromConstraints(h,p,g){return ee(this,void 0,void 0,function*(){const v=yield navigator.mediaDevices.getUserMedia(h);return yield this.decodeFromStream(v,p,g)})}decodeFromStream(h,p,g){return ee(this,void 0,void 0,function*(){this.reset();const v=yield this.attachStreamToVideo(h,p);return yield this.decodeContinuously(v,g)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(h,p){return ee(this,void 0,void 0,function*(){const g=this.prepareVideoElement(p);return this.addVideoSource(g,h),this.videoElement=g,this.stream=h,yield this.playVideoOnLoadAsync(g),g})}playVideoOnLoadAsync(h){return new Promise((p,g)=>this.playVideoOnLoad(h,()=>p()))}playVideoOnLoad(h,p){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(h),h.addEventListener("ended",this.videoEndedListener),h.addEventListener("canplay",this.videoCanPlayListener),h.addEventListener("playing",p),this.tryPlayVideo(h)}isVideoPlaying(h){return h.currentTime>0&&!h.paused&&!h.ended&&h.readyState>2}tryPlayVideo(h){return ee(this,void 0,void 0,function*(){if(this.isVideoPlaying(h)){console.warn("Trying to play video that is already playing.");return}try{yield h.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(h,p){const g=document.getElementById(h);if(!g)throw new f(`element with id '${h}' not found`);if(g.nodeName.toLowerCase()!==p.toLowerCase())throw new f(`element with id '${h}' must be an ${p} element`);return g}decodeFromImage(h,p){if(!h&&!p)throw new f("either imageElement with a src set or an url must be provided");return p&&!h?this.decodeFromImageUrl(p):this.decodeFromImageElement(h)}decodeFromVideo(h,p){if(!h&&!p)throw new f("Either an element with a src set or an URL must be provided");return p&&!h?this.decodeFromVideoUrl(p):this.decodeFromVideoElement(h)}decodeFromVideoContinuously(h,p,g){if(h===void 0&&p===void 0)throw new f("Either an element with a src set or an URL must be provided");return p&&!h?this.decodeFromVideoUrlContinuously(p,g):this.decodeFromVideoElementContinuously(h,g)}decodeFromImageElement(h){if(!h)throw new f("An image element must be provided.");this.reset();const p=this.prepareImageElement(h);this.imageElement=p;let g;return this.isImageLoaded(p)?g=this.decodeOnce(p,!1,!0):g=this._decodeOnLoadImage(p),g}decodeFromVideoElement(h){const p=this._decodeFromVideoElementSetup(h);return this._decodeOnLoadVideo(p)}decodeFromVideoElementContinuously(h,p){const g=this._decodeFromVideoElementSetup(h);return this._decodeOnLoadVideoContinuously(g,p)}_decodeFromVideoElementSetup(h){if(!h)throw new f("A video element must be provided.");this.reset();const p=this.prepareVideoElement(h);return this.videoElement=p,p}decodeFromImageUrl(h){if(!h)throw new f("An URL must be provided.");this.reset();const p=this.prepareImageElement();this.imageElement=p;const g=this._decodeOnLoadImage(p);return p.src=h,g}decodeFromVideoUrl(h){if(!h)throw new f("An URL must be provided.");this.reset();const p=this.prepareVideoElement(),g=this.decodeFromVideoElement(p);return p.src=h,g}decodeFromVideoUrlContinuously(h,p){if(!h)throw new f("An URL must be provided.");this.reset();const g=this.prepareVideoElement(),v=this.decodeFromVideoElementContinuously(g,p);return g.src=h,v}_decodeOnLoadImage(h){return new Promise((p,g)=>{this.imageLoadedListener=()=>this.decodeOnce(h,!1,!0).then(p,g),h.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(h){return ee(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(h),yield this.decodeOnce(h)})}_decodeOnLoadVideoContinuously(h,p){return ee(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(h),this.decodeContinuously(h,p)})}isImageLoaded(h){return!(!h.complete||h.naturalWidth===0)}prepareImageElement(h){let p;return typeof h>"u"&&(p=document.createElement("img"),p.width=200,p.height=200),typeof h=="string"&&(p=this.getMediaElement(h,"img")),h instanceof HTMLImageElement&&(p=h),p}prepareVideoElement(h){let p;return!h&&typeof document<"u"&&(p=document.createElement("video"),p.width=200,p.height=200),typeof h=="string"&&(p=this.getMediaElement(h,"video")),h instanceof HTMLVideoElement&&(p=h),p.setAttribute("autoplay","true"),p.setAttribute("muted","true"),p.setAttribute("playsinline","true"),p}decodeOnce(h,p=!0,g=!0){this._stopAsyncDecode=!1;const v=(N,S)=>{if(this._stopAsyncDecode){S(new z("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const E=this.decode(h);N(E)}catch(E){const D=p&&E instanceof z,H=(E instanceof b||E instanceof I)&&g;if(D||H)return setTimeout(v,this._timeBetweenDecodingAttempts,N,S);S(E)}};return new Promise((N,S)=>v(N,S))}decodeContinuously(h,p){this._stopContinuousDecode=!1;const g=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const v=this.decode(h);p(v,null),setTimeout(g,this.timeBetweenScansMillis)}catch(v){p(null,v);const N=v instanceof b||v instanceof I,S=v instanceof z;(N||S)&&setTimeout(g,this._timeBetweenDecodingAttempts)}};g()}decode(h){const p=this.createBinaryBitmap(h);return this.decodeBitmap(p)}_isHTMLVideoElement(h){return h.videoWidth!==0}drawFrameOnCanvas(h,p,g){p||(p={sx:0,sy:0,sWidth:h.videoWidth,sHeight:h.videoHeight,dx:0,dy:0,dWidth:h.videoWidth,dHeight:h.videoHeight}),g||(g=this.captureCanvasContext),g.drawImage(h,p.sx,p.sy,p.sWidth,p.sHeight,p.dx,p.dy,p.dWidth,p.dHeight)}drawImageOnCanvas(h,p,g=this.captureCanvasContext){p||(p={sx:0,sy:0,sWidth:h.naturalWidth,sHeight:h.naturalHeight,dx:0,dy:0,dWidth:h.naturalWidth,dHeight:h.naturalHeight}),g||(g=this.captureCanvasContext),g.drawImage(h,p.sx,p.sy,p.sWidth,p.sHeight,p.dx,p.dy,p.dWidth,p.dHeight)}createBinaryBitmap(h){this.getCaptureCanvasContext(h),this._isHTMLVideoElement(h)?this.drawFrameOnCanvas(h):this.drawImageOnCanvas(h);const p=this.getCaptureCanvas(h),g=new ge(p),v=new q(g);return new x(v)}getCaptureCanvasContext(h){if(!this.captureCanvasContext){const g=this.getCaptureCanvas(h).getContext("2d");this.captureCanvasContext=g}return this.captureCanvasContext}getCaptureCanvas(h){if(!this.captureCanvas){const p=this.createCaptureCanvas(h);this.captureCanvas=p}return this.captureCanvas}decodeBitmap(h){return this.reader.decode(h,this._hints)}createCaptureCanvas(h){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const p=document.createElement("canvas");let g,v;return typeof h<"u"&&(h instanceof HTMLVideoElement?(g=h.videoWidth,v=h.videoHeight):h instanceof HTMLImageElement&&(g=h.naturalWidth||h.width,v=h.naturalHeight||h.height)),p.style.width=g+"px",p.style.height=v+"px",p.width=g,p.height=v,p}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(h=>h.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(h,p){try{h.srcObject=p}catch{h.src=URL.createObjectURL(p)}}cleanVideoSource(h){try{h.srcObject=null}catch{h.src=""}this.videoElement.removeAttribute("src")}}class ue{constructor(h,p,g=p==null?0:8*p.length,v,N,S=j.currentTimeMillis()){this.text=h,this.rawBytes=p,this.numBits=g,this.resultPoints=v,this.format=N,this.timestamp=S,this.text=h,this.rawBytes=p,g==null?this.numBits=p==null?0:8*p.length:this.numBits=g,this.resultPoints=v,this.format=N,this.resultMetadata=null,S==null?this.timestamp=j.currentTimeMillis():this.timestamp=S}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(h,p){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(h,p)}putAllMetadata(h){h!==null&&(this.resultMetadata===null?this.resultMetadata=h:this.resultMetadata=new Map(h))}addResultPoints(h){const p=this.resultPoints;if(p===null)this.resultPoints=h;else if(h!==null&&h.length>0){const g=new Array(p.length+h.length);j.arraycopy(p,0,g,0,p.length),j.arraycopy(h,0,g,p.length,h.length),this.resultPoints=g}}getTimestamp(){return this.timestamp}toString(){return this.text}}var ye;(function(K){K[K.AZTEC=0]="AZTEC",K[K.CODABAR=1]="CODABAR",K[K.CODE_39=2]="CODE_39",K[K.CODE_93=3]="CODE_93",K[K.CODE_128=4]="CODE_128",K[K.DATA_MATRIX=5]="DATA_MATRIX",K[K.EAN_8=6]="EAN_8",K[K.EAN_13=7]="EAN_13",K[K.ITF=8]="ITF",K[K.MAXICODE=9]="MAXICODE",K[K.PDF_417=10]="PDF_417",K[K.QR_CODE=11]="QR_CODE",K[K.RSS_14=12]="RSS_14",K[K.RSS_EXPANDED=13]="RSS_EXPANDED",K[K.UPC_A=14]="UPC_A",K[K.UPC_E=15]="UPC_E",K[K.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(ye||(ye={}));var X=ye,oe;(function(K){K[K.OTHER=0]="OTHER",K[K.ORIENTATION=1]="ORIENTATION",K[K.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",K[K.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",K[K.ISSUE_NUMBER=4]="ISSUE_NUMBER",K[K.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",K[K.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",K[K.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",K[K.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",K[K.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",K[K.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(oe||(oe={}));var _e=oe;class ce{constructor(h,p,g,v,N=-1,S=-1){this.rawBytes=h,this.text=p,this.byteSegments=g,this.ecLevel=v,this.structuredAppendSequenceNumber=N,this.structuredAppendParity=S,this.numBits=h==null?0:8*h.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(h){this.numBits=h}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(h){this.errorsCorrected=h}getErasures(){return this.erasures}setErasures(h){this.erasures=h}getOther(){return this.other}setOther(h){this.other=h}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class he{exp(h){return this.expTable[h]}log(h){if(h===0)throw new m;return this.logTable[h]}static addOrSubtract(h,p){return h^p}}class fe{constructor(h,p){if(p.length===0)throw new m;this.field=h;const g=p.length;if(g>1&&p[0]===0){let v=1;for(;v<g&&p[v]===0;)v++;v===g?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(g-v),j.arraycopy(p,v,this.coefficients,0,this.coefficients.length))}else this.coefficients=p}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(h){return this.coefficients[this.coefficients.length-1-h]}evaluateAt(h){if(h===0)return this.getCoefficient(0);const p=this.coefficients;let g;if(h===1){g=0;for(let S=0,E=p.length;S!==E;S++){const D=p[S];g=he.addOrSubtract(g,D)}return g}g=p[0];const v=p.length,N=this.field;for(let S=1;S<v;S++)g=he.addOrSubtract(N.multiply(h,g),p[S]);return g}addOrSubtract(h){if(!this.field.equals(h.field))throw new m("GenericGFPolys do not have same GenericGF field");if(this.isZero())return h;if(h.isZero())return this;let p=this.coefficients,g=h.coefficients;if(p.length>g.length){const S=p;p=g,g=S}let v=new Int32Array(g.length);const N=g.length-p.length;j.arraycopy(g,0,v,0,N);for(let S=N;S<g.length;S++)v[S]=he.addOrSubtract(p[S-N],g[S]);return new fe(this.field,v)}multiply(h){if(!this.field.equals(h.field))throw new m("GenericGFPolys do not have same GenericGF field");if(this.isZero()||h.isZero())return this.field.getZero();const p=this.coefficients,g=p.length,v=h.coefficients,N=v.length,S=new Int32Array(g+N-1),E=this.field;for(let D=0;D<g;D++){const $=p[D];for(let H=0;H<N;H++)S[D+H]=he.addOrSubtract(S[D+H],E.multiply($,v[H]))}return new fe(E,S)}multiplyScalar(h){if(h===0)return this.field.getZero();if(h===1)return this;const p=this.coefficients.length,g=this.field,v=new Int32Array(p),N=this.coefficients;for(let S=0;S<p;S++)v[S]=g.multiply(N[S],h);return new fe(g,v)}multiplyByMonomial(h,p){if(h<0)throw new m;if(p===0)return this.field.getZero();const g=this.coefficients,v=g.length,N=new Int32Array(v+h),S=this.field;for(let E=0;E<v;E++)N[E]=S.multiply(g[E],p);return new fe(S,N)}divide(h){if(!this.field.equals(h.field))throw new m("GenericGFPolys do not have same GenericGF field");if(h.isZero())throw new m("Divide by 0");const p=this.field;let g=p.getZero(),v=this;const N=h.getCoefficient(h.getDegree()),S=p.inverse(N);for(;v.getDegree()>=h.getDegree()&&!v.isZero();){const E=v.getDegree()-h.getDegree(),D=p.multiply(v.getCoefficient(v.getDegree()),S),$=h.multiplyByMonomial(E,D),H=p.buildMonomial(E,D);g=g.addOrSubtract(H),v=v.addOrSubtract($)}return[g,v]}toString(){let h="";for(let p=this.getDegree();p>=0;p--){let g=this.getCoefficient(p);if(g!==0){if(g<0?(h+=" - ",g=-g):h.length>0&&(h+=" + "),p===0||g!==1){const v=this.field.log(g);v===0?h+="1":v===1?h+="a":(h+="a^",h+=v)}p!==0&&(p===1?h+="x":(h+="x^",h+=p))}}return h}}class le extends u{}le.kind="ArithmeticException";class Ve extends he{constructor(h,p,g){super(),this.primitive=h,this.size=p,this.generatorBase=g;const v=new Int32Array(p);let N=1;for(let E=0;E<p;E++)v[E]=N,N*=2,N>=p&&(N^=h,N&=p-1);this.expTable=v;const S=new Int32Array(p);for(let E=0;E<p-1;E++)S[v[E]]=E;this.logTable=S,this.zero=new fe(this,Int32Array.from([0])),this.one=new fe(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(h,p){if(h<0)throw new m;if(p===0)return this.zero;const g=new Int32Array(h+1);return g[0]=p,new fe(this,g)}inverse(h){if(h===0)throw new le;return this.expTable[this.size-this.logTable[h]-1]}multiply(h,p){return h===0||p===0?0:this.expTable[(this.logTable[h]+this.logTable[p])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+A.toHexString(this.primitive)+","+this.size+")"}equals(h){return h===this}}Ve.AZTEC_DATA_12=new Ve(4201,4096,1),Ve.AZTEC_DATA_10=new Ve(1033,1024,1),Ve.AZTEC_DATA_6=new Ve(67,64,1),Ve.AZTEC_PARAM=new Ve(19,16,1),Ve.QR_CODE_FIELD_256=new Ve(285,256,0),Ve.DATA_MATRIX_FIELD_256=new Ve(301,256,1),Ve.AZTEC_DATA_8=Ve.DATA_MATRIX_FIELD_256,Ve.MAXICODE_FIELD_64=Ve.AZTEC_DATA_6;class Ke extends u{}Ke.kind="ReedSolomonException";class wt extends u{}wt.kind="IllegalStateException";class mt{constructor(h){this.field=h}decode(h,p){const g=this.field,v=new fe(g,h),N=new Int32Array(p);let S=!0;for(let re=0;re<p;re++){const xe=v.evaluateAt(g.exp(re+g.getGeneratorBase()));N[N.length-1-re]=xe,xe!==0&&(S=!1)}if(S)return;const E=new fe(g,N),D=this.runEuclideanAlgorithm(g.buildMonomial(p,1),E,p),$=D[0],H=D[1],Y=this.findErrorLocations($),Z=this.findErrorMagnitudes(H,Y);for(let re=0;re<Y.length;re++){const xe=h.length-1-g.log(Y[re]);if(xe<0)throw new Ke("Bad error location");h[xe]=Ve.addOrSubtract(h[xe],Z[re])}}runEuclideanAlgorithm(h,p,g){if(h.getDegree()<p.getDegree()){const re=h;h=p,p=re}const v=this.field;let N=h,S=p,E=v.getZero(),D=v.getOne();for(;S.getDegree()>=(g/2|0);){let re=N,xe=E;if(N=S,E=D,N.isZero())throw new Ke("r_{i-1} was zero");S=re;let ve=v.getZero();const Se=N.getCoefficient(N.getDegree()),Me=v.inverse(Se);for(;S.getDegree()>=N.getDegree()&&!S.isZero();){const Xe=S.getDegree()-N.getDegree(),Ze=v.multiply(S.getCoefficient(S.getDegree()),Me);ve=ve.addOrSubtract(v.buildMonomial(Xe,Ze)),S=S.addOrSubtract(N.multiplyByMonomial(Xe,Ze))}if(D=ve.multiply(E).addOrSubtract(xe),S.getDegree()>=N.getDegree())throw new wt("Division algorithm failed to reduce polynomial?")}const $=D.getCoefficient(0);if($===0)throw new Ke("sigmaTilde(0) was zero");const H=v.inverse($),Y=D.multiplyScalar(H),Z=S.multiplyScalar(H);return[Y,Z]}findErrorLocations(h){const p=h.getDegree();if(p===1)return Int32Array.from([h.getCoefficient(1)]);const g=new Int32Array(p);let v=0;const N=this.field;for(let S=1;S<N.getSize()&&v<p;S++)h.evaluateAt(S)===0&&(g[v]=N.inverse(S),v++);if(v!==p)throw new Ke("Error locator degree does not match number of roots");return g}findErrorMagnitudes(h,p){const g=p.length,v=new Int32Array(g),N=this.field;for(let S=0;S<g;S++){const E=N.inverse(p[S]);let D=1;for(let $=0;$<g;$++)if(S!==$){const H=N.multiply(p[$],E),Y=H&1?H&-2:H|1;D=N.multiply(D,Y)}v[S]=N.multiply(h.evaluateAt(E),N.inverse(D)),N.getGeneratorBase()!==0&&(v[S]=N.multiply(v[S],E))}return v}}var rt;(function(K){K[K.UPPER=0]="UPPER",K[K.LOWER=1]="LOWER",K[K.MIXED=2]="MIXED",K[K.DIGIT=3]="DIGIT",K[K.PUNCT=4]="PUNCT",K[K.BINARY=5]="BINARY"})(rt||(rt={}));class bt{decode(h){this.ddata=h;let p=h.getBits(),g=this.extractBits(p),v=this.correctBits(g),N=bt.convertBoolArrayToByteArray(v),S=bt.getEncodedData(v),E=new ce(N,S,null,null);return E.setNumBits(v.length),E}static highLevelDecode(h){return this.getEncodedData(h)}static getEncodedData(h){let p=h.length,g=rt.UPPER,v=rt.UPPER,N="",S=0;for(;S<p;)if(v===rt.BINARY){if(p-S<5)break;let E=bt.readCode(h,S,5);if(S+=5,E===0){if(p-S<11)break;E=bt.readCode(h,S,11)+31,S+=11}for(let D=0;D<E;D++){if(p-S<8){S=p;break}const $=bt.readCode(h,S,8);N+=F.castAsNonUtf8Char($),S+=8}v=g}else{let E=v===rt.DIGIT?4:5;if(p-S<E)break;let D=bt.readCode(h,S,E);S+=E;let $=bt.getCharacter(v,D);$.startsWith("CTRL_")?(g=v,v=bt.getTable($.charAt(5)),$.charAt(6)==="L"&&(g=v)):(N+=$,v=g)}return N}static getTable(h){switch(h){case"L":return rt.LOWER;case"P":return rt.PUNCT;case"M":return rt.MIXED;case"D":return rt.DIGIT;case"B":return rt.BINARY;case"U":default:return rt.UPPER}}static getCharacter(h,p){switch(h){case rt.UPPER:return bt.UPPER_TABLE[p];case rt.LOWER:return bt.LOWER_TABLE[p];case rt.MIXED:return bt.MIXED_TABLE[p];case rt.PUNCT:return bt.PUNCT_TABLE[p];case rt.DIGIT:return bt.DIGIT_TABLE[p];default:throw new wt("Bad table")}}correctBits(h){let p,g;this.ddata.getNbLayers()<=2?(g=6,p=Ve.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(g=8,p=Ve.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(g=10,p=Ve.AZTEC_DATA_10):(g=12,p=Ve.AZTEC_DATA_12);let v=this.ddata.getNbDatablocks(),N=h.length/g;if(N<v)throw new I;let S=h.length%g,E=new Int32Array(N);for(let Z=0;Z<N;Z++,S+=g)E[Z]=bt.readCode(h,S,g);try{new mt(p).decode(E,N-v)}catch(Z){throw new I(Z)}let D=(1<<g)-1,$=0;for(let Z=0;Z<v;Z++){let re=E[Z];if(re===0||re===D)throw new I;(re===1||re===D-1)&&$++}let H=new Array(v*g-$),Y=0;for(let Z=0;Z<v;Z++){let re=E[Z];if(re===1||re===D-1)H.fill(re>1,Y,Y+g-1),Y+=g-1;else for(let xe=g-1;xe>=0;--xe)H[Y++]=(re&1<<xe)!==0}return H}extractBits(h){let p=this.ddata.isCompact(),g=this.ddata.getNbLayers(),v=(p?11:14)+g*4,N=new Int32Array(v),S=new Array(this.totalBitsInLayer(g,p));if(p)for(let E=0;E<N.length;E++)N[E]=E;else{let E=v+1+2*A.truncDivision(A.truncDivision(v,2)-1,15),D=v/2,$=A.truncDivision(E,2);for(let H=0;H<D;H++){let Y=H+A.truncDivision(H,15);N[D-H-1]=$-Y-1,N[D+H]=$+Y+1}}for(let E=0,D=0;E<g;E++){let $=(g-E)*4+(p?9:12),H=E*2,Y=v-1-H;for(let Z=0;Z<$;Z++){let re=Z*2;for(let xe=0;xe<2;xe++)S[D+re+xe]=h.get(N[H+xe],N[H+Z]),S[D+2*$+re+xe]=h.get(N[H+Z],N[Y-xe]),S[D+4*$+re+xe]=h.get(N[Y-xe],N[Y-Z]),S[D+6*$+re+xe]=h.get(N[Y-Z],N[H+xe])}D+=$*8}return S}static readCode(h,p,g){let v=0;for(let N=p;N<p+g;N++)v<<=1,h[N]&&(v|=1);return v}static readByte(h,p){let g=h.length-p;return g>=8?bt.readCode(h,p,8):bt.readCode(h,p,g)<<8-g}static convertBoolArrayToByteArray(h){let p=new Uint8Array((h.length+7)/8);for(let g=0;g<p.length;g++)p[g]=bt.readByte(h,8*g);return p}totalBitsInLayer(h,p){return((p?88:112)+16*h)*h}}bt.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],bt.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],bt.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],bt.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],bt.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class be{constructor(){}static round(h){return h===NaN?0:h<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:h>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:h+(h<0?-.5:.5)|0}static distance(h,p,g,v){const N=h-g,S=p-v;return Math.sqrt(N*N+S*S)}static sum(h){let p=0;for(let g=0,v=h.length;g!==v;g++){const N=h[g];p+=N}return p}}class ne{static floatToIntBits(h){return h}}ne.MAX_VALUE=Number.MAX_SAFE_INTEGER;class me{constructor(h,p){this.x=h,this.y=p}getX(){return this.x}getY(){return this.y}equals(h){if(h instanceof me){const p=h;return this.x===p.x&&this.y===p.y}return!1}hashCode(){return 31*ne.floatToIntBits(this.x)+ne.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(h){const p=this.distance(h[0],h[1]),g=this.distance(h[1],h[2]),v=this.distance(h[0],h[2]);let N,S,E;if(g>=p&&g>=v?(S=h[0],N=h[1],E=h[2]):v>=g&&v>=p?(S=h[1],N=h[0],E=h[2]):(S=h[2],N=h[0],E=h[1]),this.crossProductZ(N,S,E)<0){const D=N;N=E,E=D}h[0]=N,h[1]=S,h[2]=E}static distance(h,p){return be.distance(h.x,h.y,p.x,p.y)}static crossProductZ(h,p,g){const v=p.x,N=p.y;return(g.x-v)*(h.y-N)-(g.y-N)*(h.x-v)}}class Ne{constructor(h,p){this.bits=h,this.points=p}getBits(){return this.bits}getPoints(){return this.points}}class Be extends Ne{constructor(h,p,g,v,N){super(h,p),this.compact=g,this.nbDatablocks=v,this.nbLayers=N}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class jt{constructor(h,p,g,v){this.image=h,this.height=h.getHeight(),this.width=h.getWidth(),p==null&&(p=jt.INIT_SIZE),g==null&&(g=h.getWidth()/2|0),v==null&&(v=h.getHeight()/2|0);const N=p/2|0;if(this.leftInit=g-N,this.rightInit=g+N,this.upInit=v-N,this.downInit=v+N,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new z}detect(){let h=this.leftInit,p=this.rightInit,g=this.upInit,v=this.downInit,N=!1,S=!0,E=!1,D=!1,$=!1,H=!1,Y=!1;const Z=this.width,re=this.height;for(;S;){S=!1;let xe=!0;for(;(xe||!D)&&p<Z;)xe=this.containsBlackPoint(g,v,p,!1),xe?(p++,S=!0,D=!0):D||p++;if(p>=Z){N=!0;break}let ve=!0;for(;(ve||!$)&&v<re;)ve=this.containsBlackPoint(h,p,v,!0),ve?(v++,S=!0,$=!0):$||v++;if(v>=re){N=!0;break}let Se=!0;for(;(Se||!H)&&h>=0;)Se=this.containsBlackPoint(g,v,h,!1),Se?(h--,S=!0,H=!0):H||h--;if(h<0){N=!0;break}let Me=!0;for(;(Me||!Y)&&g>=0;)Me=this.containsBlackPoint(h,p,g,!0),Me?(g--,S=!0,Y=!0):Y||g--;if(g<0){N=!0;break}S&&(E=!0)}if(!N&&E){const xe=p-h;let ve=null;for(let Ze=1;ve===null&&Ze<xe;Ze++)ve=this.getBlackPointOnSegment(h,v-Ze,h+Ze,v);if(ve==null)throw new z;let Se=null;for(let Ze=1;Se===null&&Ze<xe;Ze++)Se=this.getBlackPointOnSegment(h,g+Ze,h+Ze,g);if(Se==null)throw new z;let Me=null;for(let Ze=1;Me===null&&Ze<xe;Ze++)Me=this.getBlackPointOnSegment(p,g+Ze,p-Ze,g);if(Me==null)throw new z;let Xe=null;for(let Ze=1;Xe===null&&Ze<xe;Ze++)Xe=this.getBlackPointOnSegment(p,v-Ze,p-Ze,v);if(Xe==null)throw new z;return this.centerEdges(Xe,ve,Me,Se)}else throw new z}getBlackPointOnSegment(h,p,g,v){const N=be.round(be.distance(h,p,g,v)),S=(g-h)/N,E=(v-p)/N,D=this.image;for(let $=0;$<N;$++){const H=be.round(h+$*S),Y=be.round(p+$*E);if(D.get(H,Y))return new me(H,Y)}return null}centerEdges(h,p,g,v){const N=h.getX(),S=h.getY(),E=p.getX(),D=p.getY(),$=g.getX(),H=g.getY(),Y=v.getX(),Z=v.getY(),re=jt.CORR;return N<this.width/2?[new me(Y-re,Z+re),new me(E+re,D+re),new me($-re,H-re),new me(N+re,S-re)]:[new me(Y+re,Z+re),new me(E+re,D-re),new me($-re,H+re),new me(N-re,S-re)]}containsBlackPoint(h,p,g,v){const N=this.image;if(v){for(let S=h;S<=p;S++)if(N.get(S,g))return!0}else for(let S=h;S<=p;S++)if(N.get(g,S))return!0;return!1}}jt.INIT_SIZE=10,jt.CORR=1;class yt{static checkAndNudgePoints(h,p){const g=h.getWidth(),v=h.getHeight();let N=!0;for(let S=0;S<p.length&&N;S+=2){const E=Math.floor(p[S]),D=Math.floor(p[S+1]);if(E<-1||E>g||D<-1||D>v)throw new z;N=!1,E===-1?(p[S]=0,N=!0):E===g&&(p[S]=g-1,N=!0),D===-1?(p[S+1]=0,N=!0):D===v&&(p[S+1]=v-1,N=!0)}N=!0;for(let S=p.length-2;S>=0&&N;S-=2){const E=Math.floor(p[S]),D=Math.floor(p[S+1]);if(E<-1||E>g||D<-1||D>v)throw new z;N=!1,E===-1?(p[S]=0,N=!0):E===g&&(p[S]=g-1,N=!0),D===-1?(p[S+1]=0,N=!0):D===v&&(p[S+1]=v-1,N=!0)}}}class pt{constructor(h,p,g,v,N,S,E,D,$){this.a11=h,this.a21=p,this.a31=g,this.a12=v,this.a22=N,this.a32=S,this.a13=E,this.a23=D,this.a33=$}static quadrilateralToQuadrilateral(h,p,g,v,N,S,E,D,$,H,Y,Z,re,xe,ve,Se){const Me=pt.quadrilateralToSquare(h,p,g,v,N,S,E,D);return pt.squareToQuadrilateral($,H,Y,Z,re,xe,ve,Se).times(Me)}transformPoints(h){const p=h.length,g=this.a11,v=this.a12,N=this.a13,S=this.a21,E=this.a22,D=this.a23,$=this.a31,H=this.a32,Y=this.a33;for(let Z=0;Z<p;Z+=2){const re=h[Z],xe=h[Z+1],ve=N*re+D*xe+Y;h[Z]=(g*re+S*xe+$)/ve,h[Z+1]=(v*re+E*xe+H)/ve}}transformPointsWithValues(h,p){const g=this.a11,v=this.a12,N=this.a13,S=this.a21,E=this.a22,D=this.a23,$=this.a31,H=this.a32,Y=this.a33,Z=h.length;for(let re=0;re<Z;re++){const xe=h[re],ve=p[re],Se=N*xe+D*ve+Y;h[re]=(g*xe+S*ve+$)/Se,p[re]=(v*xe+E*ve+H)/Se}}static squareToQuadrilateral(h,p,g,v,N,S,E,D){const $=h-g+N-E,H=p-v+S-D;if($===0&&H===0)return new pt(g-h,N-g,h,v-p,S-v,p,0,0,1);{const Y=g-N,Z=E-N,re=v-S,xe=D-S,ve=Y*xe-Z*re,Se=($*xe-Z*H)/ve,Me=(Y*H-$*re)/ve;return new pt(g-h+Se*g,E-h+Me*E,h,v-p+Se*v,D-p+Me*D,p,Se,Me,1)}}static quadrilateralToSquare(h,p,g,v,N,S,E,D){return pt.squareToQuadrilateral(h,p,g,v,N,S,E,D).buildAdjoint()}buildAdjoint(){return new pt(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(h){return new pt(this.a11*h.a11+this.a21*h.a12+this.a31*h.a13,this.a11*h.a21+this.a21*h.a22+this.a31*h.a23,this.a11*h.a31+this.a21*h.a32+this.a31*h.a33,this.a12*h.a11+this.a22*h.a12+this.a32*h.a13,this.a12*h.a21+this.a22*h.a22+this.a32*h.a23,this.a12*h.a31+this.a22*h.a32+this.a32*h.a33,this.a13*h.a11+this.a23*h.a12+this.a33*h.a13,this.a13*h.a21+this.a23*h.a22+this.a33*h.a23,this.a13*h.a31+this.a23*h.a32+this.a33*h.a33)}}class Cs extends yt{sampleGrid(h,p,g,v,N,S,E,D,$,H,Y,Z,re,xe,ve,Se,Me,Xe,Ze){const He=pt.quadrilateralToQuadrilateral(v,N,S,E,D,$,H,Y,Z,re,xe,ve,Se,Me,Xe,Ze);return this.sampleGridWithTransform(h,p,g,He)}sampleGridWithTransform(h,p,g,v){if(p<=0||g<=0)throw new z;const N=new U(p,g),S=new Float32Array(2*p);for(let E=0;E<g;E++){const D=S.length,$=E+.5;for(let H=0;H<D;H+=2)S[H]=H/2+.5,S[H+1]=$;v.transformPoints(S),yt.checkAndNudgePoints(h,S);try{for(let H=0;H<D;H+=2)h.get(Math.floor(S[H]),Math.floor(S[H+1]))&&N.set(H/2,E)}catch{throw new z}}return N}}class hs{static setGridSampler(h){hs.gridSampler=h}static getInstance(){return hs.gridSampler}}hs.gridSampler=new Cs;class ae{constructor(h,p){this.x=h,this.y=p}toResultPoint(){return new me(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class Te{constructor(h){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=h}detect(){return this.detectMirror(!1)}detectMirror(h){let p=this.getMatrixCenter(),g=this.getBullsEyeCorners(p);if(h){let S=g[0];g[0]=g[2],g[2]=S}this.extractParameters(g);let v=this.sampleGrid(this.image,g[this.shift%4],g[(this.shift+1)%4],g[(this.shift+2)%4],g[(this.shift+3)%4]),N=this.getMatrixCornerPoints(g);return new Be(v,N,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(h){if(!this.isValidPoint(h[0])||!this.isValidPoint(h[1])||!this.isValidPoint(h[2])||!this.isValidPoint(h[3]))throw new z;let p=2*this.nbCenterLayers,g=new Int32Array([this.sampleLine(h[0],h[1],p),this.sampleLine(h[1],h[2],p),this.sampleLine(h[2],h[3],p),this.sampleLine(h[3],h[0],p)]);this.shift=this.getRotation(g,p);let v=0;for(let S=0;S<4;S++){let E=g[(this.shift+S)%4];this.compact?(v<<=7,v+=E>>1&127):(v<<=10,v+=(E>>2&992)+(E>>1&31))}let N=this.getCorrectedParameterData(v,this.compact);this.compact?(this.nbLayers=(N>>6)+1,this.nbDataBlocks=(N&63)+1):(this.nbLayers=(N>>11)+1,this.nbDataBlocks=(N&2047)+1)}getRotation(h,p){let g=0;h.forEach((v,N,S)=>{let E=(v>>p-2<<1)+(v&1);g=(g<<3)+E}),g=((g&1)<<11)+(g>>1);for(let v=0;v<4;v++)if(A.bitCount(g^this.EXPECTED_CORNER_BITS[v])<=2)return v;throw new z}getCorrectedParameterData(h,p){let g,v;p?(g=7,v=2):(g=10,v=4);let N=g-v,S=new Int32Array(g);for(let D=g-1;D>=0;--D)S[D]=h&15,h>>=4;try{new mt(Ve.AZTEC_PARAM).decode(S,N)}catch{throw new z}let E=0;for(let D=0;D<v;D++)E=(E<<4)+S[D];return E}getBullsEyeCorners(h){let p=h,g=h,v=h,N=h,S=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let Y=this.getFirstDifferent(p,S,1,-1),Z=this.getFirstDifferent(g,S,1,1),re=this.getFirstDifferent(v,S,-1,1),xe=this.getFirstDifferent(N,S,-1,-1);if(this.nbCenterLayers>2){let ve=this.distancePoint(xe,Y)*this.nbCenterLayers/(this.distancePoint(N,p)*(this.nbCenterLayers+2));if(ve<.75||ve>1.25||!this.isWhiteOrBlackRectangle(Y,Z,re,xe))break}p=Y,g=Z,v=re,N=xe,S=!S}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new z;this.compact=this.nbCenterLayers===5;let E=new me(p.getX()+.5,p.getY()-.5),D=new me(g.getX()+.5,g.getY()+.5),$=new me(v.getX()-.5,v.getY()+.5),H=new me(N.getX()-.5,N.getY()-.5);return this.expandSquare([E,D,$,H],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let h,p,g,v;try{let E=new jt(this.image).detect();h=E[0],p=E[1],g=E[2],v=E[3]}catch{let D=this.image.getWidth()/2,$=this.image.getHeight()/2;h=this.getFirstDifferent(new ae(D+7,$-7),!1,1,-1).toResultPoint(),p=this.getFirstDifferent(new ae(D+7,$+7),!1,1,1).toResultPoint(),g=this.getFirstDifferent(new ae(D-7,$+7),!1,-1,1).toResultPoint(),v=this.getFirstDifferent(new ae(D-7,$-7),!1,-1,-1).toResultPoint()}let N=be.round((h.getX()+v.getX()+p.getX()+g.getX())/4),S=be.round((h.getY()+v.getY()+p.getY()+g.getY())/4);try{let E=new jt(this.image,15,N,S).detect();h=E[0],p=E[1],g=E[2],v=E[3]}catch{h=this.getFirstDifferent(new ae(N+7,S-7),!1,1,-1).toResultPoint(),p=this.getFirstDifferent(new ae(N+7,S+7),!1,1,1).toResultPoint(),g=this.getFirstDifferent(new ae(N-7,S+7),!1,-1,1).toResultPoint(),v=this.getFirstDifferent(new ae(N-7,S-7),!1,-1,-1).toResultPoint()}return N=be.round((h.getX()+v.getX()+p.getX()+g.getX())/4),S=be.round((h.getY()+v.getY()+p.getY()+g.getY())/4),new ae(N,S)}getMatrixCornerPoints(h){return this.expandSquare(h,2*this.nbCenterLayers,this.getDimension())}sampleGrid(h,p,g,v,N){let S=hs.getInstance(),E=this.getDimension(),D=E/2-this.nbCenterLayers,$=E/2+this.nbCenterLayers;return S.sampleGrid(h,E,E,D,D,$,D,$,$,D,$,p.getX(),p.getY(),g.getX(),g.getY(),v.getX(),v.getY(),N.getX(),N.getY())}sampleLine(h,p,g){let v=0,N=this.distanceResultPoint(h,p),S=N/g,E=h.getX(),D=h.getY(),$=S*(p.getX()-h.getX())/N,H=S*(p.getY()-h.getY())/N;for(let Y=0;Y<g;Y++)this.image.get(be.round(E+Y*$),be.round(D+Y*H))&&(v|=1<<g-Y-1);return v}isWhiteOrBlackRectangle(h,p,g,v){let N=3;h=new ae(h.getX()-N,h.getY()+N),p=new ae(p.getX()-N,p.getY()-N),g=new ae(g.getX()+N,g.getY()-N),v=new ae(v.getX()+N,v.getY()+N);let S=this.getColor(v,h);if(S===0)return!1;let E=this.getColor(h,p);return E!==S||(E=this.getColor(p,g),E!==S)?!1:(E=this.getColor(g,v),E===S)}getColor(h,p){let g=this.distancePoint(h,p),v=(p.getX()-h.getX())/g,N=(p.getY()-h.getY())/g,S=0,E=h.getX(),D=h.getY(),$=this.image.get(h.getX(),h.getY()),H=Math.ceil(g);for(let Z=0;Z<H;Z++)E+=v,D+=N,this.image.get(be.round(E),be.round(D))!==$&&S++;let Y=S/g;return Y>.1&&Y<.9?0:Y<=.1===$?1:-1}getFirstDifferent(h,p,g,v){let N=h.getX()+g,S=h.getY()+v;for(;this.isValid(N,S)&&this.image.get(N,S)===p;)N+=g,S+=v;for(N-=g,S-=v;this.isValid(N,S)&&this.image.get(N,S)===p;)N+=g;for(N-=g;this.isValid(N,S)&&this.image.get(N,S)===p;)S+=v;return S-=v,new ae(N,S)}expandSquare(h,p,g){let v=g/(2*p),N=h[0].getX()-h[2].getX(),S=h[0].getY()-h[2].getY(),E=(h[0].getX()+h[2].getX())/2,D=(h[0].getY()+h[2].getY())/2,$=new me(E+v*N,D+v*S),H=new me(E-v*N,D-v*S);N=h[1].getX()-h[3].getX(),S=h[1].getY()-h[3].getY(),E=(h[1].getX()+h[3].getX())/2,D=(h[1].getY()+h[3].getY())/2;let Y=new me(E+v*N,D+v*S),Z=new me(E-v*N,D-v*S);return[$,Y,H,Z]}isValid(h,p){return h>=0&&h<this.image.getWidth()&&p>0&&p<this.image.getHeight()}isValidPoint(h){let p=be.round(h.getX()),g=be.round(h.getY());return this.isValid(p,g)}distancePoint(h,p){return be.distance(h.getX(),h.getY(),p.getX(),p.getY())}distanceResultPoint(h,p){return be.distance(h.getX(),h.getY(),p.getX(),p.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(A.truncDivision(this.nbLayers-4,8)+1)+15}}class de{decode(h,p=null){let g=null,v=new Te(h.getBlackMatrix()),N=null,S=null;try{let H=v.detectMirror(!1);N=H.getPoints(),this.reportFoundResultPoints(p,N),S=new bt().decode(H)}catch(H){g=H}if(S==null)try{let H=v.detectMirror(!0);N=H.getPoints(),this.reportFoundResultPoints(p,N),S=new bt().decode(H)}catch(H){throw g??H}let E=new ue(S.getText(),S.getRawBytes(),S.getNumBits(),N,X.AZTEC,j.currentTimeMillis()),D=S.getByteSegments();D!=null&&E.putMetadata(_e.BYTE_SEGMENTS,D);let $=S.getECLevel();return $!=null&&E.putMetadata(_e.ERROR_CORRECTION_LEVEL,$),E}reportFoundResultPoints(h,p){if(h!=null){let g=h.get(R.NEED_RESULT_POINT_CALLBACK);g!=null&&p.forEach((v,N,S)=>{g.foundPossibleResultPoint(v)})}}reset(){}}class Pe extends pe{constructor(h=500){super(new de,h)}}class Ue{decode(h,p){try{return this.doDecode(h,p)}catch{if(p&&p.get(R.TRY_HARDER)===!0&&h.isRotateSupported()){const N=h.rotateCounterClockwise(),S=this.doDecode(N,p),E=S.getResultMetadata();let D=270;E!==null&&E.get(_e.ORIENTATION)===!0&&(D=D+E.get(_e.ORIENTATION)%360),S.putMetadata(_e.ORIENTATION,D);const $=S.getResultPoints();if($!==null){const H=N.getHeight();for(let Y=0;Y<$.length;Y++)$[Y]=new me(H-$[Y].getY()-1,$[Y].getX())}return S}else throw new z}}reset(){}doDecode(h,p){const g=h.getWidth(),v=h.getHeight();let N=new T(g);const S=p&&p.get(R.TRY_HARDER)===!0,E=Math.max(1,v>>(S?8:5));let D;S?D=v:D=15;const $=Math.trunc(v/2);for(let H=0;H<D;H++){const Y=Math.trunc((H+1)/2),Z=(H&1)===0,re=$+E*(Z?Y:-Y);if(re<0||re>=v)break;try{N=h.getBlackRow(re,N)}catch{continue}for(let xe=0;xe<2;xe++){if(xe===1&&(N.reverse(),p&&p.get(R.NEED_RESULT_POINT_CALLBACK)===!0)){const ve=new Map;p.forEach((Se,Me)=>ve.set(Me,Se)),ve.delete(R.NEED_RESULT_POINT_CALLBACK),p=ve}try{const ve=this.decodeRow(re,N,p);if(xe===1){ve.putMetadata(_e.ORIENTATION,180);const Se=ve.getResultPoints();Se!==null&&(Se[0]=new me(g-Se[0].getX()-1,Se[0].getY()),Se[1]=new me(g-Se[1].getX()-1,Se[1].getY()))}return ve}catch{}}}throw new z}static recordPattern(h,p,g){const v=g.length;for(let $=0;$<v;$++)g[$]=0;const N=h.getSize();if(p>=N)throw new z;let S=!h.get(p),E=0,D=p;for(;D<N;){if(h.get(D)!==S)g[E]++;else{if(++E===v)break;g[E]=1,S=!S}D++}if(!(E===v||E===v-1&&D===N))throw new z}static recordPatternInReverse(h,p,g){let v=g.length,N=h.get(p);for(;p>0&&v>=0;)h.get(--p)!==N&&(v--,N=!N);if(v>=0)throw new z;Ue.recordPattern(h,p+1,g)}static patternMatchVariance(h,p,g){const v=h.length;let N=0,S=0;for(let $=0;$<v;$++)N+=h[$],S+=p[$];if(N<S)return Number.POSITIVE_INFINITY;const E=N/S;g*=E;let D=0;for(let $=0;$<v;$++){const H=h[$],Y=p[$]*E,Z=H>Y?H-Y:Y-H;if(Z>g)return Number.POSITIVE_INFINITY;D+=Z}return D/N}}class Le extends Ue{static findStartPattern(h){const p=h.getSize(),g=h.getNextSet(0);let v=0,N=Int32Array.from([0,0,0,0,0,0]),S=g,E=!1;const D=6;for(let $=g;$<p;$++)if(h.get($)!==E)N[v]++;else{if(v===D-1){let H=Le.MAX_AVG_VARIANCE,Y=-1;for(let Z=Le.CODE_START_A;Z<=Le.CODE_START_C;Z++){const re=Ue.patternMatchVariance(N,Le.CODE_PATTERNS[Z],Le.MAX_INDIVIDUAL_VARIANCE);re<H&&(H=re,Y=Z)}if(Y>=0&&h.isRange(Math.max(0,S-($-S)/2),S,!1))return Int32Array.from([S,$,Y]);S+=N[0]+N[1],N=N.slice(2,N.length-1),N[v-1]=0,N[v]=0,v--}else v++;N[v]=1,E=!E}throw new z}static decodeCode(h,p,g){Ue.recordPattern(h,g,p);let v=Le.MAX_AVG_VARIANCE,N=-1;for(let S=0;S<Le.CODE_PATTERNS.length;S++){const E=Le.CODE_PATTERNS[S],D=this.patternMatchVariance(p,E,Le.MAX_INDIVIDUAL_VARIANCE);D<v&&(v=D,N=S)}if(N>=0)return N;throw new z}decodeRow(h,p,g){const v=g&&g.get(R.ASSUME_GS1)===!0,N=Le.findStartPattern(p),S=N[2];let E=0;const D=new Uint8Array(20);D[E++]=S;let $;switch(S){case Le.CODE_START_A:$=Le.CODE_CODE_A;break;case Le.CODE_START_B:$=Le.CODE_CODE_B;break;case Le.CODE_START_C:$=Le.CODE_CODE_C;break;default:throw new I}let H=!1,Y=!1,Z="",re=N[0],xe=N[1];const ve=Int32Array.from([0,0,0,0,0,0]);let Se=0,Me=0,Xe=S,Ze=0,He=!0,ts=!1,Vt=!1;for(;!H;){const Gu=Y;switch(Y=!1,Se=Me,Me=Le.decodeCode(p,ve,xe),D[E++]=Me,Me!==Le.CODE_STOP&&(He=!0),Me!==Le.CODE_STOP&&(Ze++,Xe+=Ze*Me),re=xe,xe+=ve.reduce((ZK,JK)=>ZK+JK,0),Me){case Le.CODE_START_A:case Le.CODE_START_B:case Le.CODE_START_C:throw new I}switch($){case Le.CODE_CODE_A:if(Me<64)Vt===ts?Z+=String.fromCharCode(32+Me):Z+=String.fromCharCode(32+Me+128),Vt=!1;else if(Me<96)Vt===ts?Z+=String.fromCharCode(Me-64):Z+=String.fromCharCode(Me+64),Vt=!1;else switch(Me!==Le.CODE_STOP&&(He=!1),Me){case Le.CODE_FNC_1:v&&(Z.length===0?Z+="]C1":Z+="");break;case Le.CODE_FNC_2:case Le.CODE_FNC_3:break;case Le.CODE_FNC_4_A:!ts&&Vt?(ts=!0,Vt=!1):ts&&Vt?(ts=!1,Vt=!1):Vt=!0;break;case Le.CODE_SHIFT:Y=!0,$=Le.CODE_CODE_B;break;case Le.CODE_CODE_B:$=Le.CODE_CODE_B;break;case Le.CODE_CODE_C:$=Le.CODE_CODE_C;break;case Le.CODE_STOP:H=!0;break}break;case Le.CODE_CODE_B:if(Me<96)Vt===ts?Z+=String.fromCharCode(32+Me):Z+=String.fromCharCode(32+Me+128),Vt=!1;else switch(Me!==Le.CODE_STOP&&(He=!1),Me){case Le.CODE_FNC_1:v&&(Z.length===0?Z+="]C1":Z+="");break;case Le.CODE_FNC_2:case Le.CODE_FNC_3:break;case Le.CODE_FNC_4_B:!ts&&Vt?(ts=!0,Vt=!1):ts&&Vt?(ts=!1,Vt=!1):Vt=!0;break;case Le.CODE_SHIFT:Y=!0,$=Le.CODE_CODE_A;break;case Le.CODE_CODE_A:$=Le.CODE_CODE_A;break;case Le.CODE_CODE_C:$=Le.CODE_CODE_C;break;case Le.CODE_STOP:H=!0;break}break;case Le.CODE_CODE_C:if(Me<100)Me<10&&(Z+="0"),Z+=Me;else switch(Me!==Le.CODE_STOP&&(He=!1),Me){case Le.CODE_FNC_1:v&&(Z.length===0?Z+="]C1":Z+="");break;case Le.CODE_CODE_A:$=Le.CODE_CODE_A;break;case Le.CODE_CODE_B:$=Le.CODE_CODE_B;break;case Le.CODE_STOP:H=!0;break}break}Gu&&($=$===Le.CODE_CODE_A?Le.CODE_CODE_B:Le.CODE_CODE_A)}const ua=xe-re;if(xe=p.getNextUnset(xe),!p.isRange(xe,Math.min(p.getSize(),xe+(xe-re)/2),!1))throw new z;if(Xe-=Ze*Se,Xe%103!==Se)throw new b;const $i=Z.length;if($i===0)throw new z;$i>0&&He&&($===Le.CODE_CODE_C?Z=Z.substring(0,$i-2):Z=Z.substring(0,$i-1));const ha=(N[1]+N[0])/2,As=re+ua/2,vr=D.length,Ia=new Uint8Array(vr);for(let Gu=0;Gu<vr;Gu++)Ia[Gu]=D[Gu];const qu=[new me(ha,h),new me(As,h)];return new ue(Z,Ia,0,qu,X.CODE_128,new Date().getTime())}}Le.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Le.MAX_AVG_VARIANCE=.25,Le.MAX_INDIVIDUAL_VARIANCE=.7,Le.CODE_SHIFT=98,Le.CODE_CODE_C=99,Le.CODE_CODE_B=100,Le.CODE_CODE_A=101,Le.CODE_FNC_1=102,Le.CODE_FNC_2=97,Le.CODE_FNC_3=96,Le.CODE_FNC_4_A=101,Le.CODE_FNC_4_B=100,Le.CODE_START_A=103,Le.CODE_START_B=104,Le.CODE_START_C=105,Le.CODE_STOP=106;class Dt extends Ue{constructor(h=!1,p=!1){super(),this.usingCheckDigit=h,this.extendedMode=p,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(h,p,g){let v=this.counters;v.fill(0),this.decodeRowResult="";let N=Dt.findAsteriskPattern(p,v),S=p.getNextSet(N[1]),E=p.getSize(),D,$;do{Dt.recordPattern(p,S,v);let ve=Dt.toNarrowWidePattern(v);if(ve<0)throw new z;D=Dt.patternToChar(ve),this.decodeRowResult+=D,$=S;for(let Se of v)S+=Se;S=p.getNextSet(S)}while(D!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let H=0;for(let ve of v)H+=ve;let Y=S-$-H;if(S!==E&&Y*2<H)throw new z;if(this.usingCheckDigit){let ve=this.decodeRowResult.length-1,Se=0;for(let Me=0;Me<ve;Me++)Se+=Dt.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(Me));if(this.decodeRowResult.charAt(ve)!==Dt.ALPHABET_STRING.charAt(Se%43))throw new b;this.decodeRowResult=this.decodeRowResult.substring(0,ve)}if(this.decodeRowResult.length===0)throw new z;let Z;this.extendedMode?Z=Dt.decodeExtended(this.decodeRowResult):Z=this.decodeRowResult;let re=(N[1]+N[0])/2,xe=$+H/2;return new ue(Z,null,0,[new me(re,h),new me(xe,h)],X.CODE_39,new Date().getTime())}static findAsteriskPattern(h,p){let g=h.getSize(),v=h.getNextSet(0),N=0,S=v,E=!1,D=p.length;for(let $=v;$<g;$++)if(h.get($)!==E)p[N]++;else{if(N===D-1){if(this.toNarrowWidePattern(p)===Dt.ASTERISK_ENCODING&&h.isRange(Math.max(0,S-Math.floor(($-S)/2)),S,!1))return[S,$];S+=p[0]+p[1],p.copyWithin(0,2,2+N-1),p[N-1]=0,p[N]=0,N--}else N++;p[N]=1,E=!E}throw new z}static toNarrowWidePattern(h){let p=h.length,g=0,v;do{let N=2147483647;for(let D of h)D<N&&D>g&&(N=D);g=N,v=0;let S=0,E=0;for(let D=0;D<p;D++){let $=h[D];$>g&&(E|=1<<p-1-D,v++,S+=$)}if(v===3){for(let D=0;D<p&&v>0;D++){let $=h[D];if($>g&&(v--,$*2>=S))return-1}return E}}while(v>3);return-1}static patternToChar(h){for(let p=0;p<Dt.CHARACTER_ENCODINGS.length;p++)if(Dt.CHARACTER_ENCODINGS[p]===h)return Dt.ALPHABET_STRING.charAt(p);if(h===Dt.ASTERISK_ENCODING)return"*";throw new z}static decodeExtended(h){let p=h.length,g="";for(let v=0;v<p;v++){let N=h.charAt(v);if(N==="+"||N==="$"||N==="%"||N==="/"){let S=h.charAt(v+1),E="\0";switch(N){case"+":if(S>="A"&&S<="Z")E=String.fromCharCode(S.charCodeAt(0)+32);else throw new I;break;case"$":if(S>="A"&&S<="Z")E=String.fromCharCode(S.charCodeAt(0)-64);else throw new I;break;case"%":if(S>="A"&&S<="E")E=String.fromCharCode(S.charCodeAt(0)-38);else if(S>="F"&&S<="J")E=String.fromCharCode(S.charCodeAt(0)-11);else if(S>="K"&&S<="O")E=String.fromCharCode(S.charCodeAt(0)+16);else if(S>="P"&&S<="T")E=String.fromCharCode(S.charCodeAt(0)+43);else if(S==="U")E="\0";else if(S==="V")E="@";else if(S==="W")E="`";else if(S==="X"||S==="Y"||S==="Z")E="";else throw new I;break;case"/":if(S>="A"&&S<="O")E=String.fromCharCode(S.charCodeAt(0)-32);else if(S==="Z")E=":";else throw new I;break}g+=E,v++}else g+=N}return g}}Dt.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",Dt.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],Dt.ASTERISK_ENCODING=148;class Rt extends Ue{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(h,p,g){let v=this.decodeStart(p),N=this.decodeEnd(p),S=new V;Rt.decodeMiddle(p,v[1],N[0],S);let E=S.toString(),D=null;g!=null&&(D=g.get(R.ALLOWED_LENGTHS)),D==null&&(D=Rt.DEFAULT_ALLOWED_LENGTHS);let $=E.length,H=!1,Y=0;for(let xe of D){if($===xe){H=!0;break}xe>Y&&(Y=xe)}if(!H&&$>Y&&(H=!0),!H)throw new I;const Z=[new me(v[1],h),new me(N[0],h)];return new ue(E,null,0,Z,X.ITF,new Date().getTime())}static decodeMiddle(h,p,g,v){let N=new Int32Array(10),S=new Int32Array(5),E=new Int32Array(5);for(N.fill(0),S.fill(0),E.fill(0);p<g;){Ue.recordPattern(h,p,N);for(let $=0;$<5;$++){let H=2*$;S[$]=N[H],E[$]=N[H+1]}let D=Rt.decodeDigit(S);v.append(D.toString()),D=this.decodeDigit(E),v.append(D.toString()),N.forEach(function($){p+=$})}}decodeStart(h){let p=Rt.skipWhiteSpace(h),g=Rt.findGuardPattern(h,p,Rt.START_PATTERN);return this.narrowLineWidth=(g[1]-g[0])/4,this.validateQuietZone(h,g[0]),g}validateQuietZone(h,p){let g=this.narrowLineWidth*10;g=g<p?g:p;for(let v=p-1;g>0&&v>=0&&!h.get(v);v--)g--;if(g!==0)throw new z}static skipWhiteSpace(h){const p=h.getSize(),g=h.getNextSet(0);if(g===p)throw new z;return g}decodeEnd(h){h.reverse();try{let p=Rt.skipWhiteSpace(h),g;try{g=Rt.findGuardPattern(h,p,Rt.END_PATTERN_REVERSED[0])}catch(N){N instanceof z&&(g=Rt.findGuardPattern(h,p,Rt.END_PATTERN_REVERSED[1]))}this.validateQuietZone(h,g[0]);let v=g[0];return g[0]=h.getSize()-g[1],g[1]=h.getSize()-v,g}finally{h.reverse()}}static findGuardPattern(h,p,g){let v=g.length,N=new Int32Array(v),S=h.getSize(),E=!1,D=0,$=p;N.fill(0);for(let H=p;H<S;H++)if(h.get(H)!==E)N[D]++;else{if(D===v-1){if(Ue.patternMatchVariance(N,g,Rt.MAX_INDIVIDUAL_VARIANCE)<Rt.MAX_AVG_VARIANCE)return[$,H];$+=N[0]+N[1],j.arraycopy(N,2,N,0,D-1),N[D-1]=0,N[D]=0,D--}else D++;N[D]=1,E=!E}throw new z}static decodeDigit(h){let p=Rt.MAX_AVG_VARIANCE,g=-1,v=Rt.PATTERNS.length;for(let N=0;N<v;N++){let S=Rt.PATTERNS[N],E=Ue.patternMatchVariance(h,S,Rt.MAX_INDIVIDUAL_VARIANCE);E<p?(p=E,g=N):E===p&&(g=-1)}if(g>=0)return g%10;throw new z}}Rt.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Rt.MAX_AVG_VARIANCE=.38,Rt.MAX_INDIVIDUAL_VARIANCE=.5,Rt.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Rt.START_PATTERN=Int32Array.from([1,1,1,1]),Rt.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Zt extends Ue{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(h){let p=!1,g,v=0,N=Int32Array.from([0,0,0]);for(;!p;){N=Int32Array.from([0,0,0]),g=Zt.findGuardPattern(h,v,!1,this.START_END_PATTERN,N);let S=g[0];v=g[1];let E=S-(v-S);E>=0&&(p=h.isRange(E,S,!1))}return g}static checkChecksum(h){return Zt.checkStandardUPCEANChecksum(h)}static checkStandardUPCEANChecksum(h){let p=h.length;if(p===0)return!1;let g=parseInt(h.charAt(p-1),10);return Zt.getStandardUPCEANChecksum(h.substring(0,p-1))===g}static getStandardUPCEANChecksum(h){let p=h.length,g=0;for(let v=p-1;v>=0;v-=2){let N=h.charAt(v).charCodeAt(0)-48;if(N<0||N>9)throw new I;g+=N}g*=3;for(let v=p-2;v>=0;v-=2){let N=h.charAt(v).charCodeAt(0)-48;if(N<0||N>9)throw new I;g+=N}return(1e3-g)%10}static decodeEnd(h,p){return Zt.findGuardPattern(h,p,!1,Zt.START_END_PATTERN,new Int32Array(Zt.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(h,p,g,v){return this.findGuardPattern(h,p,g,v,new Int32Array(v.length))}static findGuardPattern(h,p,g,v,N){let S=h.getSize();p=g?h.getNextUnset(p):h.getNextSet(p);let E=0,D=p,$=v.length,H=g;for(let Y=p;Y<S;Y++)if(h.get(Y)!==H)N[E]++;else{if(E===$-1){if(Ue.patternMatchVariance(N,v,Zt.MAX_INDIVIDUAL_VARIANCE)<Zt.MAX_AVG_VARIANCE)return Int32Array.from([D,Y]);D+=N[0]+N[1];let Z=N.slice(2,N.length-1);for(let re=0;re<E-1;re++)N[re]=Z[re];N[E-1]=0,N[E]=0,E--}else E++;N[E]=1,H=!H}throw new z}static decodeDigit(h,p,g,v){this.recordPattern(h,g,p);let N=this.MAX_AVG_VARIANCE,S=-1,E=v.length;for(let D=0;D<E;D++){let $=v[D],H=Ue.patternMatchVariance(p,$,Zt.MAX_INDIVIDUAL_VARIANCE);H<N&&(N=H,S=D)}if(S>=0)return S;throw new z}}Zt.MAX_AVG_VARIANCE=.48,Zt.MAX_INDIVIDUAL_VARIANCE=.7,Zt.START_END_PATTERN=Int32Array.from([1,1,1]),Zt.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Zt.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Zt.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class vs{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(h,p,g){let v=this.decodeRowStringBuffer,N=this.decodeMiddle(p,g,v),S=v.toString(),E=vs.parseExtensionString(S),D=[new me((g[0]+g[1])/2,h),new me(N,h)],$=new ue(S,null,0,D,X.UPC_EAN_EXTENSION,new Date().getTime());return E!=null&&$.putAllMetadata(E),$}decodeMiddle(h,p,g){let v=this.decodeMiddleCounters;v[0]=0,v[1]=0,v[2]=0,v[3]=0;let N=h.getSize(),S=p[1],E=0;for(let $=0;$<5&&S<N;$++){let H=Zt.decodeDigit(h,v,S,Zt.L_AND_G_PATTERNS);g+=String.fromCharCode(48+H%10);for(let Y of v)S+=Y;H>=10&&(E|=1<<4-$),$!==4&&(S=h.getNextSet(S),S=h.getNextUnset(S))}if(g.length!==5)throw new z;let D=this.determineCheckDigit(E);if(vs.extensionChecksum(g.toString())!==D)throw new z;return S}static extensionChecksum(h){let p=h.length,g=0;for(let v=p-2;v>=0;v-=2)g+=h.charAt(v).charCodeAt(0)-48;g*=3;for(let v=p-1;v>=0;v-=2)g+=h.charAt(v).charCodeAt(0)-48;return g*=3,g%10}determineCheckDigit(h){for(let p=0;p<10;p++)if(h===this.CHECK_DIGIT_ENCODINGS[p])return p;throw new z}static parseExtensionString(h){if(h.length!==5)return null;let p=vs.parseExtension5String(h);return p==null?null:new Map([[_e.SUGGESTED_PRICE,p]])}static parseExtension5String(h){let p;switch(h.charAt(0)){case"0":p="";break;case"5":p="$";break;case"9":switch(h){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}p="";break;default:p="";break}let g=parseInt(h.substring(1)),v=(g/100).toString(),N=g%100,S=N<10?"0"+N:N.toString();return p+v+"."+S}}class bn{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(h,p,g){let v=this.decodeRowStringBuffer,N=this.decodeMiddle(p,g,v),S=v.toString(),E=bn.parseExtensionString(S),D=[new me((g[0]+g[1])/2,h),new me(N,h)],$=new ue(S,null,0,D,X.UPC_EAN_EXTENSION,new Date().getTime());return E!=null&&$.putAllMetadata(E),$}decodeMiddle(h,p,g){let v=this.decodeMiddleCounters;v[0]=0,v[1]=0,v[2]=0,v[3]=0;let N=h.getSize(),S=p[1],E=0;for(let D=0;D<2&&S<N;D++){let $=Zt.decodeDigit(h,v,S,Zt.L_AND_G_PATTERNS);g+=String.fromCharCode(48+$%10);for(let H of v)S+=H;$>=10&&(E|=1<<1-D),D!==1&&(S=h.getNextSet(S),S=h.getNextUnset(S))}if(g.length!==2)throw new z;if(parseInt(g.toString())%4!==E)throw new z;return S}static parseExtensionString(h){return h.length!==2?null:new Map([[_e.ISSUE_NUMBER,parseInt(h)]])}}class Li{static decodeRow(h,p,g){let v=Zt.findGuardPattern(p,g,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new vs().decodeRow(h,p,v)}catch{return new bn().decodeRow(h,p,v)}}}Li.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class zt extends Zt{constructor(){super(),this.decodeRowStringBuffer="",zt.L_AND_G_PATTERNS=zt.L_PATTERNS.map(h=>Int32Array.from(h));for(let h=10;h<20;h++){let p=zt.L_PATTERNS[h-10],g=new Int32Array(p.length);for(let v=0;v<p.length;v++)g[v]=p[p.length-v-1];zt.L_AND_G_PATTERNS[h]=g}}decodeRow(h,p,g){let v=zt.findStartGuardPattern(p),N=g==null?null:g.get(R.NEED_RESULT_POINT_CALLBACK);if(N!=null){const He=new me((v[0]+v[1])/2,h);N.foundPossibleResultPoint(He)}let S=this.decodeMiddle(p,v,this.decodeRowStringBuffer),E=S.rowOffset,D=S.resultString;if(N!=null){const He=new me(E,h);N.foundPossibleResultPoint(He)}let $=this.decodeEnd(p,E);if(N!=null){const He=new me(($[0]+$[1])/2,h);N.foundPossibleResultPoint(He)}let H=$[1],Y=H+(H-$[0]);if(Y>=p.getSize()||!p.isRange(H,Y,!1))throw new z;let Z=D.toString();if(Z.length<8)throw new I;if(!zt.checkChecksum(Z))throw new b;let re=(v[1]+v[0])/2,xe=($[1]+$[0])/2,ve=this.getBarcodeFormat(),Se=[new me(re,h),new me(xe,h)],Me=new ue(Z,null,0,Se,ve,new Date().getTime()),Xe=0;try{let He=Li.decodeRow(h,p,$[1]);Me.putMetadata(_e.UPC_EAN_EXTENSION,He.getText()),Me.putAllMetadata(He.getResultMetadata()),Me.addResultPoints(He.getResultPoints()),Xe=He.getText().length}catch{}let Ze=g==null?null:g.get(R.ALLOWED_EAN_EXTENSIONS);if(Ze!=null){let He=!1;for(let ts in Ze)if(Xe.toString()===ts){He=!0;break}if(!He)throw new z}return Me}decodeEnd(h,p){return zt.findGuardPattern(h,p,!1,zt.START_END_PATTERN,new Int32Array(zt.START_END_PATTERN.length).fill(0))}static checkChecksum(h){return zt.checkStandardUPCEANChecksum(h)}static checkStandardUPCEANChecksum(h){let p=h.length;if(p===0)return!1;let g=parseInt(h.charAt(p-1),10);return zt.getStandardUPCEANChecksum(h.substring(0,p-1))===g}static getStandardUPCEANChecksum(h){let p=h.length,g=0;for(let v=p-1;v>=0;v-=2){let N=h.charAt(v).charCodeAt(0)-48;if(N<0||N>9)throw new I;g+=N}g*=3;for(let v=p-2;v>=0;v-=2){let N=h.charAt(v).charCodeAt(0)-48;if(N<0||N>9)throw new I;g+=N}return(1e3-g)%10}}class Gt extends zt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(h,p,g){let v=this.decodeMiddleCounters;v[0]=0,v[1]=0,v[2]=0,v[3]=0;let N=h.getSize(),S=p[1],E=0;for(let $=0;$<6&&S<N;$++){let H=zt.decodeDigit(h,v,S,zt.L_AND_G_PATTERNS);g+=String.fromCharCode(48+H%10);for(let Y of v)S+=Y;H>=10&&(E|=1<<5-$)}g=Gt.determineFirstDigit(g,E),S=zt.findGuardPattern(h,S,!0,zt.MIDDLE_PATTERN,new Int32Array(zt.MIDDLE_PATTERN.length).fill(0))[1];for(let $=0;$<6&&S<N;$++){let H=zt.decodeDigit(h,v,S,zt.L_PATTERNS);g+=String.fromCharCode(48+H);for(let Y of v)S+=Y}return{rowOffset:S,resultString:g}}getBarcodeFormat(){return X.EAN_13}static determineFirstDigit(h,p){for(let g=0;g<10;g++)if(p===this.FIRST_DIGIT_ENCODINGS[g])return h=String.fromCharCode(48+g)+h,h;throw new z}}Gt.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class ii extends zt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(h,p,g){const v=this.decodeMiddleCounters;v[0]=0,v[1]=0,v[2]=0,v[3]=0;let N=h.getSize(),S=p[1];for(let D=0;D<4&&S<N;D++){let $=zt.decodeDigit(h,v,S,zt.L_PATTERNS);g+=String.fromCharCode(48+$);for(let H of v)S+=H}S=zt.findGuardPattern(h,S,!0,zt.MIDDLE_PATTERN,new Int32Array(zt.MIDDLE_PATTERN.length).fill(0))[1];for(let D=0;D<4&&S<N;D++){let $=zt.decodeDigit(h,v,S,zt.L_PATTERNS);g+=String.fromCharCode(48+$);for(let H of v)S+=H}return{rowOffset:S,resultString:g}}getBarcodeFormat(){return X.EAN_8}}class Ot extends zt{constructor(){super(...arguments),this.ean13Reader=new Gt}getBarcodeFormat(){return X.UPC_A}decode(h,p){return this.maybeReturnResult(this.ean13Reader.decode(h))}decodeRow(h,p,g){return this.maybeReturnResult(this.ean13Reader.decodeRow(h,p,g))}decodeMiddle(h,p,g){return this.ean13Reader.decodeMiddle(h,p,g)}maybeReturnResult(h){let p=h.getText();if(p.charAt(0)==="0"){let g=new ue(p.substring(1),null,null,h.getResultPoints(),X.UPC_A);return h.getResultMetadata()!=null&&g.putAllMetadata(h.getResultMetadata()),g}else throw new z}reset(){this.ean13Reader.reset()}}class we extends zt{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(h,p,g){const v=this.decodeMiddleCounters.map($=>$);v[0]=0,v[1]=0,v[2]=0,v[3]=0;const N=h.getSize();let S=p[1],E=0;for(let $=0;$<6&&S<N;$++){const H=we.decodeDigit(h,v,S,we.L_AND_G_PATTERNS);g+=String.fromCharCode(48+H%10);for(let Y of v)S+=Y;H>=10&&(E|=1<<5-$)}let D=we.determineNumSysAndCheckDigit(g,E);return{rowOffset:S,resultString:D}}decodeEnd(h,p){return we.findGuardPatternWithoutCounters(h,p,!0,we.MIDDLE_END_PATTERN)}checkChecksum(h){return zt.checkChecksum(we.convertUPCEtoUPCA(h))}static determineNumSysAndCheckDigit(h,p){for(let g=0;g<=1;g++)for(let v=0;v<10;v++)if(p===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[g][v]){let N=String.fromCharCode(48+g),S=String.fromCharCode(48+v);return N+h+S}throw z.getNotFoundInstance()}getBarcodeFormat(){return X.UPC_E}static convertUPCEtoUPCA(h){const p=h.slice(1,7).split("").map(N=>N.charCodeAt(0)),g=new V;g.append(h.charAt(0));let v=p[5];switch(v){case 0:case 1:case 2:g.appendChars(p,0,2),g.append(v),g.append("0000"),g.appendChars(p,2,3);break;case 3:g.appendChars(p,0,3),g.append("00000"),g.appendChars(p,3,2);break;case 4:g.appendChars(p,0,4),g.append("00000"),g.append(p[4]);break;default:g.appendChars(p,0,5),g.append("0000"),g.append(v);break}return h.length>=8&&g.append(h.charAt(7)),g.toString()}}we.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),we.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class it extends Ue{constructor(h){super();let p=h==null?null:h.get(R.POSSIBLE_FORMATS),g=[];a(p)?(g.push(new Gt),g.push(new Ot),g.push(new ii),g.push(new we)):(p.indexOf(X.EAN_13)>-1&&g.push(new Gt),p.indexOf(X.UPC_A)>-1&&g.push(new Ot),p.indexOf(X.EAN_8)>-1&&g.push(new ii),p.indexOf(X.UPC_E)>-1&&g.push(new we)),this.readers=g}decodeRow(h,p,g){for(let v of this.readers)try{const N=v.decodeRow(h,p,g),S=N.getBarcodeFormat()===X.EAN_13&&N.getText().charAt(0)==="0",E=g==null?null:g.get(R.POSSIBLE_FORMATS),D=E==null||E.includes(X.UPC_A);if(S&&D){const $=N.getRawBytes(),H=new ue(N.getText().substring(1),$,$?$.length:null,N.getResultPoints(),X.UPC_A);return H.putAllMetadata(N.getResultMetadata()),H}return N}catch{}throw new z}reset(){for(let h of this.readers)h.reset()}}class ct extends Ue{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(h,p){for(let g=0;g<p.length;g++)if(Ue.patternMatchVariance(h,p[g],ct.MAX_INDIVIDUAL_VARIANCE)<ct.MAX_AVG_VARIANCE)return g;throw new z}static count(h){return be.sum(new Int32Array(h))}static increment(h,p){let g=0,v=p[0];for(let N=1;N<h.length;N++)p[N]>v&&(v=p[N],g=N);h[g]++}static decrement(h,p){let g=0,v=p[0];for(let N=1;N<h.length;N++)p[N]<v&&(v=p[N],g=N);h[g]--}static isFinderPattern(h){let p=h[0]+h[1],g=p+h[2]+h[3],v=p/g;if(v>=ct.MIN_FINDER_PATTERN_RATIO&&v<=ct.MAX_FINDER_PATTERN_RATIO){let N=Number.MAX_SAFE_INTEGER,S=Number.MIN_SAFE_INTEGER;for(let E of h)E>S&&(S=E),E<N&&(N=E);return S<10*N}return!1}}ct.MAX_AVG_VARIANCE=.2,ct.MAX_INDIVIDUAL_VARIANCE=.45,ct.MIN_FINDER_PATTERN_RATIO=9.5/12,ct.MAX_FINDER_PATTERN_RATIO=12.5/14;class Kt{constructor(h,p){this.value=h,this.checksumPortion=p}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(h){if(!(h instanceof Kt))return!1;const p=h;return this.value===p.value&&this.checksumPortion===p.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class $t{constructor(h,p,g,v,N){this.value=h,this.startEnd=p,this.value=h,this.startEnd=p,this.resultPoints=new Array,this.resultPoints.push(new me(g,N)),this.resultPoints.push(new me(v,N))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(h){if(!(h instanceof $t))return!1;const p=h;return this.value===p.value}hashCode(){return this.value}}class Ut{constructor(){}static getRSSvalue(h,p,g){let v=0;for(let D of h)v+=D;let N=0,S=0,E=h.length;for(let D=0;D<E-1;D++){let $;for($=1,S|=1<<D;$<h[D];$++,S&=~(1<<D)){let H=Ut.combins(v-$-1,E-D-2);if(g&&S===0&&v-$-(E-D-1)>=E-D-1&&(H-=Ut.combins(v-$-(E-D),E-D-2)),E-D-1>1){let Y=0;for(let Z=v-$-(E-D-2);Z>p;Z--)Y+=Ut.combins(v-$-Z-1,E-D-3);H-=Y*(E-1-D)}else v-$>p&&H--;N+=H}v-=$}return N}static combins(h,p){let g,v;h-p>p?(v=p,g=h-p):(v=h-p,g=p);let N=1,S=1;for(let E=h;E>g;E--)N*=E,S<=v&&(N/=S,S++);for(;S<=v;)N/=S,S++;return N}}class Qs{static buildBitArray(h){let p=h.length*2-1;h[h.length-1].getRightChar()==null&&(p-=1);let g=12*p,v=new T(g),N=0,E=h[0].getRightChar().getValue();for(let D=11;D>=0;--D)E&1<<D&&v.set(N),N++;for(let D=1;D<h.length;++D){let $=h[D],H=$.getLeftChar().getValue();for(let Y=11;Y>=0;--Y)H&1<<Y&&v.set(N),N++;if($.getRightChar()!=null){let Y=$.getRightChar().getValue();for(let Z=11;Z>=0;--Z)Y&1<<Z&&v.set(N),N++}}return v}}class ws{constructor(h,p){p?this.decodedInformation=null:(this.finished=h,this.decodedInformation=p)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class Bn{constructor(h){this.newPosition=h}getNewPosition(){return this.newPosition}}class dn extends Bn{constructor(h,p){super(h),this.value=p}getValue(){return this.value}isFNC1(){return this.value===dn.FNC1}}dn.FNC1="$";class Fn extends Bn{constructor(h,p,g){super(h),g?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=p}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class ar extends Bn{constructor(h,p,g){if(super(h),p<0||p>10||g<0||g>10)throw new I;this.firstDigit=p,this.secondDigit=g}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===ar.FNC1}isSecondDigitFNC1(){return this.secondDigit===ar.FNC1}isAnyFNC1(){return this.firstDigit===ar.FNC1||this.secondDigit===ar.FNC1}}ar.FNC1=10;class at{constructor(){}static parseFieldsInGeneralPurpose(h){if(!h)return null;if(h.length<2)throw new z;let p=h.substring(0,2);for(let N of at.TWO_DIGIT_DATA_LENGTH)if(N[0]===p)return N[1]===at.VARIABLE_LENGTH?at.processVariableAI(2,N[2],h):at.processFixedAI(2,N[1],h);if(h.length<3)throw new z;let g=h.substring(0,3);for(let N of at.THREE_DIGIT_DATA_LENGTH)if(N[0]===g)return N[1]===at.VARIABLE_LENGTH?at.processVariableAI(3,N[2],h):at.processFixedAI(3,N[1],h);for(let N of at.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(N[0]===g)return N[1]===at.VARIABLE_LENGTH?at.processVariableAI(4,N[2],h):at.processFixedAI(4,N[1],h);if(h.length<4)throw new z;let v=h.substring(0,4);for(let N of at.FOUR_DIGIT_DATA_LENGTH)if(N[0]===v)return N[1]===at.VARIABLE_LENGTH?at.processVariableAI(4,N[2],h):at.processFixedAI(4,N[1],h);throw new z}static processFixedAI(h,p,g){if(g.length<h)throw new z;let v=g.substring(0,h);if(g.length<h+p)throw new z;let N=g.substring(h,h+p),S=g.substring(h+p),E="("+v+")"+N,D=at.parseFieldsInGeneralPurpose(S);return D==null?E:E+D}static processVariableAI(h,p,g){let v=g.substring(0,h),N;g.length<h+p?N=g.length:N=h+p;let S=g.substring(h,N),E=g.substring(N),D="("+v+")"+S,$=at.parseFieldsInGeneralPurpose(E);return $==null?D:D+$}}at.VARIABLE_LENGTH=[],at.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",at.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",at.VARIABLE_LENGTH,20],["22",at.VARIABLE_LENGTH,29],["30",at.VARIABLE_LENGTH,8],["37",at.VARIABLE_LENGTH,8],["90",at.VARIABLE_LENGTH,30],["91",at.VARIABLE_LENGTH,30],["92",at.VARIABLE_LENGTH,30],["93",at.VARIABLE_LENGTH,30],["94",at.VARIABLE_LENGTH,30],["95",at.VARIABLE_LENGTH,30],["96",at.VARIABLE_LENGTH,30],["97",at.VARIABLE_LENGTH,3],["98",at.VARIABLE_LENGTH,30],["99",at.VARIABLE_LENGTH,30]],at.THREE_DIGIT_DATA_LENGTH=[["240",at.VARIABLE_LENGTH,30],["241",at.VARIABLE_LENGTH,30],["242",at.VARIABLE_LENGTH,6],["250",at.VARIABLE_LENGTH,30],["251",at.VARIABLE_LENGTH,30],["253",at.VARIABLE_LENGTH,17],["254",at.VARIABLE_LENGTH,20],["400",at.VARIABLE_LENGTH,30],["401",at.VARIABLE_LENGTH,30],["402",17],["403",at.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",at.VARIABLE_LENGTH,20],["421",at.VARIABLE_LENGTH,15],["422",3],["423",at.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],at.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",at.VARIABLE_LENGTH,15],["391",at.VARIABLE_LENGTH,18],["392",at.VARIABLE_LENGTH,15],["393",at.VARIABLE_LENGTH,18],["703",at.VARIABLE_LENGTH,30]],at.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",at.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",at.VARIABLE_LENGTH,20],["8003",at.VARIABLE_LENGTH,30],["8004",at.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",at.VARIABLE_LENGTH,30],["8008",at.VARIABLE_LENGTH,12],["8018",18],["8020",at.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",at.VARIABLE_LENGTH,70],["8200",at.VARIABLE_LENGTH,70]];class Bi{constructor(h){this.buffer=new V,this.information=h}decodeAllCodes(h,p){let g=p,v=null;do{let N=this.decodeGeneralPurposeField(g,v),S=at.parseFieldsInGeneralPurpose(N.getNewString());if(S!=null&&h.append(S),N.isRemaining()?v=""+N.getRemainingValue():v=null,g===N.getNewPosition())break;g=N.getNewPosition()}while(!0);return h.toString()}isStillNumeric(h){if(h+7>this.information.getSize())return h+4<=this.information.getSize();for(let p=h;p<h+3;++p)if(this.information.get(p))return!0;return this.information.get(h+3)}decodeNumeric(h){if(h+7>this.information.getSize()){let N=this.extractNumericValueFromBitArray(h,4);return N===0?new ar(this.information.getSize(),ar.FNC1,ar.FNC1):new ar(this.information.getSize(),N-1,ar.FNC1)}let p=this.extractNumericValueFromBitArray(h,7),g=(p-8)/11,v=(p-8)%11;return new ar(h+7,g,v)}extractNumericValueFromBitArray(h,p){return Bi.extractNumericValueFromBitArray(this.information,h,p)}static extractNumericValueFromBitArray(h,p,g){let v=0;for(let N=0;N<g;++N)h.get(p+N)&&(v|=1<<g-N-1);return v}decodeGeneralPurposeField(h,p){this.buffer.setLengthToZero(),p!=null&&this.buffer.append(p),this.current.setPosition(h);let g=this.parseBlocks();return g!=null&&g.isRemaining()?new Fn(this.current.getPosition(),this.buffer.toString(),g.getRemainingValue()):new Fn(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let h,p;do{let g=this.current.getPosition();if(this.current.isAlpha()?(p=this.parseAlphaBlock(),h=p.isFinished()):this.current.isIsoIec646()?(p=this.parseIsoIec646Block(),h=p.isFinished()):(p=this.parseNumericBlock(),h=p.isFinished()),!(g!==this.current.getPosition())&&!h)break}while(!h);return p.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let h=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(h.getNewPosition()),h.isFirstDigitFNC1()){let p;return h.isSecondDigitFNC1()?p=new Fn(this.current.getPosition(),this.buffer.toString()):p=new Fn(this.current.getPosition(),this.buffer.toString(),h.getSecondDigit()),new ws(!0,p)}if(this.buffer.append(h.getFirstDigit()),h.isSecondDigitFNC1()){let p=new Fn(this.current.getPosition(),this.buffer.toString());return new ws(!0,p)}this.buffer.append(h.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new ws(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let h=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(h.getNewPosition()),h.isFNC1()){let p=new Fn(this.current.getPosition(),this.buffer.toString());return new ws(!0,p)}this.buffer.append(h.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new ws(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let h=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(h.getNewPosition()),h.isFNC1()){let p=new Fn(this.current.getPosition(),this.buffer.toString());return new ws(!0,p)}this.buffer.append(h.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new ws(!1)}isStillIsoIec646(h){if(h+5>this.information.getSize())return!1;let p=this.extractNumericValueFromBitArray(h,5);if(p>=5&&p<16)return!0;if(h+7>this.information.getSize())return!1;let g=this.extractNumericValueFromBitArray(h,7);if(g>=64&&g<116)return!0;if(h+8>this.information.getSize())return!1;let v=this.extractNumericValueFromBitArray(h,8);return v>=232&&v<253}decodeIsoIec646(h){let p=this.extractNumericValueFromBitArray(h,5);if(p===15)return new dn(h+5,dn.FNC1);if(p>=5&&p<15)return new dn(h+5,"0"+(p-5));let g=this.extractNumericValueFromBitArray(h,7);if(g>=64&&g<90)return new dn(h+7,""+(g+1));if(g>=90&&g<116)return new dn(h+7,""+(g+7));let v=this.extractNumericValueFromBitArray(h,8),N;switch(v){case 232:N="!";break;case 233:N='"';break;case 234:N="%";break;case 235:N="&";break;case 236:N="'";break;case 237:N="(";break;case 238:N=")";break;case 239:N="*";break;case 240:N="+";break;case 241:N=",";break;case 242:N="-";break;case 243:N=".";break;case 244:N="/";break;case 245:N=":";break;case 246:N=";";break;case 247:N="<";break;case 248:N="=";break;case 249:N=">";break;case 250:N="?";break;case 251:N="_";break;case 252:N=" ";break;default:throw new I}return new dn(h+8,N)}isStillAlpha(h){if(h+5>this.information.getSize())return!1;let p=this.extractNumericValueFromBitArray(h,5);if(p>=5&&p<16)return!0;if(h+6>this.information.getSize())return!1;let g=this.extractNumericValueFromBitArray(h,6);return g>=16&&g<63}decodeAlphanumeric(h){let p=this.extractNumericValueFromBitArray(h,5);if(p===15)return new dn(h+5,dn.FNC1);if(p>=5&&p<15)return new dn(h+5,"0"+(p-5));let g=this.extractNumericValueFromBitArray(h,6);if(g>=32&&g<58)return new dn(h+6,""+(g+33));let v;switch(g){case 58:v="*";break;case 59:v=",";break;case 60:v="-";break;case 61:v=".";break;case 62:v="/";break;default:throw new wt("Decoding invalid alphanumeric value: "+g)}return new dn(h+6,v)}isAlphaTo646ToAlphaLatch(h){if(h+1>this.information.getSize())return!1;for(let p=0;p<5&&p+h<this.information.getSize();++p)if(p===2){if(!this.information.get(h+2))return!1}else if(this.information.get(h+p))return!1;return!0}isAlphaOr646ToNumericLatch(h){if(h+3>this.information.getSize())return!1;for(let p=h;p<h+3;++p)if(this.information.get(p))return!1;return!0}isNumericToAlphaNumericLatch(h){if(h+1>this.information.getSize())return!1;for(let p=0;p<4&&p+h<this.information.getSize();++p)if(this.information.get(h+p))return!1;return!0}}class ml{constructor(h){this.information=h,this.generalDecoder=new Bi(h)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class Ir extends ml{constructor(h){super(h)}encodeCompressedGtin(h,p){h.append("(01)");let g=h.length();h.append("9"),this.encodeCompressedGtinWithoutAI(h,p,g)}encodeCompressedGtinWithoutAI(h,p,g){for(let v=0;v<4;++v){let N=this.getGeneralDecoder().extractNumericValueFromBitArray(p+10*v,10);N/100===0&&h.append("0"),N/10===0&&h.append("0"),h.append(N)}Ir.appendCheckDigit(h,g)}static appendCheckDigit(h,p){let g=0;for(let v=0;v<13;v++){let N=h.charAt(v+p).charCodeAt(0)-48;g+=v&1?N:3*N}g=10-g%10,g===10&&(g=0),h.append(g)}}Ir.GTIN_SIZE=40;class Go extends Ir{constructor(h){super(h)}parseInformation(){let h=new V;h.append("(01)");let p=h.length(),g=this.getGeneralDecoder().extractNumericValueFromBitArray(Go.HEADER_SIZE,4);return h.append(g),this.encodeCompressedGtinWithoutAI(h,Go.HEADER_SIZE+4,p),this.getGeneralDecoder().decodeAllCodes(h,Go.HEADER_SIZE+44)}}Go.HEADER_SIZE=4;class Uu extends ml{constructor(h){super(h)}parseInformation(){let h=new V;return this.getGeneralDecoder().decodeAllCodes(h,Uu.HEADER_SIZE)}}Uu.HEADER_SIZE=5;class Vu extends Ir{constructor(h){super(h)}encodeCompressedWeight(h,p,g){let v=this.getGeneralDecoder().extractNumericValueFromBitArray(p,g);this.addWeightCode(h,v);let N=this.checkWeight(v),S=1e5;for(let E=0;E<5;++E)N/S===0&&h.append("0"),S/=10;h.append(N)}}class li extends Vu{constructor(h){super(h)}parseInformation(){if(this.getInformation().getSize()!=li.HEADER_SIZE+Vu.GTIN_SIZE+li.WEIGHT_SIZE)throw new z;let h=new V;return this.encodeCompressedGtin(h,li.HEADER_SIZE),this.encodeCompressedWeight(h,li.HEADER_SIZE+Vu.GTIN_SIZE,li.WEIGHT_SIZE),h.toString()}}li.HEADER_SIZE=5,li.WEIGHT_SIZE=15;class bw extends li{constructor(h){super(h)}addWeightCode(h,p){h.append("(3103)")}checkWeight(h){return h}}class vw extends li{constructor(h){super(h)}addWeightCode(h,p){p<1e4?h.append("(3202)"):h.append("(3203)")}checkWeight(h){return h<1e4?h:h-1e4}}class oi extends Ir{constructor(h){super(h)}parseInformation(){if(this.getInformation().getSize()<oi.HEADER_SIZE+Ir.GTIN_SIZE)throw new z;let h=new V;this.encodeCompressedGtin(h,oi.HEADER_SIZE);let p=this.getGeneralDecoder().extractNumericValueFromBitArray(oi.HEADER_SIZE+Ir.GTIN_SIZE,oi.LAST_DIGIT_SIZE);h.append("(392"),h.append(p),h.append(")");let g=this.getGeneralDecoder().decodeGeneralPurposeField(oi.HEADER_SIZE+Ir.GTIN_SIZE+oi.LAST_DIGIT_SIZE,null);return h.append(g.getNewString()),h.toString()}}oi.HEADER_SIZE=8,oi.LAST_DIGIT_SIZE=2;class gr extends Ir{constructor(h){super(h)}parseInformation(){if(this.getInformation().getSize()<gr.HEADER_SIZE+Ir.GTIN_SIZE)throw new z;let h=new V;this.encodeCompressedGtin(h,gr.HEADER_SIZE);let p=this.getGeneralDecoder().extractNumericValueFromBitArray(gr.HEADER_SIZE+Ir.GTIN_SIZE,gr.LAST_DIGIT_SIZE);h.append("(393"),h.append(p),h.append(")");let g=this.getGeneralDecoder().extractNumericValueFromBitArray(gr.HEADER_SIZE+Ir.GTIN_SIZE+gr.LAST_DIGIT_SIZE,gr.FIRST_THREE_DIGITS_SIZE);g/100==0&&h.append("0"),g/10==0&&h.append("0"),h.append(g);let v=this.getGeneralDecoder().decodeGeneralPurposeField(gr.HEADER_SIZE+Ir.GTIN_SIZE+gr.LAST_DIGIT_SIZE+gr.FIRST_THREE_DIGITS_SIZE,null);return h.append(v.getNewString()),h.toString()}}gr.HEADER_SIZE=8,gr.LAST_DIGIT_SIZE=2,gr.FIRST_THREE_DIGITS_SIZE=10;class Is extends Vu{constructor(h,p,g){super(h),this.dateCode=g,this.firstAIdigits=p}parseInformation(){if(this.getInformation().getSize()!=Is.HEADER_SIZE+Is.GTIN_SIZE+Is.WEIGHT_SIZE+Is.DATE_SIZE)throw new z;let h=new V;return this.encodeCompressedGtin(h,Is.HEADER_SIZE),this.encodeCompressedWeight(h,Is.HEADER_SIZE+Is.GTIN_SIZE,Is.WEIGHT_SIZE),this.encodeCompressedDate(h,Is.HEADER_SIZE+Is.GTIN_SIZE+Is.WEIGHT_SIZE),h.toString()}encodeCompressedDate(h,p){let g=this.getGeneralDecoder().extractNumericValueFromBitArray(p,Is.DATE_SIZE);if(g==38400)return;h.append("("),h.append(this.dateCode),h.append(")");let v=g%32;g/=32;let N=g%12+1;g/=12;let S=g;S/10==0&&h.append("0"),h.append(S),N/10==0&&h.append("0"),h.append(N),v/10==0&&h.append("0"),h.append(v)}addWeightCode(h,p){h.append("("),h.append(this.firstAIdigits),h.append(p/1e5),h.append(")")}checkWeight(h){return h%1e5}}Is.HEADER_SIZE=8,Is.WEIGHT_SIZE=20,Is.DATE_SIZE=16;function md(K){try{if(K.get(1))return new Go(K);if(!K.get(2))return new Uu(K);switch(Bi.extractNumericValueFromBitArray(K,1,4)){case 4:return new bw(K);case 5:return new vw(K)}switch(Bi.extractNumericValueFromBitArray(K,1,5)){case 12:return new oi(K);case 13:return new gr(K)}switch(Bi.extractNumericValueFromBitArray(K,1,7)){case 56:return new Is(K,"310","11");case 57:return new Is(K,"320","11");case 58:return new Is(K,"310","13");case 59:return new Is(K,"320","13");case 60:return new Is(K,"310","15");case 61:return new Is(K,"320","15");case 62:return new Is(K,"310","17");case 63:return new Is(K,"320","17")}}catch(h){throw console.log(h),new wt("unknown decoder: "+K)}}class pl{constructor(h,p,g,v){this.leftchar=h,this.rightchar=p,this.finderpattern=g,this.maybeLast=v}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(h,p){return h instanceof pl?pl.equalsOrNull(h.leftchar,p.leftchar)&&pl.equalsOrNull(h.rightchar,p.rightchar)&&pl.equalsOrNull(h.finderpattern,p.finderpattern):!1}static equalsOrNull(h,p){return h===null?p===null:pl.equals(h,p)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class Kf{constructor(h,p,g){this.pairs=h,this.rowNumber=p,this.wasReversed=g}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(h){return this.checkEqualitity(this,h)}toString(){return"{ "+this.pairs+" }"}equals(h,p){return h instanceof Kf?this.checkEqualitity(h,p)&&h.wasReversed===p.wasReversed:!1}checkEqualitity(h,p){if(!h||!p)return;let g;return h.forEach((v,N)=>{p.forEach(S=>{v.getLeftChar().getValue()===S.getLeftChar().getValue()&&v.getRightChar().getValue()===S.getRightChar().getValue()&&v.getFinderPatter().getValue()===S.getFinderPatter().getValue()&&(g=!0)})}),g}}class ze extends ct{constructor(h){super(...arguments),this.pairs=new Array(ze.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=h===!0}decodeRow(h,p,g){this.pairs.length=0,this.startFromEven=!1;try{return ze.constructResult(this.decodeRow2pairs(h,p))}catch(v){this.verbose&&console.log(v)}return this.pairs.length=0,this.startFromEven=!0,ze.constructResult(this.decodeRow2pairs(h,p))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(h,p){let g=!1;for(;!g;)try{this.pairs.push(this.retrieveNextPair(p,this.pairs,h))}catch(N){if(N instanceof z){if(!this.pairs.length)throw new z;g=!0}}if(this.checkChecksum())return this.pairs;let v;if(this.rows.length?v=!0:v=!1,this.storeRow(h,!1),v){let N=this.checkRowsBoolean(!1);if(N!=null||(N=this.checkRowsBoolean(!0),N!=null))return N}throw new z}checkRowsBoolean(h){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,h&&(this.rows=this.rows.reverse());let p=null;try{p=this.checkRows(new Array,0)}catch(g){this.verbose&&console.log(g)}return h&&(this.rows=this.rows.reverse()),p}checkRows(h,p){for(let g=p;g<this.rows.length;g++){let v=this.rows[g];this.pairs.length=0;for(let S of h)this.pairs.push(S.getPairs());if(this.pairs.push(v.getPairs()),!ze.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let N=new Array(h);N.push(v);try{return this.checkRows(N,g+1)}catch(S){this.verbose&&console.log(S)}}throw new z}static isValidSequence(h){for(let p of ze.FINDER_PATTERN_SEQUENCES){if(h.length>p.length)continue;let g=!0;for(let v=0;v<h.length;v++)if(h[v].getFinderPattern().getValue()!=p[v]){g=!1;break}if(g)return!0}return!1}storeRow(h,p){let g=0,v=!1,N=!1;for(;g<this.rows.length;){let S=this.rows[g];if(S.getRowNumber()>h){N=S.isEquivalent(this.pairs);break}v=S.isEquivalent(this.pairs),g++}N||v||ze.isPartialRow(this.pairs,this.rows)||(this.rows.push(g,new Kf(this.pairs,h,p)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(h,p){for(let g of p)if(g.getPairs().length!==h.length){for(let v of g.getPairs())for(let N of h)if(pl.equals(v,N))break}}static isPartialRow(h,p){for(let g of p){let v=!0;for(let N of h){let S=!1;for(let E of g.getPairs())if(N.equals(E)){S=!0;break}if(!S){v=!1;break}}if(v)return!0}return!1}getRows(){return this.rows}static constructResult(h){let p=Qs.buildBitArray(h),v=md(p).parseInformation(),N=h[0].getFinderPattern().getResultPoints(),S=h[h.length-1].getFinderPattern().getResultPoints(),E=[N[0],N[1],S[0],S[1]];return new ue(v,null,null,E,X.RSS_EXPANDED,null)}checkChecksum(){let h=this.pairs.get(0),p=h.getLeftChar(),g=h.getRightChar();if(g==null)return!1;let v=g.getChecksumPortion(),N=2;for(let E=1;E<this.pairs.size();++E){let D=this.pairs.get(E);v+=D.getLeftChar().getChecksumPortion(),N++;let $=D.getRightChar();$!=null&&(v+=$.getChecksumPortion(),N++)}return v%=211,211*(N-4)+v==p.getValue()}static getNextSecondBar(h,p){let g;return h.get(p)?(g=h.getNextUnset(p),g=h.getNextSet(g)):(g=h.getNextSet(p),g=h.getNextUnset(g)),g}retrieveNextPair(h,p,g){let v=p.length%2==0;this.startFromEven&&(v=!v);let N,S=!0,E=-1;do this.findNextPair(h,p,E),N=this.parseFoundFinderPattern(h,g,v),N==null?E=ze.getNextSecondBar(h,this.startEnd[0]):S=!1;while(S);let D=this.decodeDataCharacter(h,N,v,!0);if(!this.isEmptyPair(p)&&p[p.length-1].mustBeLast())throw new z;let $;try{$=this.decodeDataCharacter(h,N,v,!1)}catch(H){$=null,this.verbose&&console.log(H)}return new pl(D,$,N,!0)}isEmptyPair(h){return h.length===0}findNextPair(h,p,g){let v=this.getDecodeFinderCounters();v[0]=0,v[1]=0,v[2]=0,v[3]=0;let N=h.getSize(),S;g>=0?S=g:this.isEmptyPair(p)?S=0:S=p[p.length-1].getFinderPattern().getStartEnd()[1];let E=p.length%2!=0;this.startFromEven&&(E=!E);let D=!1;for(;S<N&&(D=!h.get(S),!!D);)S++;let $=0,H=S;for(let Y=S;Y<N;Y++)if(h.get(Y)!=D)v[$]++;else{if($==3){if(E&&ze.reverseCounters(v),ze.isFinderPattern(v)){this.startEnd[0]=H,this.startEnd[1]=Y;return}E&&ze.reverseCounters(v),H+=v[0]+v[1],v[0]=v[2],v[1]=v[3],v[2]=0,v[3]=0,$--}else $++;v[$]=1,D=!D}throw new z}static reverseCounters(h){let p=h.length;for(let g=0;g<p/2;++g){let v=h[g];h[g]=h[p-g-1],h[p-g-1]=v}}parseFoundFinderPattern(h,p,g){let v,N,S;if(g){let $=this.startEnd[0]-1;for(;$>=0&&!h.get($);)$--;$++,v=this.startEnd[0]-$,N=$,S=this.startEnd[1]}else N=this.startEnd[0],S=h.getNextUnset(this.startEnd[1]+1),v=S-this.startEnd[1];let E=this.getDecodeFinderCounters();j.arraycopy(E,0,E,1,E.length-1),E[0]=v;let D;try{D=this.parseFinderValue(E,ze.FINDER_PATTERNS)}catch{return null}return new $t(D,[N,S],N,S,p)}decodeDataCharacter(h,p,g,v){let N=this.getDataCharacterCounters();for(let As=0;As<N.length;As++)N[As]=0;if(v)ze.recordPatternInReverse(h,p.getStartEnd()[0],N);else{ze.recordPattern(h,p.getStartEnd()[1],N);for(let As=0,vr=N.length-1;As<vr;As++,vr--){let Ia=N[As];N[As]=N[vr],N[vr]=Ia}}let S=17,E=be.sum(new Int32Array(N))/S,D=(p.getStartEnd()[1]-p.getStartEnd()[0])/15;if(Math.abs(E-D)/D>.3)throw new z;let $=this.getOddCounts(),H=this.getEvenCounts(),Y=this.getOddRoundingErrors(),Z=this.getEvenRoundingErrors();for(let As=0;As<N.length;As++){let vr=1*N[As]/E,Ia=vr+.5;if(Ia<1){if(vr<.3)throw new z;Ia=1}else if(Ia>8){if(vr>8.7)throw new z;Ia=8}let qu=As/2;As&1?(H[qu]=Ia,Z[qu]=vr-Ia):($[qu]=Ia,Y[qu]=vr-Ia)}this.adjustOddEvenCounts(S);let re=4*p.getValue()+(g?0:2)+(v?0:1)-1,xe=0,ve=0;for(let As=$.length-1;As>=0;As--){if(ze.isNotA1left(p,g,v)){let vr=ze.WEIGHTS[re][2*As];ve+=$[As]*vr}xe+=$[As]}let Se=0;for(let As=H.length-1;As>=0;As--)if(ze.isNotA1left(p,g,v)){let vr=ze.WEIGHTS[re][2*As+1];Se+=H[As]*vr}let Me=ve+Se;if(xe&1||xe>13||xe<4)throw new z;let Xe=(13-xe)/2,Ze=ze.SYMBOL_WIDEST[Xe],He=9-Ze,ts=Ut.getRSSvalue($,Ze,!0),Vt=Ut.getRSSvalue(H,He,!1),ua=ze.EVEN_TOTAL_SUBSET[Xe],$i=ze.GSUM[Xe],ha=ts*ua+Vt+$i;return new Kt(ha,Me)}static isNotA1left(h,p,g){return!(h.getValue()==0&&p&&g)}adjustOddEvenCounts(h){let p=be.sum(new Int32Array(this.getOddCounts())),g=be.sum(new Int32Array(this.getEvenCounts())),v=!1,N=!1;p>13?N=!0:p<4&&(v=!0);let S=!1,E=!1;g>13?E=!0:g<4&&(S=!0);let D=p+g-h,$=(p&1)==1,H=(g&1)==0;if(D==1)if($){if(H)throw new z;N=!0}else{if(!H)throw new z;E=!0}else if(D==-1)if($){if(H)throw new z;v=!0}else{if(!H)throw new z;S=!0}else if(D==0){if($){if(!H)throw new z;p<g?(v=!0,E=!0):(N=!0,S=!0)}else if(H)throw new z}else throw new z;if(v){if(N)throw new z;ze.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(N&&ze.decrement(this.getOddCounts(),this.getOddRoundingErrors()),S){if(E)throw new z;ze.increment(this.getEvenCounts(),this.getOddRoundingErrors())}E&&ze.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}ze.SYMBOL_WIDEST=[7,5,4,3,1],ze.EVEN_TOTAL_SUBSET=[4,20,52,104,204],ze.GSUM=[0,348,1388,2948,3988],ze.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],ze.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],ze.FINDER_PAT_A=0,ze.FINDER_PAT_B=1,ze.FINDER_PAT_C=2,ze.FINDER_PAT_D=3,ze.FINDER_PAT_E=4,ze.FINDER_PAT_F=5,ze.FINDER_PATTERN_SEQUENCES=[[ze.FINDER_PAT_A,ze.FINDER_PAT_A],[ze.FINDER_PAT_A,ze.FINDER_PAT_B,ze.FINDER_PAT_B],[ze.FINDER_PAT_A,ze.FINDER_PAT_C,ze.FINDER_PAT_B,ze.FINDER_PAT_D],[ze.FINDER_PAT_A,ze.FINDER_PAT_E,ze.FINDER_PAT_B,ze.FINDER_PAT_D,ze.FINDER_PAT_C],[ze.FINDER_PAT_A,ze.FINDER_PAT_E,ze.FINDER_PAT_B,ze.FINDER_PAT_D,ze.FINDER_PAT_D,ze.FINDER_PAT_F],[ze.FINDER_PAT_A,ze.FINDER_PAT_E,ze.FINDER_PAT_B,ze.FINDER_PAT_D,ze.FINDER_PAT_E,ze.FINDER_PAT_F,ze.FINDER_PAT_F],[ze.FINDER_PAT_A,ze.FINDER_PAT_A,ze.FINDER_PAT_B,ze.FINDER_PAT_B,ze.FINDER_PAT_C,ze.FINDER_PAT_C,ze.FINDER_PAT_D,ze.FINDER_PAT_D],[ze.FINDER_PAT_A,ze.FINDER_PAT_A,ze.FINDER_PAT_B,ze.FINDER_PAT_B,ze.FINDER_PAT_C,ze.FINDER_PAT_C,ze.FINDER_PAT_D,ze.FINDER_PAT_E,ze.FINDER_PAT_E],[ze.FINDER_PAT_A,ze.FINDER_PAT_A,ze.FINDER_PAT_B,ze.FINDER_PAT_B,ze.FINDER_PAT_C,ze.FINDER_PAT_C,ze.FINDER_PAT_D,ze.FINDER_PAT_E,ze.FINDER_PAT_F,ze.FINDER_PAT_F],[ze.FINDER_PAT_A,ze.FINDER_PAT_A,ze.FINDER_PAT_B,ze.FINDER_PAT_B,ze.FINDER_PAT_C,ze.FINDER_PAT_D,ze.FINDER_PAT_D,ze.FINDER_PAT_E,ze.FINDER_PAT_E,ze.FINDER_PAT_F,ze.FINDER_PAT_F]],ze.MAX_PAIRS=11;class ww extends Kt{constructor(h,p,g){super(h,p),this.count=0,this.finderPattern=g}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Vs extends ct{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(h,p,g){const v=this.decodePair(p,!1,h,g);Vs.addOrTally(this.possibleLeftPairs,v),p.reverse();let N=this.decodePair(p,!0,h,g);Vs.addOrTally(this.possibleRightPairs,N),p.reverse();for(let S of this.possibleLeftPairs)if(S.getCount()>1){for(let E of this.possibleRightPairs)if(E.getCount()>1&&Vs.checkChecksum(S,E))return Vs.constructResult(S,E)}throw new z}static addOrTally(h,p){if(p==null)return;let g=!1;for(let v of h)if(v.getValue()===p.getValue()){v.incrementCount(),g=!0;break}g||h.push(p)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(h,p){let g=4537077*h.getValue()+p.getValue(),v=new String(g).toString(),N=new V;for(let $=13-v.length;$>0;$--)N.append("0");N.append(v);let S=0;for(let $=0;$<13;$++){let H=N.charAt($).charCodeAt(0)-48;S+=$&1?H:3*H}S=10-S%10,S===10&&(S=0),N.append(S.toString());let E=h.getFinderPattern().getResultPoints(),D=p.getFinderPattern().getResultPoints();return new ue(N.toString(),null,0,[E[0],E[1],D[0],D[1]],X.RSS_14,new Date().getTime())}static checkChecksum(h,p){let g=(h.getChecksumPortion()+16*p.getChecksumPortion())%79,v=9*h.getFinderPattern().getValue()+p.getFinderPattern().getValue();return v>72&&v--,v>8&&v--,g===v}decodePair(h,p,g,v){try{let N=this.findFinderPattern(h,p),S=this.parseFoundFinderPattern(h,g,p,N),E=v==null?null:v.get(R.NEED_RESULT_POINT_CALLBACK);if(E!=null){let H=(N[0]+N[1])/2;p&&(H=h.getSize()-1-H),E.foundPossibleResultPoint(new me(H,g))}let D=this.decodeDataCharacter(h,S,!0),$=this.decodeDataCharacter(h,S,!1);return new ww(1597*D.getValue()+$.getValue(),D.getChecksumPortion()+4*$.getChecksumPortion(),S)}catch{return null}}decodeDataCharacter(h,p,g){let v=this.getDataCharacterCounters();for(let Se=0;Se<v.length;Se++)v[Se]=0;if(g)Ue.recordPatternInReverse(h,p.getStartEnd()[0],v);else{Ue.recordPattern(h,p.getStartEnd()[1]+1,v);for(let Se=0,Me=v.length-1;Se<Me;Se++,Me--){let Xe=v[Se];v[Se]=v[Me],v[Me]=Xe}}let N=g?16:15,S=be.sum(new Int32Array(v))/N,E=this.getOddCounts(),D=this.getEvenCounts(),$=this.getOddRoundingErrors(),H=this.getEvenRoundingErrors();for(let Se=0;Se<v.length;Se++){let Me=v[Se]/S,Xe=Math.floor(Me+.5);Xe<1?Xe=1:Xe>8&&(Xe=8);let Ze=Math.floor(Se/2);Se&1?(D[Ze]=Xe,H[Ze]=Me-Xe):(E[Ze]=Xe,$[Ze]=Me-Xe)}this.adjustOddEvenCounts(g,N);let Y=0,Z=0;for(let Se=E.length-1;Se>=0;Se--)Z*=9,Z+=E[Se],Y+=E[Se];let re=0,xe=0;for(let Se=D.length-1;Se>=0;Se--)re*=9,re+=D[Se],xe+=D[Se];let ve=Z+3*re;if(g){if(Y&1||Y>12||Y<4)throw new z;let Se=(12-Y)/2,Me=Vs.OUTSIDE_ODD_WIDEST[Se],Xe=9-Me,Ze=Ut.getRSSvalue(E,Me,!1),He=Ut.getRSSvalue(D,Xe,!0),ts=Vs.OUTSIDE_EVEN_TOTAL_SUBSET[Se],Vt=Vs.OUTSIDE_GSUM[Se];return new Kt(Ze*ts+He+Vt,ve)}else{if(xe&1||xe>10||xe<4)throw new z;let Se=(10-xe)/2,Me=Vs.INSIDE_ODD_WIDEST[Se],Xe=9-Me,Ze=Ut.getRSSvalue(E,Me,!0),He=Ut.getRSSvalue(D,Xe,!1),ts=Vs.INSIDE_ODD_TOTAL_SUBSET[Se],Vt=Vs.INSIDE_GSUM[Se];return new Kt(He*ts+Ze+Vt,ve)}}findFinderPattern(h,p){let g=this.getDecodeFinderCounters();g[0]=0,g[1]=0,g[2]=0,g[3]=0;let v=h.getSize(),N=!1,S=0;for(;S<v&&(N=!h.get(S),p!==N);)S++;let E=0,D=S;for(let $=S;$<v;$++)if(h.get($)!==N)g[E]++;else{if(E===3){if(ct.isFinderPattern(g))return[D,$];D+=g[0]+g[1],g[0]=g[2],g[1]=g[3],g[2]=0,g[3]=0,E--}else E++;g[E]=1,N=!N}throw new z}parseFoundFinderPattern(h,p,g,v){let N=h.get(v[0]),S=v[0]-1;for(;S>=0&&N!==h.get(S);)S--;S++;const E=v[0]-S,D=this.getDecodeFinderCounters(),$=new Int32Array(D.length);j.arraycopy(D,0,$,1,D.length-1),$[0]=E;const H=this.parseFinderValue($,Vs.FINDER_PATTERNS);let Y=S,Z=v[1];return g&&(Y=h.getSize()-1-Y,Z=h.getSize()-1-Z),new $t(H,[S,v[1]],Y,Z,p)}adjustOddEvenCounts(h,p){let g=be.sum(new Int32Array(this.getOddCounts())),v=be.sum(new Int32Array(this.getEvenCounts())),N=!1,S=!1,E=!1,D=!1;h?(g>12?S=!0:g<4&&(N=!0),v>12?D=!0:v<4&&(E=!0)):(g>11?S=!0:g<5&&(N=!0),v>10?D=!0:v<4&&(E=!0));let $=g+v-p,H=(g&1)===(h?1:0),Y=(v&1)===1;if($===1)if(H){if(Y)throw new z;S=!0}else{if(!Y)throw new z;D=!0}else if($===-1)if(H){if(Y)throw new z;N=!0}else{if(!Y)throw new z;E=!0}else if($===0){if(H){if(!Y)throw new z;g<v?(N=!0,D=!0):(S=!0,E=!0)}else if(Y)throw new z}else throw new z;if(N){if(S)throw new z;ct.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(S&&ct.decrement(this.getOddCounts(),this.getOddRoundingErrors()),E){if(D)throw new z;ct.increment(this.getEvenCounts(),this.getOddRoundingErrors())}D&&ct.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Vs.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Vs.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Vs.OUTSIDE_GSUM=[0,161,961,2015,2715],Vs.INSIDE_GSUM=[0,336,1036,1516],Vs.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Vs.INSIDE_ODD_WIDEST=[2,4,6,8],Vs.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Ko extends Ue{constructor(h,p){super(),this.readers=[],this.verbose=p===!0;const g=h?h.get(R.POSSIBLE_FORMATS):null,v=h&&h.get(R.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;g?((g.includes(X.EAN_13)||g.includes(X.UPC_A)||g.includes(X.EAN_8)||g.includes(X.UPC_E))&&this.readers.push(new it(h)),g.includes(X.CODE_39)&&this.readers.push(new Dt(v)),g.includes(X.CODE_128)&&this.readers.push(new Le),g.includes(X.ITF)&&this.readers.push(new Rt),g.includes(X.RSS_14)&&this.readers.push(new Vs),g.includes(X.RSS_EXPANDED)&&this.readers.push(new ze(this.verbose))):(this.readers.push(new it(h)),this.readers.push(new Dt),this.readers.push(new it(h)),this.readers.push(new Le),this.readers.push(new Rt),this.readers.push(new Vs),this.readers.push(new ze(this.verbose)))}decodeRow(h,p,g){for(let v=0;v<this.readers.length;v++)try{return this.readers[v].decodeRow(h,p,g)}catch{}throw new z}reset(){this.readers.forEach(h=>h.reset())}}class pd extends pe{constructor(h=500,p){super(new Ko(p),h,p)}}class ls{constructor(h,p,g){this.ecCodewords=h,this.ecBlocks=[p],g&&this.ecBlocks.push(g)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class ns{constructor(h,p){this.count=h,this.dataCodewords=p}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Jt{constructor(h,p,g,v,N,S){this.versionNumber=h,this.symbolSizeRows=p,this.symbolSizeColumns=g,this.dataRegionSizeRows=v,this.dataRegionSizeColumns=N,this.ecBlocks=S;let E=0;const D=S.getECCodewords(),$=S.getECBlocks();for(let H of $)E+=H.getCount()*(H.getDataCodewords()+D);this.totalCodewords=E}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(h,p){if(h&1||p&1)throw new I;for(let g of Jt.VERSIONS)if(g.symbolSizeRows===h&&g.symbolSizeColumns===p)return g;throw new I}toString(){return""+this.versionNumber}static buildVersions(){return[new Jt(1,10,10,8,8,new ls(5,new ns(1,3))),new Jt(2,12,12,10,10,new ls(7,new ns(1,5))),new Jt(3,14,14,12,12,new ls(10,new ns(1,8))),new Jt(4,16,16,14,14,new ls(12,new ns(1,12))),new Jt(5,18,18,16,16,new ls(14,new ns(1,18))),new Jt(6,20,20,18,18,new ls(18,new ns(1,22))),new Jt(7,22,22,20,20,new ls(20,new ns(1,30))),new Jt(8,24,24,22,22,new ls(24,new ns(1,36))),new Jt(9,26,26,24,24,new ls(28,new ns(1,44))),new Jt(10,32,32,14,14,new ls(36,new ns(1,62))),new Jt(11,36,36,16,16,new ls(42,new ns(1,86))),new Jt(12,40,40,18,18,new ls(48,new ns(1,114))),new Jt(13,44,44,20,20,new ls(56,new ns(1,144))),new Jt(14,48,48,22,22,new ls(68,new ns(1,174))),new Jt(15,52,52,24,24,new ls(42,new ns(2,102))),new Jt(16,64,64,14,14,new ls(56,new ns(2,140))),new Jt(17,72,72,16,16,new ls(36,new ns(4,92))),new Jt(18,80,80,18,18,new ls(48,new ns(4,114))),new Jt(19,88,88,20,20,new ls(56,new ns(4,144))),new Jt(20,96,96,22,22,new ls(68,new ns(4,174))),new Jt(21,104,104,24,24,new ls(56,new ns(6,136))),new Jt(22,120,120,18,18,new ls(68,new ns(6,175))),new Jt(23,132,132,20,20,new ls(62,new ns(8,163))),new Jt(24,144,144,22,22,new ls(62,new ns(8,156),new ns(2,155))),new Jt(25,8,18,6,16,new ls(7,new ns(1,5))),new Jt(26,8,32,6,14,new ls(11,new ns(1,10))),new Jt(27,12,26,10,24,new ls(14,new ns(1,16))),new Jt(28,12,36,10,16,new ls(18,new ns(1,22))),new Jt(29,16,36,14,16,new ls(24,new ns(1,32))),new Jt(30,16,48,14,22,new ls(28,new ns(1,49)))]}}Jt.VERSIONS=Jt.buildVersions();class Yf{constructor(h){const p=h.getHeight();if(p<8||p>144||p&1)throw new I;this.version=Yf.readVersion(h),this.mappingBitMatrix=this.extractDataRegion(h),this.readMappingMatrix=new U(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(h){const p=h.getHeight(),g=h.getWidth();return Jt.getVersionForDimensions(p,g)}readCodewords(){const h=new Int8Array(this.version.getTotalCodewords());let p=0,g=4,v=0;const N=this.mappingBitMatrix.getHeight(),S=this.mappingBitMatrix.getWidth();let E=!1,D=!1,$=!1,H=!1;do if(g===N&&v===0&&!E)h[p++]=this.readCorner1(N,S)&255,g-=2,v+=2,E=!0;else if(g===N-2&&v===0&&S&3&&!D)h[p++]=this.readCorner2(N,S)&255,g-=2,v+=2,D=!0;else if(g===N+4&&v===2&&!(S&7)&&!$)h[p++]=this.readCorner3(N,S)&255,g-=2,v+=2,$=!0;else if(g===N-2&&v===0&&(S&7)===4&&!H)h[p++]=this.readCorner4(N,S)&255,g-=2,v+=2,H=!0;else{do g<N&&v>=0&&!this.readMappingMatrix.get(v,g)&&(h[p++]=this.readUtah(g,v,N,S)&255),g-=2,v+=2;while(g>=0&&v<S);g+=1,v+=3;do g>=0&&v<S&&!this.readMappingMatrix.get(v,g)&&(h[p++]=this.readUtah(g,v,N,S)&255),g+=2,v-=2;while(g<N&&v>=0);g+=3,v+=1}while(g<N||v<S);if(p!==this.version.getTotalCodewords())throw new I;return h}readModule(h,p,g,v){return h<0&&(h+=g,p+=4-(g+4&7)),p<0&&(p+=v,h+=4-(v+4&7)),this.readMappingMatrix.set(p,h),this.mappingBitMatrix.get(p,h)}readUtah(h,p,g,v){let N=0;return this.readModule(h-2,p-2,g,v)&&(N|=1),N<<=1,this.readModule(h-2,p-1,g,v)&&(N|=1),N<<=1,this.readModule(h-1,p-2,g,v)&&(N|=1),N<<=1,this.readModule(h-1,p-1,g,v)&&(N|=1),N<<=1,this.readModule(h-1,p,g,v)&&(N|=1),N<<=1,this.readModule(h,p-2,g,v)&&(N|=1),N<<=1,this.readModule(h,p-1,g,v)&&(N|=1),N<<=1,this.readModule(h,p,g,v)&&(N|=1),N}readCorner1(h,p){let g=0;return this.readModule(h-1,0,h,p)&&(g|=1),g<<=1,this.readModule(h-1,1,h,p)&&(g|=1),g<<=1,this.readModule(h-1,2,h,p)&&(g|=1),g<<=1,this.readModule(0,p-2,h,p)&&(g|=1),g<<=1,this.readModule(0,p-1,h,p)&&(g|=1),g<<=1,this.readModule(1,p-1,h,p)&&(g|=1),g<<=1,this.readModule(2,p-1,h,p)&&(g|=1),g<<=1,this.readModule(3,p-1,h,p)&&(g|=1),g}readCorner2(h,p){let g=0;return this.readModule(h-3,0,h,p)&&(g|=1),g<<=1,this.readModule(h-2,0,h,p)&&(g|=1),g<<=1,this.readModule(h-1,0,h,p)&&(g|=1),g<<=1,this.readModule(0,p-4,h,p)&&(g|=1),g<<=1,this.readModule(0,p-3,h,p)&&(g|=1),g<<=1,this.readModule(0,p-2,h,p)&&(g|=1),g<<=1,this.readModule(0,p-1,h,p)&&(g|=1),g<<=1,this.readModule(1,p-1,h,p)&&(g|=1),g}readCorner3(h,p){let g=0;return this.readModule(h-1,0,h,p)&&(g|=1),g<<=1,this.readModule(h-1,p-1,h,p)&&(g|=1),g<<=1,this.readModule(0,p-3,h,p)&&(g|=1),g<<=1,this.readModule(0,p-2,h,p)&&(g|=1),g<<=1,this.readModule(0,p-1,h,p)&&(g|=1),g<<=1,this.readModule(1,p-3,h,p)&&(g|=1),g<<=1,this.readModule(1,p-2,h,p)&&(g|=1),g<<=1,this.readModule(1,p-1,h,p)&&(g|=1),g}readCorner4(h,p){let g=0;return this.readModule(h-3,0,h,p)&&(g|=1),g<<=1,this.readModule(h-2,0,h,p)&&(g|=1),g<<=1,this.readModule(h-1,0,h,p)&&(g|=1),g<<=1,this.readModule(0,p-2,h,p)&&(g|=1),g<<=1,this.readModule(0,p-1,h,p)&&(g|=1),g<<=1,this.readModule(1,p-1,h,p)&&(g|=1),g<<=1,this.readModule(2,p-1,h,p)&&(g|=1),g<<=1,this.readModule(3,p-1,h,p)&&(g|=1),g}extractDataRegion(h){const p=this.version.getSymbolSizeRows(),g=this.version.getSymbolSizeColumns();if(h.getHeight()!==p)throw new m("Dimension of bitMatrix must match the version size");const v=this.version.getDataRegionSizeRows(),N=this.version.getDataRegionSizeColumns(),S=p/v|0,E=g/N|0,D=S*v,$=E*N,H=new U($,D);for(let Y=0;Y<S;++Y){const Z=Y*v;for(let re=0;re<E;++re){const xe=re*N;for(let ve=0;ve<v;++ve){const Se=Y*(v+2)+1+ve,Me=Z+ve;for(let Xe=0;Xe<N;++Xe){const Ze=re*(N+2)+1+Xe;if(h.get(Ze,Se)){const He=xe+Xe;H.set(He,Me)}}}}}return H}}class Yo{constructor(h,p){this.numDataCodewords=h,this.codewords=p}static getDataBlocks(h,p){const g=p.getECBlocks();let v=0;const N=g.getECBlocks();for(let ve of N)v+=ve.getCount();const S=new Array(v);let E=0;for(let ve of N)for(let Se=0;Se<ve.getCount();Se++){const Me=ve.getDataCodewords(),Xe=g.getECCodewords()+Me;S[E++]=new Yo(Me,new Uint8Array(Xe))}const $=S[0].codewords.length-g.getECCodewords(),H=$-1;let Y=0;for(let ve=0;ve<H;ve++)for(let Se=0;Se<E;Se++)S[Se].codewords[ve]=h[Y++];const Z=p.getVersionNumber()===24,re=Z?8:E;for(let ve=0;ve<re;ve++)S[ve].codewords[$-1]=h[Y++];const xe=S[0].codewords.length;for(let ve=$;ve<xe;ve++)for(let Se=0;Se<E;Se++){const Me=Z?(Se+8)%E:Se,Xe=Z&&Me>7?ve-1:ve;S[Me].codewords[Xe]=h[Y++]}if(Y!==h.length)throw new m;return S}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class Xf{constructor(h){this.bytes=h,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(h){if(h<1||h>32||h>this.available())throw new m(""+h);let p=0,g=this.bitOffset,v=this.byteOffset;const N=this.bytes;if(g>0){const S=8-g,E=h<S?h:S,D=S-E,$=255>>8-E<<D;p=(N[v]&$)>>D,h-=E,g+=E,g===8&&(g=0,v++)}if(h>0){for(;h>=8;)p=p<<8|N[v]&255,v++,h-=8;if(h>0){const S=8-h,E=255>>S<<S;p=p<<h|(N[v]&E)>>S,g+=h}}return this.bitOffset=g,this.byteOffset=v,p}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var vn;(function(K){K[K.PAD_ENCODE=0]="PAD_ENCODE",K[K.ASCII_ENCODE=1]="ASCII_ENCODE",K[K.C40_ENCODE=2]="C40_ENCODE",K[K.TEXT_ENCODE=3]="TEXT_ENCODE",K[K.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",K[K.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",K[K.BASE256_ENCODE=6]="BASE256_ENCODE"})(vn||(vn={}));class Fi{static decode(h){const p=new Xf(h),g=new V,v=new V,N=new Array;let S=vn.ASCII_ENCODE;do if(S===vn.ASCII_ENCODE)S=this.decodeAsciiSegment(p,g,v);else{switch(S){case vn.C40_ENCODE:this.decodeC40Segment(p,g);break;case vn.TEXT_ENCODE:this.decodeTextSegment(p,g);break;case vn.ANSIX12_ENCODE:this.decodeAnsiX12Segment(p,g);break;case vn.EDIFACT_ENCODE:this.decodeEdifactSegment(p,g);break;case vn.BASE256_ENCODE:this.decodeBase256Segment(p,g,N);break;default:throw new I}S=vn.ASCII_ENCODE}while(S!==vn.PAD_ENCODE&&p.available()>0);return v.length()>0&&g.append(v.toString()),new ce(h,g.toString(),N.length===0?null:N,null)}static decodeAsciiSegment(h,p,g){let v=!1;do{let N=h.readBits(8);if(N===0)throw new I;if(N<=128)return v&&(N+=128),p.append(String.fromCharCode(N-1)),vn.ASCII_ENCODE;if(N===129)return vn.PAD_ENCODE;if(N<=229){const S=N-130;S<10&&p.append("0"),p.append(""+S)}else switch(N){case 230:return vn.C40_ENCODE;case 231:return vn.BASE256_ENCODE;case 232:p.append("");break;case 233:case 234:break;case 235:v=!0;break;case 236:p.append("[)>05"),g.insert(0,"");break;case 237:p.append("[)>06"),g.insert(0,"");break;case 238:return vn.ANSIX12_ENCODE;case 239:return vn.TEXT_ENCODE;case 240:return vn.EDIFACT_ENCODE;case 241:break;default:if(N!==254||h.available()!==0)throw new I;break}}while(h.available()>0);return vn.ASCII_ENCODE}static decodeC40Segment(h,p){let g=!1;const v=[];let N=0;do{if(h.available()===8)return;const S=h.readBits(8);if(S===254)return;this.parseTwoBytes(S,h.readBits(8),v);for(let E=0;E<3;E++){const D=v[E];switch(N){case 0:if(D<3)N=D+1;else if(D<this.C40_BASIC_SET_CHARS.length){const $=this.C40_BASIC_SET_CHARS[D];g?(p.append(String.fromCharCode($.charCodeAt(0)+128)),g=!1):p.append($)}else throw new I;break;case 1:g?(p.append(String.fromCharCode(D+128)),g=!1):p.append(String.fromCharCode(D)),N=0;break;case 2:if(D<this.C40_SHIFT2_SET_CHARS.length){const $=this.C40_SHIFT2_SET_CHARS[D];g?(p.append(String.fromCharCode($.charCodeAt(0)+128)),g=!1):p.append($)}else switch(D){case 27:p.append("");break;case 30:g=!0;break;default:throw new I}N=0;break;case 3:g?(p.append(String.fromCharCode(D+224)),g=!1):p.append(String.fromCharCode(D+96)),N=0;break;default:throw new I}}}while(h.available()>0)}static decodeTextSegment(h,p){let g=!1,v=[],N=0;do{if(h.available()===8)return;const S=h.readBits(8);if(S===254)return;this.parseTwoBytes(S,h.readBits(8),v);for(let E=0;E<3;E++){const D=v[E];switch(N){case 0:if(D<3)N=D+1;else if(D<this.TEXT_BASIC_SET_CHARS.length){const $=this.TEXT_BASIC_SET_CHARS[D];g?(p.append(String.fromCharCode($.charCodeAt(0)+128)),g=!1):p.append($)}else throw new I;break;case 1:g?(p.append(String.fromCharCode(D+128)),g=!1):p.append(String.fromCharCode(D)),N=0;break;case 2:if(D<this.TEXT_SHIFT2_SET_CHARS.length){const $=this.TEXT_SHIFT2_SET_CHARS[D];g?(p.append(String.fromCharCode($.charCodeAt(0)+128)),g=!1):p.append($)}else switch(D){case 27:p.append("");break;case 30:g=!0;break;default:throw new I}N=0;break;case 3:if(D<this.TEXT_SHIFT3_SET_CHARS.length){const $=this.TEXT_SHIFT3_SET_CHARS[D];g?(p.append(String.fromCharCode($.charCodeAt(0)+128)),g=!1):p.append($),N=0}else throw new I;break;default:throw new I}}}while(h.available()>0)}static decodeAnsiX12Segment(h,p){const g=[];do{if(h.available()===8)return;const v=h.readBits(8);if(v===254)return;this.parseTwoBytes(v,h.readBits(8),g);for(let N=0;N<3;N++){const S=g[N];switch(S){case 0:p.append("\r");break;case 1:p.append("*");break;case 2:p.append(">");break;case 3:p.append(" ");break;default:if(S<14)p.append(String.fromCharCode(S+44));else if(S<40)p.append(String.fromCharCode(S+51));else throw new I;break}}}while(h.available()>0)}static parseTwoBytes(h,p,g){let v=(h<<8)+p-1,N=Math.floor(v/1600);g[0]=N,v-=N*1600,N=Math.floor(v/40),g[1]=N,g[2]=v-N*40}static decodeEdifactSegment(h,p){do{if(h.available()<=16)return;for(let g=0;g<4;g++){let v=h.readBits(6);if(v===31){const N=8-h.getBitOffset();N!==8&&h.readBits(N);return}v&32||(v|=64),p.append(String.fromCharCode(v))}}while(h.available()>0)}static decodeBase256Segment(h,p,g){let v=1+h.getByteOffset();const N=this.unrandomize255State(h.readBits(8),v++);let S;if(N===0?S=h.available()/8|0:N<250?S=N:S=250*(N-249)+this.unrandomize255State(h.readBits(8),v++),S<0)throw new I;const E=new Uint8Array(S);for(let D=0;D<S;D++){if(h.available()<8)throw new I;E[D]=this.unrandomize255State(h.readBits(8),v++)}g.push(E);try{p.append(L.decode(E,F.ISO88591))}catch(D){throw new wt("Platform does not support required encoding: "+D.message)}}static unrandomize255State(h,p){const g=149*p%255+1,v=h-g;return v>=0?v:v+256}}Fi.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Fi.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Fi.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Fi.TEXT_SHIFT2_SET_CHARS=Fi.C40_SHIFT2_SET_CHARS,Fi.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class Nw{constructor(){this.rsDecoder=new mt(Ve.DATA_MATRIX_FIELD_256)}decode(h){const p=new Yf(h),g=p.getVersion(),v=p.readCodewords(),N=Yo.getDataBlocks(v,g);let S=0;for(let $ of N)S+=$.getNumDataCodewords();const E=new Uint8Array(S),D=N.length;for(let $=0;$<D;$++){const H=N[$],Y=H.getCodewords(),Z=H.getNumDataCodewords();this.correctErrors(Y,Z);for(let re=0;re<Z;re++)E[re*D+$]=Y[re]}return Fi.decode(E)}correctErrors(h,p){const g=new Int32Array(h);try{this.rsDecoder.decode(g,h.length-p)}catch{throw new b}for(let v=0;v<p;v++)h[v]=g[v]}}class Ns{constructor(h){this.image=h,this.rectangleDetector=new jt(this.image)}detect(){const h=this.rectangleDetector.detect();let p=this.detectSolid1(h);if(p=this.detectSolid2(p),p[3]=this.correctTopRight(p),!p[3])throw new z;p=this.shiftToModuleCenter(p);const g=p[0],v=p[1],N=p[2],S=p[3];let E=this.transitionsBetween(g,S)+1,D=this.transitionsBetween(N,S)+1;(E&1)===1&&(E+=1),(D&1)===1&&(D+=1),4*E<7*D&&4*D<7*E&&(E=D=Math.max(E,D));let $=Ns.sampleGrid(this.image,g,v,N,S,E,D);return new Ne($,[g,v,N,S])}static shiftPoint(h,p,g){let v=(p.getX()-h.getX())/(g+1),N=(p.getY()-h.getY())/(g+1);return new me(h.getX()+v,h.getY()+N)}static moveAway(h,p,g){let v=h.getX(),N=h.getY();return v<p?v-=1:v+=1,N<g?N-=1:N+=1,new me(v,N)}detectSolid1(h){let p=h[0],g=h[1],v=h[3],N=h[2],S=this.transitionsBetween(p,g),E=this.transitionsBetween(g,v),D=this.transitionsBetween(v,N),$=this.transitionsBetween(N,p),H=S,Y=[N,p,g,v];return H>E&&(H=E,Y[0]=p,Y[1]=g,Y[2]=v,Y[3]=N),H>D&&(H=D,Y[0]=g,Y[1]=v,Y[2]=N,Y[3]=p),H>$&&(Y[0]=v,Y[1]=N,Y[2]=p,Y[3]=g),Y}detectSolid2(h){let p=h[0],g=h[1],v=h[2],N=h[3],S=this.transitionsBetween(p,N),E=Ns.shiftPoint(g,v,(S+1)*4),D=Ns.shiftPoint(v,g,(S+1)*4),$=this.transitionsBetween(E,p),H=this.transitionsBetween(D,N);return $<H?(h[0]=p,h[1]=g,h[2]=v,h[3]=N):(h[0]=g,h[1]=v,h[2]=N,h[3]=p),h}correctTopRight(h){let p=h[0],g=h[1],v=h[2],N=h[3],S=this.transitionsBetween(p,N),E=this.transitionsBetween(g,N),D=Ns.shiftPoint(p,g,(E+1)*4),$=Ns.shiftPoint(v,g,(S+1)*4);S=this.transitionsBetween(D,N),E=this.transitionsBetween($,N);let H=new me(N.getX()+(v.getX()-g.getX())/(S+1),N.getY()+(v.getY()-g.getY())/(S+1)),Y=new me(N.getX()+(p.getX()-g.getX())/(E+1),N.getY()+(p.getY()-g.getY())/(E+1));if(!this.isValid(H))return this.isValid(Y)?Y:null;if(!this.isValid(Y))return H;let Z=this.transitionsBetween(D,H)+this.transitionsBetween($,H),re=this.transitionsBetween(D,Y)+this.transitionsBetween($,Y);return Z>re?H:Y}shiftToModuleCenter(h){let p=h[0],g=h[1],v=h[2],N=h[3],S=this.transitionsBetween(p,N)+1,E=this.transitionsBetween(v,N)+1,D=Ns.shiftPoint(p,g,E*4),$=Ns.shiftPoint(v,g,S*4);S=this.transitionsBetween(D,N)+1,E=this.transitionsBetween($,N)+1,(S&1)===1&&(S+=1),(E&1)===1&&(E+=1);let H=(p.getX()+g.getX()+v.getX()+N.getX())/4,Y=(p.getY()+g.getY()+v.getY()+N.getY())/4;p=Ns.moveAway(p,H,Y),g=Ns.moveAway(g,H,Y),v=Ns.moveAway(v,H,Y),N=Ns.moveAway(N,H,Y);let Z,re;return D=Ns.shiftPoint(p,g,E*4),D=Ns.shiftPoint(D,N,S*4),Z=Ns.shiftPoint(g,p,E*4),Z=Ns.shiftPoint(Z,v,S*4),$=Ns.shiftPoint(v,N,E*4),$=Ns.shiftPoint($,g,S*4),re=Ns.shiftPoint(N,v,E*4),re=Ns.shiftPoint(re,p,S*4),[D,Z,$,re]}isValid(h){return h.getX()>=0&&h.getX()<this.image.getWidth()&&h.getY()>0&&h.getY()<this.image.getHeight()}static sampleGrid(h,p,g,v,N,S,E){return hs.getInstance().sampleGrid(h,S,E,.5,.5,S-.5,.5,S-.5,E-.5,.5,E-.5,p.getX(),p.getY(),N.getX(),N.getY(),v.getX(),v.getY(),g.getX(),g.getY())}transitionsBetween(h,p){let g=Math.trunc(h.getX()),v=Math.trunc(h.getY()),N=Math.trunc(p.getX()),S=Math.trunc(p.getY()),E=Math.abs(S-v)>Math.abs(N-g);if(E){let ve=g;g=v,v=ve,ve=N,N=S,S=ve}let D=Math.abs(N-g),$=Math.abs(S-v),H=-D/2,Y=v<S?1:-1,Z=g<N?1:-1,re=0,xe=this.image.get(E?v:g,E?g:v);for(let ve=g,Se=v;ve!==N;ve+=Z){let Me=this.image.get(E?Se:ve,E?ve:Se);if(Me!==xe&&(re++,xe=Me),H+=$,H>0){if(Se===S)break;Se+=Y,H-=D}}return re}}class Q{constructor(){this.decoder=new Nw}decode(h,p=null){let g,v;if(p!=null&&p.has(R.PURE_BARCODE)){const $=Q.extractPureBits(h.getBlackMatrix());g=this.decoder.decode($),v=Q.NO_POINTS}else{const $=new Ns(h.getBlackMatrix()).detect();g=this.decoder.decode($.getBits()),v=$.getPoints()}const N=g.getRawBytes(),S=new ue(g.getText(),N,8*N.length,v,X.DATA_MATRIX,j.currentTimeMillis()),E=g.getByteSegments();E!=null&&S.putMetadata(_e.BYTE_SEGMENTS,E);const D=g.getECLevel();return D!=null&&S.putMetadata(_e.ERROR_CORRECTION_LEVEL,D),S}reset(){}static extractPureBits(h){const p=h.getTopLeftOnBit(),g=h.getBottomRightOnBit();if(p==null||g==null)throw new z;const v=this.moduleSize(p,h);let N=p[1];const S=g[1];let E=p[0];const $=(g[0]-E+1)/v,H=(S-N+1)/v;if($<=0||H<=0)throw new z;const Y=v/2;N+=Y,E+=Y;const Z=new U($,H);for(let re=0;re<H;re++){const xe=N+re*v;for(let ve=0;ve<$;ve++)h.get(E+ve*v,xe)&&Z.set(ve,re)}return Z}static moduleSize(h,p){const g=p.getWidth();let v=h[0];const N=h[1];for(;v<g&&p.get(v,N);)v++;if(v===g)throw new z;const S=v-h[0];if(S===0)throw new z;return S}}Q.NO_POINTS=[];class Ce extends pe{constructor(h=500){super(new Q,h)}}var Oe;(function(K){K[K.L=0]="L",K[K.M=1]="M",K[K.Q=2]="Q",K[K.H=3]="H"})(Oe||(Oe={}));class ot{constructor(h,p,g){this.value=h,this.stringValue=p,this.bits=g,ot.FOR_BITS.set(g,this),ot.FOR_VALUE.set(h,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(h){switch(h){case"L":return ot.L;case"M":return ot.M;case"Q":return ot.Q;case"H":return ot.H;default:throw new f(h+"not available")}}toString(){return this.stringValue}equals(h){if(!(h instanceof ot))return!1;const p=h;return this.value===p.value}static forBits(h){if(h<0||h>=ot.FOR_BITS.size)throw new m;return ot.FOR_BITS.get(h)}}ot.FOR_BITS=new Map,ot.FOR_VALUE=new Map,ot.L=new ot(Oe.L,"L",1),ot.M=new ot(Oe.M,"M",0),ot.Q=new ot(Oe.Q,"Q",3),ot.H=new ot(Oe.H,"H",2);class Ft{constructor(h){this.errorCorrectionLevel=ot.forBits(h>>3&3),this.dataMask=h&7}static numBitsDiffering(h,p){return A.bitCount(h^p)}static decodeFormatInformation(h,p){const g=Ft.doDecodeFormatInformation(h,p);return g!==null?g:Ft.doDecodeFormatInformation(h^Ft.FORMAT_INFO_MASK_QR,p^Ft.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(h,p){let g=Number.MAX_SAFE_INTEGER,v=0;for(const N of Ft.FORMAT_INFO_DECODE_LOOKUP){const S=N[0];if(S===h||S===p)return new Ft(N[1]);let E=Ft.numBitsDiffering(h,S);E<g&&(v=N[1],g=E),h!==p&&(E=Ft.numBitsDiffering(p,S),E<g&&(v=N[1],g=E))}return g<=3?new Ft(v):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(h){if(!(h instanceof Ft))return!1;const p=h;return this.errorCorrectionLevel===p.errorCorrectionLevel&&this.dataMask===p.dataMask}}Ft.FORMAT_INFO_MASK_QR=21522,Ft.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class je{constructor(h,...p){this.ecCodewordsPerBlock=h,this.ecBlocks=p}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let h=0;const p=this.ecBlocks;for(const g of p)h+=g.getCount();return h}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class te{constructor(h,p){this.count=h,this.dataCodewords=p}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class St{constructor(h,p,...g){this.versionNumber=h,this.alignmentPatternCenters=p,this.ecBlocks=g;let v=0;const N=g[0].getECCodewordsPerBlock(),S=g[0].getECBlocks();for(const E of S)v+=E.getCount()*(E.getDataCodewords()+N);this.totalCodewords=v}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(h){return this.ecBlocks[h.getValue()]}static getProvisionalVersionForDimension(h){if(h%4!==1)throw new I;try{return this.getVersionForNumber((h-17)/4)}catch{throw new I}}static getVersionForNumber(h){if(h<1||h>40)throw new m;return St.VERSIONS[h-1]}static decodeVersionInformation(h){let p=Number.MAX_SAFE_INTEGER,g=0;for(let v=0;v<St.VERSION_DECODE_INFO.length;v++){const N=St.VERSION_DECODE_INFO[v];if(N===h)return St.getVersionForNumber(v+7);const S=Ft.numBitsDiffering(h,N);S<p&&(g=v+7,p=S)}return p<=3?St.getVersionForNumber(g):null}buildFunctionPattern(){const h=this.getDimensionForVersion(),p=new U(h);p.setRegion(0,0,9,9),p.setRegion(h-8,0,8,9),p.setRegion(0,h-8,9,8);const g=this.alignmentPatternCenters.length;for(let v=0;v<g;v++){const N=this.alignmentPatternCenters[v]-2;for(let S=0;S<g;S++)v===0&&(S===0||S===g-1)||v===g-1&&S===0||p.setRegion(this.alignmentPatternCenters[S]-2,N,5,5)}return p.setRegion(6,9,1,h-17),p.setRegion(9,6,h-17,1),this.versionNumber>6&&(p.setRegion(h-11,0,3,6),p.setRegion(0,h-11,6,3)),p}toString(){return""+this.versionNumber}}St.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),St.VERSIONS=[new St(1,new Int32Array(0),new je(7,new te(1,19)),new je(10,new te(1,16)),new je(13,new te(1,13)),new je(17,new te(1,9))),new St(2,Int32Array.from([6,18]),new je(10,new te(1,34)),new je(16,new te(1,28)),new je(22,new te(1,22)),new je(28,new te(1,16))),new St(3,Int32Array.from([6,22]),new je(15,new te(1,55)),new je(26,new te(1,44)),new je(18,new te(2,17)),new je(22,new te(2,13))),new St(4,Int32Array.from([6,26]),new je(20,new te(1,80)),new je(18,new te(2,32)),new je(26,new te(2,24)),new je(16,new te(4,9))),new St(5,Int32Array.from([6,30]),new je(26,new te(1,108)),new je(24,new te(2,43)),new je(18,new te(2,15),new te(2,16)),new je(22,new te(2,11),new te(2,12))),new St(6,Int32Array.from([6,34]),new je(18,new te(2,68)),new je(16,new te(4,27)),new je(24,new te(4,19)),new je(28,new te(4,15))),new St(7,Int32Array.from([6,22,38]),new je(20,new te(2,78)),new je(18,new te(4,31)),new je(18,new te(2,14),new te(4,15)),new je(26,new te(4,13),new te(1,14))),new St(8,Int32Array.from([6,24,42]),new je(24,new te(2,97)),new je(22,new te(2,38),new te(2,39)),new je(22,new te(4,18),new te(2,19)),new je(26,new te(4,14),new te(2,15))),new St(9,Int32Array.from([6,26,46]),new je(30,new te(2,116)),new je(22,new te(3,36),new te(2,37)),new je(20,new te(4,16),new te(4,17)),new je(24,new te(4,12),new te(4,13))),new St(10,Int32Array.from([6,28,50]),new je(18,new te(2,68),new te(2,69)),new je(26,new te(4,43),new te(1,44)),new je(24,new te(6,19),new te(2,20)),new je(28,new te(6,15),new te(2,16))),new St(11,Int32Array.from([6,30,54]),new je(20,new te(4,81)),new je(30,new te(1,50),new te(4,51)),new je(28,new te(4,22),new te(4,23)),new je(24,new te(3,12),new te(8,13))),new St(12,Int32Array.from([6,32,58]),new je(24,new te(2,92),new te(2,93)),new je(22,new te(6,36),new te(2,37)),new je(26,new te(4,20),new te(6,21)),new je(28,new te(7,14),new te(4,15))),new St(13,Int32Array.from([6,34,62]),new je(26,new te(4,107)),new je(22,new te(8,37),new te(1,38)),new je(24,new te(8,20),new te(4,21)),new je(22,new te(12,11),new te(4,12))),new St(14,Int32Array.from([6,26,46,66]),new je(30,new te(3,115),new te(1,116)),new je(24,new te(4,40),new te(5,41)),new je(20,new te(11,16),new te(5,17)),new je(24,new te(11,12),new te(5,13))),new St(15,Int32Array.from([6,26,48,70]),new je(22,new te(5,87),new te(1,88)),new je(24,new te(5,41),new te(5,42)),new je(30,new te(5,24),new te(7,25)),new je(24,new te(11,12),new te(7,13))),new St(16,Int32Array.from([6,26,50,74]),new je(24,new te(5,98),new te(1,99)),new je(28,new te(7,45),new te(3,46)),new je(24,new te(15,19),new te(2,20)),new je(30,new te(3,15),new te(13,16))),new St(17,Int32Array.from([6,30,54,78]),new je(28,new te(1,107),new te(5,108)),new je(28,new te(10,46),new te(1,47)),new je(28,new te(1,22),new te(15,23)),new je(28,new te(2,14),new te(17,15))),new St(18,Int32Array.from([6,30,56,82]),new je(30,new te(5,120),new te(1,121)),new je(26,new te(9,43),new te(4,44)),new je(28,new te(17,22),new te(1,23)),new je(28,new te(2,14),new te(19,15))),new St(19,Int32Array.from([6,30,58,86]),new je(28,new te(3,113),new te(4,114)),new je(26,new te(3,44),new te(11,45)),new je(26,new te(17,21),new te(4,22)),new je(26,new te(9,13),new te(16,14))),new St(20,Int32Array.from([6,34,62,90]),new je(28,new te(3,107),new te(5,108)),new je(26,new te(3,41),new te(13,42)),new je(30,new te(15,24),new te(5,25)),new je(28,new te(15,15),new te(10,16))),new St(21,Int32Array.from([6,28,50,72,94]),new je(28,new te(4,116),new te(4,117)),new je(26,new te(17,42)),new je(28,new te(17,22),new te(6,23)),new je(30,new te(19,16),new te(6,17))),new St(22,Int32Array.from([6,26,50,74,98]),new je(28,new te(2,111),new te(7,112)),new je(28,new te(17,46)),new je(30,new te(7,24),new te(16,25)),new je(24,new te(34,13))),new St(23,Int32Array.from([6,30,54,78,102]),new je(30,new te(4,121),new te(5,122)),new je(28,new te(4,47),new te(14,48)),new je(30,new te(11,24),new te(14,25)),new je(30,new te(16,15),new te(14,16))),new St(24,Int32Array.from([6,28,54,80,106]),new je(30,new te(6,117),new te(4,118)),new je(28,new te(6,45),new te(14,46)),new je(30,new te(11,24),new te(16,25)),new je(30,new te(30,16),new te(2,17))),new St(25,Int32Array.from([6,32,58,84,110]),new je(26,new te(8,106),new te(4,107)),new je(28,new te(8,47),new te(13,48)),new je(30,new te(7,24),new te(22,25)),new je(30,new te(22,15),new te(13,16))),new St(26,Int32Array.from([6,30,58,86,114]),new je(28,new te(10,114),new te(2,115)),new je(28,new te(19,46),new te(4,47)),new je(28,new te(28,22),new te(6,23)),new je(30,new te(33,16),new te(4,17))),new St(27,Int32Array.from([6,34,62,90,118]),new je(30,new te(8,122),new te(4,123)),new je(28,new te(22,45),new te(3,46)),new je(30,new te(8,23),new te(26,24)),new je(30,new te(12,15),new te(28,16))),new St(28,Int32Array.from([6,26,50,74,98,122]),new je(30,new te(3,117),new te(10,118)),new je(28,new te(3,45),new te(23,46)),new je(30,new te(4,24),new te(31,25)),new je(30,new te(11,15),new te(31,16))),new St(29,Int32Array.from([6,30,54,78,102,126]),new je(30,new te(7,116),new te(7,117)),new je(28,new te(21,45),new te(7,46)),new je(30,new te(1,23),new te(37,24)),new je(30,new te(19,15),new te(26,16))),new St(30,Int32Array.from([6,26,52,78,104,130]),new je(30,new te(5,115),new te(10,116)),new je(28,new te(19,47),new te(10,48)),new je(30,new te(15,24),new te(25,25)),new je(30,new te(23,15),new te(25,16))),new St(31,Int32Array.from([6,30,56,82,108,134]),new je(30,new te(13,115),new te(3,116)),new je(28,new te(2,46),new te(29,47)),new je(30,new te(42,24),new te(1,25)),new je(30,new te(23,15),new te(28,16))),new St(32,Int32Array.from([6,34,60,86,112,138]),new je(30,new te(17,115)),new je(28,new te(10,46),new te(23,47)),new je(30,new te(10,24),new te(35,25)),new je(30,new te(19,15),new te(35,16))),new St(33,Int32Array.from([6,30,58,86,114,142]),new je(30,new te(17,115),new te(1,116)),new je(28,new te(14,46),new te(21,47)),new je(30,new te(29,24),new te(19,25)),new je(30,new te(11,15),new te(46,16))),new St(34,Int32Array.from([6,34,62,90,118,146]),new je(30,new te(13,115),new te(6,116)),new je(28,new te(14,46),new te(23,47)),new je(30,new te(44,24),new te(7,25)),new je(30,new te(59,16),new te(1,17))),new St(35,Int32Array.from([6,30,54,78,102,126,150]),new je(30,new te(12,121),new te(7,122)),new je(28,new te(12,47),new te(26,48)),new je(30,new te(39,24),new te(14,25)),new je(30,new te(22,15),new te(41,16))),new St(36,Int32Array.from([6,24,50,76,102,128,154]),new je(30,new te(6,121),new te(14,122)),new je(28,new te(6,47),new te(34,48)),new je(30,new te(46,24),new te(10,25)),new je(30,new te(2,15),new te(64,16))),new St(37,Int32Array.from([6,28,54,80,106,132,158]),new je(30,new te(17,122),new te(4,123)),new je(28,new te(29,46),new te(14,47)),new je(30,new te(49,24),new te(10,25)),new je(30,new te(24,15),new te(46,16))),new St(38,Int32Array.from([6,32,58,84,110,136,162]),new je(30,new te(4,122),new te(18,123)),new je(28,new te(13,46),new te(32,47)),new je(30,new te(48,24),new te(14,25)),new je(30,new te(42,15),new te(32,16))),new St(39,Int32Array.from([6,26,54,82,110,138,166]),new je(30,new te(20,117),new te(4,118)),new je(28,new te(40,47),new te(7,48)),new je(30,new te(43,24),new te(22,25)),new je(30,new te(10,15),new te(67,16))),new St(40,Int32Array.from([6,30,58,86,114,142,170]),new je(30,new te(19,118),new te(6,119)),new je(28,new te(18,47),new te(31,48)),new je(30,new te(34,24),new te(34,25)),new je(30,new te(20,15),new te(61,16)))];var ir;(function(K){K[K.DATA_MASK_000=0]="DATA_MASK_000",K[K.DATA_MASK_001=1]="DATA_MASK_001",K[K.DATA_MASK_010=2]="DATA_MASK_010",K[K.DATA_MASK_011=3]="DATA_MASK_011",K[K.DATA_MASK_100=4]="DATA_MASK_100",K[K.DATA_MASK_101=5]="DATA_MASK_101",K[K.DATA_MASK_110=6]="DATA_MASK_110",K[K.DATA_MASK_111=7]="DATA_MASK_111"})(ir||(ir={}));class ci{constructor(h,p){this.value=h,this.isMasked=p}unmaskBitMatrix(h,p){for(let g=0;g<p;g++)for(let v=0;v<p;v++)this.isMasked(g,v)&&h.flip(v,g)}}ci.values=new Map([[ir.DATA_MASK_000,new ci(ir.DATA_MASK_000,(K,h)=>(K+h&1)===0)],[ir.DATA_MASK_001,new ci(ir.DATA_MASK_001,(K,h)=>(K&1)===0)],[ir.DATA_MASK_010,new ci(ir.DATA_MASK_010,(K,h)=>h%3===0)],[ir.DATA_MASK_011,new ci(ir.DATA_MASK_011,(K,h)=>(K+h)%3===0)],[ir.DATA_MASK_100,new ci(ir.DATA_MASK_100,(K,h)=>(Math.floor(K/2)+Math.floor(h/3)&1)===0)],[ir.DATA_MASK_101,new ci(ir.DATA_MASK_101,(K,h)=>K*h%6===0)],[ir.DATA_MASK_110,new ci(ir.DATA_MASK_110,(K,h)=>K*h%6<3)],[ir.DATA_MASK_111,new ci(ir.DATA_MASK_111,(K,h)=>(K+h+K*h%3&1)===0)]]);class PK{constructor(h){const p=h.getHeight();if(p<21||(p&3)!==1)throw new I;this.bitMatrix=h}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let h=0;for(let N=0;N<6;N++)h=this.copyBit(N,8,h);h=this.copyBit(7,8,h),h=this.copyBit(8,8,h),h=this.copyBit(8,7,h);for(let N=5;N>=0;N--)h=this.copyBit(8,N,h);const p=this.bitMatrix.getHeight();let g=0;const v=p-7;for(let N=p-1;N>=v;N--)g=this.copyBit(8,N,g);for(let N=p-8;N<p;N++)g=this.copyBit(N,8,g);if(this.parsedFormatInfo=Ft.decodeFormatInformation(h,g),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new I}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const h=this.bitMatrix.getHeight(),p=Math.floor((h-17)/4);if(p<=6)return St.getVersionForNumber(p);let g=0;const v=h-11;for(let S=5;S>=0;S--)for(let E=h-9;E>=v;E--)g=this.copyBit(E,S,g);let N=St.decodeVersionInformation(g);if(N!==null&&N.getDimensionForVersion()===h)return this.parsedVersion=N,N;g=0;for(let S=5;S>=0;S--)for(let E=h-9;E>=v;E--)g=this.copyBit(S,E,g);if(N=St.decodeVersionInformation(g),N!==null&&N.getDimensionForVersion()===h)return this.parsedVersion=N,N;throw new I}copyBit(h,p,g){return(this.isMirror?this.bitMatrix.get(p,h):this.bitMatrix.get(h,p))?g<<1|1:g<<1}readCodewords(){const h=this.readFormatInformation(),p=this.readVersion(),g=ci.values.get(h.getDataMask()),v=this.bitMatrix.getHeight();g.unmaskBitMatrix(this.bitMatrix,v);const N=p.buildFunctionPattern();let S=!0;const E=new Uint8Array(p.getTotalCodewords());let D=0,$=0,H=0;for(let Y=v-1;Y>0;Y-=2){Y===6&&Y--;for(let Z=0;Z<v;Z++){const re=S?v-1-Z:Z;for(let xe=0;xe<2;xe++)N.get(Y-xe,re)||(H++,$<<=1,this.bitMatrix.get(Y-xe,re)&&($|=1),H===8&&(E[D++]=$,H=0,$=0))}S=!S}if(D!==p.getTotalCodewords())throw new I;return E}remask(){if(this.parsedFormatInfo===null)return;const h=ci.values[this.parsedFormatInfo.getDataMask()],p=this.bitMatrix.getHeight();h.unmaskBitMatrix(this.bitMatrix,p)}setMirror(h){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=h}mirror(){const h=this.bitMatrix;for(let p=0,g=h.getWidth();p<g;p++)for(let v=p+1,N=h.getHeight();v<N;v++)h.get(p,v)!==h.get(v,p)&&(h.flip(v,p),h.flip(p,v))}}class jw{constructor(h,p){this.numDataCodewords=h,this.codewords=p}static getDataBlocks(h,p,g){if(h.length!==p.getTotalCodewords())throw new m;const v=p.getECBlocksForLevel(g);let N=0;const S=v.getECBlocks();for(const xe of S)N+=xe.getCount();const E=new Array(N);let D=0;for(const xe of S)for(let ve=0;ve<xe.getCount();ve++){const Se=xe.getDataCodewords(),Me=v.getECCodewordsPerBlock()+Se;E[D++]=new jw(Se,new Uint8Array(Me))}const $=E[0].codewords.length;let H=E.length-1;for(;H>=0&&E[H].codewords.length!==$;)H--;H++;const Y=$-v.getECCodewordsPerBlock();let Z=0;for(let xe=0;xe<Y;xe++)for(let ve=0;ve<D;ve++)E[ve].codewords[xe]=h[Z++];for(let xe=H;xe<D;xe++)E[xe].codewords[Y]=h[Z++];const re=E[0].codewords.length;for(let xe=Y;xe<re;xe++)for(let ve=0;ve<D;ve++){const Se=ve<H?xe:xe+1;E[ve].codewords[Se]=h[Z++]}return E}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var di;(function(K){K[K.TERMINATOR=0]="TERMINATOR",K[K.NUMERIC=1]="NUMERIC",K[K.ALPHANUMERIC=2]="ALPHANUMERIC",K[K.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",K[K.BYTE=4]="BYTE",K[K.ECI=5]="ECI",K[K.KANJI=6]="KANJI",K[K.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",K[K.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",K[K.HANZI=9]="HANZI"})(di||(di={}));class At{constructor(h,p,g,v){this.value=h,this.stringValue=p,this.characterCountBitsForVersions=g,this.bits=v,At.FOR_BITS.set(v,this),At.FOR_VALUE.set(h,this)}static forBits(h){const p=At.FOR_BITS.get(h);if(p===void 0)throw new m;return p}getCharacterCountBits(h){const p=h.getVersionNumber();let g;return p<=9?g=0:p<=26?g=1:g=2,this.characterCountBitsForVersions[g]}getValue(){return this.value}getBits(){return this.bits}equals(h){if(!(h instanceof At))return!1;const p=h;return this.value===p.value}toString(){return this.stringValue}}At.FOR_BITS=new Map,At.FOR_VALUE=new Map,At.TERMINATOR=new At(di.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),At.NUMERIC=new At(di.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),At.ALPHANUMERIC=new At(di.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),At.STRUCTURED_APPEND=new At(di.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),At.BYTE=new At(di.BYTE,"BYTE",Int32Array.from([8,16,16]),4),At.ECI=new At(di.ECI,"ECI",Int32Array.from([0,0,0]),7),At.KANJI=new At(di.KANJI,"KANJI",Int32Array.from([8,10,12]),8),At.FNC1_FIRST_POSITION=new At(di.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),At.FNC1_SECOND_POSITION=new At(di.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),At.HANZI=new At(di.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class Zs{static decode(h,p,g,v){const N=new Xf(h);let S=new V;const E=new Array;let D=-1,$=-1;try{let H=null,Y=!1,Z;do{if(N.available()<4)Z=At.TERMINATOR;else{const re=N.readBits(4);Z=At.forBits(re)}switch(Z){case At.TERMINATOR:break;case At.FNC1_FIRST_POSITION:case At.FNC1_SECOND_POSITION:Y=!0;break;case At.STRUCTURED_APPEND:if(N.available()<16)throw new I;D=N.readBits(8),$=N.readBits(8);break;case At.ECI:const re=Zs.parseECIValue(N);if(H=M.getCharacterSetECIByValue(re),H===null)throw new I;break;case At.HANZI:const xe=N.readBits(4),ve=N.readBits(Z.getCharacterCountBits(p));xe===Zs.GB2312_SUBSET&&Zs.decodeHanziSegment(N,S,ve);break;default:const Se=N.readBits(Z.getCharacterCountBits(p));switch(Z){case At.NUMERIC:Zs.decodeNumericSegment(N,S,Se);break;case At.ALPHANUMERIC:Zs.decodeAlphanumericSegment(N,S,Se,Y);break;case At.BYTE:Zs.decodeByteSegment(N,S,Se,H,E,v);break;case At.KANJI:Zs.decodeKanjiSegment(N,S,Se);break;default:throw new I}break}}while(Z!==At.TERMINATOR)}catch{throw new I}return new ce(h,S.toString(),E.length===0?null:E,g===null?null:g.toString(),D,$)}static decodeHanziSegment(h,p,g){if(g*13>h.available())throw new I;const v=new Uint8Array(2*g);let N=0;for(;g>0;){const S=h.readBits(13);let E=S/96<<8&4294967295|S%96;E<959?E+=41377:E+=42657,v[N]=E>>8&255,v[N+1]=E&255,N+=2,g--}try{p.append(L.decode(v,F.GB2312))}catch(S){throw new I(S)}}static decodeKanjiSegment(h,p,g){if(g*13>h.available())throw new I;const v=new Uint8Array(2*g);let N=0;for(;g>0;){const S=h.readBits(13);let E=S/192<<8&4294967295|S%192;E<7936?E+=33088:E+=49472,v[N]=E>>8,v[N+1]=E,N+=2,g--}try{p.append(L.decode(v,F.SHIFT_JIS))}catch(S){throw new I(S)}}static decodeByteSegment(h,p,g,v,N,S){if(8*g>h.available())throw new I;const E=new Uint8Array(g);for(let $=0;$<g;$++)E[$]=h.readBits(8);let D;v===null?D=F.guessEncoding(E,S):D=v.getName();try{p.append(L.decode(E,D))}catch($){throw new I($)}N.push(E)}static toAlphaNumericChar(h){if(h>=Zs.ALPHANUMERIC_CHARS.length)throw new I;return Zs.ALPHANUMERIC_CHARS[h]}static decodeAlphanumericSegment(h,p,g,v){const N=p.length();for(;g>1;){if(h.available()<11)throw new I;const S=h.readBits(11);p.append(Zs.toAlphaNumericChar(Math.floor(S/45))),p.append(Zs.toAlphaNumericChar(S%45)),g-=2}if(g===1){if(h.available()<6)throw new I;p.append(Zs.toAlphaNumericChar(h.readBits(6)))}if(v)for(let S=N;S<p.length();S++)p.charAt(S)==="%"&&(S<p.length()-1&&p.charAt(S+1)==="%"?p.deleteCharAt(S+1):p.setCharAt(S,""))}static decodeNumericSegment(h,p,g){for(;g>=3;){if(h.available()<10)throw new I;const v=h.readBits(10);if(v>=1e3)throw new I;p.append(Zs.toAlphaNumericChar(Math.floor(v/100))),p.append(Zs.toAlphaNumericChar(Math.floor(v/10)%10)),p.append(Zs.toAlphaNumericChar(v%10)),g-=3}if(g===2){if(h.available()<7)throw new I;const v=h.readBits(7);if(v>=100)throw new I;p.append(Zs.toAlphaNumericChar(Math.floor(v/10))),p.append(Zs.toAlphaNumericChar(v%10))}else if(g===1){if(h.available()<4)throw new I;const v=h.readBits(4);if(v>=10)throw new I;p.append(Zs.toAlphaNumericChar(v))}}static parseECIValue(h){const p=h.readBits(8);if(!(p&128))return p&127;if((p&192)===128){const g=h.readBits(8);return(p&63)<<8&4294967295|g}if((p&224)===192){const g=h.readBits(16);return(p&31)<<16&4294967295|g}throw new I}}Zs.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",Zs.GB2312_SUBSET=1;class mE{constructor(h){this.mirrored=h}isMirrored(){return this.mirrored}applyMirroredCorrection(h){if(!this.mirrored||h===null||h.length<3)return;const p=h[0];h[0]=h[2],h[2]=p}}class IK{constructor(){this.rsDecoder=new mt(Ve.QR_CODE_FIELD_256)}decodeBooleanArray(h,p){return this.decodeBitMatrix(U.parseFromBooleanArray(h),p)}decodeBitMatrix(h,p){const g=new PK(h);let v=null;try{return this.decodeBitMatrixParser(g,p)}catch(N){v=N}try{g.remask(),g.setMirror(!0),g.readVersion(),g.readFormatInformation(),g.mirror();const N=this.decodeBitMatrixParser(g,p);return N.setOther(new mE(!0)),N}catch(N){throw v!==null?v:N}}decodeBitMatrixParser(h,p){const g=h.readVersion(),v=h.readFormatInformation().getErrorCorrectionLevel(),N=h.readCodewords(),S=jw.getDataBlocks(N,g,v);let E=0;for(const H of S)E+=H.getNumDataCodewords();const D=new Uint8Array(E);let $=0;for(const H of S){const Y=H.getCodewords(),Z=H.getNumDataCodewords();this.correctErrors(Y,Z);for(let re=0;re<Z;re++)D[$++]=Y[re]}return Zs.decode(D,g,v,p)}correctErrors(h,p){const g=new Int32Array(h);try{this.rsDecoder.decode(g,h.length-p)}catch{throw new b}for(let v=0;v<p;v++)h[v]=g[v]}}class _w extends me{constructor(h,p,g){super(h,p),this.estimatedModuleSize=g}aboutEquals(h,p,g){if(Math.abs(p-this.getY())<=h&&Math.abs(g-this.getX())<=h){const v=Math.abs(h-this.estimatedModuleSize);return v<=1||v<=this.estimatedModuleSize}return!1}combineEstimate(h,p,g){const v=(this.getX()+p)/2,N=(this.getY()+h)/2,S=(this.estimatedModuleSize+g)/2;return new _w(v,N,S)}}class Xx{constructor(h,p,g,v,N,S,E){this.image=h,this.startX=p,this.startY=g,this.width=v,this.height=N,this.moduleSize=S,this.resultPointCallback=E,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const h=this.startX,p=this.height,g=this.width,v=h+g,N=this.startY+p/2,S=new Int32Array(3),E=this.image;for(let D=0;D<p;D++){const $=N+(D&1?-Math.floor((D+1)/2):Math.floor((D+1)/2));S[0]=0,S[1]=0,S[2]=0;let H=h;for(;H<v&&!E.get(H,$);)H++;let Y=0;for(;H<v;){if(E.get(H,$))if(Y===1)S[1]++;else if(Y===2){if(this.foundPatternCross(S)){const Z=this.handlePossibleCenter(S,$,H);if(Z!==null)return Z}S[0]=S[2],S[1]=1,S[2]=0,Y=1}else S[++Y]++;else Y===1&&Y++,S[Y]++;H++}if(this.foundPatternCross(S)){const Z=this.handlePossibleCenter(S,$,v);if(Z!==null)return Z}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new z}static centerFromEnd(h,p){return p-h[2]-h[1]/2}foundPatternCross(h){const p=this.moduleSize,g=p/2;for(let v=0;v<3;v++)if(Math.abs(p-h[v])>=g)return!1;return!0}crossCheckVertical(h,p,g,v){const N=this.image,S=N.getHeight(),E=this.crossCheckStateCount;E[0]=0,E[1]=0,E[2]=0;let D=h;for(;D>=0&&N.get(p,D)&&E[1]<=g;)E[1]++,D--;if(D<0||E[1]>g)return NaN;for(;D>=0&&!N.get(p,D)&&E[0]<=g;)E[0]++,D--;if(E[0]>g)return NaN;for(D=h+1;D<S&&N.get(p,D)&&E[1]<=g;)E[1]++,D++;if(D===S||E[1]>g)return NaN;for(;D<S&&!N.get(p,D)&&E[2]<=g;)E[2]++,D++;if(E[2]>g)return NaN;const $=E[0]+E[1]+E[2];return 5*Math.abs($-v)>=2*v?NaN:this.foundPatternCross(E)?Xx.centerFromEnd(E,D):NaN}handlePossibleCenter(h,p,g){const v=h[0]+h[1]+h[2],N=Xx.centerFromEnd(h,g),S=this.crossCheckVertical(p,N,2*h[1],v);if(!isNaN(S)){const E=(h[0]+h[1]+h[2])/3;for(const $ of this.possibleCenters)if($.aboutEquals(E,S,N))return $.combineEstimate(S,N,E);const D=new _w(N,S,E);this.possibleCenters.push(D),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(D)}return null}}class Sw extends me{constructor(h,p,g,v){super(h,p),this.estimatedModuleSize=g,this.count=v,v===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(h,p,g){if(Math.abs(p-this.getY())<=h&&Math.abs(g-this.getX())<=h){const v=Math.abs(h-this.estimatedModuleSize);return v<=1||v<=this.estimatedModuleSize}return!1}combineEstimate(h,p,g){const v=this.count+1,N=(this.count*this.getX()+p)/v,S=(this.count*this.getY()+h)/v,E=(this.count*this.estimatedModuleSize+g)/v;return new Sw(N,S,E,v)}}class MK{constructor(h){this.bottomLeft=h[0],this.topLeft=h[1],this.topRight=h[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class lr{constructor(h,p){this.image=h,this.resultPointCallback=p,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=p}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(h){const p=h!=null&&h.get(R.TRY_HARDER)!==void 0,g=h!=null&&h.get(R.PURE_BARCODE)!==void 0,v=this.image,N=v.getHeight(),S=v.getWidth();let E=Math.floor(3*N/(4*lr.MAX_MODULES));(E<lr.MIN_SKIP||p)&&(E=lr.MIN_SKIP);let D=!1;const $=new Int32Array(5);for(let Y=E-1;Y<N&&!D;Y+=E){$[0]=0,$[1]=0,$[2]=0,$[3]=0,$[4]=0;let Z=0;for(let re=0;re<S;re++)if(v.get(re,Y))(Z&1)===1&&Z++,$[Z]++;else if(Z&1)$[Z]++;else if(Z===4)if(lr.foundPatternCross($)){if(this.handlePossibleCenter($,Y,re,g)===!0)if(E=2,this.hasSkipped===!0)D=this.haveMultiplyConfirmedCenters();else{const ve=this.findRowSkip();ve>$[2]&&(Y+=ve-$[2]-E,re=S-1)}else{$[0]=$[2],$[1]=$[3],$[2]=$[4],$[3]=1,$[4]=0,Z=3;continue}Z=0,$[0]=0,$[1]=0,$[2]=0,$[3]=0,$[4]=0}else $[0]=$[2],$[1]=$[3],$[2]=$[4],$[3]=1,$[4]=0,Z=3;else $[++Z]++;lr.foundPatternCross($)&&this.handlePossibleCenter($,Y,S,g)===!0&&(E=$[0],this.hasSkipped&&(D=this.haveMultiplyConfirmedCenters()))}const H=this.selectBestPatterns();return me.orderBestPatterns(H),new MK(H)}static centerFromEnd(h,p){return p-h[4]-h[3]-h[2]/2}static foundPatternCross(h){let p=0;for(let N=0;N<5;N++){const S=h[N];if(S===0)return!1;p+=S}if(p<7)return!1;const g=p/7,v=g/2;return Math.abs(g-h[0])<v&&Math.abs(g-h[1])<v&&Math.abs(3*g-h[2])<3*v&&Math.abs(g-h[3])<v&&Math.abs(g-h[4])<v}getCrossCheckStateCount(){const h=this.crossCheckStateCount;return h[0]=0,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h}crossCheckDiagonal(h,p,g,v){const N=this.getCrossCheckStateCount();let S=0;const E=this.image;for(;h>=S&&p>=S&&E.get(p-S,h-S);)N[2]++,S++;if(h<S||p<S)return!1;for(;h>=S&&p>=S&&!E.get(p-S,h-S)&&N[1]<=g;)N[1]++,S++;if(h<S||p<S||N[1]>g)return!1;for(;h>=S&&p>=S&&E.get(p-S,h-S)&&N[0]<=g;)N[0]++,S++;if(N[0]>g)return!1;const D=E.getHeight(),$=E.getWidth();for(S=1;h+S<D&&p+S<$&&E.get(p+S,h+S);)N[2]++,S++;if(h+S>=D||p+S>=$)return!1;for(;h+S<D&&p+S<$&&!E.get(p+S,h+S)&&N[3]<g;)N[3]++,S++;if(h+S>=D||p+S>=$||N[3]>=g)return!1;for(;h+S<D&&p+S<$&&E.get(p+S,h+S)&&N[4]<g;)N[4]++,S++;if(N[4]>=g)return!1;const H=N[0]+N[1]+N[2]+N[3]+N[4];return Math.abs(H-v)<2*v&&lr.foundPatternCross(N)}crossCheckVertical(h,p,g,v){const N=this.image,S=N.getHeight(),E=this.getCrossCheckStateCount();let D=h;for(;D>=0&&N.get(p,D);)E[2]++,D--;if(D<0)return NaN;for(;D>=0&&!N.get(p,D)&&E[1]<=g;)E[1]++,D--;if(D<0||E[1]>g)return NaN;for(;D>=0&&N.get(p,D)&&E[0]<=g;)E[0]++,D--;if(E[0]>g)return NaN;for(D=h+1;D<S&&N.get(p,D);)E[2]++,D++;if(D===S)return NaN;for(;D<S&&!N.get(p,D)&&E[3]<g;)E[3]++,D++;if(D===S||E[3]>=g)return NaN;for(;D<S&&N.get(p,D)&&E[4]<g;)E[4]++,D++;if(E[4]>=g)return NaN;const $=E[0]+E[1]+E[2]+E[3]+E[4];return 5*Math.abs($-v)>=2*v?NaN:lr.foundPatternCross(E)?lr.centerFromEnd(E,D):NaN}crossCheckHorizontal(h,p,g,v){const N=this.image,S=N.getWidth(),E=this.getCrossCheckStateCount();let D=h;for(;D>=0&&N.get(D,p);)E[2]++,D--;if(D<0)return NaN;for(;D>=0&&!N.get(D,p)&&E[1]<=g;)E[1]++,D--;if(D<0||E[1]>g)return NaN;for(;D>=0&&N.get(D,p)&&E[0]<=g;)E[0]++,D--;if(E[0]>g)return NaN;for(D=h+1;D<S&&N.get(D,p);)E[2]++,D++;if(D===S)return NaN;for(;D<S&&!N.get(D,p)&&E[3]<g;)E[3]++,D++;if(D===S||E[3]>=g)return NaN;for(;D<S&&N.get(D,p)&&E[4]<g;)E[4]++,D++;if(E[4]>=g)return NaN;const $=E[0]+E[1]+E[2]+E[3]+E[4];return 5*Math.abs($-v)>=v?NaN:lr.foundPatternCross(E)?lr.centerFromEnd(E,D):NaN}handlePossibleCenter(h,p,g,v){const N=h[0]+h[1]+h[2]+h[3]+h[4];let S=lr.centerFromEnd(h,g),E=this.crossCheckVertical(p,Math.floor(S),h[2],N);if(!isNaN(E)&&(S=this.crossCheckHorizontal(Math.floor(S),Math.floor(E),h[2],N),!isNaN(S)&&(!v||this.crossCheckDiagonal(Math.floor(E),Math.floor(S),h[2],N)))){const D=N/7;let $=!1;const H=this.possibleCenters;for(let Y=0,Z=H.length;Y<Z;Y++){const re=H[Y];if(re.aboutEquals(D,E,S)){H[Y]=re.combineEstimate(E,S,D),$=!0;break}}if(!$){const Y=new Sw(S,E,D);H.push(Y),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(Y)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let p=null;for(const g of this.possibleCenters)if(g.getCount()>=lr.CENTER_QUORUM)if(p==null)p=g;else return this.hasSkipped=!0,Math.floor((Math.abs(p.getX()-g.getX())-Math.abs(p.getY()-g.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let h=0,p=0;const g=this.possibleCenters.length;for(const S of this.possibleCenters)S.getCount()>=lr.CENTER_QUORUM&&(h++,p+=S.getEstimatedModuleSize());if(h<3)return!1;const v=p/g;let N=0;for(const S of this.possibleCenters)N+=Math.abs(S.getEstimatedModuleSize()-v);return N<=.05*p}selectBestPatterns(){const h=this.possibleCenters.length;if(h<3)throw new z;const p=this.possibleCenters;let g;if(h>3){let v=0,N=0;for(const D of this.possibleCenters){const $=D.getEstimatedModuleSize();v+=$,N+=$*$}g=v/h;let S=Math.sqrt(N/h-g*g);p.sort((D,$)=>{const H=Math.abs($.getEstimatedModuleSize()-g),Y=Math.abs(D.getEstimatedModuleSize()-g);return H<Y?-1:H>Y?1:0});const E=Math.max(.2*g,S);for(let D=0;D<p.length&&p.length>3;D++){const $=p[D];Math.abs($.getEstimatedModuleSize()-g)>E&&(p.splice(D,1),D--)}}if(p.length>3){let v=0;for(const N of p)v+=N.getEstimatedModuleSize();g=v/p.length,p.sort((N,S)=>{if(S.getCount()===N.getCount()){const E=Math.abs(S.getEstimatedModuleSize()-g),D=Math.abs(N.getEstimatedModuleSize()-g);return E<D?1:E>D?-1:0}else return S.getCount()-N.getCount()}),p.splice(3)}return[p[0],p[1],p[2]]}}lr.CENTER_QUORUM=2,lr.MIN_SKIP=3,lr.MAX_MODULES=57;class Qf{constructor(h){this.image=h}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(h){this.resultPointCallback=h==null?null:h.get(R.NEED_RESULT_POINT_CALLBACK);const g=new lr(this.image,this.resultPointCallback).find(h);return this.processFinderPatternInfo(g)}processFinderPatternInfo(h){const p=h.getTopLeft(),g=h.getTopRight(),v=h.getBottomLeft(),N=this.calculateModuleSize(p,g,v);if(N<1)throw new z("No pattern found in proccess finder.");const S=Qf.computeDimension(p,g,v,N),E=St.getProvisionalVersionForDimension(S),D=E.getDimensionForVersion()-7;let $=null;if(E.getAlignmentPatternCenters().length>0){const re=g.getX()-p.getX()+v.getX(),xe=g.getY()-p.getY()+v.getY(),ve=1-3/D,Se=Math.floor(p.getX()+ve*(re-p.getX())),Me=Math.floor(p.getY()+ve*(xe-p.getY()));for(let Xe=4;Xe<=16;Xe<<=1)try{$=this.findAlignmentInRegion(N,Se,Me,Xe);break}catch(Ze){if(!(Ze instanceof z))throw Ze}}const H=Qf.createTransform(p,g,v,$,S),Y=Qf.sampleGrid(this.image,H,S);let Z;return $===null?Z=[v,p,g]:Z=[v,p,g,$],new Ne(Y,Z)}static createTransform(h,p,g,v,N){const S=N-3.5;let E,D,$,H;return v!==null?(E=v.getX(),D=v.getY(),$=S-3,H=$):(E=p.getX()-h.getX()+g.getX(),D=p.getY()-h.getY()+g.getY(),$=S,H=S),pt.quadrilateralToQuadrilateral(3.5,3.5,S,3.5,$,H,3.5,S,h.getX(),h.getY(),p.getX(),p.getY(),E,D,g.getX(),g.getY())}static sampleGrid(h,p,g){return hs.getInstance().sampleGridWithTransform(h,g,g,p)}static computeDimension(h,p,g,v){const N=be.round(me.distance(h,p)/v),S=be.round(me.distance(h,g)/v);let E=Math.floor((N+S)/2)+7;switch(E&3){case 0:E++;break;case 2:E--;break;case 3:throw new z("Dimensions could be not found.")}return E}calculateModuleSize(h,p,g){return(this.calculateModuleSizeOneWay(h,p)+this.calculateModuleSizeOneWay(h,g))/2}calculateModuleSizeOneWay(h,p){const g=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(h.getX()),Math.floor(h.getY()),Math.floor(p.getX()),Math.floor(p.getY())),v=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(p.getX()),Math.floor(p.getY()),Math.floor(h.getX()),Math.floor(h.getY()));return isNaN(g)?v/7:isNaN(v)?g/7:(g+v)/14}sizeOfBlackWhiteBlackRunBothWays(h,p,g,v){let N=this.sizeOfBlackWhiteBlackRun(h,p,g,v),S=1,E=h-(g-h);E<0?(S=h/(h-E),E=0):E>=this.image.getWidth()&&(S=(this.image.getWidth()-1-h)/(E-h),E=this.image.getWidth()-1);let D=Math.floor(p-(v-p)*S);return S=1,D<0?(S=p/(p-D),D=0):D>=this.image.getHeight()&&(S=(this.image.getHeight()-1-p)/(D-p),D=this.image.getHeight()-1),E=Math.floor(h+(E-h)*S),N+=this.sizeOfBlackWhiteBlackRun(h,p,E,D),N-1}sizeOfBlackWhiteBlackRun(h,p,g,v){const N=Math.abs(v-p)>Math.abs(g-h);if(N){let re=h;h=p,p=re,re=g,g=v,v=re}const S=Math.abs(g-h),E=Math.abs(v-p);let D=-S/2;const $=h<g?1:-1,H=p<v?1:-1;let Y=0;const Z=g+$;for(let re=h,xe=p;re!==Z;re+=$){const ve=N?xe:re,Se=N?re:xe;if(Y===1===this.image.get(ve,Se)){if(Y===2)return be.distance(re,xe,h,p);Y++}if(D+=E,D>0){if(xe===v)break;xe+=H,D-=S}}return Y===2?be.distance(g+$,v,h,p):NaN}findAlignmentInRegion(h,p,g,v){const N=Math.floor(v*h),S=Math.max(0,p-N),E=Math.min(this.image.getWidth()-1,p+N);if(E-S<h*3)throw new z("Alignment top exceeds estimated module size.");const D=Math.max(0,g-N),$=Math.min(this.image.getHeight()-1,g+N);if($-D<h*3)throw new z("Alignment bottom exceeds estimated module size.");return new Xx(this.image,S,D,E-S,$-D,h,this.resultPointCallback).find()}}class Xo{constructor(){this.decoder=new IK}getDecoder(){return this.decoder}decode(h,p){let g,v;if(p!=null&&p.get(R.PURE_BARCODE)!==void 0){const D=Xo.extractPureBits(h.getBlackMatrix());g=this.decoder.decodeBitMatrix(D,p),v=Xo.NO_POINTS}else{const D=new Qf(h.getBlackMatrix()).detect(p);g=this.decoder.decodeBitMatrix(D.getBits(),p),v=D.getPoints()}g.getOther()instanceof mE&&g.getOther().applyMirroredCorrection(v);const N=new ue(g.getText(),g.getRawBytes(),void 0,v,X.QR_CODE,void 0),S=g.getByteSegments();S!==null&&N.putMetadata(_e.BYTE_SEGMENTS,S);const E=g.getECLevel();return E!==null&&N.putMetadata(_e.ERROR_CORRECTION_LEVEL,E),g.hasStructuredAppend()&&(N.putMetadata(_e.STRUCTURED_APPEND_SEQUENCE,g.getStructuredAppendSequenceNumber()),N.putMetadata(_e.STRUCTURED_APPEND_PARITY,g.getStructuredAppendParity())),N}reset(){}static extractPureBits(h){const p=h.getTopLeftOnBit(),g=h.getBottomRightOnBit();if(p===null||g===null)throw new z;const v=this.moduleSize(p,h);let N=p[1],S=g[1],E=p[0],D=g[0];if(E>=D||N>=S)throw new z;if(S-N!==D-E&&(D=E+(S-N),D>=h.getWidth()))throw new z;const $=Math.round((D-E+1)/v),H=Math.round((S-N+1)/v);if($<=0||H<=0)throw new z;if(H!==$)throw new z;const Y=Math.floor(v/2);N+=Y,E+=Y;const Z=E+Math.floor(($-1)*v)-D;if(Z>0){if(Z>Y)throw new z;E-=Z}const re=N+Math.floor((H-1)*v)-S;if(re>0){if(re>Y)throw new z;N-=re}const xe=new U($,H);for(let ve=0;ve<H;ve++){const Se=N+Math.floor(ve*v);for(let Me=0;Me<$;Me++)h.get(E+Math.floor(Me*v),Se)&&xe.set(Me,ve)}return xe}static moduleSize(h,p){const g=p.getHeight(),v=p.getWidth();let N=h[0],S=h[1],E=!0,D=0;for(;N<v&&S<g;){if(E!==p.get(N,S)){if(++D===5)break;E=!E}N++,S++}if(N===v||S===g)throw new z;return(N-h[0])/7}}Xo.NO_POINTS=new Array;class Lt{PDF417Common(){}static getBitCountSum(h){return be.sum(h)}static toIntArray(h){if(h==null||!h.length)return Lt.EMPTY_INT_ARRAY;const p=new Int32Array(h.length);let g=0;for(const v of h)p[g++]=v;return p}static getCodeword(h){const p=k.binarySearch(Lt.SYMBOL_TABLE,h&262143);return p<0?-1:(Lt.CODEWORD_TABLE[p]-1)%Lt.NUMBER_OF_CODEWORDS}}Lt.NUMBER_OF_CODEWORDS=929,Lt.MAX_CODEWORDS_IN_BARCODE=Lt.NUMBER_OF_CODEWORDS-1,Lt.MIN_ROWS_IN_BARCODE=3,Lt.MAX_ROWS_IN_BARCODE=90,Lt.MODULES_IN_CODEWORD=17,Lt.MODULES_IN_STOP_PATTERN=18,Lt.BARS_IN_MODULE=8,Lt.EMPTY_INT_ARRAY=new Int32Array([]),Lt.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),Lt.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class DK{constructor(h,p){this.bits=h,this.points=p}getBits(){return this.bits}getPoints(){return this.points}}class qt{static detectMultiple(h,p,g){let v=h.getBlackMatrix(),N=qt.detect(g,v);return N.length||(v=v.clone(),v.rotate180(),N=qt.detect(g,v)),new DK(v,N)}static detect(h,p){const g=new Array;let v=0,N=0,S=!1;for(;v<p.getHeight();){const E=qt.findVertices(p,v,N);if(E[0]==null&&E[3]==null){if(!S)break;S=!1,N=0;for(const D of g)D[1]!=null&&(v=Math.trunc(Math.max(v,D[1].getY()))),D[3]!=null&&(v=Math.max(v,Math.trunc(D[3].getY())));v+=qt.ROW_STEP;continue}if(S=!0,g.push(E),!h)break;E[2]!=null?(N=Math.trunc(E[2].getX()),v=Math.trunc(E[2].getY())):(N=Math.trunc(E[4].getX()),v=Math.trunc(E[4].getY()))}return g}static findVertices(h,p,g){const v=h.getHeight(),N=h.getWidth(),S=new Array(8);return qt.copyToResult(S,qt.findRowsWithPattern(h,v,N,p,g,qt.START_PATTERN),qt.INDEXES_START_PATTERN),S[4]!=null&&(g=Math.trunc(S[4].getX()),p=Math.trunc(S[4].getY())),qt.copyToResult(S,qt.findRowsWithPattern(h,v,N,p,g,qt.STOP_PATTERN),qt.INDEXES_STOP_PATTERN),S}static copyToResult(h,p,g){for(let v=0;v<g.length;v++)h[g[v]]=p[v]}static findRowsWithPattern(h,p,g,v,N,S){const E=new Array(4);let D=!1;const $=new Int32Array(S.length);for(;v<p;v+=qt.ROW_STEP){let Y=qt.findGuardPattern(h,N,v,g,!1,S,$);if(Y!=null){for(;v>0;){const Z=qt.findGuardPattern(h,N,--v,g,!1,S,$);if(Z!=null)Y=Z;else{v++;break}}E[0]=new me(Y[0],v),E[1]=new me(Y[1],v),D=!0;break}}let H=v+1;if(D){let Y=0,Z=Int32Array.from([Math.trunc(E[0].getX()),Math.trunc(E[1].getX())]);for(;H<p;H++){const re=qt.findGuardPattern(h,Z[0],H,g,!1,S,$);if(re!=null&&Math.abs(Z[0]-re[0])<qt.MAX_PATTERN_DRIFT&&Math.abs(Z[1]-re[1])<qt.MAX_PATTERN_DRIFT)Z=re,Y=0;else{if(Y>qt.SKIPPED_ROW_COUNT_MAX)break;Y++}}H-=Y+1,E[2]=new me(Z[0],H),E[3]=new me(Z[1],H)}return H-v<qt.BARCODE_MIN_HEIGHT&&k.fill(E,null),E}static findGuardPattern(h,p,g,v,N,S,E){k.fillWithin(E,0,E.length,0);let D=p,$=0;for(;h.get(D,g)&&D>0&&$++<qt.MAX_PIXEL_DRIFT;)D--;let H=D,Y=0,Z=S.length;for(let re=N;H<v;H++)if(h.get(H,g)!==re)E[Y]++;else{if(Y===Z-1){if(qt.patternMatchVariance(E,S,qt.MAX_INDIVIDUAL_VARIANCE)<qt.MAX_AVG_VARIANCE)return new Int32Array([D,H]);D+=E[0]+E[1],j.arraycopy(E,2,E,0,Y-1),E[Y-1]=0,E[Y]=0,Y--}else Y++;E[Y]=1,re=!re}return Y===Z-1&&qt.patternMatchVariance(E,S,qt.MAX_INDIVIDUAL_VARIANCE)<qt.MAX_AVG_VARIANCE?new Int32Array([D,H-1]):null}static patternMatchVariance(h,p,g){let v=h.length,N=0,S=0;for(let $=0;$<v;$++)N+=h[$],S+=p[$];if(N<S)return 1/0;let E=N/S;g*=E;let D=0;for(let $=0;$<v;$++){let H=h[$],Y=p[$]*E,Z=H>Y?H-Y:Y-H;if(Z>g)return 1/0;D+=Z}return D/N}}qt.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),qt.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),qt.MAX_AVG_VARIANCE=.42,qt.MAX_INDIVIDUAL_VARIANCE=.8,qt.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),qt.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),qt.MAX_PIXEL_DRIFT=3,qt.MAX_PATTERN_DRIFT=5,qt.SKIPPED_ROW_COUNT_MAX=25,qt.ROW_STEP=5,qt.BARCODE_MIN_HEIGHT=10;class yr{constructor(h,p){if(p.length===0)throw new m;this.field=h;let g=p.length;if(g>1&&p[0]===0){let v=1;for(;v<g&&p[v]===0;)v++;v===g?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(g-v),j.arraycopy(p,v,this.coefficients,0,this.coefficients.length))}else this.coefficients=p}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(h){return this.coefficients[this.coefficients.length-1-h]}evaluateAt(h){if(h===0)return this.getCoefficient(0);if(h===1){let v=0;for(let N of this.coefficients)v=this.field.add(v,N);return v}let p=this.coefficients[0],g=this.coefficients.length;for(let v=1;v<g;v++)p=this.field.add(this.field.multiply(h,p),this.coefficients[v]);return p}add(h){if(!this.field.equals(h.field))throw new m("ModulusPolys do not have same ModulusGF field");if(this.isZero())return h;if(h.isZero())return this;let p=this.coefficients,g=h.coefficients;if(p.length>g.length){let S=p;p=g,g=S}let v=new Int32Array(g.length),N=g.length-p.length;j.arraycopy(g,0,v,0,N);for(let S=N;S<g.length;S++)v[S]=this.field.add(p[S-N],g[S]);return new yr(this.field,v)}subtract(h){if(!this.field.equals(h.field))throw new m("ModulusPolys do not have same ModulusGF field");return h.isZero()?this:this.add(h.negative())}multiply(h){return h instanceof yr?this.multiplyOther(h):this.multiplyScalar(h)}multiplyOther(h){if(!this.field.equals(h.field))throw new m("ModulusPolys do not have same ModulusGF field");if(this.isZero()||h.isZero())return new yr(this.field,new Int32Array([0]));let p=this.coefficients,g=p.length,v=h.coefficients,N=v.length,S=new Int32Array(g+N-1);for(let E=0;E<g;E++){let D=p[E];for(let $=0;$<N;$++)S[E+$]=this.field.add(S[E+$],this.field.multiply(D,v[$]))}return new yr(this.field,S)}negative(){let h=this.coefficients.length,p=new Int32Array(h);for(let g=0;g<h;g++)p[g]=this.field.subtract(0,this.coefficients[g]);return new yr(this.field,p)}multiplyScalar(h){if(h===0)return new yr(this.field,new Int32Array([0]));if(h===1)return this;let p=this.coefficients.length,g=new Int32Array(p);for(let v=0;v<p;v++)g[v]=this.field.multiply(this.coefficients[v],h);return new yr(this.field,g)}multiplyByMonomial(h,p){if(h<0)throw new m;if(p===0)return new yr(this.field,new Int32Array([0]));let g=this.coefficients.length,v=new Int32Array(g+h);for(let N=0;N<g;N++)v[N]=this.field.multiply(this.coefficients[N],p);return new yr(this.field,v)}toString(){let h=new V;for(let p=this.getDegree();p>=0;p--){let g=this.getCoefficient(p);g!==0&&(g<0?(h.append(" - "),g=-g):h.length()>0&&h.append(" + "),(p===0||g!==1)&&h.append(g),p!==0&&(p===1?h.append("x"):(h.append("x^"),h.append(p))))}return h.toString()}}class OK{add(h,p){return(h+p)%this.modulus}subtract(h,p){return(this.modulus+h-p)%this.modulus}exp(h){return this.expTable[h]}log(h){if(h===0)throw new m;return this.logTable[h]}inverse(h){if(h===0)throw new le;return this.expTable[this.modulus-this.logTable[h]-1]}multiply(h,p){return h===0||p===0?0:this.expTable[(this.logTable[h]+this.logTable[p])%(this.modulus-1)]}getSize(){return this.modulus}equals(h){return h===this}}class Cw extends OK{constructor(h,p){super(),this.modulus=h,this.expTable=new Int32Array(h),this.logTable=new Int32Array(h);let g=1;for(let v=0;v<h;v++)this.expTable[v]=g,g=g*p%h;for(let v=0;v<h-1;v++)this.logTable[this.expTable[v]]=v;this.zero=new yr(this,new Int32Array([0])),this.one=new yr(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(h,p){if(h<0)throw new m;if(p===0)return this.zero;let g=new Int32Array(h+1);return g[0]=p,new yr(this,g)}}Cw.PDF417_GF=new Cw(Lt.NUMBER_OF_CODEWORDS,3);class pE{constructor(){this.field=Cw.PDF417_GF}decode(h,p,g){let v=new yr(this.field,h),N=new Int32Array(p),S=!1;for(let xe=p;xe>0;xe--){let ve=v.evaluateAt(this.field.exp(xe));N[p-xe]=ve,ve!==0&&(S=!0)}if(!S)return 0;let E=this.field.getOne();if(g!=null)for(const xe of g){let ve=this.field.exp(h.length-1-xe),Se=new yr(this.field,new Int32Array([this.field.subtract(0,ve),1]));E=E.multiply(Se)}let D=new yr(this.field,N),$=this.runEuclideanAlgorithm(this.field.buildMonomial(p,1),D,p),H=$[0],Y=$[1],Z=this.findErrorLocations(H),re=this.findErrorMagnitudes(Y,H,Z);for(let xe=0;xe<Z.length;xe++){let ve=h.length-1-this.field.log(Z[xe]);if(ve<0)throw b.getChecksumInstance();h[ve]=this.field.subtract(h[ve],re[xe])}return Z.length}runEuclideanAlgorithm(h,p,g){if(h.getDegree()<p.getDegree()){let Z=h;h=p,p=Z}let v=h,N=p,S=this.field.getZero(),E=this.field.getOne();for(;N.getDegree()>=Math.round(g/2);){let Z=v,re=S;if(v=N,S=E,v.isZero())throw b.getChecksumInstance();N=Z;let xe=this.field.getZero(),ve=v.getCoefficient(v.getDegree()),Se=this.field.inverse(ve);for(;N.getDegree()>=v.getDegree()&&!N.isZero();){let Me=N.getDegree()-v.getDegree(),Xe=this.field.multiply(N.getCoefficient(N.getDegree()),Se);xe=xe.add(this.field.buildMonomial(Me,Xe)),N=N.subtract(v.multiplyByMonomial(Me,Xe))}E=xe.multiply(S).subtract(re).negative()}let D=E.getCoefficient(0);if(D===0)throw b.getChecksumInstance();let $=this.field.inverse(D),H=E.multiply($),Y=N.multiply($);return[H,Y]}findErrorLocations(h){let p=h.getDegree(),g=new Int32Array(p),v=0;for(let N=1;N<this.field.getSize()&&v<p;N++)h.evaluateAt(N)===0&&(g[v]=this.field.inverse(N),v++);if(v!==p)throw b.getChecksumInstance();return g}findErrorMagnitudes(h,p,g){let v=p.getDegree(),N=new Int32Array(v);for(let $=1;$<=v;$++)N[v-$]=this.field.multiply($,p.getCoefficient($));let S=new yr(this.field,N),E=g.length,D=new Int32Array(E);for(let $=0;$<E;$++){let H=this.field.inverse(g[$]),Y=this.field.subtract(0,h.evaluateAt(H)),Z=this.field.inverse(S.evaluateAt(H));D[$]=this.field.multiply(Y,Z)}return D}}class xd{constructor(h,p,g,v,N){h instanceof xd?this.constructor_2(h):this.constructor_1(h,p,g,v,N)}constructor_1(h,p,g,v,N){const S=p==null||g==null,E=v==null||N==null;if(S&&E)throw new z;S?(p=new me(0,v.getY()),g=new me(0,N.getY())):E&&(v=new me(h.getWidth()-1,p.getY()),N=new me(h.getWidth()-1,g.getY())),this.image=h,this.topLeft=p,this.bottomLeft=g,this.topRight=v,this.bottomRight=N,this.minX=Math.trunc(Math.min(p.getX(),g.getX())),this.maxX=Math.trunc(Math.max(v.getX(),N.getX())),this.minY=Math.trunc(Math.min(p.getY(),v.getY())),this.maxY=Math.trunc(Math.max(g.getY(),N.getY()))}constructor_2(h){this.image=h.image,this.topLeft=h.getTopLeft(),this.bottomLeft=h.getBottomLeft(),this.topRight=h.getTopRight(),this.bottomRight=h.getBottomRight(),this.minX=h.getMinX(),this.maxX=h.getMaxX(),this.minY=h.getMinY(),this.maxY=h.getMaxY()}static merge(h,p){return h==null?p:p==null?h:new xd(h.image,h.topLeft,h.bottomLeft,p.topRight,p.bottomRight)}addMissingRows(h,p,g){let v=this.topLeft,N=this.bottomLeft,S=this.topRight,E=this.bottomRight;if(h>0){let D=g?this.topLeft:this.topRight,$=Math.trunc(D.getY()-h);$<0&&($=0);let H=new me(D.getX(),$);g?v=H:S=H}if(p>0){let D=g?this.bottomLeft:this.bottomRight,$=Math.trunc(D.getY()+p);$>=this.image.getHeight()&&($=this.image.getHeight()-1);let H=new me(D.getX(),$);g?N=H:E=H}return new xd(this.image,v,N,S,E)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class RK{constructor(h,p,g,v){this.columnCount=h,this.errorCorrectionLevel=v,this.rowCountUpperPart=p,this.rowCountLowerPart=g,this.rowCount=p+g}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class Zf{constructor(){this.buffer=""}static form(h,p){let g=-1;function v(S,E,D,$,H,Y){if(S==="%%")return"%";if(p[++g]===void 0)return;S=$?parseInt($.substr(1)):void 0;let Z=H?parseInt(H.substr(1)):void 0,re;switch(Y){case"s":re=p[g];break;case"c":re=p[g][0];break;case"f":re=parseFloat(p[g]).toFixed(S);break;case"p":re=parseFloat(p[g]).toPrecision(S);break;case"e":re=parseFloat(p[g]).toExponential(S);break;case"x":re=parseInt(p[g]).toString(Z||16);break;case"d":re=parseFloat(parseInt(p[g],Z||10).toPrecision(S)).toFixed(0);break}re=typeof re=="object"?JSON.stringify(re):(+re).toString(Z);let xe=parseInt(D),ve=D&&D[0]+""=="0"?"0":" ";for(;re.length<xe;)re=E!==void 0?re+ve:ve+re;return re}let N=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return h.replace(N,v)}format(h,...p){this.buffer+=Zf.form(h,p)}toString(){return this.buffer}}class Jf{constructor(h){this.boundingBox=new xd(h),this.codewords=new Array(h.getMaxY()-h.getMinY()+1)}getCodewordNearby(h){let p=this.getCodeword(h);if(p!=null)return p;for(let g=1;g<Jf.MAX_NEARBY_DISTANCE;g++){let v=this.imageRowToCodewordIndex(h)-g;if(v>=0&&(p=this.codewords[v],p!=null)||(v=this.imageRowToCodewordIndex(h)+g,v<this.codewords.length&&(p=this.codewords[v],p!=null)))return p}return null}imageRowToCodewordIndex(h){return h-this.boundingBox.getMinY()}setCodeword(h,p){this.codewords[this.imageRowToCodewordIndex(h)]=p}getCodeword(h){return this.codewords[this.imageRowToCodewordIndex(h)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const h=new Zf;let p=0;for(const g of this.codewords){if(g==null){h.format("%3d:    |   %n",p++);continue}h.format("%3d: %3d|%3d%n",p++,g.getRowNumber(),g.getValue())}return h.toString()}}Jf.MAX_NEARBY_DISTANCE=5;class em{constructor(){this.values=new Map}setValue(h){h=Math.trunc(h);let p=this.values.get(h);p==null&&(p=0),p++,this.values.set(h,p)}getValue(){let h=-1,p=new Array;for(const[g,v]of this.values.entries()){const N={getKey:()=>g,getValue:()=>v};N.getValue()>h?(h=N.getValue(),p=[],p.push(N.getKey())):N.getValue()===h&&p.push(N.getKey())}return Lt.toIntArray(p)}getConfidence(h){return this.values.get(h)}}class xE extends Jf{constructor(h,p){super(h),this._isLeft=p}setRowNumbers(){for(let h of this.getCodewords())h!=null&&h.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(h){let p=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(p,h);let g=this.getBoundingBox(),v=this._isLeft?g.getTopLeft():g.getTopRight(),N=this._isLeft?g.getBottomLeft():g.getBottomRight(),S=this.imageRowToCodewordIndex(Math.trunc(v.getY())),E=this.imageRowToCodewordIndex(Math.trunc(N.getY())),D=-1,$=1,H=0;for(let Y=S;Y<E;Y++){if(p[Y]==null)continue;let Z=p[Y],re=Z.getRowNumber()-D;if(re===0)H++;else if(re===1)$=Math.max($,H),H=1,D=Z.getRowNumber();else if(re<0||Z.getRowNumber()>=h.getRowCount()||re>Y)p[Y]=null;else{let xe;$>2?xe=($-2)*re:xe=re;let ve=xe>=Y;for(let Se=1;Se<=xe&&!ve;Se++)ve=p[Y-Se]!=null;ve?p[Y]=null:(D=Z.getRowNumber(),H=1)}}}getRowHeights(){let h=this.getBarcodeMetadata();if(h==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(h);let p=new Int32Array(h.getRowCount());for(let g of this.getCodewords())if(g!=null){let v=g.getRowNumber();if(v>=p.length)continue;p[v]++}return p}adjustIncompleteIndicatorColumnRowNumbers(h){let p=this.getBoundingBox(),g=this._isLeft?p.getTopLeft():p.getTopRight(),v=this._isLeft?p.getBottomLeft():p.getBottomRight(),N=this.imageRowToCodewordIndex(Math.trunc(g.getY())),S=this.imageRowToCodewordIndex(Math.trunc(v.getY())),E=this.getCodewords(),D=-1;for(let $=N;$<S;$++){if(E[$]==null)continue;let H=E[$];H.setRowNumberAsRowIndicatorColumn();let Y=H.getRowNumber()-D;Y===0||(Y===1?D=H.getRowNumber():H.getRowNumber()>=h.getRowCount()?E[$]=null:D=H.getRowNumber())}}getBarcodeMetadata(){let h=this.getCodewords(),p=new em,g=new em,v=new em,N=new em;for(let E of h){if(E==null)continue;E.setRowNumberAsRowIndicatorColumn();let D=E.getValue()%30,$=E.getRowNumber();switch(this._isLeft||($+=2),$%3){case 0:g.setValue(D*3+1);break;case 1:N.setValue(D/3),v.setValue(D%3);break;case 2:p.setValue(D+1);break}}if(p.getValue().length===0||g.getValue().length===0||v.getValue().length===0||N.getValue().length===0||p.getValue()[0]<1||g.getValue()[0]+v.getValue()[0]<Lt.MIN_ROWS_IN_BARCODE||g.getValue()[0]+v.getValue()[0]>Lt.MAX_ROWS_IN_BARCODE)return null;let S=new RK(p.getValue()[0],g.getValue()[0],v.getValue()[0],N.getValue()[0]);return this.removeIncorrectCodewords(h,S),S}removeIncorrectCodewords(h,p){for(let g=0;g<h.length;g++){let v=h[g];if(h[g]==null)continue;let N=v.getValue()%30,S=v.getRowNumber();if(S>p.getRowCount()){h[g]=null;continue}switch(this._isLeft||(S+=2),S%3){case 0:N*3+1!==p.getRowCountUpperPart()&&(h[g]=null);break;case 1:(Math.trunc(N/3)!==p.getErrorCorrectionLevel()||N%3!==p.getRowCountLowerPart())&&(h[g]=null);break;case 2:N+1!==p.getColumnCount()&&(h[g]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class tm{constructor(h,p){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=h,this.barcodeColumnCount=h.getColumnCount(),this.boundingBox=p,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let h=Lt.MAX_CODEWORDS_IN_BARCODE,p;do p=h,h=this.adjustRowNumbersAndGetCount();while(h>0&&h<p);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(h){h!=null&&h.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let h=this.adjustRowNumbersByRow();if(h===0)return 0;for(let p=1;p<this.barcodeColumnCount+1;p++){let g=this.detectionResultColumns[p].getCodewords();for(let v=0;v<g.length;v++)g[v]!=null&&(g[v].hasValidRowNumber()||this.adjustRowNumbers(p,v,g))}return h}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let h=this.detectionResultColumns[0].getCodewords(),p=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let g=0;g<h.length;g++)if(h[g]!=null&&p[g]!=null&&h[g].getRowNumber()===p[g].getRowNumber())for(let v=1;v<=this.barcodeColumnCount;v++){let N=this.detectionResultColumns[v].getCodewords()[g];N!=null&&(N.setRowNumber(h[g].getRowNumber()),N.hasValidRowNumber()||(this.detectionResultColumns[v].getCodewords()[g]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let h=0,p=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let g=0;g<p.length;g++){if(p[g]==null)continue;let v=p[g].getRowNumber(),N=0;for(let S=this.barcodeColumnCount+1;S>0&&N<this.ADJUST_ROW_NUMBER_SKIP;S--){let E=this.detectionResultColumns[S].getCodewords()[g];E!=null&&(N=tm.adjustRowNumberIfValid(v,N,E),E.hasValidRowNumber()||h++)}}return h}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let h=0,p=this.detectionResultColumns[0].getCodewords();for(let g=0;g<p.length;g++){if(p[g]==null)continue;let v=p[g].getRowNumber(),N=0;for(let S=1;S<this.barcodeColumnCount+1&&N<this.ADJUST_ROW_NUMBER_SKIP;S++){let E=this.detectionResultColumns[S].getCodewords()[g];E!=null&&(N=tm.adjustRowNumberIfValid(v,N,E),E.hasValidRowNumber()||h++)}}return h}static adjustRowNumberIfValid(h,p,g){return g==null||g.hasValidRowNumber()||(g.isValidRowNumber(h)?(g.setRowNumber(h),p=0):++p),p}adjustRowNumbers(h,p,g){if(!this.detectionResultColumns[h-1])return;let v=g[p],N=this.detectionResultColumns[h-1].getCodewords(),S=N;this.detectionResultColumns[h+1]!=null&&(S=this.detectionResultColumns[h+1].getCodewords());let E=new Array(14);E[2]=N[p],E[3]=S[p],p>0&&(E[0]=g[p-1],E[4]=N[p-1],E[5]=S[p-1]),p>1&&(E[8]=g[p-2],E[10]=N[p-2],E[11]=S[p-2]),p<g.length-1&&(E[1]=g[p+1],E[6]=N[p+1],E[7]=S[p+1]),p<g.length-2&&(E[9]=g[p+2],E[12]=N[p+2],E[13]=S[p+2]);for(let D of E)if(tm.adjustRowNumber(v,D))return}static adjustRowNumber(h,p){return p==null?!1:p.hasValidRowNumber()&&p.getBucket()===h.getBucket()?(h.setRowNumber(p.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(h){this.boundingBox=h}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(h,p){this.detectionResultColumns[h]=p}getDetectionResultColumn(h){return this.detectionResultColumns[h]}toString(){let h=this.detectionResultColumns[0];h==null&&(h=this.detectionResultColumns[this.barcodeColumnCount+1]);let p=new Zf;for(let g=0;g<h.getCodewords().length;g++){p.format("CW %3d:",g);for(let v=0;v<this.barcodeColumnCount+2;v++){if(this.detectionResultColumns[v]==null){p.format("    |   ");continue}let N=this.detectionResultColumns[v].getCodewords()[g];if(N==null){p.format("    |   ");continue}p.format(" %3d|%3d",N.getRowNumber(),N.getValue())}p.format("%n")}return p.toString()}}class sm{constructor(h,p,g,v){this.rowNumber=sm.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(h),this.endX=Math.trunc(p),this.bucket=Math.trunc(g),this.value=Math.trunc(v)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(h){return h!==sm.BARCODE_ROW_UNKNOWN&&this.bucket===h%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(h){this.rowNumber=h}toString(){return this.rowNumber+"|"+this.value}}sm.BARCODE_ROW_UNKNOWN=-1;class da{static initialize(){for(let h=0;h<Lt.SYMBOL_TABLE.length;h++){let p=Lt.SYMBOL_TABLE[h],g=p&1;for(let v=0;v<Lt.BARS_IN_MODULE;v++){let N=0;for(;(p&1)===g;)N+=1,p>>=1;g=p&1,da.RATIOS_TABLE[h]||(da.RATIOS_TABLE[h]=new Array(Lt.BARS_IN_MODULE)),da.RATIOS_TABLE[h][Lt.BARS_IN_MODULE-v-1]=Math.fround(N/Lt.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(h){let p=da.getDecodedCodewordValue(da.sampleBitCounts(h));return p!==-1?p:da.getClosestDecodedValue(h)}static sampleBitCounts(h){let p=be.sum(h),g=new Int32Array(Lt.BARS_IN_MODULE),v=0,N=0;for(let S=0;S<Lt.MODULES_IN_CODEWORD;S++){let E=p/(2*Lt.MODULES_IN_CODEWORD)+S*p/Lt.MODULES_IN_CODEWORD;N+h[v]<=E&&(N+=h[v],v++),g[v]++}return g}static getDecodedCodewordValue(h){let p=da.getBitValue(h);return Lt.getCodeword(p)===-1?-1:p}static getBitValue(h){let p=0;for(let g=0;g<h.length;g++)for(let v=0;v<h[g];v++)p=p<<1|(g%2===0?1:0);return Math.trunc(p)}static getClosestDecodedValue(h){let p=be.sum(h),g=new Array(Lt.BARS_IN_MODULE);if(p>1)for(let S=0;S<g.length;S++)g[S]=Math.fround(h[S]/p);let v=ne.MAX_VALUE,N=-1;this.bSymbolTableReady||da.initialize();for(let S=0;S<da.RATIOS_TABLE.length;S++){let E=0,D=da.RATIOS_TABLE[S];for(let $=0;$<Lt.BARS_IN_MODULE;$++){let H=Math.fround(D[$]-g[$]);if(E+=Math.fround(H*H),E>=v)break}E<v&&(v=E,N=Lt.SYMBOL_TABLE[S])}return N}}da.bSymbolTableReady=!1,da.RATIOS_TABLE=new Array(Lt.SYMBOL_TABLE.length).map(K=>new Array(Lt.BARS_IN_MODULE));class gE{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(h){this.segmentIndex=h}getFileId(){return this.fileId}setFileId(h){this.fileId=h}getOptionalData(){return this.optionalData}setOptionalData(h){this.optionalData=h}isLastSegment(){return this.lastSegment}setLastSegment(h){this.lastSegment=h}getSegmentCount(){return this.segmentCount}setSegmentCount(h){this.segmentCount=h}getSender(){return this.sender||null}setSender(h){this.sender=h}getAddressee(){return this.addressee||null}setAddressee(h){this.addressee=h}getFileName(){return this.fileName}setFileName(h){this.fileName=h}getFileSize(){return this.fileSize}setFileSize(h){this.fileSize=h}getChecksum(){return this.checksum}setChecksum(h){this.checksum=h}getTimestamp(){return this.timestamp}setTimestamp(h){this.timestamp=h}}class yE{static parseLong(h,p=void 0){return parseInt(h,p)}}class bE extends u{}bE.kind="NullPointerException";class LK{writeBytes(h){this.writeBytesOffset(h,0,h.length)}writeBytesOffset(h,p,g){if(h==null)throw new bE;if(p<0||p>h.length||g<0||p+g>h.length||p+g<0)throw new _;if(g===0)return;for(let v=0;v<g;v++)this.write(h[p+v])}flush(){}close(){}}class BK extends u{}class FK extends LK{constructor(h=32){if(super(),this.count=0,h<0)throw new m("Negative initial size: "+h);this.buf=new Uint8Array(h)}ensureCapacity(h){h-this.buf.length>0&&this.grow(h)}grow(h){let g=this.buf.length<<1;if(g-h<0&&(g=h),g<0){if(h<0)throw new BK;g=A.MAX_VALUE}this.buf=k.copyOfUint8Array(this.buf,g)}write(h){this.ensureCapacity(this.count+1),this.buf[this.count]=h,this.count+=1}writeBytesOffset(h,p,g){if(p<0||p>h.length||g<0||p+g-h.length>0)throw new _;this.ensureCapacity(this.count+g),j.arraycopy(h,p,this.buf,this.count,g),this.count+=g}writeTo(h){h.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return k.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(h){return h?typeof h=="string"?this.toString_string(h):this.toString_number(h):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(h){return new String(this.buf).toString()}toString_number(h){return new String(this.buf).toString()}close(){}}var js;(function(K){K[K.ALPHA=0]="ALPHA",K[K.LOWER=1]="LOWER",K[K.MIXED=2]="MIXED",K[K.PUNCT=3]="PUNCT",K[K.ALPHA_SHIFT=4]="ALPHA_SHIFT",K[K.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(js||(js={}));function vE(){if(typeof window<"u")return window.BigInt||null;if(typeof am<"u")return am.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let Qx;function Qo(K){if(typeof Qx>"u"&&(Qx=vE()),Qx===null)throw new Error("BigInt is not supported!");return Qx(K)}function $K(){let K=[];K[0]=Qo(1);let h=Qo(900);K[1]=h;for(let p=2;p<16;p++)K[p]=K[p-1]*h;return K}class Ie{static decode(h,p){let g=new V(""),v=M.ISO8859_1;g.enableDecoding(v);let N=1,S=h[N++],E=new gE;for(;N<h[0];){switch(S){case Ie.TEXT_COMPACTION_MODE_LATCH:N=Ie.textCompaction(h,N,g);break;case Ie.BYTE_COMPACTION_MODE_LATCH:case Ie.BYTE_COMPACTION_MODE_LATCH_6:N=Ie.byteCompaction(S,h,v,N,g);break;case Ie.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:g.append(h[N++]);break;case Ie.NUMERIC_COMPACTION_MODE_LATCH:N=Ie.numericCompaction(h,N,g);break;case Ie.ECI_CHARSET:M.getCharacterSetECIByValue(h[N++]);break;case Ie.ECI_GENERAL_PURPOSE:N+=2;break;case Ie.ECI_USER_DEFINED:N++;break;case Ie.BEGIN_MACRO_PDF417_CONTROL_BLOCK:N=Ie.decodeMacroBlock(h,N,E);break;case Ie.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ie.MACRO_PDF417_TERMINATOR:throw new I;default:N--,N=Ie.textCompaction(h,N,g);break}if(N<h.length)S=h[N++];else throw I.getFormatInstance()}if(g.length()===0)throw I.getFormatInstance();let D=new ce(null,g.toString(),null,p);return D.setOther(E),D}static decodeMacroBlock(h,p,g){if(p+Ie.NUMBER_OF_SEQUENCE_CODEWORDS>h[0])throw I.getFormatInstance();let v=new Int32Array(Ie.NUMBER_OF_SEQUENCE_CODEWORDS);for(let E=0;E<Ie.NUMBER_OF_SEQUENCE_CODEWORDS;E++,p++)v[E]=h[p];g.setSegmentIndex(A.parseInt(Ie.decodeBase900toBase10(v,Ie.NUMBER_OF_SEQUENCE_CODEWORDS)));let N=new V;p=Ie.textCompaction(h,p,N),g.setFileId(N.toString());let S=-1;for(h[p]===Ie.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(S=p+1);p<h[0];)switch(h[p]){case Ie.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(p++,h[p]){case Ie.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let E=new V;p=Ie.textCompaction(h,p+1,E),g.setFileName(E.toString());break;case Ie.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let D=new V;p=Ie.textCompaction(h,p+1,D),g.setSender(D.toString());break;case Ie.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let $=new V;p=Ie.textCompaction(h,p+1,$),g.setAddressee($.toString());break;case Ie.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let H=new V;p=Ie.numericCompaction(h,p+1,H),g.setSegmentCount(A.parseInt(H.toString()));break;case Ie.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let Y=new V;p=Ie.numericCompaction(h,p+1,Y),g.setTimestamp(yE.parseLong(Y.toString()));break;case Ie.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let Z=new V;p=Ie.numericCompaction(h,p+1,Z),g.setChecksum(A.parseInt(Z.toString()));break;case Ie.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let re=new V;p=Ie.numericCompaction(h,p+1,re),g.setFileSize(yE.parseLong(re.toString()));break;default:throw I.getFormatInstance()}break;case Ie.MACRO_PDF417_TERMINATOR:p++,g.setLastSegment(!0);break;default:throw I.getFormatInstance()}if(S!==-1){let E=p-S;g.isLastSegment()&&E--,g.setOptionalData(k.copyOfRange(h,S,S+E))}return p}static textCompaction(h,p,g){let v=new Int32Array((h[0]-p)*2),N=new Int32Array((h[0]-p)*2),S=0,E=!1;for(;p<h[0]&&!E;){let D=h[p++];if(D<Ie.TEXT_COMPACTION_MODE_LATCH)v[S]=D/30,v[S+1]=D%30,S+=2;else switch(D){case Ie.TEXT_COMPACTION_MODE_LATCH:v[S++]=Ie.TEXT_COMPACTION_MODE_LATCH;break;case Ie.BYTE_COMPACTION_MODE_LATCH:case Ie.BYTE_COMPACTION_MODE_LATCH_6:case Ie.NUMERIC_COMPACTION_MODE_LATCH:case Ie.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ie.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ie.MACRO_PDF417_TERMINATOR:p--,E=!0;break;case Ie.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:v[S]=Ie.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,D=h[p++],N[S]=D,S++;break}}return Ie.decodeTextCompaction(v,N,S,g),p}static decodeTextCompaction(h,p,g,v){let N=js.ALPHA,S=js.ALPHA,E=0;for(;E<g;){let D=h[E],$="";switch(N){case js.ALPHA:if(D<26)$=String.fromCharCode(65+D);else switch(D){case 26:$=" ";break;case Ie.LL:N=js.LOWER;break;case Ie.ML:N=js.MIXED;break;case Ie.PS:S=N,N=js.PUNCT_SHIFT;break;case Ie.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:v.append(p[E]);break;case Ie.TEXT_COMPACTION_MODE_LATCH:N=js.ALPHA;break}break;case js.LOWER:if(D<26)$=String.fromCharCode(97+D);else switch(D){case 26:$=" ";break;case Ie.AS:S=N,N=js.ALPHA_SHIFT;break;case Ie.ML:N=js.MIXED;break;case Ie.PS:S=N,N=js.PUNCT_SHIFT;break;case Ie.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:v.append(p[E]);break;case Ie.TEXT_COMPACTION_MODE_LATCH:N=js.ALPHA;break}break;case js.MIXED:if(D<Ie.PL)$=Ie.MIXED_CHARS[D];else switch(D){case Ie.PL:N=js.PUNCT;break;case 26:$=" ";break;case Ie.LL:N=js.LOWER;break;case Ie.AL:N=js.ALPHA;break;case Ie.PS:S=N,N=js.PUNCT_SHIFT;break;case Ie.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:v.append(p[E]);break;case Ie.TEXT_COMPACTION_MODE_LATCH:N=js.ALPHA;break}break;case js.PUNCT:if(D<Ie.PAL)$=Ie.PUNCT_CHARS[D];else switch(D){case Ie.PAL:N=js.ALPHA;break;case Ie.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:v.append(p[E]);break;case Ie.TEXT_COMPACTION_MODE_LATCH:N=js.ALPHA;break}break;case js.ALPHA_SHIFT:if(N=S,D<26)$=String.fromCharCode(65+D);else switch(D){case 26:$=" ";break;case Ie.TEXT_COMPACTION_MODE_LATCH:N=js.ALPHA;break}break;case js.PUNCT_SHIFT:if(N=S,D<Ie.PAL)$=Ie.PUNCT_CHARS[D];else switch(D){case Ie.PAL:N=js.ALPHA;break;case Ie.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:v.append(p[E]);break;case Ie.TEXT_COMPACTION_MODE_LATCH:N=js.ALPHA;break}break}$!==""&&v.append($),E++}}static byteCompaction(h,p,g,v,N){let S=new FK,E=0,D=0,$=!1;switch(h){case Ie.BYTE_COMPACTION_MODE_LATCH:let H=new Int32Array(6),Y=p[v++];for(;v<p[0]&&!$;)switch(H[E++]=Y,D=900*D+Y,Y=p[v++],Y){case Ie.TEXT_COMPACTION_MODE_LATCH:case Ie.BYTE_COMPACTION_MODE_LATCH:case Ie.NUMERIC_COMPACTION_MODE_LATCH:case Ie.BYTE_COMPACTION_MODE_LATCH_6:case Ie.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ie.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ie.MACRO_PDF417_TERMINATOR:v--,$=!0;break;default:if(E%5===0&&E>0){for(let Z=0;Z<6;++Z)S.write(Number(Qo(D)>>Qo(8*(5-Z))));D=0,E=0}break}v===p[0]&&Y<Ie.TEXT_COMPACTION_MODE_LATCH&&(H[E++]=Y);for(let Z=0;Z<E;Z++)S.write(H[Z]);break;case Ie.BYTE_COMPACTION_MODE_LATCH_6:for(;v<p[0]&&!$;){let Z=p[v++];if(Z<Ie.TEXT_COMPACTION_MODE_LATCH)E++,D=900*D+Z;else switch(Z){case Ie.TEXT_COMPACTION_MODE_LATCH:case Ie.BYTE_COMPACTION_MODE_LATCH:case Ie.NUMERIC_COMPACTION_MODE_LATCH:case Ie.BYTE_COMPACTION_MODE_LATCH_6:case Ie.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ie.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ie.MACRO_PDF417_TERMINATOR:v--,$=!0;break}if(E%5===0&&E>0){for(let re=0;re<6;++re)S.write(Number(Qo(D)>>Qo(8*(5-re))));D=0,E=0}}break}return N.append(L.decode(S.toByteArray(),g)),v}static numericCompaction(h,p,g){let v=0,N=!1,S=new Int32Array(Ie.MAX_NUMERIC_CODEWORDS);for(;p<h[0]&&!N;){let E=h[p++];if(p===h[0]&&(N=!0),E<Ie.TEXT_COMPACTION_MODE_LATCH)S[v]=E,v++;else switch(E){case Ie.TEXT_COMPACTION_MODE_LATCH:case Ie.BYTE_COMPACTION_MODE_LATCH:case Ie.BYTE_COMPACTION_MODE_LATCH_6:case Ie.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ie.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ie.MACRO_PDF417_TERMINATOR:p--,N=!0;break}(v%Ie.MAX_NUMERIC_CODEWORDS===0||E===Ie.NUMERIC_COMPACTION_MODE_LATCH||N)&&v>0&&(g.append(Ie.decodeBase900toBase10(S,v)),v=0)}return p}static decodeBase900toBase10(h,p){let g=Qo(0);for(let N=0;N<p;N++)g+=Ie.EXP900[p-N-1]*Qo(h[N]);let v=g.toString();if(v.charAt(0)!=="1")throw new I;return v.substring(1)}}Ie.TEXT_COMPACTION_MODE_LATCH=900,Ie.BYTE_COMPACTION_MODE_LATCH=901,Ie.NUMERIC_COMPACTION_MODE_LATCH=902,Ie.BYTE_COMPACTION_MODE_LATCH_6=924,Ie.ECI_USER_DEFINED=925,Ie.ECI_GENERAL_PURPOSE=926,Ie.ECI_CHARSET=927,Ie.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,Ie.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,Ie.MACRO_PDF417_TERMINATOR=922,Ie.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,Ie.MAX_NUMERIC_CODEWORDS=15,Ie.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,Ie.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,Ie.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,Ie.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,Ie.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,Ie.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,Ie.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,Ie.PL=25,Ie.LL=27,Ie.AS=27,Ie.ML=28,Ie.AL=28,Ie.PS=29,Ie.PAL=29,Ie.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,Ie.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",Ie.EXP900=vE()?$K():[],Ie.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Yt{constructor(){}static decode(h,p,g,v,N,S,E){let D=new xd(h,p,g,v,N),$=null,H=null,Y;for(let xe=!0;;xe=!1){if(p!=null&&($=Yt.getRowIndicatorColumn(h,D,p,!0,S,E)),v!=null&&(H=Yt.getRowIndicatorColumn(h,D,v,!1,S,E)),Y=Yt.merge($,H),Y==null)throw z.getNotFoundInstance();let ve=Y.getBoundingBox();if(xe&&ve!=null&&(ve.getMinY()<D.getMinY()||ve.getMaxY()>D.getMaxY()))D=ve;else break}Y.setBoundingBox(D);let Z=Y.getBarcodeColumnCount()+1;Y.setDetectionResultColumn(0,$),Y.setDetectionResultColumn(Z,H);let re=$!=null;for(let xe=1;xe<=Z;xe++){let ve=re?xe:Z-xe;if(Y.getDetectionResultColumn(ve)!==void 0)continue;let Se;ve===0||ve===Z?Se=new xE(D,ve===0):Se=new Jf(D),Y.setDetectionResultColumn(ve,Se);let Me=-1,Xe=Me;for(let Ze=D.getMinY();Ze<=D.getMaxY();Ze++){if(Me=Yt.getStartColumn(Y,ve,Ze,re),Me<0||Me>D.getMaxX()){if(Xe===-1)continue;Me=Xe}let He=Yt.detectCodeword(h,D.getMinX(),D.getMaxX(),re,Me,Ze,S,E);He!=null&&(Se.setCodeword(Ze,He),Xe=Me,S=Math.min(S,He.getWidth()),E=Math.max(E,He.getWidth()))}}return Yt.createDecoderResult(Y)}static merge(h,p){if(h==null&&p==null)return null;let g=Yt.getBarcodeMetadata(h,p);if(g==null)return null;let v=xd.merge(Yt.adjustBoundingBox(h),Yt.adjustBoundingBox(p));return new tm(g,v)}static adjustBoundingBox(h){if(h==null)return null;let p=h.getRowHeights();if(p==null)return null;let g=Yt.getMax(p),v=0;for(let E of p)if(v+=g-E,E>0)break;let N=h.getCodewords();for(let E=0;v>0&&N[E]==null;E++)v--;let S=0;for(let E=p.length-1;E>=0&&(S+=g-p[E],!(p[E]>0));E--);for(let E=N.length-1;S>0&&N[E]==null;E--)S--;return h.getBoundingBox().addMissingRows(v,S,h.isLeft())}static getMax(h){let p=-1;for(let g of h)p=Math.max(p,g);return p}static getBarcodeMetadata(h,p){let g;if(h==null||(g=h.getBarcodeMetadata())==null)return p==null?null:p.getBarcodeMetadata();let v;return p==null||(v=p.getBarcodeMetadata())==null?g:g.getColumnCount()!==v.getColumnCount()&&g.getErrorCorrectionLevel()!==v.getErrorCorrectionLevel()&&g.getRowCount()!==v.getRowCount()?null:g}static getRowIndicatorColumn(h,p,g,v,N,S){let E=new xE(p,v);for(let D=0;D<2;D++){let $=D===0?1:-1,H=Math.trunc(Math.trunc(g.getX()));for(let Y=Math.trunc(Math.trunc(g.getY()));Y<=p.getMaxY()&&Y>=p.getMinY();Y+=$){let Z=Yt.detectCodeword(h,0,h.getWidth(),v,H,Y,N,S);Z!=null&&(E.setCodeword(Y,Z),v?H=Z.getStartX():H=Z.getEndX())}}return E}static adjustCodewordCount(h,p){let g=p[0][1],v=g.getValue(),N=h.getBarcodeColumnCount()*h.getBarcodeRowCount()-Yt.getNumberOfECCodeWords(h.getBarcodeECLevel());if(v.length===0){if(N<1||N>Lt.MAX_CODEWORDS_IN_BARCODE)throw z.getNotFoundInstance();g.setValue(N)}else v[0]!==N&&g.setValue(N)}static createDecoderResult(h){let p=Yt.createBarcodeMatrix(h);Yt.adjustCodewordCount(h,p);let g=new Array,v=new Int32Array(h.getBarcodeRowCount()*h.getBarcodeColumnCount()),N=[],S=new Array;for(let D=0;D<h.getBarcodeRowCount();D++)for(let $=0;$<h.getBarcodeColumnCount();$++){let H=p[D][$+1].getValue(),Y=D*h.getBarcodeColumnCount()+$;H.length===0?g.push(Y):H.length===1?v[Y]=H[0]:(S.push(Y),N.push(H))}let E=new Array(N.length);for(let D=0;D<E.length;D++)E[D]=N[D];return Yt.createDecoderResultFromAmbiguousValues(h.getBarcodeECLevel(),v,Lt.toIntArray(g),Lt.toIntArray(S),E)}static createDecoderResultFromAmbiguousValues(h,p,g,v,N){let S=new Int32Array(v.length),E=100;for(;E-- >0;){for(let D=0;D<S.length;D++)p[v[D]]=N[D][S[D]];try{return Yt.decodeCodewords(p,h,g)}catch(D){if(!(D instanceof b))throw D}if(S.length===0)throw b.getChecksumInstance();for(let D=0;D<S.length;D++)if(S[D]<N[D].length-1){S[D]++;break}else if(S[D]=0,D===S.length-1)throw b.getChecksumInstance()}throw b.getChecksumInstance()}static createBarcodeMatrix(h){let p=Array.from({length:h.getBarcodeRowCount()},()=>new Array(h.getBarcodeColumnCount()+2));for(let v=0;v<p.length;v++)for(let N=0;N<p[v].length;N++)p[v][N]=new em;let g=0;for(let v of h.getDetectionResultColumns()){if(v!=null){for(let N of v.getCodewords())if(N!=null){let S=N.getRowNumber();if(S>=0){if(S>=p.length)continue;p[S][g].setValue(N.getValue())}}}g++}return p}static isValidBarcodeColumn(h,p){return p>=0&&p<=h.getBarcodeColumnCount()+1}static getStartColumn(h,p,g,v){let N=v?1:-1,S=null;if(Yt.isValidBarcodeColumn(h,p-N)&&(S=h.getDetectionResultColumn(p-N).getCodeword(g)),S!=null)return v?S.getEndX():S.getStartX();if(S=h.getDetectionResultColumn(p).getCodewordNearby(g),S!=null)return v?S.getStartX():S.getEndX();if(Yt.isValidBarcodeColumn(h,p-N)&&(S=h.getDetectionResultColumn(p-N).getCodewordNearby(g)),S!=null)return v?S.getEndX():S.getStartX();let E=0;for(;Yt.isValidBarcodeColumn(h,p-N);){p-=N;for(let D of h.getDetectionResultColumn(p).getCodewords())if(D!=null)return(v?D.getEndX():D.getStartX())+N*E*(D.getEndX()-D.getStartX());E++}return v?h.getBoundingBox().getMinX():h.getBoundingBox().getMaxX()}static detectCodeword(h,p,g,v,N,S,E,D){N=Yt.adjustCodewordStartColumn(h,p,g,v,N,S);let $=Yt.getModuleBitCount(h,p,g,v,N,S);if($==null)return null;let H,Y=be.sum($);if(v)H=N+Y;else{for(let xe=0;xe<$.length/2;xe++){let ve=$[xe];$[xe]=$[$.length-1-xe],$[$.length-1-xe]=ve}H=N,N=H-Y}if(!Yt.checkCodewordSkew(Y,E,D))return null;let Z=da.getDecodedValue($),re=Lt.getCodeword(Z);return re===-1?null:new sm(N,H,Yt.getCodewordBucketNumber(Z),re)}static getModuleBitCount(h,p,g,v,N,S){let E=N,D=new Int32Array(8),$=0,H=v?1:-1,Y=v;for(;(v?E<g:E>=p)&&$<D.length;)h.get(E,S)===Y?(D[$]++,E+=H):($++,Y=!Y);return $===D.length||E===(v?g:p)&&$===D.length-1?D:null}static getNumberOfECCodeWords(h){return 2<<h}static adjustCodewordStartColumn(h,p,g,v,N,S){let E=N,D=v?-1:1;for(let $=0;$<2;$++){for(;(v?E>=p:E<g)&&v===h.get(E,S);){if(Math.abs(N-E)>Yt.CODEWORD_SKEW_SIZE)return N;E+=D}D=-D,v=!v}return E}static checkCodewordSkew(h,p,g){return p-Yt.CODEWORD_SKEW_SIZE<=h&&h<=g+Yt.CODEWORD_SKEW_SIZE}static decodeCodewords(h,p,g){if(h.length===0)throw I.getFormatInstance();let v=1<<p+1,N=Yt.correctErrors(h,g,v);Yt.verifyCodewordCount(h,v);let S=Ie.decode(h,""+p);return S.setErrorsCorrected(N),S.setErasures(g.length),S}static correctErrors(h,p,g){if(p!=null&&p.length>g/2+Yt.MAX_ERRORS||g<0||g>Yt.MAX_EC_CODEWORDS)throw b.getChecksumInstance();return Yt.errorCorrection.decode(h,g,p)}static verifyCodewordCount(h,p){if(h.length<4)throw I.getFormatInstance();let g=h[0];if(g>h.length)throw I.getFormatInstance();if(g===0)if(p<h.length)h[0]=h.length-p;else throw I.getFormatInstance()}static getBitCountForCodeword(h){let p=new Int32Array(8),g=0,v=p.length-1;for(;!((h&1)!==g&&(g=h&1,v--,v<0));)p[v]++,h>>=1;return p}static getCodewordBucketNumber(h){return h instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(h):this.getCodewordBucketNumber_number(h)}static getCodewordBucketNumber_number(h){return Yt.getCodewordBucketNumber(Yt.getBitCountForCodeword(h))}static getCodewordBucketNumber_Int32Array(h){return(h[0]-h[2]+h[4]-h[6]+9)%9}static toString(h){let p=new Zf;for(let g=0;g<h.length;g++){p.format("Row %2d: ",g);for(let v=0;v<h[g].length;v++){let N=h[g][v];N.getValue().length===0?p.format("        ",null):p.format("%4d(%2d)",N.getValue()[0],N.getConfidence(N.getValue()[0]))}p.format("%n")}return p.toString()}}Yt.CODEWORD_SKEW_SIZE=2,Yt.MAX_ERRORS=3,Yt.MAX_EC_CODEWORDS=512,Yt.errorCorrection=new pE;class br{decode(h,p=null){let g=br.decode(h,p,!1);if(g==null||g.length===0||g[0]==null)throw z.getNotFoundInstance();return g[0]}decodeMultiple(h,p=null){try{return br.decode(h,p,!0)}catch(g){throw g instanceof I||g instanceof b?z.getNotFoundInstance():g}}static decode(h,p,g){const v=new Array,N=qt.detectMultiple(h,p,g);for(const S of N.getPoints()){const E=Yt.decode(N.getBits(),S[4],S[5],S[6],S[7],br.getMinCodewordWidth(S),br.getMaxCodewordWidth(S)),D=new ue(E.getText(),E.getRawBytes(),void 0,S,X.PDF_417);D.putMetadata(_e.ERROR_CORRECTION_LEVEL,E.getECLevel());const $=E.getOther();$!=null&&D.putMetadata(_e.PDF417_EXTRA_METADATA,$),v.push(D)}return v.map(S=>S)}static getMaxWidth(h,p){return h==null||p==null?0:Math.trunc(Math.abs(h.getX()-p.getX()))}static getMinWidth(h,p){return h==null||p==null?A.MAX_VALUE:Math.trunc(Math.abs(h.getX()-p.getX()))}static getMaxCodewordWidth(h){return Math.floor(Math.max(Math.max(br.getMaxWidth(h[0],h[4]),br.getMaxWidth(h[6],h[2])*Lt.MODULES_IN_CODEWORD/Lt.MODULES_IN_STOP_PATTERN),Math.max(br.getMaxWidth(h[1],h[5]),br.getMaxWidth(h[7],h[3])*Lt.MODULES_IN_CODEWORD/Lt.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(h){return Math.floor(Math.min(Math.min(br.getMinWidth(h[0],h[4]),br.getMinWidth(h[6],h[2])*Lt.MODULES_IN_CODEWORD/Lt.MODULES_IN_STOP_PATTERN),Math.min(br.getMinWidth(h[1],h[5]),br.getMinWidth(h[7],h[3])*Lt.MODULES_IN_CODEWORD/Lt.MODULES_IN_STOP_PATTERN)))}reset(){}}class Zx extends u{}Zx.kind="ReaderException";class wE{constructor(h,p){this.verbose=h===!0,p&&this.setHints(p)}decode(h,p){return p&&this.setHints(p),this.decodeInternal(h)}decodeWithState(h){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(h)}setHints(h){this.hints=h;const p=!a(h)&&h.get(R.TRY_HARDER)===!0,g=a(h)?null:h.get(R.POSSIBLE_FORMATS),v=new Array;if(!a(g)){const N=g.some(S=>S===X.UPC_A||S===X.UPC_E||S===X.EAN_13||S===X.EAN_8||S===X.CODABAR||S===X.CODE_39||S===X.CODE_93||S===X.CODE_128||S===X.ITF||S===X.RSS_14||S===X.RSS_EXPANDED);N&&!p&&v.push(new Ko(h,this.verbose)),g.includes(X.QR_CODE)&&v.push(new Xo),g.includes(X.DATA_MATRIX)&&v.push(new Q),g.includes(X.AZTEC)&&v.push(new de),g.includes(X.PDF_417)&&v.push(new br),N&&p&&v.push(new Ko(h,this.verbose))}v.length===0&&(p||v.push(new Ko(h,this.verbose)),v.push(new Xo),v.push(new Q),v.push(new de),v.push(new br),p&&v.push(new Ko(h,this.verbose))),this.readers=v}reset(){if(this.readers!==null)for(const h of this.readers)h.reset()}decodeInternal(h){if(this.readers===null)throw new Zx("No readers where selected, nothing can be read.");for(const p of this.readers)try{return p.decode(h,this.hints)}catch(g){if(g instanceof Zx)continue}throw new z("No MultiFormat Readers were able to detect the code.")}}class zK extends pe{constructor(h=null,p=500){const g=new wE;g.setHints(h),super(g,p)}decodeBitmap(h){return this.reader.decodeWithState(h)}}class UK extends pe{constructor(h=500){super(new br,h)}}class VK extends pe{constructor(h=500){super(new Xo,h)}}var kw;(function(K){K[K.ERROR_CORRECTION=0]="ERROR_CORRECTION",K[K.CHARACTER_SET=1]="CHARACTER_SET",K[K.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",K[K.MIN_SIZE=3]="MIN_SIZE",K[K.MAX_SIZE=4]="MAX_SIZE",K[K.MARGIN=5]="MARGIN",K[K.PDF417_COMPACT=6]="PDF417_COMPACT",K[K.PDF417_COMPACTION=7]="PDF417_COMPACTION",K[K.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",K[K.AZTEC_LAYERS=9]="AZTEC_LAYERS",K[K.QR_VERSION=10]="QR_VERSION"})(kw||(kw={}));var $n=kw;class Aw{constructor(h){this.field=h,this.cachedGenerators=[],this.cachedGenerators.push(new fe(h,Int32Array.from([1])))}buildGenerator(h){const p=this.cachedGenerators;if(h>=p.length){let g=p[p.length-1];const v=this.field;for(let N=p.length;N<=h;N++){const S=g.multiply(new fe(v,Int32Array.from([1,v.exp(N-1+v.getGeneratorBase())])));p.push(S),g=S}}return p[h]}encode(h,p){if(p===0)throw new m("No error correction bytes");const g=h.length-p;if(g<=0)throw new m("No data bytes provided");const v=this.buildGenerator(p),N=new Int32Array(g);j.arraycopy(h,0,N,0,g);let S=new fe(this.field,N);S=S.multiplyByMonomial(p,1);const D=S.divide(v)[1].getCoefficients(),$=p-D.length;for(let H=0;H<$;H++)h[g+H]=0;j.arraycopy(D,0,h,g+$,D.length)}}class un{constructor(){}static applyMaskPenaltyRule1(h){return un.applyMaskPenaltyRule1Internal(h,!0)+un.applyMaskPenaltyRule1Internal(h,!1)}static applyMaskPenaltyRule2(h){let p=0;const g=h.getArray(),v=h.getWidth(),N=h.getHeight();for(let S=0;S<N-1;S++){const E=g[S];for(let D=0;D<v-1;D++){const $=E[D];$===E[D+1]&&$===g[S+1][D]&&$===g[S+1][D+1]&&p++}}return un.N2*p}static applyMaskPenaltyRule3(h){let p=0;const g=h.getArray(),v=h.getWidth(),N=h.getHeight();for(let S=0;S<N;S++)for(let E=0;E<v;E++){const D=g[S];E+6<v&&D[E]===1&&D[E+1]===0&&D[E+2]===1&&D[E+3]===1&&D[E+4]===1&&D[E+5]===0&&D[E+6]===1&&(un.isWhiteHorizontal(D,E-4,E)||un.isWhiteHorizontal(D,E+7,E+11))&&p++,S+6<N&&g[S][E]===1&&g[S+1][E]===0&&g[S+2][E]===1&&g[S+3][E]===1&&g[S+4][E]===1&&g[S+5][E]===0&&g[S+6][E]===1&&(un.isWhiteVertical(g,E,S-4,S)||un.isWhiteVertical(g,E,S+7,S+11))&&p++}return p*un.N3}static isWhiteHorizontal(h,p,g){p=Math.max(p,0),g=Math.min(g,h.length);for(let v=p;v<g;v++)if(h[v]===1)return!1;return!0}static isWhiteVertical(h,p,g,v){g=Math.max(g,0),v=Math.min(v,h.length);for(let N=g;N<v;N++)if(h[N][p]===1)return!1;return!0}static applyMaskPenaltyRule4(h){let p=0;const g=h.getArray(),v=h.getWidth(),N=h.getHeight();for(let D=0;D<N;D++){const $=g[D];for(let H=0;H<v;H++)$[H]===1&&p++}const S=h.getHeight()*h.getWidth();return Math.floor(Math.abs(p*2-S)*10/S)*un.N4}static getDataMaskBit(h,p,g){let v,N;switch(h){case 0:v=g+p&1;break;case 1:v=g&1;break;case 2:v=p%3;break;case 3:v=(g+p)%3;break;case 4:v=Math.floor(g/2)+Math.floor(p/3)&1;break;case 5:N=g*p,v=(N&1)+N%3;break;case 6:N=g*p,v=(N&1)+N%3&1;break;case 7:N=g*p,v=N%3+(g+p&1)&1;break;default:throw new m("Invalid mask pattern: "+h)}return v===0}static applyMaskPenaltyRule1Internal(h,p){let g=0;const v=p?h.getHeight():h.getWidth(),N=p?h.getWidth():h.getHeight(),S=h.getArray();for(let E=0;E<v;E++){let D=0,$=-1;for(let H=0;H<N;H++){const Y=p?S[E][H]:S[H][E];Y===$?D++:(D>=5&&(g+=un.N1+(D-5)),D=1,$=Y)}D>=5&&(g+=un.N1+(D-5))}return g}}un.N1=3,un.N2=3,un.N3=40,un.N4=10;class Jx{constructor(h,p){this.width=h,this.height=p;const g=new Array(p);for(let v=0;v!==p;v++)g[v]=new Uint8Array(h);this.bytes=g}getHeight(){return this.height}getWidth(){return this.width}get(h,p){return this.bytes[p][h]}getArray(){return this.bytes}setNumber(h,p,g){this.bytes[p][h]=g}setBoolean(h,p,g){this.bytes[p][h]=g?1:0}clear(h){for(const p of this.bytes)k.fill(p,h)}equals(h){if(!(h instanceof Jx))return!1;const p=h;if(this.width!==p.width||this.height!==p.height)return!1;for(let g=0,v=this.height;g<v;++g){const N=this.bytes[g],S=p.bytes[g];for(let E=0,D=this.width;E<D;++E)if(N[E]!==S[E])return!1}return!0}toString(){const h=new V;for(let p=0,g=this.height;p<g;++p){const v=this.bytes[p];for(let N=0,S=this.width;N<S;++N)switch(v[N]){case 0:h.append(" 0");break;case 1:h.append(" 1");break;default:h.append("  ");break}h.append(`
`)}return h.toString()}}class gd{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const h=new V;return h.append(`<<
`),h.append(" mode: "),h.append(this.mode?this.mode.toString():"null"),h.append(`
 ecLevel: `),h.append(this.ecLevel?this.ecLevel.toString():"null"),h.append(`
 version: `),h.append(this.version?this.version.toString():"null"),h.append(`
 maskPattern: `),h.append(this.maskPattern.toString()),this.matrix?(h.append(`
 matrix:
`),h.append(this.matrix.toString())):h.append(`
 matrix: null
`),h.append(`>>
`),h.toString()}setMode(h){this.mode=h}setECLevel(h){this.ecLevel=h}setVersion(h){this.version=h}setMaskPattern(h){this.maskPattern=h}setMatrix(h){this.matrix=h}static isValidMaskPattern(h){return h>=0&&h<gd.NUM_MASK_PATTERNS}}gd.NUM_MASK_PATTERNS=8;class ks extends u{}ks.kind="WriterException";class It{constructor(){}static clearMatrix(h){h.clear(255)}static buildMatrix(h,p,g,v,N){It.clearMatrix(N),It.embedBasicPatterns(g,N),It.embedTypeInfo(p,v,N),It.maybeEmbedVersionInfo(g,N),It.embedDataBits(h,v,N)}static embedBasicPatterns(h,p){It.embedPositionDetectionPatternsAndSeparators(p),It.embedDarkDotAtLeftBottomCorner(p),It.maybeEmbedPositionAdjustmentPatterns(h,p),It.embedTimingPatterns(p)}static embedTypeInfo(h,p,g){const v=new T;It.makeTypeInfoBits(h,p,v);for(let N=0,S=v.getSize();N<S;++N){const E=v.get(v.getSize()-1-N),D=It.TYPE_INFO_COORDINATES[N],$=D[0],H=D[1];if(g.setBoolean($,H,E),N<8){const Y=g.getWidth()-N-1;g.setBoolean(Y,8,E)}else{const Z=g.getHeight()-7+(N-8);g.setBoolean(8,Z,E)}}}static maybeEmbedVersionInfo(h,p){if(h.getVersionNumber()<7)return;const g=new T;It.makeVersionInfoBits(h,g);let v=6*3-1;for(let N=0;N<6;++N)for(let S=0;S<3;++S){const E=g.get(v);v--,p.setBoolean(N,p.getHeight()-11+S,E),p.setBoolean(p.getHeight()-11+S,N,E)}}static embedDataBits(h,p,g){let v=0,N=-1,S=g.getWidth()-1,E=g.getHeight()-1;for(;S>0;){for(S===6&&(S-=1);E>=0&&E<g.getHeight();){for(let D=0;D<2;++D){const $=S-D;if(!It.isEmpty(g.get($,E)))continue;let H;v<h.getSize()?(H=h.get(v),++v):H=!1,p!==255&&un.getDataMaskBit(p,$,E)&&(H=!H),g.setBoolean($,E,H)}E+=N}N=-N,E+=N,S-=2}if(v!==h.getSize())throw new ks("Not all bits consumed: "+v+"/"+h.getSize())}static findMSBSet(h){return 32-A.numberOfLeadingZeros(h)}static calculateBCHCode(h,p){if(p===0)throw new m("0 polynomial");const g=It.findMSBSet(p);for(h<<=g-1;It.findMSBSet(h)>=g;)h^=p<<It.findMSBSet(h)-g;return h}static makeTypeInfoBits(h,p,g){if(!gd.isValidMaskPattern(p))throw new ks("Invalid mask pattern");const v=h.getBits()<<3|p;g.appendBits(v,5);const N=It.calculateBCHCode(v,It.TYPE_INFO_POLY);g.appendBits(N,10);const S=new T;if(S.appendBits(It.TYPE_INFO_MASK_PATTERN,15),g.xor(S),g.getSize()!==15)throw new ks("should not happen but we got: "+g.getSize())}static makeVersionInfoBits(h,p){p.appendBits(h.getVersionNumber(),6);const g=It.calculateBCHCode(h.getVersionNumber(),It.VERSION_INFO_POLY);if(p.appendBits(g,12),p.getSize()!==18)throw new ks("should not happen but we got: "+p.getSize())}static isEmpty(h){return h===255}static embedTimingPatterns(h){for(let p=8;p<h.getWidth()-8;++p){const g=(p+1)%2;It.isEmpty(h.get(p,6))&&h.setNumber(p,6,g),It.isEmpty(h.get(6,p))&&h.setNumber(6,p,g)}}static embedDarkDotAtLeftBottomCorner(h){if(h.get(8,h.getHeight()-8)===0)throw new ks;h.setNumber(8,h.getHeight()-8,1)}static embedHorizontalSeparationPattern(h,p,g){for(let v=0;v<8;++v){if(!It.isEmpty(g.get(h+v,p)))throw new ks;g.setNumber(h+v,p,0)}}static embedVerticalSeparationPattern(h,p,g){for(let v=0;v<7;++v){if(!It.isEmpty(g.get(h,p+v)))throw new ks;g.setNumber(h,p+v,0)}}static embedPositionAdjustmentPattern(h,p,g){for(let v=0;v<5;++v){const N=It.POSITION_ADJUSTMENT_PATTERN[v];for(let S=0;S<5;++S)g.setNumber(h+S,p+v,N[S])}}static embedPositionDetectionPattern(h,p,g){for(let v=0;v<7;++v){const N=It.POSITION_DETECTION_PATTERN[v];for(let S=0;S<7;++S)g.setNumber(h+S,p+v,N[S])}}static embedPositionDetectionPatternsAndSeparators(h){const p=It.POSITION_DETECTION_PATTERN[0].length;It.embedPositionDetectionPattern(0,0,h),It.embedPositionDetectionPattern(h.getWidth()-p,0,h),It.embedPositionDetectionPattern(0,h.getWidth()-p,h);const g=8;It.embedHorizontalSeparationPattern(0,g-1,h),It.embedHorizontalSeparationPattern(h.getWidth()-g,g-1,h),It.embedHorizontalSeparationPattern(0,h.getWidth()-g,h);const v=7;It.embedVerticalSeparationPattern(v,0,h),It.embedVerticalSeparationPattern(h.getHeight()-v-1,0,h),It.embedVerticalSeparationPattern(v,h.getHeight()-v,h)}static maybeEmbedPositionAdjustmentPatterns(h,p){if(h.getVersionNumber()<2)return;const g=h.getVersionNumber()-1,v=It.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[g];for(let N=0,S=v.length;N!==S;N++){const E=v[N];if(E>=0)for(let D=0;D!==S;D++){const $=v[D];$>=0&&It.isEmpty(p.get($,E))&&It.embedPositionAdjustmentPattern($-2,E-2,p)}}}}It.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),It.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),It.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),It.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),It.VERSION_INFO_POLY=7973,It.TYPE_INFO_POLY=1335,It.TYPE_INFO_MASK_PATTERN=21522;class HK{constructor(h,p){this.dataBytes=h,this.errorCorrectionBytes=p}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class Bs{constructor(){}static calculateMaskPenalty(h){return un.applyMaskPenaltyRule1(h)+un.applyMaskPenaltyRule2(h)+un.applyMaskPenaltyRule3(h)+un.applyMaskPenaltyRule4(h)}static encode(h,p,g=null){let v=Bs.DEFAULT_BYTE_MODE_ENCODING;const N=g!==null&&g.get($n.CHARACTER_SET)!==void 0;N&&(v=g.get($n.CHARACTER_SET).toString());const S=this.chooseMode(h,v),E=new T;if(S===At.BYTE&&(N||Bs.DEFAULT_BYTE_MODE_ENCODING!==v)){const Ze=M.getCharacterSetECIByName(v);Ze!==void 0&&this.appendECI(Ze,E)}this.appendModeInfo(S,E);const D=new T;this.appendBytes(h,S,D,v);let $;if(g!==null&&g.get($n.QR_VERSION)!==void 0){const Ze=Number.parseInt(g.get($n.QR_VERSION).toString(),10);$=St.getVersionForNumber(Ze);const He=this.calculateBitsNeeded(S,E,D,$);if(!this.willFit(He,$,p))throw new ks("Data too big for requested version")}else $=this.recommendVersion(p,S,E,D);const H=new T;H.appendBitArray(E);const Y=S===At.BYTE?D.getSizeInBytes():h.length;this.appendLengthInfo(Y,$,S,H),H.appendBitArray(D);const Z=$.getECBlocksForLevel(p),re=$.getTotalCodewords()-Z.getTotalECCodewords();this.terminateBits(re,H);const xe=this.interleaveWithECBytes(H,$.getTotalCodewords(),re,Z.getNumBlocks()),ve=new gd;ve.setECLevel(p),ve.setMode(S),ve.setVersion($);const Se=$.getDimensionForVersion(),Me=new Jx(Se,Se),Xe=this.chooseMaskPattern(xe,p,$,Me);return ve.setMaskPattern(Xe),It.buildMatrix(xe,p,$,Xe,Me),ve.setMatrix(Me),ve}static recommendVersion(h,p,g,v){const N=this.calculateBitsNeeded(p,g,v,St.getVersionForNumber(1)),S=this.chooseVersion(N,h),E=this.calculateBitsNeeded(p,g,v,S);return this.chooseVersion(E,h)}static calculateBitsNeeded(h,p,g,v){return p.getSize()+h.getCharacterCountBits(v)+g.getSize()}static getAlphanumericCode(h){return h<Bs.ALPHANUMERIC_TABLE.length?Bs.ALPHANUMERIC_TABLE[h]:-1}static chooseMode(h,p=null){if(M.SJIS.getName()===p&&this.isOnlyDoubleByteKanji(h))return At.KANJI;let g=!1,v=!1;for(let N=0,S=h.length;N<S;++N){const E=h.charAt(N);if(Bs.isDigit(E))g=!0;else if(this.getAlphanumericCode(E.charCodeAt(0))!==-1)v=!0;else return At.BYTE}return v?At.ALPHANUMERIC:g?At.NUMERIC:At.BYTE}static isOnlyDoubleByteKanji(h){let p;try{p=L.encode(h,M.SJIS)}catch{return!1}const g=p.length;if(g%2!==0)return!1;for(let v=0;v<g;v+=2){const N=p[v]&255;if((N<129||N>159)&&(N<224||N>235))return!1}return!0}static chooseMaskPattern(h,p,g,v){let N=Number.MAX_SAFE_INTEGER,S=-1;for(let E=0;E<gd.NUM_MASK_PATTERNS;E++){It.buildMatrix(h,p,g,E,v);let D=this.calculateMaskPenalty(v);D<N&&(N=D,S=E)}return S}static chooseVersion(h,p){for(let g=1;g<=40;g++){const v=St.getVersionForNumber(g);if(Bs.willFit(h,v,p))return v}throw new ks("Data too big")}static willFit(h,p,g){const v=p.getTotalCodewords(),S=p.getECBlocksForLevel(g).getTotalECCodewords(),E=v-S,D=(h+7)/8;return E>=D}static terminateBits(h,p){const g=h*8;if(p.getSize()>g)throw new ks("data bits cannot fit in the QR Code"+p.getSize()+" > "+g);for(let S=0;S<4&&p.getSize()<g;++S)p.appendBit(!1);const v=p.getSize()&7;if(v>0)for(let S=v;S<8;S++)p.appendBit(!1);const N=h-p.getSizeInBytes();for(let S=0;S<N;++S)p.appendBits(S&1?17:236,8);if(p.getSize()!==g)throw new ks("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(h,p,g,v,N,S){if(v>=g)throw new ks("Block ID too large");const E=h%g,D=g-E,$=Math.floor(h/g),H=$+1,Y=Math.floor(p/g),Z=Y+1,re=$-Y,xe=H-Z;if(re!==xe)throw new ks("EC bytes mismatch");if(g!==D+E)throw new ks("RS blocks mismatch");if(h!==(Y+re)*D+(Z+xe)*E)throw new ks("Total bytes mismatch");v<D?(N[0]=Y,S[0]=re):(N[0]=Z,S[0]=xe)}static interleaveWithECBytes(h,p,g,v){if(h.getSizeInBytes()!==g)throw new ks("Number of bits and data bytes does not match");let N=0,S=0,E=0;const D=new Array;for(let H=0;H<v;++H){const Y=new Int32Array(1),Z=new Int32Array(1);Bs.getNumDataBytesAndNumECBytesForBlockID(p,g,v,H,Y,Z);const re=Y[0],xe=new Uint8Array(re);h.toBytes(8*N,xe,0,re);const ve=Bs.generateECBytes(xe,Z[0]);D.push(new HK(xe,ve)),S=Math.max(S,re),E=Math.max(E,ve.length),N+=Y[0]}if(g!==N)throw new ks("Data bytes does not match offset");const $=new T;for(let H=0;H<S;++H)for(const Y of D){const Z=Y.getDataBytes();H<Z.length&&$.appendBits(Z[H],8)}for(let H=0;H<E;++H)for(const Y of D){const Z=Y.getErrorCorrectionBytes();H<Z.length&&$.appendBits(Z[H],8)}if(p!==$.getSizeInBytes())throw new ks("Interleaving error: "+p+" and "+$.getSizeInBytes()+" differ.");return $}static generateECBytes(h,p){const g=h.length,v=new Int32Array(g+p);for(let S=0;S<g;S++)v[S]=h[S]&255;new Aw(Ve.QR_CODE_FIELD_256).encode(v,p);const N=new Uint8Array(p);for(let S=0;S<p;S++)N[S]=v[g+S];return N}static appendModeInfo(h,p){p.appendBits(h.getBits(),4)}static appendLengthInfo(h,p,g,v){const N=g.getCharacterCountBits(p);if(h>=1<<N)throw new ks(h+" is bigger than "+((1<<N)-1));v.appendBits(h,N)}static appendBytes(h,p,g,v){switch(p){case At.NUMERIC:Bs.appendNumericBytes(h,g);break;case At.ALPHANUMERIC:Bs.appendAlphanumericBytes(h,g);break;case At.BYTE:Bs.append8BitBytes(h,g,v);break;case At.KANJI:Bs.appendKanjiBytes(h,g);break;default:throw new ks("Invalid mode: "+p)}}static getDigit(h){return h.charCodeAt(0)-48}static isDigit(h){const p=Bs.getDigit(h);return p>=0&&p<=9}static appendNumericBytes(h,p){const g=h.length;let v=0;for(;v<g;){const N=Bs.getDigit(h.charAt(v));if(v+2<g){const S=Bs.getDigit(h.charAt(v+1)),E=Bs.getDigit(h.charAt(v+2));p.appendBits(N*100+S*10+E,10),v+=3}else if(v+1<g){const S=Bs.getDigit(h.charAt(v+1));p.appendBits(N*10+S,7),v+=2}else p.appendBits(N,4),v++}}static appendAlphanumericBytes(h,p){const g=h.length;let v=0;for(;v<g;){const N=Bs.getAlphanumericCode(h.charCodeAt(v));if(N===-1)throw new ks;if(v+1<g){const S=Bs.getAlphanumericCode(h.charCodeAt(v+1));if(S===-1)throw new ks;p.appendBits(N*45+S,11),v+=2}else p.appendBits(N,6),v++}}static append8BitBytes(h,p,g){let v;try{v=L.encode(h,g)}catch(N){throw new ks(N)}for(let N=0,S=v.length;N!==S;N++){const E=v[N];p.appendBits(E,8)}}static appendKanjiBytes(h,p){let g;try{g=L.encode(h,M.SJIS)}catch(N){throw new ks(N)}const v=g.length;for(let N=0;N<v;N+=2){const S=g[N]&255,E=g[N+1]&255,D=S<<8&4294967295|E;let $=-1;if(D>=33088&&D<=40956?$=D-33088:D>=57408&&D<=60351&&($=D-49472),$===-1)throw new ks("Invalid byte sequence");const H=($>>8)*192+($&255);p.appendBits(H,13)}}static appendECI(h,p){p.appendBits(At.ECI.getBits(),4),p.appendBits(h.getValue(),8)}}Bs.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),Bs.DEFAULT_BYTE_MODE_ENCODING=M.UTF8.getName();class yd{write(h,p,g,v=null){if(h.length===0)throw new m("Found empty contents");if(p<0||g<0)throw new m("Requested dimensions are too small: "+p+"x"+g);let N=ot.L,S=yd.QUIET_ZONE_SIZE;v!==null&&(v.get($n.ERROR_CORRECTION)!==void 0&&(N=ot.fromString(v.get($n.ERROR_CORRECTION).toString())),v.get($n.MARGIN)!==void 0&&(S=Number.parseInt(v.get($n.MARGIN).toString(),10)));const E=Bs.encode(h,N,v);return this.renderResult(E,p,g,S)}writeToDom(h,p,g,v,N=null){typeof h=="string"&&(h=document.querySelector(h));const S=this.write(p,g,v,N);h&&h.appendChild(S)}renderResult(h,p,g,v){const N=h.getMatrix();if(N===null)throw new wt;const S=N.getWidth(),E=N.getHeight(),D=S+v*2,$=E+v*2,H=Math.max(p,D),Y=Math.max(g,$),Z=Math.min(Math.floor(H/D),Math.floor(Y/$)),re=Math.floor((H-S*Z)/2),xe=Math.floor((Y-E*Z)/2),ve=this.createSVGElement(H,Y);for(let Se=0,Me=xe;Se<E;Se++,Me+=Z)for(let Xe=0,Ze=re;Xe<S;Xe++,Ze+=Z)if(N.get(Xe,Se)===1){const He=this.createSvgRectElement(Ze,Me,Z,Z);ve.appendChild(He)}return ve}createSVGElement(h,p){const g=document.createElementNS(yd.SVG_NS,"svg");return g.setAttributeNS(null,"height",h.toString()),g.setAttributeNS(null,"width",p.toString()),g}createSvgRectElement(h,p,g,v){const N=document.createElementNS(yd.SVG_NS,"rect");return N.setAttributeNS(null,"x",h.toString()),N.setAttributeNS(null,"y",p.toString()),N.setAttributeNS(null,"height",g.toString()),N.setAttributeNS(null,"width",v.toString()),N.setAttributeNS(null,"fill","#000000"),N}}yd.QUIET_ZONE_SIZE=4,yd.SVG_NS="http://www.w3.org/2000/svg";class Hu{encode(h,p,g,v,N){if(h.length===0)throw new m("Found empty contents");if(p!==X.QR_CODE)throw new m("Can only encode QR_CODE, but got "+p);if(g<0||v<0)throw new m(`Requested dimensions are too small: ${g}x${v}`);let S=ot.L,E=Hu.QUIET_ZONE_SIZE;N!==null&&(N.get($n.ERROR_CORRECTION)!==void 0&&(S=ot.fromString(N.get($n.ERROR_CORRECTION).toString())),N.get($n.MARGIN)!==void 0&&(E=Number.parseInt(N.get($n.MARGIN).toString(),10)));const D=Bs.encode(h,S,N);return Hu.renderResult(D,g,v,E)}static renderResult(h,p,g,v){const N=h.getMatrix();if(N===null)throw new wt;const S=N.getWidth(),E=N.getHeight(),D=S+v*2,$=E+v*2,H=Math.max(p,D),Y=Math.max(g,$),Z=Math.min(Math.floor(H/D),Math.floor(Y/$)),re=Math.floor((H-S*Z)/2),xe=Math.floor((Y-E*Z)/2),ve=new U(H,Y);for(let Se=0,Me=xe;Se<E;Se++,Me+=Z)for(let Xe=0,Ze=re;Xe<S;Xe++,Ze+=Z)N.get(Xe,Se)===1&&ve.setRegion(Ze,Me,Z,Z);return ve}}Hu.QUIET_ZONE_SIZE=4;class WK{encode(h,p,g,v,N){let S;switch(p){case X.QR_CODE:S=new Hu;break;default:throw new m("No encoder available for format "+p)}return S.encode(h,p,g,v,N)}}class xl extends G{constructor(h,p,g,v,N,S,E,D){if(super(S,E),this.yuvData=h,this.dataWidth=p,this.dataHeight=g,this.left=v,this.top=N,v+S>p||N+E>g)throw new m("Crop rectangle does not fit within image data.");D&&this.reverseHorizontal(S,E)}getRow(h,p){if(h<0||h>=this.getHeight())throw new m("Requested row is outside the image: "+h);const g=this.getWidth();(p==null||p.length<g)&&(p=new Uint8ClampedArray(g));const v=(h+this.top)*this.dataWidth+this.left;return j.arraycopy(this.yuvData,v,p,0,g),p}getMatrix(){const h=this.getWidth(),p=this.getHeight();if(h===this.dataWidth&&p===this.dataHeight)return this.yuvData;const g=h*p,v=new Uint8ClampedArray(g);let N=this.top*this.dataWidth+this.left;if(h===this.dataWidth)return j.arraycopy(this.yuvData,N,v,0,g),v;for(let S=0;S<p;S++){const E=S*h;j.arraycopy(this.yuvData,N,v,E,h),N+=this.dataWidth}return v}isCropSupported(){return!0}crop(h,p,g,v){return new xl(this.yuvData,this.dataWidth,this.dataHeight,this.left+h,this.top+p,g,v,!1)}renderThumbnail(){const h=this.getWidth()/xl.THUMBNAIL_SCALE_FACTOR,p=this.getHeight()/xl.THUMBNAIL_SCALE_FACTOR,g=new Int32Array(h*p),v=this.yuvData;let N=this.top*this.dataWidth+this.left;for(let S=0;S<p;S++){const E=S*h;for(let D=0;D<h;D++){const $=v[N+D*xl.THUMBNAIL_SCALE_FACTOR]&255;g[E+D]=4278190080|$*65793}N+=this.dataWidth*xl.THUMBNAIL_SCALE_FACTOR}return g}getThumbnailWidth(){return this.getWidth()/xl.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/xl.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(h,p){const g=this.yuvData;for(let v=0,N=this.top*this.dataWidth+this.left;v<p;v++,N+=this.dataWidth){const S=N+h/2;for(let E=N,D=N+h-1;E<S;E++,D--){const $=g[E];g[E]=g[D],g[D]=$}}}invert(){return new se(this)}}xl.THUMBNAIL_SCALE_FACTOR=2;class Ew extends G{constructor(h,p,g,v,N,S,E){if(super(p,g),this.dataWidth=v,this.dataHeight=N,this.left=S,this.top=E,h.BYTES_PER_ELEMENT===4){const D=p*g,$=new Uint8ClampedArray(D);for(let H=0;H<D;H++){const Y=h[H],Z=Y>>16&255,re=Y>>7&510,xe=Y&255;$[H]=(Z+re+xe)/4&255}this.luminances=$}else this.luminances=h;if(v===void 0&&(this.dataWidth=p),N===void 0&&(this.dataHeight=g),S===void 0&&(this.left=0),E===void 0&&(this.top=0),this.left+p>this.dataWidth||this.top+g>this.dataHeight)throw new m("Crop rectangle does not fit within image data.")}getRow(h,p){if(h<0||h>=this.getHeight())throw new m("Requested row is outside the image: "+h);const g=this.getWidth();(p==null||p.length<g)&&(p=new Uint8ClampedArray(g));const v=(h+this.top)*this.dataWidth+this.left;return j.arraycopy(this.luminances,v,p,0,g),p}getMatrix(){const h=this.getWidth(),p=this.getHeight();if(h===this.dataWidth&&p===this.dataHeight)return this.luminances;const g=h*p,v=new Uint8ClampedArray(g);let N=this.top*this.dataWidth+this.left;if(h===this.dataWidth)return j.arraycopy(this.luminances,N,v,0,g),v;for(let S=0;S<p;S++){const E=S*h;j.arraycopy(this.luminances,N,v,E,h),N+=this.dataWidth}return v}isCropSupported(){return!0}crop(h,p,g,v){return new Ew(this.luminances,g,v,this.dataWidth,this.dataHeight,this.left+h,this.top+p)}invert(){return new se(this)}}class NE extends M{static forName(h){return this.getCharacterSetECIByName(h)}}class Tw{}Tw.ISO_8859_1=M.ISO8859_1;class jE{isCompact(){return this.compact}setCompact(h){this.compact=h}getSize(){return this.size}setSize(h){this.size=h}getLayers(){return this.layers}setLayers(h){this.layers=h}getCodeWords(){return this.codeWords}setCodeWords(h){this.codeWords=h}getMatrix(){return this.matrix}setMatrix(h){this.matrix=h}}class _E{static singletonList(h){return[h]}static min(h,p){return h.sort(p)[0]}}class qK{constructor(h){this.previous=h}getPrevious(){return this.previous}}class Wu extends qK{constructor(h,p,g){super(h),this.value=p,this.bitCount=g}appendTo(h,p){h.appendBits(this.value,this.bitCount)}add(h,p){return new Wu(this,h,p)}addBinaryShift(h,p){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Wu(this,h,p)}toString(){let h=this.value&(1<<this.bitCount)-1;return h|=1<<this.bitCount,"<"+A.toBinaryString(h|1<<this.bitCount).substring(1)+">"}}class Pw extends Wu{constructor(h,p,g){super(h,0,0),this.binaryShiftStart=p,this.binaryShiftByteCount=g}appendTo(h,p){for(let g=0;g<this.binaryShiftByteCount;g++)(g===0||g===31&&this.binaryShiftByteCount<=62)&&(h.appendBits(31,5),this.binaryShiftByteCount>62?h.appendBits(this.binaryShiftByteCount-31,16):g===0?h.appendBits(Math.min(this.binaryShiftByteCount,31),5):h.appendBits(this.binaryShiftByteCount-31,5)),h.appendBits(p[this.binaryShiftStart+g],8)}addBinaryShift(h,p){return new Pw(this,h,p)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function GK(K,h,p){return new Pw(K,h,p)}function nm(K,h,p){return new Wu(K,h,p)}const KK=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Zo=0,e0=1,ui=2,SE=3,gl=4,YK=new Wu(null,0,0),Iw=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function XK(K){for(let h of K)k.fill(h,-1);return K[Zo][gl]=0,K[e0][gl]=0,K[e0][Zo]=28,K[SE][gl]=0,K[ui][gl]=0,K[ui][Zo]=15,K}const CE=XK(k.createInt32Array(6,6));class yl{constructor(h,p,g,v){this.token=h,this.mode=p,this.binaryShiftByteCount=g,this.bitCount=v}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(h,p){let g=this.bitCount,v=this.token;if(h!==this.mode){let S=Iw[this.mode][h];v=nm(v,S&65535,S>>16),g+=S>>16}let N=h===ui?4:5;return v=nm(v,p,N),new yl(v,h,0,g+N)}shiftAndAppend(h,p){let g=this.token,v=this.mode===ui?4:5;return g=nm(g,CE[this.mode][h],v),g=nm(g,p,5),new yl(g,this.mode,0,this.bitCount+v+5)}addBinaryShiftChar(h){let p=this.token,g=this.mode,v=this.bitCount;if(this.mode===gl||this.mode===ui){let E=Iw[g][Zo];p=nm(p,E&65535,E>>16),v+=E>>16,g=Zo}let N=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,S=new yl(p,g,this.binaryShiftByteCount+1,v+N);return S.binaryShiftByteCount===2078&&(S=S.endBinaryShift(h+1)),S}endBinaryShift(h){if(this.binaryShiftByteCount===0)return this;let p=this.token;return p=GK(p,h-this.binaryShiftByteCount,this.binaryShiftByteCount),new yl(p,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(h){let p=this.bitCount+(Iw[this.mode][h.mode]>>16);return this.binaryShiftByteCount<h.binaryShiftByteCount?p+=yl.calculateBinaryShiftCost(h)-yl.calculateBinaryShiftCost(this):this.binaryShiftByteCount>h.binaryShiftByteCount&&h.binaryShiftByteCount>0&&(p+=10),p<=h.bitCount}toBitArray(h){let p=[];for(let v=this.endBinaryShift(h.length).token;v!==null;v=v.getPrevious())p.unshift(v);let g=new T;for(const v of p)v.appendTo(g,h);return g}toString(){return F.format("%s bits=%d bytes=%d",KK[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(h){return h.binaryShiftByteCount>62?21:h.binaryShiftByteCount>31?20:h.binaryShiftByteCount>0?10:0}}yl.INITIAL_STATE=new yl(YK,Zo,0,0);function QK(K){const h=F.getCharCode(" "),p=F.getCharCode("."),g=F.getCharCode(",");K[Zo][h]=1;const v=F.getCharCode("Z"),N=F.getCharCode("A");for(let Z=N;Z<=v;Z++)K[Zo][Z]=Z-N+2;K[e0][h]=1;const S=F.getCharCode("z"),E=F.getCharCode("a");for(let Z=E;Z<=S;Z++)K[e0][Z]=Z-E+2;K[ui][h]=1;const D=F.getCharCode("9"),$=F.getCharCode("0");for(let Z=$;Z<=D;Z++)K[ui][Z]=Z-$+2;K[ui][g]=12,K[ui][p]=13;const H=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let Z=0;Z<H.length;Z++)K[SE][F.getCharCode(H[Z])]=Z;const Y=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let Z=0;Z<Y.length;Z++)F.getCharCode(Y[Z])>0&&(K[gl][F.getCharCode(Y[Z])]=Z);return K}const Mw=QK(k.createInt32Array(5,256));class rm{constructor(h){this.text=h}encode(){const h=F.getCharCode(" "),p=F.getCharCode(`
`);let g=_E.singletonList(yl.INITIAL_STATE);for(let N=0;N<this.text.length;N++){let S,E=N+1<this.text.length?this.text[N+1]:0;switch(this.text[N]){case F.getCharCode("\r"):S=E===p?2:0;break;case F.getCharCode("."):S=E===h?3:0;break;case F.getCharCode(","):S=E===h?4:0;break;case F.getCharCode(":"):S=E===h?5:0;break;default:S=0}S>0?(g=rm.updateStateListForPair(g,N,S),N++):g=this.updateStateListForChar(g,N)}return _E.min(g,(N,S)=>N.getBitCount()-S.getBitCount()).toBitArray(this.text)}updateStateListForChar(h,p){const g=[];for(let v of h)this.updateStateForChar(v,p,g);return rm.simplifyStates(g)}updateStateForChar(h,p,g){let v=this.text[p]&255,N=Mw[h.getMode()][v]>0,S=null;for(let E=0;E<=gl;E++){let D=Mw[E][v];if(D>0){if(S==null&&(S=h.endBinaryShift(p)),!N||E===h.getMode()||E===ui){const $=S.latchAndAppend(E,D);g.push($)}if(!N&&CE[h.getMode()][E]>=0){const $=S.shiftAndAppend(E,D);g.push($)}}}if(h.getBinaryShiftByteCount()>0||Mw[h.getMode()][v]===0){let E=h.addBinaryShiftChar(p);g.push(E)}}static updateStateListForPair(h,p,g){const v=[];for(let N of h)this.updateStateForPair(N,p,g,v);return this.simplifyStates(v)}static updateStateForPair(h,p,g,v){let N=h.endBinaryShift(p);if(v.push(N.latchAndAppend(gl,g)),h.getMode()!==gl&&v.push(N.shiftAndAppend(gl,g)),g===3||g===4){let S=N.latchAndAppend(ui,16-g).latchAndAppend(ui,1);v.push(S)}if(h.getBinaryShiftByteCount()>0){let S=h.addBinaryShiftChar(p).addBinaryShiftChar(p+1);v.push(S)}}static simplifyStates(h){let p=[];for(const g of h){let v=!0;for(const N of p){if(N.isBetterThanOrEqualTo(g)){v=!1;break}g.isBetterThanOrEqualTo(N)&&(p=p.filter(S=>S!==N))}v&&p.push(g)}return p}}class rs{constructor(){}static encodeBytes(h){return rs.encode(h,rs.DEFAULT_EC_PERCENT,rs.DEFAULT_AZTEC_LAYERS)}static encode(h,p,g){let v=new rm(h).encode(),N=A.truncDivision(v.getSize()*p,100)+11,S=v.getSize()+N,E,D,$,H,Y;if(g!==rs.DEFAULT_AZTEC_LAYERS){if(E=g<0,D=Math.abs(g),D>(E?rs.MAX_NB_BITS_COMPACT:rs.MAX_NB_BITS))throw new m(F.format("Illegal value %s for layers",g));$=rs.totalBitsInLayer(D,E),H=rs.WORD_SIZE[D];let He=$-$%H;if(Y=rs.stuffBits(v,H),Y.getSize()+N>He)throw new m("Data to large for user specified layer");if(E&&Y.getSize()>H*64)throw new m("Data to large for user specified layer")}else{H=0,Y=null;for(let He=0;;He++){if(He>rs.MAX_NB_BITS)throw new m("Data too large for an Aztec code");if(E=He<=3,D=E?He+1:He,$=rs.totalBitsInLayer(D,E),S>$)continue;(Y==null||H!==rs.WORD_SIZE[D])&&(H=rs.WORD_SIZE[D],Y=rs.stuffBits(v,H));let ts=$-$%H;if(!(E&&Y.getSize()>H*64)&&Y.getSize()+N<=ts)break}}let Z=rs.generateCheckWords(Y,$,H),re=Y.getSize()/H,xe=rs.generateModeMessage(E,D,re),ve=(E?11:14)+D*4,Se=new Int32Array(ve),Me;if(E){Me=ve;for(let He=0;He<Se.length;He++)Se[He]=He}else{Me=ve+1+2*A.truncDivision(A.truncDivision(ve,2)-1,15);let He=A.truncDivision(ve,2),ts=A.truncDivision(Me,2);for(let Vt=0;Vt<He;Vt++){let ua=Vt+A.truncDivision(Vt,15);Se[He-Vt-1]=ts-ua-1,Se[He+Vt]=ts+ua+1}}let Xe=new U(Me);for(let He=0,ts=0;He<D;He++){let Vt=(D-He)*4+(E?9:12);for(let ua=0;ua<Vt;ua++){let $i=ua*2;for(let ha=0;ha<2;ha++)Z.get(ts+$i+ha)&&Xe.set(Se[He*2+ha],Se[He*2+ua]),Z.get(ts+Vt*2+$i+ha)&&Xe.set(Se[He*2+ua],Se[ve-1-He*2-ha]),Z.get(ts+Vt*4+$i+ha)&&Xe.set(Se[ve-1-He*2-ha],Se[ve-1-He*2-ua]),Z.get(ts+Vt*6+$i+ha)&&Xe.set(Se[ve-1-He*2-ua],Se[He*2+ha])}ts+=Vt*8}if(rs.drawModeMessage(Xe,E,Me,xe),E)rs.drawBullsEye(Xe,A.truncDivision(Me,2),5);else{rs.drawBullsEye(Xe,A.truncDivision(Me,2),7);for(let He=0,ts=0;He<A.truncDivision(ve,2)-1;He+=15,ts+=16)for(let Vt=A.truncDivision(Me,2)&1;Vt<Me;Vt+=2)Xe.set(A.truncDivision(Me,2)-ts,Vt),Xe.set(A.truncDivision(Me,2)+ts,Vt),Xe.set(Vt,A.truncDivision(Me,2)-ts),Xe.set(Vt,A.truncDivision(Me,2)+ts)}let Ze=new jE;return Ze.setCompact(E),Ze.setSize(Me),Ze.setLayers(D),Ze.setCodeWords(re),Ze.setMatrix(Xe),Ze}static drawBullsEye(h,p,g){for(let v=0;v<g;v+=2)for(let N=p-v;N<=p+v;N++)h.set(N,p-v),h.set(N,p+v),h.set(p-v,N),h.set(p+v,N);h.set(p-g,p-g),h.set(p-g+1,p-g),h.set(p-g,p-g+1),h.set(p+g,p-g),h.set(p+g,p-g+1),h.set(p+g,p+g-1)}static generateModeMessage(h,p,g){let v=new T;return h?(v.appendBits(p-1,2),v.appendBits(g-1,6),v=rs.generateCheckWords(v,28,4)):(v.appendBits(p-1,5),v.appendBits(g-1,11),v=rs.generateCheckWords(v,40,4)),v}static drawModeMessage(h,p,g,v){let N=A.truncDivision(g,2);if(p)for(let S=0;S<7;S++){let E=N-3+S;v.get(S)&&h.set(E,N-5),v.get(S+7)&&h.set(N+5,E),v.get(20-S)&&h.set(E,N+5),v.get(27-S)&&h.set(N-5,E)}else for(let S=0;S<10;S++){let E=N-5+S+A.truncDivision(S,5);v.get(S)&&h.set(E,N-7),v.get(S+10)&&h.set(N+7,E),v.get(29-S)&&h.set(E,N+7),v.get(39-S)&&h.set(N-7,E)}}static generateCheckWords(h,p,g){let v=h.getSize()/g,N=new Aw(rs.getGF(g)),S=A.truncDivision(p,g),E=rs.bitsToWords(h,g,S);N.encode(E,S-v);let D=p%g,$=new T;$.appendBits(0,D);for(const H of Array.from(E))$.appendBits(H,g);return $}static bitsToWords(h,p,g){let v=new Int32Array(g),N,S;for(N=0,S=h.getSize()/p;N<S;N++){let E=0;for(let D=0;D<p;D++)E|=h.get(N*p+D)?1<<p-D-1:0;v[N]=E}return v}static getGF(h){switch(h){case 4:return Ve.AZTEC_PARAM;case 6:return Ve.AZTEC_DATA_6;case 8:return Ve.AZTEC_DATA_8;case 10:return Ve.AZTEC_DATA_10;case 12:return Ve.AZTEC_DATA_12;default:throw new m("Unsupported word size "+h)}}static stuffBits(h,p){let g=new T,v=h.getSize(),N=(1<<p)-2;for(let S=0;S<v;S+=p){let E=0;for(let D=0;D<p;D++)(S+D>=v||h.get(S+D))&&(E|=1<<p-1-D);(E&N)===N?(g.appendBits(E&N,p),S--):E&N?g.appendBits(E,p):(g.appendBits(E|1,p),S--)}return g}static totalBitsInLayer(h,p){return((p?88:112)+16*h)*h}}rs.DEFAULT_EC_PERCENT=33,rs.DEFAULT_AZTEC_LAYERS=0,rs.MAX_NB_BITS=32,rs.MAX_NB_BITS_COMPACT=4,rs.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class t0{encode(h,p,g,v){return this.encodeWithHints(h,p,g,v,null)}encodeWithHints(h,p,g,v,N){let S=Tw.ISO_8859_1,E=rs.DEFAULT_EC_PERCENT,D=rs.DEFAULT_AZTEC_LAYERS;return N!=null&&(N.has($n.CHARACTER_SET)&&(S=NE.forName(N.get($n.CHARACTER_SET).toString())),N.has($n.ERROR_CORRECTION)&&(E=A.parseInt(N.get($n.ERROR_CORRECTION).toString())),N.has($n.AZTEC_LAYERS)&&(D=A.parseInt(N.get($n.AZTEC_LAYERS).toString()))),t0.encodeLayers(h,p,g,v,S,E,D)}static encodeLayers(h,p,g,v,N,S,E){if(p!==X.AZTEC)throw new m("Can only encode AZTEC, but got "+p);let D=rs.encode(F.getBytes(h,N),S,E);return t0.renderResult(D,g,v)}static renderResult(h,p,g){let v=h.getMatrix();if(v==null)throw new wt;let N=v.getWidth(),S=v.getHeight(),E=Math.max(p,N),D=Math.max(g,S),$=Math.min(E/N,D/S),H=(E-N*$)/2,Y=(D-S*$)/2,Z=new U(E,D);for(let re=0,xe=Y;re<S;re++,xe+=$)for(let ve=0,Se=H;ve<N;ve++,Se+=$)v.get(ve,re)&&Z.setRegion(Se,xe,$,$);return Z}}n.AbstractExpandedDecoder=ml,n.ArgumentException=f,n.ArithmeticException=le,n.AztecCode=jE,n.AztecCodeReader=de,n.AztecCodeWriter=t0,n.AztecDecoder=bt,n.AztecDetector=Te,n.AztecDetectorResult=Be,n.AztecEncoder=rs,n.AztecHighLevelEncoder=rm,n.AztecPoint=ae,n.BarcodeFormat=X,n.Binarizer=w,n.BinaryBitmap=x,n.BitArray=T,n.BitMatrix=U,n.BitSource=Xf,n.BrowserAztecCodeReader=Pe,n.BrowserBarcodeReader=pd,n.BrowserCodeReader=pe,n.BrowserDatamatrixCodeReader=Ce,n.BrowserMultiFormatReader=zK,n.BrowserPDF417Reader=UK,n.BrowserQRCodeReader=VK,n.BrowserQRCodeSvgWriter=yd,n.CharacterSetECI=M,n.ChecksumException=b,n.Code128Reader=Le,n.Code39Reader=Dt,n.DataMatrixDecodedBitStreamParser=Fi,n.DataMatrixReader=Q,n.DecodeHintType=R,n.DecoderResult=ce,n.DefaultGridSampler=Cs,n.DetectorResult=Ne,n.EAN13Reader=Gt,n.EncodeHintType=$n,n.Exception=u,n.FormatException=I,n.GenericGF=Ve,n.GenericGFPoly=fe,n.GlobalHistogramBinarizer=W,n.GridSampler=yt,n.GridSamplerInstance=hs,n.HTMLCanvasElementLuminanceSource=ge,n.HybridBinarizer=q,n.ITFReader=Rt,n.IllegalArgumentException=m,n.IllegalStateException=wt,n.InvertedLuminanceSource=se,n.LuminanceSource=G,n.MathUtils=be,n.MultiFormatOneDReader=Ko,n.MultiFormatReader=wE,n.MultiFormatWriter=WK,n.NotFoundException=z,n.OneDReader=Ue,n.PDF417DecodedBitStreamParser=Ie,n.PDF417DecoderErrorCorrection=pE,n.PDF417Reader=br,n.PDF417ResultMetadata=gE,n.PerspectiveTransform=pt,n.PlanarYUVLuminanceSource=xl,n.QRCodeByteMatrix=Jx,n.QRCodeDataMask=ci,n.QRCodeDecodedBitStreamParser=Zs,n.QRCodeDecoderErrorCorrectionLevel=ot,n.QRCodeDecoderFormatInformation=Ft,n.QRCodeEncoder=Bs,n.QRCodeEncoderQRCode=gd,n.QRCodeMaskUtil=un,n.QRCodeMatrixUtil=It,n.QRCodeMode=At,n.QRCodeReader=Xo,n.QRCodeVersion=St,n.QRCodeWriter=Hu,n.RGBLuminanceSource=Ew,n.RSS14Reader=Vs,n.RSSExpandedReader=ze,n.ReaderException=Zx,n.ReedSolomonDecoder=mt,n.ReedSolomonEncoder=Aw,n.ReedSolomonException=Ke,n.Result=ue,n.ResultMetadataType=_e,n.ResultPoint=me,n.StringUtils=F,n.UnsupportedOperationException=B,n.VideoInputDevice=ke,n.WhiteRectangleDetector=jt,n.WriterException=ks,n.ZXingArrays=k,n.ZXingCharset=NE,n.ZXingInteger=A,n.ZXingStandardCharsets=Tw,n.ZXingStringBuilder=V,n.ZXingStringEncoding=L,n.ZXingSystem=j,n.createAbstractExpandedDecoder=md,Object.defineProperty(n,"__esModule",{value:!0})})})(gC,gC.exports);var $s=gC.exports;const t8e=Mi($s),s8e=l6({__proto__:null,default:t8e},[$s]);var BR=function(){function t(s,n,a){if(this.formatMap=new Map([[dt.QR_CODE,$s.BarcodeFormat.QR_CODE],[dt.AZTEC,$s.BarcodeFormat.AZTEC],[dt.CODABAR,$s.BarcodeFormat.CODABAR],[dt.CODE_39,$s.BarcodeFormat.CODE_39],[dt.CODE_93,$s.BarcodeFormat.CODE_93],[dt.CODE_128,$s.BarcodeFormat.CODE_128],[dt.DATA_MATRIX,$s.BarcodeFormat.DATA_MATRIX],[dt.MAXICODE,$s.BarcodeFormat.MAXICODE],[dt.ITF,$s.BarcodeFormat.ITF],[dt.EAN_13,$s.BarcodeFormat.EAN_13],[dt.EAN_8,$s.BarcodeFormat.EAN_8],[dt.PDF_417,$s.BarcodeFormat.PDF_417],[dt.RSS_14,$s.BarcodeFormat.RSS_14],[dt.RSS_EXPANDED,$s.BarcodeFormat.RSS_EXPANDED],[dt.UPC_A,$s.BarcodeFormat.UPC_A],[dt.UPC_E,$s.BarcodeFormat.UPC_E],[dt.UPC_EAN_EXTENSION,$s.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!s8e)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=n,this.logger=a;var i=this.createZXingFormats(s),l=new Map;l.set($s.DecodeHintType.POSSIBLE_FORMATS,i),l.set($s.DecodeHintType.TRY_HARDER,!1),this.hints=l}return t.prototype.decodeAsync=function(s){var n=this;return new Promise(function(a,i){try{a(n.decode(s))}catch(l){i(l)}})},t.prototype.decode=function(s){var n=new $s.MultiFormatReader(this.verbose,this.hints),a=new $s.HTMLCanvasElementLuminanceSource(s),i=new $s.BinaryBitmap(new $s.HybridBinarizer(a)),l=n.decode(i);return{text:l.text,format:hK.create(this.toHtml5QrcodeSupportedFormats(l.format)),debugData:this.createDebugData()}},t.prototype.createReverseFormatMap=function(){var s=new Map;return this.formatMap.forEach(function(n,a,i){s.set(n,a)}),s},t.prototype.toHtml5QrcodeSupportedFormats=function(s){if(!this.reverseFormatMap.has(s))throw"reverseFormatMap doesn't have ".concat(s);return this.reverseFormatMap.get(s)},t.prototype.createZXingFormats=function(s){for(var n=[],a=0,i=s;a<i.length;a++){var l=i[a];this.formatMap.has(l)?n.push(this.formatMap.get(l)):this.logger.logError("".concat(l," is not supported by")+"ZXingHtml5QrcodeShim")}return n},t.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},t}(),n8e=function(t,s,n,a){function i(l){return l instanceof n?l:new n(function(o){o(l)})}return new(n||(n=Promise))(function(l,o){function c(f){try{u(a.next(f))}catch(m){o(m)}}function d(f){try{u(a.throw(f))}catch(m){o(m)}}function u(f){f.done?l(f.value):i(f.value).then(c,d)}u((a=a.apply(t,s||[])).next())})},r8e=function(t,s){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,i,l,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(f){return d([u,f])}}function d(u){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(n=0)),n;)try{if(a=1,i&&(l=u[0]&2?i.return:u[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,u[1])).done)return l;switch(i=0,l&&(u=[u[0]&2,l.value]),u[0]){case 0:case 1:l=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,i=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!l||u[1]>l[0]&&u[1]<l[3])){n.label=u[1];break}if(u[0]===6&&n.label<l[1]){n.label=l[1],l=u;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(u);break}l[2]&&n.ops.pop(),n.trys.pop();continue}u=s.call(t,n)}catch(f){u=[6,f],i=0}finally{a=l=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},FR=function(){function t(s,n,a){if(this.formatMap=new Map([[dt.QR_CODE,"qr_code"],[dt.AZTEC,"aztec"],[dt.CODABAR,"codabar"],[dt.CODE_39,"code_39"],[dt.CODE_93,"code_93"],[dt.CODE_128,"code_128"],[dt.DATA_MATRIX,"data_matrix"],[dt.ITF,"itf"],[dt.EAN_13,"ean_13"],[dt.EAN_8,"ean_8"],[dt.PDF_417,"pdf417"],[dt.UPC_A,"upc_a"],[dt.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!t.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=n,this.logger=a;var i=this.createBarcodeDetectorFormats(s);if(this.detector=new BarcodeDetector(i),!this.detector)throw"BarcodeDetector detector not supported"}return t.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var s=new BarcodeDetector({formats:["qr_code"]});return typeof s<"u"},t.prototype.decodeAsync=function(s){return n8e(this,void 0,void 0,function(){var n,a;return r8e(this,function(i){switch(i.label){case 0:return[4,this.detector.detect(s)];case 1:if(n=i.sent(),!n||n.length===0)throw"No barcode or QR code detected.";return a=this.selectLargestBarcode(n),[2,{text:a.rawValue,format:hK.create(this.toHtml5QrcodeSupportedFormats(a.format)),debugData:this.createDebugData()}]}})})},t.prototype.selectLargestBarcode=function(s){for(var n=null,a=0,i=0,l=s;i<l.length;i++){var o=l[i],c=o.boundingBox.width*o.boundingBox.height;c>a&&(a=c,n=o)}if(!n)throw"No largest barcode found";return n},t.prototype.createBarcodeDetectorFormats=function(s){for(var n=[],a=0,i=s;a<i.length;a++){var l=i[a];this.formatMap.has(l)?n.push(this.formatMap.get(l)):this.logger.warn("".concat(l," is not supported by")+"BarcodeDetectorDelegate")}return{formats:n}},t.prototype.toHtml5QrcodeSupportedFormats=function(s){if(!this.reverseFormatMap.has(s))throw"reverseFormatMap doesn't have ".concat(s);return this.reverseFormatMap.get(s)},t.prototype.createReverseFormatMap=function(){var s=new Map;return this.formatMap.forEach(function(n,a,i){s.set(n,a)}),s},t.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},t}(),$R=function(t,s,n,a){function i(l){return l instanceof n?l:new n(function(o){o(l)})}return new(n||(n=Promise))(function(l,o){function c(f){try{u(a.next(f))}catch(m){o(m)}}function d(f){try{u(a.throw(f))}catch(m){o(m)}}function u(f){f.done?l(f.value):i(f.value).then(c,d)}u((a=a.apply(t,s||[])).next())})},zR=function(t,s){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,i,l,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(f){return d([u,f])}}function d(u){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(n=0)),n;)try{if(a=1,i&&(l=u[0]&2?i.return:u[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,u[1])).done)return l;switch(i=0,l&&(u=[u[0]&2,l.value]),u[0]){case 0:case 1:l=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,i=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!l||u[1]>l[0]&&u[1]<l[3])){n.label=u[1];break}if(u[0]===6&&n.label<l[1]){n.label=l[1],l=u;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(u);break}l[2]&&n.ops.pop(),n.trys.pop();continue}u=s.call(t,n)}catch(f){u=[6,f],i=0}finally{a=l=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},a8e=function(){function t(s,n,a,i){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=a,n&&FR.isSupported()?(this.primaryDecoder=new FR(s,a,i),this.secondaryDecoder=new BR(s,a,i)):this.primaryDecoder=new BR(s,a,i)}return t.prototype.decodeAsync=function(s){return $R(this,void 0,void 0,function(){var n;return zR(this,function(a){switch(a.label){case 0:n=performance.now(),a.label=1;case 1:return a.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(s)];case 2:return[2,a.sent()];case 3:return this.possiblyLogPerformance(n),[7];case 4:return[2]}})})},t.prototype.decodeRobustlyAsync=function(s){return $R(this,void 0,void 0,function(){var n,a;return zR(this,function(i){switch(i.label){case 0:n=performance.now(),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(s)];case 2:return[2,i.sent()];case 3:if(a=i.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(s)];throw a;case 4:return this.possiblyLogPerformance(n),[7];case 5:return[2]}})})},t.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},t.prototype.possiblyLogPerformance=function(s){if(this.verbose){var n=performance.now()-s;this.executionResults.push(n),this.executions++,this.possiblyFlushPerformanceReport()}},t.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var s=0,n=0,a=this.executionResults;n<a.length;n++){var i=a[n];s+=i}var l=s/this.executionResults.length;console.log("".concat(l," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},t}(),hE=function(){var t=function(s,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,i){a.__proto__=i}||function(a,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(a[l]=i[l])},t(s,n)};return function(s,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(s,n);function a(){this.constructor=s}s.prototype=n===null?Object.create(n):(a.prototype=n.prototype,new a)}}(),sb=function(t,s,n,a){function i(l){return l instanceof n?l:new n(function(o){o(l)})}return new(n||(n=Promise))(function(l,o){function c(f){try{u(a.next(f))}catch(m){o(m)}}function d(f){try{u(a.throw(f))}catch(m){o(m)}}function u(f){f.done?l(f.value):i(f.value).then(c,d)}u((a=a.apply(t,s||[])).next())})},nb=function(t,s){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,i,l,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(f){return d([u,f])}}function d(u){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(n=0)),n;)try{if(a=1,i&&(l=u[0]&2?i.return:u[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,u[1])).done)return l;switch(i=0,l&&(u=[u[0]&2,l.value]),u[0]){case 0:case 1:l=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,i=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!l||u[1]>l[0]&&u[1]<l[3])){n.label=u[1];break}if(u[0]===6&&n.label<l[1]){n.label=l[1],l=u;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(u);break}l[2]&&n.ops.pop(),n.trys.pop();continue}u=s.call(t,n)}catch(f){u=[6,f],i=0}finally{a=l=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},xK=function(){function t(s,n){this.name=s,this.track=n}return t.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},t.prototype.apply=function(s){var n={};n[this.name]=s;var a={advanced:[n]};return this.track.applyConstraints(a)},t.prototype.value=function(){var s=this.track.getSettings();if(this.name in s){var n=s[this.name];return n}return null},t}(),i8e=function(t){hE(s,t);function s(n,a){return t.call(this,n,a)||this}return s.prototype.min=function(){return this.getCapabilities().min},s.prototype.max=function(){return this.getCapabilities().max},s.prototype.step=function(){return this.getCapabilities().step},s.prototype.apply=function(n){var a={};a[this.name]=n;var i={advanced:[a]};return this.track.applyConstraints(i)},s.prototype.getCapabilities=function(){this.failIfNotSupported();var n=this.track.getCapabilities(),a=n[this.name];return{min:a.min,max:a.max,step:a.step}},s.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},s}(xK),l8e=function(t){hE(s,t);function s(n){return t.call(this,"zoom",n)||this}return s}(i8e),o8e=function(t){hE(s,t);function s(n){return t.call(this,"torch",n)||this}return s}(xK),c8e=function(){function t(s){this.track=s}return t.prototype.zoomFeature=function(){return new l8e(this.track)},t.prototype.torchFeature=function(){return new o8e(this.track)},t}(),d8e=function(){function t(s,n,a){this.isClosed=!1,this.parentElement=s,this.mediaStream=n,this.callbacks=a,this.surface=this.createVideoElement(this.parentElement.clientWidth),s.append(this.surface)}return t.prototype.createVideoElement=function(s){var n=document.createElement("video");return n.style.width="".concat(s,"px"),n.style.display="block",n.muted=!0,n.setAttribute("muted","true"),n.playsInline=!0,n},t.prototype.setupSurface=function(){var s=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var n=function(){var a=s.surface.clientWidth,i=s.surface.clientHeight;s.callbacks.onRenderSurfaceReady(a,i),s.surface.removeEventListener("playing",n)};this.surface.addEventListener("playing",n),this.surface.srcObject=this.mediaStream,this.surface.play()},t.create=function(s,n,a,i){return sb(this,void 0,void 0,function(){var l,o;return nb(this,function(c){switch(c.label){case 0:return l=new t(s,n,i),a.aspectRatio?(o={aspectRatio:a.aspectRatio},[4,l.getFirstTrackOrFail().applyConstraints(o)]):[3,2];case 1:c.sent(),c.label=2;case 2:return l.setupSurface(),[2,l]}})})},t.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},t.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},t.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},t.prototype.resume=function(s){this.failIfClosed();var n=this,a=function(){setTimeout(s,200),n.surface.removeEventListener("playing",a)};this.surface.addEventListener("playing",a),this.surface.play()},t.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},t.prototype.getSurface=function(){return this.failIfClosed(),this.surface},t.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},t.prototype.applyVideoConstraints=function(s){return sb(this,void 0,void 0,function(){return nb(this,function(n){if("aspectRatio"in s)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(s)]})})},t.prototype.close=function(){if(this.isClosed)return Promise.resolve();var s=this;return new Promise(function(n,a){var i=s.mediaStream.getVideoTracks(),l=i.length,o=0;s.mediaStream.getVideoTracks().forEach(function(c){s.mediaStream.removeTrack(c),c.stop(),++o,o>=l&&(s.isClosed=!0,s.parentElement.removeChild(s.surface),n())})})},t.prototype.getCapabilities=function(){return new c8e(this.getFirstTrackOrFail())},t}(),u8e=function(){function t(s){this.mediaStream=s}return t.prototype.render=function(s,n,a){return sb(this,void 0,void 0,function(){return nb(this,function(i){return[2,d8e.create(s,this.mediaStream,n,a)]})})},t.create=function(s){return sb(this,void 0,void 0,function(){var n,a;return nb(this,function(i){switch(i.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return n={audio:!1,video:s},[4,navigator.mediaDevices.getUserMedia(n)];case 1:return a=i.sent(),[2,new t(a)]}})})},t}(),UR=function(t,s,n,a){function i(l){return l instanceof n?l:new n(function(o){o(l)})}return new(n||(n=Promise))(function(l,o){function c(f){try{u(a.next(f))}catch(m){o(m)}}function d(f){try{u(a.throw(f))}catch(m){o(m)}}function u(f){f.done?l(f.value):i(f.value).then(c,d)}u((a=a.apply(t,s||[])).next())})},VR=function(t,s){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,i,l,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(f){return d([u,f])}}function d(u){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(n=0)),n;)try{if(a=1,i&&(l=u[0]&2?i.return:u[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,u[1])).done)return l;switch(i=0,l&&(u=[u[0]&2,l.value]),u[0]){case 0:case 1:l=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,i=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!l||u[1]>l[0]&&u[1]<l[3])){n.label=u[1];break}if(u[0]===6&&n.label<l[1]){n.label=l[1],l=u;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(u);break}l[2]&&n.ops.pop(),n.trys.pop();continue}u=s.call(t,n)}catch(f){u=[6,f],i=0}finally{a=l=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},h8e=function(){function t(){}return t.failIfNotSupported=function(){return UR(this,void 0,void 0,function(){return VR(this,function(s){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new t]})})},t.prototype.create=function(s){return UR(this,void 0,void 0,function(){return VR(this,function(n){return[2,u8e.create(s)]})})},t}(),f8e=function(t,s,n,a){function i(l){return l instanceof n?l:new n(function(o){o(l)})}return new(n||(n=Promise))(function(l,o){function c(f){try{u(a.next(f))}catch(m){o(m)}}function d(f){try{u(a.throw(f))}catch(m){o(m)}}function u(f){f.done?l(f.value):i(f.value).then(c,d)}u((a=a.apply(t,s||[])).next())})},m8e=function(t,s){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,i,l,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(f){return d([u,f])}}function d(u){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(n=0)),n;)try{if(a=1,i&&(l=u[0]&2?i.return:u[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,u[1])).done)return l;switch(i=0,l&&(u=[u[0]&2,l.value]),u[0]){case 0:case 1:l=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,i=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!l||u[1]>l[0]&&u[1]<l[3])){n.label=u[1];break}if(u[0]===6&&n.label<l[1]){n.label=l[1],l=u;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(u);break}l[2]&&n.ops.pop(),n.trys.pop();continue}u=s.call(t,n)}catch(f){u=[6,f],i=0}finally{a=l=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},p8e=function(){function t(){}return t.retrieve=function(){if(navigator.mediaDevices)return t.getCamerasFromMediaDevices();var s=MediaStreamTrack;return MediaStreamTrack&&s.getSources?t.getCamerasFromMediaStreamTrack():t.rejectWithError()},t.rejectWithError=function(){var s=kh.unableToQuerySupportedDevices();return t.isHttpsOrLocalhost()||(s=kh.insecureContextCameraQueryError()),Promise.reject(s)},t.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var s=location.host.split(":")[0];return s==="127.0.0.1"||s==="localhost"},t.getCamerasFromMediaDevices=function(){return f8e(this,void 0,void 0,function(){var s,n,a,i,l,o,c;return m8e(this,function(d){switch(d.label){case 0:return s=function(u){for(var f=u.getVideoTracks(),m=0,x=f;m<x.length;m++){var b=x[m];b.enabled=!1,b.stop(),u.removeTrack(b)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return n=d.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(a=d.sent(),i=[],l=0,o=a;l<o.length;l++)c=o[l],c.kind==="videoinput"&&i.push({id:c.deviceId,label:c.label});return s(n),[2,i]}})})},t.getCamerasFromMediaStreamTrack=function(){return new Promise(function(s,n){var a=function(l){for(var o=[],c=0,d=l;c<d.length;c++){var u=d[c];u.kind==="video"&&o.push({id:u.id,label:u.label})}s(o)},i=MediaStreamTrack;i.getSources(a)})},t}(),hn;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.NOT_STARTED=1]="NOT_STARTED",t[t.SCANNING=2]="SCANNING",t[t.PAUSED=3]="PAUSED"})(hn||(hn={}));var x8e=function(){function t(){this.state=hn.NOT_STARTED,this.onGoingTransactionNewState=hn.UNKNOWN}return t.prototype.directTransition=function(s){this.failIfTransitionOngoing(),this.validateTransition(s),this.state=s},t.prototype.startTransition=function(s){return this.failIfTransitionOngoing(),this.validateTransition(s),this.onGoingTransactionNewState=s,this},t.prototype.execute=function(){if(this.onGoingTransactionNewState===hn.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var s=this.onGoingTransactionNewState;this.onGoingTransactionNewState=hn.UNKNOWN,this.directTransition(s)},t.prototype.cancel=function(){if(this.onGoingTransactionNewState===hn.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=hn.UNKNOWN},t.prototype.getState=function(){return this.state},t.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==hn.UNKNOWN)throw"Cannot transition to a new state, already under transition"},t.prototype.validateTransition=function(s){switch(this.state){case hn.UNKNOWN:throw"Transition from unknown is not allowed";case hn.NOT_STARTED:this.failIfNewStateIs(s,[hn.PAUSED]);break;case hn.SCANNING:break;case hn.PAUSED:break}},t.prototype.failIfNewStateIs=function(s,n){for(var a=0,i=n;a<i.length;a++){var l=i[a];if(s===l)throw"Cannot transition from ".concat(this.state," to ").concat(s)}},t}(),g8e=function(){function t(s){this.stateManager=s}return t.prototype.startTransition=function(s){return this.stateManager.startTransition(s)},t.prototype.directTransition=function(s){this.stateManager.directTransition(s)},t.prototype.getState=function(){return this.stateManager.getState()},t.prototype.canScanFile=function(){return this.stateManager.getState()===hn.NOT_STARTED},t.prototype.isScanning=function(){return this.stateManager.getState()!==hn.NOT_STARTED},t.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===hn.SCANNING},t.prototype.isPaused=function(){return this.stateManager.getState()===hn.PAUSED},t}(),y8e=function(){function t(){}return t.create=function(){return new g8e(new x8e)},t}(),b8e=function(){var t=function(s,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,i){a.__proto__=i}||function(a,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(a[l]=i[l])},t(s,n)};return function(s,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(s,n);function a(){this.constructor=s}s.prototype=n===null?Object.create(n):(a.prototype=n.prototype,new a)}}(),La=function(t){b8e(s,t);function s(){return t!==null&&t.apply(this,arguments)||this}return s.DEFAULT_WIDTH=300,s.DEFAULT_WIDTH_OFFSET=2,s.FILE_SCAN_MIN_HEIGHT=300,s.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,s.MIN_QR_BOX_SIZE=50,s.SHADED_LEFT=1,s.SHADED_RIGHT=2,s.SHADED_TOP=3,s.SHADED_BOTTOM=4,s.SHADED_REGION_ELEMENT_ID="qr-shaded-region",s.VERBOSE=!1,s.BORDER_SHADER_DEFAULT_COLOR="#ffffff",s.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",s}(Gi),v8e=function(){function t(s,n){this.logger=n,this.fps=La.SCAN_DEFAULT_FPS,s?(s.fps&&(this.fps=s.fps),this.disableFlip=s.disableFlip===!0,this.qrbox=s.qrbox,this.aspectRatio=s.aspectRatio,this.videoConstraints=s.videoConstraints):this.disableFlip=La.DEFAULT_DISABLE_FLIP}return t.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?pK.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},t.prototype.isShadedBoxEnabled=function(){return!kl(this.qrbox)},t.create=function(s,n){return new t(s,n)},t}(),HR=function(){function t(s,n){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(s))throw"HTML Element with id=".concat(s," not found");this.elementId=s,this.verbose=!1;var a;typeof n=="boolean"?this.verbose=n===!0:n&&(a=n,this.verbose=a.verbose===!0,a.experimentalFeatures),this.logger=new mK(this.verbose),this.qrcode=new a8e(this.getSupportedFormats(n),this.getUseBarCodeDetectorIfSupported(a),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=y8e.create()}return t.prototype.start=function(s,n,a,i){var l=this;if(!s)throw"cameraIdOrConfig is required";if(!a||typeof a!="function")throw"qrCodeSuccessCallback is required and should be a function.";var o;i?o=i:o=this.verbose?this.logger.log:function(){};var c=v8e.create(n,this.logger);this.clearElement();var d=!1;c.videoConstraints&&(c.isMediaStreamConstraintsValid()?d=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var u=d,f=document.getElementById(this.elementId);f.clientWidth?f.clientWidth:La.DEFAULT_WIDTH,f.style.position="relative",this.shouldScan=!0,this.element=f;var m=this,x=this.stateManagerProxy.startTransition(hn.SCANNING);return new Promise(function(b,w){var j=u?c.videoConstraints:m.createVideoConstraints(s);if(!j){x.cancel(),w("videoConstraints should be defined");return}var _={};(!u||c.aspectRatio)&&(_.aspectRatio=c.aspectRatio);var C={onRenderSurfaceReady:function(k,A){m.setupUi(k,A,c),m.isScanning=!0,m.foreverScan(c,a,o)}};h8e.failIfNotSupported().then(function(k){k.create(j).then(function(A){return A.render(l.element,_,C).then(function(T){m.renderedCamera=T,x.execute(),b(null)}).catch(function(T){x.cancel(),w(T)})}).catch(function(A){x.cancel(),w(kh.errorGettingUserMedia(A))})}).catch(function(k){x.cancel(),w(kh.cameraStreamingNotSupported())})})},t.prototype.pause=function(s){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(hn.PAUSED),this.showPausedState(),(kl(s)||s!==!0)&&(s=!1),s&&this.renderedCamera&&this.renderedCamera.pause()},t.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var s=this,n=function(){s.stateManagerProxy.directTransition(hn.SCANNING),s.hidePausedState()};if(!this.renderedCamera.isPaused()){n();return}this.renderedCamera.resume(function(){n()})},t.prototype.getState=function(){return this.stateManagerProxy.getState()},t.prototype.stop=function(){var s=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var n=this.stateManagerProxy.startTransition(hn.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var a=function(){if(s.element){var l=document.getElementById(La.SHADED_REGION_ELEMENT_ID);l&&s.element.removeChild(l)}},i=this;return this.renderedCamera.close().then(function(){return i.renderedCamera=null,i.element&&(i.element.removeChild(i.canvasElement),i.canvasElement=null),a(),i.qrRegion&&(i.qrRegion=null),i.context&&(i.context=null),n.execute(),i.hidePausedState(),i.isScanning=!1,Promise.resolve()})},t.prototype.scanFile=function(s,n){return this.scanFileV2(s,n).then(function(a){return a.decodedText})},t.prototype.scanFileV2=function(s,n){var a=this;if(!s||!(s instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(kl(n)&&(n=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(i,l){a.possiblyCloseLastScanImageFile(),a.clearElement(),a.lastScanImageFile=URL.createObjectURL(s);var o=new Image;o.onload=function(){var c=o.width,d=o.height,u=document.getElementById(a.elementId),f=u.clientWidth?u.clientWidth:La.DEFAULT_WIDTH,m=Math.max(u.clientHeight?u.clientHeight:d,La.FILE_SCAN_MIN_HEIGHT),x=a.computeCanvasDrawConfig(c,d,f,m);if(n){var b=a.createCanvasElement(f,m,"qr-canvas-visible");b.style.display="inline-block",u.appendChild(b);var w=b.getContext("2d");if(!w)throw"Unable to get 2d context from canvas";w.canvas.width=f,w.canvas.height=m,w.drawImage(o,0,0,c,d,x.x,x.y,x.width,x.height)}var j=La.FILE_SCAN_HIDDEN_CANVAS_PADDING,_=Math.max(o.width,x.width),C=Math.max(o.height,x.height),k=_+2*j,A=C+2*j,T=a.createCanvasElement(k,A);u.appendChild(T);var P=T.getContext("2d");if(!P)throw"Unable to get 2d context from canvas";P.canvas.width=k,P.canvas.height=A,P.drawImage(o,0,0,c,d,j,j,_,C);try{a.qrcode.decodeRobustlyAsync(T).then(function(R){i(RR.createFromQrcodeResult(R))}).catch(l)}catch(R){l("QR code parse error, error = ".concat(R))}},o.onerror=l,o.onabort=l,o.onstalled=l,o.onsuspend=l,o.src=URL.createObjectURL(s)})},t.prototype.clear=function(){this.clearElement()},t.getCameras=function(){return p8e.retrieve()},t.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},t.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},t.prototype.applyVideoConstraints=function(s){if(s){if(!pK.isMediaStreamConstraintsValid(s,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(s)},t.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},t.prototype.getSupportedFormats=function(s){var n=[dt.QR_CODE,dt.AZTEC,dt.CODABAR,dt.CODE_39,dt.CODE_93,dt.CODE_128,dt.DATA_MATRIX,dt.MAXICODE,dt.ITF,dt.EAN_13,dt.EAN_8,dt.PDF_417,dt.RSS_14,dt.RSS_EXPANDED,dt.UPC_A,dt.UPC_E,dt.UPC_EAN_EXTENSION];if(!s||typeof s=="boolean"||!s.formatsToSupport)return n;if(!Array.isArray(s.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(s.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var a=[],i=0,l=s.formatsToSupport;i<l.length;i++){var o=l[i];J6e(o)?a.push(o):this.logger.warn("Invalid format: ".concat(o," passed in config, ignoring."))}if(a.length===0)throw"None of formatsToSupport match supported values.";return a},t.prototype.getUseBarCodeDetectorIfSupported=function(s){if(kl(s))return!0;if(!kl(s.useBarCodeDetectorIfSupported))return s.useBarCodeDetectorIfSupported!==!1;if(kl(s.experimentalFeatures))return!0;var n=s.experimentalFeatures;return kl(n.useBarCodeDetectorIfSupported)?!0:n.useBarCodeDetectorIfSupported!==!1},t.prototype.validateQrboxSize=function(s,n,a){var i=this,l=a.qrbox;this.validateQrboxConfig(l);var o=this.toQrdimensions(s,n,l),c=function(u){if(u<La.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(La.MIN_QR_BOX_SIZE,"px.")},d=function(u){return u>s&&(i.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),u=s),u};c(o.width),c(o.height),o.width=d(o.width)},t.prototype.validateQrboxConfig=function(s){if(typeof s!="number"&&typeof s!="function"&&(s.width===void 0||s.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},t.prototype.toQrdimensions=function(s,n,a){if(typeof a=="number")return{width:a,height:a};if(typeof a=="function")try{return a(s,n)}catch(i){throw new Error("qrbox config was passed as a function but it failed with unknown error"+i)}return a},t.prototype.setupUi=function(s,n,a){a.isShadedBoxEnabled()&&this.validateQrboxSize(s,n,a);var i=kl(a.qrbox)?{width:s,height:n}:a.qrbox;this.validateQrboxConfig(i);var l=this.toQrdimensions(s,n,i);l.height>n&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var o=a.isShadedBoxEnabled()&&l.height<=n,c={x:0,y:0,width:s,height:n},d=o?this.getShadedRegionBounds(s,n,l):c,u=this.createCanvasElement(d.width,d.height),f={willReadFrequently:!0},m=u.getContext("2d",f);m.canvas.width=d.width,m.canvas.height=d.height,this.element.append(u),o&&this.possiblyInsertShadingElement(this.element,s,n,l),this.createScannerPausedUiElement(this.element),this.qrRegion=d,this.context=m,this.canvasElement=u},t.prototype.createScannerPausedUiElement=function(s){var n=document.createElement("div");n.innerText=kh.scannerPaused(),n.style.display="none",n.style.position="absolute",n.style.top="0px",n.style.zIndex="1",n.style.background="rgba(9, 9, 9, 0.46)",n.style.color="#FFECEC",n.style.textAlign="center",n.style.width="100%",s.appendChild(n),this.scannerPausedUiElement=n},t.prototype.scanContext=function(s,n){var a=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(i){return s(i.text,RR.createFromQrcodeResult(i)),a.possiblyUpdateShaders(!0),!0}).catch(function(i){a.possiblyUpdateShaders(!1);var l=kh.codeParseError(i);return n(l,fK.createFrom(l)),!1})},t.prototype.foreverScan=function(s,n,a){var i=this;if(this.shouldScan&&this.renderedCamera){var l=this.renderedCamera.getSurface(),o=l.videoWidth/l.clientWidth,c=l.videoHeight/l.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var d=this.qrRegion.width*o,u=this.qrRegion.height*c,f=this.qrRegion.x*o,m=this.qrRegion.y*c;this.context.drawImage(l,f,m,d,u,0,0,this.qrRegion.width,this.qrRegion.height);var x=function(){i.foreverScanTimeout=setTimeout(function(){i.foreverScan(s,n,a)},i.getTimeoutFps(s.fps))};this.scanContext(n,a).then(function(b){!b&&s.disableFlip!==!0?(i.context.translate(i.context.canvas.width,0),i.context.scale(-1,1),i.scanContext(n,a).finally(function(){x()})):x()}).catch(function(b){i.logger.logError("Error happend while scanning context",b),x()})}},t.prototype.createVideoConstraints=function(s){if(typeof s=="string")return{deviceId:{exact:s}};if(typeof s=="object"){var n="facingMode",a="deviceId",i={user:!0,environment:!0},l="exact",o=function(w){if(w in i)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(w,"'")},c=Object.keys(s);if(c.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(c.length," keys");var d=Object.keys(s)[0];if(d!==n&&d!==a)throw"Only '".concat(n,"' and '").concat(a,"' ")+" are supported for 'cameraIdOrConfig'";if(d===n){var u=s.facingMode;if(typeof u=="string"){if(o(u))return{facingMode:u}}else if(typeof u=="object")if(l in u){if(o(u["".concat(l)]))return{facingMode:{exact:u["".concat(l)]}}}else throw"'facingMode' should be string or object with"+" ".concat(l," as key.");else{var f=typeof u;throw"Invalid type of 'facingMode' = ".concat(f)}}else{var m=s.deviceId;if(typeof m=="string")return{deviceId:m};if(typeof m=="object"){if(l in m)return{deviceId:{exact:m["".concat(l)]}};throw"'deviceId' should be string or object with"+" ".concat(l," as key.")}else{var x=typeof m;throw"Invalid type of 'deviceId' = ".concat(x)}}}var b=typeof s;throw"Invalid type of 'cameraIdOrConfig' = ".concat(b)},t.prototype.computeCanvasDrawConfig=function(s,n,a,i){if(s<=a&&n<=i){var l=(a-s)/2,o=(i-n)/2;return{x:l,y:o,width:s,height:n}}else{var c=s,d=n;return s>a&&(n=a/s*n,s=a),n>i&&(s=i/n*s,n=i),this.logger.log("Image downsampled from "+"".concat(c,"X").concat(d)+" to ".concat(s,"X").concat(n,".")),this.computeCanvasDrawConfig(s,n,a,i)}},t.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var s=document.getElementById(this.elementId);s&&(s.innerHTML="")},t.prototype.possiblyUpdateShaders=function(s){this.qrMatch!==s&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(n){n.style.backgroundColor=s?La.BORDER_SHADER_MATCH_COLOR:La.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=s)},t.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},t.prototype.createCanvasElement=function(s,n,a){var i=s,l=n,o=document.createElement("canvas");return o.style.width="".concat(i,"px"),o.style.height="".concat(l,"px"),o.style.display="none",o.id=kl(a)?"qr-canvas":a,o},t.prototype.getShadedRegionBounds=function(s,n,a){if(a.width>s||a.height>n)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(s-a.width)/2,y:(n-a.height)/2,width:a.width,height:a.height}},t.prototype.possiblyInsertShadingElement=function(s,n,a,i){if(!(n-i.width<1||a-i.height<1)){var l=document.createElement("div");l.style.position="absolute";var o=(n-i.width)/2,c=(a-i.height)/2;if(l.style.borderLeft="".concat(o,"px solid rgba(0, 0, 0, 0.48)"),l.style.borderRight="".concat(o,"px solid rgba(0, 0, 0, 0.48)"),l.style.borderTop="".concat(c,"px solid rgba(0, 0, 0, 0.48)"),l.style.borderBottom="".concat(c,"px solid rgba(0, 0, 0, 0.48)"),l.style.boxSizing="border-box",l.style.top="0px",l.style.bottom="0px",l.style.left="0px",l.style.right="0px",l.id="".concat(La.SHADED_REGION_ELEMENT_ID),n-i.width<11||a-i.height<11)this.hasBorderShaders=!1;else{var d=5,u=40;this.insertShaderBorders(l,u,d,-d,null,0,!0),this.insertShaderBorders(l,u,d,-d,null,0,!1),this.insertShaderBorders(l,u,d,null,-d,0,!0),this.insertShaderBorders(l,u,d,null,-d,0,!1),this.insertShaderBorders(l,d,u+d,-d,null,-d,!0),this.insertShaderBorders(l,d,u+d,null,-d,-d,!0),this.insertShaderBorders(l,d,u+d,-d,null,-d,!1),this.insertShaderBorders(l,d,u+d,null,-d,-d,!1),this.hasBorderShaders=!0}s.append(l)}},t.prototype.insertShaderBorders=function(s,n,a,i,l,o,c){var d=document.createElement("div");d.style.position="absolute",d.style.backgroundColor=La.BORDER_SHADER_DEFAULT_COLOR,d.style.width="".concat(n,"px"),d.style.height="".concat(a,"px"),i!==null&&(d.style.top="".concat(i,"px")),l!==null&&(d.style.bottom="".concat(l,"px")),c?d.style.left="".concat(o,"px"):d.style.right="".concat(o,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(d),s.appendChild(d)},t.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},t.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},t.prototype.getTimeoutFps=function(s){return 1e3/s},t}(),fE="data:image/svg+xml;base64,",w8e=fE+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNzEuNjQzIDM3MS42NDMiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDM3MS42NDMgMzcxLjY0MyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZD0iTTEwNS4wODQgMzguMjcxaDE2My43Njh2MjBIMTA1LjA4NHoiLz48cGF0aCBkPSJNMzExLjU5NiAxOTAuMTg5Yy03LjQ0MS05LjM0Ny0xOC40MDMtMTYuMjA2LTMyLjc0My0yMC41MjJWMzBjMC0xNi41NDItMTMuNDU4LTMwLTMwLTMwSDEyNS4wODRjLTE2LjU0MiAwLTMwIDEzLjQ1OC0zMCAzMHYxMjAuMTQzaC04LjI5NmMtMTYuNTQyIDAtMzAgMTMuNDU4LTMwIDMwdjEuMzMzYTI5LjgwNCAyOS44MDQgMCAwIDAgNC42MDMgMTUuOTM5Yy03LjM0IDUuNDc0LTEyLjEwMyAxNC4yMjEtMTIuMTAzIDI0LjA2MXYxLjMzM2MwIDkuODQgNC43NjMgMTguNTg3IDEyLjEwMyAyNC4wNjJhMjkuODEgMjkuODEgMCAwIDAtNC42MDMgMTUuOTM4djEuMzMzYzAgMTYuNTQyIDEzLjQ1OCAzMCAzMCAzMGg4LjMyNGMuNDI3IDExLjYzMSA3LjUwMyAyMS41ODcgMTcuNTM0IDI2LjE3Ny45MzEgMTAuNTAzIDQuMDg0IDMwLjE4NyAxNC43NjggNDUuNTM3YTkuOTg4IDkuOTg4IDAgMCAwIDguMjE2IDQuMjg4IDkuOTU4IDkuOTU4IDAgMCAwIDUuNzA0LTEuNzkzYzQuNTMzLTMuMTU1IDUuNjUtOS4zODggMi40OTUtMTMuOTIxLTYuNzk4LTkuNzY3LTkuNjAyLTIyLjYwOC0xMC43Ni0zMS40aDgyLjY4NWMuMjcyLjQxNC41NDUuODE4LjgxNSAxLjIxIDMuMTQyIDQuNTQxIDkuMzcyIDUuNjc5IDEzLjkxMyAyLjUzNCA0LjU0Mi0zLjE0MiA1LjY3Ny05LjM3MSAyLjUzNS0xMy45MTMtMTEuOTE5LTE3LjIyOS04Ljc4Ny0zNS44ODQgOS41ODEtNTcuMDEyIDMuMDY3LTIuNjUyIDEyLjMwNy0xMS43MzIgMTEuMjE3LTI0LjAzMy0uODI4LTkuMzQzLTcuMTA5LTE3LjE5NC0xOC42NjktMjMuMzM3YTkuODU3IDkuODU3IDAgMCAwLTEuMDYxLS40ODZjLS40NjYtLjE4Mi0xMS40MDMtNC41NzktOS43NDEtMTUuNzA2IDEuMDA3LTYuNzM3IDE0Ljc2OC04LjI3MyAyMy43NjYtNy42NjYgMjMuMTU2IDEuNTY5IDM5LjY5OCA3LjgwMyA0Ny44MzYgMTguMDI2IDUuNzUyIDcuMjI1IDcuNjA3IDE2LjYyMyA1LjY3MyAyOC43MzMtLjQxMyAyLjU4NS0uODI0IDUuMjQxLTEuMjQ1IDcuOTU5LTUuNzU2IDM3LjE5NC0xMi45MTkgODMuNDgzLTQ5Ljg3IDExNC42NjEtNC4yMjEgMy41NjEtNC43NTYgOS44Ny0xLjE5NCAxNC4wOTJhOS45OCA5Ljk4IDAgMCAwIDcuNjQ4IDMuNTUxIDkuOTU1IDkuOTU1IDAgMCAwIDYuNDQ0LTIuMzU4YzQyLjY3Mi0zNi4wMDUgNTAuODAyLTg4LjUzMyA1Ni43MzctMTI2Ljg4OC40MTUtMi42ODQuODIxLTUuMzA5IDEuMjI5LTcuODYzIDIuODM0LTE3LjcyMS0uNDU1LTMyLjY0MS05Ljc3Mi00NC4zNDV6bS0yMzIuMzA4IDQyLjYyYy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM2MwLTUuNTE0IDQuNDg2LTEwIDEwLTEwaDE1djIxLjMzM2gtMTV6bS0yLjUtNTIuNjY2YzAtNS41MTQgNC40ODYtMTAgMTAtMTBoNy41djIxLjMzM2gtNy41Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM3ptMTcuNSA5My45OTloLTcuNWMtNS41MTQgMC0xMC00LjQ4Ni0xMC0xMHYtMS4zMzNjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGg3LjV2MjEuMzMzem0zMC43OTYgMjguODg3Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi04LjI3MWg5MS40NTdjLS44NTEgNi42NjgtLjQzNyAxMi43ODcuNzMxIDE4LjI3MWgtODIuMTg4em03OS40ODItMTEzLjY5OGMtMy4xMjQgMjAuOTA2IDEyLjQyNyAzMy4xODQgMjEuNjI1IDM3LjA0IDUuNDQxIDIuOTY4IDcuNTUxIDUuNjQ3IDcuNzAxIDcuMTg4LjIxIDIuMTUtMi41NTMgNS42ODQtNC40NzcgNy4yNTEtLjQ4Mi4zNzgtLjkyOS44LTEuMzM1IDEuMjYxLTYuOTg3IDcuOTM2LTExLjk4MiAxNS41Mi0xNS40MzIgMjIuNjg4aC05Ny41NjRWMzBjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGgxMjMuNzY5YzUuNTE0IDAgMTAgNC40ODYgMTAgMTB2MTM1LjU3OWMtMy4wMzItLjM4MS02LjE1LS42OTQtOS4zODktLjkxNC0yNS4xNTktMS42OTQtNDIuMzcgNy43NDgtNDQuODk4IDI0LjY2NnoiLz48cGF0aCBkPSJNMTc5LjEyOSA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXpNMTcyLjYyOSAxNDIuODZoLTEyLjU2VjEzMC44YTUgNSAwIDEgMC0xMCAwdjE3LjA2MWE1IDUgMCAwIDAgNSA1aDE3LjU2YTUgNSAwIDEgMCAwLTEwLjAwMXpNMjE2LjU2OCA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXptLTUgMjQuMDYxaC0xNC4wNlY5My4xNjdoMTQuMDZ2MTQuMDYxek0yMTEuNjY5IDEyNS45MzZIMTk3LjQxYTUgNSAwIDAgMC01IDV2MTQuMjU3YTUgNSAwIDAgMCA1IDVoMTQuMjU5YTUgNSAwIDAgMCA1LTV2LTE0LjI1N2E1IDUgMCAwIDAtNS01eiIvPjwvc3ZnPg==",N8e=fE+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1OS4wMTggNTkuMDE4IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1OS4wMTggNTkuMDE4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJtNTguNzQxIDU0LjgwOS01Ljk2OS02LjI0NGExMC43NCAxMC43NCAwIDAgMCAyLjgyLTcuMjVjMC01Ljk1My00Ljg0My0xMC43OTYtMTAuNzk2LTEwLjc5NlMzNCAzNS4zNjEgMzQgNDEuMzE0IDM4Ljg0MyA1Mi4xMSA0NC43OTYgNTIuMTFjMi40NDEgMCA0LjY4OC0uODI0IDYuNDk5LTIuMTk2bDYuMDAxIDYuMjc3YS45OTguOTk4IDAgMCAwIDEuNDE0LjAzMiAxIDEgMCAwIDAgLjAzMS0xLjQxNHpNMzYgNDEuMzE0YzAtNC44NSAzLjk0Ni04Ljc5NiA4Ljc5Ni04Ljc5NnM4Ljc5NiAzLjk0NiA4Ljc5NiA4Ljc5Ni0zLjk0NiA4Ljc5Ni04Ljc5NiA4Ljc5NlMzNiA0Ni4xNjQgMzYgNDEuMzE0ek0xMC40MzEgMTYuMDg4YzAgMy4wNyAyLjQ5OCA1LjU2OCA1LjU2OSA1LjU2OHM1LjU2OS0yLjQ5OCA1LjU2OS01LjU2OGMwLTMuMDcxLTIuNDk4LTUuNTY5LTUuNTY5LTUuNTY5cy01LjU2OSAyLjQ5OC01LjU2OSA1LjU2OXptOS4xMzggMGMwIDEuOTY4LTEuNjAyIDMuNTY4LTMuNTY5IDMuNTY4cy0zLjU2OS0xLjYwMS0zLjU2OS0zLjU2OCAxLjYwMi0zLjU2OSAzLjU2OS0zLjU2OSAzLjU2OSAxLjYwMSAzLjU2OSAzLjU2OXoiLz48cGF0aCBkPSJtMzAuODgyIDI4Ljk4NyA5LjE4LTEwLjA1NCAxMS4yNjIgMTAuMzIzYTEgMSAwIDAgMCAxLjM1MS0xLjQ3NWwtMTItMTFhMSAxIDAgMCAwLTEuNDE0LjA2M2wtOS43OTQgMTAuNzI3LTQuNzQzLTQuNzQzYTEuMDAzIDEuMDAzIDAgMCAwLTEuMzY4LS4wNDRMNi4zMzkgMzcuNzY4YTEgMSAwIDEgMCAxLjMyMiAxLjUwMWwxNi4zMTMtMTQuMzYyIDcuMzE5IDcuMzE4YS45OTkuOTk5IDAgMSAwIDEuNDE0LTEuNDE0bC0xLjgyNS0xLjgyNHoiLz48cGF0aCBkPSJNMzAgNDYuNTE4SDJ2LTQyaDU0djI4YTEgMSAwIDEgMCAyIDB2LTI5YTEgMSAwIDAgMC0xLTFIMWExIDEgMCAwIDAtMSAxdjQ0YTEgMSAwIDAgMCAxIDFoMjlhMSAxIDAgMSAwIDAtMnoiLz48L3N2Zz4=",WR=fE+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NjAgNDYwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0NjAgNDYwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJNMjMwIDBDMTAyLjk3NSAwIDAgMTAyLjk3NSAwIDIzMHMxMDIuOTc1IDIzMCAyMzAgMjMwIDIzMC0xMDIuOTc0IDIzMC0yMzBTMzU3LjAyNSAwIDIzMCAwem0zOC4zMzMgMzc3LjM2YzAgOC42NzYtNy4wMzQgMTUuNzEtMTUuNzEgMTUuNzFoLTQzLjEwMWMtOC42NzYgMC0xNS43MS03LjAzNC0xNS43MS0xNS43MVYyMDIuNDc3YzAtOC42NzYgNy4wMzMtMTUuNzEgMTUuNzEtMTUuNzFoNDMuMTAxYzguNjc2IDAgMTUuNzEgNy4wMzMgMTUuNzEgMTUuNzFWMzc3LjM2ek0yMzAgMTU3Yy0yMS41MzkgMC0zOS0xNy40NjEtMzktMzlzMTcuNDYxLTM5IDM5LTM5IDM5IDE3LjQ2MSAzOSAzOS0xNy40NjEgMzktMzkgMzl6Ii8+PC9zdmc+",j8e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAQgAAAEIBarqQRAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAE1SURBVDiNfdI7S0NBEAXgLya1otFgpbYSbISAgpXYi6CmiH9KCAiChaVga6OiWPgfRDQ+0itaGVNosXtluWwcuMzePfM4M3sq8lbHBubwg1dc4m1E/J/N4ghDPOIsfk/4xiEao5KX0McFljN4C9d4QTPXuY99jP3DsIoDPGM6BY5i5yI5R7O4q+ImFkJY2DCh3cAH2klyB+9J1xUMMAG7eCh1a+Mr+k48b5diXrFVwwLuS+BJ9MfR7+G0FHOHhTHhnXNWS87VDF4pcnfQK4Ep7XScNLmPTZgURNKKYENYWDpzW1BhscS1WHS8CDgURFJQrWcoF3c13KKbgg1BYQfy8xZWEzTTw1QZbAoKu8FqJnktdu5hcVSHmchiILzzuaDQvjBzV2m8yohCE1jHfPx/xhU+y4G/D75ELlRJsSYAAAAASUVORK5CYII=",qR=function(){function t(){}return t.createDefault=function(){return{hasPermission:!1,lastUsedCameraId:null}},t}(),_8e=function(){function t(){this.data=qR.createDefault();var s=localStorage.getItem(t.LOCAL_STORAGE_KEY);s?this.data=JSON.parse(s):this.reset()}return t.prototype.hasCameraPermissions=function(){return this.data.hasPermission},t.prototype.getLastUsedCameraId=function(){return this.data.lastUsedCameraId},t.prototype.setHasPermission=function(s){this.data.hasPermission=s,this.flush()},t.prototype.setLastUsedCameraId=function(s){this.data.lastUsedCameraId=s,this.flush()},t.prototype.resetLastUsedCameraId=function(){this.data.lastUsedCameraId=null,this.flush()},t.prototype.reset=function(){this.data=qR.createDefault(),this.flush()},t.prototype.flush=function(){localStorage.setItem(t.LOCAL_STORAGE_KEY,JSON.stringify(this.data))},t.LOCAL_STORAGE_KEY="HTML5_QRCODE_DATA",t}(),S8e=function(){function t(){this.infoDiv=document.createElement("div")}return t.prototype.renderInto=function(s){this.infoDiv.style.position="absolute",this.infoDiv.style.top="10px",this.infoDiv.style.right="10px",this.infoDiv.style.zIndex="2",this.infoDiv.style.display="none",this.infoDiv.style.padding="5pt",this.infoDiv.style.border="1px solid #171717",this.infoDiv.style.fontSize="10pt",this.infoDiv.style.background="rgb(0 0 0 / 69%)",this.infoDiv.style.borderRadius="5px",this.infoDiv.style.textAlign="center",this.infoDiv.style.fontWeight="400",this.infoDiv.style.color="white",this.infoDiv.innerText=LR.poweredBy();var n=document.createElement("a");n.innerText="ScanApp",n.href="https://scanapp.org",n.target="new",n.style.color="white",this.infoDiv.appendChild(n);var a=document.createElement("br"),i=document.createElement("br");this.infoDiv.appendChild(a),this.infoDiv.appendChild(i);var l=document.createElement("a");l.innerText=LR.reportIssues(),l.href="https://github.com/mebjas/html5-qrcode/issues",l.target="new",l.style.color="white",this.infoDiv.appendChild(l),s.appendChild(this.infoDiv)},t.prototype.show=function(){this.infoDiv.style.display="block"},t.prototype.hide=function(){this.infoDiv.style.display="none"},t}(),C8e=function(){function t(s,n){this.isShowingInfoIcon=!0,this.onTapIn=s,this.onTapOut=n,this.infoIcon=document.createElement("img")}return t.prototype.renderInto=function(s){var n=this;this.infoIcon.alt="Info icon",this.infoIcon.src=WR,this.infoIcon.style.position="absolute",this.infoIcon.style.top="4px",this.infoIcon.style.right="4px",this.infoIcon.style.opacity="0.6",this.infoIcon.style.cursor="pointer",this.infoIcon.style.zIndex="2",this.infoIcon.style.width="16px",this.infoIcon.style.height="16px",this.infoIcon.onmouseover=function(a){return n.onHoverIn()},this.infoIcon.onmouseout=function(a){return n.onHoverOut()},this.infoIcon.onclick=function(a){return n.onClick()},s.appendChild(this.infoIcon)},t.prototype.onHoverIn=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="1")},t.prototype.onHoverOut=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="0.6")},t.prototype.onClick=function(){this.isShowingInfoIcon?(this.isShowingInfoIcon=!1,this.onTapIn(),this.infoIcon.src=j8e,this.infoIcon.style.opacity="1"):(this.isShowingInfoIcon=!0,this.onTapOut(),this.infoIcon.src=WR,this.infoIcon.style.opacity="0.6")},t}(),k8e=function(){function t(){var s=this;this.infoDiv=new S8e,this.infoIcon=new C8e(function(){s.infoDiv.show()},function(){s.infoDiv.hide()})}return t.prototype.renderInto=function(s){this.infoDiv.renderInto(s),this.infoIcon.renderInto(s)},t}(),A8e=function(t,s,n,a){function i(l){return l instanceof n?l:new n(function(o){o(l)})}return new(n||(n=Promise))(function(l,o){function c(f){try{u(a.next(f))}catch(m){o(m)}}function d(f){try{u(a.throw(f))}catch(m){o(m)}}function u(f){f.done?l(f.value):i(f.value).then(c,d)}u((a=a.apply(t,s||[])).next())})},E8e=function(t,s){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,i,l,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(f){return d([u,f])}}function d(u){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(n=0)),n;)try{if(a=1,i&&(l=u[0]&2?i.return:u[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,u[1])).done)return l;switch(i=0,l&&(u=[u[0]&2,l.value]),u[0]){case 0:case 1:l=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,i=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!l||u[1]>l[0]&&u[1]<l[3])){n.label=u[1];break}if(u[0]===6&&n.label<l[1]){n.label=l[1],l=u;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(u);break}l[2]&&n.ops.pop(),n.trys.pop();continue}u=s.call(t,n)}catch(f){u=[6,f],i=0}finally{a=l=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},GR=function(){function t(){}return t.hasPermissions=function(){return A8e(this,void 0,void 0,function(){var s,n,a,i;return E8e(this,function(l){switch(l.label){case 0:return[4,navigator.mediaDevices.enumerateDevices()];case 1:for(s=l.sent(),n=0,a=s;n<a.length;n++)if(i=a[n],i.kind==="videoinput"&&i.label)return[2,!0];return[2,!1]}})})},t}(),nc=function(){function t(s){this.supportedScanTypes=this.validateAndReturnScanTypes(s)}return t.prototype.getDefaultScanType=function(){return this.supportedScanTypes[0]},t.prototype.hasMoreThanOneScanType=function(){return this.supportedScanTypes.length>1},t.prototype.isCameraScanRequired=function(){for(var s=0,n=this.supportedScanTypes;s<n.length;s++){var a=n[s];if(t.isCameraScanType(a))return!0}return!1},t.isCameraScanType=function(s){return s===Qc.SCAN_TYPE_CAMERA},t.isFileScanType=function(s){return s===Qc.SCAN_TYPE_FILE},t.prototype.validateAndReturnScanTypes=function(s){if(!s||s.length===0)return Gi.DEFAULT_SUPPORTED_SCAN_TYPE;var n=Gi.DEFAULT_SUPPORTED_SCAN_TYPE.length;if(s.length>n)throw"Max ".concat(n," values expected for ")+"supportedScanTypes";for(var a=0,i=s;a<i.length;a++){var l=i[a];if(!Gi.DEFAULT_SUPPORTED_SCAN_TYPE.includes(l))throw"Unsupported scan type ".concat(l)}return s},t}(),Wa=function(){function t(){}return t.ALL_ELEMENT_CLASS="html5-qrcode-element",t.CAMERA_PERMISSION_BUTTON_ID="html5-qrcode-button-camera-permission",t.CAMERA_START_BUTTON_ID="html5-qrcode-button-camera-start",t.CAMERA_STOP_BUTTON_ID="html5-qrcode-button-camera-stop",t.TORCH_BUTTON_ID="html5-qrcode-button-torch",t.CAMERA_SELECTION_SELECT_ID="html5-qrcode-select-camera",t.FILE_SELECTION_BUTTON_ID="html5-qrcode-button-file-selection",t.ZOOM_SLIDER_ID="html5-qrcode-input-range-zoom",t.SCAN_TYPE_CHANGE_ANCHOR_ID="html5-qrcode-anchor-scan-type-change",t.TORCH_BUTTON_CLASS_TORCH_ON="html5-qrcode-button-torch-on",t.TORCH_BUTTON_CLASS_TORCH_OFF="html5-qrcode-button-torch-off",t}(),go=function(){function t(){}return t.createElement=function(s,n){var a=document.createElement(s);return a.id=n,a.classList.add(Wa.ALL_ELEMENT_CLASS),s==="button"&&a.setAttribute("type","button"),a},t}(),gK=function(t,s,n,a){function i(l){return l instanceof n?l:new n(function(o){o(l)})}return new(n||(n=Promise))(function(l,o){function c(f){try{u(a.next(f))}catch(m){o(m)}}function d(f){try{u(a.throw(f))}catch(m){o(m)}}function u(f){f.done?l(f.value):i(f.value).then(c,d)}u((a=a.apply(t,s||[])).next())})},yK=function(t,s){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,i,l,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(f){return d([u,f])}}function d(u){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(n=0)),n;)try{if(a=1,i&&(l=u[0]&2?i.return:u[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,u[1])).done)return l;switch(i=0,l&&(u=[u[0]&2,l.value]),u[0]){case 0:case 1:l=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,i=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!l||u[1]>l[0]&&u[1]<l[3])){n.label=u[1];break}if(u[0]===6&&n.label<l[1]){n.label=l[1],l=u;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(u);break}l[2]&&n.ops.pop(),n.trys.pop();continue}u=s.call(t,n)}catch(f){u=[6,f],i=0}finally{a=l=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},KR=function(){function t(s,n,a){this.isTorchOn=!1,this.torchCapability=s,this.buttonController=n,this.onTorchActionFailureCallback=a}return t.prototype.isTorchEnabled=function(){return this.isTorchOn},t.prototype.flipState=function(){return gK(this,void 0,void 0,function(){var s,n;return yK(this,function(a){switch(a.label){case 0:this.buttonController.disable(),s=!this.isTorchOn,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.torchCapability.apply(s)];case 2:return a.sent(),this.updateUiBasedOnLatestSettings(this.torchCapability.value(),s),[3,4];case 3:return n=a.sent(),this.propagateFailure(s,n),this.buttonController.enable(),[3,4];case 4:return[2]}})})},t.prototype.updateUiBasedOnLatestSettings=function(s,n){s===n?(this.buttonController.setText(n?ps.torchOffButton():ps.torchOnButton()),this.isTorchOn=n):this.propagateFailure(n),this.buttonController.enable()},t.prototype.propagateFailure=function(s,n){var a=s?ps.torchOnFailedMessage():ps.torchOffFailedMessage();n&&(a+="; Error = "+n),this.onTorchActionFailureCallback(a)},t.prototype.reset=function(){this.isTorchOn=!1},t}(),T8e=function(){function t(s,n){this.onTorchActionFailureCallback=n,this.torchButton=go.createElement("button",Wa.TORCH_BUTTON_ID),this.torchController=new KR(s,this,n)}return t.prototype.render=function(s,n){var a=this;this.torchButton.innerText=ps.torchOnButton(),this.torchButton.style.display=n.display,this.torchButton.style.marginLeft=n.marginLeft;var i=this;this.torchButton.addEventListener("click",function(l){return gK(a,void 0,void 0,function(){return yK(this,function(o){switch(o.label){case 0:return[4,i.torchController.flipState()];case 1:return o.sent(),i.torchController.isTorchEnabled()?(i.torchButton.classList.remove(Wa.TORCH_BUTTON_CLASS_TORCH_OFF),i.torchButton.classList.add(Wa.TORCH_BUTTON_CLASS_TORCH_ON)):(i.torchButton.classList.remove(Wa.TORCH_BUTTON_CLASS_TORCH_ON),i.torchButton.classList.add(Wa.TORCH_BUTTON_CLASS_TORCH_OFF)),[2]}})})}),s.appendChild(this.torchButton)},t.prototype.updateTorchCapability=function(s){this.torchController=new KR(s,this,this.onTorchActionFailureCallback)},t.prototype.getTorchButton=function(){return this.torchButton},t.prototype.hide=function(){this.torchButton.style.display="none"},t.prototype.show=function(){this.torchButton.style.display="inline-block"},t.prototype.disable=function(){this.torchButton.disabled=!0},t.prototype.enable=function(){this.torchButton.disabled=!1},t.prototype.setText=function(s){this.torchButton.innerText=s},t.prototype.reset=function(){this.torchButton.innerText=ps.torchOnButton(),this.torchController.reset()},t.create=function(s,n,a,i){var l=new t(n,i);return l.render(s,a),l},t}(),P8e=function(){function t(s,n,a){this.fileBasedScanRegion=this.createFileBasedScanRegion(),this.fileBasedScanRegion.style.display=n?"block":"none",s.appendChild(this.fileBasedScanRegion);var i=document.createElement("label");i.setAttribute("for",this.getFileScanInputId()),i.style.display="inline-block",this.fileBasedScanRegion.appendChild(i),this.fileSelectionButton=go.createElement("button",Wa.FILE_SELECTION_BUTTON_ID),this.setInitialValueToButton(),this.fileSelectionButton.addEventListener("click",function(c){i.click()}),i.append(this.fileSelectionButton),this.fileScanInput=go.createElement("input",this.getFileScanInputId()),this.fileScanInput.type="file",this.fileScanInput.accept="image/*",this.fileScanInput.style.display="none",i.appendChild(this.fileScanInput);var l=this;this.fileScanInput.addEventListener("change",function(c){if(!(c==null||c.target==null)){var d=c.target;if(!(d.files&&d.files.length===0)){var u=d.files,f=u[0],m=f.name;l.setImageNameToButton(m),a(f)}}});var o=this.createDragAndDropMessage();this.fileBasedScanRegion.appendChild(o),this.fileBasedScanRegion.addEventListener("dragenter",function(c){l.fileBasedScanRegion.style.border=l.fileBasedScanRegionActiveBorder(),c.stopPropagation(),c.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragleave",function(c){l.fileBasedScanRegion.style.border=l.fileBasedScanRegionDefaultBorder(),c.stopPropagation(),c.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragover",function(c){l.fileBasedScanRegion.style.border=l.fileBasedScanRegionActiveBorder(),c.stopPropagation(),c.preventDefault()}),this.fileBasedScanRegion.addEventListener("drop",function(c){c.stopPropagation(),c.preventDefault(),l.fileBasedScanRegion.style.border=l.fileBasedScanRegionDefaultBorder();var d=c.dataTransfer;if(d){var u=d.files;if(!u||u.length===0)return;for(var f=!1,m=0;m<u.length;++m){var x=u.item(m);if(x){var b=/image.*/;if(x.type.match(b)){f=!0;var w=x.name;l.setImageNameToButton(w),a(x),o.innerText=ps.dragAndDropMessage();break}}}f||(o.innerText=ps.dragAndDropMessageOnlyImages())}})}return t.prototype.hide=function(){this.fileBasedScanRegion.style.display="none",this.fileScanInput.disabled=!0},t.prototype.show=function(){this.fileBasedScanRegion.style.display="block",this.fileScanInput.disabled=!1},t.prototype.isShowing=function(){return this.fileBasedScanRegion.style.display==="block"},t.prototype.resetValue=function(){this.fileScanInput.value="",this.setInitialValueToButton()},t.prototype.createFileBasedScanRegion=function(){var s=document.createElement("div");return s.style.textAlign="center",s.style.margin="auto",s.style.width="80%",s.style.maxWidth="600px",s.style.border=this.fileBasedScanRegionDefaultBorder(),s.style.padding="10px",s.style.marginBottom="10px",s},t.prototype.fileBasedScanRegionDefaultBorder=function(){return"6px dashed #ebebeb"},t.prototype.fileBasedScanRegionActiveBorder=function(){return"6px dashed rgb(153 151 151)"},t.prototype.createDragAndDropMessage=function(){var s=document.createElement("div");return s.innerText=ps.dragAndDropMessage(),s.style.fontWeight="400",s},t.prototype.setImageNameToButton=function(s){var n=20;if(s.length>n){var a=s.substring(0,8),i=s.length,l=s.substring(i-8,i);s="".concat(a,"....").concat(l)}var o=ps.fileSelectionChooseAnother()+" - "+s;this.fileSelectionButton.innerText=o},t.prototype.setInitialValueToButton=function(){var s=ps.fileSelectionChooseImage()+" - "+ps.fileSelectionNoImageSelected();this.fileSelectionButton.innerText=s},t.prototype.getFileScanInputId=function(){return"html5-qrcode-private-filescan-input"},t.create=function(s,n,a){var i=new t(s,n,a);return i},t}(),I8e=function(){function t(s){this.selectElement=go.createElement("select",Wa.CAMERA_SELECTION_SELECT_ID),this.cameras=s,this.options=[]}return t.prototype.render=function(s){var n=document.createElement("span");n.style.marginRight="10px";var a=this.cameras.length;if(a===0)throw new Error("No cameras found");if(a===1)n.style.display="none";else{var i=ps.selectCamera();n.innerText="".concat(i," (").concat(this.cameras.length,")  ")}for(var l=1,o=0,c=this.cameras;o<c.length;o++){var d=c[o],u=d.id,f=d.label==null?u:d.label;(!f||f==="")&&(f=[ps.anonymousCameraPrefix(),l++].join(" "));var m=document.createElement("option");m.value=u,m.innerText=f,this.options.push(m),this.selectElement.appendChild(m)}n.appendChild(this.selectElement),s.appendChild(n)},t.prototype.disable=function(){this.selectElement.disabled=!0},t.prototype.isDisabled=function(){return this.selectElement.disabled===!0},t.prototype.enable=function(){this.selectElement.disabled=!1},t.prototype.getValue=function(){return this.selectElement.value},t.prototype.hasValue=function(s){for(var n=0,a=this.options;n<a.length;n++){var i=a[n];if(i.value===s)return!0}return!1},t.prototype.setValue=function(s){if(!this.hasValue(s))throw new Error("".concat(s," is not present in the camera list."));this.selectElement.value=s},t.prototype.hasSingleItem=function(){return this.cameras.length===1},t.prototype.numCameras=function(){return this.cameras.length},t.create=function(s,n){var a=new t(n);return a.render(s),a},t}(),M8e=function(){function t(){this.onChangeCallback=null,this.zoomElementContainer=document.createElement("div"),this.rangeInput=go.createElement("input",Wa.ZOOM_SLIDER_ID),this.rangeInput.type="range",this.rangeText=document.createElement("span"),this.rangeInput.min="1",this.rangeInput.max="5",this.rangeInput.value="1",this.rangeInput.step="0.1"}return t.prototype.render=function(s,n){this.zoomElementContainer.style.display=n?"block":"none",this.zoomElementContainer.style.padding="5px 10px",this.zoomElementContainer.style.textAlign="center",s.appendChild(this.zoomElementContainer),this.rangeInput.style.display="inline-block",this.rangeInput.style.width="50%",this.rangeInput.style.height="5px",this.rangeInput.style.background="#d3d3d3",this.rangeInput.style.outline="none",this.rangeInput.style.opacity="0.7";var a=ps.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(a),this.rangeText.style.marginRight="10px";var i=this;this.rangeInput.addEventListener("input",function(){return i.onValueChange()}),this.rangeInput.addEventListener("change",function(){return i.onValueChange()}),this.zoomElementContainer.appendChild(this.rangeInput),this.zoomElementContainer.appendChild(this.rangeText)},t.prototype.onValueChange=function(){var s=ps.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(s),this.onChangeCallback&&this.onChangeCallback(parseFloat(this.rangeInput.value))},t.prototype.setValues=function(s,n,a,i){this.rangeInput.min=s.toString(),this.rangeInput.max=n.toString(),this.rangeInput.step=i.toString(),this.rangeInput.value=a.toString(),this.onValueChange()},t.prototype.show=function(){this.zoomElementContainer.style.display="block"},t.prototype.hide=function(){this.zoomElementContainer.style.display="none"},t.prototype.setOnCameraZoomValueChangeCallback=function(s){this.onChangeCallback=s},t.prototype.removeOnCameraZoomValueChangeCallback=function(){this.onChangeCallback=null},t.create=function(s,n){var a=new t;return a.render(s,n),a},t}(),Ba;(function(t){t[t.STATUS_DEFAULT=0]="STATUS_DEFAULT",t[t.STATUS_SUCCESS=1]="STATUS_SUCCESS",t[t.STATUS_WARNING=2]="STATUS_WARNING",t[t.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(Ba||(Ba={}));function D8e(t){return{fps:t.fps,qrbox:t.qrbox,aspectRatio:t.aspectRatio,disableFlip:t.disableFlip,videoConstraints:t.videoConstraints}}function O8e(t,s){return{formatsToSupport:t.formatsToSupport,useBarCodeDetectorIfSupported:t.useBarCodeDetectorIfSupported,experimentalFeatures:t.experimentalFeatures,verbose:s}}var R8e=function(){function t(s,n,a){if(this.lastMatchFound=null,this.cameraScanImage=null,this.fileScanImage=null,this.fileSelectionUi=null,this.elementId=s,this.config=this.createConfig(n),this.verbose=a===!0,!document.getElementById(s))throw"HTML Element with id=".concat(s," not found");this.scanTypeSelector=new nc(this.config.supportedScanTypes),this.currentScanType=this.scanTypeSelector.getDefaultScanType(),this.sectionSwapAllowed=!0,this.logger=new mK(this.verbose),this.persistedDataManager=new _8e,n.rememberLastUsedCamera!==!0&&this.persistedDataManager.reset()}return t.prototype.render=function(s,n){var a=this;this.lastMatchFound=null,this.qrCodeSuccessCallback=function(l,o){if(s)s(l,o);else{if(a.lastMatchFound===l)return;a.lastMatchFound=l,a.setHeaderMessage(ps.lastMatch(l),Ba.STATUS_SUCCESS)}},this.qrCodeErrorCallback=function(l,o){n&&n(l,o)};var i=document.getElementById(this.elementId);if(!i)throw"HTML Element with id=".concat(this.elementId," not found");i.innerHTML="",this.createBasicLayout(i),this.html5Qrcode=new HR(this.getScanRegionId(),O8e(this.config,this.verbose))},t.prototype.pause=function(s){(kl(s)||s!==!0)&&(s=!1),this.getHtml5QrcodeOrFail().pause(s)},t.prototype.resume=function(){this.getHtml5QrcodeOrFail().resume()},t.prototype.getState=function(){return this.getHtml5QrcodeOrFail().getState()},t.prototype.clear=function(){var s=this,n=function(){var a=document.getElementById(s.elementId);a&&(a.innerHTML="",s.resetBasicLayout(a))};return this.html5Qrcode?new Promise(function(a,i){if(!s.html5Qrcode){a();return}s.html5Qrcode.isScanning?s.html5Qrcode.stop().then(function(l){if(!s.html5Qrcode){a();return}s.html5Qrcode.clear(),n(),a()}).catch(function(l){s.verbose&&s.logger.logError("Unable to stop qrcode scanner",l),i(l)}):(s.html5Qrcode.clear(),n(),a())}):Promise.resolve()},t.prototype.getRunningTrackCapabilities=function(){return this.getHtml5QrcodeOrFail().getRunningTrackCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getHtml5QrcodeOrFail().getRunningTrackSettings()},t.prototype.applyVideoConstraints=function(s){return this.getHtml5QrcodeOrFail().applyVideoConstraints(s)},t.prototype.getHtml5QrcodeOrFail=function(){if(!this.html5Qrcode)throw"Code scanner not initialized.";return this.html5Qrcode},t.prototype.createConfig=function(s){return s?(s.fps||(s.fps=Gi.SCAN_DEFAULT_FPS),s.rememberLastUsedCamera!==!Gi.DEFAULT_REMEMBER_LAST_CAMERA_USED&&(s.rememberLastUsedCamera=Gi.DEFAULT_REMEMBER_LAST_CAMERA_USED),s.supportedScanTypes||(s.supportedScanTypes=Gi.DEFAULT_SUPPORTED_SCAN_TYPE),s):{fps:Gi.SCAN_DEFAULT_FPS,rememberLastUsedCamera:Gi.DEFAULT_REMEMBER_LAST_CAMERA_USED,supportedScanTypes:Gi.DEFAULT_SUPPORTED_SCAN_TYPE}},t.prototype.createBasicLayout=function(s){s.style.position="relative",s.style.padding="0px",s.style.border="1px solid silver",this.createHeader(s);var n=document.createElement("div"),a=this.getScanRegionId();n.id=a,n.style.width="100%",n.style.minHeight="100px",n.style.textAlign="center",s.appendChild(n),nc.isCameraScanType(this.currentScanType)?this.insertCameraScanImageToScanRegion():this.insertFileScanImageToScanRegion();var i=document.createElement("div"),l=this.getDashboardId();i.id=l,i.style.width="100%",s.appendChild(i),this.setupInitialDashboard(i)},t.prototype.resetBasicLayout=function(s){s.style.border="none"},t.prototype.setupInitialDashboard=function(s){this.createSection(s),this.createSectionControlPanel(),this.scanTypeSelector.hasMoreThanOneScanType()&&this.createSectionSwap()},t.prototype.createHeader=function(s){var n=document.createElement("div");n.style.textAlign="left",n.style.margin="0px",s.appendChild(n);var a=new k8e;a.renderInto(n);var i=document.createElement("div");i.id=this.getHeaderMessageContainerId(),i.style.display="none",i.style.textAlign="center",i.style.fontSize="14px",i.style.padding="2px 10px",i.style.margin="4px",i.style.borderTop="1px solid #f6f6f6",n.appendChild(i)},t.prototype.createSection=function(s){var n=document.createElement("div");n.id=this.getDashboardSectionId(),n.style.width="100%",n.style.padding="10px 0px 10px 0px",n.style.textAlign="left",s.appendChild(n)},t.prototype.createCameraListUi=function(s,n,a){var i=this;i.showHideScanTypeSwapLink(!1),i.setHeaderMessage(ps.cameraPermissionRequesting());var l=function(){a||i.createPermissionButton(s,n)};HR.getCameras().then(function(o){i.persistedDataManager.setHasPermission(!0),i.showHideScanTypeSwapLink(!0),i.resetHeaderMessage(),o&&o.length>0?(s.removeChild(n),i.renderCameraSelection(o)):(i.setHeaderMessage(ps.noCameraFound(),Ba.STATUS_WARNING),l())}).catch(function(o){i.persistedDataManager.setHasPermission(!1),a?a.disabled=!1:l(),i.setHeaderMessage(o,Ba.STATUS_WARNING),i.showHideScanTypeSwapLink(!0)})},t.prototype.createPermissionButton=function(s,n){var a=this,i=go.createElement("button",this.getCameraPermissionButtonId());i.innerText=ps.cameraPermissionTitle(),i.addEventListener("click",function(){i.disabled=!0,a.createCameraListUi(s,n,i)}),n.appendChild(i)},t.prototype.createPermissionsUi=function(s,n){var a=this;if(nc.isCameraScanType(this.currentScanType)&&this.persistedDataManager.hasCameraPermissions()){GR.hasPermissions().then(function(i){i?a.createCameraListUi(s,n):(a.persistedDataManager.setHasPermission(!1),a.createPermissionButton(s,n))}).catch(function(i){a.persistedDataManager.setHasPermission(!1),a.createPermissionButton(s,n)});return}this.createPermissionButton(s,n)},t.prototype.createSectionControlPanel=function(){var s=document.getElementById(this.getDashboardSectionId()),n=document.createElement("div");s.appendChild(n);var a=document.createElement("div");a.id=this.getDashboardSectionCameraScanRegionId(),a.style.display=nc.isCameraScanType(this.currentScanType)?"block":"none",n.appendChild(a);var i=document.createElement("div");i.style.textAlign="center",a.appendChild(i),this.scanTypeSelector.isCameraScanRequired()&&this.createPermissionsUi(a,i),this.renderFileScanUi(n)},t.prototype.renderFileScanUi=function(s){var n=nc.isFileScanType(this.currentScanType),a=this,i=function(l){if(!a.html5Qrcode)throw"html5Qrcode not defined";nc.isFileScanType(a.currentScanType)&&(a.setHeaderMessage(ps.loadingImage()),a.html5Qrcode.scanFileV2(l,!0).then(function(o){a.resetHeaderMessage(),a.qrCodeSuccessCallback(o.decodedText,o)}).catch(function(o){a.setHeaderMessage(o,Ba.STATUS_WARNING),a.qrCodeErrorCallback(o,fK.createFrom(o))}))};this.fileSelectionUi=P8e.create(s,n,i)},t.prototype.renderCameraSelection=function(s){var n=this,a=this,i=document.getElementById(this.getDashboardSectionCameraScanRegionId());i.style.textAlign="center";var l=M8e.create(i,!1),o=function(j){var _=j.zoomFeature();if(_.isSupported()){l.setOnCameraZoomValueChangeCallback(function(k){_.apply(k)});var C=1;n.config.defaultZoomValueIfSupported&&(C=n.config.defaultZoomValueIfSupported),C=e8e(C,_.min(),_.max()),l.setValues(_.min(),_.max(),C,_.step()),l.show()}},c=I8e.create(i,s),d=document.createElement("span"),u=go.createElement("button",Wa.CAMERA_START_BUTTON_ID);u.innerText=ps.scanButtonStartScanningText(),d.appendChild(u);var f=go.createElement("button",Wa.CAMERA_STOP_BUTTON_ID);f.innerText=ps.scanButtonStopScanningText(),f.style.display="none",f.disabled=!0,d.appendChild(f);var m,x=function(j){if(!j.torchFeature().isSupported()){m&&m.hide();return}m?m.updateTorchCapability(j.torchFeature()):m=T8e.create(d,j.torchFeature(),{display:"none",marginLeft:"5px"},function(_){a.setHeaderMessage(_,Ba.STATUS_WARNING)}),m.show()};i.appendChild(d);var b=function(j){j||(u.style.display="none"),u.innerText=ps.scanButtonStartScanningText(),u.style.opacity="1",u.disabled=!1,j&&(u.style.display="inline-block")};if(u.addEventListener("click",function(j){u.innerText=ps.scanButtonScanningStarting(),c.disable(),u.disabled=!0,u.style.opacity="0.5",n.scanTypeSelector.hasMoreThanOneScanType()&&a.showHideScanTypeSwapLink(!1),a.resetHeaderMessage();var _=c.getValue();a.persistedDataManager.setLastUsedCameraId(_),a.html5Qrcode.start(_,D8e(a.config),a.qrCodeSuccessCallback,a.qrCodeErrorCallback).then(function(C){f.disabled=!1,f.style.display="inline-block",b(!1);var k=a.html5Qrcode.getRunningTrackCameraCapabilities();n.config.showTorchButtonIfSupported===!0&&x(k),n.config.showZoomSliderIfSupported===!0&&o(k)}).catch(function(C){a.showHideScanTypeSwapLink(!0),c.enable(),b(!0),a.setHeaderMessage(C,Ba.STATUS_WARNING)})}),c.hasSingleItem()&&u.click(),f.addEventListener("click",function(j){if(!a.html5Qrcode)throw"html5Qrcode not defined";f.disabled=!0,a.html5Qrcode.stop().then(function(_){n.scanTypeSelector.hasMoreThanOneScanType()&&a.showHideScanTypeSwapLink(!0),c.enable(),u.disabled=!1,f.style.display="none",u.style.display="inline-block",m&&(m.reset(),m.hide()),l.removeOnCameraZoomValueChangeCallback(),l.hide(),a.insertCameraScanImageToScanRegion()}).catch(function(_){f.disabled=!1,a.setHeaderMessage(_,Ba.STATUS_WARNING)})}),a.persistedDataManager.getLastUsedCameraId()){var w=a.persistedDataManager.getLastUsedCameraId();c.hasValue(w)?(c.setValue(w),u.click()):a.persistedDataManager.resetLastUsedCameraId()}},t.prototype.createSectionSwap=function(){var s=this,n=ps.textIfCameraScanSelected(),a=ps.textIfFileScanSelected(),i=document.getElementById(this.getDashboardSectionId()),l=document.createElement("div");l.style.textAlign="center";var o=go.createElement("span",this.getDashboardSectionSwapLinkId());o.style.textDecoration="underline",o.style.cursor="pointer",o.innerText=nc.isCameraScanType(this.currentScanType)?n:a,o.addEventListener("click",function(){if(!s.sectionSwapAllowed){s.verbose&&s.logger.logError("Section swap called when not allowed");return}s.resetHeaderMessage(),s.fileSelectionUi.resetValue(),s.sectionSwapAllowed=!1,nc.isCameraScanType(s.currentScanType)?(s.clearScanRegion(),s.getCameraScanRegion().style.display="none",s.fileSelectionUi.show(),o.innerText=a,s.currentScanType=Qc.SCAN_TYPE_FILE,s.insertFileScanImageToScanRegion()):(s.clearScanRegion(),s.getCameraScanRegion().style.display="block",s.fileSelectionUi.hide(),o.innerText=n,s.currentScanType=Qc.SCAN_TYPE_CAMERA,s.insertCameraScanImageToScanRegion(),s.startCameraScanIfPermissionExistsOnSwap()),s.sectionSwapAllowed=!0}),l.appendChild(o),i.appendChild(l)},t.prototype.startCameraScanIfPermissionExistsOnSwap=function(){var s=this,n=this;if(this.persistedDataManager.hasCameraPermissions()){GR.hasPermissions().then(function(a){if(a){var i=document.getElementById(n.getCameraPermissionButtonId());if(!i)throw s.logger.logError("Permission button not found, fail;"),"Permission button not found";i.click()}else n.persistedDataManager.setHasPermission(!1)}).catch(function(a){n.persistedDataManager.setHasPermission(!1)});return}},t.prototype.resetHeaderMessage=function(){var s=document.getElementById(this.getHeaderMessageContainerId());s.style.display="none"},t.prototype.setHeaderMessage=function(s,n){n||(n=Ba.STATUS_DEFAULT);var a=this.getHeaderMessageDiv();switch(a.innerText=s,a.style.display="block",n){case Ba.STATUS_SUCCESS:a.style.background="rgba(106, 175, 80, 0.26)",a.style.color="#477735";break;case Ba.STATUS_WARNING:a.style.background="rgba(203, 36, 49, 0.14)",a.style.color="#cb2431";break;case Ba.STATUS_DEFAULT:default:a.style.background="rgba(0, 0, 0, 0)",a.style.color="rgb(17, 17, 17)";break}},t.prototype.showHideScanTypeSwapLink=function(s){this.scanTypeSelector.hasMoreThanOneScanType()&&(s!==!0&&(s=!1),this.sectionSwapAllowed=s,this.getDashboardSectionSwapLink().style.display=s?"inline-block":"none")},t.prototype.insertCameraScanImageToScanRegion=function(){var s=this,n=document.getElementById(this.getScanRegionId());if(this.cameraScanImage){n.innerHTML="<br>",n.appendChild(this.cameraScanImage);return}this.cameraScanImage=new Image,this.cameraScanImage.onload=function(a){n.innerHTML="<br>",n.appendChild(s.cameraScanImage)},this.cameraScanImage.width=64,this.cameraScanImage.style.opacity="0.8",this.cameraScanImage.src=w8e,this.cameraScanImage.alt=ps.cameraScanAltText()},t.prototype.insertFileScanImageToScanRegion=function(){var s=this,n=document.getElementById(this.getScanRegionId());if(this.fileScanImage){n.innerHTML="<br>",n.appendChild(this.fileScanImage);return}this.fileScanImage=new Image,this.fileScanImage.onload=function(a){n.innerHTML="<br>",n.appendChild(s.fileScanImage)},this.fileScanImage.width=64,this.fileScanImage.style.opacity="0.8",this.fileScanImage.src=N8e,this.fileScanImage.alt=ps.fileScanAltText()},t.prototype.clearScanRegion=function(){var s=document.getElementById(this.getScanRegionId());s.innerHTML=""},t.prototype.getDashboardSectionId=function(){return"".concat(this.elementId,"__dashboard_section")},t.prototype.getDashboardSectionCameraScanRegionId=function(){return"".concat(this.elementId,"__dashboard_section_csr")},t.prototype.getDashboardSectionSwapLinkId=function(){return Wa.SCAN_TYPE_CHANGE_ANCHOR_ID},t.prototype.getScanRegionId=function(){return"".concat(this.elementId,"__scan_region")},t.prototype.getDashboardId=function(){return"".concat(this.elementId,"__dashboard")},t.prototype.getHeaderMessageContainerId=function(){return"".concat(this.elementId,"__header_message")},t.prototype.getCameraPermissionButtonId=function(){return Wa.CAMERA_PERMISSION_BUTTON_ID},t.prototype.getCameraScanRegion=function(){return document.getElementById(this.getDashboardSectionCameraScanRegionId())},t.prototype.getDashboardSectionSwapLink=function(){return document.getElementById(this.getDashboardSectionSwapLinkId())},t.prototype.getHeaderMessageDiv=function(){return document.getElementById(this.getHeaderMessageContainerId())},t}();function L8e(){const[t,s]=y.useState(""),[n,a]=y.useState(!1),[i,l]=y.useState(null),[o,c]=y.useState(""),[d,u]=y.useState(null),[f,m]=y.useState(!1),x=y.useRef(null),b=y.useCallback(async A=>{if(!A){u(null);return}try{const T=await J.get(`/inventory/items/${A.id}/qr`,{responseType:"blob"}),P=URL.createObjectURL(T.data);u(R=>(R&&URL.revokeObjectURL(R),P))}catch(T){console.error(T),u(null),ie.error("Unable to load QR image")}},[]),w=y.useCallback(async A=>{var P,R;const T=(A||"").trim();if(c(""),l(null),u(null),!T){c("Please scan or enter a QR number.");return}try{a(!0);const I=await bhe(T);l(I.data),await b(I.data)}catch(I){const O=((R=(P=I==null?void 0:I.response)==null?void 0:P.data)==null?void 0:R.detail)||(I==null?void 0:I.message)||"No medicine found for this QR";c(O),ie.error(O)}finally{a(!1)}},[b]),j=y.useCallback(async A=>{A.preventDefault(),await w(t)},[t,w]),_=y.useCallback(async A=>{s(A),ie.success(`QR scanned: ${A}`),m(!1),await w(A)},[w]),C=y.useCallback(()=>{},[]);y.useEffect(()=>{if(!f){x.current&&(x.current.clear().catch(()=>{}),x.current=null);return}const A=new R8e("qr-reader",{fps:10,qrbox:250},!1);return x.current=A,A.render(_,C),()=>{x.current&&(x.current.clear().catch(()=>{}),x.current=null)}},[f,_,C]);const k=y.useCallback(async()=>{if(i)try{const T=(await J.get(`/inventory/items/${i.id}/qr`,{responseType:"blob"})).data,P=URL.createObjectURL(T),R=document.createElement("a");R.href=P,R.download=`${i.code||"medicine"}_qr.png`,document.body.appendChild(R),R.click(),R.remove(),URL.revokeObjectURL(P)}catch(A){const T=(A==null?void 0:A.message)||"Unable to download QR image";ie.error(T)}},[i]);return y.useEffect(()=>()=>{d&&URL.revokeObjectURL(d)},[d]),r.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-4 py-6 lg:px-8",children:r.jsxs("div",{className:"mx-auto flex max-w-5xl flex-col gap-6",children:[r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{children:[r.jsxs("h1",{className:"flex items-center gap-2 text-2xl font-semibold tracking-tight text-slate-900",children:[r.jsx(fN,{className:"h-6 w-6 text-slate-700"}),"Medicine QR Lookup"]}),r.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Scan medicine QR code with camera / scanner or enter QR number to instantly fetch medicine details."})]}),r.jsxs(Ge,{className:"flex items-center gap-1 rounded-full bg-slate-900 px-3 py-1 text-xs font-medium text-white",children:[r.jsx(Dy,{className:"h-3 w-3"}),"Live QR search"]})]}),r.jsxs(We,{className:"rounded-2xl border-slate-200 shadow-sm",children:[r.jsxs(st,{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{children:[r.jsx(lt,{className:"text-base font-semibold text-slate-900",children:"Scan or Enter QR Number"}),r.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Keep the cursor inside the QR box and scan with your scanner or use the camera scanner below."})]}),r.jsx(Re,{type:"button",variant:f?"outline":"default",size:"sm",onClick:()=>m(A=>!A),className:"inline-flex items-center gap-2",children:f?r.jsxs(r.Fragment,{children:[r.jsx(kte,{className:"h-4 w-4"}),"Stop Camera"]}):r.jsxs(r.Fragment,{children:[r.jsx(f4,{className:"h-4 w-4"}),"Use Camera Scanner"]})})]}),r.jsxs(qe,{className:"space-y-4",children:[r.jsxs("form",{onSubmit:j,className:"space-y-3",children:[r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"QR Number"}),r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx(fN,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),r.jsx(Ee,{autoFocus:!0,value:t,onChange:A=>s(A.target.value),placeholder:"e.g., MED-000123 or scan with your QR scanner...",className:"pl-9 text-sm"})]}),r.jsx(Re,{type:"submit",className:"w-full sm:w-auto",disabled:n,children:n?r.jsxs("span",{className:"inline-flex items-center gap-2",children:[r.jsx(ss,{className:"h-4 w-4 animate-spin"}),"Searching..."]}):r.jsxs("span",{className:"inline-flex items-center gap-2",children:[r.jsx(B8e,{}),"Search"]})})]})]}),r.jsxs("div",{className:"flex items-start gap-2 text-xs text-slate-500",children:[r.jsx(Ep,{className:"mt-0.5 h-3 w-3"}),r.jsxs("p",{children:["For USB QR scanners: focus the box and scan. Most scanners type the code and press",r.jsx("span",{className:"mx-1 rounded bg-slate-100 px-1 py-0.5 font-semibold",children:"Enter"}),"automatically."]})]})]}),f&&r.jsxs("div",{className:"mt-3 rounded-2xl border border-dashed border-slate-200 bg-slate-100/60 px-3 py-3",children:[r.jsxs("p",{className:"mb-2 flex items-center gap-2 text-xs text-slate-600",children:[r.jsx(f4,{className:"h-3 w-3"}),"Point your medicine QR code at the camera. Once decoded, the medicine will load automatically."]}),r.jsx("div",{id:"qr-reader",className:"h-[280px] w-full overflow-hidden rounded-xl bg-black/90"})]}),o&&r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-red-100 bg-red-50 px-3 py-2 text-xs text-red-700",children:[r.jsx(Ep,{className:"h-3 w-3"}),o]})]})]}),i&&r.jsxs(We,{className:"rounded-2xl border-slate-200 shadow-sm",children:[r.jsxs(st,{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs(lt,{className:"flex items-center gap-2 text-lg",children:[r.jsx(Vr,{className:"h-5 w-5 text-slate-700"}),r.jsx("span",{children:i.name})]}),r.jsxs("p",{className:"text-xs text-slate-500",children:["Code:"," ",r.jsx("span",{className:"font-mono text-slate-700",children:i.code}),i.qr_number&&r.jsxs(r.Fragment,{children:["  ","QR:"," ",r.jsx("span",{className:"font-mono text-slate-700",children:i.qr_number})]})]}),i.generic_name&&r.jsxs("p",{className:"text-xs text-slate-500",children:["Generic: ",i.generic_name]})]}),d&&r.jsxs("div",{className:"flex flex-col items-center gap-2",children:[r.jsx("div",{className:"rounded-xl border border-slate-200 bg-white p-2",children:r.jsx("img",{src:d,alt:`QR for ${i.name}`,className:"h-28 w-28 object-contain"})}),r.jsxs(Re,{type:"button",variant:"outline",size:"sm",className:"text-xs",onClick:k,children:[r.jsx(fN,{className:"mr-1 h-3 w-3"}),"Download QR"]})]})]}),r.jsxs(qe,{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[r.jsx(io,{label:"FORM / STRENGTH",value:`${i.form||"-"}${i.strength?`  ${i.strength}`:""}`}),r.jsx(io,{label:"PACK",value:`${i.pack_size||"-"} ${i.unit||""}`}),r.jsx(io,{label:"MANUFACTURER",value:i.manufacturer||"-"}),r.jsx(io,{label:"THERAPEUTIC CLASS",value:i.class_name||"-"}),r.jsx(io,{label:"ATC CODE",value:i.atc_code||"-"}),r.jsx(io,{label:"HSN CODE",value:i.hsn_code||"-"}),r.jsx(io,{label:"MRP / PRICE",value:`${i.default_mrp||0} MRP  ${i.default_price||0} Price`}),r.jsx(io,{label:"TAX %",value:`${i.default_tax_percent||0}%`}),r.jsx(io,{label:"REORDER / MAX LEVEL",value:`${i.reorder_level||0} / ${i.max_level||0}`})]})]})]})})}function io({label:t,value:s}){return r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2.5",children:[r.jsx("p",{className:"text-[11px] font-medium uppercase tracking-wide text-slate-500",children:t}),r.jsx("p",{className:"mt-1 truncate text-sm text-slate-800",title:s,children:s||"-"})]})}function B8e(){return r.jsx(Dy,{className:"h-4 w-4"})}function F8e(){const[t,s]=y.useState(""),[n,a]=y.useState(!1),[i,l]=y.useState(null),[o,c]=y.useState(""),[d,u]=y.useState(!1),[f,m]=y.useState(!1);y.useEffect(()=>()=>{o&&URL.revokeObjectURL(o)},[o]);const x=async()=>{const C=t.trim();if(!C){ie.error("Please enter or scan a barcode number");return}a(!0),m(!0),l(null),c("");try{const A=(await vhe(C)).data;if(!A){l(null);return}l(A),await b(A.id)}catch(k){console.error("Failed to lookup item by barcode",k),l(null)}finally{a(!1)}},b=async C=>{u(!0);try{const k=await GP(C),A=URL.createObjectURL(k.data);c(A)}catch(k){console.error("Failed to fetch barcode image",k)}finally{u(!1)}},w=C=>{C.key==="Enter"&&(C.preventDefault(),x())},j=async()=>{if(i)try{const C=await GP(i.id),k=new Blob([C.data],{type:"image/png"}),A=URL.createObjectURL(k),T=document.createElement("a");T.href=A,T.download=`${i.code||"medicine"}_barcode.png`,document.body.appendChild(T),T.click(),T.remove(),URL.revokeObjectURL(A)}catch(C){console.error("Failed to download barcode image",C)}},_=!n&&f&&!i;return r.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-3 sm:px-4 sm:py-4 md:px-6 md:py-6",children:r.jsxs("div",{className:"max-w-4xl mx-auto space-y-4 md:space-y-5 lg:space-y-6",children:[r.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-r from-teal-700 via-teal-600 to-blue-600 text-white shadow-md",children:[r.jsx("div",{className:"absolute inset-0 opacity-25 pointer-events-none bg-[radial-gradient(circle_at_top,_#e0f2fe,_transparent_55%)]"}),r.jsxs("div",{className:"relative px-4 py-5 sm:px-6 sm:py-6 md:px-8 md:py-7 lg:px-10 lg:py-8 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"space-y-3 max-w-xl",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-white/10 px-3 py-1 text-xs font-medium backdrop-blur-sm border border-white/20",children:[r.jsx("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-white/20 text-[11px]",children:r.jsx(j0,{className:"w-3.5 h-3.5"})}),"Scan & verify pharmacy items instantly"]}),r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"inline-flex h-11 w-11 md:h-12 md:w-12 items-center justify-center rounded-3xl bg-white/10 text-white shadow-sm border border-white/20",children:r.jsx(j0,{className:"w-6 h-6"})}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("h1",{className:"text-xl md:text-2xl lg:text-3xl font-semibold tracking-tight",children:"Medicine Barcode Lookup"}),r.jsxs("p",{className:"text-sm md:text-base text-teal-50/90 leading-relaxed",children:["Point your barcode / QR scanner at any"," ",r.jsx("span",{className:"font-semibold",children:"pharmacy item"})," and instantly fetch the mapped medicine, pricing and stock configuration from"," ",r.jsx("span",{className:"font-semibold",children:"Nutryah HIMS"}),"."]})]})]})]}),r.jsxs("div",{className:"w-full md:w-auto space-y-3",children:[r.jsxs("div",{className:"flex flex-wrap gap-2 justify-start md:justify-end",children:[r.jsx(Ge,{className:"bg-white/15 text-xs font-semibold border border-white/25 text-white rounded-full px-3 py-1",children:"Pharmacy Inventory"}),r.jsx(Ge,{className:"bg-white/10 text-xs border border-white/20 text-teal-50 rounded-full px-3 py-1",children:"Scan-ready"})]}),r.jsxs("div",{className:"rounded-2xl bg-white/10 px-3 py-2.5 border border-white/15 text-xs text-teal-50/90",children:[r.jsx("span",{className:"font-semibold",children:"Tip:"})," Keep the cursor inside the barcode box. Most hardware scanners type the code and press"," ",r.jsx("span",{className:"inline-flex items-center rounded-md border border-white/40 bg-white/10 px-1.5 py-0.5 text-[11px] font-semibold",children:"Enter"})," ","automatically."]})]})]})]}),r.jsxs(We,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsx(st,{className:"pb-3",children:r.jsx(lt,{className:"flex flex-col gap-1 sm:flex-row sm:items-center sm:justify-between text-slate-900",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"inline-flex h-9 w-9 items-center justify-center rounded-2xl bg-slate-900 text-white",children:r.jsx(j0,{className:"w-4 h-4"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-semibold",children:"Scan or enter barcode / QR number"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Works with both hardware scanners and manual entry."})]})]})})}),r.jsxs(qe,{className:"space-y-3",children:[r.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[r.jsx("div",{className:"flex-1",children:r.jsxs("div",{className:"relative flex items-center",children:[r.jsx("div",{className:"pointer-events-none absolute left-3 flex items-center text-slate-400",children:r.jsx(j0,{className:"w-4 h-4"})}),r.jsx(Ee,{value:t,onChange:C=>s(C.target.value),onKeyDown:w,placeholder:"Scan or type the barcode / QR number (e.g. MD_1001)",className:"w-full rounded-2xl border border-slate-200 bg-slate-50 pl-9 pr-3 py-2 text-sm text-slate-800 shadow-none focus-visible:ring-2 focus-visible:ring-teal-100 focus-visible:border-teal-500",autoFocus:!0})]})}),r.jsxs(Re,{onClick:x,className:"shrink-0 rounded-full bg-blue-600 px-5 py-2 text-sm font-semibold text-white hover:bg-blue-700 active:scale-95 flex items-center gap-2",disabled:n,children:[r.jsx(is,{className:"w-4 h-4"}),n?"Searching":"Search"]})]}),r.jsxs("p",{className:"text-xs md:text-sm text-slate-500 flex items-center gap-1.5",children:[r.jsx(yn,{className:"w-3.5 h-3.5"}),"If your scanner is configured as a keyboard wedge, just keep the focus here and scan. No extra clicks needed."]})]})]}),n&&r.jsx(We,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:r.jsxs(qe,{className:"p-4 md:p-6 space-y-4",children:[r.jsx(Je,{className:"h-6 w-2/3 rounded-xl"}),r.jsx(Je,{className:"h-4 w-1/3 rounded-xl"}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsx(Je,{className:"h-20 rounded-2xl"}),r.jsx(Je,{className:"h-20 rounded-2xl"}),r.jsx(Je,{className:"h-20 rounded-2xl"})]})]})}),_&&r.jsx(We,{className:"rounded-3xl border-dashed border-slate-300 bg-white shadow-none",children:r.jsxs(qe,{className:"p-6 flex flex-col items-center justify-center text-center gap-3",children:[r.jsx("div",{className:"h-12 w-12 rounded-full bg-slate-100 flex items-center justify-center border border-slate-200",children:r.jsx(yn,{className:"w-6 h-6 text-slate-600"})}),r.jsx("h2",{className:"text-sm md:text-base font-semibold text-slate-900",children:"No item found for this barcode"}),r.jsxs("p",{className:"text-xs md:text-sm text-slate-600 max-w-md",children:["Check if the code is correct or try scanning again. If this is a new medicine, map the barcode in"," ",r.jsx("span",{className:"font-semibold text-slate-900",children:"Pharmacy Inventory > Items"}),"."]})]})}),!n&&i&&r.jsx(We,{className:"rounded-3xl border-slate-200 bg-white shadow-sm overflow-hidden",children:r.jsxs(qe,{className:"p-4 md:p-6 space-y-4",children:[r.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:gap-8",children:[r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx("span",{className:"inline-flex h-9 w-9 items-center justify-center rounded-full bg-slate-100",children:r.jsx(Vr,{className:"w-4 h-4 text-slate-600"})}),r.jsx("h2",{className:"text-xl md:text-2xl font-semibold text-slate-900",children:i.name}),i.is_active===!1&&r.jsx(Ge,{variant:"outline",className:"border-amber-300 text-amber-800 bg-amber-50 text-xs rounded-full",children:"Inactive"})]}),r.jsxs("div",{className:"text-sm text-slate-600 flex flex-wrap items-center gap-2",children:[r.jsxs("span",{children:[r.jsx("span",{className:"font-medium text-slate-700",children:"Code:"})," ",i.code||""]}),r.jsx("span",{className:"text-slate-300",children:""}),r.jsxs("span",{children:[r.jsx("span",{className:"font-medium text-slate-700",children:"Barcode / QR:"})," ",i.qr_number||""]})]}),i.generic_name&&r.jsxs("p",{className:"text-sm text-slate-600",children:[r.jsx("span",{className:"font-medium text-slate-700",children:"Generic:"})," ",i.generic_name]})]}),r.jsxs("div",{className:"w-full md:w-64 lg:w-72 flex flex-col items-center gap-3",children:[r.jsxs("div",{className:"w-full h-32 md:h-36 rounded-2xl border border-dashed border-slate-200 bg-slate-50 flex items-center justify-center",children:[d&&r.jsx(Je,{className:"w-40 h-20 rounded-md"}),!d&&o&&r.jsx("img",{src:o,alt:`Barcode for ${i.name}`,className:"max-h-full max-w-full object-contain"}),!d&&!o&&r.jsx("span",{className:"text-xs text-slate-400",children:"No barcode image"})]}),r.jsxs(Re,{type:"button",variant:"outline",className:"w-full rounded-full text-sm font-semibold border-slate-200",onClick:j,children:[r.jsx(Ll,{className:"w-4 h-4 mr-2"}),"Download barcode"]})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-3 lg:grid-cols-4 mt-3",children:[r.jsx(rc,{label:"Form / Strength",icon:r.jsx(Vr,{className:"w-4 h-4"}),value:`${i.form||"-"}${i.strength?`  ${i.strength}`:""}`}),r.jsx(rc,{label:"Pack",icon:r.jsx(x7,{className:"w-4 h-4"}),value:`${i.pack_size||1} ${i.unit||"unit"}`}),r.jsx(rc,{label:"Manufacturer",icon:r.jsx(Rm,{className:"w-4 h-4"}),value:i.manufacturer||""}),r.jsx(rc,{label:"Therapeutic class",icon:r.jsx(Rm,{className:"w-4 h-4"}),value:i.class_name||""}),r.jsx(rc,{label:"ATC code",icon:r.jsx(Rm,{className:"w-4 h-4"}),value:i.atc_code||""}),r.jsx(rc,{label:"HSN code",icon:r.jsx(Rm,{className:"w-4 h-4"}),value:i.hsn_code||""}),r.jsx(rc,{label:"MRP / Price",icon:r.jsx(Pl,{className:"w-4 h-4"}),value:`${Number(i.default_mrp||0).toFixed(2)} MRP  ${Number(i.default_price||0).toFixed(2)} Price`}),r.jsx(rc,{label:"Reorder / Max level",icon:r.jsx(yn,{className:"w-4 h-4"}),value:`${Number(i.reorder_level||0).toFixed(2)} / ${Number(i.max_level||0).toFixed(2)}`})]})]})})]})})}function rc({label:t,icon:s,value:n}){return r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-4 py-3 flex flex-col gap-1",children:[r.jsxs("div",{className:"flex items-center gap-2 text-[11px] font-medium text-slate-500 uppercase tracking-wide",children:[r.jsx("span",{className:"inline-flex h-5 w-5 items-center justify-center rounded-full bg-slate-100 text-slate-600",children:s}),t]}),r.jsx("div",{className:"text-sm text-slate-800 truncate",title:n?String(n):"",children:n||""})]})}function $8e(t={}){return J.get("/pharmacy/rx",{params:t})}function bK(t){return J.get(`/pharmacy/prescriptions/${t}`)}function z8e(t){return J.post("/pharmacy/prescriptions",t)}function U8e(t,s){return J.post(`/pharmacy/prescriptions/${t}/dispense`,s)}function V8e(t={}){return J.get("/pharmacy/rx-queue",{params:t})}const qj=[{value:"OPD",label:"OPD"},{value:"IPD",label:"IPD"},{value:"OT",label:"OT"},{value:"COUNTER",label:"Counter"}],H8e=[{value:"ROUTINE",label:"Routine"},{value:"STAT",label:"STAT / Urgent"},{value:"PRN",label:"PRN / As needed"}];function vK(){const t=new Date,s=t.getTimezoneOffset();return new Date(t.getTime()-s*60*1e3).toISOString().slice(0,16)}const Gj={type:"OPD",priority:"ROUTINE",datetime:vK(),patient:null,doctorId:"",visitNo:"",admissionNo:"",otCaseNo:"",notes:""},pg={item:null,item_name:"",strength:"",route:"PO",dose:"",frequency:"",duration_days:"",total_qty:"",instructions:"",is_prn:!1,is_stat:!1,requested_qty:""};function W8e(){var rt,bt,be;const[t,s]=y.useState("list"),[n,a]=y.useState("ALL"),[i,l]=y.useState("ALL"),[o,c]=y.useState(""),[d,u]=y.useState(!1),[f,m]=y.useState([]),[x,b]=y.useState(null),[w,j]=y.useState(Gj),[_,C]=y.useState([]),[k,A]=y.useState(pg),[T,P]=y.useState(!1),[R,I]=y.useState(""),[O,M]=y.useState([]),[B,L]=y.useState(!1),[F,V]=y.useState(!1),[U,z]=y.useState([]),[W,q]=y.useState(!1),[G,se]=y.useState(""),[ge,ke]=y.useState([]),[ee,pe]=y.useState(!1),[ue,ye]=y.useState(!1);y.useEffect(()=>{(async()=>{var ne;try{q(!0);const me=await Nk(),Ne=((ne=me==null?void 0:me.data)==null?void 0:ne.doctors)||[];z(Ne)}catch{}finally{q(!1)}})()},[]),y.useEffect(()=>{X()},[n,i]);async function X(){try{u(!0);const ne={};n!=="ALL"&&(ne.type=n),i!=="ALL"&&(ne.status=i),o!=null&&o.trim()&&(ne.q=o.trim()),ne.limit=100;const me=await $8e(ne);m((me==null?void 0:me.data)||[])}catch{}finally{u(!1)}}y.useEffect(()=>{if(!R||R.trim().length<2){M([]);return}let ne=!1;return(async()=>{var me;try{L(!0);const Ne=await CG(R.trim());if(ne)return;M(((me=Ne==null?void 0:Ne.data)==null?void 0:me.items)||(Ne==null?void 0:Ne.data)||[]),V(!0)}catch{}finally{ne||L(!1)}})(),()=>{ne=!0}},[R]);function oe(ne){j(me=>({...me,patient:ne})),I(`${ne.uhid?`${ne.uhid}  `:""}${ne.first_name||""} ${ne.last_name||""}`.trim()),V(!1)}y.useEffect(()=>{if(!G||G.trim().length<2){ke([]);return}let ne=!1;return(async()=>{var me;try{pe(!0);const Ne=await ik({q:G.trim(),kind:"MEDICINE",limit:15});if(ne)return;const Be=((me=Ne==null?void 0:Ne.data)==null?void 0:me.items)||(Ne==null?void 0:Ne.data)||[];ke(Be),ye(!0)}catch{}finally{ne||pe(!1)}})(),()=>{ne=!0}},[G]);function _e(ne){A(me=>({...me,item:ne,item_name:ne.name||ne.item_name||""})),se(ne.name||ne.item_name||""),ye(!1)}function ce(){j({...Gj,type:w.type||"OPD"}),C([]),A(pg),I("")}function he(ne){const me=ne;j(Ne=>({...Gj,type:me,datetime:vK()})),C([]),A(pg),I(""),b(null),s("new")}function fe(ne){const me=Number(ne.duration_days||0),Ne=(ne.frequency||"").trim();if(!me||!Ne)return"";const jt=Ne.split("-").map(yt=>Number(yt||0)).reduce((yt,pt)=>yt+(Number.isFinite(pt)?pt:0),0);return jt?String(jt*me):""}function le(){if(!k.item&&!k.item_name){ie.error("Select a medicine first");return}const ne=fe(k),me=k.total_qty||ne;if(!me){ie.error("Enter Total Qty or proper Frequency + Days");return}const Ne={...k,total_qty:me,requested_qty:k.requested_qty||me};C(Be=>[...Be,Ne]),A(pg),se(""),ye(!1)}function Ve(ne){C(me=>me.filter((Ne,Be)=>Be!==ne))}async function Ke(){var me;if(!w.patient&&w.type!=="COUNTER"){ie.error("Select a patient");return}if(!w.doctorId&&w.type!=="COUNTER"){ie.error("Select a doctor");return}if(!_.length){ie.error("Add at least one medicine");return}const ne={type:w.type,priority:w.priority,rx_datetime:w.datetime,patient_id:((me=w.patient)==null?void 0:me.id)||null,doctor_user_id:w.doctorId||null,visit_id:w.type==="OPD"&&w.visitNo||null,ipd_admission_id:w.type==="IPD"&&w.admissionNo||null,ot_case_id:w.type==="OT"&&w.otCaseNo||null,notes:w.notes||"",lines:_.map(Ne=>{var pt,Cs;const Be=fe(Ne),jt=Ne.total_qty||Ne.requested_qty||Be||"",yt=jt?Number(jt):null;return{item_id:((pt=Ne.item)==null?void 0:pt.id)||Ne.item_id||null,item_name:((Cs=Ne.item)==null?void 0:Cs.name)||Ne.item_name||"",strength:Ne.strength||null,route:Ne.route||null,dose:Ne.dose||null,frequency:Ne.frequency||null,duration_days:Ne.duration_days?Number(Ne.duration_days):null,requested_qty:yt,total_qty:yt,instructions:Ne.instructions||null,is_prn:!!Ne.is_prn,is_stat:!!Ne.is_stat}})};try{P(!0);const Ne=await z8e(ne);ie.success("Prescription created & sent to Pharmacy"),ce(),s("list"),X(),Ne!=null&&Ne.data&&b(Ne.data)}catch{}finally{P(!1)}}async function wt(ne){try{const me=await bK(ne.id),Ne=(me==null?void 0:me.data)||ne;b(Ne),s("detail")}catch{}}const mt=y.useMemo(()=>x?x.lines||x.items||[]:[],[x]);return r.jsxs("div",{className:"p-4 md:p-6 space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-slate-900",children:"Pharmacy Prescriptions"}),r.jsx("p",{className:"text-sm text-slate-500",children:"Create and manage OPD, IPD, OT and Counter prescriptions linked to inventory & billing."})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs(Ms,{value:w.type,onValueChange:ne=>j(me=>({...me,type:ne})),children:[r.jsx(Es,{className:"w-[140px] bg-white border-slate-200 rounded-full",children:r.jsx(Ds,{placeholder:"Rx Type"})}),r.jsx(Ts,{children:qj.map(ne=>r.jsx(Mt,{value:ne.value,children:ne.label},ne.value))})]}),r.jsxs(Re,{className:"rounded-full",onClick:()=>he(w.type||"OPD"),children:[r.jsx(us,{className:"w-4 h-4 mr-2"}),"New Prescription"]})]})]}),r.jsxs(Hl,{value:t,onValueChange:s,children:[r.jsxs(ll,{className:"mb-4",children:[r.jsx(xs,{value:"list",children:"Queue / History"}),r.jsx(xs,{value:"new",children:"New Rx"}),r.jsx(xs,{value:"detail",disabled:!x,children:"Selected Rx"})]}),r.jsx(fs,{value:"list",className:"space-y-3",children:r.jsxs(We,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(st,{className:"pb-3",children:r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[r.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[r.jsx("span",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Filter by"}),r.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[r.jsx("button",{type:"button",onClick:()=>a("ALL"),className:`px-2.5 py-1 rounded-full text-xs border ${n==="ALL"?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-200"}`,children:"All Types"}),qj.map(ne=>r.jsxs("button",{type:"button",onClick:()=>a(ne.value),className:`px-2.5 py-1 rounded-full text-xs border flex items-center gap-1.5 ${n===ne.value?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-200"}`,children:[r.jsx(Vr,{className:"w-3 h-3"}),ne.label]},ne.value))]})]}),r.jsxs("div",{className:"flex items-center gap-2 w-full md:w-auto",children:[r.jsxs("div",{className:"relative flex-1 md:w-64",children:[r.jsx(is,{className:"w-4 h-4 text-slate-400 absolute left-2.5 top-2.5"}),r.jsx(Ee,{value:o,onChange:ne=>c(ne.target.value),placeholder:"Search UHID / name / Rx no...",className:"pl-8 text-sm bg-white border-slate-200 rounded-full",onKeyDown:ne=>{ne.key==="Enter"&&X()}})]}),r.jsxs(Ms,{value:i,onValueChange:l,children:[r.jsx(Es,{className:"w-[130px] bg-white border-slate-200 rounded-full text-xs",children:r.jsx(Ds,{placeholder:"Status"})}),r.jsxs(Ts,{children:[r.jsx(Mt,{value:"ALL",children:"All status"}),r.jsx(Mt,{value:"DRAFT",children:"Draft"}),r.jsx(Mt,{value:"PENDING",children:"Pending"}),r.jsx(Mt,{value:"PARTIAL",children:"Partial"}),r.jsx(Mt,{value:"DISPENSED",children:"Dispensed"}),r.jsx(Mt,{value:"CANCELLED",children:"Cancelled"})]})]}),r.jsx(Re,{variant:"outline",size:"icon",className:"rounded-full border-slate-200",onClick:X,children:r.jsx(Ei,{className:"w-4 h-4"})})]})]})}),r.jsx(qe,{className:"pt-0",children:r.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:r.jsx("div",{className:"max-h-[420px] overflow-auto",children:r.jsxs("table",{className:"w-full text-sm",children:[r.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:r.jsxs("tr",{className:"text-xs text-slate-500",children:[r.jsx("th",{className:"text-left px-3 py-2.5 font-medium",children:"Rx No"}),r.jsx("th",{className:"text-left px-3 py-2.5 font-medium",children:"Patient"}),r.jsx("th",{className:"text-left px-3 py-2.5 font-medium",children:"Type / Doctor"}),r.jsx("th",{className:"text-left px-3 py-2.5 font-medium",children:"Items"}),r.jsx("th",{className:"text-left px-3 py-2.5 font-medium",children:"Created"}),r.jsx("th",{className:"text-left px-3 py-2.5 font-medium",children:"Status"}),r.jsx("th",{className:"text-right px-3 py-2.5 font-medium",children:"Actions"})]})}),r.jsxs("tbody",{children:[d&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"px-3 py-6 text-center text-xs text-slate-500",children:"Loading prescriptions..."})}),!d&&!f.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"px-3 py-6 text-center text-xs text-slate-500",children:"No prescriptions found for the selected filters."})}),!d&&f.map(ne=>{var ae,Te;const me=(ne.status||"").toUpperCase()||"PENDING",Ne=ne.type||ne.rx_type||"OPD",Be=ne.created_at||ne.rx_datetime||ne.bill_date||null,jt=Be?String(Be).slice(0,16).replace("T"," "):"",yt=ne.patient||ne.patient_name||ne.patient_uhid||"",pt=typeof yt=="string"?yt:`${yt.first_name||""} ${yt.last_name||""}`.trim(),Cs=((ae=ne.items)==null?void 0:ae.length)||((Te=ne.lines)==null?void 0:Te.length)||ne.item_count||"",hs=ne.doctor_name||ne.doctor||ne.doctor_display||"";return r.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60 transition-colors",children:[r.jsx("td",{className:"px-3 py-2.5 align-middle",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-xs font-medium text-slate-900",children:ne.rx_number||`RX-${ne.id}`}),ne.uhid&&r.jsxs("span",{className:"text-[11px] text-slate-500",children:["UHID: ",ne.uhid]})]})}),r.jsx("td",{className:"px-3 py-2.5 align-middle",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-7 h-7 rounded-full bg-slate-100 flex items-center justify-center text-[11px] font-medium text-slate-700",children:r.jsx(on,{className:"w-3 h-3"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-slate-900",children:pt||""}),ne.patient_uhid&&r.jsx("div",{className:"text-[11px] text-slate-500",children:ne.patient_uhid})]})]})}),r.jsx("td",{className:"px-3 py-2.5 align-middle",children:r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(Ge,{variant:"outline",className:"border-slate-200 text-[11px] px-1.5 py-0.5",children:Ne}),hs&&r.jsxs("span",{className:"text-[11px] text-slate-600 flex items-center gap-1",children:[r.jsx(_s,{className:"w-3 h-3"}),hs]})]}),ne.context_label&&r.jsx("span",{className:"text-[11px] text-slate-500",children:ne.context_label})]})}),r.jsx("td",{className:"px-3 py-2.5 align-middle text-xs text-slate-700",children:Cs}),r.jsx("td",{className:"px-3 py-2.5 align-middle text-xs text-slate-700",children:r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(Xn,{className:"w-3 h-3 text-slate-400"}),r.jsx("span",{children:jt})]})}),r.jsx("td",{className:"px-3 py-2.5 align-middle",children:r.jsx(q8e,{status:me})}),r.jsx("td",{className:"px-3 py-2.5 align-middle text-right",children:r.jsxs(Re,{variant:"outline",size:"sm",className:"h-7 px-2 text-xs rounded-full border-slate-200",onClick:()=>wt(ne),children:[r.jsx(dr,{className:"w-3 h-3 mr-1"}),"View"]})})]},ne.id)})]})]})})})})]})}),r.jsx(fs,{value:"new",children:r.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.5fr)_minmax(0,2fr)]",children:[r.jsxs(We,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(st,{className:"pb-3",children:r.jsxs(lt,{className:"flex items-center gap-2 text-sm font-semibold",children:[r.jsx(Vr,{className:"w-4 h-4 text-slate-500"}),"Prescription Details"]})}),r.jsxs(qe,{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{className:"text-xs text-slate-600",children:"Prescription Type"}),r.jsx("div",{className:"flex flex-wrap gap-1.5",children:qj.map(ne=>r.jsxs("button",{type:"button",onClick:()=>j(me=>({...me,type:ne.value})),className:`px-2.5 py-1 rounded-full text-xs border flex items-center gap-1.5 ${w.type===ne.value?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-200"}`,children:[r.jsx(Vr,{className:"w-3 h-3"}),ne.label]},ne.value))})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{className:"text-xs text-slate-600",children:"Priority"}),r.jsxs(Ms,{value:w.priority,onValueChange:ne=>j(me=>({...me,priority:ne})),children:[r.jsx(Es,{className:"w-full bg-white border-slate-200 rounded-full h-9 text-xs",children:r.jsx(Ds,{placeholder:"Select priority"})}),r.jsx(Ts,{children:H8e.map(ne=>r.jsx(Mt,{value:ne.value,children:ne.label},ne.value))})]})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{className:"text-xs text-slate-600",children:"Date & Time"}),r.jsx(Ee,{type:"datetime-local",value:w.datetime,onChange:ne=>j(me=>({...me,datetime:ne.target.value})),className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]}),r.jsxs("div",{className:"space-y-1.5 relative",children:[r.jsxs(et,{className:"text-xs text-slate-600 flex items-center gap-1.5",children:[r.jsx(on,{className:"w-3 h-3"}),"Patient (UHID / name / phone)"]}),r.jsxs("div",{className:"relative",children:[r.jsx(is,{className:"w-3.5 h-3.5 text-slate-400 absolute left-2.5 top-2.5"}),r.jsx(Ee,{value:R,onChange:ne=>{I(ne.target.value),V(!0)},placeholder:w.type==="COUNTER"?"Optional for counter sale":"Search patient...",className:"pl-7 h-9 text-xs bg-white border-slate-200 rounded-full"})]}),r.jsx(Uc,{children:F&&(O.length>0||B)&&r.jsxs(Nt.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},className:"absolute z-20 mt-1 w-full bg-white border border-slate-200 rounded-xl shadow-lg max-h-52 overflow-auto text-xs",children:[B&&r.jsx("div",{className:"px-3 py-2 text-slate-500",children:"Searching..."}),!B&&!O.length&&r.jsx("div",{className:"px-3 py-2 text-slate-500",children:"No patients found"}),!B&&O.map(ne=>r.jsxs("button",{type:"button",onClick:()=>oe(ne),className:"w-full text-left px-3 py-1.5 hover:bg-slate-50 flex flex-col gap-0.5",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"font-medium text-slate-900",children:`${ne.first_name||""} ${ne.last_name||""}`.trim()||ne.name||`Patient #${ne.id}`}),ne.uhid&&r.jsxs("span",{className:"text-[10px] text-slate-500",children:["UHID: ",ne.uhid]})]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:[ne.age?`${ne.age}y  `:"",ne.gender?`${ne.gender}  `:"",ne.phone||""]})]},ne.id))]})})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[w.type==="OPD"&&r.jsx(r.Fragment,{children:r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{className:"text-xs text-slate-600",children:"OPD Visit No (optional)"}),r.jsx(Ee,{value:w.visitNo,onChange:ne=>j(me=>({...me,visitNo:ne.target.value})),placeholder:"e.g., OPD-2025-0001",className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]})}),w.type==="IPD"&&r.jsx(r.Fragment,{children:r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{className:"text-xs text-slate-600",children:"Admission No"}),r.jsx(Ee,{value:w.admissionNo,onChange:ne=>j(me=>({...me,admissionNo:ne.target.value})),placeholder:"IPD admission number",className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]})}),w.type==="OT"&&r.jsx(r.Fragment,{children:r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{className:"text-xs text-slate-600",children:"OT Case No"}),r.jsx(Ee,{value:w.otCaseNo,onChange:ne=>j(me=>({...me,otCaseNo:ne.target.value})),placeholder:"OT / procedure case ID",className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]})}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs(et,{className:"text-xs text-slate-600 flex items-center gap-1",children:[r.jsx(_s,{className:"w-3 h-3"}),"Consultant / Prescriber"]}),r.jsxs(Ms,{value:w.doctorId||"",onValueChange:ne=>j(me=>({...me,doctorId:ne})),children:[r.jsx(Es,{className:"w-full bg-white border-slate-200 rounded-full h-9 text-xs",children:r.jsx(Ds,{placeholder:"Select doctor"})}),r.jsxs(Ts,{children:[W&&r.jsx(Mt,{value:"__loading",disabled:!0,children:"Loading..."}),!W&&(!U||!U.length)&&r.jsx(Mt,{value:"__none",disabled:!0,children:"No doctors configured"}),!W&&(U==null?void 0:U.map(ne=>r.jsx(Mt,{value:String(ne.id),children:ne.name||ne.full_name||ne.email},ne.id)))]})]})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{className:"text-xs text-slate-600",children:"Clinical notes / instructions to pharmacist (optional)"}),r.jsx(gf,{value:w.notes,onChange:ne=>j(me=>({...me,notes:ne.target.value})),rows:3,className:"text-xs bg-white border-slate-200 resize-none rounded-xl",placeholder:"Eg: Allergic to penicillin, avoid NSAIDs, taper dose after 5 days, etc."})]})]})]}),r.jsxs(We,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsxs(st,{className:"pb-3 flex flex-row items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(dr,{className:"w-4 h-4 text-slate-500"}),r.jsx(lt,{className:"text-sm font-semibold",children:"Medicines & Instructions"})]}),r.jsx("div",{className:"text-[11px] text-slate-500",children:_.length?`${_.length} lines`:"No lines added yet"})]}),r.jsxs(qe,{className:"space-y-3",children:[r.jsx("div",{className:"border border-dashed border-slate-200 rounded-xl p-3 bg-slate-50/60",children:r.jsxs("div",{className:"grid md:grid-cols-[minmax(0,2.3fr)_minmax(0,1.1fr)] gap-3",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"space-y-1 relative",children:[r.jsxs(et,{className:"text-[11px] text-slate-600 flex items-center gap-1.5",children:["Medicine",r.jsx("span",{className:"text-[10px] text-slate-400",children:"(linked to Inventory)"})]}),r.jsxs("div",{className:"relative",children:[r.jsx(is,{className:"w-3.5 h-3.5 text-slate-400 absolute left-2 top-2.5"}),r.jsx(Ee,{value:G,onChange:ne=>{se(ne.target.value),ye(!0)},placeholder:"Search drug name, brand, generic...",className:"pl-7 h-9 text-xs bg-white border-slate-200 rounded-full"})]}),r.jsx(Uc,{children:ue&&(ge.length>0||ee)&&r.jsxs(Nt.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},className:"absolute z-20 mt-1 w-full bg-white border border-slate-200 rounded-xl shadow-lg max-h-52 overflow-auto text-xs",children:[ee&&r.jsx("div",{className:"px-3 py-2 text-slate-500",children:"Searching medicines..."}),!ee&&!ge.length&&r.jsx("div",{className:"px-3 py-2 text-slate-500",children:"No items found"}),!ee&&ge.map(ne=>r.jsxs("button",{type:"button",onClick:()=>_e(ne),className:"w-full text-left px-3 py-1.5 hover:bg-slate-50 flex flex-col gap-0.5",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"font-medium text-slate-900",children:ne.name||ne.item_name}),ne.code&&r.jsx("span",{className:"text-[10px] text-slate-500",children:ne.code})]}),r.jsx("div",{className:"text-[11px] text-slate-500",children:ne.strength||ne.form||""})]},ne.id))]})})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx(et,{className:"text-[11px] text-slate-600",children:"Dose"}),r.jsx(Ee,{value:k.dose,onChange:ne=>A(me=>({...me,dose:ne.target.value})),placeholder:"e.g. 500 mg",className:"h-8 text-[11px] bg-white border-slate-200 rounded-full"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx(et,{className:"text-[11px] text-slate-600",children:"Frequency"}),r.jsx(Ee,{value:k.frequency,onChange:ne=>A(me=>({...me,frequency:ne.target.value})),placeholder:"e.g. 1-0-1",className:"h-8 text-[11px] bg-white border-slate-200 rounded-full"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx(et,{className:"text-[11px] text-slate-600",children:"Days"}),r.jsx(Ee,{value:k.duration_days,onChange:ne=>A(me=>({...me,duration_days:ne.target.value,total_qty:me.total_qty||fe({...me,duration_days:ne.target.value})})),placeholder:"e.g. 5",className:"h-8 text-[11px] bg-white border-slate-200 rounded-full"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx(et,{className:"text-[11px] text-slate-600",children:"Route"}),r.jsx(Ee,{value:k.route,onChange:ne=>A(me=>({...me,route:ne.target.value})),placeholder:"PO / IV / IM / etc",className:"h-8 text-[11px] bg-white border-slate-200 rounded-full"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx(et,{className:"text-[11px] text-slate-600",children:"Total Qty"}),r.jsx(Ee,{value:k.total_qty,onChange:ne=>A(me=>({...me,total_qty:ne.target.value})),placeholder:fe(k)?`Suggested: ${fe(k)}`:"eg. 10",className:"h-8 text-[11px] bg-white border-slate-200 rounded-full"})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx(et,{className:"text-[11px] text-slate-600",children:"Instructions to patient"}),r.jsx(Ee,{value:k.instructions,onChange:ne=>A(me=>({...me,instructions:ne.target.value})),placeholder:"After food, morning & night, etc.",className:"h-8 text-[11px] bg-white border-slate-200 rounded-full"})]})]}),r.jsxs("div",{className:"flex flex-col justify-between gap-2",children:[r.jsx("div",{className:"text-[11px] text-slate-500",children:r.jsx("p",{children:"Add medicine to this prescription. Quantity can be auto-estimated from frequency & days."})}),r.jsx("div",{className:"flex justify-end",children:r.jsxs(Re,{type:"button",size:"sm",className:"h-9 px-3 rounded-full",onClick:le,children:[r.jsx(us,{className:"w-3.5 h-3.5 mr-1"}),"Add line"]})})]})]})}),r.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:r.jsx(xa,{className:"max-h-[280px]",children:r.jsxs("table",{className:"w-full text-[11px]",children:[r.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:r.jsxs("tr",{className:"text-[11px] text-slate-500",children:[r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"#"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Medicine"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Dose / Freq / Days"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Route"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Qty"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Actions"})]})}),r.jsxs("tbody",{children:[!_.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-3 py-4 text-center text-[11px] text-slate-500",children:"No lines added. Use the panel above to add medicines to this prescription."})}),_.map((ne,me)=>{var Ne,Be;return r.jsxs("tr",{className:"border-t border-slate-100",children:[r.jsx("td",{className:"px-3 py-2 align-top text-slate-500",children:me+1}),r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:((Ne=ne.item)==null?void 0:Ne.name)||ne.item_name||"Unnamed medicine"}),ne.strength&&r.jsx("span",{className:"text-[10px] text-slate-500",children:ne.strength})]})}),r.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsxs("span",{children:[ne.dose||""," "," ",ne.frequency||""," "," ",ne.duration_days?`${ne.duration_days} days`:""]}),ne.instructions&&r.jsx("span",{className:"text-[10px] text-slate-500",children:ne.instructions})]})}),r.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:ne.route||""}),r.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:ne.total_qty||fe(ne)||""}),r.jsx("td",{className:"px-3 py-2 align-top text-right",children:r.jsx(Re,{variant:"ghost",size:"sm",className:"h-7 px-2 text-[11px] text-slate-500 hover:text-red-600",onClick:()=>Ve(me),children:"Remove"})})]},`${ne.item_id||((Be=ne.item)==null?void 0:Be.id)||me}-${me}`)})]})]})})}),r.jsxs("div",{className:"flex justify-between items-center pt-1",children:[r.jsxs(Re,{type:"button",variant:"ghost",size:"sm",className:"h-8 px-2 text-xs text-slate-500",onClick:()=>{ce(),s("list")},children:[r.jsx(Tb,{className:"w-3 h-3 mr-1"}),"Back to queue"]}),r.jsx(Re,{type:"button",size:"sm",className:"h-9 px-4 rounded-full",onClick:Ke,disabled:T,children:T?"Saving...":r.jsxs(r.Fragment,{children:[r.jsx(dr,{className:"w-3.5 h-3.5 mr-1"}),"Save & Send to Pharmacy"]})})]})]})]})]})}),r.jsx(fs,{value:"detail",children:x?r.jsxs(We,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsxs(st,{className:"pb-3 flex flex-row items-center justify-between gap-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs(lt,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx(dr,{className:"w-4 h-4 text-slate-500"}),"Prescription #",x.rx_number||x.id]}),r.jsxs("div",{className:"flex flex-wrap gap-2 text-[11px] text-slate-500",children:[r.jsxs("span",{children:["Type:"," ",r.jsx(Ge,{variant:"outline",className:"px-1.5 py-0.5",children:x.type||x.rx_type||"OPD"})]}),x.priority&&r.jsxs("span",{children:["Priority: ",x.priority]}),x.doctor_name&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(_s,{className:"w-3 h-3"}),x.doctor_name]})]})]}),r.jsxs("div",{className:"text-right text-[11px] text-slate-500",children:[r.jsxs("div",{children:["UHID:"," ",x.patient_uhid||((rt=x.patient)==null?void 0:rt.uhid)||""]}),r.jsxs("div",{children:["Patient:"," ",x.patient_name||`${((bt=x.patient)==null?void 0:bt.first_name)||""} ${((be=x.patient)==null?void 0:be.last_name)||""}`.trim()||""]})]})]}),r.jsx(qe,{className:"space-y-3",children:r.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:r.jsx(xa,{className:"max-h-[380px]",children:r.jsxs("table",{className:"w-full text-[11px]",children:[r.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:r.jsxs("tr",{className:"text-[11px] text-slate-500",children:[r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"#"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Medicine"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Dose / Freq / Days"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Route"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Qty"})]})}),r.jsxs("tbody",{children:[!mt.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-3 py-4 text-center text-[11px] text-slate-500",children:"No lines found for this prescription."})}),mt.map((ne,me)=>r.jsxs("tr",{className:"border-t border-slate-100",children:[r.jsx("td",{className:"px-3 py-2 align-top text-slate-500",children:me+1}),r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:ne.item_name||ne.medicine_name||"Unnamed medicine"}),ne.strength&&r.jsx("span",{className:"text-[10px] text-slate-500",children:ne.strength})]})}),r.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsxs("span",{children:[ne.dose||""," "," ",ne.frequency||""," "," ",ne.duration_days?`${ne.duration_days} days`:""]}),ne.instructions&&r.jsx("span",{className:"text-[10px] text-slate-500",children:ne.instructions})]})}),r.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:ne.route||""}),r.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:ne.total_qty||ne.qty||ne.quantity||fe(ne)||""})]},ne.id||me))]})]})})})})]}):r.jsx(We,{className:"border-slate-200 rounded-2xl shadow-sm",children:r.jsx(qe,{className:"py-8 text-center text-sm text-slate-500",children:"Select a prescription from the queue to view details."})})})]})]})}function q8e({status:t}){const s=(t||"").toUpperCase();let n=s,a="bg-slate-50 text-slate-700 border border-slate-200";return s==="PENDING"||s==="NEW"?(n="Pending",a="bg-amber-50 text-amber-700 border border-amber-200"):s==="PARTIAL"?(n="Partial",a="bg-blue-50 text-blue-700 border border-blue-200"):s==="DISPENSED"||s==="COMPLETED"?(n="Dispensed",a="bg-emerald-50 text-emerald-700 border border-emerald-200"):s==="CANCELLED"&&(n="Cancelled",a="bg-rose-50 text-rose-700 border border-rose-200"),r.jsx("span",{className:`inline-flex items-center px-2 py-0.5 text-[11px] rounded-full ${a}`,children:n})}function Kj(t={}){return J.get("/pharmacy/billing",{params:t})}function Yj(t){return J.get(`/pharmacy/billing/${t}`)}function G8e(t,s){return J.post(`/pharmacy/billing/${t}/status`,s)}function K8e(t={}){return J.get("/pharmacy/billing/returns/list",{params:t})}function Y8e(t){return J.post("/pharmacy/billing/returns",t)}function X8e(t){return J.post("/pharmacy/billing/ipd/consolidated",t)}async function Xj(t){try{const s=await J.get(`/pharmacy/billing/${t}/pdf`,{responseType:"blob"}),n=new Blob([s.data],{type:"application/pdf"}),a=window.URL.createObjectURL(n);window.open(a,"_blank","noopener,noreferrer")}catch(s){console.error("Failed to open pharmacy bill PDF",s)}}const Q8e=[{value:"ALL",label:"All types"},{value:"OPD",label:"OPD"},{value:"IPD",label:"IPD"},{value:"OT",label:"OT"},{value:"COUNTER",label:"Counter"}],Z8e=[{value:"ALL",label:"All"},{value:"UNPAID",label:"Unpaid"},{value:"PARTIAL",label:"Partial"},{value:"PAID",label:"Paid"},{value:"CANCELLED",label:"Cancelled"}],J8e=[{value:"CASH",label:"Cash"},{value:"CARD",label:"Card"},{value:"UPI",label:"UPI"},{value:"NET_BANKING",label:"Net Banking"},{value:"OTHER",label:"Other"}];function Nr(t){const s=Number(t??0);return Number.isFinite(s)?`${s.toFixed(2)}`:"0.00"}function xg(t={}){const s=(t.type||t.bill_type||"").toUpperCase();if(s==="OPD"||s==="IPD"||s==="OT"||s==="COUNTER")return s;const n=(t.context_type||"").toUpperCase();return n==="OPD"?"OPD":n==="IPD"?"IPD":n==="PHARM_COUNTER"||n==="COUNTER"?"COUNTER":"OPD"}function Qj(t){const s=(t||"").toUpperCase();return s?s==="PARTIALLY_PAID"?"PARTIAL":s==="DRAFT"?"UNPAID":s:"UNPAID"}function eLe(){var hs,ae,Te,de,Pe,Ue,Le,Dt,Rt,Zt,vs,bn,Li,zt,Gt,ii,Ot;const[t,s]=y.useState("bills"),[n,a]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState("ALL"),[d,u]=y.useState("ALL"),[f,m]=y.useState(""),[x,b]=y.useState(""),[w,j]=y.useState(""),[_,C]=y.useState(null),[k,A]=y.useState(!1),[T,P]=y.useState(null),[R,I]=y.useState("CASH"),[O,M]=y.useState(""),[B,L]=y.useState(!1),[F,V]=y.useState([]),[U,z]=y.useState(!1),[W,q]=y.useState(""),[G,se]=y.useState(null),[ge,ke]=y.useState([]),[ee,pe]=y.useState(""),[ue,ye]=y.useState(!1),[X,oe]=y.useState(""),[_e,ce]=y.useState(""),[he,fe]=y.useState(!1),[le,Ve]=y.useState([]),[Ke,wt]=y.useState(null);y.useEffect(()=>{mt()},[d]),y.useEffect(()=>{t==="returns"&&bt(),t==="ipd"&&be()},[t]);async function mt(){try{l(!0);const we={limit:100};d!=="ALL"&&(we.status=d),f.trim()&&(we.q=f.trim()),x&&(we.date_from=x),w&&(we.date_to=w);const it=await Kj(we);a((it==null?void 0:it.data)||[])}catch{}finally{l(!1)}}async function rt(we){try{const it=await Yj(we.id);C((it==null?void 0:it.data)||we)}catch{}}async function bt(){try{z(!0);const we=await K8e({limit:50});V((we==null?void 0:we.data)||[])}catch{}finally{z(!1)}}async function be(){try{const we=await Kj({limit:100}),ct=((we==null?void 0:we.data)||[]).filter(Kt=>xg(Kt)==="IPD");Ve(ct)}catch{}}const ne=y.useMemo(()=>n!=null&&n.length?o==="ALL"?n:n.filter(we=>xg(we)===o):[],[n,o]);function me(we){const it=Number(we.total_amount??we.gross_total??we.net_amount??0),ct=Number(we.paid_amount??0),Kt=Number(we.balance_amount??it-ct)||0;P(we),M(Kt>0?String(Kt.toFixed(2)):String(it.toFixed(2))),I("CASH"),A(!0)}async function Ne(){if(!T)return;const we=Number(O);if(!we||we<=0){ie.error("Enter a valid payment amount");return}const it=Number(T.total_amount??T.gross_total??T.net_amount??0),Kt=Number(T.paid_amount??0)+we,$t=Math.max(it-Kt,0);let Ut="PARTIAL";$t<=.01?Ut="PAID":Kt<=.01&&(Ut="UNPAID");try{if(L(!0),await G8e(T.id,{payment_status:Ut,paid_amount:we,note:null}),ie.success("Payment recorded successfully"),A(!1),P(null),M(""),await mt(),_&&_.id===T.id){const Qs=await Yj(_.id);C((Qs==null?void 0:Qs.data)||_)}}catch{}finally{L(!1)}}async function Be(){if(!W.trim()){ie.error("Enter bill no / patient / UHID to search");return}try{const we=await Kj({q:W.trim(),limit:1}),it=(we==null?void 0:we.data)||[];if(!it.length){ie.error("No matching pharmacy bill found");return}const ct=it[0],Kt=await Yj(ct.id),$t=(Kt==null?void 0:Kt.data)||ct,Qs=($t.items||$t.lines||[]).map(ws=>({...ws,return_qty:""}));se($t),ke(Qs)}catch{}}function jt(we,it){ke(ct=>ct.map((Kt,$t)=>$t===we?{...Kt,return_qty:it}:Kt))}async function yt(){if(!G){ie.error("Select a source bill first");return}const we=ge.filter(ct=>Number(ct.return_qty||0)>0);if(!we.length){ie.error("Enter return quantity for at least one item");return}const it={source_invoice_id:G.id,reason:ee||null,lines:we.map(ct=>({bill_line_id:ct.id,qty_to_return:Number(ct.return_qty||0)}))};try{ye(!0),await Y8e(it),ie.success("Return note created successfully"),pe(""),se(null),ke([]),q(""),bt()}catch{}finally{ye(!1)}}async function pt(){if(!X&&!_e){ie.error("Enter Patient ID or Admission ID");return}const we={};X&&(we.patient_id=Number(X)),_e&&(we.admission_id=Number(_e));try{fe(!0);const it=await X8e(we),ct=(it==null?void 0:it.data)||it||null;if(!ct){ie.error("No consolidated data returned");return}wt(ct),ie.success("IPD consolidated pharmacy summary generated")}catch{}finally{fe(!1)}}const Cs=y.useMemo(()=>_?_.items||_.lines||[]:[],[_]);return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"p-4 md:p-6 space-y-4",children:[r.jsx("div",{className:"flex items-center justify-between gap-3",children:r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-slate-900",children:"Pharmacy Billing Console"}),r.jsx("p",{className:"text-sm text-slate-500",children:"Manage pharmacy invoices, payments, returns & IPD consolidated bills."})]})}),r.jsxs(Hl,{value:t,onValueChange:s,children:[r.jsxs(ll,{className:"mb-4",children:[r.jsx(xs,{value:"bills",children:"Bills"}),r.jsx(xs,{value:"returns",children:"Returns"}),r.jsx(xs,{value:"ipd",children:"IPD Consolidated"})]}),r.jsx(fs,{value:"bills",className:"space-y-3",children:r.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.7fr)_minmax(0,1.3fr)]",children:[r.jsxs(We,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(st,{className:"pb-3",children:r.jsxs("div",{className:"flex flex-col gap-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs(lt,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx(mN,{className:"w-4 h-4 text-slate-500"}),"Pharmacy Bills"]}),r.jsx(Re,{variant:"outline",size:"icon",className:"h-8 w-8 rounded-full border-slate-200",onClick:mt,children:r.jsx(Ei,{className:"w-4 h-4"})})]}),r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"relative flex-1 min-w-[180px]",children:[r.jsx(is,{className:"w-4 h-4 text-slate-400 absolute left-2.5 top-2.5"}),r.jsx(Ee,{value:f,onChange:we=>m(we.target.value),onKeyDown:we=>{we.key==="Enter"&&mt()},placeholder:"Search bill no / UHID / patient / phone",className:"pl-8 h-9 text-xs bg-white border-slate-200 rounded-full"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Ee,{type:"date",value:x,onChange:we=>b(we.target.value),className:"h-9 text-[11px] bg-white border-slate-200 rounded-full w-[130px]"}),r.jsx(Ee,{type:"date",value:w,onChange:we=>j(we.target.value),className:"h-9 text-[11px] bg-white border-slate-200 rounded-full w-[130px]"}),r.jsx(Re,{variant:"outline",size:"sm",className:"h-8 px-3 rounded-full text-[11px]",onClick:mt,children:"Apply"})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs(Ms,{value:o,onValueChange:c,children:[r.jsx(Es,{className:"w-[140px] bg-white border-slate-200 rounded-full h-8 text-[11px]",children:r.jsx(Ds,{placeholder:"Bill type"})}),r.jsx(Ts,{children:Q8e.map(we=>r.jsx(Mt,{value:we.value,children:we.label},we.value))})]}),r.jsxs(Ms,{value:d,onValueChange:u,children:[r.jsx(Es,{className:"w-[130px] bg-white border-slate-200 rounded-full h-8 text-[11px]",children:r.jsx(Ds,{placeholder:"Status"})}),r.jsx(Ts,{children:Z8e.map(we=>r.jsx(Mt,{value:we.value,children:we.label},we.value))})]})]})]})]})}),r.jsx(qe,{className:"pt-0",children:r.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:r.jsx(xa,{className:"max-h-[480px]",children:r.jsxs("table",{className:"w-full text-xs",children:[r.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:r.jsxs("tr",{className:"text-[11px] text-slate-500",children:[r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Bill"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Patient"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Type"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Amount"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Paid / Balance"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Date"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Actions"})]})}),r.jsxs("tbody",{children:[i&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"px-3 py-6 text-center text-[11px] text-slate-500",children:"Loading bills..."})}),!i&&!ne.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"px-3 py-6 text-center text-[11px] text-slate-500",children:"No pharmacy bills found for selected filters."})}),!i&&ne.map(we=>{var ar,at,Bi;const it=Number(we.total_amount??we.gross_total??we.net_amount??0),ct=Number(we.paid_amount??0),Kt=Number(we.balance_amount??it-ct)||0,$t=Qj(we.status),Ut=we.bill_date||we.created_at||we.invoice_date||null,Qs=Ut?String(Ut).slice(0,16).replace("T"," "):"",ws=xg(we),Bn=we.patient_name||`${((ar=we.patient)==null?void 0:ar.first_name)||""} ${((at=we.patient)==null?void 0:at.last_name)||""}`.trim()||"",dn=we.patient_uhid||((Bi=we.patient)==null?void 0:Bi.uhid),Fn=$t!=="PAID"&&$t!=="CANCELLED"&&it>0;return r.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/70 cursor-pointer",onClick:()=>rt(we),children:[r.jsx("td",{className:"px-3 py-2 align-middle",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:we.bill_number||we.invoice_number||`PB-${we.id}`}),we.rx_number&&r.jsxs("span",{className:"text-[10px] text-slate-500",children:["Rx: ",we.rx_number]})]})}),r.jsx("td",{className:"px-3 py-2 align-middle",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-7 h-7 rounded-full bg-slate-100 flex items-center justify-center text-[11px] text-slate-700",children:r.jsx(on,{className:"w-3 h-3"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] text-slate-900",children:Bn}),dn&&r.jsxs("div",{className:"text-[10px] text-slate-500",children:["UHID: ",dn]})]})]})}),r.jsx("td",{className:"px-3 py-2 align-middle",children:r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx(Ge,{variant:"outline",className:"border-slate-200 text-[10px] px-1.5 py-0.5 w-max",children:ws}),r.jsx(Zj,{status:$t})]})}),r.jsx("td",{className:"px-3 py-2 align-middle text-right",children:r.jsx("div",{className:"text-[11px] text-slate-900",children:Nr(it)})}),r.jsx("td",{className:"px-3 py-2 align-middle text-right",children:r.jsxs("div",{className:"flex flex-col items-end gap-0.5",children:[r.jsxs("span",{className:"text-[11px] text-emerald-700",children:["Paid: ",Nr(ct)]}),r.jsxs("span",{className:"text-[11px] text-rose-700",children:["Bal: ",Nr(Kt)]})]})}),r.jsx("td",{className:"px-3 py-2 align-middle text-[11px] text-slate-700",children:r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(Xn,{className:"w-3 h-3 text-slate-400"}),r.jsx("span",{children:Qs})]})}),r.jsx("td",{className:"px-3 py-2 align-middle text-right",onClick:ml=>ml.stopPropagation(),children:r.jsxs("div",{className:"flex justify-end gap-1.5",children:[r.jsx(Re,{variant:"outline",size:"icon",className:"h-7 w-7 rounded-full border-slate-200",onClick:()=>{const ml=we.id||we.invoice_id;ml&&Xj(ml)},children:r.jsx(Ll,{className:"w-3 h-3"})}),Fn&&r.jsxs(Re,{size:"sm",className:"h-7 px-3 rounded-full text-[11px]",onClick:()=>me(we),children:[r.jsx(Pl,{className:"w-3 h-3 mr-1"}),"Collect"]})]})})]},we.id)})]})]})})})})]}),r.jsxs(We,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(st,{className:"pb-3",children:r.jsxs(lt,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx(mN,{className:"w-4 h-4 text-slate-500"}),"Bill Details"]})}),r.jsx(qe,{className:"space-y-3 text-xs",children:_?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-start justify-between gap-3",children:[r.jsxs("div",{className:"space-y-0.5",children:[r.jsx("div",{className:"text-[11px] font-semibold text-slate-900",children:_.patient_name||`${((hs=_.patient)==null?void 0:hs.first_name)||""} ${((ae=_.patient)==null?void 0:ae.last_name)||""}`.trim()||""}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID:"," ",_.patient_uhid||((Te=_.patient)==null?void 0:Te.uhid)||""]}),r.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[r.jsx(Ge,{variant:"outline",className:"border-slate-200 text-[10px] px-1.5 py-0.5",children:xg(_)}),_.location&&r.jsxs("span",{className:"text-[10px] text-slate-500 flex items-center gap-1",children:[r.jsx(hN,{className:"w-3 h-3"}),_.location]})]})]}),r.jsxs("div",{className:"text-right text-[11px] text-slate-500",children:[r.jsxs("div",{children:["Bill:"," ",_.bill_number||_.invoice_number||`PB-${_.id}`]}),r.jsxs("div",{children:["Date:"," ",((Pe=(de=_.bill_date||_.created_at||"")==null?void 0:de.toString())==null?void 0:Pe.slice(0,10))||""]}),r.jsx("div",{className:"mt-1",children:r.jsx(Zj,{status:Qj(_.status)})})]})]}),r.jsxs("div",{className:"border border-slate-100 rounded-xl px-3 py-2.5 flex flex-col gap-1.5 bg-slate-50/60",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-[11px] text-slate-600",children:"Total"}),r.jsx("span",{className:"text-[12px] font-semibold text-slate-900",children:Nr(_.total_amount??_.gross_total??_.net_amount)})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-[11px] text-slate-600",children:"Paid"}),r.jsx("span",{className:"text-[11px] text-emerald-700",children:Nr(_.paid_amount)})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-[11px] text-slate-600",children:"Balance"}),r.jsx("span",{className:"text-[11px] text-rose-700",children:Nr(_.balance_amount??Number(_.total_amount??_.gross_total??_.net_amount??0)-Number(_.paid_amount??0))})]})]}),r.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:r.jsx(xa,{className:"max-h-[260px]",children:r.jsxs("table",{className:"w-full text-[11px]",children:[r.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:r.jsxs("tr",{className:"text-[11px] text-slate-500",children:[r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"#"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Medicine"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Qty"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Rate"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Amount"})]})}),r.jsxs("tbody",{children:[!Cs.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-3 py-4 text-center text-[11px] text-slate-500",children:"No items found for this bill."})}),Cs.map((we,it)=>r.jsxs("tr",{className:"border-t border-slate-100",children:[r.jsx("td",{className:"px-3 py-2 align-top text-slate-500",children:it+1}),r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:we.item_name||we.medicine_name||""}),we.batch_no&&r.jsxs("span",{className:"text-[10px] text-slate-500",children:["Batch: ",we.batch_no]})]})}),r.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:we.qty||we.quantity||""}),r.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:Nr(we.rate||we.unit_price)}),r.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:Nr(we.amount||we.line_total)})]},we.id||it))]})]})})}),r.jsxs("div",{className:"flex items-center justify-between pt-1",children:[r.jsxs(Re,{variant:"outline",size:"sm",className:"h-8 px-3 rounded-full text-[11px]",onClick:()=>{const we=_.id||_.invoice_id;we&&Xj(we)},children:[r.jsx(Ll,{className:"w-3 h-3 mr-1"}),"Download PDF"]}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsxs(Re,{variant:"outline",size:"sm",className:"h-8 px-3 rounded-full text-[11px]",onClick:()=>me(_),children:[r.jsx(Pl,{className:"w-3 h-3 mr-1"}),"Add Payment"]})})]})]}):r.jsx("div",{className:"py-10 text-center text-[11px] text-slate-500",children:"Select a pharmacy bill from the list to view details."})})]})]})}),r.jsx(fs,{value:"returns",className:"space-y-3",children:r.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.4fr)_minmax(0,1.6fr)]",children:[r.jsxs(We,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(st,{className:"pb-3",children:r.jsxs(lt,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx(Si,{className:"w-4 h-4 text-slate-500"}),"New Pharmacy Return"]})}),r.jsxs(qe,{className:"space-y-3 text-xs",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{className:"text-[11px] text-slate-600",children:"Source bill (search by bill no / UHID / patient)"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx(is,{className:"w-4 h-4 text-slate-400 absolute left-2.5 top-2.5"}),r.jsx(Ee,{value:W,onChange:we=>q(we.target.value),placeholder:"Eg. PB-0001, UHID, patient name",className:"pl-8 h-9 text-xs bg-white border-slate-200 rounded-full"})]}),r.jsx(Re,{size:"sm",className:"h-9 px-3 rounded-full text-[11px]",onClick:Be,children:"Search"})]})]}),G&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"border border-slate-100 rounded-xl p-3 bg-slate-50/60 space-y-1.5",children:r.jsxs("div",{className:"flex items-start justify-between gap-2",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] font-semibold text-slate-900",children:G.patient_name||`${((Ue=G.patient)==null?void 0:Ue.first_name)||""} ${((Le=G.patient)==null?void 0:Le.last_name)||""}`.trim()||""}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID:"," ",G.patient_uhid||((Dt=G.patient)==null?void 0:Dt.uhid)||""]})]}),r.jsxs("div",{className:"text-right text-[11px] text-slate-500",children:["Bill:"," ",G.bill_number||G.invoice_number||`PB-${G.id}`,r.jsx("br",{}),"Date:"," ",((Zt=(Rt=G.bill_date||G.created_at||"")==null?void 0:Rt.toString())==null?void 0:Zt.slice(0,10))||""]})]})}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{className:"text-[11px] text-slate-600",children:"Items & return quantity"}),r.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:r.jsx(xa,{className:"max-h-[250px]",children:r.jsxs("table",{className:"w-full text-[11px]",children:[r.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:r.jsxs("tr",{className:"text-[11px] text-slate-500",children:[r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"#"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Medicine"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Sold Qty"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Return Qty"})]})}),r.jsxs("tbody",{children:[!ge.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:4,className:"px-3 py-4 text-center text-[11px] text-slate-500",children:"No items found for this bill."})}),ge.map((we,it)=>r.jsxs("tr",{className:"border-t border-slate-100",children:[r.jsx("td",{className:"px-3 py-2 align-top text-slate-500",children:it+1}),r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:we.item_name||we.medicine_name||""}),we.batch_no&&r.jsxs("span",{className:"text-[10px] text-slate-500",children:["Batch: ",we.batch_no]})]})}),r.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:we.qty||we.quantity||""}),r.jsx("td",{className:"px-3 py-2 align-top text-right",children:r.jsx(Ee,{type:"number",min:"0",value:we.return_qty??"",onChange:ct=>jt(it,ct.target.value),className:"h-8 w-20 ml-auto text-[11px] text-right bg-white border-slate-200 rounded-full"})})]},we.id||it))]})]})})})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{className:"text-[11px] text-slate-600",children:"Reason for return"}),r.jsx(gf,{value:ee,onChange:we=>pe(we.target.value),rows:3,className:"text-[11px] bg-white border-slate-200 rounded-xl resize-none",placeholder:"Eg. Patient mismatch, wrong strength, expiry, doctor changed prescription, etc."})]}),r.jsx("div",{className:"flex justify-end pt-1",children:r.jsx(Re,{size:"sm",className:"h-9 px-4 rounded-full text-[11px]",onClick:yt,disabled:ue,children:ue?"Creating return...":r.jsxs(r.Fragment,{children:[r.jsx(Si,{className:"w-3.5 h-3.5 mr-1"}),"Create Return Note"]})})})]})]})]}),r.jsxs(We,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(st,{className:"pb-3",children:r.jsxs(lt,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx(Si,{className:"w-4 h-4 text-slate-500"}),"Recent Pharmacy Returns"]})}),r.jsx(qe,{className:"pt-0",children:r.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:r.jsx(xa,{className:"max-h-[420px]",children:r.jsxs("table",{className:"w-full text-[11px]",children:[r.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:r.jsxs("tr",{className:"text-[11px] text-slate-500",children:[r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Return"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Patient"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Source bill"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Refund"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Date"})]})}),r.jsxs("tbody",{children:[U&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-3 py-6 text-center text-[11px] text-slate-500",children:"Loading returns..."})}),!U&&!F.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-3 py-6 text-center text-[11px] text-slate-500",children:"No pharmacy returns found."})}),!U&&F.map(we=>{var Ut,Qs;const it=Math.abs(Number(we.net_amount??we.total_amount??0)),ct=(we.created_at||"").toString().slice(0,16).replace("T"," "),Kt=we.patient_name||`${((Ut=we.patient)==null?void 0:Ut.first_name)||""} ${((Qs=we.patient)==null?void 0:Qs.last_name)||""}`.trim()||"",$t=we.source_bill_number||we.source_invoice_number||"";return r.jsxs("tr",{className:"border-t border-slate-100",children:[r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:we.return_number||we.bill_number||`PR-${we.id}`}),we.reason&&r.jsx("span",{className:"text-[10px] text-slate-500",children:we.reason})]})}),r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsx("div",{className:"text-[11px] text-slate-900",children:Kt})}),r.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:$t}),r.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:Nr(it)}),r.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:ct||""})]},we.id)})]})]})})})})]})]})}),r.jsx(fs,{value:"ipd",className:"space-y-3",children:r.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.3fr)_minmax(0,1.7fr)]",children:[r.jsxs(We,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(st,{className:"pb-3",children:r.jsxs(lt,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx(hN,{className:"w-4 h-4 text-slate-500"}),"Generate IPD Pharmacy Summary"]})}),r.jsxs(qe,{className:"space-y-3 text-xs",children:[r.jsx("p",{className:"text-[11px] text-slate-500",children:"Generate consolidated pharmacy summary for all UNPAID / PARTIALLY_PAID IPD pharmacy invoices for a given admission. Use this for final IPD discharge billing."}),r.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{className:"text-[11px] text-slate-600",children:"Patient ID (internal PK)"}),r.jsx(Ee,{value:X,onChange:we=>oe(we.target.value),placeholder:"Eg. 123 (required)",className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{className:"text-[11px] text-slate-600",children:"IPD Admission ID (optional filter)"}),r.jsx(Ee,{value:_e,onChange:we=>ce(we.target.value),placeholder:"Eg. 45  IPD admission table ID",className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]})]}),r.jsx("div",{className:"flex justify-end pt-2",children:r.jsx(Re,{size:"sm",className:"h-9 px-4 rounded-full text-[11px]",onClick:pt,disabled:he,children:he?"Generating...":r.jsxs(r.Fragment,{children:[r.jsx(mN,{className:"w-3.5 h-3.5 mr-1"}),"Generate Summary"]})})}),Ke&&r.jsxs("div",{className:"mt-3 border border-slate-100 rounded-xl p-3 bg-slate-50/60 space-y-2",children:[r.jsx("div",{className:"flex items-start justify-between gap-3",children:r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] font-semibold text-slate-900",children:Ke.patient_name||""}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID:"," ",Ke.patient_uhid||""]}),Ke.admission_id&&r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Admission ID: ",Ke.admission_id]})]})}),r.jsxs("div",{className:"border border-slate-100 rounded-lg px-3 py-2 bg-white space-y-1.5",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-[11px] text-slate-600",children:"Gross Total"}),r.jsx("span",{className:"text-[11px] font-semibold text-slate-900",children:Nr(Ke.total_amount)})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-[11px] text-slate-600",children:"Tax"}),r.jsx("span",{className:"text-[11px] text-slate-900",children:Nr(Ke.total_tax)})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-[11px] text-slate-600",children:"Net Amount"}),r.jsx("span",{className:"text-[11px] font-semibold text-slate-900",children:Nr(Ke.net_amount)})]})]}),r.jsx("div",{className:"border border-slate-100 rounded-lg overflow-hidden bg-white",children:r.jsx(xa,{className:"max-h-[220px]",children:r.jsxs("table",{className:"w-full text-[11px]",children:[r.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:r.jsxs("tr",{className:"text-[11px] text-slate-500",children:[r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Medicine"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Qty"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Amount"})]})}),r.jsxs("tbody",{children:[!((vs=Ke.items)!=null&&vs.length)&&r.jsx("tr",{children:r.jsx("td",{colSpan:3,className:"px-3 py-4 text-center text-[11px] text-slate-500",children:"No pharmacy items found in this summary."})}),(bn=Ke.items)==null?void 0:bn.map((we,it)=>r.jsxs("tr",{className:"border-t border-slate-100",children:[r.jsx("td",{className:"px-3 py-2 align-top text-slate-900",children:we.medicine_name||""}),r.jsx("td",{className:"px-3 py-2 align-top text-right text-slate-700",children:we.qty}),r.jsx("td",{className:"px-3 py-2 align-top text-right text-slate-700",children:Nr(we.amount)})]},it))]})]})})}),r.jsxs("p",{className:"text-[10px] text-slate-500",children:["Use this summary while generating the final IPD discharge invoice in the main Billing module. Each contributing pharmacy bill ID is available in ",r.jsx("code",{children:"sale_ids"})," if needed."]})]})]})]}),r.jsxs(We,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(st,{className:"pb-3",children:r.jsxs(lt,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx(hN,{className:"w-4 h-4 text-slate-500"}),"Recent IPD Pharmacy Bills"]})}),r.jsx(qe,{className:"pt-0",children:r.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:r.jsx(xa,{className:"max-h-[420px]",children:r.jsxs("table",{className:"w-full text-[11px]",children:[r.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:r.jsxs("tr",{className:"text-[11px] text-slate-500",children:[r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Bill"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Patient"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Status"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Amount"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Date"})]})}),r.jsxs("tbody",{children:[!le.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-3 py-6 text-center text-[11px] text-slate-500",children:"No IPD pharmacy bills found."})}),le.map(we=>{var Ut,Qs;const it=Number(we.total_amount??we.gross_total??we.net_amount??0),ct=Qj(we.status),Kt=(we.bill_date||we.created_at||"").toString().slice(0,16).replace("T"," "),$t=we.patient_name||`${((Ut=we.patient)==null?void 0:Ut.first_name)||""} ${((Qs=we.patient)==null?void 0:Qs.last_name)||""}`.trim()||"";return r.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60 cursor-pointer",onClick:()=>{const ws=we.id||we.invoice_id;ws&&Xj(ws)},children:[r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsx("div",{className:"flex flex-col",children:r.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:we.bill_number||we.invoice_number||`PB-${we.id}`})})}),r.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:$t}),r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsx(Zj,{status:ct})}),r.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:Nr(it)}),r.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:Kt||""})]},we.id)})]})]})})})})]})]})})]})]}),r.jsx(ah,{open:k,onOpenChange:A,children:r.jsxs(Ed,{className:"max-w-md rounded-2xl",children:[r.jsxs(Td,{children:[r.jsxs(Id,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx(Pl,{className:"w-4 h-4 text-slate-600"}),"Collect Pharmacy Payment"]}),r.jsx(Md,{className:"text-xs text-slate-500",children:"Record payment for this pharmacy invoice. You can add multiple payments later (partial payments supported)."})]}),T&&r.jsxs("div",{className:"space-y-3 text-xs",children:[r.jsxs("div",{className:"border border-slate-100 rounded-xl p-3 bg-slate-50/60 space-y-1",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] font-semibold text-slate-900",children:T.patient_name||`${((Li=T.patient)==null?void 0:Li.first_name)||""} ${((zt=T.patient)==null?void 0:zt.last_name)||""}`.trim()||""}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID:"," ",T.patient_uhid||((Gt=T.patient)==null?void 0:Gt.uhid)||""]})]}),r.jsxs("div",{className:"text-right text-[11px] text-slate-500",children:["Bill:"," ",T.bill_number||T.invoice_number||`PB-${T.id}`,r.jsx("br",{}),"Date:"," ",((Ot=(ii=T.bill_date||T.created_at||"")==null?void 0:ii.toString())==null?void 0:Ot.slice(0,10))||""]})]}),r.jsxs("div",{className:"flex items-center justify-between mt-1 pt-1 border-t border-dashed border-slate-200",children:[r.jsx("div",{className:"text-[11px] text-slate-600",children:"Total / Paid / Balance"}),r.jsxs("div",{className:"text-right text-[11px]",children:[r.jsx("div",{className:"text-slate-900",children:Nr(T.total_amount??T.gross_total??T.net_amount)}),r.jsx("div",{className:"text-emerald-700",children:Nr(T.paid_amount)}),r.jsx("div",{className:"text-rose-700",children:Nr(T.balance_amount??Number(T.total_amount??T.gross_total??T.net_amount??0)-Number(T.paid_amount??0))})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{className:"text-[11px] text-slate-600",children:"Payment mode"}),r.jsxs(Ms,{value:R,onValueChange:I,children:[r.jsx(Es,{className:"w-full h-9 bg-white border-slate-200 rounded-full text-[11px]",children:r.jsx(Ds,{placeholder:"Select mode"})}),r.jsx(Ts,{children:J8e.map(we=>r.jsx(Mt,{value:we.value,children:we.label},we.value))})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(et,{className:"text-[11px] text-slate-600",children:"Amount"}),r.jsx(Ee,{type:"number",min:"0",value:O,onChange:we=>M(we.target.value),className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]})]})]}),r.jsxs(Pd,{className:"mt-3",children:[r.jsx(Re,{variant:"outline",size:"sm",className:"h-8 px-3 rounded-full text-[11px]",onClick:()=>A(!1),children:"Cancel"}),r.jsx(Re,{size:"sm",className:"h-8 px-4 rounded-full text-[11px]",onClick:Ne,disabled:B,children:B?"Saving...":r.jsxs(r.Fragment,{children:[r.jsx(Ur,{className:"w-3 h-3 mr-1"}),"Save Payment"]})})]})]})})]})}function Zj({status:t}){const s=(t||"").toUpperCase();let n=s||"",a="bg-slate-50 text-slate-700 border border-slate-200";return s==="UNPAID"||s==="PENDING"||s==="DRAFT"?(n="Unpaid",a="bg-amber-50 text-amber-700 border border-amber-200"):s==="PARTIAL"||s==="PARTIALLY_PAID"?(n="Partially paid",a="bg-blue-50 text-blue-700 border border-blue-200"):s==="PAID"?(n="Paid",a="bg-emerald-50 text-emerald-700 border border-emerald-200"):s==="CANCELLED"?(n="Cancelled",a="bg-rose-50 text-rose-700 border border-rose-200"):s==="FINALIZED"&&(n="Finalized",a="bg-slate-50 text-slate-700 border border-slate-300"),r.jsx("span",{className:`inline-flex items-center px-2 py-0.5 text-[10px] rounded-full ${a}`,children:n})}function tLe(t){if(!t)return"";const s=new Date(t);return`${s.toLocaleDateString()} ${s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`}function sLe(){const[t,s]=y.useState(""),[n,a]=y.useState(""),[i,l]=y.useState(""),[o,c]=y.useState([]),[d,u]=y.useState(!1),f=async()=>{try{u(!0);const x={context_type:"pharmacy"};t&&(x.q=t),n&&(x.date_from=n),i&&(x.date_to=i);const b=await She(x);c(b.data||[])}catch{}finally{u(!1)}};y.useEffect(()=>{f()},[]);const m=o.reduce((x,b)=>x+(b.total_amount||0),0);return r.jsxs("div",{className:"p-3 sm:p-4 lg:p-6 space-y-3 sm:space-y-4",children:[r.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[r.jsx("div",{className:"inline-flex h-9 w-9 items-center justify-center rounded-2xl bg-slate-900 text-white",children:r.jsx(Oy,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-base sm:text-lg font-semibold tracking-tight text-slate-900",children:"Pharmacy Counter Sales (OTC)"}),r.jsx("p",{className:"text-xs sm:text-sm text-slate-500",children:"View Pharmacy counter / OTC sales. (Future: add direct sale screen here.)"})]})]}),r.jsxs(We,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(st,{className:"pb-2",children:r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx(is,{className:"absolute left-2 top-2.5 h-4 w-4 text-slate-400"}),r.jsx(Ee,{placeholder:"UHID / Name / Phone",className:"pl-7 h-9 w-40 sm:w-52",value:t,onChange:x=>s(x.target.value)})]}),r.jsx(Ee,{type:"date",className:"h-9 w-32",value:n,onChange:x=>a(x.target.value)}),r.jsx(Ee,{type:"date",className:"h-9 w-32",value:i,onChange:x=>l(x.target.value)}),r.jsxs(Re,{size:"sm",variant:"outline",className:"h-9 text-xs",onClick:f,disabled:d,children:[d?r.jsx(ss,{className:"mr-1 h-3.5 w-3.5 animate-spin"}):null,"Apply"]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-1 text-right",children:[r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Sales in view"," ",r.jsx(Ge,{variant:"secondary",className:"ml-1 h-5 px-2 text-[10px]",children:o.length})]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Net amount"," ",r.jsxs("span",{className:"font-semibold text-slate-900",children:["",m.toFixed(2)]})]})]})]})}),r.jsxs(qe,{className:"pt-0",children:[r.jsx("div",{className:"border-t border-slate-100 mt-2 mb-2"}),r.jsx("div",{className:"overflow-x-auto -mx-2 sm:mx-0",children:r.jsxs("table",{className:"min-w-full text-xs sm:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b border-slate-100 text-[11px] uppercase tracking-wide text-slate-500",children:[r.jsx("th",{className:"py-2 pl-3 pr-2 text-left font-medium",children:"Sale"}),r.jsx("th",{className:"py-2 px-2 text-left font-medium",children:"Patient"}),r.jsx("th",{className:"py-2 px-2 text-right font-medium",children:"Amount"})]})}),r.jsxs("tbody",{children:[o.length===0&&!d&&r.jsx("tr",{children:r.jsx("td",{colSpan:3,className:"py-10 text-center text-xs text-slate-500",children:"No counter sales found."})}),d&&r.jsx("tr",{children:r.jsx("td",{colSpan:3,className:"py-8 text-center",children:r.jsx(ss,{className:"mx-auto h-4 w-4 animate-spin text-slate-400"})})}),!d&&o.map(x=>r.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[r.jsx("td",{className:"py-2.5 pl-3 pr-2 align-top",children:r.jsxs("div",{className:"flex flex-col gap-0.5",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(Oy,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsxs("span",{className:"font-medium text-[11px] text-slate-800",children:["Sale #",x.id]})]}),r.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-500",children:[r.jsx(Xn,{className:"h-3 w-3"}),r.jsx("span",{children:tLe(x.created_at)})]})]})}),r.jsxs("td",{className:"py-2.5 px-2 align-top",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(on,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:x.patient_name||""})]}),r.jsxs("div",{className:"mt-0.5 text-[10px] text-slate-500 flex flex-wrap gap-1",children:[x.patient_uhid&&r.jsx(Ge,{variant:"outline",className:"h-4 px-1.5 text-[9px]",children:x.patient_uhid}),x.payment_mode&&r.jsx("span",{className:"capitalize",children:x.payment_mode})]})]}),r.jsx("td",{className:"py-2.5 px-2 align-top text-right",children:r.jsxs("div",{className:"text-[11px] font-semibold text-slate-900",children:["",(x.total_amount||0).toFixed(2)]})})]},x.id))]})]})})]})]})]})}function nLe(t){if(!t)return"";const s=new Date(t);return`${s.toLocaleDateString()} ${s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`}function rLe(){const[t,s]=y.useState(""),[n,a]=y.useState(""),[i,l]=y.useState(""),[o,c]=y.useState([]),[d,u]=y.useState(!1),f=async()=>{try{u(!0);const x={};t&&(x.q=t),n&&(x.date_from=n),i&&(x.date_to=i);const b=await Che(x);c(b.data||[])}catch{}finally{u(!1)}};y.useEffect(()=>{f()},[]);const m=o.reduce((x,b)=>x+(b.total_amount||0),0);return r.jsxs("div",{className:"p-3 sm:p-4 lg:p-6 space-y-3 sm:space-y-4",children:[r.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[r.jsx("div",{className:"inline-flex h-9 w-9 items-center justify-center rounded-2xl bg-slate-900 text-white",children:r.jsx(Si,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-base sm:text-lg font-semibold tracking-tight text-slate-900",children:"Pharmacy Returns"}),r.jsx("p",{className:"text-xs sm:text-sm text-slate-500",children:"Shows Pharmacy bills treated as returns (negative amounts). Later you can connect this to a dedicated return workflow."})]})]}),r.jsxs(We,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(st,{className:"pb-2",children:r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx(is,{className:"absolute left-2 top-2.5 h-4 w-4 text-slate-400"}),r.jsx(Ee,{placeholder:"UHID / Name / Phone",className:"pl-7 h-9 w-40 sm:w-52",value:t,onChange:x=>s(x.target.value)})]}),r.jsx(Ee,{type:"date",className:"h-9 w-32",value:n,onChange:x=>a(x.target.value)}),r.jsx(Ee,{type:"date",className:"h-9 w-32",value:i,onChange:x=>l(x.target.value)}),r.jsxs(Re,{size:"sm",variant:"outline",className:"h-9 text-xs",onClick:f,disabled:d,children:[d?r.jsx(ss,{className:"mr-1 h-3.5 w-3.5 animate-spin"}):null,"Apply"]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-1 text-right",children:[r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Returns in view"," ",r.jsx(Ge,{variant:"secondary",className:"ml-1 h-5 px-2 text-[10px]",children:o.length})]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Total refund"," ",r.jsxs("span",{className:"font-semibold text-slate-900",children:["",m.toFixed(2)]})]})]})]})}),r.jsxs(qe,{className:"pt-0",children:[r.jsx("div",{className:"border-t border-slate-100 mt-2 mb-2"}),r.jsx("div",{className:"overflow-x-auto -mx-2 sm:mx-0",children:r.jsxs("table",{className:"min-w-full text-xs sm:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b border-slate-100 text-[11px] uppercase tracking-wide text-slate-500",children:[r.jsx("th",{className:"py-2 pl-3 pr-2 text-left font-medium",children:"Return"}),r.jsx("th",{className:"py-2 px-2 text-left font-medium",children:"Patient"}),r.jsx("th",{className:"py-2 px-2 text-right font-medium",children:"Amount"})]})}),r.jsxs("tbody",{children:[o.length===0&&!d&&r.jsx("tr",{children:r.jsx("td",{colSpan:3,className:"py-10 text-center text-xs text-slate-500",children:"No Pharmacy returns detected (no negative Pharmacy bills)."})}),d&&r.jsx("tr",{children:r.jsx("td",{colSpan:3,className:"py-8 text-center",children:r.jsx(ss,{className:"mx-auto h-4 w-4 animate-spin text-slate-400"})})}),!d&&o.map(x=>r.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[r.jsx("td",{className:"py-2.5 pl-3 pr-2 align-top",children:r.jsxs("div",{className:"flex flex-col gap-0.5",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(Si,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsxs("span",{className:"font-medium text-[11px] text-slate-800",children:["Return #",x.id]})]}),r.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-500",children:[r.jsx(Xn,{className:"h-3 w-3"}),r.jsx("span",{children:nLe(x.created_at)})]})]})}),r.jsxs("td",{className:"py-2.5 px-2 align-top",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(on,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:x.patient_name||""})]}),r.jsx("div",{className:"mt-0.5 text-[10px] text-slate-500 flex flex-wrap gap-1",children:x.patient_uhid&&r.jsx(Ge,{variant:"outline",className:"h-4 px-1.5 text-[9px]",children:x.patient_uhid})})]}),r.jsx("td",{className:"py-2.5 px-2 align-top text-right",children:r.jsxs("div",{className:"text-[11px] font-semibold text-red-600",children:["",(x.total_amount||0).toFixed(2)]})})]},x.id))]})]})})]})]})]})}const aLe=[{value:"ALL",label:"All types"},{value:"OPD",label:"OPD"},{value:"IPD",label:"IPD"},{value:"OT",label:"OT"},{value:"COUNTER",label:"Counter"}],wd="ALL_LOC";function iLe(t){const s=Number(t.requested_qty??t.total_qty??t.qty??t.quantity??0),n=Number(t.dispensed_qty??0),a=Math.max(s-n,0);return{requested:s,remaining:a}}function Jj(t){const s=Number(t.duration_days||0),n=(t.frequency_code||t.frequency||"").trim();if(!s||!n)return"";const i=n.split("-").map(l=>Number(l||0)).reduce((l,o)=>l+(Number.isFinite(o)?o:0),0);return i?i*s:""}function lLe(){const[t,s]=y.useState("queue"),[n,a]=y.useState("ALL"),[i,l]=y.useState("PENDING"),[o,c]=y.useState(""),[d,u]=y.useState(!1),[f,m]=y.useState([]),[x,b]=y.useState(null),[w,j]=y.useState([]),[_,C]=y.useState(!1),[k,A]=y.useState([]),[T,P]=y.useState(wd);y.useEffect(()=>{async function F(){try{const V=await zb(),U=(V==null?void 0:V.data)||[];A(U),T||P(wd)}catch{}}F()},[]),y.useEffect(()=>{R()},[n,i,T]);async function R(){try{u(!0);const F={status:i==="ALL"?void 0:i,type:n==="ALL"?void 0:n,limit:100};o.trim()&&(F.q=o.trim()),T&&T!==wd&&(F.location_id=Number(T));const V=await V8e(F);m((V==null?void 0:V.data)||[])}catch{}finally{u(!1)}}async function I(F){try{const V=await bK(F.id),U=(V==null?void 0:V.data)||F;b(U);const z=(U.lines||U.items||[]).map(W=>{const{requested:q,remaining:G}=iLe(W);return{...W,requested_qty:q,remaining_qty:G||Jj(W)||q,dispense_qty:G||Jj(W)||q||""}});j(z),s("dispense")}catch{}}function O(F,V){j(U=>U.map((z,W)=>W===F?{...z,dispense_qty:V}:z))}async function M(){var z,W;if(!x)return;const F=w.filter(q=>Number(q.dispense_qty||0)>0);if(!F.length){ie.error("Enter quantity to dispense for at least one line");return}let V=x.location_id||null;if(T&&T!==wd&&(V=Number(T)),!V){ie.error("Select a pharmacy location before dispensing.");return}const U={lines:F.map(q=>({line_id:q.id,dispense_qty:Number(q.dispense_qty||0)})),location_id:V,create_sale:!0,context_type:(x.type||x.rx_type||"OPD").toUpperCase()};try{C(!0);const q=await U8e(x.id,U),G=(q==null?void 0:q.data)||{};G.sale_id||((z=G.sale)==null?void 0:z.id)||((W=G.pharmacy_sale)==null?void 0:W.id)||G.saleId||null?ie.success("Medicines dispensed and pharmacy bill created"):ie.success("Dispense recorded (no bill returned from server)"),await R(),b(null),j([]),s("queue")}catch(q){console.error("Dispense error",q)}finally{C(!1)}}const B=y.useMemo(()=>w||[],[w]),L=y.useMemo(()=>{if(!(k!=null&&k.length))return"No locations configured";if(!T||T===wd)return"All / Not linked";const F=Number(T),V=k.find(U=>U.id===F);return V?V.name||V.code||`Location #${V.id}`:`Location #${F}`},[k,T]);return r.jsxs("div",{className:"p-4 md:p-6 space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-slate-900",children:"Pharmacy Dispense"}),r.jsx("p",{className:"text-sm text-slate-500",children:"Convert prescriptions to pharmacy sales with FEFO-linked inventory and billing."})]}),r.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[r.jsx(p7,{className:"w-4 h-4 text-slate-500"}),r.jsx("span",{className:"text-slate-500",children:"Location"}),r.jsxs(Ms,{value:T,onValueChange:F=>P(F||wd),children:[r.jsx(Es,{className:"w-[200px] bg-white border-slate-200 rounded-full h-8 text-[11px]",children:r.jsx(Ds,{placeholder:"Select location"})}),r.jsxs(Ts,{children:[r.jsx(Mt,{value:wd,children:"All / Not linked"}),k.map(F=>r.jsx(Mt,{value:String(F.id),children:F.name||F.code||`Location #${F.id}`},F.id))]})]})]})]}),r.jsxs(Hl,{value:t,onValueChange:s,children:[r.jsxs(ll,{className:"mb-4",children:[r.jsx(xs,{value:"queue",children:"Dispense Queue"}),r.jsx(xs,{value:"dispense",disabled:!x,children:"Selected Rx"})]}),r.jsx(fs,{value:"queue",className:"space-y-3",children:r.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.3fr)_minmax(0,1.7fr)]",children:[r.jsxs(We,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(st,{className:"pb-3",children:r.jsxs("div",{className:"flex flex-col gap-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs(lt,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx(dr,{className:"w-4 h-4 text-slate-500"}),"Pending Prescriptions"]}),r.jsx(Re,{variant:"outline",size:"icon",className:"h-8 w-8 rounded-full border-slate-200",onClick:R,children:r.jsx(Ei,{className:"w-4 h-4"})})]}),r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsx("div",{className:"flex items-center gap-2",children:r.jsxs("div",{className:"relative flex-1",children:[r.jsx(is,{className:"w-4 h-4 text-slate-400 absolute left-2.5 top-2.5"}),r.jsx(Ee,{value:o,onChange:F=>c(F.target.value),onKeyDown:F=>{F.key==="Enter"&&R()},placeholder:"Search UHID / patient / Rx no...",className:"pl-8 h-9 text-xs bg-white border-slate-200 rounded-full"})]})}),r.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[r.jsxs(Ms,{value:n,onValueChange:a,children:[r.jsx(Es,{className:"w-[140px] bg-white border-slate-200 rounded-full h-8 text-[11px]",children:r.jsx(Ds,{placeholder:"Type"})}),r.jsx(Ts,{children:aLe.map(F=>r.jsx(Mt,{value:F.value,children:F.label},F.value))})]}),r.jsxs(Ms,{value:i,onValueChange:l,children:[r.jsx(Es,{className:"w-[130px] bg-white border-slate-200 rounded-full h-8 text-[11px]",children:r.jsx(Ds,{placeholder:"Status"})}),r.jsxs(Ts,{children:[r.jsx(Mt,{value:"PENDING",children:"Pending only"}),r.jsx(Mt,{value:"ALL",children:"All status"}),r.jsx(Mt,{value:"PARTIAL",children:"Partial"}),r.jsx(Mt,{value:"DISPENSED",children:"Dispensed"})]})]})]})]})]})}),r.jsx(qe,{className:"pt-0",children:r.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:r.jsx(xa,{className:"max-h-[460px]",children:r.jsxs("table",{className:"w-full text-xs",children:[r.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:r.jsxs("tr",{className:"text-[11px] text-slate-500",children:[r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Rx"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Patient"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Type / Doctor"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Items"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Time"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Action"})]})}),r.jsxs("tbody",{children:[d&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-3 py-5 text-center text-[11px] text-slate-500",children:"Loading queue..."})}),!d&&!f.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-3 py-5 text-center text-[11px] text-slate-500",children:"No prescriptions waiting for dispense."})}),!d&&f.map(F=>{var ke,ee,pe;const V=F.type||F.rx_type||"OPD",U=(F.status||"").toUpperCase()||"PENDING",z=F.created_at||F.rx_datetime||F.bill_date||null,W=z?String(z).slice(0,16).replace("T"," "):"",q=F.patient_name||F.patient_full_name||F.patient_display||F.patient&&`${F.patient.first_name||""} ${F.patient.last_name||""}`.trim()||F.patient||"",G=F.patient_uhid||F.uhid||((ke=F.patient)==null?void 0:ke.uhid)||"",se=F.doctor_name||F.doctor||F.doctor_display||"",ge=((ee=F.items)==null?void 0:ee.length)||((pe=F.lines)==null?void 0:pe.length)||F.item_count||"";return r.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60 cursor-pointer",onClick:()=>I(F),children:[r.jsx("td",{className:"px-3 py-2 align-middle",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:F.rx_number||F.prescription_number||`RX-${F.id}`}),G&&r.jsxs("span",{className:"text-[10px] text-slate-500",children:["UHID:"," ",G]})]})}),r.jsx("td",{className:"px-3 py-2 align-middle",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-7 h-7 rounded-full bg-slate-100 flex items-center justify-center text-[11px] text-slate-700",children:r.jsx(on,{className:"w-3 h-3"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] text-slate-900",children:q||""}),G&&r.jsx("div",{className:"text-[10px] text-slate-500",children:G})]})]})}),r.jsx("td",{className:"px-3 py-2 align-middle",children:r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx(Ge,{variant:"outline",className:"border-slate-200 text-[10px] px-1.5 py-0.5 w-max",children:V}),se&&r.jsxs("span",{className:"text-[10px] text-slate-500 flex items-center gap-1",children:[r.jsx(_s,{className:"w-3 h-3"}),se]})]})}),r.jsx("td",{className:"px-3 py-2 align-middle text-[11px] text-slate-700",children:ge}),r.jsx("td",{className:"px-3 py-2 align-middle text-[11px] text-slate-700",children:r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(Xn,{className:"w-3 h-3 text-slate-400"}),r.jsx("span",{children:W})]})}),r.jsx("td",{className:"px-3 py-2 align-middle text-right",children:r.jsx(oLe,{status:U})})]},F.id)})]})]})})})})]}),r.jsxs(We,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(st,{className:"pb-3",children:r.jsxs(lt,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx(Vr,{className:"w-4 h-4 text-slate-500"}),"Selected Prescription"]})}),r.jsx(qe,{className:"space-y-3",children:x?r.jsx("div",{className:"space-y-3 text-xs",children:(()=>{var U;const F=x.patient_name||x.patient_full_name||x.patient_display||x.patient&&`${x.patient.first_name||""} ${x.patient.last_name||""}`.trim()||"",V=x.patient_uhid||x.uhid||((U=x.patient)==null?void 0:U.uhid)||"";return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-slate-900",children:F}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID:"," ",V]})]}),r.jsxs("div",{className:"text-right text-[11px] text-slate-500",children:["Rx No:"," ",x.rx_number||x.prescription_number||`RX-${x.id}`,r.jsx("br",{}),"Type:"," ",x.type||x.rx_type||"OPD"]})]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Items:"," ",(x.lines||x.items||[]).length||""]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Queue filter:"," ",r.jsx("span",{className:"font-medium text-slate-700",children:L})]}),r.jsxs(Re,{size:"sm",variant:"outline",className:"h-8 px-3 rounded-full text-[11px]",onClick:()=>s("dispense"),children:[r.jsx(Ur,{className:"w-3 h-3 mr-1"}),"Open for dispensing"]})]})})()}):r.jsx("div",{className:"py-8 text-center text-xs text-slate-500",children:"Click a prescription from the queue to start dispensing."})})]})]})}),r.jsx(fs,{value:"dispense",children:x?r.jsxs(We,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsxs(st,{className:"pb-3 flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs(lt,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx(Ur,{className:"w-4 h-4 text-emerald-500"}),"Dispense Medicines"]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Rx:"," ",x.rx_number||x.prescription_number||`RX-${x.id}`," ",""," ",x.type||x.rx_type||"OPD"," ",""," ",x.patient_name||x.patient_full_name||x.patient_display||x.patient&&`${x.patient.first_name||""} ${x.patient.last_name||""}`.trim()||"",r.jsx("br",{}),"Queue filter:"," ",r.jsx("span",{className:"font-medium text-slate-700",children:L})]})]}),r.jsx(Re,{variant:"ghost",size:"sm",className:"h-8 px-3 text-[11px]",onClick:()=>s("queue"),children:"Back to queue"})]}),r.jsxs(qe,{className:"space-y-3",children:[r.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:r.jsx(xa,{className:"max-h-[420px]",children:r.jsxs("table",{className:"w-full text-[11px]",children:[r.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:r.jsxs("tr",{className:"text-[11px] text-slate-500",children:[r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"#"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Medicine"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Instructions"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Prescribed Qty"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Dispense Qty"})]})}),r.jsxs("tbody",{children:[!B.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-3 py-4 text-center text-[11px] text-slate-500",children:"No lines found in this prescription."})}),B.map((F,V)=>{const U=F.dose_text||F.dose||"",z=F.frequency_code||F.frequency||(Number.isFinite(F.times_per_day)?`${F.times_per_day} times/day`:""),W=F.duration_days?`${F.duration_days} days`:F.duration||"",q=[U,z,W].filter(Boolean).join("  ")||"",G=[F.route,F.timing,F.instructions].filter(Boolean).join("  "),se=F.requested_qty??F.total_qty??F.qty??F.quantity??Jj(F)??"";return r.jsxs("tr",{className:"border-t border-slate-100",children:[r.jsx("td",{className:"px-3 py-2 align-top text-slate-500",children:V+1}),r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:F.item_name||F.medicine_name||"Unnamed medicine"}),(F.item_strength||F.strength)&&r.jsx("span",{className:"text-[10px] text-slate-500",children:F.item_strength||F.strength})]})}),r.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{children:q}),G&&r.jsx("span",{className:"text-[10px] text-slate-500",children:G})]})}),r.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:se}),r.jsx("td",{className:"px-3 py-2 align-top text-right",children:r.jsx(Ee,{type:"number",min:"0",value:F.dispense_qty??"",onChange:ge=>O(V,ge.target.value),className:"h-8 w-20 ml-auto text-[11px] text-right bg-white border-slate-200 rounded-full"})})]},F.id||V)})]})]})})}),r.jsxs("div",{className:"flex items-center justify-between pt-1",children:[r.jsx("div",{className:"text-[11px] text-slate-500",children:"Only lines with a positive Dispense Qty will create sale items."}),r.jsx(Re,{size:"sm",className:"h-9 px-4 rounded-full",onClick:M,disabled:_,children:_?"Dispensing...":r.jsxs(r.Fragment,{children:[r.jsx(Ur,{className:"w-3.5 h-3.5 mr-1"}),"Confirm Dispense & Generate Bill"]})})]})]})]}):r.jsx(We,{className:"border-slate-200 rounded-2xl shadow-sm",children:r.jsx(qe,{className:"py-8 text-center text-sm text-slate-500",children:"Select a prescription from the queue to dispense."})})})]})]})}function oLe({status:t}){const s=(t||"").toUpperCase();let n=s,a="bg-slate-50 text-slate-700 border border-slate-200";return s==="PENDING"||s==="NEW"||s==="DRAFT"?(n=s==="DRAFT"?"Draft":"Pending",a="bg-amber-50 text-amber-700 border border-amber-200"):s==="PARTIAL"||s==="PARTIALLY_DISPENSED"?(n="Partial",a="bg-blue-50 text-blue-700 border border-blue-200"):s==="DISPENSED"||s==="COMPLETED"?(n="Dispensed",a="bg-emerald-50 text-emerald-700 border border-emerald-200"):s==="CANCELLED"&&(n="Cancelled",a="bg-rose-50 text-rose-700 border border-rose-200"),r.jsx("span",{className:`inline-flex items-center px-2 py-0.5 text-[10px] rounded-full ${a}`,children:n})}function e2(t){if(!t)return"";const s=new Date(t);return`${s.toLocaleDateString()} ${s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`}function cLe(t){switch(t){case"ISSUED":return{label:"Issued",className:"bg-amber-50 text-amber-700 border border-amber-100",icon:yn};case"PARTIALLY_DISPENSED":return{label:"Partial",className:"bg-blue-50 text-blue-700 border border-blue-100",icon:yn};case"DISPENSED":return{label:"Dispensed",className:"bg-emerald-50 text-emerald-700 border border-emerald-100",icon:Ur};case"CANCELLED":return{label:"Cancelled",className:"bg-red-50 text-red-700 border border-red-100",icon:w3};default:return{label:t||"Unknown",className:"bg-slate-50 text-slate-700 border border-slate-100",icon:yn}}}function dLe(){const[t,s]=y.useState("ALL"),[n,a]=y.useState("ACTIVE"),[i,l]=y.useState("all"),[o,c]=y.useState(""),[d,u]=y.useState(""),[f,m]=y.useState(""),[x,b]=y.useState([]),[w,j]=y.useState([]),[_,C]=y.useState(!1),[k,A]=y.useState(null),[T,P]=y.useState(null),[R,I]=y.useState(null);y.useEffect(()=>{zb().then(U=>{const z=U.data||[];b(z)}).catch(()=>{b([])})},[]);const O=async()=>{try{C(!0);const U={};t!=="ALL"&&(U.type=t),(n==="ISSUED"||n==="PARTIALLY_DISPENSED"||n==="DISPENSED"||n==="CANCELLED")&&(U.status=n),o.trim()&&(U.patient_id=o.trim()),d&&(U.from_date=d),f&&(U.to_date=f);const z=await Nhe(U);j(z.data||[])}catch{}finally{C(!1)}};y.useEffect(()=>{O()},[t,n]);const M=y.useMemo(()=>{let U=w||[];return n==="ACTIVE"&&(U=U.filter(z=>z.status==="ISSUED"||z.status==="PARTIALLY_DISPENSED")),i!=="all"&&(U=U.filter(z=>String(z.location_id)===String(i))),U},[w,n,i]);y.useEffect(()=>{if(!M.length){A(null);return}(!k||!M.some(U=>U.id===k))&&A(M[0].id)},[M,k]);const B=y.useMemo(()=>M.find(U=>U.id===k)||null,[M,k]),L=y.useMemo(()=>{const U=M.length,z=M.filter(q=>q.status==="ISSUED"||q.status==="PARTIALLY_DISPENSED").length,W=M.filter(q=>q.status==="DISPENSED").length;return{total:U,active:z,completed:W}},[M]),F=async U=>{if(!U)return;const W=(U.lines||[]).filter(q=>q.status==="WAITING"||q.status==="PARTIAL"||q.status==="PARTIALLY_DISPENSED").map(q=>{const G=Number(q.requested_qty||0),se=Number(q.dispensed_qty||0),ge=G-se;return{line_id:q.id,quantity:ge}}).filter(q=>q.quantity>0);if(!W.length){ie.info("No pending quantity to dispense for this prescription");return}if(window.confirm(`Dispense all remaining quantities (${W.length} line(s)) for Rx #${U.prescription_number||U.id}?`))try{P(U.id),await jhe(U.id,{lines:W,remark:"Quick dispense all remaining from Rx Explorer"}),ie.success("Prescription dispensed (remaining quantities)"),await O()}catch{}finally{P(null)}},V=async U=>{if(U&&window.confirm(`Generate Pharmacy bill from dispensed lines for Rx #${U.prescription_number||U.id}?`))try{I(U.id);const W=(await _he(U.id)).data;ie.success(`Pharmacy bill created: ${W.bill_number} (Net ${W.net_amount})`)}catch{}finally{I(null)}};return r.jsxs("div",{className:"p-3 sm:p-4 lg:p-6 space-y-3 sm:space-y-4",children:[r.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[r.jsx("div",{className:"inline-flex h-9 w-9 items-center justify-center rounded-2xl bg-slate-900 text-white",children:r.jsx(Vr,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-base sm:text-lg font-semibold tracking-tight text-slate-900",children:"Pharmacy Rx Explorer (Inventory)"}),r.jsx("p",{className:"text-xs sm:text-sm text-slate-500",children:"View, filter, and dispense inventory-integrated prescriptions across OPD/IPD/Counter. Uses FEFO batches and auto-billing."})]})]}),r.jsxs(We,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(st,{className:"pb-2",children:r.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4",children:[r.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx(is,{className:"absolute left-2 top-2.5 h-4 w-4 text-slate-400"}),r.jsx(Ee,{placeholder:"Patient ID (optional)",className:"pl-7 h-9 w-36 sm:w-40",value:o,onChange:U=>c(U.target.value)})]}),r.jsx(Ee,{type:"date",className:"h-9 w-32",value:d,onChange:U=>u(U.target.value)}),r.jsx(Ee,{type:"date",className:"h-9 w-32",value:f,onChange:U=>m(U.target.value)}),r.jsxs(Re,{size:"sm",variant:"outline",className:"h-9 text-xs",onClick:O,disabled:_,children:[_?r.jsx(ss,{className:"mr-1 h-3.5 w-3.5 animate-spin"}):r.jsx(hu,{className:"mr-1 h-3.5 w-3.5"}),"Apply"]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 justify-end text-[11px] text-slate-500",children:[r.jsxs("div",{children:["Total"," ",r.jsx(Ge,{variant:"secondary",className:"h-5 px-2 text-[10px]",children:L.total})]}),r.jsxs("div",{children:["Active"," ",r.jsx(Ge,{variant:"outline",className:"h-5 px-2 text-[10px]",children:L.active})]}),r.jsxs("div",{children:["Dispensed"," ",r.jsx(Ge,{variant:"outline",className:"h-5 px-2 text-[10px]",children:L.completed})]})]})]}),r.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(Hl,{value:t,onValueChange:s,className:"hidden sm:block",children:r.jsxs(ll,{className:"h-8",children:[r.jsx(xs,{value:"ALL",className:"text-[11px]",children:"All"}),r.jsx(xs,{value:"OPD",className:"text-[11px]",children:"OPD"}),r.jsx(xs,{value:"IPD",className:"text-[11px]",children:"IPD"}),r.jsx(xs,{value:"GENERAL",className:"text-[11px]",children:"General"})]})}),r.jsx("div",{className:"sm:hidden flex gap-1 text-[11px]",children:["ALL","OPD","IPD","GENERAL"].map(U=>r.jsx(Ge,{variant:t===U?"default":"outline",className:"cursor-pointer",onClick:()=>s(U),children:U},U))}),r.jsxs("div",{className:"flex flex-wrap items-center gap-1 text-[11px]",children:[r.jsx(Ge,{variant:n==="ACTIVE"?"default":"outline",className:"cursor-pointer",onClick:()=>a("ACTIVE"),children:"Active"}),r.jsx(Ge,{variant:n==="ALL"?"default":"outline",className:"cursor-pointer",onClick:()=>a("ALL"),children:"All"}),r.jsx(Ge,{variant:n==="ISSUED"?"default":"outline",className:"cursor-pointer",onClick:()=>a("ISSUED"),children:"Issued"}),r.jsx(Ge,{variant:n==="PARTIALLY_DISPENSED"?"default":"outline",className:"cursor-pointer",onClick:()=>a("PARTIALLY_DISPENSED"),children:"Partial"}),r.jsx(Ge,{variant:n==="DISPENSED"?"default":"outline",className:"cursor-pointer",onClick:()=>a("DISPENSED"),children:"Dispensed"}),r.jsx(Ge,{variant:n==="CANCELLED"?"default":"outline",className:"cursor-pointer",onClick:()=>a("CANCELLED"),children:"Cancelled"})]})]}),r.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[r.jsxs("span",{className:"text-[11px] text-slate-500 flex items-center gap-1",children:[r.jsx(p7,{className:"h-3 w-3"}),"Location"]}),r.jsxs("select",{className:"h-8 rounded-xl border border-slate-200 bg-white px-2 text-[11px] text-slate-700",value:i,onChange:U=>l(U.target.value),children:[r.jsx("option",{value:"all",children:"All locations"}),x.map(U=>r.jsx("option",{value:U.id,children:U.name},U.id))]})]})]})]})}),r.jsxs(qe,{className:"pt-0",children:[r.jsx("div",{className:"border-t border-slate-100 mt-2 mb-2"}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[minmax(0,1.3fr)_minmax(0,2fr)] gap-3 lg:gap-4",children:[r.jsxs("div",{className:"border border-slate-100 rounded-2xl bg-slate-50/60 overflow-hidden flex flex-col",children:[r.jsxs("div",{className:"px-3 py-2 border-b border-slate-100 flex items-center justify-between",children:[r.jsxs("span",{className:"text-[11px] font-semibold text-slate-700 flex items-center gap-1",children:[r.jsx(Vr,{className:"h-3.5 w-3.5 text-slate-500"}),"Prescriptions"]}),r.jsxs("span",{className:"text-[11px] text-slate-500",children:[M.length," in view"]})]}),_&&r.jsx("div",{className:"flex-1 flex items-center justify-center py-10",children:r.jsx(ss,{className:"h-5 w-5 animate-spin text-slate-400"})}),!_&&M.length===0&&r.jsx("div",{className:"flex-1 flex items-center justify-center py-10",children:r.jsx("p",{className:"text-xs text-slate-500",children:"No prescriptions found for this filter."})}),!_&&M.length>0&&r.jsx("div",{className:"flex-1 overflow-y-auto max-h-[520px]",children:M.map(U=>{var G;const z=cLe(U.status),W=U.id===k,q=U.status==="ISSUED"||U.status==="PARTIALLY_DISPENSED";return r.jsxs("button",{type:"button",onClick:()=>A(U.id),className:["w-full text-left px-3 py-2.5 border-b border-slate-100","flex flex-col gap-1.5 hover:bg-slate-100/70",W?"bg-slate-100/80":""].filter(Boolean).join(" "),children:[r.jsxs("div",{className:"flex items-start justify-between gap-2",children:[r.jsxs("div",{className:"space-y-0.5",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx("span",{className:"text-[11px] font-semibold text-slate-900",children:U.prescription_number||`Rx #${U.id}`}),r.jsx(Ge,{variant:"outline",className:"h-4 px-1.5 text-[9px]",children:U.type||""}),q&&r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 animate-pulse"})]}),r.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-500",children:[r.jsx(Xn,{className:"h-3 w-3"}),r.jsx("span",{children:e2(U.created_at)})]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-1",children:[r.jsxs("div",{className:["inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-[10px]",z.className].join(" "),children:[r.jsx(z.icon,{className:"h-3 w-3"}),r.jsx("span",{children:z.label})]}),r.jsxs("div",{className:"text-[10px] text-slate-500 flex items-center gap-1",children:[r.jsx(ra,{className:"h-3 w-3"}),r.jsx("span",{children:U.location_name||""})]})]})]}),r.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-700",children:[r.jsx(on,{className:"h-3 w-3 text-slate-400"}),r.jsx("span",{children:U.patient_name||""})]}),U.doctor_name&&r.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-500",children:[r.jsx(_s,{className:"h-3 w-3 text-slate-400"}),r.jsx("span",{children:U.doctor_name})]})]}),r.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2 text-[10px] text-slate-500",children:[r.jsxs("span",{children:[((G=U.lines)==null?void 0:G.length)||0," item(s)"]}),U.status==="DISPENSED"&&r.jsx("span",{children:" Fully dispensed"})]})]},U.id)})})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-white p-3 sm:p-4 flex flex-col min-h-[260px]",children:[!B&&r.jsx("div",{className:"flex-1 flex items-center justify-center",children:r.jsx("p",{className:"text-xs text-slate-500",children:"Select a prescription from the left to view details."})}),B&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-2 mb-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"text-sm font-semibold text-slate-900",children:["Rx ",B.prescription_number||`#${B.id}`]}),r.jsx(Ge,{variant:"outline",className:"h-5 px-2 text-[10px]",children:B.type||""})]}),r.jsxs("div",{className:"text-[11px] text-slate-600 flex flex-wrap items-center gap-1",children:[r.jsx(on,{className:"h-3 w-3 text-slate-400"}),r.jsx("span",{children:B.patient_name||""}),r.jsx("span",{className:"mx-1",children:""}),r.jsx(_s,{className:"h-3 w-3 text-slate-400"}),r.jsx("span",{children:B.doctor_name||""}),r.jsx("span",{className:"mx-1",children:""}),r.jsx(ra,{className:"h-3 w-3 text-slate-400"}),r.jsx("span",{children:B.location_name||""})]}),r.jsxs("div",{className:"text-[10px] text-slate-500 flex flex-wrap items-center gap-2",children:[r.jsxs("span",{children:["Created: ",e2(B.created_at)]}),r.jsx("span",{children:""}),r.jsxs("span",{children:["Updated: ",e2(B.updated_at)]})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-2",children:[r.jsxs(Re,{size:"sm",variant:"outline",className:"h-8 text-[11px]",disabled:T===B.id||B.status==="DISPENSED"||B.status==="CANCELLED",onClick:()=>F(B),children:[T===B.id?r.jsx(ss,{className:"mr-1 h-3.5 w-3.5 animate-spin"}):r.jsx(Ur,{className:"mr-1 h-3.5 w-3.5"}),"Quick dispense remaining"]}),r.jsxs(Re,{size:"sm",className:"h-8 text-[11px]",disabled:R===B.id,onClick:()=>V(B),children:[R===B.id?r.jsx(ss,{className:"mr-1 h-3.5 w-3.5 animate-spin"}):r.jsx(uLe,{className:"mr-1 h-3.5 w-3.5"}),"Generate bill"]})]})]}),r.jsx("div",{className:"flex-1 rounded-2xl border border-slate-100 bg-slate-50/60 p-2 sm:p-3 overflow-y-auto max-h-[360px]",children:r.jsxs("table",{className:"w-full text-[11px]",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b border-slate-200 text-[10px] uppercase tracking-wide text-slate-500",children:[r.jsx("th",{className:"py-1.5 pr-2 text-left font-medium",children:"Item"}),r.jsx("th",{className:"py-1.5 px-2 text-right font-medium",children:"Req"}),r.jsx("th",{className:"py-1.5 px-2 text-right font-medium",children:"Disp"}),r.jsx("th",{className:"py-1.5 px-2 text-right font-medium",children:"Rem"}),r.jsx("th",{className:"py-1.5 pl-2 text-left font-medium",children:"Status"})]})}),r.jsxs("tbody",{children:[(B.lines||[]).map(U=>{const z=Number(U.requested_qty||0),W=Number(U.dispensed_qty||0),q=z-W;return r.jsxs("tr",{className:"border-b border-slate-100",children:[r.jsxs("td",{className:"py-1.5 pr-2 align-top",children:[r.jsx("div",{className:"font-medium text-[11px] text-slate-900",children:U.item_name||""}),r.jsxs("div",{className:"text-[10px] text-slate-500",children:[U.item_strength&&r.jsxs("span",{children:[U.item_strength,"  "]}),U.frequency_code||""," ",U.duration_days?` ${U.duration_days} day(s)`:""]})]}),r.jsx("td",{className:"py-1.5 px-2 align-top text-right text-[10px] text-slate-700",children:z}),r.jsx("td",{className:"py-1.5 px-2 align-top text-right text-[10px] text-slate-700",children:W}),r.jsx("td",{className:"py-1.5 px-2 align-top text-right text-[10px] text-slate-700",children:q}),r.jsx("td",{className:"py-1.5 pl-2 align-top text-[10px]",children:r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-white px-2 py-0.5 border border-slate-200 text-slate-700",children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-slate-400"}),U.status]})})]},U.id)}),(!B.lines||B.lines.length===0)&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"py-4 text-center text-[11px] text-slate-500",children:"No items found in this prescription."})})]})]})}),B.notes&&r.jsxs("div",{className:"mt-2 text-[11px] text-slate-600",children:[r.jsx("span",{className:"font-semibold",children:"Notes:"})," ",B.notes]})]})]})]})]})]})]})}function uLe(t){return r.jsxs("svg",{viewBox:"0 0 24 24",...t,children:[r.jsx("path",{d:"M6 6h15l-1.5 9h-12z",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"}),r.jsx("circle",{cx:"9",cy:"19",r:"1",fill:"currentColor"}),r.jsx("circle",{cx:"17",cy:"19",r:"1",fill:"currentColor"})]})}const t2=()=>({_id:Math.random().toString(36).slice(2),item:null,requestedQty:"",doseText:"",frequency:"",timing:"",durationDays:"",instructions:"",searchQ:"",searchResults:[],searching:!1,showDropdown:!1});function s2(t){return t?t.name||t.item_name||t.brand_name||t.code||`#${t.id}`:""}function YR(t){if(!t)return"";const s=[];return t.code&&s.push(t.code),t.generic_name&&s.push(t.generic_name),t.form&&s.push(t.form),t.strength&&s.push(t.strength),t.pack_size&&s.push(`Pack: ${t.pack_size}`),t.manufacturer&&s.push(t.manufacturer),s.join("  ")}function xw({orderType:t,title:s,subtitle:n,variant:a="page",initialPatientId:i=null,initialPatient:l=null,lockPatient:o=!1,initialLocationId:c="",initialDoctorUserId:d="",initialVisitId:u="",initialIpdAdmissionId:f="",initialContextRef:m=""}){const x=y.useMemo(()=>{switch(t){case"OPD":return"OPD";case"IPD":return"IPD Ward";case"COUNTER":return"Counter / OTC";case"OT_CONSUMABLE":return"OT Consumables";default:return t||"Pharmacy"}},[t]),[b,w]=y.useState([]),[j,_]=y.useState(c||""),[C,k]=y.useState(i),[A,T]=y.useState(l),[P,R]=y.useState(d||""),[I,O]=y.useState(u||""),[M,B]=y.useState(f||""),[L,F]=y.useState(m||""),[V,U]=y.useState(""),[z,W]=y.useState([t2()]),[q,G]=y.useState(!1);y.useEffect(()=>{i&&!C&&k(i)},[i,C]),y.useEffect(()=>{l&&!A&&T(l)},[l,A]),y.useEffect(()=>{let he=!0;return(async()=>{try{const fe=await zb();if(!he)return;const le=fe.data||[];w(le),!j&&le.length===1&&_(String(le[0].id))}catch{if(!he)return;w([])}})(),()=>{he=!1}},[]);const se=(he,fe)=>{W(le=>le.map(Ve=>Ve._id===he?{...Ve,...fe}:Ve))},ge=()=>W(he=>[...he,t2()]),ke=he=>{W(fe=>fe.length===1?fe:fe.filter(le=>le._id!==he))},ee=async(he,fe)=>{var le;if(se(he,{searchQ:fe,item:null}),!fe||fe.length<2){se(he,{searchResults:[],showDropdown:!1});return}se(he,{searching:!0,showDropdown:!0});try{const Ve=await ik({q:fe,page_size:10}),Ke=((le=Ve.data)==null?void 0:le.items)||Ve.data||[];se(he,{searchResults:Ke})}catch{se(he,{searchResults:[]})}finally{se(he,{searching:!1})}},pe=(he,fe)=>{se(he,{item:fe,searchQ:"",showDropdown:!1,searchResults:[]})},ue=he=>{setTimeout(()=>{se(he,{showDropdown:!1})},150)},ye=y.useMemo(()=>{const he=Number(j),fe=b.find(le=>le.id===he);return(fe==null?void 0:fe.name)||""},[b,j]),X=y.useMemo(()=>z.filter(he=>he.item&&he.item.id&&Number(he.requestedQty||0)>0).map(he=>{const fe=Number(he.requestedQty||0),le=he.durationDays?Number(he.durationDays):null;return{item_id:he.item.id,requested_qty:fe,dose_text:he.doseText||null,frequency_code:he.frequency||null,timing:he.timing||null,duration_days:le,instructions:he.instructions||null}}),[z]),oe=X.length>0,_e=async()=>{if(!C){ie.error("Please select a patient");return}if(!j){ie.error("Please select Pharmacy location");return}if(!oe){ie.error("Add at least one item with quantity");return}const he=[];V.trim()&&he.push(V.trim()),t==="COUNTER"&&L.trim()&&he.push(`Counter ref: ${L.trim()}`),t==="OT_CONSUMABLE"&&L.trim()&&he.push(`OT case: ${L.trim()}`);const fe={type:t,patient_id:C,location_id:Number(j),lines:X};if(P.trim()){const le=Number(P.trim());Number.isNaN(le)||(fe.doctor_user_id=le)}if(he.length>0&&(fe.notes=he.join(" | ")),t==="OPD"&&I.trim()){const le=Number(I.trim());Number.isNaN(le)||(fe.visit_id=le)}if((t==="IPD"||t==="OT_CONSUMABLE")&&M.trim()){const le=Number(M.trim());Number.isNaN(le)||(fe.ipd_admission_id=le)}try{G(!0);const Ve=(await whe(fe)).data||{},Ke=Ve.prescription_number||Ve.id||"created";ie.success(`Pharmacy order created (Rx ${Ke})`),W([t2()]),U(""),F(m||""),u||O(""),f||B("")}catch{}finally{G(!1)}},ce=r.jsxs(We,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(st,{className:"pb-3",children:r.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Ge,{variant:"outline",className:"h-6 px-2 text-[10px] uppercase tracking-wide",children:x}),r.jsx("span",{className:"text-xs text-slate-500",children:"Creates a PharmacyPrescription visible in the Pharmacy Rx Explorer."})]}),r.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-slate-500",children:[r.jsx(ra,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsx("span",{children:"Location:"}),r.jsxs("select",{className:"h-7 rounded-xl border border-slate-200 bg-white px-2 text-[11px] text-slate-700",value:j,onChange:he=>_(he.target.value),children:[r.jsx("option",{value:"",children:"Select"}),b.map(he=>r.jsx("option",{value:he.id,children:he.name},he.id))]})]})]})}),r.jsxs(qe,{className:"space-y-4",children:[r.jsxs("div",{className:"grid gap-3 lg:grid-cols-[minmax(0,1.6fr)_minmax(0,1.4fr)]",children:[r.jsx("div",{children:r.jsx(We,{className:"border-slate-200 rounded-2xl bg-slate-50/70",children:r.jsxs(qe,{className:"p-3 sm:p-4 space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(on,{className:"h-4 w-4 text-slate-500"}),r.jsx("span",{className:"text-xs font-semibold text-slate-800",children:"Patient"})]}),!o&&r.jsx(Zb,{value:C,onChange:(he,fe)=>{k(he),T(fe)},label:"Select patient"}),o&&A&&r.jsxs("div",{className:"rounded-xl border bg-white px-3 py-2 text-xs text-slate-700",children:[r.jsxs("div",{className:"font-semibold text-slate-900",children:[A.first_name," ",A.last_name]}),r.jsxs("div",{className:"mt-0.5 text-[11px] text-slate-500 flex flex-wrap gap-1",children:[A.uhid&&r.jsxs(Ge,{variant:"outline",className:"h-4 px-1.5 text-[9px]",children:["UHID ",A.uhid]}),A.phone&&r.jsxs("span",{children:[" ",A.phone]}),r.jsx("span",{children:" Patient fixed from context"})]})]}),!o&&A&&r.jsxs("div",{className:"rounded-xl border bg-slate-50 px-3 py-2 text-[11px] text-slate-700",children:["Selected:"," ",r.jsxs("span",{className:"font-semibold",children:[A.first_name," ",A.last_name]})," ",A.uhid&&r.jsxs(r.Fragment,{children:[" UHID ",A.uhid]}),A.phone&&r.jsxs(r.Fragment,{children:["  ",A.phone]})]})]})})}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(We,{className:"border-slate-200 rounded-2xl bg-slate-50/70",children:r.jsxs(qe,{className:"p-3 sm:p-4 space-y-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(_s,{className:"h-4 w-4 text-slate-500"}),r.jsx("span",{className:"text-xs font-semibold text-slate-800",children:"Clinical context"})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[t==="OPD"&&r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"OPD Visit ID (optional)"}),r.jsx(Ee,{placeholder:"e.g., 1234",className:"h-8 text-xs",value:I,onChange:he=>O(he.target.value)})]}),(t==="IPD"||t==="OT_CONSUMABLE")&&r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"IPD Admission ID (optional)"}),r.jsx(Ee,{placeholder:"e.g., 5678",className:"h-8 text-xs",value:M,onChange:he=>B(he.target.value)})]}),t==="COUNTER"&&r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Counter ref / token (optional)"}),r.jsx(Ee,{placeholder:"e.g., Token #15",className:"h-8 text-xs",value:L,onChange:he=>F(he.target.value)})]}),t==="OT_CONSUMABLE"&&r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"OT case ref (optional)"}),r.jsx(Ee,{placeholder:"e.g., OT-2025-001",className:"h-8 text-xs",value:L,onChange:he=>F(he.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Doctor user ID (optional)"}),r.jsx(Ee,{placeholder:"e.g., 10",className:"h-8 text-xs",value:P,onChange:he=>R(he.target.value)}),r.jsx("p",{className:"text-[10px] text-slate-500",children:"Later you can auto-fill from logged-in doctor / visit."})]})]})]})}),A&&r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2 text-[11px] text-slate-700 flex flex-wrap items-center gap-2",children:[r.jsxs("span",{className:"font-semibold",children:[A.first_name," ",A.last_name]}),A.uhid&&r.jsxs(Ge,{variant:"outline",className:"h-4 px-1.5 text-[9px]",children:["UHID ",A.uhid]}),A.phone&&r.jsxs("span",{children:[" ",A.phone]})]})]})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/70 p-2 sm:p-3 space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between mb-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Vr,{className:"h-4 w-4 text-slate-500"}),r.jsx("span",{className:"text-xs font-semibold text-slate-800",children:"Order lines (medicines / consumables)"})]}),r.jsxs(Re,{size:"sm",variant:"outline",className:"h-7 text-[11px]",onClick:ge,children:[r.jsx(us,{className:"mr-1 h-3.5 w-3.5"}),"Add line"]})]}),r.jsx("div",{className:"overflow-x-auto -mx-1 sm:mx-0",children:r.jsxs("table",{className:"min-w-full text-[11px]",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b border-slate-200 text-[10px] uppercase tracking-wide text-slate-500",children:[r.jsx("th",{className:"py-1.5 pr-2 text-left font-medium",children:"Item"}),r.jsx("th",{className:"py-1.5 px-2 text-left font-medium",children:"Dose / Frequency"}),r.jsx("th",{className:"py-1.5 px-2 text-left font-medium",children:"Duration"}),r.jsx("th",{className:"py-1.5 px-2 text-right font-medium",children:"Qty"}),r.jsx("th",{className:"py-1.5 pl-2 text-right font-medium w-10"})]})}),r.jsx("tbody",{children:z.map(he=>r.jsxs("tr",{className:"border-b border-slate-100 align-top",children:[r.jsx("td",{className:"py-2 pr-2 min-w-[220px]",children:r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"relative",children:[r.jsx(is,{className:"absolute left-2 top-2 h-3.5 w-3.5 text-slate-400"}),r.jsx(Ee,{className:"pl-6 h-8 text-xs",placeholder:he.item?s2(he.item):"Search item (name / code / generic)",value:he.item?s2(he.item):he.searchQ,onChange:fe=>ee(he._id,fe.target.value),onFocus:()=>{var fe;return((fe=he.searchQ)==null?void 0:fe.length)>=2&&se(he._id,{showDropdown:!0})},onBlur:()=>ue(he._id)}),he.showDropdown&&(he.searching||he.searchResults.length>0)&&r.jsxs("div",{className:"absolute z-30 mt-1 max-h-60 w-full overflow-auto rounded-xl border border-slate-200 bg-white shadow-lg",children:[he.searching&&r.jsxs("div",{className:"px-3 py-2 text-[11px] text-slate-500 flex items-center gap-2",children:[r.jsx(ss,{className:"h-3.5 w-3.5 animate-spin text-slate-400"}),"Searching"]}),!he.searching&&he.searchResults.length===0&&r.jsx("div",{className:"px-3 py-2 text-[11px] text-slate-500",children:"No items found."}),!he.searching&&he.searchResults.map(fe=>r.jsxs("button",{type:"button",className:"w-full px-3 py-1.5 text-left hover:bg-slate-50",onMouseDown:le=>le.preventDefault(),onClick:()=>pe(he._id,fe),children:[r.jsx("div",{className:"font-medium text-[11px] text-slate-900",children:s2(fe)}),r.jsx("div",{className:"text-[10px] text-slate-500",children:YR(fe)})]},fe.id))]})]}),he.item&&r.jsx("div",{className:"rounded-xl bg-white border border-slate-200 px-2 py-1 text-[10px] text-slate-600",children:YR(he.item)||"Selected from inventory"}),r.jsx(gf,{className:"h-14 text-[11px]",placeholder:"Special instructions (optional)",value:he.instructions,onChange:fe=>se(he._id,{instructions:fe.target.value})})]})}),r.jsx("td",{className:"py-2 px-2 min-w-[190px]",children:r.jsxs("div",{className:"space-y-1",children:[r.jsx(Ee,{className:"h-8 text-xs",placeholder:"Dose text (e.g., 1-0-1)",value:he.doseText,onChange:fe=>se(he._id,{doseText:fe.target.value})}),r.jsx(Ee,{className:"h-8 text-xs",placeholder:"Frequency (e.g., TDS, BD, HS)",value:he.frequency,onChange:fe=>se(he._id,{frequency:fe.target.value})}),r.jsx(Ee,{className:"h-8 text-xs",placeholder:"Timing (e.g., after food)",value:he.timing,onChange:fe=>se(he._id,{timing:fe.target.value})})]})}),r.jsxs("td",{className:"py-2 px-2 min-w-[120px]",children:[r.jsx(Ee,{className:"h-8 text-xs",type:"number",min:0,placeholder:"Days",value:he.durationDays,onChange:fe=>se(he._id,{durationDays:fe.target.value})}),r.jsx("p",{className:"mt-1 text-[10px] text-slate-500",children:"Later you can auto-calc qty from dose  days."})]}),r.jsx("td",{className:"py-2 px-2 text-right align-top min-w-[80px]",children:r.jsx(Ee,{className:"h-8 text-xs text-right",type:"number",min:0,placeholder:"Qty",value:he.requestedQty,onChange:fe=>se(he._id,{requestedQty:fe.target.value})})}),r.jsx("td",{className:"py-2 pl-2 pr-1 align-top text-right",children:r.jsx(Re,{size:"icon",variant:"ghost",className:"h-7 w-7 text-slate-400 hover:text-red-600",onClick:()=>ke(he._id),children:r.jsx(qr,{className:"h-4 w-4"})})})]},he._id))})]})}),r.jsxs("div",{className:"mt-1 text-[11px] text-slate-500 flex flex-wrap items-center gap-2",children:[r.jsxs("span",{children:["Valid lines:"," ",r.jsx("span",{className:"font-semibold",children:X.length})]}),r.jsx("span",{children:""}),r.jsxs("span",{children:["Location:"," ",r.jsx("span",{className:"font-semibold",children:ye})]})]})]}),r.jsxs("div",{className:"grid gap-3 sm:grid-cols-[minmax(0,1.7fr)_minmax(0,1fr)] items-start",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Overall notes (optional)"}),r.jsx(gf,{className:"min-h-[60px] text-[11px]",placeholder:"Any clinical notes for Pharmacy",value:V,onChange:he=>U(he.target.value)})]}),r.jsxs("div",{className:"flex flex-col sm:items-end gap-2",children:[r.jsxs("div",{className:"text-[11px] text-slate-500",children:["This will create a"," ",r.jsx("span",{className:"font-semibold",children:"PharmacyPrescription"})," which appears in the Pharmacy Rx Explorer for dispensing & billing."]}),r.jsxs(Re,{className:"h-9 px-4 text-[11px]",disabled:q,onClick:_e,children:[q?r.jsx(ss,{className:"mr-1 h-4 w-4 animate-spin"}):r.jsx(Vr,{className:"mr-1 h-4 w-4"}),"Save ",x," order"]})]})]})]})]});return a==="embedded"?ce:r.jsxs("div",{className:"p-3 sm:p-4 lg:p-6 space-y-3 sm:space-y-4",children:[r.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[r.jsx("div",{className:"inline-flex h-9 w-9 items-center justify-center rounded-2xl bg-slate-900 text-white",children:r.jsx(Vr,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-base sm:text-lg font-semibold tracking-tight text-slate-900",children:s}),r.jsx("p",{className:"text-xs sm:text-sm text-slate-500",children:n})]})]}),ce]})}function hLe(){return r.jsx(xw,{orderType:"IPD",title:"IPD Ward Medication Orders",subtitle:"Raise IPD ward medication orders linked to IPD admission. Orders flow to Pharmacy Rx Explorer with ward context."})}function fLe(){return r.jsx(xw,{orderType:"COUNTER",title:"Pharmacy Counter / OTC Orders",subtitle:"Create counter / OTC orders from Inventory medicines. Ideal for walk-in and quick sales via Rx  dispense  bill."})}function mLe(){return r.jsx(xw,{orderType:"OT_CONSUMABLE",title:"OT Consumables Orders",subtitle:"Order OT consumables (sutures, implants, disposables) against IPD admission / OT case. Orders go to Pharmacy / OT store via Rx queue."})}function pLe(){return r.jsx(xw,{orderType:"OPD",title:"OPD Medication Orders",subtitle:"Prescribe medicines for OPD visits from Inventory items. Orders appear in the Pharmacy Rx queue for dispensing and billing."})}function xLe(){const[t,s]=y.useState(null),[n,a]=y.useState(""),[i,l]=y.useState(""),[o]=y.useState("INR"),[c,d]=y.useState(null),[u,f]=y.useState([]),[m,x]=y.useState(!1),[b,w]=y.useState(!1),[j,_]=y.useState(null),C=y.useCallback(R=>{s(R||null)},[]),k=y.useCallback(async()=>{if(!t){f([]),d(null),a(""),l("");return}try{x(!0);const{data:R}=await Nue({doctor_user_id:t}),I=R||[];f(I);const O=I[0]||null;d(O||null),O?(a(O.base_fee!==null&&O.base_fee!==void 0?String(O.base_fee):""),l(O.followup_fee!==null&&O.followup_fee!==void 0?String(O.followup_fee):"")):(a(""),l(""))}catch(R){console.error(R),ie.error("Failed to load consultation fees")}finally{x(!1)}},[t]);y.useEffect(()=>{k()},[k]);const A=async R=>{var I,O,M;if((I=R==null?void 0:R.preventDefault)==null||I.call(R),!t){ie.error("Select doctor first");return}if(!n||Number(n)<=0){ie.error("Enter a valid base consultation fee");return}try{w(!0);const B={doctor_user_id:t,base_fee:Number(n),currency:o};if(i&&Number(i)>0&&(B.followup_fee=Number(i)),c!=null&&c.id)await HP({...B,id:c.id}),ie.success("Consultation fee updated");else{const{data:L}=await HP(B);ie.success("Consultation fee created"),d(L)}k()}catch(B){console.error(B),ie.error(((M=(O=B==null?void 0:B.response)==null?void 0:O.data)==null?void 0:M.detail)||"Failed to save fee")}finally{w(!1)}},T=async R=>{var I,O;if(window.confirm("Delete this consultation fee?"))try{_(R.id),await Sue(R.id),ie.success("Fee deleted"),f(M=>M.filter(B=>B.id!==R.id)),(c==null?void 0:c.id)===R.id&&(d(null),a(""),l(""))}catch(M){console.error(M),ie.error(((O=(I=M==null?void 0:M.response)==null?void 0:I.data)==null?void 0:O.detail)||"Failed to delete fee")}finally{_(null)}},P=!!t;return r.jsx("div",{className:"min-h-[calc(100vh-5rem)] bg-slate-50 px-4 py-6 md:px-6",children:r.jsxs("div",{className:"mx-auto max-w-5xl space-y-6",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.2em] text-emerald-700",children:"Billing Masters"}),r.jsx("h1",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"Doctor Consultation Fees"}),r.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Configure standard consultation and follow-up fees for each doctor. These values can be reused during OPD billing and auto-pricing."})]}),r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsx(st,{className:"border-b border-slate-100 pb-4",children:r.jsx(lt,{className:"text-sm font-semibold text-slate-900",children:"Configure Fee"})}),r.jsxs(qe,{className:"space-y-4 pt-4",children:[r.jsxs("div",{className:"grid gap-4 md:grid-cols-[2fr,1.2fr,1.2fr] md:items-end",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:"Doctor"}),r.jsx(Fo,{value:t,onChange:C}),!t&&r.jsx("p",{className:"mt-1 text-[11px] text-amber-600",children:"Select a doctor to manage consultation fees."})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:["Base consultation fee (",o,")"]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg border border-slate-200 bg-slate-50",children:r.jsx(Pl,{className:"h-4 w-4 text-slate-500"})}),r.jsx(Ee,{type:"number",min:0,step:"50",value:n,onChange:R=>a(R.target.value),className:"h-9 text-sm"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:["Follow-up fee (",o,") (optional)"]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg border border-slate-200 bg-slate-50",children:r.jsx(Pl,{className:"h-4 w-4 text-slate-500"})}),r.jsx(Ee,{type:"number",min:0,step:"50",value:i,onChange:R=>l(R.target.value),className:"h-9 text-sm"})]}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"Used when visit is marked as a follow-up (if supported by billing rules)."})]})]}),r.jsx("div",{className:"flex justify-end",children:r.jsx(Re,{type:"button",onClick:A,disabled:!P||b,className:"px-5",children:b?"Saving":c?"Update Fee":"Save Fee"})})]})]}),r.jsxs(We,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsx(st,{className:"border-b border-slate-100 pb-3",children:r.jsx(lt,{className:"text-sm font-semibold text-slate-900",children:"Existing Fees"})}),r.jsxs(qe,{className:"pt-4",children:[m&&r.jsx("div",{className:"space-y-2",children:[1,2].map(R=>r.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-100 bg-slate-50 px-3 py-3",children:[r.jsx(Je,{className:"h-4 w-32"}),r.jsx(Je,{className:"h-4 w-24"})]},R))}),!m&&(!u||u.length===0)&&r.jsx("p",{className:"py-6 text-sm text-slate-500",children:"No consultation fee configured yet for this doctor."}),!m&&u&&u.length>0&&r.jsx("div",{className:"space-y-2 text-sm",children:u.map(R=>r.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx("span",{className:"font-semibold text-slate-900",children:R.doctor_name||"Selected doctor"}),r.jsx(Ge,{variant:"outline",className:"border-slate-200 bg-slate-50 px-2 py-0.5 text-[11px]",children:R.is_active?"Active":"Inactive"})]}),r.jsx("p",{className:"text-xs text-slate-500",children:"Standard OPD consultation pricing used during billing."})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"text-right text-xs text-slate-600",children:[r.jsxs("div",{className:"font-semibold text-slate-900",children:["Base:",r.jsxs("span",{className:"inline-flex items-center gap-1",children:[r.jsx(Pl,{className:"h-3.5 w-3.5 text-slate-500"}),r.jsx("span",{children:R.base_fee})]})]}),r.jsxs("div",{children:["Follow-up:",R.followup_fee!=null?r.jsxs("span",{className:"inline-flex items-center gap-1",children:[r.jsx(Pl,{className:"h-3.5 w-3.5 text-slate-500"}),r.jsx("span",{children:R.followup_fee})]}):r.jsx("span",{className:"text-slate-400",children:"Not set"})]})]}),r.jsx(Re,{variant:"ghost",size:"icon",className:"h-8 w-8 text-slate-400 hover:text-rose-600",onClick:()=>T(R),disabled:j===R.id,children:r.jsx(qr,{className:"h-4 w-4"})})]})]},R.id))})]})]})]})})}function gLe({active_only:t=!0}={}){const s={active_only:t};return J.get("/lis/masters/departments",{params:s})}function yLe(t){return J.post("/lis/masters/departments",t)}function bLe(t,s){return J.put(`/lis/masters/departments/${t}`,s)}function vLe(t){return J.delete(`/lis/masters/departments/${t}`)}function wLe({department_id:t,search:s,active_only:n=!0}={}){const a={};return t&&(a.department_id=t),s&&(a.search=s),a.active_only=n,J.get("/lis/masters/services",{params:a})}function NLe(t){return J.post("/lis/masters/services/bulk",{items:t})}function jLe(t,s){return J.put(`/lis/masters/services/${t}`,s)}function _Le(t){return J.delete(`/lis/masters/services/${t}`)}const SLe="#2563eb",n2={name:"",code:"",description:"",parent_id:"",is_active:!0},CLe={name:"",code:"",unit:"",normal_range:"",sample_type:"",method:"",comments_template:"",display_order:""};function kLe(){const{branding:t}=Pf()||{},s=(t==null?void 0:t.primary_color)||SLe,n=tt("lis.masters.departments.view"),a=tt("lis.masters.departments.create"),i=tt("lis.masters.departments.update"),l=tt("lis.masters.departments.delete"),o=tt("lis.masters.services.view"),c=tt("lis.masters.services.create"),d=tt("lis.masters.services.update"),u=tt("lis.masters.services.delete"),[f,m]=y.useState([]),[x,b]=y.useState(!1),[w,j]=y.useState(""),[_,C]=y.useState(null),[k,A]=y.useState(!1),[T,P]=y.useState(null),[R,I]=y.useState(n2),[O,M]=y.useState(!1),[B,L]=y.useState([]),[F,V]=y.useState([]),[U,z]=y.useState(!1),[W,q]=y.useState(""),[G,se]=y.useState(!1),[ge,ke]=y.useState(null),[ee,pe]=y.useState(null),[ue,ye]=y.useState(null),[X,oe]=y.useState(!1),_e=y.useMemo(()=>f.filter(ae=>!ae.parent_id),[f]),ce=y.useMemo(()=>{const ae={};return f.forEach(Te=>{Te.parent_id&&(ae[Te.parent_id]||(ae[Te.parent_id]=[]),ae[Te.parent_id].push(Te))}),ae},[f]),he=y.useMemo(()=>{const ae=w.trim().toLowerCase();return ae?_e.filter(Te=>[Te.name,Te.code].some(de=>(de||"").toString().toLowerCase().includes(ae))):_e},[w,_e]),fe=y.useMemo(()=>f.find(ae=>ae.id===_)||null,[f,_]),le=y.useMemo(()=>{const ae=W.trim().toLowerCase();return B.filter(Te=>!G&&!Te.is_active?!1:ae?[Te.name,Te.code,Te.sample_type,Te.method].some(de=>(de||"").toString().toLowerCase().includes(ae)):!0)},[B,W,G]);y.useEffect(()=>{n&&Ve()},[n]),y.useEffect(()=>{if(!fe||!o){L([]),V([]);return}Ke(fe.id)},[_,o]);async function Ve(){var ae;try{b(!0);const Te=await gLe({active_only:!0});m(Te.data||[]),!_&&((ae=Te.data)!=null&&ae.length)&&C(Te.data[0].id)}catch(Te){console.error("Failed to load lab departments",Te),ie.error("Failed to load lab departments")}finally{b(!1)}}async function Ke(ae){try{z(!0);const Te=await wLe({department_id:ae,active_only:!G});L(Te.data||[]),V([]),ke(null),pe(null)}catch(Te){console.error("Failed to load lab services",Te),ie.error("Failed to load lab services")}finally{z(!1)}}function wt(ae=null){P(null),I({...n2,parent_id:ae||""}),A(!0)}function mt(ae){P(ae),I({name:ae.name||"",code:ae.code||"",description:ae.description||"",parent_id:ae.parent_id||"",is_active:ae.is_active,display_order:ae.display_order||""}),A(!0)}function rt(ae){const{name:Te,value:de,type:Pe,checked:Ue}=ae.target;I(Le=>({...Le,[Te]:Pe==="checkbox"?Ue:de}))}async function bt(ae){var de,Pe;if(ae==null||ae.preventDefault(),!R.name.trim()){ie.error("Department name is required");return}const Te={name:R.name.trim(),code:((de=R.code)==null?void 0:de.trim())||null,description:((Pe=R.description)==null?void 0:Pe.trim())||null,parent_id:R.parent_id||null,is_active:R.is_active,display_order:R.display_order?Number(R.display_order):null};try{M(!0),T?(await bLe(T.id,Te),ie.success("Department updated")):(await yLe(Te),ie.success("Department created")),A(!1),P(null),I(n2),await Ve()}catch(Ue){console.error("Failed to save department",Ue),ie.error("Failed to save department")}finally{M(!1)}}async function be(ae){if(window.confirm(`Delete department "${ae.name}"?`))try{await vLe(ae.id),ie.success("Department deleted"),ae.id===_&&C(null),await Ve()}catch(Te){console.error("Failed to delete department",Te),ie.error("Failed to delete department")}}function ne(){if(!fe){ie.error("Select a department first");return}V(ae=>[...ae,{...CLe}])}function me(ae,Te,de){V(Pe=>{const Ue=[...Pe];return Ue[ae]={...Ue[ae],[Te]:de},Ue})}async function Ne(){if(!fe)return;const ae=F.map(Te=>{var de,Pe,Ue,Le,Dt,Rt;return{...Te,name:(Te.name||"").trim(),department_id:fe.id,code:((de=Te.code)==null?void 0:de.trim())||null,unit:((Pe=Te.unit)==null?void 0:Pe.trim())||"",normal_range:((Ue=Te.normal_range)==null?void 0:Ue.trim())||"",sample_type:((Le=Te.sample_type)==null?void 0:Le.trim())||null,method:((Dt=Te.method)==null?void 0:Dt.trim())||null,comments_template:((Rt=Te.comments_template)==null?void 0:Rt.trim())||null,display_order:Te.display_order?Number(Te.display_order):null}}).filter(Te=>Te.name);if(!ae.length){ie.error("Add at least one service row with a name");return}try{oe(!0),await NLe(ae),ie.success("Services saved"),await Ke(fe.id)}catch(Te){console.error("Failed to bulk-create services",Te),ie.error("Failed to save services")}finally{oe(!1)}}function Be(ae){ke(ae.id),pe({...ae,display_order:ae.display_order??""})}function jt(){ke(null),pe(null)}function yt(ae,Te){pe(de=>({...de,[ae]:Te}))}async function pt(){var Te,de,Pe,Ue,Le,Dt,Rt;if(!ge||!ee)return;const ae={name:((Te=ee.name)==null?void 0:Te.trim())||"",code:((de=ee.code)==null?void 0:de.trim())||null,unit:((Pe=ee.unit)==null?void 0:Pe.trim())||"",normal_range:((Ue=ee.normal_range)==null?void 0:Ue.trim())||"",sample_type:((Le=ee.sample_type)==null?void 0:Le.trim())||null,method:((Dt=ee.method)==null?void 0:Dt.trim())||null,comments_template:((Rt=ee.comments_template)==null?void 0:Rt.trim())||null,is_active:!!ee.is_active,display_order:ee.display_order?Number(ee.display_order):null};if(!ae.name){ie.error("Service name is required");return}try{ye(ge),await jLe(ge,ae),ie.success("Service updated"),await Ke(fe.id),jt()}catch(Zt){console.error("Failed to update service",Zt),ie.error("Failed to update service")}finally{ye(null)}}async function Cs(ae){if(window.confirm(`Delete service "${ae.name}"?`))try{await _Le(ae.id),ie.success("Service deleted"),await Ke(fe.id)}catch(Te){console.error("Failed to delete service",Te),ie.error("Failed to delete service")}}function hs(ae){const Te=ce[ae.id]||[],de=ae.id===_;return r.jsxs("div",{className:"mb-1",children:[r.jsxs("div",{className:`group flex items-center justify-between rounded-xl px-3 py-2 text-sm cursor-pointer border transition-all ${de?"border-transparent":"border-transparent hover:border-slate-200"}`,style:{backgroundColor:de?`${s}12`:"transparent"},onClick:()=>C(ae.id),children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Sf,{className:`h-3 w-3 text-slate-400 transition-transform ${Te.length?"group-hover:translate-x-0.5":"opacity-0"}`}),r.jsxs("div",{children:[r.jsxs("div",{className:"font-medium text-slate-800 flex items-center gap-1",children:[ae.name,!ae.is_active&&r.jsx("span",{className:"rounded-full bg-amber-50 px-2 py-0.5 text-[10px] font-semibold text-amber-700",children:"Inactive"})]}),ae.code&&r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Code: ",ae.code]})]})]}),(i||l)&&r.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[i&&r.jsx("button",{type:"button",onClick:Pe=>{Pe.stopPropagation(),mt(ae)},className:"inline-flex h-7 w-7 items-center justify-center rounded-full border border-slate-200 bg-white text-xs text-slate-600 hover:bg-slate-50",title:"Edit department",children:r.jsx(Ja,{className:"h-3 w-3"})}),l&&r.jsx("button",{type:"button",onClick:Pe=>{Pe.stopPropagation(),be(ae)},className:"inline-flex h-7 w-7 items-center justify-center rounded-full border border-rose-100 bg-white text-xs text-rose-600 hover:bg-rose-50",title:"Delete department",children:r.jsx(qr,{className:"h-3 w-3"})})]})]}),Te.length>0&&r.jsx("div",{className:"ml-4 border-l border-dashed border-slate-200 pl-3",children:Te.map(Pe=>hs(Pe))})]},ae.id)}return!n&&!o?r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 p-4 text-sm text-amber-800",children:"You do not have permission to view LIS Masters."}):r.jsxs("div",{className:"flex h-full flex-col gap-4",children:[r.jsxs("div",{className:"flex items-center justify-between gap-3",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl",style:{backgroundColor:`${s}10`},children:r.jsx(Bc,{className:"h-5 w-5",style:{color:s}})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-semibold text-slate-900",children:"Laboratory Report Masters"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Configure LIS departments, sub-departments and test master services for NABH-compliant lab reports."})]})]}),r.jsx("div",{className:"flex items-center gap-2 text-[11px] text-slate-500",children:r.jsxs("div",{className:"hidden items-center gap-1 rounded-full bg-slate-50 px-3 py-1 md:flex",children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500"}),"Auto-sets ",r.jsx("span",{className:"font-semibold",children:"Unit"})," &",r.jsx("span",{className:"font-semibold",children:"Normal Range"})," to - when empty"]})})]}),r.jsxs("div",{className:"grid flex-1 gap-4 xl:grid-cols-[320px,1fr] lg:grid-cols-[280px,1fr]",children:[r.jsxs("div",{className:"flex flex-col rounded-2xl border border-slate-100 bg-white p-3 shadow-sm",children:[r.jsxs("div",{className:"mb-3 flex items-center justify-between gap-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:"Departments & Sub-departments"}),a&&r.jsxs("button",{type:"button",onClick:()=>wt(null),className:"inline-flex items-center gap-1 rounded-full bg-slate-900 px-2.5 py-1 text-[11px] font-medium text-white shadow-sm hover:bg-slate-800",children:[r.jsx(us,{className:"h-3 w-3"}),"Add"]})]}),r.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx(is,{className:"pointer-events-none absolute left-2.5 top-2.5 h-3.5 w-3.5 text-slate-400"}),r.jsx("input",{type:"text",className:"h-8 w-full rounded-full border border-slate-200 bg-slate-50 pl-8 pr-3 text-xs text-slate-700 placeholder:text-slate-400 focus:border-slate-300 focus:bg-white focus:outline-none focus:ring-2 focus:ring-slate-100",placeholder:"Search departments...",value:w,onChange:ae=>j(ae.target.value)})]}),r.jsx("button",{type:"button",onClick:Ve,className:"inline-flex h-8 w-8 items-center justify-center rounded-full border border-slate-200 bg-white text-slate-500 hover:bg-slate-50",title:"Refresh",children:r.jsx(pN,{className:"h-3.5 w-3.5"})})]}),r.jsx("div",{className:"scrollbar-thin flex-1 overflow-y-auto rounded-2xl bg-slate-50/60 p-2",children:x?r.jsx("div",{className:"flex h-full items-center justify-center text-xs text-slate-500",children:"Loading departments"}):he.length?he.map(ae=>hs(ae)):r.jsxs("div",{className:"flex flex-col items-center justify-center gap-1 py-8 text-center text-xs text-slate-500",children:[r.jsx(Bc,{className:"h-4 w-4 text-slate-300"}),r.jsx("p",{children:"No departments yet."}),a&&r.jsxs("button",{type:"button",onClick:()=>wt(null),className:"mt-2 inline-flex items-center gap-1 rounded-full bg-slate-900 px-3 py-1.5 text-[11px] font-medium text-white hover:bg-slate-800",children:[r.jsx(us,{className:"h-3 w-3"}),"Add first department"]})]})}),fe&&a&&r.jsxs("button",{type:"button",onClick:()=>wt(fe.id),className:"mt-3 inline-flex w-full items-center justify-center gap-1 rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-3 py-1.5 text-[11px] font-medium text-slate-700 hover:bg-white",children:[r.jsx(us,{className:"h-3 w-3"}),"Add sub-department under ",r.jsx("span",{className:"font-semibold",children:fe.name})]})]}),r.jsxs("div",{className:"flex flex-col rounded-2xl border border-slate-100 bg-white p-3 shadow-sm",children:[r.jsxs("div",{className:"mb-3 flex flex-wrap items-center justify-between gap-2",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:fe?`Services for ${fe.name}`:"Select a department"}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"Add department-wise test master with units, normal ranges and method details."})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx(Ei,{className:"pointer-events-none absolute left-2.5 top-2 h-3 w-3 text-slate-400"}),r.jsx("input",{type:"text",className:"h-8 w-40 rounded-full border border-slate-200 bg-slate-50 pl-7 pr-3 text-xs text-slate-700 placeholder:text-slate-400 focus:border-slate-300 focus:bg-white focus:outline-none focus:ring-2 focus:ring-slate-100",placeholder:"Filter services",value:W,onChange:ae=>q(ae.target.value),disabled:!fe||!o})]}),r.jsxs("button",{type:"button",className:`inline-flex items-center gap-1 rounded-full border px-3 py-1.5 text-[11px] font-medium ${G?"border-slate-800 bg-slate-900 text-white":"border-slate-200 bg-white text-slate-600"}`,onClick:()=>se(ae=>!ae),disabled:!fe||!o,children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-amber-400"}),"Inactive"]}),c&&r.jsxs(r.Fragment,{children:[r.jsxs("button",{type:"button",onClick:ne,disabled:!fe,className:"inline-flex items-center gap-1 rounded-full bg-slate-900 px-3 py-1.5 text-[11px] font-medium text-white shadow-sm hover:bg-slate-800 disabled:cursor-not-allowed disabled:bg-slate-400",children:[r.jsx(us,{className:"h-3 w-3"}),"Add Row"]}),r.jsxs("button",{type:"button",onClick:Ne,disabled:!fe||!F.length||X,className:"inline-flex items-center gap-1 rounded-full border border-emerald-600 bg-emerald-600 px-3 py-1.5 text-[11px] font-medium text-white shadow-sm hover:bg-emerald-700 disabled:cursor-not-allowed disabled:border-emerald-400 disabled:bg-emerald-400",children:[X?r.jsx(pN,{className:"h-3 w-3 animate-spin"}):r.jsx(g4,{className:"h-3 w-3"}),"Save All"]})]})]})]}),r.jsx("div",{className:"scrollbar-thin flex-1 overflow-auto rounded-2xl border border-slate-100",children:fe?U?r.jsx("div",{className:"flex h-full items-center justify-center text-xs text-slate-500",children:"Loading services"}):r.jsxs("table",{className:"min-w-full border-separate border-spacing-0 text-xs",children:[r.jsx("thead",{className:"sticky top-0 z-10 bg-slate-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"#"}),r.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"Service Name"}),r.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"Code"}),r.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"Unit"}),r.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"Normal Range"}),r.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"Sample Type"}),r.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"Method"}),r.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"Comments Template"}),r.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"Active"}),r.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-right font-medium text-slate-600",children:"Actions"})]})}),r.jsxs("tbody",{children:[le.map((ae,Te)=>{const de=ge===ae.id,Pe=de?ee:ae;return r.jsxs("tr",{className:Te%2?"bg-slate-50/40":"bg-white",children:[r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5 text-[11px] text-slate-500",children:Te+1}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-md border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-1 focus:ring-slate-200 disabled:bg-slate-50",value:(Pe==null?void 0:Pe.name)||"",onChange:Ue=>yt("name",Ue.target.value),disabled:!d||!de})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-md border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-1 focus:ring-slate-200 disabled:bg-slate-50",value:(Pe==null?void 0:Pe.code)||"",onChange:Ue=>yt("code",Ue.target.value),disabled:!d||!de})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-md border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-1 focus:ring-slate-200 disabled:bg-slate-50",placeholder:"-",value:(Pe==null?void 0:Pe.unit)||"",onChange:Ue=>yt("unit",Ue.target.value),disabled:!d||!de})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-md border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-1 focus:ring-slate-200 disabled:bg-slate-50",placeholder:"-",value:(Pe==null?void 0:Pe.normal_range)||"",onChange:Ue=>yt("normal_range",Ue.target.value),disabled:!d||!de})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-md border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-1 focus:ring-slate-200 disabled:bg-slate-50",value:(Pe==null?void 0:Pe.sample_type)||"",onChange:Ue=>yt("sample_type",Ue.target.value),disabled:!d||!de})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-md border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-1 focus:ring-slate-200 disabled:bg-slate-50",value:(Pe==null?void 0:Pe.method)||"",onChange:Ue=>yt("method",Ue.target.value),disabled:!d||!de})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("textarea",{rows:1,className:"w-full rounded-md border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-1 focus:ring-slate-200 disabled:bg-slate-50",value:(Pe==null?void 0:Pe.comments_template)||"",onChange:Ue=>yt("comments_template",Ue.target.value),disabled:!d||!de})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-slate-900 focus:ring-slate-200",checked:!!(Pe!=null&&Pe.is_active),onChange:Ue=>yt("is_active",Ue.target.checked),disabled:!d||!de})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5 text-right",children:r.jsxs("div",{className:"flex justify-end gap-1",children:[d&&r.jsx(r.Fragment,{children:de?r.jsxs(r.Fragment,{children:[r.jsx("button",{type:"button",onClick:pt,disabled:ue===ae.id,className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-emerald-600 text-white hover:bg-emerald-700 disabled:cursor-not-allowed disabled:bg-emerald-400",title:"Save",children:r.jsx(g4,{className:"h-3 w-3"})}),r.jsx("button",{type:"button",onClick:jt,className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-slate-100 text-slate-500 hover:bg-slate-200",title:"Cancel",children:r.jsx(Rn,{className:"h-3 w-3"})})]}):r.jsx("button",{type:"button",onClick:()=>Be(ae),className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-slate-100 text-slate-600 hover:bg-slate-200",title:"Edit",children:r.jsx(Ja,{className:"h-3 w-3"})})}),u&&r.jsx("button",{type:"button",onClick:()=>Cs(ae),className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-rose-50 text-rose-600 hover:bg-rose-100",title:"Delete",children:r.jsx(qr,{className:"h-3 w-3"})})]})})]},ae.id)}),F.map((ae,Te)=>r.jsxs("tr",{className:"bg-emerald-50/40 text-[11px]",children:[r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5 text-[11px] text-slate-500",children:le.length+Te+1}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-md border border-emerald-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-emerald-300 focus:outline-none focus:ring-1 focus:ring-emerald-200",placeholder:"Service name*",value:ae.name,onChange:de=>me(Te,"name",de.target.value)})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-md border border-emerald-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-emerald-300 focus:outline-none focus:ring-1 focus:ring-emerald-200",placeholder:"Code",value:ae.code,onChange:de=>me(Te,"code",de.target.value)})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-md border border-emerald-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-emerald-300 focus:outline-none focus:ring-1 focus:ring-emerald-200",placeholder:"-",value:ae.unit,onChange:de=>me(Te,"unit",de.target.value)})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-md border border-emerald-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-emerald-300 focus:outline-none focus:ring-1 focus:ring-emerald-200",placeholder:"-",value:ae.normal_range,onChange:de=>me(Te,"normal_range",de.target.value)})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-md border border-emerald-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-emerald-300 focus:outline-none focus:ring-1 focus:ring-emerald-200",placeholder:"Serum / Plasma...",value:ae.sample_type,onChange:de=>me(Te,"sample_type",de.target.value)})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-md border border-emerald-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-emerald-300 focus:outline-none focus:ring-1 focus:ring-emerald-200",placeholder:"Method",value:ae.method,onChange:de=>me(Te,"method",de.target.value)})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("textarea",{rows:1,className:"w-full rounded-md border border-emerald-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-emerald-300 focus:outline-none focus:ring-1 focus:ring-emerald-200",placeholder:"Default comments",value:ae.comments_template,onChange:de=>me(Te,"comments_template",de.target.value)})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5 text-center text-[11px] text-slate-500",children:"Yes"}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5 text-right",children:r.jsx("button",{type:"button",onClick:()=>V(de=>de.filter((Pe,Ue)=>Ue!==Te)),className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-emerald-50 text-emerald-700 hover:bg-emerald-100",title:"Remove row",children:r.jsx(Rn,{className:"h-3 w-3"})})})]},`draft-${Te}`)),!le.length&&!F.length&&r.jsx("tr",{children:r.jsxs("td",{colSpan:10,className:"px-3 py-5 text-center text-[11px] text-slate-500",children:["No services found for this department.",c&&r.jsxs(r.Fragment,{children:[" ","Click"," ",r.jsx("span",{className:"font-semibold",children:"Add Row"})," to start adding tests."]})]})})]})]}):r.jsx("div",{className:"flex h-full items-center justify-center text-xs text-slate-500",children:"Select a department on the left to view / add services."})})]})]}),k&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/40 p-4",children:r.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white shadow-xl",children:[r.jsxs("div",{className:"flex items-center justify-between border-b border-slate-100 px-4 py-3",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:T?"Edit Department":"Add Department"}),r.jsx("p",{className:"text-[11px] text-slate-500",children:R.parent_id?"This will be created as a sub-department.":"Top level department."})]}),r.jsx("button",{type:"button",onClick:()=>{A(!1),P(null)},className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-slate-100 text-slate-500 hover:bg-slate-200",children:r.jsx(Rn,{className:"h-3 w-3"})})]}),r.jsxs("form",{onSubmit:bt,className:"space-y-3 px-4 py-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"text-[11px] font-medium text-slate-700",children:["Department name ",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx("input",{name:"name",type:"text",className:"w-full rounded-lg border border-slate-200 px-2.5 py-1.5 text-xs text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-100",value:R.name,onChange:rt,required:!0})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Code"}),r.jsx("input",{name:"code",type:"text",className:"w-full rounded-lg border border-slate-200 px-2.5 py-1.5 text-xs text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-100",value:R.code,onChange:rt})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Display Order"}),r.jsx("input",{name:"display_order",type:"number",className:"w-full rounded-lg border border-slate-200 px-2.5 py-1.5 text-xs text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-100",value:R.display_order||"",onChange:rt})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Parent Department (for sub-department)"}),r.jsxs("select",{name:"parent_id",className:"w-full rounded-lg border border-slate-200 px-2.5 py-1.5 text-xs text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-100",value:R.parent_id||"",onChange:rt,children:[r.jsx("option",{value:"",children:"None (Top level)"}),_e.map(ae=>r.jsx("option",{value:ae.id,children:ae.name},ae.id))]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Description"}),r.jsx("textarea",{name:"description",rows:2,className:"w-full rounded-lg border border-slate-200 px-2.5 py-1.5 text-xs text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-100",value:R.description,onChange:rt})]}),r.jsxs("div",{className:"flex items-center justify-between pt-1",children:[r.jsxs("label",{className:"flex items-center gap-2 text-[11px] text-slate-700",children:[r.jsx("input",{type:"checkbox",name:"is_active",className:"h-3.5 w-3.5 rounded border-slate-300 text-slate-900 focus:ring-slate-200",checked:R.is_active,onChange:rt}),"Active department"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{type:"button",onClick:()=>{A(!1),P(null)},className:"inline-flex items-center rounded-full border border-slate-200 bg-white px-3 py-1.5 text-[11px] font-medium text-slate-600 hover:bg-slate-50",children:"Cancel"}),r.jsxs("button",{type:"submit",disabled:O,className:"inline-flex items-center gap-1 rounded-full bg-slate-900 px-3 py-1.5 text-[11px] font-medium text-white hover:bg-slate-800 disabled:cursor-not-allowed disabled:bg-slate-400",children:[O&&r.jsx(pN,{className:"h-3 w-3 animate-spin"}),T?"Update":"Save"]})]})]})]})]})})]})}const XR=t=>t?new Date(t).toLocaleString():"",QR=t=>t?`LAB-${String(t).padStart(6,"0")}`:"";function ALe(){const{id:t}=sd(),s=Ta(),[n,a]=y.useState(!1),[i,l]=y.useState(null);y.useEffect(()=>{(async()=>{var f,m;a(!0);try{const{data:x}=await Pxe(t);l(x)}catch(x){console.error(x),ie.error(((m=(f=x==null?void 0:x.response)==null?void 0:f.data)==null?void 0:m.detail)||"Failed to load report")}finally{a(!1)}})()},[t]);const o=y.useMemo(()=>{if(!(i!=null&&i.sections))return[];const u=[];return i.sections.forEach(f=>{f.rows.forEach(m=>{u.push({department_name:f.department_name||"",sub_department_name:f.sub_department_name||"",...m})})}),u},[i]),c=async()=>{var u,f,m;try{const x=await J.get(`/lab/orders/${t}/report-pdf`,{responseType:"blob"}),b=new Blob([x.data],{type:"application/pdf"}),w=URL.createObjectURL(b);window.open(w,"_blank")}catch(x){console.error("PDF download error",x);const b=(u=x==null?void 0:x.response)==null?void 0:u.status;b===401?ie.error("Session expired. Please login again."):b===403?ie.error("You do not have permission to view this report."):ie.error(((m=(f=x==null?void 0:x.response)==null?void 0:f.data)==null?void 0:m.detail)||"Failed to download PDF")}};if(n&&!i)return r.jsx("div",{className:"p-6",children:"Loading report"});if(!i)return r.jsx("div",{className:"p-6",children:"Report not found"});const d=i.lab_no?QR(i.lab_no):QR(i.order_id);return r.jsxs("div",{className:"min-h-screen text-black print:bg-white bg-slate-50",children:[r.jsxs("div",{className:"border-b bg-white px-3 md:px-4 py-2 flex items-center justify-between print:hidden",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("button",{className:"btn-ghost flex items-center gap-1 text-xs md:text-sm",onClick:()=>s(-1),children:[r.jsx(Tb,{className:"h-4 w-4"}),"Back"]}),r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:gap-2 text-xs md:text-sm font-medium",children:[r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(tl,{className:"h-4 w-4 text-slate-600"}),r.jsx("span",{children:"Lab Report"})]}),r.jsxs("span",{className:"text-[11px] text-gray-500",children:[i.patient_name,"  ",d]})]})]}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsxs("button",{className:"btn flex items-center gap-2 text-xs md:text-sm",onClick:c,children:[r.jsx(tl,{className:"h-4 w-4"}),"Download"]})})]}),r.jsxs("div",{className:"max-w-4xl mx-auto bg-white shadow-sm print:shadow-none my-3 md:my-4 print:my-0 px-3 md:px-6 py-4 md:py-6 print:p-4",children:[r.jsx("header",{className:"border-b pb-3 md:pb-4 mb-3 md:mb-4",children:r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[r.jsx("div",{children:r.jsx("h1",{className:"text-lg md:text-xl font-semibold tracking-wide",children:"LABORATORY REPORT"})}),r.jsxs("div",{className:"text-right text-[11px] md:text-xs",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Lab No:"})," ",d]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Patient:"})," ",i.patient_name||""]})]})]})}),r.jsx("section",{className:"mb-3 md:mb-4",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-[11px] md:text-xs",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Patient Name: "}),r.jsx("span",{children:i.patient_name||""})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"UHID: "}),r.jsx("span",{children:i.patient_uhid||""})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Gender: "}),r.jsx("span",{children:i.patient_gender||""})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Age: "}),r.jsx("span",{children:i.patient_age_text||""})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Patient Type: "}),r.jsx("span",{children:i.patient_type||""})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Received On: "}),r.jsx("span",{children:XR(i.received_on)})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Reported On: "}),r.jsx("span",{children:XR(i.reported_on)})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Referred By: "}),r.jsx("span",{children:i.referred_by||""})]})]})]})}),r.jsx("section",{className:"space-y-4",children:i.sections&&i.sections.length>0?i.sections.map((u,f)=>r.jsxs("div",{children:[r.jsx("div",{className:"bg-slate-100 border px-3 py-2 mb-1",children:r.jsxs("div",{className:"text-[11px] font-semibold text-slate-700",children:[u.department_name||"Department",u.sub_department_name?` / ${u.sub_department_name}`:""]})}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-[11px] border",children:[r.jsx("thead",{className:"bg-slate-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"border px-2 py-1 text-left",children:"Test"}),r.jsx("th",{className:"border px-2 py-1 text-left",children:"Result"}),r.jsx("th",{className:"border px-2 py-1 text-left",children:"Unit"}),r.jsx("th",{className:"border px-2 py-1 text-left",children:"Normal Range"}),r.jsx("th",{className:"border px-2 py-1 text-left",children:"Flag"}),r.jsx("th",{className:"border px-2 py-1 text-left",children:"Comments"})]})}),r.jsx("tbody",{children:u.rows.map((m,x)=>r.jsxs("tr",{children:[r.jsx("td",{className:"border px-2 py-1",children:m.service_name||""}),r.jsxs("td",{className:"border px-2 py-1",children:[m.result_value||"",m.flag?` (${m.flag})`:""]}),r.jsx("td",{className:"border px-2 py-1",children:m.unit||""}),r.jsx("td",{className:"border px-2 py-1",children:m.normal_range||""}),r.jsx("td",{className:"border px-2 py-1",children:m.flag||""}),r.jsx("td",{className:"border px-2 py-1",children:m.comments||""})]},x))})]})})]},`${u.department_id}-${u.sub_department_id}-${f}`)):r.jsx("div",{className:"text-xs text-gray-500",children:"No results available for this order."})}),r.jsxs("section",{className:"mt-5 md:mt-6",children:[r.jsx("h3",{className:"text-xs md:text-sm font-semibold mb-1",children:"Latest Results Summary"}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-[11px] border",children:[r.jsx("thead",{className:"bg-slate-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"border px-2 py-1 text-left",children:"Department"}),r.jsx("th",{className:"border px-2 py-1 text-left",children:"Sub-Department"}),r.jsx("th",{className:"border px-2 py-1 text-left",children:"Test"}),r.jsx("th",{className:"border px-2 py-1 text-left",children:"Result"}),r.jsx("th",{className:"border px-2 py-1 text-left",children:"Unit"}),r.jsx("th",{className:"border px-2 py-1 text-left",children:"Normal Range"}),r.jsx("th",{className:"border px-2 py-1 text-left",children:"Flag"})]})}),r.jsx("tbody",{children:o.length>0?o.map((u,f)=>r.jsxs("tr",{children:[r.jsx("td",{className:"border px-2 py-1",children:u.department_name||""}),r.jsx("td",{className:"border px-2 py-1",children:u.sub_department_name||""}),r.jsx("td",{className:"border px-2 py-1",children:u.service_name||""}),r.jsx("td",{className:"border px-2 py-1",children:u.result_value||""}),r.jsx("td",{className:"border px-2 py-1",children:u.unit||""}),r.jsx("td",{className:"border px-2 py-1",children:u.normal_range||""}),r.jsx("td",{className:"border px-2 py-1",children:u.flag||""})]},f)):r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"border px-2 py-2 text-center text-gray-400",children:"No results to summarise."})})})]})})]}),r.jsxs("section",{className:"mt-6 md:mt-8 grid grid-cols-2 gap-6 text-[11px]",children:[r.jsx("div",{children:r.jsx("div",{className:"border-t pt-4 text-center",children:"Technician / Lab In-charge"})}),r.jsx("div",{children:r.jsx("div",{className:"border-t pt-4 text-center",children:"Pathologist / Authorized Signatory"})})]})]})]})}function ELe({value:t=[],onChange:s}){const[n,a]=y.useState(""),[i,l]=y.useState(!1),[o,c]=y.useState([]);y.useEffect(()=>{let m=!0;return l(!0),i$({q:n,active:!0,page_size:50}).then(x=>{m&&c(x.data||[])}).finally(()=>m&&l(!1)),()=>{m=!1}},[n]);const d=y.useMemo(()=>new Set(t||[]),[t]),u=y.useMemo(()=>o.filter(m=>d.has(m.id)),[o,d]),f=m=>{const x=new Set(d);x.has(m)?x.delete(m):x.add(m),s==null||s([...x])};return r.jsxs("div",{className:"space-y-2 text-black",children:[r.jsx("label",{className:"text-sm font-medium",children:"Select Tests"}),r.jsxs("div",{className:"relative",children:[r.jsx(is,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),r.jsx("input",{className:"input pl-9",placeholder:"Search by code/name",value:n,onChange:m=>a(m.target.value)})]}),r.jsx("div",{className:"grid gap-2 md:grid-cols-2",children:(o||[]).slice(0,10).map(m=>{const x=d.has(m.id);return r.jsxs("button",{type:"button",onClick:()=>f(m.id),className:["rounded-xl border p-3 text-left transition",x?"border-blue-500 bg-blue-50":"hover:bg-gray-50"].join(" "),children:[r.jsxs("div",{className:"font-medium",children:[m.code,"  ",m.name]}),r.jsxs("div",{className:"text-xs text-gray-500",children:["",Number(m.price||0).toFixed(2)]})]},m.id)})}),u.length>0&&r.jsxs("div",{className:"rounded-xl border p-3",children:[r.jsx("div",{className:"text-xs font-medium mb-2",children:"Selected"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:u.map(m=>r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-blue-50 px-3 py-1 text-xs",children:[m.code,r.jsx("button",{onClick:()=>f(m.id),className:"ml-1 rounded-full p-0.5 hover:bg-blue-100",children:r.jsx(Rn,{className:"h-3 w-3"})})]},m.id))})]}),i&&r.jsx("div",{className:"text-xs text-gray-500",children:"Loading"})]})}const ZR=t=>t?new Date(t).toLocaleString():"",r2=t=>t?`LAB-${String(t).padStart(6,"0")}`:"";function TLe(){const[t,s]=y.useState(""),[n,a]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(!1),[d,u]=y.useState(null),[f,m]=y.useState([]),[x,b]=y.useState("routine"),[w,j]=y.useState("all"),[_,C]=y.useState("all"),[k,A]=y.useState(""),[T,P]=y.useState(""),R=Ta(),I=async()=>{l(!0);try{const{data:L}=await Sxe({page_size:200});a(Array.isArray(L)?L:(L==null?void 0:L.items)||[])}catch(L){console.error(L),ie.error("Failed to load orders")}finally{l(!1)}};y.useEffect(()=>{I()},[]);const O=async()=>{var L,F;if(!d||f.length===0){ie.error("Select patient and at least one test");return}try{const{data:V}=await _xe({patient_id:d,priority:x,test_ids:f});ie.success("Order created"),c(!1),u(null),m([]),b("routine");const U=(V==null?void 0:V.id)||(V==null?void 0:V.order_id);U?R(`/lab/orders/${U}`):I()}catch(V){console.error(V),ie.error(((F=(L=V==null?void 0:V.response)==null?void 0:L.data)==null?void 0:F.detail)||"Create failed")}},M=y.useMemo(()=>n.filter(L=>{var V,U,z,W;const F=(t||"").trim().toLowerCase();if(F){const q=((V=L.patient)==null?void 0:V.full_name)||((U=L.patient)==null?void 0:U.first_name)||""+((z=L.patient)==null?void 0:z.last_name)||"",G=((W=L.patient)==null?void 0:W.uhid)||"",se=r2(L.id);if(!`${q} ${G} ${se}`.toLowerCase().includes(F))return!1}if(w!=="all"&&(L.status||"").toLowerCase()!==w||_!=="all"&&(L.priority||"").toLowerCase()!==_)return!1;if(k||T){const q=L.created_at||L.createdAt;if(!q)return!1;const G=new Date(q).setHours(0,0,0,0);if(k){const se=new Date(k).setHours(0,0,0,0);if(G<se)return!1}if(T){const se=new Date(T).setHours(0,0,0,0);if(G>se)return!1}}return!0}),[n,t,w,_,k,T]),B=M.length;return r.jsxs("div",{className:"p-3 md:p-6 text-black space-y-4",children:[r.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Bc,{className:"h-5 w-5 text-sky-600"}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg md:text-xl font-semibold",children:"Lab Orders"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Create, track, and finalize LIS orders (NABH aligned)"})]})]}),r.jsx(gn,{anyOf:["lab.orders.create","orders.lab.create"],children:r.jsxs("button",{className:"btn-primary flex items-center gap-1 text-sm",onClick:()=>c(!0),children:[r.jsx(us,{className:"h-4 w-4"}),r.jsx("span",{className:"hidden sm:inline",children:"New Lab Order"}),r.jsx("span",{className:"sm:hidden",children:"New"})]})})]}),r.jsxs("section",{className:"rounded-xl border bg-white p-3 md:p-4 space-y-3",children:[r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3",children:[r.jsxs("div",{className:"relative flex-1 max-w-xl",children:[r.jsx(is,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),r.jsx("input",{className:"input pl-9 text-sm",placeholder:"Search by UHID, patient name, or Lab No (e.g., LAB-000123)",value:t,onChange:L=>s(L.target.value)})]}),r.jsxs("button",{type:"button",onClick:I,className:"text-xs text-gray-500 hover:text-gray-700 flex items-center gap-1",children:[r.jsx(Ei,{className:"h-4 w-4"}),"Refresh"]})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-2 md:gap-3 text-xs",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] text-gray-500 mb-1",children:"Status"}),r.jsxs("select",{className:"input h-8 text-xs",value:w,onChange:L=>j(L.target.value),children:[r.jsx("option",{value:"all",children:"All"}),r.jsx("option",{value:"ordered",children:"Ordered"}),r.jsx("option",{value:"collected",children:"Collected"}),r.jsx("option",{value:"in_progress",children:"In Progress"}),r.jsx("option",{value:"validated",children:"Validated"}),r.jsx("option",{value:"reported",children:"Reported"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] text-gray-500 mb-1",children:"Priority"}),r.jsxs("select",{className:"input h-8 text-xs",value:_,onChange:L=>C(L.target.value),children:[r.jsx("option",{value:"all",children:"All"}),r.jsx("option",{value:"routine",children:"Routine"}),r.jsx("option",{value:"urgent",children:"Urgent"}),r.jsx("option",{value:"stat",children:"STAT"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] text-gray-500 mb-1",children:"From Date"}),r.jsx("input",{type:"date",className:"input h-8 text-xs",value:k,onChange:L=>A(L.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] text-gray-500 mb-1",children:"To Date"}),r.jsx("input",{type:"date",className:"input h-8 text-xs",value:T,onChange:L=>P(L.target.value)})]}),r.jsx("div",{className:"flex items-end",children:r.jsx("button",{type:"button",className:"text-[11px] text-gray-500 underline",onClick:()=>{j("all"),C("all"),A(""),P("")},children:"Clear filters"})})]})]}),r.jsxs("section",{className:"rounded-xl border bg-white p-2 md:p-0",children:[r.jsxs("div",{className:"space-y-2 md:hidden",children:[i&&r.jsx("div",{className:"px-3 py-4 text-xs text-gray-500",children:"Loading"}),!i&&M.length===0&&r.jsx("div",{className:"px-3 py-6 text-xs text-gray-500 text-center",children:"No lab orders found."}),!i&&M.map(L=>r.jsxs("div",{className:"border rounded-xl p-3 flex flex-col gap-2 bg-slate-50/60",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("div",{className:"text-xs font-semibold text-slate-800",children:r2(L.id)}),r.jsx(Gy,{status:L.status})]}),r.jsx("div",{className:"text-xs",children:r.jsx(zp,{patient:L.patient,patientId:L.patient_id})}),r.jsxs("div",{className:"flex justify-between text-[11px] text-gray-600",children:[r.jsxs("div",{children:[r.jsxs("div",{children:["Priority:"," ",r.jsx("span",{className:"font-medium capitalize",children:L.priority||"routine"})]}),r.jsxs("div",{children:["Created:"," ",r.jsx("span",{children:ZR(L.created_at||L.createdAt)})]})]}),r.jsx("div",{className:"text-right",children:r.jsx("button",{className:"btn-ghost text-xs px-2 py-1",onClick:()=>R(`/lab/orders/${L.id}`),children:"Open"})})]})]},L.id))]}),r.jsx("div",{className:"hidden md:block",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-gray-50 text-gray-600",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left text-xs",children:"Lab No"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs",children:"Patient"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs",children:"Priority"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs",children:"Status"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs",children:"Created"}),r.jsx("th",{className:"px-3 py-2 text-right text-xs",children:"Actions"})]})}),r.jsxs("tbody",{children:[i&&r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-3 text-sm text-gray-500",colSpan:6,children:"Loading"})}),!i&&M.map(L=>r.jsxs("tr",{className:"border-t hover:bg-slate-50/80",children:[r.jsx("td",{className:"px-3 py-2",children:r.jsx(wk,{order:{...L,display_no:r2(L.id)},to:`/lab/orders/${L.id}`})}),r.jsx("td",{className:"px-3 py-2",children:r.jsx(zp,{patient:L.patient,patientId:L.patient_id})}),r.jsx("td",{className:"px-3 py-2 capitalize text-xs",children:L.priority||"routine"}),r.jsx("td",{className:"px-3 py-2",children:r.jsx(Gy,{status:L.status})}),r.jsx("td",{className:"px-3 py-2 text-xs",children:ZR(L.created_at||L.createdAt)}),r.jsx("td",{className:"px-3 py-2 text-right",children:r.jsx(nl,{to:`/lab/orders/${L.id}`,className:"btn-ghost text-xs",children:"View"})})]},L.id)),!i&&M.length===0&&r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-6 text-center text-gray-500",colSpan:6,children:"No orders"})})]}),r.jsx("tfoot",{children:r.jsx("tr",{children:r.jsxs("td",{className:"px-3 py-2 text-xs text-gray-500",colSpan:6,children:["Total: ",B]})})})]})})]}),o&&r.jsxs("div",{className:"fixed inset-0 z-40",children:[r.jsx("div",{className:"absolute inset-0 bg-black/30",onClick:()=>c(!1)}),r.jsxs("div",{className:"absolute right-0 top-0 h-full w-full max-w-xl bg-white shadow-xl p-4 overflow-y-auto",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4",children:"New Lab Order"}),r.jsxs("div",{className:"space-y-4 text-sm",children:[r.jsx(Zb,{value:d,onChange:u}),r.jsx(ELe,{value:f,onChange:m}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm block mb-1",children:"Priority"}),r.jsxs("select",{className:"input",value:x,onChange:L=>b(L.target.value),children:[r.jsx("option",{value:"routine",children:"Routine"}),r.jsx("option",{value:"urgent",children:"Urgent"}),r.jsx("option",{value:"stat",children:"STAT"})]})]}),r.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[r.jsx("button",{className:"btn-ghost",onClick:()=>c(!1),children:"Cancel"}),r.jsx("button",{className:"btn-primary",onClick:O,children:"Create"})]})]})]})]})]})}const Gf=(t={})=>{const s={};return Object.entries(t).forEach(([n,a])=>{a!=null&&a!==""&&(s[n]=a)}),s};function wK({active:t,search:s}={}){const n=Gf({active:t,search:s});return J.get("/ot/specialities",{params:n})}function PLe(t){return J.post("/ot/specialities",t)}function ILe(t,s){return J.put(`/ot/specialities/${t}`,s)}function MLe(t){return J.delete(`/ot/specialities/${t}`)}function NK({search:t,specialityId:s,isActive:n,limit:a}={}){const i=Gf({search:t,speciality_id:s,is_active:typeof n=="boolean"?n:void 0,limit:a});return J.get("/ot/procedures",{params:i})}function DLe(t){return J.post("/ot/procedures",t)}function OLe(t,s){return J.put(`/ot/procedures/${t}`,s)}function RLe(t){return J.delete(`/ot/procedures/${t}`)}function LLe({active:t,search:s,specialityId:n}={}){const a=Gf({active:t,search:s,speciality_id:n});return J.get("/ot/theatres",{params:a})}function BLe({date:t,bedId:s,surgeonUserId:n,patientId:a,status:i}={}){const l=Gf({date:t,bed_id:s,surgeon_user_id:n,patient_id:a,status:i});return J.get("/ot/schedule",{params:l})}function FLe(t){return J.post("/ot/schedules",t)}function $Le(t,s){return J.put(`/ot/schedules/${t}`,s)}function zLe(t,s){return J.post(`/ot/cases/${t}/close`,s)}function ULe(t){return J.get(`/ot/cases/${t}`)}function VLe(t){return J.get(`/ot/cases/${t}/preop-checklist`).then(s=>s.data)}function HLe(t,s){return J.post(`/ot/cases/${t}/preop-checklist`,s).then(n=>n.data)}function WLe(t,s){return J.put(`/ot/cases/${t}/preop-checklist`,s).then(n=>n.data)}function qLe(t){return J.get(`/ot/cases/${t}/safety-checklist`)}function GLe(t,s){return J.post(`/ot/cases/${t}/safety-checklist`,{...s,case_id:t})}function KLe(t,s){return J.put(`/ot/cases/${t}/safety-checklist`,s)}const YLe=t=>J.get(`/ot/cases/${t}/anaesthesia-record`),XLe=(t,s)=>J.post(`/ot/cases/${t}/anaesthesia-record`,s),QLe=(t,s)=>J.put(`/ot/cases/${t}/anaesthesia-record`,s),ZLe=t=>J.get(`/ot/anaesthesia-records/${t}/vitals`),JLe=(t,s)=>J.post(`/ot/anaesthesia-records/${t}/vitals`,s),e7e=t=>J.delete(`/ot/anaesthesia-vitals/${t}`),t7e=t=>J.get(`/ot/anaesthesia-records/${t}/drugs`),s7e=(t,s)=>J.post(`/ot/anaesthesia-records/${t}/drugs`,s),n7e=t=>J.delete(`/ot/anaesthesia-drugs/${t}`);function r7e(t){return J.get(`/ot/cases/${t}/nursing-record`)}function a7e(t,s){return J.post(`/ot/cases/${t}/nursing-record`,{...s,case_id:t,primary_nurse_id:s.primary_nurse_id??null})}function JR(t,s){return J.put(`/ot/cases/${t}/nursing-record`,{...s,case_id:t,primary_nurse_id:s.primary_nurse_id??null})}function i7e(t){return J.get(`/ot/cases/${t}/counts`)}function l7e(t,s){return J.post(`/ot/cases/${t}/counts`,s)}function o7e(t,s){return J.put(`/ot/cases/${t}/counts`,s)}function c7e(t){return J.get(`/ot/cases/${t}/operation-note`)}function d7e(t,s){return J.post(`/ot/cases/${t}/operation-note`,{...s,case_id:t})}function u7e(t,s){return J.put(`/ot/cases/${t}/operation-note`,s)}function h7e(t){return J.get(`/ot/cases/${t}/blood-transfusions`)}function f7e(t,s){return J.post(`/ot/cases/${t}/blood-transfusions`,{...s,case_id:t})}function m7e(t){return J.delete(`/ot/blood-transfusions/${t}`)}function p7e(t){return J.get(`/ot/cases/${t}/pacu`)}function x7e(t,s){return J.post(`/ot/cases/${t}/pacu`,{...s,case_id:t})}function g7e(t,s){return J.put(`/ot/cases/${t}/pacu`,s)}function y7e({theatreId:t,caseId:s,date:n,fromDate:a,toDate:i,session:l}={}){const o=Gf({theatre_id:t,case_id:s,date:n,from_date:a,to_date:i,session:l});return J.get("/ot/cleaning-logs",{params:o})}function b7e(t){return J.post("/ot/cleaning-logs",t)}function v7e(t,s){return J.put(`/ot/cleaning-logs/${t}`,s)}function w7e(t){return J.delete(`/ot/cleaning-logs/${t}`)}function N7e({theatreId:t,date:s,fromDate:n,toDate:a}={}){const i=Gf({theatre_id:t,date:s,from_date:n,to_date:a});return J.get("/ot/environment-logs",{params:i})}function j7e(t){return J.post("/ot/environment-logs",t)}function _7e(t,s){return J.put(`/ot/environment-logs/${t}`,s)}function S7e(t){return J.delete(`/ot/environment-logs/${t}`)}function C7e(t,s={}){return J.post(`/ot/schedule/${t}/open-case`,s)}function k7e({value:t,onChange:s,label:n="Patient",initialPatient:a=null,disabled:i=!1}){const[l,o]=y.useState(""),[c,d]=y.useState([]),[u,f]=y.useState(!1),[m,x]=y.useState(a||null);y.useEffect(()=>{a&&x(a)},[a]),y.useEffect(()=>{let j=!0;if(!l){d([]);return}return f(!0),ak(l).then(_=>{j&&d(_.data||[])}).catch(()=>{j&&d([])}).finally(()=>{j&&f(!1)}),()=>{j=!1}},[l]),y.useEffect(()=>{if(!t){x(null);return}const j=c.find(_=>_.id===t);j&&x(j)},[t,c]);const b=j=>{x(j),o(""),d([]),s==null||s(j.id,j)},w=()=>{x(null),s==null||s(null,null)};return r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:n}),!m&&r.jsxs(r.Fragment,{children:[r.jsx("input",{className:"input",placeholder:"Search by name / UHID / phone",value:l,disabled:i,onChange:j=>o(j.target.value)}),u&&r.jsx("div",{className:"text-xs text-slate-500",children:"Searching"}),c.length>0&&r.jsx("div",{className:"max-h-48 overflow-auto rounded-xl border bg-white text-sm",children:c.map(j=>r.jsx("button",{type:"button",onClick:()=>b(j),className:"flex w-full items-center justify-between px-3 py-2 text-left hover:bg-slate-50",children:r.jsxs("div",{children:[r.jsxs("div",{className:"font-medium",children:[j.first_name," ",j.last_name]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID: ",j.uhid,"  ",j.phone]})]})},j.id))})]}),m&&r.jsxs("div",{className:"flex items-start justify-between gap-3 rounded-xl border bg-slate-50 px-3 py-2 text-xs text-slate-700",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"font-semibold",children:[m.first_name," ",m.last_name]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID: ",m.uhid,"  ",m.phone]})]}),!i&&r.jsx("button",{type:"button",onClick:w,className:"text-[11px] font-medium text-sky-700 hover:underline",children:"Change"})]})]})}function e6({value:t,onChange:s,label:n="Department  Doctor",initialDepartmentId:a=null,disabled:i=!1}){const[l,o]=y.useState([]),[c,d]=y.useState(""),[u,f]=y.useState([]),[m,x]=y.useState(!1),[b,w]=y.useState(!1),[j,_]=y.useState("");y.useEffect(()=>{let T=!0;return w(!0),yB().then(P=>{T&&o(P.data||[])}).catch(P=>{T&&(console.error("fetchDepartments error",P),ie.error("Failed to load departments"),o([]))}).finally(()=>{T&&w(!1)}),()=>{T=!1}},[]),y.useEffect(()=>{a&&!c&&d(String(a))},[a]),y.useEffect(()=>{let T=!0;if(_(""),f([]),!c)return;const P=Number(c);return x(!0),bB({departmentId:P,isDoctor:!0}).then(R=>{T&&f(R.data||[])}).catch(R=>{var O,M;if(!T)return;console.error("fetchDepartmentUsers error",R);const I=((M=(O=R==null?void 0:R.response)==null?void 0:O.data)==null?void 0:M.detail)||"Failed to load doctors";_(I),ie.error(I),f([])}).finally(()=>{T&&x(!1)}),()=>{T=!1}},[c]);const C=y.useMemo(()=>u.find(T=>T.id===t)||null,[u,t]),k=T=>{const P=T.target.value;d(P);const R=P?Number(P):null;s==null||s(null,{department_id:R})},A=T=>{const P=T.target.value,R=P?Number(P):null,I=c?Number(c):null;s==null||s(R,{department_id:I})};return r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:n}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("select",{className:"input",value:c,onChange:k,disabled:b||i,children:[r.jsx("option",{value:"",children:b?"Loading departments":"Select department"}),l.map(T=>r.jsx("option",{value:T.id,children:T.name},T.id))]}),r.jsxs("select",{className:"input",value:t||"",onChange:A,disabled:i||!c||m||u.length===0,children:[r.jsx("option",{value:"",children:m?"Loading doctors":c?u.length===0?"No doctors in this department":"Select doctor":"Select department first"}),u.map(T=>r.jsxs("option",{value:T.id,children:[T.name,T.email?` (${T.email})`:""]},T.id))]})]}),C&&r.jsxs("div",{className:"rounded-xl border bg-emerald-50 px-3 py-2 text-sm",children:["Selected:"," ",r.jsx("span",{className:"font-medium",children:C.name})]}),j&&r.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-2 text-sm text-red-700",children:j})]})}function jK({value:t,onChange:s}){const[n,a]=y.useState([]),[i,l]=y.useState(""),[o,c]=y.useState([]),[d,u]=y.useState(""),[f,m]=y.useState([]);return y.useEffect(()=>{Bb().then(x=>a(x.data||[]))},[]),y.useEffect(()=>{c([]),u(""),m([]),i&&kx({ward_id:i}).then(x=>c(x.data||[]))},[i]),y.useEffect(()=>{m([]),d&&rl({room_id:d}).then(x=>m(x.data||[]))},[d]),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:"Allocate Bed (Ward  Room  Bed)"}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("select",{className:"input",value:i,onChange:x=>l(x.target.value),children:[r.jsx("option",{value:"",children:"Select ward"}),n.map(x=>r.jsxs("option",{value:x.id,children:[x.code,"  ",x.name]},x.id))]}),r.jsxs("select",{className:"input",value:d,onChange:x=>u(x.target.value),disabled:!i,children:[r.jsx("option",{value:"",children:"Select room"}),o.map(x=>r.jsxs("option",{value:x.id,children:[x.number,"  ",x.type]},x.id))]}),r.jsxs("select",{className:"input",value:t||"",onChange:x=>s(Number(x.target.value)),disabled:!d,children:[r.jsx("option",{value:"",children:"Select bed"}),f.map(x=>r.jsxs("option",{value:x.id,children:[x.code," ",x.state!=="vacant"?` ${x.state}`:""]},x.id))]})]}),!!t&&(()=>{const x=f.find(b=>b.id===t);return x?r.jsxs("div",{className:"text-xs text-gray-500",children:["Selected: ",r.jsx("span",{className:"font-medium",children:x.code})," (",x.state,")"]}):null})()]})}const A7e=t=>t?(typeof t=="string"?new Date(t):t).toISOString().slice(0,10):"",t6=t=>t?String(t).slice(0,5):"",E7e={planned:"bg-blue-50 text-blue-700 border-blue-200",in_progress:"bg-amber-50 text-amber-700 border-amber-200",completed:"bg-emerald-50 text-emerald-700 border-emerald-200",cancelled:"bg-rose-50 text-rose-700 border-rose-200"},T7e={Elective:"bg-slate-50 text-slate-700 border-slate-200",Emergency:"bg-red-50 text-red-700 border-red-200"};function P7e({status:t}){if(!t)return null;const s=E7e[t]||"bg-slate-50 text-slate-700 border-slate-200",n=t.replace("_"," ").replace(/\b\w/g,a=>a.toUpperCase());return r.jsxs("span",{className:`inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-medium ${s}`,children:[r.jsx("span",{className:"mr-1.5 h-1.5 w-1.5 rounded-full bg-current"}),n]})}function I7e({priority:t}){if(!t)return null;const s=T7e[t]||"bg-slate-50 text-slate-700 border-slate-200";return r.jsx("span",{className:`inline-flex items-center rounded-full border px-2 py-0.5 text-[11px] font-medium uppercase tracking-wide ${s}`,children:t})}function M7e({selectedBedId:t,onSelectBed:s}){return r.jsxs("div",{className:"flex h-full flex-col rounded-2xl border bg-white/80 backdrop-blur-sm",children:[r.jsxs("div",{className:"border-b px-4 py-3",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"OT Location / Bed Filter"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Filter OT schedule by ward & bed, or leave blank to see all."})]}),r.jsxs("div",{className:"flex-1 space-y-3 px-3 py-3",children:[r.jsx(jK,{value:t?Number(t):null,onChange:n=>s(n||null)}),r.jsx("div",{className:"rounded-xl border border-slate-100 bg-slate-50 px-3 py-2 text-xs text-slate-600",children:t?r.jsxs(r.Fragment,{children:["Showing cases for ",r.jsxs("span",{className:"font-semibold",children:["Bed #",t]}),"."]}):r.jsxs(r.Fragment,{children:["No specific bed selected  showing ",r.jsx("span",{className:"font-semibold",children:"all OT beds"})," for this day."]})})]})]})}function D7e({schedules:t,loading:s,date:n,bedId:a,onEdit:i,onOpenCase:l,onMarkSuccess:o}){const c=a?`Bed #${a}  ${n}`:`All locations  ${n}`;return r.jsxs("div",{className:"flex h-full flex-col rounded-2xl border bg-white/90 backdrop-blur-sm",children:[r.jsx("div",{className:"flex items-center justify-between gap-3 border-b px-4 py-3",children:r.jsxs("div",{children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"OT Day Schedule"}),r.jsx("p",{className:"text-xs text-slate-500",children:c})]})}),r.jsx("div",{className:"flex-1 overflow-auto",children:r.jsxs("table",{className:"min-w-full text-left text-xs text-slate-700",children:[r.jsx("thead",{className:"sticky top-0 z-10 border-b bg-slate-50/90 backdrop-blur",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Time"}),r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Location / Bed"}),r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Patient"}),r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Procedure"}),r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Surgeon"}),r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Priority"}),r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Status"}),r.jsx("th",{className:"px-4 py-2 text-right text-[11px] font-semibold text-slate-500",children:"Actions"})]})}),r.jsxs("tbody",{children:[s&&r.jsx(r.Fragment,{children:Array.from({length:4}).map((d,u)=>r.jsx("tr",{className:"animate-pulse border-b last:border-b-0",children:Array.from({length:8}).map((f,m)=>r.jsx("td",{className:"px-4 py-3",children:r.jsx("div",{className:"h-3 w-3/4 rounded bg-slate-100"})},m))},u))}),!s&&t.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:8,className:"px-4 py-10 text-center text-xs text-slate-500",children:r.jsxs("div",{className:"flex flex-col items-center justify-center gap-2",children:[r.jsx(Kn,{className:"h-5 w-5 text-slate-400"}),r.jsx("span",{children:"No cases scheduled for this day."})]})})}),!s&&t.map(d=>{var _,C,k,A,T,P,R;const u=[d.planned_start_time,d.planned_end_time].filter(Boolean).join("  "),f=((_=d.patient)==null?void 0:_.full_name)||[(C=d.patient)==null?void 0:C.first_name,(k=d.patient)==null?void 0:k.last_name].filter(Boolean).join(" "),m=((A=d.patient)==null?void 0:A.uhid)||d.patient_uhid,x=((T=d.surgeon)==null?void 0:T.full_name)||d.surgeon_name||null,b=((P=d.anaesthetist)==null?void 0:P.full_name)||d.anaesthetist_name||null,w=((R=d.primary_procedure)==null?void 0:R.name)||d.procedure_name,j=(d.procedures||[]).filter(I=>!I.is_primary).length;return r.jsxs("tr",{className:"border-b border-slate-100 last:border-b-0 hover:bg-slate-50/60",children:[r.jsx("td",{className:"px-4 py-2 align-top",children:r.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-slate-700",children:[r.jsx(Xn,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsx("span",{children:u||""})]})}),r.jsx("td",{className:"px-4 py-2 align-top text-xs text-slate-700",children:d.bed_id?r.jsxs("div",{className:"font-medium text-slate-800",children:["Bed #",d.bed_id]}):r.jsx("div",{className:"font-medium text-slate-400",children:"No bed assigned"})}),r.jsxs("td",{className:"px-4 py-2 align-top text-xs text-slate-700",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(on,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsx("span",{className:"font-medium text-slate-800",children:f||(m?`UHID ${m}`:`UHID #${d.patient_id}`)})]}),m&&r.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID ",m]}),d.admission_id&&r.jsxs("div",{className:"text-[11px] text-slate-500",children:["IP #",d.admission_id]})]}),r.jsxs("td",{className:"max-w-xs px-4 py-2 align-top text-xs text-slate-700",children:[r.jsx("div",{className:"line-clamp-2 font-medium text-slate-900",children:w||""}),r.jsxs("div",{className:"mt-0.5 flex flex-wrap items-center gap-1",children:[d.side&&r.jsx("span",{className:"rounded-full bg-slate-100 px-1.5 py-0.5 text-[10px] uppercase tracking-wide text-slate-600",children:d.side}),j>0&&r.jsxs("span",{className:"rounded-full bg-sky-50 px-1.5 py-0.5 text-[10px] text-sky-700",children:["+",j," more"]})]})]}),r.jsxs("td",{className:"px-4 py-2 align-top text-xs text-slate-700",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(_s,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsx("span",{className:"font-medium text-slate-800",children:x||`Dr #${d.surgeon_user_id}`})]}),(b||d.anaesthetist_user_id)&&r.jsxs("div",{className:"mt-0.5 text-[11px] text-slate-500",children:["Anaes"," ",b||`#${d.anaesthetist_user_id}`]})]}),r.jsx("td",{className:"px-4 py-2 align-top",children:r.jsx(I7e,{priority:d.priority})}),r.jsx("td",{className:"px-4 py-2 align-top",children:r.jsx(P7e,{status:d.status})}),r.jsx("td",{className:"px-4 py-2 align-top",children:r.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-1.5",children:[r.jsx("button",{type:"button",className:"inline-flex items-center gap-1 rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] font-medium text-slate-700 hover:border-sky-400 hover:text-sky-700",onClick:()=>i(d),children:"Edit"}),r.jsxs("button",{type:"button",onClick:()=>l(d),className:`inline-flex items-center gap-1 rounded-lg border px-2.5 py-1 text-[11px] font-medium ${d.case_id?"border-slate-200 bg-white text-slate-700 hover:border-sky-400 hover:text-sky-700":"border-emerald-600 bg-emerald-600 text-white hover:bg-emerald-700"}`,children:[r.jsx(sn,{className:"h-3.5 w-3.5"}),d.case_id?"Details":"Open Case"]}),o&&d.case_id&&d.status!=="completed"&&r.jsxs("button",{type:"button",onClick:()=>o(d),className:"inline-flex items-center gap-1 rounded-lg border border-emerald-600 bg-emerald-50 px-2.5 py-1 text-[11px] font-semibold text-emerald-700 hover:bg-emerald-100",title:"Mark OT as completed (success) for billing",children:[r.jsx(Ur,{className:"h-3.5 w-3.5"}),"Success"]})]})})]},d.id)})]})]})})]})}function O7e({open:t,mode:s,onClose:n,onSaved:a,defaultDate:i,defaultBedId:l,editingSchedule:o}){const c=s==="edit",[d,u]=y.useState({date:i||"",planned_start_time:"",planned_end_time:"",patient_id:"",admission_id:"",bed_id:l||"",surgeon_user_id:"",anaesthetist_user_id:"",procedure_name:"",side:"",priority:"Elective",notes:"",primary_procedure_id:"",additional_procedure_ids:[]}),[f,m]=y.useState(!1),[x,b]=y.useState(null);if(y.useEffect(()=>{var A,T;t&&(u(c&&o?{date:o.date||i||"",planned_start_time:t6(o.planned_start_time),planned_end_time:t6(o.planned_end_time),patient_id:o.patient_id||"",admission_id:o.admission_id||"",bed_id:o.bed_id||l||"",surgeon_user_id:o.surgeon_user_id||"",anaesthetist_user_id:o.anaesthetist_user_id||"",procedure_name:o.procedure_name||((A=o.primary_procedure)==null?void 0:A.name)||"",side:o.side||"",priority:o.priority||"Elective",notes:o.notes||"",primary_procedure_id:o.primary_procedure_id||"",additional_procedure_ids:((T=o.procedures)==null?void 0:T.filter(P=>!P.is_primary).map(P=>P.procedure_id))||[]}:{date:i||"",planned_start_time:"",planned_end_time:"",patient_id:"",admission_id:"",bed_id:l||"",surgeon_user_id:"",anaesthetist_user_id:"",procedure_name:"",side:"",priority:"Elective",notes:"",primary_procedure_id:"",additional_procedure_ids:[]}),b(null),m(!1))},[t,c,o,l,i]),!t)return null;const w=(A,T)=>{u(P=>({...P,[A]:T}))},j=()=>d.date?d.planned_start_time?d.procedure_name?d.surgeon_user_id?null:"Please select surgeon":"Please enter procedure name":"Please enter start time":"Please select a date",_=async A=>{var P,R;A.preventDefault();const T=j();if(T){b(T);return}m(!0),b(null);try{const I={date:d.date,planned_start_time:d.planned_start_time,planned_end_time:d.planned_end_time||null,patient_id:d.patient_id?Number(d.patient_id):null,admission_id:d.admission_id?Number(d.admission_id):null,bed_id:d.bed_id?Number(d.bed_id):null,surgeon_user_id:d.surgeon_user_id?Number(d.surgeon_user_id):null,anaesthetist_user_id:d.anaesthetist_user_id?Number(d.anaesthetist_user_id):null,procedure_name:d.procedure_name,side:d.side||null,priority:d.priority||"Elective",notes:d.notes||null,primary_procedure_id:d.primary_procedure_id?Number(d.primary_procedure_id):null,additional_procedure_ids:(d.additional_procedure_ids||[]).map(O=>Number(O))};console.log(I,"bed no"),c&&(o!=null&&o.id)?await $Le(o.id,I):await FLe(I),a==null||a(),n()}catch(I){console.error("Failed to save OT schedule",I);const O=((R=(P=I==null?void 0:I.response)==null?void 0:P.data)==null?void 0:R.detail)||(I==null?void 0:I.message)||"Failed to save OT schedule";b(O)}finally{m(!1)}},C=c?"Edit OT Schedule":"New OT Schedule",k=c?"Update timing and details of this OT booking.":"Create a new OT booking for the selected day.";return r.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-slate-900/40 backdrop-blur-sm",children:r.jsxs("div",{className:"relative w-full max-w-3xl rounded-2xl bg-white shadow-xl",children:[r.jsxs("div",{className:"flex items-start justify-between border-b px-5 py-3.5",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:C}),r.jsx("p",{className:"text-xs text-slate-500",children:k})]}),r.jsx("button",{type:"button",onClick:n,className:"rounded-full p-1 text-slate-400 hover:bg-slate-100 hover:text-slate-600",children:r.jsx(Rn,{className:"h-4 w-4"})})]}),r.jsxs("form",{onSubmit:_,children:[r.jsxs("div",{className:"grid grid-cols-1 gap-4 px-5 py-4 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"text-xs font-medium text-slate-700",children:["Date ",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:d.date,onChange:A=>w("date",A.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Priority"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:d.priority,onChange:A=>w("priority",A.target.value),children:[r.jsx("option",{value:"Elective",children:"Elective"}),r.jsx("option",{value:"Emergency",children:"Emergency"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"text-xs font-medium text-slate-700",children:["Start time ",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:d.planned_start_time,onChange:A=>w("planned_start_time",A.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"End time"}),r.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:d.planned_end_time,onChange:A=>w("planned_end_time",A.target.value)})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsx(k7e,{label:"Patient",value:d.patient_id?Number(d.patient_id):null,onChange:A=>u(T=>({...T,patient_id:A||""}))}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Admission ID (IP)"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:d.admission_id,onChange:A=>w("admission_id",A.target.value),placeholder:"Optional"})]})]}),r.jsx(jK,{value:d.bed_id?Number(d.bed_id):null,onChange:A=>u(T=>({...T,bed_id:A||""}))})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsx(R7e,{primaryId:d.primary_procedure_id?Number(d.primary_procedure_id):null,additionalIds:d.additional_procedure_ids||[],onChange:A=>{u(T=>({...T,primary_procedure_id:A.primary_procedure_id??T.primary_procedure_id,additional_procedure_ids:A.additional_procedure_ids??T.additional_procedure_ids,procedure_name:A.primary_procedure_name&&!T.procedure_name?A.primary_procedure_name:T.procedure_name}))}}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"text-xs font-medium text-slate-700",children:["Procedure name (display)"," ",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:d.procedure_name,onChange:A=>w("procedure_name",A.target.value),placeholder:"E.g., Laparoscopic cholecystectomy"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Side"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:d.side,onChange:A=>w("side",A.target.value),children:[r.jsx("option",{value:"",children:"Not applicable"}),r.jsx("option",{value:"Right",children:"Right"}),r.jsx("option",{value:"Left",children:"Left"}),r.jsx("option",{value:"Bilateral",children:"Bilateral"}),r.jsx("option",{value:"Midline",children:"Midline"})]})]}),r.jsx(e6,{label:"Surgeon",value:d.surgeon_user_id?Number(d.surgeon_user_id):null,onChange:A=>u(T=>({...T,surgeon_user_id:A||""}))})]}),r.jsx(e6,{label:"Anaesthetist",value:d.anaesthetist_user_id?Number(d.anaesthetist_user_id):null,onChange:A=>u(T=>({...T,anaesthetist_user_id:A||""}))}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Notes"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:d.notes,onChange:A=>w("notes",A.target.value),placeholder:"Any special requirements / remarks"})]})]})]}),x&&r.jsx("div",{className:"px-5 pb-2",children:r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:x})}),r.jsxs("div",{className:"flex items-center justify-end gap-2 border-t px-5 py-3",children:[r.jsx("button",{type:"button",onClick:n,className:"inline-flex items-center gap-1.5 rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-50",disabled:f,children:"Cancel"}),r.jsxs("button",{type:"submit",className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",disabled:f,children:[f&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),c?"Update Schedule":"Create Schedule"]})]})]})]})})}function R7e({primaryId:t,additionalIds:s,onChange:n}){const[a,i]=y.useState([]),[l,o]=y.useState(!1),[c,d]=y.useState("");y.useEffect(()=>{(async()=>{try{o(!0);const b=await NK({limit:500});i(b.data||[])}catch(b){console.error("Failed to load OT procedures",b)}finally{o(!1)}})()},[]);const u=y.useMemo(()=>{const x=c.trim().toLowerCase();return x?a.filter(b=>{const w=(b.name||"").toLowerCase(),j=(b.code||"").toLowerCase();return w.includes(x)||j.includes(x)}):a},[a,c]),f=x=>{var w;const b=x?Number(x):null;n({primary_procedure_id:b,additional_procedure_ids:s||[],primary_procedure_name:b&&((w=a.find(j=>j.id===b))==null?void 0:w.name)||""})},m=x=>{const b=new Set(s||[]);b.has(x)?b.delete(x):b.add(x),n({primary_procedure_id:t||null,additional_procedure_ids:Array.from(b)})};return r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Procedures (from master)"}),r.jsxs("div",{className:"relative w-40",children:[r.jsx(is,{className:"pointer-events-none absolute left-2 top-1.5 h-3.5 w-3.5 text-slate-400"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white pl-7 pr-1.5 py-1 text-[11px] text-slate-800 placeholder:text-slate-400 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",placeholder:"Search...",value:c,onChange:x=>d(x.target.value)})]})]}),r.jsxs("div",{className:"space-y-2 rounded-xl border border-slate-200 bg-slate-50/60 p-2",children:[l&&r.jsx("div",{className:"text-[11px] text-slate-500",children:"Loading procedures..."}),!l&&u.length===0&&r.jsx("div",{className:"text-[11px] text-slate-500",children:"No procedures found."}),!l&&u.length>0&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-1.5 text-[11px] font-medium text-slate-600",children:[r.jsx(Pb,{className:"h-3 w-3"}),"Primary procedure"]}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:t||"",onChange:x=>f(x.target.value),children:[r.jsx("option",{value:"",children:"Not selected"}),u.map(x=>r.jsx("option",{value:x.id,children:(x.code?x.code+"  ":"")+x.name},x.id))]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("div",{className:"text-[11px] font-medium text-slate-600",children:"Additional procedures"}),r.jsx("div",{className:"max-h-32 space-y-1 overflow-auto rounded-lg border border-slate-100 bg-white p-1.5 text-[11px]",children:u.map(x=>{const b=(s||[]).includes(x.id);return r.jsxs("label",{className:"flex cursor-pointer items-center gap-1.5 rounded-md px-1 py-0.5 hover:bg-slate-50",children:[r.jsx("input",{type:"checkbox",className:"h-3 w-3 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:b,onChange:()=>m(x.id)}),r.jsx("span",{className:"truncate",children:(x.code?x.code+"  ":"")+x.name})]},x.id)})})]})]})]})]})}function L7e(){const t=tt("ot.schedule.view"),s=tt("ot.schedule.create"),n=tt("ot.schedule.update"),a=tt("ot.cases.close")||tt("ot.cases.update"),[i,l]=y.useState(A7e(new Date)),[o,c]=y.useState(null),[d,u]=y.useState([]),[f,m]=y.useState(!1),[x,b]=y.useState(null),[w,j]=y.useState(!1),[_,C]=y.useState("create"),[k,A]=y.useState(null),T=Ta(),P=async()=>{if(i)try{m(!0),b(null);const B=await BLe({date:i,bedId:o||void 0});u(B.data||[])}catch(B){console.error("Failed to load OT schedule",B),b("Failed to load OT schedule")}finally{m(!1)}},R=async B=>{var L;try{if(B.case_id){T(`/ot/cases/${B.case_id}`);return}const F=await C7e(B.id),V=(L=F==null?void 0:F.data)==null?void 0:L.id;await P(),V?T(`/ot/cases/${V}`):console.warn("No case id returned from open-case response",F)}catch(F){console.error("Failed to open OT case",F)}};y.useEffect(()=>{t&&P()},[i,o,t]);const I=async B=>{var L,F,V,U,z;if(!B.case_id){(L=ie.error)==null||L.call(ie,"No OT case opened for this schedule yet.");return}try{await zLe(B.case_id,{outcome:"Completed"}),(F=ie.success)==null||F.call(ie,"OT case marked as Completed"),await P()}catch(W){console.error("Failed to mark OT case as completed",W);const q=((U=(V=W==null?void 0:W.response)==null?void 0:V.data)==null?void 0:U.detail)||(W==null?void 0:W.message)||"Failed to update OT status";(z=ie.error)==null||z.call(ie,q)}},O=()=>{s&&(C("create"),A(null),j(!0))},M=B=>{n&&(C("edit"),A(B),j(!0))};return t?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex h-full flex-col gap-3 p-4",children:[r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-semibold text-slate-900",children:"OT Schedule (Beds)"}),r.jsx("p",{className:"text-xs text-slate-500",children:"View and manage OT bookings by date and bed / location, aligned with NABH OT records."})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-1.5",children:[r.jsx(Kn,{className:"h-4 w-4 text-slate-500"}),r.jsx("input",{type:"date",className:"border-none bg-transparent text-xs text-slate-800 focus:outline-none",value:i,onChange:B=>l(B.target.value)})]}),r.jsxs("button",{type:"button",onClick:P,className:"inline-flex items-center gap-1.5 rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 hover:border-sky-500 hover:text-sky-700",children:[r.jsx(hu,{className:"h-3.5 w-3.5"}),"Refresh"]}),s&&r.jsxs("button",{type:"button",onClick:O,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700",children:[r.jsx(us,{className:"h-3.5 w-3.5"}),"New Schedule"]})]})]}),x&&r.jsx("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-2 text-xs text-rose-700",children:x}),r.jsxs("div",{className:"grid h-[calc(100vh-170px)] grid-cols-1 gap-3 md:grid-cols-[minmax(260px,0.32fr)_minmax(0,0.68fr)]",children:[r.jsx(M7e,{selectedBedId:o,onSelectBed:c}),r.jsx(D7e,{schedules:d,loading:f,date:i,bedId:o,onEdit:M,onOpenCase:R,onMarkSuccess:a?I:void 0})]})]}),r.jsx(O7e,{open:w,mode:_,onClose:()=>j(!1),onSaved:P,defaultDate:i,defaultBedId:o,editingSchedule:k})]}):r.jsx("div",{className:"p-4",children:r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-sm text-amber-800",children:"You do not have permission to view OT schedules."})})}const B7e=t=>t===!0||t==="true"||t===1||t==="1";function _K({open:t,title:s,subtitle:n,onClose:a,children:i}){return t?r.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-slate-900/40 backdrop-blur-sm",children:r.jsxs("div",{className:"relative w-full max-w-2xl rounded-2xl bg-white shadow-xl",children:[r.jsxs("div",{className:"flex items-start justify-between border-b px-5 py-3.5",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:s}),n&&r.jsx("p",{className:"text-xs text-slate-500",children:n})]}),r.jsx("button",{type:"button",onClick:a,className:"rounded-full p-1 text-slate-400 hover:bg-slate-100 hover:text-slate-600",children:r.jsx(Rn,{className:"h-4 w-4"})})]}),i]})}):null}function F7e(){const t=tt("ot.masters.view")||tt("ot.specialities.view"),s=tt("ot.masters.manage")||tt("ot.specialities.create")||tt("ot.specialities.update"),[n,a]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(null),[d,u]=y.useState(""),[f,m]=y.useState(!1),[x,b]=y.useState(null),[w,j]=y.useState(!1),[_,C]=y.useState(null),[k,A]=y.useState({name:"",code:"",description:"",is_active:!0}),T=y.useMemo(()=>{const B=d.trim().toLowerCase();return B?n.filter(L=>(L.name||"").toLowerCase().includes(B)||(L.code||"").toLowerCase().includes(B)):n},[n,d]),P=async()=>{if(t)try{l(!0),c(null);const B=await wK({});a(B.data||[])}catch(B){console.error("Failed to load OT specialities",B),c("Failed to load OT specialities")}finally{l(!1)}};y.useEffect(()=>{P()},[t]);const R=()=>{b(null),A({name:"",code:"",description:"",is_active:!0}),C(null),m(!0)},I=B=>{b(B),A({name:B.name||"",code:B.code||"",description:B.description||"",is_active:B7e(B.is_active)}),C(null),m(!0)},O=async B=>{var L,F;if(B.preventDefault(),!k.name){C("Please enter speciality name");return}if(!k.code){C("Please enter code");return}j(!0),C(null);try{const V={name:k.name,code:k.code,description:k.description||null,is_active:!!k.is_active};x?await ILe(x.id,V):await PLe(V),m(!1),b(null),P()}catch(V){console.error("Failed to save OT speciality",V);const U=((F=(L=V==null?void 0:V.response)==null?void 0:L.data)==null?void 0:F.detail)||(V==null?void 0:V.message)||"Failed to save speciality";C(U)}finally{j(!1)}},M=async B=>{if(window.confirm(`Delete speciality "${B.name}"?`))try{await MLe(B.id),P()}catch(L){console.error("Failed to delete OT speciality",L),alert("Failed to delete")}};return t?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex flex-col gap-3",children:[r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-slate-700",children:[r.jsx(mte,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-semibold",children:"OT Specialities"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx(is,{className:"absolute left-2 top-2 h-3.5 w-3.5 text-slate-400"}),r.jsx("input",{type:"text",className:"w-44 rounded-lg border border-slate-200 bg-white pl-7 pr-2 py-1.5 text-xs text-slate-800 placeholder:text-slate-400 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",placeholder:"Search...",value:d,onChange:B=>u(B.target.value)})]}),s&&r.jsxs("button",{type:"button",onClick:R,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700",children:[r.jsx(us,{className:"h-3.5 w-3.5"}),"New"]})]})]}),o&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:o}),r.jsx("div",{className:"overflow-hidden rounded-2xl border bg-white",children:r.jsxs("table",{className:"min-w-full text-left text-xs text-slate-700",children:[r.jsx("thead",{className:"bg-slate-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Code"}),r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Name"}),r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Description"}),r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Active"}),r.jsx("th",{className:"px-4 py-2 text-right text-[11px] font-semibold text-slate-500",children:"Actions"})]})}),r.jsxs("tbody",{children:[i&&r.jsx(r.Fragment,{children:Array.from({length:4}).map((B,L)=>r.jsx("tr",{className:"animate-pulse border-t",children:Array.from({length:5}).map((F,V)=>r.jsx("td",{className:"px-4 py-2",children:r.jsx("div",{className:"h-3 w-3/4 rounded bg-slate-100"})},V))},L))}),!i&&T.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-4 py-6 text-center text-xs text-slate-500",children:r.jsxs("div",{className:"flex flex-col items-center justify-center gap-1",children:[r.jsx(So,{className:"h-4 w-4 text-amber-500"}),r.jsx("span",{children:"No OT specialities found."})]})})}),!i&&T.map(B=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-4 py-2 text-xs font-medium text-slate-800",children:B.code}),r.jsx("td",{className:"px-4 py-2 text-xs text-slate-800",children:B.name}),r.jsx("td",{className:"px-4 py-2 text-xs text-slate-600",children:B.description||""}),r.jsx("td",{className:"px-4 py-2 text-xs",children:r.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium ${B.is_active?"bg-emerald-50 text-emerald-700":"bg-slate-100 text-slate-500"}`,children:B.is_active?"Active":"Inactive"})}),r.jsx("td",{className:"px-4 py-2 text-right text-xs",children:s&&r.jsxs("div",{className:"inline-flex items-center gap-1.5",children:[r.jsxs("button",{type:"button",onClick:()=>I(B),className:"inline-flex items-center gap-1 rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-700 hover:border-sky-400 hover:text-sky-700",children:[r.jsx(Ja,{className:"h-3 w-3"}),"Edit"]}),r.jsxs("button",{type:"button",onClick:()=>M(B),className:"inline-flex items-center gap-1 rounded-lg border border-rose-200 bg-white px-2 py-1 text-[11px] text-rose-600 hover:bg-rose-50",children:[r.jsx(qr,{className:"h-3 w-3"}),"Delete"]})]})})]},B.id))]})]})})]}),r.jsx(_K,{open:f,title:x?"Edit OT Speciality":"New OT Speciality",subtitle:"Map OT workload by speciality for scheduling and reporting.",onClose:()=>m(!1),children:r.jsxs("form",{onSubmit:O,children:[r.jsxs("div",{className:"grid grid-cols-1 gap-3 px-5 py-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"text-xs font-medium text-slate-700",children:["Code ",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:k.code,onChange:B=>A(L=>({...L,code:B.target.value}))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"text-xs font-medium text-slate-700",children:["Name ",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:k.name,onChange:B=>A(L=>({...L,name:B.target.value}))})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Description"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:k.description,onChange:B=>A(L=>({...L,description:B.target.value}))})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{id:"ot_spec_active",type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!k.is_active,onChange:B=>A(L=>({...L,is_active:B.target.checked}))}),r.jsx("label",{htmlFor:"ot_spec_active",className:"text-xs text-slate-700",children:"Active"})]}),_&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:_})]}),r.jsxs("div",{className:"flex items-center justify-end gap-2 border-t px-5 py-3",children:[r.jsx("button",{type:"button",onClick:()=>m(!1),className:"inline-flex items-center gap-1.5 rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-50",disabled:w,children:"Cancel"}),r.jsxs("button",{type:"submit",className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",disabled:w,children:[w&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save"]})]})]})})]}):r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view OT specialities."})}function $7e(){const t=tt("ot.masters.view")||tt("ot.procedures.view"),s=tt("ot.masters.manage")||tt("ot.procedures.create")||tt("ot.procedures.update"),[n,a]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(null),[d,u]=y.useState(""),[f,m]=y.useState([]),[x,b]=y.useState(!1),[w,j]=y.useState(!1),[_,C]=y.useState(null),[k,A]=y.useState(!1),[T,P]=y.useState(null),[R,I]=y.useState({code:"",name:"",speciality_id:"",duration_hours:"",duration_minutes:"",rate_per_hour:"",description:"",is_active:!0}),O=y.useMemo(()=>{const z=d.trim().toLowerCase();return z?n.filter(W=>{var ge;const q=(W.name||"").toLowerCase(),G=(W.code||"").toLowerCase(),se=(((ge=W.speciality)==null?void 0:ge.name)||"").toLowerCase();return q.includes(z)||G.includes(z)||se.includes(z)}):n},[n,d]),M=async()=>{if(t)try{l(!0),c(null);const z=await NK({});a(z.data||[])}catch(z){console.error("Failed to load OT procedures",z),c("Failed to load OT procedures")}finally{l(!1)}},B=async()=>{try{b(!0);const z=await wK({});m(z.data||[])}catch(z){console.error("Failed to load OT specialities for procedures",z)}finally{b(!1)}};y.useEffect(()=>{t&&(M(),B())},[t]);const L=()=>{C(null),I({code:"",name:"",speciality_id:"",duration_hours:"",duration_minutes:"",rate_per_hour:"",description:"",is_active:!0}),P(null),j(!0)},F=z=>{const W=z.default_duration_min??null,q=W!=null?Math.floor(W/60):"",G=W!=null?W%60:"";C(z),I({code:z.code||"",name:z.name||"",speciality_id:z.speciality_id||"",duration_hours:q===0&&G===0?"":String(q||""),duration_minutes:G===0&&q===0?"":String(G||""),rate_per_hour:z.rate_per_hour!=null?String(z.rate_per_hour):"",description:z.description||"",is_active:!!z.is_active}),P(null),j(!0)},V=async z=>{var ke,ee;if(z.preventDefault(),!R.code)return P("Please enter procedure code");if(!R.name)return P("Please enter procedure name");const W=R.duration_hours?Number(R.duration_hours):0,q=R.duration_minutes?Number(R.duration_minutes):0,G=W*60+q,se=G>0?G:null,ge=R.rate_per_hour===""||R.rate_per_hour===null?null:Number(R.rate_per_hour);A(!0),P(null);try{const pe={code:R.code,name:R.name,speciality_id:R.speciality_id?Number(R.speciality_id):null,default_duration_min:se,rate_per_hour:ge,description:R.description||null,is_active:!!R.is_active};_?await OLe(_.id,pe):await DLe(pe),j(!1),C(null),M()}catch(pe){console.error("Failed to save OT procedure",pe);const ue=((ee=(ke=pe==null?void 0:pe.response)==null?void 0:ke.data)==null?void 0:ee.detail)||(pe==null?void 0:pe.message)||"Failed to save procedure";P(ue)}finally{A(!1)}},U=async z=>{if(window.confirm(`Delete procedure "${z.name}"?`))try{await RLe(z.id),M()}catch(W){console.error("Failed to delete OT procedure",W),alert("Failed to delete procedure")}};return t?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex flex-col gap-3",children:[r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-slate-700",children:[r.jsx(Pb,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-semibold",children:"OT Procedures"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx(is,{className:"absolute left-2 top-2 h-3.5 w-3.5 text-slate-400"}),r.jsx("input",{type:"text",className:"w-56 rounded-lg border border-slate-200 bg-white pl-7 pr-2 py-1.5 text-xs text-slate-800 placeholder:text-slate-400 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",placeholder:"Search by code, name, speciality...",value:d,onChange:z=>u(z.target.value)})]}),s&&r.jsxs("button",{type:"button",onClick:L,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700",children:[r.jsx(us,{className:"h-3.5 w-3.5"}),"New"]})]})]}),o&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:o}),r.jsx("div",{className:"overflow-x-auto rounded-2xl border bg-white",children:r.jsxs("table",{className:"min-w-full text-left text-xs text-slate-700",children:[r.jsx("thead",{className:"bg-slate-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Code"}),r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Name"}),r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Speciality"}),r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Default Duration"}),r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Rate / hour"}),r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Active"}),r.jsx("th",{className:"px-4 py-2 text-right text-[11px] font-semibold text-slate-500",children:"Actions"})]})}),r.jsxs("tbody",{children:[i&&r.jsx(r.Fragment,{children:Array.from({length:4}).map((z,W)=>r.jsx("tr",{className:"animate-pulse border-t",children:Array.from({length:7}).map((q,G)=>r.jsx("td",{className:"px-4 py-2",children:r.jsx("div",{className:"h-3 w-3/4 rounded bg-slate-100"})},G))},W))}),!i&&O.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"px-4 py-6 text-center text-xs text-slate-500",children:r.jsxs("div",{className:"flex flex-col items-center justify-center gap-1",children:[r.jsx(So,{className:"h-4 w-4 text-amber-500"}),r.jsx("span",{children:"No OT procedures found."})]})})}),!i&&O.map(z=>{var G;const W=z.default_duration_min??null;let q="";if(W!=null&&W>0){const se=Math.floor(W/60),ge=W%60;q=se>0&&ge>0?`${se}h ${ge}min`:se>0?`${se}h`:`${ge}min`}return r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-4 py-2 text-xs font-medium text-slate-800",children:z.code}),r.jsx("td",{className:"px-4 py-2 text-xs text-slate-800",children:z.name}),r.jsx("td",{className:"px-4 py-2 text-xs text-slate-600",children:((G=z.speciality)==null?void 0:G.name)||z.speciality_id&&`#${z.speciality_id}`||""}),r.jsx("td",{className:"px-4 py-2 text-xs text-slate-600",children:q}),r.jsx("td",{className:"px-4 py-2 text-xs text-slate-600",children:z.rate_per_hour!=null?` ${Number(z.rate_per_hour).toFixed(2)}`:""}),r.jsx("td",{className:"px-4 py-2 text-xs",children:r.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium ${z.is_active?"bg-emerald-50 text-emerald-700":"bg-slate-100 text-slate-500"}`,children:z.is_active?"Active":"Inactive"})}),r.jsx("td",{className:"px-4 py-2 text-right text-xs",children:s&&r.jsxs("div",{className:"inline-flex items-center gap-1.5",children:[r.jsxs("button",{type:"button",onClick:()=>F(z),className:"inline-flex items-center gap-1 rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-700 hover:border-sky-400 hover:text-sky-700",children:[r.jsx(Ja,{className:"h-3 w-3"}),"Edit"]}),r.jsxs("button",{type:"button",onClick:()=>U(z),className:"inline-flex items-center gap-1 rounded-lg border border-rose-200 bg-white px-2 py-1 text-[11px] text-rose-600 hover:bg-rose-50",children:[r.jsx(qr,{className:"h-3 w-3"}),"Delete"]})]})})]},z.id)})]})]})})]}),r.jsx(_K,{open:w,title:_?"Edit OT Procedure":"New OT Procedure",subtitle:"Define procedures with default duration and hour-based rate for billing.",onClose:()=>j(!1),children:r.jsxs("form",{onSubmit:V,children:[r.jsxs("div",{className:"grid grid-cols-1 gap-3 px-5 py-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"text-xs font-medium text-slate-700",children:["Code ",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:R.code,onChange:z=>I(W=>({...W,code:z.target.value}))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"text-xs font-medium text-slate-700",children:["Name ",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:R.name,onChange:z=>I(W=>({...W,name:z.target.value}))})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Default speciality (optional)"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:R.speciality_id,onChange:z=>I(W=>({...W,speciality_id:z.target.value})),children:[r.jsx("option",{value:"",children:"Not mapped"}),f.map(z=>r.jsx("option",{value:z.id,children:(z.code?`${z.code}  `:"")+z.name},z.id))]}),x&&r.jsx("p",{className:"mt-0.5 text-[10px] text-slate-400",children:"Loading specialities..."})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Default duration  hours"}),r.jsx("input",{type:"number",min:"0",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:R.duration_hours,onChange:z=>I(W=>({...W,duration_hours:z.target.value})),placeholder:"e.g., 2"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Default duration  minutes"}),r.jsx("input",{type:"number",min:"0",max:"59",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:R.duration_minutes,onChange:z=>I(W=>({...W,duration_minutes:z.target.value})),placeholder:"e.g., 30"})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Rate per hour ()"}),r.jsx("input",{type:"number",step:"0.01",min:"0",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:R.rate_per_hour,onChange:z=>I(W=>({...W,rate_per_hour:z.target.value})),placeholder:"e.g., 5000"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Description / notes"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:R.description,onChange:z=>I(W=>({...W,description:z.target.value})),placeholder:"E.g., Includes surgeon charges only; anaesthesia separate."})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{id:"ot_proc_active",type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!R.is_active,onChange:z=>I(W=>({...W,is_active:z.target.checked}))}),r.jsx("label",{htmlFor:"ot_proc_active",className:"text-xs text-slate-700",children:"Active"})]}),T&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:T})]}),r.jsxs("div",{className:"flex items-center justify-end gap-2 border-t px-5 py-3",children:[r.jsx("button",{type:"button",onClick:()=>j(!1),className:"inline-flex items-center gap-1.5 rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-50",disabled:k,children:"Cancel"}),r.jsxs("button",{type:"submit",className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",disabled:k,children:[k&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save"]})]})]})})]}):r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view OT procedure masters."})}const z7e=[{id:"specialities",label:"Specialities"},{id:"procedures",label:"Procedures"}];function U7e(){const[t,s]=y.useState("specialities");return r.jsxs("div",{className:"flex h-full flex-col gap-3 p-4",children:[r.jsx("div",{className:"flex flex-wrap items-center justify-between gap-3",children:r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-semibold text-slate-900",children:"OT Masters"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Configure OT specialities, theatres, equipment, and environment settings as per NABH."})]})}),r.jsx("div",{className:"flex gap-2 border-b border-slate-200",children:z7e.map(n=>{const a=n.id===t;return r.jsxs("button",{type:"button",onClick:()=>s(n.id),className:`relative px-3 py-1.5 text-xs font-medium transition-colors ${a?"text-sky-700":"text-slate-500 hover:text-slate-800"}`,children:[n.label,a&&r.jsx("span",{className:"absolute inset-x-0 bottom-0 h-0.5 rounded-full bg-sky-600"})]},n.id)})}),r.jsxs("div",{className:"flex-1 overflow-auto pt-2",children:[t==="specialities"&&r.jsx(F7e,{}),t==="procedures"&&r.jsx($7e,{})]})]})}const SK=[{value:"",label:"All sessions"},{value:"pre-list",label:"Pre-list"},{value:"between-cases",label:"Between cases"},{value:"end-of-day",label:"End of day"}],gw=t=>t?t.slice(0,10):"";function CK(){const[t,s]=y.useState("cleaning"),[n,a]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(null);return y.useEffect(()=>{(async()=>{try{l(!0),c(null);const u=await LLe({});a(u.data||[])}catch(u){console.error("Failed to load OT theatres for logs",u),c("Failed to load OT theatres (for dropdowns)"),a([])}finally{l(!1)}})()},[]),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-semibold text-slate-900",children:"OT Logs  Cleaning & Environment"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Statutory OT cleaning / turnover and environment monitoring logs (NABH)."}),o&&r.jsxs("p",{className:"mt-1 text-[11px] text-amber-600",children:[o,"  theatre names may not show."]})]}),r.jsxs("div",{className:"inline-flex rounded-full border border-slate-200 bg-slate-50 p-1 text-xs",children:[r.jsx("button",{type:"button",onClick:()=>s("cleaning"),className:`rounded-full px-3 py-1 font-medium transition ${t==="cleaning"?"bg-white text-sky-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Cleaning / Sterility"}),r.jsx("button",{type:"button",onClick:()=>s("environment"),className:`rounded-full px-3 py-1 font-medium transition ${t==="environment"?"bg-white text-sky-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Environment (T/H/P)"})]})]}),t==="cleaning"?r.jsx(V7e,{theatreOptions:n,theatresLoading:i}):r.jsx(W7e,{theatreOptions:n,theatresLoading:i})]})}function V7e({theatreOptions:t,theatresLoading:s}){const n=tt("ot.logs.cleaning.view")||tt("ot.logs.view")||tt("ot.case.view"),a=tt("ot.logs.cleaning.manage")||tt("ot.logs.manage"),[i,l]=y.useState({theatreId:"",caseId:"",date:"",fromDate:"",toDate:"",session:""}),[o,c]=y.useState([]),[d,u]=y.useState(!1),[f,m]=y.useState(null),[x,b]=y.useState(!1),[w,j]=y.useState(null),[_,C]=y.useState(!1),k=y.useCallback(M=>{if(!M)return"";const B=t==null?void 0:t.find(F=>F.id===M);return B?`${B.code||`TH-${B.id}`}  ${B.name||""}`.trim():`#${M}`},[t]),A=y.useCallback(async()=>{if(n)try{u(!0),m(null);const M=await y7e({theatreId:i.theatreId||void 0,caseId:i.caseId||void 0,date:i.date||void 0,fromDate:i.fromDate||void 0,toDate:i.toDate||void 0,session:i.session||void 0});c(M.data||[])}catch(M){console.error("Failed to load cleaning logs",M),m("Failed to load cleaning logs"),c([])}finally{u(!1)}},[n,i]);y.useEffect(()=>{A()},[A]);const T=()=>{j(null),b(!1)},P=M=>{j(M),b(!0)},R=()=>{j(null),b(!0)},I=async M=>{if(a&&window.confirm("Delete this cleaning log entry?"))try{await w7e(M.id),await A()}catch(B){console.error("Failed to delete cleaning log",B),alert("Failed to delete cleaning log entry")}},O=async M=>{var B,L;if(a){C(!0);try{const F={theatre_id:M.theatre_id?Number(M.theatre_id):null,date:M.date||null,session:M.session||null,case_id:M.case_id?Number(M.case_id):null,method:M.method||null,done_by_user_id:M.done_by_user_id?Number(M.done_by_user_id):null,remarks:M.remarks||null};w!=null&&w.id?await v7e(w.id,F):await b7e(F),await A(),T()}catch(F){console.error("Failed to save cleaning log",F),alert(((L=(B=F==null?void 0:F.response)==null?void 0:B.data)==null?void 0:L.detail)||"Failed to save cleaning log. Please check required fields.")}finally{C(!1)}}};return n?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 text-xs",children:[r.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-slate-800",children:[r.jsx(Pb,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-semibold",children:"OT Cleaning / Sterility Logs"})]}),a&&r.jsxs("button",{type:"button",onClick:R,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700",children:[r.jsx(us,{className:"h-3 w-3"}),"New cleaning log"]})]}),r.jsxs("div",{className:"mb-3 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[r.jsxs("div",{className:"mb-1 flex items-center gap-2 text-[11px] font-medium text-slate-600",children:[r.jsx(Ei,{className:"h-3 w-3"}),"Filters"]}),r.jsxs("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-5",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Theatre"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.theatreId,onChange:M=>l(B=>({...B,theatreId:M.target.value})),children:[r.jsx("option",{value:"",children:"All theatres"}),t==null?void 0:t.map(M=>r.jsx("option",{value:M.id,children:(M.code||`TH-${M.id}`)+(M.name?`  ${M.name}`:"")},M.id))]}),s&&r.jsx("p",{className:"mt-0.5 text-[10px] text-slate-400",children:"Loading theatres..."})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Case ID"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.caseId,onChange:M=>l(B=>({...B,caseId:M.target.value}))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Date"}),r.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.date,onChange:M=>l(B=>({...B,date:M.target.value}))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"From"}),r.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.fromDate,onChange:M=>l(B=>({...B,fromDate:M.target.value}))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"To"}),r.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.toDate,onChange:M=>l(B=>({...B,toDate:M.target.value}))})]})]}),r.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[r.jsx("select",{className:"w-full max-w-xs rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.session,onChange:M=>l(B=>({...B,session:M.target.value})),children:SK.map(M=>r.jsx("option",{value:M.value,children:M.label},M.value))}),r.jsx("button",{type:"button",onClick:A,className:"rounded-lg border border-slate-300 bg-white px-3 py-1 text-[11px] font-medium text-slate-700 hover:bg-slate-100",children:"Apply"}),r.jsx("button",{type:"button",onClick:()=>l({theatreId:"",caseId:"",date:"",fromDate:"",toDate:"",session:""}),className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-1 text-[11px] text-slate-500 hover:bg-slate-100",children:"Clear"})]})]}),d&&r.jsx("div",{className:"text-xs text-slate-500",children:"Loading cleaning logs..."}),f&&r.jsx("div",{className:"mb-2 rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:f}),r.jsx("div",{className:"max-h-80 overflow-auto rounded-xl border bg-slate-50",children:r.jsxs("table",{className:"min-w-full text-left text-[11px] text-slate-700",children:[r.jsx("thead",{className:"bg-slate-100",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-1.5",children:"Date"}),r.jsx("th",{className:"px-3 py-1.5",children:"Theatre"}),r.jsx("th",{className:"px-3 py-1.5",children:"Session"}),r.jsx("th",{className:"px-3 py-1.5",children:"Case ID"}),r.jsx("th",{className:"px-3 py-1.5",children:"Method"}),r.jsx("th",{className:"px-3 py-1.5",children:"Done by (user id)"}),r.jsx("th",{className:"px-3 py-1.5",children:"Remarks"}),a&&r.jsx("th",{className:"px-3 py-1.5 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[!d&&o.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:a?8:7,className:"px-3 py-2 text-center text-[11px] text-slate-500",children:"No cleaning logs found for the selected filters."})}),!d&&o.map(M=>r.jsxs("tr",{className:"border-t border-slate-100",children:[r.jsx("td",{className:"px-3 py-1.5",children:gw(M.date)||""}),r.jsx("td",{className:"px-3 py-1.5",children:k(M.theatre_id)||""}),r.jsx("td",{className:"px-3 py-1.5",children:M.session||""}),r.jsx("td",{className:"px-3 py-1.5",children:M.case_id||""}),r.jsx("td",{className:"px-3 py-1.5",children:M.method||""}),r.jsx("td",{className:"px-3 py-1.5",children:M.done_by_user_id||""}),r.jsx("td",{className:"px-3 py-1.5",children:M.remarks||""}),a&&r.jsx("td",{className:"px-3 py-1.5 text-right",children:r.jsxs("div",{className:"inline-flex gap-1",children:[r.jsxs("button",{type:"button",onClick:()=>P(M),className:"inline-flex items-center gap-1 rounded-lg border border-slate-300 bg-white px-2 py-0.5 text-[10px] text-slate-700 hover:bg-slate-100",children:[r.jsx(g7,{className:"h-3 w-3"}),"Edit"]}),r.jsxs("button",{type:"button",onClick:()=>I(M),className:"inline-flex items-center gap-1 rounded-lg border border-rose-200 bg-white px-2 py-0.5 text-[10px] text-rose-600 hover:bg-rose-50",children:[r.jsx(qr,{className:"h-3 w-3"}),"Delete"]})]})})]},M.id))]})]})})]}),x&&r.jsx(H7e,{initial:w,onClose:T,onSave:O,saving:_,theatreOptions:t})]}):r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view OT cleaning logs."})}function H7e({initial:t,onClose:s,onSave:n,saving:a,theatreOptions:i}){const[l,o]=y.useState({theatre_id:(t==null?void 0:t.theatre_id)??"",date:t!=null&&t.date?gw(t.date):"",session:(t==null?void 0:t.session)??"",case_id:(t==null?void 0:t.case_id)??"",method:(t==null?void 0:t.method)??"",done_by_user_id:(t==null?void 0:t.done_by_user_id)??"",remarks:(t==null?void 0:t.remarks)??""}),c=(u,f)=>{o(m=>({...m,[u]:f}))},d=u=>{u.preventDefault(),n(l)};return r.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-slate-900/40 p-2",children:r.jsxs("div",{className:"w-full max-w-lg rounded-2xl bg-white p-4 text-xs shadow-xl",children:[r.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Pb,{className:"h-4 w-4 text-sky-600"}),r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:t?"Edit cleaning log":"New cleaning log"})]}),r.jsx("button",{type:"button",onClick:s,className:"rounded-full p-1 text-slate-400 hover:bg-slate-100 hover:text-slate-700",children:r.jsx(Rn,{className:"h-4 w-4"})})]}),r.jsxs("form",{onSubmit:d,className:"space-y-2",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Theatre *"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.theatre_id,required:!0,onChange:u=>c("theatre_id",u.target.value),children:[r.jsx("option",{value:"",children:"Select theatre"}),i==null?void 0:i.map(u=>r.jsx("option",{value:u.id,children:(u.code||`TH-${u.id}`)+(u.name?`  ${u.name}`:"")},u.id))]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Date *"}),r.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.date,required:!0,onChange:u=>c("date",u.target.value)})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Session"}),r.jsx("select",{className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.session,onChange:u=>c("session",u.target.value),children:SK.map(u=>r.jsx("option",{value:u.value,children:u.label||""},u.value))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Case ID (optional)"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.case_id,onChange:u=>c("case_id",u.target.value)})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Method / Type *"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",placeholder:"Mopping, fumigation, UV, etc.",value:l.method,required:!0,onChange:u=>c("method",u.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Done by (User ID) *"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.done_by_user_id,required:!0,onChange:u=>c("done_by_user_id",u.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Remarks"}),r.jsx("textarea",{rows:2,className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.remarks,onChange:u=>c("remarks",u.target.value)})]}),r.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[r.jsx("button",{type:"button",onClick:s,className:"rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-[11px] text-slate-600 hover:bg-slate-50",children:"Cancel"}),r.jsxs("button",{type:"submit",disabled:a,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-[11px] font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[a&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save"]})]})]})]})})}function W7e({theatreOptions:t,theatresLoading:s}){const n=tt("ot.logs.environment.view")||tt("ot.logs.view")||tt("ot.case.view"),a=tt("ot.logs.environment.manage")||tt("ot.logs.manage"),[i,l]=y.useState({theatreId:"",date:"",fromDate:"",toDate:""}),[o,c]=y.useState([]),[d,u]=y.useState(!1),[f,m]=y.useState(null),[x,b]=y.useState(!1),[w,j]=y.useState(null),[_,C]=y.useState(!1),k=y.useCallback(M=>{if(!M)return"";const B=t==null?void 0:t.find(F=>F.id===M);return B?`${B.code||`TH-${B.id}`}  ${B.name||""}`.trim():`#${M}`},[t]),A=y.useCallback(async()=>{if(n)try{u(!0),m(null);const M=await N7e({theatreId:i.theatreId||void 0,date:i.date||void 0,fromDate:i.fromDate||void 0,toDate:i.toDate||void 0});c(M.data||[])}catch(M){console.error("Failed to load environment logs",M),m("Failed to load environment logs"),c([])}finally{u(!1)}},[n,i]);y.useEffect(()=>{A()},[A]);const T=()=>{j(null),b(!1)},P=()=>{j(null),b(!0)},R=M=>{j(M),b(!0)},I=async M=>{if(a&&window.confirm("Delete this environment log entry?"))try{await S7e(M.id),await A()}catch(B){console.error("Failed to delete environment log",B),alert("Failed to delete environment log entry")}},O=async M=>{var B,L;if(a){C(!0);try{const F={theatre_id:M.theatre_id?Number(M.theatre_id):null,date:M.date||null,time:M.time||null,temperature_c:M.temperature_c===""?null:Number(M.temperature_c),humidity_percent:M.humidity_percent===""?null:Number(M.humidity_percent),pressure_diff_pa:M.pressure_diff_pa===""?null:Number(M.pressure_diff_pa),logged_by_user_id:M.logged_by_user_id?Number(M.logged_by_user_id):null};w!=null&&w.id?await _7e(w.id,F):await j7e(F),await A(),T()}catch(F){console.error("Failed to save environment log",F),alert(((L=(B=F==null?void 0:F.response)==null?void 0:B.data)==null?void 0:L.detail)||"Failed to save environment log. Please check required fields.")}finally{C(!1)}}};return n?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 text-xs",children:[r.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-slate-800",children:[r.jsx(Tp,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-semibold",children:"OT Environment Logs (Temperature / Humidity / Pressure)"})]}),a&&r.jsxs("button",{type:"button",onClick:P,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700",children:[r.jsx(us,{className:"h-3 w-3"}),"New environment log"]})]}),r.jsxs("div",{className:"mb-3 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[r.jsxs("div",{className:"mb-1 flex items-center gap-2 text-[11px] font-medium text-slate-600",children:[r.jsx(Ei,{className:"h-3 w-3"}),"Filters"]}),r.jsxs("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Theatre"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.theatreId,onChange:M=>l(B=>({...B,theatreId:M.target.value})),children:[r.jsx("option",{value:"",children:"All theatres"}),t==null?void 0:t.map(M=>r.jsx("option",{value:M.id,children:(M.code||`TH-${M.id}`)+(M.name?`  ${M.name}`:"")},M.id))]}),s&&r.jsx("p",{className:"mt-0.5 text-[10px] text-slate-400",children:"Loading theatres..."})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Date"}),r.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.date,onChange:M=>l(B=>({...B,date:M.target.value}))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"From"}),r.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.fromDate,onChange:M=>l(B=>({...B,fromDate:M.target.value}))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"To"}),r.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.toDate,onChange:M=>l(B=>({...B,toDate:M.target.value}))})]})]}),r.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[r.jsx("button",{type:"button",onClick:A,className:"rounded-lg border border-slate-300 bg-white px-3 py-1 text-[11px] font-medium text-slate-700 hover:bg-slate-100",children:"Apply"}),r.jsx("button",{type:"button",onClick:()=>l({theatreId:"",date:"",fromDate:"",toDate:""}),className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-1 text-[11px] text-slate-500 hover:bg-slate-100",children:"Clear"})]})]}),d&&r.jsx("div",{className:"text-xs text-slate-500",children:"Loading environment logs..."}),f&&r.jsx("div",{className:"mb-2 rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:f}),r.jsx("div",{className:"max-h-80 overflow-auto rounded-xl border bg-slate-50",children:r.jsxs("table",{className:"min-w-full text-left text-[11px] text-slate-700",children:[r.jsx("thead",{className:"bg-slate-100",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-1.5",children:"Date"}),r.jsx("th",{className:"px-3 py-1.5",children:"Time"}),r.jsx("th",{className:"px-3 py-1.5",children:"Theatre"}),r.jsx("th",{className:"px-3 py-1.5",children:"Temp (C)"}),r.jsx("th",{className:"px-3 py-1.5",children:"Humidity (%)"}),r.jsx("th",{className:"px-3 py-1.5",children:"Pressure (Pa)"}),r.jsx("th",{className:"px-3 py-1.5",children:"Logged by (user id)"}),a&&r.jsx("th",{className:"px-3 py-1.5 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[!d&&o.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:a?8:7,className:"px-3 py-2 text-center text-[11px] text-slate-500",children:"No environment logs found for the selected filters."})}),!d&&o.map(M=>r.jsxs("tr",{className:"border-t border-slate-100",children:[r.jsx("td",{className:"px-3 py-1.5",children:gw(M.date)||""}),r.jsx("td",{className:"px-3 py-1.5",children:M.time?M.time.slice(0,5):""}),r.jsx("td",{className:"px-3 py-1.5",children:k(M.theatre_id)||""}),r.jsx("td",{className:"px-3 py-1.5",children:M.temperature_c!==null&&M.temperature_c!==void 0?M.temperature_c:""}),r.jsx("td",{className:"px-3 py-1.5",children:M.humidity_percent!==null&&M.humidity_percent!==void 0?M.humidity_percent:""}),r.jsx("td",{className:"px-3 py-1.5",children:M.pressure_diff_pa!==null&&M.pressure_diff_pa!==void 0?M.pressure_diff_pa:""}),r.jsx("td",{className:"px-3 py-1.5",children:M.logged_by_user_id||""}),a&&r.jsx("td",{className:"px-3 py-1.5 text-right",children:r.jsxs("div",{className:"inline-flex gap-1",children:[r.jsxs("button",{type:"button",onClick:()=>R(M),className:"inline-flex items-center gap-1 rounded-lg border border-slate-300 bg-white px-2 py-0.5 text-[10px] text-slate-700 hover:bg-slate-100",children:[r.jsx(g7,{className:"h-3 w-3"}),"Edit"]}),r.jsxs("button",{type:"button",onClick:()=>I(M),className:"inline-flex items-center gap-1 rounded-lg border border-rose-200 bg-white px-2 py-0.5 text-[10px] text-rose-600 hover:bg-rose-50",children:[r.jsx(qr,{className:"h-3 w-3"}),"Delete"]})]})})]},M.id))]})]})})]}),x&&r.jsx(q7e,{initial:w,onClose:T,onSave:O,saving:_,theatreOptions:t})]}):r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view environment logs."})}function q7e({initial:t,onClose:s,onSave:n,saving:a,theatreOptions:i}){const[l,o]=y.useState({theatre_id:(t==null?void 0:t.theatre_id)??"",date:t!=null&&t.date?gw(t.date):"",time:(t==null?void 0:t.time)??"",temperature_c:(t==null?void 0:t.temperature_c)!==null&&(t==null?void 0:t.temperature_c)!==void 0?String(t.temperature_c):"",humidity_percent:(t==null?void 0:t.humidity_percent)!==null&&(t==null?void 0:t.humidity_percent)!==void 0?String(t.humidity_percent):"",pressure_diff_pa:(t==null?void 0:t.pressure_diff_pa)!==null&&(t==null?void 0:t.pressure_diff_pa)!==void 0?String(t.pressure_diff_pa):"",logged_by_user_id:(t==null?void 0:t.logged_by_user_id)??""}),c=(u,f)=>{o(m=>({...m,[u]:f}))},d=u=>{u.preventDefault(),n(l)};return r.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-slate-900/40 p-2",children:r.jsxs("div",{className:"w-full max-w-lg rounded-2xl bg-white p-4 text-xs shadow-xl",children:[r.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Tp,{className:"h-4 w-4 text-sky-600"}),r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:t?"Edit environment log":"New environment log"})]}),r.jsx("button",{type:"button",onClick:s,className:"rounded-full p-1 text-slate-400 hover:bg-slate-100 hover:text-slate-700",children:r.jsx(Rn,{className:"h-4 w-4"})})]}),r.jsxs("form",{onSubmit:d,className:"space-y-2",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Theatre *"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.theatre_id,required:!0,onChange:u=>c("theatre_id",u.target.value),children:[r.jsx("option",{value:"",children:"Select theatre"}),i==null?void 0:i.map(u=>r.jsx("option",{value:u.id,children:(u.code||`TH-${u.id}`)+(u.name?`  ${u.name}`:"")},u.id))]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Date *"}),r.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.date,required:!0,onChange:u=>c("date",u.target.value)})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Time *"}),r.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.time,required:!0,onChange:u=>c("time",u.target.value)})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Temp (C)"}),r.jsx("input",{type:"number",step:"0.1",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.temperature_c,onChange:u=>c("temperature_c",u.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Humidity (%)"}),r.jsx("input",{type:"number",step:"0.1",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.humidity_percent,onChange:u=>c("humidity_percent",u.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Pressure (Pa)"}),r.jsx("input",{type:"number",step:"0.01",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.pressure_diff_pa,onChange:u=>c("pressure_diff_pa",u.target.value)})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Logged by (User ID) *"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.logged_by_user_id,required:!0,onChange:u=>c("logged_by_user_id",u.target.value)})]}),r.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[r.jsx("button",{type:"button",onClick:s,className:"rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-[11px] text-slate-600 hover:bg-slate-50",children:"Cancel"}),r.jsxs("button",{type:"submit",disabled:a,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-[11px] font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[a&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save"]})]})]})]})})}const kK=[{key:"allergy",label:"Allergy"},{key:"consent_form_signed",label:"Consent form signed"},{key:"written_high_risk_signed",label:"Written high risk form signed"},{key:"identity_bands_checked",label:"Identity bands checked"},{key:"npo",label:"Nill per mouth (NPO)"},{key:"pre_medication_given",label:"Pre-medication given"},{key:"test_dose_given",label:"Test dose given"},{key:"bowel_preparation",label:"Bowel preparation"},{key:"bladder_empty_time",label:"Bladder empty time"},{key:"serology_results",label:"Serology results"},{key:"blood_grouping",label:"Blood grouping"},{key:"blood_reservation",label:"Blood reservation"},{key:"patient_files_with_records",label:"Patient IP/OP files, ECG / X-ray with old records"},{key:"pre_anaesthetic_evaluation",label:"Pre-anaesthetic evaluation"},{key:"jewellery_nailpolish_removed",label:"Jewellery, nail polish, make-up removed"},{key:"prosthesis_dentures_wig_contactlens_removed",label:"Prosthesis / dentures / wig / contact lens removed"},{key:"sterile_preparation_done",label:"Sterile preparation done"}],ry=()=>({checklist:kK.reduce((t,s)=>(t[s.key]={handover:!1,receiving:!1,comments:""},t),{}),investigations:{hb:"",platelet:"",urea:"",creatinine:"",potassium:"",rbs:"",other:""},vitals:{temp:"",pulse:"",resp:"",bp:"",spo2:"",height:"",weight:""},shave_completed:null,nurse_signature:""}),G7e=t=>{const s=ry();if(!t||typeof t!="object")return s;const n={...s};return t.checklist&&typeof t.checklist=="object"&&(n.checklist={...s.checklist,...t.checklist}),"patient_identity_confirmed"in t&&(n.checklist.identity_bands_checked={...n.checklist.identity_bands_checked,handover:!!t.patient_identity_confirmed}),"consent_checked"in t&&(n.checklist.consent_form_signed={...n.checklist.consent_form_signed,handover:!!t.consent_checked}),"investigations_checked"in t&&(n.checklist.patient_files_with_records={...n.checklist.patient_files_with_records,handover:!!t.investigations_checked}),"blood_products_arranged"in t&&(n.checklist.blood_reservation={...n.checklist.blood_reservation,handover:!!t.blood_products_arranged}),"implants_available"in t&&(n.checklist.prosthesis_dentures_wig_contactlens_removed={...n.checklist.prosthesis_dentures_wig_contactlens_removed,handover:!!t.implants_available}),"site_marked"in t&&(n.checklist.pre_anaesthetic_evaluation={...n.checklist.pre_anaesthetic_evaluation,handover:!!t.site_marked}),t.fasting_status&&(n.checklist.npo={...n.checklist.npo,comments:t.fasting_status}),t.device_checks&&(n.checklist.pre_anaesthetic_evaluation={...n.checklist.pre_anaesthetic_evaluation,comments:t.device_checks}),t.notes&&(n.checklist.sterile_preparation_done={...n.checklist.sterile_preparation_done,comments:t.notes}),t.investigations&&(n.investigations={...s.investigations,...t.investigations}),t.vitals&&(n.vitals={...s.vitals,...t.vitals}),"shave_completed"in t&&(n.shave_completed=t.shave_completed),"nurse_signature"in t&&(n.nurse_signature=t.nurse_signature||""),n};function K7e({caseId:t}){const s=tt("ot.cases.view")||tt("ot.preop_checklist.view"),n=tt("ot.preop_checklist.update")||tt("ot.preop_checklist.create")||tt("ot.cases.update"),[a,i]=y.useState(null),[l,o]=y.useState(ry),[c,d]=y.useState(!1),[u,f]=y.useState(!1),[m,x]=y.useState(null),b=async()=>{var A;if(s)try{d(!0),x(null);const T=await VLe(t);if(console.log("[PreOp] loaded record",T),!T){i(null),o(ry());return}i(T),o(G7e(T))}catch(T){((A=T==null?void 0:T.response)==null?void 0:A.status)===404?(i(null),o(ry())):(console.error("Failed to load Pre-op checklist",T),x("Failed to load Pre-op checklist"))}finally{d(!1)}};if(y.useEffect(()=>{b()},[t,s]),!s)return r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view pre-operative checklists."});const w=(A,T,P)=>{o(R=>({...R,checklist:{...R.checklist,[A]:{...R.checklist[A],[T]:P}}}))},j=(A,T)=>{o(P=>({...P,investigations:{...P.investigations,[A]:T}}))},_=(A,T)=>{o(P=>({...P,vitals:{...P.vitals,[A]:T}}))},C=async A=>{var T,P;if(A.preventDefault(),!!n){f(!0),x(null);try{const R={checklist:l.checklist,investigations:{...l.investigations},vitals:{...l.vitals},shave_completed:l.shave_completed,nurse_signature:l.nurse_signature||null,patient_identity_confirmed:!!l.checklist.identity_bands_checked.handover,consent_checked:!!l.checklist.consent_form_signed.handover,investigations_checked:!!l.checklist.patient_files_with_records.handover,blood_products_arranged:!!l.checklist.blood_reservation.handover,implants_available:!!l.checklist.prosthesis_dentures_wig_contactlens_removed.handover,site_marked:!!l.checklist.pre_anaesthetic_evaluation.handover,fasting_status:l.checklist.npo.comments||null,device_checks:l.checklist.pre_anaesthetic_evaluation.comments||null,notes:l.checklist.sterile_preparation_done.comments||null,completed:!1};a?await WLe(t,R):await HLe(t,R),await b()}catch(R){console.error("Failed to save Pre-op checklist",R);const I=((P=(T=R==null?void 0:R.response)==null?void 0:T.data)==null?void 0:P.detail)||(R==null?void 0:R.message)||"Failed to save Pre-op checklist";x(I)}finally{f(!1)}}},k=(a==null?void 0:a.completed_at)||(a==null?void 0:a.updated_at)||(a==null?void 0:a.created_at);return r.jsxs("form",{onSubmit:C,className:"space-y-4 rounded-2xl border bg-white px-4 py-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sky-800",children:[r.jsx(Vte,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-semibold",children:"Pre-operative checklist"})]}),k&&r.jsxs("span",{className:"rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] text-emerald-700",children:["Last saved: ",new Date(k).toLocaleString()]})]}),c&&r.jsx("div",{className:"text-xs text-slate-500",children:"Loading pre-op data..."}),m&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:m}),r.jsx("div",{className:"overflow-x-auto rounded-xl border border-slate-200",children:r.jsxs("table",{className:"min-w-full text-xs",children:[r.jsx("thead",{className:"bg-slate-50 text-[11px] font-semibold uppercase text-slate-600",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left",children:"Item"}),r.jsx("th",{className:"px-3 py-2 text-center",children:"Handing over nurse"}),r.jsx("th",{className:"px-3 py-2 text-center",children:"Receiving nurse"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Comments"})]})}),r.jsx("tbody",{children:kK.map((A,T)=>{const P=l.checklist[A.key],R=T%2===0?"bg-white":"bg-slate-50/60";return r.jsxs("tr",{className:R,children:[r.jsx("td",{className:"px-3 py-1.5 text-slate-800",children:A.label}),r.jsx("td",{className:"px-3 py-1.5 text-center",children:r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!P.handover,disabled:!n,onChange:I=>w(A.key,"handover",I.target.checked)})}),r.jsx("td",{className:"px-3 py-1.5 text-center",children:r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!P.receiving,disabled:!n,onChange:I=>w(A.key,"receiving",I.target.checked)})}),r.jsx("td",{className:"px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",placeholder:"Comments / remarks",value:P.comments||"",disabled:!n,onChange:I=>w(A.key,"comments",I.target.value)})})]},A.key)})})]})}),r.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-2 rounded-xl border border-slate-200 bg-slate-50/60 p-3",children:[r.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Investigations"}),[["hb","HB"],["platelet","Platelet"],["urea","Urea"],["creatinine","Creatinine"],["potassium","Potassium"],["rbs","RBS"],["other","Others"]].map(([A,T])=>r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"w-24 text-[11px] font-medium text-slate-700",children:[T," :"]}),r.jsx("input",{type:"text",className:"flex-1 rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.investigations[A],disabled:!n,onChange:P=>j(A,P.target.value)})]},A))]}),r.jsxs("div",{className:"space-y-2 rounded-xl border border-slate-200 bg-slate-50/60 p-3",children:[r.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Vitals"}),[["temp","Temp"],["pulse","Pulse"],["resp","Resp"],["bp","BP"],["spo2","SpO"],["height","Height"],["weight","Weight"]].map(([A,T])=>r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"w-24 text-[11px] font-medium text-slate-700",children:[T," :"]}),r.jsx("input",{type:"text",className:"flex-1 rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.vitals[A],disabled:!n,onChange:P=>_(A,P.target.value)})]},A))]})]}),r.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx("div",{className:"text-xs font-medium text-slate-700",children:"Shave completed"}),r.jsxs("div",{className:"flex gap-3 text-xs",children:[r.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[r.jsx("input",{type:"radio",className:"h-3.5 w-3.5 border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.shave_completed==="yes",disabled:!n,onChange:()=>o(A=>({...A,shave_completed:"yes"}))}),r.jsx("span",{children:"Yes"})]}),r.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[r.jsx("input",{type:"radio",className:"h-3.5 w-3.5 border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.shave_completed==="no",disabled:!n,onChange:()=>o(A=>({...A,shave_completed:"no"}))}),r.jsx("span",{children:"No"})]})]}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"(Body diagram marking can be handled in PDF / print layout.)"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Signature with name (nurse)"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",placeholder:"Name & signature",value:l.nurse_signature,disabled:!n,onChange:A=>o(T=>({...T,nurse_signature:A.target.value}))})]})]}),n&&r.jsx("div",{className:"flex justify-end",children:r.jsxs("button",{type:"submit",disabled:u,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[u&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save Pre-op checklist"]})})]})}function Y7e(t){if(!t)return null;const s=new Date(t);return Number.isNaN(s.getTime())?null:s}function X7e(t){const s=Y7e(t);return s?s.toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):""}function a2(t){if(!t)return"";if(/^\d{2}:\d{2}$/.test(t))return t;const s=new Date(t);return Number.isNaN(s.getTime())?"":s.toISOString().slice(11,16)}const AK={identity_site_procedure_consent_confirmed:!1,site_marked:"",machine_and_medication_check_complete:!1,known_allergy:"",difficult_airway_or_aspiration_risk:"",blood_loss_risk_gt500ml_or_7mlkg:"",equipment_assistance_available:!1,iv_central_access_and_fluids_planned:!1},EK={team_members_introduced:!1,patient_name_procedure_incision_site_confirmed:!1,antibiotic_prophylaxis_given:"",surgeon_critical_steps:"",surgeon_case_duration_estimate:"",surgeon_anticipated_blood_loss:"",anaesthetist_patient_specific_concerns:"",sterility_confirmed:!1,equipment_issues_or_concerns:!1,essential_imaging_displayed:""},TK={procedure_name_confirmed:!1,counts_complete:!1,specimens_labelled_correctly:!1,equipment_problems_to_be_addressed:"",key_concerns_for_recovery_and_management:""},i2={sign_in_done:!1,sign_in_time:"",time_out_done:!1,time_out_time:"",sign_out_done:!1,sign_out_time:"",sign_in:AK,time_out:EK,sign_out:TK};function Q7e({caseId:t}){const s=tt("ot.cases.view")||tt("ot.safety.view"),n=tt("ot.safety.manage")||tt("ot.cases.update"),[a,i]=y.useState(null),[l,o]=y.useState(i2),[c,d]=y.useState(!1),[u,f]=y.useState(!1),[m,x]=y.useState(null),b=async()=>{var k;if(s)try{d(!0),x(null);const T=(await qLe(t)).data;if(!T){i(null),o(i2);return}i(T),o({sign_in_done:!!T.sign_in_done,sign_in_time:a2(T.sign_in_time),time_out_done:!!T.time_out_done,time_out_time:a2(T.time_out_time),sign_out_done:!!T.sign_out_done,sign_out_time:a2(T.sign_out_time),sign_in:{...AK,...T.sign_in||{}},time_out:{...EK,...T.time_out||{}},sign_out:{...TK,...T.sign_out||{}}})}catch(A){((k=A==null?void 0:A.response)==null?void 0:k.status)===404?(i(null),o(i2)):(console.error("Failed to load Surgical Safety checklist",A),x("Failed to load Surgical Safety checklist"))}finally{d(!1)}};if(y.useEffect(()=>{b()},[t,s]),!s)return r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view Surgical Safety Checklist."});const w=(k,A)=>{o(T=>({...T,[k]:A}))},j=(k,A,T)=>{o(P=>({...P,[k]:{...P[k],[A]:T}}))},_=async k=>{var A,T;if(k.preventDefault(),!!n){f(!0),x(null);try{const P={sign_in_done:!!l.sign_in_done,sign_in_time:l.sign_in_time||null,time_out_done:!!l.time_out_done,time_out_time:l.time_out_time||null,sign_out_done:!!l.sign_out_done,sign_out_time:l.sign_out_time||null,sign_in:l.sign_in,time_out:l.time_out,sign_out:l.sign_out};a?await KLe(t,P):await GLe(t,P),await b()}catch(P){console.error("Failed to save Surgical Safety checklist",P);const R=((T=(A=P==null?void 0:P.response)==null?void 0:A.data)==null?void 0:T.detail)||(P==null?void 0:P.message)||"Failed to save Surgical Safety checklist";x(R)}finally{f(!1)}}},C=(a==null?void 0:a.updated_at)||(a==null?void 0:a.created_at);return r.jsxs("form",{onSubmit:_,className:"space-y-4 rounded-2xl border bg-white px-4 py-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sky-800",children:[r.jsx(Aa,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-semibold",children:"WHO Surgical Safety Checklist"})]}),C&&r.jsxs("span",{className:"rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] text-emerald-700",children:["Last updated: ",X7e(C)]})]}),c&&r.jsx("div",{className:"text-xs text-slate-500",children:"Loading Surgical Safety data..."}),m&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:m}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs",children:[r.jsx("div",{className:"mb-1 text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:"Sign in (before induction)"}),r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!l.sign_in_done,disabled:!n,onChange:k=>w("sign_in_done",k.target.checked)}),r.jsx("span",{children:"Checklist completed"})]}),r.jsxs("div",{className:"mt-2 space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Time"}),r.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.sign_in_time,disabled:!n,onChange:k=>w("sign_in_time",k.target.value)})]})]}),r.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs",children:[r.jsx("div",{className:"mb-1 text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:"Time out (before skin incision)"}),r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!l.time_out_done,disabled:!n,onChange:k=>w("time_out_done",k.target.checked)}),r.jsx("span",{children:"Checklist completed"})]}),r.jsxs("div",{className:"mt-2 space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Time"}),r.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.time_out_time,disabled:!n,onChange:k=>w("time_out_time",k.target.value)})]})]}),r.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs",children:[r.jsx("div",{className:"mb-1 text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:"Sign out (before patient leaves OT)"}),r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!l.sign_out_done,disabled:!n,onChange:k=>w("sign_out_done",k.target.checked)}),r.jsx("span",{children:"Checklist completed"})]}),r.jsxs("div",{className:"mt-2 space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Time"}),r.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.sign_out_time,disabled:!n,onChange:k=>w("sign_out_time",k.target.value)})]})]})]}),r.jsxs("div",{className:"space-y-2 rounded-2xl border border-slate-200 bg-slate-50/60 p-3 text-xs",children:[r.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Before induction of anaesthesia"}),r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_in.identity_site_procedure_consent_confirmed,disabled:!n,onChange:k=>j("sign_in","identity_site_procedure_consent_confirmed",k.target.checked)}),r.jsx("span",{children:"Patient confirmed identity, site, procedure and consent"})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[r.jsx("span",{className:"text-[11px] text-slate-700",children:"Is the site marked?"}),["yes","no","na"].map(k=>r.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[r.jsx("input",{type:"radio",className:"h-3.5 w-3.5 border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_in.site_marked===k,disabled:!n,onChange:()=>j("sign_in","site_marked",k)}),r.jsx("span",{className:"capitalize text-[11px]",children:k==="na"?"Not applicable":k})]},k))]}),r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_in.machine_and_medication_check_complete,disabled:!n,onChange:k=>j("sign_in","machine_and_medication_check_complete",k.target.checked)}),r.jsx("span",{children:"Anaesthesia machine and medication check complete"})]}),r.jsxs("div",{className:"flex flex-wrap gap-4",children:[r.jsx("span",{className:"text-[11px] text-slate-700",children:"Does the patient have a known allergy?"}),["yes","no"].map(k=>r.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[r.jsx("input",{type:"radio",className:"h-3.5 w-3.5 border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_in.known_allergy===k,disabled:!n,onChange:()=>j("sign_in","known_allergy",k)}),r.jsx("span",{className:"capitalize text-[11px]",children:k})]},k))]}),r.jsxs("div",{className:"flex flex-wrap gap-4",children:[r.jsx("span",{className:"text-[11px] text-slate-700",children:"Difficult airway or aspiration risk?"}),["yes","no"].map(k=>r.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[r.jsx("input",{type:"radio",className:"h-3.5 w-3.5 border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_in.difficult_airway_or_aspiration_risk===k,disabled:!n,onChange:()=>j("sign_in","difficult_airway_or_aspiration_risk",k)}),r.jsx("span",{className:"capitalize text-[11px]",children:k})]},k))]}),r.jsxs("div",{className:"flex flex-wrap gap-4",children:[r.jsx("span",{className:"text-[11px] text-slate-700",children:"Risk of > 500 ml blood loss (7 ml/kg in children)?"}),["yes","no"].map(k=>r.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[r.jsx("input",{type:"radio",className:"h-3.5 w-3.5 border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_in.blood_loss_risk_gt500ml_or_7mlkg===k,disabled:!n,onChange:()=>j("sign_in","blood_loss_risk_gt500ml_or_7mlkg",k)}),r.jsx("span",{className:"capitalize text-[11px]",children:k})]},k))]}),r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_in.equipment_assistance_available,disabled:!n,onChange:k=>j("sign_in","equipment_assistance_available",k.target.checked)}),r.jsx("span",{children:"Yes, and equipment / assistance available"})]}),r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_in.iv_central_access_and_fluids_planned,disabled:!n,onChange:k=>j("sign_in","iv_central_access_and_fluids_planned",k.target.checked)}),r.jsx("span",{children:"Yes, and two IV / central access and fluids planned"})]})]}),r.jsxs("div",{className:"space-y-2 rounded-2xl border border-slate-200 bg-slate-50/60 p-3 text-xs",children:[r.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Before skin incision"}),r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.time_out.team_members_introduced,disabled:!n,onChange:k=>j("time_out","team_members_introduced",k.target.checked)}),r.jsx("span",{children:"All team members (nurse, anaesthetist, surgeon) have introduced themselves by name and role"})]}),r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.time_out.patient_name_procedure_incision_site_confirmed,disabled:!n,onChange:k=>j("time_out","patient_name_procedure_incision_site_confirmed",k.target.checked)}),r.jsx("span",{children:"Patient name, procedure, and incision site confirmed aloud"})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[r.jsx("span",{className:"text-[11px] text-slate-700",children:"Has antibiotic prophylaxis been given in last 60 minutes?"}),["yes","no","na"].map(k=>r.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[r.jsx("input",{type:"radio",className:"h-3.5 w-3.5 border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.time_out.antibiotic_prophylaxis_given===k,disabled:!n,onChange:()=>j("time_out","antibiotic_prophylaxis_given",k)}),r.jsx("span",{className:"capitalize text-[11px]",children:k==="na"?"Not applicable":k})]},k))]}),r.jsxs("div",{className:"mt-1 grid gap-2 md:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:"To Surgeon  critical or non-routine steps"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.time_out.surgeon_critical_steps,disabled:!n,onChange:k=>j("time_out","surgeon_critical_steps",k.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:"To Surgeon  expected case duration"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.time_out.surgeon_case_duration_estimate,disabled:!n,onChange:k=>j("time_out","surgeon_case_duration_estimate",k.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:"To Surgeon  anticipated blood loss"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.time_out.surgeon_anticipated_blood_loss,disabled:!n,onChange:k=>j("time_out","surgeon_anticipated_blood_loss",k.target.value)})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:"To Anaesthetist  patient-specific concerns"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.time_out.anaesthetist_patient_specific_concerns,disabled:!n,onChange:k=>j("time_out","anaesthetist_patient_specific_concerns",k.target.value)})]}),r.jsxs("div",{className:"grid gap-2 md:grid-cols-3",children:[r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.time_out.sterility_confirmed,disabled:!n,onChange:k=>j("time_out","sterility_confirmed",k.target.checked)}),r.jsx("span",{children:"Sterility (including indicators) confirmed"})]}),r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.time_out.equipment_issues_or_concerns,disabled:!n,onChange:k=>j("time_out","equipment_issues_or_concerns",k.target.checked)}),r.jsx("span",{children:"Any equipment issues or concerns"})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[r.jsx("span",{className:"text-[11px] text-slate-700",children:"Essential imaging displayed?"}),["yes","no","na"].map(k=>r.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[r.jsx("input",{type:"radio",className:"h-3.5 w-3.5 border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.time_out.essential_imaging_displayed===k,disabled:!n,onChange:()=>j("time_out","essential_imaging_displayed",k)}),r.jsx("span",{className:"capitalize text-[11px]",children:k==="na"?"Not applicable":k})]},k))]})]})]}),r.jsxs("div",{className:"space-y-2 rounded-2xl border border-slate-200 bg-slate-50/60 p-3 text-xs",children:[r.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Before patient leaves operating room"}),r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_out.procedure_name_confirmed,disabled:!n,onChange:k=>j("sign_out","procedure_name_confirmed",k.target.checked)}),r.jsx("span",{children:"Nurse verbally confirms the name of the procedure"})]}),r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_out.counts_complete,disabled:!n,onChange:k=>j("sign_out","counts_complete",k.target.checked)}),r.jsx("span",{children:"Completion of instrument, sponge and needle counts"})]}),r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_out.specimens_labelled_correctly,disabled:!n,onChange:k=>j("sign_out","specimens_labelled_correctly",k.target.checked)}),r.jsx("span",{children:"Specimen labelling / read specimen labels aloud (including patient name)"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:"Whether there are any equipment problems to be addressed"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.sign_out.equipment_problems_to_be_addressed||"",disabled:!n,onChange:k=>j("sign_out","equipment_problems_to_be_addressed",k.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:"To Surgeon, Anaesthetist and Nurse  key concerns for recovery and management of this patient"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2 py-1.5 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.sign_out.key_concerns_for_recovery_and_management||"",disabled:!n,onChange:k=>j("sign_out","key_concerns_for_recovery_and_management",k.target.value)})]})]}),n&&r.jsx("div",{className:"flex justify-end",children:r.jsxs("button",{type:"submit",disabled:u,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[u&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save Safety checklist"]})})]})}const s6={anaesthesia_type:"",asa_grade:"",airway_assessment:"",comorbidities:"",allergies:"",preop_pulse:"",preop_bp:"",preop_rr:"",preop_temp_c:"",preop_cvs:"",preop_rs:"",preop_cns:"",preop_pa:"",preop_veins:"",preop_spine:"",airway_teeth_status:"",airway_denture:"",airway_neck_movements:"",airway_mallampati_class:"",difficult_airway_anticipated:!1,risk_factors:"",anaesthetic_plan_detail:"",preop_instructions:"",preoxygenation:!1,cricoid_pressure:!1,induction_route:"",intubation_done:!1,intubation_route:"",intubation_state:"",intubation_technique:"",tube_type:"",tube_size:"",tube_fixed_at:"",cuff_used:!1,cuff_medium:"",bilateral_breath_sounds:"",added_sounds:"",laryngoscopy_grade:"",airway_devices:[],ventilation_mode_baseline:"",ventilator_vt:"",ventilator_rate:"",ventilator_peep:"",breathing_system:"",monitors:{},lines:{},tourniquet_used:!1,patient_position:"",eyes_taped:!1,eyes_covered_with_foil:!1,pressure_points_padded:!1,iv_fluids_plan:"",blood_components_plan:"",regional_block_type:"",regional_position:"",regional_approach:"",regional_space_depth:"",regional_needle_type:"",regional_drug_dose:"",regional_level:"",regional_complications:"",block_adequacy:"",sedation_needed:!1,conversion_to_ga:!1,notes:""},n6={time:"",hr:"",bp:"",spo2:"",rr:"",temp_c:"",etco2:"",ventilation_mode:"",peak_airway_pressure:"",cvp_pcwp:"",st_segment:"",urine_output_ml:"",blood_loss_ml:"",comments:""},r6={time:"",drug_name:"",dose:"",route:"",remarks:""};function l2(t){if(t==null)return null;const s=String(t).trim();if(!s)return null;const n=parseInt(s,10);return Number.isNaN(n)?null:n}function Z7e({caseId:t}){const[s,n]=y.useState("preop"),[a,i]=y.useState(s6),[l,o]=y.useState({id:null,created_at:null}),[c,d]=y.useState(!0),[u,f]=y.useState(!1),[m,x]=y.useState(null),[b,w]=y.useState(null),[j,_]=y.useState([]),[C,k]=y.useState(n6),[A,T]=y.useState(!1),[P,R]=y.useState([]),[I,O]=y.useState(r6),[M,B]=y.useState(!1);y.useEffect(()=>{let X=!0;return(async()=>{var _e;d(!0),x(null);try{const he=(await YLe(t)).data;if(!X)return;if(i(fe=>({...fe,...he,monitors:he.monitors||{},lines:he.lines||{},airway_devices:he.airway_devices||[]})),o({id:he.id,created_at:he.created_at}),he.id){const[fe,le]=await Promise.all([ZLe(he.id),t7e(he.id)]);if(!X)return;_(fe.data||[]),R(le.data||[])}}catch(ce){((_e=ce==null?void 0:ce.response)==null?void 0:_e.status)===404?(i(s6),o({id:null,created_at:null}),_([]),R([])):(console.error("Anaesthesia load error",ce),x("Unable to load anaesthesia record. Please try again."))}finally{X&&d(!1)}})(),()=>{X=!1}},[t]);const L=y.useMemo(()=>m?r.jsxs("div",{className:"mb-3 flex items-center gap-2 rounded-xl border border-red-200 bg-red-50 px-3 py-2 text-[13px] text-red-700",children:[r.jsx(yn,{className:"h-4 w-4"}),r.jsx("span",{children:m})]}):b?r.jsxs("div",{className:"mb-3 flex items-center gap-2 rounded-xl border border-emerald-200 bg-emerald-50 px-3 py-2 text-[13px] text-emerald-700",children:[r.jsx(Ur,{className:"h-4 w-4"}),r.jsx("span",{children:b})]}):null,[m,b]),F=(X,oe)=>{i(_e=>({..._e,[X]:oe}))},V=X=>{i(oe=>({...oe,[X]:!oe[X]}))},U=X=>{i(oe=>{var _e;return{...oe,monitors:{...oe.monitors||{},[X]:!((_e=oe.monitors)!=null&&_e[X])}}})},z=X=>{i(oe=>{var _e;return{...oe,lines:{...oe.lines||{},[X]:!((_e=oe.lines)!=null&&_e[X])}}})},W=X=>{i(oe=>{const _e=oe.airway_devices||[];return _e.includes(X)?{...oe,airway_devices:_e.filter(ce=>ce!==X)}:{...oe,airway_devices:[..._e,X]}})},q=async()=>{f(!0),x(null),w(null);try{const X={...a,ventilator_vt:l2(a.ventilator_vt),ventilator_rate:l2(a.ventilator_rate),ventilator_peep:l2(a.ventilator_peep)};if(l.id)await QLe(t,X);else{const oe=await XLe(t,X);o({id:oe.data.id,created_at:oe.data.created_at})}w("Anaesthesia record saved.")}catch(X){console.error("Save anaesthesia record error",X),x("Unable to save anaesthesia record.")}finally{f(!1)}},G=async()=>{if(!l.id){x("Save the anaesthesia record before adding vitals.");return}if(!C.time){x("Time is required for vitals (HH:MM).");return}T(!0),x(null),w(null);try{const X={...C,hr:C.hr?Number(C.hr):null,spo2:C.spo2?Number(C.spo2):null,rr:C.rr?Number(C.rr):null,temp_c:C.temp_c?Number(C.temp_c):null,etco2:C.etco2?Number(C.etco2):null,peak_airway_pressure:C.peak_airway_pressure?Number(C.peak_airway_pressure):null,cvp_pcwp:C.cvp_pcwp?Number(C.cvp_pcwp):null,urine_output_ml:C.urine_output_ml?Number(C.urine_output_ml):null,blood_loss_ml:C.blood_loss_ml?Number(C.blood_loss_ml):null},oe=await JLe(l.id,X);_(_e=>[..._e,oe.data]),k(n6),w("Vitals entry added.")}catch(X){console.error("Add vital error",X),x("Unable to add vitals entry.")}finally{T(!1)}},se=async X=>{if(window.confirm("Delete this vitals entry?")){T(!0),x(null),w(null);try{await e7e(X),_(oe=>oe.filter(_e=>_e.id!==X)),w("Vitals entry deleted.")}catch(oe){console.error("Delete vital error",oe),x("Unable to delete vitals entry.")}finally{T(!1)}}},ge=async()=>{if(!l.id){x("Save the anaesthesia record before adding drug log.");return}if(!I.time||!I.drug_name){x("Drug time and name are required.");return}B(!0),x(null),w(null);try{const X=await s7e(l.id,I);R(oe=>[...oe,X.data]),O(r6),w("Drug log entry added.")}catch(X){console.error("Add drug error",X),x("Unable to add drug log entry.")}finally{B(!1)}},ke=async X=>{if(window.confirm("Delete this drug entry?")){B(!0),x(null),w(null);try{await n7e(X),R(oe=>oe.filter(_e=>_e.id!==X)),w("Drug log entry deleted.")}catch(oe){console.error("Delete drug error",oe),x("Unable to delete drug entry.")}finally{B(!1)}}},ee=()=>r.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 shadow-sm",children:[r.jsxs("h3",{className:"mb-1 flex items-center gap-2 text-sm font-semibold text-slate-900",children:[r.jsx(dr,{className:"h-4 w-4"}),"Pre-anaesthetic assessment"]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 text-[12px] sm:grid-cols-2",children:[r.jsx(kt,{label:"ASA Grade",value:a.asa_grade,onChange:X=>F("asa_grade",X)}),r.jsx(kt,{label:"Anaesthesia type",value:a.anaesthesia_type,onChange:X=>F("anaesthesia_type",X)}),r.jsx(kt,{label:"Co-morbidities",value:a.comorbidities,onChange:X=>F("comorbidities",X)}),r.jsx(kt,{label:"Allergies",value:a.allergies,onChange:X=>F("allergies",X)})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3 text-[12px] md:grid-cols-4",children:[r.jsx(kt,{label:"Pulse",value:a.preop_pulse,onChange:X=>F("preop_pulse",X)}),r.jsx(kt,{label:"BP",value:a.preop_bp,onChange:X=>F("preop_bp",X)}),r.jsx(kt,{label:"RR",value:a.preop_rr,onChange:X=>F("preop_rr",X)}),r.jsx(kt,{label:"Temp (C)",value:a.preop_temp_c,onChange:X=>F("preop_temp_c",X)})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 text-[12px] sm:grid-cols-2",children:[r.jsx(kt,{label:"CVS",value:a.preop_cvs,onChange:X=>F("preop_cvs",X)}),r.jsx(kt,{label:"RS",value:a.preop_rs,onChange:X=>F("preop_rs",X)}),r.jsx(kt,{label:"CNS",value:a.preop_cns,onChange:X=>F("preop_cns",X)}),r.jsx(kt,{label:"PA",value:a.preop_pa,onChange:X=>F("preop_pa",X)}),r.jsx(kt,{label:"Veins",value:a.preop_veins,onChange:X=>F("preop_veins",X)}),r.jsx(kt,{label:"Spine",value:a.preop_spine,onChange:X=>F("preop_spine",X)})]})]}),r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 shadow-sm",children:[r.jsxs("h3",{className:"mb-1 flex items-center gap-2 text-sm font-semibold text-slate-900",children:[r.jsx(sn,{className:"h-4 w-4"}),"Airway & risk"]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 text-[12px] sm:grid-cols-2",children:[r.jsx(kt,{label:"Teeth",placeholder:"Intact / Loose",value:a.airway_teeth_status,onChange:X=>F("airway_teeth_status",X)}),r.jsx(kt,{label:"Denture",placeholder:"Present / Absent",value:a.airway_denture,onChange:X=>F("airway_denture",X)}),r.jsx(kt,{label:"Neck movements",value:a.airway_neck_movements,onChange:X=>F("airway_neck_movements",X)}),r.jsx(kt,{label:"Mallampati class",placeholder:"Class 1 / 2 / 3 / 4",value:a.airway_mallampati_class,onChange:X=>F("airway_mallampati_class",X)})]}),r.jsx("div",{className:"flex items-center gap-2 text-[12px]",children:r.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300",checked:a.difficult_airway_anticipated||!1,onChange:()=>V("difficult_airway_anticipated")}),r.jsx("span",{className:"text-slate-700",children:"Difficult airway anticipated"})]})}),r.jsx(yg,{label:"Risk factors",value:a.risk_factors,onChange:X=>F("risk_factors",X)}),r.jsx(yg,{label:"Anaesthetic plan",value:a.anaesthetic_plan_detail,onChange:X=>F("anaesthetic_plan_detail",X)}),r.jsx(yg,{label:"Pre-op instructions",value:a.preop_instructions,onChange:X=>F("preop_instructions",X)})]})]}),pe=()=>r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 text-[12px] shadow-sm",children:[r.jsx("h3",{className:"mb-1 text-sm font-semibold text-slate-900",children:"Induction & intubation"}),r.jsxs("div",{className:"flex flex-wrap gap-3",children:[r.jsx(Da,{label:"Preoxygenation",checked:a.preoxygenation,onChange:()=>V("preoxygenation")}),r.jsx(Da,{label:"Cricoid pressure",checked:a.cricoid_pressure,onChange:()=>V("cricoid_pressure")})]}),r.jsx(_l,{label:"Induction",value:a.induction_route,onChange:X=>F("induction_route",X),options:["","Intravenous","Inhalational","Rapid sequence"]}),r.jsx(Da,{label:"Intubation done",checked:a.intubation_done,onChange:()=>V("intubation_done")}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[r.jsx(_l,{label:"Route",value:a.intubation_route,onChange:X=>F("intubation_route",X),options:["","Oral","Nasal"]}),r.jsx(_l,{label:"State",value:a.intubation_state,onChange:X=>F("intubation_state",X),options:["","Awake","Anaesthetised"]}),r.jsx(_l,{label:"Technique",value:a.intubation_technique,onChange:X=>F("intubation_technique",X),options:["","Visual","Blind","Fibreoptic","Retrograde"]}),r.jsx(kt,{label:"Laryngoscopy grade",placeholder:"I / II / III / IV",value:a.laryngoscopy_grade,onChange:X=>F("laryngoscopy_grade",X)})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[r.jsx(kt,{label:"Tube type",value:a.tube_type,onChange:X=>F("tube_type",X)}),r.jsx(kt,{label:"Size",value:a.tube_size,onChange:X=>F("tube_size",X)}),r.jsx(kt,{label:"Fixed at",value:a.tube_fixed_at,onChange:X=>F("tube_fixed_at",X)}),r.jsx(_l,{label:"Cuff medium",value:a.cuff_medium,onChange:X=>F("cuff_medium",X),options:["","Air","Saline","Not inflated"]})]}),r.jsx(Da,{label:"Cuff used",checked:a.cuff_used,onChange:()=>V("cuff_used")}),r.jsx(kt,{label:"Bilateral breath sounds",value:a.bilateral_breath_sounds,onChange:X=>F("bilateral_breath_sounds",X)}),r.jsx(kt,{label:"Added sounds",value:a.added_sounds,onChange:X=>F("added_sounds",X)})]}),r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 text-[12px] shadow-sm",children:[r.jsx("h3",{className:"mb-1 text-sm font-semibold text-slate-900",children:"Airway devices & monitors"}),r.jsx("div",{className:"mb-2 text-[11px] font-semibold text-slate-600",children:"Airway devices"}),r.jsx("div",{className:"grid grid-cols-2 gap-1",children:["Face mask","LMA/ILMA","Oral airway","Throat pack","NG tube","Other"].map(X=>r.jsx(Da,{label:X,checked:(a.airway_devices||[]).includes(X),onChange:()=>W(X)},X))}),r.jsx("div",{className:"mt-3 text-[11px] font-semibold text-slate-600",children:"Monitors"}),r.jsx("div",{className:"grid grid-cols-2 gap-1",children:[["ecg","ECG"],["nibp","NIBP"],["pulse_oximeter","Pulse oximeter"],["capnograph","Capnograph"],["agent_monitor","Agent monitor"],["pns","PNS"],["temperature","Temperature"],["urinary_catheter","Urinary catheter"],["ibp","IBP"],["cvp","CVP"],["precordial_steth","Precordial steth"],["oesophageal_steth","Oesophageal steth"]].map(([X,oe])=>{var _e;return r.jsx(Da,{label:oe,checked:((_e=a.monitors)==null?void 0:_e[X])||!1,onChange:()=>U(X)},X)})})]}),r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 text-[12px] shadow-sm",children:[r.jsx("h3",{className:"mb-1 text-sm font-semibold text-slate-900",children:"Ventilation & block"}),r.jsx(_l,{label:"Ventilation mode",value:a.ventilation_mode_baseline,onChange:X=>F("ventilation_mode_baseline",X),options:["","Spontaneous","Controlled","Manual","Ventilator"]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-3",children:[r.jsx(kt,{label:"Vt (ml)",value:a.ventilator_vt,onChange:X=>F("ventilator_vt",X)}),r.jsx(kt,{label:"Rate (f)",value:a.ventilator_rate,onChange:X=>F("ventilator_rate",X)}),r.jsx(kt,{label:"PEEP (cmHO)",value:a.ventilator_peep,onChange:X=>F("ventilator_peep",X)})]}),r.jsx(_l,{label:"Breathing system",value:a.breathing_system,onChange:X=>F("breathing_system",X),options:["","Mapleson A","Mapleson D","Mapleson F","Circle system","Other"]}),r.jsx("div",{className:"mt-2 text-[11px] font-semibold text-slate-600",children:"Position & protection"}),r.jsx(_l,{label:"Patient position",value:a.patient_position,onChange:X=>F("patient_position",X),options:["","Supine","Lateral","Prone","Lithotomy","Other"]}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsx(Da,{label:"Eyes taped",checked:a.eyes_taped,onChange:()=>V("eyes_taped")}),r.jsx(Da,{label:"Eyes covered with foil",checked:a.eyes_covered_with_foil,onChange:()=>V("eyes_covered_with_foil")}),r.jsx(Da,{label:"Pressure points padded",checked:a.pressure_points_padded,onChange:()=>V("pressure_points_padded")})]}),r.jsx("div",{className:"mt-2 text-[11px] font-semibold text-slate-600",children:"Lines & tourniquet"}),r.jsx("div",{className:"grid grid-cols-2 gap-1",children:[["peripheral_iv","Peripheral IV"],["central_line","Central line"],["arterial_line","Arterial line"]].map(([X,oe])=>{var _e;return r.jsx(Da,{label:oe,checked:((_e=a.lines)==null?void 0:_e[X])||!1,onChange:()=>z(X)},X)})}),r.jsx(Da,{label:"Tourniquet used",checked:a.tourniquet_used,onChange:()=>V("tourniquet_used")}),r.jsx(kt,{label:"IV fluids plan",value:a.iv_fluids_plan,onChange:X=>F("iv_fluids_plan",X)}),r.jsx(kt,{label:"Blood & components plan",value:a.blood_components_plan,onChange:X=>F("blood_components_plan",X)}),r.jsx("div",{className:"mt-2 text-[11px] font-semibold text-slate-600",children:"Regional block"}),r.jsx(_l,{label:"Type",value:a.regional_block_type,onChange:X=>F("regional_block_type",X),options:["","Spinal","Epidural","Nerve block","Combined","None"]}),r.jsx(kt,{label:"Position",value:a.regional_position,onChange:X=>F("regional_position",X)}),r.jsx(kt,{label:"Approach",value:a.regional_approach,onChange:X=>F("regional_approach",X)}),r.jsx(kt,{label:"Space & depth",value:a.regional_space_depth,onChange:X=>F("regional_space_depth",X)}),r.jsx(kt,{label:"Needle type",value:a.regional_needle_type,onChange:X=>F("regional_needle_type",X)}),r.jsx(kt,{label:"Drug injected / dose",value:a.regional_drug_dose,onChange:X=>F("regional_drug_dose",X)}),r.jsx(kt,{label:"Level of anaesthesia",value:a.regional_level,onChange:X=>F("regional_level",X)}),r.jsx(kt,{label:"Complications",value:a.regional_complications,onChange:X=>F("regional_complications",X)}),r.jsx(_l,{label:"Adequacy of block",value:a.block_adequacy,onChange:X=>F("block_adequacy",X),options:["","Excellent","Adequate","Poor"]}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsx(Da,{label:"Sedation needed",checked:a.sedation_needed,onChange:()=>V("sedation_needed")}),r.jsx(Da,{label:"Conversion to GA",checked:a.conversion_to_ga,onChange:()=>V("conversion_to_ga")})]})]})]}),r.jsx(yg,{label:"Intra-op summary / notes",value:a.notes||"",onChange:X=>F("notes",X)})]}),ue=()=>r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 text-[12px] shadow-sm",children:[r.jsxs("h3",{className:"mb-2 flex items-center gap-2 text-sm font-semibold text-slate-900",children:[r.jsx(sn,{className:"h-4 w-4"}),"Intra-op vitals log"]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-6",children:[r.jsx(kt,{label:"Time (HH:MM)",value:C.time,onChange:X=>k(oe=>({...oe,time:X}))}),r.jsx(kt,{label:"HR",value:C.hr,onChange:X=>k(oe=>({...oe,hr:X}))}),r.jsx(kt,{label:"BP",value:C.bp,onChange:X=>k(oe=>({...oe,bp:X}))}),r.jsx(kt,{label:"SpO",value:C.spo2,onChange:X=>k(oe=>({...oe,spo2:X}))}),r.jsx(kt,{label:"RR",value:C.rr,onChange:X=>k(oe=>({...oe,rr:X}))}),r.jsx(kt,{label:"Temp C",value:C.temp_c,onChange:X=>k(oe=>({...oe,temp_c:X}))})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-6",children:[r.jsx(kt,{label:"ETCO",value:C.etco2,onChange:X=>k(oe=>({...oe,etco2:X}))}),r.jsx(kt,{label:"Vent mode",value:C.ventilation_mode,onChange:X=>k(oe=>({...oe,ventilation_mode:X}))}),r.jsx(kt,{label:"Peak P (cmHO)",value:C.peak_airway_pressure,onChange:X=>k(oe=>({...oe,peak_airway_pressure:X}))}),r.jsx(kt,{label:"CVP / PCWP",value:C.cvp_pcwp,onChange:X=>k(oe=>({...oe,cvp_pcwp:X}))}),r.jsx(kt,{label:"Urine (ml)",value:C.urine_output_ml,onChange:X=>k(oe=>({...oe,urine_output_ml:X}))}),r.jsx(kt,{label:"Blood loss (ml)",value:C.blood_loss_ml,onChange:X=>k(oe=>({...oe,blood_loss_ml:X}))})]}),r.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-end",children:[r.jsx("div",{className:"flex-1",children:r.jsx(kt,{label:"ST segment / comments",value:C.st_segment||C.comments,onChange:X=>k(oe=>({...oe,st_segment:X,comments:X}))})}),r.jsx("button",{type:"button",onClick:G,disabled:A,className:"inline-flex items-center justify-center rounded-full bg-slate-900 px-4 py-2 text-[12px] font-semibold text-white shadow hover:bg-slate-800 disabled:cursor-not-allowed disabled:opacity-60",children:A?"Adding":"Add vitals"})]}),r.jsx("div",{className:"mt-3 overflow-x-auto",children:r.jsxs("table",{className:"min-w-full text-[11px]",children:[r.jsx("thead",{className:"bg-slate-50 text-slate-600",children:r.jsxs("tr",{children:[r.jsx(En,{children:"Time"}),r.jsx(En,{children:"HR"}),r.jsx(En,{children:"BP"}),r.jsx(En,{children:"SpO"}),r.jsx(En,{children:"RR"}),r.jsx(En,{children:"Temp"}),r.jsx(En,{children:"ETCO"}),r.jsx(En,{children:"Vent"}),r.jsx(En,{children:"Peak P"}),r.jsx(En,{children:"CVP/PCWP"}),r.jsx(En,{children:"Urine"}),r.jsx(En,{children:"Blood loss"}),r.jsx(En,{children:"Comments"}),r.jsx(En,{})]})}),r.jsx("tbody",{children:j.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:14,className:"py-3 text-center text-slate-500",children:"No vitals logged yet."})}):j.map(X=>r.jsxs("tr",{className:"border-t",children:[r.jsx(Tn,{children:X.time}),r.jsx(Tn,{children:X.hr}),r.jsx(Tn,{children:X.bp}),r.jsx(Tn,{children:X.spo2}),r.jsx(Tn,{children:X.rr}),r.jsx(Tn,{children:X.temp_c}),r.jsx(Tn,{children:X.etco2}),r.jsx(Tn,{children:X.ventilation_mode}),r.jsx(Tn,{children:X.peak_airway_pressure}),r.jsx(Tn,{children:X.cvp_pcwp}),r.jsx(Tn,{children:X.urine_output_ml}),r.jsx(Tn,{children:X.blood_loss_ml}),r.jsx(Tn,{children:X.comments}),r.jsx(Tn,{children:r.jsx("button",{onClick:()=>se(X.id),className:"text-xs font-semibold text-red-500 hover:underline",children:"Delete"})})]},X.id))})]})})]}),ye=()=>r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 text-[12px] shadow-sm",children:[r.jsxs("h3",{className:"mb-2 flex items-center gap-2 text-sm font-semibold text-slate-900",children:[r.jsx(y4,{className:"h-4 w-4"}),"Anaesthesia drug log"]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-5",children:[r.jsx(kt,{label:"Time (HH:MM)",value:I.time,onChange:X=>O(oe=>({...oe,time:X}))}),r.jsx(kt,{label:"Drug name",value:I.drug_name,onChange:X=>O(oe=>({...oe,drug_name:X}))}),r.jsx(kt,{label:"Dose",value:I.dose,onChange:X=>O(oe=>({...oe,dose:X}))}),r.jsx(kt,{label:"Route",value:I.route,onChange:X=>O(oe=>({...oe,route:X}))}),r.jsx(kt,{label:"Remarks",value:I.remarks,onChange:X=>O(oe=>({...oe,remarks:X}))})]}),r.jsx("button",{type:"button",onClick:ge,disabled:M,className:"inline-flex items-center justify-center rounded-full bg-slate-900 px-4 py-2 text-[12px] font-semibold text-white shadow hover:bg-slate-800 disabled:cursor-not-allowed disabled:opacity-60",children:M?"Adding":"Add drug"}),r.jsx("div",{className:"mt-3 overflow-x-auto",children:r.jsxs("table",{className:"min-w-full text-[11px]",children:[r.jsx("thead",{className:"bg-slate-50 text-slate-600",children:r.jsxs("tr",{children:[r.jsx(En,{children:"Time"}),r.jsx(En,{children:"Drug"}),r.jsx(En,{children:"Dose"}),r.jsx(En,{children:"Route"}),r.jsx(En,{children:"Remarks"}),r.jsx(En,{})]})}),r.jsx("tbody",{children:P.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"py-3 text-center text-slate-500",children:"No drugs logged yet."})}):P.map(X=>r.jsxs("tr",{className:"border-t",children:[r.jsx(Tn,{children:X.time}),r.jsx(Tn,{children:X.drug_name}),r.jsx(Tn,{children:X.dose}),r.jsx(Tn,{children:X.route}),r.jsx(Tn,{children:X.remarks}),r.jsx(Tn,{children:r.jsx("button",{onClick:()=>ke(X.id),className:"text-xs font-semibold text-red-500 hover:underline",children:"Delete"})})]},X.id))})]})})]});return c?r.jsx("div",{className:"rounded-2xl border bg-white p-6 text-sm text-slate-600",children:"Loading anaesthesia record"}):r.jsxs("div",{className:"space-y-4 text-[13px]",children:[L,r.jsxs("div",{className:"flex flex-wrap items-center gap-2 rounded-full bg-slate-100 p-1 text-[12px]",children:[r.jsxs("div",{className:"flex flex-1 flex-wrap gap-1 overflow-x-auto",children:[r.jsx(gg,{active:s==="preop",onClick:()=>n("preop"),icon:dr,children:"Pre-op record"}),r.jsx(gg,{active:s==="intra",onClick:()=>n("intra"),icon:ese,children:"Intra-op setup"}),r.jsx(gg,{active:s==="vitals",onClick:()=>n("vitals"),icon:sn,children:"Vitals log"}),r.jsx(gg,{active:s==="drugs",onClick:()=>n("drugs"),icon:y4,children:"Drug log"})]}),r.jsx("div",{className:"ml-auto flex items-center text-[11px] font-medium text-slate-500",children:l.id?"Record created":"No record yet"})]}),s==="preop"&&ee(),s==="intra"&&pe(),s==="vitals"&&ue(),s==="drugs"&&ye(),r.jsx("div",{className:"sticky bottom-0 mt-4 flex justify-end border-t bg-slate-50/90 px-2 py-3 backdrop-blur",children:r.jsx("button",{type:"button",onClick:q,disabled:u,className:"inline-flex items-center rounded-full bg-slate-900 px-5 py-2 text-[13px] font-semibold text-white shadow-md hover:bg-slate-800 disabled:cursor-not-allowed disabled:opacity-60",children:u?"Saving":"Save anaesthesia record"})})]})}function gg({active:t,onClick:s,children:n,icon:a}){return r.jsxs("button",{type:"button",onClick:s,className:"inline-flex items-center gap-1.5 rounded-full px-3 py-1.5 text-[12px] font-medium transition "+(t?"bg-white text-slate-900 shadow-sm":"text-slate-600 hover:bg-white/70"),children:[a&&r.jsx(a,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:n})]})}function kt({label:t,value:s,onChange:n,placeholder:a}){return r.jsxs("label",{className:"flex flex-col gap-1",children:[r.jsx("span",{className:"text-[11px] font-semibold text-slate-600",children:t}),r.jsx("input",{className:"h-9 rounded-md border border-slate-200 bg-slate-50 px-3 text-[12px] text-slate-900 outline-none ring-0 transition focus:border-slate-400 focus:bg-white",value:s??"",placeholder:a,onChange:i=>n(i.target.value)})]})}function yg({label:t,value:s,onChange:n,placeholder:a}){return r.jsxs("label",{className:"flex flex-col gap-1",children:[r.jsx("span",{className:"text-[11px] font-semibold text-slate-600",children:t}),r.jsx("textarea",{className:"min-h-[70px] rounded-md border border-slate-200 bg-slate-50 px-3 py-2 text-[12px] text-slate-900 outline-none ring-0 transition focus:border-slate-400 focus:bg-white",value:s??"",placeholder:a,onChange:i=>n(i.target.value)})]})}function Da({label:t,checked:s,onChange:n}){return r.jsxs("label",{className:"inline-flex items-center gap-1.5 text-[11px] text-slate-700",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-slate-900 focus:ring-0",checked:!!s,onChange:n}),r.jsx("span",{children:t})]})}function _l({label:t,value:s,onChange:n,options:a}){return r.jsxs("label",{className:"flex flex-col gap-1",children:[r.jsx("span",{className:"text-[11px] font-semibold text-slate-600",children:t}),r.jsx("select",{className:"h-9 rounded-md border border-slate-200 bg-slate-50 px-3 text-[12px] text-slate-900 outline-none ring-0 transition focus:border-slate-400 focus:bg-white",value:s??"",onChange:i=>n(i.target.value),children:a.map(i=>r.jsx("option",{value:i,children:i||""},i||"empty"))})]})}function En({children:t}){return r.jsx("th",{className:"px-2 py-1 text-left text-[11px] font-semibold uppercase tracking-wide",children:t})}function Tn({children:t}){return r.jsx("td",{className:"px-2 py-1 align-top text-[11px] text-slate-700",children:t})}function J7e({caseId:t}){const s=tt("ot.case.view")||tt("ot.operation_notes.view"),n=tt("ot.operation_notes.manage")||tt("ot.case.update"),[a,i]=y.useState(null),[l,o]=y.useState(!1),[c,d]=y.useState(!1),[u,f]=y.useState(null),[m,x]=y.useState({diagnosis_pre:"",diagnosis_post:"",procedure_performed:"",findings:"",steps:"",complications:"",drains:"",blood_loss_ml:"",post_op_orders:""}),b=async()=>{var _;if(s)try{o(!0),f(null);const C=await c7e(t);if(C.data){const k=C.data;i(k),x({diagnosis_pre:k.preop_diagnosis||"",diagnosis_post:k.postop_diagnosis||"",procedure_performed:k.indication||"",findings:k.findings||"",steps:k.procedure_steps||"",complications:k.complications||"",drains:k.drains_details||"",blood_loss_ml:k.blood_loss_ml??"",post_op_orders:k.postop_instructions||""})}else i(null)}catch(C){((_=C==null?void 0:C.response)==null?void 0:_.status)===404?i(null):(console.error("Failed to load Operation note",C),f("Failed to load Operation note"))}finally{o(!1)}};if(y.useEffect(()=>{b()},[t,s]),!s)return r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view Operation notes."});const w=(_,C)=>{x(k=>({...k,[_]:C}))},j=async _=>{var C,k;if(_.preventDefault(),!!n){d(!0),f(null);try{const A={surgeon_user_id:null,preop_diagnosis:m.diagnosis_pre||null,postop_diagnosis:m.diagnosis_post||null,indication:m.procedure_performed||null,findings:m.findings||null,procedure_steps:m.steps||null,blood_loss_ml:m.blood_loss_ml===""?null:Number(m.blood_loss_ml),complications:m.complications||null,drains_details:m.drains||null,postop_instructions:m.post_op_orders||null};a?await u7e(t,A):await d7e(t,A),await b()}catch(A){console.error("Failed to save Operation note",A);const T=((k=(C=A==null?void 0:A.response)==null?void 0:C.data)==null?void 0:k.detail)||(A==null?void 0:A.message)||"Failed to save Operation note";f(T)}finally{d(!1)}}};return r.jsxs("form",{onSubmit:j,className:"space-y-3 rounded-2xl border bg-white px-4 py-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sky-800",children:[r.jsx(tl,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-semibold",children:"Operation notes"})]}),a&&r.jsxs("span",{className:"rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] text-emerald-700",children:["Last updated: ",(a==null?void 0:a.updated_at)||(a==null?void 0:a.created_at)||""]})]}),l&&r.jsx("div",{className:"text-xs text-slate-500",children:"Loading Operation notes..."}),u&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:u}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Pre-op diagnosis"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.diagnosis_pre,disabled:!n,onChange:_=>w("diagnosis_pre",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Post-op diagnosis"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.diagnosis_post,disabled:!n,onChange:_=>w("diagnosis_post",_.target.value)})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Procedure performed / indication"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.procedure_performed,disabled:!n,onChange:_=>w("procedure_performed",_.target.value)})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Findings"}),r.jsx("textarea",{rows:3,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.findings,disabled:!n,onChange:_=>w("findings",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Steps / technique"}),r.jsx("textarea",{rows:3,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.steps,disabled:!n,onChange:_=>w("steps",_.target.value)})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Complications"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.complications,disabled:!n,onChange:_=>w("complications",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Drains / tubes"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.drains,disabled:!n,onChange:_=>w("drains",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Approx. blood loss (ml)"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.blood_loss_ml,disabled:!n,onChange:_=>w("blood_loss_ml",_.target.value)})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Immediate post-op orders"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.post_op_orders,disabled:!n,onChange:_=>w("post_op_orders",_.target.value)})]}),n&&r.jsx("div",{className:"flex justify-end",children:r.jsxs("button",{type:"submit",disabled:c,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[c&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save Operation note"]})})]})}function a6(t){if(!t)return"";if(/^\d{2}:\d{2}$/.test(t))return t;const s=new Date(t);return isNaN(s.getTime())?"":s.toISOString().slice(11,16)}function e9e({caseId:t}){const s=tt("ot.cases.view")||tt("ot.pacu.view"),n=tt("ot.pacu.manage")||tt("ot.case.update"),[a,i]=y.useState(null),[l,o]=y.useState(!1),[c,d]=y.useState(!1),[u,f]=y.useState(null),[m,x]=y.useState({arrival_time:"",departure_time:"",pain_score:"",nausea_vomiting:"",airway_status:"",vitals_summary:"",complications:"",discharge_criteria_met:!1,notes:""}),b=async()=>{var _;if(s)try{o(!0),f(null);const C=await p7e(t);if(C.data){const k=C.data;i(k),x({arrival_time:a6(k.arrival_time),departure_time:a6(k.departure_time),pain_score:k.pain_score||"",nausea_vomiting:k.nausea_vomiting||"",airway_status:k.airway_status||"",vitals_summary:k.vitals_summary||"",complications:k.complications||"",discharge_criteria_met:!!k.discharge_criteria_met,notes:k.notes||""})}else i(null)}catch(C){((_=C==null?void 0:C.response)==null?void 0:_.status)===404?i(null):(console.error("Failed to load PACU record",C),f("Failed to load PACU record"))}finally{o(!1)}};if(y.useEffect(()=>{b()},[t,s]),!s)return r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view PACU records."});const w=(_,C)=>{x(k=>({...k,[_]:C}))},j=async _=>{var C,k;if(_.preventDefault(),!!n){d(!0),f(null);try{const A={arrival_time:m.arrival_time||null,departure_time:m.departure_time||null,pain_score:m.pain_score||null,nausea_vomiting:m.nausea_vomiting||null,airway_status:m.airway_status||null,vitals_summary:m.vitals_summary||null,complications:m.complications||null,discharge_criteria_met:!!m.discharge_criteria_met,notes:m.notes||null};a?await g7e(t,A):await x7e(t,A),await b()}catch(A){console.error("Failed to save PACU record",A);let T="Failed to save PACU record";const P=(k=(C=A==null?void 0:A.response)==null?void 0:C.data)==null?void 0:k.detail;Array.isArray(P)?T=P.map(R=>R.msg).join(", "):typeof P=="string"?T=P:A!=null&&A.message&&(T=A.message),f(T)}finally{d(!1)}}};return r.jsxs("form",{onSubmit:j,className:"space-y-3 rounded-2xl border bg-white px-4 py-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sky-800",children:[r.jsx(Jn,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-semibold",children:"PACU / Post-anaesthesia recovery"})]}),a&&r.jsxs("span",{className:"rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] text-emerald-700",children:["Last updated: ",(a==null?void 0:a.updated_at)||(a==null?void 0:a.created_at)||""]})]}),l&&r.jsx("div",{className:"text-xs text-slate-500",children:"Loading PACU record..."}),u&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:u}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Arrival time"}),r.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:m.arrival_time,disabled:!n,onChange:_=>w("arrival_time",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Departure time"}),r.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:m.departure_time,disabled:!n,onChange:_=>w("departure_time",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Pain score"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",placeholder:"e.g., 3/10",value:m.pain_score,disabled:!n,onChange:_=>w("pain_score",_.target.value)})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Nausea / vomiting"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:m.nausea_vomiting,disabled:!n,onChange:_=>w("nausea_vomiting",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Airway status"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:m.airway_status,disabled:!n,onChange:_=>w("airway_status",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Vitals summary"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:m.vitals_summary,disabled:!n,onChange:_=>w("vitals_summary",_.target.value)})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"PACU complications"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:m.complications,disabled:!n,onChange:_=>w("complications",_.target.value)})]}),r.jsxs("label",{className:"flex cursor-pointer items-center gap-2 rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-800 hover:border-sky-400",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!m.discharge_criteria_met,disabled:!n,onChange:_=>w("discharge_criteria_met",_.target.checked)}),r.jsx("span",{children:"PACU discharge criteria met; patient shifted as per orders"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Notes"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:m.notes,disabled:!n,onChange:_=>w("notes",_.target.value)})]}),n&&r.jsx("div",{className:"flex justify-end",children:r.jsxs("button",{type:"submit",disabled:c,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[c&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save PACU record"]})})]})}function t9e(t){if(!t)return"";if(/^\d{2}:\d{2}$/.test(t))return t;const s=new Date(t);return isNaN(s.getTime())?"":s.toISOString().slice(11,16)}function s9e({caseId:t}){const s=tt("ot.case.view")||tt("ot.nursing.view"),n=tt("ot.nursing.manage")||tt("ot.case.update"),[a,i]=y.useState(null),[l,o]=y.useState(!1),[c,d]=y.useState(!1),[u,f]=y.useState(null),[m,x]=y.useState({scrub_nurse_name:"",circulating_nurse_name:"",positioning:"",skin_prep:"",catheterisation:"",diathermy_plate_site:"",counts_initial_done:!1,counts_closure_done:!1,antibiotics_time:"",warming_measures:"",notes:""}),b=async()=>{var _;if(s)try{o(!0),f(null);const C=await r7e(t);if(C.data){const k=C.data;i(k),x({scrub_nurse_name:k.scrub_nurse_name||"",circulating_nurse_name:k.circulating_nurse_name||"",positioning:k.positioning||"",skin_prep:k.skin_prep||"",catheterisation:k.catheterisation||"",diathermy_plate_site:k.diathermy_plate_site||"",counts_initial_done:!!k.counts_initial_done,counts_closure_done:!!k.counts_closure_done,antibiotics_time:t9e(k.antibiotics_time),warming_measures:k.warming_measures||"",notes:k.notes||""})}else i(null)}catch(C){((_=C==null?void 0:C.response)==null?void 0:_.status)===404?i(null):(console.error("Failed to load intra-op nursing record",C),f("Failed to load intra-op nursing record"))}finally{o(!1)}};if(y.useEffect(()=>{b()},[t,s]),!s)return r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view intra-op nursing records."});const w=(_,C)=>{x(k=>({...k,[_]:C}))},j=async _=>{var k,A,T,P,R;if(_.preventDefault(),!n)return;d(!0),f(null);const C={primary_nurse_id:null,scrub_nurse_name:m.scrub_nurse_name||null,circulating_nurse_name:m.circulating_nurse_name||null,positioning:m.positioning||null,skin_prep:m.skin_prep||null,catheterisation:m.catheterisation||null,diathermy_plate_site:m.diathermy_plate_site||null,counts_initial_done:!!m.counts_initial_done,counts_closure_done:!!m.counts_closure_done,antibiotics_time:m.antibiotics_time||null,warming_measures:m.warming_measures||null,notes:m.notes||null};try{if(a)await JR(t,C);else try{await a7e(t,C)}catch(I){const O=(k=I==null?void 0:I.response)==null?void 0:k.status,M=(T=(A=I==null?void 0:I.response)==null?void 0:A.data)==null?void 0:T.detail;if(O===400&&typeof M=="string"&&M.toLowerCase().includes("already exists"))await JR(t,C);else throw I}await b()}catch(I){console.error("Failed to save intra-op nursing record",I);const O=((R=(P=I==null?void 0:I.response)==null?void 0:P.data)==null?void 0:R.detail)||(I==null?void 0:I.message)||"Failed to save intra-op nursing record";f(O)}finally{d(!1)}};return r.jsxs("form",{onSubmit:j,className:"space-y-3 rounded-2xl border bg-white px-4 py-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sky-800",children:[r.jsx(dr,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-semibold",children:"Intra-op nursing record"})]}),r.jsx("div",{className:"flex items-center gap-2",children:a&&r.jsxs("span",{className:"rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] text-emerald-700",children:["Last updated: ",(a==null?void 0:a.updated_at)||(a==null?void 0:a.created_at)||""]})})]}),l&&r.jsx("div",{className:"text-xs text-slate-500",children:"Loading intra-op nursing record..."}),u&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:u}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Scrub nurse"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.scrub_nurse_name,disabled:!n,onChange:_=>w("scrub_nurse_name",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Circulating nurse"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.circulating_nurse_name,disabled:!n,onChange:_=>w("circulating_nurse_name",_.target.value)})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Patient positioning"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.positioning,disabled:!n,onChange:_=>w("positioning",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Skin preparation"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.skin_prep,disabled:!n,onChange:_=>w("skin_prep",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Catheterisation"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.catheterisation,disabled:!n,onChange:_=>w("catheterisation",_.target.value)})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Diathermy plate site"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.diathermy_plate_site,disabled:!n,onChange:_=>w("diathermy_plate_site",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Prophylactic antibiotics time"}),r.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.antibiotics_time,disabled:!n,onChange:_=>w("antibiotics_time",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Warming measures"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.warming_measures,disabled:!n,onChange:_=>w("warming_measures",_.target.value)})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[r.jsxs("label",{className:"flex cursor-pointer items-center gap-2 rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!m.counts_initial_done,disabled:!n,onChange:_=>w("counts_initial_done",_.target.checked)}),r.jsx("span",{children:"Initial sponge / instrument counts completed"})]}),r.jsxs("label",{className:"flex cursor-pointer items-center gap-2 rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!m.counts_closure_done,disabled:!n,onChange:_=>w("counts_closure_done",_.target.checked)}),r.jsx("span",{children:"Final counts completed at closure"})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Notes"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.notes,disabled:!n,onChange:_=>w("notes",_.target.value)})]}),n&&r.jsx("div",{className:"flex justify-end",children:r.jsxs("button",{type:"submit",disabled:c,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[c&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save intra-op nursing record"]})})]})}function n9e({caseId:t}){const s=tt("ot.case.view")||tt("ot.counts.view"),n=tt("ot.counts.manage")||tt("ot.case.update"),[a,i]=y.useState(null),[l,o]=y.useState(!1),[c,d]=y.useState(!1),[u,f]=y.useState(null),[m,x]=y.useState({sponges_initial:"",sponges_added:"",sponges_final:"",instruments_initial:"",instruments_final:"",needles_initial:"",needles_final:"",discrepancy_text:"",xray_done:!1,resolved_by:"",notes:""}),b=A=>A===""||A===null||A===void 0?null:Number(A),w=async()=>{var A;if(s)try{o(!0),f(null);const P=(await i7e(t)).data;console.log("Counts record API data:",P),i(P),x({sponges_initial:P.sponges_initial??"",sponges_added:P.sponges_added??"",sponges_final:P.sponges_final??"",instruments_initial:P.instruments_initial??"",instruments_final:P.instruments_final??"",needles_initial:P.needles_initial??"",needles_final:P.needles_final??"",discrepancy_text:P.discrepancy_text||"",xray_done:!!P.xray_done,resolved_by:P.resolved_by||"",notes:P.notes||""})}catch(T){((A=T==null?void 0:T.response)==null?void 0:A.status)===404?(i(null),x(P=>({...P,sponges_initial:"",sponges_added:"",sponges_final:"",instruments_initial:"",instruments_final:"",needles_initial:"",needles_final:"",discrepancy_text:"",xray_done:!1,resolved_by:"",notes:""}))):(console.error("Failed to load counts record",T),f("Failed to load counts record"))}finally{o(!1)}};y.useEffect(()=>{i(null),w()},[t,s]);const j=(A,T)=>{x(P=>({...P,[A]:T}))},_=()=>({sponges_initial:b(m.sponges_initial),sponges_added:b(m.sponges_added),sponges_final:b(m.sponges_final),instruments_initial:b(m.instruments_initial),instruments_final:b(m.instruments_final),needles_initial:b(m.needles_initial),needles_final:b(m.needles_final),discrepancy_text:m.discrepancy_text||null,xray_done:!!m.xray_done,resolved_by:m.resolved_by||null,notes:m.notes||null}),C=async A=>{var P,R;if(A.preventDefault(),!n)return;d(!0),f(null);const T=_();try{if(a!=null&&a.id)await o7e(t,T);else{const I=await l7e(t,T);i(I.data)}await w()}catch(I){console.error("Failed to save counts record",I);const O=((R=(P=I==null?void 0:I.response)==null?void 0:P.data)==null?void 0:R.detail)||(I==null?void 0:I.message)||"Failed to save counts record";f(O)}finally{d(!1)}},k=(A,T)=>r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:T}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m[A],disabled:!n,onChange:P=>j(A,P.target.value)})]},A);return r.jsxs("form",{onSubmit:C,className:"space-y-3 rounded-2xl border bg-white px-4 py-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sky-800",children:[r.jsx(So,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-semibold",children:"Sponge / instrument / needle count"})]}),a&&r.jsxs("span",{className:"rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] text-emerald-700",children:["Last updated: ",(a==null?void 0:a.updated_at)||(a==null?void 0:a.created_at)||""]})]}),l&&r.jsx("div",{className:"text-xs text-slate-500",children:"Loading counts record..."}),u&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:u}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[k("sponges_initial","Sponges - initial"),k("sponges_added","Sponges - added during case"),k("sponges_final","Sponges - final count")]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[k("instruments_initial","Instruments - initial"),k("instruments_final","Instruments - final")]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[k("needles_initial","Needles - initial"),k("needles_final","Needles - final")]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Discrepancy (if any)"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.discrepancy_text,disabled:!n,onChange:A=>j("discrepancy_text",A.target.value)})]}),r.jsxs("label",{className:"flex cursor-pointer items-center gap-2 rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!m.xray_done,disabled:!n,onChange:A=>j("xray_done",A.target.checked)}),r.jsx("span",{children:"Intra-op / post-op X-ray done for suspected retained item"})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Discrepancy resolved by"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.resolved_by,disabled:!n,onChange:A=>j("resolved_by",A.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Notes / corrective action"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.notes,disabled:!n,onChange:A=>j("notes",A.target.value)})]})]}),n&&r.jsx("div",{className:"flex justify-end",children:r.jsxs("button",{type:"submit",disabled:c,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[c&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save counts record"]})})]})}function r9e({caseId:t}){const s=tt("ot.case.view")||tt("ot.blood_transfusion.view"),n=tt("ot.blood_transfusion.manage")||tt("ot.case.update"),[a,i]=y.useState([]),[l,o]=y.useState(!1),[c,d]=y.useState(null),[u,f]=y.useState(!1),[m,x]=y.useState({component:"",units:"1",blood_group:"",bag_no:"",start_time:"",end_time:"",reaction:"",reaction_action:"",notes:""}),b=async()=>{if(s)try{o(!0),d(null);const C=await h7e(t);console.log("Blood transfusion API data:",C.data),i(C.data||[])}catch(C){console.error("Failed to load blood transfusions",C),d("Failed to load blood transfusion records")}finally{o(!1)}};if(y.useEffect(()=>{b()},[t,s]),!s)return r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view OT blood transfusions."});const w=(C,k)=>{x(A=>({...A,[C]:k}))},j=async C=>{var k,A;if(C.preventDefault(),!!n){f(!0);try{const T={component:m.component||null,units:m.units===""?null:Number(m.units||1),start_time:null,end_time:null,reaction:m.reaction||null,notes:m.notes||null};await f7e(t,T),x({component:"",units:"1",blood_group:"",bag_no:"",start_time:"",end_time:"",reaction:"",reaction_action:"",notes:""}),await b()}catch(T){console.error("Failed to add transfusion",T),alert(((A=(k=T==null?void 0:T.response)==null?void 0:k.data)==null?void 0:A.detail)||"Failed to add transfusion entry")}finally{f(!1)}}},_=async C=>{if(n&&window.confirm("Delete this transfusion record?"))try{await m7e(C),await b()}catch(k){console.error("Failed to delete transfusion",k),alert("Failed to delete transfusion entry")}};return r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"rounded-2xl border bg-white px-4 py-3 text-xs",children:[r.jsx("div",{className:"mb-2 flex items-center justify-between gap-2",children:r.jsxs("div",{className:"flex items-center gap-2 text-slate-800",children:[r.jsx(h_,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-semibold",children:"OT blood transfusion record"})]})}),l&&r.jsx("div",{className:"text-xs text-slate-500",children:"Loading transfusion records..."}),c&&r.jsx("div",{className:"mb-2 rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:c}),r.jsx("div",{className:"max-h-64 overflow-auto rounded-xl border bg-slate-50",children:r.jsxs("table",{className:"min-w-full text-left text-[11px] text-slate-700",children:[r.jsx("thead",{className:"bg-slate-100",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-1.5",children:"Component"}),r.jsx("th",{className:"px-3 py-1.5",children:"Units"}),r.jsx("th",{className:"px-3 py-1.5",children:"Start"}),r.jsx("th",{className:"px-3 py-1.5",children:"End"}),r.jsx("th",{className:"px-3 py-1.5",children:"Reaction"}),r.jsx("th",{className:"px-3 py-1.5 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[!l&&a.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-3 py-2 text-center text-[11px] text-slate-500",children:"No transfusions recorded for this case."})}),!l&&a.map(C=>r.jsxs("tr",{className:"border-t border-slate-100",children:[r.jsx("td",{className:"px-3 py-1.5",children:C.component||""}),r.jsx("td",{className:"px-3 py-1.5",children:C.units??""}),r.jsx("td",{className:"px-3 py-1.5",children:C.start_time||""}),r.jsx("td",{className:"px-3 py-1.5",children:C.end_time||""}),r.jsx("td",{className:"px-3 py-1.5",children:C.reaction||"None"}),r.jsx("td",{className:"px-3 py-1.5 text-right",children:n&&r.jsxs("button",{type:"button",onClick:()=>_(C.id),className:"inline-flex items-center gap-1 rounded-lg border border-rose-200 bg-white px-2 py-0.5 text-[10px] text-rose-600 hover:bg-rose-50",children:[r.jsx(Trash2,{className:"h-3 w-3"}),"Delete"]})})]},C.id))]})]})})]}),n&&r.jsxs("form",{onSubmit:j,className:"space-y-2 rounded-2xl border bg-white px-4 py-3 text-xs",children:[r.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:"Add transfusion entry"}),r.jsxs("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Component"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.component,onChange:C=>w("component",C.target.value),placeholder:"PRBC / FFP / Platelets...",required:!0})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Units"}),r.jsx("input",{type:"number",min:"1",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.units,onChange:C=>w("units",C.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Blood group"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.blood_group,onChange:C=>w("blood_group",C.target.value),placeholder:"e.g., O+"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Bag number"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.bag_no,onChange:C=>w("bag_no",C.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Start time"}),r.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.start_time,onChange:C=>w("start_time",C.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"End time"}),r.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.end_time,onChange:C=>w("end_time",C.target.value)})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Reaction"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.reaction,onChange:C=>w("reaction",C.target.value),placeholder:"None / chills / rash / etc."})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Action taken"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.reaction_action,onChange:C=>w("reaction_action",C.target.value)})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Notes"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.notes,onChange:C=>w("notes",C.target.value)})]}),r.jsx("div",{className:"flex justify-end",children:r.jsxs("button",{type:"submit",disabled:u,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[u&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Add transfusion"]})})]})]})}const a9e=[{id:"preop",label:"Pre-op Checklist"},{id:"safety",label:"WHO Safety Checklist"},{id:"anaesthesia",label:"Anaesthesia"},{id:"nursing",label:"Nursing Notes"},{id:"counts",label:"Instrument & Sponge Counts"},{id:"blood",label:"Blood & Fluids"},{id:"notes",label:"Operation Notes"},{id:"pacu",label:"PACU / Recovery"},{id:"logs",label:"Audit Log"}];function yw(t){if(!t)return null;const s=new Date(t);return Number.isNaN(s.getTime())?null:s}function ay(t){const s=yw(t);return s?s.toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):""}function yC(t){if(!t)return"";if(typeof t=="string"){const n=t.match(/^(\d{2}):(\d{2})/);if(n)return`${n[1]}:${n[2]}`}const s=yw(t);return s?s.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"}):""}function i6(t){return yw(t)?`${ay(t)}  ${yC(t)}`:""}function i9e(...t){return t.filter(Boolean).join("  ")}function l9e(t){if(!t)return"";const s=t.prefix||t.title,n=t.first_name||t.given_name,a=t.last_name||t.family_name;return[s,n,a].filter(Boolean).join(" ")||t.full_name||t.display_name||""}function o9e(t){if(!t)return null;const s=t.sex||t.gender||t.sex_label||null;let n=t.age_display||t.age||null;if(!n&&(t.age_years!=null||t.age_months!=null)){const a=t.age_years,i=t.age_months;a!=null&&i!=null?n=`${a}y ${i}m`:a!=null?n=`${a}y`:i!=null&&(n=`${i}m`)}if(!n&&t.dob){const a=yw(t.dob);if(a){const i=new Date;let l=i.getFullYear()-a.getFullYear();const o=i.getMonth()-a.getMonth();(o<0||o===0&&i.getDate()<a.getDate())&&l--,n=`${l}y`}}return n&&s?`${n} / ${s}`:n||s||null}function c9e(){var G,se,ge,ke,ee;const{caseId:t}=sd(),s=Ta(),n=tt("ot.cases.view"),[a,i]=y.useState("preop"),[l,o]=y.useState(null),[c,d]=y.useState(!1),[u,f]=y.useState(null),m=async()=>{var pe;if(!(!n||!t))try{d(!0),f(null);const ue=await ULe(t);o(ue.data||null)}catch(ue){console.error("Failed to load OT case",ue);const ye=(pe=ue==null?void 0:ue.response)==null?void 0:pe.status;f(ye===404?"OT case not found. It may have been deleted or the reference is invalid.":ye===403?"You do not have permission to view this OT case.":"Failed to load OT case. Please try again.")}finally{d(!1)}};y.useEffect(()=>{m()},[t,n]);const x=l==null?void 0:l.schedule,b=x==null?void 0:x.patient,w=(x==null?void 0:x.admission)||null,j=(x==null?void 0:x.bed)||null,_=(w==null?void 0:w.current_bed)||null,C=j||_,k=l9e(b),A=o9e(b),T=(x==null?void 0:x.reg_no)||(x==null?void 0:x.display_number)||(x==null?void 0:x.ot_number)||(x==null?void 0:x.schedule_code)||null,P=(b==null?void 0:b.uhid)||(b==null?void 0:b.uhid_number)||(x==null?void 0:x.patient_uhid)||null,R=(w==null?void 0:w.display_code)||(w==null?void 0:w.admission_code)||null,I=(x==null?void 0:x.op_no)||null,O=(w==null?void 0:w.admitted_at)||(w==null?void 0:w.admission_date)||null,M=C?i9e(C.ward_name,C.room_name,C.code):null,B=(l==null?void 0:l.final_procedure_name)||(x==null?void 0:x.procedure_name)||(x==null?void 0:x.primary_procedure_name)||"",L=(G=x==null?void 0:x.additional_procedures)!=null&&G.length?x.additional_procedures.map(pe=>pe.name||pe.procedure_name).filter(Boolean).join(", "):null,F=(x==null?void 0:x.planned_start_time)||(x==null?void 0:x.planned_start)||null,V=(x==null?void 0:x.planned_end_time)||(x==null?void 0:x.planned_end)||null,U=l==null?void 0:l.actual_start_time,z=l==null?void 0:l.actual_end_time,W=(x==null?void 0:x.date)||F||V||null,q=y.useMemo(()=>{if(!l)return null;const pe=(x==null?void 0:x.status)||(l.outcome?"closed":"open"),ue=String(pe).toLowerCase(),ye={planned:"bg-slate-100 text-slate-700",in_progress:"bg-sky-50 text-sky-700",completed:"bg-emerald-50 text-emerald-700",cancelled:"bg-rose-50 text-rose-700",open:"bg-emerald-50 text-emerald-700",closed:"bg-slate-100 text-slate-700"};return r.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2.5 py-0.5 text-[11px] font-medium ${ye[ue]||"bg-slate-100 text-slate-700"}`,children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-current opacity-70"}),String(pe).toUpperCase()]})},[l,x]);return n?r.jsxs("div",{className:"flex h-full flex-col gap-3 p-4",children:[r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("button",{type:"button",onClick:()=>s(-1),className:"inline-flex h-8 w-8 items-center justify-center rounded-full border border-slate-200 bg-white text-slate-600 shadow-sm hover:border-sky-400 hover:text-sky-700",children:r.jsx(Tb,{className:"h-4 w-4"})}),r.jsxs("div",{children:[r.jsxs("div",{className:"mb-0.5 flex flex-wrap items-center gap-2",children:[r.jsx("h1",{className:"text-base font-semibold text-slate-900",children:"OT Case"}),q,T&&r.jsxs("span",{className:"inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2 py-0.5 text-[11px] font-medium text-slate-700",children:[r.jsx(m4,{className:"mr-1 h-3 w-3"}),"OT Reg No: ",T]})]}),r.jsx("p",{className:"text-xs text-slate-500",children:"All OT documentation, checklists and notes for this procedure are linked to this case as per NABH OT standards."})]})]}),r.jsx("div",{className:"flex flex-col items-end gap-1 text-right",children:W&&r.jsxs("div",{className:"inline-flex items-center gap-1.5 rounded-full bg-slate-900 px-3 py-1 text-[11px] font-medium text-slate-50",children:[r.jsx(Kn,{className:"h-3.5 w-3.5"}),"OT Date: ",ay(W)]})})]}),u&&r.jsx("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-2 text-xs text-rose-700",children:u}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-4",children:[r.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-white p-4 text-xs shadow-sm",children:[r.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[r.jsx("div",{className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-sky-50 text-sky-700",children:r.jsx(on,{className:"h-4 w-4"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:"Patient"}),r.jsx("div",{className:"text-sm font-semibold text-slate-900",children:k})]})]}),r.jsxs("dl",{className:"space-y-1.5",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[r.jsx(m4,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:"UHID"})]}),r.jsx("dd",{className:"text-[11px] font-medium text-slate-900",children:P||""})]}),r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[r.jsx(Qh,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:"Age / Sex"})]}),r.jsx("dd",{className:"text-[11px] text-slate-900",children:A||""})]})]})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-white p-4 text-xs shadow-sm",children:[r.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[r.jsx("div",{className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-emerald-50 text-emerald-700",children:r.jsx(Jn,{className:"h-4 w-4"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:"Admission / Visit"}),r.jsx("div",{className:"text-[11px] text-slate-500",children:"IP or OP details (if available)"})]})]}),r.jsxs("dl",{className:"space-y-1.5",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[r.jsx(dr,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:"IP No"})]}),r.jsx("dd",{className:"text-[11px] font-medium text-slate-900",children:R||""})]}),r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[r.jsx(dr,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:"OP No"})]}),r.jsx("dd",{className:"text-[11px] font-medium text-slate-900",children:I||""})]}),r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[r.jsx(Kn,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:"Date of Admission"})]}),r.jsx("dd",{className:"text-[11px] text-slate-900",children:O?ay(O):""})]}),r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[r.jsx(Jn,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:"Bed Details"})]}),r.jsx("dd",{className:"text-[11px] text-right text-slate-900",children:M||""})]})]})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-white p-4 text-xs shadow-sm",children:[r.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[r.jsx("div",{className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-indigo-50 text-indigo-700",children:r.jsx(_s,{className:"h-4 w-4"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:"Procedure & Team"}),r.jsx("div",{className:"text-sm font-semibold text-slate-900",children:B})]})]}),L&&r.jsxs("div",{className:"mb-1 text-[11px] text-slate-500",children:["Additional: ",L]}),r.jsxs("dl",{className:"space-y-1.5",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[r.jsx(_s,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:"Surgeon"})]}),r.jsxs("dd",{className:"text-[11px] text-right text-slate-900",children:["Dr. ",((se=x==null?void 0:x.surgeon)==null?void 0:se.full_name)||((ge=x==null?void 0:x.surgeon)==null?void 0:ge.name)||(x==null?void 0:x.surgeon_name)||(x!=null&&x.surgeon_user_id?`Doctor #${x.surgeon_user_id}`:"")]})]}),r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[r.jsx(Qh,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:"Anaesthetist"})]}),r.jsxs("dd",{className:"text-[11px] text-right text-slate-900",children:["Dr. ",((ke=x==null?void 0:x.anaesthetist)==null?void 0:ke.full_name)||((ee=x==null?void 0:x.anaesthetist)==null?void 0:ee.name)||(x==null?void 0:x.anaesthetist_name)||(x!=null&&x.anaesthetist_user_id?`Doctor #${x.anaesthetist_user_id}`:"")]})]})]})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-white p-4 text-xs shadow-sm",children:[r.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[r.jsx("div",{className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-amber-50 text-amber-700",children:r.jsx(Xn,{className:"h-4 w-4"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:"Theatre & Timings"}),r.jsx("div",{className:"text-sm font-semibold text-slate-900",children:M||""})]})]}),r.jsxs("dl",{className:"space-y-1.5",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[r.jsx(Xn,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:"Planned"})]}),r.jsx("dd",{className:"text-[11px] text-right text-slate-900",children:F||V?r.jsxs(r.Fragment,{children:[W&&r.jsx("span",{className:"block",children:ay(W)}),r.jsxs("span",{children:[F?yC(F):""," ",""," ",V?yC(V):""]})]}):""})]}),r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[r.jsx(Xn,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:"Actual Start"})]}),r.jsx("dd",{className:"text-[11px] text-right text-slate-900",children:U?i6(U):""})]}),r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[r.jsx(Xn,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:"Actual End"})]}),r.jsx("dd",{className:"text-[11px] text-right text-slate-900",children:z?i6(z):""})]})]})]})]}),r.jsx("div",{className:"mt-1 flex gap-2 border-b border-slate-200 pt-1",children:a9e.map(pe=>{const ue=pe.id===a;return r.jsxs("button",{type:"button",onClick:()=>i(pe.id),className:`relative px-3 py-1.5 text-xs font-medium transition-colors ${ue?"text-sky-700":"text-slate-500 hover:text-slate-800"}`,children:[pe.label,ue&&r.jsx("span",{className:"absolute inset-x-0 bottom-0 h-0.5 rounded-full bg-sky-600"})]},pe.id)})}),r.jsxs("div",{className:"flex-1 overflow-auto pt-2 pb-4",children:[c&&!l&&r.jsx("div",{className:"rounded-2xl border bg-white px-4 py-4 text-xs text-slate-500",children:"Loading OT case..."}),!c&&!l&&!u&&r.jsx("div",{className:"rounded-2xl border bg-white px-4 py-4 text-xs text-slate-500",children:"OT case not loaded."}),l&&r.jsxs("div",{className:"space-y-3",children:[a==="preop"&&r.jsx(K7e,{caseId:t}),a==="safety"&&r.jsx(Q7e,{caseId:t}),a==="anaesthesia"&&r.jsx(Z7e,{caseId:t}),a==="nursing"&&r.jsx(s9e,{caseId:t}),a==="counts"&&r.jsx(n9e,{caseId:t}),a==="blood"&&r.jsx(r9e,{caseId:t}),a==="notes"&&r.jsx(J7e,{caseId:t}),a==="pacu"&&r.jsx(e9e,{caseId:t}),a==="logs"&&r.jsx(CK,{caseId:t})]})]})]}):r.jsx("div",{className:"p-4",children:r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-sm text-amber-800",children:"You do not have permission to view OT cases."})})}function d9e(){return y.useEffect(()=>{const s=async()=>{if(localStorage.getItem("access_token"))try{await r7()}catch(i){console.error("Auto token refresh failed",i)}};s();const n=setInterval(s,174e4);return()=>clearInterval(n)},[]),r.jsxs(r.Fragment,{children:[r.jsxs(gZ,{children:[r.jsx(ut,{path:"/auth/login",element:r.jsx(Hne,{})}),r.jsx(ut,{path:"/auth/register-admin",element:r.jsx(Wne,{})}),r.jsx(ut,{path:"/auth/verify",element:r.jsx(qne,{})}),r.jsx(ut,{element:r.jsx(Uce,{}),children:r.jsxs(ut,{element:r.jsx(Ice,{children:r.jsx(zce,{})}),children:[r.jsx(ut,{path:"/admin",element:r.jsx(bR,{})}),r.jsx(ut,{path:"/dashboard",element:r.jsx(bR,{})}),r.jsx(ut,{path:"/admin/roles",element:r.jsx(yce,{})}),r.jsx(ut,{path:"/admin/permissions",element:r.jsx(bce,{})}),r.jsx(ut,{path:"/admin/users",element:r.jsx(vce,{})}),r.jsx(ut,{path:"/admin/departments",element:r.jsx(xce,{})}),r.jsx(ut,{path:"/patients",element:r.jsx(VRe,{})}),r.jsx(ut,{path:"/patients/masters",element:r.jsx(WRe,{})}),r.jsx(ut,{path:"/opd/dashboard",element:r.jsx(B6e,{})}),r.jsx(ut,{path:"/opd/schedules",element:r.jsx(a6e,{})}),r.jsx(ut,{path:"/opd/appointments",element:r.jsx(j6e,{})}),r.jsx(ut,{path:"/opd/queue",element:r.jsx(E6e,{})}),r.jsx(ut,{path:"/opd/triage",element:r.jsx(P6e,{})}),r.jsx(ut,{path:"/opd/visit/:id",element:r.jsx(I6e,{})}),r.jsx(ut,{path:"/opd/followups",element:r.jsx(O6e,{})}),r.jsx(ut,{path:"/opd/no-shows",element:r.jsx(L6e,{})}),r.jsx(ut,{path:"/opd/doctor-fees",element:r.jsx(xLe,{})}),r.jsx(ut,{path:"/ipd/admissions",element:r.jsx(Tue,{})}),r.jsx(ut,{path:"/ipd/admission/:id",element:r.jsx(xxe,{})}),r.jsx(ut,{path:"/ipd/tracking",element:r.jsx(gxe,{})}),r.jsx(ut,{path:"/ipd/my",element:r.jsx(yxe,{})}),r.jsx(ut,{path:"/ipd/discharged",element:r.jsx(bxe,{})}),r.jsx(ut,{path:"/ipd/bedboard",element:r.jsx(vxe,{})}),r.jsx(ut,{path:"/ipd/masters",element:r.jsx(Jde,{})}),r.jsx(ut,{path:"/lab/orders",element:r.jsx(TLe,{})}),r.jsx(ut,{path:"/lab/orders/:id",element:r.jsx(Dxe,{})}),r.jsx(ut,{path:"/lab/masters",element:r.jsx(Oxe,{})}),r.jsx(ut,{path:"/lab/service/masters",element:r.jsx(kLe,{})}),r.jsx(ut,{path:"/lab/orders/:id/print",element:r.jsx(ALe,{})}),r.jsx(ut,{path:"/ris/orders",element:r.jsx(Qxe,{})}),r.jsx(ut,{path:"/ris/orders/:id",element:r.jsx(e0e,{})}),r.jsx(ut,{path:"/ris/masters",element:r.jsx(Jxe,{})}),r.jsx(ut,{path:"/ot/schedule",element:r.jsx(L7e,{})}),r.jsx(ut,{path:"/ot/masters",element:r.jsx(U7e,{})}),r.jsx(ut,{path:"/ot/cases/:caseId",element:r.jsx(c9e,{})}),r.jsx(ut,{path:"/ot/logs",element:r.jsx(CK,{})}),r.jsx(ut,{path:"/billing",element:r.jsx(t6e,{})}),r.jsx(ut,{path:"/billing/invoices/:invoiceId",element:r.jsx(p0e,{})}),r.jsx(ut,{path:"/emr",element:r.jsx(C0e,{})}),r.jsx(ut,{path:"/templates",element:r.jsx(R0e,{})}),r.jsx(ut,{path:"/templates/new",element:r.jsx(AM,{mode:"create"})}),r.jsx(ut,{path:"/templates/:id/edit",element:r.jsx(AM,{mode:"edit"})}),r.jsx(ut,{path:"/templates/generate",element:r.jsx(Sje,{})}),r.jsx(ut,{path:"/templates/consents",element:r.jsx(Cje,{})}),r.jsx(ut,{path:"/settings/branding",element:r.jsx(r6e,{})}),r.jsx(ut,{path:"/mis",element:r.jsx(xRe,{})}),r.jsx(ut,{path:"/pharmacy/inventory",element:r.jsx(Z6e,{})}),r.jsx(ut,{path:"/pharmacy/qr-lookup",element:r.jsx(L8e,{})}),r.jsx(ut,{path:"/inventory/barcode-lookup",element:r.jsx(F8e,{})}),r.jsx(ut,{path:"/pharmacy/rx",element:r.jsx(W8e,{})}),r.jsx(ut,{path:"/pharmacy/dispense",element:r.jsx(lLe,{})}),r.jsx(ut,{path:"/pharmacy/billing",element:r.jsx(eLe,{})}),r.jsx(ut,{path:"/pharmacy/sales",element:r.jsx(sLe,{})}),r.jsx(ut,{path:"/pharmacy/returns",element:r.jsx(rLe,{})}),r.jsx(ut,{path:"/pharmacy/rx-explorer",element:r.jsx(dLe,{})}),r.jsx(ut,{path:"/opd/phramacy",element:r.jsx(pLe,{})}),r.jsx(ut,{path:"/ipd/phramacy",element:r.jsx(hLe,{})}),r.jsx(ut,{path:"/counter/phramacy",element:r.jsx(fLe,{})}),r.jsx(ut,{path:"/ot/phramacy",element:r.jsx(mLe,{})})]})}),r.jsx(ut,{path:"*",element:r.jsx(PL,{to:"/auth/login",replace:!0})})]}),r.jsx(Pee,{position:"top-right",richColors:!0,closeButton:!0})]})}const u9e=y.createContext(null);function h9e({children:t,duration:s=3500}){const[n,a]=y.useState([]),i=y.useCallback(c=>{a(d=>d.filter(u=>u.id!==c))},[]),l=y.useCallback((c,d,u={})=>{const f=crypto.randomUUID(),m=u.duration??s;return a(x=>[...x,{id:f,type:c,message:d,duration:m}]),f},[s]),o=y.useMemo(()=>({success:(c,d)=>l("success",c,d),error:(c,d)=>l("error",c,d),warn:(c,d)=>l("warn",c,d),info:(c,d)=>l("info",c,d)}),[l]);return r.jsxs(u9e.Provider,{value:o,children:[t,r.jsx("div",{className:"fixed right-4 top-4 z-[9999] flex w-[min(92vw,380px)] flex-col gap-2",children:n.map(c=>r.jsx(f9e,{toast:c,onClose:()=>i(c.id)},c.id))})]})}function f9e({toast:t,onClose:s}){y.useEffect(()=>{const i=setTimeout(s,t.duration);return()=>clearTimeout(i)},[t.duration,s]);const n={success:"border-emerald-200 bg-emerald-50 text-emerald-800",error:"border-rose-200 bg-rose-50 text-rose-800",warn:"border-amber-200 bg-amber-50 text-amber-800",info:"border-blue-200 bg-blue-50 text-blue-800"}[t.type]??"border-gray-200 bg-white text-gray-800",a={success:Ur,error:w3,warn:So,info:Ep}[t.type]??Ep;return r.jsxs("div",{className:`flex items-start gap-3 rounded-xl border p-3 shadow-sm ${n}`,role:"status","aria-live":"polite",children:[r.jsx(a,{className:"mt-0.5 h-5 w-5"}),r.jsx("div",{className:"flex-1 text-sm",children:t.message}),r.jsx("button",{onClick:s,className:"opacity-70 hover:opacity-100","aria-label":"Close",children:r.jsx(Rn,{className:"h-4 w-4"})})]})}o2.createRoot(document.getElementById("root")).render(r.jsx(Qe.StrictMode,{children:r.jsx(h9e,{children:r.jsx(SZ,{children:r.jsx(d9e,{})})})}));
