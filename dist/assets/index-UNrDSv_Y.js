var qG=Object.defineProperty;var GG=(t,n,r)=>n in t?qG(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r;var xw=(t,n,r)=>GG(t,typeof n!="symbol"?n+"":n,r);function cR(t,n){for(var r=0;r<n.length;r++){const s=n[r];if(typeof s!="string"&&!Array.isArray(s)){for(const i in s)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(s,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>s[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();var Kh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gi(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var dR={exports:{}},Vy={},uR={exports:{}},qt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nx=Symbol.for("react.element"),KG=Symbol.for("react.portal"),YG=Symbol.for("react.fragment"),XG=Symbol.for("react.strict_mode"),QG=Symbol.for("react.profiler"),ZG=Symbol.for("react.provider"),JG=Symbol.for("react.context"),eK=Symbol.for("react.forward_ref"),tK=Symbol.for("react.suspense"),nK=Symbol.for("react.memo"),rK=Symbol.for("react.lazy"),Gk=Symbol.iterator;function sK(t){return t===null||typeof t!="object"?null:(t=Gk&&t[Gk]||t["@@iterator"],typeof t=="function"?t:null)}var fR={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},hR=Object.assign,mR={};function uh(t,n,r){this.props=t,this.context=n,this.refs=mR,this.updater=r||fR}uh.prototype.isReactComponent={};uh.prototype.setState=function(t,n){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,n,"setState")};uh.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function pR(){}pR.prototype=uh.prototype;function zC(t,n,r){this.props=t,this.context=n,this.refs=mR,this.updater=r||fR}var UC=zC.prototype=new pR;UC.constructor=zC;hR(UC,uh.prototype);UC.isPureReactComponent=!0;var Kk=Array.isArray,xR=Object.prototype.hasOwnProperty,VC={current:null},gR={key:!0,ref:!0,__self:!0,__source:!0};function yR(t,n,r){var s,i={},o=null,l=null;if(n!=null)for(s in n.ref!==void 0&&(l=n.ref),n.key!==void 0&&(o=""+n.key),n)xR.call(n,s)&&!gR.hasOwnProperty(s)&&(i[s]=n[s]);var c=arguments.length-2;if(c===1)i.children=r;else if(1<c){for(var d=Array(c),u=0;u<c;u++)d[u]=arguments[u+2];i.children=d}if(t&&t.defaultProps)for(s in c=t.defaultProps,c)i[s]===void 0&&(i[s]=c[s]);return{$$typeof:nx,type:t,key:o,ref:l,props:i,_owner:VC.current}}function aK(t,n){return{$$typeof:nx,type:t.type,key:n,ref:t.ref,props:t.props,_owner:t._owner}}function HC(t){return typeof t=="object"&&t!==null&&t.$$typeof===nx}function iK(t){var n={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return n[r]})}var Yk=/\/+/g;function gw(t,n){return typeof t=="object"&&t!==null&&t.key!=null?iK(""+t.key):n.toString(36)}function ig(t,n,r,s,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var l=!1;if(t===null)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case nx:case KG:l=!0}}if(l)return l=t,i=i(l),t=s===""?"."+gw(l,0):s,Kk(i)?(r="",t!=null&&(r=t.replace(Yk,"$&/")+"/"),ig(i,n,r,"",function(u){return u})):i!=null&&(HC(i)&&(i=aK(i,r+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(Yk,"$&/")+"/")+t)),n.push(i)),1;if(l=0,s=s===""?".":s+":",Kk(t))for(var c=0;c<t.length;c++){o=t[c];var d=s+gw(o,c);l+=ig(o,n,r,d,i)}else if(d=sK(t),typeof d=="function")for(t=d.call(t),c=0;!(o=t.next()).done;)o=o.value,d=s+gw(o,c++),l+=ig(o,n,r,d,i);else if(o==="object")throw n=String(t),Error("Objects are not valid as a React child (found: "+(n==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return l}function Wx(t,n,r){if(t==null)return t;var s=[],i=0;return ig(t,s,"","",function(o){return n.call(r,o,i++)}),s}function oK(t){if(t._status===-1){var n=t._result;n=n(),n.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=n)}if(t._status===1)return t._result.default;throw t._result}var Ks={current:null},og={transition:null},lK={ReactCurrentDispatcher:Ks,ReactCurrentBatchConfig:og,ReactCurrentOwner:VC};function vR(){throw Error("act(...) is not supported in production builds of React.")}qt.Children={map:Wx,forEach:function(t,n,r){Wx(t,function(){n.apply(this,arguments)},r)},count:function(t){var n=0;return Wx(t,function(){n++}),n},toArray:function(t){return Wx(t,function(n){return n})||[]},only:function(t){if(!HC(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};qt.Component=uh;qt.Fragment=YG;qt.Profiler=QG;qt.PureComponent=zC;qt.StrictMode=XG;qt.Suspense=tK;qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lK;qt.act=vR;qt.cloneElement=function(t,n,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=hR({},t.props),i=t.key,o=t.ref,l=t._owner;if(n!=null){if(n.ref!==void 0&&(o=n.ref,l=VC.current),n.key!==void 0&&(i=""+n.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(d in n)xR.call(n,d)&&!gR.hasOwnProperty(d)&&(s[d]=n[d]===void 0&&c!==void 0?c[d]:n[d])}var d=arguments.length-2;if(d===1)s.children=r;else if(1<d){c=Array(d);for(var u=0;u<d;u++)c[u]=arguments[u+2];s.children=c}return{$$typeof:nx,type:t.type,key:i,ref:o,props:s,_owner:l}};qt.createContext=function(t){return t={$$typeof:JG,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:ZG,_context:t},t.Consumer=t};qt.createElement=yR;qt.createFactory=function(t){var n=yR.bind(null,t);return n.type=t,n};qt.createRef=function(){return{current:null}};qt.forwardRef=function(t){return{$$typeof:eK,render:t}};qt.isValidElement=HC;qt.lazy=function(t){return{$$typeof:rK,_payload:{_status:-1,_result:t},_init:oK}};qt.memo=function(t,n){return{$$typeof:nK,type:t,compare:n===void 0?null:n}};qt.startTransition=function(t){var n=og.transition;og.transition={};try{t()}finally{og.transition=n}};qt.unstable_act=vR;qt.useCallback=function(t,n){return Ks.current.useCallback(t,n)};qt.useContext=function(t){return Ks.current.useContext(t)};qt.useDebugValue=function(){};qt.useDeferredValue=function(t){return Ks.current.useDeferredValue(t)};qt.useEffect=function(t,n){return Ks.current.useEffect(t,n)};qt.useId=function(){return Ks.current.useId()};qt.useImperativeHandle=function(t,n,r){return Ks.current.useImperativeHandle(t,n,r)};qt.useInsertionEffect=function(t,n){return Ks.current.useInsertionEffect(t,n)};qt.useLayoutEffect=function(t,n){return Ks.current.useLayoutEffect(t,n)};qt.useMemo=function(t,n){return Ks.current.useMemo(t,n)};qt.useReducer=function(t,n,r){return Ks.current.useReducer(t,n,r)};qt.useRef=function(t){return Ks.current.useRef(t)};qt.useState=function(t){return Ks.current.useState(t)};qt.useSyncExternalStore=function(t,n,r){return Ks.current.useSyncExternalStore(t,n,r)};qt.useTransition=function(){return Ks.current.useTransition()};qt.version="18.3.1";uR.exports=qt;var b=uR.exports;const ze=gi(b),Hy=cR({__proto__:null,default:ze},[b]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cK=b,dK=Symbol.for("react.element"),uK=Symbol.for("react.fragment"),fK=Object.prototype.hasOwnProperty,hK=cK.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,mK={key:!0,ref:!0,__self:!0,__source:!0};function bR(t,n,r){var s,i={},o=null,l=null;r!==void 0&&(o=""+r),n.key!==void 0&&(o=""+n.key),n.ref!==void 0&&(l=n.ref);for(s in n)fK.call(n,s)&&!mK.hasOwnProperty(s)&&(i[s]=n[s]);if(t&&t.defaultProps)for(s in n=t.defaultProps,n)i[s]===void 0&&(i[s]=n[s]);return{$$typeof:dK,type:t,key:o,ref:l,props:i,_owner:hK.current}}Vy.Fragment=uK;Vy.jsx=bR;Vy.jsxs=bR;dR.exports=Vy;var a=dR.exports,M2={},wR={exports:{}},$a={},NR={exports:{}},jR={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function n(X,J){var ne=X.length;X.push(J);e:for(;0<ne;){var Se=ne-1>>>1,de=X[Se];if(0<i(de,J))X[Se]=J,X[ne]=de,ne=Se;else break e}}function r(X){return X.length===0?null:X[0]}function s(X){if(X.length===0)return null;var J=X[0],ne=X.pop();if(ne!==J){X[0]=ne;e:for(var Se=0,de=X.length,ye=de>>>1;Se<ye;){var be=2*(Se+1)-1,xe=X[be],_e=be+1,we=X[_e];if(0>i(xe,ne))_e<de&&0>i(we,xe)?(X[Se]=we,X[_e]=ne,Se=_e):(X[Se]=xe,X[be]=ne,Se=be);else if(_e<de&&0>i(we,ne))X[Se]=we,X[_e]=ne,Se=_e;else break e}}return J}function i(X,J){var ne=X.sortIndex-J.sortIndex;return ne!==0?ne:X.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();t.unstable_now=function(){return l.now()-c}}var d=[],u=[],h=1,m=null,g=3,y=!1,N=!1,j=!1,S=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(X){for(var J=r(u);J!==null;){if(J.callback===null)s(u);else if(J.startTime<=X)s(u),J.sortIndex=J.expirationTime,n(d,J);else break;J=r(u)}}function T(X){if(j=!1,k(X),!N)if(r(d)!==null)N=!0,q(P);else{var J=r(u);J!==null&&K(T,J.startTime-X)}}function P(X,J){N=!1,j&&(j=!1,_(D),D=-1),y=!0;var ne=g;try{for(k(J),m=r(d);m!==null&&(!(m.expirationTime>J)||X&&!V());){var Se=m.callback;if(typeof Se=="function"){m.callback=null,g=m.priorityLevel;var de=Se(m.expirationTime<=J);J=t.unstable_now(),typeof de=="function"?m.callback=de:m===r(d)&&s(d),k(J)}else s(d);m=r(d)}if(m!==null)var ye=!0;else{var be=r(u);be!==null&&K(T,be.startTime-J),ye=!1}return ye}finally{m=null,g=ne,y=!1}}var M=!1,O=null,D=-1,L=5,$=-1;function V(){return!(t.unstable_now()-$<L)}function F(){if(O!==null){var X=t.unstable_now();$=X;var J=!0;try{J=O(!0,X)}finally{J?Q():(M=!1,O=null)}}else M=!1}var Q;if(typeof A=="function")Q=function(){A(F)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,z=U.port2;U.port1.onmessage=F,Q=function(){z.postMessage(null)}}else Q=function(){S(F,0)};function q(X){O=X,M||(M=!0,Q())}function K(X,J){D=S(function(){X(t.unstable_now())},J)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(X){X.callback=null},t.unstable_continueExecution=function(){N||y||(N=!0,q(P))},t.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<X?Math.floor(1e3/X):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return r(d)},t.unstable_next=function(X){switch(g){case 1:case 2:case 3:var J=3;break;default:J=g}var ne=g;g=J;try{return X()}finally{g=ne}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(X,J){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var ne=g;g=X;try{return J()}finally{g=ne}},t.unstable_scheduleCallback=function(X,J,ne){var Se=t.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?Se+ne:Se):ne=Se,X){case 1:var de=-1;break;case 2:de=250;break;case 5:de=1073741823;break;case 4:de=1e4;break;default:de=5e3}return de=ne+de,X={id:h++,callback:J,priorityLevel:X,startTime:ne,expirationTime:de,sortIndex:-1},ne>Se?(X.sortIndex=ne,n(u,X),r(d)===null&&X===r(u)&&(j?(_(D),D=-1):j=!0,K(T,ne-Se))):(X.sortIndex=de,n(d,X),N||y||(N=!0,q(P))),X},t.unstable_shouldYield=V,t.unstable_wrapCallback=function(X){var J=g;return function(){var ne=g;g=J;try{return X.apply(this,arguments)}finally{g=ne}}}})(jR);NR.exports=jR;var pK=NR.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xK=b,Ra=pK;function Fe(t){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)n+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var SR=new Set,Jm={};function Nu(t,n){Df(t,n),Df(t+"Capture",n)}function Df(t,n){for(Jm[t]=n,t=0;t<n.length;t++)SR.add(n[t])}var ll=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),O2=Object.prototype.hasOwnProperty,gK=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Xk={},Qk={};function yK(t){return O2.call(Qk,t)?!0:O2.call(Xk,t)?!1:gK.test(t)?Qk[t]=!0:(Xk[t]=!0,!1)}function vK(t,n,r,s){if(r!==null&&r.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return s?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function bK(t,n,r,s){if(n===null||typeof n>"u"||vK(t,n,r,s))return!0;if(s)return!1;if(r!==null)switch(r.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function Ys(t,n,r,s,i,o,l){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=s,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=n,this.sanitizeURL=o,this.removeEmptyString=l}var ys={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ys[t]=new Ys(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var n=t[0];ys[n]=new Ys(n,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ys[t]=new Ys(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ys[t]=new Ys(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ys[t]=new Ys(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ys[t]=new Ys(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ys[t]=new Ys(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ys[t]=new Ys(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ys[t]=new Ys(t,5,!1,t.toLowerCase(),null,!1,!1)});var WC=/[\-:]([a-z])/g;function qC(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var n=t.replace(WC,qC);ys[n]=new Ys(n,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var n=t.replace(WC,qC);ys[n]=new Ys(n,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var n=t.replace(WC,qC);ys[n]=new Ys(n,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ys[t]=new Ys(t,1,!1,t.toLowerCase(),null,!1,!1)});ys.xlinkHref=new Ys("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ys[t]=new Ys(t,1,!1,t.toLowerCase(),null,!0,!0)});function GC(t,n,r,s){var i=ys.hasOwnProperty(n)?ys[n]:null;(i!==null?i.type!==0:s||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(bK(n,r,i,s)&&(r=null),s||i===null?yK(n)&&(r===null?t.removeAttribute(n):t.setAttribute(n,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(n=i.attributeName,s=i.attributeNamespace,r===null?t.removeAttribute(n):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,s?t.setAttributeNS(s,n,r):t.setAttribute(n,r))))}var Sl=xK.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,qx=Symbol.for("react.element"),Zu=Symbol.for("react.portal"),Ju=Symbol.for("react.fragment"),KC=Symbol.for("react.strict_mode"),D2=Symbol.for("react.profiler"),CR=Symbol.for("react.provider"),_R=Symbol.for("react.context"),YC=Symbol.for("react.forward_ref"),R2=Symbol.for("react.suspense"),L2=Symbol.for("react.suspense_list"),XC=Symbol.for("react.memo"),Yl=Symbol.for("react.lazy"),AR=Symbol.for("react.offscreen"),Zk=Symbol.iterator;function Yh(t){return t===null||typeof t!="object"?null:(t=Zk&&t[Zk]||t["@@iterator"],typeof t=="function"?t:null)}var Jn=Object.assign,yw;function wm(t){if(yw===void 0)try{throw Error()}catch(r){var n=r.stack.trim().match(/\n( *(at )?)/);yw=n&&n[1]||""}return`
`+yw+t}var vw=!1;function bw(t,n){if(!t||vw)return"";vw=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(u){var s=u}Reflect.construct(t,[],n)}else{try{n.call()}catch(u){s=u}t.call(n.prototype)}else{try{throw Error()}catch(u){s=u}t()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),o=s.stack.split(`
`),l=i.length-1,c=o.length-1;1<=l&&0<=c&&i[l]!==o[c];)c--;for(;1<=l&&0<=c;l--,c--)if(i[l]!==o[c]){if(l!==1||c!==1)do if(l--,c--,0>c||i[l]!==o[c]){var d=`
`+i[l].replace(" at new "," at ");return t.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",t.displayName)),d}while(1<=l&&0<=c);break}}}finally{vw=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?wm(t):""}function wK(t){switch(t.tag){case 5:return wm(t.type);case 16:return wm("Lazy");case 13:return wm("Suspense");case 19:return wm("SuspenseList");case 0:case 2:case 15:return t=bw(t.type,!1),t;case 11:return t=bw(t.type.render,!1),t;case 1:return t=bw(t.type,!0),t;default:return""}}function B2(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ju:return"Fragment";case Zu:return"Portal";case D2:return"Profiler";case KC:return"StrictMode";case R2:return"Suspense";case L2:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case _R:return(t.displayName||"Context")+".Consumer";case CR:return(t._context.displayName||"Context")+".Provider";case YC:var n=t.render;return t=t.displayName,t||(t=n.displayName||n.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case XC:return n=t.displayName||null,n!==null?n:B2(t.type)||"Memo";case Yl:n=t._payload,t=t._init;try{return B2(t(n))}catch{}}return null}function NK(t){var n=t.type;switch(t.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=n.render,t=t.displayName||t.name||"",n.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B2(n);case 8:return n===KC?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function _c(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function ER(t){var n=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function jK(t){var n=ER(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,n),s=""+t[n];if(!t.hasOwnProperty(n)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,o=r.set;return Object.defineProperty(t,n,{configurable:!0,get:function(){return i.call(this)},set:function(l){s=""+l,o.call(this,l)}}),Object.defineProperty(t,n,{enumerable:r.enumerable}),{getValue:function(){return s},setValue:function(l){s=""+l},stopTracking:function(){t._valueTracker=null,delete t[n]}}}}function Gx(t){t._valueTracker||(t._valueTracker=jK(t))}function kR(t){if(!t)return!1;var n=t._valueTracker;if(!n)return!0;var r=n.getValue(),s="";return t&&(s=ER(t)?t.checked?"true":"false":t.value),t=s,t!==r?(n.setValue(t),!0):!1}function Hg(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function F2(t,n){var r=n.checked;return Jn({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Jk(t,n){var r=n.defaultValue==null?"":n.defaultValue,s=n.checked!=null?n.checked:n.defaultChecked;r=_c(n.value!=null?n.value:r),t._wrapperState={initialChecked:s,initialValue:r,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function TR(t,n){n=n.checked,n!=null&&GC(t,"checked",n,!1)}function $2(t,n){TR(t,n);var r=_c(n.value),s=n.type;if(r!=null)s==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}n.hasOwnProperty("value")?z2(t,n.type,r):n.hasOwnProperty("defaultValue")&&z2(t,n.type,_c(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(t.defaultChecked=!!n.defaultChecked)}function eT(t,n,r){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var s=n.type;if(!(s!=="submit"&&s!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+t._wrapperState.initialValue,r||n===t.value||(t.value=n),t.defaultValue=n}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function z2(t,n,r){(n!=="number"||Hg(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Nm=Array.isArray;function Nf(t,n,r,s){if(t=t.options,n){n={};for(var i=0;i<r.length;i++)n["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=n.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&s&&(t[r].defaultSelected=!0)}else{for(r=""+_c(r),n=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,s&&(t[i].defaultSelected=!0);return}n!==null||t[i].disabled||(n=t[i])}n!==null&&(n.selected=!0)}}function U2(t,n){if(n.dangerouslySetInnerHTML!=null)throw Error(Fe(91));return Jn({},n,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function tT(t,n){var r=n.value;if(r==null){if(r=n.children,n=n.defaultValue,r!=null){if(n!=null)throw Error(Fe(92));if(Nm(r)){if(1<r.length)throw Error(Fe(93));r=r[0]}n=r}n==null&&(n=""),r=n}t._wrapperState={initialValue:_c(r)}}function IR(t,n){var r=_c(n.value),s=_c(n.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),n.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),s!=null&&(t.defaultValue=""+s)}function nT(t){var n=t.textContent;n===t._wrapperState.initialValue&&n!==""&&n!==null&&(t.value=n)}function PR(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function V2(t,n){return t==null||t==="http://www.w3.org/1999/xhtml"?PR(n):t==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Kx,MR=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,r,s,i){MSApp.execUnsafeLocalFunction(function(){return t(n,r,s,i)})}:t}(function(t,n){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=n;else{for(Kx=Kx||document.createElement("div"),Kx.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=Kx.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;n.firstChild;)t.appendChild(n.firstChild)}});function ep(t,n){if(n){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=n;return}}t.textContent=n}var Pm={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},SK=["Webkit","ms","Moz","O"];Object.keys(Pm).forEach(function(t){SK.forEach(function(n){n=n+t.charAt(0).toUpperCase()+t.substring(1),Pm[n]=Pm[t]})});function OR(t,n,r){return n==null||typeof n=="boolean"||n===""?"":r||typeof n!="number"||n===0||Pm.hasOwnProperty(t)&&Pm[t]?(""+n).trim():n+"px"}function DR(t,n){t=t.style;for(var r in n)if(n.hasOwnProperty(r)){var s=r.indexOf("--")===0,i=OR(r,n[r],s);r==="float"&&(r="cssFloat"),s?t.setProperty(r,i):t[r]=i}}var CK=Jn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function H2(t,n){if(n){if(CK[t]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(Fe(137,t));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(Fe(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(Fe(61))}if(n.style!=null&&typeof n.style!="object")throw Error(Fe(62))}}function W2(t,n){if(t.indexOf("-")===-1)return typeof n.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var q2=null;function QC(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var G2=null,jf=null,Sf=null;function rT(t){if(t=ax(t)){if(typeof G2!="function")throw Error(Fe(280));var n=t.stateNode;n&&(n=Yy(n),G2(t.stateNode,t.type,n))}}function RR(t){jf?Sf?Sf.push(t):Sf=[t]:jf=t}function LR(){if(jf){var t=jf,n=Sf;if(Sf=jf=null,rT(t),n)for(t=0;t<n.length;t++)rT(n[t])}}function BR(t,n){return t(n)}function FR(){}var ww=!1;function $R(t,n,r){if(ww)return t(n,r);ww=!0;try{return BR(t,n,r)}finally{ww=!1,(jf!==null||Sf!==null)&&(FR(),LR())}}function tp(t,n){var r=t.stateNode;if(r===null)return null;var s=Yy(r);if(s===null)return null;r=s[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Fe(231,n,typeof r));return r}var K2=!1;if(ll)try{var Xh={};Object.defineProperty(Xh,"passive",{get:function(){K2=!0}}),window.addEventListener("test",Xh,Xh),window.removeEventListener("test",Xh,Xh)}catch{K2=!1}function _K(t,n,r,s,i,o,l,c,d){var u=Array.prototype.slice.call(arguments,3);try{n.apply(r,u)}catch(h){this.onError(h)}}var Mm=!1,Wg=null,qg=!1,Y2=null,AK={onError:function(t){Mm=!0,Wg=t}};function EK(t,n,r,s,i,o,l,c,d){Mm=!1,Wg=null,_K.apply(AK,arguments)}function kK(t,n,r,s,i,o,l,c,d){if(EK.apply(this,arguments),Mm){if(Mm){var u=Wg;Mm=!1,Wg=null}else throw Error(Fe(198));qg||(qg=!0,Y2=u)}}function ju(t){var n=t,r=t;if(t.alternate)for(;n.return;)n=n.return;else{t=n;do n=t,n.flags&4098&&(r=n.return),t=n.return;while(t)}return n.tag===3?r:null}function zR(t){if(t.tag===13){var n=t.memoizedState;if(n===null&&(t=t.alternate,t!==null&&(n=t.memoizedState)),n!==null)return n.dehydrated}return null}function sT(t){if(ju(t)!==t)throw Error(Fe(188))}function TK(t){var n=t.alternate;if(!n){if(n=ju(t),n===null)throw Error(Fe(188));return n!==t?null:t}for(var r=t,s=n;;){var i=r.return;if(i===null)break;var o=i.alternate;if(o===null){if(s=i.return,s!==null){r=s;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===r)return sT(i),t;if(o===s)return sT(i),n;o=o.sibling}throw Error(Fe(188))}if(r.return!==s.return)r=i,s=o;else{for(var l=!1,c=i.child;c;){if(c===r){l=!0,r=i,s=o;break}if(c===s){l=!0,s=i,r=o;break}c=c.sibling}if(!l){for(c=o.child;c;){if(c===r){l=!0,r=o,s=i;break}if(c===s){l=!0,s=o,r=i;break}c=c.sibling}if(!l)throw Error(Fe(189))}}if(r.alternate!==s)throw Error(Fe(190))}if(r.tag!==3)throw Error(Fe(188));return r.stateNode.current===r?t:n}function UR(t){return t=TK(t),t!==null?VR(t):null}function VR(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var n=VR(t);if(n!==null)return n;t=t.sibling}return null}var HR=Ra.unstable_scheduleCallback,aT=Ra.unstable_cancelCallback,IK=Ra.unstable_shouldYield,PK=Ra.unstable_requestPaint,xr=Ra.unstable_now,MK=Ra.unstable_getCurrentPriorityLevel,ZC=Ra.unstable_ImmediatePriority,WR=Ra.unstable_UserBlockingPriority,Gg=Ra.unstable_NormalPriority,OK=Ra.unstable_LowPriority,qR=Ra.unstable_IdlePriority,Wy=null,go=null;function DK(t){if(go&&typeof go.onCommitFiberRoot=="function")try{go.onCommitFiberRoot(Wy,t,void 0,(t.current.flags&128)===128)}catch{}}var Ri=Math.clz32?Math.clz32:BK,RK=Math.log,LK=Math.LN2;function BK(t){return t>>>=0,t===0?32:31-(RK(t)/LK|0)|0}var Yx=64,Xx=4194304;function jm(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Kg(t,n){var r=t.pendingLanes;if(r===0)return 0;var s=0,i=t.suspendedLanes,o=t.pingedLanes,l=r&268435455;if(l!==0){var c=l&~i;c!==0?s=jm(c):(o&=l,o!==0&&(s=jm(o)))}else l=r&~i,l!==0?s=jm(l):o!==0&&(s=jm(o));if(s===0)return 0;if(n!==0&&n!==s&&!(n&i)&&(i=s&-s,o=n&-n,i>=o||i===16&&(o&4194240)!==0))return n;if(s&4&&(s|=r&16),n=t.entangledLanes,n!==0)for(t=t.entanglements,n&=s;0<n;)r=31-Ri(n),i=1<<r,s|=t[r],n&=~i;return s}function FK(t,n){switch(t){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $K(t,n){for(var r=t.suspendedLanes,s=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var l=31-Ri(o),c=1<<l,d=i[l];d===-1?(!(c&r)||c&s)&&(i[l]=FK(c,n)):d<=n&&(t.expiredLanes|=c),o&=~c}}function X2(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function GR(){var t=Yx;return Yx<<=1,!(Yx&4194240)&&(Yx=64),t}function Nw(t){for(var n=[],r=0;31>r;r++)n.push(t);return n}function rx(t,n,r){t.pendingLanes|=n,n!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,n=31-Ri(n),t[n]=r}function zK(t,n){var r=t.pendingLanes&~n;t.pendingLanes=n,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=n,t.mutableReadLanes&=n,t.entangledLanes&=n,n=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-Ri(r),o=1<<i;n[i]=0,s[i]=-1,t[i]=-1,r&=~o}}function JC(t,n){var r=t.entangledLanes|=n;for(t=t.entanglements;r;){var s=31-Ri(r),i=1<<s;i&n|t[s]&n&&(t[s]|=n),r&=~i}}var fn=0;function KR(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var YR,e_,XR,QR,ZR,Q2=!1,Qx=[],uc=null,fc=null,hc=null,np=new Map,rp=new Map,tc=[],UK="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function iT(t,n){switch(t){case"focusin":case"focusout":uc=null;break;case"dragenter":case"dragleave":fc=null;break;case"mouseover":case"mouseout":hc=null;break;case"pointerover":case"pointerout":np.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":rp.delete(n.pointerId)}}function Qh(t,n,r,s,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:n,domEventName:r,eventSystemFlags:s,nativeEvent:o,targetContainers:[i]},n!==null&&(n=ax(n),n!==null&&e_(n)),t):(t.eventSystemFlags|=s,n=t.targetContainers,i!==null&&n.indexOf(i)===-1&&n.push(i),t)}function VK(t,n,r,s,i){switch(n){case"focusin":return uc=Qh(uc,t,n,r,s,i),!0;case"dragenter":return fc=Qh(fc,t,n,r,s,i),!0;case"mouseover":return hc=Qh(hc,t,n,r,s,i),!0;case"pointerover":var o=i.pointerId;return np.set(o,Qh(np.get(o)||null,t,n,r,s,i)),!0;case"gotpointercapture":return o=i.pointerId,rp.set(o,Qh(rp.get(o)||null,t,n,r,s,i)),!0}return!1}function JR(t){var n=Sd(t.target);if(n!==null){var r=ju(n);if(r!==null){if(n=r.tag,n===13){if(n=zR(r),n!==null){t.blockedOn=n,ZR(t.priority,function(){XR(r)});return}}else if(n===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function lg(t){if(t.blockedOn!==null)return!1;for(var n=t.targetContainers;0<n.length;){var r=Z2(t.domEventName,t.eventSystemFlags,n[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var s=new r.constructor(r.type,r);q2=s,r.target.dispatchEvent(s),q2=null}else return n=ax(r),n!==null&&e_(n),t.blockedOn=r,!1;n.shift()}return!0}function oT(t,n,r){lg(t)&&r.delete(n)}function HK(){Q2=!1,uc!==null&&lg(uc)&&(uc=null),fc!==null&&lg(fc)&&(fc=null),hc!==null&&lg(hc)&&(hc=null),np.forEach(oT),rp.forEach(oT)}function Zh(t,n){t.blockedOn===n&&(t.blockedOn=null,Q2||(Q2=!0,Ra.unstable_scheduleCallback(Ra.unstable_NormalPriority,HK)))}function sp(t){function n(i){return Zh(i,t)}if(0<Qx.length){Zh(Qx[0],t);for(var r=1;r<Qx.length;r++){var s=Qx[r];s.blockedOn===t&&(s.blockedOn=null)}}for(uc!==null&&Zh(uc,t),fc!==null&&Zh(fc,t),hc!==null&&Zh(hc,t),np.forEach(n),rp.forEach(n),r=0;r<tc.length;r++)s=tc[r],s.blockedOn===t&&(s.blockedOn=null);for(;0<tc.length&&(r=tc[0],r.blockedOn===null);)JR(r),r.blockedOn===null&&tc.shift()}var Cf=Sl.ReactCurrentBatchConfig,Yg=!0;function WK(t,n,r,s){var i=fn,o=Cf.transition;Cf.transition=null;try{fn=1,t_(t,n,r,s)}finally{fn=i,Cf.transition=o}}function qK(t,n,r,s){var i=fn,o=Cf.transition;Cf.transition=null;try{fn=4,t_(t,n,r,s)}finally{fn=i,Cf.transition=o}}function t_(t,n,r,s){if(Yg){var i=Z2(t,n,r,s);if(i===null)Pw(t,n,s,Xg,r),iT(t,s);else if(VK(i,t,n,r,s))s.stopPropagation();else if(iT(t,s),n&4&&-1<UK.indexOf(t)){for(;i!==null;){var o=ax(i);if(o!==null&&YR(o),o=Z2(t,n,r,s),o===null&&Pw(t,n,s,Xg,r),o===i)break;i=o}i!==null&&s.stopPropagation()}else Pw(t,n,s,null,r)}}var Xg=null;function Z2(t,n,r,s){if(Xg=null,t=QC(s),t=Sd(t),t!==null)if(n=ju(t),n===null)t=null;else if(r=n.tag,r===13){if(t=zR(n),t!==null)return t;t=null}else if(r===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;t=null}else n!==t&&(t=null);return Xg=t,null}function e8(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(MK()){case ZC:return 1;case WR:return 4;case Gg:case OK:return 16;case qR:return 536870912;default:return 16}default:return 16}}var ac=null,n_=null,cg=null;function t8(){if(cg)return cg;var t,n=n_,r=n.length,s,i="value"in ac?ac.value:ac.textContent,o=i.length;for(t=0;t<r&&n[t]===i[t];t++);var l=r-t;for(s=1;s<=l&&n[r-s]===i[o-s];s++);return cg=i.slice(t,1<s?1-s:void 0)}function dg(t){var n=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&n===13&&(t=13)):t=n,t===10&&(t=13),32<=t||t===13?t:0}function Zx(){return!0}function lT(){return!1}function za(t){function n(r,s,i,o,l){this._reactName=r,this._targetInst=i,this.type=s,this.nativeEvent=o,this.target=l,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(r=t[c],this[c]=r?r(o):o[c]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Zx:lT,this.isPropagationStopped=lT,this}return Jn(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Zx)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Zx)},persist:function(){},isPersistent:Zx}),n}var fh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},r_=za(fh),sx=Jn({},fh,{view:0,detail:0}),GK=za(sx),jw,Sw,Jh,qy=Jn({},sx,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:s_,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Jh&&(Jh&&t.type==="mousemove"?(jw=t.screenX-Jh.screenX,Sw=t.screenY-Jh.screenY):Sw=jw=0,Jh=t),jw)},movementY:function(t){return"movementY"in t?t.movementY:Sw}}),cT=za(qy),KK=Jn({},qy,{dataTransfer:0}),YK=za(KK),XK=Jn({},sx,{relatedTarget:0}),Cw=za(XK),QK=Jn({},fh,{animationName:0,elapsedTime:0,pseudoElement:0}),ZK=za(QK),JK=Jn({},fh,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),eY=za(JK),tY=Jn({},fh,{data:0}),dT=za(tY),nY={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},rY={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},sY={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function aY(t){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(t):(t=sY[t])?!!n[t]:!1}function s_(){return aY}var iY=Jn({},sx,{key:function(t){if(t.key){var n=nY[t.key]||t.key;if(n!=="Unidentified")return n}return t.type==="keypress"?(t=dg(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?rY[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:s_,charCode:function(t){return t.type==="keypress"?dg(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?dg(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),oY=za(iY),lY=Jn({},qy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),uT=za(lY),cY=Jn({},sx,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:s_}),dY=za(cY),uY=Jn({},fh,{propertyName:0,elapsedTime:0,pseudoElement:0}),fY=za(uY),hY=Jn({},qy,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),mY=za(hY),pY=[9,13,27,32],a_=ll&&"CompositionEvent"in window,Om=null;ll&&"documentMode"in document&&(Om=document.documentMode);var xY=ll&&"TextEvent"in window&&!Om,n8=ll&&(!a_||Om&&8<Om&&11>=Om),fT=" ",hT=!1;function r8(t,n){switch(t){case"keyup":return pY.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function s8(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ef=!1;function gY(t,n){switch(t){case"compositionend":return s8(n);case"keypress":return n.which!==32?null:(hT=!0,fT);case"textInput":return t=n.data,t===fT&&hT?null:t;default:return null}}function yY(t,n){if(ef)return t==="compositionend"||!a_&&r8(t,n)?(t=t8(),cg=n_=ac=null,ef=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return n8&&n.locale!=="ko"?null:n.data;default:return null}}var vY={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mT(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n==="input"?!!vY[t.type]:n==="textarea"}function a8(t,n,r,s){RR(s),n=Qg(n,"onChange"),0<n.length&&(r=new r_("onChange","change",null,r,s),t.push({event:r,listeners:n}))}var Dm=null,ap=null;function bY(t){x8(t,0)}function Gy(t){var n=rf(t);if(kR(n))return t}function wY(t,n){if(t==="change")return n}var i8=!1;if(ll){var _w;if(ll){var Aw="oninput"in document;if(!Aw){var pT=document.createElement("div");pT.setAttribute("oninput","return;"),Aw=typeof pT.oninput=="function"}_w=Aw}else _w=!1;i8=_w&&(!document.documentMode||9<document.documentMode)}function xT(){Dm&&(Dm.detachEvent("onpropertychange",o8),ap=Dm=null)}function o8(t){if(t.propertyName==="value"&&Gy(ap)){var n=[];a8(n,ap,t,QC(t)),$R(bY,n)}}function NY(t,n,r){t==="focusin"?(xT(),Dm=n,ap=r,Dm.attachEvent("onpropertychange",o8)):t==="focusout"&&xT()}function jY(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Gy(ap)}function SY(t,n){if(t==="click")return Gy(n)}function CY(t,n){if(t==="input"||t==="change")return Gy(n)}function _Y(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var $i=typeof Object.is=="function"?Object.is:_Y;function ip(t,n){if($i(t,n))return!0;if(typeof t!="object"||t===null||typeof n!="object"||n===null)return!1;var r=Object.keys(t),s=Object.keys(n);if(r.length!==s.length)return!1;for(s=0;s<r.length;s++){var i=r[s];if(!O2.call(n,i)||!$i(t[i],n[i]))return!1}return!0}function gT(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function yT(t,n){var r=gT(t);t=0;for(var s;r;){if(r.nodeType===3){if(s=t+r.textContent.length,t<=n&&s>=n)return{node:r,offset:n-t};t=s}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=gT(r)}}function l8(t,n){return t&&n?t===n?!0:t&&t.nodeType===3?!1:n&&n.nodeType===3?l8(t,n.parentNode):"contains"in t?t.contains(n):t.compareDocumentPosition?!!(t.compareDocumentPosition(n)&16):!1:!1}function c8(){for(var t=window,n=Hg();n instanceof t.HTMLIFrameElement;){try{var r=typeof n.contentWindow.location.href=="string"}catch{r=!1}if(r)t=n.contentWindow;else break;n=Hg(t.document)}return n}function i_(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n&&(n==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||n==="textarea"||t.contentEditable==="true")}function AY(t){var n=c8(),r=t.focusedElem,s=t.selectionRange;if(n!==r&&r&&r.ownerDocument&&l8(r.ownerDocument.documentElement,r)){if(s!==null&&i_(r)){if(n=s.start,t=s.end,t===void 0&&(t=n),"selectionStart"in r)r.selectionStart=n,r.selectionEnd=Math.min(t,r.value.length);else if(t=(n=r.ownerDocument||document)&&n.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,o=Math.min(s.start,i);s=s.end===void 0?o:Math.min(s.end,i),!t.extend&&o>s&&(i=s,s=o,o=i),i=yT(r,o);var l=yT(r,s);i&&l&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==l.node||t.focusOffset!==l.offset)&&(n=n.createRange(),n.setStart(i.node,i.offset),t.removeAllRanges(),o>s?(t.addRange(n),t.extend(l.node,l.offset)):(n.setEnd(l.node,l.offset),t.addRange(n)))}}for(n=[],t=r;t=t.parentNode;)t.nodeType===1&&n.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<n.length;r++)t=n[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var EY=ll&&"documentMode"in document&&11>=document.documentMode,tf=null,J2=null,Rm=null,ej=!1;function vT(t,n,r){var s=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;ej||tf==null||tf!==Hg(s)||(s=tf,"selectionStart"in s&&i_(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Rm&&ip(Rm,s)||(Rm=s,s=Qg(J2,"onSelect"),0<s.length&&(n=new r_("onSelect","select",null,n,r),t.push({event:n,listeners:s}),n.target=tf)))}function Jx(t,n){var r={};return r[t.toLowerCase()]=n.toLowerCase(),r["Webkit"+t]="webkit"+n,r["Moz"+t]="moz"+n,r}var nf={animationend:Jx("Animation","AnimationEnd"),animationiteration:Jx("Animation","AnimationIteration"),animationstart:Jx("Animation","AnimationStart"),transitionend:Jx("Transition","TransitionEnd")},Ew={},d8={};ll&&(d8=document.createElement("div").style,"AnimationEvent"in window||(delete nf.animationend.animation,delete nf.animationiteration.animation,delete nf.animationstart.animation),"TransitionEvent"in window||delete nf.transitionend.transition);function Ky(t){if(Ew[t])return Ew[t];if(!nf[t])return t;var n=nf[t],r;for(r in n)if(n.hasOwnProperty(r)&&r in d8)return Ew[t]=n[r];return t}var u8=Ky("animationend"),f8=Ky("animationiteration"),h8=Ky("animationstart"),m8=Ky("transitionend"),p8=new Map,bT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $c(t,n){p8.set(t,n),Nu(n,[t])}for(var kw=0;kw<bT.length;kw++){var Tw=bT[kw],kY=Tw.toLowerCase(),TY=Tw[0].toUpperCase()+Tw.slice(1);$c(kY,"on"+TY)}$c(u8,"onAnimationEnd");$c(f8,"onAnimationIteration");$c(h8,"onAnimationStart");$c("dblclick","onDoubleClick");$c("focusin","onFocus");$c("focusout","onBlur");$c(m8,"onTransitionEnd");Df("onMouseEnter",["mouseout","mouseover"]);Df("onMouseLeave",["mouseout","mouseover"]);Df("onPointerEnter",["pointerout","pointerover"]);Df("onPointerLeave",["pointerout","pointerover"]);Nu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Nu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Nu("onBeforeInput",["compositionend","keypress","textInput","paste"]);Nu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Nu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Nu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),IY=new Set("cancel close invalid load scroll toggle".split(" ").concat(Sm));function wT(t,n,r){var s=t.type||"unknown-event";t.currentTarget=r,kK(s,n,void 0,t),t.currentTarget=null}function x8(t,n){n=(n&4)!==0;for(var r=0;r<t.length;r++){var s=t[r],i=s.event;s=s.listeners;e:{var o=void 0;if(n)for(var l=s.length-1;0<=l;l--){var c=s[l],d=c.instance,u=c.currentTarget;if(c=c.listener,d!==o&&i.isPropagationStopped())break e;wT(i,c,u),o=d}else for(l=0;l<s.length;l++){if(c=s[l],d=c.instance,u=c.currentTarget,c=c.listener,d!==o&&i.isPropagationStopped())break e;wT(i,c,u),o=d}}}if(qg)throw t=Y2,qg=!1,Y2=null,t}function Mn(t,n){var r=n[aj];r===void 0&&(r=n[aj]=new Set);var s=t+"__bubble";r.has(s)||(g8(n,t,2,!1),r.add(s))}function Iw(t,n,r){var s=0;n&&(s|=4),g8(r,t,s,n)}var e0="_reactListening"+Math.random().toString(36).slice(2);function op(t){if(!t[e0]){t[e0]=!0,SR.forEach(function(r){r!=="selectionchange"&&(IY.has(r)||Iw(r,!1,t),Iw(r,!0,t))});var n=t.nodeType===9?t:t.ownerDocument;n===null||n[e0]||(n[e0]=!0,Iw("selectionchange",!1,n))}}function g8(t,n,r,s){switch(e8(n)){case 1:var i=WK;break;case 4:i=qK;break;default:i=t_}r=i.bind(null,n,r,t),i=void 0,!K2||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(i=!0),s?i!==void 0?t.addEventListener(n,r,{capture:!0,passive:i}):t.addEventListener(n,r,!0):i!==void 0?t.addEventListener(n,r,{passive:i}):t.addEventListener(n,r,!1)}function Pw(t,n,r,s,i){var o=s;if(!(n&1)&&!(n&2)&&s!==null)e:for(;;){if(s===null)return;var l=s.tag;if(l===3||l===4){var c=s.stateNode.containerInfo;if(c===i||c.nodeType===8&&c.parentNode===i)break;if(l===4)for(l=s.return;l!==null;){var d=l.tag;if((d===3||d===4)&&(d=l.stateNode.containerInfo,d===i||d.nodeType===8&&d.parentNode===i))return;l=l.return}for(;c!==null;){if(l=Sd(c),l===null)return;if(d=l.tag,d===5||d===6){s=o=l;continue e}c=c.parentNode}}s=s.return}$R(function(){var u=o,h=QC(r),m=[];e:{var g=p8.get(t);if(g!==void 0){var y=r_,N=t;switch(t){case"keypress":if(dg(r)===0)break e;case"keydown":case"keyup":y=oY;break;case"focusin":N="focus",y=Cw;break;case"focusout":N="blur",y=Cw;break;case"beforeblur":case"afterblur":y=Cw;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=cT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=YK;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=dY;break;case u8:case f8:case h8:y=ZK;break;case m8:y=fY;break;case"scroll":y=GK;break;case"wheel":y=mY;break;case"copy":case"cut":case"paste":y=eY;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=uT}var j=(n&4)!==0,S=!j&&t==="scroll",_=j?g!==null?g+"Capture":null:g;j=[];for(var A=u,k;A!==null;){k=A;var T=k.stateNode;if(k.tag===5&&T!==null&&(k=T,_!==null&&(T=tp(A,_),T!=null&&j.push(lp(A,T,k)))),S)break;A=A.return}0<j.length&&(g=new y(g,N,null,r,h),m.push({event:g,listeners:j}))}}if(!(n&7)){e:{if(g=t==="mouseover"||t==="pointerover",y=t==="mouseout"||t==="pointerout",g&&r!==q2&&(N=r.relatedTarget||r.fromElement)&&(Sd(N)||N[cl]))break e;if((y||g)&&(g=h.window===h?h:(g=h.ownerDocument)?g.defaultView||g.parentWindow:window,y?(N=r.relatedTarget||r.toElement,y=u,N=N?Sd(N):null,N!==null&&(S=ju(N),N!==S||N.tag!==5&&N.tag!==6)&&(N=null)):(y=null,N=u),y!==N)){if(j=cT,T="onMouseLeave",_="onMouseEnter",A="mouse",(t==="pointerout"||t==="pointerover")&&(j=uT,T="onPointerLeave",_="onPointerEnter",A="pointer"),S=y==null?g:rf(y),k=N==null?g:rf(N),g=new j(T,A+"leave",y,r,h),g.target=S,g.relatedTarget=k,T=null,Sd(h)===u&&(j=new j(_,A+"enter",N,r,h),j.target=k,j.relatedTarget=S,T=j),S=T,y&&N)t:{for(j=y,_=N,A=0,k=j;k;k=$u(k))A++;for(k=0,T=_;T;T=$u(T))k++;for(;0<A-k;)j=$u(j),A--;for(;0<k-A;)_=$u(_),k--;for(;A--;){if(j===_||_!==null&&j===_.alternate)break t;j=$u(j),_=$u(_)}j=null}else j=null;y!==null&&NT(m,g,y,j,!1),N!==null&&S!==null&&NT(m,S,N,j,!0)}}e:{if(g=u?rf(u):window,y=g.nodeName&&g.nodeName.toLowerCase(),y==="select"||y==="input"&&g.type==="file")var P=wY;else if(mT(g))if(i8)P=CY;else{P=jY;var M=NY}else(y=g.nodeName)&&y.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(P=SY);if(P&&(P=P(t,u))){a8(m,P,r,h);break e}M&&M(t,g,u),t==="focusout"&&(M=g._wrapperState)&&M.controlled&&g.type==="number"&&z2(g,"number",g.value)}switch(M=u?rf(u):window,t){case"focusin":(mT(M)||M.contentEditable==="true")&&(tf=M,J2=u,Rm=null);break;case"focusout":Rm=J2=tf=null;break;case"mousedown":ej=!0;break;case"contextmenu":case"mouseup":case"dragend":ej=!1,vT(m,r,h);break;case"selectionchange":if(EY)break;case"keydown":case"keyup":vT(m,r,h)}var O;if(a_)e:{switch(t){case"compositionstart":var D="onCompositionStart";break e;case"compositionend":D="onCompositionEnd";break e;case"compositionupdate":D="onCompositionUpdate";break e}D=void 0}else ef?r8(t,r)&&(D="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(D="onCompositionStart");D&&(n8&&r.locale!=="ko"&&(ef||D!=="onCompositionStart"?D==="onCompositionEnd"&&ef&&(O=t8()):(ac=h,n_="value"in ac?ac.value:ac.textContent,ef=!0)),M=Qg(u,D),0<M.length&&(D=new dT(D,t,null,r,h),m.push({event:D,listeners:M}),O?D.data=O:(O=s8(r),O!==null&&(D.data=O)))),(O=xY?gY(t,r):yY(t,r))&&(u=Qg(u,"onBeforeInput"),0<u.length&&(h=new dT("onBeforeInput","beforeinput",null,r,h),m.push({event:h,listeners:u}),h.data=O))}x8(m,n)})}function lp(t,n,r){return{instance:t,listener:n,currentTarget:r}}function Qg(t,n){for(var r=n+"Capture",s=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=tp(t,r),o!=null&&s.unshift(lp(t,o,i)),o=tp(t,n),o!=null&&s.push(lp(t,o,i))),t=t.return}return s}function $u(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function NT(t,n,r,s,i){for(var o=n._reactName,l=[];r!==null&&r!==s;){var c=r,d=c.alternate,u=c.stateNode;if(d!==null&&d===s)break;c.tag===5&&u!==null&&(c=u,i?(d=tp(r,o),d!=null&&l.unshift(lp(r,d,c))):i||(d=tp(r,o),d!=null&&l.push(lp(r,d,c)))),r=r.return}l.length!==0&&t.push({event:n,listeners:l})}var PY=/\r\n?/g,MY=/\u0000|\uFFFD/g;function jT(t){return(typeof t=="string"?t:""+t).replace(PY,`
`).replace(MY,"")}function t0(t,n,r){if(n=jT(n),jT(t)!==n&&r)throw Error(Fe(425))}function Zg(){}var tj=null,nj=null;function rj(t,n){return t==="textarea"||t==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var sj=typeof setTimeout=="function"?setTimeout:void 0,OY=typeof clearTimeout=="function"?clearTimeout:void 0,ST=typeof Promise=="function"?Promise:void 0,DY=typeof queueMicrotask=="function"?queueMicrotask:typeof ST<"u"?function(t){return ST.resolve(null).then(t).catch(RY)}:sj;function RY(t){setTimeout(function(){throw t})}function Mw(t,n){var r=n,s=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(s===0){t.removeChild(i),sp(n);return}s--}else r!=="$"&&r!=="$?"&&r!=="$!"||s++;r=i}while(r);sp(n)}function mc(t){for(;t!=null;t=t.nextSibling){var n=t.nodeType;if(n===1||n===3)break;if(n===8){if(n=t.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return t}function CT(t){t=t.previousSibling;for(var n=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(n===0)return t;n--}else r==="/$"&&n++}t=t.previousSibling}return null}var hh=Math.random().toString(36).slice(2),uo="__reactFiber$"+hh,cp="__reactProps$"+hh,cl="__reactContainer$"+hh,aj="__reactEvents$"+hh,LY="__reactListeners$"+hh,BY="__reactHandles$"+hh;function Sd(t){var n=t[uo];if(n)return n;for(var r=t.parentNode;r;){if(n=r[cl]||r[uo]){if(r=n.alternate,n.child!==null||r!==null&&r.child!==null)for(t=CT(t);t!==null;){if(r=t[uo])return r;t=CT(t)}return n}t=r,r=t.parentNode}return null}function ax(t){return t=t[uo]||t[cl],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function rf(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Fe(33))}function Yy(t){return t[cp]||null}var ij=[],sf=-1;function zc(t){return{current:t}}function Rn(t){0>sf||(t.current=ij[sf],ij[sf]=null,sf--)}function En(t,n){sf++,ij[sf]=t.current,t.current=n}var Ac={},Os=zc(Ac),la=zc(!1),Zd=Ac;function Rf(t,n){var r=t.type.contextTypes;if(!r)return Ac;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===n)return s.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in r)i[o]=n[o];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=n,t.__reactInternalMemoizedMaskedChildContext=i),i}function ca(t){return t=t.childContextTypes,t!=null}function Jg(){Rn(la),Rn(Os)}function _T(t,n,r){if(Os.current!==Ac)throw Error(Fe(168));En(Os,n),En(la,r)}function y8(t,n,r){var s=t.stateNode;if(n=n.childContextTypes,typeof s.getChildContext!="function")return r;s=s.getChildContext();for(var i in s)if(!(i in n))throw Error(Fe(108,NK(t)||"Unknown",i));return Jn({},r,s)}function e1(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ac,Zd=Os.current,En(Os,t),En(la,la.current),!0}function AT(t,n,r){var s=t.stateNode;if(!s)throw Error(Fe(169));r?(t=y8(t,n,Zd),s.__reactInternalMemoizedMergedChildContext=t,Rn(la),Rn(Os),En(Os,t)):Rn(la),En(la,r)}var Yo=null,Xy=!1,Ow=!1;function v8(t){Yo===null?Yo=[t]:Yo.push(t)}function FY(t){Xy=!0,v8(t)}function Uc(){if(!Ow&&Yo!==null){Ow=!0;var t=0,n=fn;try{var r=Yo;for(fn=1;t<r.length;t++){var s=r[t];do s=s(!0);while(s!==null)}Yo=null,Xy=!1}catch(i){throw Yo!==null&&(Yo=Yo.slice(t+1)),HR(ZC,Uc),i}finally{fn=n,Ow=!1}}return null}var af=[],of=0,t1=null,n1=0,ri=[],si=0,Jd=null,Jo=1,el="";function fd(t,n){af[of++]=n1,af[of++]=t1,t1=t,n1=n}function b8(t,n,r){ri[si++]=Jo,ri[si++]=el,ri[si++]=Jd,Jd=t;var s=Jo;t=el;var i=32-Ri(s)-1;s&=~(1<<i),r+=1;var o=32-Ri(n)+i;if(30<o){var l=i-i%5;o=(s&(1<<l)-1).toString(32),s>>=l,i-=l,Jo=1<<32-Ri(n)+i|r<<i|s,el=o+t}else Jo=1<<o|r<<i|s,el=t}function o_(t){t.return!==null&&(fd(t,1),b8(t,1,0))}function l_(t){for(;t===t1;)t1=af[--of],af[of]=null,n1=af[--of],af[of]=null;for(;t===Jd;)Jd=ri[--si],ri[si]=null,el=ri[--si],ri[si]=null,Jo=ri[--si],ri[si]=null}var Pa=null,Ta=null,Fn=!1,Ii=null;function w8(t,n){var r=ai(5,null,null,0);r.elementType="DELETED",r.stateNode=n,r.return=t,n=t.deletions,n===null?(t.deletions=[r],t.flags|=16):n.push(r)}function ET(t,n){switch(t.tag){case 5:var r=t.type;return n=n.nodeType!==1||r.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(t.stateNode=n,Pa=t,Ta=mc(n.firstChild),!0):!1;case 6:return n=t.pendingProps===""||n.nodeType!==3?null:n,n!==null?(t.stateNode=n,Pa=t,Ta=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(r=Jd!==null?{id:Jo,overflow:el}:null,t.memoizedState={dehydrated:n,treeContext:r,retryLane:1073741824},r=ai(18,null,null,0),r.stateNode=n,r.return=t,t.child=r,Pa=t,Ta=null,!0):!1;default:return!1}}function oj(t){return(t.mode&1)!==0&&(t.flags&128)===0}function lj(t){if(Fn){var n=Ta;if(n){var r=n;if(!ET(t,n)){if(oj(t))throw Error(Fe(418));n=mc(r.nextSibling);var s=Pa;n&&ET(t,n)?w8(s,r):(t.flags=t.flags&-4097|2,Fn=!1,Pa=t)}}else{if(oj(t))throw Error(Fe(418));t.flags=t.flags&-4097|2,Fn=!1,Pa=t}}}function kT(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Pa=t}function n0(t){if(t!==Pa)return!1;if(!Fn)return kT(t),Fn=!0,!1;var n;if((n=t.tag!==3)&&!(n=t.tag!==5)&&(n=t.type,n=n!=="head"&&n!=="body"&&!rj(t.type,t.memoizedProps)),n&&(n=Ta)){if(oj(t))throw N8(),Error(Fe(418));for(;n;)w8(t,n),n=mc(n.nextSibling)}if(kT(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Fe(317));e:{for(t=t.nextSibling,n=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(n===0){Ta=mc(t.nextSibling);break e}n--}else r!=="$"&&r!=="$!"&&r!=="$?"||n++}t=t.nextSibling}Ta=null}}else Ta=Pa?mc(t.stateNode.nextSibling):null;return!0}function N8(){for(var t=Ta;t;)t=mc(t.nextSibling)}function Lf(){Ta=Pa=null,Fn=!1}function c_(t){Ii===null?Ii=[t]:Ii.push(t)}var $Y=Sl.ReactCurrentBatchConfig;function em(t,n,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Fe(309));var s=r.stateNode}if(!s)throw Error(Fe(147,t));var i=s,o=""+t;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===o?n.ref:(n=function(l){var c=i.refs;l===null?delete c[o]:c[o]=l},n._stringRef=o,n)}if(typeof t!="string")throw Error(Fe(284));if(!r._owner)throw Error(Fe(290,t))}return t}function r0(t,n){throw t=Object.prototype.toString.call(n),Error(Fe(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t))}function TT(t){var n=t._init;return n(t._payload)}function j8(t){function n(_,A){if(t){var k=_.deletions;k===null?(_.deletions=[A],_.flags|=16):k.push(A)}}function r(_,A){if(!t)return null;for(;A!==null;)n(_,A),A=A.sibling;return null}function s(_,A){for(_=new Map;A!==null;)A.key!==null?_.set(A.key,A):_.set(A.index,A),A=A.sibling;return _}function i(_,A){return _=yc(_,A),_.index=0,_.sibling=null,_}function o(_,A,k){return _.index=k,t?(k=_.alternate,k!==null?(k=k.index,k<A?(_.flags|=2,A):k):(_.flags|=2,A)):(_.flags|=1048576,A)}function l(_){return t&&_.alternate===null&&(_.flags|=2),_}function c(_,A,k,T){return A===null||A.tag!==6?(A=zw(k,_.mode,T),A.return=_,A):(A=i(A,k),A.return=_,A)}function d(_,A,k,T){var P=k.type;return P===Ju?h(_,A,k.props.children,T,k.key):A!==null&&(A.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Yl&&TT(P)===A.type)?(T=i(A,k.props),T.ref=em(_,A,k),T.return=_,T):(T=gg(k.type,k.key,k.props,null,_.mode,T),T.ref=em(_,A,k),T.return=_,T)}function u(_,A,k,T){return A===null||A.tag!==4||A.stateNode.containerInfo!==k.containerInfo||A.stateNode.implementation!==k.implementation?(A=Uw(k,_.mode,T),A.return=_,A):(A=i(A,k.children||[]),A.return=_,A)}function h(_,A,k,T,P){return A===null||A.tag!==7?(A=Ld(k,_.mode,T,P),A.return=_,A):(A=i(A,k),A.return=_,A)}function m(_,A,k){if(typeof A=="string"&&A!==""||typeof A=="number")return A=zw(""+A,_.mode,k),A.return=_,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case qx:return k=gg(A.type,A.key,A.props,null,_.mode,k),k.ref=em(_,null,A),k.return=_,k;case Zu:return A=Uw(A,_.mode,k),A.return=_,A;case Yl:var T=A._init;return m(_,T(A._payload),k)}if(Nm(A)||Yh(A))return A=Ld(A,_.mode,k,null),A.return=_,A;r0(_,A)}return null}function g(_,A,k,T){var P=A!==null?A.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return P!==null?null:c(_,A,""+k,T);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case qx:return k.key===P?d(_,A,k,T):null;case Zu:return k.key===P?u(_,A,k,T):null;case Yl:return P=k._init,g(_,A,P(k._payload),T)}if(Nm(k)||Yh(k))return P!==null?null:h(_,A,k,T,null);r0(_,k)}return null}function y(_,A,k,T,P){if(typeof T=="string"&&T!==""||typeof T=="number")return _=_.get(k)||null,c(A,_,""+T,P);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case qx:return _=_.get(T.key===null?k:T.key)||null,d(A,_,T,P);case Zu:return _=_.get(T.key===null?k:T.key)||null,u(A,_,T,P);case Yl:var M=T._init;return y(_,A,k,M(T._payload),P)}if(Nm(T)||Yh(T))return _=_.get(k)||null,h(A,_,T,P,null);r0(A,T)}return null}function N(_,A,k,T){for(var P=null,M=null,O=A,D=A=0,L=null;O!==null&&D<k.length;D++){O.index>D?(L=O,O=null):L=O.sibling;var $=g(_,O,k[D],T);if($===null){O===null&&(O=L);break}t&&O&&$.alternate===null&&n(_,O),A=o($,A,D),M===null?P=$:M.sibling=$,M=$,O=L}if(D===k.length)return r(_,O),Fn&&fd(_,D),P;if(O===null){for(;D<k.length;D++)O=m(_,k[D],T),O!==null&&(A=o(O,A,D),M===null?P=O:M.sibling=O,M=O);return Fn&&fd(_,D),P}for(O=s(_,O);D<k.length;D++)L=y(O,_,D,k[D],T),L!==null&&(t&&L.alternate!==null&&O.delete(L.key===null?D:L.key),A=o(L,A,D),M===null?P=L:M.sibling=L,M=L);return t&&O.forEach(function(V){return n(_,V)}),Fn&&fd(_,D),P}function j(_,A,k,T){var P=Yh(k);if(typeof P!="function")throw Error(Fe(150));if(k=P.call(k),k==null)throw Error(Fe(151));for(var M=P=null,O=A,D=A=0,L=null,$=k.next();O!==null&&!$.done;D++,$=k.next()){O.index>D?(L=O,O=null):L=O.sibling;var V=g(_,O,$.value,T);if(V===null){O===null&&(O=L);break}t&&O&&V.alternate===null&&n(_,O),A=o(V,A,D),M===null?P=V:M.sibling=V,M=V,O=L}if($.done)return r(_,O),Fn&&fd(_,D),P;if(O===null){for(;!$.done;D++,$=k.next())$=m(_,$.value,T),$!==null&&(A=o($,A,D),M===null?P=$:M.sibling=$,M=$);return Fn&&fd(_,D),P}for(O=s(_,O);!$.done;D++,$=k.next())$=y(O,_,D,$.value,T),$!==null&&(t&&$.alternate!==null&&O.delete($.key===null?D:$.key),A=o($,A,D),M===null?P=$:M.sibling=$,M=$);return t&&O.forEach(function(F){return n(_,F)}),Fn&&fd(_,D),P}function S(_,A,k,T){if(typeof k=="object"&&k!==null&&k.type===Ju&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case qx:e:{for(var P=k.key,M=A;M!==null;){if(M.key===P){if(P=k.type,P===Ju){if(M.tag===7){r(_,M.sibling),A=i(M,k.props.children),A.return=_,_=A;break e}}else if(M.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Yl&&TT(P)===M.type){r(_,M.sibling),A=i(M,k.props),A.ref=em(_,M,k),A.return=_,_=A;break e}r(_,M);break}else n(_,M);M=M.sibling}k.type===Ju?(A=Ld(k.props.children,_.mode,T,k.key),A.return=_,_=A):(T=gg(k.type,k.key,k.props,null,_.mode,T),T.ref=em(_,A,k),T.return=_,_=T)}return l(_);case Zu:e:{for(M=k.key;A!==null;){if(A.key===M)if(A.tag===4&&A.stateNode.containerInfo===k.containerInfo&&A.stateNode.implementation===k.implementation){r(_,A.sibling),A=i(A,k.children||[]),A.return=_,_=A;break e}else{r(_,A);break}else n(_,A);A=A.sibling}A=Uw(k,_.mode,T),A.return=_,_=A}return l(_);case Yl:return M=k._init,S(_,A,M(k._payload),T)}if(Nm(k))return N(_,A,k,T);if(Yh(k))return j(_,A,k,T);r0(_,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,A!==null&&A.tag===6?(r(_,A.sibling),A=i(A,k),A.return=_,_=A):(r(_,A),A=zw(k,_.mode,T),A.return=_,_=A),l(_)):r(_,A)}return S}var Bf=j8(!0),S8=j8(!1),r1=zc(null),s1=null,lf=null,d_=null;function u_(){d_=lf=s1=null}function f_(t){var n=r1.current;Rn(r1),t._currentValue=n}function cj(t,n,r){for(;t!==null;){var s=t.alternate;if((t.childLanes&n)!==n?(t.childLanes|=n,s!==null&&(s.childLanes|=n)):s!==null&&(s.childLanes&n)!==n&&(s.childLanes|=n),t===r)break;t=t.return}}function _f(t,n){s1=t,d_=lf=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&n&&(aa=!0),t.firstContext=null)}function ui(t){var n=t._currentValue;if(d_!==t)if(t={context:t,memoizedValue:n,next:null},lf===null){if(s1===null)throw Error(Fe(308));lf=t,s1.dependencies={lanes:0,firstContext:t}}else lf=lf.next=t;return n}var Cd=null;function h_(t){Cd===null?Cd=[t]:Cd.push(t)}function C8(t,n,r,s){var i=n.interleaved;return i===null?(r.next=r,h_(n)):(r.next=i.next,i.next=r),n.interleaved=r,dl(t,s)}function dl(t,n){t.lanes|=n;var r=t.alternate;for(r!==null&&(r.lanes|=n),r=t,t=t.return;t!==null;)t.childLanes|=n,r=t.alternate,r!==null&&(r.childLanes|=n),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Xl=!1;function m_(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _8(t,n){t=t.updateQueue,n.updateQueue===t&&(n.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function al(t,n){return{eventTime:t,lane:n,tag:0,payload:null,callback:null,next:null}}function pc(t,n,r){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,Jt&2){var i=s.pending;return i===null?n.next=n:(n.next=i.next,i.next=n),s.pending=n,dl(t,r)}return i=s.interleaved,i===null?(n.next=n,h_(s)):(n.next=i.next,i.next=n),s.interleaved=n,dl(t,r)}function ug(t,n,r){if(n=n.updateQueue,n!==null&&(n=n.shared,(r&4194240)!==0)){var s=n.lanes;s&=t.pendingLanes,r|=s,n.lanes=r,JC(t,r)}}function IT(t,n){var r=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,r===s)){var i=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?i=o=l:o=o.next=l,r=r.next}while(r!==null);o===null?i=o=n:o=o.next=n}else i=o=n;r={baseState:s.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:s.shared,effects:s.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=n:t.next=n,r.lastBaseUpdate=n}function a1(t,n,r,s){var i=t.updateQueue;Xl=!1;var o=i.firstBaseUpdate,l=i.lastBaseUpdate,c=i.shared.pending;if(c!==null){i.shared.pending=null;var d=c,u=d.next;d.next=null,l===null?o=u:l.next=u,l=d;var h=t.alternate;h!==null&&(h=h.updateQueue,c=h.lastBaseUpdate,c!==l&&(c===null?h.firstBaseUpdate=u:c.next=u,h.lastBaseUpdate=d))}if(o!==null){var m=i.baseState;l=0,h=u=d=null,c=o;do{var g=c.lane,y=c.eventTime;if((s&g)===g){h!==null&&(h=h.next={eventTime:y,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var N=t,j=c;switch(g=n,y=r,j.tag){case 1:if(N=j.payload,typeof N=="function"){m=N.call(y,m,g);break e}m=N;break e;case 3:N.flags=N.flags&-65537|128;case 0:if(N=j.payload,g=typeof N=="function"?N.call(y,m,g):N,g==null)break e;m=Jn({},m,g);break e;case 2:Xl=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,g=i.effects,g===null?i.effects=[c]:g.push(c))}else y={eventTime:y,lane:g,tag:c.tag,payload:c.payload,callback:c.callback,next:null},h===null?(u=h=y,d=m):h=h.next=y,l|=g;if(c=c.next,c===null){if(c=i.shared.pending,c===null)break;g=c,c=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(h===null&&(d=m),i.baseState=d,i.firstBaseUpdate=u,i.lastBaseUpdate=h,n=i.shared.interleaved,n!==null){i=n;do l|=i.lane,i=i.next;while(i!==n)}else o===null&&(i.shared.lanes=0);tu|=l,t.lanes=l,t.memoizedState=m}}function PT(t,n,r){if(t=n.effects,n.effects=null,t!==null)for(n=0;n<t.length;n++){var s=t[n],i=s.callback;if(i!==null){if(s.callback=null,s=r,typeof i!="function")throw Error(Fe(191,i));i.call(s)}}}var ix={},yo=zc(ix),dp=zc(ix),up=zc(ix);function _d(t){if(t===ix)throw Error(Fe(174));return t}function p_(t,n){switch(En(up,n),En(dp,t),En(yo,ix),t=n.nodeType,t){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:V2(null,"");break;default:t=t===8?n.parentNode:n,n=t.namespaceURI||null,t=t.tagName,n=V2(n,t)}Rn(yo),En(yo,n)}function Ff(){Rn(yo),Rn(dp),Rn(up)}function A8(t){_d(up.current);var n=_d(yo.current),r=V2(n,t.type);n!==r&&(En(dp,t),En(yo,r))}function x_(t){dp.current===t&&(Rn(yo),Rn(dp))}var Kn=zc(0);function i1(t){for(var n=t;n!==null;){if(n.tag===13){var r=n.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if(n.flags&128)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var Dw=[];function g_(){for(var t=0;t<Dw.length;t++)Dw[t]._workInProgressVersionPrimary=null;Dw.length=0}var fg=Sl.ReactCurrentDispatcher,Rw=Sl.ReactCurrentBatchConfig,eu=0,Qn=null,Dr=null,Qr=null,o1=!1,Lm=!1,fp=0,zY=0;function Ns(){throw Error(Fe(321))}function y_(t,n){if(n===null)return!1;for(var r=0;r<n.length&&r<t.length;r++)if(!$i(t[r],n[r]))return!1;return!0}function v_(t,n,r,s,i,o){if(eu=o,Qn=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,fg.current=t===null||t.memoizedState===null?WY:qY,t=r(s,i),Lm){o=0;do{if(Lm=!1,fp=0,25<=o)throw Error(Fe(301));o+=1,Qr=Dr=null,n.updateQueue=null,fg.current=GY,t=r(s,i)}while(Lm)}if(fg.current=l1,n=Dr!==null&&Dr.next!==null,eu=0,Qr=Dr=Qn=null,o1=!1,n)throw Error(Fe(300));return t}function b_(){var t=fp!==0;return fp=0,t}function oo(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qr===null?Qn.memoizedState=Qr=t:Qr=Qr.next=t,Qr}function fi(){if(Dr===null){var t=Qn.alternate;t=t!==null?t.memoizedState:null}else t=Dr.next;var n=Qr===null?Qn.memoizedState:Qr.next;if(n!==null)Qr=n,Dr=t;else{if(t===null)throw Error(Fe(310));Dr=t,t={memoizedState:Dr.memoizedState,baseState:Dr.baseState,baseQueue:Dr.baseQueue,queue:Dr.queue,next:null},Qr===null?Qn.memoizedState=Qr=t:Qr=Qr.next=t}return Qr}function hp(t,n){return typeof n=="function"?n(t):n}function Lw(t){var n=fi(),r=n.queue;if(r===null)throw Error(Fe(311));r.lastRenderedReducer=t;var s=Dr,i=s.baseQueue,o=r.pending;if(o!==null){if(i!==null){var l=i.next;i.next=o.next,o.next=l}s.baseQueue=i=o,r.pending=null}if(i!==null){o=i.next,s=s.baseState;var c=l=null,d=null,u=o;do{var h=u.lane;if((eu&h)===h)d!==null&&(d=d.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:t(s,u.action);else{var m={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};d===null?(c=d=m,l=s):d=d.next=m,Qn.lanes|=h,tu|=h}u=u.next}while(u!==null&&u!==o);d===null?l=s:d.next=c,$i(s,n.memoizedState)||(aa=!0),n.memoizedState=s,n.baseState=l,n.baseQueue=d,r.lastRenderedState=s}if(t=r.interleaved,t!==null){i=t;do o=i.lane,Qn.lanes|=o,tu|=o,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[n.memoizedState,r.dispatch]}function Bw(t){var n=fi(),r=n.queue;if(r===null)throw Error(Fe(311));r.lastRenderedReducer=t;var s=r.dispatch,i=r.pending,o=n.memoizedState;if(i!==null){r.pending=null;var l=i=i.next;do o=t(o,l.action),l=l.next;while(l!==i);$i(o,n.memoizedState)||(aa=!0),n.memoizedState=o,n.baseQueue===null&&(n.baseState=o),r.lastRenderedState=o}return[o,s]}function E8(){}function k8(t,n){var r=Qn,s=fi(),i=n(),o=!$i(s.memoizedState,i);if(o&&(s.memoizedState=i,aa=!0),s=s.queue,w_(P8.bind(null,r,s,t),[t]),s.getSnapshot!==n||o||Qr!==null&&Qr.memoizedState.tag&1){if(r.flags|=2048,mp(9,I8.bind(null,r,s,i,n),void 0,null),Zr===null)throw Error(Fe(349));eu&30||T8(r,n,i)}return i}function T8(t,n,r){t.flags|=16384,t={getSnapshot:n,value:r},n=Qn.updateQueue,n===null?(n={lastEffect:null,stores:null},Qn.updateQueue=n,n.stores=[t]):(r=n.stores,r===null?n.stores=[t]:r.push(t))}function I8(t,n,r,s){n.value=r,n.getSnapshot=s,M8(n)&&O8(t)}function P8(t,n,r){return r(function(){M8(n)&&O8(t)})}function M8(t){var n=t.getSnapshot;t=t.value;try{var r=n();return!$i(t,r)}catch{return!0}}function O8(t){var n=dl(t,1);n!==null&&Li(n,t,1,-1)}function MT(t){var n=oo();return typeof t=="function"&&(t=t()),n.memoizedState=n.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:hp,lastRenderedState:t},n.queue=t,t=t.dispatch=HY.bind(null,Qn,t),[n.memoizedState,t]}function mp(t,n,r,s){return t={tag:t,create:n,destroy:r,deps:s,next:null},n=Qn.updateQueue,n===null?(n={lastEffect:null,stores:null},Qn.updateQueue=n,n.lastEffect=t.next=t):(r=n.lastEffect,r===null?n.lastEffect=t.next=t:(s=r.next,r.next=t,t.next=s,n.lastEffect=t)),t}function D8(){return fi().memoizedState}function hg(t,n,r,s){var i=oo();Qn.flags|=t,i.memoizedState=mp(1|n,r,void 0,s===void 0?null:s)}function Qy(t,n,r,s){var i=fi();s=s===void 0?null:s;var o=void 0;if(Dr!==null){var l=Dr.memoizedState;if(o=l.destroy,s!==null&&y_(s,l.deps)){i.memoizedState=mp(n,r,o,s);return}}Qn.flags|=t,i.memoizedState=mp(1|n,r,o,s)}function OT(t,n){return hg(8390656,8,t,n)}function w_(t,n){return Qy(2048,8,t,n)}function R8(t,n){return Qy(4,2,t,n)}function L8(t,n){return Qy(4,4,t,n)}function B8(t,n){if(typeof n=="function")return t=t(),n(t),function(){n(null)};if(n!=null)return t=t(),n.current=t,function(){n.current=null}}function F8(t,n,r){return r=r!=null?r.concat([t]):null,Qy(4,4,B8.bind(null,n,t),r)}function N_(){}function $8(t,n){var r=fi();n=n===void 0?null:n;var s=r.memoizedState;return s!==null&&n!==null&&y_(n,s[1])?s[0]:(r.memoizedState=[t,n],t)}function z8(t,n){var r=fi();n=n===void 0?null:n;var s=r.memoizedState;return s!==null&&n!==null&&y_(n,s[1])?s[0]:(t=t(),r.memoizedState=[t,n],t)}function U8(t,n,r){return eu&21?($i(r,n)||(r=GR(),Qn.lanes|=r,tu|=r,t.baseState=!0),n):(t.baseState&&(t.baseState=!1,aa=!0),t.memoizedState=r)}function UY(t,n){var r=fn;fn=r!==0&&4>r?r:4,t(!0);var s=Rw.transition;Rw.transition={};try{t(!1),n()}finally{fn=r,Rw.transition=s}}function V8(){return fi().memoizedState}function VY(t,n,r){var s=gc(t);if(r={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null},H8(t))W8(n,r);else if(r=C8(t,n,r,s),r!==null){var i=Ws();Li(r,t,s,i),q8(r,n,s)}}function HY(t,n,r){var s=gc(t),i={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null};if(H8(t))W8(n,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=n.lastRenderedReducer,o!==null))try{var l=n.lastRenderedState,c=o(l,r);if(i.hasEagerState=!0,i.eagerState=c,$i(c,l)){var d=n.interleaved;d===null?(i.next=i,h_(n)):(i.next=d.next,d.next=i),n.interleaved=i;return}}catch{}finally{}r=C8(t,n,i,s),r!==null&&(i=Ws(),Li(r,t,s,i),q8(r,n,s))}}function H8(t){var n=t.alternate;return t===Qn||n!==null&&n===Qn}function W8(t,n){Lm=o1=!0;var r=t.pending;r===null?n.next=n:(n.next=r.next,r.next=n),t.pending=n}function q8(t,n,r){if(r&4194240){var s=n.lanes;s&=t.pendingLanes,r|=s,n.lanes=r,JC(t,r)}}var l1={readContext:ui,useCallback:Ns,useContext:Ns,useEffect:Ns,useImperativeHandle:Ns,useInsertionEffect:Ns,useLayoutEffect:Ns,useMemo:Ns,useReducer:Ns,useRef:Ns,useState:Ns,useDebugValue:Ns,useDeferredValue:Ns,useTransition:Ns,useMutableSource:Ns,useSyncExternalStore:Ns,useId:Ns,unstable_isNewReconciler:!1},WY={readContext:ui,useCallback:function(t,n){return oo().memoizedState=[t,n===void 0?null:n],t},useContext:ui,useEffect:OT,useImperativeHandle:function(t,n,r){return r=r!=null?r.concat([t]):null,hg(4194308,4,B8.bind(null,n,t),r)},useLayoutEffect:function(t,n){return hg(4194308,4,t,n)},useInsertionEffect:function(t,n){return hg(4,2,t,n)},useMemo:function(t,n){var r=oo();return n=n===void 0?null:n,t=t(),r.memoizedState=[t,n],t},useReducer:function(t,n,r){var s=oo();return n=r!==void 0?r(n):n,s.memoizedState=s.baseState=n,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:n},s.queue=t,t=t.dispatch=VY.bind(null,Qn,t),[s.memoizedState,t]},useRef:function(t){var n=oo();return t={current:t},n.memoizedState=t},useState:MT,useDebugValue:N_,useDeferredValue:function(t){return oo().memoizedState=t},useTransition:function(){var t=MT(!1),n=t[0];return t=UY.bind(null,t[1]),oo().memoizedState=t,[n,t]},useMutableSource:function(){},useSyncExternalStore:function(t,n,r){var s=Qn,i=oo();if(Fn){if(r===void 0)throw Error(Fe(407));r=r()}else{if(r=n(),Zr===null)throw Error(Fe(349));eu&30||T8(s,n,r)}i.memoizedState=r;var o={value:r,getSnapshot:n};return i.queue=o,OT(P8.bind(null,s,o,t),[t]),s.flags|=2048,mp(9,I8.bind(null,s,o,r,n),void 0,null),r},useId:function(){var t=oo(),n=Zr.identifierPrefix;if(Fn){var r=el,s=Jo;r=(s&~(1<<32-Ri(s)-1)).toString(32)+r,n=":"+n+"R"+r,r=fp++,0<r&&(n+="H"+r.toString(32)),n+=":"}else r=zY++,n=":"+n+"r"+r.toString(32)+":";return t.memoizedState=n},unstable_isNewReconciler:!1},qY={readContext:ui,useCallback:$8,useContext:ui,useEffect:w_,useImperativeHandle:F8,useInsertionEffect:R8,useLayoutEffect:L8,useMemo:z8,useReducer:Lw,useRef:D8,useState:function(){return Lw(hp)},useDebugValue:N_,useDeferredValue:function(t){var n=fi();return U8(n,Dr.memoizedState,t)},useTransition:function(){var t=Lw(hp)[0],n=fi().memoizedState;return[t,n]},useMutableSource:E8,useSyncExternalStore:k8,useId:V8,unstable_isNewReconciler:!1},GY={readContext:ui,useCallback:$8,useContext:ui,useEffect:w_,useImperativeHandle:F8,useInsertionEffect:R8,useLayoutEffect:L8,useMemo:z8,useReducer:Bw,useRef:D8,useState:function(){return Bw(hp)},useDebugValue:N_,useDeferredValue:function(t){var n=fi();return Dr===null?n.memoizedState=t:U8(n,Dr.memoizedState,t)},useTransition:function(){var t=Bw(hp)[0],n=fi().memoizedState;return[t,n]},useMutableSource:E8,useSyncExternalStore:k8,useId:V8,unstable_isNewReconciler:!1};function Ei(t,n){if(t&&t.defaultProps){n=Jn({},n),t=t.defaultProps;for(var r in t)n[r]===void 0&&(n[r]=t[r]);return n}return n}function dj(t,n,r,s){n=t.memoizedState,r=r(s,n),r=r==null?n:Jn({},n,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Zy={isMounted:function(t){return(t=t._reactInternals)?ju(t)===t:!1},enqueueSetState:function(t,n,r){t=t._reactInternals;var s=Ws(),i=gc(t),o=al(s,i);o.payload=n,r!=null&&(o.callback=r),n=pc(t,o,i),n!==null&&(Li(n,t,i,s),ug(n,t,i))},enqueueReplaceState:function(t,n,r){t=t._reactInternals;var s=Ws(),i=gc(t),o=al(s,i);o.tag=1,o.payload=n,r!=null&&(o.callback=r),n=pc(t,o,i),n!==null&&(Li(n,t,i,s),ug(n,t,i))},enqueueForceUpdate:function(t,n){t=t._reactInternals;var r=Ws(),s=gc(t),i=al(r,s);i.tag=2,n!=null&&(i.callback=n),n=pc(t,i,s),n!==null&&(Li(n,t,s,r),ug(n,t,s))}};function DT(t,n,r,s,i,o,l){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,o,l):n.prototype&&n.prototype.isPureReactComponent?!ip(r,s)||!ip(i,o):!0}function G8(t,n,r){var s=!1,i=Ac,o=n.contextType;return typeof o=="object"&&o!==null?o=ui(o):(i=ca(n)?Zd:Os.current,s=n.contextTypes,o=(s=s!=null)?Rf(t,i):Ac),n=new n(r,o),t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=Zy,t.stateNode=n,n._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),n}function RT(t,n,r,s){t=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(r,s),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(r,s),n.state!==t&&Zy.enqueueReplaceState(n,n.state,null)}function uj(t,n,r,s){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},m_(t);var o=n.contextType;typeof o=="object"&&o!==null?i.context=ui(o):(o=ca(n)?Zd:Os.current,i.context=Rf(t,o)),i.state=t.memoizedState,o=n.getDerivedStateFromProps,typeof o=="function"&&(dj(t,n,o,r),i.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(n=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),n!==i.state&&Zy.enqueueReplaceState(i,i.state,null),a1(t,r,i,s),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function $f(t,n){try{var r="",s=n;do r+=wK(s),s=s.return;while(s);var i=r}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:n,stack:i,digest:null}}function Fw(t,n,r){return{value:t,source:null,stack:r??null,digest:n??null}}function fj(t,n){try{console.error(n.value)}catch(r){setTimeout(function(){throw r})}}var KY=typeof WeakMap=="function"?WeakMap:Map;function K8(t,n,r){r=al(-1,r),r.tag=3,r.payload={element:null};var s=n.value;return r.callback=function(){d1||(d1=!0,Nj=s),fj(t,n)},r}function Y8(t,n,r){r=al(-1,r),r.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var i=n.value;r.payload=function(){return s(i)},r.callback=function(){fj(t,n)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){fj(t,n),typeof s!="function"&&(xc===null?xc=new Set([this]):xc.add(this));var l=n.stack;this.componentDidCatch(n.value,{componentStack:l!==null?l:""})}),r}function LT(t,n,r){var s=t.pingCache;if(s===null){s=t.pingCache=new KY;var i=new Set;s.set(n,i)}else i=s.get(n),i===void 0&&(i=new Set,s.set(n,i));i.has(r)||(i.add(r),t=lX.bind(null,t,n,r),n.then(t,t))}function BT(t){do{var n;if((n=t.tag===13)&&(n=t.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return t;t=t.return}while(t!==null);return null}function FT(t,n,r,s,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===n?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(n=al(-1,1),n.tag=2,pc(r,n,1))),r.lanes|=1),t)}var YY=Sl.ReactCurrentOwner,aa=!1;function $s(t,n,r,s){n.child=t===null?S8(n,null,r,s):Bf(n,t.child,r,s)}function $T(t,n,r,s,i){r=r.render;var o=n.ref;return _f(n,i),s=v_(t,n,r,s,o,i),r=b_(),t!==null&&!aa?(n.updateQueue=t.updateQueue,n.flags&=-2053,t.lanes&=~i,ul(t,n,i)):(Fn&&r&&o_(n),n.flags|=1,$s(t,n,s,i),n.child)}function zT(t,n,r,s,i){if(t===null){var o=r.type;return typeof o=="function"&&!T_(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(n.tag=15,n.type=o,X8(t,n,o,s,i)):(t=gg(r.type,null,s,n,n.mode,i),t.ref=n.ref,t.return=n,n.child=t)}if(o=t.child,!(t.lanes&i)){var l=o.memoizedProps;if(r=r.compare,r=r!==null?r:ip,r(l,s)&&t.ref===n.ref)return ul(t,n,i)}return n.flags|=1,t=yc(o,s),t.ref=n.ref,t.return=n,n.child=t}function X8(t,n,r,s,i){if(t!==null){var o=t.memoizedProps;if(ip(o,s)&&t.ref===n.ref)if(aa=!1,n.pendingProps=s=o,(t.lanes&i)!==0)t.flags&131072&&(aa=!0);else return n.lanes=t.lanes,ul(t,n,i)}return hj(t,n,r,s,i)}function Q8(t,n,r){var s=n.pendingProps,i=s.children,o=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(n.mode&1))n.memoizedState={baseLanes:0,cachePool:null,transitions:null},En(df,ja),ja|=r;else{if(!(r&1073741824))return t=o!==null?o.baseLanes|r:r,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:t,cachePool:null,transitions:null},n.updateQueue=null,En(df,ja),ja|=t,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=o!==null?o.baseLanes:r,En(df,ja),ja|=s}else o!==null?(s=o.baseLanes|r,n.memoizedState=null):s=r,En(df,ja),ja|=s;return $s(t,n,i,r),n.child}function Z8(t,n){var r=n.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(n.flags|=512,n.flags|=2097152)}function hj(t,n,r,s,i){var o=ca(r)?Zd:Os.current;return o=Rf(n,o),_f(n,i),r=v_(t,n,r,s,o,i),s=b_(),t!==null&&!aa?(n.updateQueue=t.updateQueue,n.flags&=-2053,t.lanes&=~i,ul(t,n,i)):(Fn&&s&&o_(n),n.flags|=1,$s(t,n,r,i),n.child)}function UT(t,n,r,s,i){if(ca(r)){var o=!0;e1(n)}else o=!1;if(_f(n,i),n.stateNode===null)mg(t,n),G8(n,r,s),uj(n,r,s,i),s=!0;else if(t===null){var l=n.stateNode,c=n.memoizedProps;l.props=c;var d=l.context,u=r.contextType;typeof u=="object"&&u!==null?u=ui(u):(u=ca(r)?Zd:Os.current,u=Rf(n,u));var h=r.getDerivedStateFromProps,m=typeof h=="function"||typeof l.getSnapshotBeforeUpdate=="function";m||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(c!==s||d!==u)&&RT(n,l,s,u),Xl=!1;var g=n.memoizedState;l.state=g,a1(n,s,l,i),d=n.memoizedState,c!==s||g!==d||la.current||Xl?(typeof h=="function"&&(dj(n,r,h,s),d=n.memoizedState),(c=Xl||DT(n,r,c,s,g,d,u))?(m||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(n.flags|=4194308)):(typeof l.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=s,n.memoizedState=d),l.props=s,l.state=d,l.context=u,s=c):(typeof l.componentDidMount=="function"&&(n.flags|=4194308),s=!1)}else{l=n.stateNode,_8(t,n),c=n.memoizedProps,u=n.type===n.elementType?c:Ei(n.type,c),l.props=u,m=n.pendingProps,g=l.context,d=r.contextType,typeof d=="object"&&d!==null?d=ui(d):(d=ca(r)?Zd:Os.current,d=Rf(n,d));var y=r.getDerivedStateFromProps;(h=typeof y=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(c!==m||g!==d)&&RT(n,l,s,d),Xl=!1,g=n.memoizedState,l.state=g,a1(n,s,l,i);var N=n.memoizedState;c!==m||g!==N||la.current||Xl?(typeof y=="function"&&(dj(n,r,y,s),N=n.memoizedState),(u=Xl||DT(n,r,u,s,g,N,d)||!1)?(h||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(s,N,d),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(s,N,d)),typeof l.componentDidUpdate=="function"&&(n.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof l.componentDidUpdate!="function"||c===t.memoizedProps&&g===t.memoizedState||(n.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&g===t.memoizedState||(n.flags|=1024),n.memoizedProps=s,n.memoizedState=N),l.props=s,l.state=N,l.context=d,s=u):(typeof l.componentDidUpdate!="function"||c===t.memoizedProps&&g===t.memoizedState||(n.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&g===t.memoizedState||(n.flags|=1024),s=!1)}return mj(t,n,r,s,o,i)}function mj(t,n,r,s,i,o){Z8(t,n);var l=(n.flags&128)!==0;if(!s&&!l)return i&&AT(n,r,!1),ul(t,n,o);s=n.stateNode,YY.current=n;var c=l&&typeof r.getDerivedStateFromError!="function"?null:s.render();return n.flags|=1,t!==null&&l?(n.child=Bf(n,t.child,null,o),n.child=Bf(n,null,c,o)):$s(t,n,c,o),n.memoizedState=s.state,i&&AT(n,r,!0),n.child}function J8(t){var n=t.stateNode;n.pendingContext?_T(t,n.pendingContext,n.pendingContext!==n.context):n.context&&_T(t,n.context,!1),p_(t,n.containerInfo)}function VT(t,n,r,s,i){return Lf(),c_(i),n.flags|=256,$s(t,n,r,s),n.child}var pj={dehydrated:null,treeContext:null,retryLane:0};function xj(t){return{baseLanes:t,cachePool:null,transitions:null}}function e6(t,n,r){var s=n.pendingProps,i=Kn.current,o=!1,l=(n.flags&128)!==0,c;if((c=l)||(c=t!==null&&t.memoizedState===null?!1:(i&2)!==0),c?(o=!0,n.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),En(Kn,i&1),t===null)return lj(n),t=n.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(n.mode&1?t.data==="$!"?n.lanes=8:n.lanes=1073741824:n.lanes=1,null):(l=s.children,t=s.fallback,o?(s=n.mode,o=n.child,l={mode:"hidden",children:l},!(s&1)&&o!==null?(o.childLanes=0,o.pendingProps=l):o=tv(l,s,0,null),t=Ld(t,s,r,null),o.return=n,t.return=n,o.sibling=t,n.child=o,n.child.memoizedState=xj(r),n.memoizedState=pj,t):j_(n,l));if(i=t.memoizedState,i!==null&&(c=i.dehydrated,c!==null))return XY(t,n,l,s,c,i,r);if(o){o=s.fallback,l=n.mode,i=t.child,c=i.sibling;var d={mode:"hidden",children:s.children};return!(l&1)&&n.child!==i?(s=n.child,s.childLanes=0,s.pendingProps=d,n.deletions=null):(s=yc(i,d),s.subtreeFlags=i.subtreeFlags&14680064),c!==null?o=yc(c,o):(o=Ld(o,l,r,null),o.flags|=2),o.return=n,s.return=n,s.sibling=o,n.child=s,s=o,o=n.child,l=t.child.memoizedState,l=l===null?xj(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=t.childLanes&~r,n.memoizedState=pj,s}return o=t.child,t=o.sibling,s=yc(o,{mode:"visible",children:s.children}),!(n.mode&1)&&(s.lanes=r),s.return=n,s.sibling=null,t!==null&&(r=n.deletions,r===null?(n.deletions=[t],n.flags|=16):r.push(t)),n.child=s,n.memoizedState=null,s}function j_(t,n){return n=tv({mode:"visible",children:n},t.mode,0,null),n.return=t,t.child=n}function s0(t,n,r,s){return s!==null&&c_(s),Bf(n,t.child,null,r),t=j_(n,n.pendingProps.children),t.flags|=2,n.memoizedState=null,t}function XY(t,n,r,s,i,o,l){if(r)return n.flags&256?(n.flags&=-257,s=Fw(Error(Fe(422))),s0(t,n,l,s)):n.memoizedState!==null?(n.child=t.child,n.flags|=128,null):(o=s.fallback,i=n.mode,s=tv({mode:"visible",children:s.children},i,0,null),o=Ld(o,i,l,null),o.flags|=2,s.return=n,o.return=n,s.sibling=o,n.child=s,n.mode&1&&Bf(n,t.child,null,l),n.child.memoizedState=xj(l),n.memoizedState=pj,o);if(!(n.mode&1))return s0(t,n,l,null);if(i.data==="$!"){if(s=i.nextSibling&&i.nextSibling.dataset,s)var c=s.dgst;return s=c,o=Error(Fe(419)),s=Fw(o,s,void 0),s0(t,n,l,s)}if(c=(l&t.childLanes)!==0,aa||c){if(s=Zr,s!==null){switch(l&-l){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(s.suspendedLanes|l)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,dl(t,i),Li(s,t,i,-1))}return k_(),s=Fw(Error(Fe(421))),s0(t,n,l,s)}return i.data==="$?"?(n.flags|=128,n.child=t.child,n=cX.bind(null,t),i._reactRetry=n,null):(t=o.treeContext,Ta=mc(i.nextSibling),Pa=n,Fn=!0,Ii=null,t!==null&&(ri[si++]=Jo,ri[si++]=el,ri[si++]=Jd,Jo=t.id,el=t.overflow,Jd=n),n=j_(n,s.children),n.flags|=4096,n)}function HT(t,n,r){t.lanes|=n;var s=t.alternate;s!==null&&(s.lanes|=n),cj(t.return,n,r)}function $w(t,n,r,s,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:s,tail:r,tailMode:i}:(o.isBackwards=n,o.rendering=null,o.renderingStartTime=0,o.last=s,o.tail=r,o.tailMode=i)}function t6(t,n,r){var s=n.pendingProps,i=s.revealOrder,o=s.tail;if($s(t,n,s.children,r),s=Kn.current,s&2)s=s&1|2,n.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=n.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&HT(t,r,n);else if(t.tag===19)HT(t,r,n);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===n)break e;for(;t.sibling===null;){if(t.return===null||t.return===n)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(En(Kn,s),!(n.mode&1))n.memoizedState=null;else switch(i){case"forwards":for(r=n.child,i=null;r!==null;)t=r.alternate,t!==null&&i1(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=n.child,n.child=null):(i=r.sibling,r.sibling=null),$w(n,!1,i,r,o);break;case"backwards":for(r=null,i=n.child,n.child=null;i!==null;){if(t=i.alternate,t!==null&&i1(t)===null){n.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}$w(n,!0,r,null,o);break;case"together":$w(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function mg(t,n){!(n.mode&1)&&t!==null&&(t.alternate=null,n.alternate=null,n.flags|=2)}function ul(t,n,r){if(t!==null&&(n.dependencies=t.dependencies),tu|=n.lanes,!(r&n.childLanes))return null;if(t!==null&&n.child!==t.child)throw Error(Fe(153));if(n.child!==null){for(t=n.child,r=yc(t,t.pendingProps),n.child=r,r.return=n;t.sibling!==null;)t=t.sibling,r=r.sibling=yc(t,t.pendingProps),r.return=n;r.sibling=null}return n.child}function QY(t,n,r){switch(n.tag){case 3:J8(n),Lf();break;case 5:A8(n);break;case 1:ca(n.type)&&e1(n);break;case 4:p_(n,n.stateNode.containerInfo);break;case 10:var s=n.type._context,i=n.memoizedProps.value;En(r1,s._currentValue),s._currentValue=i;break;case 13:if(s=n.memoizedState,s!==null)return s.dehydrated!==null?(En(Kn,Kn.current&1),n.flags|=128,null):r&n.child.childLanes?e6(t,n,r):(En(Kn,Kn.current&1),t=ul(t,n,r),t!==null?t.sibling:null);En(Kn,Kn.current&1);break;case 19:if(s=(r&n.childLanes)!==0,t.flags&128){if(s)return t6(t,n,r);n.flags|=128}if(i=n.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),En(Kn,Kn.current),s)break;return null;case 22:case 23:return n.lanes=0,Q8(t,n,r)}return ul(t,n,r)}var n6,gj,r6,s6;n6=function(t,n){for(var r=n.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};gj=function(){};r6=function(t,n,r,s){var i=t.memoizedProps;if(i!==s){t=n.stateNode,_d(yo.current);var o=null;switch(r){case"input":i=F2(t,i),s=F2(t,s),o=[];break;case"select":i=Jn({},i,{value:void 0}),s=Jn({},s,{value:void 0}),o=[];break;case"textarea":i=U2(t,i),s=U2(t,s),o=[];break;default:typeof i.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=Zg)}H2(r,s);var l;r=null;for(u in i)if(!s.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var c=i[u];for(l in c)c.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Jm.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in s){var d=s[u];if(c=i!=null?i[u]:void 0,s.hasOwnProperty(u)&&d!==c&&(d!=null||c!=null))if(u==="style")if(c){for(l in c)!c.hasOwnProperty(l)||d&&d.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in d)d.hasOwnProperty(l)&&c[l]!==d[l]&&(r||(r={}),r[l]=d[l])}else r||(o||(o=[]),o.push(u,r)),r=d;else u==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,c=c?c.__html:void 0,d!=null&&c!==d&&(o=o||[]).push(u,d)):u==="children"?typeof d!="string"&&typeof d!="number"||(o=o||[]).push(u,""+d):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Jm.hasOwnProperty(u)?(d!=null&&u==="onScroll"&&Mn("scroll",t),o||c===d||(o=[])):(o=o||[]).push(u,d))}r&&(o=o||[]).push("style",r);var u=o;(n.updateQueue=u)&&(n.flags|=4)}};s6=function(t,n,r,s){r!==s&&(n.flags|=4)};function tm(t,n){if(!Fn)switch(t.tailMode){case"hidden":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?n||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function js(t){var n=t.alternate!==null&&t.alternate.child===t.child,r=0,s=0;if(n)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,s|=i.subtreeFlags&14680064,s|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,s|=i.subtreeFlags,s|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=s,t.childLanes=r,n}function ZY(t,n,r){var s=n.pendingProps;switch(l_(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return js(n),null;case 1:return ca(n.type)&&Jg(),js(n),null;case 3:return s=n.stateNode,Ff(),Rn(la),Rn(Os),g_(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(n0(n)?n.flags|=4:t===null||t.memoizedState.isDehydrated&&!(n.flags&256)||(n.flags|=1024,Ii!==null&&(Cj(Ii),Ii=null))),gj(t,n),js(n),null;case 5:x_(n);var i=_d(up.current);if(r=n.type,t!==null&&n.stateNode!=null)r6(t,n,r,s,i),t.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!s){if(n.stateNode===null)throw Error(Fe(166));return js(n),null}if(t=_d(yo.current),n0(n)){s=n.stateNode,r=n.type;var o=n.memoizedProps;switch(s[uo]=n,s[cp]=o,t=(n.mode&1)!==0,r){case"dialog":Mn("cancel",s),Mn("close",s);break;case"iframe":case"object":case"embed":Mn("load",s);break;case"video":case"audio":for(i=0;i<Sm.length;i++)Mn(Sm[i],s);break;case"source":Mn("error",s);break;case"img":case"image":case"link":Mn("error",s),Mn("load",s);break;case"details":Mn("toggle",s);break;case"input":Jk(s,o),Mn("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!o.multiple},Mn("invalid",s);break;case"textarea":tT(s,o),Mn("invalid",s)}H2(r,o),i=null;for(var l in o)if(o.hasOwnProperty(l)){var c=o[l];l==="children"?typeof c=="string"?s.textContent!==c&&(o.suppressHydrationWarning!==!0&&t0(s.textContent,c,t),i=["children",c]):typeof c=="number"&&s.textContent!==""+c&&(o.suppressHydrationWarning!==!0&&t0(s.textContent,c,t),i=["children",""+c]):Jm.hasOwnProperty(l)&&c!=null&&l==="onScroll"&&Mn("scroll",s)}switch(r){case"input":Gx(s),eT(s,o,!0);break;case"textarea":Gx(s),nT(s);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(s.onclick=Zg)}s=i,n.updateQueue=s,s!==null&&(n.flags|=4)}else{l=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=PR(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=l.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=l.createElement(r,{is:s.is}):(t=l.createElement(r),r==="select"&&(l=t,s.multiple?l.multiple=!0:s.size&&(l.size=s.size))):t=l.createElementNS(t,r),t[uo]=n,t[cp]=s,n6(t,n,!1,!1),n.stateNode=t;e:{switch(l=W2(r,s),r){case"dialog":Mn("cancel",t),Mn("close",t),i=s;break;case"iframe":case"object":case"embed":Mn("load",t),i=s;break;case"video":case"audio":for(i=0;i<Sm.length;i++)Mn(Sm[i],t);i=s;break;case"source":Mn("error",t),i=s;break;case"img":case"image":case"link":Mn("error",t),Mn("load",t),i=s;break;case"details":Mn("toggle",t),i=s;break;case"input":Jk(t,s),i=F2(t,s),Mn("invalid",t);break;case"option":i=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},i=Jn({},s,{value:void 0}),Mn("invalid",t);break;case"textarea":tT(t,s),i=U2(t,s),Mn("invalid",t);break;default:i=s}H2(r,i),c=i;for(o in c)if(c.hasOwnProperty(o)){var d=c[o];o==="style"?DR(t,d):o==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&MR(t,d)):o==="children"?typeof d=="string"?(r!=="textarea"||d!=="")&&ep(t,d):typeof d=="number"&&ep(t,""+d):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Jm.hasOwnProperty(o)?d!=null&&o==="onScroll"&&Mn("scroll",t):d!=null&&GC(t,o,d,l))}switch(r){case"input":Gx(t),eT(t,s,!1);break;case"textarea":Gx(t),nT(t);break;case"option":s.value!=null&&t.setAttribute("value",""+_c(s.value));break;case"select":t.multiple=!!s.multiple,o=s.value,o!=null?Nf(t,!!s.multiple,o,!1):s.defaultValue!=null&&Nf(t,!!s.multiple,s.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Zg)}switch(r){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return js(n),null;case 6:if(t&&n.stateNode!=null)s6(t,n,t.memoizedProps,s);else{if(typeof s!="string"&&n.stateNode===null)throw Error(Fe(166));if(r=_d(up.current),_d(yo.current),n0(n)){if(s=n.stateNode,r=n.memoizedProps,s[uo]=n,(o=s.nodeValue!==r)&&(t=Pa,t!==null))switch(t.tag){case 3:t0(s.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&t0(s.nodeValue,r,(t.mode&1)!==0)}o&&(n.flags|=4)}else s=(r.nodeType===9?r:r.ownerDocument).createTextNode(s),s[uo]=n,n.stateNode=s}return js(n),null;case 13:if(Rn(Kn),s=n.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Fn&&Ta!==null&&n.mode&1&&!(n.flags&128))N8(),Lf(),n.flags|=98560,o=!1;else if(o=n0(n),s!==null&&s.dehydrated!==null){if(t===null){if(!o)throw Error(Fe(318));if(o=n.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(Fe(317));o[uo]=n}else Lf(),!(n.flags&128)&&(n.memoizedState=null),n.flags|=4;js(n),o=!1}else Ii!==null&&(Cj(Ii),Ii=null),o=!0;if(!o)return n.flags&65536?n:null}return n.flags&128?(n.lanes=r,n):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(n.child.flags|=8192,n.mode&1&&(t===null||Kn.current&1?$r===0&&($r=3):k_())),n.updateQueue!==null&&(n.flags|=4),js(n),null);case 4:return Ff(),gj(t,n),t===null&&op(n.stateNode.containerInfo),js(n),null;case 10:return f_(n.type._context),js(n),null;case 17:return ca(n.type)&&Jg(),js(n),null;case 19:if(Rn(Kn),o=n.memoizedState,o===null)return js(n),null;if(s=(n.flags&128)!==0,l=o.rendering,l===null)if(s)tm(o,!1);else{if($r!==0||t!==null&&t.flags&128)for(t=n.child;t!==null;){if(l=i1(t),l!==null){for(n.flags|=128,tm(o,!1),s=l.updateQueue,s!==null&&(n.updateQueue=s,n.flags|=4),n.subtreeFlags=0,s=r,r=n.child;r!==null;)o=r,t=s,o.flags&=14680066,l=o.alternate,l===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,t=l.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return En(Kn,Kn.current&1|2),n.child}t=t.sibling}o.tail!==null&&xr()>zf&&(n.flags|=128,s=!0,tm(o,!1),n.lanes=4194304)}else{if(!s)if(t=i1(l),t!==null){if(n.flags|=128,s=!0,r=t.updateQueue,r!==null&&(n.updateQueue=r,n.flags|=4),tm(o,!0),o.tail===null&&o.tailMode==="hidden"&&!l.alternate&&!Fn)return js(n),null}else 2*xr()-o.renderingStartTime>zf&&r!==1073741824&&(n.flags|=128,s=!0,tm(o,!1),n.lanes=4194304);o.isBackwards?(l.sibling=n.child,n.child=l):(r=o.last,r!==null?r.sibling=l:n.child=l,o.last=l)}return o.tail!==null?(n=o.tail,o.rendering=n,o.tail=n.sibling,o.renderingStartTime=xr(),n.sibling=null,r=Kn.current,En(Kn,s?r&1|2:r&1),n):(js(n),null);case 22:case 23:return E_(),s=n.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(n.flags|=8192),s&&n.mode&1?ja&1073741824&&(js(n),n.subtreeFlags&6&&(n.flags|=8192)):js(n),null;case 24:return null;case 25:return null}throw Error(Fe(156,n.tag))}function JY(t,n){switch(l_(n),n.tag){case 1:return ca(n.type)&&Jg(),t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 3:return Ff(),Rn(la),Rn(Os),g_(),t=n.flags,t&65536&&!(t&128)?(n.flags=t&-65537|128,n):null;case 5:return x_(n),null;case 13:if(Rn(Kn),t=n.memoizedState,t!==null&&t.dehydrated!==null){if(n.alternate===null)throw Error(Fe(340));Lf()}return t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 19:return Rn(Kn),null;case 4:return Ff(),null;case 10:return f_(n.type._context),null;case 22:case 23:return E_(),null;case 24:return null;default:return null}}var a0=!1,_s=!1,eX=typeof WeakSet=="function"?WeakSet:Set,it=null;function cf(t,n){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(s){ir(t,n,s)}else r.current=null}function yj(t,n,r){try{r()}catch(s){ir(t,n,s)}}var WT=!1;function tX(t,n){if(tj=Yg,t=c8(),i_(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var s=r.getSelection&&r.getSelection();if(s&&s.rangeCount!==0){r=s.anchorNode;var i=s.anchorOffset,o=s.focusNode;s=s.focusOffset;try{r.nodeType,o.nodeType}catch{r=null;break e}var l=0,c=-1,d=-1,u=0,h=0,m=t,g=null;t:for(;;){for(var y;m!==r||i!==0&&m.nodeType!==3||(c=l+i),m!==o||s!==0&&m.nodeType!==3||(d=l+s),m.nodeType===3&&(l+=m.nodeValue.length),(y=m.firstChild)!==null;)g=m,m=y;for(;;){if(m===t)break t;if(g===r&&++u===i&&(c=l),g===o&&++h===s&&(d=l),(y=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=y}r=c===-1||d===-1?null:{start:c,end:d}}else r=null}r=r||{start:0,end:0}}else r=null;for(nj={focusedElem:t,selectionRange:r},Yg=!1,it=n;it!==null;)if(n=it,t=n.child,(n.subtreeFlags&1028)!==0&&t!==null)t.return=n,it=t;else for(;it!==null;){n=it;try{var N=n.alternate;if(n.flags&1024)switch(n.tag){case 0:case 11:case 15:break;case 1:if(N!==null){var j=N.memoizedProps,S=N.memoizedState,_=n.stateNode,A=_.getSnapshotBeforeUpdate(n.elementType===n.type?j:Ei(n.type,j),S);_.__reactInternalSnapshotBeforeUpdate=A}break;case 3:var k=n.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Fe(163))}}catch(T){ir(n,n.return,T)}if(t=n.sibling,t!==null){t.return=n.return,it=t;break}it=n.return}return N=WT,WT=!1,N}function Bm(t,n,r){var s=n.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var i=s=s.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&yj(n,r,o)}i=i.next}while(i!==s)}}function Jy(t,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var r=n=n.next;do{if((r.tag&t)===t){var s=r.create;r.destroy=s()}r=r.next}while(r!==n)}}function vj(t){var n=t.ref;if(n!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof n=="function"?n(t):n.current=t}}function a6(t){var n=t.alternate;n!==null&&(t.alternate=null,a6(n)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(n=t.stateNode,n!==null&&(delete n[uo],delete n[cp],delete n[aj],delete n[LY],delete n[BY])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function i6(t){return t.tag===5||t.tag===3||t.tag===4}function qT(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||i6(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function bj(t,n,r){var s=t.tag;if(s===5||s===6)t=t.stateNode,n?r.nodeType===8?r.parentNode.insertBefore(t,n):r.insertBefore(t,n):(r.nodeType===8?(n=r.parentNode,n.insertBefore(t,r)):(n=r,n.appendChild(t)),r=r._reactRootContainer,r!=null||n.onclick!==null||(n.onclick=Zg));else if(s!==4&&(t=t.child,t!==null))for(bj(t,n,r),t=t.sibling;t!==null;)bj(t,n,r),t=t.sibling}function wj(t,n,r){var s=t.tag;if(s===5||s===6)t=t.stateNode,n?r.insertBefore(t,n):r.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(wj(t,n,r),t=t.sibling;t!==null;)wj(t,n,r),t=t.sibling}var us=null,ki=!1;function zl(t,n,r){for(r=r.child;r!==null;)o6(t,n,r),r=r.sibling}function o6(t,n,r){if(go&&typeof go.onCommitFiberUnmount=="function")try{go.onCommitFiberUnmount(Wy,r)}catch{}switch(r.tag){case 5:_s||cf(r,n);case 6:var s=us,i=ki;us=null,zl(t,n,r),us=s,ki=i,us!==null&&(ki?(t=us,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):us.removeChild(r.stateNode));break;case 18:us!==null&&(ki?(t=us,r=r.stateNode,t.nodeType===8?Mw(t.parentNode,r):t.nodeType===1&&Mw(t,r),sp(t)):Mw(us,r.stateNode));break;case 4:s=us,i=ki,us=r.stateNode.containerInfo,ki=!0,zl(t,n,r),us=s,ki=i;break;case 0:case 11:case 14:case 15:if(!_s&&(s=r.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){i=s=s.next;do{var o=i,l=o.destroy;o=o.tag,l!==void 0&&(o&2||o&4)&&yj(r,n,l),i=i.next}while(i!==s)}zl(t,n,r);break;case 1:if(!_s&&(cf(r,n),s=r.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=r.memoizedProps,s.state=r.memoizedState,s.componentWillUnmount()}catch(c){ir(r,n,c)}zl(t,n,r);break;case 21:zl(t,n,r);break;case 22:r.mode&1?(_s=(s=_s)||r.memoizedState!==null,zl(t,n,r),_s=s):zl(t,n,r);break;default:zl(t,n,r)}}function GT(t){var n=t.updateQueue;if(n!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new eX),n.forEach(function(s){var i=dX.bind(null,t,s);r.has(s)||(r.add(s),s.then(i,i))})}}function Si(t,n){var r=n.deletions;if(r!==null)for(var s=0;s<r.length;s++){var i=r[s];try{var o=t,l=n,c=l;e:for(;c!==null;){switch(c.tag){case 5:us=c.stateNode,ki=!1;break e;case 3:us=c.stateNode.containerInfo,ki=!0;break e;case 4:us=c.stateNode.containerInfo,ki=!0;break e}c=c.return}if(us===null)throw Error(Fe(160));o6(o,l,i),us=null,ki=!1;var d=i.alternate;d!==null&&(d.return=null),i.return=null}catch(u){ir(i,n,u)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)l6(n,t),n=n.sibling}function l6(t,n){var r=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Si(n,t),no(t),s&4){try{Bm(3,t,t.return),Jy(3,t)}catch(j){ir(t,t.return,j)}try{Bm(5,t,t.return)}catch(j){ir(t,t.return,j)}}break;case 1:Si(n,t),no(t),s&512&&r!==null&&cf(r,r.return);break;case 5:if(Si(n,t),no(t),s&512&&r!==null&&cf(r,r.return),t.flags&32){var i=t.stateNode;try{ep(i,"")}catch(j){ir(t,t.return,j)}}if(s&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,l=r!==null?r.memoizedProps:o,c=t.type,d=t.updateQueue;if(t.updateQueue=null,d!==null)try{c==="input"&&o.type==="radio"&&o.name!=null&&TR(i,o),W2(c,l);var u=W2(c,o);for(l=0;l<d.length;l+=2){var h=d[l],m=d[l+1];h==="style"?DR(i,m):h==="dangerouslySetInnerHTML"?MR(i,m):h==="children"?ep(i,m):GC(i,h,m,u)}switch(c){case"input":$2(i,o);break;case"textarea":IR(i,o);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var y=o.value;y!=null?Nf(i,!!o.multiple,y,!1):g!==!!o.multiple&&(o.defaultValue!=null?Nf(i,!!o.multiple,o.defaultValue,!0):Nf(i,!!o.multiple,o.multiple?[]:"",!1))}i[cp]=o}catch(j){ir(t,t.return,j)}}break;case 6:if(Si(n,t),no(t),s&4){if(t.stateNode===null)throw Error(Fe(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(j){ir(t,t.return,j)}}break;case 3:if(Si(n,t),no(t),s&4&&r!==null&&r.memoizedState.isDehydrated)try{sp(n.containerInfo)}catch(j){ir(t,t.return,j)}break;case 4:Si(n,t),no(t);break;case 13:Si(n,t),no(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(__=xr())),s&4&&GT(t);break;case 22:if(h=r!==null&&r.memoizedState!==null,t.mode&1?(_s=(u=_s)||h,Si(n,t),_s=u):Si(n,t),no(t),s&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!h&&t.mode&1)for(it=t,h=t.child;h!==null;){for(m=it=h;it!==null;){switch(g=it,y=g.child,g.tag){case 0:case 11:case 14:case 15:Bm(4,g,g.return);break;case 1:cf(g,g.return);var N=g.stateNode;if(typeof N.componentWillUnmount=="function"){s=g,r=g.return;try{n=s,N.props=n.memoizedProps,N.state=n.memoizedState,N.componentWillUnmount()}catch(j){ir(s,r,j)}}break;case 5:cf(g,g.return);break;case 22:if(g.memoizedState!==null){YT(m);continue}}y!==null?(y.return=g,it=y):YT(m)}h=h.sibling}e:for(h=null,m=t;;){if(m.tag===5){if(h===null){h=m;try{i=m.stateNode,u?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(c=m.stateNode,d=m.memoizedProps.style,l=d!=null&&d.hasOwnProperty("display")?d.display:null,c.style.display=OR("display",l))}catch(j){ir(t,t.return,j)}}}else if(m.tag===6){if(h===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(j){ir(t,t.return,j)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;h===m&&(h=null),m=m.return}h===m&&(h=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Si(n,t),no(t),s&4&&GT(t);break;case 21:break;default:Si(n,t),no(t)}}function no(t){var n=t.flags;if(n&2){try{e:{for(var r=t.return;r!==null;){if(i6(r)){var s=r;break e}r=r.return}throw Error(Fe(160))}switch(s.tag){case 5:var i=s.stateNode;s.flags&32&&(ep(i,""),s.flags&=-33);var o=qT(t);wj(t,o,i);break;case 3:case 4:var l=s.stateNode.containerInfo,c=qT(t);bj(t,c,l);break;default:throw Error(Fe(161))}}catch(d){ir(t,t.return,d)}t.flags&=-3}n&4096&&(t.flags&=-4097)}function nX(t,n,r){it=t,c6(t)}function c6(t,n,r){for(var s=(t.mode&1)!==0;it!==null;){var i=it,o=i.child;if(i.tag===22&&s){var l=i.memoizedState!==null||a0;if(!l){var c=i.alternate,d=c!==null&&c.memoizedState!==null||_s;c=a0;var u=_s;if(a0=l,(_s=d)&&!u)for(it=i;it!==null;)l=it,d=l.child,l.tag===22&&l.memoizedState!==null?XT(i):d!==null?(d.return=l,it=d):XT(i);for(;o!==null;)it=o,c6(o),o=o.sibling;it=i,a0=c,_s=u}KT(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,it=o):KT(t)}}function KT(t){for(;it!==null;){var n=it;if(n.flags&8772){var r=n.alternate;try{if(n.flags&8772)switch(n.tag){case 0:case 11:case 15:_s||Jy(5,n);break;case 1:var s=n.stateNode;if(n.flags&4&&!_s)if(r===null)s.componentDidMount();else{var i=n.elementType===n.type?r.memoizedProps:Ei(n.type,r.memoizedProps);s.componentDidUpdate(i,r.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var o=n.updateQueue;o!==null&&PT(n,o,s);break;case 3:var l=n.updateQueue;if(l!==null){if(r=null,n.child!==null)switch(n.child.tag){case 5:r=n.child.stateNode;break;case 1:r=n.child.stateNode}PT(n,l,r)}break;case 5:var c=n.stateNode;if(r===null&&n.flags&4){r=c;var d=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&r.focus();break;case"img":d.src&&(r.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var u=n.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var m=h.dehydrated;m!==null&&sp(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Fe(163))}_s||n.flags&512&&vj(n)}catch(g){ir(n,n.return,g)}}if(n===t){it=null;break}if(r=n.sibling,r!==null){r.return=n.return,it=r;break}it=n.return}}function YT(t){for(;it!==null;){var n=it;if(n===t){it=null;break}var r=n.sibling;if(r!==null){r.return=n.return,it=r;break}it=n.return}}function XT(t){for(;it!==null;){var n=it;try{switch(n.tag){case 0:case 11:case 15:var r=n.return;try{Jy(4,n)}catch(d){ir(n,r,d)}break;case 1:var s=n.stateNode;if(typeof s.componentDidMount=="function"){var i=n.return;try{s.componentDidMount()}catch(d){ir(n,i,d)}}var o=n.return;try{vj(n)}catch(d){ir(n,o,d)}break;case 5:var l=n.return;try{vj(n)}catch(d){ir(n,l,d)}}}catch(d){ir(n,n.return,d)}if(n===t){it=null;break}var c=n.sibling;if(c!==null){c.return=n.return,it=c;break}it=n.return}}var rX=Math.ceil,c1=Sl.ReactCurrentDispatcher,S_=Sl.ReactCurrentOwner,li=Sl.ReactCurrentBatchConfig,Jt=0,Zr=null,wr=null,xs=0,ja=0,df=zc(0),$r=0,pp=null,tu=0,ev=0,C_=0,Fm=null,na=null,__=0,zf=1/0,Ko=null,d1=!1,Nj=null,xc=null,i0=!1,ic=null,u1=0,$m=0,jj=null,pg=-1,xg=0;function Ws(){return Jt&6?xr():pg!==-1?pg:pg=xr()}function gc(t){return t.mode&1?Jt&2&&xs!==0?xs&-xs:$Y.transition!==null?(xg===0&&(xg=GR()),xg):(t=fn,t!==0||(t=window.event,t=t===void 0?16:e8(t.type)),t):1}function Li(t,n,r,s){if(50<$m)throw $m=0,jj=null,Error(Fe(185));rx(t,r,s),(!(Jt&2)||t!==Zr)&&(t===Zr&&(!(Jt&2)&&(ev|=r),$r===4&&nc(t,xs)),da(t,s),r===1&&Jt===0&&!(n.mode&1)&&(zf=xr()+500,Xy&&Uc()))}function da(t,n){var r=t.callbackNode;$K(t,n);var s=Kg(t,t===Zr?xs:0);if(s===0)r!==null&&aT(r),t.callbackNode=null,t.callbackPriority=0;else if(n=s&-s,t.callbackPriority!==n){if(r!=null&&aT(r),n===1)t.tag===0?FY(QT.bind(null,t)):v8(QT.bind(null,t)),DY(function(){!(Jt&6)&&Uc()}),r=null;else{switch(KR(s)){case 1:r=ZC;break;case 4:r=WR;break;case 16:r=Gg;break;case 536870912:r=qR;break;default:r=Gg}r=g6(r,d6.bind(null,t))}t.callbackPriority=n,t.callbackNode=r}}function d6(t,n){if(pg=-1,xg=0,Jt&6)throw Error(Fe(327));var r=t.callbackNode;if(Af()&&t.callbackNode!==r)return null;var s=Kg(t,t===Zr?xs:0);if(s===0)return null;if(s&30||s&t.expiredLanes||n)n=f1(t,s);else{n=s;var i=Jt;Jt|=2;var o=f6();(Zr!==t||xs!==n)&&(Ko=null,zf=xr()+500,Rd(t,n));do try{iX();break}catch(c){u6(t,c)}while(!0);u_(),c1.current=o,Jt=i,wr!==null?n=0:(Zr=null,xs=0,n=$r)}if(n!==0){if(n===2&&(i=X2(t),i!==0&&(s=i,n=Sj(t,i))),n===1)throw r=pp,Rd(t,0),nc(t,s),da(t,xr()),r;if(n===6)nc(t,s);else{if(i=t.current.alternate,!(s&30)&&!sX(i)&&(n=f1(t,s),n===2&&(o=X2(t),o!==0&&(s=o,n=Sj(t,o))),n===1))throw r=pp,Rd(t,0),nc(t,s),da(t,xr()),r;switch(t.finishedWork=i,t.finishedLanes=s,n){case 0:case 1:throw Error(Fe(345));case 2:hd(t,na,Ko);break;case 3:if(nc(t,s),(s&130023424)===s&&(n=__+500-xr(),10<n)){if(Kg(t,0)!==0)break;if(i=t.suspendedLanes,(i&s)!==s){Ws(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=sj(hd.bind(null,t,na,Ko),n);break}hd(t,na,Ko);break;case 4:if(nc(t,s),(s&4194240)===s)break;for(n=t.eventTimes,i=-1;0<s;){var l=31-Ri(s);o=1<<l,l=n[l],l>i&&(i=l),s&=~o}if(s=i,s=xr()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*rX(s/1960))-s,10<s){t.timeoutHandle=sj(hd.bind(null,t,na,Ko),s);break}hd(t,na,Ko);break;case 5:hd(t,na,Ko);break;default:throw Error(Fe(329))}}}return da(t,xr()),t.callbackNode===r?d6.bind(null,t):null}function Sj(t,n){var r=Fm;return t.current.memoizedState.isDehydrated&&(Rd(t,n).flags|=256),t=f1(t,n),t!==2&&(n=na,na=r,n!==null&&Cj(n)),t}function Cj(t){na===null?na=t:na.push.apply(na,t)}function sX(t){for(var n=t;;){if(n.flags&16384){var r=n.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var s=0;s<r.length;s++){var i=r[s],o=i.getSnapshot;i=i.value;try{if(!$i(o(),i))return!1}catch{return!1}}}if(r=n.child,n.subtreeFlags&16384&&r!==null)r.return=n,n=r;else{if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function nc(t,n){for(n&=~C_,n&=~ev,t.suspendedLanes|=n,t.pingedLanes&=~n,t=t.expirationTimes;0<n;){var r=31-Ri(n),s=1<<r;t[r]=-1,n&=~s}}function QT(t){if(Jt&6)throw Error(Fe(327));Af();var n=Kg(t,0);if(!(n&1))return da(t,xr()),null;var r=f1(t,n);if(t.tag!==0&&r===2){var s=X2(t);s!==0&&(n=s,r=Sj(t,s))}if(r===1)throw r=pp,Rd(t,0),nc(t,n),da(t,xr()),r;if(r===6)throw Error(Fe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=n,hd(t,na,Ko),da(t,xr()),null}function A_(t,n){var r=Jt;Jt|=1;try{return t(n)}finally{Jt=r,Jt===0&&(zf=xr()+500,Xy&&Uc())}}function nu(t){ic!==null&&ic.tag===0&&!(Jt&6)&&Af();var n=Jt;Jt|=1;var r=li.transition,s=fn;try{if(li.transition=null,fn=1,t)return t()}finally{fn=s,li.transition=r,Jt=n,!(Jt&6)&&Uc()}}function E_(){ja=df.current,Rn(df)}function Rd(t,n){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,OY(r)),wr!==null)for(r=wr.return;r!==null;){var s=r;switch(l_(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Jg();break;case 3:Ff(),Rn(la),Rn(Os),g_();break;case 5:x_(s);break;case 4:Ff();break;case 13:Rn(Kn);break;case 19:Rn(Kn);break;case 10:f_(s.type._context);break;case 22:case 23:E_()}r=r.return}if(Zr=t,wr=t=yc(t.current,null),xs=ja=n,$r=0,pp=null,C_=ev=tu=0,na=Fm=null,Cd!==null){for(n=0;n<Cd.length;n++)if(r=Cd[n],s=r.interleaved,s!==null){r.interleaved=null;var i=s.next,o=r.pending;if(o!==null){var l=o.next;o.next=i,s.next=l}r.pending=s}Cd=null}return t}function u6(t,n){do{var r=wr;try{if(u_(),fg.current=l1,o1){for(var s=Qn.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}o1=!1}if(eu=0,Qr=Dr=Qn=null,Lm=!1,fp=0,S_.current=null,r===null||r.return===null){$r=1,pp=n,wr=null;break}e:{var o=t,l=r.return,c=r,d=n;if(n=xs,c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var u=d,h=c,m=h.tag;if(!(h.mode&1)&&(m===0||m===11||m===15)){var g=h.alternate;g?(h.updateQueue=g.updateQueue,h.memoizedState=g.memoizedState,h.lanes=g.lanes):(h.updateQueue=null,h.memoizedState=null)}var y=BT(l);if(y!==null){y.flags&=-257,FT(y,l,c,o,n),y.mode&1&&LT(o,u,n),n=y,d=u;var N=n.updateQueue;if(N===null){var j=new Set;j.add(d),n.updateQueue=j}else N.add(d);break e}else{if(!(n&1)){LT(o,u,n),k_();break e}d=Error(Fe(426))}}else if(Fn&&c.mode&1){var S=BT(l);if(S!==null){!(S.flags&65536)&&(S.flags|=256),FT(S,l,c,o,n),c_($f(d,c));break e}}o=d=$f(d,c),$r!==4&&($r=2),Fm===null?Fm=[o]:Fm.push(o),o=l;do{switch(o.tag){case 3:o.flags|=65536,n&=-n,o.lanes|=n;var _=K8(o,d,n);IT(o,_);break e;case 1:c=d;var A=o.type,k=o.stateNode;if(!(o.flags&128)&&(typeof A.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(xc===null||!xc.has(k)))){o.flags|=65536,n&=-n,o.lanes|=n;var T=Y8(o,c,n);IT(o,T);break e}}o=o.return}while(o!==null)}m6(r)}catch(P){n=P,wr===r&&r!==null&&(wr=r=r.return);continue}break}while(!0)}function f6(){var t=c1.current;return c1.current=l1,t===null?l1:t}function k_(){($r===0||$r===3||$r===2)&&($r=4),Zr===null||!(tu&268435455)&&!(ev&268435455)||nc(Zr,xs)}function f1(t,n){var r=Jt;Jt|=2;var s=f6();(Zr!==t||xs!==n)&&(Ko=null,Rd(t,n));do try{aX();break}catch(i){u6(t,i)}while(!0);if(u_(),Jt=r,c1.current=s,wr!==null)throw Error(Fe(261));return Zr=null,xs=0,$r}function aX(){for(;wr!==null;)h6(wr)}function iX(){for(;wr!==null&&!IK();)h6(wr)}function h6(t){var n=x6(t.alternate,t,ja);t.memoizedProps=t.pendingProps,n===null?m6(t):wr=n,S_.current=null}function m6(t){var n=t;do{var r=n.alternate;if(t=n.return,n.flags&32768){if(r=JY(r,n),r!==null){r.flags&=32767,wr=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{$r=6,wr=null;return}}else if(r=ZY(r,n,ja),r!==null){wr=r;return}if(n=n.sibling,n!==null){wr=n;return}wr=n=t}while(n!==null);$r===0&&($r=5)}function hd(t,n,r){var s=fn,i=li.transition;try{li.transition=null,fn=1,oX(t,n,r,s)}finally{li.transition=i,fn=s}return null}function oX(t,n,r,s){do Af();while(ic!==null);if(Jt&6)throw Error(Fe(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Fe(177));t.callbackNode=null,t.callbackPriority=0;var o=r.lanes|r.childLanes;if(zK(t,o),t===Zr&&(wr=Zr=null,xs=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||i0||(i0=!0,g6(Gg,function(){return Af(),null})),o=(r.flags&15990)!==0,r.subtreeFlags&15990||o){o=li.transition,li.transition=null;var l=fn;fn=1;var c=Jt;Jt|=4,S_.current=null,tX(t,r),l6(r,t),AY(nj),Yg=!!tj,nj=tj=null,t.current=r,nX(r),PK(),Jt=c,fn=l,li.transition=o}else t.current=r;if(i0&&(i0=!1,ic=t,u1=i),o=t.pendingLanes,o===0&&(xc=null),DK(r.stateNode),da(t,xr()),n!==null)for(s=t.onRecoverableError,r=0;r<n.length;r++)i=n[r],s(i.value,{componentStack:i.stack,digest:i.digest});if(d1)throw d1=!1,t=Nj,Nj=null,t;return u1&1&&t.tag!==0&&Af(),o=t.pendingLanes,o&1?t===jj?$m++:($m=0,jj=t):$m=0,Uc(),null}function Af(){if(ic!==null){var t=KR(u1),n=li.transition,r=fn;try{if(li.transition=null,fn=16>t?16:t,ic===null)var s=!1;else{if(t=ic,ic=null,u1=0,Jt&6)throw Error(Fe(331));var i=Jt;for(Jt|=4,it=t.current;it!==null;){var o=it,l=o.child;if(it.flags&16){var c=o.deletions;if(c!==null){for(var d=0;d<c.length;d++){var u=c[d];for(it=u;it!==null;){var h=it;switch(h.tag){case 0:case 11:case 15:Bm(8,h,o)}var m=h.child;if(m!==null)m.return=h,it=m;else for(;it!==null;){h=it;var g=h.sibling,y=h.return;if(a6(h),h===u){it=null;break}if(g!==null){g.return=y,it=g;break}it=y}}}var N=o.alternate;if(N!==null){var j=N.child;if(j!==null){N.child=null;do{var S=j.sibling;j.sibling=null,j=S}while(j!==null)}}it=o}}if(o.subtreeFlags&2064&&l!==null)l.return=o,it=l;else e:for(;it!==null;){if(o=it,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Bm(9,o,o.return)}var _=o.sibling;if(_!==null){_.return=o.return,it=_;break e}it=o.return}}var A=t.current;for(it=A;it!==null;){l=it;var k=l.child;if(l.subtreeFlags&2064&&k!==null)k.return=l,it=k;else e:for(l=A;it!==null;){if(c=it,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Jy(9,c)}}catch(P){ir(c,c.return,P)}if(c===l){it=null;break e}var T=c.sibling;if(T!==null){T.return=c.return,it=T;break e}it=c.return}}if(Jt=i,Uc(),go&&typeof go.onPostCommitFiberRoot=="function")try{go.onPostCommitFiberRoot(Wy,t)}catch{}s=!0}return s}finally{fn=r,li.transition=n}}return!1}function ZT(t,n,r){n=$f(r,n),n=K8(t,n,1),t=pc(t,n,1),n=Ws(),t!==null&&(rx(t,1,n),da(t,n))}function ir(t,n,r){if(t.tag===3)ZT(t,t,r);else for(;n!==null;){if(n.tag===3){ZT(n,t,r);break}else if(n.tag===1){var s=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(xc===null||!xc.has(s))){t=$f(r,t),t=Y8(n,t,1),n=pc(n,t,1),t=Ws(),n!==null&&(rx(n,1,t),da(n,t));break}}n=n.return}}function lX(t,n,r){var s=t.pingCache;s!==null&&s.delete(n),n=Ws(),t.pingedLanes|=t.suspendedLanes&r,Zr===t&&(xs&r)===r&&($r===4||$r===3&&(xs&130023424)===xs&&500>xr()-__?Rd(t,0):C_|=r),da(t,n)}function p6(t,n){n===0&&(t.mode&1?(n=Xx,Xx<<=1,!(Xx&130023424)&&(Xx=4194304)):n=1);var r=Ws();t=dl(t,n),t!==null&&(rx(t,n,r),da(t,r))}function cX(t){var n=t.memoizedState,r=0;n!==null&&(r=n.retryLane),p6(t,r)}function dX(t,n){var r=0;switch(t.tag){case 13:var s=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(Fe(314))}s!==null&&s.delete(n),p6(t,r)}var x6;x6=function(t,n,r){if(t!==null)if(t.memoizedProps!==n.pendingProps||la.current)aa=!0;else{if(!(t.lanes&r)&&!(n.flags&128))return aa=!1,QY(t,n,r);aa=!!(t.flags&131072)}else aa=!1,Fn&&n.flags&1048576&&b8(n,n1,n.index);switch(n.lanes=0,n.tag){case 2:var s=n.type;mg(t,n),t=n.pendingProps;var i=Rf(n,Os.current);_f(n,r),i=v_(null,n,s,t,i,r);var o=b_();return n.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,ca(s)?(o=!0,e1(n)):o=!1,n.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,m_(n),i.updater=Zy,n.stateNode=i,i._reactInternals=n,uj(n,s,t,r),n=mj(null,n,s,!0,o,r)):(n.tag=0,Fn&&o&&o_(n),$s(null,n,i,r),n=n.child),n;case 16:s=n.elementType;e:{switch(mg(t,n),t=n.pendingProps,i=s._init,s=i(s._payload),n.type=s,i=n.tag=fX(s),t=Ei(s,t),i){case 0:n=hj(null,n,s,t,r);break e;case 1:n=UT(null,n,s,t,r);break e;case 11:n=$T(null,n,s,t,r);break e;case 14:n=zT(null,n,s,Ei(s.type,t),r);break e}throw Error(Fe(306,s,""))}return n;case 0:return s=n.type,i=n.pendingProps,i=n.elementType===s?i:Ei(s,i),hj(t,n,s,i,r);case 1:return s=n.type,i=n.pendingProps,i=n.elementType===s?i:Ei(s,i),UT(t,n,s,i,r);case 3:e:{if(J8(n),t===null)throw Error(Fe(387));s=n.pendingProps,o=n.memoizedState,i=o.element,_8(t,n),a1(n,s,null,r);var l=n.memoizedState;if(s=l.element,o.isDehydrated)if(o={element:s,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},n.updateQueue.baseState=o,n.memoizedState=o,n.flags&256){i=$f(Error(Fe(423)),n),n=VT(t,n,s,r,i);break e}else if(s!==i){i=$f(Error(Fe(424)),n),n=VT(t,n,s,r,i);break e}else for(Ta=mc(n.stateNode.containerInfo.firstChild),Pa=n,Fn=!0,Ii=null,r=S8(n,null,s,r),n.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Lf(),s===i){n=ul(t,n,r);break e}$s(t,n,s,r)}n=n.child}return n;case 5:return A8(n),t===null&&lj(n),s=n.type,i=n.pendingProps,o=t!==null?t.memoizedProps:null,l=i.children,rj(s,i)?l=null:o!==null&&rj(s,o)&&(n.flags|=32),Z8(t,n),$s(t,n,l,r),n.child;case 6:return t===null&&lj(n),null;case 13:return e6(t,n,r);case 4:return p_(n,n.stateNode.containerInfo),s=n.pendingProps,t===null?n.child=Bf(n,null,s,r):$s(t,n,s,r),n.child;case 11:return s=n.type,i=n.pendingProps,i=n.elementType===s?i:Ei(s,i),$T(t,n,s,i,r);case 7:return $s(t,n,n.pendingProps,r),n.child;case 8:return $s(t,n,n.pendingProps.children,r),n.child;case 12:return $s(t,n,n.pendingProps.children,r),n.child;case 10:e:{if(s=n.type._context,i=n.pendingProps,o=n.memoizedProps,l=i.value,En(r1,s._currentValue),s._currentValue=l,o!==null)if($i(o.value,l)){if(o.children===i.children&&!la.current){n=ul(t,n,r);break e}}else for(o=n.child,o!==null&&(o.return=n);o!==null;){var c=o.dependencies;if(c!==null){l=o.child;for(var d=c.firstContext;d!==null;){if(d.context===s){if(o.tag===1){d=al(-1,r&-r),d.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?d.next=d:(d.next=h.next,h.next=d),u.pending=d}}o.lanes|=r,d=o.alternate,d!==null&&(d.lanes|=r),cj(o.return,r,n),c.lanes|=r;break}d=d.next}}else if(o.tag===10)l=o.type===n.type?null:o.child;else if(o.tag===18){if(l=o.return,l===null)throw Error(Fe(341));l.lanes|=r,c=l.alternate,c!==null&&(c.lanes|=r),cj(l,r,n),l=o.sibling}else l=o.child;if(l!==null)l.return=o;else for(l=o;l!==null;){if(l===n){l=null;break}if(o=l.sibling,o!==null){o.return=l.return,l=o;break}l=l.return}o=l}$s(t,n,i.children,r),n=n.child}return n;case 9:return i=n.type,s=n.pendingProps.children,_f(n,r),i=ui(i),s=s(i),n.flags|=1,$s(t,n,s,r),n.child;case 14:return s=n.type,i=Ei(s,n.pendingProps),i=Ei(s.type,i),zT(t,n,s,i,r);case 15:return X8(t,n,n.type,n.pendingProps,r);case 17:return s=n.type,i=n.pendingProps,i=n.elementType===s?i:Ei(s,i),mg(t,n),n.tag=1,ca(s)?(t=!0,e1(n)):t=!1,_f(n,r),G8(n,s,i),uj(n,s,i,r),mj(null,n,s,!0,t,r);case 19:return t6(t,n,r);case 22:return Q8(t,n,r)}throw Error(Fe(156,n.tag))};function g6(t,n){return HR(t,n)}function uX(t,n,r,s){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ai(t,n,r,s){return new uX(t,n,r,s)}function T_(t){return t=t.prototype,!(!t||!t.isReactComponent)}function fX(t){if(typeof t=="function")return T_(t)?1:0;if(t!=null){if(t=t.$$typeof,t===YC)return 11;if(t===XC)return 14}return 2}function yc(t,n){var r=t.alternate;return r===null?(r=ai(t.tag,n,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=n,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,n=t.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function gg(t,n,r,s,i,o){var l=2;if(s=t,typeof t=="function")T_(t)&&(l=1);else if(typeof t=="string")l=5;else e:switch(t){case Ju:return Ld(r.children,i,o,n);case KC:l=8,i|=8;break;case D2:return t=ai(12,r,n,i|2),t.elementType=D2,t.lanes=o,t;case R2:return t=ai(13,r,n,i),t.elementType=R2,t.lanes=o,t;case L2:return t=ai(19,r,n,i),t.elementType=L2,t.lanes=o,t;case AR:return tv(r,i,o,n);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case CR:l=10;break e;case _R:l=9;break e;case YC:l=11;break e;case XC:l=14;break e;case Yl:l=16,s=null;break e}throw Error(Fe(130,t==null?t:typeof t,""))}return n=ai(l,r,n,i),n.elementType=t,n.type=s,n.lanes=o,n}function Ld(t,n,r,s){return t=ai(7,t,s,n),t.lanes=r,t}function tv(t,n,r,s){return t=ai(22,t,s,n),t.elementType=AR,t.lanes=r,t.stateNode={isHidden:!1},t}function zw(t,n,r){return t=ai(6,t,null,n),t.lanes=r,t}function Uw(t,n,r){return n=ai(4,t.children!==null?t.children:[],t.key,n),n.lanes=r,n.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},n}function hX(t,n,r,s,i){this.tag=n,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Nw(0),this.expirationTimes=Nw(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Nw(0),this.identifierPrefix=s,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function I_(t,n,r,s,i,o,l,c,d){return t=new hX(t,n,r,c,d),n===1?(n=1,o===!0&&(n|=8)):n=0,o=ai(3,null,null,n),t.current=o,o.stateNode=t,o.memoizedState={element:s,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},m_(o),t}function mX(t,n,r){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Zu,key:s==null?null:""+s,children:t,containerInfo:n,implementation:r}}function y6(t){if(!t)return Ac;t=t._reactInternals;e:{if(ju(t)!==t||t.tag!==1)throw Error(Fe(170));var n=t;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(ca(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(Fe(171))}if(t.tag===1){var r=t.type;if(ca(r))return y8(t,r,n)}return n}function v6(t,n,r,s,i,o,l,c,d){return t=I_(r,s,!0,t,i,o,l,c,d),t.context=y6(null),r=t.current,s=Ws(),i=gc(r),o=al(s,i),o.callback=n??null,pc(r,o,i),t.current.lanes=i,rx(t,i,s),da(t,s),t}function nv(t,n,r,s){var i=n.current,o=Ws(),l=gc(i);return r=y6(r),n.context===null?n.context=r:n.pendingContext=r,n=al(o,l),n.payload={element:t},s=s===void 0?null:s,s!==null&&(n.callback=s),t=pc(i,n,l),t!==null&&(Li(t,i,l,o),ug(t,i,l)),l}function h1(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function JT(t,n){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<n?r:n}}function P_(t,n){JT(t,n),(t=t.alternate)&&JT(t,n)}function pX(){return null}var b6=typeof reportError=="function"?reportError:function(t){console.error(t)};function M_(t){this._internalRoot=t}rv.prototype.render=M_.prototype.render=function(t){var n=this._internalRoot;if(n===null)throw Error(Fe(409));nv(t,n,null,null)};rv.prototype.unmount=M_.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var n=t.containerInfo;nu(function(){nv(null,t,null,null)}),n[cl]=null}};function rv(t){this._internalRoot=t}rv.prototype.unstable_scheduleHydration=function(t){if(t){var n=QR();t={blockedOn:null,target:t,priority:n};for(var r=0;r<tc.length&&n!==0&&n<tc[r].priority;r++);tc.splice(r,0,t),r===0&&JR(t)}};function O_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function sv(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function e5(){}function xX(t,n,r,s,i){if(i){if(typeof s=="function"){var o=s;s=function(){var u=h1(l);o.call(u)}}var l=v6(n,s,t,0,null,!1,!1,"",e5);return t._reactRootContainer=l,t[cl]=l.current,op(t.nodeType===8?t.parentNode:t),nu(),l}for(;i=t.lastChild;)t.removeChild(i);if(typeof s=="function"){var c=s;s=function(){var u=h1(d);c.call(u)}}var d=I_(t,0,!1,null,null,!1,!1,"",e5);return t._reactRootContainer=d,t[cl]=d.current,op(t.nodeType===8?t.parentNode:t),nu(function(){nv(n,d,r,s)}),d}function av(t,n,r,s,i){var o=r._reactRootContainer;if(o){var l=o;if(typeof i=="function"){var c=i;i=function(){var d=h1(l);c.call(d)}}nv(n,l,t,i)}else l=xX(r,n,t,i,s);return h1(l)}YR=function(t){switch(t.tag){case 3:var n=t.stateNode;if(n.current.memoizedState.isDehydrated){var r=jm(n.pendingLanes);r!==0&&(JC(n,r|1),da(n,xr()),!(Jt&6)&&(zf=xr()+500,Uc()))}break;case 13:nu(function(){var s=dl(t,1);if(s!==null){var i=Ws();Li(s,t,1,i)}}),P_(t,1)}};e_=function(t){if(t.tag===13){var n=dl(t,134217728);if(n!==null){var r=Ws();Li(n,t,134217728,r)}P_(t,134217728)}};XR=function(t){if(t.tag===13){var n=gc(t),r=dl(t,n);if(r!==null){var s=Ws();Li(r,t,n,s)}P_(t,n)}};QR=function(){return fn};ZR=function(t,n){var r=fn;try{return fn=t,n()}finally{fn=r}};G2=function(t,n,r){switch(n){case"input":if($2(t,r),n=r.name,r.type==="radio"&&n!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<r.length;n++){var s=r[n];if(s!==t&&s.form===t.form){var i=Yy(s);if(!i)throw Error(Fe(90));kR(s),$2(s,i)}}}break;case"textarea":IR(t,r);break;case"select":n=r.value,n!=null&&Nf(t,!!r.multiple,n,!1)}};BR=A_;FR=nu;var gX={usingClientEntryPoint:!1,Events:[ax,rf,Yy,RR,LR,A_]},nm={findFiberByHostInstance:Sd,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},yX={bundleType:nm.bundleType,version:nm.version,rendererPackageName:nm.rendererPackageName,rendererConfig:nm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Sl.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=UR(t),t===null?null:t.stateNode},findFiberByHostInstance:nm.findFiberByHostInstance||pX,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var o0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!o0.isDisabled&&o0.supportsFiber)try{Wy=o0.inject(yX),go=o0}catch{}}$a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gX;$a.createPortal=function(t,n){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!O_(n))throw Error(Fe(200));return mX(t,n,null,r)};$a.createRoot=function(t,n){if(!O_(t))throw Error(Fe(299));var r=!1,s="",i=b6;return n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),n=I_(t,1,!1,null,null,r,!1,s,i),t[cl]=n.current,op(t.nodeType===8?t.parentNode:t),new M_(n)};$a.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var n=t._reactInternals;if(n===void 0)throw typeof t.render=="function"?Error(Fe(188)):(t=Object.keys(t).join(","),Error(Fe(268,t)));return t=UR(n),t=t===null?null:t.stateNode,t};$a.flushSync=function(t){return nu(t)};$a.hydrate=function(t,n,r){if(!sv(n))throw Error(Fe(200));return av(null,t,n,!0,r)};$a.hydrateRoot=function(t,n,r){if(!O_(t))throw Error(Fe(405));var s=r!=null&&r.hydratedSources||null,i=!1,o="",l=b6;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),n=v6(n,null,t,1,r??null,i,!1,o,l),t[cl]=n.current,op(t),s)for(t=0;t<s.length;t++)r=s[t],i=r._getVersion,i=i(r._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[r,i]:n.mutableSourceEagerHydrationData.push(r,i);return new rv(n)};$a.render=function(t,n,r){if(!sv(n))throw Error(Fe(200));return av(null,t,n,!1,r)};$a.unmountComponentAtNode=function(t){if(!sv(t))throw Error(Fe(40));return t._reactRootContainer?(nu(function(){av(null,null,t,!1,function(){t._reactRootContainer=null,t[cl]=null})}),!0):!1};$a.unstable_batchedUpdates=A_;$a.unstable_renderSubtreeIntoContainer=function(t,n,r,s){if(!sv(r))throw Error(Fe(200));if(t==null||t._reactInternals===void 0)throw Error(Fe(38));return av(t,n,r,!1,s)};$a.version="18.3.1-next-f1338f8080-20240426";function w6(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(w6)}catch(t){console.error(t)}}w6(),wR.exports=$a;var Vc=wR.exports;const N6=gi(Vc);var t5=Vc;M2.createRoot=t5.createRoot,M2.hydrateRoot=t5.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function xp(){return xp=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},xp.apply(this,arguments)}var oc;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(oc||(oc={}));const n5="popstate";function vX(t){t===void 0&&(t={});function n(s,i){let{pathname:o,search:l,hash:c}=s.location;return _j("",{pathname:o,search:l,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(s,i){return typeof i=="string"?i:m1(i)}return wX(n,r,null,t)}function Zn(t,n){if(t===!1||t===null||typeof t>"u")throw new Error(n)}function j6(t,n){if(!t){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function bX(){return Math.random().toString(36).substr(2,8)}function r5(t,n){return{usr:t.state,key:t.key,idx:n}}function _j(t,n,r,s){return r===void 0&&(r=null),xp({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof n=="string"?mh(n):n,{state:r,key:n&&n.key||s||bX()})}function m1(t){let{pathname:n="/",search:r="",hash:s=""}=t;return r&&r!=="?"&&(n+=r.charAt(0)==="?"?r:"?"+r),s&&s!=="#"&&(n+=s.charAt(0)==="#"?s:"#"+s),n}function mh(t){let n={};if(t){let r=t.indexOf("#");r>=0&&(n.hash=t.substr(r),t=t.substr(0,r));let s=t.indexOf("?");s>=0&&(n.search=t.substr(s),t=t.substr(0,s)),t&&(n.pathname=t)}return n}function wX(t,n,r,s){s===void 0&&(s={});let{window:i=document.defaultView,v5Compat:o=!1}=s,l=i.history,c=oc.Pop,d=null,u=h();u==null&&(u=0,l.replaceState(xp({},l.state,{idx:u}),""));function h(){return(l.state||{idx:null}).idx}function m(){c=oc.Pop;let S=h(),_=S==null?null:S-u;u=S,d&&d({action:c,location:j.location,delta:_})}function g(S,_){c=oc.Push;let A=_j(j.location,S,_);u=h()+1;let k=r5(A,u),T=j.createHref(A);try{l.pushState(k,"",T)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;i.location.assign(T)}o&&d&&d({action:c,location:j.location,delta:1})}function y(S,_){c=oc.Replace;let A=_j(j.location,S,_);u=h();let k=r5(A,u),T=j.createHref(A);l.replaceState(k,"",T),o&&d&&d({action:c,location:j.location,delta:0})}function N(S){let _=i.location.origin!=="null"?i.location.origin:i.location.href,A=typeof S=="string"?S:m1(S);return A=A.replace(/ $/,"%20"),Zn(_,"No window.location.(origin|href) available to create URL for href: "+A),new URL(A,_)}let j={get action(){return c},get location(){return t(i,l)},listen(S){if(d)throw new Error("A history only accepts one active listener");return i.addEventListener(n5,m),d=S,()=>{i.removeEventListener(n5,m),d=null}},createHref(S){return n(i,S)},createURL:N,encodeLocation(S){let _=N(S);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:g,replace:y,go(S){return l.go(S)}};return j}var s5;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(s5||(s5={}));function NX(t,n,r){return r===void 0&&(r="/"),jX(t,n,r)}function jX(t,n,r,s){let i=typeof n=="string"?mh(n):n,o=Uf(i.pathname||"/",r);if(o==null)return null;let l=S6(t);SX(l);let c=null;for(let d=0;c==null&&d<l.length;++d){let u=DX(o);c=MX(l[d],u)}return c}function S6(t,n,r,s){n===void 0&&(n=[]),r===void 0&&(r=[]),s===void 0&&(s="");let i=(o,l,c)=>{let d={relativePath:c===void 0?o.path||"":c,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};d.relativePath.startsWith("/")&&(Zn(d.relativePath.startsWith(s),'Absolute route path "'+d.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),d.relativePath=d.relativePath.slice(s.length));let u=vc([s,d.relativePath]),h=r.concat(d);o.children&&o.children.length>0&&(Zn(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),S6(o.children,n,h,u)),!(o.path==null&&!o.index)&&n.push({path:u,score:IX(u,o.index),routesMeta:h})};return t.forEach((o,l)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))i(o,l);else for(let d of C6(o.path))i(o,l,d)}),n}function C6(t){let n=t.split("/");if(n.length===0)return[];let[r,...s]=n,i=r.endsWith("?"),o=r.replace(/\?$/,"");if(s.length===0)return i?[o,""]:[o];let l=C6(s.join("/")),c=[];return c.push(...l.map(d=>d===""?o:[o,d].join("/"))),i&&c.push(...l),c.map(d=>t.startsWith("/")&&d===""?"/":d)}function SX(t){t.sort((n,r)=>n.score!==r.score?r.score-n.score:PX(n.routesMeta.map(s=>s.childrenIndex),r.routesMeta.map(s=>s.childrenIndex)))}const CX=/^:[\w-]+$/,_X=3,AX=2,EX=1,kX=10,TX=-2,a5=t=>t==="*";function IX(t,n){let r=t.split("/"),s=r.length;return r.some(a5)&&(s+=TX),n&&(s+=AX),r.filter(i=>!a5(i)).reduce((i,o)=>i+(CX.test(o)?_X:o===""?EX:kX),s)}function PX(t,n){return t.length===n.length&&t.slice(0,-1).every((s,i)=>s===n[i])?t[t.length-1]-n[n.length-1]:0}function MX(t,n,r){let{routesMeta:s}=t,i={},o="/",l=[];for(let c=0;c<s.length;++c){let d=s[c],u=c===s.length-1,h=o==="/"?n:n.slice(o.length)||"/",m=Aj({path:d.relativePath,caseSensitive:d.caseSensitive,end:u},h),g=d.route;if(!m)return null;Object.assign(i,m.params),l.push({params:i,pathname:vc([o,m.pathname]),pathnameBase:FX(vc([o,m.pathnameBase])),route:g}),m.pathnameBase!=="/"&&(o=vc([o,m.pathnameBase]))}return l}function Aj(t,n){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,s]=OX(t.path,t.caseSensitive,t.end),i=n.match(r);if(!i)return null;let o=i[0],l=o.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:s.reduce((u,h,m)=>{let{paramName:g,isOptional:y}=h;if(g==="*"){let j=c[m]||"";l=o.slice(0,o.length-j.length).replace(/(.)\/+$/,"$1")}const N=c[m];return y&&!N?u[g]=void 0:u[g]=(N||"").replace(/%2F/g,"/"),u},{}),pathname:o,pathnameBase:l,pattern:t}}function OX(t,n,r){n===void 0&&(n=!1),r===void 0&&(r=!0),j6(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,c,d)=>(s.push({paramName:c,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,n?void 0:"i"),s]}function DX(t){try{return t.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return j6(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+n+").")),t}}function Uf(t,n){if(n==="/")return t;if(!t.toLowerCase().startsWith(n.toLowerCase()))return null;let r=n.endsWith("/")?n.length-1:n.length,s=t.charAt(r);return s&&s!=="/"?null:t.slice(r)||"/"}function RX(t,n){n===void 0&&(n="/");let{pathname:r,search:s="",hash:i=""}=typeof t=="string"?mh(t):t;return{pathname:r?r.startsWith("/")?r:LX(r,n):n,search:$X(s),hash:zX(i)}}function LX(t,n){let r=n.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function Vw(t,n,r,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+n+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function BX(t){return t.filter((n,r)=>r===0||n.route.path&&n.route.path.length>0)}function D_(t,n){let r=BX(t);return n?r.map((s,i)=>i===r.length-1?s.pathname:s.pathnameBase):r.map(s=>s.pathnameBase)}function R_(t,n,r,s){s===void 0&&(s=!1);let i;typeof t=="string"?i=mh(t):(i=xp({},t),Zn(!i.pathname||!i.pathname.includes("?"),Vw("?","pathname","search",i)),Zn(!i.pathname||!i.pathname.includes("#"),Vw("#","pathname","hash",i)),Zn(!i.search||!i.search.includes("#"),Vw("#","search","hash",i)));let o=t===""||i.pathname==="",l=o?"/":i.pathname,c;if(l==null)c=r;else{let m=n.length-1;if(!s&&l.startsWith("..")){let g=l.split("/");for(;g[0]==="..";)g.shift(),m-=1;i.pathname=g.join("/")}c=m>=0?n[m]:"/"}let d=RX(i,c),u=l&&l!=="/"&&l.endsWith("/"),h=(o||l===".")&&r.endsWith("/");return!d.pathname.endsWith("/")&&(u||h)&&(d.pathname+="/"),d}const vc=t=>t.join("/").replace(/\/\/+/g,"/"),FX=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),$X=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,zX=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function UX(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const _6=["post","put","patch","delete"];new Set(_6);const VX=["get",..._6];new Set(VX);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function gp(){return gp=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},gp.apply(this,arguments)}const iv=b.createContext(null),A6=b.createContext(null),Cl=b.createContext(null),ov=b.createContext(null),Do=b.createContext({outlet:null,matches:[],isDataRoute:!1}),E6=b.createContext(null);function HX(t,n){let{relative:r}=n===void 0?{}:n;ph()||Zn(!1);let{basename:s,navigator:i}=b.useContext(Cl),{hash:o,pathname:l,search:c}=lv(t,{relative:r}),d=l;return s!=="/"&&(d=l==="/"?s:vc([s,l])),i.createHref({pathname:d,search:c,hash:o})}function ph(){return b.useContext(ov)!=null}function yi(){return ph()||Zn(!1),b.useContext(ov).location}function k6(t){b.useContext(Cl).static||b.useLayoutEffect(t)}function Hi(){let{isDataRoute:t}=b.useContext(Do);return t?aQ():WX()}function WX(){ph()||Zn(!1);let t=b.useContext(iv),{basename:n,future:r,navigator:s}=b.useContext(Cl),{matches:i}=b.useContext(Do),{pathname:o}=yi(),l=JSON.stringify(D_(i,r.v7_relativeSplatPath)),c=b.useRef(!1);return k6(()=>{c.current=!0}),b.useCallback(function(u,h){if(h===void 0&&(h={}),!c.current)return;if(typeof u=="number"){s.go(u);return}let m=R_(u,JSON.parse(l),o,h.relative==="path");t==null&&n!=="/"&&(m.pathname=m.pathname==="/"?n:vc([n,m.pathname])),(h.replace?s.replace:s.push)(m,h.state,h)},[n,s,l,o,t])}const qX=b.createContext(null);function GX(t){let n=b.useContext(Do).outlet;return n&&b.createElement(qX.Provider,{value:t},n)}function Su(){let{matches:t}=b.useContext(Do),n=t[t.length-1];return n?n.params:{}}function lv(t,n){let{relative:r}=n===void 0?{}:n,{future:s}=b.useContext(Cl),{matches:i}=b.useContext(Do),{pathname:o}=yi(),l=JSON.stringify(D_(i,s.v7_relativeSplatPath));return b.useMemo(()=>R_(t,JSON.parse(l),o,r==="path"),[t,l,o,r])}function KX(t,n){return YX(t,n)}function YX(t,n,r,s){ph()||Zn(!1);let{navigator:i}=b.useContext(Cl),{matches:o}=b.useContext(Do),l=o[o.length-1],c=l?l.params:{};l&&l.pathname;let d=l?l.pathnameBase:"/";l&&l.route;let u=yi(),h;if(n){var m;let S=typeof n=="string"?mh(n):n;d==="/"||(m=S.pathname)!=null&&m.startsWith(d)||Zn(!1),h=S}else h=u;let g=h.pathname||"/",y=g;if(d!=="/"){let S=d.replace(/^\//,"").split("/");y="/"+g.replace(/^\//,"").split("/").slice(S.length).join("/")}let N=NX(t,{pathname:y}),j=eQ(N&&N.map(S=>Object.assign({},S,{params:Object.assign({},c,S.params),pathname:vc([d,i.encodeLocation?i.encodeLocation(S.pathname).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?d:vc([d,i.encodeLocation?i.encodeLocation(S.pathnameBase).pathname:S.pathnameBase])})),o,r,s);return n&&j?b.createElement(ov.Provider,{value:{location:gp({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:oc.Pop}},j):j}function XX(){let t=sQ(),n=UX(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},n),r?b.createElement("pre",{style:i},r):null,null)}const QX=b.createElement(XX,null);class ZX extends b.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,r){return r.location!==n.location||r.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:r.error,location:r.location,revalidation:n.revalidation||r.revalidation}}componentDidCatch(n,r){console.error("React Router caught the following error during render",n,r)}render(){return this.state.error!==void 0?b.createElement(Do.Provider,{value:this.props.routeContext},b.createElement(E6.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function JX(t){let{routeContext:n,match:r,children:s}=t,i=b.useContext(iv);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),b.createElement(Do.Provider,{value:n},s)}function eQ(t,n,r,s){var i;if(n===void 0&&(n=[]),r===void 0&&(r=null),s===void 0&&(s=null),t==null){var o;if(!r)return null;if(r.errors)t=r.matches;else if((o=s)!=null&&o.v7_partialHydration&&n.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let l=t,c=(i=r)==null?void 0:i.errors;if(c!=null){let h=l.findIndex(m=>m.route.id&&(c==null?void 0:c[m.route.id])!==void 0);h>=0||Zn(!1),l=l.slice(0,Math.min(l.length,h+1))}let d=!1,u=-1;if(r&&s&&s.v7_partialHydration)for(let h=0;h<l.length;h++){let m=l[h];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(u=h),m.route.id){let{loaderData:g,errors:y}=r,N=m.route.loader&&g[m.route.id]===void 0&&(!y||y[m.route.id]===void 0);if(m.route.lazy||N){d=!0,u>=0?l=l.slice(0,u+1):l=[l[0]];break}}}return l.reduceRight((h,m,g)=>{let y,N=!1,j=null,S=null;r&&(y=c&&m.route.id?c[m.route.id]:void 0,j=m.route.errorElement||QX,d&&(u<0&&g===0?(iQ("route-fallback"),N=!0,S=null):u===g&&(N=!0,S=m.route.hydrateFallbackElement||null)));let _=n.concat(l.slice(0,g+1)),A=()=>{let k;return y?k=j:N?k=S:m.route.Component?k=b.createElement(m.route.Component,null):m.route.element?k=m.route.element:k=h,b.createElement(JX,{match:m,routeContext:{outlet:h,matches:_,isDataRoute:r!=null},children:k})};return r&&(m.route.ErrorBoundary||m.route.errorElement||g===0)?b.createElement(ZX,{location:r.location,revalidation:r.revalidation,component:j,error:y,children:A(),routeContext:{outlet:null,matches:_,isDataRoute:!0}}):A()},null)}var T6=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(T6||{}),I6=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(I6||{});function tQ(t){let n=b.useContext(iv);return n||Zn(!1),n}function nQ(t){let n=b.useContext(A6);return n||Zn(!1),n}function rQ(t){let n=b.useContext(Do);return n||Zn(!1),n}function P6(t){let n=rQ(),r=n.matches[n.matches.length-1];return r.route.id||Zn(!1),r.route.id}function sQ(){var t;let n=b.useContext(E6),r=nQ(),s=P6();return n!==void 0?n:(t=r.errors)==null?void 0:t[s]}function aQ(){let{router:t}=tQ(T6.UseNavigateStable),n=P6(I6.UseNavigateStable),r=b.useRef(!1);return k6(()=>{r.current=!0}),b.useCallback(function(i,o){o===void 0&&(o={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,gp({fromRouteId:n},o)))},[t,n])}const i5={};function iQ(t,n,r){i5[t]||(i5[t]=!0)}function oQ(t,n){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function M6(t){let{to:n,replace:r,state:s,relative:i}=t;ph()||Zn(!1);let{future:o,static:l}=b.useContext(Cl),{matches:c}=b.useContext(Do),{pathname:d}=yi(),u=Hi(),h=R_(n,D_(c,o.v7_relativeSplatPath),d,i==="path"),m=JSON.stringify(h);return b.useEffect(()=>u(JSON.parse(m),{replace:r,state:s,relative:i}),[u,m,i,r,s]),null}function O6(t){return GX(t.context)}function dt(t){Zn(!1)}function lQ(t){let{basename:n="/",children:r=null,location:s,navigationType:i=oc.Pop,navigator:o,static:l=!1,future:c}=t;ph()&&Zn(!1);let d=n.replace(/^\/*/,"/"),u=b.useMemo(()=>({basename:d,navigator:o,static:l,future:gp({v7_relativeSplatPath:!1},c)}),[d,c,o,l]);typeof s=="string"&&(s=mh(s));let{pathname:h="/",search:m="",hash:g="",state:y=null,key:N="default"}=s,j=b.useMemo(()=>{let S=Uf(h,d);return S==null?null:{location:{pathname:S,search:m,hash:g,state:y,key:N},navigationType:i}},[d,h,m,g,y,N,i]);return j==null?null:b.createElement(Cl.Provider,{value:u},b.createElement(ov.Provider,{children:r,value:j}))}function cQ(t){let{children:n,location:r}=t;return KX(Ej(n),r)}new Promise(()=>{});function Ej(t,n){n===void 0&&(n=[]);let r=[];return b.Children.forEach(t,(s,i)=>{if(!b.isValidElement(s))return;let o=[...n,i];if(s.type===b.Fragment){r.push.apply(r,Ej(s.props.children,o));return}s.type!==dt&&Zn(!1),!s.props.index||!s.props.children||Zn(!1);let l={id:s.props.id||o.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(l.children=Ej(s.props.children,o)),r.push(l)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function p1(){return p1=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},p1.apply(this,arguments)}function D6(t,n){if(t==null)return{};var r={},s=Object.keys(t),i,o;for(o=0;o<s.length;o++)i=s[o],!(n.indexOf(i)>=0)&&(r[i]=t[i]);return r}function dQ(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function uQ(t,n){return t.button===0&&(!n||n==="_self")&&!dQ(t)}const fQ=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],hQ=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],mQ="6";try{window.__reactRouterVersion=mQ}catch{}const pQ=b.createContext({isTransitioning:!1}),xQ="startTransition",o5=Hy[xQ];function gQ(t){let{basename:n,children:r,future:s,window:i}=t,o=b.useRef();o.current==null&&(o.current=vX({window:i,v5Compat:!0}));let l=o.current,[c,d]=b.useState({action:l.action,location:l.location}),{v7_startTransition:u}=s||{},h=b.useCallback(m=>{u&&o5?o5(()=>d(m)):d(m)},[d,u]);return b.useLayoutEffect(()=>l.listen(h),[l,h]),b.useEffect(()=>oQ(s),[s]),b.createElement(lQ,{basename:n,children:r,location:c.location,navigationType:c.action,navigator:l,future:s})}const yQ=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",vQ=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,So=b.forwardRef(function(n,r){let{onClick:s,relative:i,reloadDocument:o,replace:l,state:c,target:d,to:u,preventScrollReset:h,viewTransition:m}=n,g=D6(n,fQ),{basename:y}=b.useContext(Cl),N,j=!1;if(typeof u=="string"&&vQ.test(u)&&(N=u,yQ))try{let k=new URL(window.location.href),T=u.startsWith("//")?new URL(k.protocol+u):new URL(u),P=Uf(T.pathname,y);T.origin===k.origin&&P!=null?u=P+T.search+T.hash:j=!0}catch{}let S=HX(u,{relative:i}),_=wQ(u,{replace:l,state:c,target:d,preventScrollReset:h,relative:i,viewTransition:m});function A(k){s&&s(k),k.defaultPrevented||_(k)}return b.createElement("a",p1({},g,{href:N||S,onClick:j||o?s:A,ref:r,target:d}))}),l5=b.forwardRef(function(n,r){let{"aria-current":s="page",caseSensitive:i=!1,className:o="",end:l=!1,style:c,to:d,viewTransition:u,children:h}=n,m=D6(n,hQ),g=lv(d,{relative:m.relative}),y=yi(),N=b.useContext(A6),{navigator:j,basename:S}=b.useContext(Cl),_=N!=null&&NQ(g)&&u===!0,A=j.encodeLocation?j.encodeLocation(g).pathname:g.pathname,k=y.pathname,T=N&&N.navigation&&N.navigation.location?N.navigation.location.pathname:null;i||(k=k.toLowerCase(),T=T?T.toLowerCase():null,A=A.toLowerCase()),T&&S&&(T=Uf(T,S)||T);const P=A!=="/"&&A.endsWith("/")?A.length-1:A.length;let M=k===A||!l&&k.startsWith(A)&&k.charAt(P)==="/",O=T!=null&&(T===A||!l&&T.startsWith(A)&&T.charAt(A.length)==="/"),D={isActive:M,isPending:O,isTransitioning:_},L=M?s:void 0,$;typeof o=="function"?$=o(D):$=[o,M?"active":null,O?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let V=typeof c=="function"?c(D):c;return b.createElement(So,p1({},m,{"aria-current":L,className:$,ref:r,style:V,to:d,viewTransition:u}),typeof h=="function"?h(D):h)});var kj;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(kj||(kj={}));var c5;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(c5||(c5={}));function bQ(t){let n=b.useContext(iv);return n||Zn(!1),n}function wQ(t,n){let{target:r,replace:s,state:i,preventScrollReset:o,relative:l,viewTransition:c}=n===void 0?{}:n,d=Hi(),u=yi(),h=lv(t,{relative:l});return b.useCallback(m=>{if(uQ(m,r)){m.preventDefault();let g=s!==void 0?s:m1(u)===m1(h);d(t,{replace:g,state:i,preventScrollReset:o,relative:l,viewTransition:c})}},[u,d,h,s,i,r,t,o,l,c])}function NQ(t,n){n===void 0&&(n={});let r=b.useContext(pQ);r==null&&Zn(!1);let{basename:s}=bQ(kj.useViewTransitionState),i=lv(t,{relative:n.relative});if(!r.isTransitioning)return!1;let o=Uf(r.currentLocation.pathname,s)||r.currentLocation.pathname,l=Uf(r.nextLocation.pathname,s)||r.nextLocation.pathname;return Aj(i.pathname,l)!=null||Aj(i.pathname,o)!=null}function R6(t,n){return function(){return t.apply(n,arguments)}}const{toString:jQ}=Object.prototype,{getPrototypeOf:L_}=Object,{iterator:cv,toStringTag:L6}=Symbol,dv=(t=>n=>{const r=jQ.call(n);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Wi=t=>(t=t.toLowerCase(),n=>dv(n)===t),uv=t=>n=>typeof n===t,{isArray:xh}=Array,Vf=uv("undefined");function ox(t){return t!==null&&!Vf(t)&&t.constructor!==null&&!Vf(t.constructor)&&ua(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const B6=Wi("ArrayBuffer");function SQ(t){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(t):n=t&&t.buffer&&B6(t.buffer),n}const CQ=uv("string"),ua=uv("function"),F6=uv("number"),lx=t=>t!==null&&typeof t=="object",_Q=t=>t===!0||t===!1,yg=t=>{if(dv(t)!=="object")return!1;const n=L_(t);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(L6 in t)&&!(cv in t)},AQ=t=>{if(!lx(t)||ox(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},EQ=Wi("Date"),kQ=Wi("File"),TQ=Wi("Blob"),IQ=Wi("FileList"),PQ=t=>lx(t)&&ua(t.pipe),MQ=t=>{let n;return t&&(typeof FormData=="function"&&t instanceof FormData||ua(t.append)&&((n=dv(t))==="formdata"||n==="object"&&ua(t.toString)&&t.toString()==="[object FormData]"))},OQ=Wi("URLSearchParams"),[DQ,RQ,LQ,BQ]=["ReadableStream","Request","Response","Headers"].map(Wi),FQ=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function cx(t,n,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let s,i;if(typeof t!="object"&&(t=[t]),xh(t))for(s=0,i=t.length;s<i;s++)n.call(null,t[s],s,t);else{if(ox(t))return;const o=r?Object.getOwnPropertyNames(t):Object.keys(t),l=o.length;let c;for(s=0;s<l;s++)c=o[s],n.call(null,t[c],c,t)}}function $6(t,n){if(ox(t))return null;n=n.toLowerCase();const r=Object.keys(t);let s=r.length,i;for(;s-- >0;)if(i=r[s],n===i.toLowerCase())return i;return null}const Ad=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,z6=t=>!Vf(t)&&t!==Ad;function Tj(){const{caseless:t,skipUndefined:n}=z6(this)&&this||{},r={},s=(i,o)=>{const l=t&&$6(r,o)||o;yg(r[l])&&yg(i)?r[l]=Tj(r[l],i):yg(i)?r[l]=Tj({},i):xh(i)?r[l]=i.slice():(!n||!Vf(i))&&(r[l]=i)};for(let i=0,o=arguments.length;i<o;i++)arguments[i]&&cx(arguments[i],s);return r}const $Q=(t,n,r,{allOwnKeys:s}={})=>(cx(n,(i,o)=>{r&&ua(i)?t[o]=R6(i,r):t[o]=i},{allOwnKeys:s}),t),zQ=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),UQ=(t,n,r,s)=>{t.prototype=Object.create(n.prototype,s),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:n.prototype}),r&&Object.assign(t.prototype,r)},VQ=(t,n,r,s)=>{let i,o,l;const c={};if(n=n||{},t==null)return n;do{for(i=Object.getOwnPropertyNames(t),o=i.length;o-- >0;)l=i[o],(!s||s(l,t,n))&&!c[l]&&(n[l]=t[l],c[l]=!0);t=r!==!1&&L_(t)}while(t&&(!r||r(t,n))&&t!==Object.prototype);return n},HQ=(t,n,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=n.length;const s=t.indexOf(n,r);return s!==-1&&s===r},WQ=t=>{if(!t)return null;if(xh(t))return t;let n=t.length;if(!F6(n))return null;const r=new Array(n);for(;n-- >0;)r[n]=t[n];return r},qQ=(t=>n=>t&&n instanceof t)(typeof Uint8Array<"u"&&L_(Uint8Array)),GQ=(t,n)=>{const s=(t&&t[cv]).call(t);let i;for(;(i=s.next())&&!i.done;){const o=i.value;n.call(t,o[0],o[1])}},KQ=(t,n)=>{let r;const s=[];for(;(r=t.exec(n))!==null;)s.push(r);return s},YQ=Wi("HTMLFormElement"),XQ=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,s,i){return s.toUpperCase()+i}),d5=(({hasOwnProperty:t})=>(n,r)=>t.call(n,r))(Object.prototype),QQ=Wi("RegExp"),U6=(t,n)=>{const r=Object.getOwnPropertyDescriptors(t),s={};cx(r,(i,o)=>{let l;(l=n(i,o,t))!==!1&&(s[o]=l||i)}),Object.defineProperties(t,s)},ZQ=t=>{U6(t,(n,r)=>{if(ua(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const s=t[r];if(ua(s)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},JQ=(t,n)=>{const r={},s=i=>{i.forEach(o=>{r[o]=!0})};return xh(t)?s(t):s(String(t).split(n)),r},eZ=()=>{},tZ=(t,n)=>t!=null&&Number.isFinite(t=+t)?t:n;function nZ(t){return!!(t&&ua(t.append)&&t[L6]==="FormData"&&t[cv])}const rZ=t=>{const n=new Array(10),r=(s,i)=>{if(lx(s)){if(n.indexOf(s)>=0)return;if(ox(s))return s;if(!("toJSON"in s)){n[i]=s;const o=xh(s)?[]:{};return cx(s,(l,c)=>{const d=r(l,i+1);!Vf(d)&&(o[c]=d)}),n[i]=void 0,o}}return s};return r(t,0)},sZ=Wi("AsyncFunction"),aZ=t=>t&&(lx(t)||ua(t))&&ua(t.then)&&ua(t.catch),V6=((t,n)=>t?setImmediate:n?((r,s)=>(Ad.addEventListener("message",({source:i,data:o})=>{i===Ad&&o===r&&s.length&&s.shift()()},!1),i=>{s.push(i),Ad.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",ua(Ad.postMessage)),iZ=typeof queueMicrotask<"u"?queueMicrotask.bind(Ad):typeof process<"u"&&process.nextTick||V6,oZ=t=>t!=null&&ua(t[cv]),Ee={isArray:xh,isArrayBuffer:B6,isBuffer:ox,isFormData:MQ,isArrayBufferView:SQ,isString:CQ,isNumber:F6,isBoolean:_Q,isObject:lx,isPlainObject:yg,isEmptyObject:AQ,isReadableStream:DQ,isRequest:RQ,isResponse:LQ,isHeaders:BQ,isUndefined:Vf,isDate:EQ,isFile:kQ,isBlob:TQ,isRegExp:QQ,isFunction:ua,isStream:PQ,isURLSearchParams:OQ,isTypedArray:qQ,isFileList:IQ,forEach:cx,merge:Tj,extend:$Q,trim:FQ,stripBOM:zQ,inherits:UQ,toFlatObject:VQ,kindOf:dv,kindOfTest:Wi,endsWith:HQ,toArray:WQ,forEachEntry:GQ,matchAll:KQ,isHTMLForm:YQ,hasOwnProperty:d5,hasOwnProp:d5,reduceDescriptors:U6,freezeMethods:ZQ,toObjectSet:JQ,toCamelCase:XQ,noop:eZ,toFiniteNumber:tZ,findKey:$6,global:Ad,isContextDefined:z6,isSpecCompliantForm:nZ,toJSONObject:rZ,isAsyncFn:sZ,isThenable:aZ,setImmediate:V6,asap:iZ,isIterable:oZ};function Rt(t,n,r,s,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",n&&(this.code=n),r&&(this.config=r),s&&(this.request=s),i&&(this.response=i,this.status=i.status?i.status:null)}Ee.inherits(Rt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ee.toJSONObject(this.config),code:this.code,status:this.status}}});const H6=Rt.prototype,W6={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{W6[t]={value:t}});Object.defineProperties(Rt,W6);Object.defineProperty(H6,"isAxiosError",{value:!0});Rt.from=(t,n,r,s,i,o)=>{const l=Object.create(H6);Ee.toFlatObject(t,l,function(h){return h!==Error.prototype},u=>u!=="isAxiosError");const c=t&&t.message?t.message:"Error",d=n==null&&t?t.code:n;return Rt.call(l,c,d,r,s,i),t&&l.cause==null&&Object.defineProperty(l,"cause",{value:t,configurable:!0}),l.name=t&&t.name||"Error",o&&Object.assign(l,o),l};const lZ=null;function Ij(t){return Ee.isPlainObject(t)||Ee.isArray(t)}function q6(t){return Ee.endsWith(t,"[]")?t.slice(0,-2):t}function u5(t,n,r){return t?t.concat(n).map(function(i,o){return i=q6(i),!r&&o?"["+i+"]":i}).join(r?".":""):n}function cZ(t){return Ee.isArray(t)&&!t.some(Ij)}const dZ=Ee.toFlatObject(Ee,{},null,function(n){return/^is[A-Z]/.test(n)});function fv(t,n,r){if(!Ee.isObject(t))throw new TypeError("target must be an object");n=n||new FormData,r=Ee.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(j,S){return!Ee.isUndefined(S[j])});const s=r.metaTokens,i=r.visitor||h,o=r.dots,l=r.indexes,d=(r.Blob||typeof Blob<"u"&&Blob)&&Ee.isSpecCompliantForm(n);if(!Ee.isFunction(i))throw new TypeError("visitor must be a function");function u(N){if(N===null)return"";if(Ee.isDate(N))return N.toISOString();if(Ee.isBoolean(N))return N.toString();if(!d&&Ee.isBlob(N))throw new Rt("Blob is not supported. Use a Buffer instead.");return Ee.isArrayBuffer(N)||Ee.isTypedArray(N)?d&&typeof Blob=="function"?new Blob([N]):Buffer.from(N):N}function h(N,j,S){let _=N;if(N&&!S&&typeof N=="object"){if(Ee.endsWith(j,"{}"))j=s?j:j.slice(0,-2),N=JSON.stringify(N);else if(Ee.isArray(N)&&cZ(N)||(Ee.isFileList(N)||Ee.endsWith(j,"[]"))&&(_=Ee.toArray(N)))return j=q6(j),_.forEach(function(k,T){!(Ee.isUndefined(k)||k===null)&&n.append(l===!0?u5([j],T,o):l===null?j:j+"[]",u(k))}),!1}return Ij(N)?!0:(n.append(u5(S,j,o),u(N)),!1)}const m=[],g=Object.assign(dZ,{defaultVisitor:h,convertValue:u,isVisitable:Ij});function y(N,j){if(!Ee.isUndefined(N)){if(m.indexOf(N)!==-1)throw Error("Circular reference detected in "+j.join("."));m.push(N),Ee.forEach(N,function(_,A){(!(Ee.isUndefined(_)||_===null)&&i.call(n,_,Ee.isString(A)?A.trim():A,j,g))===!0&&y(_,j?j.concat(A):[A])}),m.pop()}}if(!Ee.isObject(t))throw new TypeError("data must be an object");return y(t),n}function f5(t){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(s){return n[s]})}function B_(t,n){this._pairs=[],t&&fv(t,this,n)}const G6=B_.prototype;G6.append=function(n,r){this._pairs.push([n,r])};G6.toString=function(n){const r=n?function(s){return n.call(this,s,f5)}:f5;return this._pairs.map(function(i){return r(i[0])+"="+r(i[1])},"").join("&")};function uZ(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function K6(t,n,r){if(!n)return t;const s=r&&r.encode||uZ;Ee.isFunction(r)&&(r={serialize:r});const i=r&&r.serialize;let o;if(i?o=i(n,r):o=Ee.isURLSearchParams(n)?n.toString():new B_(n,r).toString(s),o){const l=t.indexOf("#");l!==-1&&(t=t.slice(0,l)),t+=(t.indexOf("?")===-1?"?":"&")+o}return t}class h5{constructor(){this.handlers=[]}use(n,r,s){return this.handlers.push({fulfilled:n,rejected:r,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){Ee.forEach(this.handlers,function(s){s!==null&&n(s)})}}const Y6={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},fZ=typeof URLSearchParams<"u"?URLSearchParams:B_,hZ=typeof FormData<"u"?FormData:null,mZ=typeof Blob<"u"?Blob:null,pZ={isBrowser:!0,classes:{URLSearchParams:fZ,FormData:hZ,Blob:mZ},protocols:["http","https","file","blob","url","data"]},F_=typeof window<"u"&&typeof document<"u",Pj=typeof navigator=="object"&&navigator||void 0,xZ=F_&&(!Pj||["ReactNative","NativeScript","NS"].indexOf(Pj.product)<0),gZ=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",yZ=F_&&window.location.href||"http://localhost",vZ=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:F_,hasStandardBrowserEnv:xZ,hasStandardBrowserWebWorkerEnv:gZ,navigator:Pj,origin:yZ},Symbol.toStringTag,{value:"Module"})),As={...vZ,...pZ};function bZ(t,n){return fv(t,new As.classes.URLSearchParams,{visitor:function(r,s,i,o){return As.isNode&&Ee.isBuffer(r)?(this.append(s,r.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)},...n})}function wZ(t){return Ee.matchAll(/\w+|\[(\w*)]/g,t).map(n=>n[0]==="[]"?"":n[1]||n[0])}function NZ(t){const n={},r=Object.keys(t);let s;const i=r.length;let o;for(s=0;s<i;s++)o=r[s],n[o]=t[o];return n}function X6(t){function n(r,s,i,o){let l=r[o++];if(l==="__proto__")return!0;const c=Number.isFinite(+l),d=o>=r.length;return l=!l&&Ee.isArray(i)?i.length:l,d?(Ee.hasOwnProp(i,l)?i[l]=[i[l],s]:i[l]=s,!c):((!i[l]||!Ee.isObject(i[l]))&&(i[l]=[]),n(r,s,i[l],o)&&Ee.isArray(i[l])&&(i[l]=NZ(i[l])),!c)}if(Ee.isFormData(t)&&Ee.isFunction(t.entries)){const r={};return Ee.forEachEntry(t,(s,i)=>{n(wZ(s),i,r,0)}),r}return null}function jZ(t,n,r){if(Ee.isString(t))try{return(n||JSON.parse)(t),Ee.trim(t)}catch(s){if(s.name!=="SyntaxError")throw s}return(r||JSON.stringify)(t)}const dx={transitional:Y6,adapter:["xhr","http","fetch"],transformRequest:[function(n,r){const s=r.getContentType()||"",i=s.indexOf("application/json")>-1,o=Ee.isObject(n);if(o&&Ee.isHTMLForm(n)&&(n=new FormData(n)),Ee.isFormData(n))return i?JSON.stringify(X6(n)):n;if(Ee.isArrayBuffer(n)||Ee.isBuffer(n)||Ee.isStream(n)||Ee.isFile(n)||Ee.isBlob(n)||Ee.isReadableStream(n))return n;if(Ee.isArrayBufferView(n))return n.buffer;if(Ee.isURLSearchParams(n))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let c;if(o){if(s.indexOf("application/x-www-form-urlencoded")>-1)return bZ(n,this.formSerializer).toString();if((c=Ee.isFileList(n))||s.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return fv(c?{"files[]":n}:n,d&&new d,this.formSerializer)}}return o||i?(r.setContentType("application/json",!1),jZ(n)):n}],transformResponse:[function(n){const r=this.transitional||dx.transitional,s=r&&r.forcedJSONParsing,i=this.responseType==="json";if(Ee.isResponse(n)||Ee.isReadableStream(n))return n;if(n&&Ee.isString(n)&&(s&&!this.responseType||i)){const l=!(r&&r.silentJSONParsing)&&i;try{return JSON.parse(n,this.parseReviver)}catch(c){if(l)throw c.name==="SyntaxError"?Rt.from(c,Rt.ERR_BAD_RESPONSE,this,null,this.response):c}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:As.classes.FormData,Blob:As.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ee.forEach(["delete","get","head","post","put","patch"],t=>{dx.headers[t]={}});const SZ=Ee.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),CZ=t=>{const n={};let r,s,i;return t&&t.split(`
`).forEach(function(l){i=l.indexOf(":"),r=l.substring(0,i).trim().toLowerCase(),s=l.substring(i+1).trim(),!(!r||n[r]&&SZ[r])&&(r==="set-cookie"?n[r]?n[r].push(s):n[r]=[s]:n[r]=n[r]?n[r]+", "+s:s)}),n},m5=Symbol("internals");function rm(t){return t&&String(t).trim().toLowerCase()}function vg(t){return t===!1||t==null?t:Ee.isArray(t)?t.map(vg):String(t)}function _Z(t){const n=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=r.exec(t);)n[s[1]]=s[2];return n}const AZ=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Hw(t,n,r,s,i){if(Ee.isFunction(s))return s.call(this,n,r);if(i&&(n=r),!!Ee.isString(n)){if(Ee.isString(s))return n.indexOf(s)!==-1;if(Ee.isRegExp(s))return s.test(n)}}function EZ(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,r,s)=>r.toUpperCase()+s)}function kZ(t,n){const r=Ee.toCamelCase(" "+n);["get","set","has"].forEach(s=>{Object.defineProperty(t,s+r,{value:function(i,o,l){return this[s].call(this,n,i,o,l)},configurable:!0})})}let fa=class{constructor(n){n&&this.set(n)}set(n,r,s){const i=this;function o(c,d,u){const h=rm(d);if(!h)throw new Error("header name must be a non-empty string");const m=Ee.findKey(i,h);(!m||i[m]===void 0||u===!0||u===void 0&&i[m]!==!1)&&(i[m||d]=vg(c))}const l=(c,d)=>Ee.forEach(c,(u,h)=>o(u,h,d));if(Ee.isPlainObject(n)||n instanceof this.constructor)l(n,r);else if(Ee.isString(n)&&(n=n.trim())&&!AZ(n))l(CZ(n),r);else if(Ee.isObject(n)&&Ee.isIterable(n)){let c={},d,u;for(const h of n){if(!Ee.isArray(h))throw TypeError("Object iterator must return a key-value pair");c[u=h[0]]=(d=c[u])?Ee.isArray(d)?[...d,h[1]]:[d,h[1]]:h[1]}l(c,r)}else n!=null&&o(r,n,s);return this}get(n,r){if(n=rm(n),n){const s=Ee.findKey(this,n);if(s){const i=this[s];if(!r)return i;if(r===!0)return _Z(i);if(Ee.isFunction(r))return r.call(this,i,s);if(Ee.isRegExp(r))return r.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,r){if(n=rm(n),n){const s=Ee.findKey(this,n);return!!(s&&this[s]!==void 0&&(!r||Hw(this,this[s],s,r)))}return!1}delete(n,r){const s=this;let i=!1;function o(l){if(l=rm(l),l){const c=Ee.findKey(s,l);c&&(!r||Hw(s,s[c],c,r))&&(delete s[c],i=!0)}}return Ee.isArray(n)?n.forEach(o):o(n),i}clear(n){const r=Object.keys(this);let s=r.length,i=!1;for(;s--;){const o=r[s];(!n||Hw(this,this[o],o,n,!0))&&(delete this[o],i=!0)}return i}normalize(n){const r=this,s={};return Ee.forEach(this,(i,o)=>{const l=Ee.findKey(s,o);if(l){r[l]=vg(i),delete r[o];return}const c=n?EZ(o):String(o).trim();c!==o&&delete r[o],r[c]=vg(i),s[c]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const r=Object.create(null);return Ee.forEach(this,(s,i)=>{s!=null&&s!==!1&&(r[i]=n&&Ee.isArray(s)?s.join(", "):s)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,r])=>n+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...r){const s=new this(n);return r.forEach(i=>s.set(i)),s}static accessor(n){const s=(this[m5]=this[m5]={accessors:{}}).accessors,i=this.prototype;function o(l){const c=rm(l);s[c]||(kZ(i,l),s[c]=!0)}return Ee.isArray(n)?n.forEach(o):o(n),this}};fa.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ee.reduceDescriptors(fa.prototype,({value:t},n)=>{let r=n[0].toUpperCase()+n.slice(1);return{get:()=>t,set(s){this[r]=s}}});Ee.freezeMethods(fa);function Ww(t,n){const r=this||dx,s=n||r,i=fa.from(s.headers);let o=s.data;return Ee.forEach(t,function(c){o=c.call(r,o,i.normalize(),n?n.status:void 0)}),i.normalize(),o}function Q6(t){return!!(t&&t.__CANCEL__)}function gh(t,n,r){Rt.call(this,t??"canceled",Rt.ERR_CANCELED,n,r),this.name="CanceledError"}Ee.inherits(gh,Rt,{__CANCEL__:!0});function Z6(t,n,r){const s=r.config.validateStatus;!r.status||!s||s(r.status)?t(r):n(new Rt("Request failed with status code "+r.status,[Rt.ERR_BAD_REQUEST,Rt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function TZ(t){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return n&&n[1]||""}function IZ(t,n){t=t||10;const r=new Array(t),s=new Array(t);let i=0,o=0,l;return n=n!==void 0?n:1e3,function(d){const u=Date.now(),h=s[o];l||(l=u),r[i]=d,s[i]=u;let m=o,g=0;for(;m!==i;)g+=r[m++],m=m%t;if(i=(i+1)%t,i===o&&(o=(o+1)%t),u-l<n)return;const y=h&&u-h;return y?Math.round(g*1e3/y):void 0}}function PZ(t,n){let r=0,s=1e3/n,i,o;const l=(u,h=Date.now())=>{r=h,i=null,o&&(clearTimeout(o),o=null),t(...u)};return[(...u)=>{const h=Date.now(),m=h-r;m>=s?l(u,h):(i=u,o||(o=setTimeout(()=>{o=null,l(i)},s-m)))},()=>i&&l(i)]}const x1=(t,n,r=3)=>{let s=0;const i=IZ(50,250);return PZ(o=>{const l=o.loaded,c=o.lengthComputable?o.total:void 0,d=l-s,u=i(d),h=l<=c;s=l;const m={loaded:l,total:c,progress:c?l/c:void 0,bytes:d,rate:u||void 0,estimated:u&&c&&h?(c-l)/u:void 0,event:o,lengthComputable:c!=null,[n?"download":"upload"]:!0};t(m)},r)},p5=(t,n)=>{const r=t!=null;return[s=>n[0]({lengthComputable:r,total:t,loaded:s}),n[1]]},x5=t=>(...n)=>Ee.asap(()=>t(...n)),MZ=As.hasStandardBrowserEnv?((t,n)=>r=>(r=new URL(r,As.origin),t.protocol===r.protocol&&t.host===r.host&&(n||t.port===r.port)))(new URL(As.origin),As.navigator&&/(msie|trident)/i.test(As.navigator.userAgent)):()=>!0,OZ=As.hasStandardBrowserEnv?{write(t,n,r,s,i,o){const l=[t+"="+encodeURIComponent(n)];Ee.isNumber(r)&&l.push("expires="+new Date(r).toGMTString()),Ee.isString(s)&&l.push("path="+s),Ee.isString(i)&&l.push("domain="+i),o===!0&&l.push("secure"),document.cookie=l.join("; ")},read(t){const n=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function DZ(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function RZ(t,n){return n?t.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):t}function J6(t,n,r){let s=!DZ(n);return t&&(s||r==!1)?RZ(t,n):n}const g5=t=>t instanceof fa?{...t}:t;function ru(t,n){n=n||{};const r={};function s(u,h,m,g){return Ee.isPlainObject(u)&&Ee.isPlainObject(h)?Ee.merge.call({caseless:g},u,h):Ee.isPlainObject(h)?Ee.merge({},h):Ee.isArray(h)?h.slice():h}function i(u,h,m,g){if(Ee.isUndefined(h)){if(!Ee.isUndefined(u))return s(void 0,u,m,g)}else return s(u,h,m,g)}function o(u,h){if(!Ee.isUndefined(h))return s(void 0,h)}function l(u,h){if(Ee.isUndefined(h)){if(!Ee.isUndefined(u))return s(void 0,u)}else return s(void 0,h)}function c(u,h,m){if(m in n)return s(u,h);if(m in t)return s(void 0,u)}const d={url:o,method:o,data:o,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:c,headers:(u,h,m)=>i(g5(u),g5(h),m,!0)};return Ee.forEach(Object.keys({...t,...n}),function(h){const m=d[h]||i,g=m(t[h],n[h],h);Ee.isUndefined(g)&&m!==c||(r[h]=g)}),r}const eL=t=>{const n=ru({},t);let{data:r,withXSRFToken:s,xsrfHeaderName:i,xsrfCookieName:o,headers:l,auth:c}=n;if(n.headers=l=fa.from(l),n.url=K6(J6(n.baseURL,n.url,n.allowAbsoluteUrls),t.params,t.paramsSerializer),c&&l.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),Ee.isFormData(r)){if(As.hasStandardBrowserEnv||As.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(Ee.isFunction(r.getHeaders)){const d=r.getHeaders(),u=["content-type","content-length"];Object.entries(d).forEach(([h,m])=>{u.includes(h.toLowerCase())&&l.set(h,m)})}}if(As.hasStandardBrowserEnv&&(s&&Ee.isFunction(s)&&(s=s(n)),s||s!==!1&&MZ(n.url))){const d=i&&o&&OZ.read(o);d&&l.set(i,d)}return n},LZ=typeof XMLHttpRequest<"u",BZ=LZ&&function(t){return new Promise(function(r,s){const i=eL(t);let o=i.data;const l=fa.from(i.headers).normalize();let{responseType:c,onUploadProgress:d,onDownloadProgress:u}=i,h,m,g,y,N;function j(){y&&y(),N&&N(),i.cancelToken&&i.cancelToken.unsubscribe(h),i.signal&&i.signal.removeEventListener("abort",h)}let S=new XMLHttpRequest;S.open(i.method.toUpperCase(),i.url,!0),S.timeout=i.timeout;function _(){if(!S)return;const k=fa.from("getAllResponseHeaders"in S&&S.getAllResponseHeaders()),P={data:!c||c==="text"||c==="json"?S.responseText:S.response,status:S.status,statusText:S.statusText,headers:k,config:t,request:S};Z6(function(O){r(O),j()},function(O){s(O),j()},P),S=null}"onloadend"in S?S.onloadend=_:S.onreadystatechange=function(){!S||S.readyState!==4||S.status===0&&!(S.responseURL&&S.responseURL.indexOf("file:")===0)||setTimeout(_)},S.onabort=function(){S&&(s(new Rt("Request aborted",Rt.ECONNABORTED,t,S)),S=null)},S.onerror=function(T){const P=T&&T.message?T.message:"Network Error",M=new Rt(P,Rt.ERR_NETWORK,t,S);M.event=T||null,s(M),S=null},S.ontimeout=function(){let T=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const P=i.transitional||Y6;i.timeoutErrorMessage&&(T=i.timeoutErrorMessage),s(new Rt(T,P.clarifyTimeoutError?Rt.ETIMEDOUT:Rt.ECONNABORTED,t,S)),S=null},o===void 0&&l.setContentType(null),"setRequestHeader"in S&&Ee.forEach(l.toJSON(),function(T,P){S.setRequestHeader(P,T)}),Ee.isUndefined(i.withCredentials)||(S.withCredentials=!!i.withCredentials),c&&c!=="json"&&(S.responseType=i.responseType),u&&([g,N]=x1(u,!0),S.addEventListener("progress",g)),d&&S.upload&&([m,y]=x1(d),S.upload.addEventListener("progress",m),S.upload.addEventListener("loadend",y)),(i.cancelToken||i.signal)&&(h=k=>{S&&(s(!k||k.type?new gh(null,t,S):k),S.abort(),S=null)},i.cancelToken&&i.cancelToken.subscribe(h),i.signal&&(i.signal.aborted?h():i.signal.addEventListener("abort",h)));const A=TZ(i.url);if(A&&As.protocols.indexOf(A)===-1){s(new Rt("Unsupported protocol "+A+":",Rt.ERR_BAD_REQUEST,t));return}S.send(o||null)})},FZ=(t,n)=>{const{length:r}=t=t?t.filter(Boolean):[];if(n||r){let s=new AbortController,i;const o=function(u){if(!i){i=!0,c();const h=u instanceof Error?u:this.reason;s.abort(h instanceof Rt?h:new gh(h instanceof Error?h.message:h))}};let l=n&&setTimeout(()=>{l=null,o(new Rt(`timeout ${n} of ms exceeded`,Rt.ETIMEDOUT))},n);const c=()=>{t&&(l&&clearTimeout(l),l=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(o):u.removeEventListener("abort",o)}),t=null)};t.forEach(u=>u.addEventListener("abort",o));const{signal:d}=s;return d.unsubscribe=()=>Ee.asap(c),d}},$Z=function*(t,n){let r=t.byteLength;if(r<n){yield t;return}let s=0,i;for(;s<r;)i=s+n,yield t.slice(s,i),s=i},zZ=async function*(t,n){for await(const r of UZ(t))yield*$Z(r,n)},UZ=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const n=t.getReader();try{for(;;){const{done:r,value:s}=await n.read();if(r)break;yield s}}finally{await n.cancel()}},y5=(t,n,r,s)=>{const i=zZ(t,n);let o=0,l,c=d=>{l||(l=!0,s&&s(d))};return new ReadableStream({async pull(d){try{const{done:u,value:h}=await i.next();if(u){c(),d.close();return}let m=h.byteLength;if(r){let g=o+=m;r(g)}d.enqueue(new Uint8Array(h))}catch(u){throw c(u),u}},cancel(d){return c(d),i.return()}},{highWaterMark:2})},v5=64*1024,{isFunction:l0}=Ee,VZ=(({Request:t,Response:n})=>({Request:t,Response:n}))(Ee.global),{ReadableStream:b5,TextEncoder:w5}=Ee.global,N5=(t,...n)=>{try{return!!t(...n)}catch{return!1}},HZ=t=>{t=Ee.merge.call({skipUndefined:!0},VZ,t);const{fetch:n,Request:r,Response:s}=t,i=n?l0(n):typeof fetch=="function",o=l0(r),l=l0(s);if(!i)return!1;const c=i&&l0(b5),d=i&&(typeof w5=="function"?(N=>j=>N.encode(j))(new w5):async N=>new Uint8Array(await new r(N).arrayBuffer())),u=o&&c&&N5(()=>{let N=!1;const j=new r(As.origin,{body:new b5,method:"POST",get duplex(){return N=!0,"half"}}).headers.has("Content-Type");return N&&!j}),h=l&&c&&N5(()=>Ee.isReadableStream(new s("").body)),m={stream:h&&(N=>N.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(N=>{!m[N]&&(m[N]=(j,S)=>{let _=j&&j[N];if(_)return _.call(j);throw new Rt(`Response type '${N}' is not supported`,Rt.ERR_NOT_SUPPORT,S)})});const g=async N=>{if(N==null)return 0;if(Ee.isBlob(N))return N.size;if(Ee.isSpecCompliantForm(N))return(await new r(As.origin,{method:"POST",body:N}).arrayBuffer()).byteLength;if(Ee.isArrayBufferView(N)||Ee.isArrayBuffer(N))return N.byteLength;if(Ee.isURLSearchParams(N)&&(N=N+""),Ee.isString(N))return(await d(N)).byteLength},y=async(N,j)=>{const S=Ee.toFiniteNumber(N.getContentLength());return S??g(j)};return async N=>{let{url:j,method:S,data:_,signal:A,cancelToken:k,timeout:T,onDownloadProgress:P,onUploadProgress:M,responseType:O,headers:D,withCredentials:L="same-origin",fetchOptions:$}=eL(N),V=n||fetch;O=O?(O+"").toLowerCase():"text";let F=FZ([A,k&&k.toAbortSignal()],T),Q=null;const U=F&&F.unsubscribe&&(()=>{F.unsubscribe()});let z;try{if(M&&u&&S!=="get"&&S!=="head"&&(z=await y(D,_))!==0){let Se=new r(j,{method:"POST",body:_,duplex:"half"}),de;if(Ee.isFormData(_)&&(de=Se.headers.get("content-type"))&&D.setContentType(de),Se.body){const[ye,be]=p5(z,x1(x5(M)));_=y5(Se.body,v5,ye,be)}}Ee.isString(L)||(L=L?"include":"omit");const q=o&&"credentials"in r.prototype,K={...$,signal:F,method:S.toUpperCase(),headers:D.normalize().toJSON(),body:_,duplex:"half",credentials:q?L:void 0};Q=o&&new r(j,K);let X=await(o?V(Q,$):V(j,K));const J=h&&(O==="stream"||O==="response");if(h&&(P||J&&U)){const Se={};["status","statusText","headers"].forEach(xe=>{Se[xe]=X[xe]});const de=Ee.toFiniteNumber(X.headers.get("content-length")),[ye,be]=P&&p5(de,x1(x5(P),!0))||[];X=new s(y5(X.body,v5,ye,()=>{be&&be(),U&&U()}),Se)}O=O||"text";let ne=await m[Ee.findKey(m,O)||"text"](X,N);return!J&&U&&U(),await new Promise((Se,de)=>{Z6(Se,de,{data:ne,headers:fa.from(X.headers),status:X.status,statusText:X.statusText,config:N,request:Q})})}catch(q){throw U&&U(),q&&q.name==="TypeError"&&/Load failed|fetch/i.test(q.message)?Object.assign(new Rt("Network Error",Rt.ERR_NETWORK,N,Q),{cause:q.cause||q}):Rt.from(q,q&&q.code,N,Q)}}},WZ=new Map,tL=t=>{let n=t?t.env:{};const{fetch:r,Request:s,Response:i}=n,o=[s,i,r];let l=o.length,c=l,d,u,h=WZ;for(;c--;)d=o[c],u=h.get(d),u===void 0&&h.set(d,u=c?new Map:HZ(n)),h=u;return u};tL();const Mj={http:lZ,xhr:BZ,fetch:{get:tL}};Ee.forEach(Mj,(t,n)=>{if(t){try{Object.defineProperty(t,"name",{value:n})}catch{}Object.defineProperty(t,"adapterName",{value:n})}});const j5=t=>`- ${t}`,qZ=t=>Ee.isFunction(t)||t===null||t===!1,nL={getAdapter:(t,n)=>{t=Ee.isArray(t)?t:[t];const{length:r}=t;let s,i;const o={};for(let l=0;l<r;l++){s=t[l];let c;if(i=s,!qZ(s)&&(i=Mj[(c=String(s)).toLowerCase()],i===void 0))throw new Rt(`Unknown adapter '${c}'`);if(i&&(Ee.isFunction(i)||(i=i.get(n))))break;o[c||"#"+l]=i}if(!i){const l=Object.entries(o).map(([d,u])=>`adapter ${d} `+(u===!1?"is not supported by the environment":"is not available in the build"));let c=r?l.length>1?`since :
`+l.map(j5).join(`
`):" "+j5(l[0]):"as no adapter specified";throw new Rt("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return i},adapters:Mj};function qw(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new gh(null,t)}function S5(t){return qw(t),t.headers=fa.from(t.headers),t.data=Ww.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),nL.getAdapter(t.adapter||dx.adapter,t)(t).then(function(s){return qw(t),s.data=Ww.call(t,t.transformResponse,s),s.headers=fa.from(s.headers),s},function(s){return Q6(s)||(qw(t),s&&s.response&&(s.response.data=Ww.call(t,t.transformResponse,s.response),s.response.headers=fa.from(s.response.headers))),Promise.reject(s)})}const rL="1.12.2",hv={};["object","boolean","number","function","string","symbol"].forEach((t,n)=>{hv[t]=function(s){return typeof s===t||"a"+(n<1?"n ":" ")+t}});const C5={};hv.transitional=function(n,r,s){function i(o,l){return"[Axios v"+rL+"] Transitional option '"+o+"'"+l+(s?". "+s:"")}return(o,l,c)=>{if(n===!1)throw new Rt(i(l," has been removed"+(r?" in "+r:"")),Rt.ERR_DEPRECATED);return r&&!C5[l]&&(C5[l]=!0,console.warn(i(l," has been deprecated since v"+r+" and will be removed in the near future"))),n?n(o,l,c):!0}};hv.spelling=function(n){return(r,s)=>(console.warn(`${s} is likely a misspelling of ${n}`),!0)};function GZ(t,n,r){if(typeof t!="object")throw new Rt("options must be an object",Rt.ERR_BAD_OPTION_VALUE);const s=Object.keys(t);let i=s.length;for(;i-- >0;){const o=s[i],l=n[o];if(l){const c=t[o],d=c===void 0||l(c,o,t);if(d!==!0)throw new Rt("option "+o+" must be "+d,Rt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Rt("Unknown option "+o,Rt.ERR_BAD_OPTION)}}const bg={assertOptions:GZ,validators:hv},ro=bg.validators;let Bd=class{constructor(n){this.defaults=n||{},this.interceptors={request:new h5,response:new h5}}async request(n,r){try{return await this._request(n,r)}catch(s){if(s instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const o=i.stack?i.stack.replace(/^.+\n/,""):"";try{s.stack?o&&!String(s.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+o):s.stack=o}catch{}}throw s}}_request(n,r){typeof n=="string"?(r=r||{},r.url=n):r=n||{},r=ru(this.defaults,r);const{transitional:s,paramsSerializer:i,headers:o}=r;s!==void 0&&bg.assertOptions(s,{silentJSONParsing:ro.transitional(ro.boolean),forcedJSONParsing:ro.transitional(ro.boolean),clarifyTimeoutError:ro.transitional(ro.boolean)},!1),i!=null&&(Ee.isFunction(i)?r.paramsSerializer={serialize:i}:bg.assertOptions(i,{encode:ro.function,serialize:ro.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),bg.assertOptions(r,{baseUrl:ro.spelling("baseURL"),withXsrfToken:ro.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let l=o&&Ee.merge(o.common,o[r.method]);o&&Ee.forEach(["delete","get","head","post","put","patch","common"],N=>{delete o[N]}),r.headers=fa.concat(l,o);const c=[];let d=!0;this.interceptors.request.forEach(function(j){typeof j.runWhen=="function"&&j.runWhen(r)===!1||(d=d&&j.synchronous,c.unshift(j.fulfilled,j.rejected))});const u=[];this.interceptors.response.forEach(function(j){u.push(j.fulfilled,j.rejected)});let h,m=0,g;if(!d){const N=[S5.bind(this),void 0];for(N.unshift(...c),N.push(...u),g=N.length,h=Promise.resolve(r);m<g;)h=h.then(N[m++],N[m++]);return h}g=c.length;let y=r;for(;m<g;){const N=c[m++],j=c[m++];try{y=N(y)}catch(S){j.call(this,S);break}}try{h=S5.call(this,y)}catch(N){return Promise.reject(N)}for(m=0,g=u.length;m<g;)h=h.then(u[m++],u[m++]);return h}getUri(n){n=ru(this.defaults,n);const r=J6(n.baseURL,n.url,n.allowAbsoluteUrls);return K6(r,n.params,n.paramsSerializer)}};Ee.forEach(["delete","get","head","options"],function(n){Bd.prototype[n]=function(r,s){return this.request(ru(s||{},{method:n,url:r,data:(s||{}).data}))}});Ee.forEach(["post","put","patch"],function(n){function r(s){return function(o,l,c){return this.request(ru(c||{},{method:n,headers:s?{"Content-Type":"multipart/form-data"}:{},url:o,data:l}))}}Bd.prototype[n]=r(),Bd.prototype[n+"Form"]=r(!0)});let KZ=class sL{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(o){r=o});const s=this;this.promise.then(i=>{if(!s._listeners)return;let o=s._listeners.length;for(;o-- >0;)s._listeners[o](i);s._listeners=null}),this.promise.then=i=>{let o;const l=new Promise(c=>{s.subscribe(c),o=c}).then(i);return l.cancel=function(){s.unsubscribe(o)},l},n(function(o,l,c){s.reason||(s.reason=new gh(o,l,c),r(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const r=this._listeners.indexOf(n);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const n=new AbortController,r=s=>{n.abort(s)};return this.subscribe(r),n.signal.unsubscribe=()=>this.unsubscribe(r),n.signal}static source(){let n;return{token:new sL(function(i){n=i}),cancel:n}}};function YZ(t){return function(r){return t.apply(null,r)}}function XZ(t){return Ee.isObject(t)&&t.isAxiosError===!0}const Oj={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Oj).forEach(([t,n])=>{Oj[n]=t});function aL(t){const n=new Bd(t),r=R6(Bd.prototype.request,n);return Ee.extend(r,Bd.prototype,n,{allOwnKeys:!0}),Ee.extend(r,n,null,{allOwnKeys:!0}),r.create=function(i){return aL(ru(t,i))},r}const gr=aL(dx);gr.Axios=Bd;gr.CanceledError=gh;gr.CancelToken=KZ;gr.isCancel=Q6;gr.VERSION=rL;gr.toFormData=fv;gr.AxiosError=Rt;gr.Cancel=gr.CanceledError;gr.all=function(n){return Promise.all(n)};gr.spread=YZ;gr.isAxiosError=XZ;gr.mergeConfig=ru;gr.AxiosHeaders=fa;gr.formToJSON=t=>X6(Ee.isHTMLForm(t)?new FormData(t):t);gr.getAdapter=nL.getAdapter;gr.HttpStatusCode=Oj;gr.default=gr;const{Axios:j8e,AxiosError:S8e,CanceledError:C8e,isCancel:_8e,CancelToken:A8e,VERSION:E8e,all:k8e,Cancel:T8e,isAxiosError:I8e,spread:P8e,toFormData:M8e,AxiosHeaders:O8e,HttpStatusCode:D8e,formToJSON:R8e,getAdapter:L8e,mergeConfig:B8e}=gr;function QZ(t){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",n.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}const ZZ=t=>{switch(t){case"success":return tJ;case"info":return rJ;case"warning":return nJ;case"error":return sJ;default:return null}},JZ=Array(12).fill(0),eJ=({visible:t,className:n})=>ze.createElement("div",{className:["sonner-loading-wrapper",n].filter(Boolean).join(" "),"data-visible":t},ze.createElement("div",{className:"sonner-spinner"},JZ.map((r,s)=>ze.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${s}`})))),tJ=ze.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ze.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),nJ=ze.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},ze.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),rJ=ze.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ze.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),sJ=ze.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ze.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),aJ=ze.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},ze.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),ze.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),iJ=()=>{const[t,n]=ze.useState(document.hidden);return ze.useEffect(()=>{const r=()=>{n(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),t};let Dj=1;class oJ{constructor(){this.subscribe=n=>(this.subscribers.push(n),()=>{const r=this.subscribers.indexOf(n);this.subscribers.splice(r,1)}),this.publish=n=>{this.subscribers.forEach(r=>r(n))},this.addToast=n=>{this.publish(n),this.toasts=[...this.toasts,n]},this.create=n=>{var r;const{message:s,...i}=n,o=typeof(n==null?void 0:n.id)=="number"||((r=n.id)==null?void 0:r.length)>0?n.id:Dj++,l=this.toasts.find(d=>d.id===o),c=n.dismissible===void 0?!0:n.dismissible;return this.dismissedToasts.has(o)&&this.dismissedToasts.delete(o),l?this.toasts=this.toasts.map(d=>d.id===o?(this.publish({...d,...n,id:o,title:s}),{...d,...n,id:o,dismissible:c,title:s}):d):this.addToast({title:s,...i,dismissible:c,id:o}),o},this.dismiss=n=>(n?(this.dismissedToasts.add(n),requestAnimationFrame(()=>this.subscribers.forEach(r=>r({id:n,dismiss:!0})))):this.toasts.forEach(r=>{this.subscribers.forEach(s=>s({id:r.id,dismiss:!0}))}),n),this.message=(n,r)=>this.create({...r,message:n}),this.error=(n,r)=>this.create({...r,message:n,type:"error"}),this.success=(n,r)=>this.create({...r,type:"success",message:n}),this.info=(n,r)=>this.create({...r,type:"info",message:n}),this.warning=(n,r)=>this.create({...r,type:"warning",message:n}),this.loading=(n,r)=>this.create({...r,type:"loading",message:n}),this.promise=(n,r)=>{if(!r)return;let s;r.loading!==void 0&&(s=this.create({...r,promise:n,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));const i=Promise.resolve(n instanceof Function?n():n);let o=s!==void 0,l;const c=i.then(async u=>{if(l=["resolve",u],ze.isValidElement(u))o=!1,this.create({id:s,type:"default",message:u});else if(cJ(u)&&!u.ok){o=!1;const m=typeof r.error=="function"?await r.error(`HTTP error! status: ${u.status}`):r.error,g=typeof r.description=="function"?await r.description(`HTTP error! status: ${u.status}`):r.description,N=typeof m=="object"&&!ze.isValidElement(m)?m:{message:m};this.create({id:s,type:"error",description:g,...N})}else if(u instanceof Error){o=!1;const m=typeof r.error=="function"?await r.error(u):r.error,g=typeof r.description=="function"?await r.description(u):r.description,N=typeof m=="object"&&!ze.isValidElement(m)?m:{message:m};this.create({id:s,type:"error",description:g,...N})}else if(r.success!==void 0){o=!1;const m=typeof r.success=="function"?await r.success(u):r.success,g=typeof r.description=="function"?await r.description(u):r.description,N=typeof m=="object"&&!ze.isValidElement(m)?m:{message:m};this.create({id:s,type:"success",description:g,...N})}}).catch(async u=>{if(l=["reject",u],r.error!==void 0){o=!1;const h=typeof r.error=="function"?await r.error(u):r.error,m=typeof r.description=="function"?await r.description(u):r.description,y=typeof h=="object"&&!ze.isValidElement(h)?h:{message:h};this.create({id:s,type:"error",description:m,...y})}}).finally(()=>{o&&(this.dismiss(s),s=void 0),r.finally==null||r.finally.call(r)}),d=()=>new Promise((u,h)=>c.then(()=>l[0]==="reject"?h(l[1]):u(l[1])).catch(h));return typeof s!="string"&&typeof s!="number"?{unwrap:d}:Object.assign(s,{unwrap:d})},this.custom=(n,r)=>{const s=(r==null?void 0:r.id)||Dj++;return this.create({jsx:n(s),id:s,...r}),s},this.getActiveToasts=()=>this.toasts.filter(n=>!this.dismissedToasts.has(n.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const ea=new oJ,lJ=(t,n)=>{const r=(n==null?void 0:n.id)||Dj++;return ea.addToast({title:t,...n,id:r}),r},cJ=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",dJ=lJ,uJ=()=>ea.toasts,fJ=()=>ea.getActiveToasts(),fe=Object.assign(dJ,{success:ea.success,info:ea.info,warning:ea.warning,error:ea.error,custom:ea.custom,message:ea.message,promise:ea.promise,dismiss:ea.dismiss,loading:ea.loading},{getHistory:uJ,getToasts:fJ});QZ("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function c0(t){return t.label!==void 0}const hJ=3,mJ="24px",pJ="16px",_5=4e3,xJ=356,gJ=14,yJ=45,vJ=200;function so(...t){return t.filter(Boolean).join(" ")}function bJ(t){const[n,r]=t.split("-"),s=[];return n&&s.push(n),r&&s.push(r),s}const wJ=t=>{var n,r,s,i,o,l,c,d,u;const{invert:h,toast:m,unstyled:g,interacting:y,setHeights:N,visibleToasts:j,heights:S,index:_,toasts:A,expanded:k,removeToast:T,defaultRichColors:P,closeButton:M,style:O,cancelButtonStyle:D,actionButtonStyle:L,className:$="",descriptionClassName:V="",duration:F,position:Q,gap:U,expandByDefault:z,classNames:q,icons:K,closeButtonAriaLabel:X="Close toast"}=t,[J,ne]=ze.useState(null),[Se,de]=ze.useState(null),[ye,be]=ze.useState(!1),[xe,_e]=ze.useState(!1),[we,Oe]=ze.useState(!1),[ae,ie]=ze.useState(!1),[pe,re]=ze.useState(!1),[We,Je]=ze.useState(0),[St,wt]=ze.useState(0),ft=ze.useRef(m.duration||F||_5),Ie=ze.useRef(null),qe=ze.useRef(null),se=_===0,le=_+1<=j,De=m.type,Nt=m.dismissible!==!1,sn=m.className||"",Yt=m.descriptionClassName||"",Pt=ze.useMemo(()=>S.findIndex(Ct=>Ct.toastId===m.id)||0,[S,m.id]),tr=ze.useMemo(()=>{var Ct;return(Ct=m.closeButton)!=null?Ct:M},[m.closeButton,M]),In=ze.useMemo(()=>m.duration||F||_5,[m.duration,F]),me=ze.useRef(0),tt=ze.useRef(0),Et=ze.useRef(0),Ft=ze.useRef(null),[en,Ue]=Q.split("-"),an=ze.useMemo(()=>S.reduce((Ct,ue,nt)=>nt>=Pt?Ct:Ct+ue.height,0),[S,Pt]),Kt=iJ(),Xt=m.invert||h,Cn=De==="loading";tt.current=ze.useMemo(()=>Pt*U+an,[Pt,an]),ze.useEffect(()=>{ft.current=In},[In]),ze.useEffect(()=>{be(!0)},[]),ze.useEffect(()=>{const Ct=qe.current;if(Ct){const ue=Ct.getBoundingClientRect().height;return wt(ue),N(nt=>[{toastId:m.id,height:ue,position:m.position},...nt]),()=>N(nt=>nt.filter(st=>st.toastId!==m.id))}},[N,m.id]),ze.useLayoutEffect(()=>{if(!ye)return;const Ct=qe.current,ue=Ct.style.height;Ct.style.height="auto";const nt=Ct.getBoundingClientRect().height;Ct.style.height=ue,wt(nt),N(st=>st.find(It=>It.toastId===m.id)?st.map(It=>It.toastId===m.id?{...It,height:nt}:It):[{toastId:m.id,height:nt,position:m.position},...st])},[ye,m.title,m.description,N,m.id,m.jsx,m.action,m.cancel]);const kr=ze.useCallback(()=>{_e(!0),Je(tt.current),N(Ct=>Ct.filter(ue=>ue.toastId!==m.id)),setTimeout(()=>{T(m)},vJ)},[m,T,N,tt]);ze.useEffect(()=>{if(m.promise&&De==="loading"||m.duration===1/0||m.type==="loading")return;let Ct;return k||y||Kt?(()=>{if(Et.current<me.current){const st=new Date().getTime()-me.current;ft.current=ft.current-st}Et.current=new Date().getTime()})():(()=>{ft.current!==1/0&&(me.current=new Date().getTime(),Ct=setTimeout(()=>{m.onAutoClose==null||m.onAutoClose.call(m,m),kr()},ft.current))})(),()=>clearTimeout(Ct)},[k,y,m,De,Kt,kr]),ze.useEffect(()=>{m.delete&&(kr(),m.onDismiss==null||m.onDismiss.call(m,m))},[kr,m.delete]);function zo(){var Ct;if(K!=null&&K.loading){var ue;return ze.createElement("div",{className:so(q==null?void 0:q.loader,m==null||(ue=m.classNames)==null?void 0:ue.loader,"sonner-loader"),"data-visible":De==="loading"},K.loading)}return ze.createElement(eJ,{className:so(q==null?void 0:q.loader,m==null||(Ct=m.classNames)==null?void 0:Ct.loader),visible:De==="loading"})}const Mt=m.icon||(K==null?void 0:K[De])||ZZ(De);var $t,Ha;return ze.createElement("li",{tabIndex:0,ref:qe,className:so($,sn,q==null?void 0:q.toast,m==null||(n=m.classNames)==null?void 0:n.toast,q==null?void 0:q.default,q==null?void 0:q[De],m==null||(r=m.classNames)==null?void 0:r[De]),"data-sonner-toast":"","data-rich-colors":($t=m.richColors)!=null?$t:P,"data-styled":!(m.jsx||m.unstyled||g),"data-mounted":ye,"data-promise":!!m.promise,"data-swiped":pe,"data-removed":xe,"data-visible":le,"data-y-position":en,"data-x-position":Ue,"data-index":_,"data-front":se,"data-swiping":we,"data-dismissible":Nt,"data-type":De,"data-invert":Xt,"data-swipe-out":ae,"data-swipe-direction":Se,"data-expanded":!!(k||z&&ye),"data-testid":m.testId,style:{"--index":_,"--toasts-before":_,"--z-index":A.length-_,"--offset":`${xe?We:tt.current}px`,"--initial-height":z?"auto":`${St}px`,...O,...m.style},onDragEnd:()=>{Oe(!1),ne(null),Ft.current=null},onPointerDown:Ct=>{Ct.button!==2&&(Cn||!Nt||(Ie.current=new Date,Je(tt.current),Ct.target.setPointerCapture(Ct.pointerId),Ct.target.tagName!=="BUTTON"&&(Oe(!0),Ft.current={x:Ct.clientX,y:Ct.clientY})))},onPointerUp:()=>{var Ct,ue,nt;if(ae||!Nt)return;Ft.current=null;const st=Number(((Ct=qe.current)==null?void 0:Ct.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),zt=Number(((ue=qe.current)==null?void 0:ue.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),It=new Date().getTime()-((nt=Ie.current)==null?void 0:nt.getTime()),Ot=J==="x"?st:zt,Wn=Math.abs(Ot)/It;if(Math.abs(Ot)>=yJ||Wn>.11){Je(tt.current),m.onDismiss==null||m.onDismiss.call(m,m),de(J==="x"?st>0?"right":"left":zt>0?"down":"up"),kr(),ie(!0);return}else{var mn,Tr;(mn=qe.current)==null||mn.style.setProperty("--swipe-amount-x","0px"),(Tr=qe.current)==null||Tr.style.setProperty("--swipe-amount-y","0px")}re(!1),Oe(!1),ne(null)},onPointerMove:Ct=>{var ue,nt,st;if(!Ft.current||!Nt||((ue=window.getSelection())==null?void 0:ue.toString().length)>0)return;const It=Ct.clientY-Ft.current.y,Ot=Ct.clientX-Ft.current.x;var Wn;const mn=(Wn=t.swipeDirections)!=null?Wn:bJ(Q);!J&&(Math.abs(Ot)>1||Math.abs(It)>1)&&ne(Math.abs(Ot)>Math.abs(It)?"x":"y");let Tr={x:0,y:0};const nr=Ir=>1/(1.5+Math.abs(Ir)/20);if(J==="y"){if(mn.includes("top")||mn.includes("bottom"))if(mn.includes("top")&&It<0||mn.includes("bottom")&&It>0)Tr.y=It;else{const Ir=It*nr(It);Tr.y=Math.abs(Ir)<Math.abs(It)?Ir:It}}else if(J==="x"&&(mn.includes("left")||mn.includes("right")))if(mn.includes("left")&&Ot<0||mn.includes("right")&&Ot>0)Tr.x=Ot;else{const Ir=Ot*nr(Ot);Tr.x=Math.abs(Ir)<Math.abs(Ot)?Ir:Ot}(Math.abs(Tr.x)>0||Math.abs(Tr.y)>0)&&re(!0),(nt=qe.current)==null||nt.style.setProperty("--swipe-amount-x",`${Tr.x}px`),(st=qe.current)==null||st.style.setProperty("--swipe-amount-y",`${Tr.y}px`)}},tr&&!m.jsx&&De!=="loading"?ze.createElement("button",{"aria-label":X,"data-disabled":Cn,"data-close-button":!0,onClick:Cn||!Nt?()=>{}:()=>{kr(),m.onDismiss==null||m.onDismiss.call(m,m)},className:so(q==null?void 0:q.closeButton,m==null||(s=m.classNames)==null?void 0:s.closeButton)},(Ha=K==null?void 0:K.close)!=null?Ha:aJ):null,(De||m.icon||m.promise)&&m.icon!==null&&((K==null?void 0:K[De])!==null||m.icon)?ze.createElement("div",{"data-icon":"",className:so(q==null?void 0:q.icon,m==null||(i=m.classNames)==null?void 0:i.icon)},m.promise||m.type==="loading"&&!m.icon?m.icon||zo():null,m.type!=="loading"?Mt:null):null,ze.createElement("div",{"data-content":"",className:so(q==null?void 0:q.content,m==null||(o=m.classNames)==null?void 0:o.content)},ze.createElement("div",{"data-title":"",className:so(q==null?void 0:q.title,m==null||(l=m.classNames)==null?void 0:l.title)},m.jsx?m.jsx:typeof m.title=="function"?m.title():m.title),m.description?ze.createElement("div",{"data-description":"",className:so(V,Yt,q==null?void 0:q.description,m==null||(c=m.classNames)==null?void 0:c.description)},typeof m.description=="function"?m.description():m.description):null),ze.isValidElement(m.cancel)?m.cancel:m.cancel&&c0(m.cancel)?ze.createElement("button",{"data-button":!0,"data-cancel":!0,style:m.cancelButtonStyle||D,onClick:Ct=>{c0(m.cancel)&&Nt&&(m.cancel.onClick==null||m.cancel.onClick.call(m.cancel,Ct),kr())},className:so(q==null?void 0:q.cancelButton,m==null||(d=m.classNames)==null?void 0:d.cancelButton)},m.cancel.label):null,ze.isValidElement(m.action)?m.action:m.action&&c0(m.action)?ze.createElement("button",{"data-button":!0,"data-action":!0,style:m.actionButtonStyle||L,onClick:Ct=>{c0(m.action)&&(m.action.onClick==null||m.action.onClick.call(m.action,Ct),!Ct.defaultPrevented&&kr())},className:so(q==null?void 0:q.actionButton,m==null||(u=m.classNames)==null?void 0:u.actionButton)},m.action.label):null)};function A5(){if(typeof window>"u"||typeof document>"u")return"ltr";const t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function NJ(t,n){const r={};return[t,n].forEach((s,i)=>{const o=i===1,l=o?"--mobile-offset":"--offset",c=o?pJ:mJ;function d(u){["top","right","bottom","left"].forEach(h=>{r[`${l}-${h}`]=typeof u=="number"?`${u}px`:u})}typeof s=="number"||typeof s=="string"?d(s):typeof s=="object"?["top","right","bottom","left"].forEach(u=>{s[u]===void 0?r[`${l}-${u}`]=c:r[`${l}-${u}`]=typeof s[u]=="number"?`${s[u]}px`:s[u]}):d(c)}),r}const jJ=ze.forwardRef(function(n,r){const{id:s,invert:i,position:o="bottom-right",hotkey:l=["altKey","KeyT"],expand:c,closeButton:d,className:u,offset:h,mobileOffset:m,theme:g="light",richColors:y,duration:N,style:j,visibleToasts:S=hJ,toastOptions:_,dir:A=A5(),gap:k=gJ,icons:T,containerAriaLabel:P="Notifications"}=n,[M,O]=ze.useState([]),D=ze.useMemo(()=>s?M.filter(ye=>ye.toasterId===s):M.filter(ye=>!ye.toasterId),[M,s]),L=ze.useMemo(()=>Array.from(new Set([o].concat(D.filter(ye=>ye.position).map(ye=>ye.position)))),[D,o]),[$,V]=ze.useState([]),[F,Q]=ze.useState(!1),[U,z]=ze.useState(!1),[q,K]=ze.useState(g!=="system"?g:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),X=ze.useRef(null),J=l.join("+").replace(/Key/g,"").replace(/Digit/g,""),ne=ze.useRef(null),Se=ze.useRef(!1),de=ze.useCallback(ye=>{O(be=>{var xe;return(xe=be.find(_e=>_e.id===ye.id))!=null&&xe.delete||ea.dismiss(ye.id),be.filter(({id:_e})=>_e!==ye.id)})},[]);return ze.useEffect(()=>ea.subscribe(ye=>{if(ye.dismiss){requestAnimationFrame(()=>{O(be=>be.map(xe=>xe.id===ye.id?{...xe,delete:!0}:xe))});return}setTimeout(()=>{N6.flushSync(()=>{O(be=>{const xe=be.findIndex(_e=>_e.id===ye.id);return xe!==-1?[...be.slice(0,xe),{...be[xe],...ye},...be.slice(xe+1)]:[ye,...be]})})})}),[M]),ze.useEffect(()=>{if(g!=="system"){K(g);return}if(g==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?K("dark"):K("light")),typeof window>"u")return;const ye=window.matchMedia("(prefers-color-scheme: dark)");try{ye.addEventListener("change",({matches:be})=>{K(be?"dark":"light")})}catch{ye.addListener(({matches:xe})=>{try{K(xe?"dark":"light")}catch(_e){console.error(_e)}})}},[g]),ze.useEffect(()=>{M.length<=1&&Q(!1)},[M]),ze.useEffect(()=>{const ye=be=>{var xe;if(l.every(Oe=>be[Oe]||be.code===Oe)){var we;Q(!0),(we=X.current)==null||we.focus()}be.code==="Escape"&&(document.activeElement===X.current||(xe=X.current)!=null&&xe.contains(document.activeElement))&&Q(!1)};return document.addEventListener("keydown",ye),()=>document.removeEventListener("keydown",ye)},[l]),ze.useEffect(()=>{if(X.current)return()=>{ne.current&&(ne.current.focus({preventScroll:!0}),ne.current=null,Se.current=!1)}},[X.current]),ze.createElement("section",{ref:r,"aria-label":`${P} ${J}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},L.map((ye,be)=>{var xe;const[_e,we]=ye.split("-");return D.length?ze.createElement("ol",{key:ye,dir:A==="auto"?A5():A,tabIndex:-1,ref:X,className:u,"data-sonner-toaster":!0,"data-sonner-theme":q,"data-y-position":_e,"data-x-position":we,style:{"--front-toast-height":`${((xe=$[0])==null?void 0:xe.height)||0}px`,"--width":`${xJ}px`,"--gap":`${k}px`,...j,...NJ(h,m)},onBlur:Oe=>{Se.current&&!Oe.currentTarget.contains(Oe.relatedTarget)&&(Se.current=!1,ne.current&&(ne.current.focus({preventScroll:!0}),ne.current=null))},onFocus:Oe=>{Oe.target instanceof HTMLElement&&Oe.target.dataset.dismissible==="false"||Se.current||(Se.current=!0,ne.current=Oe.relatedTarget)},onMouseEnter:()=>Q(!0),onMouseMove:()=>Q(!0),onMouseLeave:()=>{U||Q(!1)},onDragEnd:()=>Q(!1),onPointerDown:Oe=>{Oe.target instanceof HTMLElement&&Oe.target.dataset.dismissible==="false"||z(!0)},onPointerUp:()=>z(!1)},D.filter(Oe=>!Oe.position&&be===0||Oe.position===ye).map((Oe,ae)=>{var ie,pe;return ze.createElement(wJ,{key:Oe.id,icons:T,index:ae,toast:Oe,defaultRichColors:y,duration:(ie=_==null?void 0:_.duration)!=null?ie:N,className:_==null?void 0:_.className,descriptionClassName:_==null?void 0:_.descriptionClassName,invert:i,visibleToasts:S,closeButton:(pe=_==null?void 0:_.closeButton)!=null?pe:d,interacting:U,position:ye,style:_==null?void 0:_.style,unstyled:_==null?void 0:_.unstyled,classNames:_==null?void 0:_.classNames,cancelButtonStyle:_==null?void 0:_.cancelButtonStyle,actionButtonStyle:_==null?void 0:_.actionButtonStyle,closeButtonAriaLabel:_==null?void 0:_.closeButtonAriaLabel,removeToast:de,toasts:D.filter(re=>re.position==Oe.position),heights:$.filter(re=>re.position==Oe.position),setHeights:V,expandByDefault:c,gap:k,expanded:F,swipeDirections:n.swipeDirections})})):null}))}),$_="http://localhost:8000/api",te=gr.create({baseURL:$_,withCredentials:!0});te.interceptors.request.use(t=>{const n=localStorage.getItem("access_token"),r=localStorage.getItem("tenant_code");return n&&(t.headers=t.headers||{},t.headers.Authorization=`Bearer ${n}`),r&&(t.headers=t.headers||{},t.headers["X-Tenant-Code"]=r),t});async function SJ(t,n){var r,s,i,o,l,c;try{const d=localStorage.getItem("tenant_code")||null;let u=null;try{(r=t==null?void 0:t.config)!=null&&r.data&&(u=typeof t.config.data=="string"?JSON.parse(t.config.data):t.config.data)}catch{u={raw:(s=t==null?void 0:t.config)==null?void 0:s.data}}const h={message:n,page_url:window.location.href,request_url:((i=t==null?void 0:t.config)==null?void 0:i.url)||null,request_method:((o=t==null?void 0:t.config)==null?void 0:o.method)||null,http_status:((l=t==null?void 0:t.response)==null?void 0:l.status)||null,request_payload:u,response_payload:((c=t==null?void 0:t.response)==null?void 0:c.data)||null,stack_trace:(t==null?void 0:t.stack)||null,tenant_code:d,user_agent:navigator.userAgent,extra:{network:navigator.onLine?"online":"offline"}};await fetch(`${$_}/system/client-error`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h),keepalive:!0})}catch(d){console.error("Failed to report client error",d)}}let sm=null;async function iL(){if(sm)return sm;const t=localStorage.getItem("tenant_code")||null;return sm=(async()=>{try{const n=await fetch(`${$_}/auth/refresh`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...t?{"X-Tenant-Code":t}:{}}});if(!n.ok)throw new Error(`Refresh failed with status ${n.status}`);const r=await n.json();return r!=null&&r.access_token&&localStorage.setItem("access_token",r.access_token),(r==null?void 0:r.access_token)||null}finally{sm=null}})(),sm}te.interceptors.response.use(t=>t,async t=>{var l,c,d,u;const n=(l=t==null?void 0:t.response)==null?void 0:l.status,r=(c=t==null?void 0:t.response)==null?void 0:c.data,s=t.config||{};if(n===401&&!s._retry){s._retry=!0;try{const h=await iL();if(h)return s.headers=s.headers||{},s.headers.Authorization=`Bearer ${h}`,te(s)}catch(h){console.error("Refresh token flow failed",h)}localStorage.clear(),(u=(d=te.defaults.headers)==null?void 0:d.common)==null||delete u.Authorization}const i=r==null?void 0:r.detail;let o="Unexpected error";return Array.isArray(i)?o=i.map(h=>`${Array.isArray(h.loc)?h.loc.join("."):h.loc}: ${h.msg}`).join(`
`):typeof i=="string"?o=i:typeof(r==null?void 0:r.message)=="string"?o=r.message:t!=null&&t.message&&(o=t.message),console.error("API error:",n,r),fe.error(o),SJ(t,o),Promise.reject(t)});const CJ={},E5=t=>{let n;const r=new Set,s=(h,m)=>{const g=typeof h=="function"?h(n):h;if(!Object.is(g,n)){const y=n;n=m??(typeof g!="object"||g===null)?g:Object.assign({},n,g),r.forEach(N=>N(n,y))}},i=()=>n,d={setState:s,getState:i,getInitialState:()=>u,subscribe:h=>(r.add(h),()=>r.delete(h)),destroy:()=>{(CJ?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},u=n=t(s,i,d);return d},_J=t=>t?E5(t):E5;var oL={exports:{}},lL={},cL={exports:{}},dL={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hf=b;function AJ(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var EJ=typeof Object.is=="function"?Object.is:AJ,kJ=Hf.useState,TJ=Hf.useEffect,IJ=Hf.useLayoutEffect,PJ=Hf.useDebugValue;function MJ(t,n){var r=n(),s=kJ({inst:{value:r,getSnapshot:n}}),i=s[0].inst,o=s[1];return IJ(function(){i.value=r,i.getSnapshot=n,Gw(i)&&o({inst:i})},[t,r,n]),TJ(function(){return Gw(i)&&o({inst:i}),t(function(){Gw(i)&&o({inst:i})})},[t]),PJ(r),r}function Gw(t){var n=t.getSnapshot;t=t.value;try{var r=n();return!EJ(t,r)}catch{return!0}}function OJ(t,n){return n()}var DJ=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?OJ:MJ;dL.useSyncExternalStore=Hf.useSyncExternalStore!==void 0?Hf.useSyncExternalStore:DJ;cL.exports=dL;var RJ=cL.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mv=b,LJ=RJ;function BJ(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var FJ=typeof Object.is=="function"?Object.is:BJ,$J=LJ.useSyncExternalStore,zJ=mv.useRef,UJ=mv.useEffect,VJ=mv.useMemo,HJ=mv.useDebugValue;lL.useSyncExternalStoreWithSelector=function(t,n,r,s,i){var o=zJ(null);if(o.current===null){var l={hasValue:!1,value:null};o.current=l}else l=o.current;o=VJ(function(){function d(y){if(!u){if(u=!0,h=y,y=s(y),i!==void 0&&l.hasValue){var N=l.value;if(i(N,y))return m=N}return m=y}if(N=m,FJ(h,y))return N;var j=s(y);return i!==void 0&&i(N,j)?(h=y,N):(h=y,m=j)}var u=!1,h,m,g=r===void 0?null:r;return[function(){return d(n())},g===null?void 0:function(){return d(g())}]},[n,r,s,i]);var c=$J(t,o[0],o[1]);return UJ(function(){l.hasValue=!0,l.value=c},[c]),HJ(c),c};oL.exports=lL;var uL=oL.exports;const WJ=gi(uL),fL={},{useDebugValue:qJ}=ze,{useSyncExternalStoreWithSelector:GJ}=WJ;let k5=!1;const KJ=t=>t;function YJ(t,n=KJ,r){(fL?"production":void 0)!=="production"&&r&&!k5&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),k5=!0);const s=GJ(t.subscribe,t.getState,t.getServerState||t.getInitialState,n,r);return qJ(s),s}const T5=t=>{(fL?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const n=typeof t=="function"?_J(t):t,r=(s,i)=>YJ(n,s,i);return Object.assign(r,n),r},hL=t=>t?T5(t):T5,Cr=hL((t,n)=>({user:null,modules:{},loading:!1,tenantCode:localStorage.getItem("tenant_code")||"",setTenantCode:r=>{r?localStorage.setItem("tenant_code",r):localStorage.removeItem("tenant_code"),t({tenantCode:r})},registerAdmin:async r=>{var o;const s=await te.post("/auth/register-admin",r),i=(o=s==null?void 0:s.data)==null?void 0:o.tenant_code;return i&&(localStorage.setItem("tenant_code",i),t({tenantCode:i})),s},login:async({tenant_code:r,email:s,password:i})=>{const o={tenant_code:r==null?void 0:r.trim(),email:s,password:i},{data:l}=await te.post("/auth/login",o);return r&&(localStorage.setItem("tenant_code",r.trim()),t({tenantCode:r.trim()})),l},verifyOtp:async({tenant_code:r,email:s,otp:i})=>{const o={tenant_code:r==null?void 0:r.trim(),email:s,otp:i},{data:l}=await te.post("/auth/verify-otp",o);return localStorage.setItem("access_token",l.access_token),localStorage.setItem("refresh_token",l.refresh_token),te.defaults.headers.common.Authorization=`Bearer ${l.access_token}`,r&&(localStorage.setItem("tenant_code",r.trim()),t({tenantCode:r.trim()})),l},fetchProfile:async()=>{var r;try{t({loading:!0});const s=await te.get("/auth/me"),i=await te.get("/auth/me/permissions"),o=(r=s==null?void 0:s.data)==null?void 0:r.tenant_code;o&&localStorage.setItem("tenant_code",o),t({user:s.data,modules:i.data.modules||{},tenantCode:o||n().tenantCode})}finally{t({loading:!1})}},logout:()=>{localStorage.clear(),delete te.defaults.headers.common.Authorization,t({user:null,modules:{},tenantCode:""})}}));/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XJ=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),QJ=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,r,s)=>s?s.toUpperCase():r.toLowerCase()),I5=t=>{const n=QJ(t);return n.charAt(0).toUpperCase()+n.slice(1)},mL=(...t)=>t.filter((n,r,s)=>!!n&&n.trim()!==""&&s.indexOf(n)===r).join(" ").trim(),ZJ=t=>{for(const n in t)if(n.startsWith("aria-")||n==="role"||n==="title")return!0};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var JJ={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eee=b.forwardRef(({color:t="currentColor",size:n=24,strokeWidth:r=2,absoluteStrokeWidth:s,className:i="",children:o,iconNode:l,...c},d)=>b.createElement("svg",{ref:d,...JJ,width:n,height:n,stroke:t,strokeWidth:s?Number(r)*24/Number(n):r,className:mL("lucide",i),...!o&&!ZJ(c)&&{"aria-hidden":"true"},...c},[...l.map(([u,h])=>b.createElement(u,h)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=(t,n)=>{const r=b.forwardRef(({className:s,...i},o)=>b.createElement(eee,{ref:o,iconNode:n,className:mL(`lucide-${XJ(I5(t))}`,`lucide-${t}`,s),...i}));return r.displayName=I5(t),r};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tee=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],ha=He("activity",tee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nee=[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]],ree=He("arrow-left-right",nee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const see=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],pL=He("arrow-left",see);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aee=[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]],Fd=He("bed-double",aee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iee=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],oee=He("bell",iee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lee=[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]],cee=He("boxes",lee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dee=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],fl=He("building-2",dee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uee=[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]],g1=He("calendar-clock",uee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fee=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],sa=He("calendar-days",fee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hee=[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]],uf=He("calendar-range",hee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mee=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Rj=He("calendar",mee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pee=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],P5=He("camera",pee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xee=[["path",{d:"M14.564 14.558a3 3 0 1 1-4.122-4.121",key:"1rnrzw"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M20 20H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 .819-.175",key:"1x3arw"}],["path",{d:"M9.695 4.024A2 2 0 0 1 10.004 4h3.993a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v7.344",key:"1i84u0"}]],gee=He("camera-off",xee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yee=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Cm=He("chart-column",yee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vee=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],bee=He("chart-no-axes-column",vee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wee=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],pv=He("check",wee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nee=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],z_=He("chevron-down",Nee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jee=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],xL=He("chevron-left",jee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const See=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],gL=He("chevron-right",See);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cee=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],_ee=He("chevron-up",Cee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Bi=He("circle-alert",Aee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Fi=He("circle-check",Eee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],U_=He("circle-x",kee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tee=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],tl=He("clipboard-list",Tee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iee=[["path",{d:"M12 6v6h4",key:"135r8i"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Hc=He("clock-3",Iee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pee=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ci=He("clock",Pee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mee=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],am=He("cloud-upload",Mee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oee=[["circle",{cx:"12.1",cy:"12.1",r:"1",key:"18d7e5"}]],d0=He("dot",Oee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dee=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],$d=He("download",Dee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ree=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Lee=He("eye-off",Ree);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bee=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],zm=He("eye",Bee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fee=[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M3 15h6",key:"4e2qda"}],["path",{d:"M6 12v6",key:"1u72j0"}]],$ee=He("file-plus-2",Fee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zee=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],Uee=He("file-spreadsheet",zee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vee=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],y1=He("file-text",Vee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hee=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],Wf=He("flask-conical",Hee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wee=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Ec=He("funnel",Wee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qee=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}],["path",{d:"M3.22 13H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"auskq0"}]],Lj=He("heart-pulse",qee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gee=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Kee=He("history",Gee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yee=[["path",{d:"M12 7v4",key:"xawao1"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M14 9h-4",key:"1w2s2s"}],["path",{d:"M18 11h2a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-9a2 2 0 0 1 2-2h2",key:"1tthqt"}],["path",{d:"M18 21V5a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16",key:"dw4p4i"}]],Kw=He("hospital",Yee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xee=[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]],ho=He("indian-rupee",Xee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],yp=He("info",Qee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zee=[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]],Xo=He("key-round",Zee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jee=[["rect",{width:"18",height:"12",x:"3",y:"4",rx:"2",ry:"2",key:"1qhy41"}],["line",{x1:"2",x2:"22",y1:"20",y2:"20",key:"ni3hll"}]],ete=He("laptop-minimal",Jee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tte=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],u0=He("layout-dashboard",tte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nte=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],rte=He("layers",nte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ste=[["rect",{width:"18",height:"7",x:"3",y:"3",rx:"1",key:"f1a2em"}],["rect",{width:"9",height:"7",x:"3",y:"14",rx:"1",key:"jqznyg"}],["rect",{width:"5",height:"7",x:"16",y:"14",rx:"1",key:"q5h2i8"}]],ate=He("layout-template",ste);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ite=[["path",{d:"M13 5h8",key:"a7qcls"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 19h8",key:"c3s6r1"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}]],ote=He("list-checks",ite);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lte=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],dr=He("loader-circle",lte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cte=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],dte=He("log-out",cte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ute=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],fte=He("lock",ute);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hte=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],vp=He("mail",hte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mte=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],yL=He("map-pin",mte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pte=[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"pqwjuv"}]],M5=He("notebook-pen",pte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xte=[["path",{d:"M12 22v-9",key:"x3hkom"}],["path",{d:"M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z",key:"2ntwy6"}],["path",{d:"M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13",key:"1pmm1c"}],["path",{d:"M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z",key:"12ttoo"}]],gte=He("package-open",xte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yte=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],vL=He("package",yte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vte=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],bL=He("paperclip",vte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bte=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Co=He("pencil",bte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wte=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],gs=He("pill",wte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nte=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],jte=He("play",Nte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ste=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],or=He("plus",Ste);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cte=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Bj=He("printer",Cte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _te=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]],Yw=He("qr-code",_te);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ate=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M8 7h8",key:"i86dvs"}],["path",{d:"M12 17.5 8 15h1a4 4 0 0 0 0-8",key:"grpkl4"}],["path",{d:"M8 11h8",key:"vwpz6n"}]],Xw=He("receipt-indian-rupee",Ate);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ete=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]],v1=He("receipt",Ete);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kte=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],qf=He("refresh-ccw",kte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tte=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],wL=He("refresh-cw",Tte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ite=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],bc=He("rotate-ccw",Ite);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pte=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M8 7v10",key:"23sfjj"}],["path",{d:"M12 7v10",key:"jspqdw"}],["path",{d:"M17 7v10",key:"578dap"}]],O5=He("scan-barcode",Pte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mte=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]],b1=He("scan-line",Mte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ote=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]],wg=He("scan",Ote);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dte=[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]],Fj=He("scissors",Dte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rte=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ur=He("search",Rte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lte=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Bte=He("settings",Lte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fte=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],$te=He("shield-alert",Fte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zte=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],_o=He("shield-check",zte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ute=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9 12h6",key:"1c52cq"}],["path",{d:"M12 9v6",key:"199k2o"}]],Vte=He("shield-plus",Ute);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hte=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],w1=He("shopping-cart",Hte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wte=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],kn=He("stethoscope",Wte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qte=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],f0=He("tag",qte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gte=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],Kte=He("thermometer",Gte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yte=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],_l=He("trash-2",Yte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xte=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Qte=He("trending-up",Xte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zte=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],wc=He("triangle-alert",Zte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jte=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],ene=He("truck",Jte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tne=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],N1=He("upload",tne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nne=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],rne=He("user-plus",nne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sne=[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]],bp=He("user-round",sne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ane=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],wp=He("users",ane);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ine=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],hi=He("user",ine);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const one=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],La=He("x",one);function lne(){var y,N;const t=yi(),n=Hi(),r=Cr(j=>j.login),[s,i]=b.useState({tenant_code:((y=t.state)==null?void 0:y.tenant_code)||localStorage.getItem("tenant_code")||localStorage.getItem("pending_tenant_code")||"",email:((N=t.state)==null?void 0:N.email)||localStorage.getItem("pending_email")||"",password:""}),[o,l]=b.useState(""),[c,d]=b.useState(!1),[u,h]=b.useState(!1),m=b.useMemo(()=>s.tenant_code.trim()&&s.email.trim()&&s.password.trim()&&!c,[s,c]),g=async j=>{var S,_;if(j.preventDefault(),!!m){l(""),d(!0);try{await r({tenant_code:s.tenant_code.trim(),email:s.email.trim(),password:s.password}),localStorage.setItem("pending_email",s.email.trim()),localStorage.setItem("pending_tenant_code",s.tenant_code.trim()),n("/auth/verify",{state:{email:s.email.trim(),tenant_code:s.tenant_code.trim()}})}catch(A){l(((_=(S=A==null?void 0:A.response)==null?void 0:S.data)==null?void 0:_.detail)||"Invalid credentials")}finally{d(!1)}}};return a.jsxs("div",{className:"relative min-h-screen overflow-hidden bg-gradient-to-b from-gray-50 to-white",children:[a.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[a.jsx("div",{className:"absolute -left-24 -top-24 h-64 w-64 rounded-full bg-blue-100 blur-3xl animate-pulse"}),a.jsx("div",{className:"absolute -right-24 -bottom-24 h-72 w-72 rounded-full bg-indigo-100 blur-3xl animate-pulse"})]}),a.jsx("div",{className:"relative z-10 grid min-h-screen place-items-center px-4 py-10",children:a.jsxs("div",{className:"w-full max-w-md",children:[a.jsxs("div",{className:"relative overflow-hidden rounded-2xl border border-gray-100 bg-white/80 p-6 shadow-sm backdrop-blur",children:[a.jsx("div",{className:"pointer-events-none absolute -right-12 -top-12 h-32 w-32 rotate-45 bg-gradient-to-br from-blue-50 to-indigo-50"}),a.jsxs("div",{className:"mb-6 flex items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-blue-600 text-white ring-8 ring-blue-50",children:a.jsx("span",{className:"text-sm font-bold tracking-tight",children:"NDH"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-semibold tracking-tight",children:"NUTRYAH's HIMS & EMR"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Multi-tenant login with Hospital Code + Email + OTP"})]})]}),a.jsx(_o,{className:"h-6 w-6 text-emerald-600"})]}),a.jsxs("form",{onSubmit:g,className:"space-y-4","aria-busy":c,children:[a.jsxs("label",{className:"block",children:[a.jsx("span",{className:"mb-1 block text-sm text-gray-600",children:"Hospital Code"}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-gray-200 bg-white px-3 py-2 focus-within:ring-2 focus-within:ring-blue-200",children:[a.jsx(fl,{className:"h-4 w-4 text-gray-400"}),a.jsx("input",{className:"w-full bg-transparent outline-none placeholder:text-gray-400 uppercase",placeholder:"KGH001",value:s.tenant_code,onChange:j=>i(S=>({...S,tenant_code:j.target.value.toUpperCase()})),required:!0,disabled:c})]}),a.jsx("p",{className:"mt-1 text-[11px] text-gray-500",children:"Hospital / Clinic code assigned by NUTRYAH (Tenant Code)."})]}),a.jsxs("label",{className:"block",children:[a.jsx("span",{className:"mb-1 block text-sm text-gray-600",children:"Email"}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-gray-200 bg-white px-3 py-2 focus-within:ring-2 focus-within:ring-blue-200",children:[a.jsx(vp,{className:"h-4 w-4 text-gray-400"}),a.jsx("input",{className:"w-full bg-transparent outline-none placeholder:text-gray-400",placeholder:"you@hospital.org",type:"email",autoComplete:"email",value:s.email,onChange:j=>i(S=>({...S,email:j.target.value})),required:!0,disabled:c})]})]}),a.jsxs("label",{className:"block",children:[a.jsx("span",{className:"mb-1 block text-sm text-gray-600",children:"Password"}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-gray-200 bg-white px-3 py-2 focus-within:ring-2 focus-within:ring-blue-200",children:[a.jsx(fte,{className:"h-4 w-4 text-gray-400"}),a.jsx("input",{className:"w-full bg-transparent outline-none placeholder:text-gray-400",placeholder:"",type:u?"text":"password",autoComplete:"current-password",value:s.password,onChange:j=>i(S=>({...S,password:j.target.value})),required:!0,disabled:c}),a.jsx("button",{type:"button",onClick:()=>h(j=>!j),className:"rounded-lg p-1.5 text-gray-500 hover:bg-gray-50","aria-label":u?"Hide password":"Show password",tabIndex:-1,disabled:c,children:u?a.jsx(Lee,{className:"h-4 w-4"}):a.jsx(zm,{className:"h-4 w-4"})})]})]}),a.jsx("button",{className:"inline-flex w-full items-center justify-center gap-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 px-4 py-2.5 text-white shadow-sm transition active:scale-[0.99] disabled:cursor-not-allowed disabled:opacity-60",disabled:!m,type:"submit",children:c?a.jsxs(a.Fragment,{children:[a.jsx(dr,{className:"h-5 w-5 animate-spin"}),a.jsx("span",{children:"Sending OTP"})]}):a.jsx(a.Fragment,{children:"Send OTP"})}),o&&a.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:o}),a.jsx("p",{className:"text-center text-xs text-gray-500",children:"Tip: You'll receive a 6-digit OTP in your email. Keep this tab open."})]}),c&&a.jsx("div",{className:"absolute inset-0 grid place-items-center rounded-2xl bg-white/70 backdrop-blur-sm",children:a.jsxs("div",{className:"w-full max-w-xs rounded-xl border border-gray-100 bg-white p-4 shadow-md",children:[a.jsxs("div",{className:"mb-2 flex items-center gap-2 text-sm text-gray-700",children:[a.jsx(dr,{className:"h-4 w-4 animate-spin text-blue-600"}),"Sending OTP"]}),a.jsx("div",{className:"relative h-2 overflow-hidden rounded-full bg-gray-100",children:a.jsx("div",{className:"absolute inset-y-0 left-0 w-1/3 animate-[progress_1.2s_infinite] rounded-full bg-gradient-to-r from-blue-500 to-indigo-500"})}),a.jsxs("div",{className:"mt-3 flex items-center justify-center gap-1",children:[a.jsx("span",{className:"h-2 w-2 animate-bounce rounded-full bg-blue-500 [animation-delay:-0.2s]"}),a.jsx("span",{className:"h-2 w-2 animate-bounce rounded-full bg-blue-500 [animation-delay:-0.1s]"}),a.jsx("span",{className:"h-2 w-2 animate-bounce rounded-full bg-blue-500"})]})]})})]}),a.jsxs("div",{className:"mx-auto mt-6 text-center text-xs text-gray-500",children:[" ",new Date().getFullYear()," NUTRYAH  Multi-tenant Secure Access"]})]})}),a.jsx("style",{children:`
        @keyframes progress {
          0% { transform: translateX(-120%); }
          100% { transform: translateX(300%); }
        }
      `})]})}function cne(){const[t,n]=b.useState({tenant_name:"",tenant_code:"",hospital_address:"",contact_person:"",contact_phone:"",subscription_plan:"standard",admin_name:"",email:"",password:"",confirm_password:""}),[r,s]=b.useState(!1),[i,o]=b.useState(""),l=Cr(h=>h.registerAdmin),c=Hi(),d=h=>m=>n(g=>({...g,[h]:m.target.value})),u=async h=>{var m,g;if(h.preventDefault(),!r){if(o(""),t.password!==t.confirm_password){o("Passwords do not match");return}s(!0);try{const y=await l(t),{tenant_code:N}=y.data||{};alert(`Hospital onboarded successfully.
Tenant Code: ${N||t.tenant_code||"Generated"}

Please login with Hospital Code + Admin email.`),c("/auth/login",{replace:!0,state:{email:t.email,tenant_code:N||t.tenant_code}})}catch(y){o(((g=(m=y==null?void 0:y.response)==null?void 0:m.data)==null?void 0:g.detail)||"Failed to register tenant admin")}finally{s(!1)}}};return a.jsxs("div",{className:"relative min-h-screen overflow-hidden bg-gradient-to-b from-slate-50 to-white",children:[a.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[a.jsx("div",{className:"absolute -left-24 -top-24 h-64 w-64 rounded-full bg-blue-100 blur-3xl"}),a.jsx("div",{className:"absolute -right-24 -bottom-24 h-72 w-72 rounded-full bg-indigo-100 blur-3xl"})]}),a.jsx("div",{className:"relative z-10 grid min-h-screen place-items-center px-4 py-8",children:a.jsxs("div",{className:"w-full max-w-2xl",children:[a.jsxs("div",{className:"mb-6 flex items-center justify-center gap-3",children:[a.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-blue-600 text-white ring-8 ring-blue-50",children:a.jsx("span",{className:"text-sm font-bold tracking-tight",children:"NDH"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-semibold tracking-tight",children:"Onboard a New Hospital / Clinic"}),a.jsx("p",{className:"text-xs text-slate-500",children:"This will create a dedicated NABH HIMS & EMR tenant with its own database."})]})]}),a.jsxs("form",{onSubmit:u,className:"space-y-5 rounded-2xl border border-slate-200 bg-white/80 p-6 shadow-sm backdrop-blur",children:[a.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"mb-1 block text-sm text-slate-700",children:"Hospital / Clinic Name"}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 focus-within:ring-2 focus-within:ring-blue-200",children:[a.jsx(fl,{className:"h-4 w-4 text-slate-400"}),a.jsx("input",{className:"w-full bg-transparent outline-none placeholder:text-slate-400",placeholder:"Kovai Multispeciality Hospital",value:t.tenant_name,onChange:d("tenant_name"),required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm text-slate-700",children:"Hospital Code (Tenant Code)"}),a.jsx("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none placeholder:text-slate-400 focus:ring-2 focus:ring-blue-200",placeholder:"KGH001",value:t.tenant_code,onChange:h=>n(m=>({...m,tenant_code:h.target.value.toUpperCase()}))}),a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Optional. If empty, the system will generate a code from the name."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm text-slate-700",children:"Contact Person"}),a.jsx("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none placeholder:text-slate-400 focus:ring-2 focus:ring-blue-200",placeholder:"Dr. Admin / IT Head",value:t.contact_person,onChange:d("contact_person"),required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm text-slate-700",children:"Contact Phone"}),a.jsx("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none placeholder:text-slate-400 focus:ring-2 focus:ring-blue-200",placeholder:"+91 9XXXXXXXXX",value:t.contact_phone,onChange:d("contact_phone")})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"mb-1 block text-sm text-slate-700",children:"Hospital Address"}),a.jsx("textarea",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none placeholder:text-slate-400 focus:ring-2 focus:ring-blue-200",placeholder:"Address, City, State, Pincode",rows:2,value:t.hospital_address,onChange:d("hospital_address")})]})]}),a.jsxs("div",{className:"space-y-3 rounded-2xl border border-slate-100 bg-slate-50/70 p-4",children:[a.jsxs("div",{className:"mb-1 flex items-center gap-2 text-sm font-medium text-slate-800",children:[a.jsx(yp,{className:"h-4 w-4 text-blue-600"}),"Subscription & License Period"]}),a.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm text-slate-700",children:"Subscription Plan"}),a.jsxs("select",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-blue-200",value:t.subscription_plan,onChange:d("subscription_plan"),children:[a.jsx("option",{value:"basic",children:"Basic (Monthly)"}),a.jsx("option",{value:"standard",children:"Standard (6 Months)"}),a.jsx("option",{value:"premium",children:"Premium (1 Year)"})]})]}),a.jsxs("div",{className:"text-xs text-slate-600 space-y-1",children:[a.jsx("p",{className:"font-medium text-slate-700",children:"License Duration (auto-calculated):"}),a.jsxs("ul",{className:"list-disc pl-4 space-y-0.5",children:[a.jsx("li",{children:"Basic  30 days from registration"}),a.jsx("li",{children:"Standard  6 months from registration"}),a.jsx("li",{children:"Premium  1 year from registration"})]}),a.jsx("p",{className:"pt-1 text-[11px] text-slate-500",children:"AMC, subscription amount, and renewals are configured by NUTRYAH admin in the master console. They are not editable from this screen."})]})]})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-slate-50/80 p-4",children:[a.jsxs("div",{className:"mb-3 flex items-center gap-2 text-sm font-medium text-slate-800",children:[a.jsx(Vte,{className:"h-4 w-4 text-blue-600"}),"Admin Login for this Tenant"]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs text-slate-600",children:"Admin Name"}),a.jsx("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none placeholder:text-slate-400 focus:ring-2 focus:ring-blue-200",placeholder:"Super Admin",value:t.admin_name,onChange:d("admin_name"),required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs text-slate-600",children:"Admin Email"}),a.jsx("input",{type:"email",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none placeholder:text-slate-400 focus:ring-2 focus:ring-blue-200",placeholder:"admin@hospital.org",value:t.email,onChange:d("email"),required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs text-slate-600",children:"Password"}),a.jsx("input",{type:"password",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-blue-200",value:t.password,onChange:d("password"),required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs text-slate-600",children:"Confirm Password"}),a.jsx("input",{type:"password",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-blue-200",value:t.confirm_password,onChange:d("confirm_password"),required:!0})]})]})]}),i&&a.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:i}),a.jsx("button",{type:"submit",disabled:r,className:"inline-flex w-full items-center justify-center gap-2 rounded-xl bg-slate-900 px-4 py-2.5 text-sm font-medium text-white shadow-sm transition active:scale-[0.99] disabled:cursor-not-allowed disabled:opacity-60",children:r?a.jsxs(a.Fragment,{children:[a.jsx(dr,{className:"h-4 w-4 animate-spin"}),"Creating Tenant"]}):"Create Tenant & Admin"}),a.jsx("p",{className:"text-center text-[11px] text-slate-500",children:"After this step, use the Hospital Code + Admin Email to login and access the dedicated HIMS database."})]})]})})]})}function dne(){var L,$;const t=yi(),n=Hi(),r=Cr(V=>V.verifyOtp),s=Cr(V=>V.fetchProfile),[i]=b.useState(((L=t.state)==null?void 0:L.email)||localStorage.getItem("pending_email")||""),[o]=b.useState((($=t.state)==null?void 0:$.tenant_code)||localStorage.getItem("pending_tenant_code")||localStorage.getItem("tenant_code")||""),[l,c]=b.useState(["","","","","",""]),[d,u]=b.useState(""),[h,m]=b.useState(!1),[g,y]=b.useState(60),[N,j]=b.useState(!1),S=b.useRef([]);b.useEffect(()=>{(!i||!o)&&n("/auth/login",{replace:!0})},[i,o,n]),b.useEffect(()=>{if(g<=0)return;const V=setInterval(()=>y(F=>F-1),1e3);return()=>clearInterval(V)},[g]);const _=b.useMemo(()=>l.join(""),[l]),A=_.length===6&&!l.includes("")&&!h,k=(V,F)=>{var U;const Q=(F||"").replace(/\D/g,"").slice(-1);c(z=>{const q=[...z];return q[V]=Q,q}),Q&&V<5&&((U=S.current[V+1])==null||U.focus())},T=(V,F)=>{var Q,U,z;F.key==="Backspace"?l[V]?c(q=>{const K=[...q];return K[V]="",K}):V>0&&((Q=S.current[V-1])==null||Q.focus(),c(q=>{const K=[...q];return K[V-1]="",K})):F.key==="ArrowLeft"&&V>0?(U=S.current[V-1])==null||U.focus():F.key==="ArrowRight"&&V<5&&((z=S.current[V+1])==null||z.focus())},P=V=>{var U;V.preventDefault();const F=(V.clipboardData.getData("text")||"").replace(/\D/g,"").slice(0,6);if(!F)return;const Q=F.split("");c([Q[0]||"",Q[1]||"",Q[2]||"",Q[3]||"",Q[4]||"",Q[5]||""]),(U=S.current[Math.min(F.length,5)])==null||U.focus()},M=async V=>{var F,Q;if(V.preventDefault(),!!A){u(""),m(!0);try{await r({tenant_code:o,email:i,otp:_}),await s(),j(!0),setTimeout(()=>{const U=Cr.getState().user;U!=null&&U.is_admin?n("/admin",{replace:!0}):n("/dashboard",{replace:!0})},400)}catch(U){u(((Q=(F=U==null?void 0:U.response)==null?void 0:F.data)==null?void 0:Q.detail)||"Invalid or expired OTP")}finally{m(!1)}}},O=()=>{n("/auth/login",{state:{email:i,tenant_code:o},replace:!0})},D=()=>{O()};return a.jsxs("div",{className:"relative min-h-screen overflow-hidden bg-gradient-to-b from-gray-50 to-white",children:[a.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[a.jsx("div",{className:"absolute -left-24 -top-24 h-64 w-64 rounded-full bg-blue-100 blur-3xl animate-pulse"}),a.jsx("div",{className:"absolute -right-24 -bottom-24 h-72 w-72 rounded-full bg-indigo-100 blur-3xl animate-pulse"})]}),a.jsx("div",{className:"relative z-10 grid min-h-screen place-items-center px-4 py-8",children:a.jsxs("div",{className:"w-full max-w-md",children:[a.jsxs("div",{className:"relative overflow-hidden rounded-2xl border border-gray-100 bg-white/80 p-6 shadow-sm backdrop-blur",children:[a.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-blue-600 text-white ring-8 ring-blue-50",children:a.jsx("span",{className:"text-sm font-bold",children:"NDH"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-semibold tracking-tight",children:"Verify OTP"}),a.jsx("p",{className:"text-xs text-gray-500",children:"We sent a 6-digit code to your email"})]})]}),a.jsx(_o,{className:"h-6 w-6 text-emerald-600"})]}),a.jsxs("div",{className:"mb-4 space-y-2 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-gray-100 bg-gray-50 px-3 py-2 text-gray-700",children:[a.jsx(vp,{className:"h-4 w-4 text-gray-400"}),a.jsx("span",{className:"truncate",children:i}),a.jsx("button",{type:"button",onClick:O,className:"ml-auto text-xs text-blue-700 underline-offset-2 hover:underline",children:"Change"})]}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-gray-100 bg-gray-50 px-3 py-2 text-gray-700",children:[a.jsx(fl,{className:"h-4 w-4 text-gray-400"}),a.jsxs("span",{className:"text-xs font-medium uppercase",children:["Hospital Code: ",o]})]})]}),a.jsxs("form",{onSubmit:M,className:"space-y-4",children:[a.jsx("div",{className:"grid grid-cols-6 gap-2 sm:gap-3",onPaste:P,children:l.map((V,F)=>a.jsx("input",{ref:Q=>S.current[F]=Q,value:V,inputMode:"numeric",pattern:"[0-9]*",maxLength:1,autoFocus:F===0,onChange:Q=>k(F,Q.target.value),onKeyDown:Q=>T(F,Q),className:`h-12 rounded-xl border border-gray-200 text-center text-lg tracking-[0.2em] outline-none transition\r
                               focus:border-blue-400 focus:ring-2 focus:ring-blue-200 sm:h-14`,"aria-label":`OTP digit ${F+1}`},F))}),a.jsx("button",{className:"inline-flex w-full items-center justify-center gap-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 px-4 py-2.5 text-white shadow-sm transition active:scale-[0.99] disabled:cursor-not-allowed disabled:opacity-60",disabled:!A,type:"submit",children:h?a.jsxs(a.Fragment,{children:[a.jsx(dr,{className:"h-5 w-5 animate-spin"}),"Verifying"]}):N?a.jsxs(a.Fragment,{children:[a.jsx(Fi,{className:"h-5 w-5"}),"Verified"]}):"Verify & Continue"}),a.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600",children:[a.jsxs("button",{type:"button",onClick:O,className:"inline-flex items-center gap-1 rounded-lg px-2 py-1 hover:bg-gray-50",children:[a.jsx(pL,{className:"h-3.5 w-3.5"}),"Back to login"]}),a.jsx("div",{className:"flex items-center gap-2",children:g>0?a.jsxs("span",{className:"rounded-lg bg-gray-50 px-2 py-1 tabular-nums",children:["Resend in ",g,"s"]}):a.jsx("button",{type:"button",onClick:D,className:"rounded-lg bg-gray-900 px-2 py-1 text-white hover:bg-gray-800",children:"Resend OTP"})})]}),d&&a.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",role:"alert","aria-live":"polite",children:d})]}),h&&a.jsx("div",{className:"absolute inset-0 grid place-items-center rounded-2xl bg-white/70 backdrop-blur-sm",children:a.jsxs("div",{className:"w-full max-w-xs rounded-xl border border-gray-100 bg-white p-4 shadow-md",children:[a.jsxs("div",{className:"mb-2 flex items-center gap-2 text-sm text-gray-700",children:[a.jsx(dr,{className:"h-4 w-4 animate-spin text-blue-600"}),"Verifying"]}),a.jsx("div",{className:"relative h-2 overflow-hidden rounded-full bg-gray-100",children:a.jsx("div",{className:"absolute inset-y-0 left-0 w-1/3 animate-[progress_1.1s_infinite_linear] rounded-full bg-gradient-to-r from-blue-500 to-indigo-500"})})]})})]}),a.jsx("div",{className:"mx-auto mt-6 text-center text-xs text-gray-500",children:"Didnt receive the mail? Check Spam/Junk folder."})]})}),a.jsx("style",{children:`
        @keyframes progress {
          0% { transform: translateX(-120%); }
          100% { transform: translateX(300%); }
        }
      `})]})}const V_=b.createContext({});function H_(t){const n=b.useRef(null);return n.current===null&&(n.current=t()),n.current}const W_=typeof window<"u",NL=W_?b.useLayoutEffect:b.useEffect,xv=b.createContext(null);function q_(t,n){t.indexOf(n)===-1&&t.push(n)}function G_(t,n){const r=t.indexOf(n);r>-1&&t.splice(r,1)}const hl=(t,n,r)=>r>n?n:r<t?t:r;let K_=()=>{};const ml={},jL=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function SL(t){return typeof t=="object"&&t!==null}const CL=t=>/^0[^.\s]+$/u.test(t);function Y_(t){let n;return()=>(n===void 0&&(n=t()),n)}const di=t=>t,une=(t,n)=>r=>n(t(r)),ux=(...t)=>t.reduce(une),Np=(t,n,r)=>{const s=n-t;return s===0?1:(r-t)/s};class X_{constructor(){this.subscriptions=[]}add(n){return q_(this.subscriptions,n),()=>G_(this.subscriptions,n)}notify(n,r,s){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](n,r,s);else for(let o=0;o<i;o++){const l=this.subscriptions[o];l&&l(n,r,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const vo=t=>t*1e3,ii=t=>t/1e3;function _L(t,n){return n?t*(1e3/n):0}const AL=(t,n,r)=>(((1-3*r+3*n)*t+(3*r-6*n))*t+3*n)*t,fne=1e-7,hne=12;function mne(t,n,r,s,i){let o,l,c=0;do l=n+(r-n)/2,o=AL(l,s,i)-t,o>0?r=l:n=l;while(Math.abs(o)>fne&&++c<hne);return l}function fx(t,n,r,s){if(t===n&&r===s)return di;const i=o=>mne(o,0,1,t,r);return o=>o===0||o===1?o:AL(i(o),n,s)}const EL=t=>n=>n<=.5?t(2*n)/2:(2-t(2*(1-n)))/2,kL=t=>n=>1-t(1-n),TL=fx(.33,1.53,.69,.99),Q_=kL(TL),IL=EL(Q_),PL=t=>(t*=2)<1?.5*Q_(t):.5*(2-Math.pow(2,-10*(t-1))),Z_=t=>1-Math.sin(Math.acos(t)),ML=kL(Z_),OL=EL(Z_),pne=fx(.42,0,1,1),xne=fx(0,0,.58,1),DL=fx(.42,0,.58,1),gne=t=>Array.isArray(t)&&typeof t[0]!="number",RL=t=>Array.isArray(t)&&typeof t[0]=="number",yne={linear:di,easeIn:pne,easeInOut:DL,easeOut:xne,circIn:Z_,circInOut:OL,circOut:ML,backIn:Q_,backInOut:IL,backOut:TL,anticipate:PL},vne=t=>typeof t=="string",D5=t=>{if(RL(t)){K_(t.length===4);const[n,r,s,i]=t;return fx(n,r,s,i)}else if(vne(t))return yne[t];return t},h0=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function bne(t,n){let r=new Set,s=new Set,i=!1,o=!1;const l=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1};function d(h){l.has(h)&&(u.schedule(h),t()),h(c)}const u={schedule:(h,m=!1,g=!1)=>{const N=g&&i?r:s;return m&&l.add(h),N.has(h)||N.add(h),h},cancel:h=>{s.delete(h),l.delete(h)},process:h=>{if(c=h,i){o=!0;return}i=!0,[r,s]=[s,r],r.forEach(d),r.clear(),i=!1,o&&(o=!1,u.process(h))}};return u}const wne=40;function LL(t,n){let r=!1,s=!0;const i={delta:0,timestamp:0,isProcessing:!1},o=()=>r=!0,l=h0.reduce((k,T)=>(k[T]=bne(o),k),{}),{setup:c,read:d,resolveKeyframes:u,preUpdate:h,update:m,preRender:g,render:y,postRender:N}=l,j=()=>{const k=ml.useManualTiming?i.timestamp:performance.now();r=!1,ml.useManualTiming||(i.delta=s?1e3/60:Math.max(Math.min(k-i.timestamp,wne),1)),i.timestamp=k,i.isProcessing=!0,c.process(i),d.process(i),u.process(i),h.process(i),m.process(i),g.process(i),y.process(i),N.process(i),i.isProcessing=!1,r&&n&&(s=!1,t(j))},S=()=>{r=!0,s=!0,i.isProcessing||t(j)};return{schedule:h0.reduce((k,T)=>{const P=l[T];return k[T]=(M,O=!1,D=!1)=>(r||S(),P.schedule(M,O,D)),k},{}),cancel:k=>{for(let T=0;T<h0.length;T++)l[h0[T]].cancel(k)},state:i,steps:l}}const{schedule:zn,cancel:kc,state:hs,steps:Qw}=LL(typeof requestAnimationFrame<"u"?requestAnimationFrame:di,!0);let Ng;function Nne(){Ng=void 0}const ia={now:()=>(Ng===void 0&&ia.set(hs.isProcessing||ml.useManualTiming?hs.timestamp:performance.now()),Ng),set:t=>{Ng=t,queueMicrotask(Nne)}},BL=t=>n=>typeof n=="string"&&n.startsWith(t),J_=BL("--"),jne=BL("var(--"),eA=t=>jne(t)?Sne.test(t.split("/*")[0].trim()):!1,Sne=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,yh={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},jp={...yh,transform:t=>hl(0,1,t)},m0={...yh,default:1},Um=t=>Math.round(t*1e5)/1e5,tA=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Cne(t){return t==null}const _ne=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,nA=(t,n)=>r=>!!(typeof r=="string"&&_ne.test(r)&&r.startsWith(t)||n&&!Cne(r)&&Object.prototype.hasOwnProperty.call(r,n)),FL=(t,n,r)=>s=>{if(typeof s!="string")return s;const[i,o,l,c]=s.match(tA);return{[t]:parseFloat(i),[n]:parseFloat(o),[r]:parseFloat(l),alpha:c!==void 0?parseFloat(c):1}},Ane=t=>hl(0,255,t),Zw={...yh,transform:t=>Math.round(Ane(t))},Ed={test:nA("rgb","red"),parse:FL("red","green","blue"),transform:({red:t,green:n,blue:r,alpha:s=1})=>"rgba("+Zw.transform(t)+", "+Zw.transform(n)+", "+Zw.transform(r)+", "+Um(jp.transform(s))+")"};function Ene(t){let n="",r="",s="",i="";return t.length>5?(n=t.substring(1,3),r=t.substring(3,5),s=t.substring(5,7),i=t.substring(7,9)):(n=t.substring(1,2),r=t.substring(2,3),s=t.substring(3,4),i=t.substring(4,5),n+=n,r+=r,s+=s,i+=i),{red:parseInt(n,16),green:parseInt(r,16),blue:parseInt(s,16),alpha:i?parseInt(i,16)/255:1}}const $j={test:nA("#"),parse:Ene,transform:Ed.transform},hx=t=>({test:n=>typeof n=="string"&&n.endsWith(t)&&n.split(" ").length===1,parse:parseFloat,transform:n=>`${n}${t}`}),Gl=hx("deg"),bo=hx("%"),kt=hx("px"),kne=hx("vh"),Tne=hx("vw"),R5={...bo,parse:t=>bo.parse(t)/100,transform:t=>bo.transform(t*100)},ff={test:nA("hsl","hue"),parse:FL("hue","saturation","lightness"),transform:({hue:t,saturation:n,lightness:r,alpha:s=1})=>"hsla("+Math.round(t)+", "+bo.transform(Um(n))+", "+bo.transform(Um(r))+", "+Um(jp.transform(s))+")"},vr={test:t=>Ed.test(t)||$j.test(t)||ff.test(t),parse:t=>Ed.test(t)?Ed.parse(t):ff.test(t)?ff.parse(t):$j.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Ed.transform(t):ff.transform(t),getAnimatableNone:t=>{const n=vr.parse(t);return n.alpha=0,vr.transform(n)}},Ine=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Pne(t){var n,r;return isNaN(t)&&typeof t=="string"&&(((n=t.match(tA))==null?void 0:n.length)||0)+(((r=t.match(Ine))==null?void 0:r.length)||0)>0}const $L="number",zL="color",Mne="var",One="var(",L5="${}",Dne=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Sp(t){const n=t.toString(),r=[],s={color:[],number:[],var:[]},i=[];let o=0;const c=n.replace(Dne,d=>(vr.test(d)?(s.color.push(o),i.push(zL),r.push(vr.parse(d))):d.startsWith(One)?(s.var.push(o),i.push(Mne),r.push(d)):(s.number.push(o),i.push($L),r.push(parseFloat(d))),++o,L5)).split(L5);return{values:r,split:c,indexes:s,types:i}}function UL(t){return Sp(t).values}function VL(t){const{split:n,types:r}=Sp(t),s=n.length;return i=>{let o="";for(let l=0;l<s;l++)if(o+=n[l],i[l]!==void 0){const c=r[l];c===$L?o+=Um(i[l]):c===zL?o+=vr.transform(i[l]):o+=i[l]}return o}}const Rne=t=>typeof t=="number"?0:vr.test(t)?vr.getAnimatableNone(t):t;function Lne(t){const n=UL(t);return VL(t)(n.map(Rne))}const Tc={test:Pne,parse:UL,createTransformer:VL,getAnimatableNone:Lne};function Jw(t,n,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(n-t)*6*r:r<1/2?n:r<2/3?t+(n-t)*(2/3-r)*6:t}function Bne({hue:t,saturation:n,lightness:r,alpha:s}){t/=360,n/=100,r/=100;let i=0,o=0,l=0;if(!n)i=o=l=r;else{const c=r<.5?r*(1+n):r+n-r*n,d=2*r-c;i=Jw(d,c,t+1/3),o=Jw(d,c,t),l=Jw(d,c,t-1/3)}return{red:Math.round(i*255),green:Math.round(o*255),blue:Math.round(l*255),alpha:s}}function j1(t,n){return r=>r>0?n:t}const Yn=(t,n,r)=>t+(n-t)*r,eN=(t,n,r)=>{const s=t*t,i=r*(n*n-s)+s;return i<0?0:Math.sqrt(i)},Fne=[$j,Ed,ff],$ne=t=>Fne.find(n=>n.test(t));function B5(t){const n=$ne(t);if(!n)return!1;let r=n.parse(t);return n===ff&&(r=Bne(r)),r}const F5=(t,n)=>{const r=B5(t),s=B5(n);if(!r||!s)return j1(t,n);const i={...r};return o=>(i.red=eN(r.red,s.red,o),i.green=eN(r.green,s.green,o),i.blue=eN(r.blue,s.blue,o),i.alpha=Yn(r.alpha,s.alpha,o),Ed.transform(i))},zj=new Set(["none","hidden"]);function zne(t,n){return zj.has(t)?r=>r<=0?t:n:r=>r>=1?n:t}function Une(t,n){return r=>Yn(t,n,r)}function rA(t){return typeof t=="number"?Une:typeof t=="string"?eA(t)?j1:vr.test(t)?F5:Wne:Array.isArray(t)?HL:typeof t=="object"?vr.test(t)?F5:Vne:j1}function HL(t,n){const r=[...t],s=r.length,i=t.map((o,l)=>rA(o)(o,n[l]));return o=>{for(let l=0;l<s;l++)r[l]=i[l](o);return r}}function Vne(t,n){const r={...t,...n},s={};for(const i in r)t[i]!==void 0&&n[i]!==void 0&&(s[i]=rA(t[i])(t[i],n[i]));return i=>{for(const o in s)r[o]=s[o](i);return r}}function Hne(t,n){const r=[],s={color:0,var:0,number:0};for(let i=0;i<n.values.length;i++){const o=n.types[i],l=t.indexes[o][s[o]],c=t.values[l]??0;r[i]=c,s[o]++}return r}const Wne=(t,n)=>{const r=Tc.createTransformer(n),s=Sp(t),i=Sp(n);return s.indexes.var.length===i.indexes.var.length&&s.indexes.color.length===i.indexes.color.length&&s.indexes.number.length>=i.indexes.number.length?zj.has(t)&&!i.values.length||zj.has(n)&&!s.values.length?zne(t,n):ux(HL(Hne(s,i),i.values),r):j1(t,n)};function WL(t,n,r){return typeof t=="number"&&typeof n=="number"&&typeof r=="number"?Yn(t,n,r):rA(t)(t,n)}const qne=t=>{const n=({timestamp:r})=>t(r);return{start:(r=!0)=>zn.update(n,r),stop:()=>kc(n),now:()=>hs.isProcessing?hs.timestamp:ia.now()}},qL=(t,n,r=10)=>{let s="";const i=Math.max(Math.round(n/r),2);for(let o=0;o<i;o++)s+=Math.round(t(o/(i-1))*1e4)/1e4+", ";return`linear(${s.substring(0,s.length-2)})`},S1=2e4;function sA(t){let n=0;const r=50;let s=t.next(n);for(;!s.done&&n<S1;)n+=r,s=t.next(n);return n>=S1?1/0:n}function Gne(t,n=100,r){const s=r({...t,keyframes:[0,n]}),i=Math.min(sA(s),S1);return{type:"keyframes",ease:o=>s.next(i*o).value/n,duration:ii(i)}}const Kne=5;function GL(t,n,r){const s=Math.max(n-Kne,0);return _L(r-t(s),n-s)}const ar={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},tN=.001;function Yne({duration:t=ar.duration,bounce:n=ar.bounce,velocity:r=ar.velocity,mass:s=ar.mass}){let i,o,l=1-n;l=hl(ar.minDamping,ar.maxDamping,l),t=hl(ar.minDuration,ar.maxDuration,ii(t)),l<1?(i=u=>{const h=u*l,m=h*t,g=h-r,y=Uj(u,l),N=Math.exp(-m);return tN-g/y*N},o=u=>{const m=u*l*t,g=m*r+r,y=Math.pow(l,2)*Math.pow(u,2)*t,N=Math.exp(-m),j=Uj(Math.pow(u,2),l);return(-i(u)+tN>0?-1:1)*((g-y)*N)/j}):(i=u=>{const h=Math.exp(-u*t),m=(u-r)*t+1;return-tN+h*m},o=u=>{const h=Math.exp(-u*t),m=(r-u)*(t*t);return h*m});const c=5/t,d=Qne(i,o,c);if(t=vo(t),isNaN(d))return{stiffness:ar.stiffness,damping:ar.damping,duration:t};{const u=Math.pow(d,2)*s;return{stiffness:u,damping:l*2*Math.sqrt(s*u),duration:t}}}const Xne=12;function Qne(t,n,r){let s=r;for(let i=1;i<Xne;i++)s=s-t(s)/n(s);return s}function Uj(t,n){return t*Math.sqrt(1-n*n)}const Zne=["duration","bounce"],Jne=["stiffness","damping","mass"];function $5(t,n){return n.some(r=>t[r]!==void 0)}function ere(t){let n={velocity:ar.velocity,stiffness:ar.stiffness,damping:ar.damping,mass:ar.mass,isResolvedFromDuration:!1,...t};if(!$5(t,Jne)&&$5(t,Zne))if(t.visualDuration){const r=t.visualDuration,s=2*Math.PI/(r*1.2),i=s*s,o=2*hl(.05,1,1-(t.bounce||0))*Math.sqrt(i);n={...n,mass:ar.mass,stiffness:i,damping:o}}else{const r=Yne(t);n={...n,...r,mass:ar.mass},n.isResolvedFromDuration=!0}return n}function C1(t=ar.visualDuration,n=ar.bounce){const r=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:n}:t;let{restSpeed:s,restDelta:i}=r;const o=r.keyframes[0],l=r.keyframes[r.keyframes.length-1],c={done:!1,value:o},{stiffness:d,damping:u,mass:h,duration:m,velocity:g,isResolvedFromDuration:y}=ere({...r,velocity:-ii(r.velocity||0)}),N=g||0,j=u/(2*Math.sqrt(d*h)),S=l-o,_=ii(Math.sqrt(d/h)),A=Math.abs(S)<5;s||(s=A?ar.restSpeed.granular:ar.restSpeed.default),i||(i=A?ar.restDelta.granular:ar.restDelta.default);let k;if(j<1){const P=Uj(_,j);k=M=>{const O=Math.exp(-j*_*M);return l-O*((N+j*_*S)/P*Math.sin(P*M)+S*Math.cos(P*M))}}else if(j===1)k=P=>l-Math.exp(-_*P)*(S+(N+_*S)*P);else{const P=_*Math.sqrt(j*j-1);k=M=>{const O=Math.exp(-j*_*M),D=Math.min(P*M,300);return l-O*((N+j*_*S)*Math.sinh(D)+P*S*Math.cosh(D))/P}}const T={calculatedDuration:y&&m||null,next:P=>{const M=k(P);if(y)c.done=P>=m;else{let O=P===0?N:0;j<1&&(O=P===0?vo(N):GL(k,P,M));const D=Math.abs(O)<=s,L=Math.abs(l-M)<=i;c.done=D&&L}return c.value=c.done?l:M,c},toString:()=>{const P=Math.min(sA(T),S1),M=qL(O=>T.next(P*O).value,P,30);return P+"ms "+M},toTransition:()=>{}};return T}C1.applyToOptions=t=>{const n=Gne(t,100,C1);return t.ease=n.ease,t.duration=vo(n.duration),t.type="keyframes",t};function Vj({keyframes:t,velocity:n=0,power:r=.8,timeConstant:s=325,bounceDamping:i=10,bounceStiffness:o=500,modifyTarget:l,min:c,max:d,restDelta:u=.5,restSpeed:h}){const m=t[0],g={done:!1,value:m},y=D=>c!==void 0&&D<c||d!==void 0&&D>d,N=D=>c===void 0?d:d===void 0||Math.abs(c-D)<Math.abs(d-D)?c:d;let j=r*n;const S=m+j,_=l===void 0?S:l(S);_!==S&&(j=_-m);const A=D=>-j*Math.exp(-D/s),k=D=>_+A(D),T=D=>{const L=A(D),$=k(D);g.done=Math.abs(L)<=u,g.value=g.done?_:$};let P,M;const O=D=>{y(g.value)&&(P=D,M=C1({keyframes:[g.value,N(g.value)],velocity:GL(k,D,g.value),damping:i,stiffness:o,restDelta:u,restSpeed:h}))};return O(0),{calculatedDuration:null,next:D=>{let L=!1;return!M&&P===void 0&&(L=!0,T(D),O(D)),P!==void 0&&D>=P?M.next(D-P):(!L&&T(D),g)}}}function tre(t,n,r){const s=[],i=r||ml.mix||WL,o=t.length-1;for(let l=0;l<o;l++){let c=i(t[l],t[l+1]);if(n){const d=Array.isArray(n)?n[l]||di:n;c=ux(d,c)}s.push(c)}return s}function nre(t,n,{clamp:r=!0,ease:s,mixer:i}={}){const o=t.length;if(K_(o===n.length),o===1)return()=>n[0];if(o===2&&n[0]===n[1])return()=>n[1];const l=t[0]===t[1];t[0]>t[o-1]&&(t=[...t].reverse(),n=[...n].reverse());const c=tre(n,s,i),d=c.length,u=h=>{if(l&&h<t[0])return n[0];let m=0;if(d>1)for(;m<t.length-2&&!(h<t[m+1]);m++);const g=Np(t[m],t[m+1],h);return c[m](g)};return r?h=>u(hl(t[0],t[o-1],h)):u}function rre(t,n){const r=t[t.length-1];for(let s=1;s<=n;s++){const i=Np(0,n,s);t.push(Yn(r,1,i))}}function sre(t){const n=[0];return rre(n,t.length-1),n}function are(t,n){return t.map(r=>r*n)}function ire(t,n){return t.map(()=>n||DL).splice(0,t.length-1)}function Vm({duration:t=300,keyframes:n,times:r,ease:s="easeInOut"}){const i=gne(s)?s.map(D5):D5(s),o={done:!1,value:n[0]},l=are(r&&r.length===n.length?r:sre(n),t),c=nre(l,n,{ease:Array.isArray(i)?i:ire(n,i)});return{calculatedDuration:t,next:d=>(o.value=c(d),o.done=d>=t,o)}}const ore=t=>t!==null;function aA(t,{repeat:n,repeatType:r="loop"},s,i=1){const o=t.filter(ore),c=i<0||n&&r!=="loop"&&n%2===1?0:o.length-1;return!c||s===void 0?o[c]:s}const lre={decay:Vj,inertia:Vj,tween:Vm,keyframes:Vm,spring:C1};function KL(t){typeof t.type=="string"&&(t.type=lre[t.type])}class iA{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(n=>{this.resolve=n})}notifyFinished(){this.resolve()}then(n,r){return this.finished.then(n,r)}}const cre=t=>t/100;class oA extends iA{constructor(n){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var s,i;const{motionValue:r}=this.options;r&&r.updatedAt!==ia.now()&&this.tick(ia.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(i=(s=this.options).onStop)==null||i.call(s))},this.options=n,this.initAnimation(),this.play(),n.autoplay===!1&&this.pause()}initAnimation(){const{options:n}=this;KL(n);const{type:r=Vm,repeat:s=0,repeatDelay:i=0,repeatType:o,velocity:l=0}=n;let{keyframes:c}=n;const d=r||Vm;d!==Vm&&typeof c[0]!="number"&&(this.mixKeyframes=ux(cre,WL(c[0],c[1])),c=[0,100]);const u=d({...n,keyframes:c});o==="mirror"&&(this.mirroredGenerator=d({...n,keyframes:[...c].reverse(),velocity:-l})),u.calculatedDuration===null&&(u.calculatedDuration=sA(u));const{calculatedDuration:h}=u;this.calculatedDuration=h,this.resolvedDuration=h+i,this.totalDuration=this.resolvedDuration*(s+1)-i,this.generator=u}updateTime(n){const r=Math.round(n-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(n,r=!1){const{generator:s,totalDuration:i,mixKeyframes:o,mirroredGenerator:l,resolvedDuration:c,calculatedDuration:d}=this;if(this.startTime===null)return s.next(0);const{delay:u=0,keyframes:h,repeat:m,repeatType:g,repeatDelay:y,type:N,onUpdate:j,finalKeyframe:S}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,n):this.speed<0&&(this.startTime=Math.min(n-i/this.speed,this.startTime)),r?this.currentTime=n:this.updateTime(n);const _=this.currentTime-u*(this.playbackSpeed>=0?1:-1),A=this.playbackSpeed>=0?_<0:_>i;this.currentTime=Math.max(_,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let k=this.currentTime,T=s;if(m){const D=Math.min(this.currentTime,i)/c;let L=Math.floor(D),$=D%1;!$&&D>=1&&($=1),$===1&&L--,L=Math.min(L,m+1),!!(L%2)&&(g==="reverse"?($=1-$,y&&($-=y/c)):g==="mirror"&&(T=l)),k=hl(0,1,$)*c}const P=A?{done:!1,value:h[0]}:T.next(k);o&&(P.value=o(P.value));let{done:M}=P;!A&&d!==null&&(M=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const O=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&M);return O&&N!==Vj&&(P.value=aA(h,this.options,S,this.speed)),j&&j(P.value),O&&this.finish(),P}then(n,r){return this.finished.then(n,r)}get duration(){return ii(this.calculatedDuration)}get iterationDuration(){const{delay:n=0}=this.options||{};return this.duration+ii(n)}get time(){return ii(this.currentTime)}set time(n){var r;n=vo(n),this.currentTime=n,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=n:this.driver&&(this.startTime=this.driver.now()-n/this.playbackSpeed),(r=this.driver)==null||r.start(!1)}get speed(){return this.playbackSpeed}set speed(n){this.updateTime(ia.now());const r=this.playbackSpeed!==n;this.playbackSpeed=n,r&&(this.time=ii(this.currentTime))}play(){var i,o;if(this.isStopped)return;const{driver:n=qne,startTime:r}=this.options;this.driver||(this.driver=n(l=>this.tick(l))),(o=(i=this.options).onPlay)==null||o.call(i);const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=r??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ia.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var n,r;this.notifyFinished(),this.teardown(),this.state="finished",(r=(n=this.options).onComplete)==null||r.call(n)}cancel(){var n,r;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(r=(n=this.options).onCancel)==null||r.call(n)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(n){return this.startTime=0,this.tick(n,!0)}attachTimeline(n){var r;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(r=this.driver)==null||r.stop(),n.observe(this)}}function dre(t){for(let n=1;n<t.length;n++)t[n]??(t[n]=t[n-1])}const kd=t=>t*180/Math.PI,Hj=t=>{const n=kd(Math.atan2(t[1],t[0]));return Wj(n)},ure={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:Hj,rotateZ:Hj,skewX:t=>kd(Math.atan(t[1])),skewY:t=>kd(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},Wj=t=>(t=t%360,t<0&&(t+=360),t),z5=Hj,U5=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),V5=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),fre={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:U5,scaleY:V5,scale:t=>(U5(t)+V5(t))/2,rotateX:t=>Wj(kd(Math.atan2(t[6],t[5]))),rotateY:t=>Wj(kd(Math.atan2(-t[2],t[0]))),rotateZ:z5,rotate:z5,skewX:t=>kd(Math.atan(t[4])),skewY:t=>kd(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function qj(t){return t.includes("scale")?1:0}function Gj(t,n){if(!t||t==="none")return qj(n);const r=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let s,i;if(r)s=fre,i=r;else{const c=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);s=ure,i=c}if(!i)return qj(n);const o=s[n],l=i[1].split(",").map(mre);return typeof o=="function"?o(l):l[o]}const hre=(t,n)=>{const{transform:r="none"}=getComputedStyle(t);return Gj(r,n)};function mre(t){return parseFloat(t.trim())}const vh=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],bh=new Set(vh),H5=t=>t===yh||t===kt,pre=new Set(["x","y","z"]),xre=vh.filter(t=>!pre.has(t));function gre(t){const n=[];return xre.forEach(r=>{const s=t.getValue(r);s!==void 0&&(n.push([r,s.get()]),s.set(r.startsWith("scale")?1:0))}),n}const zd={width:({x:t},{paddingLeft:n="0",paddingRight:r="0"})=>t.max-t.min-parseFloat(n)-parseFloat(r),height:({y:t},{paddingTop:n="0",paddingBottom:r="0"})=>t.max-t.min-parseFloat(n)-parseFloat(r),top:(t,{top:n})=>parseFloat(n),left:(t,{left:n})=>parseFloat(n),bottom:({y:t},{top:n})=>parseFloat(n)+(t.max-t.min),right:({x:t},{left:n})=>parseFloat(n)+(t.max-t.min),x:(t,{transform:n})=>Gj(n,"x"),y:(t,{transform:n})=>Gj(n,"y")};zd.translateX=zd.x;zd.translateY=zd.y;const Ud=new Set;let Kj=!1,Yj=!1,Xj=!1;function YL(){if(Yj){const t=Array.from(Ud).filter(s=>s.needsMeasurement),n=new Set(t.map(s=>s.element)),r=new Map;n.forEach(s=>{const i=gre(s);i.length&&(r.set(s,i),s.render())}),t.forEach(s=>s.measureInitialState()),n.forEach(s=>{s.render();const i=r.get(s);i&&i.forEach(([o,l])=>{var c;(c=s.getValue(o))==null||c.set(l)})}),t.forEach(s=>s.measureEndState()),t.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}Yj=!1,Kj=!1,Ud.forEach(t=>t.complete(Xj)),Ud.clear()}function XL(){Ud.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Yj=!0)})}function yre(){Xj=!0,XL(),YL(),Xj=!1}class lA{constructor(n,r,s,i,o,l=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...n],this.onComplete=r,this.name=s,this.motionValue=i,this.element=o,this.isAsync=l}scheduleResolve(){this.state="scheduled",this.isAsync?(Ud.add(this),Kj||(Kj=!0,zn.read(XL),zn.resolveKeyframes(YL))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:n,name:r,element:s,motionValue:i}=this;if(n[0]===null){const o=i==null?void 0:i.get(),l=n[n.length-1];if(o!==void 0)n[0]=o;else if(s&&r){const c=s.readValue(r,l);c!=null&&(n[0]=c)}n[0]===void 0&&(n[0]=l),i&&o===void 0&&i.set(n[0])}dre(n)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(n=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,n),Ud.delete(this)}cancel(){this.state==="scheduled"&&(Ud.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const vre=t=>t.startsWith("--");function bre(t,n,r){vre(n)?t.style.setProperty(n,r):t.style[n]=r}const wre=Y_(()=>window.ScrollTimeline!==void 0),Nre={};function jre(t,n){const r=Y_(t);return()=>Nre[n]??r()}const QL=jre(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),_m=([t,n,r,s])=>`cubic-bezier(${t}, ${n}, ${r}, ${s})`,W5={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:_m([0,.65,.55,1]),circOut:_m([.55,0,1,.45]),backIn:_m([.31,.01,.66,-.59]),backOut:_m([.33,1.53,.69,.99])};function ZL(t,n){if(t)return typeof t=="function"?QL()?qL(t,n):"ease-out":RL(t)?_m(t):Array.isArray(t)?t.map(r=>ZL(r,n)||W5.easeOut):W5[t]}function Sre(t,n,r,{delay:s=0,duration:i=300,repeat:o=0,repeatType:l="loop",ease:c="easeOut",times:d}={},u=void 0){const h={[n]:r};d&&(h.offset=d);const m=ZL(c,i);Array.isArray(m)&&(h.easing=m);const g={delay:s,duration:i,easing:Array.isArray(m)?"linear":m,fill:"both",iterations:o+1,direction:l==="reverse"?"alternate":"normal"};return u&&(g.pseudoElement=u),t.animate(h,g)}function JL(t){return typeof t=="function"&&"applyToOptions"in t}function Cre({type:t,...n}){return JL(t)&&QL()?t.applyToOptions(n):(n.duration??(n.duration=300),n.ease??(n.ease="easeOut"),n)}class _re extends iA{constructor(n){if(super(),this.finishedTime=null,this.isStopped=!1,!n)return;const{element:r,name:s,keyframes:i,pseudoElement:o,allowFlatten:l=!1,finalKeyframe:c,onComplete:d}=n;this.isPseudoElement=!!o,this.allowFlatten=l,this.options=n,K_(typeof n.type!="string");const u=Cre(n);this.animation=Sre(r,s,i,u,o),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!o){const h=aA(i,this.options,c,this.speed);this.updateMotionValue?this.updateMotionValue(h):bre(r,s,h),this.animation.cancel()}d==null||d(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var n,r;(r=(n=this.animation).finish)==null||r.call(n)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:n}=this;n==="idle"||n==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var n,r;this.isPseudoElement||(r=(n=this.animation).commitStyles)==null||r.call(n)}get duration(){var r,s;const n=((s=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:s.call(r).duration)||0;return ii(Number(n))}get iterationDuration(){const{delay:n=0}=this.options||{};return this.duration+ii(n)}get time(){return ii(Number(this.animation.currentTime)||0)}set time(n){this.finishedTime=null,this.animation.currentTime=vo(n)}get speed(){return this.animation.playbackRate}set speed(n){n<0&&(this.finishedTime=null),this.animation.playbackRate=n}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(n){this.animation.startTime=n}attachTimeline({timeline:n,observe:r}){var s;return this.allowFlatten&&((s=this.animation.effect)==null||s.updateTiming({easing:"linear"})),this.animation.onfinish=null,n&&wre()?(this.animation.timeline=n,di):r(this)}}const e7={anticipate:PL,backInOut:IL,circInOut:OL};function Are(t){return t in e7}function Ere(t){typeof t.ease=="string"&&Are(t.ease)&&(t.ease=e7[t.ease])}const q5=10;class kre extends _re{constructor(n){Ere(n),KL(n),super(n),n.startTime&&(this.startTime=n.startTime),this.options=n}updateMotionValue(n){const{motionValue:r,onUpdate:s,onComplete:i,element:o,...l}=this.options;if(!r)return;if(n!==void 0){r.set(n);return}const c=new oA({...l,autoplay:!1}),d=vo(this.finishedTime??this.time);r.setWithVelocity(c.sample(d-q5).value,c.sample(d).value,q5),c.stop()}}const G5=(t,n)=>n==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Tc.test(t)||t==="0")&&!t.startsWith("url("));function Tre(t){const n=t[0];if(t.length===1)return!0;for(let r=0;r<t.length;r++)if(t[r]!==n)return!0}function Ire(t,n,r,s){const i=t[0];if(i===null)return!1;if(n==="display"||n==="visibility")return!0;const o=t[t.length-1],l=G5(i,n),c=G5(o,n);return!l||!c?!1:Tre(t)||(r==="spring"||JL(r))&&s}function Qj(t){t.duration=0,t.type="keyframes"}const Pre=new Set(["opacity","clipPath","filter","transform"]),Mre=Y_(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function Ore(t){var h;const{motionValue:n,name:r,repeatDelay:s,repeatType:i,damping:o,type:l}=t;if(!(((h=n==null?void 0:n.owner)==null?void 0:h.current)instanceof HTMLElement))return!1;const{onUpdate:d,transformTemplate:u}=n.owner.getProps();return Mre()&&r&&Pre.has(r)&&(r!=="transform"||!u)&&!d&&!s&&i!=="mirror"&&o!==0&&l!=="inertia"}const Dre=40;class Rre extends iA{constructor({autoplay:n=!0,delay:r=0,type:s="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:l="loop",keyframes:c,name:d,motionValue:u,element:h,...m}){var N;super(),this.stop=()=>{var j,S;this._animation&&(this._animation.stop(),(j=this.stopTimeline)==null||j.call(this)),(S=this.keyframeResolver)==null||S.cancel()},this.createdAt=ia.now();const g={autoplay:n,delay:r,type:s,repeat:i,repeatDelay:o,repeatType:l,name:d,motionValue:u,element:h,...m},y=(h==null?void 0:h.KeyframeResolver)||lA;this.keyframeResolver=new y(c,(j,S,_)=>this.onKeyframesResolved(j,S,g,!_),d,u,h),(N=this.keyframeResolver)==null||N.scheduleResolve()}onKeyframesResolved(n,r,s,i){this.keyframeResolver=void 0;const{name:o,type:l,velocity:c,delay:d,isHandoff:u,onUpdate:h}=s;this.resolvedAt=ia.now(),Ire(n,o,l,c)||((ml.instantAnimations||!d)&&(h==null||h(aA(n,s,r))),n[0]=n[n.length-1],Qj(s),s.repeat=0);const g={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>Dre?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...s,keyframes:n},y=!u&&Ore(g)?new kre({...g,element:g.motionValue.owner.current}):new oA(g);y.finished.then(()=>this.notifyFinished()).catch(di),this.pendingTimeline&&(this.stopTimeline=y.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=y}get finished(){return this._animation?this.animation.finished:this._finished}then(n,r){return this.finished.finally(n).then(()=>{})}get animation(){var n;return this._animation||((n=this.keyframeResolver)==null||n.resume(),yre()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(n){this.animation.time=n}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(n){this.animation.speed=n}get startTime(){return this.animation.startTime}attachTimeline(n){return this._animation?this.stopTimeline=this.animation.attachTimeline(n):this.pendingTimeline=n,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var n;this._animation&&this.animation.cancel(),(n=this.keyframeResolver)==null||n.cancel()}}const Lre=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Bre(t){const n=Lre.exec(t);if(!n)return[,];const[,r,s,i]=n;return[`--${r??s}`,i]}function t7(t,n,r=1){const[s,i]=Bre(t);if(!s)return;const o=window.getComputedStyle(n).getPropertyValue(s);if(o){const l=o.trim();return jL(l)?parseFloat(l):l}return eA(i)?t7(i,n,r+1):i}function cA(t,n){return(t==null?void 0:t[n])??(t==null?void 0:t.default)??t}const n7=new Set(["width","height","top","left","right","bottom",...vh]),Fre={test:t=>t==="auto",parse:t=>t},r7=t=>n=>n.test(t),s7=[yh,kt,bo,Gl,Tne,kne,Fre],K5=t=>s7.find(r7(t));function $re(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||CL(t):!0}const zre=new Set(["brightness","contrast","saturate","opacity"]);function Ure(t){const[n,r]=t.slice(0,-1).split("(");if(n==="drop-shadow")return t;const[s]=r.match(tA)||[];if(!s)return t;const i=r.replace(s,"");let o=zre.has(n)?1:0;return s!==r&&(o*=100),n+"("+o+i+")"}const Vre=/\b([a-z-]*)\(.*?\)/gu,Zj={...Tc,getAnimatableNone:t=>{const n=t.match(Vre);return n?n.map(Ure).join(" "):t}},Y5={...yh,transform:Math.round},Hre={rotate:Gl,rotateX:Gl,rotateY:Gl,rotateZ:Gl,scale:m0,scaleX:m0,scaleY:m0,scaleZ:m0,skew:Gl,skewX:Gl,skewY:Gl,distance:kt,translateX:kt,translateY:kt,translateZ:kt,x:kt,y:kt,z:kt,perspective:kt,transformPerspective:kt,opacity:jp,originX:R5,originY:R5,originZ:kt},dA={borderWidth:kt,borderTopWidth:kt,borderRightWidth:kt,borderBottomWidth:kt,borderLeftWidth:kt,borderRadius:kt,radius:kt,borderTopLeftRadius:kt,borderTopRightRadius:kt,borderBottomRightRadius:kt,borderBottomLeftRadius:kt,width:kt,maxWidth:kt,height:kt,maxHeight:kt,top:kt,right:kt,bottom:kt,left:kt,padding:kt,paddingTop:kt,paddingRight:kt,paddingBottom:kt,paddingLeft:kt,margin:kt,marginTop:kt,marginRight:kt,marginBottom:kt,marginLeft:kt,backgroundPositionX:kt,backgroundPositionY:kt,...Hre,zIndex:Y5,fillOpacity:jp,strokeOpacity:jp,numOctaves:Y5},Wre={...dA,color:vr,backgroundColor:vr,outlineColor:vr,fill:vr,stroke:vr,borderColor:vr,borderTopColor:vr,borderRightColor:vr,borderBottomColor:vr,borderLeftColor:vr,filter:Zj,WebkitFilter:Zj},a7=t=>Wre[t];function i7(t,n){let r=a7(t);return r!==Zj&&(r=Tc),r.getAnimatableNone?r.getAnimatableNone(n):void 0}const qre=new Set(["auto","none","0"]);function Gre(t,n,r){let s=0,i;for(;s<t.length&&!i;){const o=t[s];typeof o=="string"&&!qre.has(o)&&Sp(o).values.length&&(i=t[s]),s++}if(i&&r)for(const o of n)t[o]=i7(r,i)}class Kre extends lA{constructor(n,r,s,i,o){super(n,r,s,i,o,!0)}readKeyframes(){const{unresolvedKeyframes:n,element:r,name:s}=this;if(!r||!r.current)return;super.readKeyframes();for(let d=0;d<n.length;d++){let u=n[d];if(typeof u=="string"&&(u=u.trim(),eA(u))){const h=t7(u,r.current);h!==void 0&&(n[d]=h),d===n.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!n7.has(s)||n.length!==2)return;const[i,o]=n,l=K5(i),c=K5(o);if(l!==c)if(H5(l)&&H5(c))for(let d=0;d<n.length;d++){const u=n[d];typeof u=="string"&&(n[d]=parseFloat(u))}else zd[s]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:n,name:r}=this,s=[];for(let i=0;i<n.length;i++)(n[i]===null||$re(n[i]))&&s.push(i);s.length&&Gre(n,s,r)}measureInitialState(){const{element:n,unresolvedKeyframes:r,name:s}=this;if(!n||!n.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=zd[s](n.measureViewportBox(),window.getComputedStyle(n.current)),r[0]=this.measuredOrigin;const i=r[r.length-1];i!==void 0&&n.getValue(s,i).jump(i,!1)}measureEndState(){var c;const{element:n,name:r,unresolvedKeyframes:s}=this;if(!n||!n.current)return;const i=n.getValue(r);i&&i.jump(this.measuredOrigin,!1);const o=s.length-1,l=s[o];s[o]=zd[r](n.measureViewportBox(),window.getComputedStyle(n.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),(c=this.removedTransforms)!=null&&c.length&&this.removedTransforms.forEach(([d,u])=>{n.getValue(d).set(u)}),this.resolveNoneKeyframes()}}function Yre(t,n,r){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let s=document;const i=(r==null?void 0:r[t])??s.querySelectorAll(t);return i?Array.from(i):[]}return Array.from(t)}const o7=(t,n)=>n&&typeof t=="number"?n.transform(t):t;function l7(t){return SL(t)&&"offsetHeight"in t}const X5=30,Xre=t=>!isNaN(parseFloat(t));class Qre{constructor(n,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=s=>{var o;const i=ia.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&((o=this.events.change)==null||o.notify(this.current),this.dependents))for(const l of this.dependents)l.dirty()},this.hasAnimated=!1,this.setCurrent(n),this.owner=r.owner}setCurrent(n){this.current=n,this.updatedAt=ia.now(),this.canTrackVelocity===null&&n!==void 0&&(this.canTrackVelocity=Xre(this.current))}setPrevFrameValue(n=this.current){this.prevFrameValue=n,this.prevUpdatedAt=this.updatedAt}onChange(n){return this.on("change",n)}on(n,r){this.events[n]||(this.events[n]=new X_);const s=this.events[n].add(r);return n==="change"?()=>{s(),zn.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const n in this.events)this.events[n].clear()}attach(n,r){this.passiveEffect=n,this.stopPassiveEffect=r}set(n){this.passiveEffect?this.passiveEffect(n,this.updateAndNotify):this.updateAndNotify(n)}setWithVelocity(n,r,s){this.set(r),this.prev=void 0,this.prevFrameValue=n,this.prevUpdatedAt=this.updatedAt-s}jump(n,r=!0){this.updateAndNotify(n),this.prev=n,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var n;(n=this.events.change)==null||n.notify(this.current)}addDependent(n){this.dependents||(this.dependents=new Set),this.dependents.add(n)}removeDependent(n){this.dependents&&this.dependents.delete(n)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const n=ia.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||n-this.updatedAt>X5)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,X5);return _L(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(n){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=n(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var n,r;(n=this.dependents)==null||n.clear(),(r=this.events.destroy)==null||r.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Gf(t,n){return new Qre(t,n)}const{schedule:uA}=LL(queueMicrotask,!1),_i={x:!1,y:!1};function c7(){return _i.x||_i.y}function Zre(t){return t==="x"||t==="y"?_i[t]?null:(_i[t]=!0,()=>{_i[t]=!1}):_i.x||_i.y?null:(_i.x=_i.y=!0,()=>{_i.x=_i.y=!1})}function d7(t,n){const r=Yre(t),s=new AbortController,i={passive:!0,...n,signal:s.signal};return[r,i,()=>s.abort()]}function Q5(t){return!(t.pointerType==="touch"||c7())}function Jre(t,n,r={}){const[s,i,o]=d7(t,r),l=c=>{if(!Q5(c))return;const{target:d}=c,u=n(d,c);if(typeof u!="function"||!d)return;const h=m=>{Q5(m)&&(u(m),d.removeEventListener("pointerleave",h))};d.addEventListener("pointerleave",h,i)};return s.forEach(c=>{c.addEventListener("pointerenter",l,i)}),o}const u7=(t,n)=>n?t===n?!0:u7(t,n.parentElement):!1,fA=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,ese=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function tse(t){return ese.has(t.tagName)||t.tabIndex!==-1}const jg=new WeakSet;function Z5(t){return n=>{n.key==="Enter"&&t(n)}}function nN(t,n){t.dispatchEvent(new PointerEvent("pointer"+n,{isPrimary:!0,bubbles:!0}))}const nse=(t,n)=>{const r=t.currentTarget;if(!r)return;const s=Z5(()=>{if(jg.has(r))return;nN(r,"down");const i=Z5(()=>{nN(r,"up")}),o=()=>nN(r,"cancel");r.addEventListener("keyup",i,n),r.addEventListener("blur",o,n)});r.addEventListener("keydown",s,n),r.addEventListener("blur",()=>r.removeEventListener("keydown",s),n)};function J5(t){return fA(t)&&!c7()}function rse(t,n,r={}){const[s,i,o]=d7(t,r),l=c=>{const d=c.currentTarget;if(!J5(c))return;jg.add(d);const u=n(d,c),h=(y,N)=>{window.removeEventListener("pointerup",m),window.removeEventListener("pointercancel",g),jg.has(d)&&jg.delete(d),J5(y)&&typeof u=="function"&&u(y,{success:N})},m=y=>{h(y,d===window||d===document||r.useGlobalTarget||u7(d,y.target))},g=y=>{h(y,!1)};window.addEventListener("pointerup",m,i),window.addEventListener("pointercancel",g,i)};return s.forEach(c=>{(r.useGlobalTarget?window:c).addEventListener("pointerdown",l,i),l7(c)&&(c.addEventListener("focus",u=>nse(u,i)),!tse(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),o}function f7(t){return SL(t)&&"ownerSVGElement"in t}function sse(t){return f7(t)&&t.tagName==="svg"}const Es=t=>!!(t&&t.getVelocity),ase=[...s7,vr,Tc],ise=t=>ase.find(r7(t)),hA=b.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function eI(t,n){if(typeof t=="function")return t(n);t!=null&&(t.current=n)}function ose(...t){return n=>{let r=!1;const s=t.map(i=>{const o=eI(i,n);return!r&&typeof o=="function"&&(r=!0),o});if(r)return()=>{for(let i=0;i<s.length;i++){const o=s[i];typeof o=="function"?o():eI(t[i],null)}}}}function lse(...t){return b.useCallback(ose(...t),t)}class cse extends b.Component{getSnapshotBeforeUpdate(n){const r=this.props.childRef.current;if(r&&n.isPresent&&!this.props.isPresent){const s=r.offsetParent,i=l7(s)&&s.offsetWidth||0,o=this.props.sizeRef.current;o.height=r.offsetHeight||0,o.width=r.offsetWidth||0,o.top=r.offsetTop,o.left=r.offsetLeft,o.right=i-o.width-o.left}return null}componentDidUpdate(){}render(){return this.props.children}}function dse({children:t,isPresent:n,anchorX:r,root:s}){const i=b.useId(),o=b.useRef(null),l=b.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=b.useContext(hA),d=lse(o,t==null?void 0:t.ref);return b.useInsertionEffect(()=>{const{width:u,height:h,top:m,left:g,right:y}=l.current;if(n||!o.current||!u||!h)return;const N=r==="left"?`left: ${g}`:`right: ${y}`;o.current.dataset.motionPopId=i;const j=document.createElement("style");c&&(j.nonce=c);const S=s??document.head;return S.appendChild(j),j.sheet&&j.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${u}px !important;
            height: ${h}px !important;
            ${N}px !important;
            top: ${m}px !important;
          }
        `),()=>{S.contains(j)&&S.removeChild(j)}},[n]),a.jsx(cse,{isPresent:n,childRef:o,sizeRef:l,children:b.cloneElement(t,{ref:d})})}const use=({children:t,initial:n,isPresent:r,onExitComplete:s,custom:i,presenceAffectsLayout:o,mode:l,anchorX:c,root:d})=>{const u=H_(fse),h=b.useId();let m=!0,g=b.useMemo(()=>(m=!1,{id:h,initial:n,isPresent:r,custom:i,onExitComplete:y=>{u.set(y,!0);for(const N of u.values())if(!N)return;s&&s()},register:y=>(u.set(y,!1),()=>u.delete(y))}),[r,u,s]);return o&&m&&(g={...g}),b.useMemo(()=>{u.forEach((y,N)=>u.set(N,!1))},[r]),b.useEffect(()=>{!r&&!u.size&&s&&s()},[r]),l==="popLayout"&&(t=a.jsx(dse,{isPresent:r,anchorX:c,root:d,children:t})),a.jsx(xv.Provider,{value:g,children:t})};function fse(){return new Map}function h7(t=!0){const n=b.useContext(xv);if(n===null)return[!0,null];const{isPresent:r,onExitComplete:s,register:i}=n,o=b.useId();b.useEffect(()=>{if(t)return i(o)},[t]);const l=b.useCallback(()=>t&&s&&s(o),[o,s,t]);return!r&&s?[!1,l]:[!0]}const p0=t=>t.key||"";function tI(t){const n=[];return b.Children.forEach(t,r=>{b.isValidElement(r)&&n.push(r)}),n}const su=({children:t,custom:n,initial:r=!0,onExitComplete:s,presenceAffectsLayout:i=!0,mode:o="sync",propagate:l=!1,anchorX:c="left",root:d})=>{const[u,h]=h7(l),m=b.useMemo(()=>tI(t),[t]),g=l&&!u?[]:m.map(p0),y=b.useRef(!0),N=b.useRef(m),j=H_(()=>new Map),[S,_]=b.useState(m),[A,k]=b.useState(m);NL(()=>{y.current=!1,N.current=m;for(let M=0;M<A.length;M++){const O=p0(A[M]);g.includes(O)?j.delete(O):j.get(O)!==!0&&j.set(O,!1)}},[A,g.length,g.join("-")]);const T=[];if(m!==S){let M=[...m];for(let O=0;O<A.length;O++){const D=A[O],L=p0(D);g.includes(L)||(M.splice(O,0,D),T.push(D))}return o==="wait"&&T.length&&(M=T),k(tI(M)),_(m),null}const{forceRender:P}=b.useContext(V_);return a.jsx(a.Fragment,{children:A.map(M=>{const O=p0(M),D=l&&!u?!1:m===A||g.includes(O),L=()=>{if(j.has(O))j.set(O,!0);else return;let $=!0;j.forEach(V=>{V||($=!1)}),$&&(P==null||P(),k(N.current),l&&(h==null||h()),s&&s())};return a.jsx(use,{isPresent:D,initial:!y.current||r?void 0:!1,custom:n,presenceAffectsLayout:i,mode:o,root:d,onExitComplete:D?void 0:L,anchorX:c,children:M},O)})})},m7=b.createContext({strict:!1}),nI={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Kf={};for(const t in nI)Kf[t]={isEnabled:n=>nI[t].some(r=>!!n[r])};function hse(t){for(const n in t)Kf[n]={...Kf[n],...t[n]}}const mse=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function _1(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||mse.has(t)}let p7=t=>!_1(t);function pse(t){typeof t=="function"&&(p7=n=>n.startsWith("on")?!_1(n):t(n))}try{pse(require("@emotion/is-prop-valid").default)}catch{}function xse(t,n,r){const s={};for(const i in t)i==="values"&&typeof t.values=="object"||(p7(i)||r===!0&&_1(i)||!n&&!_1(i)||t.draggable&&i.startsWith("onDrag"))&&(s[i]=t[i]);return s}const gv=b.createContext({});function yv(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function Cp(t){return typeof t=="string"||Array.isArray(t)}const mA=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],pA=["initial",...mA];function vv(t){return yv(t.animate)||pA.some(n=>Cp(t[n]))}function x7(t){return!!(vv(t)||t.variants)}function gse(t,n){if(vv(t)){const{initial:r,animate:s}=t;return{initial:r===!1||Cp(r)?r:void 0,animate:Cp(s)?s:void 0}}return t.inherit!==!1?n:{}}function yse(t){const{initial:n,animate:r}=gse(t,b.useContext(gv));return b.useMemo(()=>({initial:n,animate:r}),[rI(n),rI(r)])}function rI(t){return Array.isArray(t)?t.join(" "):t}const _p={};function vse(t){for(const n in t)_p[n]=t[n],J_(n)&&(_p[n].isCSSVariable=!0)}function g7(t,{layout:n,layoutId:r}){return bh.has(t)||t.startsWith("origin")||(n||r!==void 0)&&(!!_p[t]||t==="opacity")}const bse={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},wse=vh.length;function Nse(t,n,r){let s="",i=!0;for(let o=0;o<wse;o++){const l=vh[o],c=t[l];if(c===void 0)continue;let d=!0;if(typeof c=="number"?d=c===(l.startsWith("scale")?1:0):d=parseFloat(c)===0,!d||r){const u=o7(c,dA[l]);if(!d){i=!1;const h=bse[l]||l;s+=`${h}(${u}) `}r&&(n[l]=u)}}return s=s.trim(),r?s=r(n,i?"":s):i&&(s="none"),s}function xA(t,n,r){const{style:s,vars:i,transformOrigin:o}=t;let l=!1,c=!1;for(const d in n){const u=n[d];if(bh.has(d)){l=!0;continue}else if(J_(d)){i[d]=u;continue}else{const h=o7(u,dA[d]);d.startsWith("origin")?(c=!0,o[d]=h):s[d]=h}}if(n.transform||(l||r?s.transform=Nse(n,t.transform,r):s.transform&&(s.transform="none")),c){const{originX:d="50%",originY:u="50%",originZ:h=0}=o;s.transformOrigin=`${d} ${u} ${h}`}}const gA=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function y7(t,n,r){for(const s in n)!Es(n[s])&&!g7(s,r)&&(t[s]=n[s])}function jse({transformTemplate:t},n){return b.useMemo(()=>{const r=gA();return xA(r,n,t),Object.assign({},r.vars,r.style)},[n])}function Sse(t,n){const r=t.style||{},s={};return y7(s,r,t),Object.assign(s,jse(t,n)),s}function Cse(t,n){const r={},s=Sse(t,n);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=s,r}const _se={offset:"stroke-dashoffset",array:"stroke-dasharray"},Ase={offset:"strokeDashoffset",array:"strokeDasharray"};function Ese(t,n,r=1,s=0,i=!0){t.pathLength=1;const o=i?_se:Ase;t[o.offset]=kt.transform(-s);const l=kt.transform(n),c=kt.transform(r);t[o.array]=`${l} ${c}`}function v7(t,{attrX:n,attrY:r,attrScale:s,pathLength:i,pathSpacing:o=1,pathOffset:l=0,...c},d,u,h){if(xA(t,c,u),d){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:m,style:g}=t;m.transform&&(g.transform=m.transform,delete m.transform),(g.transform||m.transformOrigin)&&(g.transformOrigin=m.transformOrigin??"50% 50%",delete m.transformOrigin),g.transform&&(g.transformBox=(h==null?void 0:h.transformBox)??"fill-box",delete m.transformBox),n!==void 0&&(m.x=n),r!==void 0&&(m.y=r),s!==void 0&&(m.scale=s),i!==void 0&&Ese(m,i,o,l,!1)}const b7=()=>({...gA(),attrs:{}}),w7=t=>typeof t=="string"&&t.toLowerCase()==="svg";function kse(t,n,r,s){const i=b.useMemo(()=>{const o=b7();return v7(o,n,w7(s),t.transformTemplate,t.style),{...o.attrs,style:{...o.style}}},[n]);if(t.style){const o={};y7(o,t.style,t),i.style={...o,...i.style}}return i}const Tse=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function yA(t){return typeof t!="string"||t.includes("-")?!1:!!(Tse.indexOf(t)>-1||/[A-Z]/u.test(t))}function Ise(t,n,r,{latestValues:s},i,o=!1){const c=(yA(t)?kse:Cse)(n,s,i,t),d=xse(n,typeof t=="string",o),u=t!==b.Fragment?{...d,...c,ref:r}:{},{children:h}=n,m=b.useMemo(()=>Es(h)?h.get():h,[h]);return b.createElement(t,{...u,children:m})}function sI(t){const n=[{},{}];return t==null||t.values.forEach((r,s)=>{n[0][s]=r.get(),n[1][s]=r.getVelocity()}),n}function vA(t,n,r,s){if(typeof n=="function"){const[i,o]=sI(s);n=n(r!==void 0?r:t.custom,i,o)}if(typeof n=="string"&&(n=t.variants&&t.variants[n]),typeof n=="function"){const[i,o]=sI(s);n=n(r!==void 0?r:t.custom,i,o)}return n}function Sg(t){return Es(t)?t.get():t}function Pse({scrapeMotionValuesFromProps:t,createRenderState:n},r,s,i){return{latestValues:Mse(r,s,i,t),renderState:n()}}function Mse(t,n,r,s){const i={},o=s(t,{});for(const g in o)i[g]=Sg(o[g]);let{initial:l,animate:c}=t;const d=vv(t),u=x7(t);n&&u&&!d&&t.inherit!==!1&&(l===void 0&&(l=n.initial),c===void 0&&(c=n.animate));let h=r?r.initial===!1:!1;h=h||l===!1;const m=h?c:l;if(m&&typeof m!="boolean"&&!yv(m)){const g=Array.isArray(m)?m:[m];for(let y=0;y<g.length;y++){const N=vA(t,g[y]);if(N){const{transitionEnd:j,transition:S,..._}=N;for(const A in _){let k=_[A];if(Array.isArray(k)){const T=h?k.length-1:0;k=k[T]}k!==null&&(i[A]=k)}for(const A in j)i[A]=j[A]}}}return i}const N7=t=>(n,r)=>{const s=b.useContext(gv),i=b.useContext(xv),o=()=>Pse(t,n,s,i);return r?o():H_(o)};function bA(t,n,r){var o;const{style:s}=t,i={};for(const l in s)(Es(s[l])||n.style&&Es(n.style[l])||g7(l,t)||((o=r==null?void 0:r.getValue(l))==null?void 0:o.liveStyle)!==void 0)&&(i[l]=s[l]);return i}const Ose=N7({scrapeMotionValuesFromProps:bA,createRenderState:gA});function j7(t,n,r){const s=bA(t,n,r);for(const i in t)if(Es(t[i])||Es(n[i])){const o=vh.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;s[o]=t[i]}return s}const Dse=N7({scrapeMotionValuesFromProps:j7,createRenderState:b7}),Rse=Symbol.for("motionComponentSymbol");function hf(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function Lse(t,n,r){return b.useCallback(s=>{s&&t.onMount&&t.onMount(s),n&&(s?n.mount(s):n.unmount()),r&&(typeof r=="function"?r(s):hf(r)&&(r.current=s))},[n])}const wA=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Bse="framerAppearId",S7="data-"+wA(Bse),C7=b.createContext({});function Fse(t,n,r,s,i){var j,S;const{visualElement:o}=b.useContext(gv),l=b.useContext(m7),c=b.useContext(xv),d=b.useContext(hA).reducedMotion,u=b.useRef(null);s=s||l.renderer,!u.current&&s&&(u.current=s(t,{visualState:n,parent:o,props:r,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:d}));const h=u.current,m=b.useContext(C7);h&&!h.projection&&i&&(h.type==="html"||h.type==="svg")&&$se(u.current,r,i,m);const g=b.useRef(!1);b.useInsertionEffect(()=>{h&&g.current&&h.update(r,c)});const y=r[S7],N=b.useRef(!!y&&!((j=window.MotionHandoffIsComplete)!=null&&j.call(window,y))&&((S=window.MotionHasOptimisedAnimation)==null?void 0:S.call(window,y)));return NL(()=>{h&&(g.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),h.scheduleRenderMicrotask(),N.current&&h.animationState&&h.animationState.animateChanges())}),b.useEffect(()=>{h&&(!N.current&&h.animationState&&h.animationState.animateChanges(),N.current&&(queueMicrotask(()=>{var _;(_=window.MotionHandoffMarkAsComplete)==null||_.call(window,y)}),N.current=!1),h.enteringChildren=void 0)}),h}function $se(t,n,r,s){const{layoutId:i,layout:o,drag:l,dragConstraints:c,layoutScroll:d,layoutRoot:u,layoutCrossfade:h}=n;t.projection=new r(t.latestValues,n["data-framer-portal-id"]?void 0:_7(t.parent)),t.projection.setOptions({layoutId:i,layout:o,alwaysMeasureLayout:!!l||c&&hf(c),visualElement:t,animationType:typeof o=="string"?o:"both",initialPromotionConfig:s,crossfade:h,layoutScroll:d,layoutRoot:u})}function _7(t){if(t)return t.options.allowProjection!==!1?t.projection:_7(t.parent)}function rN(t,{forwardMotionProps:n=!1}={},r,s){r&&hse(r);const i=yA(t)?Dse:Ose;function o(c,d){let u;const h={...b.useContext(hA),...c,layoutId:zse(c)},{isStatic:m}=h,g=yse(c),y=i(c,m);if(!m&&W_){Use();const N=Vse(h);u=N.MeasureLayout,g.visualElement=Fse(t,y,h,s,N.ProjectionNode)}return a.jsxs(gv.Provider,{value:g,children:[u&&g.visualElement?a.jsx(u,{visualElement:g.visualElement,...h}):null,Ise(t,c,Lse(y,g.visualElement,d),y,m,n)]})}o.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const l=b.forwardRef(o);return l[Rse]=t,l}function zse({layoutId:t}){const n=b.useContext(V_).id;return n&&t!==void 0?n+"-"+t:t}function Use(t,n){b.useContext(m7).strict}function Vse(t){const{drag:n,layout:r}=Kf;if(!n&&!r)return{};const s={...n,...r};return{MeasureLayout:n!=null&&n.isEnabled(t)||r!=null&&r.isEnabled(t)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}function Hse(t,n){if(typeof Proxy>"u")return rN;const r=new Map,s=(o,l)=>rN(o,l,t,n),i=(o,l)=>s(o,l);return new Proxy(i,{get:(o,l)=>l==="create"?s:(r.has(l)||r.set(l,rN(l,void 0,t,n)),r.get(l))})}function A7({top:t,left:n,right:r,bottom:s}){return{x:{min:n,max:r},y:{min:t,max:s}}}function Wse({x:t,y:n}){return{top:n.min,right:t.max,bottom:n.max,left:t.min}}function qse(t,n){if(!n)return t;const r=n({x:t.left,y:t.top}),s=n({x:t.right,y:t.bottom});return{top:r.y,left:r.x,bottom:s.y,right:s.x}}function sN(t){return t===void 0||t===1}function Jj({scale:t,scaleX:n,scaleY:r}){return!sN(t)||!sN(n)||!sN(r)}function md(t){return Jj(t)||E7(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function E7(t){return aI(t.x)||aI(t.y)}function aI(t){return t&&t!=="0%"}function A1(t,n,r){const s=t-r,i=n*s;return r+i}function iI(t,n,r,s,i){return i!==void 0&&(t=A1(t,i,s)),A1(t,r,s)+n}function eS(t,n=0,r=1,s,i){t.min=iI(t.min,n,r,s,i),t.max=iI(t.max,n,r,s,i)}function k7(t,{x:n,y:r}){eS(t.x,n.translate,n.scale,n.originPoint),eS(t.y,r.translate,r.scale,r.originPoint)}const oI=.999999999999,lI=1.0000000000001;function Gse(t,n,r,s=!1){const i=r.length;if(!i)return;n.x=n.y=1;let o,l;for(let c=0;c<i;c++){o=r[c],l=o.projectionDelta;const{visualElement:d}=o.options;d&&d.props.style&&d.props.style.display==="contents"||(s&&o.options.layoutScroll&&o.scroll&&o!==o.root&&pf(t,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),l&&(n.x*=l.x.scale,n.y*=l.y.scale,k7(t,l)),s&&md(o.latestValues)&&pf(t,o.latestValues))}n.x<lI&&n.x>oI&&(n.x=1),n.y<lI&&n.y>oI&&(n.y=1)}function mf(t,n){t.min=t.min+n,t.max=t.max+n}function cI(t,n,r,s,i=.5){const o=Yn(t.min,t.max,i);eS(t,n,r,o,s)}function pf(t,n){cI(t.x,n.x,n.scaleX,n.scale,n.originX),cI(t.y,n.y,n.scaleY,n.scale,n.originY)}function T7(t,n){return A7(qse(t.getBoundingClientRect(),n))}function Kse(t,n,r){const s=T7(t,r),{scroll:i}=n;return i&&(mf(s.x,i.offset.x),mf(s.y,i.offset.y)),s}const dI=()=>({translate:0,scale:1,origin:0,originPoint:0}),xf=()=>({x:dI(),y:dI()}),uI=()=>({min:0,max:0}),mr=()=>({x:uI(),y:uI()}),tS={current:null},I7={current:!1};function Yse(){if(I7.current=!0,!!W_)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),n=()=>tS.current=t.matches;t.addEventListener("change",n),n()}else tS.current=!1}const Xse=new WeakMap;function Qse(t,n,r){for(const s in n){const i=n[s],o=r[s];if(Es(i))t.addValue(s,i);else if(Es(o))t.addValue(s,Gf(i,{owner:t}));else if(o!==i)if(t.hasValue(s)){const l=t.getValue(s);l.liveStyle===!0?l.jump(i):l.hasAnimated||l.set(i)}else{const l=t.getStaticValue(s);t.addValue(s,Gf(l!==void 0?l:i,{owner:t}))}}for(const s in r)n[s]===void 0&&t.removeValue(s);return n}const fI=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Zse{scrapeMotionValuesFromProps(n,r,s){return{}}constructor({parent:n,props:r,presenceContext:s,reducedMotionConfig:i,blockInitialAnimation:o,visualState:l},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=lA,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const g=ia.now();this.renderScheduledAt<g&&(this.renderScheduledAt=g,zn.render(this.render,!1,!0))};const{latestValues:d,renderState:u}=l;this.latestValues=d,this.baseTarget={...d},this.initialValues=r.initial?{...d}:{},this.renderState=u,this.parent=n,this.props=r,this.presenceContext=s,this.depth=n?n.depth+1:0,this.reducedMotionConfig=i,this.options=c,this.blockInitialAnimation=!!o,this.isControllingVariants=vv(r),this.isVariantNode=x7(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(n&&n.current);const{willChange:h,...m}=this.scrapeMotionValuesFromProps(r,{},this);for(const g in m){const y=m[g];d[g]!==void 0&&Es(y)&&y.set(d[g])}}mount(n){var r;this.current=n,Xse.set(n,this),this.projection&&!this.projection.instance&&this.projection.mount(n),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,i)=>this.bindToMotionValue(i,s)),I7.current||Yse(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:tS.current,(r=this.parent)==null||r.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var n;this.projection&&this.projection.unmount(),kc(this.notifyUpdate),kc(this.render),this.valueSubscriptions.forEach(r=>r()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(n=this.parent)==null||n.removeChild(this);for(const r in this.events)this.events[r].clear();for(const r in this.features){const s=this.features[r];s&&(s.unmount(),s.isMounted=!1)}this.current=null}addChild(n){this.children.add(n),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(n)}removeChild(n){this.children.delete(n),this.enteringChildren&&this.enteringChildren.delete(n)}bindToMotionValue(n,r){this.valueSubscriptions.has(n)&&this.valueSubscriptions.get(n)();const s=bh.has(n);s&&this.onBindTransform&&this.onBindTransform();const i=r.on("change",l=>{this.latestValues[n]=l,this.props.onUpdate&&zn.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,n,r)),this.valueSubscriptions.set(n,()=>{i(),o&&o(),r.owner&&r.stop()})}sortNodePosition(n){return!this.current||!this.sortInstanceNodePosition||this.type!==n.type?0:this.sortInstanceNodePosition(this.current,n.current)}updateFeatures(){let n="animation";for(n in Kf){const r=Kf[n];if(!r)continue;const{isEnabled:s,Feature:i}=r;if(!this.features[n]&&i&&s(this.props)&&(this.features[n]=new i(this)),this.features[n]){const o=this.features[n];o.isMounted?o.update():(o.mount(),o.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):mr()}getStaticValue(n){return this.latestValues[n]}setStaticValue(n,r){this.latestValues[n]=r}update(n,r){(n.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=n,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let s=0;s<fI.length;s++){const i=fI[s];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const o="on"+i,l=n[o];l&&(this.propEventSubscriptions[i]=this.on(i,l))}this.prevMotionValues=Qse(this,this.scrapeMotionValuesFromProps(n,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(n){return this.props.variants?this.props.variants[n]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(n){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(n),()=>r.variantChildren.delete(n)}addValue(n,r){const s=this.values.get(n);r!==s&&(s&&this.removeValue(n),this.bindToMotionValue(n,r),this.values.set(n,r),this.latestValues[n]=r.get())}removeValue(n){this.values.delete(n);const r=this.valueSubscriptions.get(n);r&&(r(),this.valueSubscriptions.delete(n)),delete this.latestValues[n],this.removeValueFromRenderState(n,this.renderState)}hasValue(n){return this.values.has(n)}getValue(n,r){if(this.props.values&&this.props.values[n])return this.props.values[n];let s=this.values.get(n);return s===void 0&&r!==void 0&&(s=Gf(r===null?void 0:r,{owner:this}),this.addValue(n,s)),s}readValue(n,r){let s=this.latestValues[n]!==void 0||!this.current?this.latestValues[n]:this.getBaseTargetFromProps(this.props,n)??this.readValueFromInstance(this.current,n,this.options);return s!=null&&(typeof s=="string"&&(jL(s)||CL(s))?s=parseFloat(s):!ise(s)&&Tc.test(r)&&(s=i7(n,r)),this.setBaseTarget(n,Es(s)?s.get():s)),Es(s)?s.get():s}setBaseTarget(n,r){this.baseTarget[n]=r}getBaseTarget(n){var o;const{initial:r}=this.props;let s;if(typeof r=="string"||typeof r=="object"){const l=vA(this.props,r,(o=this.presenceContext)==null?void 0:o.custom);l&&(s=l[n])}if(r&&s!==void 0)return s;const i=this.getBaseTargetFromProps(this.props,n);return i!==void 0&&!Es(i)?i:this.initialValues[n]!==void 0&&s===void 0?void 0:this.baseTarget[n]}on(n,r){return this.events[n]||(this.events[n]=new X_),this.events[n].add(r)}notify(n,...r){this.events[n]&&this.events[n].notify(...r)}scheduleRenderMicrotask(){uA.render(this.render)}}class P7 extends Zse{constructor(){super(...arguments),this.KeyframeResolver=Kre}sortInstanceNodePosition(n,r){return n.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(n,r){return n.style?n.style[r]:void 0}removeValueFromRenderState(n,{vars:r,style:s}){delete r[n],delete s[n]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:n}=this.props;Es(n)&&(this.childSubscription=n.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function M7(t,{style:n,vars:r},s,i){const o=t.style;let l;for(l in n)o[l]=n[l];i==null||i.applyProjectionStyles(o,s);for(l in r)o.setProperty(l,r[l])}function Jse(t){return window.getComputedStyle(t)}class eae extends P7{constructor(){super(...arguments),this.type="html",this.renderInstance=M7}readValueFromInstance(n,r){var s;if(bh.has(r))return(s=this.projection)!=null&&s.isProjecting?qj(r):hre(n,r);{const i=Jse(n),o=(J_(r)?i.getPropertyValue(r):i[r])||0;return typeof o=="string"?o.trim():o}}measureInstanceViewportBox(n,{transformPagePoint:r}){return T7(n,r)}build(n,r,s){xA(n,r,s.transformTemplate)}scrapeMotionValuesFromProps(n,r,s){return bA(n,r,s)}}const O7=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function tae(t,n,r,s){M7(t,n,void 0,s);for(const i in n.attrs)t.setAttribute(O7.has(i)?i:wA(i),n.attrs[i])}class nae extends P7{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=mr}getBaseTargetFromProps(n,r){return n[r]}readValueFromInstance(n,r){if(bh.has(r)){const s=a7(r);return s&&s.default||0}return r=O7.has(r)?r:wA(r),n.getAttribute(r)}scrapeMotionValuesFromProps(n,r,s){return j7(n,r,s)}build(n,r,s){v7(n,r,this.isSVGTag,s.transformTemplate,s.style)}renderInstance(n,r,s,i){tae(n,r,s,i)}mount(n){this.isSVGTag=w7(n.tagName),super.mount(n)}}const rae=(t,n)=>yA(t)?new nae(n):new eae(n,{allowProjection:t!==b.Fragment});function Ef(t,n,r){const s=t.getProps();return vA(s,n,r!==void 0?r:s.custom,t)}const nS=t=>Array.isArray(t);function sae(t,n,r){t.hasValue(n)?t.getValue(n).set(r):t.addValue(n,Gf(r))}function aae(t){return nS(t)?t[t.length-1]||0:t}function iae(t,n){const r=Ef(t,n);let{transitionEnd:s={},transition:i={},...o}=r||{};o={...o,...s};for(const l in o){const c=aae(o[l]);sae(t,l,c)}}function oae(t){return!!(Es(t)&&t.add)}function rS(t,n){const r=t.getValue("willChange");if(oae(r))return r.add(n);if(!r&&ml.WillChange){const s=new ml.WillChange("auto");t.addValue("willChange",s),s.add(n)}}function D7(t){return t.props[S7]}const lae=t=>t!==null;function cae(t,{repeat:n,repeatType:r="loop"},s){const i=t.filter(lae),o=n&&r!=="loop"&&n%2===1?0:i.length-1;return i[o]}const dae={type:"spring",stiffness:500,damping:25,restSpeed:10},uae=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),fae={type:"keyframes",duration:.8},hae={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},mae=(t,{keyframes:n})=>n.length>2?fae:bh.has(t)?t.startsWith("scale")?uae(n[1]):dae:hae;function pae({when:t,delay:n,delayChildren:r,staggerChildren:s,staggerDirection:i,repeat:o,repeatType:l,repeatDelay:c,from:d,elapsed:u,...h}){return!!Object.keys(h).length}const NA=(t,n,r,s={},i,o)=>l=>{const c=cA(s,t)||{},d=c.delay||s.delay||0;let{elapsed:u=0}=s;u=u-vo(d);const h={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:n.getVelocity(),...c,delay:-u,onUpdate:g=>{n.set(g),c.onUpdate&&c.onUpdate(g)},onComplete:()=>{l(),c.onComplete&&c.onComplete()},name:t,motionValue:n,element:o?void 0:i};pae(c)||Object.assign(h,mae(t,h)),h.duration&&(h.duration=vo(h.duration)),h.repeatDelay&&(h.repeatDelay=vo(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let m=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(Qj(h),h.delay===0&&(m=!0)),(ml.instantAnimations||ml.skipAnimations)&&(m=!0,Qj(h),h.delay=0),h.allowFlatten=!c.type&&!c.ease,m&&!o&&n.get()!==void 0){const g=cae(h.keyframes,c);if(g!==void 0){zn.update(()=>{h.onUpdate(g),h.onComplete()});return}}return c.isSync?new oA(h):new Rre(h)};function xae({protectedKeys:t,needsAnimating:n},r){const s=t.hasOwnProperty(r)&&n[r]!==!0;return n[r]=!1,s}function R7(t,n,{delay:r=0,transitionOverride:s,type:i}={}){let{transition:o=t.getDefaultTransition(),transitionEnd:l,...c}=n;s&&(o=s);const d=[],u=i&&t.animationState&&t.animationState.getState()[i];for(const h in c){const m=t.getValue(h,t.latestValues[h]??null),g=c[h];if(g===void 0||u&&xae(u,h))continue;const y={delay:r,...cA(o||{},h)},N=m.get();if(N!==void 0&&!m.isAnimating&&!Array.isArray(g)&&g===N&&!y.velocity)continue;let j=!1;if(window.MotionHandoffAnimation){const _=D7(t);if(_){const A=window.MotionHandoffAnimation(_,h,zn);A!==null&&(y.startTime=A,j=!0)}}rS(t,h),m.start(NA(h,m,g,t.shouldReduceMotion&&n7.has(h)?{type:!1}:y,t,j));const S=m.animation;S&&d.push(S)}return l&&Promise.all(d).then(()=>{zn.update(()=>{l&&iae(t,l)})}),d}function L7(t,n,r,s=0,i=1){const o=Array.from(t).sort((u,h)=>u.sortNodePosition(h)).indexOf(n),l=t.size,c=(l-1)*s;return typeof r=="function"?r(o,l):i===1?o*s:c-o*s}function sS(t,n,r={}){var d;const s=Ef(t,n,r.type==="exit"?(d=t.presenceContext)==null?void 0:d.custom:void 0);let{transition:i=t.getDefaultTransition()||{}}=s||{};r.transitionOverride&&(i=r.transitionOverride);const o=s?()=>Promise.all(R7(t,s,r)):()=>Promise.resolve(),l=t.variantChildren&&t.variantChildren.size?(u=0)=>{const{delayChildren:h=0,staggerChildren:m,staggerDirection:g}=i;return gae(t,n,u,h,m,g,r)}:()=>Promise.resolve(),{when:c}=i;if(c){const[u,h]=c==="beforeChildren"?[o,l]:[l,o];return u().then(()=>h())}else return Promise.all([o(),l(r.delay)])}function gae(t,n,r=0,s=0,i=0,o=1,l){const c=[];for(const d of t.variantChildren)d.notify("AnimationStart",n),c.push(sS(d,n,{...l,delay:r+(typeof s=="function"?0:s)+L7(t.variantChildren,d,s,i,o)}).then(()=>d.notify("AnimationComplete",n)));return Promise.all(c)}function yae(t,n,r={}){t.notify("AnimationStart",n);let s;if(Array.isArray(n)){const i=n.map(o=>sS(t,o,r));s=Promise.all(i)}else if(typeof n=="string")s=sS(t,n,r);else{const i=typeof n=="function"?Ef(t,n,r.custom):n;s=Promise.all(R7(t,i,r))}return s.then(()=>{t.notify("AnimationComplete",n)})}function B7(t,n){if(!Array.isArray(n))return!1;const r=n.length;if(r!==t.length)return!1;for(let s=0;s<r;s++)if(n[s]!==t[s])return!1;return!0}const vae=pA.length;function F7(t){if(!t)return;if(!t.isControllingVariants){const r=t.parent?F7(t.parent)||{}:{};return t.props.initial!==void 0&&(r.initial=t.props.initial),r}const n={};for(let r=0;r<vae;r++){const s=pA[r],i=t.props[s];(Cp(i)||i===!1)&&(n[s]=i)}return n}const bae=[...mA].reverse(),wae=mA.length;function Nae(t){return n=>Promise.all(n.map(({animation:r,options:s})=>yae(t,r,s)))}function jae(t){let n=Nae(t),r=hI(),s=!0;const i=d=>(u,h)=>{var g;const m=Ef(t,h,d==="exit"?(g=t.presenceContext)==null?void 0:g.custom:void 0);if(m){const{transition:y,transitionEnd:N,...j}=m;u={...u,...j,...N}}return u};function o(d){n=d(t)}function l(d){const{props:u}=t,h=F7(t.parent)||{},m=[],g=new Set;let y={},N=1/0;for(let S=0;S<wae;S++){const _=bae[S],A=r[_],k=u[_]!==void 0?u[_]:h[_],T=Cp(k),P=_===d?A.isActive:null;P===!1&&(N=S);let M=k===h[_]&&k!==u[_]&&T;if(M&&s&&t.manuallyAnimateOnMount&&(M=!1),A.protectedKeys={...y},!A.isActive&&P===null||!k&&!A.prevProp||yv(k)||typeof k=="boolean")continue;const O=Sae(A.prevProp,k);let D=O||_===d&&A.isActive&&!M&&T||S>N&&T,L=!1;const $=Array.isArray(k)?k:[k];let V=$.reduce(i(_),{});P===!1&&(V={});const{prevResolvedValues:F={}}=A,Q={...F,...V},U=K=>{D=!0,g.has(K)&&(L=!0,g.delete(K)),A.needsAnimating[K]=!0;const X=t.getValue(K);X&&(X.liveStyle=!1)};for(const K in Q){const X=V[K],J=F[K];if(y.hasOwnProperty(K))continue;let ne=!1;nS(X)&&nS(J)?ne=!B7(X,J):ne=X!==J,ne?X!=null?U(K):g.add(K):X!==void 0&&g.has(K)?U(K):A.protectedKeys[K]=!0}A.prevProp=k,A.prevResolvedValues=V,A.isActive&&(y={...y,...V}),s&&t.blockInitialAnimation&&(D=!1);const z=M&&O;D&&(!z||L)&&m.push(...$.map(K=>{const X={type:_};if(typeof K=="string"&&s&&!z&&t.manuallyAnimateOnMount&&t.parent){const{parent:J}=t,ne=Ef(J,K);if(J.enteringChildren&&ne){const{delayChildren:Se}=ne.transition||{};X.delay=L7(J.enteringChildren,t,Se)}}return{animation:K,options:X}}))}if(g.size){const S={};if(typeof u.initial!="boolean"){const _=Ef(t,Array.isArray(u.initial)?u.initial[0]:u.initial);_&&_.transition&&(S.transition=_.transition)}g.forEach(_=>{const A=t.getBaseTarget(_),k=t.getValue(_);k&&(k.liveStyle=!0),S[_]=A??null}),m.push({animation:S})}let j=!!m.length;return s&&(u.initial===!1||u.initial===u.animate)&&!t.manuallyAnimateOnMount&&(j=!1),s=!1,j?n(m):Promise.resolve()}function c(d,u){var m;if(r[d].isActive===u)return Promise.resolve();(m=t.variantChildren)==null||m.forEach(g=>{var y;return(y=g.animationState)==null?void 0:y.setActive(d,u)}),r[d].isActive=u;const h=l(d);for(const g in r)r[g].protectedKeys={};return h}return{animateChanges:l,setActive:c,setAnimateFunction:o,getState:()=>r,reset:()=>{r=hI()}}}function Sae(t,n){return typeof n=="string"?n!==t:Array.isArray(n)?!B7(n,t):!1}function ld(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function hI(){return{animate:ld(!0),whileInView:ld(),whileHover:ld(),whileTap:ld(),whileDrag:ld(),whileFocus:ld(),exit:ld()}}class Wc{constructor(n){this.isMounted=!1,this.node=n}update(){}}class Cae extends Wc{constructor(n){super(n),n.animationState||(n.animationState=jae(n))}updateAnimationControlsSubscription(){const{animate:n}=this.node.getProps();yv(n)&&(this.unmountControls=n.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:n}=this.node.getProps(),{animate:r}=this.node.prevProps||{};n!==r&&this.updateAnimationControlsSubscription()}unmount(){var n;this.node.animationState.reset(),(n=this.unmountControls)==null||n.call(this)}}let _ae=0;class Aae extends Wc{constructor(){super(...arguments),this.id=_ae++}update(){if(!this.node.presenceContext)return;const{isPresent:n,onExitComplete:r}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||n===s)return;const i=this.node.animationState.setActive("exit",!n);r&&!n&&i.then(()=>{r(this.id)})}mount(){const{register:n,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),n&&(this.unmount=n(this.id))}unmount(){}}const Eae={animation:{Feature:Cae},exit:{Feature:Aae}};function Ap(t,n,r,s={passive:!0}){return t.addEventListener(n,r,s),()=>t.removeEventListener(n,r)}function mx(t){return{point:{x:t.pageX,y:t.pageY}}}const kae=t=>n=>fA(n)&&t(n,mx(n));function Hm(t,n,r,s){return Ap(t,n,kae(r),s)}const $7=1e-4,Tae=1-$7,Iae=1+$7,z7=.01,Pae=0-z7,Mae=0+z7;function Vs(t){return t.max-t.min}function Oae(t,n,r){return Math.abs(t-n)<=r}function mI(t,n,r,s=.5){t.origin=s,t.originPoint=Yn(n.min,n.max,t.origin),t.scale=Vs(r)/Vs(n),t.translate=Yn(r.min,r.max,t.origin)-t.originPoint,(t.scale>=Tae&&t.scale<=Iae||isNaN(t.scale))&&(t.scale=1),(t.translate>=Pae&&t.translate<=Mae||isNaN(t.translate))&&(t.translate=0)}function Wm(t,n,r,s){mI(t.x,n.x,r.x,s?s.originX:void 0),mI(t.y,n.y,r.y,s?s.originY:void 0)}function pI(t,n,r){t.min=r.min+n.min,t.max=t.min+Vs(n)}function Dae(t,n,r){pI(t.x,n.x,r.x),pI(t.y,n.y,r.y)}function xI(t,n,r){t.min=n.min-r.min,t.max=t.min+Vs(n)}function qm(t,n,r){xI(t.x,n.x,r.x),xI(t.y,n.y,r.y)}function ei(t){return[t("x"),t("y")]}const U7=({current:t})=>t?t.ownerDocument.defaultView:null,gI=(t,n)=>Math.abs(t-n);function Rae(t,n){const r=gI(t.x,n.x),s=gI(t.y,n.y);return Math.sqrt(r**2+s**2)}class V7{constructor(n,r,{transformPagePoint:s,contextWindow:i=window,dragSnapToOrigin:o=!1,distanceThreshold:l=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=iN(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,N=Rae(g.offset,{x:0,y:0})>=this.distanceThreshold;if(!y&&!N)return;const{point:j}=g,{timestamp:S}=hs;this.history.push({...j,timestamp:S});const{onStart:_,onMove:A}=this.handlers;y||(_&&_(this.lastMoveEvent,g),this.startEvent=this.lastMoveEvent),A&&A(this.lastMoveEvent,g)},this.handlePointerMove=(g,y)=>{this.lastMoveEvent=g,this.lastMoveEventInfo=aN(y,this.transformPagePoint),zn.update(this.updatePoint,!0)},this.handlePointerUp=(g,y)=>{this.end();const{onEnd:N,onSessionEnd:j,resumeAnimation:S}=this.handlers;if(this.dragSnapToOrigin&&S&&S(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const _=iN(g.type==="pointercancel"?this.lastMoveEventInfo:aN(y,this.transformPagePoint),this.history);this.startEvent&&N&&N(g,_),j&&j(g,_)},!fA(n))return;this.dragSnapToOrigin=o,this.handlers=r,this.transformPagePoint=s,this.distanceThreshold=l,this.contextWindow=i||window;const c=mx(n),d=aN(c,this.transformPagePoint),{point:u}=d,{timestamp:h}=hs;this.history=[{...u,timestamp:h}];const{onSessionStart:m}=r;m&&m(n,iN(d,this.history)),this.removeListeners=ux(Hm(this.contextWindow,"pointermove",this.handlePointerMove),Hm(this.contextWindow,"pointerup",this.handlePointerUp),Hm(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(n){this.handlers=n}end(){this.removeListeners&&this.removeListeners(),kc(this.updatePoint)}}function aN(t,n){return n?{point:n(t.point)}:t}function yI(t,n){return{x:t.x-n.x,y:t.y-n.y}}function iN({point:t},n){return{point:t,delta:yI(t,H7(n)),offset:yI(t,Lae(n)),velocity:Bae(n,.1)}}function Lae(t){return t[0]}function H7(t){return t[t.length-1]}function Bae(t,n){if(t.length<2)return{x:0,y:0};let r=t.length-1,s=null;const i=H7(t);for(;r>=0&&(s=t[r],!(i.timestamp-s.timestamp>vo(n)));)r--;if(!s)return{x:0,y:0};const o=ii(i.timestamp-s.timestamp);if(o===0)return{x:0,y:0};const l={x:(i.x-s.x)/o,y:(i.y-s.y)/o};return l.x===1/0&&(l.x=0),l.y===1/0&&(l.y=0),l}function Fae(t,{min:n,max:r},s){return n!==void 0&&t<n?t=s?Yn(n,t,s.min):Math.max(t,n):r!==void 0&&t>r&&(t=s?Yn(r,t,s.max):Math.min(t,r)),t}function vI(t,n,r){return{min:n!==void 0?t.min+n:void 0,max:r!==void 0?t.max+r-(t.max-t.min):void 0}}function $ae(t,{top:n,left:r,bottom:s,right:i}){return{x:vI(t.x,r,i),y:vI(t.y,n,s)}}function bI(t,n){let r=n.min-t.min,s=n.max-t.max;return n.max-n.min<t.max-t.min&&([r,s]=[s,r]),{min:r,max:s}}function zae(t,n){return{x:bI(t.x,n.x),y:bI(t.y,n.y)}}function Uae(t,n){let r=.5;const s=Vs(t),i=Vs(n);return i>s?r=Np(n.min,n.max-s,t.min):s>i&&(r=Np(t.min,t.max-i,n.min)),hl(0,1,r)}function Vae(t,n){const r={};return n.min!==void 0&&(r.min=n.min-t.min),n.max!==void 0&&(r.max=n.max-t.min),r}const aS=.35;function Hae(t=aS){return t===!1?t=0:t===!0&&(t=aS),{x:wI(t,"left","right"),y:wI(t,"top","bottom")}}function wI(t,n,r){return{min:NI(t,n),max:NI(t,r)}}function NI(t,n){return typeof t=="number"?t:t[n]||0}const Wae=new WeakMap;class qae{constructor(n){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=mr(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=n}start(n,{snapToCursor:r=!1,distanceThreshold:s}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const o=m=>{const{dragSnapToOrigin:g}=this.getProps();g?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(mx(m).point)},l=(m,g)=>{const{drag:y,dragPropagation:N,onDragStart:j}=this.getProps();if(y&&!N&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Zre(y),!this.openDragLock))return;this.latestPointerEvent=m,this.latestPanInfo=g,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ei(_=>{let A=this.getAxisMotionValue(_).get()||0;if(bo.test(A)){const{projection:k}=this.visualElement;if(k&&k.layout){const T=k.layout.layoutBox[_];T&&(A=Vs(T)*(parseFloat(A)/100))}}this.originPoint[_]=A}),j&&zn.postRender(()=>j(m,g)),rS(this.visualElement,"transform");const{animationState:S}=this.visualElement;S&&S.setActive("whileDrag",!0)},c=(m,g)=>{this.latestPointerEvent=m,this.latestPanInfo=g;const{dragPropagation:y,dragDirectionLock:N,onDirectionLock:j,onDrag:S}=this.getProps();if(!y&&!this.openDragLock)return;const{offset:_}=g;if(N&&this.currentDirection===null){this.currentDirection=Gae(_),this.currentDirection!==null&&j&&j(this.currentDirection);return}this.updateAxis("x",g.point,_),this.updateAxis("y",g.point,_),this.visualElement.render(),S&&S(m,g)},d=(m,g)=>{this.latestPointerEvent=m,this.latestPanInfo=g,this.stop(m,g),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>ei(m=>{var g;return this.getAnimationState(m)==="paused"&&((g=this.getAxisMotionValue(m).animation)==null?void 0:g.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new V7(n,{onSessionStart:o,onStart:l,onMove:c,onSessionEnd:d,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,distanceThreshold:s,contextWindow:U7(this.visualElement)})}stop(n,r){const s=n||this.latestPointerEvent,i=r||this.latestPanInfo,o=this.isDragging;if(this.cancel(),!o||!i||!s)return;const{velocity:l}=i;this.startAnimation(l);const{onDragEnd:c}=this.getProps();c&&zn.postRender(()=>c(s,i))}cancel(){this.isDragging=!1;const{projection:n,animationState:r}=this.visualElement;n&&(n.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(n,r,s){const{drag:i}=this.getProps();if(!s||!x0(n,i,this.currentDirection))return;const o=this.getAxisMotionValue(n);let l=this.originPoint[n]+s[n];this.constraints&&this.constraints[n]&&(l=Fae(l,this.constraints[n],this.elastic[n])),o.set(l)}resolveConstraints(){var o;const{dragConstraints:n,dragElastic:r}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(o=this.visualElement.projection)==null?void 0:o.layout,i=this.constraints;n&&hf(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&s?this.constraints=$ae(s.layoutBox,n):this.constraints=!1,this.elastic=Hae(r),i!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&ei(l=>{this.constraints!==!1&&this.getAxisMotionValue(l)&&(this.constraints[l]=Vae(s.layoutBox[l],this.constraints[l]))})}resolveRefConstraints(){const{dragConstraints:n,onMeasureDragConstraints:r}=this.getProps();if(!n||!hf(n))return!1;const s=n.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const o=Kse(s,i.root,this.visualElement.getTransformPagePoint());let l=zae(i.layout.layoutBox,o);if(r){const c=r(Wse(l));this.hasMutatedConstraints=!!c,c&&(l=A7(c))}return l}startAnimation(n){const{drag:r,dragMomentum:s,dragElastic:i,dragTransition:o,dragSnapToOrigin:l,onDragTransitionEnd:c}=this.getProps(),d=this.constraints||{},u=ei(h=>{if(!x0(h,r,this.currentDirection))return;let m=d&&d[h]||{};l&&(m={min:0,max:0});const g=i?200:1e6,y=i?40:1e7,N={type:"inertia",velocity:s?n[h]:0,bounceStiffness:g,bounceDamping:y,timeConstant:750,restDelta:1,restSpeed:10,...o,...m};return this.startAxisValueAnimation(h,N)});return Promise.all(u).then(c)}startAxisValueAnimation(n,r){const s=this.getAxisMotionValue(n);return rS(this.visualElement,n),s.start(NA(n,s,0,r,this.visualElement,!1))}stopAnimation(){ei(n=>this.getAxisMotionValue(n).stop())}pauseAnimation(){ei(n=>{var r;return(r=this.getAxisMotionValue(n).animation)==null?void 0:r.pause()})}getAnimationState(n){var r;return(r=this.getAxisMotionValue(n).animation)==null?void 0:r.state}getAxisMotionValue(n){const r=`_drag${n.toUpperCase()}`,s=this.visualElement.getProps(),i=s[r];return i||this.visualElement.getValue(n,(s.initial?s.initial[n]:void 0)||0)}snapToCursor(n){ei(r=>{const{drag:s}=this.getProps();if(!x0(r,s,this.currentDirection))return;const{projection:i}=this.visualElement,o=this.getAxisMotionValue(r);if(i&&i.layout){const{min:l,max:c}=i.layout.layoutBox[r];o.set(n[r]-Yn(l,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:n,dragConstraints:r}=this.getProps(),{projection:s}=this.visualElement;if(!hf(r)||!s||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};ei(l=>{const c=this.getAxisMotionValue(l);if(c&&this.constraints!==!1){const d=c.get();i[l]=Uae({min:d,max:d},this.constraints[l])}});const{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),ei(l=>{if(!x0(l,n,null))return;const c=this.getAxisMotionValue(l),{min:d,max:u}=this.constraints[l];c.set(Yn(d,u,i[l]))})}addListeners(){if(!this.visualElement.current)return;Wae.set(this.visualElement,this);const n=this.visualElement.current,r=Hm(n,"pointerdown",d=>{const{drag:u,dragListener:h=!0}=this.getProps();u&&h&&this.start(d)}),s=()=>{const{dragConstraints:d}=this.getProps();hf(d)&&d.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,o=i.addEventListener("measure",s);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),zn.read(s);const l=Ap(window,"resize",()=>this.scalePositionWithinConstraints()),c=i.addEventListener("didUpdate",({delta:d,hasLayoutChanged:u})=>{this.isDragging&&u&&(ei(h=>{const m=this.getAxisMotionValue(h);m&&(this.originPoint[h]+=d[h].translate,m.set(m.get()+d[h].translate))}),this.visualElement.render())});return()=>{l(),r(),o(),c&&c()}}getProps(){const n=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:s=!1,dragPropagation:i=!1,dragConstraints:o=!1,dragElastic:l=aS,dragMomentum:c=!0}=n;return{...n,drag:r,dragDirectionLock:s,dragPropagation:i,dragConstraints:o,dragElastic:l,dragMomentum:c}}}function x0(t,n,r){return(n===!0||n===t)&&(r===null||r===t)}function Gae(t,n=10){let r=null;return Math.abs(t.y)>n?r="y":Math.abs(t.x)>n&&(r="x"),r}class Kae extends Wc{constructor(n){super(n),this.removeGroupControls=di,this.removeListeners=di,this.controls=new qae(n)}mount(){const{dragControls:n}=this.node.getProps();n&&(this.removeGroupControls=n.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||di}unmount(){this.removeGroupControls(),this.removeListeners()}}const jI=t=>(n,r)=>{t&&zn.postRender(()=>t(n,r))};class Yae extends Wc{constructor(){super(...arguments),this.removePointerDownListener=di}onPointerDown(n){this.session=new V7(n,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:U7(this.node)})}createPanHandlers(){const{onPanSessionStart:n,onPanStart:r,onPan:s,onPanEnd:i}=this.node.getProps();return{onSessionStart:jI(n),onStart:jI(r),onMove:s,onEnd:(o,l)=>{delete this.session,i&&zn.postRender(()=>i(o,l))}}}mount(){this.removePointerDownListener=Hm(this.node.current,"pointerdown",n=>this.onPointerDown(n))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Cg={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function SI(t,n){return n.max===n.min?0:t/(n.max-n.min)*100}const im={correct:(t,n)=>{if(!n.target)return t;if(typeof t=="string")if(kt.test(t))t=parseFloat(t);else return t;const r=SI(t,n.target.x),s=SI(t,n.target.y);return`${r}% ${s}%`}},Xae={correct:(t,{treeScale:n,projectionDelta:r})=>{const s=t,i=Tc.parse(t);if(i.length>5)return s;const o=Tc.createTransformer(t),l=typeof i[0]!="number"?1:0,c=r.x.scale*n.x,d=r.y.scale*n.y;i[0+l]/=c,i[1+l]/=d;const u=Yn(c,d,.5);return typeof i[2+l]=="number"&&(i[2+l]/=u),typeof i[3+l]=="number"&&(i[3+l]/=u),o(i)}};let oN=!1;class Qae extends b.Component{componentDidMount(){const{visualElement:n,layoutGroup:r,switchLayoutGroup:s,layoutId:i}=this.props,{projection:o}=n;vse(Zae),o&&(r.group&&r.group.add(o),s&&s.register&&i&&s.register(o),oN&&o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,onExitComplete:()=>this.safeToRemove()})),Cg.hasEverUpdated=!0}getSnapshotBeforeUpdate(n){const{layoutDependency:r,visualElement:s,drag:i,isPresent:o}=this.props,{projection:l}=s;return l&&(l.isPresent=o,oN=!0,i||n.layoutDependency!==r||r===void 0||n.isPresent!==o?l.willUpdate():this.safeToRemove(),n.isPresent!==o&&(o?l.promote():l.relegate()||zn.postRender(()=>{const c=l.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:n}=this.props.visualElement;n&&(n.root.didUpdate(),uA.postRender(()=>{!n.currentAnimation&&n.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:n,layoutGroup:r,switchLayoutGroup:s}=this.props,{projection:i}=n;oN=!0,i&&(i.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(i),s&&s.deregister&&s.deregister(i))}safeToRemove(){const{safeToRemove:n}=this.props;n&&n()}render(){return null}}function W7(t){const[n,r]=h7(),s=b.useContext(V_);return a.jsx(Qae,{...t,layoutGroup:s,switchLayoutGroup:b.useContext(C7),isPresent:n,safeToRemove:r})}const Zae={borderRadius:{...im,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:im,borderTopRightRadius:im,borderBottomLeftRadius:im,borderBottomRightRadius:im,boxShadow:Xae};function Jae(t,n,r){const s=Es(t)?t:Gf(t);return s.start(NA("",s,n,r)),s.animation}const eie=(t,n)=>t.depth-n.depth;class tie{constructor(){this.children=[],this.isDirty=!1}add(n){q_(this.children,n),this.isDirty=!0}remove(n){G_(this.children,n),this.isDirty=!0}forEach(n){this.isDirty&&this.children.sort(eie),this.isDirty=!1,this.children.forEach(n)}}function nie(t,n){const r=ia.now(),s=({timestamp:i})=>{const o=i-r;o>=n&&(kc(s),t(o-n))};return zn.setup(s,!0),()=>kc(s)}const q7=["TopLeft","TopRight","BottomLeft","BottomRight"],rie=q7.length,CI=t=>typeof t=="string"?parseFloat(t):t,_I=t=>typeof t=="number"||kt.test(t);function sie(t,n,r,s,i,o){i?(t.opacity=Yn(0,r.opacity??1,aie(s)),t.opacityExit=Yn(n.opacity??1,0,iie(s))):o&&(t.opacity=Yn(n.opacity??1,r.opacity??1,s));for(let l=0;l<rie;l++){const c=`border${q7[l]}Radius`;let d=AI(n,c),u=AI(r,c);if(d===void 0&&u===void 0)continue;d||(d=0),u||(u=0),d===0||u===0||_I(d)===_I(u)?(t[c]=Math.max(Yn(CI(d),CI(u),s),0),(bo.test(u)||bo.test(d))&&(t[c]+="%")):t[c]=u}(n.rotate||r.rotate)&&(t.rotate=Yn(n.rotate||0,r.rotate||0,s))}function AI(t,n){return t[n]!==void 0?t[n]:t.borderRadius}const aie=G7(0,.5,ML),iie=G7(.5,.95,di);function G7(t,n,r){return s=>s<t?0:s>n?1:r(Np(t,n,s))}function EI(t,n){t.min=n.min,t.max=n.max}function Xa(t,n){EI(t.x,n.x),EI(t.y,n.y)}function kI(t,n){t.translate=n.translate,t.scale=n.scale,t.originPoint=n.originPoint,t.origin=n.origin}function TI(t,n,r,s,i){return t-=n,t=A1(t,1/r,s),i!==void 0&&(t=A1(t,1/i,s)),t}function oie(t,n=0,r=1,s=.5,i,o=t,l=t){if(bo.test(n)&&(n=parseFloat(n),n=Yn(l.min,l.max,n/100)-l.min),typeof n!="number")return;let c=Yn(o.min,o.max,s);t===o&&(c-=n),t.min=TI(t.min,n,r,c,i),t.max=TI(t.max,n,r,c,i)}function II(t,n,[r,s,i],o,l){oie(t,n[r],n[s],n[i],n.scale,o,l)}const lie=["x","scaleX","originX"],cie=["y","scaleY","originY"];function PI(t,n,r,s){II(t.x,n,lie,r?r.x:void 0,s?s.x:void 0),II(t.y,n,cie,r?r.y:void 0,s?s.y:void 0)}function MI(t){return t.translate===0&&t.scale===1}function K7(t){return MI(t.x)&&MI(t.y)}function OI(t,n){return t.min===n.min&&t.max===n.max}function die(t,n){return OI(t.x,n.x)&&OI(t.y,n.y)}function DI(t,n){return Math.round(t.min)===Math.round(n.min)&&Math.round(t.max)===Math.round(n.max)}function Y7(t,n){return DI(t.x,n.x)&&DI(t.y,n.y)}function RI(t){return Vs(t.x)/Vs(t.y)}function LI(t,n){return t.translate===n.translate&&t.scale===n.scale&&t.originPoint===n.originPoint}class uie{constructor(){this.members=[]}add(n){q_(this.members,n),n.scheduleRender()}remove(n){if(G_(this.members,n),n===this.prevLead&&(this.prevLead=void 0),n===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(n){const r=this.members.findIndex(i=>n===i);if(r===0)return!1;let s;for(let i=r;i>=0;i--){const o=this.members[i];if(o.isPresent!==!1){s=o;break}}return s?(this.promote(s),!0):!1}promote(n,r){const s=this.lead;if(n!==s&&(this.prevLead=s,this.lead=n,n.show(),s)){s.instance&&s.scheduleRender(),n.scheduleRender(),n.resumeFrom=s,r&&(n.resumeFrom.preserveOpacity=!0),s.snapshot&&(n.snapshot=s.snapshot,n.snapshot.latestValues=s.animationValues||s.latestValues),n.root&&n.root.isUpdating&&(n.isLayoutDirty=!0);const{crossfade:i}=n.options;i===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(n=>{const{options:r,resumingFrom:s}=n;r.onExitComplete&&r.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(n=>{n.instance&&n.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function fie(t,n,r){let s="";const i=t.x.translate/n.x,o=t.y.translate/n.y,l=(r==null?void 0:r.z)||0;if((i||o||l)&&(s=`translate3d(${i}px, ${o}px, ${l}px) `),(n.x!==1||n.y!==1)&&(s+=`scale(${1/n.x}, ${1/n.y}) `),r){const{transformPerspective:u,rotate:h,rotateX:m,rotateY:g,skewX:y,skewY:N}=r;u&&(s=`perspective(${u}px) ${s}`),h&&(s+=`rotate(${h}deg) `),m&&(s+=`rotateX(${m}deg) `),g&&(s+=`rotateY(${g}deg) `),y&&(s+=`skewX(${y}deg) `),N&&(s+=`skewY(${N}deg) `)}const c=t.x.scale*n.x,d=t.y.scale*n.y;return(c!==1||d!==1)&&(s+=`scale(${c}, ${d})`),s||"none"}const lN=["","X","Y","Z"],hie=1e3;let mie=0;function cN(t,n,r,s){const{latestValues:i}=n;i[t]&&(r[t]=i[t],n.setStaticValue(t,0),s&&(s[t]=0))}function X7(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:n}=t.options;if(!n)return;const r=D7(n);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:i,layoutId:o}=t.options;window.MotionCancelOptimisedAnimation(r,"transform",zn,!(i||o))}const{parent:s}=t;s&&!s.hasCheckedOptimisedAppear&&X7(s)}function Q7({attachResizeListener:t,defaultParent:n,measureScroll:r,checkIsScrollRoot:s,resetTransform:i}){return class{constructor(l={},c=n==null?void 0:n()){this.id=mie++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(gie),this.nodes.forEach(wie),this.nodes.forEach(Nie),this.nodes.forEach(yie)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=l,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let d=0;d<this.path.length;d++)this.path[d].shouldResetTransform=!0;this.root===this&&(this.nodes=new tie)}addEventListener(l,c){return this.eventHandlers.has(l)||this.eventHandlers.set(l,new X_),this.eventHandlers.get(l).add(c)}notifyListeners(l,...c){const d=this.eventHandlers.get(l);d&&d.notify(...c)}hasListeners(l){return this.eventHandlers.has(l)}mount(l){if(this.instance)return;this.isSVG=f7(l)&&!sse(l),this.instance=l;const{layoutId:c,layout:d,visualElement:u}=this.options;if(u&&!u.current&&u.mount(l),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(d||c)&&(this.isLayoutDirty=!0),t){let h,m=0;const g=()=>this.root.updateBlockedByResize=!1;zn.read(()=>{m=window.innerWidth}),t(l,()=>{const y=window.innerWidth;y!==m&&(m=y,this.root.updateBlockedByResize=!0,h&&h(),h=nie(g,250),Cg.hasAnimatedSinceResize&&(Cg.hasAnimatedSinceResize=!1,this.nodes.forEach($I)))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&u&&(c||d)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:m,hasRelativeLayoutChanged:g,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const N=this.options.transition||u.getDefaultTransition()||Aie,{onLayoutAnimationStart:j,onLayoutAnimationComplete:S}=u.getProps(),_=!this.targetLayout||!Y7(this.targetLayout,y),A=!m&&g;if(this.options.layoutRoot||this.resumeFrom||A||m&&(_||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const k={...cA(N,"layout"),onPlay:j,onComplete:S};(u.shouldReduceMotion||this.options.layoutRoot)&&(k.delay=0,k.type=!1),this.startAnimation(k),this.setAnimationOrigin(h,A)}else m||$I(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const l=this.getStack();l&&l.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),kc(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(jie),this.animationId++)}getTransformTemplate(){const{visualElement:l}=this.options;return l&&l.getProps().transformTemplate}willUpdate(l=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&X7(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const m=this.path[h];m.shouldResetTransform=!0,m.updateScroll("snapshot"),m.options.layoutRoot&&m.willUpdate(!1)}const{layoutId:c,layout:d}=this.options;if(c===void 0&&!d)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),l&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(BI);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(FI);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(bie),this.nodes.forEach(pie),this.nodes.forEach(xie)):this.nodes.forEach(FI),this.clearAllSnapshots();const c=ia.now();hs.delta=hl(0,1e3/60,c-hs.timestamp),hs.timestamp=c,hs.isProcessing=!0,Qw.update.process(hs),Qw.preRender.process(hs),Qw.render.process(hs),hs.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,uA.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(vie),this.sharedNodes.forEach(Sie)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,zn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){zn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Vs(this.snapshot.measuredBox.x)&&!Vs(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let d=0;d<this.path.length;d++)this.path[d].updateScroll();const l=this.layout;this.layout=this.measure(!1),this.layoutCorrected=mr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,l?l.layoutBox:void 0)}updateScroll(l="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===l&&(c=!1),c&&this.instance){const d=s(this.instance);this.scroll={animationId:this.root.animationId,phase:l,isRoot:d,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:d}}}resetTransform(){if(!i)return;const l=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!K7(this.projectionDelta),d=this.getTransformTemplate(),u=d?d(this.latestValues,""):void 0,h=u!==this.prevTransformTemplateValue;l&&this.instance&&(c||md(this.latestValues)||h)&&(i(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(l=!0){const c=this.measurePageBox();let d=this.removeElementScroll(c);return l&&(d=this.removeTransform(d)),Eie(d),{animationId:this.root.animationId,measuredBox:c,layoutBox:d,latestValues:{},source:this.id}}measurePageBox(){var u;const{visualElement:l}=this.options;if(!l)return mr();const c=l.measureViewportBox();if(!(((u=this.scroll)==null?void 0:u.wasRoot)||this.path.some(kie))){const{scroll:h}=this.root;h&&(mf(c.x,h.offset.x),mf(c.y,h.offset.y))}return c}removeElementScroll(l){var d;const c=mr();if(Xa(c,l),(d=this.scroll)!=null&&d.wasRoot)return c;for(let u=0;u<this.path.length;u++){const h=this.path[u],{scroll:m,options:g}=h;h!==this.root&&m&&g.layoutScroll&&(m.wasRoot&&Xa(c,l),mf(c.x,m.offset.x),mf(c.y,m.offset.y))}return c}applyTransform(l,c=!1){const d=mr();Xa(d,l);for(let u=0;u<this.path.length;u++){const h=this.path[u];!c&&h.options.layoutScroll&&h.scroll&&h!==h.root&&pf(d,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),md(h.latestValues)&&pf(d,h.latestValues)}return md(this.latestValues)&&pf(d,this.latestValues),d}removeTransform(l){const c=mr();Xa(c,l);for(let d=0;d<this.path.length;d++){const u=this.path[d];if(!u.instance||!md(u.latestValues))continue;Jj(u.latestValues)&&u.updateSnapshot();const h=mr(),m=u.measurePageBox();Xa(h,m),PI(c,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,h)}return md(this.latestValues)&&PI(c,this.latestValues),c}setTargetDelta(l){this.targetDelta=l,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(l){this.options={...this.options,...l,crossfade:l.crossfade!==void 0?l.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==hs.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(l=!1){var g;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==c;if(!(l||d&&this.isSharedProjectionDirty||this.isProjectionDirty||(g=this.parent)!=null&&g.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:m}=this.options;if(!(!this.layout||!(h||m))){if(this.resolvedRelativeTargetAt=hs.timestamp,!this.targetDelta&&!this.relativeTarget){const y=this.getClosestProjectingParent();y&&y.layout&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=mr(),this.relativeTargetOrigin=mr(),qm(this.relativeTargetOrigin,this.layout.layoutBox,y.layout.layoutBox),Xa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=mr(),this.targetWithTransforms=mr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Dae(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Xa(this.target,this.layout.layoutBox),k7(this.target,this.targetDelta)):Xa(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const y=this.getClosestProjectingParent();y&&!!y.resumingFrom==!!this.resumingFrom&&!y.options.layoutScroll&&y.target&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=mr(),this.relativeTargetOrigin=mr(),qm(this.relativeTargetOrigin,this.target,y.target),Xa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||Jj(this.parent.latestValues)||E7(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var N;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let d=!0;if((this.isProjectionDirty||(N=this.parent)!=null&&N.isProjectionDirty)&&(d=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===hs.timestamp&&(d=!1),d)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;Xa(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,g=this.treeScale.y;Gse(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=mr());const{target:y}=l;if(!y){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(kI(this.prevProjectionDelta.x,this.projectionDelta.x),kI(this.prevProjectionDelta.y,this.projectionDelta.y)),Wm(this.projectionDelta,this.layoutCorrected,y,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==g||!LI(this.projectionDelta.x,this.prevProjectionDelta.x)||!LI(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(l=!0){var c;if((c=this.options.visualElement)==null||c.scheduleRender(),l){const d=this.getStack();d&&d.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=xf(),this.projectionDelta=xf(),this.projectionDeltaWithTransform=xf()}setAnimationOrigin(l,c=!1){const d=this.snapshot,u=d?d.latestValues:{},h={...this.latestValues},m=xf();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const g=mr(),y=d?d.source:void 0,N=this.layout?this.layout.source:void 0,j=y!==N,S=this.getStack(),_=!S||S.members.length<=1,A=!!(j&&!_&&this.options.crossfade===!0&&!this.path.some(_ie));this.animationProgress=0;let k;this.mixTargetDelta=T=>{const P=T/1e3;zI(m.x,l.x,P),zI(m.y,l.y,P),this.setTargetDelta(m),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(qm(g,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Cie(this.relativeTarget,this.relativeTargetOrigin,g,P),k&&die(this.relativeTarget,k)&&(this.isProjectionDirty=!1),k||(k=mr()),Xa(k,this.relativeTarget)),j&&(this.animationValues=h,sie(h,u,this.latestValues,P,A,_)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=P},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(l){var c,d,u;this.notifyListeners("animationStart"),(c=this.currentAnimation)==null||c.stop(),(u=(d=this.resumingFrom)==null?void 0:d.currentAnimation)==null||u.stop(),this.pendingAnimation&&(kc(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=zn.update(()=>{Cg.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Gf(0)),this.currentAnimation=Jae(this.motionValue,[0,1e3],{...l,velocity:0,isSync:!0,onUpdate:h=>{this.mixTargetDelta(h),l.onUpdate&&l.onUpdate(h)},onStop:()=>{},onComplete:()=>{l.onComplete&&l.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const l=this.getStack();l&&l.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(hie),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const l=this.getLead();let{targetWithTransforms:c,target:d,layout:u,latestValues:h}=l;if(!(!c||!d||!u)){if(this!==l&&this.layout&&u&&Z7(this.options.animationType,this.layout.layoutBox,u.layoutBox)){d=this.target||mr();const m=Vs(this.layout.layoutBox.x);d.x.min=l.target.x.min,d.x.max=d.x.min+m;const g=Vs(this.layout.layoutBox.y);d.y.min=l.target.y.min,d.y.max=d.y.min+g}Xa(c,d),pf(c,h),Wm(this.projectionDeltaWithTransform,this.layoutCorrected,c,h)}}registerSharedNode(l,c){this.sharedNodes.has(l)||this.sharedNodes.set(l,new uie),this.sharedNodes.get(l).add(c);const u=c.options.initialPromotionConfig;c.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(c):void 0})}isLead(){const l=this.getStack();return l?l.lead===this:!0}getLead(){var c;const{layoutId:l}=this.options;return l?((c=this.getStack())==null?void 0:c.lead)||this:this}getPrevLead(){var c;const{layoutId:l}=this.options;return l?(c=this.getStack())==null?void 0:c.prevLead:void 0}getStack(){const{layoutId:l}=this.options;if(l)return this.root.sharedNodes.get(l)}promote({needsReset:l,transition:c,preserveFollowOpacity:d}={}){const u=this.getStack();u&&u.promote(this,d),l&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const l=this.getStack();return l?l.relegate(this):!1}resetSkewAndRotation(){const{visualElement:l}=this.options;if(!l)return;let c=!1;const{latestValues:d}=l;if((d.z||d.rotate||d.rotateX||d.rotateY||d.rotateZ||d.skewX||d.skewY)&&(c=!0),!c)return;const u={};d.z&&cN("z",l,u,this.animationValues);for(let h=0;h<lN.length;h++)cN(`rotate${lN[h]}`,l,u,this.animationValues),cN(`skew${lN[h]}`,l,u,this.animationValues);l.render();for(const h in u)l.setStaticValue(h,u[h]),this.animationValues&&(this.animationValues[h]=u[h]);l.scheduleRender()}applyProjectionStyles(l,c){if(!this.instance||this.isSVG)return;if(!this.isVisible){l.visibility="hidden";return}const d=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,l.visibility="",l.opacity="",l.pointerEvents=Sg(c==null?void 0:c.pointerEvents)||"",l.transform=d?d(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(l.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,l.pointerEvents=Sg(c==null?void 0:c.pointerEvents)||""),this.hasProjected&&!md(this.latestValues)&&(l.transform=d?d({},""):"none",this.hasProjected=!1);return}l.visibility="";const h=u.animationValues||u.latestValues;this.applyTransformsToTarget();let m=fie(this.projectionDeltaWithTransform,this.treeScale,h);d&&(m=d(h,m)),l.transform=m;const{x:g,y}=this.projectionDelta;l.transformOrigin=`${g.origin*100}% ${y.origin*100}% 0`,u.animationValues?l.opacity=u===this?h.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:l.opacity=u===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const N in _p){if(h[N]===void 0)continue;const{correct:j,applyTo:S,isCSSVariable:_}=_p[N],A=m==="none"?h[N]:j(h[N],u);if(S){const k=S.length;for(let T=0;T<k;T++)l[S[T]]=A}else _?this.options.visualElement.renderState.vars[N]=A:l[N]=A}this.options.layoutId&&(l.pointerEvents=u===this?Sg(c==null?void 0:c.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(l=>{var c;return(c=l.currentAnimation)==null?void 0:c.stop()}),this.root.nodes.forEach(BI),this.root.sharedNodes.clear()}}}function pie(t){t.updateLayout()}function xie(t){var r;const n=((r=t.resumeFrom)==null?void 0:r.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:i}=t.layout,{animationType:o}=t.options,l=n.source!==t.layout.source;o==="size"?ei(m=>{const g=l?n.measuredBox[m]:n.layoutBox[m],y=Vs(g);g.min=s[m].min,g.max=g.min+y}):Z7(o,n.layoutBox,s)&&ei(m=>{const g=l?n.measuredBox[m]:n.layoutBox[m],y=Vs(s[m]);g.max=g.min+y,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[m].max=t.relativeTarget[m].min+y)});const c=xf();Wm(c,s,n.layoutBox);const d=xf();l?Wm(d,t.applyTransform(i,!0),n.measuredBox):Wm(d,s,n.layoutBox);const u=!K7(c);let h=!1;if(!t.resumeFrom){const m=t.getClosestProjectingParent();if(m&&!m.resumeFrom){const{snapshot:g,layout:y}=m;if(g&&y){const N=mr();qm(N,n.layoutBox,g.layoutBox);const j=mr();qm(j,s,y.layoutBox),Y7(N,j)||(h=!0),m.options.layoutRoot&&(t.relativeTarget=j,t.relativeTargetOrigin=N,t.relativeParent=m)}}}t.notifyListeners("didUpdate",{layout:s,snapshot:n,delta:d,layoutDelta:c,hasLayoutChanged:u,hasRelativeLayoutChanged:h})}else if(t.isLead()){const{onExitComplete:s}=t.options;s&&s()}t.options.transition=void 0}function gie(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function yie(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function vie(t){t.clearSnapshot()}function BI(t){t.clearMeasurements()}function FI(t){t.isLayoutDirty=!1}function bie(t){const{visualElement:n}=t.options;n&&n.getProps().onBeforeLayoutMeasure&&n.notify("BeforeLayoutMeasure"),t.resetTransform()}function $I(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function wie(t){t.resolveTargetDelta()}function Nie(t){t.calcProjection()}function jie(t){t.resetSkewAndRotation()}function Sie(t){t.removeLeadSnapshot()}function zI(t,n,r){t.translate=Yn(n.translate,0,r),t.scale=Yn(n.scale,1,r),t.origin=n.origin,t.originPoint=n.originPoint}function UI(t,n,r,s){t.min=Yn(n.min,r.min,s),t.max=Yn(n.max,r.max,s)}function Cie(t,n,r,s){UI(t.x,n.x,r.x,s),UI(t.y,n.y,r.y,s)}function _ie(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const Aie={duration:.45,ease:[.4,0,.1,1]},VI=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),HI=VI("applewebkit/")&&!VI("chrome/")?Math.round:di;function WI(t){t.min=HI(t.min),t.max=HI(t.max)}function Eie(t){WI(t.x),WI(t.y)}function Z7(t,n,r){return t==="position"||t==="preserve-aspect"&&!Oae(RI(n),RI(r),.2)}function kie(t){var n;return t!==t.root&&((n=t.scroll)==null?void 0:n.wasRoot)}const Tie=Q7({attachResizeListener:(t,n)=>Ap(t,"resize",n),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),dN={current:void 0},J7=Q7({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!dN.current){const t=new Tie({});t.mount(window),t.setOptions({layoutScroll:!0}),dN.current=t}return dN.current},resetTransform:(t,n)=>{t.style.transform=n!==void 0?n:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),Iie={pan:{Feature:Yae},drag:{Feature:Kae,ProjectionNode:J7,MeasureLayout:W7}};function qI(t,n,r){const{props:s}=t;t.animationState&&s.whileHover&&t.animationState.setActive("whileHover",r==="Start");const i="onHover"+r,o=s[i];o&&zn.postRender(()=>o(n,mx(n)))}class Pie extends Wc{mount(){const{current:n}=this.node;n&&(this.unmount=Jre(n,(r,s)=>(qI(this.node,s,"Start"),i=>qI(this.node,i,"End"))))}unmount(){}}class Mie extends Wc{constructor(){super(...arguments),this.isActive=!1}onFocus(){let n=!1;try{n=this.node.current.matches(":focus-visible")}catch{n=!0}!n||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=ux(Ap(this.node.current,"focus",()=>this.onFocus()),Ap(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function GI(t,n,r){const{props:s}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&s.whileTap&&t.animationState.setActive("whileTap",r==="Start");const i="onTap"+(r==="End"?"":r),o=s[i];o&&zn.postRender(()=>o(n,mx(n)))}class Oie extends Wc{mount(){const{current:n}=this.node;n&&(this.unmount=rse(n,(r,s)=>(GI(this.node,s,"Start"),(i,{success:o})=>GI(this.node,i,o?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const iS=new WeakMap,uN=new WeakMap,Die=t=>{const n=iS.get(t.target);n&&n(t)},Rie=t=>{t.forEach(Die)};function Lie({root:t,...n}){const r=t||document;uN.has(r)||uN.set(r,{});const s=uN.get(r),i=JSON.stringify(n);return s[i]||(s[i]=new IntersectionObserver(Rie,{root:t,...n})),s[i]}function Bie(t,n,r){const s=Lie(n);return iS.set(t,r),s.observe(t),()=>{iS.delete(t),s.unobserve(t)}}const Fie={some:0,all:1};class $ie extends Wc{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:n={}}=this.node.getProps(),{root:r,margin:s,amount:i="some",once:o}=n,l={root:r?r.current:void 0,rootMargin:s,threshold:typeof i=="number"?i:Fie[i]},c=d=>{const{isIntersecting:u}=d;if(this.isInView===u||(this.isInView=u,o&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:h,onViewportLeave:m}=this.node.getProps(),g=u?h:m;g&&g(d)};return Bie(this.node.current,l,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:n,prevProps:r}=this.node;["amount","margin","root"].some(zie(n,r))&&this.startObserver()}unmount(){}}function zie({viewport:t={}},{viewport:n={}}={}){return r=>t[r]!==n[r]}const Uie={inView:{Feature:$ie},tap:{Feature:Oie},focus:{Feature:Mie},hover:{Feature:Pie}},Vie={layout:{ProjectionNode:J7,MeasureLayout:W7}},Hie={...Eae,...Uie,...Iie,...Vie},ht=Hse(Hie,rae);function bv(t){const n=Cr(d=>d.modules)||{},r=Cr(d=>d.user),s=(r==null?void 0:r.is_admin)&&Object.keys(n).length===0,i=n[t]||[],o=b.useMemo(()=>new Set(i.map(d=>d.code.split(".").pop())),[i]),l=s||i.length>0,c=d=>s||o.has(d);return{hasAny:l,canView:c("view"),canCreate:c("create"),canUpdate:c("update"),canDelete:c("delete")}}function eB(t){var n,r,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(n=0;n<i;n++)t[n]&&(r=eB(t[n]))&&(s&&(s+=" "),s+=r)}else for(r in t)t[r]&&(s&&(s+=" "),s+=r);return s}function cn(){for(var t,n,r=0,s="",i=arguments.length;r<i;r++)(t=arguments[r])&&(n=eB(t))&&(s&&(s+=" "),s+=n);return s}const jA="-",Wie=t=>{const n=Gie(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:s}=t;return{getClassGroupId:l=>{const c=l.split(jA);return c[0]===""&&c.length!==1&&c.shift(),tB(c,n)||qie(l)},getConflictingClassGroupIds:(l,c)=>{const d=r[l]||[];return c&&s[l]?[...d,...s[l]]:d}}},tB=(t,n)=>{var l;if(t.length===0)return n.classGroupId;const r=t[0],s=n.nextPart.get(r),i=s?tB(t.slice(1),s):void 0;if(i)return i;if(n.validators.length===0)return;const o=t.join(jA);return(l=n.validators.find(({validator:c})=>c(o)))==null?void 0:l.classGroupId},KI=/^\[(.+)\]$/,qie=t=>{if(KI.test(t)){const n=KI.exec(t)[1],r=n==null?void 0:n.substring(0,n.indexOf(":"));if(r)return"arbitrary.."+r}},Gie=t=>{const{theme:n,classGroups:r}=t,s={nextPart:new Map,validators:[]};for(const i in r)oS(r[i],s,i,n);return s},oS=(t,n,r,s)=>{t.forEach(i=>{if(typeof i=="string"){const o=i===""?n:YI(n,i);o.classGroupId=r;return}if(typeof i=="function"){if(Kie(i)){oS(i(s),n,r,s);return}n.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([o,l])=>{oS(l,YI(n,o),r,s)})})},YI=(t,n)=>{let r=t;return n.split(jA).forEach(s=>{r.nextPart.has(s)||r.nextPart.set(s,{nextPart:new Map,validators:[]}),r=r.nextPart.get(s)}),r},Kie=t=>t.isThemeGetter,Yie=t=>{if(t<1)return{get:()=>{},set:()=>{}};let n=0,r=new Map,s=new Map;const i=(o,l)=>{r.set(o,l),n++,n>t&&(n=0,s=r,r=new Map)};return{get(o){let l=r.get(o);if(l!==void 0)return l;if((l=s.get(o))!==void 0)return i(o,l),l},set(o,l){r.has(o)?r.set(o,l):i(o,l)}}},lS="!",cS=":",Xie=cS.length,Qie=t=>{const{prefix:n,experimentalParseClassName:r}=t;let s=i=>{const o=[];let l=0,c=0,d=0,u;for(let N=0;N<i.length;N++){let j=i[N];if(l===0&&c===0){if(j===cS){o.push(i.slice(d,N)),d=N+Xie;continue}if(j==="/"){u=N;continue}}j==="["?l++:j==="]"?l--:j==="("?c++:j===")"&&c--}const h=o.length===0?i:i.substring(d),m=Zie(h),g=m!==h,y=u&&u>d?u-d:void 0;return{modifiers:o,hasImportantModifier:g,baseClassName:m,maybePostfixModifierPosition:y}};if(n){const i=n+cS,o=s;s=l=>l.startsWith(i)?o(l.substring(i.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:l,maybePostfixModifierPosition:void 0}}if(r){const i=s;s=o=>r({className:o,parseClassName:i})}return s},Zie=t=>t.endsWith(lS)?t.substring(0,t.length-1):t.startsWith(lS)?t.substring(1):t,Jie=t=>{const n=Object.fromEntries(t.orderSensitiveModifiers.map(s=>[s,!0]));return s=>{if(s.length<=1)return s;const i=[];let o=[];return s.forEach(l=>{l[0]==="["||n[l]?(i.push(...o.sort(),l),o=[]):o.push(l)}),i.push(...o.sort()),i}},eoe=t=>({cache:Yie(t.cacheSize),parseClassName:Qie(t),sortModifiers:Jie(t),...Wie(t)}),toe=/\s+/,noe=(t,n)=>{const{parseClassName:r,getClassGroupId:s,getConflictingClassGroupIds:i,sortModifiers:o}=n,l=[],c=t.trim().split(toe);let d="";for(let u=c.length-1;u>=0;u-=1){const h=c[u],{isExternal:m,modifiers:g,hasImportantModifier:y,baseClassName:N,maybePostfixModifierPosition:j}=r(h);if(m){d=h+(d.length>0?" "+d:d);continue}let S=!!j,_=s(S?N.substring(0,j):N);if(!_){if(!S){d=h+(d.length>0?" "+d:d);continue}if(_=s(N),!_){d=h+(d.length>0?" "+d:d);continue}S=!1}const A=o(g).join(":"),k=y?A+lS:A,T=k+_;if(l.includes(T))continue;l.push(T);const P=i(_,S);for(let M=0;M<P.length;++M){const O=P[M];l.push(k+O)}d=h+(d.length>0?" "+d:d)}return d};function roe(){let t=0,n,r,s="";for(;t<arguments.length;)(n=arguments[t++])&&(r=nB(n))&&(s&&(s+=" "),s+=r);return s}const nB=t=>{if(typeof t=="string")return t;let n,r="";for(let s=0;s<t.length;s++)t[s]&&(n=nB(t[s]))&&(r&&(r+=" "),r+=n);return r};function soe(t,...n){let r,s,i,o=l;function l(d){const u=n.reduce((h,m)=>m(h),t());return r=eoe(u),s=r.cache.get,i=r.cache.set,o=c,c(d)}function c(d){const u=s(d);if(u)return u;const h=noe(d,r);return i(d,h),h}return function(){return o(roe.apply(null,arguments))}}const Mr=t=>{const n=r=>r[t]||[];return n.isThemeGetter=!0,n},rB=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,sB=/^\((?:(\w[\w-]*):)?(.+)\)$/i,aoe=/^\d+\/\d+$/,ioe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ooe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,loe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,coe=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,doe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,zu=t=>aoe.test(t),Vt=t=>!!t&&!Number.isNaN(Number(t)),Ul=t=>!!t&&Number.isInteger(Number(t)),fN=t=>t.endsWith("%")&&Vt(t.slice(0,-1)),Uo=t=>ioe.test(t),uoe=()=>!0,foe=t=>ooe.test(t)&&!loe.test(t),aB=()=>!1,hoe=t=>coe.test(t),moe=t=>doe.test(t),poe=t=>!lt(t)&&!ct(t),xoe=t=>wh(t,lB,aB),lt=t=>rB.test(t),cd=t=>wh(t,cB,foe),hN=t=>wh(t,woe,Vt),XI=t=>wh(t,iB,aB),goe=t=>wh(t,oB,moe),g0=t=>wh(t,dB,hoe),ct=t=>sB.test(t),om=t=>Nh(t,cB),yoe=t=>Nh(t,Noe),QI=t=>Nh(t,iB),voe=t=>Nh(t,lB),boe=t=>Nh(t,oB),y0=t=>Nh(t,dB,!0),wh=(t,n,r)=>{const s=rB.exec(t);return s?s[1]?n(s[1]):r(s[2]):!1},Nh=(t,n,r=!1)=>{const s=sB.exec(t);return s?s[1]?n(s[1]):r:!1},iB=t=>t==="position"||t==="percentage",oB=t=>t==="image"||t==="url",lB=t=>t==="length"||t==="size"||t==="bg-size",cB=t=>t==="length",woe=t=>t==="number",Noe=t=>t==="family-name",dB=t=>t==="shadow",joe=()=>{const t=Mr("color"),n=Mr("font"),r=Mr("text"),s=Mr("font-weight"),i=Mr("tracking"),o=Mr("leading"),l=Mr("breakpoint"),c=Mr("container"),d=Mr("spacing"),u=Mr("radius"),h=Mr("shadow"),m=Mr("inset-shadow"),g=Mr("text-shadow"),y=Mr("drop-shadow"),N=Mr("blur"),j=Mr("perspective"),S=Mr("aspect"),_=Mr("ease"),A=Mr("animate"),k=()=>["auto","avoid","all","avoid-page","page","left","right","column"],T=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],P=()=>[...T(),ct,lt],M=()=>["auto","hidden","clip","visible","scroll"],O=()=>["auto","contain","none"],D=()=>[ct,lt,d],L=()=>[zu,"full","auto",...D()],$=()=>[Ul,"none","subgrid",ct,lt],V=()=>["auto",{span:["full",Ul,ct,lt]},Ul,ct,lt],F=()=>[Ul,"auto",ct,lt],Q=()=>["auto","min","max","fr",ct,lt],U=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],z=()=>["start","end","center","stretch","center-safe","end-safe"],q=()=>["auto",...D()],K=()=>[zu,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...D()],X=()=>[t,ct,lt],J=()=>[...T(),QI,XI,{position:[ct,lt]}],ne=()=>["no-repeat",{repeat:["","x","y","space","round"]}],Se=()=>["auto","cover","contain",voe,xoe,{size:[ct,lt]}],de=()=>[fN,om,cd],ye=()=>["","none","full",u,ct,lt],be=()=>["",Vt,om,cd],xe=()=>["solid","dashed","dotted","double"],_e=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],we=()=>[Vt,fN,QI,XI],Oe=()=>["","none",N,ct,lt],ae=()=>["none",Vt,ct,lt],ie=()=>["none",Vt,ct,lt],pe=()=>[Vt,ct,lt],re=()=>[zu,"full",...D()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Uo],breakpoint:[Uo],color:[uoe],container:[Uo],"drop-shadow":[Uo],ease:["in","out","in-out"],font:[poe],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Uo],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Uo],shadow:[Uo],spacing:["px",Vt],text:[Uo],"text-shadow":[Uo],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",zu,lt,ct,S]}],container:["container"],columns:[{columns:[Vt,lt,ct,c]}],"break-after":[{"break-after":k()}],"break-before":[{"break-before":k()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:P()}],overflow:[{overflow:M()}],"overflow-x":[{"overflow-x":M()}],"overflow-y":[{"overflow-y":M()}],overscroll:[{overscroll:O()}],"overscroll-x":[{"overscroll-x":O()}],"overscroll-y":[{"overscroll-y":O()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:L()}],"inset-x":[{"inset-x":L()}],"inset-y":[{"inset-y":L()}],start:[{start:L()}],end:[{end:L()}],top:[{top:L()}],right:[{right:L()}],bottom:[{bottom:L()}],left:[{left:L()}],visibility:["visible","invisible","collapse"],z:[{z:[Ul,"auto",ct,lt]}],basis:[{basis:[zu,"full","auto",c,...D()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Vt,zu,"auto","initial","none",lt]}],grow:[{grow:["",Vt,ct,lt]}],shrink:[{shrink:["",Vt,ct,lt]}],order:[{order:[Ul,"first","last","none",ct,lt]}],"grid-cols":[{"grid-cols":$()}],"col-start-end":[{col:V()}],"col-start":[{"col-start":F()}],"col-end":[{"col-end":F()}],"grid-rows":[{"grid-rows":$()}],"row-start-end":[{row:V()}],"row-start":[{"row-start":F()}],"row-end":[{"row-end":F()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":Q()}],"auto-rows":[{"auto-rows":Q()}],gap:[{gap:D()}],"gap-x":[{"gap-x":D()}],"gap-y":[{"gap-y":D()}],"justify-content":[{justify:[...U(),"normal"]}],"justify-items":[{"justify-items":[...z(),"normal"]}],"justify-self":[{"justify-self":["auto",...z()]}],"align-content":[{content:["normal",...U()]}],"align-items":[{items:[...z(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...z(),{baseline:["","last"]}]}],"place-content":[{"place-content":U()}],"place-items":[{"place-items":[...z(),"baseline"]}],"place-self":[{"place-self":["auto",...z()]}],p:[{p:D()}],px:[{px:D()}],py:[{py:D()}],ps:[{ps:D()}],pe:[{pe:D()}],pt:[{pt:D()}],pr:[{pr:D()}],pb:[{pb:D()}],pl:[{pl:D()}],m:[{m:q()}],mx:[{mx:q()}],my:[{my:q()}],ms:[{ms:q()}],me:[{me:q()}],mt:[{mt:q()}],mr:[{mr:q()}],mb:[{mb:q()}],ml:[{ml:q()}],"space-x":[{"space-x":D()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":D()}],"space-y-reverse":["space-y-reverse"],size:[{size:K()}],w:[{w:[c,"screen",...K()]}],"min-w":[{"min-w":[c,"screen","none",...K()]}],"max-w":[{"max-w":[c,"screen","none","prose",{screen:[l]},...K()]}],h:[{h:["screen","lh",...K()]}],"min-h":[{"min-h":["screen","lh","none",...K()]}],"max-h":[{"max-h":["screen","lh",...K()]}],"font-size":[{text:["base",r,om,cd]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[s,ct,hN]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",fN,lt]}],"font-family":[{font:[yoe,lt,n]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,ct,lt]}],"line-clamp":[{"line-clamp":[Vt,"none",ct,hN]}],leading:[{leading:[o,...D()]}],"list-image":[{"list-image":["none",ct,lt]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",ct,lt]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:X()}],"text-color":[{text:X()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...xe(),"wavy"]}],"text-decoration-thickness":[{decoration:[Vt,"from-font","auto",ct,cd]}],"text-decoration-color":[{decoration:X()}],"underline-offset":[{"underline-offset":[Vt,"auto",ct,lt]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:D()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ct,lt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ct,lt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:J()}],"bg-repeat":[{bg:ne()}],"bg-size":[{bg:Se()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Ul,ct,lt],radial:["",ct,lt],conic:[Ul,ct,lt]},boe,goe]}],"bg-color":[{bg:X()}],"gradient-from-pos":[{from:de()}],"gradient-via-pos":[{via:de()}],"gradient-to-pos":[{to:de()}],"gradient-from":[{from:X()}],"gradient-via":[{via:X()}],"gradient-to":[{to:X()}],rounded:[{rounded:ye()}],"rounded-s":[{"rounded-s":ye()}],"rounded-e":[{"rounded-e":ye()}],"rounded-t":[{"rounded-t":ye()}],"rounded-r":[{"rounded-r":ye()}],"rounded-b":[{"rounded-b":ye()}],"rounded-l":[{"rounded-l":ye()}],"rounded-ss":[{"rounded-ss":ye()}],"rounded-se":[{"rounded-se":ye()}],"rounded-ee":[{"rounded-ee":ye()}],"rounded-es":[{"rounded-es":ye()}],"rounded-tl":[{"rounded-tl":ye()}],"rounded-tr":[{"rounded-tr":ye()}],"rounded-br":[{"rounded-br":ye()}],"rounded-bl":[{"rounded-bl":ye()}],"border-w":[{border:be()}],"border-w-x":[{"border-x":be()}],"border-w-y":[{"border-y":be()}],"border-w-s":[{"border-s":be()}],"border-w-e":[{"border-e":be()}],"border-w-t":[{"border-t":be()}],"border-w-r":[{"border-r":be()}],"border-w-b":[{"border-b":be()}],"border-w-l":[{"border-l":be()}],"divide-x":[{"divide-x":be()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":be()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...xe(),"hidden","none"]}],"divide-style":[{divide:[...xe(),"hidden","none"]}],"border-color":[{border:X()}],"border-color-x":[{"border-x":X()}],"border-color-y":[{"border-y":X()}],"border-color-s":[{"border-s":X()}],"border-color-e":[{"border-e":X()}],"border-color-t":[{"border-t":X()}],"border-color-r":[{"border-r":X()}],"border-color-b":[{"border-b":X()}],"border-color-l":[{"border-l":X()}],"divide-color":[{divide:X()}],"outline-style":[{outline:[...xe(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Vt,ct,lt]}],"outline-w":[{outline:["",Vt,om,cd]}],"outline-color":[{outline:X()}],shadow:[{shadow:["","none",h,y0,g0]}],"shadow-color":[{shadow:X()}],"inset-shadow":[{"inset-shadow":["none",m,y0,g0]}],"inset-shadow-color":[{"inset-shadow":X()}],"ring-w":[{ring:be()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:X()}],"ring-offset-w":[{"ring-offset":[Vt,cd]}],"ring-offset-color":[{"ring-offset":X()}],"inset-ring-w":[{"inset-ring":be()}],"inset-ring-color":[{"inset-ring":X()}],"text-shadow":[{"text-shadow":["none",g,y0,g0]}],"text-shadow-color":[{"text-shadow":X()}],opacity:[{opacity:[Vt,ct,lt]}],"mix-blend":[{"mix-blend":[..._e(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":_e()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Vt]}],"mask-image-linear-from-pos":[{"mask-linear-from":we()}],"mask-image-linear-to-pos":[{"mask-linear-to":we()}],"mask-image-linear-from-color":[{"mask-linear-from":X()}],"mask-image-linear-to-color":[{"mask-linear-to":X()}],"mask-image-t-from-pos":[{"mask-t-from":we()}],"mask-image-t-to-pos":[{"mask-t-to":we()}],"mask-image-t-from-color":[{"mask-t-from":X()}],"mask-image-t-to-color":[{"mask-t-to":X()}],"mask-image-r-from-pos":[{"mask-r-from":we()}],"mask-image-r-to-pos":[{"mask-r-to":we()}],"mask-image-r-from-color":[{"mask-r-from":X()}],"mask-image-r-to-color":[{"mask-r-to":X()}],"mask-image-b-from-pos":[{"mask-b-from":we()}],"mask-image-b-to-pos":[{"mask-b-to":we()}],"mask-image-b-from-color":[{"mask-b-from":X()}],"mask-image-b-to-color":[{"mask-b-to":X()}],"mask-image-l-from-pos":[{"mask-l-from":we()}],"mask-image-l-to-pos":[{"mask-l-to":we()}],"mask-image-l-from-color":[{"mask-l-from":X()}],"mask-image-l-to-color":[{"mask-l-to":X()}],"mask-image-x-from-pos":[{"mask-x-from":we()}],"mask-image-x-to-pos":[{"mask-x-to":we()}],"mask-image-x-from-color":[{"mask-x-from":X()}],"mask-image-x-to-color":[{"mask-x-to":X()}],"mask-image-y-from-pos":[{"mask-y-from":we()}],"mask-image-y-to-pos":[{"mask-y-to":we()}],"mask-image-y-from-color":[{"mask-y-from":X()}],"mask-image-y-to-color":[{"mask-y-to":X()}],"mask-image-radial":[{"mask-radial":[ct,lt]}],"mask-image-radial-from-pos":[{"mask-radial-from":we()}],"mask-image-radial-to-pos":[{"mask-radial-to":we()}],"mask-image-radial-from-color":[{"mask-radial-from":X()}],"mask-image-radial-to-color":[{"mask-radial-to":X()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":T()}],"mask-image-conic-pos":[{"mask-conic":[Vt]}],"mask-image-conic-from-pos":[{"mask-conic-from":we()}],"mask-image-conic-to-pos":[{"mask-conic-to":we()}],"mask-image-conic-from-color":[{"mask-conic-from":X()}],"mask-image-conic-to-color":[{"mask-conic-to":X()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:J()}],"mask-repeat":[{mask:ne()}],"mask-size":[{mask:Se()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",ct,lt]}],filter:[{filter:["","none",ct,lt]}],blur:[{blur:Oe()}],brightness:[{brightness:[Vt,ct,lt]}],contrast:[{contrast:[Vt,ct,lt]}],"drop-shadow":[{"drop-shadow":["","none",y,y0,g0]}],"drop-shadow-color":[{"drop-shadow":X()}],grayscale:[{grayscale:["",Vt,ct,lt]}],"hue-rotate":[{"hue-rotate":[Vt,ct,lt]}],invert:[{invert:["",Vt,ct,lt]}],saturate:[{saturate:[Vt,ct,lt]}],sepia:[{sepia:["",Vt,ct,lt]}],"backdrop-filter":[{"backdrop-filter":["","none",ct,lt]}],"backdrop-blur":[{"backdrop-blur":Oe()}],"backdrop-brightness":[{"backdrop-brightness":[Vt,ct,lt]}],"backdrop-contrast":[{"backdrop-contrast":[Vt,ct,lt]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Vt,ct,lt]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Vt,ct,lt]}],"backdrop-invert":[{"backdrop-invert":["",Vt,ct,lt]}],"backdrop-opacity":[{"backdrop-opacity":[Vt,ct,lt]}],"backdrop-saturate":[{"backdrop-saturate":[Vt,ct,lt]}],"backdrop-sepia":[{"backdrop-sepia":["",Vt,ct,lt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":D()}],"border-spacing-x":[{"border-spacing-x":D()}],"border-spacing-y":[{"border-spacing-y":D()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",ct,lt]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Vt,"initial",ct,lt]}],ease:[{ease:["linear","initial",_,ct,lt]}],delay:[{delay:[Vt,ct,lt]}],animate:[{animate:["none",A,ct,lt]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[j,ct,lt]}],"perspective-origin":[{"perspective-origin":P()}],rotate:[{rotate:ae()}],"rotate-x":[{"rotate-x":ae()}],"rotate-y":[{"rotate-y":ae()}],"rotate-z":[{"rotate-z":ae()}],scale:[{scale:ie()}],"scale-x":[{"scale-x":ie()}],"scale-y":[{"scale-y":ie()}],"scale-z":[{"scale-z":ie()}],"scale-3d":["scale-3d"],skew:[{skew:pe()}],"skew-x":[{"skew-x":pe()}],"skew-y":[{"skew-y":pe()}],transform:[{transform:[ct,lt,"","none","gpu","cpu"]}],"transform-origin":[{origin:P()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:re()}],"translate-x":[{"translate-x":re()}],"translate-y":[{"translate-y":re()}],"translate-z":[{"translate-z":re()}],"translate-none":["translate-none"],accent:[{accent:X()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:X()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ct,lt]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":D()}],"scroll-mx":[{"scroll-mx":D()}],"scroll-my":[{"scroll-my":D()}],"scroll-ms":[{"scroll-ms":D()}],"scroll-me":[{"scroll-me":D()}],"scroll-mt":[{"scroll-mt":D()}],"scroll-mr":[{"scroll-mr":D()}],"scroll-mb":[{"scroll-mb":D()}],"scroll-ml":[{"scroll-ml":D()}],"scroll-p":[{"scroll-p":D()}],"scroll-px":[{"scroll-px":D()}],"scroll-py":[{"scroll-py":D()}],"scroll-ps":[{"scroll-ps":D()}],"scroll-pe":[{"scroll-pe":D()}],"scroll-pt":[{"scroll-pt":D()}],"scroll-pr":[{"scroll-pr":D()}],"scroll-pb":[{"scroll-pb":D()}],"scroll-pl":[{"scroll-pl":D()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ct,lt]}],fill:[{fill:["none",...X()]}],"stroke-w":[{stroke:[Vt,om,cd,hN]}],stroke:[{stroke:["none",...X()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Soe=soe(joe);function _t(...t){return Soe(cn(t))}const Re=b.forwardRef(({className:t,...n},r)=>a.jsx("div",{ref:r,className:_t("rounded-xl border bg-card text-card-foreground shadow",t),...n}));Re.displayName="Card";const Ye=b.forwardRef(({className:t,...n},r)=>a.jsx("div",{ref:r,className:_t("flex flex-col space-y-1.5 p-6",t),...n}));Ye.displayName="CardHeader";const Ze=b.forwardRef(({className:t,...n},r)=>a.jsx("div",{ref:r,className:_t("font-semibold leading-none tracking-tight",t),...n}));Ze.displayName="CardTitle";const ma=b.forwardRef(({className:t,...n},r)=>a.jsx("div",{ref:r,className:_t("text-sm text-muted-foreground",t),...n}));ma.displayName="CardDescription";const Be=b.forwardRef(({className:t,...n},r)=>a.jsx("div",{ref:r,className:_t("p-6 pt-0",t),...n}));Be.displayName="CardContent";const Coe=b.forwardRef(({className:t,...n},r)=>a.jsx("div",{ref:r,className:_t("flex items-center p-6 pt-0",t),...n}));Coe.displayName="CardFooter";const ZI=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,JI=cn,wv=(t,n)=>r=>{var s;if((n==null?void 0:n.variants)==null)return JI(t,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:i,defaultVariants:o}=n,l=Object.keys(i).map(u=>{const h=r==null?void 0:r[u],m=o==null?void 0:o[u];if(h===null)return null;const g=ZI(h)||ZI(m);return i[u][g]}),c=r&&Object.entries(r).reduce((u,h)=>{let[m,g]=h;return g===void 0||(u[m]=g),u},{}),d=n==null||(s=n.compoundVariants)===null||s===void 0?void 0:s.reduce((u,h)=>{let{class:m,className:g,...y}=h;return Object.entries(y).every(N=>{let[j,S]=N;return Array.isArray(S)?S.includes({...o,...c}[j]):{...o,...c}[j]===S})?[...u,m,g]:u},[]);return JI(t,l,d,r==null?void 0:r.class,r==null?void 0:r.className)},_oe=wv("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Ge({className:t,variant:n,...r}){return a.jsx("div",{className:_t(_oe({variant:n}),t),...r})}function eP(t,n){if(typeof t=="function")return t(n);t!=null&&(t.current=n)}function uB(...t){return n=>{let r=!1;const s=t.map(i=>{const o=eP(i,n);return!r&&typeof o=="function"&&(r=!0),o});if(r)return()=>{for(let i=0;i<s.length;i++){const o=s[i];typeof o=="function"?o():eP(t[i],null)}}}}function vn(...t){return b.useCallback(uB(...t),t)}function Yf(t){const n=Eoe(t),r=b.forwardRef((s,i)=>{const{children:o,...l}=s,c=b.Children.toArray(o),d=c.find(Toe);if(d){const u=d.props.children,h=c.map(m=>m===d?b.Children.count(u)>1?b.Children.only(null):b.isValidElement(u)?u.props.children:null:m);return a.jsx(n,{...l,ref:i,children:b.isValidElement(u)?b.cloneElement(u,void 0,h):null})}return a.jsx(n,{...l,ref:i,children:o})});return r.displayName=`${t}.Slot`,r}var Aoe=Yf("Slot");function Eoe(t){const n=b.forwardRef((r,s)=>{const{children:i,...o}=r;if(b.isValidElement(i)){const l=Poe(i),c=Ioe(o,i.props);return i.type!==b.Fragment&&(c.ref=s?uB(s,l):l),b.cloneElement(i,c)}return b.Children.count(i)>1?b.Children.only(null):null});return n.displayName=`${t}.SlotClone`,n}var koe=Symbol("radix.slottable");function Toe(t){return b.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===koe}function Ioe(t,n){const r={...n};for(const s in n){const i=t[s],o=n[s];/^on[A-Z]/.test(s)?i&&o?r[s]=(...c)=>{const d=o(...c);return i(...c),d}:i&&(r[s]=i):s==="style"?r[s]={...i,...o}:s==="className"&&(r[s]=[i,o].filter(Boolean).join(" "))}return{...t,...r}}function Poe(t){var s,i;let n=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,r=n&&"isReactWarning"in n&&n.isReactWarning;return r?t.ref:(n=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,r=n&&"isReactWarning"in n&&n.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}const Moe=wv("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Te=b.forwardRef(({className:t,variant:n,size:r,asChild:s=!1,...i},o)=>{const l=s?Aoe:"button";return a.jsx(l,{className:_t(Moe({variant:n,size:r,className:t})),ref:o,...i})});Te.displayName="Button";const Ne=b.forwardRef(({className:t,type:n,...r},s)=>a.jsx("input",{type:n,className:_t("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...r}));Ne.displayName="Input";function Ic({variant:t="default",className:n,children:r,...s}){const i="relative w-full rounded-lg border px-4 py-3 text-sm flex gap-3 items-start",o={default:"bg-slate-50 border-slate-200 text-slate-800",destructive:"bg-rose-50 border-rose-200 text-rose-800"};return a.jsx("div",{role:"alert",className:_t(i,o[t]||o.default,n),...s,children:r})}function Pc({className:t,children:n,...r}){return a.jsx("div",{className:_t("font-semibold leading-tight text-sm",t),...r,children:n})}function Mc({className:t,children:n,...r}){return a.jsx("div",{className:_t("text-xs mt-1 text-slate-700",t),...r,children:n})}function Xe({className:t,...n}){return a.jsx("div",{className:_t("animate-pulse rounded-md bg-primary/10",t),...n})}const v0={initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.18}};function Ooe(){const{hasAny:t,canView:n,canCreate:r,canUpdate:s,canDelete:i}=bv("departments"),[o,l]=b.useState([]),[c,d]=b.useState({name:"",description:""}),[u,h]=b.useState(null),[m,g]=b.useState(""),[y,N]=b.useState(!1),[j,S]=b.useState(!1),_=b.useCallback(async()=>{var P,M,O;if(n){g(""),S(!0);try{const{data:D}=await te.get("/departments/");l(D||[])}catch(D){const L=(P=D==null?void 0:D.response)==null?void 0:P.status;g(L===403?"Access denied for Departments.":L===401?"Session expired. Please login again.":((O=(M=D==null?void 0:D.response)==null?void 0:M.data)==null?void 0:O.detail)||"Failed to load departments.")}finally{S(!1)}}},[n]);b.useEffect(()=>{_()},[_]);const A=async P=>{var M,O,D;if(P.preventDefault(),!(!u&&!r)&&!(u&&!s)){N(!0),g("");try{u?await te.put(`/departments/${u}`,c):await te.post("/departments/",c),d({name:"",description:""}),h(null),_()}catch(L){const $=(M=L==null?void 0:L.response)==null?void 0:M.status;g($===403?"Access denied.":$===401?"Session expired. Please login again.":((D=(O=L==null?void 0:L.response)==null?void 0:O.data)==null?void 0:D.detail)||"Failed to save department.")}finally{N(!1)}}},k=async P=>{var M,O,D;if(i&&window.confirm("Delete this department?"))try{await te.delete(`/departments/${P}`),_()}catch(L){const $=(M=L==null?void 0:L.response)==null?void 0:M.status;g($===403?"Access denied.":$===401?"Session expired. Please login again.":((D=(O=L==null?void 0:L.response)==null?void 0:O.data)==null?void 0:D.detail)||"Failed to delete department.")}},T=P=>{s&&(h(P.id),d({name:P.name,description:P.description||""}))};return!t||!n?a.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-4 md:px-6 md:py-6 lg:px-8",children:a.jsx("div",{className:"mx-auto max-w-6xl",children:a.jsxs(Re,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsx(Ye,{children:a.jsx(Ze,{className:"text-base text-slate-900",children:"Departments"})}),a.jsx(Be,{children:a.jsxs(Ic,{variant:"destructive",className:"border-amber-200 bg-amber-50 text-amber-800",children:[a.jsx(Pc,{children:"Access restricted"}),a.jsx(Mc,{className:"text-sm",children:"You dont have permission to view the Departments module."})]})})]})})}):a.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-4 md:px-6 md:py-6 lg:px-8",children:a.jsxs("div",{className:"mx-auto max-w-6xl space-y-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsx(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-white px-2.5 py-1 text-[10px] font-medium tracking-wide text-slate-600",children:"Admin  Departments"}),a.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-slate-500",children:[a.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 shadow-sm animate-pulse"}),a.jsx("span",{children:"Desktop workspace"})]})]}),a.jsx(ht.div,{...v0,children:a.jsx(Re,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:a.jsxs(Ye,{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-3xl bg-slate-900 text-slate-50",children:a.jsx(fl,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx(Ze,{className:"text-base sm:text-lg text-slate-900",children:"Clinical & support departments"}),a.jsx("p",{className:"mt-1 text-xs text-slate-600",children:"Configure OPD, IPD, diagnostics and support departments to align users, doctors and services."})]})]}),a.jsx("div",{className:"grid w-full gap-2 sm:w-auto sm:grid-cols-1",children:a.jsx(Doe,{label:"Departments",value:o.length,hint:"Mapped across OPD, IPD, lab, radiology, etc."})})]})})}),m&&a.jsx(ht.div,{...v0,children:a.jsxs(Ic,{variant:"destructive",className:"rounded-2xl border-red-200 bg-red-50 text-red-800",children:[a.jsx(Pc,{children:"Issue"}),a.jsx(Mc,{className:"text-sm",children:m})]})}),a.jsxs("div",{className:"grid items-start gap-4 lg:grid-cols-[minmax(0,260px)_minmax(0,1fr)]",children:[a.jsx(ht.div,{...v0,children:a.jsxs(Re,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsxs(Ye,{className:"pb-3",children:[a.jsx(Ze,{className:"text-sm font-semibold text-slate-900",children:u?"Edit department":"Create department"}),a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Add or update hospital departments that will be used across modules."})]}),a.jsx(Be,{children:a.jsxs("form",{onSubmit:A,className:"grid gap-3",children:[a.jsx(Ne,{placeholder:"Department name (e.g., General Medicine)",value:c.name,onChange:P=>d({...c,name:P.target.value}),required:!0,disabled:!(u?s:r),className:"h-8 rounded-2xl border-slate-200 bg-slate-50 text-xs"}),a.jsx(Ne,{placeholder:"Description (optional)",value:c.description,onChange:P=>d({...c,description:P.target.value}),disabled:!(u?s:r),className:"h-8 rounded-2xl border-slate-200 bg-slate-50 text-xs"}),a.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[u&&a.jsx("button",{type:"button",onClick:()=>{h(null),d({name:"",description:""})},className:"text-[11px] text-slate-500 underline",children:"Cancel edit & reset"}),a.jsx(Te,{type:"submit",className:"ml-auto rounded-2xl bg-slate-900 px-4 py-1.5 text-xs font-medium text-white hover:bg-slate-800",disabled:y||(u?!s:!r),children:y?"Saving...":u?"Update department":"Create department"})]})]})})]})}),a.jsx(ht.div,{...v0,children:a.jsxs(Re,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsx(Ye,{className:"border-b border-slate-100 pb-3",children:a.jsx("div",{className:"flex items-center justify-between gap-2",children:a.jsxs("div",{children:[a.jsx(Ze,{className:"text-sm font-semibold text-slate-900",children:"Department list"}),a.jsxs("p",{className:"mt-1 text-[11px] text-slate-500",children:[o.length," configured department(s)."]})]})})}),a.jsx(Be,{className:"pt-4",children:j?a.jsx("div",{className:"space-y-2",children:[0,1,2].map(P=>a.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-3",children:[a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx(Xe,{className:"h-3 w-1/3 rounded-full bg-slate-100"}),a.jsx(Xe,{className:"h-2.5 w-1/2 rounded-full bg-slate-100"})]}),a.jsx(Xe,{className:"h-6 w-20 rounded-full bg-slate-100"})]},P))}):a.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:a.jsxs("table",{className:"min-w-full text-xs",children:[a.jsx("thead",{className:"bg-slate-50 text-[11px] font-medium text-slate-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 text-left",children:"#"}),a.jsx("th",{className:"p-2 text-left",children:"Name"}),a.jsx("th",{className:"p-2 text-left",children:"Description"}),a.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[o.map((P,M)=>a.jsxs("tr",{className:"border-t border-slate-100 text-xs text-slate-800",children:[a.jsx("td",{className:"p-2",children:M+1}),a.jsx("td",{className:"p-2",children:P.name}),a.jsx("td",{className:"p-2 text-slate-500",children:P.description||""}),a.jsx("td",{className:"p-2 text-right",children:a.jsxs("div",{className:"inline-flex gap-2",children:[s&&a.jsx(Te,{type:"button",variant:"outline",size:"sm",className:"h-7 rounded-2xl border-slate-200 px-3 text-[11px]",onClick:()=>T(P),children:"Edit"}),i&&a.jsx(Te,{type:"button",variant:"outline",size:"sm",className:"h-7 rounded-2xl border border-rose-200 px-3 text-[11px] text-rose-700 hover:bg-rose-50",onClick:()=>k(P.id),children:"Delete"})]})})]},P.id)),!o.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"p-4",children:a.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-4 py-5 text-center",children:[a.jsx("p",{className:"text-sm font-medium text-slate-700",children:"No departments yet."}),a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Use the form on the left to add your first department."})]})})})]})]})})})]})})]})]})})}function Doe({label:t,value:n,hint:r}){return a.jsxs(ht.div,{whileHover:{y:-2,scale:1.01},className:"rounded-2xl border border-slate-200 bg-white px-3 py-2 text-[11px] text-slate-600",children:[a.jsx("div",{className:"text-[10px] font-medium uppercase tracking-wide text-slate-500",children:t}),a.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:n}),r&&a.jsx("div",{className:"mt-0.5 text-[10px] text-slate-400",children:r})]})}const b0={initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.18}};function Roe(){const{hasAny:t,canView:n,canCreate:r,canUpdate:s,canDelete:i}=bv("roles"),[o,l]=b.useState([]),[c,d]=b.useState([]),[u,h]=b.useState({name:"",description:"",permission_ids:[]}),[m,g]=b.useState(null),[y,N]=b.useState(!1),[j,S]=b.useState(!1),[_,A]=b.useState(""),k=b.useCallback(async()=>{var D,L,$;if(n){A(""),S(!0);try{const[V,F]=await Promise.all([te.get("/roles/"),te.get("/permissions/")]);l(V.data||[]),d(F.data||[])}catch(V){const F=(D=V==null?void 0:V.response)==null?void 0:D.status;A(F===403?"Access denied for Roles.":F===401?"Session expired. Please login again.":(($=(L=V==null?void 0:V.response)==null?void 0:L.data)==null?void 0:$.detail)||"Failed to load roles.")}finally{S(!1)}}},[n]);b.useEffect(()=>{k()},[k]);const T=D=>{h(L=>({...L,permission_ids:L.permission_ids.includes(D)?L.permission_ids.filter($=>$!==D):[...L.permission_ids,D]}))},P=async D=>{var L,$;if(D.preventDefault(),!(!m&&!r)&&!(m&&!s)){N(!0),A("");try{m?await te.put(`/roles/${m}`,u):await te.post("/roles/",u),h({name:"",description:"",permission_ids:[]}),g(null),k()}catch(V){A((($=(L=V==null?void 0:V.response)==null?void 0:L.data)==null?void 0:$.detail)||"Failed to save role.")}finally{N(!1)}}},M=D=>{s&&(g(D.id),h({name:D.name,description:D.description||"",permission_ids:D.permission_ids||[]}))},O=async D=>{var L,$;if(i&&window.confirm("Delete this role?"))try{await te.delete(`/roles/${D}`),k()}catch(V){A((($=(L=V==null?void 0:V.response)==null?void 0:L.data)==null?void 0:$.detail)||"Failed to delete role.")}};return!t||!n?a.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-4 md:px-6 md:py-6 lg:px-8",children:a.jsx("div",{className:"mx-auto max-w-6xl",children:a.jsxs(Re,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsx(Ye,{children:a.jsx(Ze,{className:"text-base text-slate-900",children:"Roles"})}),a.jsx(Be,{children:a.jsxs(Ic,{variant:"destructive",className:"border-amber-200 bg-amber-50 text-amber-800",children:[a.jsx(Pc,{children:"Access restricted"}),a.jsx(Mc,{className:"text-sm",children:"You dont have permission to view the Roles module."})]})})]})})}):a.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-4 md:px-6 md:py-6 lg:px-8",children:a.jsxs("div",{className:"mx-auto max-w-6xl space-y-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsx(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-white px-2.5 py-1 text-[10px] font-medium tracking-wide text-slate-600",children:"Admin  Roles & permissions"}),a.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-slate-500",children:[a.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 shadow-sm animate-pulse"}),a.jsx("span",{children:"Desktop workspace"})]})]}),a.jsx(ht.div,{...b0,children:a.jsx(Re,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:a.jsxs(Ye,{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-3xl bg-slate-900 text-slate-50",children:a.jsx(_o,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx(Ze,{className:"text-base sm:text-lg text-slate-900",children:"Roles & Permissions"}),a.jsx("p",{className:"mt-1 text-xs text-slate-600",children:"Define role templates and attach permission sets for OPD, IPD, billing, pharmacy, lab and other modules."})]})]}),a.jsxs("div",{className:"grid w-full gap-2 sm:w-auto sm:grid-cols-2",children:[a.jsx(tP,{label:"Roles",value:o.length,hint:"Reusable access profiles"}),a.jsx(tP,{label:"Permissions",value:c.length,hint:"Atomic permission codes"})]})]})})}),_&&a.jsx(ht.div,{...b0,children:a.jsxs(Ic,{variant:"destructive",className:"rounded-2xl border-red-200 bg-red-50 text-red-800",children:[a.jsx(Pc,{children:"Issue"}),a.jsx(Mc,{className:"text-sm",children:_})]})}),a.jsxs("div",{className:"grid items-start gap-4 lg:grid-cols-[minmax(0,290px)_minmax(0,1fr)]",children:[a.jsx(ht.div,{...b0,children:a.jsxs(Re,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsx(Ye,{className:"pb-3",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-2xl bg-slate-900 text-slate-50",children:a.jsx(Xo,{className:"h-4 w-4"})}),a.jsxs("div",{children:[a.jsx(Ze,{className:"text-sm font-semibold text-slate-900",children:m?"Edit role":"Create role"}),a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Group permissions into named roles and assign them to users."})]})]})}),a.jsx(Be,{className:"space-y-3",children:a.jsxs("form",{onSubmit:P,className:"space-y-3",children:[a.jsxs("div",{className:"grid gap-2",children:[a.jsx(Ne,{placeholder:"Role name (e.g., OPD Doctor)",value:u.name,onChange:D=>h({...u,name:D.target.value}),required:!0,disabled:!(m?s:r),className:"h-8 rounded-2xl border-slate-200 bg-slate-50 text-xs"}),a.jsx(Ne,{placeholder:"Description (optional)",value:u.description,onChange:D=>h({...u,description:D.target.value}),disabled:!(m?s:r),className:"h-8 rounded-2xl border-slate-200 bg-slate-50 text-xs"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-[11px]",children:[a.jsx("span",{className:"font-medium text-slate-700",children:"Permissions"}),a.jsxs("span",{className:"text-slate-400",children:[u.permission_ids.length||0," selected"]})]}),a.jsxs("div",{className:"max-h-64 space-y-1 overflow-y-auto rounded-2xl border border-slate-100 bg-slate-50 px-2 py-2",children:[c.map(D=>a.jsxs("label",{className:`flex cursor-pointer items-start gap-2 rounded-2xl px-2 py-1.5 text-[11px] ${u.permission_ids.includes(D.id)?"bg-white":"bg-slate-50"}`,children:[a.jsx("input",{type:"checkbox",checked:u.permission_ids.includes(D.id),onChange:()=>T(D.id),disabled:!(m?s:r),className:"mt-0.5 h-3.5 w-3.5 rounded border-slate-300"}),a.jsxs("span",{children:[a.jsx("span",{className:"block font-medium text-slate-800",children:D.label}),a.jsx("span",{className:"block text-[10px] text-slate-500",children:D.code})]})]},D.id)),!c.length&&!j&&a.jsx("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-3 py-2 text-[11px] text-slate-500",children:"No permissions configured yet."}),j&&a.jsx("div",{className:"space-y-2",children:[0,1,2].map(D=>a.jsxs("div",{className:"flex items-center gap-2 rounded-2xl px-2 py-1.5",children:[a.jsx(Xe,{className:"h-3 w-3 rounded bg-slate-100"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx(Xe,{className:"h-3 w-1/2 rounded-full bg-slate-100"}),a.jsx(Xe,{className:"h-2 w-1/3 rounded-full bg-slate-100"})]})]},D))})]})]}),a.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[m&&a.jsx("button",{type:"button",onClick:()=>{g(null),h({name:"",description:"",permission_ids:[]})},className:"text-[11px] text-slate-500 underline",children:"Cancel edit & reset"}),a.jsx(Te,{type:"submit",className:"ml-auto rounded-2xl bg-slate-900 px-4 py-1.5 text-xs font-medium text-white hover:bg-slate-800",disabled:y||(m?!s:!r),children:y?"Saving...":m?"Update role":"Create role"})]})]})})]})}),a.jsx(ht.div,{...b0,children:a.jsxs(Re,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsx(Ye,{className:"border-b border-slate-100 pb-3",children:a.jsx("div",{className:"flex items-center justify-between gap-2",children:a.jsxs("div",{children:[a.jsx(Ze,{className:"text-sm font-semibold text-slate-900",children:"Role list"}),a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Overview of all defined roles and number of attached permissions."})]})})}),a.jsx(Be,{className:"pt-4",children:j?a.jsx("div",{className:"space-y-2",children:[0,1,2].map(D=>a.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-3",children:[a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx(Xe,{className:"h-3 w-1/3 rounded-full bg-slate-100"}),a.jsx(Xe,{className:"h-2.5 w-1/4 rounded-full bg-slate-100"})]}),a.jsx(Xe,{className:"h-6 w-20 rounded-full bg-slate-100"})]},D))}):a.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:a.jsxs("table",{className:"min-w-full text-xs",children:[a.jsx("thead",{className:"bg-slate-50 text-[11px] font-medium text-slate-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 text-left",children:"#"}),a.jsx("th",{className:"p-2 text-left",children:"Role name"}),a.jsx("th",{className:"p-2 text-left",children:"Description"}),a.jsx("th",{className:"p-2 text-left",children:"Permissions"}),a.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[o.map((D,L)=>{var $;return a.jsxs("tr",{className:"border-t border-slate-100 text-xs text-slate-800",children:[a.jsx("td",{className:"p-2",children:L+1}),a.jsx("td",{className:"p-2",children:D.name}),a.jsx("td",{className:"p-2 text-slate-500",children:D.description||""}),a.jsxs("td",{className:"p-2 text-slate-600",children:[(($=D.permission_ids)==null?void 0:$.length)||0," permissions"]}),a.jsx("td",{className:"p-2 text-right",children:a.jsxs("div",{className:"inline-flex gap-2",children:[s&&a.jsx(Te,{type:"button",variant:"outline",size:"sm",className:"h-7 rounded-2xl border-slate-200 px-3 text-[11px]",onClick:()=>M(D),children:"Edit"}),i&&a.jsx(Te,{type:"button",variant:"outline",size:"sm",className:"h-7 rounded-2xl border border-rose-200 px-3 text-[11px] text-rose-700 hover:bg-rose-50",onClick:()=>O(D.id),children:"Delete"})]})})]},D.id)}),!o.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"p-4",children:a.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-4 py-5 text-center",children:[a.jsx("p",{className:"text-sm font-medium text-slate-700",children:"No roles defined yet."}),a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Create a role on the left to start grouping permissions."})]})})})]})]})})})]})})]})]})})}function tP({label:t,value:n,hint:r}){return a.jsxs(ht.div,{whileHover:{y:-2,scale:1.01},className:"rounded-2xl border border-slate-200 bg-white px-3 py-2 text-[11px] text-slate-600",children:[a.jsx("div",{className:"text-[10px] font-medium uppercase tracking-wide text-slate-500",children:t}),a.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:n}),r&&a.jsx("div",{className:"mt-0.5 text-[10px] text-slate-400",children:r})]})}function Loe(){const{hasAny:t,canView:n,canCreate:r,canUpdate:s,canDelete:i}=bv("permissions"),[o,l]=b.useState([]),[c,d]=b.useState({code:"",label:"",module:""}),[u,h]=b.useState(null),[m,g]=b.useState(!1),[y,N]=b.useState(""),j=b.useCallback(async()=>{var k,T,P;if(n){N("");try{const M=await te.get("/permissions/");l(M.data)}catch(M){const O=(k=M==null?void 0:M.response)==null?void 0:k.status;N(O===403?"Access denied for Permissions.":O===401?"Session expired. Please login again.":((P=(T=M==null?void 0:M.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to load")}}},[n]);b.useEffect(()=>{j()},[j]);const S=async k=>{var T,P;if(k.preventDefault(),!(!u&&!r)&&!(u&&!s)){g(!0),N("");try{u?await te.put(`/permissions/${u}`,c):await te.post("/permissions/",c),d({code:"",label:"",module:""}),h(null),j()}catch(M){N(((P=(T=M==null?void 0:M.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to save")}finally{g(!1)}}},_=async k=>{var T,P;if(i&&confirm("Delete this permission?"))try{await te.delete(`/permissions/${k}`),j()}catch(M){N(((P=(T=M==null?void 0:M.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to delete")}},A=k=>{s&&(h(k.id),d({code:k.code,label:k.label,module:k.module}))};return!t||!n?a.jsxs("section",{className:"card",children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Permissions"}),a.jsx("div",{className:"rounded-xl border border-amber-200 bg-amber-50 p-3 text-sm text-amber-700",children:"You dont have access to view this module."})]}):a.jsxs("section",{className:"card text-black",children:[a.jsx("div",{className:"flex items-center justify-between mb-4",children:a.jsx("h3",{className:"text-lg font-semibold",children:"Permissions"})}),a.jsxs("form",{onSubmit:S,className:"grid md:grid-cols-4 gap-3 mb-4",children:[a.jsx("input",{className:"input",placeholder:"code (e.g. users.view)",value:c.code,onChange:k=>d({...c,code:k.target.value}),required:!0,disabled:!(u?s:r)}),a.jsx("input",{className:"input",placeholder:"label (Users  View)",value:c.label,onChange:k=>d({...c,label:k.target.value}),required:!0,disabled:!(u?s:r)}),a.jsx("input",{className:"input",placeholder:"module (users)",value:c.module,onChange:k=>d({...c,module:k.target.value}),required:!0,disabled:!(u?s:r)}),a.jsx("button",{className:"btn",disabled:m||(u?!s:!r),children:u?"Update":"Create"})]}),y&&a.jsx("div",{className:"mb-4 rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:y}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-left",children:[a.jsx("th",{className:"p-2",children:"#"}),a.jsx("th",{className:"p-2",children:"Code"}),a.jsx("th",{className:"p-2",children:"Label"}),a.jsx("th",{className:"p-2",children:"Module"}),a.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[o.map((k,T)=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"p-2",children:T+1}),a.jsx("td",{className:"p-2 font-mono text-xs",children:k.code}),a.jsx("td",{className:"p-2",children:k.label}),a.jsx("td",{className:"p-2",children:k.module}),a.jsxs("td",{className:"p-2 text-right space-x-2",children:[s&&a.jsx("button",{className:"px-3 py-2 rounded-xl border",onClick:()=>A(k),children:"Edit"}),i&&a.jsx("button",{className:"px-3 py-2 rounded-xl border",onClick:()=>_(k.id),children:"Delete"})]})]},k.id)),!o.length&&a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-sm text-gray-500",colSpan:"5",children:"No permissions yet."})})]})]})})]})}const w0={initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.18}};function Boe(){const{hasAny:t,canView:n,canCreate:r,canUpdate:s,canDelete:i}=bv("users"),[o,l]=b.useState([]),[c,d]=b.useState([]),[u,h]=b.useState([]),[m,g]=b.useState({name:"",email:"",password:"",department_id:"",role_ids:[],is_doctor:!1,is_active:!0}),[y,N]=b.useState(null),[j,S]=b.useState(!1),[_,A]=b.useState(!1),[k,T]=b.useState(""),[P,M]=b.useState("all"),[O,D]=b.useState(""),L=y?s:r,$=b.useCallback(async()=>{var ne,Se,de;if(n){T(""),A(!0);try{const[ye,be,xe]=await Promise.all([te.get("/users/"),te.get("/roles/").catch(()=>({data:[]})),te.get("/departments/").catch(()=>({data:[]}))]);l(ye.data||[]),d(be.data||[]),h(xe.data||[])}catch(ye){const be=(ne=ye==null?void 0:ye.response)==null?void 0:ne.status;T(be===403?"Access denied for Users.":be===401?"Session expired. Please login again.":((de=(Se=ye==null?void 0:ye.response)==null?void 0:Se.data)==null?void 0:de.detail)||"Failed to load users.")}finally{A(!1)}}},[n]);b.useEffect(()=>{$()},[$]);const V=b.useMemo(()=>{const ne={};return u.forEach(Se=>{ne[Se.id]=Se.name}),ne},[u]),F=ne=>{g(Se=>({...Se,role_ids:Se.role_ids.includes(ne)?Se.role_ids.filter(de=>de!==ne):[...Se.role_ids,ne]}))},Q=()=>{g({name:"",email:"",password:"",department_id:"",role_ids:[],is_doctor:!1,is_active:!0}),N(null)},U=async ne=>{var de,ye;if(ne.preventDefault(),!y&&!r||y&&!s)return;S(!0),T("");const Se={...m,department_id:m.department_id?Number(m.department_id):null};try{y?await te.put(`/users/${y}`,Se):await te.post("/users/",Se),Q(),$()}catch(be){T(((ye=(de=be==null?void 0:be.response)==null?void 0:de.data)==null?void 0:ye.detail)||"Failed to save user.")}finally{S(!1)}},z=async ne=>{var Se,de;if(i&&window.confirm("Delete this user?"))try{await te.delete(`/users/${ne}`),$()}catch(ye){T(((de=(Se=ye==null?void 0:ye.response)==null?void 0:Se.data)==null?void 0:de.detail)||"Failed to delete user.")}},q=ne=>{s&&(N(ne.id),g({name:ne.name||"",email:ne.email||"",password:"",department_id:ne.department_id||"",role_ids:ne.role_ids||[],is_doctor:!!ne.is_doctor,is_active:ne.is_active??!0}))},K=b.useMemo(()=>o.filter(ne=>ne.is_doctor).length,[o]),X=b.useMemo(()=>o.filter(ne=>ne.is_active).length,[o]),J=b.useMemo(()=>{let ne=o;if(P==="doctors"&&(ne=ne.filter(Se=>Se.is_doctor)),O.trim()){const Se=O.toLowerCase();ne=ne.filter(de=>(de.name||"").toLowerCase().includes(Se)||(de.email||"").toLowerCase().includes(Se))}return ne},[o,P,O]);return!t||!n?a.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-4 md:px-6 md:py-6 lg:px-8",children:a.jsx("div",{className:"mx-auto max-w-6xl",children:a.jsxs(Re,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsx(Ye,{children:a.jsx(Ze,{className:"text-base text-slate-900",children:"Users"})}),a.jsx(Be,{children:a.jsxs(Ic,{variant:"destructive",className:"border-amber-200 bg-amber-50 text-amber-800",children:[a.jsx(Pc,{children:"Access restricted"}),a.jsx(Mc,{className:"text-sm",children:"You dont have permission to view the Users module. Contact your administrator for access."})]})})]})})}):a.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-4 md:px-6 md:py-6 lg:px-8",children:a.jsxs("div",{className:"mx-auto max-w-6xl space-y-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsx(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-white px-2.5 py-1 text-[10px] font-medium tracking-wide text-slate-600",children:"Admin  User management"}),a.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-slate-500",children:[a.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 shadow-sm animate-pulse"}),a.jsx("span",{children:"Desktop workspace"})]})]}),a.jsx(ht.div,{...w0,children:a.jsx(Re,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:a.jsxs(Ye,{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-3xl bg-slate-900 text-slate-50",children:a.jsx(wp,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx(Ze,{className:"text-base sm:text-lg text-slate-900",children:"Users & Doctors"}),a.jsx("p",{className:"mt-1 text-xs text-slate-600",children:"Manage staff accounts, link them to departments, assign roles and mark doctors for OPD/IPD routing."})]})]}),a.jsxs("div",{className:"grid w-full gap-2 sm:w-auto sm:grid-cols-3",children:[a.jsx(mN,{label:"Total users",value:o.length,hint:"All active & inactive staff"}),a.jsx(mN,{label:"Doctors",value:K,icon:a.jsx(kn,{className:"h-3 w-3 text-emerald-600"}),hint:"Marked as doctor"}),a.jsx(mN,{label:"Active users",value:X,hint:"Can login today"})]})]})})}),k&&a.jsx(ht.div,{...w0,children:a.jsxs(Ic,{variant:"destructive",className:"rounded-2xl border-red-200 bg-red-50 text-red-800",children:[a.jsx(Pc,{children:"Issue"}),a.jsx(Mc,{className:"text-sm",children:k})]})}),a.jsxs("div",{className:"grid items-start gap-4 lg:grid-cols-[minmax(0,260px)_minmax(0,1fr)]",children:[a.jsx(ht.div,{...w0,children:a.jsxs(Re,{className:"sticky top-20 rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsx(Ye,{className:"pb-3",children:a.jsx("div",{className:"flex items-center justify-between gap-2",children:a.jsxs("div",{children:[a.jsx(Ze,{className:"text-sm font-semibold text-slate-900",children:"Filters & user form"}),a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Filter list and add/update staff users."})]})})}),a.jsxs(Be,{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-2.5 py-1 text-[10px] font-medium text-slate-600",children:[a.jsx(Ec,{className:"h-3 w-3"}),a.jsx("span",{children:"View"})]}),a.jsxs("div",{className:"inline-flex gap-1 rounded-full border border-slate-200 bg-slate-100 p-1 text-[11px]",children:[a.jsx("button",{type:"button",onClick:()=>M("all"),className:`rounded-full px-3 py-1 ${P==="all"?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-800"}`,children:"All users"}),a.jsxs("button",{type:"button",onClick:()=>M("doctors"),className:`inline-flex items-center gap-1 rounded-full px-3 py-1 ${P==="doctors"?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-800"}`,children:[a.jsx(kn,{className:"h-3 w-3"}),"Doctors"]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-600",children:"Search"}),a.jsxs("div",{className:"flex items-center gap-2 rounded-2xl border border-slate-200 bg-slate-50 px-2 py-1.5",children:[a.jsx(vp,{className:"h-3.5 w-3.5 text-slate-400"}),a.jsx(Ne,{placeholder:"Name or email",value:O,onChange:ne=>D(ne.target.value),className:"h-7 border-0 bg-transparent px-0 text-xs focus-visible:ring-0"})]})]})]}),a.jsxs("div",{className:"space-y-3 border-t border-slate-100 pt-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-[11px] font-medium text-slate-700",children:[a.jsx("div",{className:"flex h-6 w-6 items-center justify-center rounded-2xl bg-slate-900 text-slate-50",children:a.jsx(rne,{className:"h-3.5 w-3.5"})}),a.jsx("span",{children:y?"Edit user":"Create new user"})]}),a.jsxs("form",{onSubmit:U,className:"space-y-3",children:[a.jsxs("div",{className:"grid gap-2",children:[a.jsx(Ne,{placeholder:"Full name",value:m.name,onChange:ne=>g({...m,name:ne.target.value}),required:!0,disabled:!L,className:"h-8 rounded-2xl border-slate-200 bg-slate-50 text-xs"}),a.jsx(Ne,{placeholder:"Email",type:"email",value:m.email,onChange:ne=>g({...m,email:ne.target.value}),required:!0,disabled:!L,className:"h-8 rounded-2xl border-slate-200 bg-slate-50 text-xs"}),a.jsx(Ne,{placeholder:y?"Password (leave blank to keep)":"Password",type:"password",value:m.password,onChange:ne=>g({...m,password:ne.target.value}),required:!y,disabled:!L,className:"h-8 rounded-2xl border-slate-200 bg-slate-50 text-xs"}),a.jsxs("div",{className:"space-y-1 text-[11px]",children:[a.jsx("label",{className:"font-medium text-slate-600",children:"Department"}),a.jsxs("select",{value:m.department_id,onChange:ne=>g({...m,department_id:ne.target.value}),disabled:!L,className:"h-8 w-full rounded-2xl border border-slate-200 bg-slate-50 px-2 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-slate-300",children:[a.jsx("option",{value:"",children:"No department"}),u.map(ne=>a.jsx("option",{value:ne.id,children:ne.name},ne.id))]})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 text-[11px]",children:[a.jsxs("label",{className:`inline-flex flex-1 min-w-[140px] cursor-pointer items-center gap-2 rounded-2xl border px-3 py-2 ${m.is_doctor?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white"}`,children:[a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300",checked:m.is_doctor,onChange:ne=>g({...m,is_doctor:ne.target.checked}),disabled:!L}),a.jsxs("span",{className:"inline-flex items-center gap-1 text-slate-700",children:[a.jsx(kn,{className:"h-3.5 w-3.5 text-emerald-600"}),a.jsx("span",{children:"Mark as doctor"})]})]}),a.jsxs("label",{className:`inline-flex flex-1 min-w-[140px] cursor-pointer items-center gap-2 rounded-2xl border px-3 py-2 ${m.is_active?"border-slate-300 bg-slate-50":"border-slate-200 bg-white"}`,children:[a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300",checked:m.is_active,onChange:ne=>g({...m,is_active:ne.target.checked}),disabled:!L}),a.jsxs("span",{className:"inline-flex items-center gap-1 text-slate-700",children:[a.jsx(_o,{className:"h-3.5 w-3.5 text-slate-700"}),a.jsx("span",{children:"Active user"})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-[11px]",children:[a.jsx("span",{className:"font-medium text-slate-700",children:"Roles"}),a.jsxs("span",{className:"text-slate-400",children:[m.role_ids.length||0," selected"]})]}),a.jsxs("div",{className:"grid gap-1.5 sm:grid-cols-2",children:[c.map(ne=>a.jsxs("label",{className:`flex cursor-pointer items-center gap-2 rounded-2xl border px-2.5 py-2 ${m.role_ids.includes(ne.id)?"border-slate-300 bg-slate-50":"border-slate-200 bg-white"}`,children:[a.jsx("input",{type:"checkbox",checked:m.role_ids.includes(ne.id),onChange:()=>F(ne.id),disabled:!L,className:"h-3.5 w-3.5 rounded border-slate-300"}),a.jsx("span",{className:"text-[11px] text-slate-800",children:ne.name})]},ne.id)),!c.length&&a.jsx("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-3 py-2 text-[11px] text-slate-500",children:"No roles configured yet."})]})]}),a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 pt-1",children:[y&&a.jsx("button",{type:"button",onClick:Q,className:"text-[11px] text-slate-500 underline",children:"Cancel edit & clear form"}),a.jsx(Te,{type:"submit",className:"ml-auto rounded-2xl bg-slate-900 px-4 py-1.5 text-xs font-medium text-white hover:bg-slate-800",disabled:j||!L,children:j?"Saving...":y?"Update user":"Create user"})]})]})]})]})]})}),a.jsx(ht.div,{...w0,children:a.jsxs(Re,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsx(Ye,{className:"border-b border-slate-100 pb-3",children:a.jsx("div",{className:"flex items-center justify-between gap-2",children:a.jsxs("div",{children:[a.jsx(Ze,{className:"text-sm font-semibold text-slate-900",children:"User directory"}),a.jsxs("p",{className:"mt-1 text-[11px] text-slate-500",children:[J.length," of ",o.length," records visible in this view."]})]})})}),a.jsx(Be,{className:"space-y-4 pt-4",children:_?a.jsx(Foe,{}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid gap-3 md:hidden",children:[J.map((ne,Se)=>{const de=c.filter(ye=>(ne.role_ids||[]).includes(ye.id)).map(ye=>ye.name);return a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-3",children:[a.jsx("div",{className:"flex items-start justify-between gap-3",children:a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[a.jsxs("span",{className:"text-sm font-semibold text-slate-900",children:[Se+1,". ",ne.name]}),ne.is_doctor&&a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2 py-0.5 text-[10px] font-medium text-emerald-700",children:[a.jsx(kn,{className:"h-3 w-3"}),"Doctor"]}),!ne.is_active&&a.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-600",children:"Inactive"}),ne.is_admin&&a.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-900 px-2 py-0.5 text-[10px] text-white",children:"Admin"})]}),a.jsx("div",{className:"text-[11px] text-slate-500",children:ne.email}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Dept:"," ",a.jsx("span",{className:"font-medium text-slate-700",children:V[ne.department_id]||"-"})]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Roles:"," ",de.length?de.join(", "):"No roles"]})]})}),a.jsxs("div",{className:"mt-3 flex justify-end gap-2 text-[11px]",children:[s&&a.jsx(Te,{type:"button",variant:"outline",size:"sm",className:"h-7 rounded-2xl border-slate-200 px-3 text-[11px]",onClick:()=>q(ne),children:"Edit"}),i&&a.jsx(Te,{type:"button",variant:"outline",size:"sm",className:"h-7 rounded-2xl border border-rose-200 px-3 text-[11px] text-rose-700 hover:bg-rose-50",onClick:()=>z(ne.id),children:"Delete"})]})]},ne.id)}),!J.length&&a.jsx(nP,{title:"No users match this view"})]}),a.jsx("div",{className:"hidden overflow-x-auto rounded-2xl border border-slate-200 bg-white md:block",children:a.jsxs("table",{className:"min-w-full text-xs",children:[a.jsx("thead",{className:"bg-slate-50 text-[11px] font-medium text-slate-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 text-left",children:"#"}),a.jsx("th",{className:"p-2 text-left",children:"Name"}),a.jsx("th",{className:"p-2 text-left",children:"Email"}),a.jsx("th",{className:"p-2 text-left",children:"Dept"}),a.jsx("th",{className:"p-2 text-left",children:"Roles"}),a.jsx("th",{className:"p-2 text-left",children:"Flags"}),a.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[J.map((ne,Se)=>{const de=c.filter(ye=>(ne.role_ids||[]).includes(ye.id)).map(ye=>ye.name);return a.jsxs("tr",{className:"border-t border-slate-100 text-xs text-slate-800",children:[a.jsx("td",{className:"p-2",children:Se+1}),a.jsx("td",{className:"p-2",children:ne.name}),a.jsx("td",{className:"p-2",children:ne.email}),a.jsx("td",{className:"p-2",children:V[ne.department_id]||"-"}),a.jsx("td",{className:"p-2",children:de.length?de.join(", "):a.jsx("span",{className:"text-slate-400",children:"No roles"})}),a.jsx("td",{className:"p-2",children:a.jsxs("div",{className:"flex flex-wrap gap-1",children:[ne.is_doctor&&a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2 py-0.5 text-[10px] text-emerald-700",children:[a.jsx(kn,{className:"h-3 w-3"}),"Doctor"]}),!ne.is_active&&a.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-600",children:"Inactive"}),ne.is_admin&&a.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-900 px-2 py-0.5 text-[10px] text-white",children:"Admin"})]})}),a.jsx("td",{className:"p-2 text-right",children:a.jsxs("div",{className:"inline-flex gap-2",children:[s&&a.jsx(Te,{type:"button",variant:"outline",size:"sm",className:"h-7 rounded-2xl border-slate-200 px-3 text-[11px]",onClick:()=>q(ne),children:"Edit"}),i&&a.jsx(Te,{type:"button",variant:"outline",size:"sm",className:"h-7 rounded-2xl border border-rose-200 px-3 text-[11px] text-rose-700 hover:bg-rose-50",onClick:()=>z(ne.id),children:"Delete"})]})})]},ne.id)}),!J.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"p-4",children:a.jsx(nP,{title:"No users match this view"})})})]})]})})]})})]})})]})]})})}function mN({label:t,value:n,icon:r,hint:s}){return a.jsxs(ht.div,{whileHover:{y:-2,scale:1.01},className:"rounded-2xl border border-slate-200 bg-white px-3 py-2 text-[11px] text-slate-600",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-[10px] font-medium uppercase tracking-wide text-slate-500",children:t}),r&&a.jsx("span",{children:r})]}),a.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:n}),s&&a.jsx("div",{className:"mt-0.5 text-[10px] text-slate-400",children:s})]})}function nP({title:t}){return a.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-4 py-5 text-center",children:[a.jsx("p",{className:"text-sm font-medium text-slate-700",children:t}),a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Try changing filters, clearing the search, or creating a new user."})]})}function Foe(){return a.jsx("div",{className:"space-y-2",children:[0,1,2].map(t=>a.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-3",children:[a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx(Xe,{className:"h-3 w-1/3 rounded-full bg-slate-100"}),a.jsx(Xe,{className:"h-2.5 w-1/2 rounded-full bg-slate-100"})]}),a.jsx(Xe,{className:"h-6 w-20 rounded-full bg-slate-100"})]},t))})}const $oe=(()=>{try{return JSON.parse(localStorage.getItem("sidebarCollapsed")||"false")}catch{return!1}})(),fB=hL(t=>({sidebarCollapsed:$oe,sidebarMobileOpen:!1,toggleCollapse:()=>t(n=>{const r=!n.sidebarCollapsed;return localStorage.setItem("sidebarCollapsed",JSON.stringify(r)),{sidebarCollapsed:r}}),openMobile:()=>t({sidebarMobileOpen:!0}),closeMobile:()=>t({sidebarMobileOpen:!1}),toggleMobile:()=>t(n=>({sidebarMobileOpen:!n.sidebarMobileOpen}))}));function zoe(){return te.get("/settings/ui-branding/public")}function Uoe(){return te.get("/settings/ui-branding")}function Voe(t){return te.put("/settings/ui-branding",t)}function Hoe(t){return te.post("/settings/ui-branding/assets",t,{headers:{"Content-Type":"multipart/form-data"}})}const hB=b.createContext({branding:null,setBranding:()=>{},loading:!0}),Woe="http://localhost:8000/api",qoe=Woe.replace(/\/api\/?$/,"");function ao(t){if(!t)return;const n=String(t).trim();if(!n)return;if(/^https?:\/\//i.test(n))return n;if(n.startsWith("//"))return`${window.location.protocol}${n}`;const r=n.startsWith("/")?n:`/${n}`;return`${qoe}${r}`}function pN(t){if(!t)return null;const n={...t};return n.primary_color=n.primary_color||"#2563eb",n.primary_color_dark=n.primary_color_dark||null,n.sidebar_bg_color=n.sidebar_bg_color||"#ffffff",n.content_bg_color=n.content_bg_color||"#f9fafb",n.card_bg_color=n.card_bg_color||"#ffffff",n.border_color=n.border_color||"#e5e7eb",n.text_color=n.text_color||"#111827",n.text_muted_color=n.text_muted_color||"#e5e7eb",n.icon_color=n.icon_color||n.text_color||"#2563eb",n.icon_bg_color=n.icon_bg_color||"rgba(37,99,235,0.08)",n.logo_path&&!n.logo_url?n.logo_url=ao(`/media/${String(n.logo_path).replace(/^\/+/,"")}`):n.logo_url&&(n.logo_url=ao(n.logo_url)),n.login_logo_path&&!n.login_logo_url?n.login_logo_url=ao(`/media/${String(n.login_logo_path).replace(/^\/+/,"")}`):n.login_logo_url&&(n.login_logo_url=ao(n.login_logo_url)),n.favicon_path&&!n.favicon_url?n.favicon_url=ao(`/media/${String(n.favicon_path).replace(/^\/+/,"")}`):n.favicon_url&&(n.favicon_url=ao(n.favicon_url)),n.pdf_header_path&&!n.pdf_header_url?n.pdf_header_url=ao(`/media/${String(n.pdf_header_path).replace(/^\/+/,"")}`):n.pdf_header_url&&(n.pdf_header_url=ao(n.pdf_header_url)),n.pdf_footer_path&&!n.pdf_footer_url?n.pdf_footer_url=ao(`/media/${String(n.pdf_footer_path).replace(/^\/+/,"")}`):n.pdf_footer_url&&(n.pdf_footer_url=ao(n.pdf_footer_url)),n}function Goe({children:t}){const[n,r]=b.useState(null),[s,i]=b.useState(!0),o=l=>{r(typeof l=="function"?c=>pN(l(c)):pN(l))};return b.useEffect(()=>{let l=!0;return(async()=>{try{let d;try{d=(await zoe()).data}catch(h){console.warn("Public branding failed, falling back to /settings/ui-branding",h),d=(await Uoe()).data}if(!l)return;console.log("[BrandingProvider] raw branding from API:",d);const u=pN(d);console.log("[BrandingProvider] normalized branding:",u),r(u)}catch(d){console.error("Failed to load branding",d),fe.error("Failed to load customization settings")}finally{l&&i(!1)}})(),()=>{l=!1}},[]),a.jsx(hB.Provider,{value:{branding:n,setBranding:o,loading:s},children:t})}function px(){return b.useContext(hB)}const Koe="#2563eb",Yoe=t=>!t.startsWith("#")||t.length!==7?"#eff6ff":`${t}1A`,Xoe=t=>!t.startsWith("#")||t.length!==7?"#bfdbfe":`${t}33`,Qoe=[{key:"Dashboard",label:"Dashboard",icon:u0,flatLink:{to:"/dashboard",reqAny:["patients.view"]}},{key:"patients",label:"Patients management",icon:wp,flatLink:{to:"/patients",reqAny:["patients.view","patients.create","patients.update"]}},{key:"patients masters",label:"Patients masters",icon:tl,flatLink:{to:"/patients/masters",reqAny:["patients.masters.view"]}},{key:"MIS",label:"MIS & Analytics",icon:bee,flatLink:{to:"/mis",reqAny:["mis.view"]}},{key:"emr",label:"Patients EMR",icon:y1,flatLink:{to:"/emr",reqAny:["emr.view"]}},{key:"pharmacy",label:"Pharmacy",icon:gs,items:[{key:"pharmacy-inventory",label:"Inventory & Stock",to:"/pharmacy/inventory",icon:cee,reqAny:["pharmacy.inventory.stock.view","pharmacy.inventory.items.view","pharmacy.inventory.po.view"]},{key:"pharmacy-barcode",label:"Barcode / QR Lookup",to:"/inventory/barcode-lookup",icon:wg,reqAny:["pharmacy.inventory.stock.view"]},{key:"pharmacy RX",label:"Pharmacy RX",to:"/pharmacy/rx",icon:M5,reqAny:["pharmacy.inventory.stock.view"]},{key:"pharmacy dispense",label:"Pharmacy Dispense",to:"/pharmacy/dispense",icon:w1,reqAny:["pharmacy.inventory.stock.view"]}]},{key:"user-mgmt",label:"User Management",icon:_o,items:[{key:"departments",label:"Departments",to:"/admin/departments",icon:fl,reqAny:["departments.view","departments.create","departments.update","departments.delete"]},{key:"roles",label:"Roles",to:"/admin/roles",icon:_o,reqAny:["roles.view","roles.create","roles.update","roles.delete"]},{key:"users",label:"Users",to:"/admin/users",icon:wp,reqAny:["users.view","users.create","users.update","users.delete"]}]},{key:"op",label:"OP",icon:kn,items:[{key:"op-dashboard",label:"Dashboard",to:"/opd/dashboard",icon:u0,reqAny:["appointments.view","mis.opd.view"]},{key:"appointments",label:"Appointments",to:"/opd/appointments",icon:g1,reqAny:["appointments.view","appointments.create"]},{key:"triage",label:"Vitals (Triage)",to:"/opd/triage",icon:ha,reqAny:["vitals.create"]},{key:"queue",label:"Queue",to:"/opd/queue",icon:ote,reqAny:["appointments.view","visits.view"]},{key:"followups",label:"Follow-ups (Waiting)",to:"/opd/followups",icon:Hc,reqAny:["appointments.view","appointments.update"]},{key:"no-shows",label:"No-show Reschedule",to:"/opd/no-shows",icon:Kee,reqAny:["appointments.view","appointments.update"]},{key:"Doctor Fees",label:"Doctor Fees",to:"/opd/doctor-fees",icon:v1,reqAny:["appointments.view","appointments.update"]}]},{key:"ip",label:"IP",icon:Fd,items:[{key:"ipd-admissions",label:"Admissions",to:"/ipd/admissions",icon:$ee,reqAny:["ipd.view","ipd.manage"]},{key:"ipd-tracking",label:"Tracking",to:"/ipd/tracking",icon:u0,reqAny:["ipd.tracking.view"]},{key:"ipd-my",label:"My Admissions",to:"/ipd/my",icon:M5,reqAny:["ipd.my.view","ipd.doctor"]},{key:"ipd-discharged",label:"Discharged",to:"/ipd/discharged",icon:vL,reqAny:["ipd.discharged.view"]},{key:"ipd-bedboard",label:"Bedboard",to:"/ipd/bedboard",icon:Fd,reqAny:["ipd.bedboard.view"]},{key:"ipd-masters",label:"IPD Masters",to:"/ipd/masters",icon:Xo,reqAny:["ipd.masters.manage","ipd.packages.manage"]}]},{key:"lab",label:"Laboratory",icon:Wf,items:[{key:"lab-orders",label:"Orders & Reporting",to:"/lab/orders",icon:Wf,reqAny:["lab.orders.view","lab.orders.create","orders.lab.view","orders.lab.create"]},{key:"lab-masters",label:"Lab Masters (NABL)",to:"/lab/masters",icon:Xo,reqAny:["lab.masters.manage"]}]},{key:"ris",label:"Radiology",icon:wg,items:[{key:"ris-orders",label:"Orders & Reporting",to:"/ris/orders",icon:wg,reqAny:["radiology.orders.view","radiology.orders.create","orders.ris.view","orders.ris.create","radiology.report.create","radiology.report.approve","radiology.schedule.manage","radiology.scan.update"]},{key:"ris-masters",label:"RIS Masters",to:"/ris/masters",icon:Xo,reqAny:["radiology.masters.manage"]}]},{key:"ot",label:"Operation Theatre",icon:Fj,items:[{key:"ot-orders",label:"OT Orders",to:"/ot/orders",icon:Fj,reqAny:["ot.cases.view","ot.cases.create","ipd.view"]},{key:"ot-masters",label:"OT Masters",to:"/ot/masters",icon:Xo,reqAny:["ot.masters.view","ot.masters.manage"]}]},{key:"billing",label:"Billing",icon:v1,items:[{key:"billing-console",label:"Billing Console",to:"/billing",icon:u0,reqAny:["billing.invoices.view","billing.invoices.create"]}]},{key:"settings",label:"Settings",icon:Bte,items:[{key:"schedules",label:"Schedules",to:"/opd/schedules",icon:g1,reqAny:["schedules.manage"]},{key:"ui-branding",label:"Customization & Templates",to:"/settings/branding",icon:ate,reqAny:["settings.customization.view","settings.customization.manage"]},{key:"perm-logs",label:"Permissions (Access Logs)",to:"/admin/permissions",icon:Xo,reqAny:["permissions.view","permissions.create","permissions.update","permissions.delete"]}]}];function Zoe(){const t=Cr(V=>V.user),n=Cr(V=>V.modules)||{},r=yi(),{sidebarCollapsed:s,toggleCollapse:i,sidebarMobileOpen:o,closeMobile:l}=fB(),{branding:c}=px()||{},d=(c==null?void 0:c.primary_color)||Koe,u=(c==null?void 0:c.sidebar_bg_color)||"#ffffff",h=(c==null?void 0:c.text_color)||"#111827",m=(c==null?void 0:c.icon_color)||h,g=(c==null?void 0:c.icon_bg_color)||"rgba(37,99,235,0.08)",y=Yoe(d),N=Xoe(d),j=((c==null?void 0:c.org_name)||"").trim()||"NABH HIMS",S=((c==null?void 0:c.org_tagline)||"").trim()||"Smart  Secure  NABH-Standard",_=b.useMemo(()=>{var Q;const V=(Q=c==null?void 0:c.org_name)==null?void 0:Q.trim();if(!V)return"NH";const F=V.split(/\s+/).filter(Boolean);return F.length?F.length===1?F[0].slice(0,2).toUpperCase():(F[0][0]+F[1][0]).toUpperCase():"NH"},[c==null?void 0:c.org_name]);b.useEffect(()=>{if(!o)return;const V=window.scrollY,F={position:document.body.style.position,top:document.body.style.top,width:document.body.style.width,overflow:document.body.style.overflow,ob:document.documentElement.style.overscrollBehavior};return document.body.style.position="fixed",document.body.style.top=`-${V}px`,document.body.style.width="100%",document.body.style.overflow="hidden",document.documentElement.style.overscrollBehavior="none",()=>{document.body.style.position=F.position||"",document.body.style.top=F.top||"",document.body.style.width=F.width||"",document.body.style.overflow=F.overflow||"",document.documentElement.style.overscrollBehavior=F.ob||"",window.scrollTo(0,V)}},[o]);const A=!!(t!=null&&t.is_admin),k=b.useMemo(()=>{const V=Object.values(n).flat().map(Q=>typeof Q=="string"?Q:Q==null?void 0:Q.code).filter(Boolean),F=((t==null?void 0:t.permissions)||[]).map(Q=>typeof Q=="string"?Q:Q==null?void 0:Q.code).filter(Boolean);return new Set([...V||[],...F||[]])},[n,t]),T=(V=[])=>A?!0:V.some(F=>k.has(F)),P=b.useMemo(()=>Qoe.map(V=>{if(V.flatLink){const U=T(V.flatLink.reqAny);return{...V,_visible:U}}const F=(V.items||[]).map(U=>({...U,_visible:T(U.reqAny)})),Q=F.some(U=>U._visible);return{...V,items:F,_visible:Q}}).filter(V=>V._visible),[k,A]),M=V=>V.flatLink?r.pathname.startsWith(V.flatLink.to):(V.items||[]).some(F=>r.pathname.startsWith(F.to)),[O,D]=b.useState({});b.useEffect(()=>{const V={};P.forEach(F=>{V[F.key]=M(F)}),D(F=>({...F,...V}))},[r.pathname]);const L=V=>D(F=>({...F,[V]:!F[V]})),$=s?"md:w-16":"md:w-64";return a.jsxs(a.Fragment,{children:[a.jsx("div",{onClick:l,className:`fixed inset-0 z-40 bg-black/35 backdrop-blur-sm transition-opacity md:hidden ${o?"opacity-100":"pointer-events-none opacity-0"}`}),a.jsxs("aside",{className:["z-50 border-r transition-all duration-300 ease-out","fixed left-0 top-0 h-[100dvh] w-[86vw] max-w-sm md:w-auto",o?"translate-x-0":"-translate-x-full","md:static md:translate-x-0 md:sticky md:top-0 md:h-[100dvh]",$,"grid grid-rows-[auto,1fr,auto] min-h-0","overflow-x-hidden overflow-y-hidden"].join(" "),style:{backgroundColor:u,color:h},children:[a.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-3",children:[a.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[c!=null&&c.logo_url?a.jsx("img",{src:c.logo_url,alt:"Logo",className:"h-8 w-auto rounded-md border border-slate-200 bg-white"}):a.jsx("div",{className:"grid h-8 w-8 place-items-center rounded-xl ring-1",style:{backgroundColor:g,borderColor:N},children:a.jsx("span",{className:"text-xs font-bold",style:{color:m},children:_})}),!s&&a.jsxs("div",{className:"truncate",children:[a.jsx("div",{className:"text-xs font-semibold tracking-tight leading-snug",children:j}),a.jsx("div",{className:"text-[10px] leading-tight",children:S})]})]}),a.jsx("button",{onClick:l,className:"md:hidden inline-flex h-8 w-8 items-center justify-center rounded-xl hover:bg-gray-50 active:scale-95 transition","aria-label":"Close sidebar",children:a.jsx(La,{className:"h-5 w-5",style:{color:m}})}),a.jsx("button",{onClick:i,className:"hidden md:inline-flex h-8 w-8 items-center justify-center rounded-xl hover:bg-gray-50 active:scale-95 transition","aria-label":s?"Expand sidebar":"Collapse sidebar",title:s?"Expand":"Collapse",children:s?a.jsx(gL,{className:"h-5 w-5",style:{color:m}}):a.jsx(xL,{className:"h-5 w-5",style:{color:m}})})]}),a.jsxs("nav",{className:"min-h-0 flex-1 overflow-y-auto no-scrollbar y-fade px-2 pb-4 pt-1 space-y-1 overscroll-contain touch-pan-y",children:[P.map(V=>{if(V.flatLink){const z=V.icon||Xo;return a.jsxs(l5,{to:V.flatLink.to,onClick:l,className:({isActive:q})=>["group relative flex h-10 items-center gap-3 rounded-xl px-3 text-sm leading-none transition-colors duration-200 ease-out active:scale-[0.99]",s?"justify-center":""].join(" "),style:({isActive:q})=>q?{color:"#ffffff",backgroundColor:d,boxShadow:`0 0 0 1px ${N}`}:{color:h},title:s?V.label:void 0,children:[a.jsx(z,{className:"h-5 w-5 shrink-0",style:{color:M(V)?"#ffffff":m}}),!s&&a.jsx("span",{className:"transition-all duration-300",children:V.label})]},V.key)}const F=V.icon||Xo,Q=!!O[V.key]&&!s,U=M(V);return a.jsxs("div",{className:"rounded-xl",children:[a.jsxs("button",{type:"button",onClick:()=>s?null:L(V.key),className:["w-full flex items-center gap-3 rounded-xl px-3 h-10 text-sm transition-colors duration-200 ease-out",s?"justify-center":"justify-between"].join(" "),title:s?V.label:void 0,style:{color:U?d:h,backgroundColor:U?y:"transparent",boxShadow:U?`0 0 0 1px ${N}`:void 0},children:[a.jsxs("span",{className:"flex items-center gap-3",children:[a.jsx(F,{className:"h-5 w-5 shrink-0",style:{color:m}}),!s&&a.jsx("span",{className:"font-medium",children:V.label})]}),!s&&a.jsx(z_,{className:"h-4 w-4 transition-transform",style:{color:m}})]}),Q&&a.jsx("div",{className:"mt-1 space-y-1 pl-9",children:V.items.filter(z=>z._visible).map(z=>{const q=z.icon||Xo;return a.jsxs(l5,{to:z.to,onClick:l,className:()=>"group relative flex h-9 items-center gap-2 rounded-lg px-2 text-sm leading-none transition-colors duration-200 ease-out active:scale-[0.99]",style:({isActive:K})=>K?{color:d,backgroundColor:y,boxShadow:`0 0 0 1px ${N}`}:{color:h},children:[a.jsx(q,{className:"h-[18px] w-[18px] shrink-0",style:{color:m}}),a.jsx("span",{children:z.label})]},z.key)})})]},V.key)}),P.length===0&&a.jsx("div",{className:"px-3 py-2 text-xs text-gray-500",children:"No modules granted. Contact administrator."})]}),a.jsx("div",{className:"px-3 pb-3",children:s?a.jsx("div",{className:"grid place-items-center text-[10px] text-gray-400",children:"v1.0"}):a.jsx("div",{className:"rounded-xl border border-gray-100 bg-gray-50 p-3 text-[11px] text-gray-500",children:"Tip: Click the chevron to collapse the sidebar."})})]})]})}function Joe(){const{user:t,logout:n,fetchProfile:r}=Cr(),{toggleMobile:s}=fB(),{branding:i}=px()||{},[o,l]=b.useState(new Date),[c,d]=b.useState(typeof navigator<"u"?navigator.onLine:!0),[u,h]=b.useState(!1),[m,g]=b.useState(!1),[y,N]=b.useState(!1),j=(i==null?void 0:i.primary_color)||"#0f172a",_=(i==null?void 0:i.primary_color_dark)||null||j,A=(i==null?void 0:i.text_muted_color)||"#e5e7eb",k=(i==null?void 0:i.icon_color)||A,T=((i==null?void 0:i.org_name)||"").trim()||"NUTRYAH",P=((i==null?void 0:i.org_tagline)||"").trim()||"Smart  Secure  NABH-Standard";b.useEffect(()=>{const F=setInterval(()=>l(new Date),1e3);return()=>clearInterval(F)},[]),b.useEffect(()=>{const F=()=>d(navigator.onLine);return window.addEventListener("online",F),window.addEventListener("offline",F),()=>{window.removeEventListener("online",F),window.removeEventListener("offline",F)}},[]);const M=b.useMemo(()=>t?t.is_admin?"Admin":Array.isArray(t.roles)&&t.roles.length?t.roles[0]:"User":"",[t]),O=b.useMemo(()=>{try{return o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return o.toTimeString().slice(0,8)}},[o]),D=()=>{g(!0),setTimeout(()=>window.location.reload(),120)},L=async()=>{N(!0);try{await r()}finally{setTimeout(()=>N(!1),500)}},$=a.jsx("svg",{viewBox:"0 0 24 24",className:"h-9 w-9","aria-hidden":"true",fill:"none",stroke:"currentColor",strokeWidth:"1.5",style:{color:k},children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6.75a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.5 20.25a8.25 8.25 0 1 1 15 0v.75H4.5v-.75Z"})}),V=({ok:F})=>a.jsx("span",{title:F?"Online":"Offline",className:`inline-block h-2.5 w-2.5 rounded-full ${F?"bg-emerald-500":"bg-rose-500"} ring-2 ring-white`});return a.jsx("header",{className:"sticky top-0 z-30",style:{backgroundColor:_,color:A},children:a.jsxs("div",{className:"mx-auto flex max-w-7xl items-center justify-between gap-3 px-4 py-2 sm:px-6",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"md:hidden inline-flex items-center justify-center rounded-xl p-2 ring-1 ring-white/20 hover:bg-white/10 active:scale-95 transition",onClick:s,"aria-label":"Open menu",children:a.jsx("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",stroke:"currentColor",strokeWidth:"1.5",fill:"none",style:{color:k},children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 7h16M4 12h16M4 17h16"})})}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-lg font-semibold tracking-tight sm:text-xl",style:{color:A},children:T}),a.jsx("span",{className:"hidden text-[11px] sm:inline-block",style:{color:A},children:P})]})]}),a.jsxs("div",{className:"hidden items-center gap-3 sm:flex",children:[a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-white/15 bg-white/10 px-3 py-1.5 text-sm",children:[a.jsx(V,{ok:c}),a.jsx("span",{className:"tabular-nums",style:{color:A},children:O})]}),a.jsxs("button",{onClick:L,className:`group inline-flex items-center gap-2 rounded-xl border border-white/15 bg-white/10 px-3 py-1.5 text-sm transition ${y?"animate-pulse":"hover:bg-white/15"}`,title:"Sync data",children:[a.jsx("svg",{viewBox:"0 0 24 24",className:`h-5 w-5 ${y?"animate-spin":"group-hover:rotate-90"} transition`,stroke:"currentColor",strokeWidth:"1.5",fill:"none",style:{color:k},children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16 8V4m0 0h4m-4 0l2 2M8 16v4m0 0H4m4 0-2-2M6 8a6 6 0 1 1 12 0 6 6 0 0 1-12 0Z"})}),a.jsx("span",{style:{color:A},children:"Sync"})]}),a.jsxs("button",{onClick:D,className:"inline-flex items-center gap-2 rounded-xl border border-white/15 bg-white/10 px-3 py-1.5 text-sm transition hover:bg-white/15 active:scale-95",title:"Refresh page",children:[a.jsx("svg",{viewBox:"0 0 24 24",className:`h-5 w-5 ${m?"animate-spin":""} transition`,stroke:"currentColor",strokeWidth:"1.5",fill:"none",style:{color:k},children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992V4.356M21 12a9 9 0 1 1-3-6.708"})}),a.jsx("span",{style:{color:A},children:"Refresh"})]})]}),a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>h(F=>!F),className:"group inline-flex items-center gap-3 rounded-2xl border border-white/15 bg-white/10 px-2.5 py-1.5 transition hover:bg-white/15","aria-haspopup":"menu","aria-expanded":u,title:"Account",children:[a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute -right-0.5 -top-0.5 rounded-full bg-emerald-500 p-1 ring-2 ring-[rgba(0,0,0,0.2)]"}),$]}),a.jsx("div",{className:"hidden min-w-[9rem] text-left sm:block",children:a.jsxs("div",{className:"leading-tight",children:[a.jsx("div",{className:"truncate text-sm font-medium",style:{color:A},children:(t==null?void 0:t.name)||""}),a.jsx("div",{className:"truncate text-[11px]",style:{color:A},children:M})]})}),a.jsx("svg",{viewBox:"0 0 24 24",className:`hidden h-4 w-4 sm:block transition ${u?"rotate-180":""}`,fill:"none",stroke:"currentColor",strokeWidth:"1.5",style:{color:k},children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 9l6 6 6-6"})})]}),a.jsxs("div",{className:`absolute right-0 mt-2 w-64 origin-top-right rounded-2xl border border-gray-200 bg-gray-900 p-3 shadow-lg transition ${u?"scale-100 opacity-100":"pointer-events-none scale-95 opacity-0"}`,children:[a.jsxs("div",{className:"mb-3 flex items-center gap-3",children:[a.jsx("div",{className:"shrink-0",children:$}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"truncate text-sm font-semibold text-gray-100",children:(t==null?void 0:t.name)||""}),a.jsx("div",{className:"truncate text-xs text-gray-300",children:M}),a.jsx("div",{className:"truncate text-[11px] text-gray-300",children:t==null?void 0:t.email})]})]}),a.jsxs("div",{className:"grid gap-2",children:[a.jsxs("button",{onClick:L,className:"flex w-full items-center gap-2 rounded-xl px-3 py-2 text-left text-sm hover:bg-gray-50 hover:text-black/90",children:[a.jsx("svg",{viewBox:"0 0 24 24",className:`h-5 w-5 ${y?"animate-spin":""}`,fill:"none",stroke:"currentColor",strokeWidth:"1.5",style:{color:k},children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12a7.5 7.5 0 0 1 13.5-4.5M19.5 12A7.5 7.5 0 0 1 6 16.5M3 12h3m12 0h3"})}),a.jsx("span",{children:"Sync data"})]}),a.jsxs("button",{onClick:D,className:"flex w-full items-center gap-2 rounded-xl px-3 py-2 text-left text-sm hover:bg-gray-50 hover:text-black/90",children:[a.jsx("svg",{viewBox:"0 0 24 24",className:`h-5 w-5 ${m?"animate-spin":""}`,fill:"none",stroke:"currentColor",strokeWidth:"1.5",style:{color:k},children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992V4.356M21 12a9 9 0 1 1-3-6.708"})}),a.jsx("span",{children:"Refresh page"})]}),a.jsx("div",{className:"my-1 h-px bg-gray-100"}),a.jsxs("button",{onClick:n,className:"flex w-full items-center gap-2 rounded-xl px-3 py-2 text-left text-sm text-rose-600 hover:bg-rose-50",children:[a.jsx("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",fill:"none",stroke:"currentColor",strokeWidth:"1.5",style:{color:k},children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6A2.25 2.25 0 0 0 5.25 5.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15M12 8l-4 4m0 0 4 4m-4-4h12"})}),a.jsx("span",{children:"Logout"})]})]})]})]})]})})}const ele="#2563eb";function tle(){const{branding:t}=px()||{},n=(t==null?void 0:t.primary_color)||ele,r=(t==null?void 0:t.sidebar_bg_color)||"#f9fafb",s=(t==null?void 0:t.text_color)||"#4b5563";return a.jsx("footer",{className:"w-full border-t text-xs sm:text-[13px]",style:{borderTopColor:n,background:r,color:s},children:a.jsxs("div",{className:"mx-auto flex max-w-6xl flex-col gap-2 px-4 py-3 md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{className:"font-medium",children:["Powered by"," ",a.jsx("span",{className:"font-semibold",style:{color:n},children:"NUTRYAH DIGITAL HEALTH"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1",children:[a.jsx("span",{className:"font-medium",children:"Support:"}),a.jsx("a",{href:"tel:+918870787448",className:"hover:underline",style:{color:n},children:"Mobile: +91 88707 87448"}),a.jsx("span",{className:"hidden text-slate-300 md:inline",children:""}),a.jsx("a",{href:"mailto:support@nutryah.com",className:"hover:underline",style:{color:n},children:"Email: support@nutryah.com"}),a.jsx("span",{className:"hidden text-slate-300 md:inline",children:""}),a.jsx("a",{href:"https://www.nutryah.com",target:"_blank",rel:"noreferrer",className:"hover:underline",style:{color:n},children:"Website: www.nutryah.com"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1",children:[a.jsx("a",{href:"/privacy-policy",className:"hover:underline",style:{color:n},children:"Privacy Policy"}),a.jsx("span",{className:"text-slate-300",children:"|"}),a.jsx("a",{href:"/terms-and-conditions",className:"hover:underline",style:{color:n},children:"Terms & Conditions"})]})]})})}function nle(){const{branding:t}=px()||{},n=!!(t!=null&&t.content_bg_color),r=n?"min-h-dvh":"min-h-dvh bg-gradient-to-b from-gray-50 to-white",s=n?{backgroundColor:t.content_bg_color,color:t.text_color||void 0}:void 0;return a.jsx("div",{className:r,style:s,children:a.jsxs("div",{className:"flex min-h-dvh",children:[a.jsx(Zoe,{}),a.jsxs("div",{className:"flex min-h-dvh flex-1 flex-col",children:[a.jsx(Joe,{}),a.jsxs("main",{className:"flex-1",children:[a.jsx("div",{className:"mx-auto w-full max-w-7xl px-4 py-4 sm:px-6 lg:px-8",children:a.jsx(O6,{})}),a.jsx("div",{children:a.jsx(tle,{})})]})]})]})})}function rle(){const{user:t,loading:n,fetchProfile:r}=Cr(),[s,i]=b.useState(!1),o=localStorage.getItem("access_token"),l=yi();return b.useEffect(()=>{o&&!t&&!n&&(i(!0),r().finally(()=>i(!1)))},[o,t,n,r]),o?s||n||!t&&o?a.jsx("div",{className:"min-h-screen grid place-items-center text-sm",children:"Loading"}):a.jsx(O6,{}):a.jsx(M6,{to:"/auth/login",state:{from:l},replace:!0})}function Nr({anyOf:t=[],fallback:n=null,children:r}){const s=Cr(d=>d.user),i=Cr(d=>d.modules)||{};if(!!(s!=null&&s.is_admin))return r;const l=new Set(Object.values(i).flat().map(d=>typeof d=="string"?d:d==null?void 0:d.code).filter(Boolean));return t.length===0||t.some(d=>l.has(d))?r:n}const SA=()=>te.get("/ipd/wards"),sle=t=>te.post("/ipd/wards",t),ale=t=>te.delete(`/ipd/wards/${t}`),CA=(t={})=>te.get("/ipd/rooms",{params:t}),ile=t=>te.post("/ipd/rooms",t),ole=t=>te.delete(`/ipd/rooms/${t}`),Ao=(t={})=>te.get("/ipd/beds",{params:t}),lle=t=>te.post("/ipd/beds",t),cle=t=>te.delete(`/ipd/beds/${t}`),dle=(t,n)=>te.patch(`/ipd/beds/${t}/state`,n),mB=()=>te.get("/ipd/packages"),ule=t=>te.post("/ipd/packages",t),fle=t=>te.delete(`/ipd/packages/${t}`),hle=()=>te.get("/ipd/bed-rates"),mle=t=>te.post("/ipd/bed-rates",t),ple=t=>te.delete(`/ipd/bed-rates/${t}`),Nv=(t={})=>te.get("/ipd/admissions",{params:t}),xle=t=>te.post("/ipd/admissions",t),pB=async t=>{var n,r;try{return await te.get(`/ipd/admissions/${t}`)}catch(s){const i=(n=s==null?void 0:s.response)==null?void 0:n.status;if(i===404||i===405)try{return await te.get(`/ipd/admission/${t}`)}catch(o){const l=(r=o==null?void 0:o.response)==null?void 0:r.status;if(l===404||l===405){const{data:c=[]}=await te.get("/ipd/admissions",{params:{limit:500}}),d=(c||[]).find(u=>Number(u==null?void 0:u.id)===Number(t));if(!d){const u=new Error("Not found");throw u.status=404,u}return{data:d}}throw o}throw s}},gle=(t,n)=>te.put(`/ipd/admissions/${t}`,n),yle=t=>te.patch(`/ipd/admissions/${t}/cancel`),vle=(t,n)=>te.post(`/ipd/admissions/${t}/transfer`,n),ble=t=>te.get(`/ipd/admissions/${t}/nursing-notes`),wle=(t,n)=>te.post(`/ipd/admissions/${t}/nursing-notes`,n),Nle=t=>te.get(`/ipd/admissions/${t}/vitals`),jle=(t,n)=>te.post(`/ipd/admissions/${t}/vitals`,n),Sle=t=>te.get(`/ipd/admissions/${t}/io`),Cle=(t,n)=>te.post(`/ipd/admissions/${t}/io`,n),_le=t=>te.get(`/ipd/admissions/${t}/shift-handovers`),Ale=(t,n)=>te.post(`/ipd/admissions/${t}/shift-handovers`,n),Ele=t=>te.get(`/ipd/admissions/${t}/rounds`),kle=(t,n)=>te.post(`/ipd/admissions/${t}/rounds`,n),Tle=t=>te.get(`/ipd/admissions/${t}/progress-notes`),Ile=(t,n)=>te.post(`/ipd/admissions/${t}/progress-notes`,n),Ple=t=>te.get(`/ipd/admissions/${t}/referrals`),Mle=(t,n)=>te.post(`/ipd/admissions/${t}/referrals`,n),Ole=t=>te.get(`/ipd/admissions/${t}/discharge-summary`),Dle=(t,n)=>te.post(`/ipd/admissions/${t}/discharge-summary`,n),Rle=t=>te.get(`/ipd/admissions/${t}/discharge-checklist`),Lle=(t,n)=>te.post(`/ipd/admissions/${t}/discharge-checklist`,n),Ble=t=>te.get(`/ipd/admissions/${t}/ot-cases`),Fle=(t,n)=>te.post(`/ipd/admissions/${t}/ot-cases`,n),$le=t=>te.get(`/ipd/ot-cases/${t}/anaesthesia`),zle=t=>te.post("/ipd/anaesthesia",t),Ule=(t,n={})=>te.get("/ipd/bed-charges/preview",{params:{admission_id:t,...n}}),jv=t=>te.get(`/patients/${t}`),Vle=(...t)=>wle(...t),Hle=(...t)=>jle(...t);function Wle(){return a.jsx(Nr,{anyOf:["ipd.masters.manage","ipd.packages.manage"],children:a.jsxs("div",{className:"p-4 space-y-6",children:[a.jsx("h1",{className:"text-lg font-semibold text-black",children:"IPD Masters"}),a.jsx(qle,{}),a.jsx(Gle,{}),a.jsx(Kle,{})]})})}function qle(){const[t,n]=b.useState([]),[r,s]=b.useState([]),[i,o]=b.useState([]),[l,c]=b.useState(""),d=async()=>{var u,h;c("");try{const[m,g,y]=await Promise.all([SA(),CA(),Ao()]);n(m.data||[]),s(g.data||[]),o(y.data||[])}catch(m){c(((h=(u=m==null?void 0:m.response)==null?void 0:u.data)==null?void 0:h.detail)||"Failed to load")}};return b.useEffect(()=>{d()},[]),a.jsxs("div",{className:"rounded-xl border bg-white p-3 space-y-4 text-black",children:[a.jsx("div",{className:"font-medium",children:"Ward  Room  Bed"}),l&&a.jsx("div",{className:"text-rose-700 text-sm",children:l}),a.jsx(Gm,{title:"New Ward",onSubmit:async u=>{await sle(u),await d()},fields:[{name:"code",placeholder:"Code",required:!0},{name:"name",placeholder:"Name",required:!0},{name:"floor",placeholder:"Floor"}]}),a.jsx(Gm,{title:"New Room",onSubmit:async u=>{await ile(u),await d()},fields:[{name:"ward_id",type:"select",options:t.map(u=>({value:u.id,label:`${u.code}  ${u.name}`})),required:!0},{name:"number",placeholder:"Room number",required:!0},{name:"type",placeholder:"Type (General/Private/ICU)",required:!0}]}),a.jsx(Gm,{title:"New Bed",onSubmit:async u=>{await lle(u),await d()},fields:[{name:"room_id",type:"select",options:r.map(u=>({value:u.id,label:`Ward ${u.ward_id}  Room ${u.number} (${u.type})`})),required:!0},{name:"code",placeholder:"Bed code",required:!0}]}),a.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium mb-2",children:"Wards"}),a.jsx(Km,{items:t,cols:[["code"],["name"],["floor"]],onDelete:async u=>{await ale(u),await d()}})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium mb-2",children:"Rooms"}),a.jsx(Km,{items:r,cols:[["ward_id","Ward"],["number","Room"],["type","Type"]],onDelete:async u=>{await ole(u),await d()}})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium mb-2",children:"Beds"}),a.jsx(Km,{items:i,cols:[["room_id","RoomId"],["code","Code"],["state","State"]],onDelete:async u=>{await cle(u),await d()}})]})]})]})}function Gle(){const[t,n]=b.useState([]),r=async()=>{const{data:s}=await mB();n(s||[])};return b.useEffect(()=>{r()},[]),a.jsxs("div",{className:"rounded-xl border bg-white p-3 space-y-3 text-black",children:[a.jsx("div",{className:"font-medium",children:"Packages"}),a.jsx(Gm,{title:"New Package",onSubmit:async s=>{await ule(s),await r()},fields:[{name:"name",placeholder:"Name",required:!0},{name:"included",placeholder:"Included"},{name:"excluded",placeholder:"Excluded"},{name:"charges",placeholder:"Charges",type:"number"}]}),a.jsx(Km,{items:t,cols:[["name"],["charges"],["included"],["excluded"]],onDelete:async s=>{await fle(s),await r()}})]})}function Kle(){const[t,n]=b.useState([]),r=async()=>{const{data:s}=await hle();n(s||[])};return b.useEffect(()=>{r()},[]),a.jsxs("div",{className:"rounded-xl border bg-white p-3 space-y-3 text-black",children:[a.jsx("div",{className:"font-medium",children:"Bed Rates"}),a.jsx(Gm,{title:"New Bed Rate",onSubmit:async s=>{await mle(s),await r()},fields:[{name:"room_type",placeholder:"General/Private/ICU",required:!0},{name:"daily_rate",placeholder:"Daily rate",type:"number",required:!0},{name:"effective_from",type:"date",required:!0},{name:"effective_to",type:"date"}]}),a.jsx(Km,{items:t,cols:[["room_type","Room"],["daily_rate","Rate"],["effective_from","From"],["effective_to","To"],["is_active","Active"]],onDelete:async s=>{await ple(s),await r()}})]})}function Gm({title:t,fields:n,onSubmit:r}){const[s,i]=b.useState({}),o=async l=>{l.preventDefault();const c={...s};Object.keys(c).forEach(d=>c[d]===""&&delete c[d]),await r(c),i({})};return a.jsxs("form",{onSubmit:o,className:"rounded-lg border bg-gray-50 p-3 grid gap-3 md:grid-cols-4",children:[a.jsx("div",{className:"md:col-span-4 text-sm font-medium",children:t}),n.map(l=>{var c;return l.type==="select"?a.jsxs("select",{className:"input",value:s[l.name]||"",onChange:d=>i(u=>({...u,[l.name]:d.target.value})),required:l.required,children:[a.jsx("option",{value:"",children:l.placeholder||"Select"}),(c=l.options)==null?void 0:c.map(d=>a.jsx("option",{value:d.value,children:d.label},d.value))]},l.name):a.jsx("input",{className:"input",type:l.type||"text",placeholder:l.placeholder||l.name,value:s[l.name]||"",onChange:d=>i(u=>({...u,[l.name]:d.target.value})),required:l.required},l.name)}),a.jsx("div",{className:"md:col-span-4 flex justify-end",children:a.jsx("button",{className:"btn",children:"Save"})})]})}function Km({items:t=[],cols:n=[],onDelete:r}){return a.jsx("div",{className:"rounded-xl border overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-left text-xs text-gray-500 bg-gray-50",children:[n.map(([s,i])=>a.jsx("th",{className:"px-3 py-2",children:i||s},s)),a.jsx("th",{className:"px-3 py-2"})]})}),a.jsxs("tbody",{children:[t.map(s=>a.jsxs("tr",{className:"border-t",children:[n.map(([i])=>a.jsx("td",{className:"px-3 py-2",children:String(s[i]??"")},i)),a.jsx("td",{className:"px-3 py-2",children:a.jsx("button",{className:"btn btn-sm bg-rose-600 hover:bg-rose-700",onClick:()=>r(s.id),children:"Delete"})})]},s.id)),!t.length&&a.jsx("tr",{children:a.jsx("td",{className:"p-3 text-sm text-gray-500",colSpan:n.length+1,children:"No items"})})]})]})})}const qc=(t={})=>{const n={};return Object.entries(t).forEach(([r,s])=>{s!=null&&s!==""&&(n[r]=s)}),n};function Yle(){return te.get("/opd/departments")}function Xle({departmentId:t,roleId:n,roleName:r,isDoctor:s}={}){const i=qc({department_id:t,role_id:n,role:r,is_doctor:typeof s=="boolean"?s:void 0});return te.get("/opd/users",{params:i})}function rP({doctorUserId:t,date:n,detailed:r=!0}){return te.get("/opd/slots",{params:{doctor_user_id:t,date:n,detailed:r}})}function Qle({doctorUserId:t,date:n}){return te.get("/opd/slots/free",{params:{doctor_user_id:t,date:n}})}function Zle(t){return te.get("/opd/schedules",{params:{doctor_user_id:t}})}function Jle(t){return te.post("/opd/schedules",t)}function ece(t){return te.delete(`/opd/schedules/${t}`)}function xB(t=""){const n=t?{q:t}:{};return te.get("/patients",{params:n})}function tce(t){return te.post("/opd/appointments",t)}function sP(t={}){return te.get("/opd/appointments",{params:qc(t)})}function nce(t,n){return te.patch(`/opd/appointments/${t}/status`,{status:n})}function rce(t,n){return te.post(`/opd/appointments/${t}/reschedule`,n)}function sce(t={}){return te.get("/opd/appointments/noshow",{params:qc(t)})}function gB(t={}){return te.get("/opd/queue",{params:qc(t)})}function ace(t){return te.get(`/opd/visits/${t}`)}function ice(t,n){return te.put(`/opd/visits/${t}`,n)}function oce(t){return te.post("/opd/vitals",t)}function lce(t,n){return te.post(`/opd/visits/${t}/followup`,n)}function cce(t={}){return te.get("/opd/followups",{params:qc(t)})}function dce(t,n){return te.put(`/opd/followups/${t}`,n)}function uce(t,n){return te.post(`/opd/followups/${t}/schedule`,n)}function fce(t={}){return te.get("/opd/doctor-fees",{params:qc(t)})}function hce(t){return te.post("/opd/doctor-fees",t)}function mce(t,n){return te.put(`/opd/doctor-fees/${t}`,n)}function aP(t){if(t.id){const{id:n,...r}=t;return mce(n,r)}return hce(t)}function pce(t){return te.delete(`/opd/doctor-fees/${t}`)}function yB(){return Yle()}function xce({departmentId:t}={}){const n=qc({department_id:t});return te.get("/opd/roles",{params:n})}function vB({departmentId:t,roleId:n,isDoctor:r}={}){return Xle({departmentId:t,roleId:n,isDoctor:r})}function gce({dateFrom:t,dateTo:n,doctorId:r}={}){return te.get("/opd/dashboard",{params:qc({date_from:t,date_to:n,doctor_id:r})})}const xN=10;function yce({value:t,onChange:n}){const[r,s]=b.useState(""),[i,o]=b.useState([]),[l,c]=b.useState(0);b.useEffect(()=>{let m=!0;return(async()=>{const{data:y}=await xB(r||"");m&&(o(y||[]),c(0))})(),()=>{m=!1}},[r]);const d=Math.max(1,Math.ceil(((i==null?void 0:i.length)||0)/xN)),u=l*xN,h=b.useMemo(()=>(i||[]).slice(u,u+xN),[i,u]);return a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Patient"}),a.jsxs("div",{className:"relative",children:[a.jsx(ur,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),a.jsx("input",{className:"input pl-9",placeholder:"Search by UHID, name, phone, email",value:r,onChange:m=>s(m.target.value)})]}),a.jsx("div",{className:"rounded-xl border overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-left text-xs text-gray-500 bg-gray-50",children:[a.jsx("th",{className:"px-3 py-2",children:"UHID"}),a.jsx("th",{className:"px-3 py-2",children:"Name"}),a.jsx("th",{className:"px-3 py-2",children:"Phone"}),a.jsx("th",{className:"px-3 py-2"})]})}),a.jsxs("tbody",{children:[h.map(m=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-1",children:m.uhid}),a.jsxs("td",{className:"px-3 py-1",children:[m.first_name," ",m.last_name]}),a.jsx("td",{className:"px-3 py-1",children:m.phone||""}),a.jsx("td",{className:"px-3 py-1",children:a.jsx("button",{className:["btn btn-sm",t===m.id?"bg-emerald-600 hover:bg-emerald-700":""].join(" "),onClick:()=>n(m.id),children:t===m.id?"Selected":"Select"})})]},m.id)),!h.length&&a.jsx("tr",{children:a.jsx("td",{className:"px-3 py-3 text-sm text-gray-500",colSpan:4,children:"No results"})})]})]})}),a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsxs("button",{className:"px-2 py-1 rounded-lg border disabled:opacity-50",onClick:()=>c(m=>Math.max(0,m-1)),disabled:l===0,children:[a.jsx(xL,{className:"inline h-4 w-4"})," Prev"]}),a.jsxs("div",{children:["Page ",l+1," / ",d]}),a.jsxs("button",{className:"px-2 py-1 rounded-lg border disabled:opacity-50",onClick:()=>c(m=>Math.min(d-1,m+1)),disabled:l>=d-1,children:["Next ",a.jsx(gL,{className:"inline h-4 w-4"})]})]})]})}function bB({value:t,onChange:n}){const[r,s]=b.useState([]),[i,o]=b.useState(""),[l,c]=b.useState([]),[d,u]=b.useState(""),[h,m]=b.useState([]);return b.useEffect(()=>{SA().then(g=>s(g.data||[]))},[]),b.useEffect(()=>{c([]),u(""),m([]),i&&CA({ward_id:i}).then(g=>c(g.data||[]))},[i]),b.useEffect(()=>{m([]),d&&Ao({room_id:d}).then(g=>m(g.data||[]))},[d]),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Allocate Bed (Ward  Room  Bed)"}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsxs("select",{className:"input",value:i,onChange:g=>o(g.target.value),children:[a.jsx("option",{value:"",children:"Select ward"}),r.map(g=>a.jsxs("option",{value:g.id,children:[g.code,"  ",g.name]},g.id))]}),a.jsxs("select",{className:"input",value:d,onChange:g=>u(g.target.value),disabled:!i,children:[a.jsx("option",{value:"",children:"Select room"}),l.map(g=>a.jsxs("option",{value:g.id,children:[g.number,"  ",g.type]},g.id))]}),a.jsxs("select",{className:"input",value:t||"",onChange:g=>n(Number(g.target.value)),disabled:!d,children:[a.jsx("option",{value:"",children:"Select bed"}),h.map(g=>a.jsxs("option",{value:g.id,children:[g.code," ",g.state!=="vacant"?` ${g.state}`:""]},g.id))]})]}),!!t&&(()=>{const g=h.find(y=>y.id===t);return g?a.jsxs("div",{className:"text-xs text-gray-500",children:["Selected: ",a.jsx("span",{className:"font-medium",children:g.code})," (",g.state,")"]}):null})()]})}function Al({value:t,onChange:n,label:r="Department  Doctor"}){const[s,i]=b.useState([]),[o,l]=b.useState(""),[c,d]=b.useState([]),[u,h]=b.useState(!1),[m,g]=b.useState(!1),[y,N]=b.useState("");b.useEffect(()=>{let A=!0;return g(!0),yB().then(k=>{A&&i(k.data||[])}).catch(k=>{A&&(console.error("fetchDepartments error",k),fe.error("Failed to load departments"),i([]))}).finally(()=>{A&&g(!1)}),()=>{A=!1}},[]),b.useEffect(()=>{let A=!0;N(""),d([]);const k=o?Number(o):null;if(n==null||n(null,{department_id:k}),!!o)return h(!0),vB({departmentId:k,isDoctor:!0}).then(T=>{A&&d(T.data||[])}).catch(T=>{var P,M,O,D;A&&(console.error("fetchDepartmentUsers error",T),N(((M=(P=T==null?void 0:T.response)==null?void 0:P.data)==null?void 0:M.detail)||"Failed to load doctors"),fe.error(((D=(O=T==null?void 0:T.response)==null?void 0:O.data)==null?void 0:D.detail)||"Failed to load doctors"),d([]))}).finally(()=>{A&&h(!1)}),()=>{A=!1}},[o]);const j=b.useMemo(()=>c.find(A=>A.id===t)||null,[c,t]),S=A=>{const k=A.target.value;l(k)},_=A=>{const k=A.target.value,T=k?Number(k):null,P=o?Number(o):null;n==null||n(T,{department_id:P})};return a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:r}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("select",{className:"input",value:o,onChange:S,disabled:m,children:[a.jsx("option",{value:"",children:m?"Loading departments":"Select department"}),s.map(A=>a.jsx("option",{value:A.id,children:A.name},A.id))]}),a.jsxs("select",{className:"input",value:t||"",onChange:_,disabled:!o||u||c.length===0,children:[a.jsx("option",{value:"",children:u?"Loading doctors":o?c.length===0?"No doctors in this department":"Select doctor":"Select department first"}),c.map(A=>a.jsxs("option",{value:A.id,children:[A.name,A.email?` (${A.email})`:""]},A.id))]})]}),j&&a.jsxs("div",{className:"rounded-xl border bg-emerald-50 px-3 py-2 text-sm",children:["Selected:"," ",a.jsx("span",{className:"font-medium",children:j.name})]}),y&&a.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-2 text-sm text-red-700",children:y})]})}function vce({kind:t="success",title:n,message:r,onClose:s}){const i={success:{bg:"bg-emerald-50",border:"border-emerald-200",text:"text-emerald-700",Icon:Fi},warn:{bg:"bg-amber-50",border:"border-amber-200",text:"text-amber-800",Icon:wc},error:{bg:"bg-rose-50",border:"border-rose-200",text:"text-rose-700",Icon:U_}},o=i[t]||i.success;return a.jsxs("div",{className:`flex items-start gap-3 rounded-xl border ${o.border} ${o.bg} p-3`,children:[a.jsx(o.Icon,{className:`h-5 w-5 mt-0.5 ${o.text}`}),a.jsxs("div",{className:"text-sm",children:[a.jsx("div",{className:"font-medium",children:n}),r?a.jsx("div",{className:"text-[13px] opacity-90",children:r}):null]}),a.jsx("button",{className:"ml-auto inline-flex h-7 w-7 items-center justify-center rounded-lg hover:bg-black/5",onClick:s,"aria-label":"Close",children:a.jsx(La,{className:"h-4 w-4"})})]})}const Vo=t=>typeof t=="number"?Number.isInteger(t)&&t>0:typeof t=="string"&&t.trim()!==""&&/^\d+$/.test(t)?Number(t)>0:!1;function bce(){const[t,n]=b.useState([]),[r,s]=b.useState([]),[i,o]=b.useState(!1),[l,c]=b.useState(null),[d,u]=b.useState(null),[h,m]=b.useState(null),[g,y]=b.useState(null),[N,j]=b.useState({admission_type:"planned",expected_discharge_at:"",package_id:"",payor_type:"cash",insurer_name:"",policy_number:"",preliminary_diagnosis:"",history:"",care_plan:""}),[S,_]=b.useState(null),A=b.useRef(null),k=D=>{A.current&&clearTimeout(A.current),_(D),A.current=setTimeout(()=>_(null),4500)},T=D=>D?D.length===16?`${D}:00`:D:void 0,P=b.useMemo(()=>t.find(D=>D.id===Number(g))||null,[t,g]);b.useEffect(()=>{let D=!0;return(async()=>{var L,$;o(!0);try{const[V,F]=await Promise.all([Ao(),mB()]);if(!D)return;n(V.data||[]),s(F.data||[])}catch(V){k({kind:"error",title:"Failed to load lookups",message:(($=(L=V==null?void 0:V.response)==null?void 0:L.data)==null?void 0:$.detail)||"Please refresh and try again."})}finally{D&&o(!1)}})(),()=>{D=!1}},[]);const M=async D=>{try{const{data:L}=await Nv({status:"admitted",patient_id:D});return Array.isArray(L)&&L.length>0?L[0]:null}catch{return null}},O=async D=>{var $;if(D.preventDefault(),i)return;if(!Vo(l)){k({kind:"warn",title:"Select a patient",message:"Pick a patient before admitting."});return}if(!Vo(g)){k({kind:"warn",title:"Select a bed",message:"Choose Ward  Room  Bed."});return}if(!t.find(V=>V.id===Number(g))){k({kind:"warn",title:"Selected bed is unavailable",message:"Refresh beds and select again."});return}o(!0);try{const V=await M(Number(l));if(V!=null&&V.id){const U=`ADM-${String(V.id).padStart(6,"0")}`;k({kind:"warn",title:"Patient already admitted",message:`Active admission ${U} exists. Open Tracking / My Admissions to view.`});return}const F={patient_id:Number(l),bed_id:Number(g),admission_type:N.admission_type||"planned",expected_discharge_at:T(N.expected_discharge_at),department_id:Vo(d)?Number(d):void 0,practitioner_user_id:Vo(h)?Number(h):void 0,package_id:Vo(N.package_id)?Number(N.package_id):void 0,payor_type:N.payor_type||"cash",insurer_name:N.insurer_name||"",policy_number:N.policy_number||"",preliminary_diagnosis:N.preliminary_diagnosis||"",history:N.history||"",care_plan:N.care_plan||""};Object.keys(F).forEach(U=>F[U]===void 0&&delete F[U]);const{data:Q}=await xle(F);k({kind:"success",title:"Admission created",message:`Admission ADM-${String(Q.id).padStart(6,"0")} has been created successfully.`});try{const U=await Ao();n(U.data||[])}catch{}y(null),j(U=>({...U,expected_discharge_at:"",preliminary_diagnosis:"",history:"",care_plan:"",package_id:"",payor_type:"cash",insurer_name:"",policy_number:""}))}catch(V){const F=($=V==null?void 0:V.response)==null?void 0:$.data,Q=Array.isArray(F==null?void 0:F.detail)?F.detail.map(z=>z==null?void 0:z.msg).filter(Boolean).join(", "):(F==null?void 0:F.detail)||V.message||"Failed to create admission",U=/Bed not found/i.test(Q)?"Please select a valid bed.":/Bed not available/i.test(Q)?"That bed is not available. Pick another one.":Q;k({kind:"error",title:"Admission failed",message:U})}finally{o(!1)}};return a.jsxs("div",{className:"p-4 space-y-4 text-black",children:[S&&a.jsx(vce,{kind:S.kind,title:S.title,message:S.message,onClose:()=>_(null)}),a.jsxs("div",{className:"rounded-2xl border bg-white shadow-sm",children:[a.jsx("div",{className:"border-b px-4 py-3 font-semibold",children:"New Admission"}),a.jsx(Nr,{anyOf:["ipd.manage"],fallback:a.jsx("div",{className:"p-4 text-xs text-gray-500",children:"Creating admissions requires IPD Manage permission."}),children:a.jsxs("form",{onSubmit:O,className:"p-4 space-y-6 text-sm",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(yce,{value:l??void 0,onChange:c}),Vo(l)&&a.jsx("div",{className:"rounded-xl border bg-gray-50 px-3 py-2 text-xs text-gray-600",children:"Tip: Well auto-block if this patient already has an active admission."})]}),a.jsx(Al,{label:"Primary Doctor  Department  Role  User",value:h??void 0,onChange:(D,L)=>{m(D||null),u((L==null?void 0:L.department_id)||null)}}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(bB,{value:g??"",onChange:D=>y(Vo(D)?Number(D):null)}),P&&a.jsxs("div",{className:"rounded-xl border bg-white px-3 py-2 text-xs text-gray-700",children:["Selected bed: ",a.jsx("span",{className:"font-medium",children:P.code}),"  State:",a.jsx("span",{className:["rounded-md px-1.5 py-0.5",P.state==="vacant"?"bg-emerald-50 text-emerald-700 border border-emerald-200":P.state==="reserved"?"bg-amber-50 text-amber-700 border border-amber-200":"bg-gray-100 text-gray-700 border"].join(" "),children:P.state}),P.reserved_until&&a.jsxs("span",{className:"ml-2 text-gray-500",children:["until ",new Date(P.reserved_until).toLocaleString()]})]})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500",children:"Admission type"}),a.jsx("select",{className:"input",value:N.admission_type,onChange:D=>j({...N,admission_type:D.target.value}),children:["planned","emergency","daycare"].map(D=>a.jsx("option",{value:D,children:D},D))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500",children:"Expected discharge"}),a.jsx("input",{type:"datetime-local",className:"input",value:N.expected_discharge_at,onChange:D=>j({...N,expected_discharge_at:D.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500",children:"Package"}),a.jsxs("select",{className:"input",value:N.package_id,onChange:D=>j({...N,package_id:D.target.value}),children:[a.jsx("option",{value:"",children:""}),r.map(D=>a.jsx("option",{value:D.id,children:D.name},D.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500",children:"Payor type"}),a.jsx("select",{className:"input",value:N.payor_type,onChange:D=>j({...N,payor_type:D.target.value}),children:["cash","insurance","tpa"].map(D=>a.jsx("option",{value:D,children:D},D))})]}),a.jsx("input",{className:"input md:col-span-2",placeholder:"Insurer name",value:N.insurer_name,onChange:D=>j({...N,insurer_name:D.target.value})}),a.jsx("input",{className:"input",placeholder:"Policy number",value:N.policy_number,onChange:D=>j({...N,policy_number:D.target.value})}),a.jsx("input",{className:"input md:col-span-2",placeholder:"Preliminary diagnosis",value:N.preliminary_diagnosis,onChange:D=>j({...N,preliminary_diagnosis:D.target.value})}),a.jsx("input",{className:"input",placeholder:"History",value:N.history,onChange:D=>j({...N,history:D.target.value})}),a.jsx("input",{className:"input",placeholder:"Care plan",value:N.care_plan,onChange:D=>j({...N,care_plan:D.target.value})})]}),a.jsx("div",{className:"flex items-center justify-end gap-2",children:a.jsx("button",{className:"btn",disabled:i||!Vo(l)||!Vo(g),children:i?"Admitting":"Admit"})})]})})]})]})}function ks(t){const n=Cr(o=>o.user),r=Cr(o=>o.modules)||{};if(!t||!n)return!1;if(n.is_admin)return!0;const[s]=t.split(".");return(r[s]||[]).some(o=>o.code===t)}function wB({value:t,onChange:n,label:r="Department  Role  User",onlyDoctors:s=!1}){const[i,o]=b.useState([]),[l,c]=b.useState(""),[d,u]=b.useState([]),[h,m]=b.useState(""),[g,y]=b.useState([]),[N,j]=b.useState("");return b.useEffect(()=>{let S=!0;return yB().then(_=>S&&o(_.data||[])).catch(()=>S&&o([])),()=>{S=!1}},[]),b.useEffect(()=>{let S=!0;if(m(""),y([]),j(""),!l){u([]);return}return xce({departmentId:Number(l)}).then(_=>S&&u(_.data||[])).catch(()=>S&&u([])),()=>{S=!1}},[l]),b.useEffect(()=>{let S=!0;if(y([]),j(""),!(!l||!h))return vB({departmentId:Number(l),roleId:Number(h),isDoctor:s}).then(_=>S&&y(_.data||[])).catch(()=>S&&y([])),()=>{S=!1}},[l,h,s]),b.useEffect(()=>{n==null||n(N?Number(N):null,{department_id:l?Number(l):null,role_id:h?Number(h):null})},[N,l,h,n]),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:r}),a.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[a.jsxs("select",{className:"input",value:l,onChange:S=>c(S.target.value),children:[a.jsx("option",{value:"",children:"Select department"}),i.map(S=>a.jsx("option",{value:S.id,children:S.name},S.id))]}),a.jsxs("select",{className:"input",value:h,onChange:S=>m(S.target.value),disabled:!l,children:[a.jsx("option",{value:"",children:"Select role"}),d.map(S=>a.jsx("option",{value:S.id,children:S.name},S.id))]}),a.jsxs("select",{className:"input",value:N,onChange:S=>j(S.target.value),disabled:!h,children:[a.jsx("option",{value:"",children:"Select user"}),g.map(S=>a.jsx("option",{value:S.id,children:S.name},S.id))]})]})]})}function wce({admissionId:t,canWrite:n}){const r=n??ks("ipd.nursing"),[s,i]=b.useState([]),[o,l]=b.useState({entry_time:"",patient_condition:"",clinical_finding:"",significant_events:"",response_progress:""}),[c,d]=b.useState(!1),[u,h]=b.useState(""),m=async()=>{var y,N;d(!0),h("");try{const{data:j}=await ble(t);i(j||[])}catch(j){h(((N=(y=j==null?void 0:j.response)==null?void 0:y.data)==null?void 0:N.detail)||"Failed to load")}finally{d(!1)}};b.useEffect(()=>{m()},[t]);const g=async y=>{var N,j;y.preventDefault();try{const S={entry_time:o.entry_time?new Date(o.entry_time).toISOString():void 0,patient_condition:o.patient_condition||"",clinical_finding:o.clinical_finding||"",significant_events:o.significant_events||"",response_progress:o.response_progress||""};await Vle(t,S),l({entry_time:"",patient_condition:"",clinical_finding:"",significant_events:"",response_progress:""}),m()}catch(S){h(((j=(N=S==null?void 0:S.response)==null?void 0:N.data)==null?void 0:j.detail)||"Save failed")}};return a.jsxs("div",{className:"space-y-4",children:[!r&&a.jsx("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-2 text-xs text-gray-600",children:"View-only. You dont have permission to add nursing notes."}),r&&a.jsxs("form",{onSubmit:g,className:"rounded-xl border bg-white p-3 space-y-2",children:[a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500",children:"Entry time"}),a.jsx("input",{type:"datetime-local",className:"input",value:o.entry_time,onChange:y=>l(N=>({...N,entry_time:y.target.value}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500",children:"Patient condition"}),a.jsx("input",{className:"input",value:o.patient_condition,onChange:y=>l(N=>({...N,patient_condition:y.target.value}))})]}),a.jsx("input",{className:"input md:col-span-2",placeholder:"Clinical finding",value:o.clinical_finding,onChange:y=>l(N=>({...N,clinical_finding:y.target.value}))}),a.jsx("input",{className:"input md:col-span-2",placeholder:"Significant events",value:o.significant_events,onChange:y=>l(N=>({...N,significant_events:y.target.value}))}),a.jsx("input",{className:"input md:col-span-2",placeholder:"Response / Progress",value:o.response_progress,onChange:y=>l(N=>({...N,response_progress:y.target.value}))})]}),a.jsx("button",{className:"btn",children:"Add Note"})]}),a.jsxs("div",{className:"rounded-xl border bg-white",children:[a.jsx("div",{className:"px-3 py-2 text-sm font-medium",children:"Recent notes"}),c?a.jsx("div",{className:"px-3 pb-3 text-sm",children:"Loading"}):a.jsxs("div",{className:"divide-y",children:[(s||[]).map(y=>a.jsxs("div",{className:"px-3 py-2 text-sm",children:[a.jsx("div",{className:"text-xs text-gray-500",children:new Date(y.entry_time).toLocaleString()}),a.jsx("div",{className:"font-medium",children:y.patient_condition||""}),a.jsx("div",{className:"text-gray-700",children:y.clinical_finding}),y.significant_events&&a.jsxs("div",{className:"text-gray-700",children:["Events: ",y.significant_events]}),y.response_progress&&a.jsxs("div",{className:"text-gray-700",children:["Progress: ",y.response_progress]})]},y.id)),(!s||s.length===0)&&a.jsx("div",{className:"px-3 py-3 text-sm text-gray-500",children:"No notes yet."})]})]}),u&&a.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 p-2 text-rose-700 text-sm",children:u})]})}function Nce({admissionId:t,canWrite:n}){const r=n??ks("ipd.nursing"),[s,i]=b.useState([]),[o,l]=b.useState({recorded_at:"",bp_systolic:"",bp_diastolic:"",temp_c:"",rr:"",spo2:"",pulse:""}),[c,d]=b.useState(""),u=async()=>{var m,g;try{const{data:y}=await Nle(t);i(y||[])}catch(y){d(((g=(m=y==null?void 0:y.response)==null?void 0:m.data)==null?void 0:g.detail)||"Failed to load")}};b.useEffect(()=>{u()},[t]);const h=async m=>{var g,y;m.preventDefault(),d("");try{const N={recorded_at:o.recorded_at?new Date(o.recorded_at).toISOString():void 0,bp_systolic:o.bp_systolic?Number(o.bp_systolic):void 0,bp_diastolic:o.bp_diastolic?Number(o.bp_diastolic):void 0,temp_c:o.temp_c?Number(o.temp_c):void 0,rr:o.rr?Number(o.rr):void 0,spo2:o.spo2?Number(o.spo2):void 0,pulse:o.pulse?Number(o.pulse):void 0};await Hle(t,N),l({recorded_at:"",bp_systolic:"",bp_diastolic:"",temp_c:"",rr:"",spo2:"",pulse:""}),u()}catch(N){d(((y=(g=N==null?void 0:N.response)==null?void 0:g.data)==null?void 0:y.detail)||"Save failed")}};return a.jsxs("div",{className:"space-y-4",children:[!r&&a.jsx("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-2 text-xs text-gray-600",children:"View-only. You dont have permission to record vitals."}),r&&a.jsxs("form",{onSubmit:h,className:"rounded-xl border bg-white p-3 space-y-2",children:[a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500",children:"Recorded at"}),a.jsx("input",{type:"datetime-local",className:"input",value:o.recorded_at,onChange:m=>l(g=>({...g,recorded_at:m.target.value}))})]}),a.jsx("input",{className:"input",placeholder:"BP (Systolic)",value:o.bp_systolic,onChange:m=>l(g=>({...g,bp_systolic:m.target.value}))}),a.jsx("input",{className:"input",placeholder:"BP (Diastolic)",value:o.bp_diastolic,onChange:m=>l(g=>({...g,bp_diastolic:m.target.value}))}),a.jsx("input",{className:"input",placeholder:"Temp C",value:o.temp_c,onChange:m=>l(g=>({...g,temp_c:m.target.value}))}),a.jsx("input",{className:"input",placeholder:"RR",value:o.rr,onChange:m=>l(g=>({...g,rr:m.target.value}))}),a.jsx("input",{className:"input",placeholder:"SpO",value:o.spo2,onChange:m=>l(g=>({...g,spo2:m.target.value}))}),a.jsx("input",{className:"input",placeholder:"Pulse",value:o.pulse,onChange:m=>l(g=>({...g,pulse:m.target.value}))})]}),a.jsx("button",{className:"btn",children:"Record"})]}),a.jsx("div",{className:"rounded-xl border bg-white overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-50",children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"Time"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"BP"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Temp"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"RR"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"SpO"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Pulse"})]})}),a.jsxs("tbody",{children:[(s||[]).map(m=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:new Date(m.recorded_at).toLocaleString()}),a.jsx("td",{className:"px-3 py-2",children:[m.bp_systolic,m.bp_diastolic].filter(Boolean).join("/")||""}),a.jsx("td",{className:"px-3 py-2",children:m.temp_c??""}),a.jsx("td",{className:"px-3 py-2",children:m.rr??""}),a.jsx("td",{className:"px-3 py-2",children:m.spo2??""}),a.jsx("td",{className:"px-3 py-2",children:m.pulse??""})]},m.id)),(!s||s.length===0)&&a.jsx("tr",{children:a.jsx("td",{className:"px-3 py-3 text-gray-500",colSpan:6,children:"No vitals yet."})})]})]})}),c&&a.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 p-2 text-rose-700 text-sm",children:c})]})}function jce({admissionId:t}){const[n,r]=b.useState([]),[s,i]=b.useState(""),[o,l]=b.useState({recorded_at:"",intake_ml:"",urine_ml:"",drains_ml:"",stools_count:"",remarks:""}),c=async()=>{var h,m;i("");try{const{data:g}=await Sle(t);r((g||[]).sort((y,N)=>new Date(N.recorded_at)-new Date(y.recorded_at)))}catch(g){i(((m=(h=g==null?void 0:g.response)==null?void 0:h.data)==null?void 0:m.detail)||"Failed to load I/O")}};b.useEffect(()=>{c()},[t]);const d=h=>h?h.length===16?`${h}:00`:h:void 0,u=async h=>{var m,g;h.preventDefault(),i("");try{const y={recorded_at:d(o.recorded_at),intake_ml:o.intake_ml?Number(o.intake_ml):0,urine_ml:o.urine_ml?Number(o.urine_ml):0,drains_ml:o.drains_ml?Number(o.drains_ml):0,stools_count:o.stools_count?Number(o.stools_count):0,remarks:o.remarks||""};await Cle(t,y),l({recorded_at:"",intake_ml:"",urine_ml:"",drains_ml:"",stools_count:"",remarks:""}),await c()}catch(y){i(((g=(m=y==null?void 0:y.response)==null?void 0:m.data)==null?void 0:g.detail)||"Failed to add I/O")}};return a.jsxs("div",{className:"space-y-3",children:[a.jsx(Nr,{anyOf:["ipd.nursing"],children:a.jsxs("form",{onSubmit:u,className:"rounded-xl border bg-white p-3 grid gap-3 md:grid-cols-6 text-sm",children:[a.jsx("div",{className:"md:col-span-6 font-medium",children:"Record Intake / Output"}),a.jsx("input",{type:"datetime-local",className:"input",value:o.recorded_at,onChange:h=>l(m=>({...m,recorded_at:h.target.value}))}),a.jsx("input",{className:"input",placeholder:"Intake (ml)",value:o.intake_ml,onChange:h=>l(m=>({...m,intake_ml:h.target.value}))}),a.jsx("input",{className:"input",placeholder:"Urine (ml)",value:o.urine_ml,onChange:h=>l(m=>({...m,urine_ml:h.target.value}))}),a.jsx("input",{className:"input",placeholder:"Drains (ml)",value:o.drains_ml,onChange:h=>l(m=>({...m,drains_ml:h.target.value}))}),a.jsx("input",{className:"input",placeholder:"Stools count",value:o.stools_count,onChange:h=>l(m=>({...m,stools_count:h.target.value}))}),a.jsx("input",{className:"input md:col-span-2",placeholder:"Remarks",value:o.remarks,onChange:h=>l(m=>({...m,remarks:h.target.value}))}),a.jsx("div",{className:"md:col-span-6 flex justify-end",children:a.jsx("button",{className:"btn",children:"Save"})}),s&&a.jsx("div",{className:"md:col-span-6 rounded-xl border border-rose-200 bg-rose-50 p-2 text-rose-700",children:s})]})}),a.jsx("div",{className:"rounded-xl border overflow-x-auto",children:a.jsxs("table",{className:"min-w-[680px] w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-left text-xs text-gray-500 bg-gray-50",children:[a.jsx("th",{className:"px-3 py-2",children:"Time"}),a.jsx("th",{className:"px-3 py-2",children:"Intake"}),a.jsx("th",{className:"px-3 py-2",children:"Urine"}),a.jsx("th",{className:"px-3 py-2",children:"Drains"}),a.jsx("th",{className:"px-3 py-2",children:"Stools"}),a.jsx("th",{className:"px-3 py-2",children:"Remarks"})]})}),a.jsxs("tbody",{children:[(n||[]).map(h=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:new Date(h.recorded_at).toLocaleString()}),a.jsx("td",{className:"px-3 py-2",children:h.intake_ml}),a.jsx("td",{className:"px-3 py-2",children:h.urine_ml}),a.jsx("td",{className:"px-3 py-2",children:h.drains_ml}),a.jsx("td",{className:"px-3 py-2",children:h.stools_count}),a.jsx("td",{className:"px-3 py-2",children:h.remarks||""})]},h.id)),!(n!=null&&n.length)&&a.jsx("tr",{children:a.jsx("td",{className:"p-3 text-sm text-gray-500",colSpan:6,children:"No I/O entries"})})]})]})})]})}function Sce({admissionId:t}){const[n,r]=b.useState([]),[s,i]=b.useState(""),[o,l]=b.useState({vital_signs:"",procedure_undergone:"",todays_diagnostics:"",current_condition:"",recent_changes:"",ongoing_treatment:"",possible_changes:"",other_info:""}),c=async()=>{var u,h;i("");try{const{data:m}=await _le(t);r((m||[]).sort((g,y)=>new Date(y.created_at)-new Date(g.created_at)))}catch(m){i(((h=(u=m==null?void 0:m.response)==null?void 0:u.data)==null?void 0:h.detail)||"Failed to load handovers")}};b.useEffect(()=>{c()},[t]);const d=async u=>{var h,m;u.preventDefault(),i("");try{await Ale(t,{...o}),l({vital_signs:"",procedure_undergone:"",todays_diagnostics:"",current_condition:"",recent_changes:"",ongoing_treatment:"",possible_changes:"",other_info:""}),await c()}catch(g){i(((m=(h=g==null?void 0:g.response)==null?void 0:h.data)==null?void 0:m.detail)||"Failed to add handover")}};return a.jsxs("div",{className:"space-y-3",children:[a.jsx(Nr,{anyOf:["ipd.nursing"],children:a.jsxs("form",{onSubmit:d,className:"rounded-xl border bg-white p-3 grid gap-3 md:grid-cols-2 text-sm",children:[a.jsx("div",{className:"md:col-span-2 font-medium",children:"Shift Handover"}),a.jsx("input",{className:"input",placeholder:"Vital signs",value:o.vital_signs,onChange:u=>l(h=>({...h,vital_signs:u.target.value}))}),a.jsx("input",{className:"input",placeholder:"Procedure undergone",value:o.procedure_undergone,onChange:u=>l(h=>({...h,procedure_undergone:u.target.value}))}),a.jsx("input",{className:"input md:col-span-2",placeholder:"Today's diagnostics/procedures",value:o.todays_diagnostics,onChange:u=>l(h=>({...h,todays_diagnostics:u.target.value}))}),a.jsx("input",{className:"input",placeholder:"Current condition",value:o.current_condition,onChange:u=>l(h=>({...h,current_condition:u.target.value}))}),a.jsx("input",{className:"input",placeholder:"Recent changes",value:o.recent_changes,onChange:u=>l(h=>({...h,recent_changes:u.target.value}))}),a.jsx("input",{className:"input",placeholder:"Ongoing treatment",value:o.ongoing_treatment,onChange:u=>l(h=>({...h,ongoing_treatment:u.target.value}))}),a.jsx("input",{className:"input",placeholder:"Possible changes/complications",value:o.possible_changes,onChange:u=>l(h=>({...h,possible_changes:u.target.value}))}),a.jsx("input",{className:"input md:col-span-2",placeholder:"Other info",value:o.other_info,onChange:u=>l(h=>({...h,other_info:u.target.value}))}),a.jsx("div",{className:"md:col-span-2 flex justify-end",children:a.jsx("button",{className:"btn",children:"Save"})}),s&&a.jsx("div",{className:"md:col-span-2 rounded-xl border border-rose-200 bg-rose-50 p-2 text-rose-700",children:s})]})}),a.jsx("div",{className:"rounded-xl border overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-left text-xs text-gray-500 bg-gray-50",children:[a.jsx("th",{className:"px-3 py-2",children:"Time"}),a.jsx("th",{className:"px-3 py-2",children:"Vitals"}),a.jsx("th",{className:"px-3 py-2",children:"Procedure"}),a.jsx("th",{className:"px-3 py-2",children:"Diagnostics"}),a.jsx("th",{className:"px-3 py-2",children:"Condition"})]})}),a.jsxs("tbody",{children:[(n||[]).map(u=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:new Date(u.created_at).toLocaleString()}),a.jsx("td",{className:"px-3 py-2",children:u.vital_signs||""}),a.jsx("td",{className:"px-3 py-2",children:u.procedure_undergone||""}),a.jsx("td",{className:"px-3 py-2",children:u.todays_diagnostics||""}),a.jsx("td",{className:"px-3 py-2",children:u.current_condition||""})]},u.id)),!(n!=null&&n.length)&&a.jsx("tr",{children:a.jsx("td",{className:"p-3 text-sm text-gray-500",colSpan:5,children:"No handovers"})})]})]})})]})}function Cce({admissionId:t}){const[n,r]=b.useState([]),[s,i]=b.useState(""),[o,l]=b.useState(""),c=async()=>{var u,h;i("");try{const{data:m}=await Ele(t);r((m||[]).sort((g,y)=>new Date(y.created_at)-new Date(g.created_at)))}catch(m){i(((h=(u=m==null?void 0:m.response)==null?void 0:u.data)==null?void 0:h.detail)||"Failed to load rounds")}};b.useEffect(()=>{c()},[t]);const d=async u=>{var h,m;u.preventDefault(),i("");try{await kle(t,{notes:o||""}),l(""),await c()}catch(g){i(((m=(h=g==null?void 0:g.response)==null?void 0:h.data)==null?void 0:m.detail)||"Failed to add round")}};return a.jsxs("div",{className:"space-y-3",children:[a.jsx(Nr,{anyOf:["ipd.doctor"],children:a.jsxs("form",{onSubmit:d,className:"rounded-xl border bg-white p-3 text-sm space-y-2",children:[a.jsx("div",{className:"font-medium",children:"Add Round Note"}),a.jsx("textarea",{className:"input",rows:3,placeholder:"Notes",value:o,onChange:u=>l(u.target.value)}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{className:"btn",children:"Save"})}),s&&a.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 p-2 text-rose-700",children:s})]})}),a.jsx("div",{className:"rounded-xl border overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-left text-xs text-gray-500 bg-gray-50",children:[a.jsx("th",{className:"px-3 py-2",children:"Time"}),a.jsx("th",{className:"px-3 py-2",children:"Notes"})]})}),a.jsxs("tbody",{children:[(n||[]).map(u=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:new Date(u.created_at).toLocaleString()}),a.jsx("td",{className:"px-3 py-2",children:u.notes||""})]},u.id)),!(n!=null&&n.length)&&a.jsx("tr",{children:a.jsx("td",{className:"p-3 text-sm text-gray-500",colSpan:2,children:"No rounds"})})]})]})})]})}function _ce({admissionId:t}){const[n,r]=b.useState([]),[s,i]=b.useState(""),[o,l]=b.useState({observation:"",plan:""}),c=async()=>{var u,h;i("");try{const{data:m}=await Tle(t);r((m||[]).sort((g,y)=>new Date(y.created_at)-new Date(g.created_at)))}catch(m){i(((h=(u=m==null?void 0:m.response)==null?void 0:u.data)==null?void 0:h.detail)||"Failed to load progress notes")}};b.useEffect(()=>{c()},[t]);const d=async u=>{var h,m;u.preventDefault(),i("");try{await Ile(t,{observation:o.observation||"",plan:o.plan||""}),l({observation:"",plan:""}),await c()}catch(g){i(((m=(h=g==null?void 0:g.response)==null?void 0:h.data)==null?void 0:m.detail)||"Failed to add progress note")}};return a.jsxs("div",{className:"space-y-3",children:[a.jsx(Nr,{anyOf:["ipd.doctor"],children:a.jsxs("form",{onSubmit:d,className:"rounded-xl border bg-white p-3 grid gap-3 md:grid-cols-2 text-sm",children:[a.jsx("div",{className:"md:col-span-2 font-medium",children:"New Progress Note"}),a.jsx("textarea",{className:"input",rows:3,placeholder:"Observation",value:o.observation,onChange:u=>l(h=>({...h,observation:u.target.value}))}),a.jsx("textarea",{className:"input",rows:3,placeholder:"Plan",value:o.plan,onChange:u=>l(h=>({...h,plan:u.target.value}))}),a.jsx("div",{className:"md:col-span-2 flex justify-end",children:a.jsx("button",{className:"btn",children:"Save"})}),s&&a.jsx("div",{className:"md:col-span-2 rounded-xl border border-rose-200 bg-rose-50 p-2 text-rose-700",children:s})]})}),a.jsx("div",{className:"rounded-xl border overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-left text-xs text-gray-500 bg-gray-50",children:[a.jsx("th",{className:"px-3 py-2",children:"Time"}),a.jsx("th",{className:"px-3 py-2",children:"Observation"}),a.jsx("th",{className:"px-3 py-2",children:"Plan"})]})}),a.jsxs("tbody",{children:[(n||[]).map(u=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:new Date(u.created_at).toLocaleString()}),a.jsx("td",{className:"px-3 py-2",children:u.observation||""}),a.jsx("td",{className:"px-3 py-2",children:u.plan||""})]},u.id)),!(n!=null&&n.length)&&a.jsx("tr",{children:a.jsx("td",{className:"p-3 text-sm text-gray-500",colSpan:3,children:"No progress notes"})})]})]})})]})}function Ace({admissionId:t}){const[n,r]=b.useState([]),[s,i]=b.useState(""),[o,l]=b.useState(null),[c,d]=b.useState(null),[u,h]=b.useState({type:"internal",to_department:"",external_org:"",reason:""}),m=async()=>{var y,N;i("");try{const{data:j}=await Ple(t);r(j||[])}catch(j){i(((N=(y=j==null?void 0:j.response)==null?void 0:y.data)==null?void 0:N.detail)||"Failed to load referrals")}};b.useEffect(()=>{m()},[t]);const g=async y=>{var N,j;y.preventDefault();try{const S={type:u.type,to_department:u.to_department||"",to_user_id:o||void 0,external_org:u.external_org||"",reason:u.reason||""};await Mle(t,S),h({type:"internal",to_department:"",external_org:"",reason:""}),l(null),d(null),await m()}catch(S){i(((j=(N=S==null?void 0:S.response)==null?void 0:N.data)==null?void 0:j.detail)||"Failed to create referral")}};return a.jsxs("div",{className:"space-y-3",children:[a.jsxs("form",{onSubmit:g,className:"rounded-xl border bg-white p-3 text-sm space-y-3",children:[a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500",children:"Type"}),a.jsxs("select",{className:"input",value:u.type,onChange:y=>h(N=>({...N,type:y.target.value})),children:[a.jsx("option",{value:"internal",children:"Internal"}),a.jsx("option",{value:"external",children:"External"})]})]}),u.type==="internal"?a.jsx("div",{className:"md:col-span-2",children:a.jsx(wB,{label:"Department  Role  User",value:o||void 0,onChange:(y,N)=>{l(y||null),d((N==null?void 0:N.department_id)||null),h(j=>({...j,to_department:N!=null&&N.department_id?String(N.department_id):""}))}})}):a.jsx("input",{className:"input md:col-span-2",placeholder:"External organization",value:u.external_org,onChange:y=>h(N=>({...N,external_org:y.target.value}))})]}),a.jsx("input",{className:"input",placeholder:"Reason",value:u.reason,onChange:y=>h(N=>({...N,reason:y.target.value}))}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{className:"btn",children:"Save"})}),s&&a.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 p-2 text-rose-700 text-sm",children:s})]}),a.jsx("div",{className:"rounded-xl border overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-left text-xs text-gray-500 bg-gray-50",children:[a.jsx("th",{className:"px-3 py-2",children:"Type"}),a.jsx("th",{className:"px-3 py-2",children:"To"}),a.jsx("th",{className:"px-3 py-2",children:"Status"})]})}),a.jsxs("tbody",{children:[(n||[]).map(y=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:y.type}),a.jsx("td",{className:"px-3 py-2",children:y.type==="internal"?y.to_user_id?`User#${y.to_user_id}`:`Dept ${y.to_department}`:y.external_org||""}),a.jsx("td",{className:"px-3 py-2",children:y.status})]},y.id)),!(n!=null&&n.length)&&a.jsx("tr",{children:a.jsx("td",{className:"p-3 text-sm text-gray-500",colSpan:3,children:"No referrals"})})]})]})})]})}function Ece({admissionId:t}){const[n,r]=b.useState(null),[s,i]=b.useState(null),[o,l]=b.useState(""),[c,d]=b.useState(!1),[u,h]=b.useState({demographics:"",medical_history:"",treatment_summary:"",medications:"",follow_up:"",icd10_codes:"",finalize:!1}),[m,g]=b.useState({financial_clearance:!1,clinical_clearance:!1,delay_reason:"",submit:!1}),y=async()=>{var _,A;l("");try{const[k,T]=await Promise.all([Ole(t),Rle(t)]),P=(k==null?void 0:k.data)||null;r(P),P&&h({demographics:P.demographics||"",medical_history:P.medical_history||"",treatment_summary:P.treatment_summary||"",medications:P.medications||"",follow_up:P.follow_up||"",icd10_codes:P.icd10_codes||"",finalize:!1});const M=(T==null?void 0:T.data)||null;i(M),M&&g({financial_clearance:!!M.financial_clearance,clinical_clearance:!!M.clinical_clearance,delay_reason:M.delay_reason||"",submit:!1})}catch(k){l(((A=(_=k==null?void 0:k.response)==null?void 0:_.data)==null?void 0:A.detail)||"Failed to load discharge data")}};b.useEffect(()=>{y()},[t]);const N=async _=>{var A,k;_.preventDefault(),d(!0),l("");try{const T={...u};await Dle(t,T),await y()}catch(T){l(((k=(A=T==null?void 0:T.response)==null?void 0:A.data)==null?void 0:k.detail)||"Failed to save summary")}finally{d(!1)}},j=async _=>{var A,k;_.preventDefault(),d(!0),l("");try{await Lle(t,{...m}),await y()}catch(T){l(((k=(A=T==null?void 0:T.response)==null?void 0:A.data)==null?void 0:k.detail)||"Failed to save checklist")}finally{d(!1)}},S=!!(n!=null&&n.finalized);return a.jsx("div",{className:"space-y-4",children:a.jsxs(Nr,{anyOf:["ipd.manage"],children:[a.jsxs("form",{onSubmit:N,className:"rounded-xl border bg-white p-3 grid gap-3 md:grid-cols-2 text-sm",children:[a.jsx("div",{className:"md:col-span-2 font-medium",children:"Discharge Summary"}),a.jsx("textarea",{className:"input",rows:2,placeholder:"Patient demographics",value:u.demographics,onChange:_=>h(A=>({...A,demographics:_.target.value})),disabled:S}),a.jsx("textarea",{className:"input",rows:2,placeholder:"Medical history",value:u.medical_history,onChange:_=>h(A=>({...A,medical_history:_.target.value})),disabled:S}),a.jsx("textarea",{className:"input md:col-span-2",rows:3,placeholder:"Treatment summary",value:u.treatment_summary,onChange:_=>h(A=>({...A,treatment_summary:_.target.value})),disabled:S}),a.jsx("textarea",{className:"input",rows:2,placeholder:"Medications",value:u.medications,onChange:_=>h(A=>({...A,medications:_.target.value})),disabled:S}),a.jsx("textarea",{className:"input",rows:2,placeholder:"Follow-up",value:u.follow_up,onChange:_=>h(A=>({...A,follow_up:_.target.value})),disabled:S}),a.jsx("input",{className:"input md:col-span-2",placeholder:"ICD-10 codes (CSV/JSON)",value:u.icd10_codes,onChange:_=>h(A=>({...A,icd10_codes:_.target.value})),disabled:S}),a.jsxs("div",{className:"md:col-span-2 flex items-center justify-between",children:[a.jsx("div",{className:"text-xs text-gray-500",children:S?`Finalized at ${n!=null&&n.finalized_at?new Date(n.finalized_at).toLocaleString():""}`:"Fill mandatory fields before finalizing"}),a.jsxs("div",{className:"flex items-center gap-3",children:[!S&&a.jsxs("label",{className:"inline-flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:u.finalize,onChange:_=>h(A=>({...A,finalize:_.target.checked}))}),a.jsx("span",{children:"Finalize"})]}),a.jsx("button",{className:"btn",disabled:c||S,children:"Save"})]})]}),o&&a.jsx("div",{className:"md:col-span-2 rounded-xl border border-rose-200 bg-rose-50 p-2 text-rose-700",children:o})]}),a.jsxs("form",{onSubmit:j,className:"rounded-xl border bg-white p-3 grid gap-3 md:grid-cols-2 text-sm",children:[a.jsx("div",{className:"md:col-span-2 font-medium",children:"Discharge Checklist & Clearance"}),a.jsxs("label",{className:"inline-flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:m.financial_clearance,onChange:_=>g(A=>({...A,financial_clearance:_.target.checked}))}),a.jsx("span",{children:"Financial clearance"})]}),a.jsxs("label",{className:"inline-flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:m.clinical_clearance,onChange:_=>g(A=>({...A,clinical_clearance:_.target.checked}))}),a.jsx("span",{children:"Clinical clearance"})]}),a.jsx("input",{className:"input md:col-span-2",placeholder:"Delay reason (if any)",value:m.delay_reason,onChange:_=>g(A=>({...A,delay_reason:_.target.value}))}),a.jsxs("div",{className:"md:col-span-2 flex items-center justify-between",children:[a.jsxs("label",{className:"inline-flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:m.submit,onChange:_=>g(A=>({...A,submit:_.target.checked}))}),a.jsx("span",{children:"Submit checklist"})]}),a.jsx("button",{className:"btn",disabled:c,children:"Save"})]}),(s==null?void 0:s.submitted)&&a.jsxs("div",{className:"md:col-span-2 text-xs text-emerald-700",children:["Submitted at ",s!=null&&s.submitted_at?new Date(s.submitted_at).toLocaleString():""]})]})]})})}function kce({admissionId:t}){const[n,r]=b.useState([]),[s,i]=b.useState(""),[o,l]=b.useState({surgery_name:"",scheduled_start:"",scheduled_end:"",status:"planned",surgeon_id:"",anaesthetist_id:"",staff_tags:"",preop_notes:""}),[c,d]=b.useState({ot_case_id:"",pre_assessment:"",anaesthesia_type:"general",intraop_monitoring:"",drugs_administered:"",post_status:""}),u=async()=>{var y,N;i("");try{const{data:j}=await Ble(t);r(j||[])}catch(j){i(((N=(y=j==null?void 0:j.response)==null?void 0:y.data)==null?void 0:N.detail)||"Failed to load OT cases")}};b.useEffect(()=>{u()},[t]);const h=async y=>{var N,j;y.preventDefault();try{const S={admission_id:t,surgery_name:o.surgery_name,scheduled_start:o.scheduled_start?o.scheduled_start.length===16?`${o.scheduled_start}:00`:o.scheduled_start:void 0,scheduled_end:o.scheduled_end?o.scheduled_end.length===16?`${o.scheduled_end}:00`:o.scheduled_end:void 0,status:o.status||"planned",surgeon_id:o.surgeon_id?Number(o.surgeon_id):void 0,anaesthetist_id:o.anaesthetist_id?Number(o.anaesthetist_id):void 0,staff_tags:o.staff_tags||"",preop_notes:o.preop_notes||""};await Fle(t,S),l({surgery_name:"",scheduled_start:"",scheduled_end:"",status:"planned",surgeon_id:"",anaesthetist_id:"",staff_tags:"",preop_notes:""}),await u()}catch(S){i(((j=(N=S==null?void 0:S.response)==null?void 0:N.data)==null?void 0:j.detail)||"Failed to add OT case")}},m=async y=>{try{const{data:N}=await $le(y);d({...N,ot_case_id:y})}catch{d(N=>({...N,ot_case_id:y}))}},g=async y=>{var N,j;y.preventDefault();try{const S={ot_case_id:Number(c.ot_case_id),pre_assessment:c.pre_assessment||"",anaesthesia_type:c.anaesthesia_type||"general",intraop_monitoring:c.intraop_monitoring||"",drugs_administered:c.drugs_administered||"",post_status:c.post_status||""};await zle(S),alert("Anaesthesia record saved")}catch(S){alert(((j=(N=S==null?void 0:S.response)==null?void 0:N.data)==null?void 0:j.detail)||"Save failed")}};return a.jsxs("div",{className:"space-y-3",children:[a.jsxs("form",{onSubmit:h,className:"rounded-xl border bg-white p-3 grid gap-3 md:grid-cols-4 text-sm",children:[a.jsx("div",{className:"md:col-span-4 font-medium",children:"Schedule Surgery"}),a.jsx("input",{className:"input md:col-span-2",placeholder:"Surgery name",value:o.surgery_name,onChange:y=>l(N=>({...N,surgery_name:y.target.value}))}),a.jsx("input",{type:"datetime-local",className:"input",value:o.scheduled_start,onChange:y=>l(N=>({...N,scheduled_start:y.target.value}))}),a.jsx("input",{type:"datetime-local",className:"input",value:o.scheduled_end,onChange:y=>l(N=>({...N,scheduled_end:y.target.value}))}),a.jsx("select",{className:"input",value:o.status,onChange:y=>l(N=>({...N,status:y.target.value})),children:["planned","unplanned","cancelled","completed"].map(y=>a.jsx("option",{value:y,children:y},y))}),a.jsx("input",{className:"input",placeholder:"Surgeon user id (optional)",value:o.surgeon_id,onChange:y=>l(N=>({...N,surgeon_id:y.target.value}))}),a.jsx("input",{className:"input",placeholder:"Anaesthetist user id (optional)",value:o.anaesthetist_id,onChange:y=>l(N=>({...N,anaesthetist_id:y.target.value}))}),a.jsx("input",{className:"input md:col-span-2",placeholder:"Staff tags (CSV/JSON)",value:o.staff_tags,onChange:y=>l(N=>({...N,staff_tags:y.target.value}))}),a.jsx("input",{className:"input md:col-span-4",placeholder:"Pre-op notes",value:o.preop_notes,onChange:y=>l(N=>({...N,preop_notes:y.target.value}))}),a.jsx("div",{className:"md:col-span-4 flex justify-end",children:a.jsx("button",{className:"btn",children:"Add"})})]}),a.jsx("div",{className:"rounded-xl border overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-left text-xs text-gray-500 bg-gray-50",children:[a.jsx("th",{className:"px-3 py-2",children:"Case"}),a.jsx("th",{className:"px-3 py-2",children:"Schedule"}),a.jsx("th",{className:"px-3 py-2",children:"Status"}),a.jsx("th",{className:"px-3 py-2"})]})}),a.jsxs("tbody",{children:[(n||[]).map(y=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:y.surgery_name}),a.jsxs("td",{className:"px-3 py-2",children:[y.scheduled_start?new Date(y.scheduled_start).toLocaleString():"","  ",y.scheduled_end?new Date(y.scheduled_end).toLocaleString():""]}),a.jsx("td",{className:"px-3 py-2",children:y.status}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("button",{className:"btn btn-sm",onClick:()=>m(y.id),children:"Anaesthesia"})})]},y.id)),!(n!=null&&n.length)&&a.jsx("tr",{children:a.jsx("td",{className:"p-3 text-sm text-gray-500",colSpan:4,children:"No OT cases"})})]})]})}),(c==null?void 0:c.ot_case_id)&&a.jsxs("form",{onSubmit:g,className:"rounded-xl border bg-white p-3 grid gap-3 md:grid-cols-2 text-sm",children:[a.jsx("div",{className:"md:col-span-2 font-medium",children:"Anaesthesia / Procedural Sedation"}),a.jsx("textarea",{className:"input",rows:4,placeholder:"Pre-assessment",value:c.pre_assessment,onChange:y=>d(N=>({...N,pre_assessment:y.target.value}))}),a.jsx("select",{className:"input",value:c.anaesthesia_type,onChange:y=>d(N=>({...N,anaesthesia_type:y.target.value})),children:["local","regional","spinal","general"].map(y=>a.jsx("option",{value:y,children:y},y))}),a.jsx("textarea",{className:"input md:col-span-2",rows:4,placeholder:"Intra-op monitoring (JSON/time-series)",value:c.intraop_monitoring,onChange:y=>d(N=>({...N,intraop_monitoring:y.target.value}))}),a.jsx("textarea",{className:"input md:col-span-2",rows:3,placeholder:"Drugs administered (JSON)",value:c.drugs_administered,onChange:y=>d(N=>({...N,drugs_administered:y.target.value}))}),a.jsx("textarea",{className:"input md:col-span-2",rows:3,placeholder:"Post status / recovery notes",value:c.post_status,onChange:y=>d(N=>({...N,post_status:y.target.value}))}),a.jsx("div",{className:"md:col-span-2 flex justify-end gap-2",children:a.jsx("button",{className:"btn",children:"Save Anaesthesia"})})]})]})}function Tce({admissionId:t}){const n=ks("ipd.view")||ks("ipd.manage"),[r,s]=b.useState(""),[i,o]=b.useState(""),[l,c]=b.useState(null),[d,u]=b.useState(""),[h,m]=b.useState([]),g=b.useMemo(()=>{const N=new Map;for(const j of h||[])N.set(j.id,j.code);return N},[h]);b.useEffect(()=>{let N=!0;return(async()=>{try{const j=await Ao();N&&m((j==null?void 0:j.data)||[])}catch{}try{const{data:j}=await pB(t);if(!N)return;const S=j!=null&&j.admitted_at?new Date(j.admitted_at).toISOString().slice(0,10):"",_=new Date().toISOString().slice(0,10);s(S),o(_)}catch{}})(),()=>{N=!1}},[t]);const y=async()=>{var N,j;u(""),c(null);try{const{data:S}=await Ule(t,{...r?{from_date:r}:{},...i?{to_date:i}:{}});c(S)}catch(S){u(((j=(N=S==null?void 0:S.response)==null?void 0:N.data)==null?void 0:j.detail)||"Failed to preview charges")}};return n?a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"rounded-xl border bg-white p-3 grid gap-3 md:grid-cols-5 text-sm",children:[a.jsx("div",{className:"md:col-span-5 font-medium",children:"Bed Charge Preview"}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500",children:"From"}),a.jsx("input",{type:"date",className:"input",value:r,onChange:N=>s(N.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500",children:"To"}),a.jsx("input",{type:"date",className:"input",value:i,onChange:N=>o(N.target.value)})]}),a.jsx("div",{className:"md:col-span-3 flex items-end justify-end",children:a.jsx("button",{className:"btn",onClick:y,children:"Preview"})}),d&&a.jsx("div",{className:"md:col-span-5 rounded-xl border border-rose-200 bg-rose-50 p-2 text-rose-700",children:d})]}),l&&a.jsxs("div",{className:"rounded-xl border overflow-hidden bg-white",children:[a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-left text-xs text-gray-500 bg-gray-50",children:[a.jsx("th",{className:"px-3 py-2",children:"Date"}),a.jsx("th",{className:"px-3 py-2",children:"Room Type"}),a.jsx("th",{className:"px-3 py-2",children:"Bed"}),a.jsx("th",{className:"px-3 py-2",children:"Rate"})]})}),a.jsxs("tbody",{children:[(l.days||[]).map((N,j)=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:new Date(N.date).toLocaleDateString()}),a.jsx("td",{className:"px-3 py-2",children:N.room_type||""}),a.jsx("td",{className:"px-3 py-2",children:N.bed_id&&g.get(N.bed_id)||""}),a.jsx("td",{className:"px-3 py-2",children:Number(N.rate).toFixed(2)})]},j)),a.jsxs("tr",{className:"bg-gray-50 font-medium",children:[a.jsx("td",{className:"px-3 py-2",colSpan:3,children:"Total"}),a.jsx("td",{className:"px-3 py-2",children:Number(l.total_amount||0).toFixed(2)})]})]})]}),!!l.missing_rate_days&&a.jsxs("div",{className:"px-3 py-2 text-xs text-amber-700 bg-amber-50 border-t",children:["Note: ",l.missing_rate_days," day(s) had no bed rate set for the room type."]})]})]}):a.jsx("div",{className:"rounded-lg border border-rose-200 bg-rose-50 p-2 text-sm text-rose-700",children:"Access denied (need ipd.view)."})}function Sv(){return te.get("/inventory/locations")}function Ice(t){return te.post("/inventory/locations",t)}function Pce(t,n){return te.put(`/inventory/locations/${t}`,n)}function Mce(t=""){const n=t?{q:t}:{};return te.get("/inventory/suppliers",{params:n})}function Oce(t){return te.post("/inventory/suppliers",t)}function Dce(t,n){return te.put(`/inventory/suppliers/${t}`,n)}function Cv(t={}){return te.get("/inventory/items",{params:t})}function Rce(t){return te.post("/inventory/items",t)}function Lce(t,n){return te.put(`/inventory/items/${t}`,n)}function Bce(){return te.get("/inventory/items/sample-csv",{responseType:"blob"})}function Fce(t){const n=new FormData;return n.append("file",t),te.post("/inventory/items/bulk-upload",n,{headers:{"Content-Type":"multipart/form-data"}})}function $ce(t={}){return te.get("/inventory/stock",{params:t})}function zce(t={}){return te.get("/inventory/alerts/expiry",{params:t})}function Uce(t={}){return te.get("/inventory/alerts/expired",{params:t})}function Vce(t={}){return te.get("/inventory/stock/quarantine",{params:t})}function Hce(t={}){return te.get("/inventory/alerts/low-stock",{params:t})}function Wce(t={}){return te.get("/inventory/alerts/max-stock",{params:t})}function qce(t){return te.post("/inventory/purchase-orders",t)}function Gce(t={}){return te.get("/inventory/purchase-orders",{params:t})}function Kce(t,n){return te.post(`/inventory/purchase-orders/${t}/status`,null,{params:{status:n}})}function Yce(t){return te.get(`/inventory/purchase-orders/${t}/pdf`,{responseType:"blob"})}function Xce(t,n){return te.post(`/inventory/purchase-orders/${t}/mark-sent`,null,{params:{email_to:n}})}function Qce(t){return te.post("/inventory/grn",t)}function Zce(t={}){return te.get("/inventory/grn",{params:t})}function Jce(t){return te.post(`/inventory/grn/${t}/post`)}function ede(t){return te.post("/inventory/returns",t)}function tde(t={}){return te.get("/inventory/returns",{params:t})}function nde(t){return te.post(`/inventory/returns/${t}/post`)}function rde(t={}){return te.get("/inventory/transactions",{params:t})}function sde(t){return te.get(`/inventory/items/by-qr/${encodeURIComponent(t)}`)}function ade(t){return te.get("/inventory/items/by-qr-number",{params:{qr_number:t}})}function iP(t){return te.get(`/inventory/items/${t}/qr`,{responseType:"blob"})}function ide(t){return te.post("/pharmacy/prescriptions",t)}function ode(t={}){return te.get("/pharmacy/prescriptions",{params:t})}function lde(t,n){return te.post(`/pharmacy/prescriptions/${t}/dispense`,n)}function cde(t){return te.post(`/pharmacy/prescriptions/${t}/bill`)}async function dde({q:t="",type:n="all",limit:r=50}={}){const s={is_active:!0};t&&(s.q=t),n==="drug"&&(s.type="drug"),n==="consumable"&&(s.type="consumable"),r&&(s.limit=r);const i=await Cv(s);return{data:(Array.isArray(i==null?void 0:i.data)?i.data:[]).slice(0,r).map(c=>({id:c.id,code:c.code,name:c.name,generic_name:c.generic_name,strength:c.strength,form:c.form,unit:c.unit,pack_size:c.pack_size,is_consumable:!!c.is_consumable,type:c.is_consumable?"consumable":"drug"}))}}function ude(t){return Promise.resolve({data:{admission_id:t,lines:[]}})}function fde(t,n){return console.warn('saveAdmissionRx is deprecated. Use createPharmacyPrescription(type="IPD") instead.'),Promise.resolve({data:{ok:!0}})}function hde(t,n={}){return console.warn("signAdmissionRx is deprecated. Use createPharmacyPrescription + status=ISSUED instead."),Promise.resolve({data:{ok:!0}})}function mde(t={}){return te.get("/pharmacy/billing",{params:t})}function pde(t={}){return te.get("/pharmacy/billing/returns/list",{params:t})}function dS(t,[n,r]){return Math.min(r,Math.max(n,t))}function Lt(t,n,{checkForDefaultPrevented:r=!0}={}){return function(i){if(t==null||t(i),r===!1||!i.defaultPrevented)return n==null?void 0:n(i)}}function xde(t,n){const r=b.createContext(n),s=o=>{const{children:l,...c}=o,d=b.useMemo(()=>c,Object.values(c));return a.jsx(r.Provider,{value:d,children:l})};s.displayName=t+"Provider";function i(o){const l=b.useContext(r);if(l)return l;if(n!==void 0)return n;throw new Error(`\`${o}\` must be used within \`${t}\``)}return[s,i]}function Cu(t,n=[]){let r=[];function s(o,l){const c=b.createContext(l),d=r.length;r=[...r,l];const u=m=>{var _;const{scope:g,children:y,...N}=m,j=((_=g==null?void 0:g[t])==null?void 0:_[d])||c,S=b.useMemo(()=>N,Object.values(N));return a.jsx(j.Provider,{value:S,children:y})};u.displayName=o+"Provider";function h(m,g){var j;const y=((j=g==null?void 0:g[t])==null?void 0:j[d])||c,N=b.useContext(y);if(N)return N;if(l!==void 0)return l;throw new Error(`\`${m}\` must be used within \`${o}\``)}return[u,h]}const i=()=>{const o=r.map(l=>b.createContext(l));return function(c){const d=(c==null?void 0:c[t])||o;return b.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return i.scopeName=t,[s,gde(i,...n)]}function gde(...t){const n=t[0];if(t.length===1)return n;const r=()=>{const s=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(o){const l=s.reduce((c,{useScope:d,scopeName:u})=>{const m=d(o)[`__scope${u}`];return{...c,...m}},{});return b.useMemo(()=>({[`__scope${n.scopeName}`]:l}),[l])}};return r.scopeName=n.scopeName,r}function NB(t){const n=t+"CollectionProvider",[r,s]=Cu(n),[i,o]=r(n,{collectionRef:{current:null},itemMap:new Map}),l=j=>{const{scope:S,children:_}=j,A=ze.useRef(null),k=ze.useRef(new Map).current;return a.jsx(i,{scope:S,itemMap:k,collectionRef:A,children:_})};l.displayName=n;const c=t+"CollectionSlot",d=Yf(c),u=ze.forwardRef((j,S)=>{const{scope:_,children:A}=j,k=o(c,_),T=vn(S,k.collectionRef);return a.jsx(d,{ref:T,children:A})});u.displayName=c;const h=t+"CollectionItemSlot",m="data-radix-collection-item",g=Yf(h),y=ze.forwardRef((j,S)=>{const{scope:_,children:A,...k}=j,T=ze.useRef(null),P=vn(S,T),M=o(h,_);return ze.useEffect(()=>(M.itemMap.set(T,{ref:T,...k}),()=>void M.itemMap.delete(T))),a.jsx(g,{[m]:"",ref:P,children:A})});y.displayName=h;function N(j){const S=o(t+"CollectionConsumer",j);return ze.useCallback(()=>{const A=S.collectionRef.current;if(!A)return[];const k=Array.from(A.querySelectorAll(`[${m}]`));return Array.from(S.itemMap.values()).sort((M,O)=>k.indexOf(M.ref.current)-k.indexOf(O.ref.current))},[S.collectionRef,S.itemMap])}return[{Provider:l,Slot:u,ItemSlot:y},N,s]}var yde=b.createContext(void 0);function _v(t){const n=b.useContext(yde);return t||n||"ltr"}var vde=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ht=vde.reduce((t,n)=>{const r=Yf(`Primitive.${n}`),s=b.forwardRef((i,o)=>{const{asChild:l,...c}=i,d=l?r:n;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),a.jsx(d,{...c,ref:o})});return s.displayName=`Primitive.${n}`,{...t,[n]:s}},{});function bde(t,n){t&&Vc.flushSync(()=>t.dispatchEvent(n))}function Us(t){const n=b.useRef(t);return b.useEffect(()=>{n.current=t}),b.useMemo(()=>(...r)=>{var s;return(s=n.current)==null?void 0:s.call(n,...r)},[])}function wde(t,n=globalThis==null?void 0:globalThis.document){const r=Us(t);b.useEffect(()=>{const s=i=>{i.key==="Escape"&&r(i)};return n.addEventListener("keydown",s,{capture:!0}),()=>n.removeEventListener("keydown",s,{capture:!0})},[r,n])}var Nde="DismissableLayer",uS="dismissableLayer.update",jde="dismissableLayer.pointerDownOutside",Sde="dismissableLayer.focusOutside",oP,jB=b.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),_A=b.forwardRef((t,n)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:o,onInteractOutside:l,onDismiss:c,...d}=t,u=b.useContext(jB),[h,m]=b.useState(null),g=(h==null?void 0:h.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,y]=b.useState({}),N=vn(n,O=>m(O)),j=Array.from(u.layers),[S]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),_=j.indexOf(S),A=h?j.indexOf(h):-1,k=u.layersWithOutsidePointerEventsDisabled.size>0,T=A>=_,P=Ade(O=>{const D=O.target,L=[...u.branches].some($=>$.contains(D));!T||L||(i==null||i(O),l==null||l(O),O.defaultPrevented||c==null||c())},g),M=Ede(O=>{const D=O.target;[...u.branches].some($=>$.contains(D))||(o==null||o(O),l==null||l(O),O.defaultPrevented||c==null||c())},g);return wde(O=>{A===u.layers.size-1&&(s==null||s(O),!O.defaultPrevented&&c&&(O.preventDefault(),c()))},g),b.useEffect(()=>{if(h)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(oP=g.body.style.pointerEvents,g.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(h)),u.layers.add(h),lP(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(g.body.style.pointerEvents=oP)}},[h,g,r,u]),b.useEffect(()=>()=>{h&&(u.layers.delete(h),u.layersWithOutsidePointerEventsDisabled.delete(h),lP())},[h,u]),b.useEffect(()=>{const O=()=>y({});return document.addEventListener(uS,O),()=>document.removeEventListener(uS,O)},[]),a.jsx(Ht.div,{...d,ref:N,style:{pointerEvents:k?T?"auto":"none":void 0,...t.style},onFocusCapture:Lt(t.onFocusCapture,M.onFocusCapture),onBlurCapture:Lt(t.onBlurCapture,M.onBlurCapture),onPointerDownCapture:Lt(t.onPointerDownCapture,P.onPointerDownCapture)})});_A.displayName=Nde;var Cde="DismissableLayerBranch",_de=b.forwardRef((t,n)=>{const r=b.useContext(jB),s=b.useRef(null),i=vn(n,s);return b.useEffect(()=>{const o=s.current;if(o)return r.branches.add(o),()=>{r.branches.delete(o)}},[r.branches]),a.jsx(Ht.div,{...t,ref:i})});_de.displayName=Cde;function Ade(t,n=globalThis==null?void 0:globalThis.document){const r=Us(t),s=b.useRef(!1),i=b.useRef(()=>{});return b.useEffect(()=>{const o=c=>{if(c.target&&!s.current){let d=function(){SB(jde,r,u,{discrete:!0})};const u={originalEvent:c};c.pointerType==="touch"?(n.removeEventListener("click",i.current),i.current=d,n.addEventListener("click",i.current,{once:!0})):d()}else n.removeEventListener("click",i.current);s.current=!1},l=window.setTimeout(()=>{n.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(l),n.removeEventListener("pointerdown",o),n.removeEventListener("click",i.current)}},[n,r]),{onPointerDownCapture:()=>s.current=!0}}function Ede(t,n=globalThis==null?void 0:globalThis.document){const r=Us(t),s=b.useRef(!1);return b.useEffect(()=>{const i=o=>{o.target&&!s.current&&SB(Sde,r,{originalEvent:o},{discrete:!1})};return n.addEventListener("focusin",i),()=>n.removeEventListener("focusin",i)},[n,r]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function lP(){const t=new CustomEvent(uS);document.dispatchEvent(t)}function SB(t,n,r,{discrete:s}){const i=r.originalEvent.target,o=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});n&&i.addEventListener(t,n,{once:!0}),s?bde(i,o):i.dispatchEvent(o)}var gN=0;function CB(){b.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??cP()),document.body.insertAdjacentElement("beforeend",t[1]??cP()),gN++,()=>{gN===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(n=>n.remove()),gN--}},[])}function cP(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var yN="focusScope.autoFocusOnMount",vN="focusScope.autoFocusOnUnmount",dP={bubbles:!1,cancelable:!0},kde="FocusScope",AA=b.forwardRef((t,n)=>{const{loop:r=!1,trapped:s=!1,onMountAutoFocus:i,onUnmountAutoFocus:o,...l}=t,[c,d]=b.useState(null),u=Us(i),h=Us(o),m=b.useRef(null),g=vn(n,j=>d(j)),y=b.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;b.useEffect(()=>{if(s){let j=function(k){if(y.paused||!c)return;const T=k.target;c.contains(T)?m.current=T:Kl(m.current,{select:!0})},S=function(k){if(y.paused||!c)return;const T=k.relatedTarget;T!==null&&(c.contains(T)||Kl(m.current,{select:!0}))},_=function(k){if(document.activeElement===document.body)for(const P of k)P.removedNodes.length>0&&Kl(c)};document.addEventListener("focusin",j),document.addEventListener("focusout",S);const A=new MutationObserver(_);return c&&A.observe(c,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",j),document.removeEventListener("focusout",S),A.disconnect()}}},[s,c,y.paused]),b.useEffect(()=>{if(c){fP.add(y);const j=document.activeElement;if(!c.contains(j)){const _=new CustomEvent(yN,dP);c.addEventListener(yN,u),c.dispatchEvent(_),_.defaultPrevented||(Tde(Dde(_B(c)),{select:!0}),document.activeElement===j&&Kl(c))}return()=>{c.removeEventListener(yN,u),setTimeout(()=>{const _=new CustomEvent(vN,dP);c.addEventListener(vN,h),c.dispatchEvent(_),_.defaultPrevented||Kl(j??document.body,{select:!0}),c.removeEventListener(vN,h),fP.remove(y)},0)}}},[c,u,h,y]);const N=b.useCallback(j=>{if(!r&&!s||y.paused)return;const S=j.key==="Tab"&&!j.altKey&&!j.ctrlKey&&!j.metaKey,_=document.activeElement;if(S&&_){const A=j.currentTarget,[k,T]=Ide(A);k&&T?!j.shiftKey&&_===T?(j.preventDefault(),r&&Kl(k,{select:!0})):j.shiftKey&&_===k&&(j.preventDefault(),r&&Kl(T,{select:!0})):_===A&&j.preventDefault()}},[r,s,y.paused]);return a.jsx(Ht.div,{tabIndex:-1,...l,ref:g,onKeyDown:N})});AA.displayName=kde;function Tde(t,{select:n=!1}={}){const r=document.activeElement;for(const s of t)if(Kl(s,{select:n}),document.activeElement!==r)return}function Ide(t){const n=_B(t),r=uP(n,t),s=uP(n.reverse(),t);return[r,s]}function _B(t){const n=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const i=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||i?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)n.push(r.currentNode);return n}function uP(t,n){for(const r of t)if(!Pde(r,{upTo:n}))return r}function Pde(t,{upTo:n}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(n!==void 0&&t===n)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function Mde(t){return t instanceof HTMLInputElement&&"select"in t}function Kl(t,{select:n=!1}={}){if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),t!==r&&Mde(t)&&n&&t.select()}}var fP=Ode();function Ode(){let t=[];return{add(n){const r=t[0];n!==r&&(r==null||r.pause()),t=hP(t,n),t.unshift(n)},remove(n){var r;t=hP(t,n),(r=t[0])==null||r.resume()}}}function hP(t,n){const r=[...t],s=r.indexOf(n);return s!==-1&&r.splice(s,1),r}function Dde(t){return t.filter(n=>n.tagName!=="A")}var vs=globalThis!=null&&globalThis.document?b.useLayoutEffect:()=>{},Rde=Hy[" useId ".trim().toString()]||(()=>{}),Lde=0;function Nc(t){const[n,r]=b.useState(Rde());return vs(()=>{r(s=>s??String(Lde++))},[t]),n?`radix-${n}`:""}const Bde=["top","right","bottom","left"],Oc=Math.min,Ca=Math.max,E1=Math.round,N0=Math.floor,wo=t=>({x:t,y:t}),Fde={left:"right",right:"left",bottom:"top",top:"bottom"},$de={start:"end",end:"start"};function fS(t,n,r){return Ca(t,Oc(n,r))}function pl(t,n){return typeof t=="function"?t(n):t}function xl(t){return t.split("-")[0]}function jh(t){return t.split("-")[1]}function EA(t){return t==="x"?"y":"x"}function kA(t){return t==="y"?"height":"width"}const zde=new Set(["top","bottom"]);function mo(t){return zde.has(xl(t))?"y":"x"}function TA(t){return EA(mo(t))}function Ude(t,n,r){r===void 0&&(r=!1);const s=jh(t),i=TA(t),o=kA(i);let l=i==="x"?s===(r?"end":"start")?"right":"left":s==="start"?"bottom":"top";return n.reference[o]>n.floating[o]&&(l=k1(l)),[l,k1(l)]}function Vde(t){const n=k1(t);return[hS(t),n,hS(n)]}function hS(t){return t.replace(/start|end/g,n=>$de[n])}const mP=["left","right"],pP=["right","left"],Hde=["top","bottom"],Wde=["bottom","top"];function qde(t,n,r){switch(t){case"top":case"bottom":return r?n?pP:mP:n?mP:pP;case"left":case"right":return n?Hde:Wde;default:return[]}}function Gde(t,n,r,s){const i=jh(t);let o=qde(xl(t),r==="start",s);return i&&(o=o.map(l=>l+"-"+i),n&&(o=o.concat(o.map(hS)))),o}function k1(t){return t.replace(/left|right|bottom|top/g,n=>Fde[n])}function Kde(t){return{top:0,right:0,bottom:0,left:0,...t}}function AB(t){return typeof t!="number"?Kde(t):{top:t,right:t,bottom:t,left:t}}function T1(t){const{x:n,y:r,width:s,height:i}=t;return{width:s,height:i,top:r,left:n,right:n+s,bottom:r+i,x:n,y:r}}function xP(t,n,r){let{reference:s,floating:i}=t;const o=mo(n),l=TA(n),c=kA(l),d=xl(n),u=o==="y",h=s.x+s.width/2-i.width/2,m=s.y+s.height/2-i.height/2,g=s[c]/2-i[c]/2;let y;switch(d){case"top":y={x:h,y:s.y-i.height};break;case"bottom":y={x:h,y:s.y+s.height};break;case"right":y={x:s.x+s.width,y:m};break;case"left":y={x:s.x-i.width,y:m};break;default:y={x:s.x,y:s.y}}switch(jh(n)){case"start":y[l]-=g*(r&&u?-1:1);break;case"end":y[l]+=g*(r&&u?-1:1);break}return y}const Yde=async(t,n,r)=>{const{placement:s="bottom",strategy:i="absolute",middleware:o=[],platform:l}=r,c=o.filter(Boolean),d=await(l.isRTL==null?void 0:l.isRTL(n));let u=await l.getElementRects({reference:t,floating:n,strategy:i}),{x:h,y:m}=xP(u,s,d),g=s,y={},N=0;for(let j=0;j<c.length;j++){const{name:S,fn:_}=c[j],{x:A,y:k,data:T,reset:P}=await _({x:h,y:m,initialPlacement:s,placement:g,strategy:i,middlewareData:y,rects:u,platform:l,elements:{reference:t,floating:n}});h=A??h,m=k??m,y={...y,[S]:{...y[S],...T}},P&&N<=50&&(N++,typeof P=="object"&&(P.placement&&(g=P.placement),P.rects&&(u=P.rects===!0?await l.getElementRects({reference:t,floating:n,strategy:i}):P.rects),{x:h,y:m}=xP(u,g,d)),j=-1)}return{x:h,y:m,placement:g,strategy:i,middlewareData:y}};async function Ep(t,n){var r;n===void 0&&(n={});const{x:s,y:i,platform:o,rects:l,elements:c,strategy:d}=t,{boundary:u="clippingAncestors",rootBoundary:h="viewport",elementContext:m="floating",altBoundary:g=!1,padding:y=0}=pl(n,t),N=AB(y),S=c[g?m==="floating"?"reference":"floating":m],_=T1(await o.getClippingRect({element:(r=await(o.isElement==null?void 0:o.isElement(S)))==null||r?S:S.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(c.floating)),boundary:u,rootBoundary:h,strategy:d})),A=m==="floating"?{x:s,y:i,width:l.floating.width,height:l.floating.height}:l.reference,k=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c.floating)),T=await(o.isElement==null?void 0:o.isElement(k))?await(o.getScale==null?void 0:o.getScale(k))||{x:1,y:1}:{x:1,y:1},P=T1(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:A,offsetParent:k,strategy:d}):A);return{top:(_.top-P.top+N.top)/T.y,bottom:(P.bottom-_.bottom+N.bottom)/T.y,left:(_.left-P.left+N.left)/T.x,right:(P.right-_.right+N.right)/T.x}}const Xde=t=>({name:"arrow",options:t,async fn(n){const{x:r,y:s,placement:i,rects:o,platform:l,elements:c,middlewareData:d}=n,{element:u,padding:h=0}=pl(t,n)||{};if(u==null)return{};const m=AB(h),g={x:r,y:s},y=TA(i),N=kA(y),j=await l.getDimensions(u),S=y==="y",_=S?"top":"left",A=S?"bottom":"right",k=S?"clientHeight":"clientWidth",T=o.reference[N]+o.reference[y]-g[y]-o.floating[N],P=g[y]-o.reference[y],M=await(l.getOffsetParent==null?void 0:l.getOffsetParent(u));let O=M?M[k]:0;(!O||!await(l.isElement==null?void 0:l.isElement(M)))&&(O=c.floating[k]||o.floating[N]);const D=T/2-P/2,L=O/2-j[N]/2-1,$=Oc(m[_],L),V=Oc(m[A],L),F=$,Q=O-j[N]-V,U=O/2-j[N]/2+D,z=fS(F,U,Q),q=!d.arrow&&jh(i)!=null&&U!==z&&o.reference[N]/2-(U<F?$:V)-j[N]/2<0,K=q?U<F?U-F:U-Q:0;return{[y]:g[y]+K,data:{[y]:z,centerOffset:U-z-K,...q&&{alignmentOffset:K}},reset:q}}}),Qde=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(n){var r,s;const{placement:i,middlewareData:o,rects:l,initialPlacement:c,platform:d,elements:u}=n,{mainAxis:h=!0,crossAxis:m=!0,fallbackPlacements:g,fallbackStrategy:y="bestFit",fallbackAxisSideDirection:N="none",flipAlignment:j=!0,...S}=pl(t,n);if((r=o.arrow)!=null&&r.alignmentOffset)return{};const _=xl(i),A=mo(c),k=xl(c)===c,T=await(d.isRTL==null?void 0:d.isRTL(u.floating)),P=g||(k||!j?[k1(c)]:Vde(c)),M=N!=="none";!g&&M&&P.push(...Gde(c,j,N,T));const O=[c,...P],D=await Ep(n,S),L=[];let $=((s=o.flip)==null?void 0:s.overflows)||[];if(h&&L.push(D[_]),m){const U=Ude(i,l,T);L.push(D[U[0]],D[U[1]])}if($=[...$,{placement:i,overflows:L}],!L.every(U=>U<=0)){var V,F;const U=(((V=o.flip)==null?void 0:V.index)||0)+1,z=O[U];if(z&&(!(m==="alignment"?A!==mo(z):!1)||$.every(X=>mo(X.placement)===A?X.overflows[0]>0:!0)))return{data:{index:U,overflows:$},reset:{placement:z}};let q=(F=$.filter(K=>K.overflows[0]<=0).sort((K,X)=>K.overflows[1]-X.overflows[1])[0])==null?void 0:F.placement;if(!q)switch(y){case"bestFit":{var Q;const K=(Q=$.filter(X=>{if(M){const J=mo(X.placement);return J===A||J==="y"}return!0}).map(X=>[X.placement,X.overflows.filter(J=>J>0).reduce((J,ne)=>J+ne,0)]).sort((X,J)=>X[1]-J[1])[0])==null?void 0:Q[0];K&&(q=K);break}case"initialPlacement":q=c;break}if(i!==q)return{reset:{placement:q}}}return{}}}};function gP(t,n){return{top:t.top-n.height,right:t.right-n.width,bottom:t.bottom-n.height,left:t.left-n.width}}function yP(t){return Bde.some(n=>t[n]>=0)}const Zde=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(n){const{rects:r}=n,{strategy:s="referenceHidden",...i}=pl(t,n);switch(s){case"referenceHidden":{const o=await Ep(n,{...i,elementContext:"reference"}),l=gP(o,r.reference);return{data:{referenceHiddenOffsets:l,referenceHidden:yP(l)}}}case"escaped":{const o=await Ep(n,{...i,altBoundary:!0}),l=gP(o,r.floating);return{data:{escapedOffsets:l,escaped:yP(l)}}}default:return{}}}}},EB=new Set(["left","top"]);async function Jde(t,n){const{placement:r,platform:s,elements:i}=t,o=await(s.isRTL==null?void 0:s.isRTL(i.floating)),l=xl(r),c=jh(r),d=mo(r)==="y",u=EB.has(l)?-1:1,h=o&&d?-1:1,m=pl(n,t);let{mainAxis:g,crossAxis:y,alignmentAxis:N}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return c&&typeof N=="number"&&(y=c==="end"?N*-1:N),d?{x:y*h,y:g*u}:{x:g*u,y:y*h}}const eue=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(n){var r,s;const{x:i,y:o,placement:l,middlewareData:c}=n,d=await Jde(n,t);return l===((r=c.offset)==null?void 0:r.placement)&&(s=c.arrow)!=null&&s.alignmentOffset?{}:{x:i+d.x,y:o+d.y,data:{...d,placement:l}}}}},tue=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(n){const{x:r,y:s,placement:i}=n,{mainAxis:o=!0,crossAxis:l=!1,limiter:c={fn:S=>{let{x:_,y:A}=S;return{x:_,y:A}}},...d}=pl(t,n),u={x:r,y:s},h=await Ep(n,d),m=mo(xl(i)),g=EA(m);let y=u[g],N=u[m];if(o){const S=g==="y"?"top":"left",_=g==="y"?"bottom":"right",A=y+h[S],k=y-h[_];y=fS(A,y,k)}if(l){const S=m==="y"?"top":"left",_=m==="y"?"bottom":"right",A=N+h[S],k=N-h[_];N=fS(A,N,k)}const j=c.fn({...n,[g]:y,[m]:N});return{...j,data:{x:j.x-r,y:j.y-s,enabled:{[g]:o,[m]:l}}}}}},nue=function(t){return t===void 0&&(t={}),{options:t,fn(n){const{x:r,y:s,placement:i,rects:o,middlewareData:l}=n,{offset:c=0,mainAxis:d=!0,crossAxis:u=!0}=pl(t,n),h={x:r,y:s},m=mo(i),g=EA(m);let y=h[g],N=h[m];const j=pl(c,n),S=typeof j=="number"?{mainAxis:j,crossAxis:0}:{mainAxis:0,crossAxis:0,...j};if(d){const k=g==="y"?"height":"width",T=o.reference[g]-o.floating[k]+S.mainAxis,P=o.reference[g]+o.reference[k]-S.mainAxis;y<T?y=T:y>P&&(y=P)}if(u){var _,A;const k=g==="y"?"width":"height",T=EB.has(xl(i)),P=o.reference[m]-o.floating[k]+(T&&((_=l.offset)==null?void 0:_[m])||0)+(T?0:S.crossAxis),M=o.reference[m]+o.reference[k]+(T?0:((A=l.offset)==null?void 0:A[m])||0)-(T?S.crossAxis:0);N<P?N=P:N>M&&(N=M)}return{[g]:y,[m]:N}}}},rue=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(n){var r,s;const{placement:i,rects:o,platform:l,elements:c}=n,{apply:d=()=>{},...u}=pl(t,n),h=await Ep(n,u),m=xl(i),g=jh(i),y=mo(i)==="y",{width:N,height:j}=o.floating;let S,_;m==="top"||m==="bottom"?(S=m,_=g===(await(l.isRTL==null?void 0:l.isRTL(c.floating))?"start":"end")?"left":"right"):(_=m,S=g==="end"?"top":"bottom");const A=j-h.top-h.bottom,k=N-h.left-h.right,T=Oc(j-h[S],A),P=Oc(N-h[_],k),M=!n.middlewareData.shift;let O=T,D=P;if((r=n.middlewareData.shift)!=null&&r.enabled.x&&(D=k),(s=n.middlewareData.shift)!=null&&s.enabled.y&&(O=A),M&&!g){const $=Ca(h.left,0),V=Ca(h.right,0),F=Ca(h.top,0),Q=Ca(h.bottom,0);y?D=N-2*($!==0||V!==0?$+V:Ca(h.left,h.right)):O=j-2*(F!==0||Q!==0?F+Q:Ca(h.top,h.bottom))}await d({...n,availableWidth:D,availableHeight:O});const L=await l.getDimensions(c.floating);return N!==L.width||j!==L.height?{reset:{rects:!0}}:{}}}};function Av(){return typeof window<"u"}function Sh(t){return kB(t)?(t.nodeName||"").toLowerCase():"#document"}function Ma(t){var n;return(t==null||(n=t.ownerDocument)==null?void 0:n.defaultView)||window}function Ro(t){var n;return(n=(kB(t)?t.ownerDocument:t.document)||window.document)==null?void 0:n.documentElement}function kB(t){return Av()?t instanceof Node||t instanceof Ma(t).Node:!1}function zi(t){return Av()?t instanceof Element||t instanceof Ma(t).Element:!1}function Eo(t){return Av()?t instanceof HTMLElement||t instanceof Ma(t).HTMLElement:!1}function vP(t){return!Av()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ma(t).ShadowRoot}const sue=new Set(["inline","contents"]);function xx(t){const{overflow:n,overflowX:r,overflowY:s,display:i}=Ui(t);return/auto|scroll|overlay|hidden|clip/.test(n+s+r)&&!sue.has(i)}const aue=new Set(["table","td","th"]);function iue(t){return aue.has(Sh(t))}const oue=[":popover-open",":modal"];function Ev(t){return oue.some(n=>{try{return t.matches(n)}catch{return!1}})}const lue=["transform","translate","scale","rotate","perspective"],cue=["transform","translate","scale","rotate","perspective","filter"],due=["paint","layout","strict","content"];function IA(t){const n=PA(),r=zi(t)?Ui(t):t;return lue.some(s=>r[s]?r[s]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!n&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!n&&(r.filter?r.filter!=="none":!1)||cue.some(s=>(r.willChange||"").includes(s))||due.some(s=>(r.contain||"").includes(s))}function uue(t){let n=Dc(t);for(;Eo(n)&&!Xf(n);){if(IA(n))return n;if(Ev(n))return null;n=Dc(n)}return null}function PA(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const fue=new Set(["html","body","#document"]);function Xf(t){return fue.has(Sh(t))}function Ui(t){return Ma(t).getComputedStyle(t)}function kv(t){return zi(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Dc(t){if(Sh(t)==="html")return t;const n=t.assignedSlot||t.parentNode||vP(t)&&t.host||Ro(t);return vP(n)?n.host:n}function TB(t){const n=Dc(t);return Xf(n)?t.ownerDocument?t.ownerDocument.body:t.body:Eo(n)&&xx(n)?n:TB(n)}function kp(t,n,r){var s;n===void 0&&(n=[]),r===void 0&&(r=!0);const i=TB(t),o=i===((s=t.ownerDocument)==null?void 0:s.body),l=Ma(i);if(o){const c=mS(l);return n.concat(l,l.visualViewport||[],xx(i)?i:[],c&&r?kp(c):[])}return n.concat(i,kp(i,[],r))}function mS(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function IB(t){const n=Ui(t);let r=parseFloat(n.width)||0,s=parseFloat(n.height)||0;const i=Eo(t),o=i?t.offsetWidth:r,l=i?t.offsetHeight:s,c=E1(r)!==o||E1(s)!==l;return c&&(r=o,s=l),{width:r,height:s,$:c}}function MA(t){return zi(t)?t:t.contextElement}function kf(t){const n=MA(t);if(!Eo(n))return wo(1);const r=n.getBoundingClientRect(),{width:s,height:i,$:o}=IB(n);let l=(o?E1(r.width):r.width)/s,c=(o?E1(r.height):r.height)/i;return(!l||!Number.isFinite(l))&&(l=1),(!c||!Number.isFinite(c))&&(c=1),{x:l,y:c}}const hue=wo(0);function PB(t){const n=Ma(t);return!PA()||!n.visualViewport?hue:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function mue(t,n,r){return n===void 0&&(n=!1),!r||n&&r!==Ma(t)?!1:n}function au(t,n,r,s){n===void 0&&(n=!1),r===void 0&&(r=!1);const i=t.getBoundingClientRect(),o=MA(t);let l=wo(1);n&&(s?zi(s)&&(l=kf(s)):l=kf(t));const c=mue(o,r,s)?PB(o):wo(0);let d=(i.left+c.x)/l.x,u=(i.top+c.y)/l.y,h=i.width/l.x,m=i.height/l.y;if(o){const g=Ma(o),y=s&&zi(s)?Ma(s):s;let N=g,j=mS(N);for(;j&&s&&y!==N;){const S=kf(j),_=j.getBoundingClientRect(),A=Ui(j),k=_.left+(j.clientLeft+parseFloat(A.paddingLeft))*S.x,T=_.top+(j.clientTop+parseFloat(A.paddingTop))*S.y;d*=S.x,u*=S.y,h*=S.x,m*=S.y,d+=k,u+=T,N=Ma(j),j=mS(N)}}return T1({width:h,height:m,x:d,y:u})}function Tv(t,n){const r=kv(t).scrollLeft;return n?n.left+r:au(Ro(t)).left+r}function MB(t,n){const r=t.getBoundingClientRect(),s=r.left+n.scrollLeft-Tv(t,r),i=r.top+n.scrollTop;return{x:s,y:i}}function pue(t){let{elements:n,rect:r,offsetParent:s,strategy:i}=t;const o=i==="fixed",l=Ro(s),c=n?Ev(n.floating):!1;if(s===l||c&&o)return r;let d={scrollLeft:0,scrollTop:0},u=wo(1);const h=wo(0),m=Eo(s);if((m||!m&&!o)&&((Sh(s)!=="body"||xx(l))&&(d=kv(s)),Eo(s))){const y=au(s);u=kf(s),h.x=y.x+s.clientLeft,h.y=y.y+s.clientTop}const g=l&&!m&&!o?MB(l,d):wo(0);return{width:r.width*u.x,height:r.height*u.y,x:r.x*u.x-d.scrollLeft*u.x+h.x+g.x,y:r.y*u.y-d.scrollTop*u.y+h.y+g.y}}function xue(t){return Array.from(t.getClientRects())}function gue(t){const n=Ro(t),r=kv(t),s=t.ownerDocument.body,i=Ca(n.scrollWidth,n.clientWidth,s.scrollWidth,s.clientWidth),o=Ca(n.scrollHeight,n.clientHeight,s.scrollHeight,s.clientHeight);let l=-r.scrollLeft+Tv(t);const c=-r.scrollTop;return Ui(s).direction==="rtl"&&(l+=Ca(n.clientWidth,s.clientWidth)-i),{width:i,height:o,x:l,y:c}}const bP=25;function yue(t,n){const r=Ma(t),s=Ro(t),i=r.visualViewport;let o=s.clientWidth,l=s.clientHeight,c=0,d=0;if(i){o=i.width,l=i.height;const h=PA();(!h||h&&n==="fixed")&&(c=i.offsetLeft,d=i.offsetTop)}const u=Tv(s);if(u<=0){const h=s.ownerDocument,m=h.body,g=getComputedStyle(m),y=h.compatMode==="CSS1Compat"&&parseFloat(g.marginLeft)+parseFloat(g.marginRight)||0,N=Math.abs(s.clientWidth-m.clientWidth-y);N<=bP&&(o-=N)}else u<=bP&&(o+=u);return{width:o,height:l,x:c,y:d}}const vue=new Set(["absolute","fixed"]);function bue(t,n){const r=au(t,!0,n==="fixed"),s=r.top+t.clientTop,i=r.left+t.clientLeft,o=Eo(t)?kf(t):wo(1),l=t.clientWidth*o.x,c=t.clientHeight*o.y,d=i*o.x,u=s*o.y;return{width:l,height:c,x:d,y:u}}function wP(t,n,r){let s;if(n==="viewport")s=yue(t,r);else if(n==="document")s=gue(Ro(t));else if(zi(n))s=bue(n,r);else{const i=PB(t);s={x:n.x-i.x,y:n.y-i.y,width:n.width,height:n.height}}return T1(s)}function OB(t,n){const r=Dc(t);return r===n||!zi(r)||Xf(r)?!1:Ui(r).position==="fixed"||OB(r,n)}function wue(t,n){const r=n.get(t);if(r)return r;let s=kp(t,[],!1).filter(c=>zi(c)&&Sh(c)!=="body"),i=null;const o=Ui(t).position==="fixed";let l=o?Dc(t):t;for(;zi(l)&&!Xf(l);){const c=Ui(l),d=IA(l);!d&&c.position==="fixed"&&(i=null),(o?!d&&!i:!d&&c.position==="static"&&!!i&&vue.has(i.position)||xx(l)&&!d&&OB(t,l))?s=s.filter(h=>h!==l):i=c,l=Dc(l)}return n.set(t,s),s}function Nue(t){let{element:n,boundary:r,rootBoundary:s,strategy:i}=t;const l=[...r==="clippingAncestors"?Ev(n)?[]:wue(n,this._c):[].concat(r),s],c=l[0],d=l.reduce((u,h)=>{const m=wP(n,h,i);return u.top=Ca(m.top,u.top),u.right=Oc(m.right,u.right),u.bottom=Oc(m.bottom,u.bottom),u.left=Ca(m.left,u.left),u},wP(n,c,i));return{width:d.right-d.left,height:d.bottom-d.top,x:d.left,y:d.top}}function jue(t){const{width:n,height:r}=IB(t);return{width:n,height:r}}function Sue(t,n,r){const s=Eo(n),i=Ro(n),o=r==="fixed",l=au(t,!0,o,n);let c={scrollLeft:0,scrollTop:0};const d=wo(0);function u(){d.x=Tv(i)}if(s||!s&&!o)if((Sh(n)!=="body"||xx(i))&&(c=kv(n)),s){const y=au(n,!0,o,n);d.x=y.x+n.clientLeft,d.y=y.y+n.clientTop}else i&&u();o&&!s&&i&&u();const h=i&&!s&&!o?MB(i,c):wo(0),m=l.left+c.scrollLeft-d.x-h.x,g=l.top+c.scrollTop-d.y-h.y;return{x:m,y:g,width:l.width,height:l.height}}function bN(t){return Ui(t).position==="static"}function NP(t,n){if(!Eo(t)||Ui(t).position==="fixed")return null;if(n)return n(t);let r=t.offsetParent;return Ro(t)===r&&(r=r.ownerDocument.body),r}function DB(t,n){const r=Ma(t);if(Ev(t))return r;if(!Eo(t)){let i=Dc(t);for(;i&&!Xf(i);){if(zi(i)&&!bN(i))return i;i=Dc(i)}return r}let s=NP(t,n);for(;s&&iue(s)&&bN(s);)s=NP(s,n);return s&&Xf(s)&&bN(s)&&!IA(s)?r:s||uue(t)||r}const Cue=async function(t){const n=this.getOffsetParent||DB,r=this.getDimensions,s=await r(t.floating);return{reference:Sue(t.reference,await n(t.floating),t.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function _ue(t){return Ui(t).direction==="rtl"}const Aue={convertOffsetParentRelativeRectToViewportRelativeRect:pue,getDocumentElement:Ro,getClippingRect:Nue,getOffsetParent:DB,getElementRects:Cue,getClientRects:xue,getDimensions:jue,getScale:kf,isElement:zi,isRTL:_ue};function RB(t,n){return t.x===n.x&&t.y===n.y&&t.width===n.width&&t.height===n.height}function Eue(t,n){let r=null,s;const i=Ro(t);function o(){var c;clearTimeout(s),(c=r)==null||c.disconnect(),r=null}function l(c,d){c===void 0&&(c=!1),d===void 0&&(d=1),o();const u=t.getBoundingClientRect(),{left:h,top:m,width:g,height:y}=u;if(c||n(),!g||!y)return;const N=N0(m),j=N0(i.clientWidth-(h+g)),S=N0(i.clientHeight-(m+y)),_=N0(h),k={rootMargin:-N+"px "+-j+"px "+-S+"px "+-_+"px",threshold:Ca(0,Oc(1,d))||1};let T=!0;function P(M){const O=M[0].intersectionRatio;if(O!==d){if(!T)return l();O?l(!1,O):s=setTimeout(()=>{l(!1,1e-7)},1e3)}O===1&&!RB(u,t.getBoundingClientRect())&&l(),T=!1}try{r=new IntersectionObserver(P,{...k,root:i.ownerDocument})}catch{r=new IntersectionObserver(P,k)}r.observe(t)}return l(!0),o}function kue(t,n,r,s){s===void 0&&(s={});const{ancestorScroll:i=!0,ancestorResize:o=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:d=!1}=s,u=MA(t),h=i||o?[...u?kp(u):[],...kp(n)]:[];h.forEach(_=>{i&&_.addEventListener("scroll",r,{passive:!0}),o&&_.addEventListener("resize",r)});const m=u&&c?Eue(u,r):null;let g=-1,y=null;l&&(y=new ResizeObserver(_=>{let[A]=_;A&&A.target===u&&y&&(y.unobserve(n),cancelAnimationFrame(g),g=requestAnimationFrame(()=>{var k;(k=y)==null||k.observe(n)})),r()}),u&&!d&&y.observe(u),y.observe(n));let N,j=d?au(t):null;d&&S();function S(){const _=au(t);j&&!RB(j,_)&&r(),j=_,N=requestAnimationFrame(S)}return r(),()=>{var _;h.forEach(A=>{i&&A.removeEventListener("scroll",r),o&&A.removeEventListener("resize",r)}),m==null||m(),(_=y)==null||_.disconnect(),y=null,d&&cancelAnimationFrame(N)}}const Tue=eue,Iue=tue,Pue=Qde,Mue=rue,Oue=Zde,jP=Xde,Due=nue,Rue=(t,n,r)=>{const s=new Map,i={platform:Aue,...r},o={...i.platform,_c:s};return Yde(t,n,{...i,platform:o})};var Lue=typeof document<"u",Bue=function(){},_g=Lue?b.useLayoutEffect:Bue;function I1(t,n){if(t===n)return!0;if(typeof t!=typeof n)return!1;if(typeof t=="function"&&t.toString()===n.toString())return!0;let r,s,i;if(t&&n&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==n.length)return!1;for(s=r;s--!==0;)if(!I1(t[s],n[s]))return!1;return!0}if(i=Object.keys(t),r=i.length,r!==Object.keys(n).length)return!1;for(s=r;s--!==0;)if(!{}.hasOwnProperty.call(n,i[s]))return!1;for(s=r;s--!==0;){const o=i[s];if(!(o==="_owner"&&t.$$typeof)&&!I1(t[o],n[o]))return!1}return!0}return t!==t&&n!==n}function LB(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function SP(t,n){const r=LB(t);return Math.round(n*r)/r}function wN(t){const n=b.useRef(t);return _g(()=>{n.current=t}),n}function Fue(t){t===void 0&&(t={});const{placement:n="bottom",strategy:r="absolute",middleware:s=[],platform:i,elements:{reference:o,floating:l}={},transform:c=!0,whileElementsMounted:d,open:u}=t,[h,m]=b.useState({x:0,y:0,strategy:r,placement:n,middlewareData:{},isPositioned:!1}),[g,y]=b.useState(s);I1(g,s)||y(s);const[N,j]=b.useState(null),[S,_]=b.useState(null),A=b.useCallback(X=>{X!==M.current&&(M.current=X,j(X))},[]),k=b.useCallback(X=>{X!==O.current&&(O.current=X,_(X))},[]),T=o||N,P=l||S,M=b.useRef(null),O=b.useRef(null),D=b.useRef(h),L=d!=null,$=wN(d),V=wN(i),F=wN(u),Q=b.useCallback(()=>{if(!M.current||!O.current)return;const X={placement:n,strategy:r,middleware:g};V.current&&(X.platform=V.current),Rue(M.current,O.current,X).then(J=>{const ne={...J,isPositioned:F.current!==!1};U.current&&!I1(D.current,ne)&&(D.current=ne,Vc.flushSync(()=>{m(ne)}))})},[g,n,r,V,F]);_g(()=>{u===!1&&D.current.isPositioned&&(D.current.isPositioned=!1,m(X=>({...X,isPositioned:!1})))},[u]);const U=b.useRef(!1);_g(()=>(U.current=!0,()=>{U.current=!1}),[]),_g(()=>{if(T&&(M.current=T),P&&(O.current=P),T&&P){if($.current)return $.current(T,P,Q);Q()}},[T,P,Q,$,L]);const z=b.useMemo(()=>({reference:M,floating:O,setReference:A,setFloating:k}),[A,k]),q=b.useMemo(()=>({reference:T,floating:P}),[T,P]),K=b.useMemo(()=>{const X={position:r,left:0,top:0};if(!q.floating)return X;const J=SP(q.floating,h.x),ne=SP(q.floating,h.y);return c?{...X,transform:"translate("+J+"px, "+ne+"px)",...LB(q.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:J,top:ne}},[r,c,q.floating,h.x,h.y]);return b.useMemo(()=>({...h,update:Q,refs:z,elements:q,floatingStyles:K}),[h,Q,z,q,K])}const $ue=t=>{function n(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:t,fn(r){const{element:s,padding:i}=typeof t=="function"?t(r):t;return s&&n(s)?s.current!=null?jP({element:s.current,padding:i}).fn(r):{}:s?jP({element:s,padding:i}).fn(r):{}}}},zue=(t,n)=>({...Tue(t),options:[t,n]}),Uue=(t,n)=>({...Iue(t),options:[t,n]}),Vue=(t,n)=>({...Due(t),options:[t,n]}),Hue=(t,n)=>({...Pue(t),options:[t,n]}),Wue=(t,n)=>({...Mue(t),options:[t,n]}),que=(t,n)=>({...Oue(t),options:[t,n]}),Gue=(t,n)=>({...$ue(t),options:[t,n]});var Kue="Arrow",BB=b.forwardRef((t,n)=>{const{children:r,width:s=10,height:i=5,...o}=t;return a.jsx(Ht.svg,{...o,ref:n,width:s,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?r:a.jsx("polygon",{points:"0,0 30,0 15,10"})})});BB.displayName=Kue;var Yue=BB;function Xue(t){const[n,r]=b.useState(void 0);return vs(()=>{if(t){r({width:t.offsetWidth,height:t.offsetHeight});const s=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const o=i[0];let l,c;if("borderBoxSize"in o){const d=o.borderBoxSize,u=Array.isArray(d)?d[0]:d;l=u.inlineSize,c=u.blockSize}else l=t.offsetWidth,c=t.offsetHeight;r({width:l,height:c})});return s.observe(t,{box:"border-box"}),()=>s.unobserve(t)}else r(void 0)},[t]),n}var OA="Popper",[FB,$B]=Cu(OA),[Que,zB]=FB(OA),UB=t=>{const{__scopePopper:n,children:r}=t,[s,i]=b.useState(null);return a.jsx(Que,{scope:n,anchor:s,onAnchorChange:i,children:r})};UB.displayName=OA;var VB="PopperAnchor",HB=b.forwardRef((t,n)=>{const{__scopePopper:r,virtualRef:s,...i}=t,o=zB(VB,r),l=b.useRef(null),c=vn(n,l),d=b.useRef(null);return b.useEffect(()=>{const u=d.current;d.current=(s==null?void 0:s.current)||l.current,u!==d.current&&o.onAnchorChange(d.current)}),s?null:a.jsx(Ht.div,{...i,ref:c})});HB.displayName=VB;var DA="PopperContent",[Zue,Jue]=FB(DA),WB=b.forwardRef((t,n)=>{var we,Oe,ae,ie,pe,re;const{__scopePopper:r,side:s="bottom",sideOffset:i=0,align:o="center",alignOffset:l=0,arrowPadding:c=0,avoidCollisions:d=!0,collisionBoundary:u=[],collisionPadding:h=0,sticky:m="partial",hideWhenDetached:g=!1,updatePositionStrategy:y="optimized",onPlaced:N,...j}=t,S=zB(DA,r),[_,A]=b.useState(null),k=vn(n,We=>A(We)),[T,P]=b.useState(null),M=Xue(T),O=(M==null?void 0:M.width)??0,D=(M==null?void 0:M.height)??0,L=s+(o!=="center"?"-"+o:""),$=typeof h=="number"?h:{top:0,right:0,bottom:0,left:0,...h},V=Array.isArray(u)?u:[u],F=V.length>0,Q={padding:$,boundary:V.filter(tfe),altBoundary:F},{refs:U,floatingStyles:z,placement:q,isPositioned:K,middlewareData:X}=Fue({strategy:"fixed",placement:L,whileElementsMounted:(...We)=>kue(...We,{animationFrame:y==="always"}),elements:{reference:S.anchor},middleware:[zue({mainAxis:i+D,alignmentAxis:l}),d&&Uue({mainAxis:!0,crossAxis:!1,limiter:m==="partial"?Vue():void 0,...Q}),d&&Hue({...Q}),Wue({...Q,apply:({elements:We,rects:Je,availableWidth:St,availableHeight:wt})=>{const{width:ft,height:Ie}=Je.reference,qe=We.floating.style;qe.setProperty("--radix-popper-available-width",`${St}px`),qe.setProperty("--radix-popper-available-height",`${wt}px`),qe.setProperty("--radix-popper-anchor-width",`${ft}px`),qe.setProperty("--radix-popper-anchor-height",`${Ie}px`)}}),T&&Gue({element:T,padding:c}),nfe({arrowWidth:O,arrowHeight:D}),g&&que({strategy:"referenceHidden",...Q})]}),[J,ne]=KB(q),Se=Us(N);vs(()=>{K&&(Se==null||Se())},[K,Se]);const de=(we=X.arrow)==null?void 0:we.x,ye=(Oe=X.arrow)==null?void 0:Oe.y,be=((ae=X.arrow)==null?void 0:ae.centerOffset)!==0,[xe,_e]=b.useState();return vs(()=>{_&&_e(window.getComputedStyle(_).zIndex)},[_]),a.jsx("div",{ref:U.setFloating,"data-radix-popper-content-wrapper":"",style:{...z,transform:K?z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:xe,"--radix-popper-transform-origin":[(ie=X.transformOrigin)==null?void 0:ie.x,(pe=X.transformOrigin)==null?void 0:pe.y].join(" "),...((re=X.hide)==null?void 0:re.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:a.jsx(Zue,{scope:r,placedSide:J,onArrowChange:P,arrowX:de,arrowY:ye,shouldHideArrow:be,children:a.jsx(Ht.div,{"data-side":J,"data-align":ne,...j,ref:k,style:{...j.style,animation:K?void 0:"none"}})})})});WB.displayName=DA;var qB="PopperArrow",efe={top:"bottom",right:"left",bottom:"top",left:"right"},GB=b.forwardRef(function(n,r){const{__scopePopper:s,...i}=n,o=Jue(qB,s),l=efe[o.placedSide];return a.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[l]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:a.jsx(Yue,{...i,ref:r,style:{...i.style,display:"block"}})})});GB.displayName=qB;function tfe(t){return t!==null}var nfe=t=>({name:"transformOrigin",options:t,fn(n){var S,_,A;const{placement:r,rects:s,middlewareData:i}=n,l=((S=i.arrow)==null?void 0:S.centerOffset)!==0,c=l?0:t.arrowWidth,d=l?0:t.arrowHeight,[u,h]=KB(r),m={start:"0%",center:"50%",end:"100%"}[h],g=(((_=i.arrow)==null?void 0:_.x)??0)+c/2,y=(((A=i.arrow)==null?void 0:A.y)??0)+d/2;let N="",j="";return u==="bottom"?(N=l?m:`${g}px`,j=`${-d}px`):u==="top"?(N=l?m:`${g}px`,j=`${s.floating.height+d}px`):u==="right"?(N=`${-d}px`,j=l?m:`${y}px`):u==="left"&&(N=`${s.floating.width+d}px`,j=l?m:`${y}px`),{data:{x:N,y:j}}}});function KB(t){const[n,r="center"]=t.split("-");return[n,r]}var rfe=UB,sfe=HB,afe=WB,ife=GB,ofe="Portal",RA=b.forwardRef((t,n)=>{var c;const{container:r,...s}=t,[i,o]=b.useState(!1);vs(()=>o(!0),[]);const l=r||i&&((c=globalThis==null?void 0:globalThis.document)==null?void 0:c.body);return l?N6.createPortal(a.jsx(Ht.div,{...s,ref:n}),l):null});RA.displayName=ofe;var lfe=Hy[" useInsertionEffect ".trim().toString()]||vs;function Tp({prop:t,defaultProp:n,onChange:r=()=>{},caller:s}){const[i,o,l]=cfe({defaultProp:n,onChange:r}),c=t!==void 0,d=c?t:i;{const h=b.useRef(t!==void 0);b.useEffect(()=>{const m=h.current;m!==c&&console.warn(`${s} is changing from ${m?"controlled":"uncontrolled"} to ${c?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),h.current=c},[c,s])}const u=b.useCallback(h=>{var m;if(c){const g=dfe(h)?h(t):h;g!==t&&((m=l.current)==null||m.call(l,g))}else o(h)},[c,t,o,l]);return[d,u]}function cfe({defaultProp:t,onChange:n}){const[r,s]=b.useState(t),i=b.useRef(r),o=b.useRef(n);return lfe(()=>{o.current=n},[n]),b.useEffect(()=>{var l;i.current!==r&&((l=o.current)==null||l.call(o,r),i.current=r)},[r,i]),[r,s,o]}function dfe(t){return typeof t=="function"}function ufe(t){const n=b.useRef({value:t,previous:t});return b.useMemo(()=>(n.current.value!==t&&(n.current.previous=n.current.value,n.current.value=t),n.current.previous),[t])}var YB=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),ffe="VisuallyHidden",hfe=b.forwardRef((t,n)=>a.jsx(Ht.span,{...t,ref:n,style:{...YB,...t.style}}));hfe.displayName=ffe;var mfe=function(t){if(typeof document>"u")return null;var n=Array.isArray(t)?t[0]:t;return n.ownerDocument.body},Uu=new WeakMap,j0=new WeakMap,S0={},NN=0,XB=function(t){return t&&(t.host||XB(t.parentNode))},pfe=function(t,n){return n.map(function(r){if(t.contains(r))return r;var s=XB(r);return s&&t.contains(s)?s:(console.error("aria-hidden",r,"in not contained inside",t,". Doing nothing"),null)}).filter(function(r){return!!r})},xfe=function(t,n,r,s){var i=pfe(n,Array.isArray(t)?t:[t]);S0[r]||(S0[r]=new WeakMap);var o=S0[r],l=[],c=new Set,d=new Set(i),u=function(m){!m||c.has(m)||(c.add(m),u(m.parentNode))};i.forEach(u);var h=function(m){!m||d.has(m)||Array.prototype.forEach.call(m.children,function(g){if(c.has(g))h(g);else try{var y=g.getAttribute(s),N=y!==null&&y!=="false",j=(Uu.get(g)||0)+1,S=(o.get(g)||0)+1;Uu.set(g,j),o.set(g,S),l.push(g),j===1&&N&&j0.set(g,!0),S===1&&g.setAttribute(r,"true"),N||g.setAttribute(s,"true")}catch(_){console.error("aria-hidden: cannot operate on ",g,_)}})};return h(n),c.clear(),NN++,function(){l.forEach(function(m){var g=Uu.get(m)-1,y=o.get(m)-1;Uu.set(m,g),o.set(m,y),g||(j0.has(m)||m.removeAttribute(s),j0.delete(m)),y||m.removeAttribute(r)}),NN--,NN||(Uu=new WeakMap,Uu=new WeakMap,j0=new WeakMap,S0={})}},QB=function(t,n,r){r===void 0&&(r="data-aria-hidden");var s=Array.from(Array.isArray(t)?t:[t]),i=mfe(t);return i?(s.push.apply(s,Array.from(i.querySelectorAll("[aria-live], script"))),xfe(s,i,r,"aria-hidden")):function(){return null}},fo=function(){return fo=Object.assign||function(n){for(var r,s=1,i=arguments.length;s<i;s++){r=arguments[s];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])}return n},fo.apply(this,arguments)};function ZB(t,n){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&n.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(t);i<s.length;i++)n.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(t,s[i])&&(r[s[i]]=t[s[i]]);return r}function gfe(t,n,r){if(r||arguments.length===2)for(var s=0,i=n.length,o;s<i;s++)(o||!(s in n))&&(o||(o=Array.prototype.slice.call(n,0,s)),o[s]=n[s]);return t.concat(o||Array.prototype.slice.call(n))}var Ag="right-scroll-bar-position",Eg="width-before-scroll-bar",yfe="with-scroll-bars-hidden",vfe="--removed-body-scroll-bar-size";function jN(t,n){return typeof t=="function"?t(n):t&&(t.current=n),t}function bfe(t,n){var r=b.useState(function(){return{value:t,callback:n,facade:{get current(){return r.value},set current(s){var i=r.value;i!==s&&(r.value=s,r.callback(s,i))}}}})[0];return r.callback=n,r.facade}var wfe=typeof window<"u"?b.useLayoutEffect:b.useEffect,CP=new WeakMap;function Nfe(t,n){var r=bfe(null,function(s){return t.forEach(function(i){return jN(i,s)})});return wfe(function(){var s=CP.get(r);if(s){var i=new Set(s),o=new Set(t),l=r.current;i.forEach(function(c){o.has(c)||jN(c,null)}),o.forEach(function(c){i.has(c)||jN(c,l)})}CP.set(r,t)},[t]),r}function jfe(t){return t}function Sfe(t,n){n===void 0&&(n=jfe);var r=[],s=!1,i={read:function(){if(s)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:t},useMedium:function(o){var l=n(o,s);return r.push(l),function(){r=r.filter(function(c){return c!==l})}},assignSyncMedium:function(o){for(s=!0;r.length;){var l=r;r=[],l.forEach(o)}r={push:function(c){return o(c)},filter:function(){return r}}},assignMedium:function(o){s=!0;var l=[];if(r.length){var c=r;r=[],c.forEach(o),l=r}var d=function(){var h=l;l=[],h.forEach(o)},u=function(){return Promise.resolve().then(d)};u(),r={push:function(h){l.push(h),u()},filter:function(h){return l=l.filter(h),r}}}};return i}function Cfe(t){t===void 0&&(t={});var n=Sfe(null);return n.options=fo({async:!0,ssr:!1},t),n}var JB=function(t){var n=t.sideCar,r=ZB(t,["sideCar"]);if(!n)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var s=n.read();if(!s)throw new Error("Sidecar medium not found");return b.createElement(s,fo({},r))};JB.isSideCarExport=!0;function _fe(t,n){return t.useMedium(n),JB}var e9=Cfe(),SN=function(){},Iv=b.forwardRef(function(t,n){var r=b.useRef(null),s=b.useState({onScrollCapture:SN,onWheelCapture:SN,onTouchMoveCapture:SN}),i=s[0],o=s[1],l=t.forwardProps,c=t.children,d=t.className,u=t.removeScrollBar,h=t.enabled,m=t.shards,g=t.sideCar,y=t.noRelative,N=t.noIsolation,j=t.inert,S=t.allowPinchZoom,_=t.as,A=_===void 0?"div":_,k=t.gapMode,T=ZB(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),P=g,M=Nfe([r,n]),O=fo(fo({},T),i);return b.createElement(b.Fragment,null,h&&b.createElement(P,{sideCar:e9,removeScrollBar:u,shards:m,noRelative:y,noIsolation:N,inert:j,setCallbacks:o,allowPinchZoom:!!S,lockRef:r,gapMode:k}),l?b.cloneElement(b.Children.only(c),fo(fo({},O),{ref:M})):b.createElement(A,fo({},O,{className:d,ref:M}),c))});Iv.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Iv.classNames={fullWidth:Eg,zeroRight:Ag};var Afe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Efe(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var n=Afe();return n&&t.setAttribute("nonce",n),t}function kfe(t,n){t.styleSheet?t.styleSheet.cssText=n:t.appendChild(document.createTextNode(n))}function Tfe(t){var n=document.head||document.getElementsByTagName("head")[0];n.appendChild(t)}var Ife=function(){var t=0,n=null;return{add:function(r){t==0&&(n=Efe())&&(kfe(n,r),Tfe(n)),t++},remove:function(){t--,!t&&n&&(n.parentNode&&n.parentNode.removeChild(n),n=null)}}},Pfe=function(){var t=Ife();return function(n,r){b.useEffect(function(){return t.add(n),function(){t.remove()}},[n&&r])}},t9=function(){var t=Pfe(),n=function(r){var s=r.styles,i=r.dynamic;return t(s,i),null};return n},Mfe={left:0,top:0,right:0,gap:0},CN=function(t){return parseInt(t||"",10)||0},Ofe=function(t){var n=window.getComputedStyle(document.body),r=n[t==="padding"?"paddingLeft":"marginLeft"],s=n[t==="padding"?"paddingTop":"marginTop"],i=n[t==="padding"?"paddingRight":"marginRight"];return[CN(r),CN(s),CN(i)]},Dfe=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return Mfe;var n=Ofe(t),r=document.documentElement.clientWidth,s=window.innerWidth;return{left:n[0],top:n[1],right:n[2],gap:Math.max(0,s-r+n[2]-n[0])}},Rfe=t9(),Tf="data-scroll-locked",Lfe=function(t,n,r,s){var i=t.left,o=t.top,l=t.right,c=t.gap;return r===void 0&&(r="margin"),`
  .`.concat(yfe,` {
   overflow: hidden `).concat(s,`;
   padding-right: `).concat(c,"px ").concat(s,`;
  }
  body[`).concat(Tf,`] {
    overflow: hidden `).concat(s,`;
    overscroll-behavior: contain;
    `).concat([n&&"position: relative ".concat(s,";"),r==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(l,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(c,"px ").concat(s,`;
    `),r==="padding"&&"padding-right: ".concat(c,"px ").concat(s,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Ag,` {
    right: `).concat(c,"px ").concat(s,`;
  }
  
  .`).concat(Eg,` {
    margin-right: `).concat(c,"px ").concat(s,`;
  }
  
  .`).concat(Ag," .").concat(Ag,` {
    right: 0 `).concat(s,`;
  }
  
  .`).concat(Eg," .").concat(Eg,` {
    margin-right: 0 `).concat(s,`;
  }
  
  body[`).concat(Tf,`] {
    `).concat(vfe,": ").concat(c,`px;
  }
`)},_P=function(){var t=parseInt(document.body.getAttribute(Tf)||"0",10);return isFinite(t)?t:0},Bfe=function(){b.useEffect(function(){return document.body.setAttribute(Tf,(_P()+1).toString()),function(){var t=_P()-1;t<=0?document.body.removeAttribute(Tf):document.body.setAttribute(Tf,t.toString())}},[])},Ffe=function(t){var n=t.noRelative,r=t.noImportant,s=t.gapMode,i=s===void 0?"margin":s;Bfe();var o=b.useMemo(function(){return Dfe(i)},[i]);return b.createElement(Rfe,{styles:Lfe(o,!n,i,r?"":"!important")})},pS=!1;if(typeof window<"u")try{var C0=Object.defineProperty({},"passive",{get:function(){return pS=!0,!0}});window.addEventListener("test",C0,C0),window.removeEventListener("test",C0,C0)}catch{pS=!1}var Vu=pS?{passive:!1}:!1,$fe=function(t){return t.tagName==="TEXTAREA"},n9=function(t,n){if(!(t instanceof Element))return!1;var r=window.getComputedStyle(t);return r[n]!=="hidden"&&!(r.overflowY===r.overflowX&&!$fe(t)&&r[n]==="visible")},zfe=function(t){return n9(t,"overflowY")},Ufe=function(t){return n9(t,"overflowX")},AP=function(t,n){var r=n.ownerDocument,s=n;do{typeof ShadowRoot<"u"&&s instanceof ShadowRoot&&(s=s.host);var i=r9(t,s);if(i){var o=s9(t,s),l=o[1],c=o[2];if(l>c)return!0}s=s.parentNode}while(s&&s!==r.body);return!1},Vfe=function(t){var n=t.scrollTop,r=t.scrollHeight,s=t.clientHeight;return[n,r,s]},Hfe=function(t){var n=t.scrollLeft,r=t.scrollWidth,s=t.clientWidth;return[n,r,s]},r9=function(t,n){return t==="v"?zfe(n):Ufe(n)},s9=function(t,n){return t==="v"?Vfe(n):Hfe(n)},Wfe=function(t,n){return t==="h"&&n==="rtl"?-1:1},qfe=function(t,n,r,s,i){var o=Wfe(t,window.getComputedStyle(n).direction),l=o*s,c=r.target,d=n.contains(c),u=!1,h=l>0,m=0,g=0;do{if(!c)break;var y=s9(t,c),N=y[0],j=y[1],S=y[2],_=j-S-o*N;(N||_)&&r9(t,c)&&(m+=_,g+=N);var A=c.parentNode;c=A&&A.nodeType===Node.DOCUMENT_FRAGMENT_NODE?A.host:A}while(!d&&c!==document.body||d&&(n.contains(c)||n===c));return(h&&Math.abs(m)<1||!h&&Math.abs(g)<1)&&(u=!0),u},_0=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},EP=function(t){return[t.deltaX,t.deltaY]},kP=function(t){return t&&"current"in t?t.current:t},Gfe=function(t,n){return t[0]===n[0]&&t[1]===n[1]},Kfe=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},Yfe=0,Hu=[];function Xfe(t){var n=b.useRef([]),r=b.useRef([0,0]),s=b.useRef(),i=b.useState(Yfe++)[0],o=b.useState(t9)[0],l=b.useRef(t);b.useEffect(function(){l.current=t},[t]),b.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(i));var j=gfe([t.lockRef.current],(t.shards||[]).map(kP),!0).filter(Boolean);return j.forEach(function(S){return S.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),j.forEach(function(S){return S.classList.remove("allow-interactivity-".concat(i))})}}},[t.inert,t.lockRef.current,t.shards]);var c=b.useCallback(function(j,S){if("touches"in j&&j.touches.length===2||j.type==="wheel"&&j.ctrlKey)return!l.current.allowPinchZoom;var _=_0(j),A=r.current,k="deltaX"in j?j.deltaX:A[0]-_[0],T="deltaY"in j?j.deltaY:A[1]-_[1],P,M=j.target,O=Math.abs(k)>Math.abs(T)?"h":"v";if("touches"in j&&O==="h"&&M.type==="range")return!1;var D=AP(O,M);if(!D)return!0;if(D?P=O:(P=O==="v"?"h":"v",D=AP(O,M)),!D)return!1;if(!s.current&&"changedTouches"in j&&(k||T)&&(s.current=P),!P)return!0;var L=s.current||P;return qfe(L,S,j,L==="h"?k:T)},[]),d=b.useCallback(function(j){var S=j;if(!(!Hu.length||Hu[Hu.length-1]!==o)){var _="deltaY"in S?EP(S):_0(S),A=n.current.filter(function(P){return P.name===S.type&&(P.target===S.target||S.target===P.shadowParent)&&Gfe(P.delta,_)})[0];if(A&&A.should){S.cancelable&&S.preventDefault();return}if(!A){var k=(l.current.shards||[]).map(kP).filter(Boolean).filter(function(P){return P.contains(S.target)}),T=k.length>0?c(S,k[0]):!l.current.noIsolation;T&&S.cancelable&&S.preventDefault()}}},[]),u=b.useCallback(function(j,S,_,A){var k={name:j,delta:S,target:_,should:A,shadowParent:Qfe(_)};n.current.push(k),setTimeout(function(){n.current=n.current.filter(function(T){return T!==k})},1)},[]),h=b.useCallback(function(j){r.current=_0(j),s.current=void 0},[]),m=b.useCallback(function(j){u(j.type,EP(j),j.target,c(j,t.lockRef.current))},[]),g=b.useCallback(function(j){u(j.type,_0(j),j.target,c(j,t.lockRef.current))},[]);b.useEffect(function(){return Hu.push(o),t.setCallbacks({onScrollCapture:m,onWheelCapture:m,onTouchMoveCapture:g}),document.addEventListener("wheel",d,Vu),document.addEventListener("touchmove",d,Vu),document.addEventListener("touchstart",h,Vu),function(){Hu=Hu.filter(function(j){return j!==o}),document.removeEventListener("wheel",d,Vu),document.removeEventListener("touchmove",d,Vu),document.removeEventListener("touchstart",h,Vu)}},[]);var y=t.removeScrollBar,N=t.inert;return b.createElement(b.Fragment,null,N?b.createElement(o,{styles:Kfe(i)}):null,y?b.createElement(Ffe,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function Qfe(t){for(var n=null;t!==null;)t instanceof ShadowRoot&&(n=t.host,t=t.host),t=t.parentNode;return n}const Zfe=_fe(e9,Xfe);var LA=b.forwardRef(function(t,n){return b.createElement(Iv,fo({},t,{ref:n,sideCar:Zfe}))});LA.classNames=Iv.classNames;var Jfe=[" ","Enter","ArrowUp","ArrowDown"],ehe=[" ","Enter"],iu="Select",[Pv,Mv,the]=NB(iu),[Ch]=Cu(iu,[the,$B]),Ov=$B(),[nhe,Gc]=Ch(iu),[rhe,she]=Ch(iu),a9=t=>{const{__scopeSelect:n,children:r,open:s,defaultOpen:i,onOpenChange:o,value:l,defaultValue:c,onValueChange:d,dir:u,name:h,autoComplete:m,disabled:g,required:y,form:N}=t,j=Ov(n),[S,_]=b.useState(null),[A,k]=b.useState(null),[T,P]=b.useState(!1),M=_v(u),[O,D]=Tp({prop:s,defaultProp:i??!1,onChange:o,caller:iu}),[L,$]=Tp({prop:l,defaultProp:c,onChange:d,caller:iu}),V=b.useRef(null),F=S?N||!!S.closest("form"):!0,[Q,U]=b.useState(new Set),z=Array.from(Q).map(q=>q.props.value).join(";");return a.jsx(rfe,{...j,children:a.jsxs(nhe,{required:y,scope:n,trigger:S,onTriggerChange:_,valueNode:A,onValueNodeChange:k,valueNodeHasChildren:T,onValueNodeHasChildrenChange:P,contentId:Nc(),value:L,onValueChange:$,open:O,onOpenChange:D,dir:M,triggerPointerDownPosRef:V,disabled:g,children:[a.jsx(Pv.Provider,{scope:n,children:a.jsx(rhe,{scope:t.__scopeSelect,onNativeOptionAdd:b.useCallback(q=>{U(K=>new Set(K).add(q))},[]),onNativeOptionRemove:b.useCallback(q=>{U(K=>{const X=new Set(K);return X.delete(q),X})},[]),children:r})}),F?a.jsxs(k9,{"aria-hidden":!0,required:y,tabIndex:-1,name:h,autoComplete:m,value:L,onChange:q=>$(q.target.value),disabled:g,form:N,children:[L===void 0?a.jsx("option",{value:""}):null,Array.from(Q)]},z):null]})})};a9.displayName=iu;var i9="SelectTrigger",o9=b.forwardRef((t,n)=>{const{__scopeSelect:r,disabled:s=!1,...i}=t,o=Ov(r),l=Gc(i9,r),c=l.disabled||s,d=vn(n,l.onTriggerChange),u=Mv(r),h=b.useRef("touch"),[m,g,y]=I9(j=>{const S=u().filter(k=>!k.disabled),_=S.find(k=>k.value===l.value),A=P9(S,j,_);A!==void 0&&l.onValueChange(A.value)}),N=j=>{c||(l.onOpenChange(!0),y()),j&&(l.triggerPointerDownPosRef.current={x:Math.round(j.pageX),y:Math.round(j.pageY)})};return a.jsx(sfe,{asChild:!0,...o,children:a.jsx(Ht.button,{type:"button",role:"combobox","aria-controls":l.contentId,"aria-expanded":l.open,"aria-required":l.required,"aria-autocomplete":"none",dir:l.dir,"data-state":l.open?"open":"closed",disabled:c,"data-disabled":c?"":void 0,"data-placeholder":T9(l.value)?"":void 0,...i,ref:d,onClick:Lt(i.onClick,j=>{j.currentTarget.focus(),h.current!=="mouse"&&N(j)}),onPointerDown:Lt(i.onPointerDown,j=>{h.current=j.pointerType;const S=j.target;S.hasPointerCapture(j.pointerId)&&S.releasePointerCapture(j.pointerId),j.button===0&&j.ctrlKey===!1&&j.pointerType==="mouse"&&(N(j),j.preventDefault())}),onKeyDown:Lt(i.onKeyDown,j=>{const S=m.current!=="";!(j.ctrlKey||j.altKey||j.metaKey)&&j.key.length===1&&g(j.key),!(S&&j.key===" ")&&Jfe.includes(j.key)&&(N(),j.preventDefault())})})})});o9.displayName=i9;var l9="SelectValue",c9=b.forwardRef((t,n)=>{const{__scopeSelect:r,className:s,style:i,children:o,placeholder:l="",...c}=t,d=Gc(l9,r),{onValueNodeHasChildrenChange:u}=d,h=o!==void 0,m=vn(n,d.onValueNodeChange);return vs(()=>{u(h)},[u,h]),a.jsx(Ht.span,{...c,ref:m,style:{pointerEvents:"none"},children:T9(d.value)?a.jsx(a.Fragment,{children:l}):o})});c9.displayName=l9;var ahe="SelectIcon",d9=b.forwardRef((t,n)=>{const{__scopeSelect:r,children:s,...i}=t;return a.jsx(Ht.span,{"aria-hidden":!0,...i,ref:n,children:s||""})});d9.displayName=ahe;var ihe="SelectPortal",u9=t=>a.jsx(RA,{asChild:!0,...t});u9.displayName=ihe;var ou="SelectContent",f9=b.forwardRef((t,n)=>{const r=Gc(ou,t.__scopeSelect),[s,i]=b.useState();if(vs(()=>{i(new DocumentFragment)},[]),!r.open){const o=s;return o?Vc.createPortal(a.jsx(h9,{scope:t.__scopeSelect,children:a.jsx(Pv.Slot,{scope:t.__scopeSelect,children:a.jsx("div",{children:t.children})})}),o):null}return a.jsx(m9,{...t,ref:n})});f9.displayName=ou;var Ai=10,[h9,Kc]=Ch(ou),ohe="SelectContentImpl",lhe=Yf("SelectContent.RemoveScroll"),m9=b.forwardRef((t,n)=>{const{__scopeSelect:r,position:s="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:o,onPointerDownOutside:l,side:c,sideOffset:d,align:u,alignOffset:h,arrowPadding:m,collisionBoundary:g,collisionPadding:y,sticky:N,hideWhenDetached:j,avoidCollisions:S,..._}=t,A=Gc(ou,r),[k,T]=b.useState(null),[P,M]=b.useState(null),O=vn(n,we=>T(we)),[D,L]=b.useState(null),[$,V]=b.useState(null),F=Mv(r),[Q,U]=b.useState(!1),z=b.useRef(!1);b.useEffect(()=>{if(k)return QB(k)},[k]),CB();const q=b.useCallback(we=>{const[Oe,...ae]=F().map(re=>re.ref.current),[ie]=ae.slice(-1),pe=document.activeElement;for(const re of we)if(re===pe||(re==null||re.scrollIntoView({block:"nearest"}),re===Oe&&P&&(P.scrollTop=0),re===ie&&P&&(P.scrollTop=P.scrollHeight),re==null||re.focus(),document.activeElement!==pe))return},[F,P]),K=b.useCallback(()=>q([D,k]),[q,D,k]);b.useEffect(()=>{Q&&K()},[Q,K]);const{onOpenChange:X,triggerPointerDownPosRef:J}=A;b.useEffect(()=>{if(k){let we={x:0,y:0};const Oe=ie=>{var pe,re;we={x:Math.abs(Math.round(ie.pageX)-(((pe=J.current)==null?void 0:pe.x)??0)),y:Math.abs(Math.round(ie.pageY)-(((re=J.current)==null?void 0:re.y)??0))}},ae=ie=>{we.x<=10&&we.y<=10?ie.preventDefault():k.contains(ie.target)||X(!1),document.removeEventListener("pointermove",Oe),J.current=null};return J.current!==null&&(document.addEventListener("pointermove",Oe),document.addEventListener("pointerup",ae,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Oe),document.removeEventListener("pointerup",ae,{capture:!0})}}},[k,X,J]),b.useEffect(()=>{const we=()=>X(!1);return window.addEventListener("blur",we),window.addEventListener("resize",we),()=>{window.removeEventListener("blur",we),window.removeEventListener("resize",we)}},[X]);const[ne,Se]=I9(we=>{const Oe=F().filter(pe=>!pe.disabled),ae=Oe.find(pe=>pe.ref.current===document.activeElement),ie=P9(Oe,we,ae);ie&&setTimeout(()=>ie.ref.current.focus())}),de=b.useCallback((we,Oe,ae)=>{const ie=!z.current&&!ae;(A.value!==void 0&&A.value===Oe||ie)&&(L(we),ie&&(z.current=!0))},[A.value]),ye=b.useCallback(()=>k==null?void 0:k.focus(),[k]),be=b.useCallback((we,Oe,ae)=>{const ie=!z.current&&!ae;(A.value!==void 0&&A.value===Oe||ie)&&V(we)},[A.value]),xe=s==="popper"?xS:p9,_e=xe===xS?{side:c,sideOffset:d,align:u,alignOffset:h,arrowPadding:m,collisionBoundary:g,collisionPadding:y,sticky:N,hideWhenDetached:j,avoidCollisions:S}:{};return a.jsx(h9,{scope:r,content:k,viewport:P,onViewportChange:M,itemRefCallback:de,selectedItem:D,onItemLeave:ye,itemTextRefCallback:be,focusSelectedItem:K,selectedItemText:$,position:s,isPositioned:Q,searchRef:ne,children:a.jsx(LA,{as:lhe,allowPinchZoom:!0,children:a.jsx(AA,{asChild:!0,trapped:A.open,onMountAutoFocus:we=>{we.preventDefault()},onUnmountAutoFocus:Lt(i,we=>{var Oe;(Oe=A.trigger)==null||Oe.focus({preventScroll:!0}),we.preventDefault()}),children:a.jsx(_A,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:we=>we.preventDefault(),onDismiss:()=>A.onOpenChange(!1),children:a.jsx(xe,{role:"listbox",id:A.contentId,"data-state":A.open?"open":"closed",dir:A.dir,onContextMenu:we=>we.preventDefault(),..._,..._e,onPlaced:()=>U(!0),ref:O,style:{display:"flex",flexDirection:"column",outline:"none",..._.style},onKeyDown:Lt(_.onKeyDown,we=>{const Oe=we.ctrlKey||we.altKey||we.metaKey;if(we.key==="Tab"&&we.preventDefault(),!Oe&&we.key.length===1&&Se(we.key),["ArrowUp","ArrowDown","Home","End"].includes(we.key)){let ie=F().filter(pe=>!pe.disabled).map(pe=>pe.ref.current);if(["ArrowUp","End"].includes(we.key)&&(ie=ie.slice().reverse()),["ArrowUp","ArrowDown"].includes(we.key)){const pe=we.target,re=ie.indexOf(pe);ie=ie.slice(re+1)}setTimeout(()=>q(ie)),we.preventDefault()}})})})})})})});m9.displayName=ohe;var che="SelectItemAlignedPosition",p9=b.forwardRef((t,n)=>{const{__scopeSelect:r,onPlaced:s,...i}=t,o=Gc(ou,r),l=Kc(ou,r),[c,d]=b.useState(null),[u,h]=b.useState(null),m=vn(n,O=>h(O)),g=Mv(r),y=b.useRef(!1),N=b.useRef(!0),{viewport:j,selectedItem:S,selectedItemText:_,focusSelectedItem:A}=l,k=b.useCallback(()=>{if(o.trigger&&o.valueNode&&c&&u&&j&&S&&_){const O=o.trigger.getBoundingClientRect(),D=u.getBoundingClientRect(),L=o.valueNode.getBoundingClientRect(),$=_.getBoundingClientRect();if(o.dir!=="rtl"){const pe=$.left-D.left,re=L.left-pe,We=O.left-re,Je=O.width+We,St=Math.max(Je,D.width),wt=window.innerWidth-Ai,ft=dS(re,[Ai,Math.max(Ai,wt-St)]);c.style.minWidth=Je+"px",c.style.left=ft+"px"}else{const pe=D.right-$.right,re=window.innerWidth-L.right-pe,We=window.innerWidth-O.right-re,Je=O.width+We,St=Math.max(Je,D.width),wt=window.innerWidth-Ai,ft=dS(re,[Ai,Math.max(Ai,wt-St)]);c.style.minWidth=Je+"px",c.style.right=ft+"px"}const V=g(),F=window.innerHeight-Ai*2,Q=j.scrollHeight,U=window.getComputedStyle(u),z=parseInt(U.borderTopWidth,10),q=parseInt(U.paddingTop,10),K=parseInt(U.borderBottomWidth,10),X=parseInt(U.paddingBottom,10),J=z+q+Q+X+K,ne=Math.min(S.offsetHeight*5,J),Se=window.getComputedStyle(j),de=parseInt(Se.paddingTop,10),ye=parseInt(Se.paddingBottom,10),be=O.top+O.height/2-Ai,xe=F-be,_e=S.offsetHeight/2,we=S.offsetTop+_e,Oe=z+q+we,ae=J-Oe;if(Oe<=be){const pe=V.length>0&&S===V[V.length-1].ref.current;c.style.bottom="0px";const re=u.clientHeight-j.offsetTop-j.offsetHeight,We=Math.max(xe,_e+(pe?ye:0)+re+K),Je=Oe+We;c.style.height=Je+"px"}else{const pe=V.length>0&&S===V[0].ref.current;c.style.top="0px";const We=Math.max(be,z+j.offsetTop+(pe?de:0)+_e)+ae;c.style.height=We+"px",j.scrollTop=Oe-be+j.offsetTop}c.style.margin=`${Ai}px 0`,c.style.minHeight=ne+"px",c.style.maxHeight=F+"px",s==null||s(),requestAnimationFrame(()=>y.current=!0)}},[g,o.trigger,o.valueNode,c,u,j,S,_,o.dir,s]);vs(()=>k(),[k]);const[T,P]=b.useState();vs(()=>{u&&P(window.getComputedStyle(u).zIndex)},[u]);const M=b.useCallback(O=>{O&&N.current===!0&&(k(),A==null||A(),N.current=!1)},[k,A]);return a.jsx(uhe,{scope:r,contentWrapper:c,shouldExpandOnScrollRef:y,onScrollButtonChange:M,children:a.jsx("div",{ref:d,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:T},children:a.jsx(Ht.div,{...i,ref:m,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});p9.displayName=che;var dhe="SelectPopperPosition",xS=b.forwardRef((t,n)=>{const{__scopeSelect:r,align:s="start",collisionPadding:i=Ai,...o}=t,l=Ov(r);return a.jsx(afe,{...l,...o,ref:n,align:s,collisionPadding:i,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});xS.displayName=dhe;var[uhe,BA]=Ch(ou,{}),gS="SelectViewport",x9=b.forwardRef((t,n)=>{const{__scopeSelect:r,nonce:s,...i}=t,o=Kc(gS,r),l=BA(gS,r),c=vn(n,o.onViewportChange),d=b.useRef(0);return a.jsxs(a.Fragment,{children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),a.jsx(Pv.Slot,{scope:r,children:a.jsx(Ht.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:c,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:Lt(i.onScroll,u=>{const h=u.currentTarget,{contentWrapper:m,shouldExpandOnScrollRef:g}=l;if(g!=null&&g.current&&m){const y=Math.abs(d.current-h.scrollTop);if(y>0){const N=window.innerHeight-Ai*2,j=parseFloat(m.style.minHeight),S=parseFloat(m.style.height),_=Math.max(j,S);if(_<N){const A=_+y,k=Math.min(N,A),T=A-k;m.style.height=k+"px",m.style.bottom==="0px"&&(h.scrollTop=T>0?T:0,m.style.justifyContent="flex-end")}}}d.current=h.scrollTop})})})]})});x9.displayName=gS;var g9="SelectGroup",[fhe,hhe]=Ch(g9),mhe=b.forwardRef((t,n)=>{const{__scopeSelect:r,...s}=t,i=Nc();return a.jsx(fhe,{scope:r,id:i,children:a.jsx(Ht.div,{role:"group","aria-labelledby":i,...s,ref:n})})});mhe.displayName=g9;var y9="SelectLabel",v9=b.forwardRef((t,n)=>{const{__scopeSelect:r,...s}=t,i=hhe(y9,r);return a.jsx(Ht.div,{id:i.id,...s,ref:n})});v9.displayName=y9;var P1="SelectItem",[phe,b9]=Ch(P1),w9=b.forwardRef((t,n)=>{const{__scopeSelect:r,value:s,disabled:i=!1,textValue:o,...l}=t,c=Gc(P1,r),d=Kc(P1,r),u=c.value===s,[h,m]=b.useState(o??""),[g,y]=b.useState(!1),N=vn(n,A=>{var k;return(k=d.itemRefCallback)==null?void 0:k.call(d,A,s,i)}),j=Nc(),S=b.useRef("touch"),_=()=>{i||(c.onValueChange(s),c.onOpenChange(!1))};if(s==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return a.jsx(phe,{scope:r,value:s,disabled:i,textId:j,isSelected:u,onItemTextChange:b.useCallback(A=>{m(k=>k||((A==null?void 0:A.textContent)??"").trim())},[]),children:a.jsx(Pv.ItemSlot,{scope:r,value:s,disabled:i,textValue:h,children:a.jsx(Ht.div,{role:"option","aria-labelledby":j,"data-highlighted":g?"":void 0,"aria-selected":u&&g,"data-state":u?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...l,ref:N,onFocus:Lt(l.onFocus,()=>y(!0)),onBlur:Lt(l.onBlur,()=>y(!1)),onClick:Lt(l.onClick,()=>{S.current!=="mouse"&&_()}),onPointerUp:Lt(l.onPointerUp,()=>{S.current==="mouse"&&_()}),onPointerDown:Lt(l.onPointerDown,A=>{S.current=A.pointerType}),onPointerMove:Lt(l.onPointerMove,A=>{var k;S.current=A.pointerType,i?(k=d.onItemLeave)==null||k.call(d):S.current==="mouse"&&A.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Lt(l.onPointerLeave,A=>{var k;A.currentTarget===document.activeElement&&((k=d.onItemLeave)==null||k.call(d))}),onKeyDown:Lt(l.onKeyDown,A=>{var T;((T=d.searchRef)==null?void 0:T.current)!==""&&A.key===" "||(ehe.includes(A.key)&&_(),A.key===" "&&A.preventDefault())})})})})});w9.displayName=P1;var Am="SelectItemText",N9=b.forwardRef((t,n)=>{const{__scopeSelect:r,className:s,style:i,...o}=t,l=Gc(Am,r),c=Kc(Am,r),d=b9(Am,r),u=she(Am,r),[h,m]=b.useState(null),g=vn(n,_=>m(_),d.onItemTextChange,_=>{var A;return(A=c.itemTextRefCallback)==null?void 0:A.call(c,_,d.value,d.disabled)}),y=h==null?void 0:h.textContent,N=b.useMemo(()=>a.jsx("option",{value:d.value,disabled:d.disabled,children:y},d.value),[d.disabled,d.value,y]),{onNativeOptionAdd:j,onNativeOptionRemove:S}=u;return vs(()=>(j(N),()=>S(N)),[j,S,N]),a.jsxs(a.Fragment,{children:[a.jsx(Ht.span,{id:d.textId,...o,ref:g}),d.isSelected&&l.valueNode&&!l.valueNodeHasChildren?Vc.createPortal(o.children,l.valueNode):null]})});N9.displayName=Am;var j9="SelectItemIndicator",S9=b.forwardRef((t,n)=>{const{__scopeSelect:r,...s}=t;return b9(j9,r).isSelected?a.jsx(Ht.span,{"aria-hidden":!0,...s,ref:n}):null});S9.displayName=j9;var yS="SelectScrollUpButton",C9=b.forwardRef((t,n)=>{const r=Kc(yS,t.__scopeSelect),s=BA(yS,t.__scopeSelect),[i,o]=b.useState(!1),l=vn(n,s.onScrollButtonChange);return vs(()=>{if(r.viewport&&r.isPositioned){let c=function(){const u=d.scrollTop>0;o(u)};const d=r.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[r.viewport,r.isPositioned]),i?a.jsx(A9,{...t,ref:l,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=r;c&&d&&(c.scrollTop=c.scrollTop-d.offsetHeight)}}):null});C9.displayName=yS;var vS="SelectScrollDownButton",_9=b.forwardRef((t,n)=>{const r=Kc(vS,t.__scopeSelect),s=BA(vS,t.__scopeSelect),[i,o]=b.useState(!1),l=vn(n,s.onScrollButtonChange);return vs(()=>{if(r.viewport&&r.isPositioned){let c=function(){const u=d.scrollHeight-d.clientHeight,h=Math.ceil(d.scrollTop)<u;o(h)};const d=r.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[r.viewport,r.isPositioned]),i?a.jsx(A9,{...t,ref:l,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=r;c&&d&&(c.scrollTop=c.scrollTop+d.offsetHeight)}}):null});_9.displayName=vS;var A9=b.forwardRef((t,n)=>{const{__scopeSelect:r,onAutoScroll:s,...i}=t,o=Kc("SelectScrollButton",r),l=b.useRef(null),c=Mv(r),d=b.useCallback(()=>{l.current!==null&&(window.clearInterval(l.current),l.current=null)},[]);return b.useEffect(()=>()=>d(),[d]),vs(()=>{var h;const u=c().find(m=>m.ref.current===document.activeElement);(h=u==null?void 0:u.ref.current)==null||h.scrollIntoView({block:"nearest"})},[c]),a.jsx(Ht.div,{"aria-hidden":!0,...i,ref:n,style:{flexShrink:0,...i.style},onPointerDown:Lt(i.onPointerDown,()=>{l.current===null&&(l.current=window.setInterval(s,50))}),onPointerMove:Lt(i.onPointerMove,()=>{var u;(u=o.onItemLeave)==null||u.call(o),l.current===null&&(l.current=window.setInterval(s,50))}),onPointerLeave:Lt(i.onPointerLeave,()=>{d()})})}),xhe="SelectSeparator",E9=b.forwardRef((t,n)=>{const{__scopeSelect:r,...s}=t;return a.jsx(Ht.div,{"aria-hidden":!0,...s,ref:n})});E9.displayName=xhe;var bS="SelectArrow",ghe=b.forwardRef((t,n)=>{const{__scopeSelect:r,...s}=t,i=Ov(r),o=Gc(bS,r),l=Kc(bS,r);return o.open&&l.position==="popper"?a.jsx(ife,{...i,...s,ref:n}):null});ghe.displayName=bS;var yhe="SelectBubbleInput",k9=b.forwardRef(({__scopeSelect:t,value:n,...r},s)=>{const i=b.useRef(null),o=vn(s,i),l=ufe(n);return b.useEffect(()=>{const c=i.current;if(!c)return;const d=window.HTMLSelectElement.prototype,h=Object.getOwnPropertyDescriptor(d,"value").set;if(l!==n&&h){const m=new Event("change",{bubbles:!0});h.call(c,n),c.dispatchEvent(m)}},[l,n]),a.jsx(Ht.select,{...r,style:{...YB,...r.style},ref:o,defaultValue:n})});k9.displayName=yhe;function T9(t){return t===""||t===void 0}function I9(t){const n=Us(t),r=b.useRef(""),s=b.useRef(0),i=b.useCallback(l=>{const c=r.current+l;n(c),function d(u){r.current=u,window.clearTimeout(s.current),u!==""&&(s.current=window.setTimeout(()=>d(""),1e3))}(c)},[n]),o=b.useCallback(()=>{r.current="",window.clearTimeout(s.current)},[]);return b.useEffect(()=>()=>window.clearTimeout(s.current),[]),[r,i,o]}function P9(t,n,r){const i=n.length>1&&Array.from(n).every(u=>u===n[0])?n[0]:n,o=r?t.indexOf(r):-1;let l=vhe(t,Math.max(o,0));i.length===1&&(l=l.filter(u=>u!==r));const d=l.find(u=>u.textValue.toLowerCase().startsWith(i.toLowerCase()));return d!==r?d:void 0}function vhe(t,n){return t.map((r,s)=>t[(n+s)%t.length])}var bhe=a9,M9=o9,whe=c9,Nhe=d9,jhe=u9,O9=f9,She=x9,D9=v9,R9=w9,Che=N9,_he=S9,L9=C9,B9=_9,F9=E9;const Nn=bhe,jn=whe,gn=b.forwardRef(({className:t,children:n,...r},s)=>a.jsxs(M9,{ref:s,className:_t("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...r,children:[n,a.jsx(Nhe,{asChild:!0,children:a.jsx(z_,{className:"h-4 w-4 opacity-50"})})]}));gn.displayName=M9.displayName;const $9=b.forwardRef(({className:t,...n},r)=>a.jsx(L9,{ref:r,className:_t("flex cursor-default items-center justify-center py-1",t),...n,children:a.jsx(_ee,{className:"h-4 w-4"})}));$9.displayName=L9.displayName;const z9=b.forwardRef(({className:t,...n},r)=>a.jsx(B9,{ref:r,className:_t("flex cursor-default items-center justify-center py-1",t),...n,children:a.jsx(z_,{className:"h-4 w-4"})}));z9.displayName=B9.displayName;const yn=b.forwardRef(({className:t,children:n,position:r="popper",...s},i)=>a.jsx(jhe,{children:a.jsxs(O9,{ref:i,className:_t("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...s,children:[a.jsx($9,{}),a.jsx(She,{className:_t("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),a.jsx(z9,{})]})}));yn.displayName=O9.displayName;const Ahe=b.forwardRef(({className:t,...n},r)=>a.jsx(D9,{ref:r,className:_t("px-2 py-1.5 text-sm font-semibold",t),...n}));Ahe.displayName=D9.displayName;const gt=b.forwardRef(({className:t,children:n,...r},s)=>a.jsxs(R9,{ref:s,className:_t("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[a.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(_he,{children:a.jsx(pv,{className:"h-4 w-4"})})}),a.jsx(Che,{children:n})]}));gt.displayName=R9.displayName;const Ehe=b.forwardRef(({className:t,...n},r)=>a.jsx(F9,{ref:r,className:_t("-mx-1 my-1 h-px bg-muted",t),...n}));Ehe.displayName=F9.displayName;const khe=["0.5","1","1.5","2","3"],gf=[{code:"OD",label:"OD  1/day",timesPerDay:1},{code:"BD",label:"BD  2/day",timesPerDay:2},{code:"TDS",label:"TDS  3/day",timesPerDay:3},{code:"QID",label:"QID  4/day",timesPerDay:4},{code:"HS",label:"HS  at bedtime",timesPerDay:1},{code:"SOS",label:"SOS  as needed",timesPerDay:0}];let The=1;const U9=()=>`tmp-ipd-${The++}`;function wS(t,n,r){const s=Number(t)||0,i=Number(n)||0,o=Number(r)||0;return!s||!o?0:i===0?s*o:s*i*o}function TP(t){if(!t)return!1;const n=new Date(t);return Number.isNaN(n.getTime())?!1:(n-new Date)/(1e3*60*60*24)<=30}function Ihe(t){const n=gf.find(r=>r.code===t.frequency_code)||gf[1];return{tempId:U9(),id:t.id,item_id:t.item_id,item_name:t.item_name,strength:t.strength,item_type:t.item_type||"drug",dose:t.dose??1,frequency_code:n.code,frequency_label:n.label,times_per_day:t.times_per_day??n.timesPerDay,days:t.days??1,quantity:t.quantity??wS(t.dose??1,t.times_per_day??n.timesPerDay,t.days??1),available_qty:t.available_qty??null,expiry_date:t.expiry_date??null,notes:t.notes||""}}function Phe(t){const n=t.dose?`${t.dose}`:"",r=t.frequency_code||"",s=t.days?`${t.days} day(s)`:"",i=t.quantity?`Qty ${t.quantity}`:"",o=[n&&`${n}`,r,s].filter(Boolean).join("  "),l=[i,t.notes].filter(Boolean).join("  ");return[o,l].filter(Boolean).join("  ")}function Mhe({admissionId:t,admission:n,patient:r,canWrite:s}){const[i,o]=b.useState([]),[l,c]=b.useState(!1),[d,u]=b.useState(!1),[h,m]=b.useState(!1),[g,y]=b.useState(""),[N,j]=b.useState("all"),[S,_]=b.useState([]),[A,k]=b.useState(!1),T=(n==null?void 0:n.practitioner_user_id)||null,P=new Date().toLocaleDateString(),M=async()=>{if(t)try{c(!0);const{data:U}=await ude(t),z=(U==null?void 0:U.lines)||[];o(z.map(Ihe))}catch{o([])}finally{c(!1)}};b.useEffect(()=>{M()},[t]),b.useEffect(()=>{let U=!0;if(!g){_([]);return}return k(!0),dde({q:g,type:N}).then(z=>{U&&_(z.data||[])}).catch(()=>{U&&_([])}).finally(()=>{U&&k(!1)}),()=>{U=!1}},[g,N]);const O=U=>{const z=gf[1],q=1,K=1,X=wS(K,z.timesPerDay,q);o(J=>[...J,{tempId:U9(),id:U.rx_line_id||null,item_id:U.id,item_name:U.name,strength:U.strength||"",item_type:U.type||(N==="consumable"?"consumable":"drug"),dose:K,frequency_code:z.code,frequency_label:z.label,times_per_day:z.timesPerDay,days:q,quantity:X,available_qty:U.available_qty??null,expiry_date:U.expiry_date??null,notes:""}]),y(""),_([])},D=(U,z)=>{o(q=>q.map(K=>{if(K.tempId!==U)return K;const X={...K,...z},J=gf.find(ne=>ne.code===X.frequency_code)||gf[1];return X.times_per_day=J.timesPerDay,X.frequency_label=J.label,X.quantity=wS(X.dose,X.times_per_day,X.days),X}))},L=U=>{o(z=>z.filter(q=>q.tempId!==U))},$=b.useMemo(()=>i.map(U=>({id:U.id,item_id:U.item_id,dose:Number(U.dose)||0,frequency_code:U.frequency_code,times_per_day:U.times_per_day,days:Number(U.days)||0,quantity:Number(U.quantity)||0,notes:U.notes||"",item_type:U.item_type})),[i]),V=async()=>{if(t)try{u(!0),await fde(t,{consultant_user_id:T,lines:$}),fe.success("IPD pharmacy orders saved"),await M()}catch{}finally{u(!1)}},F=async()=>{if(t){if(!i.length){fe.error("Add at least one item");return}try{m(!0),await hde(t,{consultant_user_id:T,lines:$}),fe.success("Orders sent to Pharmacy"),await M()}catch{}finally{m(!1)}}},Q=r?`${r.first_name||""} ${r.last_name||""}`.trim():(n==null?void 0:n.patient_name)||"Patient";return a.jsxs(Re,{className:"border-none shadow-none",children:[a.jsxs(Ye,{className:"pb-2 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"inline-flex h-8 w-8 items-center justify-center rounded-xl bg-slate-900 text-white",children:a.jsx(gs,{className:"h-4 w-4"})}),a.jsxs("div",{children:[a.jsx(Ze,{className:"text-sm",children:"IPD Pharmacy Orders (Bed-side)"}),a.jsx("p",{className:"text-[11px] text-slate-500",children:"Ward orders (medicines & consumables) for this admission."})]})]}),a.jsxs("div",{className:"text-right text-[11px] text-slate-500",children:["Admission #",t," ",(n==null?void 0:n.current_bed_code)&&a.jsxs(a.Fragment,{children:[a.jsx("br",{}),a.jsx(Fd,{className:"inline h-3 w-3 mr-1"}),"Bed: ",n.current_bed_code]})]})]}),a.jsxs(Be,{className:"pt-0 space-y-3",children:[a.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx(ur,{className:"absolute left-2 top-2.5 h-4 w-4 text-slate-400"}),a.jsx(Ne,{placeholder:"Search medicine / consumable",className:"pl-7 h-9 w-48 sm:w-64",value:g,onChange:U=>y(U.target.value),disabled:!s})]}),a.jsxs(Nn,{value:N,onValueChange:j,disabled:!s,children:[a.jsx(gn,{className:"h-9 w-36 text-xs",children:a.jsx(jn,{placeholder:"Type"})}),a.jsxs(yn,{children:[a.jsx(gt,{value:"all",children:"All items"}),a.jsx(gt,{value:"drug",children:"Medicines only"}),a.jsx(gt,{value:"consumable",children:"Consumables only"})]})]})]}),a.jsxs("div",{className:"flex gap-2 text-[11px] text-slate-500",children:[a.jsxs(Ge,{variant:"outline",className:"h-5 px-2 text-[10px]",children:[i.length," item(s)"]}),l&&a.jsxs("span",{className:"inline-flex items-center gap-1",children:[a.jsx(dr,{className:"h-3 w-3 animate-spin"}),"Loading"]}),!s&&a.jsx("span",{className:"text-[10px] text-amber-700",children:"View only (no IPD doctor permission)"})]})]}),g&&a.jsxs("div",{className:"rounded-2xl border bg-slate-50/70 max-h-48 overflow-y-auto",children:[A&&a.jsxs("div",{className:"p-3 text-xs text-slate-500 flex items-center gap-2",children:[a.jsx(dr,{className:"h-3 w-3 animate-spin"}),"Searching"]}),!A&&S.length===0&&a.jsx("div",{className:"p-3 text-xs text-slate-500",children:"No matching items."}),!A&&S.map(U=>{const z=TP(U.expiry_date);return a.jsxs("button",{type:"button",disabled:!s,onClick:()=>O(U),className:"w-full px-3 py-2 text-left flex items-center justify-between hover:bg-slate-100/80 text-xs disabled:opacity-60",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-slate-800",children:U.name}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:[U.strength||""," "," ",U.type||"drug"]})]}),a.jsxs("div",{className:"text-right text-[11px] text-slate-500 space-y-1",children:[U.available_qty!=null&&a.jsxs("div",{children:["Avl: ",U.available_qty]}),z&&a.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full bg-amber-50 px-2 py-0.5 text-[10px] text-amber-700 border border-amber-100",children:[a.jsx(wc,{className:"h-3 w-3"}),"Near expiry"]})]})]},U.id)})]}),a.jsx("div",{className:"rounded-2xl border border-slate-100 overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-xs",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-slate-50 text-[11px] uppercase tracking-wide text-slate-500",children:[a.jsx("th",{className:"py-2 pl-3 pr-2 text-left font-medium",children:"Item"}),a.jsx("th",{className:"py-2 px-2 text-left font-medium",children:"Dose"}),a.jsx("th",{className:"py-2 px-2 text-left font-medium",children:"Frequency"}),a.jsx("th",{className:"py-2 px-2 text-left font-medium",children:"Days"}),a.jsx("th",{className:"py-2 px-2 text-right font-medium",children:"Qty"}),a.jsx("th",{className:"py-2 px-2 text-right font-medium",children:"Stock"}),a.jsx("th",{className:"py-2 px-2 text-right w-12"})]})}),a.jsxs("tbody",{children:[i.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"py-6 text-center text-[11px] text-slate-500",children:"No orders yet for this admission."})}),i.map(U=>{const z=TP(U.expiry_date),q=U.available_qty!=null&&Number(U.quantity)>Number(U.available_qty);return a.jsxs("tr",{className:"border-t border-slate-100 align-top",children:[a.jsxs("td",{className:"py-2.5 pl-3 pr-2",children:[a.jsx("div",{className:"font-medium text-[11px] text-slate-900",children:U.item_name}),a.jsxs("div",{className:"text-[10px] text-slate-500 flex flex-wrap gap-1 mt-0.5",children:[U.strength&&a.jsx("span",{children:U.strength}),U.item_type&&a.jsx(Ge,{variant:"outline",className:"h-4 px-1.5 text-[9px]",children:U.item_type}),z&&a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-amber-50 px-2 py-0.5 text-[9px] text-amber-700 border border-amber-100",children:[a.jsx(wc,{className:"h-3 w-3"}),"Near expiry"]})]})]}),a.jsx("td",{className:"py-2.5 px-2",children:a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx(Ne,{type:"number",min:"0",step:"0.5",disabled:!s,className:"h-7 text-[11px]",value:U.dose,onChange:K=>D(U.tempId,{dose:K.target.value})}),a.jsx("div",{className:"flex flex-wrap gap-1",children:khe.map(K=>a.jsx("button",{type:"button",disabled:!s,onClick:()=>D(U.tempId,{dose:K}),className:["px-2 py-0.5 rounded-full border text-[9px]",String(U.dose)===K?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-200",!s&&"opacity-50"].filter(Boolean).join(" "),children:K},K))})]})}),a.jsx("td",{className:"py-2.5 px-2",children:a.jsx("div",{className:"flex flex-wrap gap-1 max-w-[180px]",children:gf.map(K=>a.jsx("button",{type:"button",disabled:!s,onClick:()=>D(U.tempId,{frequency_code:K.code}),className:["px-2 py-0.5 rounded-full border text-[9px]",U.frequency_code===K.code?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-200",!s&&"opacity-50"].filter(Boolean).join(" "),children:K.code},K.code))})}),a.jsx("td",{className:"py-2.5 px-2",children:a.jsx(Ne,{type:"number",min:"0",disabled:!s,className:"h-7 w-16 text-[11px]",value:U.days,onChange:K=>D(U.tempId,{days:K.target.value})})}),a.jsxs("td",{className:"py-2.5 px-2 text-right",children:[a.jsx(Ne,{type:"number",min:"0",disabled:!s,className:"h-7 w-20 text-[11px] text-right",value:U.quantity,onChange:K=>D(U.tempId,{quantity:K.target.value})}),q&&a.jsxs("div",{className:"mt-1 text-[9px] text-red-600 flex items-center justify-end gap-1",children:[a.jsx(wc,{className:"h-3 w-3"}),"Low stock for requested qty"]})]}),a.jsx("td",{className:"py-2.5 px-2 text-right text-[11px] text-slate-600",children:U.available_qty!=null?a.jsxs("div",{children:["Avl: ",U.available_qty,z&&a.jsxs("div",{className:"text-[9px] text-amber-700",children:["Exp: ",U.expiry_date]})]}):a.jsx("span",{className:"text-[10px] text-slate-400",children:""})}),a.jsx("td",{className:"py-2.5 px-2 text-right",children:s&&a.jsx("button",{type:"button",className:"text-[11px] text-red-600 hover:underline",onClick:()=>L(U.tempId),children:"Remove"})})]},U.tempId)})]})]})}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mt-3",children:[a.jsx("div",{className:"text-[11px] text-slate-500",children:"Signed orders appear in the Pharmacy Rx queue under IPD context."}),s&&a.jsxs("div",{className:"flex gap-2 justify-end",children:[a.jsxs(Te,{variant:"outline",size:"sm",onClick:V,disabled:d,children:[d&&a.jsx(dr,{className:"mr-1 h-3.5 w-3.5 animate-spin"}),"Save draft"]}),a.jsxs(Te,{size:"sm",onClick:F,disabled:h||!i.length,children:[h&&a.jsx(dr,{className:"mr-1 h-3.5 w-3.5 animate-spin"}),a.jsx(Fi,{className:"mr-1 h-4 w-4"}),"Sign & send"]})]})]}),a.jsxs("div",{className:"mt-4 rounded-2xl border border-slate-200 bg-slate-50/80 p-3 space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(v1,{className:"h-4 w-4 text-slate-500"}),a.jsx("span",{className:"text-xs font-semibold text-slate-800",children:"Bed-side prescription sheet (IPD)"})]}),a.jsxs("span",{className:"text-[10px] text-slate-500",children:[P,"  ",i.length," item(s)"]})]}),i.length===0?a.jsx("div",{className:"rounded-xl border border-dashed border-slate-200 bg-white px-3 py-4 text-center text-[11px] text-slate-500",children:"Add ward medicines above to see the IPD prescription sheet here."}):a.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white px-3 py-3 space-y-3",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-2 border-b border-slate-100 pb-2",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsx("div",{className:"text-xs font-semibold text-slate-900",children:Q}),a.jsxs("div",{className:"text-[10px] text-slate-500 flex flex-wrap gap-1",children:[(r==null?void 0:r.uhid)&&a.jsxs("span",{children:["UHID: ",r.uhid]}),(r==null?void 0:r.age)&&a.jsxs("span",{children:[" Age: ",r.age]}),(r==null?void 0:r.gender)&&a.jsxs("span",{children:[" ",r.gender]})]})]}),a.jsxs("div",{className:"text-right text-[10px] text-slate-500 space-y-0.5",children:[a.jsxs("div",{children:["Admission: ",t]}),(n==null?void 0:n.current_bed_code)&&a.jsxs("div",{children:["Bed: ",n.current_bed_code]}),(n==null?void 0:n.practitioner_name)&&a.jsxs("div",{children:["Consultant: ",n.practitioner_name]})]})]}),a.jsx("ol",{className:"mt-1 space-y-1.5 list-decimal pl-4",children:i.map(U=>a.jsxs("li",{children:[a.jsxs("div",{className:"text-[11px] font-semibold text-slate-900",children:[U.item_name," ",U.strength&&a.jsx("span",{className:"font-normal text-slate-700",children:U.strength})]}),a.jsx("div",{className:"text-[10px] text-slate-600",children:Phe(U)||""})]},U.tempId))}),a.jsxs("div",{className:"mt-3 flex items-center justify-between text-[10px] text-slate-500",children:[a.jsx("span",{children:"Nurse / Doctor signature: ________________________"}),a.jsxs("span",{children:["Date: ",P]})]})]})]})]})]})}var _N="rovingFocusGroup.onEntryFocus",Ohe={bubbles:!1,cancelable:!0},gx="RovingFocusGroup",[NS,V9,Dhe]=NB(gx),[Rhe,H9]=Cu(gx,[Dhe]),[Lhe,Bhe]=Rhe(gx),W9=b.forwardRef((t,n)=>a.jsx(NS.Provider,{scope:t.__scopeRovingFocusGroup,children:a.jsx(NS.Slot,{scope:t.__scopeRovingFocusGroup,children:a.jsx(Fhe,{...t,ref:n})})}));W9.displayName=gx;var Fhe=b.forwardRef((t,n)=>{const{__scopeRovingFocusGroup:r,orientation:s,loop:i=!1,dir:o,currentTabStopId:l,defaultCurrentTabStopId:c,onCurrentTabStopIdChange:d,onEntryFocus:u,preventScrollOnEntryFocus:h=!1,...m}=t,g=b.useRef(null),y=vn(n,g),N=_v(o),[j,S]=Tp({prop:l,defaultProp:c??null,onChange:d,caller:gx}),[_,A]=b.useState(!1),k=Us(u),T=V9(r),P=b.useRef(!1),[M,O]=b.useState(0);return b.useEffect(()=>{const D=g.current;if(D)return D.addEventListener(_N,k),()=>D.removeEventListener(_N,k)},[k]),a.jsx(Lhe,{scope:r,orientation:s,dir:N,loop:i,currentTabStopId:j,onItemFocus:b.useCallback(D=>S(D),[S]),onItemShiftTab:b.useCallback(()=>A(!0),[]),onFocusableItemAdd:b.useCallback(()=>O(D=>D+1),[]),onFocusableItemRemove:b.useCallback(()=>O(D=>D-1),[]),children:a.jsx(Ht.div,{tabIndex:_||M===0?-1:0,"data-orientation":s,...m,ref:y,style:{outline:"none",...t.style},onMouseDown:Lt(t.onMouseDown,()=>{P.current=!0}),onFocus:Lt(t.onFocus,D=>{const L=!P.current;if(D.target===D.currentTarget&&L&&!_){const $=new CustomEvent(_N,Ohe);if(D.currentTarget.dispatchEvent($),!$.defaultPrevented){const V=T().filter(q=>q.focusable),F=V.find(q=>q.active),Q=V.find(q=>q.id===j),z=[F,Q,...V].filter(Boolean).map(q=>q.ref.current);K9(z,h)}}P.current=!1}),onBlur:Lt(t.onBlur,()=>A(!1))})})}),q9="RovingFocusGroupItem",G9=b.forwardRef((t,n)=>{const{__scopeRovingFocusGroup:r,focusable:s=!0,active:i=!1,tabStopId:o,children:l,...c}=t,d=Nc(),u=o||d,h=Bhe(q9,r),m=h.currentTabStopId===u,g=V9(r),{onFocusableItemAdd:y,onFocusableItemRemove:N,currentTabStopId:j}=h;return b.useEffect(()=>{if(s)return y(),()=>N()},[s,y,N]),a.jsx(NS.ItemSlot,{scope:r,id:u,focusable:s,active:i,children:a.jsx(Ht.span,{tabIndex:m?0:-1,"data-orientation":h.orientation,...c,ref:n,onMouseDown:Lt(t.onMouseDown,S=>{s?h.onItemFocus(u):S.preventDefault()}),onFocus:Lt(t.onFocus,()=>h.onItemFocus(u)),onKeyDown:Lt(t.onKeyDown,S=>{if(S.key==="Tab"&&S.shiftKey){h.onItemShiftTab();return}if(S.target!==S.currentTarget)return;const _=Uhe(S,h.orientation,h.dir);if(_!==void 0){if(S.metaKey||S.ctrlKey||S.altKey||S.shiftKey)return;S.preventDefault();let k=g().filter(T=>T.focusable).map(T=>T.ref.current);if(_==="last")k.reverse();else if(_==="prev"||_==="next"){_==="prev"&&k.reverse();const T=k.indexOf(S.currentTarget);k=h.loop?Vhe(k,T+1):k.slice(T+1)}setTimeout(()=>K9(k))}}),children:typeof l=="function"?l({isCurrentTabStop:m,hasTabStop:j!=null}):l})})});G9.displayName=q9;var $he={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function zhe(t,n){return n!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function Uhe(t,n,r){const s=zhe(t.key,r);if(!(n==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(n==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return $he[s]}function K9(t,n=!1){const r=document.activeElement;for(const s of t)if(s===r||(s.focus({preventScroll:n}),document.activeElement!==r))return}function Vhe(t,n){return t.map((r,s)=>t[(n+s)%t.length])}var Hhe=W9,Whe=G9;function qhe(t,n){return b.useReducer((r,s)=>n[r][s]??r,t)}var El=t=>{const{present:n,children:r}=t,s=Ghe(n),i=typeof r=="function"?r({present:s.isPresent}):b.Children.only(r),o=vn(s.ref,Khe(i));return typeof r=="function"||s.isPresent?b.cloneElement(i,{ref:o}):null};El.displayName="Presence";function Ghe(t){const[n,r]=b.useState(),s=b.useRef(null),i=b.useRef(t),o=b.useRef("none"),l=t?"mounted":"unmounted",[c,d]=qhe(l,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return b.useEffect(()=>{const u=A0(s.current);o.current=c==="mounted"?u:"none"},[c]),vs(()=>{const u=s.current,h=i.current;if(h!==t){const g=o.current,y=A0(u);t?d("MOUNT"):y==="none"||(u==null?void 0:u.display)==="none"?d("UNMOUNT"):d(h&&g!==y?"ANIMATION_OUT":"UNMOUNT"),i.current=t}},[t,d]),vs(()=>{if(n){let u;const h=n.ownerDocument.defaultView??window,m=y=>{const j=A0(s.current).includes(CSS.escape(y.animationName));if(y.target===n&&j&&(d("ANIMATION_END"),!i.current)){const S=n.style.animationFillMode;n.style.animationFillMode="forwards",u=h.setTimeout(()=>{n.style.animationFillMode==="forwards"&&(n.style.animationFillMode=S)})}},g=y=>{y.target===n&&(o.current=A0(s.current))};return n.addEventListener("animationstart",g),n.addEventListener("animationcancel",m),n.addEventListener("animationend",m),()=>{h.clearTimeout(u),n.removeEventListener("animationstart",g),n.removeEventListener("animationcancel",m),n.removeEventListener("animationend",m)}}else d("ANIMATION_END")},[n,d]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:b.useCallback(u=>{s.current=u?getComputedStyle(u):null,r(u)},[])}}function A0(t){return(t==null?void 0:t.animationName)||"none"}function Khe(t){var s,i;let n=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,r=n&&"isReactWarning"in n&&n.isReactWarning;return r?t.ref:(n=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,r=n&&"isReactWarning"in n&&n.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var Dv="Tabs",[Yhe]=Cu(Dv,[H9]),Y9=H9(),[Xhe,FA]=Yhe(Dv),X9=b.forwardRef((t,n)=>{const{__scopeTabs:r,value:s,onValueChange:i,defaultValue:o,orientation:l="horizontal",dir:c,activationMode:d="automatic",...u}=t,h=_v(c),[m,g]=Tp({prop:s,onChange:i,defaultProp:o??"",caller:Dv});return a.jsx(Xhe,{scope:r,baseId:Nc(),value:m,onValueChange:g,orientation:l,dir:h,activationMode:d,children:a.jsx(Ht.div,{dir:h,"data-orientation":l,...u,ref:n})})});X9.displayName=Dv;var Q9="TabsList",Z9=b.forwardRef((t,n)=>{const{__scopeTabs:r,loop:s=!0,...i}=t,o=FA(Q9,r),l=Y9(r);return a.jsx(Hhe,{asChild:!0,...l,orientation:o.orientation,dir:o.dir,loop:s,children:a.jsx(Ht.div,{role:"tablist","aria-orientation":o.orientation,...i,ref:n})})});Z9.displayName=Q9;var J9="TabsTrigger",eF=b.forwardRef((t,n)=>{const{__scopeTabs:r,value:s,disabled:i=!1,...o}=t,l=FA(J9,r),c=Y9(r),d=rF(l.baseId,s),u=sF(l.baseId,s),h=s===l.value;return a.jsx(Whe,{asChild:!0,...c,focusable:!i,active:h,children:a.jsx(Ht.button,{type:"button",role:"tab","aria-selected":h,"aria-controls":u,"data-state":h?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:d,...o,ref:n,onMouseDown:Lt(t.onMouseDown,m=>{!i&&m.button===0&&m.ctrlKey===!1?l.onValueChange(s):m.preventDefault()}),onKeyDown:Lt(t.onKeyDown,m=>{[" ","Enter"].includes(m.key)&&l.onValueChange(s)}),onFocus:Lt(t.onFocus,()=>{const m=l.activationMode!=="manual";!h&&!i&&m&&l.onValueChange(s)})})})});eF.displayName=J9;var tF="TabsContent",nF=b.forwardRef((t,n)=>{const{__scopeTabs:r,value:s,forceMount:i,children:o,...l}=t,c=FA(tF,r),d=rF(c.baseId,s),u=sF(c.baseId,s),h=s===c.value,m=b.useRef(h);return b.useEffect(()=>{const g=requestAnimationFrame(()=>m.current=!1);return()=>cancelAnimationFrame(g)},[]),a.jsx(El,{present:i||h,children:({present:g})=>a.jsx(Ht.div,{"data-state":h?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":d,hidden:!g,id:u,tabIndex:0,...l,ref:n,style:{...t.style,animationDuration:m.current?"0s":void 0},children:g&&o})})});nF.displayName=tF;function rF(t,n){return`${t}-trigger-${n}`}function sF(t,n){return`${t}-content-${n}`}var Qhe=X9,aF=Z9,iF=eF,oF=nF;const ko=Qhe,Vi=b.forwardRef(({className:t,...n},r)=>a.jsx(aF,{ref:r,className:_t("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",t),...n}));Vi.displayName=aF.displayName;const on=b.forwardRef(({className:t,...n},r)=>a.jsx(iF,{ref:r,className:_t("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",t),...n}));on.displayName=iF.displayName;const ln=b.forwardRef(({className:t,...n},r)=>a.jsx(oF,{ref:r,className:_t("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...n}));ln.displayName=oF.displayName;const IP=[{key:"nursing",label:"Nursing Notes",el:wce,writePerm:"ipd.nursing"},{key:"vitals",label:"Vitals",el:Nce,writePerm:"ipd.nursing"},{key:"io",label:"Intake/Output",el:jce,writePerm:"ipd.nursing"},{key:"handover",label:"Shift Handover",el:Sce,writePerm:"ipd.nursing"},{key:"rounds",label:"Doctor Rounds",el:Cce,writePerm:"ipd.doctor"},{key:"progress",label:"Progress Notes",el:_ce,writePerm:"ipd.doctor"},{key:"pharmacy",label:"Pharmacy Orders",el:Mhe,writePerm:"ipd.doctor"},{key:"referrals",label:"Referrals",el:Ace,writePerm:"ipd.manage"},{key:"ot",label:"OT",el:kce,writePerm:"ipd.manage"},{key:"discharge",label:"Discharge",el:Ece,writePerm:"ipd.manage"},{key:"charges",label:"Bed Charges",el:Tce,writePerm:"ipd.manage"}];function Zhe(){var Q;const{id:t}=Su(),n=yi(),r=((Q=n==null?void 0:n.state)==null?void 0:Q.admission)||null,[s,i]=b.useState(r),[o,l]=b.useState([]),[c,d]=b.useState("nursing"),[u,h]=b.useState(""),[m,g]=b.useState(!1),[y,N]=b.useState(null),j=ks("ipd.view"),S=ks("ipd.manage"),_=ks("ipd.nursing"),A=ks("ipd.doctor"),k={"ipd.nursing":_,"ipd.doctor":A,"ipd.manage":S},T=async()=>{var U,z,q;g(!0),h("");try{const[{data:K},X]=await Promise.all([pB(Number(t)),Ao()]);i(K||r||null),l(X.data||[]);try{const{data:J}=await jv(K.patient_id);N(J)}catch{}}catch(K){((K==null?void 0:K.status)||((U=K==null?void 0:K.response)==null?void 0:U.status))===404&&r?i(r):h(((q=(z=K==null?void 0:K.response)==null?void 0:z.data)==null?void 0:q.detail)||"Failed to load")}finally{g(!1)}};b.useEffect(()=>{T()},[t]);const P=U=>`ADM-${String(U).padStart(6,"0")}`,[M,O]=b.useState({practitioner_user_id:"",department_id:"",expected_discharge_at:"",package_id:"",payor_type:"",insurer_name:"",policy_number:"",preliminary_diagnosis:"",history:"",care_plan:""});b.useEffect(()=>{s&&O({practitioner_user_id:s.practitioner_user_id||"",department_id:s.department_id||"",expected_discharge_at:s.expected_discharge_at?new Date(s.expected_discharge_at).toISOString().slice(0,16):"",package_id:s.package_id||"",payor_type:s.payor_type||"cash",insurer_name:s.insurer_name||"",policy_number:s.policy_number||"",preliminary_diagnosis:s.preliminary_diagnosis||"",history:s.history||"",care_plan:s.care_plan||""})},[s]);const D=U=>U?U.length===16?`${U}:00`:U:void 0,L=async U=>{var z,q;U.preventDefault();try{const K={practitioner_user_id:M.practitioner_user_id?Number(M.practitioner_user_id):void 0,department_id:M.department_id?Number(M.department_id):void 0,expected_discharge_at:D(M.expected_discharge_at),package_id:M.package_id?Number(M.package_id):void 0,payor_type:M.payor_type||"cash",insurer_name:M.insurer_name||"",policy_number:M.policy_number||"",preliminary_diagnosis:M.preliminary_diagnosis||"",history:M.history||"",care_plan:M.care_plan||""};Object.keys(K).forEach(X=>K[X]===void 0&&delete K[X]),await gle(s.id,K),await T()}catch(K){h(((q=(z=K==null?void 0:K.response)==null?void 0:z.data)==null?void 0:q.detail)||"Update failed")}},$=async()=>{var U,z;if(window.confirm("Cancel this admission?"))try{await yle(s.id),window.location.assign("/ipd/tracking")}catch(q){h(((z=(U=q==null?void 0:q.response)==null?void 0:U.data)==null?void 0:z.detail)||"Cancel failed")}},V=async U=>{var z,q;try{await vle(s.id,{to_bed_id:Number(U),reason:"Transfer"}),await T()}catch(K){h(((q=(z=K==null?void 0:K.response)==null?void 0:z.data)==null?void 0:q.detail)||"Transfer failed")}};if(!j&&!S)return a.jsx("div",{className:"p-4 text-sm text-rose-700",children:"Access denied (need ipd.view)."});if(m&&!s)return a.jsx("div",{className:"p-4 text-sm",children:"Loading"});if(!s)return a.jsx("div",{className:"p-4 text-sm",children:"No data"});const F=()=>{var U;return a.jsxs("div",{className:"rounded-xl border bg-white p-3 text-sm grid md:grid-cols-4 gap-2",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Admission:"})," ",P(s.id)]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Patient:"})," ",(y==null?void 0:y.uhid)||`P-${s.patient_id}`]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Bed:"})," ",s.current_bed_id&&((U=o.find(z=>z.id===s.current_bed_id))==null?void 0:U.code)||""]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Status:"})," ",s.status]})]})};return a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsx("h1",{className:"text-lg font-semibold",children:"Patient Tracking"})}),a.jsx(F,{}),S&&a.jsxs("div",{className:"rounded-xl border bg-white p-3 text-sm grid md:grid-cols-2 gap-4",children:[a.jsxs("form",{onSubmit:L,className:"space-y-3",children:[a.jsx("div",{className:"text-sm font-medium",children:"Update Admission"}),a.jsx(wB,{value:M.practitioner_user_id||"",onChange:(U,z)=>{O(q=>({...q,practitioner_user_id:U||"",department_id:(z==null?void 0:z.department_id)||q.department_id}))},label:"Primary Doctor  Department  Role  User"}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500",children:"Expected discharge"}),a.jsx("input",{type:"datetime-local",className:"input",value:M.expected_discharge_at,onChange:U=>O(z=>({...z,expected_discharge_at:U.target.value}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500",children:"Payor type"}),a.jsx("select",{className:"input",value:M.payor_type,onChange:U=>O(z=>({...z,payor_type:U.target.value})),children:["cash","insurance","tpa"].map(U=>a.jsx("option",{value:U,children:U},U))})]}),a.jsx("input",{className:"input",placeholder:"Insurer name",value:M.insurer_name,onChange:U=>O(z=>({...z,insurer_name:U.target.value}))}),a.jsx("input",{className:"input",placeholder:"Policy number",value:M.policy_number,onChange:U=>O(z=>({...z,policy_number:U.target.value}))}),a.jsx("input",{className:"input md:col-span-2",placeholder:"Preliminary diagnosis",value:M.preliminary_diagnosis,onChange:U=>O(z=>({...z,preliminary_diagnosis:U.target.value}))}),a.jsx("input",{className:"input",placeholder:"History",value:M.history,onChange:U=>O(z=>({...z,history:U.target.value}))}),a.jsx("input",{className:"input",placeholder:"Care plan",value:M.care_plan,onChange:U=>O(z=>({...z,care_plan:U.target.value}))})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"btn",children:"Save"}),a.jsx("button",{type:"button",className:"btn bg-rose-600 hover:bg-rose-700",onClick:$,children:"Cancel Admission"})]}),u&&a.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 p-2 text-rose-700 text-sm",children:u})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"text-sm font-medium",children:"Transfer Bed"}),a.jsx(bB,{value:"",onChange:V}),a.jsx("div",{className:"text-xs text-gray-500",children:"Pick a target bed (vacant) to transfer."})]})]}),a.jsx("div",{className:"rounded-xl border bg-white",children:a.jsxs(ko,{value:c,onValueChange:d,className:"w-full",children:[a.jsx("div",{className:"border-b px-3 py-2 flex flex-wrap gap-2",children:a.jsx(Vi,{className:"h-auto bg-transparent flex flex-wrap gap-2 p-0",children:IP.map(U=>{const z=k[U.writePerm]??!1;return a.jsxs(on,{value:U.key,className:"px-3 py-1 rounded-lg text-xs sm:text-sm data-[state=active]:bg-slate-900 data-[state=active]:text-white bg-slate-100 text-slate-700 hover:bg-slate-200",children:[U.label,!z&&a.jsx("span",{className:"ml-2 text-[10px] rounded bg-slate-200 px-1.5 py-0.5 text-slate-700 align-middle",children:"view-only"})]},U.key)})})}),a.jsx("div",{className:"p-3",children:IP.map(U=>{const z=U.el,q=k[U.writePerm]??!1;return a.jsx(ln,{value:U.key,className:"mt-2",children:a.jsx(z,{admissionId:s.id,admission:s,patient:y,canWrite:q})},U.key)})})]})})]})}function Jhe(){const[t,n]=b.useState([]),[r,s]=b.useState([]),[i,o]=b.useState({}),[l,c]=b.useState(!1),d=u=>`ADM-${String(u).padStart(6,"0")}`;return b.useEffect(()=>{let u=!0;return(async()=>{c(!0);const[m,g]=await Promise.all([Nv({status:"admitted"}),Ao()]);if(!u)return;n(m.data||[]),s(g.data||[]);const y=[...new Set((m.data||[]).map(j=>j.patient_id))].slice(0,50),N={};await Promise.all(y.map(async j=>{try{const{data:S}=await jv(j);N[j]=(S==null?void 0:S.uhid)||`P-${j}`}catch{N[j]=`P-${j}`}})),u&&o(N),c(!1)})(),()=>{u=!1}},[]),l?a.jsx("div",{className:"p-4",children:"Loading"}):a.jsxs("div",{className:"p-4 space-y-3 text-black",children:[a.jsx("h1",{className:"text-lg font-semibold",children:"Tracking Admissions (All)"}),a.jsx("div",{className:"rounded-xl border bg-white overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-left text-xs text-gray-500 bg-gray-50",children:[a.jsx("th",{className:"px-3 py-2",children:"Admission"}),a.jsx("th",{className:"px-3 py-2",children:"Patient"}),a.jsx("th",{className:"px-3 py-2",children:"Bed"}),a.jsx("th",{className:"px-3 py-2",children:"Admitted"}),a.jsx("th",{className:"px-3 py-2"})]})}),a.jsxs("tbody",{children:[(t||[]).map(u=>{var m;const h=((m=r.find(g=>g.id===u.current_bed_id))==null?void 0:m.code)||"";return a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:d(u.id)}),a.jsx("td",{className:"px-3 py-2",children:i[u.patient_id]||`P-${u.patient_id}`}),a.jsx("td",{className:"px-3 py-2",children:h}),a.jsx("td",{className:"px-3 py-2",children:new Date(u.admitted_at).toLocaleString()}),a.jsx("td",{className:"px-3 py-2",children:a.jsx(So,{to:`/ipd/admission/${u.id}`,state:{admission:u},className:"text-blue-600",children:"Open"})})]},u.id)}),!(t!=null&&t.length)&&a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-sm text-gray-500",colSpan:5,children:"No active admissions"})})]})]})})]})}function eme(){const t=Cr(h=>h.user),[n,r]=b.useState([]),[s,i]=b.useState([]),[o,l]=b.useState({}),[c,d]=b.useState(!1),u=h=>`ADM-${String(h).padStart(6,"0")}`;return b.useEffect(()=>{if(!(t!=null&&t.id))return;let h=!0;return(async()=>{d(!0);const[g,y]=await Promise.all([Nv({status:"admitted",practitioner_user_id:t.id}),Ao()]);if(!h)return;r(g.data||[]),i(y.data||[]);const N=[...new Set((g.data||[]).map(S=>S.patient_id))].slice(0,50),j={};await Promise.all(N.map(async S=>{try{const{data:_}=await jv(S);j[S]=(_==null?void 0:_.uhid)||`P-${S}`}catch{j[S]=`P-${S}`}})),h&&l(j),d(!1)})(),()=>{h=!1}},[t==null?void 0:t.id]),c?a.jsx("div",{className:"p-4",children:"Loading"}):a.jsxs("div",{className:"p-4 space-y-3 text-black",children:[a.jsx("h1",{className:"text-lg font-semibold",children:"My Admissions"}),a.jsx("div",{className:"rounded-xl border bg-white overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-left text-xs text-gray-500 bg-gray-50",children:[a.jsx("th",{className:"px-3 py-2",children:"Admission"}),a.jsx("th",{className:"px-3 py-2",children:"Patient"}),a.jsx("th",{className:"px-3 py-2",children:"Bed"}),a.jsx("th",{className:"px-3 py-2",children:"Admitted"}),a.jsx("th",{className:"px-3 py-2"})]})}),a.jsxs("tbody",{children:[(n||[]).map(h=>{var g;const m=((g=s.find(y=>y.id===h.current_bed_id))==null?void 0:g.code)||"";return a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:u(h.id)}),a.jsx("td",{className:"px-3 py-2",children:o[h.patient_id]||`P-${h.patient_id}`}),a.jsx("td",{className:"px-3 py-2",children:m}),a.jsx("td",{className:"px-3 py-2",children:new Date(h.admitted_at).toLocaleString()}),a.jsx("td",{className:"px-3 py-2",children:a.jsx(So,{to:`/ipd/admission/${h.id}`,state:{admission:h},className:"text-blue-600",children:"Open"})})]},h.id)}),!(n!=null&&n.length)&&a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-sm text-gray-500",colSpan:5,children:"No admissions assigned to you"})})]})]})})]})}function tme(){const[t,n]=b.useState([]),[r,s]=b.useState([]),[i,o]=b.useState({}),[l,c]=b.useState(!1),d=u=>`ADM-${String(u).padStart(6,"0")}`;return b.useEffect(()=>{let u=!0;return(async()=>{c(!0);const[m,g]=await Promise.all([Nv({status:"discharged"}),Ao()]);if(!u)return;n(m.data||[]),s(g.data||[]);const y=[...new Set((m.data||[]).map(j=>j.patient_id))].slice(0,50),N={};await Promise.all(y.map(async j=>{try{const{data:S}=await jv(j);N[j]=(S==null?void 0:S.uhid)||`P-${j}`}catch{N[j]=`P-${j}`}})),u&&o(N),c(!1)})(),()=>{u=!1}},[]),l?a.jsx("div",{className:"p-4",children:"Loading"}):a.jsxs("div",{className:"p-4 space-y-3 text-black",children:[a.jsx("h1",{className:"text-lg font-semibold",children:"Discharged Patients"}),a.jsx("div",{className:"rounded-xl border bg-white overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-left text-xs text-gray-500 bg-gray-50",children:[a.jsx("th",{className:"px-3 py-2",children:"Admission"}),a.jsx("th",{className:"px-3 py-2",children:"Patient"}),a.jsx("th",{className:"px-3 py-2",children:"Bed"}),a.jsx("th",{className:"px-3 py-2",children:"Admitted"}),a.jsx("th",{className:"px-3 py-2",children:"Status"})]})}),a.jsxs("tbody",{children:[(t||[]).map(u=>{var m;const h=((m=r.find(g=>g.id===u.current_bed_id))==null?void 0:m.code)||"";return a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:d(u.id)}),a.jsx("td",{className:"px-3 py-2",children:i[u.patient_id]||`P-${u.patient_id}`}),a.jsx("td",{className:"px-3 py-2",children:h}),a.jsx("td",{className:"px-3 py-2",children:new Date(u.admitted_at).toLocaleString()}),a.jsx("td",{className:"px-3 py-2",children:u.status})]},u.id)}),!(t!=null&&t.length)&&a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-sm text-gray-500",colSpan:5,children:"No discharged records"})})]})]})})]})}function nme(){const[t,n]=b.useState([]),[r,s]=b.useState([]),[i,o]=b.useState([]),[l,c]=b.useState(!1),[d,u]=b.useState(""),[h,m]=b.useState(null),g=async()=>{var A,k;c(!0),u("");try{const[T,P,M]=await Promise.all([SA(),CA(),Ao()]);n(T.data||[]),s(P.data||[]),o(M.data||[])}catch(T){u(((k=(A=T==null?void 0:T.response)==null?void 0:A.data)==null?void 0:k.detail)||"Failed to load beds")}finally{c(!1)}};b.useEffect(()=>{g()},[]);const y=b.useMemo(()=>{const A={};return r.forEach(k=>{var T;(A[T=k.ward_id]||(A[T]=[])).push(k)}),A},[r]),N=b.useMemo(()=>{const A={};return i.forEach(k=>{var T;(A[T=k.room_id]||(A[T]=[])).push(k)}),A},[i]),j=({s:A})=>{const k=A==="vacant"?"bg-emerald-50 text-emerald-700 border-emerald-200":A==="occupied"?"bg-rose-50 text-rose-700 border-rose-200":A==="reserved"?"bg-amber-50 text-amber-700 border-amber-200":"bg-gray-50 text-gray-700 border-gray-200";return a.jsx("span",{className:`rounded-full border px-2 py-0.5 text-[11px] ${k}`,children:A})},S=async(A,k,T)=>{m({id:A,code:k,action:T,dt:"",note:""})},_=async()=>{var A,k;try{const T={state:h.action};h.action==="reserved"&&(T.reserved_until=h.dt?h.dt.length===16?`${h.dt}:00`:h.dt:null),h.note&&(T.note=h.note),await dle(h.id,T),m(null),await g()}catch(T){alert(((k=(A=T==null?void 0:T.response)==null?void 0:A.data)==null?void 0:k.detail)||"Failed to set state")}};return a.jsxs("div",{className:"p-4 space-y-3 text-black",children:[a.jsx("h1",{className:"text-lg font-semibold",children:"Bedboard"}),l?a.jsx("div",{children:"Loading"}):d?a.jsx("div",{className:"text-rose-700",children:d}):null,a.jsx("div",{className:"space-y-4",children:t.map(A=>a.jsxs("div",{className:"rounded-xl border bg-white overflow-hidden",children:[a.jsxs("div",{className:"px-3 py-2 text-sm font-semibold",children:[A.code,"  ",A.name]}),(y[A.id]||[]).map(k=>a.jsxs("div",{className:"border-t px-3 py-2",children:[a.jsxs("div",{className:"text-xs text-gray-600 mb-2",children:["Room ",k.number,"  ",k.type]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(N[k.id]||[]).map(T=>a.jsxs("div",{className:"rounded-lg border px-3 py-2 text-sm",children:[a.jsx("div",{className:"font-medium",children:T.code}),a.jsx("div",{className:"mt-1",children:a.jsx(j,{s:T.state})}),a.jsxs("div",{className:"mt-2 flex gap-2",children:[a.jsx("button",{className:"btn btn-sm",onClick:()=>S(T.id,T.code,"reserved"),children:"Reserve"}),a.jsx("button",{className:"btn btn-sm",onClick:()=>S(T.id,T.code,"preoccupied"),children:"Preoccupy"}),a.jsx("button",{className:"btn btn-sm",onClick:()=>S(T.id,T.code,"vacant"),children:"Vacate"})]})]},T.id))})]},k.id)),!(y[A.id]||[]).length&&a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No rooms"})]},A.id))}),h&&a.jsx("div",{className:"fixed inset-0 bg-black/40 grid place-items-center z-50",children:a.jsxs("div",{className:"w-full max-w-md rounded-xl bg-white p-4 space-y-3",children:[a.jsxs("div",{className:"text-sm font-semibold",children:["Set ",h.action,"  ",h.code]}),h.action==="reserved"&&a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500",children:"Reserved until"}),a.jsx("input",{type:"datetime-local",className:"input",value:h.dt,onChange:A=>m(k=>({...k,dt:A.target.value}))})]}),a.jsx("input",{className:"input",placeholder:"Note (optional)",value:h.note,onChange:A=>m(k=>({...k,note:A.target.value}))}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx("button",{className:"btn",onClick:_,children:"Save"}),a.jsx("button",{className:"btn bg-gray-100 text-gray-700 hover:bg-gray-200",onClick:()=>m(null),children:"Close"})]})]})})]})}const lF=({q:t="",active:n,page:r=1,page_size:s=50}={})=>te.get("/masters/lab-tests",{params:{q:t,active:n,page:r,page_size:s}}),rme=t=>te.post("/masters/lab-tests",t),sme=(t,n)=>te.put(`/masters/lab-tests/${t}`,n),ame=t=>te.delete(`/masters/lab-tests/${t}`),ime=({patient_id:t,context_type:n=null,context_id:r=null,priority:s="routine",test_ids:i=[]})=>{const o=(i||[]).map(l=>({test_id:l}));return te.post("/lab/orders",{patient_id:t,context_type:n,context_id:r,priority:s,items:o})},ome=(t={})=>te.get("/lab/orders",{params:t}),lme=t=>te.get(`/lab/orders/${t}`),cme=(t,n)=>te.post(`/lab/orders/${t}/collect`,{barcode:n}),dme=(t,n)=>te.post(`/lab/orders/${t}/results`,n),ume=t=>te.post(`/lab/items/${t}/validate`),fme=t=>te.post(`/lab/orders/${t}/finalize`),hme=(t,n,r="")=>te.post("/lab/attachments",{item_id:t,file_url:n,note:r});function yx({value:t,onChange:n,label:r="Patient"}){const[s,i]=b.useState(""),[o,l]=b.useState([]),[c,d]=b.useState(!1),[u,h]=b.useState(null);b.useEffect(()=>{let g=!0;if(!s){l([]);return}return d(!0),xB(s).then(y=>{g&&l(y.data||[])}).catch(()=>{g&&l([])}).finally(()=>{g&&d(!1)}),()=>{g=!1}},[s]),b.useEffect(()=>{if(!t){h(null);return}const g=o.find(y=>y.id===t);g&&h(g)},[t,o]);const m=g=>{h(g),i(""),l([]),n==null||n(g.id,g)};return a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:r}),a.jsx("input",{className:"input",placeholder:"Search by name / UHID / phone",value:s,onChange:g=>i(g.target.value)}),c&&a.jsx("div",{className:"text-xs text-slate-500",children:"Searching"}),o.length>0&&a.jsx("div",{className:"max-h-48 overflow-auto rounded-xl border bg-white text-sm",children:o.map(g=>a.jsx("button",{type:"button",onClick:()=>m(g),className:"flex w-full items-center justify-between px-3 py-2 text-left hover:bg-slate-50",children:a.jsxs("div",{children:[a.jsxs("div",{className:"font-medium",children:[g.first_name," ",g.last_name]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID: ",g.uhid,"  ",g.phone]})]})},g.id))}),u&&a.jsxs("div",{className:"rounded-xl border bg-slate-50 px-3 py-2 text-xs text-slate-700",children:["Selected:"," ",a.jsxs("span",{className:"font-semibold",children:[u.first_name," ",u.last_name]})," "," UHID ",u.uhid,"  ",u.phone]})]})}function mme({value:t=[],onChange:n}){const[r,s]=b.useState(""),[i,o]=b.useState(!1),[l,c]=b.useState([]);b.useEffect(()=>{let m=!0;return o(!0),lF({q:r,active:!0,page_size:50}).then(g=>{m&&c(g.data||[])}).finally(()=>m&&o(!1)),()=>{m=!1}},[r]);const d=b.useMemo(()=>new Set(t||[]),[t]),u=b.useMemo(()=>l.filter(m=>d.has(m.id)),[l,d]),h=m=>{const g=new Set(d);g.has(m)?g.delete(m):g.add(m),n==null||n([...g])};return a.jsxs("div",{className:"space-y-2 text-black",children:[a.jsx("label",{className:"text-sm font-medium",children:"Select Tests"}),a.jsxs("div",{className:"relative",children:[a.jsx(ur,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),a.jsx("input",{className:"input pl-9",placeholder:"Search by code/name",value:r,onChange:m=>s(m.target.value)})]}),a.jsx("div",{className:"grid gap-2 md:grid-cols-2",children:(l||[]).slice(0,10).map(m=>{const g=d.has(m.id);return a.jsxs("button",{type:"button",onClick:()=>h(m.id),className:["rounded-xl border p-3 text-left transition",g?"border-blue-500 bg-blue-50":"hover:bg-gray-50"].join(" "),children:[a.jsxs("div",{className:"font-medium",children:[m.code,"  ",m.name]}),a.jsxs("div",{className:"text-xs text-gray-500",children:["",Number(m.price||0).toFixed(2)]})]},m.id)})}),u.length>0&&a.jsxs("div",{className:"rounded-xl border p-3",children:[a.jsx("div",{className:"text-xs font-medium mb-2",children:"Selected"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:u.map(m=>a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-blue-50 px-3 py-1 text-xs",children:[m.code,a.jsx("button",{onClick:()=>h(m.id),className:"ml-1 rounded-full p-0.5 hover:bg-blue-100",children:a.jsx(La,{className:"h-3 w-3"})})]},m.id))})]}),i&&a.jsx("div",{className:"text-xs text-gray-500",children:"Loading"})]})}function $A({order:t,to:n,className:r="",prefix:s="LAB"}){const i=new Date((t==null?void 0:t.created_at)||(t==null?void 0:t.createdAt)||Date.now()),o=i.toISOString().slice(2,7).replace("-",""),l=Number((t==null?void 0:t.id)||0).toString(36).toUpperCase().padStart(3,"0"),c=`${s}-${o}-${l}`,d=(t==null?void 0:t.accession_no)||c,u=a.jsx("span",{className:["inline-flex items-center rounded-md border px-2 py-0.5 text-xs font-medium","bg-blue-50 border-blue-200 text-blue-700",r].join(" "),title:`Created ${i.toLocaleString()}`,children:d});return n?a.jsx(So,{to:n,children:u}):u}function Rv({patient:t,patientId:n,className:r=""}){const[s,i]=b.useState(t||null);b.useEffect(()=>{let u=!1;return!t&&n&&(async()=>{try{const{data:h}=await te.get(`/patients/${n}`);u||i(h)}catch{}})(),()=>{u=!0}},[t,n]);const o=(s==null?void 0:s.uhid)||"",l=(s==null?void 0:s.name)||(s!=null&&s.first_name?`${s.first_name} ${s.last_name||""}`.trim():""),c=s!=null&&s.id?`/patients?focus=${s.id}`:void 0,d=a.jsxs("span",{className:["inline-flex items-center gap-2 rounded-md border px-2 py-0.5 text-xs","bg-gray-50 border-gray-200 text-gray-700","max-w-[18rem]",r].join(" "),title:l!==""?l:void 0,children:[a.jsx("span",{className:"font-medium",children:o}),a.jsx("span",{className:"text-gray-400",children:""}),a.jsx("span",{className:"truncate",children:l})]});return c?a.jsx(So,{to:c,children:d}):d}function zA({status:t}){const n=String(t||"ordered").toLowerCase(),s={ordered:"bg-amber-50 text-amber-700 border-amber-200",collected:"bg-blue-50 text-blue-700 border-blue-200",validated:"bg-purple-50 text-purple-700 border-purple-200",reported:"bg-emerald-50 text-emerald-700 border-emerald-200",cancelled:"bg-rose-50 text-rose-700 border-rose-200"}[n]||"bg-gray-50 text-gray-700 border-gray-200";return a.jsx("span",{className:`inline-flex items-center rounded-md border px-2 py-0.5 text-xs font-medium ${s}`,children:n.charAt(0).toUpperCase()+n.slice(1)})}const pme=t=>t?new Date(t).toLocaleString():"";function xme(){const[t,n]=b.useState(""),[r,s]=b.useState([]),[i,o]=b.useState(!1),[l,c]=b.useState(!1),[d,u]=b.useState(null),[h,m]=b.useState([]),[g,y]=b.useState("routine"),N=async()=>{o(!0);try{const{data:A}=await ome({q:t,page_size:100});s(A||[])}catch{fe.error("Failed to load orders")}finally{o(!1)}};b.useEffect(()=>{N()},[t]);const j=Hi(),S=async()=>{var A,k;if(!d||h.length===0){fe.error("Select patient and at least one test");return}try{const{data:T}=await ime({patient_id:d,priority:g,test_ids:h});fe.success("Order created"),c(!1),u(null),m([]),y("routine"),j(`/lab/orders/${(T==null?void 0:T.id)||(T==null?void 0:T.order_id)}`)}catch(T){fe.error(((k=(A=T==null?void 0:T.response)==null?void 0:A.data)==null?void 0:k.detail)||"Create failed")}},_=b.useMemo(()=>r.length,[r]);return a.jsxs("div",{className:"p-4 md:p-6 text-black",children:[a.jsxs("header",{className:"mb-4 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Wf,{className:"h-5 w-5"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-semibold",children:"Lab Orders"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Create, track, and report LIS orders"})]})]}),a.jsx(Nr,{anyOf:["lab.orders.create","orders.lab.create"],children:a.jsxs("button",{className:"btn-primary",onClick:()=>c(!0),children:[a.jsx(or,{className:"h-4 w-4 mr-2"})," New Order"]})})]}),a.jsx("div",{className:"mb-3",children:a.jsxs("div",{className:"relative max-w-md",children:[a.jsx(ur,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),a.jsx("input",{className:"input pl-9",placeholder:"Search patient UHID/name or order id",value:t,onChange:A=>n(A.target.value)})]})}),a.jsx("div",{className:"rounded-xl border bg-white",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50 text-gray-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"Order #"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Patient"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Priority"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Status"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Created"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[i&&a.jsx("tr",{children:a.jsx("td",{className:"px-3 py-3 text-sm text-gray-500",colSpan:6,children:"Loading"})}),!i&&r.map(A=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:a.jsx($A,{order:A,to:`/lab/orders/${A.id}`})}),a.jsx("td",{className:"px-3 py-2",children:a.jsx(Rv,{patient:A.patient,patientId:A.patient_id})}),a.jsx("td",{className:"px-3 py-2 capitalize",children:A.priority||"routine"}),a.jsx("td",{className:"px-3 py-2",children:a.jsx(zA,{status:A.status})}),a.jsx("td",{className:"px-3 py-2",children:pme(A.created_at||A.createdAt)}),a.jsx("td",{className:"px-3 py-2 text-right",children:a.jsx(So,{to:`/lab/orders/${A.id}`,className:"btn-ghost",children:"View"})})]},A.id)),!i&&r.length===0&&a.jsx("tr",{children:a.jsx("td",{className:"px-3 py-6 text-center text-gray-500",colSpan:6,children:"No orders"})})]}),a.jsx("tfoot",{children:a.jsx("tr",{children:a.jsxs("td",{className:"px-3 py-2 text-xs text-gray-500",colSpan:6,children:["Total: ",_]})})})]})}),l&&a.jsxs("div",{className:"fixed inset-0 z-40",children:[a.jsx("div",{className:"absolute inset-0 bg-black/30",onClick:()=>c(!1)}),a.jsxs("div",{className:"absolute right-0 top-0 h-full w-full max-w-xl bg-white shadow-xl p-4 overflow-y-auto",children:[a.jsx("h2",{className:"text-lg font-semibold mb-4",children:"New Lab Order"}),a.jsxs("div",{className:"space-y-4",children:[a.jsx(yx,{value:d,onChange:u}),a.jsx(mme,{value:h,onChange:m}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm",children:"Priority"}),a.jsxs("select",{className:"input",value:g,onChange:A=>y(A.target.value),children:[a.jsx("option",{value:"routine",children:"Routine"}),a.jsx("option",{value:"urgent",children:"Urgent"}),a.jsx("option",{value:"stat",children:"STAT"})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[a.jsx("button",{className:"btn-ghost",onClick:()=>c(!1),children:"Cancel"}),a.jsx("button",{className:"btn-primary",onClick:S,children:"Create"})]})]})]})]})]})}const gme=async t=>{const n=new FormData;n.append("file",t);const{data:r}=await te.post("/files/upload",n,{headers:{"Content-Type":"multipart/form-data"}});return(r==null?void 0:r.url)||(r==null?void 0:r.file_url)||(r==null?void 0:r.path)||""},PP=t=>t?new Date(t).toLocaleString():"";function yme(){const{id:t}=Su(),[n,r]=b.useState(!1),[s,i]=b.useState(null),[o,l]=b.useState(""),[c,d]=b.useState({}),u=async()=>{r(!0);try{const{data:S}=await lme(t);i(S),d(()=>{const _={};return((S==null?void 0:S.items)||[]).forEach(A=>{_[A.id]={result_value:A.result_value??"",is_critical:!!A.is_critical}}),_})}catch{fe.error("Failed to load order")}finally{r(!1)}};b.useEffect(()=>{u()},[t]);const h=b.useMemo(()=>{const S=(s==null?void 0:s.items)||[];return S.length>0&&S.every(_=>(_.status||"").toLowerCase()==="validated")},[s]),m=async()=>{var S,_;if(!o.trim()){fe.error("Barcode required");return}try{await cme(t,o.trim()),fe.success("Sample collected"),l(""),u()}catch(A){fe.error(((_=(S=A==null?void 0:A.response)==null?void 0:S.data)==null?void 0:_.detail)||"Collect failed")}},g=async()=>{var _,A;const S=Object.entries(c).map(([k,T])=>({item_id:Number(k),result_value:T.result_value,is_critical:!!T.is_critical}));try{await dme(t,S),fe.success("Results saved"),u()}catch(k){fe.error(((A=(_=k==null?void 0:k.response)==null?void 0:_.data)==null?void 0:A.detail)||"Save failed")}},y=async S=>{var _,A;try{await ume(S),fe.success("Item validated"),u()}catch(k){fe.error(((A=(_=k==null?void 0:k.response)==null?void 0:_.data)==null?void 0:A.detail)||"Validate failed")}},N=async()=>{var S,_;try{await fme(t),fe.success("Report finalized"),u()}catch(A){fe.error(((_=(S=A==null?void 0:A.response)==null?void 0:S.data)==null?void 0:_.detail)||"Finalize failed")}},j=async(S,_)=>{try{const A=await gme(_);await hme(S,A,_.name),fe.success("Attachment added"),u()}catch{fe.error("Attachment failed")}};return n&&!s?a.jsx("div",{className:"p-6",children:"Loading"}):s?a.jsxs("div",{className:"p-4 md:p-6 space-y-6 text-black",children:[a.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-xl font-semibold",children:["Lab Order #",s.id]}),a.jsxs("div",{className:"text-xs text-gray-500 flex flex-wrap items-center gap-2",children:[a.jsx(Rv,{patient:s==null?void 0:s.patient,patientId:s==null?void 0:s.patient_id,className:"border-blue-100 bg-blue-50"}),a.jsxs("span",{children:[" Created: ",PP(s.created_at||s.createdAt)]})]}),a.jsxs("div",{className:"text-xs text-gray-500",children:["Priority: ",a.jsx("span",{className:"capitalize",children:s.priority||"routine"}),"  Status: ",s.status]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Nr,{anyOf:["lab.results.enter","lab.orders.create"],children:a.jsx("button",{className:"btn",onClick:g,children:"Save Results"})}),a.jsx(Nr,{anyOf:["lab.results.validate","lab.results.report","lab.results.approve"],children:a.jsxs("button",{className:"btn",disabled:!h,onClick:N,children:[a.jsx(pv,{className:"h-4 w-4 mr-2"})," Finalize"]})})]})]}),a.jsx(Nr,{anyOf:["lab.samples.collect"],children:a.jsxs("section",{className:"rounded-xl border bg-white p-4",children:[a.jsx("h2",{className:"font-semibold mb-3",children:"Sample Collection"}),a.jsxs("div",{className:"flex flex-wrap items-end gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm",children:"Barcode"}),a.jsx("input",{className:"input",placeholder:"Scan/enter barcode",value:o,onChange:S=>l(S.target.value)})]}),a.jsx("button",{className:"btn",onClick:m,children:"Collect"}),a.jsxs("div",{className:"text-xs text-gray-500 ml-auto",children:["Collected at: ",PP(s.collected_at||s.collectedAt)]})]})]})}),a.jsxs("section",{className:"rounded-xl border bg-white",children:[a.jsx("div",{className:"p-4 border-b",children:a.jsx("h2",{className:"font-semibold",children:"Results"})}),a.jsxs("div",{className:"divide-y",children:[(s.items||[]).map(S=>{const _=c[S.id]||{result_value:"",is_critical:!1},A=(S.status||"").toLowerCase()==="validated";return a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"font-medium",children:[S.test_code||S.code,"  ",S.test_name||S.name]}),a.jsxs("div",{className:"text-xs text-gray-500",children:["Range: ",S.reference_range||"","  Unit: ",S.unit||""]})]}),a.jsxs("div",{className:"text-xs",children:["Status: ",a.jsx("span",{className:A?"text-emerald-600":"text-gray-600",children:A?"Validated":S.status||"Pending"})]})]}),a.jsxs("div",{className:"mt-3 grid gap-3 md:grid-cols-[2fr_1fr_auto]",children:[a.jsx("input",{className:"input",placeholder:"Result value",value:_.result_value,onChange:k=>d(T=>({...T,[S.id]:{...T[S.id],result_value:k.target.value}}))}),a.jsxs("label",{className:"inline-flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:!!_.is_critical,onChange:k=>d(T=>({...T,[S.id]:{...T[S.id],is_critical:k.target.checked}}))}),a.jsx("span",{className:"text-sm",children:"Critical"})]}),a.jsx("div",{className:"flex gap-2",children:a.jsx("button",{className:"btn-ghost",onClick:()=>y(S.id),disabled:A,children:"Validate"})})]}),a.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[a.jsxs("label",{className:"btn-ghost inline-flex items-center gap-2 cursor-pointer",children:[a.jsx(N1,{className:"h-4 w-4"}),a.jsx("span",{children:"Attach"}),a.jsx("input",{type:"file",hidden:!0,onChange:k=>{var T;return((T=k.target.files)==null?void 0:T[0])&&j(S.id,k.target.files[0])}})]}),a.jsx("div",{className:"text-xs text-gray-500",children:(S.attachments||[]).length?`${S.attachments.length} attachment(s)`:"No attachments"})]})]},S.id)}),(s.items||[]).length===0&&a.jsx("div",{className:"p-6 text-sm text-gray-500",children:"No items"})]})]})]}):a.jsx("div",{className:"p-6",children:"Order not found"})}function vme(){const[t,n]=b.useState(""),[r,s]=b.useState([]),[i,o]=b.useState(!1),[l,c]=b.useState(null),[d,u]=b.useState(!1),h=async()=>{o(!0);try{const{data:S}=await lF({q:t,page_size:200});s(S||[])}catch{fe.error("Failed to load tests")}finally{o(!1)}};b.useEffect(()=>{h()},[t]);const m=()=>{c({code:"",name:"",price:0,is_active:!0}),u(!0)},g=S=>{c({...S}),u(!0)},y=async()=>{var S,_;try{l!=null&&l.id?(await sme(l.id,l),fe.success("Updated")):(await rme(l),fe.success("Created")),u(!1),h()}catch(A){fe.error(((_=(S=A==null?void 0:A.response)==null?void 0:S.data)==null?void 0:_.detail)||"Save failed")}},N=async S=>{if(confirm("Delete this test?"))try{await ame(S),fe.success("Deleted"),h()}catch{fe.error("Delete failed")}},j=b.useMemo(()=>r.length,[r]);return a.jsxs("div",{className:"p-4 md:p-6 text-black",children:[a.jsxs("header",{className:"mb-4 flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-semibold",children:"Lab Masters"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Manage NABL-friendly test catalogue"})]}),a.jsx(Nr,{anyOf:["lab.masters.manage","masters.lab.manage"],children:a.jsxs("button",{className:"btn-primary",onClick:m,children:[a.jsx(or,{className:"h-4 w-4 mr-2"})," New Test"]})})]}),a.jsx("div",{className:"mb-3",children:a.jsxs("div",{className:"relative max-w-md",children:[a.jsx(ur,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),a.jsx("input",{className:"input pl-9",placeholder:"Search code/name",value:t,onChange:S=>n(S.target.value)})]})}),a.jsx("div",{className:"rounded-xl border bg-white",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50 text-gray-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"Code"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Name"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Price"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Active"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[i&&a.jsx("tr",{children:a.jsx("td",{className:"px-3 py-3",colSpan:5,children:"Loading"})}),!i&&r.map(S=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:S.code}),a.jsx("td",{className:"px-3 py-2",children:S.name}),a.jsxs("td",{className:"px-3 py-2 text-right",children:["",Number(S.price||0).toFixed(2)]}),a.jsx("td",{className:"px-3 py-2",children:S.is_active?"Yes":"No"}),a.jsx("td",{className:"px-3 py-2 text-right",children:a.jsxs(Nr,{anyOf:["lab.masters.manage","masters.lab.manage"],children:[a.jsx("button",{className:"btn-ghost mr-2",onClick:()=>g(S),children:a.jsx(Co,{className:"h-4 w-4"})}),a.jsx("button",{className:"btn-ghost text-red-600",onClick:()=>N(S.id),children:a.jsx(_l,{className:"h-4 w-4"})})]})})]},S.id)),!i&&r.length===0&&a.jsx("tr",{children:a.jsx("td",{className:"px-3 py-6 text-center text-gray-500",colSpan:5,children:"No tests"})})]}),a.jsx("tfoot",{children:a.jsx("tr",{children:a.jsxs("td",{className:"px-3 py-2 text-xs text-gray-500",colSpan:5,children:["Total: ",j]})})})]})}),d&&a.jsxs("div",{className:"fixed inset-0 z-40",children:[a.jsx("div",{className:"absolute inset-0 bg-black/30",onClick:()=>u(!1)}),a.jsxs("div",{className:"absolute right-0 top-0 h-full w-full max-w-md bg-white shadow-xl p-4 overflow-y-auto",children:[a.jsx("h2",{className:"text-lg font-semibold mb-4",children:l!=null&&l.id?"Edit Test":"New Test"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm",children:"Code"}),a.jsx("input",{className:"input",value:(l==null?void 0:l.code)||"",onChange:S=>c(_=>({..._,code:S.target.value}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm",children:"Name"}),a.jsx("input",{className:"input",value:(l==null?void 0:l.name)||"",onChange:S=>c(_=>({..._,name:S.target.value}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm",children:"Price"}),a.jsx("input",{type:"number",step:"0.01",className:"input",value:(l==null?void 0:l.price)??0,onChange:S=>c(_=>({..._,price:parseFloat(S.target.value||0)}))})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{id:"active",type:"checkbox",checked:!!(l!=null&&l.is_active),onChange:S=>c(_=>({..._,is_active:S.target.checked}))}),a.jsx("label",{htmlFor:"active",className:"text-sm",children:"Active"})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-3",children:[a.jsx("button",{className:"btn-ghost",onClick:()=>u(!1),children:"Cancel"}),a.jsx("button",{className:"btn-primary",onClick:y,children:"Save"})]})]})]})]})]})}const cF=({q:t="",active:n,page:r=1,page_size:s=50}={})=>te.get("/ris/masters/tests",{params:{q:t,active:n,page:r,page_size:s}}),bme=t=>te.post("/ris/masters/tests",t),wme=(t,n)=>te.put(`/ris/masters/tests/${t}`,n),Nme=t=>te.delete(`/ris/masters/tests/${t}`),jme=({patient_id:t,test_id:n,context_type:r=null,context_id:s=null,ordering_user_id:i=null,priority:o="routine"})=>te.post("/ris/orders",{patient_id:t,test_id:n,context_type:r,context_id:s,ordering_user_id:i,priority:o}),Sme=(t={})=>te.get("/ris/orders",{params:t}),Cme=t=>te.get(`/ris/orders/${t}`),_me=(t,{scheduled_at:n})=>te.post(`/ris/orders/${t}/schedule`,{scheduled_at:n}),Ame=t=>te.post(`/ris/orders/${t}/scan`),Eme=(t,{report_text:n})=>te.post(`/ris/orders/${t}/report`,{report_text:n}),kme=(t,{report_text:n})=>te.put(`/ris/orders/${t}/report`,{report_text:n}),Tme=t=>te.post(`/ris/orders/${t}/approve`),Ime=(t,n,r="")=>te.post(`/ris/attachments/${t}`,{file_url:n,note:r}),Pme=(t,n)=>{const r=new FormData;return r.append("file",n),te.post(`/ris/orders/${t}/upload`,r,{headers:{"Content-Type":"multipart/form-data"}})};function dF({modality:t}){const n=String(t||"").toUpperCase(),s={XR:"bg-sky-50 text-sky-700 border-sky-200",CT:"bg-purple-50 text-purple-700 border-purple-200",MRI:"bg-indigo-50 text-indigo-700 border-indigo-200",USG:"bg-emerald-50 text-emerald-700 border-emerald-200",MAMMO:"bg-rose-50 text-rose-700 border-rose-200"}[n]||"bg-gray-50 text-gray-700 border-gray-200";return a.jsx("span",{className:`inline-flex items-center rounded-md border px-2 py-0.5 text-xs font-medium ${s}`,children:n||""})}function Mme({onClose:t,onCreated:n}){const[r,s]=b.useState(null),[i,o]=b.useState([]),[l,c]=b.useState(""),[d,u]=b.useState(!1),[h,m]=b.useState("routine"),[g,y]=b.useState("");b.useEffect(()=>{let j=!1;return(async()=>{const{data:_}=await cF({q:l});j||o(Array.isArray(_)?_:(_==null?void 0:_.items)||[])})(),()=>{j=!0}},[l]);const N=async()=>{var j,S;if(!r)return fe.error("Select a patient");if(!g)return fe.error("Select a test");u(!0);try{const{data:_}=await jme({patient_id:r,test_id:Number(g),priority:h});fe.success(`Order #${_==null?void 0:_.id} created`),n==null||n(_),t==null||t()}catch(_){fe.error(((S=(j=_==null?void 0:_.response)==null?void 0:j.data)==null?void 0:S.detail)||"Failed to create order")}finally{u(!1)}};return a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Create Radiology Order"}),a.jsx(yx,{value:r,onChange:s}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsxs("div",{className:"md:col-span-2 space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Test"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{className:"input",placeholder:"Search tests",value:l,onChange:j=>c(j.target.value)}),a.jsxs("select",{className:"input",value:g,onChange:j=>y(j.target.value),children:[a.jsx("option",{value:"",children:"Select"}),i.map(j=>a.jsxs("option",{value:j.id,children:[j.code,"  ",j.name," ",j.modality?`(${j.modality})`:""]},j.id))]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Priority"}),a.jsxs("select",{className:"input",value:h,onChange:j=>m(j.target.value),children:[a.jsx("option",{value:"routine",children:"Routine"}),a.jsx("option",{value:"urgent",children:"Urgent"}),a.jsx("option",{value:"stat",children:"STAT"})]})]})]}),a.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[a.jsx("button",{className:"btn-ghost",onClick:t,children:"Cancel"}),a.jsx("button",{className:"btn",onClick:N,disabled:d,children:d?"Creating":"Create Order"})]})]})}function Ome({open:t,onClose:n,children:r}){return t?a.jsxs("div",{className:"fixed inset-0 z-[100] grid place-items-center bg-black/40 p-4",children:[a.jsx("div",{className:"w-full max-w-3xl rounded-2xl bg-white p-4 shadow-2xl",children:r}),a.jsx("button",{className:"absolute inset-0 -z-10",onClick:n,"aria-label":"Close"})]}):null}function Dme(){const[t,n]=b.useState([]),[r,s]=b.useState(!0),[i,o]=b.useState(""),[l,c]=b.useState(!1);return b.useEffect(()=>{let d=!1;return(async()=>{var h,m;s(!0);try{const{data:g}=await Sme({q:i});d||n(Array.isArray(g)?g:[])}catch(g){fe.error(((m=(h=g==null?void 0:g.response)==null?void 0:h.data)==null?void 0:m.detail)||"Failed to load orders")}finally{d||s(!1)}})(),()=>{d=!0}},[i]),a.jsxs("div",{className:"space-y-5 text-black",children:[a.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-semibold",children:"Radiology Orders"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Book, track, scan and report."})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{className:"input w-60",placeholder:"Search test, UHID or name",value:i,onChange:d=>o(d.target.value)}),a.jsx(Nr,{anyOf:["orders.ris.create","radiology.orders.create"],children:a.jsxs("button",{className:"btn",onClick:()=>c(!0),children:[a.jsx(or,{className:"h-4 w-4 mr-2"})," New Order"]})})]})]}),a.jsx("div",{className:"rounded-xl border bg-white",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50 text-gray-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"Order"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Patient"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Modality"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Priority"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Status"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Created"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[r&&a.jsx("tr",{children:a.jsx("td",{className:"px-3 py-3",colSpan:7,children:"Loading"})}),!r&&t.map(d=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:a.jsx($A,{order:d,to:`/ris/orders/${d.id}`,prefix:"RAD"})}),a.jsx("td",{className:"px-3 py-2",children:a.jsx(Rv,{patientId:d.patient_id})}),a.jsx("td",{className:"px-3 py-2",children:a.jsx(dF,{modality:d.modality})}),a.jsx("td",{className:"px-3 py-2 capitalize",children:d.priority||"routine"}),a.jsx("td",{className:"px-3 py-2",children:a.jsx(zA,{status:d.status})}),a.jsx("td",{className:"px-3 py-2",children:new Date(d.created_at).toLocaleString()}),a.jsx("td",{className:"px-3 py-2 text-right",children:a.jsx(So,{to:`/ris/orders/${d.id}`,className:"btn-ghost",children:"View"})})]},d.id)),!r&&t.length===0&&a.jsx("tr",{children:a.jsx("td",{className:"px-3 py-6 text-center text-gray-500",colSpan:7,children:"No orders"})})]})]})}),a.jsx(Ome,{open:l,onClose:()=>c(!1),children:a.jsx(Mme,{onClose:()=>c(!1),onCreated:()=>c(!1)})})]})}function Rme({t,onEdit:n,onDelete:r}){return a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:t.code}),a.jsx("td",{className:"px-3 py-2",children:t.name}),a.jsx("td",{className:"px-3 py-2",children:t.modality||""}),a.jsx("td",{className:"px-3 py-2",children:Number(t.price||0).toFixed(2)}),a.jsx("td",{className:"px-3 py-2 text-right",children:a.jsxs(Nr,{anyOf:["radiology.masters.manage","masters.ris.manage"],children:[a.jsx("button",{className:"btn-ghost mr-2",onClick:()=>n(t),children:"Edit"}),a.jsx("button",{className:"btn-ghost text-rose-600",onClick:()=>r(t),children:"Delete"})]})})]})}function Lme(){const[t,n]=b.useState([]),[r,s]=b.useState(!0),[i,o]=b.useState(""),[l,c]=b.useState({code:"",name:"",modality:"",price:0}),[d,u]=b.useState(null),h=async()=>{var N,j;s(!0);try{const{data:S}=await cF({q:i,page_size:100});n(Array.isArray(S)?S:(S==null?void 0:S.items)||[])}catch(S){fe.error(((j=(N=S==null?void 0:S.response)==null?void 0:N.data)==null?void 0:j.detail)||"Failed to load")}finally{s(!1)}};b.useEffect(()=>{h()},[i]);const m=async()=>{var N,j;try{d?(await wme(d,l),fe.success("Updated")):(await bme(l),fe.success("Created")),c({code:"",name:"",modality:"",price:0}),u(null),h()}catch(S){fe.error(((j=(N=S==null?void 0:S.response)==null?void 0:N.data)==null?void 0:j.detail)||"Save failed")}},g=N=>{u(N.id),c({code:N.code,name:N.name,modality:N.modality||"",price:N.price||0})},y=async N=>{var j,S;if(window.confirm(`Delete ${N.code}?`))try{await Nme(N.id),fe.success("Deleted"),h()}catch(_){fe.error(((S=(j=_==null?void 0:_.response)==null?void 0:j.data)==null?void 0:S.detail)||"Delete failed")}};return a.jsxs("div",{className:"space-y-5 text-black",children:[a.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-semibold",children:"RIS Masters"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Manage radiology tests & modalities."})]}),a.jsx("input",{className:"input w-60",placeholder:"Search code/name",value:i,onChange:N=>o(N.target.value)})]}),a.jsx(Nr,{anyOf:["radiology.masters.manage","masters.ris.manage"],children:a.jsxs("div",{className:"rounded-2xl border bg-white p-4",children:[a.jsx("h3",{className:"text-sm font-semibold mb-3",children:d?"Edit Test":"New Test"}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[a.jsx("input",{className:"input",placeholder:"Code",value:l.code,onChange:N=>c(j=>({...j,code:N.target.value}))}),a.jsx("input",{className:"input",placeholder:"Name",value:l.name,onChange:N=>c(j=>({...j,name:N.target.value}))}),a.jsx("input",{className:"input",placeholder:"Modality (XR/CT/MRI/USG)",value:l.modality,onChange:N=>c(j=>({...j,modality:N.target.value}))}),a.jsx("input",{className:"input",placeholder:"Price",type:"number",step:"0.01",value:l.price,onChange:N=>c(j=>({...j,price:N.target.value}))})]}),a.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[a.jsx("button",{className:"btn",onClick:m,children:d?"Update":"Create"}),d&&a.jsx("button",{className:"btn-ghost",onClick:()=>{u(null),c({code:"",name:"",modality:"",price:0})},children:"Cancel"})]})]})}),a.jsx("div",{className:"rounded-xl border bg-white",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50 text-gray-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"Code"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Name"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Modality"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Price"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[r&&a.jsx("tr",{children:a.jsx("td",{className:"px-3 py-3",colSpan:5,children:"Loading"})}),!r&&t.map(N=>a.jsx(Rme,{t:N,onEdit:g,onDelete:y},N.id)),!r&&t.length===0&&a.jsx("tr",{children:a.jsx("td",{className:"px-3 py-6 text-center text-gray-500",colSpan:5,children:"No tests"})})]})]})})]})}const Vl=t=>t?new Date(t).toLocaleString():"";function Bme(){const{id:t}=Su(),[n,r]=b.useState(null),[s,i]=b.useState(!0),[o,l]=b.useState(""),[c,d]=b.useState(""),[u,h]=b.useState(!1),[m,g]=b.useState([]),y=async()=>{var T,P;i(!0);try{const{data:M}=await Cme(t);r(M),d((M==null?void 0:M.report_text)||"")}catch(M){fe.error(((P=(T=M==null?void 0:M.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to load order")}finally{i(!1)}};b.useEffect(()=>{y()},[t]);const N=async()=>{var T,P;if(!o)return fe.error("Pick a date & time");try{await _me(n.id,{scheduled_at:o}),fe.success("Scheduled"),y()}catch(M){fe.error(((P=(T=M==null?void 0:M.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to schedule")}},j=async()=>{var T,P;try{await Ame(n.id),fe.success("Marked scanned"),y()}catch(M){fe.error(((P=(T=M==null?void 0:M.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to mark scanned")}},S=async()=>{var T,P;h(!0);try{n.status==="reported"||n.status==="approved"?await kme(n.id,{report_text:c}):await Eme(n.id,{report_text:c}),fe.success("Report saved"),y()}catch(M){fe.error(((P=(T=M==null?void 0:M.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to save report")}finally{h(!1)}},_=async()=>{var T,P;try{await Tme(n.id),fe.success("Report approved"),y()}catch(M){fe.error(((P=(T=M==null?void 0:M.response)==null?void 0:T.data)==null?void 0:P.detail)||"Approval failed")}},A=async T=>{var M,O,D;const P=(M=T.target.files)==null?void 0:M[0];if(P)try{const{data:L}=await Pme(n.id,P);g($=>[{file_url:L==null?void 0:L.file_url,note:P.name},...$]),fe.success("Attachment uploaded")}catch(L){fe.error(((D=(O=L==null?void 0:L.response)==null?void 0:O.data)==null?void 0:D.detail)||"Upload failed")}finally{T.target.value=""}},k=async()=>{var P,M;const T=prompt("Paste file URL");if(T)try{const{data:O}=await Ime(n.id,T,"Link");g(D=>[{file_url:(O==null?void 0:O.file_url)||T,note:"Link"},...D]),fe.success("Attachment linked")}catch(O){fe.error(((M=(P=O==null?void 0:O.response)==null?void 0:P.data)==null?void 0:M.detail)||"Link failed")}};return s?a.jsx("div",{children:"Loading"}):n?a.jsxs("div",{className:"space-y-6 text-black",children:[a.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-xl font-semibold",children:["Radiology Order ",a.jsx($A,{order:n,prefix:"RAD"})]}),a.jsxs("div",{className:"text-xs text-gray-500",children:["Patient: ",a.jsx(Rv,{patientId:n.patient_id}),"  Created: ",Vl(n.created_at)]}),a.jsxs("div",{className:"text-xs text-gray-500",children:["Modality: ",a.jsx(dF,{modality:n.modality}),"  Status: ",a.jsx(zA,{status:n.status})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Nr,{anyOf:["radiology.report.create"],children:a.jsx("button",{className:"btn",onClick:S,disabled:u,children:u?"Saving":"Save Report"})}),a.jsx(Nr,{anyOf:["radiology.report.approve"],children:a.jsxs("button",{className:"btn",onClick:_,children:[a.jsx(pv,{className:"h-4 w-4 mr-2"})," Approve"]})})]})]}),a.jsxs("section",{className:"rounded-2xl border bg-white p-4 space-y-4",children:[a.jsx("h2",{className:"text-sm font-semibold",children:"Workflow"}),a.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[a.jsxs("div",{className:"rounded-xl border p-3",children:[a.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[a.jsx(ci,{className:"h-4 w-4"})," Schedule"]}),a.jsxs("div",{className:"mt-2 space-y-2",children:[a.jsx("input",{type:"datetime-local",className:"input w-full",value:o,onChange:T=>l(T.target.value)}),a.jsx(Nr,{anyOf:["radiology.schedule.manage"],children:a.jsx("button",{className:"btn w-full",onClick:N,children:"Book Slot"})}),a.jsxs("div",{className:"text-xs text-gray-500",children:["Current: ",Vl(n.scheduled_at)]})]})]}),a.jsxs("div",{className:"rounded-xl border p-3",children:[a.jsx("div",{className:"flex items-center gap-2 font-medium",children:"Scan"}),a.jsxs("div",{className:"mt-2 grid gap-2",children:[a.jsx(Nr,{anyOf:["radiology.scan.update"],children:a.jsx("button",{className:"btn w-full",onClick:j,children:"Mark Scanned"})}),a.jsxs("div",{className:"text-xs text-gray-500",children:["Scanned: ",Vl(n.scanned_at)]})]})]}),a.jsxs("div",{className:"rounded-xl border p-3",children:[a.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[a.jsx(N1,{className:"h-4 w-4"})," Attachments"]}),a.jsxs("div",{className:"mt-2 grid gap-2",children:[a.jsx("input",{type:"file",onChange:A}),a.jsx("button",{className:"btn-ghost text-left",onClick:k,children:"Add link"}),a.jsxs("div",{className:"mt-2 space-y-1",children:[m.map((T,P)=>a.jsx("a",{href:T.file_url,className:"text-xs text-blue-700 underline",target:"_blank",rel:"noreferrer",children:T.note||T.file_url},P)),m.length===0&&a.jsx("div",{className:"text-xs text-gray-500",children:"No attachments (local list)"})]})]})]})]})]}),a.jsxs("section",{className:"rounded-2xl border bg-white p-4 space-y-3",children:[a.jsx("h2",{className:"text-sm font-semibold",children:"Report"}),a.jsx("textarea",{className:"input min-h-[200px]",placeholder:"Enter radiology report text",value:c,onChange:T=>d(T.target.value)}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs text-gray-600",children:[a.jsxs("div",{children:["Ordered: ",Vl(n.created_at)]}),a.jsxs("div",{children:["Scheduled: ",Vl(n.scheduled_at)]}),a.jsxs("div",{children:["Scanned: ",Vl(n.scanned_at)]}),a.jsxs("div",{children:["Reported: ",Vl(n.reported_at)]}),a.jsxs("div",{children:["Approved: ",Vl(n.approved_at)]})]})]})]}):a.jsx("div",{className:"text-sm text-gray-500",children:"Order not found"})}const uF=(t={})=>te.get("/ot/masters/surgeries",{params:t}),Fme=t=>te.post("/ot/masters/surgeries",t),$me=(t,n)=>te.put(`/ot/masters/surgeries/${t}`,n),zme=t=>te.delete(`/ot/masters/surgeries/${t}`),Ume=(t={})=>te.get("/ot/orders",{params:t}),Vme=t=>te.get(`/ot/orders/${t}`),Hme=t=>te.post("/ot/orders",t),Wme=(t,n)=>te.post(`/ot/orders/${t}/schedule`,n),qme=(t,n)=>te.post(`/ot/orders/${t}/status`,{status:n}),Gme=(t,n,r="")=>{const s=new FormData;return s.append("file",n),r&&s.append("note",r),te.post(`/ot/orders/${t}/upload`,s,{headers:{"Content-Type":"multipart/form-data"}})},Kme=(t,n)=>te.post(`/ot/orders/${t}/attachments`,n);function Yme({open:t,onClose:n}){const r=Hi(),s=Cr(D=>D.user),[i,o]=b.useState(null),[l,c]=b.useState(""),[d,u]=b.useState([]),[h,m]=b.useState(""),[g,y]=b.useState(""),[N,j]=b.useState(""),[S,_]=b.useState(""),[A,k]=b.useState(""),[T,P]=b.useState(!1);b.useEffect(()=>{if(!t)return;let D=!0;return(async()=>{try{const{data:$}=await uF({q:l,page_size:50,active:!0});if(!D)return;u(($==null?void 0:$.items)||[])}catch{}})(),()=>{D=!1}},[t,l]);const M=b.useMemo(()=>i&&(h||g.trim().length>0),[i,h,g]),O=async()=>{var D,L;if(M){P(!0);try{const $={patient_id:i,context_type:"ipd",context_id:null,surgery_master_id:h?Number(h):null,surgery_name:h?null:g.trim(),estimated_cost:N?Number(N):null,surgeon_id:null,anaesthetist_id:null,scheduled_start:S||null,scheduled_end:A||null,ordering_user_id:s==null?void 0:s.id},{data:V}=await Hme($);fe.success("OT order created"),n==null||n(),r(`/ot/orders/${V.id}`)}catch($){const V=((L=(D=$==null?void 0:$.response)==null?void 0:D.data)==null?void 0:L.detail)||"Failed to create OT order";fe.error(V)}finally{P(!1)}}};return t?a.jsx("div",{className:"fixed inset-0 z-50 grid place-items-end md:place-items-center bg-black/30 backdrop-blur-sm p-3",children:a.jsxs("div",{className:"w-full max-w-3xl rounded-2xl bg-white shadow-xl",children:[a.jsxs("header",{className:"flex items-center justify-between border-b p-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"New OT Order"}),a.jsx("button",{className:"btn-ghost",onClick:()=>n==null?void 0:n(),children:"Close"})]}),a.jsxs("div",{className:"p-4 space-y-5",children:[a.jsx(yx,{value:i,onChange:o}),a.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Choose Surgery (Master)"}),a.jsx("input",{className:"input",placeholder:"Search master list",value:l,onChange:D=>c(D.target.value)}),a.jsxs("select",{className:"input",value:h,onChange:D=>m(D.target.value),children:[a.jsx("option",{value:"",children:" Select from master "}),d.map(D=>a.jsxs("option",{value:D.id,children:[D.code,"  ",D.name," (",Number(D.default_cost||0).toFixed(2),")"]},D.id))]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"OR enter Custom Surgery"}),a.jsx("input",{className:"input",placeholder:"e.g., Laparoscopic Cholecystectomy",value:g,onChange:D=>y(D.target.value),disabled:!!h}),a.jsx("label",{className:"text-sm font-medium",children:"Estimated Cost (optional)"}),a.jsx("input",{className:"input",type:"number",min:"0",value:N,onChange:D=>j(D.target.value)})]})]}),a.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"text-sm font-medium inline-flex items-center gap-2",children:[a.jsx(g1,{className:"h-4 w-4"})," Scheduled Start (optional)"]}),a.jsx("input",{className:"input",type:"datetime-local",value:S,onChange:D=>_(D.target.value)})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Scheduled End (optional)"}),a.jsx("input",{className:"input",type:"datetime-local",value:A,onChange:D=>k(D.target.value)})]})]})]}),a.jsxs("footer",{className:"flex items-center justify-end gap-2 border-t p-4",children:[a.jsx("button",{className:"btn-ghost",onClick:()=>n==null?void 0:n(),children:"Cancel"}),a.jsxs("button",{className:"btn",disabled:!M||T,onClick:O,children:[a.jsx(or,{className:"h-4 w-4 mr-2"})," Create Order"]})]})]})}):null}function fF({id:t}){const[n,r]=b.useState(null);return b.useEffect(()=>{let s=!0;return(async()=>{if(t)try{const{data:o}=await te.get(`/patients/${t}`);if(!s)return;const l=[o.first_name,o.last_name].filter(Boolean).join(" ");r(`${o.uhid||"UHID"}  ${l||"Name"}`)}catch{r(`#${t}`)}})(),()=>{s=!1}},[t]),a.jsx("span",{children:n||""})}const Xme=["planned","scheduled","in_progress","completed","cancelled"],Qme=t=>{if(!t)return"";try{return new Date(t).toLocaleString()}catch{return t}};function Zme(){const[t,n]=b.useState([]),[r,s]=b.useState("planned"),[i,o]=b.useState(""),[l,c]=b.useState(!1),[d,u]=b.useState(!1),h=ks("ot.cases.create")||ks("ipd.manage"),m=async()=>{var y,N;c(!0);try{const j={status:r,limit:200};i&&(j.q=i);const{data:S}=await Ume(j);n(Array.isArray(S)?S:[])}catch(j){fe.error(((N=(y=j==null?void 0:j.response)==null?void 0:y.data)==null?void 0:N.detail)||"Failed to load OT orders")}finally{c(!1)}};b.useEffect(()=>{m()},[r]);const g=b.useMemo(()=>t.length,[t]);return a.jsxs("div",{className:"p-4 space-y-6 text-black",children:[a.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-semibold",children:"OT Orders"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Plan, schedule and track surgical cases"})]}),a.jsx("div",{className:"flex items-center gap-2",children:h&&a.jsxs("button",{className:"btn",onClick:()=>u(!0),children:[a.jsx(or,{className:"h-4 w-4 mr-2"})," New OT Order"]})})]}),a.jsxs("div",{className:"grid gap-3 sm:grid-cols-[1fr_auto]",children:[a.jsxs("div",{className:"relative",children:[a.jsx(ur,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),a.jsx("input",{className:"input pl-9",placeholder:"Search text (test name/code not indexed here, use status filters)",value:i,onChange:y=>o(y.target.value),onKeyDown:y=>y.key==="Enter"&&m()})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("select",{className:"input",value:r,onChange:y=>s(y.target.value),children:Xme.map(y=>a.jsx("option",{value:y,children:y},y))}),a.jsx("button",{className:"btn-ghost",onClick:m,children:"Refresh"})]})]}),a.jsx("div",{className:"rounded-xl border bg-white overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50 text-gray-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"Case #"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Patient"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Surgery"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Status"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Scheduled"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[l&&a.jsx("tr",{children:a.jsx("td",{className:"px-3 py-3",colSpan:6,children:"Loading"})}),!l&&t.map(y=>a.jsxs("tr",{className:"border-t",children:[a.jsxs("td",{className:"px-3 py-2",children:["#",y.id]}),a.jsx("td",{className:"px-3 py-2",children:a.jsx(fF,{id:y.patient_id})}),a.jsx("td",{className:"px-3 py-2",children:y.surgery_name||""}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("span",{className:"inline-block rounded-full bg-gray-100 px-2 py-0.5 text-xs capitalize",children:y.status})}),a.jsx("td",{className:"px-3 py-2",children:Qme(y.scheduled_start)}),a.jsx("td",{className:"px-3 py-2 text-right",children:a.jsx(So,{to:`/ot/orders/${y.id}`,className:"btn-ghost",children:"View"})})]},y.id)),!l&&t.length===0&&a.jsx("tr",{children:a.jsx("td",{className:"px-3 py-6 text-center text-gray-500",colSpan:6,children:"No OT orders"})})]}),a.jsx("tfoot",{children:a.jsx("tr",{children:a.jsxs("td",{className:"px-3 py-2 text-xs text-gray-500",colSpan:6,children:["Total: ",g]})})})]})}),a.jsx(Yme,{open:d,onClose:()=>u(!1)})]})}const dd=t=>{if(!t)return"";try{return new Date(t).toLocaleString()}catch{return t}},Jme=t=>{const n=(t||"").toLowerCase();return n==="planned"?["scheduled","in_progress","cancelled"]:n==="scheduled"?["in_progress","cancelled"]:n==="in_progress"?["completed","cancelled"]:[]};function epe(){const{id:t}=Su(),[n,r]=b.useState(null),[s,i]=b.useState(!0),[o,l]=b.useState(!1),c=ks("ot.cases.update"),d=ks("ot.cases.update")||ks("ot.masters.manage"),u=async()=>{var D,L;i(!0);try{const{data:$}=await Vme(t);r($)}catch($){fe.error(((L=(D=$==null?void 0:$.response)==null?void 0:D.data)==null?void 0:L.detail)||"Failed to load order")}finally{i(!1)}};b.useEffect(()=>{u()},[t]),b.useEffect(()=>{try{const L=(te.defaults.baseURL||"").replace(/^http/,"ws"),$=new WebSocket(`${L}/ot/ws`);return $.onmessage=V=>{var F;try{const Q=JSON.parse(V.data);if(!((F=Q==null?void 0:Q.type)!=null&&F.startsWith("ot."))||String(Q==null?void 0:Q.order_id)!==String(t))return;u()}catch{}},()=>$.close()}catch{}},[t]);const[h,m]=b.useState(""),[g,y]=b.useState(""),N=async()=>{var D,L;if(!h)return fe.error("Start time required");l(!0);try{await Wme(t,{scheduled_start:h,scheduled_end:g||null}),fe.success("Scheduled"),m(""),y(""),await u()}catch($){fe.error(((L=(D=$==null?void 0:$.response)==null?void 0:D.data)==null?void 0:L.detail)||"Failed to schedule")}finally{l(!1)}},j=async D=>{var L,$;l(!0);try{await qme(t,D),fe.success(`Status: ${D}`),await u()}catch(V){fe.error((($=(L=V==null?void 0:V.response)==null?void 0:L.data)==null?void 0:$.detail)||"Failed to update status")}finally{l(!1)}},[S,_]=b.useState(""),A=b.useRef(null),k=async D=>{var $,V,F;const L=($=D.target.files)==null?void 0:$[0];if(L){l(!0);try{await Gme(t,L,S),fe.success("File uploaded"),_(""),A.current.value="",await u()}catch(Q){fe.error(((F=(V=Q==null?void 0:Q.response)==null?void 0:V.data)==null?void 0:F.detail)||"Upload failed")}finally{l(!1)}}},[T,P]=b.useState(""),M=async()=>{var D,L;if(T.trim()){l(!0);try{await Kme(t,{file_url:T.trim(),note:S}),fe.success("Link added"),P(""),_(""),await u()}catch($){fe.error(((L=(D=$==null?void 0:$.response)==null?void 0:D.data)==null?void 0:L.detail)||"Failed to add link")}finally{l(!1)}}};if(s)return a.jsx("div",{className:"p-4",children:"Loading"});if(!n)return a.jsx("div",{className:"p-4",children:"Not found"});const O=Jme(n.status);return a.jsxs("div",{className:"p-4 space-y-6 text-black",children:[a.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-xl font-semibold",children:["OT Case #",n.id]}),a.jsxs("div",{className:"text-xs text-gray-500",children:["Patient: ",a.jsx(fF,{id:n.patient_id}),"  Created: ",dd(n.created_at)]}),a.jsxs("div",{className:"text-xs text-gray-500",children:["Surgery: ",a.jsx("span",{className:"font-medium",children:n.surgery_name||""}),"  Status: ",a.jsx("span",{className:"capitalize",children:n.status})]})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs("button",{className:"btn-ghost",onClick:()=>u(),children:[a.jsx(wL,{className:"h-4 w-4 mr-2"})," Refresh"]}),c&&O.includes("scheduled")&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"datetime-local",className:"input",value:h,onChange:D=>m(D.target.value)}),a.jsx("input",{type:"datetime-local",className:"input",value:g,onChange:D=>y(D.target.value)}),a.jsxs("button",{className:"btn",disabled:o,onClick:N,children:[a.jsx(g1,{className:"h-4 w-4 mr-2"})," Schedule"]})]}),c&&O.includes("in_progress")&&a.jsxs("button",{className:"btn",disabled:o,onClick:()=>j("in_progress"),children:[a.jsx(jte,{className:"h-4 w-4 mr-2"})," Start"]}),c&&O.includes("completed")&&a.jsxs("button",{className:"btn",disabled:o,onClick:()=>j("completed"),children:[a.jsx(pv,{className:"h-4 w-4 mr-2"})," Complete"]}),c&&O.includes("cancelled")&&a.jsxs("button",{className:"btn-ghost",disabled:o,onClick:()=>j("cancelled"),children:[a.jsx(La,{className:"h-4 w-4 mr-2"})," Cancel"]})]})]}),a.jsxs("section",{className:"rounded-xl border bg-white p-4",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Timing"}),a.jsxs("div",{className:"grid gap-3 sm:grid-cols-2 md:grid-cols-3",children:[a.jsx(lm,{label:"Scheduled Start",value:dd(n.scheduled_start)}),a.jsx(lm,{label:"Scheduled End",value:dd(n.scheduled_end)}),a.jsx(lm,{label:"Actual Start",value:dd(n.actual_start)}),a.jsx(lm,{label:"Actual End",value:dd(n.actual_end)}),a.jsx(lm,{label:"Updated",value:dd(n.updated_at)})]})]}),a.jsxs("section",{className:"rounded-xl border bg-white p-4 space-y-4",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsx("h3",{className:"font-medium",children:"Attachments & Anaesthesia Records"})}),d&&a.jsxs("div",{className:"grid gap-3 md:grid-cols-[1fr_auto]",children:[a.jsxs("div",{className:"grid gap-2 sm:grid-cols-[2fr_1fr]",children:[a.jsx("input",{type:"file",ref:A,className:"input",onChange:k,"aria-label":"Upload file"}),a.jsx("input",{className:"input",placeholder:"Note (e.g., Anaesthesia chart, Consent, OT notes)",value:S,onChange:D=>_(D.target.value)})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{className:"input",placeholder:"or paste link (https://...)",value:T,onChange:D=>P(D.target.value)}),a.jsxs("button",{className:"btn-ghost",disabled:o,onClick:M,children:[a.jsx(bL,{className:"h-4 w-4 mr-2"})," Add Link"]})]})]}),a.jsxs("div",{className:"rounded-lg border bg-gray-50",children:[a.jsx("div",{className:"p-3 text-sm text-gray-600",children:"Upload anaesthesia records, OT notes, scanned consent forms and other reports. Images & PDFs can be previewed and downloaded for NABH audit."}),Array.isArray(n.attachments)&&n.attachments.length>0?a.jsx("div",{className:"divide-y border-t bg-white",children:n.attachments.map(D=>{const L=D.file_url||D.url,$=L&&/\.(png|jpe?g|gif|webp)$/i.test(L),V=L&&/\.pdf(\?|$)/i.test(L);return a.jsxs("div",{className:"p-3 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-medium break-all",children:D.note||"Attachment"}),a.jsx("div",{className:"text-xs text-gray-500 break-all",children:L}),a.jsxs("div",{className:"text-xs text-gray-400 mt-0.5",children:["Added: ",dd(D.created_at)]}),$&&a.jsx("div",{className:"mt-2",children:a.jsx("img",{src:L,alt:D.note||"attachment preview",className:"max-h-32 rounded border"})}),V&&a.jsx("div",{className:"mt-2",children:a.jsx("iframe",{src:L,title:"Attachment preview",className:"h-40 w-full rounded border"})})]}),a.jsxs("div",{className:"flex gap-2 sm:flex-col md:flex-row sm:items-end sm:justify-end shrink-0",children:[a.jsx("a",{href:L,target:"_blank",rel:"noreferrer",className:"btn-ghost text-xs",children:"Open"}),a.jsx("a",{href:L,download:!0,className:"btn text-xs",children:"Download"})]})]},D.id)})}):a.jsx("div",{className:"p-3 text-xs text-gray-400 border-t",children:"No attachments yet for this OT case."})]})]})]})}function lm({label:t,value:n}){return a.jsxs("div",{className:"rounded-lg border bg-gray-50 px-3 py-2",children:[a.jsx("div",{className:"text-xs text-gray-500",children:t}),a.jsx("div",{className:"text-sm",children:n||""})]})}function tpe(){const t=ks("ot.masters.manage")||ks("ot.masters.view"),n=ks("ot.masters.manage"),[r,s]=b.useState([]),[i,o]=b.useState(""),[l,c]=b.useState(!0),d=async()=>{var _,A;c(!0);try{const{data:k}=await uF({q:i,page:1,page_size:100});s(k.items||[])}catch(k){fe.error(((A=(_=k==null?void 0:k.response)==null?void 0:_.data)==null?void 0:A.detail)||"Failed to load surgeries")}finally{c(!1)}};b.useEffect(()=>{d()},[]);const[u,h]=b.useState({id:null,code:"",name:"",default_cost:"",hourly_cost:"",active:!0}),[m,g]=b.useState(!1),y=()=>{h({id:null,code:"",name:"",default_cost:"",hourly_cost:"",active:!0}),g(!0)},N=_=>{h({id:_.id,code:_.code||"",name:_.name||"",default_cost:_.default_cost===null||_.default_cost===void 0?"":_.default_cost,hourly_cost:_.hourly_cost===null||_.hourly_cost===void 0?"":_.hourly_cost,active:!!_.active}),g(!0)},j=async()=>{var _,A;if(!u.code.trim()||!u.name.trim())return fe.error("Code and Name are required");try{const k={code:u.code.trim(),name:u.name.trim(),default_cost:Number(u.default_cost||0),hourly_cost:Number(u.hourly_cost||0),active:!!u.active};u.id?(await $me(u.id,k),fe.success("Updated")):(await Fme(k),fe.success("Created")),g(!1),await d()}catch(k){fe.error(((A=(_=k==null?void 0:k.response)==null?void 0:_.data)==null?void 0:A.detail)||"Save failed")}},S=async _=>{var A,k;if(confirm("Delete this surgery master?"))try{await zme(_),fe.success("Deleted"),await d()}catch(T){fe.error(((k=(A=T==null?void 0:T.response)==null?void 0:A.data)==null?void 0:k.detail)||"Delete failed")}};return t?a.jsxs("div",{className:"p-4 space-y-4 text-black",children:[a.jsxs("header",{className:"flex items-center justify-between gap-3",children:[a.jsx("h1",{className:"text-xl font-semibold",children:"OT Masters"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{className:"input",placeholder:"Search name/code",value:i,onChange:_=>o(_.target.value)}),a.jsxs("button",{className:"btn-ghost",onClick:d,children:[a.jsx(wL,{className:"h-4 w-4 mr-2"}),"Refresh"]}),n&&a.jsxs("button",{className:"btn",onClick:y,children:[a.jsx(or,{className:"h-4 w-4 mr-2"}),"New Surgery"]})]})]}),a.jsx("div",{className:"rounded-xl border bg-white overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50 text-gray-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"Code"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Name"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Package Cost"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"OT Hourly Cost"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Active"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[l&&a.jsx("tr",{children:a.jsx("td",{className:"px-3 py-3",colSpan:6,children:"Loading"})}),!l&&r.map(_=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:_.code}),a.jsx("td",{className:"px-3 py-2",children:_.name}),a.jsxs("td",{className:"px-3 py-2",children:[""," ",Number(_.default_cost||0).toFixed(2)]}),a.jsxs("td",{className:"px-3 py-2",children:[""," ",Number(_.hourly_cost||0).toFixed(2)," ","/ hr"]}),a.jsx("td",{className:"px-3 py-2",children:_.active?"Yes":"No"}),a.jsx("td",{className:"px-3 py-2 text-right",children:n&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"btn-ghost mr-2",onClick:()=>N(_),children:a.jsx(Co,{className:"h-4 w-4"})}),a.jsx("button",{className:"btn-ghost text-red-600",onClick:()=>S(_.id),children:a.jsx(_l,{className:"h-4 w-4"})})]})})]},_.id)),!l&&r.length===0&&a.jsx("tr",{children:a.jsx("td",{className:"px-3 py-6 text-center text-gray-500",colSpan:6,children:"No items"})})]})]})}),m&&a.jsx("div",{className:"fixed inset-0 z-50 grid place-items-center bg-black/40 p-4",onClick:()=>g(!1),children:a.jsxs("div",{className:"w-full max-w-lg rounded-xl border bg-white p-4",onClick:_=>_.stopPropagation(),children:[a.jsx("h3",{className:"font-medium mb-3",children:u.id?"Edit Surgery":"New Surgery"}),a.jsxs("div",{className:"grid gap-3",children:[a.jsx("input",{className:"input",placeholder:"Code",value:u.code,onChange:_=>h(A=>({...A,code:_.target.value}))}),a.jsx("input",{className:"input",placeholder:"Name",value:u.name,onChange:_=>h(A=>({...A,name:_.target.value}))}),a.jsx("input",{className:"input",placeholder:"Package Cost",type:"number",value:u.default_cost,onChange:_=>h(A=>({...A,default_cost:_.target.value}))}),a.jsx("input",{className:"input",placeholder:"OT Hourly Cost (/hour)",type:"number",value:u.hourly_cost,onChange:_=>h(A=>({...A,hourly_cost:_.target.value}))}),a.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",checked:!!u.active,onChange:_=>h(A=>({...A,active:_.target.checked}))}),"Active"]})]}),a.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[a.jsx("button",{className:"btn-ghost",onClick:()=>g(!1),children:"Cancel"}),a.jsx("button",{className:"btn",onClick:j,children:"Save"})]})]})})]}):a.jsx("div",{className:"p-4 text-sm text-gray-500",children:"You do not have permission to view OT Masters."})}function npe(t){return te.post("/billing/invoices",t)}function rpe(t){return te.get(`/billing/invoices/${t}`)}function spe(t={}){return te.get("/billing/invoices",{params:t})}function ape(t,n){return te.put(`/billing/invoices/${t}`,n)}function ipe(t){return te.post(`/billing/invoices/${t}/finalize`)}function ope(t){return te.post(`/billing/invoices/${t}/cancel`)}function MP(t,n){return te.post(`/billing/invoices/${t}/items/manual`,n)}function lpe(t,n,r){return te.put(`/billing/invoices/${t}/items/${n}`,r)}function cpe(t,n,r){return te.post(`/billing/invoices/${t}/items/${n}/void`,r)}function dpe(t,n){return te.post(`/billing/invoices/${t}/payments`,n)}function upe(t,n){return te.delete(`/billing/invoices/${t}/payments/${n}`)}function fpe(t,n={}){return te.post(`/billing/invoices/${t}/apply-advances`,n)}function UA(){return te.get("/billing/masters")}function hpe(t){return te.get(`/billing/patients/${t}/summary`)}function mpe(t){return te.get(`/billing/invoices/${t}/print`,{responseType:"blob"})}function ppe(t){return te.get(`/billing/patients/${t}/print-summary`,{responseType:"blob"})}function Or(t){return Number(t||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}function xpe(){var tr,In;const{invoiceId:t}=Su(),n=Hi(),[r,s]=b.useState(null),[i,o]=b.useState({doctors:[],credit_providers:[],packages:[],payers:[],tpas:[],credit_plans:[]}),[l,c]=b.useState(!0),[d,u]=b.useState(!1),[h,m]=b.useState({}),[g,y]=b.useState(!1),[N,j]=b.useState({description:"",quantity:1,unit_price:"",tax_rate:0,discount_percent:0,discount_amount:""}),[S,_]=b.useState(null),[A,k]=b.useState({description:"",quantity:1,unit_price:"",tax_rate:0,discount_percent:0,discount_amount:""}),[T,P]=b.useState(!1),[M,O]=b.useState({amount:"",mode:"cash",reference_no:"",notes:""}),[D,L]=b.useState(!1),[$,V]=b.useState(""),[F,Q]=b.useState(""),[U,z]=b.useState(null),[q,K]=b.useState(!1),X=(r==null?void 0:r.status)==="finalized"||(r==null?void 0:r.status)==="cancelled";b.useEffect(()=>{J()},[]),b.useEffect(()=>{t&&Se()},[t]);async function J(){try{const{data:me}=await UA();o({doctors:(me==null?void 0:me.doctors)||[],credit_providers:(me==null?void 0:me.credit_providers)||[],packages:(me==null?void 0:me.packages)||[],payers:(me==null?void 0:me.payers)||[],tpas:(me==null?void 0:me.tpas)||[],credit_plans:(me==null?void 0:me.credit_plans)||[]})}catch(me){console.error("Failed to load masters",me)}}async function ne(me){if(me){K(!0);try{const{data:tt}=await hpe(me);z(tt)}catch(tt){console.error("Failed to load patient billing summary",tt)}finally{K(!1)}}}async function Se(){c(!0),Q("");try{const{data:me}=await rpe(t);s(me),m({billing_type:me.billing_type||"general",consultant_id:me.consultant_id||"",provider_id:me.provider_id||"",visit_no:me.visit_no||"",remarks:me.remarks||"",header_discount_percent:me.header_discount_percent??"",header_discount_amount:me.header_discount_amount??"",discount_remarks:me.discount_remarks||""}),await ne(me.patient_id)}catch(me){console.error("Failed to load invoice",me),Q("Unable to load invoice. Please go back and try again.")}finally{c(!1)}}function de(me){const{name:tt,value:Et}=me.target;m(Ft=>({...Ft,[tt]:Et}))}async function ye(){if(r){u(!0),Q("");try{const me={billing_type:h.billing_type||null,consultant_id:h.consultant_id?Number(h.consultant_id):null,provider_id:h.provider_id?Number(h.provider_id):null,visit_no:h.visit_no||null,remarks:h.remarks||null,header_discount_percent:h.header_discount_percent!==""&&h.header_discount_percent!==null?Number(h.header_discount_percent):null,header_discount_amount:h.header_discount_amount!==""&&h.header_discount_amount!==null?Number(h.header_discount_amount):null,discount_remarks:h.discount_remarks||null},{data:tt}=await ape(r.id,me);s(tt),m(Et=>({...Et,header_discount_percent:tt.header_discount_percent??"",header_discount_amount:tt.header_discount_amount??""}))}catch(me){console.error("Save header failed",me),Q("Unable to save header details.")}finally{u(!1)}}}function be(me){const{name:tt,value:Et}=me.target;j(Ft=>({...Ft,[tt]:tt==="quantity"||tt==="tax_rate"||tt==="discount_percent"?Number(Et):Et}))}async function xe(me){if(me.preventDefault(),!!r){Q("");try{const tt={description:N.description||"",quantity:N.quantity||1,unit_price:Number(N.unit_price||0),tax_rate:Number(N.tax_rate||0),discount_percent:Number(N.discount_percent||0),discount_amount:N.discount_amount!==""?Number(N.discount_amount||0):void 0},{data:Et}=await MP(r.id,tt);s(Et),y(!1),j({description:"",quantity:1,unit_price:"",tax_rate:0,discount_percent:0,discount_amount:""})}catch(tt){console.error("Add manual item failed",tt),Q("Unable to add manual item. Please check values.")}}}function _e(me){_(me.id),k({description:me.description||"",quantity:me.quantity||1,unit_price:String(me.unit_price||""),tax_rate:Number(me.tax_rate||0),discount_percent:Number(me.discount_percent||0),discount_amount:me.discount_amount!==null&&me.discount_amount!==void 0?String(me.discount_amount):""})}function we(me){const{name:tt,value:Et}=me.target;k(Ft=>({...Ft,[tt]:tt==="quantity"||tt==="tax_rate"||tt==="discount_percent"?Number(Et):Et}))}async function Oe(me){if(me.preventDefault(),!(!r||!S))try{const tt={description:A.description||"",quantity:A.quantity||1,unit_price:Number(A.unit_price||0),tax_rate:Number(A.tax_rate||0),discount_percent:Number(A.discount_percent||0),discount_amount:A.discount_amount!==""?Number(A.discount_amount||0):void 0},{data:Et}=await lpe(r.id,S,tt);s(Et),_(null)}catch(tt){console.error("Update item failed",tt),Q("Unable to update item.")}}async function ae(me){if(!(!r||!window.confirm("Void this line item?")))try{const{data:Et}=await cpe(r.id,me.id,{reason:"Voided from UI"});s(Et)}catch(Et){console.error("Void item failed",Et),Q("Unable to void item.")}}function ie(me){const{name:tt,value:Et}=me.target;O(Ft=>({...Ft,[tt]:Et}))}async function pe(me){if(me.preventDefault(),!!r){Q("");try{let tt=Number(M.amount||0);D&&(tt=-Math.abs(tt));const Et={amount:tt,mode:D?"refund":M.mode,reference_no:M.reference_no||null,notes:M.notes||null},{data:Ft}=await dpe(r.id,Et);s(Ft),P(!1),L(!1),O({amount:"",mode:"cash",reference_no:"",notes:""})}catch(tt){console.error("Add payment/refund failed",tt),Q("Unable to save payment / refund.")}}}async function re(me){if(!(!r||!window.confirm("Delete this payment?")))try{const{data:Et}=await upe(r.id,me.id);s(Et)}catch(Et){console.error("Delete payment failed",Et),Q("Unable to delete payment.")}}async function We(){if(r){V("advance"),Q("");try{const{data:me}=await fpe(r.id,{});s(me)}catch(me){console.error("Apply advances failed",me),Q("Unable to apply advances.")}finally{V("")}}}async function Je(){if(!(!r||!window.confirm("Finalize this invoice? You cannot edit items later."))){V("finalize"),Q("");try{const{data:tt}=await ipe(r.id);s(tt)}catch(tt){console.error("Finalize failed",tt),Q("Unable to finalize invoice.")}finally{V("")}}}async function St(){if(!(!r||!window.confirm("Cancel this invoice?"))){V("cancel"),Q("");try{await ope(r.id),await Se()}catch(tt){console.error("Cancel failed",tt),Q("Unable to cancel invoice.")}finally{V("")}}}async function wt(){if(r)try{const me=await mpe(r.id),tt=new Blob([me.data],{type:me.headers["content-type"]||"application/pdf"}),Et=URL.createObjectURL(tt);window.open(Et,"_blank","noopener")}catch(me){console.error("Print failed",me),Q("Unable to open invoice print view.")}}async function ft(){if(r)try{const me=await ppe(r.patient_id),tt=new Blob([me.data],{type:me.headers["content-type"]||"application/pdf"}),Et=URL.createObjectURL(tt);window.open(Et,"_blank","noopener")}catch(me){console.error("Patient summary print failed",me),Q("Unable to open patient billing summary.")}}function Ie(){L(!0),P(!0)}function qe(){L(!1),P(!0)}function se(me){if(!r||!me)return;const tt=i.packages.find(Ft=>String(Ft.id)===String(me));if(!tt)return;const Et={description:`Package: ${tt.name}`,quantity:1,unit_price:Number(tt.charges||0),tax_rate:0,discount_percent:0};MP(r.id,Et).then(({data:Ft})=>s(Ft)).catch(Ft=>{console.error("Add package charge failed",Ft),Q("Unable to add package charge.")})}const le=i.packages||[],De=(r==null?void 0:r.status)==="finalized"?"bg-green-100 text-green-800":(r==null?void 0:r.status)==="cancelled"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800",Nt=(r==null?void 0:r.payments)||[],sn=(r==null?void 0:r.items)||[],Yt=b.useMemo(()=>Nt.filter(me=>Number(me.amount||0)>=0),[Nt]),Pt=b.useMemo(()=>Nt.filter(me=>Number(me.amount||0)<0),[Nt]);return l?a.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 md:px-6 py-4",children:a.jsx("div",{className:"max-w-5xl mx-auto text-xs text-slate-500",children:"Loading invoice..."})}):r?a.jsxs("div",{className:"min-h-[calc(100vh-4rem)] bg-gradient-to-b from-slate-50 via-slate-100 to-slate-50 px-3 md:px-6 pb-20 md:pb-4 pt-4",children:[a.jsxs("div",{className:"max-w-5xl mx-auto space-y-4",children:[a.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:()=>n("/billing"),className:"text-xs text-slate-500 hover:text-slate-700",children:" Billing Console"}),a.jsx("span",{className:"text-xs text-slate-400",children:"/"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("h1",{className:"text-sm md:text-base font-semibold text-slate-900",children:["Invoice #",r.invoice_number||r.id]}),a.jsx("span",{className:`inline-flex rounded-full px-2.5 py-0.5 text-[10px] font-medium ${De}`,children:r.status})]})]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("button",{type:"button",onClick:wt,className:"text-xs rounded-full border border-slate-300 px-3 py-1.5 text-slate-700 bg-white hover:bg-slate-50 shadow-sm",children:"Print Invoice"})})]}),F&&a.jsx("div",{className:"rounded-md bg-red-50 px-3 py-2 text-xs text-red-700",children:F}),a.jsxs("div",{className:"rounded-2xl border border-indigo-100 bg-gradient-to-r from-indigo-50 via-sky-50 to-purple-50 p-3 md:p-4 shadow-sm flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("div",{className:"text-xs font-semibold text-slate-800",children:"Patient Credit Overview"}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Patient ID: ",a.jsxs("span",{className:"font-medium",children:["#",r.patient_id]})]}),(U==null?void 0:U.patient)&&a.jsxs("div",{className:"text-[11px] text-slate-600",children:[U.patient.uhid&&a.jsxs(a.Fragment,{children:["UHID:"," ",a.jsx("span",{className:"font-medium",children:U.patient.uhid})," ",""," "]}),(U.patient.first_name||U.patient.last_name)&&a.jsxs(a.Fragment,{children:[U.patient.first_name," ",U.patient.last_name," "," "]}),U.patient.phone&&a.jsxs(a.Fragment,{children:[" ",U.patient.phone]})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 text-[11px]",children:[a.jsxs("div",{className:"rounded-full bg-white/80 border border-indigo-100 px-3 py-1 shadow-sm",children:[a.jsx("span",{className:"text-slate-500 mr-1",children:"Total Outstanding:"}),a.jsxs("span",{className:"font-semibold text-red-700",children:[""," ",Or((U==null?void 0:U.total_outstanding)??r.balance_due??0)]})]}),a.jsxs("div",{className:"rounded-full bg-white/80 border border-emerald-100 px-3 py-1 shadow-sm",children:[a.jsx("span",{className:"text-slate-500 mr-1",children:"Advance Balance:"}),a.jsxs("span",{className:"font-semibold text-emerald-700",children:[" ",Or((U==null?void 0:U.advance_balance)??0)]})]}),a.jsx("button",{type:"button",onClick:ft,disabled:q,className:"rounded-full bg-slate-900 px-3 py-1 text-[11px] font-medium text-white shadow-sm hover:bg-slate-800 disabled:opacity-60",children:q?"Loading...":"Credit Summary PDF"})]})]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[a.jsxs("div",{className:"w-full md:w-2/5 space-y-4",children:[a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 md:p-4 shadow-sm space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("h2",{className:"text-xs font-semibold text-slate-800",children:"Invoice Header"}),a.jsxs("span",{className:"text-[11px] text-slate-400",children:["Patient #",r.patient_id]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"Billing Type"}),a.jsxs("select",{name:"billing_type",value:h.billing_type,onChange:de,disabled:X,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50",children:[a.jsx("option",{value:"op_billing",children:"OP Billing"}),a.jsx("option",{value:"ip_billing",children:"IP Billing"}),a.jsx("option",{value:"lab",children:"Lab"}),a.jsx("option",{value:"pharmacy",children:"Pharmacy"}),a.jsx("option",{value:"radiology",children:"Radiology"}),a.jsx("option",{value:"general",children:"General"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"Consultant"}),a.jsxs("select",{name:"consultant_id",value:h.consultant_id,onChange:de,disabled:X,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50",children:[a.jsx("option",{value:"",children:"None"}),(tr=i.doctors)==null?void 0:tr.map(me=>a.jsx("option",{value:me.id,children:me.name||`Doctor #${me.id}`},me.id))]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"Credit Provider"}),a.jsxs("select",{name:"provider_id",value:h.provider_id,onChange:de,disabled:X,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50",children:[a.jsx("option",{value:"",children:"Self pay"}),(In=i.credit_providers)==null?void 0:In.map(me=>a.jsx("option",{value:me.id,children:me.display_name||me.name||me.code||`Provider #${me.id}`},me.id))]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"Visit No (optional)"}),a.jsx("input",{type:"text",name:"visit_no",value:h.visit_no,onChange:de,disabled:X,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"Remarks"}),a.jsx("input",{type:"text",name:"remarks",value:h.remarks,onChange:de,disabled:X,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50"})]})]}),a.jsxs("div",{className:"mt-2 border-t border-slate-100 pt-2 space-y-2",children:[a.jsx("div",{className:"text-[11px] font-semibold text-slate-700",children:"Header Discount"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"Discount %"}),a.jsx("input",{type:"number",name:"header_discount_percent",value:h.header_discount_percent,onChange:de,disabled:X,step:"0.1",className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"Discount Amount"}),a.jsx("input",{type:"number",name:"header_discount_amount",value:h.header_discount_amount,onChange:de,disabled:X,step:"0.01",className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50"})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"Discount Remarks"}),a.jsx("input",{type:"text",name:"discount_remarks",value:h.discount_remarks,onChange:de,disabled:X,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50"})]})]}),!X&&a.jsx("div",{className:"pt-1 flex justify-end",children:a.jsx("button",{type:"button",onClick:ye,disabled:d,className:"px-3 py-1.5 rounded-full bg-slate-900 text-xs font-medium text-white hover:bg-slate-800 disabled:opacity-60",children:d?"Saving...":"Save Header"})})]})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 md:p-4 shadow-sm space-y-2 text-xs",children:[a.jsx("h2",{className:"text-xs font-semibold text-slate-800",children:"Totals"}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-500",children:"Gross Amount"}),a.jsxs("span",{className:"font-medium text-slate-900",children:[" ",Or(r.gross_total)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-500",children:"Tax Total"}),a.jsxs("span",{className:"font-medium text-slate-900",children:[" ",Or(r.tax_total)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-500",children:"Header Discount"}),a.jsxs("span",{className:"font-medium text-orange-700",children:[" ",Or(r.header_discount_amount||0)," ",r.header_discount_percent?`(${r.header_discount_percent}%)`:""]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-500",children:"Net Amount"}),a.jsxs("span",{className:"font-semibold text-slate-900",children:[" ",Or(r.net_total)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-500",children:"Amount Received"}),a.jsxs("span",{className:"font-medium text-emerald-700",children:[" ",Or(r.amount_paid)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-500",children:"Advance Adjusted"}),a.jsxs("span",{className:"font-medium text-slate-900",children:[" ",Or(r.advance_adjusted)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-500",children:"Previous Balance"}),a.jsxs("span",{className:"font-medium text-slate-900",children:[" ",Or(r.previous_balance_snapshot)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-500",children:"Balance Due"}),a.jsxs("span",{className:"font-semibold text-red-700",children:[" ",Or(r.balance_due)]})]})]})]}),le.length>0&&a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 md:p-4 shadow-sm space-y-2 text-xs",children:[a.jsx("div",{className:"flex items-center justify-between gap-2",children:a.jsx("h2",{className:"text-xs font-semibold text-slate-800",children:"Package Billing (IPD)"})}),a.jsx("p",{className:"text-[11px] text-slate-500 mb-1",children:"Quickly post a package charge to this invoice."}),a.jsxs("select",{onChange:me=>se(me.target.value),disabled:X,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50",defaultValue:"",children:[a.jsx("option",{value:"",children:"Select package to add..."}),le.map(me=>a.jsxs("option",{value:me.id,children:[me.name,"   ",Or(me.charges)]},me.id))]})]})]}),a.jsxs("div",{className:"w-full md:w-3/5 space-y-4",children:[a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 md:p-4 shadow-sm space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("h2",{className:"text-xs font-semibold text-slate-800",children:"Items"}),!X&&a.jsx("button",{type:"button",onClick:()=>y(!0),className:"text-[11px] rounded-full border border-slate-300 px-3 py-1 text-slate-700 hover:bg-slate-50 shadow-sm",children:"+ Add Manual Item"})]}),sn.length===0?a.jsx("p",{className:"text-xs text-slate-500",children:"No items added yet."}):a.jsx("div",{className:"overflow-x-auto text-xs",children:a.jsxs("table",{className:"min-w-full divide-y divide-slate-100",children:[a.jsx("thead",{className:"bg-slate-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"#"}),a.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Description"}),a.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"Qty"}),a.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"Price"}),a.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"GST%"}),a.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"Disc"}),a.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"Total"}),a.jsx("th",{className:"px-2 py-1.5"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-100",children:sn.map((me,tt)=>a.jsxs("tr",{className:"align-top",children:[a.jsx("td",{className:"px-2 py-1.5 whitespace-nowrap text-slate-500",children:tt+1}),a.jsx("td",{className:"px-2 py-1.5 text-slate-800",children:a.jsxs("div",{className:"max-w-xs",children:[a.jsx("div",{className:"truncate",children:me.description}),a.jsxs("div",{className:"text-[10px] text-slate-400",children:[me.service_type," #",me.service_ref_id]})]})}),a.jsx("td",{className:"px-2 py-1.5 text-right text-slate-700",children:me.quantity}),a.jsx("td",{className:"px-2 py-1.5 text-right text-slate-700",children:Or(me.unit_price)}),a.jsxs("td",{className:"px-2 py-1.5 text-right text-slate-700",children:[Number(me.tax_rate||0),"%"]}),a.jsxs("td",{className:"px-2 py-1.5 text-right text-slate-700",children:[me.discount_percent?`${Number(me.discount_percent)}%`:"",me.discount_amount?` /  ${Or(me.discount_amount)}`:""]}),a.jsx("td",{className:"px-2 py-1.5 text-right text-slate-800",children:Or(me.line_total)}),a.jsx("td",{className:"px-2 py-1.5 text-right whitespace-nowrap",children:!X&&a.jsxs("div",{className:"flex justify-end gap-1",children:[a.jsx("button",{type:"button",onClick:()=>_e(me),className:"text-[10px] text-indigo-600 hover:text-indigo-800",children:"Edit"}),a.jsx("span",{className:"text-slate-300",children:"|"}),a.jsx("button",{type:"button",onClick:()=>ae(me),className:"text-[10px] text-red-600 hover:text-red-800",children:"Void"})]})})]},me.id))})]})})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 md:p-4 shadow-sm space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("h2",{className:"text-xs font-semibold text-slate-800",children:"Payments & Refunds"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",onClick:We,disabled:$==="advance",className:"text-[11px] rounded-full border border-slate-300 px-3 py-1 text-slate-700 hover:bg-slate-50 disabled:opacity-60",children:$==="advance"?"Applying...":"Apply Advances"}),!X&&a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",onClick:Ie,className:"text-[11px] rounded-full border border-red-200 bg-red-50 px-3 py-1 text-red-700 hover:bg-red-100",children:"+ Add Refund"}),a.jsx("button",{type:"button",onClick:qe,className:"text-[11px] rounded-full border border-slate-300 px-3 py-1 text-slate-700 hover:bg-slate-50",children:"+ Add Payment"})]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("div",{className:"text-[11px] font-semibold text-slate-700",children:"Payments"}),Yt.length===0?a.jsx("p",{className:"text-[11px] text-slate-500",children:"No payments recorded."}):a.jsx("div",{className:"overflow-x-auto text-xs",children:a.jsxs("table",{className:"min-w-full divide-y divide-slate-100",children:[a.jsx("thead",{className:"bg-slate-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Mode"}),a.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Reference"}),a.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Notes"}),a.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Paid At"}),a.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"Amount"}),a.jsx("th",{className:"px-2 py-1.5"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-100",children:Yt.map(me=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-2 py-1.5 text-slate-800",children:me.mode}),a.jsx("td",{className:"px-2 py-1.5 text-slate-600",children:me.reference_no||""}),a.jsx("td",{className:"px-2 py-1.5 text-slate-600",children:me.notes||""}),a.jsx("td",{className:"px-2 py-1.5 text-slate-500",children:me.paid_at?new Date(me.paid_at).toLocaleString():""}),a.jsxs("td",{className:"px-2 py-1.5 text-right text-emerald-700 font-medium",children:[" ",Or(me.amount)]}),a.jsx("td",{className:"px-2 py-1.5 text-right",children:!X&&a.jsx("button",{type:"button",onClick:()=>re(me),className:"text-[10px] text-red-600 hover:text-red-800",children:"Delete"})})]},me.id))})]})})]}),a.jsxs("div",{className:"space-y-1 border-t border-slate-100 pt-2",children:[a.jsx("div",{className:"text-[11px] font-semibold text-slate-700",children:"Refunds"}),Pt.length===0?a.jsx("p",{className:"text-[11px] text-slate-500",children:"No refunds recorded."}):a.jsx("div",{className:"overflow-x-auto text-xs",children:a.jsxs("table",{className:"min-w-full divide-y divide-slate-100",children:[a.jsx("thead",{className:"bg-slate-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Mode"}),a.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Reference"}),a.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Notes"}),a.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Time"}),a.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"Amount"}),a.jsx("th",{className:"px-2 py-1.5"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-100",children:Pt.map(me=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-2 py-1.5 text-slate-800",children:me.mode}),a.jsx("td",{className:"px-2 py-1.5 text-slate-600",children:me.reference_no||""}),a.jsx("td",{className:"px-2 py-1.5 text-slate-600",children:me.notes||""}),a.jsx("td",{className:"px-2 py-1.5 text-slate-500",children:me.paid_at?new Date(me.paid_at).toLocaleString():""}),a.jsxs("td",{className:"px-2 py-1.5 text-right text-red-700 font-medium",children:[" ",Or(me.amount)]}),a.jsx("td",{className:"px-2 py-1.5 text-right",children:!X&&a.jsx("button",{type:"button",onClick:()=>re(me),className:"text-[10px] text-red-600 hover:text-red-800",children:"Delete"})})]},me.id))})]})})]})]})]})]}),a.jsx("div",{className:"fixed inset-x-0 bottom-0 z-20 bg-white border-t border-slate-200 px-3 py-2 md:static md:border-none md:px-0 md:py-0 mt-3",children:a.jsxs("div",{className:"max-w-5xl mx-auto flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between text-xs",children:[a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs("span",{className:"rounded-full bg-slate-100 px-2.5 py-1 text-[11px] text-slate-700",children:["Net:  ",Or(r.net_total)]}),a.jsxs("span",{className:"rounded-full bg-emerald-50 px-2.5 py-1 text-[11px] text-emerald-700",children:["Paid:  ",Or(r.amount_paid)]}),a.jsxs("span",{className:"rounded-full bg-red-50 px-2.5 py-1 text-[11px] text-red-700",children:["Balance:  ",Or(r.balance_due)]})]}),a.jsx("div",{className:"flex gap-2 justify-end",children:!X&&a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",onClick:St,disabled:$==="cancel",className:"rounded-full border border-slate-300 px-3 py-1.5 text-xs text-slate-700 bg-white hover:bg-slate-50 disabled:opacity-60",children:$==="cancel"?"Cancelling...":"Cancel Invoice"}),a.jsx("button",{type:"button",onClick:Je,disabled:$==="finalize",className:"rounded-full bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-500 px-4 py-1.5 text-xs font-medium text-white shadow-md hover:shadow-lg disabled:opacity-60",children:$==="finalize"?"Finalizing...":"Finalize"})]})})]})})]}),g&&!X&&a.jsx("div",{className:"fixed inset-0 z-30 flex items-end sm:items-center justify-center bg-black/40",children:a.jsxs("div",{className:"w-full sm:max-w-md bg-white rounded-t-2xl sm:rounded-2xl shadow-lg p-4 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Add Manual Item"}),a.jsx("button",{type:"button",onClick:()=>y(!1),className:"text-xs text-slate-400 hover:text-slate-600",children:""})]}),a.jsxs("form",{className:"space-y-3",onSubmit:xe,children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Description"}),a.jsx("input",{type:"text",name:"description",value:N.description,onChange:be,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Qty"}),a.jsx("input",{type:"number",name:"quantity",value:N.quantity,min:1,onChange:be,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Unit Price"}),a.jsx("input",{type:"number",name:"unit_price",value:N.unit_price,step:"0.01",onChange:be,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",required:!0})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Tax %"}),a.jsx("input",{type:"number",name:"tax_rate",value:N.tax_rate,step:"0.1",onChange:be,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Disc %"}),a.jsx("input",{type:"number",name:"discount_percent",value:N.discount_percent,step:"0.1",onChange:be,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Disc Amount"}),a.jsx("input",{type:"number",name:"discount_amount",value:N.discount_amount,step:"0.01",onChange:be,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]})]}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx("button",{type:"button",onClick:()=>y(!1),className:"rounded-md border border-slate-300 px-3 py-1.5 text-xs text-slate-700",children:"Cancel"}),a.jsx("button",{type:"submit",className:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-indigo-700",children:"Add Item"})]})]})]})}),S&&!X&&a.jsx("div",{className:"fixed inset-0 z-30 flex items-end sm:items-center justify-center bg-black/40",children:a.jsxs("div",{className:"w-full sm:max-w-md bg-white rounded-t-2xl sm:rounded-2xl shadow-lg p-4 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Edit Item"}),a.jsx("button",{type:"button",onClick:()=>_(null),className:"text-xs text-slate-400 hover:text-slate-600",children:""})]}),a.jsxs("form",{className:"space-y-3",onSubmit:Oe,children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Description"}),a.jsx("input",{type:"text",name:"description",value:A.description,onChange:we,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Qty"}),a.jsx("input",{type:"number",name:"quantity",value:A.quantity,min:1,onChange:we,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Unit Price"}),a.jsx("input",{type:"number",name:"unit_price",value:A.unit_price,step:"0.01",onChange:we,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",required:!0})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Tax %"}),a.jsx("input",{type:"number",name:"tax_rate",value:A.tax_rate,step:"0.1",onChange:we,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Disc %"}),a.jsx("input",{type:"number",name:"discount_percent",value:A.discount_percent,step:"0.1",onChange:we,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Disc Amount"}),a.jsx("input",{type:"number",name:"discount_amount",value:A.discount_amount,step:"0.01",onChange:we,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]})]}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx("button",{type:"button",onClick:()=>_(null),className:"rounded-md border border-slate-300 px-3 py-1.5 text-xs text-slate-700",children:"Cancel"}),a.jsx("button",{type:"submit",className:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-indigo-700",children:"Save Changes"})]})]})]})}),T&&!X&&a.jsx("div",{className:"fixed inset-0 z-30 flex items-end sm:items-center justify-center bg-black/40",children:a.jsxs("div",{className:"w-full sm:max-w-md bg-white rounded-t-2xl sm:rounded-2xl shadow-lg p-4 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:D?"Add Refund":"Add Payment"}),a.jsx("button",{type:"button",onClick:()=>{P(!1),L(!1)},className:"text-xs text-slate-400 hover:text-slate-600",children:""})]}),a.jsxs("form",{className:"space-y-3",onSubmit:pe,children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Amount"}),a.jsx("input",{type:"number",name:"amount",value:M.amount,onChange:ie,step:"0.01",className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",required:!0})]}),!D&&a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Mode"}),a.jsxs("select",{name:"mode",value:M.mode,onChange:ie,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",children:[a.jsx("option",{value:"cash",children:"Cash"}),a.jsx("option",{value:"card",children:"Card"}),a.jsx("option",{value:"upi",children:"UPI"}),a.jsx("option",{value:"credit",children:"Credit"}),a.jsx("option",{value:"cheque",children:"Cheque"}),a.jsx("option",{value:"neft",children:"NEFT"}),a.jsx("option",{value:"rtgs",children:"RTGS"}),a.jsx("option",{value:"wallet",children:"Wallet"}),a.jsx("option",{value:"other",children:"Other"})]})]}),D&&a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Mode (optional)"}),a.jsx("input",{type:"text",name:"mode",value:M.mode,onChange:ie,placeholder:"refund / bank / cash",className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Reference No (optional)"}),a.jsx("input",{type:"text",name:"reference_no",value:M.reference_no,onChange:ie,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Notes (optional)"}),a.jsx("input",{type:"text",name:"notes",value:M.notes,onChange:ie,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx("button",{type:"button",onClick:()=>{P(!1),L(!1)},className:"rounded-md border border-slate-300 px-3 py-1.5 text-xs text-slate-700",children:"Cancel"}),a.jsx("button",{type:"submit",className:`rounded-md px-3 py-1.5 text-xs font-medium text-white ${D?"bg-red-600 hover:bg-red-700":"bg-indigo-600 hover:bg-indigo-700"}`,children:D?"Save Refund":"Save Payment"})]})]})]})})]}):a.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 md:px-6 py-4",children:a.jsxs("div",{className:"max-w-5xl mx-auto",children:[a.jsx("p",{className:"text-xs text-red-600 mb-2",children:F||"Invoice not found."}),a.jsx("button",{type:"button",onClick:()=>n("/billing"),className:"text-xs text-indigo-600 hover:text-indigo-800",children:" Back to Billing Console"})]})})}function hF(t){return te.get("/emr/patients/lookup",{params:{q:t}})}function gpe({patient_id:t,uhid:n,date_from:r,date_to:s,types:i}={}){let o;return Array.isArray(i)?o=i.length?i.join(","):void 0:typeof i=="string"?o=i||void 0:o=void 0,te.get("/emr/timeline",{params:{patient_id:t,uhid:n,date_from:r||void 0,date_to:s||void 0,types:o}})}function ype(t){return te.post("/emr/export/pdf-json",t,{responseType:"blob"})}function vpe(t,n,r){return te.get(`/emr/fhir/${t}`,{params:{date_from:n,date_to:r}})}function bpe({onPick:t,placeholder:n="UHID, name, phone, email"}){const[r,s]=b.useState(""),[i,o]=b.useState([]),[l,c]=b.useState(!1);b.useEffect(()=>{let u=!0;const m=setTimeout(async()=>{if(!r||!r.trim()){o([]);return}try{c(!0);const{data:g}=await hF(r.trim());if(!u)return;o((g==null?void 0:g.results)||[])}finally{c(!1)}},250);return()=>{u=!1,clearTimeout(m)}},[r]);const d=b.useMemo(()=>i.slice(0,8),[i]);return a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Find Patient"}),a.jsxs("div",{className:"relative",children:[a.jsx(ur,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),a.jsx("input",{className:"w-full rounded-xl border border-gray-200 bg-white px-9 py-2 text-sm outline-none ring-blue-200 focus:ring-2",placeholder:n,value:r,onChange:u=>s(u.target.value)})]}),l&&a.jsx("div",{className:"text-xs text-gray-500",children:"Searching"}),!l&&d.length>0&&a.jsx("div",{className:"grid gap-2 sm:grid-cols-2",children:d.map(u=>{var h;return a.jsxs("button",{onClick:()=>t(u),className:"rounded-xl border p-3 text-left transition hover:bg-gray-50",children:[a.jsxs("div",{className:"font-medium",children:[u.uhid,"  ",u.name]}),a.jsxs("div",{className:"text-xs text-gray-500",children:[(h=u.gender)==null?void 0:h.toUpperCase()," ",u.dob?` ${u.dob}`:""," ",u.phone?` ${u.phone}`:""]})]},u.uhid)})}),!l&&r&&d.length===0&&a.jsx("div",{className:"text-xs text-gray-500",children:"No matches."})]})}const cm=[{code:"opd_visit",label:"OPD Visit",icon:kn},{code:"opd_vitals",label:"Vitals",icon:ha},{code:"rx",label:"Prescription",icon:y1},{code:"lab",label:"Lab",icon:Wf},{code:"radiology",label:"Radiology",icon:wg},{code:"pharmacy",label:"Pharmacy",icon:w1},{code:"ipd_admission",label:"IPD Admit",icon:Fd},{code:"ipd_transfer",label:"IPD Transfer",icon:ree},{code:"ipd_discharge",label:"IPD Discharge",icon:dte},{code:"ot",label:"OT",icon:Fj},{code:"billing",label:"Billing",icon:v1},{code:"attachment",label:"Attachment",icon:bL},{code:"consent",label:"Consent",icon:_o}];function yf(t){return t<10?"0"+t:""+t}function wpe(t){const n=new Date(t);return isNaN(n)?String(t||""):`${n.getFullYear()}-${yf(n.getMonth()+1)}-${yf(n.getDate())} ${yf(n.getHours())}:${yf(n.getMinutes())}`}function Npe(t){const n=new Date(t);return isNaN(n)?"":`${n.getFullYear()}-${yf(n.getMonth()+1)}-${yf(n.getDate())}`}function jpe(t){const n=new Map;return t.forEach(r=>{const s=Npe(r.ts);n.has(s)||n.set(s,[]),n.get(s).push(r)}),Array.from(n.entries()).sort((r,s)=>r[0]<s[0]?1:-1)}function Spe(t,n){const r=URL.createObjectURL(t),s=document.createElement("a");s.href=r,s.download=n,s.click(),URL.revokeObjectURL(r)}function E0(t,n){const r=document.createElement("a");r.href=t,r.download=n||"download",r.target="_blank",r.rel="noopener",r.click()}const Cpe="inline-flex items-center gap-1 rounded-full border px-3 py-1 text-[11px] font-medium transition",_pe={new:"border-slate-200 bg-slate-50 text-slate-700",in_progress:"border-slate-200 bg-slate-50 text-slate-700",dispensed:"border-emerald-200 bg-emerald-50 text-emerald-700",completed:"border-emerald-200 bg-emerald-50 text-emerald-700",cancelled:"border-rose-200 bg-rose-50 text-rose-700"};function OP(t){const n=(t.content_type||"").toLowerCase(),r=String(t.url||"").toLowerCase();return n.startsWith("image/")?"image":n==="application/pdf"?"pdf":r.endsWith(".png")||r.endsWith(".jpg")||r.endsWith(".jpeg")||r.endsWith(".webp")||r.endsWith(".gif")?"image":r.endsWith(".pdf")?"pdf":"other"}function Ape(){const[t,n]=b.useState(null),[r,s]=b.useState({date_from:"",date_to:"",types:cm.map(z=>z.code),consent_required:!1}),[i,o]=b.useState(!1),[l,c]=b.useState([]),[d,u]=b.useState(0),h=b.useMemo(()=>new Set(r.types||[]),[r.types]),[m,g]=b.useState(null),[y,N]=b.useState(!1),[j,S]=b.useState(null);b.useEffect(()=>()=>{m&&URL.revokeObjectURL(m)},[m]);const _=z=>{s(q=>{const K=new Set(q.types);return K.has(z)?K.delete(z):K.add(z),{...q,types:Array.from(K)}})},A=()=>s(z=>({...z,types:cm.map(q=>q.code)})),k=()=>s(z=>({...z,types:[]}));b.useEffect(()=>{let z=!0;return(async()=>{var K,X;if(!(!(t!=null&&t.uhid)&&!(t!=null&&t.id)))try{o(!0);const J={uhid:t.uhid,patient_id:t.id,date_from:r.date_from||void 0,date_to:r.date_to||void 0};r.types&&r.types.length&&r.types.length!==cm.length&&(J.types=r.types.join(","));const{data:ne}=await gpe(J);if(!z)return;c(ne||[])}catch(J){console.error(J),fe.error(((X=(K=J==null?void 0:J.response)==null?void 0:K.data)==null?void 0:X.detail)||"Failed to load EMR timeline"),c([])}finally{o(!1)}})(),()=>{z=!1}},[t==null?void 0:t.uhid,t==null?void 0:t.id,r.date_from,r.date_to,JSON.stringify(r.types),d]);const T=b.useMemo(()=>jpe(l),[l]),P=(l==null?void 0:l.length)||0,M=r.date_from||r.date_to?`${r.date_from||""}  ${r.date_to||"Today"}`:"All available records",O=async()=>{var z,q,K;if(!t){fe.info("Select a patient first.");return}try{const J={...t!=null&&t.id?{patient_id:t.id}:{uhid:t==null?void 0:t.uhid},date_from:r.date_from||null,date_to:r.date_to||null,sections:{opd:h.has("opd_visit")||h.has("opd_vitals")||h.has("rx"),ipd:h.has("ipd_admission")||h.has("ipd_transfer")||h.has("ipd_discharge"),vitals:h.has("opd_vitals"),prescriptions:h.has("rx"),lab:h.has("lab"),radiology:h.has("radiology"),pharmacy:h.has("pharmacy"),ot:h.has("ot"),billing:h.has("billing"),attachments:h.has("attachment"),consents:h.has("consent")},consent_required:!!r.consent_required},Se=(await ype(J)).data;if(!(Se instanceof Blob)){fe.error("PDF export failed: invalid response");return}g(de=>(de&&URL.revokeObjectURL(de),URL.createObjectURL(Se))),N(!0),fe.success("EMR PDF ready for preview")}catch(X){((z=X==null?void 0:X.response)==null?void 0:z.status)===412?fe.error("Consent required. Enable consent capture or uncheck the Require consent box."):fe.error(((K=(q=X==null?void 0:X.response)==null?void 0:q.data)==null?void 0:K.detail)||"PDF export failed")}},D=async()=>{if(!(t!=null&&t.id)){fe.info("Patient id required; please pick from the search list.");return}try{const{data:z}=await vpe(t.id,r.date_from||void 0,r.date_to||void 0),q=new Blob([JSON.stringify(z,null,2)],{type:"application/json"});Spe(q,`FHIR_${t.uhid||"patient"}.json`),fe.success("FHIR bundle downloaded")}catch{fe.error("FHIR export failed")}};function L({k:z,v:q}){return q==null||q===""?null:a.jsxs("div",{className:"text-xs text-slate-700",children:[a.jsxs("span",{className:"font-medium",children:[z,":"]})," ",String(q)]})}function $(z){const q=z.data||{};switch(z.type){case"opd_visit":return a.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[a.jsx(L,{k:"Chief Complaint",v:q.chief_complaint}),a.jsx(L,{k:"Symptoms",v:q.symptoms}),a.jsx(L,{k:"Subjective",v:q.subjective}),a.jsx(L,{k:"Objective",v:q.objective}),a.jsx(L,{k:"Assessment",v:q.assessment}),a.jsx(L,{k:"Plan",v:q.plan}),a.jsx(L,{k:"Episode",v:q.episode_id}),q.appointment&&a.jsxs("div",{className:"text-xs text-slate-700",children:[a.jsx("span",{className:"font-medium",children:"Appointment:"})," ",q.appointment.date,"  ",q.appointment.slot_start,"",q.appointment.slot_end,"  ",q.appointment.purpose]})]});case"opd_vitals":return a.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-sm text-slate-800 md:grid-cols-3",children:[a.jsx(L,{k:"Recorded at",v:q.recorded_at}),a.jsx(L,{k:"Height (cm)",v:q.height_cm}),a.jsx(L,{k:"Weight (kg)",v:q.weight_kg}),a.jsx(L,{k:"BMI",v:q.bmi}),a.jsx(L,{k:"BP",v:q.bp_systolic!=null&&q.bp_diastolic!=null?`${q.bp_systolic}/${q.bp_diastolic} mmHg`:""}),a.jsx(L,{k:"Pulse",v:q.pulse}),a.jsx(L,{k:"RR",v:q.rr}),a.jsx(L,{k:"Temp (C)",v:q.temp_c}),a.jsx(L,{k:"SpO (%)",v:q.spo2}),a.jsx("div",{className:"col-span-2 md:col-span-3",children:a.jsx(L,{k:"Notes",v:q.notes})})]});case"rx":return a.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[a.jsx(L,{k:"Notes",v:q.notes}),a.jsx(L,{k:"Signed at",v:q.signed_at}),a.jsx(L,{k:"Signed by",v:q.signed_by}),Array.isArray(q.items)&&q.items.length>0&&a.jsxs("div",{className:"mt-2",children:[a.jsx("div",{className:"text-[11px] font-medium text-slate-600 uppercase tracking-wide",children:"Items"}),a.jsx("div",{className:"mt-1 divide-y rounded-2xl border border-slate-200 bg-slate-50",children:q.items.map((K,X)=>a.jsxs("div",{className:"grid gap-2 p-2.5 md:grid-cols-5",children:[a.jsxs("div",{className:"md:col-span-2 text-xs",children:[a.jsx("span",{className:"font-medium text-slate-900",children:K.drug_name})," ",K.strength?a.jsxs("span",{className:"text-slate-500",children:[" ",K.strength]}):null]}),a.jsxs("div",{className:"text-xs text-slate-600",children:["Freq: ",K.frequency||""]}),a.jsxs("div",{className:"text-xs text-slate-600",children:["Dur: ",K.duration_days,"d"]}),a.jsxs("div",{className:"text-xs text-slate-600",children:["Qty: ",K.quantity]})]},X))})]})]});case"lab":{const K=q.item||{};return a.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[a.jsx(L,{k:"Order ID",v:q.order_id}),a.jsx(L,{k:"Priority",v:q.priority}),a.jsx(L,{k:"Collected at",v:q.collected_at}),a.jsx(L,{k:"Reported at",v:q.reported_at}),a.jsx(L,{k:"Test",v:`${K.test_name} (${K.test_code})`}),a.jsx(L,{k:"Unit",v:K.unit}),a.jsx(L,{k:"Normal range",v:K.normal_range}),a.jsx(L,{k:"Specimen",v:K.specimen_type}),a.jsx(L,{k:"Status",v:K.status}),a.jsx(L,{k:"Result",v:K.result_value}),a.jsx(L,{k:"Critical",v:K.is_critical?"Yes":K.is_critical===!1?"No":""}),a.jsx(L,{k:"Result at",v:K.result_at})]})}case"radiology":return a.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[a.jsx(L,{k:"Test",v:`${q.test_name} (${q.test_code})`}),a.jsx(L,{k:"Modality",v:q.modality}),a.jsx(L,{k:"Status",v:q.status}),a.jsx(L,{k:"Scheduled at",v:q.scheduled_at}),a.jsx(L,{k:"Scanned at",v:q.scanned_at}),a.jsx(L,{k:"Reported at",v:q.reported_at}),a.jsx(L,{k:"Approved at",v:q.approved_at}),a.jsx(L,{k:"Report",v:q.report_text})]});case"pharmacy":return a.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[a.jsx(L,{k:"Sale ID",v:q.sale_id}),a.jsx(L,{k:"Context",v:q.context_type}),a.jsx(L,{k:"Payment",v:q.payment_mode}),a.jsx(L,{k:"Total",v:q.total_amount}),Array.isArray(q.items)&&q.items.length>0&&a.jsxs("div",{className:"mt-2",children:[a.jsx("div",{className:"text-[11px] font-medium text-slate-600 uppercase tracking-wide",children:"Items"}),a.jsx("div",{className:"mt-1 divide-y rounded-2xl border border-slate-200 bg-slate-50",children:q.items.map((K,X)=>a.jsxs("div",{className:"grid gap-2 p-2.5 md:grid-cols-4",children:[a.jsx("div",{className:"md:col-span-2 text-xs text-slate-800",children:K.medicine_name||`#${K.medicine_id}`}),a.jsxs("div",{className:"text-xs text-slate-600",children:["Qty: ",K.qty]}),a.jsxs("div",{className:"text-xs text-slate-600",children:["",K.amount]})]},X))})]})]});case"ipd_admission":return a.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-sm text-slate-800 md:grid-cols-3",children:[a.jsx(L,{k:"Admission Code",v:q.admission_code}),a.jsx(L,{k:"Type",v:q.admission_type}),a.jsx(L,{k:"Admitted at",v:q.admitted_at}),a.jsx(L,{k:"Expected Discharge",v:q.expected_discharge_at}),a.jsx(L,{k:"Bed",v:q.current_bed_code}),a.jsx("div",{className:"col-span-2 md:col-span-3",children:a.jsx(L,{k:"Preliminary Diagnosis",v:q.preliminary_diagnosis})}),a.jsx("div",{className:"col-span-2 md:col-span-3",children:a.jsx(L,{k:"History",v:q.history})}),a.jsx("div",{className:"col-span-2 md:col-span-3",children:a.jsx(L,{k:"Care Plan",v:q.care_plan})})]});case"ipd_transfer":return a.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[a.jsx(L,{k:"Admission",v:q.admission_id}),a.jsx(L,{k:"From Bed",v:q.from_bed_id}),a.jsx(L,{k:"To Bed",v:q.to_bed_id}),a.jsx(L,{k:"Reason",v:q.reason}),a.jsx(L,{k:"Transferred at",v:q.transferred_at})]});case"ipd_discharge":return a.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[a.jsx(L,{k:"Finalized",v:q.finalized?"Yes":"No"}),a.jsx(L,{k:"Finalized at",v:q.finalized_at}),a.jsx(L,{k:"Demographics",v:q.demographics}),a.jsx(L,{k:"Medical History",v:q.medical_history}),a.jsx(L,{k:"Treatment Summary",v:q.treatment_summary}),a.jsx(L,{k:"Medications",v:q.medications}),a.jsx(L,{k:"Follow Up",v:q.follow_up}),a.jsx(L,{k:"ICD-10 Codes",v:q.icd10_codes})]});case"ot":return a.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[a.jsx(L,{k:"Surgery",v:q.surgery_name}),a.jsx(L,{k:"Code",v:q.surgery_code}),a.jsx(L,{k:"Estimated Cost",v:q.estimated_cost}),a.jsx(L,{k:"Scheduled",v:`${q.scheduled_start||""}  ${q.scheduled_end||""}`}),a.jsx(L,{k:"Actual",v:`${q.actual_start||""}  ${q.actual_end||""}`}),a.jsx(L,{k:"Status",v:q.status}),a.jsx(L,{k:"Pre-op Notes",v:q.preop_notes}),a.jsx(L,{k:"Post-op Notes",v:q.postop_notes})]});case"billing":return a.jsxs("div",{className:"mt-2 space-y-2 text-sm text-slate-800",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2 md:grid-cols-4",children:[a.jsx(L,{k:"Invoice ID",v:q.invoice_id}),a.jsx(L,{k:"Status",v:q.status}),a.jsx(L,{k:"Net Total",v:q.net_total}),a.jsx(L,{k:"Balance",v:q.balance_due})]}),Array.isArray(q.items)&&q.items.length>0&&a.jsxs("div",{children:[a.jsx("div",{className:"text-[11px] font-medium text-slate-600 uppercase tracking-wide",children:"Items"}),a.jsx("div",{className:"mt-1 divide-y rounded-2xl border border-slate-200 bg-slate-50",children:q.items.map((K,X)=>a.jsxs("div",{className:"grid gap-2 p-2.5 md:grid-cols-6",children:[a.jsx("div",{className:"md:col-span-2 text-xs text-slate-800",children:K.description}),a.jsx("div",{className:"text-xs text-slate-600",children:K.service_type}),a.jsxs("div",{className:"text-xs text-slate-600",children:["Qty: ",K.quantity]}),a.jsxs("div",{className:"text-xs text-slate-600",children:["Unit: ",K.unit_price]}),a.jsxs("div",{className:"text-xs text-slate-600",children:["Total: ",K.line_total]})]},X))})]}),Array.isArray(q.payments)&&q.payments.length>0&&a.jsxs("div",{children:[a.jsx("div",{className:"text-[11px] font-medium text-slate-600 uppercase tracking-wide",children:"Payments"}),a.jsx("div",{className:"mt-1 divide-y rounded-2xl border border-slate-200 bg-slate-50",children:q.payments.map((K,X)=>a.jsxs("div",{className:"grid gap-2 p-2.5 md:grid-cols-4",children:[a.jsxs("div",{className:"text-xs text-slate-600",children:["Mode: ",K.mode]}),a.jsxs("div",{className:"text-xs text-slate-600",children:["Ref: ",K.reference_no||""]}),a.jsxs("div",{className:"text-xs text-slate-600",children:["",K.amount]}),a.jsx("div",{className:"text-xs text-slate-600",children:K.paid_at})]},X))})]})]});case"attachment":return null;case"consent":return a.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[a.jsx(L,{k:"Type",v:q.type}),a.jsx(L,{k:"Captured at",v:q.captured_at}),a.jsx(L,{k:"Text",v:q.text})]});default:return null}}const V=z=>{const q=OP(z);if(q==="other"){window.open(z.url,"_blank","noopener,noreferrer");return}S({url:z.url,label:z.label||"Attachment",kind:q})},F=()=>{S(null)},Q=()=>{if(!m)return;const z=window.open(m);z&&z.addEventListener("load",()=>{z.focus(),z.print()})},U=()=>{!m||!t||E0(m,`EMR_${t.uhid||"patient"}.pdf`)};return a.jsxs("div",{className:"min-h-screen bg-slate-50",children:[a.jsxs("div",{className:"mx-auto max-w-6xl px-3 py-4 md:px-6 md:py-6 lg:px-8",children:[a.jsxs("div",{className:"mb-3 flex items-center justify-between gap-2",children:[a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1 text-[10px] font-medium uppercase tracking-wide text-slate-500",children:[a.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 animate-pulse"}),"EMR  Patient record & timeline"]}),a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1 text-[10px] font-medium text-slate-500",children:[a.jsx(ete,{className:"h-3 w-3"}),"Desktop workspace"]})]}),a.jsx(ht.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2},children:a.jsxs(Re,{className:"mb-5 rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsxs(Ye,{className:"flex flex-col gap-4 border-b border-slate-100 pb-4 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-3xl bg-slate-900 text-slate-50",children:a.jsx(kn,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx(Ze,{className:"text-xl font-semibold text-slate-900",children:"Patient EMR Timeline"}),a.jsx(ma,{className:"text-sm text-slate-600",children:"Unified view of OPD, IPD, lab, radiology, pharmacy, billing, attachments and consents  ready to export as a clean EMR PDF."})]})]}),a.jsxs("div",{className:"grid gap-2 text-xs text-slate-600 sm:grid-cols-3 sm:text-right",children:[a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[a.jsx("div",{className:"text-[10px] font-medium uppercase tracking-wide text-slate-500",children:"Selected patient"}),a.jsx("div",{className:"mt-1 text-[13px] font-semibold text-slate-900",children:t?t.uhid:"None"}),a.jsx("div",{className:"truncate text-[11px] text-slate-500",children:t?t.name:"Use search to pick a patient"})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[a.jsx("div",{className:"text-[10px] font-medium uppercase tracking-wide text-slate-500",children:"Total events"}),a.jsx("div",{className:"mt-1 text-[13px] font-semibold text-slate-900",children:P}),a.jsx("div",{className:"text-[11px] text-slate-500",children:"Across visits, orders & billing"})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[a.jsx("div",{className:"text-[10px] font-medium uppercase tracking-wide text-slate-500",children:"Date range"}),a.jsx("div",{className:"mt-1 text-[13px] font-semibold text-slate-900",children:M}),a.jsx("div",{className:"text-[11px] text-slate-500",children:"Filter scope for EMR export"})]})]})]}),a.jsx(Be,{className:"pt-4",children:a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-500",children:[a.jsx(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-white px-2.5 py-1 text-[10px] font-medium uppercase tracking-wide text-slate-500",children:"EMR Viewer"}),a.jsx("span",{className:"hidden text-[11px] text-slate-500 sm:inline",children:"Apply filters, review visits and export a print-aligned EMR PDF."})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs(Te,{variant:"outline",size:"sm",className:"inline-flex items-center gap-1 rounded-full border-slate-200 bg-white text-xs text-slate-700 hover:bg-slate-100",onClick:()=>u(z=>z+1),children:[a.jsx(bc,{className:"h-3.5 w-3.5"}),"Refresh"]}),a.jsxs(Te,{size:"sm",className:"inline-flex items-center gap-1 rounded-full bg-slate-900 px-3 py-2 text-xs font-medium text-white hover:bg-slate-800",onClick:O,children:[a.jsx(Bj,{className:"h-3.5 w-3.5"}),"Preview / Print EMR PDF"]}),a.jsxs(Te,{variant:"outline",size:"sm",className:"inline-flex items-center gap-1 rounded-full border-slate-200 bg-white text-xs text-slate-700 hover:bg-slate-100",onClick:D,children:[a.jsx(y1,{className:"h-3.5 w-3.5"}),"Export FHIR (JSON)"]})]})]})})]})}),a.jsxs("div",{className:"mt-4 lg:grid lg:grid-cols-[280px,minmax(0,1fr)] lg:gap-6",children:[a.jsxs("div",{className:"mb-4 space-y-4 lg:mb-0 lg:sticky lg:top-24",children:[a.jsx(ht.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2,delay:.05},children:a.jsxs(Re,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsxs(Ye,{className:"pb-3",children:[a.jsx(Ze,{className:"text-sm font-semibold text-slate-900",children:"Patient"}),a.jsx(ma,{className:"text-xs text-slate-500",children:"Search and select a patient to view their EMR timeline."})]}),a.jsxs(Be,{className:"space-y-3",children:[a.jsx(bpe,{onPick:z=>{n(z),fe.success(`Selected ${z.uhid}  ${z.name}`)}}),t&&a.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-700",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[a.jsx(bp,{className:"h-3.5 w-3.5 text-slate-500"}),a.jsx("span",{className:"font-medium text-slate-900",children:t.uhid}),a.jsx(d0,{className:"h-3.5 w-3.5 text-slate-400"}),a.jsx("span",{className:"truncate",children:t.name}),t.gender&&a.jsxs(a.Fragment,{children:[a.jsx(d0,{className:"h-3.5 w-3.5 text-slate-400"}),a.jsx("span",{className:"uppercase text-slate-500",children:t.gender})]}),t.dob&&a.jsxs(a.Fragment,{children:[a.jsx(d0,{className:"h-3.5 w-3.5 text-slate-400"}),a.jsxs("span",{className:"text-slate-500",children:["DOB ",t.dob]})]}),t.phone&&a.jsxs(a.Fragment,{children:[a.jsx(d0,{className:"h-3.5 w-3.5 text-slate-400"}),a.jsx("span",{className:"text-slate-500",children:t.phone})]})]})})]})]})}),a.jsx(ht.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2,delay:.1},children:a.jsxs(Re,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsx(Ye,{className:"pb-3",children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx(Ze,{className:"text-sm font-semibold text-slate-900",children:"Filters"}),a.jsx(ma,{className:"text-xs text-slate-500",children:"Date range, data types and consent requirement."})]})})}),a.jsxs(Be,{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"mb-1.5 flex items-center gap-2 text-xs font-semibold text-slate-900",children:[a.jsx(uf,{className:"h-3.5 w-3.5 text-slate-500"}),"Date range"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx(uf,{className:"pointer-events-none absolute left-2.5 top-1/2 h-3.5 w-3.5 -translate-y-1/2 text-slate-400"}),a.jsx(Ne,{type:"date",className:"h-8 rounded-2xl border-slate-200 bg-slate-50 pl-8 pr-2 text-xs text-slate-700",value:r.date_from,onChange:z=>s(q=>({...q,date_from:z.target.value}))})]}),a.jsxs("div",{className:"relative",children:[a.jsx(uf,{className:"pointer-events-none absolute left-2.5 top-1/2 h-3.5 w-3.5 -translate-y-1/2 text-slate-400"}),a.jsx(Ne,{type:"date",className:"h-8 rounded-2xl border-slate-200 bg-slate-50 pl-8 pr-2 text-xs text-slate-700",value:r.date_to,onChange:z=>s(q=>({...q,date_to:z.target.value}))})]})]}),a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Leave blank for full EMR history."})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"mb-1.5 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold text-slate-900",children:[a.jsx(Ec,{className:"h-3.5 w-3.5 text-slate-500"}),"Types"]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",onClick:A,className:"text-[10px] font-medium text-slate-600 hover:text-slate-900",children:"All"}),a.jsx("button",{type:"button",onClick:k,className:"text-[10px] font-medium text-slate-500 hover:text-slate-900",children:"Clear"})]})]}),a.jsx("div",{className:"flex flex-wrap gap-1.5",children:cm.map(z=>{const q=z.icon,K=h.has(z.code);return a.jsxs("button",{type:"button",onClick:()=>_(z.code),className:["inline-flex items-center gap-1 rounded-full border px-2.5 py-1 text-[10px] font-medium transition",K?"border-slate-900 bg-slate-900 text-white shadow-sm":"border-slate-200 bg-white text-slate-600 hover:bg-slate-50"].join(" "),children:[a.jsx(q,{className:"h-3 w-3"}),z.label]},z.code)})})]}),a.jsxs("div",{className:"flex items-start gap-2 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[a.jsx("input",{id:"consentReq",type:"checkbox",checked:!!r.consent_required,onChange:z=>s(q=>({...q,consent_required:z.target.checked})),className:"mt-0.5 h-3.5 w-3.5 rounded border-slate-300 text-slate-900"}),a.jsxs("div",{className:"space-y-0.5",children:[a.jsx("label",{htmlFor:"consentReq",className:"block text-xs font-medium text-slate-900",children:"Require active consent for export"}),a.jsx("p",{className:"text-[11px] text-slate-500",children:"When enabled, EMR PDF export is blocked unless a valid patient consent record exists."})]})]})]})]})})]}),a.jsx(ht.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2,delay:.08},className:"space-y-4",children:a.jsxs(Re,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsx(Ye,{className:"pb-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(kn,{className:"h-4 w-4 text-slate-500"}),a.jsx(Ze,{className:"text-sm font-semibold text-slate-900",children:"Timeline"})]}),a.jsx("span",{className:"text-[11px] text-slate-500",children:"Sorted newest to oldest"})]})}),a.jsxs(Be,{children:[i&&a.jsx("div",{className:"space-y-3",children:Array.from({length:5}).map((z,q)=>a.jsx(Xe,{className:"h-16 w-full rounded-2xl bg-slate-100"},q))}),!i&&(!l||l.length===0)&&a.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-6 py-8 text-center",children:[a.jsx("div",{className:"mx-auto mb-2 flex h-8 w-8 items-center justify-center rounded-full border border-slate-200 bg-white text-slate-500",children:a.jsx(kn,{className:"h-4 w-4"})}),a.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"No EMR events to display"}),a.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Pick a patient and adjust the date range or type filters to load their EMR timeline."})]}),!i&&l&&l.length>0&&a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute left-4 top-0 bottom-0 w-px bg-gradient-to-b from-slate-200 via-slate-200/70 to-transparent"}),a.jsx("div",{className:"space-y-6",children:T.map(([z,q])=>a.jsxs("div",{className:"relative pl-10",children:[a.jsxs("div",{className:"mb-2 inline-flex items-center gap-2 rounded-full border border-slate-200 bg-slate-50 px-3 py-1 text-[11px] font-medium text-slate-700",children:[a.jsx(uf,{className:"h-3.5 w-3.5 text-slate-500"}),z]}),a.jsx("div",{className:"space-y-3",children:q.map((K,X)=>{var de,ye;const J=[K.doctor_name?`Dr. ${K.doctor_name}`:null,K.department_name||null,K.location_name||null].filter(Boolean).join("  "),ne=((de=cm.find(be=>be.code===K.type))==null?void 0:de.icon)||y1,Se=K.status&&(_pe[K.status]||"border-slate-200 bg-slate-50 text-slate-600");return a.jsxs(ht.div,{initial:{opacity:0,y:4},animate:{opacity:1,y:0},transition:{duration:.15},className:"relative",children:[a.jsx("div",{className:"absolute -left-[9px] top-4 h-2.5 w-2.5 rounded-full border border-slate-200 bg-white"}),a.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3.5 hover:shadow-[0_4px_12px_rgba(15,23,42,0.06)]",children:a.jsx("div",{className:"flex items-start justify-between gap-3",children:a.jsxs("div",{className:"flex min-w-0 items-start gap-3",children:[a.jsx("div",{className:"mt-0.5 flex h-8 w-8 items-center justify-center rounded-2xl bg-slate-900 text-slate-50",children:a.jsx(ne,{className:"h-4 w-4"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:K.title||"Event"}),a.jsx("div",{className:"text-[11px] text-slate-500",children:wpe(K.ts)}),K.status&&a.jsx("span",{className:`${Cpe} ${Se}`,children:K.status})]}),J&&a.jsx("div",{className:"mt-0.5 text-[11px] text-slate-500",children:J}),$(K),((ye=K.attachments)==null?void 0:ye.length)>0&&a.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:K.attachments.map((be,xe)=>{const _e=OP(be);return a.jsxs("div",{className:"inline-flex items-center gap-1.5 rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-[10px]",children:[a.jsxs("button",{type:"button",onClick:()=>V(be),className:"inline-flex items-center gap-1 text-slate-700 hover:text-slate-900",children:[a.jsx(zm,{className:"h-3 w-3"}),be.label||"attachment"]}),a.jsxs("button",{type:"button",onClick:()=>E0(be.url,be.label||"attachment"),className:"inline-flex items-center gap-1 text-slate-400 hover:text-slate-700",children:[a.jsx($d,{className:"h-3 w-3"}),a.jsx("span",{className:"hidden sm:inline",children:"Download"})]}),a.jsx("span",{className:"text-[9px] uppercase text-slate-400",children:_e})]},xe)})})]})]})})})]},`${K.type}-${String(K.ts)}-${X}`)})})]},z))})]})]})]})})]})]}),y&&m&&a.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/60",children:a.jsxs("div",{className:"relative flex h-[90vh] w-[95vw] max-w-6xl flex-col overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-2xl",children:[a.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 px-4 py-2.5",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"EMR PDF Preview"}),t&&a.jsxs("div",{className:"text-[11px] text-slate-500",children:[t.uhid,"  ",t.name]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(Te,{variant:"outline",size:"sm",className:"inline-flex items-center gap-1 rounded-full border-slate-200 bg-white text-[11px] text-slate-700 hover:bg-slate-100",onClick:U,children:[a.jsx($d,{className:"h-3 w-3"}),"Download"]}),a.jsxs(Te,{size:"sm",className:"inline-flex items-center gap-1 rounded-full bg-slate-900 px-3 py-1.5 text-[11px] text-white hover:bg-slate-800",onClick:Q,children:[a.jsx(Bj,{className:"h-3 w-3"}),"Print"]}),a.jsx("button",{type:"button",onClick:()=>N(!1),className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-slate-100 text-slate-600 hover:bg-slate-200",children:a.jsx(La,{className:"h-4 w-4"})})]})]}),a.jsx("div",{className:"flex-1 bg-slate-100",children:a.jsx("iframe",{src:m,title:"EMR PDF",className:"h-full w-full"})})]})}),j&&a.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/60",children:a.jsxs("div",{className:"relative flex h-[90vh] w-[95vw] max-w-4xl flex-col overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-2xl",children:[a.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 px-4 py-2.5",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-slate-900",children:j.label}),a.jsxs("div",{className:"text-[11px] uppercase text-slate-400",children:[j.kind," preview"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(Te,{variant:"outline",size:"sm",className:"inline-flex items-center gap-1 rounded-full border-slate-200 bg-white text-[11px] text-slate-700 hover:bg-slate-100",onClick:()=>E0(j.url,j.label),children:[a.jsx($d,{className:"h-3 w-3"}),"Download"]}),a.jsx("button",{type:"button",onClick:F,className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-slate-100 text-slate-600 hover:bg-slate-200",children:a.jsx(La,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{className:"flex-1 bg-slate-100",children:[j.kind==="image"&&a.jsx("div",{className:"flex h-full w-full items-center justify-center overflow-auto bg-black",children:a.jsx("img",{src:j.url,alt:j.label,className:"max-h-full max-w-full object-contain"})}),j.kind==="pdf"&&a.jsx("iframe",{src:j.url,title:j.label,className:"h-full w-full"}),j.kind==="other"&&a.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-3 p-6 text-center text-sm text-slate-600",children:[a.jsx("p",{children:"This file type cant be previewed here. You can open it in a new tab or download it."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Te,{size:"sm",className:"rounded-full bg-slate-900 px-4 py-1 text-[11px] text-white hover:bg-slate-800",onClick:()=>window.open(j.url,"_blank","noopener,noreferrer"),children:"Open in new tab"}),a.jsx(Te,{variant:"outline",size:"sm",className:"rounded-full border-slate-200 bg-white px-4 py-1 text-[11px] text-slate-700 hover:bg-slate-100",onClick:()=>E0(j.url,j.label),children:"Download"})]})]})]})]})})]})}const VA=(t={})=>te.get("/templates/templates",{params:t}),Epe=t=>te.get(`/templates/templates/${t}`),kpe=t=>te.post("/templates/templates",t),Tpe=(t,n)=>te.patch(`/templates/templates/${t}`,n),Ipe=t=>te.delete(`/templates/templates/${t}`),mF=(t,n,r=null)=>te.post(`/templates/templates/${t}/render-html`,r?{data:r}:{},{params:{patient_id:n}}),Ppe=async(t,n)=>(await te.get(`/templates/templates/${t}/pdf`,{params:{patient_id:n,inline:!1},responseType:"blob"})).data,Mpe=async(t,n)=>(await te.post(`/templates/templates/${t}/pdf`,n,{responseType:"blob"})).data,Ope=(t,n)=>te.post(`/templates/patients/${t}/consents`,n),Dpe=t=>te.get(`/templates/patients/${t}/consents`),Rpe=async t=>{const n=new FormData;return n.append("file",t),(await te.post("/files/upload",n,{headers:{"Content-Type":"multipart/form-data"}})).data};function Lpe(){const[t,n]=b.useState([]),[r,s]=b.useState(""),[i,o]=b.useState(""),[l,c]=b.useState(!1),d=async()=>{c(!0);try{const m=await VA({q:r,category:i||void 0});n(m.data||[])}finally{c(!1)}};b.useEffect(()=>{d()},[]);const u=async m=>{m.preventDefault(),d()},h=async m=>{if(confirm("Delete this template?"))try{await Ipe(m),fe.success("Deleted"),d()}catch{}};return a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"mb-4 flex items-center justify-between gap-2",children:[a.jsx("h1",{className:"text-xl font-semibold",children:"Templates"}),a.jsx(So,{to:"/templates/new",className:"bg-blue-600 text-white px-3 py-2 rounded-lg text-sm",children:"New Template"})]}),a.jsxs("form",{onSubmit:u,className:"mb-3 flex flex-wrap gap-2",children:[a.jsx("input",{value:r,onChange:m=>s(m.target.value),placeholder:"Search name/code...",className:"border rounded px-3 py-2 text-sm"}),a.jsxs("select",{value:i,onChange:m=>o(m.target.value),className:"border rounded px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"All"}),a.jsx("option",{value:"report",children:"Report"}),a.jsx("option",{value:"consent",children:"Consent"})]}),a.jsx("button",{className:"px-3 py-2 border rounded text-sm",children:"Filter"})]}),a.jsx("div",{className:"overflow-x-auto bg-white border rounded-lg",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"#"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Name"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Code"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Category"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Version"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[t.map(m=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:m.id}),a.jsx("td",{className:"px-3 py-2",children:m.name}),a.jsx("td",{className:"px-3 py-2",children:m.code}),a.jsx("td",{className:"px-3 py-2 capitalize",children:m.category}),a.jsx("td",{className:"px-3 py-2",children:m.version}),a.jsxs("td",{className:"px-3 py-2 text-right",children:[a.jsx(So,{to:`/templates/${m.id}/edit`,className:"px-2 py-1 text-blue-700 hover:underline",children:"Edit"}),a.jsx("button",{onClick:()=>h(m.id),className:"px-2 py-1 text-red-600 hover:underline",children:"Delete"})]})]},m.id)),t.length===0&&!l&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-3 py-6 text-center text-gray-500",children:"No templates"})})]})]})})]})}const DP=["system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif","Arial, Helvetica, sans-serif","'Times New Roman', Times, serif","'Georgia', serif","'Courier New', Courier, monospace","'Inter', system-ui, -apple-system, sans-serif"],RP=["#000000","#444444","#666666","#999999","#CCCCCC","#EEEEEE","#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB"];function AN({value:t,onChange:n}){const r=b.useRef(null),s=b.useRef(null),[i,o]=b.useState(DP[0]);b.useEffect(()=>{r.current&&r.current.innerHTML!==(t||"")&&(r.current.innerHTML=t||"")},[t]);const l=()=>{var O;return((O=r.current)==null?void 0:O.innerHTML)||""},c=()=>n&&n(l()),d=O=>{document.execCommand("styleWithCSS",!1,!0);const D=window.getSelection();if(!D||D.rangeCount===0)return;const L=D.getRangeAt(0),$=document.createElement("span");Object.entries(O).forEach(([V,F])=>$.style[V]=F),L.surroundContents($),c()},u=(O,D=null)=>{document.execCommand("styleWithCSS",!1,!0),document.execCommand(O,!1,D),c()},h=(O,D="",L=null)=>{const $=window.getSelection();if(!$||$.rangeCount===0)return;const V=$.getRangeAt(0),F=document.createElement(O);D&&(F.className=D),L&&Object.entries(L).forEach(([Q,U])=>F.style[Q]=U),V.surroundContents(F),c()},m=()=>{var O;return(O=s.current)==null?void 0:O.click()},g=async O=>{var L,$;const D=(L=O.target.files)==null?void 0:L[0];if(D)try{const V=await Rpe(D),F="".replace(/\/$/,""),Q=V.file_url_abs?V.file_url_abs:($=V.file_url)!=null&&$.startsWith("http")?V.file_url:`${F}${V.file_url}`;y(`<img src="${Q}" alt="${V.original_name||""}" style="max-width:100%;">`)}catch{fe.error("Upload failed")}finally{O.target.value=""}},y=O=>{var D;(D=r.current)==null||D.focus(),document.execCommand("insertHTML",!1,O),c()},N=()=>{var F;const O=window.getSelection();if(!O||O.rangeCount===0)return null;const D=O.getRangeAt(0),L=D.commonAncestorContainer.nodeType===1?D.commonAncestorContainer:D.commonAncestorContainer.parentNode;if(!L)return null;const $=L.querySelectorAll?L.querySelectorAll("img"):[],V=(F=O.anchorNode)==null?void 0:F.parentNode;if(V&&V.tagName==="IMG")return V;if(V!=null&&V.closest){const Q=V.closest("img");if(Q)return Q}return $.length?$[0]:null},j=O=>{const D=N();if(!D)return fe.info("Select an image first");D.style.width=O,O==="100%"&&(D.style.maxWidth="100%"),c()},S=O=>{const D=N();if(!D)return fe.info("Select an image first");D.classList.remove("float-left","float-right","img-center"),D.style.removeProperty("float"),D.style.removeProperty("display"),D.style.removeProperty("margin-left"),D.style.removeProperty("margin-right"),O==="left"&&D.classList.add("float-left"),O==="right"&&D.classList.add("float-right"),O==="center"&&D.classList.add("img-center"),c()},_=O=>{var $,V;const D=window.getSelection();if(!D||D.rangeCount===0)return null;let L=(($=D.anchorNode)==null?void 0:$.nodeType)===1?D.anchorNode:(V=D.anchorNode)==null?void 0:V.parentNode;for(;L;){if(L.tagName&&O.includes(L.tagName))return L;L=L.parentNode}return null},A=O=>{var L;const D=_(["TABLE"])||((L=_(["TD","TH"]))==null?void 0:L.closest("TABLE"));if(!D)return fe.info("Place caret inside a table");D.classList.remove("tbl-border-all","tbl-border-h","tbl-border-v","tbl-border-none"),D.removeAttribute("border"),D.style.borderCollapse="collapse",D.querySelectorAll("th,td").forEach($=>{$.style.border="",$.style.borderTop="",$.style.borderBottom="",$.style.borderLeft="",$.style.borderRight=""}),O==="all"&&D.classList.add("tbl-border-all"),O==="h"&&D.classList.add("tbl-border-h"),O==="v"&&D.classList.add("tbl-border-v"),O==="none"&&D.classList.add("tbl-border-none"),c()},k=()=>{const O=_(["TD","TH"]);if(!O)return fe.info("Place caret inside a row");O.closest("tr").classList.toggle("tr-shade"),c()},T=O=>{h("div",O===2?"cols-2":"cols-3")},P=O=>{O.preventDefault();const D=O.clipboardData.getData("text/plain");document.execCommand("insertText",!1,D),c()},M=O=>{O.preventDefault();const D=O.dataTransfer.getData("text/x-token")||O.dataTransfer.getData("text/plain");if(D){y(D);return}const L=O.dataTransfer.getData("text");L&&document.execCommand("insertText",!1,L),c()};return a.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 p-2 border-b bg-gray-50",children:[a.jsx("select",{className:"text-sm border rounded px-2 py-1",value:i,onChange:O=>{o(O.target.value),d({fontFamily:O.target.value})},title:"Font family",children:DP.map(O=>a.jsx("option",{value:O,children:O.split(",")[0].replace(/['"]/g,"")},O))}),a.jsx("select",{className:"text-sm border rounded px-2 py-1",onChange:O=>d({fontSize:O.target.value}),children:["10px","12px","14px","16px","18px","20px","24px"].map(O=>a.jsx("option",{value:O,children:O},O))}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("bold"),children:a.jsx("b",{children:"B"})}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("italic"),children:a.jsx("i",{children:"I"})}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("underline"),children:a.jsx("u",{children:"U"})}),a.jsx("span",{className:"mx-1 w-px h-5 bg-gray-200"}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("justifyLeft"),children:"Left"}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("justifyCenter"),children:"Center"}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("justifyRight"),children:"Right"}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>h("span","text-justify"),children:"Justify"}),a.jsx("span",{className:"mx-1 w-px h-5 bg-gray-200"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-xs text-gray-500 mr-1",children:"Text"}),RP.map(O=>a.jsx("button",{className:"w-4 h-4 rounded border",style:{background:O},onClick:()=>u("foreColor",O)},"fg"+O))]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-xs text-gray-500 ml-2 mr-1",children:"Highlight"}),RP.map(O=>a.jsx("button",{className:"w-4 h-4 rounded border",style:{background:O},onClick:()=>u("hiliteColor",O)},"bg"+O))]}),a.jsx("span",{className:"mx-1 w-px h-5 bg-gray-200"}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("insertUnorderedList"),children:" List"}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("insertOrderedList"),children:"1. List"}),a.jsx("span",{className:"mx-1 w-px h-5 bg-gray-200"}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:m,children:"Image"}),a.jsx("input",{ref:s,type:"file",accept:"image/*",className:"hidden",onChange:g}),a.jsxs("select",{className:"text-sm border rounded px-2 py-1",onChange:O=>j(O.target.value),defaultValue:"",children:[a.jsx("option",{value:"",disabled:!0,children:"Img Width"}),a.jsx("option",{value:"25%",children:"25%"}),a.jsx("option",{value:"33%",children:"33%"}),a.jsx("option",{value:"50%",children:"50%"}),a.jsx("option",{value:"75%",children:"75%"}),a.jsx("option",{value:"100%",children:"100%"})]}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>S("left"),children:"Img Left"}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>S("center"),children:"Img Center"}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>S("right"),children:"Img Right"}),a.jsx("span",{className:"mx-1 w-px h-5 bg-gray-200"}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>T(2),children:"2 Columns"}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>T(3),children:"3 Columns"}),a.jsx("span",{className:"mx-1 w-px h-5 bg-gray-200"}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>y("<table><tr><th>Header</th><th>Header</th></tr><tr><td>Cell</td><td>Cell</td></tr></table>"),children:"Insert Table"}),a.jsxs("select",{className:"text-sm border rounded px-2 py-1",onChange:O=>A(O.target.value),defaultValue:"",children:[a.jsx("option",{value:"",disabled:!0,children:"Borders"}),a.jsx("option",{value:"all",children:"All borders"}),a.jsx("option",{value:"h",children:"Horizontal only"}),a.jsx("option",{value:"v",children:"Vertical only"}),a.jsx("option",{value:"none",children:"No borders"})]}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:k,children:"Shade Row"})]}),a.jsx("div",{ref:r,className:"min-h-[320px] p-3 prose max-w-none focus:outline-none",contentEditable:!0,onInput:c,onPaste:P,suppressContentEditableWarning:!0,spellCheck:!1}),a.jsx("div",{ref:r,className:"min-h-[320px] p-3 prose max-w-none focus:outline-none",contentEditable:!0,onInput:c,onPaste:P,onDragOver:O=>O.preventDefault(),onDrop:M,suppressContentEditableWarning:!0,spellCheck:!1}),a.jsx("div",{className:"px-3 py-1 text-[10px] text-gray-500 border-t bg-gray-50",children:"Tip: select an image to resize/align; use columns for magazine-style layouts."})]})}function fs(t){this.content=t}fs.prototype={constructor:fs,find:function(t){for(var n=0;n<this.content.length;n+=2)if(this.content[n]===t)return n;return-1},get:function(t){var n=this.find(t);return n==-1?void 0:this.content[n+1]},update:function(t,n,r){var s=r&&r!=t?this.remove(r):this,i=s.find(t),o=s.content.slice();return i==-1?o.push(r||t,n):(o[i+1]=n,r&&(o[i]=r)),new fs(o)},remove:function(t){var n=this.find(t);if(n==-1)return this;var r=this.content.slice();return r.splice(n,2),new fs(r)},addToStart:function(t,n){return new fs([t,n].concat(this.remove(t).content))},addToEnd:function(t,n){var r=this.remove(t).content.slice();return r.push(t,n),new fs(r)},addBefore:function(t,n,r){var s=this.remove(n),i=s.content.slice(),o=s.find(t);return i.splice(o==-1?i.length:o,0,n,r),new fs(i)},forEach:function(t){for(var n=0;n<this.content.length;n+=2)t(this.content[n],this.content[n+1])},prepend:function(t){return t=fs.from(t),t.size?new fs(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=fs.from(t),t.size?new fs(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var n=this;t=fs.from(t);for(var r=0;r<t.content.length;r+=2)n=n.remove(t.content[r]);return n},toObject:function(){var t={};return this.forEach(function(n,r){t[n]=r}),t},get size(){return this.content.length>>1}};fs.from=function(t){if(t instanceof fs)return t;var n=[];if(t)for(var r in t)n.push(r,t[r]);return new fs(n)};function pF(t,n,r){for(let s=0;;s++){if(s==t.childCount||s==n.childCount)return t.childCount==n.childCount?null:r;let i=t.child(s),o=n.child(s);if(i==o){r+=i.nodeSize;continue}if(!i.sameMarkup(o))return r;if(i.isText&&i.text!=o.text){for(let l=0;i.text[l]==o.text[l];l++)r++;return r}if(i.content.size||o.content.size){let l=pF(i.content,o.content,r+1);if(l!=null)return l}r+=i.nodeSize}}function xF(t,n,r,s){for(let i=t.childCount,o=n.childCount;;){if(i==0||o==0)return i==o?null:{a:r,b:s};let l=t.child(--i),c=n.child(--o),d=l.nodeSize;if(l==c){r-=d,s-=d;continue}if(!l.sameMarkup(c))return{a:r,b:s};if(l.isText&&l.text!=c.text){let u=0,h=Math.min(l.text.length,c.text.length);for(;u<h&&l.text[l.text.length-u-1]==c.text[c.text.length-u-1];)u++,r--,s--;return{a:r,b:s}}if(l.content.size||c.content.size){let u=xF(l.content,c.content,r-1,s-1);if(u)return u}r-=d,s-=d}}class Pe{constructor(n,r){if(this.content=n,this.size=r||0,r==null)for(let s=0;s<n.length;s++)this.size+=n[s].nodeSize}nodesBetween(n,r,s,i=0,o){for(let l=0,c=0;c<r;l++){let d=this.content[l],u=c+d.nodeSize;if(u>n&&s(d,i+c,o||null,l)!==!1&&d.content.size){let h=c+1;d.nodesBetween(Math.max(0,n-h),Math.min(d.content.size,r-h),s,i+h)}c=u}}descendants(n){this.nodesBetween(0,this.size,n)}textBetween(n,r,s,i){let o="",l=!0;return this.nodesBetween(n,r,(c,d)=>{let u=c.isText?c.text.slice(Math.max(n,d)-d,r-d):c.isLeaf?i?typeof i=="function"?i(c):i:c.type.spec.leafText?c.type.spec.leafText(c):"":"";c.isBlock&&(c.isLeaf&&u||c.isTextblock)&&s&&(l?l=!1:o+=s),o+=u},0),o}append(n){if(!n.size)return this;if(!this.size)return n;let r=this.lastChild,s=n.firstChild,i=this.content.slice(),o=0;for(r.isText&&r.sameMarkup(s)&&(i[i.length-1]=r.withText(r.text+s.text),o=1);o<n.content.length;o++)i.push(n.content[o]);return new Pe(i,this.size+n.size)}cut(n,r=this.size){if(n==0&&r==this.size)return this;let s=[],i=0;if(r>n)for(let o=0,l=0;l<r;o++){let c=this.content[o],d=l+c.nodeSize;d>n&&((l<n||d>r)&&(c.isText?c=c.cut(Math.max(0,n-l),Math.min(c.text.length,r-l)):c=c.cut(Math.max(0,n-l-1),Math.min(c.content.size,r-l-1))),s.push(c),i+=c.nodeSize),l=d}return new Pe(s,i)}cutByIndex(n,r){return n==r?Pe.empty:n==0&&r==this.content.length?this:new Pe(this.content.slice(n,r))}replaceChild(n,r){let s=this.content[n];if(s==r)return this;let i=this.content.slice(),o=this.size+r.nodeSize-s.nodeSize;return i[n]=r,new Pe(i,o)}addToStart(n){return new Pe([n].concat(this.content),this.size+n.nodeSize)}addToEnd(n){return new Pe(this.content.concat(n),this.size+n.nodeSize)}eq(n){if(this.content.length!=n.content.length)return!1;for(let r=0;r<this.content.length;r++)if(!this.content[r].eq(n.content[r]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(n){let r=this.content[n];if(!r)throw new RangeError("Index "+n+" out of range for "+this);return r}maybeChild(n){return this.content[n]||null}forEach(n){for(let r=0,s=0;r<this.content.length;r++){let i=this.content[r];n(i,s,r),s+=i.nodeSize}}findDiffStart(n,r=0){return pF(this,n,r)}findDiffEnd(n,r=this.size,s=n.size){return xF(this,n,r,s)}findIndex(n){if(n==0)return k0(0,n);if(n==this.size)return k0(this.content.length,n);if(n>this.size||n<0)throw new RangeError(`Position ${n} outside of fragment (${this})`);for(let r=0,s=0;;r++){let i=this.child(r),o=s+i.nodeSize;if(o>=n)return o==n?k0(r+1,o):k0(r,s);s=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(n=>n.toJSON()):null}static fromJSON(n,r){if(!r)return Pe.empty;if(!Array.isArray(r))throw new RangeError("Invalid input for Fragment.fromJSON");return new Pe(r.map(n.nodeFromJSON))}static fromArray(n){if(!n.length)return Pe.empty;let r,s=0;for(let i=0;i<n.length;i++){let o=n[i];s+=o.nodeSize,i&&o.isText&&n[i-1].sameMarkup(o)?(r||(r=n.slice(0,i)),r[r.length-1]=o.withText(r[r.length-1].text+o.text)):r&&r.push(o)}return new Pe(r||n,s)}static from(n){if(!n)return Pe.empty;if(n instanceof Pe)return n;if(Array.isArray(n))return this.fromArray(n);if(n.attrs)return new Pe([n],n.nodeSize);throw new RangeError("Can not convert "+n+" to a Fragment"+(n.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Pe.empty=new Pe([],0);const EN={index:0,offset:0};function k0(t,n){return EN.index=t,EN.offset=n,EN}function M1(t,n){if(t===n)return!0;if(!(t&&typeof t=="object")||!(n&&typeof n=="object"))return!1;let r=Array.isArray(t);if(Array.isArray(n)!=r)return!1;if(r){if(t.length!=n.length)return!1;for(let s=0;s<t.length;s++)if(!M1(t[s],n[s]))return!1}else{for(let s in t)if(!(s in n)||!M1(t[s],n[s]))return!1;for(let s in n)if(!(s in t))return!1}return!0}let $n=class jS{constructor(n,r){this.type=n,this.attrs=r}addToSet(n){let r,s=!1;for(let i=0;i<n.length;i++){let o=n[i];if(this.eq(o))return n;if(this.type.excludes(o.type))r||(r=n.slice(0,i));else{if(o.type.excludes(this.type))return n;!s&&o.type.rank>this.type.rank&&(r||(r=n.slice(0,i)),r.push(this),s=!0),r&&r.push(o)}}return r||(r=n.slice()),s||r.push(this),r}removeFromSet(n){for(let r=0;r<n.length;r++)if(this.eq(n[r]))return n.slice(0,r).concat(n.slice(r+1));return n}isInSet(n){for(let r=0;r<n.length;r++)if(this.eq(n[r]))return!0;return!1}eq(n){return this==n||this.type==n.type&&M1(this.attrs,n.attrs)}toJSON(){let n={type:this.type.name};for(let r in this.attrs){n.attrs=this.attrs;break}return n}static fromJSON(n,r){if(!r)throw new RangeError("Invalid input for Mark.fromJSON");let s=n.marks[r.type];if(!s)throw new RangeError(`There is no mark type ${r.type} in this schema`);let i=s.create(r.attrs);return s.checkAttrs(i.attrs),i}static sameSet(n,r){if(n==r)return!0;if(n.length!=r.length)return!1;for(let s=0;s<n.length;s++)if(!n[s].eq(r[s]))return!1;return!0}static setFrom(n){if(!n||Array.isArray(n)&&n.length==0)return jS.none;if(n instanceof jS)return[n];let r=n.slice();return r.sort((s,i)=>s.type.rank-i.type.rank),r}};$n.none=[];class O1 extends Error{}class Qe{constructor(n,r,s){this.content=n,this.openStart=r,this.openEnd=s}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(n,r){let s=yF(this.content,n+this.openStart,r);return s&&new Qe(s,this.openStart,this.openEnd)}removeBetween(n,r){return new Qe(gF(this.content,n+this.openStart,r+this.openStart),this.openStart,this.openEnd)}eq(n){return this.content.eq(n.content)&&this.openStart==n.openStart&&this.openEnd==n.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let n={content:this.content.toJSON()};return this.openStart>0&&(n.openStart=this.openStart),this.openEnd>0&&(n.openEnd=this.openEnd),n}static fromJSON(n,r){if(!r)return Qe.empty;let s=r.openStart||0,i=r.openEnd||0;if(typeof s!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new Qe(Pe.fromJSON(n,r.content),s,i)}static maxOpen(n,r=!0){let s=0,i=0;for(let o=n.firstChild;o&&!o.isLeaf&&(r||!o.type.spec.isolating);o=o.firstChild)s++;for(let o=n.lastChild;o&&!o.isLeaf&&(r||!o.type.spec.isolating);o=o.lastChild)i++;return new Qe(n,s,i)}}Qe.empty=new Qe(Pe.empty,0,0);function gF(t,n,r){let{index:s,offset:i}=t.findIndex(n),o=t.maybeChild(s),{index:l,offset:c}=t.findIndex(r);if(i==n||o.isText){if(c!=r&&!t.child(l).isText)throw new RangeError("Removing non-flat range");return t.cut(0,n).append(t.cut(r))}if(s!=l)throw new RangeError("Removing non-flat range");return t.replaceChild(s,o.copy(gF(o.content,n-i-1,r-i-1)))}function yF(t,n,r,s){let{index:i,offset:o}=t.findIndex(n),l=t.maybeChild(i);if(o==n||l.isText)return s&&!s.canReplace(i,i,r)?null:t.cut(0,n).append(r).append(t.cut(n));let c=yF(l.content,n-o-1,r,l);return c&&t.replaceChild(i,l.copy(c))}function Bpe(t,n,r){if(r.openStart>t.depth)throw new O1("Inserted content deeper than insertion position");if(t.depth-r.openStart!=n.depth-r.openEnd)throw new O1("Inconsistent open depths");return vF(t,n,r,0)}function vF(t,n,r,s){let i=t.index(s),o=t.node(s);if(i==n.index(s)&&s<t.depth-r.openStart){let l=vF(t,n,r,s+1);return o.copy(o.content.replaceChild(i,l))}else if(r.content.size)if(!r.openStart&&!r.openEnd&&t.depth==s&&n.depth==s){let l=t.parent,c=l.content;return Hd(l,c.cut(0,t.parentOffset).append(r.content).append(c.cut(n.parentOffset)))}else{let{start:l,end:c}=Fpe(r,t);return Hd(o,wF(t,l,c,n,s))}else return Hd(o,D1(t,n,s))}function bF(t,n){if(!n.type.compatibleContent(t.type))throw new O1("Cannot join "+n.type.name+" onto "+t.type.name)}function SS(t,n,r){let s=t.node(r);return bF(s,n.node(r)),s}function Vd(t,n){let r=n.length-1;r>=0&&t.isText&&t.sameMarkup(n[r])?n[r]=t.withText(n[r].text+t.text):n.push(t)}function Ym(t,n,r,s){let i=(n||t).node(r),o=0,l=n?n.index(r):i.childCount;t&&(o=t.index(r),t.depth>r?o++:t.textOffset&&(Vd(t.nodeAfter,s),o++));for(let c=o;c<l;c++)Vd(i.child(c),s);n&&n.depth==r&&n.textOffset&&Vd(n.nodeBefore,s)}function Hd(t,n){return t.type.checkContent(n),t.copy(n)}function wF(t,n,r,s,i){let o=t.depth>i&&SS(t,n,i+1),l=s.depth>i&&SS(r,s,i+1),c=[];return Ym(null,t,i,c),o&&l&&n.index(i)==r.index(i)?(bF(o,l),Vd(Hd(o,wF(t,n,r,s,i+1)),c)):(o&&Vd(Hd(o,D1(t,n,i+1)),c),Ym(n,r,i,c),l&&Vd(Hd(l,D1(r,s,i+1)),c)),Ym(s,null,i,c),new Pe(c)}function D1(t,n,r){let s=[];if(Ym(null,t,r,s),t.depth>r){let i=SS(t,n,r+1);Vd(Hd(i,D1(t,n,r+1)),s)}return Ym(n,null,r,s),new Pe(s)}function Fpe(t,n){let r=n.depth-t.openStart,i=n.node(r).copy(t.content);for(let o=r-1;o>=0;o--)i=n.node(o).copy(Pe.from(i));return{start:i.resolveNoCache(t.openStart+r),end:i.resolveNoCache(i.content.size-t.openEnd-r)}}class Ip{constructor(n,r,s){this.pos=n,this.path=r,this.parentOffset=s,this.depth=r.length/3-1}resolveDepth(n){return n==null?this.depth:n<0?this.depth+n:n}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(n){return this.path[this.resolveDepth(n)*3]}index(n){return this.path[this.resolveDepth(n)*3+1]}indexAfter(n){return n=this.resolveDepth(n),this.index(n)+(n==this.depth&&!this.textOffset?0:1)}start(n){return n=this.resolveDepth(n),n==0?0:this.path[n*3-1]+1}end(n){return n=this.resolveDepth(n),this.start(n)+this.node(n).content.size}before(n){if(n=this.resolveDepth(n),!n)throw new RangeError("There is no position before the top-level node");return n==this.depth+1?this.pos:this.path[n*3-1]}after(n){if(n=this.resolveDepth(n),!n)throw new RangeError("There is no position after the top-level node");return n==this.depth+1?this.pos:this.path[n*3-1]+this.path[n*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let n=this.parent,r=this.index(this.depth);if(r==n.childCount)return null;let s=this.pos-this.path[this.path.length-1],i=n.child(r);return s?n.child(r).cut(s):i}get nodeBefore(){let n=this.index(this.depth),r=this.pos-this.path[this.path.length-1];return r?this.parent.child(n).cut(0,r):n==0?null:this.parent.child(n-1)}posAtIndex(n,r){r=this.resolveDepth(r);let s=this.path[r*3],i=r==0?0:this.path[r*3-1]+1;for(let o=0;o<n;o++)i+=s.child(o).nodeSize;return i}marks(){let n=this.parent,r=this.index();if(n.content.size==0)return $n.none;if(this.textOffset)return n.child(r).marks;let s=n.maybeChild(r-1),i=n.maybeChild(r);if(!s){let c=s;s=i,i=c}let o=s.marks;for(var l=0;l<o.length;l++)o[l].type.spec.inclusive===!1&&(!i||!o[l].isInSet(i.marks))&&(o=o[l--].removeFromSet(o));return o}marksAcross(n){let r=this.parent.maybeChild(this.index());if(!r||!r.isInline)return null;let s=r.marks,i=n.parent.maybeChild(n.index());for(var o=0;o<s.length;o++)s[o].type.spec.inclusive===!1&&(!i||!s[o].isInSet(i.marks))&&(s=s[o--].removeFromSet(s));return s}sharedDepth(n){for(let r=this.depth;r>0;r--)if(this.start(r)<=n&&this.end(r)>=n)return r;return 0}blockRange(n=this,r){if(n.pos<this.pos)return n.blockRange(this);for(let s=this.depth-(this.parent.inlineContent||this.pos==n.pos?1:0);s>=0;s--)if(n.pos<=this.end(s)&&(!r||r(this.node(s))))return new R1(this,n,s);return null}sameParent(n){return this.pos-this.parentOffset==n.pos-n.parentOffset}max(n){return n.pos>this.pos?n:this}min(n){return n.pos<this.pos?n:this}toString(){let n="";for(let r=1;r<=this.depth;r++)n+=(n?"/":"")+this.node(r).type.name+"_"+this.index(r-1);return n+":"+this.parentOffset}static resolve(n,r){if(!(r>=0&&r<=n.content.size))throw new RangeError("Position "+r+" out of range");let s=[],i=0,o=r;for(let l=n;;){let{index:c,offset:d}=l.content.findIndex(o),u=o-d;if(s.push(l,c,i+d),!u||(l=l.child(c),l.isText))break;o=u-1,i+=d+1}return new Ip(r,s,o)}static resolveCached(n,r){let s=LP.get(n);if(s)for(let o=0;o<s.elts.length;o++){let l=s.elts[o];if(l.pos==r)return l}else LP.set(n,s=new $pe);let i=s.elts[s.i]=Ip.resolve(n,r);return s.i=(s.i+1)%zpe,i}}class $pe{constructor(){this.elts=[],this.i=0}}const zpe=12,LP=new WeakMap;class R1{constructor(n,r,s){this.$from=n,this.$to=r,this.depth=s}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const Upe=Object.create(null);let jc=class CS{constructor(n,r,s,i=$n.none){this.type=n,this.attrs=r,this.marks=i,this.content=s||Pe.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(n){return this.content.child(n)}maybeChild(n){return this.content.maybeChild(n)}forEach(n){this.content.forEach(n)}nodesBetween(n,r,s,i=0){this.content.nodesBetween(n,r,s,i,this)}descendants(n){this.nodesBetween(0,this.content.size,n)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(n,r,s,i){return this.content.textBetween(n,r,s,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(n){return this==n||this.sameMarkup(n)&&this.content.eq(n.content)}sameMarkup(n){return this.hasMarkup(n.type,n.attrs,n.marks)}hasMarkup(n,r,s){return this.type==n&&M1(this.attrs,r||n.defaultAttrs||Upe)&&$n.sameSet(this.marks,s||$n.none)}copy(n=null){return n==this.content?this:new CS(this.type,this.attrs,n,this.marks)}mark(n){return n==this.marks?this:new CS(this.type,this.attrs,this.content,n)}cut(n,r=this.content.size){return n==0&&r==this.content.size?this:this.copy(this.content.cut(n,r))}slice(n,r=this.content.size,s=!1){if(n==r)return Qe.empty;let i=this.resolve(n),o=this.resolve(r),l=s?0:i.sharedDepth(r),c=i.start(l),u=i.node(l).content.cut(i.pos-c,o.pos-c);return new Qe(u,i.depth-l,o.depth-l)}replace(n,r,s){return Bpe(this.resolve(n),this.resolve(r),s)}nodeAt(n){for(let r=this;;){let{index:s,offset:i}=r.content.findIndex(n);if(r=r.maybeChild(s),!r)return null;if(i==n||r.isText)return r;n-=i+1}}childAfter(n){let{index:r,offset:s}=this.content.findIndex(n);return{node:this.content.maybeChild(r),index:r,offset:s}}childBefore(n){if(n==0)return{node:null,index:0,offset:0};let{index:r,offset:s}=this.content.findIndex(n);if(s<n)return{node:this.content.child(r),index:r,offset:s};let i=this.content.child(r-1);return{node:i,index:r-1,offset:s-i.nodeSize}}resolve(n){return Ip.resolveCached(this,n)}resolveNoCache(n){return Ip.resolve(this,n)}rangeHasMark(n,r,s){let i=!1;return r>n&&this.nodesBetween(n,r,o=>(s.isInSet(o.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let n=this.type.name;return this.content.size&&(n+="("+this.content.toStringInner()+")"),NF(this.marks,n)}contentMatchAt(n){let r=this.type.contentMatch.matchFragment(this.content,0,n);if(!r)throw new Error("Called contentMatchAt on a node with invalid content");return r}canReplace(n,r,s=Pe.empty,i=0,o=s.childCount){let l=this.contentMatchAt(n).matchFragment(s,i,o),c=l&&l.matchFragment(this.content,r);if(!c||!c.validEnd)return!1;for(let d=i;d<o;d++)if(!this.type.allowsMarks(s.child(d).marks))return!1;return!0}canReplaceWith(n,r,s,i){if(i&&!this.type.allowsMarks(i))return!1;let o=this.contentMatchAt(n).matchType(s),l=o&&o.matchFragment(this.content,r);return l?l.validEnd:!1}canAppend(n){return n.content.size?this.canReplace(this.childCount,this.childCount,n.content):this.type.compatibleContent(n.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let n=$n.none;for(let r=0;r<this.marks.length;r++){let s=this.marks[r];s.type.checkAttrs(s.attrs),n=s.addToSet(n)}if(!$n.sameSet(n,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(r=>r.type.name)}`);this.content.forEach(r=>r.check())}toJSON(){let n={type:this.type.name};for(let r in this.attrs){n.attrs=this.attrs;break}return this.content.size&&(n.content=this.content.toJSON()),this.marks.length&&(n.marks=this.marks.map(r=>r.toJSON())),n}static fromJSON(n,r){if(!r)throw new RangeError("Invalid input for Node.fromJSON");let s;if(r.marks){if(!Array.isArray(r.marks))throw new RangeError("Invalid mark data for Node.fromJSON");s=r.marks.map(n.markFromJSON)}if(r.type=="text"){if(typeof r.text!="string")throw new RangeError("Invalid text node in JSON");return n.text(r.text,s)}let i=Pe.fromJSON(n,r.content),o=n.nodeType(r.type).create(r.attrs,i,s);return o.type.checkAttrs(o.attrs),o}};jc.prototype.text=void 0;class L1 extends jc{constructor(n,r,s,i){if(super(n,r,null,i),!s)throw new RangeError("Empty text nodes are not allowed");this.text=s}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):NF(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(n,r){return this.text.slice(n,r)}get nodeSize(){return this.text.length}mark(n){return n==this.marks?this:new L1(this.type,this.attrs,this.text,n)}withText(n){return n==this.text?this:new L1(this.type,this.attrs,n,this.marks)}cut(n=0,r=this.text.length){return n==0&&r==this.text.length?this:this.withText(this.text.slice(n,r))}eq(n){return this.sameMarkup(n)&&this.text==n.text}toJSON(){let n=super.toJSON();return n.text=this.text,n}}function NF(t,n){for(let r=t.length-1;r>=0;r--)n=t[r].type.name+"("+n+")";return n}class lu{constructor(n){this.validEnd=n,this.next=[],this.wrapCache=[]}static parse(n,r){let s=new Vpe(n,r);if(s.next==null)return lu.empty;let i=jF(s);s.next&&s.err("Unexpected trailing text");let o=Xpe(Ype(i));return Qpe(o,s),o}matchType(n){for(let r=0;r<this.next.length;r++)if(this.next[r].type==n)return this.next[r].next;return null}matchFragment(n,r=0,s=n.childCount){let i=this;for(let o=r;i&&o<s;o++)i=i.matchType(n.child(o).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let n=0;n<this.next.length;n++){let{type:r}=this.next[n];if(!(r.isText||r.hasRequiredAttrs()))return r}return null}compatible(n){for(let r=0;r<this.next.length;r++)for(let s=0;s<n.next.length;s++)if(this.next[r].type==n.next[s].type)return!0;return!1}fillBefore(n,r=!1,s=0){let i=[this];function o(l,c){let d=l.matchFragment(n,s);if(d&&(!r||d.validEnd))return Pe.from(c.map(u=>u.createAndFill()));for(let u=0;u<l.next.length;u++){let{type:h,next:m}=l.next[u];if(!(h.isText||h.hasRequiredAttrs())&&i.indexOf(m)==-1){i.push(m);let g=o(m,c.concat(h));if(g)return g}}return null}return o(this,[])}findWrapping(n){for(let s=0;s<this.wrapCache.length;s+=2)if(this.wrapCache[s]==n)return this.wrapCache[s+1];let r=this.computeWrapping(n);return this.wrapCache.push(n,r),r}computeWrapping(n){let r=Object.create(null),s=[{match:this,type:null,via:null}];for(;s.length;){let i=s.shift(),o=i.match;if(o.matchType(n)){let l=[];for(let c=i;c.type;c=c.via)l.push(c.type);return l.reverse()}for(let l=0;l<o.next.length;l++){let{type:c,next:d}=o.next[l];!c.isLeaf&&!c.hasRequiredAttrs()&&!(c.name in r)&&(!i.type||d.validEnd)&&(s.push({match:c.contentMatch,type:c,via:i}),r[c.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(n){if(n>=this.next.length)throw new RangeError(`There's no ${n}th edge in this content match`);return this.next[n]}toString(){let n=[];function r(s){n.push(s);for(let i=0;i<s.next.length;i++)n.indexOf(s.next[i].next)==-1&&r(s.next[i].next)}return r(this),n.map((s,i)=>{let o=i+(s.validEnd?"*":" ")+" ";for(let l=0;l<s.next.length;l++)o+=(l?", ":"")+s.next[l].type.name+"->"+n.indexOf(s.next[l].next);return o}).join(`
`)}}lu.empty=new lu(!0);class Vpe{constructor(n,r){this.string=n,this.nodeTypes=r,this.inline=null,this.pos=0,this.tokens=n.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(n){return this.next==n&&(this.pos++||!0)}err(n){throw new SyntaxError(n+" (in content expression '"+this.string+"')")}}function jF(t){let n=[];do n.push(Hpe(t));while(t.eat("|"));return n.length==1?n[0]:{type:"choice",exprs:n}}function Hpe(t){let n=[];do n.push(Wpe(t));while(t.next&&t.next!=")"&&t.next!="|");return n.length==1?n[0]:{type:"seq",exprs:n}}function Wpe(t){let n=Kpe(t);for(;;)if(t.eat("+"))n={type:"plus",expr:n};else if(t.eat("*"))n={type:"star",expr:n};else if(t.eat("?"))n={type:"opt",expr:n};else if(t.eat("{"))n=qpe(t,n);else break;return n}function BP(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let n=Number(t.next);return t.pos++,n}function qpe(t,n){let r=BP(t),s=r;return t.eat(",")&&(t.next!="}"?s=BP(t):s=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:r,max:s,expr:n}}function Gpe(t,n){let r=t.nodeTypes,s=r[n];if(s)return[s];let i=[];for(let o in r){let l=r[o];l.isInGroup(n)&&i.push(l)}return i.length==0&&t.err("No node type or group '"+n+"' found"),i}function Kpe(t){if(t.eat("(")){let n=jF(t);return t.eat(")")||t.err("Missing closing paren"),n}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let n=Gpe(t,t.next).map(r=>(t.inline==null?t.inline=r.isInline:t.inline!=r.isInline&&t.err("Mixing inline and block content"),{type:"name",value:r}));return t.pos++,n.length==1?n[0]:{type:"choice",exprs:n}}}function Ype(t){let n=[[]];return i(o(t,0),r()),n;function r(){return n.push([])-1}function s(l,c,d){let u={term:d,to:c};return n[l].push(u),u}function i(l,c){l.forEach(d=>d.to=c)}function o(l,c){if(l.type=="choice")return l.exprs.reduce((d,u)=>d.concat(o(u,c)),[]);if(l.type=="seq")for(let d=0;;d++){let u=o(l.exprs[d],c);if(d==l.exprs.length-1)return u;i(u,c=r())}else if(l.type=="star"){let d=r();return s(c,d),i(o(l.expr,d),d),[s(d)]}else if(l.type=="plus"){let d=r();return i(o(l.expr,c),d),i(o(l.expr,d),d),[s(d)]}else{if(l.type=="opt")return[s(c)].concat(o(l.expr,c));if(l.type=="range"){let d=c;for(let u=0;u<l.min;u++){let h=r();i(o(l.expr,d),h),d=h}if(l.max==-1)i(o(l.expr,d),d);else for(let u=l.min;u<l.max;u++){let h=r();s(d,h),i(o(l.expr,d),h),d=h}return[s(d)]}else{if(l.type=="name")return[s(c,void 0,l.value)];throw new Error("Unknown expr type")}}}}function SF(t,n){return n-t}function FP(t,n){let r=[];return s(n),r.sort(SF);function s(i){let o=t[i];if(o.length==1&&!o[0].term)return s(o[0].to);r.push(i);for(let l=0;l<o.length;l++){let{term:c,to:d}=o[l];!c&&r.indexOf(d)==-1&&s(d)}}}function Xpe(t){let n=Object.create(null);return r(FP(t,0));function r(s){let i=[];s.forEach(l=>{t[l].forEach(({term:c,to:d})=>{if(!c)return;let u;for(let h=0;h<i.length;h++)i[h][0]==c&&(u=i[h][1]);FP(t,d).forEach(h=>{u||i.push([c,u=[]]),u.indexOf(h)==-1&&u.push(h)})})});let o=n[s.join(",")]=new lu(s.indexOf(t.length-1)>-1);for(let l=0;l<i.length;l++){let c=i[l][1].sort(SF);o.next.push({type:i[l][0],next:n[c.join(",")]||r(c)})}return o}}function Qpe(t,n){for(let r=0,s=[t];r<s.length;r++){let i=s[r],o=!i.validEnd,l=[];for(let c=0;c<i.next.length;c++){let{type:d,next:u}=i.next[c];l.push(d.name),o&&!(d.isText||d.hasRequiredAttrs())&&(o=!1),s.indexOf(u)==-1&&s.push(u)}o&&n.err("Only non-generatable nodes ("+l.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function CF(t){let n=Object.create(null);for(let r in t){let s=t[r];if(!s.hasDefault)return null;n[r]=s.default}return n}function _F(t,n){let r=Object.create(null);for(let s in t){let i=n&&n[s];if(i===void 0){let o=t[s];if(o.hasDefault)i=o.default;else throw new RangeError("No value supplied for attribute "+s)}r[s]=i}return r}function AF(t,n,r,s){for(let i in n)if(!(i in t))throw new RangeError(`Unsupported attribute ${i} for ${r} of type ${i}`);for(let i in t){let o=t[i];o.validate&&o.validate(n[i])}}function EF(t,n){let r=Object.create(null);if(n)for(let s in n)r[s]=new Jpe(t,s,n[s]);return r}let $P=class kF{constructor(n,r,s){this.name=n,this.schema=r,this.spec=s,this.markSet=null,this.groups=s.group?s.group.split(" "):[],this.attrs=EF(n,s.attrs),this.defaultAttrs=CF(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(s.inline||n=="text"),this.isText=n=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==lu.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(n){return this.groups.indexOf(n)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let n in this.attrs)if(this.attrs[n].isRequired)return!0;return!1}compatibleContent(n){return this==n||this.contentMatch.compatible(n.contentMatch)}computeAttrs(n){return!n&&this.defaultAttrs?this.defaultAttrs:_F(this.attrs,n)}create(n=null,r,s){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new jc(this,this.computeAttrs(n),Pe.from(r),$n.setFrom(s))}createChecked(n=null,r,s){return r=Pe.from(r),this.checkContent(r),new jc(this,this.computeAttrs(n),r,$n.setFrom(s))}createAndFill(n=null,r,s){if(n=this.computeAttrs(n),r=Pe.from(r),r.size){let l=this.contentMatch.fillBefore(r);if(!l)return null;r=l.append(r)}let i=this.contentMatch.matchFragment(r),o=i&&i.fillBefore(Pe.empty,!0);return o?new jc(this,n,r.append(o),$n.setFrom(s)):null}validContent(n){let r=this.contentMatch.matchFragment(n);if(!r||!r.validEnd)return!1;for(let s=0;s<n.childCount;s++)if(!this.allowsMarks(n.child(s).marks))return!1;return!0}checkContent(n){if(!this.validContent(n))throw new RangeError(`Invalid content for node ${this.name}: ${n.toString().slice(0,50)}`)}checkAttrs(n){AF(this.attrs,n,"node",this.name)}allowsMarkType(n){return this.markSet==null||this.markSet.indexOf(n)>-1}allowsMarks(n){if(this.markSet==null)return!0;for(let r=0;r<n.length;r++)if(!this.allowsMarkType(n[r].type))return!1;return!0}allowedMarks(n){if(this.markSet==null)return n;let r;for(let s=0;s<n.length;s++)this.allowsMarkType(n[s].type)?r&&r.push(n[s]):r||(r=n.slice(0,s));return r?r.length?r:$n.none:n}static compile(n,r){let s=Object.create(null);n.forEach((o,l)=>s[o]=new kF(o,r,l));let i=r.spec.topNode||"doc";if(!s[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!s.text)throw new RangeError("Every schema needs a 'text' type");for(let o in s.text.attrs)throw new RangeError("The text node type should not have attributes");return s}};function Zpe(t,n,r){let s=r.split("|");return i=>{let o=i===null?"null":typeof i;if(s.indexOf(o)<0)throw new RangeError(`Expected value of type ${s} for attribute ${n} on type ${t}, got ${o}`)}}class Jpe{constructor(n,r,s){this.hasDefault=Object.prototype.hasOwnProperty.call(s,"default"),this.default=s.default,this.validate=typeof s.validate=="string"?Zpe(n,r,s.validate):s.validate}get isRequired(){return!this.hasDefault}}class Lv{constructor(n,r,s,i){this.name=n,this.rank=r,this.schema=s,this.spec=i,this.attrs=EF(n,i.attrs),this.excluded=null;let o=CF(this.attrs);this.instance=o?new $n(this,o):null}create(n=null){return!n&&this.instance?this.instance:new $n(this,_F(this.attrs,n))}static compile(n,r){let s=Object.create(null),i=0;return n.forEach((o,l)=>s[o]=new Lv(o,i++,r,l)),s}removeFromSet(n){for(var r=0;r<n.length;r++)n[r].type==this&&(n=n.slice(0,r).concat(n.slice(r+1)),r--);return n}isInSet(n){for(let r=0;r<n.length;r++)if(n[r].type==this)return n[r]}checkAttrs(n){AF(this.attrs,n,"mark",this.name)}excludes(n){return this.excluded.indexOf(n)>-1}}class TF{constructor(n){this.linebreakReplacement=null,this.cached=Object.create(null);let r=this.spec={};for(let i in n)r[i]=n[i];r.nodes=fs.from(n.nodes),r.marks=fs.from(n.marks||{}),this.nodes=$P.compile(this.spec.nodes,this),this.marks=Lv.compile(this.spec.marks,this);let s=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let o=this.nodes[i],l=o.spec.content||"",c=o.spec.marks;if(o.contentMatch=s[l]||(s[l]=lu.parse(l,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=c=="_"?null:c?zP(this,c.split(" ")):c==""||!o.inlineContent?[]:null}for(let i in this.marks){let o=this.marks[i],l=o.spec.excludes;o.excluded=l==null?[o]:l==""?[]:zP(this,l.split(" "))}this.nodeFromJSON=i=>jc.fromJSON(this,i),this.markFromJSON=i=>$n.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(n,r=null,s,i){if(typeof n=="string")n=this.nodeType(n);else if(n instanceof $P){if(n.schema!=this)throw new RangeError("Node type from different schema used ("+n.name+")")}else throw new RangeError("Invalid node type: "+n);return n.createChecked(r,s,i)}text(n,r){let s=this.nodes.text;return new L1(s,s.defaultAttrs,n,$n.setFrom(r))}mark(n,r){return typeof n=="string"&&(n=this.marks[n]),n.create(r)}nodeType(n){let r=this.nodes[n];if(!r)throw new RangeError("Unknown node type: "+n);return r}}function zP(t,n){let r=[];for(let s=0;s<n.length;s++){let i=n[s],o=t.marks[i],l=o;if(o)r.push(o);else for(let c in t.marks){let d=t.marks[c];(i=="_"||d.spec.group&&d.spec.group.split(" ").indexOf(i)>-1)&&r.push(l=d)}if(!l)throw new SyntaxError("Unknown mark type: '"+n[s]+"'")}return r}function exe(t){return t.tag!=null}function txe(t){return t.style!=null}class No{constructor(n,r){this.schema=n,this.rules=r,this.tags=[],this.styles=[];let s=this.matchedStyles=[];r.forEach(i=>{if(exe(i))this.tags.push(i);else if(txe(i)){let o=/[^=]*/.exec(i.style)[0];s.indexOf(o)<0&&s.push(o),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let o=n.nodes[i.node];return o.contentMatch.matchType(o)})}parse(n,r={}){let s=new VP(this,r,!1);return s.addAll(n,$n.none,r.from,r.to),s.finish()}parseSlice(n,r={}){let s=new VP(this,r,!0);return s.addAll(n,$n.none,r.from,r.to),Qe.maxOpen(s.finish())}matchTag(n,r,s){for(let i=s?this.tags.indexOf(s)+1:0;i<this.tags.length;i++){let o=this.tags[i];if(sxe(n,o.tag)&&(o.namespace===void 0||n.namespaceURI==o.namespace)&&(!o.context||r.matchesContext(o.context))){if(o.getAttrs){let l=o.getAttrs(n);if(l===!1)continue;o.attrs=l||void 0}return o}}}matchStyle(n,r,s,i){for(let o=i?this.styles.indexOf(i)+1:0;o<this.styles.length;o++){let l=this.styles[o],c=l.style;if(!(c.indexOf(n)!=0||l.context&&!s.matchesContext(l.context)||c.length>n.length&&(c.charCodeAt(n.length)!=61||c.slice(n.length+1)!=r))){if(l.getAttrs){let d=l.getAttrs(r);if(d===!1)continue;l.attrs=d||void 0}return l}}}static schemaRules(n){let r=[];function s(i){let o=i.priority==null?50:i.priority,l=0;for(;l<r.length;l++){let c=r[l];if((c.priority==null?50:c.priority)<o)break}r.splice(l,0,i)}for(let i in n.marks){let o=n.marks[i].spec.parseDOM;o&&o.forEach(l=>{s(l=HP(l)),l.mark||l.ignore||l.clearMark||(l.mark=i)})}for(let i in n.nodes){let o=n.nodes[i].spec.parseDOM;o&&o.forEach(l=>{s(l=HP(l)),l.node||l.ignore||l.mark||(l.node=i)})}return r}static fromSchema(n){return n.cached.domParser||(n.cached.domParser=new No(n,No.schemaRules(n)))}}const IF={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},nxe={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},PF={ol:!0,ul:!0},Pp=1,_S=2,Xm=4;function UP(t,n,r){return n!=null?(n?Pp:0)|(n==="full"?_S:0):t&&t.whitespace=="pre"?Pp|_S:r&~Xm}class T0{constructor(n,r,s,i,o,l){this.type=n,this.attrs=r,this.marks=s,this.solid=i,this.options=l,this.content=[],this.activeMarks=$n.none,this.match=o||(l&Xm?null:n.contentMatch)}findWrapping(n){if(!this.match){if(!this.type)return[];let r=this.type.contentMatch.fillBefore(Pe.from(n));if(r)this.match=this.type.contentMatch.matchFragment(r);else{let s=this.type.contentMatch,i;return(i=s.findWrapping(n.type))?(this.match=s,i):null}}return this.match.findWrapping(n.type)}finish(n){if(!(this.options&Pp)){let s=this.content[this.content.length-1],i;if(s&&s.isText&&(i=/[ \t\r\n\u000c]+$/.exec(s.text))){let o=s;s.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-i[0].length))}}let r=Pe.from(this.content);return!n&&this.match&&(r=r.append(this.match.fillBefore(Pe.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r}inlineContext(n){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:n.parentNode&&!IF.hasOwnProperty(n.parentNode.nodeName.toLowerCase())}}class VP{constructor(n,r,s){this.parser=n,this.options=r,this.isOpen=s,this.open=0,this.localPreserveWS=!1;let i=r.topNode,o,l=UP(null,r.preserveWhitespace,0)|(s?Xm:0);i?o=new T0(i.type,i.attrs,$n.none,!0,r.topMatch||i.type.contentMatch,l):s?o=new T0(null,null,$n.none,!0,null,l):o=new T0(n.schema.topNodeType,null,$n.none,!0,null,l),this.nodes=[o],this.find=r.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(n,r){n.nodeType==3?this.addTextNode(n,r):n.nodeType==1&&this.addElement(n,r)}addTextNode(n,r){let s=n.nodeValue,i=this.top,o=i.options&_S?"full":this.localPreserveWS||(i.options&Pp)>0,{schema:l}=this.parser;if(o==="full"||i.inlineContext(n)||/[^ \t\r\n\u000c]/.test(s)){if(o)if(o==="full")s=s.replace(/\r\n?/g,`
`);else if(l.linebreakReplacement&&/[\r\n]/.test(s)&&this.top.findWrapping(l.linebreakReplacement.create())){let c=s.split(/\r?\n|\r/);for(let d=0;d<c.length;d++)d&&this.insertNode(l.linebreakReplacement.create(),r,!0),c[d]&&this.insertNode(l.text(c[d]),r,!/\S/.test(c[d]));s=""}else s=s.replace(/\r?\n|\r/g," ");else if(s=s.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(s)&&this.open==this.nodes.length-1){let c=i.content[i.content.length-1],d=n.previousSibling;(!c||d&&d.nodeName=="BR"||c.isText&&/[ \t\r\n\u000c]$/.test(c.text))&&(s=s.slice(1))}s&&this.insertNode(l.text(s),r,!/\S/.test(s)),this.findInText(n)}else this.findInside(n)}addElement(n,r,s){let i=this.localPreserveWS,o=this.top;(n.tagName=="PRE"||/pre/.test(n.style&&n.style.whiteSpace))&&(this.localPreserveWS=!0);let l=n.nodeName.toLowerCase(),c;PF.hasOwnProperty(l)&&this.parser.normalizeLists&&rxe(n);let d=this.options.ruleFromNode&&this.options.ruleFromNode(n)||(c=this.parser.matchTag(n,this,s));e:if(d?d.ignore:nxe.hasOwnProperty(l))this.findInside(n),this.ignoreFallback(n,r);else if(!d||d.skip||d.closeParent){d&&d.closeParent?this.open=Math.max(0,this.open-1):d&&d.skip.nodeType&&(n=d.skip);let u,h=this.needsBlock;if(IF.hasOwnProperty(l))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),u=!0,o.type||(this.needsBlock=!0);else if(!n.firstChild){this.leafFallback(n,r);break e}let m=d&&d.skip?r:this.readStyles(n,r);m&&this.addAll(n,m),u&&this.sync(o),this.needsBlock=h}else{let u=this.readStyles(n,r);u&&this.addElementByRule(n,d,u,d.consuming===!1?c:void 0)}this.localPreserveWS=i}leafFallback(n,r){n.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(n.ownerDocument.createTextNode(`
`),r)}ignoreFallback(n,r){n.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),r,!0)}readStyles(n,r){let s=n.style;if(s&&s.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let o=this.parser.matchedStyles[i],l=s.getPropertyValue(o);if(l)for(let c=void 0;;){let d=this.parser.matchStyle(o,l,this,c);if(!d)break;if(d.ignore)return null;if(d.clearMark?r=r.filter(u=>!d.clearMark(u)):r=r.concat(this.parser.schema.marks[d.mark].create(d.attrs)),d.consuming===!1)c=d;else break}}return r}addElementByRule(n,r,s,i){let o,l;if(r.node)if(l=this.parser.schema.nodes[r.node],l.isLeaf)this.insertNode(l.create(r.attrs),s,n.nodeName=="BR")||this.leafFallback(n,s);else{let d=this.enter(l,r.attrs||null,s,r.preserveWhitespace);d&&(o=!0,s=d)}else{let d=this.parser.schema.marks[r.mark];s=s.concat(d.create(r.attrs))}let c=this.top;if(l&&l.isLeaf)this.findInside(n);else if(i)this.addElement(n,s,i);else if(r.getContent)this.findInside(n),r.getContent(n,this.parser.schema).forEach(d=>this.insertNode(d,s,!1));else{let d=n;typeof r.contentElement=="string"?d=n.querySelector(r.contentElement):typeof r.contentElement=="function"?d=r.contentElement(n):r.contentElement&&(d=r.contentElement),this.findAround(n,d,!0),this.addAll(d,s),this.findAround(n,d,!1)}o&&this.sync(c)&&this.open--}addAll(n,r,s,i){let o=s||0;for(let l=s?n.childNodes[s]:n.firstChild,c=i==null?null:n.childNodes[i];l!=c;l=l.nextSibling,++o)this.findAtPoint(n,o),this.addDOM(l,r);this.findAtPoint(n,o)}findPlace(n,r,s){let i,o;for(let l=this.open,c=0;l>=0;l--){let d=this.nodes[l],u=d.findWrapping(n);if(u&&(!i||i.length>u.length+c)&&(i=u,o=d,!u.length))break;if(d.solid){if(s)break;c+=2}}if(!i)return null;this.sync(o);for(let l=0;l<i.length;l++)r=this.enterInner(i[l],null,r,!1);return r}insertNode(n,r,s){if(n.isInline&&this.needsBlock&&!this.top.type){let o=this.textblockFromContext();o&&(r=this.enterInner(o,null,r))}let i=this.findPlace(n,r,s);if(i){this.closeExtra();let o=this.top;o.match&&(o.match=o.match.matchType(n.type));let l=$n.none;for(let c of i.concat(n.marks))(o.type?o.type.allowsMarkType(c.type):WP(c.type,n.type))&&(l=c.addToSet(l));return o.content.push(n.mark(l)),!0}return!1}enter(n,r,s,i){let o=this.findPlace(n.create(r),s,!1);return o&&(o=this.enterInner(n,r,s,!0,i)),o}enterInner(n,r,s,i=!1,o){this.closeExtra();let l=this.top;l.match=l.match&&l.match.matchType(n);let c=UP(n,o,l.options);l.options&Xm&&l.content.length==0&&(c|=Xm);let d=$n.none;return s=s.filter(u=>(l.type?l.type.allowsMarkType(u.type):WP(u.type,n))?(d=u.addToSet(d),!1):!0),this.nodes.push(new T0(n,r,d,i,null,c)),this.open++,s}closeExtra(n=!1){let r=this.nodes.length-1;if(r>this.open){for(;r>this.open;r--)this.nodes[r-1].content.push(this.nodes[r].finish(n));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(n){for(let r=this.open;r>=0;r--){if(this.nodes[r]==n)return this.open=r,!0;this.localPreserveWS&&(this.nodes[r].options|=Pp)}return!1}get currentPos(){this.closeExtra();let n=0;for(let r=this.open;r>=0;r--){let s=this.nodes[r].content;for(let i=s.length-1;i>=0;i--)n+=s[i].nodeSize;r&&n++}return n}findAtPoint(n,r){if(this.find)for(let s=0;s<this.find.length;s++)this.find[s].node==n&&this.find[s].offset==r&&(this.find[s].pos=this.currentPos)}findInside(n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].pos==null&&n.nodeType==1&&n.contains(this.find[r].node)&&(this.find[r].pos=this.currentPos)}findAround(n,r,s){if(n!=r&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&n.nodeType==1&&n.contains(this.find[i].node)&&r.compareDocumentPosition(this.find[i].node)&(s?2:4)&&(this.find[i].pos=this.currentPos)}findInText(n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==n&&(this.find[r].pos=this.currentPos-(n.nodeValue.length-this.find[r].offset))}matchesContext(n){if(n.indexOf("|")>-1)return n.split(/\s*\|\s*/).some(this.matchesContext,this);let r=n.split("/"),s=this.options.context,i=!this.isOpen&&(!s||s.parent.type==this.nodes[0].type),o=-(s?s.depth+1:0)+(i?0:1),l=(c,d)=>{for(;c>=0;c--){let u=r[c];if(u==""){if(c==r.length-1||c==0)continue;for(;d>=o;d--)if(l(c-1,d))return!0;return!1}else{let h=d>0||d==0&&i?this.nodes[d].type:s&&d>=o?s.node(d-o).type:null;if(!h||h.name!=u&&!h.isInGroup(u))return!1;d--}}return!0};return l(r.length-1,this.open)}textblockFromContext(){let n=this.options.context;if(n)for(let r=n.depth;r>=0;r--){let s=n.node(r).contentMatchAt(n.indexAfter(r)).defaultType;if(s&&s.isTextblock&&s.defaultAttrs)return s}for(let r in this.parser.schema.nodes){let s=this.parser.schema.nodes[r];if(s.isTextblock&&s.defaultAttrs)return s}}}function rxe(t){for(let n=t.firstChild,r=null;n;n=n.nextSibling){let s=n.nodeType==1?n.nodeName.toLowerCase():null;s&&PF.hasOwnProperty(s)&&r?(r.appendChild(n),n=r):s=="li"?r=n:s&&(r=null)}}function sxe(t,n){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,n)}function HP(t){let n={};for(let r in t)n[r]=t[r];return n}function WP(t,n){let r=n.schema.nodes;for(let s in r){let i=r[s];if(!i.allowsMarkType(t))continue;let o=[],l=c=>{o.push(c);for(let d=0;d<c.edgeCount;d++){let{type:u,next:h}=c.edge(d);if(u==n||o.indexOf(h)<0&&l(h))return!0}};if(l(i.contentMatch))return!0}}class Bv{constructor(n,r){this.nodes=n,this.marks=r}serializeFragment(n,r={},s){s||(s=kN(r).createDocumentFragment());let i=s,o=[];return n.forEach(l=>{if(o.length||l.marks.length){let c=0,d=0;for(;c<o.length&&d<l.marks.length;){let u=l.marks[d];if(!this.marks[u.type.name]){d++;continue}if(!u.eq(o[c][0])||u.type.spec.spanning===!1)break;c++,d++}for(;c<o.length;)i=o.pop()[1];for(;d<l.marks.length;){let u=l.marks[d++],h=this.serializeMark(u,l.isInline,r);h&&(o.push([u,i]),i.appendChild(h.dom),i=h.contentDOM||h.dom)}}i.appendChild(this.serializeNodeInner(l,r))}),s}serializeNodeInner(n,r){let{dom:s,contentDOM:i}=kg(kN(r),this.nodes[n.type.name](n),null,n.attrs);if(i){if(n.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(n.content,r,i)}return s}serializeNode(n,r={}){let s=this.serializeNodeInner(n,r);for(let i=n.marks.length-1;i>=0;i--){let o=this.serializeMark(n.marks[i],n.isInline,r);o&&((o.contentDOM||o.dom).appendChild(s),s=o.dom)}return s}serializeMark(n,r,s={}){let i=this.marks[n.type.name];return i&&kg(kN(s),i(n,r),null,n.attrs)}static renderSpec(n,r,s=null,i){return kg(n,r,s,i)}static fromSchema(n){return n.cached.domSerializer||(n.cached.domSerializer=new Bv(this.nodesFromSchema(n),this.marksFromSchema(n)))}static nodesFromSchema(n){let r=qP(n.nodes);return r.text||(r.text=s=>s.text),r}static marksFromSchema(n){return qP(n.marks)}}function qP(t){let n={};for(let r in t){let s=t[r].spec.toDOM;s&&(n[r]=s)}return n}function kN(t){return t.document||window.document}const GP=new WeakMap;function axe(t){let n=GP.get(t);return n===void 0&&GP.set(t,n=ixe(t)),n}function ixe(t){let n=null;function r(s){if(s&&typeof s=="object")if(Array.isArray(s))if(typeof s[0]=="string")n||(n=[]),n.push(s);else for(let i=0;i<s.length;i++)r(s[i]);else for(let i in s)r(s[i])}return r(t),n}function kg(t,n,r,s){if(typeof n=="string")return{dom:t.createTextNode(n)};if(n.nodeType!=null)return{dom:n};if(n.dom&&n.dom.nodeType!=null)return n;let i=n[0],o;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(s&&(o=axe(s))&&o.indexOf(n)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let l=i.indexOf(" ");l>0&&(r=i.slice(0,l),i=i.slice(l+1));let c,d=r?t.createElementNS(r,i):t.createElement(i),u=n[1],h=1;if(u&&typeof u=="object"&&u.nodeType==null&&!Array.isArray(u)){h=2;for(let m in u)if(u[m]!=null){let g=m.indexOf(" ");g>0?d.setAttributeNS(m.slice(0,g),m.slice(g+1),u[m]):m=="style"&&d.style?d.style.cssText=u[m]:d.setAttribute(m,u[m])}}for(let m=h;m<n.length;m++){let g=n[m];if(g===0){if(m<n.length-1||m>h)throw new RangeError("Content hole must be the only child of its parent node");return{dom:d,contentDOM:d}}else{let{dom:y,contentDOM:N}=kg(t,g,r,s);if(d.appendChild(y),N){if(c)throw new RangeError("Multiple content holes");c=N}}}return{dom:d,contentDOM:c}}const MF=65535,OF=Math.pow(2,16);function oxe(t,n){return t+n*OF}function KP(t){return t&MF}function lxe(t){return(t-(t&MF))/OF}const DF=1,RF=2,Tg=4,LF=8;class AS{constructor(n,r,s){this.pos=n,this.delInfo=r,this.recover=s}get deleted(){return(this.delInfo&LF)>0}get deletedBefore(){return(this.delInfo&(DF|Tg))>0}get deletedAfter(){return(this.delInfo&(RF|Tg))>0}get deletedAcross(){return(this.delInfo&Tg)>0}}class _a{constructor(n,r=!1){if(this.ranges=n,this.inverted=r,!n.length&&_a.empty)return _a.empty}recover(n){let r=0,s=KP(n);if(!this.inverted)for(let i=0;i<s;i++)r+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[s*3]+r+lxe(n)}mapResult(n,r=1){return this._map(n,r,!1)}map(n,r=1){return this._map(n,r,!0)}_map(n,r,s){let i=0,o=this.inverted?2:1,l=this.inverted?1:2;for(let c=0;c<this.ranges.length;c+=3){let d=this.ranges[c]-(this.inverted?i:0);if(d>n)break;let u=this.ranges[c+o],h=this.ranges[c+l],m=d+u;if(n<=m){let g=u?n==d?-1:n==m?1:r:r,y=d+i+(g<0?0:h);if(s)return y;let N=n==(r<0?d:m)?null:oxe(c/3,n-d),j=n==d?RF:n==m?DF:Tg;return(r<0?n!=d:n!=m)&&(j|=LF),new AS(y,j,N)}i+=h-u}return s?n+i:new AS(n+i,0,null)}touches(n,r){let s=0,i=KP(r),o=this.inverted?2:1,l=this.inverted?1:2;for(let c=0;c<this.ranges.length;c+=3){let d=this.ranges[c]-(this.inverted?s:0);if(d>n)break;let u=this.ranges[c+o],h=d+u;if(n<=h&&c==i*3)return!0;s+=this.ranges[c+l]-u}return!1}forEach(n){let r=this.inverted?2:1,s=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let l=this.ranges[i],c=l-(this.inverted?o:0),d=l+(this.inverted?0:o),u=this.ranges[i+r],h=this.ranges[i+s];n(c,c+u,d,d+h),o+=h-u}}invert(){return new _a(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(n){return n==0?_a.empty:new _a(n<0?[0,-n,0]:[0,0,n])}}_a.empty=new _a([]);class Mp{constructor(n,r,s=0,i=n?n.length:0){this.mirror=r,this.from=s,this.to=i,this._maps=n||[],this.ownData=!(n||r)}get maps(){return this._maps}slice(n=0,r=this.maps.length){return new Mp(this._maps,this.mirror,n,r)}appendMap(n,r){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(n),r!=null&&this.setMirror(this._maps.length-1,r)}appendMapping(n){for(let r=0,s=this._maps.length;r<n._maps.length;r++){let i=n.getMirror(r);this.appendMap(n._maps[r],i!=null&&i<r?s+i:void 0)}}getMirror(n){if(this.mirror){for(let r=0;r<this.mirror.length;r++)if(this.mirror[r]==n)return this.mirror[r+(r%2?-1:1)]}}setMirror(n,r){this.mirror||(this.mirror=[]),this.mirror.push(n,r)}appendMappingInverted(n){for(let r=n.maps.length-1,s=this._maps.length+n._maps.length;r>=0;r--){let i=n.getMirror(r);this.appendMap(n._maps[r].invert(),i!=null&&i>r?s-i-1:void 0)}}invert(){let n=new Mp;return n.appendMappingInverted(this),n}map(n,r=1){if(this.mirror)return this._map(n,r,!0);for(let s=this.from;s<this.to;s++)n=this._maps[s].map(n,r);return n}mapResult(n,r=1){return this._map(n,r,!1)}_map(n,r,s){let i=0;for(let o=this.from;o<this.to;o++){let l=this._maps[o],c=l.mapResult(n,r);if(c.recover!=null){let d=this.getMirror(o);if(d!=null&&d>o&&d<this.to){o=d,n=this._maps[d].recover(c.recover);continue}}i|=c.delInfo,n=c.pos}return s?n:new AS(n,i,null)}}const TN=Object.create(null);let Bs=class{getMap(){return _a.empty}merge(n){return null}static fromJSON(n,r){if(!r||!r.stepType)throw new RangeError("Invalid input for Step.fromJSON");let s=TN[r.stepType];if(!s)throw new RangeError(`No step type ${r.stepType} defined`);return s.fromJSON(n,r)}static jsonID(n,r){if(n in TN)throw new RangeError("Duplicate use of step JSON ID "+n);return TN[n]=r,r.prototype.jsonID=n,r}};class jr{constructor(n,r){this.doc=n,this.failed=r}static ok(n){return new jr(n,null)}static fail(n){return new jr(null,n)}static fromReplace(n,r,s,i){try{return jr.ok(n.replace(r,s,i))}catch(o){if(o instanceof O1)return jr.fail(o.message);throw o}}}function HA(t,n,r){let s=[];for(let i=0;i<t.childCount;i++){let o=t.child(i);o.content.size&&(o=o.copy(HA(o.content,n,o))),o.isInline&&(o=n(o,r,i)),s.push(o)}return Pe.fromArray(s)}class lc extends Bs{constructor(n,r,s){super(),this.from=n,this.to=r,this.mark=s}apply(n){let r=n.slice(this.from,this.to),s=n.resolve(this.from),i=s.node(s.sharedDepth(this.to)),o=new Qe(HA(r.content,(l,c)=>!l.isAtom||!c.type.allowsMarkType(this.mark.type)?l:l.mark(this.mark.addToSet(l.marks)),i),r.openStart,r.openEnd);return jr.fromReplace(n,this.from,this.to,o)}invert(){return new Di(this.from,this.to,this.mark)}map(n){let r=n.mapResult(this.from,1),s=n.mapResult(this.to,-1);return r.deleted&&s.deleted||r.pos>=s.pos?null:new lc(r.pos,s.pos,this.mark)}merge(n){return n instanceof lc&&n.mark.eq(this.mark)&&this.from<=n.to&&this.to>=n.from?new lc(Math.min(this.from,n.from),Math.max(this.to,n.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(n,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new lc(r.from,r.to,n.markFromJSON(r.mark))}}Bs.jsonID("addMark",lc);class Di extends Bs{constructor(n,r,s){super(),this.from=n,this.to=r,this.mark=s}apply(n){let r=n.slice(this.from,this.to),s=new Qe(HA(r.content,i=>i.mark(this.mark.removeFromSet(i.marks)),n),r.openStart,r.openEnd);return jr.fromReplace(n,this.from,this.to,s)}invert(){return new lc(this.from,this.to,this.mark)}map(n){let r=n.mapResult(this.from,1),s=n.mapResult(this.to,-1);return r.deleted&&s.deleted||r.pos>=s.pos?null:new Di(r.pos,s.pos,this.mark)}merge(n){return n instanceof Di&&n.mark.eq(this.mark)&&this.from<=n.to&&this.to>=n.from?new Di(Math.min(this.from,n.from),Math.max(this.to,n.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(n,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Di(r.from,r.to,n.markFromJSON(r.mark))}}Bs.jsonID("removeMark",Di);class cc extends Bs{constructor(n,r){super(),this.pos=n,this.mark=r}apply(n){let r=n.nodeAt(this.pos);if(!r)return jr.fail("No node at mark step's position");let s=r.type.create(r.attrs,null,this.mark.addToSet(r.marks));return jr.fromReplace(n,this.pos,this.pos+1,new Qe(Pe.from(s),0,r.isLeaf?0:1))}invert(n){let r=n.nodeAt(this.pos);if(r){let s=this.mark.addToSet(r.marks);if(s.length==r.marks.length){for(let i=0;i<r.marks.length;i++)if(!r.marks[i].isInSet(s))return new cc(this.pos,r.marks[i]);return new cc(this.pos,this.mark)}}return new cu(this.pos,this.mark)}map(n){let r=n.mapResult(this.pos,1);return r.deletedAfter?null:new cc(r.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(n,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new cc(r.pos,n.markFromJSON(r.mark))}}Bs.jsonID("addNodeMark",cc);class cu extends Bs{constructor(n,r){super(),this.pos=n,this.mark=r}apply(n){let r=n.nodeAt(this.pos);if(!r)return jr.fail("No node at mark step's position");let s=r.type.create(r.attrs,null,this.mark.removeFromSet(r.marks));return jr.fromReplace(n,this.pos,this.pos+1,new Qe(Pe.from(s),0,r.isLeaf?0:1))}invert(n){let r=n.nodeAt(this.pos);return!r||!this.mark.isInSet(r.marks)?this:new cc(this.pos,this.mark)}map(n){let r=n.mapResult(this.pos,1);return r.deletedAfter?null:new cu(r.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(n,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new cu(r.pos,n.markFromJSON(r.mark))}}Bs.jsonID("removeNodeMark",cu);class Br extends Bs{constructor(n,r,s,i=!1){super(),this.from=n,this.to=r,this.slice=s,this.structure=i}apply(n){return this.structure&&ES(n,this.from,this.to)?jr.fail("Structure replace would overwrite content"):jr.fromReplace(n,this.from,this.to,this.slice)}getMap(){return new _a([this.from,this.to-this.from,this.slice.size])}invert(n){return new Br(this.from,this.from+this.slice.size,n.slice(this.from,this.to))}map(n){let r=n.mapResult(this.from,1),s=n.mapResult(this.to,-1);return r.deletedAcross&&s.deletedAcross?null:new Br(r.pos,Math.max(r.pos,s.pos),this.slice,this.structure)}merge(n){if(!(n instanceof Br)||n.structure||this.structure)return null;if(this.from+this.slice.size==n.from&&!this.slice.openEnd&&!n.slice.openStart){let r=this.slice.size+n.slice.size==0?Qe.empty:new Qe(this.slice.content.append(n.slice.content),this.slice.openStart,n.slice.openEnd);return new Br(this.from,this.to+(n.to-n.from),r,this.structure)}else if(n.to==this.from&&!this.slice.openStart&&!n.slice.openEnd){let r=this.slice.size+n.slice.size==0?Qe.empty:new Qe(n.slice.content.append(this.slice.content),n.slice.openStart,this.slice.openEnd);return new Br(n.from,this.to,r,this.structure)}else return null}toJSON(){let n={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(n.slice=this.slice.toJSON()),this.structure&&(n.structure=!0),n}static fromJSON(n,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Br(r.from,r.to,Qe.fromJSON(n,r.slice),!!r.structure)}}Bs.jsonID("replace",Br);class Ur extends Bs{constructor(n,r,s,i,o,l,c=!1){super(),this.from=n,this.to=r,this.gapFrom=s,this.gapTo=i,this.slice=o,this.insert=l,this.structure=c}apply(n){if(this.structure&&(ES(n,this.from,this.gapFrom)||ES(n,this.gapTo,this.to)))return jr.fail("Structure gap-replace would overwrite content");let r=n.slice(this.gapFrom,this.gapTo);if(r.openStart||r.openEnd)return jr.fail("Gap is not a flat range");let s=this.slice.insertAt(this.insert,r.content);return s?jr.fromReplace(n,this.from,this.to,s):jr.fail("Content does not fit in gap")}getMap(){return new _a([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(n){let r=this.gapTo-this.gapFrom;return new Ur(this.from,this.from+this.slice.size+r,this.from+this.insert,this.from+this.insert+r,n.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(n){let r=n.mapResult(this.from,1),s=n.mapResult(this.to,-1),i=this.from==this.gapFrom?r.pos:n.map(this.gapFrom,-1),o=this.to==this.gapTo?s.pos:n.map(this.gapTo,1);return r.deletedAcross&&s.deletedAcross||i<r.pos||o>s.pos?null:new Ur(r.pos,s.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let n={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(n.slice=this.slice.toJSON()),this.structure&&(n.structure=!0),n}static fromJSON(n,r){if(typeof r.from!="number"||typeof r.to!="number"||typeof r.gapFrom!="number"||typeof r.gapTo!="number"||typeof r.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Ur(r.from,r.to,r.gapFrom,r.gapTo,Qe.fromJSON(n,r.slice),r.insert,!!r.structure)}}Bs.jsonID("replaceAround",Ur);function ES(t,n,r){let s=t.resolve(n),i=r-n,o=s.depth;for(;i>0&&o>0&&s.indexAfter(o)==s.node(o).childCount;)o--,i--;if(i>0){let l=s.node(o).maybeChild(s.indexAfter(o));for(;i>0;){if(!l||l.isLeaf)return!0;l=l.firstChild,i--}}return!1}function cxe(t,n,r,s){let i=[],o=[],l,c;t.doc.nodesBetween(n,r,(d,u,h)=>{if(!d.isInline)return;let m=d.marks;if(!s.isInSet(m)&&h.type.allowsMarkType(s.type)){let g=Math.max(u,n),y=Math.min(u+d.nodeSize,r),N=s.addToSet(m);for(let j=0;j<m.length;j++)m[j].isInSet(N)||(l&&l.to==g&&l.mark.eq(m[j])?l.to=y:i.push(l=new Di(g,y,m[j])));c&&c.to==g?c.to=y:o.push(c=new lc(g,y,s))}}),i.forEach(d=>t.step(d)),o.forEach(d=>t.step(d))}function dxe(t,n,r,s){let i=[],o=0;t.doc.nodesBetween(n,r,(l,c)=>{if(!l.isInline)return;o++;let d=null;if(s instanceof Lv){let u=l.marks,h;for(;h=s.isInSet(u);)(d||(d=[])).push(h),u=h.removeFromSet(u)}else s?s.isInSet(l.marks)&&(d=[s]):d=l.marks;if(d&&d.length){let u=Math.min(c+l.nodeSize,r);for(let h=0;h<d.length;h++){let m=d[h],g;for(let y=0;y<i.length;y++){let N=i[y];N.step==o-1&&m.eq(i[y].style)&&(g=N)}g?(g.to=u,g.step=o):i.push({style:m,from:Math.max(c,n),to:u,step:o})}}}),i.forEach(l=>t.step(new Di(l.from,l.to,l.style)))}function WA(t,n,r,s=r.contentMatch,i=!0){let o=t.doc.nodeAt(n),l=[],c=n+1;for(let d=0;d<o.childCount;d++){let u=o.child(d),h=c+u.nodeSize,m=s.matchType(u.type);if(!m)l.push(new Br(c,h,Qe.empty));else{s=m;for(let g=0;g<u.marks.length;g++)r.allowsMarkType(u.marks[g].type)||t.step(new Di(c,h,u.marks[g]));if(i&&u.isText&&r.whitespace!="pre"){let g,y=/\r?\n|\r/g,N;for(;g=y.exec(u.text);)N||(N=new Qe(Pe.from(r.schema.text(" ",r.allowedMarks(u.marks))),0,0)),l.push(new Br(c+g.index,c+g.index+g[0].length,N))}}c=h}if(!s.validEnd){let d=s.fillBefore(Pe.empty,!0);t.replace(c,c,new Qe(d,0,0))}for(let d=l.length-1;d>=0;d--)t.step(l[d])}function uxe(t,n,r){return(n==0||t.canReplace(n,t.childCount))&&(r==t.childCount||t.canReplace(0,r))}function _u(t){let r=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let s=t.depth;;--s){let i=t.$from.node(s),o=t.$from.index(s),l=t.$to.indexAfter(s);if(s<t.depth&&i.canReplace(o,l,r))return s;if(s==0||i.type.spec.isolating||!uxe(i,o,l))break}return null}function fxe(t,n,r){let{$from:s,$to:i,depth:o}=n,l=s.before(o+1),c=i.after(o+1),d=l,u=c,h=Pe.empty,m=0;for(let N=o,j=!1;N>r;N--)j||s.index(N)>0?(j=!0,h=Pe.from(s.node(N).copy(h)),m++):d--;let g=Pe.empty,y=0;for(let N=o,j=!1;N>r;N--)j||i.after(N+1)<i.end(N)?(j=!0,g=Pe.from(i.node(N).copy(g)),y++):u++;t.step(new Ur(d,u,l,c,new Qe(h.append(g),m,y),h.size-m,!0))}function qA(t,n,r=null,s=t){let i=hxe(t,n),o=i&&mxe(s,n);return o?i.map(YP).concat({type:n,attrs:r}).concat(o.map(YP)):null}function YP(t){return{type:t,attrs:null}}function hxe(t,n){let{parent:r,startIndex:s,endIndex:i}=t,o=r.contentMatchAt(s).findWrapping(n);if(!o)return null;let l=o.length?o[0]:n;return r.canReplaceWith(s,i,l)?o:null}function mxe(t,n){let{parent:r,startIndex:s,endIndex:i}=t,o=r.child(s),l=n.contentMatch.findWrapping(o.type);if(!l)return null;let d=(l.length?l[l.length-1]:n).contentMatch;for(let u=s;d&&u<i;u++)d=d.matchType(r.child(u).type);return!d||!d.validEnd?null:l}function pxe(t,n,r){let s=Pe.empty;for(let l=r.length-1;l>=0;l--){if(s.size){let c=r[l].type.contentMatch.matchFragment(s);if(!c||!c.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}s=Pe.from(r[l].type.create(r[l].attrs,s))}let i=n.start,o=n.end;t.step(new Ur(i,o,i,o,new Qe(s,0,0),r.length,!0))}function xxe(t,n,r,s,i){if(!s.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=t.steps.length;t.doc.nodesBetween(n,r,(l,c)=>{let d=typeof i=="function"?i(l):i;if(l.isTextblock&&!l.hasMarkup(s,d)&&gxe(t.doc,t.mapping.slice(o).map(c),s)){let u=null;if(s.schema.linebreakReplacement){let y=s.whitespace=="pre",N=!!s.contentMatch.matchType(s.schema.linebreakReplacement);y&&!N?u=!1:!y&&N&&(u=!0)}u===!1&&FF(t,l,c,o),WA(t,t.mapping.slice(o).map(c,1),s,void 0,u===null);let h=t.mapping.slice(o),m=h.map(c,1),g=h.map(c+l.nodeSize,1);return t.step(new Ur(m,g,m+1,g-1,new Qe(Pe.from(s.create(d,null,l.marks)),0,0),1,!0)),u===!0&&BF(t,l,c,o),!1}})}function BF(t,n,r,s){n.forEach((i,o)=>{if(i.isText){let l,c=/\r?\n|\r/g;for(;l=c.exec(i.text);){let d=t.mapping.slice(s).map(r+1+o+l.index);t.replaceWith(d,d+1,n.type.schema.linebreakReplacement.create())}}})}function FF(t,n,r,s){n.forEach((i,o)=>{if(i.type==i.type.schema.linebreakReplacement){let l=t.mapping.slice(s).map(r+1+o);t.replaceWith(l,l+1,n.type.schema.text(`
`))}})}function gxe(t,n,r){let s=t.resolve(n),i=s.index();return s.parent.canReplaceWith(i,i+1,r)}function yxe(t,n,r,s,i){let o=t.doc.nodeAt(n);if(!o)throw new RangeError("No node at given position");r||(r=o.type);let l=r.create(s,null,i||o.marks);if(o.isLeaf)return t.replaceWith(n,n+o.nodeSize,l);if(!r.validContent(o.content))throw new RangeError("Invalid content for node type "+r.name);t.step(new Ur(n,n+o.nodeSize,n+1,n+o.nodeSize-1,new Qe(Pe.from(l),0,0),1,!0))}function Oa(t,n,r=1,s){let i=t.resolve(n),o=i.depth-r,l=s&&s[s.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!l.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let u=i.depth-1,h=r-2;u>o;u--,h--){let m=i.node(u),g=i.index(u);if(m.type.spec.isolating)return!1;let y=m.content.cutByIndex(g,m.childCount),N=s&&s[h+1];N&&(y=y.replaceChild(0,N.type.create(N.attrs)));let j=s&&s[h]||m;if(!m.canReplace(g+1,m.childCount)||!j.type.validContent(y))return!1}let c=i.indexAfter(o),d=s&&s[0];return i.node(o).canReplaceWith(c,c,d?d.type:i.node(o+1).type)}function vxe(t,n,r=1,s){let i=t.doc.resolve(n),o=Pe.empty,l=Pe.empty;for(let c=i.depth,d=i.depth-r,u=r-1;c>d;c--,u--){o=Pe.from(i.node(c).copy(o));let h=s&&s[u];l=Pe.from(h?h.type.create(h.attrs,l):i.node(c).copy(l))}t.step(new Br(n,n,new Qe(o.append(l),r,r),!0))}function Lo(t,n){let r=t.resolve(n),s=r.index();return $F(r.nodeBefore,r.nodeAfter)&&r.parent.canReplace(s,s+1)}function bxe(t,n){n.content.size||t.type.compatibleContent(n.type);let r=t.contentMatchAt(t.childCount),{linebreakReplacement:s}=t.type.schema;for(let i=0;i<n.childCount;i++){let o=n.child(i),l=o.type==s?t.type.schema.nodes.text:o.type;if(r=r.matchType(l),!r||!t.type.allowsMarks(o.marks))return!1}return r.validEnd}function $F(t,n){return!!(t&&n&&!t.isLeaf&&bxe(t,n))}function _h(t,n,r=-1){let s=t.resolve(n);for(let i=s.depth;;i--){let o,l,c=s.index(i);if(i==s.depth?(o=s.nodeBefore,l=s.nodeAfter):r>0?(o=s.node(i+1),c++,l=s.node(i).maybeChild(c)):(o=s.node(i).maybeChild(c-1),l=s.node(i+1)),o&&!o.isTextblock&&$F(o,l)&&s.node(i).canReplace(c,c+1))return n;if(i==0)break;n=r<0?s.before(i):s.after(i)}}function wxe(t,n,r){let s=null,{linebreakReplacement:i}=t.doc.type.schema,o=t.doc.resolve(n-r),l=o.node().type;if(i&&l.inlineContent){let h=l.whitespace=="pre",m=!!l.contentMatch.matchType(i);h&&!m?s=!1:!h&&m&&(s=!0)}let c=t.steps.length;if(s===!1){let h=t.doc.resolve(n+r);FF(t,h.node(),h.before(),c)}l.inlineContent&&WA(t,n+r-1,l,o.node().contentMatchAt(o.index()),s==null);let d=t.mapping.slice(c),u=d.map(n-r);if(t.step(new Br(u,d.map(n+r,-1),Qe.empty,!0)),s===!0){let h=t.doc.resolve(u);BF(t,h.node(),h.before(),t.steps.length)}return t}function Nxe(t,n,r){let s=t.resolve(n);if(s.parent.canReplaceWith(s.index(),s.index(),r))return n;if(s.parentOffset==0)for(let i=s.depth-1;i>=0;i--){let o=s.index(i);if(s.node(i).canReplaceWith(o,o,r))return s.before(i+1);if(o>0)return null}if(s.parentOffset==s.parent.content.size)for(let i=s.depth-1;i>=0;i--){let o=s.indexAfter(i);if(s.node(i).canReplaceWith(o,o,r))return s.after(i+1);if(o<s.node(i).childCount)return null}return null}function zF(t,n,r){let s=t.resolve(n);if(!r.content.size)return n;let i=r.content;for(let o=0;o<r.openStart;o++)i=i.firstChild.content;for(let o=1;o<=(r.openStart==0&&r.size?2:1);o++)for(let l=s.depth;l>=0;l--){let c=l==s.depth?0:s.pos<=(s.start(l+1)+s.end(l+1))/2?-1:1,d=s.index(l)+(c>0?1:0),u=s.node(l),h=!1;if(o==1)h=u.canReplace(d,d,i);else{let m=u.contentMatchAt(d).findWrapping(i.firstChild.type);h=m&&u.canReplaceWith(d,d,m[0])}if(h)return c==0?s.pos:c<0?s.before(l+1):s.after(l+1)}return null}function Fv(t,n,r=n,s=Qe.empty){if(n==r&&!s.size)return null;let i=t.resolve(n),o=t.resolve(r);return UF(i,o,s)?new Br(n,r,s):new jxe(i,o,s).fit()}function UF(t,n,r){return!r.openStart&&!r.openEnd&&t.start()==n.start()&&t.parent.canReplace(t.index(),n.index(),r.content)}class jxe{constructor(n,r,s){this.$from=n,this.$to=r,this.unplaced=s,this.frontier=[],this.placed=Pe.empty;for(let i=0;i<=n.depth;i++){let o=n.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(n.indexAfter(i))})}for(let i=n.depth;i>0;i--)this.placed=Pe.from(n.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let n=this.mustMoveInline(),r=this.placed.size-this.depth-this.$from.depth,s=this.$from,i=this.close(n<0?this.$to:s.doc.resolve(n));if(!i)return null;let o=this.placed,l=s.depth,c=i.depth;for(;l&&c&&o.childCount==1;)o=o.firstChild.content,l--,c--;let d=new Qe(o,l,c);return n>-1?new Ur(s.pos,n,this.$to.pos,this.$to.end(),d,r):d.size||s.pos!=this.$to.pos?new Br(s.pos,i.pos,d):null}findFittable(){let n=this.unplaced.openStart;for(let r=this.unplaced.content,s=0,i=this.unplaced.openEnd;s<n;s++){let o=r.firstChild;if(r.childCount>1&&(i=0),o.type.spec.isolating&&i<=s){n=s;break}r=o.content}for(let r=1;r<=2;r++)for(let s=r==1?n:this.unplaced.openStart;s>=0;s--){let i,o=null;s?(o=IN(this.unplaced.content,s-1).firstChild,i=o.content):i=this.unplaced.content;let l=i.firstChild;for(let c=this.depth;c>=0;c--){let{type:d,match:u}=this.frontier[c],h,m=null;if(r==1&&(l?u.matchType(l.type)||(m=u.fillBefore(Pe.from(l),!1)):o&&d.compatibleContent(o.type)))return{sliceDepth:s,frontierDepth:c,parent:o,inject:m};if(r==2&&l&&(h=u.findWrapping(l.type)))return{sliceDepth:s,frontierDepth:c,parent:o,wrap:h};if(o&&u.matchType(o.type))break}}}openMore(){let{content:n,openStart:r,openEnd:s}=this.unplaced,i=IN(n,r);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new Qe(n,r+1,Math.max(s,i.size+r>=n.size-s?r+1:0)),!0)}dropNode(){let{content:n,openStart:r,openEnd:s}=this.unplaced,i=IN(n,r);if(i.childCount<=1&&r>0){let o=n.size-r<=r+i.size;this.unplaced=new Qe(Em(n,r-1,1),r-1,o?r-1:s)}else this.unplaced=new Qe(Em(n,r,1),r,s)}placeNodes({sliceDepth:n,frontierDepth:r,parent:s,inject:i,wrap:o}){for(;this.depth>r;)this.closeFrontierNode();if(o)for(let j=0;j<o.length;j++)this.openFrontierNode(o[j]);let l=this.unplaced,c=s?s.content:l.content,d=l.openStart-n,u=0,h=[],{match:m,type:g}=this.frontier[r];if(i){for(let j=0;j<i.childCount;j++)h.push(i.child(j));m=m.matchFragment(i)}let y=c.size+n-(l.content.size-l.openEnd);for(;u<c.childCount;){let j=c.child(u),S=m.matchType(j.type);if(!S)break;u++,(u>1||d==0||j.content.size)&&(m=S,h.push(VF(j.mark(g.allowedMarks(j.marks)),u==1?d:0,u==c.childCount?y:-1)))}let N=u==c.childCount;N||(y=-1),this.placed=km(this.placed,r,Pe.from(h)),this.frontier[r].match=m,N&&y<0&&s&&s.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let j=0,S=c;j<y;j++){let _=S.lastChild;this.frontier.push({type:_.type,match:_.contentMatchAt(_.childCount)}),S=_.content}this.unplaced=N?n==0?Qe.empty:new Qe(Em(l.content,n-1,1),n-1,y<0?l.openEnd:n-1):new Qe(Em(l.content,n,u),l.openStart,l.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let n=this.frontier[this.depth],r;if(!n.type.isTextblock||!PN(this.$to,this.$to.depth,n.type,n.match,!1)||this.$to.depth==this.depth&&(r=this.findCloseLevel(this.$to))&&r.depth==this.depth)return-1;let{depth:s}=this.$to,i=this.$to.after(s);for(;s>1&&i==this.$to.end(--s);)++i;return i}findCloseLevel(n){e:for(let r=Math.min(this.depth,n.depth);r>=0;r--){let{match:s,type:i}=this.frontier[r],o=r<n.depth&&n.end(r+1)==n.pos+(n.depth-(r+1)),l=PN(n,r,i,s,o);if(l){for(let c=r-1;c>=0;c--){let{match:d,type:u}=this.frontier[c],h=PN(n,c,u,d,!0);if(!h||h.childCount)continue e}return{depth:r,fit:l,move:o?n.doc.resolve(n.after(r+1)):n}}}}close(n){let r=this.findCloseLevel(n);if(!r)return null;for(;this.depth>r.depth;)this.closeFrontierNode();r.fit.childCount&&(this.placed=km(this.placed,r.depth,r.fit)),n=r.move;for(let s=r.depth+1;s<=n.depth;s++){let i=n.node(s),o=i.type.contentMatch.fillBefore(i.content,!0,n.index(s));this.openFrontierNode(i.type,i.attrs,o)}return n}openFrontierNode(n,r=null,s){let i=this.frontier[this.depth];i.match=i.match.matchType(n),this.placed=km(this.placed,this.depth,Pe.from(n.create(r,s))),this.frontier.push({type:n,match:n.contentMatch})}closeFrontierNode(){let r=this.frontier.pop().match.fillBefore(Pe.empty,!0);r.childCount&&(this.placed=km(this.placed,this.frontier.length,r))}}function Em(t,n,r){return n==0?t.cutByIndex(r,t.childCount):t.replaceChild(0,t.firstChild.copy(Em(t.firstChild.content,n-1,r)))}function km(t,n,r){return n==0?t.append(r):t.replaceChild(t.childCount-1,t.lastChild.copy(km(t.lastChild.content,n-1,r)))}function IN(t,n){for(let r=0;r<n;r++)t=t.firstChild.content;return t}function VF(t,n,r){if(n<=0)return t;let s=t.content;return n>1&&(s=s.replaceChild(0,VF(s.firstChild,n-1,s.childCount==1?r-1:0))),n>0&&(s=t.type.contentMatch.fillBefore(s).append(s),r<=0&&(s=s.append(t.type.contentMatch.matchFragment(s).fillBefore(Pe.empty,!0)))),t.copy(s)}function PN(t,n,r,s,i){let o=t.node(n),l=i?t.indexAfter(n):t.index(n);if(l==o.childCount&&!r.compatibleContent(o.type))return null;let c=s.fillBefore(o.content,!0,l);return c&&!Sxe(r,o.content,l)?c:null}function Sxe(t,n,r){for(let s=r;s<n.childCount;s++)if(!t.allowsMarks(n.child(s).marks))return!0;return!1}function Cxe(t){return t.spec.defining||t.spec.definingForContent}function _xe(t,n,r,s){if(!s.size)return t.deleteRange(n,r);let i=t.doc.resolve(n),o=t.doc.resolve(r);if(UF(i,o,s))return t.step(new Br(n,r,s));let l=WF(i,t.doc.resolve(r));l[l.length-1]==0&&l.pop();let c=-(i.depth+1);l.unshift(c);for(let g=i.depth,y=i.pos-1;g>0;g--,y--){let N=i.node(g).type.spec;if(N.defining||N.definingAsContext||N.isolating)break;l.indexOf(g)>-1?c=g:i.before(g)==y&&l.splice(1,0,-g)}let d=l.indexOf(c),u=[],h=s.openStart;for(let g=s.content,y=0;;y++){let N=g.firstChild;if(u.push(N),y==s.openStart)break;g=N.content}for(let g=h-1;g>=0;g--){let y=u[g],N=Cxe(y.type);if(N&&!y.sameMarkup(i.node(Math.abs(c)-1)))h=g;else if(N||!y.type.isTextblock)break}for(let g=s.openStart;g>=0;g--){let y=(g+h+1)%(s.openStart+1),N=u[y];if(N)for(let j=0;j<l.length;j++){let S=l[(j+d)%l.length],_=!0;S<0&&(_=!1,S=-S);let A=i.node(S-1),k=i.index(S-1);if(A.canReplaceWith(k,k,N.type,N.marks))return t.replace(i.before(S),_?o.after(S):r,new Qe(HF(s.content,0,s.openStart,y),y,s.openEnd))}}let m=t.steps.length;for(let g=l.length-1;g>=0&&(t.replace(n,r,s),!(t.steps.length>m));g--){let y=l[g];y<0||(n=i.before(y),r=o.after(y))}}function HF(t,n,r,s,i){if(n<r){let o=t.firstChild;t=t.replaceChild(0,o.copy(HF(o.content,n+1,r,s,o)))}if(n>s){let o=i.contentMatchAt(0),l=o.fillBefore(t).append(t);t=l.append(o.matchFragment(l).fillBefore(Pe.empty,!0))}return t}function Axe(t,n,r,s){if(!s.isInline&&n==r&&t.doc.resolve(n).parent.content.size){let i=Nxe(t.doc,n,s.type);i!=null&&(n=r=i)}t.replaceRange(n,r,new Qe(Pe.from(s),0,0))}function Exe(t,n,r){let s=t.doc.resolve(n),i=t.doc.resolve(r),o=WF(s,i);for(let l=0;l<o.length;l++){let c=o[l],d=l==o.length-1;if(d&&c==0||s.node(c).type.contentMatch.validEnd)return t.delete(s.start(c),i.end(c));if(c>0&&(d||s.node(c-1).canReplace(s.index(c-1),i.indexAfter(c-1))))return t.delete(s.before(c),i.after(c))}for(let l=1;l<=s.depth&&l<=i.depth;l++)if(n-s.start(l)==s.depth-l&&r>s.end(l)&&i.end(l)-r!=i.depth-l&&s.start(l-1)==i.start(l-1)&&s.node(l-1).canReplace(s.index(l-1),i.index(l-1)))return t.delete(s.before(l),r);t.delete(n,r)}function WF(t,n){let r=[],s=Math.min(t.depth,n.depth);for(let i=s;i>=0;i--){let o=t.start(i);if(o<t.pos-(t.depth-i)||n.end(i)>n.pos+(n.depth-i)||t.node(i).type.spec.isolating||n.node(i).type.spec.isolating)break;(o==n.start(i)||i==t.depth&&i==n.depth&&t.parent.inlineContent&&n.parent.inlineContent&&i&&n.start(i-1)==o-1)&&r.push(i)}return r}class If extends Bs{constructor(n,r,s){super(),this.pos=n,this.attr=r,this.value=s}apply(n){let r=n.nodeAt(this.pos);if(!r)return jr.fail("No node at attribute step's position");let s=Object.create(null);for(let o in r.attrs)s[o]=r.attrs[o];s[this.attr]=this.value;let i=r.type.create(s,null,r.marks);return jr.fromReplace(n,this.pos,this.pos+1,new Qe(Pe.from(i),0,r.isLeaf?0:1))}getMap(){return _a.empty}invert(n){return new If(this.pos,this.attr,n.nodeAt(this.pos).attrs[this.attr])}map(n){let r=n.mapResult(this.pos,1);return r.deletedAfter?null:new If(r.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(n,r){if(typeof r.pos!="number"||typeof r.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new If(r.pos,r.attr,r.value)}}Bs.jsonID("attr",If);class Op extends Bs{constructor(n,r){super(),this.attr=n,this.value=r}apply(n){let r=Object.create(null);for(let i in n.attrs)r[i]=n.attrs[i];r[this.attr]=this.value;let s=n.type.create(r,n.content,n.marks);return jr.ok(s)}getMap(){return _a.empty}invert(n){return new Op(this.attr,n.attrs[this.attr])}map(n){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(n,r){if(typeof r.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Op(r.attr,r.value)}}Bs.jsonID("docAttr",Op);let Qf=class extends Error{};Qf=function t(n){let r=Error.call(this,n);return r.__proto__=t.prototype,r};Qf.prototype=Object.create(Error.prototype);Qf.prototype.constructor=Qf;Qf.prototype.name="TransformError";class qF{constructor(n){this.doc=n,this.steps=[],this.docs=[],this.mapping=new Mp}get before(){return this.docs.length?this.docs[0]:this.doc}step(n){let r=this.maybeStep(n);if(r.failed)throw new Qf(r.failed);return this}maybeStep(n){let r=n.apply(this.doc);return r.failed||this.addStep(n,r.doc),r}get docChanged(){return this.steps.length>0}addStep(n,r){this.docs.push(this.doc),this.steps.push(n),this.mapping.appendMap(n.getMap()),this.doc=r}replace(n,r=n,s=Qe.empty){let i=Fv(this.doc,n,r,s);return i&&this.step(i),this}replaceWith(n,r,s){return this.replace(n,r,new Qe(Pe.from(s),0,0))}delete(n,r){return this.replace(n,r,Qe.empty)}insert(n,r){return this.replaceWith(n,n,r)}replaceRange(n,r,s){return _xe(this,n,r,s),this}replaceRangeWith(n,r,s){return Axe(this,n,r,s),this}deleteRange(n,r){return Exe(this,n,r),this}lift(n,r){return fxe(this,n,r),this}join(n,r=1){return wxe(this,n,r),this}wrap(n,r){return pxe(this,n,r),this}setBlockType(n,r=n,s,i=null){return xxe(this,n,r,s,i),this}setNodeMarkup(n,r,s=null,i){return yxe(this,n,r,s,i),this}setNodeAttribute(n,r,s){return this.step(new If(n,r,s)),this}setDocAttribute(n,r){return this.step(new Op(n,r)),this}addNodeMark(n,r){return this.step(new cc(n,r)),this}removeNodeMark(n,r){let s=this.doc.nodeAt(n);if(!s)throw new RangeError("No node at position "+n);if(r instanceof $n)r.isInSet(s.marks)&&this.step(new cu(n,r));else{let i=s.marks,o,l=[];for(;o=r.isInSet(i);)l.push(new cu(n,o)),i=o.removeFromSet(i);for(let c=l.length-1;c>=0;c--)this.step(l[c])}return this}split(n,r=1,s){return vxe(this,n,r,s),this}addMark(n,r,s){return cxe(this,n,r,s),this}removeMark(n,r,s){return dxe(this,n,r,s),this}clearIncompatible(n,r,s){return WA(this,n,r,s),this}}const MN=Object.create(null);class bt{constructor(n,r,s){this.$anchor=n,this.$head=r,this.ranges=s||[new GF(n.min(r),n.max(r))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let n=this.ranges;for(let r=0;r<n.length;r++)if(n[r].$from.pos!=n[r].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(n,r=Qe.empty){let s=r.content.lastChild,i=null;for(let c=0;c<r.openEnd;c++)i=s,s=s.lastChild;let o=n.steps.length,l=this.ranges;for(let c=0;c<l.length;c++){let{$from:d,$to:u}=l[c],h=n.mapping.slice(o);n.replaceRange(h.map(d.pos),h.map(u.pos),c?Qe.empty:r),c==0&&ZP(n,o,(s?s.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(n,r){let s=n.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:l,$to:c}=i[o],d=n.mapping.slice(s),u=d.map(l.pos),h=d.map(c.pos);o?n.deleteRange(u,h):(n.replaceRangeWith(u,h,r),ZP(n,s,r.isInline?-1:1))}}static findFrom(n,r,s=!1){let i=n.parent.inlineContent?new ut(n):Yu(n.node(0),n.parent,n.pos,n.index(),r,s);if(i)return i;for(let o=n.depth-1;o>=0;o--){let l=r<0?Yu(n.node(0),n.node(o),n.before(o+1),n.index(o),r,s):Yu(n.node(0),n.node(o),n.after(o+1),n.index(o)+1,r,s);if(l)return l}return null}static near(n,r=1){return this.findFrom(n,r)||this.findFrom(n,-r)||new pa(n.node(0))}static atStart(n){return Yu(n,n,0,0,1)||new pa(n)}static atEnd(n){return Yu(n,n,n.content.size,n.childCount,-1)||new pa(n)}static fromJSON(n,r){if(!r||!r.type)throw new RangeError("Invalid input for Selection.fromJSON");let s=MN[r.type];if(!s)throw new RangeError(`No selection type ${r.type} defined`);return s.fromJSON(n,r)}static jsonID(n,r){if(n in MN)throw new RangeError("Duplicate use of selection JSON ID "+n);return MN[n]=r,r.prototype.jsonID=n,r}getBookmark(){return ut.between(this.$anchor,this.$head).getBookmark()}}bt.prototype.visible=!0;class GF{constructor(n,r){this.$from=n,this.$to=r}}let XP=!1;function QP(t){!XP&&!t.parent.inlineContent&&(XP=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class ut extends bt{constructor(n,r=n){QP(n),QP(r),super(n,r)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(n,r){let s=n.resolve(r.map(this.head));if(!s.parent.inlineContent)return bt.near(s);let i=n.resolve(r.map(this.anchor));return new ut(i.parent.inlineContent?i:s,s)}replace(n,r=Qe.empty){if(super.replace(n,r),r==Qe.empty){let s=this.$from.marksAcross(this.$to);s&&n.ensureMarks(s)}}eq(n){return n instanceof ut&&n.anchor==this.anchor&&n.head==this.head}getBookmark(){return new $v(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(n,r){if(typeof r.anchor!="number"||typeof r.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new ut(n.resolve(r.anchor),n.resolve(r.head))}static create(n,r,s=r){let i=n.resolve(r);return new this(i,s==r?i:n.resolve(s))}static between(n,r,s){let i=n.pos-r.pos;if((!s||i)&&(s=i>=0?1:-1),!r.parent.inlineContent){let o=bt.findFrom(r,s,!0)||bt.findFrom(r,-s,!0);if(o)r=o.$head;else return bt.near(r,s)}return n.parent.inlineContent||(i==0?n=r:(n=(bt.findFrom(n,-s,!0)||bt.findFrom(n,s,!0)).$anchor,n.pos<r.pos!=i<0&&(n=r))),new ut(n,r)}}bt.jsonID("text",ut);class $v{constructor(n,r){this.anchor=n,this.head=r}map(n){return new $v(n.map(this.anchor),n.map(this.head))}resolve(n){return ut.between(n.resolve(this.anchor),n.resolve(this.head))}}class xt extends bt{constructor(n){let r=n.nodeAfter,s=n.node(0).resolve(n.pos+r.nodeSize);super(n,s),this.node=r}map(n,r){let{deleted:s,pos:i}=r.mapResult(this.anchor),o=n.resolve(i);return s?bt.near(o):new xt(o)}content(){return new Qe(Pe.from(this.node),0,0)}eq(n){return n instanceof xt&&n.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new GA(this.anchor)}static fromJSON(n,r){if(typeof r.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new xt(n.resolve(r.anchor))}static create(n,r){return new xt(n.resolve(r))}static isSelectable(n){return!n.isText&&n.type.spec.selectable!==!1}}xt.prototype.visible=!1;bt.jsonID("node",xt);class GA{constructor(n){this.anchor=n}map(n){let{deleted:r,pos:s}=n.mapResult(this.anchor);return r?new $v(s,s):new GA(s)}resolve(n){let r=n.resolve(this.anchor),s=r.nodeAfter;return s&&xt.isSelectable(s)?new xt(r):bt.near(r)}}class pa extends bt{constructor(n){super(n.resolve(0),n.resolve(n.content.size))}replace(n,r=Qe.empty){if(r==Qe.empty){n.delete(0,n.doc.content.size);let s=bt.atStart(n.doc);s.eq(n.selection)||n.setSelection(s)}else super.replace(n,r)}toJSON(){return{type:"all"}}static fromJSON(n){return new pa(n)}map(n){return new pa(n)}eq(n){return n instanceof pa}getBookmark(){return kxe}}bt.jsonID("all",pa);const kxe={map(){return this},resolve(t){return new pa(t)}};function Yu(t,n,r,s,i,o=!1){if(n.inlineContent)return ut.create(t,r);for(let l=s-(i>0?0:1);i>0?l<n.childCount:l>=0;l+=i){let c=n.child(l);if(c.isAtom){if(!o&&xt.isSelectable(c))return xt.create(t,r-(i<0?c.nodeSize:0))}else{let d=Yu(t,c,r+i,i<0?c.childCount:0,i,o);if(d)return d}r+=c.nodeSize*i}return null}function ZP(t,n,r){let s=t.steps.length-1;if(s<n)return;let i=t.steps[s];if(!(i instanceof Br||i instanceof Ur))return;let o=t.mapping.maps[s],l;o.forEach((c,d,u,h)=>{l==null&&(l=h)}),t.setSelection(bt.near(t.doc.resolve(l),r))}function JP(t,n){return!n||!t?t:t.bind(n)}class I0{constructor(n,r,s){this.name=n,this.init=JP(r.init,s),this.apply=JP(r.apply,s)}}new I0("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new I0("selection",{init(t,n){return t.selection||bt.atStart(n.doc)},apply(t){return t.selection}}),new I0("storedMarks",{init(t){return t.storedMarks||null},apply(t,n,r,s){return s.selection.$cursor?t.storedMarks:null}}),new I0("scrollToSelection",{init(){return 0},apply(t,n){return t.scrolledIntoView?n+1:n}});function KF(t,n,r){for(let s in t){let i=t[s];i instanceof Function?i=i.bind(n):s=="handleDOMEvents"&&(i=KF(i,n,{})),r[s]=i}return r}class Ar{constructor(n){this.spec=n,this.props={},n.props&&KF(n.props,this,this.props),this.key=n.key?n.key.key:YF("plugin")}getState(n){return n[this.key]}}const ON=Object.create(null);function YF(t){return t in ON?t+"$"+ ++ON[t]:(ON[t]=0,t+"$")}class Er{constructor(n="key"){this.key=YF(n)}get(n){return n.config.pluginsByKey[this.key]}getState(n){return n[this.key]}}const zv=(t,n)=>t.selection.empty?!1:(n&&n(t.tr.deleteSelection().scrollIntoView()),!0);function XF(t,n){let{$cursor:r}=t.selection;return!r||(n?!n.endOfTextblock("backward",t):r.parentOffset>0)?null:r}const KA=(t,n,r)=>{let s=XF(t,r);if(!s)return!1;let i=XA(s);if(!i){let l=s.blockRange(),c=l&&_u(l);return c==null?!1:(n&&n(t.tr.lift(l,c).scrollIntoView()),!0)}let o=i.nodeBefore;if(i$(t,i,n,-1))return!0;if(s.parent.content.size==0&&(Zf(o,"end")||xt.isSelectable(o)))for(let l=s.depth;;l--){let c=Fv(t.doc,s.before(l),s.after(l),Qe.empty);if(c&&c.slice.size<c.to-c.from){if(n){let d=t.tr.step(c);d.setSelection(Zf(o,"end")?bt.findFrom(d.doc.resolve(d.mapping.map(i.pos,-1)),-1):xt.create(d.doc,i.pos-o.nodeSize)),n(d.scrollIntoView())}return!0}if(l==1||s.node(l-1).childCount>1)break}return o.isAtom&&i.depth==s.depth-1?(n&&n(t.tr.delete(i.pos-o.nodeSize,i.pos).scrollIntoView()),!0):!1},QF=(t,n,r)=>{let s=XF(t,r);if(!s)return!1;let i=XA(s);return i?JF(t,i,n):!1},ZF=(t,n,r)=>{let s=e$(t,r);if(!s)return!1;let i=JA(s);return i?JF(t,i,n):!1};function JF(t,n,r){let s=n.nodeBefore,i=s,o=n.pos-1;for(;!i.isTextblock;o--){if(i.type.spec.isolating)return!1;let h=i.lastChild;if(!h)return!1;i=h}let l=n.nodeAfter,c=l,d=n.pos+1;for(;!c.isTextblock;d++){if(c.type.spec.isolating)return!1;let h=c.firstChild;if(!h)return!1;c=h}let u=Fv(t.doc,o,d,Qe.empty);if(!u||u.from!=o||u instanceof Br&&u.slice.size>=d-o)return!1;if(r){let h=t.tr.step(u);h.setSelection(ut.create(h.doc,o)),r(h.scrollIntoView())}return!0}function Zf(t,n,r=!1){for(let s=t;s;s=n=="start"?s.firstChild:s.lastChild){if(s.isTextblock)return!0;if(r&&s.childCount!=1)return!1}return!1}const YA=(t,n,r)=>{let{$head:s,empty:i}=t.selection,o=s;if(!i)return!1;if(s.parent.isTextblock){if(r?!r.endOfTextblock("backward",t):s.parentOffset>0)return!1;o=XA(s)}let l=o&&o.nodeBefore;return!l||!xt.isSelectable(l)?!1:(n&&n(t.tr.setSelection(xt.create(t.doc,o.pos-l.nodeSize)).scrollIntoView()),!0)};function XA(t){if(!t.parent.type.spec.isolating)for(let n=t.depth-1;n>=0;n--){if(t.index(n)>0)return t.doc.resolve(t.before(n+1));if(t.node(n).type.spec.isolating)break}return null}function e$(t,n){let{$cursor:r}=t.selection;return!r||(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)?null:r}const QA=(t,n,r)=>{let s=e$(t,r);if(!s)return!1;let i=JA(s);if(!i)return!1;let o=i.nodeAfter;if(i$(t,i,n,1))return!0;if(s.parent.content.size==0&&(Zf(o,"start")||xt.isSelectable(o))){let l=Fv(t.doc,s.before(),s.after(),Qe.empty);if(l&&l.slice.size<l.to-l.from){if(n){let c=t.tr.step(l);c.setSelection(Zf(o,"start")?bt.findFrom(c.doc.resolve(c.mapping.map(i.pos)),1):xt.create(c.doc,c.mapping.map(i.pos))),n(c.scrollIntoView())}return!0}}return o.isAtom&&i.depth==s.depth-1?(n&&n(t.tr.delete(i.pos,i.pos+o.nodeSize).scrollIntoView()),!0):!1},ZA=(t,n,r)=>{let{$head:s,empty:i}=t.selection,o=s;if(!i)return!1;if(s.parent.isTextblock){if(r?!r.endOfTextblock("forward",t):s.parentOffset<s.parent.content.size)return!1;o=JA(s)}let l=o&&o.nodeAfter;return!l||!xt.isSelectable(l)?!1:(n&&n(t.tr.setSelection(xt.create(t.doc,o.pos)).scrollIntoView()),!0)};function JA(t){if(!t.parent.type.spec.isolating)for(let n=t.depth-1;n>=0;n--){let r=t.node(n);if(t.index(n)+1<r.childCount)return t.doc.resolve(t.after(n+1));if(r.type.spec.isolating)break}return null}const t$=(t,n)=>{let r=t.selection,s=r instanceof xt,i;if(s){if(r.node.isTextblock||!Lo(t.doc,r.from))return!1;i=r.from}else if(i=_h(t.doc,r.from,-1),i==null)return!1;if(n){let o=t.tr.join(i);s&&o.setSelection(xt.create(o.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),n(o.scrollIntoView())}return!0},n$=(t,n)=>{let r=t.selection,s;if(r instanceof xt){if(r.node.isTextblock||!Lo(t.doc,r.to))return!1;s=r.to}else if(s=_h(t.doc,r.to,1),s==null)return!1;return n&&n(t.tr.join(s).scrollIntoView()),!0},r$=(t,n)=>{let{$from:r,$to:s}=t.selection,i=r.blockRange(s),o=i&&_u(i);return o==null?!1:(n&&n(t.tr.lift(i,o).scrollIntoView()),!0)},eE=(t,n)=>{let{$head:r,$anchor:s}=t.selection;return!r.parent.type.spec.code||!r.sameParent(s)?!1:(n&&n(t.tr.insertText(`
`).scrollIntoView()),!0)};function tE(t){for(let n=0;n<t.edgeCount;n++){let{type:r}=t.edge(n);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}const s$=(t,n)=>{let{$head:r,$anchor:s}=t.selection;if(!r.parent.type.spec.code||!r.sameParent(s))return!1;let i=r.node(-1),o=r.indexAfter(-1),l=tE(i.contentMatchAt(o));if(!l||!i.canReplaceWith(o,o,l))return!1;if(n){let c=r.after(),d=t.tr.replaceWith(c,c,l.createAndFill());d.setSelection(bt.near(d.doc.resolve(c),1)),n(d.scrollIntoView())}return!0},nE=(t,n)=>{let r=t.selection,{$from:s,$to:i}=r;if(r instanceof pa||s.parent.inlineContent||i.parent.inlineContent)return!1;let o=tE(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(n){let l=(!s.parentOffset&&i.index()<i.parent.childCount?s:i).pos,c=t.tr.insert(l,o.createAndFill());c.setSelection(ut.create(c.doc,l+1)),n(c.scrollIntoView())}return!0},rE=(t,n)=>{let{$cursor:r}=t.selection;if(!r||r.parent.content.size)return!1;if(r.depth>1&&r.after()!=r.end(-1)){let o=r.before();if(Oa(t.doc,o))return n&&n(t.tr.split(o).scrollIntoView()),!0}let s=r.blockRange(),i=s&&_u(s);return i==null?!1:(n&&n(t.tr.lift(s,i).scrollIntoView()),!0)};function Txe(t){return(n,r)=>{let{$from:s,$to:i}=n.selection;if(n.selection instanceof xt&&n.selection.node.isBlock)return!s.parentOffset||!Oa(n.doc,s.pos)?!1:(r&&r(n.tr.split(s.pos).scrollIntoView()),!0);if(!s.depth)return!1;let o=[],l,c,d=!1,u=!1;for(let y=s.depth;;y--)if(s.node(y).isBlock){d=s.end(y)==s.pos+(s.depth-y),u=s.start(y)==s.pos-(s.depth-y),c=tE(s.node(y-1).contentMatchAt(s.indexAfter(y-1))),o.unshift(d&&c?{type:c}:null),l=y;break}else{if(y==1)return!1;o.unshift(null)}let h=n.tr;(n.selection instanceof ut||n.selection instanceof pa)&&h.deleteSelection();let m=h.mapping.map(s.pos),g=Oa(h.doc,m,o.length,o);if(g||(o[0]=c?{type:c}:null,g=Oa(h.doc,m,o.length,o)),!g)return!1;if(h.split(m,o.length,o),!d&&u&&s.node(l).type!=c){let y=h.mapping.map(s.before(l)),N=h.doc.resolve(y);c&&s.node(l-1).canReplaceWith(N.index(),N.index()+1,c)&&h.setNodeMarkup(h.mapping.map(s.before(l)),c)}return r&&r(h.scrollIntoView()),!0}}const Ixe=Txe(),a$=(t,n)=>{let{$from:r,to:s}=t.selection,i,o=r.sharedDepth(s);return o==0?!1:(i=r.before(o),n&&n(t.tr.setSelection(xt.create(t.doc,i))),!0)};function Pxe(t,n,r){let s=n.nodeBefore,i=n.nodeAfter,o=n.index();return!s||!i||!s.type.compatibleContent(i.type)?!1:!s.content.size&&n.parent.canReplace(o-1,o)?(r&&r(t.tr.delete(n.pos-s.nodeSize,n.pos).scrollIntoView()),!0):!n.parent.canReplace(o,o+1)||!(i.isTextblock||Lo(t.doc,n.pos))?!1:(r&&r(t.tr.join(n.pos).scrollIntoView()),!0)}function i$(t,n,r,s){let i=n.nodeBefore,o=n.nodeAfter,l,c,d=i.type.spec.isolating||o.type.spec.isolating;if(!d&&Pxe(t,n,r))return!0;let u=!d&&n.parent.canReplace(n.index(),n.index()+1);if(u&&(l=(c=i.contentMatchAt(i.childCount)).findWrapping(o.type))&&c.matchType(l[0]||o.type).validEnd){if(r){let y=n.pos+o.nodeSize,N=Pe.empty;for(let _=l.length-1;_>=0;_--)N=Pe.from(l[_].create(null,N));N=Pe.from(i.copy(N));let j=t.tr.step(new Ur(n.pos-1,y,n.pos,y,new Qe(N,1,0),l.length,!0)),S=j.doc.resolve(y+2*l.length);S.nodeAfter&&S.nodeAfter.type==i.type&&Lo(j.doc,S.pos)&&j.join(S.pos),r(j.scrollIntoView())}return!0}let h=o.type.spec.isolating||s>0&&d?null:bt.findFrom(n,1),m=h&&h.$from.blockRange(h.$to),g=m&&_u(m);if(g!=null&&g>=n.depth)return r&&r(t.tr.lift(m,g).scrollIntoView()),!0;if(u&&Zf(o,"start",!0)&&Zf(i,"end")){let y=i,N=[];for(;N.push(y),!y.isTextblock;)y=y.lastChild;let j=o,S=1;for(;!j.isTextblock;j=j.firstChild)S++;if(y.canReplace(y.childCount,y.childCount,j.content)){if(r){let _=Pe.empty;for(let k=N.length-1;k>=0;k--)_=Pe.from(N[k].copy(_));let A=t.tr.step(new Ur(n.pos-N.length,n.pos+o.nodeSize,n.pos+S,n.pos+o.nodeSize-S,new Qe(_,N.length,0),0,!0));r(A.scrollIntoView())}return!0}}return!1}function o$(t){return function(n,r){let s=n.selection,i=t<0?s.$from:s.$to,o=i.depth;for(;i.node(o).isInline;){if(!o)return!1;o--}return i.node(o).isTextblock?(r&&r(n.tr.setSelection(ut.create(n.doc,t<0?i.start(o):i.end(o)))),!0):!1}}const l$=o$(-1),c$=o$(1);function d$(t,n=null){return function(r,s){let{$from:i,$to:o}=r.selection,l=i.blockRange(o),c=l&&qA(l,t,n);return c?(s&&s(r.tr.wrap(l,c).scrollIntoView()),!0):!1}}function B1(t,n=null){return function(r,s){let i=!1;for(let o=0;o<r.selection.ranges.length&&!i;o++){let{$from:{pos:l},$to:{pos:c}}=r.selection.ranges[o];r.doc.nodesBetween(l,c,(d,u)=>{if(i)return!1;if(!(!d.isTextblock||d.hasMarkup(t,n)))if(d.type==t)i=!0;else{let h=r.doc.resolve(u),m=h.index();i=h.parent.canReplaceWith(m,m+1,t)}})}if(!i)return!1;if(s){let o=r.tr;for(let l=0;l<r.selection.ranges.length;l++){let{$from:{pos:c},$to:{pos:d}}=r.selection.ranges[l];o.setBlockType(c,d,t,n)}s(o.scrollIntoView())}return!0}}function sE(...t){return function(n,r,s){for(let i=0;i<t.length;i++)if(t[i](n,r,s))return!0;return!1}}sE(zv,KA,YA);sE(zv,QA,ZA);sE(eE,nE,rE,Ixe);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function u$(t,n=null){return function(r,s){let{$from:i,$to:o}=r.selection,l=i.blockRange(o);if(!l)return!1;let c=s?r.tr:null;return Mxe(c,l,t,n)?(s&&s(c.scrollIntoView()),!0):!1}}function Mxe(t,n,r,s=null){let i=!1,o=n,l=n.$from.doc;if(n.depth>=2&&n.$from.node(n.depth-1).type.compatibleContent(r)&&n.startIndex==0){if(n.$from.index(n.depth-1)==0)return!1;let d=l.resolve(n.start-2);o=new R1(d,d,n.depth),n.endIndex<n.parent.childCount&&(n=new R1(n.$from,l.resolve(n.$to.end(n.depth)),n.depth)),i=!0}let c=qA(o,r,s,n);return c?(t&&Oxe(t,n,c,i,r),!0):!1}function Oxe(t,n,r,s,i){let o=Pe.empty;for(let h=r.length-1;h>=0;h--)o=Pe.from(r[h].type.create(r[h].attrs,o));t.step(new Ur(n.start-(s?2:0),n.end,n.start,n.end,new Qe(o,0,0),r.length,!0));let l=0;for(let h=0;h<r.length;h++)r[h].type==i&&(l=h+1);let c=r.length-l,d=n.start+r.length-(s?2:0),u=n.parent;for(let h=n.startIndex,m=n.endIndex,g=!0;h<m;h++,g=!1)!g&&Oa(t.doc,d,c)&&(t.split(d,c),d+=2*c),d+=u.child(h).nodeSize;return t}function f$(t){return function(n,r){let{$from:s,$to:i}=n.selection,o=s.blockRange(i,l=>l.childCount>0&&l.firstChild.type==t);return o?r?s.node(o.depth-1).type==t?Dxe(n,r,t,o):Rxe(n,r,o):!0:!1}}function Dxe(t,n,r,s){let i=t.tr,o=s.end,l=s.$to.end(s.depth);o<l&&(i.step(new Ur(o-1,l,o,l,new Qe(Pe.from(r.create(null,s.parent.copy())),1,0),1,!0)),s=new R1(i.doc.resolve(s.$from.pos),i.doc.resolve(l),s.depth));const c=_u(s);if(c==null)return!1;i.lift(s,c);let d=i.doc.resolve(i.mapping.map(o,-1)-1);return Lo(i.doc,d.pos)&&d.nodeBefore.type==d.nodeAfter.type&&i.join(d.pos),n(i.scrollIntoView()),!0}function Rxe(t,n,r){let s=t.tr,i=r.parent;for(let y=r.end,N=r.endIndex-1,j=r.startIndex;N>j;N--)y-=i.child(N).nodeSize,s.delete(y-1,y+1);let o=s.doc.resolve(r.start),l=o.nodeAfter;if(s.mapping.map(r.end)!=r.start+o.nodeAfter.nodeSize)return!1;let c=r.startIndex==0,d=r.endIndex==i.childCount,u=o.node(-1),h=o.index(-1);if(!u.canReplace(h+(c?0:1),h+1,l.content.append(d?Pe.empty:Pe.from(i))))return!1;let m=o.pos,g=m+l.nodeSize;return s.step(new Ur(m-(c?1:0),g+(d?1:0),m+1,g-1,new Qe((c?Pe.empty:Pe.from(i.copy(Pe.empty))).append(d?Pe.empty:Pe.from(i.copy(Pe.empty))),c?0:1,d?0:1),c?0:1)),n(s.scrollIntoView()),!0}function h$(t){return function(n,r){let{$from:s,$to:i}=n.selection,o=s.blockRange(i,u=>u.childCount>0&&u.firstChild.type==t);if(!o)return!1;let l=o.startIndex;if(l==0)return!1;let c=o.parent,d=c.child(l-1);if(d.type!=t)return!1;if(r){let u=d.lastChild&&d.lastChild.type==c.type,h=Pe.from(u?t.create():null),m=new Qe(Pe.from(t.create(null,Pe.from(c.type.create(null,h)))),u?3:1,0),g=o.start,y=o.end;r(n.tr.step(new Ur(g-(u?3:1),y,g,y,m,1,!0)).scrollIntoView())}return!0}}const Au=function(t){for(var n=0;;n++)if(t=t.previousSibling,!t)return n},m$=function(t,n,r,s){return r&&(eM(t,n,r,s,-1)||eM(t,n,r,s,1))},Lxe=/^(img|br|input|textarea|hr)$/i;function eM(t,n,r,s,i){for(var o;;){if(t==r&&n==s)return!0;if(n==(i<0?0:F1(t))){let l=t.parentNode;if(!l||l.nodeType!=1||aE(t)||Lxe.test(t.nodeName)||t.contentEditable=="false")return!1;n=Au(t)+(i<0?0:1),t=l}else if(t.nodeType==1){let l=t.childNodes[n+(i<0?-1:0)];if(l.nodeType==1&&l.contentEditable=="false")if(!((o=l.pmViewDesc)===null||o===void 0)&&o.ignoreForSelection)n+=i;else return!1;else t=l,n=i<0?F1(t):0}else return!1}}function F1(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Bxe(t,n,r){for(let s=n==0,i=n==F1(t);s||i;){if(t==r)return!0;let o=Au(t);if(t=t.parentNode,!t)return!1;s=s&&o==0,i=i&&o==F1(t)}}function aE(t){let n;for(let r=t;r&&!(n=r.pmViewDesc);r=r.parentNode);return n&&n.node&&n.node.isBlock&&(n.dom==t||n.contentDOM==t)}const p$=function(t){return t.focusNode&&m$(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function x$(t,n){let r=document.createEvent("Event");return r.initEvent("keydown",!0,!0),r.keyCode=t,r.key=r.code=n,r}const To=typeof navigator<"u"?navigator:null,tM=typeof document<"u"?document:null,Yc=To&&To.userAgent||"",kS=/Edge\/(\d+)/.exec(Yc),g$=/MSIE \d/.exec(Yc),TS=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Yc),vx=!!(g$||TS||kS),y$=g$?document.documentMode:TS?+TS[1]:kS?+kS[1]:0,Uv=!vx&&/gecko\/(\d+)/i.test(Yc);Uv&&+(/Firefox\/(\d+)/.exec(Yc)||[0,0])[1];const IS=!vx&&/Chrome\/(\d+)/.exec(Yc),Xc=!!IS,v$=IS?+IS[1]:0,Eu=!vx&&!!To&&/Apple Computer/.test(To.vendor),iE=Eu&&(/Mobile\/\w+/.test(Yc)||!!To&&To.maxTouchPoints>2),ni=iE||(To?/Mac/.test(To.platform):!1),Fxe=To?/Win/.test(To.platform):!1,bx=/Android \d/.test(Yc),oE=!!tM&&"webkitFontSmoothing"in tM.documentElement.style,$xe=oE?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function zxe(t,n=null){let r=t.domSelectionRange(),s=t.state.doc;if(!r.focusNode)return null;let i=t.docView.nearestDesc(r.focusNode),o=i&&i.size==0,l=t.docView.posFromDOM(r.focusNode,r.focusOffset,1);if(l<0)return null;let c=s.resolve(l),d,u;if(p$(r)){for(d=l;i&&!i.node;)i=i.parent;let m=i.node;if(i&&m.isAtom&&xt.isSelectable(m)&&i.parent&&!(m.isInline&&Bxe(r.focusNode,r.focusOffset,i.dom))){let g=i.posBefore;u=new xt(l==g?c:s.resolve(g))}}else{if(r instanceof t.dom.ownerDocument.defaultView.Selection&&r.rangeCount>1){let m=l,g=l;for(let y=0;y<r.rangeCount;y++){let N=r.getRangeAt(y);m=Math.min(m,t.docView.posFromDOM(N.startContainer,N.startOffset,1)),g=Math.max(g,t.docView.posFromDOM(N.endContainer,N.endOffset,-1))}if(m<0)return null;[d,l]=g==t.state.selection.anchor?[g,m]:[m,g],c=s.resolve(l)}else d=t.docView.posFromDOM(r.anchorNode,r.anchorOffset,1);if(d<0)return null}let h=s.resolve(d);if(!u){let m=n=="pointer"||t.state.selection.head<c.pos&&!o?1:-1;u=w$(t,h,c,m)}return u}function b$(t){return t.editable?t.hasFocus():Wxe(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function lE(t,n=!1){let r=t.state.selection;if(Hxe(t,r),!!b$(t)){if(!n&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&Xc){let s=t.domSelectionRange(),i=t.domObserver.currentSelection;if(s.anchorNode&&i.anchorNode&&m$(s.anchorNode,s.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)Vxe(t);else{let{anchor:s,head:i}=r,o,l;nM&&!(r instanceof ut)&&(r.$from.parent.inlineContent||(o=rM(t,r.from)),!r.empty&&!r.$from.parent.inlineContent&&(l=rM(t,r.to))),t.docView.setSelection(s,i,t,n),nM&&(o&&sM(o),l&&sM(l)),r.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&Uxe(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const nM=Eu||Xc&&v$<63;function rM(t,n){let{node:r,offset:s}=t.docView.domFromPos(n,0),i=s<r.childNodes.length?r.childNodes[s]:null,o=s?r.childNodes[s-1]:null;if(Eu&&i&&i.contentEditable=="false")return DN(i);if((!i||i.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(i)return DN(i);if(o)return DN(o)}}function DN(t){return t.contentEditable="true",Eu&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function sM(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function Uxe(t){let n=t.dom.ownerDocument;n.removeEventListener("selectionchange",t.input.hideSelectionGuard);let r=t.domSelectionRange(),s=r.anchorNode,i=r.anchorOffset;n.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(r.anchorNode!=s||r.anchorOffset!=i)&&(n.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!b$(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function Vxe(t){let n=t.domSelection();if(!n)return;let r=t.cursorWrapper.dom,s=r.nodeName=="IMG";s?n.collapse(r.parentNode,Au(r)+1):n.collapse(r,0),!s&&!t.state.selection.visible&&vx&&y$<=11&&(r.disabled=!0,r.disabled=!1)}function Hxe(t,n){if(n instanceof xt){let r=t.docView.descAt(n.from);r!=t.lastSelectedViewDesc&&(aM(t),r&&r.selectNode(),t.lastSelectedViewDesc=r)}else aM(t)}function aM(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function w$(t,n,r,s){return t.someProp("createSelectionBetween",i=>i(t,n,r))||ut.between(n,r,s)}function Wxe(t){let n=t.domSelectionRange();if(!n.anchorNode)return!1;try{return t.dom.contains(n.anchorNode.nodeType==3?n.anchorNode.parentNode:n.anchorNode)&&(t.editable||t.dom.contains(n.focusNode.nodeType==3?n.focusNode.parentNode:n.focusNode))}catch{return!1}}function PS(t,n){let{$anchor:r,$head:s}=t.selection,i=n>0?r.max(s):r.min(s),o=i.parent.inlineContent?i.depth?t.doc.resolve(n>0?i.after():i.before()):null:i;return o&&bt.findFrom(o,n)}function Ql(t,n){return t.dispatch(t.state.tr.setSelection(n).scrollIntoView()),!0}function iM(t,n,r){let s=t.state.selection;if(s instanceof ut)if(r.indexOf("s")>-1){let{$head:i}=s,o=i.textOffset?null:n<0?i.nodeBefore:i.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let l=t.state.doc.resolve(i.pos+o.nodeSize*(n<0?-1:1));return Ql(t,new ut(s.$anchor,l))}else if(s.empty){if(t.endOfTextblock(n>0?"forward":"backward")){let i=PS(t.state,n);return i&&i instanceof xt?Ql(t,i):!1}else if(!(ni&&r.indexOf("m")>-1)){let i=s.$head,o=i.textOffset?null:n<0?i.nodeBefore:i.nodeAfter,l;if(!o||o.isText)return!1;let c=n<0?i.pos-o.nodeSize:i.pos;return o.isAtom||(l=t.docView.descAt(c))&&!l.contentDOM?xt.isSelectable(o)?Ql(t,new xt(n<0?t.state.doc.resolve(i.pos-o.nodeSize):i)):oE?Ql(t,new ut(t.state.doc.resolve(n<0?c:c+o.nodeSize))):!1:!1}}else return!1;else{if(s instanceof xt&&s.node.isInline)return Ql(t,new ut(n>0?s.$to:s.$from));{let i=PS(t.state,n);return i?Ql(t,i):!1}}}function $1(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Qm(t,n){let r=t.pmViewDesc;return r&&r.size==0&&(n<0||t.nextSibling||t.nodeName!="BR")}function Wu(t,n){return n<0?qxe(t):Gxe(t)}function qxe(t){let n=t.domSelectionRange(),r=n.focusNode,s=n.focusOffset;if(!r)return;let i,o,l=!1;for(Uv&&r.nodeType==1&&s<$1(r)&&Qm(r.childNodes[s],-1)&&(l=!0);;)if(s>0){if(r.nodeType!=1)break;{let c=r.childNodes[s-1];if(Qm(c,-1))i=r,o=--s;else if(c.nodeType==3)r=c,s=r.nodeValue.length;else break}}else{if(N$(r))break;{let c=r.previousSibling;for(;c&&Qm(c,-1);)i=r.parentNode,o=Au(c),c=c.previousSibling;if(c)r=c,s=$1(r);else{if(r=r.parentNode,r==t.dom)break;s=0}}}l?MS(t,r,s):i&&MS(t,i,o)}function Gxe(t){let n=t.domSelectionRange(),r=n.focusNode,s=n.focusOffset;if(!r)return;let i=$1(r),o,l;for(;;)if(s<i){if(r.nodeType!=1)break;let c=r.childNodes[s];if(Qm(c,1))o=r,l=++s;else break}else{if(N$(r))break;{let c=r.nextSibling;for(;c&&Qm(c,1);)o=c.parentNode,l=Au(c)+1,c=c.nextSibling;if(c)r=c,s=0,i=$1(r);else{if(r=r.parentNode,r==t.dom)break;s=i=0}}}o&&MS(t,o,l)}function N$(t){let n=t.pmViewDesc;return n&&n.node&&n.node.isBlock}function Kxe(t,n){for(;t&&n==t.childNodes.length&&!aE(t);)n=Au(t)+1,t=t.parentNode;for(;t&&n<t.childNodes.length;){let r=t.childNodes[n];if(r.nodeType==3)return r;if(r.nodeType==1&&r.contentEditable=="false")break;t=r,n=0}}function Yxe(t,n){for(;t&&!n&&!aE(t);)n=Au(t),t=t.parentNode;for(;t&&n;){let r=t.childNodes[n-1];if(r.nodeType==3)return r;if(r.nodeType==1&&r.contentEditable=="false")break;t=r,n=t.childNodes.length}}function MS(t,n,r){if(n.nodeType!=3){let o,l;(l=Kxe(n,r))?(n=l,r=0):(o=Yxe(n,r))&&(n=o,r=o.nodeValue.length)}let s=t.domSelection();if(!s)return;if(p$(s)){let o=document.createRange();o.setEnd(n,r),o.setStart(n,r),s.removeAllRanges(),s.addRange(o)}else s.extend&&s.extend(n,r);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&lE(t)},50)}function oM(t,n){let r=t.state.doc.resolve(n);if(!(Xc||Fxe)&&r.parent.inlineContent){let i=t.coordsAtPos(n);if(n>r.start()){let o=t.coordsAtPos(n-1),l=(o.top+o.bottom)/2;if(l>i.top&&l<i.bottom&&Math.abs(o.left-i.left)>1)return o.left<i.left?"ltr":"rtl"}if(n<r.end()){let o=t.coordsAtPos(n+1),l=(o.top+o.bottom)/2;if(l>i.top&&l<i.bottom&&Math.abs(o.left-i.left)>1)return o.left>i.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function lM(t,n,r){let s=t.state.selection;if(s instanceof ut&&!s.empty||r.indexOf("s")>-1||ni&&r.indexOf("m")>-1)return!1;let{$from:i,$to:o}=s;if(!i.parent.inlineContent||t.endOfTextblock(n<0?"up":"down")){let l=PS(t.state,n);if(l&&l instanceof xt)return Ql(t,l)}if(!i.parent.inlineContent){let l=n<0?i:o,c=s instanceof pa?bt.near(l,n):bt.findFrom(l,n);return c?Ql(t,c):!1}return!1}function cM(t,n){if(!(t.state.selection instanceof ut))return!0;let{$head:r,$anchor:s,empty:i}=t.state.selection;if(!r.sameParent(s))return!0;if(!i)return!1;if(t.endOfTextblock(n>0?"forward":"backward"))return!0;let o=!r.textOffset&&(n<0?r.nodeBefore:r.nodeAfter);if(o&&!o.isText){let l=t.state.tr;return n<0?l.delete(r.pos-o.nodeSize,r.pos):l.delete(r.pos,r.pos+o.nodeSize),t.dispatch(l),!0}return!1}function dM(t,n,r){t.domObserver.stop(),n.contentEditable=r,t.domObserver.start()}function Xxe(t){if(!Eu||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:n,focusOffset:r}=t.domSelectionRange();if(n&&n.nodeType==1&&r==0&&n.firstChild&&n.firstChild.contentEditable=="false"){let s=n.firstChild;dM(t,s,"true"),setTimeout(()=>dM(t,s,"false"),20)}return!1}function Qxe(t){let n="";return t.ctrlKey&&(n+="c"),t.metaKey&&(n+="m"),t.altKey&&(n+="a"),t.shiftKey&&(n+="s"),n}function Zxe(t,n){let r=n.keyCode,s=Qxe(n);if(r==8||ni&&r==72&&s=="c")return cM(t,-1)||Wu(t,-1);if(r==46&&!n.shiftKey||ni&&r==68&&s=="c")return cM(t,1)||Wu(t,1);if(r==13||r==27)return!0;if(r==37||ni&&r==66&&s=="c"){let i=r==37?oM(t,t.state.selection.from)=="ltr"?-1:1:-1;return iM(t,i,s)||Wu(t,i)}else if(r==39||ni&&r==70&&s=="c"){let i=r==39?oM(t,t.state.selection.from)=="ltr"?1:-1:1;return iM(t,i,s)||Wu(t,i)}else{if(r==38||ni&&r==80&&s=="c")return lM(t,-1,s)||Wu(t,-1);if(r==40||ni&&r==78&&s=="c")return Xxe(t)||lM(t,1,s)||Wu(t,1);if(s==(ni?"m":"c")&&(r==66||r==73||r==89||r==90))return!0}return!1}function j$(t,n){t.someProp("transformCopied",y=>{n=y(n,t)});let r=[],{content:s,openStart:i,openEnd:o}=n;for(;i>1&&o>1&&s.childCount==1&&s.firstChild.childCount==1;){i--,o--;let y=s.firstChild;r.push(y.type.name,y.attrs!=y.type.defaultAttrs?y.attrs:null),s=y.content}let l=t.someProp("clipboardSerializer")||Bv.fromSchema(t.state.schema),c=k$(),d=c.createElement("div");d.appendChild(l.serializeFragment(s,{document:c}));let u=d.firstChild,h,m=0;for(;u&&u.nodeType==1&&(h=E$[u.nodeName.toLowerCase()]);){for(let y=h.length-1;y>=0;y--){let N=c.createElement(h[y]);for(;d.firstChild;)N.appendChild(d.firstChild);d.appendChild(N),m++}u=d.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${i} ${o}${m?` -${m}`:""} ${JSON.stringify(r)}`);let g=t.someProp("clipboardTextSerializer",y=>y(n,t))||n.content.textBetween(0,n.content.size,`

`);return{dom:d,text:g,slice:n}}function S$(t,n,r,s,i){let o=i.parent.type.spec.code,l,c;if(!r&&!n)return null;let d=!!n&&(s||o||!r);if(d){if(t.someProp("transformPastedText",g=>{n=g(n,o||s,t)}),o)return c=new Qe(Pe.from(t.state.schema.text(n.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",g=>{c=g(c,t,!0)}),c;let m=t.someProp("clipboardTextParser",g=>g(n,i,s,t));if(m)c=m;else{let g=i.marks(),{schema:y}=t.state,N=Bv.fromSchema(y);l=document.createElement("div"),n.split(/(?:\r\n?|\n)+/).forEach(j=>{let S=l.appendChild(document.createElement("p"));j&&S.appendChild(N.serializeNode(y.text(j,g)))})}}else t.someProp("transformPastedHTML",m=>{r=m(r,t)}),l=n0e(r),oE&&r0e(l);let u=l&&l.querySelector("[data-pm-slice]"),h=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(h&&h[3])for(let m=+h[3];m>0;m--){let g=l.firstChild;for(;g&&g.nodeType!=1;)g=g.nextSibling;if(!g)break;l=g}if(c||(c=(t.someProp("clipboardParser")||t.someProp("domParser")||No.fromSchema(t.state.schema)).parseSlice(l,{preserveWhitespace:!!(d||h),context:i,ruleFromNode(g){return g.nodeName=="BR"&&!g.nextSibling&&g.parentNode&&!Jxe.test(g.parentNode.nodeName)?{ignore:!0}:null}})),h)c=s0e(uM(c,+h[1],+h[2]),h[4]);else if(c=Qe.maxOpen(e0e(c.content,i),!0),c.openStart||c.openEnd){let m=0,g=0;for(let y=c.content.firstChild;m<c.openStart&&!y.type.spec.isolating;m++,y=y.firstChild);for(let y=c.content.lastChild;g<c.openEnd&&!y.type.spec.isolating;g++,y=y.lastChild);c=uM(c,m,g)}return t.someProp("transformPasted",m=>{c=m(c,t,d)}),c}const Jxe=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function e0e(t,n){if(t.childCount<2)return t;for(let r=n.depth;r>=0;r--){let i=n.node(r).contentMatchAt(n.index(r)),o,l=[];if(t.forEach(c=>{if(!l)return;let d=i.findWrapping(c.type),u;if(!d)return l=null;if(u=l.length&&o.length&&_$(d,o,c,l[l.length-1],0))l[l.length-1]=u;else{l.length&&(l[l.length-1]=A$(l[l.length-1],o.length));let h=C$(c,d);l.push(h),i=i.matchType(h.type),o=d}}),l)return Pe.from(l)}return t}function C$(t,n,r=0){for(let s=n.length-1;s>=r;s--)t=n[s].create(null,Pe.from(t));return t}function _$(t,n,r,s,i){if(i<t.length&&i<n.length&&t[i]==n[i]){let o=_$(t,n,r,s.lastChild,i+1);if(o)return s.copy(s.content.replaceChild(s.childCount-1,o));if(s.contentMatchAt(s.childCount).matchType(i==t.length-1?r.type:t[i+1]))return s.copy(s.content.append(Pe.from(C$(r,t,i+1))))}}function A$(t,n){if(n==0)return t;let r=t.content.replaceChild(t.childCount-1,A$(t.lastChild,n-1)),s=t.contentMatchAt(t.childCount).fillBefore(Pe.empty,!0);return t.copy(r.append(s))}function OS(t,n,r,s,i,o){let l=n<0?t.firstChild:t.lastChild,c=l.content;return t.childCount>1&&(o=0),i<s-1&&(c=OS(c,n,r,s,i+1,o)),i>=r&&(c=n<0?l.contentMatchAt(0).fillBefore(c,o<=i).append(c):c.append(l.contentMatchAt(l.childCount).fillBefore(Pe.empty,!0))),t.replaceChild(n<0?0:t.childCount-1,l.copy(c))}function uM(t,n,r){return n<t.openStart&&(t=new Qe(OS(t.content,-1,n,t.openStart,0,t.openEnd),n,t.openEnd)),r<t.openEnd&&(t=new Qe(OS(t.content,1,r,t.openEnd,0,0),t.openStart,r)),t}const E$={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let fM=null;function k$(){return fM||(fM=document.implementation.createHTMLDocument("title"))}let RN=null;function t0e(t){let n=window.trustedTypes;return n?(RN||(RN=n.defaultPolicy||n.createPolicy("ProseMirrorClipboard",{createHTML:r=>r})),RN.createHTML(t)):t}function n0e(t){let n=/^(\s*<meta [^>]*>)*/.exec(t);n&&(t=t.slice(n[0].length));let r=k$().createElement("div"),s=/<([a-z][^>\s]+)/i.exec(t),i;if((i=s&&E$[s[1].toLowerCase()])&&(t=i.map(o=>"<"+o+">").join("")+t+i.map(o=>"</"+o+">").reverse().join("")),r.innerHTML=t0e(t),i)for(let o=0;o<i.length;o++)r=r.querySelector(i[o])||r;return r}function r0e(t){let n=t.querySelectorAll(Xc?"span:not([class]):not([style])":"span.Apple-converted-space");for(let r=0;r<n.length;r++){let s=n[r];s.childNodes.length==1&&s.textContent==""&&s.parentNode&&s.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),s)}}function s0e(t,n){if(!t.size)return t;let r=t.content.firstChild.type.schema,s;try{s=JSON.parse(n)}catch{return t}let{content:i,openStart:o,openEnd:l}=t;for(let c=s.length-2;c>=0;c-=2){let d=r.nodes[s[c]];if(!d||d.hasRequiredAttrs())break;i=Pe.from(d.create(s[c+1],i)),o++,l++}return new Qe(i,o,l)}const qi={},Ba={};function dc(t,n){t.input.lastSelectionOrigin=n,t.input.lastSelectionTime=Date.now()}Ba.keydown=(t,n)=>{let r=n;if(t.input.shiftKey=r.keyCode==16||r.shiftKey,!I$(t,r)&&(t.input.lastKeyCode=r.keyCode,t.input.lastKeyCodeTime=Date.now(),!(bx&&Xc&&r.keyCode==13)))if(r.keyCode!=229&&t.domObserver.forceFlush(),iE&&r.keyCode==13&&!r.ctrlKey&&!r.altKey&&!r.metaKey){let s=Date.now();t.input.lastIOSEnter=s,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==s&&(t.someProp("handleKeyDown",i=>i(t,x$(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",s=>s(t,r))||Zxe(t,r)?r.preventDefault():dc(t,"key")};Ba.keyup=(t,n)=>{n.keyCode==16&&(t.input.shiftKey=!1)};Ba.keypress=(t,n)=>{let r=n;if(I$(t,r)||!r.charCode||r.ctrlKey&&!r.altKey||ni&&r.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,r))){r.preventDefault();return}let s=t.state.selection;if(!(s instanceof ut)||!s.$from.sameParent(s.$to)){let i=String.fromCharCode(r.charCode),o=()=>t.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",l=>l(t,s.$from.pos,s.$to.pos,i,o))&&t.dispatch(o()),r.preventDefault()}};function Vv(t){return{left:t.clientX,top:t.clientY}}function a0e(t,n){let r=n.x-t.clientX,s=n.y-t.clientY;return r*r+s*s<100}function cE(t,n,r,s,i){if(s==-1)return!1;let o=t.state.doc.resolve(s);for(let l=o.depth+1;l>0;l--)if(t.someProp(n,c=>l>o.depth?c(t,r,o.nodeAfter,o.before(l),i,!0):c(t,r,o.node(l),o.before(l),i,!1)))return!0;return!1}function Pf(t,n,r){if(t.focused||t.focus(),t.state.selection.eq(n))return;let s=t.state.tr.setSelection(n);s.setMeta("pointer",!0),t.dispatch(s)}function i0e(t,n){if(n==-1)return!1;let r=t.state.doc.resolve(n),s=r.nodeAfter;return s&&s.isAtom&&xt.isSelectable(s)?(Pf(t,new xt(r)),!0):!1}function o0e(t,n){if(n==-1)return!1;let r=t.state.selection,s,i;r instanceof xt&&(s=r.node);let o=t.state.doc.resolve(n);for(let l=o.depth+1;l>0;l--){let c=l>o.depth?o.nodeAfter:o.node(l);if(xt.isSelectable(c)){s&&r.$from.depth>0&&l>=r.$from.depth&&o.before(r.$from.depth+1)==r.$from.pos?i=o.before(r.$from.depth):i=o.before(l);break}}return i!=null?(Pf(t,xt.create(t.state.doc,i)),!0):!1}function l0e(t,n,r,s,i){return cE(t,"handleClickOn",n,r,s)||t.someProp("handleClick",o=>o(t,n,s))||(i?o0e(t,r):i0e(t,r))}function c0e(t,n,r,s){return cE(t,"handleDoubleClickOn",n,r,s)||t.someProp("handleDoubleClick",i=>i(t,n,s))}function d0e(t,n,r,s){return cE(t,"handleTripleClickOn",n,r,s)||t.someProp("handleTripleClick",i=>i(t,n,s))||u0e(t,r,s)}function u0e(t,n,r){if(r.button!=0)return!1;let s=t.state.doc;if(n==-1)return s.inlineContent?(Pf(t,ut.create(s,0,s.content.size)),!0):!1;let i=s.resolve(n);for(let o=i.depth+1;o>0;o--){let l=o>i.depth?i.nodeAfter:i.node(o),c=i.before(o);if(l.inlineContent)Pf(t,ut.create(s,c+1,c+1+l.content.size));else if(xt.isSelectable(l))Pf(t,xt.create(s,c));else continue;return!0}}function dE(t){return z1(t)}const T$=ni?"metaKey":"ctrlKey";qi.mousedown=(t,n)=>{let r=n;t.input.shiftKey=r.shiftKey;let s=dE(t),i=Date.now(),o="singleClick";i-t.input.lastClick.time<500&&a0e(r,t.input.lastClick)&&!r[T$]&&t.input.lastClick.button==r.button&&(t.input.lastClick.type=="singleClick"?o="doubleClick":t.input.lastClick.type=="doubleClick"&&(o="tripleClick")),t.input.lastClick={time:i,x:r.clientX,y:r.clientY,type:o,button:r.button};let l=t.posAtCoords(Vv(r));l&&(o=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new f0e(t,l,r,!!s)):(o=="doubleClick"?c0e:d0e)(t,l.pos,l.inside,r)?r.preventDefault():dc(t,"pointer"))};class f0e{constructor(n,r,s,i){this.view=n,this.pos=r,this.event=s,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=n.state.doc,this.selectNode=!!s[T$],this.allowDefault=s.shiftKey;let o,l;if(r.inside>-1)o=n.state.doc.nodeAt(r.inside),l=r.inside;else{let h=n.state.doc.resolve(r.pos);o=h.parent,l=h.depth?h.before():0}const c=i?null:s.target,d=c?n.docView.nearestDesc(c,!0):null;this.target=d&&d.nodeDOM.nodeType==1?d.nodeDOM:null;let{selection:u}=n.state;(s.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||u instanceof xt&&u.from<=l&&u.to>l)&&(this.mightDrag={node:o,pos:l,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Uv&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),n.root.addEventListener("mouseup",this.up=this.up.bind(this)),n.root.addEventListener("mousemove",this.move=this.move.bind(this)),dc(n,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>lE(this.view)),this.view.input.mouseDown=null}up(n){if(this.done(),!this.view.dom.contains(n.target))return;let r=this.pos;this.view.state.doc!=this.startDoc&&(r=this.view.posAtCoords(Vv(n))),this.updateAllowDefault(n),this.allowDefault||!r?dc(this.view,"pointer"):l0e(this.view,r.pos,r.inside,n,this.selectNode)?n.preventDefault():n.button==0&&(this.flushed||Eu&&this.mightDrag&&!this.mightDrag.node.isAtom||Xc&&!this.view.state.selection.visible&&Math.min(Math.abs(r.pos-this.view.state.selection.from),Math.abs(r.pos-this.view.state.selection.to))<=2)?(Pf(this.view,bt.near(this.view.state.doc.resolve(r.pos))),n.preventDefault()):dc(this.view,"pointer")}move(n){this.updateAllowDefault(n),dc(this.view,"pointer"),n.buttons==0&&this.done()}updateAllowDefault(n){!this.allowDefault&&(Math.abs(this.event.x-n.clientX)>4||Math.abs(this.event.y-n.clientY)>4)&&(this.allowDefault=!0)}}qi.touchstart=t=>{t.input.lastTouch=Date.now(),dE(t),dc(t,"pointer")};qi.touchmove=t=>{t.input.lastTouch=Date.now(),dc(t,"pointer")};qi.contextmenu=t=>dE(t);function I$(t,n){return t.composing?!0:Eu&&Math.abs(n.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const h0e=bx?5e3:-1;Ba.compositionstart=Ba.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:n}=t,r=n.selection.$to;if(n.selection instanceof ut&&(n.storedMarks||!r.textOffset&&r.parentOffset&&r.nodeBefore.marks.some(s=>s.type.spec.inclusive===!1)))t.markCursor=t.state.storedMarks||r.marks(),z1(t,!0),t.markCursor=null;else if(z1(t,!n.selection.empty),Uv&&n.selection.empty&&r.parentOffset&&!r.textOffset&&r.nodeBefore.marks.length){let s=t.domSelectionRange();for(let i=s.focusNode,o=s.focusOffset;i&&i.nodeType==1&&o!=0;){let l=o<0?i.lastChild:i.childNodes[o-1];if(!l)break;if(l.nodeType==3){let c=t.domSelection();c&&c.collapse(l,l.nodeValue.length);break}else i=l,o=-1}}t.input.composing=!0}P$(t,h0e)};Ba.compositionend=(t,n)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=n.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,P$(t,20))};function P$(t,n){clearTimeout(t.input.composingTimeout),n>-1&&(t.input.composingTimeout=setTimeout(()=>z1(t),n))}function m0e(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=p0e());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function p0e(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function z1(t,n=!1){if(!(bx&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),m0e(t),n||t.docView&&t.docView.dirty){let r=zxe(t),s=t.state.selection;return r&&!r.eq(s)?t.dispatch(t.state.tr.setSelection(r)):(t.markCursor||n)&&!s.$from.node(s.$from.sharedDepth(s.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function x0e(t,n){if(!t.dom.parentNode)return;let r=t.dom.parentNode.appendChild(document.createElement("div"));r.appendChild(n),r.style.cssText="position: fixed; left: -10000px; top: 10px";let s=getSelection(),i=document.createRange();i.selectNodeContents(n),t.dom.blur(),s.removeAllRanges(),s.addRange(i),setTimeout(()=>{r.parentNode&&r.parentNode.removeChild(r),t.focus()},50)}const Dp=vx&&y$<15||iE&&$xe<604;qi.copy=Ba.cut=(t,n)=>{let r=n,s=t.state.selection,i=r.type=="cut";if(s.empty)return;let o=Dp?null:r.clipboardData,l=s.content(),{dom:c,text:d}=j$(t,l);o?(r.preventDefault(),o.clearData(),o.setData("text/html",c.innerHTML),o.setData("text/plain",d)):x0e(t,c),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function g0e(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function y0e(t,n){if(!t.dom.parentNode)return;let r=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,s=t.dom.parentNode.appendChild(document.createElement(r?"textarea":"div"));r||(s.contentEditable="true"),s.style.cssText="position: fixed; left: -10000px; top: 10px",s.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),s.parentNode&&s.parentNode.removeChild(s),r?DS(t,s.value,null,i,n):DS(t,s.textContent,s.innerHTML,i,n)},50)}function DS(t,n,r,s,i){let o=S$(t,n,r,s,t.state.selection.$from);if(t.someProp("handlePaste",d=>d(t,i,o||Qe.empty)))return!0;if(!o)return!1;let l=g0e(o),c=l?t.state.tr.replaceSelectionWith(l,s):t.state.tr.replaceSelection(o);return t.dispatch(c.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function M$(t){let n=t.getData("text/plain")||t.getData("Text");if(n)return n;let r=t.getData("text/uri-list");return r?r.replace(/\r?\n/g," "):""}Ba.paste=(t,n)=>{let r=n;if(t.composing&&!bx)return;let s=Dp?null:r.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;s&&DS(t,M$(s),s.getData("text/html"),i,r)?r.preventDefault():y0e(t,r)};class v0e{constructor(n,r,s){this.slice=n,this.move=r,this.node=s}}const b0e=ni?"altKey":"ctrlKey";function O$(t,n){let r=t.someProp("dragCopies",s=>!s(n));return r??!n[b0e]}qi.dragstart=(t,n)=>{let r=n,s=t.input.mouseDown;if(s&&s.done(),!r.dataTransfer)return;let i=t.state.selection,o=i.empty?null:t.posAtCoords(Vv(r)),l;if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof xt?i.to-1:i.to))){if(s&&s.mightDrag)l=xt.create(t.state.doc,s.mightDrag.pos);else if(r.target&&r.target.nodeType==1){let m=t.docView.nearestDesc(r.target,!0);m&&m.node.type.spec.draggable&&m!=t.docView&&(l=xt.create(t.state.doc,m.posBefore))}}let c=(l||t.state.selection).content(),{dom:d,text:u,slice:h}=j$(t,c);(!r.dataTransfer.files.length||!Xc||v$>120)&&r.dataTransfer.clearData(),r.dataTransfer.setData(Dp?"Text":"text/html",d.innerHTML),r.dataTransfer.effectAllowed="copyMove",Dp||r.dataTransfer.setData("text/plain",u),t.dragging=new v0e(h,O$(t,r),l)};qi.dragend=t=>{let n=t.dragging;window.setTimeout(()=>{t.dragging==n&&(t.dragging=null)},50)};Ba.dragover=Ba.dragenter=(t,n)=>n.preventDefault();Ba.drop=(t,n)=>{let r=n,s=t.dragging;if(t.dragging=null,!r.dataTransfer)return;let i=t.posAtCoords(Vv(r));if(!i)return;let o=t.state.doc.resolve(i.pos),l=s&&s.slice;l?t.someProp("transformPasted",N=>{l=N(l,t,!1)}):l=S$(t,M$(r.dataTransfer),Dp?null:r.dataTransfer.getData("text/html"),!1,o);let c=!!(s&&O$(t,r));if(t.someProp("handleDrop",N=>N(t,r,l||Qe.empty,c))){r.preventDefault();return}if(!l)return;r.preventDefault();let d=l?zF(t.state.doc,o.pos,l):o.pos;d==null&&(d=o.pos);let u=t.state.tr;if(c){let{node:N}=s;N?N.replace(u):u.deleteSelection()}let h=u.mapping.map(d),m=l.openStart==0&&l.openEnd==0&&l.content.childCount==1,g=u.doc;if(m?u.replaceRangeWith(h,h,l.content.firstChild):u.replaceRange(h,h,l),u.doc.eq(g))return;let y=u.doc.resolve(h);if(m&&xt.isSelectable(l.content.firstChild)&&y.nodeAfter&&y.nodeAfter.sameMarkup(l.content.firstChild))u.setSelection(new xt(y));else{let N=u.mapping.map(d);u.mapping.maps[u.mapping.maps.length-1].forEach((j,S,_,A)=>N=A),u.setSelection(w$(t,y,u.doc.resolve(N)))}t.focus(),t.dispatch(u.setMeta("uiEvent","drop"))};qi.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&lE(t)},20))};qi.blur=(t,n)=>{let r=n;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),r.relatedTarget&&t.dom.contains(r.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};qi.beforeinput=(t,n)=>{if(Xc&&bx&&n.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:s}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=s||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",o=>o(t,x$(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in Ba)qi[t]=Ba[t];function Rp(t,n){if(t==n)return!0;for(let r in t)if(t[r]!==n[r])return!1;for(let r in n)if(!(r in t))return!1;return!0}class U1{constructor(n,r){this.toDOM=n,this.spec=r||Wd,this.side=this.spec.side||0}map(n,r,s,i){let{pos:o,deleted:l}=n.mapResult(r.from+i,this.side<0?-1:1);return l?null:new Ia(o-s,o-s,this)}valid(){return!0}eq(n){return this==n||n instanceof U1&&(this.spec.key&&this.spec.key==n.spec.key||this.toDOM==n.toDOM&&Rp(this.spec,n.spec))}destroy(n){this.spec.destroy&&this.spec.destroy(n)}}class Sc{constructor(n,r){this.attrs=n,this.spec=r||Wd}map(n,r,s,i){let o=n.map(r.from+i,this.spec.inclusiveStart?-1:1)-s,l=n.map(r.to+i,this.spec.inclusiveEnd?1:-1)-s;return o>=l?null:new Ia(o,l,this)}valid(n,r){return r.from<r.to}eq(n){return this==n||n instanceof Sc&&Rp(this.attrs,n.attrs)&&Rp(this.spec,n.spec)}static is(n){return n.type instanceof Sc}destroy(){}}class uE{constructor(n,r){this.attrs=n,this.spec=r||Wd}map(n,r,s,i){let o=n.mapResult(r.from+i,1);if(o.deleted)return null;let l=n.mapResult(r.to+i,-1);return l.deleted||l.pos<=o.pos?null:new Ia(o.pos-s,l.pos-s,this)}valid(n,r){let{index:s,offset:i}=n.content.findIndex(r.from),o;return i==r.from&&!(o=n.child(s)).isText&&i+o.nodeSize==r.to}eq(n){return this==n||n instanceof uE&&Rp(this.attrs,n.attrs)&&Rp(this.spec,n.spec)}destroy(){}}class Ia{constructor(n,r,s){this.from=n,this.to=r,this.type=s}copy(n,r){return new Ia(n,r,this.type)}eq(n,r=0){return this.type.eq(n.type)&&this.from+r==n.from&&this.to+r==n.to}map(n,r,s){return this.type.map(n,this,r,s)}static widget(n,r,s){return new Ia(n,n,new U1(r,s))}static inline(n,r,s,i){return new Ia(n,r,new Sc(s,i))}static node(n,r,s,i){return new Ia(n,r,new uE(s,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Sc}get widget(){return this.type instanceof U1}}const Xu=[],Wd={};class pr{constructor(n,r){this.local=n.length?n:Xu,this.children=r.length?r:Xu}static create(n,r){return r.length?V1(r,n,0,Wd):Fs}find(n,r,s){let i=[];return this.findInner(n??0,r??1e9,i,0,s),i}findInner(n,r,s,i,o){for(let l=0;l<this.local.length;l++){let c=this.local[l];c.from<=r&&c.to>=n&&(!o||o(c.spec))&&s.push(c.copy(c.from+i,c.to+i))}for(let l=0;l<this.children.length;l+=3)if(this.children[l]<r&&this.children[l+1]>n){let c=this.children[l]+1;this.children[l+2].findInner(n-c,r-c,s,i+c,o)}}map(n,r,s){return this==Fs||n.maps.length==0?this:this.mapInner(n,r,0,0,s||Wd)}mapInner(n,r,s,i,o){let l;for(let c=0;c<this.local.length;c++){let d=this.local[c].map(n,s,i);d&&d.type.valid(r,d)?(l||(l=[])).push(d):o.onRemove&&o.onRemove(this.local[c].spec)}return this.children.length?w0e(this.children,l||[],n,r,s,i,o):l?new pr(l.sort(qd),Xu):Fs}add(n,r){return r.length?this==Fs?pr.create(n,r):this.addInner(n,r,0):this}addInner(n,r,s){let i,o=0;n.forEach((c,d)=>{let u=d+s,h;if(h=R$(r,c,u)){for(i||(i=this.children.slice());o<i.length&&i[o]<d;)o+=3;i[o]==d?i[o+2]=i[o+2].addInner(c,h,u+1):i.splice(o,0,d,d+c.nodeSize,V1(h,c,u+1,Wd)),o+=3}});let l=D$(o?L$(r):r,-s);for(let c=0;c<l.length;c++)l[c].type.valid(n,l[c])||l.splice(c--,1);return new pr(l.length?this.local.concat(l).sort(qd):this.local,i||this.children)}remove(n){return n.length==0||this==Fs?this:this.removeInner(n,0)}removeInner(n,r){let s=this.children,i=this.local;for(let o=0;o<s.length;o+=3){let l,c=s[o]+r,d=s[o+1]+r;for(let h=0,m;h<n.length;h++)(m=n[h])&&m.from>c&&m.to<d&&(n[h]=null,(l||(l=[])).push(m));if(!l)continue;s==this.children&&(s=this.children.slice());let u=s[o+2].removeInner(l,c+1);u!=Fs?s[o+2]=u:(s.splice(o,3),o-=3)}if(i.length){for(let o=0,l;o<n.length;o++)if(l=n[o])for(let c=0;c<i.length;c++)i[c].eq(l,r)&&(i==this.local&&(i=this.local.slice()),i.splice(c--,1))}return s==this.children&&i==this.local?this:i.length||s.length?new pr(i,s):Fs}forChild(n,r){if(this==Fs)return this;if(r.isLeaf)return pr.empty;let s,i;for(let c=0;c<this.children.length;c+=3)if(this.children[c]>=n){this.children[c]==n&&(s=this.children[c+2]);break}let o=n+1,l=o+r.content.size;for(let c=0;c<this.local.length;c++){let d=this.local[c];if(d.from<l&&d.to>o&&d.type instanceof Sc){let u=Math.max(o,d.from)-o,h=Math.min(l,d.to)-o;u<h&&(i||(i=[])).push(d.copy(u,h))}}if(i){let c=new pr(i.sort(qd),Xu);return s?new yd([c,s]):c}return s||Fs}eq(n){if(this==n)return!0;if(!(n instanceof pr)||this.local.length!=n.local.length||this.children.length!=n.children.length)return!1;for(let r=0;r<this.local.length;r++)if(!this.local[r].eq(n.local[r]))return!1;for(let r=0;r<this.children.length;r+=3)if(this.children[r]!=n.children[r]||this.children[r+1]!=n.children[r+1]||!this.children[r+2].eq(n.children[r+2]))return!1;return!0}locals(n){return fE(this.localsInner(n))}localsInner(n){if(this==Fs)return Xu;if(n.inlineContent||!this.local.some(Sc.is))return this.local;let r=[];for(let s=0;s<this.local.length;s++)this.local[s].type instanceof Sc||r.push(this.local[s]);return r}forEachSet(n){n(this)}}pr.empty=new pr([],[]);pr.removeOverlap=fE;const Fs=pr.empty;class yd{constructor(n){this.members=n}map(n,r){const s=this.members.map(i=>i.map(n,r,Wd));return yd.from(s)}forChild(n,r){if(r.isLeaf)return pr.empty;let s=[];for(let i=0;i<this.members.length;i++){let o=this.members[i].forChild(n,r);o!=Fs&&(o instanceof yd?s=s.concat(o.members):s.push(o))}return yd.from(s)}eq(n){if(!(n instanceof yd)||n.members.length!=this.members.length)return!1;for(let r=0;r<this.members.length;r++)if(!this.members[r].eq(n.members[r]))return!1;return!0}locals(n){let r,s=!0;for(let i=0;i<this.members.length;i++){let o=this.members[i].localsInner(n);if(o.length)if(!r)r=o;else{s&&(r=r.slice(),s=!1);for(let l=0;l<o.length;l++)r.push(o[l])}}return r?fE(s?r:r.sort(qd)):Xu}static from(n){switch(n.length){case 0:return Fs;case 1:return n[0];default:return new yd(n.every(r=>r instanceof pr)?n:n.reduce((r,s)=>r.concat(s instanceof pr?s:s.members),[]))}}forEachSet(n){for(let r=0;r<this.members.length;r++)this.members[r].forEachSet(n)}}function w0e(t,n,r,s,i,o,l){let c=t.slice();for(let u=0,h=o;u<r.maps.length;u++){let m=0;r.maps[u].forEach((g,y,N,j)=>{let S=j-N-(y-g);for(let _=0;_<c.length;_+=3){let A=c[_+1];if(A<0||g>A+h-m)continue;let k=c[_]+h-m;y>=k?c[_+1]=g<=k?-2:-1:g>=h&&S&&(c[_]+=S,c[_+1]+=S)}m+=S}),h=r.maps[u].map(h,-1)}let d=!1;for(let u=0;u<c.length;u+=3)if(c[u+1]<0){if(c[u+1]==-2){d=!0,c[u+1]=-1;continue}let h=r.map(t[u]+o),m=h-i;if(m<0||m>=s.content.size){d=!0;continue}let g=r.map(t[u+1]+o,-1),y=g-i,{index:N,offset:j}=s.content.findIndex(m),S=s.maybeChild(N);if(S&&j==m&&j+S.nodeSize==y){let _=c[u+2].mapInner(r,S,h+1,t[u]+o+1,l);_!=Fs?(c[u]=m,c[u+1]=y,c[u+2]=_):(c[u+1]=-2,d=!0)}else d=!0}if(d){let u=N0e(c,t,n,r,i,o,l),h=V1(u,s,0,l);n=h.local;for(let m=0;m<c.length;m+=3)c[m+1]<0&&(c.splice(m,3),m-=3);for(let m=0,g=0;m<h.children.length;m+=3){let y=h.children[m];for(;g<c.length&&c[g]<y;)g+=3;c.splice(g,0,h.children[m],h.children[m+1],h.children[m+2])}}return new pr(n.sort(qd),c)}function D$(t,n){if(!n||!t.length)return t;let r=[];for(let s=0;s<t.length;s++){let i=t[s];r.push(new Ia(i.from+n,i.to+n,i.type))}return r}function N0e(t,n,r,s,i,o,l){function c(d,u){for(let h=0;h<d.local.length;h++){let m=d.local[h].map(s,i,u);m?r.push(m):l.onRemove&&l.onRemove(d.local[h].spec)}for(let h=0;h<d.children.length;h+=3)c(d.children[h+2],d.children[h]+u+1)}for(let d=0;d<t.length;d+=3)t[d+1]==-1&&c(t[d+2],n[d]+o+1);return r}function R$(t,n,r){if(n.isLeaf)return null;let s=r+n.nodeSize,i=null;for(let o=0,l;o<t.length;o++)(l=t[o])&&l.from>r&&l.to<s&&((i||(i=[])).push(l),t[o]=null);return i}function L$(t){let n=[];for(let r=0;r<t.length;r++)t[r]!=null&&n.push(t[r]);return n}function V1(t,n,r,s){let i=[],o=!1;n.forEach((c,d)=>{let u=R$(t,c,d+r);if(u){o=!0;let h=V1(u,c,r+d+1,s);h!=Fs&&i.push(d,d+c.nodeSize,h)}});let l=D$(o?L$(t):t,-r).sort(qd);for(let c=0;c<l.length;c++)l[c].type.valid(n,l[c])||(s.onRemove&&s.onRemove(l[c].spec),l.splice(c--,1));return l.length||i.length?new pr(l,i):Fs}function qd(t,n){return t.from-n.from||t.to-n.to}function fE(t){let n=t;for(let r=0;r<n.length-1;r++){let s=n[r];if(s.from!=s.to)for(let i=r+1;i<n.length;i++){let o=n[i];if(o.from==s.from){o.to!=s.to&&(n==t&&(n=t.slice()),n[i]=o.copy(o.from,s.to),hM(n,i+1,o.copy(s.to,o.to)));continue}else{o.from<s.to&&(n==t&&(n=t.slice()),n[r]=s.copy(s.from,o.from),hM(n,i,s.copy(o.from,s.to)));break}}}return n}function hM(t,n,r){for(;n<t.length&&qd(r,t[n])>0;)n++;t.splice(n,0,r)}var Rc={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},H1={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},j0e=typeof navigator<"u"&&/Mac/.test(navigator.platform),S0e=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var ms=0;ms<10;ms++)Rc[48+ms]=Rc[96+ms]=String(ms);for(var ms=1;ms<=24;ms++)Rc[ms+111]="F"+ms;for(var ms=65;ms<=90;ms++)Rc[ms]=String.fromCharCode(ms+32),H1[ms]=String.fromCharCode(ms);for(var LN in Rc)H1.hasOwnProperty(LN)||(H1[LN]=Rc[LN]);function C0e(t){var n=j0e&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||S0e&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",r=!n&&t.key||(t.shiftKey?H1:Rc)[t.keyCode]||t.key||"Unidentified";return r=="Esc"&&(r="Escape"),r=="Del"&&(r="Delete"),r=="Left"&&(r="ArrowLeft"),r=="Up"&&(r="ArrowUp"),r=="Right"&&(r="ArrowRight"),r=="Down"&&(r="ArrowDown"),r}const _0e=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),A0e=typeof navigator<"u"&&/Win/.test(navigator.platform);function E0e(t){let n=t.split(/-(?!$)/),r=n[n.length-1];r=="Space"&&(r=" ");let s,i,o,l;for(let c=0;c<n.length-1;c++){let d=n[c];if(/^(cmd|meta|m)$/i.test(d))l=!0;else if(/^a(lt)?$/i.test(d))s=!0;else if(/^(c|ctrl|control)$/i.test(d))i=!0;else if(/^s(hift)?$/i.test(d))o=!0;else if(/^mod$/i.test(d))_0e?l=!0:i=!0;else throw new Error("Unrecognized modifier name: "+d)}return s&&(r="Alt-"+r),i&&(r="Ctrl-"+r),l&&(r="Meta-"+r),o&&(r="Shift-"+r),r}function k0e(t){let n=Object.create(null);for(let r in t)n[E0e(r)]=t[r];return n}function BN(t,n,r=!0){return n.altKey&&(t="Alt-"+t),n.ctrlKey&&(t="Ctrl-"+t),n.metaKey&&(t="Meta-"+t),r&&n.shiftKey&&(t="Shift-"+t),t}function B$(t){let n=k0e(t);return function(r,s){let i=C0e(s),o,l=n[BN(i,s)];if(l&&l(r.state,r.dispatch,r))return!0;if(i.length==1&&i!=" "){if(s.shiftKey){let c=n[BN(i,s,!1)];if(c&&c(r.state,r.dispatch,r))return!0}if((s.altKey||s.metaKey||s.ctrlKey)&&!(A0e&&s.ctrlKey&&s.altKey)&&(o=Rc[s.keyCode])&&o!=i){let c=n[BN(o,s)];if(c&&c(r.state,r.dispatch,r))return!0}}return!1}}var T0e=Object.defineProperty,hE=(t,n)=>{for(var r in n)T0e(t,r,{get:n[r],enumerable:!0})};function F$(t){const{state:n,transaction:r}=t;let{selection:s}=r,{doc:i}=r,{storedMarks:o}=r;return{...n,apply:n.apply.bind(n),applyTransaction:n.applyTransaction.bind(n),plugins:n.plugins,schema:n.schema,reconfigure:n.reconfigure.bind(n),toJSON:n.toJSON.bind(n),get storedMarks(){return o},get selection(){return s},get doc(){return i},get tr(){return s=r.selection,i=r.doc,o=r.storedMarks,r}}}var I0e=class{constructor(n){this.editor=n.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=n.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:n,editor:r,state:s}=this,{view:i}=r,{tr:o}=s,l=this.buildProps(o);return Object.fromEntries(Object.entries(n).map(([c,d])=>[c,(...h)=>{const m=d(...h)(l);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(o),m}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(n,r=!0){const{rawCommands:s,editor:i,state:o}=this,{view:l}=i,c=[],d=!!n,u=n||o.tr,h=()=>(!d&&r&&!u.getMeta("preventDispatch")&&!this.hasCustomState&&l.dispatch(u),c.every(g=>g===!0)),m={...Object.fromEntries(Object.entries(s).map(([g,y])=>[g,(...j)=>{const S=this.buildProps(u,r),_=y(...j)(S);return c.push(_),m}])),run:h};return m}createCan(n){const{rawCommands:r,state:s}=this,i=!1,o=n||s.tr,l=this.buildProps(o,i);return{...Object.fromEntries(Object.entries(r).map(([d,u])=>[d,(...h)=>u(...h)({...l,dispatch:void 0})])),chain:()=>this.createChain(o,i)}}buildProps(n,r=!0){const{rawCommands:s,editor:i,state:o}=this,{view:l}=i,c={tr:n,editor:i,view:l,state:F$({state:o,transaction:n}),dispatch:r?()=>{}:void 0,chain:()=>this.createChain(n,r),can:()=>this.createCan(n),get commands(){return Object.fromEntries(Object.entries(s).map(([d,u])=>[d,(...h)=>u(...h)(c)]))}};return c}},$$={};hE($$,{blur:()=>P0e,clearContent:()=>M0e,clearNodes:()=>O0e,command:()=>D0e,createParagraphNear:()=>R0e,cut:()=>L0e,deleteCurrentNode:()=>B0e,deleteNode:()=>F0e,deleteRange:()=>$0e,deleteSelection:()=>z0e,enter:()=>U0e,exitCode:()=>V0e,extendMarkRange:()=>W0e,first:()=>q0e,focus:()=>Y0e,forEach:()=>X0e,insertContent:()=>Q0e,insertContentAt:()=>ege,joinBackward:()=>rge,joinDown:()=>nge,joinForward:()=>sge,joinItemBackward:()=>age,joinItemForward:()=>ige,joinTextblockBackward:()=>oge,joinTextblockForward:()=>lge,joinUp:()=>tge,keyboardShortcut:()=>dge,lift:()=>uge,liftEmptyBlock:()=>fge,liftListItem:()=>hge,newlineInCode:()=>mge,resetAttributes:()=>pge,scrollIntoView:()=>xge,selectAll:()=>gge,selectNodeBackward:()=>yge,selectNodeForward:()=>vge,selectParentNode:()=>bge,selectTextblockEnd:()=>wge,selectTextblockStart:()=>Nge,setContent:()=>Sge,setMark:()=>Lge,setMeta:()=>Bge,setNode:()=>Fge,setNodeSelection:()=>$ge,setTextSelection:()=>zge,sinkListItem:()=>Uge,splitBlock:()=>Vge,splitListItem:()=>Hge,toggleList:()=>Wge,toggleMark:()=>qge,toggleNode:()=>Gge,toggleWrap:()=>Kge,undoInputRule:()=>Yge,unsetAllMarks:()=>Xge,unsetMark:()=>Qge,updateAttributes:()=>Zge,wrapIn:()=>Jge,wrapInList:()=>e1e});var P0e=()=>({editor:t,view:n})=>(requestAnimationFrame(()=>{var r;t.isDestroyed||(n.dom.blur(),(r=window==null?void 0:window.getSelection())==null||r.removeAllRanges())}),!0),M0e=(t=!0)=>({commands:n})=>n.setContent("",{emitUpdate:t}),O0e=()=>({state:t,tr:n,dispatch:r})=>{const{selection:s}=n,{ranges:i}=s;return r&&i.forEach(({$from:o,$to:l})=>{t.doc.nodesBetween(o.pos,l.pos,(c,d)=>{if(c.type.isText)return;const{doc:u,mapping:h}=n,m=u.resolve(h.map(d)),g=u.resolve(h.map(d+c.nodeSize)),y=m.blockRange(g);if(!y)return;const N=_u(y);if(c.type.isTextblock){const{defaultType:j}=m.parent.contentMatchAt(m.index());n.setNodeMarkup(y.start,j)}(N||N===0)&&n.lift(y,N)})}),!0},D0e=t=>n=>t(n),R0e=()=>({state:t,dispatch:n})=>nE(t,n),L0e=(t,n)=>({editor:r,tr:s})=>{const{state:i}=r,o=i.doc.slice(t.from,t.to);s.deleteRange(t.from,t.to);const l=s.mapping.map(n);return s.insert(l,o.content),s.setSelection(new ut(s.doc.resolve(Math.max(l-1,0)))),!0},B0e=()=>({tr:t,dispatch:n})=>{const{selection:r}=t,s=r.$anchor.node();if(s.content.size>0)return!1;const i=t.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===s.type){if(n){const c=i.before(o),d=i.after(o);t.delete(c,d).scrollIntoView()}return!0}return!1};function Ds(t,n){if(typeof t=="string"){if(!n.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return n.nodes[t]}return t}var F0e=t=>({tr:n,state:r,dispatch:s})=>{const i=Ds(t,r.schema),o=n.selection.$anchor;for(let l=o.depth;l>0;l-=1)if(o.node(l).type===i){if(s){const d=o.before(l),u=o.after(l);n.delete(d,u).scrollIntoView()}return!0}return!1},$0e=t=>({tr:n,dispatch:r})=>{const{from:s,to:i}=t;return r&&n.delete(s,i),!0},z0e=()=>({state:t,dispatch:n})=>zv(t,n),U0e=()=>({commands:t})=>t.keyboardShortcut("Enter"),V0e=()=>({state:t,dispatch:n})=>s$(t,n);function H0e(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function W1(t,n,r={strict:!0}){const s=Object.keys(n);return s.length?s.every(i=>r.strict?n[i]===t[i]:H0e(n[i])?n[i].test(t[i]):n[i]===t[i]):!0}function z$(t,n,r={}){return t.find(s=>s.type===n&&W1(Object.fromEntries(Object.keys(r).map(i=>[i,s.attrs[i]])),r))}function mM(t,n,r={}){return!!z$(t,n,r)}function mE(t,n,r){var s;if(!t||!n)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(h=>h.type===n))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(h=>h.type===n)||(r=r||((s=i.node.marks[0])==null?void 0:s.attrs),!z$([...i.node.marks],n,r)))return;let l=i.index,c=t.start()+i.offset,d=l+1,u=c+i.node.nodeSize;for(;l>0&&mM([...t.parent.child(l-1).marks],n,r);)l-=1,c-=t.parent.child(l).nodeSize;for(;d<t.parent.childCount&&mM([...t.parent.child(d).marks],n,r);)u+=t.parent.child(d).nodeSize,d+=1;return{from:c,to:u}}function Qc(t,n){if(typeof t=="string"){if(!n.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return n.marks[t]}return t}var W0e=(t,n={})=>({tr:r,state:s,dispatch:i})=>{const o=Qc(t,s.schema),{doc:l,selection:c}=r,{$from:d,from:u,to:h}=c;if(i){const m=mE(d,o,n);if(m&&m.from<=u&&m.to>=h){const g=ut.create(l,m.from,m.to);r.setSelection(g)}}return!0},q0e=t=>n=>{const r=typeof t=="function"?t(n):t;for(let s=0;s<r.length;s+=1)if(r[s](n))return!0;return!1};function U$(t){return t instanceof ut}function Td(t=0,n=0,r=0){return Math.min(Math.max(t,n),r)}function G0e(t,n=null){if(!n)return null;const r=bt.atStart(t),s=bt.atEnd(t);if(n==="start"||n===!0)return r;if(n==="end")return s;const i=r.from,o=s.to;return n==="all"?ut.create(t,Td(0,i,o),Td(t.content.size,i,o)):ut.create(t,Td(n,i,o),Td(n,i,o))}function K0e(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function pE(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var Y0e=(t=null,n={})=>({editor:r,view:s,tr:i,dispatch:o})=>{n={scrollIntoView:!0,...n};const l=()=>{(pE()||K0e())&&s.dom.focus(),requestAnimationFrame(()=>{r.isDestroyed||(s.focus(),n!=null&&n.scrollIntoView&&r.commands.scrollIntoView())})};if(s.hasFocus()&&t===null||t===!1)return!0;if(o&&t===null&&!U$(r.state.selection))return l(),!0;const c=G0e(i.doc,t)||r.state.selection,d=r.state.selection.eq(c);return o&&(d||i.setSelection(c),d&&i.storedMarks&&i.setStoredMarks(i.storedMarks),l()),!0},X0e=(t,n)=>r=>t.every((s,i)=>n(s,{...r,index:i})),Q0e=(t,n)=>({tr:r,commands:s})=>s.insertContentAt({from:r.selection.from,to:r.selection.to},t,n),V$=t=>{const n=t.childNodes;for(let r=n.length-1;r>=0;r-=1){const s=n[r];s.nodeType===3&&s.nodeValue&&/^(\n\s\s|\n)$/.test(s.nodeValue)?t.removeChild(s):s.nodeType===1&&V$(s)}return t};function P0(t){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const n=`<body>${t}</body>`,r=new window.DOMParser().parseFromString(n,"text/html").body;return V$(r)}function Lp(t,n,r){if(t instanceof jc||t instanceof Pe)return t;r={slice:!0,parseOptions:{},...r};const s=typeof t=="object"&&t!==null,i=typeof t=="string";if(s)try{if(Array.isArray(t)&&t.length>0)return Pe.fromArray(t.map(c=>n.nodeFromJSON(c)));const l=n.nodeFromJSON(t);return r.errorOnInvalidContent&&l.check(),l}catch(o){if(r.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",o),Lp("",n,r)}if(i){if(r.errorOnInvalidContent){let l=!1,c="";const d=new TF({topNode:n.spec.topNode,marks:n.spec.marks,nodes:n.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(l=!0,c=typeof u=="string"?u:u.outerHTML,null)}]}})});if(r.slice?No.fromSchema(d).parseSlice(P0(t),r.parseOptions):No.fromSchema(d).parse(P0(t),r.parseOptions),r.errorOnInvalidContent&&l)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${c}`)})}const o=No.fromSchema(n);return r.slice?o.parseSlice(P0(t),r.parseOptions).content:o.parse(P0(t),r.parseOptions)}return Lp("",n,r)}function Z0e(t,n,r){const s=t.steps.length-1;if(s<n)return;const i=t.steps[s];if(!(i instanceof Br||i instanceof Ur))return;const o=t.mapping.maps[s];let l=0;o.forEach((c,d,u,h)=>{l===0&&(l=h)}),t.setSelection(bt.near(t.doc.resolve(l),r))}var J0e=t=>!("type"in t),ege=(t,n,r)=>({tr:s,dispatch:i,editor:o})=>{var l;if(i){r={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...r};let c;const d=S=>{o.emit("contentError",{editor:o,error:S,disableCollaboration:()=>{"collaboration"in o.storage&&typeof o.storage.collaboration=="object"&&o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}})},u={preserveWhitespace:"full",...r.parseOptions};if(!r.errorOnInvalidContent&&!o.options.enableContentCheck&&o.options.emitContentError)try{Lp(n,o.schema,{parseOptions:u,errorOnInvalidContent:!0})}catch(S){d(S)}try{c=Lp(n,o.schema,{parseOptions:u,errorOnInvalidContent:(l=r.errorOnInvalidContent)!=null?l:o.options.enableContentCheck})}catch(S){return d(S),!1}let{from:h,to:m}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},g=!0,y=!0;if((J0e(c)?c:[c]).forEach(S=>{S.check(),g=g?S.isText&&S.marks.length===0:!1,y=y?S.isBlock:!1}),h===m&&y){const{parent:S}=s.doc.resolve(h);S.isTextblock&&!S.type.spec.code&&!S.childCount&&(h-=1,m+=1)}let j;if(g){if(Array.isArray(n))j=n.map(S=>S.text||"").join("");else if(n instanceof Pe){let S="";n.forEach(_=>{_.text&&(S+=_.text)}),j=S}else typeof n=="object"&&n&&n.text?j=n.text:j=n;s.insertText(j,h,m)}else{j=c;const S=s.doc.resolve(h),_=S.node(),A=S.parentOffset===0,k=_.isText||_.isTextblock,T=_.content.size>0;A&&k&&T&&(h=Math.max(0,h-1)),s.replaceWith(h,m,j)}r.updateSelection&&Z0e(s,s.steps.length-1,-1),r.applyInputRules&&s.setMeta("applyInputRules",{from:h,text:j}),r.applyPasteRules&&s.setMeta("applyPasteRules",{from:h,text:j})}return!0},tge=()=>({state:t,dispatch:n})=>t$(t,n),nge=()=>({state:t,dispatch:n})=>n$(t,n),rge=()=>({state:t,dispatch:n})=>KA(t,n),sge=()=>({state:t,dispatch:n})=>QA(t,n),age=()=>({state:t,dispatch:n,tr:r})=>{try{const s=_h(t.doc,t.selection.$from.pos,-1);return s==null?!1:(r.join(s,2),n&&n(r),!0)}catch{return!1}},ige=()=>({state:t,dispatch:n,tr:r})=>{try{const s=_h(t.doc,t.selection.$from.pos,1);return s==null?!1:(r.join(s,2),n&&n(r),!0)}catch{return!1}},oge=()=>({state:t,dispatch:n})=>QF(t,n),lge=()=>({state:t,dispatch:n})=>ZF(t,n);function H$(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function cge(t){const n=t.split(/-(?!$)/);let r=n[n.length-1];r==="Space"&&(r=" ");let s,i,o,l;for(let c=0;c<n.length-1;c+=1){const d=n[c];if(/^(cmd|meta|m)$/i.test(d))l=!0;else if(/^a(lt)?$/i.test(d))s=!0;else if(/^(c|ctrl|control)$/i.test(d))i=!0;else if(/^s(hift)?$/i.test(d))o=!0;else if(/^mod$/i.test(d))pE()||H$()?l=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${d}`)}return s&&(r=`Alt-${r}`),i&&(r=`Ctrl-${r}`),l&&(r=`Meta-${r}`),o&&(r=`Shift-${r}`),r}var dge=t=>({editor:n,view:r,tr:s,dispatch:i})=>{const o=cge(t).split(/-(?!$)/),l=o.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),c=new KeyboardEvent("keydown",{key:l==="Space"?" ":l,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),d=n.captureTransaction(()=>{r.someProp("handleKeyDown",u=>u(r,c))});return d==null||d.steps.forEach(u=>{const h=u.map(s.mapping);h&&i&&s.maybeStep(h)}),!0};function xE(t,n,r={}){const{from:s,to:i,empty:o}=t.selection,l=n?Ds(n,t.schema):null,c=[];t.doc.nodesBetween(s,i,(m,g)=>{if(m.isText)return;const y=Math.max(s,g),N=Math.min(i,g+m.nodeSize);c.push({node:m,from:y,to:N})});const d=i-s,u=c.filter(m=>l?l.name===m.node.type.name:!0).filter(m=>W1(m.node.attrs,r,{strict:!1}));return o?!!u.length:u.reduce((m,g)=>m+g.to-g.from,0)>=d}var uge=(t,n={})=>({state:r,dispatch:s})=>{const i=Ds(t,r.schema);return xE(r,i,n)?r$(r,s):!1},fge=()=>({state:t,dispatch:n})=>rE(t,n),hge=t=>({state:n,dispatch:r})=>{const s=Ds(t,n.schema);return f$(s)(n,r)},mge=()=>({state:t,dispatch:n})=>eE(t,n);function W$(t,n){return n.nodes[t]?"node":n.marks[t]?"mark":null}function pM(t,n){const r=typeof n=="string"?[n]:n;return Object.keys(t).reduce((s,i)=>(r.includes(i)||(s[i]=t[i]),s),{})}var pge=(t,n)=>({tr:r,state:s,dispatch:i})=>{let o=null,l=null;const c=W$(typeof t=="string"?t:t.name,s.schema);return c?(c==="node"&&(o=Ds(t,s.schema)),c==="mark"&&(l=Qc(t,s.schema)),i&&r.selection.ranges.forEach(d=>{s.doc.nodesBetween(d.$from.pos,d.$to.pos,(u,h)=>{o&&o===u.type&&r.setNodeMarkup(h,void 0,pM(u.attrs,n)),l&&u.marks.length&&u.marks.forEach(m=>{l===m.type&&r.addMark(h,h+u.nodeSize,l.create(pM(m.attrs,n)))})})}),!0):!1},xge=()=>({tr:t,dispatch:n})=>(n&&t.scrollIntoView(),!0),gge=()=>({tr:t,dispatch:n})=>{if(n){const r=new pa(t.doc);t.setSelection(r)}return!0},yge=()=>({state:t,dispatch:n})=>YA(t,n),vge=()=>({state:t,dispatch:n})=>ZA(t,n),bge=()=>({state:t,dispatch:n})=>a$(t,n),wge=()=>({state:t,dispatch:n})=>c$(t,n),Nge=()=>({state:t,dispatch:n})=>l$(t,n);function jge(t,n,r={},s={}){return Lp(t,n,{slice:!1,parseOptions:r,errorOnInvalidContent:s.errorOnInvalidContent})}var Sge=(t,{errorOnInvalidContent:n,emitUpdate:r=!0,parseOptions:s={}}={})=>({editor:i,tr:o,dispatch:l,commands:c})=>{const{doc:d}=o;if(s.preserveWhitespace!=="full"){const u=jge(t,i.schema,s,{errorOnInvalidContent:n??i.options.enableContentCheck});return l&&o.replaceWith(0,d.content.size,u).setMeta("preventUpdate",!r),!0}return l&&o.setMeta("preventUpdate",!r),c.insertContentAt({from:0,to:d.content.size},t,{parseOptions:s,errorOnInvalidContent:n??i.options.enableContentCheck})};function Cge(t,n){const r=Qc(n,t.schema),{from:s,to:i,empty:o}=t.selection,l=[];o?(t.storedMarks&&l.push(...t.storedMarks),l.push(...t.selection.$head.marks())):t.doc.nodesBetween(s,i,d=>{l.push(...d.marks)});const c=l.find(d=>d.type.name===r.name);return c?{...c.attrs}:{}}function _ge(t,n){const r=new qF(t);return n.forEach(s=>{s.steps.forEach(i=>{r.step(i)})}),r}function Age(t){for(let n=0;n<t.edgeCount;n+=1){const{type:r}=t.edge(n);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}function q$(t,n){for(let r=t.depth;r>0;r-=1){const s=t.node(r);if(n(s))return{pos:r>0?t.before(r):0,start:t.start(r),depth:r,node:s}}}function gE(t){return n=>q$(n.$from,t)}function Jf(t,n,r){return t.config[n]===void 0&&t.parent?Jf(t.parent,n,r):typeof t.config[n]=="function"?t.config[n].bind({...r,parent:t.parent?Jf(t.parent,n,r):null}):t.config[n]}function Ege(t){return typeof t=="function"}function du(t,n=void 0,...r){return Ege(t)?n?t.bind(n)(...r):t(...r):t}function kge(t){const n=t.filter(i=>i.type==="extension"),r=t.filter(i=>i.type==="node"),s=t.filter(i=>i.type==="mark");return{baseExtensions:n,nodeExtensions:r,markExtensions:s}}function Zc(...t){return t.filter(n=>!!n).reduce((n,r)=>{const s={...n};return Object.entries(r).forEach(([i,o])=>{if(!s[i]){s[i]=o;return}if(i==="class"){const c=o?String(o).split(" "):[],d=s[i]?s[i].split(" "):[],u=c.filter(h=>!d.includes(h));s[i]=[...d,...u].join(" ")}else if(i==="style"){const c=o?o.split(";").map(h=>h.trim()).filter(Boolean):[],d=s[i]?s[i].split(";").map(h=>h.trim()).filter(Boolean):[],u=new Map;d.forEach(h=>{const[m,g]=h.split(":").map(y=>y.trim());u.set(m,g)}),c.forEach(h=>{const[m,g]=h.split(":").map(y=>y.trim());u.set(m,g)}),s[i]=Array.from(u.entries()).map(([h,m])=>`${h}: ${m}`).join("; ")}else s[i]=o}),s},{})}function Tge(t,n,r){const{from:s,to:i}=n,{blockSeparator:o=`

`,textSerializers:l={}}=r||{};let c="";return t.nodesBetween(s,i,(d,u,h,m)=>{var g;d.isBlock&&u>s&&(c+=o);const y=l==null?void 0:l[d.type.name];if(y)return h&&(c+=y({node:d,pos:u,parent:h,index:m,range:n})),!1;d.isText&&(c+=(g=d==null?void 0:d.text)==null?void 0:g.slice(Math.max(s,u)-u,i-u))}),c}function Ige(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,n])=>n.spec.toText).map(([n,r])=>[n,r.spec.toText]))}function Pge(t,n=JSON.stringify){const r={};return t.filter(s=>{const i=n(s);return Object.prototype.hasOwnProperty.call(r,i)?!1:r[i]=!0})}function Mge(t){const n=Pge(t);return n.length===1?n:n.filter((r,s)=>!n.filter((o,l)=>l!==s).some(o=>r.oldRange.from>=o.oldRange.from&&r.oldRange.to<=o.oldRange.to&&r.newRange.from>=o.newRange.from&&r.newRange.to<=o.newRange.to))}function Oge(t){const{mapping:n,steps:r}=t,s=[];return n.maps.forEach((i,o)=>{const l=[];if(i.ranges.length)i.forEach((c,d)=>{l.push({from:c,to:d})});else{const{from:c,to:d}=r[o];if(c===void 0||d===void 0)return;l.push({from:c,to:d})}l.forEach(({from:c,to:d})=>{const u=n.slice(o).map(c,-1),h=n.slice(o).map(d),m=n.invert().map(u,-1),g=n.invert().map(h);s.push({oldRange:{from:m,to:g},newRange:{from:u,to:h}})})}),Mge(s)}function G$(t,n,r){const s=[];return t===n?r.resolve(t).marks().forEach(i=>{const o=r.resolve(t),l=mE(o,i.type);l&&s.push({mark:i,...l})}):r.nodesBetween(t,n,(i,o)=>{!i||(i==null?void 0:i.nodeSize)===void 0||s.push(...i.marks.map(l=>({from:o,to:o+i.nodeSize,mark:l})))}),s}function Ig(t,n,r){return Object.fromEntries(Object.entries(r).filter(([s])=>{const i=t.find(o=>o.type===n&&o.name===s);return i?i.attribute.keepOnSplit:!1}))}function Dge(t,n,r={}){const{empty:s,ranges:i}=t.selection,o=n?Qc(n,t.schema):null;if(s)return!!(t.storedMarks||t.selection.$from.marks()).filter(m=>o?o.name===m.type.name:!0).find(m=>W1(m.attrs,r,{strict:!1}));let l=0;const c=[];if(i.forEach(({$from:m,$to:g})=>{const y=m.pos,N=g.pos;t.doc.nodesBetween(y,N,(j,S)=>{if(!j.isText&&!j.marks.length)return;const _=Math.max(y,S),A=Math.min(N,S+j.nodeSize),k=A-_;l+=k,c.push(...j.marks.map(T=>({mark:T,from:_,to:A})))})}),l===0)return!1;const d=c.filter(m=>o?o.name===m.mark.type.name:!0).filter(m=>W1(m.mark.attrs,r,{strict:!1})).reduce((m,g)=>m+g.to-g.from,0),u=c.filter(m=>o?m.mark.type!==o&&m.mark.type.excludes(o):!0).reduce((m,g)=>m+g.to-g.from,0);return(d>0?d+u:d)>=l}function xM(t,n){const{nodeExtensions:r}=kge(n),s=r.find(l=>l.name===t);if(!s)return!1;const i={name:s.name,options:s.options,storage:s.storage},o=du(Jf(s,"group",i));return typeof o!="string"?!1:o.split(" ").includes("list")}function K$(t,{checkChildren:n=!0,ignoreWhitespace:r=!1}={}){var s;if(r){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((s=t.text)!=null?s:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(n){let i=!0;return t.content.forEach(o=>{i!==!1&&(K$(o,{ignoreWhitespace:r,checkChildren:n})||(i=!1))}),i}return!1}function Rge(t,n,r){var s;const{selection:i}=n;let o=null;if(U$(i)&&(o=i.$cursor),o){const c=(s=t.storedMarks)!=null?s:o.marks();return o.parent.type.allowsMarkType(r)&&(!!r.isInSet(c)||!c.some(u=>u.type.excludes(r)))}const{ranges:l}=i;return l.some(({$from:c,$to:d})=>{let u=c.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(r):!1;return t.doc.nodesBetween(c.pos,d.pos,(h,m,g)=>{if(u)return!1;if(h.isInline){const y=!g||g.type.allowsMarkType(r),N=!!r.isInSet(h.marks)||!h.marks.some(j=>j.type.excludes(r));u=y&&N}return!u}),u})}var Lge=(t,n={})=>({tr:r,state:s,dispatch:i})=>{const{selection:o}=r,{empty:l,ranges:c}=o,d=Qc(t,s.schema);if(i)if(l){const u=Cge(s,d);r.addStoredMark(d.create({...u,...n}))}else c.forEach(u=>{const h=u.$from.pos,m=u.$to.pos;s.doc.nodesBetween(h,m,(g,y)=>{const N=Math.max(y,h),j=Math.min(y+g.nodeSize,m);g.marks.find(_=>_.type===d)?g.marks.forEach(_=>{d===_.type&&r.addMark(N,j,d.create({..._.attrs,...n}))}):r.addMark(N,j,d.create(n))})});return Rge(s,r,d)},Bge=(t,n)=>({tr:r})=>(r.setMeta(t,n),!0),Fge=(t,n={})=>({state:r,dispatch:s,chain:i})=>{const o=Ds(t,r.schema);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),o.isTextblock?i().command(({commands:c})=>B1(o,{...l,...n})(r)?!0:c.clearNodes()).command(({state:c})=>B1(o,{...l,...n})(c,s)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},$ge=t=>({tr:n,dispatch:r})=>{if(r){const{doc:s}=n,i=Td(t,0,s.content.size),o=xt.create(s,i);n.setSelection(o)}return!0},zge=t=>({tr:n,dispatch:r})=>{if(r){const{doc:s}=n,{from:i,to:o}=typeof t=="number"?{from:t,to:t}:t,l=ut.atStart(s).from,c=ut.atEnd(s).to,d=Td(i,l,c),u=Td(o,l,c),h=ut.create(s,d,u);n.setSelection(h)}return!0},Uge=t=>({state:n,dispatch:r})=>{const s=Ds(t,n.schema);return h$(s)(n,r)};function gM(t,n){const r=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(r){const s=r.filter(i=>n==null?void 0:n.includes(i.type.name));t.tr.ensureMarks(s)}}var Vge=({keepMarks:t=!0}={})=>({tr:n,state:r,dispatch:s,editor:i})=>{const{selection:o,doc:l}=n,{$from:c,$to:d}=o,u=i.extensionManager.attributes,h=Ig(u,c.node().type.name,c.node().attrs);if(o instanceof xt&&o.node.isBlock)return!c.parentOffset||!Oa(l,c.pos)?!1:(s&&(t&&gM(r,i.extensionManager.splittableMarks),n.split(c.pos).scrollIntoView()),!0);if(!c.parent.isBlock)return!1;const m=d.parentOffset===d.parent.content.size,g=c.depth===0?void 0:Age(c.node(-1).contentMatchAt(c.indexAfter(-1)));let y=m&&g?[{type:g,attrs:h}]:void 0,N=Oa(n.doc,n.mapping.map(c.pos),1,y);if(!y&&!N&&Oa(n.doc,n.mapping.map(c.pos),1,g?[{type:g}]:void 0)&&(N=!0,y=g?[{type:g,attrs:h}]:void 0),s){if(N&&(o instanceof ut&&n.deleteSelection(),n.split(n.mapping.map(c.pos),1,y),g&&!m&&!c.parentOffset&&c.parent.type!==g)){const j=n.mapping.map(c.before()),S=n.doc.resolve(j);c.node(-1).canReplaceWith(S.index(),S.index()+1,g)&&n.setNodeMarkup(n.mapping.map(c.before()),g)}t&&gM(r,i.extensionManager.splittableMarks),n.scrollIntoView()}return N},Hge=(t,n={})=>({tr:r,state:s,dispatch:i,editor:o})=>{var l;const c=Ds(t,s.schema),{$from:d,$to:u}=s.selection,h=s.selection.node;if(h&&h.isBlock||d.depth<2||!d.sameParent(u))return!1;const m=d.node(-1);if(m.type!==c)return!1;const g=o.extensionManager.attributes;if(d.parent.content.size===0&&d.node(-1).childCount===d.indexAfter(-1)){if(d.depth===2||d.node(-3).type!==c||d.index(-2)!==d.node(-2).childCount-1)return!1;if(i){let _=Pe.empty;const A=d.index(-1)?1:d.index(-2)?2:3;for(let D=d.depth-A;D>=d.depth-3;D-=1)_=Pe.from(d.node(D).copy(_));const k=d.indexAfter(-1)<d.node(-2).childCount?1:d.indexAfter(-2)<d.node(-3).childCount?2:3,T={...Ig(g,d.node().type.name,d.node().attrs),...n},P=((l=c.contentMatch.defaultType)==null?void 0:l.createAndFill(T))||void 0;_=_.append(Pe.from(c.createAndFill(null,P)||void 0));const M=d.before(d.depth-(A-1));r.replace(M,d.after(-k),new Qe(_,4-A,0));let O=-1;r.doc.nodesBetween(M,r.doc.content.size,(D,L)=>{if(O>-1)return!1;D.isTextblock&&D.content.size===0&&(O=L+1)}),O>-1&&r.setSelection(ut.near(r.doc.resolve(O))),r.scrollIntoView()}return!0}const y=u.pos===d.end()?m.contentMatchAt(0).defaultType:null,N={...Ig(g,m.type.name,m.attrs),...n},j={...Ig(g,d.node().type.name,d.node().attrs),...n};r.delete(d.pos,u.pos);const S=y?[{type:c,attrs:N},{type:y,attrs:j}]:[{type:c,attrs:N}];if(!Oa(r.doc,d.pos,2))return!1;if(i){const{selection:_,storedMarks:A}=s,{splittableMarks:k}=o.extensionManager,T=A||_.$to.parentOffset&&_.$from.marks();if(r.split(d.pos,2,S).scrollIntoView(),!T||!i)return!0;const P=T.filter(M=>k.includes(M.type.name));r.ensureMarks(P)}return!0},FN=(t,n)=>{const r=gE(l=>l.type===n)(t.selection);if(!r)return!0;const s=t.doc.resolve(Math.max(0,r.pos-1)).before(r.depth);if(s===void 0)return!0;const i=t.doc.nodeAt(s);return r.node.type===(i==null?void 0:i.type)&&Lo(t.doc,r.pos)&&t.join(r.pos),!0},$N=(t,n)=>{const r=gE(l=>l.type===n)(t.selection);if(!r)return!0;const s=t.doc.resolve(r.start).after(r.depth);if(s===void 0)return!0;const i=t.doc.nodeAt(s);return r.node.type===(i==null?void 0:i.type)&&Lo(t.doc,s)&&t.join(s),!0},Wge=(t,n,r,s={})=>({editor:i,tr:o,state:l,dispatch:c,chain:d,commands:u,can:h})=>{const{extensions:m,splittableMarks:g}=i.extensionManager,y=Ds(t,l.schema),N=Ds(n,l.schema),{selection:j,storedMarks:S}=l,{$from:_,$to:A}=j,k=_.blockRange(A),T=S||j.$to.parentOffset&&j.$from.marks();if(!k)return!1;const P=gE(M=>xM(M.type.name,m))(j);if(k.depth>=1&&P&&k.depth-P.depth<=1){if(P.node.type===y)return u.liftListItem(N);if(xM(P.node.type.name,m)&&y.validContent(P.node.content)&&c)return d().command(()=>(o.setNodeMarkup(P.pos,y),!0)).command(()=>FN(o,y)).command(()=>$N(o,y)).run()}return!r||!T||!c?d().command(()=>h().wrapInList(y,s)?!0:u.clearNodes()).wrapInList(y,s).command(()=>FN(o,y)).command(()=>$N(o,y)).run():d().command(()=>{const M=h().wrapInList(y,s),O=T.filter(D=>g.includes(D.type.name));return o.ensureMarks(O),M?!0:u.clearNodes()}).wrapInList(y,s).command(()=>FN(o,y)).command(()=>$N(o,y)).run()},qge=(t,n={},r={})=>({state:s,commands:i})=>{const{extendEmptyMarkRange:o=!1}=r,l=Qc(t,s.schema);return Dge(s,l,n)?i.unsetMark(l,{extendEmptyMarkRange:o}):i.setMark(l,n)},Gge=(t,n,r={})=>({state:s,commands:i})=>{const o=Ds(t,s.schema),l=Ds(n,s.schema),c=xE(s,o,r);let d;return s.selection.$anchor.sameParent(s.selection.$head)&&(d=s.selection.$anchor.parent.attrs),c?i.setNode(l,d):i.setNode(o,{...d,...r})},Kge=(t,n={})=>({state:r,commands:s})=>{const i=Ds(t,r.schema);return xE(r,i,n)?s.lift(i):s.wrapIn(i,n)},Yge=()=>({state:t,dispatch:n})=>{const r=t.plugins;for(let s=0;s<r.length;s+=1){const i=r[s];let o;if(i.spec.isInputRules&&(o=i.getState(t))){if(n){const l=t.tr,c=o.transform;for(let d=c.steps.length-1;d>=0;d-=1)l.step(c.steps[d].invert(c.docs[d]));if(o.text){const d=l.doc.resolve(o.from).marks();l.replaceWith(o.from,o.to,t.schema.text(o.text,d))}else l.delete(o.from,o.to)}return!0}}return!1},Xge=()=>({tr:t,dispatch:n})=>{const{selection:r}=t,{empty:s,ranges:i}=r;return s||n&&i.forEach(o=>{t.removeMark(o.$from.pos,o.$to.pos)}),!0},Qge=(t,n={})=>({tr:r,state:s,dispatch:i})=>{var o;const{extendEmptyMarkRange:l=!1}=n,{selection:c}=r,d=Qc(t,s.schema),{$from:u,empty:h,ranges:m}=c;if(!i)return!0;if(h&&l){let{from:g,to:y}=c;const N=(o=u.marks().find(S=>S.type===d))==null?void 0:o.attrs,j=mE(u,d,N);j&&(g=j.from,y=j.to),r.removeMark(g,y,d)}else m.forEach(g=>{r.removeMark(g.$from.pos,g.$to.pos,d)});return r.removeStoredMark(d),!0},Zge=(t,n={})=>({tr:r,state:s,dispatch:i})=>{let o=null,l=null;const c=W$(typeof t=="string"?t:t.name,s.schema);return c?(c==="node"&&(o=Ds(t,s.schema)),c==="mark"&&(l=Qc(t,s.schema)),i&&r.selection.ranges.forEach(d=>{const u=d.$from.pos,h=d.$to.pos;let m,g,y,N;r.selection.empty?s.doc.nodesBetween(u,h,(j,S)=>{o&&o===j.type&&(y=Math.max(S,u),N=Math.min(S+j.nodeSize,h),m=S,g=j)}):s.doc.nodesBetween(u,h,(j,S)=>{S<u&&o&&o===j.type&&(y=Math.max(S,u),N=Math.min(S+j.nodeSize,h),m=S,g=j),S>=u&&S<=h&&(o&&o===j.type&&r.setNodeMarkup(S,void 0,{...j.attrs,...n}),l&&j.marks.length&&j.marks.forEach(_=>{if(l===_.type){const A=Math.max(S,u),k=Math.min(S+j.nodeSize,h);r.addMark(A,k,l.create({..._.attrs,...n}))}}))}),g&&(m!==void 0&&r.setNodeMarkup(m,void 0,{...g.attrs,...n}),l&&g.marks.length&&g.marks.forEach(j=>{l===j.type&&r.addMark(y,N,l.create({...j.attrs,...n}))}))}),!0):!1},Jge=(t,n={})=>({state:r,dispatch:s})=>{const i=Ds(t,r.schema);return d$(i,n)(r,s)},e1e=(t,n={})=>({state:r,dispatch:s})=>{const i=Ds(t,r.schema);return u$(i,n)(r,s)},Y$=class{constructor(n){var r;this.find=n.find,this.handler=n.handler,this.undoable=(r=n.undoable)!=null?r:!0}};function t1e(t){return Object.prototype.toString.call(t).slice(8,-1)}function M0(t){return t1e(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function X$(t,n){const r={...t};return M0(t)&&M0(n)&&Object.keys(n).forEach(s=>{M0(n[s])&&M0(t[s])?r[s]=X$(t[s],n[s]):r[s]=n[s]}),r}var yE=class{constructor(t={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...t},this.name=this.config.name}get options(){return{...du(Jf(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...du(Jf(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(t={}){const n=this.extend({...this.config,addOptions:()=>X$(this.options,t)});return n.name=this.name,n.parent=this.parent,n}extend(t={}){const n=new this.constructor({...this.config,...t});return n.parent=this,this.child=n,n.name="name"in t?t.name:n.parent.name,n}},vE=class Q$ extends yE{constructor(){super(...arguments),this.type="mark"}static create(n={}){const r=typeof n=="function"?n():n;return new Q$(r)}static handleExit({editor:n,mark:r}){const{tr:s}=n.state,i=n.state.selection.$from;if(i.pos===i.end()){const l=i.marks();if(!!!l.find(u=>(u==null?void 0:u.type.name)===r.name))return!1;const d=l.find(u=>(u==null?void 0:u.type.name)===r.name);return d&&s.removeStoredMark(d),s.insertText(" ",i.pos),n.view.dispatch(s),!0}return!1}configure(n){return super.configure(n)}extend(n){const r=typeof n=="function"?n():n;return super.extend(r)}},n1e=class{constructor(n){this.find=n.find,this.handler=n.handler}},r1e={};hE(r1e,{ClipboardTextSerializer:()=>s1e,Commands:()=>a1e,Delete:()=>i1e,Drop:()=>o1e,Editable:()=>l1e,FocusEvents:()=>c1e,Keymap:()=>d1e,Paste:()=>u1e,Tabindex:()=>f1e,focusEventsPluginKey:()=>J$});var bs=class Z$ extends yE{constructor(){super(...arguments),this.type="extension"}static create(n={}){const r=typeof n=="function"?n():n;return new Z$(r)}configure(n){return super.configure(n)}extend(n){const r=typeof n=="function"?n():n;return super.extend(r)}},s1e=bs.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Ar({key:new Er("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:n,schema:r}=t,{doc:s,selection:i}=n,{ranges:o}=i,l=Math.min(...o.map(h=>h.$from.pos)),c=Math.max(...o.map(h=>h.$to.pos)),d=Ige(r);return Tge(s,{from:l,to:c},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:d})}}})]}}),a1e=bs.create({name:"commands",addCommands(){return{...$$}}}),i1e=bs.create({name:"delete",onUpdate({transaction:t,appendedTransactions:n}){var r,s,i;const o=()=>{var l,c,d,u;if((u=(d=(c=(l=this.editor.options.coreExtensionOptions)==null?void 0:l.delete)==null?void 0:c.filterTransaction)==null?void 0:d.call(c,t))!=null?u:t.getMeta("y-sync$"))return;const h=_ge(t.before,[t,...n]);Oge(h).forEach(y=>{h.mapping.mapResult(y.oldRange.from).deletedAfter&&h.mapping.mapResult(y.oldRange.to).deletedBefore&&h.before.nodesBetween(y.oldRange.from,y.oldRange.to,(N,j)=>{const S=j+N.nodeSize-2,_=y.oldRange.from<=j&&S<=y.oldRange.to;this.editor.emit("delete",{type:"node",node:N,from:j,to:S,newFrom:h.mapping.map(j),newTo:h.mapping.map(S),deletedRange:y.oldRange,newRange:y.newRange,partial:!_,editor:this.editor,transaction:t,combinedTransform:h})})});const g=h.mapping;h.steps.forEach((y,N)=>{var j,S;if(y instanceof Di){const _=g.slice(N).map(y.from,-1),A=g.slice(N).map(y.to),k=g.invert().map(_,-1),T=g.invert().map(A),P=(j=h.doc.nodeAt(_-1))==null?void 0:j.marks.some(O=>O.eq(y.mark)),M=(S=h.doc.nodeAt(A))==null?void 0:S.marks.some(O=>O.eq(y.mark));this.editor.emit("delete",{type:"mark",mark:y.mark,from:y.from,to:y.to,deletedRange:{from:k,to:T},newRange:{from:_,to:A},partial:!!(M||P),editor:this.editor,transaction:t,combinedTransform:h})}})};(i=(s=(r=this.editor.options.coreExtensionOptions)==null?void 0:r.delete)==null?void 0:s.async)==null||i?setTimeout(o,0):o()}}),o1e=bs.create({name:"drop",addProseMirrorPlugins(){return[new Ar({key:new Er("tiptapDrop"),props:{handleDrop:(t,n,r,s)=>{this.editor.emit("drop",{editor:this.editor,event:n,slice:r,moved:s})}}})]}}),l1e=bs.create({name:"editable",addProseMirrorPlugins(){return[new Ar({key:new Er("editable"),props:{editable:()=>this.editor.options.editable}})]}}),J$=new Er("focusEvents"),c1e=bs.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new Ar({key:J$,props:{handleDOMEvents:{focus:(n,r)=>{t.isFocused=!0;const s=t.state.tr.setMeta("focus",{event:r}).setMeta("addToHistory",!1);return n.dispatch(s),!1},blur:(n,r)=>{t.isFocused=!1;const s=t.state.tr.setMeta("blur",{event:r}).setMeta("addToHistory",!1);return n.dispatch(s),!1}}}})]}}),d1e=bs.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:l})=>[()=>l.undoInputRule(),()=>l.command(({tr:c})=>{const{selection:d,doc:u}=c,{empty:h,$anchor:m}=d,{pos:g,parent:y}=m,N=m.parent.isTextblock&&g>0?c.doc.resolve(g-1):m,j=N.parent.type.spec.isolating,S=m.pos-m.parentOffset,_=j&&N.parent.childCount===1?S===m.pos:bt.atStart(u).from===g;return!h||!y.type.isTextblock||y.textContent.length||!_||_&&m.parent.type.name==="paragraph"?!1:l.clearNodes()}),()=>l.deleteSelection(),()=>l.joinBackward(),()=>l.selectNodeBackward()]),n=()=>this.editor.commands.first(({commands:l})=>[()=>l.deleteSelection(),()=>l.deleteCurrentNode(),()=>l.joinForward(),()=>l.selectNodeForward()]),s={Enter:()=>this.editor.commands.first(({commands:l})=>[()=>l.newlineInCode(),()=>l.createParagraphNear(),()=>l.liftEmptyBlock(),()=>l.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:n,"Mod-Delete":n,"Mod-a":()=>this.editor.commands.selectAll()},i={...s},o={...s,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":n,"Ctrl-Alt-Backspace":n,"Alt-Delete":n,"Alt-d":n,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return pE()||H$()?o:i},addProseMirrorPlugins(){return[new Ar({key:new Er("clearDocument"),appendTransaction:(t,n,r)=>{if(t.some(j=>j.getMeta("composition")))return;const s=t.some(j=>j.docChanged)&&!n.doc.eq(r.doc),i=t.some(j=>j.getMeta("preventClearDocument"));if(!s||i)return;const{empty:o,from:l,to:c}=n.selection,d=bt.atStart(n.doc).from,u=bt.atEnd(n.doc).to;if(o||!(l===d&&c===u)||!K$(r.doc))return;const g=r.tr,y=F$({state:r,transaction:g}),{commands:N}=new I0e({editor:this.editor,state:y});if(N.clearNodes(),!!g.steps.length)return g}})]}}),u1e=bs.create({name:"paste",addProseMirrorPlugins(){return[new Ar({key:new Er("tiptapPaste"),props:{handlePaste:(t,n,r)=>{this.editor.emit("paste",{editor:this.editor,event:n,slice:r})}}})]}}),f1e=bs.create({name:"tabindex",addProseMirrorPlugins(){return[new Ar({key:new Er("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});function h1e(t){return new Y$({find:t.find,handler:({state:n,range:r,match:s})=>{const i=du(t.getAttributes,void 0,s);if(i===!1||i===null)return null;const{tr:o}=n,l=s[s.length-1],c=s[0];if(l){const d=c.search(/\S/),u=r.from+c.indexOf(l),h=u+l.length;if(G$(r.from,r.to,n.doc).filter(y=>y.mark.type.excluded.find(j=>j===t.type&&j!==y.mark.type)).filter(y=>y.to>u).length)return null;h<r.to&&o.delete(h,r.to),u>r.from&&o.delete(r.from+d,u);const g=r.from+d+l.length;o.addMark(r.from+d,g,t.type.create(i||{})),o.removeStoredMark(t.type)}},undoable:t.undoable})}function m1e(t){return new Y$({find:t.find,handler:({state:n,range:r,match:s})=>{const i=du(t.getAttributes,void 0,s)||{},{tr:o}=n,l=r.from;let c=r.to;const d=t.type.create(i);if(s[1]){const u=s[0].lastIndexOf(s[1]);let h=l+u;h>c?h=c:c=h+s[1].length;const m=s[0][s[0].length-1];o.insertText(m,l+s[0].length-1),o.replaceWith(h,c,d)}else if(s[0]){const u=t.type.isInline?l:l-1;o.insert(u,t.type.create(i)).delete(o.mapping.map(l),o.mapping.map(c))}o.scrollIntoView()},undoable:t.undoable})}var p1e=t=>"touches"in t,x1e=class{constructor(t){this.directions=["bottom-left","bottom-right","top-left","top-right"],this.minSize={height:8,width:8},this.preserveAspectRatio=!1,this.classNames={container:"",wrapper:"",handle:"",resizing:""},this.initialWidth=0,this.initialHeight=0,this.aspectRatio=1,this.isResizing=!1,this.activeHandle=null,this.startX=0,this.startY=0,this.startWidth=0,this.startHeight=0,this.isShiftKeyPressed=!1,this.handleMouseMove=l=>{if(!this.isResizing||!this.activeHandle)return;const c=l.clientX-this.startX,d=l.clientY-this.startY;this.handleResize(c,d)},this.handleTouchMove=l=>{if(!this.isResizing||!this.activeHandle)return;const c=l.touches[0];if(!c)return;const d=c.clientX-this.startX,u=c.clientY-this.startY;this.handleResize(d,u)},this.handleMouseUp=()=>{if(!this.isResizing)return;const l=this.element.offsetWidth,c=this.element.offsetHeight;this.onCommit(l,c),this.isResizing=!1,this.activeHandle=null,this.container.dataset.resizeState="false",this.classNames.resizing&&this.container.classList.remove(this.classNames.resizing),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp)},this.handleKeyDown=l=>{l.key==="Shift"&&(this.isShiftKeyPressed=!0)},this.handleKeyUp=l=>{l.key==="Shift"&&(this.isShiftKeyPressed=!1)};var n,r,s,i,o;this.node=t.node,this.element=t.element,this.contentElement=t.contentElement,this.getPos=t.getPos,this.onResize=t.onResize,this.onCommit=t.onCommit,this.onUpdate=t.onUpdate,(n=t.options)!=null&&n.min&&(this.minSize={...this.minSize,...t.options.min}),(r=t.options)!=null&&r.max&&(this.maxSize=t.options.max),(s=t==null?void 0:t.options)!=null&&s.directions&&(this.directions=t.options.directions),(i=t.options)!=null&&i.preserveAspectRatio&&(this.preserveAspectRatio=t.options.preserveAspectRatio),(o=t.options)!=null&&o.className&&(this.classNames={container:t.options.className.container||"",wrapper:t.options.className.wrapper||"",handle:t.options.className.handle||"",resizing:t.options.className.resizing||""}),this.wrapper=this.createWrapper(),this.container=this.createContainer(),this.applyInitialSize(),this.attachHandles()}get dom(){return this.container}get contentDOM(){return this.contentElement}update(t,n,r){return t.type!==this.node.type?!1:(this.node=t,this.onUpdate?this.onUpdate(t,n,r):!0)}destroy(){this.isResizing&&(this.container.dataset.resizeState="false",this.classNames.resizing&&this.container.classList.remove(this.classNames.resizing),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp),this.isResizing=!1,this.activeHandle=null),this.container.remove()}createContainer(){const t=document.createElement("div");return t.dataset.resizeContainer="",t.dataset.node=this.node.type.name,t.style.display="flex",t.style.justifyContent="flex-start",t.style.alignItems="flex-start",this.classNames.container&&(t.className=this.classNames.container),t.appendChild(this.wrapper),t}createWrapper(){const t=document.createElement("div");return t.style.position="relative",t.style.display="block",t.dataset.resizeWrapper="",this.classNames.wrapper&&(t.className=this.classNames.wrapper),t.appendChild(this.element),t}createHandle(t){const n=document.createElement("div");return n.dataset.resizeHandle=t,n.style.position="absolute",this.classNames.handle&&(n.className=this.classNames.handle),n}positionHandle(t,n){const r=n.includes("top"),s=n.includes("bottom"),i=n.includes("left"),o=n.includes("right");r&&(t.style.top="0"),s&&(t.style.bottom="0"),i&&(t.style.left="0"),o&&(t.style.right="0"),(n==="top"||n==="bottom")&&(t.style.left="0",t.style.right="0"),(n==="left"||n==="right")&&(t.style.top="0",t.style.bottom="0")}attachHandles(){this.directions.forEach(t=>{const n=this.createHandle(t);this.positionHandle(n,t),n.addEventListener("mousedown",r=>this.handleResizeStart(r,t)),n.addEventListener("touchstart",r=>this.handleResizeStart(r,t)),this.wrapper.appendChild(n)})}applyInitialSize(){const t=this.node.attrs.width,n=this.node.attrs.height;t?(this.element.style.width=`${t}px`,this.initialWidth=t):this.initialWidth=this.element.offsetWidth,n?(this.element.style.height=`${n}px`,this.initialHeight=n):this.initialHeight=this.element.offsetHeight,this.initialWidth>0&&this.initialHeight>0&&(this.aspectRatio=this.initialWidth/this.initialHeight)}handleResizeStart(t,n){t.preventDefault(),t.stopPropagation(),this.isResizing=!0,this.activeHandle=n,p1e(t)?(this.startX=t.touches[0].clientX,this.startY=t.touches[0].clientY):(this.startX=t.clientX,this.startY=t.clientY),this.startWidth=this.element.offsetWidth,this.startHeight=this.element.offsetHeight,this.startWidth>0&&this.startHeight>0&&(this.aspectRatio=this.startWidth/this.startHeight),this.getPos(),this.container.dataset.resizeState="true",this.classNames.resizing&&this.container.classList.add(this.classNames.resizing),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("touchmove",this.handleTouchMove),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}handleResize(t,n){if(!this.activeHandle)return;const r=this.preserveAspectRatio||this.isShiftKeyPressed,{width:s,height:i}=this.calculateNewDimensions(this.activeHandle,t,n),o=this.applyConstraints(s,i,r);this.element.style.width=`${o.width}px`,this.element.style.height=`${o.height}px`,this.onResize&&this.onResize(o.width,o.height)}calculateNewDimensions(t,n,r){let s=this.startWidth,i=this.startHeight;const o=t.includes("right"),l=t.includes("left"),c=t.includes("bottom"),d=t.includes("top");return o?s=this.startWidth+n:l&&(s=this.startWidth-n),c?i=this.startHeight+r:d&&(i=this.startHeight-r),(t==="right"||t==="left")&&(s=this.startWidth+(o?n:-n)),(t==="top"||t==="bottom")&&(i=this.startHeight+(c?r:-r)),this.preserveAspectRatio||this.isShiftKeyPressed?this.applyAspectRatio(s,i,t):{width:s,height:i}}applyConstraints(t,n,r){var s,i,o,l;if(!r){let u=Math.max(this.minSize.width,t),h=Math.max(this.minSize.height,n);return(s=this.maxSize)!=null&&s.width&&(u=Math.min(this.maxSize.width,u)),(i=this.maxSize)!=null&&i.height&&(h=Math.min(this.maxSize.height,h)),{width:u,height:h}}let c=t,d=n;return c<this.minSize.width&&(c=this.minSize.width,d=c/this.aspectRatio),d<this.minSize.height&&(d=this.minSize.height,c=d*this.aspectRatio),(o=this.maxSize)!=null&&o.width&&c>this.maxSize.width&&(c=this.maxSize.width,d=c/this.aspectRatio),(l=this.maxSize)!=null&&l.height&&d>this.maxSize.height&&(d=this.maxSize.height,c=d*this.aspectRatio),{width:c,height:d}}applyAspectRatio(t,n,r){const s=r==="left"||r==="right",i=r==="top"||r==="bottom";return s?{width:t,height:t/this.aspectRatio}:i?{width:n*this.aspectRatio,height:n}:{width:t,height:t/this.aspectRatio}}},g1e={};hE(g1e,{createAtomBlockMarkdownSpec:()=>y1e,createBlockMarkdownSpec:()=>v1e,createInlineMarkdownSpec:()=>N1e,parseAttributes:()=>bE,parseIndentedBlocks:()=>j1e,renderNestedMarkdownContent:()=>S1e,serializeAttributes:()=>wE});function bE(t){if(!(t!=null&&t.trim()))return{};const n={},r=[],s=t.replace(/["']([^"']*)["']/g,u=>(r.push(u),`__QUOTED_${r.length-1}__`)),i=s.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(i){const u=i.map(h=>h.trim().slice(1));n.class=u.join(" ")}const o=s.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);o&&(n.id=o[1]);const l=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(s.matchAll(l)).forEach(([,u,h])=>{var m;const g=parseInt(((m=h.match(/__QUOTED_(\d+)__/))==null?void 0:m[1])||"0",10),y=r[g];y&&(n[u]=y.slice(1,-1))});const d=s.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return d&&d.split(/\s+/).filter(Boolean).forEach(h=>{h.match(/^[a-zA-Z][\w-]*$/)&&(n[h]=!0)}),n}function wE(t){if(!t||Object.keys(t).length===0)return"";const n=[];return t.class&&String(t.class).split(/\s+/).filter(Boolean).forEach(s=>n.push(`.${s}`)),t.id&&n.push(`#${t.id}`),Object.entries(t).forEach(([r,s])=>{r==="class"||r==="id"||(s===!0?n.push(r):s!==!1&&s!=null&&n.push(`${r}="${String(s)}"`))}),n.join(" ")}function y1e(t){const{nodeName:n,name:r,parseAttributes:s=bE,serializeAttributes:i=wE,defaultAttributes:o={},requiredAttributes:l=[],allowedAttributes:c}=t,d=r||n,u=h=>{if(!c)return h;const m={};return c.forEach(g=>{g in h&&(m[g]=h[g])}),m};return{parseMarkdown:(h,m)=>{const g={...o,...h.attributes};return m.createNode(n,g,[])},markdownTokenizer:{name:n,level:"block",start(h){var m;const g=new RegExp(`^:::${d}(?:\\s|$)`,"m"),y=(m=h.match(g))==null?void 0:m.index;return y!==void 0?y:-1},tokenize(h,m,g){const y=new RegExp(`^:::${d}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),N=h.match(y);if(!N)return;const j=N[1]||"",S=s(j);if(!l.find(A=>!(A in S)))return{type:n,raw:N[0],attributes:S}}},renderMarkdown:h=>{const m=u(h.attrs||{}),g=i(m),y=g?` {${g}}`:"";return`:::${d}${y} :::`}}}function v1e(t){const{nodeName:n,name:r,getContent:s,parseAttributes:i=bE,serializeAttributes:o=wE,defaultAttributes:l={},content:c="block",allowedAttributes:d}=t,u=r||n,h=m=>{if(!d)return m;const g={};return d.forEach(y=>{y in m&&(g[y]=m[y])}),g};return{parseMarkdown:(m,g)=>{let y;if(s){const j=s(m);y=typeof j=="string"?[{type:"text",text:j}]:j}else c==="block"?y=g.parseChildren(m.tokens||[]):y=g.parseInline(m.tokens||[]);const N={...l,...m.attributes};return g.createNode(n,N,y)},markdownTokenizer:{name:n,level:"block",start(m){var g;const y=new RegExp(`^:::${u}`,"m"),N=(g=m.match(y))==null?void 0:g.index;return N!==void 0?N:-1},tokenize(m,g,y){var N;const j=new RegExp(`^:::${u}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),S=m.match(j);if(!S)return;const[_,A=""]=S,k=i(A);let T=1;const P=_.length;let M="";const O=/^:::([\w-]*)(\s.*)?/gm,D=m.slice(P);for(O.lastIndex=0;;){const L=O.exec(D);if(L===null)break;const $=L.index,V=L[1];if(!((N=L[2])!=null&&N.endsWith(":::"))){if(V)T+=1;else if(T-=1,T===0){const F=D.slice(0,$);M=F.trim();const Q=m.slice(0,P+$+L[0].length);let U=[];if(M)if(c==="block")for(U=y.blockTokens(F),U.forEach(z=>{z.text&&(!z.tokens||z.tokens.length===0)&&(z.tokens=y.inlineTokens(z.text))});U.length>0;){const z=U[U.length-1];if(z.type==="paragraph"&&(!z.text||z.text.trim()===""))U.pop();else break}else U=y.inlineTokens(M);return{type:n,raw:Q,attributes:k,content:M,tokens:U}}}}}},renderMarkdown:(m,g)=>{const y=h(m.attrs||{}),N=o(y),j=N?` {${N}}`:"",S=g.renderChildren(m.content||[],`

`);return`:::${u}${j}

${S}

:::`}}}function b1e(t){if(!t.trim())return{};const n={},r=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let s=r.exec(t);for(;s!==null;){const[,i,o,l]=s;n[i]=o||l,s=r.exec(t)}return n}function w1e(t){return Object.entries(t).filter(([,n])=>n!=null).map(([n,r])=>`${n}="${r}"`).join(" ")}function N1e(t){const{nodeName:n,name:r,getContent:s,parseAttributes:i=b1e,serializeAttributes:o=w1e,defaultAttributes:l={},selfClosing:c=!1,allowedAttributes:d}=t,u=r||n,h=g=>{if(!d)return g;const y={};return d.forEach(N=>{N in g&&(y[N]=g[N])}),y},m=u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(g,y)=>{const N={...l,...g.attributes};if(c)return y.createNode(n,N);const j=s?s(g):g.content||"";return j?y.createNode(n,N,[y.createTextNode(j)]):y.createNode(n,N,[])},markdownTokenizer:{name:n,level:"inline",start(g){const y=c?new RegExp(`\\[${m}\\s*[^\\]]*\\]`):new RegExp(`\\[${m}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${m}\\]`),N=g.match(y),j=N==null?void 0:N.index;return j!==void 0?j:-1},tokenize(g,y,N){const j=c?new RegExp(`^\\[${m}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${m}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${m}\\]`),S=g.match(j);if(!S)return;let _="",A="";if(c){const[,T]=S;A=T}else{const[,T,P]=S;A=T,_=P||""}const k=i(A.trim());return{type:n,raw:S[0],content:_.trim(),attributes:k}}},renderMarkdown:g=>{let y="";s?y=s(g):g.content&&g.content.length>0&&(y=g.content.filter(_=>_.type==="text").map(_=>_.text).join(""));const N=h(g.attrs||{}),j=o(N),S=j?` ${j}`:"";return c?`[${u}${S}]`:`[${u}${S}]${y}[/${u}]`}}}function j1e(t,n,r){var s,i,o,l;const c=t.split(`
`),d=[];let u="",h=0;const m=n.baseIndentSize||2;for(;h<c.length;){const g=c[h],y=g.match(n.itemPattern);if(!y){if(d.length>0)break;if(g.trim()===""){h+=1;continue}else return}const N=n.extractItemData(y),{indentLevel:j,mainContent:S}=N;u=`${u}${g}
`;const _=[S];for(h+=1;h<c.length;){const P=c[h];if(P.trim()===""){const O=c.slice(h+1).findIndex($=>$.trim()!=="");if(O===-1)break;if((((i=(s=c[h+1+O].match(/^(\s*)/))==null?void 0:s[1])==null?void 0:i.length)||0)>j){_.push(P),u=`${u}${P}
`,h+=1;continue}else break}if((((l=(o=P.match(/^(\s*)/))==null?void 0:o[1])==null?void 0:l.length)||0)>j)_.push(P),u=`${u}${P}
`,h+=1;else break}let A;const k=_.slice(1);if(k.length>0){const P=k.map(M=>M.slice(j+m)).join(`
`);P.trim()&&(n.customNestedParser?A=n.customNestedParser(P):A=r.blockTokens(P))}const T=n.createToken(N,A);d.push(T)}if(d.length!==0)return{items:d,raw:u.trim()}}function S1e(t,n,r,s){if(!t||!Array.isArray(t.content))return"";const i=typeof r=="function"?r(s):r,[o,...l]=t.content,c=n.renderChildren([o]),d=[`${i}${c}`];return l&&l.length>0&&l.forEach(u=>{const h=n.renderChildren([u]);if(h){const m=h.split(`
`).map(g=>g?n.indent(g):"").join(`
`);d.push(m)}}),d.join(`
`)}var wx=class ez extends yE{constructor(){super(...arguments),this.type="node"}static create(n={}){const r=typeof n=="function"?n():n;return new ez(r)}configure(n){return super.configure(n)}extend(n){const r=typeof n=="function"?n():n;return super.extend(r)}};function C1e(t){return new n1e({find:t.find,handler:({state:n,range:r,match:s,pasteEvent:i})=>{const o=du(t.getAttributes,void 0,s,i);if(o===!1||o===null)return null;const{tr:l}=n,c=s[s.length-1],d=s[0];let u=r.to;if(c){const h=d.search(/\S/),m=r.from+d.indexOf(c),g=m+c.length;if(G$(r.from,r.to,n.doc).filter(N=>N.mark.type.excluded.find(S=>S===t.type&&S!==N.mark.type)).filter(N=>N.to>m).length)return null;g<r.to&&l.delete(g,r.to),m>r.from&&l.delete(r.from+h,m),u=r.from+h+c.length,l.addMark(r.from+h,u,t.type.create(o||{})),l.removeStoredMark(t.type)}}})}function tz(t){const{state:n,transaction:r}=t;let{selection:s}=r,{doc:i}=r,{storedMarks:o}=r;return{...n,apply:n.apply.bind(n),applyTransaction:n.applyTransaction.bind(n),plugins:n.plugins,schema:n.schema,reconfigure:n.reconfigure.bind(n),toJSON:n.toJSON.bind(n),get storedMarks(){return o},get selection(){return s},get doc(){return i},get tr(){return s=r.selection,i=r.doc,o=r.storedMarks,r}}}class _1e{constructor(n){this.editor=n.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=n.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:n,editor:r,state:s}=this,{view:i}=r,{tr:o}=s,l=this.buildProps(o);return Object.fromEntries(Object.entries(n).map(([c,d])=>[c,(...h)=>{const m=d(...h)(l);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(o),m}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(n,r=!0){const{rawCommands:s,editor:i,state:o}=this,{view:l}=i,c=[],d=!!n,u=n||o.tr,h=()=>(!d&&r&&!u.getMeta("preventDispatch")&&!this.hasCustomState&&l.dispatch(u),c.every(g=>g===!0)),m={...Object.fromEntries(Object.entries(s).map(([g,y])=>[g,(...j)=>{const S=this.buildProps(u,r),_=y(...j)(S);return c.push(_),m}])),run:h};return m}createCan(n){const{rawCommands:r,state:s}=this,i=!1,o=n||s.tr,l=this.buildProps(o,i);return{...Object.fromEntries(Object.entries(r).map(([d,u])=>[d,(...h)=>u(...h)({...l,dispatch:void 0})])),chain:()=>this.createChain(o,i)}}buildProps(n,r=!0){const{rawCommands:s,editor:i,state:o}=this,{view:l}=i,c={tr:n,editor:i,view:l,state:tz({state:o,transaction:n}),dispatch:r?()=>{}:void 0,chain:()=>this.createChain(n,r),can:()=>this.createCan(n),get commands(){return Object.fromEntries(Object.entries(s).map(([d,u])=>[d,(...h)=>u(...h)(c)]))}};return c}}function Ts(t,n,r){return t.config[n]===void 0&&t.parent?Ts(t.parent,n,r):typeof t.config[n]=="function"?t.config[n].bind({...r,parent:t.parent?Ts(t.parent,n,r):null}):t.config[n]}function A1e(t){const n=t.filter(i=>i.type==="extension"),r=t.filter(i=>i.type==="node"),s=t.filter(i=>i.type==="mark");return{baseExtensions:n,nodeExtensions:r,markExtensions:s}}function Rs(t,n){if(typeof t=="string"){if(!n.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return n.nodes[t]}return t}function xa(...t){return t.filter(n=>!!n).reduce((n,r)=>{const s={...n};return Object.entries(r).forEach(([i,o])=>{if(!s[i]){s[i]=o;return}if(i==="class"){const c=o?String(o).split(" "):[],d=s[i]?s[i].split(" "):[],u=c.filter(h=>!d.includes(h));s[i]=[...d,...u].join(" ")}else if(i==="style"){const c=o?o.split(";").map(h=>h.trim()).filter(Boolean):[],d=s[i]?s[i].split(";").map(h=>h.trim()).filter(Boolean):[],u=new Map;d.forEach(h=>{const[m,g]=h.split(":").map(y=>y.trim());u.set(m,g)}),c.forEach(h=>{const[m,g]=h.split(":").map(y=>y.trim());u.set(m,g)}),s[i]=Array.from(u.entries()).map(([h,m])=>`${h}: ${m}`).join("; ")}else s[i]=o}),s},{})}function E1e(t){return typeof t=="function"}function zr(t,n=void 0,...r){return E1e(t)?n?t.bind(n)(...r):t(...r):t}function k1e(t){return Object.prototype.toString.call(t)==="[object RegExp]"}class Hv{constructor(n){this.find=n.find,this.handler=n.handler}}function T1e(t){return Object.prototype.toString.call(t).slice(8,-1)}function O0(t){return T1e(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function Wv(t,n){const r={...t};return O0(t)&&O0(n)&&Object.keys(n).forEach(s=>{O0(n[s])&&O0(t[s])?r[s]=Wv(t[s],n[s]):r[s]=n[s]}),r}class uu{constructor(n={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...n},this.name=this.config.name,n.defaultOptions&&Object.keys(n.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=zr(Ts(this,"addOptions",{name:this.name}))),this.storage=zr(Ts(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(n={}){return new uu(n)}configure(n={}){const r=this.extend({...this.config,addOptions:()=>Wv(this.options,n)});return r.name=this.name,r.parent=this.parent,r}extend(n={}){const r=new uu(n);return r.parent=this,this.child=r,r.name=n.name?n.name:r.parent.name,n.defaultOptions&&Object.keys(n.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${r.name}".`),r.options=zr(Ts(r,"addOptions",{name:r.name})),r.storage=zr(Ts(r,"addStorage",{name:r.name,options:r.options})),r}static handleExit({editor:n,mark:r}){const{tr:s}=n.state,i=n.state.selection.$from;if(i.pos===i.end()){const l=i.marks();if(!!!l.find(u=>(u==null?void 0:u.type.name)===r.name))return!1;const d=l.find(u=>(u==null?void 0:u.type.name)===r.name);return d&&s.removeStoredMark(d),s.insertText(" ",i.pos),n.view.dispatch(s),!0}return!1}}class I1e{constructor(n){this.find=n.find,this.handler=n.handler}}class qs{constructor(n={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...n},this.name=this.config.name,n.defaultOptions&&Object.keys(n.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=zr(Ts(this,"addOptions",{name:this.name}))),this.storage=zr(Ts(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(n={}){return new qs(n)}configure(n={}){const r=this.extend({...this.config,addOptions:()=>Wv(this.options,n)});return r.name=this.name,r.parent=this.parent,r}extend(n={}){const r=new qs({...this.config,...n});return r.parent=this,this.child=r,r.name=n.name?n.name:r.parent.name,n.defaultOptions&&Object.keys(n.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${r.name}".`),r.options=zr(Ts(r,"addOptions",{name:r.name})),r.storage=zr(Ts(r,"addStorage",{name:r.name,options:r.options})),r}}function P1e(t,n,r){const{from:s,to:i}=n,{blockSeparator:o=`

`,textSerializers:l={}}=r||{};let c="";return t.nodesBetween(s,i,(d,u,h,m)=>{var g;d.isBlock&&u>s&&(c+=o);const y=l==null?void 0:l[d.type.name];if(y)return h&&(c+=y({node:d,pos:u,parent:h,index:m,range:n})),!1;d.isText&&(c+=(g=d==null?void 0:d.text)===null||g===void 0?void 0:g.slice(Math.max(s,u)-u,i-u))}),c}function M1e(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,n])=>n.spec.toText).map(([n,r])=>[n,r.spec.toText]))}qs.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Ar({key:new Er("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:n,schema:r}=t,{doc:s,selection:i}=n,{ranges:o}=i,l=Math.min(...o.map(h=>h.$from.pos)),c=Math.max(...o.map(h=>h.$to.pos)),d=M1e(r);return P1e(s,{from:l,to:c},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:d})}}})]}});const O1e=()=>({editor:t,view:n})=>(requestAnimationFrame(()=>{var r;t.isDestroyed||(n.dom.blur(),(r=window==null?void 0:window.getSelection())===null||r===void 0||r.removeAllRanges())}),!0),D1e=(t=!1)=>({commands:n})=>n.setContent("",t),R1e=()=>({state:t,tr:n,dispatch:r})=>{const{selection:s}=n,{ranges:i}=s;return r&&i.forEach(({$from:o,$to:l})=>{t.doc.nodesBetween(o.pos,l.pos,(c,d)=>{if(c.type.isText)return;const{doc:u,mapping:h}=n,m=u.resolve(h.map(d)),g=u.resolve(h.map(d+c.nodeSize)),y=m.blockRange(g);if(!y)return;const N=_u(y);if(c.type.isTextblock){const{defaultType:j}=m.parent.contentMatchAt(m.index());n.setNodeMarkup(y.start,j)}(N||N===0)&&n.lift(y,N)})}),!0},L1e=t=>n=>t(n),B1e=()=>({state:t,dispatch:n})=>nE(t,n),F1e=(t,n)=>({editor:r,tr:s})=>{const{state:i}=r,o=i.doc.slice(t.from,t.to);s.deleteRange(t.from,t.to);const l=s.mapping.map(n);return s.insert(l,o.content),s.setSelection(new ut(s.doc.resolve(Math.max(l-1,0)))),!0},$1e=()=>({tr:t,dispatch:n})=>{const{selection:r}=t,s=r.$anchor.node();if(s.content.size>0)return!1;const i=t.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===s.type){if(n){const c=i.before(o),d=i.after(o);t.delete(c,d).scrollIntoView()}return!0}return!1},z1e=t=>({tr:n,state:r,dispatch:s})=>{const i=Rs(t,r.schema),o=n.selection.$anchor;for(let l=o.depth;l>0;l-=1)if(o.node(l).type===i){if(s){const d=o.before(l),u=o.after(l);n.delete(d,u).scrollIntoView()}return!0}return!1},U1e=t=>({tr:n,dispatch:r})=>{const{from:s,to:i}=t;return r&&n.delete(s,i),!0},V1e=()=>({state:t,dispatch:n})=>zv(t,n),H1e=()=>({commands:t})=>t.keyboardShortcut("Enter"),W1e=()=>({state:t,dispatch:n})=>s$(t,n);function q1(t,n,r={strict:!0}){const s=Object.keys(n);return s.length?s.every(i=>r.strict?n[i]===t[i]:k1e(n[i])?n[i].test(t[i]):n[i]===t[i]):!0}function nz(t,n,r={}){return t.find(s=>s.type===n&&q1(Object.fromEntries(Object.keys(r).map(i=>[i,s.attrs[i]])),r))}function yM(t,n,r={}){return!!nz(t,n,r)}function NE(t,n,r){var s;if(!t||!n)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(h=>h.type===n))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(h=>h.type===n)||(r=r||((s=i.node.marks[0])===null||s===void 0?void 0:s.attrs),!nz([...i.node.marks],n,r)))return;let l=i.index,c=t.start()+i.offset,d=l+1,u=c+i.node.nodeSize;for(;l>0&&yM([...t.parent.child(l-1).marks],n,r);)l-=1,c-=t.parent.child(l).nodeSize;for(;d<t.parent.childCount&&yM([...t.parent.child(d).marks],n,r);)u+=t.parent.child(d).nodeSize,d+=1;return{from:c,to:u}}function Jc(t,n){if(typeof t=="string"){if(!n.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return n.marks[t]}return t}const q1e=(t,n={})=>({tr:r,state:s,dispatch:i})=>{const o=Jc(t,s.schema),{doc:l,selection:c}=r,{$from:d,from:u,to:h}=c;if(i){const m=NE(d,o,n);if(m&&m.from<=u&&m.to>=h){const g=ut.create(l,m.from,m.to);r.setSelection(g)}}return!0},G1e=t=>n=>{const r=typeof t=="function"?t(n):t;for(let s=0;s<r.length;s+=1)if(r[s](n))return!0;return!1};function rz(t){return t instanceof ut}function Id(t=0,n=0,r=0){return Math.min(Math.max(t,n),r)}function K1e(t,n=null){if(!n)return null;const r=bt.atStart(t),s=bt.atEnd(t);if(n==="start"||n===!0)return r;if(n==="end")return s;const i=r.from,o=s.to;return n==="all"?ut.create(t,Id(0,i,o),Id(t.content.size,i,o)):ut.create(t,Id(n,i,o),Id(n,i,o))}function Y1e(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function jE(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const X1e=(t=null,n={})=>({editor:r,view:s,tr:i,dispatch:o})=>{n={scrollIntoView:!0,...n};const l=()=>{(jE()||Y1e())&&s.dom.focus(),requestAnimationFrame(()=>{r.isDestroyed||(s.focus(),n!=null&&n.scrollIntoView&&r.commands.scrollIntoView())})};if(s.hasFocus()&&t===null||t===!1)return!0;if(o&&t===null&&!rz(r.state.selection))return l(),!0;const c=K1e(i.doc,t)||r.state.selection,d=r.state.selection.eq(c);return o&&(d||i.setSelection(c),d&&i.storedMarks&&i.setStoredMarks(i.storedMarks),l()),!0},Q1e=(t,n)=>r=>t.every((s,i)=>n(s,{...r,index:i})),Z1e=(t,n)=>({tr:r,commands:s})=>s.insertContentAt({from:r.selection.from,to:r.selection.to},t,n),sz=t=>{const n=t.childNodes;for(let r=n.length-1;r>=0;r-=1){const s=n[r];s.nodeType===3&&s.nodeValue&&/^(\n\s\s|\n)$/.test(s.nodeValue)?t.removeChild(s):s.nodeType===1&&sz(s)}return t};function D0(t){const n=`<body>${t}</body>`,r=new window.DOMParser().parseFromString(n,"text/html").body;return sz(r)}function Bp(t,n,r){if(t instanceof jc||t instanceof Pe)return t;r={slice:!0,parseOptions:{},...r};const s=typeof t=="object"&&t!==null,i=typeof t=="string";if(s)try{if(Array.isArray(t)&&t.length>0)return Pe.fromArray(t.map(c=>n.nodeFromJSON(c)));const l=n.nodeFromJSON(t);return r.errorOnInvalidContent&&l.check(),l}catch(o){if(r.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",o),Bp("",n,r)}if(i){if(r.errorOnInvalidContent){let l=!1,c="";const d=new TF({topNode:n.spec.topNode,marks:n.spec.marks,nodes:n.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(l=!0,c=typeof u=="string"?u:u.outerHTML,null)}]}})});if(r.slice?No.fromSchema(d).parseSlice(D0(t),r.parseOptions):No.fromSchema(d).parse(D0(t),r.parseOptions),r.errorOnInvalidContent&&l)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${c}`)})}const o=No.fromSchema(n);return r.slice?o.parseSlice(D0(t),r.parseOptions).content:o.parse(D0(t),r.parseOptions)}return Bp("",n,r)}function J1e(t,n,r){const s=t.steps.length-1;if(s<n)return;const i=t.steps[s];if(!(i instanceof Br||i instanceof Ur))return;const o=t.mapping.maps[s];let l=0;o.forEach((c,d,u,h)=>{l===0&&(l=h)}),t.setSelection(bt.near(t.doc.resolve(l),r))}const eye=t=>!("type"in t),tye=(t,n,r)=>({tr:s,dispatch:i,editor:o})=>{var l;if(i){r={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...r};let c;const d=S=>{o.emit("contentError",{editor:o,error:S,disableCollaboration:()=>{o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}})},u={preserveWhitespace:"full",...r.parseOptions};if(!r.errorOnInvalidContent&&!o.options.enableContentCheck&&o.options.emitContentError)try{Bp(n,o.schema,{parseOptions:u,errorOnInvalidContent:!0})}catch(S){d(S)}try{c=Bp(n,o.schema,{parseOptions:u,errorOnInvalidContent:(l=r.errorOnInvalidContent)!==null&&l!==void 0?l:o.options.enableContentCheck})}catch(S){return d(S),!1}let{from:h,to:m}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},g=!0,y=!0;if((eye(c)?c:[c]).forEach(S=>{S.check(),g=g?S.isText&&S.marks.length===0:!1,y=y?S.isBlock:!1}),h===m&&y){const{parent:S}=s.doc.resolve(h);S.isTextblock&&!S.type.spec.code&&!S.childCount&&(h-=1,m+=1)}let j;if(g){if(Array.isArray(n))j=n.map(S=>S.text||"").join("");else if(n instanceof Pe){let S="";n.forEach(_=>{_.text&&(S+=_.text)}),j=S}else typeof n=="object"&&n&&n.text?j=n.text:j=n;s.insertText(j,h,m)}else j=c,s.replaceWith(h,m,j);r.updateSelection&&J1e(s,s.steps.length-1,-1),r.applyInputRules&&s.setMeta("applyInputRules",{from:h,text:j}),r.applyPasteRules&&s.setMeta("applyPasteRules",{from:h,text:j})}return!0},nye=()=>({state:t,dispatch:n})=>t$(t,n),rye=()=>({state:t,dispatch:n})=>n$(t,n),sye=()=>({state:t,dispatch:n})=>KA(t,n),aye=()=>({state:t,dispatch:n})=>QA(t,n),iye=()=>({state:t,dispatch:n,tr:r})=>{try{const s=_h(t.doc,t.selection.$from.pos,-1);return s==null?!1:(r.join(s,2),n&&n(r),!0)}catch{return!1}},oye=()=>({state:t,dispatch:n,tr:r})=>{try{const s=_h(t.doc,t.selection.$from.pos,1);return s==null?!1:(r.join(s,2),n&&n(r),!0)}catch{return!1}},lye=()=>({state:t,dispatch:n})=>QF(t,n),cye=()=>({state:t,dispatch:n})=>ZF(t,n);function az(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function dye(t){const n=t.split(/-(?!$)/);let r=n[n.length-1];r==="Space"&&(r=" ");let s,i,o,l;for(let c=0;c<n.length-1;c+=1){const d=n[c];if(/^(cmd|meta|m)$/i.test(d))l=!0;else if(/^a(lt)?$/i.test(d))s=!0;else if(/^(c|ctrl|control)$/i.test(d))i=!0;else if(/^s(hift)?$/i.test(d))o=!0;else if(/^mod$/i.test(d))jE()||az()?l=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${d}`)}return s&&(r=`Alt-${r}`),i&&(r=`Ctrl-${r}`),l&&(r=`Meta-${r}`),o&&(r=`Shift-${r}`),r}const uye=t=>({editor:n,view:r,tr:s,dispatch:i})=>{const o=dye(t).split(/-(?!$)/),l=o.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),c=new KeyboardEvent("keydown",{key:l==="Space"?" ":l,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),d=n.captureTransaction(()=>{r.someProp("handleKeyDown",u=>u(r,c))});return d==null||d.steps.forEach(u=>{const h=u.map(s.mapping);h&&i&&s.maybeStep(h)}),!0};function SE(t,n,r={}){const{from:s,to:i,empty:o}=t.selection,l=n?Rs(n,t.schema):null,c=[];t.doc.nodesBetween(s,i,(m,g)=>{if(m.isText)return;const y=Math.max(s,g),N=Math.min(i,g+m.nodeSize);c.push({node:m,from:y,to:N})});const d=i-s,u=c.filter(m=>l?l.name===m.node.type.name:!0).filter(m=>q1(m.node.attrs,r,{strict:!1}));return o?!!u.length:u.reduce((m,g)=>m+g.to-g.from,0)>=d}const fye=(t,n={})=>({state:r,dispatch:s})=>{const i=Rs(t,r.schema);return SE(r,i,n)?r$(r,s):!1},hye=()=>({state:t,dispatch:n})=>rE(t,n),mye=t=>({state:n,dispatch:r})=>{const s=Rs(t,n.schema);return f$(s)(n,r)},pye=()=>({state:t,dispatch:n})=>eE(t,n);function iz(t,n){return n.nodes[t]?"node":n.marks[t]?"mark":null}function vM(t,n){const r=typeof n=="string"?[n]:n;return Object.keys(t).reduce((s,i)=>(r.includes(i)||(s[i]=t[i]),s),{})}const xye=(t,n)=>({tr:r,state:s,dispatch:i})=>{let o=null,l=null;const c=iz(typeof t=="string"?t:t.name,s.schema);return c?(c==="node"&&(o=Rs(t,s.schema)),c==="mark"&&(l=Jc(t,s.schema)),i&&r.selection.ranges.forEach(d=>{s.doc.nodesBetween(d.$from.pos,d.$to.pos,(u,h)=>{o&&o===u.type&&r.setNodeMarkup(h,void 0,vM(u.attrs,n)),l&&u.marks.length&&u.marks.forEach(m=>{l===m.type&&r.addMark(h,h+u.nodeSize,l.create(vM(m.attrs,n)))})})}),!0):!1},gye=()=>({tr:t,dispatch:n})=>(n&&t.scrollIntoView(),!0),yye=()=>({tr:t,dispatch:n})=>{if(n){const r=new pa(t.doc);t.setSelection(r)}return!0},vye=()=>({state:t,dispatch:n})=>YA(t,n),bye=()=>({state:t,dispatch:n})=>ZA(t,n),wye=()=>({state:t,dispatch:n})=>a$(t,n),Nye=()=>({state:t,dispatch:n})=>c$(t,n),jye=()=>({state:t,dispatch:n})=>l$(t,n);function Sye(t,n,r={},s={}){return Bp(t,n,{slice:!1,parseOptions:r,errorOnInvalidContent:s.errorOnInvalidContent})}const Cye=(t,n=!1,r={},s={})=>({editor:i,tr:o,dispatch:l,commands:c})=>{var d,u;const{doc:h}=o;if(r.preserveWhitespace!=="full"){const m=Sye(t,i.schema,r,{errorOnInvalidContent:(d=s.errorOnInvalidContent)!==null&&d!==void 0?d:i.options.enableContentCheck});return l&&o.replaceWith(0,h.content.size,m).setMeta("preventUpdate",!n),!0}return l&&o.setMeta("preventUpdate",!n),c.insertContentAt({from:0,to:h.content.size},t,{parseOptions:r,errorOnInvalidContent:(u=s.errorOnInvalidContent)!==null&&u!==void 0?u:i.options.enableContentCheck})};function _ye(t,n){const r=Jc(n,t.schema),{from:s,to:i,empty:o}=t.selection,l=[];o?(t.storedMarks&&l.push(...t.storedMarks),l.push(...t.selection.$head.marks())):t.doc.nodesBetween(s,i,d=>{l.push(...d.marks)});const c=l.find(d=>d.type.name===r.name);return c?{...c.attrs}:{}}function Aye(t){for(let n=0;n<t.edgeCount;n+=1){const{type:r}=t.edge(n);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}function Eye(t,n){for(let r=t.depth;r>0;r-=1){const s=t.node(r);if(n(s))return{pos:r>0?t.before(r):0,start:t.start(r),depth:r,node:s}}}function CE(t){return n=>Eye(n.$from,t)}function oz(t,n,r){const s=[];return t===n?r.resolve(t).marks().forEach(i=>{const o=r.resolve(t),l=NE(o,i.type);l&&s.push({mark:i,...l})}):r.nodesBetween(t,n,(i,o)=>{!i||(i==null?void 0:i.nodeSize)===void 0||s.push(...i.marks.map(l=>({from:o,to:o+i.nodeSize,mark:l})))}),s}function Pg(t,n,r){return Object.fromEntries(Object.entries(r).filter(([s])=>{const i=t.find(o=>o.type===n&&o.name===s);return i?i.attribute.keepOnSplit:!1}))}function kye(t,n,r={}){const{empty:s,ranges:i}=t.selection,o=n?Jc(n,t.schema):null;if(s)return!!(t.storedMarks||t.selection.$from.marks()).filter(m=>o?o.name===m.type.name:!0).find(m=>q1(m.attrs,r,{strict:!1}));let l=0;const c=[];if(i.forEach(({$from:m,$to:g})=>{const y=m.pos,N=g.pos;t.doc.nodesBetween(y,N,(j,S)=>{if(!j.isText&&!j.marks.length)return;const _=Math.max(y,S),A=Math.min(N,S+j.nodeSize),k=A-_;l+=k,c.push(...j.marks.map(T=>({mark:T,from:_,to:A})))})}),l===0)return!1;const d=c.filter(m=>o?o.name===m.mark.type.name:!0).filter(m=>q1(m.mark.attrs,r,{strict:!1})).reduce((m,g)=>m+g.to-g.from,0),u=c.filter(m=>o?m.mark.type!==o&&m.mark.type.excludes(o):!0).reduce((m,g)=>m+g.to-g.from,0);return(d>0?d+u:d)>=l}function bM(t,n){const{nodeExtensions:r}=A1e(n),s=r.find(l=>l.name===t);if(!s)return!1;const i={name:s.name,options:s.options,storage:s.storage},o=zr(Ts(s,"group",i));return typeof o!="string"?!1:o.split(" ").includes("list")}function lz(t,{checkChildren:n=!0,ignoreWhitespace:r=!1}={}){var s;if(r){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((s=t.text)!==null&&s!==void 0?s:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(n){let i=!0;return t.content.forEach(o=>{i!==!1&&(lz(o,{ignoreWhitespace:r,checkChildren:n})||(i=!1))}),i}return!1}function Tye(t){return t instanceof xt}function Iye(t,n,r){var s;const{selection:i}=n;let o=null;if(rz(i)&&(o=i.$cursor),o){const c=(s=t.storedMarks)!==null&&s!==void 0?s:o.marks();return!!r.isInSet(c)||!c.some(d=>d.type.excludes(r))}const{ranges:l}=i;return l.some(({$from:c,$to:d})=>{let u=c.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(r):!1;return t.doc.nodesBetween(c.pos,d.pos,(h,m,g)=>{if(u)return!1;if(h.isInline){const y=!g||g.type.allowsMarkType(r),N=!!r.isInSet(h.marks)||!h.marks.some(j=>j.type.excludes(r));u=y&&N}return!u}),u})}const Pye=(t,n={})=>({tr:r,state:s,dispatch:i})=>{const{selection:o}=r,{empty:l,ranges:c}=o,d=Jc(t,s.schema);if(i)if(l){const u=_ye(s,d);r.addStoredMark(d.create({...u,...n}))}else c.forEach(u=>{const h=u.$from.pos,m=u.$to.pos;s.doc.nodesBetween(h,m,(g,y)=>{const N=Math.max(y,h),j=Math.min(y+g.nodeSize,m);g.marks.find(_=>_.type===d)?g.marks.forEach(_=>{d===_.type&&r.addMark(N,j,d.create({..._.attrs,...n}))}):r.addMark(N,j,d.create(n))})});return Iye(s,r,d)},Mye=(t,n)=>({tr:r})=>(r.setMeta(t,n),!0),Oye=(t,n={})=>({state:r,dispatch:s,chain:i})=>{const o=Rs(t,r.schema);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),o.isTextblock?i().command(({commands:c})=>B1(o,{...l,...n})(r)?!0:c.clearNodes()).command(({state:c})=>B1(o,{...l,...n})(c,s)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Dye=t=>({tr:n,dispatch:r})=>{if(r){const{doc:s}=n,i=Id(t,0,s.content.size),o=xt.create(s,i);n.setSelection(o)}return!0},Rye=t=>({tr:n,dispatch:r})=>{if(r){const{doc:s}=n,{from:i,to:o}=typeof t=="number"?{from:t,to:t}:t,l=ut.atStart(s).from,c=ut.atEnd(s).to,d=Id(i,l,c),u=Id(o,l,c),h=ut.create(s,d,u);n.setSelection(h)}return!0},Lye=t=>({state:n,dispatch:r})=>{const s=Rs(t,n.schema);return h$(s)(n,r)};function wM(t,n){const r=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(r){const s=r.filter(i=>n==null?void 0:n.includes(i.type.name));t.tr.ensureMarks(s)}}const Bye=({keepMarks:t=!0}={})=>({tr:n,state:r,dispatch:s,editor:i})=>{const{selection:o,doc:l}=n,{$from:c,$to:d}=o,u=i.extensionManager.attributes,h=Pg(u,c.node().type.name,c.node().attrs);if(o instanceof xt&&o.node.isBlock)return!c.parentOffset||!Oa(l,c.pos)?!1:(s&&(t&&wM(r,i.extensionManager.splittableMarks),n.split(c.pos).scrollIntoView()),!0);if(!c.parent.isBlock)return!1;const m=d.parentOffset===d.parent.content.size,g=c.depth===0?void 0:Aye(c.node(-1).contentMatchAt(c.indexAfter(-1)));let y=m&&g?[{type:g,attrs:h}]:void 0,N=Oa(n.doc,n.mapping.map(c.pos),1,y);if(!y&&!N&&Oa(n.doc,n.mapping.map(c.pos),1,g?[{type:g}]:void 0)&&(N=!0,y=g?[{type:g,attrs:h}]:void 0),s){if(N&&(o instanceof ut&&n.deleteSelection(),n.split(n.mapping.map(c.pos),1,y),g&&!m&&!c.parentOffset&&c.parent.type!==g)){const j=n.mapping.map(c.before()),S=n.doc.resolve(j);c.node(-1).canReplaceWith(S.index(),S.index()+1,g)&&n.setNodeMarkup(n.mapping.map(c.before()),g)}t&&wM(r,i.extensionManager.splittableMarks),n.scrollIntoView()}return N},Fye=(t,n={})=>({tr:r,state:s,dispatch:i,editor:o})=>{var l;const c=Rs(t,s.schema),{$from:d,$to:u}=s.selection,h=s.selection.node;if(h&&h.isBlock||d.depth<2||!d.sameParent(u))return!1;const m=d.node(-1);if(m.type!==c)return!1;const g=o.extensionManager.attributes;if(d.parent.content.size===0&&d.node(-1).childCount===d.indexAfter(-1)){if(d.depth===2||d.node(-3).type!==c||d.index(-2)!==d.node(-2).childCount-1)return!1;if(i){let _=Pe.empty;const A=d.index(-1)?1:d.index(-2)?2:3;for(let D=d.depth-A;D>=d.depth-3;D-=1)_=Pe.from(d.node(D).copy(_));const k=d.indexAfter(-1)<d.node(-2).childCount?1:d.indexAfter(-2)<d.node(-3).childCount?2:3,T={...Pg(g,d.node().type.name,d.node().attrs),...n},P=((l=c.contentMatch.defaultType)===null||l===void 0?void 0:l.createAndFill(T))||void 0;_=_.append(Pe.from(c.createAndFill(null,P)||void 0));const M=d.before(d.depth-(A-1));r.replace(M,d.after(-k),new Qe(_,4-A,0));let O=-1;r.doc.nodesBetween(M,r.doc.content.size,(D,L)=>{if(O>-1)return!1;D.isTextblock&&D.content.size===0&&(O=L+1)}),O>-1&&r.setSelection(ut.near(r.doc.resolve(O))),r.scrollIntoView()}return!0}const y=u.pos===d.end()?m.contentMatchAt(0).defaultType:null,N={...Pg(g,m.type.name,m.attrs),...n},j={...Pg(g,d.node().type.name,d.node().attrs),...n};r.delete(d.pos,u.pos);const S=y?[{type:c,attrs:N},{type:y,attrs:j}]:[{type:c,attrs:N}];if(!Oa(r.doc,d.pos,2))return!1;if(i){const{selection:_,storedMarks:A}=s,{splittableMarks:k}=o.extensionManager,T=A||_.$to.parentOffset&&_.$from.marks();if(r.split(d.pos,2,S).scrollIntoView(),!T||!i)return!0;const P=T.filter(M=>k.includes(M.type.name));r.ensureMarks(P)}return!0},zN=(t,n)=>{const r=CE(l=>l.type===n)(t.selection);if(!r)return!0;const s=t.doc.resolve(Math.max(0,r.pos-1)).before(r.depth);if(s===void 0)return!0;const i=t.doc.nodeAt(s);return r.node.type===(i==null?void 0:i.type)&&Lo(t.doc,r.pos)&&t.join(r.pos),!0},UN=(t,n)=>{const r=CE(l=>l.type===n)(t.selection);if(!r)return!0;const s=t.doc.resolve(r.start).after(r.depth);if(s===void 0)return!0;const i=t.doc.nodeAt(s);return r.node.type===(i==null?void 0:i.type)&&Lo(t.doc,s)&&t.join(s),!0},$ye=(t,n,r,s={})=>({editor:i,tr:o,state:l,dispatch:c,chain:d,commands:u,can:h})=>{const{extensions:m,splittableMarks:g}=i.extensionManager,y=Rs(t,l.schema),N=Rs(n,l.schema),{selection:j,storedMarks:S}=l,{$from:_,$to:A}=j,k=_.blockRange(A),T=S||j.$to.parentOffset&&j.$from.marks();if(!k)return!1;const P=CE(M=>bM(M.type.name,m))(j);if(k.depth>=1&&P&&k.depth-P.depth<=1){if(P.node.type===y)return u.liftListItem(N);if(bM(P.node.type.name,m)&&y.validContent(P.node.content)&&c)return d().command(()=>(o.setNodeMarkup(P.pos,y),!0)).command(()=>zN(o,y)).command(()=>UN(o,y)).run()}return!r||!T||!c?d().command(()=>h().wrapInList(y,s)?!0:u.clearNodes()).wrapInList(y,s).command(()=>zN(o,y)).command(()=>UN(o,y)).run():d().command(()=>{const M=h().wrapInList(y,s),O=T.filter(D=>g.includes(D.type.name));return o.ensureMarks(O),M?!0:u.clearNodes()}).wrapInList(y,s).command(()=>zN(o,y)).command(()=>UN(o,y)).run()},zye=(t,n={},r={})=>({state:s,commands:i})=>{const{extendEmptyMarkRange:o=!1}=r,l=Jc(t,s.schema);return kye(s,l,n)?i.unsetMark(l,{extendEmptyMarkRange:o}):i.setMark(l,n)},Uye=(t,n,r={})=>({state:s,commands:i})=>{const o=Rs(t,s.schema),l=Rs(n,s.schema),c=SE(s,o,r);let d;return s.selection.$anchor.sameParent(s.selection.$head)&&(d=s.selection.$anchor.parent.attrs),c?i.setNode(l,d):i.setNode(o,{...d,...r})},Vye=(t,n={})=>({state:r,commands:s})=>{const i=Rs(t,r.schema);return SE(r,i,n)?s.lift(i):s.wrapIn(i,n)},Hye=()=>({state:t,dispatch:n})=>{const r=t.plugins;for(let s=0;s<r.length;s+=1){const i=r[s];let o;if(i.spec.isInputRules&&(o=i.getState(t))){if(n){const l=t.tr,c=o.transform;for(let d=c.steps.length-1;d>=0;d-=1)l.step(c.steps[d].invert(c.docs[d]));if(o.text){const d=l.doc.resolve(o.from).marks();l.replaceWith(o.from,o.to,t.schema.text(o.text,d))}else l.delete(o.from,o.to)}return!0}}return!1},Wye=()=>({tr:t,dispatch:n})=>{const{selection:r}=t,{empty:s,ranges:i}=r;return s||n&&i.forEach(o=>{t.removeMark(o.$from.pos,o.$to.pos)}),!0},qye=(t,n={})=>({tr:r,state:s,dispatch:i})=>{var o;const{extendEmptyMarkRange:l=!1}=n,{selection:c}=r,d=Jc(t,s.schema),{$from:u,empty:h,ranges:m}=c;if(!i)return!0;if(h&&l){let{from:g,to:y}=c;const N=(o=u.marks().find(S=>S.type===d))===null||o===void 0?void 0:o.attrs,j=NE(u,d,N);j&&(g=j.from,y=j.to),r.removeMark(g,y,d)}else m.forEach(g=>{r.removeMark(g.$from.pos,g.$to.pos,d)});return r.removeStoredMark(d),!0},Gye=(t,n={})=>({tr:r,state:s,dispatch:i})=>{let o=null,l=null;const c=iz(typeof t=="string"?t:t.name,s.schema);return c?(c==="node"&&(o=Rs(t,s.schema)),c==="mark"&&(l=Jc(t,s.schema)),i&&r.selection.ranges.forEach(d=>{const u=d.$from.pos,h=d.$to.pos;let m,g,y,N;r.selection.empty?s.doc.nodesBetween(u,h,(j,S)=>{o&&o===j.type&&(y=Math.max(S,u),N=Math.min(S+j.nodeSize,h),m=S,g=j)}):s.doc.nodesBetween(u,h,(j,S)=>{S<u&&o&&o===j.type&&(y=Math.max(S,u),N=Math.min(S+j.nodeSize,h),m=S,g=j),S>=u&&S<=h&&(o&&o===j.type&&r.setNodeMarkup(S,void 0,{...j.attrs,...n}),l&&j.marks.length&&j.marks.forEach(_=>{if(l===_.type){const A=Math.max(S,u),k=Math.min(S+j.nodeSize,h);r.addMark(A,k,l.create({..._.attrs,...n}))}}))}),g&&(m!==void 0&&r.setNodeMarkup(m,void 0,{...g.attrs,...n}),l&&g.marks.length&&g.marks.forEach(j=>{l===j.type&&r.addMark(y,N,l.create({...j.attrs,...n}))}))}),!0):!1},Kye=(t,n={})=>({state:r,dispatch:s})=>{const i=Rs(t,r.schema);return d$(i,n)(r,s)},Yye=(t,n={})=>({state:r,dispatch:s})=>{const i=Rs(t,r.schema);return u$(i,n)(r,s)};var Xye=Object.freeze({__proto__:null,blur:O1e,clearContent:D1e,clearNodes:R1e,command:L1e,createParagraphNear:B1e,cut:F1e,deleteCurrentNode:$1e,deleteNode:z1e,deleteRange:U1e,deleteSelection:V1e,enter:H1e,exitCode:W1e,extendMarkRange:q1e,first:G1e,focus:X1e,forEach:Q1e,insertContent:Z1e,insertContentAt:tye,joinBackward:sye,joinDown:rye,joinForward:aye,joinItemBackward:iye,joinItemForward:oye,joinTextblockBackward:lye,joinTextblockForward:cye,joinUp:nye,keyboardShortcut:uye,lift:fye,liftEmptyBlock:hye,liftListItem:mye,newlineInCode:pye,resetAttributes:xye,scrollIntoView:gye,selectAll:yye,selectNodeBackward:vye,selectNodeForward:bye,selectParentNode:wye,selectTextblockEnd:Nye,selectTextblockStart:jye,setContent:Cye,setMark:Pye,setMeta:Mye,setNode:Oye,setNodeSelection:Dye,setTextSelection:Rye,sinkListItem:Lye,splitBlock:Bye,splitListItem:Fye,toggleList:$ye,toggleMark:zye,toggleNode:Uye,toggleWrap:Vye,undoInputRule:Hye,unsetAllMarks:Wye,unsetMark:qye,updateAttributes:Gye,wrapIn:Kye,wrapInList:Yye});qs.create({name:"commands",addCommands(){return{...Xye}}});qs.create({name:"drop",addProseMirrorPlugins(){return[new Ar({key:new Er("tiptapDrop"),props:{handleDrop:(t,n,r,s)=>{this.editor.emit("drop",{editor:this.editor,event:n,slice:r,moved:s})}}})]}});qs.create({name:"editable",addProseMirrorPlugins(){return[new Ar({key:new Er("editable"),props:{editable:()=>this.editor.options.editable}})]}});const Qye=new Er("focusEvents");qs.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new Ar({key:Qye,props:{handleDOMEvents:{focus:(n,r)=>{t.isFocused=!0;const s=t.state.tr.setMeta("focus",{event:r}).setMeta("addToHistory",!1);return n.dispatch(s),!1},blur:(n,r)=>{t.isFocused=!1;const s=t.state.tr.setMeta("blur",{event:r}).setMeta("addToHistory",!1);return n.dispatch(s),!1}}}})]}});qs.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:l})=>[()=>l.undoInputRule(),()=>l.command(({tr:c})=>{const{selection:d,doc:u}=c,{empty:h,$anchor:m}=d,{pos:g,parent:y}=m,N=m.parent.isTextblock&&g>0?c.doc.resolve(g-1):m,j=N.parent.type.spec.isolating,S=m.pos-m.parentOffset,_=j&&N.parent.childCount===1?S===m.pos:bt.atStart(u).from===g;return!h||!y.type.isTextblock||y.textContent.length||!_||_&&m.parent.type.name==="paragraph"?!1:l.clearNodes()}),()=>l.deleteSelection(),()=>l.joinBackward(),()=>l.selectNodeBackward()]),n=()=>this.editor.commands.first(({commands:l})=>[()=>l.deleteSelection(),()=>l.deleteCurrentNode(),()=>l.joinForward(),()=>l.selectNodeForward()]),s={Enter:()=>this.editor.commands.first(({commands:l})=>[()=>l.newlineInCode(),()=>l.createParagraphNear(),()=>l.liftEmptyBlock(),()=>l.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:n,"Mod-Delete":n,"Mod-a":()=>this.editor.commands.selectAll()},i={...s},o={...s,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":n,"Ctrl-Alt-Backspace":n,"Alt-Delete":n,"Alt-d":n,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return jE()||az()?o:i},addProseMirrorPlugins(){return[new Ar({key:new Er("clearDocument"),appendTransaction:(t,n,r)=>{if(t.some(j=>j.getMeta("composition")))return;const s=t.some(j=>j.docChanged)&&!n.doc.eq(r.doc),i=t.some(j=>j.getMeta("preventClearDocument"));if(!s||i)return;const{empty:o,from:l,to:c}=n.selection,d=bt.atStart(n.doc).from,u=bt.atEnd(n.doc).to;if(o||!(l===d&&c===u)||!lz(r.doc))return;const g=r.tr,y=tz({state:r,transaction:g}),{commands:N}=new _1e({editor:this.editor,state:y});if(N.clearNodes(),!!g.steps.length)return g}})]}});qs.create({name:"paste",addProseMirrorPlugins(){return[new Ar({key:new Er("tiptapPaste"),props:{handlePaste:(t,n,r)=>{this.editor.emit("paste",{editor:this.editor,event:n,slice:r})}}})]}});qs.create({name:"tabindex",addProseMirrorPlugins(){return[new Ar({key:new Er("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});function eh(t){return new Hv({find:t.find,handler:({state:n,range:r,match:s})=>{const i=zr(t.getAttributes,void 0,s);if(i===!1||i===null)return null;const{tr:o}=n,l=s[s.length-1],c=s[0];if(l){const d=c.search(/\S/),u=r.from+c.indexOf(l),h=u+l.length;if(oz(r.from,r.to,n.doc).filter(y=>y.mark.type.excluded.find(j=>j===t.type&&j!==y.mark.type)).filter(y=>y.to>u).length)return null;h<r.to&&o.delete(h,r.to),u>r.from&&o.delete(r.from+d,u);const g=r.from+d+l.length;o.addMark(r.from+d,g,t.type.create(i||{})),o.removeStoredMark(t.type)}}})}function Zye(t){return new Hv({find:t.find,handler:({state:n,range:r,match:s})=>{const i=zr(t.getAttributes,void 0,s)||{},{tr:o}=n,l=r.from;let c=r.to;const d=t.type.create(i);if(s[1]){const u=s[0].lastIndexOf(s[1]);let h=l+u;h>c?h=c:c=h+s[1].length;const m=s[0][s[0].length-1];o.insertText(m,l+s[0].length-1),o.replaceWith(h,c,d)}else if(s[0]){const u=t.type.isInline?l:l-1;o.insert(u,t.type.create(i)).delete(o.mapping.map(l),o.mapping.map(c))}o.scrollIntoView()}})}function RS(t){return new Hv({find:t.find,handler:({state:n,range:r,match:s})=>{const i=n.doc.resolve(r.from),o=zr(t.getAttributes,void 0,s)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;n.tr.delete(r.from,r.to).setBlockType(r.from,r.from,t.type,o)}})}function Fp(t){return new Hv({find:t.find,handler:({state:n,range:r,match:s,chain:i})=>{const o=zr(t.getAttributes,void 0,s)||{},l=n.tr.delete(r.from,r.to),d=l.doc.resolve(r.from).blockRange(),u=d&&qA(d,t.type,o);if(!u)return null;if(l.wrap(d,u),t.keepMarks&&t.editor){const{selection:m,storedMarks:g}=n,{splittableMarks:y}=t.editor.extensionManager,N=g||m.$to.parentOffset&&m.$from.marks();if(N){const j=N.filter(S=>y.includes(S.type.name));l.ensureMarks(j)}}if(t.keepAttributes){const m=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(m,o).run()}const h=l.doc.resolve(r.from-1).nodeBefore;h&&h.type===t.type&&Lo(l.doc,r.from-1)&&(!t.joinPredicate||t.joinPredicate(s,h))&&l.join(r.from-1)}})}let Gi=class LS{constructor(n={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...n},this.name=this.config.name,n.defaultOptions&&Object.keys(n.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=zr(Ts(this,"addOptions",{name:this.name}))),this.storage=zr(Ts(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(n={}){return new LS(n)}configure(n={}){const r=this.extend({...this.config,addOptions:()=>Wv(this.options,n)});return r.name=this.name,r.parent=this.parent,r}extend(n={}){const r=new LS(n);return r.parent=this,this.child=r,r.name=n.name?n.name:r.parent.name,n.defaultOptions&&Object.keys(n.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${r.name}".`),r.options=zr(Ts(r,"addOptions",{name:r.name})),r.storage=zr(Ts(r,"addStorage",{name:r.name,options:r.options})),r}};function th(t){return new I1e({find:t.find,handler:({state:n,range:r,match:s,pasteEvent:i})=>{const o=zr(t.getAttributes,void 0,s,i);if(o===!1||o===null)return null;const{tr:l}=n,c=s[s.length-1],d=s[0];let u=r.to;if(c){const h=d.search(/\S/),m=r.from+d.indexOf(c),g=m+c.length;if(oz(r.from,r.to,n.doc).filter(N=>N.mark.type.excluded.find(S=>S===t.type&&S!==N.mark.type)).filter(N=>N.to>m).length)return null;g<r.to&&l.delete(g,r.to),m>r.from&&l.delete(r.from+h,m),u=r.from+h+c.length,l.addMark(r.from+h,u,t.type.create(o||{})),l.removeStoredMark(t.type)}}})}function Jye(t,n){const{selection:r}=t,{$from:s}=r;if(r instanceof xt){const o=s.index();return s.parent.canReplaceWith(o,o+1,n)}let i=s.depth;for(;i>=0;){const o=s.index(i);if(s.node(i).contentMatchAt(o).matchType(n))return!0;i-=1}return!1}const eve=/^\s*>\s$/,tve=Gi.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return["blockquote",xa(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Fp({find:eve,type:this.type})]}}),nve=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,rve=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,sve=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,ave=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,ive=uu.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",xa(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[eh({find:nve,type:this.type}),eh({find:sve,type:this.type})]},addPasteRules(){return[th({find:rve,type:this.type}),th({find:ave,type:this.type})]}}),ove="listItem",NM="textStyle",jM=/^\s*([-+*])\s$/,lve=Gi.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",xa(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t,chain:n})=>this.options.keepAttributes?n().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(ove,this.editor.getAttributes(NM)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=Fp({find:jM,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Fp({find:jM,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(NM),editor:this.editor})),[t]}}),cve=/(^|[^`])`([^`]+)`(?!`)/,dve=/(^|[^`])`([^`]+)`(?!`)/g,uve=uu.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",xa(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[eh({find:cve,type:this.type})]},addPasteRules(){return[th({find:dve,type:this.type})]}}),fve=/^```([a-z]+)?[\s\n]$/,hve=/^~~~([a-z]+)?[\s\n]$/,mve=Gi.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var n;const{languageClassPrefix:r}=this.options,o=[...((n=t.firstElementChild)===null||n===void 0?void 0:n.classList)||[]].filter(l=>l.startsWith(r)).map(l=>l.replace(r,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:n}){return["pre",xa(this.options.HTMLAttributes,n),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:n})=>n.setNode(this.name,t),toggleCodeBlock:t=>({commands:n})=>n.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:n}=this.editor.state.selection,r=n.pos===1;return!t||n.parent.type.name!==this.name?!1:r||!n.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:n}=t,{selection:r}=n,{$from:s,empty:i}=r;if(!i||s.parent.type!==this.type)return!1;const o=s.parentOffset===s.parent.nodeSize-2,l=s.parent.textContent.endsWith(`

`);return!o||!l?!1:t.chain().command(({tr:c})=>(c.delete(s.pos-2,s.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:n}=t,{selection:r,doc:s}=n,{$from:i,empty:o}=r;if(!o||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const c=i.after();return c===void 0?!1:s.nodeAt(c)?t.commands.command(({tr:u})=>(u.setSelection(bt.near(s.resolve(c))),!0)):t.commands.exitCode()}}},addInputRules(){return[RS({find:fve,type:this.type,getAttributes:t=>({language:t[1]})}),RS({find:hve,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new Ar({key:new Er("codeBlockVSCodeHandler"),props:{handlePaste:(t,n)=>{if(!n.clipboardData||this.editor.isActive(this.type.name))return!1;const r=n.clipboardData.getData("text/plain"),s=n.clipboardData.getData("vscode-editor-data"),i=s?JSON.parse(s):void 0,o=i==null?void 0:i.mode;if(!r||!o)return!1;const{tr:l,schema:c}=t.state,d=c.text(r.replace(/\r\n?/g,`
`));return l.replaceSelectionWith(this.type.create({language:o},d)),l.selection.$from.parent.type!==this.type&&l.setSelection(ut.near(l.doc.resolve(Math.max(0,l.selection.from-2)))),l.setMeta("paste",!0),t.dispatch(l),!0}}})]}}),pve=Gi.create({name:"doc",topNode:!0,content:"block+"});function xve(t={}){return new Ar({view(n){return new gve(n,t)}})}class gve{constructor(n,r){var s;this.editorView=n,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(s=r.width)!==null&&s!==void 0?s:1,this.color=r.color===!1?void 0:r.color||"black",this.class=r.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let o=l=>{this[i](l)};return n.dom.addEventListener(i,o),{name:i,handler:o}})}destroy(){this.handlers.forEach(({name:n,handler:r})=>this.editorView.dom.removeEventListener(n,r))}update(n,r){this.cursorPos!=null&&r.doc!=n.state.doc&&(this.cursorPos>n.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(n){n!=this.cursorPos&&(this.cursorPos=n,n==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let n=this.editorView.state.doc.resolve(this.cursorPos),r=!n.parent.inlineContent,s,i=this.editorView.dom,o=i.getBoundingClientRect(),l=o.width/i.offsetWidth,c=o.height/i.offsetHeight;if(r){let m=n.nodeBefore,g=n.nodeAfter;if(m||g){let y=this.editorView.nodeDOM(this.cursorPos-(m?m.nodeSize:0));if(y){let N=y.getBoundingClientRect(),j=m?N.bottom:N.top;m&&g&&(j=(j+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let S=this.width/2*c;s={left:N.left,right:N.right,top:j-S,bottom:j+S}}}}if(!s){let m=this.editorView.coordsAtPos(this.cursorPos),g=this.width/2*l;s={left:m.left-g,right:m.left+g,top:m.top,bottom:m.bottom}}let d=this.editorView.dom.offsetParent;this.element||(this.element=d.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",r),this.element.classList.toggle("prosemirror-dropcursor-inline",!r);let u,h;if(!d||d==document.body&&getComputedStyle(d).position=="static")u=-pageXOffset,h=-pageYOffset;else{let m=d.getBoundingClientRect(),g=m.width/d.offsetWidth,y=m.height/d.offsetHeight;u=m.left-d.scrollLeft*g,h=m.top-d.scrollTop*y}this.element.style.left=(s.left-u)/l+"px",this.element.style.top=(s.top-h)/c+"px",this.element.style.width=(s.right-s.left)/l+"px",this.element.style.height=(s.bottom-s.top)/c+"px"}scheduleRemoval(n){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),n)}dragover(n){if(!this.editorView.editable)return;let r=this.editorView.posAtCoords({left:n.clientX,top:n.clientY}),s=r&&r.inside>=0&&this.editorView.state.doc.nodeAt(r.inside),i=s&&s.type.spec.disableDropCursor,o=typeof i=="function"?i(this.editorView,r,n):i;if(r&&!o){let l=r.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let c=zF(this.editorView.state.doc,l,this.editorView.dragging.slice);c!=null&&(l=c)}this.setCursor(l),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(n){this.editorView.dom.contains(n.relatedTarget)||this.setCursor(null)}}const yve=qs.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[xve(this.options)]}});class lr extends bt{constructor(n){super(n,n)}map(n,r){let s=n.resolve(r.map(this.head));return lr.valid(s)?new lr(s):bt.near(s)}content(){return Qe.empty}eq(n){return n instanceof lr&&n.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(n,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new lr(n.resolve(r.pos))}getBookmark(){return new _E(this.anchor)}static valid(n){let r=n.parent;if(r.isTextblock||!vve(n)||!bve(n))return!1;let s=r.type.spec.allowGapCursor;if(s!=null)return s;let i=r.contentMatchAt(n.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(n,r,s=!1){e:for(;;){if(!s&&lr.valid(n))return n;let i=n.pos,o=null;for(let l=n.depth;;l--){let c=n.node(l);if(r>0?n.indexAfter(l)<c.childCount:n.index(l)>0){o=c.child(r>0?n.indexAfter(l):n.index(l)-1);break}else if(l==0)return null;i+=r;let d=n.doc.resolve(i);if(lr.valid(d))return d}for(;;){let l=r>0?o.firstChild:o.lastChild;if(!l){if(o.isAtom&&!o.isText&&!xt.isSelectable(o)){n=n.doc.resolve(i+o.nodeSize*r),s=!1;continue e}break}o=l,i+=r;let c=n.doc.resolve(i);if(lr.valid(c))return c}return null}}}lr.prototype.visible=!1;lr.findFrom=lr.findGapCursorFrom;bt.jsonID("gapcursor",lr);class _E{constructor(n){this.pos=n}map(n){return new _E(n.map(this.pos))}resolve(n){let r=n.resolve(this.pos);return lr.valid(r)?new lr(r):bt.near(r)}}function cz(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}function vve(t){for(let n=t.depth;n>=0;n--){let r=t.index(n),s=t.node(n);if(r==0){if(s.type.spec.isolating)return!0;continue}for(let i=s.child(r-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||cz(i.type))return!0;if(i.inlineContent)return!1}}return!0}function bve(t){for(let n=t.depth;n>=0;n--){let r=t.indexAfter(n),s=t.node(n);if(r==s.childCount){if(s.type.spec.isolating)return!0;continue}for(let i=s.child(r);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||cz(i.type))return!0;if(i.inlineContent)return!1}}return!0}function wve(){return new Ar({props:{decorations:Cve,createSelectionBetween(t,n,r){return n.pos==r.pos&&lr.valid(r)?new lr(r):null},handleClick:jve,handleKeyDown:Nve,handleDOMEvents:{beforeinput:Sve}}})}const Nve=B$({ArrowLeft:R0("horiz",-1),ArrowRight:R0("horiz",1),ArrowUp:R0("vert",-1),ArrowDown:R0("vert",1)});function R0(t,n){const r=t=="vert"?n>0?"down":"up":n>0?"right":"left";return function(s,i,o){let l=s.selection,c=n>0?l.$to:l.$from,d=l.empty;if(l instanceof ut){if(!o.endOfTextblock(r)||c.depth==0)return!1;d=!1,c=s.doc.resolve(n>0?c.after():c.before())}let u=lr.findGapCursorFrom(c,n,d);return u?(i&&i(s.tr.setSelection(new lr(u))),!0):!1}}function jve(t,n,r){if(!t||!t.editable)return!1;let s=t.state.doc.resolve(n);if(!lr.valid(s))return!1;let i=t.posAtCoords({left:r.clientX,top:r.clientY});return i&&i.inside>-1&&xt.isSelectable(t.state.doc.nodeAt(i.inside))?!1:(t.dispatch(t.state.tr.setSelection(new lr(s))),!0)}function Sve(t,n){if(n.inputType!="insertCompositionText"||!(t.state.selection instanceof lr))return!1;let{$from:r}=t.state.selection,s=r.parent.contentMatchAt(r.index()).findWrapping(t.state.schema.nodes.text);if(!s)return!1;let i=Pe.empty;for(let l=s.length-1;l>=0;l--)i=Pe.from(s[l].createAndFill(null,i));let o=t.state.tr.replace(r.pos,r.pos,new Qe(i,0,0));return o.setSelection(ut.near(o.doc.resolve(r.pos+1))),t.dispatch(o),!1}function Cve(t){if(!(t.selection instanceof lr))return null;let n=document.createElement("div");return n.className="ProseMirror-gapcursor",pr.create(t.doc,[Ia.widget(t.selection.head,n,{key:"gapcursor"})])}const _ve=qs.create({name:"gapCursor",addProseMirrorPlugins(){return[wve()]},extendNodeSchema(t){var n;const r={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(n=zr(Ts(t,"allowGapCursor",r)))!==null&&n!==void 0?n:null}}}),Ave=Gi.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",xa(this.options.HTMLAttributes,t)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:t,chain:n,state:r,editor:s})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:i,storedMarks:o}=r;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:l}=this.options,{splittableMarks:c}=s.extensionManager,d=o||i.$to.parentOffset&&i.$from.marks();return n().insertContent({type:this.name}).command(({tr:u,dispatch:h})=>{if(h&&d&&l){const m=d.filter(g=>c.includes(g.type.name));u.ensureMarks(m)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Eve=Gi.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:n}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,xa(this.options.HTMLAttributes,n),0]},addCommands(){return{setHeading:t=>({commands:n})=>this.options.levels.includes(t.level)?n.setNode(this.name,t):!1,toggleHeading:t=>({commands:n})=>this.options.levels.includes(t.level)?n.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,n)=>({...t,[`Mod-Alt-${n}`]:()=>this.editor.commands.toggleHeading({level:n})}),{})},addInputRules(){return this.options.levels.map(t=>RS({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}});var G1=200,Jr=function(){};Jr.prototype.append=function(n){return n.length?(n=Jr.from(n),!this.length&&n||n.length<G1&&this.leafAppend(n)||this.length<G1&&n.leafPrepend(this)||this.appendInner(n)):this};Jr.prototype.prepend=function(n){return n.length?Jr.from(n).append(this):this};Jr.prototype.appendInner=function(n){return new kve(this,n)};Jr.prototype.slice=function(n,r){return n===void 0&&(n=0),r===void 0&&(r=this.length),n>=r?Jr.empty:this.sliceInner(Math.max(0,n),Math.min(this.length,r))};Jr.prototype.get=function(n){if(!(n<0||n>=this.length))return this.getInner(n)};Jr.prototype.forEach=function(n,r,s){r===void 0&&(r=0),s===void 0&&(s=this.length),r<=s?this.forEachInner(n,r,s,0):this.forEachInvertedInner(n,r,s,0)};Jr.prototype.map=function(n,r,s){r===void 0&&(r=0),s===void 0&&(s=this.length);var i=[];return this.forEach(function(o,l){return i.push(n(o,l))},r,s),i};Jr.from=function(n){return n instanceof Jr?n:n&&n.length?new dz(n):Jr.empty};var dz=function(t){function n(s){t.call(this),this.values=s}t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n;var r={length:{configurable:!0},depth:{configurable:!0}};return n.prototype.flatten=function(){return this.values},n.prototype.sliceInner=function(i,o){return i==0&&o==this.length?this:new n(this.values.slice(i,o))},n.prototype.getInner=function(i){return this.values[i]},n.prototype.forEachInner=function(i,o,l,c){for(var d=o;d<l;d++)if(i(this.values[d],c+d)===!1)return!1},n.prototype.forEachInvertedInner=function(i,o,l,c){for(var d=o-1;d>=l;d--)if(i(this.values[d],c+d)===!1)return!1},n.prototype.leafAppend=function(i){if(this.length+i.length<=G1)return new n(this.values.concat(i.flatten()))},n.prototype.leafPrepend=function(i){if(this.length+i.length<=G1)return new n(i.flatten().concat(this.values))},r.length.get=function(){return this.values.length},r.depth.get=function(){return 0},Object.defineProperties(n.prototype,r),n}(Jr);Jr.empty=new dz([]);var kve=function(t){function n(r,s){t.call(this),this.left=r,this.right=s,this.length=r.length+s.length,this.depth=Math.max(r.depth,s.depth)+1}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},n.prototype.getInner=function(s){return s<this.left.length?this.left.get(s):this.right.get(s-this.left.length)},n.prototype.forEachInner=function(s,i,o,l){var c=this.left.length;if(i<c&&this.left.forEachInner(s,i,Math.min(o,c),l)===!1||o>c&&this.right.forEachInner(s,Math.max(i-c,0),Math.min(this.length,o)-c,l+c)===!1)return!1},n.prototype.forEachInvertedInner=function(s,i,o,l){var c=this.left.length;if(i>c&&this.right.forEachInvertedInner(s,i-c,Math.max(o,c)-c,l+c)===!1||o<c&&this.left.forEachInvertedInner(s,Math.min(i,c),o,l)===!1)return!1},n.prototype.sliceInner=function(s,i){if(s==0&&i==this.length)return this;var o=this.left.length;return i<=o?this.left.slice(s,i):s>=o?this.right.slice(s-o,i-o):this.left.slice(s,o).append(this.right.slice(0,i-o))},n.prototype.leafAppend=function(s){var i=this.right.leafAppend(s);if(i)return new n(this.left,i)},n.prototype.leafPrepend=function(s){var i=this.left.leafPrepend(s);if(i)return new n(i,this.right)},n.prototype.appendInner=function(s){return this.left.depth>=Math.max(this.right.depth,s.depth)+1?new n(this.left,new n(this.right,s)):new n(this,s)},n}(Jr);const Tve=500;class Pi{constructor(n,r){this.items=n,this.eventCount=r}popEvent(n,r){if(this.eventCount==0)return null;let s=this.items.length;for(;;s--)if(this.items.get(s-1).selection){--s;break}let i,o;r&&(i=this.remapping(s,this.items.length),o=i.maps.length);let l=n.tr,c,d,u=[],h=[];return this.items.forEach((m,g)=>{if(!m.step){i||(i=this.remapping(s,g+1),o=i.maps.length),o--,h.push(m);return}if(i){h.push(new lo(m.map));let y=m.step.map(i.slice(o)),N;y&&l.maybeStep(y).doc&&(N=l.mapping.maps[l.mapping.maps.length-1],u.push(new lo(N,void 0,void 0,u.length+h.length))),o--,N&&i.appendMap(N,o)}else l.maybeStep(m.step);if(m.selection)return c=i?m.selection.map(i.slice(o)):m.selection,d=new Pi(this.items.slice(0,s).append(h.reverse().concat(u)),this.eventCount-1),!1},this.items.length,0),{remaining:d,transform:l,selection:c}}addTransform(n,r,s,i){let o=[],l=this.eventCount,c=this.items,d=!i&&c.length?c.get(c.length-1):null;for(let h=0;h<n.steps.length;h++){let m=n.steps[h].invert(n.docs[h]),g=new lo(n.mapping.maps[h],m,r),y;(y=d&&d.merge(g))&&(g=y,h?o.pop():c=c.slice(0,c.length-1)),o.push(g),r&&(l++,r=void 0),i||(d=g)}let u=l-s.depth;return u>Pve&&(c=Ive(c,u),l-=u),new Pi(c.append(o),l)}remapping(n,r){let s=new Mp;return this.items.forEach((i,o)=>{let l=i.mirrorOffset!=null&&o-i.mirrorOffset>=n?s.maps.length-i.mirrorOffset:void 0;s.appendMap(i.map,l)},n,r),s}addMaps(n){return this.eventCount==0?this:new Pi(this.items.append(n.map(r=>new lo(r))),this.eventCount)}rebased(n,r){if(!this.eventCount)return this;let s=[],i=Math.max(0,this.items.length-r),o=n.mapping,l=n.steps.length,c=this.eventCount;this.items.forEach(g=>{g.selection&&c--},i);let d=r;this.items.forEach(g=>{let y=o.getMirror(--d);if(y==null)return;l=Math.min(l,y);let N=o.maps[y];if(g.step){let j=n.steps[y].invert(n.docs[y]),S=g.selection&&g.selection.map(o.slice(d+1,y));S&&c++,s.push(new lo(N,j,S))}else s.push(new lo(N))},i);let u=[];for(let g=r;g<l;g++)u.push(new lo(o.maps[g]));let h=this.items.slice(0,i).append(u).append(s),m=new Pi(h,c);return m.emptyItemCount()>Tve&&(m=m.compress(this.items.length-s.length)),m}emptyItemCount(){let n=0;return this.items.forEach(r=>{r.step||n++}),n}compress(n=this.items.length){let r=this.remapping(0,n),s=r.maps.length,i=[],o=0;return this.items.forEach((l,c)=>{if(c>=n)i.push(l),l.selection&&o++;else if(l.step){let d=l.step.map(r.slice(s)),u=d&&d.getMap();if(s--,u&&r.appendMap(u,s),d){let h=l.selection&&l.selection.map(r.slice(s));h&&o++;let m=new lo(u.invert(),d,h),g,y=i.length-1;(g=i.length&&i[y].merge(m))?i[y]=g:i.push(m)}}else l.map&&s--},this.items.length,0),new Pi(Jr.from(i.reverse()),o)}}Pi.empty=new Pi(Jr.empty,0);function Ive(t,n){let r;return t.forEach((s,i)=>{if(s.selection&&n--==0)return r=i,!1}),t.slice(r)}class lo{constructor(n,r,s,i){this.map=n,this.step=r,this.selection=s,this.mirrorOffset=i}merge(n){if(this.step&&n.step&&!n.selection){let r=n.step.merge(this.step);if(r)return new lo(r.getMap().invert(),r,this.selection)}}}class Zl{constructor(n,r,s,i,o){this.done=n,this.undone=r,this.prevRanges=s,this.prevTime=i,this.prevComposition=o}}const Pve=20;function Mve(t,n,r,s){let i=r.getMeta(Gd),o;if(i)return i.historyState;r.getMeta(Rve)&&(t=new Zl(t.done,t.undone,null,0,-1));let l=r.getMeta("appendedTransaction");if(r.steps.length==0)return t;if(l&&l.getMeta(Gd))return l.getMeta(Gd).redo?new Zl(t.done.addTransform(r,void 0,s,Mg(n)),t.undone,SM(r.mapping.maps),t.prevTime,t.prevComposition):new Zl(t.done,t.undone.addTransform(r,void 0,s,Mg(n)),null,t.prevTime,t.prevComposition);if(r.getMeta("addToHistory")!==!1&&!(l&&l.getMeta("addToHistory")===!1)){let c=r.getMeta("composition"),d=t.prevTime==0||!l&&t.prevComposition!=c&&(t.prevTime<(r.time||0)-s.newGroupDelay||!Ove(r,t.prevRanges)),u=l?VN(t.prevRanges,r.mapping):SM(r.mapping.maps);return new Zl(t.done.addTransform(r,d?n.selection.getBookmark():void 0,s,Mg(n)),Pi.empty,u,r.time,c??t.prevComposition)}else return(o=r.getMeta("rebased"))?new Zl(t.done.rebased(r,o),t.undone.rebased(r,o),VN(t.prevRanges,r.mapping),t.prevTime,t.prevComposition):new Zl(t.done.addMaps(r.mapping.maps),t.undone.addMaps(r.mapping.maps),VN(t.prevRanges,r.mapping),t.prevTime,t.prevComposition)}function Ove(t,n){if(!n)return!1;if(!t.docChanged)return!0;let r=!1;return t.mapping.maps[0].forEach((s,i)=>{for(let o=0;o<n.length;o+=2)s<=n[o+1]&&i>=n[o]&&(r=!0)}),r}function SM(t){let n=[];for(let r=t.length-1;r>=0&&n.length==0;r--)t[r].forEach((s,i,o,l)=>n.push(o,l));return n}function VN(t,n){if(!t)return null;let r=[];for(let s=0;s<t.length;s+=2){let i=n.map(t[s],1),o=n.map(t[s+1],-1);i<=o&&r.push(i,o)}return r}function Dve(t,n,r){let s=Mg(n),i=Gd.get(n).spec.config,o=(r?t.undone:t.done).popEvent(n,s);if(!o)return null;let l=o.selection.resolve(o.transform.doc),c=(r?t.done:t.undone).addTransform(o.transform,n.selection.getBookmark(),i,s),d=new Zl(r?c:o.remaining,r?o.remaining:c,null,0,-1);return o.transform.setSelection(l).setMeta(Gd,{redo:r,historyState:d})}let HN=!1,CM=null;function Mg(t){let n=t.plugins;if(CM!=n){HN=!1,CM=n;for(let r=0;r<n.length;r++)if(n[r].spec.historyPreserveItems){HN=!0;break}}return HN}const Gd=new Er("history"),Rve=new Er("closeHistory");function Lve(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new Ar({key:Gd,state:{init(){return new Zl(Pi.empty,Pi.empty,null,0,-1)},apply(n,r,s){return Mve(r,s,n,t)}},config:t,props:{handleDOMEvents:{beforeinput(n,r){let s=r.inputType,i=s=="historyUndo"?fz:s=="historyRedo"?hz:null;return i?(r.preventDefault(),i(n.state,n.dispatch)):!1}}}})}function uz(t,n){return(r,s)=>{let i=Gd.getState(r);if(!i||(t?i.undone:i.done).eventCount==0)return!1;if(s){let o=Dve(i,r,t);o&&s(n?o.scrollIntoView():o)}return!0}}const fz=uz(!1,!0),hz=uz(!0,!0),Bve=qs.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:n})=>fz(t,n),redo:()=>({state:t,dispatch:n})=>hz(t,n)}},addProseMirrorPlugins(){return[Lve(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),Fve=Gi.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",xa(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t,state:n})=>{if(!Jye(n,n.schema.nodes[this.name]))return!1;const{selection:r}=n,{$from:s,$to:i}=r,o=t();return s.parentOffset===0?o.insertContentAt({from:Math.max(s.pos-1,0),to:i.pos},{type:this.name}):Tye(r)?o.insertContentAt(i.pos,{type:this.name}):o.insertContent({type:this.name}),o.command(({tr:l,dispatch:c})=>{var d;if(c){const{$to:u}=l.selection,h=u.end();if(u.nodeAfter)u.nodeAfter.isTextblock?l.setSelection(ut.create(l.doc,u.pos+1)):u.nodeAfter.isBlock?l.setSelection(xt.create(l.doc,u.pos)):l.setSelection(ut.create(l.doc,u.pos));else{const m=(d=u.parent.type.contentMatch.defaultType)===null||d===void 0?void 0:d.create();m&&(l.insert(h,m),l.setSelection(ut.create(l.doc,h+1)))}l.scrollIntoView()}return!0}).run()}}},addInputRules(){return[Zye({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),$ve=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,zve=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,Uve=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,Vve=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,Hve=uu.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",xa(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[eh({find:$ve,type:this.type}),eh({find:Uve,type:this.type})]},addPasteRules(){return[th({find:zve,type:this.type}),th({find:Vve,type:this.type})]}}),Wve=Gi.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",xa(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),qve="listItem",_M="textStyle",AM=/^(\d+)\.\s$/,Gve=Gi.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:n,...r}=t;return n===1?["ol",xa(this.options.HTMLAttributes,r),0]:["ol",xa(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:n})=>this.options.keepAttributes?n().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(qve,this.editor.getAttributes(_M)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=Fp({find:AM,type:this.type,getAttributes:n=>({start:+n[1]}),joinPredicate:(n,r)=>r.childCount+r.attrs.start===+n[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Fp({find:AM,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:n=>({start:+n[1],...this.editor.getAttributes(_M)}),joinPredicate:(n,r)=>r.childCount+r.attrs.start===+n[1],editor:this.editor})),[t]}}),Kve=Gi.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",xa(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Yve=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,Xve=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,Qve=uu.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",xa(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[eh({find:Yve,type:this.type})]},addPasteRules(){return[th({find:Xve,type:this.type})]}}),Zve=Gi.create({name:"text",group:"inline"});qs.create({name:"starterKit",addExtensions(){const t=[];return this.options.bold!==!1&&t.push(ive.configure(this.options.bold)),this.options.blockquote!==!1&&t.push(tve.configure(this.options.blockquote)),this.options.bulletList!==!1&&t.push(lve.configure(this.options.bulletList)),this.options.code!==!1&&t.push(uve.configure(this.options.code)),this.options.codeBlock!==!1&&t.push(mve.configure(this.options.codeBlock)),this.options.document!==!1&&t.push(pve.configure(this.options.document)),this.options.dropcursor!==!1&&t.push(yve.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&t.push(_ve.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&t.push(Ave.configure(this.options.hardBreak)),this.options.heading!==!1&&t.push(Eve.configure(this.options.heading)),this.options.history!==!1&&t.push(Bve.configure(this.options.history)),this.options.horizontalRule!==!1&&t.push(Fve.configure(this.options.horizontalRule)),this.options.italic!==!1&&t.push(Hve.configure(this.options.italic)),this.options.listItem!==!1&&t.push(Wve.configure(this.options.listItem)),this.options.orderedList!==!1&&t.push(Gve.configure(this.options.orderedList)),this.options.paragraph!==!1&&t.push(Kve.configure(this.options.paragraph)),this.options.strike!==!1&&t.push(Qve.configure(this.options.strike)),this.options.text!==!1&&t.push(Zve.configure(this.options.text)),t}});var Jve=20,mz=(t,n=0)=>{const r=[];return!t.children.length||n>Jve||Array.from(t.children).forEach(s=>{s.tagName==="SPAN"?r.push(s):s.children.length&&r.push(...mz(s,n+1))}),r},ebe=t=>{if(!t.children.length)return;const n=mz(t);n&&n.forEach(r=>{var s,i;const o=r.getAttribute("style"),l=(i=(s=r.parentElement)==null?void 0:s.closest("span"))==null?void 0:i.getAttribute("style");r.setAttribute("style",`${l};${o}`)})},tbe=vE.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!0}},parseHTML(){return[{tag:"span",consuming:!1,getAttrs:t=>t.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&ebe(t),{}):!1}]},renderHTML({HTMLAttributes:t}){return["span",Zc(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleTextStyle:t=>({commands:n})=>n.toggleMark(this.name,t),removeEmptyTextStyle:()=>({tr:t})=>{const{selection:n}=t;return t.doc.nodesBetween(n.from,n.to,(r,s)=>{if(r.isTextblock)return!0;r.marks.filter(i=>i.type===this.type).some(i=>Object.values(i.attrs).some(o=>!!o))||t.removeMark(s,s+r.nodeSize,this.type)}),!0}}}}),nbe=bs.create({name:"backgroundColor",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,parseHTML:t=>{var n;const r=t.getAttribute("style");if(r){const s=r.split(";").map(i=>i.trim()).filter(Boolean);for(let i=s.length-1;i>=0;i-=1){const o=s[i].split(":");if(o.length>=2){const l=o[0].trim().toLowerCase(),c=o.slice(1).join(":").trim();if(l==="background-color")return c.replace(/['"]+/g,"")}}}return(n=t.style.backgroundColor)==null?void 0:n.replace(/['"]+/g,"")},renderHTML:t=>t.backgroundColor?{style:`background-color: ${t.backgroundColor}`}:{}}}}]},addCommands(){return{setBackgroundColor:t=>({chain:n})=>n().setMark("textStyle",{backgroundColor:t}).run(),unsetBackgroundColor:()=>({chain:t})=>t().setMark("textStyle",{backgroundColor:null}).removeEmptyTextStyle().run()}}}),rbe=bs.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:t=>{var n;const r=t.getAttribute("style");if(r){const s=r.split(";").map(i=>i.trim()).filter(Boolean);for(let i=s.length-1;i>=0;i-=1){const o=s[i].split(":");if(o.length>=2){const l=o[0].trim().toLowerCase(),c=o.slice(1).join(":").trim();if(l==="color")return c.replace(/['"]+/g,"")}}}return(n=t.style.color)==null?void 0:n.replace(/['"]+/g,"")},renderHTML:t=>t.color?{style:`color: ${t.color}`}:{}}}}]},addCommands(){return{setColor:t=>({chain:n})=>n().setMark("textStyle",{color:t}).run(),unsetColor:()=>({chain:t})=>t().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),sbe=bs.create({name:"fontFamily",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:t=>t.style.fontFamily,renderHTML:t=>t.fontFamily?{style:`font-family: ${t.fontFamily}`}:{}}}}]},addCommands(){return{setFontFamily:t=>({chain:n})=>n().setMark("textStyle",{fontFamily:t}).run(),unsetFontFamily:()=>({chain:t})=>t().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}}}),abe=bs.create({name:"fontSize",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:t=>t.style.fontSize,renderHTML:t=>t.fontSize?{style:`font-size: ${t.fontSize}`}:{}}}}]},addCommands(){return{setFontSize:t=>({chain:n})=>n().setMark("textStyle",{fontSize:t}).run(),unsetFontSize:()=>({chain:t})=>t().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()}}}),ibe=bs.create({name:"lineHeight",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{lineHeight:{default:null,parseHTML:t=>t.style.lineHeight,renderHTML:t=>t.lineHeight?{style:`line-height: ${t.lineHeight}`}:{}}}}]},addCommands(){return{setLineHeight:t=>({chain:n})=>n().setMark("textStyle",{lineHeight:t}).run(),unsetLineHeight:()=>({chain:t})=>t().setMark("textStyle",{lineHeight:null}).removeEmptyTextStyle().run()}}});bs.create({name:"textStyleKit",addExtensions(){const t=[];return this.options.backgroundColor!==!1&&t.push(nbe.configure(this.options.backgroundColor)),this.options.color!==!1&&t.push(rbe.configure(this.options.color)),this.options.fontFamily!==!1&&t.push(sbe.configure(this.options.fontFamily)),this.options.fontSize!==!1&&t.push(abe.configure(this.options.fontSize)),this.options.lineHeight!==!1&&t.push(ibe.configure(this.options.lineHeight)),this.options.textStyle!==!1&&t.push(tbe.configure(this.options.textStyle)),t}});vE.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",Zc(this.options.HTMLAttributes,t),0]},parseMarkdown(t,n){return n.applyMark(this.name||"underline",n.parseInline(t.tokens||[]))},renderMarkdown(t,n){return`++${n.renderChildren(t)}++`},markdownTokenizer:{name:"underline",level:"inline",start(t){return t.indexOf("++")},tokenize(t,n,r){const i=/^(\+\+)([\s\S]+?)(\+\+)/.exec(t);if(!i)return;const o=i[2].trim();return{type:"underline",raw:i[0],text:o,tokens:r.inlineTokens(o)}}},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});var obe=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,lbe=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g;vE.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:t=>t.getAttribute("data-color")||t.style.backgroundColor,renderHTML:t=>t.color?{"data-color":t.color,style:`background-color: ${t.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:t}){return["mark",Zc(this.options.HTMLAttributes,t),0]},renderMarkdown:(t,n)=>`==${n.renderChildren(t)}==`,parseMarkdown:(t,n)=>n.applyMark("highlight",n.parseInline(t.tokens||[])),markdownTokenizer:{name:"highlight",level:"inline",start:t=>t.indexOf("=="),tokenize(t,n,r){const i=/^(==)([^=]+)(==)/.exec(t);if(i){const o=i[2].trim(),l=r.inlineTokens(o);return{type:"highlight",raw:i[0],text:o,tokens:l}}}},addCommands(){return{setHighlight:t=>({commands:n})=>n.setMark(this.name,t),toggleHighlight:t=>({commands:n})=>n.toggleMark(this.name,t),unsetHighlight:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[h1e({find:obe,type:this.type})]},addPasteRules(){return[C1e({find:lbe,type:this.type})]}});bs.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:null}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:t=>{const n=t.style.textAlign;return this.options.alignments.includes(n)?n:this.options.defaultAlignment},renderHTML:t=>t.textAlign?{style:`text-align: ${t.textAlign}`}:{}}}}]},addCommands(){return{setTextAlign:t=>({commands:n})=>this.options.alignments.includes(t)?this.options.types.map(r=>n.updateAttributes(r,{textAlign:t})).every(r=>r):!1,unsetTextAlign:()=>({commands:t})=>this.options.types.map(n=>t.resetAttributes(n,"textAlign")).every(n=>n),toggleTextAlign:t=>({editor:n,commands:r})=>this.options.alignments.includes(t)?n.isActive({textAlign:t})?r.unsetTextAlign():r.setTextAlign(t):!1}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}});var cbe=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/;wx.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{},resize:!1}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null},width:{default:null},height:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:t}){return["img",Zc(this.options.HTMLAttributes,t)]},parseMarkdown:(t,n)=>n.createNode("image",{src:t.href,title:t.title,alt:t.text}),renderMarkdown:t=>{var n,r,s,i,o,l;const c=(r=(n=t.attrs)==null?void 0:n.src)!=null?r:"",d=(i=(s=t.attrs)==null?void 0:s.alt)!=null?i:"",u=(l=(o=t.attrs)==null?void 0:o.title)!=null?l:"";return u?`![${d}](${c} "${u}")`:`![${d}](${c})`},addNodeView(){if(!this.options.resize||!this.options.resize.enabled||typeof document>"u"||!this.editor.isEditable)return null;const{directions:t,minWidth:n,minHeight:r,alwaysPreserveAspectRatio:s}=this.options.resize;return({node:i,getPos:o,HTMLAttributes:l})=>{const c=document.createElement("img");Object.entries(l).forEach(([h,m])=>{if(m!=null)switch(h){case"width":case"height":break;default:c.setAttribute(h,m);break}}),c.src=l.src;const d=new x1e({element:c,node:i,getPos:o,onResize:(h,m)=>{c.style.width=`${h}px`,c.style.height=`${m}px`},onCommit:(h,m)=>{const g=o();g!==void 0&&this.editor.chain().setNodeSelection(g).updateAttributes(this.name,{width:h,height:m}).run()},onUpdate:(h,m,g)=>h.type===i.type,options:{directions:t,min:{width:n,height:r},preserveAspectRatio:s===!0}}),u=d.dom;return u.style.visibility="hidden",u.style.pointerEvents="none",c.onload=()=>{u.style.visibility="",u.style.pointerEvents=""},d}},addCommands(){return{setImage:t=>({commands:n})=>n.insertContent({type:this.name,attrs:t})}},addInputRules(){return[m1e({find:cbe,type:this.type,getAttributes:t=>{const[,,n,r,s]=t;return{src:r,alt:n,title:s}}})]}});var BS,FS;if(typeof WeakMap<"u"){let t=new WeakMap;BS=n=>t.get(n),FS=(n,r)=>(t.set(n,r),r)}else{const t=[];let r=0;BS=s=>{for(let i=0;i<t.length;i+=2)if(t[i]==s)return t[i+1]},FS=(s,i)=>(r==10&&(r=0),t[r++]=s,t[r++]=i)}var cr=class{constructor(t,n,r,s){this.width=t,this.height=n,this.map=r,this.problems=s}findCell(t){for(let n=0;n<this.map.length;n++){const r=this.map[n];if(r!=t)continue;const s=n%this.width,i=n/this.width|0;let o=s+1,l=i+1;for(let c=1;o<this.width&&this.map[n+c]==r;c++)o++;for(let c=1;l<this.height&&this.map[n+this.width*c]==r;c++)l++;return{left:s,top:i,right:o,bottom:l}}throw new RangeError(`No cell with offset ${t} found`)}colCount(t){for(let n=0;n<this.map.length;n++)if(this.map[n]==t)return n%this.width;throw new RangeError(`No cell with offset ${t} found`)}nextCell(t,n,r){const{left:s,right:i,top:o,bottom:l}=this.findCell(t);return n=="horiz"?(r<0?s==0:i==this.width)?null:this.map[o*this.width+(r<0?s-1:i)]:(r<0?o==0:l==this.height)?null:this.map[s+this.width*(r<0?o-1:l)]}rectBetween(t,n){const{left:r,right:s,top:i,bottom:o}=this.findCell(t),{left:l,right:c,top:d,bottom:u}=this.findCell(n);return{left:Math.min(r,l),top:Math.min(i,d),right:Math.max(s,c),bottom:Math.max(o,u)}}cellsInRect(t){const n=[],r={};for(let s=t.top;s<t.bottom;s++)for(let i=t.left;i<t.right;i++){const o=s*this.width+i,l=this.map[o];r[l]||(r[l]=!0,!(i==t.left&&i&&this.map[o-1]==l||s==t.top&&s&&this.map[o-this.width]==l)&&n.push(l))}return n}positionAt(t,n,r){for(let s=0,i=0;;s++){const o=i+r.child(s).nodeSize;if(s==t){let l=n+t*this.width;const c=(t+1)*this.width;for(;l<c&&this.map[l]<i;)l++;return l==c?o-1:this.map[l]}i=o}}static get(t){return BS(t)||FS(t,dbe(t))}};function dbe(t){if(t.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+t.type.name);const n=ube(t),r=t.childCount,s=[];let i=0,o=null;const l=[];for(let u=0,h=n*r;u<h;u++)s[u]=0;for(let u=0,h=0;u<r;u++){const m=t.child(u);h++;for(let N=0;;N++){for(;i<s.length&&s[i]!=0;)i++;if(N==m.childCount)break;const j=m.child(N),{colspan:S,rowspan:_,colwidth:A}=j.attrs;for(let k=0;k<_;k++){if(k+u>=r){(o||(o=[])).push({type:"overlong_rowspan",pos:h,n:_-k});break}const T=i+k*n;for(let P=0;P<S;P++){s[T+P]==0?s[T+P]=h:(o||(o=[])).push({type:"collision",row:u,pos:h,n:S-P});const M=A&&A[P];if(M){const O=(T+P)%n*2,D=l[O];D==null||D!=M&&l[O+1]==1?(l[O]=M,l[O+1]=1):D==M&&l[O+1]++}}}i+=S,h+=j.nodeSize}const g=(u+1)*n;let y=0;for(;i<g;)s[i++]==0&&y++;y&&(o||(o=[])).push({type:"missing",row:u,n:y}),h++}(n===0||r===0)&&(o||(o=[])).push({type:"zero_sized"});const c=new cr(n,r,s,o);let d=!1;for(let u=0;!d&&u<l.length;u+=2)l[u]!=null&&l[u+1]<r&&(d=!0);return d&&fbe(c,l,t),c}function ube(t){let n=-1,r=!1;for(let s=0;s<t.childCount;s++){const i=t.child(s);let o=0;if(r)for(let l=0;l<s;l++){const c=t.child(l);for(let d=0;d<c.childCount;d++){const u=c.child(d);l+u.attrs.rowspan>s&&(o+=u.attrs.colspan)}}for(let l=0;l<i.childCount;l++){const c=i.child(l);o+=c.attrs.colspan,c.attrs.rowspan>1&&(r=!0)}n==-1?n=o:n!=o&&(n=Math.max(n,o))}return n}function fbe(t,n,r){t.problems||(t.problems=[]);const s={};for(let i=0;i<t.map.length;i++){const o=t.map[i];if(s[o])continue;s[o]=!0;const l=r.nodeAt(o);if(!l)throw new RangeError(`No cell with offset ${o} found`);let c=null;const d=l.attrs;for(let u=0;u<d.colspan;u++){const h=(i+u)%t.width,m=n[h*2];m!=null&&(!d.colwidth||d.colwidth[u]!=m)&&((c||(c=hbe(d)))[u]=m)}c&&t.problems.unshift({type:"colwidth mismatch",pos:o,colwidth:c})}}function hbe(t){if(t.colwidth)return t.colwidth.slice();const n=[];for(let r=0;r<t.colspan;r++)n.push(0);return n}function Ls(t){let n=t.cached.tableNodeTypes;if(!n){n=t.cached.tableNodeTypes={};for(const r in t.nodes){const s=t.nodes[r],i=s.spec.tableRole;i&&(n[i]=s)}}return n}var rc=new Er("selectingCells");function Ah(t){for(let n=t.depth-1;n>0;n--)if(t.node(n).type.spec.tableRole=="row")return t.node(0).resolve(t.before(n+1));return null}function mbe(t){for(let n=t.depth;n>0;n--){const r=t.node(n).type.spec.tableRole;if(r==="cell"||r==="header_cell")return t.node(n)}return null}function Ki(t){const n=t.selection.$head;for(let r=n.depth;r>0;r--)if(n.node(r).type.spec.tableRole=="row")return!0;return!1}function qv(t){const n=t.selection;if("$anchorCell"in n&&n.$anchorCell)return n.$anchorCell.pos>n.$headCell.pos?n.$anchorCell:n.$headCell;if("node"in n&&n.node&&n.node.type.spec.tableRole=="cell")return n.$anchor;const r=Ah(n.$head)||pbe(n.$head);if(r)return r;throw new RangeError(`No cell found around position ${n.head}`)}function pbe(t){for(let n=t.nodeAfter,r=t.pos;n;n=n.firstChild,r++){const s=n.type.spec.tableRole;if(s=="cell"||s=="header_cell")return t.doc.resolve(r)}for(let n=t.nodeBefore,r=t.pos;n;n=n.lastChild,r--){const s=n.type.spec.tableRole;if(s=="cell"||s=="header_cell")return t.doc.resolve(r-n.nodeSize)}}function $S(t){return t.parent.type.spec.tableRole=="row"&&!!t.nodeAfter}function xbe(t){return t.node(0).resolve(t.pos+t.nodeAfter.nodeSize)}function AE(t,n){return t.depth==n.depth&&t.pos>=n.start(-1)&&t.pos<=n.end(-1)}function pz(t,n,r){const s=t.node(-1),i=cr.get(s),o=t.start(-1),l=i.nextCell(t.pos-o,n,r);return l==null?null:t.node(0).resolve(o+l)}function fu(t,n,r=1){const s={...t,colspan:t.colspan-r};return s.colwidth&&(s.colwidth=s.colwidth.slice(),s.colwidth.splice(n,r),s.colwidth.some(i=>i>0)||(s.colwidth=null)),s}function xz(t,n,r=1){const s={...t,colspan:t.colspan+r};if(s.colwidth){s.colwidth=s.colwidth.slice();for(let i=0;i<r;i++)s.colwidth.splice(n,0,0)}return s}function gbe(t,n,r){const s=Ls(n.type.schema).header_cell;for(let i=0;i<t.height;i++)if(n.nodeAt(t.map[r+i*t.width]).type!=s)return!1;return!0}var Tn=class Go extends bt{constructor(n,r=n){const s=n.node(-1),i=cr.get(s),o=n.start(-1),l=i.rectBetween(n.pos-o,r.pos-o),c=n.node(0),d=i.cellsInRect(l).filter(h=>h!=r.pos-o);d.unshift(r.pos-o);const u=d.map(h=>{const m=s.nodeAt(h);if(!m)throw RangeError(`No cell with offset ${h} found`);const g=o+h+1;return new GF(c.resolve(g),c.resolve(g+m.content.size))});super(u[0].$from,u[0].$to,u),this.$anchorCell=n,this.$headCell=r}map(n,r){const s=n.resolve(r.map(this.$anchorCell.pos)),i=n.resolve(r.map(this.$headCell.pos));if($S(s)&&$S(i)&&AE(s,i)){const o=this.$anchorCell.node(-1)!=s.node(-1);return o&&this.isRowSelection()?Go.rowSelection(s,i):o&&this.isColSelection()?Go.colSelection(s,i):new Go(s,i)}return ut.between(s,i)}content(){const n=this.$anchorCell.node(-1),r=cr.get(n),s=this.$anchorCell.start(-1),i=r.rectBetween(this.$anchorCell.pos-s,this.$headCell.pos-s),o={},l=[];for(let d=i.top;d<i.bottom;d++){const u=[];for(let h=d*r.width+i.left,m=i.left;m<i.right;m++,h++){const g=r.map[h];if(o[g])continue;o[g]=!0;const y=r.findCell(g);let N=n.nodeAt(g);if(!N)throw RangeError(`No cell with offset ${g} found`);const j=i.left-y.left,S=y.right-i.right;if(j>0||S>0){let _=N.attrs;if(j>0&&(_=fu(_,0,j)),S>0&&(_=fu(_,_.colspan-S,S)),y.left<i.left){if(N=N.type.createAndFill(_),!N)throw RangeError(`Could not create cell with attrs ${JSON.stringify(_)}`)}else N=N.type.create(_,N.content)}if(y.top<i.top||y.bottom>i.bottom){const _={...N.attrs,rowspan:Math.min(y.bottom,i.bottom)-Math.max(y.top,i.top)};y.top<i.top?N=N.type.createAndFill(_):N=N.type.create(_,N.content)}u.push(N)}l.push(n.child(d).copy(Pe.from(u)))}const c=this.isColSelection()&&this.isRowSelection()?n:l;return new Qe(Pe.from(c),1,1)}replace(n,r=Qe.empty){const s=n.steps.length,i=this.ranges;for(let l=0;l<i.length;l++){const{$from:c,$to:d}=i[l],u=n.mapping.slice(s);n.replace(u.map(c.pos),u.map(d.pos),l?Qe.empty:r)}const o=bt.findFrom(n.doc.resolve(n.mapping.slice(s).map(this.to)),-1);o&&n.setSelection(o)}replaceWith(n,r){this.replace(n,new Qe(Pe.from(r),0,0))}forEachCell(n){const r=this.$anchorCell.node(-1),s=cr.get(r),i=this.$anchorCell.start(-1),o=s.cellsInRect(s.rectBetween(this.$anchorCell.pos-i,this.$headCell.pos-i));for(let l=0;l<o.length;l++)n(r.nodeAt(o[l]),i+o[l])}isColSelection(){const n=this.$anchorCell.index(-1),r=this.$headCell.index(-1);if(Math.min(n,r)>0)return!1;const s=n+this.$anchorCell.nodeAfter.attrs.rowspan,i=r+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(s,i)==this.$headCell.node(-1).childCount}static colSelection(n,r=n){const s=n.node(-1),i=cr.get(s),o=n.start(-1),l=i.findCell(n.pos-o),c=i.findCell(r.pos-o),d=n.node(0);return l.top<=c.top?(l.top>0&&(n=d.resolve(o+i.map[l.left])),c.bottom<i.height&&(r=d.resolve(o+i.map[i.width*(i.height-1)+c.right-1]))):(c.top>0&&(r=d.resolve(o+i.map[c.left])),l.bottom<i.height&&(n=d.resolve(o+i.map[i.width*(i.height-1)+l.right-1]))),new Go(n,r)}isRowSelection(){const n=this.$anchorCell.node(-1),r=cr.get(n),s=this.$anchorCell.start(-1),i=r.colCount(this.$anchorCell.pos-s),o=r.colCount(this.$headCell.pos-s);if(Math.min(i,o)>0)return!1;const l=i+this.$anchorCell.nodeAfter.attrs.colspan,c=o+this.$headCell.nodeAfter.attrs.colspan;return Math.max(l,c)==r.width}eq(n){return n instanceof Go&&n.$anchorCell.pos==this.$anchorCell.pos&&n.$headCell.pos==this.$headCell.pos}static rowSelection(n,r=n){const s=n.node(-1),i=cr.get(s),o=n.start(-1),l=i.findCell(n.pos-o),c=i.findCell(r.pos-o),d=n.node(0);return l.left<=c.left?(l.left>0&&(n=d.resolve(o+i.map[l.top*i.width])),c.right<i.width&&(r=d.resolve(o+i.map[i.width*(c.top+1)-1]))):(c.left>0&&(r=d.resolve(o+i.map[c.top*i.width])),l.right<i.width&&(n=d.resolve(o+i.map[i.width*(l.top+1)-1]))),new Go(n,r)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(n,r){return new Go(n.resolve(r.anchor),n.resolve(r.head))}static create(n,r,s=r){return new Go(n.resolve(r),n.resolve(s))}getBookmark(){return new ybe(this.$anchorCell.pos,this.$headCell.pos)}};Tn.prototype.visible=!1;bt.jsonID("cell",Tn);var ybe=class gz{constructor(n,r){this.anchor=n,this.head=r}map(n){return new gz(n.map(this.anchor),n.map(this.head))}resolve(n){const r=n.resolve(this.anchor),s=n.resolve(this.head);return r.parent.type.spec.tableRole=="row"&&s.parent.type.spec.tableRole=="row"&&r.index()<r.parent.childCount&&s.index()<s.parent.childCount&&AE(r,s)?new Tn(r,s):bt.near(s,1)}};function vbe(t){if(!(t.selection instanceof Tn))return null;const n=[];return t.selection.forEachCell((r,s)=>{n.push(Ia.node(s,s+r.nodeSize,{class:"selectedCell"}))}),pr.create(t.doc,n)}function bbe({$from:t,$to:n}){if(t.pos==n.pos||t.pos<n.pos-6)return!1;let r=t.pos,s=n.pos,i=t.depth;for(;i>=0&&!(t.after(i+1)<t.end(i));i--,r++);for(let o=n.depth;o>=0&&!(n.before(o+1)>n.start(o));o--,s--);return r==s&&/row|table/.test(t.node(i).type.spec.tableRole)}function wbe({$from:t,$to:n}){let r,s;for(let i=t.depth;i>0;i--){const o=t.node(i);if(o.type.spec.tableRole==="cell"||o.type.spec.tableRole==="header_cell"){r=o;break}}for(let i=n.depth;i>0;i--){const o=n.node(i);if(o.type.spec.tableRole==="cell"||o.type.spec.tableRole==="header_cell"){s=o;break}}return r!==s&&n.parentOffset===0}function Nbe(t,n,r){const s=(n||t).selection,i=(n||t).doc;let o,l;if(s instanceof xt&&(l=s.node.type.spec.tableRole)){if(l=="cell"||l=="header_cell")o=Tn.create(i,s.from);else if(l=="row"){const c=i.resolve(s.from+1);o=Tn.rowSelection(c,c)}else if(!r){const c=cr.get(s.node),d=s.from+1,u=d+c.map[c.width*c.height-1];o=Tn.create(i,d+1,u)}}else s instanceof ut&&bbe(s)?o=ut.create(i,s.from):s instanceof ut&&wbe(s)&&(o=ut.create(i,s.$from.start(),s.$from.end()));return o&&(n||(n=t.tr)).setSelection(o),n}var jbe=new Er("fix-tables");function yz(t,n,r,s){const i=t.childCount,o=n.childCount;e:for(let l=0,c=0;l<o;l++){const d=n.child(l);for(let u=c,h=Math.min(i,l+3);u<h;u++)if(t.child(u)==d){c=u+1,r+=d.nodeSize;continue e}s(d,r),c<i&&t.child(c).sameMarkup(d)?yz(t.child(c),d,r+1,s):d.nodesBetween(0,d.content.size,s,r+1),r+=d.nodeSize}}function vz(t,n){let r;const s=(i,o)=>{i.type.spec.tableRole=="table"&&(r=Sbe(t,i,o,r))};return n?n.doc!=t.doc&&yz(n.doc,t.doc,0,s):t.doc.descendants(s),r}function Sbe(t,n,r,s){const i=cr.get(n);if(!i.problems)return s;s||(s=t.tr);const o=[];for(let d=0;d<i.height;d++)o.push(0);for(let d=0;d<i.problems.length;d++){const u=i.problems[d];if(u.type=="collision"){const h=n.nodeAt(u.pos);if(!h)continue;const m=h.attrs;for(let g=0;g<m.rowspan;g++)o[u.row+g]+=u.n;s.setNodeMarkup(s.mapping.map(r+1+u.pos),null,fu(m,m.colspan-u.n,u.n))}else if(u.type=="missing")o[u.row]+=u.n;else if(u.type=="overlong_rowspan"){const h=n.nodeAt(u.pos);if(!h)continue;s.setNodeMarkup(s.mapping.map(r+1+u.pos),null,{...h.attrs,rowspan:h.attrs.rowspan-u.n})}else if(u.type=="colwidth mismatch"){const h=n.nodeAt(u.pos);if(!h)continue;s.setNodeMarkup(s.mapping.map(r+1+u.pos),null,{...h.attrs,colwidth:u.colwidth})}else if(u.type=="zero_sized"){const h=s.mapping.map(r);s.delete(h,h+n.nodeSize)}}let l,c;for(let d=0;d<o.length;d++)o[d]&&(l==null&&(l=d),c=d);for(let d=0,u=r+1;d<i.height;d++){const h=n.child(d),m=u+h.nodeSize,g=o[d];if(g>0){let y="cell";h.firstChild&&(y=h.firstChild.type.spec.tableRole);const N=[];for(let S=0;S<g;S++){const _=Ls(t.schema)[y].createAndFill();_&&N.push(_)}const j=(d==0||l==d-1)&&c==d?u+1:m-1;s.insert(s.mapping.map(j),N)}u=m}return s.setMeta(jbe,{fixTables:!0})}function Bo(t){const n=t.selection,r=qv(t),s=r.node(-1),i=r.start(-1),o=cr.get(s);return{...n instanceof Tn?o.rectBetween(n.$anchorCell.pos-i,n.$headCell.pos-i):o.findCell(r.pos-i),tableStart:i,map:o,table:s}}function bz(t,{map:n,tableStart:r,table:s},i){let o=i>0?-1:0;gbe(n,s,i+o)&&(o=i==0||i==n.width?null:0);for(let l=0;l<n.height;l++){const c=l*n.width+i;if(i>0&&i<n.width&&n.map[c-1]==n.map[c]){const d=n.map[c],u=s.nodeAt(d);t.setNodeMarkup(t.mapping.map(r+d),null,xz(u.attrs,i-n.colCount(d))),l+=u.attrs.rowspan-1}else{const d=o==null?Ls(s.type.schema).cell:s.nodeAt(n.map[c+o]).type,u=n.positionAt(l,i,s);t.insert(t.mapping.map(r+u),d.createAndFill())}}return t}function Cbe(t,n){if(!Ki(t))return!1;if(n){const r=Bo(t);n(bz(t.tr,r,r.left))}return!0}function _be(t,n){if(!Ki(t))return!1;if(n){const r=Bo(t);n(bz(t.tr,r,r.right))}return!0}function Abe(t,{map:n,table:r,tableStart:s},i){const o=t.mapping.maps.length;for(let l=0;l<n.height;){const c=l*n.width+i,d=n.map[c],u=r.nodeAt(d),h=u.attrs;if(i>0&&n.map[c-1]==d||i<n.width-1&&n.map[c+1]==d)t.setNodeMarkup(t.mapping.slice(o).map(s+d),null,fu(h,i-n.colCount(d)));else{const m=t.mapping.slice(o).map(s+d);t.delete(m,m+u.nodeSize)}l+=h.rowspan}}function Ebe(t,n){if(!Ki(t))return!1;if(n){const r=Bo(t),s=t.tr;if(r.left==0&&r.right==r.map.width)return!1;for(let i=r.right-1;Abe(s,r,i),i!=r.left;i--){const o=r.tableStart?s.doc.nodeAt(r.tableStart-1):s.doc;if(!o)throw RangeError("No table found");r.table=o,r.map=cr.get(o)}n(s)}return!0}function kbe(t,n,r){var s;const i=Ls(n.type.schema).header_cell;for(let o=0;o<t.width;o++)if(((s=n.nodeAt(t.map[o+r*t.width]))==null?void 0:s.type)!=i)return!1;return!0}function wz(t,{map:n,tableStart:r,table:s},i){var o;let l=r;for(let u=0;u<i;u++)l+=s.child(u).nodeSize;const c=[];let d=i>0?-1:0;kbe(n,s,i+d)&&(d=i==0||i==n.height?null:0);for(let u=0,h=n.width*i;u<n.width;u++,h++)if(i>0&&i<n.height&&n.map[h]==n.map[h-n.width]){const m=n.map[h],g=s.nodeAt(m).attrs;t.setNodeMarkup(r+m,null,{...g,rowspan:g.rowspan+1}),u+=g.colspan-1}else{const m=d==null?Ls(s.type.schema).cell:(o=s.nodeAt(n.map[h+d*n.width]))==null?void 0:o.type,g=m==null?void 0:m.createAndFill();g&&c.push(g)}return t.insert(l,Ls(s.type.schema).row.create(null,c)),t}function Tbe(t,n){if(!Ki(t))return!1;if(n){const r=Bo(t);n(wz(t.tr,r,r.top))}return!0}function Ibe(t,n){if(!Ki(t))return!1;if(n){const r=Bo(t);n(wz(t.tr,r,r.bottom))}return!0}function Pbe(t,{map:n,table:r,tableStart:s},i){let o=0;for(let u=0;u<i;u++)o+=r.child(u).nodeSize;const l=o+r.child(i).nodeSize,c=t.mapping.maps.length;t.delete(o+s,l+s);const d=new Set;for(let u=0,h=i*n.width;u<n.width;u++,h++){const m=n.map[h];if(!d.has(m)){if(d.add(m),i>0&&m==n.map[h-n.width]){const g=r.nodeAt(m).attrs;t.setNodeMarkup(t.mapping.slice(c).map(m+s),null,{...g,rowspan:g.rowspan-1}),u+=g.colspan-1}else if(i<n.height&&m==n.map[h+n.width]){const g=r.nodeAt(m),y=g.attrs,N=g.type.create({...y,rowspan:g.attrs.rowspan-1},g.content),j=n.positionAt(i+1,u,r);t.insert(t.mapping.slice(c).map(s+j),N),u+=y.colspan-1}}}}function Mbe(t,n){if(!Ki(t))return!1;if(n){const r=Bo(t),s=t.tr;if(r.top==0&&r.bottom==r.map.height)return!1;for(let i=r.bottom-1;Pbe(s,r,i),i!=r.top;i--){const o=r.tableStart?s.doc.nodeAt(r.tableStart-1):s.doc;if(!o)throw RangeError("No table found");r.table=o,r.map=cr.get(r.table)}n(s)}return!0}function EM(t){const n=t.content;return n.childCount==1&&n.child(0).isTextblock&&n.child(0).childCount==0}function Obe({width:t,height:n,map:r},s){let i=s.top*t+s.left,o=i,l=(s.bottom-1)*t+s.left,c=i+(s.right-s.left-1);for(let d=s.top;d<s.bottom;d++){if(s.left>0&&r[o]==r[o-1]||s.right<t&&r[c]==r[c+1])return!0;o+=t,c+=t}for(let d=s.left;d<s.right;d++){if(s.top>0&&r[i]==r[i-t]||s.bottom<n&&r[l]==r[l+t])return!0;i++,l++}return!1}function kM(t,n){const r=t.selection;if(!(r instanceof Tn)||r.$anchorCell.pos==r.$headCell.pos)return!1;const s=Bo(t),{map:i}=s;if(Obe(i,s))return!1;if(n){const o=t.tr,l={};let c=Pe.empty,d,u;for(let h=s.top;h<s.bottom;h++)for(let m=s.left;m<s.right;m++){const g=i.map[h*i.width+m],y=s.table.nodeAt(g);if(!(l[g]||!y))if(l[g]=!0,d==null)d=g,u=y;else{EM(y)||(c=c.append(y.content));const N=o.mapping.map(g+s.tableStart);o.delete(N,N+y.nodeSize)}}if(d==null||u==null)return!0;if(o.setNodeMarkup(d+s.tableStart,null,{...xz(u.attrs,u.attrs.colspan,s.right-s.left-u.attrs.colspan),rowspan:s.bottom-s.top}),c.size){const h=d+1+u.content.size,m=EM(u)?d+1:h;o.replaceWith(m+s.tableStart,h+s.tableStart,c)}o.setSelection(new Tn(o.doc.resolve(d+s.tableStart))),n(o)}return!0}function TM(t,n){const r=Ls(t.schema);return Dbe(({node:s})=>r[s.type.spec.tableRole])(t,n)}function Dbe(t){return(n,r)=>{var s;const i=n.selection;let o,l;if(i instanceof Tn){if(i.$anchorCell.pos!=i.$headCell.pos)return!1;o=i.$anchorCell.nodeAfter,l=i.$anchorCell.pos}else{if(o=mbe(i.$from),!o)return!1;l=(s=Ah(i.$from))==null?void 0:s.pos}if(o==null||l==null||o.attrs.colspan==1&&o.attrs.rowspan==1)return!1;if(r){let c=o.attrs;const d=[],u=c.colwidth;c.rowspan>1&&(c={...c,rowspan:1}),c.colspan>1&&(c={...c,colspan:1});const h=Bo(n),m=n.tr;for(let y=0;y<h.right-h.left;y++)d.push(u?{...c,colwidth:u&&u[y]?[u[y]]:null}:c);let g;for(let y=h.top;y<h.bottom;y++){let N=h.map.positionAt(y,h.left,h.table);y==h.top&&(N+=o.nodeSize);for(let j=h.left,S=0;j<h.right;j++,S++)j==h.left&&y==h.top||m.insert(g=m.mapping.map(N+h.tableStart,1),t({node:o,row:y,col:j}).createAndFill(d[S]))}m.setNodeMarkup(l,t({node:o,row:h.top,col:h.left}),d[0]),i instanceof Tn&&m.setSelection(new Tn(m.doc.resolve(i.$anchorCell.pos),g?m.doc.resolve(g):void 0)),r(m)}return!0}}function Rbe(t,n){return function(r,s){if(!Ki(r))return!1;const i=qv(r);if(i.nodeAfter.attrs[t]===n)return!1;if(s){const o=r.tr;r.selection instanceof Tn?r.selection.forEachCell((l,c)=>{l.attrs[t]!==n&&o.setNodeMarkup(c,null,{...l.attrs,[t]:n})}):o.setNodeMarkup(i.pos,null,{...i.nodeAfter.attrs,[t]:n}),s(o)}return!0}}function Lbe(t){return function(n,r){if(!Ki(n))return!1;if(r){const s=Ls(n.schema),i=Bo(n),o=n.tr,l=i.map.cellsInRect(t=="column"?{left:i.left,top:0,right:i.right,bottom:i.map.height}:t=="row"?{left:0,top:i.top,right:i.map.width,bottom:i.bottom}:i),c=l.map(d=>i.table.nodeAt(d));for(let d=0;d<l.length;d++)c[d].type==s.header_cell&&o.setNodeMarkup(i.tableStart+l[d],s.cell,c[d].attrs);if(o.steps.length==0)for(let d=0;d<l.length;d++)o.setNodeMarkup(i.tableStart+l[d],s.header_cell,c[d].attrs);r(o)}return!0}}function IM(t,n,r){const s=n.map.cellsInRect({left:0,top:0,right:t=="row"?n.map.width:1,bottom:t=="column"?n.map.height:1});for(let i=0;i<s.length;i++){const o=n.table.nodeAt(s[i]);if(o&&o.type!==r.header_cell)return!1}return!0}function $p(t,n){return n=n||{useDeprecatedLogic:!1},n.useDeprecatedLogic?Lbe(t):function(r,s){if(!Ki(r))return!1;if(s){const i=Ls(r.schema),o=Bo(r),l=r.tr,c=IM("row",o,i),d=IM("column",o,i),h=(t==="column"?c:t==="row"?d:!1)?1:0,m=t=="column"?{left:0,top:h,right:1,bottom:o.map.height}:t=="row"?{left:h,top:0,right:o.map.width,bottom:1}:o,g=t=="column"?d?i.cell:i.header_cell:t=="row"?c?i.cell:i.header_cell:i.cell;o.map.cellsInRect(m).forEach(y=>{const N=y+o.tableStart,j=l.doc.nodeAt(N);j&&l.setNodeMarkup(N,g,j.attrs)}),s(l)}return!0}}$p("row",{useDeprecatedLogic:!0});$p("column",{useDeprecatedLogic:!0});var Bbe=$p("cell",{useDeprecatedLogic:!0});function Fbe(t,n){if(n<0){const r=t.nodeBefore;if(r)return t.pos-r.nodeSize;for(let s=t.index(-1)-1,i=t.before();s>=0;s--){const o=t.node(-1).child(s),l=o.lastChild;if(l)return i-1-l.nodeSize;i-=o.nodeSize}}else{if(t.index()<t.parent.childCount-1)return t.pos+t.nodeAfter.nodeSize;const r=t.node(-1);for(let s=t.indexAfter(-1),i=t.after();s<r.childCount;s++){const o=r.child(s);if(o.childCount)return i+1;i+=o.nodeSize}}return null}function PM(t){return function(n,r){if(!Ki(n))return!1;const s=Fbe(qv(n),t);if(s==null)return!1;if(r){const i=n.doc.resolve(s);r(n.tr.setSelection(ut.between(i,xbe(i))).scrollIntoView())}return!0}}function $be(t,n){const r=t.selection.$anchor;for(let s=r.depth;s>0;s--)if(r.node(s).type.spec.tableRole=="table")return n&&n(t.tr.delete(r.before(s),r.after(s)).scrollIntoView()),!0;return!1}function L0(t,n){const r=t.selection;if(!(r instanceof Tn))return!1;if(n){const s=t.tr,i=Ls(t.schema).cell.createAndFill().content;r.forEachCell((o,l)=>{o.content.eq(i)||s.replace(s.mapping.map(l+1),s.mapping.map(l+o.nodeSize-1),new Qe(i,0,0))}),s.docChanged&&n(s)}return!0}function zbe(t){if(!t.size)return null;let{content:n,openStart:r,openEnd:s}=t;for(;n.childCount==1&&(r>0&&s>0||n.child(0).type.spec.tableRole=="table");)r--,s--,n=n.child(0).content;const i=n.child(0),o=i.type.spec.tableRole,l=i.type.schema,c=[];if(o=="row")for(let d=0;d<n.childCount;d++){let u=n.child(d).content;const h=d?0:Math.max(0,r-1),m=d<n.childCount-1?0:Math.max(0,s-1);(h||m)&&(u=zS(Ls(l).row,new Qe(u,h,m)).content),c.push(u)}else if(o=="cell"||o=="header_cell")c.push(r||s?zS(Ls(l).row,new Qe(n,r,s)).content:n);else return null;return Ube(l,c)}function Ube(t,n){const r=[];for(let i=0;i<n.length;i++){const o=n[i];for(let l=o.childCount-1;l>=0;l--){const{rowspan:c,colspan:d}=o.child(l).attrs;for(let u=i;u<i+c;u++)r[u]=(r[u]||0)+d}}let s=0;for(let i=0;i<r.length;i++)s=Math.max(s,r[i]);for(let i=0;i<r.length;i++)if(i>=n.length&&n.push(Pe.empty),r[i]<s){const o=Ls(t).cell.createAndFill(),l=[];for(let c=r[i];c<s;c++)l.push(o);n[i]=n[i].append(Pe.from(l))}return{height:n.length,width:s,rows:n}}function zS(t,n){const r=t.createAndFill();return new qF(r).replace(0,r.content.size,n).doc}function Vbe({width:t,height:n,rows:r},s,i){if(t!=s){const o=[],l=[];for(let c=0;c<r.length;c++){const d=r[c],u=[];for(let h=o[c]||0,m=0;h<s;m++){let g=d.child(m%d.childCount);h+g.attrs.colspan>s&&(g=g.type.createChecked(fu(g.attrs,g.attrs.colspan,h+g.attrs.colspan-s),g.content)),u.push(g),h+=g.attrs.colspan;for(let y=1;y<g.attrs.rowspan;y++)o[c+y]=(o[c+y]||0)+g.attrs.colspan}l.push(Pe.from(u))}r=l,t=s}if(n!=i){const o=[];for(let l=0,c=0;l<i;l++,c++){const d=[],u=r[c%n];for(let h=0;h<u.childCount;h++){let m=u.child(h);l+m.attrs.rowspan>i&&(m=m.type.create({...m.attrs,rowspan:Math.max(1,i-m.attrs.rowspan)},m.content)),d.push(m)}o.push(Pe.from(d))}r=o,n=i}return{width:t,height:n,rows:r}}function Hbe(t,n,r,s,i,o,l){const c=t.doc.type.schema,d=Ls(c);let u,h;if(i>n.width)for(let m=0,g=0;m<n.height;m++){const y=r.child(m);g+=y.nodeSize;const N=[];let j;y.lastChild==null||y.lastChild.type==d.cell?j=u||(u=d.cell.createAndFill()):j=h||(h=d.header_cell.createAndFill());for(let S=n.width;S<i;S++)N.push(j);t.insert(t.mapping.slice(l).map(g-1+s),N)}if(o>n.height){const m=[];for(let N=0,j=(n.height-1)*n.width;N<Math.max(n.width,i);N++){const S=N>=n.width?!1:r.nodeAt(n.map[j+N]).type==d.header_cell;m.push(S?h||(h=d.header_cell.createAndFill()):u||(u=d.cell.createAndFill()))}const g=d.row.create(null,Pe.from(m)),y=[];for(let N=n.height;N<o;N++)y.push(g);t.insert(t.mapping.slice(l).map(s+r.nodeSize-2),y)}return!!(u||h)}function MM(t,n,r,s,i,o,l,c){if(l==0||l==n.height)return!1;let d=!1;for(let u=i;u<o;u++){const h=l*n.width+u,m=n.map[h];if(n.map[h-n.width]==m){d=!0;const g=r.nodeAt(m),{top:y,left:N}=n.findCell(m);t.setNodeMarkup(t.mapping.slice(c).map(m+s),null,{...g.attrs,rowspan:l-y}),t.insert(t.mapping.slice(c).map(n.positionAt(l,N,r)),g.type.createAndFill({...g.attrs,rowspan:y+g.attrs.rowspan-l})),u+=g.attrs.colspan-1}}return d}function OM(t,n,r,s,i,o,l,c){if(l==0||l==n.width)return!1;let d=!1;for(let u=i;u<o;u++){const h=u*n.width+l,m=n.map[h];if(n.map[h-1]==m){d=!0;const g=r.nodeAt(m),y=n.colCount(m),N=t.mapping.slice(c).map(m+s);t.setNodeMarkup(N,null,fu(g.attrs,l-y,g.attrs.colspan-(l-y))),t.insert(N+g.nodeSize,g.type.createAndFill(fu(g.attrs,0,l-y))),u+=g.attrs.rowspan-1}}return d}function DM(t,n,r,s,i){let o=r?t.doc.nodeAt(r-1):t.doc;if(!o)throw new Error("No table found");let l=cr.get(o);const{top:c,left:d}=s,u=d+i.width,h=c+i.height,m=t.tr;let g=0;function y(){if(o=r?m.doc.nodeAt(r-1):m.doc,!o)throw new Error("No table found");l=cr.get(o),g=m.mapping.maps.length}Hbe(m,l,o,r,u,h,g)&&y(),MM(m,l,o,r,d,u,c,g)&&y(),MM(m,l,o,r,d,u,h,g)&&y(),OM(m,l,o,r,c,h,d,g)&&y(),OM(m,l,o,r,c,h,u,g)&&y();for(let N=c;N<h;N++){const j=l.positionAt(N,d,o),S=l.positionAt(N,u,o);m.replace(m.mapping.slice(g).map(j+r),m.mapping.slice(g).map(S+r),new Qe(i.rows[N-c],0,0))}y(),m.setSelection(new Tn(m.doc.resolve(r+l.positionAt(c,d,o)),m.doc.resolve(r+l.positionAt(h-1,u-1,o)))),n(m)}var Wbe=B$({ArrowLeft:B0("horiz",-1),ArrowRight:B0("horiz",1),ArrowUp:B0("vert",-1),ArrowDown:B0("vert",1),"Shift-ArrowLeft":F0("horiz",-1),"Shift-ArrowRight":F0("horiz",1),"Shift-ArrowUp":F0("vert",-1),"Shift-ArrowDown":F0("vert",1),Backspace:L0,"Mod-Backspace":L0,Delete:L0,"Mod-Delete":L0});function Og(t,n,r){return r.eq(t.selection)?!1:(n&&n(t.tr.setSelection(r).scrollIntoView()),!0)}function B0(t,n){return(r,s,i)=>{if(!i)return!1;const o=r.selection;if(o instanceof Tn)return Og(r,s,bt.near(o.$headCell,n));if(t!="horiz"&&!o.empty)return!1;const l=Nz(i,t,n);if(l==null)return!1;if(t=="horiz")return Og(r,s,bt.near(r.doc.resolve(o.head+n),n));{const c=r.doc.resolve(l),d=pz(c,t,n);let u;return d?u=bt.near(d,1):n<0?u=bt.near(r.doc.resolve(c.before(-1)),-1):u=bt.near(r.doc.resolve(c.after(-1)),1),Og(r,s,u)}}}function F0(t,n){return(r,s,i)=>{if(!i)return!1;const o=r.selection;let l;if(o instanceof Tn)l=o;else{const d=Nz(i,t,n);if(d==null)return!1;l=new Tn(r.doc.resolve(d))}const c=pz(l.$headCell,t,n);return c?Og(r,s,new Tn(l.$anchorCell,c)):!1}}function qbe(t,n){const r=t.state.doc,s=Ah(r.resolve(n));return s?(t.dispatch(t.state.tr.setSelection(new Tn(s))),!0):!1}function Gbe(t,n,r){if(!Ki(t.state))return!1;let s=zbe(r);const i=t.state.selection;if(i instanceof Tn){s||(s={width:1,height:1,rows:[Pe.from(zS(Ls(t.state.schema).cell,r))]});const o=i.$anchorCell.node(-1),l=i.$anchorCell.start(-1),c=cr.get(o).rectBetween(i.$anchorCell.pos-l,i.$headCell.pos-l);return s=Vbe(s,c.right-c.left,c.bottom-c.top),DM(t.state,t.dispatch,l,c,s),!0}else if(s){const o=qv(t.state),l=o.start(-1);return DM(t.state,t.dispatch,l,cr.get(o.node(-1)).findCell(o.pos-l),s),!0}else return!1}function Kbe(t,n){var r;if(n.ctrlKey||n.metaKey)return;const s=RM(t,n.target);let i;if(n.shiftKey&&t.state.selection instanceof Tn)o(t.state.selection.$anchorCell,n),n.preventDefault();else if(n.shiftKey&&s&&(i=Ah(t.state.selection.$anchor))!=null&&((r=WN(t,n))==null?void 0:r.pos)!=i.pos)o(i,n),n.preventDefault();else if(!s)return;function o(d,u){let h=WN(t,u);const m=rc.getState(t.state)==null;if(!h||!AE(d,h))if(m)h=d;else return;const g=new Tn(d,h);if(m||!t.state.selection.eq(g)){const y=t.state.tr.setSelection(g);m&&y.setMeta(rc,d.pos),t.dispatch(y)}}function l(){t.root.removeEventListener("mouseup",l),t.root.removeEventListener("dragstart",l),t.root.removeEventListener("mousemove",c),rc.getState(t.state)!=null&&t.dispatch(t.state.tr.setMeta(rc,-1))}function c(d){const u=d,h=rc.getState(t.state);let m;if(h!=null)m=t.state.doc.resolve(h);else if(RM(t,u.target)!=s&&(m=WN(t,n),!m))return l();m&&o(m,u)}t.root.addEventListener("mouseup",l),t.root.addEventListener("dragstart",l),t.root.addEventListener("mousemove",c)}function Nz(t,n,r){if(!(t.state.selection instanceof ut))return null;const{$head:s}=t.state.selection;for(let i=s.depth-1;i>=0;i--){const o=s.node(i);if((r<0?s.index(i):s.indexAfter(i))!=(r<0?0:o.childCount))return null;if(o.type.spec.tableRole=="cell"||o.type.spec.tableRole=="header_cell"){const c=s.before(i),d=n=="vert"?r>0?"down":"up":r>0?"right":"left";return t.endOfTextblock(d)?c:null}}return null}function RM(t,n){for(;n&&n!=t.dom;n=n.parentNode)if(n.nodeName=="TD"||n.nodeName=="TH")return n;return null}function WN(t,n){const r=t.posAtCoords({left:n.clientX,top:n.clientY});return r&&r?Ah(t.state.doc.resolve(r.pos)):null}var Ybe=class{constructor(n,r){this.node=n,this.defaultCellMinWidth=r,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width",`${r}px`),this.colgroup=this.table.appendChild(document.createElement("colgroup")),US(n,this.colgroup,this.table,r),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(n){return n.type!=this.node.type?!1:(this.node=n,US(n,this.colgroup,this.table,this.defaultCellMinWidth),!0)}ignoreMutation(n){return n.type=="attributes"&&(n.target==this.table||this.colgroup.contains(n.target))}};function US(t,n,r,s,i,o){var l;let c=0,d=!0,u=n.firstChild;const h=t.firstChild;if(h){for(let m=0,g=0;m<h.childCount;m++){const{colspan:y,colwidth:N}=h.child(m).attrs;for(let j=0;j<y;j++,g++){const S=i==g?o:N&&N[j],_=S?S+"px":"";if(c+=S||s,S||(d=!1),u)u.style.width!=_&&(u.style.width=_),u=u.nextSibling;else{const A=document.createElement("col");A.style.width=_,n.appendChild(A)}}}for(;u;){const m=u.nextSibling;(l=u.parentNode)==null||l.removeChild(u),u=m}d?(r.style.width=c+"px",r.style.minWidth=""):(r.style.width="",r.style.minWidth=c+"px")}}var Aa=new Er("tableColumnResizing");function Xbe({handleWidth:t=5,cellMinWidth:n=25,defaultCellMinWidth:r=100,View:s=Ybe,lastColumnResizable:i=!0}={}){const o=new Ar({key:Aa,state:{init(l,c){var d,u;const h=(u=(d=o.spec)==null?void 0:d.props)==null?void 0:u.nodeViews,m=Ls(c.schema).table.name;return s&&h&&(h[m]=(g,y)=>new s(g,r,y)),new Qbe(-1,!1)},apply(l,c){return c.apply(l)}},props:{attributes:l=>{const c=Aa.getState(l);return c&&c.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(l,c)=>{Zbe(l,c,t,i)},mouseleave:l=>{Jbe(l)},mousedown:(l,c)=>{ewe(l,c,n,r)}},decorations:l=>{const c=Aa.getState(l);if(c&&c.activeHandle>-1)return awe(l,c.activeHandle)},nodeViews:{}}});return o}var Qbe=class Dg{constructor(n,r){this.activeHandle=n,this.dragging=r}apply(n){const r=this,s=n.getMeta(Aa);if(s&&s.setHandle!=null)return new Dg(s.setHandle,!1);if(s&&s.setDragging!==void 0)return new Dg(r.activeHandle,s.setDragging);if(r.activeHandle>-1&&n.docChanged){let i=n.mapping.map(r.activeHandle,-1);return $S(n.doc.resolve(i))||(i=-1),new Dg(i,r.dragging)}return r}};function Zbe(t,n,r,s){if(!t.editable)return;const i=Aa.getState(t.state);if(i&&!i.dragging){const o=nwe(n.target);let l=-1;if(o){const{left:c,right:d}=o.getBoundingClientRect();n.clientX-c<=r?l=LM(t,n,"left",r):d-n.clientX<=r&&(l=LM(t,n,"right",r))}if(l!=i.activeHandle){if(!s&&l!==-1){const c=t.state.doc.resolve(l),d=c.node(-1),u=cr.get(d),h=c.start(-1);if(u.colCount(c.pos-h)+c.nodeAfter.attrs.colspan-1==u.width-1)return}jz(t,l)}}}function Jbe(t){if(!t.editable)return;const n=Aa.getState(t.state);n&&n.activeHandle>-1&&!n.dragging&&jz(t,-1)}function ewe(t,n,r,s){var i;if(!t.editable)return!1;const o=(i=t.dom.ownerDocument.defaultView)!=null?i:window,l=Aa.getState(t.state);if(!l||l.activeHandle==-1||l.dragging)return!1;const c=t.state.doc.nodeAt(l.activeHandle),d=twe(t,l.activeHandle,c.attrs);t.dispatch(t.state.tr.setMeta(Aa,{setDragging:{startX:n.clientX,startWidth:d}}));function u(m){o.removeEventListener("mouseup",u),o.removeEventListener("mousemove",h);const g=Aa.getState(t.state);g!=null&&g.dragging&&(rwe(t,g.activeHandle,BM(g.dragging,m,r)),t.dispatch(t.state.tr.setMeta(Aa,{setDragging:null})))}function h(m){if(!m.which)return u(m);const g=Aa.getState(t.state);if(g&&g.dragging){const y=BM(g.dragging,m,r);FM(t,g.activeHandle,y,s)}}return FM(t,l.activeHandle,d,s),o.addEventListener("mouseup",u),o.addEventListener("mousemove",h),n.preventDefault(),!0}function twe(t,n,{colspan:r,colwidth:s}){const i=s&&s[s.length-1];if(i)return i;const o=t.domAtPos(n);let c=o.node.childNodes[o.offset].offsetWidth,d=r;if(s)for(let u=0;u<r;u++)s[u]&&(c-=s[u],d--);return c/d}function nwe(t){for(;t&&t.nodeName!="TD"&&t.nodeName!="TH";)t=t.classList&&t.classList.contains("ProseMirror")?null:t.parentNode;return t}function LM(t,n,r,s){const i=r=="right"?-s:s,o=t.posAtCoords({left:n.clientX+i,top:n.clientY});if(!o)return-1;const{pos:l}=o,c=Ah(t.state.doc.resolve(l));if(!c)return-1;if(r=="right")return c.pos;const d=cr.get(c.node(-1)),u=c.start(-1),h=d.map.indexOf(c.pos-u);return h%d.width==0?-1:u+d.map[h-1]}function BM(t,n,r){const s=n.clientX-t.startX;return Math.max(r,t.startWidth+s)}function jz(t,n){t.dispatch(t.state.tr.setMeta(Aa,{setHandle:n}))}function rwe(t,n,r){const s=t.state.doc.resolve(n),i=s.node(-1),o=cr.get(i),l=s.start(-1),c=o.colCount(s.pos-l)+s.nodeAfter.attrs.colspan-1,d=t.state.tr;for(let u=0;u<o.height;u++){const h=u*o.width+c;if(u&&o.map[h]==o.map[h-o.width])continue;const m=o.map[h],g=i.nodeAt(m).attrs,y=g.colspan==1?0:c-o.colCount(m);if(g.colwidth&&g.colwidth[y]==r)continue;const N=g.colwidth?g.colwidth.slice():swe(g.colspan);N[y]=r,d.setNodeMarkup(l+m,null,{...g,colwidth:N})}d.docChanged&&t.dispatch(d)}function FM(t,n,r,s){const i=t.state.doc.resolve(n),o=i.node(-1),l=i.start(-1),c=cr.get(o).colCount(i.pos-l)+i.nodeAfter.attrs.colspan-1;let d=t.domAtPos(i.start(-1)).node;for(;d&&d.nodeName!="TABLE";)d=d.parentNode;d&&US(o,d.firstChild,d,s,c,r)}function swe(t){return Array(t).fill(0)}function awe(t,n){var r;const s=[],i=t.doc.resolve(n),o=i.node(-1);if(!o)return pr.empty;const l=cr.get(o),c=i.start(-1),d=l.colCount(i.pos-c)+i.nodeAfter.attrs.colspan-1;for(let u=0;u<l.height;u++){const h=d+u*l.width;if((d==l.width-1||l.map[h]!=l.map[h+1])&&(u==0||l.map[h]!=l.map[h-l.width])){const m=l.map[h],g=c+m+o.nodeAt(m).nodeSize-1,y=document.createElement("div");y.className="column-resize-handle",(r=Aa.getState(t))!=null&&r.dragging&&s.push(Ia.node(c+m,c+m+o.nodeAt(m).nodeSize,{class:"column-resize-dragging"})),s.push(Ia.widget(g,y))}}return pr.create(t.doc,s)}function iwe({allowTableNodeSelection:t=!1}={}){return new Ar({key:rc,state:{init(){return null},apply(n,r){const s=n.getMeta(rc);if(s!=null)return s==-1?null:s;if(r==null||!n.docChanged)return r;const{deleted:i,pos:o}=n.mapping.mapResult(r);return i?null:o}},props:{decorations:vbe,handleDOMEvents:{mousedown:Kbe},createSelectionBetween(n){return rc.getState(n.state)!=null?n.state.selection:null},handleTripleClick:qbe,handleKeyDown:Wbe,handlePaste:Gbe},appendTransaction(n,r,s){return Nbe(s,vz(s,r),t)}})}var Sz=wx.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{var n,r;const s=t.getAttribute("colwidth"),i=s?s.split(",").map(o=>parseInt(o,10)):null;if(!i){const o=(n=t.closest("table"))==null?void 0:n.querySelectorAll("colgroup > col"),l=Array.from(((r=t.parentElement)==null?void 0:r.children)||[]).indexOf(t);if(l&&l>-1&&o&&o[l]){const c=o[l].getAttribute("width");return c?[parseInt(c,10)]:null}}return i}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:t}){return["td",Zc(this.options.HTMLAttributes,t),0]}}),owe=wx.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{const n=t.getAttribute("colwidth");return n?n.split(",").map(s=>parseInt(s,10)):null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:t}){return["th",Zc(this.options.HTMLAttributes,t),0]}}),lwe=wx.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:t}){return["tr",Zc(this.options.HTMLAttributes,t),0]}});function VS(t,n){return n?["width",`${Math.max(n,t)}px`]:["min-width",`${t}px`]}function $M(t,n,r,s,i,o){var l;let c=0,d=!0,u=n.firstChild;const h=t.firstChild;if(h!==null)for(let g=0,y=0;g<h.childCount;g+=1){const{colspan:N,colwidth:j}=h.child(g).attrs;for(let S=0;S<N;S+=1,y+=1){const _=i===y?o:j&&j[S],A=_?`${_}px`:"";if(c+=_||s,_||(d=!1),u){if(u.style.width!==A){const[k,T]=VS(s,_);u.style.setProperty(k,T)}u=u.nextSibling}else{const k=document.createElement("col"),[T,P]=VS(s,_);k.style.setProperty(T,P),n.appendChild(k)}}}for(;u;){const g=u.nextSibling;(l=u.parentNode)==null||l.removeChild(u),u=g}const m=t.attrs.style&&typeof t.attrs.style=="string"&&/\bwidth\s*:/i.test(t.attrs.style);d&&!m?(r.style.width=`${c}px`,r.style.minWidth=""):(r.style.width="",r.style.minWidth=`${c}px`)}var cwe=class{constructor(t,n){this.node=t,this.cellMinWidth=n,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),t.attrs.style&&(this.table.style.cssText=t.attrs.style),this.colgroup=this.table.appendChild(document.createElement("colgroup")),$M(t,this.colgroup,this.table,n),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(t){return t.type!==this.node.type?!1:(this.node=t,$M(t,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(t){const n=t.target,r=this.dom.contains(n),s=this.contentDOM.contains(n);return!!(r&&!s&&(t.type==="attributes"||t.type==="childList"||t.type==="characterData"))}};function dwe(t,n,r,s){let i=0,o=!0;const l=[],c=t.firstChild;if(!c)return{};for(let m=0,g=0;m<c.childCount;m+=1){const{colspan:y,colwidth:N}=c.child(m).attrs;for(let j=0;j<y;j+=1,g+=1){const S=r===g?s:N&&N[j];i+=S||n,S||(o=!1);const[_,A]=VS(n,S);l.push(["col",{style:`${_}: ${A}`}])}}const d=o?`${i}px`:"",u=o?"":`${i}px`;return{colgroup:["colgroup",{},...l],tableWidth:d,tableMinWidth:u}}function zM(t,n){return t.createAndFill()}function uwe(t){if(t.cached.tableNodeTypes)return t.cached.tableNodeTypes;const n={};return Object.keys(t.nodes).forEach(r=>{const s=t.nodes[r];s.spec.tableRole&&(n[s.spec.tableRole]=s)}),t.cached.tableNodeTypes=n,n}function fwe(t,n,r,s,i){const o=uwe(t),l=[],c=[];for(let u=0;u<r;u+=1){const h=zM(o.cell);if(h&&c.push(h),s){const m=zM(o.header_cell);m&&l.push(m)}}const d=[];for(let u=0;u<n;u+=1)d.push(o.row.createChecked(null,s&&u===0?l:c));return o.table.createChecked(null,d)}function hwe(t){return t instanceof Tn}var $0=({editor:t})=>{const{selection:n}=t.state;if(!hwe(n))return!1;let r=0;const s=q$(n.ranges[0].$from,o=>o.type.name==="table");return s==null||s.node.descendants(o=>{if(o.type.name==="table")return!1;["tableCell","tableHeader"].includes(o.type.name)&&(r+=1)}),r===n.ranges.length?(t.commands.deleteTable(),!0):!1},mwe="";function pwe(t){return(t||"").replace(/\s+/g," ").trim()}function xwe(t,n,r={}){var s;const i=(s=r.cellLineSeparator)!=null?s:mwe;if(!t||!t.content||t.content.length===0)return"";const o=[];t.content.forEach(N=>{const j=[];N.content&&N.content.forEach(S=>{let _="";S.content&&Array.isArray(S.content)&&S.content.length>1?_=S.content.map(P=>n.renderChildren(P)).join(i):_=S.content?n.renderChildren(S.content):"";const A=pwe(_),k=S.type==="tableHeader";j.push({text:A,isHeader:k})}),o.push(j)});const l=o.reduce((N,j)=>Math.max(N,j.length),0);if(l===0)return"";const c=new Array(l).fill(0);o.forEach(N=>{var j;for(let S=0;S<l;S+=1){const A=(((j=N[S])==null?void 0:j.text)||"").length;A>c[S]&&(c[S]=A),c[S]<3&&(c[S]=3)}});const d=(N,j)=>N+" ".repeat(Math.max(0,j-N.length)),u=o[0],h=u.some(N=>N.isHeader);let m=`
`;const g=new Array(l).fill(0).map((N,j)=>h&&u[j]&&u[j].text||"");return m+=`| ${g.map((N,j)=>d(N,c[j])).join(" | ")} |
`,m+=`| ${c.map(N=>"-".repeat(Math.max(3,N))).join(" | ")} |
`,(h?o.slice(1):o).forEach(N=>{m+=`| ${new Array(l).fill(0).map((j,S)=>d(N[S]&&N[S].text||"",c[S])).join(" | ")} |
`}),m}var gwe=xwe,Cz=wx.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,renderWrapper:!1,handleWidth:5,cellMinWidth:25,View:cwe,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({node:t,HTMLAttributes:n}){const{colgroup:r,tableWidth:s,tableMinWidth:i}=dwe(t,this.options.cellMinWidth),o=n.style;function l(){return o||(s?`width: ${s}`:`min-width: ${i}`)}const c=["table",Zc(this.options.HTMLAttributes,n,{style:l()}),r,["tbody",0]];return this.options.renderWrapper?["div",{class:"tableWrapper"},c]:c},parseMarkdown:(t,n)=>{const r=[];if(t.header){const s=[];t.header.forEach(i=>{s.push(n.createNode("tableHeader",{},[{type:"paragraph",content:n.parseInline(i.tokens)}]))}),r.push(n.createNode("tableRow",{},s))}return t.rows&&t.rows.forEach(s=>{const i=[];s.forEach(o=>{i.push(n.createNode("tableCell",{},[{type:"paragraph",content:n.parseInline(o.tokens)}]))}),r.push(n.createNode("tableRow",{},i))}),n.createNode("table",void 0,r)},renderMarkdown:(t,n)=>gwe(t,n),addCommands(){return{insertTable:({rows:t=3,cols:n=3,withHeaderRow:r=!0}={})=>({tr:s,dispatch:i,editor:o})=>{const l=fwe(o.schema,t,n,r);if(i){const c=s.selection.from+1;s.replaceSelectionWith(l).scrollIntoView().setSelection(ut.near(s.doc.resolve(c)))}return!0},addColumnBefore:()=>({state:t,dispatch:n})=>Cbe(t,n),addColumnAfter:()=>({state:t,dispatch:n})=>_be(t,n),deleteColumn:()=>({state:t,dispatch:n})=>Ebe(t,n),addRowBefore:()=>({state:t,dispatch:n})=>Tbe(t,n),addRowAfter:()=>({state:t,dispatch:n})=>Ibe(t,n),deleteRow:()=>({state:t,dispatch:n})=>Mbe(t,n),deleteTable:()=>({state:t,dispatch:n})=>$be(t,n),mergeCells:()=>({state:t,dispatch:n})=>kM(t,n),splitCell:()=>({state:t,dispatch:n})=>TM(t,n),toggleHeaderColumn:()=>({state:t,dispatch:n})=>$p("column")(t,n),toggleHeaderRow:()=>({state:t,dispatch:n})=>$p("row")(t,n),toggleHeaderCell:()=>({state:t,dispatch:n})=>Bbe(t,n),mergeOrSplit:()=>({state:t,dispatch:n})=>kM(t,n)?!0:TM(t,n),setCellAttribute:(t,n)=>({state:r,dispatch:s})=>Rbe(t,n)(r,s),goToNextCell:()=>({state:t,dispatch:n})=>PM(1)(t,n),goToPreviousCell:()=>({state:t,dispatch:n})=>PM(-1)(t,n),fixTables:()=>({state:t,dispatch:n})=>(n&&vz(t),!0),setCellSelection:t=>({tr:n,dispatch:r})=>{if(r){const s=Tn.create(n.doc,t.anchorCell,t.headCell);n.setSelection(s)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:$0,"Mod-Backspace":$0,Delete:$0,"Mod-Delete":$0}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[Xbe({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,defaultCellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],iwe({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(t){const n={name:t.name,options:t.options,storage:t.storage};return{tableRole:du(Jf(t,"tableRole",n))}}});bs.create({name:"tableKit",addExtensions(){const t=[];return this.options.table!==!1&&t.push(Cz.configure(this.options.table)),this.options.tableCell!==!1&&t.push(Sz.configure(this.options.tableCell)),this.options.tableHeader!==!1&&t.push(owe.configure(this.options.tableHeader)),this.options.tableRow!==!1&&t.push(lwe.configure(this.options.tableRow)),t}});Cz.extend({addAttributes(){var t;return{...(t=this.parent)==null?void 0:t.call(this),borderPreset:{default:null,parseHTML:n=>{const r=n.getAttribute("class")||"";return/\btbl-border-all\b/.test(r)?"all":/\btbl-border-h\b/.test(r)?"h":/\btbl-border-v\b/.test(r)?"v":/\btbl-border-none\b/.test(r)?"none":null},renderHTML:n=>({class:n.borderPreset?`tbl-border-${n.borderPreset}`:null,style:"border-collapse:collapse;"})}}}}).configure({resizable:!0});Sz.extend({addAttributes(){var t;return{...(t=this.parent)==null?void 0:t.call(this),backgroundColor:{default:null,parseHTML:n=>n.style.backgroundColor||n.getAttribute("data-bg")||null,renderHTML:n=>{const r={};return n.backgroundColor&&(r.style=`background-color:${n.backgroundColor}`),{...r,"data-bg":n.backgroundColor||null}}}}}});const qN={Patient:[{label:"UHID",token:"{{ patient.uhid }}"},{label:"Name",token:"{{ patient.name }}"},{label:"Gender",token:"{{ patient.gender }}"},{label:"DOB",token:'{{ patient.dob | datefmt("%d-%b-%Y") }}'},{label:"Phone",token:"{{ patient.phone }}"},{label:"Email",token:"{{ patient.email }}"},{label:"Address",token:"{{ patient.address }}"}],"Clinical  Last Visit":[{label:"Visit Date",token:'{{ clinical.last_visit.date | datefmt("%d-%b-%Y") }}'},{label:"Doctor",token:"{{ clinical.last_visit.doctor }}"},{label:"Department",token:"{{ clinical.last_visit.department }}"},{label:"Chief Complaints",token:"{{ clinical.last_visit.chief_complaints }}"},{label:"Diagnosis",token:"{{ clinical.last_visit.diagnosis }}"}],"Clinical  Lab Results (loop)":[{label:"Lab Results Table",token:`<table border="1" cellspacing="0" cellpadding="6">
  <tr><th>Test</th><th>Code</th><th>Status</th><th>Result</th><th>Units</th></tr>
  {% for r in clinical.lab_results %}
    <tr>
      <td>{{ r.test }}</td><td>{{ r.code }}</td>
      <td>{{ r.status }}</td><td>{{ r.result }}</td><td>{{ r.units }}</td>
    </tr>
  {% endfor %}
</table>`}],Billing:[{label:"Invoices Count",token:"{{ billing.summary.invoices_count }}"},{label:"Total",token:"{{ billing.summary.total_net }}"},{label:"Paid",token:"{{ billing.summary.total_paid }}"},{label:"Balance",token:"{{ billing.summary.balance }}"}]};function ywe({onInsert:t}){const[n,r]=b.useState(()=>new Set(Object.keys(qN))),[s,i]=b.useState(""),o=b.useMemo(()=>{const d=s.trim().toLowerCase();return Object.entries(qN).filter(([h])=>n.has(h)).map(([h,m])=>{const g=d?m.filter(y=>y.label.toLowerCase().includes(d)||y.token.toLowerCase().includes(d)):m;return{group:h,items:g}}).filter(h=>h.items.length>0)},[n,s]),l=d=>{const u=new Set(n);u.has(d)?u.delete(d):u.add(d),r(u)},c=(d,u)=>{d.dataTransfer.setData("text/x-token",u),d.dataTransfer.setData("text/plain",u)};return a.jsxs("div",{className:"border rounded-lg p-3 bg-white space-y-3",children:[a.jsx("div",{className:"text-sm font-semibold",children:"Field Catalog"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Object.keys(qN).map(d=>a.jsxs("label",{className:"inline-flex items-center gap-1 text-xs border rounded px-2 py-1 bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:n.has(d),onChange:()=>l(d)}),d]},d))}),a.jsx("input",{value:s,onChange:d=>i(d.target.value),placeholder:"Search fields",className:"w-full border rounded px-2 py-1 text-sm"}),a.jsx("div",{className:"space-y-4",children:o.map(({group:d,items:u})=>a.jsxs("div",{children:[a.jsx("div",{className:"text-[11px] font-semibold text-gray-600 mb-1",children:d}),a.jsx("div",{className:"flex flex-wrap gap-2",children:u.map((h,m)=>a.jsx("div",{draggable:!0,onDragStart:g=>c(g,h.token),onDoubleClick:()=>t&&t(h.token),className:"cursor-grab active:cursor-grabbing text-[11px] px-2 py-1 rounded-md bg-gray-50 hover:bg-gray-100 border",title:"Drag into editor or double-click to insert",children:h.label},m))})]},d))}),a.jsxs("div",{className:"pt-2 border-t",children:[a.jsx("div",{className:"text-[11px] text-gray-600 mb-1",children:"Custom token"}),a.jsxs("form",{onSubmit:d=>{d.preventDefault();const u=d.target.elements.token.value.trim();u&&(t&&t(u),d.target.reset())},children:[a.jsx("input",{name:"token",placeholder:"e.g. {{ my.custom }}",className:"border rounded px-2 py-1 text-sm w-full"}),a.jsx("button",{className:"mt-2 w-full px-2 py-1 border rounded text-sm",children:"Insert"})]})]})]})}const Rg=`@page {
  size: A4;
  margin: 18mm 16mm 18mm 16mm;
}
header.tpl-header { position: running(doc-header); }
footer.tpl-footer { position: running(doc-footer); }
@page {
  @top-center { content: element(doc-header); }
  @bottom-center { content: element(doc-footer); }
}
body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; font-size: 12px; }
h1,h2,h3 { margin: 0 0 8px 0; }
table { width: 100%; border-collapse: collapse; }
th, td { padding: 6px; }`,ti={HeaderMinimal:`
<header class="tpl-header" style="font-size:12px;border-bottom:1px solid #ccc;padding-bottom:6px;display:flex;justify-content:space-between;align-items:center;">
  <div>
    <div style="font-weight:700">Hospital Name</div>
    <div style="font-size:11px;">Address line 1, City</div>
  </div>
  <img src="/media/uploads/sample/hospital_logo.png" alt="Logo" style="height:28px"/>
</header>`.trim(),FooterMinimal:`
<footer class="tpl-footer" style="font-size:11px;border-top:1px solid #ccc;padding-top:6px;display:flex;justify-content:space-between;">
  <div>UHID: {{ patient.uhid }} | {{ patient.name }}</div>
  <div>Page: counter(page) / counter(pages)</div>
</footer>`.trim(),SignatureBlock:`
<div style="margin-top:60px;display:flex;gap:40px;">
  <div>Patient/Guardian Signature: __________________</div>
  <div>Doctor: __________________</div>
  <div>Witness: __________________</div>
</div>`.trim(),CoverPage:`
<section style="display:flex;flex-direction:column;min-height:240mm;justify-content:center;align-items:center;text-align:center;gap:8px;">
  <img src="/media/uploads/sample/hospital_logo.png" alt="Logo" style="height:64px;opacity:0.8"/>
  <h1 style="font-size:28px;">Patient Clinical Summary</h1>
  <div style="font-size:14px">UHID: {{ patient.uhid }} &nbsp; | &nbsp; {{ patient.name }}</div>
  <div style="margin-top:40px;font-size:12px;color:#666">Generated on {{ now }}</div>
</section>`.trim()},vwe=[{key:"clinical_summary_v2",title:"Clinical Summary  Header/Footer + Tables",category:"report",html:`
<h1>Clinical Summary</h1>
<p><b>UHID:</b> {{ patient.uhid }}<br/>
<b>Name:</b> {{ patient.name }}<br/>
<b>Gender:</b> {{ patient.gender }}<br/>
<b>DOB:</b> {{ patient.dob | datefmt("%d-%b-%Y") }}</p>

{% if clinical.last_visit.date %}
<h3>Last Visit</h3>
<p><b>Date:</b> {{ clinical.last_visit.date | datefmt("%d-%b-%Y") }}<br/>
<b>Doctor:</b> {{ clinical.last_visit.doctor }}<br/>
<b>Department:</b> {{ clinical.last_visit.department }}<br/>
<b>Chief Complaints:</b> {{ clinical.last_visit.chief_complaints }}<br/>
<b>Diagnosis:</b> {{ clinical.last_visit.diagnosis }}</p>
{% endif %}

{% if clinical.lab_results %}
<h3>Recent Lab Results</h3>
<table border="1" cellspacing="0" cellpadding="6">
  <tr><th>Test</th><th>Code</th><th>Status</th><th>Result</th><th>Units</th></tr>
  {% for r in clinical.lab_results %}
    <tr>
      <td>{{ r.test }}</td><td>{{ r.code }}</td><td>{{ r.status }}</td><td>{{ r.result }}</td><td>{{ r.units }}</td>
    </tr>
  {% endfor %}
</table>
{% endif %}

{% if billing.summary %}
<h3>Billing Summary</h3>
<p>
<b>Invoices:</b> {{ billing.summary.invoices_count }} |
<b>Total:</b> {{ billing.summary.total_net }} |
<b>Paid:</b> {{ billing.summary.total_paid }} |
<b>Balance:</b> {{ billing.summary.balance }}
</p>
{% endif %}
`.trim(),css:Rg,header:ti.HeaderMinimal,footer:ti.FooterMinimal},{key:"general_consent_v2",title:"General Consent  with Signature",category:"consent",html:`
<h2 style="text-align:center;">General Consent for Treatment</h2>
<p><b>UHID:</b> {{ patient.uhid }}<br/>
<b>Patient Name:</b> {{ patient.name }}<br/>
<b>Date:</b> {{ now }}</p>

<p>
I, {{ patient.name }}, hereby give consent for the proposed {{ data.procedure_name }}
under the care of {{ data.doctor_name }}.
</p>

<p><b>Risks explained:</b> {{ data.risks_text }}</p>

${ti.SignatureBlock}
`.trim(),css:Rg,header:ti.HeaderMinimal,footer:ti.FooterMinimal},{key:"cover_plus_clinical",title:"Cover Page + Clinical",category:"report",html:`${ti.CoverPage}
<div style="page-break-before:always;"></div>
<h1>Clinical Details</h1>
<p><b>UHID:</b> {{ patient.uhid }} &nbsp; <b>Name:</b> {{ patient.name }}</p>
{% if clinical.last_visit.date %}
<p><b>Last Visit:</b> {{ clinical.last_visit.date | datefmt("%d-%b-%Y") }}  {{ clinical.last_visit.doctor }}</p>
{% endif %}
`.trim(),css:Rg,header:ti.HeaderMinimal,footer:ti.FooterMinimal}];function bwe({onUseLayout:t,onInsertBlock:n}){const r=b.useMemo(()=>[{key:"HeaderMinimal",title:"Header  Minimal",html:ti.HeaderMinimal},{key:"FooterMinimal",title:"Footer  Minimal",html:ti.FooterMinimal},{key:"SignatureBlock",title:"Signature Block",html:ti.SignatureBlock},{key:"CoverPage",title:"Cover Page",html:ti.CoverPage}],[]);return a.jsxs("div",{className:"border rounded-lg p-3 bg-white space-y-3",children:[a.jsx("div",{className:"text-sm font-semibold",children:"Template Gallery"}),a.jsx("div",{className:"space-y-2",children:vwe.map(s=>a.jsxs("div",{className:"border rounded p-2",children:[a.jsx("div",{className:"text-sm font-medium",children:s.title}),a.jsxs("div",{className:"text-[11px] text-gray-500 mb-2",children:["Category: ",s.category]}),a.jsx("div",{className:"flex gap-2",children:a.jsx("button",{className:"px-2 py-1 rounded text-sm border",onClick:()=>t&&t(s),children:"Use Layout"})})]},s.key))}),a.jsxs("div",{className:"pt-2 border-t",children:[a.jsx("div",{className:"text-sm font-semibold mb-2",children:"Blocks"}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:r.map(s=>a.jsxs("button",{className:"border rounded p-2 text-left hover:bg-gray-50",onClick:()=>n&&n(s.html),title:"Insert into current editor",children:[a.jsx("div",{className:"text-xs font-medium",children:s.title}),a.jsx("div",{className:"text-[10px] text-gray-500",children:"Click to insert"})]},s.key))})]})]})}const wwe=[{key:"A4",label:"A4 (210297 mm)"},{key:"A5",label:"A5 (148210 mm)"},{key:"Letter",label:"Letter (8.511 in)"},{key:"Legal",label:"Legal (8.514 in)"}];function Nwe({css:t="",onApply:n,onClose:r}){const[s,i]=b.useState("A4"),[o,l]=b.useState("portrait"),[c,d]=b.useState(18),[u,h]=b.useState(16),[m,g]=b.useState(18),[y,N]=b.useState(16),[j,S]=b.useState(!0);b.useEffect(()=>{const A=t.match(/@page\s*{([\s\S]*?)}/);if(!A)return;const k=A[1],T=O=>(k.match(O)||[,""])[1],P=T(/size:\s*([^;]+);/i);if(P){const O=P.trim().split(/\s+/);i(O[0]),O[1]&&l(O[1])}const M=(O,D)=>{const L=T(O);return L?parseInt(L,10):D};d(M(/margin-top:\s*([0-9]+)mm/i,c)),h(M(/margin-right:\s*([0-9]+)mm/i,u)),g(M(/margin-bottom:\s*([0-9]+)mm/i,m)),N(M(/margin-left:\s*([0-9]+)mm/i,y))},[]);const _=()=>`@page {
  size: ${s} ${o};
  margin-top: ${c}mm;
  margin-right: ${u}mm;
  margin-bottom: ${m}mm;
  margin-left: ${y}mm;
  ${j?'@bottom-right { content: "Page " counter(page) " of " counter(pages); font-size:10px; }':""}
}`;return a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg w-full max-w-xl",children:[a.jsx("div",{className:"px-4 py-3 border-b font-semibold",children:"Page Setup"}),a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("label",{className:"text-sm",children:["Size",a.jsx("select",{className:"w-full border rounded px-2 py-1",value:s,onChange:A=>i(A.target.value),children:wwe.map(A=>a.jsx("option",{value:A.key,children:A.label},A.key))})]}),a.jsxs("label",{className:"text-sm",children:["Orientation",a.jsxs("select",{className:"w-full border rounded px-2 py-1",value:o,onChange:A=>l(A.target.value),children:[a.jsx("option",{value:"portrait",children:"Portrait"}),a.jsx("option",{value:"landscape",children:"Landscape"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[a.jsxs("label",{className:"text-sm",children:["Top (mm)",a.jsx("input",{type:"number",className:"w-full border rounded px-2 py-1",value:c,onChange:A=>d(+A.target.value)})]}),a.jsxs("label",{className:"text-sm",children:["Right (mm)",a.jsx("input",{type:"number",className:"w-full border rounded px-2 py-1",value:u,onChange:A=>h(+A.target.value)})]}),a.jsxs("label",{className:"text-sm",children:["Bottom (mm)",a.jsx("input",{type:"number",className:"w-full border rounded px-2 py-1",value:m,onChange:A=>g(+A.target.value)})]}),a.jsxs("label",{className:"text-sm",children:["Left (mm)",a.jsx("input",{type:"number",className:"w-full border rounded px-2 py-1",value:y,onChange:A=>N(+A.target.value)})]})]}),a.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",checked:j,onChange:A=>S(A.target.checked)}),"Show page numbers (WeasyPrint)"]}),a.jsx("pre",{className:"text-xs bg-gray-50 border rounded p-2 overflow-auto",children:_()})]}),a.jsxs("div",{className:"px-4 py-3 border-t flex justify-end gap-2",children:[a.jsx("button",{className:"px-3 py-2 border rounded",onClick:r,children:"Cancel"}),a.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white",onClick:()=>n&&n(_()),children:"Apply"})]})]})})}const GN=Rg;function UM({mode:t="create"}){var D;const{id:n}=Su(),r=Hi(),i=((D=yi().state)==null?void 0:D.preset)||null,[o,l]=b.useState({name:"",code:"",category:"report",subcategory:"",description:"",css:GN,is_active:!0}),[c,d]=b.useState(""),[u,h]=b.useState("<h1>New Template</h1><p>Use the Field Catalog or Gallery.</p>"),[m,g]=b.useState(""),[y,N]=b.useState("body"),j=t==="edit";b.useEffect(()=>{!j||!n||(async()=>{const $=(await Epe(n)).data;l({name:$.name,code:$.code,category:$.category,subcategory:$.subcategory||"",description:$.description||"",css:$.css||GN,is_active:!!$.is_active});const V=$.html||"",F=V.match(/<header[^>]*class="[^"]*tpl-header[^"]*"[^>]*>[\s\S]*?<\/header>/i),Q=V.match(/<footer[^>]*class="[^"]*tpl-footer[^"]*"[^>]*>[\s\S]*?<\/footer>/i);d(F?F[0]:""),g(Q?Q[0]:"");let U=V;F&&(U=U.replace(F[0],"")),Q&&(U=U.replace(Q[0],"")),h(U.trim()||"")})()},[j,n]),b.useEffect(()=>{!i||j||(l(L=>({...L,category:i.category||"report",name:L.name||i.title||"Untitled",code:L.code||(i.key?`${i.key}-${Date.now()}`:""),css:i.css||GN})),d(i.header||""),g(i.footer||""),h(i.html||""))},[i,j]);const S=b.useMemo(()=>[c,u,m].filter(Boolean).join(`
`),[c,u,m]),_=async()=>{if(!o.name.trim()||!o.code.trim()){fe.error("Name and unique code are required");return}const L={...o,html:S,placeholders:{header:!!c,footer:!!m}};try{j?(await Tpe(n,L),fe.success("Template updated")):(await kpe(L),fe.success("Template created")),r("/templates")}catch{}},A=L=>{l($=>({...$,category:L.category||$.category,css:L.css||$.css,name:$.name||L.title,code:$.code||(L.key?`${L.key}-${Date.now()}`:"")})),d(L.header||""),g(L.footer||""),h(L.html||""),fe.success("Layout applied")},k=L=>{y==="header"?d($=>`${$}
${L}`):y==="footer"?g($=>`${$}
${L}`):h($=>`${$}
${L}`)},T=L=>{k(L)},[P,M]=b.useState(!1),O=L=>{l($=>{const V=/@page\s*{[\s\S]*?}/.test($.css||"");return{...$,css:V?$.css.replace(/@page\s*{[\s\S]*?}/,L):L+`
`+($.css||"")}}),M(!1)};return a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>M(!0),className:"px-3 py-2 rounded border",children:"Page Setup"}),a.jsx("button",{onClick:_,className:"px-3 py-2 rounded bg-blue-600 text-white",children:"Save"}),P&&a.jsx(Nwe,{css:o.css,onApply:O,onClose:()=>M(!1)})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-xl font-semibold",children:j?"Edit Template":"Create Template"}),a.jsx("div",{className:"flex gap-2",children:a.jsx("button",{onClick:_,className:"px-3 py-2 rounded bg-blue-600 text-white",children:"Save"})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[a.jsx("input",{value:o.name,onChange:L=>l({...o,name:L.target.value}),className:"border rounded px-3 py-2",placeholder:"Template Name"}),a.jsx("input",{value:o.code,onChange:L=>l({...o,code:L.target.value}),className:"border rounded px-3 py-2",placeholder:"Unique Code (e.g., clinical_summary_v2)",disabled:j}),a.jsxs("select",{value:o.category,onChange:L=>l({...o,category:L.target.value}),className:"border rounded px-3 py-2",children:[a.jsx("option",{value:"report",children:"Report"}),a.jsx("option",{value:"consent",children:"Consent"})]}),a.jsx("input",{value:o.subcategory,onChange:L=>l({...o,subcategory:L.target.value}),className:"border rounded px-3 py-2",placeholder:"Subcategory (optional)"}),a.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",checked:o.is_active,onChange:L=>l({...o,is_active:L.target.checked})}),"Active"]})]}),a.jsx("textarea",{value:o.description,onChange:L=>l({...o,description:L.target.value}),placeholder:"Description (optional)",className:"border rounded px-3 py-2 w-full min-h-[80px]"}),a.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[a.jsxs("div",{className:"col-span-12 lg:col-span-8 space-y-3",children:[a.jsx("div",{className:"flex gap-2",children:["header","body","footer"].map(L=>a.jsx("button",{onClick:()=>N(L),className:["px-3 py-1 rounded border text-sm",y===L?"bg-blue-600 text-white border-blue-600":"bg-white"].join(" "),children:L.toUpperCase()},L))}),y==="header"&&a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium mb-1",children:"Header (running top)"}),a.jsx(AN,{value:c,onChange:d})]}),y==="body"&&a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium mb-1",children:"Body"}),a.jsx(AN,{value:u,onChange:h})]}),y==="footer"&&a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium mb-1",children:"Footer (running bottom)"}),a.jsx(AN,{value:m,onChange:g})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium mb-1",children:"CSS (print styles)"}),a.jsx("textarea",{value:o.css,onChange:L=>l({...o,css:L.target.value}),className:"border rounded px-3 py-2 w-full min-h-[160px] font-mono text-xs"})]})]}),a.jsxs("div",{className:"col-span-12 lg:col-span-4 space-y-3",children:[a.jsx(ywe,{onInsert:T}),a.jsx(bwe,{onUseLayout:A,onInsertBlock:k}),a.jsxs("div",{className:"text-[11px] text-gray-500",children:[a.jsx("b",{children:"Note:"})," Save the template to use server-side merged preview & PDF."]})]})]})]})}function jwe(t,n){const r=window.URL.createObjectURL(t),s=document.createElement("a");s.href=r,s.download=n||"download",document.body.appendChild(s),s.click(),s.remove(),window.URL.revokeObjectURL(r)}function _z({value:t,onChange:n,onSelect:r}){const[s,i]=b.useState(""),[o,l]=b.useState([]),[c,d]=b.useState(!1);b.useEffect(()=>{const m=setTimeout(async()=>{const g=(s||"").trim();if(g.length<2){l([]);return}d(!0);try{const{data:y}=await hF(g),N=(y==null?void 0:y.results)||(y==null?void 0:y.items)||y||[];l(N)}catch(y){console.error("lookupPatients failed",y),l([])}finally{d(!1)}},300);return()=>clearTimeout(m)},[s]);function u(h){const m=n||r;m&&m(h.id,h)}return a.jsxs("div",{className:"space-y-1",children:[a.jsx("input",{value:s,onChange:h=>i(h.target.value),placeholder:"Search patient (UHID / Name / Phone)",className:"w-full rounded-md border border-slate-300 px-2.5 py-1.5 text-xs md:text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500"}),a.jsxs("div",{className:"mt-1 max-h-56 overflow-auto rounded-xl border border-slate-200 bg-white shadow-sm",children:[c&&a.jsx("div",{className:"px-3 py-2 text-[11px] text-slate-400",children:"Searching"}),!c&&o.length===0&&a.jsx("div",{className:"px-3 py-2 text-[11px] text-slate-400",children:"Type at least 2 characters to search."}),o.map(h=>{const m=h.uhid||`NH-${String(h.id??"").toString().padStart(6,"0")}`,g=h.name||[h.first_name,h.last_name].filter(Boolean).join(" ")||"Unnamed";return a.jsxs("button",{type:"button",onClick:()=>u(h),className:"w-full text-left px-3 py-2 text-xs md:text-sm hover:bg-indigo-50 flex flex-col gap-0.5",children:[a.jsxs("span",{className:"font-medium text-slate-800",children:[m,"  ",g]}),a.jsxs("span",{className:"text-[11px] text-slate-500",children:[h.gender?`${h.gender}  `:"",h.phone||"No phone"]})]},h.id)})]}),t&&a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Selected patient ID:"," ",a.jsx("span",{className:"font-semibold text-slate-800",children:t})]})]})}function Swe(){const[t,n]=b.useState("saved"),[r,s]=b.useState(null),[i,o]=b.useState([]),[l,c]=b.useState(""),[d,u]=b.useState(""),[h,m]=b.useState(1),[g,y]=b.useState("");b.useEffect(()=>{(async()=>{const S=await VA({category:"report",active:!0});o(S.data||[])})()},[]);const N=async()=>{if(!r||!l)return fe.info("Select template and patient");try{const S=await mF(Number(l),Number(r));u(S.data.html||"")}catch{}},j=async()=>{if(!r||!l)return fe.info("Select template and patient");try{const S=g?await Mpe(Number(l),{patient_id:Number(r),inline:!1,engine:g}):await Ppe(Number(l),Number(r));jwe(S,`patient-${r}.pdf`)}catch{}};return a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsx("h1",{className:"text-xl font-semibold",children:"Generate Patient Reports"}),a.jsx("div",{className:"flex gap-2",children:["saved","predefined","customized"].map(S=>a.jsx("button",{onClick:()=>n(S),className:["px-3 py-1 rounded border text-sm",t===S?"bg-blue-600 text-white border-blue-600":"bg-white"].join(" "),children:S==="saved"?"Saved Formats":S==="predefined"?"Predefined":"Customized"},S))}),t==="saved"&&a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsxs("div",{className:"md:col-span-1 border rounded-lg p-3 bg-white space-y-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold mb-2",children:"1) Select Template"}),a.jsxs("select",{value:l,onChange:S=>c(S.target.value),className:"border rounded px-3 py-2 w-full",children:[a.jsx("option",{value:"",children:"-- choose report template --"}),i.map(S=>a.jsxs("option",{value:S.id,children:[S.name," (",S.code,")"]},S.id))]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold mb-2",children:"2) Choose Patient"}),a.jsx(_z,{value:r,onSelect:s})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm",children:"Engine"}),a.jsxs("select",{value:g,onChange:S=>y(S.target.value),className:"border rounded px-2 py-1 text-sm",children:[a.jsx("option",{value:"",children:"Auto"}),a.jsx("option",{value:"weasyprint",children:"WeasyPrint"}),a.jsx("option",{value:"xhtml2pdf",children:"xhtml2pdf (fallback)"})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:N,className:"px-3 py-2 border rounded",children:"Preview"}),a.jsx("button",{onClick:j,className:"px-3 py-2 rounded bg-blue-600 text-white",children:"Download PDF"})]})]})]}),a.jsxs("div",{className:"md:col-span-2 border rounded-lg overflow-hidden bg-white",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",children:[a.jsx("div",{className:"text-sm text-gray-600",children:"Preview"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"px-2 py-1 border rounded text-sm",onClick:()=>m(S=>Math.max(.5,+(S-.1).toFixed(2))),children:""}),a.jsxs("div",{className:"text-xs w-12 text-center",children:[Math.round(h*100),"%"]}),a.jsx("button",{className:"px-2 py-1 border rounded text-sm",onClick:()=>m(S=>Math.min(2,+(S+.1).toFixed(2))),children:"+"})]})]}),a.jsx("div",{className:"w-full",style:{transform:`scale(${h})`,transformOrigin:"0 0"},children:a.jsx("iframe",{title:"report-preview",className:"w-full min-h-[900px]",srcDoc:d||""})})]})]}),t==="predefined"&&a.jsxs("div",{className:"grid md:grid-cols-3 gap-3",children:[a.jsx("div",{className:"md:col-span-1",children:a.jsx(TemplateGallery,{onUseLayout:S=>window.location.assign("/templates/new"),onInsertBlock:()=>{}})}),a.jsx("div",{className:"md:col-span-2 border rounded-lg p-4 bg-white text-sm text-gray-600",children:'Pick a layout from the left to open the editor pre-filled. Save it, then return to "Saved Formats".'})]}),t==="customized"&&a.jsxs("div",{className:"border rounded-lg p-4 bg-white",children:[a.jsx("div",{className:"text-sm mb-2",children:"Create your own template with header/footer, drag-drop fields and blocks."}),a.jsx("a",{href:"/templates/new",className:"px-3 py-2 rounded bg-blue-600 text-white inline-block",children:"Open Template Builder"})]})]})}function Cwe(){const[t,n]=b.useState(""),[r,s]=b.useState([]),[i,o]=b.useState(""),[l,c]=b.useState({procedure_name:"",doctor_name:"",risks_text:"",witness_name:""}),[d,u]=b.useState(""),[h,m]=b.useState([]),g=async j=>{if(!j){m([]);return}try{const S=await Dpe(Number(j));m(S.data||[])}catch{}};b.useEffect(()=>{(async()=>{const j=await VA({category:"consent",active:!0});s(j.data||[])})()},[]);const y=async()=>{if(!t||!i){fe.info("Select consent template and enter Patient ID");return}const j={data:{...l}},S=await mF(Number(i),Number(t),j);u(S.data.html||"")},N=async()=>{if(!t||!i){fe.info("Select consent template and enter Patient ID");return}try{await Ope(Number(t),{template_id:Number(i),data:{...l},finalize:!0,signed_by:l.doctor_name||void 0,witness_name:l.witness_name||void 0}),fe.success("Consent saved"),g(t)}catch{}};return a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsx("h1",{className:"text-xl font-semibold",children:"Patient Consents"}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsxs("div",{className:"md:col-span-1 border rounded-lg p-3 bg-white",children:[a.jsx("div",{className:"text-sm font-semibold mb-2",children:"Consent Template"}),a.jsxs("select",{value:i,onChange:j=>o(j.target.value),className:"border rounded px-3 py-2 w-full",children:[a.jsx("option",{value:"",children:"-- choose consent template --"}),r.map(j=>a.jsxs("option",{value:j.id,children:[j.name," (",j.code,")"]},j.id))]}),a.jsx("div",{className:"mt-3 text-sm font-semibold",children:"Patient"}),a.jsx("input",{value:t,onChange:j=>n(j.target.value),className:"border rounded px-3 py-2 w-full",placeholder:"Patient ID",onBlur:()=>g(e.target.value)}),a.jsx("div",{className:"mt-3 text-sm font-semibold",children:"Extra Fields"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("input",{value:l.procedure_name,onChange:j=>c({...l,procedure_name:j.target.value}),className:"border rounded px-3 py-2 w-full",placeholder:"Procedure name"}),a.jsx("input",{value:l.doctor_name,onChange:j=>c({...l,doctor_name:j.target.value}),className:"border rounded px-3 py-2 w-full",placeholder:"Doctor name"}),a.jsx("textarea",{value:l.risks_text,onChange:j=>c({...l,risks_text:j.target.value}),className:"border rounded px-3 py-2 w-full min-h-[80px]",placeholder:"Risks explained..."}),a.jsx("input",{value:l.witness_name,onChange:j=>c({...l,witness_name:j.target.value}),className:"border rounded px-3 py-2 w-full",placeholder:"Witness name"})]}),a.jsxs("div",{className:"mt-3 flex gap-2",children:[a.jsx("button",{onClick:y,className:"px-3 py-2 border rounded",children:"Preview"}),a.jsx("button",{onClick:N,className:"px-3 py-2 rounded bg-blue-600 text-white",children:"Save PDF"})]})]}),a.jsxs("div",{className:"md:col-span-2 space-y-3",children:[a.jsx("div",{className:"border rounded-lg overflow-hidden bg-white",children:a.jsx("iframe",{title:"consent-preview",className:"w-full min-h-[400px]",srcDoc:d||""})}),a.jsxs("div",{className:"border rounded-lg bg-white",children:[a.jsxs("div",{className:"px-3 py-2 border-b text-sm font-semibold",children:["Existing Consents (Patient #",t||"-",")"]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"#"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Template"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Status"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"PDF"})]})}),a.jsxs("tbody",{children:[h.map(j=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:j.id}),a.jsx("td",{className:"px-3 py-2",children:j.template_id}),a.jsx("td",{className:"px-3 py-2",children:j.status}),a.jsx("td",{className:"px-3 py-2",children:j.pdf_path?a.jsx("a",{href:j.pdf_path,target:"_blank",rel:"noreferrer",className:"text-blue-700 underline",children:"Open"}):a.jsx("span",{className:"text-gray-400",children:"-"})})]},j.id)),h.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"px-3 py-6 text-center text-gray-500",children:"No consents"})})]})]})})]})]})]})]})}function _we(t={}){return te.get("/dashboard/data",{params:t})}var Awe=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function EE(t){if(typeof t!="string")return!1;var n=Awe;return n.includes(t)}var Ewe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function Az(t){if(typeof t!="string")return!1;var n=Ewe;return n.includes(t)}function Ez(t){return typeof t=="string"&&t.startsWith("data-")}function Io(t){var n=Object.entries(t).filter(r=>{var[s]=r;return Az(s)||Ez(s)});return Object.fromEntries(n)}function zp(t){if(t==null)return null;if(b.isValidElement(t)&&typeof t.props=="object"&&t.props!==null){var n=t.props;return Io(n)}return typeof t=="object"&&!Array.isArray(t)?Io(t):null}function mi(t){var n=Object.entries(t).filter(r=>{var[s]=r;return Az(s)||Ez(s)||EE(s)});return Object.fromEntries(n)}var kwe=["children","width","height","viewBox","className","style","title","desc"];function HS(){return HS=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},HS.apply(null,arguments)}function Twe(t,n){if(t==null)return{};var r,s,i=Iwe(t,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],n.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function Iwe(t,n){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(n.indexOf(s)!==-1)continue;r[s]=t[s]}return r}var kz=b.forwardRef((t,n)=>{var{children:r,width:s,height:i,viewBox:o,className:l,style:c,title:d,desc:u}=t,h=Twe(t,kwe),m=o||{width:s,height:i,x:0,y:0},g=cn("recharts-surface",l);return b.createElement("svg",HS({},mi(h),{className:g,width:s,height:i,style:c,viewBox:"".concat(m.x," ").concat(m.y," ").concat(m.width," ").concat(m.height),ref:n}),b.createElement("title",null,d),b.createElement("desc",null,u),r)}),Pwe=["children","className"];function WS(){return WS=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},WS.apply(null,arguments)}function Mwe(t,n){if(t==null)return{};var r,s,i=Owe(t,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],n.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function Owe(t,n){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(n.indexOf(s)!==-1)continue;r[s]=t[s]}return r}var Gs=b.forwardRef((t,n)=>{var{children:r,className:s}=t,i=Mwe(t,Pwe),o=cn("recharts-layer",s);return b.createElement("g",WS({className:o},mi(i),{ref:n}),r)}),Dwe=b.createContext(null);function An(t){return function(){return t}}const Tz=Math.cos,K1=Math.sin,Yi=Math.sqrt,Y1=Math.PI,Gv=2*Y1,qS=Math.PI,GS=2*qS,pd=1e-6,Rwe=GS-pd;function Iz(t){this._+=t[0];for(let n=1,r=t.length;n<r;++n)this._+=arguments[n]+t[n]}function Lwe(t){let n=Math.floor(t);if(!(n>=0))throw new Error(`invalid digits: ${t}`);if(n>15)return Iz;const r=10**n;return function(s){this._+=s[0];for(let i=1,o=s.length;i<o;++i)this._+=Math.round(arguments[i]*r)/r+s[i]}}class Bwe{constructor(n){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=n==null?Iz:Lwe(n)}moveTo(n,r){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(n,r){this._append`L${this._x1=+n},${this._y1=+r}`}quadraticCurveTo(n,r,s,i){this._append`Q${+n},${+r},${this._x1=+s},${this._y1=+i}`}bezierCurveTo(n,r,s,i,o,l){this._append`C${+n},${+r},${+s},${+i},${this._x1=+o},${this._y1=+l}`}arcTo(n,r,s,i,o){if(n=+n,r=+r,s=+s,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let l=this._x1,c=this._y1,d=s-n,u=i-r,h=l-n,m=c-r,g=h*h+m*m;if(this._x1===null)this._append`M${this._x1=n},${this._y1=r}`;else if(g>pd)if(!(Math.abs(m*d-u*h)>pd)||!o)this._append`L${this._x1=n},${this._y1=r}`;else{let y=s-l,N=i-c,j=d*d+u*u,S=y*y+N*N,_=Math.sqrt(j),A=Math.sqrt(g),k=o*Math.tan((qS-Math.acos((j+g-S)/(2*_*A)))/2),T=k/A,P=k/_;Math.abs(T-1)>pd&&this._append`L${n+T*h},${r+T*m}`,this._append`A${o},${o},0,0,${+(m*y>h*N)},${this._x1=n+P*d},${this._y1=r+P*u}`}}arc(n,r,s,i,o,l){if(n=+n,r=+r,s=+s,l=!!l,s<0)throw new Error(`negative radius: ${s}`);let c=s*Math.cos(i),d=s*Math.sin(i),u=n+c,h=r+d,m=1^l,g=l?i-o:o-i;this._x1===null?this._append`M${u},${h}`:(Math.abs(this._x1-u)>pd||Math.abs(this._y1-h)>pd)&&this._append`L${u},${h}`,s&&(g<0&&(g=g%GS+GS),g>Rwe?this._append`A${s},${s},0,1,${m},${n-c},${r-d}A${s},${s},0,1,${m},${this._x1=u},${this._y1=h}`:g>pd&&this._append`A${s},${s},0,${+(g>=qS)},${m},${this._x1=n+s*Math.cos(o)},${this._y1=r+s*Math.sin(o)}`)}rect(n,r,s,i){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+r}h${s=+s}v${+i}h${-s}Z`}toString(){return this._}}function kE(t){let n=3;return t.digits=function(r){if(!arguments.length)return n;if(r==null)n=null;else{const s=Math.floor(r);if(!(s>=0))throw new RangeError(`invalid digits: ${r}`);n=s}return t},()=>new Bwe(n)}function TE(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Pz(t){this._context=t}Pz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:this._context.lineTo(t,n);break}}};function Kv(t){return new Pz(t)}function Mz(t){return t[0]}function Oz(t){return t[1]}function Dz(t,n){var r=An(!0),s=null,i=Kv,o=null,l=kE(c);t=typeof t=="function"?t:t===void 0?Mz:An(t),n=typeof n=="function"?n:n===void 0?Oz:An(n);function c(d){var u,h=(d=TE(d)).length,m,g=!1,y;for(s==null&&(o=i(y=l())),u=0;u<=h;++u)!(u<h&&r(m=d[u],u,d))===g&&((g=!g)?o.lineStart():o.lineEnd()),g&&o.point(+t(m,u,d),+n(m,u,d));if(y)return o=null,y+""||null}return c.x=function(d){return arguments.length?(t=typeof d=="function"?d:An(+d),c):t},c.y=function(d){return arguments.length?(n=typeof d=="function"?d:An(+d),c):n},c.defined=function(d){return arguments.length?(r=typeof d=="function"?d:An(!!d),c):r},c.curve=function(d){return arguments.length?(i=d,s!=null&&(o=i(s)),c):i},c.context=function(d){return arguments.length?(d==null?s=o=null:o=i(s=d),c):s},c}function z0(t,n,r){var s=null,i=An(!0),o=null,l=Kv,c=null,d=kE(u);t=typeof t=="function"?t:t===void 0?Mz:An(+t),n=typeof n=="function"?n:An(n===void 0?0:+n),r=typeof r=="function"?r:r===void 0?Oz:An(+r);function u(m){var g,y,N,j=(m=TE(m)).length,S,_=!1,A,k=new Array(j),T=new Array(j);for(o==null&&(c=l(A=d())),g=0;g<=j;++g){if(!(g<j&&i(S=m[g],g,m))===_)if(_=!_)y=g,c.areaStart(),c.lineStart();else{for(c.lineEnd(),c.lineStart(),N=g-1;N>=y;--N)c.point(k[N],T[N]);c.lineEnd(),c.areaEnd()}_&&(k[g]=+t(S,g,m),T[g]=+n(S,g,m),c.point(s?+s(S,g,m):k[g],r?+r(S,g,m):T[g]))}if(A)return c=null,A+""||null}function h(){return Dz().defined(i).curve(l).context(o)}return u.x=function(m){return arguments.length?(t=typeof m=="function"?m:An(+m),s=null,u):t},u.x0=function(m){return arguments.length?(t=typeof m=="function"?m:An(+m),u):t},u.x1=function(m){return arguments.length?(s=m==null?null:typeof m=="function"?m:An(+m),u):s},u.y=function(m){return arguments.length?(n=typeof m=="function"?m:An(+m),r=null,u):n},u.y0=function(m){return arguments.length?(n=typeof m=="function"?m:An(+m),u):n},u.y1=function(m){return arguments.length?(r=m==null?null:typeof m=="function"?m:An(+m),u):r},u.lineX0=u.lineY0=function(){return h().x(t).y(n)},u.lineY1=function(){return h().x(t).y(r)},u.lineX1=function(){return h().x(s).y(n)},u.defined=function(m){return arguments.length?(i=typeof m=="function"?m:An(!!m),u):i},u.curve=function(m){return arguments.length?(l=m,o!=null&&(c=l(o)),u):l},u.context=function(m){return arguments.length?(m==null?o=c=null:c=l(o=m),u):o},u}class Rz{constructor(n,r){this._context=n,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(n,r){switch(n=+n,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+n)/2,this._y0,this._x0,r,n,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,n,this._y0,n,r);break}}this._x0=n,this._y0=r}}function Fwe(t){return new Rz(t,!0)}function $we(t){return new Rz(t,!1)}const IE={draw(t,n){const r=Yi(n/Y1);t.moveTo(r,0),t.arc(0,0,r,0,Gv)}},zwe={draw(t,n){const r=Yi(n/5)/2;t.moveTo(-3*r,-r),t.lineTo(-r,-r),t.lineTo(-r,-3*r),t.lineTo(r,-3*r),t.lineTo(r,-r),t.lineTo(3*r,-r),t.lineTo(3*r,r),t.lineTo(r,r),t.lineTo(r,3*r),t.lineTo(-r,3*r),t.lineTo(-r,r),t.lineTo(-3*r,r),t.closePath()}},Lz=Yi(1/3),Uwe=Lz*2,Vwe={draw(t,n){const r=Yi(n/Uwe),s=r*Lz;t.moveTo(0,-r),t.lineTo(s,0),t.lineTo(0,r),t.lineTo(-s,0),t.closePath()}},Hwe={draw(t,n){const r=Yi(n),s=-r/2;t.rect(s,s,r,r)}},Wwe=.8908130915292852,Bz=K1(Y1/10)/K1(7*Y1/10),qwe=K1(Gv/10)*Bz,Gwe=-Tz(Gv/10)*Bz,Kwe={draw(t,n){const r=Yi(n*Wwe),s=qwe*r,i=Gwe*r;t.moveTo(0,-r),t.lineTo(s,i);for(let o=1;o<5;++o){const l=Gv*o/5,c=Tz(l),d=K1(l);t.lineTo(d*r,-c*r),t.lineTo(c*s-d*i,d*s+c*i)}t.closePath()}},KN=Yi(3),Ywe={draw(t,n){const r=-Yi(n/(KN*3));t.moveTo(0,r*2),t.lineTo(-KN*r,-r),t.lineTo(KN*r,-r),t.closePath()}},Qa=-.5,Za=Yi(3)/2,KS=1/Yi(12),Xwe=(KS/2+1)*3,Qwe={draw(t,n){const r=Yi(n/Xwe),s=r/2,i=r*KS,o=s,l=r*KS+r,c=-o,d=l;t.moveTo(s,i),t.lineTo(o,l),t.lineTo(c,d),t.lineTo(Qa*s-Za*i,Za*s+Qa*i),t.lineTo(Qa*o-Za*l,Za*o+Qa*l),t.lineTo(Qa*c-Za*d,Za*c+Qa*d),t.lineTo(Qa*s+Za*i,Qa*i-Za*s),t.lineTo(Qa*o+Za*l,Qa*l-Za*o),t.lineTo(Qa*c+Za*d,Qa*d-Za*c),t.closePath()}};function Zwe(t,n){let r=null,s=kE(i);t=typeof t=="function"?t:An(t||IE),n=typeof n=="function"?n:An(n===void 0?64:+n);function i(){let o;if(r||(r=o=s()),t.apply(this,arguments).draw(r,+n.apply(this,arguments)),o)return r=null,o+""||null}return i.type=function(o){return arguments.length?(t=typeof o=="function"?o:An(o),i):t},i.size=function(o){return arguments.length?(n=typeof o=="function"?o:An(+o),i):n},i.context=function(o){return arguments.length?(r=o??null,i):r},i}function X1(){}function Q1(t,n,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+n)/6,(t._y0+4*t._y1+r)/6)}function Fz(t){this._context=t}Fz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Q1(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Q1(this,t,n);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}};function Jwe(t){return new Fz(t)}function $z(t){this._context=t}$z.prototype={areaStart:X1,areaEnd:X1,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._x2=t,this._y2=n;break;case 1:this._point=2,this._x3=t,this._y3=n;break;case 2:this._point=3,this._x4=t,this._y4=n,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+n)/6);break;default:Q1(this,t,n);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}};function eNe(t){return new $z(t)}function zz(t){this._context=t}zz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,s=(this._y0+4*this._y1+n)/6;this._line?this._context.lineTo(r,s):this._context.moveTo(r,s);break;case 3:this._point=4;default:Q1(this,t,n);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}};function tNe(t){return new zz(t)}function Uz(t){this._context=t}Uz.prototype={areaStart:X1,areaEnd:X1,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,n){t=+t,n=+n,this._point?this._context.lineTo(t,n):(this._point=1,this._context.moveTo(t,n))}};function nNe(t){return new Uz(t)}function VM(t){return t<0?-1:1}function HM(t,n,r){var s=t._x1-t._x0,i=n-t._x1,o=(t._y1-t._y0)/(s||i<0&&-0),l=(r-t._y1)/(i||s<0&&-0),c=(o*i+l*s)/(s+i);return(VM(o)+VM(l))*Math.min(Math.abs(o),Math.abs(l),.5*Math.abs(c))||0}function WM(t,n){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-n)/2:n}function YN(t,n,r){var s=t._x0,i=t._y0,o=t._x1,l=t._y1,c=(o-s)/3;t._context.bezierCurveTo(s+c,i+c*n,o-c,l-c*r,o,l)}function Z1(t){this._context=t}Z1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:YN(this,this._t0,WM(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){var r=NaN;if(t=+t,n=+n,!(t===this._x1&&n===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,YN(this,WM(this,r=HM(this,t,n)),r);break;default:YN(this,this._t0,r=HM(this,t,n));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n,this._t0=r}}};function Vz(t){this._context=new Hz(t)}(Vz.prototype=Object.create(Z1.prototype)).point=function(t,n){Z1.prototype.point.call(this,n,t)};function Hz(t){this._context=t}Hz.prototype={moveTo:function(t,n){this._context.moveTo(n,t)},closePath:function(){this._context.closePath()},lineTo:function(t,n){this._context.lineTo(n,t)},bezierCurveTo:function(t,n,r,s,i,o){this._context.bezierCurveTo(n,t,s,r,o,i)}};function rNe(t){return new Z1(t)}function sNe(t){return new Vz(t)}function Wz(t){this._context=t}Wz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,n=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],n[0]):this._context.moveTo(t[0],n[0]),r===2)this._context.lineTo(t[1],n[1]);else for(var s=qM(t),i=qM(n),o=0,l=1;l<r;++o,++l)this._context.bezierCurveTo(s[0][o],i[0][o],s[1][o],i[1][o],t[l],n[l]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,n){this._x.push(+t),this._y.push(+n)}};function qM(t){var n,r=t.length-1,s,i=new Array(r),o=new Array(r),l=new Array(r);for(i[0]=0,o[0]=2,l[0]=t[0]+2*t[1],n=1;n<r-1;++n)i[n]=1,o[n]=4,l[n]=4*t[n]+2*t[n+1];for(i[r-1]=2,o[r-1]=7,l[r-1]=8*t[r-1]+t[r],n=1;n<r;++n)s=i[n]/o[n-1],o[n]-=s,l[n]-=s*l[n-1];for(i[r-1]=l[r-1]/o[r-1],n=r-2;n>=0;--n)i[n]=(l[n]-i[n+1])/o[n];for(o[r-1]=(t[r]+i[r-1])/2,n=0;n<r-1;++n)o[n]=2*t[n+1]-i[n+1];return[i,o]}function aNe(t){return new Wz(t)}function Yv(t,n){this._context=t,this._t=n}Yv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,n),this._context.lineTo(t,n);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,n)}break}}this._x=t,this._y=n}};function iNe(t){return new Yv(t,.5)}function oNe(t){return new Yv(t,0)}function lNe(t){return new Yv(t,1)}function nh(t,n){if((l=t.length)>1)for(var r=1,s,i,o=t[n[0]],l,c=o.length;r<l;++r)for(i=o,o=t[n[r]],s=0;s<c;++s)o[s][1]+=o[s][0]=isNaN(i[s][1])?i[s][0]:i[s][1]}function YS(t){for(var n=t.length,r=new Array(n);--n>=0;)r[n]=n;return r}function cNe(t,n){return t[n]}function dNe(t){const n=[];return n.key=t,n}function uNe(){var t=An([]),n=YS,r=nh,s=cNe;function i(o){var l=Array.from(t.apply(this,arguments),dNe),c,d=l.length,u=-1,h;for(const m of o)for(c=0,++u;c<d;++c)(l[c][u]=[0,+s(m,l[c].key,u,o)]).data=m;for(c=0,h=TE(n(l));c<d;++c)l[h[c]].index=c;return r(l,h),l}return i.keys=function(o){return arguments.length?(t=typeof o=="function"?o:An(Array.from(o)),i):t},i.value=function(o){return arguments.length?(s=typeof o=="function"?o:An(+o),i):s},i.order=function(o){return arguments.length?(n=o==null?YS:typeof o=="function"?o:An(Array.from(o)),i):n},i.offset=function(o){return arguments.length?(r=o??nh,i):r},i}function fNe(t,n){if((s=t.length)>0){for(var r,s,i=0,o=t[0].length,l;i<o;++i){for(l=r=0;r<s;++r)l+=t[r][i][1]||0;if(l)for(r=0;r<s;++r)t[r][i][1]/=l}nh(t,n)}}function hNe(t,n){if((i=t.length)>0){for(var r=0,s=t[n[0]],i,o=s.length;r<o;++r){for(var l=0,c=0;l<i;++l)c+=t[l][r][1]||0;s[r][1]+=s[r][0]=-c/2}nh(t,n)}}function mNe(t,n){if(!(!((l=t.length)>0)||!((o=(i=t[n[0]]).length)>0))){for(var r=0,s=1,i,o,l;s<o;++s){for(var c=0,d=0,u=0;c<l;++c){for(var h=t[n[c]],m=h[s][1]||0,g=h[s-1][1]||0,y=(m-g)/2,N=0;N<c;++N){var j=t[n[N]],S=j[s][1]||0,_=j[s-1][1]||0;y+=S-_}d+=m,u+=y*m}i[s-1][1]+=i[s-1][0]=r,d&&(r-=u/d)}i[s-1][1]+=i[s-1][0]=r,nh(t,n)}}var Xv={},qz={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(r){return r==="__proto__"}t.isUnsafeProperty=n})(qz);var PE={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}t.isDeepKey=n})(PE);var Qv={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(r){var s;return typeof r=="string"||typeof r=="symbol"?r:Object.is((s=r==null?void 0:r.valueOf)==null?void 0:s.call(r),-0)?"-0":String(r)}t.toKey=n})(Qv);var Zv={},Gz={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(n).join(",");const s=String(r);return s==="0"&&Object.is(Number(r),-0)?"-0":s}t.toString=n})(Gz);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=Gz,r=Qv;function s(i){if(Array.isArray(i))return i.map(r.toKey);if(typeof i=="symbol")return[i];i=n.toString(i);const o=[],l=i.length;if(l===0)return o;let c=0,d="",u="",h=!1;for(i.charCodeAt(0)===46&&(o.push(""),c++);c<l;){const m=i[c];u?m==="\\"&&c+1<l?(c++,d+=i[c]):m===u?u="":d+=m:h?m==='"'||m==="'"?u=m:m==="]"?(h=!1,o.push(d),d=""):d+=m:m==="["?(h=!0,d&&(o.push(d),d="")):m==="."?d&&(o.push(d),d=""):d+=m,c++}return d&&o.push(d),o}t.toPath=s})(Zv);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=qz,r=PE,s=Qv,i=Zv;function o(c,d,u){if(c==null)return u;switch(typeof d){case"string":{if(n.isUnsafeProperty(d))return u;const h=c[d];return h===void 0?r.isDeepKey(d)?o(c,i.toPath(d),u):u:h}case"number":case"symbol":{typeof d=="number"&&(d=s.toKey(d));const h=c[d];return h===void 0?u:h}default:{if(Array.isArray(d))return l(c,d,u);if(Object.is(d==null?void 0:d.valueOf(),-0)?d="-0":d=String(d),n.isUnsafeProperty(d))return u;const h=c[d];return h===void 0?u:h}}}function l(c,d,u){if(d.length===0)return u;let h=c;for(let m=0;m<d.length;m++){if(h==null||n.isUnsafeProperty(d[m]))return u;h=h[d[m]]}return h===void 0?u:h}t.get=o})(Xv);var pNe=Xv.get;const hu=gi(pNe);var ps=t=>t===0?0:t>0?1:-1,Po=t=>typeof t=="number"&&t!=+t,gl=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,vt=t=>(typeof t=="number"||t instanceof Number)&&!Po(t),Mo=t=>vt(t)||typeof t=="string",xNe=0,Up=t=>{var n=++xNe;return"".concat(t||"").concat(n)},Ms=function(n,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!vt(n)&&typeof n!="string")return s;var o;if(gl(n)){if(r==null)return s;var l=n.indexOf("%");o=r*parseFloat(n.slice(0,l))/100}else o=+n;return Po(o)&&(o=s),i&&r!=null&&o>r&&(o=r),o},Kz=t=>{if(!Array.isArray(t))return!1;for(var n=t.length,r={},s=0;s<n;s++)if(!r[t[s]])r[t[s]]=!0;else return!0;return!1};function Rr(t,n,r){return vt(t)&&vt(n)?t+r*(n-t):n}function gNe(t,n,r){if(!(!t||!t.length))return t.find(s=>s&&(typeof n=="function"?n(s):hu(s,n))===r)}var es=t=>t===null||typeof t>"u",Nx=t=>es(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1));function yNe(t){return t!=null}function ku(){}var vNe=["type","size","sizeType"];function XS(){return XS=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},XS.apply(null,arguments)}function GM(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function KM(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?GM(Object(r),!0).forEach(function(s){bNe(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):GM(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function bNe(t,n,r){return(n=wNe(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function wNe(t){var n=NNe(t,"string");return typeof n=="symbol"?n:n+""}function NNe(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function jNe(t,n){if(t==null)return{};var r,s,i=SNe(t,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],n.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function SNe(t,n){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(n.indexOf(s)!==-1)continue;r[s]=t[s]}return r}var Yz={symbolCircle:IE,symbolCross:zwe,symbolDiamond:Vwe,symbolSquare:Hwe,symbolStar:Kwe,symbolTriangle:Ywe,symbolWye:Qwe},CNe=Math.PI/180,_Ne=t=>{var n="symbol".concat(Nx(t));return Yz[n]||IE},ANe=(t,n,r)=>{if(n==="area")return t;switch(r){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var s=18*CNe;return 1.25*t*t*(Math.tan(s)-Math.tan(s*2)*Math.tan(s)**2)}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},ENe=(t,n)=>{Yz["symbol".concat(Nx(t))]=n},Xz=t=>{var{type:n="circle",size:r=64,sizeType:s="area"}=t,i=jNe(t,vNe),o=KM(KM({},i),{},{type:n,size:r,sizeType:s}),l="circle";typeof n=="string"&&(l=n);var c=()=>{var g=_Ne(l),y=Zwe().type(g).size(ANe(r,s,l)),N=y();if(N!==null)return N},{className:d,cx:u,cy:h}=o,m=mi(o);return vt(u)&&vt(h)&&vt(r)?b.createElement("path",XS({},m,{className:cn("recharts-symbols",d),transform:"translate(".concat(u,", ").concat(h,")"),d:c()})):null};Xz.registerSymbol=ENe;var Qz=t=>"radius"in t&&"startAngle"in t&&"endAngle"in t,kNe=(t,n)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(b.isValidElement(t)&&(r=t.props),typeof r!="object"&&typeof r!="function")return null;var s={};return Object.keys(r).forEach(i=>{EE(i)&&(s[i]=o=>r[i](r,o))}),s},TNe=(t,n,r)=>s=>(t(n,r,s),null),Jv=(t,n,r)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var s=null;return Object.keys(t).forEach(i=>{var o=t[i];EE(i)&&typeof o=="function"&&(s||(s={}),s[i]=TNe(o,n,r))}),s};function YM(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function INe(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?YM(Object(r),!0).forEach(function(s){PNe(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):YM(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function PNe(t,n,r){return(n=MNe(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function MNe(t){var n=ONe(t,"string");return typeof n=="symbol"?n:n+""}function ONe(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function Xs(t,n){var r=INe({},t),s=n,i=Object.keys(n),o=i.reduce((l,c)=>(l[c]===void 0&&s[c]!==void 0&&(l[c]=s[c]),l),r);return o}var Zz={},Jz={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(r,s){const i=new Map;for(let o=0;o<r.length;o++){const l=r[o],c=s(l);i.has(c)||i.set(c,l)}return Array.from(i.values())}t.uniqBy=n})(Jz);var ME={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(r){return r}t.identity=n})(ME);var eU={},eb={},tU={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(r){return Number.isSafeInteger(r)&&r>=0}t.isLength=n})(tU);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=tU;function r(s){return s!=null&&typeof s!="function"&&n.isLength(s.length)}t.isArrayLike=r})(eb);var nU={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(r){return typeof r=="object"&&r!==null}t.isObjectLike=n})(nU);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=eb,r=nU;function s(i){return r.isObjectLike(i)&&n.isArrayLike(i)}t.isArrayLikeObject=s})(eU);var rU={},sU={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=Xv;function r(s){return function(i){return n.get(i,s)}}t.property=r})(sU);var aU={},OE={},iU={},DE={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(r){return r!==null&&(typeof r=="object"||typeof r=="function")}t.isObject=n})(DE);var RE={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(r){return r==null||typeof r!="object"&&typeof r!="function"}t.isPrimitive=n})(RE);var LE={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(r,s){return r===s||Number.isNaN(r)&&Number.isNaN(s)}t.eq=n})(LE);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=DE,r=RE,s=LE;function i(h,m,g){return typeof g!="function"?i(h,m,()=>{}):o(h,m,function y(N,j,S,_,A,k){const T=g(N,j,S,_,A,k);return T!==void 0?!!T:o(N,j,y,k)},new Map)}function o(h,m,g,y){if(m===h)return!0;switch(typeof m){case"object":return l(h,m,g,y);case"function":return Object.keys(m).length>0?o(h,{...m},g,y):s.eq(h,m);default:return n.isObject(h)?typeof m=="string"?m==="":!0:s.eq(h,m)}}function l(h,m,g,y){if(m==null)return!0;if(Array.isArray(m))return d(h,m,g,y);if(m instanceof Map)return c(h,m,g,y);if(m instanceof Set)return u(h,m,g,y);const N=Object.keys(m);if(h==null)return N.length===0;if(N.length===0)return!0;if(y!=null&&y.has(m))return y.get(m)===h;y==null||y.set(m,h);try{for(let j=0;j<N.length;j++){const S=N[j];if(!r.isPrimitive(h)&&!(S in h)||m[S]===void 0&&h[S]!==void 0||m[S]===null&&h[S]!==null||!g(h[S],m[S],S,h,m,y))return!1}return!0}finally{y==null||y.delete(m)}}function c(h,m,g,y){if(m.size===0)return!0;if(!(h instanceof Map))return!1;for(const[N,j]of m.entries()){const S=h.get(N);if(g(S,j,N,h,m,y)===!1)return!1}return!0}function d(h,m,g,y){if(m.length===0)return!0;if(!Array.isArray(h))return!1;const N=new Set;for(let j=0;j<m.length;j++){const S=m[j];let _=!1;for(let A=0;A<h.length;A++){if(N.has(A))continue;const k=h[A];let T=!1;if(g(k,S,j,h,m,y)&&(T=!0),T){N.add(A),_=!0;break}}if(!_)return!1}return!0}function u(h,m,g,y){return m.size===0?!0:h instanceof Set?d([...h],[...m],g,y):!1}t.isMatchWith=i,t.isSetMatch=u})(iU);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=iU;function r(s,i){return n.isMatchWith(s,i,()=>{})}t.isMatch=r})(OE);var oU={},BE={},lU={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(r){return Object.getOwnPropertySymbols(r).filter(s=>Object.prototype.propertyIsEnumerable.call(r,s))}t.getSymbols=n})(lU);var FE={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}t.getTag=n})(FE);var $E={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n="[object RegExp]",r="[object String]",s="[object Number]",i="[object Boolean]",o="[object Arguments]",l="[object Symbol]",c="[object Date]",d="[object Map]",u="[object Set]",h="[object Array]",m="[object Function]",g="[object ArrayBuffer]",y="[object Object]",N="[object Error]",j="[object DataView]",S="[object Uint8Array]",_="[object Uint8ClampedArray]",A="[object Uint16Array]",k="[object Uint32Array]",T="[object BigUint64Array]",P="[object Int8Array]",M="[object Int16Array]",O="[object Int32Array]",D="[object BigInt64Array]",L="[object Float32Array]",$="[object Float64Array]";t.argumentsTag=o,t.arrayBufferTag=g,t.arrayTag=h,t.bigInt64ArrayTag=D,t.bigUint64ArrayTag=T,t.booleanTag=i,t.dataViewTag=j,t.dateTag=c,t.errorTag=N,t.float32ArrayTag=L,t.float64ArrayTag=$,t.functionTag=m,t.int16ArrayTag=M,t.int32ArrayTag=O,t.int8ArrayTag=P,t.mapTag=d,t.numberTag=s,t.objectTag=y,t.regexpTag=n,t.setTag=u,t.stringTag=r,t.symbolTag=l,t.uint16ArrayTag=A,t.uint32ArrayTag=k,t.uint8ArrayTag=S,t.uint8ClampedArrayTag=_})($E);var cU={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}t.isTypedArray=n})(cU);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=lU,r=FE,s=$E,i=RE,o=cU;function l(h,m){return c(h,void 0,h,new Map,m)}function c(h,m,g,y=new Map,N=void 0){const j=N==null?void 0:N(h,m,g,y);if(j!==void 0)return j;if(i.isPrimitive(h))return h;if(y.has(h))return y.get(h);if(Array.isArray(h)){const S=new Array(h.length);y.set(h,S);for(let _=0;_<h.length;_++)S[_]=c(h[_],_,g,y,N);return Object.hasOwn(h,"index")&&(S.index=h.index),Object.hasOwn(h,"input")&&(S.input=h.input),S}if(h instanceof Date)return new Date(h.getTime());if(h instanceof RegExp){const S=new RegExp(h.source,h.flags);return S.lastIndex=h.lastIndex,S}if(h instanceof Map){const S=new Map;y.set(h,S);for(const[_,A]of h)S.set(_,c(A,_,g,y,N));return S}if(h instanceof Set){const S=new Set;y.set(h,S);for(const _ of h)S.add(c(_,void 0,g,y,N));return S}if(typeof Buffer<"u"&&Buffer.isBuffer(h))return h.subarray();if(o.isTypedArray(h)){const S=new(Object.getPrototypeOf(h)).constructor(h.length);y.set(h,S);for(let _=0;_<h.length;_++)S[_]=c(h[_],_,g,y,N);return S}if(h instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&h instanceof SharedArrayBuffer)return h.slice(0);if(h instanceof DataView){const S=new DataView(h.buffer.slice(0),h.byteOffset,h.byteLength);return y.set(h,S),d(S,h,g,y,N),S}if(typeof File<"u"&&h instanceof File){const S=new File([h],h.name,{type:h.type});return y.set(h,S),d(S,h,g,y,N),S}if(typeof Blob<"u"&&h instanceof Blob){const S=new Blob([h],{type:h.type});return y.set(h,S),d(S,h,g,y,N),S}if(h instanceof Error){const S=new h.constructor;return y.set(h,S),S.message=h.message,S.name=h.name,S.stack=h.stack,S.cause=h.cause,d(S,h,g,y,N),S}if(h instanceof Boolean){const S=new Boolean(h.valueOf());return y.set(h,S),d(S,h,g,y,N),S}if(h instanceof Number){const S=new Number(h.valueOf());return y.set(h,S),d(S,h,g,y,N),S}if(h instanceof String){const S=new String(h.valueOf());return y.set(h,S),d(S,h,g,y,N),S}if(typeof h=="object"&&u(h)){const S=Object.create(Object.getPrototypeOf(h));return y.set(h,S),d(S,h,g,y,N),S}return h}function d(h,m,g=h,y,N){const j=[...Object.keys(m),...n.getSymbols(m)];for(let S=0;S<j.length;S++){const _=j[S],A=Object.getOwnPropertyDescriptor(h,_);(A==null||A.writable)&&(h[_]=c(m[_],_,g,y,N))}}function u(h){switch(r.getTag(h)){case s.argumentsTag:case s.arrayTag:case s.arrayBufferTag:case s.dataViewTag:case s.booleanTag:case s.dateTag:case s.float32ArrayTag:case s.float64ArrayTag:case s.int8ArrayTag:case s.int16ArrayTag:case s.int32ArrayTag:case s.mapTag:case s.numberTag:case s.objectTag:case s.regexpTag:case s.setTag:case s.stringTag:case s.symbolTag:case s.uint8ArrayTag:case s.uint8ClampedArrayTag:case s.uint16ArrayTag:case s.uint32ArrayTag:return!0;default:return!1}}t.cloneDeepWith=l,t.cloneDeepWithImpl=c,t.copyProperties=d})(BE);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=BE;function r(s){return n.cloneDeepWithImpl(s,void 0,s,new Map,void 0)}t.cloneDeep=r})(oU);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=OE,r=oU;function s(i){return i=r.cloneDeep(i),o=>n.isMatch(o,i)}t.matches=s})(aU);var dU={},uU={},fU={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=BE,r=$E;function s(i,o){return n.cloneDeepWith(i,(l,c,d,u)=>{const h=o==null?void 0:o(l,c,d,u);if(h!==void 0)return h;if(typeof i=="object")switch(Object.prototype.toString.call(i)){case r.numberTag:case r.stringTag:case r.booleanTag:{const m=new i.constructor(i==null?void 0:i.valueOf());return n.copyProperties(m,i),m}case r.argumentsTag:{const m={};return n.copyProperties(m,i),m.length=i.length,m[Symbol.iterator]=i[Symbol.iterator],m}default:return}})}t.cloneDeepWith=s})(fU);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=fU;function r(s){return n.cloneDeepWith(s)}t.cloneDeep=r})(uU);var hU={},zE={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=/^(?:0|[1-9]\d*)$/;function r(s,i=Number.MAX_SAFE_INTEGER){switch(typeof s){case"number":return Number.isInteger(s)&&s>=0&&s<i;case"symbol":return!1;case"string":return n.test(s)}}t.isIndex=r})(zE);var mU={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=FE;function r(s){return s!==null&&typeof s=="object"&&n.getTag(s)==="[object Arguments]"}t.isArguments=r})(mU);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=PE,r=zE,s=mU,i=Zv;function o(l,c){let d;if(Array.isArray(c)?d=c:typeof c=="string"&&n.isDeepKey(c)&&(l==null?void 0:l[c])==null?d=i.toPath(c):d=[c],d.length===0)return!1;let u=l;for(let h=0;h<d.length;h++){const m=d[h];if((u==null||!Object.hasOwn(u,m))&&!((Array.isArray(u)||s.isArguments(u))&&r.isIndex(m)&&m<u.length))return!1;u=u[m]}return!0}t.has=o})(hU);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=OE,r=Qv,s=uU,i=Xv,o=hU;function l(c,d){switch(typeof c){case"object":{Object.is(c==null?void 0:c.valueOf(),-0)&&(c="-0");break}case"number":{c=r.toKey(c);break}}return d=s.cloneDeep(d),function(u){const h=i.get(u,c);return h===void 0?o.has(u,c):d===void 0?h===void 0:n.isMatch(h,d)}}t.matchesProperty=l})(dU);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=ME,r=sU,s=aU,i=dU;function o(l){if(l==null)return n.identity;switch(typeof l){case"function":return l;case"object":return Array.isArray(l)&&l.length===2?i.matchesProperty(l[0],l[1]):s.matches(l);case"string":case"symbol":case"number":return r.property(l)}}t.iteratee=o})(rU);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=Jz,r=ME,s=eU,i=rU;function o(l,c=r.identity){return s.isArrayLikeObject(l)?n.uniqBy(Array.from(l),i.iteratee(c)):[]}t.uniqBy=o})(Zz);var DNe=Zz.uniqBy;const XM=gi(DNe);function RNe(t,n,r){return n===!0?XM(t,r):typeof n=="function"?XM(t,n):t}var UE=b.createContext(null),LNe=t=>t,Vn=()=>{var t=b.useContext(UE);return t?t.store.dispatch:LNe},Lg=()=>{},BNe=()=>Lg,FNe=(t,n)=>t===n;function mt(t){var n=b.useContext(UE);return uL.useSyncExternalStoreWithSelector(n?n.subscription.addNestedSub:BNe,n?n.store.getState:Lg,n?n.store.getState:Lg,n?t:Lg,FNe)}function $Ne(t,n=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(n)}function zNe(t,n=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(n)}function UNe(t,n="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(s=>typeof s=="function"?`function ${s.name||"unnamed"}()`:typeof s).join(", ");throw new TypeError(`${n}[${r}]`)}}var QM=t=>Array.isArray(t)?t:[t];function VNe(t){const n=Array.isArray(t[0])?t[0]:t;return UNe(n,"createSelector expects all input-selectors to be functions, but received the following types: "),n}function HNe(t,n){const r=[],{length:s}=t;for(let i=0;i<s;i++)r.push(t[i].apply(null,n));return r}var WNe=class{constructor(t){this.value=t}deref(){return this.value}},qNe=typeof WeakRef<"u"?WeakRef:WNe,GNe=0,ZM=1;function U0(){return{s:GNe,v:void 0,o:null,p:null}}function pU(t,n={}){let r=U0();const{resultEqualityCheck:s}=n;let i,o=0;function l(){var m;let c=r;const{length:d}=arguments;for(let g=0,y=d;g<y;g++){const N=arguments[g];if(typeof N=="function"||typeof N=="object"&&N!==null){let j=c.o;j===null&&(c.o=j=new WeakMap);const S=j.get(N);S===void 0?(c=U0(),j.set(N,c)):c=S}else{let j=c.p;j===null&&(c.p=j=new Map);const S=j.get(N);S===void 0?(c=U0(),j.set(N,c)):c=S}}const u=c;let h;if(c.s===ZM)h=c.v;else if(h=t.apply(null,arguments),o++,s){const g=((m=i==null?void 0:i.deref)==null?void 0:m.call(i))??i;g!=null&&s(g,h)&&(h=g,o!==0&&o--),i=typeof h=="object"&&h!==null||typeof h=="function"?new qNe(h):h}return u.s=ZM,u.v=h,h}return l.clearCache=()=>{r=U0(),l.resetResultsCount()},l.resultsCount=()=>o,l.resetResultsCount=()=>{o=0},l}function KNe(t,...n){const r=typeof t=="function"?{memoize:t,memoizeOptions:n}:t,s=(...i)=>{let o=0,l=0,c,d={},u=i.pop();typeof u=="object"&&(d=u,u=i.pop()),$Ne(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const h={...r,...d},{memoize:m,memoizeOptions:g=[],argsMemoize:y=pU,argsMemoizeOptions:N=[]}=h,j=QM(g),S=QM(N),_=VNe(i),A=m(function(){return o++,u.apply(null,arguments)},...j),k=y(function(){l++;const P=HNe(_,arguments);return c=A.apply(null,P),c},...S);return Object.assign(k,{resultFunc:u,memoizedResultFunc:A,dependencies:_,dependencyRecomputations:()=>l,resetDependencyRecomputations:()=>{l=0},lastResult:()=>c,recomputations:()=>o,resetRecomputations:()=>{o=0},memoize:m,argsMemoize:y})};return Object.assign(s,{withTypes:()=>s}),s}var je=KNe(pU),YNe=Object.assign((t,n=je)=>{zNe(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),s=r.map(o=>t[o]);return n(s,(...o)=>o.reduce((l,c,d)=>(l[r[d]]=c,l),{}))},{withTypes:()=>YNe}),xU={},gU={},yU={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(s){return typeof s=="symbol"?1:s===null?2:s===void 0?3:s!==s?4:0}const r=(s,i,o)=>{if(s!==i){const l=n(s),c=n(i);if(l===c&&l===0){if(s<i)return o==="desc"?1:-1;if(s>i)return o==="desc"?-1:1}return o==="desc"?c-l:l-c}return 0};t.compareValues=r})(yU);var vU={},VE={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(r){return typeof r=="symbol"||r instanceof Symbol}t.isSymbol=n})(VE);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=VE,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;function i(o,l){return Array.isArray(o)?!1:typeof o=="number"||typeof o=="boolean"||o==null||n.isSymbol(o)?!0:typeof o=="string"&&(s.test(o)||!r.test(o))||l!=null&&Object.hasOwn(l,o)}t.isKey=i})(vU);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=yU,r=vU,s=Zv;function i(o,l,c,d){if(o==null)return[];c=d?void 0:c,Array.isArray(o)||(o=Object.values(o)),Array.isArray(l)||(l=l==null?[null]:[l]),l.length===0&&(l=[null]),Array.isArray(c)||(c=c==null?[]:[c]),c=c.map(y=>String(y));const u=(y,N)=>{let j=y;for(let S=0;S<N.length&&j!=null;++S)j=j[N[S]];return j},h=(y,N)=>N==null||y==null?N:typeof y=="object"&&"key"in y?Object.hasOwn(N,y.key)?N[y.key]:u(N,y.path):typeof y=="function"?y(N):Array.isArray(y)?u(N,y):typeof N=="object"?N[y]:N,m=l.map(y=>(Array.isArray(y)&&y.length===1&&(y=y[0]),y==null||typeof y=="function"||Array.isArray(y)||r.isKey(y)?y:{key:y,path:s.toPath(y)}));return o.map(y=>({original:y,criteria:m.map(N=>h(N,y))})).slice().sort((y,N)=>{for(let j=0;j<m.length;j++){const S=n.compareValues(y.criteria[j],N.criteria[j],c[j]);if(S!==0)return S}return 0}).map(y=>y.original)}t.orderBy=i})(gU);var bU={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(r,s=1){const i=[],o=Math.floor(s),l=(c,d)=>{for(let u=0;u<c.length;u++){const h=c[u];Array.isArray(h)&&d<o?l(h,d+1):i.push(h)}};return l(r,0),i}t.flatten=n})(bU);var HE={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=zE,r=eb,s=DE,i=LE;function o(l,c,d){return s.isObject(d)&&(typeof c=="number"&&r.isArrayLike(d)&&n.isIndex(c)&&c<d.length||typeof c=="string"&&c in d)?i.eq(d[c],l):!1}t.isIterateeCall=o})(HE);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=gU,r=bU,s=HE;function i(o,...l){const c=l.length;return c>1&&s.isIterateeCall(o,l[0],l[1])?l=[]:c>2&&s.isIterateeCall(l[0],l[1],l[2])&&(l=[l[0]]),n.orderBy(o,r.flatten(l),["asc"])}t.sortBy=i})(xU);var XNe=xU.sortBy;const tb=gi(XNe);var wU=t=>t.legend.settings,QNe=t=>t.legend.size,ZNe=t=>t.legend.payload;je([ZNe,wU],(t,n)=>{var{itemSorter:r}=n,s=t.flat(1);return r?tb(s,r):s});var V0=1;function JNe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[n,r]=b.useState({height:0,left:0,top:0,width:0}),s=b.useCallback(i=>{if(i!=null){var o=i.getBoundingClientRect(),l={height:o.height,left:o.left,top:o.top,width:o.width};(Math.abs(l.height-n.height)>V0||Math.abs(l.left-n.left)>V0||Math.abs(l.top-n.top)>V0||Math.abs(l.width-n.width)>V0)&&r({height:l.height,left:l.left,top:l.top,width:l.width})}},[n.width,n.height,n.top,n.left,...t]);return[n,s]}function ds(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var e2e=typeof Symbol=="function"&&Symbol.observable||"@@observable",JM=e2e,XN=()=>Math.random().toString(36).substring(7).split("").join("."),t2e={INIT:`@@redux/INIT${XN()}`,REPLACE:`@@redux/REPLACE${XN()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${XN()}`},J1=t2e;function WE(t){if(typeof t!="object"||t===null)return!1;let n=t;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(t)===n||Object.getPrototypeOf(t)===null}function NU(t,n,r){if(typeof t!="function")throw new Error(ds(2));if(typeof n=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(ds(0));if(typeof n=="function"&&typeof r>"u"&&(r=n,n=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(ds(1));return r(NU)(t,n)}let s=t,i=n,o=new Map,l=o,c=0,d=!1;function u(){l===o&&(l=new Map,o.forEach((S,_)=>{l.set(_,S)}))}function h(){if(d)throw new Error(ds(3));return i}function m(S){if(typeof S!="function")throw new Error(ds(4));if(d)throw new Error(ds(5));let _=!0;u();const A=c++;return l.set(A,S),function(){if(_){if(d)throw new Error(ds(6));_=!1,u(),l.delete(A),o=null}}}function g(S){if(!WE(S))throw new Error(ds(7));if(typeof S.type>"u")throw new Error(ds(8));if(typeof S.type!="string")throw new Error(ds(17));if(d)throw new Error(ds(9));try{d=!0,i=s(i,S)}finally{d=!1}return(o=l).forEach(A=>{A()}),S}function y(S){if(typeof S!="function")throw new Error(ds(10));s=S,g({type:J1.REPLACE})}function N(){const S=m;return{subscribe(_){if(typeof _!="object"||_===null)throw new Error(ds(11));function A(){const T=_;T.next&&T.next(h())}return A(),{unsubscribe:S(A)}},[JM](){return this}}}return g({type:J1.INIT}),{dispatch:g,subscribe:m,getState:h,replaceReducer:y,[JM]:N}}function n2e(t){Object.keys(t).forEach(n=>{const r=t[n];if(typeof r(void 0,{type:J1.INIT})>"u")throw new Error(ds(12));if(typeof r(void 0,{type:J1.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(ds(13))})}function jU(t){const n=Object.keys(t),r={};for(let o=0;o<n.length;o++){const l=n[o];typeof t[l]=="function"&&(r[l]=t[l])}const s=Object.keys(r);let i;try{n2e(r)}catch(o){i=o}return function(l={},c){if(i)throw i;let d=!1;const u={};for(let h=0;h<s.length;h++){const m=s[h],g=r[m],y=l[m],N=g(y,c);if(typeof N>"u")throw c&&c.type,new Error(ds(14));u[m]=N,d=d||N!==y}return d=d||s.length!==Object.keys(l).length,d?u:l}}function ey(...t){return t.length===0?n=>n:t.length===1?t[0]:t.reduce((n,r)=>(...s)=>n(r(...s)))}function r2e(...t){return n=>(r,s)=>{const i=n(r,s);let o=()=>{throw new Error(ds(15))};const l={getState:i.getState,dispatch:(d,...u)=>o(d,...u)},c=t.map(d=>d(l));return o=ey(...c)(i.dispatch),{...i,dispatch:o}}}function SU(t){return WE(t)&&"type"in t&&typeof t.type=="string"}var CU=Symbol.for("immer-nothing"),e4=Symbol.for("immer-draftable"),Fa=Symbol.for("immer-state");function Mi(t,...n){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Vp=Object.getPrototypeOf;function mu(t){return!!t&&!!t[Fa]}function yl(t){var n;return t?_U(t)||Array.isArray(t)||!!t[e4]||!!((n=t.constructor)!=null&&n[e4])||jx(t)||rb(t):!1}var s2e=Object.prototype.constructor.toString(),t4=new WeakMap;function _U(t){if(!t||typeof t!="object")return!1;const n=Object.getPrototypeOf(t);if(n===null||n===Object.prototype)return!0;const r=Object.hasOwnProperty.call(n,"constructor")&&n.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let s=t4.get(r);return s===void 0&&(s=Function.toString.call(r),t4.set(r,s)),s===s2e}function ty(t,n,r=!0){nb(t)===0?(r?Reflect.ownKeys(t):Object.keys(t)).forEach(i=>{n(i,t[i],t)}):t.forEach((s,i)=>n(i,s,t))}function nb(t){const n=t[Fa];return n?n.type_:Array.isArray(t)?1:jx(t)?2:rb(t)?3:0}function QS(t,n){return nb(t)===2?t.has(n):Object.prototype.hasOwnProperty.call(t,n)}function AU(t,n,r){const s=nb(t);s===2?t.set(n,r):s===3?t.add(r):t[n]=r}function a2e(t,n){return t===n?t!==0||1/t===1/n:t!==t&&n!==n}function jx(t){return t instanceof Map}function rb(t){return t instanceof Set}function xd(t){return t.copy_||t.base_}function ZS(t,n){if(jx(t))return new Map(t);if(rb(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=_U(t);if(n===!0||n==="class_only"&&!r){const s=Object.getOwnPropertyDescriptors(t);delete s[Fa];let i=Reflect.ownKeys(s);for(let o=0;o<i.length;o++){const l=i[o],c=s[l];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(s[l]={configurable:!0,writable:!0,enumerable:c.enumerable,value:t[l]})}return Object.create(Vp(t),s)}else{const s=Vp(t);if(s!==null&&r)return{...t};const i=Object.create(s);return Object.assign(i,t)}}function qE(t,n=!1){return sb(t)||mu(t)||!yl(t)||(nb(t)>1&&Object.defineProperties(t,{set:H0,add:H0,clear:H0,delete:H0}),Object.freeze(t),n&&Object.values(t).forEach(r=>qE(r,!0))),t}function i2e(){Mi(2)}var H0={value:i2e};function sb(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var o2e={};function pu(t){const n=o2e[t];return n||Mi(0,t),n}var Hp;function EU(){return Hp}function l2e(t,n){return{drafts_:[],parent_:t,immer_:n,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function n4(t,n){n&&(pu("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=n)}function JS(t){eC(t),t.drafts_.forEach(c2e),t.drafts_=null}function eC(t){t===Hp&&(Hp=t.parent_)}function r4(t){return Hp=l2e(Hp,t)}function c2e(t){const n=t[Fa];n.type_===0||n.type_===1?n.revoke_():n.revoked_=!0}function s4(t,n){n.unfinalizedDrafts_=n.drafts_.length;const r=n.drafts_[0];return t!==void 0&&t!==r?(r[Fa].modified_&&(JS(n),Mi(4)),yl(t)&&(t=ny(n,t),n.parent_||ry(n,t)),n.patches_&&pu("Patches").generateReplacementPatches_(r[Fa].base_,t,n.patches_,n.inversePatches_)):t=ny(n,r,[]),JS(n),n.patches_&&n.patchListener_(n.patches_,n.inversePatches_),t!==CU?t:void 0}function ny(t,n,r){if(sb(n))return n;const s=t.immer_.shouldUseStrictIteration(),i=n[Fa];if(!i)return ty(n,(o,l)=>a4(t,i,n,o,l,r),s),n;if(i.scope_!==t)return n;if(!i.modified_)return ry(t,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const o=i.copy_;let l=o,c=!1;i.type_===3&&(l=new Set(o),o.clear(),c=!0),ty(l,(d,u)=>a4(t,i,o,d,u,r,c),s),ry(t,o,!1),r&&t.patches_&&pu("Patches").generatePatches_(i,r,t.patches_,t.inversePatches_)}return i.copy_}function a4(t,n,r,s,i,o,l){if(i==null||typeof i!="object"&&!l)return;const c=sb(i);if(!(c&&!l)){if(mu(i)){const d=o&&n&&n.type_!==3&&!QS(n.assigned_,s)?o.concat(s):void 0,u=ny(t,i,d);if(AU(r,s,u),mu(u))t.canAutoFreeze_=!1;else return}else l&&r.add(i);if(yl(i)&&!c){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||n&&n.base_&&n.base_[s]===i&&c)return;ny(t,i),(!n||!n.scope_.parent_)&&typeof s!="symbol"&&(jx(r)?r.has(s):Object.prototype.propertyIsEnumerable.call(r,s))&&ry(t,i)}}}function ry(t,n,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&qE(n,r)}function d2e(t,n){const r=Array.isArray(t),s={type_:r?1:0,scope_:n?n.scope_:EU(),modified_:!1,finalized_:!1,assigned_:{},parent_:n,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=s,o=GE;r&&(i=[s],o=Wp);const{revoke:l,proxy:c}=Proxy.revocable(i,o);return s.draft_=c,s.revoke_=l,c}var GE={get(t,n){if(n===Fa)return t;const r=xd(t);if(!QS(r,n))return u2e(t,r,n);const s=r[n];return t.finalized_||!yl(s)?s:s===QN(t.base_,n)?(ZN(t),t.copy_[n]=nC(s,t)):s},has(t,n){return n in xd(t)},ownKeys(t){return Reflect.ownKeys(xd(t))},set(t,n,r){const s=kU(xd(t),n);if(s!=null&&s.set)return s.set.call(t.draft_,r),!0;if(!t.modified_){const i=QN(xd(t),n),o=i==null?void 0:i[Fa];if(o&&o.base_===r)return t.copy_[n]=r,t.assigned_[n]=!1,!0;if(a2e(r,i)&&(r!==void 0||QS(t.base_,n)))return!0;ZN(t),tC(t)}return t.copy_[n]===r&&(r!==void 0||n in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[n])||(t.copy_[n]=r,t.assigned_[n]=!0),!0},deleteProperty(t,n){return QN(t.base_,n)!==void 0||n in t.base_?(t.assigned_[n]=!1,ZN(t),tC(t)):delete t.assigned_[n],t.copy_&&delete t.copy_[n],!0},getOwnPropertyDescriptor(t,n){const r=xd(t),s=Reflect.getOwnPropertyDescriptor(r,n);return s&&{writable:!0,configurable:t.type_!==1||n!=="length",enumerable:s.enumerable,value:r[n]}},defineProperty(){Mi(11)},getPrototypeOf(t){return Vp(t.base_)},setPrototypeOf(){Mi(12)}},Wp={};ty(GE,(t,n)=>{Wp[t]=function(){return arguments[0]=arguments[0][0],n.apply(this,arguments)}});Wp.deleteProperty=function(t,n){return Wp.set.call(this,t,n,void 0)};Wp.set=function(t,n,r){return GE.set.call(this,t[0],n,r,t[0])};function QN(t,n){const r=t[Fa];return(r?xd(r):t)[n]}function u2e(t,n,r){var i;const s=kU(n,r);return s?"value"in s?s.value:(i=s.get)==null?void 0:i.call(t.draft_):void 0}function kU(t,n){if(!(n in t))return;let r=Vp(t);for(;r;){const s=Object.getOwnPropertyDescriptor(r,n);if(s)return s;r=Vp(r)}}function tC(t){t.modified_||(t.modified_=!0,t.parent_&&tC(t.parent_))}function ZN(t){t.copy_||(t.copy_=ZS(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var f2e=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(n,r,s)=>{if(typeof n=="function"&&typeof r!="function"){const o=r;r=n;const l=this;return function(d=o,...u){return l.produce(d,h=>r.call(this,h,...u))}}typeof r!="function"&&Mi(6),s!==void 0&&typeof s!="function"&&Mi(7);let i;if(yl(n)){const o=r4(this),l=nC(n,void 0);let c=!0;try{i=r(l),c=!1}finally{c?JS(o):eC(o)}return n4(o,s),s4(i,o)}else if(!n||typeof n!="object"){if(i=r(n),i===void 0&&(i=n),i===CU&&(i=void 0),this.autoFreeze_&&qE(i,!0),s){const o=[],l=[];pu("Patches").generateReplacementPatches_(n,i,o,l),s(o,l)}return i}else Mi(1,n)},this.produceWithPatches=(n,r)=>{if(typeof n=="function")return(l,...c)=>this.produceWithPatches(l,d=>n(d,...c));let s,i;return[this.produce(n,r,(l,c)=>{s=l,i=c}),s,i]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof(t==null?void 0:t.useStrictIteration)=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){yl(t)||Mi(8),mu(t)&&(t=il(t));const n=r4(this),r=nC(t,void 0);return r[Fa].isManual_=!0,eC(n),r}finishDraft(t,n){const r=t&&t[Fa];(!r||!r.isManual_)&&Mi(9);const{scope_:s}=r;return n4(s,n),s4(void 0,s)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,n){let r;for(r=n.length-1;r>=0;r--){const i=n[r];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}r>-1&&(n=n.slice(r+1));const s=pu("Patches").applyPatches_;return mu(t)?s(t,n):this.produce(t,i=>s(i,n))}};function nC(t,n){const r=jx(t)?pu("MapSet").proxyMap_(t,n):rb(t)?pu("MapSet").proxySet_(t,n):d2e(t,n);return(n?n.scope_:EU()).drafts_.push(r),r}function il(t){return mu(t)||Mi(10,t),TU(t)}function TU(t){if(!yl(t)||sb(t))return t;const n=t[Fa];let r,s=!0;if(n){if(!n.modified_)return n.base_;n.finalized_=!0,r=ZS(t,n.scope_.immer_.useStrictShallowCopy_),s=n.scope_.immer_.shouldUseStrictIteration()}else r=ZS(t,!0);return ty(r,(i,o)=>{AU(r,i,TU(o))},s),n&&(n.finalized_=!1),r}var rC=new f2e,IU=rC.produce,h2e=rC.setUseStrictIteration.bind(rC);function PU(t){return({dispatch:r,getState:s})=>i=>o=>typeof o=="function"?o(r,s,t):i(o)}var m2e=PU(),p2e=PU,x2e=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?ey:ey.apply(null,arguments)};function pi(t,n){function r(...s){if(n){let i=n(...s);if(!i)throw new Error(Da(0));return{type:t,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:t,payload:s[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=s=>SU(s)&&s.type===t,r}var MU=class Tm extends Array{constructor(...n){super(...n),Object.setPrototypeOf(this,Tm.prototype)}static get[Symbol.species](){return Tm}concat(...n){return super.concat.apply(this,n)}prepend(...n){return n.length===1&&Array.isArray(n[0])?new Tm(...n[0].concat(this)):new Tm(...n.concat(this))}};function i4(t){return yl(t)?IU(t,()=>{}):t}function W0(t,n,r){return t.has(n)?t.get(n):t.set(n,r(n)).get(n)}function g2e(t){return typeof t=="boolean"}var y2e=()=>function(n){const{thunk:r=!0,immutableCheck:s=!0,serializableCheck:i=!0,actionCreatorCheck:o=!0}=n??{};let l=new MU;return r&&(g2e(r)?l.push(m2e):l.push(p2e(r.extraArgument))),l},OU="RTK_autoBatch",Fr=()=>t=>({payload:t,meta:{[OU]:!0}}),o4=t=>n=>{setTimeout(n,t)},DU=(t={type:"raf"})=>n=>(...r)=>{const s=n(...r);let i=!0,o=!1,l=!1;const c=new Set,d=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:o4(10):t.type==="callback"?t.queueNotification:o4(t.timeout),u=()=>{l=!1,o&&(o=!1,c.forEach(h=>h()))};return Object.assign({},s,{subscribe(h){const m=()=>i&&h(),g=s.subscribe(m);return c.add(h),()=>{g(),c.delete(h)}},dispatch(h){var m;try{return i=!((m=h==null?void 0:h.meta)!=null&&m[OU]),o=!i,o&&(l||(l=!0,d(u))),s.dispatch(h)}finally{i=!0}}})},v2e=t=>function(r){const{autoBatch:s=!0}=r??{};let i=new MU(t);return s&&i.push(DU(typeof s=="object"?s:void 0)),i};function b2e(t){const n=y2e(),{reducer:r=void 0,middleware:s,devTools:i=!0,preloadedState:o=void 0,enhancers:l=void 0}=t||{};let c;if(typeof r=="function")c=r;else if(WE(r))c=jU(r);else throw new Error(Da(1));let d;typeof s=="function"?d=s(n):d=n();let u=ey;i&&(u=x2e({trace:!1,...typeof i=="object"&&i}));const h=r2e(...d),m=v2e(h);let g=typeof l=="function"?l(m):m();const y=u(...g);return NU(c,o,y)}function RU(t){const n={},r=[];let s;const i={addCase(o,l){const c=typeof o=="string"?o:o.type;if(!c)throw new Error(Da(28));if(c in n)throw new Error(Da(29));return n[c]=l,i},addAsyncThunk(o,l){return l.pending&&(n[o.pending.type]=l.pending),l.rejected&&(n[o.rejected.type]=l.rejected),l.fulfilled&&(n[o.fulfilled.type]=l.fulfilled),l.settled&&r.push({matcher:o.settled,reducer:l.settled}),i},addMatcher(o,l){return r.push({matcher:o,reducer:l}),i},addDefaultCase(o){return s=o,i}};return t(i),[n,r,s]}h2e(!1);function w2e(t){return typeof t=="function"}function N2e(t,n){let[r,s,i]=RU(n),o;if(w2e(t))o=()=>i4(t());else{const c=i4(t);o=()=>c}function l(c=o(),d){let u=[r[d.type],...s.filter(({matcher:h})=>h(d)).map(({reducer:h})=>h)];return u.filter(h=>!!h).length===0&&(u=[i]),u.reduce((h,m)=>{if(m)if(mu(h)){const y=m(h,d);return y===void 0?h:y}else{if(yl(h))return IU(h,g=>m(g,d));{const g=m(h,d);if(g===void 0){if(h===null)return h;throw Error("A case reducer on a non-draftable value must not return undefined")}return g}}return h},c)}return l.getInitialState=o,l}var j2e="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",S2e=(t=21)=>{let n="",r=t;for(;r--;)n+=j2e[Math.random()*64|0];return n},C2e=Symbol.for("rtk-slice-createasyncthunk");function _2e(t,n){return`${t}/${n}`}function A2e({creators:t}={}){var r;const n=(r=t==null?void 0:t.asyncThunk)==null?void 0:r[C2e];return function(i){const{name:o,reducerPath:l=o}=i;if(!o)throw new Error(Da(11));const c=(typeof i.reducers=="function"?i.reducers(k2e()):i.reducers)||{},d=Object.keys(c),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},h={addCase(T,P){const M=typeof T=="string"?T:T.type;if(!M)throw new Error(Da(12));if(M in u.sliceCaseReducersByType)throw new Error(Da(13));return u.sliceCaseReducersByType[M]=P,h},addMatcher(T,P){return u.sliceMatchers.push({matcher:T,reducer:P}),h},exposeAction(T,P){return u.actionCreators[T]=P,h},exposeCaseReducer(T,P){return u.sliceCaseReducersByName[T]=P,h}};d.forEach(T=>{const P=c[T],M={reducerName:T,type:_2e(o,T),createNotation:typeof i.reducers=="function"};I2e(P)?M2e(M,P,h,n):T2e(M,P,h)});function m(){const[T={},P=[],M=void 0]=typeof i.extraReducers=="function"?RU(i.extraReducers):[i.extraReducers],O={...T,...u.sliceCaseReducersByType};return N2e(i.initialState,D=>{for(let L in O)D.addCase(L,O[L]);for(let L of u.sliceMatchers)D.addMatcher(L.matcher,L.reducer);for(let L of P)D.addMatcher(L.matcher,L.reducer);M&&D.addDefaultCase(M)})}const g=T=>T,y=new Map,N=new WeakMap;let j;function S(T,P){return j||(j=m()),j(T,P)}function _(){return j||(j=m()),j.getInitialState()}function A(T,P=!1){function M(D){let L=D[T];return typeof L>"u"&&P&&(L=W0(N,M,_)),L}function O(D=g){const L=W0(y,P,()=>new WeakMap);return W0(L,D,()=>{const $={};for(const[V,F]of Object.entries(i.selectors??{}))$[V]=E2e(F,D,()=>W0(N,D,_),P);return $})}return{reducerPath:T,getSelectors:O,get selectors(){return O(M)},selectSlice:M}}const k={name:o,reducer:S,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:_,...A(l),injectInto(T,{reducerPath:P,...M}={}){const O=P??l;return T.inject({reducerPath:O,reducer:S},M),{...k,...A(O,!0)}}};return k}}function E2e(t,n,r,s){function i(o,...l){let c=n(o);return typeof c>"u"&&s&&(c=r()),t(c,...l)}return i.unwrapped=t,i}var ga=A2e();function k2e(){function t(n,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:n,...r}}return t.withTypes=()=>t,{reducer(n){return Object.assign({[n.name](...r){return n(...r)}}[n.name],{_reducerDefinitionType:"reducer"})},preparedReducer(n,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:n,reducer:r}},asyncThunk:t}}function T2e({type:t,reducerName:n,createNotation:r},s,i){let o,l;if("reducer"in s){if(r&&!P2e(s))throw new Error(Da(17));o=s.reducer,l=s.prepare}else o=s;i.addCase(t,o).exposeCaseReducer(n,o).exposeAction(n,l?pi(t,l):pi(t))}function I2e(t){return t._reducerDefinitionType==="asyncThunk"}function P2e(t){return t._reducerDefinitionType==="reducerWithPrepare"}function M2e({type:t,reducerName:n},r,s,i){if(!i)throw new Error(Da(18));const{payloadCreator:o,fulfilled:l,pending:c,rejected:d,settled:u,options:h}=r,m=i(t,o,h);s.exposeAction(n,m),l&&s.addCase(m.fulfilled,l),c&&s.addCase(m.pending,c),d&&s.addCase(m.rejected,d),u&&s.addMatcher(m.settled,u),s.exposeCaseReducer(n,{fulfilled:l||q0,pending:c||q0,rejected:d||q0,settled:u||q0})}function q0(){}var O2e="task",LU="listener",BU="completed",KE="cancelled",D2e=`task-${KE}`,R2e=`task-${BU}`,sC=`${LU}-${KE}`,L2e=`${LU}-${BU}`,ab=class{constructor(t){xw(this,"name","TaskAbortError");xw(this,"message");this.code=t,this.message=`${O2e} ${KE} (reason: ${t})`}},YE=(t,n)=>{if(typeof t!="function")throw new TypeError(Da(32))},sy=()=>{},FU=(t,n=sy)=>(t.catch(n),t),$U=(t,n)=>(t.addEventListener("abort",n,{once:!0}),()=>t.removeEventListener("abort",n)),Kd=(t,n)=>{const r=t.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:n,configurable:!0,writable:!0}),t.abort(n))},Yd=t=>{if(t.aborted){const{reason:n}=t;throw new ab(n)}};function zU(t,n){let r=sy;return new Promise((s,i)=>{const o=()=>i(new ab(t.reason));if(t.aborted){o();return}r=$U(t,o),n.finally(()=>r()).then(s,i)}).finally(()=>{r=sy})}var B2e=async(t,n)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(r){return{status:r instanceof ab?"cancelled":"rejected",error:r}}finally{n==null||n()}},ay=t=>n=>FU(zU(t,n).then(r=>(Yd(t),r))),UU=t=>{const n=ay(t);return r=>n(new Promise(s=>setTimeout(s,r)))},{assign:Mf}=Object,l4={},ib="listenerMiddleware",F2e=(t,n)=>{const r=s=>$U(t,()=>Kd(s,t.reason));return(s,i)=>{YE(s);const o=new AbortController;r(o);const l=B2e(async()=>{Yd(t),Yd(o.signal);const c=await s({pause:ay(o.signal),delay:UU(o.signal),signal:o.signal});return Yd(o.signal),c},()=>Kd(o,R2e));return i!=null&&i.autoJoin&&n.push(l.catch(sy)),{result:ay(t)(l),cancel(){Kd(o,D2e)}}}},$2e=(t,n)=>{const r=async(s,i)=>{Yd(n);let o=()=>{};const c=[new Promise((d,u)=>{let h=t({predicate:s,effect:(m,g)=>{g.unsubscribe(),d([m,g.getState(),g.getOriginalState()])}});o=()=>{h(),u()}})];i!=null&&c.push(new Promise(d=>setTimeout(d,i,null)));try{const d=await zU(n,Promise.race(c));return Yd(n),d}finally{o()}};return(s,i)=>FU(r(s,i))},VU=t=>{let{type:n,actionCreator:r,matcher:s,predicate:i,effect:o}=t;if(n)i=pi(n).match;else if(r)n=r.type,i=r.match;else if(s)i=s;else if(!i)throw new Error(Da(21));return YE(o),{predicate:i,type:n,effect:o}},HU=Mf(t=>{const{type:n,predicate:r,effect:s}=VU(t);return{id:S2e(),effect:s,type:n,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Da(22))}}},{withTypes:()=>HU}),c4=(t,n)=>{const{type:r,effect:s,predicate:i}=VU(n);return Array.from(t.values()).find(o=>(typeof r=="string"?o.type===r:o.predicate===i)&&o.effect===s)},aC=t=>{t.pending.forEach(n=>{Kd(n,sC)})},z2e=(t,n)=>()=>{for(const r of n.keys())aC(r);t.clear()},d4=(t,n,r)=>{try{t(n,r)}catch(s){setTimeout(()=>{throw s},0)}},WU=Mf(pi(`${ib}/add`),{withTypes:()=>WU}),U2e=pi(`${ib}/removeAll`),qU=Mf(pi(`${ib}/remove`),{withTypes:()=>qU}),V2e=(...t)=>{console.error(`${ib}/error`,...t)},Sx=(t={})=>{const n=new Map,r=new Map,s=y=>{const N=r.get(y)??0;r.set(y,N+1)},i=y=>{const N=r.get(y)??1;N===1?r.delete(y):r.set(y,N-1)},{extra:o,onError:l=V2e}=t;YE(l);const c=y=>(y.unsubscribe=()=>n.delete(y.id),n.set(y.id,y),N=>{y.unsubscribe(),N!=null&&N.cancelActive&&aC(y)}),d=y=>{const N=c4(n,y)??HU(y);return c(N)};Mf(d,{withTypes:()=>d});const u=y=>{const N=c4(n,y);return N&&(N.unsubscribe(),y.cancelActive&&aC(N)),!!N};Mf(u,{withTypes:()=>u});const h=async(y,N,j,S)=>{const _=new AbortController,A=$2e(d,_.signal),k=[];try{y.pending.add(_),s(y),await Promise.resolve(y.effect(N,Mf({},j,{getOriginalState:S,condition:(T,P)=>A(T,P).then(Boolean),take:A,delay:UU(_.signal),pause:ay(_.signal),extra:o,signal:_.signal,fork:F2e(_.signal,k),unsubscribe:y.unsubscribe,subscribe:()=>{n.set(y.id,y)},cancelActiveListeners:()=>{y.pending.forEach((T,P,M)=>{T!==_&&(Kd(T,sC),M.delete(T))})},cancel:()=>{Kd(_,sC),y.pending.delete(_)},throwIfCancelled:()=>{Yd(_.signal)}})))}catch(T){T instanceof ab||d4(l,T,{raisedBy:"effect"})}finally{await Promise.all(k),Kd(_,L2e),i(y),y.pending.delete(_)}},m=z2e(n,r);return{middleware:y=>N=>j=>{if(!SU(j))return N(j);if(WU.match(j))return d(j.payload);if(U2e.match(j)){m();return}if(qU.match(j))return u(j.payload);let S=y.getState();const _=()=>{if(S===l4)throw new Error(Da(23));return S};let A;try{if(A=N(j),n.size>0){const k=y.getState(),T=Array.from(n.values());for(const P of T){let M=!1;try{M=P.predicate(j,k,S)}catch(O){M=!1,d4(l,O,{raisedBy:"predicate"})}M&&h(P,j,y,_)}}}finally{S=l4}return A},startListening:d,stopListening:u,clearListeners:m}};function Da(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var H2e={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},GU=ga({name:"chartLayout",initialState:H2e,reducers:{setLayout(t,n){t.layoutType=n.payload},setChartSize(t,n){t.width=n.payload.width,t.height=n.payload.height},setMargin(t,n){var r,s,i,o;t.margin.top=(r=n.payload.top)!==null&&r!==void 0?r:0,t.margin.right=(s=n.payload.right)!==null&&s!==void 0?s:0,t.margin.bottom=(i=n.payload.bottom)!==null&&i!==void 0?i:0,t.margin.left=(o=n.payload.left)!==null&&o!==void 0?o:0},setScale(t,n){t.scale=n.payload}}}),{setMargin:W2e,setLayout:q2e,setChartSize:G2e,setScale:K2e}=GU.actions,Y2e=GU.reducer;function KU(t,n,r){return Array.isArray(t)&&t&&n+r!==0?t.slice(n,r+1):t}function u4(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function vf(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?u4(Object(r),!0).forEach(function(s){X2e(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u4(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function X2e(t,n,r){return(n=Q2e(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function Q2e(t){var n=Z2e(t,"string");return typeof n=="symbol"?n:n+""}function Z2e(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function Xn(t,n,r){return es(t)||es(n)?r:Mo(n)?hu(t,n,r):typeof n=="function"?n(t):r}var J2e=(t,n,r)=>{if(n&&r){var{width:s,height:i}=r,{align:o,verticalAlign:l,layout:c}=n;if((c==="vertical"||c==="horizontal"&&l==="middle")&&o!=="center"&&vt(t[o]))return vf(vf({},t),{},{[o]:t[o]+(s||0)});if((c==="horizontal"||c==="vertical"&&o==="center")&&l!=="middle"&&vt(t[l]))return vf(vf({},t),{},{[l]:t[l]+(i||0)})}return t},Tu=(t,n)=>t==="horizontal"&&n==="xAxis"||t==="vertical"&&n==="yAxis"||t==="centric"&&n==="angleAxis"||t==="radial"&&n==="radiusAxis",f4=1e-4,eje=t=>{var n=t.domain();if(!(!n||n.length<=2)){var r=n.length,s=t.range(),i=Math.min(s[0],s[1])-f4,o=Math.max(s[0],s[1])+f4,l=t(n[0]),c=t(n[r-1]);(l<i||l>o||c<i||c>o)&&t.domain([n[0],n[r-1]])}},tje=(t,n)=>{if(!n||n.length!==2||!vt(n[0])||!vt(n[1]))return t;var r=Math.min(n[0],n[1]),s=Math.max(n[0],n[1]),i=[t[0],t[1]];return(!vt(t[0])||t[0]<r)&&(i[0]=r),(!vt(t[1])||t[1]>s)&&(i[1]=s),i[0]>s&&(i[0]=s),i[1]<r&&(i[1]=r),i},nje=t=>{var n=t.length;if(!(n<=0))for(var r=0,s=t[0].length;r<s;++r)for(var i=0,o=0,l=0;l<n;++l){var c=Po(t[l][r][1])?t[l][r][0]:t[l][r][1];c>=0?(t[l][r][0]=i,t[l][r][1]=i+c,i=t[l][r][1]):(t[l][r][0]=o,t[l][r][1]=o+c,o=t[l][r][1])}},rje=t=>{var n=t.length;if(!(n<=0))for(var r=0,s=t[0].length;r<s;++r)for(var i=0,o=0;o<n;++o){var l=Po(t[o][r][1])?t[o][r][0]:t[o][r][1];l>=0?(t[o][r][0]=i,t[o][r][1]=i+l,i=t[o][r][1]):(t[o][r][0]=0,t[o][r][1]=0)}},sje={sign:nje,expand:fNe,none:nh,silhouette:hNe,wiggle:mNe,positive:rje},aje=(t,n,r)=>{var s=sje[r],i=uNe().keys(n).value((o,l)=>Number(Xn(o,l,0))).order(YS).offset(s);return i(t)};function ije(t){return t==null?void 0:String(t)}var h4=t=>{var{axis:n,ticks:r,offset:s,bandSize:i,entry:o,index:l}=t;if(n.type==="category")return r[l]?r[l].coordinate+s:null;var c=Xn(o,n.dataKey,n.scale.domain()[l]);return es(c)?null:n.scale(c)-i/2+s},oje=t=>{var{numericAxis:n}=t,r=n.scale.domain();if(n.type==="number"){var s=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]);return s<=0&&i>=0?0:i<0?i:s}return r[0]},lje=t=>{var n=t.flat(2).filter(vt);return[Math.min(...n),Math.max(...n)]},cje=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],dje=(t,n,r)=>{if(t!=null)return cje(Object.keys(t).reduce((s,i)=>{var o=t[i],{stackedData:l}=o,c=l.reduce((d,u)=>{var h=KU(u,n,r),m=lje(h);return[Math.min(d[0],m[0]),Math.max(d[1],m[1])]},[1/0,-1/0]);return[Math.min(c[0],s[0]),Math.max(c[1],s[1])]},[1/0,-1/0]))},m4=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,p4=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,iy=(t,n,r)=>{if(t&&t.scale&&t.scale.bandwidth){var s=t.scale.bandwidth();if(!r||s>0)return s}if(t&&n&&n.length>=2){for(var i=tb(n,h=>h.coordinate),o=1/0,l=1,c=i.length;l<c;l++){var d=i[l],u=i[l-1];o=Math.min((d.coordinate||0)-(u.coordinate||0),o)}return o===1/0?0:o}return r?void 0:0};function x4(t){var{tooltipEntrySettings:n,dataKey:r,payload:s,value:i,name:o}=t;return vf(vf({},n),{},{dataKey:r,payload:s,value:i,name:o})}function ob(t,n){if(t)return String(t);if(typeof n=="string")return n}var uje=(t,n)=>{if(n==="horizontal")return t.chartX;if(n==="vertical")return t.chartY},fje=(t,n)=>n==="centric"?t.angle:t.radius,kl=t=>t.layout.width,Tl=t=>t.layout.height,hje=t=>t.layout.scale,YU=t=>t.layout.margin,lb=je(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),cb=je(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),XU="data-recharts-item-index",QU="data-recharts-item-data-key",Cx=60;function g4(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function G0(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?g4(Object(r),!0).forEach(function(s){mje(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):g4(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function mje(t,n,r){return(n=pje(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function pje(t){var n=xje(t,"string");return typeof n=="symbol"?n:n+""}function xje(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var gje=t=>t.brush.height;function yje(t){var n=cb(t);return n.reduce((r,s)=>{if(s.orientation==="left"&&!s.mirror&&!s.hide){var i=typeof s.width=="number"?s.width:Cx;return r+i}return r},0)}function vje(t){var n=cb(t);return n.reduce((r,s)=>{if(s.orientation==="right"&&!s.mirror&&!s.hide){var i=typeof s.width=="number"?s.width:Cx;return r+i}return r},0)}function bje(t){var n=lb(t);return n.reduce((r,s)=>s.orientation==="top"&&!s.mirror&&!s.hide?r+s.height:r,0)}function wje(t){var n=lb(t);return n.reduce((r,s)=>s.orientation==="bottom"&&!s.mirror&&!s.hide?r+s.height:r,0)}var Vr=je([kl,Tl,YU,gje,yje,vje,bje,wje,wU,QNe],(t,n,r,s,i,o,l,c,d,u)=>{var h={left:(r.left||0)+i,right:(r.right||0)+o},m={top:(r.top||0)+l,bottom:(r.bottom||0)+c},g=G0(G0({},m),h),y=g.bottom;g.bottom+=s,g=J2e(g,d,u);var N=t-g.left-g.right,j=n-g.top-g.bottom;return G0(G0({brushBottom:y},g),{},{width:Math.max(N,0),height:Math.max(j,0)})}),Nje=je(Vr,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),XE=je(kl,Tl,(t,n)=>({x:0,y:0,width:t,height:n})),jje=b.createContext(null),Ua=()=>b.useContext(jje)!=null,db=t=>t.brush,ub=je([db,Vr,YU],(t,n,r)=>({height:t.height,x:vt(t.x)?t.x:n.left,y:vt(t.y)?t.y:n.top+n.height+n.brushBottom-((r==null?void 0:r.bottom)||0),width:vt(t.width)?t.width:n.width})),ZU={},JU={},eV={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(r,s,{signal:i,edges:o}={}){let l,c=null;const d=o!=null&&o.includes("leading"),u=o==null||o.includes("trailing"),h=()=>{c!==null&&(r.apply(l,c),l=void 0,c=null)},m=()=>{u&&h(),j()};let g=null;const y=()=>{g!=null&&clearTimeout(g),g=setTimeout(()=>{g=null,m()},s)},N=()=>{g!==null&&(clearTimeout(g),g=null)},j=()=>{N(),l=void 0,c=null},S=()=>{h()},_=function(...A){if(i!=null&&i.aborted)return;l=this,c=A;const k=g==null;y(),d&&k&&h()};return _.schedule=y,_.cancel=j,_.flush=S,i==null||i.addEventListener("abort",j,{once:!0}),_}t.debounce=n})(eV);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=eV;function r(s,i=0,o={}){typeof o!="object"&&(o={});const{leading:l=!1,trailing:c=!0,maxWait:d}=o,u=Array(2);l&&(u[0]="leading"),c&&(u[1]="trailing");let h,m=null;const g=n.debounce(function(...j){h=s.apply(this,j),m=null},i,{edges:u}),y=function(...j){return d!=null&&(m===null&&(m=Date.now()),Date.now()-m>=d)?(h=s.apply(this,j),m=Date.now(),g.cancel(),g.schedule(),h):(g.apply(this,j),h)},N=()=>(g.flush(),h);return y.cancel=g.cancel,y.flush=N,y}t.debounce=r})(JU);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=JU;function r(s,i=0,o={}){const{leading:l=!0,trailing:c=!0}=o;return n.debounce(s,i,{leading:l,maxWait:i,trailing:c})}t.throttle=r})(ZU);var Sje=ZU.throttle;const Cje=gi(Sje);var y4=function(n,r){for(var s=arguments.length,i=new Array(s>2?s-2:0),o=2;o<s;o++)i[o-2]=arguments[o]},tV=(t,n,r)=>{var{width:s="100%",height:i="100%",aspect:o,maxHeight:l}=r,c=gl(s)?t:Number(s),d=gl(i)?n:Number(i);return o&&o>0&&(c?d=c/o:d&&(c=d*o),l&&d!=null&&d>l&&(d=l)),{calculatedWidth:c,calculatedHeight:d}},_je={width:0,height:0,overflow:"visible"},Aje={width:0,overflowX:"visible"},Eje={height:0,overflowY:"visible"},kje={},Tje=t=>{var{width:n,height:r}=t,s=gl(n),i=gl(r);return s&&i?_je:s?Aje:i?Eje:kje};function Ije(t){var{width:n,height:r,aspect:s}=t,i=n,o=r;return i===void 0&&o===void 0?(i="100%",o="100%"):i===void 0?i=s&&s>0?void 0:"100%":o===void 0&&(o=s&&s>0?void 0:"100%"),{width:i,height:o}}function yr(t){return Number.isFinite(t)}function Lc(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function iC(){return iC=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},iC.apply(null,arguments)}function v4(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function b4(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?v4(Object(r),!0).forEach(function(s){Pje(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):v4(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Pje(t,n,r){return(n=Mje(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function Mje(t){var n=Oje(t,"string");return typeof n=="symbol"?n:n+""}function Oje(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var nV=b.createContext({width:-1,height:-1});function Dje(t){return Lc(t.width)&&Lc(t.height)}function rV(t){var{children:n,width:r,height:s}=t,i=b.useMemo(()=>({width:r,height:s}),[r,s]);return Dje(i)?b.createElement(nV.Provider,{value:i},n):null}var QE=()=>b.useContext(nV),Rje=b.forwardRef((t,n)=>{var{aspect:r,initialDimension:s={width:-1,height:-1},width:i,height:o,minWidth:l=0,minHeight:c,maxHeight:d,children:u,debounce:h=0,id:m,className:g,onResize:y,style:N={}}=t,j=b.useRef(null),S=b.useRef();S.current=y,b.useImperativeHandle(n,()=>j.current);var[_,A]=b.useState({containerWidth:s.width,containerHeight:s.height}),k=b.useCallback((D,L)=>{A($=>{var V=Math.round(D),F=Math.round(L);return $.containerWidth===V&&$.containerHeight===F?$:{containerWidth:V,containerHeight:F}})},[]);b.useEffect(()=>{if(j.current==null||typeof ResizeObserver>"u")return ku;var D=F=>{var Q,{width:U,height:z}=F[0].contentRect;k(U,z),(Q=S.current)===null||Q===void 0||Q.call(S,U,z)};h>0&&(D=Cje(D,h,{trailing:!0,leading:!1}));var L=new ResizeObserver(D),{width:$,height:V}=j.current.getBoundingClientRect();return k($,V),L.observe(j.current),()=>{L.disconnect()}},[k,h]);var{containerWidth:T,containerHeight:P}=_;y4(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:M,calculatedHeight:O}=tV(T,P,{width:i,height:o,aspect:r,maxHeight:d});return y4(M!=null&&M>0||O!=null&&O>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,M,O,i,o,l,c,r),b.createElement("div",{id:m?"".concat(m):void 0,className:cn("recharts-responsive-container",g),style:b4(b4({},N),{},{width:i,height:o,minWidth:l,minHeight:c,maxHeight:d}),ref:j},b.createElement("div",{style:Tje({width:i,height:o})},b.createElement(rV,{width:M,height:O},u)))}),Pd=b.forwardRef((t,n)=>{var r=QE();if(Lc(r.width)&&Lc(r.height))return t.children;var{width:s,height:i}=Ije({width:t.width,height:t.height,aspect:t.aspect}),{calculatedWidth:o,calculatedHeight:l}=tV(void 0,void 0,{width:s,height:i,aspect:t.aspect,maxHeight:t.maxHeight});return vt(o)&&vt(l)?b.createElement(rV,{width:o,height:l},t.children):b.createElement(Rje,iC({},t,{width:s,height:i,ref:n}))});function sV(t){if(t)return{x:t.x,y:t.y,upperWidth:"upperWidth"in t?t.upperWidth:t.width,lowerWidth:"lowerWidth"in t?t.lowerWidth:t.width,width:t.width,height:t.height}}var fb=()=>{var t,n=Ua(),r=mt(Nje),s=mt(ub),i=(t=mt(db))===null||t===void 0?void 0:t.padding;return!n||!s||!i?r:{width:s.width-i.left-i.right,height:s.height-i.top-i.bottom,x:i.left,y:i.top}},Lje={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},Bje=()=>{var t;return(t=mt(Vr))!==null&&t!==void 0?t:Lje},Fje=()=>mt(kl),$je=()=>mt(Tl),rn=t=>t.layout.layoutType,hb=()=>mt(rn),zje=()=>{var t=hb();return t!==void 0},mb=t=>{var n=Vn(),r=Ua(),{width:s,height:i}=t,o=QE(),l=s,c=i;return o&&(l=o.width>0?o.width:s,c=o.height>0?o.height:i),b.useEffect(()=>{!r&&Lc(l)&&Lc(c)&&n(G2e({width:l,height:c}))},[n,r,l,c]),null},Uje={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},aV=ga({name:"legend",initialState:Uje,reducers:{setLegendSize(t,n){t.size.width=n.payload.width,t.size.height=n.payload.height},setLegendSettings(t,n){t.settings.align=n.payload.align,t.settings.layout=n.payload.layout,t.settings.verticalAlign=n.payload.verticalAlign,t.settings.itemSorter=n.payload.itemSorter},addLegendPayload:{reducer(t,n){t.payload.push(n.payload)},prepare:Fr()},removeLegendPayload:{reducer(t,n){var r=il(t).payload.indexOf(n.payload);r>-1&&t.payload.splice(r,1)},prepare:Fr()}}}),{setLegendSize:W8e,setLegendSettings:q8e,addLegendPayload:iV,removeLegendPayload:oV}=aV.actions,Vje=aV.reducer;function oC(){return oC=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},oC.apply(null,arguments)}function w4(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function JN(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?w4(Object(r),!0).forEach(function(s){Hje(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):w4(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Hje(t,n,r){return(n=Wje(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function Wje(t){var n=qje(t,"string");return typeof n=="symbol"?n:n+""}function qje(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function Gje(t){return Array.isArray(t)&&Mo(t[0])&&Mo(t[1])?t.join(" ~ "):t}var Kje=t=>{var{separator:n=" : ",contentStyle:r={},itemStyle:s={},labelStyle:i={},payload:o,formatter:l,itemSorter:c,wrapperClassName:d,labelClassName:u,label:h,labelFormatter:m,accessibilityLayer:g=!1}=t,y=()=>{if(o&&o.length){var P={padding:0,margin:0},M=(c?tb(o,c):o).map((O,D)=>{if(O.type==="none")return null;var L=O.formatter||l||Gje,{value:$,name:V}=O,F=$,Q=V;if(L){var U=L($,V,O,D,o);if(Array.isArray(U))[F,Q]=U;else if(U!=null)F=U;else return null}var z=JN({display:"block",paddingTop:4,paddingBottom:4,color:O.color||"#000"},s);return b.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(D),style:z},Mo(Q)?b.createElement("span",{className:"recharts-tooltip-item-name"},Q):null,Mo(Q)?b.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,b.createElement("span",{className:"recharts-tooltip-item-value"},F),b.createElement("span",{className:"recharts-tooltip-item-unit"},O.unit||""))});return b.createElement("ul",{className:"recharts-tooltip-item-list",style:P},M)}return null},N=JN({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),j=JN({margin:0},i),S=!es(h),_=S?h:"",A=cn("recharts-default-tooltip",d),k=cn("recharts-tooltip-label",u);S&&m&&o!==void 0&&o!==null&&(_=m(h,o));var T=g?{role:"status","aria-live":"assertive"}:{};return b.createElement("div",oC({className:A,style:N},T),b.createElement("p",{className:k,style:j},b.isValidElement(_)?_:"".concat(_)),y())},dm="recharts-tooltip-wrapper",Yje={visibility:"hidden"};function Xje(t){var{coordinate:n,translateX:r,translateY:s}=t;return cn(dm,{["".concat(dm,"-right")]:vt(r)&&n&&vt(n.x)&&r>=n.x,["".concat(dm,"-left")]:vt(r)&&n&&vt(n.x)&&r<n.x,["".concat(dm,"-bottom")]:vt(s)&&n&&vt(n.y)&&s>=n.y,["".concat(dm,"-top")]:vt(s)&&n&&vt(n.y)&&s<n.y})}function N4(t){var{allowEscapeViewBox:n,coordinate:r,key:s,offsetTopLeft:i,position:o,reverseDirection:l,tooltipDimension:c,viewBox:d,viewBoxDimension:u}=t;if(o&&vt(o[s]))return o[s];var h=r[s]-c-(i>0?i:0),m=r[s]+i;if(n[s])return l[s]?h:m;var g=d[s];if(g==null)return 0;if(l[s]){var y=h,N=g;return y<N?Math.max(m,g):Math.max(h,g)}if(u==null)return 0;var j=m+c,S=g+u;return j>S?Math.max(h,g):Math.max(m,g)}function Qje(t){var{translateX:n,translateY:r,useTranslate3d:s}=t;return{transform:s?"translate3d(".concat(n,"px, ").concat(r,"px, 0)"):"translate(".concat(n,"px, ").concat(r,"px)")}}function Zje(t){var{allowEscapeViewBox:n,coordinate:r,offsetTopLeft:s,position:i,reverseDirection:o,tooltipBox:l,useTranslate3d:c,viewBox:d}=t,u,h,m;return l.height>0&&l.width>0&&r?(h=N4({allowEscapeViewBox:n,coordinate:r,key:"x",offsetTopLeft:s,position:i,reverseDirection:o,tooltipDimension:l.width,viewBox:d,viewBoxDimension:d.width}),m=N4({allowEscapeViewBox:n,coordinate:r,key:"y",offsetTopLeft:s,position:i,reverseDirection:o,tooltipDimension:l.height,viewBox:d,viewBoxDimension:d.height}),u=Qje({translateX:h,translateY:m,useTranslate3d:c})):u=Yje,{cssProperties:u,cssClasses:Xje({translateX:h,translateY:m,coordinate:r})}}function j4(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function K0(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?j4(Object(r),!0).forEach(function(s){lC(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):j4(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function lC(t,n,r){return(n=Jje(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function Jje(t){var n=eSe(t,"string");return typeof n=="symbol"?n:n+""}function eSe(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}class tSe extends b.PureComponent{constructor(){super(...arguments),lC(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),lC(this,"handleKeyDown",n=>{if(n.key==="Escape"){var r,s,i,o;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(s=this.props.coordinate)===null||s===void 0?void 0:s.x)!==null&&r!==void 0?r:0,y:(i=(o=this.props.coordinate)===null||o===void 0?void 0:o.y)!==null&&i!==void 0?i:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var n,r;this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:n,allowEscapeViewBox:r,animationDuration:s,animationEasing:i,children:o,coordinate:l,hasPayload:c,isAnimationActive:d,offset:u,position:h,reverseDirection:m,useTranslate3d:g,viewBox:y,wrapperStyle:N,lastBoundingBox:j,innerRef:S,hasPortalFromProps:_}=this.props,{cssClasses:A,cssProperties:k}=Zje({allowEscapeViewBox:r,coordinate:l,offsetTopLeft:u,position:h,reverseDirection:m,tooltipBox:{height:j.height,width:j.width},useTranslate3d:g,viewBox:y}),T=_?{}:K0(K0({transition:d&&n?"transform ".concat(s,"ms ").concat(i):void 0},k),{},{pointerEvents:"none",visibility:!this.state.dismissed&&n&&c?"visible":"hidden",position:"absolute",top:0,left:0}),P=K0(K0({},T),{},{visibility:!this.state.dismissed&&n&&c?"visible":"hidden"},N);return b.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:A,style:P,ref:S},o)}}var nSe=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Iu={devToolsEnabled:!1,isSsr:nSe()},lV=()=>{var t;return(t=mt(n=>n.rootProps.accessibilityLayer))!==null&&t!==void 0?t:!0};function cC(){return cC=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},cC.apply(null,arguments)}function S4(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function C4(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?S4(Object(r),!0).forEach(function(s){rSe(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):S4(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function rSe(t,n,r){return(n=sSe(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function sSe(t){var n=aSe(t,"string");return typeof n=="symbol"?n:n+""}function aSe(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var _4={curveBasisClosed:eNe,curveBasisOpen:tNe,curveBasis:Jwe,curveBumpX:Fwe,curveBumpY:$we,curveLinearClosed:nNe,curveLinear:Kv,curveMonotoneX:rNe,curveMonotoneY:sNe,curveNatural:aNe,curveStep:iNe,curveStepAfter:lNe,curveStepBefore:oNe},oy=t=>yr(t.x)&&yr(t.y),A4=t=>t.base!=null&&oy(t.base)&&oy(t),um=t=>t.x,fm=t=>t.y,iSe=(t,n)=>{if(typeof t=="function")return t;var r="curve".concat(Nx(t));return(r==="curveMonotone"||r==="curveBump")&&n?_4["".concat(r).concat(n==="vertical"?"Y":"X")]:_4[r]||Kv},oSe=t=>{var{type:n="linear",points:r=[],baseLine:s,layout:i,connectNulls:o=!1}=t,l=iSe(n,i),c=o?r.filter(oy):r,d;if(Array.isArray(s)){var u=r.map((y,N)=>C4(C4({},y),{},{base:s[N]}));i==="vertical"?d=z0().y(fm).x1(um).x0(y=>y.base.x):d=z0().x(um).y1(fm).y0(y=>y.base.y);var h=d.defined(A4).curve(l),m=o?u.filter(A4):u;return h(m)}i==="vertical"&&vt(s)?d=z0().y(fm).x1(um).x0(s):vt(s)?d=z0().x(um).y1(fm).y0(s):d=Dz().x(um).y(fm);var g=d.defined(oy).curve(l);return g(c)},ZE=t=>{var{className:n,points:r,path:s,pathRef:i}=t;if((!r||!r.length)&&!s)return null;var o=r&&r.length?oSe(t):s;return b.createElement("path",cC({},Io(t),kNe(t),{className:cn("recharts-curve",n),d:o===null?void 0:o,ref:i}))},lSe=["x","y","top","left","width","height","className"];function dC(){return dC=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},dC.apply(null,arguments)}function E4(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function cSe(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?E4(Object(r),!0).forEach(function(s){dSe(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):E4(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function dSe(t,n,r){return(n=uSe(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function uSe(t){var n=fSe(t,"string");return typeof n=="symbol"?n:n+""}function fSe(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function hSe(t,n){if(t==null)return{};var r,s,i=mSe(t,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],n.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function mSe(t,n){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(n.indexOf(s)!==-1)continue;r[s]=t[s]}return r}var pSe=(t,n,r,s,i,o)=>"M".concat(t,",").concat(i,"v").concat(s,"M").concat(o,",").concat(n,"h").concat(r),xSe=t=>{var{x:n=0,y:r=0,top:s=0,left:i=0,width:o=0,height:l=0,className:c}=t,d=hSe(t,lSe),u=cSe({x:n,y:r,top:s,left:i,width:o,height:l},d);return!vt(n)||!vt(r)||!vt(o)||!vt(l)||!vt(s)||!vt(i)?null:b.createElement("path",dC({},mi(u),{className:cn("recharts-cross",c),d:pSe(n,r,o,l,s,i)}))};function gSe(t,n,r,s){var i=s/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?n.x-i:r.left+.5,y:t==="horizontal"?r.top+.5:n.y-i,width:t==="horizontal"?s:r.width-1,height:t==="horizontal"?r.height-1:s}}function k4(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function T4(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?k4(Object(r),!0).forEach(function(s){ySe(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):k4(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function ySe(t,n,r){return(n=vSe(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function vSe(t){var n=bSe(t,"string");return typeof n=="symbol"?n:n+""}function bSe(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var wSe=t=>t.replace(/([A-Z])/g,n=>"-".concat(n.toLowerCase())),cV=(t,n,r)=>t.map(s=>"".concat(wSe(s)," ").concat(n,"ms ").concat(r)).join(","),NSe=(t,n)=>[Object.keys(t),Object.keys(n)].reduce((r,s)=>r.filter(i=>s.includes(i))),qp=(t,n)=>Object.keys(n).reduce((r,s)=>T4(T4({},r),{},{[s]:t(s,n[s])}),{});function I4(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function Lr(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?I4(Object(r),!0).forEach(function(s){jSe(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):I4(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function jSe(t,n,r){return(n=SSe(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function SSe(t){var n=CSe(t,"string");return typeof n=="symbol"?n:n+""}function CSe(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var ly=(t,n,r)=>t+(n-t)*r,uC=t=>{var{from:n,to:r}=t;return n!==r},dV=(t,n,r)=>{var s=qp((i,o)=>{if(uC(o)){var[l,c]=t(o.from,o.to,o.velocity);return Lr(Lr({},o),{},{from:l,velocity:c})}return o},n);return r<1?qp((i,o)=>uC(o)?Lr(Lr({},o),{},{velocity:ly(o.velocity,s[i].velocity,r),from:ly(o.from,s[i].from,r)}):o,n):dV(t,s,r-1)};function _Se(t,n,r,s,i,o){var l,c=s.reduce((g,y)=>Lr(Lr({},g),{},{[y]:{from:t[y],velocity:0,to:n[y]}}),{}),d=()=>qp((g,y)=>y.from,c),u=()=>!Object.values(c).filter(uC).length,h=null,m=g=>{l||(l=g);var y=g-l,N=y/r.dt;c=dV(r,c,N),i(Lr(Lr(Lr({},t),n),d())),l=g,u()||(h=o.setTimeout(m))};return()=>(h=o.setTimeout(m),()=>{var g;(g=h)===null||g===void 0||g()})}function ASe(t,n,r,s,i,o,l){var c=null,d=i.reduce((m,g)=>Lr(Lr({},m),{},{[g]:[t[g],n[g]]}),{}),u,h=m=>{u||(u=m);var g=(m-u)/s,y=qp((j,S)=>ly(...S,r(g)),d);if(o(Lr(Lr(Lr({},t),n),y)),g<1)c=l.setTimeout(h);else{var N=qp((j,S)=>ly(...S,r(1)),d);o(Lr(Lr(Lr({},t),n),N))}};return()=>(c=l.setTimeout(h),()=>{var m;(m=c)===null||m===void 0||m()})}const ESe=(t,n,r,s,i,o)=>{var l=NSe(t,n);return r==null?()=>(i(Lr(Lr({},t),n)),()=>{}):r.isStepper===!0?_Se(t,n,r,l,i,o):ASe(t,n,r,s,l,i,o)};var cy=1e-4,uV=(t,n)=>[0,3*t,3*n-6*t,3*t-3*n+1],fV=(t,n)=>t.map((r,s)=>r*n**s).reduce((r,s)=>r+s),P4=(t,n)=>r=>{var s=uV(t,n);return fV(s,r)},kSe=(t,n)=>r=>{var s=uV(t,n),i=[...s.map((o,l)=>o*l).slice(1),0];return fV(i,r)},TSe=function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var i,o=r[0].split("(");if(o[0]==="cubic-bezier"&&((i=o[1])===null||i===void 0?void 0:i.split(")")[0].split(",").length)===4){var l=o[1].split(")")[0].split(",").map(c=>parseFloat(c));return[l[0],l[1],l[2],l[3]]}}}return r.length===4?r:[0,0,1,1]},ISe=(t,n,r,s)=>{var i=P4(t,r),o=P4(n,s),l=kSe(t,r),c=u=>u>1?1:u<0?0:u,d=u=>{for(var h=u>1?1:u,m=h,g=0;g<8;++g){var y=i(m)-h,N=l(m);if(Math.abs(y-h)<cy||N<cy)return o(m);m=c(m-y/N)}return o(m)};return d.isStepper=!1,d},M4=function(){return ISe(...TSe(...arguments))},PSe=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:s=8,dt:i=17}=n,o=(l,c,d)=>{var u=-(l-c)*r,h=d*s,m=d+(u-h)*i/1e3,g=d*i/1e3+l;return Math.abs(g-c)<cy&&Math.abs(m)<cy?[c,0]:[g,m]};return o.isStepper=!0,o.dt=i,o},MSe=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return M4(t);case"spring":return PSe();default:if(t.split("(")[0]==="cubic-bezier")return M4(t)}return typeof t=="function"?t:null};function OSe(t){var n,r=()=>null,s=!1,i=null,o=l=>{if(!s){if(Array.isArray(l)){if(!l.length)return;var c=l,[d,...u]=c;if(typeof d=="number"){i=t.setTimeout(o.bind(null,u),d);return}o(d),i=t.setTimeout(o.bind(null,u));return}typeof l=="string"&&(n=l,r(n)),typeof l=="object"&&(n=l,r(n)),typeof l=="function"&&l()}};return{stop:()=>{s=!0},start:l=>{s=!1,i&&(i(),i=null),o(l)},subscribe:l=>(r=l,()=>{r=()=>null}),getTimeoutController:()=>t}}class DSe{setTimeout(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=performance.now(),i=null,o=l=>{l-s>=r?n(l):typeof requestAnimationFrame=="function"&&(i=requestAnimationFrame(o))};return i=requestAnimationFrame(o),()=>{i!=null&&cancelAnimationFrame(i)}}}function RSe(){return OSe(new DSe)}var LSe=b.createContext(RSe);function BSe(t,n){var r=b.useContext(LSe);return b.useMemo(()=>n??r(t),[t,n,r])}var FSe={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},O4={t:0},e2={t:1};function pb(t){var n=Xs(t,FSe),{isActive:r,canBegin:s,duration:i,easing:o,begin:l,onAnimationEnd:c,onAnimationStart:d,children:u}=n,h=BSe(n.animationId,n.animationManager),[m,g]=b.useState(r?O4:e2),y=b.useRef(null);return b.useEffect(()=>{r||g(e2)},[r]),b.useEffect(()=>{if(!r||!s)return ku;var N=ESe(O4,e2,MSe(o),i,g,h.getTimeoutController()),j=()=>{y.current=N()};return h.start([d,l,j,i,c]),()=>{h.stop(),y.current&&y.current(),c()}},[r,s,i,o,l,d,c,h]),u(m.t)}function xb(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=b.useRef(Up(n)),s=b.useRef(t);return s.current!==t&&(r.current=Up(n),s.current=t),r.current}var $Se=["radius"],zSe=["radius"];function D4(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function R4(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?D4(Object(r),!0).forEach(function(s){USe(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):D4(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function USe(t,n,r){return(n=VSe(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function VSe(t){var n=HSe(t,"string");return typeof n=="symbol"?n:n+""}function HSe(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function dy(){return dy=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},dy.apply(null,arguments)}function L4(t,n){if(t==null)return{};var r,s,i=WSe(t,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],n.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function WSe(t,n){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(n.indexOf(s)!==-1)continue;r[s]=t[s]}return r}var B4=(t,n,r,s,i)=>{var o=Math.min(Math.abs(r)/2,Math.abs(s)/2),l=s>=0?1:-1,c=r>=0?1:-1,d=s>=0&&r>=0||s<0&&r<0?1:0,u;if(o>0&&i instanceof Array){for(var h=[0,0,0,0],m=0,g=4;m<g;m++)h[m]=i[m]>o?o:i[m];u="M".concat(t,",").concat(n+l*h[0]),h[0]>0&&(u+="A ".concat(h[0],",").concat(h[0],",0,0,").concat(d,",").concat(t+c*h[0],",").concat(n)),u+="L ".concat(t+r-c*h[1],",").concat(n),h[1]>0&&(u+="A ".concat(h[1],",").concat(h[1],",0,0,").concat(d,`,
        `).concat(t+r,",").concat(n+l*h[1])),u+="L ".concat(t+r,",").concat(n+s-l*h[2]),h[2]>0&&(u+="A ".concat(h[2],",").concat(h[2],",0,0,").concat(d,`,
        `).concat(t+r-c*h[2],",").concat(n+s)),u+="L ".concat(t+c*h[3],",").concat(n+s),h[3]>0&&(u+="A ".concat(h[3],",").concat(h[3],",0,0,").concat(d,`,
        `).concat(t,",").concat(n+s-l*h[3])),u+="Z"}else if(o>0&&i===+i&&i>0){var y=Math.min(o,i);u="M ".concat(t,",").concat(n+l*y,`
            A `).concat(y,",").concat(y,",0,0,").concat(d,",").concat(t+c*y,",").concat(n,`
            L `).concat(t+r-c*y,",").concat(n,`
            A `).concat(y,",").concat(y,",0,0,").concat(d,",").concat(t+r,",").concat(n+l*y,`
            L `).concat(t+r,",").concat(n+s-l*y,`
            A `).concat(y,",").concat(y,",0,0,").concat(d,",").concat(t+r-c*y,",").concat(n+s,`
            L `).concat(t+c*y,",").concat(n+s,`
            A `).concat(y,",").concat(y,",0,0,").concat(d,",").concat(t,",").concat(n+s-l*y," Z")}else u="M ".concat(t,",").concat(n," h ").concat(r," v ").concat(s," h ").concat(-r," Z");return u},F4={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},hV=t=>{var n=Xs(t,F4),r=b.useRef(null),[s,i]=b.useState(-1);b.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var K=r.current.getTotalLength();K&&i(K)}catch{}},[]);var{x:o,y:l,width:c,height:d,radius:u,className:h}=n,{animationEasing:m,animationDuration:g,animationBegin:y,isAnimationActive:N,isUpdateAnimationActive:j}=n,S=b.useRef(c),_=b.useRef(d),A=b.useRef(o),k=b.useRef(l),T=b.useMemo(()=>({x:o,y:l,width:c,height:d,radius:u}),[o,l,c,d,u]),P=xb(T,"rectangle-");if(o!==+o||l!==+l||c!==+c||d!==+d||c===0||d===0)return null;var M=cn("recharts-rectangle",h);if(!j){var O=mi(n),{radius:D}=O,L=L4(O,$Se);return b.createElement("path",dy({},L,{radius:typeof u=="number"?u:void 0,className:M,d:B4(o,l,c,d,u)}))}var $=S.current,V=_.current,F=A.current,Q=k.current,U="0px ".concat(s===-1?1:s,"px"),z="".concat(s,"px 0px"),q=cV(["strokeDasharray"],g,typeof m=="string"?m:F4.animationEasing);return b.createElement(pb,{animationId:P,key:P,canBegin:s>0,duration:g,easing:m,isActive:j,begin:y},K=>{var X=Rr($,c,K),J=Rr(V,d,K),ne=Rr(F,o,K),Se=Rr(Q,l,K);r.current&&(S.current=X,_.current=J,A.current=ne,k.current=Se);var de;N?K>0?de={transition:q,strokeDasharray:z}:de={strokeDasharray:U}:de={strokeDasharray:z};var ye=mi(n),{radius:be}=ye,xe=L4(ye,zSe);return b.createElement("path",dy({},xe,{radius:typeof u=="number"?u:void 0,className:M,d:B4(ne,Se,X,J,u),ref:r,style:R4(R4({},de),n.style)}))})};function $4(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function z4(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?$4(Object(r),!0).forEach(function(s){qSe(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$4(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function qSe(t,n,r){return(n=GSe(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function GSe(t){var n=KSe(t,"string");return typeof n=="symbol"?n:n+""}function KSe(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var uy=Math.PI/180,YSe=t=>t*180/Math.PI,Sr=(t,n,r,s)=>({x:t+Math.cos(-uy*s)*r,y:n+Math.sin(-uy*s)*r}),mV=function(n,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(n-(s.left||0)-(s.right||0)),Math.abs(r-(s.top||0)-(s.bottom||0)))/2},XSe=(t,n)=>{var{x:r,y:s}=t,{x:i,y:o}=n;return Math.sqrt((r-i)**2+(s-o)**2)},QSe=(t,n)=>{var{x:r,y:s}=t,{cx:i,cy:o}=n,l=XSe({x:r,y:s},{x:i,y:o});if(l<=0)return{radius:l,angle:0};var c=(r-i)/l,d=Math.acos(c);return s>o&&(d=2*Math.PI-d),{radius:l,angle:YSe(d),angleInRadian:d}},ZSe=t=>{var{startAngle:n,endAngle:r}=t,s=Math.floor(n/360),i=Math.floor(r/360),o=Math.min(s,i);return{startAngle:n-o*360,endAngle:r-o*360}},JSe=(t,n)=>{var{startAngle:r,endAngle:s}=n,i=Math.floor(r/360),o=Math.floor(s/360),l=Math.min(i,o);return t+l*360},eCe=(t,n)=>{var{chartX:r,chartY:s}=t,{radius:i,angle:o}=QSe({x:r,y:s},n),{innerRadius:l,outerRadius:c}=n;if(i<l||i>c||i===0)return null;var{startAngle:d,endAngle:u}=ZSe(n),h=o,m;if(d<=u){for(;h>u;)h-=360;for(;h<d;)h+=360;m=h>=d&&h<=u}else{for(;h>d;)h-=360;for(;h<u;)h+=360;m=h>=u&&h<=d}return m?z4(z4({},n),{},{radius:i,angle:JSe(h,n)}):null};function pV(t){var{cx:n,cy:r,radius:s,startAngle:i,endAngle:o}=t,l=Sr(n,r,s,i),c=Sr(n,r,s,o);return{points:[l,c],cx:n,cy:r,radius:s,startAngle:i,endAngle:o}}function fC(){return fC=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},fC.apply(null,arguments)}var tCe=(t,n)=>{var r=ps(n-t),s=Math.min(Math.abs(n-t),359.999);return r*s},Y0=t=>{var{cx:n,cy:r,radius:s,angle:i,sign:o,isExternal:l,cornerRadius:c,cornerIsExternal:d}=t,u=c*(l?1:-1)+s,h=Math.asin(c/u)/uy,m=d?i:i+o*h,g=Sr(n,r,u,m),y=Sr(n,r,s,m),N=d?i-o*h:i,j=Sr(n,r,u*Math.cos(h*uy),N);return{center:g,circleTangency:y,lineTangency:j,theta:h}},xV=t=>{var{cx:n,cy:r,innerRadius:s,outerRadius:i,startAngle:o,endAngle:l}=t,c=tCe(o,l),d=o+c,u=Sr(n,r,i,o),h=Sr(n,r,i,d),m="M ".concat(u.x,",").concat(u.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(o>d),`,
    `).concat(h.x,",").concat(h.y,`
  `);if(s>0){var g=Sr(n,r,s,o),y=Sr(n,r,s,d);m+="L ".concat(y.x,",").concat(y.y,`
            A `).concat(s,",").concat(s,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(o<=d),`,
            `).concat(g.x,",").concat(g.y," Z")}else m+="L ".concat(n,",").concat(r," Z");return m},nCe=t=>{var{cx:n,cy:r,innerRadius:s,outerRadius:i,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:u}=t,h=ps(u-d),{circleTangency:m,lineTangency:g,theta:y}=Y0({cx:n,cy:r,radius:i,angle:d,sign:h,cornerRadius:o,cornerIsExternal:c}),{circleTangency:N,lineTangency:j,theta:S}=Y0({cx:n,cy:r,radius:i,angle:u,sign:-h,cornerRadius:o,cornerIsExternal:c}),_=c?Math.abs(d-u):Math.abs(d-u)-y-S;if(_<0)return l?"M ".concat(g.x,",").concat(g.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):xV({cx:n,cy:r,innerRadius:s,outerRadius:i,startAngle:d,endAngle:u});var A="M ".concat(g.x,",").concat(g.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(_>180),",").concat(+(h<0),",").concat(N.x,",").concat(N.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(j.x,",").concat(j.y,`
  `);if(s>0){var{circleTangency:k,lineTangency:T,theta:P}=Y0({cx:n,cy:r,radius:s,angle:d,sign:h,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),{circleTangency:M,lineTangency:O,theta:D}=Y0({cx:n,cy:r,radius:s,angle:u,sign:-h,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),L=c?Math.abs(d-u):Math.abs(d-u)-P-D;if(L<0&&o===0)return"".concat(A,"L").concat(n,",").concat(r,"Z");A+="L".concat(O.x,",").concat(O.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(M.x,",").concat(M.y,`
      A`).concat(s,",").concat(s,",0,").concat(+(L>180),",").concat(+(h>0),",").concat(k.x,",").concat(k.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(T.x,",").concat(T.y,"Z")}else A+="L".concat(n,",").concat(r,"Z");return A},rCe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},gV=t=>{var n=Xs(t,rCe),{cx:r,cy:s,innerRadius:i,outerRadius:o,cornerRadius:l,forceCornerRadius:c,cornerIsExternal:d,startAngle:u,endAngle:h,className:m}=n;if(o<i||u===h)return null;var g=cn("recharts-sector",m),y=o-i,N=Ms(l,y,0,!0),j;return N>0&&Math.abs(u-h)<360?j=nCe({cx:r,cy:s,innerRadius:i,outerRadius:o,cornerRadius:Math.min(N,y/2),forceCornerRadius:c,cornerIsExternal:d,startAngle:u,endAngle:h}):j=xV({cx:r,cy:s,innerRadius:i,outerRadius:o,startAngle:u,endAngle:h}),b.createElement("path",fC({},mi(n),{className:g,d:j}))};function sCe(t,n,r){if(t==="horizontal")return[{x:n.x,y:r.top},{x:n.x,y:r.top+r.height}];if(t==="vertical")return[{x:r.left,y:n.y},{x:r.left+r.width,y:n.y}];if(Qz(n)){if(t==="centric"){var{cx:s,cy:i,innerRadius:o,outerRadius:l,angle:c}=n,d=Sr(s,i,o,c),u=Sr(s,i,l,c);return[{x:d.x,y:d.y},{x:u.x,y:u.y}]}return pV(n)}}var yV={},vV={},bV={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=VE;function r(s){return n.isSymbol(s)?NaN:Number(s)}t.toNumber=r})(bV);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=bV;function r(s){return s?(s=n.toNumber(s),s===1/0||s===-1/0?(s<0?-1:1)*Number.MAX_VALUE:s===s?s:0):s===0?s:0}t.toFinite=r})(vV);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=HE,r=vV;function s(i,o,l){l&&typeof l!="number"&&n.isIterateeCall(i,o,l)&&(o=l=void 0),i=r.toFinite(i),o===void 0?(o=i,i=0):o=r.toFinite(o),l=l===void 0?i<o?1:-1:r.toFinite(l);const c=Math.max(Math.ceil((o-i)/(l||1)),0),d=new Array(c);for(let u=0;u<c;u++)d[u]=i,i+=l;return d}t.range=s})(yV);var aCe=yV.range;const wV=gi(aCe);function Cc(t,n){return t==null||n==null?NaN:t<n?-1:t>n?1:t>=n?0:NaN}function iCe(t,n){return t==null||n==null?NaN:n<t?-1:n>t?1:n>=t?0:NaN}function JE(t){let n,r,s;t.length!==2?(n=Cc,r=(c,d)=>Cc(t(c),d),s=(c,d)=>t(c)-d):(n=t===Cc||t===iCe?t:oCe,r=t,s=t);function i(c,d,u=0,h=c.length){if(u<h){if(n(d,d)!==0)return h;do{const m=u+h>>>1;r(c[m],d)<0?u=m+1:h=m}while(u<h)}return u}function o(c,d,u=0,h=c.length){if(u<h){if(n(d,d)!==0)return h;do{const m=u+h>>>1;r(c[m],d)<=0?u=m+1:h=m}while(u<h)}return u}function l(c,d,u=0,h=c.length){const m=i(c,d,u,h-1);return m>u&&s(c[m-1],d)>-s(c[m],d)?m-1:m}return{left:i,center:l,right:o}}function oCe(){return 0}function NV(t){return t===null?NaN:+t}function*lCe(t,n){for(let r of t)r!=null&&(r=+r)>=r&&(yield r)}const cCe=JE(Cc),_x=cCe.right;JE(NV).center;class U4 extends Map{constructor(n,r=fCe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),n!=null)for(const[s,i]of n)this.set(s,i)}get(n){return super.get(V4(this,n))}has(n){return super.has(V4(this,n))}set(n,r){return super.set(dCe(this,n),r)}delete(n){return super.delete(uCe(this,n))}}function V4({_intern:t,_key:n},r){const s=n(r);return t.has(s)?t.get(s):r}function dCe({_intern:t,_key:n},r){const s=n(r);return t.has(s)?t.get(s):(t.set(s,r),r)}function uCe({_intern:t,_key:n},r){const s=n(r);return t.has(s)&&(r=t.get(s),t.delete(s)),r}function fCe(t){return t!==null&&typeof t=="object"?t.valueOf():t}function hCe(t=Cc){if(t===Cc)return jV;if(typeof t!="function")throw new TypeError("compare is not a function");return(n,r)=>{const s=t(n,r);return s||s===0?s:(t(r,r)===0)-(t(n,n)===0)}}function jV(t,n){return(t==null||!(t>=t))-(n==null||!(n>=n))||(t<n?-1:t>n?1:0)}const mCe=Math.sqrt(50),pCe=Math.sqrt(10),xCe=Math.sqrt(2);function fy(t,n,r){const s=(n-t)/Math.max(0,r),i=Math.floor(Math.log10(s)),o=s/Math.pow(10,i),l=o>=mCe?10:o>=pCe?5:o>=xCe?2:1;let c,d,u;return i<0?(u=Math.pow(10,-i)/l,c=Math.round(t*u),d=Math.round(n*u),c/u<t&&++c,d/u>n&&--d,u=-u):(u=Math.pow(10,i)*l,c=Math.round(t/u),d=Math.round(n/u),c*u<t&&++c,d*u>n&&--d),d<c&&.5<=r&&r<2?fy(t,n,r*2):[c,d,u]}function hC(t,n,r){if(n=+n,t=+t,r=+r,!(r>0))return[];if(t===n)return[t];const s=n<t,[i,o,l]=s?fy(n,t,r):fy(t,n,r);if(!(o>=i))return[];const c=o-i+1,d=new Array(c);if(s)if(l<0)for(let u=0;u<c;++u)d[u]=(o-u)/-l;else for(let u=0;u<c;++u)d[u]=(o-u)*l;else if(l<0)for(let u=0;u<c;++u)d[u]=(i+u)/-l;else for(let u=0;u<c;++u)d[u]=(i+u)*l;return d}function mC(t,n,r){return n=+n,t=+t,r=+r,fy(t,n,r)[2]}function pC(t,n,r){n=+n,t=+t,r=+r;const s=n<t,i=s?mC(n,t,r):mC(t,n,r);return(s?-1:1)*(i<0?1/-i:i)}function H4(t,n){let r;for(const s of t)s!=null&&(r<s||r===void 0&&s>=s)&&(r=s);return r}function W4(t,n){let r;for(const s of t)s!=null&&(r>s||r===void 0&&s>=s)&&(r=s);return r}function SV(t,n,r=0,s=1/0,i){if(n=Math.floor(n),r=Math.floor(Math.max(0,r)),s=Math.floor(Math.min(t.length-1,s)),!(r<=n&&n<=s))return t;for(i=i===void 0?jV:hCe(i);s>r;){if(s-r>600){const d=s-r+1,u=n-r+1,h=Math.log(d),m=.5*Math.exp(2*h/3),g=.5*Math.sqrt(h*m*(d-m)/d)*(u-d/2<0?-1:1),y=Math.max(r,Math.floor(n-u*m/d+g)),N=Math.min(s,Math.floor(n+(d-u)*m/d+g));SV(t,n,y,N,i)}const o=t[n];let l=r,c=s;for(hm(t,r,n),i(t[s],o)>0&&hm(t,r,s);l<c;){for(hm(t,l,c),++l,--c;i(t[l],o)<0;)++l;for(;i(t[c],o)>0;)--c}i(t[r],o)===0?hm(t,r,c):(++c,hm(t,c,s)),c<=n&&(r=c+1),n<=c&&(s=c-1)}return t}function hm(t,n,r){const s=t[n];t[n]=t[r],t[r]=s}function gCe(t,n,r){if(t=Float64Array.from(lCe(t)),!(!(s=t.length)||isNaN(n=+n))){if(n<=0||s<2)return W4(t);if(n>=1)return H4(t);var s,i=(s-1)*n,o=Math.floor(i),l=H4(SV(t,o).subarray(0,o+1)),c=W4(t.subarray(o+1));return l+(c-l)*(i-o)}}function yCe(t,n,r=NV){if(!(!(s=t.length)||isNaN(n=+n))){if(n<=0||s<2)return+r(t[0],0,t);if(n>=1)return+r(t[s-1],s-1,t);var s,i=(s-1)*n,o=Math.floor(i),l=+r(t[o],o,t),c=+r(t[o+1],o+1,t);return l+(c-l)*(i-o)}}function vCe(t,n,r){t=+t,n=+n,r=(i=arguments.length)<2?(n=t,t=0,1):i<3?1:+r;for(var s=-1,i=Math.max(0,Math.ceil((n-t)/r))|0,o=new Array(i);++s<i;)o[s]=t+s*r;return o}function vi(t,n){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(n).domain(t);break}return this}function Il(t,n){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof n=="function"?this.interpolator(n):this.range(n);break}}return this}const xC=Symbol("implicit");function e3(){var t=new U4,n=[],r=[],s=xC;function i(o){let l=t.get(o);if(l===void 0){if(s!==xC)return s;t.set(o,l=n.push(o)-1)}return r[l%r.length]}return i.domain=function(o){if(!arguments.length)return n.slice();n=[],t=new U4;for(const l of o)t.has(l)||t.set(l,n.push(l)-1);return i},i.range=function(o){return arguments.length?(r=Array.from(o),i):r.slice()},i.unknown=function(o){return arguments.length?(s=o,i):s},i.copy=function(){return e3(n,r).unknown(s)},vi.apply(i,arguments),i}function t3(){var t=e3().unknown(void 0),n=t.domain,r=t.range,s=0,i=1,o,l,c=!1,d=0,u=0,h=.5;delete t.unknown;function m(){var g=n().length,y=i<s,N=y?i:s,j=y?s:i;o=(j-N)/Math.max(1,g-d+u*2),c&&(o=Math.floor(o)),N+=(j-N-o*(g-d))*h,l=o*(1-d),c&&(N=Math.round(N),l=Math.round(l));var S=vCe(g).map(function(_){return N+o*_});return r(y?S.reverse():S)}return t.domain=function(g){return arguments.length?(n(g),m()):n()},t.range=function(g){return arguments.length?([s,i]=g,s=+s,i=+i,m()):[s,i]},t.rangeRound=function(g){return[s,i]=g,s=+s,i=+i,c=!0,m()},t.bandwidth=function(){return l},t.step=function(){return o},t.round=function(g){return arguments.length?(c=!!g,m()):c},t.padding=function(g){return arguments.length?(d=Math.min(1,u=+g),m()):d},t.paddingInner=function(g){return arguments.length?(d=Math.min(1,g),m()):d},t.paddingOuter=function(g){return arguments.length?(u=+g,m()):u},t.align=function(g){return arguments.length?(h=Math.max(0,Math.min(1,g)),m()):h},t.copy=function(){return t3(n(),[s,i]).round(c).paddingInner(d).paddingOuter(u).align(h)},vi.apply(m(),arguments)}function CV(t){var n=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return CV(n())},t}function bCe(){return CV(t3.apply(null,arguments).paddingInner(1))}function n3(t,n,r){t.prototype=n.prototype=r,r.constructor=t}function _V(t,n){var r=Object.create(t.prototype);for(var s in n)r[s]=n[s];return r}function Ax(){}var Gp=.7,hy=1/Gp,Of="\\s*([+-]?\\d+)\\s*",Kp="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",jo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",wCe=/^#([0-9a-f]{3,8})$/,NCe=new RegExp(`^rgb\\(${Of},${Of},${Of}\\)$`),jCe=new RegExp(`^rgb\\(${jo},${jo},${jo}\\)$`),SCe=new RegExp(`^rgba\\(${Of},${Of},${Of},${Kp}\\)$`),CCe=new RegExp(`^rgba\\(${jo},${jo},${jo},${Kp}\\)$`),_Ce=new RegExp(`^hsl\\(${Kp},${jo},${jo}\\)$`),ACe=new RegExp(`^hsla\\(${Kp},${jo},${jo},${Kp}\\)$`),q4={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};n3(Ax,Yp,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:G4,formatHex:G4,formatHex8:ECe,formatHsl:kCe,formatRgb:K4,toString:K4});function G4(){return this.rgb().formatHex()}function ECe(){return this.rgb().formatHex8()}function kCe(){return AV(this).formatHsl()}function K4(){return this.rgb().formatRgb()}function Yp(t){var n,r;return t=(t+"").trim().toLowerCase(),(n=wCe.exec(t))?(r=n[1].length,n=parseInt(n[1],16),r===6?Y4(n):r===3?new oa(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):r===8?X0(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):r===4?X0(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=NCe.exec(t))?new oa(n[1],n[2],n[3],1):(n=jCe.exec(t))?new oa(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=SCe.exec(t))?X0(n[1],n[2],n[3],n[4]):(n=CCe.exec(t))?X0(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=_Ce.exec(t))?Z4(n[1],n[2]/100,n[3]/100,1):(n=ACe.exec(t))?Z4(n[1],n[2]/100,n[3]/100,n[4]):q4.hasOwnProperty(t)?Y4(q4[t]):t==="transparent"?new oa(NaN,NaN,NaN,0):null}function Y4(t){return new oa(t>>16&255,t>>8&255,t&255,1)}function X0(t,n,r,s){return s<=0&&(t=n=r=NaN),new oa(t,n,r,s)}function TCe(t){return t instanceof Ax||(t=Yp(t)),t?(t=t.rgb(),new oa(t.r,t.g,t.b,t.opacity)):new oa}function gC(t,n,r,s){return arguments.length===1?TCe(t):new oa(t,n,r,s??1)}function oa(t,n,r,s){this.r=+t,this.g=+n,this.b=+r,this.opacity=+s}n3(oa,gC,_V(Ax,{brighter(t){return t=t==null?hy:Math.pow(hy,t),new oa(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Gp:Math.pow(Gp,t),new oa(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new oa(Xd(this.r),Xd(this.g),Xd(this.b),my(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:X4,formatHex:X4,formatHex8:ICe,formatRgb:Q4,toString:Q4}));function X4(){return`#${Md(this.r)}${Md(this.g)}${Md(this.b)}`}function ICe(){return`#${Md(this.r)}${Md(this.g)}${Md(this.b)}${Md((isNaN(this.opacity)?1:this.opacity)*255)}`}function Q4(){const t=my(this.opacity);return`${t===1?"rgb(":"rgba("}${Xd(this.r)}, ${Xd(this.g)}, ${Xd(this.b)}${t===1?")":`, ${t})`}`}function my(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Xd(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Md(t){return t=Xd(t),(t<16?"0":"")+t.toString(16)}function Z4(t,n,r,s){return s<=0?t=n=r=NaN:r<=0||r>=1?t=n=NaN:n<=0&&(t=NaN),new Oi(t,n,r,s)}function AV(t){if(t instanceof Oi)return new Oi(t.h,t.s,t.l,t.opacity);if(t instanceof Ax||(t=Yp(t)),!t)return new Oi;if(t instanceof Oi)return t;t=t.rgb();var n=t.r/255,r=t.g/255,s=t.b/255,i=Math.min(n,r,s),o=Math.max(n,r,s),l=NaN,c=o-i,d=(o+i)/2;return c?(n===o?l=(r-s)/c+(r<s)*6:r===o?l=(s-n)/c+2:l=(n-r)/c+4,c/=d<.5?o+i:2-o-i,l*=60):c=d>0&&d<1?0:l,new Oi(l,c,d,t.opacity)}function PCe(t,n,r,s){return arguments.length===1?AV(t):new Oi(t,n,r,s??1)}function Oi(t,n,r,s){this.h=+t,this.s=+n,this.l=+r,this.opacity=+s}n3(Oi,PCe,_V(Ax,{brighter(t){return t=t==null?hy:Math.pow(hy,t),new Oi(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Gp:Math.pow(Gp,t),new Oi(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,n=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,s=r+(r<.5?r:1-r)*n,i=2*r-s;return new oa(t2(t>=240?t-240:t+120,i,s),t2(t,i,s),t2(t<120?t+240:t-120,i,s),this.opacity)},clamp(){return new Oi(J4(this.h),Q0(this.s),Q0(this.l),my(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=my(this.opacity);return`${t===1?"hsl(":"hsla("}${J4(this.h)}, ${Q0(this.s)*100}%, ${Q0(this.l)*100}%${t===1?")":`, ${t})`}`}}));function J4(t){return t=(t||0)%360,t<0?t+360:t}function Q0(t){return Math.max(0,Math.min(1,t||0))}function t2(t,n,r){return(t<60?n+(r-n)*t/60:t<180?r:t<240?n+(r-n)*(240-t)/60:n)*255}const r3=t=>()=>t;function MCe(t,n){return function(r){return t+r*n}}function OCe(t,n,r){return t=Math.pow(t,r),n=Math.pow(n,r)-t,r=1/r,function(s){return Math.pow(t+s*n,r)}}function DCe(t){return(t=+t)==1?EV:function(n,r){return r-n?OCe(n,r,t):r3(isNaN(n)?r:n)}}function EV(t,n){var r=n-t;return r?MCe(t,r):r3(isNaN(t)?n:t)}const eO=function t(n){var r=DCe(n);function s(i,o){var l=r((i=gC(i)).r,(o=gC(o)).r),c=r(i.g,o.g),d=r(i.b,o.b),u=EV(i.opacity,o.opacity);return function(h){return i.r=l(h),i.g=c(h),i.b=d(h),i.opacity=u(h),i+""}}return s.gamma=t,s}(1);function RCe(t,n){n||(n=[]);var r=t?Math.min(n.length,t.length):0,s=n.slice(),i;return function(o){for(i=0;i<r;++i)s[i]=t[i]*(1-o)+n[i]*o;return s}}function LCe(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function BCe(t,n){var r=n?n.length:0,s=t?Math.min(r,t.length):0,i=new Array(s),o=new Array(r),l;for(l=0;l<s;++l)i[l]=Eh(t[l],n[l]);for(;l<r;++l)o[l]=n[l];return function(c){for(l=0;l<s;++l)o[l]=i[l](c);return o}}function FCe(t,n){var r=new Date;return t=+t,n=+n,function(s){return r.setTime(t*(1-s)+n*s),r}}function py(t,n){return t=+t,n=+n,function(r){return t*(1-r)+n*r}}function $Ce(t,n){var r={},s={},i;(t===null||typeof t!="object")&&(t={}),(n===null||typeof n!="object")&&(n={});for(i in n)i in t?r[i]=Eh(t[i],n[i]):s[i]=n[i];return function(o){for(i in r)s[i]=r[i](o);return s}}var yC=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,n2=new RegExp(yC.source,"g");function zCe(t){return function(){return t}}function UCe(t){return function(n){return t(n)+""}}function VCe(t,n){var r=yC.lastIndex=n2.lastIndex=0,s,i,o,l=-1,c=[],d=[];for(t=t+"",n=n+"";(s=yC.exec(t))&&(i=n2.exec(n));)(o=i.index)>r&&(o=n.slice(r,o),c[l]?c[l]+=o:c[++l]=o),(s=s[0])===(i=i[0])?c[l]?c[l]+=i:c[++l]=i:(c[++l]=null,d.push({i:l,x:py(s,i)})),r=n2.lastIndex;return r<n.length&&(o=n.slice(r),c[l]?c[l]+=o:c[++l]=o),c.length<2?d[0]?UCe(d[0].x):zCe(n):(n=d.length,function(u){for(var h=0,m;h<n;++h)c[(m=d[h]).i]=m.x(u);return c.join("")})}function Eh(t,n){var r=typeof n,s;return n==null||r==="boolean"?r3(n):(r==="number"?py:r==="string"?(s=Yp(n))?(n=s,eO):VCe:n instanceof Yp?eO:n instanceof Date?FCe:LCe(n)?RCe:Array.isArray(n)?BCe:typeof n.valueOf!="function"&&typeof n.toString!="function"||isNaN(n)?$Ce:py)(t,n)}function s3(t,n){return t=+t,n=+n,function(r){return Math.round(t*(1-r)+n*r)}}function HCe(t,n){n===void 0&&(n=t,t=Eh);for(var r=0,s=n.length-1,i=n[0],o=new Array(s<0?0:s);r<s;)o[r]=t(i,i=n[++r]);return function(l){var c=Math.max(0,Math.min(s-1,Math.floor(l*=s)));return o[c](l-c)}}function WCe(t){return function(){return t}}function xy(t){return+t}var tO=[0,1];function Hs(t){return t}function vC(t,n){return(n-=t=+t)?function(r){return(r-t)/n}:WCe(isNaN(n)?NaN:.5)}function qCe(t,n){var r;return t>n&&(r=t,t=n,n=r),function(s){return Math.max(t,Math.min(n,s))}}function GCe(t,n,r){var s=t[0],i=t[1],o=n[0],l=n[1];return i<s?(s=vC(i,s),o=r(l,o)):(s=vC(s,i),o=r(o,l)),function(c){return o(s(c))}}function KCe(t,n,r){var s=Math.min(t.length,n.length)-1,i=new Array(s),o=new Array(s),l=-1;for(t[s]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++l<s;)i[l]=vC(t[l],t[l+1]),o[l]=r(n[l],n[l+1]);return function(c){var d=_x(t,c,1,s)-1;return o[d](i[d](c))}}function Ex(t,n){return n.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function gb(){var t=tO,n=tO,r=Eh,s,i,o,l=Hs,c,d,u;function h(){var g=Math.min(t.length,n.length);return l!==Hs&&(l=qCe(t[0],t[g-1])),c=g>2?KCe:GCe,d=u=null,m}function m(g){return g==null||isNaN(g=+g)?o:(d||(d=c(t.map(s),n,r)))(s(l(g)))}return m.invert=function(g){return l(i((u||(u=c(n,t.map(s),py)))(g)))},m.domain=function(g){return arguments.length?(t=Array.from(g,xy),h()):t.slice()},m.range=function(g){return arguments.length?(n=Array.from(g),h()):n.slice()},m.rangeRound=function(g){return n=Array.from(g),r=s3,h()},m.clamp=function(g){return arguments.length?(l=g?!0:Hs,h()):l!==Hs},m.interpolate=function(g){return arguments.length?(r=g,h()):r},m.unknown=function(g){return arguments.length?(o=g,m):o},function(g,y){return s=g,i=y,h()}}function a3(){return gb()(Hs,Hs)}function YCe(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function gy(t,n){if((r=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"))<0)return null;var r,s=t.slice(0,r);return[s.length>1?s[0]+s.slice(2):s,+t.slice(r+1)]}function rh(t){return t=gy(Math.abs(t)),t?t[1]:NaN}function XCe(t,n){return function(r,s){for(var i=r.length,o=[],l=0,c=t[0],d=0;i>0&&c>0&&(d+c+1>s&&(c=Math.max(1,s-d)),o.push(r.substring(i-=c,i+c)),!((d+=c+1)>s));)c=t[l=(l+1)%t.length];return o.reverse().join(n)}}function QCe(t){return function(n){return n.replace(/[0-9]/g,function(r){return t[+r]})}}var ZCe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Xp(t){if(!(n=ZCe.exec(t)))throw new Error("invalid format: "+t);var n;return new i3({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}Xp.prototype=i3.prototype;function i3(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}i3.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function JCe(t){e:for(var n=t.length,r=1,s=-1,i;r<n;++r)switch(t[r]){case".":s=i=r;break;case"0":s===0&&(s=r),i=r;break;default:if(!+t[r])break e;s>0&&(s=0);break}return s>0?t.slice(0,s)+t.slice(i+1):t}var kV;function e_e(t,n){var r=gy(t,n);if(!r)return t+"";var s=r[0],i=r[1],o=i-(kV=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,l=s.length;return o===l?s:o>l?s+new Array(o-l+1).join("0"):o>0?s.slice(0,o)+"."+s.slice(o):"0."+new Array(1-o).join("0")+gy(t,Math.max(0,n+o-1))[0]}function nO(t,n){var r=gy(t,n);if(!r)return t+"";var s=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+s:s.length>i+1?s.slice(0,i+1)+"."+s.slice(i+1):s+new Array(i-s.length+2).join("0")}const rO={"%":(t,n)=>(t*100).toFixed(n),b:t=>Math.round(t).toString(2),c:t=>t+"",d:YCe,e:(t,n)=>t.toExponential(n),f:(t,n)=>t.toFixed(n),g:(t,n)=>t.toPrecision(n),o:t=>Math.round(t).toString(8),p:(t,n)=>nO(t*100,n),r:nO,s:e_e,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function sO(t){return t}var aO=Array.prototype.map,iO=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function t_e(t){var n=t.grouping===void 0||t.thousands===void 0?sO:XCe(aO.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",s=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?sO:QCe(aO.call(t.numerals,String)),l=t.percent===void 0?"%":t.percent+"",c=t.minus===void 0?"":t.minus+"",d=t.nan===void 0?"NaN":t.nan+"";function u(m){m=Xp(m);var g=m.fill,y=m.align,N=m.sign,j=m.symbol,S=m.zero,_=m.width,A=m.comma,k=m.precision,T=m.trim,P=m.type;P==="n"?(A=!0,P="g"):rO[P]||(k===void 0&&(k=12),T=!0,P="g"),(S||g==="0"&&y==="=")&&(S=!0,g="0",y="=");var M=j==="$"?r:j==="#"&&/[boxX]/.test(P)?"0"+P.toLowerCase():"",O=j==="$"?s:/[%p]/.test(P)?l:"",D=rO[P],L=/[defgprs%]/.test(P);k=k===void 0?6:/[gprs]/.test(P)?Math.max(1,Math.min(21,k)):Math.max(0,Math.min(20,k));function $(V){var F=M,Q=O,U,z,q;if(P==="c")Q=D(V)+Q,V="";else{V=+V;var K=V<0||1/V<0;if(V=isNaN(V)?d:D(Math.abs(V),k),T&&(V=JCe(V)),K&&+V==0&&N!=="+"&&(K=!1),F=(K?N==="("?N:c:N==="-"||N==="("?"":N)+F,Q=(P==="s"?iO[8+kV/3]:"")+Q+(K&&N==="("?")":""),L){for(U=-1,z=V.length;++U<z;)if(q=V.charCodeAt(U),48>q||q>57){Q=(q===46?i+V.slice(U+1):V.slice(U))+Q,V=V.slice(0,U);break}}}A&&!S&&(V=n(V,1/0));var X=F.length+V.length+Q.length,J=X<_?new Array(_-X+1).join(g):"";switch(A&&S&&(V=n(J+V,J.length?_-Q.length:1/0),J=""),y){case"<":V=F+V+Q+J;break;case"=":V=F+J+V+Q;break;case"^":V=J.slice(0,X=J.length>>1)+F+V+Q+J.slice(X);break;default:V=J+F+V+Q;break}return o(V)}return $.toString=function(){return m+""},$}function h(m,g){var y=u((m=Xp(m),m.type="f",m)),N=Math.max(-8,Math.min(8,Math.floor(rh(g)/3)))*3,j=Math.pow(10,-N),S=iO[8+N/3];return function(_){return y(j*_)+S}}return{format:u,formatPrefix:h}}var Z0,o3,TV;n_e({thousands:",",grouping:[3],currency:["$",""]});function n_e(t){return Z0=t_e(t),o3=Z0.format,TV=Z0.formatPrefix,Z0}function r_e(t){return Math.max(0,-rh(Math.abs(t)))}function s_e(t,n){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(rh(n)/3)))*3-rh(Math.abs(t)))}function a_e(t,n){return t=Math.abs(t),n=Math.abs(n)-t,Math.max(0,rh(n)-rh(t))+1}function IV(t,n,r,s){var i=pC(t,n,r),o;switch(s=Xp(s??",f"),s.type){case"s":{var l=Math.max(Math.abs(t),Math.abs(n));return s.precision==null&&!isNaN(o=s_e(i,l))&&(s.precision=o),TV(s,l)}case"":case"e":case"g":case"p":case"r":{s.precision==null&&!isNaN(o=a_e(i,Math.max(Math.abs(t),Math.abs(n))))&&(s.precision=o-(s.type==="e"));break}case"f":case"%":{s.precision==null&&!isNaN(o=r_e(i))&&(s.precision=o-(s.type==="%")*2);break}}return o3(s)}function ed(t){var n=t.domain;return t.ticks=function(r){var s=n();return hC(s[0],s[s.length-1],r??10)},t.tickFormat=function(r,s){var i=n();return IV(i[0],i[i.length-1],r??10,s)},t.nice=function(r){r==null&&(r=10);var s=n(),i=0,o=s.length-1,l=s[i],c=s[o],d,u,h=10;for(c<l&&(u=l,l=c,c=u,u=i,i=o,o=u);h-- >0;){if(u=mC(l,c,r),u===d)return s[i]=l,s[o]=c,n(s);if(u>0)l=Math.floor(l/u)*u,c=Math.ceil(c/u)*u;else if(u<0)l=Math.ceil(l*u)/u,c=Math.floor(c*u)/u;else break;d=u}return t},t}function PV(){var t=a3();return t.copy=function(){return Ex(t,PV())},vi.apply(t,arguments),ed(t)}function MV(t){var n;function r(s){return s==null||isNaN(s=+s)?n:s}return r.invert=r,r.domain=r.range=function(s){return arguments.length?(t=Array.from(s,xy),r):t.slice()},r.unknown=function(s){return arguments.length?(n=s,r):n},r.copy=function(){return MV(t).unknown(n)},t=arguments.length?Array.from(t,xy):[0,1],ed(r)}function OV(t,n){t=t.slice();var r=0,s=t.length-1,i=t[r],o=t[s],l;return o<i&&(l=r,r=s,s=l,l=i,i=o,o=l),t[r]=n.floor(i),t[s]=n.ceil(o),t}function oO(t){return Math.log(t)}function lO(t){return Math.exp(t)}function i_e(t){return-Math.log(-t)}function o_e(t){return-Math.exp(-t)}function l_e(t){return isFinite(t)?+("1e"+t):t<0?0:t}function c_e(t){return t===10?l_e:t===Math.E?Math.exp:n=>Math.pow(t,n)}function d_e(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),n=>Math.log(n)/t)}function cO(t){return(n,r)=>-t(-n,r)}function l3(t){const n=t(oO,lO),r=n.domain;let s=10,i,o;function l(){return i=d_e(s),o=c_e(s),r()[0]<0?(i=cO(i),o=cO(o),t(i_e,o_e)):t(oO,lO),n}return n.base=function(c){return arguments.length?(s=+c,l()):s},n.domain=function(c){return arguments.length?(r(c),l()):r()},n.ticks=c=>{const d=r();let u=d[0],h=d[d.length-1];const m=h<u;m&&([u,h]=[h,u]);let g=i(u),y=i(h),N,j;const S=c==null?10:+c;let _=[];if(!(s%1)&&y-g<S){if(g=Math.floor(g),y=Math.ceil(y),u>0){for(;g<=y;++g)for(N=1;N<s;++N)if(j=g<0?N/o(-g):N*o(g),!(j<u)){if(j>h)break;_.push(j)}}else for(;g<=y;++g)for(N=s-1;N>=1;--N)if(j=g>0?N/o(-g):N*o(g),!(j<u)){if(j>h)break;_.push(j)}_.length*2<S&&(_=hC(u,h,S))}else _=hC(g,y,Math.min(y-g,S)).map(o);return m?_.reverse():_},n.tickFormat=(c,d)=>{if(c==null&&(c=10),d==null&&(d=s===10?"s":","),typeof d!="function"&&(!(s%1)&&(d=Xp(d)).precision==null&&(d.trim=!0),d=o3(d)),c===1/0)return d;const u=Math.max(1,s*c/n.ticks().length);return h=>{let m=h/o(Math.round(i(h)));return m*s<s-.5&&(m*=s),m<=u?d(h):""}},n.nice=()=>r(OV(r(),{floor:c=>o(Math.floor(i(c))),ceil:c=>o(Math.ceil(i(c)))})),n}function DV(){const t=l3(gb()).domain([1,10]);return t.copy=()=>Ex(t,DV()).base(t.base()),vi.apply(t,arguments),t}function dO(t){return function(n){return Math.sign(n)*Math.log1p(Math.abs(n/t))}}function uO(t){return function(n){return Math.sign(n)*Math.expm1(Math.abs(n))*t}}function c3(t){var n=1,r=t(dO(n),uO(n));return r.constant=function(s){return arguments.length?t(dO(n=+s),uO(n)):n},ed(r)}function RV(){var t=c3(gb());return t.copy=function(){return Ex(t,RV()).constant(t.constant())},vi.apply(t,arguments)}function fO(t){return function(n){return n<0?-Math.pow(-n,t):Math.pow(n,t)}}function u_e(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function f_e(t){return t<0?-t*t:t*t}function d3(t){var n=t(Hs,Hs),r=1;function s(){return r===1?t(Hs,Hs):r===.5?t(u_e,f_e):t(fO(r),fO(1/r))}return n.exponent=function(i){return arguments.length?(r=+i,s()):r},ed(n)}function u3(){var t=d3(gb());return t.copy=function(){return Ex(t,u3()).exponent(t.exponent())},vi.apply(t,arguments),t}function h_e(){return u3.apply(null,arguments).exponent(.5)}function hO(t){return Math.sign(t)*t*t}function m_e(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function LV(){var t=a3(),n=[0,1],r=!1,s;function i(o){var l=m_e(t(o));return isNaN(l)?s:r?Math.round(l):l}return i.invert=function(o){return t.invert(hO(o))},i.domain=function(o){return arguments.length?(t.domain(o),i):t.domain()},i.range=function(o){return arguments.length?(t.range((n=Array.from(o,xy)).map(hO)),i):n.slice()},i.rangeRound=function(o){return i.range(o).round(!0)},i.round=function(o){return arguments.length?(r=!!o,i):r},i.clamp=function(o){return arguments.length?(t.clamp(o),i):t.clamp()},i.unknown=function(o){return arguments.length?(s=o,i):s},i.copy=function(){return LV(t.domain(),n).round(r).clamp(t.clamp()).unknown(s)},vi.apply(i,arguments),ed(i)}function BV(){var t=[],n=[],r=[],s;function i(){var l=0,c=Math.max(1,n.length);for(r=new Array(c-1);++l<c;)r[l-1]=yCe(t,l/c);return o}function o(l){return l==null||isNaN(l=+l)?s:n[_x(r,l)]}return o.invertExtent=function(l){var c=n.indexOf(l);return c<0?[NaN,NaN]:[c>0?r[c-1]:t[0],c<r.length?r[c]:t[t.length-1]]},o.domain=function(l){if(!arguments.length)return t.slice();t=[];for(let c of l)c!=null&&!isNaN(c=+c)&&t.push(c);return t.sort(Cc),i()},o.range=function(l){return arguments.length?(n=Array.from(l),i()):n.slice()},o.unknown=function(l){return arguments.length?(s=l,o):s},o.quantiles=function(){return r.slice()},o.copy=function(){return BV().domain(t).range(n).unknown(s)},vi.apply(o,arguments)}function FV(){var t=0,n=1,r=1,s=[.5],i=[0,1],o;function l(d){return d!=null&&d<=d?i[_x(s,d,0,r)]:o}function c(){var d=-1;for(s=new Array(r);++d<r;)s[d]=((d+1)*n-(d-r)*t)/(r+1);return l}return l.domain=function(d){return arguments.length?([t,n]=d,t=+t,n=+n,c()):[t,n]},l.range=function(d){return arguments.length?(r=(i=Array.from(d)).length-1,c()):i.slice()},l.invertExtent=function(d){var u=i.indexOf(d);return u<0?[NaN,NaN]:u<1?[t,s[0]]:u>=r?[s[r-1],n]:[s[u-1],s[u]]},l.unknown=function(d){return arguments.length&&(o=d),l},l.thresholds=function(){return s.slice()},l.copy=function(){return FV().domain([t,n]).range(i).unknown(o)},vi.apply(ed(l),arguments)}function $V(){var t=[.5],n=[0,1],r,s=1;function i(o){return o!=null&&o<=o?n[_x(t,o,0,s)]:r}return i.domain=function(o){return arguments.length?(t=Array.from(o),s=Math.min(t.length,n.length-1),i):t.slice()},i.range=function(o){return arguments.length?(n=Array.from(o),s=Math.min(t.length,n.length-1),i):n.slice()},i.invertExtent=function(o){var l=n.indexOf(o);return[t[l-1],t[l]]},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return $V().domain(t).range(n).unknown(r)},vi.apply(i,arguments)}const r2=new Date,s2=new Date;function Hr(t,n,r,s){function i(o){return t(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(t(o=new Date(+o)),o),i.ceil=o=>(t(o=new Date(o-1)),n(o,1),t(o),o),i.round=o=>{const l=i(o),c=i.ceil(o);return o-l<c-o?l:c},i.offset=(o,l)=>(n(o=new Date(+o),l==null?1:Math.floor(l)),o),i.range=(o,l,c)=>{const d=[];if(o=i.ceil(o),c=c==null?1:Math.floor(c),!(o<l)||!(c>0))return d;let u;do d.push(u=new Date(+o)),n(o,c),t(o);while(u<o&&o<l);return d},i.filter=o=>Hr(l=>{if(l>=l)for(;t(l),!o(l);)l.setTime(l-1)},(l,c)=>{if(l>=l)if(c<0)for(;++c<=0;)for(;n(l,-1),!o(l););else for(;--c>=0;)for(;n(l,1),!o(l););}),r&&(i.count=(o,l)=>(r2.setTime(+o),s2.setTime(+l),t(r2),t(s2),Math.floor(r(r2,s2))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(s?l=>s(l)%o===0:l=>i.count(0,l)%o===0):i)),i}const yy=Hr(()=>{},(t,n)=>{t.setTime(+t+n)},(t,n)=>n-t);yy.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Hr(n=>{n.setTime(Math.floor(n/t)*t)},(n,r)=>{n.setTime(+n+r*t)},(n,r)=>(r-n)/t):yy);yy.range;const nl=1e3,oi=nl*60,rl=oi*60,vl=rl*24,f3=vl*7,mO=vl*30,a2=vl*365,Od=Hr(t=>{t.setTime(t-t.getMilliseconds())},(t,n)=>{t.setTime(+t+n*nl)},(t,n)=>(n-t)/nl,t=>t.getUTCSeconds());Od.range;const h3=Hr(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*nl)},(t,n)=>{t.setTime(+t+n*oi)},(t,n)=>(n-t)/oi,t=>t.getMinutes());h3.range;const m3=Hr(t=>{t.setUTCSeconds(0,0)},(t,n)=>{t.setTime(+t+n*oi)},(t,n)=>(n-t)/oi,t=>t.getUTCMinutes());m3.range;const p3=Hr(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*nl-t.getMinutes()*oi)},(t,n)=>{t.setTime(+t+n*rl)},(t,n)=>(n-t)/rl,t=>t.getHours());p3.range;const x3=Hr(t=>{t.setUTCMinutes(0,0,0)},(t,n)=>{t.setTime(+t+n*rl)},(t,n)=>(n-t)/rl,t=>t.getUTCHours());x3.range;const kx=Hr(t=>t.setHours(0,0,0,0),(t,n)=>t.setDate(t.getDate()+n),(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*oi)/vl,t=>t.getDate()-1);kx.range;const yb=Hr(t=>{t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n)},(t,n)=>(n-t)/vl,t=>t.getUTCDate()-1);yb.range;const zV=Hr(t=>{t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n)},(t,n)=>(n-t)/vl,t=>Math.floor(t/vl));zV.range;function Pu(t){return Hr(n=>{n.setDate(n.getDate()-(n.getDay()+7-t)%7),n.setHours(0,0,0,0)},(n,r)=>{n.setDate(n.getDate()+r*7)},(n,r)=>(r-n-(r.getTimezoneOffset()-n.getTimezoneOffset())*oi)/f3)}const vb=Pu(0),vy=Pu(1),p_e=Pu(2),x_e=Pu(3),sh=Pu(4),g_e=Pu(5),y_e=Pu(6);vb.range;vy.range;p_e.range;x_e.range;sh.range;g_e.range;y_e.range;function Mu(t){return Hr(n=>{n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-t)%7),n.setUTCHours(0,0,0,0)},(n,r)=>{n.setUTCDate(n.getUTCDate()+r*7)},(n,r)=>(r-n)/f3)}const bb=Mu(0),by=Mu(1),v_e=Mu(2),b_e=Mu(3),ah=Mu(4),w_e=Mu(5),N_e=Mu(6);bb.range;by.range;v_e.range;b_e.range;ah.range;w_e.range;N_e.range;const g3=Hr(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,n)=>{t.setMonth(t.getMonth()+n)},(t,n)=>n.getMonth()-t.getMonth()+(n.getFullYear()-t.getFullYear())*12,t=>t.getMonth());g3.range;const y3=Hr(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCMonth(t.getUTCMonth()+n)},(t,n)=>n.getUTCMonth()-t.getUTCMonth()+(n.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());y3.range;const bl=Hr(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n)},(t,n)=>n.getFullYear()-t.getFullYear(),t=>t.getFullYear());bl.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Hr(n=>{n.setFullYear(Math.floor(n.getFullYear()/t)*t),n.setMonth(0,1),n.setHours(0,0,0,0)},(n,r)=>{n.setFullYear(n.getFullYear()+r*t)});bl.range;const wl=Hr(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n)},(t,n)=>n.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());wl.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Hr(n=>{n.setUTCFullYear(Math.floor(n.getUTCFullYear()/t)*t),n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},(n,r)=>{n.setUTCFullYear(n.getUTCFullYear()+r*t)});wl.range;function UV(t,n,r,s,i,o){const l=[[Od,1,nl],[Od,5,5*nl],[Od,15,15*nl],[Od,30,30*nl],[o,1,oi],[o,5,5*oi],[o,15,15*oi],[o,30,30*oi],[i,1,rl],[i,3,3*rl],[i,6,6*rl],[i,12,12*rl],[s,1,vl],[s,2,2*vl],[r,1,f3],[n,1,mO],[n,3,3*mO],[t,1,a2]];function c(u,h,m){const g=h<u;g&&([u,h]=[h,u]);const y=m&&typeof m.range=="function"?m:d(u,h,m),N=y?y.range(u,+h+1):[];return g?N.reverse():N}function d(u,h,m){const g=Math.abs(h-u)/m,y=JE(([,,S])=>S).right(l,g);if(y===l.length)return t.every(pC(u/a2,h/a2,m));if(y===0)return yy.every(Math.max(pC(u,h,m),1));const[N,j]=l[g/l[y-1][2]<l[y][2]/g?y-1:y];return N.every(j)}return[c,d]}const[j_e,S_e]=UV(wl,y3,bb,zV,x3,m3),[C_e,__e]=UV(bl,g3,vb,kx,p3,h3);function i2(t){if(0<=t.y&&t.y<100){var n=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return n.setFullYear(t.y),n}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function o2(t){if(0<=t.y&&t.y<100){var n=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return n.setUTCFullYear(t.y),n}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function mm(t,n,r){return{y:t,m:n,d:r,H:0,M:0,S:0,L:0}}function A_e(t){var n=t.dateTime,r=t.date,s=t.time,i=t.periods,o=t.days,l=t.shortDays,c=t.months,d=t.shortMonths,u=pm(i),h=xm(i),m=pm(o),g=xm(o),y=pm(l),N=xm(l),j=pm(c),S=xm(c),_=pm(d),A=xm(d),k={a:K,A:X,b:J,B:ne,c:null,d:bO,e:bO,f:X_e,g:iAe,G:lAe,H:G_e,I:K_e,j:Y_e,L:VV,m:Q_e,M:Z_e,p:Se,q:de,Q:jO,s:SO,S:J_e,u:eAe,U:tAe,V:nAe,w:rAe,W:sAe,x:null,X:null,y:aAe,Y:oAe,Z:cAe,"%":NO},T={a:ye,A:be,b:xe,B:_e,c:null,d:wO,e:wO,f:hAe,g:jAe,G:CAe,H:dAe,I:uAe,j:fAe,L:WV,m:mAe,M:pAe,p:we,q:Oe,Q:jO,s:SO,S:xAe,u:gAe,U:yAe,V:vAe,w:bAe,W:wAe,x:null,X:null,y:NAe,Y:SAe,Z:_Ae,"%":NO},P={a:$,A:V,b:F,B:Q,c:U,d:yO,e:yO,f:V_e,g:gO,G:xO,H:vO,I:vO,j:F_e,L:U_e,m:B_e,M:$_e,p:L,q:L_e,Q:W_e,s:q_e,S:z_e,u:P_e,U:M_e,V:O_e,w:I_e,W:D_e,x:z,X:q,y:gO,Y:xO,Z:R_e,"%":H_e};k.x=M(r,k),k.X=M(s,k),k.c=M(n,k),T.x=M(r,T),T.X=M(s,T),T.c=M(n,T);function M(ae,ie){return function(pe){var re=[],We=-1,Je=0,St=ae.length,wt,ft,Ie;for(pe instanceof Date||(pe=new Date(+pe));++We<St;)ae.charCodeAt(We)===37&&(re.push(ae.slice(Je,We)),(ft=pO[wt=ae.charAt(++We)])!=null?wt=ae.charAt(++We):ft=wt==="e"?" ":"0",(Ie=ie[wt])&&(wt=Ie(pe,ft)),re.push(wt),Je=We+1);return re.push(ae.slice(Je,We)),re.join("")}}function O(ae,ie){return function(pe){var re=mm(1900,void 0,1),We=D(re,ae,pe+="",0),Je,St;if(We!=pe.length)return null;if("Q"in re)return new Date(re.Q);if("s"in re)return new Date(re.s*1e3+("L"in re?re.L:0));if(ie&&!("Z"in re)&&(re.Z=0),"p"in re&&(re.H=re.H%12+re.p*12),re.m===void 0&&(re.m="q"in re?re.q:0),"V"in re){if(re.V<1||re.V>53)return null;"w"in re||(re.w=1),"Z"in re?(Je=o2(mm(re.y,0,1)),St=Je.getUTCDay(),Je=St>4||St===0?by.ceil(Je):by(Je),Je=yb.offset(Je,(re.V-1)*7),re.y=Je.getUTCFullYear(),re.m=Je.getUTCMonth(),re.d=Je.getUTCDate()+(re.w+6)%7):(Je=i2(mm(re.y,0,1)),St=Je.getDay(),Je=St>4||St===0?vy.ceil(Je):vy(Je),Je=kx.offset(Je,(re.V-1)*7),re.y=Je.getFullYear(),re.m=Je.getMonth(),re.d=Je.getDate()+(re.w+6)%7)}else("W"in re||"U"in re)&&("w"in re||(re.w="u"in re?re.u%7:"W"in re?1:0),St="Z"in re?o2(mm(re.y,0,1)).getUTCDay():i2(mm(re.y,0,1)).getDay(),re.m=0,re.d="W"in re?(re.w+6)%7+re.W*7-(St+5)%7:re.w+re.U*7-(St+6)%7);return"Z"in re?(re.H+=re.Z/100|0,re.M+=re.Z%100,o2(re)):i2(re)}}function D(ae,ie,pe,re){for(var We=0,Je=ie.length,St=pe.length,wt,ft;We<Je;){if(re>=St)return-1;if(wt=ie.charCodeAt(We++),wt===37){if(wt=ie.charAt(We++),ft=P[wt in pO?ie.charAt(We++):wt],!ft||(re=ft(ae,pe,re))<0)return-1}else if(wt!=pe.charCodeAt(re++))return-1}return re}function L(ae,ie,pe){var re=u.exec(ie.slice(pe));return re?(ae.p=h.get(re[0].toLowerCase()),pe+re[0].length):-1}function $(ae,ie,pe){var re=y.exec(ie.slice(pe));return re?(ae.w=N.get(re[0].toLowerCase()),pe+re[0].length):-1}function V(ae,ie,pe){var re=m.exec(ie.slice(pe));return re?(ae.w=g.get(re[0].toLowerCase()),pe+re[0].length):-1}function F(ae,ie,pe){var re=_.exec(ie.slice(pe));return re?(ae.m=A.get(re[0].toLowerCase()),pe+re[0].length):-1}function Q(ae,ie,pe){var re=j.exec(ie.slice(pe));return re?(ae.m=S.get(re[0].toLowerCase()),pe+re[0].length):-1}function U(ae,ie,pe){return D(ae,n,ie,pe)}function z(ae,ie,pe){return D(ae,r,ie,pe)}function q(ae,ie,pe){return D(ae,s,ie,pe)}function K(ae){return l[ae.getDay()]}function X(ae){return o[ae.getDay()]}function J(ae){return d[ae.getMonth()]}function ne(ae){return c[ae.getMonth()]}function Se(ae){return i[+(ae.getHours()>=12)]}function de(ae){return 1+~~(ae.getMonth()/3)}function ye(ae){return l[ae.getUTCDay()]}function be(ae){return o[ae.getUTCDay()]}function xe(ae){return d[ae.getUTCMonth()]}function _e(ae){return c[ae.getUTCMonth()]}function we(ae){return i[+(ae.getUTCHours()>=12)]}function Oe(ae){return 1+~~(ae.getUTCMonth()/3)}return{format:function(ae){var ie=M(ae+="",k);return ie.toString=function(){return ae},ie},parse:function(ae){var ie=O(ae+="",!1);return ie.toString=function(){return ae},ie},utcFormat:function(ae){var ie=M(ae+="",T);return ie.toString=function(){return ae},ie},utcParse:function(ae){var ie=O(ae+="",!0);return ie.toString=function(){return ae},ie}}}var pO={"-":"",_:" ",0:"0"},ts=/^\s*\d+/,E_e=/^%/,k_e=/[\\^$*+?|[\]().{}]/g;function nn(t,n,r){var s=t<0?"-":"",i=(s?-t:t)+"",o=i.length;return s+(o<r?new Array(r-o+1).join(n)+i:i)}function T_e(t){return t.replace(k_e,"\\$&")}function pm(t){return new RegExp("^(?:"+t.map(T_e).join("|")+")","i")}function xm(t){return new Map(t.map((n,r)=>[n.toLowerCase(),r]))}function I_e(t,n,r){var s=ts.exec(n.slice(r,r+1));return s?(t.w=+s[0],r+s[0].length):-1}function P_e(t,n,r){var s=ts.exec(n.slice(r,r+1));return s?(t.u=+s[0],r+s[0].length):-1}function M_e(t,n,r){var s=ts.exec(n.slice(r,r+2));return s?(t.U=+s[0],r+s[0].length):-1}function O_e(t,n,r){var s=ts.exec(n.slice(r,r+2));return s?(t.V=+s[0],r+s[0].length):-1}function D_e(t,n,r){var s=ts.exec(n.slice(r,r+2));return s?(t.W=+s[0],r+s[0].length):-1}function xO(t,n,r){var s=ts.exec(n.slice(r,r+4));return s?(t.y=+s[0],r+s[0].length):-1}function gO(t,n,r){var s=ts.exec(n.slice(r,r+2));return s?(t.y=+s[0]+(+s[0]>68?1900:2e3),r+s[0].length):-1}function R_e(t,n,r){var s=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(n.slice(r,r+6));return s?(t.Z=s[1]?0:-(s[2]+(s[3]||"00")),r+s[0].length):-1}function L_e(t,n,r){var s=ts.exec(n.slice(r,r+1));return s?(t.q=s[0]*3-3,r+s[0].length):-1}function B_e(t,n,r){var s=ts.exec(n.slice(r,r+2));return s?(t.m=s[0]-1,r+s[0].length):-1}function yO(t,n,r){var s=ts.exec(n.slice(r,r+2));return s?(t.d=+s[0],r+s[0].length):-1}function F_e(t,n,r){var s=ts.exec(n.slice(r,r+3));return s?(t.m=0,t.d=+s[0],r+s[0].length):-1}function vO(t,n,r){var s=ts.exec(n.slice(r,r+2));return s?(t.H=+s[0],r+s[0].length):-1}function $_e(t,n,r){var s=ts.exec(n.slice(r,r+2));return s?(t.M=+s[0],r+s[0].length):-1}function z_e(t,n,r){var s=ts.exec(n.slice(r,r+2));return s?(t.S=+s[0],r+s[0].length):-1}function U_e(t,n,r){var s=ts.exec(n.slice(r,r+3));return s?(t.L=+s[0],r+s[0].length):-1}function V_e(t,n,r){var s=ts.exec(n.slice(r,r+6));return s?(t.L=Math.floor(s[0]/1e3),r+s[0].length):-1}function H_e(t,n,r){var s=E_e.exec(n.slice(r,r+1));return s?r+s[0].length:-1}function W_e(t,n,r){var s=ts.exec(n.slice(r));return s?(t.Q=+s[0],r+s[0].length):-1}function q_e(t,n,r){var s=ts.exec(n.slice(r));return s?(t.s=+s[0],r+s[0].length):-1}function bO(t,n){return nn(t.getDate(),n,2)}function G_e(t,n){return nn(t.getHours(),n,2)}function K_e(t,n){return nn(t.getHours()%12||12,n,2)}function Y_e(t,n){return nn(1+kx.count(bl(t),t),n,3)}function VV(t,n){return nn(t.getMilliseconds(),n,3)}function X_e(t,n){return VV(t,n)+"000"}function Q_e(t,n){return nn(t.getMonth()+1,n,2)}function Z_e(t,n){return nn(t.getMinutes(),n,2)}function J_e(t,n){return nn(t.getSeconds(),n,2)}function eAe(t){var n=t.getDay();return n===0?7:n}function tAe(t,n){return nn(vb.count(bl(t)-1,t),n,2)}function HV(t){var n=t.getDay();return n>=4||n===0?sh(t):sh.ceil(t)}function nAe(t,n){return t=HV(t),nn(sh.count(bl(t),t)+(bl(t).getDay()===4),n,2)}function rAe(t){return t.getDay()}function sAe(t,n){return nn(vy.count(bl(t)-1,t),n,2)}function aAe(t,n){return nn(t.getFullYear()%100,n,2)}function iAe(t,n){return t=HV(t),nn(t.getFullYear()%100,n,2)}function oAe(t,n){return nn(t.getFullYear()%1e4,n,4)}function lAe(t,n){var r=t.getDay();return t=r>=4||r===0?sh(t):sh.ceil(t),nn(t.getFullYear()%1e4,n,4)}function cAe(t){var n=t.getTimezoneOffset();return(n>0?"-":(n*=-1,"+"))+nn(n/60|0,"0",2)+nn(n%60,"0",2)}function wO(t,n){return nn(t.getUTCDate(),n,2)}function dAe(t,n){return nn(t.getUTCHours(),n,2)}function uAe(t,n){return nn(t.getUTCHours()%12||12,n,2)}function fAe(t,n){return nn(1+yb.count(wl(t),t),n,3)}function WV(t,n){return nn(t.getUTCMilliseconds(),n,3)}function hAe(t,n){return WV(t,n)+"000"}function mAe(t,n){return nn(t.getUTCMonth()+1,n,2)}function pAe(t,n){return nn(t.getUTCMinutes(),n,2)}function xAe(t,n){return nn(t.getUTCSeconds(),n,2)}function gAe(t){var n=t.getUTCDay();return n===0?7:n}function yAe(t,n){return nn(bb.count(wl(t)-1,t),n,2)}function qV(t){var n=t.getUTCDay();return n>=4||n===0?ah(t):ah.ceil(t)}function vAe(t,n){return t=qV(t),nn(ah.count(wl(t),t)+(wl(t).getUTCDay()===4),n,2)}function bAe(t){return t.getUTCDay()}function wAe(t,n){return nn(by.count(wl(t)-1,t),n,2)}function NAe(t,n){return nn(t.getUTCFullYear()%100,n,2)}function jAe(t,n){return t=qV(t),nn(t.getUTCFullYear()%100,n,2)}function SAe(t,n){return nn(t.getUTCFullYear()%1e4,n,4)}function CAe(t,n){var r=t.getUTCDay();return t=r>=4||r===0?ah(t):ah.ceil(t),nn(t.getUTCFullYear()%1e4,n,4)}function _Ae(){return"+0000"}function NO(){return"%"}function jO(t){return+t}function SO(t){return Math.floor(+t/1e3)}var qu,GV,KV;AAe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function AAe(t){return qu=A_e(t),GV=qu.format,qu.parse,KV=qu.utcFormat,qu.utcParse,qu}function EAe(t){return new Date(t)}function kAe(t){return t instanceof Date?+t:+new Date(+t)}function v3(t,n,r,s,i,o,l,c,d,u){var h=a3(),m=h.invert,g=h.domain,y=u(".%L"),N=u(":%S"),j=u("%I:%M"),S=u("%I %p"),_=u("%a %d"),A=u("%b %d"),k=u("%B"),T=u("%Y");function P(M){return(d(M)<M?y:c(M)<M?N:l(M)<M?j:o(M)<M?S:s(M)<M?i(M)<M?_:A:r(M)<M?k:T)(M)}return h.invert=function(M){return new Date(m(M))},h.domain=function(M){return arguments.length?g(Array.from(M,kAe)):g().map(EAe)},h.ticks=function(M){var O=g();return t(O[0],O[O.length-1],M??10)},h.tickFormat=function(M,O){return O==null?P:u(O)},h.nice=function(M){var O=g();return(!M||typeof M.range!="function")&&(M=n(O[0],O[O.length-1],M??10)),M?g(OV(O,M)):h},h.copy=function(){return Ex(h,v3(t,n,r,s,i,o,l,c,d,u))},h}function TAe(){return vi.apply(v3(C_e,__e,bl,g3,vb,kx,p3,h3,Od,GV).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function IAe(){return vi.apply(v3(j_e,S_e,wl,y3,bb,yb,x3,m3,Od,KV).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function wb(){var t=0,n=1,r,s,i,o,l=Hs,c=!1,d;function u(m){return m==null||isNaN(m=+m)?d:l(i===0?.5:(m=(o(m)-r)*i,c?Math.max(0,Math.min(1,m)):m))}u.domain=function(m){return arguments.length?([t,n]=m,r=o(t=+t),s=o(n=+n),i=r===s?0:1/(s-r),u):[t,n]},u.clamp=function(m){return arguments.length?(c=!!m,u):c},u.interpolator=function(m){return arguments.length?(l=m,u):l};function h(m){return function(g){var y,N;return arguments.length?([y,N]=g,l=m(y,N),u):[l(0),l(1)]}}return u.range=h(Eh),u.rangeRound=h(s3),u.unknown=function(m){return arguments.length?(d=m,u):d},function(m){return o=m,r=m(t),s=m(n),i=r===s?0:1/(s-r),u}}function td(t,n){return n.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function YV(){var t=ed(wb()(Hs));return t.copy=function(){return td(t,YV())},Il.apply(t,arguments)}function XV(){var t=l3(wb()).domain([1,10]);return t.copy=function(){return td(t,XV()).base(t.base())},Il.apply(t,arguments)}function QV(){var t=c3(wb());return t.copy=function(){return td(t,QV()).constant(t.constant())},Il.apply(t,arguments)}function b3(){var t=d3(wb());return t.copy=function(){return td(t,b3()).exponent(t.exponent())},Il.apply(t,arguments)}function PAe(){return b3.apply(null,arguments).exponent(.5)}function ZV(){var t=[],n=Hs;function r(s){if(s!=null&&!isNaN(s=+s))return n((_x(t,s,1)-1)/(t.length-1))}return r.domain=function(s){if(!arguments.length)return t.slice();t=[];for(let i of s)i!=null&&!isNaN(i=+i)&&t.push(i);return t.sort(Cc),r},r.interpolator=function(s){return arguments.length?(n=s,r):n},r.range=function(){return t.map((s,i)=>n(i/(t.length-1)))},r.quantiles=function(s){return Array.from({length:s+1},(i,o)=>gCe(t,o/s))},r.copy=function(){return ZV(n).domain(t)},Il.apply(r,arguments)}function Nb(){var t=0,n=.5,r=1,s=1,i,o,l,c,d,u=Hs,h,m=!1,g;function y(j){return isNaN(j=+j)?g:(j=.5+((j=+h(j))-o)*(s*j<s*o?c:d),u(m?Math.max(0,Math.min(1,j)):j))}y.domain=function(j){return arguments.length?([t,n,r]=j,i=h(t=+t),o=h(n=+n),l=h(r=+r),c=i===o?0:.5/(o-i),d=o===l?0:.5/(l-o),s=o<i?-1:1,y):[t,n,r]},y.clamp=function(j){return arguments.length?(m=!!j,y):m},y.interpolator=function(j){return arguments.length?(u=j,y):u};function N(j){return function(S){var _,A,k;return arguments.length?([_,A,k]=S,u=HCe(j,[_,A,k]),y):[u(0),u(.5),u(1)]}}return y.range=N(Eh),y.rangeRound=N(s3),y.unknown=function(j){return arguments.length?(g=j,y):g},function(j){return h=j,i=j(t),o=j(n),l=j(r),c=i===o?0:.5/(o-i),d=o===l?0:.5/(l-o),s=o<i?-1:1,y}}function JV(){var t=ed(Nb()(Hs));return t.copy=function(){return td(t,JV())},Il.apply(t,arguments)}function eH(){var t=l3(Nb()).domain([.1,1,10]);return t.copy=function(){return td(t,eH()).base(t.base())},Il.apply(t,arguments)}function tH(){var t=c3(Nb());return t.copy=function(){return td(t,tH()).constant(t.constant())},Il.apply(t,arguments)}function w3(){var t=d3(Nb());return t.copy=function(){return td(t,w3()).exponent(t.exponent())},Il.apply(t,arguments)}function MAe(){return w3.apply(null,arguments).exponent(.5)}const Im=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:t3,scaleDiverging:JV,scaleDivergingLog:eH,scaleDivergingPow:w3,scaleDivergingSqrt:MAe,scaleDivergingSymlog:tH,scaleIdentity:MV,scaleImplicit:xC,scaleLinear:PV,scaleLog:DV,scaleOrdinal:e3,scalePoint:bCe,scalePow:u3,scaleQuantile:BV,scaleQuantize:FV,scaleRadial:LV,scaleSequential:YV,scaleSequentialLog:XV,scaleSequentialPow:b3,scaleSequentialQuantile:ZV,scaleSequentialSqrt:PAe,scaleSequentialSymlog:QV,scaleSqrt:h_e,scaleSymlog:RV,scaleThreshold:$V,scaleTime:TAe,scaleUtc:IAe,tickFormat:IV},Symbol.toStringTag,{value:"Module"}));var nd=t=>t.chartData,N3=je([nd],t=>{var n=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:n,dataStartIndex:0}}),j3=(t,n,r,s)=>s?N3(t):nd(t);function xu(t){if(Array.isArray(t)&&t.length===2){var[n,r]=t;if(yr(n)&&yr(r))return!0}return!1}function CO(t,n,r){return r?t:[Math.min(t[0],n[0]),Math.max(t[1],n[1])]}function nH(t,n){if(n&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[r,s]=t,i,o;if(yr(r))i=r;else if(typeof r=="function")return;if(yr(s))o=s;else if(typeof s=="function")return;var l=[i,o];if(xu(l))return l}}function OAe(t,n,r){if(!(!r&&n==null)){if(typeof t=="function"&&n!=null)try{var s=t(n,r);if(xu(s))return CO(s,n,r)}catch{}if(Array.isArray(t)&&t.length===2){var[i,o]=t,l,c;if(i==="auto")n!=null&&(l=Math.min(...n));else if(vt(i))l=i;else if(typeof i=="function")try{n!=null&&(l=i(n==null?void 0:n[0]))}catch{}else if(typeof i=="string"&&m4.test(i)){var d=m4.exec(i);if(d==null||n==null)l=void 0;else{var u=+d[1];l=n[0]-u}}else l=n==null?void 0:n[0];if(o==="auto")n!=null&&(c=Math.max(...n));else if(vt(o))c=o;else if(typeof o=="function")try{n!=null&&(c=o(n==null?void 0:n[1]))}catch{}else if(typeof o=="string"&&p4.test(o)){var h=p4.exec(o);if(h==null||n==null)c=void 0;else{var m=+h[1];c=n[1]+m}}else c=n==null?void 0:n[1];var g=[l,c];if(xu(g))return n==null?g:CO(g,n,r)}}}var kh=1e9,DAe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},C3,Un=!0,xi="[DecimalError] ",Qd=xi+"Invalid argument: ",S3=xi+"Exponent out of range: ",Th=Math.floor,gd=Math.pow,RAe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ea,Xr=1e7,Dn=7,rH=9007199254740991,wy=Th(rH/Dn),ot={};ot.absoluteValue=ot.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};ot.comparedTo=ot.cmp=function(t){var n,r,s,i,o=this;if(t=new o.constructor(t),o.s!==t.s)return o.s||-t.s;if(o.e!==t.e)return o.e>t.e^o.s<0?1:-1;for(s=o.d.length,i=t.d.length,n=0,r=s<i?s:i;n<r;++n)if(o.d[n]!==t.d[n])return o.d[n]>t.d[n]^o.s<0?1:-1;return s===i?0:s>i^o.s<0?1:-1};ot.decimalPlaces=ot.dp=function(){var t=this,n=t.d.length-1,r=(n-t.e)*Dn;if(n=t.d[n],n)for(;n%10==0;n/=10)r--;return r<0?0:r};ot.dividedBy=ot.div=function(t){return ol(this,new this.constructor(t))};ot.dividedToIntegerBy=ot.idiv=function(t){var n=this,r=n.constructor;return Sn(ol(n,new r(t),0,1),r.precision)};ot.equals=ot.eq=function(t){return!this.cmp(t)};ot.exponent=function(){return _r(this)};ot.greaterThan=ot.gt=function(t){return this.cmp(t)>0};ot.greaterThanOrEqualTo=ot.gte=function(t){return this.cmp(t)>=0};ot.isInteger=ot.isint=function(){return this.e>this.d.length-2};ot.isNegative=ot.isneg=function(){return this.s<0};ot.isPositive=ot.ispos=function(){return this.s>0};ot.isZero=function(){return this.s===0};ot.lessThan=ot.lt=function(t){return this.cmp(t)<0};ot.lessThanOrEqualTo=ot.lte=function(t){return this.cmp(t)<1};ot.logarithm=ot.log=function(t){var n,r=this,s=r.constructor,i=s.precision,o=i+5;if(t===void 0)t=new s(10);else if(t=new s(t),t.s<1||t.eq(Ea))throw Error(xi+"NaN");if(r.s<1)throw Error(xi+(r.s?"NaN":"-Infinity"));return r.eq(Ea)?new s(0):(Un=!1,n=ol(Qp(r,o),Qp(t,o),o),Un=!0,Sn(n,i))};ot.minus=ot.sub=function(t){var n=this;return t=new n.constructor(t),n.s==t.s?iH(n,t):sH(n,(t.s=-t.s,t))};ot.modulo=ot.mod=function(t){var n,r=this,s=r.constructor,i=s.precision;if(t=new s(t),!t.s)throw Error(xi+"NaN");return r.s?(Un=!1,n=ol(r,t,0,1).times(t),Un=!0,r.minus(n)):Sn(new s(r),i)};ot.naturalExponential=ot.exp=function(){return aH(this)};ot.naturalLogarithm=ot.ln=function(){return Qp(this)};ot.negated=ot.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};ot.plus=ot.add=function(t){var n=this;return t=new n.constructor(t),n.s==t.s?sH(n,t):iH(n,(t.s=-t.s,t))};ot.precision=ot.sd=function(t){var n,r,s,i=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Qd+t);if(n=_r(i)+1,s=i.d.length-1,r=s*Dn+1,s=i.d[s],s){for(;s%10==0;s/=10)r--;for(s=i.d[0];s>=10;s/=10)r++}return t&&n>r?n:r};ot.squareRoot=ot.sqrt=function(){var t,n,r,s,i,o,l,c=this,d=c.constructor;if(c.s<1){if(!c.s)return new d(0);throw Error(xi+"NaN")}for(t=_r(c),Un=!1,i=Math.sqrt(+c),i==0||i==1/0?(n=po(c.d),(n.length+t)%2==0&&(n+="0"),i=Math.sqrt(n),t=Th((t+1)/2)-(t<0||t%2),i==1/0?n="5e"+t:(n=i.toExponential(),n=n.slice(0,n.indexOf("e")+1)+t),s=new d(n)):s=new d(i.toString()),r=d.precision,i=l=r+3;;)if(o=s,s=o.plus(ol(c,o,l+2)).times(.5),po(o.d).slice(0,l)===(n=po(s.d)).slice(0,l)){if(n=n.slice(l-3,l+1),i==l&&n=="4999"){if(Sn(o,r+1,0),o.times(o).eq(c)){s=o;break}}else if(n!="9999")break;l+=4}return Un=!0,Sn(s,r)};ot.times=ot.mul=function(t){var n,r,s,i,o,l,c,d,u,h=this,m=h.constructor,g=h.d,y=(t=new m(t)).d;if(!h.s||!t.s)return new m(0);for(t.s*=h.s,r=h.e+t.e,d=g.length,u=y.length,d<u&&(o=g,g=y,y=o,l=d,d=u,u=l),o=[],l=d+u,s=l;s--;)o.push(0);for(s=u;--s>=0;){for(n=0,i=d+s;i>s;)c=o[i]+y[s]*g[i-s-1]+n,o[i--]=c%Xr|0,n=c/Xr|0;o[i]=(o[i]+n)%Xr|0}for(;!o[--l];)o.pop();return n?++r:o.shift(),t.d=o,t.e=r,Un?Sn(t,m.precision):t};ot.toDecimalPlaces=ot.todp=function(t,n){var r=this,s=r.constructor;return r=new s(r),t===void 0?r:(Oo(t,0,kh),n===void 0?n=s.rounding:Oo(n,0,8),Sn(r,t+_r(r)+1,n))};ot.toExponential=function(t,n){var r,s=this,i=s.constructor;return t===void 0?r=gu(s,!0):(Oo(t,0,kh),n===void 0?n=i.rounding:Oo(n,0,8),s=Sn(new i(s),t+1,n),r=gu(s,!0,t+1)),r};ot.toFixed=function(t,n){var r,s,i=this,o=i.constructor;return t===void 0?gu(i):(Oo(t,0,kh),n===void 0?n=o.rounding:Oo(n,0,8),s=Sn(new o(i),t+_r(i)+1,n),r=gu(s.abs(),!1,t+_r(s)+1),i.isneg()&&!i.isZero()?"-"+r:r)};ot.toInteger=ot.toint=function(){var t=this,n=t.constructor;return Sn(new n(t),_r(t)+1,n.rounding)};ot.toNumber=function(){return+this};ot.toPower=ot.pow=function(t){var n,r,s,i,o,l,c=this,d=c.constructor,u=12,h=+(t=new d(t));if(!t.s)return new d(Ea);if(c=new d(c),!c.s){if(t.s<1)throw Error(xi+"Infinity");return c}if(c.eq(Ea))return c;if(s=d.precision,t.eq(Ea))return Sn(c,s);if(n=t.e,r=t.d.length-1,l=n>=r,o=c.s,l){if((r=h<0?-h:h)<=rH){for(i=new d(Ea),n=Math.ceil(s/Dn+4),Un=!1;r%2&&(i=i.times(c),AO(i.d,n)),r=Th(r/2),r!==0;)c=c.times(c),AO(c.d,n);return Un=!0,t.s<0?new d(Ea).div(i):Sn(i,s)}}else if(o<0)throw Error(xi+"NaN");return o=o<0&&t.d[Math.max(n,r)]&1?-1:1,c.s=1,Un=!1,i=t.times(Qp(c,s+u)),Un=!0,i=aH(i),i.s=o,i};ot.toPrecision=function(t,n){var r,s,i=this,o=i.constructor;return t===void 0?(r=_r(i),s=gu(i,r<=o.toExpNeg||r>=o.toExpPos)):(Oo(t,1,kh),n===void 0?n=o.rounding:Oo(n,0,8),i=Sn(new o(i),t,n),r=_r(i),s=gu(i,t<=r||r<=o.toExpNeg,t)),s};ot.toSignificantDigits=ot.tosd=function(t,n){var r=this,s=r.constructor;return t===void 0?(t=s.precision,n=s.rounding):(Oo(t,1,kh),n===void 0?n=s.rounding:Oo(n,0,8)),Sn(new s(r),t,n)};ot.toString=ot.valueOf=ot.val=ot.toJSON=ot[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,n=_r(t),r=t.constructor;return gu(t,n<=r.toExpNeg||n>=r.toExpPos)};function sH(t,n){var r,s,i,o,l,c,d,u,h=t.constructor,m=h.precision;if(!t.s||!n.s)return n.s||(n=new h(t)),Un?Sn(n,m):n;if(d=t.d,u=n.d,l=t.e,i=n.e,d=d.slice(),o=l-i,o){for(o<0?(s=d,o=-o,c=u.length):(s=u,i=l,c=d.length),l=Math.ceil(m/Dn),c=l>c?l+1:c+1,o>c&&(o=c,s.length=1),s.reverse();o--;)s.push(0);s.reverse()}for(c=d.length,o=u.length,c-o<0&&(o=c,s=u,u=d,d=s),r=0;o;)r=(d[--o]=d[o]+u[o]+r)/Xr|0,d[o]%=Xr;for(r&&(d.unshift(r),++i),c=d.length;d[--c]==0;)d.pop();return n.d=d,n.e=i,Un?Sn(n,m):n}function Oo(t,n,r){if(t!==~~t||t<n||t>r)throw Error(Qd+t)}function po(t){var n,r,s,i=t.length-1,o="",l=t[0];if(i>0){for(o+=l,n=1;n<i;n++)s=t[n]+"",r=Dn-s.length,r&&(o+=Jl(r)),o+=s;l=t[n],s=l+"",r=Dn-s.length,r&&(o+=Jl(r))}else if(l===0)return"0";for(;l%10===0;)l/=10;return o+l}var ol=function(){function t(s,i){var o,l=0,c=s.length;for(s=s.slice();c--;)o=s[c]*i+l,s[c]=o%Xr|0,l=o/Xr|0;return l&&s.unshift(l),s}function n(s,i,o,l){var c,d;if(o!=l)d=o>l?1:-1;else for(c=d=0;c<o;c++)if(s[c]!=i[c]){d=s[c]>i[c]?1:-1;break}return d}function r(s,i,o){for(var l=0;o--;)s[o]-=l,l=s[o]<i[o]?1:0,s[o]=l*Xr+s[o]-i[o];for(;!s[0]&&s.length>1;)s.shift()}return function(s,i,o,l){var c,d,u,h,m,g,y,N,j,S,_,A,k,T,P,M,O,D,L=s.constructor,$=s.s==i.s?1:-1,V=s.d,F=i.d;if(!s.s)return new L(s);if(!i.s)throw Error(xi+"Division by zero");for(d=s.e-i.e,O=F.length,P=V.length,y=new L($),N=y.d=[],u=0;F[u]==(V[u]||0);)++u;if(F[u]>(V[u]||0)&&--d,o==null?A=o=L.precision:l?A=o+(_r(s)-_r(i))+1:A=o,A<0)return new L(0);if(A=A/Dn+2|0,u=0,O==1)for(h=0,F=F[0],A++;(u<P||h)&&A--;u++)k=h*Xr+(V[u]||0),N[u]=k/F|0,h=k%F|0;else{for(h=Xr/(F[0]+1)|0,h>1&&(F=t(F,h),V=t(V,h),O=F.length,P=V.length),T=O,j=V.slice(0,O),S=j.length;S<O;)j[S++]=0;D=F.slice(),D.unshift(0),M=F[0],F[1]>=Xr/2&&++M;do h=0,c=n(F,j,O,S),c<0?(_=j[0],O!=S&&(_=_*Xr+(j[1]||0)),h=_/M|0,h>1?(h>=Xr&&(h=Xr-1),m=t(F,h),g=m.length,S=j.length,c=n(m,j,g,S),c==1&&(h--,r(m,O<g?D:F,g))):(h==0&&(c=h=1),m=F.slice()),g=m.length,g<S&&m.unshift(0),r(j,m,S),c==-1&&(S=j.length,c=n(F,j,O,S),c<1&&(h++,r(j,O<S?D:F,S))),S=j.length):c===0&&(h++,j=[0]),N[u++]=h,c&&j[0]?j[S++]=V[T]||0:(j=[V[T]],S=1);while((T++<P||j[0]!==void 0)&&A--)}return N[0]||N.shift(),y.e=d,Sn(y,l?o+_r(y)+1:o)}}();function aH(t,n){var r,s,i,o,l,c,d=0,u=0,h=t.constructor,m=h.precision;if(_r(t)>16)throw Error(S3+_r(t));if(!t.s)return new h(Ea);for(Un=!1,c=m,l=new h(.03125);t.abs().gte(.1);)t=t.times(l),u+=5;for(s=Math.log(gd(2,u))/Math.LN10*2+5|0,c+=s,r=i=o=new h(Ea),h.precision=c;;){if(i=Sn(i.times(t),c),r=r.times(++d),l=o.plus(ol(i,r,c)),po(l.d).slice(0,c)===po(o.d).slice(0,c)){for(;u--;)o=Sn(o.times(o),c);return h.precision=m,n==null?(Un=!0,Sn(o,m)):o}o=l}}function _r(t){for(var n=t.e*Dn,r=t.d[0];r>=10;r/=10)n++;return n}function l2(t,n,r){if(n>t.LN10.sd())throw Un=!0,r&&(t.precision=r),Error(xi+"LN10 precision limit exceeded");return Sn(new t(t.LN10),n)}function Jl(t){for(var n="";t--;)n+="0";return n}function Qp(t,n){var r,s,i,o,l,c,d,u,h,m=1,g=10,y=t,N=y.d,j=y.constructor,S=j.precision;if(y.s<1)throw Error(xi+(y.s?"NaN":"-Infinity"));if(y.eq(Ea))return new j(0);if(n==null?(Un=!1,u=S):u=n,y.eq(10))return n==null&&(Un=!0),l2(j,u);if(u+=g,j.precision=u,r=po(N),s=r.charAt(0),o=_r(y),Math.abs(o)<15e14){for(;s<7&&s!=1||s==1&&r.charAt(1)>3;)y=y.times(t),r=po(y.d),s=r.charAt(0),m++;o=_r(y),s>1?(y=new j("0."+r),o++):y=new j(s+"."+r.slice(1))}else return d=l2(j,u+2,S).times(o+""),y=Qp(new j(s+"."+r.slice(1)),u-g).plus(d),j.precision=S,n==null?(Un=!0,Sn(y,S)):y;for(c=l=y=ol(y.minus(Ea),y.plus(Ea),u),h=Sn(y.times(y),u),i=3;;){if(l=Sn(l.times(h),u),d=c.plus(ol(l,new j(i),u)),po(d.d).slice(0,u)===po(c.d).slice(0,u))return c=c.times(2),o!==0&&(c=c.plus(l2(j,u+2,S).times(o+""))),c=ol(c,new j(m),u),j.precision=S,n==null?(Un=!0,Sn(c,S)):c;c=d,i+=2}}function _O(t,n){var r,s,i;for((r=n.indexOf("."))>-1&&(n=n.replace(".","")),(s=n.search(/e/i))>0?(r<0&&(r=s),r+=+n.slice(s+1),n=n.substring(0,s)):r<0&&(r=n.length),s=0;n.charCodeAt(s)===48;)++s;for(i=n.length;n.charCodeAt(i-1)===48;)--i;if(n=n.slice(s,i),n){if(i-=s,r=r-s-1,t.e=Th(r/Dn),t.d=[],s=(r+1)%Dn,r<0&&(s+=Dn),s<i){for(s&&t.d.push(+n.slice(0,s)),i-=Dn;s<i;)t.d.push(+n.slice(s,s+=Dn));n=n.slice(s),s=Dn-n.length}else s-=i;for(;s--;)n+="0";if(t.d.push(+n),Un&&(t.e>wy||t.e<-wy))throw Error(S3+r)}else t.s=0,t.e=0,t.d=[0];return t}function Sn(t,n,r){var s,i,o,l,c,d,u,h,m=t.d;for(l=1,o=m[0];o>=10;o/=10)l++;if(s=n-l,s<0)s+=Dn,i=n,u=m[h=0];else{if(h=Math.ceil((s+1)/Dn),o=m.length,h>=o)return t;for(u=o=m[h],l=1;o>=10;o/=10)l++;s%=Dn,i=s-Dn+l}if(r!==void 0&&(o=gd(10,l-i-1),c=u/o%10|0,d=n<0||m[h+1]!==void 0||u%o,d=r<4?(c||d)&&(r==0||r==(t.s<0?3:2)):c>5||c==5&&(r==4||d||r==6&&(s>0?i>0?u/gd(10,l-i):0:m[h-1])%10&1||r==(t.s<0?8:7))),n<1||!m[0])return d?(o=_r(t),m.length=1,n=n-o-1,m[0]=gd(10,(Dn-n%Dn)%Dn),t.e=Th(-n/Dn)||0):(m.length=1,m[0]=t.e=t.s=0),t;if(s==0?(m.length=h,o=1,h--):(m.length=h+1,o=gd(10,Dn-s),m[h]=i>0?(u/gd(10,l-i)%gd(10,i)|0)*o:0),d)for(;;)if(h==0){(m[0]+=o)==Xr&&(m[0]=1,++t.e);break}else{if(m[h]+=o,m[h]!=Xr)break;m[h--]=0,o=1}for(s=m.length;m[--s]===0;)m.pop();if(Un&&(t.e>wy||t.e<-wy))throw Error(S3+_r(t));return t}function iH(t,n){var r,s,i,o,l,c,d,u,h,m,g=t.constructor,y=g.precision;if(!t.s||!n.s)return n.s?n.s=-n.s:n=new g(t),Un?Sn(n,y):n;if(d=t.d,m=n.d,s=n.e,u=t.e,d=d.slice(),l=u-s,l){for(h=l<0,h?(r=d,l=-l,c=m.length):(r=m,s=u,c=d.length),i=Math.max(Math.ceil(y/Dn),c)+2,l>i&&(l=i,r.length=1),r.reverse(),i=l;i--;)r.push(0);r.reverse()}else{for(i=d.length,c=m.length,h=i<c,h&&(c=i),i=0;i<c;i++)if(d[i]!=m[i]){h=d[i]<m[i];break}l=0}for(h&&(r=d,d=m,m=r,n.s=-n.s),c=d.length,i=m.length-c;i>0;--i)d[c++]=0;for(i=m.length;i>l;){if(d[--i]<m[i]){for(o=i;o&&d[--o]===0;)d[o]=Xr-1;--d[o],d[i]+=Xr}d[i]-=m[i]}for(;d[--c]===0;)d.pop();for(;d[0]===0;d.shift())--s;return d[0]?(n.d=d,n.e=s,Un?Sn(n,y):n):new g(0)}function gu(t,n,r){var s,i=_r(t),o=po(t.d),l=o.length;return n?(r&&(s=r-l)>0?o=o.charAt(0)+"."+o.slice(1)+Jl(s):l>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(i<0?"e":"e+")+i):i<0?(o="0."+Jl(-i-1)+o,r&&(s=r-l)>0&&(o+=Jl(s))):i>=l?(o+=Jl(i+1-l),r&&(s=r-i-1)>0&&(o=o+"."+Jl(s))):((s=i+1)<l&&(o=o.slice(0,s)+"."+o.slice(s)),r&&(s=r-l)>0&&(i+1===l&&(o+="."),o+=Jl(s))),t.s<0?"-"+o:o}function AO(t,n){if(t.length>n)return t.length=n,!0}function oH(t){var n,r,s;function i(o){var l=this;if(!(l instanceof i))return new i(o);if(l.constructor=i,o instanceof i){l.s=o.s,l.e=o.e,l.d=(o=o.d)?o.slice():o;return}if(typeof o=="number"){if(o*0!==0)throw Error(Qd+o);if(o>0)l.s=1;else if(o<0)o=-o,l.s=-1;else{l.s=0,l.e=0,l.d=[0];return}if(o===~~o&&o<1e7){l.e=0,l.d=[o];return}return _O(l,o.toString())}else if(typeof o!="string")throw Error(Qd+o);if(o.charCodeAt(0)===45?(o=o.slice(1),l.s=-1):l.s=1,RAe.test(o))_O(l,o);else throw Error(Qd+o)}if(i.prototype=ot,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=oH,i.config=i.set=LAe,t===void 0&&(t={}),t)for(s=["precision","rounding","toExpNeg","toExpPos","LN10"],n=0;n<s.length;)t.hasOwnProperty(r=s[n++])||(t[r]=this[r]);return i.config(t),i}function LAe(t){if(!t||typeof t!="object")throw Error(xi+"Object expected");var n,r,s,i=["precision",1,kh,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(n=0;n<i.length;n+=3)if((s=t[r=i[n]])!==void 0)if(Th(s)===s&&s>=i[n+1]&&s<=i[n+2])this[r]=s;else throw Error(Qd+r+": "+s);if((s=t[r="LN10"])!==void 0)if(s==Math.LN10)this[r]=new this(s);else throw Error(Qd+r+": "+s);return this}var C3=oH(DAe);Ea=new C3(1);const un=C3;var BAe=t=>t,lH={},cH=t=>t===lH,EO=t=>function n(){return arguments.length===0||arguments.length===1&&cH(arguments.length<=0?void 0:arguments[0])?n:t(...arguments)},dH=(t,n)=>t===1?n:EO(function(){for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];var o=s.filter(l=>l!==lH).length;return o>=t?n(...s):dH(t-o,EO(function(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];var u=s.map(h=>cH(h)?c.shift():h);return n(...u,...c)}))}),jb=t=>dH(t.length,t),bC=(t,n)=>{for(var r=[],s=t;s<n;++s)r[s-t]=s;return r},FAe=jb((t,n)=>Array.isArray(n)?n.map(t):Object.keys(n).map(r=>n[r]).map(t)),$Ae=function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];if(!r.length)return BAe;var i=r.reverse(),o=i[0],l=i.slice(1);return function(){return l.reduce((c,d)=>d(c),o(...arguments))}},wC=t=>Array.isArray(t)?t.reverse():t.split("").reverse().join(""),uH=t=>{var n=null,r=null;return function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return n&&i.every((l,c)=>{var d;return l===((d=n)===null||d===void 0?void 0:d[c])})||(n=i,r=t(...i)),r}};function fH(t){var n;return t===0?n=1:n=Math.floor(new un(t).abs().log(10).toNumber())+1,n}function hH(t,n,r){for(var s=new un(t),i=0,o=[];s.lt(n)&&i<1e5;)o.push(s.toNumber()),s=s.add(r),i++;return o}jb((t,n,r)=>{var s=+t,i=+n;return s+r*(i-s)});jb((t,n,r)=>{var s=n-+t;return s=s||1/0,(r-t)/s});jb((t,n,r)=>{var s=n-+t;return s=s||1/0,Math.max(0,Math.min(1,(r-t)/s))});var mH=t=>{var[n,r]=t,[s,i]=[n,r];return n>r&&([s,i]=[r,n]),[s,i]},pH=(t,n,r)=>{if(t.lte(0))return new un(0);var s=fH(t.toNumber()),i=new un(10).pow(s),o=t.div(i),l=s!==1?.05:.1,c=new un(Math.ceil(o.div(l).toNumber())).add(r).mul(l),d=c.mul(i);return n?new un(d.toNumber()):new un(Math.ceil(d.toNumber()))},zAe=(t,n,r)=>{var s=new un(1),i=new un(t);if(!i.isint()&&r){var o=Math.abs(t);o<1?(s=new un(10).pow(fH(t)-1),i=new un(Math.floor(i.div(s).toNumber())).mul(s)):o>1&&(i=new un(Math.floor(t)))}else t===0?i=new un(Math.floor((n-1)/2)):r||(i=new un(Math.floor(t)));var l=Math.floor((n-1)/2),c=$Ae(FAe(d=>i.add(new un(d-l).mul(s)).toNumber()),bC);return c(0,n)},xH=function(n,r,s,i){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-n)/(s-1)))return{step:new un(0),tickMin:new un(0),tickMax:new un(0)};var l=pH(new un(r).sub(n).div(s-1),i,o),c;n<=0&&r>=0?c=new un(0):(c=new un(n).add(r).div(2),c=c.sub(new un(c).mod(l)));var d=Math.ceil(c.sub(n).div(l).toNumber()),u=Math.ceil(new un(r).sub(c).div(l).toNumber()),h=d+u+1;return h>s?xH(n,r,s,i,o+1):(h<s&&(u=r>0?u+(s-h):u,d=r>0?d:d+(s-h)),{step:l,tickMin:c.sub(new un(d).mul(l)),tickMax:c.add(new un(u).mul(l))})};function UAe(t){var[n,r]=t,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(s,2),[l,c]=mH([n,r]);if(l===-1/0||c===1/0){var d=c===1/0?[l,...bC(0,s-1).map(()=>1/0)]:[...bC(0,s-1).map(()=>-1/0),c];return n>r?wC(d):d}if(l===c)return zAe(l,s,i);var{step:u,tickMin:h,tickMax:m}=xH(l,c,o,i,0),g=hH(h,m.add(new un(.1).mul(u)),u);return n>r?wC(g):g}function VAe(t,n){var[r,s]=t,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,l]=mH([r,s]);if(o===-1/0||l===1/0)return[r,s];if(o===l)return[o];var c=Math.max(n,2),d=pH(new un(l).sub(o).div(c-1),i,0),u=[...hH(new un(o),new un(l),d),l];return i===!1&&(u=u.map(h=>Math.round(h))),r>s?wC(u):u}var HAe=uH(UAe),WAe=uH(VAe),gH=t=>t.rootProps.maxBarSize,qAe=t=>t.rootProps.barGap,yH=t=>t.rootProps.barCategoryGap,GAe=t=>t.rootProps.barSize,Tx=t=>t.rootProps.stackOffset,_3=t=>t.options.chartName,A3=t=>t.rootProps.syncId,vH=t=>t.rootProps.syncMethod,E3=t=>t.options.eventEmitter,Is={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Qo={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},Sa={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},Sb=(t,n)=>{if(!(!t||!n))return t!=null&&t.reversed?[n[1],n[0]]:n},KAe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Qo.angleAxisId,includeHidden:!1,name:void 0,reversed:Qo.reversed,scale:Qo.scale,tick:Qo.tick,tickCount:void 0,ticks:void 0,type:Qo.type,unit:void 0},YAe={allowDataOverflow:Sa.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Sa.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Sa.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Sa.scale,tick:Sa.tick,tickCount:Sa.tickCount,ticks:void 0,type:Sa.type,unit:void 0},XAe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Qo.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Qo.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Qo.scale,tick:Qo.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},QAe={allowDataOverflow:Sa.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Sa.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Sa.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Sa.scale,tick:Sa.tick,tickCount:Sa.tickCount,ticks:void 0,type:"category",unit:void 0},k3=(t,n)=>t.polarAxis.angleAxis[n]!=null?t.polarAxis.angleAxis[n]:t.layout.layoutType==="radial"?XAe:KAe,T3=(t,n)=>t.polarAxis.radiusAxis[n]!=null?t.polarAxis.radiusAxis[n]:t.layout.layoutType==="radial"?QAe:YAe,Cb=t=>t.polarOptions,I3=je([kl,Tl,Vr],mV),bH=je([Cb,I3],(t,n)=>{if(t!=null)return Ms(t.innerRadius,n,0)}),wH=je([Cb,I3],(t,n)=>{if(t!=null)return Ms(t.outerRadius,n,n*.8)}),ZAe=t=>{if(t==null)return[0,0];var{startAngle:n,endAngle:r}=t;return[n,r]},NH=je([Cb],ZAe);je([k3,NH],Sb);var jH=je([I3,bH,wH],(t,n,r)=>{if(!(t==null||n==null||r==null))return[n,r]});je([T3,jH],Sb);var SH=je([rn,Cb,bH,wH,kl,Tl],(t,n,r,s,i,o)=>{if(!(t!=="centric"&&t!=="radial"||n==null||r==null||s==null)){var{cx:l,cy:c,startAngle:d,endAngle:u}=n;return{cx:Ms(l,i,i/2),cy:Ms(c,o,o/2),innerRadius:r,outerRadius:s,startAngle:d,endAngle:u,clockWise:!1}}}),Hn=(t,n)=>n,Ix=(t,n,r)=>r;function P3(t){return t==null?void 0:t.id}function CH(t,n,r){var{chartData:s=[]}=n,{allowDuplicatedCategory:i,dataKey:o}=r,l=new Map;return t.forEach(c=>{var d,u=(d=c.data)!==null&&d!==void 0?d:s;if(!(u==null||u.length===0)){var h=P3(c);u.forEach((m,g)=>{var y=o==null||i?g:String(Xn(m,o,null)),N=Xn(m,c.dataKey,0),j;l.has(y)?j=l.get(y):j={},Object.assign(j,{[h]:N}),l.set(y,j)})}}),Array.from(l.values())}function _b(t){return t.stackId!=null&&t.dataKey!=null}var Ab=(t,n)=>t===n?!0:t==null||n==null?!1:t[0]===n[0]&&t[1]===n[1];function Eb(t,n){return Array.isArray(t)&&Array.isArray(n)&&t.length===0&&n.length===0?!0:t===n}function JAe(t,n){if(t.length===n.length){for(var r=0;r<t.length;r++)if(t[r]!==n[r])return!1;return!0}return!1}var Wr=t=>{var n=rn(t);return n==="horizontal"?"xAxis":n==="vertical"?"yAxis":n==="centric"?"angleAxis":"radiusAxis"},Ih=t=>t.tooltip.settings.axisId;function kO(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function Ny(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?kO(Object(r),!0).forEach(function(s){eEe(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kO(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function eEe(t,n,r){return(n=tEe(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function tEe(t){var n=nEe(t,"string");return typeof n=="symbol"?n:n+""}function nEe(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var NC=[0,"auto"],va={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},_H=(t,n)=>t.cartesianAxis.xAxis[n],Pl=(t,n)=>{var r=_H(t,n);return r??va},ba={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:NC,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Cx},AH=(t,n)=>t.cartesianAxis.yAxis[n],Ml=(t,n)=>{var r=AH(t,n);return r??ba},rEe={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},M3=(t,n)=>{var r=t.cartesianAxis.zAxis[n];return r??rEe},er=(t,n,r)=>{switch(n){case"xAxis":return Pl(t,r);case"yAxis":return Ml(t,r);case"zAxis":return M3(t,r);case"angleAxis":return k3(t,r);case"radiusAxis":return T3(t,r);default:throw new Error("Unexpected axis type: ".concat(n))}},sEe=(t,n,r)=>{switch(n){case"xAxis":return Pl(t,r);case"yAxis":return Ml(t,r);default:throw new Error("Unexpected axis type: ".concat(n))}},Px=(t,n,r)=>{switch(n){case"xAxis":return Pl(t,r);case"yAxis":return Ml(t,r);case"angleAxis":return k3(t,r);case"radiusAxis":return T3(t,r);default:throw new Error("Unexpected axis type: ".concat(n))}},EH=t=>t.graphicalItems.cartesianItems.some(n=>n.type==="bar")||t.graphicalItems.polarItems.some(n=>n.type==="radialBar");function O3(t,n){return r=>{switch(t){case"xAxis":return"xAxisId"in r&&r.xAxisId===n;case"yAxis":return"yAxisId"in r&&r.yAxisId===n;case"zAxis":return"zAxisId"in r&&r.zAxisId===n;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===n;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===n;default:return!1}}}var D3=t=>t.graphicalItems.cartesianItems,aEe=je([Hn,Ix],O3),R3=(t,n,r)=>t.filter(r).filter(s=>(n==null?void 0:n.includeHidden)===!0?!0:!s.hide),Mx=je([D3,er,aEe],R3,{memoizeOptions:{resultEqualityCheck:Eb}}),kH=je([Mx],t=>t.filter(n=>n.type==="area"||n.type==="bar").filter(_b)),TH=t=>t.filter(n=>!("stackId"in n)||n.stackId===void 0),iEe=je([Mx],TH),L3=t=>t.map(n=>n.data).filter(Boolean).flat(1),oEe=je([Mx],L3,{memoizeOptions:{resultEqualityCheck:Eb}}),B3=(t,n)=>{var{chartData:r=[],dataStartIndex:s,dataEndIndex:i}=n;return t.length>0?t:r.slice(s,i+1)},F3=je([oEe,j3],B3),$3=(t,n,r)=>(n==null?void 0:n.dataKey)!=null?t.map(s=>({value:Xn(s,n.dataKey)})):r.length>0?r.map(s=>s.dataKey).flatMap(s=>t.map(i=>({value:Xn(i,s)}))):t.map(s=>({value:s})),kb=je([F3,er,Mx],$3);function IH(t,n){switch(t){case"xAxis":return n.direction==="x";case"yAxis":return n.direction==="y";default:return!1}}function Bg(t){if(Mo(t)||t instanceof Date){var n=Number(t);if(yr(n))return n}}function TO(t){if(Array.isArray(t)){var n=[Bg(t[0]),Bg(t[1])];return xu(n)?n:void 0}var r=Bg(t);if(r!=null)return[r,r]}function Nl(t){return t.map(Bg).filter(yNe)}function lEe(t,n,r){return!r||typeof n!="number"||Po(n)?[]:r.length?Nl(r.flatMap(s=>{var i=Xn(t,s.dataKey),o,l;if(Array.isArray(i)?[o,l]=i:o=l=i,!(!yr(o)||!yr(l)))return[n-o,n+l]})):[]}var qr=t=>{var n=Wr(t),r=Ih(t);return Px(t,n,r)},PH=je([qr],t=>t==null?void 0:t.dataKey),cEe=je([kH,j3,qr],CH),MH=(t,n,r)=>{var s={},i=n.reduce((o,l)=>(l.stackId==null||(o[l.stackId]==null&&(o[l.stackId]=[]),o[l.stackId].push(l)),o),s);return Object.fromEntries(Object.entries(i).map(o=>{var[l,c]=o,d=c.map(P3);return[l,{stackedData:aje(t,d,r),graphicalItems:c}]}))},jC=je([cEe,kH,Tx],MH),OH=(t,n,r,s)=>{var{dataStartIndex:i,dataEndIndex:o}=n;if(s==null&&r!=="zAxis"){var l=dje(t,i,o);if(!(l!=null&&l[0]===0&&l[1]===0))return l}},dEe=je([er],t=>t.allowDataOverflow),z3=t=>{var n;if(t==null||!("domain"in t))return NC;if(t.domain!=null)return t.domain;if(t.ticks!=null){if(t.type==="number"){var r=Nl(t.ticks);return[Math.min(...r),Math.max(...r)]}if(t.type==="category")return t.ticks.map(String)}return(n=t==null?void 0:t.domain)!==null&&n!==void 0?n:NC},U3=je([er],z3),V3=je([U3,dEe],nH),uEe=je([jC,nd,Hn,V3],OH,{memoizeOptions:{resultEqualityCheck:Ab}}),Tb=t=>t.errorBars,fEe=(t,n,r)=>t.flatMap(s=>n[s.id]).filter(Boolean).filter(s=>IH(r,s)),jy=function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];var i=r.filter(Boolean);if(i.length!==0){var o=i.flat(),l=Math.min(...o),c=Math.max(...o);return[l,c]}},H3=(t,n,r,s,i)=>{var o,l;if(r.length>0&&t.forEach(c=>{r.forEach(d=>{var u,h,m=(u=s[d.id])===null||u===void 0?void 0:u.filter(_=>IH(i,_)),g=Xn(c,(h=n.dataKey)!==null&&h!==void 0?h:d.dataKey),y=lEe(c,g,m);if(y.length>=2){var N=Math.min(...y),j=Math.max(...y);(o==null||N<o)&&(o=N),(l==null||j>l)&&(l=j)}var S=TO(g);S!=null&&(o=o==null?S[0]:Math.min(o,S[0]),l=l==null?S[1]:Math.max(l,S[1]))})}),(n==null?void 0:n.dataKey)!=null&&t.forEach(c=>{var d=TO(Xn(c,n.dataKey));d!=null&&(o=o==null?d[0]:Math.min(o,d[0]),l=l==null?d[1]:Math.max(l,d[1]))}),yr(o)&&yr(l))return[o,l]},hEe=je([F3,er,iEe,Tb,Hn],H3,{memoizeOptions:{resultEqualityCheck:Ab}});function mEe(t){var{value:n}=t;if(Mo(n)||n instanceof Date)return n}var pEe=(t,n,r)=>{var s=t.map(mEe).filter(i=>i!=null);return r&&(n.dataKey==null||n.allowDuplicatedCategory&&Kz(s))?wV(0,t.length):n.allowDuplicatedCategory?s:Array.from(new Set(s))},DH=t=>t.referenceElements.dots,Ph=(t,n,r)=>t.filter(s=>s.ifOverflow==="extendDomain").filter(s=>n==="xAxis"?s.xAxisId===r:s.yAxisId===r),xEe=je([DH,Hn,Ix],Ph),RH=t=>t.referenceElements.areas,gEe=je([RH,Hn,Ix],Ph),LH=t=>t.referenceElements.lines,yEe=je([LH,Hn,Ix],Ph),BH=(t,n)=>{var r=Nl(t.map(s=>n==="xAxis"?s.x:s.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},vEe=je(xEe,Hn,BH),FH=(t,n)=>{var r=Nl(t.flatMap(s=>[n==="xAxis"?s.x1:s.y1,n==="xAxis"?s.x2:s.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},bEe=je([gEe,Hn],FH);function wEe(t){var n;if(t.x!=null)return Nl([t.x]);var r=(n=t.segment)===null||n===void 0?void 0:n.map(s=>s.x);return r==null||r.length===0?[]:Nl(r)}function NEe(t){var n;if(t.y!=null)return Nl([t.y]);var r=(n=t.segment)===null||n===void 0?void 0:n.map(s=>s.y);return r==null||r.length===0?[]:Nl(r)}var $H=(t,n)=>{var r=t.flatMap(s=>n==="xAxis"?wEe(s):NEe(s));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},jEe=je([yEe,Hn],$H),SEe=je(vEe,jEe,bEe,(t,n,r)=>jy(t,r,n)),W3=(t,n,r,s,i,o,l,c)=>{if(r!=null)return r;var d=l==="vertical"&&c==="xAxis"||l==="horizontal"&&c==="yAxis",u=d?jy(s,o,i):jy(o,i);return OAe(n,u,t.allowDataOverflow)},CEe=je([er,U3,V3,uEe,hEe,SEe,rn,Hn],W3,{memoizeOptions:{resultEqualityCheck:Ab}}),_Ee=[0,1],q3=(t,n,r,s,i,o,l)=>{if(!((t==null||r==null||r.length===0)&&l===void 0)){var{dataKey:c,type:d}=t,u=Tu(n,o);if(u&&c==null){var h;return wV(0,(h=r==null?void 0:r.length)!==null&&h!==void 0?h:0)}return d==="category"?pEe(s,t,u):i==="expand"?_Ee:l}},G3=je([er,rn,F3,kb,Tx,Hn,CEe],q3),zH=(t,n,r,s,i)=>{if(t!=null){var{scale:o,type:l}=t;if(o==="auto")return n==="radial"&&i==="radiusAxis"?"band":n==="radial"&&i==="angleAxis"?"linear":l==="category"&&s&&(s.indexOf("LineChart")>=0||s.indexOf("AreaChart")>=0||s.indexOf("ComposedChart")>=0&&!r)?"point":l==="category"?"band":"linear";if(typeof o=="string"){var c="scale".concat(Nx(o));return c in Im?c:"point"}}},Mh=je([er,rn,EH,_3,Hn],zH);function AEe(t){if(t!=null){if(t in Im)return Im[t]();var n="scale".concat(Nx(t));if(n in Im)return Im[n]()}}function K3(t,n,r,s){if(!(r==null||s==null)){if(typeof t.scale=="function")return t.scale.copy().domain(r).range(s);var i=AEe(n);if(i!=null){var o=i.domain(r).range(s);return eje(o),o}}}var Y3=(t,n,r)=>{var s=z3(n);if(!(r!=="auto"&&r!=="linear")){if(n!=null&&n.tickCount&&Array.isArray(s)&&(s[0]==="auto"||s[1]==="auto")&&xu(t))return HAe(t,n.tickCount,n.allowDecimals);if(n!=null&&n.tickCount&&n.type==="number"&&xu(t))return WAe(t,n.tickCount,n.allowDecimals)}},X3=je([G3,Px,Mh],Y3),Q3=(t,n,r,s)=>{if(s!=="angleAxis"&&(t==null?void 0:t.type)==="number"&&xu(n)&&Array.isArray(r)&&r.length>0){var i=n[0],o=r[0],l=n[1],c=r[r.length-1];return[Math.min(i,o),Math.max(l,c)]}return n},EEe=je([er,G3,X3,Hn],Q3),kEe=je(kb,er,(t,n)=>{if(!(!n||n.type!=="number")){var r=1/0,s=Array.from(Nl(t.map(c=>c.value))).sort((c,d)=>c-d);if(s.length<2)return 1/0;var i=s[s.length-1]-s[0];if(i===0)return 1/0;for(var o=0;o<s.length-1;o++){var l=s[o+1]-s[o];r=Math.min(r,l)}return r/i}}),UH=je(kEe,rn,yH,Vr,(t,n,r,s)=>s,(t,n,r,s,i)=>{if(!yr(t))return 0;var o=n==="vertical"?s.height:s.width;if(i==="gap")return t*o/2;if(i==="no-gap"){var l=Ms(r,t*o),c=t*o/2;return c-l-(c-l)/o*l}return 0}),TEe=(t,n)=>{var r=Pl(t,n);return r==null||typeof r.padding!="string"?0:UH(t,"xAxis",n,r.padding)},IEe=(t,n)=>{var r=Ml(t,n);return r==null||typeof r.padding!="string"?0:UH(t,"yAxis",n,r.padding)},PEe=je(Pl,TEe,(t,n)=>{var r,s;if(t==null)return{left:0,right:0};var{padding:i}=t;return typeof i=="string"?{left:n,right:n}:{left:((r=i.left)!==null&&r!==void 0?r:0)+n,right:((s=i.right)!==null&&s!==void 0?s:0)+n}}),MEe=je(Ml,IEe,(t,n)=>{var r,s;if(t==null)return{top:0,bottom:0};var{padding:i}=t;return typeof i=="string"?{top:n,bottom:n}:{top:((r=i.top)!==null&&r!==void 0?r:0)+n,bottom:((s=i.bottom)!==null&&s!==void 0?s:0)+n}}),OEe=je([Vr,PEe,ub,db,(t,n,r)=>r],(t,n,r,s,i)=>{var{padding:o}=s;return i?[o.left,r.width-o.right]:[t.left+n.left,t.left+t.width-n.right]}),DEe=je([Vr,rn,MEe,ub,db,(t,n,r)=>r],(t,n,r,s,i,o)=>{var{padding:l}=i;return o?[s.height-l.bottom,l.top]:n==="horizontal"?[t.top+t.height-r.bottom,t.top+r.top]:[t.top+r.top,t.top+t.height-r.bottom]}),Ox=(t,n,r,s)=>{var i;switch(n){case"xAxis":return OEe(t,r,s);case"yAxis":return DEe(t,r,s);case"zAxis":return(i=M3(t,r))===null||i===void 0?void 0:i.range;case"angleAxis":return NH(t);case"radiusAxis":return jH(t,r);default:return}},VH=je([er,Ox],Sb),Oh=je([er,Mh,EEe,VH],K3);je([Mx,Tb,Hn],fEe);function HH(t,n){return t.id<n.id?-1:t.id>n.id?1:0}var Ib=(t,n)=>n,Pb=(t,n,r)=>r,REe=je(lb,Ib,Pb,(t,n,r)=>t.filter(s=>s.orientation===n).filter(s=>s.mirror===r).sort(HH)),LEe=je(cb,Ib,Pb,(t,n,r)=>t.filter(s=>s.orientation===n).filter(s=>s.mirror===r).sort(HH)),WH=(t,n)=>({width:t.width,height:n.height}),BEe=(t,n)=>{var r=typeof n.width=="number"?n.width:Cx;return{width:r,height:t.height}},qH=je(Vr,Pl,WH),FEe=(t,n,r)=>{switch(n){case"top":return t.top;case"bottom":return r-t.bottom;default:return 0}},$Ee=(t,n,r)=>{switch(n){case"left":return t.left;case"right":return r-t.right;default:return 0}},zEe=je(Tl,Vr,REe,Ib,Pb,(t,n,r,s,i)=>{var o={},l;return r.forEach(c=>{var d=WH(n,c);l==null&&(l=FEe(n,s,t));var u=s==="top"&&!i||s==="bottom"&&i;o[c.id]=l-Number(u)*d.height,l+=(u?-1:1)*d.height}),o}),UEe=je(kl,Vr,LEe,Ib,Pb,(t,n,r,s,i)=>{var o={},l;return r.forEach(c=>{var d=BEe(n,c);l==null&&(l=$Ee(n,s,t));var u=s==="left"&&!i||s==="right"&&i;o[c.id]=l-Number(u)*d.width,l+=(u?-1:1)*d.width}),o}),VEe=(t,n)=>{var r=Pl(t,n);if(r!=null)return zEe(t,r.orientation,r.mirror)},HEe=je([Vr,Pl,VEe,(t,n)=>n],(t,n,r,s)=>{if(n!=null){var i=r==null?void 0:r[s];return i==null?{x:t.left,y:0}:{x:t.left,y:i}}}),WEe=(t,n)=>{var r=Ml(t,n);if(r!=null)return UEe(t,r.orientation,r.mirror)},qEe=je([Vr,Ml,WEe,(t,n)=>n],(t,n,r,s)=>{if(n!=null){var i=r==null?void 0:r[s];return i==null?{x:0,y:t.top}:{x:i,y:t.top}}}),GH=je(Vr,Ml,(t,n)=>{var r=typeof n.width=="number"?n.width:Cx;return{width:r,height:t.height}}),IO=(t,n,r)=>{switch(n){case"xAxis":return qH(t,r).width;case"yAxis":return GH(t,r).height;default:return}},KH=(t,n,r,s)=>{if(r!=null){var{allowDuplicatedCategory:i,type:o,dataKey:l}=r,c=Tu(t,s),d=n.map(u=>u.value);if(l&&c&&o==="category"&&i&&Kz(d))return d}},Z3=je([rn,kb,er,Hn],KH),YH=(t,n,r,s)=>{if(!(r==null||r.dataKey==null)){var{type:i,scale:o}=r,l=Tu(t,s);if(l&&(i==="number"||o!=="auto"))return n.map(c=>c.value)}},J3=je([rn,kb,Px,Hn],YH);je([rn,sEe,Mh,Oh,Z3,J3,Ox,X3,Hn],(t,n,r,s,i,o,l,c,d)=>{if(n!=null){var u=Tu(t,d);return{angle:n.angle,interval:n.interval,minTickGap:n.minTickGap,orientation:n.orientation,tick:n.tick,tickCount:n.tickCount,tickFormatter:n.tickFormatter,ticks:n.ticks,type:n.type,unit:n.unit,axisType:d,categoricalDomain:o,duplicateDomain:i,isCategorical:u,niceTicks:c,range:l,realScaleType:r,scale:s}}});var GEe=(t,n,r,s,i,o,l,c,d)=>{if(!(n==null||s==null)){var u=Tu(t,d),{type:h,ticks:m,tickCount:g}=n,y=r==="scaleBand"&&typeof s.bandwidth=="function"?s.bandwidth()/2:2,N=h==="category"&&s.bandwidth?s.bandwidth()/y:0;N=d==="angleAxis"&&o!=null&&o.length>=2?ps(o[0]-o[1])*2*N:N;var j=m||i;if(j){var S=j.map((_,A)=>{var k=l?l.indexOf(_):_;return{index:A,coordinate:s(k)+N,value:_,offset:N}});return S.filter(_=>yr(_.coordinate))}return u&&c?c.map((_,A)=>({coordinate:s(_)+N,value:_,index:A,offset:N})).filter(_=>yr(_.coordinate)):s.ticks?s.ticks(g).map(_=>({coordinate:s(_)+N,value:_,offset:N})):s.domain().map((_,A)=>({coordinate:s(_)+N,value:l?l[_]:_,index:A,offset:N}))}},XH=je([rn,Px,Mh,Oh,X3,Ox,Z3,J3,Hn],GEe),KEe=(t,n,r,s,i,o,l)=>{if(!(n==null||r==null||s==null||s[0]===s[1])){var c=Tu(t,l),{tickCount:d}=n,u=0;return u=l==="angleAxis"&&(s==null?void 0:s.length)>=2?ps(s[0]-s[1])*2*u:u,c&&o?o.map((h,m)=>({coordinate:r(h)+u,value:h,index:m,offset:u})):r.ticks?r.ticks(d).map(h=>({coordinate:r(h)+u,value:h,offset:u})):r.domain().map((h,m)=>({coordinate:r(h)+u,value:i?i[h]:h,index:m,offset:u}))}},ih=je([rn,Px,Oh,Ox,Z3,J3,Hn],KEe),oh=je(er,Oh,(t,n)=>{if(!(t==null||n==null))return Ny(Ny({},t),{},{scale:n})}),YEe=je([er,Mh,G3,VH],K3);je((t,n,r)=>M3(t,r),YEe,(t,n)=>{if(!(t==null||n==null))return Ny(Ny({},t),{},{scale:n})});var XEe=je([rn,lb,cb],(t,n,r)=>{switch(t){case"horizontal":return n.some(s=>s.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(s=>s.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),QH=t=>t.options.defaultTooltipEventType,ZH=t=>t.options.validateTooltipEventTypes;function JH(t,n,r){if(t==null)return n;var s=t?"axis":"item";return r==null?n:r.includes(s)?s:n}function ek(t,n){var r=QH(t),s=ZH(t);return JH(n,r,s)}function QEe(t){return mt(n=>ek(n,t))}var eW=(t,n)=>{var r,s=Number(n);if(!(Po(s)||n==null))return s>=0?t==null||(r=t[s])===null||r===void 0?void 0:r.value:void 0},ZEe=t=>t.tooltip.settings,sc={active:!1,index:null,dataKey:void 0,coordinate:void 0},JEe={itemInteraction:{click:sc,hover:sc},axisInteraction:{click:sc,hover:sc},keyboardInteraction:sc,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},tW=ga({name:"tooltip",initialState:JEe,reducers:{addTooltipEntrySettings:{reducer(t,n){t.tooltipItemPayloads.push(n.payload)},prepare:Fr()},removeTooltipEntrySettings:{reducer(t,n){var r=il(t).tooltipItemPayloads.indexOf(n.payload);r>-1&&t.tooltipItemPayloads.splice(r,1)},prepare:Fr()},setTooltipSettingsState(t,n){t.settings=n.payload},setActiveMouseOverItemIndex(t,n){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=n.payload.activeIndex,t.itemInteraction.hover.dataKey=n.payload.activeDataKey,t.itemInteraction.hover.coordinate=n.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,n){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=n.payload.activeIndex,t.itemInteraction.click.dataKey=n.payload.activeDataKey,t.itemInteraction.click.coordinate=n.payload.activeCoordinate},setMouseOverAxisIndex(t,n){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=n.payload.activeIndex,t.axisInteraction.hover.dataKey=n.payload.activeDataKey,t.axisInteraction.hover.coordinate=n.payload.activeCoordinate},setMouseClickAxisIndex(t,n){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=n.payload.activeIndex,t.axisInteraction.click.dataKey=n.payload.activeDataKey,t.axisInteraction.click.coordinate=n.payload.activeCoordinate},setSyncInteraction(t,n){t.syncInteraction=n.payload},setKeyboardInteraction(t,n){t.keyboardInteraction.active=n.payload.active,t.keyboardInteraction.index=n.payload.activeIndex,t.keyboardInteraction.coordinate=n.payload.activeCoordinate,t.keyboardInteraction.dataKey=n.payload.activeDataKey}}}),{addTooltipEntrySettings:e3e,removeTooltipEntrySettings:t3e,setTooltipSettingsState:n3e,setActiveMouseOverItemIndex:nW,mouseLeaveItem:r3e,mouseLeaveChart:rW,setActiveClickItemIndex:s3e,setMouseOverAxisIndex:sW,setMouseClickAxisIndex:a3e,setSyncInteraction:SC,setKeyboardInteraction:CC}=tW.actions,i3e=tW.reducer;function PO(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function J0(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?PO(Object(r),!0).forEach(function(s){o3e(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):PO(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function o3e(t,n,r){return(n=l3e(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function l3e(t){var n=c3e(t,"string");return typeof n=="symbol"?n:n+""}function c3e(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function d3e(t,n,r){return n==="axis"?r==="click"?t.axisInteraction.click:t.axisInteraction.hover:r==="click"?t.itemInteraction.click:t.itemInteraction.hover}function u3e(t){return t.index!=null}var aW=(t,n,r,s)=>{if(n==null)return sc;var i=d3e(t,n,r);if(i==null)return sc;if(i.active)return i;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var o=t.settings.active===!0;if(u3e(i)){if(o)return J0(J0({},i),{},{active:!0})}else if(s!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:s};return J0(J0({},sc),{},{coordinate:i.coordinate})},tk=(t,n)=>{var r=t==null?void 0:t.index;if(r==null)return null;var s=Number(r);if(!yr(s))return r;var i=0,o=1/0;return n.length>0&&(o=n.length-1),String(Math.max(i,Math.min(s,o)))},iW=(t,n,r,s,i,o,l,c)=>{if(!(o==null||c==null)){var d=l[0],u=d==null?void 0:c(d.positions,o);if(u!=null)return u;var h=i==null?void 0:i[Number(o)];if(h)switch(r){case"horizontal":return{x:h.coordinate,y:(s.top+n)/2};default:return{x:(s.left+t)/2,y:h.coordinate}}}},oW=(t,n,r,s)=>{if(n==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var i;return r==="hover"?i=t.itemInteraction.hover.dataKey:i=t.itemInteraction.click.dataKey,i==null&&s!=null?[t.tooltipItemPayloads[0]]:t.tooltipItemPayloads.filter(o=>{var l;return((l=o.settings)===null||l===void 0?void 0:l.dataKey)===i})},Dx=t=>t.options.tooltipPayloadSearcher,Dh=t=>t.tooltip;function MO(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function OO(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?MO(Object(r),!0).forEach(function(s){f3e(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):MO(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function f3e(t,n,r){return(n=h3e(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function h3e(t){var n=m3e(t,"string");return typeof n=="symbol"?n:n+""}function m3e(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function p3e(t,n){return t??n}var lW=(t,n,r,s,i,o,l)=>{if(!(n==null||o==null)){var{chartData:c,computedData:d,dataStartIndex:u,dataEndIndex:h}=r,m=[];return t.reduce((g,y)=>{var N,{dataDefinedOnItem:j,settings:S}=y,_=p3e(j,c),A=Array.isArray(_)?KU(_,u,h):_,k=(N=S==null?void 0:S.dataKey)!==null&&N!==void 0?N:s,T=S==null?void 0:S.nameKey,P;if(s&&Array.isArray(A)&&!Array.isArray(A[0])&&l==="axis"?P=gNe(A,s,i):P=o(A,n,d,T),Array.isArray(P))P.forEach(O=>{var D=OO(OO({},S),{},{name:O.name,unit:O.unit,color:void 0,fill:void 0});g.push(x4({tooltipEntrySettings:D,dataKey:O.dataKey,payload:O.payload,value:Xn(O.payload,O.dataKey),name:O.name}))});else{var M;g.push(x4({tooltipEntrySettings:S,dataKey:k,payload:P,value:Xn(P,k),name:(M=Xn(P,T))!==null&&M!==void 0?M:S==null?void 0:S.name}))}return g},m)}},nk=je([qr,rn,EH,_3,Wr],zH),x3e=je([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,n)=>[...t,...n]),g3e=je([Wr,Ih],O3),Rx=je([x3e,qr,g3e],R3,{memoizeOptions:{resultEqualityCheck:Eb}}),y3e=je([Rx],t=>t.filter(_b)),v3e=je([Rx],L3,{memoizeOptions:{resultEqualityCheck:Eb}}),Rh=je([v3e,nd],B3),b3e=je([y3e,nd,qr],CH),rk=je([Rh,qr,Rx],$3),cW=je([qr],z3),w3e=je([qr],t=>t.allowDataOverflow),dW=je([cW,w3e],nH),N3e=je([Rx],t=>t.filter(_b)),j3e=je([b3e,N3e,Tx],MH),S3e=je([j3e,nd,Wr,dW],OH),C3e=je([Rx],TH),_3e=je([Rh,qr,C3e,Tb,Wr],H3,{memoizeOptions:{resultEqualityCheck:Ab}}),A3e=je([DH,Wr,Ih],Ph),E3e=je([A3e,Wr],BH),k3e=je([RH,Wr,Ih],Ph),T3e=je([k3e,Wr],FH),I3e=je([LH,Wr,Ih],Ph),P3e=je([I3e,Wr],$H),M3e=je([E3e,P3e,T3e],jy),O3e=je([qr,cW,dW,S3e,_3e,M3e,rn,Wr],W3),uW=je([qr,rn,Rh,rk,Tx,Wr,O3e],q3),D3e=je([uW,qr,nk],Y3),R3e=je([qr,uW,D3e,Wr],Q3),fW=t=>{var n=Wr(t),r=Ih(t),s=!1;return Ox(t,n,r,s)},hW=je([qr,fW],Sb),mW=je([qr,nk,R3e,hW],K3),L3e=je([rn,rk,qr,Wr],KH),B3e=je([rn,rk,qr,Wr],YH),F3e=(t,n,r,s,i,o,l,c)=>{if(n){var{type:d}=n,u=Tu(t,c);if(s){var h=r==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,m=d==="category"&&s.bandwidth?s.bandwidth()/h:0;return m=c==="angleAxis"&&i!=null&&(i==null?void 0:i.length)>=2?ps(i[0]-i[1])*2*m:m,u&&l?l.map((g,y)=>({coordinate:s(g)+m,value:g,index:y,offset:m})):s.domain().map((g,y)=>({coordinate:s(g)+m,value:o?o[g]:g,index:y,offset:m}))}}},Ol=je([rn,qr,nk,mW,fW,L3e,B3e,Wr],F3e),sk=je([QH,ZH,ZEe],(t,n,r)=>JH(r.shared,t,n)),pW=t=>t.tooltip.settings.trigger,ak=t=>t.tooltip.settings.defaultIndex,Mb=je([Dh,sk,pW,ak],aW),yu=je([Mb,Rh],tk),xW=je([Ol,yu],eW),gW=je([Mb],t=>{if(t)return t.dataKey}),yW=je([Dh,sk,pW,ak],oW),$3e=je([kl,Tl,rn,Vr,Ol,ak,yW,Dx],iW),z3e=je([Mb,$3e],(t,n)=>t!=null&&t.coordinate?t.coordinate:n),U3e=je([Mb],t=>t.active),V3e=je([yW,yu,nd,PH,xW,Dx,sk],lW);je([V3e],t=>{if(t!=null){var n=t.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(n))}});function DO(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function RO(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?DO(Object(r),!0).forEach(function(s){H3e(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):DO(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function H3e(t,n,r){return(n=W3e(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function W3e(t){var n=q3e(t,"string");return typeof n=="symbol"?n:n+""}function q3e(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var G3e=()=>mt(qr),K3e=()=>{var t=G3e(),n=mt(Ol),r=mt(mW);return iy(!t||!r?void 0:RO(RO({},t),{},{scale:r}),n)};function LO(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function Gu(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?LO(Object(r),!0).forEach(function(s){Y3e(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):LO(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Y3e(t,n,r){return(n=X3e(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function X3e(t){var n=Q3e(t,"string");return typeof n=="symbol"?n:n+""}function Q3e(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var Z3e=(t,n,r,s)=>{var i=n.find(o=>o&&o.index===r);if(i){if(t==="horizontal")return{x:i.coordinate,y:s.chartY};if(t==="vertical")return{x:s.chartX,y:i.coordinate}}return{x:0,y:0}},J3e=(t,n,r,s)=>{var i=n.find(u=>u&&u.index===r);if(i){if(t==="centric"){var o=i.coordinate,{radius:l}=s;return Gu(Gu(Gu({},s),Sr(s.cx,s.cy,l,o)),{},{angle:o,radius:l})}var c=i.coordinate,{angle:d}=s;return Gu(Gu(Gu({},s),Sr(s.cx,s.cy,c,d)),{},{angle:d,radius:c})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function eke(t,n){var{chartX:r,chartY:s}=t;return r>=n.left&&r<=n.left+n.width&&s>=n.top&&s<=n.top+n.height}var vW=(t,n,r,s,i)=>{var o,l=-1,c=(o=n==null?void 0:n.length)!==null&&o!==void 0?o:0;if(c<=1||t==null)return 0;if(s==="angleAxis"&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var d=0;d<c;d++){var u=d>0?r[d-1].coordinate:r[c-1].coordinate,h=r[d].coordinate,m=d>=c-1?r[0].coordinate:r[d+1].coordinate,g=void 0;if(ps(h-u)!==ps(m-h)){var y=[];if(ps(m-h)===ps(i[1]-i[0])){g=m;var N=h+i[1]-i[0];y[0]=Math.min(N,(N+u)/2),y[1]=Math.max(N,(N+u)/2)}else{g=u;var j=m+i[1]-i[0];y[0]=Math.min(h,(j+h)/2),y[1]=Math.max(h,(j+h)/2)}var S=[Math.min(h,(g+h)/2),Math.max(h,(g+h)/2)];if(t>S[0]&&t<=S[1]||t>=y[0]&&t<=y[1]){({index:l}=r[d]);break}}else{var _=Math.min(u,m),A=Math.max(u,m);if(t>(_+h)/2&&t<=(A+h)/2){({index:l}=r[d]);break}}}else if(n){for(var k=0;k<c;k++)if(k===0&&t<=(n[k].coordinate+n[k+1].coordinate)/2||k>0&&k<c-1&&t>(n[k].coordinate+n[k-1].coordinate)/2&&t<=(n[k].coordinate+n[k+1].coordinate)/2||k===c-1&&t>(n[k].coordinate+n[k-1].coordinate)/2){({index:l}=n[k]);break}}return l},tke=()=>mt(_3),ik=(t,n)=>n,bW=(t,n,r)=>r,ok=(t,n,r,s)=>s,nke=je(Ol,t=>tb(t,n=>n.coordinate)),lk=je([Dh,ik,bW,ok],aW),wW=je([lk,Rh],tk),rke=(t,n,r)=>{if(n!=null){var s=Dh(t);return n==="axis"?r==="hover"?s.axisInteraction.hover.dataKey:s.axisInteraction.click.dataKey:r==="hover"?s.itemInteraction.hover.dataKey:s.itemInteraction.click.dataKey}},NW=je([Dh,ik,bW,ok],oW),Sy=je([kl,Tl,rn,Vr,Ol,ok,NW,Dx],iW),ske=je([lk,Sy],(t,n)=>{var r;return(r=t.coordinate)!==null&&r!==void 0?r:n}),jW=je([Ol,wW],eW),ake=je([NW,wW,nd,PH,jW,Dx,ik],lW),ike=je([lk],t=>({isActive:t.active,activeIndex:t.index})),oke=(t,n,r,s,i,o,l)=>{if(!(!t||!r||!s||!i)&&eke(t,l)){var c=uje(t,n),d=vW(c,o,i,r,s),u=Z3e(n,i,d,t);return{activeIndex:String(d),activeCoordinate:u}}},lke=(t,n,r,s,i,o,l)=>{if(!(!t||!s||!i||!o||!r)){var c=eCe(t,r);if(c){var d=fje(c,n),u=vW(d,l,o,s,i),h=J3e(n,o,u,c);return{activeIndex:String(u),activeCoordinate:h}}}},cke=(t,n,r,s,i,o,l,c)=>{if(!(!t||!n||!s||!i||!o))return n==="horizontal"||n==="vertical"?oke(t,n,s,i,o,l,c):lke(t,n,r,s,i,o,l)},dke=je(t=>t.zIndex.zIndexMap,(t,n)=>n,(t,n,r)=>r,(t,n,r)=>{if(n!=null){var s=t[n];if(s!=null)return r?s.panoramaElementId:s.elementId}}),uke=je(t=>t.zIndex.zIndexMap,t=>{var n=Object.keys(t).map(s=>parseInt(s,10)).concat(Object.values(Is)),r=Array.from(new Set(n));return r.sort((s,i)=>s-i)},{memoizeOptions:{resultEqualityCheck:JAe}});function BO(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function FO(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?BO(Object(r),!0).forEach(function(s){fke(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):BO(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function fke(t,n,r){return(n=hke(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function hke(t){var n=mke(t,"string");return typeof n=="symbol"?n:n+""}function mke(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var pke={},xke={zIndexMap:Object.values(Is).reduce((t,n)=>FO(FO({},t),{},{[n]:{elementId:void 0,panoramaElementId:void 0,consumers:0}}),pke)},gke=new Set(Object.values(Is));function yke(t){return gke.has(t)}var SW=ga({name:"zIndex",initialState:xke,reducers:{registerZIndexPortal:{reducer:(t,n)=>{var{zIndex:r}=n.payload;t.zIndexMap[r]?t.zIndexMap[r].consumers+=1:t.zIndexMap[r]={consumers:1,elementId:void 0,panoramaElementId:void 0}},prepare:Fr()},unregisterZIndexPortal:{reducer:(t,n)=>{var{zIndex:r}=n.payload;t.zIndexMap[r]&&(t.zIndexMap[r].consumers-=1,t.zIndexMap[r].consumers<=0&&!yke(r)&&delete t.zIndexMap[r])},prepare:Fr()},registerZIndexPortalId:{reducer:(t,n)=>{var{zIndex:r,elementId:s,isPanorama:i}=n.payload;t.zIndexMap[r]?i?t.zIndexMap[r].panoramaElementId=s:t.zIndexMap[r].elementId=s:t.zIndexMap[r]={consumers:0,elementId:i?void 0:s,panoramaElementId:i?s:void 0}},prepare:Fr()},unregisterZIndexPortalId:{reducer:(t,n)=>{var{zIndex:r}=n.payload;t.zIndexMap[r]&&(n.payload.isPanorama?t.zIndexMap[r].panoramaElementId=void 0:t.zIndexMap[r].elementId=void 0)},prepare:Fr()}}}),{registerZIndexPortal:vke,unregisterZIndexPortal:bke,registerZIndexPortalId:wke,unregisterZIndexPortalId:Nke}=SW.actions,jke=SW.reducer;function Fo(t){var{zIndex:n,children:r}=t,s=zje(),i=s&&n!==void 0&&n!==0,o=Ua(),l=Vn();b.useLayoutEffect(()=>i?(l(vke({zIndex:n})),()=>{l(bke({zIndex:n}))}):ku,[l,n,i]);var c=mt(u=>dke(u,n,o));if(!i)return r;if(!c)return null;var d=document.getElementById(c);return d?Vc.createPortal(r,d):null}function _C(){return _C=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},_C.apply(null,arguments)}function $O(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function eg(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?$O(Object(r),!0).forEach(function(s){Ske(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$O(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Ske(t,n,r){return(n=Cke(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function Cke(t){var n=_ke(t,"string");return typeof n=="symbol"?n:n+""}function _ke(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function Ake(t){var{cursor:n,cursorComp:r,cursorProps:s}=t;return b.isValidElement(n)?b.cloneElement(n,s):b.createElement(r,s)}function Eke(t){var n,{coordinate:r,payload:s,index:i,offset:o,tooltipAxisBandSize:l,layout:c,cursor:d,tooltipEventType:u,chartName:h}=t,m=r,g=s,y=i;if(!d||!m||h!=="ScatterChart"&&u!=="axis")return null;var N,j,S;if(h==="ScatterChart")N=m,j=xSe,S=Is.cursorLine;else if(h==="BarChart")N=gSe(c,m,o,l),j=hV,S=Is.cursorRectangle;else if(c==="radial"&&Qz(m)){var{cx:_,cy:A,radius:k,startAngle:T,endAngle:P}=pV(m);N={cx:_,cy:A,startAngle:T,endAngle:P,innerRadius:k,outerRadius:k},j=gV,S=Is.cursorLine}else N={points:sCe(c,m,o)},j=ZE,S=Is.cursorLine;var M=typeof d=="object"&&"className"in d?d.className:void 0,O=eg(eg(eg(eg({stroke:"#ccc",pointerEvents:"none"},o),N),zp(d)),{},{payload:g,payloadIndex:y,className:cn("recharts-tooltip-cursor",M)});return b.createElement(Fo,{zIndex:(n=t.zIndex)!==null&&n!==void 0?n:S},b.createElement(Ake,{cursor:d,cursorComp:j,cursorProps:O}))}function kke(t){var n=K3e(),r=Bje(),s=hb(),i=tke();return n==null||r==null||s==null||i==null?null:b.createElement(Eke,_C({},t,{offset:r,layout:s,tooltipAxisBandSize:n,chartName:i}))}var CW=b.createContext(null),Tke=()=>b.useContext(CW),_W={exports:{}};(function(t){var n=Object.prototype.hasOwnProperty,r="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(r=!1));function i(d,u,h){this.fn=d,this.context=u,this.once=h||!1}function o(d,u,h,m,g){if(typeof h!="function")throw new TypeError("The listener must be a function");var y=new i(h,m||d,g),N=r?r+u:u;return d._events[N]?d._events[N].fn?d._events[N]=[d._events[N],y]:d._events[N].push(y):(d._events[N]=y,d._eventsCount++),d}function l(d,u){--d._eventsCount===0?d._events=new s:delete d._events[u]}function c(){this._events=new s,this._eventsCount=0}c.prototype.eventNames=function(){var u=[],h,m;if(this._eventsCount===0)return u;for(m in h=this._events)n.call(h,m)&&u.push(r?m.slice(1):m);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(h)):u},c.prototype.listeners=function(u){var h=r?r+u:u,m=this._events[h];if(!m)return[];if(m.fn)return[m.fn];for(var g=0,y=m.length,N=new Array(y);g<y;g++)N[g]=m[g].fn;return N},c.prototype.listenerCount=function(u){var h=r?r+u:u,m=this._events[h];return m?m.fn?1:m.length:0},c.prototype.emit=function(u,h,m,g,y,N){var j=r?r+u:u;if(!this._events[j])return!1;var S=this._events[j],_=arguments.length,A,k;if(S.fn){switch(S.once&&this.removeListener(u,S.fn,void 0,!0),_){case 1:return S.fn.call(S.context),!0;case 2:return S.fn.call(S.context,h),!0;case 3:return S.fn.call(S.context,h,m),!0;case 4:return S.fn.call(S.context,h,m,g),!0;case 5:return S.fn.call(S.context,h,m,g,y),!0;case 6:return S.fn.call(S.context,h,m,g,y,N),!0}for(k=1,A=new Array(_-1);k<_;k++)A[k-1]=arguments[k];S.fn.apply(S.context,A)}else{var T=S.length,P;for(k=0;k<T;k++)switch(S[k].once&&this.removeListener(u,S[k].fn,void 0,!0),_){case 1:S[k].fn.call(S[k].context);break;case 2:S[k].fn.call(S[k].context,h);break;case 3:S[k].fn.call(S[k].context,h,m);break;case 4:S[k].fn.call(S[k].context,h,m,g);break;default:if(!A)for(P=1,A=new Array(_-1);P<_;P++)A[P-1]=arguments[P];S[k].fn.apply(S[k].context,A)}}return!0},c.prototype.on=function(u,h,m){return o(this,u,h,m,!1)},c.prototype.once=function(u,h,m){return o(this,u,h,m,!0)},c.prototype.removeListener=function(u,h,m,g){var y=r?r+u:u;if(!this._events[y])return this;if(!h)return l(this,y),this;var N=this._events[y];if(N.fn)N.fn===h&&(!g||N.once)&&(!m||N.context===m)&&l(this,y);else{for(var j=0,S=[],_=N.length;j<_;j++)(N[j].fn!==h||g&&!N[j].once||m&&N[j].context!==m)&&S.push(N[j]);S.length?this._events[y]=S.length===1?S[0]:S:l(this,y)}return this},c.prototype.removeAllListeners=function(u){var h;return u?(h=r?r+u:u,this._events[h]&&l(this,h)):(this._events=new s,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=r,c.EventEmitter=c,t.exports=c})(_W);var Ike=_W.exports;const Pke=gi(Ike);var Zp=new Pke,AC="recharts.syncEvent.tooltip",zO="recharts.syncEvent.brush";function AW(t,n){if(n){var r=Number.parseInt(n,10);if(!Po(r))return t==null?void 0:t[r]}}var Mke={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},EW=ga({name:"options",initialState:Mke,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),Oke=EW.reducer,{createEventEmitter:Dke}=EW.actions;function Rke(t){return t.tooltip.syncInteraction}var Lke={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},kW=ga({name:"chartData",initialState:Lke,reducers:{setChartData(t,n){if(t.chartData=n.payload,n.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}n.payload.length>0&&t.dataEndIndex!==n.payload.length-1&&(t.dataEndIndex=n.payload.length-1)},setComputedData(t,n){t.computedData=n.payload},setDataStartEndIndexes(t,n){var{startIndex:r,endIndex:s}=n.payload;r!=null&&(t.dataStartIndex=r),s!=null&&(t.dataEndIndex=s)}}}),{setChartData:UO,setDataStartEndIndexes:Bke,setComputedData:G8e}=kW.actions,Fke=kW.reducer,$ke=["x","y"];function VO(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function Ku(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?VO(Object(r),!0).forEach(function(s){zke(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):VO(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function zke(t,n,r){return(n=Uke(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function Uke(t){var n=Vke(t,"string");return typeof n=="symbol"?n:n+""}function Vke(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function Hke(t,n){if(t==null)return{};var r,s,i=Wke(t,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],n.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function Wke(t,n){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(n.indexOf(s)!==-1)continue;r[s]=t[s]}return r}function qke(){var t=mt(A3),n=mt(E3),r=Vn(),s=mt(vH),i=mt(Ol),o=hb(),l=fb(),c=mt(d=>d.rootProps.className);b.useEffect(()=>{if(t==null)return ku;var d=(u,h,m)=>{if(n!==m&&t===u){if(s==="index"){var g;if(l&&h!==null&&h!==void 0&&(g=h.payload)!==null&&g!==void 0&&g.coordinate&&h.payload.sourceViewBox){var y=h.payload.coordinate,{x:N,y:j}=y,S=Hke(y,$ke),{x:_,y:A,width:k,height:T}=h.payload.sourceViewBox,P=Ku(Ku({},S),{},{x:l.x+(k?(N-_)/k:0)*l.width,y:l.y+(T?(j-A)/T:0)*l.height});r(Ku(Ku({},h),{},{payload:Ku(Ku({},h.payload),{},{coordinate:P})}))}else r(h);return}if(i!=null){var M;if(typeof s=="function"){var O={activeTooltipIndex:h.payload.index==null?void 0:Number(h.payload.index),isTooltipActive:h.payload.active,activeIndex:h.payload.index==null?void 0:Number(h.payload.index),activeLabel:h.payload.label,activeDataKey:h.payload.dataKey,activeCoordinate:h.payload.coordinate},D=s(i,O);M=i[D]}else s==="value"&&(M=i.find(q=>String(q.value)===h.payload.label));var{coordinate:L}=h.payload;if(M==null||h.payload.active===!1||L==null||l==null){r(SC({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0}));return}var{x:$,y:V}=L,F=Math.min($,l.x+l.width),Q=Math.min(V,l.y+l.height),U={x:o==="horizontal"?M.coordinate:F,y:o==="horizontal"?Q:M.coordinate},z=SC({active:h.payload.active,coordinate:U,dataKey:h.payload.dataKey,index:String(M.index),label:h.payload.label,sourceViewBox:h.payload.sourceViewBox});r(z)}}};return Zp.on(AC,d),()=>{Zp.off(AC,d)}},[c,r,n,t,s,i,o,l])}function Gke(){var t=mt(A3),n=mt(E3),r=Vn();b.useEffect(()=>{if(t==null)return ku;var s=(i,o,l)=>{n!==l&&t===i&&r(Bke(o))};return Zp.on(zO,s),()=>{Zp.off(zO,s)}},[r,n,t])}function Kke(){var t=Vn();b.useEffect(()=>{t(Dke())},[t]),qke(),Gke()}function Yke(t,n,r,s,i,o){var l=mt(y=>rke(y,t,n)),c=mt(E3),d=mt(A3),u=mt(vH),h=mt(Rke),m=h==null?void 0:h.active,g=fb();b.useEffect(()=>{if(!m&&d!=null&&c!=null){var y=SC({active:o,coordinate:r,dataKey:l,index:i,label:typeof s=="number"?String(s):s,sourceViewBox:g});Zp.emit(AC,d,y,c)}},[m,r,l,i,s,c,d,u,o,g])}function HO(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function WO(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?HO(Object(r),!0).forEach(function(s){Xke(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):HO(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Xke(t,n,r){return(n=Qke(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function Qke(t){var n=Zke(t,"string");return typeof n=="symbol"?n:n+""}function Zke(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function Jke(t){return t.dataKey}function eTe(t,n){return b.isValidElement(t)?b.cloneElement(t,n):typeof t=="function"?b.createElement(t,n):b.createElement(Kje,n)}var qO=[],tTe={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Iu.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Dd(t){var n,r,s=Xs(t,tTe),{active:i,allowEscapeViewBox:o,animationDuration:l,animationEasing:c,content:d,filterNull:u,isAnimationActive:h,offset:m,payloadUniqBy:g,position:y,reverseDirection:N,useTranslate3d:j,wrapperStyle:S,cursor:_,shared:A,trigger:k,defaultIndex:T,portal:P,axisId:M}=s,O=Vn(),D=typeof T=="number"?String(T):T;b.useEffect(()=>{O(n3e({shared:A,trigger:k,axisId:M,active:i,defaultIndex:D}))},[O,A,k,M,i,D]);var L=fb(),$=lV(),V=QEe(A),{activeIndex:F,isActive:Q}=(n=mt(we=>ike(we,V,k,D)))!==null&&n!==void 0?n:{},U=mt(we=>ake(we,V,k,D)),z=mt(we=>jW(we,V,k,D)),q=mt(we=>ske(we,V,k,D)),K=U,X=Tke(),J=(r=i??Q)!==null&&r!==void 0?r:!1,[ne,Se]=JNe([K,J]),de=V==="axis"?z:void 0;Yke(V,k,q,de,F,J);var ye=P??X;if(ye==null||L==null||V==null)return null;var be=K??qO;J||(be=qO),u&&be.length&&(be=RNe(be.filter(we=>we.value!=null&&(we.hide!==!0||s.includeHidden)),g,Jke));var xe=be.length>0,_e=b.createElement(tSe,{allowEscapeViewBox:o,animationDuration:l,animationEasing:c,isAnimationActive:h,active:J,coordinate:q,hasPayload:xe,offset:m,position:y,reverseDirection:N,useTranslate3d:j,viewBox:L,wrapperStyle:S,lastBoundingBox:ne,innerRef:Se,hasPortalFromProps:!!P},eTe(d,WO(WO({},s),{},{payload:be,label:de,active:J,activeIndex:F,coordinate:q,accessibilityLayer:$})));return b.createElement(b.Fragment,null,Vc.createPortal(_e,ye),J&&b.createElement(kke,{cursor:_,tooltipEventType:V,coordinate:q,payload:be,index:F}))}var xo=t=>null;xo.displayName="Cell";function nTe(t,n,r){return(n=rTe(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function rTe(t){var n=sTe(t,"string");return typeof n=="symbol"?n:n+""}function sTe(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}class aTe{constructor(n){nTe(this,"cache",new Map),this.maxSize=n}get(n){var r=this.cache.get(n);return r!==void 0&&(this.cache.delete(n),this.cache.set(n,r)),r}set(n,r){if(this.cache.has(n))this.cache.delete(n);else if(this.cache.size>=this.maxSize){var s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(n,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function GO(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function iTe(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?GO(Object(r),!0).forEach(function(s){oTe(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):GO(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function oTe(t,n,r){return(n=lTe(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function lTe(t){var n=cTe(t,"string");return typeof n=="symbol"?n:n+""}function cTe(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var dTe={cacheSize:2e3,enableCache:!0},TW=iTe({},dTe),KO=new aTe(TW.cacheSize),uTe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},YO="recharts_measurement_span";function fTe(t,n){var r=n.fontSize||"",s=n.fontFamily||"",i=n.fontWeight||"",o=n.fontStyle||"",l=n.letterSpacing||"",c=n.textTransform||"";return"".concat(t,"|").concat(r,"|").concat(s,"|").concat(i,"|").concat(o,"|").concat(l,"|").concat(c)}var XO=(t,n)=>{try{var r=document.getElementById(YO);r||(r=document.createElement("span"),r.setAttribute("id",YO),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,uTe,n),r.textContent="".concat(t);var s=r.getBoundingClientRect();return{width:s.width,height:s.height}}catch{return{width:0,height:0}}},Zm=function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(n==null||Iu.isSsr)return{width:0,height:0};if(!TW.enableCache)return XO(n,r);var s=fTe(n,r),i=KO.get(s);if(i)return i;var o=XO(n,r);return KO.set(s,o),o},QO=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,ZO=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,hTe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,mTe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,IW={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},pTe=Object.keys(IW),bf="NaN";function xTe(t,n){return t*IW[n]}class ta{static parse(n){var r,[,s,i]=(r=mTe.exec(n))!==null&&r!==void 0?r:[];return new ta(parseFloat(s),i??"")}constructor(n,r){this.num=n,this.unit=r,this.num=n,this.unit=r,Po(n)&&(this.unit=""),r!==""&&!hTe.test(r)&&(this.num=NaN,this.unit=""),pTe.includes(r)&&(this.num=xTe(n,r),this.unit="px")}add(n){return this.unit!==n.unit?new ta(NaN,""):new ta(this.num+n.num,this.unit)}subtract(n){return this.unit!==n.unit?new ta(NaN,""):new ta(this.num-n.num,this.unit)}multiply(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new ta(NaN,""):new ta(this.num*n.num,this.unit||n.unit)}divide(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new ta(NaN,""):new ta(this.num/n.num,this.unit||n.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Po(this.num)}}function PW(t){if(t.includes(bf))return bf;for(var n=t;n.includes("*")||n.includes("/");){var r,[,s,i,o]=(r=QO.exec(n))!==null&&r!==void 0?r:[],l=ta.parse(s??""),c=ta.parse(o??""),d=i==="*"?l.multiply(c):l.divide(c);if(d.isNaN())return bf;n=n.replace(QO,d.toString())}for(;n.includes("+")||/.-\d+(?:\.\d+)?/.test(n);){var u,[,h,m,g]=(u=ZO.exec(n))!==null&&u!==void 0?u:[],y=ta.parse(h??""),N=ta.parse(g??""),j=m==="+"?y.add(N):y.subtract(N);if(j.isNaN())return bf;n=n.replace(ZO,j.toString())}return n}var JO=/\(([^()]*)\)/;function gTe(t){for(var n=t,r;(r=JO.exec(n))!=null;){var[,s]=r;n=n.replace(JO,PW(s))}return n}function yTe(t){var n=t.replace(/\s+/g,"");return n=gTe(n),n=PW(n),n}function vTe(t){try{return yTe(t)}catch{return bf}}function c2(t){var n=vTe(t.slice(5,-1));return n===bf?"":n}var bTe=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],wTe=["dx","dy","angle","className","breakAll"];function EC(){return EC=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},EC.apply(null,arguments)}function eD(t,n){if(t==null)return{};var r,s,i=NTe(t,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],n.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function NTe(t,n){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(n.indexOf(s)!==-1)continue;r[s]=t[s]}return r}var MW=/[ \f\n\r\t\v\u2028\u2029]+/,OW=t=>{var{children:n,breakAll:r,style:s}=t;try{var i=[];es(n)||(r?i=n.toString().split(""):i=n.toString().split(MW));var o=i.map(c=>({word:c,width:Zm(c,s).width})),l=r?0:Zm("",s).width;return{wordsWithComputedWidth:o,spaceWidth:l}}catch{return null}};function jTe(t){return t==="start"||t==="middle"||t==="end"||t==="inherit"}var DW=(t,n,r,s)=>t.reduce((i,o)=>{var{word:l,width:c}=o,d=i[i.length-1];if(d&&c!=null&&(n==null||s||d.width+c+r<Number(n)))d.words.push(l),d.width+=c+r;else{var u={words:[l],width:c};i.push(u)}return i},[]),RW=t=>t.reduce((n,r)=>n.width>r.width?n:r),STe="",tD=(t,n,r,s,i,o,l,c)=>{var d=t.slice(0,n),u=OW({breakAll:r,style:s,children:d+STe});if(!u)return[!1,[]];var h=DW(u.wordsWithComputedWidth,o,l,c),m=h.length>i||RW(h).width>Number(o);return[m,h]},CTe=(t,n,r,s,i)=>{var{maxLines:o,children:l,style:c,breakAll:d}=t,u=vt(o),h=String(l),m=DW(n,s,r,i);if(!u||i)return m;var g=m.length>o||RW(m).width>Number(s);if(!g)return m;for(var y=0,N=h.length-1,j=0,S;y<=N&&j<=h.length-1;){var _=Math.floor((y+N)/2),A=_-1,[k,T]=tD(h,A,d,c,o,s,r,i),[P]=tD(h,_,d,c,o,s,r,i);if(!k&&!P&&(y=_+1),k&&P&&(N=_-1),!k&&P){S=T;break}j++}return S||m},nD=t=>{var n=es(t)?[]:t.toString().split(MW);return[{words:n,width:void 0}]},_Te=t=>{var{width:n,scaleToFit:r,children:s,style:i,breakAll:o,maxLines:l}=t;if((n||r)&&!Iu.isSsr){var c,d,u=OW({breakAll:o,children:s,style:i});if(u){var{wordsWithComputedWidth:h,spaceWidth:m}=u;c=h,d=m}else return nD(s);return CTe({breakAll:o,children:s,maxLines:l,style:i},c,d,n,!!r)}return nD(s)},LW="#808080",ATe={breakAll:!1,capHeight:"0.71em",fill:LW,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},Ob=b.forwardRef((t,n)=>{var r=Xs(t,ATe),{x:s,y:i,lineHeight:o,capHeight:l,fill:c,scaleToFit:d,textAnchor:u,verticalAnchor:h}=r,m=eD(r,bTe),g=b.useMemo(()=>_Te({breakAll:m.breakAll,children:m.children,maxLines:m.maxLines,scaleToFit:d,style:m.style,width:m.width}),[m.breakAll,m.children,m.maxLines,d,m.style,m.width]),{dx:y,dy:N,angle:j,className:S,breakAll:_}=m,A=eD(m,wTe);if(!Mo(s)||!Mo(i)||g.length===0)return null;var k=Number(s)+(vt(y)?y:0),T=Number(i)+(vt(N)?N:0);if(!yr(k)||!yr(T))return null;var P;switch(h){case"start":P=c2("calc(".concat(l,")"));break;case"middle":P=c2("calc(".concat((g.length-1)/2," * -").concat(o," + (").concat(l," / 2))"));break;default:P=c2("calc(".concat(g.length-1," * -").concat(o,")"));break}var M=[];if(d){var O=g[0].width,{width:D}=m;M.push("scale(".concat(vt(D)&&vt(O)?D/O:1,")"))}return j&&M.push("rotate(".concat(j,", ").concat(k,", ").concat(T,")")),M.length&&(A.transform=M.join(" ")),b.createElement("text",EC({},mi(A),{ref:n,x:k,y:T,className:cn("recharts-text",S),textAnchor:u,fill:c.includes("url")?LW:c}),g.map((L,$)=>{var V=L.words.join(_?"":" ");return b.createElement("tspan",{x:k,dy:$===0?P:o,key:"".concat(V,"-").concat($)},V)}))});Ob.displayName="Text";var ETe=["labelRef"];function kTe(t,n){if(t==null)return{};var r,s,i=TTe(t,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],n.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function TTe(t,n){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(n.indexOf(s)!==-1)continue;r[s]=t[s]}return r}function rD(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function hr(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?rD(Object(r),!0).forEach(function(s){ITe(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function ITe(t,n,r){return(n=PTe(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function PTe(t){var n=MTe(t,"string");return typeof n=="symbol"?n:n+""}function MTe(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function Zo(){return Zo=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Zo.apply(null,arguments)}var BW=b.createContext(null),OTe=t=>{var{x:n,y:r,upperWidth:s,lowerWidth:i,width:o,height:l,children:c}=t,d=b.useMemo(()=>({x:n,y:r,upperWidth:s,lowerWidth:i,width:o,height:l}),[n,r,s,i,o,l]);return b.createElement(BW.Provider,{value:d},c)},FW=()=>{var t=b.useContext(BW),n=fb();return t||sV(n)},DTe=b.createContext(null),RTe=()=>{var t=b.useContext(DTe),n=mt(SH);return t||n},LTe=t=>{var{value:n,formatter:r}=t,s=es(t.children)?n:t.children;return typeof r=="function"?r(s):s},ck=t=>t!=null&&typeof t=="function",BTe=(t,n)=>{var r=ps(n-t),s=Math.min(Math.abs(n-t),360);return r*s},FTe=(t,n,r,s,i)=>{var{offset:o,className:l}=t,{cx:c,cy:d,innerRadius:u,outerRadius:h,startAngle:m,endAngle:g,clockWise:y}=i,N=(u+h)/2,j=BTe(m,g),S=j>=0?1:-1,_,A;switch(n){case"insideStart":_=m+S*o,A=y;break;case"insideEnd":_=g-S*o,A=!y;break;case"end":_=g+S*o,A=y;break;default:throw new Error("Unsupported position ".concat(n))}A=j<=0?A:!A;var k=Sr(c,d,N,_),T=Sr(c,d,N,_+(A?1:-1)*359),P="M".concat(k.x,",").concat(k.y,`
    A`).concat(N,",").concat(N,",0,1,").concat(A?0:1,`,
    `).concat(T.x,",").concat(T.y),M=es(t.id)?Up("recharts-radial-line-"):t.id;return b.createElement("text",Zo({},s,{dominantBaseline:"central",className:cn("recharts-radial-bar-label",l)}),b.createElement("defs",null,b.createElement("path",{id:M,d:P})),b.createElement("textPath",{xlinkHref:"#".concat(M)},r))},$Te=(t,n,r)=>{var{cx:s,cy:i,innerRadius:o,outerRadius:l,startAngle:c,endAngle:d}=t,u=(c+d)/2;if(r==="outside"){var{x:h,y:m}=Sr(s,i,l+n,u);return{x:h,y:m,textAnchor:h>=s?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:s,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:s,y:i,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:s,y:i,textAnchor:"middle",verticalAnchor:"end"};var g=(o+l)/2,{x:y,y:N}=Sr(s,i,g,u);return{x:y,y:N,textAnchor:"middle",verticalAnchor:"middle"}},kC=t=>"cx"in t&&vt(t.cx),zTe=(t,n)=>{var{parentViewBox:r,offset:s,position:i}=t,o;r!=null&&!kC(r)&&(o=r);var{x:l,y:c,upperWidth:d,lowerWidth:u,height:h}=n,m=l,g=l+(d-u)/2,y=(m+g)/2,N=(d+u)/2,j=m+d/2,S=h>=0?1:-1,_=S*s,A=S>0?"end":"start",k=S>0?"start":"end",T=d>=0?1:-1,P=T*s,M=T>0?"end":"start",O=T>0?"start":"end";if(i==="top"){var D={x:m+d/2,y:c-_,textAnchor:"middle",verticalAnchor:A};return hr(hr({},D),o?{height:Math.max(c-o.y,0),width:d}:{})}if(i==="bottom"){var L={x:g+u/2,y:c+h+_,textAnchor:"middle",verticalAnchor:k};return hr(hr({},L),o?{height:Math.max(o.y+o.height-(c+h),0),width:u}:{})}if(i==="left"){var $={x:y-P,y:c+h/2,textAnchor:M,verticalAnchor:"middle"};return hr(hr({},$),o?{width:Math.max($.x-o.x,0),height:h}:{})}if(i==="right"){var V={x:y+N+P,y:c+h/2,textAnchor:O,verticalAnchor:"middle"};return hr(hr({},V),o?{width:Math.max(o.x+o.width-V.x,0),height:h}:{})}var F=o?{width:N,height:h}:{};return i==="insideLeft"?hr({x:y+P,y:c+h/2,textAnchor:O,verticalAnchor:"middle"},F):i==="insideRight"?hr({x:y+N-P,y:c+h/2,textAnchor:M,verticalAnchor:"middle"},F):i==="insideTop"?hr({x:m+d/2,y:c+_,textAnchor:"middle",verticalAnchor:k},F):i==="insideBottom"?hr({x:g+u/2,y:c+h-_,textAnchor:"middle",verticalAnchor:A},F):i==="insideTopLeft"?hr({x:m+P,y:c+_,textAnchor:O,verticalAnchor:k},F):i==="insideTopRight"?hr({x:m+d-P,y:c+_,textAnchor:M,verticalAnchor:k},F):i==="insideBottomLeft"?hr({x:g+P,y:c+h-_,textAnchor:O,verticalAnchor:A},F):i==="insideBottomRight"?hr({x:g+u-P,y:c+h-_,textAnchor:M,verticalAnchor:A},F):i&&typeof i=="object"&&(vt(i.x)||gl(i.x))&&(vt(i.y)||gl(i.y))?hr({x:l+Ms(i.x,N),y:c+Ms(i.y,h),textAnchor:"end",verticalAnchor:"end"},F):hr({x:j,y:c+h/2,textAnchor:"middle",verticalAnchor:"middle"},F)},UTe={offset:5,zIndex:Is.label};function ec(t){var n=Xs(t,UTe),{viewBox:r,position:s,value:i,children:o,content:l,className:c="",textBreakAll:d,labelRef:u}=n,h=RTe(),m=FW(),g=s==="center"?m:h??m,y,N,j;if(r==null?y=g:kC(r)?y=r:y=sV(r),!y||es(i)&&es(o)&&!b.isValidElement(l)&&typeof l!="function")return null;var S=hr(hr({},n),{},{viewBox:y});if(b.isValidElement(l)){var{labelRef:_}=S,A=kTe(S,ETe);return b.cloneElement(l,A)}if(typeof l=="function"){if(N=b.createElement(l,S),b.isValidElement(N))return N}else N=LTe(n);var k=mi(n);if(kC(y)){if(s==="insideStart"||s==="insideEnd"||s==="end")return FTe(n,s,N,k,y);j=$Te(y,n.offset,n.position)}else j=zTe(n,y);return b.createElement(Fo,{zIndex:n.zIndex},b.createElement(Ob,Zo({ref:u,className:cn("recharts-label",c)},k,j,{textAnchor:jTe(k.textAnchor)?k.textAnchor:j.textAnchor,breakAll:d}),N))}ec.displayName="Label";var VTe=(t,n,r)=>{if(!t)return null;var s={viewBox:n,labelRef:r};return t===!0?b.createElement(ec,Zo({key:"label-implicit"},s)):Mo(t)?b.createElement(ec,Zo({key:"label-implicit",value:t},s)):b.isValidElement(t)?t.type===ec?b.cloneElement(t,hr({key:"label-implicit"},s)):b.createElement(ec,Zo({key:"label-implicit",content:t},s)):ck(t)?b.createElement(ec,Zo({key:"label-implicit",content:t},s)):t&&typeof t=="object"?b.createElement(ec,Zo({},t,{key:"label-implicit"},s)):null};function HTe(t){var{label:n,labelRef:r}=t,s=FW();return VTe(n,s,r)||null}var $W={},zW={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(r){return r[r.length-1]}t.last=n})(zW);var UW={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(r){return Array.isArray(r)?r:Array.from(r)}t.toArray=n})(UW);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=zW,r=UW,s=eb;function i(o){if(s.isArrayLike(o))return n.last(r.toArray(o))}t.last=i})($W);var WTe=$W.last;const qTe=gi(WTe);var GTe=["valueAccessor"],KTe=["dataKey","clockWise","id","textBreakAll","zIndex"];function Cy(){return Cy=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Cy.apply(null,arguments)}function sD(t,n){if(t==null)return{};var r,s,i=YTe(t,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],n.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function YTe(t,n){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(n.indexOf(s)!==-1)continue;r[s]=t[s]}return r}var XTe=t=>Array.isArray(t.value)?qTe(t.value):t.value,VW=b.createContext(void 0),QTe=VW.Provider,HW=b.createContext(void 0),ZTe=HW.Provider;function JTe(){return b.useContext(VW)}function e5e(){return b.useContext(HW)}function Fg(t){var{valueAccessor:n=XTe}=t,r=sD(t,GTe),{dataKey:s,clockWise:i,id:o,textBreakAll:l,zIndex:c}=r,d=sD(r,KTe),u=JTe(),h=e5e(),m=u||h;return!m||!m.length?null:b.createElement(Fo,{zIndex:c??Is.label},b.createElement(Gs,{className:"recharts-label-list"},m.map((g,y)=>{var N,j=es(s)?n(g,y):Xn(g&&g.payload,s),S=es(o)?{}:{id:"".concat(o,"-").concat(y)};return b.createElement(ec,Cy({key:"label-".concat(y)},mi(g),d,S,{fill:(N=r.fill)!==null&&N!==void 0?N:g.fill,parentViewBox:g.parentViewBox,value:j,textBreakAll:l,viewBox:g.viewBox,index:y,zIndex:0}))})))}Fg.displayName="LabelList";function WW(t){var{label:n}=t;return n?n===!0?b.createElement(Fg,{key:"labelList-implicit"}):b.isValidElement(n)||ck(n)?b.createElement(Fg,{key:"labelList-implicit",content:n}):typeof n=="object"?b.createElement(Fg,Cy({key:"labelList-implicit"},n,{type:String(n.type)})):null:null}var qW=t=>t.graphicalItems.polarItems,t5e=je([Hn,Ix],O3),Db=je([qW,er,t5e],R3),n5e=je([Db],L3),Rb=je([n5e,N3],B3),r5e=je([Rb,er,Db],$3);je([Rb,er,Db],(t,n,r)=>r.length>0?t.flatMap(s=>r.flatMap(i=>{var o,l=Xn(s,(o=n.dataKey)!==null&&o!==void 0?o:i.dataKey);return{value:l,errorDomain:[]}})).filter(Boolean):(n==null?void 0:n.dataKey)!=null?t.map(s=>({value:Xn(s,n.dataKey),errorDomain:[]})):t.map(s=>({value:s,errorDomain:[]})));var aD=()=>{},s5e=je([Rb,er,Db,Tb,Hn],H3),a5e=je([er,U3,V3,aD,s5e,aD,rn,Hn],W3),GW=je([er,rn,Rb,r5e,Tx,Hn,a5e],q3),i5e=je([GW,er,Mh],Y3);je([er,GW,i5e,Hn],Q3);var o5e={radiusAxis:{},angleAxis:{}},KW=ga({name:"polarAxis",initialState:o5e,reducers:{addRadiusAxis(t,n){t.radiusAxis[n.payload.id]=n.payload},removeRadiusAxis(t,n){delete t.radiusAxis[n.payload.id]},addAngleAxis(t,n){t.angleAxis[n.payload.id]=n.payload},removeAngleAxis(t,n){delete t.angleAxis[n.payload.id]}}}),{addRadiusAxis:K8e,removeRadiusAxis:Y8e,addAngleAxis:X8e,removeAngleAxis:Q8e}=KW.actions,l5e=KW.reducer;function iD(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function oD(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?iD(Object(r),!0).forEach(function(s){c5e(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):iD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function c5e(t,n,r){return(n=d5e(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function d5e(t){var n=u5e(t,"string");return typeof n=="symbol"?n:n+""}function u5e(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var f5e=(t,n)=>n,dk=je([qW,f5e],(t,n)=>t.filter(r=>r.type==="pie").find(r=>r.id===n)),h5e=[],uk=(t,n,r)=>(r==null?void 0:r.length)===0?h5e:r,YW=je([N3,dk,uk],(t,n,r)=>{var{chartData:s}=t;if(n!=null){var i;if((n==null?void 0:n.data)!=null&&n.data.length>0?i=n.data:i=s,(!i||!i.length)&&r!=null&&(i=r.map(o=>oD(oD({},n.presentationProps),o.props))),i!=null)return i}}),m5e=je([YW,dk,uk],(t,n,r)=>{if(!(t==null||n==null))return t.map((s,i)=>{var o,l=Xn(s,n.nameKey,n.name),c;return r!=null&&(o=r[i])!==null&&o!==void 0&&(o=o.props)!==null&&o!==void 0&&o.fill?c=r[i].props.fill:typeof s=="object"&&s!=null&&"fill"in s?c=s.fill:c=n.fill,{value:ob(l,n.dataKey),color:c,payload:s,type:n.legendType}})}),p5e=je([YW,dk,uk,Vr],(t,n,r,s)=>{if(!(n==null||t==null))return gIe({offset:s,pieSettings:n,displayedData:t,cells:r})}),XW={exports:{}},hn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ns=typeof Symbol=="function"&&Symbol.for,fk=ns?Symbol.for("react.element"):60103,hk=ns?Symbol.for("react.portal"):60106,Lb=ns?Symbol.for("react.fragment"):60107,Bb=ns?Symbol.for("react.strict_mode"):60108,Fb=ns?Symbol.for("react.profiler"):60114,$b=ns?Symbol.for("react.provider"):60109,zb=ns?Symbol.for("react.context"):60110,mk=ns?Symbol.for("react.async_mode"):60111,Ub=ns?Symbol.for("react.concurrent_mode"):60111,Vb=ns?Symbol.for("react.forward_ref"):60112,Hb=ns?Symbol.for("react.suspense"):60113,x5e=ns?Symbol.for("react.suspense_list"):60120,Wb=ns?Symbol.for("react.memo"):60115,qb=ns?Symbol.for("react.lazy"):60116,g5e=ns?Symbol.for("react.block"):60121,y5e=ns?Symbol.for("react.fundamental"):60117,v5e=ns?Symbol.for("react.responder"):60118,b5e=ns?Symbol.for("react.scope"):60119;function Va(t){if(typeof t=="object"&&t!==null){var n=t.$$typeof;switch(n){case fk:switch(t=t.type,t){case mk:case Ub:case Lb:case Fb:case Bb:case Hb:return t;default:switch(t=t&&t.$$typeof,t){case zb:case Vb:case qb:case Wb:case $b:return t;default:return n}}case hk:return n}}}function QW(t){return Va(t)===Ub}hn.AsyncMode=mk;hn.ConcurrentMode=Ub;hn.ContextConsumer=zb;hn.ContextProvider=$b;hn.Element=fk;hn.ForwardRef=Vb;hn.Fragment=Lb;hn.Lazy=qb;hn.Memo=Wb;hn.Portal=hk;hn.Profiler=Fb;hn.StrictMode=Bb;hn.Suspense=Hb;hn.isAsyncMode=function(t){return QW(t)||Va(t)===mk};hn.isConcurrentMode=QW;hn.isContextConsumer=function(t){return Va(t)===zb};hn.isContextProvider=function(t){return Va(t)===$b};hn.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===fk};hn.isForwardRef=function(t){return Va(t)===Vb};hn.isFragment=function(t){return Va(t)===Lb};hn.isLazy=function(t){return Va(t)===qb};hn.isMemo=function(t){return Va(t)===Wb};hn.isPortal=function(t){return Va(t)===hk};hn.isProfiler=function(t){return Va(t)===Fb};hn.isStrictMode=function(t){return Va(t)===Bb};hn.isSuspense=function(t){return Va(t)===Hb};hn.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Lb||t===Ub||t===Fb||t===Bb||t===Hb||t===x5e||typeof t=="object"&&t!==null&&(t.$$typeof===qb||t.$$typeof===Wb||t.$$typeof===$b||t.$$typeof===zb||t.$$typeof===Vb||t.$$typeof===y5e||t.$$typeof===v5e||t.$$typeof===b5e||t.$$typeof===g5e)};hn.typeOf=Va;XW.exports=hn;var w5e=XW.exports,lD=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",cD=null,d2=null,ZW=t=>{if(t===cD&&Array.isArray(d2))return d2;var n=[];return b.Children.forEach(t,r=>{es(r)||(w5e.isFragment(r)?n=n.concat(ZW(r.props.children)):n.push(r))}),d2=n,cD=t,n};function pk(t,n){var r=[],s=[];return Array.isArray(n)?s=n.map(i=>lD(i)):s=[lD(n)],ZW(t).forEach(i=>{var o=hu(i,"type.displayName")||hu(i,"type.name");o&&s.indexOf(o)!==-1&&r.push(i)}),r}var JW={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(r){var i;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const o=r[Symbol.toStringTag];return o==null||!((i=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&i.writable)?!1:r.toString()===`[object ${o}]`}let s=r;for(;Object.getPrototypeOf(s)!==null;)s=Object.getPrototypeOf(s);return Object.getPrototypeOf(r)===s}t.isPlainObject=n})(JW);var N5e=JW.isPlainObject;const j5e=gi(N5e);function dD(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function uD(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?dD(Object(r),!0).forEach(function(s){S5e(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):dD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function S5e(t,n,r){return(n=C5e(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function C5e(t){var n=_5e(t,"string");return typeof n=="symbol"?n:n+""}function _5e(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function _y(){return _y=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},_y.apply(null,arguments)}var fD=(t,n,r,s,i)=>{var o=r-s,l;return l="M ".concat(t,",").concat(n),l+="L ".concat(t+r,",").concat(n),l+="L ".concat(t+r-o/2,",").concat(n+i),l+="L ".concat(t+r-o/2-s,",").concat(n+i),l+="L ".concat(t,",").concat(n," Z"),l},A5e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},E5e=t=>{var n=Xs(t,A5e),{x:r,y:s,upperWidth:i,lowerWidth:o,height:l,className:c}=n,{animationEasing:d,animationDuration:u,animationBegin:h,isUpdateAnimationActive:m}=n,g=b.useRef(null),[y,N]=b.useState(-1),j=b.useRef(i),S=b.useRef(o),_=b.useRef(l),A=b.useRef(r),k=b.useRef(s),T=xb(t,"trapezoid-");if(b.useEffect(()=>{if(g.current&&g.current.getTotalLength)try{var U=g.current.getTotalLength();U&&N(U)}catch{}},[]),r!==+r||s!==+s||i!==+i||o!==+o||l!==+l||i===0&&o===0||l===0)return null;var P=cn("recharts-trapezoid",c);if(!m)return b.createElement("g",null,b.createElement("path",_y({},mi(n),{className:P,d:fD(r,s,i,o,l)})));var M=j.current,O=S.current,D=_.current,L=A.current,$=k.current,V="0px ".concat(y===-1?1:y,"px"),F="".concat(y,"px 0px"),Q=cV(["strokeDasharray"],u,d);return b.createElement(pb,{animationId:T,key:T,canBegin:y>0,duration:u,easing:d,isActive:m,begin:h},U=>{var z=Rr(M,i,U),q=Rr(O,o,U),K=Rr(D,l,U),X=Rr(L,r,U),J=Rr($,s,U);g.current&&(j.current=z,S.current=q,_.current=K,A.current=X,k.current=J);var ne=U>0?{transition:Q,strokeDasharray:F}:{strokeDasharray:V};return b.createElement("path",_y({},mi(n),{className:P,d:fD(X,J,z,q,K),ref:g,style:uD(uD({},ne),n.style)}))})},k5e=["option","shapeType","propTransformer","activeClassName","isActive"];function T5e(t,n){if(t==null)return{};var r,s,i=I5e(t,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],n.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function I5e(t,n){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(n.indexOf(s)!==-1)continue;r[s]=t[s]}return r}function hD(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function Ay(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?hD(Object(r),!0).forEach(function(s){P5e(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):hD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function P5e(t,n,r){return(n=M5e(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function M5e(t){var n=O5e(t,"string");return typeof n=="symbol"?n:n+""}function O5e(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function D5e(t,n){return Ay(Ay({},n),t)}function R5e(t,n){return t==="symbols"}function mD(t){var{shapeType:n,elementProps:r}=t;switch(n){case"rectangle":return b.createElement(hV,r);case"trapezoid":return b.createElement(E5e,r);case"sector":return b.createElement(gV,r);case"symbols":if(R5e(n))return b.createElement(Xz,r);break;case"curve":return b.createElement(ZE,r);default:return null}}function L5e(t){return b.isValidElement(t)?t.props:t}function eq(t){var{option:n,shapeType:r,propTransformer:s=D5e,activeClassName:i="recharts-active-shape",isActive:o}=t,l=T5e(t,k5e),c;if(b.isValidElement(n))c=b.cloneElement(n,Ay(Ay({},l),L5e(n)));else if(typeof n=="function")c=n(l);else if(j5e(n)&&typeof n!="boolean"){var d=s(n,l);c=b.createElement(mD,{shapeType:r,elementProps:d})}else{var u=l;c=b.createElement(mD,{shapeType:r,elementProps:u})}return o?b.createElement(Gs,{className:i},c):c}var xk=(t,n)=>{var r=Vn();return(s,i)=>o=>{t==null||t(s,i,o),r(nW({activeIndex:String(i),activeDataKey:n,activeCoordinate:s.tooltipPosition}))}},gk=t=>{var n=Vn();return(r,s)=>i=>{t==null||t(r,s,i),n(r3e())}},yk=(t,n)=>{var r=Vn();return(s,i)=>o=>{t==null||t(s,i,o),r(s3e({activeIndex:String(i),activeDataKey:n,activeCoordinate:s.tooltipPosition}))}};function tq(t){var{fn:n,args:r}=t,s=Vn(),i=Ua();return b.useLayoutEffect(()=>{if(!i){var o=n(r);return s(e3e(o)),()=>{s(t3e(o))}}},[n,r,s,i]),null}function B5e(t){var{legendPayload:n}=t,r=Vn(),s=Ua();return b.useLayoutEffect(()=>s?ku:(r(iV(n)),()=>{r(oV(n))}),[r,s,n]),null}function F5e(t){var{legendPayload:n}=t,r=Vn(),s=mt(rn);return b.useLayoutEffect(()=>s!=="centric"&&s!=="radial"?ku:(r(iV(n)),()=>{r(oV(n))}),[r,s,n]),null}var u2,$5e=()=>{var[t]=b.useState(()=>Up("uid-"));return t},z5e=(u2=Hy.useId)!==null&&u2!==void 0?u2:$5e;function nq(t,n){var r=z5e();return n||(t?"".concat(t,"-").concat(r):r)}var U5e=b.createContext(void 0),rq=t=>{var{id:n,type:r,children:s}=t,i=nq("recharts-".concat(r),n);return b.createElement(U5e.Provider,{value:i},s(i))},V5e={cartesianItems:[],polarItems:[]},sq=ga({name:"graphicalItems",initialState:V5e,reducers:{addCartesianGraphicalItem:{reducer(t,n){t.cartesianItems.push(n.payload)},prepare:Fr()},replaceCartesianGraphicalItem:{reducer(t,n){var{prev:r,next:s}=n.payload,i=il(t).cartesianItems.indexOf(r);i>-1&&(t.cartesianItems[i]=s)},prepare:Fr()},removeCartesianGraphicalItem:{reducer(t,n){var r=il(t).cartesianItems.indexOf(n.payload);r>-1&&t.cartesianItems.splice(r,1)},prepare:Fr()},addPolarGraphicalItem:{reducer(t,n){t.polarItems.push(n.payload)},prepare:Fr()},removePolarGraphicalItem:{reducer(t,n){var r=il(t).polarItems.indexOf(n.payload);r>-1&&t.polarItems.splice(r,1)},prepare:Fr()}}}),{addCartesianGraphicalItem:H5e,replaceCartesianGraphicalItem:W5e,removeCartesianGraphicalItem:q5e,addPolarGraphicalItem:G5e,removePolarGraphicalItem:K5e}=sq.actions,Y5e=sq.reducer;function X5e(t){var n=Vn(),r=b.useRef(null);return b.useLayoutEffect(()=>{r.current===null?n(H5e(t)):r.current!==t&&n(W5e({prev:r.current,next:t})),r.current=t},[n,t]),b.useLayoutEffect(()=>()=>{r.current&&(n(q5e(r.current)),r.current=null)},[n]),null}function Q5e(t){var n=Vn();return b.useLayoutEffect(()=>(n(G5e(t)),()=>{n(K5e(t))}),[n,t]),null}var Z5e=["onMouseEnter","onClick","onMouseLeave"],J5e=["id"],eIe=["id"];function vk(t,n){if(t==null)return{};var r,s,i=tIe(t,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],n.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function tIe(t,n){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(n.indexOf(s)!==-1)continue;r[s]=t[s]}return r}function pD(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function Bn(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?pD(Object(r),!0).forEach(function(s){nIe(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function nIe(t,n,r){return(n=rIe(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function rIe(t){var n=sIe(t,"string");return typeof n=="symbol"?n:n+""}function sIe(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function Bc(){return Bc=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Bc.apply(null,arguments)}function aIe(t){var n=b.useMemo(()=>pk(t.children,xo),[t.children]),r=mt(s=>m5e(s,t.id,n));return r==null?null:b.createElement(F5e,{legendPayload:r})}function iIe(t){var{dataKey:n,nameKey:r,sectors:s,stroke:i,strokeWidth:o,fill:l,name:c,hide:d,tooltipType:u}=t;return{dataDefinedOnItem:s.map(h=>h.tooltipPayload),positions:s.map(h=>h.tooltipPosition),settings:{stroke:i,strokeWidth:o,fill:l,dataKey:n,nameKey:r,name:ob(c,n),hide:d,type:u,color:l,unit:""}}}var oIe=(t,n)=>t>n?"start":t<n?"end":"middle",lIe=(t,n,r)=>Ms(typeof n=="function"?n(t):n,r,r*.8),cIe=(t,n,r)=>{var{top:s,left:i,width:o,height:l}=n,c=mV(o,l),d=i+Ms(t.cx,o,o/2),u=s+Ms(t.cy,l,l/2),h=Ms(t.innerRadius,c,0),m=lIe(r,t.outerRadius,c),g=t.maxRadius||Math.sqrt(o*o+l*l)/2;return{cx:d,cy:u,innerRadius:h,outerRadius:m,maxRadius:g}},dIe=(t,n)=>{var r=ps(n-t),s=Math.min(Math.abs(n-t),360);return r*s};function uIe(t){return t&&typeof t=="object"&&"className"in t&&typeof t.className=="string"?t.className:""}var fIe=(t,n)=>{if(b.isValidElement(t))return b.cloneElement(t,n);if(typeof t=="function")return t(n);var r=cn("recharts-pie-label-line",typeof t!="boolean"?t.className:"");return b.createElement(ZE,Bc({},n,{type:"linear",className:r}))},hIe=(t,n,r)=>{if(b.isValidElement(t))return b.cloneElement(t,n);var s=r;if(typeof t=="function"&&(s=t(n),b.isValidElement(s)))return s;var i=cn("recharts-pie-label-text",uIe(t));return b.createElement(Ob,Bc({},n,{alignmentBaseline:"middle",className:i}),s)};function mIe(t){var{sectors:n,props:r,showLabels:s}=t,{label:i,labelLine:o,dataKey:l}=r;if(!s||!i||!n)return null;var c=Io(r),d=zp(i),u=zp(o),h=typeof i=="object"&&"offsetRadius"in i&&typeof i.offsetRadius=="number"&&i.offsetRadius||20,m=n.map((g,y)=>{var N=(g.startAngle+g.endAngle)/2,j=Sr(g.cx,g.cy,g.outerRadius+h,N),S=Bn(Bn(Bn(Bn({},c),g),{},{stroke:"none"},d),{},{index:y,textAnchor:oIe(j.x,g.cx)},j),_=Bn(Bn(Bn(Bn({},c),g),{},{fill:"none",stroke:g.fill},u),{},{index:y,points:[Sr(g.cx,g.cy,g.outerRadius,N),j],key:"line"});return b.createElement(Fo,{zIndex:Is.label,key:"label-".concat(g.startAngle,"-").concat(g.endAngle,"-").concat(g.midAngle,"-").concat(y)},b.createElement(Gs,null,o&&fIe(o,_),hIe(i,S,Xn(g,l))))});return b.createElement(Gs,{className:"recharts-pie-labels"},m)}function pIe(t){var{sectors:n,props:r,showLabels:s}=t,{label:i}=r;return typeof i=="object"&&i!=null&&"position"in i?b.createElement(WW,{label:i}):b.createElement(mIe,{sectors:n,props:r,showLabels:s})}function xIe(t){var{sectors:n,activeShape:r,inactiveShape:s,allOtherPieProps:i}=t,o=mt(yu),{onMouseEnter:l,onClick:c,onMouseLeave:d}=i,u=vk(i,Z5e),h=xk(l,i.dataKey),m=gk(d),g=yk(c,i.dataKey);return n==null||n.length===0?null:b.createElement(b.Fragment,null,n.map((y,N)=>{if((y==null?void 0:y.startAngle)===0&&(y==null?void 0:y.endAngle)===0&&n.length!==1)return null;var j=r&&String(N)===o,S=o?s:null,_=j?r:S,A=Bn(Bn({},y),{},{stroke:y.stroke,tabIndex:-1,[XU]:N,[QU]:i.dataKey});return b.createElement(Gs,Bc({key:"sector-".concat(y==null?void 0:y.startAngle,"-").concat(y==null?void 0:y.endAngle,"-").concat(y.midAngle,"-").concat(N),tabIndex:-1,className:"recharts-pie-sector"},Jv(u,y,N),{onMouseEnter:h(y,N),onMouseLeave:m(y,N),onClick:g(y,N)}),b.createElement(eq,Bc({option:_,isActive:j,shapeType:"sector"},A)))}))}function gIe(t){var n,{pieSettings:r,displayedData:s,cells:i,offset:o}=t,{cornerRadius:l,startAngle:c,endAngle:d,dataKey:u,nameKey:h,tooltipType:m}=r,g=Math.abs(r.minAngle),y=dIe(c,d),N=Math.abs(y),j=s.length<=1?0:(n=r.paddingAngle)!==null&&n!==void 0?n:0,S=s.filter(M=>Xn(M,u,0)!==0).length,_=(N>=360?S:S-1)*j,A=N-S*g-_,k=s.reduce((M,O)=>{var D=Xn(O,u,0);return M+(vt(D)?D:0)},0),T;if(k>0){var P;T=s.map((M,O)=>{var D=Xn(M,u,0),L=Xn(M,h,O),$=cIe(r,o,M),V=(vt(D)?D:0)/k,F,Q=Bn(Bn({},M),i&&i[O]&&i[O].props);O?F=P.endAngle+ps(y)*j*(D!==0?1:0):F=c;var U=F+ps(y)*((D!==0?g:0)+V*A),z=(F+U)/2,q=($.innerRadius+$.outerRadius)/2,K=[{name:L,value:D,payload:Q,dataKey:u,type:m}],X=Sr($.cx,$.cy,q,z);return P=Bn(Bn(Bn(Bn({},r.presentationProps),{},{percent:V,cornerRadius:typeof l=="string"?parseFloat(l):l,name:L,tooltipPayload:K,midAngle:z,middleRadius:q,tooltipPosition:X},Q),$),{},{value:D,startAngle:F,endAngle:U,payload:Q,paddingAngle:ps(y)*j}),P})}return T}function yIe(t){var{showLabels:n,sectors:r,children:s}=t,i=b.useMemo(()=>!n||!r?[]:r.map(o=>({value:o.value,payload:o.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:o.cx,cy:o.cy,innerRadius:o.innerRadius,outerRadius:o.outerRadius,startAngle:o.startAngle,endAngle:o.endAngle,clockWise:!1},fill:o.fill})),[r,n]);return b.createElement(ZTe,{value:n?i:void 0},s)}function vIe(t){var{props:n,previousSectorsRef:r}=t,{sectors:s,isAnimationActive:i,animationBegin:o,animationDuration:l,animationEasing:c,activeShape:d,inactiveShape:u,onAnimationStart:h,onAnimationEnd:m}=n,g=xb(n,"recharts-pie-"),y=r.current,[N,j]=b.useState(!1),S=b.useCallback(()=>{typeof m=="function"&&m(),j(!1)},[m]),_=b.useCallback(()=>{typeof h=="function"&&h(),j(!0)},[h]);return b.createElement(yIe,{showLabels:!N,sectors:s},b.createElement(pb,{animationId:g,begin:o,duration:l,isActive:i,easing:c,onAnimationStart:_,onAnimationEnd:S,key:g},A=>{var k=[],T=s&&s[0],P=T==null?void 0:T.startAngle;return s==null||s.forEach((M,O)=>{var D=y&&y[O],L=O>0?hu(M,"paddingAngle",0):0;if(D){var $=Rr(D.endAngle-D.startAngle,M.endAngle-M.startAngle,A),V=Bn(Bn({},M),{},{startAngle:P+L,endAngle:P+$+L});k.push(V),P=V.endAngle}else{var{endAngle:F,startAngle:Q}=M,U=Rr(0,F-Q,A),z=Bn(Bn({},M),{},{startAngle:P+L,endAngle:P+U+L});k.push(z),P=z.endAngle}}),r.current=k,b.createElement(Gs,null,b.createElement(xIe,{sectors:k,activeShape:d,inactiveShape:u,allOtherPieProps:n}))}),b.createElement(pIe,{showLabels:!N,sectors:s,props:n}),n.children)}var bIe={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!Iu.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:Is.area};function wIe(t){var{id:n}=t,r=vk(t,J5e),{hide:s,className:i,rootTabIndex:o}=t,l=b.useMemo(()=>pk(t.children,xo),[t.children]),c=mt(h=>p5e(h,n,l)),d=b.useRef(null),u=cn("recharts-pie",i);return s||c==null?(d.current=null,b.createElement(Gs,{tabIndex:o,className:u})):b.createElement(Fo,{zIndex:t.zIndex},b.createElement(tq,{fn:iIe,args:Bn(Bn({},t),{},{sectors:c})}),b.createElement(Gs,{tabIndex:o,className:u},b.createElement(vIe,{props:Bn(Bn({},r),{},{sectors:c}),previousSectorsRef:d})))}function Ey(t){var n=Xs(t,bIe),{id:r}=n,s=vk(n,eIe),i=Io(s);return b.createElement(rq,{id:r,type:"pie"},o=>b.createElement(b.Fragment,null,b.createElement(Q5e,{type:"pie",id:o,data:s.data,dataKey:s.dataKey,hide:s.hide,angleAxisId:0,radiusAxisId:0,name:s.name,nameKey:s.nameKey,tooltipType:s.tooltipType,legendType:s.legendType,fill:s.fill,cx:s.cx,cy:s.cy,startAngle:s.startAngle,endAngle:s.endAngle,paddingAngle:s.paddingAngle,minAngle:s.minAngle,innerRadius:s.innerRadius,outerRadius:s.outerRadius,cornerRadius:s.cornerRadius,presentationProps:i,maxRadius:n.maxRadius}),b.createElement(aIe,Bc({},s,{id:o})),b.createElement(wIe,Bc({},s,{id:o}))))}Ey.displayName="Pie";function xD(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function gD(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?xD(Object(r),!0).forEach(function(s){NIe(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):xD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function NIe(t,n,r){return(n=jIe(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function jIe(t){var n=SIe(t,"string");return typeof n=="symbol"?n:n+""}function SIe(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var CIe={xAxis:{},yAxis:{},zAxis:{}},aq=ga({name:"cartesianAxis",initialState:CIe,reducers:{addXAxis:{reducer(t,n){t.xAxis[n.payload.id]=n.payload},prepare:Fr()},removeXAxis:{reducer(t,n){delete t.xAxis[n.payload.id]},prepare:Fr()},addYAxis:{reducer(t,n){t.yAxis[n.payload.id]=n.payload},prepare:Fr()},removeYAxis:{reducer(t,n){delete t.yAxis[n.payload.id]},prepare:Fr()},addZAxis:{reducer(t,n){t.zAxis[n.payload.id]=n.payload},prepare:Fr()},removeZAxis:{reducer(t,n){delete t.zAxis[n.payload.id]},prepare:Fr()},updateYAxisWidth(t,n){var{id:r,width:s}=n.payload,i=t.yAxis[r];if(i){var o=i.widthHistory||[];if(o.length===3&&o[0]===o[2]&&s===o[1]&&s!==i.width&&Math.abs(s-o[0])<=1)return;var l=[...o,s].slice(-3);t.yAxis[r]=gD(gD({},t.yAxis[r]),{},{width:s,widthHistory:l})}}}}),{addXAxis:_Ie,removeXAxis:AIe,addYAxis:EIe,removeYAxis:kIe,addZAxis:Z8e,removeZAxis:J8e,updateYAxisWidth:TIe}=aq.actions,IIe=aq.reducer,PIe=je([Vr],t=>({top:t.top,bottom:t.bottom,left:t.left,right:t.right})),MIe=je([PIe,kl,Tl],(t,n,r)=>{if(!(!t||n==null||r==null))return{x:t.left,y:t.top,width:Math.max(0,n-t.left-t.right),height:Math.max(0,r-t.top-t.bottom)}}),iq=()=>mt(MIe),OIe="Invariant failed";function DIe(t,n){throw new Error(OIe)}var RIe=["x","y"];function TC(){return TC=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},TC.apply(null,arguments)}function yD(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function gm(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?yD(Object(r),!0).forEach(function(s){LIe(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function LIe(t,n,r){return(n=BIe(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function BIe(t){var n=FIe(t,"string");return typeof n=="symbol"?n:n+""}function FIe(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function $Ie(t,n){if(t==null)return{};var r,s,i=zIe(t,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],n.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function zIe(t,n){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(n.indexOf(s)!==-1)continue;r[s]=t[s]}return r}function UIe(t,n){var{x:r,y:s}=t,i=$Ie(t,RIe),o="".concat(r),l=parseInt(o,10),c="".concat(s),d=parseInt(c,10),u="".concat(n.height||i.height),h=parseInt(u,10),m="".concat(n.width||i.width),g=parseInt(m,10);return gm(gm(gm(gm(gm({},n),i),l?{x:l}:{}),d?{y:d}:{}),{},{height:h,width:g,name:n.name,radius:n.radius})}function ky(t){return b.createElement(eq,TC({shapeType:"rectangle",propTransformer:UIe,activeClassName:"recharts-active-bar"},t))}var VIe=function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(s,i)=>{if(vt(n))return n;var o=vt(s)||es(s);return o?n(s,i):(o||DIe(),r)}},HIe={},oq=ga({name:"errorBars",initialState:HIe,reducers:{addErrorBar:(t,n)=>{var{itemId:r,errorBar:s}=n.payload;t[r]||(t[r]=[]),t[r].push(s)},replaceErrorBar:(t,n)=>{var{itemId:r,prev:s,next:i}=n.payload;t[r]&&(t[r]=t[r].map(o=>o.dataKey===s.dataKey&&o.direction===s.direction?i:o))},removeErrorBar:(t,n)=>{var{itemId:r,errorBar:s}=n.payload;t[r]&&(t[r]=t[r].filter(i=>i.dataKey!==s.dataKey||i.direction!==s.direction))}}}),{addErrorBar:e6e,replaceErrorBar:t6e,removeErrorBar:n6e}=oq.actions,WIe=oq.reducer,qIe=["children"];function GIe(t,n){if(t==null)return{};var r,s,i=KIe(t,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],n.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function KIe(t,n){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(n.indexOf(s)!==-1)continue;r[s]=t[s]}return r}var YIe={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},XIe=b.createContext(YIe);function QIe(t){var{children:n}=t,r=GIe(t,qIe);return b.createElement(XIe.Provider,{value:r},n)}function lq(t,n){var r,s,i=mt(u=>Pl(u,t)),o=mt(u=>Ml(u,n)),l=(r=i==null?void 0:i.allowDataOverflow)!==null&&r!==void 0?r:va.allowDataOverflow,c=(s=o==null?void 0:o.allowDataOverflow)!==null&&s!==void 0?s:ba.allowDataOverflow,d=l||c;return{needClip:d,needClipX:l,needClipY:c}}function ZIe(t){var{xAxisId:n,yAxisId:r,clipPathId:s}=t,i=iq(),{needClipX:o,needClipY:l,needClip:c}=lq(n,r);if(!c||!i)return null;var{x:d,y:u,width:h,height:m}=i;return b.createElement("clipPath",{id:"clipPath-".concat(s)},b.createElement("rect",{x:o?d:d-h/2,y:l?u:u-m/2,width:o?h:h*2,height:l?m:m*2}))}function JIe(t,n){return t&&typeof t=="object"&&"zIndex"in t&&typeof t.zIndex=="number"&&yr(t.zIndex)?t.zIndex:n}var ePe=["onMouseEnter","onMouseLeave","onClick"],tPe=["value","background","tooltipPosition"],nPe=["id"],rPe=["onMouseEnter","onClick","onMouseLeave"];function jl(){return jl=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},jl.apply(null,arguments)}function vD(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function zs(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?vD(Object(r),!0).forEach(function(s){sPe(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function sPe(t,n,r){return(n=aPe(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function aPe(t){var n=iPe(t,"string");return typeof n=="symbol"?n:n+""}function iPe(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function Ty(t,n){if(t==null)return{};var r,s,i=oPe(t,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],n.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function oPe(t,n){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(n.indexOf(s)!==-1)continue;r[s]=t[s]}return r}var lPe=t=>{var{dataKey:n,name:r,fill:s,legendType:i,hide:o}=t;return[{inactive:o,dataKey:n,type:i,color:s,value:ob(r,n),payload:t}]};function cPe(t){var{dataKey:n,stroke:r,strokeWidth:s,fill:i,name:o,hide:l,unit:c}=t;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:s,fill:i,dataKey:n,nameKey:void 0,name:ob(o,n),hide:l,type:t.tooltipType,color:t.fill,unit:c}}}function dPe(t){var n=mt(yu),{data:r,dataKey:s,background:i,allOtherBarProps:o}=t,{onMouseEnter:l,onMouseLeave:c,onClick:d}=o,u=Ty(o,ePe),h=xk(l,s),m=gk(c),g=yk(d,s);if(!i||r==null)return null;var y=zp(i);return b.createElement(Fo,{zIndex:JIe(i,Is.barBackground)},r.map((N,j)=>{var{value:S,background:_,tooltipPosition:A}=N,k=Ty(N,tPe);if(!_)return null;var T=h(N,j),P=m(N,j),M=g(N,j),O=zs(zs(zs(zs(zs({option:i,isActive:String(j)===n},k),{},{fill:"#eee"},_),y),Jv(u,N,j)),{},{onMouseEnter:T,onMouseLeave:P,onClick:M,dataKey:s,index:j,className:"recharts-bar-background-rectangle"});return b.createElement(ky,jl({key:"background-bar-".concat(j)},O))}))}function uPe(t){var{showLabels:n,children:r,rects:s}=t,i=s==null?void 0:s.map(o=>{var l={x:o.x,y:o.y,width:o.width,lowerWidth:o.width,upperWidth:o.width,height:o.height};return zs(zs({},l),{},{value:o.value,payload:o.payload,parentViewBox:o.parentViewBox,viewBox:l,fill:o.fill})});return b.createElement(QTe,{value:n?i:void 0},r)}function fPe(t){var{shape:n,activeBar:r,baseProps:s,entry:i,index:o,dataKey:l}=t,c=mt(yu),d=mt(gW),u=r&&String(o)===c&&(d==null||l===d),h=u?r:n;return u?b.createElement(Fo,{zIndex:Is.activeBar},b.createElement(ky,jl({},s,{name:String(s.name)},i,{isActive:u,option:h,index:o,dataKey:l}))):b.createElement(ky,jl({},s,{name:String(s.name)},i,{isActive:u,option:h,index:o,dataKey:l}))}function hPe(t){var{shape:n,baseProps:r,entry:s,index:i,dataKey:o}=t;return b.createElement(ky,jl({},r,{name:String(r.name)},s,{isActive:!1,option:n,index:i,dataKey:o}))}function mPe(t){var n,{data:r,props:s}=t,i=(n=Io(s))!==null&&n!==void 0?n:{},{id:o}=i,l=Ty(i,nPe),{shape:c,dataKey:d,activeBar:u}=s,{onMouseEnter:h,onClick:m,onMouseLeave:g}=s,y=Ty(s,rPe),N=xk(h,d),j=gk(g),S=yk(m,d);return r?b.createElement(b.Fragment,null,r.map((_,A)=>b.createElement(Gs,jl({key:"rectangle-".concat(_==null?void 0:_.x,"-").concat(_==null?void 0:_.y,"-").concat(_==null?void 0:_.value,"-").concat(A),className:"recharts-bar-rectangle"},Jv(y,_,A),{onMouseEnter:N(_,A),onMouseLeave:j(_,A),onClick:S(_,A)}),u?b.createElement(fPe,{shape:c,activeBar:u,baseProps:l,entry:_,index:A,dataKey:d}):b.createElement(hPe,{shape:c,baseProps:l,entry:_,index:A,dataKey:d})))):null}function pPe(t){var{props:n,previousRectanglesRef:r}=t,{data:s,layout:i,isAnimationActive:o,animationBegin:l,animationDuration:c,animationEasing:d,onAnimationEnd:u,onAnimationStart:h}=n,m=r.current,g=xb(n,"recharts-bar-"),[y,N]=b.useState(!1),j=!y,S=b.useCallback(()=>{typeof u=="function"&&u(),N(!1)},[u]),_=b.useCallback(()=>{typeof h=="function"&&h(),N(!0)},[h]);return b.createElement(uPe,{showLabels:j,rects:s},b.createElement(pb,{animationId:g,begin:l,duration:c,isActive:o,easing:d,onAnimationEnd:S,onAnimationStart:_,key:g},A=>{var k=A===1?s:s==null?void 0:s.map((T,P)=>{var M=m&&m[P];if(M)return zs(zs({},T),{},{x:Rr(M.x,T.x,A),y:Rr(M.y,T.y,A),width:Rr(M.width,T.width,A),height:Rr(M.height,T.height,A)});if(i==="horizontal"){var O=Rr(0,T.height,A),D=Rr(T.stackedBarStart,T.y,A);return zs(zs({},T),{},{y:D,height:O})}var L=Rr(0,T.width,A),$=Rr(T.stackedBarStart,T.x,A);return zs(zs({},T),{},{width:L,x:$})});return A>0&&(r.current=k??null),k==null?null:b.createElement(Gs,null,b.createElement(mPe,{props:n,data:k}))}),b.createElement(WW,{label:n.label}),n.children)}function xPe(t){var n=b.useRef(null);return b.createElement(pPe,{previousRectanglesRef:n,props:t})}var cq=0,gPe=(t,n)=>{var r=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:r,errorVal:Xn(t,n)}};class yPe extends b.PureComponent{render(){var{hide:n,data:r,dataKey:s,className:i,xAxisId:o,yAxisId:l,needClip:c,background:d,id:u}=this.props;if(n||r==null)return null;var h=cn("recharts-bar",i),m=u;return b.createElement(Gs,{className:h,id:u},c&&b.createElement("defs",null,b.createElement(ZIe,{clipPathId:m,xAxisId:o,yAxisId:l})),b.createElement(Gs,{className:"recharts-bar-rectangles",clipPath:c?"url(#clipPath-".concat(m,")"):void 0},b.createElement(dPe,{data:r,dataKey:s,background:d,allOtherBarProps:this.props}),b.createElement(xPe,this.props)))}}var vPe={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!Iu.isSsr,legendType:"rect",minPointSize:cq,xAxisId:0,yAxisId:0,zIndex:Is.bar};function bPe(t){var{xAxisId:n,yAxisId:r,hide:s,legendType:i,minPointSize:o,activeBar:l,animationBegin:c,animationDuration:d,animationEasing:u,isAnimationActive:h}=t,{needClip:m}=lq(n,r),g=hb(),y=Ua(),N=pk(t.children,xo),j=mt(A=>KPe(A,n,r,y,t.id,N));if(g!=="vertical"&&g!=="horizontal")return null;var S,_=j==null?void 0:j[0];return _==null||_.height==null||_.width==null?S=0:S=g==="vertical"?_.height/2:_.width/2,b.createElement(QIe,{xAxisId:n,yAxisId:r,data:j,dataPointFormatter:gPe,errorBarOffset:S},b.createElement(yPe,jl({},t,{layout:g,needClip:m,data:j,xAxisId:n,yAxisId:r,hide:s,legendType:i,minPointSize:o,activeBar:l,animationBegin:c,animationDuration:d,animationEasing:u,isAnimationActive:h})))}function wPe(t){var{layout:n,barSettings:{dataKey:r,minPointSize:s},pos:i,bandSize:o,xAxis:l,yAxis:c,xAxisTicks:d,yAxisTicks:u,stackedData:h,displayedData:m,offset:g,cells:y,parentViewBox:N,dataStartIndex:j}=t,S=n==="horizontal"?c:l,_=h?S.scale.domain():null,A=oje({numericAxis:S}),k=S.scale(A);return m.map((T,P)=>{var M,O,D,L,$,V;h?M=tje(h[P+j],_):(M=Xn(T,r),Array.isArray(M)||(M=[A,M]));var F=VIe(s,cq)(M[1],P);if(n==="horizontal"){var Q,[U,z]=[c.scale(M[0]),c.scale(M[1])];O=h4({axis:l,ticks:d,bandSize:o,offset:i.offset,entry:T,index:P}),D=(Q=z??U)!==null&&Q!==void 0?Q:void 0,L=i.size;var q=U-z;if($=Po(q)?0:q,V={x:O,y:g.top,width:L,height:g.height},Math.abs(F)>0&&Math.abs($)<Math.abs(F)){var K=ps($||F)*(Math.abs(F)-Math.abs($));D-=K,$+=K}}else{var[X,J]=[l.scale(M[0]),l.scale(M[1])];if(O=X,D=h4({axis:c,ticks:u,bandSize:o,offset:i.offset,entry:T,index:P}),L=J-X,$=i.size,V={x:g.left,y:D,width:g.width,height:$},Math.abs(F)>0&&Math.abs(L)<Math.abs(F)){var ne=ps(L||F)*(Math.abs(F)-Math.abs(L));L+=ne}}if(O==null||D==null||L==null||$==null)return null;var Se=zs(zs({},T),{},{stackedBarStart:k,x:O,y:D,width:L,height:$,value:h?M:M[1],payload:T,background:V,tooltipPosition:{x:O+L/2,y:D+$/2},parentViewBox:N},y&&y[P]&&y[P].props);return Se}).filter(Boolean)}function NPe(t){var n=Xs(t,vPe),r=Ua();return b.createElement(rq,{id:n.id,type:"bar"},s=>b.createElement(b.Fragment,null,b.createElement(B5e,{legendPayload:lPe(n)}),b.createElement(tq,{fn:cPe,args:n}),b.createElement(X5e,{type:"bar",id:s,data:void 0,xAxisId:n.xAxisId,yAxisId:n.yAxisId,zAxisId:0,dataKey:n.dataKey,stackId:ije(n.stackId),hide:n.hide,barSize:n.barSize,minPointSize:n.minPointSize,maxBarSize:n.maxBarSize,isPanorama:r}),b.createElement(Fo,{zIndex:n.zIndex},b.createElement(bPe,jl({},n,{id:s})))))}var Jp=b.memo(NPe);Jp.displayName="Bar";function bD(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function tg(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?bD(Object(r),!0).forEach(function(s){jPe(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function jPe(t,n,r){return(n=SPe(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function SPe(t){var n=CPe(t,"string");return typeof n=="symbol"?n:n+""}function CPe(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var _Pe=(t,n)=>n,APe=(t,n,r)=>r,EPe=(t,n,r,s)=>s,kPe=(t,n,r,s,i)=>i,Lx=je([D3,kPe],(t,n)=>t.filter(r=>r.type==="bar").find(r=>r.id===n)),TPe=je([Lx],t=>t==null?void 0:t.maxBarSize),IPe=(t,n,r,s,i,o)=>o,wD=(t,n,r)=>{var s=r??t;if(!es(s))return Ms(s,n,0)},PPe=je([rn,D3,_Pe,APe,EPe],(t,n,r,s,i)=>n.filter(o=>t==="horizontal"?o.xAxisId===r:o.yAxisId===s).filter(o=>o.isPanorama===i).filter(o=>o.hide===!1).filter(o=>o.type==="bar")),MPe=(t,n,r,s)=>{var i=rn(t);return i==="horizontal"?jC(t,"yAxis",r,s):jC(t,"xAxis",n,s)},OPe=(t,n,r)=>{var s=rn(t);return s==="horizontal"?IO(t,"xAxis",n):IO(t,"yAxis",r)},DPe=(t,n,r)=>{var s={},i=t.filter(_b),o=t.filter(u=>u.stackId==null),l=i.reduce((u,h)=>(u[h.stackId]||(u[h.stackId]=[]),u[h.stackId].push(h),u),s),c=Object.entries(l).map(u=>{var[h,m]=u,g=m.map(N=>N.dataKey),y=wD(n,r,m[0].barSize);return{stackId:h,dataKeys:g,barSize:y}}),d=o.map(u=>{var h=[u.dataKey].filter(g=>g!=null),m=wD(n,r,u.barSize);return{stackId:void 0,dataKeys:h,barSize:m}});return[...c,...d]},RPe=je([PPe,GAe,OPe],DPe),LPe=(t,n,r,s,i)=>{var o,l,c=Lx(t,n,r,s,i);if(c!=null){var d=rn(t),u=gH(t),{maxBarSize:h}=c,m=es(h)?u:h,g,y;return d==="horizontal"?(g=oh(t,"xAxis",n,s),y=ih(t,"xAxis",n,s)):(g=oh(t,"yAxis",r,s),y=ih(t,"yAxis",r,s)),(o=(l=iy(g,y,!0))!==null&&l!==void 0?l:m)!==null&&o!==void 0?o:0}},dq=(t,n,r,s)=>{var i=rn(t),o,l;return i==="horizontal"?(o=oh(t,"xAxis",n,s),l=ih(t,"xAxis",n,s)):(o=oh(t,"yAxis",r,s),l=ih(t,"yAxis",r,s)),iy(o,l)};function BPe(t,n,r,s,i){var o=s.length;if(!(o<1)){var l=Ms(t,r,0,!0),c,d=[];if(yr(s[0].barSize)){var u=!1,h=r/o,m=s.reduce((_,A)=>_+(A.barSize||0),0);m+=(o-1)*l,m>=r&&(m-=(o-1)*l,l=0),m>=r&&h>0&&(u=!0,h*=.9,m=o*h);var g=(r-m)/2>>0,y={offset:g-l,size:0};c=s.reduce((_,A)=>{var k,T={stackId:A.stackId,dataKeys:A.dataKeys,position:{offset:y.offset+y.size+l,size:u?h:(k=A.barSize)!==null&&k!==void 0?k:0}},P=[..._,T];return y=P[P.length-1].position,P},d)}else{var N=Ms(n,r,0,!0);r-2*N-(o-1)*l<=0&&(l=0);var j=(r-2*N-(o-1)*l)/o;j>1&&(j>>=0);var S=yr(i)?Math.min(j,i):j;c=s.reduce((_,A,k)=>[..._,{stackId:A.stackId,dataKeys:A.dataKeys,position:{offset:N+(j+l)*k+(j-S)/2,size:S}}],d)}return c}}var FPe=(t,n,r,s,i,o,l)=>{var c=es(l)?n:l,d=BPe(r,s,i!==o?i:o,t,c);return i!==o&&d!=null&&(d=d.map(u=>tg(tg({},u),{},{position:tg(tg({},u.position),{},{offset:u.position.offset-i/2})}))),d},$Pe=je([RPe,gH,qAe,yH,LPe,dq,TPe],FPe),zPe=(t,n,r,s)=>oh(t,"xAxis",n,s),UPe=(t,n,r,s)=>oh(t,"yAxis",r,s),VPe=(t,n,r,s)=>ih(t,"xAxis",n,s),HPe=(t,n,r,s)=>ih(t,"yAxis",r,s),WPe=je([$Pe,Lx],(t,n)=>{if(!(t==null||n==null)){var r=t.find(s=>s.stackId===n.stackId&&n.dataKey!=null&&s.dataKeys.includes(n.dataKey));if(r!=null)return r.position}}),qPe=(t,n)=>{var r=P3(n);if(!(!t||r==null||n==null)){var{stackId:s}=n;if(s!=null){var i=t[s];if(i){var{stackedData:o}=i;if(o)return o.find(l=>l.key===r)}}}},GPe=je([MPe,Lx],qPe),KPe=je([Vr,XE,zPe,UPe,VPe,HPe,WPe,rn,j3,dq,GPe,Lx,IPe],(t,n,r,s,i,o,l,c,d,u,h,m,g)=>{var{chartData:y,dataStartIndex:N,dataEndIndex:j}=d;if(!(m==null||l==null||n==null||c!=="horizontal"&&c!=="vertical"||r==null||s==null||i==null||o==null||u==null)){var{data:S}=m,_;if(S!=null&&S.length>0?_=S:_=y==null?void 0:y.slice(N,j+1),_!=null)return wPe({layout:c,barSettings:m,pos:l,parentViewBox:n,bandSize:u,xAxis:r,yAxis:s,xAxisTicks:i,yAxisTicks:o,stackedData:h,displayedData:_,offset:t,cells:g,dataStartIndex:N})}}),uq=t=>{var{chartData:n}=t,r=Vn(),s=Ua();return b.useEffect(()=>s?()=>{}:(r(UO(n)),()=>{r(UO(void 0))}),[n,r,s]),null},ND={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},fq=ga({name:"brush",initialState:ND,reducers:{setBrushSettings(t,n){return n.payload==null?ND:n.payload}}}),{setBrushSettings:r6e}=fq.actions,YPe=fq.reducer;function XPe(t,n,r){return(n=QPe(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function QPe(t){var n=ZPe(t,"string");return typeof n=="symbol"?n:n+""}function ZPe(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}class bk{static create(n){return new bk(n)}constructor(n){this.scale=n}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(n){var{bandAware:r,position:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(n!==void 0){if(s)switch(s){case"start":return this.scale(n);case"middle":{var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+i}case"end":{var o=this.bandwidth?this.bandwidth():0;return this.scale(n)+o}default:return this.scale(n)}if(r){var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+l}return this.scale(n)}}isInRange(n){var r=this.range(),s=r[0],i=r[r.length-1];return s<=i?n>=s&&n<=i:n>=i&&n<=s}}XPe(bk,"EPS",1e-4);function JPe(t){return(t%180+180)%180}var eMe=function(n){var{width:r,height:s}=n,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=JPe(i),l=o*Math.PI/180,c=Math.atan(s/r),d=l>c&&l<Math.PI-c?s/Math.sin(l):r/Math.cos(l);return Math.abs(d)},tMe={dots:[],areas:[],lines:[]},hq=ga({name:"referenceElements",initialState:tMe,reducers:{addDot:(t,n)=>{t.dots.push(n.payload)},removeDot:(t,n)=>{var r=il(t).dots.findIndex(s=>s===n.payload);r!==-1&&t.dots.splice(r,1)},addArea:(t,n)=>{t.areas.push(n.payload)},removeArea:(t,n)=>{var r=il(t).areas.findIndex(s=>s===n.payload);r!==-1&&t.areas.splice(r,1)},addLine:(t,n)=>{t.lines.push(n.payload)},removeLine:(t,n)=>{var r=il(t).lines.findIndex(s=>s===n.payload);r!==-1&&t.lines.splice(r,1)}}}),{addDot:s6e,removeDot:a6e,addArea:i6e,removeArea:o6e,addLine:l6e,removeLine:c6e}=hq.actions,nMe=hq.reducer,rMe=b.createContext(void 0),sMe=t=>{var{children:n}=t,[r]=b.useState("".concat(Up("recharts"),"-clip")),s=iq();if(s==null)return null;var{x:i,y:o,width:l,height:c}=s;return b.createElement(rMe.Provider,{value:r},b.createElement("defs",null,b.createElement("clipPath",{id:r},b.createElement("rect",{x:i,y:o,height:c,width:l}))),n)};function lh(t,n){for(var r in t)if({}.hasOwnProperty.call(t,r)&&(!{}.hasOwnProperty.call(n,r)||t[r]!==n[r]))return!1;for(var s in n)if({}.hasOwnProperty.call(n,s)&&!{}.hasOwnProperty.call(t,s))return!1;return!0}function mq(t,n){if(n<1)return[];if(n===1)return t;for(var r=[],s=0;s<t.length;s+=n)r.push(t[s]);return r}function aMe(t,n,r){var s={width:t.width+n.width,height:t.height+n.height};return eMe(s,r)}function iMe(t,n,r){var s=r==="width",{x:i,y:o,width:l,height:c}=t;return n===1?{start:s?i:o,end:s?i+l:o+c}:{start:s?i+l:o+c,end:s?i:o}}function Iy(t,n,r,s,i){if(t*n<t*s||t*n>t*i)return!1;var o=r();return t*(n-t*o/2-s)>=0&&t*(n+t*o/2-i)<=0}function oMe(t,n){return mq(t,n+1)}function lMe(t,n,r,s,i){for(var o=(s||[]).slice(),{start:l,end:c}=n,d=0,u=1,h=l,m=function(){var N=s==null?void 0:s[d];if(N===void 0)return{v:mq(s,u)};var j=d,S,_=()=>(S===void 0&&(S=r(N,j)),S),A=N.coordinate,k=d===0||Iy(t,A,_,h,c);k||(d=0,h=l,u+=1),k&&(h=A+t*(_()/2+i),d+=u)},g;u<=o.length;)if(g=m(),g)return g.v;return[]}function jD(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function Cs(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?jD(Object(r),!0).forEach(function(s){cMe(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function cMe(t,n,r){return(n=dMe(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function dMe(t){var n=uMe(t,"string");return typeof n=="symbol"?n:n+""}function uMe(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function fMe(t,n,r,s,i){for(var o=(s||[]).slice(),l=o.length,{start:c}=n,{end:d}=n,u=function(g){var y=o[g],N,j=()=>(N===void 0&&(N=r(y,g)),N);if(g===l-1){var S=t*(y.coordinate+t*j()/2-d);o[g]=y=Cs(Cs({},y),{},{tickCoord:S>0?y.coordinate-S*t:y.coordinate})}else o[g]=y=Cs(Cs({},y),{},{tickCoord:y.coordinate});if(y.tickCoord!=null){var _=Iy(t,y.tickCoord,j,c,d);_&&(d=y.tickCoord-t*(j()/2+i),o[g]=Cs(Cs({},y),{},{isShow:!0}))}},h=l-1;h>=0;h--)u(h);return o}function hMe(t,n,r,s,i,o){var l=(s||[]).slice(),c=l.length,{start:d,end:u}=n;if(o){var h=s[c-1],m=r(h,c-1),g=t*(h.coordinate+t*m/2-u);if(l[c-1]=h=Cs(Cs({},h),{},{tickCoord:g>0?h.coordinate-g*t:h.coordinate}),h.tickCoord!=null){var y=Iy(t,h.tickCoord,()=>m,d,u);y&&(u=h.tickCoord-t*(m/2+i),l[c-1]=Cs(Cs({},h),{},{isShow:!0}))}}for(var N=o?c-1:c,j=function(A){var k=l[A],T,P=()=>(T===void 0&&(T=r(k,A)),T);if(A===0){var M=t*(k.coordinate-t*P()/2-d);l[A]=k=Cs(Cs({},k),{},{tickCoord:M<0?k.coordinate-M*t:k.coordinate})}else l[A]=k=Cs(Cs({},k),{},{tickCoord:k.coordinate});if(k.tickCoord!=null){var O=Iy(t,k.tickCoord,P,d,u);O&&(d=k.tickCoord+t*(P()/2+i),l[A]=Cs(Cs({},k),{},{isShow:!0}))}},S=0;S<N;S++)j(S);return l}function mMe(t,n,r){var{tick:s,ticks:i,viewBox:o,minTickGap:l,orientation:c,interval:d,tickFormatter:u,unit:h,angle:m}=t;if(!i||!i.length||!s)return[];if(vt(d)||Iu.isSsr){var g;return(g=oMe(i,vt(d)?d:0))!==null&&g!==void 0?g:[]}var y=[],N=c==="top"||c==="bottom"?"width":"height",j=h&&N==="width"?Zm(h,{fontSize:n,letterSpacing:r}):{width:0,height:0},S=(k,T)=>{var P=typeof u=="function"?u(k.value,T):k.value;return N==="width"?aMe(Zm(P,{fontSize:n,letterSpacing:r}),j,m):Zm(P,{fontSize:n,letterSpacing:r})[N]},_=i.length>=2?ps(i[1].coordinate-i[0].coordinate):1,A=iMe(o,_,N);return d==="equidistantPreserveStart"?lMe(_,A,S,i,l):(d==="preserveStart"||d==="preserveStartEnd"?y=hMe(_,A,S,i,l,d==="preserveStartEnd"):y=fMe(_,A,S,i,l),y.filter(k=>k.isShow))}var pMe=t=>{var{ticks:n,label:r,labelGapWithTick:s=5,tickSize:i=0,tickMargin:o=0}=t,l=0;if(n){Array.from(n).forEach(h=>{if(h){var m=h.getBoundingClientRect();m.width>l&&(l=m.width)}});var c=r?r.getBoundingClientRect().width:0,d=i+o,u=l+d+c+(r?s:0);return Math.round(u)}return 0},xMe=["axisLine","width","height","className","hide","ticks","axisType"],gMe=["viewBox"],yMe=["viewBox"];function IC(t,n){if(t==null)return{};var r,s,i=vMe(t,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],n.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function vMe(t,n){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(n.indexOf(s)!==-1)continue;r[s]=t[s]}return r}function vu(){return vu=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},vu.apply(null,arguments)}function SD(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function br(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?SD(Object(r),!0).forEach(function(s){bMe(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):SD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function bMe(t,n,r){return(n=wMe(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function wMe(t){var n=NMe(t,"string");return typeof n=="symbol"?n:n+""}function NMe(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var jMe={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:Is.axis};function SMe(t){var{x:n,y:r,width:s,height:i,orientation:o,mirror:l,axisLine:c,otherSvgProps:d}=t;if(!c)return null;var u=br(br(br({},d),Io(c)),{},{fill:"none"});if(o==="top"||o==="bottom"){var h=+(o==="top"&&!l||o==="bottom"&&l);u=br(br({},u),{},{x1:n,y1:r+h*i,x2:n+s,y2:r+h*i})}else{var m=+(o==="left"&&!l||o==="right"&&l);u=br(br({},u),{},{x1:n+m*s,y1:r,x2:n+m*s,y2:r+i})}return b.createElement("line",vu({},u,{className:cn("recharts-cartesian-axis-line",hu(c,"className"))}))}function CMe(t,n,r,s,i,o,l,c,d){var u,h,m,g,y,N,j=c?-1:1,S=t.tickSize||l,_=vt(t.tickCoord)?t.tickCoord:t.coordinate;switch(o){case"top":u=h=t.coordinate,g=r+ +!c*i,m=g-j*S,N=m-j*d,y=_;break;case"left":m=g=t.coordinate,h=n+ +!c*s,u=h-j*S,y=u-j*d,N=_;break;case"right":m=g=t.coordinate,h=n+ +c*s,u=h+j*S,y=u+j*d,N=_;break;default:u=h=t.coordinate,g=r+ +c*i,m=g+j*S,N=m+j*d,y=_;break}return{line:{x1:u,y1:m,x2:h,y2:g},tick:{x:y,y:N}}}function _Me(t,n){switch(t){case"left":return n?"start":"end";case"right":return n?"end":"start";default:return"middle"}}function AMe(t,n){switch(t){case"left":case"right":return"middle";case"top":return n?"start":"end";default:return n?"end":"start"}}function EMe(t){var{option:n,tickProps:r,value:s}=t,i,o=cn(r.className,"recharts-cartesian-axis-tick-value");if(b.isValidElement(n))i=b.cloneElement(n,br(br({},r),{},{className:o}));else if(typeof n=="function")i=n(br(br({},r),{},{className:o}));else{var l="recharts-cartesian-axis-tick-value";typeof n!="boolean"&&(l=cn(l,n==null?void 0:n.className)),i=b.createElement(Ob,vu({},r,{className:l}),s)}return i}var kMe=b.forwardRef((t,n)=>{var{ticks:r=[],tick:s,tickLine:i,stroke:o,tickFormatter:l,unit:c,padding:d,tickTextProps:u,orientation:h,mirror:m,x:g,y,width:N,height:j,tickSize:S,tickMargin:_,fontSize:A,letterSpacing:k,getTicksConfig:T,events:P,axisType:M}=t,O=mMe(br(br({},T),{},{ticks:r}),A,k),D=_Me(h,m),L=AMe(h,m),$=Io(T),V=zp(s),F={};typeof i=="object"&&(F=i);var Q=br(br({},$),{},{fill:"none"},F),U=O.map(K=>br({entry:K},CMe(K,g,y,N,j,h,S,m,_))),z=U.map(K=>{var{entry:X,line:J}=K;return b.createElement(Gs,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(X.value,"-").concat(X.coordinate,"-").concat(X.tickCoord)},i&&b.createElement("line",vu({},Q,J,{className:cn("recharts-cartesian-axis-tick-line",hu(i,"className"))})))}),q=U.map((K,X)=>{var{entry:J,tick:ne}=K,Se=br(br(br(br({textAnchor:D,verticalAnchor:L},$),{},{stroke:"none",fill:o},V),ne),{},{index:X,payload:J,visibleTicksCount:O.length,tickFormatter:l,padding:d},u);return b.createElement(Gs,vu({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(J.value,"-").concat(J.coordinate,"-").concat(J.tickCoord)},Jv(P,J,X)),s&&b.createElement(EMe,{option:s,tickProps:Se,value:"".concat(typeof l=="function"?l(J.value,X):J.value).concat(c||"")}))});return b.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(M,"-ticks")},q.length>0&&b.createElement(Fo,{zIndex:Is.label},b.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(M,"-tick-labels"),ref:n},q)),z.length>0&&b.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(M,"-tick-lines")},z))}),TMe=b.forwardRef((t,n)=>{var{axisLine:r,width:s,height:i,className:o,hide:l,ticks:c,axisType:d}=t,u=IC(t,xMe),[h,m]=b.useState(""),[g,y]=b.useState(""),N=b.useRef(null);b.useImperativeHandle(n,()=>({getCalculatedWidth:()=>{var S;return pMe({ticks:N.current,label:(S=t.labelRef)===null||S===void 0?void 0:S.current,labelGapWithTick:5,tickSize:t.tickSize,tickMargin:t.tickMargin})}}));var j=b.useCallback(S=>{if(S){var _=S.getElementsByClassName("recharts-cartesian-axis-tick-value");N.current=_;var A=_[0];if(A){var k=window.getComputedStyle(A),T=k.fontSize,P=k.letterSpacing;(T!==h||P!==g)&&(m(T),y(P))}}},[h,g]);return l||s!=null&&s<=0||i!=null&&i<=0?null:b.createElement(Fo,{zIndex:t.zIndex},b.createElement(Gs,{className:cn("recharts-cartesian-axis",o)},b.createElement(SMe,{x:t.x,y:t.y,width:s,height:i,orientation:t.orientation,mirror:t.mirror,axisLine:r,otherSvgProps:Io(t)}),b.createElement(kMe,{ref:j,axisType:d,events:u,fontSize:h,getTicksConfig:t,height:t.height,letterSpacing:g,mirror:t.mirror,orientation:t.orientation,padding:t.padding,stroke:t.stroke,tick:t.tick,tickFormatter:t.tickFormatter,tickLine:t.tickLine,tickMargin:t.tickMargin,tickSize:t.tickSize,tickTextProps:t.tickTextProps,ticks:c,unit:t.unit,width:t.width,x:t.x,y:t.y}),b.createElement(OTe,{x:t.x,y:t.y,width:t.width,height:t.height,lowerWidth:t.width,upperWidth:t.width},b.createElement(HTe,{label:t.label,labelRef:t.labelRef}),t.children)))}),IMe=b.memo(TMe,(t,n)=>{var{viewBox:r}=t,s=IC(t,gMe),{viewBox:i}=n,o=IC(n,yMe);return lh(r,i)&&lh(s,o)}),wk=b.forwardRef((t,n)=>{var r=Xs(t,jMe);return b.createElement(IMe,vu({},r,{ref:n}))});wk.displayName="CartesianAxis";var PMe=["dangerouslySetInnerHTML","ticks"],MMe=["id"],OMe=["domain"],DMe=["domain"];function PC(){return PC=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},PC.apply(null,arguments)}function Py(t,n){if(t==null)return{};var r,s,i=RMe(t,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],n.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function RMe(t,n){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(n.indexOf(s)!==-1)continue;r[s]=t[s]}return r}function LMe(t){var n=Vn();return b.useLayoutEffect(()=>(n(_Ie(t)),()=>{n(AIe(t))}),[t,n]),null}var BMe=t=>{var{xAxisId:n,className:r}=t,s=mt(XE),i=Ua(),o="xAxis",l=mt(S=>Oh(S,o,n,i)),c=mt(S=>XH(S,o,n,i)),d=mt(S=>qH(S,n)),u=mt(S=>HEe(S,n)),h=mt(S=>_H(S,n));if(d==null||u==null||h==null)return null;var{dangerouslySetInnerHTML:m,ticks:g}=t,y=Py(t,PMe),{id:N}=h,j=Py(h,MMe);return b.createElement(wk,PC({},y,j,{scale:l,x:u.x,y:u.y,width:d.width,height:d.height,className:cn("recharts-".concat(o," ").concat(o),r),viewBox:s,ticks:c,axisType:o}))},FMe={allowDataOverflow:va.allowDataOverflow,allowDecimals:va.allowDecimals,allowDuplicatedCategory:va.allowDuplicatedCategory,height:va.height,hide:!1,mirror:va.mirror,orientation:va.orientation,padding:va.padding,reversed:va.reversed,scale:va.scale,tickCount:va.tickCount,type:va.type,xAxisId:0},$Me=t=>{var n,r,s,i,o,l=Xs(t,FMe);return b.createElement(b.Fragment,null,b.createElement(LMe,{interval:(n=l.interval)!==null&&n!==void 0?n:"preserveEnd",id:l.xAxisId,scale:l.scale,type:l.type,padding:l.padding,allowDataOverflow:l.allowDataOverflow,domain:l.domain,dataKey:l.dataKey,allowDuplicatedCategory:l.allowDuplicatedCategory,allowDecimals:l.allowDecimals,tickCount:l.tickCount,includeHidden:(r=l.includeHidden)!==null&&r!==void 0?r:!1,reversed:l.reversed,ticks:l.ticks,height:l.height,orientation:l.orientation,mirror:l.mirror,hide:l.hide,unit:l.unit,name:l.name,angle:(s=l.angle)!==null&&s!==void 0?s:0,minTickGap:(i=l.minTickGap)!==null&&i!==void 0?i:5,tick:(o=l.tick)!==null&&o!==void 0?o:!0,tickFormatter:l.tickFormatter}),b.createElement(BMe,l))},zMe=(t,n)=>{var{domain:r}=t,s=Py(t,OMe),{domain:i}=n,o=Py(n,DMe);return lh(s,o)?Array.isArray(r)&&r.length===2&&Array.isArray(i)&&i.length===2?r[0]===i[0]&&r[1]===i[1]:lh({domain:r},{domain:i}):!1},ex=b.memo($Me,zMe);ex.displayName="XAxis";var UMe=["dangerouslySetInnerHTML","ticks"],VMe=["id"],HMe=["domain"],WMe=["domain"];function MC(){return MC=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},MC.apply(null,arguments)}function My(t,n){if(t==null)return{};var r,s,i=qMe(t,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],n.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function qMe(t,n){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(n.indexOf(s)!==-1)continue;r[s]=t[s]}return r}function GMe(t){var n=Vn();return b.useLayoutEffect(()=>(n(EIe(t)),()=>{n(kIe(t))}),[t,n]),null}var KMe=t=>{var{yAxisId:n,className:r,width:s,label:i}=t,o=b.useRef(null),l=b.useRef(null),c=mt(XE),d=Ua(),u=Vn(),h="yAxis",m=mt(P=>Oh(P,h,n,d)),g=mt(P=>GH(P,n)),y=mt(P=>qEe(P,n)),N=mt(P=>XH(P,h,n,d)),j=mt(P=>AH(P,n));if(b.useLayoutEffect(()=>{if(!(s!=="auto"||!g||ck(i)||b.isValidElement(i)||j==null)){var P=o.current;if(P){var M=P.getCalculatedWidth();Math.round(g.width)!==Math.round(M)&&u(TIe({id:n,width:M}))}}},[N,g,u,i,n,s,j]),g==null||y==null||j==null)return null;var{dangerouslySetInnerHTML:S,ticks:_}=t,A=My(t,UMe),{id:k}=j,T=My(j,VMe);return b.createElement(wk,MC({},A,T,{ref:o,labelRef:l,scale:m,x:y.x,y:y.y,tickTextProps:s==="auto"?{width:void 0}:{width:s},width:g.width,height:g.height,className:cn("recharts-".concat(h," ").concat(h),r),viewBox:c,ticks:N,axisType:h}))},YMe={allowDataOverflow:ba.allowDataOverflow,allowDecimals:ba.allowDecimals,allowDuplicatedCategory:ba.allowDuplicatedCategory,hide:!1,mirror:ba.mirror,orientation:ba.orientation,padding:ba.padding,reversed:ba.reversed,scale:ba.scale,tickCount:ba.tickCount,type:ba.type,width:ba.width,yAxisId:0},XMe=t=>{var n,r,s,i,o,l=Xs(t,YMe);return b.createElement(b.Fragment,null,b.createElement(GMe,{interval:(n=l.interval)!==null&&n!==void 0?n:"preserveEnd",id:l.yAxisId,scale:l.scale,type:l.type,domain:l.domain,allowDataOverflow:l.allowDataOverflow,dataKey:l.dataKey,allowDuplicatedCategory:l.allowDuplicatedCategory,allowDecimals:l.allowDecimals,tickCount:l.tickCount,padding:l.padding,includeHidden:(r=l.includeHidden)!==null&&r!==void 0?r:!1,reversed:l.reversed,ticks:l.ticks,width:l.width,orientation:l.orientation,mirror:l.mirror,hide:l.hide,unit:l.unit,name:l.name,angle:(s=l.angle)!==null&&s!==void 0?s:0,minTickGap:(i=l.minTickGap)!==null&&i!==void 0?i:5,tick:(o=l.tick)!==null&&o!==void 0?o:!0,tickFormatter:l.tickFormatter}),b.createElement(KMe,l))},QMe=(t,n)=>{var{domain:r}=t,s=My(t,HMe),{domain:i}=n,o=My(n,WMe);return lh(s,o)?Array.isArray(r)&&r.length===2&&Array.isArray(i)&&i.length===2?r[0]===i[0]&&r[1]===i[1]:lh({domain:r},{domain:i}):!1},tx=b.memo(XMe,QMe);tx.displayName="YAxis";var ZMe={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bx=b;function JMe(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var e4e=typeof Object.is=="function"?Object.is:JMe,t4e=Bx.useSyncExternalStore,n4e=Bx.useRef,r4e=Bx.useEffect,s4e=Bx.useMemo,a4e=Bx.useDebugValue;ZMe.useSyncExternalStoreWithSelector=function(t,n,r,s,i){var o=n4e(null);if(o.current===null){var l={hasValue:!1,value:null};o.current=l}else l=o.current;o=s4e(function(){function d(y){if(!u){if(u=!0,h=y,y=s(y),i!==void 0&&l.hasValue){var N=l.value;if(i(N,y))return m=N}return m=y}if(N=m,e4e(h,y))return N;var j=s(y);return i!==void 0&&i(N,j)?(h=y,N):(h=y,m=j)}var u=!1,h,m,g=r===void 0?null:r;return[function(){return d(n())},g===null?void 0:function(){return d(g())}]},[n,r,s,i]);var c=t4e(t,o[0],o[1]);return r4e(function(){l.hasValue=!0,l.value=c},[c]),a4e(c),c};function i4e(t){t()}function o4e(){let t=null,n=null;return{clear(){t=null,n=null},notify(){i4e(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let s=t;for(;s;)r.push(s),s=s.next;return r},subscribe(r){let s=!0;const i=n={callback:r,next:null,prev:n};return i.prev?i.prev.next=i:t=i,function(){!s||t===null||(s=!1,i.next?i.next.prev=i.prev:n=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}var CD={notify(){},get:()=>[]};function l4e(t,n){let r,s=CD,i=0,o=!1;function l(j){h();const S=s.subscribe(j);let _=!1;return()=>{_||(_=!0,S(),m())}}function c(){s.notify()}function d(){N.onStateChange&&N.onStateChange()}function u(){return o}function h(){i++,r||(r=t.subscribe(d),s=o4e())}function m(){i--,r&&i===0&&(r(),r=void 0,s.clear(),s=CD)}function g(){o||(o=!0,h())}function y(){o&&(o=!1,m())}const N={addNestedSub:l,notifyNestedSubs:c,handleChangeWrapper:d,isSubscribed:u,trySubscribe:g,tryUnsubscribe:y,getListeners:()=>s};return N}var c4e=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",d4e=c4e(),u4e=()=>typeof navigator<"u"&&navigator.product==="ReactNative",f4e=u4e(),h4e=()=>d4e||f4e?b.useLayoutEffect:b.useEffect,m4e=h4e(),f2=Symbol.for("react-redux-context"),h2=typeof globalThis<"u"?globalThis:{};function p4e(){if(!b.createContext)return{};const t=h2[f2]??(h2[f2]=new Map);let n=t.get(b.createContext);return n||(n=b.createContext(null),t.set(b.createContext,n)),n}var x4e=p4e();function g4e(t){const{children:n,context:r,serverState:s,store:i}=t,o=b.useMemo(()=>{const d=l4e(i);return{store:i,subscription:d,getServerState:s?()=>s:void 0}},[i,s]),l=b.useMemo(()=>i.getState(),[i]);m4e(()=>{const{subscription:d}=o;return d.onStateChange=d.notifyNestedSubs,d.trySubscribe(),l!==i.getState()&&d.notifyNestedSubs(),()=>{d.tryUnsubscribe(),d.onStateChange=void 0}},[o,l]);const c=r||x4e;return b.createElement(c.Provider,{value:o},n)}var y4e=g4e,v4e=(t,n)=>n,Nk=je([v4e,rn,SH,Wr,hW,Ol,nke,Vr],cke),jk=t=>{var n=t.currentTarget.getBoundingClientRect(),r=n.width/t.currentTarget.offsetWidth,s=n.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-n.left)/r),chartY:Math.round((t.clientY-n.top)/s)}},pq=pi("mouseClick"),xq=Sx();xq.startListening({actionCreator:pq,effect:(t,n)=>{var r=t.payload,s=Nk(n.getState(),jk(r));(s==null?void 0:s.activeIndex)!=null&&n.dispatch(a3e({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate}))}});var OC=pi("mouseMove"),gq=Sx();gq.startListening({actionCreator:OC,effect:(t,n)=>{var r=t.payload,s=n.getState(),i=ek(s,s.tooltip.settings.shared),o=Nk(s,jk(r));i==="axis"&&((o==null?void 0:o.activeIndex)!=null?n.dispatch(sW({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):n.dispatch(rW()))}});var _D={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0},yq=ga({name:"rootProps",initialState:_D,reducers:{updateOptions:(t,n)=>{var r;t.accessibilityLayer=n.payload.accessibilityLayer,t.barCategoryGap=n.payload.barCategoryGap,t.barGap=(r=n.payload.barGap)!==null&&r!==void 0?r:_D.barGap,t.barSize=n.payload.barSize,t.maxBarSize=n.payload.maxBarSize,t.stackOffset=n.payload.stackOffset,t.syncId=n.payload.syncId,t.syncMethod=n.payload.syncMethod,t.className=n.payload.className,t.baseValue=n.payload.baseValue}}}),b4e=yq.reducer,{updateOptions:w4e}=yq.actions,vq=ga({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(t,n)=>n.payload}}),{updatePolarOptions:N4e}=vq.actions,j4e=vq.reducer,bq=pi("keyDown"),wq=pi("focus"),Sk=Sx();Sk.startListening({actionCreator:bq,effect:(t,n)=>{var r=n.getState(),s=r.rootProps.accessibilityLayer!==!1;if(s){var{keyboardInteraction:i}=r.tooltip,o=t.payload;if(!(o!=="ArrowRight"&&o!=="ArrowLeft"&&o!=="Enter")){var l=Number(tk(i,Rh(r))),c=Ol(r);if(o==="Enter"){var d=Sy(r,"axis","hover",String(i.index));n.dispatch(CC({active:!i.active,activeIndex:i.index,activeDataKey:i.dataKey,activeCoordinate:d}));return}var u=XEe(r),h=u==="left-to-right"?1:-1,m=o==="ArrowRight"?1:-1,g=l+m*h;if(!(c==null||g>=c.length||g<0)){var y=Sy(r,"axis","hover",String(g));n.dispatch(CC({active:!0,activeIndex:g.toString(),activeDataKey:void 0,activeCoordinate:y}))}}}}});Sk.startListening({actionCreator:wq,effect:(t,n)=>{var r=n.getState(),s=r.rootProps.accessibilityLayer!==!1;if(s){var{keyboardInteraction:i}=r.tooltip;if(!i.active&&i.index==null){var o="0",l=Sy(r,"axis","hover",String(o));n.dispatch(CC({activeDataKey:void 0,active:!0,activeIndex:o,activeCoordinate:l}))}}}});var Ja=pi("externalEvent"),Nq=Sx();Nq.startListening({actionCreator:Ja,effect:(t,n)=>{if(t.payload.handler!=null){var r=n.getState(),s={activeCoordinate:z3e(r),activeDataKey:gW(r),activeIndex:yu(r),activeLabel:xW(r),activeTooltipIndex:yu(r),isTooltipActive:U3e(r)};t.payload.handler(s,t.payload.reactEvent)}}});var S4e=je([Dh],t=>t.tooltipItemPayloads),C4e=je([S4e,Dx,(t,n,r)=>n,(t,n,r)=>r],(t,n,r,s)=>{var i=t.find(c=>c.settings.dataKey===s);if(i!=null){var{positions:o}=i;if(o!=null){var l=n(o,r);return l}}}),jq=pi("touchMove"),Sq=Sx();Sq.startListening({actionCreator:jq,effect:(t,n)=>{var r=t.payload;if(!(r.touches==null||r.touches.length===0)){var s=n.getState(),i=ek(s,s.tooltip.settings.shared);if(i==="axis"){var o=Nk(s,jk({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));(o==null?void 0:o.activeIndex)!=null&&n.dispatch(sW({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(i==="item"){var l,c=r.touches[0];if(document.elementFromPoint==null)return;var d=document.elementFromPoint(c.clientX,c.clientY);if(!d||!d.getAttribute)return;var u=d.getAttribute(XU),h=(l=d.getAttribute(QU))!==null&&l!==void 0?l:void 0,m=C4e(n.getState(),u,h);n.dispatch(nW({activeDataKey:h,activeIndex:u,activeCoordinate:m}))}}}});var _4e=jU({brush:YPe,cartesianAxis:IIe,chartData:Fke,errorBars:WIe,graphicalItems:Y5e,layout:Y2e,legend:Vje,options:Oke,polarAxis:l5e,polarOptions:j4e,referenceElements:nMe,rootProps:b4e,tooltip:i3e,zIndex:jke}),A4e=function(n){return b2e({reducer:_4e,preloadedState:n,middleware:r=>r({serializableCheck:!1}).concat([xq.middleware,gq.middleware,Sk.middleware,Nq.middleware,Sq.middleware]),enhancers:r=>{var s=r;return typeof r=="function"&&(s=r()),s.concat(DU({type:"raf"}))},devTools:Iu.devToolsEnabled})};function Cq(t){var{preloadedState:n,children:r,reduxStoreName:s}=t,i=Ua(),o=b.useRef(null);if(i)return r;o.current==null&&(o.current=A4e(n));var l=UE;return b.createElement(y4e,{context:l,store:o.current},r)}function _q(t){var{layout:n,margin:r}=t,s=Vn(),i=Ua();return b.useEffect(()=>{i||(s(q2e(n)),s(W2e(r)))},[s,i,n,r]),null}function Aq(t){var n=Vn();return b.useEffect(()=>{n(w4e(t))},[n,t]),null}function AD(t){var{zIndex:n,isPanorama:r}=t,s=r?"recharts-zindex-panorama-":"recharts-zindex-",i=nq("".concat(s).concat(n)),o=Vn();return b.useLayoutEffect(()=>(o(wke({zIndex:n,elementId:i,isPanorama:r})),()=>{o(Nke({zIndex:n,isPanorama:r}))}),[o,n,i,r]),b.createElement("g",{id:i})}function ED(t){var{children:n,isPanorama:r}=t,s=mt(uke);if(!s||s.length===0)return n;var i=s.filter(l=>l<0),o=s.filter(l=>l>0);return b.createElement(b.Fragment,null,i.map(l=>b.createElement(AD,{key:l,zIndex:l,isPanorama:r})),n,o.map(l=>b.createElement(AD,{key:l,zIndex:l,isPanorama:r})))}var E4e=["children"];function k4e(t,n){if(t==null)return{};var r,s,i=T4e(t,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],n.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function T4e(t,n){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(n.indexOf(s)!==-1)continue;r[s]=t[s]}return r}function Oy(){return Oy=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Oy.apply(null,arguments)}var I4e={width:"100%",height:"100%",display:"block"},P4e=b.forwardRef((t,n)=>{var r=Fje(),s=$je(),i=lV();if(!Lc(r)||!Lc(s))return null;var{children:o,otherAttributes:l,title:c,desc:d}=t,u,h;return l!=null&&(typeof l.tabIndex=="number"?u=l.tabIndex:u=i?0:void 0,typeof l.role=="string"?h=l.role:h=i?"application":void 0),b.createElement(kz,Oy({},l,{title:c,desc:d,role:h,tabIndex:u,width:r,height:s,style:I4e,ref:n}),o)}),M4e=t=>{var{children:n}=t,r=mt(ub);if(!r)return null;var{width:s,height:i,y:o,x:l}=r;return b.createElement(kz,{width:s,height:i,x:l,y:o},n)},kD=b.forwardRef((t,n)=>{var{children:r}=t,s=k4e(t,E4e),i=Ua();return i?b.createElement(M4e,null,b.createElement(ED,{isPanorama:!0},r)):b.createElement(P4e,Oy({ref:n},s),b.createElement(ED,{isPanorama:!1},r))});function O4e(){var t=Vn(),[n,r]=b.useState(null),s=mt(hje);return b.useEffect(()=>{if(n!=null){var i=n.getBoundingClientRect(),o=i.width/n.offsetWidth;yr(o)&&o!==s&&t(K2e(o))}},[n,t,s]),r}function TD(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function D4e(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?TD(Object(r),!0).forEach(function(s){R4e(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):TD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function R4e(t,n,r){return(n=L4e(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function L4e(t){var n=B4e(t,"string");return typeof n=="symbol"?n:n+""}function B4e(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function bu(){return bu=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},bu.apply(null,arguments)}var F4e=()=>(Kke(),null);function Dy(t){if(typeof t=="number")return t;if(typeof t=="string"){var n=parseFloat(t);if(!Number.isNaN(n))return n}return 0}var $4e=b.forwardRef((t,n)=>{var r,s,i=b.useRef(null),[o,l]=b.useState({containerWidth:Dy((r=t.style)===null||r===void 0?void 0:r.width),containerHeight:Dy((s=t.style)===null||s===void 0?void 0:s.height)}),c=b.useCallback((u,h)=>{l(m=>{var g=Math.round(u),y=Math.round(h);return m.containerWidth===g&&m.containerHeight===y?m:{containerWidth:g,containerHeight:y}})},[]),d=b.useCallback(u=>{if(typeof n=="function"&&n(u),u!=null&&typeof ResizeObserver<"u"){var{width:h,height:m}=u.getBoundingClientRect();c(h,m);var g=N=>{var{width:j,height:S}=N[0].contentRect;c(j,S)},y=new ResizeObserver(g);y.observe(u),i.current=y}},[n,c]);return b.useEffect(()=>()=>{var u=i.current;u!=null&&u.disconnect()},[c]),b.createElement(b.Fragment,null,b.createElement(mb,{width:o.containerWidth,height:o.containerHeight}),b.createElement("div",bu({ref:d},t)))}),z4e=b.forwardRef((t,n)=>{var{width:r,height:s}=t,[i,o]=b.useState({containerWidth:Dy(r),containerHeight:Dy(s)}),l=b.useCallback((d,u)=>{o(h=>{var m=Math.round(d),g=Math.round(u);return h.containerWidth===m&&h.containerHeight===g?h:{containerWidth:m,containerHeight:g}})},[]),c=b.useCallback(d=>{if(typeof n=="function"&&n(d),d!=null){var{width:u,height:h}=d.getBoundingClientRect();l(u,h)}},[n,l]);return b.createElement(b.Fragment,null,b.createElement(mb,{width:i.containerWidth,height:i.containerHeight}),b.createElement("div",bu({ref:c},t)))}),U4e=b.forwardRef((t,n)=>{var{width:r,height:s}=t;return b.createElement(b.Fragment,null,b.createElement(mb,{width:r,height:s}),b.createElement("div",bu({ref:n},t)))}),V4e=b.forwardRef((t,n)=>{var{width:r,height:s}=t;return gl(r)||gl(s)?b.createElement(z4e,bu({},t,{ref:n})):b.createElement(U4e,bu({},t,{ref:n}))});function H4e(t){return t===!0?$4e:V4e}var W4e=b.forwardRef((t,n)=>{var{children:r,className:s,height:i,onClick:o,onContextMenu:l,onDoubleClick:c,onMouseDown:d,onMouseEnter:u,onMouseLeave:h,onMouseMove:m,onMouseUp:g,onTouchEnd:y,onTouchMove:N,onTouchStart:j,style:S,width:_,responsive:A,dispatchTouchEvents:k=!0}=t,T=b.useRef(null),P=Vn(),[M,O]=b.useState(null),[D,L]=b.useState(null),$=O4e(),V=QE(),F=(V==null?void 0:V.width)>0?V.width:_,Q=(V==null?void 0:V.height)>0?V.height:i,U=b.useCallback(ae=>{$(ae),typeof n=="function"&&n(ae),O(ae),L(ae),ae!=null&&(T.current=ae)},[$,n,O,L]),z=b.useCallback(ae=>{P(pq(ae)),P(Ja({handler:o,reactEvent:ae}))},[P,o]),q=b.useCallback(ae=>{P(OC(ae)),P(Ja({handler:u,reactEvent:ae}))},[P,u]),K=b.useCallback(ae=>{P(rW()),P(Ja({handler:h,reactEvent:ae}))},[P,h]),X=b.useCallback(ae=>{P(OC(ae)),P(Ja({handler:m,reactEvent:ae}))},[P,m]),J=b.useCallback(()=>{P(wq())},[P]),ne=b.useCallback(ae=>{P(bq(ae.key))},[P]),Se=b.useCallback(ae=>{P(Ja({handler:l,reactEvent:ae}))},[P,l]),de=b.useCallback(ae=>{P(Ja({handler:c,reactEvent:ae}))},[P,c]),ye=b.useCallback(ae=>{P(Ja({handler:d,reactEvent:ae}))},[P,d]),be=b.useCallback(ae=>{P(Ja({handler:g,reactEvent:ae}))},[P,g]),xe=b.useCallback(ae=>{P(Ja({handler:j,reactEvent:ae}))},[P,j]),_e=b.useCallback(ae=>{k&&P(jq(ae)),P(Ja({handler:N,reactEvent:ae}))},[P,k,N]),we=b.useCallback(ae=>{P(Ja({handler:y,reactEvent:ae}))},[P,y]),Oe=H4e(A);return b.createElement(CW.Provider,{value:M},b.createElement(Dwe.Provider,{value:D},b.createElement(Oe,{width:F??(S==null?void 0:S.width),height:Q??(S==null?void 0:S.height),className:cn("recharts-wrapper",s),style:D4e({position:"relative",cursor:"default",width:F,height:Q},S),onClick:z,onContextMenu:Se,onDoubleClick:de,onFocus:J,onKeyDown:ne,onMouseDown:ye,onMouseEnter:q,onMouseLeave:K,onMouseMove:X,onMouseUp:be,onTouchEnd:we,onTouchMove:_e,onTouchStart:xe,ref:U},b.createElement(F4e,null),r)))}),q4e=["width","height","responsive","children","className","style","compact","title","desc"];function G4e(t,n){if(t==null)return{};var r,s,i=K4e(t,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],n.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function K4e(t,n){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(n.indexOf(s)!==-1)continue;r[s]=t[s]}return r}var Eq=b.forwardRef((t,n)=>{var{width:r,height:s,responsive:i,children:o,className:l,style:c,compact:d,title:u,desc:h}=t,m=G4e(t,q4e),g=Io(m);return d?b.createElement(b.Fragment,null,b.createElement(mb,{width:r,height:s}),b.createElement(kD,{otherAttributes:g,title:u,desc:h},o)):b.createElement(W4e,{className:l,style:c,width:r,height:s,responsive:i??!1,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},b.createElement(kD,{otherAttributes:g,title:u,desc:h,ref:n},b.createElement(sMe,null,o)))});function DC(){return DC=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},DC.apply(null,arguments)}var Y4e={top:5,right:5,bottom:5,left:5},X4e={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Y4e,reverseStackOrder:!1,syncMethod:"index",responsive:!1},Q4e=b.forwardRef(function(n,r){var s,i=Xs(n.categoricalChartProps,X4e),{chartName:o,defaultTooltipEventType:l,validateTooltipEventTypes:c,tooltipPayloadSearcher:d,categoricalChartProps:u}=n,h={chartName:o,defaultTooltipEventType:l,validateTooltipEventTypes:c,tooltipPayloadSearcher:d,eventEmitter:void 0};return b.createElement(Cq,{preloadedState:{options:h},reduxStoreName:(s=u.id)!==null&&s!==void 0?s:o},b.createElement(uq,{chartData:u.data}),b.createElement(_q,{layout:i.layout,margin:i.margin}),b.createElement(Aq,{baseValue:i.baseValue,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className}),b.createElement(Eq,DC({},i,{ref:r})))}),Z4e=["axis","item"],Ry=b.forwardRef((t,n)=>b.createElement(Q4e,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Z4e,tooltipPayloadSearcher:AW,categoricalChartProps:t,ref:n}));function J4e(t){var n=Vn();return b.useEffect(()=>{n(N4e(t))},[n,t]),null}var eOe=["layout"];function RC(){return RC=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},RC.apply(null,arguments)}function tOe(t,n){if(t==null)return{};var r,s,i=nOe(t,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],n.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function nOe(t,n){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(n.indexOf(s)!==-1)continue;r[s]=t[s]}return r}var rOe={top:5,right:5,bottom:5,left:5},sOe={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:rOe,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1},aOe=b.forwardRef(function(n,r){var s,i=Xs(n.categoricalChartProps,sOe),{layout:o}=i,l=tOe(i,eOe),{chartName:c,defaultTooltipEventType:d,validateTooltipEventTypes:u,tooltipPayloadSearcher:h}=n,m={chartName:c,defaultTooltipEventType:d,validateTooltipEventTypes:u,tooltipPayloadSearcher:h,eventEmitter:void 0};return b.createElement(Cq,{preloadedState:{options:m},reduxStoreName:(s=i.id)!==null&&s!==void 0?s:c},b.createElement(uq,{chartData:i.data}),b.createElement(_q,{layout:o,margin:i.margin}),b.createElement(Aq,{baseValue:void 0,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className}),b.createElement(J4e,{cx:i.cx,cy:i.cy,startAngle:i.startAngle,endAngle:i.endAngle,innerRadius:i.innerRadius,outerRadius:i.outerRadius}),b.createElement(Eq,RC({},l,{ref:r})))}),iOe=["item"],oOe={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},LC=b.forwardRef((t,n)=>{var r=Xs(t,oOe);return b.createElement(aOe,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:iOe,tooltipPayloadSearcher:AW,categoricalChartProps:r,ref:n})});const Hl=["#0f172a","#0284c7","#22c55e","#e11d48","#6366f1"];function Ho(t){return t.toISOString().slice(0,10)}function ID(t,n){const r=new Date(t);return r.setDate(r.getDate()+n),r}const lOe={hidden:{opacity:0,y:8},visible:{opacity:1,y:0,transition:{duration:.3,ease:"easeOut"}}},m2={hidden:{},visible:{transition:{staggerChildren:.08,delayChildren:.05}}},p2={hidden:{opacity:0,y:10,scale:.97},visible:{opacity:1,y:0,scale:1,transition:{duration:.25,ease:"easeOut"}}},PD={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{duration:.25,ease:"easeOut"}}};function MD(){var Oe;const t=new Date,[n,r]=b.useState(()=>Ho(t)),[s,i]=b.useState(()=>Ho(t)),[o,l]=b.useState("today"),[c,d]=b.useState("overview"),[u,h]=b.useState(null),[m,g]=b.useState(null),[y,N]=b.useState(!0),[j,S]=b.useState(""),[_,A]=b.useState(0),k=!!(n&&s);b.useEffect(()=>{if(!k){N(!1),S(""),h(null);return}(async()=>{var ie,pe;N(!0),S("");try{const We=await _we({date_from:n,date_to:s});console.log("DASHBOARD DATA >>>",We.data),h(We.data),g(new Date)}catch(re){console.error(re),S(((pe=(ie=re==null?void 0:re.response)==null?void 0:ie.data)==null?void 0:pe.detail)||"Failed to load dashboard data. Please try again."),h(null)}finally{N(!1)}})()},[n,s,_,k]);const T=((Oe=u==null?void 0:u.filters)==null?void 0:Oe.caps)||{},P=Object.keys(T).length>0,M=b.useMemo(()=>{if(!P)return[];const ae=[];return T.can_patients&&ae.push({key:"patients",label:"Patients",icon:ha}),T.can_opd&&ae.push({key:"opd",label:"OPD",icon:kn}),T.can_ipd&&ae.push({key:"ipd",label:"IPD / Beds",icon:Fd}),T.can_lab&&ae.push({key:"lab",label:"Lab",icon:Wf}),T.can_radiology&&ae.push({key:"radiology",label:"Radiology",icon:b1}),T.can_pharmacy&&ae.push({key:"pharmacy",label:"Pharmacy",icon:gs}),T.can_billing&&ae.push({key:"billing",label:"Billing",icon:ho}),T.can_ot&&ae.push({key:"ot",label:"OT",icon:ha}),ae},[P,T]),O=b.useMemo(()=>{var ae;return((ae=u==null?void 0:u.widgets)==null?void 0:ae.filter(ie=>ie.widget_type==="metric"))||[]},[u]),D=b.useMemo(()=>{var ae;return((ae=u==null?void 0:u.widgets)==null?void 0:ae.filter(ie=>ie.widget_type==="table"))||[]},[u]),L=b.useMemo(()=>{var ae;return((ae=u==null?void 0:u.widgets)==null?void 0:ae.filter(ie=>ie.widget_type==="chart"))||[]},[u]),$=L.find(ae=>ae.code==="patient_flow"),V=L.find(ae=>ae.code==="ipd_bed_occupancy"),F=L.find(ae=>ae.code==="revenue_by_stream"),Q=L.find(ae=>ae.code==="appointment_status"),U=L.find(ae=>ae.code==="ipd_status"),z=L.find(ae=>ae.code==="payment_modes"),q=L.find(ae=>ae.code==="top_lab_tests"),K=L.find(ae=>ae.code==="top_radiology_tests"),X=L.find(ae=>ae.code==="billing_summary"),J=L.find(ae=>ae.code==="top_medicines"),ne=D.find(ae=>ae.code==="recent_ipd_admissions"),Se=O.filter(ae=>ae.code.startsWith("revenue_")),de=O.filter(ae=>!ae.code.startsWith("revenue_")),ye=()=>A(ae=>ae+1),be=ae=>{l(ae);const ie=new Date;if(ae==="today"){const pe=Ho(ie);r(pe),i(pe)}else if(ae==="7d"){const pe=Ho(ID(ie,-6)),re=Ho(ie);r(pe),i(re)}else if(ae==="30d"){const pe=Ho(ID(ie,-29)),re=Ho(ie);r(pe),i(re)}else if(ae==="month"){const pe=new Date(ie.getFullYear(),ie.getMonth(),1),re=Ho(pe),We=Ho(ie);r(re),i(We)}},xe=ae=>ie=>{l("custom"),ae(ie.target.value)},_e=b.useMemo(()=>{if(!u)return[];const ae=Ie=>{var qe;return((qe=O.find(se=>se.code===Ie))==null?void 0:qe.data)??0},ie=Number(ae("metric_new_patients"))||0,pe=Number(ae("metric_opd_visits"))||0,re=Number(ae("metric_ipd_admissions"))||0,Je=((V==null?void 0:V.data)||{}).occupancy_pct??0,St=(F==null?void 0:F.data)||[],wt=Array.isArray(St)&&St.length?[...St].sort((Ie,qe)=>(qe.value||0)-(Ie.value||0))[0]:null,ft=[];return T.can_patients&&O.length&&ft.push({key:"patients",label:"New Patients",value:ie,helper:"Registered in period",icon:ha,tone:"sky"}),T.can_opd&&O.length&&ft.push({key:"opd",label:"OPD Visits",value:pe,helper:"Completed consults",icon:kn,tone:"emerald"}),T.can_ipd&&O.length&&ft.push({key:"ipd",label:"IPD Admissions",value:re,helper:"Admitted cases",icon:Fd,tone:"violet"}),T.can_ipd&&V&&ft.push({key:"beds",label:"Bed Occupancy",value:Je,suffix:"%",helper:"Across all wards",icon:Fd,tone:"amber"}),wt&&(T.can_billing||T.can_pharmacy||T.can_lab||T.can_radiology)&&ft.push({key:"revenue",label:"Top Revenue Stream",value:wt.value||0,helper:wt.label||"",icon:wt.label==="Pharmacy"?gs:wt.label==="Lab"?Wf:wt.label==="Radiology"?b1:ho,tone:"rose"}),ft.filter(Boolean)},[u,O,V,F,T.can_patients,T.can_opd,T.can_ipd,T.can_billing,T.can_pharmacy,T.can_lab,T.can_radiology]),we=b.useMemo(()=>[{key:"overview",label:"Overview",show:!0},{key:"clinical",label:"Clinical",show:T.can_patients||T.can_opd||T.can_ipd},{key:"revenue",label:"Revenue",show:T.can_billing||T.can_pharmacy||T.can_lab||T.can_radiology},{key:"operations",label:"Operations",show:T.can_ipd||T.can_pharmacy||T.can_lab||T.can_radiology}].filter(ie=>ie.show),[T]);return b.useEffect(()=>{we.find(ae=>ae.key===c)||we.length>0&&d(we[0].key)},[we,c]),a.jsxs(ht.div,{className:"relative min-h-[calc(100vh-4rem)]  px-3 py-3 md:px-6 md:py-6 rounded",variants:lOe,initial:"hidden",animate:"visible",children:[a.jsxs("div",{className:"pointer-events-none absolute inset-0 -z-10",children:[a.jsx("div",{className:"absolute -top-24 right-0 h-40 w-40 rounded-full bg-sky-200/40 blur-3xl"}),a.jsx("div",{className:"absolute -bottom-24 left-4 h-40 w-40 rounded-full bg-emerald-200/40 blur-3xl"})]}),a.jsxs("div",{className:"mx-auto w-full max-w-6xl space-y-4",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs(ht.div,{className:_t("flex flex-col md:flex-row md:items-start md:justify-between gap-3","rounded-2xl border border-slate-200/70 bg-white/90 backdrop-blur-sm p-3 md:p-5 shadow-sm"),children:[a.jsxs("div",{className:"space-y-2 md:max-w-md",children:[a.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-sky-200 bg-sky-50 px-3 py-1 text-[10px] md:text-[11px] font-medium text-sky-700",children:[a.jsxs("span",{className:"relative flex h-2 w-2",children:[a.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-emerald-400 opacity-75"}),a.jsx("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-emerald-500"})]}),"Live operations & clinical overview"]}),a.jsxs("h1",{className:"text-xl md:text-3xl font-semibold tracking-tight text-slate-900 flex items-center gap-2",children:[a.jsx("span",{className:"inline-flex h-8 w-8 md:h-9 md:w-9 items-center justify-center rounded-xl bg-sky-100 text-sky-600 border border-sky-200",children:a.jsx(Cm,{className:"w-4 h-4 md:w-5 md:h-5"})}),"Dashboard"]}),a.jsx("p",{className:"text-xs md:text-sm text-slate-600",children:"Monitor patients, beds, diagnostics, pharmacy and revenue in one live dashboard designed for hospital admins & clinical teams."}),P&&M.length>0&&a.jsx("div",{className:"flex flex-wrap gap-1.5 mt-2",children:M.map(ae=>a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-100 border border-slate-200 px-2 py-0.5 text-[10px] text-slate-700",children:[a.jsx("span",{className:"flex h-4 w-4 items-center justify-center rounded-full bg-white shadow-inner",children:a.jsx(ae.icon,{className:"w-3 h-3"})}),a.jsx("span",{className:"font-medium",children:ae.label})]},ae.key))}),m&&a.jsxs("div",{className:"inline-flex items-center gap-1.5 rounded-full bg-slate-100 px-2.5 py-1 mt-1 text-[10px] text-slate-600",children:[a.jsx(Hc,{className:"w-3 h-3"}),a.jsx("span",{className:"font-medium",children:"Last updated:"}),a.jsx("span",{children:m.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"})})]})]}),a.jsxs("div",{className:"flex flex-col gap-2 w-full md:w-auto",children:[a.jsx("div",{className:"flex flex-wrap gap-1.5",children:[{key:"today",label:"Today"},{key:"7d",label:"Last 7 days"},{key:"30d",label:"Last 30 days"},{key:"month",label:"This month"},{key:"custom",label:"Custom"}].map(ae=>a.jsx("button",{type:"button",onClick:()=>be(ae.key),className:_t("px-2.5 py-1 rounded-full text-[10px] font-medium border transition-colors",o===ae.key?"bg-sky-600 text-white border-sky-600 shadow-sm":"bg-white text-slate-700 border-slate-200 hover:bg-slate-50"),children:ae.label},ae.key))}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[a.jsxs("div",{className:"flex flex-1 items-center gap-2 rounded-xl border border-slate-200 bg-white px-2.5 py-2 shadow-inner",children:[a.jsx(Rj,{className:"w-4 h-4 text-slate-500 shrink-0"}),a.jsxs("div",{className:"flex flex-col gap-1 w-full text-[11px] text-slate-700 sm:flex-row sm:items-center",children:[a.jsxs("div",{className:"flex items-center gap-1 w-full",children:[a.jsx("span",{className:"hidden sm:inline",children:"From"}),a.jsx("input",{type:"date",value:n,onChange:xe(r),className:"w-full border border-slate-200 bg-slate-50 rounded px-1.5 py-0.5 text-[11px] text-slate-800 focus:outline-none focus:ring-1 focus:ring-sky-500"})]}),a.jsxs("div",{className:"flex items-center gap-1 w-full",children:[a.jsx("span",{className:"hidden sm:inline",children:"To"}),a.jsx("input",{type:"date",value:s,onChange:xe(i),className:"w-full border border-slate-200 bg-slate-50 rounded px-1.5 py-0.5 text-[11px] text-slate-800 focus:outline-none focus:ring-1 focus:ring-sky-500"})]})]})]}),a.jsxs(ht.button,{onClick:ye,whileTap:{scale:.96},className:_t("inline-flex items-center justify-center gap-2 rounded-xl","border border-sky-600 bg-sky-600 text-white shadow-sm","px-3 py-2 text-xs sm:text-sm font-medium w-full sm:w-auto","hover:bg-sky-500 hover:border-sky-500 transition-colors"),children:[a.jsx(qf,{className:"w-4 h-4"}),"Refresh"]})]})]})]}),a.jsx(su,{children:j&&a.jsx(ht.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},children:a.jsxs(Ic,{variant:"destructive",children:[a.jsx(Bi,{className:"h-4 w-4 mt-0.5"}),a.jsxs("div",{children:[a.jsx(Pc,{children:"Dashboard error"}),a.jsx(Mc,{children:j})]})]})})}),!y&&u&&_e.length>0&&a.jsxs(ht.div,{className:"rounded-2xl border border-slate-200 bg-white px-2.5 py-3 shadow-sm",variants:PD,initial:"hidden",animate:"visible",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2 px-1",children:[a.jsx("h2",{className:"text-xs font-semibold text-slate-700",children:"At a glance"}),a.jsx("span",{className:"h-px flex-1 bg-slate-200"})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:_e.map(ae=>a.jsx(cOe,{pill:ae},ae.key))})]})]}),!k&&!y&&!j&&a.jsx(Re,{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50/70",children:a.jsxs(Be,{className:"py-6 flex flex-col items-center text-center gap-2",children:[a.jsx(Rj,{className:"w-8 h-8 text-slate-400 mb-1"}),a.jsx("p",{className:"text-sm font-medium text-slate-700",children:"Select a date range to see live dashboard data."}),a.jsxs("p",{className:"text-xs text-slate-500 max-w-xs",children:["Choose both ",a.jsx("span",{className:"font-semibold",children:"From"})," and"," ",a.jsx("span",{className:"font-semibold",children:"To"})," dates above. Well show patient, revenue, pharmacy and diagnostics insights."]})]})}),y&&k&&!u&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4",children:[a.jsx(Xe,{className:"h-20 rounded-2xl"}),a.jsx(Xe,{className:"h-20 rounded-2xl"}),a.jsx(Xe,{className:"h-20 rounded-2xl"}),a.jsx(Xe,{className:"h-20 rounded-2xl"})]}),a.jsx(Xe,{className:"h-56 rounded-2xl"}),a.jsx(Xe,{className:"h-56 rounded-2xl"})]}),!y&&k&&u&&a.jsx(ht.div,{variants:PD,initial:"hidden",animate:"visible",className:"pb-4",children:a.jsxs(ko,{value:c,onValueChange:d,className:"w-full",children:[a.jsx("div",{className:"flex justify-between items-center mb-2",children:a.jsx(Vi,{className:"flex flex-nowrap overflow-x-auto gap-1 rounded-full bg-slate-100/80 p-1",children:we.map(ae=>a.jsx(on,{value:ae.key,className:"px-3 py-1.5 text-xs sm:text-sm rounded-full data-[state=active]:bg-white data-[state=active]:shadow-sm",children:ae.label},ae.key))})}),a.jsxs(ln,{value:"overview",className:"space-y-4 mt-2",children:[O.length>0&&a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Key metrics"}),a.jsx(ht.div,{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4",variants:m2,initial:"hidden",animate:"visible",children:O.map(ae=>a.jsx(ht.div,{variants:p2,whileHover:{y:-2,scale:1.01,boxShadow:"0 18px 35px rgba(15, 23, 42, 0.12)"},transition:{type:"spring",stiffness:220,damping:20},children:a.jsx(x2,{widget:ae})},ae.code))})]}),a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Activity & revenue mix"}),a.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-3 md:gap-4",children:[$&&a.jsx(ls,{widget:$}),F&&a.jsx(ls,{widget:F})]})]})]}),a.jsxs(ln,{value:"clinical",className:"space-y-4 mt-2",children:[de.length>0&&a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Clinical metrics"}),a.jsx(ht.div,{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-4",variants:m2,initial:"hidden",animate:"visible",children:de.map(ae=>a.jsx(ht.div,{variants:p2,whileHover:{y:-2,scale:1.01,boxShadow:"0 18px 35px rgba(15, 23, 42, 0.12)"},transition:{type:"spring",stiffness:220,damping:20},children:a.jsx(x2,{widget:ae})},ae.code))})]}),a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Patient flow & statuses"}),a.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-3 md:gap-4",children:[$&&a.jsx(ls,{widget:$}),Q&&a.jsx(ls,{widget:Q})]})]}),a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"IPD beds & admissions"}),a.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-3 md:gap-4",children:[V&&a.jsx(ls,{widget:V}),U&&a.jsx(ls,{widget:U})]})]}),ne&&a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Recent IPD admissions"}),a.jsx(OD,{widget:ne})]})]}),a.jsxs(ln,{value:"revenue",className:"space-y-4 mt-2",children:[Se.length>0&&a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Revenue KPIs"}),a.jsx(ht.div,{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-4",variants:m2,initial:"hidden",animate:"visible",children:Se.map(ae=>a.jsx(ht.div,{variants:p2,whileHover:{y:-2,scale:1.01,boxShadow:"0 18px 35px rgba(15, 23, 42, 0.12)"},transition:{type:"spring",stiffness:220,damping:20},children:a.jsx(x2,{widget:ae})},ae.code))})]}),a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Revenue & payment mix"}),a.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-3 md:gap-4",children:[F&&a.jsx(ls,{widget:F}),z&&a.jsx(ls,{widget:z})]})]}),a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Billed vs pending & top tests"}),a.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-3 md:gap-4",children:[X&&a.jsx(ls,{widget:X}),q&&a.jsx(ls,{widget:q}),K&&a.jsx(ls,{widget:K})]})]}),J&&a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Top 10 medicines (by quantity)"}),a.jsx(ls,{widget:J})]})]}),a.jsxs(ln,{value:"operations",className:"space-y-4 mt-2",children:[a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Capacity & utilization"}),a.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-3 md:gap-4",children:[V&&a.jsx(ls,{widget:V}),$&&a.jsx(ls,{widget:$})]})]}),a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Pharmacy & diagnostics focus"}),a.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-3 md:gap-4",children:[J&&a.jsx(ls,{widget:J}),q&&a.jsx(ls,{widget:q}),K&&a.jsx(ls,{widget:K})]})]}),ne&&a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Latest IPD activity"}),a.jsx(OD,{widget:ne})]})]})]})})]})]})}function cOe({pill:t}){const{label:n,value:r,helper:s,icon:i,tone:o,suffix:l}=t,c={sky:"bg-sky-50 border-sky-100 text-sky-800",emerald:"bg-emerald-50 border-emerald-100 text-emerald-800",violet:"bg-violet-50 border-violet-100 text-violet-800",amber:"bg-amber-50 border-amber-100 text-amber-800",rose:"bg-rose-50 border-rose-100 text-rose-800"}[o||"sky"];return a.jsxs(ht.div,{whileHover:{y:-2,scale:1.01},transition:{type:"spring",stiffness:260,damping:18},className:_t("flex-1 min-w-[140px] sm:min-w-[160px] rounded-2xl border px-2.5 py-2","flex items-center gap-2 sm:gap-3 shadow-[0_8px_18px_rgba(15,23,42,0.04)]",c),children:[a.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-xl bg-white/70 text-slate-700 shadow-sm shrink-0",children:i&&a.jsx(i,{className:"w-4 h-4"})}),a.jsxs("div",{className:"space-y-0.5",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide font-semibold opacity-90",children:n}),a.jsxs("div",{className:"text-base sm:text-lg font-semibold leading-tight",children:[typeof r=="number"?r.toLocaleString("en-IN",{maximumFractionDigits:l==="%"?1:0}):r,l&&a.jsx("span",{className:"ml-0.5 text-[10px]",children:l})]}),s&&a.jsx("div",{className:"text-[10px] leading-tight opacity-80",children:s})]})]})}function x2({widget:t}){const n=t.data,r=typeof n=="number"||typeof n=="string"?n:typeof n=="object"&&n!==null?n.value??n.total??n.amount??0:0,s=typeof r=="number"?r.toLocaleString("en-IN",{maximumFractionDigits:(t.code.includes("revenue"),0)}):r;return a.jsxs(Re,{className:_t("rounded-2xl shadow-sm overflow-hidden border border-slate-200 bg-white","hover:border-sky-200 transition-colors"),children:[a.jsxs(Ye,{className:"flex flex-row items-start justify-between space-y-0 pb-1",children:[a.jsxs(Ze,{className:"text-sm font-medium text-slate-800 flex items-center gap-1.5",children:[a.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-400 shadow-[0_0_0_3px_rgba(52,211,153,0.35)]"}),t.title]}),a.jsx(Ge,{variant:"outline",className:"text-[9px] uppercase tracking-wide border-slate-200 text-slate-500",children:t.code})]}),a.jsxs(Be,{className:"pt-0",children:[a.jsx("div",{className:"text-2xl md:text-3xl font-semibold tracking-tight mt-1 text-slate-900",children:s}),t.description&&a.jsx("p",{className:"text-[11px] text-slate-500 mt-1",children:t.description})]})]})}function ls({widget:t}){var i,o,l;const n=((i=t.config)==null?void 0:i.chart_type)||"bar";if(n==="donut"){const c=t.data||{},d=[{label:"Occupied",value:c.occupied||0},{label:"Available",value:c.available||0}];return a.jsxs(Re,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[a.jsxs(Ye,{className:"pb-2 flex flex-row items-center justify-between",children:[a.jsx(Ze,{className:"text-base font-semibold text-slate-800",children:t.title}),a.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-500",children:"Snapshot"})]}),a.jsxs(Be,{className:"h-56 sm:h-64",children:[a.jsx(Pd,{width:"100%",height:"100%",children:a.jsxs(LC,{children:[a.jsx(Ey,{dataKey:"value",data:d,innerRadius:50,outerRadius:80,paddingAngle:3,children:d.map((u,h)=>a.jsx(xo,{fill:Hl[h%Hl.length]},`cell-${h}`))}),a.jsx(Dd,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12}})]})}),typeof c.occupancy_pct=="number"&&a.jsxs("p",{className:"text-xs text-slate-600 text-center mt-2",children:["Occupancy:"," ",a.jsxs("span",{className:"font-medium text-emerald-600",children:[c.occupancy_pct,"%"]})," ",a.jsxs("span",{className:"opacity-80",children:["(",c.occupied,"/",c.total," beds)"]})]})]})]})}if(n==="pie"){const c=Array.isArray(t.data)?t.data:[];return a.jsxs(Re,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[a.jsxs(Ye,{className:"pb-2 flex flex-row items-center justify-between",children:[a.jsx(Ze,{className:"text-base font-semibold text-slate-800",children:t.title}),a.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-500",children:"Distribution"})]}),a.jsx(Be,{className:"h-56 sm:h-64",children:c.length===0?a.jsx("p",{className:"text-sm text-slate-500 mt-4",children:"No data to display."}):a.jsx(Pd,{width:"100%",height:"100%",children:a.jsxs(LC,{children:[a.jsx(Ey,{data:c,dataKey:"value",nameKey:"label",outerRadius:80,paddingAngle:3,labelLine:!1,label:d=>`${d.label}: ${d.value??0}`,children:c.map((d,u)=>a.jsx(xo,{fill:Hl[u%Hl.length]},`cell-${u}`))}),a.jsx(Dd,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12}})]})})})]})}if(n==="multi_bar"){const c=Array.isArray(t.data)?t.data:[],d=((o=t.config)==null?void 0:o.series)||[],u=((l=t.config)==null?void 0:l.x_key)||"label";return a.jsxs(Re,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[a.jsx(Ye,{className:"pb-2",children:a.jsx(Ze,{className:"text-base font-semibold text-slate-800",children:t.title})}),a.jsx(Be,{className:"h-56 sm:h-64",children:c.length===0?a.jsx("p",{className:"text-sm text-slate-500 mt-4",children:"No data to display."}):a.jsx(Pd,{width:"100%",height:"100%",children:a.jsxs(Ry,{data:c,margin:{left:8,right:8,top:8,bottom:8},children:[a.jsx(ex,{dataKey:u,stroke:"#6b7280",fontSize:11}),a.jsx(tx,{stroke:"#6b7280",fontSize:11}),a.jsx(Dd,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12}}),d.map((h,m)=>a.jsx(Jp,{dataKey:h.key,name:h.label,radius:[4,4,0,0],children:c.map((g,y)=>a.jsx(xo,{fill:Hl[(m+y)%Hl.length]},`cell-${h.key}-${y}`))},h.key))]})})})]})}const r=Array.isArray(t.data)?t.data:[],s=r.length>0?r.map((c,d)=>({label:c.label??c.name??`Item ${d+1}`,value:c.value??c.amount??0})):[];return a.jsxs(Re,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[a.jsxs(Ye,{className:"pb-2 flex flex-row items-center justify-between",children:[a.jsx(Ze,{className:"text-base font-semibold text-slate-800",children:t.title}),a.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-500",children:t.description?"Insight":"Summary"})]}),a.jsx(Be,{className:"h-56 sm:h-64",children:s.length===0?a.jsx("p",{className:"text-sm text-slate-500 mt-4",children:"No data to display."}):a.jsx(Pd,{width:"100%",height:"100%",children:a.jsxs(Ry,{data:s,margin:{left:8,right:8,top:8,bottom:8},children:[a.jsx(ex,{dataKey:"label",stroke:"#6b7280",fontSize:11}),a.jsx(tx,{stroke:"#6b7280",fontSize:11}),a.jsx(Dd,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12}}),a.jsx(Jp,{dataKey:"value",radius:[4,4,0,0],children:s.map((c,d)=>a.jsx(xo,{fill:Hl[d%Hl.length]},`cell-${d}`))})]})})})]})}function OD({widget:t}){var s;const n=Array.isArray(t.data)?t.data:[],r=((s=t.config)==null?void 0:s.columns)||(n[0]?Object.keys(n[0]):[]);return a.jsxs(Re,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[a.jsxs(Ye,{className:"pb-2 flex flex-row items-center justify-between",children:[a.jsx(Ze,{className:"text-base font-semibold text-slate-800",children:t.title}),a.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-500",children:"Latest records"})]}),a.jsx(Be,{className:"space-y-2",children:n.length===0?a.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"No records found."}):a.jsx("div",{className:"flex flex-col gap-2",children:n.map((i,o)=>a.jsx("div",{className:_t("rounded-xl border border-slate-200 bg-slate-50/60 px-3 py-2.5","flex flex-col gap-1 text-xs md:text-sm"),children:r.map((l,c)=>a.jsxs("div",{className:_t("flex justify-between gap-2",c===0?"font-semibold text-slate-900":"text-slate-700"),children:[a.jsx("span",{className:"text-[10px] uppercase tracking-wide text-slate-500",children:l.replace(/_/g," ")}),a.jsx("span",{className:"text-right",children:dOe(i[l])})]},l))},o))})})]})}function dOe(t){return t==null?"-":typeof t=="number"?t.toLocaleString("en-IN",{maximumFractionDigits:1}):typeof t=="string"&&t.length>40?t.slice(0,40)+"":String(t)}function uOe(){return te.get("/mis/definitions")}function fOe(t,n){return te.post(`/mis/reports/${t}`,n)}const ng=["#0f172a","#1e293b","#475569","#64748b","#94a3b8"];function Wo(t){return t.toISOString().slice(0,10)}function DD(t,n){const r=new Date(t);return r.setDate(r.getDate()+n),r}function hOe(t){if(!t)return"";const n=t.value!==null&&t.value!==void 0?t.value:0;return`${t.label}: ${n}`}const mOe={hidden:{opacity:0,y:12},visible:{opacity:1,y:0,transition:{duration:.35,ease:"easeOut"}}},ym={hidden:{opacity:0,y:8},visible:(t=0)=>({opacity:1,y:0,transition:{duration:.3,ease:"easeOut",delay:t}})},RD={hidden:{},visible:{transition:{staggerChildren:.06}}},g2={hidden:{opacity:0,y:6,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{duration:.25,ease:"easeOut"}}};function pOe(){const t=new Date,[n,r]=b.useState(()=>Wo(t)),[s,i]=b.useState(()=>Wo(t)),[o,l]=b.useState([]),[c,d]=b.useState(!0),[u,h]=b.useState(""),[m,g]=b.useState({}),[y,N]=b.useState("today"),[j,S]=b.useState(null),[_,A]=b.useState(!1),[k,T]=b.useState(""),P=!!(n&&s);b.useEffect(()=>{let J=!0;return(async()=>{var Se,de;d(!0),T("");try{const ye=await uOe();if(!J)return;const be=(ye==null?void 0:ye.data)||[];l(be),be.length>0&&h(be[0].code)}catch(ye){if(console.error(ye),!J)return;T(((de=(Se=ye==null?void 0:ye.response)==null?void 0:Se.data)==null?void 0:de.detail)||"Failed to load MIS report definitions.")}finally{J&&d(!1)}})(),()=>{J=!1}},[]);const M=b.useMemo(()=>o.find(J=>J.code===u)||null,[o,u]),O=J=>{N(J);const ne=new Date;if(J==="today"){const Se=Wo(ne);r(Se),i(Se)}else if(J==="7d")r(Wo(DD(ne,-6))),i(Wo(ne));else if(J==="30d")r(Wo(DD(ne,-29))),i(Wo(ne));else if(J==="month"){const Se=new Date(ne.getFullYear(),ne.getMonth(),1);r(Wo(Se)),i(Wo(ne))}},D=J=>ne=>{N("custom"),J(ne.target.value)},L=(J,ne)=>{g(Se=>({...Se,[J]:ne}))},$=async()=>{var J,ne;if(!u||!P){T("Please select a report and valid date range.");return}A(!0),T(""),S(null);try{const de=await fOe(u,{date_from:n,date_to:s,filters:m});S((de==null?void 0:de.data)||null)}catch(Se){console.error(Se),T(((ne=(J=Se==null?void 0:Se.response)==null?void 0:J.data)==null?void 0:ne.detail)||"Failed to run MIS report. Please check filters and try again.")}finally{A(!1)}},V=b.useMemo(()=>j!=null&&j.cards&&Array.isArray(j.cards)?j.cards:[],[j]),F=b.useMemo(()=>j!=null&&j.charts&&Array.isArray(j.charts)?j.charts:[],[j]),Q=(M==null?void 0:M.category)||"MIS",U=F.filter(J=>J.type==="bar"),z=F.filter(J=>J.type==="pie"),q=(M==null?void 0:M.name)||"No report selected",K=P?`${n}  ${s}`:"Select a date range",X=_?"Running report":j?"Showing latest results":"Awaiting first run";return a.jsx(ht.div,{className:"relative min-h-[calc(100vh-4rem)] bg-slate-50 px-2.5 py-3 sm:px-3 sm:py-4 md:px-6 md:py-6 lg:px-8",variants:mOe,initial:"hidden",animate:"visible",children:a.jsxs("div",{className:"mx-auto w-full max-w-6xl space-y-4 md:space-y-5 lg:space-y-6",children:[a.jsxs(ht.div,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-[10px] md:text-[11px]",custom:0,variants:ym,initial:"hidden",animate:"visible",children:[a.jsxs("div",{className:"inline-flex items-center gap-1.5 rounded-full border border-slate-200 bg-white px-2.5 py-1 text-slate-800 shadow-sm",children:[a.jsx(Uee,{className:"w-3 h-3"}),a.jsx("span",{className:"font-medium",children:"MIS  Management Information System"})]}),a.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500",children:[a.jsx("span",{className:"inline-flex h-1.5 w-1.5 rounded-full bg-emerald-500 animate-pulse"}),a.jsx("span",{className:"inline-flex md:hidden rounded-full bg-white px-2 py-0.5 text-[9px] uppercase tracking-wide border border-slate-200",children:"Mobile view"}),a.jsx("span",{className:"hidden md:inline-flex lg:hidden rounded-full bg-white px-2 py-0.5 text-[9px] uppercase tracking-wide border border-slate-200",children:"Tablet / Laptop"}),a.jsx("span",{className:"hidden lg:inline-flex rounded-full bg-white px-2 py-0.5 text-[9px] uppercase tracking-wide border border-slate-200",children:"Desktop workspace"})]})]}),a.jsx(ht.div,{variants:ym,custom:.05,initial:"hidden",animate:"visible",children:a.jsx(Re,{className:"rounded-3xl border border-slate-200 bg-white shadow-sm overflow-hidden",children:a.jsxs(Be,{className:"p-4 sm:p-5 md:p-6 lg:p-7 flex flex-col gap-4 md:gap-5 lg:gap-6",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[a.jsxs("div",{className:"space-y-3 max-w-xl",children:[a.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 bg-slate-50 px-3 py-1 text-[10px] md:text-[11px] font-medium text-slate-700",children:[a.jsx("span",{className:"inline-flex h-5 w-5 items-center justify-center rounded-full bg-slate-900 text-white text-[10px]",children:"MIS"}),"Clean, light-weight analytics console"]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"inline-flex h-10 w-10 md:h-11 md:w-11 items-center justify-center rounded-3xl bg-slate-900 text-slate-50 shadow-sm",children:a.jsx(Cm,{className:"w-5 h-5"})}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("h1",{className:"text-[20px] md:text-[24px] lg:text-[28px] font-semibold tracking-tight text-slate-900",children:"MIS Reports Console"}),a.jsxs("p",{className:"text-[11px] md:text-[12px] text-slate-600 leading-relaxed",children:["Generate"," ",a.jsx("span",{className:"font-medium text-slate-900",children:"clinical, operational and financial"})," ","MIS reports for your hospital in a simple, distraction-free, light theme workspace."]})]})]}),M&&a.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[a.jsx(Ge,{variant:"outline",className:"border-slate-200 text-slate-700 bg-slate-50 text-[10px] px-2 py-0.5",children:Q}),Array.isArray(M.tags)&&M.tags.map(J=>a.jsx(Ge,{variant:"outline",className:"border-slate-200 text-slate-600 bg-white text-[10px] px-2 py-0.5",children:J},J))]})]}),a.jsx("div",{className:"w-full md:w-auto",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 md:gap-3 text-[11px]",children:[a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2.5 flex flex-col gap-1 shadow-xs",children:[a.jsx("span",{className:"text-[10px] font-medium text-slate-500 uppercase tracking-wide",children:"Active report"}),a.jsx("span",{className:"text-[11px] font-semibold text-slate-900 line-clamp-2",children:q})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2.5 flex flex-col gap-1 shadow-xs",children:[a.jsx("span",{className:"text-[10px] font-medium text-slate-500 uppercase tracking-wide",children:"Date range"}),a.jsx("span",{className:"text-[11px] font-semibold text-slate-900",children:K})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2.5 flex flex-col gap-1 shadow-xs",children:[a.jsx("span",{className:"text-[10px] font-medium text-slate-500 uppercase tracking-wide",children:"Status"}),a.jsxs("span",{className:"text-[11px] font-semibold text-slate-900 flex items-center gap-1.5",children:[a.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 animate-pulse"}),X]})]})]})})]}),(M==null?void 0:M.description)&&a.jsx("div",{className:"pt-2 border-t border-slate-100 text-[11px] text-slate-600",children:M.description})]})})}),a.jsx(su,{children:k&&a.jsx(ht.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},children:a.jsxs(Ic,{variant:"destructive",className:"bg-rose-50 border-rose-300 text-rose-900",children:[a.jsx(Bi,{className:"h-4 w-4 mt-0.5"}),a.jsxs("div",{children:[a.jsx(Pc,{className:"text-rose-900",children:"MIS error"}),a.jsx(Mc,{className:"text-rose-800/90",children:k})]})]})})}),a.jsxs(ht.div,{variants:ym,custom:.1,initial:"hidden",animate:"visible",className:"grid gap-4 lg:gap-5 lg:grid-cols-[minmax(0,320px)_minmax(0,1fr)] xl:grid-cols-[minmax(0,340px)_minmax(0,1fr)]",children:[a.jsxs("div",{className:"space-y-3 lg:space-y-4 lg:sticky lg:top-20 self-start",children:[a.jsxs(Re,{className:"rounded-2xl border border-slate-200 bg-white shadow-sm",children:[a.jsx(Ye,{className:"pb-2 flex flex-row items-center justify-between gap-2",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"h-7 w-7 rounded-xl bg-slate-900 text-white flex items-center justify-center",children:a.jsx(Cm,{className:"w-4 h-4"})}),a.jsxs("div",{children:[a.jsx(Ze,{className:"text-sm font-semibold text-slate-900",children:"Report & Date"}),a.jsx("p",{className:"text-[10px] text-slate-500",children:"Choose MIS view and time window"})]})]})}),a.jsxs(Be,{className:"space-y-3 pb-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-800",children:"Report"}),a.jsxs("span",{className:"text-[10px] text-slate-500 flex items-center gap-1",children:[a.jsx(Ec,{className:"w-3 h-3"}),"MIS group"]})]}),c?a.jsx(Xe,{className:"h-9 rounded-xl bg-slate-100"}):a.jsxs(Nn,{value:u,onValueChange:J=>{h(J),S(null)},children:[a.jsx(gn,{className:"h-9 rounded-xl border-slate-200 bg-white text-xs text-slate-900 focus:ring-slate-400",children:a.jsx(jn,{placeholder:"Select report"})}),a.jsx(yn,{className:"bg-white border-slate-200 text-slate-900 max-h-72",children:o.map(J=>a.jsx(gt,{value:String(J.code),className:"text-xs",children:J.name},J.code))})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-800",children:"Quick ranges"}),a.jsx("div",{className:"flex flex-wrap gap-1.5",children:[{key:"today",label:"Today"},{key:"7d",label:"Last 7 days"},{key:"30d",label:"Last 30 days"},{key:"month",label:"This month"},{key:"custom",label:"Custom"}].map(J=>a.jsx("button",{type:"button",onClick:()=>O(J.key),className:_t("px-2.5 py-1 rounded-full text-[10px] font-medium border transition-colors",y===J.key?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-200 hover:bg-slate-50"),children:J.label},J.key))})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-800",children:"Custom date range"}),a.jsx("div",{className:"flex flex-col gap-2",children:a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-2.5 py-2",children:[a.jsx(Rj,{className:"w-4 h-4 text-slate-500 shrink-0"}),a.jsxs("div",{className:"flex flex-col gap-1 w-full text-[11px] text-slate-800",children:[a.jsxs("div",{className:"flex items-center gap-1 w-full",children:[a.jsx("span",{className:"w-10 text-[10px] text-slate-500",children:"From"}),a.jsx(Ne,{type:"date",value:n,onChange:D(r),className:"h-7 w-full border-slate-200 bg-slate-50 text-[11px] text-slate-900"})]}),a.jsxs("div",{className:"flex items-center gap-1 w-full",children:[a.jsx("span",{className:"w-10 text-[10px] text-slate-500",children:"To"}),a.jsx(Ne,{type:"date",value:s,onChange:D(i),className:"h-7 w-full border-slate-200 bg-slate-50 text-[11px] text-slate-900"})]})]})]})})]}),a.jsx("div",{className:"pt-1",children:a.jsx(Te,{size:"sm",className:"h-9 w-full rounded-xl inline-flex items-center justify-center gap-2 bg-slate-900 hover:bg-slate-800 text-white",onClick:$,disabled:_||!u||!P,children:_?a.jsxs(a.Fragment,{children:[a.jsx(qf,{className:"w-4 h-4 animate-spin"}),"Running report"]}):a.jsxs(a.Fragment,{children:[a.jsx(qf,{className:"w-4 h-4"}),"Run MIS report"]})})})]})]}),M&&Array.isArray(M.filters)&&M.filters.length>0&&a.jsxs(Re,{className:"rounded-2xl border border-slate-200 bg-white shadow-sm",children:[a.jsxs(Ye,{className:"pb-2 flex flex-row items-center justify-between gap-2",children:[a.jsxs(Ze,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:[a.jsx(Ec,{className:"w-4 h-4 text-slate-500"}),"Advanced filters"]}),a.jsx("span",{className:"text-[10px] text-slate-500",children:"Tailor output for this report"})]}),a.jsx(Be,{className:"pb-3",children:a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:M.filters.map(J=>J.type==="select"&&Array.isArray(J.options)?a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-800",children:J.label}),J.required&&a.jsx("span",{className:"text-[10px] text-rose-500",children:"*"})]}),a.jsxs(Nn,{value:m[J.key]!==void 0?String(m[J.key]):"",onValueChange:ne=>L(J.key,ne),children:[a.jsx(gn,{className:"h-8 rounded-xl border-slate-200 bg-slate-50 text-xs text-slate-900",children:a.jsx(jn,{placeholder:`All ${J.label}`})}),a.jsxs(yn,{className:"bg-white border-slate-200 text-slate-900 max-h-64",children:[a.jsx(gt,{value:"__ALL__",className:"text-xs text-slate-500",children:"All"}),J.options.map(ne=>a.jsx(gt,{value:String(ne.value),className:"text-xs",children:ne.label},ne.value))]})]})]},J.key):a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-800",children:J.label}),J.required&&a.jsx("span",{className:"text-[10px] text-rose-500",children:"*"})]}),a.jsx(Ne,{value:m[J.key]??"",onChange:ne=>L(J.key,ne.target.value),placeholder:`Filter by ${J.label}`,className:"h-8 rounded-xl border-slate-200 bg-slate-50 text-xs text-slate-900 placeholder:text-slate-400"})]},J.key))})})]})]}),a.jsxs("div",{className:"space-y-3 lg:space-y-4",children:[!_&&!j&&a.jsx(Re,{className:"rounded-2xl border border-dashed border-slate-300 bg-white shadow-none",children:a.jsxs(Be,{className:"py-10 px-4 sm:px-8 flex flex-col items-center justify-center text-center gap-3",children:[a.jsx("div",{className:"h-12 w-12 rounded-full bg-slate-100 flex items-center justify-center border border-slate-200 mb-1",children:a.jsx(Cm,{className:"w-6 h-6 text-slate-700"})}),a.jsx("h2",{className:"text-sm md:text-base font-semibold text-slate-900",children:"Run your first MIS report"}),a.jsxs("p",{className:"text-[11px] md:text-[12px] text-slate-600 max-w-md",children:["Select a report on the left, choose a date range, add filters if needed and click"," ",a.jsx("span",{className:"font-medium text-slate-900",children:"Run MIS report"})," ","to see KPIs, charts and detailed records."]})]})}),_&&a.jsxs(ht.div,{className:"space-y-4",variants:ym,custom:.15,initial:"hidden",animate:"visible",children:[a.jsx(Xe,{className:"h-16 rounded-2xl bg-white/80"}),a.jsx(Xe,{className:"h-64 rounded-2xl bg-white/80"}),a.jsx(Xe,{className:"h-64 rounded-2xl bg-white/80"})]}),!_&&j&&a.jsx(ht.div,{variants:ym,custom:.15,initial:"hidden",animate:"visible",children:a.jsxs(ko,{defaultValue:"summary",className:"w-full",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-2",children:[a.jsxs(Vi,{className:"flex flex-nowrap overflow-x-auto gap-1 rounded-full bg-slate-100 p-1 border border-slate-200",children:[a.jsx(on,{value:"summary",className:"px-3 py-1.5 text-xs sm:text-sm rounded-full data-[state=active]:bg-white data-[state=active]:text-slate-900 data-[state=active]:shadow-sm",children:"Summary"}),a.jsx(on,{value:"charts",className:"px-3 py-1.5 text-xs sm:text-sm rounded-full data-[state=active]:bg-white data-[state=active]:text-slate-900 data-[state=active]:shadow-sm",children:"Charts"}),j.table&&a.jsx(on,{value:"details",className:"px-3 py-1.5 text-xs sm:text-sm rounded-full data-[state=active]:bg-white data-[state=active]:text-slate-900 data-[state=active]:shadow-sm",children:"Detailed view"})]}),a.jsxs("div",{className:"hidden md:flex items-center gap-2 text-[10px] text-slate-500",children:[a.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 animate-pulse"}),a.jsxs("span",{children:["Generated for"," ",a.jsx("span",{className:"font-medium text-slate-800",children:j.name})]})]})]}),a.jsxs(ln,{value:"summary",className:"space-y-4 mt-2",children:[V.length>0&&a.jsxs("section",{className:"space-y-2",children:[a.jsxs("h2",{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:[a.jsx("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-slate-100 text-slate-700 border border-slate-200",children:a.jsx(Cm,{className:"w-3 h-3"})}),"Key indicators"]}),a.jsx(ht.div,{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 md:gap-4",variants:RD,initial:"hidden",animate:"visible",children:V.map((J,ne)=>a.jsx(ht.div,{variants:g2,children:a.jsx(xOe,{card:J})},ne))})]}),U[0]&&a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"Primary trend"}),a.jsx(y2,{chart:U[0]})]})]}),a.jsx(ln,{value:"charts",className:"space-y-4 mt-2",children:a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"Chart views"}),a.jsxs(ht.div,{className:"grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-3 md:gap-4",variants:RD,initial:"hidden",animate:"visible",children:[U.map(J=>a.jsx(ht.div,{variants:g2,children:a.jsx(y2,{chart:J})},J.code)),z.map(J=>a.jsx(ht.div,{variants:g2,children:a.jsx(y2,{chart:J})},J.code))]})]})}),j.table&&a.jsx(ln,{value:"details",className:"space-y-4 mt-2",children:a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"Detailed records"}),a.jsx(gOe,{table:j.table})]})})]})})]})]})]})})}function xOe({card:t}){return a.jsxs(ht.div,{whileHover:{y:-2,scale:1.01},transition:{type:"spring",stiffness:240,damping:22},className:_t("rounded-2xl border border-slate-200 bg-white px-3 py-2.5 shadow-sm","flex flex-col gap-1"),children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide font-semibold text-slate-500",children:t.label}),a.jsx("div",{className:"text-xl md:text-2xl font-semibold leading-tight text-slate-900",children:typeof t.value=="number"?t.value.toLocaleString("en-IN",{maximumFractionDigits:1}):t.value}),t.helper&&a.jsx("div",{className:"text-[11px] text-slate-500",children:t.helper})]})}function y2({chart:t}){const n=t.type||"bar",r=Array.isArray(t.data)?t.data:[],s=t.config||{};if(n==="pie"){const o=r.length>0?r.map((l,c)=>({label:l.label??l.name??`Item ${c+1}`,value:l.value??l.amount??0})):[];return a.jsxs(Re,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[a.jsxs(Ye,{className:"pb-2 flex flex-row items-center justify-between",children:[a.jsx(Ze,{className:"text-base font-semibold text-slate-900",children:t.title}),a.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-600 border border-slate-200",children:"Distribution"})]}),a.jsx(Be,{className:"h-56 sm:h-64",children:o.length===0?a.jsx("p",{className:"text-sm text-slate-500 mt-4",children:"No data to display."}):a.jsx(Pd,{width:"100%",height:"100%",children:a.jsxs(LC,{children:[a.jsx(Ey,{data:o,dataKey:"value",nameKey:"label",outerRadius:80,paddingAngle:3,labelLine:!1,label:hOe,children:o.map((l,c)=>a.jsx(xo,{fill:ng[c%ng.length]},`cell-${c}`))}),a.jsx(Dd,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12,color:"#111827"}})]})})})]})}const i=r.length>0?r.map((o,l)=>({label:o.label??o.name??`Item ${l+1}`,value:o.value??o.amount??0})):[];return a.jsxs(Re,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[a.jsxs(Ye,{className:"pb-2 flex flex-row items-center justify-between",children:[a.jsx(Ze,{className:"text-base font-semibold text-slate-900",children:t.title}),a.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-600 border border-slate-200",children:(s==null?void 0:s.label)||"Trend"})]}),a.jsx(Be,{className:"h-56 sm:h-64",children:i.length===0?a.jsx("p",{className:"text-sm text-slate-500 mt-4",children:"No data to display."}):a.jsx(Pd,{width:"100%",height:"100%",children:a.jsxs(Ry,{data:i,margin:{left:8,right:8,top:8,bottom:8},children:[a.jsx(ex,{dataKey:"label",stroke:"#9ca3af",fontSize:11,tickLine:!1,axisLine:{stroke:"#e5e7eb"}}),a.jsx(tx,{stroke:"#9ca3af",fontSize:11,tickLine:!1,axisLine:{stroke:"#e5e7eb"}}),a.jsx(Dd,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12,color:"#111827"}}),a.jsx(Jp,{dataKey:"value",radius:[4,4,0,0],children:i.map((o,l)=>a.jsx(xo,{fill:ng[l%ng.length]},`cell-${l}`))})]})})})]})}function gOe({table:t}){const n=Array.isArray(t.rows)?t.rows:[],r=t.columns&&t.columns.length>0?t.columns:n[0]?Object.keys(n[0]):[];return n.length===0?a.jsx(Re,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:a.jsx(Be,{className:"py-6 flex items-center justify-center",children:a.jsx("p",{className:"text-sm text-slate-500",children:"No records found."})})}):a.jsx(Re,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:a.jsx(Be,{className:"py-3 flex flex-col gap-2 max-h-[480px] overflow-y-auto pr-1",children:a.jsx(su,{children:n.map((s,i)=>a.jsx(ht.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},transition:{duration:.2,ease:"easeOut"},className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2.5 flex flex-col gap-1 text-xs md:text-sm",children:r.map((o,l)=>a.jsxs("div",{className:_t("flex justify-between gap-2",l===0?"font-semibold text-slate-900":"text-slate-700"),children:[a.jsx("span",{className:"text-[10px] uppercase tracking-wide text-slate-500",children:o.replace(/_/g," ")}),a.jsx("span",{className:"text-right truncate max-w-[60%]",children:yOe(s[o])})]},o))},i))})})})}function yOe(t){return t==null?"-":typeof t=="number"?t.toLocaleString("en-IN",{maximumFractionDigits:1}):typeof t=="string"&&t.length>60?t.slice(0,60)+"":String(t)}const kq=t=>{let n={};return typeof t=="string"?t&&(n.q=t):t&&typeof t=="object"&&(n=t),te.get("/patients",{params:n})};function vOe(t){return te.get(`/patients/${t}`)}function bOe(t){return te.post("/patients",t)}function wOe(t,n){return te.put(`/patients/${t}`,n)}function NOe(t){return te.patch(`/patients/${t}/deactivate`)}function jOe(t,{type:n,file:r}){const s=new FormData;return s.append("type",n||"other"),s.append("file",r),te.post(`/patients/${t}/documents`,s,{headers:{"Content-Type":"multipart/form-data"}})}function SOe(t){return te.get(`/patients/${t}/documents`)}function COe(t){return te.get(`/patients/${t}/consents`)}function _Oe(t,n){return te.post(`/patients/${t}/consents`,n)}async function AOe(t){const n=await te.get(`/patients/${t}/print-info`,{responseType:"blob"}),r=n.headers["content-type"]||"application/octet-stream",s=new Blob([n.data],{type:r}),i=URL.createObjectURL(s);window.open(i,"_blank")}function EOe(){return te.get("/patient-masters/all")}function kOe(t){return te.get("/patients/export",{params:t,responseType:"blob"})}function TOe(t,n={}){const r={table_name:"patients",record_id:t,...n};return te.get("/audit-logs",{params:r})}const IOe=["","A+","A-","B+","B-","O+","O-","AB+","AB-"],POe=["","Single","Married","Widowed","Divorced"],MOe=["","Mr","Ms","Mrs","Dr","Baby","Master"],OOe=[{code:"OPD",name:"OPD"},{code:"IPD",name:"IPD"},{code:"EMERGENCY",name:"Emergency"},{code:"HEALTH_CHECK",name:"Health Check"},{code:"CAMP",name:"Camp"},{code:"CORPORATE",name:"Corporate"},{code:"INSURANCE",name:"Insurance"}],DOe=["","insurance","corporate","govt","other"],ROe={prefix:"",first_name:"",last_name:"",gender:"",dob:"",phone:"",email:"",blood_group:"",marital_status:"",ref_source:"",ref_doctor_id:"",ref_details:"",id_proof_type:"",id_proof_no:"",guardian_name:"",guardian_phone:"",guardian_relation:"",patient_type:"",tag:"",religion:"",occupation:"",file_number:"",file_location:"",credit_type:"",credit_payer_id:"",credit_tpa_id:"",credit_plan_id:"",principal_member_name:"",principal_member_address:"",policy_number:"",policy_name:"",family_id:"",address:{type:"current",line1:"",line2:"",city:"",state:"",pincode:"",country:"India"}};function BC(){return JSON.parse(JSON.stringify(ROe))}function LOe(t){if(!t)return BC();const n=t.addresses&&t.addresses[0]||null;return{prefix:t.prefix||"",first_name:t.first_name||"",last_name:t.last_name||"",gender:t.gender||"",dob:t.dob||"",phone:t.phone||"",email:t.email||"",blood_group:t.blood_group||"",marital_status:t.marital_status||"",ref_source:t.ref_source||"",ref_doctor_id:t.ref_doctor_id||"",ref_details:t.ref_details||"",id_proof_type:t.id_proof_type||"",id_proof_no:t.id_proof_no||"",guardian_name:t.guardian_name||"",guardian_phone:t.guardian_phone||"",guardian_relation:t.guardian_relation||"",patient_type:t.patient_type||"",tag:t.tag||"",religion:t.religion||"",occupation:t.occupation||"",file_number:t.file_number||"",file_location:t.file_location||"",credit_type:t.credit_type||"",credit_payer_id:t.credit_payer_id||"",credit_tpa_id:t.credit_tpa_id||"",credit_plan_id:t.credit_plan_id||"",principal_member_name:t.principal_member_name||"",principal_member_address:t.principal_member_address||"",policy_number:t.policy_number||"",policy_name:t.policy_name||"",family_id:t.family_id||"",address:{type:(n==null?void 0:n.type)||"current",line1:(n==null?void 0:n.line1)||"",line2:(n==null?void 0:n.line2)||"",city:(n==null?void 0:n.city)||"",state:(n==null?void 0:n.state)||"",pincode:(n==null?void 0:n.pincode)||"",country:(n==null?void 0:n.country)||"India"}}}function vm(t){if(t==null||t==="")return null;const n=Number(t);return Number.isNaN(n)?null:n}function BOe({open:t,onClose:n,onSaved:r,initialPatient:s,lookups:i}){const[o,l]=b.useState(BC),[c,d]=b.useState(!1),[u,h]=b.useState(""),m=b.useMemo(()=>s?"edit":"create",[s]);if(b.useEffect(()=>{t&&(h(""),l(s?LOe(s):BC()))},[t,s]),!t)return null;const g=M=>O=>{let D=O.target.value;M==="phone"&&(D=D.replace(/\D/g,"").slice(0,10)),l(L=>({...L,[M]:D}))},y=M=>O=>{const D=O.target.value;l(L=>({...L,address:{...L.address,[M]:D}}))},N=async M=>{var O,D;M.preventDefault(),h(""),d(!0);try{const L={...o,ref_doctor_id:vm(o.ref_doctor_id),credit_payer_id:vm(o.credit_payer_id),credit_tpa_id:vm(o.credit_tpa_id),credit_plan_id:vm(o.credit_plan_id),family_id:vm(o.family_id),credit_type:o.credit_type||null,patient_type:o.patient_type||null};let $;m==="create"?$=await bOe(L):$=await wOe(s.id,L),r&&r($.data),n&&n()}catch(L){const $=((D=(O=L==null?void 0:L.response)==null?void 0:O.data)==null?void 0:D.detail)||(L==null?void 0:L.message)||"Failed to save patient";h($)}finally{d(!1)}},{refSources:j,doctors:S,payers:_,tpas:A,creditPlans:k,patientTypes:T}=i||{},P=T&&T.length?T:OOe;return a.jsxs("div",{className:"fixed inset-0 z-50 bg-slate-900/40 backdrop-blur-sm flex items-stretch justify-center",children:[a.jsx("div",{className:"absolute inset-0",onClick:n,"aria-hidden":"true"}),a.jsxs("div",{className:"relative z-10 w-full max-w-6xl h-full sm:h-[95vh] mx-auto my-0 sm:my-4 bg-white rounded-none sm:rounded-3xl shadow-xl flex flex-col overflow-hidden",onClick:M=>M.stopPropagation(),children:[a.jsxs("div",{className:"px-4 sm:px-6 py-3 border-b border-slate-200 flex items-center justify-between",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h2",{className:"text-base sm:text-lg font-semibold text-slate-900",children:m==="create"?"New Patient":"Edit Patient"}),a.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-900/5 px-2 py-0.5 text-[11px] font-medium text-slate-700",children:m==="create"?"Create":"Update"})]}),a.jsx("p",{className:"text-xs text-slate-500",children:"Fill basic details, address and credit / insurance information."})]}),a.jsx("button",{type:"button",onClick:n,className:"h-8 w-8 flex items-center justify-center rounded-full hover:bg-slate-100 text-slate-500 hover:text-slate-900 text-lg leading-none",children:""})]}),a.jsxs("form",{onSubmit:N,className:"flex-1 flex flex-col overflow-hidden",children:[a.jsxs("div",{className:"flex-1 overflow-y-auto px-4 sm:px-6 py-4 space-y-6 bg-slate-50/60",children:[u&&a.jsx("div",{className:"text-sm text-red-600 bg-red-50 border border-red-200 rounded-lg px-3 py-2",children:u}),a.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Basic Information"}),(s==null?void 0:s.uhid)&&a.jsxs("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-slate-900/5 text-slate-700 border border-slate-200",children:["UHID: ",s.uhid]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:["Prefix",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("select",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.prefix,onChange:g("prefix"),required:!0,children:MOe.map(M=>a.jsx("option",{value:M,children:M||"Select"},M))})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:["First Name",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-slate-900/10",value:o.first_name,onChange:g("first_name"),required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Last Name"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.last_name,onChange:g("last_name")})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:["Gender",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.gender,onChange:g("gender"),required:!0,children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{value:"male",children:"Male"}),a.jsx("option",{value:"female",children:"Female"}),a.jsx("option",{value:"other",children:"Other"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:["Date of Birth",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"date",className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.dob||"",onChange:g("dob"),required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Blood Group"}),a.jsx("select",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.blood_group,onChange:g("blood_group"),children:IOe.map(M=>a.jsx("option",{value:M,children:M||"Select"},M))})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:["Marital Status",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("select",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.marital_status,onChange:g("marital_status"),required:!0,children:POe.map(M=>a.jsx("option",{value:M,children:M||"Select"},M))})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:["Mobile",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.phone,onChange:g("phone"),required:!0}),a.jsx("p",{className:"mt-0.5 text-[11px] text-slate-400",children:"10 digit mobile number"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:["Email",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"email",className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.email,onChange:g("email"),required:!0})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:["Patient Type",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.patient_type||"",onChange:g("patient_type"),required:!0,children:[a.jsx("option",{value:"",children:"Select"}),P.map(M=>a.jsx("option",{value:M.code||M.name,children:M.name||M.code},M.code||M.name))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Tag"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.tag,onChange:g("tag")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Religion"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.religion,onChange:g("religion")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Occupation"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.occupation,onChange:g("occupation")})]})]})]}),a.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-3",children:[a.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Reference & Guardian"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Reference Source"}),a.jsxs("select",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.ref_source,onChange:g("ref_source"),children:[a.jsx("option",{value:"",children:"Select"}),j==null?void 0:j.map(M=>a.jsx("option",{value:M.code,children:M.label},M.code))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Referring Doctor"}),a.jsxs("select",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.ref_doctor_id||"",onChange:g("ref_doctor_id"),children:[a.jsx("option",{value:"",children:"Select"}),S==null?void 0:S.map(M=>a.jsxs("option",{value:M.id,children:[M.name,M.department_name?` (${M.department_name})`:""]},M.id))]})]}),a.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Reference Details"}),a.jsx("textarea",{rows:2,className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.ref_details,onChange:g("ref_details")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Guardian Name"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.guardian_name,onChange:g("guardian_name")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Guardian Phone"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.guardian_phone,onChange:g("guardian_phone")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Guardian Relation"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.guardian_relation,onChange:g("guardian_relation")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"ID Proof Type"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.id_proof_type,onChange:g("id_proof_type")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"ID Proof No"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.id_proof_no,onChange:g("id_proof_no")})]})]})]}),a.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-3",children:[a.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Address"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"sm:col-span-2",children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Address Line 1"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.address.line1,onChange:y("line1")})]}),a.jsxs("div",{className:"sm:col-span-2",children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Address Line 2"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.address.line2,onChange:y("line2")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"City"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.address.city,onChange:y("city")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"State"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.address.state,onChange:y("state")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Pincode"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.address.pincode,onChange:y("pincode")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Country"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.address.country,onChange:y("country")})]})]})]}),a.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-3",children:[a.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"File & Credit / Insurance"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"File Number"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.file_number,onChange:g("file_number")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"File Location"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.file_location,onChange:g("file_location")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Credit Type"}),a.jsx("select",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.credit_type,onChange:g("credit_type"),children:DOe.map(M=>a.jsx("option",{value:M,children:M||"Select"},M))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Payer"}),a.jsxs("select",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.credit_payer_id||"",onChange:g("credit_payer_id"),children:[a.jsx("option",{value:"",children:"Select"}),_==null?void 0:_.map(M=>a.jsx("option",{value:M.id,children:M.display_name||M.name},M.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"TPA"}),a.jsxs("select",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.credit_tpa_id||"",onChange:g("credit_tpa_id"),children:[a.jsx("option",{value:"",children:"Select"}),A==null?void 0:A.map(M=>a.jsx("option",{value:M.id,children:M.display_name||M.name},M.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Credit Plan"}),a.jsxs("select",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.credit_plan_id||"",onChange:g("credit_plan_id"),children:[a.jsx("option",{value:"",children:"Select"}),k==null?void 0:k.map(M=>a.jsx("option",{value:M.id,children:M.name},M.id))]})]}),a.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Principal Member Name"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.principal_member_name,onChange:g("principal_member_name")})]}),a.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Principal Member Address"}),a.jsx("textarea",{rows:2,className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.principal_member_address,onChange:g("principal_member_address")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Policy Number"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.policy_number,onChange:g("policy_number")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Policy Name"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.policy_name,onChange:g("policy_name")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Family ID"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:o.family_id,onChange:g("family_id")})]})]})]})]}),a.jsxs("div",{className:"border-t border-slate-200 px-4 sm:px-6 py-3 bg-white flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-2",children:[a.jsxs("p",{className:"text-[11px] text-slate-500",children:["Fields marked with ",a.jsx("span",{className:"text-red-500",children:"*"})," are mandatory."]}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx("button",{type:"button",onClick:n,className:"px-3 py-1.5 text-sm border border-slate-200 rounded-lg text-slate-700 hover:bg-slate-50",disabled:c,children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-1.5 text-sm rounded-lg bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",disabled:c,children:c?m==="create"?"Creating...":"Saving...":m==="create"?"Create Patient":"Save Changes"})]})]})]})]})]})}function Gn(t){return t||""}function FOe(t){return t?{doctor:"Doctor",google:"Google",social_media:"Social Media",ads:"Advertisements",other:"Other"}[t]||t:""}function LD(t){if(t==null)return"";if(typeof t=="string"){const n=t.trim();return n?n.length>24?`${n.slice(0,24)}`:n:""}if(typeof t=="number"||typeof t=="boolean")return String(t);try{const n=JSON.stringify(t);return n.length>24?`${n.slice(0,24)}`:n}catch{return""}}function $Oe(t){const n=(t==null?void 0:t.old_values)||{},r=(t==null?void 0:t.new_values)||{},s=Array.from(new Set([...Object.keys(n||{}),...Object.keys(r||{})])),i=[];for(const o of s){const l=n?n[o]:void 0,c=r?r[o]:void 0,d=l===void 0?void 0:JSON.stringify(l),u=c===void 0?void 0:JSON.stringify(c);d!==u&&i.push({field:o,before:l,after:c})}return i}function zOe({open:t,onClose:n,patient:r,onUpdated:s}){const[i,o]=b.useState(null),[l,c]=b.useState([]),[d,u]=b.useState([]),[h,m]=b.useState([]),[g,y]=b.useState(!1),[N,j]=b.useState(!1),[S,_]=b.useState(!1),[A,k]=b.useState(!1),[T,P]=b.useState(""),[M,O]=b.useState(null),[D,L]=b.useState("other"),[$,V]=b.useState(""),[F,Q]=b.useState(""),[U,z]=b.useState(""),[q,K]=b.useState(""),[X,J]=b.useState("idle"),[ne,Se]=b.useState(null),[de,ye]=b.useState(""),[be,xe]=b.useState("");b.useEffect(()=>{t&&r&&_e(r.id)},[t,r==null?void 0:r.id]);const _e=async Ie=>{var qe,se;y(!0),P("");try{const[le,De,Nt]=await Promise.all([vOe(Ie),SOe(Ie),COe(Ie)]);o(le.data),c(De.data||[]),u(Nt.data||[]),s&&s(le.data)}catch(le){const De=((se=(qe=le==null?void 0:le.response)==null?void 0:qe.data)==null?void 0:se.detail)||(le==null?void 0:le.message)||"Failed to load patient details";P(De)}finally{y(!1)}k(!0);try{const le=await TOe(Ie,{limit:30});m(le.data||[])}catch{}finally{k(!1)}};if(!t||!r)return null;const we=i||r,Oe=we.addresses&&we.addresses[0]||null,ae=we.age_text||"",ie=async Ie=>{var qe,se;if(Ie.preventDefault(),!!M){j(!0),P("");try{const le=await jOe(we.id,{type:D,file:M});c(De=>[le.data,...De]),O(null),L("other")}catch(le){const De=((se=(qe=le==null?void 0:le.response)==null?void 0:qe.data)==null?void 0:se.detail)||(le==null?void 0:le.message)||"Failed to upload document";P(De)}finally{j(!1)}}},pe=async Ie=>{var qe,se;if(Ie.preventDefault(),!(!$||!F)){_(!0),P("");try{const le=await _Oe(we.id,{type:$,text:F});u(De=>[le.data,...De]),V(""),Q("")}catch(le){const De=((se=(qe=le==null?void 0:le.response)==null?void 0:qe.data)==null?void 0:se.detail)||(le==null?void 0:le.message)||"Failed to save consent";P(De)}finally{_(!1)}}},re=async()=>{var Ie,qe;try{await AOe(we.id)}catch(se){const le=((qe=(Ie=se==null?void 0:se.response)==null?void 0:Ie.data)==null?void 0:qe.detail)||(se==null?void 0:se.message)||"Failed to open print view";P(le)}},We=async Ie=>{var qe,se;P("");try{const le=await te.get(`/patients/documents/${Ie.id}/file`,{responseType:"blob"}),De=le.data,Nt=le.headers["content-type"]||Ie.mime||Ie.content_type||Ie.mime_type||"",sn=URL.createObjectURL(Nt?new Blob([De],{type:Nt}):De);Se(Ie),ye(sn),xe(Nt)}catch(le){const De=((se=(qe=le==null?void 0:le.response)==null?void 0:qe.data)==null?void 0:se.detail)||(le==null?void 0:le.message)||"Failed to load attachment for preview";P(De)}},Je=()=>{de&&URL.revokeObjectURL(de),Se(null),ye(""),xe("")},St=async Ie=>{var qe,se;P("");try{const le=await te.get(`/patients/documents/${Ie.id}/file`,{responseType:"blob"}),De=le.data,Nt=le.headers["content-type"]||Ie.mime||Ie.content_type||Ie.mime_type||"application/octet-stream",sn=URL.createObjectURL(Nt?new Blob([De],{type:Nt}):De),Yt=document.createElement("a");Yt.href=sn,Yt.download=Ie.filename||"document",document.body.appendChild(Yt),Yt.click(),Yt.remove(),URL.revokeObjectURL(sn)}catch(le){const De=((se=(qe=le==null?void 0:le.response)==null?void 0:qe.data)==null?void 0:se.detail)||(le==null?void 0:le.message)||"Failed to download attachment";P(De)}},wt=ne&&((be==null?void 0:be.startsWith("image/"))||/\.(png|jpe?g|gif|webp|bmp)$/i.test(ne.filename||"")),ft=ne&&(be==="application/pdf"||/\.pdf$/i.test(ne.filename||""));return a.jsxs("div",{className:"fixed inset-0 z-50 bg-slate-900/40 backdrop-blur-sm flex items-stretch justify-center",children:[a.jsx("div",{className:"absolute inset-0",onClick:n,"aria-hidden":"true"}),a.jsxs("div",{className:"relative z-10 w-full max-w-5xl h-full sm:h-[95vh] mx-auto my-0 sm:my-4 bg-white rounded-none sm:rounded-3xl shadow-xl flex flex-col overflow-hidden",onClick:Ie=>Ie.stopPropagation(),children:[a.jsxs("div",{className:"px-4 sm:px-6 py-3 border-b border-slate-200 flex items-center justify-between",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsxs("h2",{className:"text-base sm:text-lg font-semibold text-slate-900",children:[we.first_name," ",we.last_name||""]}),a.jsxs("p",{className:"text-xs text-slate-500",children:["UHID: ",we.uhid,"  Age: ",ae||""]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[we.patient_type&&a.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-900/5 text-[11px] text-slate-700 border border-slate-200",children:we.patient_type}),we.tag&&a.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-50 text-[11px] text-emerald-700 border border-emerald-100",children:we.tag}),a.jsx("button",{type:"button",onClick:n,className:"h-8 w-8 flex items-center justify-center rounded-full hover:bg-slate-100 text-slate-500 hover:text-slate-900 text-lg leading-none",children:""})]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto px-4 sm:px-6 py-4 space-y-4 bg-slate-50/60",children:[g&&a.jsx("div",{className:"text-xs text-slate-500",children:"Loading details"}),T&&a.jsx("div",{className:"text-xs text-red-600 bg-red-50 border border-red-200 rounded-lg px-3 py-2",children:T}),a.jsx("section",{className:"bg-white border border-slate-200 rounded-2xl p-3 sm:p-4 flex flex-wrap gap-2 items-center",children:a.jsx("button",{type:"button",onClick:re,className:"px-3 py-1.5 text-sm rounded-lg border border-slate-200 text-black bg-green-500 hover:bg-slate-50",children:"Print Info / PDF"})}),a.jsxs("section",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"bg-white border border-slate-200 rounded-2xl p-3 sm:p-4 space-y-2",children:[a.jsx("h3",{className:"text-xs font-semibold text-slate-800 mb-1.5",children:"Patient Info"}),a.jsxs("div",{className:"grid grid-cols-2 gap-1.5 text-xs",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-slate-600",children:"Gender: "}),a.jsx("span",{className:"font-medium text-slate-800",children:Gn(we.gender)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-slate-600",children:"DOB: "}),a.jsx("span",{className:"font-medium text-slate-800",children:we.dob||""})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-slate-600",children:"Age: "}),a.jsx("span",{className:"font-medium text-slate-800",children:ae||""})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Blood Group:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Gn(we.blood_group)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Marital Status:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Gn(we.marital_status)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-slate-600",children:"Mobile: "}),a.jsx("span",{className:"font-medium text-slate-800",children:Gn(we.phone)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-slate-600",children:"Email: "}),a.jsx("span",{className:"font-medium text-slate-800",children:Gn(we.email)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Patient Type:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Gn(we.patient_type)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-slate-600",children:"Tag: "}),a.jsx("span",{className:"font-medium text-slate-800",children:Gn(we.tag)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Religion:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Gn(we.religion)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Occupation:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Gn(we.occupation)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["File No:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Gn(we.file_number)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["File Location:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Gn(we.file_location)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Guardian:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Gn(we.guardian_name)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Guardian Phone:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Gn(we.guardian_phone)})]})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"bg-white border border-slate-200 rounded-2xl p-3 sm:p-4 space-y-2",children:[a.jsx("h3",{className:"text-xs font-semibold text-slate-800 mb-1.5",children:"Reference & Credit / Insurance"}),a.jsxs("div",{className:"grid grid-cols-2 gap-1.5 text-xs",children:[a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Reference Source:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:FOe(we.ref_source)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Referring Doctor:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Gn(we.ref_doctor_name)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Credit Type:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Gn(we.credit_type)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Payer:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Gn(we.credit_payer_name)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["TPA:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Gn(we.credit_tpa_name)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Credit Plan:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Gn(we.credit_plan_name)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Policy Number:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Gn(we.policy_number)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Policy Name:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Gn(we.policy_name)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Principal Member:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Gn(we.principal_member_name)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Family ID:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Gn(we.family_id)})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Principal Member Address:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Gn(we.principal_member_address)})]})]})]}),a.jsxs("div",{className:"bg-white border border-slate-200 rounded-2xl p-3 sm:p-4",children:[a.jsx("h3",{className:"text-xs font-semibold text-slate-800 mb-1.5",children:"Address"}),a.jsx("p",{className:"text-xs text-slate-700",children:Oe?a.jsxs(a.Fragment,{children:[Oe.line1,a.jsx("br",{}),Oe.line2&&a.jsxs(a.Fragment,{children:[Oe.line2,a.jsx("br",{})]}),[Oe.city,Oe.state,Oe.pincode].filter(Boolean).join(", "),a.jsx("br",{}),Oe.country]}):""})]})]})]}),a.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl p-3 sm:p-4 space-y-2",children:[a.jsx("div",{className:"flex items-center justify-between gap-2",children:a.jsx("h3",{className:"text-xs font-semibold text-slate-800",children:"Attachments"})}),a.jsxs("form",{onSubmit:ie,className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 text-xs",children:[a.jsxs("select",{className:"border border-slate-200 rounded-lg px-1.5 py-1 text-xs text-black",value:D,onChange:Ie=>L(Ie.target.value),children:[a.jsx("option",{value:"other",children:"Other"}),a.jsx("option",{value:"id_proof",children:"ID Proof"}),a.jsx("option",{value:"report",children:"Report"}),a.jsx("option",{value:"photo",children:"Photo"})]}),a.jsx("input",{type:"file",className:"flex-1 text-xs text-gray-700",onChange:Ie=>O(Ie.target.files[0]||null)}),a.jsx("button",{type:"submit",disabled:N||!M,className:"px-2 py-1 rounded-lg bg-slate-900 text-white disabled:opacity-60",children:N?"Uploading":"Upload"})]}),a.jsxs("ul",{className:"divide-y border border-slate-200 rounded-lg bg-slate-50/60",children:[l.length===0&&a.jsx("li",{className:"text-xs text-slate-500 px-2 py-2",children:"No attachments yet."}),l.map(Ie=>a.jsxs("li",{className:"px-2 py-1.5 text-xs flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"font-medium text-slate-800 truncate",children:Ie.filename}),a.jsxs("div",{className:"text-[10px] text-slate-500",children:[Ie.type||"other"," "," ",Ie.size?`${(Ie.size/1024).toFixed(1)} KB`:""]})]}),a.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[a.jsx("button",{type:"button",onClick:()=>We(Ie),className:"px-2 py-1 rounded-lg border border-slate-200 bg-white text-[11px] text-slate-700 hover:bg-slate-100",children:"Preview"}),a.jsx("button",{type:"button",onClick:()=>St(Ie),className:"px-2 py-1 rounded-lg bg-slate-900 text-white text-[11px] hover:bg-slate-800",children:"Download"})]})]},Ie.id))]})]}),a.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl p-3 sm:p-4 space-y-2",children:[a.jsx("h3",{className:"text-xs font-semibold text-slate-800",children:"Consents"}),a.jsxs("form",{onSubmit:pe,className:"space-y-1.5 text-xs",children:[a.jsx("div",{className:"flex flex-col sm:flex-row gap-2",children:a.jsx("input",{className:"flex-1 border border-slate-200 rounded-lg px-2 py-1 text-xs",placeholder:"Consent type (eg. General, Surgery)",value:$,onChange:Ie=>V(Ie.target.value)})}),a.jsx("textarea",{rows:2,className:"w-full border border-slate-200 rounded-lg px-2 py-1 text-xs",placeholder:"Consent text",value:F,onChange:Ie=>Q(Ie.target.value)}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{type:"submit",disabled:S||!$||!F,className:"px-3 py-1 rounded-lg bg-slate-900 text-white disabled:opacity-60",children:S?"Saving":"Add Consent"})})]}),a.jsxs("ul",{className:"divide-y border border-slate-200 rounded-lg bg-slate-50/60",children:[d.length===0&&a.jsx("li",{className:"text-xs text-slate-500 px-2 py-2",children:"No consents captured yet."}),d.map(Ie=>a.jsxs("li",{className:"px-2 py-1.5 text-xs",children:[a.jsx("div",{className:"font-medium text-slate-800",children:Ie.type}),a.jsx("div",{className:"text-[11px] text-slate-500 mb-0.5",children:new Date(Ie.captured_at).toLocaleString()}),a.jsx("div",{className:"text-xs text-slate-800 whitespace-pre-line",children:Ie.text})]},Ie.id))]})]}),a.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl p-3 sm:p-4 space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("h3",{className:"text-xs font-semibold text-slate-800",children:"Activity / Audit Trail"}),a.jsx("div",{className:"text-[11px] text-slate-500",children:A?"Loading":h.length?`Latest ${h.length} change${h.length>1?"s":""}`:"No history yet"})]}),h.length===0&&!A&&a.jsx("p",{className:"text-[11px] text-slate-500",children:"No change history captured yet for this patient."}),h.length>0&&a.jsx("ol",{className:"space-y-2",children:h.map(Ie=>{const qe=$Oe(Ie),se=qe.length>3?qe.length-3:0,le=Ie.user_name||Ie.user_email||(Ie.user_id?`User #${Ie.user_id}`:"System"),De=Ie.created_at?new Date(Ie.created_at).toLocaleString():"";return a.jsxs("li",{className:"flex gap-2",children:[a.jsxs("div",{className:"flex flex-col items-center pt-1",children:[a.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-900"}),a.jsx("div",{className:"mt-1 flex-1 w-px bg-slate-200"})]}),a.jsxs("div",{className:"flex-1 rounded-xl border border-slate-200 bg-slate-50/80 px-2.5 py-2",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-1",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 text-[11px]",children:[a.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-900 text-white px-1.5 py-0.5 text-[10px] tracking-wide",children:Ie.action||"UPDATE"}),a.jsx("span",{className:"text-slate-700",children:le})]}),De&&a.jsx("div",{className:"text-[10px] text-slate-500",children:De})]}),qe.length>0&&a.jsxs("ul",{className:"mt-1.5 space-y-0.5 text-[11px] text-slate-700",children:[qe.slice(0,3).map(Nt=>a.jsxs("li",{className:"flex flex-wrap gap-1",children:[a.jsx("span",{className:"font-medium",children:Nt.field}),a.jsx("span",{className:"text-slate-500",children:"changed"}),a.jsx("span",{className:"line-through text-slate-400",children:LD(Nt.before)}),a.jsx("span",{className:"mx-1 text-slate-400",children:""}),a.jsx("span",{className:"font-medium",children:LD(Nt.after)})]},Nt.field)),se>0&&a.jsxs("li",{className:"text-[10px] text-slate-500",children:["+",se," more field",se>1?"s":""," updated"]})]}),qe.length===0&&(Ie.old_values||Ie.new_values)&&a.jsx("p",{className:"mt-1.5 text-[11px] text-slate-600",children:"Multiple fields updated."}),(Ie.ip_address||Ie.user_agent)&&a.jsxs("p",{className:"mt-1 text-[10px] text-slate-400",children:[Ie.ip_address&&a.jsxs("span",{children:["IP: ",Ie.ip_address]}),Ie.ip_address&&Ie.user_agent&&a.jsx("span",{className:"mx-1",children:""}),Ie.user_agent&&a.jsx("span",{className:"line-clamp-1",children:Ie.user_agent})]})]})]},Ie.id)})})]})]})]}),ne&&a.jsx("div",{className:"fixed inset-0 z-[60] bg-slate-900/60 backdrop-blur-sm flex items-center justify-center",children:a.jsxs("div",{className:"relative w-full max-w-3xl h-[80vh] bg-white rounded-2xl shadow-xl flex flex-col overflow-hidden",onClick:Ie=>Ie.stopPropagation(),children:[a.jsxs("div",{className:"px-4 py-2 border-b border-slate-200 flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-sm font-semibold text-slate-900",children:["Preview  ",ne.filename]}),a.jsx("p",{className:"text-[11px] text-slate-500",children:be||"Unknown type"})]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("button",{type:"button",onClick:Je,className:"h-8 w-8 flex items-center justify-center rounded-full hover:bg-slate-100 text-slate-500 hover:text-slate-900 text-lg leading-none",children:""})})]}),a.jsxs("div",{className:"flex-1 bg-slate-50 flex items-center justify-center",children:[wt&&a.jsx("img",{src:de,alt:ne.filename,className:"max-h-full max-w-full object-contain"}),ft&&a.jsx("iframe",{src:de,title:ne.filename,className:"w-full h-full"}),!wt&&!ft&&a.jsxs("div",{className:"text-xs text-slate-600 px-4 text-center space-y-2",children:[a.jsx("p",{children:"This file type cannot be previewed inline."}),a.jsx("button",{type:"button",onClick:()=>St(ne),className:"inline-flex px-3 py-1.5 rounded-lg bg-slate-900 text-white text-xs hover:bg-slate-800",children:"Download file"})]})]})]})})]})}function UOe(){const[t,n]=b.useState([]),[r,s]=b.useState(!1),[i,o]=b.useState(""),[l,c]=b.useState(!1),[d,u]=b.useState(!1),[h,m]=b.useState(null),[g,y]=b.useState(null),[N,j]=b.useState({refSources:[],doctors:[],payers:[],tpas:[],creditPlans:[],patientTypes:[]}),[S,_]=b.useState(""),[A,k]=b.useState(""),[T,P]=b.useState(""),[M,O]=b.useState(""),[D,L]=b.useState(!1);b.useEffect(()=>{$(),V()},[]);const $=async(de=i)=>{var ye,be;s(!0),_("");try{const xe={};de&&(xe.q=de),A&&(xe.patient_type=A);const _e=await kq(xe);n(_e.data||[])}catch(xe){const _e=((be=(ye=xe==null?void 0:xe.response)==null?void 0:ye.data)==null?void 0:be.detail)||(xe==null?void 0:xe.message)||"Failed to load patients";_(_e),fe.error("Failed to load patients",{description:_e})}finally{s(!1)}},V=async()=>{try{const ye=(await EOe()).data||{};j({refSources:ye.reference_sources||[],doctors:ye.doctors||[],payers:ye.payers||[],tpas:ye.tpas||[],creditPlans:ye.credit_plans||[],patientTypes:ye.patient_types||[]})}catch{}},F=de=>{de.preventDefault(),$(i)},Q=()=>{$(i)},U=()=>{k(""),o(""),$("")},z=()=>{y(null),c(!0)},q=de=>{y(de),c(!0)},K=de=>{m(de),u(!0)},X=async de=>{var ye,be;if(window.confirm(`Deactivate patient ${de.first_name}?`))try{await NOe(de.id),fe.success("Patient deactivated"),await $()}catch(xe){const _e=((be=(ye=xe==null?void 0:xe.response)==null?void 0:ye.data)==null?void 0:be.detail)||(xe==null?void 0:xe.message)||"Failed to deactivate patient";fe.error("Failed to deactivate patient",{description:_e})}},J=de=>{n(ye=>{const be=ye.findIndex(_e=>_e.id===de.id);if(be===-1)return ye;const xe=[...ye];return xe[be]=de,xe})},ne=async()=>{var de,ye;if(!T||!M){fe.warning("Please select From and To date for Excel export");return}if(M<T){fe.warning("To Date must be on or after From Date");return}L(!0);try{const be={from_date:T,to_date:M};A&&(be.patient_type=A);const xe=await kOe(be),_e=new Blob([xe.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),we=window.URL.createObjectURL(_e),Oe=document.createElement("a");Oe.href=we,Oe.download=`patients_${T}_to_${M}.xlsx`,document.body.appendChild(Oe),Oe.click(),Oe.remove(),window.URL.revokeObjectURL(we),fe.success("Patient Excel report downloaded")}catch(be){const xe=((ye=(de=be==null?void 0:be.response)==null?void 0:de.data)==null?void 0:ye.detail)||(be==null?void 0:be.message)||"Failed to export Excel";fe.error("Failed to export Excel",{description:xe})}finally{L(!1)}},Se=b.useMemo(()=>N.patientTypes||[],[N.patientTypes]);return a.jsxs("div",{className:"h-full flex flex-col px-3 py-3 sm:px-5 sm:py-4 gap-3 text-black rounded",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-semibold text-slate-900",children:"Patient Management"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Register patients, manage profiles, attachments, consents and ABHA."})]}),a.jsx("button",{type:"button",onClick:z,className:"self-start px-3 py-1.5 text-sm rounded-lg bg-slate-900 text-white hover:bg-slate-800",children:"+ New Patient"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("form",{onSubmit:F,className:"flex flex-col sm:flex-row gap-2",children:[a.jsx("input",{className:"flex-1 border border-slate-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-slate-900/10",placeholder:"Search by UHID, name, mobile, email...",value:i,onChange:de=>o(de.target.value)}),a.jsx("button",{type:"submit",className:"px-3 py-2 text-sm rounded-lg border border-slate-200 bg-white text-slate-700 hover:bg-slate-50",children:"Search"})]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:items-end md:justify-between",children:[a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-[11px] text-slate-500 mb-0.5",children:"Patient Type"}),a.jsxs("select",{className:"min-w-[160px] border border-slate-200 rounded-lg px-2.5 py-1.5 text-sm",value:A,onChange:de=>k(de.target.value),children:[a.jsx("option",{value:"",children:"All Types"}),Se.map(de=>a.jsx("option",{value:de.code||de.name,children:de.name||de.code},de.code||de.name))]})]}),a.jsxs("div",{className:"flex items-end gap-2",children:[a.jsx("button",{type:"button",onClick:Q,className:"px-3 py-1.5 text-xs rounded-lg border border-slate-200 bg-white text-slate-700 hover:bg-slate-50",children:"Apply Filter"}),a.jsx("button",{type:"button",onClick:U,className:"px-3 py-1.5 text-xs rounded-lg border border-slate-200 bg-white text-slate-500 hover:bg-slate-50",children:"Reset"})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 items-end",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-[11px] text-slate-500 mb-0.5",children:"From Date"}),a.jsx("input",{type:"date",className:"border border-slate-200 rounded-lg px-2.5 py-1.5 text-sm",value:T,onChange:de=>P(de.target.value)})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-[11px] text-slate-500 mb-0.5",children:"To Date"}),a.jsx("input",{type:"date",className:"border border-slate-200 rounded-lg px-2.5 py-1.5 text-sm",value:M,onChange:de=>O(de.target.value)})]}),a.jsx("button",{type:"button",onClick:ne,disabled:D,className:"px-3 py-1.5 text-xs rounded-lg bg-emerald-600 text-white hover:bg-emerald-700 disabled:opacity-60",children:D?"Exporting":"Export Excel"})]})]})]}),S&&a.jsx("div",{className:"text-xs text-red-600 bg-red-50 border border-red-200 rounded-lg px-3 py-2",children:S}),a.jsx("div",{className:"hidden md:block flex-1 border border-slate-200 rounded-2xl overflow-auto bg-white shadow-sm",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-600",children:"UHID / Name"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-600",children:"Demographics"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-600",children:"Contact"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-600",children:"Tags"}),a.jsx("th",{className:"px-3 py-2 text-right text-xs font-semibold text-slate-600",children:"Actions"})]})}),a.jsxs("tbody",{children:[r&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-3 py-4 text-center text-xs text-slate-500",children:"Loading patients"})}),!r&&t.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-3 py-4 text-center text-xs text-slate-500",children:"No patients found."})}),t.map((de,ye)=>a.jsxs("tr",{className:`border-t border-slate-100 hover:bg-slate-50/70 ${ye%2===1?"bg-slate-50/40":""}`,children:[a.jsxs("td",{className:"px-3 py-2 align-top",children:[a.jsxs("div",{className:"font-medium text-slate-900",children:[de.first_name," ",de.last_name||""]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID: ",de.uhid]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Age: ",de.age_text||""]})]}),a.jsxs("td",{className:"px-3 py-2 align-top text-xs text-slate-700",children:[a.jsxs("div",{children:["Gender: ",de.gender]}),a.jsxs("div",{children:["Blood: ",de.blood_group||""]}),a.jsxs("div",{children:["Marital: ",de.marital_status||""]})]}),a.jsxs("td",{className:"px-3 py-2 align-top text-xs text-slate-700",children:[a.jsxs("div",{children:["Mobile: ",de.phone||""]}),a.jsxs("div",{children:["Email: ",de.email||""]})]}),a.jsxs("td",{className:"px-3 py-2 align-top text-xs text-slate-700",children:[a.jsxs("div",{children:["Type: ",de.patient_type||""]}),a.jsxs("div",{children:["Tag: ",de.tag||""]})]}),a.jsx("td",{className:"px-3 py-2 align-top text-right text-xs",children:a.jsxs("div",{className:"flex justify-end gap-1",children:[a.jsx("button",{type:"button",onClick:()=>K(de),className:"px-2 py-1 rounded-md border border-slate-200 text-slate-700 hover:bg-slate-50",children:"View"}),a.jsx("button",{type:"button",onClick:()=>q(de),className:"px-2 py-1 rounded-md border border-slate-200 text-slate-700 hover:bg-slate-50",children:"Edit"}),a.jsx("button",{type:"button",onClick:()=>X(de),className:"px-2 py-1 rounded-md border border-red-200 text-red-600 hover:bg-red-50",children:"Deactivate"})]})})]},de.id))]})]})}),a.jsxs("div",{className:"md:hidden space-y-2",children:[r&&a.jsx("div",{className:"text-xs text-slate-500",children:"Loading patients"}),!r&&t.length===0&&a.jsx("div",{className:"text-xs text-slate-500",children:"No patients found."}),t.map(de=>a.jsxs("div",{className:"bg-white border border-slate-200 rounded-2xl px-3 py-2 shadow-sm",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:[de.first_name," ",de.last_name||""]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID: ",de.uhid,"  Age: ",de.age_text||""]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:[de.gender,"  Blood: ",de.blood_group||""]}),a.jsx("div",{className:"text-[11px] text-slate-500",children:de.phone||"No mobile"})]}),a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("button",{type:"button",onClick:()=>K(de),className:"px-2 py-1 text-[11px] rounded-md border border-slate-200 text-slate-700",children:"View"}),a.jsx("button",{type:"button",onClick:()=>q(de),className:"px-2 py-1 text-[11px] rounded-md border border-slate-200 text-slate-700",children:"Edit"}),a.jsx("button",{type:"button",onClick:()=>X(de),className:"px-2 py-1 text-[11px] rounded-md border border-red-200 text-red-600",children:"Deactivate"})]})]}),a.jsxs("div",{className:"mt-1.5 flex flex-wrap gap-1 text-[10px] text-slate-600",children:[de.patient_type&&a.jsx("span",{className:"px-1.5 py-0.5 rounded-full bg-slate-900/5 text-slate-900 border border-slate-200",children:de.patient_type}),de.tag&&a.jsx("span",{className:"px-1.5 py-0.5 rounded-full bg-emerald-50 text-emerald-700 border border-emerald-100",children:de.tag})]})]},de.id))]}),a.jsx(BOe,{open:l,onClose:()=>c(!1),onSaved:()=>$(),initialPatient:g,lookups:N}),a.jsx(zOe,{open:d,onClose:()=>u(!1),patient:h,onUpdated:J})]})}function Ps(t){const n=Cr(l=>l.user),r=Cr(l=>l.modules)||{};if(!t||!n)return!1;if(n.is_admin||(n.roles||[]).some(l=>l.name==="Admin"||l.code==="admin"))return!0;const[i]=t.split(".");return(r[i]||[]).some(l=>l.code===t)}const VOe=[{value:"insurance",label:"Insurance"},{value:"corporate",label:"Corporate"},{value:"govt",label:"Govt Scheme"},{value:"other",label:"Other"}];function HOe(){const[t,n]=b.useState("payers");return Ps("patients.masters.view")?a.jsxs("div",{className:"space-y-4 bg-white p-3 rounded",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between gap-3",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(fl,{className:"h-5 w-5 text-blue-600"}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-black",children:"Patient Masters"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Configure patient types, payers, TPAs and credit plans used in registration & billing."})]})]})}),a.jsxs("div",{className:"flex flex-wrap gap-2 border-b",children:[a.jsx(rg,{label:"Patient Types",active:t==="types",onClick:()=>n("types")}),a.jsx(rg,{label:"Payers",active:t==="payers",onClick:()=>n("payers")}),a.jsx(rg,{label:"TPAs",active:t==="tpas",onClick:()=>n("tpas")}),a.jsx(rg,{label:"Credit Plans",active:t==="plans",onClick:()=>n("plans")})]}),a.jsxs("div",{children:[t==="types"&&a.jsx(WOe,{}),t==="payers"&&a.jsx(GOe,{}),t==="tpas"&&a.jsx(YOe,{}),t==="plans"&&a.jsx(QOe,{})]})]}):a.jsx("div",{className:"rounded-2xl border border-yellow-200 bg-yellow-50 p-4 text-sm text-yellow-800",children:"You do not have permission to view patient masters."})}function rg({label:t,active:n,onClick:r}){return a.jsx("button",{onClick:r,className:`px-3 py-2 text-sm transition ${n?"border-b-2 border-blue-600 font-medium text-blue-700":"text-gray-600 hover:text-gray-800"}`,children:t})}function WOe(){const t=Ps("patients.view")||Ps("patients.masters.view"),n=Ps("patients.update")||Ps("patients.masters.manage"),[r,s]=b.useState([]),[i,o]=b.useState(!1),[l,c]=b.useState(""),[d,u]=b.useState(""),[h,m]=b.useState(!1),[g,y]=b.useState(null),N=b.useCallback(async()=>{var T,P;if(t){o(!0),c("");try{const{data:M}=await te.get("/patient-types",{params:{include_inactive:!0}});s(M||[])}catch(M){c(((P=(T=M==null?void 0:M.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to load patient types")}finally{o(!1)}}},[t]);b.useEffect(()=>{N()},[N]);const j=b.useMemo(()=>{if(!d)return r;const T=d.toLowerCase();return r.filter(P=>{var M,O,D;return((M=P.name)==null?void 0:M.toLowerCase().includes(T))||((O=P.code)==null?void 0:O.toLowerCase().includes(T))||((D=P.description)==null?void 0:D.toLowerCase().includes(T))})},[r,d]),S=()=>{y(null),m(!0)},_=T=>{n&&(y(T),m(!0))},A=()=>{m(!1),y(null),N()},k=()=>{N()};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[a.jsx(_o,{className:"h-4 w-4"}),a.jsx("span",{children:"Patient types used in registration: Emergency, OPD, IPD, Health Checkup, etc."})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{value:d,onChange:T=>u(T.target.value),placeholder:"Search code, name, description",className:"w-60 max-w-full rounded-xl border px-8 py-1.5 text-sm"}),a.jsx(ur,{className:"pointer-events-none absolute left-2 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"})]}),n&&a.jsxs("button",{onClick:S,className:"inline-flex items-center gap-2 rounded-xl bg-blue-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-blue-700 active:scale-95",children:[a.jsx(or,{className:"h-4 w-4"}),"New Patient Type"]})]})]}),l&&a.jsx("div",{className:"rounded-2xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:l}),a.jsxs("div",{className:"grid gap-3 sm:hidden",children:[i&&a.jsx("div",{className:"rounded-2xl border bg-white p-4 text-center text-sm text-gray-500",children:"Loading"}),!i&&j.map(T=>a.jsxs("div",{className:"rounded-2xl border bg-white p-4 shadow-sm transition hover:shadow-md",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"text-sm font-semibold",children:[T.name," ",T.code&&a.jsx("span",{className:"ml-1 rounded-full bg-gray-100 px-2 py-0.5 text-[11px] font-mono text-gray-600",children:T.code})]}),a.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2 text-xs text-gray-500",children:[a.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[11px] ${T.is_active?"bg-emerald-50 text-emerald-700 border border-emerald-100":"bg-gray-100 text-gray-500 border border-gray-200"}`,children:T.is_active?"Active":"Inactive"}),a.jsxs("span",{className:"text-[11px] text-gray-400",children:["Sort: ",T.sort_order??0]})]})]}),n&&a.jsxs("button",{onClick:()=>_(T),className:"inline-flex items-center gap-1 rounded-xl border px-2 py-1 text-xs hover:bg-gray-50",children:[a.jsx(Co,{className:"h-3.5 w-3.5"}),"Edit"]})]}),T.description&&a.jsx("div",{className:"mt-2 text-xs text-gray-600",children:T.description})]},T.id)),!i&&j.length===0&&a.jsx("div",{className:"rounded-2xl border bg-white p-4 text-center text-sm text-gray-500",children:"No patient types found."})]}),a.jsx("div",{className:"hidden overflow-x-auto rounded-2xl border bg-white sm:block",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{className:"text-left text-xs font-medium text-gray-600",children:[a.jsx("th",{className:"p-2",children:"#"}),a.jsx("th",{className:"p-2",children:"Code"}),a.jsx("th",{className:"p-2",children:"Name"}),a.jsx("th",{className:"p-2",children:"Description"}),a.jsx("th",{className:"p-2",children:"Sort"}),a.jsx("th",{className:"p-2",children:"Status"}),a.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[i&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"p-4 text-center text-sm text-gray-500",children:"Loading"})}),!i&&j.map((T,P)=>a.jsxs("tr",{className:`border-t text-xs ${T.is_active?"text-black":"text-gray-400 bg-gray-50"}`,children:[a.jsx("td",{className:"p-2",children:P+1}),a.jsx("td",{className:"p-2 font-mono text-[11px]",children:T.code}),a.jsx("td",{className:"p-2",children:T.name}),a.jsx("td",{className:"p-2 max-w-xs",children:a.jsx("div",{className:"line-clamp-2 text-[11px] text-gray-600",children:T.description||""})}),a.jsx("td",{className:"p-2",children:T.sort_order??0}),a.jsx("td",{className:"p-2",children:a.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[11px] ${T.is_active?"bg-emerald-50 text-emerald-700 border border-emerald-100":"bg-gray-100 text-gray-500 border border-gray-200"}`,children:T.is_active?"Active":"Inactive"})}),a.jsx("td",{className:"p-2 text-right",children:n&&a.jsxs("button",{onClick:()=>_(T),className:"inline-flex items-center gap-1 rounded border px-2 py-1 text-[11px] bg-green-300 hover:bg-gray-50",children:[a.jsx(Co,{className:"h-3.5 w-3.5"}),"Edit"]})})]},T.id)),!i&&j.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"p-6 text-center text-sm text-gray-500",children:"No patient types found."})})]})]})}),h&&a.jsx(qOe,{existing:g,onClose:()=>{m(!1),y(null)},onSaved:A,onDeleted:k})]})}function qOe({existing:t,onClose:n,onSaved:r,onDeleted:s}){const i=Ps("patients.update")||Ps("patients.masters.manage"),[o,l]=b.useState(()=>({code:(t==null?void 0:t.code)||"",name:(t==null?void 0:t.name)||"",description:(t==null?void 0:t.description)||"",is_active:(t==null?void 0:t.is_active)??!0,sort_order:(t==null?void 0:t.sort_order)??0})),[c,d]=b.useState(!1),[u,h]=b.useState(""),m=async y=>{var N,j;if(y.preventDefault(),!!i){d(!0),h("");try{const S={...o,sort_order:Number(o.sort_order)||0};t?await te.put(`/patient-types/${t.id}`,S):await te.post("/patient-types",S),r&&r()}catch(S){h(((j=(N=S==null?void 0:S.response)==null?void 0:N.data)==null?void 0:j.detail)||"Failed to save patient type")}finally{d(!1)}}},g=async()=>{var y,N;if(!(!t||!i)&&window.confirm("Deactivate this patient type?")){d(!0),h("");try{await te.delete(`/patient-types/${t.id}`),s&&s(),n&&n()}catch(j){h(((N=(y=j==null?void 0:j.response)==null?void 0:y.data)==null?void 0:N.detail)||"Failed to deactivate patient type")}finally{d(!1)}}};return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:a.jsxs("div",{className:"max-h-[90vh] w-full max-w-xl overflow-y-auto rounded-2xl bg-white p-5 shadow-xl",children:[a.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-black",children:t?"Edit Patient Type":"New Patient Type"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Define master types like Emergency, OPD, IPD, Health Checkup, etc."})]}),a.jsx("button",{onClick:n,className:"rounded-xl p-2 hover:bg-gray-100",children:a.jsx(La,{className:"h-5 w-5"})})]}),u&&a.jsx("div",{className:"mb-3 rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:u}),a.jsxs("form",{onSubmit:m,className:"space-y-3 text-sm",children:[a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium text-black",children:"Code"}),a.jsx("input",{className:"input text-gray-800",value:o.code,onChange:y=>l({...o,code:y.target.value.toUpperCase()}),required:!0}),a.jsx("p",{className:"mt-0.5 text-[10px] text-gray-400",children:"Example: EMERGENCY, OPD, IPD, HC"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium text-black",children:"Name"}),a.jsx("input",{className:"input text-gray-800",value:o.name,onChange:y=>l({...o,name:y.target.value}),required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium text-black",children:"Description (optional)"}),a.jsx("textarea",{className:"input min-h-[80px] text-gray-800",value:o.description,onChange:y=>l({...o,description:y.target.value})})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-2 items-center",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium text-black",children:"Sort Order"}),a.jsx("input",{className:"input text-gray-800",type:"number",value:o.sort_order,onChange:y=>l({...o,sort_order:y.target.value})}),a.jsx("p",{className:"mt-0.5 text-[10px] text-gray-400",children:"Lower number shows earlier in dropdowns."})]}),a.jsxs("div",{className:"flex items-center gap-2 mt-4 md:mt-7",children:[a.jsx("input",{id:"pt-active",type:"checkbox",className:"h-4 w-4",checked:o.is_active,onChange:y=>l({...o,is_active:y.target.checked})}),a.jsx("label",{htmlFor:"pt-active",className:"text-xs font-medium text-black",children:"Active"})]})]}),a.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3",children:[t&&a.jsxs("button",{type:"button",onClick:g,className:"inline-flex items-center gap-2 rounded-xl border border-rose-200 px-3 py-1.5 text-xs font-medium text-rose-700 hover:bg-rose-50",children:[a.jsx(_l,{className:"h-3.5 w-3.5"}),"Deactivate"]}),a.jsxs("div",{className:"ml-auto flex gap-2",children:[a.jsx("button",{type:"button",onClick:n,className:"rounded-xl border px-4 py-1.5 text-xs hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{className:"btn",disabled:c||!i,children:c?"Saving":"Save"})]})]})]})]})})}function GOe(){const t=Ps("patients.masters.view"),n=Ps("patients.masters.manage"),[r,s]=b.useState([]),[i,o]=b.useState(!1),[l,c]=b.useState(""),[d,u]=b.useState(""),[h,m]=b.useState(!1),[g,y]=b.useState(null),N=b.useCallback(async()=>{var T,P;if(t){o(!0),c("");try{const{data:M}=await te.get("/patient-masters/payers");s(M||[])}catch(M){c(((P=(T=M==null?void 0:M.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to load payers")}finally{o(!1)}}},[t]);b.useEffect(()=>{N()},[N]);const j=b.useMemo(()=>{if(!d)return r;const T=d.toLowerCase();return r.filter(P=>{var M,O,D;return((M=P.name)==null?void 0:M.toLowerCase().includes(T))||((O=P.code)==null?void 0:O.toLowerCase().includes(T))||((D=P.payer_type)==null?void 0:D.toLowerCase().includes(T))})},[r,d]),S=()=>{y(null),m(!0)},_=T=>{n&&(y(T),m(!0))},A=()=>{m(!1),y(null),N()},k=()=>{N()};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[a.jsx(_o,{className:"h-4 w-4"}),a.jsx("span",{children:"Payers (Insurance / Corporate / Govt schemes)"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{value:d,onChange:T=>u(T.target.value),placeholder:"Search code, name, type",className:"w-52 max-w-full rounded-xl border px-8 py-1.5 text-sm"}),a.jsx(ur,{className:"pointer-events-none absolute left-2 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"})]}),n&&a.jsxs("button",{onClick:S,className:"inline-flex items-center gap-2 rounded-xl bg-blue-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-blue-700 active:scale-95",children:[a.jsx(or,{className:"h-4 w-4"}),"New Payer"]})]})]}),l&&a.jsx("div",{className:"rounded-2xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:l}),a.jsxs("div",{className:"grid gap-3 sm:hidden",children:[i&&a.jsx("div",{className:"rounded-2xl border bg-white p-4 text-center text-sm text-gray-500",children:"Loading"}),!i&&j.map(T=>a.jsxs("div",{className:"rounded-2xl border bg-white p-4 shadow-sm transition hover:shadow-md",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"text-sm font-semibold ",children:[T.name," ",T.code&&a.jsx("span",{className:"ml-1 rounded-full bg-gray-100 px-2 py-0.5 text-[11px] font-mono text-gray-600",children:T.code})]}),a.jsx("div",{className:"mt-1 text-xs text-gray-500 capitalize",children:T.payer_type||""})]}),n&&a.jsxs("button",{onClick:()=>_(T),className:"inline-flex items-center gap-1 rounded-xl border px-2 py-1 text-xs hover:bg-gray-50",children:[a.jsx(Co,{className:"h-3.5 w-3.5"}),"Edit"]})]}),a.jsxs("div",{className:"mt-2 space-y-1 text-xs text-gray-600",children:[T.contact_person&&a.jsxs("div",{children:["Contact: ",T.contact_person]}),T.phone&&a.jsxs("div",{children:["Phone: ",T.phone]}),T.email&&a.jsxs("div",{children:["Email: ",T.email]}),T.address&&a.jsxs("div",{className:"line-clamp-2",children:["Address: ",T.address]})]})]},T.id)),!i&&j.length===0&&a.jsx("div",{className:"rounded-2xl border bg-white p-4 text-center text-sm text-gray-500",children:"No payers found."})]}),a.jsx("div",{className:"hidden overflow-x-auto rounded-2xl border bg-white sm:block",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{className:"text-left text-xs font-medium text-gray-600",children:[a.jsx("th",{className:"p-2",children:"#"}),a.jsx("th",{className:"p-2",children:"Code"}),a.jsx("th",{className:"p-2",children:"Name"}),a.jsx("th",{className:"p-2",children:"Type"}),a.jsx("th",{className:"p-2",children:"Contact"}),a.jsx("th",{className:"p-2",children:"Phone / Email"}),a.jsx("th",{className:"p-2",children:"Address"}),a.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[i&&a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"p-4 text-center text-sm text-gray-500",children:"Loading"})}),!i&&j.map((T,P)=>a.jsxs("tr",{className:"border-t text-xs text-black",children:[a.jsx("td",{className:"p-2",children:P+1}),a.jsx("td",{className:"p-2 font-mono text-[11px]",children:T.code}),a.jsx("td",{className:"p-2",children:T.name}),a.jsx("td",{className:"p-2 capitalize",children:T.payer_type||""}),a.jsx("td",{className:"p-2",children:T.contact_person||""}),a.jsxs("td",{className:"p-2",children:[a.jsx("div",{children:T.phone||""}),a.jsx("div",{className:"text-[11px] text-gray-500",children:T.email||""})]}),a.jsx("td",{className:"p-2 max-w-xs",children:a.jsx("div",{className:"line-clamp-2 text-[11px] text-gray-600",children:T.address||""})}),a.jsx("td",{className:"p-2 text-right",children:n&&a.jsxs("button",{onClick:()=>_(T),className:"inline-flex items-center gap-1 rounded border px-2 py-1 text-[11px] bg-green-300 hover:bg-gray-50",children:[a.jsx(Co,{className:"h-3.5 w-3.5"}),"Edit"]})})]},T.id)),!i&&j.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"p-6 text-center text-sm text-gray-500",children:"No payers found."})})]})]})}),h&&a.jsx(KOe,{onClose:()=>{m(!1),y(null)},existing:g,onSaved:A,onDeleted:k})]})}function KOe({existing:t,onClose:n,onSaved:r,onDeleted:s}){const i=Ps("patients.masters.manage"),[o,l]=b.useState(()=>({code:(t==null?void 0:t.code)||"",name:(t==null?void 0:t.name)||"",payer_type:(t==null?void 0:t.payer_type)||"insurance",contact_person:(t==null?void 0:t.contact_person)||"",phone:(t==null?void 0:t.phone)||"",email:(t==null?void 0:t.email)||"",address:(t==null?void 0:t.address)||""})),[c,d]=b.useState(!1),[u,h]=b.useState(""),m=async y=>{var N,j;if(y.preventDefault(),!!i){d(!0),h("");try{t?await te.put(`/patient-masters/payers/${t.id}`,o):await te.post("/patient-masters/payers",o),r&&r()}catch(S){h(((j=(N=S==null?void 0:S.response)==null?void 0:N.data)==null?void 0:j.detail)||"Failed to save payer")}finally{d(!1)}}},g=async()=>{var y,N;if(!(!t||!i)&&window.confirm("Deactivate this payer?")){d(!0),h("");try{await te.delete(`/patient-masters/payers/${t.id}`),s&&s(),n&&n()}catch(j){h(((N=(y=j==null?void 0:j.response)==null?void 0:y.data)==null?void 0:N.detail)||"Failed to deactivate payer")}finally{d(!1)}}};return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:a.jsxs("div",{className:"max-h-[90vh] w-full max-w-xl overflow-y-auto rounded-2xl bg-white p-5 shadow-xl",children:[a.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-black",children:t?"Edit Payer":"New Payer"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Master record used for credit / insurance patients."})]}),a.jsx("button",{onClick:n,className:"rounded-xl p-2 bg-yellow-300 hover:bg-gray-100 text-black",children:a.jsx(La,{className:"h-5 w-5"})})]}),u&&a.jsx("div",{className:"mb-3 rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:u}),a.jsxs("form",{onSubmit:m,className:"space-y-3 text-sm",children:[a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium text-black",children:"Code"}),a.jsx("input",{className:"input text-gray-800",value:o.code,onChange:y=>l({...o,code:y.target.value.toUpperCase()}),required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium text-black",children:"Name"}),a.jsx("input",{className:"input text-gray-800",value:o.name,onChange:y=>l({...o,name:y.target.value}),required:!0})]})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium text-black",children:"Type"}),a.jsx("select",{className:"input text-gray-800",value:o.payer_type,onChange:y=>l({...o,payer_type:y.target.value}),children:VOe.map(y=>a.jsx("option",{value:y.value,children:y.label},y.value))})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"mb-1 block text-xs font-medium text-black",children:"Contact Person"}),a.jsx("input",{className:"input text-gray-800",value:o.contact_person,onChange:y=>l({...o,contact_person:y.target.value})})]})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium text-black",children:"Phone"}),a.jsx("input",{className:"input text-gray-800",value:o.phone,onChange:y=>l({...o,phone:y.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium text-black",children:"Email"}),a.jsx("input",{className:"input text-gray-800",type:"email",value:o.email,onChange:y=>l({...o,email:y.target.value})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium text-black",children:"Address"}),a.jsx("textarea",{className:"input min-h-[80px] text-gray-800",value:o.address,onChange:y=>l({...o,address:y.target.value})})]}),a.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3",children:[t&&a.jsxs("button",{type:"button",onClick:g,className:"inline-flex items-center gap-2 rounded-xl border border-rose-200 px-3 py-1.5 text-xs font-medium text-rose-700 hover:bg-rose-50",children:[a.jsx(_l,{className:"h-3.5 w-3.5"}),"Deactivate"]}),a.jsxs("div",{className:"ml-auto flex gap-2",children:[a.jsx("button",{type:"button",onClick:n,className:"rounded-xl border px-4 py-1.5 text-xs bg-red-700 hover:bg-red-500",children:"Cancel"}),a.jsx("button",{className:"btn",disabled:c||!i,children:c?"Saving":"Save"})]})]})]})]})})}function YOe(){const t=Ps("patients.masters.view"),n=Ps("patients.masters.manage"),[r,s]=b.useState([]),[i,o]=b.useState([]),[l,c]=b.useState(!1),[d,u]=b.useState(""),[h,m]=b.useState(""),[g,y]=b.useState(!1),[N,j]=b.useState(null),S=b.useCallback(async()=>{var O,D;if(t){c(!0),u("");try{const[L,$]=await Promise.all([te.get("/patient-masters/tpas"),te.get("/patient-masters/payers")]);s(L.data||[]),o($.data||[])}catch(L){u(((D=(O=L==null?void 0:L.response)==null?void 0:O.data)==null?void 0:D.detail)||"Failed to load TPAs")}finally{c(!1)}}},[t]);b.useEffect(()=>{S()},[S]);const _=b.useMemo(()=>{const O={};for(const D of i)O[D.id]=D;return O},[i]),A=b.useMemo(()=>{if(!h)return r;const O=h.toLowerCase();return r.filter(D=>{var L,$,V,F;return((L=D.name)==null?void 0:L.toLowerCase().includes(O))||(($=D.code)==null?void 0:$.toLowerCase().includes(O))||((F=(V=_[D.payer_id])==null?void 0:V.name)==null?void 0:F.toLowerCase().includes(O))})},[r,h,_]),k=()=>{j(null),y(!0)},T=O=>{n&&(j(O),y(!0))},P=()=>{y(!1),j(null),S()},M=()=>{S()};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[a.jsx(_o,{className:"h-4 w-4"}),a.jsx("span",{children:"Third-party administrators (TPAs) linked to payers."})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{value:h,onChange:O=>m(O.target.value),placeholder:"Search code, name, payer",className:"w-52 max-w-full rounded-xl border px-8 py-1.5 text-sm"}),a.jsx(ur,{className:"pointer-events-none absolute left-2 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"})]}),n&&a.jsxs("button",{onClick:k,className:"inline-flex items-center gap-2 rounded-xl bg-blue-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-blue-700 active:scale-95",children:[a.jsx(or,{className:"h-4 w-4"}),"New TPA"]})]})]}),d&&a.jsx("div",{className:"rounded-2xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:d}),a.jsxs("div",{className:"grid gap-3 sm:hidden",children:[l&&a.jsx("div",{className:"rounded-2xl border bg-white p-4 text-center text-sm text-gray-500",children:"Loading"}),!l&&A.map(O=>{var D;return a.jsxs("div",{className:"rounded-2xl border bg-white p-4 shadow-sm transition hover:shadow-md",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"text-sm font-semibold",children:[O.name," ",O.code&&a.jsx("span",{className:"ml-1 rounded-full bg-gray-100 px-2 py-0.5 text-[11px] font-mono text-gray-600",children:O.code})]}),a.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:["Payer: ",((D=_[O.payer_id])==null?void 0:D.name)||""]})]}),n&&a.jsxs("button",{onClick:()=>T(O),className:"inline-flex items-center gap-1 rounded-xl border px-2 py-1 text-xs hover:bg-gray-50",children:[a.jsx(Co,{className:"h-3.5 w-3.5"}),"Edit"]})]}),a.jsxs("div",{className:"mt-2 space-y-1 text-xs text-gray-600",children:[O.contact_person&&a.jsxs("div",{children:["Contact: ",O.contact_person]}),O.phone&&a.jsxs("div",{children:["Phone: ",O.phone]}),O.email&&a.jsxs("div",{children:["Email: ",O.email]})]})]},O.id)}),!l&&A.length===0&&a.jsx("div",{className:"rounded-2xl border bg-white p-4 text-center text-sm text-gray-500",children:"No TPAs found."})]}),a.jsx("div",{className:"hidden overflow-x-auto rounded-2xl border bg-white sm:block",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{className:"text-left text-xs font-medium text-gray-600",children:[a.jsx("th",{className:"p-2",children:"#"}),a.jsx("th",{className:"p-2",children:"Code"}),a.jsx("th",{className:"p-2",children:"Name"}),a.jsx("th",{className:"p-2",children:"Payer"}),a.jsx("th",{className:"p-2",children:"Contact"}),a.jsx("th",{className:"p-2",children:"Phone / Email"}),a.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[l&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"p-4 text-center text-sm text-gray-500",children:"Loading"})}),!l&&A.map((O,D)=>{var L;return a.jsxs("tr",{className:"border-t text-xs",children:[a.jsx("td",{className:"p-2 text-gray-800",children:D+1}),a.jsx("td",{className:"p-2 font-mono text-[11px] text-gray-800",children:O.code}),a.jsx("td",{className:"p-2 text-gray-800",children:O.name}),a.jsx("td",{className:"p-2 text-gray-800",children:((L=_[O.payer_id])==null?void 0:L.name)||""}),a.jsx("td",{className:"p-2 text-gray-800",children:O.contact_person||""}),a.jsxs("td",{className:"p-2 text-gray-800",children:[a.jsx("div",{children:O.phone||""}),a.jsx("div",{className:"text-[11px] text-gray-500",children:O.email||""})]}),a.jsx("td",{className:"p-2 text-right",children:n&&a.jsxs("button",{onClick:()=>T(O),className:"inline-flex items-center gap-1 rounded-xl border px-2 py-1 text-[11px] hover:bg-gray-500 bg-green-300",children:[a.jsx(Co,{className:"h-3.5 w-3.5"}),"Edit"]})})]},O.id)}),!l&&A.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"p-6 text-center text-sm text-gray-500",children:"No TPAs found."})})]})]})}),g&&a.jsx(XOe,{existing:N,onClose:()=>{y(!1),j(null)},payers:i,onSaved:P,onDeleted:M})]})}function XOe({existing:t,payers:n,onClose:r,onSaved:s,onDeleted:i}){const o=Ps("patients.masters.manage"),[l,c]=b.useState(()=>({code:(t==null?void 0:t.code)||"",name:(t==null?void 0:t.name)||"",payer_id:(t==null?void 0:t.payer_id)||"",contact_person:(t==null?void 0:t.contact_person)||"",phone:(t==null?void 0:t.phone)||"",email:(t==null?void 0:t.email)||""})),[d,u]=b.useState(!1),[h,m]=b.useState(""),g=async N=>{var j,S;if(N.preventDefault(),!!o){u(!0),m("");try{const _={...l,payer_id:l.payer_id?Number(l.payer_id):null};t?await te.put(`/patient-masters/tpas/${t.id}`,_):await te.post("/patient-masters/tpas",_),s&&s()}catch(_){m(((S=(j=_==null?void 0:_.response)==null?void 0:j.data)==null?void 0:S.detail)||"Failed to save TPA")}finally{u(!1)}}},y=async()=>{var N,j;if(!(!t||!o)&&window.confirm("Deactivate this TPA?")){u(!0),m("");try{await te.delete(`/patient-masters/tpas/${t.id}`),i&&i(),r&&r()}catch(S){m(((j=(N=S==null?void 0:S.response)==null?void 0:N.data)==null?void 0:j.detail)||"Failed to deactivate TPA")}finally{u(!1)}}};return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:a.jsxs("div",{className:"max-h-[90vh] w-full max-w-xl overflow-y-auto rounded-2xl bg-white p-5 shadow-xl",children:[a.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:t?"Edit TPA":"New TPA"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Third-party administrator master, mapped to payer."})]}),a.jsx("button",{onClick:r,className:"rounded-xl p-2 hover:bg-gray-100",children:a.jsx(La,{className:"h-5 w-5"})})]}),h&&a.jsx("div",{className:"mb-3 rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:h}),a.jsxs("form",{onSubmit:g,className:"space-y-3 text-sm",children:[a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium",children:"Code"}),a.jsx("input",{className:"input",value:l.code,onChange:N=>c({...l,code:N.target.value.toUpperCase()}),required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium",children:"Name"}),a.jsx("input",{className:"input",value:l.name,onChange:N=>c({...l,name:N.target.value}),required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium",children:"Payer"}),a.jsxs("select",{className:"input",value:l.payer_id||"",onChange:N=>c({...l,payer_id:N.target.value||""}),required:!0,children:[a.jsx("option",{value:"",children:"Select payer"}),n.map(N=>a.jsx("option",{value:N.id,children:N.name},N.id))]})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium",children:"Contact Person"}),a.jsx("input",{className:"input",value:l.contact_person,onChange:N=>c({...l,contact_person:N.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium",children:"Phone"}),a.jsx("input",{className:"input",value:l.phone,onChange:N=>c({...l,phone:N.target.value})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium",children:"Email"}),a.jsx("input",{className:"input",type:"email",value:l.email,onChange:N=>c({...l,email:N.target.value})})]}),a.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3",children:[t&&a.jsxs("button",{type:"button",onClick:y,className:"inline-flex items-center gap-2 rounded-xl border border-rose-200 px-3 py-1.5 text-xs font-medium text-rose-700 hover:bg-rose-50",children:[a.jsx(_l,{className:"h-3.5 w-3.5"}),"Deactivate"]}),a.jsxs("div",{className:"ml-auto flex gap-2",children:[a.jsx("button",{type:"button",onClick:r,className:"rounded-xl border px-4 py-1.5 text-xs hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{className:"btn",disabled:d||!o,children:d?"Saving":"Save"})]})]})]})]})})}function QOe(){const t=Ps("patients.masters.view"),n=Ps("patients.masters.manage"),[r,s]=b.useState([]),[i,o]=b.useState([]),[l,c]=b.useState([]),[d,u]=b.useState(!1),[h,m]=b.useState(""),[g,y]=b.useState(""),[N,j]=b.useState(!1),[S,_]=b.useState(null),A=b.useCallback(async()=>{var $,V;if(t){u(!0),m("");try{const[F,Q,U]=await Promise.all([te.get("/patient-masters/credit-plans"),te.get("/patient-masters/payers"),te.get("/patient-masters/tpas")]);s(F.data||[]),o(Q.data||[]),c(U.data||[])}catch(F){m(((V=($=F==null?void 0:F.response)==null?void 0:$.data)==null?void 0:V.detail)||"Failed to load credit plans")}finally{u(!1)}}},[t]);b.useEffect(()=>{A()},[A]);const k=b.useMemo(()=>{const $={};for(const V of i)$[V.id]=V;return $},[i]),T=b.useMemo(()=>{const $={};for(const V of l)$[V.id]=V;return $},[l]),P=b.useMemo(()=>{if(!g)return r;const $=g.toLowerCase();return r.filter(V=>{var F,Q,U,z,q,K;return((F=V.name)==null?void 0:F.toLowerCase().includes($))||((Q=V.code)==null?void 0:Q.toLowerCase().includes($))||((z=(U=k[V.payer_id])==null?void 0:U.name)==null?void 0:z.toLowerCase().includes($))||((K=(q=T[V.tpa_id])==null?void 0:q.name)==null?void 0:K.toLowerCase().includes($))})},[r,g,k,T]),M=()=>{_(null),j(!0)},O=$=>{n&&(_($),j(!0))},D=()=>{j(!1),_(null),A()},L=()=>{A()};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[a.jsx(rte,{className:"h-4 w-4"}),a.jsx("span",{children:"Credit / insurance plans used for IPD/OPD billing & authorization."})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{value:g,onChange:$=>y($.target.value),placeholder:"Search code, name, payer, TPA",className:"w-60 max-w-full rounded-xl border px-8 py-1.5 text-sm"}),a.jsx(ur,{className:"pointer-events-none absolute left-2 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"})]}),n&&a.jsxs("button",{onClick:M,className:"inline-flex items-center gap-2 rounded-xl bg-blue-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-blue-700 active:scale-95",children:[a.jsx(or,{className:"h-4 w-4"}),"New Plan"]})]})]}),h&&a.jsx("div",{className:"rounded-2xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:h}),a.jsxs("div",{className:"grid gap-3 sm:hidden",children:[d&&a.jsx("div",{className:"rounded-2xl border bg-white p-4 text-center text-sm text-gray-500",children:"Loading"}),!d&&P.map($=>{var V,F;return a.jsxs("div",{className:"rounded-2xl border bg-white p-4 shadow-sm transition hover:shadow-md",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"text-sm font-semibold",children:[$.name," ",$.code&&a.jsx("span",{className:"ml-1 rounded-full bg-gray-100 px-2 py-0.5 text-[11px] font-mono text-gray-600",children:$.code})]}),a.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:["Payer: ",((V=k[$.payer_id])==null?void 0:V.name)||""]}),a.jsxs("div",{className:"mt-0.5 text-xs text-gray-500",children:["TPA: ",((F=T[$.tpa_id])==null?void 0:F.name)||""]})]}),n&&a.jsxs("button",{onClick:()=>O($),className:"inline-flex items-center gap-1 rounded-xl border px-2 py-1 text-xs hover:bg-gray-50",children:[a.jsx(Co,{className:"h-3.5 w-3.5"}),"Edit"]})]}),$.description&&a.jsx("div",{className:"mt-2 text-xs text-gray-600",children:$.description})]},$.id)}),!d&&P.length===0&&a.jsx("div",{className:"rounded-2xl border bg-white p-4 text-center text-sm text-gray-500",children:"No credit plans found."})]}),a.jsx("div",{className:"hidden overflow-x-auto rounded-2xl border bg-white sm:block",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{className:"text-left text-xs font-medium text-gray-600",children:[a.jsx("th",{className:"p-2",children:"#"}),a.jsx("th",{className:"p-2",children:"Code"}),a.jsx("th",{className:"p-2",children:"Name"}),a.jsx("th",{className:"p-2",children:"Payer"}),a.jsx("th",{className:"p-2",children:"TPA"}),a.jsx("th",{className:"p-2",children:"Description"}),a.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[d&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"p-4 text-center text-sm text-gray-500",children:"Loading"})}),!d&&P.map(($,V)=>{var F,Q;return a.jsxs("tr",{className:"border-t text-xs text-black",children:[a.jsx("td",{className:"p-2",children:V+1}),a.jsx("td",{className:"p-2 font-mono text-[11px]",children:$.code}),a.jsx("td",{className:"p-2",children:$.name}),a.jsx("td",{className:"p-2",children:((F=k[$.payer_id])==null?void 0:F.name)||""}),a.jsx("td",{className:"p-2",children:((Q=T[$.tpa_id])==null?void 0:Q.name)||""}),a.jsx("td",{className:"p-2 max-w-xs",children:a.jsx("div",{className:"line-clamp-2 text-[11px] text-gray-600",children:$.description||""})}),a.jsx("td",{className:"p-2 text-right",children:n&&a.jsxs("button",{onClick:()=>O($),className:"inline-flex items-center gap-1 rounded border px-2 py-1 text-[11px] bg-green-300 hover:bg-gray-50",children:[a.jsx(Co,{className:"h-3.5 w-3.5"}),"Edit"]})})]},$.id)}),!d&&P.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"p-6 text-center text-sm text-gray-500",children:"No credit plans found."})})]})]})}),N&&a.jsx(ZOe,{existing:S,payers:i,tpas:l,onClose:()=>{j(!1),_(null)},onSaved:D,onDeleted:L})]})}function ZOe({existing:t,payers:n,tpas:r,onClose:s,onSaved:i,onDeleted:o}){const l=Ps("patients.masters.manage"),[c,d]=b.useState(()=>({code:(t==null?void 0:t.code)||"",name:(t==null?void 0:t.name)||"",payer_id:(t==null?void 0:t.payer_id)||"",tpa_id:(t==null?void 0:t.tpa_id)||"",description:(t==null?void 0:t.description)||""})),[u,h]=b.useState(!1),[m,g]=b.useState(""),y=async j=>{var S,_;if(j.preventDefault(),!!l){h(!0),g("");try{const A={...c,payer_id:c.payer_id?Number(c.payer_id):null,tpa_id:c.tpa_id?Number(c.tpa_id):null};t?await te.put(`/patient-masters/credit-plans/${t.id}`,A):await te.post("/patient-masters/credit-plans",A),i&&i()}catch(A){g(((_=(S=A==null?void 0:A.response)==null?void 0:S.data)==null?void 0:_.detail)||"Failed to save credit plan")}finally{h(!1)}}},N=async()=>{var j,S;if(!(!t||!l)&&window.confirm("Deactivate this credit plan?")){h(!0),g("");try{await te.delete(`/patient-masters/credit-plans/${t.id}`),o&&o(),s&&s()}catch(_){g(((S=(j=_==null?void 0:_.response)==null?void 0:j.data)==null?void 0:S.detail)||"Failed to deactivate credit plan")}finally{h(!1)}}};return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:a.jsxs("div",{className:"max-h-[90vh] w-full max-w-xl overflow-y-auto rounded-2xl bg-white p-5 shadow-xl",children:[a.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:t?"Edit Credit Plan":"New Credit Plan"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Map plan to payer & optional TPA for billing workflows."})]}),a.jsx("button",{onClick:s,className:"rounded-xl p-2 hover:bg-gray-100",children:a.jsx(La,{className:"h-5 w-5"})})]}),m&&a.jsx("div",{className:"mb-3 rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:m}),a.jsxs("form",{onSubmit:y,className:"space-y-3 text-sm",children:[a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium",children:"Code"}),a.jsx("input",{className:"input",value:c.code,onChange:j=>d({...c,code:j.target.value.toUpperCase()}),required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium",children:"Name"}),a.jsx("input",{className:"input",value:c.name,onChange:j=>d({...c,name:j.target.value}),required:!0})]})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium",children:"Payer"}),a.jsxs("select",{className:"input",value:c.payer_id||"",onChange:j=>d({...c,payer_id:j.target.value||""}),required:!0,children:[a.jsx("option",{value:"",children:"Select payer"}),n.map(j=>a.jsx("option",{value:j.id,children:j.name},j.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium",children:"TPA (optional)"}),a.jsxs("select",{className:"input",value:c.tpa_id||"",onChange:j=>d({...c,tpa_id:j.target.value||""}),children:[a.jsx("option",{value:"",children:"No TPA"}),r.map(j=>a.jsx("option",{value:j.id,children:j.name},j.id))]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium",children:"Description / Notes"}),a.jsx("textarea",{className:"input min-h-[80px]",value:c.description,onChange:j=>d({...c,description:j.target.value})})]}),a.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3",children:[t&&a.jsxs("button",{type:"button",onClick:N,className:"inline-flex items-center gap-2 rounded-xl border border-rose-200 px-3 py-1.5 text-xs font-medium text-rose-700 hover:bg-rose-50",children:[a.jsx(_l,{className:"h-3.5 w-3.5"}),"Deactivate"]}),a.jsxs("div",{className:"ml-auto flex gap-2",children:[a.jsx("button",{type:"button",onClick:s,className:"rounded-xl border px-4 py-1.5 text-xs hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{className:"btn",disabled:u||!l,children:u?"Saving":"Save"})]})]})]})]})})}const BD=[{key:"all",label:"All"},{key:"op_billing",label:"OP Billing"},{key:"ip_billing",label:"IP Billing"},{key:"lab",label:"Lab"},{key:"pharmacy",label:"Pharmacy"},{key:"radiology",label:"Radiology"},{key:"general",label:"General"}],JOe={draft:"bg-yellow-100 text-yellow-800",finalized:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"},bm=10;function v2(t){return Number(t||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}function eDe(){var U;const[t,n]=b.useState("all"),[r,s]=b.useState([]),[i,o]=b.useState(!1),[l,c]=b.useState({doctors:[],credit_providers:[],packages:[],payers:[],tpas:[],credit_plans:[]}),[d,u]=b.useState(!1),[h,m]=b.useState(""),[g,y]=b.useState(1),[N,j]=b.useState({patient_id:null,billing_type:"op_billing",context_type:"opd",context_id:"",remarks:""}),S=Hi();b.useEffect(()=>{_()},[]),b.useEffect(()=>{A()},[t]);async function _(){try{const{data:z}=await UA();c({doctors:(z==null?void 0:z.doctors)||[],credit_providers:(z==null?void 0:z.credit_providers)||[],packages:(z==null?void 0:z.packages)||[],payers:(z==null?void 0:z.payers)||[],tpas:(z==null?void 0:z.tpas)||[],credit_plans:(z==null?void 0:z.credit_plans)||[]})}catch(z){console.error("Failed to load billing masters",z)}}async function A(){o(!0),m("");try{const z={};t!=="all"&&(z.billing_type=t);const{data:q}=await spe(z);s(q||[]),y(1)}catch(z){console.error("Failed to load invoices",z),m("Unable to load invoices. Please try again.")}finally{o(!1)}}function k(z){S(`/billing/invoices/${z}`)}function T(z){n(z)}function P(z){const{name:q,value:K}=z.target;j(X=>({...X,[q]:K}))}function M(z){j(typeof z=="number"?q=>({...q,patient_id:z}):z&&typeof z=="object"?q=>({...q,patient_id:z.id}):q=>({...q,patient_id:null}))}async function O(z){if(z.preventDefault(),m(""),!N.patient_id){m("Please select a patient to create an invoice.");return}try{const q={patient_id:Number(N.patient_id),billing_type:N.billing_type||null,context_type:N.context_type||null,context_id:N.context_id?Number(N.context_id):null,remarks:N.remarks||null},{data:K}=await npe(q);u(!1),j({patient_id:null,billing_type:"op_billing",context_type:"opd",context_id:"",remarks:""}),S(`/billing/invoices/${K.id}`)}catch(q){console.error("Create invoice failed",q),m("Unable to create invoice. Please check details and try again.")}}const D=b.useMemo(()=>Math.max(1,Math.ceil(r.length/bm)),[r.length]),L=b.useMemo(()=>{const z=(g-1)*bm;return r.slice(z,z+bm)},[r,g]);function $(){y(z=>Math.max(1,z-1))}function V(){y(z=>Math.min(D,z+1))}const F=r.length===0?0:(g-1)*bm+1,Q=r.length===0?0:Math.min(g*bm,r.length);return a.jsxs("div",{className:"min-h-[calc(100vh-4rem)] bg-gradient-to-b from-slate-50 via-slate-100 to-slate-50 py-4 px-3 md:px-6",children:[a.jsxs("div",{className:"max-w-6xl mx-auto space-y-4",children:[a.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-slate-900",children:"Billing Console"}),a.jsx("p",{className:"text-xs md:text-sm text-slate-500",children:"One place to manage OP / IP / Lab / Pharmacy billing, refunds and credit tracking."})]}),a.jsx("button",{type:"button",onClick:()=>u(!0),className:"inline-flex items-center justify-center rounded-full bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-500 px-4 py-2 text-xs md:text-sm font-medium text-white shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:"+ New Invoice"})]}),a.jsx("div",{className:"rounded-2xl bg-gradient-to-r from-indigo-50 via-sky-50 to-purple-50 p-2 shadow-sm border border-slate-100",children:a.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1",children:BD.map(z=>{const q=t===z.key;return a.jsx("button",{type:"button",onClick:()=>T(z.key),className:`whitespace-nowrap rounded-full px-3.5 py-1.5 text-xs md:text-[13px] font-medium transition-all ${q?"bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-500 text-white shadow-md":"bg-white/70 text-slate-700 hover:bg-white hover:text-slate-900 border border-slate-200"}`,children:z.label},z.key)})})}),a.jsxs("div",{className:"rounded-2xl bg-white shadow-sm border border-slate-200 overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 md:px-4 py-2 border-b border-slate-100",children:[a.jsxs("div",{className:"flex flex-col gap-0.5",children:[a.jsx("span",{className:"text-xs font-semibold text-slate-800",children:"Invoices"}),a.jsx("span",{className:"text-[11px] text-slate-400",children:t==="all"?"All billing types":`Filtered by ${((U=BD.find(z=>z.key===t))==null?void 0:U.label)||""}`})]}),a.jsx("button",{type:"button",onClick:A,className:"text-[11px] text-indigo-600 hover:text-indigo-800",children:"Refresh"})]}),h&&a.jsx("div",{className:"px-3 md:px-4 py-2 bg-red-50 text-[11px] text-red-700",children:h}),i?a.jsx("div",{className:"px-3 md:px-4 py-8 text-center text-xs text-slate-500",children:"Loading invoices..."}):r.length===0?a.jsx("div",{className:"px-3 md:px-4 py-8 text-center text-xs text-slate-500",children:"No invoices found for this filter."}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto text-xs",children:a.jsxs("table",{className:"min-w-full divide-y divide-slate-100",children:[a.jsx("thead",{className:"bg-slate-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 md:px-4 py-2 text-left font-medium text-slate-500",children:"Inv #"}),a.jsx("th",{className:"px-3 md:px-4 py-2 text-left font-medium text-slate-500",children:"Billing Type"}),a.jsx("th",{className:"px-3 md:px-4 py-2 text-left font-medium text-slate-500",children:"Patient"}),a.jsx("th",{className:"px-3 md:px-4 py-2 text-right font-medium text-slate-500",children:"Net"}),a.jsx("th",{className:"px-3 md:px-4 py-2 text-right font-medium text-slate-500",children:"Paid"}),a.jsx("th",{className:"px-3 md:px-4 py-2 text-right font-medium text-slate-500",children:"Balance"}),a.jsx("th",{className:"px-3 md:px-4 py-2 text-left font-medium text-slate-500",children:"Status"}),a.jsx("th",{className:"px-3 md:px-4 py-2"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-100",children:L.map(z=>a.jsxs("tr",{className:"hover:bg-slate-50 cursor-pointer",onClick:()=>k(z.id),children:[a.jsx("td",{className:"px-3 md:px-4 py-2 text-slate-800 whitespace-nowrap",children:z.invoice_number||z.id}),a.jsx("td",{className:"px-3 md:px-4 py-2 text-slate-600 whitespace-nowrap",children:z.billing_type||"general"}),a.jsxs("td",{className:"px-3 md:px-4 py-2 text-slate-500 whitespace-nowrap",children:["#",z.patient_id]}),a.jsxs("td",{className:"px-3 md:px-4 py-2 text-right text-slate-800 whitespace-nowrap",children:[" ",v2(z.net_total)]}),a.jsxs("td",{className:"px-3 md:px-4 py-2 text-right text-slate-600 whitespace-nowrap",children:[" ",v2(z.amount_paid)]}),a.jsxs("td",{className:"px-3 md:px-4 py-2 text-right text-slate-800 whitespace-nowrap",children:[" ",v2(z.balance_due)]}),a.jsx("td",{className:"px-3 md:px-4 py-2 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex rounded-full px-2.5 py-0.5 text-[10px] font-medium ${JOe[z.status]||"bg-slate-100 text-slate-700"}`,children:z.status})}),a.jsx("td",{className:"px-3 md:px-4 py-2 text-right whitespace-nowrap",children:a.jsx("span",{className:"text-[11px] text-indigo-600 hover:text-indigo-800",children:"Open "})})]},z.id))})]})}),a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2 px-3 md:px-4 py-3 border-t border-slate-100 text-[11px]",children:[a.jsxs("div",{className:"text-slate-500",children:["Showing ",a.jsx("span",{className:"font-medium",children:F}),"",a.jsx("span",{className:"font-medium",children:Q})," of"," ",a.jsx("span",{className:"font-medium",children:r.length})," ","invoices"]}),a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsx("button",{type:"button",onClick:$,disabled:g===1,className:`px-2.5 py-1 rounded-md border text-[11px] ${g===1?"border-slate-200 text-slate-300 cursor-not-allowed":"border-slate-300 text-slate-700 hover:bg-slate-50"}`,children:"Prev"}),a.jsxs("span",{className:"text-slate-500",children:["Page"," ",a.jsx("span",{className:"font-semibold text-slate-800",children:g})," ","/ ",D]}),a.jsx("button",{type:"button",onClick:V,disabled:g===D,className:`px-2.5 py-1 rounded-md border text-[11px] ${g===D?"border-slate-200 text-slate-300 cursor-not-allowed":"border-slate-300 text-slate-700 hover:bg-slate-50"}`,children:"Next"})]})]})]})]})]}),d&&a.jsx("div",{className:"fixed inset-0 z-30 flex items-end sm:items-center justify-center bg-black/40",children:a.jsxs("div",{className:"w-full sm:max-w-md bg-white rounded-t-2xl sm:rounded-2xl shadow-lg p-4 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"New Invoice"}),a.jsx("button",{type:"button",onClick:()=>u(!1),className:"text-xs text-slate-400 hover:text-slate-600",children:""})]}),a.jsxs("form",{className:"space-y-3",onSubmit:O,children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Patient"}),a.jsx(_z,{value:N.patient_id,onChange:M}),a.jsx("p",{className:"text-[10px] text-slate-400",children:"Search by name / UHID / phone and pick the patient for billing."})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Billing Type"}),a.jsxs("select",{name:"billing_type",value:N.billing_type,onChange:P,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",children:[a.jsx("option",{value:"op_billing",children:"OP Billing"}),a.jsx("option",{value:"ip_billing",children:"IP Billing"}),a.jsx("option",{value:"lab",children:"Lab"}),a.jsx("option",{value:"pharmacy",children:"Pharmacy"}),a.jsx("option",{value:"radiology",children:"Radiology"}),a.jsx("option",{value:"general",children:"General"})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Context Type (optional)"}),a.jsxs("select",{name:"context_type",value:N.context_type,onChange:P,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",children:[a.jsx("option",{value:"",children:"None"}),a.jsx("option",{value:"opd",children:"OPD"}),a.jsx("option",{value:"ipd",children:"IPD"}),a.jsx("option",{value:"lab",children:"Lab"}),a.jsx("option",{value:"radiology",children:"Radiology"}),a.jsx("option",{value:"pharmacy",children:"Pharmacy"}),a.jsx("option",{value:"other",children:"Other"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Context ID (optional)"}),a.jsx("input",{type:"number",name:"context_id",value:N.context_id,onChange:P,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",placeholder:"Visit / admission / order id"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Remarks (optional)"}),a.jsx("input",{type:"text",name:"remarks",value:N.remarks,onChange:P,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",placeholder:"Any note for this invoice"})]})]}),h&&a.jsx("p",{className:"text-[11px] text-red-600",children:h}),a.jsxs("div",{className:"flex gap-2 justify-end pt-1",children:[a.jsx("button",{type:"button",onClick:()=>u(!1),className:"px-3 py-1.5 rounded-md border border-slate-300 text-xs text-slate-700",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-3 py-1.5 rounded-md bg-indigo-600 text-xs font-medium text-white hover:bg-indigo-700",children:"Create & Open"})]})]})]})})]})}var tDe="Label",Tq=b.forwardRef((t,n)=>a.jsx(Ht.label,{...t,ref:n,onMouseDown:r=>{var i;r.target.closest("button, input, select, textarea")||((i=t.onMouseDown)==null||i.call(t,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));Tq.displayName=tDe;var Iq=Tq;const nDe=wv("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ke=b.forwardRef(({className:t,...n},r)=>a.jsx(Iq,{ref:r,className:_t(nDe(),t),...n}));Ke.displayName=Iq.displayName;function io({label:t,name:n,value:r,onChange:s}){return a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{className:"text-xs font-medium text-slate-600",children:t}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ne,{type:"color",value:r||"#ffffff",onChange:i=>s(n,i.target.value),className:"w-12 h-9 p-1 cursor-pointer"}),a.jsx(Ne,{type:"text",value:r||"",onChange:i=>s(n,i.target.value),placeholder:"#0f172a",className:"flex-1"})]})]})}function rDe(){const{branding:t,setBranding:n,loading:r}=px()||{},[s,i]=b.useState({}),[o,l]=b.useState(!1),[c,d]=b.useState(!1),[u,h]=b.useState(null),[m,g]=b.useState(null),[y,N]=b.useState(null),[j,S]=b.useState(null),[_,A]=b.useState(null);b.useEffect(()=>{t&&i({org_name:t.org_name||"",org_tagline:t.org_tagline||"",org_address:t.org_address||"",org_phone:t.org_phone||"",org_email:t.org_email||"",org_website:t.org_website||"",org_gstin:t.org_gstin||"",primary_color:t.primary_color||"",primary_color_dark:t.primary_color_dark||"",sidebar_bg_color:t.sidebar_bg_color||"",content_bg_color:t.content_bg_color||"",card_bg_color:t.card_bg_color||"",border_color:t.border_color||"",text_color:t.text_color||"",text_muted_color:t.text_muted_color||"",icon_color:t.icon_color||"",icon_bg_color:t.icon_bg_color||"",pdf_header_height_mm:typeof t.pdf_header_height_mm=="number"?t.pdf_header_height_mm:"",pdf_footer_height_mm:typeof t.pdf_footer_height_mm=="number"?t.pdf_footer_height_mm:"",pdf_show_page_number:typeof t.pdf_show_page_number=="boolean"?t.pdf_show_page_number:!0})},[t]);const k=(F,Q)=>{i(U=>({...U,[F]:Q}))},T=F=>Q=>{k(F,Q.target.value)},P=F=>Q=>{const U=Q.target.value;k(F,U===""?"":Number(U))},M=F=>Q=>{k(F,!!Q.target.checked)},O=(F,Q)=>{k(F,Q)},D=async()=>{var F,Q,U,z;l(!0);try{const q={...s,pdf_header_height_mm:s.pdf_header_height_mm===""?null:Number(s.pdf_header_height_mm),pdf_footer_height_mm:s.pdf_footer_height_mm===""?null:Number(s.pdf_footer_height_mm)},{data:K}=await Voe(q);n==null||n(K),fe.success("Branding settings updated")}catch(q){console.error("Failed to update branding settings",q);const K=((Q=(F=q==null?void 0:q.response)==null?void 0:F.data)==null?void 0:Q.detail)||((z=(U=q==null?void 0:q.response)==null?void 0:U.data)==null?void 0:z.message)||(q==null?void 0:q.message)||"Could not save branding settings";fe.error(K)}finally{l(!1)}},L=async F=>{F.preventDefault(),await D()},$=async F=>{F.preventDefault(),await D()},V=async F=>{var U,z,q,K;if(F.preventDefault(),!u&&!m&&!y&&!j&&!_){fe.warning("Select at least one file to upload");return}const Q=new FormData;u&&Q.append("logo",u),m&&Q.append("login_logo",m),y&&Q.append("favicon",y),j&&Q.append("pdf_header",j),_&&Q.append("pdf_footer",_),d(!0);try{const{data:X}=await Hoe(Q);n==null||n(X),fe.success("Branding files uploaded"),h(null),g(null),N(null),S(null),A(null)}catch(X){console.error("Failed to upload branding files",X);const J=((z=(U=X==null?void 0:X.response)==null?void 0:U.data)==null?void 0:z.detail)||((K=(q=X==null?void 0:X.response)==null?void 0:q.data)==null?void 0:K.message)||(X==null?void 0:X.message)||"Could not upload branding files";fe.error(J)}finally{d(!1)}};return r||!t?a.jsxs("div",{className:"p-6",children:[a.jsx(Xe,{className:"h-7 w-64 mb-3"}),a.jsx(Xe,{className:"h-64 w-full"})]}):a.jsxs(ht.div,{className:"p-6 space-y-4",initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2},children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-semibold text-slate-900",children:"Customization & Templates"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Configure organisation identity, logo, UI colors, and global PDF header/footer for all NABH HIMS documents."})]})}),a.jsxs(Re,{className:"border border-slate-200 rounded-2xl shadow-sm bg-white",children:[a.jsx(Ye,{className:"pb-2",children:a.jsx(Ze,{className:"text-sm font-semibold text-slate-900",children:"Global Branding & PDF Settings"})}),a.jsx(Be,{children:a.jsxs(ko,{defaultValue:"branding",children:[a.jsxs(Vi,{className:"mb-4",children:[a.jsx(on,{value:"branding",children:"Branding & Organisation"}),a.jsx(on,{value:"pdf",children:"PDF Header / Footer & Behaviour"})]}),a.jsx(ln,{value:"branding",className:"space-y-6",children:a.jsxs("form",{onSubmit:L,className:"space-y-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:"Organisation details"}),a.jsx("p",{className:"text-xs text-slate-500",children:"These values appear on letterheads, EMR PDFs, discharge summaries and other NABH documents."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{className:"text-xs text-slate-600",children:"Organisation name"}),a.jsx(Ne,{value:s.org_name||"",onChange:T("org_name"),placeholder:"Hospital / Clinic name"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{className:"text-xs text-slate-600",children:"Tagline"}),a.jsx(Ne,{value:s.org_tagline||"",onChange:T("org_tagline"),placeholder:"Smart  Secure  NABH-Standard"})]}),a.jsxs("div",{className:"space-y-1.5 md:col-span-2",children:[a.jsx(Ke,{className:"text-xs text-slate-600",children:"Address"}),a.jsx(Ne,{value:s.org_address||"",onChange:T("org_address"),placeholder:"Address line for letterhead & PDFs"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{className:"text-xs text-slate-600",children:"Phone"}),a.jsx(Ne,{value:s.org_phone||"",onChange:T("org_phone"),placeholder:"+91-XXXXXXXXXX"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{className:"text-xs text-slate-600",children:"Email"}),a.jsx(Ne,{type:"email",value:s.org_email||"",onChange:T("org_email"),placeholder:"info@example.com"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{className:"text-xs text-slate-600",children:"Website"}),a.jsx(Ne,{value:s.org_website||"",onChange:T("org_website"),placeholder:"https://your-hospital.com"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{className:"text-xs text-slate-600",children:"GSTIN"}),a.jsx(Ne,{value:s.org_gstin||"",onChange:T("org_gstin"),placeholder:"GSTIN (optional, for bills)"})]})]})]}),a.jsx("div",{className:"border-t border-slate-100"}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:"Color palette"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Tune application colors. These drive sidebar, primary buttons and card backgrounds."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(io,{label:"Primary color (buttons, highlights)",name:"primary_color",value:s.primary_color,onChange:O}),a.jsx(io,{label:"Primary dark (topbar / hover)",name:"primary_color_dark",value:s.primary_color_dark,onChange:O}),a.jsx(io,{label:"Sidebar background color",name:"sidebar_bg_color",value:s.sidebar_bg_color,onChange:O}),a.jsx(io,{label:"Content background color",name:"content_bg_color",value:s.content_bg_color,onChange:O}),a.jsx(io,{label:"Card background color",name:"card_bg_color",value:s.card_bg_color,onChange:O}),a.jsx(io,{label:"Border color",name:"border_color",value:s.border_color,onChange:O}),a.jsx(io,{label:"Text color",name:"text_color",value:s.text_color,onChange:O}),a.jsx(io,{label:"Muted text color",name:"text_muted_color",value:s.text_muted_color,onChange:O}),a.jsx(io,{label:"Icon color",name:"icon_color",value:s.icon_color,onChange:O}),a.jsx(io,{label:"Icon background color",name:"icon_bg_color",value:s.icon_bg_color,onChange:O})]})]}),a.jsxs("div",{className:"flex items-center justify-between pt-2",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[(t==null?void 0:t.logo_url)&&a.jsx("img",{src:t.logo_url,alt:"Logo preview",className:"h-8 w-auto rounded-sm border border-slate-200 bg-white"}),a.jsxs("span",{className:"text-xs text-slate-500",children:["Logos & PDF artwork are managed in the"," ",a.jsx("span",{className:"font-medium",children:"PDF Header / Footer"})," tab."]})]}),a.jsx(Te,{type:"submit",disabled:o,className:"min-w-[140px]",children:o?"Saving":"Save branding"})]})]})}),a.jsxs(ln,{value:"pdf",className:"space-y-6",children:[a.jsxs("form",{onSubmit:V,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ke,{className:"text-xs font-medium text-slate-600",children:"Application logo (sidebar / topbar)"}),a.jsxs("div",{className:"border border-dashed border-slate-300 rounded-2xl p-3 flex flex-col items-center gap-2",children:[(t==null?void 0:t.logo_url)&&a.jsx("img",{src:t.logo_url,alt:"Logo",className:"h-8 w-auto rounded-sm border border-slate-200 bg-white mb-1"}),a.jsxs("label",{className:"w-full",children:[a.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs cursor-pointer",children:[a.jsx(am,{className:"h-4 w-4"}),a.jsx("span",{children:"Choose logo (PNG / JPG)"})]}),a.jsx(Ne,{type:"file",accept:"image/*",className:"hidden",onChange:F=>{var Q;return h(((Q=F.target.files)==null?void 0:Q[0])||null)}})]}),u&&a.jsx("p",{className:"text-[11px] text-slate-500 truncate w-full text-center",children:u.name})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ke,{className:"text-xs font-medium text-slate-600",children:"Login-page logo (optional)"}),a.jsxs("div",{className:"border border-dashed border-slate-300 rounded-2xl p-3 flex flex-col items-center gap-2",children:[(t==null?void 0:t.login_logo_url)&&a.jsx("img",{src:t.login_logo_url,alt:"Login logo",className:"h-8 w-auto rounded-sm border border-slate-200 bg-white mb-1"}),a.jsxs("label",{className:"w-full",children:[a.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs cursor-pointer",children:[a.jsx(am,{className:"h-4 w-4"}),a.jsx("span",{children:"Choose login logo"})]}),a.jsx(Ne,{type:"file",accept:"image/*",className:"hidden",onChange:F=>{var Q;return g(((Q=F.target.files)==null?void 0:Q[0])||null)}})]}),m&&a.jsx("p",{className:"text-[11px] text-slate-500 truncate w-full text-center",children:m.name})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ke,{className:"text-xs font-medium text-slate-600",children:"Favicon (browser tab icon)"}),a.jsxs("div",{className:"border border-dashed border-slate-300 rounded-2xl p-3 flex flex-col items-center gap-2",children:[(t==null?void 0:t.favicon_url)&&a.jsx("img",{src:t.favicon_url,alt:"Favicon",className:"h-6 w-6 rounded-sm border border-slate-200 bg-white mb-1"}),a.jsxs("label",{className:"w-full",children:[a.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs cursor-pointer",children:[a.jsx(am,{className:"h-4 w-4"}),a.jsx("span",{children:"Choose favicon (PNG / ICO)"})]}),a.jsx(Ne,{type:"file",accept:"image/*,.ico",className:"hidden",onChange:F=>{var Q;return N(((Q=F.target.files)==null?void 0:Q[0])||null)}})]}),y&&a.jsx("p",{className:"text-[11px] text-slate-500 truncate w-full text-center",children:y.name})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ke,{className:"text-xs font-medium text-slate-600",children:"PDF header template (all documents)"}),a.jsxs("div",{className:"border border-dashed border-slate-300 rounded-2xl p-3 flex flex-col items-center gap-2",children:[(t==null?void 0:t.pdf_header_url)&&a.jsx("img",{src:t.pdf_header_url,alt:"PDF header",className:"h-12 w-auto rounded-sm border border-slate-200 bg-white mb-1"}),a.jsxs("label",{className:"w-full",children:[a.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs cursor-pointer",children:[a.jsx(am,{className:"h-4 w-4"}),a.jsx("span",{children:"Choose header image"})]}),a.jsx(Ne,{type:"file",accept:"image/*",className:"hidden",onChange:F=>{var Q;return S(((Q=F.target.files)==null?void 0:Q[0])||null)}})]}),j&&a.jsx("p",{className:"text-[11px] text-slate-500 truncate w-full text-center",children:j.name})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ke,{className:"text-xs font-medium text-slate-600",children:"PDF footer template (all documents)"}),a.jsxs("div",{className:"border border-dashed border-slate-300 rounded-2xl p-3 flex flex-col items-center gap-2",children:[(t==null?void 0:t.pdf_footer_url)&&a.jsx("img",{src:t.pdf_footer_url,alt:"PDF footer",className:"h-12 w-auto rounded-sm border border-slate-200 bg-white mb-1"}),a.jsxs("label",{className:"w-full",children:[a.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs cursor-pointer",children:[a.jsx(am,{className:"h-4 w-4"}),a.jsx("span",{children:"Choose footer image"})]}),a.jsx(Ne,{type:"file",accept:"image/*",className:"hidden",onChange:F=>{var Q;return A(((Q=F.target.files)==null?void 0:Q[0])||null)}})]}),_&&a.jsx("p",{className:"text-[11px] text-slate-500 truncate w-full text-center",children:_.name})]})]})]}),a.jsxs("div",{className:"flex items-center justify-between pt-2",children:[a.jsx("p",{className:"text-[11px] text-slate-500 max-w-xl",children:"These logo/header/footer templates will be applied to all PDF downloads (EMR, discharge summary, lab reports, invoices, etc.) to keep NABH-compliant formatting."}),a.jsx(Te,{type:"submit",disabled:c,className:"min-w-[160px]",children:c?"Uploading":"Upload artwork"})]})]}),a.jsxs("form",{onSubmit:$,className:"space-y-4",children:[a.jsx("div",{className:"border-t border-slate-100 pt-4"}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:"PDF layout behaviour"}),a.jsx("p",{className:"text-xs text-slate-500",children:'Control reserved space for header/footer and whether to show "Page X of Y" in the footer.'}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{className:"text-xs text-slate-600",children:"Header height (mm)"}),a.jsx(Ne,{type:"number",min:0,value:s.pdf_header_height_mm===""?"":s.pdf_header_height_mm,onChange:P("pdf_header_height_mm"),placeholder:"Auto"}),a.jsx("p",{className:"text-[11px] text-slate-400",children:"Leave blank to auto-calc based on header image."})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{className:"text-xs text-slate-600",children:"Footer height (mm)"}),a.jsx(Ne,{type:"number",min:0,value:s.pdf_footer_height_mm===""?"":s.pdf_footer_height_mm,onChange:P("pdf_footer_height_mm"),placeholder:"Auto"}),a.jsx("p",{className:"text-[11px] text-slate-400",children:"Leave blank to auto-calc based on footer image."})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{className:"text-xs text-slate-600",children:"Page number in footer"}),a.jsxs("label",{className:"inline-flex items-center gap-2 text-xs text-slate-600",children:[a.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300",checked:!!s.pdf_show_page_number,onChange:M("pdf_show_page_number")}),a.jsx("span",{children:'Show "Page X of Y" on all PDFs'})]})]})]})]}),a.jsx("div",{className:"flex items-center justify-end pt-1",children:a.jsx(Te,{type:"submit",disabled:o,className:"min-w-[160px]",children:o?"Saving":"Save PDF settings"})})]})]})]})})]})]})}const FD=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];function sDe(){const[t,n]=b.useState(null),[r,s]=b.useState("0"),[i,o]=b.useState("09:00"),[l,c]=b.useState("13:00"),[d,u]=b.useState("15"),[h,m]=b.useState([]),[g,y]=b.useState(!1),[N,j]=b.useState(!1),[S,_]=b.useState(null),A=b.useCallback(D=>{n(D)},[]),k=b.useCallback(async()=>{if(!t){m([]);return}try{y(!0);const{data:D}=await Zle(t);m(D||[])}catch(D){console.error(D),fe.error("Failed to load schedules")}finally{y(!1)}},[t]);b.useEffect(()=>{k()},[k]);const T=async D=>{var $,V,F;if(($=D==null?void 0:D.preventDefault)==null||$.call(D),!t){fe.error("Select doctor first");return}const L=Number(r);if(h.some(Q=>Q.weekday===L)){fe.error("Schedule for this weekday already exists. Edit / delete existing slot instead.");return}try{j(!0),await Jle({doctor_user_id:t,weekday:L,start_time:i,end_time:l,slot_minutes:Number(d)||15}),fe.success("Schedule saved"),k()}catch(Q){console.error(Q),fe.error(((F=(V=Q==null?void 0:Q.response)==null?void 0:V.data)==null?void 0:F.detail)||"Failed to save schedule")}finally{j(!1)}},P=async D=>{var L,$;if(window.confirm("Delete this schedule slot?"))try{_(D),await ece(D),fe.success("Schedule deleted"),m(V=>V.filter(F=>F.id!==D))}catch(V){console.error(V),fe.error((($=(L=V==null?void 0:V.response)==null?void 0:L.data)==null?void 0:$.detail)||"Failed to delete schedule")}finally{_(null)}},M=!!t,O=b.useMemo(()=>`${h.length} weekday slot${h.length===1?"":"s"} configured`,[h.length]);return a.jsx("div",{className:"min-h-[calc(100vh-5rem)] bg-slate-50 px-4 py-6 md:px-6",children:a.jsxs("div",{className:"mx-auto max-w-5xl space-y-6",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.2em] text-sky-700",children:"OPD Scheduling"}),a.jsx("h1",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"Doctor OPD Schedules"}),a.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Configure weekday-wise OPD timings for each doctor. Duplicate weekday entries are blocked to keep the roster clean."})]}),a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsx(Ye,{className:"border-b border-slate-100 pb-4",children:a.jsxs(Ze,{className:"flex items-center justify-between text-base font-semibold text-slate-900",children:[a.jsx("span",{children:"Schedule Setup"}),a.jsx("span",{className:"text-xs font-normal text-slate-500",children:O})]})}),a.jsxs(Be,{className:"pt-4 space-y-4",children:[a.jsxs("div",{className:"grid gap-4 md:grid-cols-[2fr,1.5fr]",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:"Doctor"}),a.jsx(Al,{value:t,onChange:A}),!t&&a.jsx("p",{className:"mt-1 text-[11px] text-amber-600",children:"Select a doctor to view and update OPD schedules."})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(sa,{className:"h-3 w-3"}),"Weekday"]}),a.jsxs(Nn,{value:r,onValueChange:s,children:[a.jsx(gn,{className:"h-9 text-sm",children:a.jsx(jn,{placeholder:"Select weekday"})}),a.jsx(yn,{children:FD.map((D,L)=>a.jsx(gt,{value:String(L),children:D},L))})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(ci,{className:"h-3 w-3"}),"Start"]}),a.jsx(Ne,{type:"time",value:i,onChange:D=>o(D.target.value),className:"h-9 text-sm"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(ci,{className:"h-3 w-3"}),"End"]}),a.jsx(Ne,{type:"time",value:l,onChange:D=>c(D.target.value),className:"h-9 text-sm"})]})]})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-[1fr,auto] md:items-end",children:[a.jsxs("div",{className:"space-y-1.5 max-w-xs",children:[a.jsx("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:"Slot duration (minutes)"}),a.jsx(Ne,{type:"number",min:5,step:5,value:d,onChange:D=>u(D.target.value),className:"h-9 text-sm"}),a.jsx("p",{className:"mt-1 text-[11px] text-slate-400",children:"Used when generating appointment slots (e.g., 10 / 15 / 20)."})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(Te,{type:"button",className:"px-5",disabled:!M||N,onClick:T,children:N?"Saving":"Add Weekday Slot"})})]})]})]}),a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsx(Ye,{className:"border-b border-slate-100 pb-3",children:a.jsx(Ze,{className:"text-sm font-semibold text-slate-900",children:"Existing Schedules"})}),a.jsxs(Be,{className:"pt-4",children:[g&&a.jsx("div",{className:"space-y-2",children:[1,2,3].map(D=>a.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-100 bg-slate-50 px-3 py-3",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Xe,{className:"h-4 w-40"}),a.jsx(Xe,{className:"h-3 w-24"})]}),a.jsx(Xe,{className:"h-8 w-8 rounded-full"})]},D))}),!g&&(!h||h.length===0)&&a.jsx("p",{className:"py-6 text-sm text-slate-500",children:"No schedules configured yet for this doctor."}),!g&&h&&h.length>0&&a.jsx("div",{className:"grid gap-2 sm:grid-cols-2",children:h.map(D=>{var L,$;return a.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-3 text-sm shadow-sm",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsx("div",{className:"flex flex-wrap items-center gap-1.5",children:a.jsxs("span",{className:"font-semibold text-slate-900",children:[FD[D.weekday]," "," ",(L=D.start_time)==null?void 0:L.slice(0,5),"",($=D.end_time)==null?void 0:$.slice(0,5)]})}),a.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-slate-500",children:[a.jsxs(Ge,{variant:"outline",className:"border-slate-200 bg-slate-50 px-2 py-0.5 text-[11px]",children:["Slot: ",D.slot_minutes||15," min"]}),D.location&&a.jsx(Ge,{variant:"outline",className:"border-slate-200 bg-slate-50 px-2 py-0.5 text-[11px]",children:D.location})]})]}),a.jsx(Te,{variant:"ghost",size:"icon",className:"h-8 w-8 text-slate-400 hover:text-rose-600",onClick:()=>P(D.id),disabled:S===D.id,children:a.jsx(_l,{className:"h-4 w-4"})})]},D.id)})})]})]})]})})}function aDe(t,n){return b.useReducer((r,s)=>n[r][s]??r,t)}var Ck="ScrollArea",[Pq]=Cu(Ck),[iDe,bi]=Pq(Ck),Mq=b.forwardRef((t,n)=>{const{__scopeScrollArea:r,type:s="hover",dir:i,scrollHideDelay:o=600,...l}=t,[c,d]=b.useState(null),[u,h]=b.useState(null),[m,g]=b.useState(null),[y,N]=b.useState(null),[j,S]=b.useState(null),[_,A]=b.useState(0),[k,T]=b.useState(0),[P,M]=b.useState(!1),[O,D]=b.useState(!1),L=vn(n,V=>d(V)),$=_v(i);return a.jsx(iDe,{scope:r,type:s,dir:$,scrollHideDelay:o,scrollArea:c,viewport:u,onViewportChange:h,content:m,onContentChange:g,scrollbarX:y,onScrollbarXChange:N,scrollbarXEnabled:P,onScrollbarXEnabledChange:M,scrollbarY:j,onScrollbarYChange:S,scrollbarYEnabled:O,onScrollbarYEnabledChange:D,onCornerWidthChange:A,onCornerHeightChange:T,children:a.jsx(Ht.div,{dir:$,...l,ref:L,style:{position:"relative","--radix-scroll-area-corner-width":_+"px","--radix-scroll-area-corner-height":k+"px",...t.style}})})});Mq.displayName=Ck;var Oq="ScrollAreaViewport",Dq=b.forwardRef((t,n)=>{const{__scopeScrollArea:r,children:s,nonce:i,...o}=t,l=bi(Oq,r),c=b.useRef(null),d=vn(n,c,l.onViewportChange);return a.jsxs(a.Fragment,{children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),a.jsx(Ht.div,{"data-radix-scroll-area-viewport":"",...o,ref:d,style:{overflowX:l.scrollbarXEnabled?"scroll":"hidden",overflowY:l.scrollbarYEnabled?"scroll":"hidden",...t.style},children:a.jsx("div",{ref:l.onContentChange,style:{minWidth:"100%",display:"table"},children:s})})]})});Dq.displayName=Oq;var $o="ScrollAreaScrollbar",_k=b.forwardRef((t,n)=>{const{forceMount:r,...s}=t,i=bi($o,t.__scopeScrollArea),{onScrollbarXEnabledChange:o,onScrollbarYEnabledChange:l}=i,c=t.orientation==="horizontal";return b.useEffect(()=>(c?o(!0):l(!0),()=>{c?o(!1):l(!1)}),[c,o,l]),i.type==="hover"?a.jsx(oDe,{...s,ref:n,forceMount:r}):i.type==="scroll"?a.jsx(lDe,{...s,ref:n,forceMount:r}):i.type==="auto"?a.jsx(Rq,{...s,ref:n,forceMount:r}):i.type==="always"?a.jsx(Ak,{...s,ref:n}):null});_k.displayName=$o;var oDe=b.forwardRef((t,n)=>{const{forceMount:r,...s}=t,i=bi($o,t.__scopeScrollArea),[o,l]=b.useState(!1);return b.useEffect(()=>{const c=i.scrollArea;let d=0;if(c){const u=()=>{window.clearTimeout(d),l(!0)},h=()=>{d=window.setTimeout(()=>l(!1),i.scrollHideDelay)};return c.addEventListener("pointerenter",u),c.addEventListener("pointerleave",h),()=>{window.clearTimeout(d),c.removeEventListener("pointerenter",u),c.removeEventListener("pointerleave",h)}}},[i.scrollArea,i.scrollHideDelay]),a.jsx(El,{present:r||o,children:a.jsx(Rq,{"data-state":o?"visible":"hidden",...s,ref:n})})}),lDe=b.forwardRef((t,n)=>{const{forceMount:r,...s}=t,i=bi($o,t.__scopeScrollArea),o=t.orientation==="horizontal",l=Kb(()=>d("SCROLL_END"),100),[c,d]=aDe("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return b.useEffect(()=>{if(c==="idle"){const u=window.setTimeout(()=>d("HIDE"),i.scrollHideDelay);return()=>window.clearTimeout(u)}},[c,i.scrollHideDelay,d]),b.useEffect(()=>{const u=i.viewport,h=o?"scrollLeft":"scrollTop";if(u){let m=u[h];const g=()=>{const y=u[h];m!==y&&(d("SCROLL"),l()),m=y};return u.addEventListener("scroll",g),()=>u.removeEventListener("scroll",g)}},[i.viewport,o,d,l]),a.jsx(El,{present:r||c!=="hidden",children:a.jsx(Ak,{"data-state":c==="hidden"?"hidden":"visible",...s,ref:n,onPointerEnter:Lt(t.onPointerEnter,()=>d("POINTER_ENTER")),onPointerLeave:Lt(t.onPointerLeave,()=>d("POINTER_LEAVE"))})})}),Rq=b.forwardRef((t,n)=>{const r=bi($o,t.__scopeScrollArea),{forceMount:s,...i}=t,[o,l]=b.useState(!1),c=t.orientation==="horizontal",d=Kb(()=>{if(r.viewport){const u=r.viewport.offsetWidth<r.viewport.scrollWidth,h=r.viewport.offsetHeight<r.viewport.scrollHeight;l(c?u:h)}},10);return ch(r.viewport,d),ch(r.content,d),a.jsx(El,{present:s||o,children:a.jsx(Ak,{"data-state":o?"visible":"hidden",...i,ref:n})})}),Ak=b.forwardRef((t,n)=>{const{orientation:r="vertical",...s}=t,i=bi($o,t.__scopeScrollArea),o=b.useRef(null),l=b.useRef(0),[c,d]=b.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=zq(c.viewport,c.content),h={...s,sizes:c,onSizesChange:d,hasThumb:u>0&&u<1,onThumbChange:g=>o.current=g,onThumbPointerUp:()=>l.current=0,onThumbPointerDown:g=>l.current=g};function m(g,y){return mDe(g,l.current,c,y)}return r==="horizontal"?a.jsx(cDe,{...h,ref:n,onThumbPositionChange:()=>{if(i.viewport&&o.current){const g=i.viewport.scrollLeft,y=$D(g,c,i.dir);o.current.style.transform=`translate3d(${y}px, 0, 0)`}},onWheelScroll:g=>{i.viewport&&(i.viewport.scrollLeft=g)},onDragScroll:g=>{i.viewport&&(i.viewport.scrollLeft=m(g,i.dir))}}):r==="vertical"?a.jsx(dDe,{...h,ref:n,onThumbPositionChange:()=>{if(i.viewport&&o.current){const g=i.viewport.scrollTop,y=$D(g,c);o.current.style.transform=`translate3d(0, ${y}px, 0)`}},onWheelScroll:g=>{i.viewport&&(i.viewport.scrollTop=g)},onDragScroll:g=>{i.viewport&&(i.viewport.scrollTop=m(g))}}):null}),cDe=b.forwardRef((t,n)=>{const{sizes:r,onSizesChange:s,...i}=t,o=bi($o,t.__scopeScrollArea),[l,c]=b.useState(),d=b.useRef(null),u=vn(n,d,o.onScrollbarXChange);return b.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),a.jsx(Bq,{"data-orientation":"horizontal",...i,ref:u,sizes:r,style:{bottom:0,left:o.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:o.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Gb(r)+"px",...t.style},onThumbPointerDown:h=>t.onThumbPointerDown(h.x),onDragScroll:h=>t.onDragScroll(h.x),onWheelScroll:(h,m)=>{if(o.viewport){const g=o.viewport.scrollLeft+h.deltaX;t.onWheelScroll(g),Vq(g,m)&&h.preventDefault()}},onResize:()=>{d.current&&o.viewport&&l&&s({content:o.viewport.scrollWidth,viewport:o.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:By(l.paddingLeft),paddingEnd:By(l.paddingRight)}})}})}),dDe=b.forwardRef((t,n)=>{const{sizes:r,onSizesChange:s,...i}=t,o=bi($o,t.__scopeScrollArea),[l,c]=b.useState(),d=b.useRef(null),u=vn(n,d,o.onScrollbarYChange);return b.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),a.jsx(Bq,{"data-orientation":"vertical",...i,ref:u,sizes:r,style:{top:0,right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Gb(r)+"px",...t.style},onThumbPointerDown:h=>t.onThumbPointerDown(h.y),onDragScroll:h=>t.onDragScroll(h.y),onWheelScroll:(h,m)=>{if(o.viewport){const g=o.viewport.scrollTop+h.deltaY;t.onWheelScroll(g),Vq(g,m)&&h.preventDefault()}},onResize:()=>{d.current&&o.viewport&&l&&s({content:o.viewport.scrollHeight,viewport:o.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:By(l.paddingTop),paddingEnd:By(l.paddingBottom)}})}})}),[uDe,Lq]=Pq($o),Bq=b.forwardRef((t,n)=>{const{__scopeScrollArea:r,sizes:s,hasThumb:i,onThumbChange:o,onThumbPointerUp:l,onThumbPointerDown:c,onThumbPositionChange:d,onDragScroll:u,onWheelScroll:h,onResize:m,...g}=t,y=bi($o,r),[N,j]=b.useState(null),S=vn(n,L=>j(L)),_=b.useRef(null),A=b.useRef(""),k=y.viewport,T=s.content-s.viewport,P=Us(h),M=Us(d),O=Kb(m,10);function D(L){if(_.current){const $=L.clientX-_.current.left,V=L.clientY-_.current.top;u({x:$,y:V})}}return b.useEffect(()=>{const L=$=>{const V=$.target;(N==null?void 0:N.contains(V))&&P($,T)};return document.addEventListener("wheel",L,{passive:!1}),()=>document.removeEventListener("wheel",L,{passive:!1})},[k,N,T,P]),b.useEffect(M,[s,M]),ch(N,O),ch(y.content,O),a.jsx(uDe,{scope:r,scrollbar:N,hasThumb:i,onThumbChange:Us(o),onThumbPointerUp:Us(l),onThumbPositionChange:M,onThumbPointerDown:Us(c),children:a.jsx(Ht.div,{...g,ref:S,style:{position:"absolute",...g.style},onPointerDown:Lt(t.onPointerDown,L=>{L.button===0&&(L.target.setPointerCapture(L.pointerId),_.current=N.getBoundingClientRect(),A.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",y.viewport&&(y.viewport.style.scrollBehavior="auto"),D(L))}),onPointerMove:Lt(t.onPointerMove,D),onPointerUp:Lt(t.onPointerUp,L=>{const $=L.target;$.hasPointerCapture(L.pointerId)&&$.releasePointerCapture(L.pointerId),document.body.style.webkitUserSelect=A.current,y.viewport&&(y.viewport.style.scrollBehavior=""),_.current=null})})})}),Ly="ScrollAreaThumb",Fq=b.forwardRef((t,n)=>{const{forceMount:r,...s}=t,i=Lq(Ly,t.__scopeScrollArea);return a.jsx(El,{present:r||i.hasThumb,children:a.jsx(fDe,{ref:n,...s})})}),fDe=b.forwardRef((t,n)=>{const{__scopeScrollArea:r,style:s,...i}=t,o=bi(Ly,r),l=Lq(Ly,r),{onThumbPositionChange:c}=l,d=vn(n,m=>l.onThumbChange(m)),u=b.useRef(void 0),h=Kb(()=>{u.current&&(u.current(),u.current=void 0)},100);return b.useEffect(()=>{const m=o.viewport;if(m){const g=()=>{if(h(),!u.current){const y=pDe(m,c);u.current=y,c()}};return c(),m.addEventListener("scroll",g),()=>m.removeEventListener("scroll",g)}},[o.viewport,h,c]),a.jsx(Ht.div,{"data-state":l.hasThumb?"visible":"hidden",...i,ref:d,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...s},onPointerDownCapture:Lt(t.onPointerDownCapture,m=>{const y=m.target.getBoundingClientRect(),N=m.clientX-y.left,j=m.clientY-y.top;l.onThumbPointerDown({x:N,y:j})}),onPointerUp:Lt(t.onPointerUp,l.onThumbPointerUp)})});Fq.displayName=Ly;var Ek="ScrollAreaCorner",$q=b.forwardRef((t,n)=>{const r=bi(Ek,t.__scopeScrollArea),s=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&s?a.jsx(hDe,{...t,ref:n}):null});$q.displayName=Ek;var hDe=b.forwardRef((t,n)=>{const{__scopeScrollArea:r,...s}=t,i=bi(Ek,r),[o,l]=b.useState(0),[c,d]=b.useState(0),u=!!(o&&c);return ch(i.scrollbarX,()=>{var m;const h=((m=i.scrollbarX)==null?void 0:m.offsetHeight)||0;i.onCornerHeightChange(h),d(h)}),ch(i.scrollbarY,()=>{var m;const h=((m=i.scrollbarY)==null?void 0:m.offsetWidth)||0;i.onCornerWidthChange(h),l(h)}),u?a.jsx(Ht.div,{...s,ref:n,style:{width:o,height:c,position:"absolute",right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function By(t){return t?parseInt(t,10):0}function zq(t,n){const r=t/n;return isNaN(r)?0:r}function Gb(t){const n=zq(t.viewport,t.content),r=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,s=(t.scrollbar.size-r)*n;return Math.max(s,18)}function mDe(t,n,r,s="ltr"){const i=Gb(r),o=i/2,l=n||o,c=i-l,d=r.scrollbar.paddingStart+l,u=r.scrollbar.size-r.scrollbar.paddingEnd-c,h=r.content-r.viewport,m=s==="ltr"?[0,h]:[h*-1,0];return Uq([d,u],m)(t)}function $D(t,n,r="ltr"){const s=Gb(n),i=n.scrollbar.paddingStart+n.scrollbar.paddingEnd,o=n.scrollbar.size-i,l=n.content-n.viewport,c=o-s,d=r==="ltr"?[0,l]:[l*-1,0],u=dS(t,d);return Uq([0,l],[0,c])(u)}function Uq(t,n){return r=>{if(t[0]===t[1]||n[0]===n[1])return n[0];const s=(n[1]-n[0])/(t[1]-t[0]);return n[0]+s*(r-t[0])}}function Vq(t,n){return t>0&&t<n}var pDe=(t,n=()=>{})=>{let r={left:t.scrollLeft,top:t.scrollTop},s=0;return function i(){const o={left:t.scrollLeft,top:t.scrollTop},l=r.left!==o.left,c=r.top!==o.top;(l||c)&&n(),r=o,s=window.requestAnimationFrame(i)}(),()=>window.cancelAnimationFrame(s)};function Kb(t,n){const r=Us(t),s=b.useRef(0);return b.useEffect(()=>()=>window.clearTimeout(s.current),[]),b.useCallback(()=>{window.clearTimeout(s.current),s.current=window.setTimeout(r,n)},[r,n])}function ch(t,n){const r=Us(n);vs(()=>{let s=0;if(t){const i=new ResizeObserver(()=>{cancelAnimationFrame(s),s=window.requestAnimationFrame(r)});return i.observe(t),()=>{window.cancelAnimationFrame(s),i.unobserve(t)}}},[t,r])}var Hq=Mq,xDe=Dq,gDe=$q;const ra=b.forwardRef(({className:t,children:n,...r},s)=>a.jsxs(Hq,{ref:s,className:_t("relative overflow-hidden",t),...r,children:[a.jsx(xDe,{className:"h-full w-full rounded-[inherit]",children:n}),a.jsx(Wq,{}),a.jsx(gDe,{})]}));ra.displayName=Hq.displayName;const Wq=b.forwardRef(({className:t,orientation:n="vertical",...r},s)=>a.jsx(_k,{ref:s,orientation:n,className:_t("flex touch-none select-none transition-colors",n==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",n==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...r,children:a.jsx(Fq,{className:"relative flex-1 rounded-full bg-border"})}));Wq.displayName=_k.displayName;var yDe="Separator",zD="horizontal",vDe=["horizontal","vertical"],qq=b.forwardRef((t,n)=>{const{decorative:r,orientation:s=zD,...i}=t,o=bDe(s)?s:zD,c=r?{role:"none"}:{"aria-orientation":o==="vertical"?o:void 0,role:"separator"};return a.jsx(Ht.div,{"data-orientation":o,...c,...i,ref:n})});qq.displayName=yDe;function bDe(t){return vDe.includes(t)}var Gq=qq;const Fy=b.forwardRef(({className:t,orientation:n="horizontal",decorative:r=!0,...s},i)=>a.jsx(Gq,{ref:i,decorative:r,orientation:n,className:_t("shrink-0 bg-border",n==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...s}));Fy.displayName=Gq.displayName;const wDe=()=>new Date().toISOString().slice(0,10);function NDe(){const[t,n]=b.useState(wDe()),[r,s]=b.useState(null),[i,o]=b.useState(null),[l,c]=b.useState(null),[d,u]=b.useState("Consultation"),[h,m]=b.useState([]),[g,y]=b.useState(""),[N,j]=b.useState(!1),[S,_]=b.useState([]),[A,k]=b.useState(!1),T=(L,$)=>{s(L),o(($==null?void 0:$.department_id)||null),y("")},P=L=>{c(L)};b.useEffect(()=>{(async()=>{if(!r||!t){m([]),_([]);return}try{j(!0);const{data:$}=await rP({doctorUserId:Number(r),date:t,detailed:!0}),V=Array.isArray($)?$:($==null?void 0:$.slots)||[];m(V)}catch{m([])}finally{j(!1)}try{k(!0);const{data:$}=await sP({date:t,doctor_id:Number(r)});_($||[])}catch{_([])}finally{k(!1)}})()},[r,t]);const M=b.useMemo(()=>h.filter(L=>L.status==="free"||!L.status),[h]),O=b.useMemo(()=>{var F;const L=S.length,$=M.length,V=g||((F=M[0])!=null&&F.start?`Earliest ${M[0].start}`:"Not selected");return{total:L,free:$,selected:V}},[S,M,g]),D=async L=>{if(L.preventDefault(),!l){fe.error("Please select a patient");return}if(!r||!i){fe.error("Please select department & doctor");return}if(!g){fe.error("Please choose a time slot");return}try{await tce({patient_id:l,department_id:i,doctor_user_id:r,date:t,slot_start:g,purpose:d||"Consultation"}),fe.success("Appointment booked"),y("");const{data:$}=await sP({date:t,doctor_id:Number(r)});_($||[]);const{data:V}=await rP({doctorUserId:Number(r),date:t,detailed:!0}),F=Array.isArray(V)?V:(V==null?void 0:V.slots)||[];m(F)}catch{}};return a.jsx("div",{className:"h-full w-full bg-[#eee] rounded",children:a.jsxs("div",{className:"mx-auto flex max-w-6xl flex-col gap-4 px-3 py-4 sm:px-4 lg:px-6 lg:py-6",children:[a.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white px-3 py-1 text-xs text-slate-500 shadow-sm",children:[a.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-500 animate-pulse"}),a.jsx("span",{children:"Live OPD  Booking & Queue"})]}),a.jsx("h1",{className:"text-xl font-semibold text-slate-900 sm:text-2xl",children:"OPD Appointment Booking"}),a.jsx("p",{className:"text-xs text-slate-500 sm:text-sm",children:"Quickly book patient appointments, view doctor schedule, and monitor today's queue."})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:justify-end",children:[a.jsxs(Ge,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-white px-3 py-1 text-[11px] font-normal text-slate-700 shadow-sm",children:[a.jsx(sa,{className:"h-3 w-3"}),t]}),r&&a.jsxs(Ge,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-white px-3 py-1 text-[11px] font-normal text-slate-700 shadow-sm",children:[a.jsx(kn,{className:"h-3 w-3"}),"Doctor ID ",r]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-3",children:[a.jsx(Re,{className:"rounded-2xl border-slate-200 shadow-sm",children:a.jsxs(Be,{className:"flex items-center justify-between gap-3 py-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Today's appointments"}),a.jsx("p",{className:"text-xl font-semibold text-slate-900",children:O.total})]}),a.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-2",children:a.jsx(bp,{className:"h-5 w-5 text-slate-700"})})]})}),a.jsx(Re,{className:"rounded-2xl border-slate-200 shadow-sm",children:a.jsxs(Be,{className:"flex items-center justify-between gap-3 py-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Free slots"}),a.jsx("p",{className:"text-xl font-semibold text-slate-900",children:O.free})]}),a.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-2",children:a.jsx(ci,{className:"h-5 w-5 text-slate-700"})})]})}),a.jsx(Re,{className:"rounded-2xl border-slate-200 shadow-sm",children:a.jsxs(Be,{className:"flex items-center justify-between gap-3 py-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Selected time"}),a.jsx("p",{className:"text-sm font-semibold text-slate-900",children:O.selected})]}),a.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-2",children:a.jsx(ha,{className:"h-5 w-5 text-slate-700"})})]})})]}),a.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.6fr),minmax(0,1.4fr)] lg:gap-6",children:[a.jsx(ht.div,{layout:!0,initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.18},children:a.jsxs(Re,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsxs(Ye,{className:"pb-3",children:[a.jsxs(Ze,{className:"flex items-center gap-2 text-base font-semibold text-slate-900 sm:text-lg",children:[a.jsx("span",{className:"inline-flex h-7 w-7 items-center justify-center rounded-2xl bg-slate-900 text-xs text-white",children:"1"}),"Book a new appointment"]}),a.jsx(ma,{className:"text-xs text-slate-500 sm:text-sm",children:"Choose patient, doctor, date and slot. All fields are optimized for quick keyboard + mouse workflow."})]}),a.jsx(Be,{className:"space-y-4",children:a.jsxs("form",{onSubmit:D,className:"space-y-4",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/60 p-3 sm:p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 pb-2",children:[a.jsx("span",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-white text-[11px] font-semibold text-slate-900 shadow-sm",children:a.jsx(bp,{className:"h-3 w-3"})}),a.jsx("span",{className:"text-xs font-medium uppercase tracking-wide text-slate-500",children:"Patient details"})]}),a.jsx("div",{className:"space-y-2 sm:space-y-3",children:a.jsx(yx,{value:l,onChange:P})})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/60 p-3 sm:p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 pb-2",children:[a.jsx("span",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-white text-[11px] font-semibold text-slate-900 shadow-sm",children:a.jsx(kn,{className:"h-3 w-3"})}),a.jsx("span",{className:"text-xs font-medium uppercase tracking-wide text-slate-500",children:"Department & doctor"})]}),a.jsx(Al,{value:r,onChange:T})]})]}),a.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Date"}),a.jsx(Ne,{type:"date",value:t,onChange:L=>n(L.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Purpose"}),a.jsx(Ne,{value:d,onChange:L=>u(L.target.value),placeholder:"Consultation / Review / Procedure",className:"h-9 rounded-2xl border-slate-200 text-sm"})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Time slot"}),a.jsxs("span",{className:"text-[11px] text-slate-400",children:[M.length," free slot(s) available"]})]}),N?a.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from({length:5}).map((L,$)=>a.jsx(Xe,{className:"h-7 w-16 rounded-full bg-slate-100"},$))}):M.length===0?a.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-3 py-2 text-xs text-amber-800",children:"No free slots for this date / doctor. Choose another date or doctor."}):a.jsx(ra,{className:"max-h-40 rounded-2xl border border-slate-100 bg-slate-50/80 px-2 py-2",children:a.jsx("div",{className:"flex flex-wrap gap-2",children:M.map(L=>a.jsxs("button",{type:"button",onClick:()=>y(L.start),className:["inline-flex items-center gap-1 rounded-full border px-3 py-1 text-[11px] font-medium transition",g===L.start?"border-slate-900 bg-slate-900 text-white":"border-slate-200 bg-white text-slate-700 hover:bg-slate-100"].join(" "),children:[a.jsx(ci,{className:"h-3 w-3"}),L.start,"",L.end]},L.start))})})]}),a.jsx(Fy,{className:"my-1"}),a.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[a.jsx("p",{className:"text-[11px] text-slate-400",children:"Booking will immediately reflect in OPD queue & doctor view."}),a.jsx(Te,{type:"submit",className:"h-9 rounded-2xl bg-slate-900 px-4 text-xs font-semibold uppercase tracking-wide text-white hover:bg-slate-800 disabled:opacity-50",disabled:!l||!r||!g,children:"Book appointment"})]})]})})]})}),a.jsx(ht.div,{layout:!0,initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2,delay:.05},className:"lg:sticky lg:top-24",children:a.jsxs(Re,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsx(Ye,{className:"pb-3",children:a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{children:[a.jsxs(Ze,{className:"flex items-center gap-2 text-base font-semibold text-slate-900 sm:text-lg",children:[a.jsx(sa,{className:"h-4 w-4 text-slate-600"}),"Appointments for the day"]}),a.jsx(ma,{className:"text-xs text-slate-500 sm:text-sm",children:"See all appointments for the selected doctor and date."})]}),(A||N)&&a.jsxs(Ge,{variant:"outline",className:"inline-flex items-center gap-1 rounded-full border-slate-200 bg-slate-50 px-2 py-1 text-[11px] text-slate-500",children:[a.jsx(dr,{className:"h-3 w-3 animate-spin"}),"Syncing"]})]})}),a.jsxs(Be,{className:"pb-3",children:[a.jsxs("div",{className:"mb-2 flex items-center justify-between text-[11px] text-slate-400",children:[a.jsxs("span",{children:[t," ",r?` Doctor ID ${r}`:""]}),a.jsxs("span",{children:[S.length," appointment(s)"]})]}),A?a.jsx("div",{className:"space-y-2",children:Array.from({length:4}).map((L,$)=>a.jsx(Xe,{className:"h-14 w-full rounded-2xl bg-slate-100"},$))}):S.length===0?a.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 px-3 py-4 text-center text-xs text-slate-500",children:["No appointments for this filter yet.",a.jsx("div",{className:"mt-1 text-[11px] text-slate-400",children:"Start by booking a new appointment on the left."})]}):a.jsx(ra,{className:"max-h-[380px] pr-1",children:a.jsx("div",{className:"space-y-2 text-sm",children:a.jsx(su,{initial:!1,children:S.map(L=>a.jsxs(ht.div,{initial:{opacity:0,y:4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},transition:{duration:.15},className:"flex flex-col gap-1 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-800 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-1",children:[a.jsxs("span",{className:"rounded-full bg-white px-2 py-0.5 text-[11px] font-medium text-slate-800 border border-slate-200",children:[L.slot_start,"",L.slot_end]}),a.jsx("span",{className:"font-medium",children:L.patient_name}),a.jsxs("span",{className:"text-[11px] text-slate-500",children:["(UHID ",L.uhid,")"]})]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:[L.department_name,"  ",L.doctor_name," ",a.jsx("span",{className:"ml-1 inline-flex items-center rounded-full bg-slate-900 px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide text-white",children:L.status})]})]}),a.jsx("div",{className:"text-[11px] text-slate-500 sm:text-right",children:L.vitals_registered?a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2 py-0.5 text-[10px] font-medium text-emerald-700 border border-emerald-100",children:[a.jsx(ha,{className:"h-3 w-3"}),"Vitals done"]}):a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-100 px-2 py-0.5 text-[10px] font-medium text-slate-600 border border-slate-200",children:[a.jsx(ha,{className:"h-3 w-3"}),"No vitals yet"]})})]},L.id))})})})]})]})})]})]})})}const jDe=()=>new Date().toISOString().slice(0,10),SDe={booked:"Booked",checked_in:"Checked-in",in_progress:"In progress",completed:"Completed",no_show:"No-show",cancelled:"Cancelled"},CDe={booked:"bg-slate-100 text-slate-700",checked_in:"bg-blue-100 text-blue-700",in_progress:"bg-amber-100 text-amber-700",completed:"bg-emerald-100 text-emerald-700",no_show:"bg-rose-100 text-rose-700",cancelled:"bg-slate-200 text-slate-600"};function _De(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-IN",{weekday:"short",day:"2-digit",month:"short",year:"numeric"})}catch{return t}}function ADe(t,n){if(!(t!=null&&t.time)||!["booked","checked_in","in_progress"].includes(t.status))return null;try{const r=new Date;if(!(n===r.toISOString().slice(0,10)))return null;const i=new Date(`${n}T${t.time}:00`),o=r.getTime()-i.getTime(),l=Math.floor(o/(1e3*60));if(l<=0)return"0 min";if(l<60)return`${l} min`;const c=Math.floor(l/60),d=l%60;return c>=5?`${c} hrs+`:d===0?`${c} hr${c>1?"s":""}`:`${c}h ${d}m`}catch{return null}}function EDe(){const{user:t}=Cr()||{},[n,r]=b.useState(null),[s,i]=b.useState(jDe()),[o,l]=b.useState([]),[c,d]=b.useState(!1),[u,h]=b.useState("active"),m=Hi();b.useEffect(()=>{t!=null&&t.is_doctor&&!n&&r(t.id)},[t,n]);const g=!!(n&&s),y=b.useCallback(async()=>{if(!n||!s){l([]);return}try{d(!0);const A={doctor_user_id:Number(n),for_date:s};t!=null&&t.department_id&&(A.department_id=t.department_id);const{data:k}=await gB(A);l(k||[])}catch(A){console.error(A),l([])}finally{d(!1)}},[n,s,t]);b.useEffect(()=>{y()},[y]);const N=async(A,k,T={})=>{try{const{data:P}=await nce(A.appointment_id,k);fe.success(`Status updated to ${P.status.toUpperCase()}`),T.goToVisit&&P.visit_id?m(`/opd/visit/${P.visit_id}`):y()}catch{}},j=A=>{r(A)},S=b.useMemo(()=>{const A={total:o.length,booked:0,checked_in:0,in_progress:0,completed:0,no_show:0,cancelled:0};for(const k of o)A[k.status]!==void 0&&(A[k.status]+=1);return A},[o]),_=b.useMemo(()=>u==="all"?o:u==="active"?o.filter(A=>["booked","checked_in","in_progress"].includes(A.status)):o.filter(A=>A.status===u),[o,u]);return a.jsx("div",{className:"min-h-[calc(100vh-5rem)] bg-slate-50 px-4 py-6 md:px-6",children:a.jsxs("div",{className:"mx-auto max-w-5xl space-y-6",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:"relative flex h-2 w-2",children:[a.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-emerald-500 opacity-75"}),a.jsx("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-emerald-500"})]}),a.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.2em] text-emerald-700",children:"Live OPD Queue"})]}),a.jsx("h1",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"OPD Queue Management"}),a.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Track today's appointments, check-in patients, and start / complete visits in real-time."})]}),a.jsxs("div",{className:"hidden text-right text-xs text-slate-500 md:block",children:[a.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1",children:[a.jsx(ha,{className:"h-3 w-3"}),a.jsx("span",{children:"Doctor OPD"})]}),a.jsxs("div",{className:"mt-1 flex items-center justify-end gap-1",children:[a.jsx(sa,{className:"h-3 w-3"}),a.jsx("span",{children:_De(s)})]})]})]}),a.jsxs(Re,{className:"border-slate-200 shadow-sm rounded-3xl",children:[a.jsxs(Ye,{className:"border-b border-slate-100 pb-4",children:[a.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-end md:justify-between",children:[a.jsxs("div",{className:"grid w-full gap-3 md:grid-cols-[2fr,1.2fr] md:items-end",children:[a.jsxs("div",{children:[a.jsx(Al,{value:n,onChange:j,autoSelectCurrentDoctor:!0}),(t==null?void 0:t.is_doctor)&&a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Defaulted to your OPD queue."})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(sa,{className:"h-3 w-3"}),"Date"]}),a.jsx(Ne,{type:"date",value:s,onChange:A=>i(A.target.value),className:"h-9"})]})]}),a.jsx("div",{className:"flex items-center gap-2 md:w-auto",children:a.jsxs(Te,{type:"button",size:"sm",variant:"outline",className:"gap-1",onClick:y,disabled:c||!g,children:[a.jsx(qf,{className:"h-3 w-3"}),"Refresh"]})})]}),a.jsxs("div",{className:"mt-4 flex flex-wrap gap-2 text-xs",children:[a.jsxs(Ge,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-slate-50",children:[a.jsx(ci,{className:"h-3 w-3"}),a.jsx("span",{children:"Total"}),a.jsx("span",{className:"font-semibold",children:S.total})]}),a.jsxs(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-slate-50",children:["Booked: ",S.booked]}),a.jsxs(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-blue-50 text-blue-700",children:["Checked-in: ",S.checked_in]}),a.jsxs(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-amber-50 text-amber-700",children:["In progress: ",S.in_progress]}),a.jsxs(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-emerald-50 text-emerald-700",children:["Completed: ",S.completed]}),a.jsxs(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-rose-50 text-rose-700",children:["No-show: ",S.no_show]})]})]}),a.jsxs(Be,{className:"pt-4",children:[a.jsx("div",{className:"mb-3 flex flex-wrap gap-1.5 text-xs",children:[{key:"active",label:"Active (Booked / Checked-in / In progress)"},{key:"all",label:"All"},{key:"booked",label:"Booked"},{key:"checked_in",label:"Checked-in"},{key:"in_progress",label:"In progress"},{key:"completed",label:"Completed"},{key:"no_show",label:"No-show"}].map(A=>a.jsx("button",{type:"button",onClick:()=>h(A.key),className:["rounded-full border px-3 py-1 transition text-[11px]",u===A.key?"border-slate-900 bg-slate-900 text-white":"border-slate-200 bg-slate-50 text-slate-600 hover:bg-white"].join(" "),children:A.label},A.key))}),!g&&a.jsxs("div",{className:"flex flex-col items-center gap-2 py-10 text-center text-sm text-slate-500",children:[a.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-100",children:a.jsx(kn,{className:"h-5 w-5 text-slate-500"})}),a.jsx("div",{className:"font-medium text-slate-700",children:"Select doctor & date to view queue"}),a.jsx("p",{className:"max-w-md text-xs text-slate-500",children:"Choose a consultant and date above to see the live OPD queue, update statuses, and open visits."})]}),g&&c&&a.jsx("div",{className:"space-y-3 py-4",children:[1,2,3].map(A=>a.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-100 bg-slate-50/80 px-3 py-3",children:[a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx(Xe,{className:"h-4 w-40"}),a.jsx(Xe,{className:"h-3 w-64"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Xe,{className:"h-7 w-16"}),a.jsx(Xe,{className:"h-7 w-20"})]})]},A))}),g&&!c&&_.length===0&&a.jsxs("div",{className:"flex flex-col items-center gap-2 py-10 text-center text-sm text-slate-500",children:[a.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-100",children:a.jsx(ci,{className:"h-5 w-5 text-slate-500"})}),a.jsx("div",{className:"font-medium text-slate-700",children:"No appointments for this doctor / date"}),a.jsx("p",{className:"max-w-md text-xs text-slate-500",children:"Try changing the status filter above or pick a different date to see previous or upcoming OPD queues."})]}),g&&!c&&_.length>0&&a.jsx("div",{className:"space-y-2 pt-1 text-sm",children:_.map(A=>{var P,M,O;const k=CDe[A.status]||"bg-slate-100 text-slate-700",T=ADe(A,s);return a.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[a.jsx("span",{className:"text-xs font-semibold text-slate-900",children:A.time}),a.jsx("span",{className:"mx-0.5 text-slate-400",children:""}),a.jsxs("span",{className:"flex items-center gap-1 text-sm font-medium text-slate-900",children:[a.jsx(hi,{className:"h-3.5 w-3.5 text-slate-500"}),(P=A.patient)==null?void 0:P.name]}),a.jsx("span",{className:"mx-0.5 text-slate-400",children:""}),a.jsxs("span",{className:"text-[11px] text-slate-500",children:["UHID ",(M=A.patient)==null?void 0:M.uhid,"  ",(O=A.patient)==null?void 0:O.phone]})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-1 text-[11px] text-slate-500",children:[a.jsx("span",{children:"Status:"}),a.jsx(Ge,{className:`border-none px-2 py-0.5 text-[11px] font-semibold uppercase ${k}`,children:SDe[A.status]||A.status}),a.jsx("span",{className:"mx-1 text-slate-300",children:""}),a.jsxs("span",{children:["Purpose:"," ",a.jsx("span",{className:"font-medium text-slate-700",children:A.visit_purpose||"Consultation"})]}),a.jsx("span",{className:"mx-1 text-slate-300",children:""}),a.jsxs("span",{className:"inline-flex items-center gap-1",children:[a.jsx(Lj,{className:"h-3 w-3"}),"Vitals:"," ",a.jsx("span",{className:"font-medium",children:A.has_vitals?"Yes":"No"})]}),T&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mx-1 text-slate-300",children:""}),a.jsxs("span",{className:"inline-flex items-center gap-1",children:[a.jsx(ci,{className:"h-3 w-3"}),"Waiting:"," ",a.jsx("span",{className:"font-medium",children:T})]})]})]})]}),a.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-2 text-xs",children:[A.status==="booked"&&a.jsxs(a.Fragment,{children:[a.jsx(Te,{size:"sm",onClick:()=>N(A,"checked_in"),children:"Check-in"}),a.jsx(Te,{size:"sm",variant:"outline",onClick:()=>N(A,"no_show"),children:"Mark No-show"})]}),A.status==="checked_in"&&a.jsx(Te,{size:"sm",onClick:()=>N(A,"in_progress",{goToVisit:!0}),children:"Start Visit"}),A.status==="in_progress"&&a.jsx(Te,{size:"sm",onClick:()=>N(A,"completed"),children:"Complete Visit"}),A.visit_id&&a.jsx(Te,{size:"sm",variant:"outline",onClick:()=>m(`/opd/visit/${A.visit_id}`),children:"Open Visit"})]})]},A.appointment_id)})})]})]})]})})}const dh=b.forwardRef(({className:t,...n},r)=>a.jsx("textarea",{className:_t("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...n}));dh.displayName="Textarea";const kDe=()=>new Date().toISOString().slice(0,10);function TDe(){const[t,n]=b.useState(null),[r,s]=b.useState(kDe()),[i,o]=b.useState([]),[l,c]=b.useState(!1),[d,u]=b.useState(null),[h,m]=b.useState({height_cm:"",weight_kg:"",temp_c:"",pulse:"",resp_rate:"",spo2:"",bp_sys:"",bp_dia:"",notes:""}),[g,y]=b.useState(!1),N=async()=>{if(!t||!r){o([]);return}try{c(!0);const{data:O}=await gB({doctor_user_id:Number(t),for_date:r});o(O||[])}catch{o([])}finally{c(!1)}};b.useEffect(()=>{N()},[t,r]);const j=O=>{n(O)},S=()=>({height_cm:"",weight_kg:"",temp_c:"",pulse:"",resp_rate:"",spo2:"",bp_sys:"",bp_dia:"",notes:""}),_=O=>{u(O),m(S()),setTimeout(()=>{const D=document.getElementById("triage-vitals-form");D&&D.scrollIntoView({behavior:"smooth",block:"start"})},80)},A=async O=>{if(O.preventDefault(),!!d)try{y(!0);const D={appointment_id:d.appointment_id,height_cm:h.height_cm?Number(h.height_cm):void 0,weight_kg:h.weight_kg?Number(h.weight_kg):void 0,temp_c:h.temp_c?Number(h.temp_c):void 0,pulse:h.pulse?Number(h.pulse):void 0,resp_rate:h.resp_rate?Number(h.resp_rate):void 0,spo2:h.spo2?Number(h.spo2):void 0,bp_sys:h.bp_sys?Number(h.bp_sys):void 0,bp_dia:h.bp_dia?Number(h.bp_dia):void 0,notes:h.notes||void 0};await oce(D),fe.success("Vitals recorded"),u(null),await N()}catch{}finally{y(!1)}},k=(O,D)=>m(L=>({...L,[O]:D})),T=i.length,P=i.filter(O=>O.has_vitals).length,M=T-P;return a.jsx("div",{className:"h-full w-full bg-slate-50",children:a.jsxs("div",{className:"mx-auto flex max-w-6xl flex-col gap-4 px-3 py-4 sm:px-4 lg:px-6 lg:py-6",children:[a.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white px-3 py-1 text-xs text-slate-500 shadow-sm",children:[a.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-500 animate-pulse"}),a.jsx("span",{children:"Live OPD  Triage & Vitals"})]}),a.jsx("h1",{className:"text-xl font-semibold text-slate-900 sm:text-2xl",children:"OPD Triage (Vitals)"}),a.jsx("p",{className:"text-xs text-slate-500 sm:text-sm",children:"Nursing staff can quickly capture vitals for patients waiting in the doctor's queue."})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:justify-end",children:[a.jsxs(Ge,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-white px-3 py-1 text-[11px] font-normal text-slate-700 shadow-sm",children:[a.jsx(sa,{className:"h-3 w-3"}),r]}),t&&a.jsxs(Ge,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-white px-3 py-1 text-[11px] font-normal text-slate-700 shadow-sm",children:[a.jsx(kn,{className:"h-3 w-3"}),"Doctor ID ",t]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-3",children:[a.jsx(Re,{className:"rounded-2xl border-slate-200 shadow-sm",children:a.jsxs(Be,{className:"flex items-center justify-between gap-3 py-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Queue size"}),a.jsx("p",{className:"text-xl font-semibold text-slate-900",children:T})]}),a.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-2",children:a.jsx(bp,{className:"h-5 w-5 text-slate-700"})})]})}),a.jsx(Re,{className:"rounded-2xl border-slate-200 shadow-sm",children:a.jsxs(Be,{className:"flex items-center justify-between gap-3 py-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Vitals completed"}),a.jsx("p",{className:"text-xl font-semibold text-slate-900",children:P})]}),a.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-2",children:a.jsx(ha,{className:"h-5 w-5 text-slate-700"})})]})}),a.jsx(Re,{className:"rounded-2xl border-slate-200 shadow-sm",children:a.jsxs(Be,{className:"flex items-center justify-between gap-3 py-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Pending vitals"}),a.jsx("p",{className:"text-xl font-semibold text-slate-900",children:M})]}),a.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-2",children:a.jsx(Lj,{className:"h-5 w-5 text-slate-700"})})]})})]}),a.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.4fr),minmax(0,1.6fr)] lg:gap-6",children:[a.jsx(ht.div,{layout:!0,initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.18},children:a.jsxs(Re,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsxs(Ye,{className:"pb-3",children:[a.jsxs(Ze,{className:"flex items-center gap-2 text-base font-semibold text-slate-900 sm:text-lg",children:[a.jsx("span",{className:"inline-flex h-7 w-7 items-center justify-center rounded-2xl bg-slate-900 text-xs text-white",children:"1"}),"Select doctor & view queue"]}),a.jsx(ma,{className:"text-xs text-slate-500 sm:text-sm",children:"Pick the doctor and date to load today's OPD queue for triage."})]}),a.jsxs(Be,{className:"space-y-4",children:[a.jsxs("div",{className:"grid items-end gap-3 md:grid-cols-[2fr,1.3fr]",children:[a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/70 p-3 sm:p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 pb-2",children:[a.jsx("span",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-white text-[11px] font-semibold text-slate-900 shadow-sm",children:a.jsx(kn,{className:"h-3 w-3"})}),a.jsx("span",{className:"text-xs font-medium uppercase tracking-wide text-slate-500",children:"Doctor"})]}),a.jsx(Al,{value:t,onChange:j})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Date"}),a.jsx(Ne,{type:"date",value:r,onChange:O=>s(O.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]})]}),a.jsx(Fy,{}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-slate-400",children:[a.jsx("span",{children:t?"Queue for selected doctor":"Select a doctor to load queue"}),a.jsxs("span",{children:[T," patient(s)"]})]}),l?a.jsx("div",{className:"space-y-2 mt-1",children:Array.from({length:4}).map((O,D)=>a.jsx(Xe,{className:"h-14 w-full rounded-2xl bg-slate-100"},D))}):i.length===0?a.jsxs("div",{className:"mt-2 rounded-2xl border border-dashed border-slate-200 bg-slate-50 px-3 py-4 text-center text-xs text-slate-500",children:["No appointments for this doctor / date.",a.jsx("div",{className:"mt-1 text-[11px] text-slate-400",children:"Use the Appointment Booking screen to add new patients."})]}):a.jsx(ra,{className:"mt-1 max-h-[380px] pr-1",children:a.jsx("div",{className:"space-y-2 text-sm",children:a.jsx(su,{initial:!1,children:i.map(O=>a.jsxs(ht.div,{initial:{opacity:0,y:4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},transition:{duration:.15},className:"flex flex-col gap-2 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-800 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-1",children:[a.jsx("span",{className:"rounded-full bg-white px-2 py-0.5 text-[11px] font-medium text-slate-800 border border-slate-200",children:O.time}),a.jsx("span",{className:"font-medium",children:O.patient.name}),a.jsxs("span",{className:"text-[11px] text-slate-500",children:["(UHID ",O.patient.uhid,")"]})]}),a.jsxs("div",{className:"text-[11px] text-slate-500 flex flex-wrap items-center gap-2",children:[a.jsx("span",{children:"Vitals:"}),O.has_vitals?a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2 py-0.5 text-[10px] font-medium text-emerald-700 border border-emerald-100",children:[a.jsx(ha,{className:"h-3 w-3"}),"Already recorded"]}):a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-100 px-2 py-0.5 text-[10px] font-medium text-slate-600 border border-slate-200",children:[a.jsx(ha,{className:"h-3 w-3"}),"Not recorded"]})]})]}),a.jsx("div",{className:"flex items-center justify-end",children:a.jsx(Te,{type:"button",variant:O.has_vitals?"outline":"default",size:"sm",className:`rounded-2xl text-[11px] px-3 ${O.has_vitals?"bg-white text-slate-800 border-slate-300":"bg-slate-900 text-white hover:bg-slate-800"}`,onClick:()=>_(O),children:"Record vitals"})})]},O.appointment_id))})})})]})]})]})}),a.jsx(ht.div,{id:"triage-vitals-form",layout:!0,initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2,delay:.05},className:"lg:sticky lg:top-24",children:a.jsxs(Re,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsx(Ye,{className:"pb-3",children:a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{children:[a.jsxs(Ze,{className:"flex items-center gap-2 text-base font-semibold text-slate-900 sm:text-lg",children:[a.jsx(Lj,{className:"h-4 w-4 text-slate-700"}),"Record patient vitals"]}),a.jsx(ma,{className:"text-xs text-slate-500 sm:text-sm",children:"Select a patient from the queue to start capturing vitals."})]}),(g||l)&&a.jsxs(Ge,{variant:"outline",className:"inline-flex items-center gap-1 rounded-full border-slate-200 bg-slate-50 px-2 py-1 text-[11px] text-slate-500",children:[a.jsx(dr,{className:"h-3 w-3 animate-spin"}),"Syncing"]})]})}),a.jsx(Be,{className:"pb-4",children:d?a.jsxs("form",{onSubmit:A,className:"space-y-4",children:[a.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/80 px-3 py-2 text-xs text-slate-700",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-1 sm:gap-2",children:[a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-white px-2 py-0.5 text-[11px] font-medium text-slate-800 border border-slate-200",children:[a.jsx(bp,{className:"h-3 w-3"}),d.patient.name]}),a.jsxs("span",{className:"text-[11px] text-slate-500",children:["UHID ",d.patient.uhid]}),a.jsxs("span",{className:"text-[11px] text-slate-500",children:[" Time ",d.time]})]})}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Height (cm)"}),a.jsx(Ne,{value:h.height_cm,onChange:O=>k("height_cm",O.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Weight (kg)"}),a.jsx(Ne,{value:h.weight_kg,onChange:O=>k("weight_kg",O.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium text-slate-600",children:["Temperature (C)",a.jsx(Kte,{className:"h-3 w-3 text-slate-500"})]}),a.jsx(Ne,{value:h.temp_c,onChange:O=>k("temp_c",O.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Pulse (bpm)"}),a.jsx(Ne,{value:h.pulse,onChange:O=>k("pulse",O.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Resp. rate"}),a.jsx(Ne,{value:h.resp_rate,onChange:O=>k("resp_rate",O.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs font-medium text-slate-600",children:"SpO (%)"}),a.jsx(Ne,{value:h.spo2,onChange:O=>k("spo2",O.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs font-medium text-slate-600",children:"BP (sys / dia)"}),a.jsxs("div",{className:"flex gap-1.5",children:[a.jsx(Ne,{value:h.bp_sys,onChange:O=>k("bp_sys",O.target.value),placeholder:"Sys",className:"h-9 rounded-2xl border-slate-200 text-sm"}),a.jsx(Ne,{value:h.bp_dia,onChange:O=>k("bp_dia",O.target.value),placeholder:"Dia",className:"h-9 rounded-2xl border-slate-200 text-sm"})]})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Notes"}),a.jsx(dh,{value:h.notes,onChange:O=>k("notes",O.target.value),className:"min-h-[70px] rounded-2xl border-slate-200 text-sm",placeholder:"Enter any triage notes, pain score, alerts"})]}),a.jsx(Fy,{}),a.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[a.jsx("p",{className:"text-[11px] text-slate-400",children:"Saved vitals will be visible in the doctor's EMR view for this visit."}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Te,{type:"button",variant:"outline",size:"sm",className:"h-9 rounded-2xl border-slate-300 bg-white text-[11px]",onClick:()=>u(null),disabled:g,children:"Cancel"}),a.jsx(Te,{type:"submit",size:"sm",className:"h-9 rounded-2xl bg-slate-900 px-4 text-[11px] font-semibold uppercase tracking-wide text-white hover:bg-slate-800 disabled:opacity-50",disabled:g,children:g?"Saving":"Save vitals"})]})]})]}):a.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 px-3 py-4 text-center text-xs text-slate-500",children:["No patient selected.",a.jsxs("div",{className:"mt-1 text-[11px] text-slate-400",children:["Click ",a.jsx("span",{className:"font-medium",children:"Record vitals"})," on any patient in the queue to begin."]})]})})]})})]})]})})}function IDe(){const{id:t}=Su(),n=Number(t),[r,s]=b.useState(!0),[i,o]=b.useState(!1),[l,c]=b.useState(null),[d,u]=b.useState({chief_complaint:"",symptoms:"",soap_subjective:"",soap_objective:"",soap_assessment:"",plan:""}),[h,m]=b.useState(""),[g,y]=b.useState(""),[N,j]=b.useState(!1),S=async()=>{try{s(!0);const{data:P}=await ace(n);c(P),u({chief_complaint:P.chief_complaint||"",symptoms:P.symptoms||"",soap_subjective:P.soap_subjective||"",soap_objective:P.soap_objective||"",soap_assessment:P.soap_assessment||"",plan:P.plan||""})}catch{c(null)}finally{s(!1)}};b.useEffect(()=>{n&&S()},[n]);const _=(P,M)=>u(O=>({...O,[P]:M})),A=async()=>{try{o(!0),await ice(n,d),fe.success("Visit updated"),await S()}catch{}finally{o(!1)}},k=P=>{if(!P)return"";const M=new Date(P);return Number.isNaN(M.getTime())?P:M.toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})},T=async()=>{if(!h){fe.error("Select follow-up date");return}try{j(!0),await lce(n,{due_date:h,note:g||void 0}),fe.success("Follow-up created"),m(""),y(""),await S()}catch{}finally{j(!1)}};return n?r?a.jsx("div",{className:"p-4 text-sm text-slate-500",children:"Loading visit"}):l?a.jsxs("div",{className:"space-y-4 p-4",children:[a.jsx("h1",{className:"text-xl font-semibold",children:"OPD Visit"}),a.jsxs("div",{className:"rounded-2xl border bg-white p-4 space-y-3 text-sm",children:[a.jsxs("div",{className:"flex flex-wrap justify-between gap-2",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"font-semibold",children:[l.patient_name," ",a.jsxs("span",{className:"text-[11px] text-slate-500",children:["(UHID ",l.uhid,")"]})]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:[l.department_name,"  Dr. ",l.doctor_name]})]}),a.jsxs("div",{className:"text-[11px] text-slate-500 text-right",children:["Episode: ",l.episode_id," ",a.jsx("br",{}),"Visit at: ",k(l.visit_at)]})]}),l.current_vitals&&a.jsxs("div",{className:"rounded-xl border bg-slate-50 px-3 py-2 text-[11px] text-slate-700",children:[a.jsx("div",{className:"font-semibold mb-1",children:"Latest vitals"}),a.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1",children:[l.current_vitals.height_cm&&a.jsxs("span",{children:["Ht: ",l.current_vitals.height_cm," cm"]}),l.current_vitals.weight_kg&&a.jsxs("span",{children:["Wt: ",l.current_vitals.weight_kg," kg"]}),l.current_vitals.temp_c&&a.jsxs("span",{children:["Temp: ",l.current_vitals.temp_c," C"]}),l.current_vitals.bp_systolic&&a.jsxs("span",{children:["BP: ",l.current_vitals.bp_systolic,"/",l.current_vitals.bp_diastolic," mmHg"]}),l.current_vitals.pulse&&a.jsxs("span",{children:["Pulse: ",l.current_vitals.pulse]}),l.current_vitals.rr&&a.jsxs("span",{children:["RR: ",l.current_vitals.rr]}),l.current_vitals.spo2&&a.jsxs("span",{children:["SpO: ",l.current_vitals.spo2,"%"]})]})]})]}),a.jsxs("div",{className:"rounded-2xl border bg-white p-4 space-y-3",children:[a.jsx("h3",{className:"font-medium text-sm",children:"Clinical notes (SOAP)"}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium",children:"Chief Complaint"}),a.jsx("textarea",{className:"input min-h-[60px]",value:d.chief_complaint,onChange:P=>_("chief_complaint",P.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium",children:"Symptoms"}),a.jsx("textarea",{className:"input min-h-[60px]",value:d.symptoms,onChange:P=>_("symptoms",P.target.value)})]})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium",children:"Subjective"}),a.jsx("textarea",{className:"input min-h-[80px]",value:d.soap_subjective,onChange:P=>_("soap_subjective",P.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium",children:"Objective"}),a.jsx("textarea",{className:"input min-h-[80px]",value:d.soap_objective,onChange:P=>_("soap_objective",P.target.value)})]})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium",children:"Assessment"}),a.jsx("textarea",{className:"input min-h-[80px]",value:d.soap_assessment,onChange:P=>_("soap_assessment",P.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium",children:"Plan"}),a.jsx("textarea",{className:"input min-h-[80px]",value:d.plan,onChange:P=>_("plan",P.target.value)})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{className:"btn",onClick:A,disabled:i,children:i?"Saving":"Save notes"})})]}),a.jsxs("div",{className:"rounded-2xl border bg-white p-4 space-y-3",children:[a.jsx("h3",{className:"font-medium text-sm",children:"Follow-up"}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-[1fr,2fr,auto] items-end",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium",children:"Follow-up date"}),a.jsx("input",{type:"date",className:"input",value:h,onChange:P=>m(P.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium",children:"Note (optional)"}),a.jsx("input",{className:"input",value:g,onChange:P=>y(P.target.value),placeholder:"Review in 2 weeks / discuss reports"})]}),a.jsx("button",{className:"btn",onClick:T,disabled:N,children:N?"Creating":"Create Follow-up"})]})]})]}):a.jsx("div",{className:"p-4 text-sm text-red-600",children:"Visit not found."}):a.jsx("div",{className:"p-4 text-sm",children:"Invalid visit ID."})}const UD=()=>new Date().toISOString().slice(0,10),PDe={waiting:"Waiting",scheduled:"Scheduled",completed:"Completed",cancelled:"Cancelled","*":"All"},MDe={waiting:"bg-amber-50 text-amber-700",scheduled:"bg-blue-50 text-blue-700",completed:"bg-emerald-50 text-emerald-700",cancelled:"bg-slate-100 text-slate-700"};function b2(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-IN",{weekday:"short",day:"2-digit",month:"short",year:"numeric"})}catch{return t}}function ODe(){const[t,n]=b.useState("waiting"),[r,s]=b.useState(null),[i,o]=b.useState(UD()),[l,c]=b.useState(UD()),[d,u]=b.useState([]),[h,m]=b.useState(!1),[g,y]=b.useState(null),[N,j]=b.useState(""),[S,_]=b.useState(""),[A,k]=b.useState(!1),[T,P]=b.useState(null),[M,O]=b.useState(""),[D,L]=b.useState(""),[$,V]=b.useState([]),[F,Q]=b.useState(!1),[U,z]=b.useState(!1),q=async()=>{try{m(!0);const xe={status:t,doctor_id:r||void 0,date_from:i||void 0,date_to:l||void 0},{data:_e}=await cce(xe);u(_e||[])}catch{u([])}finally{m(!1)}};b.useEffect(()=>{q()},[t,r,i,l]);const K=xe=>{s(xe)},X=xe=>{y(xe),j(xe.due_date),_(xe.note||"")},J=async xe=>{if(xe.preventDefault(),!!g)try{k(!0),await dce(g.id,{due_date:N,note:S||void 0}),fe.success("Follow-up updated"),y(null),await q()}catch{}finally{k(!1)}},ne=async(xe,_e)=>{if(!(xe!=null&&xe.doctor_id)||!_e){V([]);return}try{z(!0);const{data:we}=await Qle({doctorUserId:xe.doctor_id,date:_e});V(we||[])}catch{V([])}finally{z(!1)}},Se=async xe=>{P(xe);const _e=xe.due_date;O(_e),L(""),await ne(xe,_e)},de=async xe=>{const _e=xe.target.value;O(_e),T&&await ne(T,_e)},ye=async xe=>{if(xe.preventDefault(),!!T){if(!D){fe.error("Select a time slot");return}try{Q(!0),await uce(T.id,{date:M||void 0,slot_start:D}),fe.success("Follow-up scheduled"),P(null),V([]),await q()}catch{}finally{Q(!1)}}},be=b.useMemo(()=>{const xe={total:d.length,waiting:0,scheduled:0,completed:0,cancelled:0};for(const _e of d)xe[_e.status]!==void 0&&(xe[_e.status]+=1);return xe},[d]);return a.jsx("div",{className:"min-h-[calc(100vh-5rem)] bg-slate-50 px-4 py-6 md:px-6",children:a.jsxs("div",{className:"mx-auto max-w-5xl space-y-6",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:"relative flex h-2 w-2",children:[a.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-sky-500 opacity-75"}),a.jsx("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-sky-500"})]}),a.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.2em] text-sky-700",children:"Follow-up Tracker"})]}),a.jsx("h1",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"OPD Follow-ups"}),a.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"View pending follow-ups, reschedule due dates, and confirm them into real OPD appointments."})]}),a.jsxs("div",{className:"hidden text-right text-xs text-slate-500 md:block",children:[a.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1",children:[a.jsx(tl,{className:"h-3 w-3"}),a.jsx("span",{children:"Continuity of care"})]}),a.jsxs("div",{className:"mt-1 flex items-center justify-end gap-1",children:[a.jsx(sa,{className:"h-3 w-3"}),a.jsxs("span",{children:[b2(i),"  ",b2(l)]})]})]})]}),a.jsxs(Re,{className:"border-slate-200 shadow-sm rounded-3xl",children:[a.jsxs(Ye,{className:"border-b border-slate-100 pb-4",children:[a.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-end md:justify-between",children:[a.jsxs("div",{className:"grid w-full gap-3 md:grid-cols-[2fr,1.3fr,1fr,1fr] md:items-end",children:[a.jsx(Al,{value:r,onChange:K}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(oee,{className:"h-3 w-3"}),"Status"]}),a.jsxs(Nn,{value:t,onValueChange:xe=>n(xe),children:[a.jsx(gn,{className:"h-9 text-xs",children:a.jsx(jn,{placeholder:"Select status"})}),a.jsxs(yn,{children:[a.jsx(gt,{value:"waiting",children:"Waiting"}),a.jsx(gt,{value:"scheduled",children:"Scheduled"}),a.jsx(gt,{value:"completed",children:"Completed"}),a.jsx(gt,{value:"cancelled",children:"Cancelled"}),a.jsx(gt,{value:"*",children:"All"})]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(sa,{className:"h-3 w-3"}),"From"]}),a.jsx(Ne,{type:"date",className:"h-9",value:i,onChange:xe=>o(xe.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(sa,{className:"h-3 w-3"}),"To"]}),a.jsx(Ne,{type:"date",className:"h-9",value:l,onChange:xe=>c(xe.target.value)})]})]}),a.jsx("div",{className:"flex items-center gap-2 md:w-auto",children:a.jsxs(Te,{type:"button",size:"sm",variant:"outline",onClick:q,disabled:h,className:"gap-1",children:[a.jsx(ci,{className:"h-3 w-3"}),"Refresh"]})})]}),a.jsxs("div",{className:"mt-4 flex flex-wrap gap-2 text-xs",children:[a.jsxs(Ge,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-slate-50",children:[a.jsx(tl,{className:"h-3 w-3"}),a.jsx("span",{children:"Total"}),a.jsx("span",{className:"font-semibold",children:be.total})]}),a.jsxs(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-amber-50 text-amber-700",children:["Waiting: ",be.waiting]}),a.jsxs(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-blue-50 text-blue-700",children:["Scheduled: ",be.scheduled]}),a.jsxs(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-emerald-50 text-emerald-700",children:["Completed: ",be.completed]}),a.jsxs(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-slate-100 text-slate-700",children:["Cancelled: ",be.cancelled]})]})]}),a.jsx(Be,{className:"pt-4",children:h?a.jsx("div",{className:"space-y-3 py-4",children:[1,2,3].map(xe=>a.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-100 bg-slate-50/80 px-3 py-3",children:[a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx(Xe,{className:"h-4 w-52"}),a.jsx(Xe,{className:"h-3 w-64"})]}),a.jsx(Xe,{className:"h-7 w-20"})]},xe))}):d.length===0?a.jsxs("div",{className:"flex flex-col items-center gap-2 py-10 text-center text-sm text-slate-500",children:[a.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-100",children:a.jsx(Bi,{className:"h-5 w-5 text-slate-500"})}),a.jsx("div",{className:"font-medium text-slate-700",children:"No follow-ups for this filter"}),a.jsx("p",{className:"max-w-md text-xs text-slate-500",children:"Adjust status, doctor, or date range above to see past and upcoming follow-ups."})]}):a.jsx("div",{className:"space-y-2 pt-1 text-sm",children:d.map(xe=>{const _e=MDe[xe.status]||"bg-slate-100 text-slate-700";return a.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[a.jsx("span",{className:"text-xs font-semibold text-slate-900",children:b2(xe.due_date)}),a.jsx("span",{className:"mx-0.5 text-slate-400",children:""}),a.jsxs("span",{className:"flex items-center gap-1 text-sm font-medium text-slate-900",children:[a.jsx(hi,{className:"h-3.5 w-3.5 text-slate-500"}),xe.patient_name]}),a.jsx("span",{className:"mx-0.5 text-slate-400",children:""}),a.jsxs("span",{className:"text-[11px] text-slate-500",children:["UHID ",xe.patient_uhid]})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-1 text-[11px] text-slate-500",children:[a.jsxs("span",{children:["Dr. ",xe.doctor_name,"  ",xe.department_name]}),a.jsx("span",{className:"mx-1 text-slate-300",children:""}),a.jsx("span",{children:"Status:"}),a.jsx(Ge,{className:`border-none px-2 py-0.5 text-[11px] font-semibold uppercase ${_e}`,children:PDe[xe.status]||xe.status})]}),xe.note&&a.jsxs("div",{className:"text-[11px] text-slate-600",children:["Note: ",xe.note]}),xe.status==="scheduled"&&xe.appointment_id&&a.jsxs("div",{className:"text-[11px] text-emerald-700",children:["Linked to appointment # ",xe.appointment_id]})]}),a.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2 text-xs",children:xe.status==="waiting"&&a.jsxs(a.Fragment,{children:[a.jsx(Te,{size:"sm",variant:"outline",onClick:()=>X(xe),children:"Edit"}),a.jsx(Te,{size:"sm",onClick:()=>Se(xe),children:"Schedule"})]})})]},xe.id)})})})]}),g&&a.jsxs(Re,{className:"border-slate-200 shadow-sm rounded-3xl",children:[a.jsx(Ye,{className:"pb-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(Ze,{className:"text-base",children:"Edit Follow-up Date & Note"}),a.jsxs(ma,{className:"text-xs",children:[g.patient_name,"  UHID ",g.patient_uhid]})]}),a.jsx(Te,{variant:"ghost",size:"sm",className:"text-xs text-slate-500",type:"button",onClick:()=>y(null),children:"Close"})]})}),a.jsx(Be,{children:a.jsxs("form",{onSubmit:J,className:"grid gap-3 md:grid-cols-[1fr,2fr,auto] md:items-end",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(sa,{className:"h-3 w-3"}),"Due date"]}),a.jsx(Ne,{type:"date",value:N,onChange:xe=>j(xe.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(kn,{className:"h-3 w-3"}),"Note"]}),a.jsx(Ne,{value:S,onChange:xe=>_(xe.target.value),placeholder:"Short instruction for next visit"})]}),a.jsx(Te,{type:"submit",disabled:A,children:A?"Saving":"Save changes"})]})})]}),T&&a.jsxs(Re,{className:"border-slate-200 shadow-sm rounded-3xl",children:[a.jsx(Ye,{className:"pb-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(Ze,{className:"text-base",children:"Schedule Follow-up Appointment"}),a.jsxs(ma,{className:"text-xs",children:[T.patient_name,"  UHID ",T.patient_uhid,"  Dr. ",T.doctor_name]})]}),a.jsx(Te,{variant:"ghost",size:"sm",className:"text-xs text-slate-500",type:"button",onClick:()=>{P(null),V([])},children:"Close"})]})}),a.jsx(Be,{children:a.jsxs("form",{onSubmit:ye,className:"space-y-4 text-sm",children:[a.jsxs("div",{className:"grid gap-3 md:grid-cols-[1fr,2fr] md:items-start",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(sa,{className:"h-3 w-3"}),"Date"]}),a.jsx(Ne,{type:"date",value:M,onChange:de})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(ci,{className:"h-3 w-3"}),"Time slot"]}),U?a.jsx("div",{className:"text-[11px] text-slate-500",children:"Loading slots"}):$.length===0?a.jsxs("div",{className:"flex items-start gap-2 rounded-xl border border-amber-200 bg-amber-50 px-3 py-2 text-[11px] text-amber-800",children:[a.jsx(Bi,{className:"mt-[1px] h-3 w-3"}),a.jsx("span",{children:"No free slots found for this date. You can still type a custom time below."})]}):a.jsx("div",{className:"flex flex-wrap gap-2",children:$.map(xe=>a.jsx("button",{type:"button",onClick:()=>L(xe),className:["rounded-full border px-3 py-1 text-[11px] transition",D===xe?"border-slate-900 bg-slate-900 text-white":"border-slate-200 bg-slate-50 hover:bg-slate-100"].join(" "),children:xe},xe))}),a.jsx(Ne,{type:"time",className:"mt-2",value:D,onChange:xe=>L(xe.target.value)})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(Te,{type:"submit",disabled:F,children:F?"Scheduling":"Confirm schedule"})})]})})]})]})})}const DDe=()=>new Date().toISOString().slice(0,10);function VD(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-IN",{weekday:"short",day:"2-digit",month:"short",year:"numeric"})}catch{return t}}function RDe(){const[t,n]=b.useState(null),[r,s]=b.useState(DDe()),[i,o]=b.useState([]),[l,c]=b.useState(!1),[d,u]=b.useState(null),[h,m]=b.useState(""),[g,y]=b.useState(""),[N,j]=b.useState(!1),S=async()=>{try{c(!0);const P={for_date:r,doctor_id:t||void 0},{data:M}=await sce(P);o(M||[])}catch{o([])}finally{c(!1)}};b.useEffect(()=>{S()},[t,r]);const _=P=>{n(P)},A=P=>{u(P),m(P.date),y(P.slot_start)},k=async P=>{if(P.preventDefault(),!!d){if(!h||!g){fe.error("Select date and time");return}try{j(!0),await rce(d.id,{date:h,slot_start:g,create_new:!0}),fe.success("No-show rescheduled as new appointment"),u(null),await S()}catch{}finally{j(!1)}}},T=b.useMemo(()=>i.length,[i]);return a.jsx("div",{className:"min-h-[calc(100vh-5rem)] bg-slate-50 px-4 py-6 md:px-6",children:a.jsxs("div",{className:"mx-auto max-w-5xl space-y-6",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:"relative flex h-2 w-2",children:[a.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-rose-500 opacity-75"}),a.jsx("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-rose-500"})]}),a.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.2em] text-rose-700",children:"No-Show Recovery"})]}),a.jsx("h1",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"No-show Appointments"}),a.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Track patients who missed their appointment and quickly reschedule them into the OPD calendar."})]}),a.jsxs("div",{className:"hidden text-right text-xs text-slate-500 md:block",children:[a.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1",children:[a.jsx(bc,{className:"h-3 w-3"}),a.jsx("span",{children:"Improve utilisation"})]}),a.jsxs("div",{className:"mt-1 flex items-center justify-end gap-1",children:[a.jsx(sa,{className:"h-3 w-3"}),a.jsx("span",{children:VD(r)})]})]})]}),a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Ye,{className:"border-b border-slate-100 pb-4",children:[a.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-end md:justify-between",children:[a.jsxs("div",{className:"grid w-full gap-3 md:grid-cols-[2fr,1fr] md:items-end",children:[a.jsx(Al,{value:t,onChange:_}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(sa,{className:"h-3 w-3"}),"For date"]}),a.jsx(Ne,{type:"date",className:"h-9",value:r,onChange:P=>s(P.target.value)})]})]}),a.jsx("div",{className:"flex items-center gap-2 md:w-auto",children:a.jsxs(Te,{type:"button",size:"sm",variant:"outline",onClick:S,disabled:l,className:"gap-1",children:[a.jsx(ci,{className:"h-3 w-3"}),"Refresh"]})})]}),a.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2 text-xs",children:[a.jsxs(Ge,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-slate-50",children:[a.jsx(Bi,{className:"h-3 w-3 text-rose-600"}),a.jsx("span",{children:"Total no-shows"}),a.jsx("span",{className:"font-semibold",children:T})]}),a.jsx("span",{className:"text-[11px] text-slate-500",children:"Recover missed visits by creating a fresh appointment."})]})]}),a.jsx(Be,{className:"pt-4",children:l?a.jsx("div",{className:"space-y-3 py-4",children:[1,2,3].map(P=>a.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-100 bg-slate-50/80 px-3 py-3",children:[a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx(Xe,{className:"h-4 w-52"}),a.jsx(Xe,{className:"h-3 w-64"})]}),a.jsx(Xe,{className:"h-7 w-28"})]},P))}):i.length===0?a.jsxs("div",{className:"flex flex-col items-center gap-2 py-10 text-center text-sm text-slate-500",children:[a.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-100",children:a.jsx(Bi,{className:"h-5 w-5 text-slate-500"})}),a.jsx("div",{className:"font-medium text-slate-700",children:"No no-show appointments for this filter"}),a.jsx("p",{className:"max-w-md text-xs text-slate-500",children:"Change the doctor or date above to check other days."})]}):a.jsx("div",{className:"space-y-2 pt-1 text-sm",children:i.map(P=>a.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[a.jsxs("span",{className:"text-xs font-semibold text-slate-900",children:[VD(P.date),"  ",P.slot_start]}),a.jsx("span",{className:"mx-0.5 text-slate-300",children:""}),a.jsxs("span",{className:"flex items-center gap-1 text-sm font-medium text-slate-900",children:[a.jsx(hi,{className:"h-3.5 w-3.5 text-slate-500"}),P.patient_name]}),a.jsx("span",{className:"mx-0.5 text-slate-400",children:""}),a.jsxs("span",{className:"text-[11px] text-slate-500",children:["UHID ",P.uhid]})]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:[P.department_name,"  Dr. ",P.doctor_name,"  Purpose:"," ",P.purpose||"Consultation"]})]}),a.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2 text-xs",children:a.jsxs(Te,{size:"sm",className:"gap-1",onClick:()=>A(P),children:[a.jsx(bc,{className:"h-3 w-3"}),"Reschedule"]})})]},P.id))})})]}),d&&a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsx(Ye,{className:"pb-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(Ze,{className:"text-base",children:"Reschedule No-show"}),a.jsxs(ma,{className:"text-xs",children:[d.patient_name,"  UHID ",d.uhid,"  Dr."," ",d.doctor_name]})]}),a.jsx(Te,{type:"button",variant:"ghost",size:"sm",className:"text-xs text-slate-500",onClick:()=>u(null),children:"Close"})]})}),a.jsx(Be,{children:a.jsxs("form",{onSubmit:k,className:"grid gap-3 md:grid-cols-[1fr,1fr,auto] md:items-end text-sm",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(sa,{className:"h-3 w-3"}),"New date"]}),a.jsx(Ne,{type:"date",value:h,onChange:P=>m(P.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(ci,{className:"h-3 w-3"}),"New time"]}),a.jsx(Ne,{type:"time",value:g,onChange:P=>y(P.target.value)})]}),a.jsx(Te,{type:"submit",disabled:N,children:N?"Rescheduling":"Create new appointment"})]})})]})]})})}function HD(){return new Date().toISOString().slice(0,10)}function WD(t,n){const r=new Date(t);return r.setDate(r.getDate()+n),r.toISOString().slice(0,10)}function qD(t,n){if(!t||!n)return"";try{const r=new Date(t),s=new Date(n),o={day:"2-digit",month:"short",...r.getFullYear()===s.getFullYear()?{}:{year:"numeric"}},l={day:"2-digit",month:"short",year:"numeric"};return`${r.toLocaleDateString("en-IN",o)}  ${s.toLocaleDateString("en-IN",l)}`}catch{return`${t}  ${n}`}}function LDe(){const[t,n]=b.useState(""),[r,s]=b.useState(""),[i,o]=b.useState(null),[l,c]=b.useState(!1),[d,u]=b.useState(null);b.useEffect(()=>{const P=HD(),M=WD(P,-6);n(M),s(P)},[]);const h=b.useCallback(async(P={})=>{var D,L;const M=P.dateFrom||t,O=P.dateTo||r;if(!(!M||!O))try{c(!0);const{data:$}=await gce({dateFrom:M,dateTo:O,doctorId:i||void 0});u($)}catch($){console.error($),fe.error(((L=(D=$==null?void 0:$.response)==null?void 0:D.data)==null?void 0:L.detail)||"Failed to load OPD dashboard")}finally{c(!1)}},[t,r,i]);b.useEffect(()=>{t&&r&&h()},[t,r,i,h]);const m=P=>{o(P)},g=d||{},y=g.appointments||{},N=g.followups||{},j=g.doctor_stats||[],S=b.useMemo(()=>(j||[]).map(P=>({name:P.doctor_name||`#${P.doctor_id}`,total:P.total_appointments||0,completed:P.completed||0,no_show:P.no_show||0})),[j]),_=g.range||{},A=_.date_from&&_.date_to?qD(_.date_from,_.date_to):qD(t,r),k=y.total??0,T=l&&!d;return a.jsx("div",{className:"min-h-[calc(100vh-5rem)] bg-slate-50 px-4 py-6 md:px-6",children:a.jsxs("div",{className:"mx-auto max-w-6xl space-y-6",children:[a.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:"relative flex h-2 w-2",children:[a.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-emerald-500 opacity-75"}),a.jsx("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-emerald-500"})]}),a.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-emerald-700",children:"OPD Analytics"})]}),a.jsx("h1",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"OPD Dashboard"}),a.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Quick view of OPD appointments, follow-ups and doctor workload for the selected date range."})]}),a.jsxs("div",{className:"flex flex-col items-start gap-2 text-xs text-slate-500 md:items-end",children:[a.jsxs(Ge,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-white px-3 py-1",children:[a.jsx(uf,{className:"h-3 w-3"}),a.jsx("span",{children:A})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx(Ge,{variant:"outline",className:"rounded-full border-slate-200 bg-slate-50 text-[11px]",children:i?"Filtered by specific doctor":"All doctors in OPD"}),a.jsx("span",{className:"text-[11px] text-slate-400",children:l?"Refreshing":"Live clinical summary"})]})]})]}),a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Ye,{className:"border-b border-slate-100 pb-3",children:[a.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:[a.jsx(uf,{className:"h-4 w-4"}),"Date & Doctor Filters"]}),a.jsx(Te,{type:"button",variant:"outline",size:"sm",onClick:()=>{const P=HD(),M=WD(P,-6);n(M),s(P),o(null)},children:"Last 7 days"})]}),a.jsx(ma,{className:"mt-1 text-xs text-slate-500",children:"Use this view daily for clinical huddle, OPD utilisation review and doctor-wise load balancing."})]}),a.jsxs(Be,{className:"space-y-4 pt-4",children:[a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:"From date"}),a.jsx(Ne,{type:"date",value:t,onChange:P=>n(P.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:"To date"}),a.jsx(Ne,{type:"date",value:r,onChange:P=>s(P.target.value)})]}),a.jsx("div",{className:"flex items-end",children:a.jsx(Te,{type:"button",className:"w-full",variant:"outline",onClick:()=>h({dateFrom:t,dateTo:r}),disabled:l,children:l?"Refreshing":"Refresh"})})]}),a.jsx(Al,{value:i,onChange:m,label:"Filter by doctor (optional)"})]})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsx(Ye,{className:"pb-1",children:a.jsxs(Ze,{className:"flex items-center justify-between text-xs font-medium text-slate-500",children:["Total appointments",a.jsx(ha,{className:"h-4 w-4 text-slate-400"})]})}),a.jsx(Be,{children:T?a.jsxs(a.Fragment,{children:[a.jsx(Xe,{className:"mb-1 h-7 w-16"}),a.jsx(Xe,{className:"h-3 w-32"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:y.total??""}),a.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["Unique patients:"," ",a.jsx("span",{className:"font-semibold",children:y.unique_patients??""})]})]})})]}),a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsx(Ye,{className:"pb-1",children:a.jsxs(Ze,{className:"flex items-center justify-between text-xs font-medium text-slate-500",children:["Completed visits",a.jsx(Fi,{className:"h-4 w-4 text-emerald-500"})]})}),a.jsx(Be,{children:T?a.jsxs(a.Fragment,{children:[a.jsx(Xe,{className:"mb-1 h-7 w-16"}),a.jsx(Xe,{className:"h-3 w-40"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:y.completed??""}),a.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["In progress:"," ",a.jsx("span",{className:"font-semibold",children:y.in_progress??0})," "," Checked-in:"," ",a.jsx("span",{className:"font-semibold",children:y.checked_in??0})]})]})})]}),a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsx(Ye,{className:"pb-1",children:a.jsxs(Ze,{className:"flex items-center justify-between text-xs font-medium text-slate-500",children:["No-show & cancellations",a.jsx(wc,{className:"h-4 w-4 text-amber-500"})]})}),a.jsx(Be,{children:T?a.jsxs(a.Fragment,{children:[a.jsx(Xe,{className:"mb-1 h-7 w-16"}),a.jsx(Xe,{className:"h-3 w-32"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:y.no_show??""}),a.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["Cancelled:"," ",a.jsx("span",{className:"font-semibold",children:y.cancelled??0})]})]})})]}),a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsx(Ye,{className:"pb-1",children:a.jsxs(Ze,{className:"flex items-center justify-between text-xs font-medium text-slate-500",children:["Follow-ups",a.jsx(kn,{className:"h-4 w-4 text-sky-500"})]})}),a.jsx(Be,{children:T?a.jsxs(a.Fragment,{children:[a.jsx(Xe,{className:"mb-1 h-7 w-16"}),a.jsx(Xe,{className:"h-3 w-44"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:N.total??""}),a.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["Waiting:"," ",a.jsx("span",{className:"font-semibold",children:N.waiting??0})," "," Scheduled:"," ",a.jsx("span",{className:"font-semibold",children:N.scheduled??0})]})]})})]})]}),a.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm lg:col-span-2",children:[a.jsxs(Ye,{className:"pb-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs(Ze,{className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:["Doctor-wise OPD load",a.jsx(wp,{className:"h-4 w-4 text-slate-400"})]}),k>0&&a.jsxs(Ge,{className:"rounded-full bg-slate-900 text-[11px] font-normal text-white",children:["Total: ",k]})]}),a.jsx(ma,{className:"mt-1 text-xs text-slate-500",children:"Each bar represents total appointments per doctor in the chosen period."})]}),a.jsx(Be,{className:"h-72 pt-2",children:S.length===0?a.jsx("div",{className:"flex h-full items-center justify-center text-sm text-slate-500",children:l?"Loading":"No data in selected range"}):a.jsx(Pd,{width:"100%",height:"100%",children:a.jsxs(Ry,{data:S,children:[a.jsx(ex,{dataKey:"name",tick:{fontSize:11},interval:0,height:40}),a.jsx(tx,{}),a.jsx(Dd,{}),a.jsx(Jp,{dataKey:"total"})]})})})]}),a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsx(Ye,{className:"pb-2",children:a.jsxs(Ze,{className:"flex items-center justify-between text-sm font-medium text-slate-700",children:["Highlights",a.jsx(Qte,{className:"h-4 w-4 text-slate-400"})]})}),a.jsxs(Be,{className:"space-y-4 pt-1 text-xs",children:[a.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-slate-50/60 px-3 py-2",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"font-semibold text-slate-800",children:"Top by appointments"}),a.jsx(Ge,{variant:"outline",className:"rounded-full border-emerald-200 bg-emerald-50 text-[10px] text-emerald-700",children:"Volume"})]}),g.top_doctor_by_appointments?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mt-1 text-[13px] font-medium text-slate-900",children:g.top_doctor_by_appointments.doctor_name}),a.jsxs("p",{className:"mt-0.5 text-[11px] text-slate-500",children:["Dept:"," ",g.top_doctor_by_appointments.department_name||""]}),a.jsxs("p",{className:"mt-1 text-[11px] text-slate-500",children:["Total appointments:"," ",a.jsx("span",{className:"font-semibold",children:g.top_doctor_by_appointments.total_appointments}),a.jsx("br",{}),"No-show:"," ",a.jsx("span",{className:"font-semibold",children:g.top_doctor_by_appointments.no_show}),a.jsx("br",{}),"Follow-ups in range:"," ",a.jsx("span",{className:"font-semibold",children:g.top_doctor_by_appointments.followups_in_range})]})]}):a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:l?"Calculating":"No doctor data in this range."})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-white px-3 py-2",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"font-semibold text-slate-800",children:"Top by completed visits"}),a.jsx(Ge,{variant:"outline",className:"rounded-full border-sky-200 bg-sky-50 text-[10px] text-sky-700",children:"Quality"})]}),g.top_doctor_by_completed?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mt-1 text-[13px] font-medium text-slate-900",children:g.top_doctor_by_completed.doctor_name}),a.jsxs("p",{className:"mt-0.5 text-[11px] text-slate-500",children:["Dept:"," ",g.top_doctor_by_completed.department_name||""]}),a.jsxs("p",{className:"mt-1 text-[11px] text-slate-500",children:["Completed visits:"," ",a.jsx("span",{className:"font-semibold",children:g.top_doctor_by_completed.completed})]})]}):a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:l?"Calculating":"Waiting for enough completed visits."})]}),a.jsx("p",{className:"text-[10px] leading-relaxed text-slate-500",children:"Use these insights for scheduling next weeks OPD, balancing high-load doctors and monitoring no-show trends."})]})]})]}),a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Ye,{className:"pb-2",children:[a.jsxs(Ze,{className:"flex items-center justify-between text-sm font-medium text-slate-700",children:["Doctor-wise breakdown",a.jsx(wp,{className:"h-4 w-4 text-slate-400"})]}),a.jsx(ma,{className:"mt-1 text-xs text-slate-500",children:"Each row shows total load, outcomes and follow-ups for a doctor in the selected range."})]}),a.jsx(Be,{className:"overflow-x-auto pt-2",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b text-xs text-slate-500",children:[a.jsx("th",{className:"py-2 pr-2 text-left",children:"Doctor"}),a.jsx("th",{className:"py-2 px-2 text-left",children:"Department"}),a.jsx("th",{className:"py-2 px-2 text-right",children:"Total"}),a.jsx("th",{className:"py-2 px-2 text-right",children:"Completed"}),a.jsx("th",{className:"py-2 px-2 text-right",children:"No-show"}),a.jsx("th",{className:"py-2 px-2 text-right",children:"Cancelled"}),a.jsx("th",{className:"py-2 pl-2 text-right",children:"Follow-ups"})]})}),a.jsxs("tbody",{children:[j.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"py-4 text-center text-xs text-slate-500",children:l?"Loading":"No data to show"})}),j.map(P=>a.jsxs("tr",{className:"border-b last:border-0 hover:bg-slate-50/70",children:[a.jsx("td",{className:"py-2 pr-2 text-slate-800",children:P.doctor_name}),a.jsx("td",{className:"py-2 px-2 text-slate-600",children:P.department_name||""}),a.jsx("td",{className:"py-2 px-2 text-right",children:P.total_appointments}),a.jsx("td",{className:"py-2 px-2 text-right",children:P.completed}),a.jsx("td",{className:"py-2 px-2 text-right",children:P.no_show}),a.jsx("td",{className:"py-2 px-2 text-right",children:P.cancelled}),a.jsx("td",{className:"py-2 pl-2 text-right",children:P.followups_in_range})]},P.doctor_id))]})]})})]})]})})}var Yb="Dialog",[Kq]=Cu(Yb),[BDe,Xi]=Kq(Yb),Yq=t=>{const{__scopeDialog:n,children:r,open:s,defaultOpen:i,onOpenChange:o,modal:l=!0}=t,c=b.useRef(null),d=b.useRef(null),[u,h]=Tp({prop:s,defaultProp:i??!1,onChange:o,caller:Yb});return a.jsx(BDe,{scope:n,triggerRef:c,contentRef:d,contentId:Nc(),titleId:Nc(),descriptionId:Nc(),open:u,onOpenChange:h,onOpenToggle:b.useCallback(()=>h(m=>!m),[h]),modal:l,children:r})};Yq.displayName=Yb;var Xq="DialogTrigger",FDe=b.forwardRef((t,n)=>{const{__scopeDialog:r,...s}=t,i=Xi(Xq,r),o=vn(n,i.triggerRef);return a.jsx(Ht.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":Ik(i.open),...s,ref:o,onClick:Lt(t.onClick,i.onOpenToggle)})});FDe.displayName=Xq;var kk="DialogPortal",[$De,Qq]=Kq(kk,{forceMount:void 0}),Zq=t=>{const{__scopeDialog:n,forceMount:r,children:s,container:i}=t,o=Xi(kk,n);return a.jsx($De,{scope:n,forceMount:r,children:b.Children.map(s,l=>a.jsx(El,{present:r||o.open,children:a.jsx(RA,{asChild:!0,container:i,children:l})}))})};Zq.displayName=kk;var $y="DialogOverlay",Jq=b.forwardRef((t,n)=>{const r=Qq($y,t.__scopeDialog),{forceMount:s=r.forceMount,...i}=t,o=Xi($y,t.__scopeDialog);return o.modal?a.jsx(El,{present:s||o.open,children:a.jsx(UDe,{...i,ref:n})}):null});Jq.displayName=$y;var zDe=Yf("DialogOverlay.RemoveScroll"),UDe=b.forwardRef((t,n)=>{const{__scopeDialog:r,...s}=t,i=Xi($y,r);return a.jsx(LA,{as:zDe,allowPinchZoom:!0,shards:[i.contentRef],children:a.jsx(Ht.div,{"data-state":Ik(i.open),...s,ref:n,style:{pointerEvents:"auto",...s.style}})})}),wu="DialogContent",eG=b.forwardRef((t,n)=>{const r=Qq(wu,t.__scopeDialog),{forceMount:s=r.forceMount,...i}=t,o=Xi(wu,t.__scopeDialog);return a.jsx(El,{present:s||o.open,children:o.modal?a.jsx(VDe,{...i,ref:n}):a.jsx(HDe,{...i,ref:n})})});eG.displayName=wu;var VDe=b.forwardRef((t,n)=>{const r=Xi(wu,t.__scopeDialog),s=b.useRef(null),i=vn(n,r.contentRef,s);return b.useEffect(()=>{const o=s.current;if(o)return QB(o)},[]),a.jsx(tG,{...t,ref:i,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Lt(t.onCloseAutoFocus,o=>{var l;o.preventDefault(),(l=r.triggerRef.current)==null||l.focus()}),onPointerDownOutside:Lt(t.onPointerDownOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0;(l.button===2||c)&&o.preventDefault()}),onFocusOutside:Lt(t.onFocusOutside,o=>o.preventDefault())})}),HDe=b.forwardRef((t,n)=>{const r=Xi(wu,t.__scopeDialog),s=b.useRef(!1),i=b.useRef(!1);return a.jsx(tG,{...t,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var l,c;(l=t.onCloseAutoFocus)==null||l.call(t,o),o.defaultPrevented||(s.current||(c=r.triggerRef.current)==null||c.focus(),o.preventDefault()),s.current=!1,i.current=!1},onInteractOutside:o=>{var d,u;(d=t.onInteractOutside)==null||d.call(t,o),o.defaultPrevented||(s.current=!0,o.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const l=o.target;((u=r.triggerRef.current)==null?void 0:u.contains(l))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&i.current&&o.preventDefault()}})}),tG=b.forwardRef((t,n)=>{const{__scopeDialog:r,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:o,...l}=t,c=Xi(wu,r),d=b.useRef(null),u=vn(n,d);return CB(),a.jsxs(a.Fragment,{children:[a.jsx(AA,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:i,onUnmountAutoFocus:o,children:a.jsx(_A,{role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":Ik(c.open),...l,ref:u,onDismiss:()=>c.onOpenChange(!1)})}),a.jsxs(a.Fragment,{children:[a.jsx(WDe,{titleId:c.titleId}),a.jsx(GDe,{contentRef:d,descriptionId:c.descriptionId})]})]})}),Tk="DialogTitle",nG=b.forwardRef((t,n)=>{const{__scopeDialog:r,...s}=t,i=Xi(Tk,r);return a.jsx(Ht.h2,{id:i.titleId,...s,ref:n})});nG.displayName=Tk;var rG="DialogDescription",sG=b.forwardRef((t,n)=>{const{__scopeDialog:r,...s}=t,i=Xi(rG,r);return a.jsx(Ht.p,{id:i.descriptionId,...s,ref:n})});sG.displayName=rG;var aG="DialogClose",iG=b.forwardRef((t,n)=>{const{__scopeDialog:r,...s}=t,i=Xi(aG,r);return a.jsx(Ht.button,{type:"button",...s,ref:n,onClick:Lt(t.onClick,()=>i.onOpenChange(!1))})});iG.displayName=aG;function Ik(t){return t?"open":"closed"}var oG="DialogTitleWarning",[d6e,lG]=xde(oG,{contentName:wu,titleName:Tk,docsSlug:"dialog"}),WDe=({titleId:t})=>{const n=lG(oG),r=`\`${n.contentName}\` requires a \`${n.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${n.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${n.docsSlug}`;return b.useEffect(()=>{t&&(document.getElementById(t)||console.error(r))},[r,t]),null},qDe="DialogDescriptionWarning",GDe=({contentRef:t,descriptionId:n})=>{const s=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${lG(qDe).contentName}}.`;return b.useEffect(()=>{var o;const i=(o=t.current)==null?void 0:o.getAttribute("aria-describedby");n&&i&&(document.getElementById(n)||console.warn(s))},[s,t,n]),null},cG=Yq,dG=Zq,Xb=Jq,Qb=eG,Zb=nG,Jb=sG,uG=iG;const Qu=cG,KDe=dG,fG=b.forwardRef(({className:t,...n},r)=>a.jsx(Xb,{ref:r,className:_t("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n}));fG.displayName=Xb.displayName;const vd=b.forwardRef(({className:t,children:n,...r},s)=>a.jsxs(KDe,{children:[a.jsx(fG,{}),a.jsxs(Qb,{ref:s,className:_t("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[n,a.jsxs(uG,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[a.jsx(La,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));vd.displayName=Qb.displayName;const bd=({className:t,...n})=>a.jsx("div",{className:_t("flex flex-col space-y-1.5 text-center sm:text-left",t),...n});bd.displayName="DialogHeader";const wd=({className:t,...n})=>a.jsx("div",{className:_t("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...n});wd.displayName="DialogFooter";const Nd=b.forwardRef(({className:t,...n},r)=>a.jsx(Zb,{ref:r,className:_t("text-lg font-semibold leading-none tracking-tight",t),...n}));Nd.displayName=Zb.displayName;const jd=b.forwardRef(({className:t,...n},r)=>a.jsx(Jb,{ref:r,className:_t("text-sm text-muted-foreground",t),...n}));jd.displayName=Jb.displayName;const w2=cG,YDe=dG,hG=b.forwardRef(({className:t,...n},r)=>a.jsx(Xb,{className:_t("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n,ref:r}));hG.displayName=Xb.displayName;const XDe=wv("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),$g=b.forwardRef(({side:t="right",className:n,children:r,...s},i)=>a.jsxs(YDe,{children:[a.jsx(hG,{}),a.jsxs(Qb,{ref:i,className:_t(XDe({side:t}),n),...s,children:[a.jsxs(uG,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[a.jsx(La,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Close"})]}),r]})]}));$g.displayName=Qb.displayName;const zg=({className:t,...n})=>a.jsx("div",{className:_t("flex flex-col space-y-2 text-center sm:text-left",t),...n});zg.displayName="SheetHeader";const Ug=b.forwardRef(({className:t,...n},r)=>a.jsx(Zb,{ref:r,className:_t("text-lg font-semibold text-foreground",t),...n}));Ug.displayName=Zb.displayName;const Vg=b.forwardRef(({className:t,...n},r)=>a.jsx(Jb,{ref:r,className:_t("text-sm text-muted-foreground",t),...n}));Vg.displayName=Jb.displayName;function Ci(t){if(!t)return"";try{return new Date(t).toLocaleDateString()}catch{return t}}function Ss(t){return t==null?"0":Number(t).toLocaleString(void 0,{maximumFractionDigits:2})}function QDe(){const[t,n]=b.useState("dashboard"),[r,s]=b.useState([]),[i,o]=b.useState([]),[l,c]=b.useState([]),[d,u]=b.useState(!1),[h,m]=b.useState([]),[g,y]=b.useState([]),[N,j]=b.useState([]),[S,_]=b.useState([]),[A,k]=b.useState([]),[T,P]=b.useState([]),[M,O]=b.useState(!1),[D,L]=b.useState([]),[$,V]=b.useState(!1),[F,Q]=b.useState([]),[U,z]=b.useState(!1),[q,K]=b.useState([]),[X,J]=b.useState(!1),[ne,Se]=b.useState([]),[de,ye]=b.useState(!1),[be,xe]=b.useState("ALL"),[_e,we]=b.useState(""),[Oe,ae]=b.useState("saleable"),[ie,pe]=b.useState(!1),[re,We]=b.useState(null),[Je,St]=b.useState(!1),[wt,ft]=b.useState(!1),[Ie,qe]=b.useState([]),[se,le]=b.useState({supplier_id:"",location_id:"",expected_date:"",notes:""}),[De,Nt]=b.useState({open:!1,poId:null,email:""}),[sn,Yt]=b.useState(!1),[Pt,tr]=b.useState({supplier_id:"",location_id:"",invoice_number:"",invoice_date:"",notes:""}),[In,me]=b.useState([]),[tt,Et]=b.useState(!1),[Ft,en]=b.useState({type:"TO_SUPPLIER",supplier_id:"",location_id:"",reason:""}),[Ue,an]=b.useState([]),[Kt,Xt]=b.useState(!1),[Cn,kr]=b.useState(null),[zo,Mt]=b.useState(!1),[$t,Ha]=b.useState(null);b.useEffect(()=>{ue(),Ct()},[]);function Ct(){nt(),st(),zt(),It(),Ot(),Wn()}async function ue(){try{const[G,ve]=await Promise.all([Sv(),Mce()]);s(G.data||[]),o(ve.data||[])}catch(G){console.error(G)}}async function nt(){u(!0);try{const G=await Cv({q:_e||void 0,is_active:!0});c(G.data||[])}catch(G){console.error(G)}finally{u(!1)}}async function st(){O(!0);const G=be&&be!=="ALL"?{location_id:be}:{};try{const[ve,ke,rt,Tt,he,Z]=await Promise.all([$ce(G),zce(G),Uce(G),Vce(G),Hce(G),Wce(G)]);m(ve.data||[]),y(ke.data||[]),j(rt.data||[]),_(Tt.data||[]),k(he.data||[]),P(Z.data||[])}catch(ve){console.error(ve)}finally{O(!1)}}async function zt(){V(!0);try{const G=await Gce({});L(G.data||[])}catch(G){console.error(G)}finally{V(!1)}}async function It(){z(!0);try{const G=await Zce({});Q(G.data||[])}catch(G){console.error(G)}finally{z(!1)}}async function Ot(){J(!0);try{const G=await tde({});K(G.data||[])}catch(G){console.error(G)}finally{J(!1)}}async function Wn(){ye(!0);try{const G=await rde({});Se(G.data||[])}catch(G){console.error(G)}finally{ye(!1)}}const mn=b.useMemo(()=>l.length,[l]),Tr=b.useMemo(()=>g.length,[g]),nr=b.useMemo(()=>A.length,[A]),Ir=b.useMemo(()=>N.length,[N]),Gr=b.useMemo(()=>S.length,[S]),et=b.useMemo(()=>D.filter(G=>G.status!=="COMPLETED"&&G.status!=="CANCELLED"&&G.status!=="CLOSED").length,[D]);function wi(){We(null),pe(!0)}function Qi(G){We(G),pe(!0)}const ws=async G=>{var Tt,he;G.preventDefault();const ve=G.currentTarget,ke={code:ve.code.value.trim(),name:ve.name.value.trim(),generic_name:ve.generic_name.value.trim()||null,form:ve.form.value.trim()||null,strength:ve.strength.value.trim()||null,unit:ve.unit.value.trim()||"tablet",pack_size:ve.pack_size.value||"10",manufacturer:ve.manufacturer.value.trim()||null,default_price:ve.default_price.value||null,default_mrp:ve.default_mrp.value||null,default_tax_percent:ve.default_tax_percent.value||null,reorder_level:ve.reorder_level.value||null,max_level:ve.max_level.value||null,class_name:ve.class_name.value.trim()||null,atc_code:ve.atc_code.value.trim()||null,hsn_code:ve.hsn_code.value.trim()||null,is_consumable:ve.is_consumable.checked,lasa_flag:ve.lasa_flag.checked},rt=(he=(Tt=ve.qr_number)==null?void 0:Tt.value)==null?void 0:he.trim();rt&&(ke.qr_number=rt);try{re!=null&&re.id?(await Lce(re.id,ke),fe.success("Item updated")):(await Rce(ke),fe.success("Item created")),pe(!1),ve.reset(),await Promise.all([nt(),st()])}catch(Z){console.error("Failed to save item",Z)}};function Dl(){kr(null),Xt(!0)}function Ou(G){kr(G),Xt(!0)}async function Du(G){G.preventDefault();const ve=new FormData(G.target),ke={code:ve.get("code")||"",name:ve.get("name")||"",description:ve.get("description")||"",is_active:!0};if(!ke.name){fe.error("Location name is required");return}try{Cn?(await Pce(Cn.id,ke),fe.success("Location updated")):(await Ice(ke),fe.success("Location created")),Xt(!1),kr(null),await ue(),await st()}catch(rt){console.error(rt)}}function Wa(){Ha(null),Mt(!0)}function tw(G){Ha(G),Mt(!0)}async function nw(G){G.preventDefault();const ve=new FormData(G.target),ke={code:ve.get("code")||"",name:ve.get("name")||"",contact_person:ve.get("contact_person")||"",phone:ve.get("phone")||"",email:ve.get("email")||"",gst_number:ve.get("gst_number")||"",address:ve.get("address")||"",is_active:!0};if(!ke.name){fe.error("Supplier name is required");return}try{$t?(await Dce($t.id,ke),fe.success("Supplier updated")):(await Oce(ke),fe.success("Supplier created")),Mt(!1),Ha(null),await ue(),await zt(),await It(),await Ot()}catch(rt){console.error(rt)}}async function qa(){try{const G=await Bce(),ve=new Blob([G.data],{type:"text/csv"}),ke=URL.createObjectURL(ve),rt=document.createElement("a");rt.href=ke,rt.download="pharmacy_items_sample.csv",rt.click(),URL.revokeObjectURL(ke)}catch(G){console.error(G)}}async function rs(G){var ke,rt;G.preventDefault();const ve=(rt=(ke=G.target.file)==null?void 0:ke.files)==null?void 0:rt[0];if(!ve){fe.error("Please choose a CSV file");return}try{const Tt=await Fce(ve);fe.success(`Items uploaded  created: ${Tt.data.created}, updated: ${Tt.data.updated}`),St(!1),nt(),st()}catch(Tt){console.error(Tt)}}function _n(){qe(G=>[...G,{item_id:"",ordered_qty:1,unit_cost:0,tax_percent:0,mrp:0}])}function rd(G,ve,ke){qe(rt=>rt.map((Tt,he)=>he===G?{...Tt,[ve]:ke}:Tt))}function Zi(G){qe(ve=>ve.filter((ke,rt)=>rt!==G))}async function Lh(G){if(G.preventDefault(),!se.supplier_id||!se.location_id||Ie.length===0){fe.error("Supplier, location and at least one line are required");return}const ve={supplier_id:Number(se.supplier_id),location_id:Number(se.location_id),order_date:new Date().toISOString().slice(0,10),expected_date:se.expected_date||null,notes:se.notes||"",items:Ie.filter(ke=>ke.item_id).map(ke=>({item_id:Number(ke.item_id),ordered_qty:Number(ke.ordered_qty||0),unit_cost:Number(ke.unit_cost||0),tax_percent:Number(ke.tax_percent||0),mrp:Number(ke.mrp||0)}))};if(ve.items.length===0){fe.error("Add at least one valid line");return}try{await qce(ve),fe.success("Purchase order created"),ft(!1),qe([]),le({supplier_id:"",location_id:"",expected_date:"",notes:""}),zt()}catch(ke){console.error(ke)}}async function Me(G,ve){try{await Kce(G,ve),fe.success(`PO marked as ${ve}`),zt()}catch(ke){console.error(ke)}}async function rw(G){try{const ve=await Yce(G),ke=new Blob([ve.data],{type:"application/pdf"}),rt=URL.createObjectURL(ke);window.open(rt,"_blank"),setTimeout(()=>URL.revokeObjectURL(rt),1e4)}catch(ve){console.error(ve)}}async function Ln(G){G.preventDefault();const{poId:ve,email:ke}=De;if(!ke){fe.error("Email is required");return}try{await Xce(ve,ke),fe.success("PO marked as SENT"),Nt({open:!1,poId:null,email:""}),zt()}catch(rt){console.error(rt)}}function Rl(){me(G=>[...G,{item_id:"",po_item_id:null,batch_no:"",expiry_date:"",quantity:0,free_quantity:0,unit_cost:0,tax_percent:0,mrp:0}])}function sd(G,ve,ke){me(rt=>rt.map((Tt,he)=>he===G?{...Tt,[ve]:ke}:Tt))}function tn(G){me(ve=>ve.filter((ke,rt)=>rt!==G))}async function Qt(G){if(G.preventDefault(),!Pt.supplier_id||!Pt.location_id||In.length===0){fe.error("Supplier, location and at least one line are required");return}const ve={po_id:null,supplier_id:Number(Pt.supplier_id),location_id:Number(Pt.location_id),received_date:new Date().toISOString().slice(0,10),invoice_number:Pt.invoice_number||"",invoice_date:Pt.invoice_date||null,notes:Pt.notes||"",items:In.filter(ke=>ke.item_id&&ke.batch_no).map(ke=>({item_id:Number(ke.item_id),po_item_id:ke.po_item_id?Number(ke.po_item_id):null,batch_no:ke.batch_no,expiry_date:ke.expiry_date||null,quantity:Number(ke.quantity||0),free_quantity:Number(ke.free_quantity||0),unit_cost:Number(ke.unit_cost||0),tax_percent:Number(ke.tax_percent||0),mrp:Number(ke.mrp||0)}))};if(ve.items.length===0){fe.error("Add at least one valid GRN line");return}try{await Qce(ve),fe.success("GRN created in DRAFT"),Yt(!1),me([]),tr({supplier_id:"",location_id:"",invoice_number:"",invoice_date:"",notes:""}),It(),st()}catch(ke){console.error(ke)}}async function Wt(G){try{await Jce(G),fe.success("GRN posted & stock updated"),It(),st(),zt()}catch(ve){console.error(ve)}}function Bh(){an(G=>[...G,{item_id:"",batch_id:"",batch_no:"",quantity:0,reason:""}])}function Ll(G,ve,ke){an(rt=>rt.map((Tt,he)=>he===G?{...Tt,[ve]:ke}:Tt))}function Fh(G){an(ve=>ve.filter((ke,rt)=>rt!==G))}async function fr(G){if(G.preventDefault(),!Ft.location_id||Ue.length===0){fe.error("Location and at least one line are required");return}const ve={type:Ft.type,supplier_id:Ft.supplier_id?Number(Ft.supplier_id):null,location_id:Number(Ft.location_id),return_date:new Date().toISOString().slice(0,10),reason:Ft.reason||"",items:Ue.filter(ke=>ke.item_id&&ke.quantity).map(ke=>({item_id:Number(ke.item_id),batch_id:ke.batch_id?Number(ke.batch_id):null,batch_no:ke.batch_no?ke.batch_no.trim():null,quantity:Number(ke.quantity||0),reason:ke.reason||""}))};if(ve.items.length===0){fe.error("Add at least one valid return line");return}try{await ede(ve),fe.success("Return created in DRAFT"),Et(!1),an([]),en({type:"TO_SUPPLIER",supplier_id:"",location_id:"",reason:""}),Ot(),st()}catch(ke){console.error(ke)}}function Ni(G,ve="EXPIRED"){var Tt;if(!G)return;const ke=((Tt=G.item)==null?void 0:Tt.name)||G.name||G.item_name||`Item #${G.item_id??""}`,rt=ve==="EXPIRED"?`Expired batch ${G.batch_no||""} (${ke})`:`Quarantine batch ${G.batch_no||""} (${ke})`;Et(!0),en(he=>({...he,type:ve==="EXPIRED"?"INTERNAL":he.type,location_id:G.location_id?String(G.location_id):he.location_id,reason:rt})),an([{item_id:String(G.item_id),batch_id:String(G.id),batch_no:G.batch_no||"",quantity:Number(G.current_qty??0),reason:ve==="EXPIRED"?"Expired":"Quarantine / quality issue"}])}async function sw(G){try{await nde(G),fe.success("Return posted & stock updated"),Ot(),st()}catch(ve){console.error(ve)}}const pn=r.find(G=>String(G.id)===String(be));return a.jsxs(ht.div,{className:"p-4 sm:p-6 lg:p-8 bg-slate-50 min-h-screen",initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.18},children:[a.jsxs("div",{className:"mb-6 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-semibold tracking-tight text-slate-900",children:"Pharmacy Inventory"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Batch-wise stock, purchase  GRN  returns, and full transaction audit for NABH-compliant pharmacy management."})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[a.jsxs(Nn,{value:be,onValueChange:G=>{xe(G),setTimeout(st,0)},children:[a.jsx(gn,{className:"w-48 bg-white",children:a.jsx(jn,{placeholder:"All locations","aria-label":"Location filter"})}),a.jsxs(yn,{children:[a.jsx(gt,{value:"ALL",children:"All locations"}),r.map(G=>a.jsx(gt,{value:String(G.id),children:G.code?`${G.code}  ${G.name}`:G.name},G.id))]})]}),a.jsx(Te,{variant:"outline",size:"icon",className:"rounded-full",onClick:Ct,children:a.jsx(qf,{className:"w-4 h-4"})})]})]}),a.jsxs("div",{className:"grid gap-4 mb-6 md:grid-cols-4",children:[a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Ye,{className:"pb-2 flex flex-row items-center justify-between",children:[a.jsx(Ze,{className:"text-xs font-medium text-slate-500",children:"Active items"}),a.jsx(gs,{className:"w-4 h-4 text-slate-400"})]}),a.jsxs(Be,{children:[a.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:mn}),a.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Medicines & consumables in catalogue"})]})]}),a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Ye,{className:"pb-2 flex flex-row items-center justify-between",children:[a.jsx(Ze,{className:"text-xs font-medium text-slate-500",children:"Near-expiry batches"}),a.jsx(wc,{className:"w-4 h-4 text-amber-500"})]}),a.jsxs(Be,{children:[a.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:Tr}),a.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Within alert window  Expired on shelf: ",Ir]})]})]}),a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Ye,{className:"pb-2 flex flex-row items-center justify-between",children:[a.jsx(Ze,{className:"text-xs font-medium text-slate-500",children:"Low-stock items"}),a.jsx(gte,{className:"w-4 h-4 text-sky-500"})]}),a.jsxs(Be,{children:[a.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:nr}),a.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Below reorder threshold  Quarantine: ",Gr]})]})]}),a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Ye,{className:"pb-2 flex flex-row items-center justify-between",children:[a.jsx(Ze,{className:"text-xs font-medium text-slate-500",children:"Open purchase orders"}),a.jsx(ene,{className:"w-4 h-4 text-emerald-500"})]}),a.jsxs(Be,{children:[a.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:et}),a.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Draft / sent / partially received"})]})]})]}),a.jsxs(ko,{value:t,onValueChange:n,className:"space-y-4",children:[a.jsxs(Vi,{className:"bg-slate-100 rounded-full p-1 flex flex-wrap gap-1",children:[a.jsx(on,{value:"dashboard",children:"Dashboard"}),a.jsx(on,{value:"items",children:"Items"}),a.jsx(on,{value:"locations",children:"Locations"}),a.jsx(on,{value:"suppliers",children:"Suppliers"}),a.jsx(on,{value:"stock",children:"Stock & Alerts"}),a.jsx(on,{value:"po",children:"Purchase Orders"}),a.jsx(on,{value:"grn",children:"GRN"}),a.jsx(on,{value:"returns",children:"Returns"}),a.jsx(on,{value:"txns",children:"Transactions"})]}),a.jsx(ln,{value:"dashboard",children:a.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Ye,{className:"flex flex-row items-center justify-between pb-2",children:[a.jsxs(Ze,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Expiry alerts",a.jsx(Ge,{variant:"outline",className:"text-xs",children:g.length})]}),a.jsx(wc,{className:"w-4 h-4 text-amber-500"})]}),a.jsx(Be,{className:"space-y-3 max-h-[320px] overflow-auto",children:M?a.jsxs("div",{className:"space-y-2",children:[a.jsx(Xe,{className:"h-8 w-full"}),a.jsx(Xe,{className:"h-8 w-full"}),a.jsx(Xe,{className:"h-8 w-full"})]}):g.length===0&&N.length===0?a.jsxs("p",{className:"text-sm text-slate-500",children:["No batches approaching expiry or expired on shelf for"," ",pn?pn.name:"all locations","."]}):a.jsxs(a.Fragment,{children:[N.length>0&&a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-xs font-semibold text-rose-600 uppercase tracking-wide",children:"Expired on shelf"}),a.jsx("div",{className:"space-y-1.5",children:N.map(G=>{var ve;return a.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-rose-200 bg-rose-50 px-3 py-2",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsxs("p",{className:"text-sm font-medium text-slate-900",children:[((ve=G.item)==null?void 0:ve.name)||G.name||G.item_name||`Item #${G.item_id??""}`,G.batch_no&&a.jsxs("span",{className:"text-xs text-slate-500",children:[" ","(",G.batch_no,")"]})]}),a.jsxs("p",{className:"text-xs text-slate-500",children:["Qty:"," ",Ss(G.current_qty)," "," Expired:"," ",Ci(G.expiry_date)]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(Ge,{variant:"outline",className:"text-xs border-rose-300 text-rose-700",children:["Exp:"," ",Ci(G.expiry_date)]}),a.jsx(Te,{type:"button",variant:"outline",size:"sm",className:"h-7 px-2 text-[11px]",onClick:()=>Ni(G,"EXPIRED"),children:"Create return"})]})]},`expired-${G.id}`)})})]}),g.length>0&&a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-xs font-semibold text-amber-600 uppercase tracking-wide",children:"Near expiry"}),a.jsx("div",{className:"space-y-1.5",children:g.map(G=>{var ve;return a.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-slate-200 px-3 py-2 bg-slate-50",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsxs("p",{className:"text-sm font-medium text-slate-900",children:[((ve=G.item)==null?void 0:ve.name)||G.name||G.item_name||`Item #${G.item_id??""}`,G.batch_no&&a.jsxs("span",{className:"text-xs text-slate-500",children:[" ","(",G.batch_no,")"]})]}),a.jsxs("p",{className:"text-xs text-slate-500",children:["Qty:"," ",Ss(G.current_qty)," "," Exp:"," ",Ci(G.expiry_date)]})]}),a.jsxs(Ge,{variant:"outline",className:"text-xs",children:["Exp:"," ",Ci(G.expiry_date)]})]},`near-${G.id}`)})})]})]})})]}),a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Ye,{className:"flex flex-row items-center justify-between pb-2",children:[a.jsxs(Ze,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Stock alerts",a.jsx(Ge,{variant:"outline",className:"text-xs",children:A.length+T.length})]}),a.jsx(ha,{className:"w-4 h-4 text-sky-500"})]}),a.jsx(Be,{className:"space-y-2 max-h-[320px] overflow-auto",children:M?a.jsxs("div",{className:"space-y-2",children:[a.jsx(Xe,{className:"h-8 w-full"}),a.jsx(Xe,{className:"h-8 w-full"}),a.jsx(Xe,{className:"h-8 w-full"})]}):A.length===0&&T.length===0?a.jsxs("p",{className:"text-sm text-slate-500",children:["No low / max stock issues for"," ",pn?pn.name:"all locations","."]}):a.jsxs(a.Fragment,{children:[A.map(G=>a.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-amber-200 bg-amber-50 px-3 py-2",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-slate-900",children:G.name}),a.jsxs("p",{className:"text-xs text-slate-600",children:["Qty: ",Ss(G.total_qty)," / Reorder:"," ",Ss(G.reorder_level)]})]}),a.jsx(Ge,{variant:"outline",className:"text-xs border-amber-300 text-amber-700",children:"Low stock"})]},`low-${G.item_id}-${G.location_id||"all"}`)),T.map(G=>a.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-sky-200 bg-sky-50 px-3 py-2",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-slate-900",children:G.name}),a.jsxs("p",{className:"text-xs text-slate-600",children:["Qty: ",Ss(G.total_qty)," / Max:"," ",Ss(G.max_level)]})]}),a.jsx(Ge,{variant:"outline",className:"text-xs border-sky-300 text-sky-700",children:"Over-stock"})]},`max-${G.item_id}-${G.location_id||"all"}`))]})})]})]})}),a.jsx(ln,{value:"items",children:a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Ye,{className:"flex flex-row items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs(Ze,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Pharmacy items",a.jsx(Ge,{variant:"outline",className:"text-xs",children:l.length})]}),a.jsx("p",{className:"text-xs text-slate-500",children:"Medicines & consumables master  supports manual and CSV bulk upload."})]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs(Te,{variant:"outline",size:"sm",className:"gap-1",onClick:()=>St(!0),children:[a.jsx(N1,{className:"w-3 h-3"}),"CSV upload"]}),a.jsxs(Te,{variant:"outline",size:"sm",className:"gap-1",onClick:qa,children:[a.jsx($d,{className:"w-3 h-3"}),"Sample CSV"]}),a.jsxs(Te,{size:"sm",className:"gap-1",onClick:wi,children:[a.jsx(or,{className:"w-3 h-3"}),"New item"]})]})]}),a.jsxs(Be,{className:"space-y-3",children:[a.jsx("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:a.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[a.jsx(Ne,{placeholder:"Search by name / code / generic...",className:"w-full sm:w-80 bg-white",value:_e,onChange:G=>we(G.target.value),onKeyDown:G=>{G.key==="Enter"&&nt()}}),a.jsx(Te,{variant:"outline",size:"icon",className:"rounded-full",onClick:nt,children:a.jsx(Ec,{className:"w-4 h-4"})})]})}),a.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[a.jsxs("div",{className:"grid grid-cols-[2fr,1.2fr,1fr,1fr,0.6fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[a.jsx("span",{children:"Name / code"}),a.jsx("span",{children:"Generic / form"}),a.jsx("span",{children:"Default price / MRP"}),a.jsx("span",{children:"Reorder / Max"}),a.jsx("span",{className:"text-right",children:"Actions"})]}),a.jsx("div",{className:"max-h-[420px] overflow-auto divide-y divide-slate-100",children:d?a.jsxs("div",{className:"p-3 space-y-2",children:[a.jsx(Xe,{className:"h-7 w-full"}),a.jsx(Xe,{className:"h-7 w-full"}),a.jsx(Xe,{className:"h-7 w-full"})]}):l.length===0?a.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No items found. Use New item or CSV upload to add catalogue."}):l.map(G=>a.jsxs("div",{className:"grid grid-cols-[2fr,1.2fr,1fr,1fr,0.6fr] items-center px-3 py-2 text-xs",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-slate-900",children:G.name}),a.jsxs("div",{className:"text-slate-500 flex flex-wrap items-center gap-1",children:[a.jsx("span",{children:G.code}),G.is_consumable&&a.jsx(Ge,{variant:"outline",className:"text-[10px]",children:"Consumable"}),G.lasa_flag&&a.jsx(Ge,{variant:"outline",className:"text-[10px] border-rose-300 text-rose-600",children:"LASA"})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-slate-700",children:G.generic_name||""}),a.jsxs("div",{className:"text-slate-500",children:[G.form||""," ",G.strength&&` ${G.strength}`]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"text-slate-700",children:["Price: ",Ss(G.default_price)]}),a.jsxs("div",{className:"text-slate-500",children:["MRP: ",Ss(G.default_mrp),"  Tax:"," ",Ss(G.default_tax_percent),"%"]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"text-slate-700",children:["Reorder: ",Ss(G.reorder_level)]}),a.jsxs("div",{className:"text-slate-500",children:["Max: ",Ss(G.max_level)]})]}),a.jsx("div",{className:"flex items-center justify-end gap-2",children:a.jsx(Te,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>Qi(G),children:a.jsx(zm,{className:"w-3 h-3"})})})]},G.id))})]})]})]})}),a.jsx(ln,{value:"locations",children:a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Ye,{className:"flex flex-row items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs(Ze,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Inventory locations",a.jsx(Ge,{variant:"outline",className:"text-xs",children:r.length})]}),a.jsx("p",{className:"text-xs text-slate-500",children:"Define pharmacy / store locations for stock segregation and reporting."})]}),a.jsxs(Te,{size:"sm",className:"gap-1",onClick:Dl,children:[a.jsx(or,{className:"w-3 h-3"}),"New location"]})]}),a.jsx(Be,{children:a.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[a.jsxs("div",{className:"grid grid-cols-[0.6fr,1.4fr,1fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[a.jsx("span",{children:"Code"}),a.jsx("span",{children:"Name"}),a.jsx("span",{className:"text-right",children:"Actions"})]}),a.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:r.length===0?a.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No locations defined yet. Click New location to add."}):r.map(G=>a.jsxs("div",{className:"grid grid-cols-[0.6fr,1.4fr,1fr] items-center px-3 py-2 text-xs",children:[a.jsx("div",{className:"text-slate-900 font-medium",children:G.code||""}),a.jsxs("div",{className:"text-slate-900",children:[G.name,G.description&&a.jsx("div",{className:"text-[11px] text-slate-500",children:G.description})]}),a.jsx("div",{className:"flex items-center justify-end gap-2",children:a.jsx(Te,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>Ou(G),children:a.jsx(zm,{className:"w-3 h-3"})})})]},G.id))})]})})]})}),a.jsx(ln,{value:"suppliers",children:a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Ye,{className:"flex flex-row items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs(Ze,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Suppliers",a.jsx(Ge,{variant:"outline",className:"text-xs",children:i.length})]}),a.jsx("p",{className:"text-xs text-slate-500",children:"Maintain vendor master for purchase orders, GRN, and returns."})]}),a.jsxs(Te,{size:"sm",className:"gap-1",onClick:Wa,children:[a.jsx(or,{className:"w-3 h-3"}),"New supplier"]})]}),a.jsx(Be,{children:a.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[a.jsxs("div",{className:"grid grid-cols-[0.8fr,1.4fr,1.4fr,0.8fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[a.jsx("span",{children:"Code"}),a.jsx("span",{children:"Name / contact"}),a.jsx("span",{children:"Contact details"}),a.jsx("span",{className:"text-right",children:"Actions"})]}),a.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:i.length===0?a.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No suppliers defined yet. Click New supplier to add."}):i.map(G=>a.jsxs("div",{className:"grid grid-cols-[0.8fr,1.4fr,1.4fr,0.8fr] items-center px-3 py-2 text-xs",children:[a.jsx("div",{className:"text-slate-900 font-medium",children:G.code||""}),a.jsxs("div",{className:"text-slate-900",children:[G.name,G.contact_person&&a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Contact: ",G.contact_person]})]}),a.jsxs("div",{className:"text-slate-700 text-[11px] space-y-0.5",children:[G.phone&&a.jsxs("div",{children:[" ",G.phone]}),G.email&&a.jsxs("div",{children:[" ",G.email]}),G.gst_number&&a.jsxs("div",{className:"text-slate-500",children:["GST: ",G.gst_number]})]}),a.jsx("div",{className:"flex items-center justify-end gap-2",children:a.jsx(Te,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>tw(G),children:a.jsx(zm,{className:"w-3 h-3"})})})]},G.id))})]})})]})}),a.jsx(ln,{value:"stock",children:a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Ye,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs(Ze,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Stock summary",a.jsx(Ge,{variant:"outline",className:"text-xs",children:h.length})]}),a.jsx("p",{className:"text-xs text-slate-500",children:"Location-wise quantities with low / max level indicators."})]}),a.jsx($te,{className:"w-4 h-4 text-slate-400"})]}),a.jsx(Be,{className:"space-y-4",children:a.jsxs(ko,{value:Oe,onValueChange:ae,className:"space-y-3",children:[a.jsxs(Vi,{className:"bg-slate-100 rounded-full p-1 inline-flex gap-1",children:[a.jsx(on,{value:"saleable",children:"Saleable stock"}),a.jsx(on,{value:"quarantine",children:"Expired & quarantine"})]}),a.jsx(ln,{value:"saleable",className:"space-y-3",children:a.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[a.jsxs("div",{className:"grid grid-cols-[2fr,1.2fr,1fr,0.8fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[a.jsx("span",{children:"Item"}),a.jsx("span",{children:"Location"}),a.jsx("span",{children:"Qty"}),a.jsx("span",{children:"Status"})]}),a.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:M?a.jsxs("div",{className:"p-3 space-y-2",children:[a.jsx(Xe,{className:"h-7 w-full"}),a.jsx(Xe,{className:"h-7 w-full"}),a.jsx(Xe,{className:"h-7 w-full"})]}):h.length===0?a.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No stock summary yet."}):h.map(G=>{const ve=[];return G.is_low&&ve.push(a.jsx(Ge,{variant:"outline",className:"border-amber-300 text-amber-700 text-[10px]",children:"Low"},"low")),G.is_over&&ve.push(a.jsx(Ge,{variant:"outline",className:"border-sky-300 text-sky-700 text-[10px]",children:"Max"},"max")),ve.length||ve.push(a.jsx(Ge,{variant:"outline",className:"text-[10px]",children:"OK"},"ok")),a.jsxs("div",{className:"grid grid-cols-[2fr,1.2fr,1fr,0.8fr] items-center px-3 py-2 text-xs",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-slate-900",children:G.name}),a.jsx("p",{className:"text-slate-500",children:G.code})]}),a.jsx("div",{className:"text-slate-700",children:G.location_name||"All locations"}),a.jsx("div",{className:"text-slate-700",children:Ss(G.total_qty)}),a.jsx("div",{className:"flex gap-1 flex-wrap",children:ve})]},`${G.item_id}-${G.location_id||"all"}`)})})]})}),a.jsx(ln,{value:"quarantine",className:"space-y-3",children:a.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[a.jsxs("div",{className:"grid grid-cols-[2fr,1.2fr,1fr,1fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[a.jsx("span",{children:"Item / batch"}),a.jsx("span",{children:"Location"}),a.jsx("span",{children:"Qty / expiry"}),a.jsx("span",{className:"text-right",children:"Status / actions"})]}),a.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:M?a.jsxs("div",{className:"p-3 space-y-2",children:[a.jsx(Xe,{className:"h-7 w-full"}),a.jsx(Xe,{className:"h-7 w-full"}),a.jsx(Xe,{className:"h-7 w-full"})]}):S.length===0?a.jsxs("div",{className:"p-4 text-sm text-slate-500",children:["No quarantine / written-off / returned batches for"," ",pn?pn.name:"all locations","."]}):S.map(G=>{var rt,Tt,he;const ve=(G.status||"").toUpperCase();let ke="text-[10px]";return ve==="EXPIRED"||ve==="WRITTEN_OFF"?ke+=" border-rose-300 text-rose-700":ve==="QUARANTINE"?ke+=" border-amber-300 text-amber-700":ve==="RETURNED"&&(ke+=" border-slate-300 text-slate-600"),a.jsxs("div",{className:"grid grid-cols-[2fr,1.2fr,1fr,1fr] items-center px-3 py-2 text-xs",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-slate-900",children:((rt=G.item)==null?void 0:rt.name)||G.name||G.item_name||`Item #${G.item_id??""}`}),a.jsxs("p",{className:"text-[11px] text-slate-500",children:["Batch:"," ",G.batch_no||"","  Code:"," ",((Tt=G.item)==null?void 0:Tt.code)||""]})]}),a.jsx("div",{className:"text-slate-700",children:((he=G.location)==null?void 0:he.name)||""}),a.jsxs("div",{children:[a.jsxs("p",{className:"text-slate-700",children:["Qty:"," ",Ss(G.current_qty)]}),a.jsxs("p",{className:"text-[11px] text-slate-500",children:["Exp:"," ",Ci(G.expiry_date)||""]})]}),a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsx(Ge,{variant:"outline",className:ke,children:ve||"UNKNOWN"}),ve!=="RETURNED"&&a.jsx(Te,{type:"button",variant:"outline",size:"sm",className:"h-7 px-2 text-[11px]",onClick:()=>Ni(G,"QUARANTINE"),children:"Create return"})]})]},`q-${G.id}`)})})]})})]})})]})}),a.jsx(ln,{value:"po",children:a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Ye,{className:"flex flex-row items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs(Ze,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Purchase orders",a.jsx(Ge,{variant:"outline",className:"text-xs",children:D.length})]}),a.jsx("p",{className:"text-xs text-slate-500",children:"Create POs, print PDF, mark sent, and track status."})]}),a.jsxs(Te,{size:"sm",className:"gap-1",onClick:()=>ft(!0),children:[a.jsx(or,{className:"w-3 h-3"}),"New PO"]})]}),a.jsx(Be,{children:a.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[a.jsxs("div",{className:"grid grid-cols-[1.1fr,1.2fr,1.2fr,0.9fr,0.9fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[a.jsx("span",{children:"PO number"}),a.jsx("span",{children:"Supplier"}),a.jsx("span",{children:"Location / dates"}),a.jsx("span",{children:"Status"}),a.jsx("span",{className:"text-right",children:"Actions"})]}),a.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:$?a.jsxs("div",{className:"p-3 space-y-2",children:[a.jsx(Xe,{className:"h-7 w-full"}),a.jsx(Xe,{className:"h-7 w-full"}),a.jsx(Xe,{className:"h-7 w-full"})]}):D.length===0?a.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No purchase orders created yet."}):D.map(G=>{var ve,ke,rt,Tt;return a.jsxs("div",{className:"grid grid-cols-[1.1fr,1.2fr,1.2fr,0.9fr,0.9fr] items-center px-3 py-2 text-xs",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-slate-900",children:G.po_number}),a.jsxs("p",{className:"text-slate-500",children:["Created: ",Ci(G.order_date)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-900",children:(ve=G.supplier)==null?void 0:ve.name}),a.jsx("p",{className:"text-slate-500 text-[11px]",children:((ke=G.supplier)==null?void 0:ke.phone)||((rt=G.supplier)==null?void 0:rt.email)||""})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-900",children:(Tt=G.location)==null?void 0:Tt.name}),a.jsxs("p",{className:"text-slate-500 text-[11px]",children:["Exp:"," ",G.expected_date?Ci(G.expected_date):""]})]}),a.jsx("div",{children:a.jsx(Ge,{variant:"outline",className:"text-[10px] capitalize",children:G.status.toLowerCase()})}),a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsx(Te,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>rw(G.id),children:a.jsx(Bj,{className:"w-3 h-3"})}),a.jsx(Te,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>Nt({open:!0,poId:G.id,email:G.email_sent_to||""}),children:a.jsx(vp,{className:"w-3 h-3"})}),G.status==="DRAFT"||G.status==="SENT"?a.jsxs(Nn,{defaultValue:G.status,onValueChange:he=>Me(G.id,he),children:[a.jsx(gn,{className:"h-7 w-24 text-[11px] bg-white",children:a.jsx(jn,{})}),a.jsxs(yn,{children:[a.jsx(gt,{value:"DRAFT",children:"DRAFT"}),a.jsx(gt,{value:"SENT",children:"SENT"}),a.jsx(gt,{value:"PARTIALLY_RECEIVED",children:"PARTIAL"}),a.jsx(gt,{value:"COMPLETED",children:"COMPLETED"}),a.jsx(gt,{value:"CANCELLED",children:"CANCELLED"}),a.jsx(gt,{value:"CLOSED",children:"CLOSED"})]})]}):a.jsx(Ge,{variant:"outline",className:"text-[10px] capitalize",children:G.status.toLowerCase()})]})]},G.id)})})]})})]})}),a.jsx(ln,{value:"grn",children:a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Ye,{className:"flex flex-row items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs(Ze,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Goods Receipt Notes",a.jsx(Ge,{variant:"outline",className:"text-xs",children:F.length})]}),a.jsx("p",{className:"text-xs text-slate-500",children:"Post GRNs to create batches and update stock (GRN  Stock transactions)."})]}),a.jsxs(Te,{size:"sm",className:"gap-1",onClick:()=>Yt(!0),children:[a.jsx(or,{className:"w-3 h-3"}),"New GRN"]})]}),a.jsx(Be,{children:a.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[a.jsxs("div",{className:"grid grid-cols-[1.1fr,1.2fr,1.2fr,0.9fr,0.9fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[a.jsx("span",{children:"GRN number"}),a.jsx("span",{children:"Supplier"}),a.jsx("span",{children:"Location / invoice"}),a.jsx("span",{children:"Status"}),a.jsx("span",{className:"text-right",children:"Actions"})]}),a.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:U?a.jsxs("div",{className:"p-3 space-y-2",children:[a.jsx(Xe,{className:"h-7 w-full"}),a.jsx(Xe,{className:"h-7 w-full"}),a.jsx(Xe,{className:"h-7 w-full"})]}):F.length===0?a.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No GRNs created yet."}):F.map(G=>{var ve,ke,rt,Tt;return a.jsxs("div",{className:"grid grid-cols-[1.1fr,1.2fr,1.2fr,0.9fr,0.9fr] items-center px-3 py-2 text-xs",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-slate-900",children:G.grn_number}),a.jsxs("p",{className:"text-slate-500",children:["Received: ",Ci(G.received_date)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-900",children:(ve=G.supplier)==null?void 0:ve.name}),a.jsx("p",{className:"text-slate-500 text-[11px]",children:((ke=G.supplier)==null?void 0:ke.phone)||((rt=G.supplier)==null?void 0:rt.email)||""})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-900",children:(Tt=G.location)==null?void 0:Tt.name}),a.jsxs("p",{className:"text-slate-500 text-[11px]",children:["Inv: ",G.invoice_number||""," ",G.invoice_date&&` ${Ci(G.invoice_date)}`]})]}),a.jsx("div",{children:a.jsx(Ge,{variant:"outline",className:"text-[10px] capitalize",children:G.status.toLowerCase()})}),a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsx(Te,{variant:"ghost",size:"icon",className:"h-7 w-7",children:a.jsx(tl,{className:"w-3 h-3"})}),G.status==="DRAFT"&&a.jsx(Te,{variant:"outline",size:"sm",className:"h-7 px-2 text-[11px]",onClick:()=>Wt(G.id),children:"Post GRN"})]})]},G.id)})})]})})]})}),a.jsx(ln,{value:"returns",children:a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Ye,{className:"flex flex-row items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs(Ze,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Returns",a.jsx(Ge,{variant:"outline",className:"text-xs",children:q.length})]}),a.jsx("p",{className:"text-xs text-slate-500",children:"Manage returns to suppliers, from customers, and internal adjustments."})]}),a.jsxs(Te,{size:"sm",className:"gap-1",onClick:()=>Et(!0),children:[a.jsx(or,{className:"w-3 h-3"}),"New return"]})]}),a.jsx(Be,{children:a.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[a.jsxs("div",{className:"grid grid-cols-[1.1fr,1.2fr,1.2fr,0.9fr,0.9fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[a.jsx("span",{children:"Return no."}),a.jsx("span",{children:"Type / supplier"}),a.jsx("span",{children:"Location / reason"}),a.jsx("span",{children:"Status"}),a.jsx("span",{className:"text-right",children:"Actions"})]}),a.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:X?a.jsxs("div",{className:"p-3 space-y-2",children:[a.jsx(Xe,{className:"h-7 w-full"}),a.jsx(Xe,{className:"h-7 w-full"}),a.jsx(Xe,{className:"h-7 w-full"})]}):q.length===0?a.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No returns recorded yet."}):q.map(G=>{var ve,ke;return a.jsxs("div",{className:"grid grid-cols-[1.1fr,1.2fr,1.2fr,0.9fr,0.9fr] items-center px-3 py-2 text-xs",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-slate-900",children:G.return_number}),a.jsxs("p",{className:"text-slate-500",children:["Date: ",Ci(G.return_date)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-900",children:G.type.replace("_"," ")}),a.jsx("p",{className:"text-slate-500 text-[11px]",children:((ve=G.supplier)==null?void 0:ve.name)||""})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-900",children:(ke=G.location)==null?void 0:ke.name}),a.jsx("p",{className:"text-slate-500 text-[11px]",children:G.reason||""})]}),a.jsx("div",{children:a.jsx(Ge,{variant:"outline",className:"text-[10px] capitalize",children:G.status.toLowerCase()})}),a.jsx("div",{className:"flex items-center justify-end gap-2",children:G.status==="DRAFT"&&a.jsx(Te,{variant:"outline",size:"sm",className:"h-7 px-2 text-[11px]",onClick:()=>sw(G.id),children:"Post return"})})]},G.id)})})]})})]})}),a.jsx(ln,{value:"txns",children:a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsx(Ye,{className:"flex flex-row items-center justify-between",children:a.jsxs("div",{children:[a.jsxs(Ze,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Stock transactions",a.jsx(Ge,{variant:"outline",className:"text-xs",children:ne.length})]}),a.jsx("p",{className:"text-xs text-slate-500",children:"Full audit trail of every stock movement (GRN, dispense, returns, adjustments)."})]})}),a.jsx(Be,{children:a.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[a.jsxs("div",{className:"grid grid-cols-[1.1fr,1.4fr,1fr,1.1fr,0.9fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[a.jsx("span",{children:"Date / type"}),a.jsx("span",{children:"Item / batch"}),a.jsx("span",{children:"Location"}),a.jsx("span",{children:"Qty / cost"}),a.jsx("span",{children:"User / ref"})]}),a.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:de?a.jsxs("div",{className:"p-3 space-y-2",children:[a.jsx(Xe,{className:"h-7 w-full"}),a.jsx(Xe,{className:"h-7 w-full"}),a.jsx(Xe,{className:"h-7 w-full"})]}):ne.length===0?a.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No stock transactions yet."}):ne.map(G=>a.jsxs("div",{className:"grid grid-cols-[1.1fr,1.4fr,1fr,1.1fr,0.9fr] items-center px-3 py-2 text-xs",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-slate-900",children:Ci(G.txn_time)}),a.jsxs("p",{className:"text-slate-500",children:[G.txn_type," ",G.ref_display?` ${G.ref_display}`:G.ref_type&&G.ref_id?` ${G.ref_type} #${G.ref_id}`:""]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-900",children:G.item_name||`Item #${G.item_id}`}),a.jsxs("p",{className:"text-slate-500 text-[11px]",children:[G.item_code&&a.jsxs("span",{children:["Code: ",G.item_code,"  "]}),"Batch:"," ",G.batch_no?G.batch_no:G.batch_id?`#${G.batch_id}`:""]})]}),a.jsx("div",{className:"text-slate-700",children:G.location_name||(G.location_id?`Location #${G.location_id}`:"")}),a.jsxs("div",{children:[a.jsxs("p",{className:"text-slate-900",children:["Qty: ",Ss(G.quantity_change)]}),a.jsxs("p",{className:"text-slate-500 text-[11px]",children:["Rate: ",Ss(G.unit_cost),"  MRP: ",Ss(G.mrp)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-900 text-[11px]",children:G.user_name||(G.user_id?`User #${G.user_id}`:"System")}),a.jsx("p",{className:"text-slate-500 text-[11px]",children:G.ref_display||(G.ref_type&&G.ref_id?`${G.ref_type} #${G.ref_id}`:"")})]})]},G.id))})]})})]})})]}),a.jsx(Qu,{open:ie,onOpenChange:pe,children:a.jsxs(vd,{className:"max-w-2xl",children:[a.jsxs(bd,{children:[a.jsx(Nd,{className:"text-base font-semibold",children:re?"Edit item":"New item"}),a.jsx(jd,{className:"text-xs",children:"Maintain medicine / consumable master details, including LASA flag and stock thresholds."})]}),a.jsxs("form",{onSubmit:ws,className:"space-y-4",children:[a.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"code",children:"Code"}),a.jsx(Ne,{id:"code",name:"code",defaultValue:(re==null?void 0:re.code)||"",required:!0})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"qr_number",children:"Barcode number (scan code)"}),a.jsx(Ne,{id:"qr_number",name:"qr_number",placeholder:"Leave blank to auto-generate",defaultValue:(re==null?void 0:re.qr_number)||""}),a.jsx("p",{className:"text-[11px] text-slate-400 mt-0.5",children:"Optional. Empty =system will create MD_XXXX."})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"name",children:"Name (brand)"}),a.jsx(Ne,{id:"name",name:"name",defaultValue:(re==null?void 0:re.name)||"",required:!0})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"generic_name",children:"Generic name"}),a.jsx(Ne,{id:"generic_name",name:"generic_name",defaultValue:(re==null?void 0:re.generic_name)||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"form",children:"Form"}),a.jsx(Ne,{id:"form",name:"form",placeholder:"tablet / capsule / syrup...",defaultValue:(re==null?void 0:re.form)||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"strength",children:"Strength"}),a.jsx(Ne,{id:"strength",name:"strength",placeholder:"500 mg / 5 mg/ml",defaultValue:(re==null?void 0:re.strength)||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"unit",children:"Unit"}),a.jsx(Ne,{id:"unit",name:"unit",placeholder:"tablet / ml / vial",defaultValue:(re==null?void 0:re.unit)||"tablet"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"pack_size",children:"Pack size"}),a.jsx(Ne,{id:"pack_size",name:"pack_size",defaultValue:(re==null?void 0:re.pack_size)||"10"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"manufacturer",children:"Manufacturer"}),a.jsx(Ne,{id:"manufacturer",name:"manufacturer",defaultValue:(re==null?void 0:re.manufacturer)||""})]})]}),a.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"default_price",children:"Default price"}),a.jsx(Ne,{id:"default_price",name:"default_price",type:"number",step:"0.01",defaultValue:(re==null?void 0:re.default_price)||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"default_mrp",children:"Default MRP"}),a.jsx(Ne,{id:"default_mrp",name:"default_mrp",type:"number",step:"0.01",defaultValue:(re==null?void 0:re.default_mrp)||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"default_tax_percent",children:"Tax %"}),a.jsx(Ne,{id:"default_tax_percent",name:"default_tax_percent",type:"number",step:"0.01",defaultValue:(re==null?void 0:re.default_tax_percent)||""})]})]}),a.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"reorder_level",children:"Reorder level"}),a.jsx(Ne,{id:"reorder_level",name:"reorder_level",type:"number",step:"0.01",defaultValue:(re==null?void 0:re.reorder_level)||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"max_level",children:"Max level"}),a.jsx(Ne,{id:"max_level",name:"max_level",type:"number",step:"0.01",defaultValue:(re==null?void 0:re.max_level)||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"class_name",children:"Therapeutic class"}),a.jsx(Ne,{id:"class_name",name:"class_name",defaultValue:(re==null?void 0:re.class_name)||""})]})]}),a.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"atc_code",children:"ATC code"}),a.jsx(Ne,{id:"atc_code",name:"atc_code",defaultValue:(re==null?void 0:re.atc_code)||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"hsn_code",children:"HSN code"}),a.jsx(Ne,{id:"hsn_code",name:"hsn_code",defaultValue:(re==null?void 0:re.hsn_code)||""})]}),a.jsxs("div",{className:"flex items-center gap-4 mt-6 text-xs",children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",name:"is_consumable",defaultChecked:re==null?void 0:re.is_consumable,className:"rounded border-slate-300"}),"Consumable"]}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",name:"lasa_flag",defaultChecked:re==null?void 0:re.lasa_flag,className:"rounded border-slate-300"}),"LASA (Look-alike / Sound-alike)"]})]})]}),a.jsxs(wd,{className:"flex justify-between",children:[a.jsx(Te,{type:"button",variant:"outline",onClick:()=>pe(!1),children:"Cancel"}),a.jsx(Te,{type:"submit",children:re?"Save changes":"Create item"})]})]})]})}),a.jsx(Qu,{open:Je,onOpenChange:St,children:a.jsxs(vd,{children:[a.jsxs(bd,{children:[a.jsx(Nd,{className:"text-base font-semibold",children:"Bulk upload items (CSV)"}),a.jsx(jd,{className:"text-xs",children:"Download the sample template, fill with medicines / consumables, then upload here. Existing codes will be updated."})]}),a.jsxs("form",{onSubmit:rs,className:"space-y-4",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"file",children:"CSV file"}),a.jsx(Ne,{id:"file",name:"file",type:"file",accept:".csv",required:!0,className:"bg-white"})]}),a.jsxs(wd,{className:"flex justify-between",children:[a.jsx(Te,{type:"button",variant:"outline",onClick:()=>St(!1),children:"Cancel"}),a.jsxs(Te,{type:"submit",className:"gap-1",children:[a.jsx(N1,{className:"w-3 h-3"}),"Upload CSV"]})]})]})]})}),a.jsx(Qu,{open:Kt,onOpenChange:Xt,children:a.jsxs(vd,{className:"max-w-md",children:[a.jsxs(bd,{children:[a.jsx(Nd,{className:"text-base font-semibold",children:Cn?"Edit location":"New location"}),a.jsx(jd,{className:"text-xs",children:"Define pharmacy / store location used for stock and GRN posting."})]}),a.jsxs("form",{onSubmit:Du,className:"space-y-4",children:[a.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"loc_code",children:"Code"}),a.jsx(Ne,{id:"loc_code",name:"code",defaultValue:(Cn==null?void 0:Cn.code)||"",placeholder:"PHARM1 / MAIN"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"loc_name",children:"Name"}),a.jsx(Ne,{id:"loc_name",name:"name",required:!0,defaultValue:(Cn==null?void 0:Cn.name)||"",placeholder:"Main Pharmacy"})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"loc_desc",children:"Description"}),a.jsx(Ne,{id:"loc_desc",name:"description",defaultValue:(Cn==null?void 0:Cn.description)||"",placeholder:"Optional description"})]}),a.jsxs(wd,{className:"flex justify-between",children:[a.jsx(Te,{type:"button",variant:"outline",onClick:()=>Xt(!1),children:"Cancel"}),a.jsx(Te,{type:"submit",children:Cn?"Save changes":"Create location"})]})]})]})}),a.jsx(Qu,{open:zo,onOpenChange:Mt,children:a.jsxs(vd,{className:"max-w-xl",children:[a.jsxs(bd,{children:[a.jsx(Nd,{className:"text-base font-semibold",children:$t?"Edit supplier":"New supplier"}),a.jsx(jd,{className:"text-xs",children:"Vendor details used for purchase orders, GRNs, and returns."})]}),a.jsxs("form",{onSubmit:nw,className:"space-y-4",children:[a.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"sup_code",children:"Code"}),a.jsx(Ne,{id:"sup_code",name:"code",defaultValue:($t==null?void 0:$t.code)||"",placeholder:"SUPP001"})]}),a.jsxs("div",{className:"space-y-1.5 sm:col-span-2",children:[a.jsx(Ke,{htmlFor:"sup_name",children:"Name"}),a.jsx(Ne,{id:"sup_name",name:"name",required:!0,defaultValue:($t==null?void 0:$t.name)||"",placeholder:"ABC Pharma Distributors"})]})]}),a.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"sup_contact_person",children:"Contact person"}),a.jsx(Ne,{id:"sup_contact_person",name:"contact_person",defaultValue:($t==null?void 0:$t.contact_person)||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"sup_phone",children:"Phone"}),a.jsx(Ne,{id:"sup_phone",name:"phone",defaultValue:($t==null?void 0:$t.phone)||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"sup_email",children:"Email"}),a.jsx(Ne,{id:"sup_email",type:"email",name:"email",defaultValue:($t==null?void 0:$t.email)||""})]})]}),a.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"sup_gst",children:"GST number"}),a.jsx(Ne,{id:"sup_gst",name:"gst_number",defaultValue:($t==null?void 0:$t.gst_number)||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{htmlFor:"sup_address",children:"Address"}),a.jsx(Ne,{id:"sup_address",name:"address",defaultValue:($t==null?void 0:$t.address)||"",placeholder:"City / area / address"})]})]}),a.jsxs(wd,{className:"flex justify-between",children:[a.jsx(Te,{type:"button",variant:"outline",onClick:()=>Mt(!1),children:"Cancel"}),a.jsx(Te,{type:"submit",children:$t?"Save changes":"Create supplier"})]})]})]})}),a.jsx(w2,{open:wt,onOpenChange:ft,children:a.jsxs($g,{className:"w-full sm:max-w-xl overflow-y-auto",children:[a.jsxs(zg,{className:"mb-4",children:[a.jsx(Ug,{className:"text-base font-semibold",children:"New Purchase Order"}),a.jsx(Vg,{className:"text-xs",children:"Select supplier & location, then add items with quantities and pricing."})]}),a.jsxs("form",{onSubmit:Lh,className:"space-y-4 pb-6",children:[a.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{children:"Supplier"}),a.jsxs(Nn,{value:se.supplier_id,onValueChange:G=>le(ve=>({...ve,supplier_id:G})),children:[a.jsx(gn,{className:"bg-white",children:a.jsx(jn,{placeholder:"Select supplier"})}),a.jsx(yn,{children:i.map(G=>a.jsx(gt,{value:String(G.id),children:G.name},G.id))})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{children:"Location"}),a.jsxs(Nn,{value:se.location_id,onValueChange:G=>le(ve=>({...ve,location_id:G})),children:[a.jsx(gn,{className:"bg-white",children:a.jsx(jn,{placeholder:"Select location"})}),a.jsx(yn,{children:r.map(G=>a.jsx(gt,{value:String(G.id),children:G.name},G.id))})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{children:"Expected date"}),a.jsx(Ne,{type:"date",value:se.expected_date,onChange:G=>le(ve=>({...ve,expected_date:G.target.value}))})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{children:"Notes"}),a.jsx(Ne,{placeholder:"Any special instructions",value:se.notes,onChange:G=>le(ve=>({...ve,notes:G.target.value}))})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Ke,{children:"Line items"}),a.jsxs(Te,{type:"button",size:"sm",variant:"outline",className:"gap-1",onClick:_n,children:[a.jsx(or,{className:"w-3 h-3"}),"Add line"]})]}),Ie.length===0?a.jsx("p",{className:"text-xs text-slate-500",children:"No lines yet. Click Add line to start."}):a.jsx("div",{className:"space-y-2 max-h-[260px] overflow-auto pr-1",children:Ie.map((G,ve)=>a.jsxs("div",{className:"grid gap-2 rounded-xl border border-slate-200 p-2 sm:grid-cols-[1.6fr,0.8fr,0.8fr,0.8fr,0.4fr]",children:[a.jsxs(Nn,{value:G.item_id?String(G.item_id):"",onValueChange:ke=>rd(ve,"item_id",ke),children:[a.jsx(gn,{className:"bg-white h-8",children:a.jsx(jn,{placeholder:"Item"})}),a.jsx(yn,{children:l.map(ke=>a.jsx(gt,{value:String(ke.id),children:ke.name},ke.id))})]}),a.jsx(Ne,{type:"number",min:"0",step:"0.01",className:"h-8",placeholder:"Qty",value:G.ordered_qty,onChange:ke=>rd(ve,"ordered_qty",ke.target.value)}),a.jsx(Ne,{type:"number",min:"0",step:"0.01",className:"h-8",placeholder:"Rate",value:G.unit_cost,onChange:ke=>rd(ve,"unit_cost",ke.target.value)}),a.jsx(Ne,{type:"number",min:"0",step:"0.01",className:"h-8",placeholder:"Tax %",value:G.tax_percent,onChange:ke=>rd(ve,"tax_percent",ke.target.value)}),a.jsx(Te,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>Zi(ve),children:""})]},ve))})]}),a.jsxs("div",{className:"flex justify-between pt-2",children:[a.jsx(Te,{type:"button",variant:"outline",onClick:()=>ft(!1),children:"Cancel"}),a.jsx(Te,{type:"submit",children:"Create PO"})]})]})]})}),a.jsx(Qu,{open:De.open,onOpenChange:G=>Nt(ve=>({...ve,open:G})),children:a.jsxs(vd,{children:[a.jsxs(bd,{children:[a.jsx(Nd,{className:"text-base font-semibold",children:"Mark PO as sent"}),a.jsx(jd,{className:"text-xs",children:"Enter supplier email used to send PO PDF. This will be stored in PO history."})]}),a.jsxs("form",{onSubmit:Ln,className:"space-y-4",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{children:"Email"}),a.jsx(Ne,{type:"email",value:De.email,onChange:G=>Nt(ve=>({...ve,email:G.target.value})),required:!0})]}),a.jsxs(wd,{className:"flex justify-between",children:[a.jsx(Te,{type:"button",variant:"outline",onClick:()=>Nt({open:!1,poId:null,email:""}),children:"Cancel"}),a.jsxs(Te,{type:"submit",className:"gap-1",children:[a.jsx(vp,{className:"w-3 h-3"}),"Mark as sent"]})]})]})]})}),a.jsx(w2,{open:sn,onOpenChange:Yt,children:a.jsxs($g,{className:"w-full sm:max-w-xl overflow-y-auto",children:[a.jsxs(zg,{className:"mb-4",children:[a.jsx(Ug,{className:"text-base font-semibold",children:"New GRN (DRAFT)"}),a.jsx(Vg,{className:"text-xs",children:"Capture invoice details, batch numbers, and quantities. Post later to update stock."})]}),a.jsxs("form",{onSubmit:Qt,className:"space-y-4 pb-6",children:[a.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{children:"Supplier"}),a.jsxs(Nn,{value:Pt.supplier_id,onValueChange:G=>tr(ve=>({...ve,supplier_id:G})),children:[a.jsx(gn,{className:"bg-white",children:a.jsx(jn,{placeholder:"Select supplier"})}),a.jsx(yn,{children:i.map(G=>a.jsx(gt,{value:String(G.id),children:G.name},G.id))})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{children:"Location"}),a.jsxs(Nn,{value:Pt.location_id,onValueChange:G=>tr(ve=>({...ve,location_id:G})),children:[a.jsx(gn,{className:"bg-white",children:a.jsx(jn,{placeholder:"Select location"})}),a.jsx(yn,{children:r.map(G=>a.jsx(gt,{value:String(G.id),children:G.name},G.id))})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{children:"Invoice number"}),a.jsx(Ne,{value:Pt.invoice_number,onChange:G=>tr(ve=>({...ve,invoice_number:G.target.value}))})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{children:"Invoice date"}),a.jsx(Ne,{type:"date",value:Pt.invoice_date,onChange:G=>tr(ve=>({...ve,invoice_date:G.target.value}))})]}),a.jsxs("div",{className:"sm:col-span-2 space-y-1.5",children:[a.jsx(Ke,{children:"Notes"}),a.jsx(Ne,{value:Pt.notes,onChange:G=>tr(ve=>({...ve,notes:G.target.value}))})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Ke,{children:"Line items"}),a.jsxs(Te,{type:"button",size:"sm",variant:"outline",className:"gap-1",onClick:Rl,children:[a.jsx(or,{className:"w-3 h-3"}),"Add line"]})]}),In.length===0?a.jsx("p",{className:"text-xs text-slate-500",children:"No lines yet. Click Add line to add received batches."}):a.jsx("div",{className:"space-y-2 max-h-[260px] overflow-auto pr-1",children:In.map((G,ve)=>a.jsxs("div",{className:"grid gap-2 rounded-xl border border-slate-200 p-2 sm:grid-cols-[1.6fr,1fr,0.8fr,0.8fr,0.8fr,0.4fr]",children:[a.jsxs(Nn,{value:G.item_id?String(G.item_id):"",onValueChange:ke=>sd(ve,"item_id",ke),children:[a.jsx(gn,{className:"bg-white h-8",children:a.jsx(jn,{placeholder:"Item"})}),a.jsx(yn,{children:l.map(ke=>a.jsx(gt,{value:String(ke.id),children:ke.name},ke.id))})]}),a.jsx(Ne,{className:"h-8",placeholder:"Batch no.",value:G.batch_no,onChange:ke=>sd(ve,"batch_no",ke.target.value)}),a.jsx(Ne,{type:"date",className:"h-8",value:G.expiry_date,onChange:ke=>sd(ve,"expiry_date",ke.target.value)}),a.jsx(Ne,{type:"number",min:"0",step:"0.01",className:"h-8",placeholder:"Qty",value:G.quantity,onChange:ke=>sd(ve,"quantity",ke.target.value)}),a.jsx(Ne,{type:"number",min:"0",step:"0.01",className:"h-8",placeholder:"Rate",value:G.unit_cost,onChange:ke=>sd(ve,"unit_cost",ke.target.value)}),a.jsx(Te,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>tn(ve),children:""})]},ve))})]}),a.jsxs("div",{className:"flex justify-between pt-2",children:[a.jsx(Te,{type:"button",variant:"outline",onClick:()=>Yt(!1),children:"Cancel"}),a.jsx(Te,{type:"submit",children:"Create GRN (DRAFT)"})]})]})]})}),a.jsx(w2,{open:tt,onOpenChange:Et,children:a.jsxs($g,{className:"w-full sm:max-w-xl overflow-y-auto",children:[a.jsxs(zg,{className:"mb-4",children:[a.jsx(Ug,{className:"text-base font-semibold",children:"New Return (DRAFT)"}),a.jsx(Vg,{className:"text-xs",children:"Choose return type (to supplier / from customer / internal), and specify items & quantities."})]}),a.jsxs("form",{onSubmit:fr,className:"space-y-4 pb-6",children:[a.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{children:"Return type"}),a.jsxs(Nn,{value:Ft.type,onValueChange:G=>en(ve=>({...ve,type:G})),children:[a.jsx(gn,{className:"bg-white",children:a.jsx(jn,{})}),a.jsxs(yn,{children:[a.jsx(gt,{value:"TO_SUPPLIER",children:"To Supplier"}),a.jsx(gt,{value:"FROM_CUSTOMER",children:"From Customer"}),a.jsx(gt,{value:"INTERNAL",children:"Internal"})]})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{children:"Location"}),a.jsxs(Nn,{value:Ft.location_id,onValueChange:G=>en(ve=>({...ve,location_id:G})),children:[a.jsx(gn,{className:"bg-white",children:a.jsx(jn,{placeholder:"Select location"})}),a.jsx(yn,{children:r.map(G=>a.jsx(gt,{value:String(G.id),children:G.name},G.id))})]})]}),Ft.type==="TO_SUPPLIER"&&a.jsxs("div",{className:"space-y-1.5 sm:col-span-2",children:[a.jsx(Ke,{children:"Supplier (for return)"}),a.jsxs(Nn,{value:Ft.supplier_id,onValueChange:G=>en(ve=>({...ve,supplier_id:G})),children:[a.jsx(gn,{className:"bg-white",children:a.jsx(jn,{placeholder:"Select supplier"})}),a.jsx(yn,{children:i.map(G=>a.jsx(gt,{value:String(G.id),children:G.name},G.id))})]})]}),a.jsxs("div",{className:"space-y-1.5 sm:col-span-2",children:[a.jsx(Ke,{children:"Reason"}),a.jsx(Ne,{value:Ft.reason,onChange:G=>en(ve=>({...ve,reason:G.target.value}))})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Ke,{children:"Line items"}),a.jsxs(Te,{type:"button",size:"sm",variant:"outline",className:"gap-1",onClick:Bh,children:[a.jsx(or,{className:"w-3 h-3"}),"Add line"]})]}),Ue.length===0?a.jsx("p",{className:"text-xs text-slate-500",children:"No lines yet. Click Add line or use Create return from Expired / Quarantine batches."}):a.jsx("div",{className:"space-y-2 max-h-[260px] overflow-auto pr-1",children:Ue.map((G,ve)=>a.jsxs("div",{className:"grid gap-2 rounded-xl border border-slate-200 p-2 sm:grid-cols-[1.6fr,1fr,0.8fr,0.8fr,0.4fr]",children:[a.jsxs(Nn,{value:G.item_id?String(G.item_id):"",onValueChange:ke=>Ll(ve,"item_id",ke),children:[a.jsx(gn,{className:"bg-white h-8",children:a.jsx(jn,{placeholder:"Item"})}),a.jsx(yn,{children:l.map(ke=>a.jsx(gt,{value:String(ke.id),children:ke.name},ke.id))})]}),a.jsx(Ne,{className:"h-8",placeholder:"Batch no.",value:G.batch_no||"",onChange:ke=>Ll(ve,"batch_no",ke.target.value)}),a.jsx(Ne,{type:"number",min:"0",step:"0.01",className:"h-8",placeholder:"Qty",value:G.quantity,onChange:ke=>Ll(ve,"quantity",ke.target.value)}),a.jsx(Ne,{className:"h-8",placeholder:"Reason",value:G.reason,onChange:ke=>Ll(ve,"reason",ke.target.value)}),a.jsx(Te,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>Fh(ve),children:""})]},ve))})]}),a.jsxs("div",{className:"flex justify-between pt-2",children:[a.jsx(Te,{type:"button",variant:"outline",onClick:()=>Et(!1),children:"Cancel"}),a.jsx(Te,{type:"submit",children:"Create Return (DRAFT)"})]})]})]})})]})}var at;(function(t){t[t.QR_CODE=0]="QR_CODE",t[t.AZTEC=1]="AZTEC",t[t.CODABAR=2]="CODABAR",t[t.CODE_39=3]="CODE_39",t[t.CODE_93=4]="CODE_93",t[t.CODE_128=5]="CODE_128",t[t.DATA_MATRIX=6]="DATA_MATRIX",t[t.MAXICODE=7]="MAXICODE",t[t.ITF=8]="ITF",t[t.EAN_13=9]="EAN_13",t[t.EAN_8=10]="EAN_8",t[t.PDF_417=11]="PDF_417",t[t.RSS_14=12]="RSS_14",t[t.RSS_EXPANDED=13]="RSS_EXPANDED",t[t.UPC_A=14]="UPC_A",t[t.UPC_E=15]="UPC_E",t[t.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(at||(at={}));var GD=new Map([[at.QR_CODE,"QR_CODE"],[at.AZTEC,"AZTEC"],[at.CODABAR,"CODABAR"],[at.CODE_39,"CODE_39"],[at.CODE_93,"CODE_93"],[at.CODE_128,"CODE_128"],[at.DATA_MATRIX,"DATA_MATRIX"],[at.MAXICODE,"MAXICODE"],[at.ITF,"ITF"],[at.EAN_13,"EAN_13"],[at.EAN_8,"EAN_8"],[at.PDF_417,"PDF_417"],[at.RSS_14,"RSS_14"],[at.RSS_EXPANDED,"RSS_EXPANDED"],[at.UPC_A,"UPC_A"],[at.UPC_E,"UPC_E"],[at.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),KD;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.URL=1]="URL"})(KD||(KD={}));function ZDe(t){return Object.values(at).includes(t)}var Fc;(function(t){t[t.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",t[t.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Fc||(Fc={}));var Ti=function(){function t(){}return t.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",t.SCAN_DEFAULT_FPS=2,t.DEFAULT_DISABLE_FLIP=!1,t.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,t.DEFAULT_SUPPORTED_SCAN_TYPE=[Fc.SCAN_TYPE_CAMERA,Fc.SCAN_TYPE_FILE],t}(),mG=function(){function t(n,r){this.format=n,this.formatName=r}return t.prototype.toString=function(){return this.formatName},t.create=function(n){if(!GD.has(n))throw"".concat(n," not in html5QrcodeSupportedFormatsTextMap");return new t(n,GD.get(n))},t}(),YD=function(){function t(){}return t.createFromText=function(n){var r={text:n};return{decodedText:n,result:r}},t.createFromQrcodeResult=function(n){return{decodedText:n.text,result:n}},t}(),FC;(function(t){t[t.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",t[t.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",t[t.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(FC||(FC={}));var pG=function(){function t(){}return t.createFrom=function(n){return{errorMessage:n,type:FC.UNKWOWN_ERROR}},t}(),xG=function(){function t(n){this.verbose=n}return t.prototype.log=function(n){this.verbose&&console.log(n)},t.prototype.warn=function(n){this.verbose&&console.warn(n)},t.prototype.logError=function(n,r){(this.verbose||r===!0)&&console.error(n)},t.prototype.logErrors=function(n){if(n.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(n)},t}();function co(t){return typeof t>"u"||t===null}function JDe(t,n,r){return t>r?r:t<n?n:t}var wf=function(){function t(){}return t.codeParseError=function(n){return"QR code parse error, error = ".concat(n)},t.errorGettingUserMedia=function(n){return"Error getting userMedia, error = ".concat(n)},t.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},t.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},t.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},t.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},t.scannerPaused=function(){return"Scanner paused"},t}(),dn=function(){function t(){}return t.scanningStatus=function(){return"Scanning"},t.idleStatus=function(){return"Idle"},t.errorStatus=function(){return"Error"},t.permissionStatus=function(){return"Permission"},t.noCameraFoundErrorStatus=function(){return"No Cameras"},t.lastMatch=function(n){return"Last Match: ".concat(n)},t.codeScannerTitle=function(){return"Code Scanner"},t.cameraPermissionTitle=function(){return"Request Camera Permissions"},t.cameraPermissionRequesting=function(){return"Requesting camera permissions..."},t.noCameraFound=function(){return"No camera found"},t.scanButtonStopScanningText=function(){return"Stop Scanning"},t.scanButtonStartScanningText=function(){return"Start Scanning"},t.torchOnButton=function(){return"Switch On Torch"},t.torchOffButton=function(){return"Switch Off Torch"},t.torchOnFailedMessage=function(){return"Failed to turn on torch"},t.torchOffFailedMessage=function(){return"Failed to turn off torch"},t.scanButtonScanningStarting=function(){return"Launching Camera..."},t.textIfCameraScanSelected=function(){return"Scan an Image File"},t.textIfFileScanSelected=function(){return"Scan using camera directly"},t.selectCamera=function(){return"Select Camera"},t.fileSelectionChooseImage=function(){return"Choose Image"},t.fileSelectionChooseAnother=function(){return"Choose Another"},t.fileSelectionNoImageSelected=function(){return"No image choosen"},t.anonymousCameraPrefix=function(){return"Anonymous Camera"},t.dragAndDropMessage=function(){return"Or drop an image to scan"},t.dragAndDropMessageOnlyImages=function(){return"Or drop an image to scan (other files not supported)"},t.zoom=function(){return"zoom"},t.loadingImage=function(){return"Loading image..."},t.cameraScanAltText=function(){return"Camera based scan"},t.fileScanAltText=function(){return"Fule based scan"},t}(),XD=function(){function t(){}return t.poweredBy=function(){return"Powered by "},t.reportIssues=function(){return"Report issues"},t}(),gG=function(){function t(){}return t.isMediaStreamConstraintsValid=function(n,r){if(typeof n!="object"){var s=typeof n;return r.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(s,"."),!0),!1}for(var i=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],o=new Set(i),l=Object.keys(n),c=0,d=l;c<d.length;c++){var u=d[c];if(o.has(u))return r.logError("".concat(u," is not supported videoConstaints."),!0),!1}return!0},t}(),$C={exports:{}};(function(t,n){(function(r,s){s(n)})(Kh,function(r){function s(H){return H==null}var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(H,f){H.__proto__=f}||function(H,f){for(var p in f)f.hasOwnProperty(p)&&(H[p]=f[p])};function o(H,f){i(H,f);function p(){this.constructor=H}H.prototype=f===null?Object.create(f):(p.prototype=f.prototype,new p)}function l(H,f){var p=Object.setPrototypeOf;p?p(H,f):H.__proto__=f}function c(H,f){f===void 0&&(f=H.constructor);var p=Error.captureStackTrace;p&&p(H,f)}var d=function(H){o(f,H);function f(p){var x=this.constructor,v=H.call(this,p)||this;return Object.defineProperty(v,"name",{value:x.name,enumerable:!1}),l(v,x.prototype),c(v),v}return f}(Error);class u extends d{constructor(f=void 0){super(f),this.message=f}getKind(){return this.constructor.kind}}u.kind="Exception";class h extends u{}h.kind="ArgumentException";class m extends u{}m.kind="IllegalArgumentException";class g{constructor(f){if(this.binarizer=f,f===null)throw new m("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(f,p){return this.binarizer.getBlackRow(f,p)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(f,p,x,v){const w=this.binarizer.getLuminanceSource().crop(f,p,x,v);return new g(this.binarizer.createBinarizer(w))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const f=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new g(this.binarizer.createBinarizer(f))}rotateCounterClockwise45(){const f=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new g(this.binarizer.createBinarizer(f))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class y extends u{static getChecksumInstance(){return new y}}y.kind="ChecksumException";class N{constructor(f){this.source=f}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class j{static arraycopy(f,p,x,v,w){for(;w--;)x[v++]=f[p++]}static currentTimeMillis(){return Date.now()}}class S extends u{}S.kind="IndexOutOfBoundsException";class _ extends S{constructor(f=void 0,p=void 0){super(p),this.index=f,this.message=p}}_.kind="ArrayIndexOutOfBoundsException";class A{static fill(f,p){for(let x=0,v=f.length;x<v;x++)f[x]=p}static fillWithin(f,p,x,v){A.rangeCheck(f.length,p,x);for(let w=p;w<x;w++)f[w]=v}static rangeCheck(f,p,x){if(p>x)throw new m("fromIndex("+p+") > toIndex("+x+")");if(p<0)throw new _(p);if(x>f)throw new _(x)}static asList(...f){return f}static create(f,p,x){return Array.from({length:f}).map(w=>Array.from({length:p}).fill(x))}static createInt32Array(f,p,x){return Array.from({length:f}).map(w=>Int32Array.from({length:p}).fill(x))}static equals(f,p){if(!f||!p||!f.length||!p.length||f.length!==p.length)return!1;for(let x=0,v=f.length;x<v;x++)if(f[x]!==p[x])return!1;return!0}static hashCode(f){if(f===null)return 0;let p=1;for(const x of f)p=31*p+x;return p}static fillUint8Array(f,p){for(let x=0;x!==f.length;x++)f[x]=p}static copyOf(f,p){return f.slice(0,p)}static copyOfUint8Array(f,p){if(f.length<=p){const x=new Uint8Array(p);return x.set(f),x}return f.slice(0,p)}static copyOfRange(f,p,x){const v=x-p,w=new Int32Array(v);return j.arraycopy(f,p,w,0,v),w}static binarySearch(f,p,x){x===void 0&&(x=A.numberComparator);let v=0,w=f.length-1;for(;v<=w;){const C=w+v>>1,E=x(p,f[C]);if(E>0)v=C+1;else if(E<0)w=C-1;else return C}return-v-1}static numberComparator(f,p){return f-p}}class k{static numberOfTrailingZeros(f){let p;if(f===0)return 32;let x=31;return p=f<<16,p!==0&&(x-=16,f=p),p=f<<8,p!==0&&(x-=8,f=p),p=f<<4,p!==0&&(x-=4,f=p),p=f<<2,p!==0&&(x-=2,f=p),x-(f<<1>>>31)}static numberOfLeadingZeros(f){if(f===0)return 32;let p=1;return f>>>16||(p+=16,f<<=16),f>>>24||(p+=8,f<<=8),f>>>28||(p+=4,f<<=4),f>>>30||(p+=2,f<<=2),p-=f>>>31,p}static toHexString(f){return f.toString(16)}static toBinaryString(f){return String(parseInt(String(f),2))}static bitCount(f){return f=f-(f>>>1&1431655765),f=(f&858993459)+(f>>>2&858993459),f=f+(f>>>4)&252645135,f=f+(f>>>8),f=f+(f>>>16),f&63}static truncDivision(f,p){return Math.trunc(f/p)}static parseInt(f,p=void 0){return parseInt(f,p)}}k.MIN_VALUE_32_BITS=-2147483648,k.MAX_VALUE=Number.MAX_SAFE_INTEGER;class T{constructor(f,p){f===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=f,p==null?this.bits=T.makeArray(f):this.bits=p)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(f){if(f>this.bits.length*32){const p=T.makeArray(f);j.arraycopy(this.bits,0,p,0,this.bits.length),this.bits=p}}get(f){return(this.bits[Math.floor(f/32)]&1<<(f&31))!==0}set(f){this.bits[Math.floor(f/32)]|=1<<(f&31)}flip(f){this.bits[Math.floor(f/32)]^=1<<(f&31)}getNextSet(f){const p=this.size;if(f>=p)return p;const x=this.bits;let v=Math.floor(f/32),w=x[v];w&=~((1<<(f&31))-1);const C=x.length;for(;w===0;){if(++v===C)return p;w=x[v]}const E=v*32+k.numberOfTrailingZeros(w);return E>p?p:E}getNextUnset(f){const p=this.size;if(f>=p)return p;const x=this.bits;let v=Math.floor(f/32),w=~x[v];w&=~((1<<(f&31))-1);const C=x.length;for(;w===0;){if(++v===C)return p;w=~x[v]}const E=v*32+k.numberOfTrailingZeros(w);return E>p?p:E}setBulk(f,p){this.bits[Math.floor(f/32)]=p}setRange(f,p){if(p<f||f<0||p>this.size)throw new m;if(p===f)return;p--;const x=Math.floor(f/32),v=Math.floor(p/32),w=this.bits;for(let C=x;C<=v;C++){const E=C>x?0:f&31,R=(2<<(C<v?31:p&31))-(1<<E);w[C]|=R}}clear(){const f=this.bits.length,p=this.bits;for(let x=0;x<f;x++)p[x]=0}isRange(f,p,x){if(p<f||f<0||p>this.size)throw new m;if(p===f)return!0;p--;const v=Math.floor(f/32),w=Math.floor(p/32),C=this.bits;for(let E=v;E<=w;E++){const I=E>v?0:f&31,B=(2<<(E<w?31:p&31))-(1<<I)&4294967295;if((C[E]&B)!==(x?B:0))return!1}return!0}appendBit(f){this.ensureCapacity(this.size+1),f&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(f,p){if(p<0||p>32)throw new m("Num bits must be between 0 and 32");this.ensureCapacity(this.size+p);for(let x=p;x>0;x--)this.appendBit((f>>x-1&1)===1)}appendBitArray(f){const p=f.size;this.ensureCapacity(this.size+p);for(let x=0;x<p;x++)this.appendBit(f.get(x))}xor(f){if(this.size!==f.size)throw new m("Sizes don't match");const p=this.bits;for(let x=0,v=p.length;x<v;x++)p[x]^=f.bits[x]}toBytes(f,p,x,v){for(let w=0;w<v;w++){let C=0;for(let E=0;E<8;E++)this.get(f)&&(C|=1<<7-E),f++;p[x+w]=C}}getBitArray(){return this.bits}reverse(){const f=new Int32Array(this.bits.length),p=Math.floor((this.size-1)/32),x=p+1,v=this.bits;for(let w=0;w<x;w++){let C=v[w];C=C>>1&1431655765|(C&1431655765)<<1,C=C>>2&858993459|(C&858993459)<<2,C=C>>4&252645135|(C&252645135)<<4,C=C>>8&16711935|(C&16711935)<<8,C=C>>16&65535|(C&65535)<<16,f[p-w]=C}if(this.size!==x*32){const w=x*32-this.size;let C=f[0]>>>w;for(let E=1;E<x;E++){const I=f[E];C|=I<<32-w,f[E-1]=C,C=I>>>w}f[x-1]=C}this.bits=f}static makeArray(f){return new Int32Array(Math.floor((f+31)/32))}equals(f){if(!(f instanceof T))return!1;const p=f;return this.size===p.size&&A.equals(this.bits,p.bits)}hashCode(){return 31*this.size+A.hashCode(this.bits)}toString(){let f="";for(let p=0,x=this.size;p<x;p++)p&7||(f+=" "),f+=this.get(p)?"X":".";return f}clone(){return new T(this.size,this.bits.slice())}}var P;(function(H){H[H.OTHER=0]="OTHER",H[H.PURE_BARCODE=1]="PURE_BARCODE",H[H.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",H[H.TRY_HARDER=3]="TRY_HARDER",H[H.CHARACTER_SET=4]="CHARACTER_SET",H[H.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",H[H.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",H[H.ASSUME_GS1=7]="ASSUME_GS1",H[H.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",H[H.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",H[H.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(P||(P={}));var M=P;class O extends u{static getFormatInstance(){return new O}}O.kind="FormatException";var D;(function(H){H[H.Cp437=0]="Cp437",H[H.ISO8859_1=1]="ISO8859_1",H[H.ISO8859_2=2]="ISO8859_2",H[H.ISO8859_3=3]="ISO8859_3",H[H.ISO8859_4=4]="ISO8859_4",H[H.ISO8859_5=5]="ISO8859_5",H[H.ISO8859_6=6]="ISO8859_6",H[H.ISO8859_7=7]="ISO8859_7",H[H.ISO8859_8=8]="ISO8859_8",H[H.ISO8859_9=9]="ISO8859_9",H[H.ISO8859_10=10]="ISO8859_10",H[H.ISO8859_11=11]="ISO8859_11",H[H.ISO8859_13=12]="ISO8859_13",H[H.ISO8859_14=13]="ISO8859_14",H[H.ISO8859_15=14]="ISO8859_15",H[H.ISO8859_16=15]="ISO8859_16",H[H.SJIS=16]="SJIS",H[H.Cp1250=17]="Cp1250",H[H.Cp1251=18]="Cp1251",H[H.Cp1252=19]="Cp1252",H[H.Cp1256=20]="Cp1256",H[H.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",H[H.UTF8=22]="UTF8",H[H.ASCII=23]="ASCII",H[H.Big5=24]="Big5",H[H.GB18030=25]="GB18030",H[H.EUC_KR=26]="EUC_KR"})(D||(D={}));class L{constructor(f,p,x,...v){this.valueIdentifier=f,this.name=x,typeof p=="number"?this.values=Int32Array.from([p]):this.values=p,this.otherEncodingNames=v,L.VALUE_IDENTIFIER_TO_ECI.set(f,this),L.NAME_TO_ECI.set(x,this);const w=this.values;for(let C=0,E=w.length;C!==E;C++){const I=w[C];L.VALUES_TO_ECI.set(I,this)}for(const C of v)L.NAME_TO_ECI.set(C,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(f){if(f<0||f>=900)throw new O("incorect value");const p=L.VALUES_TO_ECI.get(f);if(p===void 0)throw new O("incorect value");return p}static getCharacterSetECIByName(f){const p=L.NAME_TO_ECI.get(f);if(p===void 0)throw new O("incorect value");return p}equals(f){if(!(f instanceof L))return!1;const p=f;return this.getName()===p.getName()}}L.VALUE_IDENTIFIER_TO_ECI=new Map,L.VALUES_TO_ECI=new Map,L.NAME_TO_ECI=new Map,L.Cp437=new L(D.Cp437,Int32Array.from([0,2]),"Cp437"),L.ISO8859_1=new L(D.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),L.ISO8859_2=new L(D.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),L.ISO8859_3=new L(D.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),L.ISO8859_4=new L(D.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),L.ISO8859_5=new L(D.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),L.ISO8859_6=new L(D.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),L.ISO8859_7=new L(D.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),L.ISO8859_8=new L(D.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),L.ISO8859_9=new L(D.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),L.ISO8859_10=new L(D.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),L.ISO8859_11=new L(D.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),L.ISO8859_13=new L(D.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),L.ISO8859_14=new L(D.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),L.ISO8859_15=new L(D.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),L.ISO8859_16=new L(D.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),L.SJIS=new L(D.SJIS,20,"SJIS","Shift_JIS"),L.Cp1250=new L(D.Cp1250,21,"Cp1250","windows-1250"),L.Cp1251=new L(D.Cp1251,22,"Cp1251","windows-1251"),L.Cp1252=new L(D.Cp1252,23,"Cp1252","windows-1252"),L.Cp1256=new L(D.Cp1256,24,"Cp1256","windows-1256"),L.UnicodeBigUnmarked=new L(D.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),L.UTF8=new L(D.UTF8,26,"UTF8","UTF-8"),L.ASCII=new L(D.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),L.Big5=new L(D.Big5,28,"Big5"),L.GB18030=new L(D.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),L.EUC_KR=new L(D.EUC_KR,30,"EUC_KR","EUC-KR");class $ extends u{}$.kind="UnsupportedOperationException";class V{static decode(f,p){const x=this.encodingName(p);return this.customDecoder?this.customDecoder(f,x):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(x)?this.decodeFallback(f,x):new TextDecoder(x).decode(f)}static shouldDecodeOnFallback(f){return!V.isBrowser()&&f==="ISO-8859-1"}static encode(f,p){const x=this.encodingName(p);return this.customEncoder?this.customEncoder(f,x):typeof TextEncoder>"u"?this.encodeFallback(f):new TextEncoder().encode(f)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(f){return typeof f=="string"?f:f.getName()}static encodingCharacterSet(f){return f instanceof L?f:L.getCharacterSetECIByName(f)}static decodeFallback(f,p){const x=this.encodingCharacterSet(p);if(V.isDecodeFallbackSupported(x)){let v="";for(let w=0,C=f.length;w<C;w++){let E=f[w].toString(16);E.length<2&&(E="0"+E),v+="%"+E}return decodeURIComponent(v)}if(x.equals(L.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(f.buffer));throw new $(`Encoding ${this.encodingName(p)} not supported by fallback.`)}static isDecodeFallbackSupported(f){return f.equals(L.UTF8)||f.equals(L.ISO8859_1)||f.equals(L.ASCII)}static encodeFallback(f){const x=btoa(unescape(encodeURIComponent(f))).split(""),v=[];for(let w=0;w<x.length;w++)v.push(x[w].charCodeAt(0));return new Uint8Array(v)}}class F{static castAsNonUtf8Char(f,p=null){const x=p?p.getName():this.ISO88591;return V.decode(new Uint8Array([f]),x)}static guessEncoding(f,p){if(p!=null&&p.get(M.CHARACTER_SET)!==void 0)return p.get(M.CHARACTER_SET).toString();const x=f.length;let v=!0,w=!0,C=!0,E=0,I=0,R=0,B=0,W=0,Y=0,ee=0,oe=0,ce=0,ge=0,Ae=0;const $e=f.length>3&&f[0]===239&&f[1]===187&&f[2]===191;for(let Ve=0;Ve<x&&(v||w||C);Ve++){const Le=f[Ve]&255;C&&(E>0?Le&128?E--:C=!1:Le&128&&(Le&64?(E++,Le&32?(E++,Le&16?(E++,Le&8?C=!1:B++):R++):I++):C=!1)),v&&(Le>127&&Le<160?v=!1:Le>159&&(Le<192||Le===215||Le===247)&&Ae++),w&&(W>0?Le<64||Le===127||Le>252?w=!1:W--:Le===128||Le===160||Le>239?w=!1:Le>160&&Le<224?(Y++,oe=0,ee++,ee>ce&&(ce=ee)):Le>127?(W++,ee=0,oe++,oe>ge&&(ge=oe)):(ee=0,oe=0))}return C&&E>0&&(C=!1),w&&W>0&&(w=!1),C&&($e||I+R+B>0)?F.UTF8:w&&(F.ASSUME_SHIFT_JIS||ce>=3||ge>=3)?F.SHIFT_JIS:v&&w?ce===2&&Y===2||Ae*10>=x?F.SHIFT_JIS:F.ISO88591:v?F.ISO88591:w?F.SHIFT_JIS:C?F.UTF8:F.PLATFORM_DEFAULT_ENCODING}static format(f,...p){let x=-1;function v(C,E,I,R,B,W){if(C==="%%")return"%";if(p[++x]===void 0)return;C=R?parseInt(R.substr(1)):void 0;let Y=B?parseInt(B.substr(1)):void 0,ee;switch(W){case"s":ee=p[x];break;case"c":ee=p[x][0];break;case"f":ee=parseFloat(p[x]).toFixed(C);break;case"p":ee=parseFloat(p[x]).toPrecision(C);break;case"e":ee=parseFloat(p[x]).toExponential(C);break;case"x":ee=parseInt(p[x]).toString(Y||16);break;case"d":ee=parseFloat(parseInt(p[x],Y||10).toPrecision(C)).toFixed(0);break}ee=typeof ee=="object"?JSON.stringify(ee):(+ee).toString(Y);let oe=parseInt(I),ce=I&&I[0]+""=="0"?"0":" ";for(;ee.length<oe;)ee=E!==void 0?ee+ce:ce+ee;return ee}let w=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return f.replace(w,v)}static getBytes(f,p){return V.encode(f,p)}static getCharCode(f,p=0){return f.charCodeAt(p)}static getCharAt(f){return String.fromCharCode(f)}}F.SHIFT_JIS=L.SJIS.getName(),F.GB2312="GB2312",F.ISO88591=L.ISO8859_1.getName(),F.EUC_JP="EUC_JP",F.UTF8=L.UTF8.getName(),F.PLATFORM_DEFAULT_ENCODING=F.UTF8,F.ASSUME_SHIFT_JIS=!1;class Q{constructor(f=""){this.value=f}enableDecoding(f){return this.encoding=f,this}append(f){return typeof f=="string"?this.value+=f.toString():this.encoding?this.value+=F.castAsNonUtf8Char(f,this.encoding):this.value+=String.fromCharCode(f),this}appendChars(f,p,x){for(let v=p;p<p+x;v++)this.append(f[v]);return this}length(){return this.value.length}charAt(f){return this.value.charAt(f)}deleteCharAt(f){this.value=this.value.substr(0,f)+this.value.substring(f+1)}setCharAt(f,p){this.value=this.value.substr(0,f)+p+this.value.substr(f+1)}substring(f,p){return this.value.substring(f,p)}setLengthToZero(){this.value=""}toString(){return this.value}insert(f,p){this.value=this.value.substr(0,f)+p+this.value.substr(f+p.length)}}class U{constructor(f,p,x,v){if(this.width=f,this.height=p,this.rowSize=x,this.bits=v,p==null&&(p=f),this.height=p,f<1||p<1)throw new m("Both dimensions must be greater than 0");x==null&&(x=Math.floor((f+31)/32)),this.rowSize=x,v==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(f){const p=f.length,x=f[0].length,v=new U(x,p);for(let w=0;w<p;w++){const C=f[w];for(let E=0;E<x;E++)C[E]&&v.set(E,w)}return v}static parseFromString(f,p,x){if(f===null)throw new m("stringRepresentation cannot be null");const v=new Array(f.length);let w=0,C=0,E=-1,I=0,R=0;for(;R<f.length;)if(f.charAt(R)===`
`||f.charAt(R)==="\r"){if(w>C){if(E===-1)E=w-C;else if(w-C!==E)throw new m("row lengths do not match");C=w,I++}R++}else if(f.substring(R,R+p.length)===p)R+=p.length,v[w]=!0,w++;else if(f.substring(R,R+x.length)===x)R+=x.length,v[w]=!1,w++;else throw new m("illegal character encountered: "+f.substring(R));if(w>C){if(E===-1)E=w-C;else if(w-C!==E)throw new m("row lengths do not match");I++}const B=new U(E,I);for(let W=0;W<w;W++)v[W]&&B.set(Math.floor(W%E),Math.floor(W/E));return B}get(f,p){const x=p*this.rowSize+Math.floor(f/32);return(this.bits[x]>>>(f&31)&1)!==0}set(f,p){const x=p*this.rowSize+Math.floor(f/32);this.bits[x]|=1<<(f&31)&4294967295}unset(f,p){const x=p*this.rowSize+Math.floor(f/32);this.bits[x]&=~(1<<(f&31)&4294967295)}flip(f,p){const x=p*this.rowSize+Math.floor(f/32);this.bits[x]^=1<<(f&31)&4294967295}xor(f){if(this.width!==f.getWidth()||this.height!==f.getHeight()||this.rowSize!==f.getRowSize())throw new m("input matrix dimensions do not match");const p=new T(Math.floor(this.width/32)+1),x=this.rowSize,v=this.bits;for(let w=0,C=this.height;w<C;w++){const E=w*x,I=f.getRow(w,p).getBitArray();for(let R=0;R<x;R++)v[E+R]^=I[R]}}clear(){const f=this.bits,p=f.length;for(let x=0;x<p;x++)f[x]=0}setRegion(f,p,x,v){if(p<0||f<0)throw new m("Left and top must be nonnegative");if(v<1||x<1)throw new m("Height and width must be at least 1");const w=f+x,C=p+v;if(C>this.height||w>this.width)throw new m("The region must fit inside the matrix");const E=this.rowSize,I=this.bits;for(let R=p;R<C;R++){const B=R*E;for(let W=f;W<w;W++)I[B+Math.floor(W/32)]|=1<<(W&31)&4294967295}}getRow(f,p){p==null||p.getSize()<this.width?p=new T(this.width):p.clear();const x=this.rowSize,v=this.bits,w=f*x;for(let C=0;C<x;C++)p.setBulk(C*32,v[w+C]);return p}setRow(f,p){j.arraycopy(p.getBitArray(),0,this.bits,f*this.rowSize,this.rowSize)}rotate180(){const f=this.getWidth(),p=this.getHeight();let x=new T(f),v=new T(f);for(let w=0,C=Math.floor((p+1)/2);w<C;w++)x=this.getRow(w,x),v=this.getRow(p-1-w,v),x.reverse(),v.reverse(),this.setRow(w,v),this.setRow(p-1-w,x)}getEnclosingRectangle(){const f=this.width,p=this.height,x=this.rowSize,v=this.bits;let w=f,C=p,E=-1,I=-1;for(let R=0;R<p;R++)for(let B=0;B<x;B++){const W=v[R*x+B];if(W!==0){if(R<C&&(C=R),R>I&&(I=R),B*32<w){let Y=0;for(;!(W<<31-Y&4294967295);)Y++;B*32+Y<w&&(w=B*32+Y)}if(B*32+31>E){let Y=31;for(;!(W>>>Y);)Y--;B*32+Y>E&&(E=B*32+Y)}}}return E<w||I<C?null:Int32Array.from([w,C,E-w+1,I-C+1])}getTopLeftOnBit(){const f=this.rowSize,p=this.bits;let x=0;for(;x<p.length&&p[x]===0;)x++;if(x===p.length)return null;const v=x/f;let w=x%f*32;const C=p[x];let E=0;for(;!(C<<31-E&4294967295);)E++;return w+=E,Int32Array.from([w,v])}getBottomRightOnBit(){const f=this.rowSize,p=this.bits;let x=p.length-1;for(;x>=0&&p[x]===0;)x--;if(x<0)return null;const v=Math.floor(x/f);let w=Math.floor(x%f)*32;const C=p[x];let E=31;for(;!(C>>>E);)E--;return w+=E,Int32Array.from([w,v])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(f){if(!(f instanceof U))return!1;const p=f;return this.width===p.width&&this.height===p.height&&this.rowSize===p.rowSize&&A.equals(this.bits,p.bits)}hashCode(){let f=this.width;return f=31*f+this.width,f=31*f+this.height,f=31*f+this.rowSize,f=31*f+A.hashCode(this.bits),f}toString(f="X ",p="  ",x=`
`){return this.buildToString(f,p,x)}buildToString(f,p,x){let v=new Q;for(let w=0,C=this.height;w<C;w++){for(let E=0,I=this.width;E<I;E++)v.append(this.get(E,w)?f:p);v.append(x)}return v.toString()}clone(){return new U(this.width,this.height,this.rowSize,this.bits.slice())}}class z extends u{static getNotFoundInstance(){return new z}}z.kind="NotFoundException";class q extends N{constructor(f){super(f),this.luminances=q.EMPTY,this.buckets=new Int32Array(q.LUMINANCE_BUCKETS)}getBlackRow(f,p){const x=this.getLuminanceSource(),v=x.getWidth();p==null||p.getSize()<v?p=new T(v):p.clear(),this.initArrays(v);const w=x.getRow(f,this.luminances),C=this.buckets;for(let I=0;I<v;I++)C[(w[I]&255)>>q.LUMINANCE_SHIFT]++;const E=q.estimateBlackPoint(C);if(v<3)for(let I=0;I<v;I++)(w[I]&255)<E&&p.set(I);else{let I=w[0]&255,R=w[1]&255;for(let B=1;B<v-1;B++){const W=w[B+1]&255;(R*4-I-W)/2<E&&p.set(B),I=R,R=W}}return p}getBlackMatrix(){const f=this.getLuminanceSource(),p=f.getWidth(),x=f.getHeight(),v=new U(p,x);this.initArrays(p);const w=this.buckets;for(let I=1;I<5;I++){const R=Math.floor(x*I/5),B=f.getRow(R,this.luminances),W=Math.floor(p*4/5);for(let Y=Math.floor(p/5);Y<W;Y++){const ee=B[Y]&255;w[ee>>q.LUMINANCE_SHIFT]++}}const C=q.estimateBlackPoint(w),E=f.getMatrix();for(let I=0;I<x;I++){const R=I*p;for(let B=0;B<p;B++)(E[R+B]&255)<C&&v.set(B,I)}return v}createBinarizer(f){return new q(f)}initArrays(f){this.luminances.length<f&&(this.luminances=new Uint8ClampedArray(f));const p=this.buckets;for(let x=0;x<q.LUMINANCE_BUCKETS;x++)p[x]=0}static estimateBlackPoint(f){const p=f.length;let x=0,v=0,w=0;for(let B=0;B<p;B++)f[B]>w&&(v=B,w=f[B]),f[B]>x&&(x=f[B]);let C=0,E=0;for(let B=0;B<p;B++){const W=B-v,Y=f[B]*W*W;Y>E&&(C=B,E=Y)}if(v>C){const B=v;v=C,C=B}if(C-v<=p/16)throw new z;let I=C-1,R=-1;for(let B=C-1;B>v;B--){const W=B-v,Y=W*W*(C-B)*(x-f[B]);Y>R&&(I=B,R=Y)}return I<<q.LUMINANCE_SHIFT}}q.LUMINANCE_BITS=5,q.LUMINANCE_SHIFT=8-q.LUMINANCE_BITS,q.LUMINANCE_BUCKETS=1<<q.LUMINANCE_BITS,q.EMPTY=Uint8ClampedArray.from([0]);class K extends q{constructor(f){super(f),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const f=this.getLuminanceSource(),p=f.getWidth(),x=f.getHeight();if(p>=K.MINIMUM_DIMENSION&&x>=K.MINIMUM_DIMENSION){const v=f.getMatrix();let w=p>>K.BLOCK_SIZE_POWER;p&K.BLOCK_SIZE_MASK&&w++;let C=x>>K.BLOCK_SIZE_POWER;x&K.BLOCK_SIZE_MASK&&C++;const E=K.calculateBlackPoints(v,w,C,p,x),I=new U(p,x);K.calculateThresholdForBlock(v,w,C,p,x,E,I),this.matrix=I}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(f){return new K(f)}static calculateThresholdForBlock(f,p,x,v,w,C,E){const I=w-K.BLOCK_SIZE,R=v-K.BLOCK_SIZE;for(let B=0;B<x;B++){let W=B<<K.BLOCK_SIZE_POWER;W>I&&(W=I);const Y=K.cap(B,2,x-3);for(let ee=0;ee<p;ee++){let oe=ee<<K.BLOCK_SIZE_POWER;oe>R&&(oe=R);const ce=K.cap(ee,2,p-3);let ge=0;for(let $e=-2;$e<=2;$e++){const Ve=C[Y+$e];ge+=Ve[ce-2]+Ve[ce-1]+Ve[ce]+Ve[ce+1]+Ve[ce+2]}const Ae=ge/25;K.thresholdBlock(f,oe,W,Ae,v,E)}}}static cap(f,p,x){return f<p?p:f>x?x:f}static thresholdBlock(f,p,x,v,w,C){for(let E=0,I=x*w+p;E<K.BLOCK_SIZE;E++,I+=w)for(let R=0;R<K.BLOCK_SIZE;R++)(f[I+R]&255)<=v&&C.set(p+R,x+E)}static calculateBlackPoints(f,p,x,v,w){const C=w-K.BLOCK_SIZE,E=v-K.BLOCK_SIZE,I=new Array(x);for(let R=0;R<x;R++){I[R]=new Int32Array(p);let B=R<<K.BLOCK_SIZE_POWER;B>C&&(B=C);for(let W=0;W<p;W++){let Y=W<<K.BLOCK_SIZE_POWER;Y>E&&(Y=E);let ee=0,oe=255,ce=0;for(let Ae=0,$e=B*v+Y;Ae<K.BLOCK_SIZE;Ae++,$e+=v){for(let Ve=0;Ve<K.BLOCK_SIZE;Ve++){const Le=f[$e+Ve]&255;ee+=Le,Le<oe&&(oe=Le),Le>ce&&(ce=Le)}if(ce-oe>K.MIN_DYNAMIC_RANGE)for(Ae++,$e+=v;Ae<K.BLOCK_SIZE;Ae++,$e+=v)for(let Ve=0;Ve<K.BLOCK_SIZE;Ve++)ee+=f[$e+Ve]&255}let ge=ee>>K.BLOCK_SIZE_POWER*2;if(ce-oe<=K.MIN_DYNAMIC_RANGE&&(ge=oe/2,R>0&&W>0)){const Ae=(I[R-1][W]+2*I[R][W-1]+I[R-1][W-1])/4;oe<Ae&&(ge=Ae)}I[R][W]=ge}}return I}}K.BLOCK_SIZE_POWER=3,K.BLOCK_SIZE=1<<K.BLOCK_SIZE_POWER,K.BLOCK_SIZE_MASK=K.BLOCK_SIZE-1,K.MINIMUM_DIMENSION=K.BLOCK_SIZE*5,K.MIN_DYNAMIC_RANGE=24;class X{constructor(f,p){this.width=f,this.height=p}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(f,p,x,v){throw new $("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new $("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new $("This luminance source does not support rotation by 45 degrees.")}toString(){const f=new Uint8ClampedArray(this.width);let p=new Q;for(let x=0;x<this.height;x++){const v=this.getRow(x,f);for(let w=0;w<this.width;w++){const C=v[w]&255;let E;C<64?E="#":C<128?E="+":C<192?E=".":E=" ",p.append(E)}p.append(`
`)}return p.toString()}}class J extends X{constructor(f){super(f.getWidth(),f.getHeight()),this.delegate=f}getRow(f,p){const x=this.delegate.getRow(f,p),v=this.getWidth();for(let w=0;w<v;w++)x[w]=255-(x[w]&255);return x}getMatrix(){const f=this.delegate.getMatrix(),p=this.getWidth()*this.getHeight(),x=new Uint8ClampedArray(p);for(let v=0;v<p;v++)x[v]=255-(f[v]&255);return x}isCropSupported(){return this.delegate.isCropSupported()}crop(f,p,x,v){return new J(this.delegate.crop(f,p,x,v))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new J(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new J(this.delegate.rotateCounterClockwise45())}}class ne extends X{constructor(f){super(f.width,f.height),this.canvas=f,this.tempCanvasElement=null,this.buffer=ne.makeBufferFromCanvasImageData(f)}static makeBufferFromCanvasImageData(f){const p=f.getContext("2d").getImageData(0,0,f.width,f.height);return ne.toGrayscaleBuffer(p.data,f.width,f.height)}static toGrayscaleBuffer(f,p,x){const v=new Uint8ClampedArray(p*x);for(let w=0,C=0,E=f.length;w<E;w+=4,C++){let I;if(f[w+3]===0)I=255;else{const B=f[w],W=f[w+1],Y=f[w+2];I=306*B+601*W+117*Y+512>>10}v[C]=I}return v}getRow(f,p){if(f<0||f>=this.getHeight())throw new m("Requested row is outside the image: "+f);const x=this.getWidth(),v=f*x;return p===null?p=this.buffer.slice(v,v+x):(p.length<x&&(p=new Uint8ClampedArray(x)),p.set(this.buffer.slice(v,v+x))),p}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(f,p,x,v){return super.crop(f,p,x,v),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const f=this.canvas.ownerDocument.createElement("canvas");f.width=this.canvas.width,f.height=this.canvas.height,this.tempCanvasElement=f}return this.tempCanvasElement}rotate(f){const p=this.getTempCanvasElement(),x=p.getContext("2d"),v=f*ne.DEGREE_TO_RADIANS,w=this.canvas.width,C=this.canvas.height,E=Math.ceil(Math.abs(Math.cos(v))*w+Math.abs(Math.sin(v))*C),I=Math.ceil(Math.abs(Math.sin(v))*w+Math.abs(Math.cos(v))*C);return p.width=E,p.height=I,x.translate(E/2,I/2),x.rotate(v),x.drawImage(this.canvas,w/-2,C/-2),this.buffer=ne.makeBufferFromCanvasImageData(p),this}invert(){return new J(this)}}ne.DEGREE_TO_RADIANS=Math.PI/180;class Se{constructor(f,p,x){this.deviceId=f,this.label=p,this.kind="videoinput",this.groupId=x||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var de=(globalThis||Kh||self||window||void 0)&&(globalThis||Kh||self||window||void 0).__awaiter||function(H,f,p,x){function v(w){return w instanceof p?w:new p(function(C){C(w)})}return new(p||(p=Promise))(function(w,C){function E(B){try{R(x.next(B))}catch(W){C(W)}}function I(B){try{R(x.throw(B))}catch(W){C(W)}}function R(B){B.done?w(B.value):v(B.value).then(E,I)}R((x=x.apply(H,f||[])).next())})};class ye{constructor(f,p=500,x){this.reader=f,this.timeBetweenScansMillis=p,this._hints=x,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(f){this._timeBetweenDecodingAttempts=f<0?0:f}set hints(f){this._hints=f||null}get hints(){return this._hints}listVideoInputDevices(){return de(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const f=yield navigator.mediaDevices.enumerateDevices(),p=[];for(const x of f){const v=x.kind==="video"?"videoinput":x.kind;if(v!=="videoinput")continue;const w=x.deviceId||x.id,C=x.label||`Video device ${p.length+1}`,E=x.groupId,I={deviceId:w,label:C,kind:v,groupId:E};p.push(I)}return p})}getVideoInputDevices(){return de(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(p=>new Se(p.deviceId,p.label))})}findDeviceById(f){return de(this,void 0,void 0,function*(){const p=yield this.listVideoInputDevices();return p?p.find(x=>x.deviceId===f):null})}decodeFromInputVideoDevice(f,p){return de(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(f,p)})}decodeOnceFromVideoDevice(f,p){return de(this,void 0,void 0,function*(){this.reset();let x;f?x={deviceId:{exact:f}}:x={facingMode:"environment"};const v={video:x};return yield this.decodeOnceFromConstraints(v,p)})}decodeOnceFromConstraints(f,p){return de(this,void 0,void 0,function*(){const x=yield navigator.mediaDevices.getUserMedia(f);return yield this.decodeOnceFromStream(x,p)})}decodeOnceFromStream(f,p){return de(this,void 0,void 0,function*(){this.reset();const x=yield this.attachStreamToVideo(f,p);return yield this.decodeOnce(x)})}decodeFromInputVideoDeviceContinuously(f,p,x){return de(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(f,p,x)})}decodeFromVideoDevice(f,p,x){return de(this,void 0,void 0,function*(){let v;f?v={deviceId:{exact:f}}:v={facingMode:"environment"};const w={video:v};return yield this.decodeFromConstraints(w,p,x)})}decodeFromConstraints(f,p,x){return de(this,void 0,void 0,function*(){const v=yield navigator.mediaDevices.getUserMedia(f);return yield this.decodeFromStream(v,p,x)})}decodeFromStream(f,p,x){return de(this,void 0,void 0,function*(){this.reset();const v=yield this.attachStreamToVideo(f,p);return yield this.decodeContinuously(v,x)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(f,p){return de(this,void 0,void 0,function*(){const x=this.prepareVideoElement(p);return this.addVideoSource(x,f),this.videoElement=x,this.stream=f,yield this.playVideoOnLoadAsync(x),x})}playVideoOnLoadAsync(f){return new Promise((p,x)=>this.playVideoOnLoad(f,()=>p()))}playVideoOnLoad(f,p){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(f),f.addEventListener("ended",this.videoEndedListener),f.addEventListener("canplay",this.videoCanPlayListener),f.addEventListener("playing",p),this.tryPlayVideo(f)}isVideoPlaying(f){return f.currentTime>0&&!f.paused&&!f.ended&&f.readyState>2}tryPlayVideo(f){return de(this,void 0,void 0,function*(){if(this.isVideoPlaying(f)){console.warn("Trying to play video that is already playing.");return}try{yield f.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(f,p){const x=document.getElementById(f);if(!x)throw new h(`element with id '${f}' not found`);if(x.nodeName.toLowerCase()!==p.toLowerCase())throw new h(`element with id '${f}' must be an ${p} element`);return x}decodeFromImage(f,p){if(!f&&!p)throw new h("either imageElement with a src set or an url must be provided");return p&&!f?this.decodeFromImageUrl(p):this.decodeFromImageElement(f)}decodeFromVideo(f,p){if(!f&&!p)throw new h("Either an element with a src set or an URL must be provided");return p&&!f?this.decodeFromVideoUrl(p):this.decodeFromVideoElement(f)}decodeFromVideoContinuously(f,p,x){if(f===void 0&&p===void 0)throw new h("Either an element with a src set or an URL must be provided");return p&&!f?this.decodeFromVideoUrlContinuously(p,x):this.decodeFromVideoElementContinuously(f,x)}decodeFromImageElement(f){if(!f)throw new h("An image element must be provided.");this.reset();const p=this.prepareImageElement(f);this.imageElement=p;let x;return this.isImageLoaded(p)?x=this.decodeOnce(p,!1,!0):x=this._decodeOnLoadImage(p),x}decodeFromVideoElement(f){const p=this._decodeFromVideoElementSetup(f);return this._decodeOnLoadVideo(p)}decodeFromVideoElementContinuously(f,p){const x=this._decodeFromVideoElementSetup(f);return this._decodeOnLoadVideoContinuously(x,p)}_decodeFromVideoElementSetup(f){if(!f)throw new h("A video element must be provided.");this.reset();const p=this.prepareVideoElement(f);return this.videoElement=p,p}decodeFromImageUrl(f){if(!f)throw new h("An URL must be provided.");this.reset();const p=this.prepareImageElement();this.imageElement=p;const x=this._decodeOnLoadImage(p);return p.src=f,x}decodeFromVideoUrl(f){if(!f)throw new h("An URL must be provided.");this.reset();const p=this.prepareVideoElement(),x=this.decodeFromVideoElement(p);return p.src=f,x}decodeFromVideoUrlContinuously(f,p){if(!f)throw new h("An URL must be provided.");this.reset();const x=this.prepareVideoElement(),v=this.decodeFromVideoElementContinuously(x,p);return x.src=f,v}_decodeOnLoadImage(f){return new Promise((p,x)=>{this.imageLoadedListener=()=>this.decodeOnce(f,!1,!0).then(p,x),f.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(f){return de(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(f),yield this.decodeOnce(f)})}_decodeOnLoadVideoContinuously(f,p){return de(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(f),this.decodeContinuously(f,p)})}isImageLoaded(f){return!(!f.complete||f.naturalWidth===0)}prepareImageElement(f){let p;return typeof f>"u"&&(p=document.createElement("img"),p.width=200,p.height=200),typeof f=="string"&&(p=this.getMediaElement(f,"img")),f instanceof HTMLImageElement&&(p=f),p}prepareVideoElement(f){let p;return!f&&typeof document<"u"&&(p=document.createElement("video"),p.width=200,p.height=200),typeof f=="string"&&(p=this.getMediaElement(f,"video")),f instanceof HTMLVideoElement&&(p=f),p.setAttribute("autoplay","true"),p.setAttribute("muted","true"),p.setAttribute("playsinline","true"),p}decodeOnce(f,p=!0,x=!0){this._stopAsyncDecode=!1;const v=(w,C)=>{if(this._stopAsyncDecode){C(new z("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const E=this.decode(f);w(E)}catch(E){const I=p&&E instanceof z,B=(E instanceof y||E instanceof O)&&x;if(I||B)return setTimeout(v,this._timeBetweenDecodingAttempts,w,C);C(E)}};return new Promise((w,C)=>v(w,C))}decodeContinuously(f,p){this._stopContinuousDecode=!1;const x=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const v=this.decode(f);p(v,null),setTimeout(x,this.timeBetweenScansMillis)}catch(v){p(null,v);const w=v instanceof y||v instanceof O,C=v instanceof z;(w||C)&&setTimeout(x,this._timeBetweenDecodingAttempts)}};x()}decode(f){const p=this.createBinaryBitmap(f);return this.decodeBitmap(p)}_isHTMLVideoElement(f){return f.videoWidth!==0}drawFrameOnCanvas(f,p,x){p||(p={sx:0,sy:0,sWidth:f.videoWidth,sHeight:f.videoHeight,dx:0,dy:0,dWidth:f.videoWidth,dHeight:f.videoHeight}),x||(x=this.captureCanvasContext),x.drawImage(f,p.sx,p.sy,p.sWidth,p.sHeight,p.dx,p.dy,p.dWidth,p.dHeight)}drawImageOnCanvas(f,p,x=this.captureCanvasContext){p||(p={sx:0,sy:0,sWidth:f.naturalWidth,sHeight:f.naturalHeight,dx:0,dy:0,dWidth:f.naturalWidth,dHeight:f.naturalHeight}),x||(x=this.captureCanvasContext),x.drawImage(f,p.sx,p.sy,p.sWidth,p.sHeight,p.dx,p.dy,p.dWidth,p.dHeight)}createBinaryBitmap(f){this.getCaptureCanvasContext(f),this._isHTMLVideoElement(f)?this.drawFrameOnCanvas(f):this.drawImageOnCanvas(f);const p=this.getCaptureCanvas(f),x=new ne(p),v=new K(x);return new g(v)}getCaptureCanvasContext(f){if(!this.captureCanvasContext){const x=this.getCaptureCanvas(f).getContext("2d");this.captureCanvasContext=x}return this.captureCanvasContext}getCaptureCanvas(f){if(!this.captureCanvas){const p=this.createCaptureCanvas(f);this.captureCanvas=p}return this.captureCanvas}decodeBitmap(f){return this.reader.decode(f,this._hints)}createCaptureCanvas(f){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const p=document.createElement("canvas");let x,v;return typeof f<"u"&&(f instanceof HTMLVideoElement?(x=f.videoWidth,v=f.videoHeight):f instanceof HTMLImageElement&&(x=f.naturalWidth||f.width,v=f.naturalHeight||f.height)),p.style.width=x+"px",p.style.height=v+"px",p.width=x,p.height=v,p}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(f=>f.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(f,p){try{f.srcObject=p}catch{f.src=URL.createObjectURL(p)}}cleanVideoSource(f){try{f.srcObject=null}catch{f.src=""}this.videoElement.removeAttribute("src")}}class be{constructor(f,p,x=p==null?0:8*p.length,v,w,C=j.currentTimeMillis()){this.text=f,this.rawBytes=p,this.numBits=x,this.resultPoints=v,this.format=w,this.timestamp=C,this.text=f,this.rawBytes=p,x==null?this.numBits=p==null?0:8*p.length:this.numBits=x,this.resultPoints=v,this.format=w,this.resultMetadata=null,C==null?this.timestamp=j.currentTimeMillis():this.timestamp=C}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(f,p){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(f,p)}putAllMetadata(f){f!==null&&(this.resultMetadata===null?this.resultMetadata=f:this.resultMetadata=new Map(f))}addResultPoints(f){const p=this.resultPoints;if(p===null)this.resultPoints=f;else if(f!==null&&f.length>0){const x=new Array(p.length+f.length);j.arraycopy(p,0,x,0,p.length),j.arraycopy(f,0,x,p.length,f.length),this.resultPoints=x}}getTimestamp(){return this.timestamp}toString(){return this.text}}var xe;(function(H){H[H.AZTEC=0]="AZTEC",H[H.CODABAR=1]="CODABAR",H[H.CODE_39=2]="CODE_39",H[H.CODE_93=3]="CODE_93",H[H.CODE_128=4]="CODE_128",H[H.DATA_MATRIX=5]="DATA_MATRIX",H[H.EAN_8=6]="EAN_8",H[H.EAN_13=7]="EAN_13",H[H.ITF=8]="ITF",H[H.MAXICODE=9]="MAXICODE",H[H.PDF_417=10]="PDF_417",H[H.QR_CODE=11]="QR_CODE",H[H.RSS_14=12]="RSS_14",H[H.RSS_EXPANDED=13]="RSS_EXPANDED",H[H.UPC_A=14]="UPC_A",H[H.UPC_E=15]="UPC_E",H[H.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(xe||(xe={}));var _e=xe,we;(function(H){H[H.OTHER=0]="OTHER",H[H.ORIENTATION=1]="ORIENTATION",H[H.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",H[H.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",H[H.ISSUE_NUMBER=4]="ISSUE_NUMBER",H[H.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",H[H.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",H[H.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",H[H.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",H[H.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",H[H.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(we||(we={}));var Oe=we;class ae{constructor(f,p,x,v,w=-1,C=-1){this.rawBytes=f,this.text=p,this.byteSegments=x,this.ecLevel=v,this.structuredAppendSequenceNumber=w,this.structuredAppendParity=C,this.numBits=f==null?0:8*f.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(f){this.numBits=f}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(f){this.errorsCorrected=f}getErasures(){return this.erasures}setErasures(f){this.erasures=f}getOther(){return this.other}setOther(f){this.other=f}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class ie{exp(f){return this.expTable[f]}log(f){if(f===0)throw new m;return this.logTable[f]}static addOrSubtract(f,p){return f^p}}class pe{constructor(f,p){if(p.length===0)throw new m;this.field=f;const x=p.length;if(x>1&&p[0]===0){let v=1;for(;v<x&&p[v]===0;)v++;v===x?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(x-v),j.arraycopy(p,v,this.coefficients,0,this.coefficients.length))}else this.coefficients=p}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(f){return this.coefficients[this.coefficients.length-1-f]}evaluateAt(f){if(f===0)return this.getCoefficient(0);const p=this.coefficients;let x;if(f===1){x=0;for(let C=0,E=p.length;C!==E;C++){const I=p[C];x=ie.addOrSubtract(x,I)}return x}x=p[0];const v=p.length,w=this.field;for(let C=1;C<v;C++)x=ie.addOrSubtract(w.multiply(f,x),p[C]);return x}addOrSubtract(f){if(!this.field.equals(f.field))throw new m("GenericGFPolys do not have same GenericGF field");if(this.isZero())return f;if(f.isZero())return this;let p=this.coefficients,x=f.coefficients;if(p.length>x.length){const C=p;p=x,x=C}let v=new Int32Array(x.length);const w=x.length-p.length;j.arraycopy(x,0,v,0,w);for(let C=w;C<x.length;C++)v[C]=ie.addOrSubtract(p[C-w],x[C]);return new pe(this.field,v)}multiply(f){if(!this.field.equals(f.field))throw new m("GenericGFPolys do not have same GenericGF field");if(this.isZero()||f.isZero())return this.field.getZero();const p=this.coefficients,x=p.length,v=f.coefficients,w=v.length,C=new Int32Array(x+w-1),E=this.field;for(let I=0;I<x;I++){const R=p[I];for(let B=0;B<w;B++)C[I+B]=ie.addOrSubtract(C[I+B],E.multiply(R,v[B]))}return new pe(E,C)}multiplyScalar(f){if(f===0)return this.field.getZero();if(f===1)return this;const p=this.coefficients.length,x=this.field,v=new Int32Array(p),w=this.coefficients;for(let C=0;C<p;C++)v[C]=x.multiply(w[C],f);return new pe(x,v)}multiplyByMonomial(f,p){if(f<0)throw new m;if(p===0)return this.field.getZero();const x=this.coefficients,v=x.length,w=new Int32Array(v+f),C=this.field;for(let E=0;E<v;E++)w[E]=C.multiply(x[E],p);return new pe(C,w)}divide(f){if(!this.field.equals(f.field))throw new m("GenericGFPolys do not have same GenericGF field");if(f.isZero())throw new m("Divide by 0");const p=this.field;let x=p.getZero(),v=this;const w=f.getCoefficient(f.getDegree()),C=p.inverse(w);for(;v.getDegree()>=f.getDegree()&&!v.isZero();){const E=v.getDegree()-f.getDegree(),I=p.multiply(v.getCoefficient(v.getDegree()),C),R=f.multiplyByMonomial(E,I),B=p.buildMonomial(E,I);x=x.addOrSubtract(B),v=v.addOrSubtract(R)}return[x,v]}toString(){let f="";for(let p=this.getDegree();p>=0;p--){let x=this.getCoefficient(p);if(x!==0){if(x<0?(f+=" - ",x=-x):f.length>0&&(f+=" + "),p===0||x!==1){const v=this.field.log(x);v===0?f+="1":v===1?f+="a":(f+="a^",f+=v)}p!==0&&(p===1?f+="x":(f+="x^",f+=p))}}return f}}class re extends u{}re.kind="ArithmeticException";class We extends ie{constructor(f,p,x){super(),this.primitive=f,this.size=p,this.generatorBase=x;const v=new Int32Array(p);let w=1;for(let E=0;E<p;E++)v[E]=w,w*=2,w>=p&&(w^=f,w&=p-1);this.expTable=v;const C=new Int32Array(p);for(let E=0;E<p-1;E++)C[v[E]]=E;this.logTable=C,this.zero=new pe(this,Int32Array.from([0])),this.one=new pe(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(f,p){if(f<0)throw new m;if(p===0)return this.zero;const x=new Int32Array(f+1);return x[0]=p,new pe(this,x)}inverse(f){if(f===0)throw new re;return this.expTable[this.size-this.logTable[f]-1]}multiply(f,p){return f===0||p===0?0:this.expTable[(this.logTable[f]+this.logTable[p])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+k.toHexString(this.primitive)+","+this.size+")"}equals(f){return f===this}}We.AZTEC_DATA_12=new We(4201,4096,1),We.AZTEC_DATA_10=new We(1033,1024,1),We.AZTEC_DATA_6=new We(67,64,1),We.AZTEC_PARAM=new We(19,16,1),We.QR_CODE_FIELD_256=new We(285,256,0),We.DATA_MATRIX_FIELD_256=new We(301,256,1),We.AZTEC_DATA_8=We.DATA_MATRIX_FIELD_256,We.MAXICODE_FIELD_64=We.AZTEC_DATA_6;class Je extends u{}Je.kind="ReedSolomonException";class St extends u{}St.kind="IllegalStateException";class wt{constructor(f){this.field=f}decode(f,p){const x=this.field,v=new pe(x,f),w=new Int32Array(p);let C=!0;for(let ee=0;ee<p;ee++){const oe=v.evaluateAt(x.exp(ee+x.getGeneratorBase()));w[w.length-1-ee]=oe,oe!==0&&(C=!1)}if(C)return;const E=new pe(x,w),I=this.runEuclideanAlgorithm(x.buildMonomial(p,1),E,p),R=I[0],B=I[1],W=this.findErrorLocations(R),Y=this.findErrorMagnitudes(B,W);for(let ee=0;ee<W.length;ee++){const oe=f.length-1-x.log(W[ee]);if(oe<0)throw new Je("Bad error location");f[oe]=We.addOrSubtract(f[oe],Y[ee])}}runEuclideanAlgorithm(f,p,x){if(f.getDegree()<p.getDegree()){const ee=f;f=p,p=ee}const v=this.field;let w=f,C=p,E=v.getZero(),I=v.getOne();for(;C.getDegree()>=(x/2|0);){let ee=w,oe=E;if(w=C,E=I,w.isZero())throw new Je("r_{i-1} was zero");C=ee;let ce=v.getZero();const ge=w.getCoefficient(w.getDegree()),Ae=v.inverse(ge);for(;C.getDegree()>=w.getDegree()&&!C.isZero();){const $e=C.getDegree()-w.getDegree(),Ve=v.multiply(C.getCoefficient(C.getDegree()),Ae);ce=ce.addOrSubtract(v.buildMonomial($e,Ve)),C=C.addOrSubtract(w.multiplyByMonomial($e,Ve))}if(I=ce.multiply(E).addOrSubtract(oe),C.getDegree()>=w.getDegree())throw new St("Division algorithm failed to reduce polynomial?")}const R=I.getCoefficient(0);if(R===0)throw new Je("sigmaTilde(0) was zero");const B=v.inverse(R),W=I.multiplyScalar(B),Y=C.multiplyScalar(B);return[W,Y]}findErrorLocations(f){const p=f.getDegree();if(p===1)return Int32Array.from([f.getCoefficient(1)]);const x=new Int32Array(p);let v=0;const w=this.field;for(let C=1;C<w.getSize()&&v<p;C++)f.evaluateAt(C)===0&&(x[v]=w.inverse(C),v++);if(v!==p)throw new Je("Error locator degree does not match number of roots");return x}findErrorMagnitudes(f,p){const x=p.length,v=new Int32Array(x),w=this.field;for(let C=0;C<x;C++){const E=w.inverse(p[C]);let I=1;for(let R=0;R<x;R++)if(C!==R){const B=w.multiply(p[R],E),W=B&1?B&-2:B|1;I=w.multiply(I,W)}v[C]=w.multiply(f.evaluateAt(E),w.inverse(I)),w.getGeneratorBase()!==0&&(v[C]=w.multiply(v[C],E))}return v}}var ft;(function(H){H[H.UPPER=0]="UPPER",H[H.LOWER=1]="LOWER",H[H.MIXED=2]="MIXED",H[H.DIGIT=3]="DIGIT",H[H.PUNCT=4]="PUNCT",H[H.BINARY=5]="BINARY"})(ft||(ft={}));class Ie{decode(f){this.ddata=f;let p=f.getBits(),x=this.extractBits(p),v=this.correctBits(x),w=Ie.convertBoolArrayToByteArray(v),C=Ie.getEncodedData(v),E=new ae(w,C,null,null);return E.setNumBits(v.length),E}static highLevelDecode(f){return this.getEncodedData(f)}static getEncodedData(f){let p=f.length,x=ft.UPPER,v=ft.UPPER,w="",C=0;for(;C<p;)if(v===ft.BINARY){if(p-C<5)break;let E=Ie.readCode(f,C,5);if(C+=5,E===0){if(p-C<11)break;E=Ie.readCode(f,C,11)+31,C+=11}for(let I=0;I<E;I++){if(p-C<8){C=p;break}const R=Ie.readCode(f,C,8);w+=F.castAsNonUtf8Char(R),C+=8}v=x}else{let E=v===ft.DIGIT?4:5;if(p-C<E)break;let I=Ie.readCode(f,C,E);C+=E;let R=Ie.getCharacter(v,I);R.startsWith("CTRL_")?(x=v,v=Ie.getTable(R.charAt(5)),R.charAt(6)==="L"&&(x=v)):(w+=R,v=x)}return w}static getTable(f){switch(f){case"L":return ft.LOWER;case"P":return ft.PUNCT;case"M":return ft.MIXED;case"D":return ft.DIGIT;case"B":return ft.BINARY;case"U":default:return ft.UPPER}}static getCharacter(f,p){switch(f){case ft.UPPER:return Ie.UPPER_TABLE[p];case ft.LOWER:return Ie.LOWER_TABLE[p];case ft.MIXED:return Ie.MIXED_TABLE[p];case ft.PUNCT:return Ie.PUNCT_TABLE[p];case ft.DIGIT:return Ie.DIGIT_TABLE[p];default:throw new St("Bad table")}}correctBits(f){let p,x;this.ddata.getNbLayers()<=2?(x=6,p=We.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(x=8,p=We.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(x=10,p=We.AZTEC_DATA_10):(x=12,p=We.AZTEC_DATA_12);let v=this.ddata.getNbDatablocks(),w=f.length/x;if(w<v)throw new O;let C=f.length%x,E=new Int32Array(w);for(let Y=0;Y<w;Y++,C+=x)E[Y]=Ie.readCode(f,C,x);try{new wt(p).decode(E,w-v)}catch(Y){throw new O(Y)}let I=(1<<x)-1,R=0;for(let Y=0;Y<v;Y++){let ee=E[Y];if(ee===0||ee===I)throw new O;(ee===1||ee===I-1)&&R++}let B=new Array(v*x-R),W=0;for(let Y=0;Y<v;Y++){let ee=E[Y];if(ee===1||ee===I-1)B.fill(ee>1,W,W+x-1),W+=x-1;else for(let oe=x-1;oe>=0;--oe)B[W++]=(ee&1<<oe)!==0}return B}extractBits(f){let p=this.ddata.isCompact(),x=this.ddata.getNbLayers(),v=(p?11:14)+x*4,w=new Int32Array(v),C=new Array(this.totalBitsInLayer(x,p));if(p)for(let E=0;E<w.length;E++)w[E]=E;else{let E=v+1+2*k.truncDivision(k.truncDivision(v,2)-1,15),I=v/2,R=k.truncDivision(E,2);for(let B=0;B<I;B++){let W=B+k.truncDivision(B,15);w[I-B-1]=R-W-1,w[I+B]=R+W+1}}for(let E=0,I=0;E<x;E++){let R=(x-E)*4+(p?9:12),B=E*2,W=v-1-B;for(let Y=0;Y<R;Y++){let ee=Y*2;for(let oe=0;oe<2;oe++)C[I+ee+oe]=f.get(w[B+oe],w[B+Y]),C[I+2*R+ee+oe]=f.get(w[B+Y],w[W-oe]),C[I+4*R+ee+oe]=f.get(w[W-oe],w[W-Y]),C[I+6*R+ee+oe]=f.get(w[W-Y],w[B+oe])}I+=R*8}return C}static readCode(f,p,x){let v=0;for(let w=p;w<p+x;w++)v<<=1,f[w]&&(v|=1);return v}static readByte(f,p){let x=f.length-p;return x>=8?Ie.readCode(f,p,8):Ie.readCode(f,p,x)<<8-x}static convertBoolArrayToByteArray(f){let p=new Uint8Array((f.length+7)/8);for(let x=0;x<p.length;x++)p[x]=Ie.readByte(f,8*x);return p}totalBitsInLayer(f,p){return((p?88:112)+16*f)*f}}Ie.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],Ie.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],Ie.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],Ie.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],Ie.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class qe{constructor(){}static round(f){return f===NaN?0:f<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:f>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:f+(f<0?-.5:.5)|0}static distance(f,p,x,v){const w=f-x,C=p-v;return Math.sqrt(w*w+C*C)}static sum(f){let p=0;for(let x=0,v=f.length;x!==v;x++){const w=f[x];p+=w}return p}}class se{static floatToIntBits(f){return f}}se.MAX_VALUE=Number.MAX_SAFE_INTEGER;class le{constructor(f,p){this.x=f,this.y=p}getX(){return this.x}getY(){return this.y}equals(f){if(f instanceof le){const p=f;return this.x===p.x&&this.y===p.y}return!1}hashCode(){return 31*se.floatToIntBits(this.x)+se.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(f){const p=this.distance(f[0],f[1]),x=this.distance(f[1],f[2]),v=this.distance(f[0],f[2]);let w,C,E;if(x>=p&&x>=v?(C=f[0],w=f[1],E=f[2]):v>=x&&v>=p?(C=f[1],w=f[0],E=f[2]):(C=f[2],w=f[0],E=f[1]),this.crossProductZ(w,C,E)<0){const I=w;w=E,E=I}f[0]=w,f[1]=C,f[2]=E}static distance(f,p){return qe.distance(f.x,f.y,p.x,p.y)}static crossProductZ(f,p,x){const v=p.x,w=p.y;return(x.x-v)*(f.y-w)-(x.y-w)*(f.x-v)}}class De{constructor(f,p){this.bits=f,this.points=p}getBits(){return this.bits}getPoints(){return this.points}}class Nt extends De{constructor(f,p,x,v,w){super(f,p),this.compact=x,this.nbDatablocks=v,this.nbLayers=w}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class sn{constructor(f,p,x,v){this.image=f,this.height=f.getHeight(),this.width=f.getWidth(),p==null&&(p=sn.INIT_SIZE),x==null&&(x=f.getWidth()/2|0),v==null&&(v=f.getHeight()/2|0);const w=p/2|0;if(this.leftInit=x-w,this.rightInit=x+w,this.upInit=v-w,this.downInit=v+w,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new z}detect(){let f=this.leftInit,p=this.rightInit,x=this.upInit,v=this.downInit,w=!1,C=!0,E=!1,I=!1,R=!1,B=!1,W=!1;const Y=this.width,ee=this.height;for(;C;){C=!1;let oe=!0;for(;(oe||!I)&&p<Y;)oe=this.containsBlackPoint(x,v,p,!1),oe?(p++,C=!0,I=!0):I||p++;if(p>=Y){w=!0;break}let ce=!0;for(;(ce||!R)&&v<ee;)ce=this.containsBlackPoint(f,p,v,!0),ce?(v++,C=!0,R=!0):R||v++;if(v>=ee){w=!0;break}let ge=!0;for(;(ge||!B)&&f>=0;)ge=this.containsBlackPoint(x,v,f,!1),ge?(f--,C=!0,B=!0):B||f--;if(f<0){w=!0;break}let Ae=!0;for(;(Ae||!W)&&x>=0;)Ae=this.containsBlackPoint(f,p,x,!0),Ae?(x--,C=!0,W=!0):W||x--;if(x<0){w=!0;break}C&&(E=!0)}if(!w&&E){const oe=p-f;let ce=null;for(let Ve=1;ce===null&&Ve<oe;Ve++)ce=this.getBlackPointOnSegment(f,v-Ve,f+Ve,v);if(ce==null)throw new z;let ge=null;for(let Ve=1;ge===null&&Ve<oe;Ve++)ge=this.getBlackPointOnSegment(f,x+Ve,f+Ve,x);if(ge==null)throw new z;let Ae=null;for(let Ve=1;Ae===null&&Ve<oe;Ve++)Ae=this.getBlackPointOnSegment(p,x+Ve,p-Ve,x);if(Ae==null)throw new z;let $e=null;for(let Ve=1;$e===null&&Ve<oe;Ve++)$e=this.getBlackPointOnSegment(p,v-Ve,p-Ve,v);if($e==null)throw new z;return this.centerEdges($e,ce,Ae,ge)}else throw new z}getBlackPointOnSegment(f,p,x,v){const w=qe.round(qe.distance(f,p,x,v)),C=(x-f)/w,E=(v-p)/w,I=this.image;for(let R=0;R<w;R++){const B=qe.round(f+R*C),W=qe.round(p+R*E);if(I.get(B,W))return new le(B,W)}return null}centerEdges(f,p,x,v){const w=f.getX(),C=f.getY(),E=p.getX(),I=p.getY(),R=x.getX(),B=x.getY(),W=v.getX(),Y=v.getY(),ee=sn.CORR;return w<this.width/2?[new le(W-ee,Y+ee),new le(E+ee,I+ee),new le(R-ee,B-ee),new le(w+ee,C-ee)]:[new le(W+ee,Y+ee),new le(E+ee,I-ee),new le(R-ee,B+ee),new le(w-ee,C-ee)]}containsBlackPoint(f,p,x,v){const w=this.image;if(v){for(let C=f;C<=p;C++)if(w.get(C,x))return!0}else for(let C=f;C<=p;C++)if(w.get(x,C))return!0;return!1}}sn.INIT_SIZE=10,sn.CORR=1;class Yt{static checkAndNudgePoints(f,p){const x=f.getWidth(),v=f.getHeight();let w=!0;for(let C=0;C<p.length&&w;C+=2){const E=Math.floor(p[C]),I=Math.floor(p[C+1]);if(E<-1||E>x||I<-1||I>v)throw new z;w=!1,E===-1?(p[C]=0,w=!0):E===x&&(p[C]=x-1,w=!0),I===-1?(p[C+1]=0,w=!0):I===v&&(p[C+1]=v-1,w=!0)}w=!0;for(let C=p.length-2;C>=0&&w;C-=2){const E=Math.floor(p[C]),I=Math.floor(p[C+1]);if(E<-1||E>x||I<-1||I>v)throw new z;w=!1,E===-1?(p[C]=0,w=!0):E===x&&(p[C]=x-1,w=!0),I===-1?(p[C+1]=0,w=!0):I===v&&(p[C+1]=v-1,w=!0)}}}class Pt{constructor(f,p,x,v,w,C,E,I,R){this.a11=f,this.a21=p,this.a31=x,this.a12=v,this.a22=w,this.a32=C,this.a13=E,this.a23=I,this.a33=R}static quadrilateralToQuadrilateral(f,p,x,v,w,C,E,I,R,B,W,Y,ee,oe,ce,ge){const Ae=Pt.quadrilateralToSquare(f,p,x,v,w,C,E,I);return Pt.squareToQuadrilateral(R,B,W,Y,ee,oe,ce,ge).times(Ae)}transformPoints(f){const p=f.length,x=this.a11,v=this.a12,w=this.a13,C=this.a21,E=this.a22,I=this.a23,R=this.a31,B=this.a32,W=this.a33;for(let Y=0;Y<p;Y+=2){const ee=f[Y],oe=f[Y+1],ce=w*ee+I*oe+W;f[Y]=(x*ee+C*oe+R)/ce,f[Y+1]=(v*ee+E*oe+B)/ce}}transformPointsWithValues(f,p){const x=this.a11,v=this.a12,w=this.a13,C=this.a21,E=this.a22,I=this.a23,R=this.a31,B=this.a32,W=this.a33,Y=f.length;for(let ee=0;ee<Y;ee++){const oe=f[ee],ce=p[ee],ge=w*oe+I*ce+W;f[ee]=(x*oe+C*ce+R)/ge,p[ee]=(v*oe+E*ce+B)/ge}}static squareToQuadrilateral(f,p,x,v,w,C,E,I){const R=f-x+w-E,B=p-v+C-I;if(R===0&&B===0)return new Pt(x-f,w-x,f,v-p,C-v,p,0,0,1);{const W=x-w,Y=E-w,ee=v-C,oe=I-C,ce=W*oe-Y*ee,ge=(R*oe-Y*B)/ce,Ae=(W*B-R*ee)/ce;return new Pt(x-f+ge*x,E-f+Ae*E,f,v-p+ge*v,I-p+Ae*I,p,ge,Ae,1)}}static quadrilateralToSquare(f,p,x,v,w,C,E,I){return Pt.squareToQuadrilateral(f,p,x,v,w,C,E,I).buildAdjoint()}buildAdjoint(){return new Pt(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(f){return new Pt(this.a11*f.a11+this.a21*f.a12+this.a31*f.a13,this.a11*f.a21+this.a21*f.a22+this.a31*f.a23,this.a11*f.a31+this.a21*f.a32+this.a31*f.a33,this.a12*f.a11+this.a22*f.a12+this.a32*f.a13,this.a12*f.a21+this.a22*f.a22+this.a32*f.a23,this.a12*f.a31+this.a22*f.a32+this.a32*f.a33,this.a13*f.a11+this.a23*f.a12+this.a33*f.a13,this.a13*f.a21+this.a23*f.a22+this.a33*f.a23,this.a13*f.a31+this.a23*f.a32+this.a33*f.a33)}}class tr extends Yt{sampleGrid(f,p,x,v,w,C,E,I,R,B,W,Y,ee,oe,ce,ge,Ae,$e,Ve){const Le=Pt.quadrilateralToQuadrilateral(v,w,C,E,I,R,B,W,Y,ee,oe,ce,ge,Ae,$e,Ve);return this.sampleGridWithTransform(f,p,x,Le)}sampleGridWithTransform(f,p,x,v){if(p<=0||x<=0)throw new z;const w=new U(p,x),C=new Float32Array(2*p);for(let E=0;E<x;E++){const I=C.length,R=E+.5;for(let B=0;B<I;B+=2)C[B]=B/2+.5,C[B+1]=R;v.transformPoints(C),Yt.checkAndNudgePoints(f,C);try{for(let B=0;B<I;B+=2)f.get(Math.floor(C[B]),Math.floor(C[B+1]))&&w.set(B/2,E)}catch{throw new z}}return w}}class In{static setGridSampler(f){In.gridSampler=f}static getInstance(){return In.gridSampler}}In.gridSampler=new tr;class me{constructor(f,p){this.x=f,this.y=p}toResultPoint(){return new le(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class tt{constructor(f){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=f}detect(){return this.detectMirror(!1)}detectMirror(f){let p=this.getMatrixCenter(),x=this.getBullsEyeCorners(p);if(f){let C=x[0];x[0]=x[2],x[2]=C}this.extractParameters(x);let v=this.sampleGrid(this.image,x[this.shift%4],x[(this.shift+1)%4],x[(this.shift+2)%4],x[(this.shift+3)%4]),w=this.getMatrixCornerPoints(x);return new Nt(v,w,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(f){if(!this.isValidPoint(f[0])||!this.isValidPoint(f[1])||!this.isValidPoint(f[2])||!this.isValidPoint(f[3]))throw new z;let p=2*this.nbCenterLayers,x=new Int32Array([this.sampleLine(f[0],f[1],p),this.sampleLine(f[1],f[2],p),this.sampleLine(f[2],f[3],p),this.sampleLine(f[3],f[0],p)]);this.shift=this.getRotation(x,p);let v=0;for(let C=0;C<4;C++){let E=x[(this.shift+C)%4];this.compact?(v<<=7,v+=E>>1&127):(v<<=10,v+=(E>>2&992)+(E>>1&31))}let w=this.getCorrectedParameterData(v,this.compact);this.compact?(this.nbLayers=(w>>6)+1,this.nbDataBlocks=(w&63)+1):(this.nbLayers=(w>>11)+1,this.nbDataBlocks=(w&2047)+1)}getRotation(f,p){let x=0;f.forEach((v,w,C)=>{let E=(v>>p-2<<1)+(v&1);x=(x<<3)+E}),x=((x&1)<<11)+(x>>1);for(let v=0;v<4;v++)if(k.bitCount(x^this.EXPECTED_CORNER_BITS[v])<=2)return v;throw new z}getCorrectedParameterData(f,p){let x,v;p?(x=7,v=2):(x=10,v=4);let w=x-v,C=new Int32Array(x);for(let I=x-1;I>=0;--I)C[I]=f&15,f>>=4;try{new wt(We.AZTEC_PARAM).decode(C,w)}catch{throw new z}let E=0;for(let I=0;I<v;I++)E=(E<<4)+C[I];return E}getBullsEyeCorners(f){let p=f,x=f,v=f,w=f,C=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let W=this.getFirstDifferent(p,C,1,-1),Y=this.getFirstDifferent(x,C,1,1),ee=this.getFirstDifferent(v,C,-1,1),oe=this.getFirstDifferent(w,C,-1,-1);if(this.nbCenterLayers>2){let ce=this.distancePoint(oe,W)*this.nbCenterLayers/(this.distancePoint(w,p)*(this.nbCenterLayers+2));if(ce<.75||ce>1.25||!this.isWhiteOrBlackRectangle(W,Y,ee,oe))break}p=W,x=Y,v=ee,w=oe,C=!C}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new z;this.compact=this.nbCenterLayers===5;let E=new le(p.getX()+.5,p.getY()-.5),I=new le(x.getX()+.5,x.getY()+.5),R=new le(v.getX()-.5,v.getY()+.5),B=new le(w.getX()-.5,w.getY()-.5);return this.expandSquare([E,I,R,B],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let f,p,x,v;try{let E=new sn(this.image).detect();f=E[0],p=E[1],x=E[2],v=E[3]}catch{let I=this.image.getWidth()/2,R=this.image.getHeight()/2;f=this.getFirstDifferent(new me(I+7,R-7),!1,1,-1).toResultPoint(),p=this.getFirstDifferent(new me(I+7,R+7),!1,1,1).toResultPoint(),x=this.getFirstDifferent(new me(I-7,R+7),!1,-1,1).toResultPoint(),v=this.getFirstDifferent(new me(I-7,R-7),!1,-1,-1).toResultPoint()}let w=qe.round((f.getX()+v.getX()+p.getX()+x.getX())/4),C=qe.round((f.getY()+v.getY()+p.getY()+x.getY())/4);try{let E=new sn(this.image,15,w,C).detect();f=E[0],p=E[1],x=E[2],v=E[3]}catch{f=this.getFirstDifferent(new me(w+7,C-7),!1,1,-1).toResultPoint(),p=this.getFirstDifferent(new me(w+7,C+7),!1,1,1).toResultPoint(),x=this.getFirstDifferent(new me(w-7,C+7),!1,-1,1).toResultPoint(),v=this.getFirstDifferent(new me(w-7,C-7),!1,-1,-1).toResultPoint()}return w=qe.round((f.getX()+v.getX()+p.getX()+x.getX())/4),C=qe.round((f.getY()+v.getY()+p.getY()+x.getY())/4),new me(w,C)}getMatrixCornerPoints(f){return this.expandSquare(f,2*this.nbCenterLayers,this.getDimension())}sampleGrid(f,p,x,v,w){let C=In.getInstance(),E=this.getDimension(),I=E/2-this.nbCenterLayers,R=E/2+this.nbCenterLayers;return C.sampleGrid(f,E,E,I,I,R,I,R,R,I,R,p.getX(),p.getY(),x.getX(),x.getY(),v.getX(),v.getY(),w.getX(),w.getY())}sampleLine(f,p,x){let v=0,w=this.distanceResultPoint(f,p),C=w/x,E=f.getX(),I=f.getY(),R=C*(p.getX()-f.getX())/w,B=C*(p.getY()-f.getY())/w;for(let W=0;W<x;W++)this.image.get(qe.round(E+W*R),qe.round(I+W*B))&&(v|=1<<x-W-1);return v}isWhiteOrBlackRectangle(f,p,x,v){let w=3;f=new me(f.getX()-w,f.getY()+w),p=new me(p.getX()-w,p.getY()-w),x=new me(x.getX()+w,x.getY()-w),v=new me(v.getX()+w,v.getY()+w);let C=this.getColor(v,f);if(C===0)return!1;let E=this.getColor(f,p);return E!==C||(E=this.getColor(p,x),E!==C)?!1:(E=this.getColor(x,v),E===C)}getColor(f,p){let x=this.distancePoint(f,p),v=(p.getX()-f.getX())/x,w=(p.getY()-f.getY())/x,C=0,E=f.getX(),I=f.getY(),R=this.image.get(f.getX(),f.getY()),B=Math.ceil(x);for(let Y=0;Y<B;Y++)E+=v,I+=w,this.image.get(qe.round(E),qe.round(I))!==R&&C++;let W=C/x;return W>.1&&W<.9?0:W<=.1===R?1:-1}getFirstDifferent(f,p,x,v){let w=f.getX()+x,C=f.getY()+v;for(;this.isValid(w,C)&&this.image.get(w,C)===p;)w+=x,C+=v;for(w-=x,C-=v;this.isValid(w,C)&&this.image.get(w,C)===p;)w+=x;for(w-=x;this.isValid(w,C)&&this.image.get(w,C)===p;)C+=v;return C-=v,new me(w,C)}expandSquare(f,p,x){let v=x/(2*p),w=f[0].getX()-f[2].getX(),C=f[0].getY()-f[2].getY(),E=(f[0].getX()+f[2].getX())/2,I=(f[0].getY()+f[2].getY())/2,R=new le(E+v*w,I+v*C),B=new le(E-v*w,I-v*C);w=f[1].getX()-f[3].getX(),C=f[1].getY()-f[3].getY(),E=(f[1].getX()+f[3].getX())/2,I=(f[1].getY()+f[3].getY())/2;let W=new le(E+v*w,I+v*C),Y=new le(E-v*w,I-v*C);return[R,W,B,Y]}isValid(f,p){return f>=0&&f<this.image.getWidth()&&p>0&&p<this.image.getHeight()}isValidPoint(f){let p=qe.round(f.getX()),x=qe.round(f.getY());return this.isValid(p,x)}distancePoint(f,p){return qe.distance(f.getX(),f.getY(),p.getX(),p.getY())}distanceResultPoint(f,p){return qe.distance(f.getX(),f.getY(),p.getX(),p.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(k.truncDivision(this.nbLayers-4,8)+1)+15}}class Et{decode(f,p=null){let x=null,v=new tt(f.getBlackMatrix()),w=null,C=null;try{let B=v.detectMirror(!1);w=B.getPoints(),this.reportFoundResultPoints(p,w),C=new Ie().decode(B)}catch(B){x=B}if(C==null)try{let B=v.detectMirror(!0);w=B.getPoints(),this.reportFoundResultPoints(p,w),C=new Ie().decode(B)}catch(B){throw x??B}let E=new be(C.getText(),C.getRawBytes(),C.getNumBits(),w,_e.AZTEC,j.currentTimeMillis()),I=C.getByteSegments();I!=null&&E.putMetadata(Oe.BYTE_SEGMENTS,I);let R=C.getECLevel();return R!=null&&E.putMetadata(Oe.ERROR_CORRECTION_LEVEL,R),E}reportFoundResultPoints(f,p){if(f!=null){let x=f.get(M.NEED_RESULT_POINT_CALLBACK);x!=null&&p.forEach((v,w,C)=>{x.foundPossibleResultPoint(v)})}}reset(){}}class Ft extends ye{constructor(f=500){super(new Et,f)}}class en{decode(f,p){try{return this.doDecode(f,p)}catch{if(p&&p.get(M.TRY_HARDER)===!0&&f.isRotateSupported()){const w=f.rotateCounterClockwise(),C=this.doDecode(w,p),E=C.getResultMetadata();let I=270;E!==null&&E.get(Oe.ORIENTATION)===!0&&(I=I+E.get(Oe.ORIENTATION)%360),C.putMetadata(Oe.ORIENTATION,I);const R=C.getResultPoints();if(R!==null){const B=w.getHeight();for(let W=0;W<R.length;W++)R[W]=new le(B-R[W].getY()-1,R[W].getX())}return C}else throw new z}}reset(){}doDecode(f,p){const x=f.getWidth(),v=f.getHeight();let w=new T(x);const C=p&&p.get(M.TRY_HARDER)===!0,E=Math.max(1,v>>(C?8:5));let I;C?I=v:I=15;const R=Math.trunc(v/2);for(let B=0;B<I;B++){const W=Math.trunc((B+1)/2),Y=(B&1)===0,ee=R+E*(Y?W:-W);if(ee<0||ee>=v)break;try{w=f.getBlackRow(ee,w)}catch{continue}for(let oe=0;oe<2;oe++){if(oe===1&&(w.reverse(),p&&p.get(M.NEED_RESULT_POINT_CALLBACK)===!0)){const ce=new Map;p.forEach((ge,Ae)=>ce.set(Ae,ge)),ce.delete(M.NEED_RESULT_POINT_CALLBACK),p=ce}try{const ce=this.decodeRow(ee,w,p);if(oe===1){ce.putMetadata(Oe.ORIENTATION,180);const ge=ce.getResultPoints();ge!==null&&(ge[0]=new le(x-ge[0].getX()-1,ge[0].getY()),ge[1]=new le(x-ge[1].getX()-1,ge[1].getY()))}return ce}catch{}}}throw new z}static recordPattern(f,p,x){const v=x.length;for(let R=0;R<v;R++)x[R]=0;const w=f.getSize();if(p>=w)throw new z;let C=!f.get(p),E=0,I=p;for(;I<w;){if(f.get(I)!==C)x[E]++;else{if(++E===v)break;x[E]=1,C=!C}I++}if(!(E===v||E===v-1&&I===w))throw new z}static recordPatternInReverse(f,p,x){let v=x.length,w=f.get(p);for(;p>0&&v>=0;)f.get(--p)!==w&&(v--,w=!w);if(v>=0)throw new z;en.recordPattern(f,p+1,x)}static patternMatchVariance(f,p,x){const v=f.length;let w=0,C=0;for(let R=0;R<v;R++)w+=f[R],C+=p[R];if(w<C)return Number.POSITIVE_INFINITY;const E=w/C;x*=E;let I=0;for(let R=0;R<v;R++){const B=f[R],W=p[R]*E,Y=B>W?B-W:W-B;if(Y>x)return Number.POSITIVE_INFINITY;I+=Y}return I/w}}class Ue extends en{static findStartPattern(f){const p=f.getSize(),x=f.getNextSet(0);let v=0,w=Int32Array.from([0,0,0,0,0,0]),C=x,E=!1;const I=6;for(let R=x;R<p;R++)if(f.get(R)!==E)w[v]++;else{if(v===I-1){let B=Ue.MAX_AVG_VARIANCE,W=-1;for(let Y=Ue.CODE_START_A;Y<=Ue.CODE_START_C;Y++){const ee=en.patternMatchVariance(w,Ue.CODE_PATTERNS[Y],Ue.MAX_INDIVIDUAL_VARIANCE);ee<B&&(B=ee,W=Y)}if(W>=0&&f.isRange(Math.max(0,C-(R-C)/2),C,!1))return Int32Array.from([C,R,W]);C+=w[0]+w[1],w=w.slice(2,w.length-1),w[v-1]=0,w[v]=0,v--}else v++;w[v]=1,E=!E}throw new z}static decodeCode(f,p,x){en.recordPattern(f,x,p);let v=Ue.MAX_AVG_VARIANCE,w=-1;for(let C=0;C<Ue.CODE_PATTERNS.length;C++){const E=Ue.CODE_PATTERNS[C],I=this.patternMatchVariance(p,E,Ue.MAX_INDIVIDUAL_VARIANCE);I<v&&(v=I,w=C)}if(w>=0)return w;throw new z}decodeRow(f,p,x){const v=x&&x.get(M.ASSUME_GS1)===!0,w=Ue.findStartPattern(p),C=w[2];let E=0;const I=new Uint8Array(20);I[E++]=C;let R;switch(C){case Ue.CODE_START_A:R=Ue.CODE_CODE_A;break;case Ue.CODE_START_B:R=Ue.CODE_CODE_B;break;case Ue.CODE_START_C:R=Ue.CODE_CODE_C;break;default:throw new O}let B=!1,W=!1,Y="",ee=w[0],oe=w[1];const ce=Int32Array.from([0,0,0,0,0,0]);let ge=0,Ae=0,$e=C,Ve=0,Le=!0,Gt=!1,Dt=!1;for(;!B;){const Fu=W;switch(W=!1,ge=Ae,Ae=Ue.decodeCode(p,ce,oe),I[E++]=Ae,Ae!==Ue.CODE_STOP&&(Le=!0),Ae!==Ue.CODE_STOP&&(Ve++,$e+=Ve*Ae),ee=oe,oe+=ce.reduce((HG,WG)=>HG+WG,0),Ae){case Ue.CODE_START_A:case Ue.CODE_START_B:case Ue.CODE_START_C:throw new O}switch(R){case Ue.CODE_CODE_A:if(Ae<64)Dt===Gt?Y+=String.fromCharCode(32+Ae):Y+=String.fromCharCode(32+Ae+128),Dt=!1;else if(Ae<96)Dt===Gt?Y+=String.fromCharCode(Ae-64):Y+=String.fromCharCode(Ae+64),Dt=!1;else switch(Ae!==Ue.CODE_STOP&&(Le=!1),Ae){case Ue.CODE_FNC_1:v&&(Y.length===0?Y+="]C1":Y+="");break;case Ue.CODE_FNC_2:case Ue.CODE_FNC_3:break;case Ue.CODE_FNC_4_A:!Gt&&Dt?(Gt=!0,Dt=!1):Gt&&Dt?(Gt=!1,Dt=!1):Dt=!0;break;case Ue.CODE_SHIFT:W=!0,R=Ue.CODE_CODE_B;break;case Ue.CODE_CODE_B:R=Ue.CODE_CODE_B;break;case Ue.CODE_CODE_C:R=Ue.CODE_CODE_C;break;case Ue.CODE_STOP:B=!0;break}break;case Ue.CODE_CODE_B:if(Ae<96)Dt===Gt?Y+=String.fromCharCode(32+Ae):Y+=String.fromCharCode(32+Ae+128),Dt=!1;else switch(Ae!==Ue.CODE_STOP&&(Le=!1),Ae){case Ue.CODE_FNC_1:v&&(Y.length===0?Y+="]C1":Y+="");break;case Ue.CODE_FNC_2:case Ue.CODE_FNC_3:break;case Ue.CODE_FNC_4_B:!Gt&&Dt?(Gt=!0,Dt=!1):Gt&&Dt?(Gt=!1,Dt=!1):Dt=!0;break;case Ue.CODE_SHIFT:W=!0,R=Ue.CODE_CODE_A;break;case Ue.CODE_CODE_A:R=Ue.CODE_CODE_A;break;case Ue.CODE_CODE_C:R=Ue.CODE_CODE_C;break;case Ue.CODE_STOP:B=!0;break}break;case Ue.CODE_CODE_C:if(Ae<100)Ae<10&&(Y+="0"),Y+=Ae;else switch(Ae!==Ue.CODE_STOP&&(Le=!1),Ae){case Ue.CODE_FNC_1:v&&(Y.length===0?Y+="]C1":Y+="");break;case Ue.CODE_CODE_A:R=Ue.CODE_CODE_A;break;case Ue.CODE_CODE_B:R=Ue.CODE_CODE_B;break;case Ue.CODE_STOP:B=!0;break}break}Fu&&(R=R===Ue.CODE_CODE_A?Ue.CODE_CODE_B:Ue.CODE_CODE_A)}const Zs=oe-ee;if(oe=p.getNextUnset(oe),!p.isRange(oe,Math.min(p.getSize(),oe+(oe-ee)/2),!1))throw new z;if($e-=Ve*ge,$e%103!==ge)throw new y;const ji=Y.length;if(ji===0)throw new z;ji>0&&Le&&(R===Ue.CODE_CODE_C?Y=Y.substring(0,ji-2):Y=Y.substring(0,ji-1));const Js=(w[1]+w[0])/2,wn=ee+Zs/2,is=I.length,ya=new Uint8Array(is);for(let Fu=0;Fu<is;Fu++)ya[Fu]=I[Fu];const Bu=[new le(Js,f),new le(wn,f)];return new be(Y,ya,0,Bu,_e.CODE_128,new Date().getTime())}}Ue.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Ue.MAX_AVG_VARIANCE=.25,Ue.MAX_INDIVIDUAL_VARIANCE=.7,Ue.CODE_SHIFT=98,Ue.CODE_CODE_C=99,Ue.CODE_CODE_B=100,Ue.CODE_CODE_A=101,Ue.CODE_FNC_1=102,Ue.CODE_FNC_2=97,Ue.CODE_FNC_3=96,Ue.CODE_FNC_4_A=101,Ue.CODE_FNC_4_B=100,Ue.CODE_START_A=103,Ue.CODE_START_B=104,Ue.CODE_START_C=105,Ue.CODE_STOP=106;class an extends en{constructor(f=!1,p=!1){super(),this.usingCheckDigit=f,this.extendedMode=p,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(f,p,x){let v=this.counters;v.fill(0),this.decodeRowResult="";let w=an.findAsteriskPattern(p,v),C=p.getNextSet(w[1]),E=p.getSize(),I,R;do{an.recordPattern(p,C,v);let ce=an.toNarrowWidePattern(v);if(ce<0)throw new z;I=an.patternToChar(ce),this.decodeRowResult+=I,R=C;for(let ge of v)C+=ge;C=p.getNextSet(C)}while(I!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let B=0;for(let ce of v)B+=ce;let W=C-R-B;if(C!==E&&W*2<B)throw new z;if(this.usingCheckDigit){let ce=this.decodeRowResult.length-1,ge=0;for(let Ae=0;Ae<ce;Ae++)ge+=an.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(Ae));if(this.decodeRowResult.charAt(ce)!==an.ALPHABET_STRING.charAt(ge%43))throw new y;this.decodeRowResult=this.decodeRowResult.substring(0,ce)}if(this.decodeRowResult.length===0)throw new z;let Y;this.extendedMode?Y=an.decodeExtended(this.decodeRowResult):Y=this.decodeRowResult;let ee=(w[1]+w[0])/2,oe=R+B/2;return new be(Y,null,0,[new le(ee,f),new le(oe,f)],_e.CODE_39,new Date().getTime())}static findAsteriskPattern(f,p){let x=f.getSize(),v=f.getNextSet(0),w=0,C=v,E=!1,I=p.length;for(let R=v;R<x;R++)if(f.get(R)!==E)p[w]++;else{if(w===I-1){if(this.toNarrowWidePattern(p)===an.ASTERISK_ENCODING&&f.isRange(Math.max(0,C-Math.floor((R-C)/2)),C,!1))return[C,R];C+=p[0]+p[1],p.copyWithin(0,2,2+w-1),p[w-1]=0,p[w]=0,w--}else w++;p[w]=1,E=!E}throw new z}static toNarrowWidePattern(f){let p=f.length,x=0,v;do{let w=2147483647;for(let I of f)I<w&&I>x&&(w=I);x=w,v=0;let C=0,E=0;for(let I=0;I<p;I++){let R=f[I];R>x&&(E|=1<<p-1-I,v++,C+=R)}if(v===3){for(let I=0;I<p&&v>0;I++){let R=f[I];if(R>x&&(v--,R*2>=C))return-1}return E}}while(v>3);return-1}static patternToChar(f){for(let p=0;p<an.CHARACTER_ENCODINGS.length;p++)if(an.CHARACTER_ENCODINGS[p]===f)return an.ALPHABET_STRING.charAt(p);if(f===an.ASTERISK_ENCODING)return"*";throw new z}static decodeExtended(f){let p=f.length,x="";for(let v=0;v<p;v++){let w=f.charAt(v);if(w==="+"||w==="$"||w==="%"||w==="/"){let C=f.charAt(v+1),E="\0";switch(w){case"+":if(C>="A"&&C<="Z")E=String.fromCharCode(C.charCodeAt(0)+32);else throw new O;break;case"$":if(C>="A"&&C<="Z")E=String.fromCharCode(C.charCodeAt(0)-64);else throw new O;break;case"%":if(C>="A"&&C<="E")E=String.fromCharCode(C.charCodeAt(0)-38);else if(C>="F"&&C<="J")E=String.fromCharCode(C.charCodeAt(0)-11);else if(C>="K"&&C<="O")E=String.fromCharCode(C.charCodeAt(0)+16);else if(C>="P"&&C<="T")E=String.fromCharCode(C.charCodeAt(0)+43);else if(C==="U")E="\0";else if(C==="V")E="@";else if(C==="W")E="`";else if(C==="X"||C==="Y"||C==="Z")E="";else throw new O;break;case"/":if(C>="A"&&C<="O")E=String.fromCharCode(C.charCodeAt(0)-32);else if(C==="Z")E=":";else throw new O;break}x+=E,v++}else x+=w}return x}}an.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",an.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],an.ASTERISK_ENCODING=148;class Kt extends en{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(f,p,x){let v=this.decodeStart(p),w=this.decodeEnd(p),C=new Q;Kt.decodeMiddle(p,v[1],w[0],C);let E=C.toString(),I=null;x!=null&&(I=x.get(M.ALLOWED_LENGTHS)),I==null&&(I=Kt.DEFAULT_ALLOWED_LENGTHS);let R=E.length,B=!1,W=0;for(let oe of I){if(R===oe){B=!0;break}oe>W&&(W=oe)}if(!B&&R>W&&(B=!0),!B)throw new O;const Y=[new le(v[1],f),new le(w[0],f)];return new be(E,null,0,Y,_e.ITF,new Date().getTime())}static decodeMiddle(f,p,x,v){let w=new Int32Array(10),C=new Int32Array(5),E=new Int32Array(5);for(w.fill(0),C.fill(0),E.fill(0);p<x;){en.recordPattern(f,p,w);for(let R=0;R<5;R++){let B=2*R;C[R]=w[B],E[R]=w[B+1]}let I=Kt.decodeDigit(C);v.append(I.toString()),I=this.decodeDigit(E),v.append(I.toString()),w.forEach(function(R){p+=R})}}decodeStart(f){let p=Kt.skipWhiteSpace(f),x=Kt.findGuardPattern(f,p,Kt.START_PATTERN);return this.narrowLineWidth=(x[1]-x[0])/4,this.validateQuietZone(f,x[0]),x}validateQuietZone(f,p){let x=this.narrowLineWidth*10;x=x<p?x:p;for(let v=p-1;x>0&&v>=0&&!f.get(v);v--)x--;if(x!==0)throw new z}static skipWhiteSpace(f){const p=f.getSize(),x=f.getNextSet(0);if(x===p)throw new z;return x}decodeEnd(f){f.reverse();try{let p=Kt.skipWhiteSpace(f),x;try{x=Kt.findGuardPattern(f,p,Kt.END_PATTERN_REVERSED[0])}catch(w){w instanceof z&&(x=Kt.findGuardPattern(f,p,Kt.END_PATTERN_REVERSED[1]))}this.validateQuietZone(f,x[0]);let v=x[0];return x[0]=f.getSize()-x[1],x[1]=f.getSize()-v,x}finally{f.reverse()}}static findGuardPattern(f,p,x){let v=x.length,w=new Int32Array(v),C=f.getSize(),E=!1,I=0,R=p;w.fill(0);for(let B=p;B<C;B++)if(f.get(B)!==E)w[I]++;else{if(I===v-1){if(en.patternMatchVariance(w,x,Kt.MAX_INDIVIDUAL_VARIANCE)<Kt.MAX_AVG_VARIANCE)return[R,B];R+=w[0]+w[1],j.arraycopy(w,2,w,0,I-1),w[I-1]=0,w[I]=0,I--}else I++;w[I]=1,E=!E}throw new z}static decodeDigit(f){let p=Kt.MAX_AVG_VARIANCE,x=-1,v=Kt.PATTERNS.length;for(let w=0;w<v;w++){let C=Kt.PATTERNS[w],E=en.patternMatchVariance(f,C,Kt.MAX_INDIVIDUAL_VARIANCE);E<p?(p=E,x=w):E===p&&(x=-1)}if(x>=0)return x%10;throw new z}}Kt.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Kt.MAX_AVG_VARIANCE=.38,Kt.MAX_INDIVIDUAL_VARIANCE=.5,Kt.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Kt.START_PATTERN=Int32Array.from([1,1,1,1]),Kt.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Xt extends en{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(f){let p=!1,x,v=0,w=Int32Array.from([0,0,0]);for(;!p;){w=Int32Array.from([0,0,0]),x=Xt.findGuardPattern(f,v,!1,this.START_END_PATTERN,w);let C=x[0];v=x[1];let E=C-(v-C);E>=0&&(p=f.isRange(E,C,!1))}return x}static checkChecksum(f){return Xt.checkStandardUPCEANChecksum(f)}static checkStandardUPCEANChecksum(f){let p=f.length;if(p===0)return!1;let x=parseInt(f.charAt(p-1),10);return Xt.getStandardUPCEANChecksum(f.substring(0,p-1))===x}static getStandardUPCEANChecksum(f){let p=f.length,x=0;for(let v=p-1;v>=0;v-=2){let w=f.charAt(v).charCodeAt(0)-48;if(w<0||w>9)throw new O;x+=w}x*=3;for(let v=p-2;v>=0;v-=2){let w=f.charAt(v).charCodeAt(0)-48;if(w<0||w>9)throw new O;x+=w}return(1e3-x)%10}static decodeEnd(f,p){return Xt.findGuardPattern(f,p,!1,Xt.START_END_PATTERN,new Int32Array(Xt.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(f,p,x,v){return this.findGuardPattern(f,p,x,v,new Int32Array(v.length))}static findGuardPattern(f,p,x,v,w){let C=f.getSize();p=x?f.getNextUnset(p):f.getNextSet(p);let E=0,I=p,R=v.length,B=x;for(let W=p;W<C;W++)if(f.get(W)!==B)w[E]++;else{if(E===R-1){if(en.patternMatchVariance(w,v,Xt.MAX_INDIVIDUAL_VARIANCE)<Xt.MAX_AVG_VARIANCE)return Int32Array.from([I,W]);I+=w[0]+w[1];let Y=w.slice(2,w.length-1);for(let ee=0;ee<E-1;ee++)w[ee]=Y[ee];w[E-1]=0,w[E]=0,E--}else E++;w[E]=1,B=!B}throw new z}static decodeDigit(f,p,x,v){this.recordPattern(f,x,p);let w=this.MAX_AVG_VARIANCE,C=-1,E=v.length;for(let I=0;I<E;I++){let R=v[I],B=en.patternMatchVariance(p,R,Xt.MAX_INDIVIDUAL_VARIANCE);B<w&&(w=B,C=I)}if(C>=0)return C;throw new z}}Xt.MAX_AVG_VARIANCE=.48,Xt.MAX_INDIVIDUAL_VARIANCE=.7,Xt.START_END_PATTERN=Int32Array.from([1,1,1]),Xt.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Xt.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Xt.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class Cn{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(f,p,x){let v=this.decodeRowStringBuffer,w=this.decodeMiddle(p,x,v),C=v.toString(),E=Cn.parseExtensionString(C),I=[new le((x[0]+x[1])/2,f),new le(w,f)],R=new be(C,null,0,I,_e.UPC_EAN_EXTENSION,new Date().getTime());return E!=null&&R.putAllMetadata(E),R}decodeMiddle(f,p,x){let v=this.decodeMiddleCounters;v[0]=0,v[1]=0,v[2]=0,v[3]=0;let w=f.getSize(),C=p[1],E=0;for(let R=0;R<5&&C<w;R++){let B=Xt.decodeDigit(f,v,C,Xt.L_AND_G_PATTERNS);x+=String.fromCharCode(48+B%10);for(let W of v)C+=W;B>=10&&(E|=1<<4-R),R!==4&&(C=f.getNextSet(C),C=f.getNextUnset(C))}if(x.length!==5)throw new z;let I=this.determineCheckDigit(E);if(Cn.extensionChecksum(x.toString())!==I)throw new z;return C}static extensionChecksum(f){let p=f.length,x=0;for(let v=p-2;v>=0;v-=2)x+=f.charAt(v).charCodeAt(0)-48;x*=3;for(let v=p-1;v>=0;v-=2)x+=f.charAt(v).charCodeAt(0)-48;return x*=3,x%10}determineCheckDigit(f){for(let p=0;p<10;p++)if(f===this.CHECK_DIGIT_ENCODINGS[p])return p;throw new z}static parseExtensionString(f){if(f.length!==5)return null;let p=Cn.parseExtension5String(f);return p==null?null:new Map([[Oe.SUGGESTED_PRICE,p]])}static parseExtension5String(f){let p;switch(f.charAt(0)){case"0":p="";break;case"5":p="$";break;case"9":switch(f){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}p="";break;default:p="";break}let x=parseInt(f.substring(1)),v=(x/100).toString(),w=x%100,C=w<10?"0"+w:w.toString();return p+v+"."+C}}class kr{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(f,p,x){let v=this.decodeRowStringBuffer,w=this.decodeMiddle(p,x,v),C=v.toString(),E=kr.parseExtensionString(C),I=[new le((x[0]+x[1])/2,f),new le(w,f)],R=new be(C,null,0,I,_e.UPC_EAN_EXTENSION,new Date().getTime());return E!=null&&R.putAllMetadata(E),R}decodeMiddle(f,p,x){let v=this.decodeMiddleCounters;v[0]=0,v[1]=0,v[2]=0,v[3]=0;let w=f.getSize(),C=p[1],E=0;for(let I=0;I<2&&C<w;I++){let R=Xt.decodeDigit(f,v,C,Xt.L_AND_G_PATTERNS);x+=String.fromCharCode(48+R%10);for(let B of v)C+=B;R>=10&&(E|=1<<1-I),I!==1&&(C=f.getNextSet(C),C=f.getNextUnset(C))}if(x.length!==2)throw new z;if(parseInt(x.toString())%4!==E)throw new z;return C}static parseExtensionString(f){return f.length!==2?null:new Map([[Oe.ISSUE_NUMBER,parseInt(f)]])}}class zo{static decodeRow(f,p,x){let v=Xt.findGuardPattern(p,x,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new Cn().decodeRow(f,p,v)}catch{return new kr().decodeRow(f,p,v)}}}zo.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Mt extends Xt{constructor(){super(),this.decodeRowStringBuffer="",Mt.L_AND_G_PATTERNS=Mt.L_PATTERNS.map(f=>Int32Array.from(f));for(let f=10;f<20;f++){let p=Mt.L_PATTERNS[f-10],x=new Int32Array(p.length);for(let v=0;v<p.length;v++)x[v]=p[p.length-v-1];Mt.L_AND_G_PATTERNS[f]=x}}decodeRow(f,p,x){let v=Mt.findStartGuardPattern(p),w=x==null?null:x.get(M.NEED_RESULT_POINT_CALLBACK);if(w!=null){const Le=new le((v[0]+v[1])/2,f);w.foundPossibleResultPoint(Le)}let C=this.decodeMiddle(p,v,this.decodeRowStringBuffer),E=C.rowOffset,I=C.resultString;if(w!=null){const Le=new le(E,f);w.foundPossibleResultPoint(Le)}let R=this.decodeEnd(p,E);if(w!=null){const Le=new le((R[0]+R[1])/2,f);w.foundPossibleResultPoint(Le)}let B=R[1],W=B+(B-R[0]);if(W>=p.getSize()||!p.isRange(B,W,!1))throw new z;let Y=I.toString();if(Y.length<8)throw new O;if(!Mt.checkChecksum(Y))throw new y;let ee=(v[1]+v[0])/2,oe=(R[1]+R[0])/2,ce=this.getBarcodeFormat(),ge=[new le(ee,f),new le(oe,f)],Ae=new be(Y,null,0,ge,ce,new Date().getTime()),$e=0;try{let Le=zo.decodeRow(f,p,R[1]);Ae.putMetadata(Oe.UPC_EAN_EXTENSION,Le.getText()),Ae.putAllMetadata(Le.getResultMetadata()),Ae.addResultPoints(Le.getResultPoints()),$e=Le.getText().length}catch{}let Ve=x==null?null:x.get(M.ALLOWED_EAN_EXTENSIONS);if(Ve!=null){let Le=!1;for(let Gt in Ve)if($e.toString()===Gt){Le=!0;break}if(!Le)throw new z}return Ae}decodeEnd(f,p){return Mt.findGuardPattern(f,p,!1,Mt.START_END_PATTERN,new Int32Array(Mt.START_END_PATTERN.length).fill(0))}static checkChecksum(f){return Mt.checkStandardUPCEANChecksum(f)}static checkStandardUPCEANChecksum(f){let p=f.length;if(p===0)return!1;let x=parseInt(f.charAt(p-1),10);return Mt.getStandardUPCEANChecksum(f.substring(0,p-1))===x}static getStandardUPCEANChecksum(f){let p=f.length,x=0;for(let v=p-1;v>=0;v-=2){let w=f.charAt(v).charCodeAt(0)-48;if(w<0||w>9)throw new O;x+=w}x*=3;for(let v=p-2;v>=0;v-=2){let w=f.charAt(v).charCodeAt(0)-48;if(w<0||w>9)throw new O;x+=w}return(1e3-x)%10}}class $t extends Mt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(f,p,x){let v=this.decodeMiddleCounters;v[0]=0,v[1]=0,v[2]=0,v[3]=0;let w=f.getSize(),C=p[1],E=0;for(let R=0;R<6&&C<w;R++){let B=Mt.decodeDigit(f,v,C,Mt.L_AND_G_PATTERNS);x+=String.fromCharCode(48+B%10);for(let W of v)C+=W;B>=10&&(E|=1<<5-R)}x=$t.determineFirstDigit(x,E),C=Mt.findGuardPattern(f,C,!0,Mt.MIDDLE_PATTERN,new Int32Array(Mt.MIDDLE_PATTERN.length).fill(0))[1];for(let R=0;R<6&&C<w;R++){let B=Mt.decodeDigit(f,v,C,Mt.L_PATTERNS);x+=String.fromCharCode(48+B);for(let W of v)C+=W}return{rowOffset:C,resultString:x}}getBarcodeFormat(){return _e.EAN_13}static determineFirstDigit(f,p){for(let x=0;x<10;x++)if(p===this.FIRST_DIGIT_ENCODINGS[x])return f=String.fromCharCode(48+x)+f,f;throw new z}}$t.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class Ha extends Mt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(f,p,x){const v=this.decodeMiddleCounters;v[0]=0,v[1]=0,v[2]=0,v[3]=0;let w=f.getSize(),C=p[1];for(let I=0;I<4&&C<w;I++){let R=Mt.decodeDigit(f,v,C,Mt.L_PATTERNS);x+=String.fromCharCode(48+R);for(let B of v)C+=B}C=Mt.findGuardPattern(f,C,!0,Mt.MIDDLE_PATTERN,new Int32Array(Mt.MIDDLE_PATTERN.length).fill(0))[1];for(let I=0;I<4&&C<w;I++){let R=Mt.decodeDigit(f,v,C,Mt.L_PATTERNS);x+=String.fromCharCode(48+R);for(let B of v)C+=B}return{rowOffset:C,resultString:x}}getBarcodeFormat(){return _e.EAN_8}}class Ct extends Mt{constructor(){super(...arguments),this.ean13Reader=new $t}getBarcodeFormat(){return _e.UPC_A}decode(f,p){return this.maybeReturnResult(this.ean13Reader.decode(f))}decodeRow(f,p,x){return this.maybeReturnResult(this.ean13Reader.decodeRow(f,p,x))}decodeMiddle(f,p,x){return this.ean13Reader.decodeMiddle(f,p,x)}maybeReturnResult(f){let p=f.getText();if(p.charAt(0)==="0"){let x=new be(p.substring(1),null,null,f.getResultPoints(),_e.UPC_A);return f.getResultMetadata()!=null&&x.putAllMetadata(f.getResultMetadata()),x}else throw new z}reset(){this.ean13Reader.reset()}}class ue extends Mt{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(f,p,x){const v=this.decodeMiddleCounters.map(R=>R);v[0]=0,v[1]=0,v[2]=0,v[3]=0;const w=f.getSize();let C=p[1],E=0;for(let R=0;R<6&&C<w;R++){const B=ue.decodeDigit(f,v,C,ue.L_AND_G_PATTERNS);x+=String.fromCharCode(48+B%10);for(let W of v)C+=W;B>=10&&(E|=1<<5-R)}let I=ue.determineNumSysAndCheckDigit(x,E);return{rowOffset:C,resultString:I}}decodeEnd(f,p){return ue.findGuardPatternWithoutCounters(f,p,!0,ue.MIDDLE_END_PATTERN)}checkChecksum(f){return Mt.checkChecksum(ue.convertUPCEtoUPCA(f))}static determineNumSysAndCheckDigit(f,p){for(let x=0;x<=1;x++)for(let v=0;v<10;v++)if(p===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[x][v]){let w=String.fromCharCode(48+x),C=String.fromCharCode(48+v);return w+f+C}throw z.getNotFoundInstance()}getBarcodeFormat(){return _e.UPC_E}static convertUPCEtoUPCA(f){const p=f.slice(1,7).split("").map(w=>w.charCodeAt(0)),x=new Q;x.append(f.charAt(0));let v=p[5];switch(v){case 0:case 1:case 2:x.appendChars(p,0,2),x.append(v),x.append("0000"),x.appendChars(p,2,3);break;case 3:x.appendChars(p,0,3),x.append("00000"),x.appendChars(p,3,2);break;case 4:x.appendChars(p,0,4),x.append("00000"),x.append(p[4]);break;default:x.appendChars(p,0,5),x.append("0000"),x.append(v);break}return f.length>=8&&x.append(f.charAt(7)),x.toString()}}ue.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),ue.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class nt extends en{constructor(f){super();let p=f==null?null:f.get(M.POSSIBLE_FORMATS),x=[];s(p)?(x.push(new $t),x.push(new Ct),x.push(new Ha),x.push(new ue)):(p.indexOf(_e.EAN_13)>-1&&x.push(new $t),p.indexOf(_e.UPC_A)>-1&&x.push(new Ct),p.indexOf(_e.EAN_8)>-1&&x.push(new Ha),p.indexOf(_e.UPC_E)>-1&&x.push(new ue)),this.readers=x}decodeRow(f,p,x){for(let v of this.readers)try{const w=v.decodeRow(f,p,x),C=w.getBarcodeFormat()===_e.EAN_13&&w.getText().charAt(0)==="0",E=x==null?null:x.get(M.POSSIBLE_FORMATS),I=E==null||E.includes(_e.UPC_A);if(C&&I){const R=w.getRawBytes(),B=new be(w.getText().substring(1),R,R?R.length:null,w.getResultPoints(),_e.UPC_A);return B.putAllMetadata(w.getResultMetadata()),B}return w}catch{}throw new z}reset(){for(let f of this.readers)f.reset()}}class st extends en{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(f,p){for(let x=0;x<p.length;x++)if(en.patternMatchVariance(f,p[x],st.MAX_INDIVIDUAL_VARIANCE)<st.MAX_AVG_VARIANCE)return x;throw new z}static count(f){return qe.sum(new Int32Array(f))}static increment(f,p){let x=0,v=p[0];for(let w=1;w<f.length;w++)p[w]>v&&(v=p[w],x=w);f[x]++}static decrement(f,p){let x=0,v=p[0];for(let w=1;w<f.length;w++)p[w]<v&&(v=p[w],x=w);f[x]--}static isFinderPattern(f){let p=f[0]+f[1],x=p+f[2]+f[3],v=p/x;if(v>=st.MIN_FINDER_PATTERN_RATIO&&v<=st.MAX_FINDER_PATTERN_RATIO){let w=Number.MAX_SAFE_INTEGER,C=Number.MIN_SAFE_INTEGER;for(let E of f)E>C&&(C=E),E<w&&(w=E);return C<10*w}return!1}}st.MAX_AVG_VARIANCE=.2,st.MAX_INDIVIDUAL_VARIANCE=.45,st.MIN_FINDER_PATTERN_RATIO=9.5/12,st.MAX_FINDER_PATTERN_RATIO=12.5/14;class zt{constructor(f,p){this.value=f,this.checksumPortion=p}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(f){if(!(f instanceof zt))return!1;const p=f;return this.value===p.value&&this.checksumPortion===p.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class It{constructor(f,p,x,v,w){this.value=f,this.startEnd=p,this.value=f,this.startEnd=p,this.resultPoints=new Array,this.resultPoints.push(new le(x,w)),this.resultPoints.push(new le(v,w))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(f){if(!(f instanceof It))return!1;const p=f;return this.value===p.value}hashCode(){return this.value}}class Ot{constructor(){}static getRSSvalue(f,p,x){let v=0;for(let I of f)v+=I;let w=0,C=0,E=f.length;for(let I=0;I<E-1;I++){let R;for(R=1,C|=1<<I;R<f[I];R++,C&=~(1<<I)){let B=Ot.combins(v-R-1,E-I-2);if(x&&C===0&&v-R-(E-I-1)>=E-I-1&&(B-=Ot.combins(v-R-(E-I),E-I-2)),E-I-1>1){let W=0;for(let Y=v-R-(E-I-2);Y>p;Y--)W+=Ot.combins(v-R-Y-1,E-I-3);B-=W*(E-1-I)}else v-R>p&&B--;w+=B}v-=R}return w}static combins(f,p){let x,v;f-p>p?(v=p,x=f-p):(v=f-p,x=p);let w=1,C=1;for(let E=f;E>x;E--)w*=E,C<=v&&(w/=C,C++);for(;C<=v;)w/=C,C++;return w}}class Wn{static buildBitArray(f){let p=f.length*2-1;f[f.length-1].getRightChar()==null&&(p-=1);let x=12*p,v=new T(x),w=0,E=f[0].getRightChar().getValue();for(let I=11;I>=0;--I)E&1<<I&&v.set(w),w++;for(let I=1;I<f.length;++I){let R=f[I],B=R.getLeftChar().getValue();for(let W=11;W>=0;--W)B&1<<W&&v.set(w),w++;if(R.getRightChar()!=null){let W=R.getRightChar().getValue();for(let Y=11;Y>=0;--Y)W&1<<Y&&v.set(w),w++}}return v}}class mn{constructor(f,p){p?this.decodedInformation=null:(this.finished=f,this.decodedInformation=p)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class Tr{constructor(f){this.newPosition=f}getNewPosition(){return this.newPosition}}class nr extends Tr{constructor(f,p){super(f),this.value=p}getValue(){return this.value}isFNC1(){return this.value===nr.FNC1}}nr.FNC1="$";class Ir extends Tr{constructor(f,p,x){super(f),x?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=p}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class Gr extends Tr{constructor(f,p,x){if(super(f),p<0||p>10||x<0||x>10)throw new O;this.firstDigit=p,this.secondDigit=x}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===Gr.FNC1}isSecondDigitFNC1(){return this.secondDigit===Gr.FNC1}isAnyFNC1(){return this.firstDigit===Gr.FNC1||this.secondDigit===Gr.FNC1}}Gr.FNC1=10;class et{constructor(){}static parseFieldsInGeneralPurpose(f){if(!f)return null;if(f.length<2)throw new z;let p=f.substring(0,2);for(let w of et.TWO_DIGIT_DATA_LENGTH)if(w[0]===p)return w[1]===et.VARIABLE_LENGTH?et.processVariableAI(2,w[2],f):et.processFixedAI(2,w[1],f);if(f.length<3)throw new z;let x=f.substring(0,3);for(let w of et.THREE_DIGIT_DATA_LENGTH)if(w[0]===x)return w[1]===et.VARIABLE_LENGTH?et.processVariableAI(3,w[2],f):et.processFixedAI(3,w[1],f);for(let w of et.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(w[0]===x)return w[1]===et.VARIABLE_LENGTH?et.processVariableAI(4,w[2],f):et.processFixedAI(4,w[1],f);if(f.length<4)throw new z;let v=f.substring(0,4);for(let w of et.FOUR_DIGIT_DATA_LENGTH)if(w[0]===v)return w[1]===et.VARIABLE_LENGTH?et.processVariableAI(4,w[2],f):et.processFixedAI(4,w[1],f);throw new z}static processFixedAI(f,p,x){if(x.length<f)throw new z;let v=x.substring(0,f);if(x.length<f+p)throw new z;let w=x.substring(f,f+p),C=x.substring(f+p),E="("+v+")"+w,I=et.parseFieldsInGeneralPurpose(C);return I==null?E:E+I}static processVariableAI(f,p,x){let v=x.substring(0,f),w;x.length<f+p?w=x.length:w=f+p;let C=x.substring(f,w),E=x.substring(w),I="("+v+")"+C,R=et.parseFieldsInGeneralPurpose(E);return R==null?I:I+R}}et.VARIABLE_LENGTH=[],et.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",et.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",et.VARIABLE_LENGTH,20],["22",et.VARIABLE_LENGTH,29],["30",et.VARIABLE_LENGTH,8],["37",et.VARIABLE_LENGTH,8],["90",et.VARIABLE_LENGTH,30],["91",et.VARIABLE_LENGTH,30],["92",et.VARIABLE_LENGTH,30],["93",et.VARIABLE_LENGTH,30],["94",et.VARIABLE_LENGTH,30],["95",et.VARIABLE_LENGTH,30],["96",et.VARIABLE_LENGTH,30],["97",et.VARIABLE_LENGTH,3],["98",et.VARIABLE_LENGTH,30],["99",et.VARIABLE_LENGTH,30]],et.THREE_DIGIT_DATA_LENGTH=[["240",et.VARIABLE_LENGTH,30],["241",et.VARIABLE_LENGTH,30],["242",et.VARIABLE_LENGTH,6],["250",et.VARIABLE_LENGTH,30],["251",et.VARIABLE_LENGTH,30],["253",et.VARIABLE_LENGTH,17],["254",et.VARIABLE_LENGTH,20],["400",et.VARIABLE_LENGTH,30],["401",et.VARIABLE_LENGTH,30],["402",17],["403",et.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",et.VARIABLE_LENGTH,20],["421",et.VARIABLE_LENGTH,15],["422",3],["423",et.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],et.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",et.VARIABLE_LENGTH,15],["391",et.VARIABLE_LENGTH,18],["392",et.VARIABLE_LENGTH,15],["393",et.VARIABLE_LENGTH,18],["703",et.VARIABLE_LENGTH,30]],et.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",et.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",et.VARIABLE_LENGTH,20],["8003",et.VARIABLE_LENGTH,30],["8004",et.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",et.VARIABLE_LENGTH,30],["8008",et.VARIABLE_LENGTH,12],["8018",18],["8020",et.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",et.VARIABLE_LENGTH,70],["8200",et.VARIABLE_LENGTH,70]];class wi{constructor(f){this.buffer=new Q,this.information=f}decodeAllCodes(f,p){let x=p,v=null;do{let w=this.decodeGeneralPurposeField(x,v),C=et.parseFieldsInGeneralPurpose(w.getNewString());if(C!=null&&f.append(C),w.isRemaining()?v=""+w.getRemainingValue():v=null,x===w.getNewPosition())break;x=w.getNewPosition()}while(!0);return f.toString()}isStillNumeric(f){if(f+7>this.information.getSize())return f+4<=this.information.getSize();for(let p=f;p<f+3;++p)if(this.information.get(p))return!0;return this.information.get(f+3)}decodeNumeric(f){if(f+7>this.information.getSize()){let w=this.extractNumericValueFromBitArray(f,4);return w===0?new Gr(this.information.getSize(),Gr.FNC1,Gr.FNC1):new Gr(this.information.getSize(),w-1,Gr.FNC1)}let p=this.extractNumericValueFromBitArray(f,7),x=(p-8)/11,v=(p-8)%11;return new Gr(f+7,x,v)}extractNumericValueFromBitArray(f,p){return wi.extractNumericValueFromBitArray(this.information,f,p)}static extractNumericValueFromBitArray(f,p,x){let v=0;for(let w=0;w<x;++w)f.get(p+w)&&(v|=1<<x-w-1);return v}decodeGeneralPurposeField(f,p){this.buffer.setLengthToZero(),p!=null&&this.buffer.append(p),this.current.setPosition(f);let x=this.parseBlocks();return x!=null&&x.isRemaining()?new Ir(this.current.getPosition(),this.buffer.toString(),x.getRemainingValue()):new Ir(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let f,p;do{let x=this.current.getPosition();if(this.current.isAlpha()?(p=this.parseAlphaBlock(),f=p.isFinished()):this.current.isIsoIec646()?(p=this.parseIsoIec646Block(),f=p.isFinished()):(p=this.parseNumericBlock(),f=p.isFinished()),!(x!==this.current.getPosition())&&!f)break}while(!f);return p.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let f=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(f.getNewPosition()),f.isFirstDigitFNC1()){let p;return f.isSecondDigitFNC1()?p=new Ir(this.current.getPosition(),this.buffer.toString()):p=new Ir(this.current.getPosition(),this.buffer.toString(),f.getSecondDigit()),new mn(!0,p)}if(this.buffer.append(f.getFirstDigit()),f.isSecondDigitFNC1()){let p=new Ir(this.current.getPosition(),this.buffer.toString());return new mn(!0,p)}this.buffer.append(f.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new mn(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let f=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(f.getNewPosition()),f.isFNC1()){let p=new Ir(this.current.getPosition(),this.buffer.toString());return new mn(!0,p)}this.buffer.append(f.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new mn(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let f=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(f.getNewPosition()),f.isFNC1()){let p=new Ir(this.current.getPosition(),this.buffer.toString());return new mn(!0,p)}this.buffer.append(f.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new mn(!1)}isStillIsoIec646(f){if(f+5>this.information.getSize())return!1;let p=this.extractNumericValueFromBitArray(f,5);if(p>=5&&p<16)return!0;if(f+7>this.information.getSize())return!1;let x=this.extractNumericValueFromBitArray(f,7);if(x>=64&&x<116)return!0;if(f+8>this.information.getSize())return!1;let v=this.extractNumericValueFromBitArray(f,8);return v>=232&&v<253}decodeIsoIec646(f){let p=this.extractNumericValueFromBitArray(f,5);if(p===15)return new nr(f+5,nr.FNC1);if(p>=5&&p<15)return new nr(f+5,"0"+(p-5));let x=this.extractNumericValueFromBitArray(f,7);if(x>=64&&x<90)return new nr(f+7,""+(x+1));if(x>=90&&x<116)return new nr(f+7,""+(x+7));let v=this.extractNumericValueFromBitArray(f,8),w;switch(v){case 232:w="!";break;case 233:w='"';break;case 234:w="%";break;case 235:w="&";break;case 236:w="'";break;case 237:w="(";break;case 238:w=")";break;case 239:w="*";break;case 240:w="+";break;case 241:w=",";break;case 242:w="-";break;case 243:w=".";break;case 244:w="/";break;case 245:w=":";break;case 246:w=";";break;case 247:w="<";break;case 248:w="=";break;case 249:w=">";break;case 250:w="?";break;case 251:w="_";break;case 252:w=" ";break;default:throw new O}return new nr(f+8,w)}isStillAlpha(f){if(f+5>this.information.getSize())return!1;let p=this.extractNumericValueFromBitArray(f,5);if(p>=5&&p<16)return!0;if(f+6>this.information.getSize())return!1;let x=this.extractNumericValueFromBitArray(f,6);return x>=16&&x<63}decodeAlphanumeric(f){let p=this.extractNumericValueFromBitArray(f,5);if(p===15)return new nr(f+5,nr.FNC1);if(p>=5&&p<15)return new nr(f+5,"0"+(p-5));let x=this.extractNumericValueFromBitArray(f,6);if(x>=32&&x<58)return new nr(f+6,""+(x+33));let v;switch(x){case 58:v="*";break;case 59:v=",";break;case 60:v="-";break;case 61:v=".";break;case 62:v="/";break;default:throw new St("Decoding invalid alphanumeric value: "+x)}return new nr(f+6,v)}isAlphaTo646ToAlphaLatch(f){if(f+1>this.information.getSize())return!1;for(let p=0;p<5&&p+f<this.information.getSize();++p)if(p===2){if(!this.information.get(f+2))return!1}else if(this.information.get(f+p))return!1;return!0}isAlphaOr646ToNumericLatch(f){if(f+3>this.information.getSize())return!1;for(let p=f;p<f+3;++p)if(this.information.get(p))return!1;return!0}isNumericToAlphaNumericLatch(f){if(f+1>this.information.getSize())return!1;for(let p=0;p<4&&p+f<this.information.getSize();++p)if(this.information.get(f+p))return!1;return!0}}class Qi{constructor(f){this.information=f,this.generalDecoder=new wi(f)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class ws extends Qi{constructor(f){super(f)}encodeCompressedGtin(f,p){f.append("(01)");let x=f.length();f.append("9"),this.encodeCompressedGtinWithoutAI(f,p,x)}encodeCompressedGtinWithoutAI(f,p,x){for(let v=0;v<4;++v){let w=this.getGeneralDecoder().extractNumericValueFromBitArray(p+10*v,10);w/100===0&&f.append("0"),w/10===0&&f.append("0"),f.append(w)}ws.appendCheckDigit(f,x)}static appendCheckDigit(f,p){let x=0;for(let v=0;v<13;v++){let w=f.charAt(v+p).charCodeAt(0)-48;x+=v&1?w:3*w}x=10-x%10,x===10&&(x=0),f.append(x)}}ws.GTIN_SIZE=40;class Dl extends ws{constructor(f){super(f)}parseInformation(){let f=new Q;f.append("(01)");let p=f.length(),x=this.getGeneralDecoder().extractNumericValueFromBitArray(Dl.HEADER_SIZE,4);return f.append(x),this.encodeCompressedGtinWithoutAI(f,Dl.HEADER_SIZE+4,p),this.getGeneralDecoder().decodeAllCodes(f,Dl.HEADER_SIZE+44)}}Dl.HEADER_SIZE=4;class Ou extends Qi{constructor(f){super(f)}parseInformation(){let f=new Q;return this.getGeneralDecoder().decodeAllCodes(f,Ou.HEADER_SIZE)}}Ou.HEADER_SIZE=5;class Du extends ws{constructor(f){super(f)}encodeCompressedWeight(f,p,x){let v=this.getGeneralDecoder().extractNumericValueFromBitArray(p,x);this.addWeightCode(f,v);let w=this.checkWeight(v),C=1e5;for(let E=0;E<5;++E)w/C===0&&f.append("0"),C/=10;f.append(w)}}class Wa extends Du{constructor(f){super(f)}parseInformation(){if(this.getInformation().getSize()!=Wa.HEADER_SIZE+Du.GTIN_SIZE+Wa.WEIGHT_SIZE)throw new z;let f=new Q;return this.encodeCompressedGtin(f,Wa.HEADER_SIZE),this.encodeCompressedWeight(f,Wa.HEADER_SIZE+Du.GTIN_SIZE,Wa.WEIGHT_SIZE),f.toString()}}Wa.HEADER_SIZE=5,Wa.WEIGHT_SIZE=15;class tw extends Wa{constructor(f){super(f)}addWeightCode(f,p){f.append("(3103)")}checkWeight(f){return f}}class nw extends Wa{constructor(f){super(f)}addWeightCode(f,p){p<1e4?f.append("(3202)"):f.append("(3203)")}checkWeight(f){return f<1e4?f:f-1e4}}class qa extends ws{constructor(f){super(f)}parseInformation(){if(this.getInformation().getSize()<qa.HEADER_SIZE+ws.GTIN_SIZE)throw new z;let f=new Q;this.encodeCompressedGtin(f,qa.HEADER_SIZE);let p=this.getGeneralDecoder().extractNumericValueFromBitArray(qa.HEADER_SIZE+ws.GTIN_SIZE,qa.LAST_DIGIT_SIZE);f.append("(392"),f.append(p),f.append(")");let x=this.getGeneralDecoder().decodeGeneralPurposeField(qa.HEADER_SIZE+ws.GTIN_SIZE+qa.LAST_DIGIT_SIZE,null);return f.append(x.getNewString()),f.toString()}}qa.HEADER_SIZE=8,qa.LAST_DIGIT_SIZE=2;class rs extends ws{constructor(f){super(f)}parseInformation(){if(this.getInformation().getSize()<rs.HEADER_SIZE+ws.GTIN_SIZE)throw new z;let f=new Q;this.encodeCompressedGtin(f,rs.HEADER_SIZE);let p=this.getGeneralDecoder().extractNumericValueFromBitArray(rs.HEADER_SIZE+ws.GTIN_SIZE,rs.LAST_DIGIT_SIZE);f.append("(393"),f.append(p),f.append(")");let x=this.getGeneralDecoder().extractNumericValueFromBitArray(rs.HEADER_SIZE+ws.GTIN_SIZE+rs.LAST_DIGIT_SIZE,rs.FIRST_THREE_DIGITS_SIZE);x/100==0&&f.append("0"),x/10==0&&f.append("0"),f.append(x);let v=this.getGeneralDecoder().decodeGeneralPurposeField(rs.HEADER_SIZE+ws.GTIN_SIZE+rs.LAST_DIGIT_SIZE+rs.FIRST_THREE_DIGITS_SIZE,null);return f.append(v.getNewString()),f.toString()}}rs.HEADER_SIZE=8,rs.LAST_DIGIT_SIZE=2,rs.FIRST_THREE_DIGITS_SIZE=10;class _n extends Du{constructor(f,p,x){super(f),this.dateCode=x,this.firstAIdigits=p}parseInformation(){if(this.getInformation().getSize()!=_n.HEADER_SIZE+_n.GTIN_SIZE+_n.WEIGHT_SIZE+_n.DATE_SIZE)throw new z;let f=new Q;return this.encodeCompressedGtin(f,_n.HEADER_SIZE),this.encodeCompressedWeight(f,_n.HEADER_SIZE+_n.GTIN_SIZE,_n.WEIGHT_SIZE),this.encodeCompressedDate(f,_n.HEADER_SIZE+_n.GTIN_SIZE+_n.WEIGHT_SIZE),f.toString()}encodeCompressedDate(f,p){let x=this.getGeneralDecoder().extractNumericValueFromBitArray(p,_n.DATE_SIZE);if(x==38400)return;f.append("("),f.append(this.dateCode),f.append(")");let v=x%32;x/=32;let w=x%12+1;x/=12;let C=x;C/10==0&&f.append("0"),f.append(C),w/10==0&&f.append("0"),f.append(w),v/10==0&&f.append("0"),f.append(v)}addWeightCode(f,p){f.append("("),f.append(this.firstAIdigits),f.append(p/1e5),f.append(")")}checkWeight(f){return f%1e5}}_n.HEADER_SIZE=8,_n.WEIGHT_SIZE=20,_n.DATE_SIZE=16;function rd(H){try{if(H.get(1))return new Dl(H);if(!H.get(2))return new Ou(H);switch(wi.extractNumericValueFromBitArray(H,1,4)){case 4:return new tw(H);case 5:return new nw(H)}switch(wi.extractNumericValueFromBitArray(H,1,5)){case 12:return new qa(H);case 13:return new rs(H)}switch(wi.extractNumericValueFromBitArray(H,1,7)){case 56:return new _n(H,"310","11");case 57:return new _n(H,"320","11");case 58:return new _n(H,"310","13");case 59:return new _n(H,"320","13");case 60:return new _n(H,"310","15");case 61:return new _n(H,"320","15");case 62:return new _n(H,"310","17");case 63:return new _n(H,"320","17")}}catch(f){throw console.log(f),new St("unknown decoder: "+H)}}class Zi{constructor(f,p,x,v){this.leftchar=f,this.rightchar=p,this.finderpattern=x,this.maybeLast=v}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(f,p){return f instanceof Zi?Zi.equalsOrNull(f.leftchar,p.leftchar)&&Zi.equalsOrNull(f.rightchar,p.rightchar)&&Zi.equalsOrNull(f.finderpattern,p.finderpattern):!1}static equalsOrNull(f,p){return f===null?p===null:Zi.equals(f,p)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class Lh{constructor(f,p,x){this.pairs=f,this.rowNumber=p,this.wasReversed=x}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(f){return this.checkEqualitity(this,f)}toString(){return"{ "+this.pairs+" }"}equals(f,p){return f instanceof Lh?this.checkEqualitity(f,p)&&f.wasReversed===p.wasReversed:!1}checkEqualitity(f,p){if(!f||!p)return;let x;return f.forEach((v,w)=>{p.forEach(C=>{v.getLeftChar().getValue()===C.getLeftChar().getValue()&&v.getRightChar().getValue()===C.getRightChar().getValue()&&v.getFinderPatter().getValue()===C.getFinderPatter().getValue()&&(x=!0)})}),x}}class Me extends st{constructor(f){super(...arguments),this.pairs=new Array(Me.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=f===!0}decodeRow(f,p,x){this.pairs.length=0,this.startFromEven=!1;try{return Me.constructResult(this.decodeRow2pairs(f,p))}catch(v){this.verbose&&console.log(v)}return this.pairs.length=0,this.startFromEven=!0,Me.constructResult(this.decodeRow2pairs(f,p))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(f,p){let x=!1;for(;!x;)try{this.pairs.push(this.retrieveNextPair(p,this.pairs,f))}catch(w){if(w instanceof z){if(!this.pairs.length)throw new z;x=!0}}if(this.checkChecksum())return this.pairs;let v;if(this.rows.length?v=!0:v=!1,this.storeRow(f,!1),v){let w=this.checkRowsBoolean(!1);if(w!=null||(w=this.checkRowsBoolean(!0),w!=null))return w}throw new z}checkRowsBoolean(f){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,f&&(this.rows=this.rows.reverse());let p=null;try{p=this.checkRows(new Array,0)}catch(x){this.verbose&&console.log(x)}return f&&(this.rows=this.rows.reverse()),p}checkRows(f,p){for(let x=p;x<this.rows.length;x++){let v=this.rows[x];this.pairs.length=0;for(let C of f)this.pairs.push(C.getPairs());if(this.pairs.push(v.getPairs()),!Me.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let w=new Array(f);w.push(v);try{return this.checkRows(w,x+1)}catch(C){this.verbose&&console.log(C)}}throw new z}static isValidSequence(f){for(let p of Me.FINDER_PATTERN_SEQUENCES){if(f.length>p.length)continue;let x=!0;for(let v=0;v<f.length;v++)if(f[v].getFinderPattern().getValue()!=p[v]){x=!1;break}if(x)return!0}return!1}storeRow(f,p){let x=0,v=!1,w=!1;for(;x<this.rows.length;){let C=this.rows[x];if(C.getRowNumber()>f){w=C.isEquivalent(this.pairs);break}v=C.isEquivalent(this.pairs),x++}w||v||Me.isPartialRow(this.pairs,this.rows)||(this.rows.push(x,new Lh(this.pairs,f,p)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(f,p){for(let x of p)if(x.getPairs().length!==f.length){for(let v of x.getPairs())for(let w of f)if(Zi.equals(v,w))break}}static isPartialRow(f,p){for(let x of p){let v=!0;for(let w of f){let C=!1;for(let E of x.getPairs())if(w.equals(E)){C=!0;break}if(!C){v=!1;break}}if(v)return!0}return!1}getRows(){return this.rows}static constructResult(f){let p=Wn.buildBitArray(f),v=rd(p).parseInformation(),w=f[0].getFinderPattern().getResultPoints(),C=f[f.length-1].getFinderPattern().getResultPoints(),E=[w[0],w[1],C[0],C[1]];return new be(v,null,null,E,_e.RSS_EXPANDED,null)}checkChecksum(){let f=this.pairs.get(0),p=f.getLeftChar(),x=f.getRightChar();if(x==null)return!1;let v=x.getChecksumPortion(),w=2;for(let E=1;E<this.pairs.size();++E){let I=this.pairs.get(E);v+=I.getLeftChar().getChecksumPortion(),w++;let R=I.getRightChar();R!=null&&(v+=R.getChecksumPortion(),w++)}return v%=211,211*(w-4)+v==p.getValue()}static getNextSecondBar(f,p){let x;return f.get(p)?(x=f.getNextUnset(p),x=f.getNextSet(x)):(x=f.getNextSet(p),x=f.getNextUnset(x)),x}retrieveNextPair(f,p,x){let v=p.length%2==0;this.startFromEven&&(v=!v);let w,C=!0,E=-1;do this.findNextPair(f,p,E),w=this.parseFoundFinderPattern(f,x,v),w==null?E=Me.getNextSecondBar(f,this.startEnd[0]):C=!1;while(C);let I=this.decodeDataCharacter(f,w,v,!0);if(!this.isEmptyPair(p)&&p[p.length-1].mustBeLast())throw new z;let R;try{R=this.decodeDataCharacter(f,w,v,!1)}catch(B){R=null,this.verbose&&console.log(B)}return new Zi(I,R,w,!0)}isEmptyPair(f){return f.length===0}findNextPair(f,p,x){let v=this.getDecodeFinderCounters();v[0]=0,v[1]=0,v[2]=0,v[3]=0;let w=f.getSize(),C;x>=0?C=x:this.isEmptyPair(p)?C=0:C=p[p.length-1].getFinderPattern().getStartEnd()[1];let E=p.length%2!=0;this.startFromEven&&(E=!E);let I=!1;for(;C<w&&(I=!f.get(C),!!I);)C++;let R=0,B=C;for(let W=C;W<w;W++)if(f.get(W)!=I)v[R]++;else{if(R==3){if(E&&Me.reverseCounters(v),Me.isFinderPattern(v)){this.startEnd[0]=B,this.startEnd[1]=W;return}E&&Me.reverseCounters(v),B+=v[0]+v[1],v[0]=v[2],v[1]=v[3],v[2]=0,v[3]=0,R--}else R++;v[R]=1,I=!I}throw new z}static reverseCounters(f){let p=f.length;for(let x=0;x<p/2;++x){let v=f[x];f[x]=f[p-x-1],f[p-x-1]=v}}parseFoundFinderPattern(f,p,x){let v,w,C;if(x){let R=this.startEnd[0]-1;for(;R>=0&&!f.get(R);)R--;R++,v=this.startEnd[0]-R,w=R,C=this.startEnd[1]}else w=this.startEnd[0],C=f.getNextUnset(this.startEnd[1]+1),v=C-this.startEnd[1];let E=this.getDecodeFinderCounters();j.arraycopy(E,0,E,1,E.length-1),E[0]=v;let I;try{I=this.parseFinderValue(E,Me.FINDER_PATTERNS)}catch{return null}return new It(I,[w,C],w,C,p)}decodeDataCharacter(f,p,x,v){let w=this.getDataCharacterCounters();for(let wn=0;wn<w.length;wn++)w[wn]=0;if(v)Me.recordPatternInReverse(f,p.getStartEnd()[0],w);else{Me.recordPattern(f,p.getStartEnd()[1],w);for(let wn=0,is=w.length-1;wn<is;wn++,is--){let ya=w[wn];w[wn]=w[is],w[is]=ya}}let C=17,E=qe.sum(new Int32Array(w))/C,I=(p.getStartEnd()[1]-p.getStartEnd()[0])/15;if(Math.abs(E-I)/I>.3)throw new z;let R=this.getOddCounts(),B=this.getEvenCounts(),W=this.getOddRoundingErrors(),Y=this.getEvenRoundingErrors();for(let wn=0;wn<w.length;wn++){let is=1*w[wn]/E,ya=is+.5;if(ya<1){if(is<.3)throw new z;ya=1}else if(ya>8){if(is>8.7)throw new z;ya=8}let Bu=wn/2;wn&1?(B[Bu]=ya,Y[Bu]=is-ya):(R[Bu]=ya,W[Bu]=is-ya)}this.adjustOddEvenCounts(C);let ee=4*p.getValue()+(x?0:2)+(v?0:1)-1,oe=0,ce=0;for(let wn=R.length-1;wn>=0;wn--){if(Me.isNotA1left(p,x,v)){let is=Me.WEIGHTS[ee][2*wn];ce+=R[wn]*is}oe+=R[wn]}let ge=0;for(let wn=B.length-1;wn>=0;wn--)if(Me.isNotA1left(p,x,v)){let is=Me.WEIGHTS[ee][2*wn+1];ge+=B[wn]*is}let Ae=ce+ge;if(oe&1||oe>13||oe<4)throw new z;let $e=(13-oe)/2,Ve=Me.SYMBOL_WIDEST[$e],Le=9-Ve,Gt=Ot.getRSSvalue(R,Ve,!0),Dt=Ot.getRSSvalue(B,Le,!1),Zs=Me.EVEN_TOTAL_SUBSET[$e],ji=Me.GSUM[$e],Js=Gt*Zs+Dt+ji;return new zt(Js,Ae)}static isNotA1left(f,p,x){return!(f.getValue()==0&&p&&x)}adjustOddEvenCounts(f){let p=qe.sum(new Int32Array(this.getOddCounts())),x=qe.sum(new Int32Array(this.getEvenCounts())),v=!1,w=!1;p>13?w=!0:p<4&&(v=!0);let C=!1,E=!1;x>13?E=!0:x<4&&(C=!0);let I=p+x-f,R=(p&1)==1,B=(x&1)==0;if(I==1)if(R){if(B)throw new z;w=!0}else{if(!B)throw new z;E=!0}else if(I==-1)if(R){if(B)throw new z;v=!0}else{if(!B)throw new z;C=!0}else if(I==0){if(R){if(!B)throw new z;p<x?(v=!0,E=!0):(w=!0,C=!0)}else if(B)throw new z}else throw new z;if(v){if(w)throw new z;Me.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(w&&Me.decrement(this.getOddCounts(),this.getOddRoundingErrors()),C){if(E)throw new z;Me.increment(this.getEvenCounts(),this.getOddRoundingErrors())}E&&Me.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Me.SYMBOL_WIDEST=[7,5,4,3,1],Me.EVEN_TOTAL_SUBSET=[4,20,52,104,204],Me.GSUM=[0,348,1388,2948,3988],Me.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],Me.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],Me.FINDER_PAT_A=0,Me.FINDER_PAT_B=1,Me.FINDER_PAT_C=2,Me.FINDER_PAT_D=3,Me.FINDER_PAT_E=4,Me.FINDER_PAT_F=5,Me.FINDER_PATTERN_SEQUENCES=[[Me.FINDER_PAT_A,Me.FINDER_PAT_A],[Me.FINDER_PAT_A,Me.FINDER_PAT_B,Me.FINDER_PAT_B],[Me.FINDER_PAT_A,Me.FINDER_PAT_C,Me.FINDER_PAT_B,Me.FINDER_PAT_D],[Me.FINDER_PAT_A,Me.FINDER_PAT_E,Me.FINDER_PAT_B,Me.FINDER_PAT_D,Me.FINDER_PAT_C],[Me.FINDER_PAT_A,Me.FINDER_PAT_E,Me.FINDER_PAT_B,Me.FINDER_PAT_D,Me.FINDER_PAT_D,Me.FINDER_PAT_F],[Me.FINDER_PAT_A,Me.FINDER_PAT_E,Me.FINDER_PAT_B,Me.FINDER_PAT_D,Me.FINDER_PAT_E,Me.FINDER_PAT_F,Me.FINDER_PAT_F],[Me.FINDER_PAT_A,Me.FINDER_PAT_A,Me.FINDER_PAT_B,Me.FINDER_PAT_B,Me.FINDER_PAT_C,Me.FINDER_PAT_C,Me.FINDER_PAT_D,Me.FINDER_PAT_D],[Me.FINDER_PAT_A,Me.FINDER_PAT_A,Me.FINDER_PAT_B,Me.FINDER_PAT_B,Me.FINDER_PAT_C,Me.FINDER_PAT_C,Me.FINDER_PAT_D,Me.FINDER_PAT_E,Me.FINDER_PAT_E],[Me.FINDER_PAT_A,Me.FINDER_PAT_A,Me.FINDER_PAT_B,Me.FINDER_PAT_B,Me.FINDER_PAT_C,Me.FINDER_PAT_C,Me.FINDER_PAT_D,Me.FINDER_PAT_E,Me.FINDER_PAT_F,Me.FINDER_PAT_F],[Me.FINDER_PAT_A,Me.FINDER_PAT_A,Me.FINDER_PAT_B,Me.FINDER_PAT_B,Me.FINDER_PAT_C,Me.FINDER_PAT_D,Me.FINDER_PAT_D,Me.FINDER_PAT_E,Me.FINDER_PAT_E,Me.FINDER_PAT_F,Me.FINDER_PAT_F]],Me.MAX_PAIRS=11;class rw extends zt{constructor(f,p,x){super(f,p),this.count=0,this.finderPattern=x}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Ln extends st{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(f,p,x){const v=this.decodePair(p,!1,f,x);Ln.addOrTally(this.possibleLeftPairs,v),p.reverse();let w=this.decodePair(p,!0,f,x);Ln.addOrTally(this.possibleRightPairs,w),p.reverse();for(let C of this.possibleLeftPairs)if(C.getCount()>1){for(let E of this.possibleRightPairs)if(E.getCount()>1&&Ln.checkChecksum(C,E))return Ln.constructResult(C,E)}throw new z}static addOrTally(f,p){if(p==null)return;let x=!1;for(let v of f)if(v.getValue()===p.getValue()){v.incrementCount(),x=!0;break}x||f.push(p)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(f,p){let x=4537077*f.getValue()+p.getValue(),v=new String(x).toString(),w=new Q;for(let R=13-v.length;R>0;R--)w.append("0");w.append(v);let C=0;for(let R=0;R<13;R++){let B=w.charAt(R).charCodeAt(0)-48;C+=R&1?B:3*B}C=10-C%10,C===10&&(C=0),w.append(C.toString());let E=f.getFinderPattern().getResultPoints(),I=p.getFinderPattern().getResultPoints();return new be(w.toString(),null,0,[E[0],E[1],I[0],I[1]],_e.RSS_14,new Date().getTime())}static checkChecksum(f,p){let x=(f.getChecksumPortion()+16*p.getChecksumPortion())%79,v=9*f.getFinderPattern().getValue()+p.getFinderPattern().getValue();return v>72&&v--,v>8&&v--,x===v}decodePair(f,p,x,v){try{let w=this.findFinderPattern(f,p),C=this.parseFoundFinderPattern(f,x,p,w),E=v==null?null:v.get(M.NEED_RESULT_POINT_CALLBACK);if(E!=null){let B=(w[0]+w[1])/2;p&&(B=f.getSize()-1-B),E.foundPossibleResultPoint(new le(B,x))}let I=this.decodeDataCharacter(f,C,!0),R=this.decodeDataCharacter(f,C,!1);return new rw(1597*I.getValue()+R.getValue(),I.getChecksumPortion()+4*R.getChecksumPortion(),C)}catch{return null}}decodeDataCharacter(f,p,x){let v=this.getDataCharacterCounters();for(let ge=0;ge<v.length;ge++)v[ge]=0;if(x)en.recordPatternInReverse(f,p.getStartEnd()[0],v);else{en.recordPattern(f,p.getStartEnd()[1]+1,v);for(let ge=0,Ae=v.length-1;ge<Ae;ge++,Ae--){let $e=v[ge];v[ge]=v[Ae],v[Ae]=$e}}let w=x?16:15,C=qe.sum(new Int32Array(v))/w,E=this.getOddCounts(),I=this.getEvenCounts(),R=this.getOddRoundingErrors(),B=this.getEvenRoundingErrors();for(let ge=0;ge<v.length;ge++){let Ae=v[ge]/C,$e=Math.floor(Ae+.5);$e<1?$e=1:$e>8&&($e=8);let Ve=Math.floor(ge/2);ge&1?(I[Ve]=$e,B[Ve]=Ae-$e):(E[Ve]=$e,R[Ve]=Ae-$e)}this.adjustOddEvenCounts(x,w);let W=0,Y=0;for(let ge=E.length-1;ge>=0;ge--)Y*=9,Y+=E[ge],W+=E[ge];let ee=0,oe=0;for(let ge=I.length-1;ge>=0;ge--)ee*=9,ee+=I[ge],oe+=I[ge];let ce=Y+3*ee;if(x){if(W&1||W>12||W<4)throw new z;let ge=(12-W)/2,Ae=Ln.OUTSIDE_ODD_WIDEST[ge],$e=9-Ae,Ve=Ot.getRSSvalue(E,Ae,!1),Le=Ot.getRSSvalue(I,$e,!0),Gt=Ln.OUTSIDE_EVEN_TOTAL_SUBSET[ge],Dt=Ln.OUTSIDE_GSUM[ge];return new zt(Ve*Gt+Le+Dt,ce)}else{if(oe&1||oe>10||oe<4)throw new z;let ge=(10-oe)/2,Ae=Ln.INSIDE_ODD_WIDEST[ge],$e=9-Ae,Ve=Ot.getRSSvalue(E,Ae,!0),Le=Ot.getRSSvalue(I,$e,!1),Gt=Ln.INSIDE_ODD_TOTAL_SUBSET[ge],Dt=Ln.INSIDE_GSUM[ge];return new zt(Le*Gt+Ve+Dt,ce)}}findFinderPattern(f,p){let x=this.getDecodeFinderCounters();x[0]=0,x[1]=0,x[2]=0,x[3]=0;let v=f.getSize(),w=!1,C=0;for(;C<v&&(w=!f.get(C),p!==w);)C++;let E=0,I=C;for(let R=C;R<v;R++)if(f.get(R)!==w)x[E]++;else{if(E===3){if(st.isFinderPattern(x))return[I,R];I+=x[0]+x[1],x[0]=x[2],x[1]=x[3],x[2]=0,x[3]=0,E--}else E++;x[E]=1,w=!w}throw new z}parseFoundFinderPattern(f,p,x,v){let w=f.get(v[0]),C=v[0]-1;for(;C>=0&&w!==f.get(C);)C--;C++;const E=v[0]-C,I=this.getDecodeFinderCounters(),R=new Int32Array(I.length);j.arraycopy(I,0,R,1,I.length-1),R[0]=E;const B=this.parseFinderValue(R,Ln.FINDER_PATTERNS);let W=C,Y=v[1];return x&&(W=f.getSize()-1-W,Y=f.getSize()-1-Y),new It(B,[C,v[1]],W,Y,p)}adjustOddEvenCounts(f,p){let x=qe.sum(new Int32Array(this.getOddCounts())),v=qe.sum(new Int32Array(this.getEvenCounts())),w=!1,C=!1,E=!1,I=!1;f?(x>12?C=!0:x<4&&(w=!0),v>12?I=!0:v<4&&(E=!0)):(x>11?C=!0:x<5&&(w=!0),v>10?I=!0:v<4&&(E=!0));let R=x+v-p,B=(x&1)===(f?1:0),W=(v&1)===1;if(R===1)if(B){if(W)throw new z;C=!0}else{if(!W)throw new z;I=!0}else if(R===-1)if(B){if(W)throw new z;w=!0}else{if(!W)throw new z;E=!0}else if(R===0){if(B){if(!W)throw new z;x<v?(w=!0,I=!0):(C=!0,E=!0)}else if(W)throw new z}else throw new z;if(w){if(C)throw new z;st.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(C&&st.decrement(this.getOddCounts(),this.getOddRoundingErrors()),E){if(I)throw new z;st.increment(this.getEvenCounts(),this.getOddRoundingErrors())}I&&st.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Ln.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Ln.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Ln.OUTSIDE_GSUM=[0,161,961,2015,2715],Ln.INSIDE_GSUM=[0,336,1036,1516],Ln.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Ln.INSIDE_ODD_WIDEST=[2,4,6,8],Ln.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Rl extends en{constructor(f,p){super(),this.readers=[],this.verbose=p===!0;const x=f?f.get(M.POSSIBLE_FORMATS):null,v=f&&f.get(M.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;x?((x.includes(_e.EAN_13)||x.includes(_e.UPC_A)||x.includes(_e.EAN_8)||x.includes(_e.UPC_E))&&this.readers.push(new nt(f)),x.includes(_e.CODE_39)&&this.readers.push(new an(v)),x.includes(_e.CODE_128)&&this.readers.push(new Ue),x.includes(_e.ITF)&&this.readers.push(new Kt),x.includes(_e.RSS_14)&&this.readers.push(new Ln),x.includes(_e.RSS_EXPANDED)&&this.readers.push(new Me(this.verbose))):(this.readers.push(new nt(f)),this.readers.push(new an),this.readers.push(new nt(f)),this.readers.push(new Ue),this.readers.push(new Kt),this.readers.push(new Ln),this.readers.push(new Me(this.verbose)))}decodeRow(f,p,x){for(let v=0;v<this.readers.length;v++)try{return this.readers[v].decodeRow(f,p,x)}catch{}throw new z}reset(){this.readers.forEach(f=>f.reset())}}class sd extends ye{constructor(f=500,p){super(new Rl(p),f,p)}}class tn{constructor(f,p,x){this.ecCodewords=f,this.ecBlocks=[p],x&&this.ecBlocks.push(x)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class Qt{constructor(f,p){this.count=f,this.dataCodewords=p}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Wt{constructor(f,p,x,v,w,C){this.versionNumber=f,this.symbolSizeRows=p,this.symbolSizeColumns=x,this.dataRegionSizeRows=v,this.dataRegionSizeColumns=w,this.ecBlocks=C;let E=0;const I=C.getECCodewords(),R=C.getECBlocks();for(let B of R)E+=B.getCount()*(B.getDataCodewords()+I);this.totalCodewords=E}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(f,p){if(f&1||p&1)throw new O;for(let x of Wt.VERSIONS)if(x.symbolSizeRows===f&&x.symbolSizeColumns===p)return x;throw new O}toString(){return""+this.versionNumber}static buildVersions(){return[new Wt(1,10,10,8,8,new tn(5,new Qt(1,3))),new Wt(2,12,12,10,10,new tn(7,new Qt(1,5))),new Wt(3,14,14,12,12,new tn(10,new Qt(1,8))),new Wt(4,16,16,14,14,new tn(12,new Qt(1,12))),new Wt(5,18,18,16,16,new tn(14,new Qt(1,18))),new Wt(6,20,20,18,18,new tn(18,new Qt(1,22))),new Wt(7,22,22,20,20,new tn(20,new Qt(1,30))),new Wt(8,24,24,22,22,new tn(24,new Qt(1,36))),new Wt(9,26,26,24,24,new tn(28,new Qt(1,44))),new Wt(10,32,32,14,14,new tn(36,new Qt(1,62))),new Wt(11,36,36,16,16,new tn(42,new Qt(1,86))),new Wt(12,40,40,18,18,new tn(48,new Qt(1,114))),new Wt(13,44,44,20,20,new tn(56,new Qt(1,144))),new Wt(14,48,48,22,22,new tn(68,new Qt(1,174))),new Wt(15,52,52,24,24,new tn(42,new Qt(2,102))),new Wt(16,64,64,14,14,new tn(56,new Qt(2,140))),new Wt(17,72,72,16,16,new tn(36,new Qt(4,92))),new Wt(18,80,80,18,18,new tn(48,new Qt(4,114))),new Wt(19,88,88,20,20,new tn(56,new Qt(4,144))),new Wt(20,96,96,22,22,new tn(68,new Qt(4,174))),new Wt(21,104,104,24,24,new tn(56,new Qt(6,136))),new Wt(22,120,120,18,18,new tn(68,new Qt(6,175))),new Wt(23,132,132,20,20,new tn(62,new Qt(8,163))),new Wt(24,144,144,22,22,new tn(62,new Qt(8,156),new Qt(2,155))),new Wt(25,8,18,6,16,new tn(7,new Qt(1,5))),new Wt(26,8,32,6,14,new tn(11,new Qt(1,10))),new Wt(27,12,26,10,24,new tn(14,new Qt(1,16))),new Wt(28,12,36,10,16,new tn(18,new Qt(1,22))),new Wt(29,16,36,14,16,new tn(24,new Qt(1,32))),new Wt(30,16,48,14,22,new tn(28,new Qt(1,49)))]}}Wt.VERSIONS=Wt.buildVersions();class Bh{constructor(f){const p=f.getHeight();if(p<8||p>144||p&1)throw new O;this.version=Bh.readVersion(f),this.mappingBitMatrix=this.extractDataRegion(f),this.readMappingMatrix=new U(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(f){const p=f.getHeight(),x=f.getWidth();return Wt.getVersionForDimensions(p,x)}readCodewords(){const f=new Int8Array(this.version.getTotalCodewords());let p=0,x=4,v=0;const w=this.mappingBitMatrix.getHeight(),C=this.mappingBitMatrix.getWidth();let E=!1,I=!1,R=!1,B=!1;do if(x===w&&v===0&&!E)f[p++]=this.readCorner1(w,C)&255,x-=2,v+=2,E=!0;else if(x===w-2&&v===0&&C&3&&!I)f[p++]=this.readCorner2(w,C)&255,x-=2,v+=2,I=!0;else if(x===w+4&&v===2&&!(C&7)&&!R)f[p++]=this.readCorner3(w,C)&255,x-=2,v+=2,R=!0;else if(x===w-2&&v===0&&(C&7)===4&&!B)f[p++]=this.readCorner4(w,C)&255,x-=2,v+=2,B=!0;else{do x<w&&v>=0&&!this.readMappingMatrix.get(v,x)&&(f[p++]=this.readUtah(x,v,w,C)&255),x-=2,v+=2;while(x>=0&&v<C);x+=1,v+=3;do x>=0&&v<C&&!this.readMappingMatrix.get(v,x)&&(f[p++]=this.readUtah(x,v,w,C)&255),x+=2,v-=2;while(x<w&&v>=0);x+=3,v+=1}while(x<w||v<C);if(p!==this.version.getTotalCodewords())throw new O;return f}readModule(f,p,x,v){return f<0&&(f+=x,p+=4-(x+4&7)),p<0&&(p+=v,f+=4-(v+4&7)),this.readMappingMatrix.set(p,f),this.mappingBitMatrix.get(p,f)}readUtah(f,p,x,v){let w=0;return this.readModule(f-2,p-2,x,v)&&(w|=1),w<<=1,this.readModule(f-2,p-1,x,v)&&(w|=1),w<<=1,this.readModule(f-1,p-2,x,v)&&(w|=1),w<<=1,this.readModule(f-1,p-1,x,v)&&(w|=1),w<<=1,this.readModule(f-1,p,x,v)&&(w|=1),w<<=1,this.readModule(f,p-2,x,v)&&(w|=1),w<<=1,this.readModule(f,p-1,x,v)&&(w|=1),w<<=1,this.readModule(f,p,x,v)&&(w|=1),w}readCorner1(f,p){let x=0;return this.readModule(f-1,0,f,p)&&(x|=1),x<<=1,this.readModule(f-1,1,f,p)&&(x|=1),x<<=1,this.readModule(f-1,2,f,p)&&(x|=1),x<<=1,this.readModule(0,p-2,f,p)&&(x|=1),x<<=1,this.readModule(0,p-1,f,p)&&(x|=1),x<<=1,this.readModule(1,p-1,f,p)&&(x|=1),x<<=1,this.readModule(2,p-1,f,p)&&(x|=1),x<<=1,this.readModule(3,p-1,f,p)&&(x|=1),x}readCorner2(f,p){let x=0;return this.readModule(f-3,0,f,p)&&(x|=1),x<<=1,this.readModule(f-2,0,f,p)&&(x|=1),x<<=1,this.readModule(f-1,0,f,p)&&(x|=1),x<<=1,this.readModule(0,p-4,f,p)&&(x|=1),x<<=1,this.readModule(0,p-3,f,p)&&(x|=1),x<<=1,this.readModule(0,p-2,f,p)&&(x|=1),x<<=1,this.readModule(0,p-1,f,p)&&(x|=1),x<<=1,this.readModule(1,p-1,f,p)&&(x|=1),x}readCorner3(f,p){let x=0;return this.readModule(f-1,0,f,p)&&(x|=1),x<<=1,this.readModule(f-1,p-1,f,p)&&(x|=1),x<<=1,this.readModule(0,p-3,f,p)&&(x|=1),x<<=1,this.readModule(0,p-2,f,p)&&(x|=1),x<<=1,this.readModule(0,p-1,f,p)&&(x|=1),x<<=1,this.readModule(1,p-3,f,p)&&(x|=1),x<<=1,this.readModule(1,p-2,f,p)&&(x|=1),x<<=1,this.readModule(1,p-1,f,p)&&(x|=1),x}readCorner4(f,p){let x=0;return this.readModule(f-3,0,f,p)&&(x|=1),x<<=1,this.readModule(f-2,0,f,p)&&(x|=1),x<<=1,this.readModule(f-1,0,f,p)&&(x|=1),x<<=1,this.readModule(0,p-2,f,p)&&(x|=1),x<<=1,this.readModule(0,p-1,f,p)&&(x|=1),x<<=1,this.readModule(1,p-1,f,p)&&(x|=1),x<<=1,this.readModule(2,p-1,f,p)&&(x|=1),x<<=1,this.readModule(3,p-1,f,p)&&(x|=1),x}extractDataRegion(f){const p=this.version.getSymbolSizeRows(),x=this.version.getSymbolSizeColumns();if(f.getHeight()!==p)throw new m("Dimension of bitMatrix must match the version size");const v=this.version.getDataRegionSizeRows(),w=this.version.getDataRegionSizeColumns(),C=p/v|0,E=x/w|0,I=C*v,R=E*w,B=new U(R,I);for(let W=0;W<C;++W){const Y=W*v;for(let ee=0;ee<E;++ee){const oe=ee*w;for(let ce=0;ce<v;++ce){const ge=W*(v+2)+1+ce,Ae=Y+ce;for(let $e=0;$e<w;++$e){const Ve=ee*(w+2)+1+$e;if(f.get(Ve,ge)){const Le=oe+$e;B.set(Le,Ae)}}}}}return B}}class Ll{constructor(f,p){this.numDataCodewords=f,this.codewords=p}static getDataBlocks(f,p){const x=p.getECBlocks();let v=0;const w=x.getECBlocks();for(let ce of w)v+=ce.getCount();const C=new Array(v);let E=0;for(let ce of w)for(let ge=0;ge<ce.getCount();ge++){const Ae=ce.getDataCodewords(),$e=x.getECCodewords()+Ae;C[E++]=new Ll(Ae,new Uint8Array($e))}const R=C[0].codewords.length-x.getECCodewords(),B=R-1;let W=0;for(let ce=0;ce<B;ce++)for(let ge=0;ge<E;ge++)C[ge].codewords[ce]=f[W++];const Y=p.getVersionNumber()===24,ee=Y?8:E;for(let ce=0;ce<ee;ce++)C[ce].codewords[R-1]=f[W++];const oe=C[0].codewords.length;for(let ce=R;ce<oe;ce++)for(let ge=0;ge<E;ge++){const Ae=Y?(ge+8)%E:ge,$e=Y&&Ae>7?ce-1:ce;C[Ae].codewords[$e]=f[W++]}if(W!==f.length)throw new m;return C}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class Fh{constructor(f){this.bytes=f,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(f){if(f<1||f>32||f>this.available())throw new m(""+f);let p=0,x=this.bitOffset,v=this.byteOffset;const w=this.bytes;if(x>0){const C=8-x,E=f<C?f:C,I=C-E,R=255>>8-E<<I;p=(w[v]&R)>>I,f-=E,x+=E,x===8&&(x=0,v++)}if(f>0){for(;f>=8;)p=p<<8|w[v]&255,v++,f-=8;if(f>0){const C=8-f,E=255>>C<<C;p=p<<f|(w[v]&E)>>C,x+=f}}return this.bitOffset=x,this.byteOffset=v,p}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var fr;(function(H){H[H.PAD_ENCODE=0]="PAD_ENCODE",H[H.ASCII_ENCODE=1]="ASCII_ENCODE",H[H.C40_ENCODE=2]="C40_ENCODE",H[H.TEXT_ENCODE=3]="TEXT_ENCODE",H[H.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",H[H.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",H[H.BASE256_ENCODE=6]="BASE256_ENCODE"})(fr||(fr={}));class Ni{static decode(f){const p=new Fh(f),x=new Q,v=new Q,w=new Array;let C=fr.ASCII_ENCODE;do if(C===fr.ASCII_ENCODE)C=this.decodeAsciiSegment(p,x,v);else{switch(C){case fr.C40_ENCODE:this.decodeC40Segment(p,x);break;case fr.TEXT_ENCODE:this.decodeTextSegment(p,x);break;case fr.ANSIX12_ENCODE:this.decodeAnsiX12Segment(p,x);break;case fr.EDIFACT_ENCODE:this.decodeEdifactSegment(p,x);break;case fr.BASE256_ENCODE:this.decodeBase256Segment(p,x,w);break;default:throw new O}C=fr.ASCII_ENCODE}while(C!==fr.PAD_ENCODE&&p.available()>0);return v.length()>0&&x.append(v.toString()),new ae(f,x.toString(),w.length===0?null:w,null)}static decodeAsciiSegment(f,p,x){let v=!1;do{let w=f.readBits(8);if(w===0)throw new O;if(w<=128)return v&&(w+=128),p.append(String.fromCharCode(w-1)),fr.ASCII_ENCODE;if(w===129)return fr.PAD_ENCODE;if(w<=229){const C=w-130;C<10&&p.append("0"),p.append(""+C)}else switch(w){case 230:return fr.C40_ENCODE;case 231:return fr.BASE256_ENCODE;case 232:p.append("");break;case 233:case 234:break;case 235:v=!0;break;case 236:p.append("[)>05"),x.insert(0,"");break;case 237:p.append("[)>06"),x.insert(0,"");break;case 238:return fr.ANSIX12_ENCODE;case 239:return fr.TEXT_ENCODE;case 240:return fr.EDIFACT_ENCODE;case 241:break;default:if(w!==254||f.available()!==0)throw new O;break}}while(f.available()>0);return fr.ASCII_ENCODE}static decodeC40Segment(f,p){let x=!1;const v=[];let w=0;do{if(f.available()===8)return;const C=f.readBits(8);if(C===254)return;this.parseTwoBytes(C,f.readBits(8),v);for(let E=0;E<3;E++){const I=v[E];switch(w){case 0:if(I<3)w=I+1;else if(I<this.C40_BASIC_SET_CHARS.length){const R=this.C40_BASIC_SET_CHARS[I];x?(p.append(String.fromCharCode(R.charCodeAt(0)+128)),x=!1):p.append(R)}else throw new O;break;case 1:x?(p.append(String.fromCharCode(I+128)),x=!1):p.append(String.fromCharCode(I)),w=0;break;case 2:if(I<this.C40_SHIFT2_SET_CHARS.length){const R=this.C40_SHIFT2_SET_CHARS[I];x?(p.append(String.fromCharCode(R.charCodeAt(0)+128)),x=!1):p.append(R)}else switch(I){case 27:p.append("");break;case 30:x=!0;break;default:throw new O}w=0;break;case 3:x?(p.append(String.fromCharCode(I+224)),x=!1):p.append(String.fromCharCode(I+96)),w=0;break;default:throw new O}}}while(f.available()>0)}static decodeTextSegment(f,p){let x=!1,v=[],w=0;do{if(f.available()===8)return;const C=f.readBits(8);if(C===254)return;this.parseTwoBytes(C,f.readBits(8),v);for(let E=0;E<3;E++){const I=v[E];switch(w){case 0:if(I<3)w=I+1;else if(I<this.TEXT_BASIC_SET_CHARS.length){const R=this.TEXT_BASIC_SET_CHARS[I];x?(p.append(String.fromCharCode(R.charCodeAt(0)+128)),x=!1):p.append(R)}else throw new O;break;case 1:x?(p.append(String.fromCharCode(I+128)),x=!1):p.append(String.fromCharCode(I)),w=0;break;case 2:if(I<this.TEXT_SHIFT2_SET_CHARS.length){const R=this.TEXT_SHIFT2_SET_CHARS[I];x?(p.append(String.fromCharCode(R.charCodeAt(0)+128)),x=!1):p.append(R)}else switch(I){case 27:p.append("");break;case 30:x=!0;break;default:throw new O}w=0;break;case 3:if(I<this.TEXT_SHIFT3_SET_CHARS.length){const R=this.TEXT_SHIFT3_SET_CHARS[I];x?(p.append(String.fromCharCode(R.charCodeAt(0)+128)),x=!1):p.append(R),w=0}else throw new O;break;default:throw new O}}}while(f.available()>0)}static decodeAnsiX12Segment(f,p){const x=[];do{if(f.available()===8)return;const v=f.readBits(8);if(v===254)return;this.parseTwoBytes(v,f.readBits(8),x);for(let w=0;w<3;w++){const C=x[w];switch(C){case 0:p.append("\r");break;case 1:p.append("*");break;case 2:p.append(">");break;case 3:p.append(" ");break;default:if(C<14)p.append(String.fromCharCode(C+44));else if(C<40)p.append(String.fromCharCode(C+51));else throw new O;break}}}while(f.available()>0)}static parseTwoBytes(f,p,x){let v=(f<<8)+p-1,w=Math.floor(v/1600);x[0]=w,v-=w*1600,w=Math.floor(v/40),x[1]=w,x[2]=v-w*40}static decodeEdifactSegment(f,p){do{if(f.available()<=16)return;for(let x=0;x<4;x++){let v=f.readBits(6);if(v===31){const w=8-f.getBitOffset();w!==8&&f.readBits(w);return}v&32||(v|=64),p.append(String.fromCharCode(v))}}while(f.available()>0)}static decodeBase256Segment(f,p,x){let v=1+f.getByteOffset();const w=this.unrandomize255State(f.readBits(8),v++);let C;if(w===0?C=f.available()/8|0:w<250?C=w:C=250*(w-249)+this.unrandomize255State(f.readBits(8),v++),C<0)throw new O;const E=new Uint8Array(C);for(let I=0;I<C;I++){if(f.available()<8)throw new O;E[I]=this.unrandomize255State(f.readBits(8),v++)}x.push(E);try{p.append(V.decode(E,F.ISO88591))}catch(I){throw new St("Platform does not support required encoding: "+I.message)}}static unrandomize255State(f,p){const x=149*p%255+1,v=f-x;return v>=0?v:v+256}}Ni.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Ni.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Ni.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Ni.TEXT_SHIFT2_SET_CHARS=Ni.C40_SHIFT2_SET_CHARS,Ni.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class sw{constructor(){this.rsDecoder=new wt(We.DATA_MATRIX_FIELD_256)}decode(f){const p=new Bh(f),x=p.getVersion(),v=p.readCodewords(),w=Ll.getDataBlocks(v,x);let C=0;for(let R of w)C+=R.getNumDataCodewords();const E=new Uint8Array(C),I=w.length;for(let R=0;R<I;R++){const B=w[R],W=B.getCodewords(),Y=B.getNumDataCodewords();this.correctErrors(W,Y);for(let ee=0;ee<Y;ee++)E[ee*I+R]=W[ee]}return Ni.decode(E)}correctErrors(f,p){const x=new Int32Array(f);try{this.rsDecoder.decode(x,f.length-p)}catch{throw new y}for(let v=0;v<p;v++)f[v]=x[v]}}class pn{constructor(f){this.image=f,this.rectangleDetector=new sn(this.image)}detect(){const f=this.rectangleDetector.detect();let p=this.detectSolid1(f);if(p=this.detectSolid2(p),p[3]=this.correctTopRight(p),!p[3])throw new z;p=this.shiftToModuleCenter(p);const x=p[0],v=p[1],w=p[2],C=p[3];let E=this.transitionsBetween(x,C)+1,I=this.transitionsBetween(w,C)+1;(E&1)===1&&(E+=1),(I&1)===1&&(I+=1),4*E<7*I&&4*I<7*E&&(E=I=Math.max(E,I));let R=pn.sampleGrid(this.image,x,v,w,C,E,I);return new De(R,[x,v,w,C])}static shiftPoint(f,p,x){let v=(p.getX()-f.getX())/(x+1),w=(p.getY()-f.getY())/(x+1);return new le(f.getX()+v,f.getY()+w)}static moveAway(f,p,x){let v=f.getX(),w=f.getY();return v<p?v-=1:v+=1,w<x?w-=1:w+=1,new le(v,w)}detectSolid1(f){let p=f[0],x=f[1],v=f[3],w=f[2],C=this.transitionsBetween(p,x),E=this.transitionsBetween(x,v),I=this.transitionsBetween(v,w),R=this.transitionsBetween(w,p),B=C,W=[w,p,x,v];return B>E&&(B=E,W[0]=p,W[1]=x,W[2]=v,W[3]=w),B>I&&(B=I,W[0]=x,W[1]=v,W[2]=w,W[3]=p),B>R&&(W[0]=v,W[1]=w,W[2]=p,W[3]=x),W}detectSolid2(f){let p=f[0],x=f[1],v=f[2],w=f[3],C=this.transitionsBetween(p,w),E=pn.shiftPoint(x,v,(C+1)*4),I=pn.shiftPoint(v,x,(C+1)*4),R=this.transitionsBetween(E,p),B=this.transitionsBetween(I,w);return R<B?(f[0]=p,f[1]=x,f[2]=v,f[3]=w):(f[0]=x,f[1]=v,f[2]=w,f[3]=p),f}correctTopRight(f){let p=f[0],x=f[1],v=f[2],w=f[3],C=this.transitionsBetween(p,w),E=this.transitionsBetween(x,w),I=pn.shiftPoint(p,x,(E+1)*4),R=pn.shiftPoint(v,x,(C+1)*4);C=this.transitionsBetween(I,w),E=this.transitionsBetween(R,w);let B=new le(w.getX()+(v.getX()-x.getX())/(C+1),w.getY()+(v.getY()-x.getY())/(C+1)),W=new le(w.getX()+(p.getX()-x.getX())/(E+1),w.getY()+(p.getY()-x.getY())/(E+1));if(!this.isValid(B))return this.isValid(W)?W:null;if(!this.isValid(W))return B;let Y=this.transitionsBetween(I,B)+this.transitionsBetween(R,B),ee=this.transitionsBetween(I,W)+this.transitionsBetween(R,W);return Y>ee?B:W}shiftToModuleCenter(f){let p=f[0],x=f[1],v=f[2],w=f[3],C=this.transitionsBetween(p,w)+1,E=this.transitionsBetween(v,w)+1,I=pn.shiftPoint(p,x,E*4),R=pn.shiftPoint(v,x,C*4);C=this.transitionsBetween(I,w)+1,E=this.transitionsBetween(R,w)+1,(C&1)===1&&(C+=1),(E&1)===1&&(E+=1);let B=(p.getX()+x.getX()+v.getX()+w.getX())/4,W=(p.getY()+x.getY()+v.getY()+w.getY())/4;p=pn.moveAway(p,B,W),x=pn.moveAway(x,B,W),v=pn.moveAway(v,B,W),w=pn.moveAway(w,B,W);let Y,ee;return I=pn.shiftPoint(p,x,E*4),I=pn.shiftPoint(I,w,C*4),Y=pn.shiftPoint(x,p,E*4),Y=pn.shiftPoint(Y,v,C*4),R=pn.shiftPoint(v,w,E*4),R=pn.shiftPoint(R,x,C*4),ee=pn.shiftPoint(w,v,E*4),ee=pn.shiftPoint(ee,p,C*4),[I,Y,R,ee]}isValid(f){return f.getX()>=0&&f.getX()<this.image.getWidth()&&f.getY()>0&&f.getY()<this.image.getHeight()}static sampleGrid(f,p,x,v,w,C,E){return In.getInstance().sampleGrid(f,C,E,.5,.5,C-.5,.5,C-.5,E-.5,.5,E-.5,p.getX(),p.getY(),w.getX(),w.getY(),v.getX(),v.getY(),x.getX(),x.getY())}transitionsBetween(f,p){let x=Math.trunc(f.getX()),v=Math.trunc(f.getY()),w=Math.trunc(p.getX()),C=Math.trunc(p.getY()),E=Math.abs(C-v)>Math.abs(w-x);if(E){let ce=x;x=v,v=ce,ce=w,w=C,C=ce}let I=Math.abs(w-x),R=Math.abs(C-v),B=-I/2,W=v<C?1:-1,Y=x<w?1:-1,ee=0,oe=this.image.get(E?v:x,E?x:v);for(let ce=x,ge=v;ce!==w;ce+=Y){let Ae=this.image.get(E?ge:ce,E?ce:ge);if(Ae!==oe&&(ee++,oe=Ae),B+=R,B>0){if(ge===C)break;ge+=W,B-=I}}return ee}}class G{constructor(){this.decoder=new sw}decode(f,p=null){let x,v;if(p!=null&&p.has(M.PURE_BARCODE)){const R=G.extractPureBits(f.getBlackMatrix());x=this.decoder.decode(R),v=G.NO_POINTS}else{const R=new pn(f.getBlackMatrix()).detect();x=this.decoder.decode(R.getBits()),v=R.getPoints()}const w=x.getRawBytes(),C=new be(x.getText(),w,8*w.length,v,_e.DATA_MATRIX,j.currentTimeMillis()),E=x.getByteSegments();E!=null&&C.putMetadata(Oe.BYTE_SEGMENTS,E);const I=x.getECLevel();return I!=null&&C.putMetadata(Oe.ERROR_CORRECTION_LEVEL,I),C}reset(){}static extractPureBits(f){const p=f.getTopLeftOnBit(),x=f.getBottomRightOnBit();if(p==null||x==null)throw new z;const v=this.moduleSize(p,f);let w=p[1];const C=x[1];let E=p[0];const R=(x[0]-E+1)/v,B=(C-w+1)/v;if(R<=0||B<=0)throw new z;const W=v/2;w+=W,E+=W;const Y=new U(R,B);for(let ee=0;ee<B;ee++){const oe=w+ee*v;for(let ce=0;ce<R;ce++)f.get(E+ce*v,oe)&&Y.set(ce,ee)}return Y}static moduleSize(f,p){const x=p.getWidth();let v=f[0];const w=f[1];for(;v<x&&p.get(v,w);)v++;if(v===x)throw new z;const C=v-f[0];if(C===0)throw new z;return C}}G.NO_POINTS=[];class ve extends ye{constructor(f=500){super(new G,f)}}var ke;(function(H){H[H.L=0]="L",H[H.M=1]="M",H[H.Q=2]="Q",H[H.H=3]="H"})(ke||(ke={}));class rt{constructor(f,p,x){this.value=f,this.stringValue=p,this.bits=x,rt.FOR_BITS.set(x,this),rt.FOR_VALUE.set(f,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(f){switch(f){case"L":return rt.L;case"M":return rt.M;case"Q":return rt.Q;case"H":return rt.H;default:throw new h(f+"not available")}}toString(){return this.stringValue}equals(f){if(!(f instanceof rt))return!1;const p=f;return this.value===p.value}static forBits(f){if(f<0||f>=rt.FOR_BITS.size)throw new m;return rt.FOR_BITS.get(f)}}rt.FOR_BITS=new Map,rt.FOR_VALUE=new Map,rt.L=new rt(ke.L,"L",1),rt.M=new rt(ke.M,"M",0),rt.Q=new rt(ke.Q,"Q",3),rt.H=new rt(ke.H,"H",2);class Tt{constructor(f){this.errorCorrectionLevel=rt.forBits(f>>3&3),this.dataMask=f&7}static numBitsDiffering(f,p){return k.bitCount(f^p)}static decodeFormatInformation(f,p){const x=Tt.doDecodeFormatInformation(f,p);return x!==null?x:Tt.doDecodeFormatInformation(f^Tt.FORMAT_INFO_MASK_QR,p^Tt.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(f,p){let x=Number.MAX_SAFE_INTEGER,v=0;for(const w of Tt.FORMAT_INFO_DECODE_LOOKUP){const C=w[0];if(C===f||C===p)return new Tt(w[1]);let E=Tt.numBitsDiffering(f,C);E<x&&(v=w[1],x=E),f!==p&&(E=Tt.numBitsDiffering(p,C),E<x&&(v=w[1],x=E))}return x<=3?new Tt(v):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(f){if(!(f instanceof Tt))return!1;const p=f;return this.errorCorrectionLevel===p.errorCorrectionLevel&&this.dataMask===p.dataMask}}Tt.FORMAT_INFO_MASK_QR=21522,Tt.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class he{constructor(f,...p){this.ecCodewordsPerBlock=f,this.ecBlocks=p}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let f=0;const p=this.ecBlocks;for(const x of p)f+=x.getCount();return f}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class Z{constructor(f,p){this.count=f,this.dataCodewords=p}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class pt{constructor(f,p,...x){this.versionNumber=f,this.alignmentPatternCenters=p,this.ecBlocks=x;let v=0;const w=x[0].getECCodewordsPerBlock(),C=x[0].getECBlocks();for(const E of C)v+=E.getCount()*(E.getDataCodewords()+w);this.totalCodewords=v}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(f){return this.ecBlocks[f.getValue()]}static getProvisionalVersionForDimension(f){if(f%4!==1)throw new O;try{return this.getVersionForNumber((f-17)/4)}catch{throw new O}}static getVersionForNumber(f){if(f<1||f>40)throw new m;return pt.VERSIONS[f-1]}static decodeVersionInformation(f){let p=Number.MAX_SAFE_INTEGER,x=0;for(let v=0;v<pt.VERSION_DECODE_INFO.length;v++){const w=pt.VERSION_DECODE_INFO[v];if(w===f)return pt.getVersionForNumber(v+7);const C=Tt.numBitsDiffering(f,w);C<p&&(x=v+7,p=C)}return p<=3?pt.getVersionForNumber(x):null}buildFunctionPattern(){const f=this.getDimensionForVersion(),p=new U(f);p.setRegion(0,0,9,9),p.setRegion(f-8,0,8,9),p.setRegion(0,f-8,9,8);const x=this.alignmentPatternCenters.length;for(let v=0;v<x;v++){const w=this.alignmentPatternCenters[v]-2;for(let C=0;C<x;C++)v===0&&(C===0||C===x-1)||v===x-1&&C===0||p.setRegion(this.alignmentPatternCenters[C]-2,w,5,5)}return p.setRegion(6,9,1,f-17),p.setRegion(9,6,f-17,1),this.versionNumber>6&&(p.setRegion(f-11,0,3,6),p.setRegion(0,f-11,6,3)),p}toString(){return""+this.versionNumber}}pt.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),pt.VERSIONS=[new pt(1,new Int32Array(0),new he(7,new Z(1,19)),new he(10,new Z(1,16)),new he(13,new Z(1,13)),new he(17,new Z(1,9))),new pt(2,Int32Array.from([6,18]),new he(10,new Z(1,34)),new he(16,new Z(1,28)),new he(22,new Z(1,22)),new he(28,new Z(1,16))),new pt(3,Int32Array.from([6,22]),new he(15,new Z(1,55)),new he(26,new Z(1,44)),new he(18,new Z(2,17)),new he(22,new Z(2,13))),new pt(4,Int32Array.from([6,26]),new he(20,new Z(1,80)),new he(18,new Z(2,32)),new he(26,new Z(2,24)),new he(16,new Z(4,9))),new pt(5,Int32Array.from([6,30]),new he(26,new Z(1,108)),new he(24,new Z(2,43)),new he(18,new Z(2,15),new Z(2,16)),new he(22,new Z(2,11),new Z(2,12))),new pt(6,Int32Array.from([6,34]),new he(18,new Z(2,68)),new he(16,new Z(4,27)),new he(24,new Z(4,19)),new he(28,new Z(4,15))),new pt(7,Int32Array.from([6,22,38]),new he(20,new Z(2,78)),new he(18,new Z(4,31)),new he(18,new Z(2,14),new Z(4,15)),new he(26,new Z(4,13),new Z(1,14))),new pt(8,Int32Array.from([6,24,42]),new he(24,new Z(2,97)),new he(22,new Z(2,38),new Z(2,39)),new he(22,new Z(4,18),new Z(2,19)),new he(26,new Z(4,14),new Z(2,15))),new pt(9,Int32Array.from([6,26,46]),new he(30,new Z(2,116)),new he(22,new Z(3,36),new Z(2,37)),new he(20,new Z(4,16),new Z(4,17)),new he(24,new Z(4,12),new Z(4,13))),new pt(10,Int32Array.from([6,28,50]),new he(18,new Z(2,68),new Z(2,69)),new he(26,new Z(4,43),new Z(1,44)),new he(24,new Z(6,19),new Z(2,20)),new he(28,new Z(6,15),new Z(2,16))),new pt(11,Int32Array.from([6,30,54]),new he(20,new Z(4,81)),new he(30,new Z(1,50),new Z(4,51)),new he(28,new Z(4,22),new Z(4,23)),new he(24,new Z(3,12),new Z(8,13))),new pt(12,Int32Array.from([6,32,58]),new he(24,new Z(2,92),new Z(2,93)),new he(22,new Z(6,36),new Z(2,37)),new he(26,new Z(4,20),new Z(6,21)),new he(28,new Z(7,14),new Z(4,15))),new pt(13,Int32Array.from([6,34,62]),new he(26,new Z(4,107)),new he(22,new Z(8,37),new Z(1,38)),new he(24,new Z(8,20),new Z(4,21)),new he(22,new Z(12,11),new Z(4,12))),new pt(14,Int32Array.from([6,26,46,66]),new he(30,new Z(3,115),new Z(1,116)),new he(24,new Z(4,40),new Z(5,41)),new he(20,new Z(11,16),new Z(5,17)),new he(24,new Z(11,12),new Z(5,13))),new pt(15,Int32Array.from([6,26,48,70]),new he(22,new Z(5,87),new Z(1,88)),new he(24,new Z(5,41),new Z(5,42)),new he(30,new Z(5,24),new Z(7,25)),new he(24,new Z(11,12),new Z(7,13))),new pt(16,Int32Array.from([6,26,50,74]),new he(24,new Z(5,98),new Z(1,99)),new he(28,new Z(7,45),new Z(3,46)),new he(24,new Z(15,19),new Z(2,20)),new he(30,new Z(3,15),new Z(13,16))),new pt(17,Int32Array.from([6,30,54,78]),new he(28,new Z(1,107),new Z(5,108)),new he(28,new Z(10,46),new Z(1,47)),new he(28,new Z(1,22),new Z(15,23)),new he(28,new Z(2,14),new Z(17,15))),new pt(18,Int32Array.from([6,30,56,82]),new he(30,new Z(5,120),new Z(1,121)),new he(26,new Z(9,43),new Z(4,44)),new he(28,new Z(17,22),new Z(1,23)),new he(28,new Z(2,14),new Z(19,15))),new pt(19,Int32Array.from([6,30,58,86]),new he(28,new Z(3,113),new Z(4,114)),new he(26,new Z(3,44),new Z(11,45)),new he(26,new Z(17,21),new Z(4,22)),new he(26,new Z(9,13),new Z(16,14))),new pt(20,Int32Array.from([6,34,62,90]),new he(28,new Z(3,107),new Z(5,108)),new he(26,new Z(3,41),new Z(13,42)),new he(30,new Z(15,24),new Z(5,25)),new he(28,new Z(15,15),new Z(10,16))),new pt(21,Int32Array.from([6,28,50,72,94]),new he(28,new Z(4,116),new Z(4,117)),new he(26,new Z(17,42)),new he(28,new Z(17,22),new Z(6,23)),new he(30,new Z(19,16),new Z(6,17))),new pt(22,Int32Array.from([6,26,50,74,98]),new he(28,new Z(2,111),new Z(7,112)),new he(28,new Z(17,46)),new he(30,new Z(7,24),new Z(16,25)),new he(24,new Z(34,13))),new pt(23,Int32Array.from([6,30,54,78,102]),new he(30,new Z(4,121),new Z(5,122)),new he(28,new Z(4,47),new Z(14,48)),new he(30,new Z(11,24),new Z(14,25)),new he(30,new Z(16,15),new Z(14,16))),new pt(24,Int32Array.from([6,28,54,80,106]),new he(30,new Z(6,117),new Z(4,118)),new he(28,new Z(6,45),new Z(14,46)),new he(30,new Z(11,24),new Z(16,25)),new he(30,new Z(30,16),new Z(2,17))),new pt(25,Int32Array.from([6,32,58,84,110]),new he(26,new Z(8,106),new Z(4,107)),new he(28,new Z(8,47),new Z(13,48)),new he(30,new Z(7,24),new Z(22,25)),new he(30,new Z(22,15),new Z(13,16))),new pt(26,Int32Array.from([6,30,58,86,114]),new he(28,new Z(10,114),new Z(2,115)),new he(28,new Z(19,46),new Z(4,47)),new he(28,new Z(28,22),new Z(6,23)),new he(30,new Z(33,16),new Z(4,17))),new pt(27,Int32Array.from([6,34,62,90,118]),new he(30,new Z(8,122),new Z(4,123)),new he(28,new Z(22,45),new Z(3,46)),new he(30,new Z(8,23),new Z(26,24)),new he(30,new Z(12,15),new Z(28,16))),new pt(28,Int32Array.from([6,26,50,74,98,122]),new he(30,new Z(3,117),new Z(10,118)),new he(28,new Z(3,45),new Z(23,46)),new he(30,new Z(4,24),new Z(31,25)),new he(30,new Z(11,15),new Z(31,16))),new pt(29,Int32Array.from([6,30,54,78,102,126]),new he(30,new Z(7,116),new Z(7,117)),new he(28,new Z(21,45),new Z(7,46)),new he(30,new Z(1,23),new Z(37,24)),new he(30,new Z(19,15),new Z(26,16))),new pt(30,Int32Array.from([6,26,52,78,104,130]),new he(30,new Z(5,115),new Z(10,116)),new he(28,new Z(19,47),new Z(10,48)),new he(30,new Z(15,24),new Z(25,25)),new he(30,new Z(23,15),new Z(25,16))),new pt(31,Int32Array.from([6,30,56,82,108,134]),new he(30,new Z(13,115),new Z(3,116)),new he(28,new Z(2,46),new Z(29,47)),new he(30,new Z(42,24),new Z(1,25)),new he(30,new Z(23,15),new Z(28,16))),new pt(32,Int32Array.from([6,34,60,86,112,138]),new he(30,new Z(17,115)),new he(28,new Z(10,46),new Z(23,47)),new he(30,new Z(10,24),new Z(35,25)),new he(30,new Z(19,15),new Z(35,16))),new pt(33,Int32Array.from([6,30,58,86,114,142]),new he(30,new Z(17,115),new Z(1,116)),new he(28,new Z(14,46),new Z(21,47)),new he(30,new Z(29,24),new Z(19,25)),new he(30,new Z(11,15),new Z(46,16))),new pt(34,Int32Array.from([6,34,62,90,118,146]),new he(30,new Z(13,115),new Z(6,116)),new he(28,new Z(14,46),new Z(23,47)),new he(30,new Z(44,24),new Z(7,25)),new he(30,new Z(59,16),new Z(1,17))),new pt(35,Int32Array.from([6,30,54,78,102,126,150]),new he(30,new Z(12,121),new Z(7,122)),new he(28,new Z(12,47),new Z(26,48)),new he(30,new Z(39,24),new Z(14,25)),new he(30,new Z(22,15),new Z(41,16))),new pt(36,Int32Array.from([6,24,50,76,102,128,154]),new he(30,new Z(6,121),new Z(14,122)),new he(28,new Z(6,47),new Z(34,48)),new he(30,new Z(46,24),new Z(10,25)),new he(30,new Z(2,15),new Z(64,16))),new pt(37,Int32Array.from([6,28,54,80,106,132,158]),new he(30,new Z(17,122),new Z(4,123)),new he(28,new Z(29,46),new Z(14,47)),new he(30,new Z(49,24),new Z(10,25)),new he(30,new Z(24,15),new Z(46,16))),new pt(38,Int32Array.from([6,32,58,84,110,136,162]),new he(30,new Z(4,122),new Z(18,123)),new he(28,new Z(13,46),new Z(32,47)),new he(30,new Z(48,24),new Z(14,25)),new he(30,new Z(42,15),new Z(32,16))),new pt(39,Int32Array.from([6,26,54,82,110,138,166]),new he(30,new Z(20,117),new Z(4,118)),new he(28,new Z(40,47),new Z(7,48)),new he(30,new Z(43,24),new Z(22,25)),new he(30,new Z(10,15),new Z(67,16))),new pt(40,Int32Array.from([6,30,58,86,114,142,170]),new he(30,new Z(19,118),new Z(6,119)),new he(28,new Z(18,47),new Z(31,48)),new he(30,new Z(34,24),new Z(34,25)),new he(30,new Z(20,15),new Z(61,16)))];var Kr;(function(H){H[H.DATA_MASK_000=0]="DATA_MASK_000",H[H.DATA_MASK_001=1]="DATA_MASK_001",H[H.DATA_MASK_010=2]="DATA_MASK_010",H[H.DATA_MASK_011=3]="DATA_MASK_011",H[H.DATA_MASK_100=4]="DATA_MASK_100",H[H.DATA_MASK_101=5]="DATA_MASK_101",H[H.DATA_MASK_110=6]="DATA_MASK_110",H[H.DATA_MASK_111=7]="DATA_MASK_111"})(Kr||(Kr={}));class Ga{constructor(f,p){this.value=f,this.isMasked=p}unmaskBitMatrix(f,p){for(let x=0;x<p;x++)for(let v=0;v<p;v++)this.isMasked(x,v)&&f.flip(v,x)}}Ga.values=new Map([[Kr.DATA_MASK_000,new Ga(Kr.DATA_MASK_000,(H,f)=>(H+f&1)===0)],[Kr.DATA_MASK_001,new Ga(Kr.DATA_MASK_001,(H,f)=>(H&1)===0)],[Kr.DATA_MASK_010,new Ga(Kr.DATA_MASK_010,(H,f)=>f%3===0)],[Kr.DATA_MASK_011,new Ga(Kr.DATA_MASK_011,(H,f)=>(H+f)%3===0)],[Kr.DATA_MASK_100,new Ga(Kr.DATA_MASK_100,(H,f)=>(Math.floor(H/2)+Math.floor(f/3)&1)===0)],[Kr.DATA_MASK_101,new Ga(Kr.DATA_MASK_101,(H,f)=>H*f%6===0)],[Kr.DATA_MASK_110,new Ga(Kr.DATA_MASK_110,(H,f)=>H*f%6<3)],[Kr.DATA_MASK_111,new Ga(Kr.DATA_MASK_111,(H,f)=>(H+f+H*f%3&1)===0)]]);class jG{constructor(f){const p=f.getHeight();if(p<21||(p&3)!==1)throw new O;this.bitMatrix=f}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let f=0;for(let w=0;w<6;w++)f=this.copyBit(w,8,f);f=this.copyBit(7,8,f),f=this.copyBit(8,8,f),f=this.copyBit(8,7,f);for(let w=5;w>=0;w--)f=this.copyBit(8,w,f);const p=this.bitMatrix.getHeight();let x=0;const v=p-7;for(let w=p-1;w>=v;w--)x=this.copyBit(8,w,x);for(let w=p-8;w<p;w++)x=this.copyBit(w,8,x);if(this.parsedFormatInfo=Tt.decodeFormatInformation(f,x),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new O}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const f=this.bitMatrix.getHeight(),p=Math.floor((f-17)/4);if(p<=6)return pt.getVersionForNumber(p);let x=0;const v=f-11;for(let C=5;C>=0;C--)for(let E=f-9;E>=v;E--)x=this.copyBit(E,C,x);let w=pt.decodeVersionInformation(x);if(w!==null&&w.getDimensionForVersion()===f)return this.parsedVersion=w,w;x=0;for(let C=5;C>=0;C--)for(let E=f-9;E>=v;E--)x=this.copyBit(C,E,x);if(w=pt.decodeVersionInformation(x),w!==null&&w.getDimensionForVersion()===f)return this.parsedVersion=w,w;throw new O}copyBit(f,p,x){return(this.isMirror?this.bitMatrix.get(p,f):this.bitMatrix.get(f,p))?x<<1|1:x<<1}readCodewords(){const f=this.readFormatInformation(),p=this.readVersion(),x=Ga.values.get(f.getDataMask()),v=this.bitMatrix.getHeight();x.unmaskBitMatrix(this.bitMatrix,v);const w=p.buildFunctionPattern();let C=!0;const E=new Uint8Array(p.getTotalCodewords());let I=0,R=0,B=0;for(let W=v-1;W>0;W-=2){W===6&&W--;for(let Y=0;Y<v;Y++){const ee=C?v-1-Y:Y;for(let oe=0;oe<2;oe++)w.get(W-oe,ee)||(B++,R<<=1,this.bitMatrix.get(W-oe,ee)&&(R|=1),B===8&&(E[I++]=R,B=0,R=0))}C=!C}if(I!==p.getTotalCodewords())throw new O;return E}remask(){if(this.parsedFormatInfo===null)return;const f=Ga.values[this.parsedFormatInfo.getDataMask()],p=this.bitMatrix.getHeight();f.unmaskBitMatrix(this.bitMatrix,p)}setMirror(f){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=f}mirror(){const f=this.bitMatrix;for(let p=0,x=f.getWidth();p<x;p++)for(let v=p+1,w=f.getHeight();v<w;v++)f.get(p,v)!==f.get(v,p)&&(f.flip(v,p),f.flip(p,v))}}class aw{constructor(f,p){this.numDataCodewords=f,this.codewords=p}static getDataBlocks(f,p,x){if(f.length!==p.getTotalCodewords())throw new m;const v=p.getECBlocksForLevel(x);let w=0;const C=v.getECBlocks();for(const oe of C)w+=oe.getCount();const E=new Array(w);let I=0;for(const oe of C)for(let ce=0;ce<oe.getCount();ce++){const ge=oe.getDataCodewords(),Ae=v.getECCodewordsPerBlock()+ge;E[I++]=new aw(ge,new Uint8Array(Ae))}const R=E[0].codewords.length;let B=E.length-1;for(;B>=0&&E[B].codewords.length!==R;)B--;B++;const W=R-v.getECCodewordsPerBlock();let Y=0;for(let oe=0;oe<W;oe++)for(let ce=0;ce<I;ce++)E[ce].codewords[oe]=f[Y++];for(let oe=B;oe<I;oe++)E[oe].codewords[W]=f[Y++];const ee=E[0].codewords.length;for(let oe=W;oe<ee;oe++)for(let ce=0;ce<I;ce++){const ge=ce<B?oe:oe+1;E[ce].codewords[ge]=f[Y++]}return E}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var Ka;(function(H){H[H.TERMINATOR=0]="TERMINATOR",H[H.NUMERIC=1]="NUMERIC",H[H.ALPHANUMERIC=2]="ALPHANUMERIC",H[H.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",H[H.BYTE=4]="BYTE",H[H.ECI=5]="ECI",H[H.KANJI=6]="KANJI",H[H.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",H[H.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",H[H.HANZI=9]="HANZI"})(Ka||(Ka={}));class yt{constructor(f,p,x,v){this.value=f,this.stringValue=p,this.characterCountBitsForVersions=x,this.bits=v,yt.FOR_BITS.set(v,this),yt.FOR_VALUE.set(f,this)}static forBits(f){const p=yt.FOR_BITS.get(f);if(p===void 0)throw new m;return p}getCharacterCountBits(f){const p=f.getVersionNumber();let x;return p<=9?x=0:p<=26?x=1:x=2,this.characterCountBitsForVersions[x]}getValue(){return this.value}getBits(){return this.bits}equals(f){if(!(f instanceof yt))return!1;const p=f;return this.value===p.value}toString(){return this.stringValue}}yt.FOR_BITS=new Map,yt.FOR_VALUE=new Map,yt.TERMINATOR=new yt(Ka.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),yt.NUMERIC=new yt(Ka.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),yt.ALPHANUMERIC=new yt(Ka.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),yt.STRUCTURED_APPEND=new yt(Ka.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),yt.BYTE=new yt(Ka.BYTE,"BYTE",Int32Array.from([8,16,16]),4),yt.ECI=new yt(Ka.ECI,"ECI",Int32Array.from([0,0,0]),7),yt.KANJI=new yt(Ka.KANJI,"KANJI",Int32Array.from([8,10,12]),8),yt.FNC1_FIRST_POSITION=new yt(Ka.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),yt.FNC1_SECOND_POSITION=new yt(Ka.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),yt.HANZI=new yt(Ka.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class qn{static decode(f,p,x,v){const w=new Fh(f);let C=new Q;const E=new Array;let I=-1,R=-1;try{let B=null,W=!1,Y;do{if(w.available()<4)Y=yt.TERMINATOR;else{const ee=w.readBits(4);Y=yt.forBits(ee)}switch(Y){case yt.TERMINATOR:break;case yt.FNC1_FIRST_POSITION:case yt.FNC1_SECOND_POSITION:W=!0;break;case yt.STRUCTURED_APPEND:if(w.available()<16)throw new O;I=w.readBits(8),R=w.readBits(8);break;case yt.ECI:const ee=qn.parseECIValue(w);if(B=L.getCharacterSetECIByValue(ee),B===null)throw new O;break;case yt.HANZI:const oe=w.readBits(4),ce=w.readBits(Y.getCharacterCountBits(p));oe===qn.GB2312_SUBSET&&qn.decodeHanziSegment(w,C,ce);break;default:const ge=w.readBits(Y.getCharacterCountBits(p));switch(Y){case yt.NUMERIC:qn.decodeNumericSegment(w,C,ge);break;case yt.ALPHANUMERIC:qn.decodeAlphanumericSegment(w,C,ge,W);break;case yt.BYTE:qn.decodeByteSegment(w,C,ge,B,E,v);break;case yt.KANJI:qn.decodeKanjiSegment(w,C,ge);break;default:throw new O}break}}while(Y!==yt.TERMINATOR)}catch{throw new O}return new ae(f,C.toString(),E.length===0?null:E,x===null?null:x.toString(),I,R)}static decodeHanziSegment(f,p,x){if(x*13>f.available())throw new O;const v=new Uint8Array(2*x);let w=0;for(;x>0;){const C=f.readBits(13);let E=C/96<<8&4294967295|C%96;E<959?E+=41377:E+=42657,v[w]=E>>8&255,v[w+1]=E&255,w+=2,x--}try{p.append(V.decode(v,F.GB2312))}catch(C){throw new O(C)}}static decodeKanjiSegment(f,p,x){if(x*13>f.available())throw new O;const v=new Uint8Array(2*x);let w=0;for(;x>0;){const C=f.readBits(13);let E=C/192<<8&4294967295|C%192;E<7936?E+=33088:E+=49472,v[w]=E>>8,v[w+1]=E,w+=2,x--}try{p.append(V.decode(v,F.SHIFT_JIS))}catch(C){throw new O(C)}}static decodeByteSegment(f,p,x,v,w,C){if(8*x>f.available())throw new O;const E=new Uint8Array(x);for(let R=0;R<x;R++)E[R]=f.readBits(8);let I;v===null?I=F.guessEncoding(E,C):I=v.getName();try{p.append(V.decode(E,I))}catch(R){throw new O(R)}w.push(E)}static toAlphaNumericChar(f){if(f>=qn.ALPHANUMERIC_CHARS.length)throw new O;return qn.ALPHANUMERIC_CHARS[f]}static decodeAlphanumericSegment(f,p,x,v){const w=p.length();for(;x>1;){if(f.available()<11)throw new O;const C=f.readBits(11);p.append(qn.toAlphaNumericChar(Math.floor(C/45))),p.append(qn.toAlphaNumericChar(C%45)),x-=2}if(x===1){if(f.available()<6)throw new O;p.append(qn.toAlphaNumericChar(f.readBits(6)))}if(v)for(let C=w;C<p.length();C++)p.charAt(C)==="%"&&(C<p.length()-1&&p.charAt(C+1)==="%"?p.deleteCharAt(C+1):p.setCharAt(C,""))}static decodeNumericSegment(f,p,x){for(;x>=3;){if(f.available()<10)throw new O;const v=f.readBits(10);if(v>=1e3)throw new O;p.append(qn.toAlphaNumericChar(Math.floor(v/100))),p.append(qn.toAlphaNumericChar(Math.floor(v/10)%10)),p.append(qn.toAlphaNumericChar(v%10)),x-=3}if(x===2){if(f.available()<7)throw new O;const v=f.readBits(7);if(v>=100)throw new O;p.append(qn.toAlphaNumericChar(Math.floor(v/10))),p.append(qn.toAlphaNumericChar(v%10))}else if(x===1){if(f.available()<4)throw new O;const v=f.readBits(4);if(v>=10)throw new O;p.append(qn.toAlphaNumericChar(v))}}static parseECIValue(f){const p=f.readBits(8);if(!(p&128))return p&127;if((p&192)===128){const x=f.readBits(8);return(p&63)<<8&4294967295|x}if((p&224)===192){const x=f.readBits(16);return(p&31)<<16&4294967295|x}throw new O}}qn.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",qn.GB2312_SUBSET=1;class Ok{constructor(f){this.mirrored=f}isMirrored(){return this.mirrored}applyMirroredCorrection(f){if(!this.mirrored||f===null||f.length<3)return;const p=f[0];f[0]=f[2],f[2]=p}}class SG{constructor(){this.rsDecoder=new wt(We.QR_CODE_FIELD_256)}decodeBooleanArray(f,p){return this.decodeBitMatrix(U.parseFromBooleanArray(f),p)}decodeBitMatrix(f,p){const x=new jG(f);let v=null;try{return this.decodeBitMatrixParser(x,p)}catch(w){v=w}try{x.remask(),x.setMirror(!0),x.readVersion(),x.readFormatInformation(),x.mirror();const w=this.decodeBitMatrixParser(x,p);return w.setOther(new Ok(!0)),w}catch(w){throw v!==null?v:w}}decodeBitMatrixParser(f,p){const x=f.readVersion(),v=f.readFormatInformation().getErrorCorrectionLevel(),w=f.readCodewords(),C=aw.getDataBlocks(w,x,v);let E=0;for(const B of C)E+=B.getNumDataCodewords();const I=new Uint8Array(E);let R=0;for(const B of C){const W=B.getCodewords(),Y=B.getNumDataCodewords();this.correctErrors(W,Y);for(let ee=0;ee<Y;ee++)I[R++]=W[ee]}return qn.decode(I,x,v,p)}correctErrors(f,p){const x=new Int32Array(f);try{this.rsDecoder.decode(x,f.length-p)}catch{throw new y}for(let v=0;v<p;v++)f[v]=x[v]}}class iw extends le{constructor(f,p,x){super(f,p),this.estimatedModuleSize=x}aboutEquals(f,p,x){if(Math.abs(p-this.getY())<=f&&Math.abs(x-this.getX())<=f){const v=Math.abs(f-this.estimatedModuleSize);return v<=1||v<=this.estimatedModuleSize}return!1}combineEstimate(f,p,x){const v=(this.getX()+p)/2,w=(this.getY()+f)/2,C=(this.estimatedModuleSize+x)/2;return new iw(v,w,C)}}class Fx{constructor(f,p,x,v,w,C,E){this.image=f,this.startX=p,this.startY=x,this.width=v,this.height=w,this.moduleSize=C,this.resultPointCallback=E,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const f=this.startX,p=this.height,x=this.width,v=f+x,w=this.startY+p/2,C=new Int32Array(3),E=this.image;for(let I=0;I<p;I++){const R=w+(I&1?-Math.floor((I+1)/2):Math.floor((I+1)/2));C[0]=0,C[1]=0,C[2]=0;let B=f;for(;B<v&&!E.get(B,R);)B++;let W=0;for(;B<v;){if(E.get(B,R))if(W===1)C[1]++;else if(W===2){if(this.foundPatternCross(C)){const Y=this.handlePossibleCenter(C,R,B);if(Y!==null)return Y}C[0]=C[2],C[1]=1,C[2]=0,W=1}else C[++W]++;else W===1&&W++,C[W]++;B++}if(this.foundPatternCross(C)){const Y=this.handlePossibleCenter(C,R,v);if(Y!==null)return Y}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new z}static centerFromEnd(f,p){return p-f[2]-f[1]/2}foundPatternCross(f){const p=this.moduleSize,x=p/2;for(let v=0;v<3;v++)if(Math.abs(p-f[v])>=x)return!1;return!0}crossCheckVertical(f,p,x,v){const w=this.image,C=w.getHeight(),E=this.crossCheckStateCount;E[0]=0,E[1]=0,E[2]=0;let I=f;for(;I>=0&&w.get(p,I)&&E[1]<=x;)E[1]++,I--;if(I<0||E[1]>x)return NaN;for(;I>=0&&!w.get(p,I)&&E[0]<=x;)E[0]++,I--;if(E[0]>x)return NaN;for(I=f+1;I<C&&w.get(p,I)&&E[1]<=x;)E[1]++,I++;if(I===C||E[1]>x)return NaN;for(;I<C&&!w.get(p,I)&&E[2]<=x;)E[2]++,I++;if(E[2]>x)return NaN;const R=E[0]+E[1]+E[2];return 5*Math.abs(R-v)>=2*v?NaN:this.foundPatternCross(E)?Fx.centerFromEnd(E,I):NaN}handlePossibleCenter(f,p,x){const v=f[0]+f[1]+f[2],w=Fx.centerFromEnd(f,x),C=this.crossCheckVertical(p,w,2*f[1],v);if(!isNaN(C)){const E=(f[0]+f[1]+f[2])/3;for(const R of this.possibleCenters)if(R.aboutEquals(E,C,w))return R.combineEstimate(C,w,E);const I=new iw(w,C,E);this.possibleCenters.push(I),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(I)}return null}}class ow extends le{constructor(f,p,x,v){super(f,p),this.estimatedModuleSize=x,this.count=v,v===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(f,p,x){if(Math.abs(p-this.getY())<=f&&Math.abs(x-this.getX())<=f){const v=Math.abs(f-this.estimatedModuleSize);return v<=1||v<=this.estimatedModuleSize}return!1}combineEstimate(f,p,x){const v=this.count+1,w=(this.count*this.getX()+p)/v,C=(this.count*this.getY()+f)/v,E=(this.count*this.estimatedModuleSize+x)/v;return new ow(w,C,E,v)}}class CG{constructor(f){this.bottomLeft=f[0],this.topLeft=f[1],this.topRight=f[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class Yr{constructor(f,p){this.image=f,this.resultPointCallback=p,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=p}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(f){const p=f!=null&&f.get(M.TRY_HARDER)!==void 0,x=f!=null&&f.get(M.PURE_BARCODE)!==void 0,v=this.image,w=v.getHeight(),C=v.getWidth();let E=Math.floor(3*w/(4*Yr.MAX_MODULES));(E<Yr.MIN_SKIP||p)&&(E=Yr.MIN_SKIP);let I=!1;const R=new Int32Array(5);for(let W=E-1;W<w&&!I;W+=E){R[0]=0,R[1]=0,R[2]=0,R[3]=0,R[4]=0;let Y=0;for(let ee=0;ee<C;ee++)if(v.get(ee,W))(Y&1)===1&&Y++,R[Y]++;else if(Y&1)R[Y]++;else if(Y===4)if(Yr.foundPatternCross(R)){if(this.handlePossibleCenter(R,W,ee,x)===!0)if(E=2,this.hasSkipped===!0)I=this.haveMultiplyConfirmedCenters();else{const ce=this.findRowSkip();ce>R[2]&&(W+=ce-R[2]-E,ee=C-1)}else{R[0]=R[2],R[1]=R[3],R[2]=R[4],R[3]=1,R[4]=0,Y=3;continue}Y=0,R[0]=0,R[1]=0,R[2]=0,R[3]=0,R[4]=0}else R[0]=R[2],R[1]=R[3],R[2]=R[4],R[3]=1,R[4]=0,Y=3;else R[++Y]++;Yr.foundPatternCross(R)&&this.handlePossibleCenter(R,W,C,x)===!0&&(E=R[0],this.hasSkipped&&(I=this.haveMultiplyConfirmedCenters()))}const B=this.selectBestPatterns();return le.orderBestPatterns(B),new CG(B)}static centerFromEnd(f,p){return p-f[4]-f[3]-f[2]/2}static foundPatternCross(f){let p=0;for(let w=0;w<5;w++){const C=f[w];if(C===0)return!1;p+=C}if(p<7)return!1;const x=p/7,v=x/2;return Math.abs(x-f[0])<v&&Math.abs(x-f[1])<v&&Math.abs(3*x-f[2])<3*v&&Math.abs(x-f[3])<v&&Math.abs(x-f[4])<v}getCrossCheckStateCount(){const f=this.crossCheckStateCount;return f[0]=0,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f}crossCheckDiagonal(f,p,x,v){const w=this.getCrossCheckStateCount();let C=0;const E=this.image;for(;f>=C&&p>=C&&E.get(p-C,f-C);)w[2]++,C++;if(f<C||p<C)return!1;for(;f>=C&&p>=C&&!E.get(p-C,f-C)&&w[1]<=x;)w[1]++,C++;if(f<C||p<C||w[1]>x)return!1;for(;f>=C&&p>=C&&E.get(p-C,f-C)&&w[0]<=x;)w[0]++,C++;if(w[0]>x)return!1;const I=E.getHeight(),R=E.getWidth();for(C=1;f+C<I&&p+C<R&&E.get(p+C,f+C);)w[2]++,C++;if(f+C>=I||p+C>=R)return!1;for(;f+C<I&&p+C<R&&!E.get(p+C,f+C)&&w[3]<x;)w[3]++,C++;if(f+C>=I||p+C>=R||w[3]>=x)return!1;for(;f+C<I&&p+C<R&&E.get(p+C,f+C)&&w[4]<x;)w[4]++,C++;if(w[4]>=x)return!1;const B=w[0]+w[1]+w[2]+w[3]+w[4];return Math.abs(B-v)<2*v&&Yr.foundPatternCross(w)}crossCheckVertical(f,p,x,v){const w=this.image,C=w.getHeight(),E=this.getCrossCheckStateCount();let I=f;for(;I>=0&&w.get(p,I);)E[2]++,I--;if(I<0)return NaN;for(;I>=0&&!w.get(p,I)&&E[1]<=x;)E[1]++,I--;if(I<0||E[1]>x)return NaN;for(;I>=0&&w.get(p,I)&&E[0]<=x;)E[0]++,I--;if(E[0]>x)return NaN;for(I=f+1;I<C&&w.get(p,I);)E[2]++,I++;if(I===C)return NaN;for(;I<C&&!w.get(p,I)&&E[3]<x;)E[3]++,I++;if(I===C||E[3]>=x)return NaN;for(;I<C&&w.get(p,I)&&E[4]<x;)E[4]++,I++;if(E[4]>=x)return NaN;const R=E[0]+E[1]+E[2]+E[3]+E[4];return 5*Math.abs(R-v)>=2*v?NaN:Yr.foundPatternCross(E)?Yr.centerFromEnd(E,I):NaN}crossCheckHorizontal(f,p,x,v){const w=this.image,C=w.getWidth(),E=this.getCrossCheckStateCount();let I=f;for(;I>=0&&w.get(I,p);)E[2]++,I--;if(I<0)return NaN;for(;I>=0&&!w.get(I,p)&&E[1]<=x;)E[1]++,I--;if(I<0||E[1]>x)return NaN;for(;I>=0&&w.get(I,p)&&E[0]<=x;)E[0]++,I--;if(E[0]>x)return NaN;for(I=f+1;I<C&&w.get(I,p);)E[2]++,I++;if(I===C)return NaN;for(;I<C&&!w.get(I,p)&&E[3]<x;)E[3]++,I++;if(I===C||E[3]>=x)return NaN;for(;I<C&&w.get(I,p)&&E[4]<x;)E[4]++,I++;if(E[4]>=x)return NaN;const R=E[0]+E[1]+E[2]+E[3]+E[4];return 5*Math.abs(R-v)>=v?NaN:Yr.foundPatternCross(E)?Yr.centerFromEnd(E,I):NaN}handlePossibleCenter(f,p,x,v){const w=f[0]+f[1]+f[2]+f[3]+f[4];let C=Yr.centerFromEnd(f,x),E=this.crossCheckVertical(p,Math.floor(C),f[2],w);if(!isNaN(E)&&(C=this.crossCheckHorizontal(Math.floor(C),Math.floor(E),f[2],w),!isNaN(C)&&(!v||this.crossCheckDiagonal(Math.floor(E),Math.floor(C),f[2],w)))){const I=w/7;let R=!1;const B=this.possibleCenters;for(let W=0,Y=B.length;W<Y;W++){const ee=B[W];if(ee.aboutEquals(I,E,C)){B[W]=ee.combineEstimate(E,C,I),R=!0;break}}if(!R){const W=new ow(C,E,I);B.push(W),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(W)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let p=null;for(const x of this.possibleCenters)if(x.getCount()>=Yr.CENTER_QUORUM)if(p==null)p=x;else return this.hasSkipped=!0,Math.floor((Math.abs(p.getX()-x.getX())-Math.abs(p.getY()-x.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let f=0,p=0;const x=this.possibleCenters.length;for(const C of this.possibleCenters)C.getCount()>=Yr.CENTER_QUORUM&&(f++,p+=C.getEstimatedModuleSize());if(f<3)return!1;const v=p/x;let w=0;for(const C of this.possibleCenters)w+=Math.abs(C.getEstimatedModuleSize()-v);return w<=.05*p}selectBestPatterns(){const f=this.possibleCenters.length;if(f<3)throw new z;const p=this.possibleCenters;let x;if(f>3){let v=0,w=0;for(const I of this.possibleCenters){const R=I.getEstimatedModuleSize();v+=R,w+=R*R}x=v/f;let C=Math.sqrt(w/f-x*x);p.sort((I,R)=>{const B=Math.abs(R.getEstimatedModuleSize()-x),W=Math.abs(I.getEstimatedModuleSize()-x);return B<W?-1:B>W?1:0});const E=Math.max(.2*x,C);for(let I=0;I<p.length&&p.length>3;I++){const R=p[I];Math.abs(R.getEstimatedModuleSize()-x)>E&&(p.splice(I,1),I--)}}if(p.length>3){let v=0;for(const w of p)v+=w.getEstimatedModuleSize();x=v/p.length,p.sort((w,C)=>{if(C.getCount()===w.getCount()){const E=Math.abs(C.getEstimatedModuleSize()-x),I=Math.abs(w.getEstimatedModuleSize()-x);return E<I?1:E>I?-1:0}else return C.getCount()-w.getCount()}),p.splice(3)}return[p[0],p[1],p[2]]}}Yr.CENTER_QUORUM=2,Yr.MIN_SKIP=3,Yr.MAX_MODULES=57;class $h{constructor(f){this.image=f}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(f){this.resultPointCallback=f==null?null:f.get(M.NEED_RESULT_POINT_CALLBACK);const x=new Yr(this.image,this.resultPointCallback).find(f);return this.processFinderPatternInfo(x)}processFinderPatternInfo(f){const p=f.getTopLeft(),x=f.getTopRight(),v=f.getBottomLeft(),w=this.calculateModuleSize(p,x,v);if(w<1)throw new z("No pattern found in proccess finder.");const C=$h.computeDimension(p,x,v,w),E=pt.getProvisionalVersionForDimension(C),I=E.getDimensionForVersion()-7;let R=null;if(E.getAlignmentPatternCenters().length>0){const ee=x.getX()-p.getX()+v.getX(),oe=x.getY()-p.getY()+v.getY(),ce=1-3/I,ge=Math.floor(p.getX()+ce*(ee-p.getX())),Ae=Math.floor(p.getY()+ce*(oe-p.getY()));for(let $e=4;$e<=16;$e<<=1)try{R=this.findAlignmentInRegion(w,ge,Ae,$e);break}catch(Ve){if(!(Ve instanceof z))throw Ve}}const B=$h.createTransform(p,x,v,R,C),W=$h.sampleGrid(this.image,B,C);let Y;return R===null?Y=[v,p,x]:Y=[v,p,x,R],new De(W,Y)}static createTransform(f,p,x,v,w){const C=w-3.5;let E,I,R,B;return v!==null?(E=v.getX(),I=v.getY(),R=C-3,B=R):(E=p.getX()-f.getX()+x.getX(),I=p.getY()-f.getY()+x.getY(),R=C,B=C),Pt.quadrilateralToQuadrilateral(3.5,3.5,C,3.5,R,B,3.5,C,f.getX(),f.getY(),p.getX(),p.getY(),E,I,x.getX(),x.getY())}static sampleGrid(f,p,x){return In.getInstance().sampleGridWithTransform(f,x,x,p)}static computeDimension(f,p,x,v){const w=qe.round(le.distance(f,p)/v),C=qe.round(le.distance(f,x)/v);let E=Math.floor((w+C)/2)+7;switch(E&3){case 0:E++;break;case 2:E--;break;case 3:throw new z("Dimensions could be not found.")}return E}calculateModuleSize(f,p,x){return(this.calculateModuleSizeOneWay(f,p)+this.calculateModuleSizeOneWay(f,x))/2}calculateModuleSizeOneWay(f,p){const x=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(f.getX()),Math.floor(f.getY()),Math.floor(p.getX()),Math.floor(p.getY())),v=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(p.getX()),Math.floor(p.getY()),Math.floor(f.getX()),Math.floor(f.getY()));return isNaN(x)?v/7:isNaN(v)?x/7:(x+v)/14}sizeOfBlackWhiteBlackRunBothWays(f,p,x,v){let w=this.sizeOfBlackWhiteBlackRun(f,p,x,v),C=1,E=f-(x-f);E<0?(C=f/(f-E),E=0):E>=this.image.getWidth()&&(C=(this.image.getWidth()-1-f)/(E-f),E=this.image.getWidth()-1);let I=Math.floor(p-(v-p)*C);return C=1,I<0?(C=p/(p-I),I=0):I>=this.image.getHeight()&&(C=(this.image.getHeight()-1-p)/(I-p),I=this.image.getHeight()-1),E=Math.floor(f+(E-f)*C),w+=this.sizeOfBlackWhiteBlackRun(f,p,E,I),w-1}sizeOfBlackWhiteBlackRun(f,p,x,v){const w=Math.abs(v-p)>Math.abs(x-f);if(w){let ee=f;f=p,p=ee,ee=x,x=v,v=ee}const C=Math.abs(x-f),E=Math.abs(v-p);let I=-C/2;const R=f<x?1:-1,B=p<v?1:-1;let W=0;const Y=x+R;for(let ee=f,oe=p;ee!==Y;ee+=R){const ce=w?oe:ee,ge=w?ee:oe;if(W===1===this.image.get(ce,ge)){if(W===2)return qe.distance(ee,oe,f,p);W++}if(I+=E,I>0){if(oe===v)break;oe+=B,I-=C}}return W===2?qe.distance(x+R,v,f,p):NaN}findAlignmentInRegion(f,p,x,v){const w=Math.floor(v*f),C=Math.max(0,p-w),E=Math.min(this.image.getWidth()-1,p+w);if(E-C<f*3)throw new z("Alignment top exceeds estimated module size.");const I=Math.max(0,x-w),R=Math.min(this.image.getHeight()-1,x+w);if(R-I<f*3)throw new z("Alignment bottom exceeds estimated module size.");return new Fx(this.image,C,I,E-C,R-I,f,this.resultPointCallback).find()}}class Bl{constructor(){this.decoder=new SG}getDecoder(){return this.decoder}decode(f,p){let x,v;if(p!=null&&p.get(M.PURE_BARCODE)!==void 0){const I=Bl.extractPureBits(f.getBlackMatrix());x=this.decoder.decodeBitMatrix(I,p),v=Bl.NO_POINTS}else{const I=new $h(f.getBlackMatrix()).detect(p);x=this.decoder.decodeBitMatrix(I.getBits(),p),v=I.getPoints()}x.getOther()instanceof Ok&&x.getOther().applyMirroredCorrection(v);const w=new be(x.getText(),x.getRawBytes(),void 0,v,_e.QR_CODE,void 0),C=x.getByteSegments();C!==null&&w.putMetadata(Oe.BYTE_SEGMENTS,C);const E=x.getECLevel();return E!==null&&w.putMetadata(Oe.ERROR_CORRECTION_LEVEL,E),x.hasStructuredAppend()&&(w.putMetadata(Oe.STRUCTURED_APPEND_SEQUENCE,x.getStructuredAppendSequenceNumber()),w.putMetadata(Oe.STRUCTURED_APPEND_PARITY,x.getStructuredAppendParity())),w}reset(){}static extractPureBits(f){const p=f.getTopLeftOnBit(),x=f.getBottomRightOnBit();if(p===null||x===null)throw new z;const v=this.moduleSize(p,f);let w=p[1],C=x[1],E=p[0],I=x[0];if(E>=I||w>=C)throw new z;if(C-w!==I-E&&(I=E+(C-w),I>=f.getWidth()))throw new z;const R=Math.round((I-E+1)/v),B=Math.round((C-w+1)/v);if(R<=0||B<=0)throw new z;if(B!==R)throw new z;const W=Math.floor(v/2);w+=W,E+=W;const Y=E+Math.floor((R-1)*v)-I;if(Y>0){if(Y>W)throw new z;E-=Y}const ee=w+Math.floor((B-1)*v)-C;if(ee>0){if(ee>W)throw new z;w-=ee}const oe=new U(R,B);for(let ce=0;ce<B;ce++){const ge=w+Math.floor(ce*v);for(let Ae=0;Ae<R;Ae++)f.get(E+Math.floor(Ae*v),ge)&&oe.set(Ae,ce)}return oe}static moduleSize(f,p){const x=p.getHeight(),v=p.getWidth();let w=f[0],C=f[1],E=!0,I=0;for(;w<v&&C<x;){if(E!==p.get(w,C)){if(++I===5)break;E=!E}w++,C++}if(w===v||C===x)throw new z;return(w-f[0])/7}}Bl.NO_POINTS=new Array;class At{PDF417Common(){}static getBitCountSum(f){return qe.sum(f)}static toIntArray(f){if(f==null||!f.length)return At.EMPTY_INT_ARRAY;const p=new Int32Array(f.length);let x=0;for(const v of f)p[x++]=v;return p}static getCodeword(f){const p=A.binarySearch(At.SYMBOL_TABLE,f&262143);return p<0?-1:(At.CODEWORD_TABLE[p]-1)%At.NUMBER_OF_CODEWORDS}}At.NUMBER_OF_CODEWORDS=929,At.MAX_CODEWORDS_IN_BARCODE=At.NUMBER_OF_CODEWORDS-1,At.MIN_ROWS_IN_BARCODE=3,At.MAX_ROWS_IN_BARCODE=90,At.MODULES_IN_CODEWORD=17,At.MODULES_IN_STOP_PATTERN=18,At.BARS_IN_MODULE=8,At.EMPTY_INT_ARRAY=new Int32Array([]),At.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),At.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class _G{constructor(f,p){this.bits=f,this.points=p}getBits(){return this.bits}getPoints(){return this.points}}class Bt{static detectMultiple(f,p,x){let v=f.getBlackMatrix(),w=Bt.detect(x,v);return w.length||(v=v.clone(),v.rotate180(),w=Bt.detect(x,v)),new _G(v,w)}static detect(f,p){const x=new Array;let v=0,w=0,C=!1;for(;v<p.getHeight();){const E=Bt.findVertices(p,v,w);if(E[0]==null&&E[3]==null){if(!C)break;C=!1,w=0;for(const I of x)I[1]!=null&&(v=Math.trunc(Math.max(v,I[1].getY()))),I[3]!=null&&(v=Math.max(v,Math.trunc(I[3].getY())));v+=Bt.ROW_STEP;continue}if(C=!0,x.push(E),!f)break;E[2]!=null?(w=Math.trunc(E[2].getX()),v=Math.trunc(E[2].getY())):(w=Math.trunc(E[4].getX()),v=Math.trunc(E[4].getY()))}return x}static findVertices(f,p,x){const v=f.getHeight(),w=f.getWidth(),C=new Array(8);return Bt.copyToResult(C,Bt.findRowsWithPattern(f,v,w,p,x,Bt.START_PATTERN),Bt.INDEXES_START_PATTERN),C[4]!=null&&(x=Math.trunc(C[4].getX()),p=Math.trunc(C[4].getY())),Bt.copyToResult(C,Bt.findRowsWithPattern(f,v,w,p,x,Bt.STOP_PATTERN),Bt.INDEXES_STOP_PATTERN),C}static copyToResult(f,p,x){for(let v=0;v<x.length;v++)f[x[v]]=p[v]}static findRowsWithPattern(f,p,x,v,w,C){const E=new Array(4);let I=!1;const R=new Int32Array(C.length);for(;v<p;v+=Bt.ROW_STEP){let W=Bt.findGuardPattern(f,w,v,x,!1,C,R);if(W!=null){for(;v>0;){const Y=Bt.findGuardPattern(f,w,--v,x,!1,C,R);if(Y!=null)W=Y;else{v++;break}}E[0]=new le(W[0],v),E[1]=new le(W[1],v),I=!0;break}}let B=v+1;if(I){let W=0,Y=Int32Array.from([Math.trunc(E[0].getX()),Math.trunc(E[1].getX())]);for(;B<p;B++){const ee=Bt.findGuardPattern(f,Y[0],B,x,!1,C,R);if(ee!=null&&Math.abs(Y[0]-ee[0])<Bt.MAX_PATTERN_DRIFT&&Math.abs(Y[1]-ee[1])<Bt.MAX_PATTERN_DRIFT)Y=ee,W=0;else{if(W>Bt.SKIPPED_ROW_COUNT_MAX)break;W++}}B-=W+1,E[2]=new le(Y[0],B),E[3]=new le(Y[1],B)}return B-v<Bt.BARCODE_MIN_HEIGHT&&A.fill(E,null),E}static findGuardPattern(f,p,x,v,w,C,E){A.fillWithin(E,0,E.length,0);let I=p,R=0;for(;f.get(I,x)&&I>0&&R++<Bt.MAX_PIXEL_DRIFT;)I--;let B=I,W=0,Y=C.length;for(let ee=w;B<v;B++)if(f.get(B,x)!==ee)E[W]++;else{if(W===Y-1){if(Bt.patternMatchVariance(E,C,Bt.MAX_INDIVIDUAL_VARIANCE)<Bt.MAX_AVG_VARIANCE)return new Int32Array([I,B]);I+=E[0]+E[1],j.arraycopy(E,2,E,0,W-1),E[W-1]=0,E[W]=0,W--}else W++;E[W]=1,ee=!ee}return W===Y-1&&Bt.patternMatchVariance(E,C,Bt.MAX_INDIVIDUAL_VARIANCE)<Bt.MAX_AVG_VARIANCE?new Int32Array([I,B-1]):null}static patternMatchVariance(f,p,x){let v=f.length,w=0,C=0;for(let R=0;R<v;R++)w+=f[R],C+=p[R];if(w<C)return 1/0;let E=w/C;x*=E;let I=0;for(let R=0;R<v;R++){let B=f[R],W=p[R]*E,Y=B>W?B-W:W-B;if(Y>x)return 1/0;I+=Y}return I/w}}Bt.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Bt.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Bt.MAX_AVG_VARIANCE=.42,Bt.MAX_INDIVIDUAL_VARIANCE=.8,Bt.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Bt.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Bt.MAX_PIXEL_DRIFT=3,Bt.MAX_PATTERN_DRIFT=5,Bt.SKIPPED_ROW_COUNT_MAX=25,Bt.ROW_STEP=5,Bt.BARCODE_MIN_HEIGHT=10;class ss{constructor(f,p){if(p.length===0)throw new m;this.field=f;let x=p.length;if(x>1&&p[0]===0){let v=1;for(;v<x&&p[v]===0;)v++;v===x?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(x-v),j.arraycopy(p,v,this.coefficients,0,this.coefficients.length))}else this.coefficients=p}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(f){return this.coefficients[this.coefficients.length-1-f]}evaluateAt(f){if(f===0)return this.getCoefficient(0);if(f===1){let v=0;for(let w of this.coefficients)v=this.field.add(v,w);return v}let p=this.coefficients[0],x=this.coefficients.length;for(let v=1;v<x;v++)p=this.field.add(this.field.multiply(f,p),this.coefficients[v]);return p}add(f){if(!this.field.equals(f.field))throw new m("ModulusPolys do not have same ModulusGF field");if(this.isZero())return f;if(f.isZero())return this;let p=this.coefficients,x=f.coefficients;if(p.length>x.length){let C=p;p=x,x=C}let v=new Int32Array(x.length),w=x.length-p.length;j.arraycopy(x,0,v,0,w);for(let C=w;C<x.length;C++)v[C]=this.field.add(p[C-w],x[C]);return new ss(this.field,v)}subtract(f){if(!this.field.equals(f.field))throw new m("ModulusPolys do not have same ModulusGF field");return f.isZero()?this:this.add(f.negative())}multiply(f){return f instanceof ss?this.multiplyOther(f):this.multiplyScalar(f)}multiplyOther(f){if(!this.field.equals(f.field))throw new m("ModulusPolys do not have same ModulusGF field");if(this.isZero()||f.isZero())return new ss(this.field,new Int32Array([0]));let p=this.coefficients,x=p.length,v=f.coefficients,w=v.length,C=new Int32Array(x+w-1);for(let E=0;E<x;E++){let I=p[E];for(let R=0;R<w;R++)C[E+R]=this.field.add(C[E+R],this.field.multiply(I,v[R]))}return new ss(this.field,C)}negative(){let f=this.coefficients.length,p=new Int32Array(f);for(let x=0;x<f;x++)p[x]=this.field.subtract(0,this.coefficients[x]);return new ss(this.field,p)}multiplyScalar(f){if(f===0)return new ss(this.field,new Int32Array([0]));if(f===1)return this;let p=this.coefficients.length,x=new Int32Array(p);for(let v=0;v<p;v++)x[v]=this.field.multiply(this.coefficients[v],f);return new ss(this.field,x)}multiplyByMonomial(f,p){if(f<0)throw new m;if(p===0)return new ss(this.field,new Int32Array([0]));let x=this.coefficients.length,v=new Int32Array(x+f);for(let w=0;w<x;w++)v[w]=this.field.multiply(this.coefficients[w],p);return new ss(this.field,v)}toString(){let f=new Q;for(let p=this.getDegree();p>=0;p--){let x=this.getCoefficient(p);x!==0&&(x<0?(f.append(" - "),x=-x):f.length()>0&&f.append(" + "),(p===0||x!==1)&&f.append(x),p!==0&&(p===1?f.append("x"):(f.append("x^"),f.append(p))))}return f.toString()}}class AG{add(f,p){return(f+p)%this.modulus}subtract(f,p){return(this.modulus+f-p)%this.modulus}exp(f){return this.expTable[f]}log(f){if(f===0)throw new m;return this.logTable[f]}inverse(f){if(f===0)throw new re;return this.expTable[this.modulus-this.logTable[f]-1]}multiply(f,p){return f===0||p===0?0:this.expTable[(this.logTable[f]+this.logTable[p])%(this.modulus-1)]}getSize(){return this.modulus}equals(f){return f===this}}class lw extends AG{constructor(f,p){super(),this.modulus=f,this.expTable=new Int32Array(f),this.logTable=new Int32Array(f);let x=1;for(let v=0;v<f;v++)this.expTable[v]=x,x=x*p%f;for(let v=0;v<f-1;v++)this.logTable[this.expTable[v]]=v;this.zero=new ss(this,new Int32Array([0])),this.one=new ss(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(f,p){if(f<0)throw new m;if(p===0)return this.zero;let x=new Int32Array(f+1);return x[0]=p,new ss(this,x)}}lw.PDF417_GF=new lw(At.NUMBER_OF_CODEWORDS,3);class Dk{constructor(){this.field=lw.PDF417_GF}decode(f,p,x){let v=new ss(this.field,f),w=new Int32Array(p),C=!1;for(let oe=p;oe>0;oe--){let ce=v.evaluateAt(this.field.exp(oe));w[p-oe]=ce,ce!==0&&(C=!0)}if(!C)return 0;let E=this.field.getOne();if(x!=null)for(const oe of x){let ce=this.field.exp(f.length-1-oe),ge=new ss(this.field,new Int32Array([this.field.subtract(0,ce),1]));E=E.multiply(ge)}let I=new ss(this.field,w),R=this.runEuclideanAlgorithm(this.field.buildMonomial(p,1),I,p),B=R[0],W=R[1],Y=this.findErrorLocations(B),ee=this.findErrorMagnitudes(W,B,Y);for(let oe=0;oe<Y.length;oe++){let ce=f.length-1-this.field.log(Y[oe]);if(ce<0)throw y.getChecksumInstance();f[ce]=this.field.subtract(f[ce],ee[oe])}return Y.length}runEuclideanAlgorithm(f,p,x){if(f.getDegree()<p.getDegree()){let Y=f;f=p,p=Y}let v=f,w=p,C=this.field.getZero(),E=this.field.getOne();for(;w.getDegree()>=Math.round(x/2);){let Y=v,ee=C;if(v=w,C=E,v.isZero())throw y.getChecksumInstance();w=Y;let oe=this.field.getZero(),ce=v.getCoefficient(v.getDegree()),ge=this.field.inverse(ce);for(;w.getDegree()>=v.getDegree()&&!w.isZero();){let Ae=w.getDegree()-v.getDegree(),$e=this.field.multiply(w.getCoefficient(w.getDegree()),ge);oe=oe.add(this.field.buildMonomial(Ae,$e)),w=w.subtract(v.multiplyByMonomial(Ae,$e))}E=oe.multiply(C).subtract(ee).negative()}let I=E.getCoefficient(0);if(I===0)throw y.getChecksumInstance();let R=this.field.inverse(I),B=E.multiply(R),W=w.multiply(R);return[B,W]}findErrorLocations(f){let p=f.getDegree(),x=new Int32Array(p),v=0;for(let w=1;w<this.field.getSize()&&v<p;w++)f.evaluateAt(w)===0&&(x[v]=this.field.inverse(w),v++);if(v!==p)throw y.getChecksumInstance();return x}findErrorMagnitudes(f,p,x){let v=p.getDegree(),w=new Int32Array(v);for(let R=1;R<=v;R++)w[v-R]=this.field.multiply(R,p.getCoefficient(R));let C=new ss(this.field,w),E=x.length,I=new Int32Array(E);for(let R=0;R<E;R++){let B=this.field.inverse(x[R]),W=this.field.subtract(0,f.evaluateAt(B)),Y=this.field.inverse(C.evaluateAt(B));I[R]=this.field.multiply(W,Y)}return I}}class ad{constructor(f,p,x,v,w){f instanceof ad?this.constructor_2(f):this.constructor_1(f,p,x,v,w)}constructor_1(f,p,x,v,w){const C=p==null||x==null,E=v==null||w==null;if(C&&E)throw new z;C?(p=new le(0,v.getY()),x=new le(0,w.getY())):E&&(v=new le(f.getWidth()-1,p.getY()),w=new le(f.getWidth()-1,x.getY())),this.image=f,this.topLeft=p,this.bottomLeft=x,this.topRight=v,this.bottomRight=w,this.minX=Math.trunc(Math.min(p.getX(),x.getX())),this.maxX=Math.trunc(Math.max(v.getX(),w.getX())),this.minY=Math.trunc(Math.min(p.getY(),v.getY())),this.maxY=Math.trunc(Math.max(x.getY(),w.getY()))}constructor_2(f){this.image=f.image,this.topLeft=f.getTopLeft(),this.bottomLeft=f.getBottomLeft(),this.topRight=f.getTopRight(),this.bottomRight=f.getBottomRight(),this.minX=f.getMinX(),this.maxX=f.getMaxX(),this.minY=f.getMinY(),this.maxY=f.getMaxY()}static merge(f,p){return f==null?p:p==null?f:new ad(f.image,f.topLeft,f.bottomLeft,p.topRight,p.bottomRight)}addMissingRows(f,p,x){let v=this.topLeft,w=this.bottomLeft,C=this.topRight,E=this.bottomRight;if(f>0){let I=x?this.topLeft:this.topRight,R=Math.trunc(I.getY()-f);R<0&&(R=0);let B=new le(I.getX(),R);x?v=B:C=B}if(p>0){let I=x?this.bottomLeft:this.bottomRight,R=Math.trunc(I.getY()+p);R>=this.image.getHeight()&&(R=this.image.getHeight()-1);let B=new le(I.getX(),R);x?w=B:E=B}return new ad(this.image,v,w,C,E)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class EG{constructor(f,p,x,v){this.columnCount=f,this.errorCorrectionLevel=v,this.rowCountUpperPart=p,this.rowCountLowerPart=x,this.rowCount=p+x}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class zh{constructor(){this.buffer=""}static form(f,p){let x=-1;function v(C,E,I,R,B,W){if(C==="%%")return"%";if(p[++x]===void 0)return;C=R?parseInt(R.substr(1)):void 0;let Y=B?parseInt(B.substr(1)):void 0,ee;switch(W){case"s":ee=p[x];break;case"c":ee=p[x][0];break;case"f":ee=parseFloat(p[x]).toFixed(C);break;case"p":ee=parseFloat(p[x]).toPrecision(C);break;case"e":ee=parseFloat(p[x]).toExponential(C);break;case"x":ee=parseInt(p[x]).toString(Y||16);break;case"d":ee=parseFloat(parseInt(p[x],Y||10).toPrecision(C)).toFixed(0);break}ee=typeof ee=="object"?JSON.stringify(ee):(+ee).toString(Y);let oe=parseInt(I),ce=I&&I[0]+""=="0"?"0":" ";for(;ee.length<oe;)ee=E!==void 0?ee+ce:ce+ee;return ee}let w=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return f.replace(w,v)}format(f,...p){this.buffer+=zh.form(f,p)}toString(){return this.buffer}}class Uh{constructor(f){this.boundingBox=new ad(f),this.codewords=new Array(f.getMaxY()-f.getMinY()+1)}getCodewordNearby(f){let p=this.getCodeword(f);if(p!=null)return p;for(let x=1;x<Uh.MAX_NEARBY_DISTANCE;x++){let v=this.imageRowToCodewordIndex(f)-x;if(v>=0&&(p=this.codewords[v],p!=null)||(v=this.imageRowToCodewordIndex(f)+x,v<this.codewords.length&&(p=this.codewords[v],p!=null)))return p}return null}imageRowToCodewordIndex(f){return f-this.boundingBox.getMinY()}setCodeword(f,p){this.codewords[this.imageRowToCodewordIndex(f)]=p}getCodeword(f){return this.codewords[this.imageRowToCodewordIndex(f)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const f=new zh;let p=0;for(const x of this.codewords){if(x==null){f.format("%3d:    |   %n",p++);continue}f.format("%3d: %3d|%3d%n",p++,x.getRowNumber(),x.getValue())}return f.toString()}}Uh.MAX_NEARBY_DISTANCE=5;class Vh{constructor(){this.values=new Map}setValue(f){f=Math.trunc(f);let p=this.values.get(f);p==null&&(p=0),p++,this.values.set(f,p)}getValue(){let f=-1,p=new Array;for(const[x,v]of this.values.entries()){const w={getKey:()=>x,getValue:()=>v};w.getValue()>f?(f=w.getValue(),p=[],p.push(w.getKey())):w.getValue()===f&&p.push(w.getKey())}return At.toIntArray(p)}getConfidence(f){return this.values.get(f)}}class Rk extends Uh{constructor(f,p){super(f),this._isLeft=p}setRowNumbers(){for(let f of this.getCodewords())f!=null&&f.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(f){let p=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(p,f);let x=this.getBoundingBox(),v=this._isLeft?x.getTopLeft():x.getTopRight(),w=this._isLeft?x.getBottomLeft():x.getBottomRight(),C=this.imageRowToCodewordIndex(Math.trunc(v.getY())),E=this.imageRowToCodewordIndex(Math.trunc(w.getY())),I=-1,R=1,B=0;for(let W=C;W<E;W++){if(p[W]==null)continue;let Y=p[W],ee=Y.getRowNumber()-I;if(ee===0)B++;else if(ee===1)R=Math.max(R,B),B=1,I=Y.getRowNumber();else if(ee<0||Y.getRowNumber()>=f.getRowCount()||ee>W)p[W]=null;else{let oe;R>2?oe=(R-2)*ee:oe=ee;let ce=oe>=W;for(let ge=1;ge<=oe&&!ce;ge++)ce=p[W-ge]!=null;ce?p[W]=null:(I=Y.getRowNumber(),B=1)}}}getRowHeights(){let f=this.getBarcodeMetadata();if(f==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(f);let p=new Int32Array(f.getRowCount());for(let x of this.getCodewords())if(x!=null){let v=x.getRowNumber();if(v>=p.length)continue;p[v]++}return p}adjustIncompleteIndicatorColumnRowNumbers(f){let p=this.getBoundingBox(),x=this._isLeft?p.getTopLeft():p.getTopRight(),v=this._isLeft?p.getBottomLeft():p.getBottomRight(),w=this.imageRowToCodewordIndex(Math.trunc(x.getY())),C=this.imageRowToCodewordIndex(Math.trunc(v.getY())),E=this.getCodewords(),I=-1;for(let R=w;R<C;R++){if(E[R]==null)continue;let B=E[R];B.setRowNumberAsRowIndicatorColumn();let W=B.getRowNumber()-I;W===0||(W===1?I=B.getRowNumber():B.getRowNumber()>=f.getRowCount()?E[R]=null:I=B.getRowNumber())}}getBarcodeMetadata(){let f=this.getCodewords(),p=new Vh,x=new Vh,v=new Vh,w=new Vh;for(let E of f){if(E==null)continue;E.setRowNumberAsRowIndicatorColumn();let I=E.getValue()%30,R=E.getRowNumber();switch(this._isLeft||(R+=2),R%3){case 0:x.setValue(I*3+1);break;case 1:w.setValue(I/3),v.setValue(I%3);break;case 2:p.setValue(I+1);break}}if(p.getValue().length===0||x.getValue().length===0||v.getValue().length===0||w.getValue().length===0||p.getValue()[0]<1||x.getValue()[0]+v.getValue()[0]<At.MIN_ROWS_IN_BARCODE||x.getValue()[0]+v.getValue()[0]>At.MAX_ROWS_IN_BARCODE)return null;let C=new EG(p.getValue()[0],x.getValue()[0],v.getValue()[0],w.getValue()[0]);return this.removeIncorrectCodewords(f,C),C}removeIncorrectCodewords(f,p){for(let x=0;x<f.length;x++){let v=f[x];if(f[x]==null)continue;let w=v.getValue()%30,C=v.getRowNumber();if(C>p.getRowCount()){f[x]=null;continue}switch(this._isLeft||(C+=2),C%3){case 0:w*3+1!==p.getRowCountUpperPart()&&(f[x]=null);break;case 1:(Math.trunc(w/3)!==p.getErrorCorrectionLevel()||w%3!==p.getRowCountLowerPart())&&(f[x]=null);break;case 2:w+1!==p.getColumnCount()&&(f[x]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class Hh{constructor(f,p){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=f,this.barcodeColumnCount=f.getColumnCount(),this.boundingBox=p,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let f=At.MAX_CODEWORDS_IN_BARCODE,p;do p=f,f=this.adjustRowNumbersAndGetCount();while(f>0&&f<p);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(f){f!=null&&f.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let f=this.adjustRowNumbersByRow();if(f===0)return 0;for(let p=1;p<this.barcodeColumnCount+1;p++){let x=this.detectionResultColumns[p].getCodewords();for(let v=0;v<x.length;v++)x[v]!=null&&(x[v].hasValidRowNumber()||this.adjustRowNumbers(p,v,x))}return f}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let f=this.detectionResultColumns[0].getCodewords(),p=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let x=0;x<f.length;x++)if(f[x]!=null&&p[x]!=null&&f[x].getRowNumber()===p[x].getRowNumber())for(let v=1;v<=this.barcodeColumnCount;v++){let w=this.detectionResultColumns[v].getCodewords()[x];w!=null&&(w.setRowNumber(f[x].getRowNumber()),w.hasValidRowNumber()||(this.detectionResultColumns[v].getCodewords()[x]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let f=0,p=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let x=0;x<p.length;x++){if(p[x]==null)continue;let v=p[x].getRowNumber(),w=0;for(let C=this.barcodeColumnCount+1;C>0&&w<this.ADJUST_ROW_NUMBER_SKIP;C--){let E=this.detectionResultColumns[C].getCodewords()[x];E!=null&&(w=Hh.adjustRowNumberIfValid(v,w,E),E.hasValidRowNumber()||f++)}}return f}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let f=0,p=this.detectionResultColumns[0].getCodewords();for(let x=0;x<p.length;x++){if(p[x]==null)continue;let v=p[x].getRowNumber(),w=0;for(let C=1;C<this.barcodeColumnCount+1&&w<this.ADJUST_ROW_NUMBER_SKIP;C++){let E=this.detectionResultColumns[C].getCodewords()[x];E!=null&&(w=Hh.adjustRowNumberIfValid(v,w,E),E.hasValidRowNumber()||f++)}}return f}static adjustRowNumberIfValid(f,p,x){return x==null||x.hasValidRowNumber()||(x.isValidRowNumber(f)?(x.setRowNumber(f),p=0):++p),p}adjustRowNumbers(f,p,x){if(!this.detectionResultColumns[f-1])return;let v=x[p],w=this.detectionResultColumns[f-1].getCodewords(),C=w;this.detectionResultColumns[f+1]!=null&&(C=this.detectionResultColumns[f+1].getCodewords());let E=new Array(14);E[2]=w[p],E[3]=C[p],p>0&&(E[0]=x[p-1],E[4]=w[p-1],E[5]=C[p-1]),p>1&&(E[8]=x[p-2],E[10]=w[p-2],E[11]=C[p-2]),p<x.length-1&&(E[1]=x[p+1],E[6]=w[p+1],E[7]=C[p+1]),p<x.length-2&&(E[9]=x[p+2],E[12]=w[p+2],E[13]=C[p+2]);for(let I of E)if(Hh.adjustRowNumber(v,I))return}static adjustRowNumber(f,p){return p==null?!1:p.hasValidRowNumber()&&p.getBucket()===f.getBucket()?(f.setRowNumber(p.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(f){this.boundingBox=f}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(f,p){this.detectionResultColumns[f]=p}getDetectionResultColumn(f){return this.detectionResultColumns[f]}toString(){let f=this.detectionResultColumns[0];f==null&&(f=this.detectionResultColumns[this.barcodeColumnCount+1]);let p=new zh;for(let x=0;x<f.getCodewords().length;x++){p.format("CW %3d:",x);for(let v=0;v<this.barcodeColumnCount+2;v++){if(this.detectionResultColumns[v]==null){p.format("    |   ");continue}let w=this.detectionResultColumns[v].getCodewords()[x];if(w==null){p.format("    |   ");continue}p.format(" %3d|%3d",w.getRowNumber(),w.getValue())}p.format("%n")}return p.toString()}}class Wh{constructor(f,p,x,v){this.rowNumber=Wh.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(f),this.endX=Math.trunc(p),this.bucket=Math.trunc(x),this.value=Math.trunc(v)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(f){return f!==Wh.BARCODE_ROW_UNKNOWN&&this.bucket===f%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(f){this.rowNumber=f}toString(){return this.rowNumber+"|"+this.value}}Wh.BARCODE_ROW_UNKNOWN=-1;class Qs{static initialize(){for(let f=0;f<At.SYMBOL_TABLE.length;f++){let p=At.SYMBOL_TABLE[f],x=p&1;for(let v=0;v<At.BARS_IN_MODULE;v++){let w=0;for(;(p&1)===x;)w+=1,p>>=1;x=p&1,Qs.RATIOS_TABLE[f]||(Qs.RATIOS_TABLE[f]=new Array(At.BARS_IN_MODULE)),Qs.RATIOS_TABLE[f][At.BARS_IN_MODULE-v-1]=Math.fround(w/At.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(f){let p=Qs.getDecodedCodewordValue(Qs.sampleBitCounts(f));return p!==-1?p:Qs.getClosestDecodedValue(f)}static sampleBitCounts(f){let p=qe.sum(f),x=new Int32Array(At.BARS_IN_MODULE),v=0,w=0;for(let C=0;C<At.MODULES_IN_CODEWORD;C++){let E=p/(2*At.MODULES_IN_CODEWORD)+C*p/At.MODULES_IN_CODEWORD;w+f[v]<=E&&(w+=f[v],v++),x[v]++}return x}static getDecodedCodewordValue(f){let p=Qs.getBitValue(f);return At.getCodeword(p)===-1?-1:p}static getBitValue(f){let p=0;for(let x=0;x<f.length;x++)for(let v=0;v<f[x];v++)p=p<<1|(x%2===0?1:0);return Math.trunc(p)}static getClosestDecodedValue(f){let p=qe.sum(f),x=new Array(At.BARS_IN_MODULE);if(p>1)for(let C=0;C<x.length;C++)x[C]=Math.fround(f[C]/p);let v=se.MAX_VALUE,w=-1;this.bSymbolTableReady||Qs.initialize();for(let C=0;C<Qs.RATIOS_TABLE.length;C++){let E=0,I=Qs.RATIOS_TABLE[C];for(let R=0;R<At.BARS_IN_MODULE;R++){let B=Math.fround(I[R]-x[R]);if(E+=Math.fround(B*B),E>=v)break}E<v&&(v=E,w=At.SYMBOL_TABLE[C])}return w}}Qs.bSymbolTableReady=!1,Qs.RATIOS_TABLE=new Array(At.SYMBOL_TABLE.length).map(H=>new Array(At.BARS_IN_MODULE));class Lk{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(f){this.segmentIndex=f}getFileId(){return this.fileId}setFileId(f){this.fileId=f}getOptionalData(){return this.optionalData}setOptionalData(f){this.optionalData=f}isLastSegment(){return this.lastSegment}setLastSegment(f){this.lastSegment=f}getSegmentCount(){return this.segmentCount}setSegmentCount(f){this.segmentCount=f}getSender(){return this.sender||null}setSender(f){this.sender=f}getAddressee(){return this.addressee||null}setAddressee(f){this.addressee=f}getFileName(){return this.fileName}setFileName(f){this.fileName=f}getFileSize(){return this.fileSize}setFileSize(f){this.fileSize=f}getChecksum(){return this.checksum}setChecksum(f){this.checksum=f}getTimestamp(){return this.timestamp}setTimestamp(f){this.timestamp=f}}class Bk{static parseLong(f,p=void 0){return parseInt(f,p)}}class Fk extends u{}Fk.kind="NullPointerException";class kG{writeBytes(f){this.writeBytesOffset(f,0,f.length)}writeBytesOffset(f,p,x){if(f==null)throw new Fk;if(p<0||p>f.length||x<0||p+x>f.length||p+x<0)throw new S;if(x===0)return;for(let v=0;v<x;v++)this.write(f[p+v])}flush(){}close(){}}class TG extends u{}class IG extends kG{constructor(f=32){if(super(),this.count=0,f<0)throw new m("Negative initial size: "+f);this.buf=new Uint8Array(f)}ensureCapacity(f){f-this.buf.length>0&&this.grow(f)}grow(f){let x=this.buf.length<<1;if(x-f<0&&(x=f),x<0){if(f<0)throw new TG;x=k.MAX_VALUE}this.buf=A.copyOfUint8Array(this.buf,x)}write(f){this.ensureCapacity(this.count+1),this.buf[this.count]=f,this.count+=1}writeBytesOffset(f,p,x){if(p<0||p>f.length||x<0||p+x-f.length>0)throw new S;this.ensureCapacity(this.count+x),j.arraycopy(f,p,this.buf,this.count,x),this.count+=x}writeTo(f){f.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return A.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(f){return f?typeof f=="string"?this.toString_string(f):this.toString_number(f):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(f){return new String(this.buf).toString()}toString_number(f){return new String(this.buf).toString()}close(){}}var xn;(function(H){H[H.ALPHA=0]="ALPHA",H[H.LOWER=1]="LOWER",H[H.MIXED=2]="MIXED",H[H.PUNCT=3]="PUNCT",H[H.ALPHA_SHIFT=4]="ALPHA_SHIFT",H[H.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(xn||(xn={}));function $k(){if(typeof window<"u")return window.BigInt||null;if(typeof Kh<"u")return Kh.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let $x;function Fl(H){if(typeof $x>"u"&&($x=$k()),$x===null)throw new Error("BigInt is not supported!");return $x(H)}function PG(){let H=[];H[0]=Fl(1);let f=Fl(900);H[1]=f;for(let p=2;p<16;p++)H[p]=H[p-1]*f;return H}class Ce{static decode(f,p){let x=new Q(""),v=L.ISO8859_1;x.enableDecoding(v);let w=1,C=f[w++],E=new Lk;for(;w<f[0];){switch(C){case Ce.TEXT_COMPACTION_MODE_LATCH:w=Ce.textCompaction(f,w,x);break;case Ce.BYTE_COMPACTION_MODE_LATCH:case Ce.BYTE_COMPACTION_MODE_LATCH_6:w=Ce.byteCompaction(C,f,v,w,x);break;case Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:x.append(f[w++]);break;case Ce.NUMERIC_COMPACTION_MODE_LATCH:w=Ce.numericCompaction(f,w,x);break;case Ce.ECI_CHARSET:L.getCharacterSetECIByValue(f[w++]);break;case Ce.ECI_GENERAL_PURPOSE:w+=2;break;case Ce.ECI_USER_DEFINED:w++;break;case Ce.BEGIN_MACRO_PDF417_CONTROL_BLOCK:w=Ce.decodeMacroBlock(f,w,E);break;case Ce.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ce.MACRO_PDF417_TERMINATOR:throw new O;default:w--,w=Ce.textCompaction(f,w,x);break}if(w<f.length)C=f[w++];else throw O.getFormatInstance()}if(x.length()===0)throw O.getFormatInstance();let I=new ae(null,x.toString(),null,p);return I.setOther(E),I}static decodeMacroBlock(f,p,x){if(p+Ce.NUMBER_OF_SEQUENCE_CODEWORDS>f[0])throw O.getFormatInstance();let v=new Int32Array(Ce.NUMBER_OF_SEQUENCE_CODEWORDS);for(let E=0;E<Ce.NUMBER_OF_SEQUENCE_CODEWORDS;E++,p++)v[E]=f[p];x.setSegmentIndex(k.parseInt(Ce.decodeBase900toBase10(v,Ce.NUMBER_OF_SEQUENCE_CODEWORDS)));let w=new Q;p=Ce.textCompaction(f,p,w),x.setFileId(w.toString());let C=-1;for(f[p]===Ce.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(C=p+1);p<f[0];)switch(f[p]){case Ce.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(p++,f[p]){case Ce.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let E=new Q;p=Ce.textCompaction(f,p+1,E),x.setFileName(E.toString());break;case Ce.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let I=new Q;p=Ce.textCompaction(f,p+1,I),x.setSender(I.toString());break;case Ce.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let R=new Q;p=Ce.textCompaction(f,p+1,R),x.setAddressee(R.toString());break;case Ce.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let B=new Q;p=Ce.numericCompaction(f,p+1,B),x.setSegmentCount(k.parseInt(B.toString()));break;case Ce.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let W=new Q;p=Ce.numericCompaction(f,p+1,W),x.setTimestamp(Bk.parseLong(W.toString()));break;case Ce.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let Y=new Q;p=Ce.numericCompaction(f,p+1,Y),x.setChecksum(k.parseInt(Y.toString()));break;case Ce.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let ee=new Q;p=Ce.numericCompaction(f,p+1,ee),x.setFileSize(Bk.parseLong(ee.toString()));break;default:throw O.getFormatInstance()}break;case Ce.MACRO_PDF417_TERMINATOR:p++,x.setLastSegment(!0);break;default:throw O.getFormatInstance()}if(C!==-1){let E=p-C;x.isLastSegment()&&E--,x.setOptionalData(A.copyOfRange(f,C,C+E))}return p}static textCompaction(f,p,x){let v=new Int32Array((f[0]-p)*2),w=new Int32Array((f[0]-p)*2),C=0,E=!1;for(;p<f[0]&&!E;){let I=f[p++];if(I<Ce.TEXT_COMPACTION_MODE_LATCH)v[C]=I/30,v[C+1]=I%30,C+=2;else switch(I){case Ce.TEXT_COMPACTION_MODE_LATCH:v[C++]=Ce.TEXT_COMPACTION_MODE_LATCH;break;case Ce.BYTE_COMPACTION_MODE_LATCH:case Ce.BYTE_COMPACTION_MODE_LATCH_6:case Ce.NUMERIC_COMPACTION_MODE_LATCH:case Ce.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ce.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ce.MACRO_PDF417_TERMINATOR:p--,E=!0;break;case Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:v[C]=Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,I=f[p++],w[C]=I,C++;break}}return Ce.decodeTextCompaction(v,w,C,x),p}static decodeTextCompaction(f,p,x,v){let w=xn.ALPHA,C=xn.ALPHA,E=0;for(;E<x;){let I=f[E],R="";switch(w){case xn.ALPHA:if(I<26)R=String.fromCharCode(65+I);else switch(I){case 26:R=" ";break;case Ce.LL:w=xn.LOWER;break;case Ce.ML:w=xn.MIXED;break;case Ce.PS:C=w,w=xn.PUNCT_SHIFT;break;case Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:v.append(p[E]);break;case Ce.TEXT_COMPACTION_MODE_LATCH:w=xn.ALPHA;break}break;case xn.LOWER:if(I<26)R=String.fromCharCode(97+I);else switch(I){case 26:R=" ";break;case Ce.AS:C=w,w=xn.ALPHA_SHIFT;break;case Ce.ML:w=xn.MIXED;break;case Ce.PS:C=w,w=xn.PUNCT_SHIFT;break;case Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:v.append(p[E]);break;case Ce.TEXT_COMPACTION_MODE_LATCH:w=xn.ALPHA;break}break;case xn.MIXED:if(I<Ce.PL)R=Ce.MIXED_CHARS[I];else switch(I){case Ce.PL:w=xn.PUNCT;break;case 26:R=" ";break;case Ce.LL:w=xn.LOWER;break;case Ce.AL:w=xn.ALPHA;break;case Ce.PS:C=w,w=xn.PUNCT_SHIFT;break;case Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:v.append(p[E]);break;case Ce.TEXT_COMPACTION_MODE_LATCH:w=xn.ALPHA;break}break;case xn.PUNCT:if(I<Ce.PAL)R=Ce.PUNCT_CHARS[I];else switch(I){case Ce.PAL:w=xn.ALPHA;break;case Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:v.append(p[E]);break;case Ce.TEXT_COMPACTION_MODE_LATCH:w=xn.ALPHA;break}break;case xn.ALPHA_SHIFT:if(w=C,I<26)R=String.fromCharCode(65+I);else switch(I){case 26:R=" ";break;case Ce.TEXT_COMPACTION_MODE_LATCH:w=xn.ALPHA;break}break;case xn.PUNCT_SHIFT:if(w=C,I<Ce.PAL)R=Ce.PUNCT_CHARS[I];else switch(I){case Ce.PAL:w=xn.ALPHA;break;case Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:v.append(p[E]);break;case Ce.TEXT_COMPACTION_MODE_LATCH:w=xn.ALPHA;break}break}R!==""&&v.append(R),E++}}static byteCompaction(f,p,x,v,w){let C=new IG,E=0,I=0,R=!1;switch(f){case Ce.BYTE_COMPACTION_MODE_LATCH:let B=new Int32Array(6),W=p[v++];for(;v<p[0]&&!R;)switch(B[E++]=W,I=900*I+W,W=p[v++],W){case Ce.TEXT_COMPACTION_MODE_LATCH:case Ce.BYTE_COMPACTION_MODE_LATCH:case Ce.NUMERIC_COMPACTION_MODE_LATCH:case Ce.BYTE_COMPACTION_MODE_LATCH_6:case Ce.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ce.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ce.MACRO_PDF417_TERMINATOR:v--,R=!0;break;default:if(E%5===0&&E>0){for(let Y=0;Y<6;++Y)C.write(Number(Fl(I)>>Fl(8*(5-Y))));I=0,E=0}break}v===p[0]&&W<Ce.TEXT_COMPACTION_MODE_LATCH&&(B[E++]=W);for(let Y=0;Y<E;Y++)C.write(B[Y]);break;case Ce.BYTE_COMPACTION_MODE_LATCH_6:for(;v<p[0]&&!R;){let Y=p[v++];if(Y<Ce.TEXT_COMPACTION_MODE_LATCH)E++,I=900*I+Y;else switch(Y){case Ce.TEXT_COMPACTION_MODE_LATCH:case Ce.BYTE_COMPACTION_MODE_LATCH:case Ce.NUMERIC_COMPACTION_MODE_LATCH:case Ce.BYTE_COMPACTION_MODE_LATCH_6:case Ce.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ce.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ce.MACRO_PDF417_TERMINATOR:v--,R=!0;break}if(E%5===0&&E>0){for(let ee=0;ee<6;++ee)C.write(Number(Fl(I)>>Fl(8*(5-ee))));I=0,E=0}}break}return w.append(V.decode(C.toByteArray(),x)),v}static numericCompaction(f,p,x){let v=0,w=!1,C=new Int32Array(Ce.MAX_NUMERIC_CODEWORDS);for(;p<f[0]&&!w;){let E=f[p++];if(p===f[0]&&(w=!0),E<Ce.TEXT_COMPACTION_MODE_LATCH)C[v]=E,v++;else switch(E){case Ce.TEXT_COMPACTION_MODE_LATCH:case Ce.BYTE_COMPACTION_MODE_LATCH:case Ce.BYTE_COMPACTION_MODE_LATCH_6:case Ce.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ce.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ce.MACRO_PDF417_TERMINATOR:p--,w=!0;break}(v%Ce.MAX_NUMERIC_CODEWORDS===0||E===Ce.NUMERIC_COMPACTION_MODE_LATCH||w)&&v>0&&(x.append(Ce.decodeBase900toBase10(C,v)),v=0)}return p}static decodeBase900toBase10(f,p){let x=Fl(0);for(let w=0;w<p;w++)x+=Ce.EXP900[p-w-1]*Fl(f[w]);let v=x.toString();if(v.charAt(0)!=="1")throw new O;return v.substring(1)}}Ce.TEXT_COMPACTION_MODE_LATCH=900,Ce.BYTE_COMPACTION_MODE_LATCH=901,Ce.NUMERIC_COMPACTION_MODE_LATCH=902,Ce.BYTE_COMPACTION_MODE_LATCH_6=924,Ce.ECI_USER_DEFINED=925,Ce.ECI_GENERAL_PURPOSE=926,Ce.ECI_CHARSET=927,Ce.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,Ce.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,Ce.MACRO_PDF417_TERMINATOR=922,Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,Ce.MAX_NUMERIC_CODEWORDS=15,Ce.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,Ce.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,Ce.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,Ce.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,Ce.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,Ce.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,Ce.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,Ce.PL=25,Ce.LL=27,Ce.AS=27,Ce.ML=28,Ce.AL=28,Ce.PS=29,Ce.PAL=29,Ce.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,Ce.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",Ce.EXP900=$k()?PG():[],Ce.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Ut{constructor(){}static decode(f,p,x,v,w,C,E){let I=new ad(f,p,x,v,w),R=null,B=null,W;for(let oe=!0;;oe=!1){if(p!=null&&(R=Ut.getRowIndicatorColumn(f,I,p,!0,C,E)),v!=null&&(B=Ut.getRowIndicatorColumn(f,I,v,!1,C,E)),W=Ut.merge(R,B),W==null)throw z.getNotFoundInstance();let ce=W.getBoundingBox();if(oe&&ce!=null&&(ce.getMinY()<I.getMinY()||ce.getMaxY()>I.getMaxY()))I=ce;else break}W.setBoundingBox(I);let Y=W.getBarcodeColumnCount()+1;W.setDetectionResultColumn(0,R),W.setDetectionResultColumn(Y,B);let ee=R!=null;for(let oe=1;oe<=Y;oe++){let ce=ee?oe:Y-oe;if(W.getDetectionResultColumn(ce)!==void 0)continue;let ge;ce===0||ce===Y?ge=new Rk(I,ce===0):ge=new Uh(I),W.setDetectionResultColumn(ce,ge);let Ae=-1,$e=Ae;for(let Ve=I.getMinY();Ve<=I.getMaxY();Ve++){if(Ae=Ut.getStartColumn(W,ce,Ve,ee),Ae<0||Ae>I.getMaxX()){if($e===-1)continue;Ae=$e}let Le=Ut.detectCodeword(f,I.getMinX(),I.getMaxX(),ee,Ae,Ve,C,E);Le!=null&&(ge.setCodeword(Ve,Le),$e=Ae,C=Math.min(C,Le.getWidth()),E=Math.max(E,Le.getWidth()))}}return Ut.createDecoderResult(W)}static merge(f,p){if(f==null&&p==null)return null;let x=Ut.getBarcodeMetadata(f,p);if(x==null)return null;let v=ad.merge(Ut.adjustBoundingBox(f),Ut.adjustBoundingBox(p));return new Hh(x,v)}static adjustBoundingBox(f){if(f==null)return null;let p=f.getRowHeights();if(p==null)return null;let x=Ut.getMax(p),v=0;for(let E of p)if(v+=x-E,E>0)break;let w=f.getCodewords();for(let E=0;v>0&&w[E]==null;E++)v--;let C=0;for(let E=p.length-1;E>=0&&(C+=x-p[E],!(p[E]>0));E--);for(let E=w.length-1;C>0&&w[E]==null;E--)C--;return f.getBoundingBox().addMissingRows(v,C,f.isLeft())}static getMax(f){let p=-1;for(let x of f)p=Math.max(p,x);return p}static getBarcodeMetadata(f,p){let x;if(f==null||(x=f.getBarcodeMetadata())==null)return p==null?null:p.getBarcodeMetadata();let v;return p==null||(v=p.getBarcodeMetadata())==null?x:x.getColumnCount()!==v.getColumnCount()&&x.getErrorCorrectionLevel()!==v.getErrorCorrectionLevel()&&x.getRowCount()!==v.getRowCount()?null:x}static getRowIndicatorColumn(f,p,x,v,w,C){let E=new Rk(p,v);for(let I=0;I<2;I++){let R=I===0?1:-1,B=Math.trunc(Math.trunc(x.getX()));for(let W=Math.trunc(Math.trunc(x.getY()));W<=p.getMaxY()&&W>=p.getMinY();W+=R){let Y=Ut.detectCodeword(f,0,f.getWidth(),v,B,W,w,C);Y!=null&&(E.setCodeword(W,Y),v?B=Y.getStartX():B=Y.getEndX())}}return E}static adjustCodewordCount(f,p){let x=p[0][1],v=x.getValue(),w=f.getBarcodeColumnCount()*f.getBarcodeRowCount()-Ut.getNumberOfECCodeWords(f.getBarcodeECLevel());if(v.length===0){if(w<1||w>At.MAX_CODEWORDS_IN_BARCODE)throw z.getNotFoundInstance();x.setValue(w)}else v[0]!==w&&x.setValue(w)}static createDecoderResult(f){let p=Ut.createBarcodeMatrix(f);Ut.adjustCodewordCount(f,p);let x=new Array,v=new Int32Array(f.getBarcodeRowCount()*f.getBarcodeColumnCount()),w=[],C=new Array;for(let I=0;I<f.getBarcodeRowCount();I++)for(let R=0;R<f.getBarcodeColumnCount();R++){let B=p[I][R+1].getValue(),W=I*f.getBarcodeColumnCount()+R;B.length===0?x.push(W):B.length===1?v[W]=B[0]:(C.push(W),w.push(B))}let E=new Array(w.length);for(let I=0;I<E.length;I++)E[I]=w[I];return Ut.createDecoderResultFromAmbiguousValues(f.getBarcodeECLevel(),v,At.toIntArray(x),At.toIntArray(C),E)}static createDecoderResultFromAmbiguousValues(f,p,x,v,w){let C=new Int32Array(v.length),E=100;for(;E-- >0;){for(let I=0;I<C.length;I++)p[v[I]]=w[I][C[I]];try{return Ut.decodeCodewords(p,f,x)}catch(I){if(!(I instanceof y))throw I}if(C.length===0)throw y.getChecksumInstance();for(let I=0;I<C.length;I++)if(C[I]<w[I].length-1){C[I]++;break}else if(C[I]=0,I===C.length-1)throw y.getChecksumInstance()}throw y.getChecksumInstance()}static createBarcodeMatrix(f){let p=Array.from({length:f.getBarcodeRowCount()},()=>new Array(f.getBarcodeColumnCount()+2));for(let v=0;v<p.length;v++)for(let w=0;w<p[v].length;w++)p[v][w]=new Vh;let x=0;for(let v of f.getDetectionResultColumns()){if(v!=null){for(let w of v.getCodewords())if(w!=null){let C=w.getRowNumber();if(C>=0){if(C>=p.length)continue;p[C][x].setValue(w.getValue())}}}x++}return p}static isValidBarcodeColumn(f,p){return p>=0&&p<=f.getBarcodeColumnCount()+1}static getStartColumn(f,p,x,v){let w=v?1:-1,C=null;if(Ut.isValidBarcodeColumn(f,p-w)&&(C=f.getDetectionResultColumn(p-w).getCodeword(x)),C!=null)return v?C.getEndX():C.getStartX();if(C=f.getDetectionResultColumn(p).getCodewordNearby(x),C!=null)return v?C.getStartX():C.getEndX();if(Ut.isValidBarcodeColumn(f,p-w)&&(C=f.getDetectionResultColumn(p-w).getCodewordNearby(x)),C!=null)return v?C.getEndX():C.getStartX();let E=0;for(;Ut.isValidBarcodeColumn(f,p-w);){p-=w;for(let I of f.getDetectionResultColumn(p).getCodewords())if(I!=null)return(v?I.getEndX():I.getStartX())+w*E*(I.getEndX()-I.getStartX());E++}return v?f.getBoundingBox().getMinX():f.getBoundingBox().getMaxX()}static detectCodeword(f,p,x,v,w,C,E,I){w=Ut.adjustCodewordStartColumn(f,p,x,v,w,C);let R=Ut.getModuleBitCount(f,p,x,v,w,C);if(R==null)return null;let B,W=qe.sum(R);if(v)B=w+W;else{for(let oe=0;oe<R.length/2;oe++){let ce=R[oe];R[oe]=R[R.length-1-oe],R[R.length-1-oe]=ce}B=w,w=B-W}if(!Ut.checkCodewordSkew(W,E,I))return null;let Y=Qs.getDecodedValue(R),ee=At.getCodeword(Y);return ee===-1?null:new Wh(w,B,Ut.getCodewordBucketNumber(Y),ee)}static getModuleBitCount(f,p,x,v,w,C){let E=w,I=new Int32Array(8),R=0,B=v?1:-1,W=v;for(;(v?E<x:E>=p)&&R<I.length;)f.get(E,C)===W?(I[R]++,E+=B):(R++,W=!W);return R===I.length||E===(v?x:p)&&R===I.length-1?I:null}static getNumberOfECCodeWords(f){return 2<<f}static adjustCodewordStartColumn(f,p,x,v,w,C){let E=w,I=v?-1:1;for(let R=0;R<2;R++){for(;(v?E>=p:E<x)&&v===f.get(E,C);){if(Math.abs(w-E)>Ut.CODEWORD_SKEW_SIZE)return w;E+=I}I=-I,v=!v}return E}static checkCodewordSkew(f,p,x){return p-Ut.CODEWORD_SKEW_SIZE<=f&&f<=x+Ut.CODEWORD_SKEW_SIZE}static decodeCodewords(f,p,x){if(f.length===0)throw O.getFormatInstance();let v=1<<p+1,w=Ut.correctErrors(f,x,v);Ut.verifyCodewordCount(f,v);let C=Ce.decode(f,""+p);return C.setErrorsCorrected(w),C.setErasures(x.length),C}static correctErrors(f,p,x){if(p!=null&&p.length>x/2+Ut.MAX_ERRORS||x<0||x>Ut.MAX_EC_CODEWORDS)throw y.getChecksumInstance();return Ut.errorCorrection.decode(f,x,p)}static verifyCodewordCount(f,p){if(f.length<4)throw O.getFormatInstance();let x=f[0];if(x>f.length)throw O.getFormatInstance();if(x===0)if(p<f.length)f[0]=f.length-p;else throw O.getFormatInstance()}static getBitCountForCodeword(f){let p=new Int32Array(8),x=0,v=p.length-1;for(;!((f&1)!==x&&(x=f&1,v--,v<0));)p[v]++,f>>=1;return p}static getCodewordBucketNumber(f){return f instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(f):this.getCodewordBucketNumber_number(f)}static getCodewordBucketNumber_number(f){return Ut.getCodewordBucketNumber(Ut.getBitCountForCodeword(f))}static getCodewordBucketNumber_Int32Array(f){return(f[0]-f[2]+f[4]-f[6]+9)%9}static toString(f){let p=new zh;for(let x=0;x<f.length;x++){p.format("Row %2d: ",x);for(let v=0;v<f[x].length;v++){let w=f[x][v];w.getValue().length===0?p.format("        ",null):p.format("%4d(%2d)",w.getValue()[0],w.getConfidence(w.getValue()[0]))}p.format("%n")}return p.toString()}}Ut.CODEWORD_SKEW_SIZE=2,Ut.MAX_ERRORS=3,Ut.MAX_EC_CODEWORDS=512,Ut.errorCorrection=new Dk;class as{decode(f,p=null){let x=as.decode(f,p,!1);if(x==null||x.length===0||x[0]==null)throw z.getNotFoundInstance();return x[0]}decodeMultiple(f,p=null){try{return as.decode(f,p,!0)}catch(x){throw x instanceof O||x instanceof y?z.getNotFoundInstance():x}}static decode(f,p,x){const v=new Array,w=Bt.detectMultiple(f,p,x);for(const C of w.getPoints()){const E=Ut.decode(w.getBits(),C[4],C[5],C[6],C[7],as.getMinCodewordWidth(C),as.getMaxCodewordWidth(C)),I=new be(E.getText(),E.getRawBytes(),void 0,C,_e.PDF_417);I.putMetadata(Oe.ERROR_CORRECTION_LEVEL,E.getECLevel());const R=E.getOther();R!=null&&I.putMetadata(Oe.PDF417_EXTRA_METADATA,R),v.push(I)}return v.map(C=>C)}static getMaxWidth(f,p){return f==null||p==null?0:Math.trunc(Math.abs(f.getX()-p.getX()))}static getMinWidth(f,p){return f==null||p==null?k.MAX_VALUE:Math.trunc(Math.abs(f.getX()-p.getX()))}static getMaxCodewordWidth(f){return Math.floor(Math.max(Math.max(as.getMaxWidth(f[0],f[4]),as.getMaxWidth(f[6],f[2])*At.MODULES_IN_CODEWORD/At.MODULES_IN_STOP_PATTERN),Math.max(as.getMaxWidth(f[1],f[5]),as.getMaxWidth(f[7],f[3])*At.MODULES_IN_CODEWORD/At.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(f){return Math.floor(Math.min(Math.min(as.getMinWidth(f[0],f[4]),as.getMinWidth(f[6],f[2])*At.MODULES_IN_CODEWORD/At.MODULES_IN_STOP_PATTERN),Math.min(as.getMinWidth(f[1],f[5]),as.getMinWidth(f[7],f[3])*At.MODULES_IN_CODEWORD/At.MODULES_IN_STOP_PATTERN)))}reset(){}}class zx extends u{}zx.kind="ReaderException";class zk{constructor(f,p){this.verbose=f===!0,p&&this.setHints(p)}decode(f,p){return p&&this.setHints(p),this.decodeInternal(f)}decodeWithState(f){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(f)}setHints(f){this.hints=f;const p=!s(f)&&f.get(M.TRY_HARDER)===!0,x=s(f)?null:f.get(M.POSSIBLE_FORMATS),v=new Array;if(!s(x)){const w=x.some(C=>C===_e.UPC_A||C===_e.UPC_E||C===_e.EAN_13||C===_e.EAN_8||C===_e.CODABAR||C===_e.CODE_39||C===_e.CODE_93||C===_e.CODE_128||C===_e.ITF||C===_e.RSS_14||C===_e.RSS_EXPANDED);w&&!p&&v.push(new Rl(f,this.verbose)),x.includes(_e.QR_CODE)&&v.push(new Bl),x.includes(_e.DATA_MATRIX)&&v.push(new G),x.includes(_e.AZTEC)&&v.push(new Et),x.includes(_e.PDF_417)&&v.push(new as),w&&p&&v.push(new Rl(f,this.verbose))}v.length===0&&(p||v.push(new Rl(f,this.verbose)),v.push(new Bl),v.push(new G),v.push(new Et),v.push(new as),p&&v.push(new Rl(f,this.verbose))),this.readers=v}reset(){if(this.readers!==null)for(const f of this.readers)f.reset()}decodeInternal(f){if(this.readers===null)throw new zx("No readers where selected, nothing can be read.");for(const p of this.readers)try{return p.decode(f,this.hints)}catch(x){if(x instanceof zx)continue}throw new z("No MultiFormat Readers were able to detect the code.")}}class MG extends ye{constructor(f=null,p=500){const x=new zk;x.setHints(f),super(x,p)}decodeBitmap(f){return this.reader.decodeWithState(f)}}class OG extends ye{constructor(f=500){super(new as,f)}}class DG extends ye{constructor(f=500){super(new Bl,f)}}var cw;(function(H){H[H.ERROR_CORRECTION=0]="ERROR_CORRECTION",H[H.CHARACTER_SET=1]="CHARACTER_SET",H[H.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",H[H.MIN_SIZE=3]="MIN_SIZE",H[H.MAX_SIZE=4]="MAX_SIZE",H[H.MARGIN=5]="MARGIN",H[H.PDF417_COMPACT=6]="PDF417_COMPACT",H[H.PDF417_COMPACTION=7]="PDF417_COMPACTION",H[H.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",H[H.AZTEC_LAYERS=9]="AZTEC_LAYERS",H[H.QR_VERSION=10]="QR_VERSION"})(cw||(cw={}));var Pr=cw;class dw{constructor(f){this.field=f,this.cachedGenerators=[],this.cachedGenerators.push(new pe(f,Int32Array.from([1])))}buildGenerator(f){const p=this.cachedGenerators;if(f>=p.length){let x=p[p.length-1];const v=this.field;for(let w=p.length;w<=f;w++){const C=x.multiply(new pe(v,Int32Array.from([1,v.exp(w-1+v.getGeneratorBase())])));p.push(C),x=C}}return p[f]}encode(f,p){if(p===0)throw new m("No error correction bytes");const x=f.length-p;if(x<=0)throw new m("No data bytes provided");const v=this.buildGenerator(p),w=new Int32Array(x);j.arraycopy(f,0,w,0,x);let C=new pe(this.field,w);C=C.multiplyByMonomial(p,1);const I=C.divide(v)[1].getCoefficients(),R=p-I.length;for(let B=0;B<R;B++)f[x+B]=0;j.arraycopy(I,0,f,x+R,I.length)}}class rr{constructor(){}static applyMaskPenaltyRule1(f){return rr.applyMaskPenaltyRule1Internal(f,!0)+rr.applyMaskPenaltyRule1Internal(f,!1)}static applyMaskPenaltyRule2(f){let p=0;const x=f.getArray(),v=f.getWidth(),w=f.getHeight();for(let C=0;C<w-1;C++){const E=x[C];for(let I=0;I<v-1;I++){const R=E[I];R===E[I+1]&&R===x[C+1][I]&&R===x[C+1][I+1]&&p++}}return rr.N2*p}static applyMaskPenaltyRule3(f){let p=0;const x=f.getArray(),v=f.getWidth(),w=f.getHeight();for(let C=0;C<w;C++)for(let E=0;E<v;E++){const I=x[C];E+6<v&&I[E]===1&&I[E+1]===0&&I[E+2]===1&&I[E+3]===1&&I[E+4]===1&&I[E+5]===0&&I[E+6]===1&&(rr.isWhiteHorizontal(I,E-4,E)||rr.isWhiteHorizontal(I,E+7,E+11))&&p++,C+6<w&&x[C][E]===1&&x[C+1][E]===0&&x[C+2][E]===1&&x[C+3][E]===1&&x[C+4][E]===1&&x[C+5][E]===0&&x[C+6][E]===1&&(rr.isWhiteVertical(x,E,C-4,C)||rr.isWhiteVertical(x,E,C+7,C+11))&&p++}return p*rr.N3}static isWhiteHorizontal(f,p,x){p=Math.max(p,0),x=Math.min(x,f.length);for(let v=p;v<x;v++)if(f[v]===1)return!1;return!0}static isWhiteVertical(f,p,x,v){x=Math.max(x,0),v=Math.min(v,f.length);for(let w=x;w<v;w++)if(f[w][p]===1)return!1;return!0}static applyMaskPenaltyRule4(f){let p=0;const x=f.getArray(),v=f.getWidth(),w=f.getHeight();for(let I=0;I<w;I++){const R=x[I];for(let B=0;B<v;B++)R[B]===1&&p++}const C=f.getHeight()*f.getWidth();return Math.floor(Math.abs(p*2-C)*10/C)*rr.N4}static getDataMaskBit(f,p,x){let v,w;switch(f){case 0:v=x+p&1;break;case 1:v=x&1;break;case 2:v=p%3;break;case 3:v=(x+p)%3;break;case 4:v=Math.floor(x/2)+Math.floor(p/3)&1;break;case 5:w=x*p,v=(w&1)+w%3;break;case 6:w=x*p,v=(w&1)+w%3&1;break;case 7:w=x*p,v=w%3+(x+p&1)&1;break;default:throw new m("Invalid mask pattern: "+f)}return v===0}static applyMaskPenaltyRule1Internal(f,p){let x=0;const v=p?f.getHeight():f.getWidth(),w=p?f.getWidth():f.getHeight(),C=f.getArray();for(let E=0;E<v;E++){let I=0,R=-1;for(let B=0;B<w;B++){const W=p?C[E][B]:C[B][E];W===R?I++:(I>=5&&(x+=rr.N1+(I-5)),I=1,R=W)}I>=5&&(x+=rr.N1+(I-5))}return x}}rr.N1=3,rr.N2=3,rr.N3=40,rr.N4=10;class Ux{constructor(f,p){this.width=f,this.height=p;const x=new Array(p);for(let v=0;v!==p;v++)x[v]=new Uint8Array(f);this.bytes=x}getHeight(){return this.height}getWidth(){return this.width}get(f,p){return this.bytes[p][f]}getArray(){return this.bytes}setNumber(f,p,x){this.bytes[p][f]=x}setBoolean(f,p,x){this.bytes[p][f]=x?1:0}clear(f){for(const p of this.bytes)A.fill(p,f)}equals(f){if(!(f instanceof Ux))return!1;const p=f;if(this.width!==p.width||this.height!==p.height)return!1;for(let x=0,v=this.height;x<v;++x){const w=this.bytes[x],C=p.bytes[x];for(let E=0,I=this.width;E<I;++E)if(w[E]!==C[E])return!1}return!0}toString(){const f=new Q;for(let p=0,x=this.height;p<x;++p){const v=this.bytes[p];for(let w=0,C=this.width;w<C;++w)switch(v[w]){case 0:f.append(" 0");break;case 1:f.append(" 1");break;default:f.append("  ");break}f.append(`
`)}return f.toString()}}class id{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const f=new Q;return f.append(`<<
`),f.append(" mode: "),f.append(this.mode?this.mode.toString():"null"),f.append(`
 ecLevel: `),f.append(this.ecLevel?this.ecLevel.toString():"null"),f.append(`
 version: `),f.append(this.version?this.version.toString():"null"),f.append(`
 maskPattern: `),f.append(this.maskPattern.toString()),this.matrix?(f.append(`
 matrix:
`),f.append(this.matrix.toString())):f.append(`
 matrix: null
`),f.append(`>>
`),f.toString()}setMode(f){this.mode=f}setECLevel(f){this.ecLevel=f}setVersion(f){this.version=f}setMaskPattern(f){this.maskPattern=f}setMatrix(f){this.matrix=f}static isValidMaskPattern(f){return f>=0&&f<id.NUM_MASK_PATTERNS}}id.NUM_MASK_PATTERNS=8;class bn extends u{}bn.kind="WriterException";class jt{constructor(){}static clearMatrix(f){f.clear(255)}static buildMatrix(f,p,x,v,w){jt.clearMatrix(w),jt.embedBasicPatterns(x,w),jt.embedTypeInfo(p,v,w),jt.maybeEmbedVersionInfo(x,w),jt.embedDataBits(f,v,w)}static embedBasicPatterns(f,p){jt.embedPositionDetectionPatternsAndSeparators(p),jt.embedDarkDotAtLeftBottomCorner(p),jt.maybeEmbedPositionAdjustmentPatterns(f,p),jt.embedTimingPatterns(p)}static embedTypeInfo(f,p,x){const v=new T;jt.makeTypeInfoBits(f,p,v);for(let w=0,C=v.getSize();w<C;++w){const E=v.get(v.getSize()-1-w),I=jt.TYPE_INFO_COORDINATES[w],R=I[0],B=I[1];if(x.setBoolean(R,B,E),w<8){const W=x.getWidth()-w-1;x.setBoolean(W,8,E)}else{const Y=x.getHeight()-7+(w-8);x.setBoolean(8,Y,E)}}}static maybeEmbedVersionInfo(f,p){if(f.getVersionNumber()<7)return;const x=new T;jt.makeVersionInfoBits(f,x);let v=6*3-1;for(let w=0;w<6;++w)for(let C=0;C<3;++C){const E=x.get(v);v--,p.setBoolean(w,p.getHeight()-11+C,E),p.setBoolean(p.getHeight()-11+C,w,E)}}static embedDataBits(f,p,x){let v=0,w=-1,C=x.getWidth()-1,E=x.getHeight()-1;for(;C>0;){for(C===6&&(C-=1);E>=0&&E<x.getHeight();){for(let I=0;I<2;++I){const R=C-I;if(!jt.isEmpty(x.get(R,E)))continue;let B;v<f.getSize()?(B=f.get(v),++v):B=!1,p!==255&&rr.getDataMaskBit(p,R,E)&&(B=!B),x.setBoolean(R,E,B)}E+=w}w=-w,E+=w,C-=2}if(v!==f.getSize())throw new bn("Not all bits consumed: "+v+"/"+f.getSize())}static findMSBSet(f){return 32-k.numberOfLeadingZeros(f)}static calculateBCHCode(f,p){if(p===0)throw new m("0 polynomial");const x=jt.findMSBSet(p);for(f<<=x-1;jt.findMSBSet(f)>=x;)f^=p<<jt.findMSBSet(f)-x;return f}static makeTypeInfoBits(f,p,x){if(!id.isValidMaskPattern(p))throw new bn("Invalid mask pattern");const v=f.getBits()<<3|p;x.appendBits(v,5);const w=jt.calculateBCHCode(v,jt.TYPE_INFO_POLY);x.appendBits(w,10);const C=new T;if(C.appendBits(jt.TYPE_INFO_MASK_PATTERN,15),x.xor(C),x.getSize()!==15)throw new bn("should not happen but we got: "+x.getSize())}static makeVersionInfoBits(f,p){p.appendBits(f.getVersionNumber(),6);const x=jt.calculateBCHCode(f.getVersionNumber(),jt.VERSION_INFO_POLY);if(p.appendBits(x,12),p.getSize()!==18)throw new bn("should not happen but we got: "+p.getSize())}static isEmpty(f){return f===255}static embedTimingPatterns(f){for(let p=8;p<f.getWidth()-8;++p){const x=(p+1)%2;jt.isEmpty(f.get(p,6))&&f.setNumber(p,6,x),jt.isEmpty(f.get(6,p))&&f.setNumber(6,p,x)}}static embedDarkDotAtLeftBottomCorner(f){if(f.get(8,f.getHeight()-8)===0)throw new bn;f.setNumber(8,f.getHeight()-8,1)}static embedHorizontalSeparationPattern(f,p,x){for(let v=0;v<8;++v){if(!jt.isEmpty(x.get(f+v,p)))throw new bn;x.setNumber(f+v,p,0)}}static embedVerticalSeparationPattern(f,p,x){for(let v=0;v<7;++v){if(!jt.isEmpty(x.get(f,p+v)))throw new bn;x.setNumber(f,p+v,0)}}static embedPositionAdjustmentPattern(f,p,x){for(let v=0;v<5;++v){const w=jt.POSITION_ADJUSTMENT_PATTERN[v];for(let C=0;C<5;++C)x.setNumber(f+C,p+v,w[C])}}static embedPositionDetectionPattern(f,p,x){for(let v=0;v<7;++v){const w=jt.POSITION_DETECTION_PATTERN[v];for(let C=0;C<7;++C)x.setNumber(f+C,p+v,w[C])}}static embedPositionDetectionPatternsAndSeparators(f){const p=jt.POSITION_DETECTION_PATTERN[0].length;jt.embedPositionDetectionPattern(0,0,f),jt.embedPositionDetectionPattern(f.getWidth()-p,0,f),jt.embedPositionDetectionPattern(0,f.getWidth()-p,f);const x=8;jt.embedHorizontalSeparationPattern(0,x-1,f),jt.embedHorizontalSeparationPattern(f.getWidth()-x,x-1,f),jt.embedHorizontalSeparationPattern(0,f.getWidth()-x,f);const v=7;jt.embedVerticalSeparationPattern(v,0,f),jt.embedVerticalSeparationPattern(f.getHeight()-v-1,0,f),jt.embedVerticalSeparationPattern(v,f.getHeight()-v,f)}static maybeEmbedPositionAdjustmentPatterns(f,p){if(f.getVersionNumber()<2)return;const x=f.getVersionNumber()-1,v=jt.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[x];for(let w=0,C=v.length;w!==C;w++){const E=v[w];if(E>=0)for(let I=0;I!==C;I++){const R=v[I];R>=0&&jt.isEmpty(p.get(R,E))&&jt.embedPositionAdjustmentPattern(R-2,E-2,p)}}}}jt.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),jt.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),jt.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),jt.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),jt.VERSION_INFO_POLY=7973,jt.TYPE_INFO_POLY=1335,jt.TYPE_INFO_MASK_PATTERN=21522;class RG{constructor(f,p){this.dataBytes=f,this.errorCorrectionBytes=p}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class Pn{constructor(){}static calculateMaskPenalty(f){return rr.applyMaskPenaltyRule1(f)+rr.applyMaskPenaltyRule2(f)+rr.applyMaskPenaltyRule3(f)+rr.applyMaskPenaltyRule4(f)}static encode(f,p,x=null){let v=Pn.DEFAULT_BYTE_MODE_ENCODING;const w=x!==null&&x.get(Pr.CHARACTER_SET)!==void 0;w&&(v=x.get(Pr.CHARACTER_SET).toString());const C=this.chooseMode(f,v),E=new T;if(C===yt.BYTE&&(w||Pn.DEFAULT_BYTE_MODE_ENCODING!==v)){const Ve=L.getCharacterSetECIByName(v);Ve!==void 0&&this.appendECI(Ve,E)}this.appendModeInfo(C,E);const I=new T;this.appendBytes(f,C,I,v);let R;if(x!==null&&x.get(Pr.QR_VERSION)!==void 0){const Ve=Number.parseInt(x.get(Pr.QR_VERSION).toString(),10);R=pt.getVersionForNumber(Ve);const Le=this.calculateBitsNeeded(C,E,I,R);if(!this.willFit(Le,R,p))throw new bn("Data too big for requested version")}else R=this.recommendVersion(p,C,E,I);const B=new T;B.appendBitArray(E);const W=C===yt.BYTE?I.getSizeInBytes():f.length;this.appendLengthInfo(W,R,C,B),B.appendBitArray(I);const Y=R.getECBlocksForLevel(p),ee=R.getTotalCodewords()-Y.getTotalECCodewords();this.terminateBits(ee,B);const oe=this.interleaveWithECBytes(B,R.getTotalCodewords(),ee,Y.getNumBlocks()),ce=new id;ce.setECLevel(p),ce.setMode(C),ce.setVersion(R);const ge=R.getDimensionForVersion(),Ae=new Ux(ge,ge),$e=this.chooseMaskPattern(oe,p,R,Ae);return ce.setMaskPattern($e),jt.buildMatrix(oe,p,R,$e,Ae),ce.setMatrix(Ae),ce}static recommendVersion(f,p,x,v){const w=this.calculateBitsNeeded(p,x,v,pt.getVersionForNumber(1)),C=this.chooseVersion(w,f),E=this.calculateBitsNeeded(p,x,v,C);return this.chooseVersion(E,f)}static calculateBitsNeeded(f,p,x,v){return p.getSize()+f.getCharacterCountBits(v)+x.getSize()}static getAlphanumericCode(f){return f<Pn.ALPHANUMERIC_TABLE.length?Pn.ALPHANUMERIC_TABLE[f]:-1}static chooseMode(f,p=null){if(L.SJIS.getName()===p&&this.isOnlyDoubleByteKanji(f))return yt.KANJI;let x=!1,v=!1;for(let w=0,C=f.length;w<C;++w){const E=f.charAt(w);if(Pn.isDigit(E))x=!0;else if(this.getAlphanumericCode(E.charCodeAt(0))!==-1)v=!0;else return yt.BYTE}return v?yt.ALPHANUMERIC:x?yt.NUMERIC:yt.BYTE}static isOnlyDoubleByteKanji(f){let p;try{p=V.encode(f,L.SJIS)}catch{return!1}const x=p.length;if(x%2!==0)return!1;for(let v=0;v<x;v+=2){const w=p[v]&255;if((w<129||w>159)&&(w<224||w>235))return!1}return!0}static chooseMaskPattern(f,p,x,v){let w=Number.MAX_SAFE_INTEGER,C=-1;for(let E=0;E<id.NUM_MASK_PATTERNS;E++){jt.buildMatrix(f,p,x,E,v);let I=this.calculateMaskPenalty(v);I<w&&(w=I,C=E)}return C}static chooseVersion(f,p){for(let x=1;x<=40;x++){const v=pt.getVersionForNumber(x);if(Pn.willFit(f,v,p))return v}throw new bn("Data too big")}static willFit(f,p,x){const v=p.getTotalCodewords(),C=p.getECBlocksForLevel(x).getTotalECCodewords(),E=v-C,I=(f+7)/8;return E>=I}static terminateBits(f,p){const x=f*8;if(p.getSize()>x)throw new bn("data bits cannot fit in the QR Code"+p.getSize()+" > "+x);for(let C=0;C<4&&p.getSize()<x;++C)p.appendBit(!1);const v=p.getSize()&7;if(v>0)for(let C=v;C<8;C++)p.appendBit(!1);const w=f-p.getSizeInBytes();for(let C=0;C<w;++C)p.appendBits(C&1?17:236,8);if(p.getSize()!==x)throw new bn("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(f,p,x,v,w,C){if(v>=x)throw new bn("Block ID too large");const E=f%x,I=x-E,R=Math.floor(f/x),B=R+1,W=Math.floor(p/x),Y=W+1,ee=R-W,oe=B-Y;if(ee!==oe)throw new bn("EC bytes mismatch");if(x!==I+E)throw new bn("RS blocks mismatch");if(f!==(W+ee)*I+(Y+oe)*E)throw new bn("Total bytes mismatch");v<I?(w[0]=W,C[0]=ee):(w[0]=Y,C[0]=oe)}static interleaveWithECBytes(f,p,x,v){if(f.getSizeInBytes()!==x)throw new bn("Number of bits and data bytes does not match");let w=0,C=0,E=0;const I=new Array;for(let B=0;B<v;++B){const W=new Int32Array(1),Y=new Int32Array(1);Pn.getNumDataBytesAndNumECBytesForBlockID(p,x,v,B,W,Y);const ee=W[0],oe=new Uint8Array(ee);f.toBytes(8*w,oe,0,ee);const ce=Pn.generateECBytes(oe,Y[0]);I.push(new RG(oe,ce)),C=Math.max(C,ee),E=Math.max(E,ce.length),w+=W[0]}if(x!==w)throw new bn("Data bytes does not match offset");const R=new T;for(let B=0;B<C;++B)for(const W of I){const Y=W.getDataBytes();B<Y.length&&R.appendBits(Y[B],8)}for(let B=0;B<E;++B)for(const W of I){const Y=W.getErrorCorrectionBytes();B<Y.length&&R.appendBits(Y[B],8)}if(p!==R.getSizeInBytes())throw new bn("Interleaving error: "+p+" and "+R.getSizeInBytes()+" differ.");return R}static generateECBytes(f,p){const x=f.length,v=new Int32Array(x+p);for(let C=0;C<x;C++)v[C]=f[C]&255;new dw(We.QR_CODE_FIELD_256).encode(v,p);const w=new Uint8Array(p);for(let C=0;C<p;C++)w[C]=v[x+C];return w}static appendModeInfo(f,p){p.appendBits(f.getBits(),4)}static appendLengthInfo(f,p,x,v){const w=x.getCharacterCountBits(p);if(f>=1<<w)throw new bn(f+" is bigger than "+((1<<w)-1));v.appendBits(f,w)}static appendBytes(f,p,x,v){switch(p){case yt.NUMERIC:Pn.appendNumericBytes(f,x);break;case yt.ALPHANUMERIC:Pn.appendAlphanumericBytes(f,x);break;case yt.BYTE:Pn.append8BitBytes(f,x,v);break;case yt.KANJI:Pn.appendKanjiBytes(f,x);break;default:throw new bn("Invalid mode: "+p)}}static getDigit(f){return f.charCodeAt(0)-48}static isDigit(f){const p=Pn.getDigit(f);return p>=0&&p<=9}static appendNumericBytes(f,p){const x=f.length;let v=0;for(;v<x;){const w=Pn.getDigit(f.charAt(v));if(v+2<x){const C=Pn.getDigit(f.charAt(v+1)),E=Pn.getDigit(f.charAt(v+2));p.appendBits(w*100+C*10+E,10),v+=3}else if(v+1<x){const C=Pn.getDigit(f.charAt(v+1));p.appendBits(w*10+C,7),v+=2}else p.appendBits(w,4),v++}}static appendAlphanumericBytes(f,p){const x=f.length;let v=0;for(;v<x;){const w=Pn.getAlphanumericCode(f.charCodeAt(v));if(w===-1)throw new bn;if(v+1<x){const C=Pn.getAlphanumericCode(f.charCodeAt(v+1));if(C===-1)throw new bn;p.appendBits(w*45+C,11),v+=2}else p.appendBits(w,6),v++}}static append8BitBytes(f,p,x){let v;try{v=V.encode(f,x)}catch(w){throw new bn(w)}for(let w=0,C=v.length;w!==C;w++){const E=v[w];p.appendBits(E,8)}}static appendKanjiBytes(f,p){let x;try{x=V.encode(f,L.SJIS)}catch(w){throw new bn(w)}const v=x.length;for(let w=0;w<v;w+=2){const C=x[w]&255,E=x[w+1]&255,I=C<<8&4294967295|E;let R=-1;if(I>=33088&&I<=40956?R=I-33088:I>=57408&&I<=60351&&(R=I-49472),R===-1)throw new bn("Invalid byte sequence");const B=(R>>8)*192+(R&255);p.appendBits(B,13)}}static appendECI(f,p){p.appendBits(yt.ECI.getBits(),4),p.appendBits(f.getValue(),8)}}Pn.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),Pn.DEFAULT_BYTE_MODE_ENCODING=L.UTF8.getName();class od{write(f,p,x,v=null){if(f.length===0)throw new m("Found empty contents");if(p<0||x<0)throw new m("Requested dimensions are too small: "+p+"x"+x);let w=rt.L,C=od.QUIET_ZONE_SIZE;v!==null&&(v.get(Pr.ERROR_CORRECTION)!==void 0&&(w=rt.fromString(v.get(Pr.ERROR_CORRECTION).toString())),v.get(Pr.MARGIN)!==void 0&&(C=Number.parseInt(v.get(Pr.MARGIN).toString(),10)));const E=Pn.encode(f,w,v);return this.renderResult(E,p,x,C)}writeToDom(f,p,x,v,w=null){typeof f=="string"&&(f=document.querySelector(f));const C=this.write(p,x,v,w);f&&f.appendChild(C)}renderResult(f,p,x,v){const w=f.getMatrix();if(w===null)throw new St;const C=w.getWidth(),E=w.getHeight(),I=C+v*2,R=E+v*2,B=Math.max(p,I),W=Math.max(x,R),Y=Math.min(Math.floor(B/I),Math.floor(W/R)),ee=Math.floor((B-C*Y)/2),oe=Math.floor((W-E*Y)/2),ce=this.createSVGElement(B,W);for(let ge=0,Ae=oe;ge<E;ge++,Ae+=Y)for(let $e=0,Ve=ee;$e<C;$e++,Ve+=Y)if(w.get($e,ge)===1){const Le=this.createSvgRectElement(Ve,Ae,Y,Y);ce.appendChild(Le)}return ce}createSVGElement(f,p){const x=document.createElementNS(od.SVG_NS,"svg");return x.setAttributeNS(null,"height",f.toString()),x.setAttributeNS(null,"width",p.toString()),x}createSvgRectElement(f,p,x,v){const w=document.createElementNS(od.SVG_NS,"rect");return w.setAttributeNS(null,"x",f.toString()),w.setAttributeNS(null,"y",p.toString()),w.setAttributeNS(null,"height",x.toString()),w.setAttributeNS(null,"width",v.toString()),w.setAttributeNS(null,"fill","#000000"),w}}od.QUIET_ZONE_SIZE=4,od.SVG_NS="http://www.w3.org/2000/svg";class Ru{encode(f,p,x,v,w){if(f.length===0)throw new m("Found empty contents");if(p!==_e.QR_CODE)throw new m("Can only encode QR_CODE, but got "+p);if(x<0||v<0)throw new m(`Requested dimensions are too small: ${x}x${v}`);let C=rt.L,E=Ru.QUIET_ZONE_SIZE;w!==null&&(w.get(Pr.ERROR_CORRECTION)!==void 0&&(C=rt.fromString(w.get(Pr.ERROR_CORRECTION).toString())),w.get(Pr.MARGIN)!==void 0&&(E=Number.parseInt(w.get(Pr.MARGIN).toString(),10)));const I=Pn.encode(f,C,w);return Ru.renderResult(I,x,v,E)}static renderResult(f,p,x,v){const w=f.getMatrix();if(w===null)throw new St;const C=w.getWidth(),E=w.getHeight(),I=C+v*2,R=E+v*2,B=Math.max(p,I),W=Math.max(x,R),Y=Math.min(Math.floor(B/I),Math.floor(W/R)),ee=Math.floor((B-C*Y)/2),oe=Math.floor((W-E*Y)/2),ce=new U(B,W);for(let ge=0,Ae=oe;ge<E;ge++,Ae+=Y)for(let $e=0,Ve=ee;$e<C;$e++,Ve+=Y)w.get($e,ge)===1&&ce.setRegion(Ve,Ae,Y,Y);return ce}}Ru.QUIET_ZONE_SIZE=4;class LG{encode(f,p,x,v,w){let C;switch(p){case _e.QR_CODE:C=new Ru;break;default:throw new m("No encoder available for format "+p)}return C.encode(f,p,x,v,w)}}class Ji extends X{constructor(f,p,x,v,w,C,E,I){if(super(C,E),this.yuvData=f,this.dataWidth=p,this.dataHeight=x,this.left=v,this.top=w,v+C>p||w+E>x)throw new m("Crop rectangle does not fit within image data.");I&&this.reverseHorizontal(C,E)}getRow(f,p){if(f<0||f>=this.getHeight())throw new m("Requested row is outside the image: "+f);const x=this.getWidth();(p==null||p.length<x)&&(p=new Uint8ClampedArray(x));const v=(f+this.top)*this.dataWidth+this.left;return j.arraycopy(this.yuvData,v,p,0,x),p}getMatrix(){const f=this.getWidth(),p=this.getHeight();if(f===this.dataWidth&&p===this.dataHeight)return this.yuvData;const x=f*p,v=new Uint8ClampedArray(x);let w=this.top*this.dataWidth+this.left;if(f===this.dataWidth)return j.arraycopy(this.yuvData,w,v,0,x),v;for(let C=0;C<p;C++){const E=C*f;j.arraycopy(this.yuvData,w,v,E,f),w+=this.dataWidth}return v}isCropSupported(){return!0}crop(f,p,x,v){return new Ji(this.yuvData,this.dataWidth,this.dataHeight,this.left+f,this.top+p,x,v,!1)}renderThumbnail(){const f=this.getWidth()/Ji.THUMBNAIL_SCALE_FACTOR,p=this.getHeight()/Ji.THUMBNAIL_SCALE_FACTOR,x=new Int32Array(f*p),v=this.yuvData;let w=this.top*this.dataWidth+this.left;for(let C=0;C<p;C++){const E=C*f;for(let I=0;I<f;I++){const R=v[w+I*Ji.THUMBNAIL_SCALE_FACTOR]&255;x[E+I]=4278190080|R*65793}w+=this.dataWidth*Ji.THUMBNAIL_SCALE_FACTOR}return x}getThumbnailWidth(){return this.getWidth()/Ji.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Ji.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(f,p){const x=this.yuvData;for(let v=0,w=this.top*this.dataWidth+this.left;v<p;v++,w+=this.dataWidth){const C=w+f/2;for(let E=w,I=w+f-1;E<C;E++,I--){const R=x[E];x[E]=x[I],x[I]=R}}}invert(){return new J(this)}}Ji.THUMBNAIL_SCALE_FACTOR=2;class uw extends X{constructor(f,p,x,v,w,C,E){if(super(p,x),this.dataWidth=v,this.dataHeight=w,this.left=C,this.top=E,f.BYTES_PER_ELEMENT===4){const I=p*x,R=new Uint8ClampedArray(I);for(let B=0;B<I;B++){const W=f[B],Y=W>>16&255,ee=W>>7&510,oe=W&255;R[B]=(Y+ee+oe)/4&255}this.luminances=R}else this.luminances=f;if(v===void 0&&(this.dataWidth=p),w===void 0&&(this.dataHeight=x),C===void 0&&(this.left=0),E===void 0&&(this.top=0),this.left+p>this.dataWidth||this.top+x>this.dataHeight)throw new m("Crop rectangle does not fit within image data.")}getRow(f,p){if(f<0||f>=this.getHeight())throw new m("Requested row is outside the image: "+f);const x=this.getWidth();(p==null||p.length<x)&&(p=new Uint8ClampedArray(x));const v=(f+this.top)*this.dataWidth+this.left;return j.arraycopy(this.luminances,v,p,0,x),p}getMatrix(){const f=this.getWidth(),p=this.getHeight();if(f===this.dataWidth&&p===this.dataHeight)return this.luminances;const x=f*p,v=new Uint8ClampedArray(x);let w=this.top*this.dataWidth+this.left;if(f===this.dataWidth)return j.arraycopy(this.luminances,w,v,0,x),v;for(let C=0;C<p;C++){const E=C*f;j.arraycopy(this.luminances,w,v,E,f),w+=this.dataWidth}return v}isCropSupported(){return!0}crop(f,p,x,v){return new uw(this.luminances,x,v,this.dataWidth,this.dataHeight,this.left+f,this.top+p)}invert(){return new J(this)}}class Uk extends L{static forName(f){return this.getCharacterSetECIByName(f)}}class fw{}fw.ISO_8859_1=L.ISO8859_1;class Vk{isCompact(){return this.compact}setCompact(f){this.compact=f}getSize(){return this.size}setSize(f){this.size=f}getLayers(){return this.layers}setLayers(f){this.layers=f}getCodeWords(){return this.codeWords}setCodeWords(f){this.codeWords=f}getMatrix(){return this.matrix}setMatrix(f){this.matrix=f}}class Hk{static singletonList(f){return[f]}static min(f,p){return f.sort(p)[0]}}class BG{constructor(f){this.previous=f}getPrevious(){return this.previous}}class Lu extends BG{constructor(f,p,x){super(f),this.value=p,this.bitCount=x}appendTo(f,p){f.appendBits(this.value,this.bitCount)}add(f,p){return new Lu(this,f,p)}addBinaryShift(f,p){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Lu(this,f,p)}toString(){let f=this.value&(1<<this.bitCount)-1;return f|=1<<this.bitCount,"<"+k.toBinaryString(f|1<<this.bitCount).substring(1)+">"}}class hw extends Lu{constructor(f,p,x){super(f,0,0),this.binaryShiftStart=p,this.binaryShiftByteCount=x}appendTo(f,p){for(let x=0;x<this.binaryShiftByteCount;x++)(x===0||x===31&&this.binaryShiftByteCount<=62)&&(f.appendBits(31,5),this.binaryShiftByteCount>62?f.appendBits(this.binaryShiftByteCount-31,16):x===0?f.appendBits(Math.min(this.binaryShiftByteCount,31),5):f.appendBits(this.binaryShiftByteCount-31,5)),f.appendBits(p[this.binaryShiftStart+x],8)}addBinaryShift(f,p){return new hw(this,f,p)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function FG(H,f,p){return new hw(H,f,p)}function qh(H,f,p){return new Lu(H,f,p)}const $G=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],$l=0,Vx=1,Ya=2,Wk=3,eo=4,zG=new Lu(null,0,0),mw=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function UG(H){for(let f of H)A.fill(f,-1);return H[$l][eo]=0,H[Vx][eo]=0,H[Vx][$l]=28,H[Wk][eo]=0,H[Ya][eo]=0,H[Ya][$l]=15,H}const qk=UG(A.createInt32Array(6,6));class to{constructor(f,p,x,v){this.token=f,this.mode=p,this.binaryShiftByteCount=x,this.bitCount=v}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(f,p){let x=this.bitCount,v=this.token;if(f!==this.mode){let C=mw[this.mode][f];v=qh(v,C&65535,C>>16),x+=C>>16}let w=f===Ya?4:5;return v=qh(v,p,w),new to(v,f,0,x+w)}shiftAndAppend(f,p){let x=this.token,v=this.mode===Ya?4:5;return x=qh(x,qk[this.mode][f],v),x=qh(x,p,5),new to(x,this.mode,0,this.bitCount+v+5)}addBinaryShiftChar(f){let p=this.token,x=this.mode,v=this.bitCount;if(this.mode===eo||this.mode===Ya){let E=mw[x][$l];p=qh(p,E&65535,E>>16),v+=E>>16,x=$l}let w=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,C=new to(p,x,this.binaryShiftByteCount+1,v+w);return C.binaryShiftByteCount===2078&&(C=C.endBinaryShift(f+1)),C}endBinaryShift(f){if(this.binaryShiftByteCount===0)return this;let p=this.token;return p=FG(p,f-this.binaryShiftByteCount,this.binaryShiftByteCount),new to(p,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(f){let p=this.bitCount+(mw[this.mode][f.mode]>>16);return this.binaryShiftByteCount<f.binaryShiftByteCount?p+=to.calculateBinaryShiftCost(f)-to.calculateBinaryShiftCost(this):this.binaryShiftByteCount>f.binaryShiftByteCount&&f.binaryShiftByteCount>0&&(p+=10),p<=f.bitCount}toBitArray(f){let p=[];for(let v=this.endBinaryShift(f.length).token;v!==null;v=v.getPrevious())p.unshift(v);let x=new T;for(const v of p)v.appendTo(x,f);return x}toString(){return F.format("%s bits=%d bytes=%d",$G[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(f){return f.binaryShiftByteCount>62?21:f.binaryShiftByteCount>31?20:f.binaryShiftByteCount>0?10:0}}to.INITIAL_STATE=new to(zG,$l,0,0);function VG(H){const f=F.getCharCode(" "),p=F.getCharCode("."),x=F.getCharCode(",");H[$l][f]=1;const v=F.getCharCode("Z"),w=F.getCharCode("A");for(let Y=w;Y<=v;Y++)H[$l][Y]=Y-w+2;H[Vx][f]=1;const C=F.getCharCode("z"),E=F.getCharCode("a");for(let Y=E;Y<=C;Y++)H[Vx][Y]=Y-E+2;H[Ya][f]=1;const I=F.getCharCode("9"),R=F.getCharCode("0");for(let Y=R;Y<=I;Y++)H[Ya][Y]=Y-R+2;H[Ya][x]=12,H[Ya][p]=13;const B=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let Y=0;Y<B.length;Y++)H[Wk][F.getCharCode(B[Y])]=Y;const W=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let Y=0;Y<W.length;Y++)F.getCharCode(W[Y])>0&&(H[eo][F.getCharCode(W[Y])]=Y);return H}const pw=VG(A.createInt32Array(5,256));class Gh{constructor(f){this.text=f}encode(){const f=F.getCharCode(" "),p=F.getCharCode(`
`);let x=Hk.singletonList(to.INITIAL_STATE);for(let w=0;w<this.text.length;w++){let C,E=w+1<this.text.length?this.text[w+1]:0;switch(this.text[w]){case F.getCharCode("\r"):C=E===p?2:0;break;case F.getCharCode("."):C=E===f?3:0;break;case F.getCharCode(","):C=E===f?4:0;break;case F.getCharCode(":"):C=E===f?5:0;break;default:C=0}C>0?(x=Gh.updateStateListForPair(x,w,C),w++):x=this.updateStateListForChar(x,w)}return Hk.min(x,(w,C)=>w.getBitCount()-C.getBitCount()).toBitArray(this.text)}updateStateListForChar(f,p){const x=[];for(let v of f)this.updateStateForChar(v,p,x);return Gh.simplifyStates(x)}updateStateForChar(f,p,x){let v=this.text[p]&255,w=pw[f.getMode()][v]>0,C=null;for(let E=0;E<=eo;E++){let I=pw[E][v];if(I>0){if(C==null&&(C=f.endBinaryShift(p)),!w||E===f.getMode()||E===Ya){const R=C.latchAndAppend(E,I);x.push(R)}if(!w&&qk[f.getMode()][E]>=0){const R=C.shiftAndAppend(E,I);x.push(R)}}}if(f.getBinaryShiftByteCount()>0||pw[f.getMode()][v]===0){let E=f.addBinaryShiftChar(p);x.push(E)}}static updateStateListForPair(f,p,x){const v=[];for(let w of f)this.updateStateForPair(w,p,x,v);return this.simplifyStates(v)}static updateStateForPair(f,p,x,v){let w=f.endBinaryShift(p);if(v.push(w.latchAndAppend(eo,x)),f.getMode()!==eo&&v.push(w.shiftAndAppend(eo,x)),x===3||x===4){let C=w.latchAndAppend(Ya,16-x).latchAndAppend(Ya,1);v.push(C)}if(f.getBinaryShiftByteCount()>0){let C=f.addBinaryShiftChar(p).addBinaryShiftChar(p+1);v.push(C)}}static simplifyStates(f){let p=[];for(const x of f){let v=!0;for(const w of p){if(w.isBetterThanOrEqualTo(x)){v=!1;break}x.isBetterThanOrEqualTo(w)&&(p=p.filter(C=>C!==w))}v&&p.push(x)}return p}}class Zt{constructor(){}static encodeBytes(f){return Zt.encode(f,Zt.DEFAULT_EC_PERCENT,Zt.DEFAULT_AZTEC_LAYERS)}static encode(f,p,x){let v=new Gh(f).encode(),w=k.truncDivision(v.getSize()*p,100)+11,C=v.getSize()+w,E,I,R,B,W;if(x!==Zt.DEFAULT_AZTEC_LAYERS){if(E=x<0,I=Math.abs(x),I>(E?Zt.MAX_NB_BITS_COMPACT:Zt.MAX_NB_BITS))throw new m(F.format("Illegal value %s for layers",x));R=Zt.totalBitsInLayer(I,E),B=Zt.WORD_SIZE[I];let Le=R-R%B;if(W=Zt.stuffBits(v,B),W.getSize()+w>Le)throw new m("Data to large for user specified layer");if(E&&W.getSize()>B*64)throw new m("Data to large for user specified layer")}else{B=0,W=null;for(let Le=0;;Le++){if(Le>Zt.MAX_NB_BITS)throw new m("Data too large for an Aztec code");if(E=Le<=3,I=E?Le+1:Le,R=Zt.totalBitsInLayer(I,E),C>R)continue;(W==null||B!==Zt.WORD_SIZE[I])&&(B=Zt.WORD_SIZE[I],W=Zt.stuffBits(v,B));let Gt=R-R%B;if(!(E&&W.getSize()>B*64)&&W.getSize()+w<=Gt)break}}let Y=Zt.generateCheckWords(W,R,B),ee=W.getSize()/B,oe=Zt.generateModeMessage(E,I,ee),ce=(E?11:14)+I*4,ge=new Int32Array(ce),Ae;if(E){Ae=ce;for(let Le=0;Le<ge.length;Le++)ge[Le]=Le}else{Ae=ce+1+2*k.truncDivision(k.truncDivision(ce,2)-1,15);let Le=k.truncDivision(ce,2),Gt=k.truncDivision(Ae,2);for(let Dt=0;Dt<Le;Dt++){let Zs=Dt+k.truncDivision(Dt,15);ge[Le-Dt-1]=Gt-Zs-1,ge[Le+Dt]=Gt+Zs+1}}let $e=new U(Ae);for(let Le=0,Gt=0;Le<I;Le++){let Dt=(I-Le)*4+(E?9:12);for(let Zs=0;Zs<Dt;Zs++){let ji=Zs*2;for(let Js=0;Js<2;Js++)Y.get(Gt+ji+Js)&&$e.set(ge[Le*2+Js],ge[Le*2+Zs]),Y.get(Gt+Dt*2+ji+Js)&&$e.set(ge[Le*2+Zs],ge[ce-1-Le*2-Js]),Y.get(Gt+Dt*4+ji+Js)&&$e.set(ge[ce-1-Le*2-Js],ge[ce-1-Le*2-Zs]),Y.get(Gt+Dt*6+ji+Js)&&$e.set(ge[ce-1-Le*2-Zs],ge[Le*2+Js])}Gt+=Dt*8}if(Zt.drawModeMessage($e,E,Ae,oe),E)Zt.drawBullsEye($e,k.truncDivision(Ae,2),5);else{Zt.drawBullsEye($e,k.truncDivision(Ae,2),7);for(let Le=0,Gt=0;Le<k.truncDivision(ce,2)-1;Le+=15,Gt+=16)for(let Dt=k.truncDivision(Ae,2)&1;Dt<Ae;Dt+=2)$e.set(k.truncDivision(Ae,2)-Gt,Dt),$e.set(k.truncDivision(Ae,2)+Gt,Dt),$e.set(Dt,k.truncDivision(Ae,2)-Gt),$e.set(Dt,k.truncDivision(Ae,2)+Gt)}let Ve=new Vk;return Ve.setCompact(E),Ve.setSize(Ae),Ve.setLayers(I),Ve.setCodeWords(ee),Ve.setMatrix($e),Ve}static drawBullsEye(f,p,x){for(let v=0;v<x;v+=2)for(let w=p-v;w<=p+v;w++)f.set(w,p-v),f.set(w,p+v),f.set(p-v,w),f.set(p+v,w);f.set(p-x,p-x),f.set(p-x+1,p-x),f.set(p-x,p-x+1),f.set(p+x,p-x),f.set(p+x,p-x+1),f.set(p+x,p+x-1)}static generateModeMessage(f,p,x){let v=new T;return f?(v.appendBits(p-1,2),v.appendBits(x-1,6),v=Zt.generateCheckWords(v,28,4)):(v.appendBits(p-1,5),v.appendBits(x-1,11),v=Zt.generateCheckWords(v,40,4)),v}static drawModeMessage(f,p,x,v){let w=k.truncDivision(x,2);if(p)for(let C=0;C<7;C++){let E=w-3+C;v.get(C)&&f.set(E,w-5),v.get(C+7)&&f.set(w+5,E),v.get(20-C)&&f.set(E,w+5),v.get(27-C)&&f.set(w-5,E)}else for(let C=0;C<10;C++){let E=w-5+C+k.truncDivision(C,5);v.get(C)&&f.set(E,w-7),v.get(C+10)&&f.set(w+7,E),v.get(29-C)&&f.set(E,w+7),v.get(39-C)&&f.set(w-7,E)}}static generateCheckWords(f,p,x){let v=f.getSize()/x,w=new dw(Zt.getGF(x)),C=k.truncDivision(p,x),E=Zt.bitsToWords(f,x,C);w.encode(E,C-v);let I=p%x,R=new T;R.appendBits(0,I);for(const B of Array.from(E))R.appendBits(B,x);return R}static bitsToWords(f,p,x){let v=new Int32Array(x),w,C;for(w=0,C=f.getSize()/p;w<C;w++){let E=0;for(let I=0;I<p;I++)E|=f.get(w*p+I)?1<<p-I-1:0;v[w]=E}return v}static getGF(f){switch(f){case 4:return We.AZTEC_PARAM;case 6:return We.AZTEC_DATA_6;case 8:return We.AZTEC_DATA_8;case 10:return We.AZTEC_DATA_10;case 12:return We.AZTEC_DATA_12;default:throw new m("Unsupported word size "+f)}}static stuffBits(f,p){let x=new T,v=f.getSize(),w=(1<<p)-2;for(let C=0;C<v;C+=p){let E=0;for(let I=0;I<p;I++)(C+I>=v||f.get(C+I))&&(E|=1<<p-1-I);(E&w)===w?(x.appendBits(E&w,p),C--):E&w?x.appendBits(E,p):(x.appendBits(E|1,p),C--)}return x}static totalBitsInLayer(f,p){return((p?88:112)+16*f)*f}}Zt.DEFAULT_EC_PERCENT=33,Zt.DEFAULT_AZTEC_LAYERS=0,Zt.MAX_NB_BITS=32,Zt.MAX_NB_BITS_COMPACT=4,Zt.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Hx{encode(f,p,x,v){return this.encodeWithHints(f,p,x,v,null)}encodeWithHints(f,p,x,v,w){let C=fw.ISO_8859_1,E=Zt.DEFAULT_EC_PERCENT,I=Zt.DEFAULT_AZTEC_LAYERS;return w!=null&&(w.has(Pr.CHARACTER_SET)&&(C=Uk.forName(w.get(Pr.CHARACTER_SET).toString())),w.has(Pr.ERROR_CORRECTION)&&(E=k.parseInt(w.get(Pr.ERROR_CORRECTION).toString())),w.has(Pr.AZTEC_LAYERS)&&(I=k.parseInt(w.get(Pr.AZTEC_LAYERS).toString()))),Hx.encodeLayers(f,p,x,v,C,E,I)}static encodeLayers(f,p,x,v,w,C,E){if(p!==_e.AZTEC)throw new m("Can only encode AZTEC, but got "+p);let I=Zt.encode(F.getBytes(f,w),C,E);return Hx.renderResult(I,x,v)}static renderResult(f,p,x){let v=f.getMatrix();if(v==null)throw new St;let w=v.getWidth(),C=v.getHeight(),E=Math.max(p,w),I=Math.max(x,C),R=Math.min(E/w,I/C),B=(E-w*R)/2,W=(I-C*R)/2,Y=new U(E,I);for(let ee=0,oe=W;ee<C;ee++,oe+=R)for(let ce=0,ge=B;ce<w;ce++,ge+=R)v.get(ce,ee)&&Y.setRegion(ge,oe,R,R);return Y}}r.AbstractExpandedDecoder=Qi,r.ArgumentException=h,r.ArithmeticException=re,r.AztecCode=Vk,r.AztecCodeReader=Et,r.AztecCodeWriter=Hx,r.AztecDecoder=Ie,r.AztecDetector=tt,r.AztecDetectorResult=Nt,r.AztecEncoder=Zt,r.AztecHighLevelEncoder=Gh,r.AztecPoint=me,r.BarcodeFormat=_e,r.Binarizer=N,r.BinaryBitmap=g,r.BitArray=T,r.BitMatrix=U,r.BitSource=Fh,r.BrowserAztecCodeReader=Ft,r.BrowserBarcodeReader=sd,r.BrowserCodeReader=ye,r.BrowserDatamatrixCodeReader=ve,r.BrowserMultiFormatReader=MG,r.BrowserPDF417Reader=OG,r.BrowserQRCodeReader=DG,r.BrowserQRCodeSvgWriter=od,r.CharacterSetECI=L,r.ChecksumException=y,r.Code128Reader=Ue,r.Code39Reader=an,r.DataMatrixDecodedBitStreamParser=Ni,r.DataMatrixReader=G,r.DecodeHintType=M,r.DecoderResult=ae,r.DefaultGridSampler=tr,r.DetectorResult=De,r.EAN13Reader=$t,r.EncodeHintType=Pr,r.Exception=u,r.FormatException=O,r.GenericGF=We,r.GenericGFPoly=pe,r.GlobalHistogramBinarizer=q,r.GridSampler=Yt,r.GridSamplerInstance=In,r.HTMLCanvasElementLuminanceSource=ne,r.HybridBinarizer=K,r.ITFReader=Kt,r.IllegalArgumentException=m,r.IllegalStateException=St,r.InvertedLuminanceSource=J,r.LuminanceSource=X,r.MathUtils=qe,r.MultiFormatOneDReader=Rl,r.MultiFormatReader=zk,r.MultiFormatWriter=LG,r.NotFoundException=z,r.OneDReader=en,r.PDF417DecodedBitStreamParser=Ce,r.PDF417DecoderErrorCorrection=Dk,r.PDF417Reader=as,r.PDF417ResultMetadata=Lk,r.PerspectiveTransform=Pt,r.PlanarYUVLuminanceSource=Ji,r.QRCodeByteMatrix=Ux,r.QRCodeDataMask=Ga,r.QRCodeDecodedBitStreamParser=qn,r.QRCodeDecoderErrorCorrectionLevel=rt,r.QRCodeDecoderFormatInformation=Tt,r.QRCodeEncoder=Pn,r.QRCodeEncoderQRCode=id,r.QRCodeMaskUtil=rr,r.QRCodeMatrixUtil=jt,r.QRCodeMode=yt,r.QRCodeReader=Bl,r.QRCodeVersion=pt,r.QRCodeWriter=Ru,r.RGBLuminanceSource=uw,r.RSS14Reader=Ln,r.RSSExpandedReader=Me,r.ReaderException=zx,r.ReedSolomonDecoder=wt,r.ReedSolomonEncoder=dw,r.ReedSolomonException=Je,r.Result=be,r.ResultMetadataType=Oe,r.ResultPoint=le,r.StringUtils=F,r.UnsupportedOperationException=$,r.VideoInputDevice=Se,r.WhiteRectangleDetector=sn,r.WriterException=bn,r.ZXingArrays=A,r.ZXingCharset=Uk,r.ZXingInteger=k,r.ZXingStandardCharsets=fw,r.ZXingStringBuilder=Q,r.ZXingStringEncoding=V,r.ZXingSystem=j,r.createAbstractExpandedDecoder=rd,Object.defineProperty(r,"__esModule",{value:!0})})})($C,$C.exports);var On=$C.exports;const eRe=gi(On),tRe=cR({__proto__:null,default:eRe},[On]);var QD=function(){function t(n,r,s){if(this.formatMap=new Map([[at.QR_CODE,On.BarcodeFormat.QR_CODE],[at.AZTEC,On.BarcodeFormat.AZTEC],[at.CODABAR,On.BarcodeFormat.CODABAR],[at.CODE_39,On.BarcodeFormat.CODE_39],[at.CODE_93,On.BarcodeFormat.CODE_93],[at.CODE_128,On.BarcodeFormat.CODE_128],[at.DATA_MATRIX,On.BarcodeFormat.DATA_MATRIX],[at.MAXICODE,On.BarcodeFormat.MAXICODE],[at.ITF,On.BarcodeFormat.ITF],[at.EAN_13,On.BarcodeFormat.EAN_13],[at.EAN_8,On.BarcodeFormat.EAN_8],[at.PDF_417,On.BarcodeFormat.PDF_417],[at.RSS_14,On.BarcodeFormat.RSS_14],[at.RSS_EXPANDED,On.BarcodeFormat.RSS_EXPANDED],[at.UPC_A,On.BarcodeFormat.UPC_A],[at.UPC_E,On.BarcodeFormat.UPC_E],[at.UPC_EAN_EXTENSION,On.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!tRe)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=r,this.logger=s;var i=this.createZXingFormats(n),o=new Map;o.set(On.DecodeHintType.POSSIBLE_FORMATS,i),o.set(On.DecodeHintType.TRY_HARDER,!1),this.hints=o}return t.prototype.decodeAsync=function(n){var r=this;return new Promise(function(s,i){try{s(r.decode(n))}catch(o){i(o)}})},t.prototype.decode=function(n){var r=new On.MultiFormatReader(this.verbose,this.hints),s=new On.HTMLCanvasElementLuminanceSource(n),i=new On.BinaryBitmap(new On.HybridBinarizer(s)),o=r.decode(i);return{text:o.text,format:mG.create(this.toHtml5QrcodeSupportedFormats(o.format)),debugData:this.createDebugData()}},t.prototype.createReverseFormatMap=function(){var n=new Map;return this.formatMap.forEach(function(r,s,i){n.set(r,s)}),n},t.prototype.toHtml5QrcodeSupportedFormats=function(n){if(!this.reverseFormatMap.has(n))throw"reverseFormatMap doesn't have ".concat(n);return this.reverseFormatMap.get(n)},t.prototype.createZXingFormats=function(n){for(var r=[],s=0,i=n;s<i.length;s++){var o=i[s];this.formatMap.has(o)?r.push(this.formatMap.get(o)):this.logger.logError("".concat(o," is not supported by")+"ZXingHtml5QrcodeShim")}return r},t.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},t}(),nRe=function(t,n,r,s){function i(o){return o instanceof r?o:new r(function(l){l(o)})}return new(r||(r=Promise))(function(o,l){function c(h){try{u(s.next(h))}catch(m){l(m)}}function d(h){try{u(s.throw(h))}catch(m){l(m)}}function u(h){h.done?o(h.value):i(h.value).then(c,d)}u((s=s.apply(t,n||[])).next())})},rRe=function(t,n){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},s,i,o,l;return l={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function c(u){return function(h){return d([u,h])}}function d(u){if(s)throw new TypeError("Generator is already executing.");for(;l&&(l=0,u[0]&&(r=0)),r;)try{if(s=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){r.label=u[1];break}if(u[0]===6&&r.label<o[1]){r.label=o[1],o=u;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(u);break}o[2]&&r.ops.pop(),r.trys.pop();continue}u=n.call(t,r)}catch(h){u=[6,h],i=0}finally{s=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},ZD=function(){function t(n,r,s){if(this.formatMap=new Map([[at.QR_CODE,"qr_code"],[at.AZTEC,"aztec"],[at.CODABAR,"codabar"],[at.CODE_39,"code_39"],[at.CODE_93,"code_93"],[at.CODE_128,"code_128"],[at.DATA_MATRIX,"data_matrix"],[at.ITF,"itf"],[at.EAN_13,"ean_13"],[at.EAN_8,"ean_8"],[at.PDF_417,"pdf417"],[at.UPC_A,"upc_a"],[at.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!t.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=r,this.logger=s;var i=this.createBarcodeDetectorFormats(n);if(this.detector=new BarcodeDetector(i),!this.detector)throw"BarcodeDetector detector not supported"}return t.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var n=new BarcodeDetector({formats:["qr_code"]});return typeof n<"u"},t.prototype.decodeAsync=function(n){return nRe(this,void 0,void 0,function(){var r,s;return rRe(this,function(i){switch(i.label){case 0:return[4,this.detector.detect(n)];case 1:if(r=i.sent(),!r||r.length===0)throw"No barcode or QR code detected.";return s=this.selectLargestBarcode(r),[2,{text:s.rawValue,format:mG.create(this.toHtml5QrcodeSupportedFormats(s.format)),debugData:this.createDebugData()}]}})})},t.prototype.selectLargestBarcode=function(n){for(var r=null,s=0,i=0,o=n;i<o.length;i++){var l=o[i],c=l.boundingBox.width*l.boundingBox.height;c>s&&(s=c,r=l)}if(!r)throw"No largest barcode found";return r},t.prototype.createBarcodeDetectorFormats=function(n){for(var r=[],s=0,i=n;s<i.length;s++){var o=i[s];this.formatMap.has(o)?r.push(this.formatMap.get(o)):this.logger.warn("".concat(o," is not supported by")+"BarcodeDetectorDelegate")}return{formats:r}},t.prototype.toHtml5QrcodeSupportedFormats=function(n){if(!this.reverseFormatMap.has(n))throw"reverseFormatMap doesn't have ".concat(n);return this.reverseFormatMap.get(n)},t.prototype.createReverseFormatMap=function(){var n=new Map;return this.formatMap.forEach(function(r,s,i){n.set(r,s)}),n},t.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},t}(),JD=function(t,n,r,s){function i(o){return o instanceof r?o:new r(function(l){l(o)})}return new(r||(r=Promise))(function(o,l){function c(h){try{u(s.next(h))}catch(m){l(m)}}function d(h){try{u(s.throw(h))}catch(m){l(m)}}function u(h){h.done?o(h.value):i(h.value).then(c,d)}u((s=s.apply(t,n||[])).next())})},eR=function(t,n){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},s,i,o,l;return l={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function c(u){return function(h){return d([u,h])}}function d(u){if(s)throw new TypeError("Generator is already executing.");for(;l&&(l=0,u[0]&&(r=0)),r;)try{if(s=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){r.label=u[1];break}if(u[0]===6&&r.label<o[1]){r.label=o[1],o=u;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(u);break}o[2]&&r.ops.pop(),r.trys.pop();continue}u=n.call(t,r)}catch(h){u=[6,h],i=0}finally{s=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},sRe=function(){function t(n,r,s,i){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=s,r&&ZD.isSupported()?(this.primaryDecoder=new ZD(n,s,i),this.secondaryDecoder=new QD(n,s,i)):this.primaryDecoder=new QD(n,s,i)}return t.prototype.decodeAsync=function(n){return JD(this,void 0,void 0,function(){var r;return eR(this,function(s){switch(s.label){case 0:r=performance.now(),s.label=1;case 1:return s.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(n)];case 2:return[2,s.sent()];case 3:return this.possiblyLogPerformance(r),[7];case 4:return[2]}})})},t.prototype.decodeRobustlyAsync=function(n){return JD(this,void 0,void 0,function(){var r,s;return eR(this,function(i){switch(i.label){case 0:r=performance.now(),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(n)];case 2:return[2,i.sent()];case 3:if(s=i.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(n)];throw s;case 4:return this.possiblyLogPerformance(r),[7];case 5:return[2]}})})},t.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},t.prototype.possiblyLogPerformance=function(n){if(this.verbose){var r=performance.now()-n;this.executionResults.push(r),this.executions++,this.possiblyFlushPerformanceReport()}},t.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var n=0,r=0,s=this.executionResults;r<s.length;r++){var i=s[r];n+=i}var o=n/this.executionResults.length;console.log("".concat(o," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},t}(),Pk=function(){var t=function(n,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,i){s.__proto__=i}||function(s,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(s[o]=i[o])},t(n,r)};return function(n,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(n,r);function s(){this.constructor=n}n.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}(),zy=function(t,n,r,s){function i(o){return o instanceof r?o:new r(function(l){l(o)})}return new(r||(r=Promise))(function(o,l){function c(h){try{u(s.next(h))}catch(m){l(m)}}function d(h){try{u(s.throw(h))}catch(m){l(m)}}function u(h){h.done?o(h.value):i(h.value).then(c,d)}u((s=s.apply(t,n||[])).next())})},Uy=function(t,n){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},s,i,o,l;return l={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function c(u){return function(h){return d([u,h])}}function d(u){if(s)throw new TypeError("Generator is already executing.");for(;l&&(l=0,u[0]&&(r=0)),r;)try{if(s=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){r.label=u[1];break}if(u[0]===6&&r.label<o[1]){r.label=o[1],o=u;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(u);break}o[2]&&r.ops.pop(),r.trys.pop();continue}u=n.call(t,r)}catch(h){u=[6,h],i=0}finally{s=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},yG=function(){function t(n,r){this.name=n,this.track=r}return t.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},t.prototype.apply=function(n){var r={};r[this.name]=n;var s={advanced:[r]};return this.track.applyConstraints(s)},t.prototype.value=function(){var n=this.track.getSettings();if(this.name in n){var r=n[this.name];return r}return null},t}(),aRe=function(t){Pk(n,t);function n(r,s){return t.call(this,r,s)||this}return n.prototype.min=function(){return this.getCapabilities().min},n.prototype.max=function(){return this.getCapabilities().max},n.prototype.step=function(){return this.getCapabilities().step},n.prototype.apply=function(r){var s={};s[this.name]=r;var i={advanced:[s]};return this.track.applyConstraints(i)},n.prototype.getCapabilities=function(){this.failIfNotSupported();var r=this.track.getCapabilities(),s=r[this.name];return{min:s.min,max:s.max,step:s.step}},n.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},n}(yG),iRe=function(t){Pk(n,t);function n(r){return t.call(this,"zoom",r)||this}return n}(aRe),oRe=function(t){Pk(n,t);function n(r){return t.call(this,"torch",r)||this}return n}(yG),lRe=function(){function t(n){this.track=n}return t.prototype.zoomFeature=function(){return new iRe(this.track)},t.prototype.torchFeature=function(){return new oRe(this.track)},t}(),cRe=function(){function t(n,r,s){this.isClosed=!1,this.parentElement=n,this.mediaStream=r,this.callbacks=s,this.surface=this.createVideoElement(this.parentElement.clientWidth),n.append(this.surface)}return t.prototype.createVideoElement=function(n){var r=document.createElement("video");return r.style.width="".concat(n,"px"),r.style.display="block",r.muted=!0,r.setAttribute("muted","true"),r.playsInline=!0,r},t.prototype.setupSurface=function(){var n=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var r=function(){var s=n.surface.clientWidth,i=n.surface.clientHeight;n.callbacks.onRenderSurfaceReady(s,i),n.surface.removeEventListener("playing",r)};this.surface.addEventListener("playing",r),this.surface.srcObject=this.mediaStream,this.surface.play()},t.create=function(n,r,s,i){return zy(this,void 0,void 0,function(){var o,l;return Uy(this,function(c){switch(c.label){case 0:return o=new t(n,r,i),s.aspectRatio?(l={aspectRatio:s.aspectRatio},[4,o.getFirstTrackOrFail().applyConstraints(l)]):[3,2];case 1:c.sent(),c.label=2;case 2:return o.setupSurface(),[2,o]}})})},t.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},t.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},t.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},t.prototype.resume=function(n){this.failIfClosed();var r=this,s=function(){setTimeout(n,200),r.surface.removeEventListener("playing",s)};this.surface.addEventListener("playing",s),this.surface.play()},t.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},t.prototype.getSurface=function(){return this.failIfClosed(),this.surface},t.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},t.prototype.applyVideoConstraints=function(n){return zy(this,void 0,void 0,function(){return Uy(this,function(r){if("aspectRatio"in n)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(n)]})})},t.prototype.close=function(){if(this.isClosed)return Promise.resolve();var n=this;return new Promise(function(r,s){var i=n.mediaStream.getVideoTracks(),o=i.length,l=0;n.mediaStream.getVideoTracks().forEach(function(c){n.mediaStream.removeTrack(c),c.stop(),++l,l>=o&&(n.isClosed=!0,n.parentElement.removeChild(n.surface),r())})})},t.prototype.getCapabilities=function(){return new lRe(this.getFirstTrackOrFail())},t}(),dRe=function(){function t(n){this.mediaStream=n}return t.prototype.render=function(n,r,s){return zy(this,void 0,void 0,function(){return Uy(this,function(i){return[2,cRe.create(n,this.mediaStream,r,s)]})})},t.create=function(n){return zy(this,void 0,void 0,function(){var r,s;return Uy(this,function(i){switch(i.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return r={audio:!1,video:n},[4,navigator.mediaDevices.getUserMedia(r)];case 1:return s=i.sent(),[2,new t(s)]}})})},t}(),tR=function(t,n,r,s){function i(o){return o instanceof r?o:new r(function(l){l(o)})}return new(r||(r=Promise))(function(o,l){function c(h){try{u(s.next(h))}catch(m){l(m)}}function d(h){try{u(s.throw(h))}catch(m){l(m)}}function u(h){h.done?o(h.value):i(h.value).then(c,d)}u((s=s.apply(t,n||[])).next())})},nR=function(t,n){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},s,i,o,l;return l={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function c(u){return function(h){return d([u,h])}}function d(u){if(s)throw new TypeError("Generator is already executing.");for(;l&&(l=0,u[0]&&(r=0)),r;)try{if(s=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){r.label=u[1];break}if(u[0]===6&&r.label<o[1]){r.label=o[1],o=u;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(u);break}o[2]&&r.ops.pop(),r.trys.pop();continue}u=n.call(t,r)}catch(h){u=[6,h],i=0}finally{s=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},uRe=function(){function t(){}return t.failIfNotSupported=function(){return tR(this,void 0,void 0,function(){return nR(this,function(n){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new t]})})},t.prototype.create=function(n){return tR(this,void 0,void 0,function(){return nR(this,function(r){return[2,dRe.create(n)]})})},t}(),fRe=function(t,n,r,s){function i(o){return o instanceof r?o:new r(function(l){l(o)})}return new(r||(r=Promise))(function(o,l){function c(h){try{u(s.next(h))}catch(m){l(m)}}function d(h){try{u(s.throw(h))}catch(m){l(m)}}function u(h){h.done?o(h.value):i(h.value).then(c,d)}u((s=s.apply(t,n||[])).next())})},hRe=function(t,n){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},s,i,o,l;return l={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function c(u){return function(h){return d([u,h])}}function d(u){if(s)throw new TypeError("Generator is already executing.");for(;l&&(l=0,u[0]&&(r=0)),r;)try{if(s=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){r.label=u[1];break}if(u[0]===6&&r.label<o[1]){r.label=o[1],o=u;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(u);break}o[2]&&r.ops.pop(),r.trys.pop();continue}u=n.call(t,r)}catch(h){u=[6,h],i=0}finally{s=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},mRe=function(){function t(){}return t.retrieve=function(){if(navigator.mediaDevices)return t.getCamerasFromMediaDevices();var n=MediaStreamTrack;return MediaStreamTrack&&n.getSources?t.getCamerasFromMediaStreamTrack():t.rejectWithError()},t.rejectWithError=function(){var n=wf.unableToQuerySupportedDevices();return t.isHttpsOrLocalhost()||(n=wf.insecureContextCameraQueryError()),Promise.reject(n)},t.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var n=location.host.split(":")[0];return n==="127.0.0.1"||n==="localhost"},t.getCamerasFromMediaDevices=function(){return fRe(this,void 0,void 0,function(){var n,r,s,i,o,l,c;return hRe(this,function(d){switch(d.label){case 0:return n=function(u){for(var h=u.getVideoTracks(),m=0,g=h;m<g.length;m++){var y=g[m];y.enabled=!1,y.stop(),u.removeTrack(y)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return r=d.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(s=d.sent(),i=[],o=0,l=s;o<l.length;o++)c=l[o],c.kind==="videoinput"&&i.push({id:c.deviceId,label:c.label});return n(r),[2,i]}})})},t.getCamerasFromMediaStreamTrack=function(){return new Promise(function(n,r){var s=function(o){for(var l=[],c=0,d=o;c<d.length;c++){var u=d[c];u.kind==="video"&&l.push({id:u.id,label:u.label})}n(l)},i=MediaStreamTrack;i.getSources(s)})},t}(),sr;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.NOT_STARTED=1]="NOT_STARTED",t[t.SCANNING=2]="SCANNING",t[t.PAUSED=3]="PAUSED"})(sr||(sr={}));var pRe=function(){function t(){this.state=sr.NOT_STARTED,this.onGoingTransactionNewState=sr.UNKNOWN}return t.prototype.directTransition=function(n){this.failIfTransitionOngoing(),this.validateTransition(n),this.state=n},t.prototype.startTransition=function(n){return this.failIfTransitionOngoing(),this.validateTransition(n),this.onGoingTransactionNewState=n,this},t.prototype.execute=function(){if(this.onGoingTransactionNewState===sr.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var n=this.onGoingTransactionNewState;this.onGoingTransactionNewState=sr.UNKNOWN,this.directTransition(n)},t.prototype.cancel=function(){if(this.onGoingTransactionNewState===sr.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=sr.UNKNOWN},t.prototype.getState=function(){return this.state},t.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==sr.UNKNOWN)throw"Cannot transition to a new state, already under transition"},t.prototype.validateTransition=function(n){switch(this.state){case sr.UNKNOWN:throw"Transition from unknown is not allowed";case sr.NOT_STARTED:this.failIfNewStateIs(n,[sr.PAUSED]);break;case sr.SCANNING:break;case sr.PAUSED:break}},t.prototype.failIfNewStateIs=function(n,r){for(var s=0,i=r;s<i.length;s++){var o=i[s];if(n===o)throw"Cannot transition from ".concat(this.state," to ").concat(n)}},t}(),xRe=function(){function t(n){this.stateManager=n}return t.prototype.startTransition=function(n){return this.stateManager.startTransition(n)},t.prototype.directTransition=function(n){this.stateManager.directTransition(n)},t.prototype.getState=function(){return this.stateManager.getState()},t.prototype.canScanFile=function(){return this.stateManager.getState()===sr.NOT_STARTED},t.prototype.isScanning=function(){return this.stateManager.getState()!==sr.NOT_STARTED},t.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===sr.SCANNING},t.prototype.isPaused=function(){return this.stateManager.getState()===sr.PAUSED},t}(),gRe=function(){function t(){}return t.create=function(){return new xRe(new pRe)},t}(),yRe=function(){var t=function(n,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,i){s.__proto__=i}||function(s,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(s[o]=i[o])},t(n,r)};return function(n,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(n,r);function s(){this.constructor=n}n.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}(),wa=function(t){yRe(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}return n.DEFAULT_WIDTH=300,n.DEFAULT_WIDTH_OFFSET=2,n.FILE_SCAN_MIN_HEIGHT=300,n.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,n.MIN_QR_BOX_SIZE=50,n.SHADED_LEFT=1,n.SHADED_RIGHT=2,n.SHADED_TOP=3,n.SHADED_BOTTOM=4,n.SHADED_REGION_ELEMENT_ID="qr-shaded-region",n.VERBOSE=!1,n.BORDER_SHADER_DEFAULT_COLOR="#ffffff",n.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",n}(Ti),vRe=function(){function t(n,r){this.logger=r,this.fps=wa.SCAN_DEFAULT_FPS,n?(n.fps&&(this.fps=n.fps),this.disableFlip=n.disableFlip===!0,this.qrbox=n.qrbox,this.aspectRatio=n.aspectRatio,this.videoConstraints=n.videoConstraints):this.disableFlip=wa.DEFAULT_DISABLE_FLIP}return t.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?gG.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},t.prototype.isShadedBoxEnabled=function(){return!co(this.qrbox)},t.create=function(n,r){return new t(n,r)},t}(),rR=function(){function t(n,r){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(n))throw"HTML Element with id=".concat(n," not found");this.elementId=n,this.verbose=!1;var s;typeof r=="boolean"?this.verbose=r===!0:r&&(s=r,this.verbose=s.verbose===!0,s.experimentalFeatures),this.logger=new xG(this.verbose),this.qrcode=new sRe(this.getSupportedFormats(r),this.getUseBarCodeDetectorIfSupported(s),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=gRe.create()}return t.prototype.start=function(n,r,s,i){var o=this;if(!n)throw"cameraIdOrConfig is required";if(!s||typeof s!="function")throw"qrCodeSuccessCallback is required and should be a function.";var l;i?l=i:l=this.verbose?this.logger.log:function(){};var c=vRe.create(r,this.logger);this.clearElement();var d=!1;c.videoConstraints&&(c.isMediaStreamConstraintsValid()?d=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var u=d,h=document.getElementById(this.elementId);h.clientWidth?h.clientWidth:wa.DEFAULT_WIDTH,h.style.position="relative",this.shouldScan=!0,this.element=h;var m=this,g=this.stateManagerProxy.startTransition(sr.SCANNING);return new Promise(function(y,N){var j=u?c.videoConstraints:m.createVideoConstraints(n);if(!j){g.cancel(),N("videoConstraints should be defined");return}var S={};(!u||c.aspectRatio)&&(S.aspectRatio=c.aspectRatio);var _={onRenderSurfaceReady:function(A,k){m.setupUi(A,k,c),m.isScanning=!0,m.foreverScan(c,s,l)}};uRe.failIfNotSupported().then(function(A){A.create(j).then(function(k){return k.render(o.element,S,_).then(function(T){m.renderedCamera=T,g.execute(),y(null)}).catch(function(T){g.cancel(),N(T)})}).catch(function(k){g.cancel(),N(wf.errorGettingUserMedia(k))})}).catch(function(A){g.cancel(),N(wf.cameraStreamingNotSupported())})})},t.prototype.pause=function(n){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(sr.PAUSED),this.showPausedState(),(co(n)||n!==!0)&&(n=!1),n&&this.renderedCamera&&this.renderedCamera.pause()},t.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var n=this,r=function(){n.stateManagerProxy.directTransition(sr.SCANNING),n.hidePausedState()};if(!this.renderedCamera.isPaused()){r();return}this.renderedCamera.resume(function(){r()})},t.prototype.getState=function(){return this.stateManagerProxy.getState()},t.prototype.stop=function(){var n=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var r=this.stateManagerProxy.startTransition(sr.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var s=function(){if(n.element){var o=document.getElementById(wa.SHADED_REGION_ELEMENT_ID);o&&n.element.removeChild(o)}},i=this;return this.renderedCamera.close().then(function(){return i.renderedCamera=null,i.element&&(i.element.removeChild(i.canvasElement),i.canvasElement=null),s(),i.qrRegion&&(i.qrRegion=null),i.context&&(i.context=null),r.execute(),i.hidePausedState(),i.isScanning=!1,Promise.resolve()})},t.prototype.scanFile=function(n,r){return this.scanFileV2(n,r).then(function(s){return s.decodedText})},t.prototype.scanFileV2=function(n,r){var s=this;if(!n||!(n instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(co(r)&&(r=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(i,o){s.possiblyCloseLastScanImageFile(),s.clearElement(),s.lastScanImageFile=URL.createObjectURL(n);var l=new Image;l.onload=function(){var c=l.width,d=l.height,u=document.getElementById(s.elementId),h=u.clientWidth?u.clientWidth:wa.DEFAULT_WIDTH,m=Math.max(u.clientHeight?u.clientHeight:d,wa.FILE_SCAN_MIN_HEIGHT),g=s.computeCanvasDrawConfig(c,d,h,m);if(r){var y=s.createCanvasElement(h,m,"qr-canvas-visible");y.style.display="inline-block",u.appendChild(y);var N=y.getContext("2d");if(!N)throw"Unable to get 2d context from canvas";N.canvas.width=h,N.canvas.height=m,N.drawImage(l,0,0,c,d,g.x,g.y,g.width,g.height)}var j=wa.FILE_SCAN_HIDDEN_CANVAS_PADDING,S=Math.max(l.width,g.width),_=Math.max(l.height,g.height),A=S+2*j,k=_+2*j,T=s.createCanvasElement(A,k);u.appendChild(T);var P=T.getContext("2d");if(!P)throw"Unable to get 2d context from canvas";P.canvas.width=A,P.canvas.height=k,P.drawImage(l,0,0,c,d,j,j,S,_);try{s.qrcode.decodeRobustlyAsync(T).then(function(M){i(YD.createFromQrcodeResult(M))}).catch(o)}catch(M){o("QR code parse error, error = ".concat(M))}},l.onerror=o,l.onabort=o,l.onstalled=o,l.onsuspend=o,l.src=URL.createObjectURL(n)})},t.prototype.clear=function(){this.clearElement()},t.getCameras=function(){return mRe.retrieve()},t.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},t.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},t.prototype.applyVideoConstraints=function(n){if(n){if(!gG.isMediaStreamConstraintsValid(n,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(n)},t.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},t.prototype.getSupportedFormats=function(n){var r=[at.QR_CODE,at.AZTEC,at.CODABAR,at.CODE_39,at.CODE_93,at.CODE_128,at.DATA_MATRIX,at.MAXICODE,at.ITF,at.EAN_13,at.EAN_8,at.PDF_417,at.RSS_14,at.RSS_EXPANDED,at.UPC_A,at.UPC_E,at.UPC_EAN_EXTENSION];if(!n||typeof n=="boolean"||!n.formatsToSupport)return r;if(!Array.isArray(n.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(n.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var s=[],i=0,o=n.formatsToSupport;i<o.length;i++){var l=o[i];ZDe(l)?s.push(l):this.logger.warn("Invalid format: ".concat(l," passed in config, ignoring."))}if(s.length===0)throw"None of formatsToSupport match supported values.";return s},t.prototype.getUseBarCodeDetectorIfSupported=function(n){if(co(n))return!0;if(!co(n.useBarCodeDetectorIfSupported))return n.useBarCodeDetectorIfSupported!==!1;if(co(n.experimentalFeatures))return!0;var r=n.experimentalFeatures;return co(r.useBarCodeDetectorIfSupported)?!0:r.useBarCodeDetectorIfSupported!==!1},t.prototype.validateQrboxSize=function(n,r,s){var i=this,o=s.qrbox;this.validateQrboxConfig(o);var l=this.toQrdimensions(n,r,o),c=function(u){if(u<wa.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(wa.MIN_QR_BOX_SIZE,"px.")},d=function(u){return u>n&&(i.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),u=n),u};c(l.width),c(l.height),l.width=d(l.width)},t.prototype.validateQrboxConfig=function(n){if(typeof n!="number"&&typeof n!="function"&&(n.width===void 0||n.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},t.prototype.toQrdimensions=function(n,r,s){if(typeof s=="number")return{width:s,height:s};if(typeof s=="function")try{return s(n,r)}catch(i){throw new Error("qrbox config was passed as a function but it failed with unknown error"+i)}return s},t.prototype.setupUi=function(n,r,s){s.isShadedBoxEnabled()&&this.validateQrboxSize(n,r,s);var i=co(s.qrbox)?{width:n,height:r}:s.qrbox;this.validateQrboxConfig(i);var o=this.toQrdimensions(n,r,i);o.height>r&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var l=s.isShadedBoxEnabled()&&o.height<=r,c={x:0,y:0,width:n,height:r},d=l?this.getShadedRegionBounds(n,r,o):c,u=this.createCanvasElement(d.width,d.height),h={willReadFrequently:!0},m=u.getContext("2d",h);m.canvas.width=d.width,m.canvas.height=d.height,this.element.append(u),l&&this.possiblyInsertShadingElement(this.element,n,r,o),this.createScannerPausedUiElement(this.element),this.qrRegion=d,this.context=m,this.canvasElement=u},t.prototype.createScannerPausedUiElement=function(n){var r=document.createElement("div");r.innerText=wf.scannerPaused(),r.style.display="none",r.style.position="absolute",r.style.top="0px",r.style.zIndex="1",r.style.background="rgba(9, 9, 9, 0.46)",r.style.color="#FFECEC",r.style.textAlign="center",r.style.width="100%",n.appendChild(r),this.scannerPausedUiElement=r},t.prototype.scanContext=function(n,r){var s=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(i){return n(i.text,YD.createFromQrcodeResult(i)),s.possiblyUpdateShaders(!0),!0}).catch(function(i){s.possiblyUpdateShaders(!1);var o=wf.codeParseError(i);return r(o,pG.createFrom(o)),!1})},t.prototype.foreverScan=function(n,r,s){var i=this;if(this.shouldScan&&this.renderedCamera){var o=this.renderedCamera.getSurface(),l=o.videoWidth/o.clientWidth,c=o.videoHeight/o.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var d=this.qrRegion.width*l,u=this.qrRegion.height*c,h=this.qrRegion.x*l,m=this.qrRegion.y*c;this.context.drawImage(o,h,m,d,u,0,0,this.qrRegion.width,this.qrRegion.height);var g=function(){i.foreverScanTimeout=setTimeout(function(){i.foreverScan(n,r,s)},i.getTimeoutFps(n.fps))};this.scanContext(r,s).then(function(y){!y&&n.disableFlip!==!0?(i.context.translate(i.context.canvas.width,0),i.context.scale(-1,1),i.scanContext(r,s).finally(function(){g()})):g()}).catch(function(y){i.logger.logError("Error happend while scanning context",y),g()})}},t.prototype.createVideoConstraints=function(n){if(typeof n=="string")return{deviceId:{exact:n}};if(typeof n=="object"){var r="facingMode",s="deviceId",i={user:!0,environment:!0},o="exact",l=function(N){if(N in i)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(N,"'")},c=Object.keys(n);if(c.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(c.length," keys");var d=Object.keys(n)[0];if(d!==r&&d!==s)throw"Only '".concat(r,"' and '").concat(s,"' ")+" are supported for 'cameraIdOrConfig'";if(d===r){var u=n.facingMode;if(typeof u=="string"){if(l(u))return{facingMode:u}}else if(typeof u=="object")if(o in u){if(l(u["".concat(o)]))return{facingMode:{exact:u["".concat(o)]}}}else throw"'facingMode' should be string or object with"+" ".concat(o," as key.");else{var h=typeof u;throw"Invalid type of 'facingMode' = ".concat(h)}}else{var m=n.deviceId;if(typeof m=="string")return{deviceId:m};if(typeof m=="object"){if(o in m)return{deviceId:{exact:m["".concat(o)]}};throw"'deviceId' should be string or object with"+" ".concat(o," as key.")}else{var g=typeof m;throw"Invalid type of 'deviceId' = ".concat(g)}}}var y=typeof n;throw"Invalid type of 'cameraIdOrConfig' = ".concat(y)},t.prototype.computeCanvasDrawConfig=function(n,r,s,i){if(n<=s&&r<=i){var o=(s-n)/2,l=(i-r)/2;return{x:o,y:l,width:n,height:r}}else{var c=n,d=r;return n>s&&(r=s/n*r,n=s),r>i&&(n=i/r*n,r=i),this.logger.log("Image downsampled from "+"".concat(c,"X").concat(d)+" to ".concat(n,"X").concat(r,".")),this.computeCanvasDrawConfig(n,r,s,i)}},t.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var n=document.getElementById(this.elementId);n&&(n.innerHTML="")},t.prototype.possiblyUpdateShaders=function(n){this.qrMatch!==n&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(r){r.style.backgroundColor=n?wa.BORDER_SHADER_MATCH_COLOR:wa.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=n)},t.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},t.prototype.createCanvasElement=function(n,r,s){var i=n,o=r,l=document.createElement("canvas");return l.style.width="".concat(i,"px"),l.style.height="".concat(o,"px"),l.style.display="none",l.id=co(s)?"qr-canvas":s,l},t.prototype.getShadedRegionBounds=function(n,r,s){if(s.width>n||s.height>r)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(n-s.width)/2,y:(r-s.height)/2,width:s.width,height:s.height}},t.prototype.possiblyInsertShadingElement=function(n,r,s,i){if(!(r-i.width<1||s-i.height<1)){var o=document.createElement("div");o.style.position="absolute";var l=(r-i.width)/2,c=(s-i.height)/2;if(o.style.borderLeft="".concat(l,"px solid rgba(0, 0, 0, 0.48)"),o.style.borderRight="".concat(l,"px solid rgba(0, 0, 0, 0.48)"),o.style.borderTop="".concat(c,"px solid rgba(0, 0, 0, 0.48)"),o.style.borderBottom="".concat(c,"px solid rgba(0, 0, 0, 0.48)"),o.style.boxSizing="border-box",o.style.top="0px",o.style.bottom="0px",o.style.left="0px",o.style.right="0px",o.id="".concat(wa.SHADED_REGION_ELEMENT_ID),r-i.width<11||s-i.height<11)this.hasBorderShaders=!1;else{var d=5,u=40;this.insertShaderBorders(o,u,d,-d,null,0,!0),this.insertShaderBorders(o,u,d,-d,null,0,!1),this.insertShaderBorders(o,u,d,null,-d,0,!0),this.insertShaderBorders(o,u,d,null,-d,0,!1),this.insertShaderBorders(o,d,u+d,-d,null,-d,!0),this.insertShaderBorders(o,d,u+d,null,-d,-d,!0),this.insertShaderBorders(o,d,u+d,-d,null,-d,!1),this.insertShaderBorders(o,d,u+d,null,-d,-d,!1),this.hasBorderShaders=!0}n.append(o)}},t.prototype.insertShaderBorders=function(n,r,s,i,o,l,c){var d=document.createElement("div");d.style.position="absolute",d.style.backgroundColor=wa.BORDER_SHADER_DEFAULT_COLOR,d.style.width="".concat(r,"px"),d.style.height="".concat(s,"px"),i!==null&&(d.style.top="".concat(i,"px")),o!==null&&(d.style.bottom="".concat(o,"px")),c?d.style.left="".concat(l,"px"):d.style.right="".concat(l,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(d),n.appendChild(d)},t.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},t.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},t.prototype.getTimeoutFps=function(n){return 1e3/n},t}(),Mk="data:image/svg+xml;base64,",bRe=Mk+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNzEuNjQzIDM3MS42NDMiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDM3MS42NDMgMzcxLjY0MyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZD0iTTEwNS4wODQgMzguMjcxaDE2My43Njh2MjBIMTA1LjA4NHoiLz48cGF0aCBkPSJNMzExLjU5NiAxOTAuMTg5Yy03LjQ0MS05LjM0Ny0xOC40MDMtMTYuMjA2LTMyLjc0My0yMC41MjJWMzBjMC0xNi41NDItMTMuNDU4LTMwLTMwLTMwSDEyNS4wODRjLTE2LjU0MiAwLTMwIDEzLjQ1OC0zMCAzMHYxMjAuMTQzaC04LjI5NmMtMTYuNTQyIDAtMzAgMTMuNDU4LTMwIDMwdjEuMzMzYTI5LjgwNCAyOS44MDQgMCAwIDAgNC42MDMgMTUuOTM5Yy03LjM0IDUuNDc0LTEyLjEwMyAxNC4yMjEtMTIuMTAzIDI0LjA2MXYxLjMzM2MwIDkuODQgNC43NjMgMTguNTg3IDEyLjEwMyAyNC4wNjJhMjkuODEgMjkuODEgMCAwIDAtNC42MDMgMTUuOTM4djEuMzMzYzAgMTYuNTQyIDEzLjQ1OCAzMCAzMCAzMGg4LjMyNGMuNDI3IDExLjYzMSA3LjUwMyAyMS41ODcgMTcuNTM0IDI2LjE3Ny45MzEgMTAuNTAzIDQuMDg0IDMwLjE4NyAxNC43NjggNDUuNTM3YTkuOTg4IDkuOTg4IDAgMCAwIDguMjE2IDQuMjg4IDkuOTU4IDkuOTU4IDAgMCAwIDUuNzA0LTEuNzkzYzQuNTMzLTMuMTU1IDUuNjUtOS4zODggMi40OTUtMTMuOTIxLTYuNzk4LTkuNzY3LTkuNjAyLTIyLjYwOC0xMC43Ni0zMS40aDgyLjY4NWMuMjcyLjQxNC41NDUuODE4LjgxNSAxLjIxIDMuMTQyIDQuNTQxIDkuMzcyIDUuNjc5IDEzLjkxMyAyLjUzNCA0LjU0Mi0zLjE0MiA1LjY3Ny05LjM3MSAyLjUzNS0xMy45MTMtMTEuOTE5LTE3LjIyOS04Ljc4Ny0zNS44ODQgOS41ODEtNTcuMDEyIDMuMDY3LTIuNjUyIDEyLjMwNy0xMS43MzIgMTEuMjE3LTI0LjAzMy0uODI4LTkuMzQzLTcuMTA5LTE3LjE5NC0xOC42NjktMjMuMzM3YTkuODU3IDkuODU3IDAgMCAwLTEuMDYxLS40ODZjLS40NjYtLjE4Mi0xMS40MDMtNC41NzktOS43NDEtMTUuNzA2IDEuMDA3LTYuNzM3IDE0Ljc2OC04LjI3MyAyMy43NjYtNy42NjYgMjMuMTU2IDEuNTY5IDM5LjY5OCA3LjgwMyA0Ny44MzYgMTguMDI2IDUuNzUyIDcuMjI1IDcuNjA3IDE2LjYyMyA1LjY3MyAyOC43MzMtLjQxMyAyLjU4NS0uODI0IDUuMjQxLTEuMjQ1IDcuOTU5LTUuNzU2IDM3LjE5NC0xMi45MTkgODMuNDgzLTQ5Ljg3IDExNC42NjEtNC4yMjEgMy41NjEtNC43NTYgOS44Ny0xLjE5NCAxNC4wOTJhOS45OCA5Ljk4IDAgMCAwIDcuNjQ4IDMuNTUxIDkuOTU1IDkuOTU1IDAgMCAwIDYuNDQ0LTIuMzU4YzQyLjY3Mi0zNi4wMDUgNTAuODAyLTg4LjUzMyA1Ni43MzctMTI2Ljg4OC40MTUtMi42ODQuODIxLTUuMzA5IDEuMjI5LTcuODYzIDIuODM0LTE3LjcyMS0uNDU1LTMyLjY0MS05Ljc3Mi00NC4zNDV6bS0yMzIuMzA4IDQyLjYyYy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM2MwLTUuNTE0IDQuNDg2LTEwIDEwLTEwaDE1djIxLjMzM2gtMTV6bS0yLjUtNTIuNjY2YzAtNS41MTQgNC40ODYtMTAgMTAtMTBoNy41djIxLjMzM2gtNy41Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM3ptMTcuNSA5My45OTloLTcuNWMtNS41MTQgMC0xMC00LjQ4Ni0xMC0xMHYtMS4zMzNjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGg3LjV2MjEuMzMzem0zMC43OTYgMjguODg3Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi04LjI3MWg5MS40NTdjLS44NTEgNi42NjgtLjQzNyAxMi43ODcuNzMxIDE4LjI3MWgtODIuMTg4em03OS40ODItMTEzLjY5OGMtMy4xMjQgMjAuOTA2IDEyLjQyNyAzMy4xODQgMjEuNjI1IDM3LjA0IDUuNDQxIDIuOTY4IDcuNTUxIDUuNjQ3IDcuNzAxIDcuMTg4LjIxIDIuMTUtMi41NTMgNS42ODQtNC40NzcgNy4yNTEtLjQ4Mi4zNzgtLjkyOS44LTEuMzM1IDEuMjYxLTYuOTg3IDcuOTM2LTExLjk4MiAxNS41Mi0xNS40MzIgMjIuNjg4aC05Ny41NjRWMzBjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGgxMjMuNzY5YzUuNTE0IDAgMTAgNC40ODYgMTAgMTB2MTM1LjU3OWMtMy4wMzItLjM4MS02LjE1LS42OTQtOS4zODktLjkxNC0yNS4xNTktMS42OTQtNDIuMzcgNy43NDgtNDQuODk4IDI0LjY2NnoiLz48cGF0aCBkPSJNMTc5LjEyOSA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXpNMTcyLjYyOSAxNDIuODZoLTEyLjU2VjEzMC44YTUgNSAwIDEgMC0xMCAwdjE3LjA2MWE1IDUgMCAwIDAgNSA1aDE3LjU2YTUgNSAwIDEgMCAwLTEwLjAwMXpNMjE2LjU2OCA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXptLTUgMjQuMDYxaC0xNC4wNlY5My4xNjdoMTQuMDZ2MTQuMDYxek0yMTEuNjY5IDEyNS45MzZIMTk3LjQxYTUgNSAwIDAgMC01IDV2MTQuMjU3YTUgNSAwIDAgMCA1IDVoMTQuMjU5YTUgNSAwIDAgMCA1LTV2LTE0LjI1N2E1IDUgMCAwIDAtNS01eiIvPjwvc3ZnPg==",wRe=Mk+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1OS4wMTggNTkuMDE4IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1OS4wMTggNTkuMDE4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJtNTguNzQxIDU0LjgwOS01Ljk2OS02LjI0NGExMC43NCAxMC43NCAwIDAgMCAyLjgyLTcuMjVjMC01Ljk1My00Ljg0My0xMC43OTYtMTAuNzk2LTEwLjc5NlMzNCAzNS4zNjEgMzQgNDEuMzE0IDM4Ljg0MyA1Mi4xMSA0NC43OTYgNTIuMTFjMi40NDEgMCA0LjY4OC0uODI0IDYuNDk5LTIuMTk2bDYuMDAxIDYuMjc3YS45OTguOTk4IDAgMCAwIDEuNDE0LjAzMiAxIDEgMCAwIDAgLjAzMS0xLjQxNHpNMzYgNDEuMzE0YzAtNC44NSAzLjk0Ni04Ljc5NiA4Ljc5Ni04Ljc5NnM4Ljc5NiAzLjk0NiA4Ljc5NiA4Ljc5Ni0zLjk0NiA4Ljc5Ni04Ljc5NiA4Ljc5NlMzNiA0Ni4xNjQgMzYgNDEuMzE0ek0xMC40MzEgMTYuMDg4YzAgMy4wNyAyLjQ5OCA1LjU2OCA1LjU2OSA1LjU2OHM1LjU2OS0yLjQ5OCA1LjU2OS01LjU2OGMwLTMuMDcxLTIuNDk4LTUuNTY5LTUuNTY5LTUuNTY5cy01LjU2OSAyLjQ5OC01LjU2OSA1LjU2OXptOS4xMzggMGMwIDEuOTY4LTEuNjAyIDMuNTY4LTMuNTY5IDMuNTY4cy0zLjU2OS0xLjYwMS0zLjU2OS0zLjU2OCAxLjYwMi0zLjU2OSAzLjU2OS0zLjU2OSAzLjU2OSAxLjYwMSAzLjU2OSAzLjU2OXoiLz48cGF0aCBkPSJtMzAuODgyIDI4Ljk4NyA5LjE4LTEwLjA1NCAxMS4yNjIgMTAuMzIzYTEgMSAwIDAgMCAxLjM1MS0xLjQ3NWwtMTItMTFhMSAxIDAgMCAwLTEuNDE0LjA2M2wtOS43OTQgMTAuNzI3LTQuNzQzLTQuNzQzYTEuMDAzIDEuMDAzIDAgMCAwLTEuMzY4LS4wNDRMNi4zMzkgMzcuNzY4YTEgMSAwIDEgMCAxLjMyMiAxLjUwMWwxNi4zMTMtMTQuMzYyIDcuMzE5IDcuMzE4YS45OTkuOTk5IDAgMSAwIDEuNDE0LTEuNDE0bC0xLjgyNS0xLjgyNHoiLz48cGF0aCBkPSJNMzAgNDYuNTE4SDJ2LTQyaDU0djI4YTEgMSAwIDEgMCAyIDB2LTI5YTEgMSAwIDAgMC0xLTFIMWExIDEgMCAwIDAtMSAxdjQ0YTEgMSAwIDAgMCAxIDFoMjlhMSAxIDAgMSAwIDAtMnoiLz48L3N2Zz4=",sR=Mk+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NjAgNDYwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0NjAgNDYwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJNMjMwIDBDMTAyLjk3NSAwIDAgMTAyLjk3NSAwIDIzMHMxMDIuOTc1IDIzMCAyMzAgMjMwIDIzMC0xMDIuOTc0IDIzMC0yMzBTMzU3LjAyNSAwIDIzMCAwem0zOC4zMzMgMzc3LjM2YzAgOC42NzYtNy4wMzQgMTUuNzEtMTUuNzEgMTUuNzFoLTQzLjEwMWMtOC42NzYgMC0xNS43MS03LjAzNC0xNS43MS0xNS43MVYyMDIuNDc3YzAtOC42NzYgNy4wMzMtMTUuNzEgMTUuNzEtMTUuNzFoNDMuMTAxYzguNjc2IDAgMTUuNzEgNy4wMzMgMTUuNzEgMTUuNzFWMzc3LjM2ek0yMzAgMTU3Yy0yMS41MzkgMC0zOS0xNy40NjEtMzktMzlzMTcuNDYxLTM5IDM5LTM5IDM5IDE3LjQ2MSAzOSAzOS0xNy40NjEgMzktMzkgMzl6Ii8+PC9zdmc+",NRe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAQgAAAEIBarqQRAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAE1SURBVDiNfdI7S0NBEAXgLya1otFgpbYSbISAgpXYi6CmiH9KCAiChaVga6OiWPgfRDQ+0itaGVNosXtluWwcuMzePfM4M3sq8lbHBubwg1dc4m1E/J/N4ghDPOIsfk/4xiEao5KX0McFljN4C9d4QTPXuY99jP3DsIoDPGM6BY5i5yI5R7O4q+ImFkJY2DCh3cAH2klyB+9J1xUMMAG7eCh1a+Mr+k48b5diXrFVwwLuS+BJ9MfR7+G0FHOHhTHhnXNWS87VDF4pcnfQK4Ep7XScNLmPTZgURNKKYENYWDpzW1BhscS1WHS8CDgURFJQrWcoF3c13KKbgg1BYQfy8xZWEzTTw1QZbAoKu8FqJnktdu5hcVSHmchiILzzuaDQvjBzV2m8yohCE1jHfPx/xhU+y4G/D75ELlRJsSYAAAAASUVORK5CYII=",aR=function(){function t(){}return t.createDefault=function(){return{hasPermission:!1,lastUsedCameraId:null}},t}(),jRe=function(){function t(){this.data=aR.createDefault();var n=localStorage.getItem(t.LOCAL_STORAGE_KEY);n?this.data=JSON.parse(n):this.reset()}return t.prototype.hasCameraPermissions=function(){return this.data.hasPermission},t.prototype.getLastUsedCameraId=function(){return this.data.lastUsedCameraId},t.prototype.setHasPermission=function(n){this.data.hasPermission=n,this.flush()},t.prototype.setLastUsedCameraId=function(n){this.data.lastUsedCameraId=n,this.flush()},t.prototype.resetLastUsedCameraId=function(){this.data.lastUsedCameraId=null,this.flush()},t.prototype.reset=function(){this.data=aR.createDefault(),this.flush()},t.prototype.flush=function(){localStorage.setItem(t.LOCAL_STORAGE_KEY,JSON.stringify(this.data))},t.LOCAL_STORAGE_KEY="HTML5_QRCODE_DATA",t}(),SRe=function(){function t(){this.infoDiv=document.createElement("div")}return t.prototype.renderInto=function(n){this.infoDiv.style.position="absolute",this.infoDiv.style.top="10px",this.infoDiv.style.right="10px",this.infoDiv.style.zIndex="2",this.infoDiv.style.display="none",this.infoDiv.style.padding="5pt",this.infoDiv.style.border="1px solid #171717",this.infoDiv.style.fontSize="10pt",this.infoDiv.style.background="rgb(0 0 0 / 69%)",this.infoDiv.style.borderRadius="5px",this.infoDiv.style.textAlign="center",this.infoDiv.style.fontWeight="400",this.infoDiv.style.color="white",this.infoDiv.innerText=XD.poweredBy();var r=document.createElement("a");r.innerText="ScanApp",r.href="https://scanapp.org",r.target="new",r.style.color="white",this.infoDiv.appendChild(r);var s=document.createElement("br"),i=document.createElement("br");this.infoDiv.appendChild(s),this.infoDiv.appendChild(i);var o=document.createElement("a");o.innerText=XD.reportIssues(),o.href="https://github.com/mebjas/html5-qrcode/issues",o.target="new",o.style.color="white",this.infoDiv.appendChild(o),n.appendChild(this.infoDiv)},t.prototype.show=function(){this.infoDiv.style.display="block"},t.prototype.hide=function(){this.infoDiv.style.display="none"},t}(),CRe=function(){function t(n,r){this.isShowingInfoIcon=!0,this.onTapIn=n,this.onTapOut=r,this.infoIcon=document.createElement("img")}return t.prototype.renderInto=function(n){var r=this;this.infoIcon.alt="Info icon",this.infoIcon.src=sR,this.infoIcon.style.position="absolute",this.infoIcon.style.top="4px",this.infoIcon.style.right="4px",this.infoIcon.style.opacity="0.6",this.infoIcon.style.cursor="pointer",this.infoIcon.style.zIndex="2",this.infoIcon.style.width="16px",this.infoIcon.style.height="16px",this.infoIcon.onmouseover=function(s){return r.onHoverIn()},this.infoIcon.onmouseout=function(s){return r.onHoverOut()},this.infoIcon.onclick=function(s){return r.onClick()},n.appendChild(this.infoIcon)},t.prototype.onHoverIn=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="1")},t.prototype.onHoverOut=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="0.6")},t.prototype.onClick=function(){this.isShowingInfoIcon?(this.isShowingInfoIcon=!1,this.onTapIn(),this.infoIcon.src=NRe,this.infoIcon.style.opacity="1"):(this.isShowingInfoIcon=!0,this.onTapOut(),this.infoIcon.src=sR,this.infoIcon.style.opacity="0.6")},t}(),_Re=function(){function t(){var n=this;this.infoDiv=new SRe,this.infoIcon=new CRe(function(){n.infoDiv.show()},function(){n.infoDiv.hide()})}return t.prototype.renderInto=function(n){this.infoDiv.renderInto(n),this.infoIcon.renderInto(n)},t}(),ARe=function(t,n,r,s){function i(o){return o instanceof r?o:new r(function(l){l(o)})}return new(r||(r=Promise))(function(o,l){function c(h){try{u(s.next(h))}catch(m){l(m)}}function d(h){try{u(s.throw(h))}catch(m){l(m)}}function u(h){h.done?o(h.value):i(h.value).then(c,d)}u((s=s.apply(t,n||[])).next())})},ERe=function(t,n){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},s,i,o,l;return l={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function c(u){return function(h){return d([u,h])}}function d(u){if(s)throw new TypeError("Generator is already executing.");for(;l&&(l=0,u[0]&&(r=0)),r;)try{if(s=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){r.label=u[1];break}if(u[0]===6&&r.label<o[1]){r.label=o[1],o=u;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(u);break}o[2]&&r.ops.pop(),r.trys.pop();continue}u=n.call(t,r)}catch(h){u=[6,h],i=0}finally{s=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},iR=function(){function t(){}return t.hasPermissions=function(){return ARe(this,void 0,void 0,function(){var n,r,s,i;return ERe(this,function(o){switch(o.label){case 0:return[4,navigator.mediaDevices.enumerateDevices()];case 1:for(n=o.sent(),r=0,s=n;r<s.length;r++)if(i=s[r],i.kind==="videoinput"&&i.label)return[2,!0];return[2,!1]}})})},t}(),Wl=function(){function t(n){this.supportedScanTypes=this.validateAndReturnScanTypes(n)}return t.prototype.getDefaultScanType=function(){return this.supportedScanTypes[0]},t.prototype.hasMoreThanOneScanType=function(){return this.supportedScanTypes.length>1},t.prototype.isCameraScanRequired=function(){for(var n=0,r=this.supportedScanTypes;n<r.length;n++){var s=r[n];if(t.isCameraScanType(s))return!0}return!1},t.isCameraScanType=function(n){return n===Fc.SCAN_TYPE_CAMERA},t.isFileScanType=function(n){return n===Fc.SCAN_TYPE_FILE},t.prototype.validateAndReturnScanTypes=function(n){if(!n||n.length===0)return Ti.DEFAULT_SUPPORTED_SCAN_TYPE;var r=Ti.DEFAULT_SUPPORTED_SCAN_TYPE.length;if(n.length>r)throw"Max ".concat(r," values expected for ")+"supportedScanTypes";for(var s=0,i=n;s<i.length;s++){var o=i[s];if(!Ti.DEFAULT_SUPPORTED_SCAN_TYPE.includes(o))throw"Unsupported scan type ".concat(o)}return n},t}(),ka=function(){function t(){}return t.ALL_ELEMENT_CLASS="html5-qrcode-element",t.CAMERA_PERMISSION_BUTTON_ID="html5-qrcode-button-camera-permission",t.CAMERA_START_BUTTON_ID="html5-qrcode-button-camera-start",t.CAMERA_STOP_BUTTON_ID="html5-qrcode-button-camera-stop",t.TORCH_BUTTON_ID="html5-qrcode-button-torch",t.CAMERA_SELECTION_SELECT_ID="html5-qrcode-select-camera",t.FILE_SELECTION_BUTTON_ID="html5-qrcode-button-file-selection",t.ZOOM_SLIDER_ID="html5-qrcode-input-range-zoom",t.SCAN_TYPE_CHANGE_ANCHOR_ID="html5-qrcode-anchor-scan-type-change",t.TORCH_BUTTON_CLASS_TORCH_ON="html5-qrcode-button-torch-on",t.TORCH_BUTTON_CLASS_TORCH_OFF="html5-qrcode-button-torch-off",t}(),sl=function(){function t(){}return t.createElement=function(n,r){var s=document.createElement(n);return s.id=r,s.classList.add(ka.ALL_ELEMENT_CLASS),n==="button"&&s.setAttribute("type","button"),s},t}(),vG=function(t,n,r,s){function i(o){return o instanceof r?o:new r(function(l){l(o)})}return new(r||(r=Promise))(function(o,l){function c(h){try{u(s.next(h))}catch(m){l(m)}}function d(h){try{u(s.throw(h))}catch(m){l(m)}}function u(h){h.done?o(h.value):i(h.value).then(c,d)}u((s=s.apply(t,n||[])).next())})},bG=function(t,n){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},s,i,o,l;return l={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function c(u){return function(h){return d([u,h])}}function d(u){if(s)throw new TypeError("Generator is already executing.");for(;l&&(l=0,u[0]&&(r=0)),r;)try{if(s=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){r.label=u[1];break}if(u[0]===6&&r.label<o[1]){r.label=o[1],o=u;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(u);break}o[2]&&r.ops.pop(),r.trys.pop();continue}u=n.call(t,r)}catch(h){u=[6,h],i=0}finally{s=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},oR=function(){function t(n,r,s){this.isTorchOn=!1,this.torchCapability=n,this.buttonController=r,this.onTorchActionFailureCallback=s}return t.prototype.isTorchEnabled=function(){return this.isTorchOn},t.prototype.flipState=function(){return vG(this,void 0,void 0,function(){var n,r;return bG(this,function(s){switch(s.label){case 0:this.buttonController.disable(),n=!this.isTorchOn,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.torchCapability.apply(n)];case 2:return s.sent(),this.updateUiBasedOnLatestSettings(this.torchCapability.value(),n),[3,4];case 3:return r=s.sent(),this.propagateFailure(n,r),this.buttonController.enable(),[3,4];case 4:return[2]}})})},t.prototype.updateUiBasedOnLatestSettings=function(n,r){n===r?(this.buttonController.setText(r?dn.torchOffButton():dn.torchOnButton()),this.isTorchOn=r):this.propagateFailure(r),this.buttonController.enable()},t.prototype.propagateFailure=function(n,r){var s=n?dn.torchOnFailedMessage():dn.torchOffFailedMessage();r&&(s+="; Error = "+r),this.onTorchActionFailureCallback(s)},t.prototype.reset=function(){this.isTorchOn=!1},t}(),kRe=function(){function t(n,r){this.onTorchActionFailureCallback=r,this.torchButton=sl.createElement("button",ka.TORCH_BUTTON_ID),this.torchController=new oR(n,this,r)}return t.prototype.render=function(n,r){var s=this;this.torchButton.innerText=dn.torchOnButton(),this.torchButton.style.display=r.display,this.torchButton.style.marginLeft=r.marginLeft;var i=this;this.torchButton.addEventListener("click",function(o){return vG(s,void 0,void 0,function(){return bG(this,function(l){switch(l.label){case 0:return[4,i.torchController.flipState()];case 1:return l.sent(),i.torchController.isTorchEnabled()?(i.torchButton.classList.remove(ka.TORCH_BUTTON_CLASS_TORCH_OFF),i.torchButton.classList.add(ka.TORCH_BUTTON_CLASS_TORCH_ON)):(i.torchButton.classList.remove(ka.TORCH_BUTTON_CLASS_TORCH_ON),i.torchButton.classList.add(ka.TORCH_BUTTON_CLASS_TORCH_OFF)),[2]}})})}),n.appendChild(this.torchButton)},t.prototype.updateTorchCapability=function(n){this.torchController=new oR(n,this,this.onTorchActionFailureCallback)},t.prototype.getTorchButton=function(){return this.torchButton},t.prototype.hide=function(){this.torchButton.style.display="none"},t.prototype.show=function(){this.torchButton.style.display="inline-block"},t.prototype.disable=function(){this.torchButton.disabled=!0},t.prototype.enable=function(){this.torchButton.disabled=!1},t.prototype.setText=function(n){this.torchButton.innerText=n},t.prototype.reset=function(){this.torchButton.innerText=dn.torchOnButton(),this.torchController.reset()},t.create=function(n,r,s,i){var o=new t(r,i);return o.render(n,s),o},t}(),TRe=function(){function t(n,r,s){this.fileBasedScanRegion=this.createFileBasedScanRegion(),this.fileBasedScanRegion.style.display=r?"block":"none",n.appendChild(this.fileBasedScanRegion);var i=document.createElement("label");i.setAttribute("for",this.getFileScanInputId()),i.style.display="inline-block",this.fileBasedScanRegion.appendChild(i),this.fileSelectionButton=sl.createElement("button",ka.FILE_SELECTION_BUTTON_ID),this.setInitialValueToButton(),this.fileSelectionButton.addEventListener("click",function(c){i.click()}),i.append(this.fileSelectionButton),this.fileScanInput=sl.createElement("input",this.getFileScanInputId()),this.fileScanInput.type="file",this.fileScanInput.accept="image/*",this.fileScanInput.style.display="none",i.appendChild(this.fileScanInput);var o=this;this.fileScanInput.addEventListener("change",function(c){if(!(c==null||c.target==null)){var d=c.target;if(!(d.files&&d.files.length===0)){var u=d.files,h=u[0],m=h.name;o.setImageNameToButton(m),s(h)}}});var l=this.createDragAndDropMessage();this.fileBasedScanRegion.appendChild(l),this.fileBasedScanRegion.addEventListener("dragenter",function(c){o.fileBasedScanRegion.style.border=o.fileBasedScanRegionActiveBorder(),c.stopPropagation(),c.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragleave",function(c){o.fileBasedScanRegion.style.border=o.fileBasedScanRegionDefaultBorder(),c.stopPropagation(),c.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragover",function(c){o.fileBasedScanRegion.style.border=o.fileBasedScanRegionActiveBorder(),c.stopPropagation(),c.preventDefault()}),this.fileBasedScanRegion.addEventListener("drop",function(c){c.stopPropagation(),c.preventDefault(),o.fileBasedScanRegion.style.border=o.fileBasedScanRegionDefaultBorder();var d=c.dataTransfer;if(d){var u=d.files;if(!u||u.length===0)return;for(var h=!1,m=0;m<u.length;++m){var g=u.item(m);if(g){var y=/image.*/;if(g.type.match(y)){h=!0;var N=g.name;o.setImageNameToButton(N),s(g),l.innerText=dn.dragAndDropMessage();break}}}h||(l.innerText=dn.dragAndDropMessageOnlyImages())}})}return t.prototype.hide=function(){this.fileBasedScanRegion.style.display="none",this.fileScanInput.disabled=!0},t.prototype.show=function(){this.fileBasedScanRegion.style.display="block",this.fileScanInput.disabled=!1},t.prototype.isShowing=function(){return this.fileBasedScanRegion.style.display==="block"},t.prototype.resetValue=function(){this.fileScanInput.value="",this.setInitialValueToButton()},t.prototype.createFileBasedScanRegion=function(){var n=document.createElement("div");return n.style.textAlign="center",n.style.margin="auto",n.style.width="80%",n.style.maxWidth="600px",n.style.border=this.fileBasedScanRegionDefaultBorder(),n.style.padding="10px",n.style.marginBottom="10px",n},t.prototype.fileBasedScanRegionDefaultBorder=function(){return"6px dashed #ebebeb"},t.prototype.fileBasedScanRegionActiveBorder=function(){return"6px dashed rgb(153 151 151)"},t.prototype.createDragAndDropMessage=function(){var n=document.createElement("div");return n.innerText=dn.dragAndDropMessage(),n.style.fontWeight="400",n},t.prototype.setImageNameToButton=function(n){var r=20;if(n.length>r){var s=n.substring(0,8),i=n.length,o=n.substring(i-8,i);n="".concat(s,"....").concat(o)}var l=dn.fileSelectionChooseAnother()+" - "+n;this.fileSelectionButton.innerText=l},t.prototype.setInitialValueToButton=function(){var n=dn.fileSelectionChooseImage()+" - "+dn.fileSelectionNoImageSelected();this.fileSelectionButton.innerText=n},t.prototype.getFileScanInputId=function(){return"html5-qrcode-private-filescan-input"},t.create=function(n,r,s){var i=new t(n,r,s);return i},t}(),IRe=function(){function t(n){this.selectElement=sl.createElement("select",ka.CAMERA_SELECTION_SELECT_ID),this.cameras=n,this.options=[]}return t.prototype.render=function(n){var r=document.createElement("span");r.style.marginRight="10px";var s=this.cameras.length;if(s===0)throw new Error("No cameras found");if(s===1)r.style.display="none";else{var i=dn.selectCamera();r.innerText="".concat(i," (").concat(this.cameras.length,")  ")}for(var o=1,l=0,c=this.cameras;l<c.length;l++){var d=c[l],u=d.id,h=d.label==null?u:d.label;(!h||h==="")&&(h=[dn.anonymousCameraPrefix(),o++].join(" "));var m=document.createElement("option");m.value=u,m.innerText=h,this.options.push(m),this.selectElement.appendChild(m)}r.appendChild(this.selectElement),n.appendChild(r)},t.prototype.disable=function(){this.selectElement.disabled=!0},t.prototype.isDisabled=function(){return this.selectElement.disabled===!0},t.prototype.enable=function(){this.selectElement.disabled=!1},t.prototype.getValue=function(){return this.selectElement.value},t.prototype.hasValue=function(n){for(var r=0,s=this.options;r<s.length;r++){var i=s[r];if(i.value===n)return!0}return!1},t.prototype.setValue=function(n){if(!this.hasValue(n))throw new Error("".concat(n," is not present in the camera list."));this.selectElement.value=n},t.prototype.hasSingleItem=function(){return this.cameras.length===1},t.prototype.numCameras=function(){return this.cameras.length},t.create=function(n,r){var s=new t(r);return s.render(n),s},t}(),PRe=function(){function t(){this.onChangeCallback=null,this.zoomElementContainer=document.createElement("div"),this.rangeInput=sl.createElement("input",ka.ZOOM_SLIDER_ID),this.rangeInput.type="range",this.rangeText=document.createElement("span"),this.rangeInput.min="1",this.rangeInput.max="5",this.rangeInput.value="1",this.rangeInput.step="0.1"}return t.prototype.render=function(n,r){this.zoomElementContainer.style.display=r?"block":"none",this.zoomElementContainer.style.padding="5px 10px",this.zoomElementContainer.style.textAlign="center",n.appendChild(this.zoomElementContainer),this.rangeInput.style.display="inline-block",this.rangeInput.style.width="50%",this.rangeInput.style.height="5px",this.rangeInput.style.background="#d3d3d3",this.rangeInput.style.outline="none",this.rangeInput.style.opacity="0.7";var s=dn.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(s),this.rangeText.style.marginRight="10px";var i=this;this.rangeInput.addEventListener("input",function(){return i.onValueChange()}),this.rangeInput.addEventListener("change",function(){return i.onValueChange()}),this.zoomElementContainer.appendChild(this.rangeInput),this.zoomElementContainer.appendChild(this.rangeText)},t.prototype.onValueChange=function(){var n=dn.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(n),this.onChangeCallback&&this.onChangeCallback(parseFloat(this.rangeInput.value))},t.prototype.setValues=function(n,r,s,i){this.rangeInput.min=n.toString(),this.rangeInput.max=r.toString(),this.rangeInput.step=i.toString(),this.rangeInput.value=s.toString(),this.onValueChange()},t.prototype.show=function(){this.zoomElementContainer.style.display="block"},t.prototype.hide=function(){this.zoomElementContainer.style.display="none"},t.prototype.setOnCameraZoomValueChangeCallback=function(n){this.onChangeCallback=n},t.prototype.removeOnCameraZoomValueChangeCallback=function(){this.onChangeCallback=null},t.create=function(n,r){var s=new t;return s.render(n,r),s},t}(),Na;(function(t){t[t.STATUS_DEFAULT=0]="STATUS_DEFAULT",t[t.STATUS_SUCCESS=1]="STATUS_SUCCESS",t[t.STATUS_WARNING=2]="STATUS_WARNING",t[t.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(Na||(Na={}));function MRe(t){return{fps:t.fps,qrbox:t.qrbox,aspectRatio:t.aspectRatio,disableFlip:t.disableFlip,videoConstraints:t.videoConstraints}}function ORe(t,n){return{formatsToSupport:t.formatsToSupport,useBarCodeDetectorIfSupported:t.useBarCodeDetectorIfSupported,experimentalFeatures:t.experimentalFeatures,verbose:n}}var DRe=function(){function t(n,r,s){if(this.lastMatchFound=null,this.cameraScanImage=null,this.fileScanImage=null,this.fileSelectionUi=null,this.elementId=n,this.config=this.createConfig(r),this.verbose=s===!0,!document.getElementById(n))throw"HTML Element with id=".concat(n," not found");this.scanTypeSelector=new Wl(this.config.supportedScanTypes),this.currentScanType=this.scanTypeSelector.getDefaultScanType(),this.sectionSwapAllowed=!0,this.logger=new xG(this.verbose),this.persistedDataManager=new jRe,r.rememberLastUsedCamera!==!0&&this.persistedDataManager.reset()}return t.prototype.render=function(n,r){var s=this;this.lastMatchFound=null,this.qrCodeSuccessCallback=function(o,l){if(n)n(o,l);else{if(s.lastMatchFound===o)return;s.lastMatchFound=o,s.setHeaderMessage(dn.lastMatch(o),Na.STATUS_SUCCESS)}},this.qrCodeErrorCallback=function(o,l){r&&r(o,l)};var i=document.getElementById(this.elementId);if(!i)throw"HTML Element with id=".concat(this.elementId," not found");i.innerHTML="",this.createBasicLayout(i),this.html5Qrcode=new rR(this.getScanRegionId(),ORe(this.config,this.verbose))},t.prototype.pause=function(n){(co(n)||n!==!0)&&(n=!1),this.getHtml5QrcodeOrFail().pause(n)},t.prototype.resume=function(){this.getHtml5QrcodeOrFail().resume()},t.prototype.getState=function(){return this.getHtml5QrcodeOrFail().getState()},t.prototype.clear=function(){var n=this,r=function(){var s=document.getElementById(n.elementId);s&&(s.innerHTML="",n.resetBasicLayout(s))};return this.html5Qrcode?new Promise(function(s,i){if(!n.html5Qrcode){s();return}n.html5Qrcode.isScanning?n.html5Qrcode.stop().then(function(o){if(!n.html5Qrcode){s();return}n.html5Qrcode.clear(),r(),s()}).catch(function(o){n.verbose&&n.logger.logError("Unable to stop qrcode scanner",o),i(o)}):(n.html5Qrcode.clear(),r(),s())}):Promise.resolve()},t.prototype.getRunningTrackCapabilities=function(){return this.getHtml5QrcodeOrFail().getRunningTrackCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getHtml5QrcodeOrFail().getRunningTrackSettings()},t.prototype.applyVideoConstraints=function(n){return this.getHtml5QrcodeOrFail().applyVideoConstraints(n)},t.prototype.getHtml5QrcodeOrFail=function(){if(!this.html5Qrcode)throw"Code scanner not initialized.";return this.html5Qrcode},t.prototype.createConfig=function(n){return n?(n.fps||(n.fps=Ti.SCAN_DEFAULT_FPS),n.rememberLastUsedCamera!==!Ti.DEFAULT_REMEMBER_LAST_CAMERA_USED&&(n.rememberLastUsedCamera=Ti.DEFAULT_REMEMBER_LAST_CAMERA_USED),n.supportedScanTypes||(n.supportedScanTypes=Ti.DEFAULT_SUPPORTED_SCAN_TYPE),n):{fps:Ti.SCAN_DEFAULT_FPS,rememberLastUsedCamera:Ti.DEFAULT_REMEMBER_LAST_CAMERA_USED,supportedScanTypes:Ti.DEFAULT_SUPPORTED_SCAN_TYPE}},t.prototype.createBasicLayout=function(n){n.style.position="relative",n.style.padding="0px",n.style.border="1px solid silver",this.createHeader(n);var r=document.createElement("div"),s=this.getScanRegionId();r.id=s,r.style.width="100%",r.style.minHeight="100px",r.style.textAlign="center",n.appendChild(r),Wl.isCameraScanType(this.currentScanType)?this.insertCameraScanImageToScanRegion():this.insertFileScanImageToScanRegion();var i=document.createElement("div"),o=this.getDashboardId();i.id=o,i.style.width="100%",n.appendChild(i),this.setupInitialDashboard(i)},t.prototype.resetBasicLayout=function(n){n.style.border="none"},t.prototype.setupInitialDashboard=function(n){this.createSection(n),this.createSectionControlPanel(),this.scanTypeSelector.hasMoreThanOneScanType()&&this.createSectionSwap()},t.prototype.createHeader=function(n){var r=document.createElement("div");r.style.textAlign="left",r.style.margin="0px",n.appendChild(r);var s=new _Re;s.renderInto(r);var i=document.createElement("div");i.id=this.getHeaderMessageContainerId(),i.style.display="none",i.style.textAlign="center",i.style.fontSize="14px",i.style.padding="2px 10px",i.style.margin="4px",i.style.borderTop="1px solid #f6f6f6",r.appendChild(i)},t.prototype.createSection=function(n){var r=document.createElement("div");r.id=this.getDashboardSectionId(),r.style.width="100%",r.style.padding="10px 0px 10px 0px",r.style.textAlign="left",n.appendChild(r)},t.prototype.createCameraListUi=function(n,r,s){var i=this;i.showHideScanTypeSwapLink(!1),i.setHeaderMessage(dn.cameraPermissionRequesting());var o=function(){s||i.createPermissionButton(n,r)};rR.getCameras().then(function(l){i.persistedDataManager.setHasPermission(!0),i.showHideScanTypeSwapLink(!0),i.resetHeaderMessage(),l&&l.length>0?(n.removeChild(r),i.renderCameraSelection(l)):(i.setHeaderMessage(dn.noCameraFound(),Na.STATUS_WARNING),o())}).catch(function(l){i.persistedDataManager.setHasPermission(!1),s?s.disabled=!1:o(),i.setHeaderMessage(l,Na.STATUS_WARNING),i.showHideScanTypeSwapLink(!0)})},t.prototype.createPermissionButton=function(n,r){var s=this,i=sl.createElement("button",this.getCameraPermissionButtonId());i.innerText=dn.cameraPermissionTitle(),i.addEventListener("click",function(){i.disabled=!0,s.createCameraListUi(n,r,i)}),r.appendChild(i)},t.prototype.createPermissionsUi=function(n,r){var s=this;if(Wl.isCameraScanType(this.currentScanType)&&this.persistedDataManager.hasCameraPermissions()){iR.hasPermissions().then(function(i){i?s.createCameraListUi(n,r):(s.persistedDataManager.setHasPermission(!1),s.createPermissionButton(n,r))}).catch(function(i){s.persistedDataManager.setHasPermission(!1),s.createPermissionButton(n,r)});return}this.createPermissionButton(n,r)},t.prototype.createSectionControlPanel=function(){var n=document.getElementById(this.getDashboardSectionId()),r=document.createElement("div");n.appendChild(r);var s=document.createElement("div");s.id=this.getDashboardSectionCameraScanRegionId(),s.style.display=Wl.isCameraScanType(this.currentScanType)?"block":"none",r.appendChild(s);var i=document.createElement("div");i.style.textAlign="center",s.appendChild(i),this.scanTypeSelector.isCameraScanRequired()&&this.createPermissionsUi(s,i),this.renderFileScanUi(r)},t.prototype.renderFileScanUi=function(n){var r=Wl.isFileScanType(this.currentScanType),s=this,i=function(o){if(!s.html5Qrcode)throw"html5Qrcode not defined";Wl.isFileScanType(s.currentScanType)&&(s.setHeaderMessage(dn.loadingImage()),s.html5Qrcode.scanFileV2(o,!0).then(function(l){s.resetHeaderMessage(),s.qrCodeSuccessCallback(l.decodedText,l)}).catch(function(l){s.setHeaderMessage(l,Na.STATUS_WARNING),s.qrCodeErrorCallback(l,pG.createFrom(l))}))};this.fileSelectionUi=TRe.create(n,r,i)},t.prototype.renderCameraSelection=function(n){var r=this,s=this,i=document.getElementById(this.getDashboardSectionCameraScanRegionId());i.style.textAlign="center";var o=PRe.create(i,!1),l=function(j){var S=j.zoomFeature();if(S.isSupported()){o.setOnCameraZoomValueChangeCallback(function(A){S.apply(A)});var _=1;r.config.defaultZoomValueIfSupported&&(_=r.config.defaultZoomValueIfSupported),_=JDe(_,S.min(),S.max()),o.setValues(S.min(),S.max(),_,S.step()),o.show()}},c=IRe.create(i,n),d=document.createElement("span"),u=sl.createElement("button",ka.CAMERA_START_BUTTON_ID);u.innerText=dn.scanButtonStartScanningText(),d.appendChild(u);var h=sl.createElement("button",ka.CAMERA_STOP_BUTTON_ID);h.innerText=dn.scanButtonStopScanningText(),h.style.display="none",h.disabled=!0,d.appendChild(h);var m,g=function(j){if(!j.torchFeature().isSupported()){m&&m.hide();return}m?m.updateTorchCapability(j.torchFeature()):m=kRe.create(d,j.torchFeature(),{display:"none",marginLeft:"5px"},function(S){s.setHeaderMessage(S,Na.STATUS_WARNING)}),m.show()};i.appendChild(d);var y=function(j){j||(u.style.display="none"),u.innerText=dn.scanButtonStartScanningText(),u.style.opacity="1",u.disabled=!1,j&&(u.style.display="inline-block")};if(u.addEventListener("click",function(j){u.innerText=dn.scanButtonScanningStarting(),c.disable(),u.disabled=!0,u.style.opacity="0.5",r.scanTypeSelector.hasMoreThanOneScanType()&&s.showHideScanTypeSwapLink(!1),s.resetHeaderMessage();var S=c.getValue();s.persistedDataManager.setLastUsedCameraId(S),s.html5Qrcode.start(S,MRe(s.config),s.qrCodeSuccessCallback,s.qrCodeErrorCallback).then(function(_){h.disabled=!1,h.style.display="inline-block",y(!1);var A=s.html5Qrcode.getRunningTrackCameraCapabilities();r.config.showTorchButtonIfSupported===!0&&g(A),r.config.showZoomSliderIfSupported===!0&&l(A)}).catch(function(_){s.showHideScanTypeSwapLink(!0),c.enable(),y(!0),s.setHeaderMessage(_,Na.STATUS_WARNING)})}),c.hasSingleItem()&&u.click(),h.addEventListener("click",function(j){if(!s.html5Qrcode)throw"html5Qrcode not defined";h.disabled=!0,s.html5Qrcode.stop().then(function(S){r.scanTypeSelector.hasMoreThanOneScanType()&&s.showHideScanTypeSwapLink(!0),c.enable(),u.disabled=!1,h.style.display="none",u.style.display="inline-block",m&&(m.reset(),m.hide()),o.removeOnCameraZoomValueChangeCallback(),o.hide(),s.insertCameraScanImageToScanRegion()}).catch(function(S){h.disabled=!1,s.setHeaderMessage(S,Na.STATUS_WARNING)})}),s.persistedDataManager.getLastUsedCameraId()){var N=s.persistedDataManager.getLastUsedCameraId();c.hasValue(N)?(c.setValue(N),u.click()):s.persistedDataManager.resetLastUsedCameraId()}},t.prototype.createSectionSwap=function(){var n=this,r=dn.textIfCameraScanSelected(),s=dn.textIfFileScanSelected(),i=document.getElementById(this.getDashboardSectionId()),o=document.createElement("div");o.style.textAlign="center";var l=sl.createElement("span",this.getDashboardSectionSwapLinkId());l.style.textDecoration="underline",l.style.cursor="pointer",l.innerText=Wl.isCameraScanType(this.currentScanType)?r:s,l.addEventListener("click",function(){if(!n.sectionSwapAllowed){n.verbose&&n.logger.logError("Section swap called when not allowed");return}n.resetHeaderMessage(),n.fileSelectionUi.resetValue(),n.sectionSwapAllowed=!1,Wl.isCameraScanType(n.currentScanType)?(n.clearScanRegion(),n.getCameraScanRegion().style.display="none",n.fileSelectionUi.show(),l.innerText=s,n.currentScanType=Fc.SCAN_TYPE_FILE,n.insertFileScanImageToScanRegion()):(n.clearScanRegion(),n.getCameraScanRegion().style.display="block",n.fileSelectionUi.hide(),l.innerText=r,n.currentScanType=Fc.SCAN_TYPE_CAMERA,n.insertCameraScanImageToScanRegion(),n.startCameraScanIfPermissionExistsOnSwap()),n.sectionSwapAllowed=!0}),o.appendChild(l),i.appendChild(o)},t.prototype.startCameraScanIfPermissionExistsOnSwap=function(){var n=this,r=this;if(this.persistedDataManager.hasCameraPermissions()){iR.hasPermissions().then(function(s){if(s){var i=document.getElementById(r.getCameraPermissionButtonId());if(!i)throw n.logger.logError("Permission button not found, fail;"),"Permission button not found";i.click()}else r.persistedDataManager.setHasPermission(!1)}).catch(function(s){r.persistedDataManager.setHasPermission(!1)});return}},t.prototype.resetHeaderMessage=function(){var n=document.getElementById(this.getHeaderMessageContainerId());n.style.display="none"},t.prototype.setHeaderMessage=function(n,r){r||(r=Na.STATUS_DEFAULT);var s=this.getHeaderMessageDiv();switch(s.innerText=n,s.style.display="block",r){case Na.STATUS_SUCCESS:s.style.background="rgba(106, 175, 80, 0.26)",s.style.color="#477735";break;case Na.STATUS_WARNING:s.style.background="rgba(203, 36, 49, 0.14)",s.style.color="#cb2431";break;case Na.STATUS_DEFAULT:default:s.style.background="rgba(0, 0, 0, 0)",s.style.color="rgb(17, 17, 17)";break}},t.prototype.showHideScanTypeSwapLink=function(n){this.scanTypeSelector.hasMoreThanOneScanType()&&(n!==!0&&(n=!1),this.sectionSwapAllowed=n,this.getDashboardSectionSwapLink().style.display=n?"inline-block":"none")},t.prototype.insertCameraScanImageToScanRegion=function(){var n=this,r=document.getElementById(this.getScanRegionId());if(this.cameraScanImage){r.innerHTML="<br>",r.appendChild(this.cameraScanImage);return}this.cameraScanImage=new Image,this.cameraScanImage.onload=function(s){r.innerHTML="<br>",r.appendChild(n.cameraScanImage)},this.cameraScanImage.width=64,this.cameraScanImage.style.opacity="0.8",this.cameraScanImage.src=bRe,this.cameraScanImage.alt=dn.cameraScanAltText()},t.prototype.insertFileScanImageToScanRegion=function(){var n=this,r=document.getElementById(this.getScanRegionId());if(this.fileScanImage){r.innerHTML="<br>",r.appendChild(this.fileScanImage);return}this.fileScanImage=new Image,this.fileScanImage.onload=function(s){r.innerHTML="<br>",r.appendChild(n.fileScanImage)},this.fileScanImage.width=64,this.fileScanImage.style.opacity="0.8",this.fileScanImage.src=wRe,this.fileScanImage.alt=dn.fileScanAltText()},t.prototype.clearScanRegion=function(){var n=document.getElementById(this.getScanRegionId());n.innerHTML=""},t.prototype.getDashboardSectionId=function(){return"".concat(this.elementId,"__dashboard_section")},t.prototype.getDashboardSectionCameraScanRegionId=function(){return"".concat(this.elementId,"__dashboard_section_csr")},t.prototype.getDashboardSectionSwapLinkId=function(){return ka.SCAN_TYPE_CHANGE_ANCHOR_ID},t.prototype.getScanRegionId=function(){return"".concat(this.elementId,"__scan_region")},t.prototype.getDashboardId=function(){return"".concat(this.elementId,"__dashboard")},t.prototype.getHeaderMessageContainerId=function(){return"".concat(this.elementId,"__header_message")},t.prototype.getCameraPermissionButtonId=function(){return ka.CAMERA_PERMISSION_BUTTON_ID},t.prototype.getCameraScanRegion=function(){return document.getElementById(this.getDashboardSectionCameraScanRegionId())},t.prototype.getDashboardSectionSwapLink=function(){return document.getElementById(this.getDashboardSectionSwapLinkId())},t.prototype.getHeaderMessageDiv=function(){return document.getElementById(this.getHeaderMessageContainerId())},t}();function RRe(){const[t,n]=b.useState(""),[r,s]=b.useState(!1),[i,o]=b.useState(null),[l,c]=b.useState(""),[d,u]=b.useState(null),[h,m]=b.useState(!1),g=b.useRef(null),y=b.useCallback(async k=>{if(!k){u(null);return}try{const T=await te.get(`/inventory/items/${k.id}/qr`,{responseType:"blob"}),P=URL.createObjectURL(T.data);u(M=>(M&&URL.revokeObjectURL(M),P))}catch(T){console.error(T),u(null),fe.error("Unable to load QR image")}},[]),N=b.useCallback(async k=>{var P,M;const T=(k||"").trim();if(c(""),o(null),u(null),!T){c("Please scan or enter a QR number.");return}try{s(!0);const O=await sde(T);o(O.data),await y(O.data)}catch(O){const D=((M=(P=O==null?void 0:O.response)==null?void 0:P.data)==null?void 0:M.detail)||(O==null?void 0:O.message)||"No medicine found for this QR";c(D),fe.error(D)}finally{s(!1)}},[y]),j=b.useCallback(async k=>{k.preventDefault(),await N(t)},[t,N]),S=b.useCallback(async k=>{n(k),fe.success(`QR scanned: ${k}`),m(!1),await N(k)},[N]),_=b.useCallback(()=>{},[]);b.useEffect(()=>{if(!h){g.current&&(g.current.clear().catch(()=>{}),g.current=null);return}const k=new DRe("qr-reader",{fps:10,qrbox:250},!1);return g.current=k,k.render(S,_),()=>{g.current&&(g.current.clear().catch(()=>{}),g.current=null)}},[h,S,_]);const A=b.useCallback(async()=>{if(i)try{const T=(await te.get(`/inventory/items/${i.id}/qr`,{responseType:"blob"})).data,P=URL.createObjectURL(T),M=document.createElement("a");M.href=P,M.download=`${i.code||"medicine"}_qr.png`,document.body.appendChild(M),M.click(),M.remove(),URL.revokeObjectURL(P)}catch(k){const T=(k==null?void 0:k.message)||"Unable to download QR image";fe.error(T)}},[i]);return b.useEffect(()=>()=>{d&&URL.revokeObjectURL(d)},[d]),a.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-4 py-6 lg:px-8",children:a.jsxs("div",{className:"mx-auto flex max-w-5xl flex-col gap-6",children:[a.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"flex items-center gap-2 text-2xl font-semibold tracking-tight text-slate-900",children:[a.jsx(Yw,{className:"h-6 w-6 text-slate-700"}),"Medicine QR Lookup"]}),a.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Scan medicine QR code with camera / scanner or enter QR number to instantly fetch medicine details."})]}),a.jsxs(Ge,{className:"flex items-center gap-1 rounded-full bg-slate-900 px-3 py-1 text-xs font-medium text-white",children:[a.jsx(b1,{className:"h-3 w-3"}),"Live QR search"]})]}),a.jsxs(Re,{className:"rounded-2xl border-slate-200 shadow-sm",children:[a.jsxs(Ye,{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{children:[a.jsx(Ze,{className:"text-base font-semibold text-slate-900",children:"Scan or Enter QR Number"}),a.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Keep the cursor inside the QR box and scan with your scanner or use the camera scanner below."})]}),a.jsx(Te,{type:"button",variant:h?"outline":"default",size:"sm",onClick:()=>m(k=>!k),className:"inline-flex items-center gap-2",children:h?a.jsxs(a.Fragment,{children:[a.jsx(gee,{className:"h-4 w-4"}),"Stop Camera"]}):a.jsxs(a.Fragment,{children:[a.jsx(P5,{className:"h-4 w-4"}),"Use Camera Scanner"]})})]}),a.jsxs(Be,{className:"space-y-4",children:[a.jsxs("form",{onSubmit:j,className:"space-y-3",children:[a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx("label",{className:"text-xs font-medium text-slate-600",children:"QR Number"}),a.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(Yw,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),a.jsx(Ne,{autoFocus:!0,value:t,onChange:k=>n(k.target.value),placeholder:"e.g., MED-000123 or scan with your QR scanner...",className:"pl-9 text-sm"})]}),a.jsx(Te,{type:"submit",className:"w-full sm:w-auto",disabled:r,children:r?a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx(dr,{className:"h-4 w-4 animate-spin"}),"Searching..."]}):a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx(LRe,{}),"Search"]})})]})]}),a.jsxs("div",{className:"flex items-start gap-2 text-xs text-slate-500",children:[a.jsx(yp,{className:"mt-0.5 h-3 w-3"}),a.jsxs("p",{children:["For USB QR scanners: focus the box and scan. Most scanners type the code and press",a.jsx("span",{className:"mx-1 rounded bg-slate-100 px-1 py-0.5 font-semibold",children:"Enter"}),"automatically."]})]})]}),h&&a.jsxs("div",{className:"mt-3 rounded-2xl border border-dashed border-slate-200 bg-slate-100/60 px-3 py-3",children:[a.jsxs("p",{className:"mb-2 flex items-center gap-2 text-xs text-slate-600",children:[a.jsx(P5,{className:"h-3 w-3"}),"Point your medicine QR code at the camera. Once decoded, the medicine will load automatically."]}),a.jsx("div",{id:"qr-reader",className:"h-[280px] w-full overflow-hidden rounded-xl bg-black/90"})]}),l&&a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-red-100 bg-red-50 px-3 py-2 text-xs text-red-700",children:[a.jsx(yp,{className:"h-3 w-3"}),l]})]})]}),i&&a.jsxs(Re,{className:"rounded-2xl border-slate-200 shadow-sm",children:[a.jsxs(Ye,{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs(Ze,{className:"flex items-center gap-2 text-lg",children:[a.jsx(gs,{className:"h-5 w-5 text-slate-700"}),a.jsx("span",{children:i.name})]}),a.jsxs("p",{className:"text-xs text-slate-500",children:["Code:"," ",a.jsx("span",{className:"font-mono text-slate-700",children:i.code}),i.qr_number&&a.jsxs(a.Fragment,{children:["  ","QR:"," ",a.jsx("span",{className:"font-mono text-slate-700",children:i.qr_number})]})]}),i.generic_name&&a.jsxs("p",{className:"text-xs text-slate-500",children:["Generic: ",i.generic_name]})]}),d&&a.jsxs("div",{className:"flex flex-col items-center gap-2",children:[a.jsx("div",{className:"rounded-xl border border-slate-200 bg-white p-2",children:a.jsx("img",{src:d,alt:`QR for ${i.name}`,className:"h-28 w-28 object-contain"})}),a.jsxs(Te,{type:"button",variant:"outline",size:"sm",className:"text-xs",onClick:A,children:[a.jsx(Yw,{className:"mr-1 h-3 w-3"}),"Download QR"]})]})]}),a.jsxs(Be,{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[a.jsx(qo,{label:"FORM / STRENGTH",value:`${i.form||"-"}${i.strength?`  ${i.strength}`:""}`}),a.jsx(qo,{label:"PACK",value:`${i.pack_size||"-"} ${i.unit||""}`}),a.jsx(qo,{label:"MANUFACTURER",value:i.manufacturer||"-"}),a.jsx(qo,{label:"THERAPEUTIC CLASS",value:i.class_name||"-"}),a.jsx(qo,{label:"ATC CODE",value:i.atc_code||"-"}),a.jsx(qo,{label:"HSN CODE",value:i.hsn_code||"-"}),a.jsx(qo,{label:"MRP / PRICE",value:`${i.default_mrp||0} MRP  ${i.default_price||0} Price`}),a.jsx(qo,{label:"TAX %",value:`${i.default_tax_percent||0}%`}),a.jsx(qo,{label:"REORDER / MAX LEVEL",value:`${i.reorder_level||0} / ${i.max_level||0}`})]})]})]})})}function qo({label:t,value:n}){return a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2.5",children:[a.jsx("p",{className:"text-[11px] font-medium uppercase tracking-wide text-slate-500",children:t}),a.jsx("p",{className:"mt-1 truncate text-sm text-slate-800",title:n,children:n||"-"})]})}function LRe(){return a.jsx(b1,{className:"h-4 w-4"})}function BRe(){const[t,n]=b.useState(""),[r,s]=b.useState(!1),[i,o]=b.useState(null),[l,c]=b.useState(""),[d,u]=b.useState(!1);b.useEffect(()=>()=>{l&&URL.revokeObjectURL(l)},[l]);const h=async()=>{const N=t.trim();if(!N){fe.error("Please enter or scan a barcode number");return}s(!0),o(null),c("");try{const S=(await ade(N)).data;o(S),await m(S.id)}catch(j){console.error("Failed to lookup item by barcode",j)}finally{s(!1)}},m=async N=>{u(!0);try{const j=await iP(N),S=URL.createObjectURL(j.data);c(S)}catch(j){console.error("Failed to fetch barcode image",j)}finally{u(!1)}},g=N=>{N.key==="Enter"&&(N.preventDefault(),h())},y=async()=>{if(i)try{const N=await iP(i.id),j=new Blob([N.data],{type:"image/png"}),S=URL.createObjectURL(j),_=document.createElement("a");_.href=S,_.download=`${i.code||"medicine"}_barcode.png`,document.body.appendChild(_),_.click(),_.remove(),URL.revokeObjectURL(S)}catch(N){console.error("Failed to download barcode image",N)}};return a.jsxs("div",{className:"p-4 md:p-6 max-w-6xl mx-auto space-y-4 md:space-y-6",children:[a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsx(Ye,{className:"pb-3",children:a.jsxs(Ze,{className:"flex items-center gap-2 text-slate-900",children:[a.jsx(O5,{className:"w-5 h-5"}),a.jsx("span",{children:"Medicine Barcode Lookup"}),a.jsx(Ge,{variant:"outline",className:"ml-2 text-xs",children:"Pharmacy Inventory"})]})}),a.jsxs(Be,{className:"space-y-3",children:[a.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[a.jsxs("div",{className:"flex-1 flex items-center gap-2 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2.5",children:[a.jsx(O5,{className:"w-4 h-4 text-slate-500 shrink-0"}),a.jsx(Ne,{value:t,onChange:N=>n(N.target.value),onKeyDown:g,placeholder:"e.g. MD_1001",className:"border-0 bg-transparent shadow-none focus-visible:ring-0 text-base",autoFocus:!0})]}),a.jsxs(Te,{onClick:h,className:"shrink-0 bg-slate-900 text-white rounded-2xl px-5",disabled:r,children:[a.jsx(ur,{className:"w-4 h-4 mr-2"}),r?"Searching...":"Search"]})]}),a.jsxs("p",{className:"text-xs md:text-sm text-slate-500 flex items-center gap-1.5",children:[a.jsx(Bi,{className:"w-3.5 h-3.5"}),"Keep the cursor inside the barcode box and scan with your barcode / QR scanner. Most scanners behave like a keyboard and press",a.jsx("span",{className:"inline-flex items-center rounded-md border border-slate-200 px-1.5 py-0.5 text-[11px] font-medium",children:"Enter"}),"automatically."]})]})]}),r&&a.jsx(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:a.jsxs(Be,{className:"p-4 md:p-6 space-y-4",children:[a.jsx(Xe,{className:"h-6 w-2/3"}),a.jsx(Xe,{className:"h-4 w-1/3"}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsx(Xe,{className:"h-20"}),a.jsx(Xe,{className:"h-20"}),a.jsx(Xe,{className:"h-20"})]})]})}),!r&&i&&a.jsx(Re,{className:"rounded-3xl border-slate-200 shadow-sm overflow-hidden",children:a.jsxs(Be,{className:"p-4 md:p-6 space-y-4",children:[a.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:gap-8",children:[a.jsxs("div",{className:"flex-1 space-y-1.5",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-slate-100",children:a.jsx(gs,{className:"w-4 h-4 text-slate-600"})}),a.jsx("h2",{className:"text-xl md:text-2xl font-semibold text-slate-900",children:i.name})]}),a.jsxs("div",{className:"text-sm text-slate-500 space-x-2",children:[a.jsxs("span",{children:[a.jsx("span",{className:"font-medium text-slate-600",children:"Code:"})," ",i.code]}),a.jsx("span",{className:"text-slate-300",children:""}),a.jsxs("span",{children:[a.jsx("span",{className:"font-medium text-slate-600",children:"Barcode:"})," ",i.qr_number]})]}),i.generic_name&&a.jsxs("p",{className:"text-sm text-slate-600",children:[a.jsx("span",{className:"font-medium",children:"Generic:"})," ",i.generic_name]})]}),a.jsxs("div",{className:"w-full md:w-64 lg:w-72 flex flex-col items-center gap-3",children:[a.jsxs("div",{className:"w-full h-32 md:h-36 rounded-2xl border border-dashed border-slate-200 bg-slate-50 flex items-center justify-center",children:[d&&a.jsx(Xe,{className:"w-40 h-20 rounded-md"}),!d&&l&&a.jsx("img",{src:l,alt:`Barcode for ${i.name}`,className:"max-h-full max-w-full object-contain"}),!d&&!l&&a.jsx("span",{className:"text-xs text-slate-400",children:"No barcode image"})]}),a.jsxs(Te,{type:"button",variant:"outline",className:"w-full rounded-2xl",onClick:y,children:[a.jsx($d,{className:"w-4 h-4 mr-2"}),"Download Barcode"]})]})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-3 lg:grid-cols-4 mt-3",children:[a.jsx(ql,{label:"Form / Strength",icon:a.jsx(gs,{className:"w-4 h-4"}),value:`${i.form||"-"} ${i.strength?` ${i.strength}`:""}`}),a.jsx(ql,{label:"Pack",icon:a.jsx(vL,{className:"w-4 h-4"}),value:`${i.pack_size||1} ${i.unit||"unit"}`}),a.jsx(ql,{label:"Manufacturer",icon:a.jsx(f0,{className:"w-4 h-4"}),value:i.manufacturer||""}),a.jsx(ql,{label:"Therapeutic class",icon:a.jsx(f0,{className:"w-4 h-4"}),value:i.class_name||""}),a.jsx(ql,{label:"ATC code",icon:a.jsx(f0,{className:"w-4 h-4"}),value:i.atc_code||""}),a.jsx(ql,{label:"HSN code",icon:a.jsx(f0,{className:"w-4 h-4"}),value:i.hsn_code||""}),a.jsx(ql,{label:"MRP / Price",icon:a.jsx(ho,{className:"w-4 h-4"}),value:`${Number(i.default_mrp||0).toFixed(2)} MRP  ${Number(i.default_price||0).toFixed(2)} Price`}),a.jsx(ql,{label:"Reorder / Max level",icon:a.jsx(Bi,{className:"w-4 h-4"}),value:`${Number(i.reorder_level||0).toFixed(2)} / ${Number(i.max_level||0).toFixed(2)}`})]})]})})]})}function ql({label:t,icon:n,value:r}){return a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-4 py-3 flex flex-col gap-1",children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-slate-500 uppercase tracking-wide",children:[a.jsx("span",{className:"inline-flex h-5 w-5 items-center justify-center rounded-full bg-slate-100 text-slate-600",children:n}),t]}),a.jsx("div",{className:"text-sm text-slate-800 truncate",title:String(r),children:r||""})]})}function FRe(t={}){return te.get("/pharmacy/rx",{params:t})}function wG(t){return te.get(`/pharmacy/prescriptions/${t}`)}function $Re(t){return te.post("/pharmacy/prescriptions",t)}function zRe(t,n){return te.post(`/pharmacy/prescriptions/${t}/dispense`,n)}function URe(t={}){return te.get("/pharmacy/rx-queue",{params:t})}const N2=[{value:"OPD",label:"OPD"},{value:"IPD",label:"IPD"},{value:"OT",label:"OT"},{value:"COUNTER",label:"Counter"}],VRe=[{value:"ROUTINE",label:"Routine"},{value:"STAT",label:"STAT / Urgent"},{value:"PRN",label:"PRN / As needed"}];function NG(){const t=new Date,n=t.getTimezoneOffset();return new Date(t.getTime()-n*60*1e3).toISOString().slice(0,16)}const j2={type:"OPD",priority:"ROUTINE",datetime:NG(),patient:null,doctorId:"",visitNo:"",admissionNo:"",otCaseNo:"",notes:""},sg={item:null,item_name:"",strength:"",route:"PO",dose:"",frequency:"",duration_days:"",total_qty:"",instructions:"",is_prn:!1,is_stat:!1,requested_qty:""};function HRe(){var ft,Ie,qe;const[t,n]=b.useState("list"),[r,s]=b.useState("ALL"),[i,o]=b.useState("ALL"),[l,c]=b.useState(""),[d,u]=b.useState(!1),[h,m]=b.useState([]),[g,y]=b.useState(null),[N,j]=b.useState(j2),[S,_]=b.useState([]),[A,k]=b.useState(sg),[T,P]=b.useState(!1),[M,O]=b.useState(""),[D,L]=b.useState([]),[$,V]=b.useState(!1),[F,Q]=b.useState(!1),[U,z]=b.useState([]),[q,K]=b.useState(!1),[X,J]=b.useState(""),[ne,Se]=b.useState([]),[de,ye]=b.useState(!1),[be,xe]=b.useState(!1);b.useEffect(()=>{(async()=>{var se;try{K(!0);const le=await UA(),De=((se=le==null?void 0:le.data)==null?void 0:se.doctors)||[];z(De)}catch{}finally{K(!1)}})()},[]),b.useEffect(()=>{_e()},[r,i]);async function _e(){try{u(!0);const se={};r!=="ALL"&&(se.type=r),i!=="ALL"&&(se.status=i),l!=null&&l.trim()&&(se.q=l.trim()),se.limit=100;const le=await FRe(se);m((le==null?void 0:le.data)||[])}catch{}finally{u(!1)}}b.useEffect(()=>{if(!M||M.trim().length<2){L([]);return}let se=!1;return(async()=>{var le;try{V(!0);const De=await kq(M.trim());if(se)return;L(((le=De==null?void 0:De.data)==null?void 0:le.items)||(De==null?void 0:De.data)||[]),Q(!0)}catch{}finally{se||V(!1)}})(),()=>{se=!0}},[M]);function we(se){j(le=>({...le,patient:se})),O(`${se.uhid?`${se.uhid}  `:""}${se.first_name||""} ${se.last_name||""}`.trim()),Q(!1)}b.useEffect(()=>{if(!X||X.trim().length<2){Se([]);return}let se=!1;return(async()=>{var le;try{ye(!0);const De=await Cv({q:X.trim(),kind:"MEDICINE",limit:15});if(se)return;const Nt=((le=De==null?void 0:De.data)==null?void 0:le.items)||(De==null?void 0:De.data)||[];Se(Nt),xe(!0)}catch{}finally{se||ye(!1)}})(),()=>{se=!0}},[X]);function Oe(se){k(le=>({...le,item:se,item_name:se.name||se.item_name||""})),J(se.name||se.item_name||""),xe(!1)}function ae(){j({...j2,type:N.type||"OPD"}),_([]),k(sg),O("")}function ie(se){const le=se;j(De=>({...j2,type:le,datetime:NG()})),_([]),k(sg),O(""),y(null),n("new")}function pe(se){const le=Number(se.duration_days||0),De=(se.frequency||"").trim();if(!le||!De)return"";const sn=De.split("-").map(Yt=>Number(Yt||0)).reduce((Yt,Pt)=>Yt+(Number.isFinite(Pt)?Pt:0),0);return sn?String(sn*le):""}function re(){if(!A.item&&!A.item_name){fe.error("Select a medicine first");return}const se=pe(A),le=A.total_qty||se;if(!le){fe.error("Enter Total Qty or proper Frequency + Days");return}const De={...A,total_qty:le,requested_qty:A.requested_qty||le};_(Nt=>[...Nt,De]),k(sg),J(""),xe(!1)}function We(se){_(le=>le.filter((De,Nt)=>Nt!==se))}async function Je(){var le;if(!N.patient&&N.type!=="COUNTER"){fe.error("Select a patient");return}if(!N.doctorId&&N.type!=="COUNTER"){fe.error("Select a doctor");return}if(!S.length){fe.error("Add at least one medicine");return}const se={type:N.type,priority:N.priority,rx_datetime:N.datetime,patient_id:((le=N.patient)==null?void 0:le.id)||null,doctor_user_id:N.doctorId||null,visit_id:N.type==="OPD"&&N.visitNo||null,ipd_admission_id:N.type==="IPD"&&N.admissionNo||null,ot_case_id:N.type==="OT"&&N.otCaseNo||null,notes:N.notes||"",lines:S.map(De=>{var Pt,tr;const Nt=pe(De),sn=De.total_qty||De.requested_qty||Nt||"",Yt=sn?Number(sn):null;return{item_id:((Pt=De.item)==null?void 0:Pt.id)||De.item_id||null,item_name:((tr=De.item)==null?void 0:tr.name)||De.item_name||"",strength:De.strength||null,route:De.route||null,dose:De.dose||null,frequency:De.frequency||null,duration_days:De.duration_days?Number(De.duration_days):null,requested_qty:Yt,total_qty:Yt,instructions:De.instructions||null,is_prn:!!De.is_prn,is_stat:!!De.is_stat}})};try{P(!0);const De=await $Re(se);fe.success("Prescription created & sent to Pharmacy"),ae(),n("list"),_e(),De!=null&&De.data&&y(De.data)}catch{}finally{P(!1)}}async function St(se){try{const le=await wG(se.id),De=(le==null?void 0:le.data)||se;y(De),n("detail")}catch{}}const wt=b.useMemo(()=>g?g.lines||g.items||[]:[],[g]);return a.jsxs("div",{className:"p-4 md:p-6 space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-slate-900",children:"Pharmacy Prescriptions"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Create and manage OPD, IPD, OT and Counter prescriptions linked to inventory & billing."})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(Nn,{value:N.type,onValueChange:se=>j(le=>({...le,type:se})),children:[a.jsx(gn,{className:"w-[140px] bg-white border-slate-200 rounded-full",children:a.jsx(jn,{placeholder:"Rx Type"})}),a.jsx(yn,{children:N2.map(se=>a.jsx(gt,{value:se.value,children:se.label},se.value))})]}),a.jsxs(Te,{className:"rounded-full",onClick:()=>ie(N.type||"OPD"),children:[a.jsx(or,{className:"w-4 h-4 mr-2"}),"New Prescription"]})]})]}),a.jsxs(ko,{value:t,onValueChange:n,children:[a.jsxs(Vi,{className:"mb-4",children:[a.jsx(on,{value:"list",children:"Queue / History"}),a.jsx(on,{value:"new",children:"New Rx"}),a.jsx(on,{value:"detail",disabled:!g,children:"Selected Rx"})]}),a.jsx(ln,{value:"list",className:"space-y-3",children:a.jsxs(Re,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Ye,{className:"pb-3",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("span",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Filter by"}),a.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[a.jsx("button",{type:"button",onClick:()=>s("ALL"),className:`px-2.5 py-1 rounded-full text-xs border ${r==="ALL"?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-200"}`,children:"All Types"}),N2.map(se=>a.jsxs("button",{type:"button",onClick:()=>s(se.value),className:`px-2.5 py-1 rounded-full text-xs border flex items-center gap-1.5 ${r===se.value?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-200"}`,children:[a.jsx(gs,{className:"w-3 h-3"}),se.label]},se.value))]})]}),a.jsxs("div",{className:"flex items-center gap-2 w-full md:w-auto",children:[a.jsxs("div",{className:"relative flex-1 md:w-64",children:[a.jsx(ur,{className:"w-4 h-4 text-slate-400 absolute left-2.5 top-2.5"}),a.jsx(Ne,{value:l,onChange:se=>c(se.target.value),placeholder:"Search UHID / name / Rx no...",className:"pl-8 text-sm bg-white border-slate-200 rounded-full",onKeyDown:se=>{se.key==="Enter"&&_e()}})]}),a.jsxs(Nn,{value:i,onValueChange:o,children:[a.jsx(gn,{className:"w-[130px] bg-white border-slate-200 rounded-full text-xs",children:a.jsx(jn,{placeholder:"Status"})}),a.jsxs(yn,{children:[a.jsx(gt,{value:"ALL",children:"All status"}),a.jsx(gt,{value:"DRAFT",children:"Draft"}),a.jsx(gt,{value:"PENDING",children:"Pending"}),a.jsx(gt,{value:"PARTIAL",children:"Partial"}),a.jsx(gt,{value:"DISPENSED",children:"Dispensed"}),a.jsx(gt,{value:"CANCELLED",children:"Cancelled"})]})]}),a.jsx(Te,{variant:"outline",size:"icon",className:"rounded-full border-slate-200",onClick:_e,children:a.jsx(Ec,{className:"w-4 h-4"})})]})]})}),a.jsx(Be,{className:"pt-0",children:a.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:a.jsx("div",{className:"max-h-[420px] overflow-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:a.jsxs("tr",{className:"text-xs text-slate-500",children:[a.jsx("th",{className:"text-left px-3 py-2.5 font-medium",children:"Rx No"}),a.jsx("th",{className:"text-left px-3 py-2.5 font-medium",children:"Patient"}),a.jsx("th",{className:"text-left px-3 py-2.5 font-medium",children:"Type / Doctor"}),a.jsx("th",{className:"text-left px-3 py-2.5 font-medium",children:"Items"}),a.jsx("th",{className:"text-left px-3 py-2.5 font-medium",children:"Created"}),a.jsx("th",{className:"text-left px-3 py-2.5 font-medium",children:"Status"}),a.jsx("th",{className:"text-right px-3 py-2.5 font-medium",children:"Actions"})]})}),a.jsxs("tbody",{children:[d&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"px-3 py-6 text-center text-xs text-slate-500",children:"Loading prescriptions..."})}),!d&&!h.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"px-3 py-6 text-center text-xs text-slate-500",children:"No prescriptions found for the selected filters."})}),!d&&h.map(se=>{var me,tt;const le=(se.status||"").toUpperCase()||"PENDING",De=se.type||se.rx_type||"OPD",Nt=se.created_at||se.rx_datetime||se.bill_date||null,sn=Nt?String(Nt).slice(0,16).replace("T"," "):"",Yt=se.patient||se.patient_name||se.patient_uhid||"",Pt=typeof Yt=="string"?Yt:`${Yt.first_name||""} ${Yt.last_name||""}`.trim(),tr=((me=se.items)==null?void 0:me.length)||((tt=se.lines)==null?void 0:tt.length)||se.item_count||"",In=se.doctor_name||se.doctor||se.doctor_display||"";return a.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60 transition-colors",children:[a.jsx("td",{className:"px-3 py-2.5 align-middle",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-xs font-medium text-slate-900",children:se.rx_number||`RX-${se.id}`}),se.uhid&&a.jsxs("span",{className:"text-[11px] text-slate-500",children:["UHID: ",se.uhid]})]})}),a.jsx("td",{className:"px-3 py-2.5 align-middle",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-7 h-7 rounded-full bg-slate-100 flex items-center justify-center text-[11px] font-medium text-slate-700",children:a.jsx(hi,{className:"w-3 h-3"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-slate-900",children:Pt||""}),se.patient_uhid&&a.jsx("div",{className:"text-[11px] text-slate-500",children:se.patient_uhid})]})]})}),a.jsx("td",{className:"px-3 py-2.5 align-middle",children:a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Ge,{variant:"outline",className:"border-slate-200 text-[11px] px-1.5 py-0.5",children:De}),In&&a.jsxs("span",{className:"text-[11px] text-slate-600 flex items-center gap-1",children:[a.jsx(kn,{className:"w-3 h-3"}),In]})]}),se.context_label&&a.jsx("span",{className:"text-[11px] text-slate-500",children:se.context_label})]})}),a.jsx("td",{className:"px-3 py-2.5 align-middle text-xs text-slate-700",children:tr}),a.jsx("td",{className:"px-3 py-2.5 align-middle text-xs text-slate-700",children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Hc,{className:"w-3 h-3 text-slate-400"}),a.jsx("span",{children:sn})]})}),a.jsx("td",{className:"px-3 py-2.5 align-middle",children:a.jsx(WRe,{status:le})}),a.jsx("td",{className:"px-3 py-2.5 align-middle text-right",children:a.jsxs(Te,{variant:"outline",size:"sm",className:"h-7 px-2 text-xs rounded-full border-slate-200",onClick:()=>St(se),children:[a.jsx(tl,{className:"w-3 h-3 mr-1"}),"View"]})})]},se.id)})]})]})})})})]})}),a.jsx(ln,{value:"new",children:a.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.5fr)_minmax(0,2fr)]",children:[a.jsxs(Re,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Ye,{className:"pb-3",children:a.jsxs(Ze,{className:"flex items-center gap-2 text-sm font-semibold",children:[a.jsx(gs,{className:"w-4 h-4 text-slate-500"}),"Prescription Details"]})}),a.jsxs(Be,{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{className:"text-xs text-slate-600",children:"Prescription Type"}),a.jsx("div",{className:"flex flex-wrap gap-1.5",children:N2.map(se=>a.jsxs("button",{type:"button",onClick:()=>j(le=>({...le,type:se.value})),className:`px-2.5 py-1 rounded-full text-xs border flex items-center gap-1.5 ${N.type===se.value?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-200"}`,children:[a.jsx(gs,{className:"w-3 h-3"}),se.label]},se.value))})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{className:"text-xs text-slate-600",children:"Priority"}),a.jsxs(Nn,{value:N.priority,onValueChange:se=>j(le=>({...le,priority:se})),children:[a.jsx(gn,{className:"w-full bg-white border-slate-200 rounded-full h-9 text-xs",children:a.jsx(jn,{placeholder:"Select priority"})}),a.jsx(yn,{children:VRe.map(se=>a.jsx(gt,{value:se.value,children:se.label},se.value))})]})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{className:"text-xs text-slate-600",children:"Date & Time"}),a.jsx(Ne,{type:"datetime-local",value:N.datetime,onChange:se=>j(le=>({...le,datetime:se.target.value})),className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]}),a.jsxs("div",{className:"space-y-1.5 relative",children:[a.jsxs(Ke,{className:"text-xs text-slate-600 flex items-center gap-1.5",children:[a.jsx(hi,{className:"w-3 h-3"}),"Patient (UHID / name / phone)"]}),a.jsxs("div",{className:"relative",children:[a.jsx(ur,{className:"w-3.5 h-3.5 text-slate-400 absolute left-2.5 top-2.5"}),a.jsx(Ne,{value:M,onChange:se=>{O(se.target.value),Q(!0)},placeholder:N.type==="COUNTER"?"Optional for counter sale":"Search patient...",className:"pl-7 h-9 text-xs bg-white border-slate-200 rounded-full"})]}),a.jsx(su,{children:F&&(D.length>0||$)&&a.jsxs(ht.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},className:"absolute z-20 mt-1 w-full bg-white border border-slate-200 rounded-xl shadow-lg max-h-52 overflow-auto text-xs",children:[$&&a.jsx("div",{className:"px-3 py-2 text-slate-500",children:"Searching..."}),!$&&!D.length&&a.jsx("div",{className:"px-3 py-2 text-slate-500",children:"No patients found"}),!$&&D.map(se=>a.jsxs("button",{type:"button",onClick:()=>we(se),className:"w-full text-left px-3 py-1.5 hover:bg-slate-50 flex flex-col gap-0.5",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"font-medium text-slate-900",children:`${se.first_name||""} ${se.last_name||""}`.trim()||se.name||`Patient #${se.id}`}),se.uhid&&a.jsxs("span",{className:"text-[10px] text-slate-500",children:["UHID: ",se.uhid]})]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:[se.age?`${se.age}y  `:"",se.gender?`${se.gender}  `:"",se.phone||""]})]},se.id))]})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[N.type==="OPD"&&a.jsx(a.Fragment,{children:a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{className:"text-xs text-slate-600",children:"OPD Visit No (optional)"}),a.jsx(Ne,{value:N.visitNo,onChange:se=>j(le=>({...le,visitNo:se.target.value})),placeholder:"e.g., OPD-2025-0001",className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]})}),N.type==="IPD"&&a.jsx(a.Fragment,{children:a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{className:"text-xs text-slate-600",children:"Admission No"}),a.jsx(Ne,{value:N.admissionNo,onChange:se=>j(le=>({...le,admissionNo:se.target.value})),placeholder:"IPD admission number",className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]})}),N.type==="OT"&&a.jsx(a.Fragment,{children:a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{className:"text-xs text-slate-600",children:"OT Case No"}),a.jsx(Ne,{value:N.otCaseNo,onChange:se=>j(le=>({...le,otCaseNo:se.target.value})),placeholder:"OT / procedure case ID",className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]})}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsxs(Ke,{className:"text-xs text-slate-600 flex items-center gap-1",children:[a.jsx(kn,{className:"w-3 h-3"}),"Consultant / Prescriber"]}),a.jsxs(Nn,{value:N.doctorId||"",onValueChange:se=>j(le=>({...le,doctorId:se})),children:[a.jsx(gn,{className:"w-full bg-white border-slate-200 rounded-full h-9 text-xs",children:a.jsx(jn,{placeholder:"Select doctor"})}),a.jsxs(yn,{children:[q&&a.jsx(gt,{value:"__loading",disabled:!0,children:"Loading..."}),!q&&(!U||!U.length)&&a.jsx(gt,{value:"__none",disabled:!0,children:"No doctors configured"}),!q&&(U==null?void 0:U.map(se=>a.jsx(gt,{value:String(se.id),children:se.name||se.full_name||se.email},se.id)))]})]})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{className:"text-xs text-slate-600",children:"Clinical notes / instructions to pharmacist (optional)"}),a.jsx(dh,{value:N.notes,onChange:se=>j(le=>({...le,notes:se.target.value})),rows:3,className:"text-xs bg-white border-slate-200 resize-none rounded-xl",placeholder:"Eg: Allergic to penicillin, avoid NSAIDs, taper dose after 5 days, etc."})]})]})]}),a.jsxs(Re,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsxs(Ye,{className:"pb-3 flex flex-row items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(tl,{className:"w-4 h-4 text-slate-500"}),a.jsx(Ze,{className:"text-sm font-semibold",children:"Medicines & Instructions"})]}),a.jsx("div",{className:"text-[11px] text-slate-500",children:S.length?`${S.length} lines`:"No lines added yet"})]}),a.jsxs(Be,{className:"space-y-3",children:[a.jsx("div",{className:"border border-dashed border-slate-200 rounded-xl p-3 bg-slate-50/60",children:a.jsxs("div",{className:"grid md:grid-cols-[minmax(0,2.3fr)_minmax(0,1.1fr)] gap-3",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"space-y-1 relative",children:[a.jsxs(Ke,{className:"text-[11px] text-slate-600 flex items-center gap-1.5",children:["Medicine",a.jsx("span",{className:"text-[10px] text-slate-400",children:"(linked to Inventory)"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(ur,{className:"w-3.5 h-3.5 text-slate-400 absolute left-2 top-2.5"}),a.jsx(Ne,{value:X,onChange:se=>{J(se.target.value),xe(!0)},placeholder:"Search drug name, brand, generic...",className:"pl-7 h-9 text-xs bg-white border-slate-200 rounded-full"})]}),a.jsx(su,{children:be&&(ne.length>0||de)&&a.jsxs(ht.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},className:"absolute z-20 mt-1 w-full bg-white border border-slate-200 rounded-xl shadow-lg max-h-52 overflow-auto text-xs",children:[de&&a.jsx("div",{className:"px-3 py-2 text-slate-500",children:"Searching medicines..."}),!de&&!ne.length&&a.jsx("div",{className:"px-3 py-2 text-slate-500",children:"No items found"}),!de&&ne.map(se=>a.jsxs("button",{type:"button",onClick:()=>Oe(se),className:"w-full text-left px-3 py-1.5 hover:bg-slate-50 flex flex-col gap-0.5",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"font-medium text-slate-900",children:se.name||se.item_name}),se.code&&a.jsx("span",{className:"text-[10px] text-slate-500",children:se.code})]}),a.jsx("div",{className:"text-[11px] text-slate-500",children:se.strength||se.form||""})]},se.id))]})})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(Ke,{className:"text-[11px] text-slate-600",children:"Dose"}),a.jsx(Ne,{value:A.dose,onChange:se=>k(le=>({...le,dose:se.target.value})),placeholder:"e.g. 500 mg",className:"h-8 text-[11px] bg-white border-slate-200 rounded-full"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(Ke,{className:"text-[11px] text-slate-600",children:"Frequency"}),a.jsx(Ne,{value:A.frequency,onChange:se=>k(le=>({...le,frequency:se.target.value})),placeholder:"e.g. 1-0-1",className:"h-8 text-[11px] bg-white border-slate-200 rounded-full"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(Ke,{className:"text-[11px] text-slate-600",children:"Days"}),a.jsx(Ne,{value:A.duration_days,onChange:se=>k(le=>({...le,duration_days:se.target.value,total_qty:le.total_qty||pe({...le,duration_days:se.target.value})})),placeholder:"e.g. 5",className:"h-8 text-[11px] bg-white border-slate-200 rounded-full"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(Ke,{className:"text-[11px] text-slate-600",children:"Route"}),a.jsx(Ne,{value:A.route,onChange:se=>k(le=>({...le,route:se.target.value})),placeholder:"PO / IV / IM / etc",className:"h-8 text-[11px] bg-white border-slate-200 rounded-full"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(Ke,{className:"text-[11px] text-slate-600",children:"Total Qty"}),a.jsx(Ne,{value:A.total_qty,onChange:se=>k(le=>({...le,total_qty:se.target.value})),placeholder:pe(A)?`Suggested: ${pe(A)}`:"eg. 10",className:"h-8 text-[11px] bg-white border-slate-200 rounded-full"})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(Ke,{className:"text-[11px] text-slate-600",children:"Instructions to patient"}),a.jsx(Ne,{value:A.instructions,onChange:se=>k(le=>({...le,instructions:se.target.value})),placeholder:"After food, morning & night, etc.",className:"h-8 text-[11px] bg-white border-slate-200 rounded-full"})]})]}),a.jsxs("div",{className:"flex flex-col justify-between gap-2",children:[a.jsx("div",{className:"text-[11px] text-slate-500",children:a.jsx("p",{children:"Add medicine to this prescription. Quantity can be auto-estimated from frequency & days."})}),a.jsx("div",{className:"flex justify-end",children:a.jsxs(Te,{type:"button",size:"sm",className:"h-9 px-3 rounded-full",onClick:re,children:[a.jsx(or,{className:"w-3.5 h-3.5 mr-1"}),"Add line"]})})]})]})}),a.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:a.jsx(ra,{className:"max-h-[280px]",children:a.jsxs("table",{className:"w-full text-[11px]",children:[a.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:a.jsxs("tr",{className:"text-[11px] text-slate-500",children:[a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"#"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Medicine"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Dose / Freq / Days"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Route"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Qty"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Actions"})]})}),a.jsxs("tbody",{children:[!S.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-3 py-4 text-center text-[11px] text-slate-500",children:"No lines added. Use the panel above to add medicines to this prescription."})}),S.map((se,le)=>{var De,Nt;return a.jsxs("tr",{className:"border-t border-slate-100",children:[a.jsx("td",{className:"px-3 py-2 align-top text-slate-500",children:le+1}),a.jsx("td",{className:"px-3 py-2 align-top",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:((De=se.item)==null?void 0:De.name)||se.item_name||"Unnamed medicine"}),se.strength&&a.jsx("span",{className:"text-[10px] text-slate-500",children:se.strength})]})}),a.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("span",{children:[se.dose||""," "," ",se.frequency||""," "," ",se.duration_days?`${se.duration_days} days`:""]}),se.instructions&&a.jsx("span",{className:"text-[10px] text-slate-500",children:se.instructions})]})}),a.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:se.route||""}),a.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:se.total_qty||pe(se)||""}),a.jsx("td",{className:"px-3 py-2 align-top text-right",children:a.jsx(Te,{variant:"ghost",size:"sm",className:"h-7 px-2 text-[11px] text-slate-500 hover:text-red-600",onClick:()=>We(le),children:"Remove"})})]},`${se.item_id||((Nt=se.item)==null?void 0:Nt.id)||le}-${le}`)})]})]})})}),a.jsxs("div",{className:"flex justify-between items-center pt-1",children:[a.jsxs(Te,{type:"button",variant:"ghost",size:"sm",className:"h-8 px-2 text-xs text-slate-500",onClick:()=>{ae(),n("list")},children:[a.jsx(pL,{className:"w-3 h-3 mr-1"}),"Back to queue"]}),a.jsx(Te,{type:"button",size:"sm",className:"h-9 px-4 rounded-full",onClick:Je,disabled:T,children:T?"Saving...":a.jsxs(a.Fragment,{children:[a.jsx(tl,{className:"w-3.5 h-3.5 mr-1"}),"Save & Send to Pharmacy"]})})]})]})]})]})}),a.jsx(ln,{value:"detail",children:g?a.jsxs(Re,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsxs(Ye,{className:"pb-3 flex flex-row items-center justify-between gap-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs(Ze,{className:"text-sm font-semibold flex items-center gap-2",children:[a.jsx(tl,{className:"w-4 h-4 text-slate-500"}),"Prescription #",g.rx_number||g.id]}),a.jsxs("div",{className:"flex flex-wrap gap-2 text-[11px] text-slate-500",children:[a.jsxs("span",{children:["Type:"," ",a.jsx(Ge,{variant:"outline",className:"px-1.5 py-0.5",children:g.type||g.rx_type||"OPD"})]}),g.priority&&a.jsxs("span",{children:["Priority: ",g.priority]}),g.doctor_name&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(kn,{className:"w-3 h-3"}),g.doctor_name]})]})]}),a.jsxs("div",{className:"text-right text-[11px] text-slate-500",children:[a.jsxs("div",{children:["UHID:"," ",g.patient_uhid||((ft=g.patient)==null?void 0:ft.uhid)||""]}),a.jsxs("div",{children:["Patient:"," ",g.patient_name||`${((Ie=g.patient)==null?void 0:Ie.first_name)||""} ${((qe=g.patient)==null?void 0:qe.last_name)||""}`.trim()||""]})]})]}),a.jsx(Be,{className:"space-y-3",children:a.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:a.jsx(ra,{className:"max-h-[380px]",children:a.jsxs("table",{className:"w-full text-[11px]",children:[a.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:a.jsxs("tr",{className:"text-[11px] text-slate-500",children:[a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"#"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Medicine"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Dose / Freq / Days"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Route"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Qty"})]})}),a.jsxs("tbody",{children:[!wt.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-3 py-4 text-center text-[11px] text-slate-500",children:"No lines found for this prescription."})}),wt.map((se,le)=>a.jsxs("tr",{className:"border-t border-slate-100",children:[a.jsx("td",{className:"px-3 py-2 align-top text-slate-500",children:le+1}),a.jsx("td",{className:"px-3 py-2 align-top",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:se.item_name||se.medicine_name||"Unnamed medicine"}),se.strength&&a.jsx("span",{className:"text-[10px] text-slate-500",children:se.strength})]})}),a.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("span",{children:[se.dose||""," "," ",se.frequency||""," "," ",se.duration_days?`${se.duration_days} days`:""]}),se.instructions&&a.jsx("span",{className:"text-[10px] text-slate-500",children:se.instructions})]})}),a.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:se.route||""}),a.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:se.total_qty||se.qty||se.quantity||pe(se)||""})]},se.id||le))]})]})})})})]}):a.jsx(Re,{className:"border-slate-200 rounded-2xl shadow-sm",children:a.jsx(Be,{className:"py-8 text-center text-sm text-slate-500",children:"Select a prescription from the queue to view details."})})})]})]})}function WRe({status:t}){const n=(t||"").toUpperCase();let r=n,s="bg-slate-50 text-slate-700 border border-slate-200";return n==="PENDING"||n==="NEW"?(r="Pending",s="bg-amber-50 text-amber-700 border border-amber-200"):n==="PARTIAL"?(r="Partial",s="bg-blue-50 text-blue-700 border border-blue-200"):n==="DISPENSED"||n==="COMPLETED"?(r="Dispensed",s="bg-emerald-50 text-emerald-700 border border-emerald-200"):n==="CANCELLED"&&(r="Cancelled",s="bg-rose-50 text-rose-700 border border-rose-200"),a.jsx("span",{className:`inline-flex items-center px-2 py-0.5 text-[11px] rounded-full ${s}`,children:r})}function S2(t={}){return te.get("/pharmacy/billing",{params:t})}function C2(t){return te.get(`/pharmacy/billing/${t}`)}function qRe(t,n){return te.post(`/pharmacy/billing/${t}/status`,n)}function GRe(t={}){return te.get("/pharmacy/billing/returns/list",{params:t})}function KRe(t){return te.post("/pharmacy/billing/returns",t)}function YRe(t){return te.post("/pharmacy/billing/ipd/consolidated",t)}async function _2(t){try{const n=await te.get(`/pharmacy/billing/${t}/pdf`,{responseType:"blob"}),r=new Blob([n.data],{type:"application/pdf"}),s=window.URL.createObjectURL(r);window.open(s,"_blank","noopener,noreferrer")}catch(n){console.error("Failed to open pharmacy bill PDF",n)}}const XRe=[{value:"ALL",label:"All types"},{value:"OPD",label:"OPD"},{value:"IPD",label:"IPD"},{value:"OT",label:"OT"},{value:"COUNTER",label:"Counter"}],QRe=[{value:"ALL",label:"All"},{value:"UNPAID",label:"Unpaid"},{value:"PARTIAL",label:"Partial"},{value:"PAID",label:"Paid"},{value:"CANCELLED",label:"Cancelled"}],ZRe=[{value:"CASH",label:"Cash"},{value:"CARD",label:"Card"},{value:"UPI",label:"UPI"},{value:"NET_BANKING",label:"Net Banking"},{value:"OTHER",label:"Other"}];function cs(t){const n=Number(t??0);return Number.isFinite(n)?`${n.toFixed(2)}`:"0.00"}function ag(t={}){const n=(t.type||t.bill_type||"").toUpperCase();if(n==="OPD"||n==="IPD"||n==="OT"||n==="COUNTER")return n;const r=(t.context_type||"").toUpperCase();return r==="OPD"?"OPD":r==="IPD"?"IPD":r==="PHARM_COUNTER"||r==="COUNTER"?"COUNTER":"OPD"}function A2(t){const n=(t||"").toUpperCase();return n?n==="PARTIALLY_PAID"?"PARTIAL":n==="DRAFT"?"UNPAID":n:"UNPAID"}function JRe(){var In,me,tt,Et,Ft,en,Ue,an,Kt,Xt,Cn,kr,zo,Mt,$t,Ha,Ct;const[t,n]=b.useState("bills"),[r,s]=b.useState([]),[i,o]=b.useState(!1),[l,c]=b.useState("ALL"),[d,u]=b.useState("ALL"),[h,m]=b.useState(""),[g,y]=b.useState(""),[N,j]=b.useState(""),[S,_]=b.useState(null),[A,k]=b.useState(!1),[T,P]=b.useState(null),[M,O]=b.useState("CASH"),[D,L]=b.useState(""),[$,V]=b.useState(!1),[F,Q]=b.useState([]),[U,z]=b.useState(!1),[q,K]=b.useState(""),[X,J]=b.useState(null),[ne,Se]=b.useState([]),[de,ye]=b.useState(""),[be,xe]=b.useState(!1),[_e,we]=b.useState(""),[Oe,ae]=b.useState(""),[ie,pe]=b.useState(!1),[re,We]=b.useState([]),[Je,St]=b.useState(null);b.useEffect(()=>{wt()},[d]),b.useEffect(()=>{t==="returns"&&Ie(),t==="ipd"&&qe()},[t]);async function wt(){try{o(!0);const ue={limit:100};d!=="ALL"&&(ue.status=d),h.trim()&&(ue.q=h.trim()),g&&(ue.date_from=g),N&&(ue.date_to=N);const nt=await S2(ue);s((nt==null?void 0:nt.data)||[])}catch{}finally{o(!1)}}async function ft(ue){try{const nt=await C2(ue.id);_((nt==null?void 0:nt.data)||ue)}catch{}}async function Ie(){try{z(!0);const ue=await GRe({limit:50});Q((ue==null?void 0:ue.data)||[])}catch{}finally{z(!1)}}async function qe(){try{const ue=await S2({limit:100}),st=((ue==null?void 0:ue.data)||[]).filter(zt=>ag(zt)==="IPD");We(st)}catch{}}const se=b.useMemo(()=>r!=null&&r.length?l==="ALL"?r:r.filter(ue=>ag(ue)===l):[],[r,l]);function le(ue){const nt=Number(ue.total_amount??ue.gross_total??ue.net_amount??0),st=Number(ue.paid_amount??0),zt=Number(ue.balance_amount??nt-st)||0;P(ue),L(zt>0?String(zt.toFixed(2)):String(nt.toFixed(2))),O("CASH"),k(!0)}async function De(){if(!T)return;const ue=Number(D);if(!ue||ue<=0){fe.error("Enter a valid payment amount");return}const nt=Number(T.total_amount??T.gross_total??T.net_amount??0),zt=Number(T.paid_amount??0)+ue,It=Math.max(nt-zt,0);let Ot="PARTIAL";It<=.01?Ot="PAID":zt<=.01&&(Ot="UNPAID");try{if(V(!0),await qRe(T.id,{payment_status:Ot,paid_amount:ue,note:null}),fe.success("Payment recorded successfully"),k(!1),P(null),L(""),await wt(),S&&S.id===T.id){const Wn=await C2(S.id);_((Wn==null?void 0:Wn.data)||S)}}catch{}finally{V(!1)}}async function Nt(){if(!q.trim()){fe.error("Enter bill no / patient / UHID to search");return}try{const ue=await S2({q:q.trim(),limit:1}),nt=(ue==null?void 0:ue.data)||[];if(!nt.length){fe.error("No matching pharmacy bill found");return}const st=nt[0],zt=await C2(st.id),It=(zt==null?void 0:zt.data)||st,Wn=(It.items||It.lines||[]).map(mn=>({...mn,return_qty:""}));J(It),Se(Wn)}catch{}}function sn(ue,nt){Se(st=>st.map((zt,It)=>It===ue?{...zt,return_qty:nt}:zt))}async function Yt(){if(!X){fe.error("Select a source bill first");return}const ue=ne.filter(st=>Number(st.return_qty||0)>0);if(!ue.length){fe.error("Enter return quantity for at least one item");return}const nt={source_invoice_id:X.id,reason:de||null,lines:ue.map(st=>({bill_line_id:st.id,qty_to_return:Number(st.return_qty||0)}))};try{xe(!0),await KRe(nt),fe.success("Return note created successfully"),ye(""),J(null),Se([]),K(""),Ie()}catch{}finally{xe(!1)}}async function Pt(){if(!_e&&!Oe){fe.error("Enter Patient ID or Admission ID");return}const ue={};_e&&(ue.patient_id=Number(_e)),Oe&&(ue.admission_id=Number(Oe));try{pe(!0);const nt=await YRe(ue),st=(nt==null?void 0:nt.data)||nt||null;if(!st){fe.error("No consolidated data returned");return}St(st),fe.success("IPD consolidated pharmacy summary generated")}catch{}finally{pe(!1)}}const tr=b.useMemo(()=>S?S.items||S.lines||[]:[],[S]);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"p-4 md:p-6 space-y-4",children:[a.jsx("div",{className:"flex items-center justify-between gap-3",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-slate-900",children:"Pharmacy Billing Console"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Manage pharmacy invoices, payments, returns & IPD consolidated bills."})]})}),a.jsxs(ko,{value:t,onValueChange:n,children:[a.jsxs(Vi,{className:"mb-4",children:[a.jsx(on,{value:"bills",children:"Bills"}),a.jsx(on,{value:"returns",children:"Returns"}),a.jsx(on,{value:"ipd",children:"IPD Consolidated"})]}),a.jsx(ln,{value:"bills",className:"space-y-3",children:a.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.7fr)_minmax(0,1.3fr)]",children:[a.jsxs(Re,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Ye,{className:"pb-3",children:a.jsxs("div",{className:"flex flex-col gap-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs(Ze,{className:"text-sm font-semibold flex items-center gap-2",children:[a.jsx(Xw,{className:"w-4 h-4 text-slate-500"}),"Pharmacy Bills"]}),a.jsx(Te,{variant:"outline",size:"icon",className:"h-8 w-8 rounded-full border-slate-200",onClick:wt,children:a.jsx(Ec,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"relative flex-1 min-w-[180px]",children:[a.jsx(ur,{className:"w-4 h-4 text-slate-400 absolute left-2.5 top-2.5"}),a.jsx(Ne,{value:h,onChange:ue=>m(ue.target.value),onKeyDown:ue=>{ue.key==="Enter"&&wt()},placeholder:"Search bill no / UHID / patient / phone",className:"pl-8 h-9 text-xs bg-white border-slate-200 rounded-full"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ne,{type:"date",value:g,onChange:ue=>y(ue.target.value),className:"h-9 text-[11px] bg-white border-slate-200 rounded-full w-[130px]"}),a.jsx(Ne,{type:"date",value:N,onChange:ue=>j(ue.target.value),className:"h-9 text-[11px] bg-white border-slate-200 rounded-full w-[130px]"}),a.jsx(Te,{variant:"outline",size:"sm",className:"h-8 px-3 rounded-full text-[11px]",onClick:wt,children:"Apply"})]})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs(Nn,{value:l,onValueChange:c,children:[a.jsx(gn,{className:"w-[140px] bg-white border-slate-200 rounded-full h-8 text-[11px]",children:a.jsx(jn,{placeholder:"Bill type"})}),a.jsx(yn,{children:XRe.map(ue=>a.jsx(gt,{value:ue.value,children:ue.label},ue.value))})]}),a.jsxs(Nn,{value:d,onValueChange:u,children:[a.jsx(gn,{className:"w-[130px] bg-white border-slate-200 rounded-full h-8 text-[11px]",children:a.jsx(jn,{placeholder:"Status"})}),a.jsx(yn,{children:QRe.map(ue=>a.jsx(gt,{value:ue.value,children:ue.label},ue.value))})]})]})]})]})}),a.jsx(Be,{className:"pt-0",children:a.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:a.jsx(ra,{className:"max-h-[480px]",children:a.jsxs("table",{className:"w-full text-xs",children:[a.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:a.jsxs("tr",{className:"text-[11px] text-slate-500",children:[a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Bill"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Patient"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Type"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Amount"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Paid / Balance"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Date"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Actions"})]})}),a.jsxs("tbody",{children:[i&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"px-3 py-6 text-center text-[11px] text-slate-500",children:"Loading bills..."})}),!i&&!se.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"px-3 py-6 text-center text-[11px] text-slate-500",children:"No pharmacy bills found for selected filters."})}),!i&&se.map(ue=>{var Gr,et,wi;const nt=Number(ue.total_amount??ue.gross_total??ue.net_amount??0),st=Number(ue.paid_amount??0),zt=Number(ue.balance_amount??nt-st)||0,It=A2(ue.status),Ot=ue.bill_date||ue.created_at||ue.invoice_date||null,Wn=Ot?String(Ot).slice(0,16).replace("T"," "):"",mn=ag(ue),Tr=ue.patient_name||`${((Gr=ue.patient)==null?void 0:Gr.first_name)||""} ${((et=ue.patient)==null?void 0:et.last_name)||""}`.trim()||"",nr=ue.patient_uhid||((wi=ue.patient)==null?void 0:wi.uhid),Ir=It!=="PAID"&&It!=="CANCELLED"&&nt>0;return a.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/70 cursor-pointer",onClick:()=>ft(ue),children:[a.jsx("td",{className:"px-3 py-2 align-middle",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:ue.bill_number||ue.invoice_number||`PB-${ue.id}`}),ue.rx_number&&a.jsxs("span",{className:"text-[10px] text-slate-500",children:["Rx: ",ue.rx_number]})]})}),a.jsx("td",{className:"px-3 py-2 align-middle",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-7 h-7 rounded-full bg-slate-100 flex items-center justify-center text-[11px] text-slate-700",children:a.jsx(hi,{className:"w-3 h-3"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[11px] text-slate-900",children:Tr}),nr&&a.jsxs("div",{className:"text-[10px] text-slate-500",children:["UHID: ",nr]})]})]})}),a.jsx("td",{className:"px-3 py-2 align-middle",children:a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx(Ge,{variant:"outline",className:"border-slate-200 text-[10px] px-1.5 py-0.5 w-max",children:mn}),a.jsx(E2,{status:It})]})}),a.jsx("td",{className:"px-3 py-2 align-middle text-right",children:a.jsx("div",{className:"text-[11px] text-slate-900",children:cs(nt)})}),a.jsx("td",{className:"px-3 py-2 align-middle text-right",children:a.jsxs("div",{className:"flex flex-col items-end gap-0.5",children:[a.jsxs("span",{className:"text-[11px] text-emerald-700",children:["Paid: ",cs(st)]}),a.jsxs("span",{className:"text-[11px] text-rose-700",children:["Bal: ",cs(zt)]})]})}),a.jsx("td",{className:"px-3 py-2 align-middle text-[11px] text-slate-700",children:a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Hc,{className:"w-3 h-3 text-slate-400"}),a.jsx("span",{children:Wn})]})}),a.jsx("td",{className:"px-3 py-2 align-middle text-right",onClick:Qi=>Qi.stopPropagation(),children:a.jsxs("div",{className:"flex justify-end gap-1.5",children:[a.jsx(Te,{variant:"outline",size:"icon",className:"h-7 w-7 rounded-full border-slate-200",onClick:()=>{const Qi=ue.id||ue.invoice_id;Qi&&_2(Qi)},children:a.jsx($d,{className:"w-3 h-3"})}),Ir&&a.jsxs(Te,{size:"sm",className:"h-7 px-3 rounded-full text-[11px]",onClick:()=>le(ue),children:[a.jsx(ho,{className:"w-3 h-3 mr-1"}),"Collect"]})]})})]},ue.id)})]})]})})})})]}),a.jsxs(Re,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Ye,{className:"pb-3",children:a.jsxs(Ze,{className:"text-sm font-semibold flex items-center gap-2",children:[a.jsx(Xw,{className:"w-4 h-4 text-slate-500"}),"Bill Details"]})}),a.jsx(Be,{className:"space-y-3 text-xs",children:S?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsx("div",{className:"text-[11px] font-semibold text-slate-900",children:S.patient_name||`${((In=S.patient)==null?void 0:In.first_name)||""} ${((me=S.patient)==null?void 0:me.last_name)||""}`.trim()||""}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID:"," ",S.patient_uhid||((tt=S.patient)==null?void 0:tt.uhid)||""]}),a.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[a.jsx(Ge,{variant:"outline",className:"border-slate-200 text-[10px] px-1.5 py-0.5",children:ag(S)}),S.location&&a.jsxs("span",{className:"text-[10px] text-slate-500 flex items-center gap-1",children:[a.jsx(Kw,{className:"w-3 h-3"}),S.location]})]})]}),a.jsxs("div",{className:"text-right text-[11px] text-slate-500",children:[a.jsxs("div",{children:["Bill:"," ",S.bill_number||S.invoice_number||`PB-${S.id}`]}),a.jsxs("div",{children:["Date:"," ",((Ft=(Et=S.bill_date||S.created_at||"")==null?void 0:Et.toString())==null?void 0:Ft.slice(0,10))||""]}),a.jsx("div",{className:"mt-1",children:a.jsx(E2,{status:A2(S.status)})})]})]}),a.jsxs("div",{className:"border border-slate-100 rounded-xl px-3 py-2.5 flex flex-col gap-1.5 bg-slate-50/60",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-[11px] text-slate-600",children:"Total"}),a.jsx("span",{className:"text-[12px] font-semibold text-slate-900",children:cs(S.total_amount??S.gross_total??S.net_amount)})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-[11px] text-slate-600",children:"Paid"}),a.jsx("span",{className:"text-[11px] text-emerald-700",children:cs(S.paid_amount)})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-[11px] text-slate-600",children:"Balance"}),a.jsx("span",{className:"text-[11px] text-rose-700",children:cs(S.balance_amount??Number(S.total_amount??S.gross_total??S.net_amount??0)-Number(S.paid_amount??0))})]})]}),a.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:a.jsx(ra,{className:"max-h-[260px]",children:a.jsxs("table",{className:"w-full text-[11px]",children:[a.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:a.jsxs("tr",{className:"text-[11px] text-slate-500",children:[a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"#"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Medicine"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Qty"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Rate"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Amount"})]})}),a.jsxs("tbody",{children:[!tr.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-3 py-4 text-center text-[11px] text-slate-500",children:"No items found for this bill."})}),tr.map((ue,nt)=>a.jsxs("tr",{className:"border-t border-slate-100",children:[a.jsx("td",{className:"px-3 py-2 align-top text-slate-500",children:nt+1}),a.jsx("td",{className:"px-3 py-2 align-top",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:ue.item_name||ue.medicine_name||""}),ue.batch_no&&a.jsxs("span",{className:"text-[10px] text-slate-500",children:["Batch: ",ue.batch_no]})]})}),a.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:ue.qty||ue.quantity||""}),a.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:cs(ue.rate||ue.unit_price)}),a.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:cs(ue.amount||ue.line_total)})]},ue.id||nt))]})]})})}),a.jsxs("div",{className:"flex items-center justify-between pt-1",children:[a.jsxs(Te,{variant:"outline",size:"sm",className:"h-8 px-3 rounded-full text-[11px]",onClick:()=>{const ue=S.id||S.invoice_id;ue&&_2(ue)},children:[a.jsx($d,{className:"w-3 h-3 mr-1"}),"Download PDF"]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs(Te,{variant:"outline",size:"sm",className:"h-8 px-3 rounded-full text-[11px]",onClick:()=>le(S),children:[a.jsx(ho,{className:"w-3 h-3 mr-1"}),"Add Payment"]})})]})]}):a.jsx("div",{className:"py-10 text-center text-[11px] text-slate-500",children:"Select a pharmacy bill from the list to view details."})})]})]})}),a.jsx(ln,{value:"returns",className:"space-y-3",children:a.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.4fr)_minmax(0,1.6fr)]",children:[a.jsxs(Re,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Ye,{className:"pb-3",children:a.jsxs(Ze,{className:"text-sm font-semibold flex items-center gap-2",children:[a.jsx(bc,{className:"w-4 h-4 text-slate-500"}),"New Pharmacy Return"]})}),a.jsxs(Be,{className:"space-y-3 text-xs",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{className:"text-[11px] text-slate-600",children:"Source bill (search by bill no / UHID / patient)"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(ur,{className:"w-4 h-4 text-slate-400 absolute left-2.5 top-2.5"}),a.jsx(Ne,{value:q,onChange:ue=>K(ue.target.value),placeholder:"Eg. PB-0001, UHID, patient name",className:"pl-8 h-9 text-xs bg-white border-slate-200 rounded-full"})]}),a.jsx(Te,{size:"sm",className:"h-9 px-3 rounded-full text-[11px]",onClick:Nt,children:"Search"})]})]}),X&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"border border-slate-100 rounded-xl p-3 bg-slate-50/60 space-y-1.5",children:a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-[11px] font-semibold text-slate-900",children:X.patient_name||`${((en=X.patient)==null?void 0:en.first_name)||""} ${((Ue=X.patient)==null?void 0:Ue.last_name)||""}`.trim()||""}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID:"," ",X.patient_uhid||((an=X.patient)==null?void 0:an.uhid)||""]})]}),a.jsxs("div",{className:"text-right text-[11px] text-slate-500",children:["Bill:"," ",X.bill_number||X.invoice_number||`PB-${X.id}`,a.jsx("br",{}),"Date:"," ",((Xt=(Kt=X.bill_date||X.created_at||"")==null?void 0:Kt.toString())==null?void 0:Xt.slice(0,10))||""]})]})}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{className:"text-[11px] text-slate-600",children:"Items & return quantity"}),a.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:a.jsx(ra,{className:"max-h-[250px]",children:a.jsxs("table",{className:"w-full text-[11px]",children:[a.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:a.jsxs("tr",{className:"text-[11px] text-slate-500",children:[a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"#"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Medicine"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Sold Qty"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Return Qty"})]})}),a.jsxs("tbody",{children:[!ne.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"px-3 py-4 text-center text-[11px] text-slate-500",children:"No items found for this bill."})}),ne.map((ue,nt)=>a.jsxs("tr",{className:"border-t border-slate-100",children:[a.jsx("td",{className:"px-3 py-2 align-top text-slate-500",children:nt+1}),a.jsx("td",{className:"px-3 py-2 align-top",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:ue.item_name||ue.medicine_name||""}),ue.batch_no&&a.jsxs("span",{className:"text-[10px] text-slate-500",children:["Batch: ",ue.batch_no]})]})}),a.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:ue.qty||ue.quantity||""}),a.jsx("td",{className:"px-3 py-2 align-top text-right",children:a.jsx(Ne,{type:"number",min:"0",value:ue.return_qty??"",onChange:st=>sn(nt,st.target.value),className:"h-8 w-20 ml-auto text-[11px] text-right bg-white border-slate-200 rounded-full"})})]},ue.id||nt))]})]})})})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{className:"text-[11px] text-slate-600",children:"Reason for return"}),a.jsx(dh,{value:de,onChange:ue=>ye(ue.target.value),rows:3,className:"text-[11px] bg-white border-slate-200 rounded-xl resize-none",placeholder:"Eg. Patient mismatch, wrong strength, expiry, doctor changed prescription, etc."})]}),a.jsx("div",{className:"flex justify-end pt-1",children:a.jsx(Te,{size:"sm",className:"h-9 px-4 rounded-full text-[11px]",onClick:Yt,disabled:be,children:be?"Creating return...":a.jsxs(a.Fragment,{children:[a.jsx(bc,{className:"w-3.5 h-3.5 mr-1"}),"Create Return Note"]})})})]})]})]}),a.jsxs(Re,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Ye,{className:"pb-3",children:a.jsxs(Ze,{className:"text-sm font-semibold flex items-center gap-2",children:[a.jsx(bc,{className:"w-4 h-4 text-slate-500"}),"Recent Pharmacy Returns"]})}),a.jsx(Be,{className:"pt-0",children:a.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:a.jsx(ra,{className:"max-h-[420px]",children:a.jsxs("table",{className:"w-full text-[11px]",children:[a.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:a.jsxs("tr",{className:"text-[11px] text-slate-500",children:[a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Return"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Patient"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Source bill"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Refund"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Date"})]})}),a.jsxs("tbody",{children:[U&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-3 py-6 text-center text-[11px] text-slate-500",children:"Loading returns..."})}),!U&&!F.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-3 py-6 text-center text-[11px] text-slate-500",children:"No pharmacy returns found."})}),!U&&F.map(ue=>{var Ot,Wn;const nt=Math.abs(Number(ue.net_amount??ue.total_amount??0)),st=(ue.created_at||"").toString().slice(0,16).replace("T"," "),zt=ue.patient_name||`${((Ot=ue.patient)==null?void 0:Ot.first_name)||""} ${((Wn=ue.patient)==null?void 0:Wn.last_name)||""}`.trim()||"",It=ue.source_bill_number||ue.source_invoice_number||"";return a.jsxs("tr",{className:"border-t border-slate-100",children:[a.jsx("td",{className:"px-3 py-2 align-top",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:ue.return_number||ue.bill_number||`PR-${ue.id}`}),ue.reason&&a.jsx("span",{className:"text-[10px] text-slate-500",children:ue.reason})]})}),a.jsx("td",{className:"px-3 py-2 align-top",children:a.jsx("div",{className:"text-[11px] text-slate-900",children:zt})}),a.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:It}),a.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:cs(nt)}),a.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:st||""})]},ue.id)})]})]})})})})]})]})}),a.jsx(ln,{value:"ipd",className:"space-y-3",children:a.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.3fr)_minmax(0,1.7fr)]",children:[a.jsxs(Re,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Ye,{className:"pb-3",children:a.jsxs(Ze,{className:"text-sm font-semibold flex items-center gap-2",children:[a.jsx(Kw,{className:"w-4 h-4 text-slate-500"}),"Generate IPD Pharmacy Summary"]})}),a.jsxs(Be,{className:"space-y-3 text-xs",children:[a.jsx("p",{className:"text-[11px] text-slate-500",children:"Generate consolidated pharmacy summary for all UNPAID / PARTIALLY_PAID IPD pharmacy invoices for a given admission. Use this for final IPD discharge billing."}),a.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{className:"text-[11px] text-slate-600",children:"Patient ID (internal PK)"}),a.jsx(Ne,{value:_e,onChange:ue=>we(ue.target.value),placeholder:"Eg. 123 (required)",className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{className:"text-[11px] text-slate-600",children:"IPD Admission ID (optional filter)"}),a.jsx(Ne,{value:Oe,onChange:ue=>ae(ue.target.value),placeholder:"Eg. 45  IPD admission table ID",className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]})]}),a.jsx("div",{className:"flex justify-end pt-2",children:a.jsx(Te,{size:"sm",className:"h-9 px-4 rounded-full text-[11px]",onClick:Pt,disabled:ie,children:ie?"Generating...":a.jsxs(a.Fragment,{children:[a.jsx(Xw,{className:"w-3.5 h-3.5 mr-1"}),"Generate Summary"]})})}),Je&&a.jsxs("div",{className:"mt-3 border border-slate-100 rounded-xl p-3 bg-slate-50/60 space-y-2",children:[a.jsx("div",{className:"flex items-start justify-between gap-3",children:a.jsxs("div",{children:[a.jsx("div",{className:"text-[11px] font-semibold text-slate-900",children:Je.patient_name||""}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID:"," ",Je.patient_uhid||""]}),Je.admission_id&&a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Admission ID: ",Je.admission_id]})]})}),a.jsxs("div",{className:"border border-slate-100 rounded-lg px-3 py-2 bg-white space-y-1.5",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-[11px] text-slate-600",children:"Gross Total"}),a.jsx("span",{className:"text-[11px] font-semibold text-slate-900",children:cs(Je.total_amount)})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-[11px] text-slate-600",children:"Tax"}),a.jsx("span",{className:"text-[11px] text-slate-900",children:cs(Je.total_tax)})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-[11px] text-slate-600",children:"Net Amount"}),a.jsx("span",{className:"text-[11px] font-semibold text-slate-900",children:cs(Je.net_amount)})]})]}),a.jsx("div",{className:"border border-slate-100 rounded-lg overflow-hidden bg-white",children:a.jsx(ra,{className:"max-h-[220px]",children:a.jsxs("table",{className:"w-full text-[11px]",children:[a.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:a.jsxs("tr",{className:"text-[11px] text-slate-500",children:[a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Medicine"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Qty"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Amount"})]})}),a.jsxs("tbody",{children:[!((Cn=Je.items)!=null&&Cn.length)&&a.jsx("tr",{children:a.jsx("td",{colSpan:3,className:"px-3 py-4 text-center text-[11px] text-slate-500",children:"No pharmacy items found in this summary."})}),(kr=Je.items)==null?void 0:kr.map((ue,nt)=>a.jsxs("tr",{className:"border-t border-slate-100",children:[a.jsx("td",{className:"px-3 py-2 align-top text-slate-900",children:ue.medicine_name||""}),a.jsx("td",{className:"px-3 py-2 align-top text-right text-slate-700",children:ue.qty}),a.jsx("td",{className:"px-3 py-2 align-top text-right text-slate-700",children:cs(ue.amount)})]},nt))]})]})})}),a.jsxs("p",{className:"text-[10px] text-slate-500",children:["Use this summary while generating the final IPD discharge invoice in the main Billing module. Each contributing pharmacy bill ID is available in ",a.jsx("code",{children:"sale_ids"})," if needed."]})]})]})]}),a.jsxs(Re,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Ye,{className:"pb-3",children:a.jsxs(Ze,{className:"text-sm font-semibold flex items-center gap-2",children:[a.jsx(Kw,{className:"w-4 h-4 text-slate-500"}),"Recent IPD Pharmacy Bills"]})}),a.jsx(Be,{className:"pt-0",children:a.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:a.jsx(ra,{className:"max-h-[420px]",children:a.jsxs("table",{className:"w-full text-[11px]",children:[a.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:a.jsxs("tr",{className:"text-[11px] text-slate-500",children:[a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Bill"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Patient"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Status"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Amount"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Date"})]})}),a.jsxs("tbody",{children:[!re.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-3 py-6 text-center text-[11px] text-slate-500",children:"No IPD pharmacy bills found."})}),re.map(ue=>{var Ot,Wn;const nt=Number(ue.total_amount??ue.gross_total??ue.net_amount??0),st=A2(ue.status),zt=(ue.bill_date||ue.created_at||"").toString().slice(0,16).replace("T"," "),It=ue.patient_name||`${((Ot=ue.patient)==null?void 0:Ot.first_name)||""} ${((Wn=ue.patient)==null?void 0:Wn.last_name)||""}`.trim()||"";return a.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60 cursor-pointer",onClick:()=>{const mn=ue.id||ue.invoice_id;mn&&_2(mn)},children:[a.jsx("td",{className:"px-3 py-2 align-top",children:a.jsx("div",{className:"flex flex-col",children:a.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:ue.bill_number||ue.invoice_number||`PB-${ue.id}`})})}),a.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:It}),a.jsx("td",{className:"px-3 py-2 align-top",children:a.jsx(E2,{status:st})}),a.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:cs(nt)}),a.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:zt||""})]},ue.id)})]})]})})})})]})]})})]})]}),a.jsx(Qu,{open:A,onOpenChange:k,children:a.jsxs(vd,{className:"max-w-md rounded-2xl",children:[a.jsxs(bd,{children:[a.jsxs(Nd,{className:"text-sm font-semibold flex items-center gap-2",children:[a.jsx(ho,{className:"w-4 h-4 text-slate-600"}),"Collect Pharmacy Payment"]}),a.jsx(jd,{className:"text-xs text-slate-500",children:"Record payment for this pharmacy invoice. You can add multiple payments later (partial payments supported)."})]}),T&&a.jsxs("div",{className:"space-y-3 text-xs",children:[a.jsxs("div",{className:"border border-slate-100 rounded-xl p-3 bg-slate-50/60 space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-[11px] font-semibold text-slate-900",children:T.patient_name||`${((zo=T.patient)==null?void 0:zo.first_name)||""} ${((Mt=T.patient)==null?void 0:Mt.last_name)||""}`.trim()||""}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID:"," ",T.patient_uhid||(($t=T.patient)==null?void 0:$t.uhid)||""]})]}),a.jsxs("div",{className:"text-right text-[11px] text-slate-500",children:["Bill:"," ",T.bill_number||T.invoice_number||`PB-${T.id}`,a.jsx("br",{}),"Date:"," ",((Ct=(Ha=T.bill_date||T.created_at||"")==null?void 0:Ha.toString())==null?void 0:Ct.slice(0,10))||""]})]}),a.jsxs("div",{className:"flex items-center justify-between mt-1 pt-1 border-t border-dashed border-slate-200",children:[a.jsx("div",{className:"text-[11px] text-slate-600",children:"Total / Paid / Balance"}),a.jsxs("div",{className:"text-right text-[11px]",children:[a.jsx("div",{className:"text-slate-900",children:cs(T.total_amount??T.gross_total??T.net_amount)}),a.jsx("div",{className:"text-emerald-700",children:cs(T.paid_amount)}),a.jsx("div",{className:"text-rose-700",children:cs(T.balance_amount??Number(T.total_amount??T.gross_total??T.net_amount??0)-Number(T.paid_amount??0))})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{className:"text-[11px] text-slate-600",children:"Payment mode"}),a.jsxs(Nn,{value:M,onValueChange:O,children:[a.jsx(gn,{className:"w-full h-9 bg-white border-slate-200 rounded-full text-[11px]",children:a.jsx(jn,{placeholder:"Select mode"})}),a.jsx(yn,{children:ZRe.map(ue=>a.jsx(gt,{value:ue.value,children:ue.label},ue.value))})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ke,{className:"text-[11px] text-slate-600",children:"Amount"}),a.jsx(Ne,{type:"number",min:"0",value:D,onChange:ue=>L(ue.target.value),className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]})]})]}),a.jsxs(wd,{className:"mt-3",children:[a.jsx(Te,{variant:"outline",size:"sm",className:"h-8 px-3 rounded-full text-[11px]",onClick:()=>k(!1),children:"Cancel"}),a.jsx(Te,{size:"sm",className:"h-8 px-4 rounded-full text-[11px]",onClick:De,disabled:$,children:$?"Saving...":a.jsxs(a.Fragment,{children:[a.jsx(Fi,{className:"w-3 h-3 mr-1"}),"Save Payment"]})})]})]})})]})}function E2({status:t}){const n=(t||"").toUpperCase();let r=n||"",s="bg-slate-50 text-slate-700 border border-slate-200";return n==="UNPAID"||n==="PENDING"||n==="DRAFT"?(r="Unpaid",s="bg-amber-50 text-amber-700 border border-amber-200"):n==="PARTIAL"||n==="PARTIALLY_PAID"?(r="Partially paid",s="bg-blue-50 text-blue-700 border border-blue-200"):n==="PAID"?(r="Paid",s="bg-emerald-50 text-emerald-700 border border-emerald-200"):n==="CANCELLED"?(r="Cancelled",s="bg-rose-50 text-rose-700 border border-rose-200"):n==="FINALIZED"&&(r="Finalized",s="bg-slate-50 text-slate-700 border border-slate-300"),a.jsx("span",{className:`inline-flex items-center px-2 py-0.5 text-[10px] rounded-full ${s}`,children:r})}function e8e(t){if(!t)return"";const n=new Date(t);return`${n.toLocaleDateString()} ${n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`}function t8e(){const[t,n]=b.useState(""),[r,s]=b.useState(""),[i,o]=b.useState(""),[l,c]=b.useState([]),[d,u]=b.useState(!1),h=async()=>{try{u(!0);const g={context_type:"pharmacy"};t&&(g.q=t),r&&(g.date_from=r),i&&(g.date_to=i);const y=await mde(g);c(y.data||[])}catch{}finally{u(!1)}};b.useEffect(()=>{h()},[]);const m=l.reduce((g,y)=>g+(y.total_amount||0),0);return a.jsxs("div",{className:"p-3 sm:p-4 lg:p-6 space-y-3 sm:space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[a.jsx("div",{className:"inline-flex h-9 w-9 items-center justify-center rounded-2xl bg-slate-900 text-white",children:a.jsx(w1,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-base sm:text-lg font-semibold tracking-tight text-slate-900",children:"Pharmacy Counter Sales (OTC)"}),a.jsx("p",{className:"text-xs sm:text-sm text-slate-500",children:"View Pharmacy counter / OTC sales. (Future: add direct sale screen here.)"})]})]}),a.jsxs(Re,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Ye,{className:"pb-2",children:a.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx(ur,{className:"absolute left-2 top-2.5 h-4 w-4 text-slate-400"}),a.jsx(Ne,{placeholder:"UHID / Name / Phone",className:"pl-7 h-9 w-40 sm:w-52",value:t,onChange:g=>n(g.target.value)})]}),a.jsx(Ne,{type:"date",className:"h-9 w-32",value:r,onChange:g=>s(g.target.value)}),a.jsx(Ne,{type:"date",className:"h-9 w-32",value:i,onChange:g=>o(g.target.value)}),a.jsxs(Te,{size:"sm",variant:"outline",className:"h-9 text-xs",onClick:h,disabled:d,children:[d?a.jsx(dr,{className:"mr-1 h-3.5 w-3.5 animate-spin"}):null,"Apply"]})]}),a.jsxs("div",{className:"flex flex-col items-end gap-1 text-right",children:[a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Sales in view"," ",a.jsx(Ge,{variant:"secondary",className:"ml-1 h-5 px-2 text-[10px]",children:l.length})]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Net amount"," ",a.jsxs("span",{className:"font-semibold text-slate-900",children:["",m.toFixed(2)]})]})]})]})}),a.jsxs(Be,{className:"pt-0",children:[a.jsx("div",{className:"border-t border-slate-100 mt-2 mb-2"}),a.jsx("div",{className:"overflow-x-auto -mx-2 sm:mx-0",children:a.jsxs("table",{className:"min-w-full text-xs sm:text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-slate-100 text-[11px] uppercase tracking-wide text-slate-500",children:[a.jsx("th",{className:"py-2 pl-3 pr-2 text-left font-medium",children:"Sale"}),a.jsx("th",{className:"py-2 px-2 text-left font-medium",children:"Patient"}),a.jsx("th",{className:"py-2 px-2 text-right font-medium",children:"Amount"})]})}),a.jsxs("tbody",{children:[l.length===0&&!d&&a.jsx("tr",{children:a.jsx("td",{colSpan:3,className:"py-10 text-center text-xs text-slate-500",children:"No counter sales found."})}),d&&a.jsx("tr",{children:a.jsx("td",{colSpan:3,className:"py-8 text-center",children:a.jsx(dr,{className:"mx-auto h-4 w-4 animate-spin text-slate-400"})})}),!d&&l.map(g=>a.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[a.jsx("td",{className:"py-2.5 pl-3 pr-2 align-top",children:a.jsxs("div",{className:"flex flex-col gap-0.5",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(w1,{className:"h-3.5 w-3.5 text-slate-400"}),a.jsxs("span",{className:"font-medium text-[11px] text-slate-800",children:["Sale #",g.id]})]}),a.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-500",children:[a.jsx(Hc,{className:"h-3 w-3"}),a.jsx("span",{children:e8e(g.created_at)})]})]})}),a.jsxs("td",{className:"py-2.5 px-2 align-top",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(hi,{className:"h-3.5 w-3.5 text-slate-400"}),a.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:g.patient_name||""})]}),a.jsxs("div",{className:"mt-0.5 text-[10px] text-slate-500 flex flex-wrap gap-1",children:[g.patient_uhid&&a.jsx(Ge,{variant:"outline",className:"h-4 px-1.5 text-[9px]",children:g.patient_uhid}),g.payment_mode&&a.jsx("span",{className:"capitalize",children:g.payment_mode})]})]}),a.jsx("td",{className:"py-2.5 px-2 align-top text-right",children:a.jsxs("div",{className:"text-[11px] font-semibold text-slate-900",children:["",(g.total_amount||0).toFixed(2)]})})]},g.id))]})]})})]})]})]})}function n8e(t){if(!t)return"";const n=new Date(t);return`${n.toLocaleDateString()} ${n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`}function r8e(){const[t,n]=b.useState(""),[r,s]=b.useState(""),[i,o]=b.useState(""),[l,c]=b.useState([]),[d,u]=b.useState(!1),h=async()=>{try{u(!0);const g={};t&&(g.q=t),r&&(g.date_from=r),i&&(g.date_to=i);const y=await pde(g);c(y.data||[])}catch{}finally{u(!1)}};b.useEffect(()=>{h()},[]);const m=l.reduce((g,y)=>g+(y.total_amount||0),0);return a.jsxs("div",{className:"p-3 sm:p-4 lg:p-6 space-y-3 sm:space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[a.jsx("div",{className:"inline-flex h-9 w-9 items-center justify-center rounded-2xl bg-slate-900 text-white",children:a.jsx(bc,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-base sm:text-lg font-semibold tracking-tight text-slate-900",children:"Pharmacy Returns"}),a.jsx("p",{className:"text-xs sm:text-sm text-slate-500",children:"Shows Pharmacy bills treated as returns (negative amounts). Later you can connect this to a dedicated return workflow."})]})]}),a.jsxs(Re,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Ye,{className:"pb-2",children:a.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx(ur,{className:"absolute left-2 top-2.5 h-4 w-4 text-slate-400"}),a.jsx(Ne,{placeholder:"UHID / Name / Phone",className:"pl-7 h-9 w-40 sm:w-52",value:t,onChange:g=>n(g.target.value)})]}),a.jsx(Ne,{type:"date",className:"h-9 w-32",value:r,onChange:g=>s(g.target.value)}),a.jsx(Ne,{type:"date",className:"h-9 w-32",value:i,onChange:g=>o(g.target.value)}),a.jsxs(Te,{size:"sm",variant:"outline",className:"h-9 text-xs",onClick:h,disabled:d,children:[d?a.jsx(dr,{className:"mr-1 h-3.5 w-3.5 animate-spin"}):null,"Apply"]})]}),a.jsxs("div",{className:"flex flex-col items-end gap-1 text-right",children:[a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Returns in view"," ",a.jsx(Ge,{variant:"secondary",className:"ml-1 h-5 px-2 text-[10px]",children:l.length})]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Total refund"," ",a.jsxs("span",{className:"font-semibold text-slate-900",children:["",m.toFixed(2)]})]})]})]})}),a.jsxs(Be,{className:"pt-0",children:[a.jsx("div",{className:"border-t border-slate-100 mt-2 mb-2"}),a.jsx("div",{className:"overflow-x-auto -mx-2 sm:mx-0",children:a.jsxs("table",{className:"min-w-full text-xs sm:text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-slate-100 text-[11px] uppercase tracking-wide text-slate-500",children:[a.jsx("th",{className:"py-2 pl-3 pr-2 text-left font-medium",children:"Return"}),a.jsx("th",{className:"py-2 px-2 text-left font-medium",children:"Patient"}),a.jsx("th",{className:"py-2 px-2 text-right font-medium",children:"Amount"})]})}),a.jsxs("tbody",{children:[l.length===0&&!d&&a.jsx("tr",{children:a.jsx("td",{colSpan:3,className:"py-10 text-center text-xs text-slate-500",children:"No Pharmacy returns detected (no negative Pharmacy bills)."})}),d&&a.jsx("tr",{children:a.jsx("td",{colSpan:3,className:"py-8 text-center",children:a.jsx(dr,{className:"mx-auto h-4 w-4 animate-spin text-slate-400"})})}),!d&&l.map(g=>a.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[a.jsx("td",{className:"py-2.5 pl-3 pr-2 align-top",children:a.jsxs("div",{className:"flex flex-col gap-0.5",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(bc,{className:"h-3.5 w-3.5 text-slate-400"}),a.jsxs("span",{className:"font-medium text-[11px] text-slate-800",children:["Return #",g.id]})]}),a.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-500",children:[a.jsx(Hc,{className:"h-3 w-3"}),a.jsx("span",{children:n8e(g.created_at)})]})]})}),a.jsxs("td",{className:"py-2.5 px-2 align-top",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(hi,{className:"h-3.5 w-3.5 text-slate-400"}),a.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:g.patient_name||""})]}),a.jsx("div",{className:"mt-0.5 text-[10px] text-slate-500 flex flex-wrap gap-1",children:g.patient_uhid&&a.jsx(Ge,{variant:"outline",className:"h-4 px-1.5 text-[9px]",children:g.patient_uhid})})]}),a.jsx("td",{className:"py-2.5 px-2 align-top text-right",children:a.jsxs("div",{className:"text-[11px] font-semibold text-red-600",children:["",(g.total_amount||0).toFixed(2)]})})]},g.id))]})]})})]})]})]})}const s8e=[{value:"ALL",label:"All types"},{value:"OPD",label:"OPD"},{value:"IPD",label:"IPD"},{value:"OT",label:"OT"},{value:"COUNTER",label:"Counter"}],ud="ALL_LOC";function a8e(t){const n=Number(t.requested_qty??t.total_qty??t.qty??t.quantity??0),r=Number(t.dispensed_qty??0),s=Math.max(n-r,0);return{requested:n,remaining:s}}function k2(t){const n=Number(t.duration_days||0),r=(t.frequency_code||t.frequency||"").trim();if(!n||!r)return"";const i=r.split("-").map(o=>Number(o||0)).reduce((o,l)=>o+(Number.isFinite(l)?l:0),0);return i?i*n:""}function i8e(){const[t,n]=b.useState("queue"),[r,s]=b.useState("ALL"),[i,o]=b.useState("PENDING"),[l,c]=b.useState(""),[d,u]=b.useState(!1),[h,m]=b.useState([]),[g,y]=b.useState(null),[N,j]=b.useState([]),[S,_]=b.useState(!1),[A,k]=b.useState([]),[T,P]=b.useState(ud);b.useEffect(()=>{async function F(){try{const Q=await Sv(),U=(Q==null?void 0:Q.data)||[];k(U),T||P(ud)}catch{}}F()},[]),b.useEffect(()=>{M()},[r,i,T]);async function M(){try{u(!0);const F={status:i==="ALL"?void 0:i,type:r==="ALL"?void 0:r,limit:100};l.trim()&&(F.q=l.trim()),T&&T!==ud&&(F.location_id=Number(T));const Q=await URe(F);m((Q==null?void 0:Q.data)||[])}catch{}finally{u(!1)}}async function O(F){try{const Q=await wG(F.id),U=(Q==null?void 0:Q.data)||F;y(U);const z=(U.lines||U.items||[]).map(q=>{const{requested:K,remaining:X}=a8e(q);return{...q,requested_qty:K,remaining_qty:X||k2(q)||K,dispense_qty:X||k2(q)||K||""}});j(z),n("dispense")}catch{}}function D(F,Q){j(U=>U.map((z,q)=>q===F?{...z,dispense_qty:Q}:z))}async function L(){var z,q;if(!g)return;const F=N.filter(K=>Number(K.dispense_qty||0)>0);if(!F.length){fe.error("Enter quantity to dispense for at least one line");return}let Q=g.location_id||null;if(T&&T!==ud&&(Q=Number(T)),!Q){fe.error("Select a pharmacy location before dispensing.");return}const U={lines:F.map(K=>({line_id:K.id,dispense_qty:Number(K.dispense_qty||0)})),location_id:Q,create_sale:!0,context_type:(g.type||g.rx_type||"OPD").toUpperCase()};try{_(!0);const K=await zRe(g.id,U),X=(K==null?void 0:K.data)||{};X.sale_id||((z=X.sale)==null?void 0:z.id)||((q=X.pharmacy_sale)==null?void 0:q.id)||X.saleId||null?fe.success("Medicines dispensed and pharmacy bill created"):fe.success("Dispense recorded (no bill returned from server)"),await M(),y(null),j([]),n("queue")}catch(K){console.error("Dispense error",K)}finally{_(!1)}}const $=b.useMemo(()=>N||[],[N]),V=b.useMemo(()=>{if(!(A!=null&&A.length))return"No locations configured";if(!T||T===ud)return"All / Not linked";const F=Number(T),Q=A.find(U=>U.id===F);return Q?Q.name||Q.code||`Location #${Q.id}`:`Location #${F}`},[A,T]);return a.jsxs("div",{className:"p-4 md:p-6 space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-slate-900",children:"Pharmacy Dispense"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Convert prescriptions to pharmacy sales with FEFO-linked inventory and billing."})]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[a.jsx(yL,{className:"w-4 h-4 text-slate-500"}),a.jsx("span",{className:"text-slate-500",children:"Location"}),a.jsxs(Nn,{value:T,onValueChange:F=>P(F||ud),children:[a.jsx(gn,{className:"w-[200px] bg-white border-slate-200 rounded-full h-8 text-[11px]",children:a.jsx(jn,{placeholder:"Select location"})}),a.jsxs(yn,{children:[a.jsx(gt,{value:ud,children:"All / Not linked"}),A.map(F=>a.jsx(gt,{value:String(F.id),children:F.name||F.code||`Location #${F.id}`},F.id))]})]})]})]}),a.jsxs(ko,{value:t,onValueChange:n,children:[a.jsxs(Vi,{className:"mb-4",children:[a.jsx(on,{value:"queue",children:"Dispense Queue"}),a.jsx(on,{value:"dispense",disabled:!g,children:"Selected Rx"})]}),a.jsx(ln,{value:"queue",className:"space-y-3",children:a.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.3fr)_minmax(0,1.7fr)]",children:[a.jsxs(Re,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Ye,{className:"pb-3",children:a.jsxs("div",{className:"flex flex-col gap-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs(Ze,{className:"text-sm font-semibold flex items-center gap-2",children:[a.jsx(tl,{className:"w-4 h-4 text-slate-500"}),"Pending Prescriptions"]}),a.jsx(Te,{variant:"outline",size:"icon",className:"h-8 w-8 rounded-full border-slate-200",onClick:M,children:a.jsx(Ec,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs("div",{className:"relative flex-1",children:[a.jsx(ur,{className:"w-4 h-4 text-slate-400 absolute left-2.5 top-2.5"}),a.jsx(Ne,{value:l,onChange:F=>c(F.target.value),onKeyDown:F=>{F.key==="Enter"&&M()},placeholder:"Search UHID / patient / Rx no...",className:"pl-8 h-9 text-xs bg-white border-slate-200 rounded-full"})]})}),a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsxs(Nn,{value:r,onValueChange:s,children:[a.jsx(gn,{className:"w-[140px] bg-white border-slate-200 rounded-full h-8 text-[11px]",children:a.jsx(jn,{placeholder:"Type"})}),a.jsx(yn,{children:s8e.map(F=>a.jsx(gt,{value:F.value,children:F.label},F.value))})]}),a.jsxs(Nn,{value:i,onValueChange:o,children:[a.jsx(gn,{className:"w-[130px] bg-white border-slate-200 rounded-full h-8 text-[11px]",children:a.jsx(jn,{placeholder:"Status"})}),a.jsxs(yn,{children:[a.jsx(gt,{value:"PENDING",children:"Pending only"}),a.jsx(gt,{value:"ALL",children:"All status"}),a.jsx(gt,{value:"PARTIAL",children:"Partial"}),a.jsx(gt,{value:"DISPENSED",children:"Dispensed"})]})]})]})]})]})}),a.jsx(Be,{className:"pt-0",children:a.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:a.jsx(ra,{className:"max-h-[460px]",children:a.jsxs("table",{className:"w-full text-xs",children:[a.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:a.jsxs("tr",{className:"text-[11px] text-slate-500",children:[a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Rx"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Patient"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Type / Doctor"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Items"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Time"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Action"})]})}),a.jsxs("tbody",{children:[d&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-3 py-5 text-center text-[11px] text-slate-500",children:"Loading queue..."})}),!d&&!h.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-3 py-5 text-center text-[11px] text-slate-500",children:"No prescriptions waiting for dispense."})}),!d&&h.map(F=>{var Se,de,ye;const Q=F.type||F.rx_type||"OPD",U=(F.status||"").toUpperCase()||"PENDING",z=F.created_at||F.rx_datetime||F.bill_date||null,q=z?String(z).slice(0,16).replace("T"," "):"",K=F.patient_name||F.patient_full_name||F.patient_display||F.patient&&`${F.patient.first_name||""} ${F.patient.last_name||""}`.trim()||F.patient||"",X=F.patient_uhid||F.uhid||((Se=F.patient)==null?void 0:Se.uhid)||"",J=F.doctor_name||F.doctor||F.doctor_display||"",ne=((de=F.items)==null?void 0:de.length)||((ye=F.lines)==null?void 0:ye.length)||F.item_count||"";return a.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60 cursor-pointer",onClick:()=>O(F),children:[a.jsx("td",{className:"px-3 py-2 align-middle",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:F.rx_number||F.prescription_number||`RX-${F.id}`}),X&&a.jsxs("span",{className:"text-[10px] text-slate-500",children:["UHID:"," ",X]})]})}),a.jsx("td",{className:"px-3 py-2 align-middle",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-7 h-7 rounded-full bg-slate-100 flex items-center justify-center text-[11px] text-slate-700",children:a.jsx(hi,{className:"w-3 h-3"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[11px] text-slate-900",children:K||""}),X&&a.jsx("div",{className:"text-[10px] text-slate-500",children:X})]})]})}),a.jsx("td",{className:"px-3 py-2 align-middle",children:a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx(Ge,{variant:"outline",className:"border-slate-200 text-[10px] px-1.5 py-0.5 w-max",children:Q}),J&&a.jsxs("span",{className:"text-[10px] text-slate-500 flex items-center gap-1",children:[a.jsx(kn,{className:"w-3 h-3"}),J]})]})}),a.jsx("td",{className:"px-3 py-2 align-middle text-[11px] text-slate-700",children:ne}),a.jsx("td",{className:"px-3 py-2 align-middle text-[11px] text-slate-700",children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Hc,{className:"w-3 h-3 text-slate-400"}),a.jsx("span",{children:q})]})}),a.jsx("td",{className:"px-3 py-2 align-middle text-right",children:a.jsx(o8e,{status:U})})]},F.id)})]})]})})})})]}),a.jsxs(Re,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Ye,{className:"pb-3",children:a.jsxs(Ze,{className:"text-sm font-semibold flex items-center gap-2",children:[a.jsx(gs,{className:"w-4 h-4 text-slate-500"}),"Selected Prescription"]})}),a.jsx(Be,{className:"space-y-3",children:g?a.jsx("div",{className:"space-y-3 text-xs",children:(()=>{var U;const F=g.patient_name||g.patient_full_name||g.patient_display||g.patient&&`${g.patient.first_name||""} ${g.patient.last_name||""}`.trim()||"",Q=g.patient_uhid||g.uhid||((U=g.patient)==null?void 0:U.uhid)||"";return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-slate-900",children:F}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID:"," ",Q]})]}),a.jsxs("div",{className:"text-right text-[11px] text-slate-500",children:["Rx No:"," ",g.rx_number||g.prescription_number||`RX-${g.id}`,a.jsx("br",{}),"Type:"," ",g.type||g.rx_type||"OPD"]})]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Items:"," ",(g.lines||g.items||[]).length||""]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Queue filter:"," ",a.jsx("span",{className:"font-medium text-slate-700",children:V})]}),a.jsxs(Te,{size:"sm",variant:"outline",className:"h-8 px-3 rounded-full text-[11px]",onClick:()=>n("dispense"),children:[a.jsx(Fi,{className:"w-3 h-3 mr-1"}),"Open for dispensing"]})]})})()}):a.jsx("div",{className:"py-8 text-center text-xs text-slate-500",children:"Click a prescription from the queue to start dispensing."})})]})]})}),a.jsx(ln,{value:"dispense",children:g?a.jsxs(Re,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsxs(Ye,{className:"pb-3 flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs(Ze,{className:"text-sm font-semibold flex items-center gap-2",children:[a.jsx(Fi,{className:"w-4 h-4 text-emerald-500"}),"Dispense Medicines"]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Rx:"," ",g.rx_number||g.prescription_number||`RX-${g.id}`," ",""," ",g.type||g.rx_type||"OPD"," ",""," ",g.patient_name||g.patient_full_name||g.patient_display||g.patient&&`${g.patient.first_name||""} ${g.patient.last_name||""}`.trim()||"",a.jsx("br",{}),"Queue filter:"," ",a.jsx("span",{className:"font-medium text-slate-700",children:V})]})]}),a.jsx(Te,{variant:"ghost",size:"sm",className:"h-8 px-3 text-[11px]",onClick:()=>n("queue"),children:"Back to queue"})]}),a.jsxs(Be,{className:"space-y-3",children:[a.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:a.jsx(ra,{className:"max-h-[420px]",children:a.jsxs("table",{className:"w-full text-[11px]",children:[a.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:a.jsxs("tr",{className:"text-[11px] text-slate-500",children:[a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"#"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Medicine"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Instructions"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Prescribed Qty"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Dispense Qty"})]})}),a.jsxs("tbody",{children:[!$.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-3 py-4 text-center text-[11px] text-slate-500",children:"No lines found in this prescription."})}),$.map((F,Q)=>{const U=F.dose_text||F.dose||"",z=F.frequency_code||F.frequency||(Number.isFinite(F.times_per_day)?`${F.times_per_day} times/day`:""),q=F.duration_days?`${F.duration_days} days`:F.duration||"",K=[U,z,q].filter(Boolean).join("  ")||"",X=[F.route,F.timing,F.instructions].filter(Boolean).join("  "),J=F.requested_qty??F.total_qty??F.qty??F.quantity??k2(F)??"";return a.jsxs("tr",{className:"border-t border-slate-100",children:[a.jsx("td",{className:"px-3 py-2 align-top text-slate-500",children:Q+1}),a.jsx("td",{className:"px-3 py-2 align-top",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:F.item_name||F.medicine_name||"Unnamed medicine"}),(F.item_strength||F.strength)&&a.jsx("span",{className:"text-[10px] text-slate-500",children:F.item_strength||F.strength})]})}),a.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{children:K}),X&&a.jsx("span",{className:"text-[10px] text-slate-500",children:X})]})}),a.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:J}),a.jsx("td",{className:"px-3 py-2 align-top text-right",children:a.jsx(Ne,{type:"number",min:"0",value:F.dispense_qty??"",onChange:ne=>D(Q,ne.target.value),className:"h-8 w-20 ml-auto text-[11px] text-right bg-white border-slate-200 rounded-full"})})]},F.id||Q)})]})]})})}),a.jsxs("div",{className:"flex items-center justify-between pt-1",children:[a.jsx("div",{className:"text-[11px] text-slate-500",children:"Only lines with a positive Dispense Qty will create sale items."}),a.jsx(Te,{size:"sm",className:"h-9 px-4 rounded-full",onClick:L,disabled:S,children:S?"Dispensing...":a.jsxs(a.Fragment,{children:[a.jsx(Fi,{className:"w-3.5 h-3.5 mr-1"}),"Confirm Dispense & Generate Bill"]})})]})]})]}):a.jsx(Re,{className:"border-slate-200 rounded-2xl shadow-sm",children:a.jsx(Be,{className:"py-8 text-center text-sm text-slate-500",children:"Select a prescription from the queue to dispense."})})})]})]})}function o8e({status:t}){const n=(t||"").toUpperCase();let r=n,s="bg-slate-50 text-slate-700 border border-slate-200";return n==="PENDING"||n==="NEW"||n==="DRAFT"?(r=n==="DRAFT"?"Draft":"Pending",s="bg-amber-50 text-amber-700 border border-amber-200"):n==="PARTIAL"||n==="PARTIALLY_DISPENSED"?(r="Partial",s="bg-blue-50 text-blue-700 border border-blue-200"):n==="DISPENSED"||n==="COMPLETED"?(r="Dispensed",s="bg-emerald-50 text-emerald-700 border border-emerald-200"):n==="CANCELLED"&&(r="Cancelled",s="bg-rose-50 text-rose-700 border border-rose-200"),a.jsx("span",{className:`inline-flex items-center px-2 py-0.5 text-[10px] rounded-full ${s}`,children:r})}function T2(t){if(!t)return"";const n=new Date(t);return`${n.toLocaleDateString()} ${n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`}function l8e(t){switch(t){case"ISSUED":return{label:"Issued",className:"bg-amber-50 text-amber-700 border border-amber-100",icon:Bi};case"PARTIALLY_DISPENSED":return{label:"Partial",className:"bg-blue-50 text-blue-700 border border-blue-100",icon:Bi};case"DISPENSED":return{label:"Dispensed",className:"bg-emerald-50 text-emerald-700 border border-emerald-100",icon:Fi};case"CANCELLED":return{label:"Cancelled",className:"bg-red-50 text-red-700 border border-red-100",icon:U_};default:return{label:t||"Unknown",className:"bg-slate-50 text-slate-700 border border-slate-100",icon:Bi}}}function c8e(){const[t,n]=b.useState("ALL"),[r,s]=b.useState("ACTIVE"),[i,o]=b.useState("all"),[l,c]=b.useState(""),[d,u]=b.useState(""),[h,m]=b.useState(""),[g,y]=b.useState([]),[N,j]=b.useState([]),[S,_]=b.useState(!1),[A,k]=b.useState(null),[T,P]=b.useState(null),[M,O]=b.useState(null);b.useEffect(()=>{Sv().then(U=>{const z=U.data||[];y(z)}).catch(()=>{y([])})},[]);const D=async()=>{try{_(!0);const U={};t!=="ALL"&&(U.type=t),(r==="ISSUED"||r==="PARTIALLY_DISPENSED"||r==="DISPENSED"||r==="CANCELLED")&&(U.status=r),l.trim()&&(U.patient_id=l.trim()),d&&(U.from_date=d),h&&(U.to_date=h);const z=await ode(U);j(z.data||[])}catch{}finally{_(!1)}};b.useEffect(()=>{D()},[t,r]);const L=b.useMemo(()=>{let U=N||[];return r==="ACTIVE"&&(U=U.filter(z=>z.status==="ISSUED"||z.status==="PARTIALLY_DISPENSED")),i!=="all"&&(U=U.filter(z=>String(z.location_id)===String(i))),U},[N,r,i]);b.useEffect(()=>{if(!L.length){k(null);return}(!A||!L.some(U=>U.id===A))&&k(L[0].id)},[L,A]);const $=b.useMemo(()=>L.find(U=>U.id===A)||null,[L,A]),V=b.useMemo(()=>{const U=L.length,z=L.filter(K=>K.status==="ISSUED"||K.status==="PARTIALLY_DISPENSED").length,q=L.filter(K=>K.status==="DISPENSED").length;return{total:U,active:z,completed:q}},[L]),F=async U=>{if(!U)return;const q=(U.lines||[]).filter(K=>K.status==="WAITING"||K.status==="PARTIAL"||K.status==="PARTIALLY_DISPENSED").map(K=>{const X=Number(K.requested_qty||0),J=Number(K.dispensed_qty||0),ne=X-J;return{line_id:K.id,quantity:ne}}).filter(K=>K.quantity>0);if(!q.length){fe.info("No pending quantity to dispense for this prescription");return}if(window.confirm(`Dispense all remaining quantities (${q.length} line(s)) for Rx #${U.prescription_number||U.id}?`))try{P(U.id),await lde(U.id,{lines:q,remark:"Quick dispense all remaining from Rx Explorer"}),fe.success("Prescription dispensed (remaining quantities)"),await D()}catch{}finally{P(null)}},Q=async U=>{if(U&&window.confirm(`Generate Pharmacy bill from dispensed lines for Rx #${U.prescription_number||U.id}?`))try{O(U.id);const q=(await cde(U.id)).data;fe.success(`Pharmacy bill created: ${q.bill_number} (Net ${q.net_amount})`)}catch{}finally{O(null)}};return a.jsxs("div",{className:"p-3 sm:p-4 lg:p-6 space-y-3 sm:space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[a.jsx("div",{className:"inline-flex h-9 w-9 items-center justify-center rounded-2xl bg-slate-900 text-white",children:a.jsx(gs,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-base sm:text-lg font-semibold tracking-tight text-slate-900",children:"Pharmacy Rx Explorer (Inventory)"}),a.jsx("p",{className:"text-xs sm:text-sm text-slate-500",children:"View, filter, and dispense inventory-integrated prescriptions across OPD/IPD/Counter. Uses FEFO batches and auto-billing."})]})]}),a.jsxs(Re,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Ye,{className:"pb-2",children:a.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4",children:[a.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx(ur,{className:"absolute left-2 top-2.5 h-4 w-4 text-slate-400"}),a.jsx(Ne,{placeholder:"Patient ID (optional)",className:"pl-7 h-9 w-36 sm:w-40",value:l,onChange:U=>c(U.target.value)})]}),a.jsx(Ne,{type:"date",className:"h-9 w-32",value:d,onChange:U=>u(U.target.value)}),a.jsx(Ne,{type:"date",className:"h-9 w-32",value:h,onChange:U=>m(U.target.value)}),a.jsxs(Te,{size:"sm",variant:"outline",className:"h-9 text-xs",onClick:D,disabled:S,children:[S?a.jsx(dr,{className:"mr-1 h-3.5 w-3.5 animate-spin"}):a.jsx(qf,{className:"mr-1 h-3.5 w-3.5"}),"Apply"]})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 justify-end text-[11px] text-slate-500",children:[a.jsxs("div",{children:["Total"," ",a.jsx(Ge,{variant:"secondary",className:"h-5 px-2 text-[10px]",children:V.total})]}),a.jsxs("div",{children:["Active"," ",a.jsx(Ge,{variant:"outline",className:"h-5 px-2 text-[10px]",children:V.active})]}),a.jsxs("div",{children:["Dispensed"," ",a.jsx(Ge,{variant:"outline",className:"h-5 px-2 text-[10px]",children:V.completed})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(ko,{value:t,onValueChange:n,className:"hidden sm:block",children:a.jsxs(Vi,{className:"h-8",children:[a.jsx(on,{value:"ALL",className:"text-[11px]",children:"All"}),a.jsx(on,{value:"OPD",className:"text-[11px]",children:"OPD"}),a.jsx(on,{value:"IPD",className:"text-[11px]",children:"IPD"}),a.jsx(on,{value:"GENERAL",className:"text-[11px]",children:"General"})]})}),a.jsx("div",{className:"sm:hidden flex gap-1 text-[11px]",children:["ALL","OPD","IPD","GENERAL"].map(U=>a.jsx(Ge,{variant:t===U?"default":"outline",className:"cursor-pointer",onClick:()=>n(U),children:U},U))}),a.jsxs("div",{className:"flex flex-wrap items-center gap-1 text-[11px]",children:[a.jsx(Ge,{variant:r==="ACTIVE"?"default":"outline",className:"cursor-pointer",onClick:()=>s("ACTIVE"),children:"Active"}),a.jsx(Ge,{variant:r==="ALL"?"default":"outline",className:"cursor-pointer",onClick:()=>s("ALL"),children:"All"}),a.jsx(Ge,{variant:r==="ISSUED"?"default":"outline",className:"cursor-pointer",onClick:()=>s("ISSUED"),children:"Issued"}),a.jsx(Ge,{variant:r==="PARTIALLY_DISPENSED"?"default":"outline",className:"cursor-pointer",onClick:()=>s("PARTIALLY_DISPENSED"),children:"Partial"}),a.jsx(Ge,{variant:r==="DISPENSED"?"default":"outline",className:"cursor-pointer",onClick:()=>s("DISPENSED"),children:"Dispensed"}),a.jsx(Ge,{variant:r==="CANCELLED"?"default":"outline",className:"cursor-pointer",onClick:()=>s("CANCELLED"),children:"Cancelled"})]})]}),a.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[a.jsxs("span",{className:"text-[11px] text-slate-500 flex items-center gap-1",children:[a.jsx(yL,{className:"h-3 w-3"}),"Location"]}),a.jsxs("select",{className:"h-8 rounded-xl border border-slate-200 bg-white px-2 text-[11px] text-slate-700",value:i,onChange:U=>o(U.target.value),children:[a.jsx("option",{value:"all",children:"All locations"}),g.map(U=>a.jsx("option",{value:U.id,children:U.name},U.id))]})]})]})]})}),a.jsxs(Be,{className:"pt-0",children:[a.jsx("div",{className:"border-t border-slate-100 mt-2 mb-2"}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[minmax(0,1.3fr)_minmax(0,2fr)] gap-3 lg:gap-4",children:[a.jsxs("div",{className:"border border-slate-100 rounded-2xl bg-slate-50/60 overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"px-3 py-2 border-b border-slate-100 flex items-center justify-between",children:[a.jsxs("span",{className:"text-[11px] font-semibold text-slate-700 flex items-center gap-1",children:[a.jsx(gs,{className:"h-3.5 w-3.5 text-slate-500"}),"Prescriptions"]}),a.jsxs("span",{className:"text-[11px] text-slate-500",children:[L.length," in view"]})]}),S&&a.jsx("div",{className:"flex-1 flex items-center justify-center py-10",children:a.jsx(dr,{className:"h-5 w-5 animate-spin text-slate-400"})}),!S&&L.length===0&&a.jsx("div",{className:"flex-1 flex items-center justify-center py-10",children:a.jsx("p",{className:"text-xs text-slate-500",children:"No prescriptions found for this filter."})}),!S&&L.length>0&&a.jsx("div",{className:"flex-1 overflow-y-auto max-h-[520px]",children:L.map(U=>{var X;const z=l8e(U.status),q=U.id===A,K=U.status==="ISSUED"||U.status==="PARTIALLY_DISPENSED";return a.jsxs("button",{type:"button",onClick:()=>k(U.id),className:["w-full text-left px-3 py-2.5 border-b border-slate-100","flex flex-col gap-1.5 hover:bg-slate-100/70",q?"bg-slate-100/80":""].filter(Boolean).join(" "),children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("span",{className:"text-[11px] font-semibold text-slate-900",children:U.prescription_number||`Rx #${U.id}`}),a.jsx(Ge,{variant:"outline",className:"h-4 px-1.5 text-[9px]",children:U.type||""}),K&&a.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 animate-pulse"})]}),a.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-500",children:[a.jsx(Hc,{className:"h-3 w-3"}),a.jsx("span",{children:T2(U.created_at)})]})]}),a.jsxs("div",{className:"flex flex-col items-end gap-1",children:[a.jsxs("div",{className:["inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-[10px]",z.className].join(" "),children:[a.jsx(z.icon,{className:"h-3 w-3"}),a.jsx("span",{children:z.label})]}),a.jsxs("div",{className:"text-[10px] text-slate-500 flex items-center gap-1",children:[a.jsx(fl,{className:"h-3 w-3"}),a.jsx("span",{children:U.location_name||""})]})]})]}),a.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-700",children:[a.jsx(hi,{className:"h-3 w-3 text-slate-400"}),a.jsx("span",{children:U.patient_name||""})]}),U.doctor_name&&a.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-500",children:[a.jsx(kn,{className:"h-3 w-3 text-slate-400"}),a.jsx("span",{children:U.doctor_name})]})]}),a.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2 text-[10px] text-slate-500",children:[a.jsxs("span",{children:[((X=U.lines)==null?void 0:X.length)||0," item(s)"]}),U.status==="DISPENSED"&&a.jsx("span",{children:" Fully dispensed"})]})]},U.id)})})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-white p-3 sm:p-4 flex flex-col min-h-[260px]",children:[!$&&a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx("p",{className:"text-xs text-slate-500",children:"Select a prescription from the left to view details."})}),$&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-2 mb-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:"text-sm font-semibold text-slate-900",children:["Rx ",$.prescription_number||`#${$.id}`]}),a.jsx(Ge,{variant:"outline",className:"h-5 px-2 text-[10px]",children:$.type||""})]}),a.jsxs("div",{className:"text-[11px] text-slate-600 flex flex-wrap items-center gap-1",children:[a.jsx(hi,{className:"h-3 w-3 text-slate-400"}),a.jsx("span",{children:$.patient_name||""}),a.jsx("span",{className:"mx-1",children:""}),a.jsx(kn,{className:"h-3 w-3 text-slate-400"}),a.jsx("span",{children:$.doctor_name||""}),a.jsx("span",{className:"mx-1",children:""}),a.jsx(fl,{className:"h-3 w-3 text-slate-400"}),a.jsx("span",{children:$.location_name||""})]}),a.jsxs("div",{className:"text-[10px] text-slate-500 flex flex-wrap items-center gap-2",children:[a.jsxs("span",{children:["Created: ",T2($.created_at)]}),a.jsx("span",{children:""}),a.jsxs("span",{children:["Updated: ",T2($.updated_at)]})]})]}),a.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-2",children:[a.jsxs(Te,{size:"sm",variant:"outline",className:"h-8 text-[11px]",disabled:T===$.id||$.status==="DISPENSED"||$.status==="CANCELLED",onClick:()=>F($),children:[T===$.id?a.jsx(dr,{className:"mr-1 h-3.5 w-3.5 animate-spin"}):a.jsx(Fi,{className:"mr-1 h-3.5 w-3.5"}),"Quick dispense remaining"]}),a.jsxs(Te,{size:"sm",className:"h-8 text-[11px]",disabled:M===$.id,onClick:()=>Q($),children:[M===$.id?a.jsx(dr,{className:"mr-1 h-3.5 w-3.5 animate-spin"}):a.jsx(d8e,{className:"mr-1 h-3.5 w-3.5"}),"Generate bill"]})]})]}),a.jsx("div",{className:"flex-1 rounded-2xl border border-slate-100 bg-slate-50/60 p-2 sm:p-3 overflow-y-auto max-h-[360px]",children:a.jsxs("table",{className:"w-full text-[11px]",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-slate-200 text-[10px] uppercase tracking-wide text-slate-500",children:[a.jsx("th",{className:"py-1.5 pr-2 text-left font-medium",children:"Item"}),a.jsx("th",{className:"py-1.5 px-2 text-right font-medium",children:"Req"}),a.jsx("th",{className:"py-1.5 px-2 text-right font-medium",children:"Disp"}),a.jsx("th",{className:"py-1.5 px-2 text-right font-medium",children:"Rem"}),a.jsx("th",{className:"py-1.5 pl-2 text-left font-medium",children:"Status"})]})}),a.jsxs("tbody",{children:[($.lines||[]).map(U=>{const z=Number(U.requested_qty||0),q=Number(U.dispensed_qty||0),K=z-q;return a.jsxs("tr",{className:"border-b border-slate-100",children:[a.jsxs("td",{className:"py-1.5 pr-2 align-top",children:[a.jsx("div",{className:"font-medium text-[11px] text-slate-900",children:U.item_name||""}),a.jsxs("div",{className:"text-[10px] text-slate-500",children:[U.item_strength&&a.jsxs("span",{children:[U.item_strength,"  "]}),U.frequency_code||""," ",U.duration_days?` ${U.duration_days} day(s)`:""]})]}),a.jsx("td",{className:"py-1.5 px-2 align-top text-right text-[10px] text-slate-700",children:z}),a.jsx("td",{className:"py-1.5 px-2 align-top text-right text-[10px] text-slate-700",children:q}),a.jsx("td",{className:"py-1.5 px-2 align-top text-right text-[10px] text-slate-700",children:K}),a.jsx("td",{className:"py-1.5 pl-2 align-top text-[10px]",children:a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-white px-2 py-0.5 border border-slate-200 text-slate-700",children:[a.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-slate-400"}),U.status]})})]},U.id)}),(!$.lines||$.lines.length===0)&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"py-4 text-center text-[11px] text-slate-500",children:"No items found in this prescription."})})]})]})}),$.notes&&a.jsxs("div",{className:"mt-2 text-[11px] text-slate-600",children:[a.jsx("span",{className:"font-semibold",children:"Notes:"})," ",$.notes]})]})]})]})]})]})]})}function d8e(t){return a.jsxs("svg",{viewBox:"0 0 24 24",...t,children:[a.jsx("path",{d:"M6 6h15l-1.5 9h-12z",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"}),a.jsx("circle",{cx:"9",cy:"19",r:"1",fill:"currentColor"}),a.jsx("circle",{cx:"17",cy:"19",r:"1",fill:"currentColor"})]})}const I2=()=>({_id:Math.random().toString(36).slice(2),item:null,requestedQty:"",doseText:"",frequency:"",timing:"",durationDays:"",instructions:"",searchQ:"",searchResults:[],searching:!1,showDropdown:!1});function P2(t){return t?t.name||t.item_name||t.brand_name||t.code||`#${t.id}`:""}function lR(t){if(!t)return"";const n=[];return t.code&&n.push(t.code),t.generic_name&&n.push(t.generic_name),t.form&&n.push(t.form),t.strength&&n.push(t.strength),t.pack_size&&n.push(`Pack: ${t.pack_size}`),t.manufacturer&&n.push(t.manufacturer),n.join("  ")}function ew({orderType:t,title:n,subtitle:r,variant:s="page",initialPatientId:i=null,initialPatient:o=null,lockPatient:l=!1,initialLocationId:c="",initialDoctorUserId:d="",initialVisitId:u="",initialIpdAdmissionId:h="",initialContextRef:m=""}){const g=b.useMemo(()=>{switch(t){case"OPD":return"OPD";case"IPD":return"IPD Ward";case"COUNTER":return"Counter / OTC";case"OT_CONSUMABLE":return"OT Consumables";default:return t||"Pharmacy"}},[t]),[y,N]=b.useState([]),[j,S]=b.useState(c||""),[_,A]=b.useState(i),[k,T]=b.useState(o),[P,M]=b.useState(d||""),[O,D]=b.useState(u||""),[L,$]=b.useState(h||""),[V,F]=b.useState(m||""),[Q,U]=b.useState(""),[z,q]=b.useState([I2()]),[K,X]=b.useState(!1);b.useEffect(()=>{i&&!_&&A(i)},[i,_]),b.useEffect(()=>{o&&!k&&T(o)},[o,k]),b.useEffect(()=>{let ie=!0;return(async()=>{try{const pe=await Sv();if(!ie)return;const re=pe.data||[];N(re),!j&&re.length===1&&S(String(re[0].id))}catch{if(!ie)return;N([])}})(),()=>{ie=!1}},[]);const J=(ie,pe)=>{q(re=>re.map(We=>We._id===ie?{...We,...pe}:We))},ne=()=>q(ie=>[...ie,I2()]),Se=ie=>{q(pe=>pe.length===1?pe:pe.filter(re=>re._id!==ie))},de=async(ie,pe)=>{var re;if(J(ie,{searchQ:pe,item:null}),!pe||pe.length<2){J(ie,{searchResults:[],showDropdown:!1});return}J(ie,{searching:!0,showDropdown:!0});try{const We=await Cv({q:pe,page_size:10}),Je=((re=We.data)==null?void 0:re.items)||We.data||[];J(ie,{searchResults:Je})}catch{J(ie,{searchResults:[]})}finally{J(ie,{searching:!1})}},ye=(ie,pe)=>{J(ie,{item:pe,searchQ:"",showDropdown:!1,searchResults:[]})},be=ie=>{setTimeout(()=>{J(ie,{showDropdown:!1})},150)},xe=b.useMemo(()=>{const ie=Number(j),pe=y.find(re=>re.id===ie);return(pe==null?void 0:pe.name)||""},[y,j]),_e=b.useMemo(()=>z.filter(ie=>ie.item&&ie.item.id&&Number(ie.requestedQty||0)>0).map(ie=>{const pe=Number(ie.requestedQty||0),re=ie.durationDays?Number(ie.durationDays):null;return{item_id:ie.item.id,requested_qty:pe,dose_text:ie.doseText||null,frequency_code:ie.frequency||null,timing:ie.timing||null,duration_days:re,instructions:ie.instructions||null}}),[z]),we=_e.length>0,Oe=async()=>{if(!_){fe.error("Please select a patient");return}if(!j){fe.error("Please select Pharmacy location");return}if(!we){fe.error("Add at least one item with quantity");return}const ie=[];Q.trim()&&ie.push(Q.trim()),t==="COUNTER"&&V.trim()&&ie.push(`Counter ref: ${V.trim()}`),t==="OT_CONSUMABLE"&&V.trim()&&ie.push(`OT case: ${V.trim()}`);const pe={type:t,patient_id:_,location_id:Number(j),lines:_e};if(P.trim()){const re=Number(P.trim());Number.isNaN(re)||(pe.doctor_user_id=re)}if(ie.length>0&&(pe.notes=ie.join(" | ")),t==="OPD"&&O.trim()){const re=Number(O.trim());Number.isNaN(re)||(pe.visit_id=re)}if((t==="IPD"||t==="OT_CONSUMABLE")&&L.trim()){const re=Number(L.trim());Number.isNaN(re)||(pe.ipd_admission_id=re)}try{X(!0);const We=(await ide(pe)).data||{},Je=We.prescription_number||We.id||"created";fe.success(`Pharmacy order created (Rx ${Je})`),q([I2()]),U(""),F(m||""),u||D(""),h||$("")}catch{}finally{X(!1)}},ae=a.jsxs(Re,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Ye,{className:"pb-3",children:a.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ge,{variant:"outline",className:"h-6 px-2 text-[10px] uppercase tracking-wide",children:g}),a.jsx("span",{className:"text-xs text-slate-500",children:"Creates a PharmacyPrescription visible in the Pharmacy Rx Explorer."})]}),a.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-slate-500",children:[a.jsx(fl,{className:"h-3.5 w-3.5 text-slate-400"}),a.jsx("span",{children:"Location:"}),a.jsxs("select",{className:"h-7 rounded-xl border border-slate-200 bg-white px-2 text-[11px] text-slate-700",value:j,onChange:ie=>S(ie.target.value),children:[a.jsx("option",{value:"",children:"Select"}),y.map(ie=>a.jsx("option",{value:ie.id,children:ie.name},ie.id))]})]})]})}),a.jsxs(Be,{className:"space-y-4",children:[a.jsxs("div",{className:"grid gap-3 lg:grid-cols-[minmax(0,1.6fr)_minmax(0,1.4fr)]",children:[a.jsx("div",{children:a.jsx(Re,{className:"border-slate-200 rounded-2xl bg-slate-50/70",children:a.jsxs(Be,{className:"p-3 sm:p-4 space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(hi,{className:"h-4 w-4 text-slate-500"}),a.jsx("span",{className:"text-xs font-semibold text-slate-800",children:"Patient"})]}),!l&&a.jsx(yx,{value:_,onChange:(ie,pe)=>{A(ie),T(pe)},label:"Select patient"}),l&&k&&a.jsxs("div",{className:"rounded-xl border bg-white px-3 py-2 text-xs text-slate-700",children:[a.jsxs("div",{className:"font-semibold text-slate-900",children:[k.first_name," ",k.last_name]}),a.jsxs("div",{className:"mt-0.5 text-[11px] text-slate-500 flex flex-wrap gap-1",children:[k.uhid&&a.jsxs(Ge,{variant:"outline",className:"h-4 px-1.5 text-[9px]",children:["UHID ",k.uhid]}),k.phone&&a.jsxs("span",{children:[" ",k.phone]}),a.jsx("span",{children:" Patient fixed from context"})]})]}),!l&&k&&a.jsxs("div",{className:"rounded-xl border bg-slate-50 px-3 py-2 text-[11px] text-slate-700",children:["Selected:"," ",a.jsxs("span",{className:"font-semibold",children:[k.first_name," ",k.last_name]})," ",k.uhid&&a.jsxs(a.Fragment,{children:[" UHID ",k.uhid]}),k.phone&&a.jsxs(a.Fragment,{children:["  ",k.phone]})]})]})})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{className:"border-slate-200 rounded-2xl bg-slate-50/70",children:a.jsxs(Be,{className:"p-3 sm:p-4 space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(kn,{className:"h-4 w-4 text-slate-500"}),a.jsx("span",{className:"text-xs font-semibold text-slate-800",children:"Clinical context"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[t==="OPD"&&a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"OPD Visit ID (optional)"}),a.jsx(Ne,{placeholder:"e.g., 1234",className:"h-8 text-xs",value:O,onChange:ie=>D(ie.target.value)})]}),(t==="IPD"||t==="OT_CONSUMABLE")&&a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"IPD Admission ID (optional)"}),a.jsx(Ne,{placeholder:"e.g., 5678",className:"h-8 text-xs",value:L,onChange:ie=>$(ie.target.value)})]}),t==="COUNTER"&&a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Counter ref / token (optional)"}),a.jsx(Ne,{placeholder:"e.g., Token #15",className:"h-8 text-xs",value:V,onChange:ie=>F(ie.target.value)})]}),t==="OT_CONSUMABLE"&&a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"OT case ref (optional)"}),a.jsx(Ne,{placeholder:"e.g., OT-2025-001",className:"h-8 text-xs",value:V,onChange:ie=>F(ie.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Doctor user ID (optional)"}),a.jsx(Ne,{placeholder:"e.g., 10",className:"h-8 text-xs",value:P,onChange:ie=>M(ie.target.value)}),a.jsx("p",{className:"text-[10px] text-slate-500",children:"Later you can auto-fill from logged-in doctor / visit."})]})]})]})}),k&&a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2 text-[11px] text-slate-700 flex flex-wrap items-center gap-2",children:[a.jsxs("span",{className:"font-semibold",children:[k.first_name," ",k.last_name]}),k.uhid&&a.jsxs(Ge,{variant:"outline",className:"h-4 px-1.5 text-[9px]",children:["UHID ",k.uhid]}),k.phone&&a.jsxs("span",{children:[" ",k.phone]})]})]})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/70 p-2 sm:p-3 space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(gs,{className:"h-4 w-4 text-slate-500"}),a.jsx("span",{className:"text-xs font-semibold text-slate-800",children:"Order lines (medicines / consumables)"})]}),a.jsxs(Te,{size:"sm",variant:"outline",className:"h-7 text-[11px]",onClick:ne,children:[a.jsx(or,{className:"mr-1 h-3.5 w-3.5"}),"Add line"]})]}),a.jsx("div",{className:"overflow-x-auto -mx-1 sm:mx-0",children:a.jsxs("table",{className:"min-w-full text-[11px]",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-slate-200 text-[10px] uppercase tracking-wide text-slate-500",children:[a.jsx("th",{className:"py-1.5 pr-2 text-left font-medium",children:"Item"}),a.jsx("th",{className:"py-1.5 px-2 text-left font-medium",children:"Dose / Frequency"}),a.jsx("th",{className:"py-1.5 px-2 text-left font-medium",children:"Duration"}),a.jsx("th",{className:"py-1.5 px-2 text-right font-medium",children:"Qty"}),a.jsx("th",{className:"py-1.5 pl-2 text-right font-medium w-10"})]})}),a.jsx("tbody",{children:z.map(ie=>a.jsxs("tr",{className:"border-b border-slate-100 align-top",children:[a.jsx("td",{className:"py-2 pr-2 min-w-[220px]",children:a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"relative",children:[a.jsx(ur,{className:"absolute left-2 top-2 h-3.5 w-3.5 text-slate-400"}),a.jsx(Ne,{className:"pl-6 h-8 text-xs",placeholder:ie.item?P2(ie.item):"Search item (name / code / generic)",value:ie.item?P2(ie.item):ie.searchQ,onChange:pe=>de(ie._id,pe.target.value),onFocus:()=>{var pe;return((pe=ie.searchQ)==null?void 0:pe.length)>=2&&J(ie._id,{showDropdown:!0})},onBlur:()=>be(ie._id)}),ie.showDropdown&&(ie.searching||ie.searchResults.length>0)&&a.jsxs("div",{className:"absolute z-30 mt-1 max-h-60 w-full overflow-auto rounded-xl border border-slate-200 bg-white shadow-lg",children:[ie.searching&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-slate-500 flex items-center gap-2",children:[a.jsx(dr,{className:"h-3.5 w-3.5 animate-spin text-slate-400"}),"Searching"]}),!ie.searching&&ie.searchResults.length===0&&a.jsx("div",{className:"px-3 py-2 text-[11px] text-slate-500",children:"No items found."}),!ie.searching&&ie.searchResults.map(pe=>a.jsxs("button",{type:"button",className:"w-full px-3 py-1.5 text-left hover:bg-slate-50",onMouseDown:re=>re.preventDefault(),onClick:()=>ye(ie._id,pe),children:[a.jsx("div",{className:"font-medium text-[11px] text-slate-900",children:P2(pe)}),a.jsx("div",{className:"text-[10px] text-slate-500",children:lR(pe)})]},pe.id))]})]}),ie.item&&a.jsx("div",{className:"rounded-xl bg-white border border-slate-200 px-2 py-1 text-[10px] text-slate-600",children:lR(ie.item)||"Selected from inventory"}),a.jsx(dh,{className:"h-14 text-[11px]",placeholder:"Special instructions (optional)",value:ie.instructions,onChange:pe=>J(ie._id,{instructions:pe.target.value})})]})}),a.jsx("td",{className:"py-2 px-2 min-w-[190px]",children:a.jsxs("div",{className:"space-y-1",children:[a.jsx(Ne,{className:"h-8 text-xs",placeholder:"Dose text (e.g., 1-0-1)",value:ie.doseText,onChange:pe=>J(ie._id,{doseText:pe.target.value})}),a.jsx(Ne,{className:"h-8 text-xs",placeholder:"Frequency (e.g., TDS, BD, HS)",value:ie.frequency,onChange:pe=>J(ie._id,{frequency:pe.target.value})}),a.jsx(Ne,{className:"h-8 text-xs",placeholder:"Timing (e.g., after food)",value:ie.timing,onChange:pe=>J(ie._id,{timing:pe.target.value})})]})}),a.jsxs("td",{className:"py-2 px-2 min-w-[120px]",children:[a.jsx(Ne,{className:"h-8 text-xs",type:"number",min:0,placeholder:"Days",value:ie.durationDays,onChange:pe=>J(ie._id,{durationDays:pe.target.value})}),a.jsx("p",{className:"mt-1 text-[10px] text-slate-500",children:"Later you can auto-calc qty from dose  days."})]}),a.jsx("td",{className:"py-2 px-2 text-right align-top min-w-[80px]",children:a.jsx(Ne,{className:"h-8 text-xs text-right",type:"number",min:0,placeholder:"Qty",value:ie.requestedQty,onChange:pe=>J(ie._id,{requestedQty:pe.target.value})})}),a.jsx("td",{className:"py-2 pl-2 pr-1 align-top text-right",children:a.jsx(Te,{size:"icon",variant:"ghost",className:"h-7 w-7 text-slate-400 hover:text-red-600",onClick:()=>Se(ie._id),children:a.jsx(_l,{className:"h-4 w-4"})})})]},ie._id))})]})}),a.jsxs("div",{className:"mt-1 text-[11px] text-slate-500 flex flex-wrap items-center gap-2",children:[a.jsxs("span",{children:["Valid lines:"," ",a.jsx("span",{className:"font-semibold",children:_e.length})]}),a.jsx("span",{children:""}),a.jsxs("span",{children:["Location:"," ",a.jsx("span",{className:"font-semibold",children:xe})]})]})]}),a.jsxs("div",{className:"grid gap-3 sm:grid-cols-[minmax(0,1.7fr)_minmax(0,1fr)] items-start",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Overall notes (optional)"}),a.jsx(dh,{className:"min-h-[60px] text-[11px]",placeholder:"Any clinical notes for Pharmacy",value:Q,onChange:ie=>U(ie.target.value)})]}),a.jsxs("div",{className:"flex flex-col sm:items-end gap-2",children:[a.jsxs("div",{className:"text-[11px] text-slate-500",children:["This will create a"," ",a.jsx("span",{className:"font-semibold",children:"PharmacyPrescription"})," which appears in the Pharmacy Rx Explorer for dispensing & billing."]}),a.jsxs(Te,{className:"h-9 px-4 text-[11px]",disabled:K,onClick:Oe,children:[K?a.jsx(dr,{className:"mr-1 h-4 w-4 animate-spin"}):a.jsx(gs,{className:"mr-1 h-4 w-4"}),"Save ",g," order"]})]})]})]})]});return s==="embedded"?ae:a.jsxs("div",{className:"p-3 sm:p-4 lg:p-6 space-y-3 sm:space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[a.jsx("div",{className:"inline-flex h-9 w-9 items-center justify-center rounded-2xl bg-slate-900 text-white",children:a.jsx(gs,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-base sm:text-lg font-semibold tracking-tight text-slate-900",children:n}),a.jsx("p",{className:"text-xs sm:text-sm text-slate-500",children:r})]})]}),ae]})}function u8e(){return a.jsx(ew,{orderType:"IPD",title:"IPD Ward Medication Orders",subtitle:"Raise IPD ward medication orders linked to IPD admission. Orders flow to Pharmacy Rx Explorer with ward context."})}function f8e(){return a.jsx(ew,{orderType:"COUNTER",title:"Pharmacy Counter / OTC Orders",subtitle:"Create counter / OTC orders from Inventory medicines. Ideal for walk-in and quick sales via Rx  dispense  bill."})}function h8e(){return a.jsx(ew,{orderType:"OT_CONSUMABLE",title:"OT Consumables Orders",subtitle:"Order OT consumables (sutures, implants, disposables) against IPD admission / OT case. Orders go to Pharmacy / OT store via Rx queue."})}function m8e(){return a.jsx(ew,{orderType:"OPD",title:"OPD Medication Orders",subtitle:"Prescribe medicines for OPD visits from Inventory items. Orders appear in the Pharmacy Rx queue for dispensing and billing."})}function p8e(){const[t,n]=b.useState(null),[r,s]=b.useState(""),[i,o]=b.useState(""),[l]=b.useState("INR"),[c,d]=b.useState(null),[u,h]=b.useState([]),[m,g]=b.useState(!1),[y,N]=b.useState(!1),[j,S]=b.useState(null),_=b.useCallback(M=>{n(M||null)},[]),A=b.useCallback(async()=>{if(!t){h([]),d(null),s(""),o("");return}try{g(!0);const{data:M}=await fce({doctor_user_id:t}),O=M||[];h(O);const D=O[0]||null;d(D||null),D?(s(D.base_fee!==null&&D.base_fee!==void 0?String(D.base_fee):""),o(D.followup_fee!==null&&D.followup_fee!==void 0?String(D.followup_fee):"")):(s(""),o(""))}catch(M){console.error(M),fe.error("Failed to load consultation fees")}finally{g(!1)}},[t]);b.useEffect(()=>{A()},[A]);const k=async M=>{var O,D,L;if((O=M==null?void 0:M.preventDefault)==null||O.call(M),!t){fe.error("Select doctor first");return}if(!r||Number(r)<=0){fe.error("Enter a valid base consultation fee");return}try{N(!0);const $={doctor_user_id:t,base_fee:Number(r),currency:l};if(i&&Number(i)>0&&($.followup_fee=Number(i)),c!=null&&c.id)await aP({...$,id:c.id}),fe.success("Consultation fee updated");else{const{data:V}=await aP($);fe.success("Consultation fee created"),d(V)}A()}catch($){console.error($),fe.error(((L=(D=$==null?void 0:$.response)==null?void 0:D.data)==null?void 0:L.detail)||"Failed to save fee")}finally{N(!1)}},T=async M=>{var O,D;if(window.confirm("Delete this consultation fee?"))try{S(M.id),await pce(M.id),fe.success("Fee deleted"),h(L=>L.filter($=>$.id!==M.id)),(c==null?void 0:c.id)===M.id&&(d(null),s(""),o(""))}catch(L){console.error(L),fe.error(((D=(O=L==null?void 0:L.response)==null?void 0:O.data)==null?void 0:D.detail)||"Failed to delete fee")}finally{S(null)}},P=!!t;return a.jsx("div",{className:"min-h-[calc(100vh-5rem)] bg-slate-50 px-4 py-6 md:px-6",children:a.jsxs("div",{className:"mx-auto max-w-5xl space-y-6",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.2em] text-emerald-700",children:"Billing Masters"}),a.jsx("h1",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"Doctor Consultation Fees"}),a.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Configure standard consultation and follow-up fees for each doctor. These values can be reused during OPD billing and auto-pricing."})]}),a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsx(Ye,{className:"border-b border-slate-100 pb-4",children:a.jsx(Ze,{className:"text-sm font-semibold text-slate-900",children:"Configure Fee"})}),a.jsxs(Be,{className:"space-y-4 pt-4",children:[a.jsxs("div",{className:"grid gap-4 md:grid-cols-[2fr,1.2fr,1.2fr] md:items-end",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:"Doctor"}),a.jsx(Al,{value:t,onChange:_}),!t&&a.jsx("p",{className:"mt-1 text-[11px] text-amber-600",children:"Select a doctor to manage consultation fees."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:["Base consultation fee (",l,")"]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg border border-slate-200 bg-slate-50",children:a.jsx(ho,{className:"h-4 w-4 text-slate-500"})}),a.jsx(Ne,{type:"number",min:0,step:"50",value:r,onChange:M=>s(M.target.value),className:"h-9 text-sm"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:["Follow-up fee (",l,") (optional)"]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg border border-slate-200 bg-slate-50",children:a.jsx(ho,{className:"h-4 w-4 text-slate-500"})}),a.jsx(Ne,{type:"number",min:0,step:"50",value:i,onChange:M=>o(M.target.value),className:"h-9 text-sm"})]}),a.jsx("p",{className:"text-[11px] text-slate-500",children:"Used when visit is marked as a follow-up (if supported by billing rules)."})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(Te,{type:"button",onClick:k,disabled:!P||y,className:"px-5",children:y?"Saving":c?"Update Fee":"Save Fee"})})]})]}),a.jsxs(Re,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsx(Ye,{className:"border-b border-slate-100 pb-3",children:a.jsx(Ze,{className:"text-sm font-semibold text-slate-900",children:"Existing Fees"})}),a.jsxs(Be,{className:"pt-4",children:[m&&a.jsx("div",{className:"space-y-2",children:[1,2].map(M=>a.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-100 bg-slate-50 px-3 py-3",children:[a.jsx(Xe,{className:"h-4 w-32"}),a.jsx(Xe,{className:"h-4 w-24"})]},M))}),!m&&(!u||u.length===0)&&a.jsx("p",{className:"py-6 text-sm text-slate-500",children:"No consultation fee configured yet for this doctor."}),!m&&u&&u.length>0&&a.jsx("div",{className:"space-y-2 text-sm",children:u.map(M=>a.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"font-semibold text-slate-900",children:M.doctor_name||"Selected doctor"}),a.jsx(Ge,{variant:"outline",className:"border-slate-200 bg-slate-50 px-2 py-0.5 text-[11px]",children:M.is_active?"Active":"Inactive"})]}),a.jsx("p",{className:"text-xs text-slate-500",children:"Standard OPD consultation pricing used during billing."})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"text-right text-xs text-slate-600",children:[a.jsxs("div",{className:"font-semibold text-slate-900",children:["Base:",a.jsxs("span",{className:"inline-flex items-center gap-1",children:[a.jsx(ho,{className:"h-3.5 w-3.5 text-slate-500"}),a.jsx("span",{children:M.base_fee})]})]}),a.jsxs("div",{children:["Follow-up:",M.followup_fee!=null?a.jsxs("span",{className:"inline-flex items-center gap-1",children:[a.jsx(ho,{className:"h-3.5 w-3.5 text-slate-500"}),a.jsx("span",{children:M.followup_fee})]}):a.jsx("span",{className:"text-slate-400",children:"Not set"})]})]}),a.jsx(Te,{variant:"ghost",size:"icon",className:"h-8 w-8 text-slate-400 hover:text-rose-600",onClick:()=>T(M),disabled:j===M.id,children:a.jsx(_l,{className:"h-4 w-4"})})]})]},M.id))})]})]})]})})}function x8e(){return b.useEffect(()=>{const n=async()=>{if(localStorage.getItem("access_token"))try{await iL()}catch(i){console.error("Auto token refresh failed",i)}};n();const r=setInterval(n,174e4);return()=>clearInterval(r)},[]),a.jsxs(a.Fragment,{children:[a.jsxs(cQ,{children:[a.jsx(dt,{path:"/auth/login",element:a.jsx(lne,{})}),a.jsx(dt,{path:"/auth/register-admin",element:a.jsx(cne,{})}),a.jsx(dt,{path:"/auth/verify",element:a.jsx(dne,{})}),a.jsx(dt,{element:a.jsx(rle,{}),children:a.jsxs(dt,{element:a.jsx(Goe,{children:a.jsx(nle,{})}),children:[a.jsx(dt,{path:"/admin",element:a.jsx(MD,{})}),a.jsx(dt,{path:"/dashboard",element:a.jsx(MD,{})}),a.jsx(dt,{path:"/admin/roles",element:a.jsx(Roe,{})}),a.jsx(dt,{path:"/admin/permissions",element:a.jsx(Loe,{})}),a.jsx(dt,{path:"/admin/users",element:a.jsx(Boe,{})}),a.jsx(dt,{path:"/admin/departments",element:a.jsx(Ooe,{})}),a.jsx(dt,{path:"/patients",element:a.jsx(UOe,{})}),a.jsx(dt,{path:"/patients/masters",element:a.jsx(HOe,{})}),a.jsx(dt,{path:"/opd/dashboard",element:a.jsx(LDe,{})}),a.jsx(dt,{path:"/opd/schedules",element:a.jsx(sDe,{})}),a.jsx(dt,{path:"/opd/appointments",element:a.jsx(NDe,{})}),a.jsx(dt,{path:"/opd/queue",element:a.jsx(EDe,{})}),a.jsx(dt,{path:"/opd/triage",element:a.jsx(TDe,{})}),a.jsx(dt,{path:"/opd/visit/:id",element:a.jsx(IDe,{})}),a.jsx(dt,{path:"/opd/followups",element:a.jsx(ODe,{})}),a.jsx(dt,{path:"/opd/no-shows",element:a.jsx(RDe,{})}),a.jsx(dt,{path:"/opd/doctor-fees",element:a.jsx(p8e,{})}),a.jsx(dt,{path:"/ipd/admissions",element:a.jsx(bce,{})}),a.jsx(dt,{path:"/ipd/admission/:id",element:a.jsx(Zhe,{})}),a.jsx(dt,{path:"/ipd/tracking",element:a.jsx(Jhe,{})}),a.jsx(dt,{path:"/ipd/my",element:a.jsx(eme,{})}),a.jsx(dt,{path:"/ipd/discharged",element:a.jsx(tme,{})}),a.jsx(dt,{path:"/ipd/bedboard",element:a.jsx(nme,{})}),a.jsx(dt,{path:"/ipd/masters",element:a.jsx(Wle,{})}),a.jsx(dt,{path:"/lab/orders",element:a.jsx(xme,{})}),a.jsx(dt,{path:"/lab/orders/:id",element:a.jsx(yme,{})}),a.jsx(dt,{path:"/lab/masters",element:a.jsx(vme,{})}),a.jsx(dt,{path:"/ris/orders",element:a.jsx(Dme,{})}),a.jsx(dt,{path:"/ris/orders/:id",element:a.jsx(Bme,{})}),a.jsx(dt,{path:"/ris/masters",element:a.jsx(Lme,{})}),a.jsx(dt,{path:"/ot/orders",element:a.jsx(Zme,{})}),a.jsx(dt,{path:"/ot/orders/:id",element:a.jsx(epe,{})}),a.jsx(dt,{path:"/ot/masters",element:a.jsx(tpe,{})}),a.jsx(dt,{path:"/billing",element:a.jsx(eDe,{})}),a.jsx(dt,{path:"/billing/invoices/:invoiceId",element:a.jsx(xpe,{})}),a.jsx(dt,{path:"/emr",element:a.jsx(Ape,{})}),a.jsx(dt,{path:"/templates",element:a.jsx(Lpe,{})}),a.jsx(dt,{path:"/templates/new",element:a.jsx(UM,{mode:"create"})}),a.jsx(dt,{path:"/templates/:id/edit",element:a.jsx(UM,{mode:"edit"})}),a.jsx(dt,{path:"/templates/generate",element:a.jsx(Swe,{})}),a.jsx(dt,{path:"/templates/consents",element:a.jsx(Cwe,{})}),a.jsx(dt,{path:"/settings/branding",element:a.jsx(rDe,{})}),a.jsx(dt,{path:"/mis",element:a.jsx(pOe,{})}),a.jsx(dt,{path:"/pharmacy/inventory",element:a.jsx(QDe,{})}),a.jsx(dt,{path:"/pharmacy/qr-lookup",element:a.jsx(RRe,{})}),a.jsx(dt,{path:"/inventory/barcode-lookup",element:a.jsx(BRe,{})}),a.jsx(dt,{path:"/pharmacy/rx",element:a.jsx(HRe,{})}),a.jsx(dt,{path:"/pharmacy/dispense",element:a.jsx(i8e,{})}),a.jsx(dt,{path:"/pharmacy/billing",element:a.jsx(JRe,{})}),a.jsx(dt,{path:"/pharmacy/sales",element:a.jsx(t8e,{})}),a.jsx(dt,{path:"/pharmacy/returns",element:a.jsx(r8e,{})}),a.jsx(dt,{path:"/pharmacy/rx-explorer",element:a.jsx(c8e,{})}),a.jsx(dt,{path:"/opd/phramacy",element:a.jsx(m8e,{})}),a.jsx(dt,{path:"/ipd/phramacy",element:a.jsx(u8e,{})}),a.jsx(dt,{path:"/counter/phramacy",element:a.jsx(f8e,{})}),a.jsx(dt,{path:"/ot/phramacy",element:a.jsx(h8e,{})})]})}),a.jsx(dt,{path:"*",element:a.jsx(M6,{to:"/auth/login",replace:!0})})]}),a.jsx(jJ,{position:"top-right",richColors:!0,closeButton:!0})]})}const g8e=b.createContext(null);function y8e({children:t,duration:n=3500}){const[r,s]=b.useState([]),i=b.useCallback(c=>{s(d=>d.filter(u=>u.id!==c))},[]),o=b.useCallback((c,d,u={})=>{const h=crypto.randomUUID(),m=u.duration??n;return s(g=>[...g,{id:h,type:c,message:d,duration:m}]),h},[n]),l=b.useMemo(()=>({success:(c,d)=>o("success",c,d),error:(c,d)=>o("error",c,d),warn:(c,d)=>o("warn",c,d),info:(c,d)=>o("info",c,d)}),[o]);return a.jsxs(g8e.Provider,{value:l,children:[t,a.jsx("div",{className:"fixed right-4 top-4 z-[9999] flex w-[min(92vw,380px)] flex-col gap-2",children:r.map(c=>a.jsx(v8e,{toast:c,onClose:()=>i(c.id)},c.id))})]})}function v8e({toast:t,onClose:n}){b.useEffect(()=>{const i=setTimeout(n,t.duration);return()=>clearTimeout(i)},[t.duration,n]);const r={success:"border-emerald-200 bg-emerald-50 text-emerald-800",error:"border-rose-200 bg-rose-50 text-rose-800",warn:"border-amber-200 bg-amber-50 text-amber-800",info:"border-blue-200 bg-blue-50 text-blue-800"}[t.type]??"border-gray-200 bg-white text-gray-800",s={success:Fi,error:U_,warn:wc,info:yp}[t.type]??yp;return a.jsxs("div",{className:`flex items-start gap-3 rounded-xl border p-3 shadow-sm ${r}`,role:"status","aria-live":"polite",children:[a.jsx(s,{className:"mt-0.5 h-5 w-5"}),a.jsx("div",{className:"flex-1 text-sm",children:t.message}),a.jsx("button",{onClick:n,className:"opacity-70 hover:opacity-100","aria-label":"Close",children:a.jsx(La,{className:"h-4 w-4"})})]})}M2.createRoot(document.getElementById("root")).render(a.jsx(ze.StrictMode,{children:a.jsx(y8e,{children:a.jsx(gQ,{children:a.jsx(x8e,{})})})}));
