var jY=Object.defineProperty;var _Y=(t,s,n)=>s in t?jY(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n;var QN=(t,s,n)=>_Y(t,typeof s!="symbol"?s+"":s,n);function T6(t,s){for(var n=0;n<s.length;n++){const a=s[n];if(typeof a!="string"&&!Array.isArray(a)){for(const i in a)if(i!=="default"&&!(i in t)){const l=Object.getOwnPropertyDescriptor(a,i);l&&Object.defineProperty(t,i,l.get?l:{enumerable:!0,get:()=>a[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(i){if(i.ep)return;i.ep=!0;const l=n(i);fetch(i.href,l)}})();var gf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Yi(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var P6={exports:{}},Sb={},I6={exports:{}},is={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Px=Symbol.for("react.element"),SY=Symbol.for("react.portal"),CY=Symbol.for("react.fragment"),kY=Symbol.for("react.strict_mode"),AY=Symbol.for("react.profiler"),EY=Symbol.for("react.provider"),TY=Symbol.for("react.context"),PY=Symbol.for("react.forward_ref"),IY=Symbol.for("react.suspense"),MY=Symbol.for("react.memo"),DY=Symbol.for("react.lazy"),GE=Symbol.iterator;function OY(t){return t===null||typeof t!="object"?null:(t=GE&&t[GE]||t["@@iterator"],typeof t=="function"?t:null)}var M6={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D6=Object.assign,O6={};function Am(t,s,n){this.props=t,this.context=s,this.refs=O6,this.updater=n||M6}Am.prototype.isReactComponent={};Am.prototype.setState=function(t,s){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,s,"setState")};Am.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function R6(){}R6.prototype=Am.prototype;function LC(t,s,n){this.props=t,this.context=s,this.refs=O6,this.updater=n||M6}var BC=LC.prototype=new R6;BC.constructor=LC;D6(BC,Am.prototype);BC.isPureReactComponent=!0;var KE=Array.isArray,L6=Object.prototype.hasOwnProperty,FC={current:null},B6={key:!0,ref:!0,__self:!0,__source:!0};function F6(t,s,n){var a,i={},l=null,o=null;if(s!=null)for(a in s.ref!==void 0&&(o=s.ref),s.key!==void 0&&(l=""+s.key),s)L6.call(s,a)&&!B6.hasOwnProperty(a)&&(i[a]=s[a]);var c=arguments.length-2;if(c===1)i.children=n;else if(1<c){for(var d=Array(c),u=0;u<c;u++)d[u]=arguments[u+2];i.children=d}if(t&&t.defaultProps)for(a in c=t.defaultProps,c)i[a]===void 0&&(i[a]=c[a]);return{$$typeof:Px,type:t,key:l,ref:o,props:i,_owner:FC.current}}function RY(t,s){return{$$typeof:Px,type:t.type,key:s,ref:t.ref,props:t.props,_owner:t._owner}}function $C(t){return typeof t=="object"&&t!==null&&t.$$typeof===Px}function LY(t){var s={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return s[n]})}var YE=/\/+/g;function ZN(t,s){return typeof t=="object"&&t!==null&&t.key!=null?LY(""+t.key):s.toString(36)}function Ug(t,s,n,a,i){var l=typeof t;(l==="undefined"||l==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(l){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Px:case SY:o=!0}}if(o)return o=t,i=i(o),t=a===""?"."+ZN(o,0):a,KE(i)?(n="",t!=null&&(n=t.replace(YE,"$&/")+"/"),Ug(i,s,n,"",function(u){return u})):i!=null&&($C(i)&&(i=RY(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(YE,"$&/")+"/")+t)),s.push(i)),1;if(o=0,a=a===""?".":a+":",KE(t))for(var c=0;c<t.length;c++){l=t[c];var d=a+ZN(l,c);o+=Ug(l,s,n,d,i)}else if(d=OY(t),typeof d=="function")for(t=d.call(t),c=0;!(l=t.next()).done;)l=l.value,d=a+ZN(l,c++),o+=Ug(l,s,n,d,i);else if(l==="object")throw s=String(t),Error("Objects are not valid as a React child (found: "+(s==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":s)+"). If you meant to render a collection of children, use an array instead.");return o}function _0(t,s,n){if(t==null)return t;var a=[],i=0;return Ug(t,a,"","",function(l){return s.call(n,l,i++)}),a}function BY(t){if(t._status===-1){var s=t._result;s=s(),s.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=s)}if(t._status===1)return t._result.default;throw t._result}var ga={current:null},Vg={transition:null},FY={ReactCurrentDispatcher:ga,ReactCurrentBatchConfig:Vg,ReactCurrentOwner:FC};function $6(){throw Error("act(...) is not supported in production builds of React.")}is.Children={map:_0,forEach:function(t,s,n){_0(t,function(){s.apply(this,arguments)},n)},count:function(t){var s=0;return _0(t,function(){s++}),s},toArray:function(t){return _0(t,function(s){return s})||[]},only:function(t){if(!$C(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};is.Component=Am;is.Fragment=CY;is.Profiler=AY;is.PureComponent=LC;is.StrictMode=kY;is.Suspense=IY;is.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FY;is.act=$6;is.cloneElement=function(t,s,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var a=D6({},t.props),i=t.key,l=t.ref,o=t._owner;if(s!=null){if(s.ref!==void 0&&(l=s.ref,o=FC.current),s.key!==void 0&&(i=""+s.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(d in s)L6.call(s,d)&&!B6.hasOwnProperty(d)&&(a[d]=s[d]===void 0&&c!==void 0?c[d]:s[d])}var d=arguments.length-2;if(d===1)a.children=n;else if(1<d){c=Array(d);for(var u=0;u<d;u++)c[u]=arguments[u+2];a.children=c}return{$$typeof:Px,type:t.type,key:i,ref:l,props:a,_owner:o}};is.createContext=function(t){return t={$$typeof:TY,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:EY,_context:t},t.Consumer=t};is.createElement=F6;is.createFactory=function(t){var s=F6.bind(null,t);return s.type=t,s};is.createRef=function(){return{current:null}};is.forwardRef=function(t){return{$$typeof:PY,render:t}};is.isValidElement=$C;is.lazy=function(t){return{$$typeof:DY,_payload:{_status:-1,_result:t},_init:BY}};is.memo=function(t,s){return{$$typeof:MY,type:t,compare:s===void 0?null:s}};is.startTransition=function(t){var s=Vg.transition;Vg.transition={};try{t()}finally{Vg.transition=s}};is.unstable_act=$6;is.useCallback=function(t,s){return ga.current.useCallback(t,s)};is.useContext=function(t){return ga.current.useContext(t)};is.useDebugValue=function(){};is.useDeferredValue=function(t){return ga.current.useDeferredValue(t)};is.useEffect=function(t,s){return ga.current.useEffect(t,s)};is.useId=function(){return ga.current.useId()};is.useImperativeHandle=function(t,s,n){return ga.current.useImperativeHandle(t,s,n)};is.useInsertionEffect=function(t,s){return ga.current.useInsertionEffect(t,s)};is.useLayoutEffect=function(t,s){return ga.current.useLayoutEffect(t,s)};is.useMemo=function(t,s){return ga.current.useMemo(t,s)};is.useReducer=function(t,s,n){return ga.current.useReducer(t,s,n)};is.useRef=function(t){return ga.current.useRef(t)};is.useState=function(t){return ga.current.useState(t)};is.useSyncExternalStore=function(t,s,n){return ga.current.useSyncExternalStore(t,s,n)};is.useTransition=function(){return ga.current.useTransition()};is.version="18.3.1";I6.exports=is;var y=I6.exports;const tt=Yi(y),Cb=T6({__proto__:null,default:tt},[y]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $Y=y,zY=Symbol.for("react.element"),UY=Symbol.for("react.fragment"),VY=Object.prototype.hasOwnProperty,HY=$Y.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,WY={key:!0,ref:!0,__self:!0,__source:!0};function z6(t,s,n){var a,i={},l=null,o=null;n!==void 0&&(l=""+n),s.key!==void 0&&(l=""+s.key),s.ref!==void 0&&(o=s.ref);for(a in s)VY.call(s,a)&&!WY.hasOwnProperty(a)&&(i[a]=s[a]);if(t&&t.defaultProps)for(a in s=t.defaultProps,s)i[a]===void 0&&(i[a]=s[a]);return{$$typeof:zY,type:t,key:l,ref:o,props:i,_owner:HY.current}}Sb.Fragment=UY;Sb.jsx=z6;Sb.jsxs=z6;P6.exports=Sb;var r=P6.exports,C2={},U6={exports:{}},yi={},V6={exports:{}},H6={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function s(G,re){var ye=G.length;G.push(re);e:for(;0<ye;){var Ee=ye-1>>>1,ee=G[Ee];if(0<i(ee,re))G[Ee]=re,G[ye]=ee,ye=Ee;else break e}}function n(G){return G.length===0?null:G[0]}function a(G){if(G.length===0)return null;var re=G[0],ye=G.pop();if(ye!==re){G[0]=ye;e:for(var Ee=0,ee=G.length,te=ee>>>1;Ee<te;){var ce=2*(Ee+1)-1,ge=G[ce],X=ce+1,de=G[X];if(0>i(ge,ye))X<ee&&0>i(de,ge)?(G[Ee]=de,G[X]=ye,Ee=X):(G[Ee]=ge,G[ce]=ye,Ee=ce);else if(X<ee&&0>i(de,ye))G[Ee]=de,G[X]=ye,Ee=X;else break e}}return re}function i(G,re){var ye=G.sortIndex-re.sortIndex;return ye!==0?ye:G.id-re.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var d=[],u=[],h=1,f=null,x=3,b=!1,v=!1,w=!1,_=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(G){for(var re=n(u);re!==null;){if(re.callback===null)a(u);else if(re.startTime<=G)a(u),re.sortIndex=re.expirationTime,s(d,re);else break;re=n(u)}}function T(G){if(w=!1,A(G),!v)if(n(d)!==null)v=!0,H(P);else{var re=n(u);re!==null&&q(T,re.startTime-G)}}function P(G,re){v=!1,w&&(w=!1,S(I),I=-1),b=!0;var ye=x;try{for(A(re),f=n(d);f!==null&&(!(f.expirationTime>re)||G&&!L());){var Ee=f.callback;if(typeof Ee=="function"){f.callback=null,x=f.priorityLevel;var ee=Ee(f.expirationTime<=re);re=t.unstable_now(),typeof ee=="function"?f.callback=ee:f===n(d)&&a(d),A(re)}else a(d);f=n(d)}if(f!==null)var te=!0;else{var ce=n(u);ce!==null&&q(T,ce.startTime-re),te=!1}return te}finally{f=null,x=ye,b=!1}}var O=!1,D=null,I=-1,M=5,B=-1;function L(){return!(t.unstable_now()-B<M)}function F(){if(D!==null){var G=t.unstable_now();B=G;var re=!0;try{re=D(!0,G)}finally{re?V():(O=!1,D=null)}}else O=!1}var V;if(typeof k=="function")V=function(){k(F)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,z=$.port2;$.port1.onmessage=F,V=function(){z.postMessage(null)}}else V=function(){_(F,0)};function H(G){D=G,O||(O=!0,V())}function q(G,re){I=_(function(){G(t.unstable_now())},re)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(G){G.callback=null},t.unstable_continueExecution=function(){v||b||(v=!0,H(P))},t.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<G?Math.floor(1e3/G):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_getFirstCallbackNode=function(){return n(d)},t.unstable_next=function(G){switch(x){case 1:case 2:case 3:var re=3;break;default:re=x}var ye=x;x=re;try{return G()}finally{x=ye}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(G,re){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var ye=x;x=G;try{return re()}finally{x=ye}},t.unstable_scheduleCallback=function(G,re,ye){var Ee=t.unstable_now();switch(typeof ye=="object"&&ye!==null?(ye=ye.delay,ye=typeof ye=="number"&&0<ye?Ee+ye:Ee):ye=Ee,G){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=ye+ee,G={id:h++,callback:re,priorityLevel:G,startTime:ye,expirationTime:ee,sortIndex:-1},ye>Ee?(G.sortIndex=ye,s(u,G),n(d)===null&&G===n(u)&&(w?(S(I),I=-1):w=!0,q(T,ye-Ee))):(G.sortIndex=ee,s(d,G),v||b||(v=!0,H(P))),G},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(G){var re=x;return function(){var ye=x;x=re;try{return G.apply(this,arguments)}finally{x=ye}}}})(H6);V6.exports=H6;var qY=V6.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GY=y,pi=qY;function Je(t){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)s+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var W6=new Set,kp={};function Uu(t,s){Jh(t,s),Jh(t+"Capture",s)}function Jh(t,s){for(kp[t]=s,t=0;t<s.length;t++)W6.add(s[t])}var Bo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),k2=Object.prototype.hasOwnProperty,KY=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,XE={},QE={};function YY(t){return k2.call(QE,t)?!0:k2.call(XE,t)?!1:KY.test(t)?QE[t]=!0:(XE[t]=!0,!1)}function XY(t,s,n,a){if(n!==null&&n.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return a?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function QY(t,s,n,a){if(s===null||typeof s>"u"||XY(t,s,n,a))return!0;if(a)return!1;if(n!==null)switch(n.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function ya(t,s,n,a,i,l,o){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=a,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=s,this.sanitizeURL=l,this.removeEmptyString=o}var Fr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Fr[t]=new ya(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var s=t[0];Fr[s]=new ya(s,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Fr[t]=new ya(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Fr[t]=new ya(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Fr[t]=new ya(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Fr[t]=new ya(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Fr[t]=new ya(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Fr[t]=new ya(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Fr[t]=new ya(t,5,!1,t.toLowerCase(),null,!1,!1)});var zC=/[\-:]([a-z])/g;function UC(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var s=t.replace(zC,UC);Fr[s]=new ya(s,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var s=t.replace(zC,UC);Fr[s]=new ya(s,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var s=t.replace(zC,UC);Fr[s]=new ya(s,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Fr[t]=new ya(t,1,!1,t.toLowerCase(),null,!1,!1)});Fr.xlinkHref=new ya("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Fr[t]=new ya(t,1,!1,t.toLowerCase(),null,!0,!0)});function VC(t,s,n,a){var i=Fr.hasOwnProperty(s)?Fr[s]:null;(i!==null?i.type!==0:a||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(QY(s,n,i,a)&&(n=null),a||i===null?YY(s)&&(n===null?t.removeAttribute(s):t.setAttribute(s,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(s=i.attributeName,a=i.attributeNamespace,n===null?t.removeAttribute(s):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,a?t.setAttributeNS(a,s,n):t.setAttribute(s,n))))}var ec=GY.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,S0=Symbol.for("react.element"),yh=Symbol.for("react.portal"),bh=Symbol.for("react.fragment"),HC=Symbol.for("react.strict_mode"),A2=Symbol.for("react.profiler"),q6=Symbol.for("react.provider"),G6=Symbol.for("react.context"),WC=Symbol.for("react.forward_ref"),E2=Symbol.for("react.suspense"),T2=Symbol.for("react.suspense_list"),qC=Symbol.for("react.memo"),wc=Symbol.for("react.lazy"),K6=Symbol.for("react.offscreen"),ZE=Symbol.iterator;function yf(t){return t===null||typeof t!="object"?null:(t=ZE&&t[ZE]||t["@@iterator"],typeof t=="function"?t:null)}var xn=Object.assign,JN;function Hf(t){if(JN===void 0)try{throw Error()}catch(n){var s=n.stack.trim().match(/\n( *(at )?)/);JN=s&&s[1]||""}return`
`+JN+t}var ew=!1;function tw(t,s){if(!t||ew)return"";ew=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(u){var a=u}Reflect.construct(t,[],s)}else{try{s.call()}catch(u){a=u}t.call(s.prototype)}else{try{throw Error()}catch(u){a=u}t()}}catch(u){if(u&&a&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),l=a.stack.split(`
`),o=i.length-1,c=l.length-1;1<=o&&0<=c&&i[o]!==l[c];)c--;for(;1<=o&&0<=c;o--,c--)if(i[o]!==l[c]){if(o!==1||c!==1)do if(o--,c--,0>c||i[o]!==l[c]){var d=`
`+i[o].replace(" at new "," at ");return t.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",t.displayName)),d}while(1<=o&&0<=c);break}}}finally{ew=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Hf(t):""}function ZY(t){switch(t.tag){case 5:return Hf(t.type);case 16:return Hf("Lazy");case 13:return Hf("Suspense");case 19:return Hf("SuspenseList");case 0:case 2:case 15:return t=tw(t.type,!1),t;case 11:return t=tw(t.type.render,!1),t;case 1:return t=tw(t.type,!0),t;default:return""}}function P2(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case bh:return"Fragment";case yh:return"Portal";case A2:return"Profiler";case HC:return"StrictMode";case E2:return"Suspense";case T2:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case G6:return(t.displayName||"Context")+".Consumer";case q6:return(t._context.displayName||"Context")+".Provider";case WC:var s=t.render;return t=t.displayName,t||(t=s.displayName||s.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case qC:return s=t.displayName||null,s!==null?s:P2(t.type)||"Memo";case wc:s=t._payload,t=t._init;try{return P2(t(s))}catch{}}return null}function JY(t){var s=t.type;switch(t.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=s.render,t=t.displayName||t.name||"",s.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return P2(s);case 8:return s===HC?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function sd(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Y6(t){var s=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function eX(t){var s=Y6(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,s),a=""+t[s];if(!t.hasOwnProperty(s)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,l=n.set;return Object.defineProperty(t,s,{configurable:!0,get:function(){return i.call(this)},set:function(o){a=""+o,l.call(this,o)}}),Object.defineProperty(t,s,{enumerable:n.enumerable}),{getValue:function(){return a},setValue:function(o){a=""+o},stopTracking:function(){t._valueTracker=null,delete t[s]}}}}function C0(t){t._valueTracker||(t._valueTracker=eX(t))}function X6(t){if(!t)return!1;var s=t._valueTracker;if(!s)return!0;var n=s.getValue(),a="";return t&&(a=Y6(t)?t.checked?"true":"false":t.value),t=a,t!==n?(s.setValue(t),!0):!1}function ky(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function I2(t,s){var n=s.checked;return xn({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function JE(t,s){var n=s.defaultValue==null?"":s.defaultValue,a=s.checked!=null?s.checked:s.defaultChecked;n=sd(s.value!=null?s.value:n),t._wrapperState={initialChecked:a,initialValue:n,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function Q6(t,s){s=s.checked,s!=null&&VC(t,"checked",s,!1)}function M2(t,s){Q6(t,s);var n=sd(s.value),a=s.type;if(n!=null)a==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(a==="submit"||a==="reset"){t.removeAttribute("value");return}s.hasOwnProperty("value")?D2(t,s.type,n):s.hasOwnProperty("defaultValue")&&D2(t,s.type,sd(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(t.defaultChecked=!!s.defaultChecked)}function eT(t,s,n){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var a=s.type;if(!(a!=="submit"&&a!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+t._wrapperState.initialValue,n||s===t.value||(t.value=s),t.defaultValue=s}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function D2(t,s,n){(s!=="number"||ky(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Wf=Array.isArray;function $h(t,s,n,a){if(t=t.options,s){s={};for(var i=0;i<n.length;i++)s["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=s.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&a&&(t[n].defaultSelected=!0)}else{for(n=""+sd(n),s=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,a&&(t[i].defaultSelected=!0);return}s!==null||t[i].disabled||(s=t[i])}s!==null&&(s.selected=!0)}}function O2(t,s){if(s.dangerouslySetInnerHTML!=null)throw Error(Je(91));return xn({},s,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function tT(t,s){var n=s.value;if(n==null){if(n=s.children,s=s.defaultValue,n!=null){if(s!=null)throw Error(Je(92));if(Wf(n)){if(1<n.length)throw Error(Je(93));n=n[0]}s=n}s==null&&(s=""),n=s}t._wrapperState={initialValue:sd(n)}}function Z6(t,s){var n=sd(s.value),a=sd(s.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),s.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),a!=null&&(t.defaultValue=""+a)}function sT(t){var s=t.textContent;s===t._wrapperState.initialValue&&s!==""&&s!==null&&(t.value=s)}function J6(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function R2(t,s){return t==null||t==="http://www.w3.org/1999/xhtml"?J6(s):t==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var k0,e8=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,n,a,i){MSApp.execUnsafeLocalFunction(function(){return t(s,n,a,i)})}:t}(function(t,s){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=s;else{for(k0=k0||document.createElement("div"),k0.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=k0.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;s.firstChild;)t.appendChild(s.firstChild)}});function Ap(t,s){if(s){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=s;return}}t.textContent=s}var sp={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},tX=["Webkit","ms","Moz","O"];Object.keys(sp).forEach(function(t){tX.forEach(function(s){s=s+t.charAt(0).toUpperCase()+t.substring(1),sp[s]=sp[t]})});function t8(t,s,n){return s==null||typeof s=="boolean"||s===""?"":n||typeof s!="number"||s===0||sp.hasOwnProperty(t)&&sp[t]?(""+s).trim():s+"px"}function s8(t,s){t=t.style;for(var n in s)if(s.hasOwnProperty(n)){var a=n.indexOf("--")===0,i=t8(n,s[n],a);n==="float"&&(n="cssFloat"),a?t.setProperty(n,i):t[n]=i}}var sX=xn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function L2(t,s){if(s){if(sX[t]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(Je(137,t));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(Je(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(Je(61))}if(s.style!=null&&typeof s.style!="object")throw Error(Je(62))}}function B2(t,s){if(t.indexOf("-")===-1)return typeof s.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var F2=null;function GC(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var $2=null,zh=null,Uh=null;function nT(t){if(t=Dx(t)){if(typeof $2!="function")throw Error(Je(280));var s=t.stateNode;s&&(s=Pb(s),$2(t.stateNode,t.type,s))}}function n8(t){zh?Uh?Uh.push(t):Uh=[t]:zh=t}function r8(){if(zh){var t=zh,s=Uh;if(Uh=zh=null,nT(t),s)for(t=0;t<s.length;t++)nT(s[t])}}function a8(t,s){return t(s)}function i8(){}var sw=!1;function l8(t,s,n){if(sw)return t(s,n);sw=!0;try{return a8(t,s,n)}finally{sw=!1,(zh!==null||Uh!==null)&&(i8(),r8())}}function Ep(t,s){var n=t.stateNode;if(n===null)return null;var a=Pb(n);if(a===null)return null;n=a[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(t=t.type,a=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!a;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Je(231,s,typeof n));return n}var z2=!1;if(Bo)try{var bf={};Object.defineProperty(bf,"passive",{get:function(){z2=!0}}),window.addEventListener("test",bf,bf),window.removeEventListener("test",bf,bf)}catch{z2=!1}function nX(t,s,n,a,i,l,o,c,d){var u=Array.prototype.slice.call(arguments,3);try{s.apply(n,u)}catch(h){this.onError(h)}}var np=!1,Ay=null,Ey=!1,U2=null,rX={onError:function(t){np=!0,Ay=t}};function aX(t,s,n,a,i,l,o,c,d){np=!1,Ay=null,nX.apply(rX,arguments)}function iX(t,s,n,a,i,l,o,c,d){if(aX.apply(this,arguments),np){if(np){var u=Ay;np=!1,Ay=null}else throw Error(Je(198));Ey||(Ey=!0,U2=u)}}function Vu(t){var s=t,n=t;if(t.alternate)for(;s.return;)s=s.return;else{t=s;do s=t,s.flags&4098&&(n=s.return),t=s.return;while(t)}return s.tag===3?n:null}function o8(t){if(t.tag===13){var s=t.memoizedState;if(s===null&&(t=t.alternate,t!==null&&(s=t.memoizedState)),s!==null)return s.dehydrated}return null}function rT(t){if(Vu(t)!==t)throw Error(Je(188))}function lX(t){var s=t.alternate;if(!s){if(s=Vu(t),s===null)throw Error(Je(188));return s!==t?null:t}for(var n=t,a=s;;){var i=n.return;if(i===null)break;var l=i.alternate;if(l===null){if(a=i.return,a!==null){n=a;continue}break}if(i.child===l.child){for(l=i.child;l;){if(l===n)return rT(i),t;if(l===a)return rT(i),s;l=l.sibling}throw Error(Je(188))}if(n.return!==a.return)n=i,a=l;else{for(var o=!1,c=i.child;c;){if(c===n){o=!0,n=i,a=l;break}if(c===a){o=!0,a=i,n=l;break}c=c.sibling}if(!o){for(c=l.child;c;){if(c===n){o=!0,n=l,a=i;break}if(c===a){o=!0,a=l,n=i;break}c=c.sibling}if(!o)throw Error(Je(189))}}if(n.alternate!==a)throw Error(Je(190))}if(n.tag!==3)throw Error(Je(188));return n.stateNode.current===n?t:s}function c8(t){return t=lX(t),t!==null?d8(t):null}function d8(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var s=d8(t);if(s!==null)return s;t=t.sibling}return null}var u8=pi.unstable_scheduleCallback,aT=pi.unstable_cancelCallback,oX=pi.unstable_shouldYield,cX=pi.unstable_requestPaint,Mn=pi.unstable_now,dX=pi.unstable_getCurrentPriorityLevel,KC=pi.unstable_ImmediatePriority,h8=pi.unstable_UserBlockingPriority,Ty=pi.unstable_NormalPriority,uX=pi.unstable_LowPriority,m8=pi.unstable_IdlePriority,kb=null,Jl=null;function hX(t){if(Jl&&typeof Jl.onCommitFiberRoot=="function")try{Jl.onCommitFiberRoot(kb,t,void 0,(t.current.flags&128)===128)}catch{}}var pl=Math.clz32?Math.clz32:pX,mX=Math.log,fX=Math.LN2;function pX(t){return t>>>=0,t===0?32:31-(mX(t)/fX|0)|0}var A0=64,E0=4194304;function qf(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Py(t,s){var n=t.pendingLanes;if(n===0)return 0;var a=0,i=t.suspendedLanes,l=t.pingedLanes,o=n&268435455;if(o!==0){var c=o&~i;c!==0?a=qf(c):(l&=o,l!==0&&(a=qf(l)))}else o=n&~i,o!==0?a=qf(o):l!==0&&(a=qf(l));if(a===0)return 0;if(s!==0&&s!==a&&!(s&i)&&(i=a&-a,l=s&-s,i>=l||i===16&&(l&4194240)!==0))return s;if(a&4&&(a|=n&16),s=t.entangledLanes,s!==0)for(t=t.entanglements,s&=a;0<s;)n=31-pl(s),i=1<<n,a|=t[n],s&=~i;return a}function xX(t,s){switch(t){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function gX(t,s){for(var n=t.suspendedLanes,a=t.pingedLanes,i=t.expirationTimes,l=t.pendingLanes;0<l;){var o=31-pl(l),c=1<<o,d=i[o];d===-1?(!(c&n)||c&a)&&(i[o]=xX(c,s)):d<=s&&(t.expiredLanes|=c),l&=~c}}function V2(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function f8(){var t=A0;return A0<<=1,!(A0&4194240)&&(A0=64),t}function nw(t){for(var s=[],n=0;31>n;n++)s.push(t);return s}function Ix(t,s,n){t.pendingLanes|=s,s!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,s=31-pl(s),t[s]=n}function yX(t,s){var n=t.pendingLanes&~s;t.pendingLanes=s,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=s,t.mutableReadLanes&=s,t.entangledLanes&=s,s=t.entanglements;var a=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-pl(n),l=1<<i;s[i]=0,a[i]=-1,t[i]=-1,n&=~l}}function YC(t,s){var n=t.entangledLanes|=s;for(t=t.entanglements;n;){var a=31-pl(n),i=1<<a;i&s|t[a]&s&&(t[a]|=s),n&=~i}}var Ss=0;function p8(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var x8,XC,g8,y8,b8,H2=!1,T0=[],Vc=null,Hc=null,Wc=null,Tp=new Map,Pp=new Map,Ac=[],bX="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function iT(t,s){switch(t){case"focusin":case"focusout":Vc=null;break;case"dragenter":case"dragleave":Hc=null;break;case"mouseover":case"mouseout":Wc=null;break;case"pointerover":case"pointerout":Tp.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pp.delete(s.pointerId)}}function vf(t,s,n,a,i,l){return t===null||t.nativeEvent!==l?(t={blockedOn:s,domEventName:n,eventSystemFlags:a,nativeEvent:l,targetContainers:[i]},s!==null&&(s=Dx(s),s!==null&&XC(s)),t):(t.eventSystemFlags|=a,s=t.targetContainers,i!==null&&s.indexOf(i)===-1&&s.push(i),t)}function vX(t,s,n,a,i){switch(s){case"focusin":return Vc=vf(Vc,t,s,n,a,i),!0;case"dragenter":return Hc=vf(Hc,t,s,n,a,i),!0;case"mouseover":return Wc=vf(Wc,t,s,n,a,i),!0;case"pointerover":var l=i.pointerId;return Tp.set(l,vf(Tp.get(l)||null,t,s,n,a,i)),!0;case"gotpointercapture":return l=i.pointerId,Pp.set(l,vf(Pp.get(l)||null,t,s,n,a,i)),!0}return!1}function v8(t){var s=qd(t.target);if(s!==null){var n=Vu(s);if(n!==null){if(s=n.tag,s===13){if(s=o8(n),s!==null){t.blockedOn=s,b8(t.priority,function(){g8(n)});return}}else if(s===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Hg(t){if(t.blockedOn!==null)return!1;for(var s=t.targetContainers;0<s.length;){var n=W2(t.domEventName,t.eventSystemFlags,s[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var a=new n.constructor(n.type,n);F2=a,n.target.dispatchEvent(a),F2=null}else return s=Dx(n),s!==null&&XC(s),t.blockedOn=n,!1;s.shift()}return!0}function lT(t,s,n){Hg(t)&&n.delete(s)}function NX(){H2=!1,Vc!==null&&Hg(Vc)&&(Vc=null),Hc!==null&&Hg(Hc)&&(Hc=null),Wc!==null&&Hg(Wc)&&(Wc=null),Tp.forEach(lT),Pp.forEach(lT)}function Nf(t,s){t.blockedOn===s&&(t.blockedOn=null,H2||(H2=!0,pi.unstable_scheduleCallback(pi.unstable_NormalPriority,NX)))}function Ip(t){function s(i){return Nf(i,t)}if(0<T0.length){Nf(T0[0],t);for(var n=1;n<T0.length;n++){var a=T0[n];a.blockedOn===t&&(a.blockedOn=null)}}for(Vc!==null&&Nf(Vc,t),Hc!==null&&Nf(Hc,t),Wc!==null&&Nf(Wc,t),Tp.forEach(s),Pp.forEach(s),n=0;n<Ac.length;n++)a=Ac[n],a.blockedOn===t&&(a.blockedOn=null);for(;0<Ac.length&&(n=Ac[0],n.blockedOn===null);)v8(n),n.blockedOn===null&&Ac.shift()}var Vh=ec.ReactCurrentBatchConfig,Iy=!0;function wX(t,s,n,a){var i=Ss,l=Vh.transition;Vh.transition=null;try{Ss=1,QC(t,s,n,a)}finally{Ss=i,Vh.transition=l}}function jX(t,s,n,a){var i=Ss,l=Vh.transition;Vh.transition=null;try{Ss=4,QC(t,s,n,a)}finally{Ss=i,Vh.transition=l}}function QC(t,s,n,a){if(Iy){var i=W2(t,s,n,a);if(i===null)mw(t,s,a,My,n),iT(t,a);else if(vX(i,t,s,n,a))a.stopPropagation();else if(iT(t,a),s&4&&-1<bX.indexOf(t)){for(;i!==null;){var l=Dx(i);if(l!==null&&x8(l),l=W2(t,s,n,a),l===null&&mw(t,s,a,My,n),l===i)break;i=l}i!==null&&a.stopPropagation()}else mw(t,s,a,null,n)}}var My=null;function W2(t,s,n,a){if(My=null,t=GC(a),t=qd(t),t!==null)if(s=Vu(t),s===null)t=null;else if(n=s.tag,n===13){if(t=o8(s),t!==null)return t;t=null}else if(n===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;t=null}else s!==t&&(t=null);return My=t,null}function N8(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dX()){case KC:return 1;case h8:return 4;case Ty:case uX:return 16;case m8:return 536870912;default:return 16}default:return 16}}var Lc=null,ZC=null,Wg=null;function w8(){if(Wg)return Wg;var t,s=ZC,n=s.length,a,i="value"in Lc?Lc.value:Lc.textContent,l=i.length;for(t=0;t<n&&s[t]===i[t];t++);var o=n-t;for(a=1;a<=o&&s[n-a]===i[l-a];a++);return Wg=i.slice(t,1<a?1-a:void 0)}function qg(t){var s=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&s===13&&(t=13)):t=s,t===10&&(t=13),32<=t||t===13?t:0}function P0(){return!0}function oT(){return!1}function bi(t){function s(n,a,i,l,o){this._reactName=n,this._targetInst=i,this.type=a,this.nativeEvent=l,this.target=o,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(l):l[c]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?P0:oT,this.isPropagationStopped=oT,this}return xn(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=P0)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=P0)},persist:function(){},isPersistent:P0}),s}var Em={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},JC=bi(Em),Mx=xn({},Em,{view:0,detail:0}),_X=bi(Mx),rw,aw,wf,Ab=xn({},Mx,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:e3,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==wf&&(wf&&t.type==="mousemove"?(rw=t.screenX-wf.screenX,aw=t.screenY-wf.screenY):aw=rw=0,wf=t),rw)},movementY:function(t){return"movementY"in t?t.movementY:aw}}),cT=bi(Ab),SX=xn({},Ab,{dataTransfer:0}),CX=bi(SX),kX=xn({},Mx,{relatedTarget:0}),iw=bi(kX),AX=xn({},Em,{animationName:0,elapsedTime:0,pseudoElement:0}),EX=bi(AX),TX=xn({},Em,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),PX=bi(TX),IX=xn({},Em,{data:0}),dT=bi(IX),MX={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},DX={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},OX={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function RX(t){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(t):(t=OX[t])?!!s[t]:!1}function e3(){return RX}var LX=xn({},Mx,{key:function(t){if(t.key){var s=MX[t.key]||t.key;if(s!=="Unidentified")return s}return t.type==="keypress"?(t=qg(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?DX[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:e3,charCode:function(t){return t.type==="keypress"?qg(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?qg(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),BX=bi(LX),FX=xn({},Ab,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),uT=bi(FX),$X=xn({},Mx,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:e3}),zX=bi($X),UX=xn({},Em,{propertyName:0,elapsedTime:0,pseudoElement:0}),VX=bi(UX),HX=xn({},Ab,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),WX=bi(HX),qX=[9,13,27,32],t3=Bo&&"CompositionEvent"in window,rp=null;Bo&&"documentMode"in document&&(rp=document.documentMode);var GX=Bo&&"TextEvent"in window&&!rp,j8=Bo&&(!t3||rp&&8<rp&&11>=rp),hT=" ",mT=!1;function _8(t,s){switch(t){case"keyup":return qX.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function S8(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var vh=!1;function KX(t,s){switch(t){case"compositionend":return S8(s);case"keypress":return s.which!==32?null:(mT=!0,hT);case"textInput":return t=s.data,t===hT&&mT?null:t;default:return null}}function YX(t,s){if(vh)return t==="compositionend"||!t3&&_8(t,s)?(t=w8(),Wg=ZC=Lc=null,vh=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return j8&&s.locale!=="ko"?null:s.data;default:return null}}var XX={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fT(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s==="input"?!!XX[t.type]:s==="textarea"}function C8(t,s,n,a){n8(a),s=Dy(s,"onChange"),0<s.length&&(n=new JC("onChange","change",null,n,a),t.push({event:n,listeners:s}))}var ap=null,Mp=null;function QX(t){L8(t,0)}function Eb(t){var s=jh(t);if(X6(s))return t}function ZX(t,s){if(t==="change")return s}var k8=!1;if(Bo){var lw;if(Bo){var ow="oninput"in document;if(!ow){var pT=document.createElement("div");pT.setAttribute("oninput","return;"),ow=typeof pT.oninput=="function"}lw=ow}else lw=!1;k8=lw&&(!document.documentMode||9<document.documentMode)}function xT(){ap&&(ap.detachEvent("onpropertychange",A8),Mp=ap=null)}function A8(t){if(t.propertyName==="value"&&Eb(Mp)){var s=[];C8(s,Mp,t,GC(t)),l8(QX,s)}}function JX(t,s,n){t==="focusin"?(xT(),ap=s,Mp=n,ap.attachEvent("onpropertychange",A8)):t==="focusout"&&xT()}function eQ(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Eb(Mp)}function tQ(t,s){if(t==="click")return Eb(s)}function sQ(t,s){if(t==="input"||t==="change")return Eb(s)}function nQ(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var yl=typeof Object.is=="function"?Object.is:nQ;function Dp(t,s){if(yl(t,s))return!0;if(typeof t!="object"||t===null||typeof s!="object"||s===null)return!1;var n=Object.keys(t),a=Object.keys(s);if(n.length!==a.length)return!1;for(a=0;a<n.length;a++){var i=n[a];if(!k2.call(s,i)||!yl(t[i],s[i]))return!1}return!0}function gT(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function yT(t,s){var n=gT(t);t=0;for(var a;n;){if(n.nodeType===3){if(a=t+n.textContent.length,t<=s&&a>=s)return{node:n,offset:s-t};t=a}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=gT(n)}}function E8(t,s){return t&&s?t===s?!0:t&&t.nodeType===3?!1:s&&s.nodeType===3?E8(t,s.parentNode):"contains"in t?t.contains(s):t.compareDocumentPosition?!!(t.compareDocumentPosition(s)&16):!1:!1}function T8(){for(var t=window,s=ky();s instanceof t.HTMLIFrameElement;){try{var n=typeof s.contentWindow.location.href=="string"}catch{n=!1}if(n)t=s.contentWindow;else break;s=ky(t.document)}return s}function s3(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s&&(s==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||s==="textarea"||t.contentEditable==="true")}function rQ(t){var s=T8(),n=t.focusedElem,a=t.selectionRange;if(s!==n&&n&&n.ownerDocument&&E8(n.ownerDocument.documentElement,n)){if(a!==null&&s3(n)){if(s=a.start,t=a.end,t===void 0&&(t=s),"selectionStart"in n)n.selectionStart=s,n.selectionEnd=Math.min(t,n.value.length);else if(t=(s=n.ownerDocument||document)&&s.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,l=Math.min(a.start,i);a=a.end===void 0?l:Math.min(a.end,i),!t.extend&&l>a&&(i=a,a=l,l=i),i=yT(n,l);var o=yT(n,a);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(s=s.createRange(),s.setStart(i.node,i.offset),t.removeAllRanges(),l>a?(t.addRange(s),t.extend(o.node,o.offset)):(s.setEnd(o.node,o.offset),t.addRange(s)))}}for(s=[],t=n;t=t.parentNode;)t.nodeType===1&&s.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<s.length;n++)t=s[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var aQ=Bo&&"documentMode"in document&&11>=document.documentMode,Nh=null,q2=null,ip=null,G2=!1;function bT(t,s,n){var a=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;G2||Nh==null||Nh!==ky(a)||(a=Nh,"selectionStart"in a&&s3(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),ip&&Dp(ip,a)||(ip=a,a=Dy(q2,"onSelect"),0<a.length&&(s=new JC("onSelect","select",null,s,n),t.push({event:s,listeners:a}),s.target=Nh)))}function I0(t,s){var n={};return n[t.toLowerCase()]=s.toLowerCase(),n["Webkit"+t]="webkit"+s,n["Moz"+t]="moz"+s,n}var wh={animationend:I0("Animation","AnimationEnd"),animationiteration:I0("Animation","AnimationIteration"),animationstart:I0("Animation","AnimationStart"),transitionend:I0("Transition","TransitionEnd")},cw={},P8={};Bo&&(P8=document.createElement("div").style,"AnimationEvent"in window||(delete wh.animationend.animation,delete wh.animationiteration.animation,delete wh.animationstart.animation),"TransitionEvent"in window||delete wh.transitionend.transition);function Tb(t){if(cw[t])return cw[t];if(!wh[t])return t;var s=wh[t],n;for(n in s)if(s.hasOwnProperty(n)&&n in P8)return cw[t]=s[n];return t}var I8=Tb("animationend"),M8=Tb("animationiteration"),D8=Tb("animationstart"),O8=Tb("transitionend"),R8=new Map,vT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function hd(t,s){R8.set(t,s),Uu(s,[t])}for(var dw=0;dw<vT.length;dw++){var uw=vT[dw],iQ=uw.toLowerCase(),lQ=uw[0].toUpperCase()+uw.slice(1);hd(iQ,"on"+lQ)}hd(I8,"onAnimationEnd");hd(M8,"onAnimationIteration");hd(D8,"onAnimationStart");hd("dblclick","onDoubleClick");hd("focusin","onFocus");hd("focusout","onBlur");hd(O8,"onTransitionEnd");Jh("onMouseEnter",["mouseout","mouseover"]);Jh("onMouseLeave",["mouseout","mouseover"]);Jh("onPointerEnter",["pointerout","pointerover"]);Jh("onPointerLeave",["pointerout","pointerover"]);Uu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Uu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Uu("onBeforeInput",["compositionend","keypress","textInput","paste"]);Uu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Uu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Uu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),oQ=new Set("cancel close invalid load scroll toggle".split(" ").concat(Gf));function NT(t,s,n){var a=t.type||"unknown-event";t.currentTarget=n,iX(a,s,void 0,t),t.currentTarget=null}function L8(t,s){s=(s&4)!==0;for(var n=0;n<t.length;n++){var a=t[n],i=a.event;a=a.listeners;e:{var l=void 0;if(s)for(var o=a.length-1;0<=o;o--){var c=a[o],d=c.instance,u=c.currentTarget;if(c=c.listener,d!==l&&i.isPropagationStopped())break e;NT(i,c,u),l=d}else for(o=0;o<a.length;o++){if(c=a[o],d=c.instance,u=c.currentTarget,c=c.listener,d!==l&&i.isPropagationStopped())break e;NT(i,c,u),l=d}}}if(Ey)throw t=U2,Ey=!1,U2=null,t}function Gs(t,s){var n=s[Z2];n===void 0&&(n=s[Z2]=new Set);var a=t+"__bubble";n.has(a)||(B8(s,t,2,!1),n.add(a))}function hw(t,s,n){var a=0;s&&(a|=4),B8(n,t,a,s)}var M0="_reactListening"+Math.random().toString(36).slice(2);function Op(t){if(!t[M0]){t[M0]=!0,W6.forEach(function(n){n!=="selectionchange"&&(oQ.has(n)||hw(n,!1,t),hw(n,!0,t))});var s=t.nodeType===9?t:t.ownerDocument;s===null||s[M0]||(s[M0]=!0,hw("selectionchange",!1,s))}}function B8(t,s,n,a){switch(N8(s)){case 1:var i=wX;break;case 4:i=jX;break;default:i=QC}n=i.bind(null,s,n,t),i=void 0,!z2||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(i=!0),a?i!==void 0?t.addEventListener(s,n,{capture:!0,passive:i}):t.addEventListener(s,n,!0):i!==void 0?t.addEventListener(s,n,{passive:i}):t.addEventListener(s,n,!1)}function mw(t,s,n,a,i){var l=a;if(!(s&1)&&!(s&2)&&a!==null)e:for(;;){if(a===null)return;var o=a.tag;if(o===3||o===4){var c=a.stateNode.containerInfo;if(c===i||c.nodeType===8&&c.parentNode===i)break;if(o===4)for(o=a.return;o!==null;){var d=o.tag;if((d===3||d===4)&&(d=o.stateNode.containerInfo,d===i||d.nodeType===8&&d.parentNode===i))return;o=o.return}for(;c!==null;){if(o=qd(c),o===null)return;if(d=o.tag,d===5||d===6){a=l=o;continue e}c=c.parentNode}}a=a.return}l8(function(){var u=l,h=GC(n),f=[];e:{var x=R8.get(t);if(x!==void 0){var b=JC,v=t;switch(t){case"keypress":if(qg(n)===0)break e;case"keydown":case"keyup":b=BX;break;case"focusin":v="focus",b=iw;break;case"focusout":v="blur",b=iw;break;case"beforeblur":case"afterblur":b=iw;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":b=cT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":b=CX;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":b=zX;break;case I8:case M8:case D8:b=EX;break;case O8:b=VX;break;case"scroll":b=_X;break;case"wheel":b=WX;break;case"copy":case"cut":case"paste":b=PX;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":b=uT}var w=(s&4)!==0,_=!w&&t==="scroll",S=w?x!==null?x+"Capture":null:x;w=[];for(var k=u,A;k!==null;){A=k;var T=A.stateNode;if(A.tag===5&&T!==null&&(A=T,S!==null&&(T=Ep(k,S),T!=null&&w.push(Rp(k,T,A)))),_)break;k=k.return}0<w.length&&(x=new b(x,v,null,n,h),f.push({event:x,listeners:w}))}}if(!(s&7)){e:{if(x=t==="mouseover"||t==="pointerover",b=t==="mouseout"||t==="pointerout",x&&n!==F2&&(v=n.relatedTarget||n.fromElement)&&(qd(v)||v[Fo]))break e;if((b||x)&&(x=h.window===h?h:(x=h.ownerDocument)?x.defaultView||x.parentWindow:window,b?(v=n.relatedTarget||n.toElement,b=u,v=v?qd(v):null,v!==null&&(_=Vu(v),v!==_||v.tag!==5&&v.tag!==6)&&(v=null)):(b=null,v=u),b!==v)){if(w=cT,T="onMouseLeave",S="onMouseEnter",k="mouse",(t==="pointerout"||t==="pointerover")&&(w=uT,T="onPointerLeave",S="onPointerEnter",k="pointer"),_=b==null?x:jh(b),A=v==null?x:jh(v),x=new w(T,k+"leave",b,n,h),x.target=_,x.relatedTarget=A,T=null,qd(h)===u&&(w=new w(S,k+"enter",v,n,h),w.target=A,w.relatedTarget=_,T=w),_=T,b&&v)t:{for(w=b,S=v,k=0,A=w;A;A=ih(A))k++;for(A=0,T=S;T;T=ih(T))A++;for(;0<k-A;)w=ih(w),k--;for(;0<A-k;)S=ih(S),A--;for(;k--;){if(w===S||S!==null&&w===S.alternate)break t;w=ih(w),S=ih(S)}w=null}else w=null;b!==null&&wT(f,x,b,w,!1),v!==null&&_!==null&&wT(f,_,v,w,!0)}}e:{if(x=u?jh(u):window,b=x.nodeName&&x.nodeName.toLowerCase(),b==="select"||b==="input"&&x.type==="file")var P=ZX;else if(fT(x))if(k8)P=sQ;else{P=eQ;var O=JX}else(b=x.nodeName)&&b.toLowerCase()==="input"&&(x.type==="checkbox"||x.type==="radio")&&(P=tQ);if(P&&(P=P(t,u))){C8(f,P,n,h);break e}O&&O(t,x,u),t==="focusout"&&(O=x._wrapperState)&&O.controlled&&x.type==="number"&&D2(x,"number",x.value)}switch(O=u?jh(u):window,t){case"focusin":(fT(O)||O.contentEditable==="true")&&(Nh=O,q2=u,ip=null);break;case"focusout":ip=q2=Nh=null;break;case"mousedown":G2=!0;break;case"contextmenu":case"mouseup":case"dragend":G2=!1,bT(f,n,h);break;case"selectionchange":if(aQ)break;case"keydown":case"keyup":bT(f,n,h)}var D;if(t3)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else vh?_8(t,n)&&(I="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(j8&&n.locale!=="ko"&&(vh||I!=="onCompositionStart"?I==="onCompositionEnd"&&vh&&(D=w8()):(Lc=h,ZC="value"in Lc?Lc.value:Lc.textContent,vh=!0)),O=Dy(u,I),0<O.length&&(I=new dT(I,t,null,n,h),f.push({event:I,listeners:O}),D?I.data=D:(D=S8(n),D!==null&&(I.data=D)))),(D=GX?KX(t,n):YX(t,n))&&(u=Dy(u,"onBeforeInput"),0<u.length&&(h=new dT("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:u}),h.data=D))}L8(f,s)})}function Rp(t,s,n){return{instance:t,listener:s,currentTarget:n}}function Dy(t,s){for(var n=s+"Capture",a=[];t!==null;){var i=t,l=i.stateNode;i.tag===5&&l!==null&&(i=l,l=Ep(t,n),l!=null&&a.unshift(Rp(t,l,i)),l=Ep(t,s),l!=null&&a.push(Rp(t,l,i))),t=t.return}return a}function ih(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function wT(t,s,n,a,i){for(var l=s._reactName,o=[];n!==null&&n!==a;){var c=n,d=c.alternate,u=c.stateNode;if(d!==null&&d===a)break;c.tag===5&&u!==null&&(c=u,i?(d=Ep(n,l),d!=null&&o.unshift(Rp(n,d,c))):i||(d=Ep(n,l),d!=null&&o.push(Rp(n,d,c)))),n=n.return}o.length!==0&&t.push({event:s,listeners:o})}var cQ=/\r\n?/g,dQ=/\u0000|\uFFFD/g;function jT(t){return(typeof t=="string"?t:""+t).replace(cQ,`
`).replace(dQ,"")}function D0(t,s,n){if(s=jT(s),jT(t)!==s&&n)throw Error(Je(425))}function Oy(){}var K2=null,Y2=null;function X2(t,s){return t==="textarea"||t==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Q2=typeof setTimeout=="function"?setTimeout:void 0,uQ=typeof clearTimeout=="function"?clearTimeout:void 0,_T=typeof Promise=="function"?Promise:void 0,hQ=typeof queueMicrotask=="function"?queueMicrotask:typeof _T<"u"?function(t){return _T.resolve(null).then(t).catch(mQ)}:Q2;function mQ(t){setTimeout(function(){throw t})}function fw(t,s){var n=s,a=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(a===0){t.removeChild(i),Ip(s);return}a--}else n!=="$"&&n!=="$?"&&n!=="$!"||a++;n=i}while(n);Ip(s)}function qc(t){for(;t!=null;t=t.nextSibling){var s=t.nodeType;if(s===1||s===3)break;if(s===8){if(s=t.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return t}function ST(t){t=t.previousSibling;for(var s=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(s===0)return t;s--}else n==="/$"&&s++}t=t.previousSibling}return null}var Tm=Math.random().toString(36).slice(2),ql="__reactFiber$"+Tm,Lp="__reactProps$"+Tm,Fo="__reactContainer$"+Tm,Z2="__reactEvents$"+Tm,fQ="__reactListeners$"+Tm,pQ="__reactHandles$"+Tm;function qd(t){var s=t[ql];if(s)return s;for(var n=t.parentNode;n;){if(s=n[Fo]||n[ql]){if(n=s.alternate,s.child!==null||n!==null&&n.child!==null)for(t=ST(t);t!==null;){if(n=t[ql])return n;t=ST(t)}return s}t=n,n=t.parentNode}return null}function Dx(t){return t=t[ql]||t[Fo],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function jh(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Je(33))}function Pb(t){return t[Lp]||null}var J2=[],_h=-1;function md(t){return{current:t}}function Xs(t){0>_h||(t.current=J2[_h],J2[_h]=null,_h--)}function Us(t,s){_h++,J2[_h]=t.current,t.current=s}var nd={},Zr=md(nd),Ia=md(!1),yu=nd;function em(t,s){var n=t.type.contextTypes;if(!n)return nd;var a=t.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===s)return a.__reactInternalMemoizedMaskedChildContext;var i={},l;for(l in n)i[l]=s[l];return a&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),i}function Ma(t){return t=t.childContextTypes,t!=null}function Ry(){Xs(Ia),Xs(Zr)}function CT(t,s,n){if(Zr.current!==nd)throw Error(Je(168));Us(Zr,s),Us(Ia,n)}function F8(t,s,n){var a=t.stateNode;if(s=s.childContextTypes,typeof a.getChildContext!="function")return n;a=a.getChildContext();for(var i in a)if(!(i in s))throw Error(Je(108,JY(t)||"Unknown",i));return xn({},n,a)}function Ly(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||nd,yu=Zr.current,Us(Zr,t),Us(Ia,Ia.current),!0}function kT(t,s,n){var a=t.stateNode;if(!a)throw Error(Je(169));n?(t=F8(t,s,yu),a.__reactInternalMemoizedMergedChildContext=t,Xs(Ia),Xs(Zr),Us(Zr,t)):Xs(Ia),Us(Ia,n)}var ko=null,Ib=!1,pw=!1;function $8(t){ko===null?ko=[t]:ko.push(t)}function xQ(t){Ib=!0,$8(t)}function fd(){if(!pw&&ko!==null){pw=!0;var t=0,s=Ss;try{var n=ko;for(Ss=1;t<n.length;t++){var a=n[t];do a=a(!0);while(a!==null)}ko=null,Ib=!1}catch(i){throw ko!==null&&(ko=ko.slice(t+1)),u8(KC,fd),i}finally{Ss=s,pw=!1}}return null}var Sh=[],Ch=0,By=null,Fy=0,Pi=[],Ii=0,bu=null,To=1,Po="";function Bd(t,s){Sh[Ch++]=Fy,Sh[Ch++]=By,By=t,Fy=s}function z8(t,s,n){Pi[Ii++]=To,Pi[Ii++]=Po,Pi[Ii++]=bu,bu=t;var a=To;t=Po;var i=32-pl(a)-1;a&=~(1<<i),n+=1;var l=32-pl(s)+i;if(30<l){var o=i-i%5;l=(a&(1<<o)-1).toString(32),a>>=o,i-=o,To=1<<32-pl(s)+i|n<<i|a,Po=l+t}else To=1<<l|n<<i|a,Po=t}function n3(t){t.return!==null&&(Bd(t,1),z8(t,1,0))}function r3(t){for(;t===By;)By=Sh[--Ch],Sh[Ch]=null,Fy=Sh[--Ch],Sh[Ch]=null;for(;t===bu;)bu=Pi[--Ii],Pi[Ii]=null,Po=Pi[--Ii],Pi[Ii]=null,To=Pi[--Ii],Pi[Ii]=null}var ui=null,ci=null,Js=!1,dl=null;function U8(t,s){var n=Mi(5,null,null,0);n.elementType="DELETED",n.stateNode=s,n.return=t,s=t.deletions,s===null?(t.deletions=[n],t.flags|=16):s.push(n)}function AT(t,s){switch(t.tag){case 5:var n=t.type;return s=s.nodeType!==1||n.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(t.stateNode=s,ui=t,ci=qc(s.firstChild),!0):!1;case 6:return s=t.pendingProps===""||s.nodeType!==3?null:s,s!==null?(t.stateNode=s,ui=t,ci=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(n=bu!==null?{id:To,overflow:Po}:null,t.memoizedState={dehydrated:s,treeContext:n,retryLane:1073741824},n=Mi(18,null,null,0),n.stateNode=s,n.return=t,t.child=n,ui=t,ci=null,!0):!1;default:return!1}}function e_(t){return(t.mode&1)!==0&&(t.flags&128)===0}function t_(t){if(Js){var s=ci;if(s){var n=s;if(!AT(t,s)){if(e_(t))throw Error(Je(418));s=qc(n.nextSibling);var a=ui;s&&AT(t,s)?U8(a,n):(t.flags=t.flags&-4097|2,Js=!1,ui=t)}}else{if(e_(t))throw Error(Je(418));t.flags=t.flags&-4097|2,Js=!1,ui=t}}}function ET(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ui=t}function O0(t){if(t!==ui)return!1;if(!Js)return ET(t),Js=!0,!1;var s;if((s=t.tag!==3)&&!(s=t.tag!==5)&&(s=t.type,s=s!=="head"&&s!=="body"&&!X2(t.type,t.memoizedProps)),s&&(s=ci)){if(e_(t))throw V8(),Error(Je(418));for(;s;)U8(t,s),s=qc(s.nextSibling)}if(ET(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Je(317));e:{for(t=t.nextSibling,s=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(s===0){ci=qc(t.nextSibling);break e}s--}else n!=="$"&&n!=="$!"&&n!=="$?"||s++}t=t.nextSibling}ci=null}}else ci=ui?qc(t.stateNode.nextSibling):null;return!0}function V8(){for(var t=ci;t;)t=qc(t.nextSibling)}function tm(){ci=ui=null,Js=!1}function a3(t){dl===null?dl=[t]:dl.push(t)}var gQ=ec.ReactCurrentBatchConfig;function jf(t,s,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Je(309));var a=n.stateNode}if(!a)throw Error(Je(147,t));var i=a,l=""+t;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===l?s.ref:(s=function(o){var c=i.refs;o===null?delete c[l]:c[l]=o},s._stringRef=l,s)}if(typeof t!="string")throw Error(Je(284));if(!n._owner)throw Error(Je(290,t))}return t}function R0(t,s){throw t=Object.prototype.toString.call(s),Error(Je(31,t==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":t))}function TT(t){var s=t._init;return s(t._payload)}function H8(t){function s(S,k){if(t){var A=S.deletions;A===null?(S.deletions=[k],S.flags|=16):A.push(k)}}function n(S,k){if(!t)return null;for(;k!==null;)s(S,k),k=k.sibling;return null}function a(S,k){for(S=new Map;k!==null;)k.key!==null?S.set(k.key,k):S.set(k.index,k),k=k.sibling;return S}function i(S,k){return S=Xc(S,k),S.index=0,S.sibling=null,S}function l(S,k,A){return S.index=A,t?(A=S.alternate,A!==null?(A=A.index,A<k?(S.flags|=2,k):A):(S.flags|=2,k)):(S.flags|=1048576,k)}function o(S){return t&&S.alternate===null&&(S.flags|=2),S}function c(S,k,A,T){return k===null||k.tag!==6?(k=ww(A,S.mode,T),k.return=S,k):(k=i(k,A),k.return=S,k)}function d(S,k,A,T){var P=A.type;return P===bh?h(S,k,A.props.children,T,A.key):k!==null&&(k.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===wc&&TT(P)===k.type)?(T=i(k,A.props),T.ref=jf(S,k,A),T.return=S,T):(T=Jg(A.type,A.key,A.props,null,S.mode,T),T.ref=jf(S,k,A),T.return=S,T)}function u(S,k,A,T){return k===null||k.tag!==4||k.stateNode.containerInfo!==A.containerInfo||k.stateNode.implementation!==A.implementation?(k=jw(A,S.mode,T),k.return=S,k):(k=i(k,A.children||[]),k.return=S,k)}function h(S,k,A,T,P){return k===null||k.tag!==7?(k=au(A,S.mode,T,P),k.return=S,k):(k=i(k,A),k.return=S,k)}function f(S,k,A){if(typeof k=="string"&&k!==""||typeof k=="number")return k=ww(""+k,S.mode,A),k.return=S,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case S0:return A=Jg(k.type,k.key,k.props,null,S.mode,A),A.ref=jf(S,null,k),A.return=S,A;case yh:return k=jw(k,S.mode,A),k.return=S,k;case wc:var T=k._init;return f(S,T(k._payload),A)}if(Wf(k)||yf(k))return k=au(k,S.mode,A,null),k.return=S,k;R0(S,k)}return null}function x(S,k,A,T){var P=k!==null?k.key:null;if(typeof A=="string"&&A!==""||typeof A=="number")return P!==null?null:c(S,k,""+A,T);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case S0:return A.key===P?d(S,k,A,T):null;case yh:return A.key===P?u(S,k,A,T):null;case wc:return P=A._init,x(S,k,P(A._payload),T)}if(Wf(A)||yf(A))return P!==null?null:h(S,k,A,T,null);R0(S,A)}return null}function b(S,k,A,T,P){if(typeof T=="string"&&T!==""||typeof T=="number")return S=S.get(A)||null,c(k,S,""+T,P);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case S0:return S=S.get(T.key===null?A:T.key)||null,d(k,S,T,P);case yh:return S=S.get(T.key===null?A:T.key)||null,u(k,S,T,P);case wc:var O=T._init;return b(S,k,A,O(T._payload),P)}if(Wf(T)||yf(T))return S=S.get(A)||null,h(k,S,T,P,null);R0(k,T)}return null}function v(S,k,A,T){for(var P=null,O=null,D=k,I=k=0,M=null;D!==null&&I<A.length;I++){D.index>I?(M=D,D=null):M=D.sibling;var B=x(S,D,A[I],T);if(B===null){D===null&&(D=M);break}t&&D&&B.alternate===null&&s(S,D),k=l(B,k,I),O===null?P=B:O.sibling=B,O=B,D=M}if(I===A.length)return n(S,D),Js&&Bd(S,I),P;if(D===null){for(;I<A.length;I++)D=f(S,A[I],T),D!==null&&(k=l(D,k,I),O===null?P=D:O.sibling=D,O=D);return Js&&Bd(S,I),P}for(D=a(S,D);I<A.length;I++)M=b(D,S,I,A[I],T),M!==null&&(t&&M.alternate!==null&&D.delete(M.key===null?I:M.key),k=l(M,k,I),O===null?P=M:O.sibling=M,O=M);return t&&D.forEach(function(L){return s(S,L)}),Js&&Bd(S,I),P}function w(S,k,A,T){var P=yf(A);if(typeof P!="function")throw Error(Je(150));if(A=P.call(A),A==null)throw Error(Je(151));for(var O=P=null,D=k,I=k=0,M=null,B=A.next();D!==null&&!B.done;I++,B=A.next()){D.index>I?(M=D,D=null):M=D.sibling;var L=x(S,D,B.value,T);if(L===null){D===null&&(D=M);break}t&&D&&L.alternate===null&&s(S,D),k=l(L,k,I),O===null?P=L:O.sibling=L,O=L,D=M}if(B.done)return n(S,D),Js&&Bd(S,I),P;if(D===null){for(;!B.done;I++,B=A.next())B=f(S,B.value,T),B!==null&&(k=l(B,k,I),O===null?P=B:O.sibling=B,O=B);return Js&&Bd(S,I),P}for(D=a(S,D);!B.done;I++,B=A.next())B=b(D,S,I,B.value,T),B!==null&&(t&&B.alternate!==null&&D.delete(B.key===null?I:B.key),k=l(B,k,I),O===null?P=B:O.sibling=B,O=B);return t&&D.forEach(function(F){return s(S,F)}),Js&&Bd(S,I),P}function _(S,k,A,T){if(typeof A=="object"&&A!==null&&A.type===bh&&A.key===null&&(A=A.props.children),typeof A=="object"&&A!==null){switch(A.$$typeof){case S0:e:{for(var P=A.key,O=k;O!==null;){if(O.key===P){if(P=A.type,P===bh){if(O.tag===7){n(S,O.sibling),k=i(O,A.props.children),k.return=S,S=k;break e}}else if(O.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===wc&&TT(P)===O.type){n(S,O.sibling),k=i(O,A.props),k.ref=jf(S,O,A),k.return=S,S=k;break e}n(S,O);break}else s(S,O);O=O.sibling}A.type===bh?(k=au(A.props.children,S.mode,T,A.key),k.return=S,S=k):(T=Jg(A.type,A.key,A.props,null,S.mode,T),T.ref=jf(S,k,A),T.return=S,S=T)}return o(S);case yh:e:{for(O=A.key;k!==null;){if(k.key===O)if(k.tag===4&&k.stateNode.containerInfo===A.containerInfo&&k.stateNode.implementation===A.implementation){n(S,k.sibling),k=i(k,A.children||[]),k.return=S,S=k;break e}else{n(S,k);break}else s(S,k);k=k.sibling}k=jw(A,S.mode,T),k.return=S,S=k}return o(S);case wc:return O=A._init,_(S,k,O(A._payload),T)}if(Wf(A))return v(S,k,A,T);if(yf(A))return w(S,k,A,T);R0(S,A)}return typeof A=="string"&&A!==""||typeof A=="number"?(A=""+A,k!==null&&k.tag===6?(n(S,k.sibling),k=i(k,A),k.return=S,S=k):(n(S,k),k=ww(A,S.mode,T),k.return=S,S=k),o(S)):n(S,k)}return _}var sm=H8(!0),W8=H8(!1),$y=md(null),zy=null,kh=null,i3=null;function l3(){i3=kh=zy=null}function o3(t){var s=$y.current;Xs($y),t._currentValue=s}function s_(t,s,n){for(;t!==null;){var a=t.alternate;if((t.childLanes&s)!==s?(t.childLanes|=s,a!==null&&(a.childLanes|=s)):a!==null&&(a.childLanes&s)!==s&&(a.childLanes|=s),t===n)break;t=t.return}}function Hh(t,s){zy=t,i3=kh=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&s&&(Ea=!0),t.firstContext=null)}function $i(t){var s=t._currentValue;if(i3!==t)if(t={context:t,memoizedValue:s,next:null},kh===null){if(zy===null)throw Error(Je(308));kh=t,zy.dependencies={lanes:0,firstContext:t}}else kh=kh.next=t;return s}var Gd=null;function c3(t){Gd===null?Gd=[t]:Gd.push(t)}function q8(t,s,n,a){var i=s.interleaved;return i===null?(n.next=n,c3(s)):(n.next=i.next,i.next=n),s.interleaved=n,$o(t,a)}function $o(t,s){t.lanes|=s;var n=t.alternate;for(n!==null&&(n.lanes|=s),n=t,t=t.return;t!==null;)t.childLanes|=s,n=t.alternate,n!==null&&(n.childLanes|=s),n=t,t=t.return;return n.tag===3?n.stateNode:null}var jc=!1;function d3(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function G8(t,s){t=t.updateQueue,s.updateQueue===t&&(s.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Oo(t,s){return{eventTime:t,lane:s,tag:0,payload:null,callback:null,next:null}}function Gc(t,s,n){var a=t.updateQueue;if(a===null)return null;if(a=a.shared,fs&2){var i=a.pending;return i===null?s.next=s:(s.next=i.next,i.next=s),a.pending=s,$o(t,n)}return i=a.interleaved,i===null?(s.next=s,c3(a)):(s.next=i.next,i.next=s),a.interleaved=s,$o(t,n)}function Gg(t,s,n){if(s=s.updateQueue,s!==null&&(s=s.shared,(n&4194240)!==0)){var a=s.lanes;a&=t.pendingLanes,n|=a,s.lanes=n,YC(t,n)}}function PT(t,s){var n=t.updateQueue,a=t.alternate;if(a!==null&&(a=a.updateQueue,n===a)){var i=null,l=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};l===null?i=l=o:l=l.next=o,n=n.next}while(n!==null);l===null?i=l=s:l=l.next=s}else i=l=s;n={baseState:a.baseState,firstBaseUpdate:i,lastBaseUpdate:l,shared:a.shared,effects:a.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=s:t.next=s,n.lastBaseUpdate=s}function Uy(t,s,n,a){var i=t.updateQueue;jc=!1;var l=i.firstBaseUpdate,o=i.lastBaseUpdate,c=i.shared.pending;if(c!==null){i.shared.pending=null;var d=c,u=d.next;d.next=null,o===null?l=u:o.next=u,o=d;var h=t.alternate;h!==null&&(h=h.updateQueue,c=h.lastBaseUpdate,c!==o&&(c===null?h.firstBaseUpdate=u:c.next=u,h.lastBaseUpdate=d))}if(l!==null){var f=i.baseState;o=0,h=u=d=null,c=l;do{var x=c.lane,b=c.eventTime;if((a&x)===x){h!==null&&(h=h.next={eventTime:b,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var v=t,w=c;switch(x=s,b=n,w.tag){case 1:if(v=w.payload,typeof v=="function"){f=v.call(b,f,x);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=w.payload,x=typeof v=="function"?v.call(b,f,x):v,x==null)break e;f=xn({},f,x);break e;case 2:jc=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,x=i.effects,x===null?i.effects=[c]:x.push(c))}else b={eventTime:b,lane:x,tag:c.tag,payload:c.payload,callback:c.callback,next:null},h===null?(u=h=b,d=f):h=h.next=b,o|=x;if(c=c.next,c===null){if(c=i.shared.pending,c===null)break;x=c,c=x.next,x.next=null,i.lastBaseUpdate=x,i.shared.pending=null}}while(!0);if(h===null&&(d=f),i.baseState=d,i.firstBaseUpdate=u,i.lastBaseUpdate=h,s=i.shared.interleaved,s!==null){i=s;do o|=i.lane,i=i.next;while(i!==s)}else l===null&&(i.shared.lanes=0);Nu|=o,t.lanes=o,t.memoizedState=f}}function IT(t,s,n){if(t=s.effects,s.effects=null,t!==null)for(s=0;s<t.length;s++){var a=t[s],i=a.callback;if(i!==null){if(a.callback=null,a=n,typeof i!="function")throw Error(Je(191,i));i.call(a)}}}var Ox={},eo=md(Ox),Bp=md(Ox),Fp=md(Ox);function Kd(t){if(t===Ox)throw Error(Je(174));return t}function u3(t,s){switch(Us(Fp,s),Us(Bp,t),Us(eo,Ox),t=s.nodeType,t){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:R2(null,"");break;default:t=t===8?s.parentNode:s,s=t.namespaceURI||null,t=t.tagName,s=R2(s,t)}Xs(eo),Us(eo,s)}function nm(){Xs(eo),Xs(Bp),Xs(Fp)}function K8(t){Kd(Fp.current);var s=Kd(eo.current),n=R2(s,t.type);s!==n&&(Us(Bp,t),Us(eo,n))}function h3(t){Bp.current===t&&(Xs(eo),Xs(Bp))}var un=md(0);function Vy(t){for(var s=t;s!==null;){if(s.tag===13){var n=s.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var xw=[];function m3(){for(var t=0;t<xw.length;t++)xw[t]._workInProgressVersionPrimary=null;xw.length=0}var Kg=ec.ReactCurrentDispatcher,gw=ec.ReactCurrentBatchConfig,vu=0,fn=null,er=null,gr=null,Hy=!1,lp=!1,$p=0,yQ=0;function Ur(){throw Error(Je(321))}function f3(t,s){if(s===null)return!1;for(var n=0;n<s.length&&n<t.length;n++)if(!yl(t[n],s[n]))return!1;return!0}function p3(t,s,n,a,i,l){if(vu=l,fn=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Kg.current=t===null||t.memoizedState===null?wQ:jQ,t=n(a,i),lp){l=0;do{if(lp=!1,$p=0,25<=l)throw Error(Je(301));l+=1,gr=er=null,s.updateQueue=null,Kg.current=_Q,t=n(a,i)}while(lp)}if(Kg.current=Wy,s=er!==null&&er.next!==null,vu=0,gr=er=fn=null,Hy=!1,s)throw Error(Je(300));return t}function x3(){var t=$p!==0;return $p=0,t}function Vl(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gr===null?fn.memoizedState=gr=t:gr=gr.next=t,gr}function zi(){if(er===null){var t=fn.alternate;t=t!==null?t.memoizedState:null}else t=er.next;var s=gr===null?fn.memoizedState:gr.next;if(s!==null)gr=s,er=t;else{if(t===null)throw Error(Je(310));er=t,t={memoizedState:er.memoizedState,baseState:er.baseState,baseQueue:er.baseQueue,queue:er.queue,next:null},gr===null?fn.memoizedState=gr=t:gr=gr.next=t}return gr}function zp(t,s){return typeof s=="function"?s(t):s}function yw(t){var s=zi(),n=s.queue;if(n===null)throw Error(Je(311));n.lastRenderedReducer=t;var a=er,i=a.baseQueue,l=n.pending;if(l!==null){if(i!==null){var o=i.next;i.next=l.next,l.next=o}a.baseQueue=i=l,n.pending=null}if(i!==null){l=i.next,a=a.baseState;var c=o=null,d=null,u=l;do{var h=u.lane;if((vu&h)===h)d!==null&&(d=d.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),a=u.hasEagerState?u.eagerState:t(a,u.action);else{var f={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};d===null?(c=d=f,o=a):d=d.next=f,fn.lanes|=h,Nu|=h}u=u.next}while(u!==null&&u!==l);d===null?o=a:d.next=c,yl(a,s.memoizedState)||(Ea=!0),s.memoizedState=a,s.baseState=o,s.baseQueue=d,n.lastRenderedState=a}if(t=n.interleaved,t!==null){i=t;do l=i.lane,fn.lanes|=l,Nu|=l,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[s.memoizedState,n.dispatch]}function bw(t){var s=zi(),n=s.queue;if(n===null)throw Error(Je(311));n.lastRenderedReducer=t;var a=n.dispatch,i=n.pending,l=s.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do l=t(l,o.action),o=o.next;while(o!==i);yl(l,s.memoizedState)||(Ea=!0),s.memoizedState=l,s.baseQueue===null&&(s.baseState=l),n.lastRenderedState=l}return[l,a]}function Y8(){}function X8(t,s){var n=fn,a=zi(),i=s(),l=!yl(a.memoizedState,i);if(l&&(a.memoizedState=i,Ea=!0),a=a.queue,g3(J8.bind(null,n,a,t),[t]),a.getSnapshot!==s||l||gr!==null&&gr.memoizedState.tag&1){if(n.flags|=2048,Up(9,Z8.bind(null,n,a,i,s),void 0,null),br===null)throw Error(Je(349));vu&30||Q8(n,s,i)}return i}function Q8(t,s,n){t.flags|=16384,t={getSnapshot:s,value:n},s=fn.updateQueue,s===null?(s={lastEffect:null,stores:null},fn.updateQueue=s,s.stores=[t]):(n=s.stores,n===null?s.stores=[t]:n.push(t))}function Z8(t,s,n,a){s.value=n,s.getSnapshot=a,eL(s)&&tL(t)}function J8(t,s,n){return n(function(){eL(s)&&tL(t)})}function eL(t){var s=t.getSnapshot;t=t.value;try{var n=s();return!yl(t,n)}catch{return!0}}function tL(t){var s=$o(t,1);s!==null&&xl(s,t,1,-1)}function MT(t){var s=Vl();return typeof t=="function"&&(t=t()),s.memoizedState=s.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:zp,lastRenderedState:t},s.queue=t,t=t.dispatch=NQ.bind(null,fn,t),[s.memoizedState,t]}function Up(t,s,n,a){return t={tag:t,create:s,destroy:n,deps:a,next:null},s=fn.updateQueue,s===null?(s={lastEffect:null,stores:null},fn.updateQueue=s,s.lastEffect=t.next=t):(n=s.lastEffect,n===null?s.lastEffect=t.next=t:(a=n.next,n.next=t,t.next=a,s.lastEffect=t)),t}function sL(){return zi().memoizedState}function Yg(t,s,n,a){var i=Vl();fn.flags|=t,i.memoizedState=Up(1|s,n,void 0,a===void 0?null:a)}function Mb(t,s,n,a){var i=zi();a=a===void 0?null:a;var l=void 0;if(er!==null){var o=er.memoizedState;if(l=o.destroy,a!==null&&f3(a,o.deps)){i.memoizedState=Up(s,n,l,a);return}}fn.flags|=t,i.memoizedState=Up(1|s,n,l,a)}function DT(t,s){return Yg(8390656,8,t,s)}function g3(t,s){return Mb(2048,8,t,s)}function nL(t,s){return Mb(4,2,t,s)}function rL(t,s){return Mb(4,4,t,s)}function aL(t,s){if(typeof s=="function")return t=t(),s(t),function(){s(null)};if(s!=null)return t=t(),s.current=t,function(){s.current=null}}function iL(t,s,n){return n=n!=null?n.concat([t]):null,Mb(4,4,aL.bind(null,s,t),n)}function y3(){}function lL(t,s){var n=zi();s=s===void 0?null:s;var a=n.memoizedState;return a!==null&&s!==null&&f3(s,a[1])?a[0]:(n.memoizedState=[t,s],t)}function oL(t,s){var n=zi();s=s===void 0?null:s;var a=n.memoizedState;return a!==null&&s!==null&&f3(s,a[1])?a[0]:(t=t(),n.memoizedState=[t,s],t)}function cL(t,s,n){return vu&21?(yl(n,s)||(n=f8(),fn.lanes|=n,Nu|=n,t.baseState=!0),s):(t.baseState&&(t.baseState=!1,Ea=!0),t.memoizedState=n)}function bQ(t,s){var n=Ss;Ss=n!==0&&4>n?n:4,t(!0);var a=gw.transition;gw.transition={};try{t(!1),s()}finally{Ss=n,gw.transition=a}}function dL(){return zi().memoizedState}function vQ(t,s,n){var a=Yc(t);if(n={lane:a,action:n,hasEagerState:!1,eagerState:null,next:null},uL(t))hL(s,n);else if(n=q8(t,s,n,a),n!==null){var i=ma();xl(n,t,a,i),mL(n,s,a)}}function NQ(t,s,n){var a=Yc(t),i={lane:a,action:n,hasEagerState:!1,eagerState:null,next:null};if(uL(t))hL(s,i);else{var l=t.alternate;if(t.lanes===0&&(l===null||l.lanes===0)&&(l=s.lastRenderedReducer,l!==null))try{var o=s.lastRenderedState,c=l(o,n);if(i.hasEagerState=!0,i.eagerState=c,yl(c,o)){var d=s.interleaved;d===null?(i.next=i,c3(s)):(i.next=d.next,d.next=i),s.interleaved=i;return}}catch{}finally{}n=q8(t,s,i,a),n!==null&&(i=ma(),xl(n,t,a,i),mL(n,s,a))}}function uL(t){var s=t.alternate;return t===fn||s!==null&&s===fn}function hL(t,s){lp=Hy=!0;var n=t.pending;n===null?s.next=s:(s.next=n.next,n.next=s),t.pending=s}function mL(t,s,n){if(n&4194240){var a=s.lanes;a&=t.pendingLanes,n|=a,s.lanes=n,YC(t,n)}}var Wy={readContext:$i,useCallback:Ur,useContext:Ur,useEffect:Ur,useImperativeHandle:Ur,useInsertionEffect:Ur,useLayoutEffect:Ur,useMemo:Ur,useReducer:Ur,useRef:Ur,useState:Ur,useDebugValue:Ur,useDeferredValue:Ur,useTransition:Ur,useMutableSource:Ur,useSyncExternalStore:Ur,useId:Ur,unstable_isNewReconciler:!1},wQ={readContext:$i,useCallback:function(t,s){return Vl().memoizedState=[t,s===void 0?null:s],t},useContext:$i,useEffect:DT,useImperativeHandle:function(t,s,n){return n=n!=null?n.concat([t]):null,Yg(4194308,4,aL.bind(null,s,t),n)},useLayoutEffect:function(t,s){return Yg(4194308,4,t,s)},useInsertionEffect:function(t,s){return Yg(4,2,t,s)},useMemo:function(t,s){var n=Vl();return s=s===void 0?null:s,t=t(),n.memoizedState=[t,s],t},useReducer:function(t,s,n){var a=Vl();return s=n!==void 0?n(s):s,a.memoizedState=a.baseState=s,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:s},a.queue=t,t=t.dispatch=vQ.bind(null,fn,t),[a.memoizedState,t]},useRef:function(t){var s=Vl();return t={current:t},s.memoizedState=t},useState:MT,useDebugValue:y3,useDeferredValue:function(t){return Vl().memoizedState=t},useTransition:function(){var t=MT(!1),s=t[0];return t=bQ.bind(null,t[1]),Vl().memoizedState=t,[s,t]},useMutableSource:function(){},useSyncExternalStore:function(t,s,n){var a=fn,i=Vl();if(Js){if(n===void 0)throw Error(Je(407));n=n()}else{if(n=s(),br===null)throw Error(Je(349));vu&30||Q8(a,s,n)}i.memoizedState=n;var l={value:n,getSnapshot:s};return i.queue=l,DT(J8.bind(null,a,l,t),[t]),a.flags|=2048,Up(9,Z8.bind(null,a,l,n,s),void 0,null),n},useId:function(){var t=Vl(),s=br.identifierPrefix;if(Js){var n=Po,a=To;n=(a&~(1<<32-pl(a)-1)).toString(32)+n,s=":"+s+"R"+n,n=$p++,0<n&&(s+="H"+n.toString(32)),s+=":"}else n=yQ++,s=":"+s+"r"+n.toString(32)+":";return t.memoizedState=s},unstable_isNewReconciler:!1},jQ={readContext:$i,useCallback:lL,useContext:$i,useEffect:g3,useImperativeHandle:iL,useInsertionEffect:nL,useLayoutEffect:rL,useMemo:oL,useReducer:yw,useRef:sL,useState:function(){return yw(zp)},useDebugValue:y3,useDeferredValue:function(t){var s=zi();return cL(s,er.memoizedState,t)},useTransition:function(){var t=yw(zp)[0],s=zi().memoizedState;return[t,s]},useMutableSource:Y8,useSyncExternalStore:X8,useId:dL,unstable_isNewReconciler:!1},_Q={readContext:$i,useCallback:lL,useContext:$i,useEffect:g3,useImperativeHandle:iL,useInsertionEffect:nL,useLayoutEffect:rL,useMemo:oL,useReducer:bw,useRef:sL,useState:function(){return bw(zp)},useDebugValue:y3,useDeferredValue:function(t){var s=zi();return er===null?s.memoizedState=t:cL(s,er.memoizedState,t)},useTransition:function(){var t=bw(zp)[0],s=zi().memoizedState;return[t,s]},useMutableSource:Y8,useSyncExternalStore:X8,useId:dL,unstable_isNewReconciler:!1};function ll(t,s){if(t&&t.defaultProps){s=xn({},s),t=t.defaultProps;for(var n in t)s[n]===void 0&&(s[n]=t[n]);return s}return s}function n_(t,s,n,a){s=t.memoizedState,n=n(a,s),n=n==null?s:xn({},s,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Db={isMounted:function(t){return(t=t._reactInternals)?Vu(t)===t:!1},enqueueSetState:function(t,s,n){t=t._reactInternals;var a=ma(),i=Yc(t),l=Oo(a,i);l.payload=s,n!=null&&(l.callback=n),s=Gc(t,l,i),s!==null&&(xl(s,t,i,a),Gg(s,t,i))},enqueueReplaceState:function(t,s,n){t=t._reactInternals;var a=ma(),i=Yc(t),l=Oo(a,i);l.tag=1,l.payload=s,n!=null&&(l.callback=n),s=Gc(t,l,i),s!==null&&(xl(s,t,i,a),Gg(s,t,i))},enqueueForceUpdate:function(t,s){t=t._reactInternals;var n=ma(),a=Yc(t),i=Oo(n,a);i.tag=2,s!=null&&(i.callback=s),s=Gc(t,i,a),s!==null&&(xl(s,t,a,n),Gg(s,t,a))}};function OT(t,s,n,a,i,l,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(a,l,o):s.prototype&&s.prototype.isPureReactComponent?!Dp(n,a)||!Dp(i,l):!0}function fL(t,s,n){var a=!1,i=nd,l=s.contextType;return typeof l=="object"&&l!==null?l=$i(l):(i=Ma(s)?yu:Zr.current,a=s.contextTypes,l=(a=a!=null)?em(t,i):nd),s=new s(n,l),t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=Db,t.stateNode=s,s._reactInternals=t,a&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=l),s}function RT(t,s,n,a){t=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(n,a),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(n,a),s.state!==t&&Db.enqueueReplaceState(s,s.state,null)}function r_(t,s,n,a){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},d3(t);var l=s.contextType;typeof l=="object"&&l!==null?i.context=$i(l):(l=Ma(s)?yu:Zr.current,i.context=em(t,l)),i.state=t.memoizedState,l=s.getDerivedStateFromProps,typeof l=="function"&&(n_(t,s,l,n),i.state=t.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(s=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),s!==i.state&&Db.enqueueReplaceState(i,i.state,null),Uy(t,n,i,a),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function rm(t,s){try{var n="",a=s;do n+=ZY(a),a=a.return;while(a);var i=n}catch(l){i=`
Error generating stack: `+l.message+`
`+l.stack}return{value:t,source:s,stack:i,digest:null}}function vw(t,s,n){return{value:t,source:null,stack:n??null,digest:s??null}}function a_(t,s){try{console.error(s.value)}catch(n){setTimeout(function(){throw n})}}var SQ=typeof WeakMap=="function"?WeakMap:Map;function pL(t,s,n){n=Oo(-1,n),n.tag=3,n.payload={element:null};var a=s.value;return n.callback=function(){Gy||(Gy=!0,p_=a),a_(t,s)},n}function xL(t,s,n){n=Oo(-1,n),n.tag=3;var a=t.type.getDerivedStateFromError;if(typeof a=="function"){var i=s.value;n.payload=function(){return a(i)},n.callback=function(){a_(t,s)}}var l=t.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(n.callback=function(){a_(t,s),typeof a!="function"&&(Kc===null?Kc=new Set([this]):Kc.add(this));var o=s.stack;this.componentDidCatch(s.value,{componentStack:o!==null?o:""})}),n}function LT(t,s,n){var a=t.pingCache;if(a===null){a=t.pingCache=new SQ;var i=new Set;a.set(s,i)}else i=a.get(s),i===void 0&&(i=new Set,a.set(s,i));i.has(n)||(i.add(n),t=FQ.bind(null,t,s,n),s.then(t,t))}function BT(t){do{var s;if((s=t.tag===13)&&(s=t.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return t;t=t.return}while(t!==null);return null}function FT(t,s,n,a,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===s?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(s=Oo(-1,1),s.tag=2,Gc(n,s,1))),n.lanes|=1),t)}var CQ=ec.ReactCurrentOwner,Ea=!1;function oa(t,s,n,a){s.child=t===null?W8(s,null,n,a):sm(s,t.child,n,a)}function $T(t,s,n,a,i){n=n.render;var l=s.ref;return Hh(s,i),a=p3(t,s,n,a,l,i),n=x3(),t!==null&&!Ea?(s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~i,zo(t,s,i)):(Js&&n&&n3(s),s.flags|=1,oa(t,s,a,i),s.child)}function zT(t,s,n,a,i){if(t===null){var l=n.type;return typeof l=="function"&&!C3(l)&&l.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(s.tag=15,s.type=l,gL(t,s,l,a,i)):(t=Jg(n.type,null,a,s,s.mode,i),t.ref=s.ref,t.return=s,s.child=t)}if(l=t.child,!(t.lanes&i)){var o=l.memoizedProps;if(n=n.compare,n=n!==null?n:Dp,n(o,a)&&t.ref===s.ref)return zo(t,s,i)}return s.flags|=1,t=Xc(l,a),t.ref=s.ref,t.return=s,s.child=t}function gL(t,s,n,a,i){if(t!==null){var l=t.memoizedProps;if(Dp(l,a)&&t.ref===s.ref)if(Ea=!1,s.pendingProps=a=l,(t.lanes&i)!==0)t.flags&131072&&(Ea=!0);else return s.lanes=t.lanes,zo(t,s,i)}return i_(t,s,n,a,i)}function yL(t,s,n){var a=s.pendingProps,i=a.children,l=t!==null?t.memoizedState:null;if(a.mode==="hidden")if(!(s.mode&1))s.memoizedState={baseLanes:0,cachePool:null,transitions:null},Us(Eh,si),si|=n;else{if(!(n&1073741824))return t=l!==null?l.baseLanes|n:n,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:t,cachePool:null,transitions:null},s.updateQueue=null,Us(Eh,si),si|=t,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=l!==null?l.baseLanes:n,Us(Eh,si),si|=a}else l!==null?(a=l.baseLanes|n,s.memoizedState=null):a=n,Us(Eh,si),si|=a;return oa(t,s,i,n),s.child}function bL(t,s){var n=s.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(s.flags|=512,s.flags|=2097152)}function i_(t,s,n,a,i){var l=Ma(n)?yu:Zr.current;return l=em(s,l),Hh(s,i),n=p3(t,s,n,a,l,i),a=x3(),t!==null&&!Ea?(s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~i,zo(t,s,i)):(Js&&a&&n3(s),s.flags|=1,oa(t,s,n,i),s.child)}function UT(t,s,n,a,i){if(Ma(n)){var l=!0;Ly(s)}else l=!1;if(Hh(s,i),s.stateNode===null)Xg(t,s),fL(s,n,a),r_(s,n,a,i),a=!0;else if(t===null){var o=s.stateNode,c=s.memoizedProps;o.props=c;var d=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=$i(u):(u=Ma(n)?yu:Zr.current,u=em(s,u));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==a||d!==u)&&RT(s,o,a,u),jc=!1;var x=s.memoizedState;o.state=x,Uy(s,a,o,i),d=s.memoizedState,c!==a||x!==d||Ia.current||jc?(typeof h=="function"&&(n_(s,n,h,a),d=s.memoizedState),(c=jc||OT(s,n,c,a,x,d,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(s.flags|=4194308)):(typeof o.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=a,s.memoizedState=d),o.props=a,o.state=d,o.context=u,a=c):(typeof o.componentDidMount=="function"&&(s.flags|=4194308),a=!1)}else{o=s.stateNode,G8(t,s),c=s.memoizedProps,u=s.type===s.elementType?c:ll(s.type,c),o.props=u,f=s.pendingProps,x=o.context,d=n.contextType,typeof d=="object"&&d!==null?d=$i(d):(d=Ma(n)?yu:Zr.current,d=em(s,d));var b=n.getDerivedStateFromProps;(h=typeof b=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==f||x!==d)&&RT(s,o,a,d),jc=!1,x=s.memoizedState,o.state=x,Uy(s,a,o,i);var v=s.memoizedState;c!==f||x!==v||Ia.current||jc?(typeof b=="function"&&(n_(s,n,b,a),v=s.memoizedState),(u=jc||OT(s,n,u,a,x,v,d)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(a,v,d),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(a,v,d)),typeof o.componentDidUpdate=="function"&&(s.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&x===t.memoizedState||(s.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&x===t.memoizedState||(s.flags|=1024),s.memoizedProps=a,s.memoizedState=v),o.props=a,o.state=v,o.context=d,a=u):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&x===t.memoizedState||(s.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&x===t.memoizedState||(s.flags|=1024),a=!1)}return l_(t,s,n,a,l,i)}function l_(t,s,n,a,i,l){bL(t,s);var o=(s.flags&128)!==0;if(!a&&!o)return i&&kT(s,n,!1),zo(t,s,l);a=s.stateNode,CQ.current=s;var c=o&&typeof n.getDerivedStateFromError!="function"?null:a.render();return s.flags|=1,t!==null&&o?(s.child=sm(s,t.child,null,l),s.child=sm(s,null,c,l)):oa(t,s,c,l),s.memoizedState=a.state,i&&kT(s,n,!0),s.child}function vL(t){var s=t.stateNode;s.pendingContext?CT(t,s.pendingContext,s.pendingContext!==s.context):s.context&&CT(t,s.context,!1),u3(t,s.containerInfo)}function VT(t,s,n,a,i){return tm(),a3(i),s.flags|=256,oa(t,s,n,a),s.child}var o_={dehydrated:null,treeContext:null,retryLane:0};function c_(t){return{baseLanes:t,cachePool:null,transitions:null}}function NL(t,s,n){var a=s.pendingProps,i=un.current,l=!1,o=(s.flags&128)!==0,c;if((c=o)||(c=t!==null&&t.memoizedState===null?!1:(i&2)!==0),c?(l=!0,s.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Us(un,i&1),t===null)return t_(s),t=s.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(s.mode&1?t.data==="$!"?s.lanes=8:s.lanes=1073741824:s.lanes=1,null):(o=a.children,t=a.fallback,l?(a=s.mode,l=s.child,o={mode:"hidden",children:o},!(a&1)&&l!==null?(l.childLanes=0,l.pendingProps=o):l=Lb(o,a,0,null),t=au(t,a,n,null),l.return=s,t.return=s,l.sibling=t,s.child=l,s.child.memoizedState=c_(n),s.memoizedState=o_,t):b3(s,o));if(i=t.memoizedState,i!==null&&(c=i.dehydrated,c!==null))return kQ(t,s,o,a,c,i,n);if(l){l=a.fallback,o=s.mode,i=t.child,c=i.sibling;var d={mode:"hidden",children:a.children};return!(o&1)&&s.child!==i?(a=s.child,a.childLanes=0,a.pendingProps=d,s.deletions=null):(a=Xc(i,d),a.subtreeFlags=i.subtreeFlags&14680064),c!==null?l=Xc(c,l):(l=au(l,o,n,null),l.flags|=2),l.return=s,a.return=s,a.sibling=l,s.child=a,a=l,l=s.child,o=t.child.memoizedState,o=o===null?c_(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},l.memoizedState=o,l.childLanes=t.childLanes&~n,s.memoizedState=o_,a}return l=t.child,t=l.sibling,a=Xc(l,{mode:"visible",children:a.children}),!(s.mode&1)&&(a.lanes=n),a.return=s,a.sibling=null,t!==null&&(n=s.deletions,n===null?(s.deletions=[t],s.flags|=16):n.push(t)),s.child=a,s.memoizedState=null,a}function b3(t,s){return s=Lb({mode:"visible",children:s},t.mode,0,null),s.return=t,t.child=s}function L0(t,s,n,a){return a!==null&&a3(a),sm(s,t.child,null,n),t=b3(s,s.pendingProps.children),t.flags|=2,s.memoizedState=null,t}function kQ(t,s,n,a,i,l,o){if(n)return s.flags&256?(s.flags&=-257,a=vw(Error(Je(422))),L0(t,s,o,a)):s.memoizedState!==null?(s.child=t.child,s.flags|=128,null):(l=a.fallback,i=s.mode,a=Lb({mode:"visible",children:a.children},i,0,null),l=au(l,i,o,null),l.flags|=2,a.return=s,l.return=s,a.sibling=l,s.child=a,s.mode&1&&sm(s,t.child,null,o),s.child.memoizedState=c_(o),s.memoizedState=o_,l);if(!(s.mode&1))return L0(t,s,o,null);if(i.data==="$!"){if(a=i.nextSibling&&i.nextSibling.dataset,a)var c=a.dgst;return a=c,l=Error(Je(419)),a=vw(l,a,void 0),L0(t,s,o,a)}if(c=(o&t.childLanes)!==0,Ea||c){if(a=br,a!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(a.suspendedLanes|o)?0:i,i!==0&&i!==l.retryLane&&(l.retryLane=i,$o(t,i),xl(a,t,i,-1))}return S3(),a=vw(Error(Je(421))),L0(t,s,o,a)}return i.data==="$?"?(s.flags|=128,s.child=t.child,s=$Q.bind(null,t),i._reactRetry=s,null):(t=l.treeContext,ci=qc(i.nextSibling),ui=s,Js=!0,dl=null,t!==null&&(Pi[Ii++]=To,Pi[Ii++]=Po,Pi[Ii++]=bu,To=t.id,Po=t.overflow,bu=s),s=b3(s,a.children),s.flags|=4096,s)}function HT(t,s,n){t.lanes|=s;var a=t.alternate;a!==null&&(a.lanes|=s),s_(t.return,s,n)}function Nw(t,s,n,a,i){var l=t.memoizedState;l===null?t.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:a,tail:n,tailMode:i}:(l.isBackwards=s,l.rendering=null,l.renderingStartTime=0,l.last=a,l.tail=n,l.tailMode=i)}function wL(t,s,n){var a=s.pendingProps,i=a.revealOrder,l=a.tail;if(oa(t,s,a.children,n),a=un.current,a&2)a=a&1|2,s.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=s.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&HT(t,n,s);else if(t.tag===19)HT(t,n,s);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break e;for(;t.sibling===null;){if(t.return===null||t.return===s)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}a&=1}if(Us(un,a),!(s.mode&1))s.memoizedState=null;else switch(i){case"forwards":for(n=s.child,i=null;n!==null;)t=n.alternate,t!==null&&Vy(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=s.child,s.child=null):(i=n.sibling,n.sibling=null),Nw(s,!1,i,n,l);break;case"backwards":for(n=null,i=s.child,s.child=null;i!==null;){if(t=i.alternate,t!==null&&Vy(t)===null){s.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Nw(s,!0,n,null,l);break;case"together":Nw(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Xg(t,s){!(s.mode&1)&&t!==null&&(t.alternate=null,s.alternate=null,s.flags|=2)}function zo(t,s,n){if(t!==null&&(s.dependencies=t.dependencies),Nu|=s.lanes,!(n&s.childLanes))return null;if(t!==null&&s.child!==t.child)throw Error(Je(153));if(s.child!==null){for(t=s.child,n=Xc(t,t.pendingProps),s.child=n,n.return=s;t.sibling!==null;)t=t.sibling,n=n.sibling=Xc(t,t.pendingProps),n.return=s;n.sibling=null}return s.child}function AQ(t,s,n){switch(s.tag){case 3:vL(s),tm();break;case 5:K8(s);break;case 1:Ma(s.type)&&Ly(s);break;case 4:u3(s,s.stateNode.containerInfo);break;case 10:var a=s.type._context,i=s.memoizedProps.value;Us($y,a._currentValue),a._currentValue=i;break;case 13:if(a=s.memoizedState,a!==null)return a.dehydrated!==null?(Us(un,un.current&1),s.flags|=128,null):n&s.child.childLanes?NL(t,s,n):(Us(un,un.current&1),t=zo(t,s,n),t!==null?t.sibling:null);Us(un,un.current&1);break;case 19:if(a=(n&s.childLanes)!==0,t.flags&128){if(a)return wL(t,s,n);s.flags|=128}if(i=s.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Us(un,un.current),a)break;return null;case 22:case 23:return s.lanes=0,yL(t,s,n)}return zo(t,s,n)}var jL,d_,_L,SL;jL=function(t,s){for(var n=s.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===s)break;for(;n.sibling===null;){if(n.return===null||n.return===s)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};d_=function(){};_L=function(t,s,n,a){var i=t.memoizedProps;if(i!==a){t=s.stateNode,Kd(eo.current);var l=null;switch(n){case"input":i=I2(t,i),a=I2(t,a),l=[];break;case"select":i=xn({},i,{value:void 0}),a=xn({},a,{value:void 0}),l=[];break;case"textarea":i=O2(t,i),a=O2(t,a),l=[];break;default:typeof i.onClick!="function"&&typeof a.onClick=="function"&&(t.onclick=Oy)}L2(n,a);var o;n=null;for(u in i)if(!a.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var c=i[u];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(kp.hasOwnProperty(u)?l||(l=[]):(l=l||[]).push(u,null));for(u in a){var d=a[u];if(c=i!=null?i[u]:void 0,a.hasOwnProperty(u)&&d!==c&&(d!=null||c!=null))if(u==="style")if(c){for(o in c)!c.hasOwnProperty(o)||d&&d.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in d)d.hasOwnProperty(o)&&c[o]!==d[o]&&(n||(n={}),n[o]=d[o])}else n||(l||(l=[]),l.push(u,n)),n=d;else u==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,c=c?c.__html:void 0,d!=null&&c!==d&&(l=l||[]).push(u,d)):u==="children"?typeof d!="string"&&typeof d!="number"||(l=l||[]).push(u,""+d):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(kp.hasOwnProperty(u)?(d!=null&&u==="onScroll"&&Gs("scroll",t),l||c===d||(l=[])):(l=l||[]).push(u,d))}n&&(l=l||[]).push("style",n);var u=l;(s.updateQueue=u)&&(s.flags|=4)}};SL=function(t,s,n,a){n!==a&&(s.flags|=4)};function _f(t,s){if(!Js)switch(t.tailMode){case"hidden":s=t.tail;for(var n=null;s!==null;)s.alternate!==null&&(n=s),s=s.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var a=null;n!==null;)n.alternate!==null&&(a=n),n=n.sibling;a===null?s||t.tail===null?t.tail=null:t.tail.sibling=null:a.sibling=null}}function Vr(t){var s=t.alternate!==null&&t.alternate.child===t.child,n=0,a=0;if(s)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,a|=i.subtreeFlags&14680064,a|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,a|=i.subtreeFlags,a|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=a,t.childLanes=n,s}function EQ(t,s,n){var a=s.pendingProps;switch(r3(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vr(s),null;case 1:return Ma(s.type)&&Ry(),Vr(s),null;case 3:return a=s.stateNode,nm(),Xs(Ia),Xs(Zr),m3(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(t===null||t.child===null)&&(O0(s)?s.flags|=4:t===null||t.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,dl!==null&&(y_(dl),dl=null))),d_(t,s),Vr(s),null;case 5:h3(s);var i=Kd(Fp.current);if(n=s.type,t!==null&&s.stateNode!=null)_L(t,s,n,a,i),t.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!a){if(s.stateNode===null)throw Error(Je(166));return Vr(s),null}if(t=Kd(eo.current),O0(s)){a=s.stateNode,n=s.type;var l=s.memoizedProps;switch(a[ql]=s,a[Lp]=l,t=(s.mode&1)!==0,n){case"dialog":Gs("cancel",a),Gs("close",a);break;case"iframe":case"object":case"embed":Gs("load",a);break;case"video":case"audio":for(i=0;i<Gf.length;i++)Gs(Gf[i],a);break;case"source":Gs("error",a);break;case"img":case"image":case"link":Gs("error",a),Gs("load",a);break;case"details":Gs("toggle",a);break;case"input":JE(a,l),Gs("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!l.multiple},Gs("invalid",a);break;case"textarea":tT(a,l),Gs("invalid",a)}L2(n,l),i=null;for(var o in l)if(l.hasOwnProperty(o)){var c=l[o];o==="children"?typeof c=="string"?a.textContent!==c&&(l.suppressHydrationWarning!==!0&&D0(a.textContent,c,t),i=["children",c]):typeof c=="number"&&a.textContent!==""+c&&(l.suppressHydrationWarning!==!0&&D0(a.textContent,c,t),i=["children",""+c]):kp.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&Gs("scroll",a)}switch(n){case"input":C0(a),eT(a,l,!0);break;case"textarea":C0(a),sT(a);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(a.onclick=Oy)}a=i,s.updateQueue=a,a!==null&&(s.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=J6(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof a.is=="string"?t=o.createElement(n,{is:a.is}):(t=o.createElement(n),n==="select"&&(o=t,a.multiple?o.multiple=!0:a.size&&(o.size=a.size))):t=o.createElementNS(t,n),t[ql]=s,t[Lp]=a,jL(t,s,!1,!1),s.stateNode=t;e:{switch(o=B2(n,a),n){case"dialog":Gs("cancel",t),Gs("close",t),i=a;break;case"iframe":case"object":case"embed":Gs("load",t),i=a;break;case"video":case"audio":for(i=0;i<Gf.length;i++)Gs(Gf[i],t);i=a;break;case"source":Gs("error",t),i=a;break;case"img":case"image":case"link":Gs("error",t),Gs("load",t),i=a;break;case"details":Gs("toggle",t),i=a;break;case"input":JE(t,a),i=I2(t,a),Gs("invalid",t);break;case"option":i=a;break;case"select":t._wrapperState={wasMultiple:!!a.multiple},i=xn({},a,{value:void 0}),Gs("invalid",t);break;case"textarea":tT(t,a),i=O2(t,a),Gs("invalid",t);break;default:i=a}L2(n,i),c=i;for(l in c)if(c.hasOwnProperty(l)){var d=c[l];l==="style"?s8(t,d):l==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&e8(t,d)):l==="children"?typeof d=="string"?(n!=="textarea"||d!=="")&&Ap(t,d):typeof d=="number"&&Ap(t,""+d):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(kp.hasOwnProperty(l)?d!=null&&l==="onScroll"&&Gs("scroll",t):d!=null&&VC(t,l,d,o))}switch(n){case"input":C0(t),eT(t,a,!1);break;case"textarea":C0(t),sT(t);break;case"option":a.value!=null&&t.setAttribute("value",""+sd(a.value));break;case"select":t.multiple=!!a.multiple,l=a.value,l!=null?$h(t,!!a.multiple,l,!1):a.defaultValue!=null&&$h(t,!!a.multiple,a.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Oy)}switch(n){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return Vr(s),null;case 6:if(t&&s.stateNode!=null)SL(t,s,t.memoizedProps,a);else{if(typeof a!="string"&&s.stateNode===null)throw Error(Je(166));if(n=Kd(Fp.current),Kd(eo.current),O0(s)){if(a=s.stateNode,n=s.memoizedProps,a[ql]=s,(l=a.nodeValue!==n)&&(t=ui,t!==null))switch(t.tag){case 3:D0(a.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&D0(a.nodeValue,n,(t.mode&1)!==0)}l&&(s.flags|=4)}else a=(n.nodeType===9?n:n.ownerDocument).createTextNode(a),a[ql]=s,s.stateNode=a}return Vr(s),null;case 13:if(Xs(un),a=s.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Js&&ci!==null&&s.mode&1&&!(s.flags&128))V8(),tm(),s.flags|=98560,l=!1;else if(l=O0(s),a!==null&&a.dehydrated!==null){if(t===null){if(!l)throw Error(Je(318));if(l=s.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(Je(317));l[ql]=s}else tm(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;Vr(s),l=!1}else dl!==null&&(y_(dl),dl=null),l=!0;if(!l)return s.flags&65536?s:null}return s.flags&128?(s.lanes=n,s):(a=a!==null,a!==(t!==null&&t.memoizedState!==null)&&a&&(s.child.flags|=8192,s.mode&1&&(t===null||un.current&1?ir===0&&(ir=3):S3())),s.updateQueue!==null&&(s.flags|=4),Vr(s),null);case 4:return nm(),d_(t,s),t===null&&Op(s.stateNode.containerInfo),Vr(s),null;case 10:return o3(s.type._context),Vr(s),null;case 17:return Ma(s.type)&&Ry(),Vr(s),null;case 19:if(Xs(un),l=s.memoizedState,l===null)return Vr(s),null;if(a=(s.flags&128)!==0,o=l.rendering,o===null)if(a)_f(l,!1);else{if(ir!==0||t!==null&&t.flags&128)for(t=s.child;t!==null;){if(o=Vy(t),o!==null){for(s.flags|=128,_f(l,!1),a=o.updateQueue,a!==null&&(s.updateQueue=a,s.flags|=4),s.subtreeFlags=0,a=n,n=s.child;n!==null;)l=n,t=a,l.flags&=14680066,o=l.alternate,o===null?(l.childLanes=0,l.lanes=t,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=o.childLanes,l.lanes=o.lanes,l.child=o.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=o.memoizedProps,l.memoizedState=o.memoizedState,l.updateQueue=o.updateQueue,l.type=o.type,t=o.dependencies,l.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Us(un,un.current&1|2),s.child}t=t.sibling}l.tail!==null&&Mn()>am&&(s.flags|=128,a=!0,_f(l,!1),s.lanes=4194304)}else{if(!a)if(t=Vy(o),t!==null){if(s.flags|=128,a=!0,n=t.updateQueue,n!==null&&(s.updateQueue=n,s.flags|=4),_f(l,!0),l.tail===null&&l.tailMode==="hidden"&&!o.alternate&&!Js)return Vr(s),null}else 2*Mn()-l.renderingStartTime>am&&n!==1073741824&&(s.flags|=128,a=!0,_f(l,!1),s.lanes=4194304);l.isBackwards?(o.sibling=s.child,s.child=o):(n=l.last,n!==null?n.sibling=o:s.child=o,l.last=o)}return l.tail!==null?(s=l.tail,l.rendering=s,l.tail=s.sibling,l.renderingStartTime=Mn(),s.sibling=null,n=un.current,Us(un,a?n&1|2:n&1),s):(Vr(s),null);case 22:case 23:return _3(),a=s.memoizedState!==null,t!==null&&t.memoizedState!==null!==a&&(s.flags|=8192),a&&s.mode&1?si&1073741824&&(Vr(s),s.subtreeFlags&6&&(s.flags|=8192)):Vr(s),null;case 24:return null;case 25:return null}throw Error(Je(156,s.tag))}function TQ(t,s){switch(r3(s),s.tag){case 1:return Ma(s.type)&&Ry(),t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 3:return nm(),Xs(Ia),Xs(Zr),m3(),t=s.flags,t&65536&&!(t&128)?(s.flags=t&-65537|128,s):null;case 5:return h3(s),null;case 13:if(Xs(un),t=s.memoizedState,t!==null&&t.dehydrated!==null){if(s.alternate===null)throw Error(Je(340));tm()}return t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 19:return Xs(un),null;case 4:return nm(),null;case 10:return o3(s.type._context),null;case 22:case 23:return _3(),null;case 24:return null;default:return null}}var B0=!1,qr=!1,PQ=typeof WeakSet=="function"?WeakSet:Set,yt=null;function Ah(t,s){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(a){jn(t,s,a)}else n.current=null}function u_(t,s,n){try{n()}catch(a){jn(t,s,a)}}var WT=!1;function IQ(t,s){if(K2=Iy,t=T8(),s3(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var a=n.getSelection&&n.getSelection();if(a&&a.rangeCount!==0){n=a.anchorNode;var i=a.anchorOffset,l=a.focusNode;a=a.focusOffset;try{n.nodeType,l.nodeType}catch{n=null;break e}var o=0,c=-1,d=-1,u=0,h=0,f=t,x=null;t:for(;;){for(var b;f!==n||i!==0&&f.nodeType!==3||(c=o+i),f!==l||a!==0&&f.nodeType!==3||(d=o+a),f.nodeType===3&&(o+=f.nodeValue.length),(b=f.firstChild)!==null;)x=f,f=b;for(;;){if(f===t)break t;if(x===n&&++u===i&&(c=o),x===l&&++h===a&&(d=o),(b=f.nextSibling)!==null)break;f=x,x=f.parentNode}f=b}n=c===-1||d===-1?null:{start:c,end:d}}else n=null}n=n||{start:0,end:0}}else n=null;for(Y2={focusedElem:t,selectionRange:n},Iy=!1,yt=s;yt!==null;)if(s=yt,t=s.child,(s.subtreeFlags&1028)!==0&&t!==null)t.return=s,yt=t;else for(;yt!==null;){s=yt;try{var v=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var w=v.memoizedProps,_=v.memoizedState,S=s.stateNode,k=S.getSnapshotBeforeUpdate(s.elementType===s.type?w:ll(s.type,w),_);S.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var A=s.stateNode.containerInfo;A.nodeType===1?A.textContent="":A.nodeType===9&&A.documentElement&&A.removeChild(A.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Je(163))}}catch(T){jn(s,s.return,T)}if(t=s.sibling,t!==null){t.return=s.return,yt=t;break}yt=s.return}return v=WT,WT=!1,v}function op(t,s,n){var a=s.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var i=a=a.next;do{if((i.tag&t)===t){var l=i.destroy;i.destroy=void 0,l!==void 0&&u_(s,n,l)}i=i.next}while(i!==a)}}function Ob(t,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var n=s=s.next;do{if((n.tag&t)===t){var a=n.create;n.destroy=a()}n=n.next}while(n!==s)}}function h_(t){var s=t.ref;if(s!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof s=="function"?s(t):s.current=t}}function CL(t){var s=t.alternate;s!==null&&(t.alternate=null,CL(s)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(s=t.stateNode,s!==null&&(delete s[ql],delete s[Lp],delete s[Z2],delete s[fQ],delete s[pQ])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function kL(t){return t.tag===5||t.tag===3||t.tag===4}function qT(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||kL(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function m_(t,s,n){var a=t.tag;if(a===5||a===6)t=t.stateNode,s?n.nodeType===8?n.parentNode.insertBefore(t,s):n.insertBefore(t,s):(n.nodeType===8?(s=n.parentNode,s.insertBefore(t,n)):(s=n,s.appendChild(t)),n=n._reactRootContainer,n!=null||s.onclick!==null||(s.onclick=Oy));else if(a!==4&&(t=t.child,t!==null))for(m_(t,s,n),t=t.sibling;t!==null;)m_(t,s,n),t=t.sibling}function f_(t,s,n){var a=t.tag;if(a===5||a===6)t=t.stateNode,s?n.insertBefore(t,s):n.appendChild(t);else if(a!==4&&(t=t.child,t!==null))for(f_(t,s,n),t=t.sibling;t!==null;)f_(t,s,n),t=t.sibling}var Ir=null,ol=!1;function fc(t,s,n){for(n=n.child;n!==null;)AL(t,s,n),n=n.sibling}function AL(t,s,n){if(Jl&&typeof Jl.onCommitFiberUnmount=="function")try{Jl.onCommitFiberUnmount(kb,n)}catch{}switch(n.tag){case 5:qr||Ah(n,s);case 6:var a=Ir,i=ol;Ir=null,fc(t,s,n),Ir=a,ol=i,Ir!==null&&(ol?(t=Ir,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ir.removeChild(n.stateNode));break;case 18:Ir!==null&&(ol?(t=Ir,n=n.stateNode,t.nodeType===8?fw(t.parentNode,n):t.nodeType===1&&fw(t,n),Ip(t)):fw(Ir,n.stateNode));break;case 4:a=Ir,i=ol,Ir=n.stateNode.containerInfo,ol=!0,fc(t,s,n),Ir=a,ol=i;break;case 0:case 11:case 14:case 15:if(!qr&&(a=n.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){i=a=a.next;do{var l=i,o=l.destroy;l=l.tag,o!==void 0&&(l&2||l&4)&&u_(n,s,o),i=i.next}while(i!==a)}fc(t,s,n);break;case 1:if(!qr&&(Ah(n,s),a=n.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=n.memoizedProps,a.state=n.memoizedState,a.componentWillUnmount()}catch(c){jn(n,s,c)}fc(t,s,n);break;case 21:fc(t,s,n);break;case 22:n.mode&1?(qr=(a=qr)||n.memoizedState!==null,fc(t,s,n),qr=a):fc(t,s,n);break;default:fc(t,s,n)}}function GT(t){var s=t.updateQueue;if(s!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new PQ),s.forEach(function(a){var i=zQ.bind(null,t,a);n.has(a)||(n.add(a),a.then(i,i))})}}function nl(t,s){var n=s.deletions;if(n!==null)for(var a=0;a<n.length;a++){var i=n[a];try{var l=t,o=s,c=o;e:for(;c!==null;){switch(c.tag){case 5:Ir=c.stateNode,ol=!1;break e;case 3:Ir=c.stateNode.containerInfo,ol=!0;break e;case 4:Ir=c.stateNode.containerInfo,ol=!0;break e}c=c.return}if(Ir===null)throw Error(Je(160));AL(l,o,i),Ir=null,ol=!1;var d=i.alternate;d!==null&&(d.return=null),i.return=null}catch(u){jn(i,s,u)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)EL(s,t),s=s.sibling}function EL(t,s){var n=t.alternate,a=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(nl(s,t),Ll(t),a&4){try{op(3,t,t.return),Ob(3,t)}catch(w){jn(t,t.return,w)}try{op(5,t,t.return)}catch(w){jn(t,t.return,w)}}break;case 1:nl(s,t),Ll(t),a&512&&n!==null&&Ah(n,n.return);break;case 5:if(nl(s,t),Ll(t),a&512&&n!==null&&Ah(n,n.return),t.flags&32){var i=t.stateNode;try{Ap(i,"")}catch(w){jn(t,t.return,w)}}if(a&4&&(i=t.stateNode,i!=null)){var l=t.memoizedProps,o=n!==null?n.memoizedProps:l,c=t.type,d=t.updateQueue;if(t.updateQueue=null,d!==null)try{c==="input"&&l.type==="radio"&&l.name!=null&&Q6(i,l),B2(c,o);var u=B2(c,l);for(o=0;o<d.length;o+=2){var h=d[o],f=d[o+1];h==="style"?s8(i,f):h==="dangerouslySetInnerHTML"?e8(i,f):h==="children"?Ap(i,f):VC(i,h,f,u)}switch(c){case"input":M2(i,l);break;case"textarea":Z6(i,l);break;case"select":var x=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!l.multiple;var b=l.value;b!=null?$h(i,!!l.multiple,b,!1):x!==!!l.multiple&&(l.defaultValue!=null?$h(i,!!l.multiple,l.defaultValue,!0):$h(i,!!l.multiple,l.multiple?[]:"",!1))}i[Lp]=l}catch(w){jn(t,t.return,w)}}break;case 6:if(nl(s,t),Ll(t),a&4){if(t.stateNode===null)throw Error(Je(162));i=t.stateNode,l=t.memoizedProps;try{i.nodeValue=l}catch(w){jn(t,t.return,w)}}break;case 3:if(nl(s,t),Ll(t),a&4&&n!==null&&n.memoizedState.isDehydrated)try{Ip(s.containerInfo)}catch(w){jn(t,t.return,w)}break;case 4:nl(s,t),Ll(t);break;case 13:nl(s,t),Ll(t),i=t.child,i.flags&8192&&(l=i.memoizedState!==null,i.stateNode.isHidden=l,!l||i.alternate!==null&&i.alternate.memoizedState!==null||(w3=Mn())),a&4&&GT(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(qr=(u=qr)||h,nl(s,t),qr=u):nl(s,t),Ll(t),a&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!h&&t.mode&1)for(yt=t,h=t.child;h!==null;){for(f=yt=h;yt!==null;){switch(x=yt,b=x.child,x.tag){case 0:case 11:case 14:case 15:op(4,x,x.return);break;case 1:Ah(x,x.return);var v=x.stateNode;if(typeof v.componentWillUnmount=="function"){a=x,n=x.return;try{s=a,v.props=s.memoizedProps,v.state=s.memoizedState,v.componentWillUnmount()}catch(w){jn(a,n,w)}}break;case 5:Ah(x,x.return);break;case 22:if(x.memoizedState!==null){YT(f);continue}}b!==null?(b.return=x,yt=b):YT(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{i=f.stateNode,u?(l=i.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(c=f.stateNode,d=f.memoizedProps.style,o=d!=null&&d.hasOwnProperty("display")?d.display:null,c.style.display=t8("display",o))}catch(w){jn(t,t.return,w)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(w){jn(t,t.return,w)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:nl(s,t),Ll(t),a&4&&GT(t);break;case 21:break;default:nl(s,t),Ll(t)}}function Ll(t){var s=t.flags;if(s&2){try{e:{for(var n=t.return;n!==null;){if(kL(n)){var a=n;break e}n=n.return}throw Error(Je(160))}switch(a.tag){case 5:var i=a.stateNode;a.flags&32&&(Ap(i,""),a.flags&=-33);var l=qT(t);f_(t,l,i);break;case 3:case 4:var o=a.stateNode.containerInfo,c=qT(t);m_(t,c,o);break;default:throw Error(Je(161))}}catch(d){jn(t,t.return,d)}t.flags&=-3}s&4096&&(t.flags&=-4097)}function MQ(t,s,n){yt=t,TL(t)}function TL(t,s,n){for(var a=(t.mode&1)!==0;yt!==null;){var i=yt,l=i.child;if(i.tag===22&&a){var o=i.memoizedState!==null||B0;if(!o){var c=i.alternate,d=c!==null&&c.memoizedState!==null||qr;c=B0;var u=qr;if(B0=o,(qr=d)&&!u)for(yt=i;yt!==null;)o=yt,d=o.child,o.tag===22&&o.memoizedState!==null?XT(i):d!==null?(d.return=o,yt=d):XT(i);for(;l!==null;)yt=l,TL(l),l=l.sibling;yt=i,B0=c,qr=u}KT(t)}else i.subtreeFlags&8772&&l!==null?(l.return=i,yt=l):KT(t)}}function KT(t){for(;yt!==null;){var s=yt;if(s.flags&8772){var n=s.alternate;try{if(s.flags&8772)switch(s.tag){case 0:case 11:case 15:qr||Ob(5,s);break;case 1:var a=s.stateNode;if(s.flags&4&&!qr)if(n===null)a.componentDidMount();else{var i=s.elementType===s.type?n.memoizedProps:ll(s.type,n.memoizedProps);a.componentDidUpdate(i,n.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var l=s.updateQueue;l!==null&&IT(s,l,a);break;case 3:var o=s.updateQueue;if(o!==null){if(n=null,s.child!==null)switch(s.child.tag){case 5:n=s.child.stateNode;break;case 1:n=s.child.stateNode}IT(s,o,n)}break;case 5:var c=s.stateNode;if(n===null&&s.flags&4){n=c;var d=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&n.focus();break;case"img":d.src&&(n.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var u=s.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&Ip(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Je(163))}qr||s.flags&512&&h_(s)}catch(x){jn(s,s.return,x)}}if(s===t){yt=null;break}if(n=s.sibling,n!==null){n.return=s.return,yt=n;break}yt=s.return}}function YT(t){for(;yt!==null;){var s=yt;if(s===t){yt=null;break}var n=s.sibling;if(n!==null){n.return=s.return,yt=n;break}yt=s.return}}function XT(t){for(;yt!==null;){var s=yt;try{switch(s.tag){case 0:case 11:case 15:var n=s.return;try{Ob(4,s)}catch(d){jn(s,n,d)}break;case 1:var a=s.stateNode;if(typeof a.componentDidMount=="function"){var i=s.return;try{a.componentDidMount()}catch(d){jn(s,i,d)}}var l=s.return;try{h_(s)}catch(d){jn(s,l,d)}break;case 5:var o=s.return;try{h_(s)}catch(d){jn(s,o,d)}}}catch(d){jn(s,s.return,d)}if(s===t){yt=null;break}var c=s.sibling;if(c!==null){c.return=s.return,yt=c;break}yt=s.return}}var DQ=Math.ceil,qy=ec.ReactCurrentDispatcher,v3=ec.ReactCurrentOwner,Ri=ec.ReactCurrentBatchConfig,fs=0,br=null,Wn=null,Br=0,si=0,Eh=md(0),ir=0,Vp=null,Nu=0,Rb=0,N3=0,cp=null,Aa=null,w3=0,am=1/0,Co=null,Gy=!1,p_=null,Kc=null,F0=!1,Bc=null,Ky=0,dp=0,x_=null,Qg=-1,Zg=0;function ma(){return fs&6?Mn():Qg!==-1?Qg:Qg=Mn()}function Yc(t){return t.mode&1?fs&2&&Br!==0?Br&-Br:gQ.transition!==null?(Zg===0&&(Zg=f8()),Zg):(t=Ss,t!==0||(t=window.event,t=t===void 0?16:N8(t.type)),t):1}function xl(t,s,n,a){if(50<dp)throw dp=0,x_=null,Error(Je(185));Ix(t,n,a),(!(fs&2)||t!==br)&&(t===br&&(!(fs&2)&&(Rb|=n),ir===4&&Ec(t,Br)),Da(t,a),n===1&&fs===0&&!(s.mode&1)&&(am=Mn()+500,Ib&&fd()))}function Da(t,s){var n=t.callbackNode;gX(t,s);var a=Py(t,t===br?Br:0);if(a===0)n!==null&&aT(n),t.callbackNode=null,t.callbackPriority=0;else if(s=a&-a,t.callbackPriority!==s){if(n!=null&&aT(n),s===1)t.tag===0?xQ(QT.bind(null,t)):$8(QT.bind(null,t)),hQ(function(){!(fs&6)&&fd()}),n=null;else{switch(p8(a)){case 1:n=KC;break;case 4:n=h8;break;case 16:n=Ty;break;case 536870912:n=m8;break;default:n=Ty}n=BL(n,PL.bind(null,t))}t.callbackPriority=s,t.callbackNode=n}}function PL(t,s){if(Qg=-1,Zg=0,fs&6)throw Error(Je(327));var n=t.callbackNode;if(Wh()&&t.callbackNode!==n)return null;var a=Py(t,t===br?Br:0);if(a===0)return null;if(a&30||a&t.expiredLanes||s)s=Yy(t,a);else{s=a;var i=fs;fs|=2;var l=ML();(br!==t||Br!==s)&&(Co=null,am=Mn()+500,ru(t,s));do try{LQ();break}catch(c){IL(t,c)}while(!0);l3(),qy.current=l,fs=i,Wn!==null?s=0:(br=null,Br=0,s=ir)}if(s!==0){if(s===2&&(i=V2(t),i!==0&&(a=i,s=g_(t,i))),s===1)throw n=Vp,ru(t,0),Ec(t,a),Da(t,Mn()),n;if(s===6)Ec(t,a);else{if(i=t.current.alternate,!(a&30)&&!OQ(i)&&(s=Yy(t,a),s===2&&(l=V2(t),l!==0&&(a=l,s=g_(t,l))),s===1))throw n=Vp,ru(t,0),Ec(t,a),Da(t,Mn()),n;switch(t.finishedWork=i,t.finishedLanes=a,s){case 0:case 1:throw Error(Je(345));case 2:Fd(t,Aa,Co);break;case 3:if(Ec(t,a),(a&130023424)===a&&(s=w3+500-Mn(),10<s)){if(Py(t,0)!==0)break;if(i=t.suspendedLanes,(i&a)!==a){ma(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Q2(Fd.bind(null,t,Aa,Co),s);break}Fd(t,Aa,Co);break;case 4:if(Ec(t,a),(a&4194240)===a)break;for(s=t.eventTimes,i=-1;0<a;){var o=31-pl(a);l=1<<o,o=s[o],o>i&&(i=o),a&=~l}if(a=i,a=Mn()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*DQ(a/1960))-a,10<a){t.timeoutHandle=Q2(Fd.bind(null,t,Aa,Co),a);break}Fd(t,Aa,Co);break;case 5:Fd(t,Aa,Co);break;default:throw Error(Je(329))}}}return Da(t,Mn()),t.callbackNode===n?PL.bind(null,t):null}function g_(t,s){var n=cp;return t.current.memoizedState.isDehydrated&&(ru(t,s).flags|=256),t=Yy(t,s),t!==2&&(s=Aa,Aa=n,s!==null&&y_(s)),t}function y_(t){Aa===null?Aa=t:Aa.push.apply(Aa,t)}function OQ(t){for(var s=t;;){if(s.flags&16384){var n=s.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var a=0;a<n.length;a++){var i=n[a],l=i.getSnapshot;i=i.value;try{if(!yl(l(),i))return!1}catch{return!1}}}if(n=s.child,s.subtreeFlags&16384&&n!==null)n.return=s,s=n;else{if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Ec(t,s){for(s&=~N3,s&=~Rb,t.suspendedLanes|=s,t.pingedLanes&=~s,t=t.expirationTimes;0<s;){var n=31-pl(s),a=1<<n;t[n]=-1,s&=~a}}function QT(t){if(fs&6)throw Error(Je(327));Wh();var s=Py(t,0);if(!(s&1))return Da(t,Mn()),null;var n=Yy(t,s);if(t.tag!==0&&n===2){var a=V2(t);a!==0&&(s=a,n=g_(t,a))}if(n===1)throw n=Vp,ru(t,0),Ec(t,s),Da(t,Mn()),n;if(n===6)throw Error(Je(345));return t.finishedWork=t.current.alternate,t.finishedLanes=s,Fd(t,Aa,Co),Da(t,Mn()),null}function j3(t,s){var n=fs;fs|=1;try{return t(s)}finally{fs=n,fs===0&&(am=Mn()+500,Ib&&fd())}}function wu(t){Bc!==null&&Bc.tag===0&&!(fs&6)&&Wh();var s=fs;fs|=1;var n=Ri.transition,a=Ss;try{if(Ri.transition=null,Ss=1,t)return t()}finally{Ss=a,Ri.transition=n,fs=s,!(fs&6)&&fd()}}function _3(){si=Eh.current,Xs(Eh)}function ru(t,s){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,uQ(n)),Wn!==null)for(n=Wn.return;n!==null;){var a=n;switch(r3(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&Ry();break;case 3:nm(),Xs(Ia),Xs(Zr),m3();break;case 5:h3(a);break;case 4:nm();break;case 13:Xs(un);break;case 19:Xs(un);break;case 10:o3(a.type._context);break;case 22:case 23:_3()}n=n.return}if(br=t,Wn=t=Xc(t.current,null),Br=si=s,ir=0,Vp=null,N3=Rb=Nu=0,Aa=cp=null,Gd!==null){for(s=0;s<Gd.length;s++)if(n=Gd[s],a=n.interleaved,a!==null){n.interleaved=null;var i=a.next,l=n.pending;if(l!==null){var o=l.next;l.next=i,a.next=o}n.pending=a}Gd=null}return t}function IL(t,s){do{var n=Wn;try{if(l3(),Kg.current=Wy,Hy){for(var a=fn.memoizedState;a!==null;){var i=a.queue;i!==null&&(i.pending=null),a=a.next}Hy=!1}if(vu=0,gr=er=fn=null,lp=!1,$p=0,v3.current=null,n===null||n.return===null){ir=1,Vp=s,Wn=null;break}e:{var l=t,o=n.return,c=n,d=s;if(s=Br,c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var u=d,h=c,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var x=h.alternate;x?(h.updateQueue=x.updateQueue,h.memoizedState=x.memoizedState,h.lanes=x.lanes):(h.updateQueue=null,h.memoizedState=null)}var b=BT(o);if(b!==null){b.flags&=-257,FT(b,o,c,l,s),b.mode&1&&LT(l,u,s),s=b,d=u;var v=s.updateQueue;if(v===null){var w=new Set;w.add(d),s.updateQueue=w}else v.add(d);break e}else{if(!(s&1)){LT(l,u,s),S3();break e}d=Error(Je(426))}}else if(Js&&c.mode&1){var _=BT(o);if(_!==null){!(_.flags&65536)&&(_.flags|=256),FT(_,o,c,l,s),a3(rm(d,c));break e}}l=d=rm(d,c),ir!==4&&(ir=2),cp===null?cp=[l]:cp.push(l),l=o;do{switch(l.tag){case 3:l.flags|=65536,s&=-s,l.lanes|=s;var S=pL(l,d,s);PT(l,S);break e;case 1:c=d;var k=l.type,A=l.stateNode;if(!(l.flags&128)&&(typeof k.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Kc===null||!Kc.has(A)))){l.flags|=65536,s&=-s,l.lanes|=s;var T=xL(l,c,s);PT(l,T);break e}}l=l.return}while(l!==null)}OL(n)}catch(P){s=P,Wn===n&&n!==null&&(Wn=n=n.return);continue}break}while(!0)}function ML(){var t=qy.current;return qy.current=Wy,t===null?Wy:t}function S3(){(ir===0||ir===3||ir===2)&&(ir=4),br===null||!(Nu&268435455)&&!(Rb&268435455)||Ec(br,Br)}function Yy(t,s){var n=fs;fs|=2;var a=ML();(br!==t||Br!==s)&&(Co=null,ru(t,s));do try{RQ();break}catch(i){IL(t,i)}while(!0);if(l3(),fs=n,qy.current=a,Wn!==null)throw Error(Je(261));return br=null,Br=0,ir}function RQ(){for(;Wn!==null;)DL(Wn)}function LQ(){for(;Wn!==null&&!oX();)DL(Wn)}function DL(t){var s=LL(t.alternate,t,si);t.memoizedProps=t.pendingProps,s===null?OL(t):Wn=s,v3.current=null}function OL(t){var s=t;do{var n=s.alternate;if(t=s.return,s.flags&32768){if(n=TQ(n,s),n!==null){n.flags&=32767,Wn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ir=6,Wn=null;return}}else if(n=EQ(n,s,si),n!==null){Wn=n;return}if(s=s.sibling,s!==null){Wn=s;return}Wn=s=t}while(s!==null);ir===0&&(ir=5)}function Fd(t,s,n){var a=Ss,i=Ri.transition;try{Ri.transition=null,Ss=1,BQ(t,s,n,a)}finally{Ri.transition=i,Ss=a}return null}function BQ(t,s,n,a){do Wh();while(Bc!==null);if(fs&6)throw Error(Je(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Je(177));t.callbackNode=null,t.callbackPriority=0;var l=n.lanes|n.childLanes;if(yX(t,l),t===br&&(Wn=br=null,Br=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||F0||(F0=!0,BL(Ty,function(){return Wh(),null})),l=(n.flags&15990)!==0,n.subtreeFlags&15990||l){l=Ri.transition,Ri.transition=null;var o=Ss;Ss=1;var c=fs;fs|=4,v3.current=null,IQ(t,n),EL(n,t),rQ(Y2),Iy=!!K2,Y2=K2=null,t.current=n,MQ(n),cX(),fs=c,Ss=o,Ri.transition=l}else t.current=n;if(F0&&(F0=!1,Bc=t,Ky=i),l=t.pendingLanes,l===0&&(Kc=null),hX(n.stateNode),Da(t,Mn()),s!==null)for(a=t.onRecoverableError,n=0;n<s.length;n++)i=s[n],a(i.value,{componentStack:i.stack,digest:i.digest});if(Gy)throw Gy=!1,t=p_,p_=null,t;return Ky&1&&t.tag!==0&&Wh(),l=t.pendingLanes,l&1?t===x_?dp++:(dp=0,x_=t):dp=0,fd(),null}function Wh(){if(Bc!==null){var t=p8(Ky),s=Ri.transition,n=Ss;try{if(Ri.transition=null,Ss=16>t?16:t,Bc===null)var a=!1;else{if(t=Bc,Bc=null,Ky=0,fs&6)throw Error(Je(331));var i=fs;for(fs|=4,yt=t.current;yt!==null;){var l=yt,o=l.child;if(yt.flags&16){var c=l.deletions;if(c!==null){for(var d=0;d<c.length;d++){var u=c[d];for(yt=u;yt!==null;){var h=yt;switch(h.tag){case 0:case 11:case 15:op(8,h,l)}var f=h.child;if(f!==null)f.return=h,yt=f;else for(;yt!==null;){h=yt;var x=h.sibling,b=h.return;if(CL(h),h===u){yt=null;break}if(x!==null){x.return=b,yt=x;break}yt=b}}}var v=l.alternate;if(v!==null){var w=v.child;if(w!==null){v.child=null;do{var _=w.sibling;w.sibling=null,w=_}while(w!==null)}}yt=l}}if(l.subtreeFlags&2064&&o!==null)o.return=l,yt=o;else e:for(;yt!==null;){if(l=yt,l.flags&2048)switch(l.tag){case 0:case 11:case 15:op(9,l,l.return)}var S=l.sibling;if(S!==null){S.return=l.return,yt=S;break e}yt=l.return}}var k=t.current;for(yt=k;yt!==null;){o=yt;var A=o.child;if(o.subtreeFlags&2064&&A!==null)A.return=o,yt=A;else e:for(o=k;yt!==null;){if(c=yt,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Ob(9,c)}}catch(P){jn(c,c.return,P)}if(c===o){yt=null;break e}var T=c.sibling;if(T!==null){T.return=c.return,yt=T;break e}yt=c.return}}if(fs=i,fd(),Jl&&typeof Jl.onPostCommitFiberRoot=="function")try{Jl.onPostCommitFiberRoot(kb,t)}catch{}a=!0}return a}finally{Ss=n,Ri.transition=s}}return!1}function ZT(t,s,n){s=rm(n,s),s=pL(t,s,1),t=Gc(t,s,1),s=ma(),t!==null&&(Ix(t,1,s),Da(t,s))}function jn(t,s,n){if(t.tag===3)ZT(t,t,n);else for(;s!==null;){if(s.tag===3){ZT(s,t,n);break}else if(s.tag===1){var a=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(Kc===null||!Kc.has(a))){t=rm(n,t),t=xL(s,t,1),s=Gc(s,t,1),t=ma(),s!==null&&(Ix(s,1,t),Da(s,t));break}}s=s.return}}function FQ(t,s,n){var a=t.pingCache;a!==null&&a.delete(s),s=ma(),t.pingedLanes|=t.suspendedLanes&n,br===t&&(Br&n)===n&&(ir===4||ir===3&&(Br&130023424)===Br&&500>Mn()-w3?ru(t,0):N3|=n),Da(t,s)}function RL(t,s){s===0&&(t.mode&1?(s=E0,E0<<=1,!(E0&130023424)&&(E0=4194304)):s=1);var n=ma();t=$o(t,s),t!==null&&(Ix(t,s,n),Da(t,n))}function $Q(t){var s=t.memoizedState,n=0;s!==null&&(n=s.retryLane),RL(t,n)}function zQ(t,s){var n=0;switch(t.tag){case 13:var a=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:a=t.stateNode;break;default:throw Error(Je(314))}a!==null&&a.delete(s),RL(t,n)}var LL;LL=function(t,s,n){if(t!==null)if(t.memoizedProps!==s.pendingProps||Ia.current)Ea=!0;else{if(!(t.lanes&n)&&!(s.flags&128))return Ea=!1,AQ(t,s,n);Ea=!!(t.flags&131072)}else Ea=!1,Js&&s.flags&1048576&&z8(s,Fy,s.index);switch(s.lanes=0,s.tag){case 2:var a=s.type;Xg(t,s),t=s.pendingProps;var i=em(s,Zr.current);Hh(s,n),i=p3(null,s,a,t,i,n);var l=x3();return s.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,Ma(a)?(l=!0,Ly(s)):l=!1,s.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,d3(s),i.updater=Db,s.stateNode=i,i._reactInternals=s,r_(s,a,t,n),s=l_(null,s,a,!0,l,n)):(s.tag=0,Js&&l&&n3(s),oa(null,s,i,n),s=s.child),s;case 16:a=s.elementType;e:{switch(Xg(t,s),t=s.pendingProps,i=a._init,a=i(a._payload),s.type=a,i=s.tag=VQ(a),t=ll(a,t),i){case 0:s=i_(null,s,a,t,n);break e;case 1:s=UT(null,s,a,t,n);break e;case 11:s=$T(null,s,a,t,n);break e;case 14:s=zT(null,s,a,ll(a.type,t),n);break e}throw Error(Je(306,a,""))}return s;case 0:return a=s.type,i=s.pendingProps,i=s.elementType===a?i:ll(a,i),i_(t,s,a,i,n);case 1:return a=s.type,i=s.pendingProps,i=s.elementType===a?i:ll(a,i),UT(t,s,a,i,n);case 3:e:{if(vL(s),t===null)throw Error(Je(387));a=s.pendingProps,l=s.memoizedState,i=l.element,G8(t,s),Uy(s,a,null,n);var o=s.memoizedState;if(a=o.element,l.isDehydrated)if(l={element:a,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},s.updateQueue.baseState=l,s.memoizedState=l,s.flags&256){i=rm(Error(Je(423)),s),s=VT(t,s,a,n,i);break e}else if(a!==i){i=rm(Error(Je(424)),s),s=VT(t,s,a,n,i);break e}else for(ci=qc(s.stateNode.containerInfo.firstChild),ui=s,Js=!0,dl=null,n=W8(s,null,a,n),s.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(tm(),a===i){s=zo(t,s,n);break e}oa(t,s,a,n)}s=s.child}return s;case 5:return K8(s),t===null&&t_(s),a=s.type,i=s.pendingProps,l=t!==null?t.memoizedProps:null,o=i.children,X2(a,i)?o=null:l!==null&&X2(a,l)&&(s.flags|=32),bL(t,s),oa(t,s,o,n),s.child;case 6:return t===null&&t_(s),null;case 13:return NL(t,s,n);case 4:return u3(s,s.stateNode.containerInfo),a=s.pendingProps,t===null?s.child=sm(s,null,a,n):oa(t,s,a,n),s.child;case 11:return a=s.type,i=s.pendingProps,i=s.elementType===a?i:ll(a,i),$T(t,s,a,i,n);case 7:return oa(t,s,s.pendingProps,n),s.child;case 8:return oa(t,s,s.pendingProps.children,n),s.child;case 12:return oa(t,s,s.pendingProps.children,n),s.child;case 10:e:{if(a=s.type._context,i=s.pendingProps,l=s.memoizedProps,o=i.value,Us($y,a._currentValue),a._currentValue=o,l!==null)if(yl(l.value,o)){if(l.children===i.children&&!Ia.current){s=zo(t,s,n);break e}}else for(l=s.child,l!==null&&(l.return=s);l!==null;){var c=l.dependencies;if(c!==null){o=l.child;for(var d=c.firstContext;d!==null;){if(d.context===a){if(l.tag===1){d=Oo(-1,n&-n),d.tag=2;var u=l.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?d.next=d:(d.next=h.next,h.next=d),u.pending=d}}l.lanes|=n,d=l.alternate,d!==null&&(d.lanes|=n),s_(l.return,n,s),c.lanes|=n;break}d=d.next}}else if(l.tag===10)o=l.type===s.type?null:l.child;else if(l.tag===18){if(o=l.return,o===null)throw Error(Je(341));o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),s_(o,n,s),o=l.sibling}else o=l.child;if(o!==null)o.return=l;else for(o=l;o!==null;){if(o===s){o=null;break}if(l=o.sibling,l!==null){l.return=o.return,o=l;break}o=o.return}l=o}oa(t,s,i.children,n),s=s.child}return s;case 9:return i=s.type,a=s.pendingProps.children,Hh(s,n),i=$i(i),a=a(i),s.flags|=1,oa(t,s,a,n),s.child;case 14:return a=s.type,i=ll(a,s.pendingProps),i=ll(a.type,i),zT(t,s,a,i,n);case 15:return gL(t,s,s.type,s.pendingProps,n);case 17:return a=s.type,i=s.pendingProps,i=s.elementType===a?i:ll(a,i),Xg(t,s),s.tag=1,Ma(a)?(t=!0,Ly(s)):t=!1,Hh(s,n),fL(s,a,i),r_(s,a,i,n),l_(null,s,a,!0,t,n);case 19:return wL(t,s,n);case 22:return yL(t,s,n)}throw Error(Je(156,s.tag))};function BL(t,s){return u8(t,s)}function UQ(t,s,n,a){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mi(t,s,n,a){return new UQ(t,s,n,a)}function C3(t){return t=t.prototype,!(!t||!t.isReactComponent)}function VQ(t){if(typeof t=="function")return C3(t)?1:0;if(t!=null){if(t=t.$$typeof,t===WC)return 11;if(t===qC)return 14}return 2}function Xc(t,s){var n=t.alternate;return n===null?(n=Mi(t.tag,s,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=s,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,s=t.dependencies,n.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Jg(t,s,n,a,i,l){var o=2;if(a=t,typeof t=="function")C3(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case bh:return au(n.children,i,l,s);case HC:o=8,i|=8;break;case A2:return t=Mi(12,n,s,i|2),t.elementType=A2,t.lanes=l,t;case E2:return t=Mi(13,n,s,i),t.elementType=E2,t.lanes=l,t;case T2:return t=Mi(19,n,s,i),t.elementType=T2,t.lanes=l,t;case K6:return Lb(n,i,l,s);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case q6:o=10;break e;case G6:o=9;break e;case WC:o=11;break e;case qC:o=14;break e;case wc:o=16,a=null;break e}throw Error(Je(130,t==null?t:typeof t,""))}return s=Mi(o,n,s,i),s.elementType=t,s.type=a,s.lanes=l,s}function au(t,s,n,a){return t=Mi(7,t,a,s),t.lanes=n,t}function Lb(t,s,n,a){return t=Mi(22,t,a,s),t.elementType=K6,t.lanes=n,t.stateNode={isHidden:!1},t}function ww(t,s,n){return t=Mi(6,t,null,s),t.lanes=n,t}function jw(t,s,n){return s=Mi(4,t.children!==null?t.children:[],t.key,s),s.lanes=n,s.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},s}function HQ(t,s,n,a,i){this.tag=s,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=nw(0),this.expirationTimes=nw(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nw(0),this.identifierPrefix=a,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function k3(t,s,n,a,i,l,o,c,d){return t=new HQ(t,s,n,c,d),s===1?(s=1,l===!0&&(s|=8)):s=0,l=Mi(3,null,null,s),t.current=l,l.stateNode=t,l.memoizedState={element:a,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},d3(l),t}function WQ(t,s,n){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:yh,key:a==null?null:""+a,children:t,containerInfo:s,implementation:n}}function FL(t){if(!t)return nd;t=t._reactInternals;e:{if(Vu(t)!==t||t.tag!==1)throw Error(Je(170));var s=t;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(Ma(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(Je(171))}if(t.tag===1){var n=t.type;if(Ma(n))return F8(t,n,s)}return s}function $L(t,s,n,a,i,l,o,c,d){return t=k3(n,a,!0,t,i,l,o,c,d),t.context=FL(null),n=t.current,a=ma(),i=Yc(n),l=Oo(a,i),l.callback=s??null,Gc(n,l,i),t.current.lanes=i,Ix(t,i,a),Da(t,a),t}function Bb(t,s,n,a){var i=s.current,l=ma(),o=Yc(i);return n=FL(n),s.context===null?s.context=n:s.pendingContext=n,s=Oo(l,o),s.payload={element:t},a=a===void 0?null:a,a!==null&&(s.callback=a),t=Gc(i,s,o),t!==null&&(xl(t,i,o,l),Gg(t,i,o)),o}function Xy(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function JT(t,s){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<s?n:s}}function A3(t,s){JT(t,s),(t=t.alternate)&&JT(t,s)}function qQ(){return null}var zL=typeof reportError=="function"?reportError:function(t){console.error(t)};function E3(t){this._internalRoot=t}Fb.prototype.render=E3.prototype.render=function(t){var s=this._internalRoot;if(s===null)throw Error(Je(409));Bb(t,s,null,null)};Fb.prototype.unmount=E3.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var s=t.containerInfo;wu(function(){Bb(null,t,null,null)}),s[Fo]=null}};function Fb(t){this._internalRoot=t}Fb.prototype.unstable_scheduleHydration=function(t){if(t){var s=y8();t={blockedOn:null,target:t,priority:s};for(var n=0;n<Ac.length&&s!==0&&s<Ac[n].priority;n++);Ac.splice(n,0,t),n===0&&v8(t)}};function T3(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function $b(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function e4(){}function GQ(t,s,n,a,i){if(i){if(typeof a=="function"){var l=a;a=function(){var u=Xy(o);l.call(u)}}var o=$L(s,a,t,0,null,!1,!1,"",e4);return t._reactRootContainer=o,t[Fo]=o.current,Op(t.nodeType===8?t.parentNode:t),wu(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof a=="function"){var c=a;a=function(){var u=Xy(d);c.call(u)}}var d=k3(t,0,!1,null,null,!1,!1,"",e4);return t._reactRootContainer=d,t[Fo]=d.current,Op(t.nodeType===8?t.parentNode:t),wu(function(){Bb(s,d,n,a)}),d}function zb(t,s,n,a,i){var l=n._reactRootContainer;if(l){var o=l;if(typeof i=="function"){var c=i;i=function(){var d=Xy(o);c.call(d)}}Bb(s,o,t,i)}else o=GQ(n,s,t,i,a);return Xy(o)}x8=function(t){switch(t.tag){case 3:var s=t.stateNode;if(s.current.memoizedState.isDehydrated){var n=qf(s.pendingLanes);n!==0&&(YC(s,n|1),Da(s,Mn()),!(fs&6)&&(am=Mn()+500,fd()))}break;case 13:wu(function(){var a=$o(t,1);if(a!==null){var i=ma();xl(a,t,1,i)}}),A3(t,1)}};XC=function(t){if(t.tag===13){var s=$o(t,134217728);if(s!==null){var n=ma();xl(s,t,134217728,n)}A3(t,134217728)}};g8=function(t){if(t.tag===13){var s=Yc(t),n=$o(t,s);if(n!==null){var a=ma();xl(n,t,s,a)}A3(t,s)}};y8=function(){return Ss};b8=function(t,s){var n=Ss;try{return Ss=t,s()}finally{Ss=n}};$2=function(t,s,n){switch(s){case"input":if(M2(t,n),s=n.name,n.type==="radio"&&s!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<n.length;s++){var a=n[s];if(a!==t&&a.form===t.form){var i=Pb(a);if(!i)throw Error(Je(90));X6(a),M2(a,i)}}}break;case"textarea":Z6(t,n);break;case"select":s=n.value,s!=null&&$h(t,!!n.multiple,s,!1)}};a8=j3;i8=wu;var KQ={usingClientEntryPoint:!1,Events:[Dx,jh,Pb,n8,r8,j3]},Sf={findFiberByHostInstance:qd,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},YQ={bundleType:Sf.bundleType,version:Sf.version,rendererPackageName:Sf.rendererPackageName,rendererConfig:Sf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ec.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=c8(t),t===null?null:t.stateNode},findFiberByHostInstance:Sf.findFiberByHostInstance||qQ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$0.isDisabled&&$0.supportsFiber)try{kb=$0.inject(YQ),Jl=$0}catch{}}yi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=KQ;yi.createPortal=function(t,s){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!T3(s))throw Error(Je(200));return WQ(t,s,null,n)};yi.createRoot=function(t,s){if(!T3(t))throw Error(Je(299));var n=!1,a="",i=zL;return s!=null&&(s.unstable_strictMode===!0&&(n=!0),s.identifierPrefix!==void 0&&(a=s.identifierPrefix),s.onRecoverableError!==void 0&&(i=s.onRecoverableError)),s=k3(t,1,!1,null,null,n,!1,a,i),t[Fo]=s.current,Op(t.nodeType===8?t.parentNode:t),new E3(s)};yi.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var s=t._reactInternals;if(s===void 0)throw typeof t.render=="function"?Error(Je(188)):(t=Object.keys(t).join(","),Error(Je(268,t)));return t=c8(s),t=t===null?null:t.stateNode,t};yi.flushSync=function(t){return wu(t)};yi.hydrate=function(t,s,n){if(!$b(s))throw Error(Je(200));return zb(null,t,s,!0,n)};yi.hydrateRoot=function(t,s,n){if(!T3(t))throw Error(Je(405));var a=n!=null&&n.hydratedSources||null,i=!1,l="",o=zL;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),s=$L(s,null,t,1,n??null,i,!1,l,o),t[Fo]=s.current,Op(t),a)for(t=0;t<a.length;t++)n=a[t],i=n._getVersion,i=i(n._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[n,i]:s.mutableSourceEagerHydrationData.push(n,i);return new Fb(s)};yi.render=function(t,s,n){if(!$b(s))throw Error(Je(200));return zb(null,t,s,!1,n)};yi.unmountComponentAtNode=function(t){if(!$b(t))throw Error(Je(40));return t._reactRootContainer?(wu(function(){zb(null,null,t,!1,function(){t._reactRootContainer=null,t[Fo]=null})}),!0):!1};yi.unstable_batchedUpdates=j3;yi.unstable_renderSubtreeIntoContainer=function(t,s,n,a){if(!$b(n))throw Error(Je(200));if(t==null||t._reactInternals===void 0)throw Error(Je(38));return zb(t,s,n,!1,a)};yi.version="18.3.1-next-f1338f8080-20240426";function UL(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(UL)}catch(t){console.error(t)}}UL(),U6.exports=yi;var pd=U6.exports;const VL=Yi(pd);var t4=pd;C2.createRoot=t4.createRoot,C2.hydrateRoot=t4.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Hp(){return Hp=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Hp.apply(this,arguments)}var Fc;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Fc||(Fc={}));const s4="popstate";function XQ(t){t===void 0&&(t={});function s(a,i){let{pathname:l,search:o,hash:c}=a.location;return b_("",{pathname:l,search:o,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(a,i){return typeof i=="string"?i:Qy(i)}return ZQ(s,n,null,t)}function pn(t,s){if(t===!1||t===null||typeof t>"u")throw new Error(s)}function HL(t,s){if(!t){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function QQ(){return Math.random().toString(36).substr(2,8)}function n4(t,s){return{usr:t.state,key:t.key,idx:s}}function b_(t,s,n,a){return n===void 0&&(n=null),Hp({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof s=="string"?Pm(s):s,{state:n,key:s&&s.key||a||QQ()})}function Qy(t){let{pathname:s="/",search:n="",hash:a=""}=t;return n&&n!=="?"&&(s+=n.charAt(0)==="?"?n:"?"+n),a&&a!=="#"&&(s+=a.charAt(0)==="#"?a:"#"+a),s}function Pm(t){let s={};if(t){let n=t.indexOf("#");n>=0&&(s.hash=t.substr(n),t=t.substr(0,n));let a=t.indexOf("?");a>=0&&(s.search=t.substr(a),t=t.substr(0,a)),t&&(s.pathname=t)}return s}function ZQ(t,s,n,a){a===void 0&&(a={});let{window:i=document.defaultView,v5Compat:l=!1}=a,o=i.history,c=Fc.Pop,d=null,u=h();u==null&&(u=0,o.replaceState(Hp({},o.state,{idx:u}),""));function h(){return(o.state||{idx:null}).idx}function f(){c=Fc.Pop;let _=h(),S=_==null?null:_-u;u=_,d&&d({action:c,location:w.location,delta:S})}function x(_,S){c=Fc.Push;let k=b_(w.location,_,S);u=h()+1;let A=n4(k,u),T=w.createHref(k);try{o.pushState(A,"",T)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;i.location.assign(T)}l&&d&&d({action:c,location:w.location,delta:1})}function b(_,S){c=Fc.Replace;let k=b_(w.location,_,S);u=h();let A=n4(k,u),T=w.createHref(k);o.replaceState(A,"",T),l&&d&&d({action:c,location:w.location,delta:0})}function v(_){let S=i.location.origin!=="null"?i.location.origin:i.location.href,k=typeof _=="string"?_:Qy(_);return k=k.replace(/ $/,"%20"),pn(S,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,S)}let w={get action(){return c},get location(){return t(i,o)},listen(_){if(d)throw new Error("A history only accepts one active listener");return i.addEventListener(s4,f),d=_,()=>{i.removeEventListener(s4,f),d=null}},createHref(_){return s(i,_)},createURL:v,encodeLocation(_){let S=v(_);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:x,replace:b,go(_){return o.go(_)}};return w}var r4;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(r4||(r4={}));function JQ(t,s,n){return n===void 0&&(n="/"),eZ(t,s,n)}function eZ(t,s,n,a){let i=typeof s=="string"?Pm(s):s,l=im(i.pathname||"/",n);if(l==null)return null;let o=WL(t);tZ(o);let c=null;for(let d=0;c==null&&d<o.length;++d){let u=hZ(l);c=dZ(o[d],u)}return c}function WL(t,s,n,a){s===void 0&&(s=[]),n===void 0&&(n=[]),a===void 0&&(a="");let i=(l,o,c)=>{let d={relativePath:c===void 0?l.path||"":c,caseSensitive:l.caseSensitive===!0,childrenIndex:o,route:l};d.relativePath.startsWith("/")&&(pn(d.relativePath.startsWith(a),'Absolute route path "'+d.relativePath+'" nested under path '+('"'+a+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),d.relativePath=d.relativePath.slice(a.length));let u=Qc([a,d.relativePath]),h=n.concat(d);l.children&&l.children.length>0&&(pn(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),WL(l.children,s,h,u)),!(l.path==null&&!l.index)&&s.push({path:u,score:oZ(u,l.index),routesMeta:h})};return t.forEach((l,o)=>{var c;if(l.path===""||!((c=l.path)!=null&&c.includes("?")))i(l,o);else for(let d of qL(l.path))i(l,o,d)}),s}function qL(t){let s=t.split("/");if(s.length===0)return[];let[n,...a]=s,i=n.endsWith("?"),l=n.replace(/\?$/,"");if(a.length===0)return i?[l,""]:[l];let o=qL(a.join("/")),c=[];return c.push(...o.map(d=>d===""?l:[l,d].join("/"))),i&&c.push(...o),c.map(d=>t.startsWith("/")&&d===""?"/":d)}function tZ(t){t.sort((s,n)=>s.score!==n.score?n.score-s.score:cZ(s.routesMeta.map(a=>a.childrenIndex),n.routesMeta.map(a=>a.childrenIndex)))}const sZ=/^:[\w-]+$/,nZ=3,rZ=2,aZ=1,iZ=10,lZ=-2,a4=t=>t==="*";function oZ(t,s){let n=t.split("/"),a=n.length;return n.some(a4)&&(a+=lZ),s&&(a+=rZ),n.filter(i=>!a4(i)).reduce((i,l)=>i+(sZ.test(l)?nZ:l===""?aZ:iZ),a)}function cZ(t,s){return t.length===s.length&&t.slice(0,-1).every((a,i)=>a===s[i])?t[t.length-1]-s[s.length-1]:0}function dZ(t,s,n){let{routesMeta:a}=t,i={},l="/",o=[];for(let c=0;c<a.length;++c){let d=a[c],u=c===a.length-1,h=l==="/"?s:s.slice(l.length)||"/",f=v_({path:d.relativePath,caseSensitive:d.caseSensitive,end:u},h),x=d.route;if(!f)return null;Object.assign(i,f.params),o.push({params:i,pathname:Qc([l,f.pathname]),pathnameBase:xZ(Qc([l,f.pathnameBase])),route:x}),f.pathnameBase!=="/"&&(l=Qc([l,f.pathnameBase]))}return o}function v_(t,s){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,a]=uZ(t.path,t.caseSensitive,t.end),i=s.match(n);if(!i)return null;let l=i[0],o=l.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:a.reduce((u,h,f)=>{let{paramName:x,isOptional:b}=h;if(x==="*"){let w=c[f]||"";o=l.slice(0,l.length-w.length).replace(/(.)\/+$/,"$1")}const v=c[f];return b&&!v?u[x]=void 0:u[x]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:l,pathnameBase:o,pattern:t}}function uZ(t,s,n){s===void 0&&(s=!1),n===void 0&&(n=!0),HL(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let a=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,d)=>(a.push({paramName:c,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(a.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,s?void 0:"i"),a]}function hZ(t){try{return t.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return HL(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+s+").")),t}}function im(t,s){if(s==="/")return t;if(!t.toLowerCase().startsWith(s.toLowerCase()))return null;let n=s.endsWith("/")?s.length-1:s.length,a=t.charAt(n);return a&&a!=="/"?null:t.slice(n)||"/"}function mZ(t,s){s===void 0&&(s="/");let{pathname:n,search:a="",hash:i=""}=typeof t=="string"?Pm(t):t;return{pathname:n?n.startsWith("/")?n:fZ(n,s):s,search:gZ(a),hash:yZ(i)}}function fZ(t,s){let n=s.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function _w(t,s,n,a){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+s+"` field ["+JSON.stringify(a)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function pZ(t){return t.filter((s,n)=>n===0||s.route.path&&s.route.path.length>0)}function P3(t,s){let n=pZ(t);return s?n.map((a,i)=>i===n.length-1?a.pathname:a.pathnameBase):n.map(a=>a.pathnameBase)}function I3(t,s,n,a){a===void 0&&(a=!1);let i;typeof t=="string"?i=Pm(t):(i=Hp({},t),pn(!i.pathname||!i.pathname.includes("?"),_w("?","pathname","search",i)),pn(!i.pathname||!i.pathname.includes("#"),_w("#","pathname","hash",i)),pn(!i.search||!i.search.includes("#"),_w("#","search","hash",i)));let l=t===""||i.pathname==="",o=l?"/":i.pathname,c;if(o==null)c=n;else{let f=s.length-1;if(!a&&o.startsWith("..")){let x=o.split("/");for(;x[0]==="..";)x.shift(),f-=1;i.pathname=x.join("/")}c=f>=0?s[f]:"/"}let d=mZ(i,c),u=o&&o!=="/"&&o.endsWith("/"),h=(l||o===".")&&n.endsWith("/");return!d.pathname.endsWith("/")&&(u||h)&&(d.pathname+="/"),d}const Qc=t=>t.join("/").replace(/\/\/+/g,"/"),xZ=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),gZ=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,yZ=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function bZ(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const GL=["post","put","patch","delete"];new Set(GL);const vZ=["get",...GL];new Set(vZ);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Wp(){return Wp=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Wp.apply(this,arguments)}const Ub=y.createContext(null),KL=y.createContext(null),tc=y.createContext(null),Vb=y.createContext(null),fo=y.createContext({outlet:null,matches:[],isDataRoute:!1}),YL=y.createContext(null);function NZ(t,s){let{relative:n}=s===void 0?{}:s;Im()||pn(!1);let{basename:a,navigator:i}=y.useContext(tc),{hash:l,pathname:o,search:c}=Hb(t,{relative:n}),d=o;return a!=="/"&&(d=o==="/"?a:Qc([a,o])),i.createHref({pathname:d,search:c,hash:l})}function Im(){return y.useContext(Vb)!=null}function Xi(){return Im()||pn(!1),y.useContext(Vb).location}function XL(t){y.useContext(tc).static||y.useLayoutEffect(t)}function Va(){let{isDataRoute:t}=y.useContext(fo);return t?RZ():wZ()}function wZ(){Im()||pn(!1);let t=y.useContext(Ub),{basename:s,future:n,navigator:a}=y.useContext(tc),{matches:i}=y.useContext(fo),{pathname:l}=Xi(),o=JSON.stringify(P3(i,n.v7_relativeSplatPath)),c=y.useRef(!1);return XL(()=>{c.current=!0}),y.useCallback(function(u,h){if(h===void 0&&(h={}),!c.current)return;if(typeof u=="number"){a.go(u);return}let f=I3(u,JSON.parse(o),l,h.relative==="path");t==null&&s!=="/"&&(f.pathname=f.pathname==="/"?s:Qc([s,f.pathname])),(h.replace?a.replace:a.push)(f,h.state,h)},[s,a,o,l,t])}const jZ=y.createContext(null);function _Z(t){let s=y.useContext(fo).outlet;return s&&y.createElement(jZ.Provider,{value:t},s)}function xd(){let{matches:t}=y.useContext(fo),s=t[t.length-1];return s?s.params:{}}function Hb(t,s){let{relative:n}=s===void 0?{}:s,{future:a}=y.useContext(tc),{matches:i}=y.useContext(fo),{pathname:l}=Xi(),o=JSON.stringify(P3(i,a.v7_relativeSplatPath));return y.useMemo(()=>I3(t,JSON.parse(o),l,n==="path"),[t,o,l,n])}function SZ(t,s){return CZ(t,s)}function CZ(t,s,n,a){Im()||pn(!1);let{navigator:i}=y.useContext(tc),{matches:l}=y.useContext(fo),o=l[l.length-1],c=o?o.params:{};o&&o.pathname;let d=o?o.pathnameBase:"/";o&&o.route;let u=Xi(),h;if(s){var f;let _=typeof s=="string"?Pm(s):s;d==="/"||(f=_.pathname)!=null&&f.startsWith(d)||pn(!1),h=_}else h=u;let x=h.pathname||"/",b=x;if(d!=="/"){let _=d.replace(/^\//,"").split("/");b="/"+x.replace(/^\//,"").split("/").slice(_.length).join("/")}let v=JQ(t,{pathname:b}),w=PZ(v&&v.map(_=>Object.assign({},_,{params:Object.assign({},c,_.params),pathname:Qc([d,i.encodeLocation?i.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?d:Qc([d,i.encodeLocation?i.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),l,n,a);return s&&w?y.createElement(Vb.Provider,{value:{location:Wp({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Fc.Pop}},w):w}function kZ(){let t=OZ(),s=bZ(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return y.createElement(y.Fragment,null,y.createElement("h2",null,"Unexpected Application Error!"),y.createElement("h3",{style:{fontStyle:"italic"}},s),n?y.createElement("pre",{style:i},n):null,null)}const AZ=y.createElement(kZ,null);class EZ extends y.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,n){return n.location!==s.location||n.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:n.error,location:n.location,revalidation:s.revalidation||n.revalidation}}componentDidCatch(s,n){console.error("React Router caught the following error during render",s,n)}render(){return this.state.error!==void 0?y.createElement(fo.Provider,{value:this.props.routeContext},y.createElement(YL.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function TZ(t){let{routeContext:s,match:n,children:a}=t,i=y.useContext(Ub);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),y.createElement(fo.Provider,{value:s},a)}function PZ(t,s,n,a){var i;if(s===void 0&&(s=[]),n===void 0&&(n=null),a===void 0&&(a=null),t==null){var l;if(!n)return null;if(n.errors)t=n.matches;else if((l=a)!=null&&l.v7_partialHydration&&s.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,c=(i=n)==null?void 0:i.errors;if(c!=null){let h=o.findIndex(f=>f.route.id&&(c==null?void 0:c[f.route.id])!==void 0);h>=0||pn(!1),o=o.slice(0,Math.min(o.length,h+1))}let d=!1,u=-1;if(n&&a&&a.v7_partialHydration)for(let h=0;h<o.length;h++){let f=o[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=h),f.route.id){let{loaderData:x,errors:b}=n,v=f.route.loader&&x[f.route.id]===void 0&&(!b||b[f.route.id]===void 0);if(f.route.lazy||v){d=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((h,f,x)=>{let b,v=!1,w=null,_=null;n&&(b=c&&f.route.id?c[f.route.id]:void 0,w=f.route.errorElement||AZ,d&&(u<0&&x===0?(LZ("route-fallback"),v=!0,_=null):u===x&&(v=!0,_=f.route.hydrateFallbackElement||null)));let S=s.concat(o.slice(0,x+1)),k=()=>{let A;return b?A=w:v?A=_:f.route.Component?A=y.createElement(f.route.Component,null):f.route.element?A=f.route.element:A=h,y.createElement(TZ,{match:f,routeContext:{outlet:h,matches:S,isDataRoute:n!=null},children:A})};return n&&(f.route.ErrorBoundary||f.route.errorElement||x===0)?y.createElement(EZ,{location:n.location,revalidation:n.revalidation,component:w,error:b,children:k(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):k()},null)}var QL=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(QL||{}),ZL=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(ZL||{});function IZ(t){let s=y.useContext(Ub);return s||pn(!1),s}function MZ(t){let s=y.useContext(KL);return s||pn(!1),s}function DZ(t){let s=y.useContext(fo);return s||pn(!1),s}function JL(t){let s=DZ(),n=s.matches[s.matches.length-1];return n.route.id||pn(!1),n.route.id}function OZ(){var t;let s=y.useContext(YL),n=MZ(),a=JL();return s!==void 0?s:(t=n.errors)==null?void 0:t[a]}function RZ(){let{router:t}=IZ(QL.UseNavigateStable),s=JL(ZL.UseNavigateStable),n=y.useRef(!1);return XL(()=>{n.current=!0}),y.useCallback(function(i,l){l===void 0&&(l={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Wp({fromRouteId:s},l)))},[t,s])}const i4={};function LZ(t,s,n){i4[t]||(i4[t]=!0)}function BZ(t,s){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function e7(t){let{to:s,replace:n,state:a,relative:i}=t;Im()||pn(!1);let{future:l,static:o}=y.useContext(tc),{matches:c}=y.useContext(fo),{pathname:d}=Xi(),u=Va(),h=I3(s,P3(c,l.v7_relativeSplatPath),d,i==="path"),f=JSON.stringify(h);return y.useEffect(()=>u(JSON.parse(f),{replace:n,state:a,relative:i}),[u,f,i,n,a]),null}function t7(t){return _Z(t.context)}function xt(t){pn(!1)}function FZ(t){let{basename:s="/",children:n=null,location:a,navigationType:i=Fc.Pop,navigator:l,static:o=!1,future:c}=t;Im()&&pn(!1);let d=s.replace(/^\/*/,"/"),u=y.useMemo(()=>({basename:d,navigator:l,static:o,future:Wp({v7_relativeSplatPath:!1},c)}),[d,c,l,o]);typeof a=="string"&&(a=Pm(a));let{pathname:h="/",search:f="",hash:x="",state:b=null,key:v="default"}=a,w=y.useMemo(()=>{let _=im(h,d);return _==null?null:{location:{pathname:_,search:f,hash:x,state:b,key:v},navigationType:i}},[d,h,f,x,b,v,i]);return w==null?null:y.createElement(tc.Provider,{value:u},y.createElement(Vb.Provider,{children:n,value:w}))}function $Z(t){let{children:s,location:n}=t;return SZ(N_(s),n)}new Promise(()=>{});function N_(t,s){s===void 0&&(s=[]);let n=[];return y.Children.forEach(t,(a,i)=>{if(!y.isValidElement(a))return;let l=[...s,i];if(a.type===y.Fragment){n.push.apply(n,N_(a.props.children,l));return}a.type!==xt&&pn(!1),!a.props.index||!a.props.children||pn(!1);let o={id:a.props.id||l.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(o.children=N_(a.props.children,l)),n.push(o)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Zy(){return Zy=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Zy.apply(this,arguments)}function s7(t,s){if(t==null)return{};var n={},a=Object.keys(t),i,l;for(l=0;l<a.length;l++)i=a[l],!(s.indexOf(i)>=0)&&(n[i]=t[i]);return n}function zZ(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function UZ(t,s){return t.button===0&&(!s||s==="_self")&&!zZ(t)}const VZ=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],HZ=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],WZ="6";try{window.__reactRouterVersion=WZ}catch{}const qZ=y.createContext({isTransitioning:!1}),GZ="startTransition",l4=Cb[GZ];function KZ(t){let{basename:s,children:n,future:a,window:i}=t,l=y.useRef();l.current==null&&(l.current=XQ({window:i,v5Compat:!0}));let o=l.current,[c,d]=y.useState({action:o.action,location:o.location}),{v7_startTransition:u}=a||{},h=y.useCallback(f=>{u&&l4?l4(()=>d(f)):d(f)},[d,u]);return y.useLayoutEffect(()=>o.listen(h),[o,h]),y.useEffect(()=>BZ(a),[a]),y.createElement(FZ,{basename:s,children:n,location:c.location,navigationType:c.action,navigator:o,future:a})}const YZ=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",XZ=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,bl=y.forwardRef(function(s,n){let{onClick:a,relative:i,reloadDocument:l,replace:o,state:c,target:d,to:u,preventScrollReset:h,viewTransition:f}=s,x=s7(s,VZ),{basename:b}=y.useContext(tc),v,w=!1;if(typeof u=="string"&&XZ.test(u)&&(v=u,YZ))try{let A=new URL(window.location.href),T=u.startsWith("//")?new URL(A.protocol+u):new URL(u),P=im(T.pathname,b);T.origin===A.origin&&P!=null?u=P+T.search+T.hash:w=!0}catch{}let _=NZ(u,{relative:i}),S=ZZ(u,{replace:o,state:c,target:d,preventScrollReset:h,relative:i,viewTransition:f});function k(A){a&&a(A),A.defaultPrevented||S(A)}return y.createElement("a",Zy({},x,{href:v||_,onClick:w||l?a:k,ref:n,target:d}))}),o4=y.forwardRef(function(s,n){let{"aria-current":a="page",caseSensitive:i=!1,className:l="",end:o=!1,style:c,to:d,viewTransition:u,children:h}=s,f=s7(s,HZ),x=Hb(d,{relative:f.relative}),b=Xi(),v=y.useContext(KL),{navigator:w,basename:_}=y.useContext(tc),S=v!=null&&JZ(x)&&u===!0,k=w.encodeLocation?w.encodeLocation(x).pathname:x.pathname,A=b.pathname,T=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;i||(A=A.toLowerCase(),T=T?T.toLowerCase():null,k=k.toLowerCase()),T&&_&&(T=im(T,_)||T);const P=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let O=A===k||!o&&A.startsWith(k)&&A.charAt(P)==="/",D=T!=null&&(T===k||!o&&T.startsWith(k)&&T.charAt(k.length)==="/"),I={isActive:O,isPending:D,isTransitioning:S},M=O?a:void 0,B;typeof l=="function"?B=l(I):B=[l,O?"active":null,D?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let L=typeof c=="function"?c(I):c;return y.createElement(bl,Zy({},f,{"aria-current":M,className:B,ref:n,style:L,to:d,viewTransition:u}),typeof h=="function"?h(I):h)});var w_;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(w_||(w_={}));var c4;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(c4||(c4={}));function QZ(t){let s=y.useContext(Ub);return s||pn(!1),s}function ZZ(t,s){let{target:n,replace:a,state:i,preventScrollReset:l,relative:o,viewTransition:c}=s===void 0?{}:s,d=Va(),u=Xi(),h=Hb(t,{relative:o});return y.useCallback(f=>{if(UZ(f,n)){f.preventDefault();let x=a!==void 0?a:Qy(u)===Qy(h);d(t,{replace:x,state:i,preventScrollReset:l,relative:o,viewTransition:c})}},[u,d,h,a,i,n,t,l,o,c])}function JZ(t,s){s===void 0&&(s={});let n=y.useContext(qZ);n==null&&pn(!1);let{basename:a}=QZ(w_.useViewTransitionState),i=Hb(t,{relative:s.relative});if(!n.isTransitioning)return!1;let l=im(n.currentLocation.pathname,a)||n.currentLocation.pathname,o=im(n.nextLocation.pathname,a)||n.nextLocation.pathname;return v_(i.pathname,o)!=null||v_(i.pathname,l)!=null}function n7(t,s){return function(){return t.apply(s,arguments)}}const{toString:eJ}=Object.prototype,{getPrototypeOf:M3}=Object,{iterator:Wb,toStringTag:r7}=Symbol,qb=(t=>s=>{const n=eJ.call(s);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Cl=t=>(t=t.toLowerCase(),s=>qb(s)===t),Gb=t=>s=>typeof s===t,{isArray:Mm}=Array,lm=Gb("undefined");function Rx(t){return t!==null&&!lm(t)&&t.constructor!==null&&!lm(t.constructor)&&Oa(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const a7=Cl("ArrayBuffer");function tJ(t){let s;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?s=ArrayBuffer.isView(t):s=t&&t.buffer&&a7(t.buffer),s}const sJ=Gb("string"),Oa=Gb("function"),i7=Gb("number"),Lx=t=>t!==null&&typeof t=="object",nJ=t=>t===!0||t===!1,ey=t=>{if(qb(t)!=="object")return!1;const s=M3(t);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(r7 in t)&&!(Wb in t)},rJ=t=>{if(!Lx(t)||Rx(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},aJ=Cl("Date"),iJ=Cl("File"),lJ=Cl("Blob"),oJ=Cl("FileList"),cJ=t=>Lx(t)&&Oa(t.pipe),dJ=t=>{let s;return t&&(typeof FormData=="function"&&t instanceof FormData||Oa(t.append)&&((s=qb(t))==="formdata"||s==="object"&&Oa(t.toString)&&t.toString()==="[object FormData]"))},uJ=Cl("URLSearchParams"),[hJ,mJ,fJ,pJ]=["ReadableStream","Request","Response","Headers"].map(Cl),xJ=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Bx(t,s,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let a,i;if(typeof t!="object"&&(t=[t]),Mm(t))for(a=0,i=t.length;a<i;a++)s.call(null,t[a],a,t);else{if(Rx(t))return;const l=n?Object.getOwnPropertyNames(t):Object.keys(t),o=l.length;let c;for(a=0;a<o;a++)c=l[a],s.call(null,t[c],c,t)}}function l7(t,s){if(Rx(t))return null;s=s.toLowerCase();const n=Object.keys(t);let a=n.length,i;for(;a-- >0;)if(i=n[a],s===i.toLowerCase())return i;return null}const Yd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,o7=t=>!lm(t)&&t!==Yd;function j_(){const{caseless:t,skipUndefined:s}=o7(this)&&this||{},n={},a=(i,l)=>{const o=t&&l7(n,l)||l;ey(n[o])&&ey(i)?n[o]=j_(n[o],i):ey(i)?n[o]=j_({},i):Mm(i)?n[o]=i.slice():(!s||!lm(i))&&(n[o]=i)};for(let i=0,l=arguments.length;i<l;i++)arguments[i]&&Bx(arguments[i],a);return n}const gJ=(t,s,n,{allOwnKeys:a}={})=>(Bx(s,(i,l)=>{n&&Oa(i)?t[l]=n7(i,n):t[l]=i},{allOwnKeys:a}),t),yJ=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),bJ=(t,s,n,a)=>{t.prototype=Object.create(s.prototype,a),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:s.prototype}),n&&Object.assign(t.prototype,n)},vJ=(t,s,n,a)=>{let i,l,o;const c={};if(s=s||{},t==null)return s;do{for(i=Object.getOwnPropertyNames(t),l=i.length;l-- >0;)o=i[l],(!a||a(o,t,s))&&!c[o]&&(s[o]=t[o],c[o]=!0);t=n!==!1&&M3(t)}while(t&&(!n||n(t,s))&&t!==Object.prototype);return s},NJ=(t,s,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=s.length;const a=t.indexOf(s,n);return a!==-1&&a===n},wJ=t=>{if(!t)return null;if(Mm(t))return t;let s=t.length;if(!i7(s))return null;const n=new Array(s);for(;s-- >0;)n[s]=t[s];return n},jJ=(t=>s=>t&&s instanceof t)(typeof Uint8Array<"u"&&M3(Uint8Array)),_J=(t,s)=>{const a=(t&&t[Wb]).call(t);let i;for(;(i=a.next())&&!i.done;){const l=i.value;s.call(t,l[0],l[1])}},SJ=(t,s)=>{let n;const a=[];for(;(n=t.exec(s))!==null;)a.push(n);return a},CJ=Cl("HTMLFormElement"),kJ=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,a,i){return a.toUpperCase()+i}),d4=(({hasOwnProperty:t})=>(s,n)=>t.call(s,n))(Object.prototype),AJ=Cl("RegExp"),c7=(t,s)=>{const n=Object.getOwnPropertyDescriptors(t),a={};Bx(n,(i,l)=>{let o;(o=s(i,l,t))!==!1&&(a[l]=o||i)}),Object.defineProperties(t,a)},EJ=t=>{c7(t,(s,n)=>{if(Oa(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const a=t[n];if(Oa(a)){if(s.enumerable=!1,"writable"in s){s.writable=!1;return}s.set||(s.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},TJ=(t,s)=>{const n={},a=i=>{i.forEach(l=>{n[l]=!0})};return Mm(t)?a(t):a(String(t).split(s)),n},PJ=()=>{},IJ=(t,s)=>t!=null&&Number.isFinite(t=+t)?t:s;function MJ(t){return!!(t&&Oa(t.append)&&t[r7]==="FormData"&&t[Wb])}const DJ=t=>{const s=new Array(10),n=(a,i)=>{if(Lx(a)){if(s.indexOf(a)>=0)return;if(Rx(a))return a;if(!("toJSON"in a)){s[i]=a;const l=Mm(a)?[]:{};return Bx(a,(o,c)=>{const d=n(o,i+1);!lm(d)&&(l[c]=d)}),s[i]=void 0,l}}return a};return n(t,0)},OJ=Cl("AsyncFunction"),RJ=t=>t&&(Lx(t)||Oa(t))&&Oa(t.then)&&Oa(t.catch),d7=((t,s)=>t?setImmediate:s?((n,a)=>(Yd.addEventListener("message",({source:i,data:l})=>{i===Yd&&l===n&&a.length&&a.shift()()},!1),i=>{a.push(i),Yd.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Oa(Yd.postMessage)),LJ=typeof queueMicrotask<"u"?queueMicrotask.bind(Yd):typeof process<"u"&&process.nextTick||d7,BJ=t=>t!=null&&Oa(t[Wb]),Re={isArray:Mm,isArrayBuffer:a7,isBuffer:Rx,isFormData:dJ,isArrayBufferView:tJ,isString:sJ,isNumber:i7,isBoolean:nJ,isObject:Lx,isPlainObject:ey,isEmptyObject:rJ,isReadableStream:hJ,isRequest:mJ,isResponse:fJ,isHeaders:pJ,isUndefined:lm,isDate:aJ,isFile:iJ,isBlob:lJ,isRegExp:AJ,isFunction:Oa,isStream:cJ,isURLSearchParams:uJ,isTypedArray:jJ,isFileList:oJ,forEach:Bx,merge:j_,extend:gJ,trim:xJ,stripBOM:yJ,inherits:bJ,toFlatObject:vJ,kindOf:qb,kindOfTest:Cl,endsWith:NJ,toArray:wJ,forEachEntry:_J,matchAll:SJ,isHTMLForm:CJ,hasOwnProperty:d4,hasOwnProp:d4,reduceDescriptors:c7,freezeMethods:EJ,toObjectSet:TJ,toCamelCase:kJ,noop:PJ,toFiniteNumber:IJ,findKey:l7,global:Yd,isContextDefined:o7,isSpecCompliantForm:MJ,toJSONObject:DJ,isAsyncFn:OJ,isThenable:RJ,setImmediate:d7,asap:LJ,isIterable:BJ};function Qt(t,s,n,a,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",s&&(this.code=s),n&&(this.config=n),a&&(this.request=a),i&&(this.response=i,this.status=i.status?i.status:null)}Re.inherits(Qt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Re.toJSONObject(this.config),code:this.code,status:this.status}}});const u7=Qt.prototype,h7={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{h7[t]={value:t}});Object.defineProperties(Qt,h7);Object.defineProperty(u7,"isAxiosError",{value:!0});Qt.from=(t,s,n,a,i,l)=>{const o=Object.create(u7);Re.toFlatObject(t,o,function(h){return h!==Error.prototype},u=>u!=="isAxiosError");const c=t&&t.message?t.message:"Error",d=s==null&&t?t.code:s;return Qt.call(o,c,d,n,a,i),t&&o.cause==null&&Object.defineProperty(o,"cause",{value:t,configurable:!0}),o.name=t&&t.name||"Error",l&&Object.assign(o,l),o};const FJ=null;function __(t){return Re.isPlainObject(t)||Re.isArray(t)}function m7(t){return Re.endsWith(t,"[]")?t.slice(0,-2):t}function u4(t,s,n){return t?t.concat(s).map(function(i,l){return i=m7(i),!n&&l?"["+i+"]":i}).join(n?".":""):s}function $J(t){return Re.isArray(t)&&!t.some(__)}const zJ=Re.toFlatObject(Re,{},null,function(s){return/^is[A-Z]/.test(s)});function Kb(t,s,n){if(!Re.isObject(t))throw new TypeError("target must be an object");s=s||new FormData,n=Re.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,_){return!Re.isUndefined(_[w])});const a=n.metaTokens,i=n.visitor||h,l=n.dots,o=n.indexes,d=(n.Blob||typeof Blob<"u"&&Blob)&&Re.isSpecCompliantForm(s);if(!Re.isFunction(i))throw new TypeError("visitor must be a function");function u(v){if(v===null)return"";if(Re.isDate(v))return v.toISOString();if(Re.isBoolean(v))return v.toString();if(!d&&Re.isBlob(v))throw new Qt("Blob is not supported. Use a Buffer instead.");return Re.isArrayBuffer(v)||Re.isTypedArray(v)?d&&typeof Blob=="function"?new Blob([v]):Buffer.from(v):v}function h(v,w,_){let S=v;if(v&&!_&&typeof v=="object"){if(Re.endsWith(w,"{}"))w=a?w:w.slice(0,-2),v=JSON.stringify(v);else if(Re.isArray(v)&&$J(v)||(Re.isFileList(v)||Re.endsWith(w,"[]"))&&(S=Re.toArray(v)))return w=m7(w),S.forEach(function(A,T){!(Re.isUndefined(A)||A===null)&&s.append(o===!0?u4([w],T,l):o===null?w:w+"[]",u(A))}),!1}return __(v)?!0:(s.append(u4(_,w,l),u(v)),!1)}const f=[],x=Object.assign(zJ,{defaultVisitor:h,convertValue:u,isVisitable:__});function b(v,w){if(!Re.isUndefined(v)){if(f.indexOf(v)!==-1)throw Error("Circular reference detected in "+w.join("."));f.push(v),Re.forEach(v,function(S,k){(!(Re.isUndefined(S)||S===null)&&i.call(s,S,Re.isString(k)?k.trim():k,w,x))===!0&&b(S,w?w.concat(k):[k])}),f.pop()}}if(!Re.isObject(t))throw new TypeError("data must be an object");return b(t),s}function h4(t){const s={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(a){return s[a]})}function D3(t,s){this._pairs=[],t&&Kb(t,this,s)}const f7=D3.prototype;f7.append=function(s,n){this._pairs.push([s,n])};f7.toString=function(s){const n=s?function(a){return s.call(this,a,h4)}:h4;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function UJ(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function p7(t,s,n){if(!s)return t;const a=n&&n.encode||UJ;Re.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let l;if(i?l=i(s,n):l=Re.isURLSearchParams(s)?s.toString():new D3(s,n).toString(a),l){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+l}return t}class m4{constructor(){this.handlers=[]}use(s,n,a){return this.handlers.push({fulfilled:s,rejected:n,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(s){this.handlers[s]&&(this.handlers[s]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(s){Re.forEach(this.handlers,function(a){a!==null&&s(a)})}}const x7={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},VJ=typeof URLSearchParams<"u"?URLSearchParams:D3,HJ=typeof FormData<"u"?FormData:null,WJ=typeof Blob<"u"?Blob:null,qJ={isBrowser:!0,classes:{URLSearchParams:VJ,FormData:HJ,Blob:WJ},protocols:["http","https","file","blob","url","data"]},O3=typeof window<"u"&&typeof document<"u",S_=typeof navigator=="object"&&navigator||void 0,GJ=O3&&(!S_||["ReactNative","NativeScript","NS"].indexOf(S_.product)<0),KJ=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",YJ=O3&&window.location.href||"http://localhost",XJ=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:O3,hasStandardBrowserEnv:GJ,hasStandardBrowserWebWorkerEnv:KJ,navigator:S_,origin:YJ},Symbol.toStringTag,{value:"Module"})),Gr={...XJ,...qJ};function QJ(t,s){return Kb(t,new Gr.classes.URLSearchParams,{visitor:function(n,a,i,l){return Gr.isNode&&Re.isBuffer(n)?(this.append(a,n.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...s})}function ZJ(t){return Re.matchAll(/\w+|\[(\w*)]/g,t).map(s=>s[0]==="[]"?"":s[1]||s[0])}function JJ(t){const s={},n=Object.keys(t);let a;const i=n.length;let l;for(a=0;a<i;a++)l=n[a],s[l]=t[l];return s}function g7(t){function s(n,a,i,l){let o=n[l++];if(o==="__proto__")return!0;const c=Number.isFinite(+o),d=l>=n.length;return o=!o&&Re.isArray(i)?i.length:o,d?(Re.hasOwnProp(i,o)?i[o]=[i[o],a]:i[o]=a,!c):((!i[o]||!Re.isObject(i[o]))&&(i[o]=[]),s(n,a,i[o],l)&&Re.isArray(i[o])&&(i[o]=JJ(i[o])),!c)}if(Re.isFormData(t)&&Re.isFunction(t.entries)){const n={};return Re.forEachEntry(t,(a,i)=>{s(ZJ(a),i,n,0)}),n}return null}function eee(t,s,n){if(Re.isString(t))try{return(s||JSON.parse)(t),Re.trim(t)}catch(a){if(a.name!=="SyntaxError")throw a}return(n||JSON.stringify)(t)}const Fx={transitional:x7,adapter:["xhr","http","fetch"],transformRequest:[function(s,n){const a=n.getContentType()||"",i=a.indexOf("application/json")>-1,l=Re.isObject(s);if(l&&Re.isHTMLForm(s)&&(s=new FormData(s)),Re.isFormData(s))return i?JSON.stringify(g7(s)):s;if(Re.isArrayBuffer(s)||Re.isBuffer(s)||Re.isStream(s)||Re.isFile(s)||Re.isBlob(s)||Re.isReadableStream(s))return s;if(Re.isArrayBufferView(s))return s.buffer;if(Re.isURLSearchParams(s))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),s.toString();let c;if(l){if(a.indexOf("application/x-www-form-urlencoded")>-1)return QJ(s,this.formSerializer).toString();if((c=Re.isFileList(s))||a.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return Kb(c?{"files[]":s}:s,d&&new d,this.formSerializer)}}return l||i?(n.setContentType("application/json",!1),eee(s)):s}],transformResponse:[function(s){const n=this.transitional||Fx.transitional,a=n&&n.forcedJSONParsing,i=this.responseType==="json";if(Re.isResponse(s)||Re.isReadableStream(s))return s;if(s&&Re.isString(s)&&(a&&!this.responseType||i)){const o=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(s,this.parseReviver)}catch(c){if(o)throw c.name==="SyntaxError"?Qt.from(c,Qt.ERR_BAD_RESPONSE,this,null,this.response):c}}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Gr.classes.FormData,Blob:Gr.classes.Blob},validateStatus:function(s){return s>=200&&s<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Re.forEach(["delete","get","head","post","put","patch"],t=>{Fx.headers[t]={}});const tee=Re.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),see=t=>{const s={};let n,a,i;return t&&t.split(`
`).forEach(function(o){i=o.indexOf(":"),n=o.substring(0,i).trim().toLowerCase(),a=o.substring(i+1).trim(),!(!n||s[n]&&tee[n])&&(n==="set-cookie"?s[n]?s[n].push(a):s[n]=[a]:s[n]=s[n]?s[n]+", "+a:a)}),s},f4=Symbol("internals");function Cf(t){return t&&String(t).trim().toLowerCase()}function ty(t){return t===!1||t==null?t:Re.isArray(t)?t.map(ty):String(t)}function nee(t){const s=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=n.exec(t);)s[a[1]]=a[2];return s}const ree=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Sw(t,s,n,a,i){if(Re.isFunction(a))return a.call(this,s,n);if(i&&(s=n),!!Re.isString(s)){if(Re.isString(a))return s.indexOf(a)!==-1;if(Re.isRegExp(a))return a.test(s)}}function aee(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(s,n,a)=>n.toUpperCase()+a)}function iee(t,s){const n=Re.toCamelCase(" "+s);["get","set","has"].forEach(a=>{Object.defineProperty(t,a+n,{value:function(i,l,o){return this[a].call(this,s,i,l,o)},configurable:!0})})}let Ra=class{constructor(s){s&&this.set(s)}set(s,n,a){const i=this;function l(c,d,u){const h=Cf(d);if(!h)throw new Error("header name must be a non-empty string");const f=Re.findKey(i,h);(!f||i[f]===void 0||u===!0||u===void 0&&i[f]!==!1)&&(i[f||d]=ty(c))}const o=(c,d)=>Re.forEach(c,(u,h)=>l(u,h,d));if(Re.isPlainObject(s)||s instanceof this.constructor)o(s,n);else if(Re.isString(s)&&(s=s.trim())&&!ree(s))o(see(s),n);else if(Re.isObject(s)&&Re.isIterable(s)){let c={},d,u;for(const h of s){if(!Re.isArray(h))throw TypeError("Object iterator must return a key-value pair");c[u=h[0]]=(d=c[u])?Re.isArray(d)?[...d,h[1]]:[d,h[1]]:h[1]}o(c,n)}else s!=null&&l(n,s,a);return this}get(s,n){if(s=Cf(s),s){const a=Re.findKey(this,s);if(a){const i=this[a];if(!n)return i;if(n===!0)return nee(i);if(Re.isFunction(n))return n.call(this,i,a);if(Re.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(s,n){if(s=Cf(s),s){const a=Re.findKey(this,s);return!!(a&&this[a]!==void 0&&(!n||Sw(this,this[a],a,n)))}return!1}delete(s,n){const a=this;let i=!1;function l(o){if(o=Cf(o),o){const c=Re.findKey(a,o);c&&(!n||Sw(a,a[c],c,n))&&(delete a[c],i=!0)}}return Re.isArray(s)?s.forEach(l):l(s),i}clear(s){const n=Object.keys(this);let a=n.length,i=!1;for(;a--;){const l=n[a];(!s||Sw(this,this[l],l,s,!0))&&(delete this[l],i=!0)}return i}normalize(s){const n=this,a={};return Re.forEach(this,(i,l)=>{const o=Re.findKey(a,l);if(o){n[o]=ty(i),delete n[l];return}const c=s?aee(l):String(l).trim();c!==l&&delete n[l],n[c]=ty(i),a[c]=!0}),this}concat(...s){return this.constructor.concat(this,...s)}toJSON(s){const n=Object.create(null);return Re.forEach(this,(a,i)=>{a!=null&&a!==!1&&(n[i]=s&&Re.isArray(a)?a.join(", "):a)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([s,n])=>s+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(s){return s instanceof this?s:new this(s)}static concat(s,...n){const a=new this(s);return n.forEach(i=>a.set(i)),a}static accessor(s){const a=(this[f4]=this[f4]={accessors:{}}).accessors,i=this.prototype;function l(o){const c=Cf(o);a[c]||(iee(i,o),a[c]=!0)}return Re.isArray(s)?s.forEach(l):l(s),this}};Ra.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Re.reduceDescriptors(Ra.prototype,({value:t},s)=>{let n=s[0].toUpperCase()+s.slice(1);return{get:()=>t,set(a){this[n]=a}}});Re.freezeMethods(Ra);function Cw(t,s){const n=this||Fx,a=s||n,i=Ra.from(a.headers);let l=a.data;return Re.forEach(t,function(c){l=c.call(n,l,i.normalize(),s?s.status:void 0)}),i.normalize(),l}function y7(t){return!!(t&&t.__CANCEL__)}function Dm(t,s,n){Qt.call(this,t??"canceled",Qt.ERR_CANCELED,s,n),this.name="CanceledError"}Re.inherits(Dm,Qt,{__CANCEL__:!0});function b7(t,s,n){const a=n.config.validateStatus;!n.status||!a||a(n.status)?t(n):s(new Qt("Request failed with status code "+n.status,[Qt.ERR_BAD_REQUEST,Qt.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function lee(t){const s=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return s&&s[1]||""}function oee(t,s){t=t||10;const n=new Array(t),a=new Array(t);let i=0,l=0,o;return s=s!==void 0?s:1e3,function(d){const u=Date.now(),h=a[l];o||(o=u),n[i]=d,a[i]=u;let f=l,x=0;for(;f!==i;)x+=n[f++],f=f%t;if(i=(i+1)%t,i===l&&(l=(l+1)%t),u-o<s)return;const b=h&&u-h;return b?Math.round(x*1e3/b):void 0}}function cee(t,s){let n=0,a=1e3/s,i,l;const o=(u,h=Date.now())=>{n=h,i=null,l&&(clearTimeout(l),l=null),t(...u)};return[(...u)=>{const h=Date.now(),f=h-n;f>=a?o(u,h):(i=u,l||(l=setTimeout(()=>{l=null,o(i)},a-f)))},()=>i&&o(i)]}const Jy=(t,s,n=3)=>{let a=0;const i=oee(50,250);return cee(l=>{const o=l.loaded,c=l.lengthComputable?l.total:void 0,d=o-a,u=i(d),h=o<=c;a=o;const f={loaded:o,total:c,progress:c?o/c:void 0,bytes:d,rate:u||void 0,estimated:u&&c&&h?(c-o)/u:void 0,event:l,lengthComputable:c!=null,[s?"download":"upload"]:!0};t(f)},n)},p4=(t,s)=>{const n=t!=null;return[a=>s[0]({lengthComputable:n,total:t,loaded:a}),s[1]]},x4=t=>(...s)=>Re.asap(()=>t(...s)),dee=Gr.hasStandardBrowserEnv?((t,s)=>n=>(n=new URL(n,Gr.origin),t.protocol===n.protocol&&t.host===n.host&&(s||t.port===n.port)))(new URL(Gr.origin),Gr.navigator&&/(msie|trident)/i.test(Gr.navigator.userAgent)):()=>!0,uee=Gr.hasStandardBrowserEnv?{write(t,s,n,a,i,l){const o=[t+"="+encodeURIComponent(s)];Re.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),Re.isString(a)&&o.push("path="+a),Re.isString(i)&&o.push("domain="+i),l===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const s=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return s?decodeURIComponent(s[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function hee(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function mee(t,s){return s?t.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):t}function v7(t,s,n){let a=!hee(s);return t&&(a||n==!1)?mee(t,s):s}const g4=t=>t instanceof Ra?{...t}:t;function ju(t,s){s=s||{};const n={};function a(u,h,f,x){return Re.isPlainObject(u)&&Re.isPlainObject(h)?Re.merge.call({caseless:x},u,h):Re.isPlainObject(h)?Re.merge({},h):Re.isArray(h)?h.slice():h}function i(u,h,f,x){if(Re.isUndefined(h)){if(!Re.isUndefined(u))return a(void 0,u,f,x)}else return a(u,h,f,x)}function l(u,h){if(!Re.isUndefined(h))return a(void 0,h)}function o(u,h){if(Re.isUndefined(h)){if(!Re.isUndefined(u))return a(void 0,u)}else return a(void 0,h)}function c(u,h,f){if(f in s)return a(u,h);if(f in t)return a(void 0,u)}const d={url:l,method:l,data:l,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:c,headers:(u,h,f)=>i(g4(u),g4(h),f,!0)};return Re.forEach(Object.keys({...t,...s}),function(h){const f=d[h]||i,x=f(t[h],s[h],h);Re.isUndefined(x)&&f!==c||(n[h]=x)}),n}const N7=t=>{const s=ju({},t);let{data:n,withXSRFToken:a,xsrfHeaderName:i,xsrfCookieName:l,headers:o,auth:c}=s;if(s.headers=o=Ra.from(o),s.url=p7(v7(s.baseURL,s.url,s.allowAbsoluteUrls),t.params,t.paramsSerializer),c&&o.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),Re.isFormData(n)){if(Gr.hasStandardBrowserEnv||Gr.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(Re.isFunction(n.getHeaders)){const d=n.getHeaders(),u=["content-type","content-length"];Object.entries(d).forEach(([h,f])=>{u.includes(h.toLowerCase())&&o.set(h,f)})}}if(Gr.hasStandardBrowserEnv&&(a&&Re.isFunction(a)&&(a=a(s)),a||a!==!1&&dee(s.url))){const d=i&&l&&uee.read(l);d&&o.set(i,d)}return s},fee=typeof XMLHttpRequest<"u",pee=fee&&function(t){return new Promise(function(n,a){const i=N7(t);let l=i.data;const o=Ra.from(i.headers).normalize();let{responseType:c,onUploadProgress:d,onDownloadProgress:u}=i,h,f,x,b,v;function w(){b&&b(),v&&v(),i.cancelToken&&i.cancelToken.unsubscribe(h),i.signal&&i.signal.removeEventListener("abort",h)}let _=new XMLHttpRequest;_.open(i.method.toUpperCase(),i.url,!0),_.timeout=i.timeout;function S(){if(!_)return;const A=Ra.from("getAllResponseHeaders"in _&&_.getAllResponseHeaders()),P={data:!c||c==="text"||c==="json"?_.responseText:_.response,status:_.status,statusText:_.statusText,headers:A,config:t,request:_};b7(function(D){n(D),w()},function(D){a(D),w()},P),_=null}"onloadend"in _?_.onloadend=S:_.onreadystatechange=function(){!_||_.readyState!==4||_.status===0&&!(_.responseURL&&_.responseURL.indexOf("file:")===0)||setTimeout(S)},_.onabort=function(){_&&(a(new Qt("Request aborted",Qt.ECONNABORTED,t,_)),_=null)},_.onerror=function(T){const P=T&&T.message?T.message:"Network Error",O=new Qt(P,Qt.ERR_NETWORK,t,_);O.event=T||null,a(O),_=null},_.ontimeout=function(){let T=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const P=i.transitional||x7;i.timeoutErrorMessage&&(T=i.timeoutErrorMessage),a(new Qt(T,P.clarifyTimeoutError?Qt.ETIMEDOUT:Qt.ECONNABORTED,t,_)),_=null},l===void 0&&o.setContentType(null),"setRequestHeader"in _&&Re.forEach(o.toJSON(),function(T,P){_.setRequestHeader(P,T)}),Re.isUndefined(i.withCredentials)||(_.withCredentials=!!i.withCredentials),c&&c!=="json"&&(_.responseType=i.responseType),u&&([x,v]=Jy(u,!0),_.addEventListener("progress",x)),d&&_.upload&&([f,b]=Jy(d),_.upload.addEventListener("progress",f),_.upload.addEventListener("loadend",b)),(i.cancelToken||i.signal)&&(h=A=>{_&&(a(!A||A.type?new Dm(null,t,_):A),_.abort(),_=null)},i.cancelToken&&i.cancelToken.subscribe(h),i.signal&&(i.signal.aborted?h():i.signal.addEventListener("abort",h)));const k=lee(i.url);if(k&&Gr.protocols.indexOf(k)===-1){a(new Qt("Unsupported protocol "+k+":",Qt.ERR_BAD_REQUEST,t));return}_.send(l||null)})},xee=(t,s)=>{const{length:n}=t=t?t.filter(Boolean):[];if(s||n){let a=new AbortController,i;const l=function(u){if(!i){i=!0,c();const h=u instanceof Error?u:this.reason;a.abort(h instanceof Qt?h:new Dm(h instanceof Error?h.message:h))}};let o=s&&setTimeout(()=>{o=null,l(new Qt(`timeout ${s} of ms exceeded`,Qt.ETIMEDOUT))},s);const c=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(l):u.removeEventListener("abort",l)}),t=null)};t.forEach(u=>u.addEventListener("abort",l));const{signal:d}=a;return d.unsubscribe=()=>Re.asap(c),d}},gee=function*(t,s){let n=t.byteLength;if(n<s){yield t;return}let a=0,i;for(;a<n;)i=a+s,yield t.slice(a,i),a=i},yee=async function*(t,s){for await(const n of bee(t))yield*gee(n,s)},bee=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const s=t.getReader();try{for(;;){const{done:n,value:a}=await s.read();if(n)break;yield a}}finally{await s.cancel()}},y4=(t,s,n,a)=>{const i=yee(t,s);let l=0,o,c=d=>{o||(o=!0,a&&a(d))};return new ReadableStream({async pull(d){try{const{done:u,value:h}=await i.next();if(u){c(),d.close();return}let f=h.byteLength;if(n){let x=l+=f;n(x)}d.enqueue(new Uint8Array(h))}catch(u){throw c(u),u}},cancel(d){return c(d),i.return()}},{highWaterMark:2})},b4=64*1024,{isFunction:z0}=Re,vee=(({Request:t,Response:s})=>({Request:t,Response:s}))(Re.global),{ReadableStream:v4,TextEncoder:N4}=Re.global,w4=(t,...s)=>{try{return!!t(...s)}catch{return!1}},Nee=t=>{t=Re.merge.call({skipUndefined:!0},vee,t);const{fetch:s,Request:n,Response:a}=t,i=s?z0(s):typeof fetch=="function",l=z0(n),o=z0(a);if(!i)return!1;const c=i&&z0(v4),d=i&&(typeof N4=="function"?(v=>w=>v.encode(w))(new N4):async v=>new Uint8Array(await new n(v).arrayBuffer())),u=l&&c&&w4(()=>{let v=!1;const w=new n(Gr.origin,{body:new v4,method:"POST",get duplex(){return v=!0,"half"}}).headers.has("Content-Type");return v&&!w}),h=o&&c&&w4(()=>Re.isReadableStream(new a("").body)),f={stream:h&&(v=>v.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(v=>{!f[v]&&(f[v]=(w,_)=>{let S=w&&w[v];if(S)return S.call(w);throw new Qt(`Response type '${v}' is not supported`,Qt.ERR_NOT_SUPPORT,_)})});const x=async v=>{if(v==null)return 0;if(Re.isBlob(v))return v.size;if(Re.isSpecCompliantForm(v))return(await new n(Gr.origin,{method:"POST",body:v}).arrayBuffer()).byteLength;if(Re.isArrayBufferView(v)||Re.isArrayBuffer(v))return v.byteLength;if(Re.isURLSearchParams(v)&&(v=v+""),Re.isString(v))return(await d(v)).byteLength},b=async(v,w)=>{const _=Re.toFiniteNumber(v.getContentLength());return _??x(w)};return async v=>{let{url:w,method:_,data:S,signal:k,cancelToken:A,timeout:T,onDownloadProgress:P,onUploadProgress:O,responseType:D,headers:I,withCredentials:M="same-origin",fetchOptions:B}=N7(v),L=s||fetch;D=D?(D+"").toLowerCase():"text";let F=xee([k,A&&A.toAbortSignal()],T),V=null;const $=F&&F.unsubscribe&&(()=>{F.unsubscribe()});let z;try{if(O&&u&&_!=="get"&&_!=="head"&&(z=await b(I,S))!==0){let Ee=new n(w,{method:"POST",body:S,duplex:"half"}),ee;if(Re.isFormData(S)&&(ee=Ee.headers.get("content-type"))&&I.setContentType(ee),Ee.body){const[te,ce]=p4(z,Jy(x4(O)));S=y4(Ee.body,b4,te,ce)}}Re.isString(M)||(M=M?"include":"omit");const H=l&&"credentials"in n.prototype,q={...B,signal:F,method:_.toUpperCase(),headers:I.normalize().toJSON(),body:S,duplex:"half",credentials:H?M:void 0};V=l&&new n(w,q);let G=await(l?L(V,B):L(w,q));const re=h&&(D==="stream"||D==="response");if(h&&(P||re&&$)){const Ee={};["status","statusText","headers"].forEach(ge=>{Ee[ge]=G[ge]});const ee=Re.toFiniteNumber(G.headers.get("content-length")),[te,ce]=P&&p4(ee,Jy(x4(P),!0))||[];G=new a(y4(G.body,b4,te,()=>{ce&&ce(),$&&$()}),Ee)}D=D||"text";let ye=await f[Re.findKey(f,D)||"text"](G,v);return!re&&$&&$(),await new Promise((Ee,ee)=>{b7(Ee,ee,{data:ye,headers:Ra.from(G.headers),status:G.status,statusText:G.statusText,config:v,request:V})})}catch(H){throw $&&$(),H&&H.name==="TypeError"&&/Load failed|fetch/i.test(H.message)?Object.assign(new Qt("Network Error",Qt.ERR_NETWORK,v,V),{cause:H.cause||H}):Qt.from(H,H&&H.code,v,V)}}},wee=new Map,w7=t=>{let s=t?t.env:{};const{fetch:n,Request:a,Response:i}=s,l=[a,i,n];let o=l.length,c=o,d,u,h=wee;for(;c--;)d=l[c],u=h.get(d),u===void 0&&h.set(d,u=c?new Map:Nee(s)),h=u;return u};w7();const C_={http:FJ,xhr:pee,fetch:{get:w7}};Re.forEach(C_,(t,s)=>{if(t){try{Object.defineProperty(t,"name",{value:s})}catch{}Object.defineProperty(t,"adapterName",{value:s})}});const j4=t=>`- ${t}`,jee=t=>Re.isFunction(t)||t===null||t===!1,j7={getAdapter:(t,s)=>{t=Re.isArray(t)?t:[t];const{length:n}=t;let a,i;const l={};for(let o=0;o<n;o++){a=t[o];let c;if(i=a,!jee(a)&&(i=C_[(c=String(a)).toLowerCase()],i===void 0))throw new Qt(`Unknown adapter '${c}'`);if(i&&(Re.isFunction(i)||(i=i.get(s))))break;l[c||"#"+o]=i}if(!i){const o=Object.entries(l).map(([d,u])=>`adapter ${d} `+(u===!1?"is not supported by the environment":"is not available in the build"));let c=n?o.length>1?`since :
`+o.map(j4).join(`
`):" "+j4(o[0]):"as no adapter specified";throw new Qt("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return i},adapters:C_};function kw(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Dm(null,t)}function _4(t){return kw(t),t.headers=Ra.from(t.headers),t.data=Cw.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),j7.getAdapter(t.adapter||Fx.adapter,t)(t).then(function(a){return kw(t),a.data=Cw.call(t,t.transformResponse,a),a.headers=Ra.from(a.headers),a},function(a){return y7(a)||(kw(t),a&&a.response&&(a.response.data=Cw.call(t,t.transformResponse,a.response),a.response.headers=Ra.from(a.response.headers))),Promise.reject(a)})}const _7="1.12.2",Yb={};["object","boolean","number","function","string","symbol"].forEach((t,s)=>{Yb[t]=function(a){return typeof a===t||"a"+(s<1?"n ":" ")+t}});const S4={};Yb.transitional=function(s,n,a){function i(l,o){return"[Axios v"+_7+"] Transitional option '"+l+"'"+o+(a?". "+a:"")}return(l,o,c)=>{if(s===!1)throw new Qt(i(o," has been removed"+(n?" in "+n:"")),Qt.ERR_DEPRECATED);return n&&!S4[o]&&(S4[o]=!0,console.warn(i(o," has been deprecated since v"+n+" and will be removed in the near future"))),s?s(l,o,c):!0}};Yb.spelling=function(s){return(n,a)=>(console.warn(`${a} is likely a misspelling of ${s}`),!0)};function _ee(t,s,n){if(typeof t!="object")throw new Qt("options must be an object",Qt.ERR_BAD_OPTION_VALUE);const a=Object.keys(t);let i=a.length;for(;i-- >0;){const l=a[i],o=s[l];if(o){const c=t[l],d=c===void 0||o(c,l,t);if(d!==!0)throw new Qt("option "+l+" must be "+d,Qt.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Qt("Unknown option "+l,Qt.ERR_BAD_OPTION)}}const sy={assertOptions:_ee,validators:Yb},Bl=sy.validators;let iu=class{constructor(s){this.defaults=s||{},this.interceptors={request:new m4,response:new m4}}async request(s,n){try{return await this._request(s,n)}catch(a){if(a instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const l=i.stack?i.stack.replace(/^.+\n/,""):"";try{a.stack?l&&!String(a.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+l):a.stack=l}catch{}}throw a}}_request(s,n){typeof s=="string"?(n=n||{},n.url=s):n=s||{},n=ju(this.defaults,n);const{transitional:a,paramsSerializer:i,headers:l}=n;a!==void 0&&sy.assertOptions(a,{silentJSONParsing:Bl.transitional(Bl.boolean),forcedJSONParsing:Bl.transitional(Bl.boolean),clarifyTimeoutError:Bl.transitional(Bl.boolean)},!1),i!=null&&(Re.isFunction(i)?n.paramsSerializer={serialize:i}:sy.assertOptions(i,{encode:Bl.function,serialize:Bl.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),sy.assertOptions(n,{baseUrl:Bl.spelling("baseURL"),withXsrfToken:Bl.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=l&&Re.merge(l.common,l[n.method]);l&&Re.forEach(["delete","get","head","post","put","patch","common"],v=>{delete l[v]}),n.headers=Ra.concat(o,l);const c=[];let d=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(n)===!1||(d=d&&w.synchronous,c.unshift(w.fulfilled,w.rejected))});const u=[];this.interceptors.response.forEach(function(w){u.push(w.fulfilled,w.rejected)});let h,f=0,x;if(!d){const v=[_4.bind(this),void 0];for(v.unshift(...c),v.push(...u),x=v.length,h=Promise.resolve(n);f<x;)h=h.then(v[f++],v[f++]);return h}x=c.length;let b=n;for(;f<x;){const v=c[f++],w=c[f++];try{b=v(b)}catch(_){w.call(this,_);break}}try{h=_4.call(this,b)}catch(v){return Promise.reject(v)}for(f=0,x=u.length;f<x;)h=h.then(u[f++],u[f++]);return h}getUri(s){s=ju(this.defaults,s);const n=v7(s.baseURL,s.url,s.allowAbsoluteUrls);return p7(n,s.params,s.paramsSerializer)}};Re.forEach(["delete","get","head","options"],function(s){iu.prototype[s]=function(n,a){return this.request(ju(a||{},{method:s,url:n,data:(a||{}).data}))}});Re.forEach(["post","put","patch"],function(s){function n(a){return function(l,o,c){return this.request(ju(c||{},{method:s,headers:a?{"Content-Type":"multipart/form-data"}:{},url:l,data:o}))}}iu.prototype[s]=n(),iu.prototype[s+"Form"]=n(!0)});let See=class S7{constructor(s){if(typeof s!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(l){n=l});const a=this;this.promise.then(i=>{if(!a._listeners)return;let l=a._listeners.length;for(;l-- >0;)a._listeners[l](i);a._listeners=null}),this.promise.then=i=>{let l;const o=new Promise(c=>{a.subscribe(c),l=c}).then(i);return o.cancel=function(){a.unsubscribe(l)},o},s(function(l,o,c){a.reason||(a.reason=new Dm(l,o,c),n(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(s){if(this.reason){s(this.reason);return}this._listeners?this._listeners.push(s):this._listeners=[s]}unsubscribe(s){if(!this._listeners)return;const n=this._listeners.indexOf(s);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const s=new AbortController,n=a=>{s.abort(a)};return this.subscribe(n),s.signal.unsubscribe=()=>this.unsubscribe(n),s.signal}static source(){let s;return{token:new S7(function(i){s=i}),cancel:s}}};function Cee(t){return function(n){return t.apply(null,n)}}function kee(t){return Re.isObject(t)&&t.isAxiosError===!0}const k_={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(k_).forEach(([t,s])=>{k_[s]=t});function C7(t){const s=new iu(t),n=n7(iu.prototype.request,s);return Re.extend(n,iu.prototype,s,{allOwnKeys:!0}),Re.extend(n,s,null,{allOwnKeys:!0}),n.create=function(i){return C7(ju(t,i))},n}const On=C7(Fx);On.Axios=iu;On.CanceledError=Dm;On.CancelToken=See;On.isCancel=y7;On.VERSION=_7;On.toFormData=Kb;On.AxiosError=Qt;On.Cancel=On.CanceledError;On.all=function(s){return Promise.all(s)};On.spread=Cee;On.isAxiosError=kee;On.mergeConfig=ju;On.AxiosHeaders=Ra;On.formToJSON=t=>g7(Re.isHTMLForm(t)?new FormData(t):t);On.getAdapter=j7.getAdapter;On.HttpStatusCode=k_;On.default=On;const{Axios:Z9e,AxiosError:J9e,CanceledError:eBe,isCancel:tBe,CancelToken:sBe,VERSION:nBe,all:rBe,Cancel:aBe,isAxiosError:iBe,spread:lBe,toFormData:oBe,AxiosHeaders:cBe,HttpStatusCode:dBe,formToJSON:uBe,getAdapter:hBe,mergeConfig:mBe}=On;function Aee(t){if(typeof document>"u")return;let s=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",s.appendChild(n),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}const Eee=t=>{switch(t){case"success":return Iee;case"info":return Dee;case"warning":return Mee;case"error":return Oee;default:return null}},Tee=Array(12).fill(0),Pee=({visible:t,className:s})=>tt.createElement("div",{className:["sonner-loading-wrapper",s].filter(Boolean).join(" "),"data-visible":t},tt.createElement("div",{className:"sonner-spinner"},Tee.map((n,a)=>tt.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${a}`})))),Iee=tt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},tt.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Mee=tt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},tt.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Dee=tt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},tt.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Oee=tt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},tt.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Ree=tt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},tt.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),tt.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),Lee=()=>{const[t,s]=tt.useState(document.hidden);return tt.useEffect(()=>{const n=()=>{s(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),t};let A_=1;class Bee{constructor(){this.subscribe=s=>(this.subscribers.push(s),()=>{const n=this.subscribers.indexOf(s);this.subscribers.splice(n,1)}),this.publish=s=>{this.subscribers.forEach(n=>n(s))},this.addToast=s=>{this.publish(s),this.toasts=[...this.toasts,s]},this.create=s=>{var n;const{message:a,...i}=s,l=typeof(s==null?void 0:s.id)=="number"||((n=s.id)==null?void 0:n.length)>0?s.id:A_++,o=this.toasts.find(d=>d.id===l),c=s.dismissible===void 0?!0:s.dismissible;return this.dismissedToasts.has(l)&&this.dismissedToasts.delete(l),o?this.toasts=this.toasts.map(d=>d.id===l?(this.publish({...d,...s,id:l,title:a}),{...d,...s,id:l,dismissible:c,title:a}):d):this.addToast({title:a,...i,dismissible:c,id:l}),l},this.dismiss=s=>(s?(this.dismissedToasts.add(s),requestAnimationFrame(()=>this.subscribers.forEach(n=>n({id:s,dismiss:!0})))):this.toasts.forEach(n=>{this.subscribers.forEach(a=>a({id:n.id,dismiss:!0}))}),s),this.message=(s,n)=>this.create({...n,message:s}),this.error=(s,n)=>this.create({...n,message:s,type:"error"}),this.success=(s,n)=>this.create({...n,type:"success",message:s}),this.info=(s,n)=>this.create({...n,type:"info",message:s}),this.warning=(s,n)=>this.create({...n,type:"warning",message:s}),this.loading=(s,n)=>this.create({...n,type:"loading",message:s}),this.promise=(s,n)=>{if(!n)return;let a;n.loading!==void 0&&(a=this.create({...n,promise:s,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));const i=Promise.resolve(s instanceof Function?s():s);let l=a!==void 0,o;const c=i.then(async u=>{if(o=["resolve",u],tt.isValidElement(u))l=!1,this.create({id:a,type:"default",message:u});else if($ee(u)&&!u.ok){l=!1;const f=typeof n.error=="function"?await n.error(`HTTP error! status: ${u.status}`):n.error,x=typeof n.description=="function"?await n.description(`HTTP error! status: ${u.status}`):n.description,v=typeof f=="object"&&!tt.isValidElement(f)?f:{message:f};this.create({id:a,type:"error",description:x,...v})}else if(u instanceof Error){l=!1;const f=typeof n.error=="function"?await n.error(u):n.error,x=typeof n.description=="function"?await n.description(u):n.description,v=typeof f=="object"&&!tt.isValidElement(f)?f:{message:f};this.create({id:a,type:"error",description:x,...v})}else if(n.success!==void 0){l=!1;const f=typeof n.success=="function"?await n.success(u):n.success,x=typeof n.description=="function"?await n.description(u):n.description,v=typeof f=="object"&&!tt.isValidElement(f)?f:{message:f};this.create({id:a,type:"success",description:x,...v})}}).catch(async u=>{if(o=["reject",u],n.error!==void 0){l=!1;const h=typeof n.error=="function"?await n.error(u):n.error,f=typeof n.description=="function"?await n.description(u):n.description,b=typeof h=="object"&&!tt.isValidElement(h)?h:{message:h};this.create({id:a,type:"error",description:f,...b})}}).finally(()=>{l&&(this.dismiss(a),a=void 0),n.finally==null||n.finally.call(n)}),d=()=>new Promise((u,h)=>c.then(()=>o[0]==="reject"?h(o[1]):u(o[1])).catch(h));return typeof a!="string"&&typeof a!="number"?{unwrap:d}:Object.assign(a,{unwrap:d})},this.custom=(s,n)=>{const a=(n==null?void 0:n.id)||A_++;return this.create({jsx:s(a),id:a,...n}),a},this.getActiveToasts=()=>this.toasts.filter(s=>!this.dismissedToasts.has(s.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const Ca=new Bee,Fee=(t,s)=>{const n=(s==null?void 0:s.id)||A_++;return Ca.addToast({title:t,...s,id:n}),n},$ee=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",zee=Fee,Uee=()=>Ca.toasts,Vee=()=>Ca.getActiveToasts(),se=Object.assign(zee,{success:Ca.success,info:Ca.info,warning:Ca.warning,error:Ca.error,custom:Ca.custom,message:Ca.message,promise:Ca.promise,dismiss:Ca.dismiss,loading:Ca.loading},{getHistory:Uee,getToasts:Vee});Aee("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function U0(t){return t.label!==void 0}const Hee=3,Wee="24px",qee="16px",C4=4e3,Gee=356,Kee=14,Yee=45,Xee=200;function Fl(...t){return t.filter(Boolean).join(" ")}function Qee(t){const[s,n]=t.split("-"),a=[];return s&&a.push(s),n&&a.push(n),a}const Zee=t=>{var s,n,a,i,l,o,c,d,u;const{invert:h,toast:f,unstyled:x,interacting:b,setHeights:v,visibleToasts:w,heights:_,index:S,toasts:k,expanded:A,removeToast:T,defaultRichColors:P,closeButton:O,style:D,cancelButtonStyle:I,actionButtonStyle:M,className:B="",descriptionClassName:L="",duration:F,position:V,gap:$,expandByDefault:z,classNames:H,icons:q,closeButtonAriaLabel:G="Close toast"}=t,[re,ye]=tt.useState(null),[Ee,ee]=tt.useState(null),[te,ce]=tt.useState(!1),[ge,X]=tt.useState(!1),[de,Ce]=tt.useState(!1),[ue,fe]=tt.useState(!1),[pe,oe]=tt.useState(!1),[qe,Xe]=tt.useState(0),[jt,ft]=tt.useState(0),it=tt.useRef(f.duration||F||C4),_t=tt.useRef(null),ve=tt.useRef(null),ae=S===0,xe=S+1<=w,je=f.type,Fe=f.dismissible!==!1,Ct=f.className||"",vt=f.descriptionClassName||"",pt=tt.useMemo(()=>_.findIndex(Mt=>Mt.toastId===f.id)||0,[_,f.id]),Ns=tt.useMemo(()=>{var Mt;return(Mt=f.closeButton)!=null?Mt:O},[f.closeButton,O]),ds=tt.useMemo(()=>f.duration||F||C4,[f.duration,F]),ie=tt.useRef(0),Ie=tt.useRef(0),he=tt.useRef(0),Me=tt.useRef(null),[Ge,Be]=V.split("-"),Ot=tt.useMemo(()=>_.reduce((Mt,we,lt)=>lt>=pt?Mt:Mt+we.height,0),[_,pt]),Rt=Lee(),Jt=f.invert||h,ys=je==="loading";Ie.current=tt.useMemo(()=>pt*$+Ot,[pt,Ot]),tt.useEffect(()=>{it.current=ds},[ds]),tt.useEffect(()=>{ce(!0)},[]),tt.useEffect(()=>{const Mt=ve.current;if(Mt){const we=Mt.getBoundingClientRect().height;return ft(we),v(lt=>[{toastId:f.id,height:we,position:f.position},...lt]),()=>v(lt=>lt.filter(ht=>ht.toastId!==f.id))}},[v,f.id]),tt.useLayoutEffect(()=>{if(!te)return;const Mt=ve.current,we=Mt.style.height;Mt.style.height="auto";const lt=Mt.getBoundingClientRect().height;Mt.style.height=we,ft(lt),v(ht=>ht.find(Wt=>Wt.toastId===f.id)?ht.map(Wt=>Wt.toastId===f.id?{...Wt,height:lt}:Wt):[{toastId:f.id,height:lt,position:f.position},...ht])},[te,f.title,f.description,v,f.id,f.jsx,f.action,f.cancel]);const Qs=tt.useCallback(()=>{X(!0),Xe(Ie.current),v(Mt=>Mt.filter(we=>we.toastId!==f.id)),setTimeout(()=>{T(f)},Xee)},[f,T,v,Ie]);tt.useEffect(()=>{if(f.promise&&je==="loading"||f.duration===1/0||f.type==="loading")return;let Mt;return A||b||Rt?(()=>{if(he.current<ie.current){const ht=new Date().getTime()-ie.current;it.current=it.current-ht}he.current=new Date().getTime()})():(()=>{it.current!==1/0&&(ie.current=new Date().getTime(),Mt=setTimeout(()=>{f.onAutoClose==null||f.onAutoClose.call(f,f),Qs()},it.current))})(),()=>clearTimeout(Mt)},[A,b,f,je,Rt,Qs]),tt.useEffect(()=>{f.delete&&(Qs(),f.onDismiss==null||f.onDismiss.call(f,f))},[Qs,f.delete]);function na(){var Mt;if(q!=null&&q.loading){var we;return tt.createElement("div",{className:Fl(H==null?void 0:H.loader,f==null||(we=f.classNames)==null?void 0:we.loader,"sonner-loader"),"data-visible":je==="loading"},q.loading)}return tt.createElement(Pee,{className:Fl(H==null?void 0:H.loader,f==null||(Mt=f.classNames)==null?void 0:Mt.loader),visible:je==="loading"})}const qt=f.icon||(q==null?void 0:q[je])||Eee(je);var Gt,ra;return tt.createElement("li",{tabIndex:0,ref:ve,className:Fl(B,Ct,H==null?void 0:H.toast,f==null||(s=f.classNames)==null?void 0:s.toast,H==null?void 0:H.default,H==null?void 0:H[je],f==null||(n=f.classNames)==null?void 0:n[je]),"data-sonner-toast":"","data-rich-colors":(Gt=f.richColors)!=null?Gt:P,"data-styled":!(f.jsx||f.unstyled||x),"data-mounted":te,"data-promise":!!f.promise,"data-swiped":pe,"data-removed":ge,"data-visible":xe,"data-y-position":Ge,"data-x-position":Be,"data-index":S,"data-front":ae,"data-swiping":de,"data-dismissible":Fe,"data-type":je,"data-invert":Jt,"data-swipe-out":ue,"data-swipe-direction":Ee,"data-expanded":!!(A||z&&te),"data-testid":f.testId,style:{"--index":S,"--toasts-before":S,"--z-index":k.length-S,"--offset":`${ge?qe:Ie.current}px`,"--initial-height":z?"auto":`${jt}px`,...D,...f.style},onDragEnd:()=>{Ce(!1),ye(null),Me.current=null},onPointerDown:Mt=>{Mt.button!==2&&(ys||!Fe||(_t.current=new Date,Xe(Ie.current),Mt.target.setPointerCapture(Mt.pointerId),Mt.target.tagName!=="BUTTON"&&(Ce(!0),Me.current={x:Mt.clientX,y:Mt.clientY})))},onPointerUp:()=>{var Mt,we,lt;if(ue||!Fe)return;Me.current=null;const ht=Number(((Mt=ve.current)==null?void 0:Mt.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Kt=Number(((we=ve.current)==null?void 0:we.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Wt=new Date().getTime()-((lt=_t.current)==null?void 0:lt.getTime()),Ht=re==="x"?ht:Kt,Ls=Math.abs(Ht)/Wt;if(Math.abs(Ht)>=Yee||Ls>.11){Xe(Ie.current),f.onDismiss==null||f.onDismiss.call(f,f),ee(re==="x"?ht>0?"right":"left":Kt>0?"down":"up"),Qs(),fe(!0);return}else{var bs,on;(bs=ve.current)==null||bs.style.setProperty("--swipe-amount-x","0px"),(on=ve.current)==null||on.style.setProperty("--swipe-amount-y","0px")}oe(!1),Ce(!1),ye(null)},onPointerMove:Mt=>{var we,lt,ht;if(!Me.current||!Fe||((we=window.getSelection())==null?void 0:we.toString().length)>0)return;const Wt=Mt.clientY-Me.current.y,Ht=Mt.clientX-Me.current.x;var Ls;const bs=(Ls=t.swipeDirections)!=null?Ls:Qee(V);!re&&(Math.abs(Ht)>1||Math.abs(Wt)>1)&&ye(Math.abs(Ht)>Math.abs(Wt)?"x":"y");let on={x:0,y:0};const ws=yn=>1/(1.5+Math.abs(yn)/20);if(re==="y"){if(bs.includes("top")||bs.includes("bottom"))if(bs.includes("top")&&Wt<0||bs.includes("bottom")&&Wt>0)on.y=Wt;else{const yn=Wt*ws(Wt);on.y=Math.abs(yn)<Math.abs(Wt)?yn:Wt}}else if(re==="x"&&(bs.includes("left")||bs.includes("right")))if(bs.includes("left")&&Ht<0||bs.includes("right")&&Ht>0)on.x=Ht;else{const yn=Ht*ws(Ht);on.x=Math.abs(yn)<Math.abs(Ht)?yn:Ht}(Math.abs(on.x)>0||Math.abs(on.y)>0)&&oe(!0),(lt=ve.current)==null||lt.style.setProperty("--swipe-amount-x",`${on.x}px`),(ht=ve.current)==null||ht.style.setProperty("--swipe-amount-y",`${on.y}px`)}},Ns&&!f.jsx&&je!=="loading"?tt.createElement("button",{"aria-label":G,"data-disabled":ys,"data-close-button":!0,onClick:ys||!Fe?()=>{}:()=>{Qs(),f.onDismiss==null||f.onDismiss.call(f,f)},className:Fl(H==null?void 0:H.closeButton,f==null||(a=f.classNames)==null?void 0:a.closeButton)},(ra=q==null?void 0:q.close)!=null?ra:Ree):null,(je||f.icon||f.promise)&&f.icon!==null&&((q==null?void 0:q[je])!==null||f.icon)?tt.createElement("div",{"data-icon":"",className:Fl(H==null?void 0:H.icon,f==null||(i=f.classNames)==null?void 0:i.icon)},f.promise||f.type==="loading"&&!f.icon?f.icon||na():null,f.type!=="loading"?qt:null):null,tt.createElement("div",{"data-content":"",className:Fl(H==null?void 0:H.content,f==null||(l=f.classNames)==null?void 0:l.content)},tt.createElement("div",{"data-title":"",className:Fl(H==null?void 0:H.title,f==null||(o=f.classNames)==null?void 0:o.title)},f.jsx?f.jsx:typeof f.title=="function"?f.title():f.title),f.description?tt.createElement("div",{"data-description":"",className:Fl(L,vt,H==null?void 0:H.description,f==null||(c=f.classNames)==null?void 0:c.description)},typeof f.description=="function"?f.description():f.description):null),tt.isValidElement(f.cancel)?f.cancel:f.cancel&&U0(f.cancel)?tt.createElement("button",{"data-button":!0,"data-cancel":!0,style:f.cancelButtonStyle||I,onClick:Mt=>{U0(f.cancel)&&Fe&&(f.cancel.onClick==null||f.cancel.onClick.call(f.cancel,Mt),Qs())},className:Fl(H==null?void 0:H.cancelButton,f==null||(d=f.classNames)==null?void 0:d.cancelButton)},f.cancel.label):null,tt.isValidElement(f.action)?f.action:f.action&&U0(f.action)?tt.createElement("button",{"data-button":!0,"data-action":!0,style:f.actionButtonStyle||M,onClick:Mt=>{U0(f.action)&&(f.action.onClick==null||f.action.onClick.call(f.action,Mt),!Mt.defaultPrevented&&Qs())},className:Fl(H==null?void 0:H.actionButton,f==null||(u=f.classNames)==null?void 0:u.actionButton)},f.action.label):null)};function k4(){if(typeof window>"u"||typeof document>"u")return"ltr";const t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function Jee(t,s){const n={};return[t,s].forEach((a,i)=>{const l=i===1,o=l?"--mobile-offset":"--offset",c=l?qee:Wee;function d(u){["top","right","bottom","left"].forEach(h=>{n[`${o}-${h}`]=typeof u=="number"?`${u}px`:u})}typeof a=="number"||typeof a=="string"?d(a):typeof a=="object"?["top","right","bottom","left"].forEach(u=>{a[u]===void 0?n[`${o}-${u}`]=c:n[`${o}-${u}`]=typeof a[u]=="number"?`${a[u]}px`:a[u]}):d(c)}),n}const ete=tt.forwardRef(function(s,n){const{id:a,invert:i,position:l="bottom-right",hotkey:o=["altKey","KeyT"],expand:c,closeButton:d,className:u,offset:h,mobileOffset:f,theme:x="light",richColors:b,duration:v,style:w,visibleToasts:_=Hee,toastOptions:S,dir:k=k4(),gap:A=Kee,icons:T,containerAriaLabel:P="Notifications"}=s,[O,D]=tt.useState([]),I=tt.useMemo(()=>a?O.filter(te=>te.toasterId===a):O.filter(te=>!te.toasterId),[O,a]),M=tt.useMemo(()=>Array.from(new Set([l].concat(I.filter(te=>te.position).map(te=>te.position)))),[I,l]),[B,L]=tt.useState([]),[F,V]=tt.useState(!1),[$,z]=tt.useState(!1),[H,q]=tt.useState(x!=="system"?x:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),G=tt.useRef(null),re=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),ye=tt.useRef(null),Ee=tt.useRef(!1),ee=tt.useCallback(te=>{D(ce=>{var ge;return(ge=ce.find(X=>X.id===te.id))!=null&&ge.delete||Ca.dismiss(te.id),ce.filter(({id:X})=>X!==te.id)})},[]);return tt.useEffect(()=>Ca.subscribe(te=>{if(te.dismiss){requestAnimationFrame(()=>{D(ce=>ce.map(ge=>ge.id===te.id?{...ge,delete:!0}:ge))});return}setTimeout(()=>{VL.flushSync(()=>{D(ce=>{const ge=ce.findIndex(X=>X.id===te.id);return ge!==-1?[...ce.slice(0,ge),{...ce[ge],...te},...ce.slice(ge+1)]:[te,...ce]})})})}),[O]),tt.useEffect(()=>{if(x!=="system"){q(x);return}if(x==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?q("dark"):q("light")),typeof window>"u")return;const te=window.matchMedia("(prefers-color-scheme: dark)");try{te.addEventListener("change",({matches:ce})=>{q(ce?"dark":"light")})}catch{te.addListener(({matches:ge})=>{try{q(ge?"dark":"light")}catch(X){console.error(X)}})}},[x]),tt.useEffect(()=>{O.length<=1&&V(!1)},[O]),tt.useEffect(()=>{const te=ce=>{var ge;if(o.every(Ce=>ce[Ce]||ce.code===Ce)){var de;V(!0),(de=G.current)==null||de.focus()}ce.code==="Escape"&&(document.activeElement===G.current||(ge=G.current)!=null&&ge.contains(document.activeElement))&&V(!1)};return document.addEventListener("keydown",te),()=>document.removeEventListener("keydown",te)},[o]),tt.useEffect(()=>{if(G.current)return()=>{ye.current&&(ye.current.focus({preventScroll:!0}),ye.current=null,Ee.current=!1)}},[G.current]),tt.createElement("section",{ref:n,"aria-label":`${P} ${re}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},M.map((te,ce)=>{var ge;const[X,de]=te.split("-");return I.length?tt.createElement("ol",{key:te,dir:k==="auto"?k4():k,tabIndex:-1,ref:G,className:u,"data-sonner-toaster":!0,"data-sonner-theme":H,"data-y-position":X,"data-x-position":de,style:{"--front-toast-height":`${((ge=B[0])==null?void 0:ge.height)||0}px`,"--width":`${Gee}px`,"--gap":`${A}px`,...w,...Jee(h,f)},onBlur:Ce=>{Ee.current&&!Ce.currentTarget.contains(Ce.relatedTarget)&&(Ee.current=!1,ye.current&&(ye.current.focus({preventScroll:!0}),ye.current=null))},onFocus:Ce=>{Ce.target instanceof HTMLElement&&Ce.target.dataset.dismissible==="false"||Ee.current||(Ee.current=!0,ye.current=Ce.relatedTarget)},onMouseEnter:()=>V(!0),onMouseMove:()=>V(!0),onMouseLeave:()=>{$||V(!1)},onDragEnd:()=>V(!1),onPointerDown:Ce=>{Ce.target instanceof HTMLElement&&Ce.target.dataset.dismissible==="false"||z(!0)},onPointerUp:()=>z(!1)},I.filter(Ce=>!Ce.position&&ce===0||Ce.position===te).map((Ce,ue)=>{var fe,pe;return tt.createElement(Zee,{key:Ce.id,icons:T,index:ue,toast:Ce,defaultRichColors:b,duration:(fe=S==null?void 0:S.duration)!=null?fe:v,className:S==null?void 0:S.className,descriptionClassName:S==null?void 0:S.descriptionClassName,invert:i,visibleToasts:_,closeButton:(pe=S==null?void 0:S.closeButton)!=null?pe:d,interacting:$,position:te,style:S==null?void 0:S.style,unstyled:S==null?void 0:S.unstyled,classNames:S==null?void 0:S.classNames,cancelButtonStyle:S==null?void 0:S.cancelButtonStyle,actionButtonStyle:S==null?void 0:S.actionButtonStyle,closeButtonAriaLabel:S==null?void 0:S.closeButtonAriaLabel,removeToast:ee,toasts:I.filter(oe=>oe.position==Ce.position),heights:B.filter(oe=>oe.position==Ce.position),setHeights:L,expandByDefault:c,gap:A,expanded:F,swipeDirections:s.swipeDirections})})):null}))}),R3="https://api.nutryah.com/api",J=On.create({baseURL:R3,withCredentials:!0});J.interceptors.request.use(t=>{const s=localStorage.getItem("access_token"),n=localStorage.getItem("tenant_code");return s&&(t.headers=t.headers||{},t.headers.Authorization=`Bearer ${s}`),n&&(t.headers=t.headers||{},t.headers["X-Tenant-Code"]=n),t});async function tte(t,s){var n,a,i,l,o,c;try{const d=localStorage.getItem("tenant_code")||null;let u=null;try{(n=t==null?void 0:t.config)!=null&&n.data&&(u=typeof t.config.data=="string"?JSON.parse(t.config.data):t.config.data)}catch{u={raw:(a=t==null?void 0:t.config)==null?void 0:a.data}}const h={message:s,page_url:window.location.href,request_url:((i=t==null?void 0:t.config)==null?void 0:i.url)||null,request_method:((l=t==null?void 0:t.config)==null?void 0:l.method)||null,http_status:((o=t==null?void 0:t.response)==null?void 0:o.status)||null,request_payload:u,response_payload:((c=t==null?void 0:t.response)==null?void 0:c.data)||null,stack_trace:(t==null?void 0:t.stack)||null,tenant_code:d,user_agent:navigator.userAgent,extra:{network:navigator.onLine?"online":"offline"}};await fetch(`${R3}/system/client-error`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h),keepalive:!0})}catch(d){console.error("Failed to report client error",d)}}let kf=null;async function k7(){if(kf)return kf;const t=localStorage.getItem("tenant_code")||null;return kf=(async()=>{try{const s=await fetch(`${R3}/auth/refresh`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...t?{"X-Tenant-Code":t}:{}}});if(!s.ok)throw new Error(`Refresh failed with status ${s.status}`);const n=await s.json();return n!=null&&n.access_token&&localStorage.setItem("access_token",n.access_token),(n==null?void 0:n.access_token)||null}finally{kf=null}})(),kf}J.interceptors.response.use(t=>t,async t=>{var o,c,d,u;const s=(o=t==null?void 0:t.response)==null?void 0:o.status,n=(c=t==null?void 0:t.response)==null?void 0:c.data,a=t.config||{};if(s===401&&!a._retry){a._retry=!0;try{const h=await k7();if(h)return a.headers=a.headers||{},a.headers.Authorization=`Bearer ${h}`,J(a)}catch(h){console.error("Refresh token flow failed",h)}localStorage.clear(),(u=(d=J.defaults.headers)==null?void 0:d.common)==null||delete u.Authorization}const i=n==null?void 0:n.detail;let l="Unexpected error";return Array.isArray(i)?l=i.map(h=>`${Array.isArray(h.loc)?h.loc.join("."):h.loc}: ${h.msg}`).join(`
`):typeof i=="string"?l=i:typeof(n==null?void 0:n.message)=="string"?l=n.message:t!=null&&t.message&&(l=t.message),console.error("API error:",s,n),se.error(l),tte(t,l),Promise.reject(t)});const ste={},A4=t=>{let s;const n=new Set,a=(h,f)=>{const x=typeof h=="function"?h(s):h;if(!Object.is(x,s)){const b=s;s=f??(typeof x!="object"||x===null)?x:Object.assign({},s,x),n.forEach(v=>v(s,b))}},i=()=>s,d={setState:a,getState:i,getInitialState:()=>u,subscribe:h=>(n.add(h),()=>n.delete(h)),destroy:()=>{(ste?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=s=t(a,i,d);return d},nte=t=>t?A4(t):A4;var A7={exports:{}},E7={},T7={exports:{}},P7={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var om=y;function rte(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var ate=typeof Object.is=="function"?Object.is:rte,ite=om.useState,lte=om.useEffect,ote=om.useLayoutEffect,cte=om.useDebugValue;function dte(t,s){var n=s(),a=ite({inst:{value:n,getSnapshot:s}}),i=a[0].inst,l=a[1];return ote(function(){i.value=n,i.getSnapshot=s,Aw(i)&&l({inst:i})},[t,n,s]),lte(function(){return Aw(i)&&l({inst:i}),t(function(){Aw(i)&&l({inst:i})})},[t]),cte(n),n}function Aw(t){var s=t.getSnapshot;t=t.value;try{var n=s();return!ate(t,n)}catch{return!0}}function ute(t,s){return s()}var hte=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?ute:dte;P7.useSyncExternalStore=om.useSyncExternalStore!==void 0?om.useSyncExternalStore:hte;T7.exports=P7;var mte=T7.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xb=y,fte=mte;function pte(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var xte=typeof Object.is=="function"?Object.is:pte,gte=fte.useSyncExternalStore,yte=Xb.useRef,bte=Xb.useEffect,vte=Xb.useMemo,Nte=Xb.useDebugValue;E7.useSyncExternalStoreWithSelector=function(t,s,n,a,i){var l=yte(null);if(l.current===null){var o={hasValue:!1,value:null};l.current=o}else o=l.current;l=vte(function(){function d(b){if(!u){if(u=!0,h=b,b=a(b),i!==void 0&&o.hasValue){var v=o.value;if(i(v,b))return f=v}return f=b}if(v=f,xte(h,b))return v;var w=a(b);return i!==void 0&&i(v,w)?(h=b,v):(h=b,f=w)}var u=!1,h,f,x=n===void 0?null:n;return[function(){return d(s())},x===null?void 0:function(){return d(x())}]},[s,n,a,i]);var c=gte(t,l[0],l[1]);return bte(function(){o.hasValue=!0,o.value=c},[c]),Nte(c),c};A7.exports=E7;var I7=A7.exports;const wte=Yi(I7),M7={},{useDebugValue:jte}=tt,{useSyncExternalStoreWithSelector:_te}=wte;let E4=!1;const Ste=t=>t;function Cte(t,s=Ste,n){(M7?"production":void 0)!=="production"&&n&&!E4&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),E4=!0);const a=_te(t.subscribe,t.getState,t.getServerState||t.getInitialState,s,n);return jte(a),a}const T4=t=>{(M7?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const s=typeof t=="function"?nte(t):t,n=(a,i)=>Cte(s,a,i);return Object.assign(n,s),n},D7=t=>t?T4(t):T4,cr=D7((t,s)=>({user:null,modules:{},loading:!1,tenantCode:localStorage.getItem("tenant_code")||"",setTenantCode:n=>{n?localStorage.setItem("tenant_code",n):localStorage.removeItem("tenant_code"),t({tenantCode:n})},registerAdmin:async n=>{var l;const a=await J.post("/auth/register-admin",n),i=(l=a==null?void 0:a.data)==null?void 0:l.tenant_code;return i&&(localStorage.setItem("tenant_code",i),t({tenantCode:i})),a},login:async({tenant_code:n,email:a,password:i})=>{const l={tenant_code:n==null?void 0:n.trim(),email:a,password:i},{data:o}=await J.post("/auth/login",l);return n&&(localStorage.setItem("tenant_code",n.trim()),t({tenantCode:n.trim()})),o},verifyOtp:async({tenant_code:n,email:a,otp:i})=>{const l={tenant_code:n==null?void 0:n.trim(),email:a,otp:i},{data:o}=await J.post("/auth/verify-otp",l);return localStorage.setItem("access_token",o.access_token),localStorage.setItem("refresh_token",o.refresh_token),J.defaults.headers.common.Authorization=`Bearer ${o.access_token}`,n&&(localStorage.setItem("tenant_code",n.trim()),t({tenantCode:n.trim()})),o},fetchProfile:async()=>{var n;try{t({loading:!0});const a=await J.get("/auth/me"),i=await J.get("/auth/me/permissions"),l=(n=a==null?void 0:a.data)==null?void 0:n.tenant_code;l&&localStorage.setItem("tenant_code",l),t({user:a.data,modules:i.data.modules||{},tenantCode:l||s().tenantCode})}finally{t({loading:!1})}},logout:()=>{localStorage.clear(),delete J.defaults.headers.common.Authorization,t({user:null,modules:{},tenantCode:""})}}));/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kte=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ate=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(s,n,a)=>a?a.toUpperCase():n.toLowerCase()),P4=t=>{const s=Ate(t);return s.charAt(0).toUpperCase()+s.slice(1)},O7=(...t)=>t.filter((s,n,a)=>!!s&&s.trim()!==""&&a.indexOf(s)===n).join(" ").trim(),Ete=t=>{for(const s in t)if(s.startsWith("aria-")||s==="role"||s==="title")return!0};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Tte={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pte=y.forwardRef(({color:t="currentColor",size:s=24,strokeWidth:n=2,absoluteStrokeWidth:a,className:i="",children:l,iconNode:o,...c},d)=>y.createElement("svg",{ref:d,...Tte,width:s,height:s,stroke:t,strokeWidth:a?Number(n)*24/Number(s):n,className:O7("lucide",i),...!l&&!Ete(c)&&{"aria-hidden":"true"},...c},[...o.map(([u,h])=>y.createElement(u,h)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=(t,s)=>{const n=y.forwardRef(({className:a,...i},l)=>y.createElement(Pte,{ref:l,iconNode:s,className:O7(`lucide-${kte(P4(t))}`,`lucide-${t}`,a),...i}));return n.displayName=P4(t),n};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ite=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Vs=$e("activity",Ite);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mte=[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]],Dte=$e("arrow-left-right",Mte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ote=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Qb=$e("arrow-left",Ote);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rte=[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]],L3=$e("beaker",Rte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lte=[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]],kn=$e("bed-double",Lte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bte=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Fte=$e("bell",Bte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $te=[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]],zte=$e("boxes",$te);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ute=[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]],Vte=$e("bug",Ute);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hte=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],fa=$e("building-2",Hte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wte=[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]],I4=$e("calendar-clock",Wte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qte=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],ar=$e("calendar-days",qte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gte=[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]],Th=$e("calendar-range",Gte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kte=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],E_=$e("calendar",Kte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yte=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],M4=$e("camera",Yte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xte=[["path",{d:"M14.564 14.558a3 3 0 1 1-4.122-4.121",key:"1rnrzw"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M20 20H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 .819-.175",key:"1x3arw"}],["path",{d:"M9.695 4.024A2 2 0 0 1 10.004 4h3.993a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v7.344",key:"1i84u0"}]],Qte=$e("camera-off",Xte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zte=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Kf=$e("chart-column",Zte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jte=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],ese=$e("chart-no-axes-column",Jte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tse=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],B3=$e("check",tse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sse=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],$x=$e("chevron-down",sse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nse=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],zx=$e("chevron-left",nse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rse=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Om=$e("chevron-right",rse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ase=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ise=$e("chevron-up",ase);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lse=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],nn=$e("circle-alert",lse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ose=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Dn=$e("circle-check",ose);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cse=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],dse=$e("circle-play",cse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const use=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Ux=$e("circle-x",use);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hse=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],mse=$e("clipboard-check",hse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fse=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],yr=$e("clipboard-list",fse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pse=[["path",{d:"M12 6v6h4",key:"135r8i"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],lr=$e("clock-3",pse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xse=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ba=$e("clock",xse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gse=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],Af=$e("cloud-upload",gse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yse=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],bse=$e("credit-card",yse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vse=[["path",{d:"M10 12h.01",key:"1kxr2c"}],["path",{d:"M18 20V6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14",key:"36qu9e"}],["path",{d:"M2 20h20",key:"owomy5"}]],R7=$e("door-closed",vse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nse=[["circle",{cx:"12.1",cy:"12.1",r:"1",key:"18d7e5"}]],V0=$e("dot",Nse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wse=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],to=$e("download",wse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jse=[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]],_se=$e("droplet",jse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sse=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],T_=$e("droplets",Sse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cse=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],kse=$e("eye-off",Cse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ase=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],up=$e("eye",Ase);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ese=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],Tse=$e("file-down",Ese);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pse=[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M3 15h6",key:"4e2qda"}],["path",{d:"M6 12v6",key:"1u72j0"}]],Ise=$e("file-plus-2",Pse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mse=[["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]],Dse=$e("file-question-mark",Mse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ose=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],Rse=$e("file-spreadsheet",Ose);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lse=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],gl=$e("file-text",Lse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bse=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],Fse=$e("file-up",Bse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $se=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],Li=$e("flask-conical",$se);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zse=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],$r=$e("funnel",zse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Use=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],qp=$e("hash",Use);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vse=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}],["path",{d:"M3.22 13H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"auskq0"}]],cm=$e("heart-pulse",Vse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hse=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Wse=$e("history",Hse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qse=[["path",{d:"M12 7v4",key:"xawao1"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M14 9h-4",key:"1w2s2s"}],["path",{d:"M18 11h2a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-9a2 2 0 0 1 2-2h2",key:"1tthqt"}],["path",{d:"M18 21V5a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16",key:"dw4p4i"}]],Ew=$e("hospital",qse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gse=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Kse=$e("image",Gse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yse=[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]],ny=$e("inbox",Yse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xse=[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]],Kl=$e("indian-rupee",Xse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qse=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Gp=$e("info",Qse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zse=[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]],Ei=$e("key-round",Zse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jse=[["rect",{width:"18",height:"12",x:"3",y:"4",rx:"2",ry:"2",key:"1qhy41"}],["line",{x1:"2",x2:"22",y1:"20",y2:"20",key:"ni3hll"}]],ene=$e("laptop-minimal",Jse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tne=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],H0=$e("layout-dashboard",tne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sne=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],L7=$e("layers",sne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nne=[["rect",{width:"18",height:"7",x:"3",y:"3",rx:"1",key:"f1a2em"}],["rect",{width:"9",height:"7",x:"3",y:"14",rx:"1",key:"jqznyg"}],["rect",{width:"5",height:"7",x:"16",y:"14",rx:"1",key:"q5h2i8"}]],rne=$e("layout-template",nne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ane=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],D4=$e("link-2",ane);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ine=[["path",{d:"M13 5h8",key:"a7qcls"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 19h8",key:"c3s6r1"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}]],lne=$e("list-checks",ine);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const one=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ns=$e("loader-circle",one);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cne=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],dne=$e("log-out",cne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const une=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],hne=$e("lock",une);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mne=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],dm=$e("mail",mne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fne=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],B7=$e("map-pin",fne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pne=[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"pqwjuv"}]],O4=$e("notebook-pen",pne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xne=[["path",{d:"M12 22v-9",key:"x3hkom"}],["path",{d:"M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z",key:"2ntwy6"}],["path",{d:"M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13",key:"1pmm1c"}],["path",{d:"M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z",key:"12ttoo"}]],gne=$e("package-open",xne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yne=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],F7=$e("package",yne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bne=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],vne=$e("paperclip",bne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nne=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],$7=$e("pen",Nne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wne=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Fa=$e("pencil",wne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jne=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],R4=$e("phone",jne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _ne=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],dr=$e("pill",_ne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sne=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ps=$e("plus",Sne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cne=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],e1=$e("printer",Cne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kne=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]],Tw=$e("qr-code",kne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ane=[["path",{d:"M16.247 7.761a6 6 0 0 1 0 8.478",key:"1fwjs5"}],["path",{d:"M19.075 4.933a10 10 0 0 1 0 14.134",key:"ehdyv1"}],["path",{d:"M4.925 19.067a10 10 0 0 1 0-14.134",key:"1q22gi"}],["path",{d:"M7.753 16.239a6 6 0 0 1 0-8.478",key:"r2q7qm"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Pw=$e("radio",Ane);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ene=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M8 7h8",key:"i86dvs"}],["path",{d:"M12 17.5 8 15h1a4 4 0 0 0 0-8",key:"grpkl4"}],["path",{d:"M8 11h8",key:"vwpz6n"}]],Iw=$e("receipt-indian-rupee",Ene);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tne=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]],P_=$e("receipt",Tne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pne=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],_u=$e("refresh-ccw",Pne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ine=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],ry=$e("refresh-cw",Ine);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mne=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Bi=$e("rotate-ccw",Mne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dne=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],L4=$e("save",Dne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const One=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M8 7v10",key:"23sfjj"}],["path",{d:"M12 7v10",key:"jspqdw"}],["path",{d:"M17 7v10",key:"578dap"}]],W0=$e("scan-barcode",One);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rne=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]],t1=$e("scan-line",Rne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lne=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]],ay=$e("scan",Lne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bne=[["path",{d:"M5.42 9.42 8 12",key:"12pkuq"}],["circle",{cx:"4",cy:"8",r:"2",key:"107mxr"}],["path",{d:"m14 6-8.58 8.58",key:"gvzu5l"}],["circle",{cx:"4",cy:"16",r:"2",key:"1ehqvc"}],["path",{d:"M10.8 14.8 14 18",key:"ax7m9r"}],["path",{d:"M16 12h-2",key:"10asgb"}],["path",{d:"M22 12h-2",key:"14jgyd"}]],Mw=$e("scissors-line-dashed",Bne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fne=[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]],z7=$e("scissors",Fne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ne=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],es=$e("search",$ne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zne=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],F3=$e("settings-2",zne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Une=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Vne=$e("settings",Une);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hne=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],Wne=$e("shield-alert",Hne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qne=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],$a=$e("shield-check",qne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gne=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9 12h6",key:"1c52cq"}],["path",{d:"M12 9v6",key:"199k2o"}]],Kne=$e("shield-plus",Gne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yne=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],U7=$e("shield",Yne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xne=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],s1=$e("shopping-cart",Xne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qne=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Zb=$e("sparkles",Qne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zne=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],Es=$e("stethoscope",Zne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jne=[["path",{d:"m18 2 4 4",key:"22kx64"}],["path",{d:"m17 7 3-3",key:"1w1zoj"}],["path",{d:"M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-.6-.6c-1-1-1-2.5 0-3.4L15 5",key:"1exhtz"}],["path",{d:"m9 11 4 4",key:"rovt3i"}],["path",{d:"m5 19-3 3",key:"59f2uf"}],["path",{d:"m14 4 6 6",key:"yqp9t2"}]],B4=$e("syringe",Jne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ere=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Yf=$e("tag",ere);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tre=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],Kp=$e("thermometer",tre);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sre=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],wr=$e("trash-2",sre);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nre=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],rre=$e("trending-up",nre);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const are=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],za=$e("triangle-alert",are);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ire=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],lre=$e("truck",ire);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ore=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],I_=$e("upload",ore);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cre=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],F4=$e("user-plus",cre);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dre=[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]],Yp=$e("user-round",dre);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ure=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Uo=$e("users",ure);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hre=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],rn=$e("user",hre);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mre=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],fre=$e("wind",mre);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pre=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Kn=$e("x",pre);function xre(){var b,v;const t=Xi(),s=Va(),n=cr(w=>w.login),[a,i]=y.useState({tenant_code:((b=t.state)==null?void 0:b.tenant_code)||localStorage.getItem("tenant_code")||localStorage.getItem("pending_tenant_code")||"",email:((v=t.state)==null?void 0:v.email)||localStorage.getItem("pending_email")||"",password:""}),[l,o]=y.useState(""),[c,d]=y.useState(!1),[u,h]=y.useState(!1),f=y.useMemo(()=>a.tenant_code.trim()&&a.email.trim()&&a.password.trim()&&!c,[a,c]),x=async w=>{var _,S;if(w.preventDefault(),!!f){o(""),d(!0);try{await n({tenant_code:a.tenant_code.trim(),email:a.email.trim(),password:a.password}),localStorage.setItem("pending_email",a.email.trim()),localStorage.setItem("pending_tenant_code",a.tenant_code.trim()),s("/auth/verify",{state:{email:a.email.trim(),tenant_code:a.tenant_code.trim()}})}catch(k){o(((S=(_=k==null?void 0:k.response)==null?void 0:_.data)==null?void 0:S.detail)||"Invalid credentials")}finally{d(!1)}}};return r.jsxs("div",{className:"relative min-h-screen overflow-hidden bg-gradient-to-b from-gray-50 to-white",children:[r.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[r.jsx("div",{className:"absolute -left-24 -top-24 h-64 w-64 rounded-full bg-blue-100 blur-3xl animate-pulse"}),r.jsx("div",{className:"absolute -right-24 -bottom-24 h-72 w-72 rounded-full bg-indigo-100 blur-3xl animate-pulse"})]}),r.jsx("div",{className:"relative z-10 grid min-h-screen place-items-center px-4 py-10",children:r.jsxs("div",{className:"w-full max-w-md",children:[r.jsxs("div",{className:"relative overflow-hidden rounded-2xl border border-gray-100 bg-white/80 p-6 shadow-sm backdrop-blur",children:[r.jsx("div",{className:"pointer-events-none absolute -right-12 -top-12 h-32 w-32 rotate-45 bg-gradient-to-br from-blue-50 to-indigo-50"}),r.jsxs("div",{className:"mb-6 flex items-center justify-between gap-3",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-blue-600 text-white ring-8 ring-blue-50",children:r.jsx("span",{className:"text-sm font-bold tracking-tight",children:"NDH"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-semibold tracking-tight",children:"NUTRYAH's HIMS & EMR"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Multi-tenant login with Hospital Code + Email + OTP"})]})]}),r.jsx($a,{className:"h-6 w-6 text-emerald-600"})]}),r.jsxs("form",{onSubmit:x,className:"space-y-4","aria-busy":c,children:[r.jsxs("label",{className:"block",children:[r.jsx("span",{className:"mb-1 block text-sm text-gray-600",children:"Hospital Code"}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-gray-200 bg-white px-3 py-2 focus-within:ring-2 focus-within:ring-blue-200",children:[r.jsx(fa,{className:"h-4 w-4 text-gray-400"}),r.jsx("input",{className:"w-full bg-transparent outline-none placeholder:text-gray-400 uppercase",placeholder:"KGH001",value:a.tenant_code,onChange:w=>i(_=>({..._,tenant_code:w.target.value.toUpperCase()})),required:!0,disabled:c})]}),r.jsx("p",{className:"mt-1 text-[11px] text-gray-500",children:"Hospital / Clinic code assigned by NUTRYAH (Tenant Code)."})]}),r.jsxs("label",{className:"block",children:[r.jsx("span",{className:"mb-1 block text-sm text-gray-600",children:"Email"}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-gray-200 bg-white px-3 py-2 focus-within:ring-2 focus-within:ring-blue-200",children:[r.jsx(dm,{className:"h-4 w-4 text-gray-400"}),r.jsx("input",{className:"w-full bg-transparent outline-none placeholder:text-gray-400",placeholder:"you@hospital.org",type:"email",autoComplete:"email",value:a.email,onChange:w=>i(_=>({..._,email:w.target.value})),required:!0,disabled:c})]})]}),r.jsxs("label",{className:"block",children:[r.jsx("span",{className:"mb-1 block text-sm text-gray-600",children:"Password"}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-gray-200 bg-white px-3 py-2 focus-within:ring-2 focus-within:ring-blue-200",children:[r.jsx(hne,{className:"h-4 w-4 text-gray-400"}),r.jsx("input",{className:"w-full bg-transparent outline-none placeholder:text-gray-400",placeholder:"",type:u?"text":"password",autoComplete:"current-password",value:a.password,onChange:w=>i(_=>({..._,password:w.target.value})),required:!0,disabled:c}),r.jsx("button",{type:"button",onClick:()=>h(w=>!w),className:"rounded-lg p-1.5 text-gray-500 hover:bg-gray-50","aria-label":u?"Hide password":"Show password",tabIndex:-1,disabled:c,children:u?r.jsx(kse,{className:"h-4 w-4"}):r.jsx(up,{className:"h-4 w-4"})})]})]}),r.jsx("button",{className:"inline-flex w-full items-center justify-center gap-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 px-4 py-2.5 text-white shadow-sm transition active:scale-[0.99] disabled:cursor-not-allowed disabled:opacity-60",disabled:!f,type:"submit",children:c?r.jsxs(r.Fragment,{children:[r.jsx(ns,{className:"h-5 w-5 animate-spin"}),r.jsx("span",{children:"Sending OTP"})]}):r.jsx(r.Fragment,{children:"Send OTP"})}),l&&r.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:l}),r.jsx("p",{className:"text-center text-xs text-gray-500",children:"Tip: You'll receive a 6-digit OTP in your email. Keep this tab open."})]}),c&&r.jsx("div",{className:"absolute inset-0 grid place-items-center rounded-2xl bg-white/70 backdrop-blur-sm",children:r.jsxs("div",{className:"w-full max-w-xs rounded-xl border border-gray-100 bg-white p-4 shadow-md",children:[r.jsxs("div",{className:"mb-2 flex items-center gap-2 text-sm text-gray-700",children:[r.jsx(ns,{className:"h-4 w-4 animate-spin text-blue-600"}),"Sending OTP"]}),r.jsx("div",{className:"relative h-2 overflow-hidden rounded-full bg-gray-100",children:r.jsx("div",{className:"absolute inset-y-0 left-0 w-1/3 animate-[progress_1.2s_infinite] rounded-full bg-gradient-to-r from-blue-500 to-indigo-500"})}),r.jsxs("div",{className:"mt-3 flex items-center justify-center gap-1",children:[r.jsx("span",{className:"h-2 w-2 animate-bounce rounded-full bg-blue-500 [animation-delay:-0.2s]"}),r.jsx("span",{className:"h-2 w-2 animate-bounce rounded-full bg-blue-500 [animation-delay:-0.1s]"}),r.jsx("span",{className:"h-2 w-2 animate-bounce rounded-full bg-blue-500"})]})]})})]}),r.jsxs("div",{className:"mx-auto mt-6 text-center text-xs text-gray-500",children:[" ",new Date().getFullYear()," NUTRYAH  Multi-tenant Secure Access"]})]})}),r.jsx("style",{children:`
        @keyframes progress {
          0% { transform: translateX(-120%); }
          100% { transform: translateX(300%); }
        }
      `})]})}function gre(){const[t,s]=y.useState({tenant_name:"",tenant_code:"",hospital_address:"",contact_person:"",contact_phone:"",subscription_plan:"standard",admin_name:"",email:"",password:"",confirm_password:""}),[n,a]=y.useState(!1),[i,l]=y.useState(""),o=cr(h=>h.registerAdmin),c=Va(),d=h=>f=>s(x=>({...x,[h]:f.target.value})),u=async h=>{var f,x;if(h.preventDefault(),!n){if(l(""),t.password!==t.confirm_password){l("Passwords do not match");return}a(!0);try{const b=await o(t),{tenant_code:v}=b.data||{};alert(`Hospital onboarded successfully.
Tenant Code: ${v||t.tenant_code||"Generated"}

Please login with Hospital Code + Admin email.`),c("/auth/login",{replace:!0,state:{email:t.email,tenant_code:v||t.tenant_code}})}catch(b){l(((x=(f=b==null?void 0:b.response)==null?void 0:f.data)==null?void 0:x.detail)||"Failed to register tenant admin")}finally{a(!1)}}};return r.jsxs("div",{className:"relative min-h-screen overflow-hidden bg-gradient-to-b from-slate-50 to-white",children:[r.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[r.jsx("div",{className:"absolute -left-24 -top-24 h-64 w-64 rounded-full bg-blue-100 blur-3xl"}),r.jsx("div",{className:"absolute -right-24 -bottom-24 h-72 w-72 rounded-full bg-indigo-100 blur-3xl"})]}),r.jsx("div",{className:"relative z-10 grid min-h-screen place-items-center px-4 py-8",children:r.jsxs("div",{className:"w-full max-w-2xl",children:[r.jsxs("div",{className:"mb-6 flex items-center justify-center gap-3",children:[r.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-blue-600 text-white ring-8 ring-blue-50",children:r.jsx("span",{className:"text-sm font-bold tracking-tight",children:"NDH"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl font-semibold tracking-tight",children:"Onboard a New Hospital / Clinic"}),r.jsx("p",{className:"text-xs text-slate-500",children:"This will create a dedicated NABH HIMS & EMR tenant with its own database."})]})]}),r.jsxs("form",{onSubmit:u,className:"space-y-5 rounded-2xl border border-slate-200 bg-white/80 p-6 shadow-sm backdrop-blur",children:[r.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"mb-1 block text-sm text-slate-700",children:"Hospital / Clinic Name"}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 focus-within:ring-2 focus-within:ring-blue-200",children:[r.jsx(fa,{className:"h-4 w-4 text-slate-400"}),r.jsx("input",{className:"w-full bg-transparent outline-none placeholder:text-slate-400",placeholder:"Kovai Multispeciality Hospital",value:t.tenant_name,onChange:d("tenant_name"),required:!0})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-sm text-slate-700",children:"Hospital Code (Tenant Code)"}),r.jsx("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none placeholder:text-slate-400 focus:ring-2 focus:ring-blue-200",placeholder:"KGH001",value:t.tenant_code,onChange:h=>s(f=>({...f,tenant_code:h.target.value.toUpperCase()}))}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Optional. If empty, the system will generate a code from the name."})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-sm text-slate-700",children:"Contact Person"}),r.jsx("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none placeholder:text-slate-400 focus:ring-2 focus:ring-blue-200",placeholder:"Dr. Admin / IT Head",value:t.contact_person,onChange:d("contact_person"),required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-sm text-slate-700",children:"Contact Phone"}),r.jsx("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none placeholder:text-slate-400 focus:ring-2 focus:ring-blue-200",placeholder:"+91 9XXXXXXXXX",value:t.contact_phone,onChange:d("contact_phone")})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"mb-1 block text-sm text-slate-700",children:"Hospital Address"}),r.jsx("textarea",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none placeholder:text-slate-400 focus:ring-2 focus:ring-blue-200",placeholder:"Address, City, State, Pincode",rows:2,value:t.hospital_address,onChange:d("hospital_address")})]})]}),r.jsxs("div",{className:"space-y-3 rounded-2xl border border-slate-100 bg-slate-50/70 p-4",children:[r.jsxs("div",{className:"mb-1 flex items-center gap-2 text-sm font-medium text-slate-800",children:[r.jsx(Gp,{className:"h-4 w-4 text-blue-600"}),"Subscription & License Period"]}),r.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-sm text-slate-700",children:"Subscription Plan"}),r.jsxs("select",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-blue-200",value:t.subscription_plan,onChange:d("subscription_plan"),children:[r.jsx("option",{value:"basic",children:"Basic (Monthly)"}),r.jsx("option",{value:"standard",children:"Standard (6 Months)"}),r.jsx("option",{value:"premium",children:"Premium (1 Year)"})]})]}),r.jsxs("div",{className:"text-xs text-slate-600 space-y-1",children:[r.jsx("p",{className:"font-medium text-slate-700",children:"License Duration (auto-calculated):"}),r.jsxs("ul",{className:"list-disc pl-4 space-y-0.5",children:[r.jsx("li",{children:"Basic  30 days from registration"}),r.jsx("li",{children:"Standard  6 months from registration"}),r.jsx("li",{children:"Premium  1 year from registration"})]}),r.jsx("p",{className:"pt-1 text-[11px] text-slate-500",children:"AMC, subscription amount, and renewals are configured by NUTRYAH admin in the master console. They are not editable from this screen."})]})]})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-slate-50/80 p-4",children:[r.jsxs("div",{className:"mb-3 flex items-center gap-2 text-sm font-medium text-slate-800",children:[r.jsx(Kne,{className:"h-4 w-4 text-blue-600"}),"Admin Login for this Tenant"]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs text-slate-600",children:"Admin Name"}),r.jsx("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none placeholder:text-slate-400 focus:ring-2 focus:ring-blue-200",placeholder:"Super Admin",value:t.admin_name,onChange:d("admin_name"),required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs text-slate-600",children:"Admin Email"}),r.jsx("input",{type:"email",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none placeholder:text-slate-400 focus:ring-2 focus:ring-blue-200",placeholder:"admin@hospital.org",value:t.email,onChange:d("email"),required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs text-slate-600",children:"Password"}),r.jsx("input",{type:"password",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-blue-200",value:t.password,onChange:d("password"),required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs text-slate-600",children:"Confirm Password"}),r.jsx("input",{type:"password",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-blue-200",value:t.confirm_password,onChange:d("confirm_password"),required:!0})]})]})]}),i&&r.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:i}),r.jsx("button",{type:"submit",disabled:n,className:"inline-flex w-full items-center justify-center gap-2 rounded-xl bg-slate-900 px-4 py-2.5 text-sm font-medium text-white shadow-sm transition active:scale-[0.99] disabled:cursor-not-allowed disabled:opacity-60",children:n?r.jsxs(r.Fragment,{children:[r.jsx(ns,{className:"h-4 w-4 animate-spin"}),"Creating Tenant"]}):"Create Tenant & Admin"}),r.jsx("p",{className:"text-center text-[11px] text-slate-500",children:"After this step, use the Hospital Code + Admin Email to login and access the dedicated HIMS database."})]})]})})]})}function yre(){var M,B;const t=Xi(),s=Va(),n=cr(L=>L.verifyOtp),a=cr(L=>L.fetchProfile),[i]=y.useState(((M=t.state)==null?void 0:M.email)||localStorage.getItem("pending_email")||""),[l]=y.useState(((B=t.state)==null?void 0:B.tenant_code)||localStorage.getItem("pending_tenant_code")||localStorage.getItem("tenant_code")||""),[o,c]=y.useState(["","","","","",""]),[d,u]=y.useState(""),[h,f]=y.useState(!1),[x,b]=y.useState(60),[v,w]=y.useState(!1),_=y.useRef([]);y.useEffect(()=>{(!i||!l)&&s("/auth/login",{replace:!0})},[i,l,s]),y.useEffect(()=>{if(x<=0)return;const L=setInterval(()=>b(F=>F-1),1e3);return()=>clearInterval(L)},[x]);const S=y.useMemo(()=>o.join(""),[o]),k=S.length===6&&!o.includes("")&&!h,A=(L,F)=>{var $;const V=(F||"").replace(/\D/g,"").slice(-1);c(z=>{const H=[...z];return H[L]=V,H}),V&&L<5&&(($=_.current[L+1])==null||$.focus())},T=(L,F)=>{var V,$,z;F.key==="Backspace"?o[L]?c(H=>{const q=[...H];return q[L]="",q}):L>0&&((V=_.current[L-1])==null||V.focus(),c(H=>{const q=[...H];return q[L-1]="",q})):F.key==="ArrowLeft"&&L>0?($=_.current[L-1])==null||$.focus():F.key==="ArrowRight"&&L<5&&((z=_.current[L+1])==null||z.focus())},P=L=>{var $;L.preventDefault();const F=(L.clipboardData.getData("text")||"").replace(/\D/g,"").slice(0,6);if(!F)return;const V=F.split("");c([V[0]||"",V[1]||"",V[2]||"",V[3]||"",V[4]||"",V[5]||""]),($=_.current[Math.min(F.length,5)])==null||$.focus()},O=async L=>{var F,V;if(L.preventDefault(),!!k){u(""),f(!0);try{await n({tenant_code:l,email:i,otp:S}),await a(),w(!0),setTimeout(()=>{const $=cr.getState().user;$!=null&&$.is_admin?s("/admin",{replace:!0}):s("/dashboard",{replace:!0})},400)}catch($){u(((V=(F=$==null?void 0:$.response)==null?void 0:F.data)==null?void 0:V.detail)||"Invalid or expired OTP")}finally{f(!1)}}},D=()=>{s("/auth/login",{state:{email:i,tenant_code:l},replace:!0})},I=()=>{D()};return r.jsxs("div",{className:"relative min-h-screen overflow-hidden bg-gradient-to-b from-gray-50 to-white",children:[r.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[r.jsx("div",{className:"absolute -left-24 -top-24 h-64 w-64 rounded-full bg-blue-100 blur-3xl animate-pulse"}),r.jsx("div",{className:"absolute -right-24 -bottom-24 h-72 w-72 rounded-full bg-indigo-100 blur-3xl animate-pulse"})]}),r.jsx("div",{className:"relative z-10 grid min-h-screen place-items-center px-4 py-8",children:r.jsxs("div",{className:"w-full max-w-md",children:[r.jsxs("div",{className:"relative overflow-hidden rounded-2xl border border-gray-100 bg-white/80 p-6 shadow-sm backdrop-blur",children:[r.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-blue-600 text-white ring-8 ring-blue-50",children:r.jsx("span",{className:"text-sm font-bold",children:"NDH"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-semibold tracking-tight",children:"Verify OTP"}),r.jsx("p",{className:"text-xs text-gray-500",children:"We sent a 6-digit code to your email"})]})]}),r.jsx($a,{className:"h-6 w-6 text-emerald-600"})]}),r.jsxs("div",{className:"mb-4 space-y-2 text-sm",children:[r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-gray-100 bg-gray-50 px-3 py-2 text-gray-700",children:[r.jsx(dm,{className:"h-4 w-4 text-gray-400"}),r.jsx("span",{className:"truncate",children:i}),r.jsx("button",{type:"button",onClick:D,className:"ml-auto text-xs text-blue-700 underline-offset-2 hover:underline",children:"Change"})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-gray-100 bg-gray-50 px-3 py-2 text-gray-700",children:[r.jsx(fa,{className:"h-4 w-4 text-gray-400"}),r.jsxs("span",{className:"text-xs font-medium uppercase",children:["Hospital Code: ",l]})]})]}),r.jsxs("form",{onSubmit:O,className:"space-y-4",children:[r.jsx("div",{className:"grid grid-cols-6 gap-2 sm:gap-3",onPaste:P,children:o.map((L,F)=>r.jsx("input",{ref:V=>_.current[F]=V,value:L,inputMode:"numeric",pattern:"[0-9]*",maxLength:1,autoFocus:F===0,onChange:V=>A(F,V.target.value),onKeyDown:V=>T(F,V),className:`h-12 rounded-xl border border-gray-200 text-center text-lg tracking-[0.2em] outline-none transition\r
                               focus:border-blue-400 focus:ring-2 focus:ring-blue-200 sm:h-14`,"aria-label":`OTP digit ${F+1}`},F))}),r.jsx("button",{className:"inline-flex w-full items-center justify-center gap-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 px-4 py-2.5 text-white shadow-sm transition active:scale-[0.99] disabled:cursor-not-allowed disabled:opacity-60",disabled:!k,type:"submit",children:h?r.jsxs(r.Fragment,{children:[r.jsx(ns,{className:"h-5 w-5 animate-spin"}),"Verifying"]}):v?r.jsxs(r.Fragment,{children:[r.jsx(Dn,{className:"h-5 w-5"}),"Verified"]}):"Verify & Continue"}),r.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600",children:[r.jsxs("button",{type:"button",onClick:D,className:"inline-flex items-center gap-1 rounded-lg px-2 py-1 hover:bg-gray-50",children:[r.jsx(Qb,{className:"h-3.5 w-3.5"}),"Back to login"]}),r.jsx("div",{className:"flex items-center gap-2",children:x>0?r.jsxs("span",{className:"rounded-lg bg-gray-50 px-2 py-1 tabular-nums",children:["Resend in ",x,"s"]}):r.jsx("button",{type:"button",onClick:I,className:"rounded-lg bg-gray-900 px-2 py-1 text-white hover:bg-gray-800",children:"Resend OTP"})})]}),d&&r.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",role:"alert","aria-live":"polite",children:d})]}),h&&r.jsx("div",{className:"absolute inset-0 grid place-items-center rounded-2xl bg-white/70 backdrop-blur-sm",children:r.jsxs("div",{className:"w-full max-w-xs rounded-xl border border-gray-100 bg-white p-4 shadow-md",children:[r.jsxs("div",{className:"mb-2 flex items-center gap-2 text-sm text-gray-700",children:[r.jsx(ns,{className:"h-4 w-4 animate-spin text-blue-600"}),"Verifying"]}),r.jsx("div",{className:"relative h-2 overflow-hidden rounded-full bg-gray-100",children:r.jsx("div",{className:"absolute inset-y-0 left-0 w-1/3 animate-[progress_1.1s_infinite_linear] rounded-full bg-gradient-to-r from-blue-500 to-indigo-500"})})]})})]}),r.jsx("div",{className:"mx-auto mt-6 text-center text-xs text-gray-500",children:"Didnt receive the mail? Check Spam/Junk folder."})]})}),r.jsx("style",{children:`
        @keyframes progress {
          0% { transform: translateX(-120%); }
          100% { transform: translateX(300%); }
        }
      `})]})}const $3=y.createContext({});function z3(t){const s=y.useRef(null);return s.current===null&&(s.current=t()),s.current}const U3=typeof window<"u",V7=U3?y.useLayoutEffect:y.useEffect,Jb=y.createContext(null);function V3(t,s){t.indexOf(s)===-1&&t.push(s)}function H3(t,s){const n=t.indexOf(s);n>-1&&t.splice(n,1)}const Vo=(t,s,n)=>n>s?s:n<t?t:n;let W3=()=>{};const Ho={},H7=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function W7(t){return typeof t=="object"&&t!==null}const q7=t=>/^0[^.\s]+$/u.test(t);function q3(t){let s;return()=>(s===void 0&&(s=t()),s)}const Fi=t=>t,bre=(t,s)=>n=>s(t(n)),Vx=(...t)=>t.reduce(bre),Xp=(t,s,n)=>{const a=s-t;return a===0?1:(n-t)/a};class G3{constructor(){this.subscriptions=[]}add(s){return V3(this.subscriptions,s),()=>H3(this.subscriptions,s)}notify(s,n,a){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](s,n,a);else for(let l=0;l<i;l++){const o=this.subscriptions[l];o&&o(s,n,a)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const so=t=>t*1e3,Di=t=>t/1e3;function G7(t,s){return s?t*(1e3/s):0}const K7=(t,s,n)=>(((1-3*n+3*s)*t+(3*n-6*s))*t+3*s)*t,vre=1e-7,Nre=12;function wre(t,s,n,a,i){let l,o,c=0;do o=s+(n-s)/2,l=K7(o,a,i)-t,l>0?n=o:s=o;while(Math.abs(l)>vre&&++c<Nre);return o}function Hx(t,s,n,a){if(t===s&&n===a)return Fi;const i=l=>wre(l,0,1,t,n);return l=>l===0||l===1?l:K7(i(l),s,a)}const Y7=t=>s=>s<=.5?t(2*s)/2:(2-t(2*(1-s)))/2,X7=t=>s=>1-t(1-s),Q7=Hx(.33,1.53,.69,.99),K3=X7(Q7),Z7=Y7(K3),J7=t=>(t*=2)<1?.5*K3(t):.5*(2-Math.pow(2,-10*(t-1))),Y3=t=>1-Math.sin(Math.acos(t)),e9=X7(Y3),t9=Y7(Y3),jre=Hx(.42,0,1,1),_re=Hx(0,0,.58,1),s9=Hx(.42,0,.58,1),Sre=t=>Array.isArray(t)&&typeof t[0]!="number",n9=t=>Array.isArray(t)&&typeof t[0]=="number",Cre={linear:Fi,easeIn:jre,easeInOut:s9,easeOut:_re,circIn:Y3,circInOut:t9,circOut:e9,backIn:K3,backInOut:Z7,backOut:Q7,anticipate:J7},kre=t=>typeof t=="string",$4=t=>{if(n9(t)){W3(t.length===4);const[s,n,a,i]=t;return Hx(s,n,a,i)}else if(kre(t))return Cre[t];return t},q0=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function Are(t,s){let n=new Set,a=new Set,i=!1,l=!1;const o=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1};function d(h){o.has(h)&&(u.schedule(h),t()),h(c)}const u={schedule:(h,f=!1,x=!1)=>{const v=x&&i?n:a;return f&&o.add(h),v.has(h)||v.add(h),h},cancel:h=>{a.delete(h),o.delete(h)},process:h=>{if(c=h,i){l=!0;return}i=!0,[n,a]=[a,n],n.forEach(d),n.clear(),i=!1,l&&(l=!1,u.process(h))}};return u}const Ere=40;function r9(t,s){let n=!1,a=!0;const i={delta:0,timestamp:0,isProcessing:!1},l=()=>n=!0,o=q0.reduce((A,T)=>(A[T]=Are(l),A),{}),{setup:c,read:d,resolveKeyframes:u,preUpdate:h,update:f,preRender:x,render:b,postRender:v}=o,w=()=>{const A=Ho.useManualTiming?i.timestamp:performance.now();n=!1,Ho.useManualTiming||(i.delta=a?1e3/60:Math.max(Math.min(A-i.timestamp,Ere),1)),i.timestamp=A,i.isProcessing=!0,c.process(i),d.process(i),u.process(i),h.process(i),f.process(i),x.process(i),b.process(i),v.process(i),i.isProcessing=!1,n&&s&&(a=!1,t(w))},_=()=>{n=!0,a=!0,i.isProcessing||t(w)};return{schedule:q0.reduce((A,T)=>{const P=o[T];return A[T]=(O,D=!1,I=!1)=>(n||_(),P.schedule(O,D,I)),A},{}),cancel:A=>{for(let T=0;T<q0.length;T++)o[q0[T]].cancel(A)},state:i,steps:o}}const{schedule:tn,cancel:rd,state:Dr,steps:Dw}=r9(typeof requestAnimationFrame<"u"?requestAnimationFrame:Fi,!0);let iy;function Tre(){iy=void 0}const Ta={now:()=>(iy===void 0&&Ta.set(Dr.isProcessing||Ho.useManualTiming?Dr.timestamp:performance.now()),iy),set:t=>{iy=t,queueMicrotask(Tre)}},a9=t=>s=>typeof s=="string"&&s.startsWith(t),X3=a9("--"),Pre=a9("var(--"),Q3=t=>Pre(t)?Ire.test(t.split("/*")[0].trim()):!1,Ire=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Rm={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Qp={...Rm,transform:t=>Vo(0,1,t)},G0={...Rm,default:1},hp=t=>Math.round(t*1e5)/1e5,Z3=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Mre(t){return t==null}const Dre=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,J3=(t,s)=>n=>!!(typeof n=="string"&&Dre.test(n)&&n.startsWith(t)||s&&!Mre(n)&&Object.prototype.hasOwnProperty.call(n,s)),i9=(t,s,n)=>a=>{if(typeof a!="string")return a;const[i,l,o,c]=a.match(Z3);return{[t]:parseFloat(i),[s]:parseFloat(l),[n]:parseFloat(o),alpha:c!==void 0?parseFloat(c):1}},Ore=t=>Vo(0,255,t),Ow={...Rm,transform:t=>Math.round(Ore(t))},Xd={test:J3("rgb","red"),parse:i9("red","green","blue"),transform:({red:t,green:s,blue:n,alpha:a=1})=>"rgba("+Ow.transform(t)+", "+Ow.transform(s)+", "+Ow.transform(n)+", "+hp(Qp.transform(a))+")"};function Rre(t){let s="",n="",a="",i="";return t.length>5?(s=t.substring(1,3),n=t.substring(3,5),a=t.substring(5,7),i=t.substring(7,9)):(s=t.substring(1,2),n=t.substring(2,3),a=t.substring(3,4),i=t.substring(4,5),s+=s,n+=n,a+=a,i+=i),{red:parseInt(s,16),green:parseInt(n,16),blue:parseInt(a,16),alpha:i?parseInt(i,16)/255:1}}const M_={test:J3("#"),parse:Rre,transform:Xd.transform},Wx=t=>({test:s=>typeof s=="string"&&s.endsWith(t)&&s.split(" ").length===1,parse:parseFloat,transform:s=>`${s}${t}`}),vc=Wx("deg"),no=Wx("%"),Vt=Wx("px"),Lre=Wx("vh"),Bre=Wx("vw"),z4={...no,parse:t=>no.parse(t)/100,transform:t=>no.transform(t*100)},Ph={test:J3("hsl","hue"),parse:i9("hue","saturation","lightness"),transform:({hue:t,saturation:s,lightness:n,alpha:a=1})=>"hsla("+Math.round(t)+", "+no.transform(hp(s))+", "+no.transform(hp(n))+", "+hp(Qp.transform(a))+")"},Vn={test:t=>Xd.test(t)||M_.test(t)||Ph.test(t),parse:t=>Xd.test(t)?Xd.parse(t):Ph.test(t)?Ph.parse(t):M_.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Xd.transform(t):Ph.transform(t),getAnimatableNone:t=>{const s=Vn.parse(t);return s.alpha=0,Vn.transform(s)}},Fre=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function $re(t){var s,n;return isNaN(t)&&typeof t=="string"&&(((s=t.match(Z3))==null?void 0:s.length)||0)+(((n=t.match(Fre))==null?void 0:n.length)||0)>0}const l9="number",o9="color",zre="var",Ure="var(",U4="${}",Vre=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Zp(t){const s=t.toString(),n=[],a={color:[],number:[],var:[]},i=[];let l=0;const c=s.replace(Vre,d=>(Vn.test(d)?(a.color.push(l),i.push(o9),n.push(Vn.parse(d))):d.startsWith(Ure)?(a.var.push(l),i.push(zre),n.push(d)):(a.number.push(l),i.push(l9),n.push(parseFloat(d))),++l,U4)).split(U4);return{values:n,split:c,indexes:a,types:i}}function c9(t){return Zp(t).values}function d9(t){const{split:s,types:n}=Zp(t),a=s.length;return i=>{let l="";for(let o=0;o<a;o++)if(l+=s[o],i[o]!==void 0){const c=n[o];c===l9?l+=hp(i[o]):c===o9?l+=Vn.transform(i[o]):l+=i[o]}return l}}const Hre=t=>typeof t=="number"?0:Vn.test(t)?Vn.getAnimatableNone(t):t;function Wre(t){const s=c9(t);return d9(t)(s.map(Hre))}const ad={test:$re,parse:c9,createTransformer:d9,getAnimatableNone:Wre};function Rw(t,s,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(s-t)*6*n:n<1/2?s:n<2/3?t+(s-t)*(2/3-n)*6:t}function qre({hue:t,saturation:s,lightness:n,alpha:a}){t/=360,s/=100,n/=100;let i=0,l=0,o=0;if(!s)i=l=o=n;else{const c=n<.5?n*(1+s):n+s-n*s,d=2*n-c;i=Rw(d,c,t+1/3),l=Rw(d,c,t),o=Rw(d,c,t-1/3)}return{red:Math.round(i*255),green:Math.round(l*255),blue:Math.round(o*255),alpha:a}}function n1(t,s){return n=>n>0?s:t}const hn=(t,s,n)=>t+(s-t)*n,Lw=(t,s,n)=>{const a=t*t,i=n*(s*s-a)+a;return i<0?0:Math.sqrt(i)},Gre=[M_,Xd,Ph],Kre=t=>Gre.find(s=>s.test(t));function V4(t){const s=Kre(t);if(!s)return!1;let n=s.parse(t);return s===Ph&&(n=qre(n)),n}const H4=(t,s)=>{const n=V4(t),a=V4(s);if(!n||!a)return n1(t,s);const i={...n};return l=>(i.red=Lw(n.red,a.red,l),i.green=Lw(n.green,a.green,l),i.blue=Lw(n.blue,a.blue,l),i.alpha=hn(n.alpha,a.alpha,l),Xd.transform(i))},D_=new Set(["none","hidden"]);function Yre(t,s){return D_.has(t)?n=>n<=0?t:s:n=>n>=1?s:t}function Xre(t,s){return n=>hn(t,s,n)}function ek(t){return typeof t=="number"?Xre:typeof t=="string"?Q3(t)?n1:Vn.test(t)?H4:Jre:Array.isArray(t)?u9:typeof t=="object"?Vn.test(t)?H4:Qre:n1}function u9(t,s){const n=[...t],a=n.length,i=t.map((l,o)=>ek(l)(l,s[o]));return l=>{for(let o=0;o<a;o++)n[o]=i[o](l);return n}}function Qre(t,s){const n={...t,...s},a={};for(const i in n)t[i]!==void 0&&s[i]!==void 0&&(a[i]=ek(t[i])(t[i],s[i]));return i=>{for(const l in a)n[l]=a[l](i);return n}}function Zre(t,s){const n=[],a={color:0,var:0,number:0};for(let i=0;i<s.values.length;i++){const l=s.types[i],o=t.indexes[l][a[l]],c=t.values[o]??0;n[i]=c,a[l]++}return n}const Jre=(t,s)=>{const n=ad.createTransformer(s),a=Zp(t),i=Zp(s);return a.indexes.var.length===i.indexes.var.length&&a.indexes.color.length===i.indexes.color.length&&a.indexes.number.length>=i.indexes.number.length?D_.has(t)&&!i.values.length||D_.has(s)&&!a.values.length?Yre(t,s):Vx(u9(Zre(a,i),i.values),n):n1(t,s)};function h9(t,s,n){return typeof t=="number"&&typeof s=="number"&&typeof n=="number"?hn(t,s,n):ek(t)(t,s)}const eae=t=>{const s=({timestamp:n})=>t(n);return{start:(n=!0)=>tn.update(s,n),stop:()=>rd(s),now:()=>Dr.isProcessing?Dr.timestamp:Ta.now()}},m9=(t,s,n=10)=>{let a="";const i=Math.max(Math.round(s/n),2);for(let l=0;l<i;l++)a+=Math.round(t(l/(i-1))*1e4)/1e4+", ";return`linear(${a.substring(0,a.length-2)})`},r1=2e4;function tk(t){let s=0;const n=50;let a=t.next(s);for(;!a.done&&s<r1;)s+=n,a=t.next(s);return s>=r1?1/0:s}function tae(t,s=100,n){const a=n({...t,keyframes:[0,s]}),i=Math.min(tk(a),r1);return{type:"keyframes",ease:l=>a.next(i*l).value/s,duration:Di(i)}}const sae=5;function f9(t,s,n){const a=Math.max(s-sae,0);return G7(n-t(a),s-a)}const wn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Bw=.001;function nae({duration:t=wn.duration,bounce:s=wn.bounce,velocity:n=wn.velocity,mass:a=wn.mass}){let i,l,o=1-s;o=Vo(wn.minDamping,wn.maxDamping,o),t=Vo(wn.minDuration,wn.maxDuration,Di(t)),o<1?(i=u=>{const h=u*o,f=h*t,x=h-n,b=O_(u,o),v=Math.exp(-f);return Bw-x/b*v},l=u=>{const f=u*o*t,x=f*n+n,b=Math.pow(o,2)*Math.pow(u,2)*t,v=Math.exp(-f),w=O_(Math.pow(u,2),o);return(-i(u)+Bw>0?-1:1)*((x-b)*v)/w}):(i=u=>{const h=Math.exp(-u*t),f=(u-n)*t+1;return-Bw+h*f},l=u=>{const h=Math.exp(-u*t),f=(n-u)*(t*t);return h*f});const c=5/t,d=aae(i,l,c);if(t=so(t),isNaN(d))return{stiffness:wn.stiffness,damping:wn.damping,duration:t};{const u=Math.pow(d,2)*a;return{stiffness:u,damping:o*2*Math.sqrt(a*u),duration:t}}}const rae=12;function aae(t,s,n){let a=n;for(let i=1;i<rae;i++)a=a-t(a)/s(a);return a}function O_(t,s){return t*Math.sqrt(1-s*s)}const iae=["duration","bounce"],lae=["stiffness","damping","mass"];function W4(t,s){return s.some(n=>t[n]!==void 0)}function oae(t){let s={velocity:wn.velocity,stiffness:wn.stiffness,damping:wn.damping,mass:wn.mass,isResolvedFromDuration:!1,...t};if(!W4(t,lae)&&W4(t,iae))if(t.visualDuration){const n=t.visualDuration,a=2*Math.PI/(n*1.2),i=a*a,l=2*Vo(.05,1,1-(t.bounce||0))*Math.sqrt(i);s={...s,mass:wn.mass,stiffness:i,damping:l}}else{const n=nae(t);s={...s,...n,mass:wn.mass},s.isResolvedFromDuration=!0}return s}function a1(t=wn.visualDuration,s=wn.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:s}:t;let{restSpeed:a,restDelta:i}=n;const l=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],c={done:!1,value:l},{stiffness:d,damping:u,mass:h,duration:f,velocity:x,isResolvedFromDuration:b}=oae({...n,velocity:-Di(n.velocity||0)}),v=x||0,w=u/(2*Math.sqrt(d*h)),_=o-l,S=Di(Math.sqrt(d/h)),k=Math.abs(_)<5;a||(a=k?wn.restSpeed.granular:wn.restSpeed.default),i||(i=k?wn.restDelta.granular:wn.restDelta.default);let A;if(w<1){const P=O_(S,w);A=O=>{const D=Math.exp(-w*S*O);return o-D*((v+w*S*_)/P*Math.sin(P*O)+_*Math.cos(P*O))}}else if(w===1)A=P=>o-Math.exp(-S*P)*(_+(v+S*_)*P);else{const P=S*Math.sqrt(w*w-1);A=O=>{const D=Math.exp(-w*S*O),I=Math.min(P*O,300);return o-D*((v+w*S*_)*Math.sinh(I)+P*_*Math.cosh(I))/P}}const T={calculatedDuration:b&&f||null,next:P=>{const O=A(P);if(b)c.done=P>=f;else{let D=P===0?v:0;w<1&&(D=P===0?so(v):f9(A,P,O));const I=Math.abs(D)<=a,M=Math.abs(o-O)<=i;c.done=I&&M}return c.value=c.done?o:O,c},toString:()=>{const P=Math.min(tk(T),r1),O=m9(D=>T.next(P*D).value,P,30);return P+"ms "+O},toTransition:()=>{}};return T}a1.applyToOptions=t=>{const s=tae(t,100,a1);return t.ease=s.ease,t.duration=so(s.duration),t.type="keyframes",t};function R_({keyframes:t,velocity:s=0,power:n=.8,timeConstant:a=325,bounceDamping:i=10,bounceStiffness:l=500,modifyTarget:o,min:c,max:d,restDelta:u=.5,restSpeed:h}){const f=t[0],x={done:!1,value:f},b=I=>c!==void 0&&I<c||d!==void 0&&I>d,v=I=>c===void 0?d:d===void 0||Math.abs(c-I)<Math.abs(d-I)?c:d;let w=n*s;const _=f+w,S=o===void 0?_:o(_);S!==_&&(w=S-f);const k=I=>-w*Math.exp(-I/a),A=I=>S+k(I),T=I=>{const M=k(I),B=A(I);x.done=Math.abs(M)<=u,x.value=x.done?S:B};let P,O;const D=I=>{b(x.value)&&(P=I,O=a1({keyframes:[x.value,v(x.value)],velocity:f9(A,I,x.value),damping:i,stiffness:l,restDelta:u,restSpeed:h}))};return D(0),{calculatedDuration:null,next:I=>{let M=!1;return!O&&P===void 0&&(M=!0,T(I),D(I)),P!==void 0&&I>=P?O.next(I-P):(!M&&T(I),x)}}}function cae(t,s,n){const a=[],i=n||Ho.mix||h9,l=t.length-1;for(let o=0;o<l;o++){let c=i(t[o],t[o+1]);if(s){const d=Array.isArray(s)?s[o]||Fi:s;c=Vx(d,c)}a.push(c)}return a}function dae(t,s,{clamp:n=!0,ease:a,mixer:i}={}){const l=t.length;if(W3(l===s.length),l===1)return()=>s[0];if(l===2&&s[0]===s[1])return()=>s[1];const o=t[0]===t[1];t[0]>t[l-1]&&(t=[...t].reverse(),s=[...s].reverse());const c=cae(s,a,i),d=c.length,u=h=>{if(o&&h<t[0])return s[0];let f=0;if(d>1)for(;f<t.length-2&&!(h<t[f+1]);f++);const x=Xp(t[f],t[f+1],h);return c[f](x)};return n?h=>u(Vo(t[0],t[l-1],h)):u}function uae(t,s){const n=t[t.length-1];for(let a=1;a<=s;a++){const i=Xp(0,s,a);t.push(hn(n,1,i))}}function hae(t){const s=[0];return uae(s,t.length-1),s}function mae(t,s){return t.map(n=>n*s)}function fae(t,s){return t.map(()=>s||s9).splice(0,t.length-1)}function mp({duration:t=300,keyframes:s,times:n,ease:a="easeInOut"}){const i=Sre(a)?a.map($4):$4(a),l={done:!1,value:s[0]},o=mae(n&&n.length===s.length?n:hae(s),t),c=dae(o,s,{ease:Array.isArray(i)?i:fae(s,i)});return{calculatedDuration:t,next:d=>(l.value=c(d),l.done=d>=t,l)}}const pae=t=>t!==null;function sk(t,{repeat:s,repeatType:n="loop"},a,i=1){const l=t.filter(pae),c=i<0||s&&n!=="loop"&&s%2===1?0:l.length-1;return!c||a===void 0?l[c]:a}const xae={decay:R_,inertia:R_,tween:mp,keyframes:mp,spring:a1};function p9(t){typeof t.type=="string"&&(t.type=xae[t.type])}class nk{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(s=>{this.resolve=s})}notifyFinished(){this.resolve()}then(s,n){return this.finished.then(s,n)}}const gae=t=>t/100;class rk extends nk{constructor(s){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var a,i;const{motionValue:n}=this.options;n&&n.updatedAt!==Ta.now()&&this.tick(Ta.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(i=(a=this.options).onStop)==null||i.call(a))},this.options=s,this.initAnimation(),this.play(),s.autoplay===!1&&this.pause()}initAnimation(){const{options:s}=this;p9(s);const{type:n=mp,repeat:a=0,repeatDelay:i=0,repeatType:l,velocity:o=0}=s;let{keyframes:c}=s;const d=n||mp;d!==mp&&typeof c[0]!="number"&&(this.mixKeyframes=Vx(gae,h9(c[0],c[1])),c=[0,100]);const u=d({...s,keyframes:c});l==="mirror"&&(this.mirroredGenerator=d({...s,keyframes:[...c].reverse(),velocity:-o})),u.calculatedDuration===null&&(u.calculatedDuration=tk(u));const{calculatedDuration:h}=u;this.calculatedDuration=h,this.resolvedDuration=h+i,this.totalDuration=this.resolvedDuration*(a+1)-i,this.generator=u}updateTime(s){const n=Math.round(s-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(s,n=!1){const{generator:a,totalDuration:i,mixKeyframes:l,mirroredGenerator:o,resolvedDuration:c,calculatedDuration:d}=this;if(this.startTime===null)return a.next(0);const{delay:u=0,keyframes:h,repeat:f,repeatType:x,repeatDelay:b,type:v,onUpdate:w,finalKeyframe:_}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,s):this.speed<0&&(this.startTime=Math.min(s-i/this.speed,this.startTime)),n?this.currentTime=s:this.updateTime(s);const S=this.currentTime-u*(this.playbackSpeed>=0?1:-1),k=this.playbackSpeed>=0?S<0:S>i;this.currentTime=Math.max(S,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let A=this.currentTime,T=a;if(f){const I=Math.min(this.currentTime,i)/c;let M=Math.floor(I),B=I%1;!B&&I>=1&&(B=1),B===1&&M--,M=Math.min(M,f+1),!!(M%2)&&(x==="reverse"?(B=1-B,b&&(B-=b/c)):x==="mirror"&&(T=o)),A=Vo(0,1,B)*c}const P=k?{done:!1,value:h[0]}:T.next(A);l&&(P.value=l(P.value));let{done:O}=P;!k&&d!==null&&(O=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const D=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&O);return D&&v!==R_&&(P.value=sk(h,this.options,_,this.speed)),w&&w(P.value),D&&this.finish(),P}then(s,n){return this.finished.then(s,n)}get duration(){return Di(this.calculatedDuration)}get iterationDuration(){const{delay:s=0}=this.options||{};return this.duration+Di(s)}get time(){return Di(this.currentTime)}set time(s){var n;s=so(s),this.currentTime=s,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=s:this.driver&&(this.startTime=this.driver.now()-s/this.playbackSpeed),(n=this.driver)==null||n.start(!1)}get speed(){return this.playbackSpeed}set speed(s){this.updateTime(Ta.now());const n=this.playbackSpeed!==s;this.playbackSpeed=s,n&&(this.time=Di(this.currentTime))}play(){var i,l;if(this.isStopped)return;const{driver:s=eae,startTime:n}=this.options;this.driver||(this.driver=s(o=>this.tick(o))),(l=(i=this.options).onPlay)==null||l.call(i);const a=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=a):this.holdTime!==null?this.startTime=a-this.holdTime:this.startTime||(this.startTime=n??a),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Ta.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var s,n;this.notifyFinished(),this.teardown(),this.state="finished",(n=(s=this.options).onComplete)==null||n.call(s)}cancel(){var s,n;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(n=(s=this.options).onCancel)==null||n.call(s)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(s){return this.startTime=0,this.tick(s,!0)}attachTimeline(s){var n;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(n=this.driver)==null||n.stop(),s.observe(this)}}function yae(t){for(let s=1;s<t.length;s++)t[s]??(t[s]=t[s-1])}const Qd=t=>t*180/Math.PI,L_=t=>{const s=Qd(Math.atan2(t[1],t[0]));return B_(s)},bae={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:L_,rotateZ:L_,skewX:t=>Qd(Math.atan(t[1])),skewY:t=>Qd(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},B_=t=>(t=t%360,t<0&&(t+=360),t),q4=L_,G4=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),K4=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),vae={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:G4,scaleY:K4,scale:t=>(G4(t)+K4(t))/2,rotateX:t=>B_(Qd(Math.atan2(t[6],t[5]))),rotateY:t=>B_(Qd(Math.atan2(-t[2],t[0]))),rotateZ:q4,rotate:q4,skewX:t=>Qd(Math.atan(t[4])),skewY:t=>Qd(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function F_(t){return t.includes("scale")?1:0}function $_(t,s){if(!t||t==="none")return F_(s);const n=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let a,i;if(n)a=vae,i=n;else{const c=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);a=bae,i=c}if(!i)return F_(s);const l=a[s],o=i[1].split(",").map(wae);return typeof l=="function"?l(o):o[l]}const Nae=(t,s)=>{const{transform:n="none"}=getComputedStyle(t);return $_(n,s)};function wae(t){return parseFloat(t.trim())}const Lm=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Bm=new Set(Lm),Y4=t=>t===Rm||t===Vt,jae=new Set(["x","y","z"]),_ae=Lm.filter(t=>!jae.has(t));function Sae(t){const s=[];return _ae.forEach(n=>{const a=t.getValue(n);a!==void 0&&(s.push([n,a.get()]),a.set(n.startsWith("scale")?1:0))}),s}const lu={width:({x:t},{paddingLeft:s="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(s)-parseFloat(n),height:({y:t},{paddingTop:s="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(s)-parseFloat(n),top:(t,{top:s})=>parseFloat(s),left:(t,{left:s})=>parseFloat(s),bottom:({y:t},{top:s})=>parseFloat(s)+(t.max-t.min),right:({x:t},{left:s})=>parseFloat(s)+(t.max-t.min),x:(t,{transform:s})=>$_(s,"x"),y:(t,{transform:s})=>$_(s,"y")};lu.translateX=lu.x;lu.translateY=lu.y;const ou=new Set;let z_=!1,U_=!1,V_=!1;function x9(){if(U_){const t=Array.from(ou).filter(a=>a.needsMeasurement),s=new Set(t.map(a=>a.element)),n=new Map;s.forEach(a=>{const i=Sae(a);i.length&&(n.set(a,i),a.render())}),t.forEach(a=>a.measureInitialState()),s.forEach(a=>{a.render();const i=n.get(a);i&&i.forEach(([l,o])=>{var c;(c=a.getValue(l))==null||c.set(o)})}),t.forEach(a=>a.measureEndState()),t.forEach(a=>{a.suspendedScrollY!==void 0&&window.scrollTo(0,a.suspendedScrollY)})}U_=!1,z_=!1,ou.forEach(t=>t.complete(V_)),ou.clear()}function g9(){ou.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(U_=!0)})}function Cae(){V_=!0,g9(),x9(),V_=!1}class ak{constructor(s,n,a,i,l,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...s],this.onComplete=n,this.name=a,this.motionValue=i,this.element=l,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(ou.add(this),z_||(z_=!0,tn.read(g9),tn.resolveKeyframes(x9))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:s,name:n,element:a,motionValue:i}=this;if(s[0]===null){const l=i==null?void 0:i.get(),o=s[s.length-1];if(l!==void 0)s[0]=l;else if(a&&n){const c=a.readValue(n,o);c!=null&&(s[0]=c)}s[0]===void 0&&(s[0]=o),i&&l===void 0&&i.set(s[0])}yae(s)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(s=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,s),ou.delete(this)}cancel(){this.state==="scheduled"&&(ou.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const kae=t=>t.startsWith("--");function Aae(t,s,n){kae(s)?t.style.setProperty(s,n):t.style[s]=n}const Eae=q3(()=>window.ScrollTimeline!==void 0),Tae={};function Pae(t,s){const n=q3(t);return()=>Tae[s]??n()}const y9=Pae(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Xf=([t,s,n,a])=>`cubic-bezier(${t}, ${s}, ${n}, ${a})`,X4={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Xf([0,.65,.55,1]),circOut:Xf([.55,0,1,.45]),backIn:Xf([.31,.01,.66,-.59]),backOut:Xf([.33,1.53,.69,.99])};function b9(t,s){if(t)return typeof t=="function"?y9()?m9(t,s):"ease-out":n9(t)?Xf(t):Array.isArray(t)?t.map(n=>b9(n,s)||X4.easeOut):X4[t]}function Iae(t,s,n,{delay:a=0,duration:i=300,repeat:l=0,repeatType:o="loop",ease:c="easeOut",times:d}={},u=void 0){const h={[s]:n};d&&(h.offset=d);const f=b9(c,i);Array.isArray(f)&&(h.easing=f);const x={delay:a,duration:i,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:l+1,direction:o==="reverse"?"alternate":"normal"};return u&&(x.pseudoElement=u),t.animate(h,x)}function v9(t){return typeof t=="function"&&"applyToOptions"in t}function Mae({type:t,...s}){return v9(t)&&y9()?t.applyToOptions(s):(s.duration??(s.duration=300),s.ease??(s.ease="easeOut"),s)}class Dae extends nk{constructor(s){if(super(),this.finishedTime=null,this.isStopped=!1,!s)return;const{element:n,name:a,keyframes:i,pseudoElement:l,allowFlatten:o=!1,finalKeyframe:c,onComplete:d}=s;this.isPseudoElement=!!l,this.allowFlatten=o,this.options=s,W3(typeof s.type!="string");const u=Mae(s);this.animation=Iae(n,a,i,u,l),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!l){const h=sk(i,this.options,c,this.speed);this.updateMotionValue?this.updateMotionValue(h):Aae(n,a,h),this.animation.cancel()}d==null||d(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var s,n;(n=(s=this.animation).finish)==null||n.call(s)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:s}=this;s==="idle"||s==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var s,n;this.isPseudoElement||(n=(s=this.animation).commitStyles)==null||n.call(s)}get duration(){var n,a;const s=((a=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:a.call(n).duration)||0;return Di(Number(s))}get iterationDuration(){const{delay:s=0}=this.options||{};return this.duration+Di(s)}get time(){return Di(Number(this.animation.currentTime)||0)}set time(s){this.finishedTime=null,this.animation.currentTime=so(s)}get speed(){return this.animation.playbackRate}set speed(s){s<0&&(this.finishedTime=null),this.animation.playbackRate=s}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(s){this.animation.startTime=s}attachTimeline({timeline:s,observe:n}){var a;return this.allowFlatten&&((a=this.animation.effect)==null||a.updateTiming({easing:"linear"})),this.animation.onfinish=null,s&&Eae()?(this.animation.timeline=s,Fi):n(this)}}const N9={anticipate:J7,backInOut:Z7,circInOut:t9};function Oae(t){return t in N9}function Rae(t){typeof t.ease=="string"&&Oae(t.ease)&&(t.ease=N9[t.ease])}const Q4=10;class Lae extends Dae{constructor(s){Rae(s),p9(s),super(s),s.startTime&&(this.startTime=s.startTime),this.options=s}updateMotionValue(s){const{motionValue:n,onUpdate:a,onComplete:i,element:l,...o}=this.options;if(!n)return;if(s!==void 0){n.set(s);return}const c=new rk({...o,autoplay:!1}),d=so(this.finishedTime??this.time);n.setWithVelocity(c.sample(d-Q4).value,c.sample(d).value,Q4),c.stop()}}const Z4=(t,s)=>s==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(ad.test(t)||t==="0")&&!t.startsWith("url("));function Bae(t){const s=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==s)return!0}function Fae(t,s,n,a){const i=t[0];if(i===null)return!1;if(s==="display"||s==="visibility")return!0;const l=t[t.length-1],o=Z4(i,s),c=Z4(l,s);return!o||!c?!1:Bae(t)||(n==="spring"||v9(n))&&a}function H_(t){t.duration=0,t.type="keyframes"}const $ae=new Set(["opacity","clipPath","filter","transform"]),zae=q3(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function Uae(t){var h;const{motionValue:s,name:n,repeatDelay:a,repeatType:i,damping:l,type:o}=t;if(!(((h=s==null?void 0:s.owner)==null?void 0:h.current)instanceof HTMLElement))return!1;const{onUpdate:d,transformTemplate:u}=s.owner.getProps();return zae()&&n&&$ae.has(n)&&(n!=="transform"||!u)&&!d&&!a&&i!=="mirror"&&l!==0&&o!=="inertia"}const Vae=40;class Hae extends nk{constructor({autoplay:s=!0,delay:n=0,type:a="keyframes",repeat:i=0,repeatDelay:l=0,repeatType:o="loop",keyframes:c,name:d,motionValue:u,element:h,...f}){var v;super(),this.stop=()=>{var w,_;this._animation&&(this._animation.stop(),(w=this.stopTimeline)==null||w.call(this)),(_=this.keyframeResolver)==null||_.cancel()},this.createdAt=Ta.now();const x={autoplay:s,delay:n,type:a,repeat:i,repeatDelay:l,repeatType:o,name:d,motionValue:u,element:h,...f},b=(h==null?void 0:h.KeyframeResolver)||ak;this.keyframeResolver=new b(c,(w,_,S)=>this.onKeyframesResolved(w,_,x,!S),d,u,h),(v=this.keyframeResolver)==null||v.scheduleResolve()}onKeyframesResolved(s,n,a,i){this.keyframeResolver=void 0;const{name:l,type:o,velocity:c,delay:d,isHandoff:u,onUpdate:h}=a;this.resolvedAt=Ta.now(),Fae(s,l,o,c)||((Ho.instantAnimations||!d)&&(h==null||h(sk(s,a,n))),s[0]=s[s.length-1],H_(a),a.repeat=0);const x={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>Vae?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...a,keyframes:s},b=!u&&Uae(x)?new Lae({...x,element:x.motionValue.owner.current}):new rk(x);b.finished.then(()=>this.notifyFinished()).catch(Fi),this.pendingTimeline&&(this.stopTimeline=b.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=b}get finished(){return this._animation?this.animation.finished:this._finished}then(s,n){return this.finished.finally(s).then(()=>{})}get animation(){var s;return this._animation||((s=this.keyframeResolver)==null||s.resume(),Cae()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(s){this.animation.time=s}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(s){this.animation.speed=s}get startTime(){return this.animation.startTime}attachTimeline(s){return this._animation?this.stopTimeline=this.animation.attachTimeline(s):this.pendingTimeline=s,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var s;this._animation&&this.animation.cancel(),(s=this.keyframeResolver)==null||s.cancel()}}const Wae=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function qae(t){const s=Wae.exec(t);if(!s)return[,];const[,n,a,i]=s;return[`--${n??a}`,i]}function w9(t,s,n=1){const[a,i]=qae(t);if(!a)return;const l=window.getComputedStyle(s).getPropertyValue(a);if(l){const o=l.trim();return H7(o)?parseFloat(o):o}return Q3(i)?w9(i,s,n+1):i}function ik(t,s){return(t==null?void 0:t[s])??(t==null?void 0:t.default)??t}const j9=new Set(["width","height","top","left","right","bottom",...Lm]),Gae={test:t=>t==="auto",parse:t=>t},_9=t=>s=>s.test(t),S9=[Rm,Vt,no,vc,Bre,Lre,Gae],J4=t=>S9.find(_9(t));function Kae(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||q7(t):!0}const Yae=new Set(["brightness","contrast","saturate","opacity"]);function Xae(t){const[s,n]=t.slice(0,-1).split("(");if(s==="drop-shadow")return t;const[a]=n.match(Z3)||[];if(!a)return t;const i=n.replace(a,"");let l=Yae.has(s)?1:0;return a!==n&&(l*=100),s+"("+l+i+")"}const Qae=/\b([a-z-]*)\(.*?\)/gu,W_={...ad,getAnimatableNone:t=>{const s=t.match(Qae);return s?s.map(Xae).join(" "):t}},eP={...Rm,transform:Math.round},Zae={rotate:vc,rotateX:vc,rotateY:vc,rotateZ:vc,scale:G0,scaleX:G0,scaleY:G0,scaleZ:G0,skew:vc,skewX:vc,skewY:vc,distance:Vt,translateX:Vt,translateY:Vt,translateZ:Vt,x:Vt,y:Vt,z:Vt,perspective:Vt,transformPerspective:Vt,opacity:Qp,originX:z4,originY:z4,originZ:Vt},lk={borderWidth:Vt,borderTopWidth:Vt,borderRightWidth:Vt,borderBottomWidth:Vt,borderLeftWidth:Vt,borderRadius:Vt,radius:Vt,borderTopLeftRadius:Vt,borderTopRightRadius:Vt,borderBottomRightRadius:Vt,borderBottomLeftRadius:Vt,width:Vt,maxWidth:Vt,height:Vt,maxHeight:Vt,top:Vt,right:Vt,bottom:Vt,left:Vt,padding:Vt,paddingTop:Vt,paddingRight:Vt,paddingBottom:Vt,paddingLeft:Vt,margin:Vt,marginTop:Vt,marginRight:Vt,marginBottom:Vt,marginLeft:Vt,backgroundPositionX:Vt,backgroundPositionY:Vt,...Zae,zIndex:eP,fillOpacity:Qp,strokeOpacity:Qp,numOctaves:eP},Jae={...lk,color:Vn,backgroundColor:Vn,outlineColor:Vn,fill:Vn,stroke:Vn,borderColor:Vn,borderTopColor:Vn,borderRightColor:Vn,borderBottomColor:Vn,borderLeftColor:Vn,filter:W_,WebkitFilter:W_},C9=t=>Jae[t];function k9(t,s){let n=C9(t);return n!==W_&&(n=ad),n.getAnimatableNone?n.getAnimatableNone(s):void 0}const eie=new Set(["auto","none","0"]);function tie(t,s,n){let a=0,i;for(;a<t.length&&!i;){const l=t[a];typeof l=="string"&&!eie.has(l)&&Zp(l).values.length&&(i=t[a]),a++}if(i&&n)for(const l of s)t[l]=k9(n,i)}class sie extends ak{constructor(s,n,a,i,l){super(s,n,a,i,l,!0)}readKeyframes(){const{unresolvedKeyframes:s,element:n,name:a}=this;if(!n||!n.current)return;super.readKeyframes();for(let d=0;d<s.length;d++){let u=s[d];if(typeof u=="string"&&(u=u.trim(),Q3(u))){const h=w9(u,n.current);h!==void 0&&(s[d]=h),d===s.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!j9.has(a)||s.length!==2)return;const[i,l]=s,o=J4(i),c=J4(l);if(o!==c)if(Y4(o)&&Y4(c))for(let d=0;d<s.length;d++){const u=s[d];typeof u=="string"&&(s[d]=parseFloat(u))}else lu[a]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:s,name:n}=this,a=[];for(let i=0;i<s.length;i++)(s[i]===null||Kae(s[i]))&&a.push(i);a.length&&tie(s,a,n)}measureInitialState(){const{element:s,unresolvedKeyframes:n,name:a}=this;if(!s||!s.current)return;a==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=lu[a](s.measureViewportBox(),window.getComputedStyle(s.current)),n[0]=this.measuredOrigin;const i=n[n.length-1];i!==void 0&&s.getValue(a,i).jump(i,!1)}measureEndState(){var c;const{element:s,name:n,unresolvedKeyframes:a}=this;if(!s||!s.current)return;const i=s.getValue(n);i&&i.jump(this.measuredOrigin,!1);const l=a.length-1,o=a[l];a[l]=lu[n](s.measureViewportBox(),window.getComputedStyle(s.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(c=this.removedTransforms)!=null&&c.length&&this.removedTransforms.forEach(([d,u])=>{s.getValue(d).set(u)}),this.resolveNoneKeyframes()}}function nie(t,s,n){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let a=document;const i=(n==null?void 0:n[t])??a.querySelectorAll(t);return i?Array.from(i):[]}return Array.from(t)}const A9=(t,s)=>s&&typeof t=="number"?s.transform(t):t;function E9(t){return W7(t)&&"offsetHeight"in t}const tP=30,rie=t=>!isNaN(parseFloat(t));class aie{constructor(s,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=a=>{var l;const i=Ta.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(a),this.current!==this.prev&&((l=this.events.change)==null||l.notify(this.current),this.dependents))for(const o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(s),this.owner=n.owner}setCurrent(s){this.current=s,this.updatedAt=Ta.now(),this.canTrackVelocity===null&&s!==void 0&&(this.canTrackVelocity=rie(this.current))}setPrevFrameValue(s=this.current){this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt}onChange(s){return this.on("change",s)}on(s,n){this.events[s]||(this.events[s]=new G3);const a=this.events[s].add(n);return s==="change"?()=>{a(),tn.read(()=>{this.events.change.getSize()||this.stop()})}:a}clearListeners(){for(const s in this.events)this.events[s].clear()}attach(s,n){this.passiveEffect=s,this.stopPassiveEffect=n}set(s){this.passiveEffect?this.passiveEffect(s,this.updateAndNotify):this.updateAndNotify(s)}setWithVelocity(s,n,a){this.set(n),this.prev=void 0,this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt-a}jump(s,n=!0){this.updateAndNotify(s),this.prev=s,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var s;(s=this.events.change)==null||s.notify(this.current)}addDependent(s){this.dependents||(this.dependents=new Set),this.dependents.add(s)}removeDependent(s){this.dependents&&this.dependents.delete(s)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const s=Ta.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||s-this.updatedAt>tP)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,tP);return G7(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(s){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=s(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var s,n;(s=this.dependents)==null||s.clear(),(n=this.events.destroy)==null||n.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function um(t,s){return new aie(t,s)}const{schedule:ok}=r9(queueMicrotask,!1),al={x:!1,y:!1};function T9(){return al.x||al.y}function iie(t){return t==="x"||t==="y"?al[t]?null:(al[t]=!0,()=>{al[t]=!1}):al.x||al.y?null:(al.x=al.y=!0,()=>{al.x=al.y=!1})}function P9(t,s){const n=nie(t),a=new AbortController,i={passive:!0,...s,signal:a.signal};return[n,i,()=>a.abort()]}function sP(t){return!(t.pointerType==="touch"||T9())}function lie(t,s,n={}){const[a,i,l]=P9(t,n),o=c=>{if(!sP(c))return;const{target:d}=c,u=s(d,c);if(typeof u!="function"||!d)return;const h=f=>{sP(f)&&(u(f),d.removeEventListener("pointerleave",h))};d.addEventListener("pointerleave",h,i)};return a.forEach(c=>{c.addEventListener("pointerenter",o,i)}),l}const I9=(t,s)=>s?t===s?!0:I9(t,s.parentElement):!1,ck=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,oie=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function cie(t){return oie.has(t.tagName)||t.tabIndex!==-1}const ly=new WeakSet;function nP(t){return s=>{s.key==="Enter"&&t(s)}}function Fw(t,s){t.dispatchEvent(new PointerEvent("pointer"+s,{isPrimary:!0,bubbles:!0}))}const die=(t,s)=>{const n=t.currentTarget;if(!n)return;const a=nP(()=>{if(ly.has(n))return;Fw(n,"down");const i=nP(()=>{Fw(n,"up")}),l=()=>Fw(n,"cancel");n.addEventListener("keyup",i,s),n.addEventListener("blur",l,s)});n.addEventListener("keydown",a,s),n.addEventListener("blur",()=>n.removeEventListener("keydown",a),s)};function rP(t){return ck(t)&&!T9()}function uie(t,s,n={}){const[a,i,l]=P9(t,n),o=c=>{const d=c.currentTarget;if(!rP(c))return;ly.add(d);const u=s(d,c),h=(b,v)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",x),ly.has(d)&&ly.delete(d),rP(b)&&typeof u=="function"&&u(b,{success:v})},f=b=>{h(b,d===window||d===document||n.useGlobalTarget||I9(d,b.target))},x=b=>{h(b,!1)};window.addEventListener("pointerup",f,i),window.addEventListener("pointercancel",x,i)};return a.forEach(c=>{(n.useGlobalTarget?window:c).addEventListener("pointerdown",o,i),E9(c)&&(c.addEventListener("focus",u=>die(u,i)),!cie(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),l}function M9(t){return W7(t)&&"ownerSVGElement"in t}function hie(t){return M9(t)&&t.tagName==="svg"}const Kr=t=>!!(t&&t.getVelocity),mie=[...S9,Vn,ad],fie=t=>mie.find(_9(t)),dk=y.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function aP(t,s){if(typeof t=="function")return t(s);t!=null&&(t.current=s)}function pie(...t){return s=>{let n=!1;const a=t.map(i=>{const l=aP(i,s);return!n&&typeof l=="function"&&(n=!0),l});if(n)return()=>{for(let i=0;i<a.length;i++){const l=a[i];typeof l=="function"?l():aP(t[i],null)}}}}function xie(...t){return y.useCallback(pie(...t),t)}class gie extends y.Component{getSnapshotBeforeUpdate(s){const n=this.props.childRef.current;if(n&&s.isPresent&&!this.props.isPresent){const a=n.offsetParent,i=E9(a)&&a.offsetWidth||0,l=this.props.sizeRef.current;l.height=n.offsetHeight||0,l.width=n.offsetWidth||0,l.top=n.offsetTop,l.left=n.offsetLeft,l.right=i-l.width-l.left}return null}componentDidUpdate(){}render(){return this.props.children}}function yie({children:t,isPresent:s,anchorX:n,root:a}){const i=y.useId(),l=y.useRef(null),o=y.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=y.useContext(dk),d=xie(l,t==null?void 0:t.ref);return y.useInsertionEffect(()=>{const{width:u,height:h,top:f,left:x,right:b}=o.current;if(s||!l.current||!u||!h)return;const v=n==="left"?`left: ${x}`:`right: ${b}`;l.current.dataset.motionPopId=i;const w=document.createElement("style");c&&(w.nonce=c);const _=a??document.head;return _.appendChild(w),w.sheet&&w.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${u}px !important;
            height: ${h}px !important;
            ${v}px !important;
            top: ${f}px !important;
          }
        `),()=>{_.contains(w)&&_.removeChild(w)}},[s]),r.jsx(gie,{isPresent:s,childRef:l,sizeRef:o,children:y.cloneElement(t,{ref:d})})}const bie=({children:t,initial:s,isPresent:n,onExitComplete:a,custom:i,presenceAffectsLayout:l,mode:o,anchorX:c,root:d})=>{const u=z3(vie),h=y.useId();let f=!0,x=y.useMemo(()=>(f=!1,{id:h,initial:s,isPresent:n,custom:i,onExitComplete:b=>{u.set(b,!0);for(const v of u.values())if(!v)return;a&&a()},register:b=>(u.set(b,!1),()=>u.delete(b))}),[n,u,a]);return l&&f&&(x={...x}),y.useMemo(()=>{u.forEach((b,v)=>u.set(v,!1))},[n]),y.useEffect(()=>{!n&&!u.size&&a&&a()},[n]),o==="popLayout"&&(t=r.jsx(yie,{isPresent:n,anchorX:c,root:d,children:t})),r.jsx(Jb.Provider,{value:x,children:t})};function vie(){return new Map}function D9(t=!0){const s=y.useContext(Jb);if(s===null)return[!0,null];const{isPresent:n,onExitComplete:a,register:i}=s,l=y.useId();y.useEffect(()=>{if(t)return i(l)},[t]);const o=y.useCallback(()=>t&&a&&a(l),[l,a,t]);return!n&&a?[!1,o]:[!0]}const K0=t=>t.key||"";function iP(t){const s=[];return y.Children.forEach(t,n=>{y.isValidElement(n)&&s.push(n)}),s}const vl=({children:t,custom:s,initial:n=!0,onExitComplete:a,presenceAffectsLayout:i=!0,mode:l="sync",propagate:o=!1,anchorX:c="left",root:d})=>{const[u,h]=D9(o),f=y.useMemo(()=>iP(t),[t]),x=o&&!u?[]:f.map(K0),b=y.useRef(!0),v=y.useRef(f),w=z3(()=>new Map),[_,S]=y.useState(f),[k,A]=y.useState(f);V7(()=>{b.current=!1,v.current=f;for(let O=0;O<k.length;O++){const D=K0(k[O]);x.includes(D)?w.delete(D):w.get(D)!==!0&&w.set(D,!1)}},[k,x.length,x.join("-")]);const T=[];if(f!==_){let O=[...f];for(let D=0;D<k.length;D++){const I=k[D],M=K0(I);x.includes(M)||(O.splice(D,0,I),T.push(I))}return l==="wait"&&T.length&&(O=T),A(iP(O)),S(f),null}const{forceRender:P}=y.useContext($3);return r.jsx(r.Fragment,{children:k.map(O=>{const D=K0(O),I=o&&!u?!1:f===k||x.includes(D),M=()=>{if(w.has(D))w.set(D,!0);else return;let B=!0;w.forEach(L=>{L||(B=!1)}),B&&(P==null||P(),A(v.current),o&&(h==null||h()),a&&a())};return r.jsx(bie,{isPresent:I,initial:!b.current||n?void 0:!1,custom:s,presenceAffectsLayout:i,mode:l,root:d,onExitComplete:I?void 0:M,anchorX:c,children:O},D)})})},O9=y.createContext({strict:!1}),lP={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},hm={};for(const t in lP)hm[t]={isEnabled:s=>lP[t].some(n=>!!s[n])};function Nie(t){for(const s in t)hm[s]={...hm[s],...t[s]}}const wie=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function i1(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||wie.has(t)}let R9=t=>!i1(t);function jie(t){typeof t=="function"&&(R9=s=>s.startsWith("on")?!i1(s):t(s))}try{jie(require("@emotion/is-prop-valid").default)}catch{}function _ie(t,s,n){const a={};for(const i in t)i==="values"&&typeof t.values=="object"||(R9(i)||n===!0&&i1(i)||!s&&!i1(i)||t.draggable&&i.startsWith("onDrag"))&&(a[i]=t[i]);return a}const ev=y.createContext({});function tv(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function Jp(t){return typeof t=="string"||Array.isArray(t)}const uk=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],hk=["initial",...uk];function sv(t){return tv(t.animate)||hk.some(s=>Jp(t[s]))}function L9(t){return!!(sv(t)||t.variants)}function Sie(t,s){if(sv(t)){const{initial:n,animate:a}=t;return{initial:n===!1||Jp(n)?n:void 0,animate:Jp(a)?a:void 0}}return t.inherit!==!1?s:{}}function Cie(t){const{initial:s,animate:n}=Sie(t,y.useContext(ev));return y.useMemo(()=>({initial:s,animate:n}),[oP(s),oP(n)])}function oP(t){return Array.isArray(t)?t.join(" "):t}const ex={};function kie(t){for(const s in t)ex[s]=t[s],X3(s)&&(ex[s].isCSSVariable=!0)}function B9(t,{layout:s,layoutId:n}){return Bm.has(t)||t.startsWith("origin")||(s||n!==void 0)&&(!!ex[t]||t==="opacity")}const Aie={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Eie=Lm.length;function Tie(t,s,n){let a="",i=!0;for(let l=0;l<Eie;l++){const o=Lm[l],c=t[o];if(c===void 0)continue;let d=!0;if(typeof c=="number"?d=c===(o.startsWith("scale")?1:0):d=parseFloat(c)===0,!d||n){const u=A9(c,lk[o]);if(!d){i=!1;const h=Aie[o]||o;a+=`${h}(${u}) `}n&&(s[o]=u)}}return a=a.trim(),n?a=n(s,i?"":a):i&&(a="none"),a}function mk(t,s,n){const{style:a,vars:i,transformOrigin:l}=t;let o=!1,c=!1;for(const d in s){const u=s[d];if(Bm.has(d)){o=!0;continue}else if(X3(d)){i[d]=u;continue}else{const h=A9(u,lk[d]);d.startsWith("origin")?(c=!0,l[d]=h):a[d]=h}}if(s.transform||(o||n?a.transform=Tie(s,t.transform,n):a.transform&&(a.transform="none")),c){const{originX:d="50%",originY:u="50%",originZ:h=0}=l;a.transformOrigin=`${d} ${u} ${h}`}}const fk=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function F9(t,s,n){for(const a in s)!Kr(s[a])&&!B9(a,n)&&(t[a]=s[a])}function Pie({transformTemplate:t},s){return y.useMemo(()=>{const n=fk();return mk(n,s,t),Object.assign({},n.vars,n.style)},[s])}function Iie(t,s){const n=t.style||{},a={};return F9(a,n,t),Object.assign(a,Pie(t,s)),a}function Mie(t,s){const n={},a=Iie(t,s);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=a,n}const Die={offset:"stroke-dashoffset",array:"stroke-dasharray"},Oie={offset:"strokeDashoffset",array:"strokeDasharray"};function Rie(t,s,n=1,a=0,i=!0){t.pathLength=1;const l=i?Die:Oie;t[l.offset]=Vt.transform(-a);const o=Vt.transform(s),c=Vt.transform(n);t[l.array]=`${o} ${c}`}function $9(t,{attrX:s,attrY:n,attrScale:a,pathLength:i,pathSpacing:l=1,pathOffset:o=0,...c},d,u,h){if(mk(t,c,u),d){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:f,style:x}=t;f.transform&&(x.transform=f.transform,delete f.transform),(x.transform||f.transformOrigin)&&(x.transformOrigin=f.transformOrigin??"50% 50%",delete f.transformOrigin),x.transform&&(x.transformBox=(h==null?void 0:h.transformBox)??"fill-box",delete f.transformBox),s!==void 0&&(f.x=s),n!==void 0&&(f.y=n),a!==void 0&&(f.scale=a),i!==void 0&&Rie(f,i,l,o,!1)}const z9=()=>({...fk(),attrs:{}}),U9=t=>typeof t=="string"&&t.toLowerCase()==="svg";function Lie(t,s,n,a){const i=y.useMemo(()=>{const l=z9();return $9(l,s,U9(a),t.transformTemplate,t.style),{...l.attrs,style:{...l.style}}},[s]);if(t.style){const l={};F9(l,t.style,t),i.style={...l,...i.style}}return i}const Bie=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function pk(t){return typeof t!="string"||t.includes("-")?!1:!!(Bie.indexOf(t)>-1||/[A-Z]/u.test(t))}function Fie(t,s,n,{latestValues:a},i,l=!1){const c=(pk(t)?Lie:Mie)(s,a,i,t),d=_ie(s,typeof t=="string",l),u=t!==y.Fragment?{...d,...c,ref:n}:{},{children:h}=s,f=y.useMemo(()=>Kr(h)?h.get():h,[h]);return y.createElement(t,{...u,children:f})}function cP(t){const s=[{},{}];return t==null||t.values.forEach((n,a)=>{s[0][a]=n.get(),s[1][a]=n.getVelocity()}),s}function xk(t,s,n,a){if(typeof s=="function"){const[i,l]=cP(a);s=s(n!==void 0?n:t.custom,i,l)}if(typeof s=="string"&&(s=t.variants&&t.variants[s]),typeof s=="function"){const[i,l]=cP(a);s=s(n!==void 0?n:t.custom,i,l)}return s}function oy(t){return Kr(t)?t.get():t}function $ie({scrapeMotionValuesFromProps:t,createRenderState:s},n,a,i){return{latestValues:zie(n,a,i,t),renderState:s()}}function zie(t,s,n,a){const i={},l=a(t,{});for(const x in l)i[x]=oy(l[x]);let{initial:o,animate:c}=t;const d=sv(t),u=L9(t);s&&u&&!d&&t.inherit!==!1&&(o===void 0&&(o=s.initial),c===void 0&&(c=s.animate));let h=n?n.initial===!1:!1;h=h||o===!1;const f=h?c:o;if(f&&typeof f!="boolean"&&!tv(f)){const x=Array.isArray(f)?f:[f];for(let b=0;b<x.length;b++){const v=xk(t,x[b]);if(v){const{transitionEnd:w,transition:_,...S}=v;for(const k in S){let A=S[k];if(Array.isArray(A)){const T=h?A.length-1:0;A=A[T]}A!==null&&(i[k]=A)}for(const k in w)i[k]=w[k]}}}return i}const V9=t=>(s,n)=>{const a=y.useContext(ev),i=y.useContext(Jb),l=()=>$ie(t,s,a,i);return n?l():z3(l)};function gk(t,s,n){var l;const{style:a}=t,i={};for(const o in a)(Kr(a[o])||s.style&&Kr(s.style[o])||B9(o,t)||((l=n==null?void 0:n.getValue(o))==null?void 0:l.liveStyle)!==void 0)&&(i[o]=a[o]);return i}const Uie=V9({scrapeMotionValuesFromProps:gk,createRenderState:fk});function H9(t,s,n){const a=gk(t,s,n);for(const i in t)if(Kr(t[i])||Kr(s[i])){const l=Lm.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;a[l]=t[i]}return a}const Vie=V9({scrapeMotionValuesFromProps:H9,createRenderState:z9}),Hie=Symbol.for("motionComponentSymbol");function Ih(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function Wie(t,s,n){return y.useCallback(a=>{a&&t.onMount&&t.onMount(a),s&&(a?s.mount(a):s.unmount()),n&&(typeof n=="function"?n(a):Ih(n)&&(n.current=a))},[s])}const yk=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),qie="framerAppearId",W9="data-"+yk(qie),q9=y.createContext({});function Gie(t,s,n,a,i){var w,_;const{visualElement:l}=y.useContext(ev),o=y.useContext(O9),c=y.useContext(Jb),d=y.useContext(dk).reducedMotion,u=y.useRef(null);a=a||o.renderer,!u.current&&a&&(u.current=a(t,{visualState:s,parent:l,props:n,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:d}));const h=u.current,f=y.useContext(q9);h&&!h.projection&&i&&(h.type==="html"||h.type==="svg")&&Kie(u.current,n,i,f);const x=y.useRef(!1);y.useInsertionEffect(()=>{h&&x.current&&h.update(n,c)});const b=n[W9],v=y.useRef(!!b&&!((w=window.MotionHandoffIsComplete)!=null&&w.call(window,b))&&((_=window.MotionHasOptimisedAnimation)==null?void 0:_.call(window,b)));return V7(()=>{h&&(x.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),h.scheduleRenderMicrotask(),v.current&&h.animationState&&h.animationState.animateChanges())}),y.useEffect(()=>{h&&(!v.current&&h.animationState&&h.animationState.animateChanges(),v.current&&(queueMicrotask(()=>{var S;(S=window.MotionHandoffMarkAsComplete)==null||S.call(window,b)}),v.current=!1),h.enteringChildren=void 0)}),h}function Kie(t,s,n,a){const{layoutId:i,layout:l,drag:o,dragConstraints:c,layoutScroll:d,layoutRoot:u,layoutCrossfade:h}=s;t.projection=new n(t.latestValues,s["data-framer-portal-id"]?void 0:G9(t.parent)),t.projection.setOptions({layoutId:i,layout:l,alwaysMeasureLayout:!!o||c&&Ih(c),visualElement:t,animationType:typeof l=="string"?l:"both",initialPromotionConfig:a,crossfade:h,layoutScroll:d,layoutRoot:u})}function G9(t){if(t)return t.options.allowProjection!==!1?t.projection:G9(t.parent)}function $w(t,{forwardMotionProps:s=!1}={},n,a){n&&Nie(n);const i=pk(t)?Vie:Uie;function l(c,d){let u;const h={...y.useContext(dk),...c,layoutId:Yie(c)},{isStatic:f}=h,x=Cie(c),b=i(c,f);if(!f&&U3){Xie();const v=Qie(h);u=v.MeasureLayout,x.visualElement=Gie(t,b,h,a,v.ProjectionNode)}return r.jsxs(ev.Provider,{value:x,children:[u&&x.visualElement?r.jsx(u,{visualElement:x.visualElement,...h}):null,Fie(t,c,Wie(b,x.visualElement,d),b,f,s)]})}l.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const o=y.forwardRef(l);return o[Hie]=t,o}function Yie({layoutId:t}){const s=y.useContext($3).id;return s&&t!==void 0?s+"-"+t:t}function Xie(t,s){y.useContext(O9).strict}function Qie(t){const{drag:s,layout:n}=hm;if(!s&&!n)return{};const a={...s,...n};return{MeasureLayout:s!=null&&s.isEnabled(t)||n!=null&&n.isEnabled(t)?a.MeasureLayout:void 0,ProjectionNode:a.ProjectionNode}}function Zie(t,s){if(typeof Proxy>"u")return $w;const n=new Map,a=(l,o)=>$w(l,o,t,s),i=(l,o)=>a(l,o);return new Proxy(i,{get:(l,o)=>o==="create"?a:(n.has(o)||n.set(o,$w(o,void 0,t,s)),n.get(o))})}function K9({top:t,left:s,right:n,bottom:a}){return{x:{min:s,max:n},y:{min:t,max:a}}}function Jie({x:t,y:s}){return{top:s.min,right:t.max,bottom:s.max,left:t.min}}function ele(t,s){if(!s)return t;const n=s({x:t.left,y:t.top}),a=s({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:a.y,right:a.x}}function zw(t){return t===void 0||t===1}function q_({scale:t,scaleX:s,scaleY:n}){return!zw(t)||!zw(s)||!zw(n)}function $d(t){return q_(t)||Y9(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function Y9(t){return dP(t.x)||dP(t.y)}function dP(t){return t&&t!=="0%"}function l1(t,s,n){const a=t-n,i=s*a;return n+i}function uP(t,s,n,a,i){return i!==void 0&&(t=l1(t,i,a)),l1(t,n,a)+s}function G_(t,s=0,n=1,a,i){t.min=uP(t.min,s,n,a,i),t.max=uP(t.max,s,n,a,i)}function X9(t,{x:s,y:n}){G_(t.x,s.translate,s.scale,s.originPoint),G_(t.y,n.translate,n.scale,n.originPoint)}const hP=.999999999999,mP=1.0000000000001;function tle(t,s,n,a=!1){const i=n.length;if(!i)return;s.x=s.y=1;let l,o;for(let c=0;c<i;c++){l=n[c],o=l.projectionDelta;const{visualElement:d}=l.options;d&&d.props.style&&d.props.style.display==="contents"||(a&&l.options.layoutScroll&&l.scroll&&l!==l.root&&Dh(t,{x:-l.scroll.offset.x,y:-l.scroll.offset.y}),o&&(s.x*=o.x.scale,s.y*=o.y.scale,X9(t,o)),a&&$d(l.latestValues)&&Dh(t,l.latestValues))}s.x<mP&&s.x>hP&&(s.x=1),s.y<mP&&s.y>hP&&(s.y=1)}function Mh(t,s){t.min=t.min+s,t.max=t.max+s}function fP(t,s,n,a,i=.5){const l=hn(t.min,t.max,i);G_(t,s,n,l,a)}function Dh(t,s){fP(t.x,s.x,s.scaleX,s.scale,s.originX),fP(t.y,s.y,s.scaleY,s.scale,s.originY)}function Q9(t,s){return K9(ele(t.getBoundingClientRect(),s))}function sle(t,s,n){const a=Q9(t,n),{scroll:i}=s;return i&&(Mh(a.x,i.offset.x),Mh(a.y,i.offset.y)),a}const pP=()=>({translate:0,scale:1,origin:0,originPoint:0}),Oh=()=>({x:pP(),y:pP()}),xP=()=>({min:0,max:0}),Pn=()=>({x:xP(),y:xP()}),K_={current:null},Z9={current:!1};function nle(){if(Z9.current=!0,!!U3)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),s=()=>K_.current=t.matches;t.addEventListener("change",s),s()}else K_.current=!1}const rle=new WeakMap;function ale(t,s,n){for(const a in s){const i=s[a],l=n[a];if(Kr(i))t.addValue(a,i);else if(Kr(l))t.addValue(a,um(i,{owner:t}));else if(l!==i)if(t.hasValue(a)){const o=t.getValue(a);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=t.getStaticValue(a);t.addValue(a,um(o!==void 0?o:i,{owner:t}))}}for(const a in n)s[a]===void 0&&t.removeValue(a);return s}const gP=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class ile{scrapeMotionValuesFromProps(s,n,a){return{}}constructor({parent:s,props:n,presenceContext:a,reducedMotionConfig:i,blockInitialAnimation:l,visualState:o},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=ak,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const x=Ta.now();this.renderScheduledAt<x&&(this.renderScheduledAt=x,tn.render(this.render,!1,!0))};const{latestValues:d,renderState:u}=o;this.latestValues=d,this.baseTarget={...d},this.initialValues=n.initial?{...d}:{},this.renderState=u,this.parent=s,this.props=n,this.presenceContext=a,this.depth=s?s.depth+1:0,this.reducedMotionConfig=i,this.options=c,this.blockInitialAnimation=!!l,this.isControllingVariants=sv(n),this.isVariantNode=L9(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(s&&s.current);const{willChange:h,...f}=this.scrapeMotionValuesFromProps(n,{},this);for(const x in f){const b=f[x];d[x]!==void 0&&Kr(b)&&b.set(d[x])}}mount(s){var n;this.current=s,rle.set(s,this),this.projection&&!this.projection.instance&&this.projection.mount(s),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,i)=>this.bindToMotionValue(i,a)),Z9.current||nle(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:K_.current,(n=this.parent)==null||n.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var s;this.projection&&this.projection.unmount(),rd(this.notifyUpdate),rd(this.render),this.valueSubscriptions.forEach(n=>n()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(s=this.parent)==null||s.removeChild(this);for(const n in this.events)this.events[n].clear();for(const n in this.features){const a=this.features[n];a&&(a.unmount(),a.isMounted=!1)}this.current=null}addChild(s){this.children.add(s),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(s)}removeChild(s){this.children.delete(s),this.enteringChildren&&this.enteringChildren.delete(s)}bindToMotionValue(s,n){this.valueSubscriptions.has(s)&&this.valueSubscriptions.get(s)();const a=Bm.has(s);a&&this.onBindTransform&&this.onBindTransform();const i=n.on("change",o=>{this.latestValues[s]=o,this.props.onUpdate&&tn.preRender(this.notifyUpdate),a&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let l;window.MotionCheckAppearSync&&(l=window.MotionCheckAppearSync(this,s,n)),this.valueSubscriptions.set(s,()=>{i(),l&&l(),n.owner&&n.stop()})}sortNodePosition(s){return!this.current||!this.sortInstanceNodePosition||this.type!==s.type?0:this.sortInstanceNodePosition(this.current,s.current)}updateFeatures(){let s="animation";for(s in hm){const n=hm[s];if(!n)continue;const{isEnabled:a,Feature:i}=n;if(!this.features[s]&&i&&a(this.props)&&(this.features[s]=new i(this)),this.features[s]){const l=this.features[s];l.isMounted?l.update():(l.mount(),l.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Pn()}getStaticValue(s){return this.latestValues[s]}setStaticValue(s,n){this.latestValues[s]=n}update(s,n){(s.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=s,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let a=0;a<gP.length;a++){const i=gP[a];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const l="on"+i,o=s[l];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=ale(this,this.scrapeMotionValuesFromProps(s,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(s){return this.props.variants?this.props.variants[s]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(s){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(s),()=>n.variantChildren.delete(s)}addValue(s,n){const a=this.values.get(s);n!==a&&(a&&this.removeValue(s),this.bindToMotionValue(s,n),this.values.set(s,n),this.latestValues[s]=n.get())}removeValue(s){this.values.delete(s);const n=this.valueSubscriptions.get(s);n&&(n(),this.valueSubscriptions.delete(s)),delete this.latestValues[s],this.removeValueFromRenderState(s,this.renderState)}hasValue(s){return this.values.has(s)}getValue(s,n){if(this.props.values&&this.props.values[s])return this.props.values[s];let a=this.values.get(s);return a===void 0&&n!==void 0&&(a=um(n===null?void 0:n,{owner:this}),this.addValue(s,a)),a}readValue(s,n){let a=this.latestValues[s]!==void 0||!this.current?this.latestValues[s]:this.getBaseTargetFromProps(this.props,s)??this.readValueFromInstance(this.current,s,this.options);return a!=null&&(typeof a=="string"&&(H7(a)||q7(a))?a=parseFloat(a):!fie(a)&&ad.test(n)&&(a=k9(s,n)),this.setBaseTarget(s,Kr(a)?a.get():a)),Kr(a)?a.get():a}setBaseTarget(s,n){this.baseTarget[s]=n}getBaseTarget(s){var l;const{initial:n}=this.props;let a;if(typeof n=="string"||typeof n=="object"){const o=xk(this.props,n,(l=this.presenceContext)==null?void 0:l.custom);o&&(a=o[s])}if(n&&a!==void 0)return a;const i=this.getBaseTargetFromProps(this.props,s);return i!==void 0&&!Kr(i)?i:this.initialValues[s]!==void 0&&a===void 0?void 0:this.baseTarget[s]}on(s,n){return this.events[s]||(this.events[s]=new G3),this.events[s].add(n)}notify(s,...n){this.events[s]&&this.events[s].notify(...n)}scheduleRenderMicrotask(){ok.render(this.render)}}class J9 extends ile{constructor(){super(...arguments),this.KeyframeResolver=sie}sortInstanceNodePosition(s,n){return s.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(s,n){return s.style?s.style[n]:void 0}removeValueFromRenderState(s,{vars:n,style:a}){delete n[s],delete a[s]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:s}=this.props;Kr(s)&&(this.childSubscription=s.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function eB(t,{style:s,vars:n},a,i){const l=t.style;let o;for(o in s)l[o]=s[o];i==null||i.applyProjectionStyles(l,a);for(o in n)l.setProperty(o,n[o])}function lle(t){return window.getComputedStyle(t)}class ole extends J9{constructor(){super(...arguments),this.type="html",this.renderInstance=eB}readValueFromInstance(s,n){var a;if(Bm.has(n))return(a=this.projection)!=null&&a.isProjecting?F_(n):Nae(s,n);{const i=lle(s),l=(X3(n)?i.getPropertyValue(n):i[n])||0;return typeof l=="string"?l.trim():l}}measureInstanceViewportBox(s,{transformPagePoint:n}){return Q9(s,n)}build(s,n,a){mk(s,n,a.transformTemplate)}scrapeMotionValuesFromProps(s,n,a){return gk(s,n,a)}}const tB=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function cle(t,s,n,a){eB(t,s,void 0,a);for(const i in s.attrs)t.setAttribute(tB.has(i)?i:yk(i),s.attrs[i])}class dle extends J9{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Pn}getBaseTargetFromProps(s,n){return s[n]}readValueFromInstance(s,n){if(Bm.has(n)){const a=C9(n);return a&&a.default||0}return n=tB.has(n)?n:yk(n),s.getAttribute(n)}scrapeMotionValuesFromProps(s,n,a){return H9(s,n,a)}build(s,n,a){$9(s,n,this.isSVGTag,a.transformTemplate,a.style)}renderInstance(s,n,a,i){cle(s,n,a,i)}mount(s){this.isSVGTag=U9(s.tagName),super.mount(s)}}const ule=(t,s)=>pk(t)?new dle(s):new ole(s,{allowProjection:t!==y.Fragment});function qh(t,s,n){const a=t.getProps();return xk(a,s,n!==void 0?n:a.custom,t)}const Y_=t=>Array.isArray(t);function hle(t,s,n){t.hasValue(s)?t.getValue(s).set(n):t.addValue(s,um(n))}function mle(t){return Y_(t)?t[t.length-1]||0:t}function fle(t,s){const n=qh(t,s);let{transitionEnd:a={},transition:i={},...l}=n||{};l={...l,...a};for(const o in l){const c=mle(l[o]);hle(t,o,c)}}function ple(t){return!!(Kr(t)&&t.add)}function X_(t,s){const n=t.getValue("willChange");if(ple(n))return n.add(s);if(!n&&Ho.WillChange){const a=new Ho.WillChange("auto");t.addValue("willChange",a),a.add(s)}}function sB(t){return t.props[W9]}const xle=t=>t!==null;function gle(t,{repeat:s,repeatType:n="loop"},a){const i=t.filter(xle),l=s&&n!=="loop"&&s%2===1?0:i.length-1;return i[l]}const yle={type:"spring",stiffness:500,damping:25,restSpeed:10},ble=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),vle={type:"keyframes",duration:.8},Nle={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},wle=(t,{keyframes:s})=>s.length>2?vle:Bm.has(t)?t.startsWith("scale")?ble(s[1]):yle:Nle;function jle({when:t,delay:s,delayChildren:n,staggerChildren:a,staggerDirection:i,repeat:l,repeatType:o,repeatDelay:c,from:d,elapsed:u,...h}){return!!Object.keys(h).length}const bk=(t,s,n,a={},i,l)=>o=>{const c=ik(a,t)||{},d=c.delay||a.delay||0;let{elapsed:u=0}=a;u=u-so(d);const h={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:s.getVelocity(),...c,delay:-u,onUpdate:x=>{s.set(x),c.onUpdate&&c.onUpdate(x)},onComplete:()=>{o(),c.onComplete&&c.onComplete()},name:t,motionValue:s,element:l?void 0:i};jle(c)||Object.assign(h,wle(t,h)),h.duration&&(h.duration=so(h.duration)),h.repeatDelay&&(h.repeatDelay=so(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let f=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(H_(h),h.delay===0&&(f=!0)),(Ho.instantAnimations||Ho.skipAnimations)&&(f=!0,H_(h),h.delay=0),h.allowFlatten=!c.type&&!c.ease,f&&!l&&s.get()!==void 0){const x=gle(h.keyframes,c);if(x!==void 0){tn.update(()=>{h.onUpdate(x),h.onComplete()});return}}return c.isSync?new rk(h):new Hae(h)};function _le({protectedKeys:t,needsAnimating:s},n){const a=t.hasOwnProperty(n)&&s[n]!==!0;return s[n]=!1,a}function nB(t,s,{delay:n=0,transitionOverride:a,type:i}={}){let{transition:l=t.getDefaultTransition(),transitionEnd:o,...c}=s;a&&(l=a);const d=[],u=i&&t.animationState&&t.animationState.getState()[i];for(const h in c){const f=t.getValue(h,t.latestValues[h]??null),x=c[h];if(x===void 0||u&&_le(u,h))continue;const b={delay:n,...ik(l||{},h)},v=f.get();if(v!==void 0&&!f.isAnimating&&!Array.isArray(x)&&x===v&&!b.velocity)continue;let w=!1;if(window.MotionHandoffAnimation){const S=sB(t);if(S){const k=window.MotionHandoffAnimation(S,h,tn);k!==null&&(b.startTime=k,w=!0)}}X_(t,h),f.start(bk(h,f,x,t.shouldReduceMotion&&j9.has(h)?{type:!1}:b,t,w));const _=f.animation;_&&d.push(_)}return o&&Promise.all(d).then(()=>{tn.update(()=>{o&&fle(t,o)})}),d}function rB(t,s,n,a=0,i=1){const l=Array.from(t).sort((u,h)=>u.sortNodePosition(h)).indexOf(s),o=t.size,c=(o-1)*a;return typeof n=="function"?n(l,o):i===1?l*a:c-l*a}function Q_(t,s,n={}){var d;const a=qh(t,s,n.type==="exit"?(d=t.presenceContext)==null?void 0:d.custom:void 0);let{transition:i=t.getDefaultTransition()||{}}=a||{};n.transitionOverride&&(i=n.transitionOverride);const l=a?()=>Promise.all(nB(t,a,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(u=0)=>{const{delayChildren:h=0,staggerChildren:f,staggerDirection:x}=i;return Sle(t,s,u,h,f,x,n)}:()=>Promise.resolve(),{when:c}=i;if(c){const[u,h]=c==="beforeChildren"?[l,o]:[o,l];return u().then(()=>h())}else return Promise.all([l(),o(n.delay)])}function Sle(t,s,n=0,a=0,i=0,l=1,o){const c=[];for(const d of t.variantChildren)d.notify("AnimationStart",s),c.push(Q_(d,s,{...o,delay:n+(typeof a=="function"?0:a)+rB(t.variantChildren,d,a,i,l)}).then(()=>d.notify("AnimationComplete",s)));return Promise.all(c)}function Cle(t,s,n={}){t.notify("AnimationStart",s);let a;if(Array.isArray(s)){const i=s.map(l=>Q_(t,l,n));a=Promise.all(i)}else if(typeof s=="string")a=Q_(t,s,n);else{const i=typeof s=="function"?qh(t,s,n.custom):s;a=Promise.all(nB(t,i,n))}return a.then(()=>{t.notify("AnimationComplete",s)})}function aB(t,s){if(!Array.isArray(s))return!1;const n=s.length;if(n!==t.length)return!1;for(let a=0;a<n;a++)if(s[a]!==t[a])return!1;return!0}const kle=hk.length;function iB(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?iB(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const s={};for(let n=0;n<kle;n++){const a=hk[n],i=t.props[a];(Jp(i)||i===!1)&&(s[a]=i)}return s}const Ale=[...uk].reverse(),Ele=uk.length;function Tle(t){return s=>Promise.all(s.map(({animation:n,options:a})=>Cle(t,n,a)))}function Ple(t){let s=Tle(t),n=yP(),a=!0;const i=d=>(u,h)=>{var x;const f=qh(t,h,d==="exit"?(x=t.presenceContext)==null?void 0:x.custom:void 0);if(f){const{transition:b,transitionEnd:v,...w}=f;u={...u,...w,...v}}return u};function l(d){s=d(t)}function o(d){const{props:u}=t,h=iB(t.parent)||{},f=[],x=new Set;let b={},v=1/0;for(let _=0;_<Ele;_++){const S=Ale[_],k=n[S],A=u[S]!==void 0?u[S]:h[S],T=Jp(A),P=S===d?k.isActive:null;P===!1&&(v=_);let O=A===h[S]&&A!==u[S]&&T;if(O&&a&&t.manuallyAnimateOnMount&&(O=!1),k.protectedKeys={...b},!k.isActive&&P===null||!A&&!k.prevProp||tv(A)||typeof A=="boolean")continue;const D=Ile(k.prevProp,A);let I=D||S===d&&k.isActive&&!O&&T||_>v&&T,M=!1;const B=Array.isArray(A)?A:[A];let L=B.reduce(i(S),{});P===!1&&(L={});const{prevResolvedValues:F={}}=k,V={...F,...L},$=q=>{I=!0,x.has(q)&&(M=!0,x.delete(q)),k.needsAnimating[q]=!0;const G=t.getValue(q);G&&(G.liveStyle=!1)};for(const q in V){const G=L[q],re=F[q];if(b.hasOwnProperty(q))continue;let ye=!1;Y_(G)&&Y_(re)?ye=!aB(G,re):ye=G!==re,ye?G!=null?$(q):x.add(q):G!==void 0&&x.has(q)?$(q):k.protectedKeys[q]=!0}k.prevProp=A,k.prevResolvedValues=L,k.isActive&&(b={...b,...L}),a&&t.blockInitialAnimation&&(I=!1);const z=O&&D;I&&(!z||M)&&f.push(...B.map(q=>{const G={type:S};if(typeof q=="string"&&a&&!z&&t.manuallyAnimateOnMount&&t.parent){const{parent:re}=t,ye=qh(re,q);if(re.enteringChildren&&ye){const{delayChildren:Ee}=ye.transition||{};G.delay=rB(re.enteringChildren,t,Ee)}}return{animation:q,options:G}}))}if(x.size){const _={};if(typeof u.initial!="boolean"){const S=qh(t,Array.isArray(u.initial)?u.initial[0]:u.initial);S&&S.transition&&(_.transition=S.transition)}x.forEach(S=>{const k=t.getBaseTarget(S),A=t.getValue(S);A&&(A.liveStyle=!0),_[S]=k??null}),f.push({animation:_})}let w=!!f.length;return a&&(u.initial===!1||u.initial===u.animate)&&!t.manuallyAnimateOnMount&&(w=!1),a=!1,w?s(f):Promise.resolve()}function c(d,u){var f;if(n[d].isActive===u)return Promise.resolve();(f=t.variantChildren)==null||f.forEach(x=>{var b;return(b=x.animationState)==null?void 0:b.setActive(d,u)}),n[d].isActive=u;const h=o(d);for(const x in n)n[x].protectedKeys={};return h}return{animateChanges:o,setActive:c,setAnimateFunction:l,getState:()=>n,reset:()=>{n=yP()}}}function Ile(t,s){return typeof s=="string"?s!==t:Array.isArray(s)?!aB(s,t):!1}function Od(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function yP(){return{animate:Od(!0),whileInView:Od(),whileHover:Od(),whileTap:Od(),whileDrag:Od(),whileFocus:Od(),exit:Od()}}class gd{constructor(s){this.isMounted=!1,this.node=s}update(){}}class Mle extends gd{constructor(s){super(s),s.animationState||(s.animationState=Ple(s))}updateAnimationControlsSubscription(){const{animate:s}=this.node.getProps();tv(s)&&(this.unmountControls=s.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:s}=this.node.getProps(),{animate:n}=this.node.prevProps||{};s!==n&&this.updateAnimationControlsSubscription()}unmount(){var s;this.node.animationState.reset(),(s=this.unmountControls)==null||s.call(this)}}let Dle=0;class Ole extends gd{constructor(){super(...arguments),this.id=Dle++}update(){if(!this.node.presenceContext)return;const{isPresent:s,onExitComplete:n}=this.node.presenceContext,{isPresent:a}=this.node.prevPresenceContext||{};if(!this.node.animationState||s===a)return;const i=this.node.animationState.setActive("exit",!s);n&&!s&&i.then(()=>{n(this.id)})}mount(){const{register:s,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),s&&(this.unmount=s(this.id))}unmount(){}}const Rle={animation:{Feature:Mle},exit:{Feature:Ole}};function tx(t,s,n,a={passive:!0}){return t.addEventListener(s,n,a),()=>t.removeEventListener(s,n)}function qx(t){return{point:{x:t.pageX,y:t.pageY}}}const Lle=t=>s=>ck(s)&&t(s,qx(s));function fp(t,s,n,a){return tx(t,s,Lle(n),a)}const lB=1e-4,Ble=1-lB,Fle=1+lB,oB=.01,$le=0-oB,zle=0+oB;function ua(t){return t.max-t.min}function Ule(t,s,n){return Math.abs(t-s)<=n}function bP(t,s,n,a=.5){t.origin=a,t.originPoint=hn(s.min,s.max,t.origin),t.scale=ua(n)/ua(s),t.translate=hn(n.min,n.max,t.origin)-t.originPoint,(t.scale>=Ble&&t.scale<=Fle||isNaN(t.scale))&&(t.scale=1),(t.translate>=$le&&t.translate<=zle||isNaN(t.translate))&&(t.translate=0)}function pp(t,s,n,a){bP(t.x,s.x,n.x,a?a.originX:void 0),bP(t.y,s.y,n.y,a?a.originY:void 0)}function vP(t,s,n){t.min=n.min+s.min,t.max=t.min+ua(s)}function Vle(t,s,n){vP(t.x,s.x,n.x),vP(t.y,s.y,n.y)}function NP(t,s,n){t.min=s.min-n.min,t.max=t.min+ua(s)}function xp(t,s,n){NP(t.x,s.x,n.x),NP(t.y,s.y,n.y)}function ki(t){return[t("x"),t("y")]}const cB=({current:t})=>t?t.ownerDocument.defaultView:null,wP=(t,s)=>Math.abs(t-s);function Hle(t,s){const n=wP(t.x,s.x),a=wP(t.y,s.y);return Math.sqrt(n**2+a**2)}class dB{constructor(s,n,{transformPagePoint:a,contextWindow:i=window,dragSnapToOrigin:l=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const x=Vw(this.lastMoveEventInfo,this.history),b=this.startEvent!==null,v=Hle(x.offset,{x:0,y:0})>=this.distanceThreshold;if(!b&&!v)return;const{point:w}=x,{timestamp:_}=Dr;this.history.push({...w,timestamp:_});const{onStart:S,onMove:k}=this.handlers;b||(S&&S(this.lastMoveEvent,x),this.startEvent=this.lastMoveEvent),k&&k(this.lastMoveEvent,x)},this.handlePointerMove=(x,b)=>{this.lastMoveEvent=x,this.lastMoveEventInfo=Uw(b,this.transformPagePoint),tn.update(this.updatePoint,!0)},this.handlePointerUp=(x,b)=>{this.end();const{onEnd:v,onSessionEnd:w,resumeAnimation:_}=this.handlers;if(this.dragSnapToOrigin&&_&&_(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const S=Vw(x.type==="pointercancel"?this.lastMoveEventInfo:Uw(b,this.transformPagePoint),this.history);this.startEvent&&v&&v(x,S),w&&w(x,S)},!ck(s))return;this.dragSnapToOrigin=l,this.handlers=n,this.transformPagePoint=a,this.distanceThreshold=o,this.contextWindow=i||window;const c=qx(s),d=Uw(c,this.transformPagePoint),{point:u}=d,{timestamp:h}=Dr;this.history=[{...u,timestamp:h}];const{onSessionStart:f}=n;f&&f(s,Vw(d,this.history)),this.removeListeners=Vx(fp(this.contextWindow,"pointermove",this.handlePointerMove),fp(this.contextWindow,"pointerup",this.handlePointerUp),fp(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(s){this.handlers=s}end(){this.removeListeners&&this.removeListeners(),rd(this.updatePoint)}}function Uw(t,s){return s?{point:s(t.point)}:t}function jP(t,s){return{x:t.x-s.x,y:t.y-s.y}}function Vw({point:t},s){return{point:t,delta:jP(t,uB(s)),offset:jP(t,Wle(s)),velocity:qle(s,.1)}}function Wle(t){return t[0]}function uB(t){return t[t.length-1]}function qle(t,s){if(t.length<2)return{x:0,y:0};let n=t.length-1,a=null;const i=uB(t);for(;n>=0&&(a=t[n],!(i.timestamp-a.timestamp>so(s)));)n--;if(!a)return{x:0,y:0};const l=Di(i.timestamp-a.timestamp);if(l===0)return{x:0,y:0};const o={x:(i.x-a.x)/l,y:(i.y-a.y)/l};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Gle(t,{min:s,max:n},a){return s!==void 0&&t<s?t=a?hn(s,t,a.min):Math.max(t,s):n!==void 0&&t>n&&(t=a?hn(n,t,a.max):Math.min(t,n)),t}function _P(t,s,n){return{min:s!==void 0?t.min+s:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function Kle(t,{top:s,left:n,bottom:a,right:i}){return{x:_P(t.x,n,i),y:_P(t.y,s,a)}}function SP(t,s){let n=s.min-t.min,a=s.max-t.max;return s.max-s.min<t.max-t.min&&([n,a]=[a,n]),{min:n,max:a}}function Yle(t,s){return{x:SP(t.x,s.x),y:SP(t.y,s.y)}}function Xle(t,s){let n=.5;const a=ua(t),i=ua(s);return i>a?n=Xp(s.min,s.max-a,t.min):a>i&&(n=Xp(t.min,t.max-i,s.min)),Vo(0,1,n)}function Qle(t,s){const n={};return s.min!==void 0&&(n.min=s.min-t.min),s.max!==void 0&&(n.max=s.max-t.min),n}const Z_=.35;function Zle(t=Z_){return t===!1?t=0:t===!0&&(t=Z_),{x:CP(t,"left","right"),y:CP(t,"top","bottom")}}function CP(t,s,n){return{min:kP(t,s),max:kP(t,n)}}function kP(t,s){return typeof t=="number"?t:t[s]||0}const Jle=new WeakMap;class eoe{constructor(s){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Pn(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=s}start(s,{snapToCursor:n=!1,distanceThreshold:a}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const l=f=>{const{dragSnapToOrigin:x}=this.getProps();x?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(qx(f).point)},o=(f,x)=>{const{drag:b,dragPropagation:v,onDragStart:w}=this.getProps();if(b&&!v&&(this.openDragLock&&this.openDragLock(),this.openDragLock=iie(b),!this.openDragLock))return;this.latestPointerEvent=f,this.latestPanInfo=x,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ki(S=>{let k=this.getAxisMotionValue(S).get()||0;if(no.test(k)){const{projection:A}=this.visualElement;if(A&&A.layout){const T=A.layout.layoutBox[S];T&&(k=ua(T)*(parseFloat(k)/100))}}this.originPoint[S]=k}),w&&tn.postRender(()=>w(f,x)),X_(this.visualElement,"transform");const{animationState:_}=this.visualElement;_&&_.setActive("whileDrag",!0)},c=(f,x)=>{this.latestPointerEvent=f,this.latestPanInfo=x;const{dragPropagation:b,dragDirectionLock:v,onDirectionLock:w,onDrag:_}=this.getProps();if(!b&&!this.openDragLock)return;const{offset:S}=x;if(v&&this.currentDirection===null){this.currentDirection=toe(S),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",x.point,S),this.updateAxis("y",x.point,S),this.visualElement.render(),_&&_(f,x)},d=(f,x)=>{this.latestPointerEvent=f,this.latestPanInfo=x,this.stop(f,x),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>ki(f=>{var x;return this.getAnimationState(f)==="paused"&&((x=this.getAxisMotionValue(f).animation)==null?void 0:x.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new dB(s,{onSessionStart:l,onStart:o,onMove:c,onSessionEnd:d,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,distanceThreshold:a,contextWindow:cB(this.visualElement)})}stop(s,n){const a=s||this.latestPointerEvent,i=n||this.latestPanInfo,l=this.isDragging;if(this.cancel(),!l||!i||!a)return;const{velocity:o}=i;this.startAnimation(o);const{onDragEnd:c}=this.getProps();c&&tn.postRender(()=>c(a,i))}cancel(){this.isDragging=!1;const{projection:s,animationState:n}=this.visualElement;s&&(s.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:a}=this.getProps();!a&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(s,n,a){const{drag:i}=this.getProps();if(!a||!Y0(s,i,this.currentDirection))return;const l=this.getAxisMotionValue(s);let o=this.originPoint[s]+a[s];this.constraints&&this.constraints[s]&&(o=Gle(o,this.constraints[s],this.elastic[s])),l.set(o)}resolveConstraints(){var l;const{dragConstraints:s,dragElastic:n}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(l=this.visualElement.projection)==null?void 0:l.layout,i=this.constraints;s&&Ih(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&a?this.constraints=Kle(a.layoutBox,s):this.constraints=!1,this.elastic=Zle(n),i!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&ki(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=Qle(a.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:s,onMeasureDragConstraints:n}=this.getProps();if(!s||!Ih(s))return!1;const a=s.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const l=sle(a,i.root,this.visualElement.getTransformPagePoint());let o=Yle(i.layout.layoutBox,l);if(n){const c=n(Jie(o));this.hasMutatedConstraints=!!c,c&&(o=K9(c))}return o}startAnimation(s){const{drag:n,dragMomentum:a,dragElastic:i,dragTransition:l,dragSnapToOrigin:o,onDragTransitionEnd:c}=this.getProps(),d=this.constraints||{},u=ki(h=>{if(!Y0(h,n,this.currentDirection))return;let f=d&&d[h]||{};o&&(f={min:0,max:0});const x=i?200:1e6,b=i?40:1e7,v={type:"inertia",velocity:a?s[h]:0,bounceStiffness:x,bounceDamping:b,timeConstant:750,restDelta:1,restSpeed:10,...l,...f};return this.startAxisValueAnimation(h,v)});return Promise.all(u).then(c)}startAxisValueAnimation(s,n){const a=this.getAxisMotionValue(s);return X_(this.visualElement,s),a.start(bk(s,a,0,n,this.visualElement,!1))}stopAnimation(){ki(s=>this.getAxisMotionValue(s).stop())}pauseAnimation(){ki(s=>{var n;return(n=this.getAxisMotionValue(s).animation)==null?void 0:n.pause()})}getAnimationState(s){var n;return(n=this.getAxisMotionValue(s).animation)==null?void 0:n.state}getAxisMotionValue(s){const n=`_drag${s.toUpperCase()}`,a=this.visualElement.getProps(),i=a[n];return i||this.visualElement.getValue(s,(a.initial?a.initial[s]:void 0)||0)}snapToCursor(s){ki(n=>{const{drag:a}=this.getProps();if(!Y0(n,a,this.currentDirection))return;const{projection:i}=this.visualElement,l=this.getAxisMotionValue(n);if(i&&i.layout){const{min:o,max:c}=i.layout.layoutBox[n];l.set(s[n]-hn(o,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:s,dragConstraints:n}=this.getProps(),{projection:a}=this.visualElement;if(!Ih(n)||!a||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};ki(o=>{const c=this.getAxisMotionValue(o);if(c&&this.constraints!==!1){const d=c.get();i[o]=Xle({min:d,max:d},this.constraints[o])}});const{transformTemplate:l}=this.visualElement.getProps();this.visualElement.current.style.transform=l?l({},""):"none",a.root&&a.root.updateScroll(),a.updateLayout(),this.resolveConstraints(),ki(o=>{if(!Y0(o,s,null))return;const c=this.getAxisMotionValue(o),{min:d,max:u}=this.constraints[o];c.set(hn(d,u,i[o]))})}addListeners(){if(!this.visualElement.current)return;Jle.set(this.visualElement,this);const s=this.visualElement.current,n=fp(s,"pointerdown",d=>{const{drag:u,dragListener:h=!0}=this.getProps();u&&h&&this.start(d)}),a=()=>{const{dragConstraints:d}=this.getProps();Ih(d)&&d.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,l=i.addEventListener("measure",a);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),tn.read(a);const o=tx(window,"resize",()=>this.scalePositionWithinConstraints()),c=i.addEventListener("didUpdate",({delta:d,hasLayoutChanged:u})=>{this.isDragging&&u&&(ki(h=>{const f=this.getAxisMotionValue(h);f&&(this.originPoint[h]+=d[h].translate,f.set(f.get()+d[h].translate))}),this.visualElement.render())});return()=>{o(),n(),l(),c&&c()}}getProps(){const s=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:a=!1,dragPropagation:i=!1,dragConstraints:l=!1,dragElastic:o=Z_,dragMomentum:c=!0}=s;return{...s,drag:n,dragDirectionLock:a,dragPropagation:i,dragConstraints:l,dragElastic:o,dragMomentum:c}}}function Y0(t,s,n){return(s===!0||s===t)&&(n===null||n===t)}function toe(t,s=10){let n=null;return Math.abs(t.y)>s?n="y":Math.abs(t.x)>s&&(n="x"),n}class soe extends gd{constructor(s){super(s),this.removeGroupControls=Fi,this.removeListeners=Fi,this.controls=new eoe(s)}mount(){const{dragControls:s}=this.node.getProps();s&&(this.removeGroupControls=s.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Fi}unmount(){this.removeGroupControls(),this.removeListeners()}}const AP=t=>(s,n)=>{t&&tn.postRender(()=>t(s,n))};class noe extends gd{constructor(){super(...arguments),this.removePointerDownListener=Fi}onPointerDown(s){this.session=new dB(s,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:cB(this.node)})}createPanHandlers(){const{onPanSessionStart:s,onPanStart:n,onPan:a,onPanEnd:i}=this.node.getProps();return{onSessionStart:AP(s),onStart:AP(n),onMove:a,onEnd:(l,o)=>{delete this.session,i&&tn.postRender(()=>i(l,o))}}}mount(){this.removePointerDownListener=fp(this.node.current,"pointerdown",s=>this.onPointerDown(s))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const cy={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function EP(t,s){return s.max===s.min?0:t/(s.max-s.min)*100}const Ef={correct:(t,s)=>{if(!s.target)return t;if(typeof t=="string")if(Vt.test(t))t=parseFloat(t);else return t;const n=EP(t,s.target.x),a=EP(t,s.target.y);return`${n}% ${a}%`}},roe={correct:(t,{treeScale:s,projectionDelta:n})=>{const a=t,i=ad.parse(t);if(i.length>5)return a;const l=ad.createTransformer(t),o=typeof i[0]!="number"?1:0,c=n.x.scale*s.x,d=n.y.scale*s.y;i[0+o]/=c,i[1+o]/=d;const u=hn(c,d,.5);return typeof i[2+o]=="number"&&(i[2+o]/=u),typeof i[3+o]=="number"&&(i[3+o]/=u),l(i)}};let Hw=!1;class aoe extends y.Component{componentDidMount(){const{visualElement:s,layoutGroup:n,switchLayoutGroup:a,layoutId:i}=this.props,{projection:l}=s;kie(ioe),l&&(n.group&&n.group.add(l),a&&a.register&&i&&a.register(l),Hw&&l.root.didUpdate(),l.addEventListener("animationComplete",()=>{this.safeToRemove()}),l.setOptions({...l.options,onExitComplete:()=>this.safeToRemove()})),cy.hasEverUpdated=!0}getSnapshotBeforeUpdate(s){const{layoutDependency:n,visualElement:a,drag:i,isPresent:l}=this.props,{projection:o}=a;return o&&(o.isPresent=l,Hw=!0,i||s.layoutDependency!==n||n===void 0||s.isPresent!==l?o.willUpdate():this.safeToRemove(),s.isPresent!==l&&(l?o.promote():o.relegate()||tn.postRender(()=>{const c=o.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:s}=this.props.visualElement;s&&(s.root.didUpdate(),ok.postRender(()=>{!s.currentAnimation&&s.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:s,layoutGroup:n,switchLayoutGroup:a}=this.props,{projection:i}=s;Hw=!0,i&&(i.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(i),a&&a.deregister&&a.deregister(i))}safeToRemove(){const{safeToRemove:s}=this.props;s&&s()}render(){return null}}function hB(t){const[s,n]=D9(),a=y.useContext($3);return r.jsx(aoe,{...t,layoutGroup:a,switchLayoutGroup:y.useContext(q9),isPresent:s,safeToRemove:n})}const ioe={borderRadius:{...Ef,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ef,borderTopRightRadius:Ef,borderBottomLeftRadius:Ef,borderBottomRightRadius:Ef,boxShadow:roe};function loe(t,s,n){const a=Kr(t)?t:um(t);return a.start(bk("",a,s,n)),a.animation}const ooe=(t,s)=>t.depth-s.depth;class coe{constructor(){this.children=[],this.isDirty=!1}add(s){V3(this.children,s),this.isDirty=!0}remove(s){H3(this.children,s),this.isDirty=!0}forEach(s){this.isDirty&&this.children.sort(ooe),this.isDirty=!1,this.children.forEach(s)}}function doe(t,s){const n=Ta.now(),a=({timestamp:i})=>{const l=i-n;l>=s&&(rd(a),t(l-s))};return tn.setup(a,!0),()=>rd(a)}const mB=["TopLeft","TopRight","BottomLeft","BottomRight"],uoe=mB.length,TP=t=>typeof t=="string"?parseFloat(t):t,PP=t=>typeof t=="number"||Vt.test(t);function hoe(t,s,n,a,i,l){i?(t.opacity=hn(0,n.opacity??1,moe(a)),t.opacityExit=hn(s.opacity??1,0,foe(a))):l&&(t.opacity=hn(s.opacity??1,n.opacity??1,a));for(let o=0;o<uoe;o++){const c=`border${mB[o]}Radius`;let d=IP(s,c),u=IP(n,c);if(d===void 0&&u===void 0)continue;d||(d=0),u||(u=0),d===0||u===0||PP(d)===PP(u)?(t[c]=Math.max(hn(TP(d),TP(u),a),0),(no.test(u)||no.test(d))&&(t[c]+="%")):t[c]=u}(s.rotate||n.rotate)&&(t.rotate=hn(s.rotate||0,n.rotate||0,a))}function IP(t,s){return t[s]!==void 0?t[s]:t.borderRadius}const moe=fB(0,.5,e9),foe=fB(.5,.95,Fi);function fB(t,s,n){return a=>a<t?0:a>s?1:n(Xp(t,s,a))}function MP(t,s){t.min=s.min,t.max=s.max}function ji(t,s){MP(t.x,s.x),MP(t.y,s.y)}function DP(t,s){t.translate=s.translate,t.scale=s.scale,t.originPoint=s.originPoint,t.origin=s.origin}function OP(t,s,n,a,i){return t-=s,t=l1(t,1/n,a),i!==void 0&&(t=l1(t,1/i,a)),t}function poe(t,s=0,n=1,a=.5,i,l=t,o=t){if(no.test(s)&&(s=parseFloat(s),s=hn(o.min,o.max,s/100)-o.min),typeof s!="number")return;let c=hn(l.min,l.max,a);t===l&&(c-=s),t.min=OP(t.min,s,n,c,i),t.max=OP(t.max,s,n,c,i)}function RP(t,s,[n,a,i],l,o){poe(t,s[n],s[a],s[i],s.scale,l,o)}const xoe=["x","scaleX","originX"],goe=["y","scaleY","originY"];function LP(t,s,n,a){RP(t.x,s,xoe,n?n.x:void 0,a?a.x:void 0),RP(t.y,s,goe,n?n.y:void 0,a?a.y:void 0)}function BP(t){return t.translate===0&&t.scale===1}function pB(t){return BP(t.x)&&BP(t.y)}function FP(t,s){return t.min===s.min&&t.max===s.max}function yoe(t,s){return FP(t.x,s.x)&&FP(t.y,s.y)}function $P(t,s){return Math.round(t.min)===Math.round(s.min)&&Math.round(t.max)===Math.round(s.max)}function xB(t,s){return $P(t.x,s.x)&&$P(t.y,s.y)}function zP(t){return ua(t.x)/ua(t.y)}function UP(t,s){return t.translate===s.translate&&t.scale===s.scale&&t.originPoint===s.originPoint}class boe{constructor(){this.members=[]}add(s){V3(this.members,s),s.scheduleRender()}remove(s){if(H3(this.members,s),s===this.prevLead&&(this.prevLead=void 0),s===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(s){const n=this.members.findIndex(i=>s===i);if(n===0)return!1;let a;for(let i=n;i>=0;i--){const l=this.members[i];if(l.isPresent!==!1){a=l;break}}return a?(this.promote(a),!0):!1}promote(s,n){const a=this.lead;if(s!==a&&(this.prevLead=a,this.lead=s,s.show(),a)){a.instance&&a.scheduleRender(),s.scheduleRender(),s.resumeFrom=a,n&&(s.resumeFrom.preserveOpacity=!0),a.snapshot&&(s.snapshot=a.snapshot,s.snapshot.latestValues=a.animationValues||a.latestValues),s.root&&s.root.isUpdating&&(s.isLayoutDirty=!0);const{crossfade:i}=s.options;i===!1&&a.hide()}}exitAnimationComplete(){this.members.forEach(s=>{const{options:n,resumingFrom:a}=s;n.onExitComplete&&n.onExitComplete(),a&&a.options.onExitComplete&&a.options.onExitComplete()})}scheduleRender(){this.members.forEach(s=>{s.instance&&s.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function voe(t,s,n){let a="";const i=t.x.translate/s.x,l=t.y.translate/s.y,o=(n==null?void 0:n.z)||0;if((i||l||o)&&(a=`translate3d(${i}px, ${l}px, ${o}px) `),(s.x!==1||s.y!==1)&&(a+=`scale(${1/s.x}, ${1/s.y}) `),n){const{transformPerspective:u,rotate:h,rotateX:f,rotateY:x,skewX:b,skewY:v}=n;u&&(a=`perspective(${u}px) ${a}`),h&&(a+=`rotate(${h}deg) `),f&&(a+=`rotateX(${f}deg) `),x&&(a+=`rotateY(${x}deg) `),b&&(a+=`skewX(${b}deg) `),v&&(a+=`skewY(${v}deg) `)}const c=t.x.scale*s.x,d=t.y.scale*s.y;return(c!==1||d!==1)&&(a+=`scale(${c}, ${d})`),a||"none"}const Ww=["","X","Y","Z"],Noe=1e3;let woe=0;function qw(t,s,n,a){const{latestValues:i}=s;i[t]&&(n[t]=i[t],s.setStaticValue(t,0),a&&(a[t]=0))}function gB(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:s}=t.options;if(!s)return;const n=sB(s);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:i,layoutId:l}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",tn,!(i||l))}const{parent:a}=t;a&&!a.hasCheckedOptimisedAppear&&gB(a)}function yB({attachResizeListener:t,defaultParent:s,measureScroll:n,checkIsScrollRoot:a,resetTransform:i}){return class{constructor(o={},c=s==null?void 0:s()){this.id=woe++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(Soe),this.nodes.forEach(Eoe),this.nodes.forEach(Toe),this.nodes.forEach(Coe)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let d=0;d<this.path.length;d++)this.path[d].shouldResetTransform=!0;this.root===this&&(this.nodes=new coe)}addEventListener(o,c){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new G3),this.eventHandlers.get(o).add(c)}notifyListeners(o,...c){const d=this.eventHandlers.get(o);d&&d.notify(...c)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=M9(o)&&!hie(o),this.instance=o;const{layoutId:c,layout:d,visualElement:u}=this.options;if(u&&!u.current&&u.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(d||c)&&(this.isLayoutDirty=!0),t){let h,f=0;const x=()=>this.root.updateBlockedByResize=!1;tn.read(()=>{f=window.innerWidth}),t(o,()=>{const b=window.innerWidth;b!==f&&(f=b,this.root.updateBlockedByResize=!0,h&&h(),h=doe(x,250),cy.hasAnimatedSinceResize&&(cy.hasAnimatedSinceResize=!1,this.nodes.forEach(WP)))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&u&&(c||d)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:f,hasRelativeLayoutChanged:x,layout:b})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const v=this.options.transition||u.getDefaultTransition()||Ooe,{onLayoutAnimationStart:w,onLayoutAnimationComplete:_}=u.getProps(),S=!this.targetLayout||!xB(this.targetLayout,b),k=!f&&x;if(this.options.layoutRoot||this.resumeFrom||k||f&&(S||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const A={...ik(v,"layout"),onPlay:w,onComplete:_};(u.shouldReduceMotion||this.options.layoutRoot)&&(A.delay=0,A.type=!1),this.startAnimation(A),this.setAnimationOrigin(h,k)}else f||WP(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=b})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),rd(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Poe),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&gB(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const f=this.path[h];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:c,layout:d}=this.options;if(c===void 0&&!d)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(VP);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(HP);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(Aoe),this.nodes.forEach(joe),this.nodes.forEach(_oe)):this.nodes.forEach(HP),this.clearAllSnapshots();const c=Ta.now();Dr.delta=Vo(0,1e3/60,c-Dr.timestamp),Dr.timestamp=c,Dr.isProcessing=!0,Dw.update.process(Dr),Dw.preRender.process(Dr),Dw.render.process(Dr),Dr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,ok.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(koe),this.sharedNodes.forEach(Ioe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,tn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){tn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!ua(this.snapshot.measuredBox.x)&&!ua(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let d=0;d<this.path.length;d++)this.path[d].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Pn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(c=!1),c&&this.instance){const d=a(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:d,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:d}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!pB(this.projectionDelta),d=this.getTransformTemplate(),u=d?d(this.latestValues,""):void 0,h=u!==this.prevTransformTemplateValue;o&&this.instance&&(c||$d(this.latestValues)||h)&&(i(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const c=this.measurePageBox();let d=this.removeElementScroll(c);return o&&(d=this.removeTransform(d)),Roe(d),{animationId:this.root.animationId,measuredBox:c,layoutBox:d,latestValues:{},source:this.id}}measurePageBox(){var u;const{visualElement:o}=this.options;if(!o)return Pn();const c=o.measureViewportBox();if(!(((u=this.scroll)==null?void 0:u.wasRoot)||this.path.some(Loe))){const{scroll:h}=this.root;h&&(Mh(c.x,h.offset.x),Mh(c.y,h.offset.y))}return c}removeElementScroll(o){var d;const c=Pn();if(ji(c,o),(d=this.scroll)!=null&&d.wasRoot)return c;for(let u=0;u<this.path.length;u++){const h=this.path[u],{scroll:f,options:x}=h;h!==this.root&&f&&x.layoutScroll&&(f.wasRoot&&ji(c,o),Mh(c.x,f.offset.x),Mh(c.y,f.offset.y))}return c}applyTransform(o,c=!1){const d=Pn();ji(d,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];!c&&h.options.layoutScroll&&h.scroll&&h!==h.root&&Dh(d,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),$d(h.latestValues)&&Dh(d,h.latestValues)}return $d(this.latestValues)&&Dh(d,this.latestValues),d}removeTransform(o){const c=Pn();ji(c,o);for(let d=0;d<this.path.length;d++){const u=this.path[d];if(!u.instance||!$d(u.latestValues))continue;q_(u.latestValues)&&u.updateSnapshot();const h=Pn(),f=u.measurePageBox();ji(h,f),LP(c,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,h)}return $d(this.latestValues)&&LP(c,this.latestValues),c}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Dr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var x;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==c;if(!(o||d&&this.isSharedProjectionDirty||this.isProjectionDirty||(x=this.parent)!=null&&x.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:f}=this.options;if(!(!this.layout||!(h||f))){if(this.resolvedRelativeTargetAt=Dr.timestamp,!this.targetDelta&&!this.relativeTarget){const b=this.getClosestProjectingParent();b&&b.layout&&this.animationProgress!==1?(this.relativeParent=b,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Pn(),this.relativeTargetOrigin=Pn(),xp(this.relativeTargetOrigin,this.layout.layoutBox,b.layout.layoutBox),ji(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Pn(),this.targetWithTransforms=Pn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Vle(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ji(this.target,this.layout.layoutBox),X9(this.target,this.targetDelta)):ji(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const b=this.getClosestProjectingParent();b&&!!b.resumingFrom==!!this.resumingFrom&&!b.options.layoutScroll&&b.target&&this.animationProgress!==1?(this.relativeParent=b,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Pn(),this.relativeTargetOrigin=Pn(),xp(this.relativeTargetOrigin,this.target,b.target),ji(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||q_(this.parent.latestValues)||Y9(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var v;const o=this.getLead(),c=!!this.resumingFrom||this!==o;let d=!0;if((this.isProjectionDirty||(v=this.parent)!=null&&v.isProjectionDirty)&&(d=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===Dr.timestamp&&(d=!1),d)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;ji(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,x=this.treeScale.y;tle(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Pn());const{target:b}=o;if(!b){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(DP(this.prevProjectionDelta.x,this.projectionDelta.x),DP(this.prevProjectionDelta.y,this.projectionDelta.y)),pp(this.projectionDelta,this.layoutCorrected,b,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==x||!UP(this.projectionDelta.x,this.prevProjectionDelta.x)||!UP(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",b))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var c;if((c=this.options.visualElement)==null||c.scheduleRender(),o){const d=this.getStack();d&&d.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Oh(),this.projectionDelta=Oh(),this.projectionDeltaWithTransform=Oh()}setAnimationOrigin(o,c=!1){const d=this.snapshot,u=d?d.latestValues:{},h={...this.latestValues},f=Oh();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const x=Pn(),b=d?d.source:void 0,v=this.layout?this.layout.source:void 0,w=b!==v,_=this.getStack(),S=!_||_.members.length<=1,k=!!(w&&!S&&this.options.crossfade===!0&&!this.path.some(Doe));this.animationProgress=0;let A;this.mixTargetDelta=T=>{const P=T/1e3;qP(f.x,o.x,P),qP(f.y,o.y,P),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(xp(x,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Moe(this.relativeTarget,this.relativeTargetOrigin,x,P),A&&yoe(this.relativeTarget,A)&&(this.isProjectionDirty=!1),A||(A=Pn()),ji(A,this.relativeTarget)),w&&(this.animationValues=h,hoe(h,u,this.latestValues,P,k,S)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=P},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){var c,d,u;this.notifyListeners("animationStart"),(c=this.currentAnimation)==null||c.stop(),(u=(d=this.resumingFrom)==null?void 0:d.currentAnimation)==null||u.stop(),this.pendingAnimation&&(rd(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=tn.update(()=>{cy.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=um(0)),this.currentAnimation=loe(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:h=>{this.mixTargetDelta(h),o.onUpdate&&o.onUpdate(h)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Noe),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:c,target:d,layout:u,latestValues:h}=o;if(!(!c||!d||!u)){if(this!==o&&this.layout&&u&&bB(this.options.animationType,this.layout.layoutBox,u.layoutBox)){d=this.target||Pn();const f=ua(this.layout.layoutBox.x);d.x.min=o.target.x.min,d.x.max=d.x.min+f;const x=ua(this.layout.layoutBox.y);d.y.min=o.target.y.min,d.y.max=d.y.min+x}ji(c,d),Dh(c,h),pp(this.projectionDeltaWithTransform,this.layoutCorrected,c,h)}}registerSharedNode(o,c){this.sharedNodes.has(o)||this.sharedNodes.set(o,new boe),this.sharedNodes.get(o).add(c);const u=c.options.initialPromotionConfig;c.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(c):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var c;const{layoutId:o}=this.options;return o?((c=this.getStack())==null?void 0:c.lead)||this:this}getPrevLead(){var c;const{layoutId:o}=this.options;return o?(c=this.getStack())==null?void 0:c.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:c,preserveFollowOpacity:d}={}){const u=this.getStack();u&&u.promote(this,d),o&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let c=!1;const{latestValues:d}=o;if((d.z||d.rotate||d.rotateX||d.rotateY||d.rotateZ||d.skewX||d.skewY)&&(c=!0),!c)return;const u={};d.z&&qw("z",o,u,this.animationValues);for(let h=0;h<Ww.length;h++)qw(`rotate${Ww[h]}`,o,u,this.animationValues),qw(`skew${Ww[h]}`,o,u,this.animationValues);o.render();for(const h in u)o.setStaticValue(h,u[h]),this.animationValues&&(this.animationValues[h]=u[h]);o.scheduleRender()}applyProjectionStyles(o,c){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const d=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=oy(c==null?void 0:c.pointerEvents)||"",o.transform=d?d(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=oy(c==null?void 0:c.pointerEvents)||""),this.hasProjected&&!$d(this.latestValues)&&(o.transform=d?d({},""):"none",this.hasProjected=!1);return}o.visibility="";const h=u.animationValues||u.latestValues;this.applyTransformsToTarget();let f=voe(this.projectionDeltaWithTransform,this.treeScale,h);d&&(f=d(h,f)),o.transform=f;const{x,y:b}=this.projectionDelta;o.transformOrigin=`${x.origin*100}% ${b.origin*100}% 0`,u.animationValues?o.opacity=u===this?h.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:o.opacity=u===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const v in ex){if(h[v]===void 0)continue;const{correct:w,applyTo:_,isCSSVariable:S}=ex[v],k=f==="none"?h[v]:w(h[v],u);if(_){const A=_.length;for(let T=0;T<A;T++)o[_[T]]=k}else S?this.options.visualElement.renderState.vars[v]=k:o[v]=k}this.options.layoutId&&(o.pointerEvents=u===this?oy(c==null?void 0:c.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var c;return(c=o.currentAnimation)==null?void 0:c.stop()}),this.root.nodes.forEach(VP),this.root.sharedNodes.clear()}}}function joe(t){t.updateLayout()}function _oe(t){var n;const s=((n=t.resumeFrom)==null?void 0:n.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&s&&t.hasListeners("didUpdate")){const{layoutBox:a,measuredBox:i}=t.layout,{animationType:l}=t.options,o=s.source!==t.layout.source;l==="size"?ki(f=>{const x=o?s.measuredBox[f]:s.layoutBox[f],b=ua(x);x.min=a[f].min,x.max=x.min+b}):bB(l,s.layoutBox,a)&&ki(f=>{const x=o?s.measuredBox[f]:s.layoutBox[f],b=ua(a[f]);x.max=x.min+b,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[f].max=t.relativeTarget[f].min+b)});const c=Oh();pp(c,a,s.layoutBox);const d=Oh();o?pp(d,t.applyTransform(i,!0),s.measuredBox):pp(d,a,s.layoutBox);const u=!pB(c);let h=!1;if(!t.resumeFrom){const f=t.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:x,layout:b}=f;if(x&&b){const v=Pn();xp(v,s.layoutBox,x.layoutBox);const w=Pn();xp(w,a,b.layoutBox),xB(v,w)||(h=!0),f.options.layoutRoot&&(t.relativeTarget=w,t.relativeTargetOrigin=v,t.relativeParent=f)}}}t.notifyListeners("didUpdate",{layout:a,snapshot:s,delta:d,layoutDelta:c,hasLayoutChanged:u,hasRelativeLayoutChanged:h})}else if(t.isLead()){const{onExitComplete:a}=t.options;a&&a()}t.options.transition=void 0}function Soe(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Coe(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function koe(t){t.clearSnapshot()}function VP(t){t.clearMeasurements()}function HP(t){t.isLayoutDirty=!1}function Aoe(t){const{visualElement:s}=t.options;s&&s.getProps().onBeforeLayoutMeasure&&s.notify("BeforeLayoutMeasure"),t.resetTransform()}function WP(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function Eoe(t){t.resolveTargetDelta()}function Toe(t){t.calcProjection()}function Poe(t){t.resetSkewAndRotation()}function Ioe(t){t.removeLeadSnapshot()}function qP(t,s,n){t.translate=hn(s.translate,0,n),t.scale=hn(s.scale,1,n),t.origin=s.origin,t.originPoint=s.originPoint}function GP(t,s,n,a){t.min=hn(s.min,n.min,a),t.max=hn(s.max,n.max,a)}function Moe(t,s,n,a){GP(t.x,s.x,n.x,a),GP(t.y,s.y,n.y,a)}function Doe(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const Ooe={duration:.45,ease:[.4,0,.1,1]},KP=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),YP=KP("applewebkit/")&&!KP("chrome/")?Math.round:Fi;function XP(t){t.min=YP(t.min),t.max=YP(t.max)}function Roe(t){XP(t.x),XP(t.y)}function bB(t,s,n){return t==="position"||t==="preserve-aspect"&&!Ule(zP(s),zP(n),.2)}function Loe(t){var s;return t!==t.root&&((s=t.scroll)==null?void 0:s.wasRoot)}const Boe=yB({attachResizeListener:(t,s)=>tx(t,"resize",s),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Gw={current:void 0},vB=yB({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Gw.current){const t=new Boe({});t.mount(window),t.setOptions({layoutScroll:!0}),Gw.current=t}return Gw.current},resetTransform:(t,s)=>{t.style.transform=s!==void 0?s:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),Foe={pan:{Feature:noe},drag:{Feature:soe,ProjectionNode:vB,MeasureLayout:hB}};function QP(t,s,n){const{props:a}=t;t.animationState&&a.whileHover&&t.animationState.setActive("whileHover",n==="Start");const i="onHover"+n,l=a[i];l&&tn.postRender(()=>l(s,qx(s)))}class $oe extends gd{mount(){const{current:s}=this.node;s&&(this.unmount=lie(s,(n,a)=>(QP(this.node,a,"Start"),i=>QP(this.node,i,"End"))))}unmount(){}}class zoe extends gd{constructor(){super(...arguments),this.isActive=!1}onFocus(){let s=!1;try{s=this.node.current.matches(":focus-visible")}catch{s=!0}!s||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Vx(tx(this.node.current,"focus",()=>this.onFocus()),tx(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function ZP(t,s,n){const{props:a}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&a.whileTap&&t.animationState.setActive("whileTap",n==="Start");const i="onTap"+(n==="End"?"":n),l=a[i];l&&tn.postRender(()=>l(s,qx(s)))}class Uoe extends gd{mount(){const{current:s}=this.node;s&&(this.unmount=uie(s,(n,a)=>(ZP(this.node,a,"Start"),(i,{success:l})=>ZP(this.node,i,l?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const J_=new WeakMap,Kw=new WeakMap,Voe=t=>{const s=J_.get(t.target);s&&s(t)},Hoe=t=>{t.forEach(Voe)};function Woe({root:t,...s}){const n=t||document;Kw.has(n)||Kw.set(n,{});const a=Kw.get(n),i=JSON.stringify(s);return a[i]||(a[i]=new IntersectionObserver(Hoe,{root:t,...s})),a[i]}function qoe(t,s,n){const a=Woe(s);return J_.set(t,n),a.observe(t),()=>{J_.delete(t),a.unobserve(t)}}const Goe={some:0,all:1};class Koe extends gd{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:s={}}=this.node.getProps(),{root:n,margin:a,amount:i="some",once:l}=s,o={root:n?n.current:void 0,rootMargin:a,threshold:typeof i=="number"?i:Goe[i]},c=d=>{const{isIntersecting:u}=d;if(this.isInView===u||(this.isInView=u,l&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:h,onViewportLeave:f}=this.node.getProps(),x=u?h:f;x&&x(d)};return qoe(this.node.current,o,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:s,prevProps:n}=this.node;["amount","margin","root"].some(Yoe(s,n))&&this.startObserver()}unmount(){}}function Yoe({viewport:t={}},{viewport:s={}}={}){return n=>t[n]!==s[n]}const Xoe={inView:{Feature:Koe},tap:{Feature:Uoe},focus:{Feature:zoe},hover:{Feature:$oe}},Qoe={layout:{ProjectionNode:vB,MeasureLayout:hB}},Zoe={...Rle,...Xoe,...Foe,...Qoe},at=Zie(Zoe,ule);function nv(t){const s=cr(d=>d.modules)||{},n=cr(d=>d.user),a=(n==null?void 0:n.is_admin)&&Object.keys(s).length===0,i=s[t]||[],l=y.useMemo(()=>new Set(i.map(d=>d.code.split(".").pop())),[i]),o=a||i.length>0,c=d=>a||l.has(d);return{hasAny:o,canView:c("view"),canCreate:c("create"),canUpdate:c("update"),canDelete:c("delete")}}function NB(t){var s,n,a="";if(typeof t=="string"||typeof t=="number")a+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(s=0;s<i;s++)t[s]&&(n=NB(t[s]))&&(a&&(a+=" "),a+=n)}else for(n in t)t[n]&&(a&&(a+=" "),a+=n);return a}function vs(){for(var t,s,n=0,a="",i=arguments.length;n<i;n++)(t=arguments[n])&&(s=NB(t))&&(a&&(a+=" "),a+=s);return a}const vk="-",Joe=t=>{const s=tce(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:a}=t;return{getClassGroupId:o=>{const c=o.split(vk);return c[0]===""&&c.length!==1&&c.shift(),wB(c,s)||ece(o)},getConflictingClassGroupIds:(o,c)=>{const d=n[o]||[];return c&&a[o]?[...d,...a[o]]:d}}},wB=(t,s)=>{var o;if(t.length===0)return s.classGroupId;const n=t[0],a=s.nextPart.get(n),i=a?wB(t.slice(1),a):void 0;if(i)return i;if(s.validators.length===0)return;const l=t.join(vk);return(o=s.validators.find(({validator:c})=>c(l)))==null?void 0:o.classGroupId},JP=/^\[(.+)\]$/,ece=t=>{if(JP.test(t)){const s=JP.exec(t)[1],n=s==null?void 0:s.substring(0,s.indexOf(":"));if(n)return"arbitrary.."+n}},tce=t=>{const{theme:s,classGroups:n}=t,a={nextPart:new Map,validators:[]};for(const i in n)eS(n[i],a,i,s);return a},eS=(t,s,n,a)=>{t.forEach(i=>{if(typeof i=="string"){const l=i===""?s:eI(s,i);l.classGroupId=n;return}if(typeof i=="function"){if(sce(i)){eS(i(a),s,n,a);return}s.validators.push({validator:i,classGroupId:n});return}Object.entries(i).forEach(([l,o])=>{eS(o,eI(s,l),n,a)})})},eI=(t,s)=>{let n=t;return s.split(vk).forEach(a=>{n.nextPart.has(a)||n.nextPart.set(a,{nextPart:new Map,validators:[]}),n=n.nextPart.get(a)}),n},sce=t=>t.isThemeGetter,nce=t=>{if(t<1)return{get:()=>{},set:()=>{}};let s=0,n=new Map,a=new Map;const i=(l,o)=>{n.set(l,o),s++,s>t&&(s=0,a=n,n=new Map)};return{get(l){let o=n.get(l);if(o!==void 0)return o;if((o=a.get(l))!==void 0)return i(l,o),o},set(l,o){n.has(l)?n.set(l,o):i(l,o)}}},tS="!",sS=":",rce=sS.length,ace=t=>{const{prefix:s,experimentalParseClassName:n}=t;let a=i=>{const l=[];let o=0,c=0,d=0,u;for(let v=0;v<i.length;v++){let w=i[v];if(o===0&&c===0){if(w===sS){l.push(i.slice(d,v)),d=v+rce;continue}if(w==="/"){u=v;continue}}w==="["?o++:w==="]"?o--:w==="("?c++:w===")"&&c--}const h=l.length===0?i:i.substring(d),f=ice(h),x=f!==h,b=u&&u>d?u-d:void 0;return{modifiers:l,hasImportantModifier:x,baseClassName:f,maybePostfixModifierPosition:b}};if(s){const i=s+sS,l=a;a=o=>o.startsWith(i)?l(o.substring(i.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:o,maybePostfixModifierPosition:void 0}}if(n){const i=a;a=l=>n({className:l,parseClassName:i})}return a},ice=t=>t.endsWith(tS)?t.substring(0,t.length-1):t.startsWith(tS)?t.substring(1):t,lce=t=>{const s=Object.fromEntries(t.orderSensitiveModifiers.map(a=>[a,!0]));return a=>{if(a.length<=1)return a;const i=[];let l=[];return a.forEach(o=>{o[0]==="["||s[o]?(i.push(...l.sort(),o),l=[]):l.push(o)}),i.push(...l.sort()),i}},oce=t=>({cache:nce(t.cacheSize),parseClassName:ace(t),sortModifiers:lce(t),...Joe(t)}),cce=/\s+/,dce=(t,s)=>{const{parseClassName:n,getClassGroupId:a,getConflictingClassGroupIds:i,sortModifiers:l}=s,o=[],c=t.trim().split(cce);let d="";for(let u=c.length-1;u>=0;u-=1){const h=c[u],{isExternal:f,modifiers:x,hasImportantModifier:b,baseClassName:v,maybePostfixModifierPosition:w}=n(h);if(f){d=h+(d.length>0?" "+d:d);continue}let _=!!w,S=a(_?v.substring(0,w):v);if(!S){if(!_){d=h+(d.length>0?" "+d:d);continue}if(S=a(v),!S){d=h+(d.length>0?" "+d:d);continue}_=!1}const k=l(x).join(":"),A=b?k+tS:k,T=A+S;if(o.includes(T))continue;o.push(T);const P=i(S,_);for(let O=0;O<P.length;++O){const D=P[O];o.push(A+D)}d=h+(d.length>0?" "+d:d)}return d};function uce(){let t=0,s,n,a="";for(;t<arguments.length;)(s=arguments[t++])&&(n=jB(s))&&(a&&(a+=" "),a+=n);return a}const jB=t=>{if(typeof t=="string")return t;let s,n="";for(let a=0;a<t.length;a++)t[a]&&(s=jB(t[a]))&&(n&&(n+=" "),n+=s);return n};function hce(t,...s){let n,a,i,l=o;function o(d){const u=s.reduce((h,f)=>f(h),t());return n=oce(u),a=n.cache.get,i=n.cache.set,l=c,c(d)}function c(d){const u=a(d);if(u)return u;const h=dce(d,n);return i(d,h),h}return function(){return l(uce.apply(null,arguments))}}const Zn=t=>{const s=n=>n[t]||[];return s.isThemeGetter=!0,s},_B=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,SB=/^\((?:(\w[\w-]*):)?(.+)\)$/i,mce=/^\d+\/\d+$/,fce=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,pce=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,xce=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,gce=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,yce=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,lh=t=>mce.test(t),ss=t=>!!t&&!Number.isNaN(Number(t)),pc=t=>!!t&&Number.isInteger(Number(t)),Yw=t=>t.endsWith("%")&&ss(t.slice(0,-1)),vo=t=>fce.test(t),bce=()=>!0,vce=t=>pce.test(t)&&!xce.test(t),CB=()=>!1,Nce=t=>gce.test(t),wce=t=>yce.test(t),jce=t=>!Nt(t)&&!wt(t),_ce=t=>Fm(t,EB,CB),Nt=t=>_B.test(t),Rd=t=>Fm(t,TB,vce),Xw=t=>Fm(t,Ece,ss),tI=t=>Fm(t,kB,CB),Sce=t=>Fm(t,AB,wce),X0=t=>Fm(t,PB,Nce),wt=t=>SB.test(t),Tf=t=>$m(t,TB),Cce=t=>$m(t,Tce),sI=t=>$m(t,kB),kce=t=>$m(t,EB),Ace=t=>$m(t,AB),Q0=t=>$m(t,PB,!0),Fm=(t,s,n)=>{const a=_B.exec(t);return a?a[1]?s(a[1]):n(a[2]):!1},$m=(t,s,n=!1)=>{const a=SB.exec(t);return a?a[1]?s(a[1]):n:!1},kB=t=>t==="position"||t==="percentage",AB=t=>t==="image"||t==="url",EB=t=>t==="length"||t==="size"||t==="bg-size",TB=t=>t==="length",Ece=t=>t==="number",Tce=t=>t==="family-name",PB=t=>t==="shadow",Pce=()=>{const t=Zn("color"),s=Zn("font"),n=Zn("text"),a=Zn("font-weight"),i=Zn("tracking"),l=Zn("leading"),o=Zn("breakpoint"),c=Zn("container"),d=Zn("spacing"),u=Zn("radius"),h=Zn("shadow"),f=Zn("inset-shadow"),x=Zn("text-shadow"),b=Zn("drop-shadow"),v=Zn("blur"),w=Zn("perspective"),_=Zn("aspect"),S=Zn("ease"),k=Zn("animate"),A=()=>["auto","avoid","all","avoid-page","page","left","right","column"],T=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],P=()=>[...T(),wt,Nt],O=()=>["auto","hidden","clip","visible","scroll"],D=()=>["auto","contain","none"],I=()=>[wt,Nt,d],M=()=>[lh,"full","auto",...I()],B=()=>[pc,"none","subgrid",wt,Nt],L=()=>["auto",{span:["full",pc,wt,Nt]},pc,wt,Nt],F=()=>[pc,"auto",wt,Nt],V=()=>["auto","min","max","fr",wt,Nt],$=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],z=()=>["start","end","center","stretch","center-safe","end-safe"],H=()=>["auto",...I()],q=()=>[lh,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...I()],G=()=>[t,wt,Nt],re=()=>[...T(),sI,tI,{position:[wt,Nt]}],ye=()=>["no-repeat",{repeat:["","x","y","space","round"]}],Ee=()=>["auto","cover","contain",kce,_ce,{size:[wt,Nt]}],ee=()=>[Yw,Tf,Rd],te=()=>["","none","full",u,wt,Nt],ce=()=>["",ss,Tf,Rd],ge=()=>["solid","dashed","dotted","double"],X=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],de=()=>[ss,Yw,sI,tI],Ce=()=>["","none",v,wt,Nt],ue=()=>["none",ss,wt,Nt],fe=()=>["none",ss,wt,Nt],pe=()=>[ss,wt,Nt],oe=()=>[lh,"full",...I()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[vo],breakpoint:[vo],color:[bce],container:[vo],"drop-shadow":[vo],ease:["in","out","in-out"],font:[jce],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[vo],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[vo],shadow:[vo],spacing:["px",ss],text:[vo],"text-shadow":[vo],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",lh,Nt,wt,_]}],container:["container"],columns:[{columns:[ss,Nt,wt,c]}],"break-after":[{"break-after":A()}],"break-before":[{"break-before":A()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:P()}],overflow:[{overflow:O()}],"overflow-x":[{"overflow-x":O()}],"overflow-y":[{"overflow-y":O()}],overscroll:[{overscroll:D()}],"overscroll-x":[{"overscroll-x":D()}],"overscroll-y":[{"overscroll-y":D()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:M()}],"inset-x":[{"inset-x":M()}],"inset-y":[{"inset-y":M()}],start:[{start:M()}],end:[{end:M()}],top:[{top:M()}],right:[{right:M()}],bottom:[{bottom:M()}],left:[{left:M()}],visibility:["visible","invisible","collapse"],z:[{z:[pc,"auto",wt,Nt]}],basis:[{basis:[lh,"full","auto",c,...I()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[ss,lh,"auto","initial","none",Nt]}],grow:[{grow:["",ss,wt,Nt]}],shrink:[{shrink:["",ss,wt,Nt]}],order:[{order:[pc,"first","last","none",wt,Nt]}],"grid-cols":[{"grid-cols":B()}],"col-start-end":[{col:L()}],"col-start":[{"col-start":F()}],"col-end":[{"col-end":F()}],"grid-rows":[{"grid-rows":B()}],"row-start-end":[{row:L()}],"row-start":[{"row-start":F()}],"row-end":[{"row-end":F()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":V()}],"auto-rows":[{"auto-rows":V()}],gap:[{gap:I()}],"gap-x":[{"gap-x":I()}],"gap-y":[{"gap-y":I()}],"justify-content":[{justify:[...$(),"normal"]}],"justify-items":[{"justify-items":[...z(),"normal"]}],"justify-self":[{"justify-self":["auto",...z()]}],"align-content":[{content:["normal",...$()]}],"align-items":[{items:[...z(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...z(),{baseline:["","last"]}]}],"place-content":[{"place-content":$()}],"place-items":[{"place-items":[...z(),"baseline"]}],"place-self":[{"place-self":["auto",...z()]}],p:[{p:I()}],px:[{px:I()}],py:[{py:I()}],ps:[{ps:I()}],pe:[{pe:I()}],pt:[{pt:I()}],pr:[{pr:I()}],pb:[{pb:I()}],pl:[{pl:I()}],m:[{m:H()}],mx:[{mx:H()}],my:[{my:H()}],ms:[{ms:H()}],me:[{me:H()}],mt:[{mt:H()}],mr:[{mr:H()}],mb:[{mb:H()}],ml:[{ml:H()}],"space-x":[{"space-x":I()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":I()}],"space-y-reverse":["space-y-reverse"],size:[{size:q()}],w:[{w:[c,"screen",...q()]}],"min-w":[{"min-w":[c,"screen","none",...q()]}],"max-w":[{"max-w":[c,"screen","none","prose",{screen:[o]},...q()]}],h:[{h:["screen","lh",...q()]}],"min-h":[{"min-h":["screen","lh","none",...q()]}],"max-h":[{"max-h":["screen","lh",...q()]}],"font-size":[{text:["base",n,Tf,Rd]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[a,wt,Xw]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Yw,Nt]}],"font-family":[{font:[Cce,Nt,s]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,wt,Nt]}],"line-clamp":[{"line-clamp":[ss,"none",wt,Xw]}],leading:[{leading:[l,...I()]}],"list-image":[{"list-image":["none",wt,Nt]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",wt,Nt]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:G()}],"text-color":[{text:G()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ge(),"wavy"]}],"text-decoration-thickness":[{decoration:[ss,"from-font","auto",wt,Rd]}],"text-decoration-color":[{decoration:G()}],"underline-offset":[{"underline-offset":[ss,"auto",wt,Nt]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:I()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",wt,Nt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",wt,Nt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:re()}],"bg-repeat":[{bg:ye()}],"bg-size":[{bg:Ee()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},pc,wt,Nt],radial:["",wt,Nt],conic:[pc,wt,Nt]},Ace,Sce]}],"bg-color":[{bg:G()}],"gradient-from-pos":[{from:ee()}],"gradient-via-pos":[{via:ee()}],"gradient-to-pos":[{to:ee()}],"gradient-from":[{from:G()}],"gradient-via":[{via:G()}],"gradient-to":[{to:G()}],rounded:[{rounded:te()}],"rounded-s":[{"rounded-s":te()}],"rounded-e":[{"rounded-e":te()}],"rounded-t":[{"rounded-t":te()}],"rounded-r":[{"rounded-r":te()}],"rounded-b":[{"rounded-b":te()}],"rounded-l":[{"rounded-l":te()}],"rounded-ss":[{"rounded-ss":te()}],"rounded-se":[{"rounded-se":te()}],"rounded-ee":[{"rounded-ee":te()}],"rounded-es":[{"rounded-es":te()}],"rounded-tl":[{"rounded-tl":te()}],"rounded-tr":[{"rounded-tr":te()}],"rounded-br":[{"rounded-br":te()}],"rounded-bl":[{"rounded-bl":te()}],"border-w":[{border:ce()}],"border-w-x":[{"border-x":ce()}],"border-w-y":[{"border-y":ce()}],"border-w-s":[{"border-s":ce()}],"border-w-e":[{"border-e":ce()}],"border-w-t":[{"border-t":ce()}],"border-w-r":[{"border-r":ce()}],"border-w-b":[{"border-b":ce()}],"border-w-l":[{"border-l":ce()}],"divide-x":[{"divide-x":ce()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":ce()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ge(),"hidden","none"]}],"divide-style":[{divide:[...ge(),"hidden","none"]}],"border-color":[{border:G()}],"border-color-x":[{"border-x":G()}],"border-color-y":[{"border-y":G()}],"border-color-s":[{"border-s":G()}],"border-color-e":[{"border-e":G()}],"border-color-t":[{"border-t":G()}],"border-color-r":[{"border-r":G()}],"border-color-b":[{"border-b":G()}],"border-color-l":[{"border-l":G()}],"divide-color":[{divide:G()}],"outline-style":[{outline:[...ge(),"none","hidden"]}],"outline-offset":[{"outline-offset":[ss,wt,Nt]}],"outline-w":[{outline:["",ss,Tf,Rd]}],"outline-color":[{outline:G()}],shadow:[{shadow:["","none",h,Q0,X0]}],"shadow-color":[{shadow:G()}],"inset-shadow":[{"inset-shadow":["none",f,Q0,X0]}],"inset-shadow-color":[{"inset-shadow":G()}],"ring-w":[{ring:ce()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:G()}],"ring-offset-w":[{"ring-offset":[ss,Rd]}],"ring-offset-color":[{"ring-offset":G()}],"inset-ring-w":[{"inset-ring":ce()}],"inset-ring-color":[{"inset-ring":G()}],"text-shadow":[{"text-shadow":["none",x,Q0,X0]}],"text-shadow-color":[{"text-shadow":G()}],opacity:[{opacity:[ss,wt,Nt]}],"mix-blend":[{"mix-blend":[...X(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":X()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[ss]}],"mask-image-linear-from-pos":[{"mask-linear-from":de()}],"mask-image-linear-to-pos":[{"mask-linear-to":de()}],"mask-image-linear-from-color":[{"mask-linear-from":G()}],"mask-image-linear-to-color":[{"mask-linear-to":G()}],"mask-image-t-from-pos":[{"mask-t-from":de()}],"mask-image-t-to-pos":[{"mask-t-to":de()}],"mask-image-t-from-color":[{"mask-t-from":G()}],"mask-image-t-to-color":[{"mask-t-to":G()}],"mask-image-r-from-pos":[{"mask-r-from":de()}],"mask-image-r-to-pos":[{"mask-r-to":de()}],"mask-image-r-from-color":[{"mask-r-from":G()}],"mask-image-r-to-color":[{"mask-r-to":G()}],"mask-image-b-from-pos":[{"mask-b-from":de()}],"mask-image-b-to-pos":[{"mask-b-to":de()}],"mask-image-b-from-color":[{"mask-b-from":G()}],"mask-image-b-to-color":[{"mask-b-to":G()}],"mask-image-l-from-pos":[{"mask-l-from":de()}],"mask-image-l-to-pos":[{"mask-l-to":de()}],"mask-image-l-from-color":[{"mask-l-from":G()}],"mask-image-l-to-color":[{"mask-l-to":G()}],"mask-image-x-from-pos":[{"mask-x-from":de()}],"mask-image-x-to-pos":[{"mask-x-to":de()}],"mask-image-x-from-color":[{"mask-x-from":G()}],"mask-image-x-to-color":[{"mask-x-to":G()}],"mask-image-y-from-pos":[{"mask-y-from":de()}],"mask-image-y-to-pos":[{"mask-y-to":de()}],"mask-image-y-from-color":[{"mask-y-from":G()}],"mask-image-y-to-color":[{"mask-y-to":G()}],"mask-image-radial":[{"mask-radial":[wt,Nt]}],"mask-image-radial-from-pos":[{"mask-radial-from":de()}],"mask-image-radial-to-pos":[{"mask-radial-to":de()}],"mask-image-radial-from-color":[{"mask-radial-from":G()}],"mask-image-radial-to-color":[{"mask-radial-to":G()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":T()}],"mask-image-conic-pos":[{"mask-conic":[ss]}],"mask-image-conic-from-pos":[{"mask-conic-from":de()}],"mask-image-conic-to-pos":[{"mask-conic-to":de()}],"mask-image-conic-from-color":[{"mask-conic-from":G()}],"mask-image-conic-to-color":[{"mask-conic-to":G()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:re()}],"mask-repeat":[{mask:ye()}],"mask-size":[{mask:Ee()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",wt,Nt]}],filter:[{filter:["","none",wt,Nt]}],blur:[{blur:Ce()}],brightness:[{brightness:[ss,wt,Nt]}],contrast:[{contrast:[ss,wt,Nt]}],"drop-shadow":[{"drop-shadow":["","none",b,Q0,X0]}],"drop-shadow-color":[{"drop-shadow":G()}],grayscale:[{grayscale:["",ss,wt,Nt]}],"hue-rotate":[{"hue-rotate":[ss,wt,Nt]}],invert:[{invert:["",ss,wt,Nt]}],saturate:[{saturate:[ss,wt,Nt]}],sepia:[{sepia:["",ss,wt,Nt]}],"backdrop-filter":[{"backdrop-filter":["","none",wt,Nt]}],"backdrop-blur":[{"backdrop-blur":Ce()}],"backdrop-brightness":[{"backdrop-brightness":[ss,wt,Nt]}],"backdrop-contrast":[{"backdrop-contrast":[ss,wt,Nt]}],"backdrop-grayscale":[{"backdrop-grayscale":["",ss,wt,Nt]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[ss,wt,Nt]}],"backdrop-invert":[{"backdrop-invert":["",ss,wt,Nt]}],"backdrop-opacity":[{"backdrop-opacity":[ss,wt,Nt]}],"backdrop-saturate":[{"backdrop-saturate":[ss,wt,Nt]}],"backdrop-sepia":[{"backdrop-sepia":["",ss,wt,Nt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":I()}],"border-spacing-x":[{"border-spacing-x":I()}],"border-spacing-y":[{"border-spacing-y":I()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",wt,Nt]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[ss,"initial",wt,Nt]}],ease:[{ease:["linear","initial",S,wt,Nt]}],delay:[{delay:[ss,wt,Nt]}],animate:[{animate:["none",k,wt,Nt]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[w,wt,Nt]}],"perspective-origin":[{"perspective-origin":P()}],rotate:[{rotate:ue()}],"rotate-x":[{"rotate-x":ue()}],"rotate-y":[{"rotate-y":ue()}],"rotate-z":[{"rotate-z":ue()}],scale:[{scale:fe()}],"scale-x":[{"scale-x":fe()}],"scale-y":[{"scale-y":fe()}],"scale-z":[{"scale-z":fe()}],"scale-3d":["scale-3d"],skew:[{skew:pe()}],"skew-x":[{"skew-x":pe()}],"skew-y":[{"skew-y":pe()}],transform:[{transform:[wt,Nt,"","none","gpu","cpu"]}],"transform-origin":[{origin:P()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:oe()}],"translate-x":[{"translate-x":oe()}],"translate-y":[{"translate-y":oe()}],"translate-z":[{"translate-z":oe()}],"translate-none":["translate-none"],accent:[{accent:G()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:G()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",wt,Nt]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":I()}],"scroll-mx":[{"scroll-mx":I()}],"scroll-my":[{"scroll-my":I()}],"scroll-ms":[{"scroll-ms":I()}],"scroll-me":[{"scroll-me":I()}],"scroll-mt":[{"scroll-mt":I()}],"scroll-mr":[{"scroll-mr":I()}],"scroll-mb":[{"scroll-mb":I()}],"scroll-ml":[{"scroll-ml":I()}],"scroll-p":[{"scroll-p":I()}],"scroll-px":[{"scroll-px":I()}],"scroll-py":[{"scroll-py":I()}],"scroll-ps":[{"scroll-ps":I()}],"scroll-pe":[{"scroll-pe":I()}],"scroll-pt":[{"scroll-pt":I()}],"scroll-pr":[{"scroll-pr":I()}],"scroll-pb":[{"scroll-pb":I()}],"scroll-pl":[{"scroll-pl":I()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",wt,Nt]}],fill:[{fill:["none",...G()]}],"stroke-w":[{stroke:[ss,Tf,Rd,Xw]}],stroke:[{stroke:["none",...G()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Ice=hce(Pce);function Ft(...t){return Ice(vs(t))}const Ve=y.forwardRef(({className:t,...s},n)=>r.jsx("div",{ref:n,className:Ft("rounded-xl border bg-card text-card-foreground shadow",t),...s}));Ve.displayName="Card";const rt=y.forwardRef(({className:t,...s},n)=>r.jsx("div",{ref:n,className:Ft("flex flex-col space-y-1.5 p-6",t),...s}));rt.displayName="CardHeader";const ot=y.forwardRef(({className:t,...s},n)=>r.jsx("div",{ref:n,className:Ft("font-semibold leading-none tracking-tight",t),...s}));ot.displayName="CardTitle";const vr=y.forwardRef(({className:t,...s},n)=>r.jsx("div",{ref:n,className:Ft("text-sm text-muted-foreground",t),...s}));vr.displayName="CardDescription";const He=y.forwardRef(({className:t,...s},n)=>r.jsx("div",{ref:n,className:Ft("p-6 pt-0",t),...s}));He.displayName="CardContent";const Mce=y.forwardRef(({className:t,...s},n)=>r.jsx("div",{ref:n,className:Ft("flex items-center p-6 pt-0",t),...s}));Mce.displayName="CardFooter";const nI=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,rI=vs,rv=(t,s)=>n=>{var a;if((s==null?void 0:s.variants)==null)return rI(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:i,defaultVariants:l}=s,o=Object.keys(i).map(u=>{const h=n==null?void 0:n[u],f=l==null?void 0:l[u];if(h===null)return null;const x=nI(h)||nI(f);return i[u][x]}),c=n&&Object.entries(n).reduce((u,h)=>{let[f,x]=h;return x===void 0||(u[f]=x),u},{}),d=s==null||(a=s.compoundVariants)===null||a===void 0?void 0:a.reduce((u,h)=>{let{class:f,className:x,...b}=h;return Object.entries(b).every(v=>{let[w,_]=v;return Array.isArray(_)?_.includes({...l,...c}[w]):{...l,...c}[w]===_})?[...u,f,x]:u},[]);return rI(t,o,d,n==null?void 0:n.class,n==null?void 0:n.className)},Dce=rv("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Ze({className:t,variant:s,...n}){return r.jsx("div",{className:Ft(Dce({variant:s}),t),...n})}function aI(t,s){if(typeof t=="function")return t(s);t!=null&&(t.current=s)}function IB(...t){return s=>{let n=!1;const a=t.map(i=>{const l=aI(i,s);return!n&&typeof l=="function"&&(n=!0),l});if(n)return()=>{for(let i=0;i<a.length;i++){const l=a[i];typeof l=="function"?l():aI(t[i],null)}}}}function Ts(...t){return y.useCallback(IB(...t),t)}function mm(t){const s=Rce(t),n=y.forwardRef((a,i)=>{const{children:l,...o}=a,c=y.Children.toArray(l),d=c.find(Bce);if(d){const u=d.props.children,h=c.map(f=>f===d?y.Children.count(u)>1?y.Children.only(null):y.isValidElement(u)?u.props.children:null:f);return r.jsx(s,{...o,ref:i,children:y.isValidElement(u)?y.cloneElement(u,void 0,h):null})}return r.jsx(s,{...o,ref:i,children:l})});return n.displayName=`${t}.Slot`,n}var Oce=mm("Slot");function Rce(t){const s=y.forwardRef((n,a)=>{const{children:i,...l}=n;if(y.isValidElement(i)){const o=$ce(i),c=Fce(l,i.props);return i.type!==y.Fragment&&(c.ref=a?IB(a,o):o),y.cloneElement(i,c)}return y.Children.count(i)>1?y.Children.only(null):null});return s.displayName=`${t}.SlotClone`,s}var Lce=Symbol("radix.slottable");function Bce(t){return y.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Lce}function Fce(t,s){const n={...s};for(const a in s){const i=t[a],l=s[a];/^on[A-Z]/.test(a)?i&&l?n[a]=(...c)=>{const d=l(...c);return i(...c),d}:i&&(n[a]=i):a==="style"?n[a]={...i,...l}:a==="className"&&(n[a]=[i,l].filter(Boolean).join(" "))}return{...t,...n}}function $ce(t){var a,i;let s=(a=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:a.get,n=s&&"isReactWarning"in s&&s.isReactWarning;return n?t.ref:(s=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=s&&"isReactWarning"in s&&s.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}const zce=rv("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Te=y.forwardRef(({className:t,variant:s,size:n,asChild:a=!1,...i},l)=>{const o=a?Oce:"button";return r.jsx(o,{className:Ft(zce({variant:s,size:n,className:t})),ref:l,...i})});Te.displayName="Button";const Se=y.forwardRef(({className:t,type:s,...n},a)=>r.jsx("input",{type:s,className:Ft("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:a,...n}));Se.displayName="Input";function Ui({variant:t="default",className:s,children:n,...a}){const i="relative w-full rounded-lg border px-4 py-3 text-sm flex gap-3 items-start",l={default:"bg-slate-50 border-slate-200 text-slate-800",destructive:"bg-rose-50 border-rose-200 text-rose-800"};return r.jsx("div",{role:"alert",className:Ft(i,l[t]||l.default,s),...a,children:n})}function Vi({className:t,children:s,...n}){return r.jsx("div",{className:Ft("font-semibold leading-tight text-sm",t),...n,children:s})}function Hi({className:t,children:s,...n}){return r.jsx("div",{className:Ft("text-xs mt-1 text-slate-700",t),...n,children:s})}function We({className:t,...s}){return r.jsx("div",{className:Ft("animate-pulse rounded-md bg-primary/10",t),...s})}const Z0={initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.18}};function Uce(){const{hasAny:t,canView:s,canCreate:n,canUpdate:a,canDelete:i}=nv("departments"),[l,o]=y.useState([]),[c,d]=y.useState({name:"",description:""}),[u,h]=y.useState(null),[f,x]=y.useState(""),[b,v]=y.useState(!1),[w,_]=y.useState(!1),[S,k]=y.useState(""),[A,T]=y.useState("all"),P=y.useCallback(async()=>{var L,F,V;if(s){x(""),_(!0);try{const{data:$}=await J.get("/departments/");o($||[])}catch($){const z=(L=$==null?void 0:$.response)==null?void 0:L.status;x(z===403?"Access denied for Departments.":z===401?"Session expired. Please login again.":((V=(F=$==null?void 0:$.response)==null?void 0:F.data)==null?void 0:V.detail)||"Failed to load departments.")}finally{_(!1)}}},[s]);y.useEffect(()=>{P()},[P]);const O=async L=>{var F,V,$;if(L.preventDefault(),!(!u&&!n)&&!(u&&!a)){v(!0),x("");try{u?await J.put(`/departments/${u}`,c):await J.post("/departments/",c),d({name:"",description:""}),h(null),P()}catch(z){const H=(F=z==null?void 0:z.response)==null?void 0:F.status;x(H===403?"Access denied.":H===401?"Session expired. Please login again.":(($=(V=z==null?void 0:z.response)==null?void 0:V.data)==null?void 0:$.detail)||"Failed to save department.")}finally{v(!1)}}},D=async L=>{var F,V,$;if(i&&window.confirm("Delete this department?"))try{await J.delete(`/departments/${L}`),P()}catch(z){const H=(F=z==null?void 0:z.response)==null?void 0:F.status;x(H===403?"Access denied.":H===401?"Session expired. Please login again.":(($=(V=z==null?void 0:z.response)==null?void 0:V.data)==null?void 0:$.detail)||"Failed to delete department.")}},I=L=>{a&&(h(L.id),d({name:L.name,description:L.description||""}))},M=()=>{h(null),d({name:"",description:""})},B=y.useMemo(()=>(l||[]).filter(L=>{if(!L)return!1;const F=(L.name||"").toLowerCase(),V=(L.description||"").toLowerCase(),$=S.toLowerCase().trim();return!($&&!`${F} ${V}`.includes($)||A==="withDesc"&&!L.description||A==="withoutDesc"&&L.description)}),[l,S,A]);return!t||!s?r.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-4 md:px-6 md:py-6 lg:px-8",children:r.jsxs("div",{className:"mx-auto max-w-6xl space-y-4",children:[r.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-r from-slate-800 via-slate-700 to-slate-900 text-white shadow-md",children:[r.jsx("div",{className:"absolute inset-0 opacity-20 bg-[radial-gradient(circle_at_top,_#e5e7eb,_transparent_55%)]"}),r.jsxs("div",{className:"relative px-5 py-6 sm:px-7 sm:py-7 md:px-9 md:py-8 flex items-center gap-3",children:[r.jsx("div",{className:"inline-flex h-11 w-11 items-center justify-center rounded-3xl bg-white/10 border border-white/20",children:r.jsx(fa,{className:"w-6 h-6"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg md:text-xl font-semibold tracking-tight",children:"Departments module"}),r.jsx("p",{className:"mt-1 text-xs sm:text-sm text-slate-100/90",children:"Configure clinical and support departments for your hospital."})]})]})]}),r.jsxs(Ve,{className:"rounded-3xl border-amber-200 bg-amber-50 shadow-sm",children:[r.jsx(rt,{children:r.jsx(ot,{className:"text-base text-amber-900",children:"Access restricted"})}),r.jsx(He,{children:r.jsxs(Ui,{className:"border-amber-200 bg-amber-50 text-amber-900 rounded-2xl",children:[r.jsx(Vi,{className:"font-semibold",children:"You dont have permission"}),r.jsx(Hi,{className:"text-sm",children:"Your role does not currently include access to the Departments configuration. Please contact the system administrator if you believe this is a mistake."})]})})]})]})}):r.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-4 md:px-6 md:py-6 lg:px-8",children:r.jsxs("div",{className:"mx-auto max-w-6xl space-y-4 md:space-y-5 lg:space-y-6",children:[r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 text-xs",children:[r.jsx(Ze,{variant:"outline",className:"rounded-full border-slate-200 bg-white px-2.5 py-1 text-[11px] font-medium tracking-wide text-slate-700",children:"Admin  Departments"}),r.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-slate-500",children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 shadow-sm animate-pulse"}),r.jsx("span",{className:"hidden sm:inline",children:"Desktop workspace"}),r.jsx("span",{className:"sm:hidden",children:"Responsive view"})]})]}),r.jsx(at.div,{...Z0,children:r.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-r from-teal-700 via-teal-600 to-blue-600 text-white shadow-md",children:[r.jsx("div",{className:"absolute inset-0 opacity-25 pointer-events-none bg-[radial-gradient(circle_at_top,_#e0f2fe,_transparent_55%)]"}),r.jsxs("div",{className:"relative flex flex-col gap-4 md:flex-row md:items-center md:justify-between px-4 py-5 sm:px-6 sm:py-6 md:px-8 md:py-7 lg:px-10 lg:py-8",children:[r.jsxs("div",{className:"space-y-3 max-w-xl",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-white/10 px-3 py-1 text-xs font-medium backdrop-blur-sm border border-white/20",children:[r.jsx("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-white/20 text-[11px]",children:r.jsx(fa,{className:"w-3.5 h-3.5"})}),"Core clinical & support structure"]}),r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"inline-flex h-11 w-11 md:h-12 md:w-12 items-center justify-center rounded-3xl bg-white/10 text-white shadow-sm border border-white/20",children:r.jsx(fa,{className:"w-6 h-6"})}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("h1",{className:"text-xl md:text-2xl lg:text-3xl font-semibold tracking-tight",children:"Clinical & Support Departments"}),r.jsxs("p",{className:"text-sm md:text-base text-teal-50/90 leading-relaxed",children:["Configure ",r.jsx("span",{className:"font-semibold",children:"OPD, IPD, diagnostics and support"})," departments so that doctors, staff and services stay aligned across your hospital."]})]})]})]}),r.jsxs("div",{className:"w-full md:w-auto space-y-3",children:[r.jsxs("div",{className:"flex flex-wrap gap-2 justify-start md:justify-end",children:[r.jsx(Ze,{className:"bg-white/15 text-xs font-semibold border border-white/25 text-white rounded-full px-3 py-1",children:"Master configuration"}),r.jsx(Ze,{className:"bg-white/10 text-xs border border-white/20 text-teal-50 rounded-full px-3 py-1",children:"Used by OPD / IPD / Lab / OT"})]}),r.jsx("div",{className:"grid grid-cols-1 gap-2 md:min-w-[220px]",children:r.jsx(Vce,{label:"Departments",value:l.length,hint:"Mapped across OPD, IPD, lab, radiology, etc."})})]})]})]})}),f&&r.jsx(at.div,{...Z0,children:r.jsxs(Ui,{className:"rounded-2xl border-red-200 bg-red-50 text-red-800",children:[r.jsx(Vi,{className:"font-semibold",children:"Issue"}),r.jsx(Hi,{className:"text-sm",children:f})]})}),r.jsxs("div",{className:"grid items-start gap-4 lg:grid-cols-[minmax(0,260px)_minmax(0,1fr)]",children:[r.jsx(at.div,{...Z0,children:r.jsxs(Ve,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsxs(rt,{className:"pb-3",children:[r.jsx(ot,{className:"text-sm font-semibold text-slate-900",children:u?"Edit department":"Create department"}),r.jsx("p",{className:"mt-1 text-xs text-slate-600",children:"Add or update hospital departments that will be used across modules."})]}),r.jsx(He,{children:r.jsxs("form",{onSubmit:O,className:"space-y-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("label",{className:"text-xs font-medium text-slate-800",children:["Department name",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx(Se,{placeholder:"e.g., General Medicine",value:c.name,onChange:L=>d({...c,name:L.target.value}),required:!0,disabled:!(u?a:n),className:"h-9 rounded-xl border-slate-200 bg-slate-50 text-sm text-slate-900 focus-visible:ring-2 focus-visible:ring-teal-100 focus-visible:border-teal-500"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("label",{className:"text-xs font-medium text-slate-800",children:["Description",r.jsx("span",{className:"text-slate-400",children:" (optional)"})]}),r.jsx(Se,{placeholder:"Short description to help staff identify this department",value:c.description,onChange:L=>d({...c,description:L.target.value}),disabled:!(u?a:n),className:"h-9 rounded-xl border-slate-200 bg-slate-50 text-sm text-slate-900 focus-visible:ring-2 focus-visible:ring-teal-100 focus-visible:border-teal-500"})]}),r.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[u&&r.jsx("button",{type:"button",onClick:M,className:"text-xs text-slate-500 underline underline-offset-2",children:"Cancel edit & reset"}),r.jsx(Te,{type:"submit",className:"ml-auto rounded-full bg-blue-600 px-4 py-2 text-xs sm:text-sm font-semibold text-white hover:bg-blue-700 active:scale-95",disabled:b||(u?!a:!n),children:b?"Saving":u?"Update department":"Create department"})]})]})})]})}),r.jsx(at.div,{...Z0,children:r.jsxs(Ve,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsxs(rt,{className:"border-b border-slate-100 pb-3",children:[r.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{children:[r.jsx(ot,{className:"text-sm font-semibold text-slate-900",children:"Department list"}),r.jsxs("p",{className:"mt-1 text-[11px] text-slate-500",children:[l.length," configured department",l.length===1?"":"s","."]})]}),r.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:items-center sm:justify-end",children:[r.jsxs("div",{className:"relative w-full sm:w-52",children:[r.jsx(es,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-slate-400"}),r.jsx("input",{type:"text",value:S,onChange:L=>k(L.target.value),placeholder:"Search by name or description",className:"w-full rounded-xl border border-slate-200 bg-slate-50 pl-8 pr-3 py-1.5 text-xs sm:text-sm text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500"})]}),n&&r.jsxs(Te,{type:"button",onClick:M,className:"inline-flex items-center justify-center gap-1.5 rounded-full bg-blue-600 px-3 py-1.5 text-xs sm:text-sm font-semibold text-white hover:bg-blue-700 active:scale-95",children:[r.jsx(ps,{className:"w-3.5 h-3.5"}),"New department"]})]})]}),r.jsx("div",{className:"mt-3 flex flex-wrap gap-1.5",children:[{key:"all",label:"All"},{key:"withDesc",label:"With description"},{key:"withoutDesc",label:"Without description"}].map(L=>r.jsx("button",{type:"button",onClick:()=>T(L.key),className:["inline-flex items-center rounded-full px-3 py-1 text-[11px] sm:text-xs transition",A===L.key?"bg-blue-600 text-white shadow-sm":"bg-slate-100 text-slate-600 hover:bg-slate-200"].join(" "),children:L.label},L.key))})]}),r.jsx(He,{className:"pt-4",children:w?r.jsx("div",{className:"space-y-2",children:[0,1,2].map(L=>r.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-3",children:[r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsx(We,{className:"h-3 w-1/3 rounded-full bg-slate-100"}),r.jsx(We,{className:"h-2.5 w-1/2 rounded-full bg-slate-100"})]}),r.jsx(We,{className:"h-6 w-20 rounded-full bg-slate-100"})]},L))}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"hidden md:block",children:r.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:r.jsxs("table",{className:"min-w-full text-xs",children:[r.jsx("thead",{className:"bg-slate-50 text-[11px] font-medium text-slate-600",children:r.jsxs("tr",{children:[r.jsx("th",{className:"p-2 text-left",children:"#"}),r.jsx("th",{className:"p-2 text-left",children:"Name"}),r.jsx("th",{className:"p-2 text-left",children:"Description"}),r.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[B.map((L,F)=>r.jsxs("tr",{className:"border-t border-slate-100 text-xs text-slate-800 hover:bg-slate-50/80 transition-colors",children:[r.jsx("td",{className:"p-2 align-top",children:F+1}),r.jsx("td",{className:"p-2 align-top font-semibold text-slate-900",children:L.name}),r.jsx("td",{className:"p-2 align-top text-slate-500",children:r.jsx("span",{className:"line-clamp-2 text-[11px]",children:L.description||""})}),r.jsx("td",{className:"p-2 align-top text-right",children:r.jsxs("div",{className:"inline-flex gap-2",children:[a&&r.jsx(Te,{type:"button",variant:"outline",size:"sm",className:"h-7 rounded-full border-slate-200 px-3 text-[11px] font-semibold text-slate-700 hover:bg-slate-50",onClick:()=>I(L),children:"Edit"}),i&&r.jsx(Te,{type:"button",variant:"outline",size:"sm",className:"h-7 rounded-full border border-rose-200 px-3 text-[11px] font-semibold text-rose-700 hover:bg-rose-50",onClick:()=>D(L.id),children:"Delete"})]})})]},L.id)),!B.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:4,className:"p-4",children:r.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-4 py-5 text-center",children:[r.jsx("p",{className:"text-sm font-medium text-slate-700",children:"No departments match your filters."}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Adjust search or filter, or create a new department from the left panel."})]})})})]})]})})}),r.jsxs("div",{className:"grid gap-3 md:hidden",children:[B.map((L,F)=>r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm flex flex-col gap-2",children:[r.jsx("div",{className:"flex items-start justify-between gap-2",children:r.jsxs("div",{className:"space-y-0.5",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"inline-flex h-5 w-5 items-center justify-center rounded-full bg-slate-100 text-[11px] text-slate-600",children:F+1}),r.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:L.name})]}),r.jsx("p",{className:"text-[11px] text-slate-600 line-clamp-2",children:L.description||"No description"})]})}),r.jsxs("div",{className:"flex items-center justify-end gap-2 pt-1",children:[a&&r.jsx("button",{type:"button",onClick:()=>I(L),className:"inline-flex items-center rounded-full border border-slate-200 px-3 py-1 text-[11px] font-semibold text-slate-700 hover:bg-slate-50",children:"Edit"}),i&&r.jsx("button",{type:"button",onClick:()=>D(L.id),className:"inline-flex items-center rounded-full border border-rose-200 px-3 py-1 text-[11px] font-semibold text-rose-700 hover:bg-rose-50",children:"Delete"})]})]},L.id)),!B.length&&r.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-4 py-5 text-center",children:[r.jsx("p",{className:"text-sm font-medium text-slate-700",children:"No departments match your filters."}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Adjust search or filters, or create a new department from the form above."})]})]})]})})]})})]})]})})}function Vce({label:t,value:s,hint:n}){return r.jsxs(at.div,{whileHover:{y:-2,scale:1.01},transition:{type:"spring",stiffness:240,damping:22},className:"rounded-2xl border border-white/40 bg-white/10 px-3 py-2 text-[11px] text-teal-50/90",children:[r.jsx("div",{className:"text-[10px] font-medium uppercase tracking-wide text-teal-100/90",children:t}),r.jsx("div",{className:"mt-1 text-sm font-semibold text-white",children:s}),n&&r.jsx("div",{className:"mt-0.5 text-[10px] text-teal-100/80",children:n})]})}const J0={initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.18}};function Hce(){const{hasAny:t,canView:s,canCreate:n,canUpdate:a,canDelete:i}=nv("roles"),[l,o]=y.useState([]),[c,d]=y.useState([]),[u,h]=y.useState({name:"",description:"",permission_ids:[]}),[f,x]=y.useState(null),[b,v]=y.useState(!1),[w,_]=y.useState(!1),[S,k]=y.useState(""),[A,T]=y.useState(""),[P,O]=y.useState("all"),D=y.useCallback(async()=>{var $,z,H;if(s){k(""),_(!0);try{const[q,G]=await Promise.all([J.get("/roles/"),J.get("/permissions/")]);o(q.data||[]),d(G.data||[])}catch(q){const G=($=q==null?void 0:q.response)==null?void 0:$.status;k(G===403?"Access denied for Roles.":G===401?"Session expired. Please login again.":((H=(z=q==null?void 0:q.response)==null?void 0:z.data)==null?void 0:H.detail)||"Failed to load roles.")}finally{_(!1)}}},[s]);y.useEffect(()=>{D()},[D]);const I=$=>{h(z=>({...z,permission_ids:z.permission_ids.includes($)?z.permission_ids.filter(H=>H!==$):[...z.permission_ids,$]}))},M=()=>{x(null),h({name:"",description:"",permission_ids:[]})},B=async $=>{var z,H,q;if($.preventDefault(),!(!f&&!n)&&!(f&&!a)){v(!0),k("");try{f?await J.put(`/roles/${f}`,u):await J.post("/roles/",u),M(),D()}catch(G){const re=(z=G==null?void 0:G.response)==null?void 0:z.status;k(re===403?"Access denied.":re===401?"Session expired. Please login again.":((q=(H=G==null?void 0:G.response)==null?void 0:H.data)==null?void 0:q.detail)||"Failed to save role.")}finally{v(!1)}}},L=$=>{a&&(x($.id),h({name:$.name,description:$.description||"",permission_ids:$.permission_ids||[]}))},F=async $=>{var z,H,q;if(i&&window.confirm("Delete this role?"))try{await J.delete(`/roles/${$}`),D()}catch(G){const re=(z=G==null?void 0:G.response)==null?void 0:z.status;k(re===403?"Access denied.":re===401?"Session expired. Please login again.":((q=(H=G==null?void 0:G.response)==null?void 0:H.data)==null?void 0:q.detail)||"Failed to delete role.")}},V=y.useMemo(()=>(l||[]).filter($=>{var re;if(!$)return!1;const z=($.name||"").toLowerCase(),H=($.description||"").toLowerCase(),q=A.toLowerCase().trim();if(q&&!`${z} ${H}`.includes(q))return!1;const G=((re=$.permission_ids)==null?void 0:re.length)||0;return!(P==="withPerms"&&G===0||P==="noPerms"&&G>0)}),[l,A,P]);return!t||!s?r.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-4 md:px-6 md:py-6 lg:px-8",children:r.jsxs("div",{className:"mx-auto max-w-6xl space-y-4",children:[r.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-r from-slate-800 via-slate-700 to-slate-900 text-white shadow-md",children:[r.jsx("div",{className:"absolute inset-0 opacity-20 bg-[radial-gradient(circle_at_top,_#e5e7eb,_transparent_55%)]"}),r.jsxs("div",{className:"relative px-5 py-6 sm:px-7 sm:py-7 md:px-9 md:py-8 flex items-center gap-3",children:[r.jsx("div",{className:"inline-flex h-11 w-11 items-center justify-center rounded-3xl bg-white/10 border border-white/20",children:r.jsx($a,{className:"w-6 h-6"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl md:text-2xl font-semibold tracking-tight",children:"Roles & Permissions"}),r.jsx("p",{className:"mt-1 text-sm text-slate-100/90",children:"Manage access profiles and permission sets across modules."})]})]})]}),r.jsxs(Ve,{className:"rounded-3xl border-amber-200 bg-amber-50 shadow-sm",children:[r.jsx(rt,{children:r.jsx(ot,{className:"text-base font-semibold text-amber-900",children:"Access restricted"})}),r.jsx(He,{children:r.jsxs(Ui,{className:"border-amber-200 bg-amber-50 text-amber-900 rounded-2xl",children:[r.jsx(Vi,{className:"font-semibold",children:"You dont have permission"}),r.jsx(Hi,{className:"text-sm",children:"Your role does not currently include access to the Roles module. Please contact the system administrator if you believe this is a mistake."})]})})]})]})}):r.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-4 md:px-6 md:py-6 lg:px-8",children:r.jsxs("div",{className:"mx-auto max-w-6xl space-y-4 md:space-y-5 lg:space-y-6",children:[r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 text-sm",children:[r.jsx(Ze,{variant:"outline",className:"rounded-full border-slate-200 bg-white px-3 py-1 text-xs font-semibold tracking-wide text-slate-700",children:"Admin  Roles & permissions"}),r.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 shadow-sm animate-pulse"}),r.jsx("span",{className:"hidden sm:inline",children:"Desktop workspace"}),r.jsx("span",{className:"sm:hidden",children:"Responsive view"})]})]}),r.jsx(at.div,{...J0,children:r.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-r from-teal-700 via-teal-600 to-blue-600 text-white shadow-md",children:[r.jsx("div",{className:"absolute inset-0 opacity-25 pointer-events-none bg-[radial-gradient(circle_at_top,_#e0f2fe,_transparent_55%)]"}),r.jsxs("div",{className:"relative flex flex-col gap-4 md:flex-row md:items-center md:justify-between px-4 py-5 sm:px-6 sm:py-6 md:px-8 md:py-7 lg:px-10 lg:py-8",children:[r.jsxs("div",{className:"space-y-3 max-w-xl",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-white/10 px-3 py-1 text-xs font-semibold backdrop-blur-sm border border-white/20",children:[r.jsx("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-white/20 text-[11px]",children:r.jsx($a,{className:"w-3.5 h-3.5"})}),"Centralised access control"]}),r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"inline-flex h-12 w-12 items-center justify-center rounded-3xl bg-white/10 text-white shadow-sm border border-white/20",children:r.jsx(Ei,{className:"w-6 h-6"})}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("h1",{className:"text-2xl md:text-3xl font-semibold tracking-tight",children:"Roles & Permission Sets"}),r.jsxs("p",{className:"text-sm md:text-base text-teal-50/90 leading-relaxed",children:["Define reusable ",r.jsx("span",{className:"font-semibold",children:"roles"})," and attach granular ",r.jsx("span",{className:"font-semibold",children:"permission codes"})," for OPD, IPD, pharmacy, lab, billing, OT, and more."]})]})]})]}),r.jsxs("div",{className:"w-full md:w-auto space-y-3",children:[r.jsxs("div",{className:"flex flex-wrap gap-2 justify-start md:justify-end",children:[r.jsx(Ze,{className:"bg-white/15 text-xs font-semibold border border-white/25 text-white rounded-full px-3 py-1",children:"RBAC ready"}),r.jsx(Ze,{className:"bg-white/10 text-xs border border-white/20 text-teal-50 rounded-full px-3 py-1",children:"Multi-module permissions"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 md:min-w-[260px]",children:[r.jsx(iI,{label:"Roles",value:l.length,hint:"Reusable access profiles"}),r.jsx(iI,{label:"Permissions",value:c.length,hint:"Atomic permission codes"})]})]})]})]})}),S&&r.jsx(at.div,{...J0,children:r.jsxs(Ui,{className:"rounded-2xl border-red-200 bg-red-50 text-red-800",children:[r.jsx(Vi,{className:"font-semibold text-sm",children:"Issue"}),r.jsx(Hi,{className:"text-sm",children:S})]})}),r.jsxs("div",{className:"grid items-start gap-4 lg:grid-cols-[minmax(0,320px)_minmax(0,1fr)]",children:[r.jsx(at.div,{...J0,children:r.jsxs(Ve,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsx(rt,{className:"pb-3",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-2xl bg-slate-900 text-slate-50",children:r.jsx(Ei,{className:"h-4 w-4"})}),r.jsxs("div",{children:[r.jsx(ot,{className:"text-base sm:text-lg font-semibold text-slate-900",children:f?"Edit role":"Create role"}),r.jsx("p",{className:"mt-1 text-xs sm:text-sm text-slate-600",children:"Group permissions into named roles and assign them to users."})]})]})}),r.jsx(He,{className:"space-y-4",children:r.jsxs("form",{onSubmit:B,className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-sm font-semibold text-slate-800",children:["Role name",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx(Se,{placeholder:"e.g., OPD Doctor, IPD Nurse",value:u.name,onChange:$=>h({...u,name:$.target.value}),required:!0,disabled:!(f?a:n),className:"h-10 rounded-xl border-slate-200 bg-slate-50 text-sm text-slate-900 focus-visible:ring-2 focus-visible:ring-teal-100 focus-visible:border-teal-500"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-sm font-semibold text-slate-800",children:["Description",r.jsx("span",{className:"text-slate-400 font-normal",children:" (optional)"})]}),r.jsx(Se,{placeholder:"Short description (e.g., OPD-only consulting doctor)",value:u.description,onChange:$=>h({...u,description:$.target.value}),disabled:!(f?a:n),className:"h-10 rounded-xl border-slate-200 bg-slate-50 text-sm text-slate-900 focus-visible:ring-2 focus-visible:ring-teal-100 focus-visible:border-teal-500"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm font-semibold text-slate-800",children:"Permissions"}),r.jsxs("span",{className:"text-xs text-slate-500",children:[u.permission_ids.length||0," selected"]})]}),r.jsxs("div",{className:"max-h-64 space-y-1 overflow-y-auto rounded-2xl border border-slate-100 bg-slate-50 px-2 py-2",children:[c.map($=>r.jsxs("label",{className:`flex cursor-pointer items-start gap-2 rounded-2xl px-2.5 py-1.5 text-xs transition-colors ${u.permission_ids.includes($.id)?"bg-white shadow-sm":"bg-slate-50 hover:bg-white"}`,children:[r.jsx("input",{type:"checkbox",checked:u.permission_ids.includes($.id),onChange:()=>I($.id),disabled:!(f?a:n),className:"mt-0.5 h-3.5 w-3.5 rounded border-slate-300 text-teal-600"}),r.jsxs("span",{children:[r.jsx("span",{className:"block font-semibold text-slate-800",children:$.label}),r.jsx("span",{className:"block text-[11px] text-slate-500 font-mono",children:$.code})]})]},$.id)),!c.length&&!w&&r.jsx("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-3 py-2 text-xs text-slate-500",children:"No permissions configured yet."}),w&&r.jsx("div",{className:"space-y-2",children:[0,1,2].map($=>r.jsxs("div",{className:"flex items-center gap-2 rounded-2xl px-2 py-1.5",children:[r.jsx(We,{className:"h-3 w-3 rounded bg-slate-100"}),r.jsxs("div",{className:"flex-1 space-y-1",children:[r.jsx(We,{className:"h-3 w-1/2 rounded-full bg-slate-100"}),r.jsx(We,{className:"h-2 w-1/3 rounded-full bg-slate-100"})]})]},$))})]})]}),r.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[f&&r.jsx("button",{type:"button",onClick:M,className:"text-xs sm:text-sm text-slate-500 underline underline-offset-2 font-medium",children:"Cancel edit & reset"}),r.jsx(Te,{type:"submit",className:"ml-auto rounded-full bg-blue-600 px-4 py-2 text-xs sm:text-sm font-semibold text-white hover:bg-blue-700 active:scale-95",disabled:b||(f?!a:!n),children:b?"Saving":f?"Update role":"Create role"})]})]})})]})}),r.jsx(at.div,{...J0,children:r.jsxs(Ve,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsxs(rt,{className:"border-b border-slate-100 pb-3",children:[r.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{children:[r.jsx(ot,{className:"text-base sm:text-lg font-semibold text-slate-900",children:"Role list"}),r.jsx("p",{className:"mt-1 text-xs sm:text-sm text-slate-600",children:"Overview of all defined roles and number of attached permissions."})]}),r.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:items-center sm:justify-end",children:[r.jsxs("div",{className:"relative w-full sm:w-56",children:[r.jsx(es,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),r.jsx("input",{type:"text",value:A,onChange:$=>T($.target.value),placeholder:"Search by role name / description",className:"w-full rounded-xl border border-slate-200 bg-slate-50 pl-9 pr-3 py-2 text-xs sm:text-sm font-medium text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500"})]}),n&&r.jsxs(Te,{type:"button",onClick:M,className:"inline-flex items-center justify-center gap-1.5 rounded-full bg-blue-600 px-4 py-2 text-xs sm:text-sm font-semibold text-white hover:bg-blue-700 active:scale-95",children:[r.jsx(ps,{className:"w-4 h-4"}),"New role"]})]})]}),r.jsx("div",{className:"mt-3 flex flex-wrap gap-1.5",children:[{key:"all",label:"All"},{key:"withPerms",label:"With permissions"},{key:"noPerms",label:"No permissions"}].map($=>r.jsx("button",{type:"button",onClick:()=>O($.key),className:["inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold transition",P===$.key?"bg-blue-600 text-white shadow-sm":"bg-slate-100 text-slate-600 hover:bg-slate-200"].join(" "),children:$.label},$.key))})]}),r.jsx(He,{className:"pt-4",children:w?r.jsx("div",{className:"space-y-2",children:[0,1,2].map($=>r.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-3",children:[r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsx(We,{className:"h-3.5 w-1/3 rounded-full bg-slate-100"}),r.jsx(We,{className:"h-3 w-1/4 rounded-full bg-slate-100"})]}),r.jsx(We,{className:"h-8 w-24 rounded-full bg-slate-100"})]},$))}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"hidden md:block",children:r.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-slate-50 text-xs font-semibold text-slate-600 uppercase tracking-wide",children:r.jsxs("tr",{children:[r.jsx("th",{className:"p-2 text-left",children:"#"}),r.jsx("th",{className:"p-2 text-left",children:"Role name"}),r.jsx("th",{className:"p-2 text-left",children:"Description"}),r.jsx("th",{className:"p-2 text-left",children:"Permissions"}),r.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[V.map(($,z)=>{var H,q;return r.jsxs("tr",{className:"border-t border-slate-100 text-sm text-slate-800 hover:bg-slate-50/80 transition-colors",children:[r.jsx("td",{className:"p-2 align-top",children:z+1}),r.jsx("td",{className:"p-2 align-top font-semibold text-slate-900",children:$.name}),r.jsx("td",{className:"p-2 align-top text-slate-600",children:r.jsx("span",{className:"line-clamp-2 text-xs sm:text-sm",children:$.description||""})}),r.jsx("td",{className:"p-2 align-top text-slate-700",children:(((H=$.permission_ids)==null?void 0:H.length)||0)===0?r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2.5 py-0.5 text-xs font-medium text-slate-600",children:"No permissions"}):r.jsxs("span",{className:"inline-flex items-center rounded-full bg-teal-50 px-2.5 py-0.5 text-xs font-semibold text-teal-700 border border-teal-100",children:[((q=$.permission_ids)==null?void 0:q.length)||0," ",r.jsx("span",{className:"ml-1 hidden sm:inline",children:"permissions"})]})}),r.jsx("td",{className:"p-2 align-top text-right",children:r.jsxs("div",{className:"inline-flex gap-2",children:[a&&r.jsx(Te,{type:"button",size:"sm",className:"h-8 rounded-full bg-slate-900 px-3 text-xs font-semibold text-white hover:bg-slate-800",onClick:()=>L($),children:"Edit"}),i&&r.jsx(Te,{type:"button",size:"sm",className:"h-8 rounded-full bg-rose-600 px-3 text-xs font-semibold text-white hover:bg-rose-700",onClick:()=>F($.id),children:"Delete"})]})})]},$.id)}),!V.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"p-4",children:r.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-4 py-5 text-center",children:[r.jsx("p",{className:"text-sm font-semibold text-slate-700",children:"No roles match your filters."}),r.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Adjust search or filters, or create a new role using the form on the left."})]})})})]})]})})}),r.jsxs("div",{className:"grid gap-3 md:hidden",children:[V.map(($,z)=>{var H,q;return r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm flex flex-col gap-2",children:[r.jsx("div",{className:"flex items-start justify-between gap-2",children:r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"inline-flex h-5 w-5 items-center justify-center rounded-full bg-slate-100 text-xs font-semibold text-slate-600",children:z+1}),r.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:$.name})]}),r.jsx("p",{className:"text-xs text-slate-600 line-clamp-2",children:$.description||"No description"})]})}),r.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[r.jsx("div",{className:"text-xs text-slate-600",children:(((H=$.permission_ids)==null?void 0:H.length)||0)===0?r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2.5 py-0.5 font-medium",children:"No permissions"}):r.jsxs("span",{className:"inline-flex items-center rounded-full bg-teal-50 px-2.5 py-0.5 text-teal-700 border border-teal-100 font-semibold",children:[((q=$.permission_ids)==null?void 0:q.length)||0," perms"]})}),r.jsxs("div",{className:"flex items-center gap-2",children:[a&&r.jsx("button",{type:"button",onClick:()=>L($),className:"inline-flex items-center rounded-full bg-slate-900 px-3 py-1 text-xs font-semibold text-white hover:bg-slate-800",children:"Edit"}),i&&r.jsx("button",{type:"button",onClick:()=>F($.id),className:"inline-flex items-center rounded-full bg-rose-600 px-3 py-1 text-xs font-semibold text-white hover:bg-rose-700",children:"Delete"})]})]})]},$.id)}),!V.length&&r.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-4 py-5 text-center",children:[r.jsx("p",{className:"text-sm font-semibold text-slate-700",children:"No roles match your filters."}),r.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Adjust search or filters, or create a new role using the form above."})]})]})]})})]})})]})]})})}function iI({label:t,value:s,hint:n}){return r.jsxs(at.div,{whileHover:{y:-2,scale:1.01},transition:{type:"spring",stiffness:240,damping:22},className:"rounded-2xl border border-white/40 bg-white/10 px-3 py-2 text-xs text-teal-50/90",children:[r.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-teal-100/90",children:t}),r.jsx("div",{className:"mt-1 text-sm font-bold text-white",children:s}),n&&r.jsx("div",{className:"mt-0.5 text-[11px] text-teal-100/80",children:n})]})}function Wce(){const{hasAny:t,canView:s,canCreate:n,canUpdate:a,canDelete:i}=nv("permissions"),[l,o]=y.useState([]),[c,d]=y.useState({code:"",label:"",module:""}),[u,h]=y.useState(null),[f,x]=y.useState(!1),[b,v]=y.useState(""),w=y.useCallback(async()=>{var A,T,P;if(s){v("");try{const O=await J.get("/permissions/");o(O.data)}catch(O){const D=(A=O==null?void 0:O.response)==null?void 0:A.status;v(D===403?"Access denied for Permissions.":D===401?"Session expired. Please login again.":((P=(T=O==null?void 0:O.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to load")}}},[s]);y.useEffect(()=>{w()},[w]);const _=async A=>{var T,P;if(A.preventDefault(),!(!u&&!n)&&!(u&&!a)){x(!0),v("");try{u?await J.put(`/permissions/${u}`,c):await J.post("/permissions/",c),d({code:"",label:"",module:""}),h(null),w()}catch(O){v(((P=(T=O==null?void 0:O.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to save")}finally{x(!1)}}},S=async A=>{var T,P;if(i&&confirm("Delete this permission?"))try{await J.delete(`/permissions/${A}`),w()}catch(O){v(((P=(T=O==null?void 0:O.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to delete")}},k=A=>{a&&(h(A.id),d({code:A.code,label:A.label,module:A.module}))};return!t||!s?r.jsxs("section",{className:"card",children:[r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Permissions"}),r.jsx("div",{className:"rounded-xl border border-amber-200 bg-amber-50 p-3 text-sm text-amber-700",children:"You dont have access to view this module."})]}):r.jsxs("section",{className:"card text-black",children:[r.jsx("div",{className:"flex items-center justify-between mb-4",children:r.jsx("h3",{className:"text-lg font-semibold",children:"Permissions"})}),r.jsxs("form",{onSubmit:_,className:"grid md:grid-cols-4 gap-3 mb-4",children:[r.jsx("input",{className:"input",placeholder:"code (e.g. users.view)",value:c.code,onChange:A=>d({...c,code:A.target.value}),required:!0,disabled:!(u?a:n)}),r.jsx("input",{className:"input",placeholder:"label (Users  View)",value:c.label,onChange:A=>d({...c,label:A.target.value}),required:!0,disabled:!(u?a:n)}),r.jsx("input",{className:"input",placeholder:"module (users)",value:c.module,onChange:A=>d({...c,module:A.target.value}),required:!0,disabled:!(u?a:n)}),r.jsx("button",{className:"btn",disabled:f||(u?!a:!n),children:u?"Update":"Create"})]}),b&&r.jsx("div",{className:"mb-4 rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:b}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"text-left",children:[r.jsx("th",{className:"p-2",children:"#"}),r.jsx("th",{className:"p-2",children:"Code"}),r.jsx("th",{className:"p-2",children:"Label"}),r.jsx("th",{className:"p-2",children:"Module"}),r.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[l.map((A,T)=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"p-2",children:T+1}),r.jsx("td",{className:"p-2 font-mono text-xs",children:A.code}),r.jsx("td",{className:"p-2",children:A.label}),r.jsx("td",{className:"p-2",children:A.module}),r.jsxs("td",{className:"p-2 text-right space-x-2",children:[a&&r.jsx("button",{className:"px-3 py-2 rounded-xl border",onClick:()=>k(A),children:"Edit"}),i&&r.jsx("button",{className:"px-3 py-2 rounded-xl border",onClick:()=>S(A.id),children:"Delete"})]})]},A.id)),!l.length&&r.jsx("tr",{children:r.jsx("td",{className:"p-4 text-sm text-gray-500",colSpan:"5",children:"No permissions yet."})})]})]})})]})}const Qw={initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.18}};function qce(){const{hasAny:t,canView:s,canCreate:n,canUpdate:a,canDelete:i}=nv("users"),[l,o]=y.useState([]),[c,d]=y.useState([]),[u,h]=y.useState([]),[f,x]=y.useState({name:"",email:"",password:"",department_id:"",role_ids:[],is_doctor:!1,is_active:!0}),[b,v]=y.useState(null),[w,_]=y.useState(!1),[S,k]=y.useState(!1),[A,T]=y.useState(""),[P,O]=y.useState("all"),[D,I]=y.useState(""),[M,B]=y.useState(!1),L=b?a:n,F=y.useCallback(async()=>{var ce,ge,X;if(s){T(""),k(!0);try{const[de,Ce,ue]=await Promise.all([J.get("/users/"),J.get("/roles/").catch(()=>({data:[]})),J.get("/departments/").catch(()=>({data:[]}))]);o(de.data||[]),d(Ce.data||[]),h(ue.data||[])}catch(de){const Ce=(ce=de==null?void 0:de.response)==null?void 0:ce.status;T(Ce===403?"Access denied for Users.":Ce===401?"Session expired. Please login again.":((X=(ge=de==null?void 0:de.response)==null?void 0:ge.data)==null?void 0:X.detail)||"Failed to load users.")}finally{k(!1)}}},[s]);y.useEffect(()=>{F()},[F]);const V=y.useMemo(()=>{const ce={};return u.forEach(ge=>{ce[ge.id]=ge.name}),ce},[u]),$=ce=>{x(ge=>({...ge,role_ids:ge.role_ids.includes(ce)?ge.role_ids.filter(X=>X!==ce):[...ge.role_ids,ce]}))},z=()=>{x({name:"",email:"",password:"",department_id:"",role_ids:[],is_doctor:!1,is_active:!0}),v(null)},H=()=>{z(),B(!0)},q=ce=>{a&&(v(ce.id),x({name:ce.name||"",email:ce.email||"",password:"",department_id:ce.department_id||"",role_ids:ce.role_ids||[],is_doctor:!!ce.is_doctor,is_active:ce.is_active??!0}),B(!0))},G=()=>{B(!1)},re=async ce=>{var X,de,Ce;if(ce.preventDefault(),!b&&!n||b&&!a)return;_(!0),T("");const ge={...f,department_id:f.department_id?Number(f.department_id):null};try{b?await J.put(`/users/${b}`,ge):await J.post("/users/",ge),z(),B(!1),F()}catch(ue){const fe=(X=ue==null?void 0:ue.response)==null?void 0:X.status;T(fe===403?"Access denied.":fe===401?"Session expired. Please login again.":((Ce=(de=ue==null?void 0:ue.response)==null?void 0:de.data)==null?void 0:Ce.detail)||"Failed to save user.")}finally{_(!1)}},ye=async ce=>{var ge,X,de;if(i&&window.confirm("Delete this user?"))try{await J.delete(`/users/${ce}`),F()}catch(Ce){const ue=(ge=Ce==null?void 0:Ce.response)==null?void 0:ge.status;T(ue===403?"Access denied.":ue===401?"Session expired. Please login again.":((de=(X=Ce==null?void 0:Ce.response)==null?void 0:X.data)==null?void 0:de.detail)||"Failed to delete user.")}},Ee=y.useMemo(()=>l.filter(ce=>ce.is_doctor).length,[l]),ee=y.useMemo(()=>l.filter(ce=>ce.is_active).length,[l]),te=y.useMemo(()=>{let ce=l;if(P==="doctors"&&(ce=ce.filter(ge=>ge.is_doctor)),D.trim()){const ge=D.toLowerCase();ce=ce.filter(X=>(X.name||"").toLowerCase().includes(ge)||(X.email||"").toLowerCase().includes(ge))}return ce},[l,P,D]);return!t||!s?r.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-4 md:px-6 md:py-6 lg:px-8",children:r.jsxs("div",{className:"mx-auto max-w-6xl space-y-4",children:[r.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-r from-teal-700 via-teal-600 to-blue-600 text-white shadow-md",children:[r.jsx("div",{className:"absolute inset-0 opacity-25 bg-[radial-gradient(circle_at_top,_#e0f2fe,_transparent_55%)]"}),r.jsxs("div",{className:"relative px-5 py-6 sm:px-7 sm:py-7 md:px-9 md:py-8 flex items-center gap-3",children:[r.jsx("div",{className:"inline-flex h-11 w-11 items-center justify-center rounded-3xl bg-white/10 border border-white/20",children:r.jsx(Uo,{className:"w-6 h-6"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg md:text-xl font-semibold tracking-tight",children:"Users & Doctors"}),r.jsx("p",{className:"mt-1 text-xs sm:text-sm text-teal-50/90",children:"Centralised staff management for OPD, IPD, diagnostics and support."})]})]})]}),r.jsxs(Ve,{className:"rounded-3xl border-amber-200 bg-amber-50 shadow-sm",children:[r.jsx(rt,{children:r.jsx(ot,{className:"text-base text-amber-900",children:"Access restricted"})}),r.jsx(He,{children:r.jsxs(Ui,{className:"border-amber-200 bg-amber-50 text-amber-900 rounded-2xl",children:[r.jsx(Vi,{className:"font-semibold",children:"You dont have permission"}),r.jsx(Hi,{className:"text-sm",children:"You dont have permission to view the Users module. Contact your administrator for access."})]})})]})]})}):r.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-4 md:px-6 md:py-6 lg:px-8",children:r.jsxs("div",{className:"mx-auto max-w-6xl space-y-4 md:space-y-5 lg:space-y-6",children:[r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 text-xs",children:[r.jsx(Ze,{variant:"outline",className:"rounded-full border-slate-200 bg-white px-2.5 py-1 text-[11px] font-medium tracking-wide text-slate-700",children:"Admin  User management"}),r.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-slate-500",children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 shadow-sm animate-pulse"}),r.jsx("span",{className:"hidden sm:inline",children:"Desktop workspace"}),r.jsx("span",{className:"sm:hidden",children:"Responsive view"})]})]}),r.jsx(at.div,{...Qw,children:r.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-r from-teal-700 via-teal-600 to-blue-600 text-white shadow-md",children:[r.jsx("div",{className:"absolute inset-0 opacity-25 bg-[radial-gradient(circle_at_top,_#e0f2fe,_transparent_55%)]"}),r.jsxs("div",{className:"relative flex flex-col gap-4 md:flex-row md:items-center md:justify-between px-4 py-5 sm:px-6 sm:py-6 md:px-8 md:py-7 lg:px-10 lg:py-8",children:[r.jsxs("div",{className:"space-y-3 max-w-xl",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-white/10 px-3 py-1 text-xs font-medium backdrop-blur-sm border border-white/20",children:[r.jsx("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-white/20 text-[11px]",children:r.jsx(Uo,{className:"w-3.5 h-3.5"})}),"Staff & access directory"]}),r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"inline-flex h-11 w-11 md:h-12 md:w-12 items-center justify-center rounded-3xl bg-white/10 text-white shadow-sm border border-white/20",children:r.jsx(F4,{className:"w-6 h-6"})}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("h1",{className:"text-xl md:text-2xl lg:text-3xl font-semibold tracking-tight",children:"Users & Doctors Management"}),r.jsxs("p",{className:"text-sm md:text-base text-teal-50/90 leading-relaxed",children:["Create staff accounts, map them to"," ",r.jsx("span",{className:"font-semibold",children:"departments"}),", attach"," ",r.jsx("span",{className:"font-semibold",children:"roles"})," and mark doctors for OPD/IPD routing."]})]})]})]}),r.jsxs("div",{className:"w-full md:w-auto space-y-3",children:[r.jsxs("div",{className:"flex flex-wrap gap-2 justify-start md:justify-end",children:[r.jsx(Ze,{className:"bg-white/15 text-xs font-semibold border border-white/25 text-white rounded-full px-3 py-1",children:"Multi-module access"}),r.jsx(Ze,{className:"bg-white/10 text-xs border border-white/20 text-teal-50 rounded-full px-3 py-1",children:"OPD / IPD ready"})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 md:min-w-[260px]",children:[r.jsx(Zw,{label:"Total users",value:l.length}),r.jsx(Zw,{label:"Doctors",value:Ee}),r.jsx(Zw,{label:"Active users",value:ee})]})]})]})]})}),A&&r.jsx(at.div,{...Qw,children:r.jsxs(Ui,{className:"rounded-2xl border-red-200 bg-red-50 text-red-800",children:[r.jsx(Vi,{className:"font-semibold",children:"Issue"}),r.jsx(Hi,{className:"text-sm",children:A})]})}),r.jsx(at.div,{...Qw,children:r.jsxs(Ve,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsxs(rt,{className:"border-b border-slate-100 pb-3",children:[r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{children:[r.jsx(ot,{className:"text-sm sm:text-base font-semibold text-slate-900",children:"User directory"}),r.jsxs("p",{className:"mt-1 text-[11px] text-slate-500",children:[te.length," of ",l.length," records visible in this view."]})]}),r.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:items-center sm:justify-end",children:[r.jsxs("div",{className:"relative w-full sm:w-60",children:[r.jsx(es,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-slate-400"}),r.jsx("input",{type:"text",value:D,onChange:ce=>I(ce.target.value),placeholder:"Search by name or email",className:"w-full rounded-xl border border-slate-200 bg-slate-50 pl-8 pr-3 py-1.5 text-xs sm:text-sm text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500"})]}),n&&r.jsxs(Te,{type:"button",onClick:H,className:"inline-flex items-center justify-center gap-1.5 rounded-full bg-blue-600 px-3 py-1.5 text-xs sm:text-sm font-semibold text-white hover:bg-blue-700 active:scale-95",children:[r.jsx(F4,{className:"w-3.5 h-3.5"}),"New user"]})]})]}),r.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-2.5 py-1 text-[10px] font-medium text-slate-600",children:[r.jsx($r,{className:"h-3 w-3"}),r.jsx("span",{children:"Filter"})]}),r.jsx("button",{type:"button",onClick:()=>O("all"),className:`inline-flex items-center rounded-full px-3 py-1 text-[11px] sm:text-xs transition ${P==="all"?"bg-blue-600 text-white shadow-sm":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"All users"}),r.jsxs("button",{type:"button",onClick:()=>O("doctors"),className:`inline-flex items-center gap-1 rounded-full px-3 py-1 text-[11px] sm:text-xs transition ${P==="doctors"?"bg-blue-600 text-white shadow-sm":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:[r.jsx(Es,{className:"h-3.5 w-3.5"}),"Doctors only"]})]})]}),r.jsx(He,{className:"pt-4",children:S?r.jsx(Kce,{}):te.length===0?r.jsx(Gce,{title:"No users match this view"}):r.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",children:te.map((ce,ge)=>{const X=c.filter(Ce=>(ce.role_ids||[]).includes(Ce.id)).map(Ce=>Ce.name),de=(ce.name||"?").split(" ").map(Ce=>Ce[0]).join("").slice(0,2).toUpperCase();return r.jsxs(at.div,{whileHover:{y:-2,scale:1.01},transition:{duration:.15,ease:"easeOut"},className:"flex flex-col justify-between rounded-2xl border border-slate-200 bg-slate-50 px-3.5 py-3.5 shadow-sm",children:[r.jsxs("div",{className:"flex items-start justify-between gap-2",children:[r.jsxs("div",{className:"flex items-start gap-2.5",children:[r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"h-9 w-9 rounded-full bg-slate-200 flex items-center justify-center text-xs font-semibold text-slate-800",children:de}),ce.is_doctor&&r.jsx("span",{className:"absolute -top-0.5 -right-0.5 h-2.5 w-2.5 rounded-full bg-emerald-500 ring-2 ring-slate-50"})]}),r.jsxs("div",{className:"space-y-0.5",children:[r.jsx("div",{className:"text-sm font-semibold text-slate-900",children:ce.name}),r.jsx("div",{className:"text-[11px] text-slate-500",children:X.length?X.join(", "):"No roles"})]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-1",children:[ce.is_active?r.jsx("span",{className:"inline-flex items-center rounded-full bg-emerald-50 px-2 py-0.5 text-[10px] font-semibold text-emerald-700",children:"ACTIVE"}):r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2 py-0.5 text-[10px] font-semibold text-slate-600",children:"INACTIVE"}),ce.is_admin&&r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-900 px-2 py-0.5 text-[10px] font-semibold text-white",children:"ADMIN"}),ce.is_doctor&&r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-sky-50 px-2 py-0.5 text-[10px] font-semibold text-sky-700",children:[r.jsx(Es,{className:"h-3 w-3"}),"DOCTOR"]})]})]}),r.jsxs("div",{className:"mt-3 space-y-1.5 text-[11px] text-slate-600",children:[r.jsxs("div",{className:"flex justify-between gap-2",children:[r.jsx("span",{className:"text-slate-400",children:"DEPARTMENT"}),r.jsx("span",{className:"font-medium text-slate-700",children:V[ce.department_id]||"-"})]}),r.jsxs("div",{className:"flex justify-between gap-2",children:[r.jsx("span",{className:"text-slate-400",children:"EMAIL"}),r.jsx("span",{className:"max-w-[60%] truncate text-right",children:ce.email})]})]}),r.jsxs("div",{className:"mt-3 flex justify-between gap-2",children:[a&&r.jsx(Te,{type:"button",variant:"outline",size:"sm",className:"flex-1 h-8 rounded-full border-slate-200 text-[11px] font-semibold text-slate-700 hover:bg-slate-50",onClick:()=>q(ce),children:"Edit"}),i&&r.jsx(Te,{type:"button",variant:"outline",size:"sm",className:"flex-1 h-8 rounded-full border border-rose-200 text-[11px] font-semibold text-rose-700 hover:bg-rose-50",onClick:()=>ye(ce.id),children:"Delete"})]})]},ce.id)})})})]})}),r.jsx(vl,{children:M&&r.jsx(Yce,{isOpen:M,onClose:G,onSubmit:re,form:f,setForm:x,depts:u,roles:c,canEditOrCreate:L,loadingSave:w,editId:b,toggleRole:$})})]})})}function Zw({label:t,value:s}){return r.jsxs(at.div,{whileHover:{y:-2,scale:1.01},transition:{type:"spring",stiffness:240,damping:22},className:"rounded-2xl border border-white/40 bg-white/10 px-3 py-2 text-[11px] text-teal-50/90",children:[r.jsx("div",{className:"text-[10px] font-medium uppercase tracking-wide text-teal-100/90",children:t}),r.jsx("div",{className:"mt-1 text-sm font-semibold text-white",children:s})]})}function Gce({title:t}){return r.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-4 py-5 text-center",children:[r.jsx("p",{className:"text-sm font-semibold text-slate-700",children:t}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Try changing filters, clearing the search, or creating a new user."})]})}function Kce(){return r.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",children:[0,1,2,3,4,5].map(t=>r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3.5 py-3.5 shadow-sm",children:[r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx(We,{className:"h-9 w-9 rounded-full bg-slate-100"}),r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsx(We,{className:"h-3 w-1/2 rounded-full bg-slate-100"}),r.jsx(We,{className:"h-2.5 w-2/3 rounded-full bg-slate-100"})]})]}),r.jsxs("div",{className:"mt-3 space-y-2",children:[r.jsx(We,{className:"h-2.5 w-full rounded-full bg-slate-100"}),r.jsx(We,{className:"h-2.5 w-5/6 rounded-full bg-slate-100"})]}),r.jsxs("div",{className:"mt-3 flex gap-2",children:[r.jsx(We,{className:"h-8 w-full rounded-full bg-slate-100"}),r.jsx(We,{className:"h-8 w-full rounded-full bg-slate-100"})]})]},t))})}function Yce({isOpen:t,onClose:s,onSubmit:n,form:a,setForm:i,depts:l,roles:o,canEditOrCreate:c,loadingSave:d,editId:u,toggleRole:h}){if(!t)return null;const f=x=>{x.target===x.currentTarget&&s()};return r.jsx(at.div,{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black/40 backdrop-blur-sm",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onMouseDown:f,children:r.jsxs(at.div,{onMouseDown:x=>x.stopPropagation(),initial:{y:40,opacity:0},animate:{y:0,opacity:1},exit:{y:40,opacity:0},transition:{duration:.2,ease:"easeOut"},className:"w-full sm:max-w-lg bg-white rounded-t-3xl sm:rounded-2xl shadow-2xl max-h-[90vh] overflow-y-auto px-4 py-4 sm:px-6 sm:py-5",children:[r.jsxs("div",{className:"flex items-start justify-between gap-2 border-b border-slate-100 pb-3",children:[r.jsxs("div",{className:"space-y-0.5",children:[r.jsx("h2",{className:"text-base sm:text-lg font-semibold text-slate-900",children:u?"Edit user":"Add new user"}),r.jsx("p",{className:"text-xs sm:text-sm text-slate-500",children:"Fill basic details, map department and attach roles."})]}),r.jsx("button",{type:"button",onClick:s,className:"inline-flex h-7 w-7 items-center justify-center rounded-full border border-slate-200 bg-white text-slate-500 hover:bg-slate-100",children:r.jsx(Kn,{className:"h-3.5 w-3.5"})})]}),r.jsxs("form",{onSubmit:n,className:"mt-3 space-y-3",children:[r.jsxs("div",{className:"grid gap-2",children:[r.jsx(Se,{placeholder:"Full name",value:a.name,onChange:x=>i({...a,name:x.target.value}),required:!0,disabled:!c,className:"h-9 rounded-xl border-slate-200 bg-slate-50 text-sm text-slate-900 focus-visible:ring-2 focus-visible:ring-teal-100 focus-visible:border-teal-500"}),r.jsx(Se,{placeholder:"Email",type:"email",value:a.email,onChange:x=>i({...a,email:x.target.value}),required:!0,disabled:!c,className:"h-9 rounded-xl border-slate-200 bg-slate-50 text-sm text-slate-900 focus-visible:ring-2 focus-visible:ring-teal-100 focus-visible:border-teal-500"})]}),r.jsx(Se,{placeholder:u?"Password (leave blank to keep)":"Password",type:"password",value:a.password,onChange:x=>i({...a,password:x.target.value}),required:!u,disabled:!c,className:"h-9 rounded-xl border-slate-200 bg-slate-50 text-sm text-slate-900 focus-visible:ring-2 focus-visible:ring-teal-100 focus-visible:border-teal-500"}),r.jsxs("div",{className:"space-y-1 text-xs",children:[r.jsx("label",{className:"font-medium text-slate-700",children:"Department"}),r.jsxs("select",{value:a.department_id,onChange:x=>i({...a,department_id:x.target.value}),disabled:!c,className:"h-9 w-full rounded-xl border border-slate-200 bg-slate-50 px-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500",children:[r.jsx("option",{value:"",children:"No department"}),l.map(x=>r.jsx("option",{value:x.id,children:x.name},x.id))]})]}),r.jsxs("div",{className:"flex flex-wrap gap-2 text-[11px]",children:[r.jsxs("label",{className:`inline-flex flex-1 min-w-[150px] cursor-pointer items-center gap-2 rounded-2xl border px-3 py-2 transition-colors ${a.is_doctor?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"}`,children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300",checked:a.is_doctor,onChange:x=>i({...a,is_doctor:x.target.checked}),disabled:!c}),r.jsxs("span",{className:"inline-flex items-center gap-1 text-slate-700",children:[r.jsx(Es,{className:"h-3.5 w-3.5 text-emerald-600"}),r.jsx("span",{children:"Mark as doctor"})]})]}),r.jsxs("label",{className:`inline-flex flex-1 min-w-[150px] cursor-pointer items-center gap-2 rounded-2xl border px-3 py-2 transition-colors ${a.is_active?"border-slate-300 bg-slate-50":"border-slate-200 bg-white hover:bg-slate-50"}`,children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300",checked:a.is_active,onChange:x=>i({...a,is_active:x.target.checked}),disabled:!c}),r.jsxs("span",{className:"inline-flex items-center gap-1 text-slate-700",children:[r.jsx($a,{className:"h-3.5 w-3.5 text-slate-700"}),r.jsx("span",{children:"Active user"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between text-[11px]",children:[r.jsx("span",{className:"font-medium text-slate-700",children:"Roles"}),r.jsxs("span",{className:"text-slate-400",children:[a.role_ids.length||0," selected"]})]}),r.jsxs("div",{className:"grid gap-1.5 sm:grid-cols-2 max-h-44 overflow-y-auto rounded-2xl border border-slate-100 bg-slate-50 px-2 py-2",children:[o.map(x=>r.jsxs("label",{className:`flex cursor-pointer items-center gap-2 rounded-2xl border px-2.5 py-2 text-[11px] transition-colors ${a.role_ids.includes(x.id)?"border-slate-300 bg-white":"border-slate-200 bg-slate-50 hover:bg-white"}`,children:[r.jsx("input",{type:"checkbox",checked:a.role_ids.includes(x.id),onChange:()=>h(x.id),disabled:!c,className:"h-3.5 w-3.5 rounded border-slate-300"}),r.jsx("span",{className:"text-slate-800",children:x.name})]},x.id)),!o.length&&r.jsx("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-3 py-2 text-[11px] text-slate-500",children:"No roles configured yet."})]})]}),r.jsxs("div",{className:"mt-2 flex items-center justify-end gap-2 pt-2 border-t border-slate-100",children:[r.jsx(Te,{type:"button",variant:"outline",className:"rounded-full border-slate-200 text-xs sm:text-sm font-semibold text-slate-700 hover:bg-slate-50",onClick:s,children:"Cancel"}),r.jsx(Te,{type:"submit",className:"rounded-full bg-blue-600 px-4 py-2 text-xs sm:text-sm font-semibold text-white hover:bg-blue-700 active:scale-95",disabled:d||!c,children:d?"Saving":u?"Update user":"Create user"})]})]})]})})}const Xce=(()=>{try{return JSON.parse(localStorage.getItem("sidebarCollapsed")||"false")}catch{return!1}})(),MB=D7(t=>({sidebarCollapsed:Xce,sidebarMobileOpen:!1,toggleCollapse:()=>t(s=>{const n=!s.sidebarCollapsed;return localStorage.setItem("sidebarCollapsed",JSON.stringify(n)),{sidebarCollapsed:n}}),openMobile:()=>t({sidebarMobileOpen:!0}),closeMobile:()=>t({sidebarMobileOpen:!1}),toggleMobile:()=>t(s=>({sidebarMobileOpen:!s.sidebarMobileOpen}))}));function Qce(){return J.get("/settings/ui-branding/public")}function Zce(){return J.get("/settings/ui-branding")}function Jce(t){return J.put("/settings/ui-branding",t)}function ede(t){return J.post("/settings/ui-branding/assets",t,{headers:{"Content-Type":"multipart/form-data"}})}function tde(t){return J.post("/settings/ui-branding/letterhead",t,{headers:{"Content-Type":"multipart/form-data"}})}const DB=y.createContext({branding:null,setBranding:()=>{},loading:!0}),sde="https://api.nutryah.com/api",nde=sde.replace(/\/api\/?$/,"");function $l(t){if(!t)return;const s=String(t).trim();if(!s)return;if(/^https?:\/\//i.test(s))return s;if(s.startsWith("//"))return`${window.location.protocol}${s}`;const n=s.startsWith("/")?s:`/${s}`;return`${nde}${n}`}function Jw(t){if(!t)return null;const s={...t};return s.primary_color=s.primary_color||"#2563eb",s.primary_color_dark=s.primary_color_dark||null,s.sidebar_bg_color=s.sidebar_bg_color||"#ffffff",s.content_bg_color=s.content_bg_color||"#f9fafb",s.card_bg_color=s.card_bg_color||"#ffffff",s.border_color=s.border_color||"#e5e7eb",s.text_color=s.text_color||"#111827",s.text_muted_color=s.text_muted_color||"#e5e7eb",s.icon_color=s.icon_color||s.text_color||"#2563eb",s.icon_bg_color=s.icon_bg_color||"rgba(37,99,235,0.08)",s.logo_path&&!s.logo_url?s.logo_url=$l(`/media/${String(s.logo_path).replace(/^\/+/,"")}`):s.logo_url&&(s.logo_url=$l(s.logo_url)),s.login_logo_path&&!s.login_logo_url?s.login_logo_url=$l(`/media/${String(s.login_logo_path).replace(/^\/+/,"")}`):s.login_logo_url&&(s.login_logo_url=$l(s.login_logo_url)),s.favicon_path&&!s.favicon_url?s.favicon_url=$l(`/media/${String(s.favicon_path).replace(/^\/+/,"")}`):s.favicon_url&&(s.favicon_url=$l(s.favicon_url)),s.pdf_header_path&&!s.pdf_header_url?s.pdf_header_url=$l(`/media/${String(s.pdf_header_path).replace(/^\/+/,"")}`):s.pdf_header_url&&(s.pdf_header_url=$l(s.pdf_header_url)),s.pdf_footer_path&&!s.pdf_footer_url?s.pdf_footer_url=$l(`/media/${String(s.pdf_footer_path).replace(/^\/+/,"")}`):s.pdf_footer_url&&(s.pdf_footer_url=$l(s.pdf_footer_url)),s}function rde({children:t}){const[s,n]=y.useState(null),[a,i]=y.useState(!0),l=o=>{n(typeof o=="function"?c=>Jw(o(c)):Jw(o))};return y.useEffect(()=>{let o=!0;return(async()=>{try{let d;try{d=(await Qce()).data}catch(h){console.warn("Public branding failed, falling back to /settings/ui-branding",h),d=(await Zce()).data}if(!o)return;console.log("[BrandingProvider] raw branding from API:",d);const u=Jw(d);console.log("[BrandingProvider] normalized branding:",u),n(u)}catch(d){console.error("Failed to load branding",d),se.error("Failed to load customization settings")}finally{o&&i(!1)}})(),()=>{o=!1}},[]),r.jsx(DB.Provider,{value:{branding:s,setBranding:l,loading:a},children:t})}function zm(){return y.useContext(DB)}const ade="#2563eb",ide=t=>!t.startsWith("#")||t.length!==7?"#eff6ff":`${t}1A`,lde=t=>!t.startsWith("#")||t.length!==7?"#bfdbfe":`${t}33`,ode=[{key:"Dashboard",label:"Dashboard",icon:H0,flatLink:{to:"/dashboard",reqAny:["patients.view"]}},{key:"patients",label:"Patients management",icon:Uo,flatLink:{to:"/patients",reqAny:["patients.view","patients.create","patients.update"]}},{key:"patients masters",label:"Patients masters",icon:yr,flatLink:{to:"/patients/masters",reqAny:["patients.masters.view"]}},{key:"MIS",label:"MIS & Analytics",icon:ese,flatLink:{to:"/mis",reqAny:["mis.view"]}},{key:"emr",label:"Patients EMR",icon:gl,flatLink:{to:"/emr",reqAny:["emr.view"]}},{key:"pharmacy",label:"Pharmacy",icon:dr,items:[{key:"pharmacy-inventory",label:"Inventory & Stock",to:"/pharmacy/inventory",icon:zte,reqAny:["pharmacy.inventory.stock.view","pharmacy.inventory.items.view","pharmacy.inventory.po.view"]},{key:"pharmacy-barcode",label:"Barcode / QR Lookup",to:"/inventory/barcode-lookup",icon:ay,reqAny:["pharmacy.inventory.stock.view"]},{key:"pharmacy RX",label:"Pharmacy RX",to:"/pharmacy/rx",icon:O4,reqAny:["pharmacy.inventory.stock.view"]},{key:"pharmacy dispense",label:"Pharmacy Dispense",to:"/pharmacy/dispense",icon:s1,reqAny:["pharmacy.inventory.stock.view"]}]},{key:"user-mgmt",label:"User Management",icon:$a,items:[{key:"departments",label:"Departments",to:"/admin/departments",icon:fa,reqAny:["departments.view","departments.create","departments.update","departments.delete"]},{key:"roles",label:"Roles",to:"/admin/roles",icon:$a,reqAny:["roles.view","roles.create","roles.update","roles.delete"]},{key:"users",label:"Users",to:"/admin/users",icon:Uo,reqAny:["users.view","users.create","users.update","users.delete"]}]},{key:"op",label:"OP",icon:Es,items:[{key:"op-dashboard",label:"Dashboard",to:"/opd/dashboard",icon:H0,reqAny:["appointments.view","mis.opd.view"]},{key:"appointments",label:"Appointments",to:"/opd/appointments",icon:I4,reqAny:["appointments.view","appointments.create"]},{key:"triage",label:"Vitals (Triage)",to:"/opd/triage",icon:Vs,reqAny:["vitals.create"]},{key:"queue",label:"Queue",to:"/opd/queue",icon:lne,reqAny:["appointments.view","visits.view"]},{key:"followups",label:"Follow-ups (Waiting)",to:"/opd/followups",icon:lr,reqAny:["appointments.view","appointments.update"]},{key:"no-shows",label:"No-show Reschedule",to:"/opd/no-shows",icon:Wse,reqAny:["appointments.view","appointments.update"]},{key:"Doctor Fees",label:"Doctor Fees",to:"/opd/doctor-fees",icon:P_,reqAny:["appointments.view","appointments.update"]}]},{key:"ip",label:"IP",icon:kn,items:[{key:"ipd-admissions",label:"Admissions",to:"/ipd/admissions",icon:Ise,reqAny:["ipd.view","ipd.manage"]},{key:"ipd-tracking",label:"Tracking",to:"/ipd/tracking",icon:H0,reqAny:["ipd.tracking.view"]},{key:"ipd-my",label:"My Admissions",to:"/ipd/my",icon:O4,reqAny:["ipd.my.view","ipd.doctor"]},{key:"ipd-discharged",label:"Discharged",to:"/ipd/discharged",icon:F7,reqAny:["ipd.discharged.view"]},{key:"ipd-bedboard",label:"Bedboard",to:"/ipd/bedboard",icon:kn,reqAny:["ipd.bedboard.view"]},{key:"ipd-masters",label:"IPD Masters",to:"/ipd/masters",icon:Ei,reqAny:["ipd.masters.manage","ipd.packages.manage"]}]},{key:"lab",label:"Laboratory",icon:Li,items:[{key:"lab-orders",label:"Orders & Reporting",to:"/lab/orders",icon:Li,reqAny:["lab.orders.view","lab.orders.create","orders.lab.view","orders.lab.create"]},{key:"lab-masters",label:"Lab Masters (NABL)",to:"/lab/masters",icon:Ei,reqAny:["lab.masters.manage"]},{key:"LAB_SERVICE MASTER",label:"LAB_SERVICE MASTER",to:"/lab/service/masters",icon:Ei,reqAny:["lab.masters.manage"]},{key:"LAB ANALYAER STAGING",label:"LAB ANALYAER STAGING",to:"/lis/analyzer-staging",icon:Ei,reqAny:["lab.masters.manage"]},{key:"LAB_DEVICE MAPING",label:"LAB_DEVICE MAPING",to:"/lis/device-mapping",icon:Ei,reqAny:["lab.masters.manage"]}]},{key:"ris",label:"Radiology",icon:ay,items:[{key:"ris-orders",label:"Orders & Reporting",to:"/ris/orders",icon:ay,reqAny:["radiology.orders.view","radiology.orders.create","orders.ris.view","orders.ris.create","radiology.report.create","radiology.report.approve","radiology.schedule.manage","radiology.scan.update"]},{key:"ris-masters",label:"RIS Masters",to:"/ris/masters",icon:Ei,reqAny:["radiology.masters.manage"]}]},{key:"ot",label:"Operation Theatre",icon:z7,items:[{key:"ot-masters",label:"OT Masters",to:"/ot/masters",icon:F3,reqAny:["ot.cases.view","ot.cases.create","ipd.view"]},{key:"ot-schedule",label:"OT Schedule",to:"/ot/schedule",icon:ar,reqAny:["ot.cases.view","ot.cases.create","ipd.view"]},{key:"ot-logs",label:"OT Logs / Register",to:"/ot/logs",icon:yr,reqAny:["ot.cases.view","ot.cases.create","ipd.view"]}]},{key:"billing",label:"Billing",icon:P_,items:[{key:"billing-console",label:"Billing Console",to:"/billing",icon:H0,reqAny:["billing.invoices.view","billing.invoices.create"]}]},{key:"settings",label:"Settings",icon:Vne,items:[{key:"schedules",label:"Schedules",to:"/opd/schedules",icon:I4,reqAny:["schedules.manage"]},{key:"ui-branding",label:"Customization & Templates",to:"/settings/branding",icon:rne,reqAny:["settings.customization.view","settings.customization.manage"]},{key:"perm-logs",label:"Permissions (Access Logs)",to:"/admin/permissions",icon:Ei,reqAny:["permissions.view","permissions.create","permissions.update","permissions.delete"]}]}];function cde(){const t=cr(L=>L.user),s=cr(L=>L.modules)||{},n=Xi(),{sidebarCollapsed:a,toggleCollapse:i,sidebarMobileOpen:l,closeMobile:o}=MB(),{branding:c}=zm()||{},d=(c==null?void 0:c.primary_color)||ade,u=(c==null?void 0:c.sidebar_bg_color)||"#ffffff",h=(c==null?void 0:c.text_color)||"#111827",f=(c==null?void 0:c.icon_color)||h,x=(c==null?void 0:c.icon_bg_color)||"rgba(37,99,235,0.08)",b=ide(d),v=lde(d),w=((c==null?void 0:c.org_name)||"").trim()||"NABH HIMS",_=((c==null?void 0:c.org_tagline)||"").trim()||"Smart  Secure  NABH-Standard",S=y.useMemo(()=>{var V;const L=(V=c==null?void 0:c.org_name)==null?void 0:V.trim();if(!L)return"NH";const F=L.split(/\s+/).filter(Boolean);return F.length?F.length===1?F[0].slice(0,2).toUpperCase():(F[0][0]+F[1][0]).toUpperCase():"NH"},[c==null?void 0:c.org_name]);y.useEffect(()=>{if(!l)return;const L=window.scrollY,F={position:document.body.style.position,top:document.body.style.top,width:document.body.style.width,overflow:document.body.style.overflow,ob:document.documentElement.style.overscrollBehavior};return document.body.style.position="fixed",document.body.style.top=`-${L}px`,document.body.style.width="100%",document.body.style.overflow="hidden",document.documentElement.style.overscrollBehavior="none",()=>{document.body.style.position=F.position||"",document.body.style.top=F.top||"",document.body.style.width=F.width||"",document.body.style.overflow=F.overflow||"",document.documentElement.style.overscrollBehavior=F.ob||"",window.scrollTo(0,L)}},[l]);const k=!!(t!=null&&t.is_admin),A=y.useMemo(()=>{const L=Object.values(s).flat().map(V=>typeof V=="string"?V:V==null?void 0:V.code).filter(Boolean),F=((t==null?void 0:t.permissions)||[]).map(V=>typeof V=="string"?V:V==null?void 0:V.code).filter(Boolean);return new Set([...L||[],...F||[]])},[s,t]),T=(L=[])=>k?!0:L.some(F=>A.has(F)),P=y.useMemo(()=>ode.map(L=>{if(L.flatLink){const $=T(L.flatLink.reqAny);return{...L,_visible:$}}const F=(L.items||[]).map($=>({...$,_visible:T($.reqAny)})),V=F.some($=>$._visible);return{...L,items:F,_visible:V}}).filter(L=>L._visible),[A,k]),O=L=>L.flatLink?n.pathname.startsWith(L.flatLink.to):(L.items||[]).some(F=>n.pathname.startsWith(F.to)),[D,I]=y.useState({});y.useEffect(()=>{const L={};P.forEach(F=>{L[F.key]=O(F)}),I(F=>({...F,...L}))},[n.pathname]);const M=L=>I(F=>({...F,[L]:!F[L]})),B=a?"md:w-16":"md:w-64";return r.jsxs(r.Fragment,{children:[r.jsx("div",{onClick:o,className:`fixed inset-0 z-40 bg-black/35 backdrop-blur-sm transition-opacity md:hidden ${l?"opacity-100":"pointer-events-none opacity-0"}`}),r.jsxs("aside",{className:["z-50 border-r transition-all duration-300 ease-out","fixed left-0 top-0 h-[100dvh] w-[86vw] max-w-sm md:w-auto",l?"translate-x-0":"-translate-x-full","md:static md:translate-x-0 md:sticky md:top-0 md:h-[100dvh]",B,"grid grid-rows-[auto,1fr,auto] min-h-0","overflow-x-hidden overflow-y-hidden"].join(" "),style:{backgroundColor:u,color:h},children:[r.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-3",children:[r.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[c!=null&&c.logo_url?r.jsx("img",{src:c.logo_url,alt:"Logo",className:"h-8 w-auto rounded-md border border-slate-200 bg-white"}):r.jsx("div",{className:"grid h-8 w-8 place-items-center rounded-xl ring-1",style:{backgroundColor:x,borderColor:v},children:r.jsx("span",{className:"text-xs font-bold",style:{color:f},children:S})}),!a&&r.jsxs("div",{className:"truncate",children:[r.jsx("div",{className:"text-xs font-semibold tracking-tight leading-snug",children:w}),r.jsx("div",{className:"text-[10px] leading-tight",children:_})]})]}),r.jsx("button",{onClick:o,className:"md:hidden inline-flex h-8 w-8 items-center justify-center rounded-xl hover:bg-gray-50 active:scale-95 transition","aria-label":"Close sidebar",children:r.jsx(Kn,{className:"h-5 w-5",style:{color:f}})}),r.jsx("button",{onClick:i,className:"hidden md:inline-flex h-8 w-8 items-center justify-center rounded-xl hover:bg-gray-50 active:scale-95 transition","aria-label":a?"Expand sidebar":"Collapse sidebar",title:a?"Expand":"Collapse",children:a?r.jsx(Om,{className:"h-5 w-5",style:{color:f}}):r.jsx(zx,{className:"h-5 w-5",style:{color:f}})})]}),r.jsxs("nav",{className:"min-h-0 flex-1 overflow-y-auto no-scrollbar y-fade px-2 pb-4 pt-1 space-y-1 overscroll-contain touch-pan-y",children:[P.map(L=>{if(L.flatLink){const z=L.icon||Ei;return r.jsxs(o4,{to:L.flatLink.to,onClick:o,className:({isActive:H})=>["group relative flex h-10 items-center gap-3 rounded-xl px-3 text-sm leading-none transition-colors duration-200 ease-out active:scale-[0.99]",a?"justify-center":""].join(" "),style:({isActive:H})=>H?{color:"#ffffff",backgroundColor:d,boxShadow:`0 0 0 1px ${v}`}:{color:h},title:a?L.label:void 0,children:[r.jsx(z,{className:"h-5 w-5 shrink-0",style:{color:O(L)?"#ffffff":f}}),!a&&r.jsx("span",{className:"transition-all duration-300",children:L.label})]},L.key)}const F=L.icon||Ei,V=!!D[L.key]&&!a,$=O(L);return r.jsxs("div",{className:"rounded-xl",children:[r.jsxs("button",{type:"button",onClick:()=>a?null:M(L.key),className:["w-full flex items-center gap-3 rounded-xl px-3 h-10 text-sm transition-colors duration-200 ease-out",a?"justify-center":"justify-between"].join(" "),title:a?L.label:void 0,style:{color:$?d:h,backgroundColor:$?b:"transparent",boxShadow:$?`0 0 0 1px ${v}`:void 0},children:[r.jsxs("span",{className:"flex items-center gap-3",children:[r.jsx(F,{className:"h-5 w-5 shrink-0",style:{color:f}}),!a&&r.jsx("span",{className:"font-medium",children:L.label})]}),!a&&r.jsx($x,{className:"h-4 w-4 transition-transform",style:{color:f}})]}),V&&r.jsx("div",{className:"mt-1 space-y-1 pl-9",children:L.items.filter(z=>z._visible).map(z=>{const H=z.icon||Ei;return r.jsxs(o4,{to:z.to,onClick:o,className:()=>"group relative flex h-9 items-center gap-2 rounded-lg px-2 text-sm leading-none transition-colors duration-200 ease-out active:scale-[0.99]",style:({isActive:q})=>q?{color:d,backgroundColor:b,boxShadow:`0 0 0 1px ${v}`}:{color:h},children:[r.jsx(H,{className:"h-[18px] w-[18px] shrink-0",style:{color:f}}),r.jsx("span",{children:z.label})]},z.key)})})]},L.key)}),P.length===0&&r.jsx("div",{className:"px-3 py-2 text-xs text-gray-500",children:"No modules granted. Contact administrator."})]}),r.jsx("div",{className:"px-3 pb-3",children:a?r.jsx("div",{className:"grid place-items-center text-[10px] text-gray-400",children:"v1.0"}):r.jsx("div",{className:"rounded-xl border border-gray-100 bg-gray-50 p-3 text-[11px] text-gray-500",children:"Tip: Click the chevron to collapse the sidebar."})})]})]})}function dde(){const{user:t,logout:s,fetchProfile:n}=cr(),{toggleMobile:a}=MB(),{branding:i}=zm()||{},[l,o]=y.useState(new Date),[c,d]=y.useState(typeof navigator<"u"?navigator.onLine:!0),[u,h]=y.useState(!1),[f,x]=y.useState(!1),[b,v]=y.useState(!1),w=(i==null?void 0:i.primary_color)||"#0f172a",S=(i==null?void 0:i.primary_color_dark)||null||w,k=(i==null?void 0:i.text_muted_color)||"#e5e7eb",A=(i==null?void 0:i.icon_color)||k,T=((i==null?void 0:i.org_name)||"").trim()||"NUTRYAH",P=((i==null?void 0:i.org_tagline)||"").trim()||"Smart  Secure  NABH-Standard";y.useEffect(()=>{const F=setInterval(()=>o(new Date),1e3);return()=>clearInterval(F)},[]),y.useEffect(()=>{const F=()=>d(navigator.onLine);return window.addEventListener("online",F),window.addEventListener("offline",F),()=>{window.removeEventListener("online",F),window.removeEventListener("offline",F)}},[]);const O=y.useMemo(()=>t?t.is_admin?"Admin":Array.isArray(t.roles)&&t.roles.length?t.roles[0]:"User":"",[t]),D=y.useMemo(()=>{try{return l.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return l.toTimeString().slice(0,8)}},[l]),I=()=>{x(!0),setTimeout(()=>window.location.reload(),120)},M=async()=>{v(!0);try{await n()}finally{setTimeout(()=>v(!1),500)}},B=r.jsx("svg",{viewBox:"0 0 24 24",className:"h-9 w-9","aria-hidden":"true",fill:"none",stroke:"currentColor",strokeWidth:"1.5",style:{color:A},children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6.75a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.5 20.25a8.25 8.25 0 1 1 15 0v.75H4.5v-.75Z"})}),L=({ok:F})=>r.jsx("span",{title:F?"Online":"Offline",className:`inline-block h-2.5 w-2.5 rounded-full ${F?"bg-emerald-500":"bg-rose-500"} ring-2 ring-white`});return r.jsx("header",{className:"sticky top-0 z-30",style:{backgroundColor:S,color:k},children:r.jsxs("div",{className:"mx-auto flex max-w-7xl items-center justify-between gap-3 px-4 py-2 sm:px-6",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{className:"md:hidden inline-flex items-center justify-center rounded-xl p-2 ring-1 ring-white/20 hover:bg-white/10 active:scale-95 transition",onClick:a,"aria-label":"Open menu",children:r.jsx("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",stroke:"currentColor",strokeWidth:"1.5",fill:"none",style:{color:A},children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 7h16M4 12h16M4 17h16"})})}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-lg font-semibold tracking-tight sm:text-xl",style:{color:k},children:T}),r.jsx("span",{className:"hidden text-[11px] sm:inline-block",style:{color:k},children:P})]})]}),r.jsxs("div",{className:"hidden items-center gap-3 sm:flex",children:[r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-white/15 bg-white/10 px-3 py-1.5 text-sm",children:[r.jsx(L,{ok:c}),r.jsx("span",{className:"tabular-nums",style:{color:k},children:D})]}),r.jsxs("button",{onClick:M,className:`group inline-flex items-center gap-2 rounded-xl border border-white/15 bg-white/10 px-3 py-1.5 text-sm transition ${b?"animate-pulse":"hover:bg-white/15"}`,title:"Sync data",children:[r.jsx("svg",{viewBox:"0 0 24 24",className:`h-5 w-5 ${b?"animate-spin":"group-hover:rotate-90"} transition`,stroke:"currentColor",strokeWidth:"1.5",fill:"none",style:{color:A},children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16 8V4m0 0h4m-4 0l2 2M8 16v4m0 0H4m4 0-2-2M6 8a6 6 0 1 1 12 0 6 6 0 0 1-12 0Z"})}),r.jsx("span",{style:{color:k},children:"Sync"})]}),r.jsxs("button",{onClick:I,className:"inline-flex items-center gap-2 rounded-xl border border-white/15 bg-white/10 px-3 py-1.5 text-sm transition hover:bg-white/15 active:scale-95",title:"Refresh page",children:[r.jsx("svg",{viewBox:"0 0 24 24",className:`h-5 w-5 ${f?"animate-spin":""} transition`,stroke:"currentColor",strokeWidth:"1.5",fill:"none",style:{color:A},children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992V4.356M21 12a9 9 0 1 1-3-6.708"})}),r.jsx("span",{style:{color:k},children:"Refresh"})]})]}),r.jsxs("div",{className:"relative",children:[r.jsxs("button",{onClick:()=>h(F=>!F),className:"group inline-flex items-center gap-3 rounded-2xl border border-white/15 bg-white/10 px-2.5 py-1.5 transition hover:bg-white/15","aria-haspopup":"menu","aria-expanded":u,title:"Account",children:[r.jsxs("div",{className:"relative",children:[r.jsx("span",{className:"absolute -right-0.5 -top-0.5 rounded-full bg-emerald-500 p-1 ring-2 ring-[rgba(0,0,0,0.2)]"}),B]}),r.jsx("div",{className:"hidden min-w-[9rem] text-left sm:block",children:r.jsxs("div",{className:"leading-tight",children:[r.jsx("div",{className:"truncate text-sm font-medium",style:{color:k},children:(t==null?void 0:t.name)||""}),r.jsx("div",{className:"truncate text-[11px]",style:{color:k},children:O})]})}),r.jsx("svg",{viewBox:"0 0 24 24",className:`hidden h-4 w-4 sm:block transition ${u?"rotate-180":""}`,fill:"none",stroke:"currentColor",strokeWidth:"1.5",style:{color:A},children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 9l6 6 6-6"})})]}),r.jsxs("div",{className:`absolute right-0 mt-2 w-64 origin-top-right rounded-2xl border border-gray-200 bg-gray-900 p-3 shadow-lg transition ${u?"scale-100 opacity-100":"pointer-events-none scale-95 opacity-0"}`,children:[r.jsxs("div",{className:"mb-3 flex items-center gap-3",children:[r.jsx("div",{className:"shrink-0",children:B}),r.jsxs("div",{className:"min-w-0",children:[r.jsx("div",{className:"truncate text-sm font-semibold text-gray-100",children:(t==null?void 0:t.name)||""}),r.jsx("div",{className:"truncate text-xs text-gray-300",children:O}),r.jsx("div",{className:"truncate text-[11px] text-gray-300",children:t==null?void 0:t.email})]})]}),r.jsxs("div",{className:"grid gap-2",children:[r.jsxs("button",{onClick:M,className:"flex w-full items-center gap-2 rounded-xl px-3 py-2 text-left text-sm hover:bg-gray-50 hover:text-black/90",children:[r.jsx("svg",{viewBox:"0 0 24 24",className:`h-5 w-5 ${b?"animate-spin":""}`,fill:"none",stroke:"currentColor",strokeWidth:"1.5",style:{color:A},children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12a7.5 7.5 0 0 1 13.5-4.5M19.5 12A7.5 7.5 0 0 1 6 16.5M3 12h3m12 0h3"})}),r.jsx("span",{children:"Sync data"})]}),r.jsxs("button",{onClick:I,className:"flex w-full items-center gap-2 rounded-xl px-3 py-2 text-left text-sm hover:bg-gray-50 hover:text-black/90",children:[r.jsx("svg",{viewBox:"0 0 24 24",className:`h-5 w-5 ${f?"animate-spin":""}`,fill:"none",stroke:"currentColor",strokeWidth:"1.5",style:{color:A},children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992V4.356M21 12a9 9 0 1 1-3-6.708"})}),r.jsx("span",{children:"Refresh page"})]}),r.jsx("div",{className:"my-1 h-px bg-gray-100"}),r.jsxs("button",{onClick:s,className:"flex w-full items-center gap-2 rounded-xl px-3 py-2 text-left text-sm text-rose-600 hover:bg-rose-50",children:[r.jsx("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",fill:"none",stroke:"currentColor",strokeWidth:"1.5",style:{color:A},children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6A2.25 2.25 0 0 0 5.25 5.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15M12 8l-4 4m0 0 4 4m-4-4h12"})}),r.jsx("span",{children:"Logout"})]})]})]})]})]})})}const ude="#2563eb";function hde(){const{branding:t}=zm()||{},s=(t==null?void 0:t.primary_color)||ude,n=(t==null?void 0:t.sidebar_bg_color)||"#f9fafb",a=(t==null?void 0:t.text_color)||"#4b5563";return r.jsx("footer",{className:"w-full border-t text-xs sm:text-[13px]",style:{borderTopColor:s,background:n,color:a},children:r.jsxs("div",{className:"mx-auto flex max-w-6xl flex-col gap-2 px-4 py-3 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"font-medium",children:["Powered by"," ",r.jsx("span",{className:"font-semibold",style:{color:s},children:"NUTRYAH DIGITAL HEALTH"})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1",children:[r.jsx("span",{className:"font-medium",children:"Support:"}),r.jsx("a",{href:"tel:+918870787448",className:"hover:underline",style:{color:s},children:"Mobile: +91 88707 87448"}),r.jsx("span",{className:"hidden text-slate-300 md:inline",children:""}),r.jsx("a",{href:"mailto:support@nutryah.com",className:"hover:underline",style:{color:s},children:"Email: support@nutryah.com"}),r.jsx("span",{className:"hidden text-slate-300 md:inline",children:""}),r.jsx("a",{href:"https://www.nutryah.com",target:"_blank",rel:"noreferrer",className:"hover:underline",style:{color:s},children:"Website: www.nutryah.com"})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1",children:[r.jsx("a",{href:"/privacy-policy",className:"hover:underline",style:{color:s},children:"Privacy Policy"}),r.jsx("span",{className:"text-slate-300",children:"|"}),r.jsx("a",{href:"/terms-and-conditions",className:"hover:underline",style:{color:s},children:"Terms & Conditions"})]})]})})}function mde(){const{branding:t}=zm()||{},s=!!(t!=null&&t.content_bg_color),n=s?"min-h-dvh":"min-h-dvh bg-gradient-to-b from-gray-50 to-white",a=s?{backgroundColor:t.content_bg_color,color:t.text_color||void 0}:void 0;return r.jsxs("div",{className:n,style:a,children:[r.jsxs("div",{className:"flex min-h-dvh",children:[r.jsx(cde,{}),r.jsxs("div",{className:"flex min-h-dvh flex-1 flex-col",children:[r.jsx(dde,{}),r.jsx("main",{className:"flex-1",children:r.jsx("div",{className:"mx-auto w-full max-w-7xl px-4 py-4 sm:px-6 lg:px-8",children:r.jsx(t7,{})})})]})]}),r.jsx(hde,{})]})}function fde(){const{user:t,loading:s,fetchProfile:n}=cr(),[a,i]=y.useState(!1),l=localStorage.getItem("access_token"),o=Xi();return y.useEffect(()=>{l&&!t&&!s&&(i(!0),n().finally(()=>i(!1)))},[l,t,s,n]),l?a||s||!t&&l?r.jsx("div",{className:"min-h-screen grid place-items-center text-sm",children:"Loading"}):r.jsx(t7,{}):r.jsx(e7,{to:"/auth/login",state:{from:o},replace:!0})}function Cn({anyOf:t=[],fallback:s=null,children:n}){const a=cr(d=>d.user),i=cr(d=>d.modules)||{};if(!!(a!=null&&a.is_admin))return n;const o=new Set(Object.values(i).flat().map(d=>typeof d=="string"?d:d==null?void 0:d.code).filter(Boolean));return t.length===0||t.some(d=>o.has(d))?n:s}const Um=(t={})=>{const s={};return Object.entries(t).forEach(([n,a])=>{a!=null&&a!==""&&(s[n]=a)}),s},av=()=>J.get("/ipd/wards"),pde=t=>J.post("/ipd/wards",t),xde=t=>J.delete(`/ipd/wards/${t}`),Gx=(t={})=>J.get("/ipd/rooms",{params:Um(t)}),gde=t=>J.post("/ipd/rooms",t),yde=t=>J.delete(`/ipd/rooms/${t}`),Nl=(t={})=>J.get("/ipd/beds",{params:Um(t)}),bde=t=>J.post("/ipd/beds",t),vde=t=>J.delete(`/ipd/beds/${t}`),Nde=(t,s)=>J.patch(`/ipd/beds/${t}/state`,null,{params:Um(s)}),OB=()=>J.get("/ipd/packages"),wde=t=>J.post("/ipd/packages",t),jde=t=>J.delete(`/ipd/packages/${t}`),_de=(t={})=>J.get("/ipd/bed-rates",{params:Um(t)}),Sde=t=>J.post("/ipd/bed-rates",t),Cde=t=>J.delete(`/ipd/bed-rates/${t}`),iv=(t={})=>J.get("/ipd/admissions",{params:Um(t)}),kde=t=>J.post("/ipd/admissions",t),RB=async t=>{var s,n;try{return await J.get(`/ipd/admissions/${t}`)}catch(a){const i=(s=a==null?void 0:a.response)==null?void 0:s.status;if(i===404||i===405)try{return await J.get(`/ipd/admission/${t}`)}catch(l){const o=(n=l==null?void 0:l.response)==null?void 0:n.status;if(o===404||o===405){const{data:c=[]}=await J.get("/ipd/admissions",{params:{limit:500}}),d=(c||[]).find(u=>Number(u==null?void 0:u.id)===Number(t));if(!d){const u=new Error("Not found");throw u.status=404,u}return{data:d}}throw l}throw a}},Ade=t=>J.patch(`/ipd/admissions/${t}/cancel`),Ede=(t,s)=>J.post(`/ipd/admissions/${t}/transfer`,s),Tde=t=>J.get(`/ipd/admissions/${t}/nursing-notes`),Pde=(t,s)=>J.post(`/ipd/admissions/${t}/nursing-notes`,s),Ide=t=>J.get(`/ipd/admissions/${t}/vitals/latest`),Mde=t=>J.get(`/ipd/admissions/${t}/vitals`),Dde=(t,s)=>J.post(`/ipd/admissions/${t}/vitals`,s),Ode=t=>J.get(`/ipd/admissions/${t}/io`),Rde=(t,s)=>J.post(`/ipd/admissions/${t}/io`,s),Lde=t=>J.get(`/ipd/admissions/${t}/shift-handovers`),Bde=(t,s)=>J.post(`/ipd/admissions/${t}/shift-handovers`,s),Fde=t=>J.get(`/ipd/admissions/${t}/rounds`),$de=(t,s)=>J.post(`/ipd/admissions/${t}/rounds`,s),zde=t=>J.get(`/ipd/admissions/${t}/progress-notes`),Ude=(t,s)=>J.post(`/ipd/admissions/${t}/progress-notes`,s),Vde=t=>J.get(`/ipd/admissions/${t}/referrals`),Hde=(t,s)=>J.post(`/ipd/admissions/${t}/referrals`,s),Wde=t=>J.get(`/ipd/admissions/${t}/assessments/pain`),qde=(t,s)=>J.post(`/ipd/admissions/${t}/assessments/pain`,s),Gde=t=>J.get(`/ipd/admissions/${t}/assessments/fall-risk`),Kde=(t,s)=>J.post(`/ipd/admissions/${t}/assessments/fall-risk`,s),Yde=t=>J.get(`/ipd/admissions/${t}/assessments/pressure-ulcer`),Xde=(t,s)=>J.post(`/ipd/admissions/${t}/assessments/pressure-ulcer`,s),Qde=t=>J.get(`/ipd/admissions/${t}/assessments/nutrition`),Zde=(t,s)=>J.post(`/ipd/admissions/${t}/assessments/nutrition`,s),Jde=t=>J.get(`/ipd/admissions/${t}/medications`),eue=(t,s)=>J.post(`/ipd/admissions/${t}/medications`,s),tue=(t,s)=>J.put(`/ipd/medications/${t}`,s),sue=t=>J.get(`/ipd/admissions/${t}/drug-chart/meta`),nue=(t,s)=>J.put(`/ipd/admissions/${t}/drug-chart/meta`,s),rue=t=>J.get(`/ipd/admissions/${t}/drug-chart/iv-fluids`),aue=(t,s)=>J.post(`/ipd/admissions/${t}/drug-chart/iv-fluids`,s),iue=t=>J.delete(`/ipd/iv-fluids/${t}`),lue=t=>J.get(`/ipd/admissions/${t}/drug-chart/nurses`),oue=(t,s)=>J.post(`/ipd/admissions/${t}/drug-chart/nurses`,s),cue=t=>J.delete(`/ipd/drug-chart/nurses/${t}`),due=t=>J.get(`/ipd/admissions/${t}/drug-chart/doctor-auth`),uue=(t,s)=>J.post(`/ipd/admissions/${t}/drug-chart/doctor-auth`,s),hue=t=>J.delete(`/ipd/drug-chart/doctor-auth/${t}`),mue=t=>J.get(`/ipd/admissions/${t}/drug-chart/pdf`,{responseType:"blob"}),fue=t=>J.get(`/ipd/admissions/${t}/discharge-summary`),pue=(t,s)=>J.post(`/ipd/admissions/${t}/discharge-summary`,s),xue=t=>J.get(`/ipd/admissions/${t}/discharge-checklist`),gue=(t,s)=>J.post(`/ipd/admissions/${t}/discharge-checklist`,s),LB=t=>J.get(`/ipd/admissions/${t}/discharge-meds`),yue=(t,s)=>J.post(`/ipd/admissions/${t}/discharge-meds`,s),bue=(t,s={})=>J.get("/ipd/bed-charges/preview",{params:{admission_id:t,...Um(s)}}),vue=t=>J.get(`/ipd/admissions/${t}/feedback`),Nue=(t,s)=>J.post(`/ipd/admissions/${t}/feedback`,s),lv=t=>J.get(`/patients/${t}`),wue=(...t)=>Dde(...t),jue=(t,s)=>J.post(`/ipd/admissions / ${t} / dressing - transfusion, payload`),_ue=t=>J.get(`/ipd/admissions/${t}/dressing-transfusion`),o1=["General Ward","Semi-Private","Private","Deluxe","Suite","ICU","HDU","PICU","NICU","Isolation Room","Day Care","Observation","Emergency / ER"],ov={initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.18}};function Sue(){return r.jsx(Cn,{anyOf:["ipd.masters.manage","ipd.packages.manage"],children:r.jsxs("div",{className:"min-h-screen bg-slate-50 px-3 py-3 text-black md:px-6 md:py-6",children:[r.jsx(at.div,{...ov,className:"mx-auto flex max-w-6xl flex-col gap-2 rounded-2xl border border-slate-200 bg-white/80 px-3 py-3 shadow-sm md:px-4 md:py-4",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-2xl bg-slate-900 text-slate-50",children:r.jsx(kn,{className:"h-4 w-4"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h1",{className:"text-base font-semibold tracking-tight text-slate-900 md:text-lg",children:"IPD Masters  Wards  Rooms  Beds  Packages"}),r.jsx("p",{className:"text-[11px] text-slate-600 md:text-xs",children:"Configure your in-patient structure and tariffs. These settings drive Admission, Bedboard, Billing and Bed Occupancy flows."})]}),r.jsxs("div",{className:"hidden gap-2 text-[11px] md:flex",children:[r.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-1 text-slate-700",children:"Admin only"}),r.jsx("span",{className:"rounded-full bg-emerald-50 px-2 py-1 text-emerald-700",children:"Live impact on Billing & IPD"})]})]})}),r.jsxs("div",{className:"mx-auto mt-4 flex max-w-6xl flex-col gap-5",children:[r.jsx(Cue,{}),r.jsx(Aue,{}),r.jsx(Tue,{})]})]})})}function Cue(){const[t,s]=y.useState([]),[n,a]=y.useState([]),[i,l]=y.useState([]),[o,c]=y.useState(!1),[d,u]=y.useState(""),[h,f]=y.useState("all"),[x,b]=y.useState(""),[v,w]=y.useState(""),[_,S]=y.useState(""),k=async()=>{var I,M;c(!0),u("");try{const[B,L,F]=await Promise.all([av(),Gx(),Nl()]);s(B.data||[]),a(L.data||[]),l(F.data||[])}catch(B){u(((M=(I=B==null?void 0:B.response)==null?void 0:I.data)==null?void 0:M.detail)||"Failed to load ward/room/bed data.")}finally{c(!1)}};y.useEffect(()=>{k()},[]);const A=y.useMemo(()=>Array.from(new Set((n||[]).map(I=>I.type).filter(Boolean).map(I=>I.trim()))),[n]),T=y.useMemo(()=>Array.from(new Set([...o1,...A])),[A]),P=y.useMemo(()=>{if(!v.trim())return t;const I=v.toLowerCase();return t.filter(M=>String(M.code||"").toLowerCase().includes(I)||String(M.name||"").toLowerCase().includes(I)||String(M.floor||"").toLowerCase().includes(I))},[t,v]),O=y.useMemo(()=>{if(!_.trim())return n;const I=_.toLowerCase();return n.filter(M=>String(M.number||"").toLowerCase().includes(I)||String(M.type||"").toLowerCase().includes(I)||String(M.ward_id||"").toLowerCase().includes(I))},[n,_]),D=y.useMemo(()=>{let I=i;if(h!=="all"&&(I=I.filter(M=>String(M.state||"").toLowerCase()===h)),x.trim()){const M=x.toLowerCase();I=I.filter(B=>String(B.code||"").toLowerCase().includes(M)||String(B.room_id||"").toLowerCase().includes(M))}return I},[i,h,x]);return r.jsxs(at.section,{...ov,className:"space-y-5 rounded-2xl border border-slate-200 bg-white/90 p-4 shadow-sm",children:[r.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsx("div",{className:"mt-0.5 flex h-8 w-8 items-center justify-center rounded-2xl bg-slate-900 text-slate-50",children:r.jsx(fa,{className:"h-4 w-4"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-900 md:text-base",children:"Wards  Rooms  Beds"}),r.jsx("p",{className:"text-[11px] text-slate-600 md:text-xs",children:"Define physical layout of the IPD. Room type drives bed tariffs, occupancy dashboard and billing logic."})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-1 text-[11px]",children:[T.slice(0,5).map(I=>r.jsx(rS,{type:I},I)),T.length>5&&r.jsxs("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-slate-600",children:["+",T.length-5," more"]})]})]}),d&&r.jsx(Nk,{message:d}),r.jsxs("div",{className:"space-y-3",children:[r.jsx(nS,{title:"New Ward",description:"Create a new ward or block (e.g. GW Block, ICU Block, Labour Ward).",fields:[{name:"code",label:"Ward code",placeholder:"e.g. GW-1",required:!0},{name:"name",label:"Ward name",placeholder:"e.g. General Ward Block 1",required:!0},{name:"floor",label:"Floor / Level",placeholder:"e.g. 1st Floor"}],onSubmit:async I=>{await pde(I),await k()}}),r.jsx(kue,{wards:t,allRoomTypes:T,onCreated:k}),r.jsx(nS,{title:"New Bed",description:"Add individual beds to rooms. Bed codes should be intuitive (e.g. GW-101-A).",fields:[{name:"room_id",label:"Room",type:"select",required:!0,options:n.map(I=>({value:I.id,label:`Ward ${I.ward_id}  Room ${I.number} (${I.type||"Unspecified"})`})),placeholder:"Select room"},{name:"code",label:"Bed code",placeholder:"e.g. GW-101-A",required:!0}],onSubmit:async I=>{await bde(I),await k()}})]}),r.jsx("div",{className:"rounded-2xl border border-slate-100 bg-slate-50/70 px-3 py-2 text-[11px] text-slate-700",children:r.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[r.jsxs("div",{className:"inline-flex items-center gap-1 font-medium",children:[r.jsx($r,{className:"h-3.5 w-3.5"}),"Quick filters"]}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"text-slate-500",children:"Ward:"}),r.jsx("input",{className:"h-7 rounded-full border border-slate-200 bg-white px-2 text-[11px] focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",placeholder:"Search code / name",value:v,onChange:I=>w(I.target.value)})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"text-slate-500",children:"Room:"}),r.jsx("input",{className:"h-7 rounded-full border border-slate-200 bg-white px-2 text-[11px] focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",placeholder:"Search number / type",value:_,onChange:I=>S(I.target.value)})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-1",children:[r.jsx("span",{className:"text-slate-500",children:"Beds:"}),r.jsx("input",{className:"h-7 rounded-full border border-slate-200 bg-white px-2 text-[11px] focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",placeholder:"Search bed code",value:x,onChange:I=>b(I.target.value)}),r.jsx("div",{className:"inline-flex rounded-full border border-slate-200 bg-white p-0.5",children:["all","vacant","occupied","reserved"].map(I=>r.jsx("button",{type:"button",onClick:()=>f(I),className:`px-2.5 py-1 text-[10px] capitalize rounded-full transition ${h===I?"bg-slate-900 text-white shadow-sm":"text-slate-600 hover:bg-slate-50"}`,children:I},I))})]})]})]})}),r.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[r.jsx(gp,{title:"Wards",items:P,cols:[["code","Code"],["name","Name"],["floor","Floor"]],onDelete:I=>xde(I).then(k)}),r.jsx(gp,{title:"Rooms",items:O,cols:[["ward_id","Ward ID"],["number","Room No"],["type","Room Type"]],renderValue:(I,M)=>I==="type"?r.jsx(rS,{type:M}):String(M??""),onDelete:I=>yde(I).then(k)}),r.jsx(gp,{title:"Beds",items:D,cols:[["room_id","Room ID"],["code","Bed code"],["state","Status"]],renderValue:(I,M)=>I==="state"?r.jsx(Pue,{state:M}):String(M??""),onDelete:I=>vde(I).then(k)})]}),o&&r.jsx(wk,{})]})}function kue({wards:t=[],allRoomTypes:s=[],onCreated:n}){const[a,i]=y.useState({ward_id:"",number:"",typeChoice:"",customType:""}),[l,o]=y.useState(!1),[c,d]=y.useState(""),u=(f,x)=>{i(b=>({...b,[f]:x})),c&&d("")},h=async f=>{if(f.preventDefault(),d(""),!a.ward_id||!a.number){d("Ward and Room number are required.");return}let x="";if(a.typeChoice==="__custom"){if(!a.customType.trim()){d("Please enter a custom room type.");return}x=a.customType.trim()}else a.typeChoice&&(x=a.typeChoice);o(!0);try{const b={ward_id:a.ward_id,number:a.number,type:x||void 0};await gde(b),i({ward_id:"",number:"",typeChoice:"",customType:""}),n==null||n()}finally{o(!1)}};return r.jsxs("form",{onSubmit:h,className:"grid gap-3 rounded-2xl border border-slate-200 bg-slate-50 p-4 text-sm md:grid-cols-4",children:[r.jsxs("div",{className:"md:col-span-4",children:[r.jsx("div",{className:"text-sm font-medium text-slate-800",children:"New Room"}),r.jsx("p",{className:"mt-0.5 text-[11px] text-slate-500",children:"Link the room to a ward and assign a room type. You can also create custom room types for special units."})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs text-slate-500",children:"Ward"}),r.jsxs("select",{className:"input rounded-xl",value:a.ward_id,onChange:f=>u("ward_id",f.target.value),required:!0,children:[r.jsx("option",{value:"",children:"Select ward"}),t.map(f=>r.jsxs("option",{value:f.id,children:[f.code,"  ",f.name]},f.id))]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs text-slate-500",children:"Room number"}),r.jsx("input",{className:"input rounded-xl",placeholder:"e.g. 101",value:a.number,onChange:f=>u("number",f.target.value),required:!0})]}),r.jsxs("div",{className:"space-y-1 md:col-span-2",children:[r.jsx("label",{className:"text-xs text-slate-500",children:"Room type"}),r.jsxs("select",{className:"input rounded-xl",value:a.typeChoice,onChange:f=>u("typeChoice",f.target.value),children:[r.jsx("option",{value:"",children:"(Optional) Select room type"}),o1.map(f=>r.jsx("option",{value:f,children:f},f)),s.filter(f=>!o1.includes(f)).map(f=>r.jsxs("option",{value:f,children:[f," (existing)"]},f)),r.jsx("option",{value:"__custom",children:"Other (custom)"})]}),a.typeChoice==="__custom"&&r.jsx("input",{className:"input mt-2 rounded-xl",placeholder:"Enter custom room type (e.g. Chemotherapy Day Care)",value:a.customType,onChange:f=>u("customType",f.target.value)}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Standard: General, Semi-Private, Private, Deluxe, ICU, NICU, PICU, HDU, Isolation, Suite, Day Care, etc."})]}),c&&r.jsx("div",{className:"md:col-span-4 text-xs text-rose-600",children:c}),r.jsx("div",{className:"md:col-span-4 flex justify-end",children:r.jsx("button",{type:"submit",className:"btn min-w-[120px] font-semibold",disabled:l,children:l?"Saving":"Save room"})})]})}function Aue(){const[t,s]=y.useState([]),[n,a]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(""),[d,u]=y.useState("all"),[h,f]=y.useState(""),x=async()=>{var w,_;l(!0),c("");try{const[S,k]=await Promise.all([_de(),Gx()]);s(S.data||[]),a(k.data||[])}catch(S){c(((_=(w=S==null?void 0:S.response)==null?void 0:w.data)==null?void 0:_.detail)||"Failed to load bed rates.")}finally{l(!1)}};y.useEffect(()=>{x()},[]);const b=y.useMemo(()=>{const w=(n||[]).map(S=>S.type).filter(Boolean).map(S=>S.trim()),_=(t||[]).map(S=>ej(S.room_type).baseType).filter(Boolean);return Array.from(new Set([...o1,...w,..._]))},[n,t]),v=y.useMemo(()=>{let w=t;if(d!=="all"&&(w=w.filter(_=>(ej(_.room_type).basis||"Daily").toLowerCase()===d)),h.trim()){const _=h.toLowerCase();w=w.filter(S=>String(S.room_type||"").toLowerCase().includes(_)||String(S.daily_rate||"").toLowerCase().includes(_))}return w},[t,d,h]);return r.jsxs(at.section,{...ov,className:"space-y-5 rounded-2xl border border-slate-200 bg-white/90 p-4 shadow-sm",children:[r.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-2xl bg-slate-900 text-slate-50",children:r.jsx(kn,{className:"h-4 w-4"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-900 md:text-base",children:"Bed Rates (Daily & Hourly)"}),r.jsx("p",{className:"text-[11px] text-slate-600 md:text-xs",children:"Configure bed tariffs for each room type. Supports daily and hourly tariffs for short-stay and day care scenarios."})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-[11px]",children:[r.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-slate-50 px-2 py-1",children:[r.jsx($r,{className:"h-3 w-3"}),r.jsx("span",{children:"Tariff basis"}),r.jsx("div",{className:"inline-flex rounded-full bg-white p-0.5",children:["all","daily","hourly"].map(w=>r.jsx("button",{type:"button",onClick:()=>u(w),className:`px-2.5 py-1 rounded-full capitalize transition ${d===w?"bg-slate-900 text-white shadow-sm":"text-slate-600 hover:bg-slate-50"}`,children:w},w))})]}),r.jsx("input",{className:"h-7 rounded-full border border-slate-200 bg-white px-2 text-[11px] focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",placeholder:"Search room type / tariff",value:h,onChange:w=>f(w.target.value)})]})]}),o&&r.jsx(Nk,{message:o}),r.jsx(Eue,{roomTypeOptions:b,onCreated:x}),r.jsx(gp,{title:"Configured Bed Rates",items:v,cols:[["room_type","Room type"],["daily_rate","Tariff ()"],["effective_from","From"],["effective_to","To"],["is_active","Active"]],renderValue:(w,_,S)=>{if(w==="room_type"){const k=ej(_);return r.jsxs("div",{className:"flex flex-wrap items-center gap-1",children:[r.jsx(rS,{type:k.baseType||_}),r.jsx(Iue,{basis:k.basis})]})}return w==="is_active"?r.jsx("span",{className:"text-xs",children:_?"Yes":"No"}):String(_??"")},onDelete:w=>Cde(w).then(x)}),i&&r.jsx(wk,{})]})}function Eue({roomTypeOptions:t=[],onCreated:s}){const[n,a]=y.useState({baseRoomType:"",basis:"daily",amount:"",effective_from:"",effective_to:""}),[i,l]=y.useState(!1),[o,c]=y.useState(""),d=(f,x)=>{a(b=>({...b,[f]:x})),o&&c("")},u=async f=>{if(f.preventDefault(),c(""),!n.baseRoomType){c("Please select a room type.");return}if(!n.amount||Number(n.amount)<=0){c("Tariff amount must be greater than 0.");return}if(!n.effective_from){c("Please select the effective from date.");return}const x=n.basis==="hourly"?"Hourly":"Daily",v={room_type:`${n.baseRoomType} (${x})`,daily_rate:Number(n.amount),effective_from:n.effective_from,effective_to:n.effective_to||void 0};l(!0);try{await Sde(v),a({baseRoomType:"",basis:"daily",amount:"",effective_from:"",effective_to:""}),s==null||s()}finally{l(!1)}},h=n.basis==="hourly"?"Use hourly tariff for day care, observation, ER and short stays.":"Use daily tariff for standard in-patient stays (24 hours basis).";return r.jsxs("form",{onSubmit:u,className:"grid gap-3 rounded-2xl border border-slate-200 bg-slate-50 p-4 text-sm md:grid-cols-4",children:[r.jsxs("div",{className:"md:col-span-4",children:[r.jsx("div",{className:"text-sm font-medium text-slate-800",children:"New Bed Rate"}),r.jsx("p",{className:"mt-0.5 text-[11px] text-slate-500",children:"Select room type, choose daily / hourly, and set tariff with effective dates."})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs text-slate-500",children:"Room type"}),r.jsxs("select",{className:"input rounded-xl",value:n.baseRoomType,onChange:f=>d("baseRoomType",f.target.value),children:[r.jsx("option",{value:"",children:"Select room type"}),t.map(f=>r.jsx("option",{value:f,children:f},f))]}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"Includes standard types  General, Private, ICU, NICU, HDU, Suite, Day Care, etc."})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs text-slate-500",children:"Tariff basis"}),r.jsxs("div",{className:"inline-flex rounded-full border border-slate-200 bg-white p-0.5 text-xs",children:[r.jsx("button",{type:"button",onClick:()=>d("basis","daily"),className:`rounded-full px-3 py-1.5 transition ${n.basis==="daily"?"bg-slate-900 text-white shadow-sm":"text-slate-600 hover:bg-slate-50"}`,children:"Daily"}),r.jsx("button",{type:"button",onClick:()=>d("basis","hourly"),className:`rounded-full px-3 py-1.5 transition ${n.basis==="hourly"?"bg-slate-900 text-white shadow-sm":"text-slate-600 hover:bg-slate-50"}`,children:"Hourly"})]}),r.jsx("p",{className:"text-[11px] text-slate-500",children:h})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs text-slate-500",children:"Tariff amount ()"}),r.jsx("input",{type:"number",min:"0",className:"input rounded-xl",placeholder:"e.g. 2500",value:n.amount,onChange:f=>d("amount",f.target.value)}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"Base amount charged as per selected basis."})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs text-slate-500",children:"Effective from"}),r.jsx("input",{type:"date",className:"input rounded-xl",value:n.effective_from,onChange:f=>d("effective_from",f.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"text-xs text-slate-500",children:["Effective to"," ",r.jsx("span",{className:"text-slate-400",children:"(optional)"})]}),r.jsx("input",{type:"date",className:"input rounded-xl",value:n.effective_to,onChange:f=>d("effective_to",f.target.value)})]}),o&&r.jsx("div",{className:"md:col-span-4 text-xs text-rose-600",children:o}),r.jsx("div",{className:"md:col-span-4 flex justify-end",children:r.jsx("button",{type:"submit",className:"btn min-w-[140px] font-semibold",disabled:i,children:i?"Saving":"Save bed rate"})})]})}function ej(t){if(!t)return{baseType:"",basis:"Daily"};const s=String(t);return/\(hourly\)/i.test(s)?{baseType:s.replace(/\(hourly\)/i,"").trim(),basis:"Hourly"}:/\(daily\)/i.test(s)?{baseType:s.replace(/\(daily\)/i,"").trim(),basis:"Daily"}:{baseType:s.trim(),basis:"Daily"}}function Tue(){const[t,s]=y.useState([]),[n,a]=y.useState(!1),[i,l]=y.useState(""),[o,c]=y.useState(""),d=async()=>{var h,f;a(!0),l("");try{const{data:x}=await OB();s(x||[])}catch(x){l(((f=(h=x==null?void 0:x.response)==null?void 0:h.data)==null?void 0:f.detail)||"Failed to load packages.")}finally{a(!1)}};y.useEffect(()=>{d()},[]);const u=y.useMemo(()=>{if(!o.trim())return t;const h=o.toLowerCase();return t.filter(f=>String(f.name||"").toLowerCase().includes(h))},[t,o]);return r.jsxs(at.section,{...ov,className:"space-y-5 rounded-2xl border border-slate-200 bg-white/90 p-4 shadow-sm",children:[r.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-900 md:text-base",children:"IPD Packages"}),r.jsx("p",{className:"text-[11px] text-slate-600 md:text-xs",children:"Define packages such as Normal Delivery, LSCS, Medical Management, etc., with inclusions and exclusions."})]}),r.jsxs("div",{className:"flex items-center gap-2 text-[11px]",children:[r.jsx($r,{className:"h-3.5 w-3.5 text-slate-500"}),r.jsx("input",{className:"h-7 rounded-full border border-slate-200 bg-white px-2 text-[11px] focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",placeholder:"Search package",value:o,onChange:h=>c(h.target.value)})]})]}),i&&r.jsx(Nk,{message:i}),r.jsx(nS,{title:"New Package",description:"Create a new IPD package with overall charges and inclusions/exclusions.",fields:[{name:"name",label:"Package name",placeholder:"e.g. Normal Delivery",required:!0},{name:"included",label:"Included",placeholder:"e.g. bed, nursing, OT, routine labs"},{name:"excluded",label:"Excluded",placeholder:"e.g. blood, implants, high-value drugs"},{name:"charges",label:"Package charges ()",placeholder:"e.g. 25000",type:"number"}],onSubmit:async h=>{await wde(h),await d()}}),r.jsx(gp,{title:"Package List",items:u,cols:[["name","Name"],["charges","Charges"],["included","Included"],["excluded","Excluded"]],onDelete:h=>jde(h).then(d)}),n&&r.jsx(wk,{})]})}function Nk({message:t}){return r.jsxs("div",{className:"flex items-start gap-2 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[r.jsx(nn,{className:"mt-0.5 h-4 w-4"}),r.jsx("span",{children:t})]})}function nS({title:t,description:s,fields:n,onSubmit:a}){const[i,l]=y.useState({}),[o,c]=y.useState(!1),d=(h,f)=>{l(x=>({...x,[h]:f}))},u=async h=>{h.preventDefault(),c(!0);try{const f={...i};Object.keys(f).forEach(x=>f[x]===""&&delete f[x]),await a(f),l({})}finally{c(!1)}};return r.jsxs("form",{onSubmit:u,className:"grid gap-3 rounded-2xl border border-slate-200 bg-slate-50 p-4 text-sm md:grid-cols-4",children:[r.jsxs("div",{className:"md:col-span-4 space-y-1",children:[r.jsx("div",{className:"text-sm font-medium text-slate-800",children:t}),s&&r.jsx("p",{className:"text-[11px] text-slate-500",children:s})]}),n.map(h=>{var f;return r.jsxs("div",{className:"space-y-1",children:[h.label&&r.jsx("label",{className:"text-xs text-slate-500",children:h.label}),h.type==="select"?r.jsxs("select",{className:"input rounded-xl",value:i[h.name]||"",onChange:x=>d(h.name,x.target.value),required:h.required,children:[r.jsx("option",{value:"",children:h.placeholder||"Select"}),(f=h.options)==null?void 0:f.map(x=>r.jsx("option",{value:x.value,children:x.label},x.value))]}):r.jsx("input",{className:"input rounded-xl",type:h.type||"text",placeholder:h.placeholder||h.name,value:i[h.name]||"",onChange:x=>d(h.name,x.target.value),required:h.required})]},h.name)}),r.jsx("div",{className:"md:col-span-4 flex justify-end pt-1",children:r.jsx("button",{type:"submit",className:"btn min-w-[100px] font-semibold",disabled:o,children:o?"Saving":"Save"})})]})}function gp({title:t,items:s=[],cols:n=[],onDelete:a,renderValue:i}){return r.jsxs("div",{className:"space-y-2",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:t})}),r.jsx("div",{className:"hidden overflow-hidden rounded-xl border border-slate-200 md:block",children:r.jsxs("table",{className:"w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-slate-50 text-xs text-slate-500",children:[n.map(([l,o])=>r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:o||l},l)),r.jsx("th",{className:"px-3 py-2"})]})}),r.jsxs("tbody",{children:[s.map(l=>r.jsxs("tr",{className:"border-t hover:bg-slate-50",children:[n.map(([o])=>r.jsx("td",{className:"px-3 py-2 align-middle",children:i?i(o,l[o],l):String(l[o]??"")},o)),r.jsx("td",{className:"px-3 py-2 text-right",children:r.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full bg-rose-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-rose-700",onClick:()=>a(l.id),children:[r.jsx(wr,{className:"h-4 w-4"}),"Delete"]})})]},l.id)),!s.length&&r.jsx("tr",{children:r.jsx("td",{className:"p-3 text-sm text-slate-500",colSpan:n.length+1,children:"No records found."})})]})]})}),r.jsxs("div",{className:"space-y-3 md:hidden",children:[s.map(l=>r.jsxs("div",{className:"space-y-2 rounded-xl border border-slate-200 bg-white p-3 shadow-sm",children:[n.map(([o,c])=>r.jsxs("div",{className:"text-xs",children:[r.jsxs("span",{className:"text-slate-500",children:[c||o,":"," "]}),i?i(o,l[o],l):r.jsx("span",{className:"text-slate-900",children:String(l[o]??"")})]},o)),r.jsx("div",{className:"pt-1",children:r.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full bg-rose-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-rose-700",onClick:()=>a(l.id),children:[r.jsx(wr,{className:"h-4 w-4"}),"Delete"]})})]},l.id)),!s.length&&r.jsx("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 p-3 text-center text-xs text-slate-500",children:"No records yet."})]})]})}function rS({type:t}){return t?r.jsx("span",{className:"inline-flex items-center rounded-full border border-sky-200 bg-sky-50 px-2 py-0.5 text-[11px] font-medium text-sky-700",children:t}):null}function Pue({state:t}){if(!t)return r.jsx("span",{className:"inline-flex items-center rounded-full border border-slate-200 bg-slate-100 px-2 py-0.5 text-[11px] text-slate-600",children:"Unknown"});const s=String(t).toLowerCase();let n="bg-slate-100 text-slate-700 border-slate-200";return s==="vacant"||s==="available"?n="bg-emerald-50 text-emerald-700 border-emerald-200":s==="occupied"?n="bg-rose-50 text-rose-700 border-rose-200":(s==="reserved"||s==="cleaning")&&(n="bg-amber-50 text-amber-700 border-amber-200"),r.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[11px] capitalize border ${n}`,children:t})}function Iue({basis:t}){const n=(t||"Daily").toLowerCase()==="hourly";return r.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[11px] border ${n?"bg-purple-50 text-purple-700 border-purple-200":"bg-emerald-50 text-emerald-700 border-emerald-200"}`,children:n?"Hourly":"Daily"})}function wk(){return r.jsxs("div",{className:"flex items-center gap-2 pt-1 text-xs text-slate-500",children:[r.jsx(ns,{className:"h-4 w-4 animate-spin"}),"Loading"]})}const Hu=(t={})=>{const s={};return Object.entries(t).forEach(([n,a])=>{a!=null&&a!==""&&(s[n]=a)}),s};function BB(){return J.get("/opd/departments")}function FB({departmentId:t,roleId:s,roleName:n,isDoctor:a}={}){const i=Hu({department_id:t,role_id:s,role:n,is_doctor:typeof a=="boolean"?a:void 0});return J.get("/opd/users",{params:i})}function lI({doctorUserId:t,date:s,detailed:n=!0}){return J.get("/opd/slots",{params:{doctor_user_id:t,date:s,detailed:n}})}function Mue({doctorUserId:t,date:s}){return J.get("/opd/slots/free",{params:{doctor_user_id:t,date:s}})}function Due(t){return J.get("/opd/schedules",{params:{doctor_user_id:t}})}function Oue(t){return J.post("/opd/schedules",t)}function Rue(t){return J.delete(`/opd/schedules/${t}`)}function jk(t=""){const s=t?{q:t}:{};return J.get("/patients",{params:s})}function Lue(t){return J.post("/opd/appointments",t)}function oI(t={}){return J.get("/opd/appointments",{params:Hu(t)})}function Bue(t,s){return J.patch(`/opd/appointments/${t}/status`,{status:s})}function Fue(t,s){return J.post(`/opd/appointments/${t}/reschedule`,s)}function $ue(t={}){return J.get("/opd/appointments/noshow",{params:Hu(t)})}function $B(t={}){return J.get("/opd/queue",{params:Hu(t)})}function zue(t){return J.get(`/opd/visits/${t}`)}function Uue(t,s){return J.put(`/opd/visits/${t}`,s)}function Vue(t){return J.post("/opd/vitals",t)}function Hue(t,s){return J.post(`/opd/visits/${t}/followup`,s)}function Wue(t={}){return J.get("/opd/followups",{params:Hu(t)})}function que(t,s){return J.put(`/opd/followups/${t}`,s)}function Gue(t,s){return J.post(`/opd/followups/${t}/schedule`,s)}function Kue(t={}){return J.get("/opd/doctor-fees",{params:Hu(t)})}function Yue(t){return J.post("/opd/doctor-fees",t)}function Xue(t,s){return J.put(`/opd/doctor-fees/${t}`,s)}function cI(t){if(t.id){const{id:s,...n}=t;return Xue(s,n)}return Yue(t)}function Que(t){return J.delete(`/opd/doctor-fees/${t}`)}function zB(){return BB()}function UB({departmentId:t,roleId:s,isDoctor:n}={}){return FB({departmentId:t,roleId:s,isDoctor:n})}function Zue({dateFrom:t,dateTo:s,doctorId:n}={}){return J.get("/opd/dashboard",{params:Hu({date_from:t,date_to:s,doctor_id:n})})}const tj=10;function Jue({value:t,onChange:s}){const[n,a]=y.useState(""),[i,l]=y.useState(""),[o,c]=y.useState([]),[d,u]=y.useState(0),[h,f]=y.useState(!1),[x,b]=y.useState(null);y.useEffect(()=>{const P=setTimeout(()=>l(n.trim()),300);return()=>clearTimeout(P)},[n]),y.useEffect(()=>{let P=!0;return(async()=>{var D,I;f(!0),b(null);try{const{data:M}=await jk(i||"");if(!P)return;c(Array.isArray(M)?M:[]),u(0)}catch(M){if(!P)return;const B=((I=(D=M==null?void 0:M.response)==null?void 0:D.data)==null?void 0:I.detail)||(M==null?void 0:M.message)||"Could not load patients. Please try again.";b(B),c([]),u(0)}finally{P&&f(!1)}})(),()=>{P=!1}},[i]);const v=Math.max(1,Math.ceil(((o==null?void 0:o.length)||0)/tj)),w=d*tj,_=y.useMemo(()=>(o||[]).slice(w,w+tj),[o,w]),S=P=>{s&&s(P)},k=d===0||h,A=d>=v-1||h,T=t??null;return r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Patient"}),r.jsx("span",{className:"text-sm font-medium text-slate-900",children:"Search and select patient for admission"})]}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"Search by UHID, name, phone or email and choose the correct patient."})]}),r.jsxs("div",{className:"relative",children:[r.jsx(es,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),r.jsx("input",{className:"w-full rounded-2xl border border-slate-200 bg-white px-9 py-2.5 text-sm text-slate-900 placeholder:text-slate-400 shadow-sm outline-none transition focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Search by UHID, name, phone, email",value:n,onChange:P=>a(P.target.value)})]}),r.jsxs("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm",children:[r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-slate-50 text-xs text-slate-500",children:[r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"UHID"}),r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Name"}),r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Phone"}),r.jsx("th",{className:"px-4 py-2 text-right font-medium",children:"Action"})]})}),r.jsxs("tbody",{children:[h&&r.jsx("tr",{children:r.jsx("td",{colSpan:4,className:"px-4 py-6 text-center text-sm text-slate-500",children:r.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 px-3 py-1.5 text-xs text-slate-600",children:[r.jsx(ns,{className:"h-4 w-4 animate-spin"}),"Loading patients"]})})}),!h&&x&&r.jsx("tr",{children:r.jsx("td",{colSpan:4,className:"px-4 py-6 text-center text-sm text-rose-600",children:x})}),!h&&!x&&_.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:4,className:"px-4 py-6 text-center text-sm text-slate-500",children:"No patients found. Try a different search."})}),!h&&!x&&_.map(P=>{const O=T===P.id,D=`${P.first_name||""} ${P.last_name||""}`.trim();return r.jsxs("tr",{className:`border-t text-sm transition hover:bg-slate-50 ${O?"bg-sky-50":""}`,children:[r.jsx("td",{className:"px-4 py-2 align-middle text-slate-800",children:r.jsxs("div",{className:"flex items-center gap-2",children:[O&&r.jsx(Dn,{className:"h-4 w-4 text-sky-500"}),r.jsx("span",{className:"font-medium",children:P.uhid||""})]})}),r.jsx("td",{className:"px-4 py-2 align-middle text-slate-800",children:D||P.name||""}),r.jsx("td",{className:"px-4 py-2 align-middle text-slate-700",children:P.phone||""}),r.jsx("td",{className:"px-4 py-2 align-middle text-right",children:r.jsx("button",{type:"button",onClick:()=>S(P.id),className:`inline-flex items-center rounded-full px-4 py-1.5 text-xs font-semibold shadow-sm transition ${O?"bg-sky-600 text-white hover:bg-sky-700":"bg-slate-900 text-white hover:bg-slate-800"}`,children:O?"Selected":"Select"})})]},P.id)})]})]})}),r.jsxs("div",{className:"flex flex-col items-center justify-between gap-3 border-t border-slate-100 px-4 py-3 text-xs text-slate-600 sm:flex-row",children:[r.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-3 py-1.5 font-medium shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",onClick:()=>u(P=>Math.max(0,P-1)),disabled:k,children:[r.jsx(zx,{className:"h-4 w-4"}),"Prev"]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Page ",r.jsx("span",{className:"font-medium",children:d+1})," / ",v]}),r.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-3 py-1.5 font-medium shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",onClick:()=>u(P=>Math.min(v-1,P+1)),disabled:A,children:["Next",r.jsx(Om,{className:"h-4 w-4"})]})]})]})]})}function VB({value:t,onChange:s,label:n="Allocate Bed (Ward  Room  Bed)"}){const[a,i]=y.useState([]),[l,o]=y.useState([]),[c,d]=y.useState([]),[u,h]=y.useState(""),[f,x]=y.useState(""),[b,v]=y.useState(!1),[w,_]=y.useState(!1),[S,k]=y.useState(!1),[A,T]=y.useState("");y.useEffect(()=>{let M=!0;return(async()=>{var L,F;v(!0),T("");try{const{data:V}=await av();if(!M)return;i(V||[])}catch(V){if(!M)return;console.error("listWards error",V),T(((F=(L=V==null?void 0:V.response)==null?void 0:L.data)==null?void 0:F.detail)||"Failed to load wards. Please refresh and try again."),i([])}finally{M&&v(!1)}})(),()=>{M=!1}},[]),y.useEffect(()=>{let M=!0;return o([]),x(""),d([]),T(""),s==null||s(null),u?((async()=>{var L,F;_(!0);try{const{data:V}=await Gx({ward_id:Number(u)});if(!M)return;o(V||[])}catch(V){if(!M)return;console.error("listRooms error",V),T(((F=(L=V==null?void 0:V.response)==null?void 0:L.data)==null?void 0:F.detail)||"Failed to load rooms for this ward."),o([])}finally{M&&_(!1)}})(),()=>{M=!1}):void 0},[u]),y.useEffect(()=>{let M=!0;return d([]),T(""),s==null||s(null),f?((async()=>{var L,F;k(!0);try{const{data:V}=await Nl({room_id:Number(f)});if(!M)return;d(V||[])}catch(V){if(!M)return;console.error("listBeds error",V),T(((F=(L=V==null?void 0:V.response)==null?void 0:L.data)==null?void 0:F.detail)||"Failed to load beds for this room."),d([])}finally{M&&k(!1)}})(),()=>{M=!1}):void 0},[f]);const P=y.useMemo(()=>{const M=t?Number(t):null;return M&&c.find(B=>B.id===M)||null},[c,t]),O=M=>{h(M.target.value)},D=M=>{x(M.target.value)},I=M=>{const B=M.target.value,L=B?Number(B):null;s==null||s(L)};return r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Bed Allocation"}),r.jsx("span",{className:"text-sm font-medium text-slate-900",children:n})]}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"Select ward, then room, then an available bed for this admission."})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[r.jsx(fa,{className:"h-4 w-4 text-slate-500"}),r.jsx("span",{className:"font-medium",children:"Ward"})]}),r.jsxs("div",{className:"relative",children:[b&&r.jsx(ns,{className:"absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 animate-spin text-slate-400"}),r.jsxs("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:u,onChange:O,disabled:b,children:[r.jsx("option",{value:"",children:b?"Loading wards":"Select ward"}),a.map(M=>r.jsxs("option",{value:M.id,children:[M.code,"  ",M.name]},M.id))]})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[r.jsx(R7,{className:"h-4 w-4 text-slate-500"}),r.jsx("span",{className:"font-medium",children:"Room"})]}),r.jsxs("div",{className:"relative",children:[w&&r.jsx(ns,{className:"absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 animate-spin text-slate-400"}),r.jsxs("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:f,onChange:D,disabled:!u||w||a.length===0,children:[r.jsx("option",{value:"",children:u?w?"Loading rooms":l.length===0?"No rooms in this ward":"Select room":"Select ward first"}),l.map(M=>r.jsxs("option",{value:M.id,children:[M.number,"  ",M.type]},M.id))]})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[r.jsx(kn,{className:"h-4 w-4 text-slate-500"}),r.jsx("span",{className:"font-medium",children:"Bed"})]}),r.jsxs("div",{className:"relative",children:[S&&r.jsx(ns,{className:"absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 animate-spin text-slate-400"}),r.jsxs("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:t||"",onChange:I,disabled:!f||S||l.length===0,children:[r.jsx("option",{value:"",children:f?S?"Loading beds":c.length===0?"No beds in this room":"Select bed":"Select room first"}),c.map(M=>r.jsxs("option",{value:M.id,children:[M.code,M.state&&M.state!=="vacant"?`  ${M.state}`:""]},M.id))]})]})]})]}),P&&r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-2xl border border-emerald-200 bg-emerald-50 px-3 py-2 text-xs text-emerald-800",children:[r.jsx(Dn,{className:"h-4 w-4"}),r.jsx("span",{className:"font-semibold",children:"Selected bed:"}),r.jsx("span",{className:"font-medium",children:P.code}),P.state&&r.jsxs("span",{className:"text-emerald-700",children:[" ",P.state]})]}),A&&r.jsxs("div",{className:"mt-1 flex items-start gap-2 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[r.jsx(nn,{className:"mt-0.5 h-4 w-4"}),r.jsx("span",{children:A})]})]})}function wl({value:t,onChange:s,label:n="Primary Doctor  Department  Role  User"}){const[a,i]=y.useState([]),[l,o]=y.useState(""),[c,d]=y.useState([]),[u,h]=y.useState(!1),[f,x]=y.useState(!1),[b,v]=y.useState("");y.useEffect(()=>{let k=!0;return h(!0),zB().then(A=>{k&&i(A.data||[])}).catch(A=>{var P,O;if(!k)return;console.error("fetchDepartments error",A);const T=((O=(P=A==null?void 0:A.response)==null?void 0:P.data)==null?void 0:O.detail)||"Failed to load departments.";i([]),v(T),se.error(T)}).finally(()=>{k&&h(!1)}),()=>{k=!1}},[]),y.useEffect(()=>{let k=!0;v(""),d([]);const A=l?Number(l):null;if(s==null||s(null,{department_id:A}),!!l)return x(!0),UB({departmentId:A,isDoctor:!0}).then(T=>{k&&d(T.data||[])}).catch(T=>{var O,D;if(!k)return;console.error("fetchDepartmentUsers error",T);const P=((D=(O=T==null?void 0:T.response)==null?void 0:O.data)==null?void 0:D.detail)||"Failed to load doctors.";v(P),d([]),se.error(P)}).finally(()=>{k&&x(!1)}),()=>{k=!1}},[l]);const w=y.useMemo(()=>c.find(k=>k.id===t)||null,[c,t]),_=k=>{const A=k.target.value;o(A)},S=k=>{const A=k.target.value,T=A?Number(A):null,P=l?Number(l):null;s==null||s(T,{department_id:P})};return r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Doctor & Department"}),r.jsx("span",{className:"text-sm font-medium text-slate-900",children:n})]}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"Choose the admitting department and responsible doctor for this stay."})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[r.jsx(fa,{className:"h-4 w-4 text-slate-500"}),r.jsx("span",{className:"font-medium",children:"Department"})]}),r.jsxs("div",{className:"relative",children:[u&&r.jsx(ns,{className:"absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 animate-spin text-slate-400"}),r.jsxs("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:l,onChange:_,disabled:u,children:[r.jsx("option",{value:"",children:u?"Loading departments":"Select department"}),a.map(k=>r.jsx("option",{value:k.id,children:k.name},k.id))]})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[r.jsx(Es,{className:"h-4 w-4 text-slate-500"}),r.jsx("span",{className:"font-medium",children:"Doctor"})]}),r.jsxs("div",{className:"relative",children:[f&&r.jsx(ns,{className:"absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 animate-spin text-slate-400"}),r.jsxs("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:t||"",onChange:S,disabled:!l||f||c.length===0,children:[r.jsx("option",{value:"",children:f?"Loading doctors":l?c.length===0?"No doctors in this department":"Select doctor":"Select department first"}),c.map(k=>r.jsxs("option",{value:k.id,children:[k.name,k.email?` (${k.email})`:""]},k.id))]})]})]})]}),w&&r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-2xl border border-emerald-200 bg-emerald-50 px-3 py-2 text-xs text-emerald-800",children:[r.jsx(Dn,{className:"h-4 w-4"}),r.jsx("span",{className:"font-semibold",children:"Selected doctor:"}),r.jsx("span",{className:"font-medium",children:w.name}),w.email&&r.jsxs("span",{className:"text-emerald-700",children:[" ",w.email]})]}),b&&r.jsxs("div",{className:"flex items-start gap-2 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[r.jsx(nn,{className:"mt-0.5 h-4 w-4"}),r.jsx("span",{children:b})]})]})}function ehe({kind:t="success",title:s,message:n,onClose:a}){const i={success:{bg:"bg-emerald-50",border:"border-emerald-200",text:"text-emerald-700",Icon:Dn},warn:{bg:"bg-amber-50",border:"border-amber-200",text:"text-amber-800",Icon:za},error:{bg:"bg-rose-50",border:"border-rose-200",text:"text-rose-700",Icon:Ux}},l=i[t]||i.success;return r.jsxs("div",{className:`flex w-full max-w-md items-start gap-3 rounded-xl border ${l.border} ${l.bg} p-3 shadow-lg`,children:[r.jsx(l.Icon,{className:`mt-0.5 h-5 w-5 ${l.text}`}),r.jsxs("div",{className:"text-sm",children:[r.jsx("div",{className:"font-medium",children:s}),n?r.jsx("div",{className:"mt-0.5 text-[13px] opacity-90",children:n}):null]}),r.jsx("button",{className:"ml-auto inline-flex h-7 w-7 items-center justify-center rounded-lg hover:bg-black/5",onClick:a,"aria-label":"Close",type:"button",children:r.jsx(Kn,{className:"h-4 w-4"})})]})}const No=t=>typeof t=="number"?Number.isInteger(t)&&t>0:typeof t=="string"&&t.trim()!==""&&/^\d+$/.test(t)?Number(t)>0:!1,the=t=>t?t.length===16?`${t}:00`:t:void 0;function she(){const[t,s]=y.useState([]),[n,a]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(null),[d,u]=y.useState(null),[h,f]=y.useState(null),[x,b]=y.useState(null),[v,w]=y.useState({admission_type:"planned",expected_discharge_at:"",package_id:"",payor_type:"cash",insurer_name:"",policy_number:"",preliminary_diagnosis:"",history:"",care_plan:""}),[_,S]=y.useState(null),k=y.useRef(null),A=D=>{k.current&&clearTimeout(k.current),S(D),k.current=setTimeout(()=>S(null),4500)},T=y.useMemo(()=>t.find(D=>D.id===Number(x))||null,[t,x]);y.useEffect(()=>{let D=!0;return(async()=>{var I,M;l(!0);try{const[B,L]=await Promise.all([Nl(),OB()]);if(!D)return;s(B.data||[]),a(L.data||[])}catch(B){A({kind:"error",title:"Failed to load data",message:((M=(I=B==null?void 0:B.response)==null?void 0:I.data)==null?void 0:M.detail)||"Could not load beds / packages. Please refresh and try again."})}finally{D&&l(!1)}})(),()=>{D=!1}},[]);const P=async D=>{try{const{data:I}=await iv({status:"admitted",patient_id:D});return Array.isArray(I)&&I.length>0?I[0]:null}catch{return null}},O=async D=>{var M;if(D.preventDefault(),i)return;if(!No(o)){A({kind:"warn",title:"Select a patient",message:"Pick a patient before admitting."});return}if(!No(x)){A({kind:"warn",title:"Select a bed",message:"Choose Ward  Room  Bed."});return}if(!t.find(B=>B.id===Number(x))){A({kind:"warn",title:"Selected bed is unavailable",message:"Refresh beds and select again."});return}l(!0);try{const B=await P(Number(o));if(B!=null&&B.id){const V=`ADM-${String(B.id).padStart(6,"0")}`;A({kind:"warn",title:"Patient already admitted",message:`Active admission ${V} exists. Open Tracking / My Admissions to view.`});return}const L={patient_id:Number(o),bed_id:Number(x),admission_type:v.admission_type||"planned",expected_discharge_at:the(v.expected_discharge_at),department_id:No(d)?Number(d):void 0,practitioner_user_id:No(h)?Number(h):void 0,package_id:No(v.package_id)?Number(v.package_id):void 0,payor_type:v.payor_type||"cash",insurer_name:v.insurer_name||"",policy_number:v.policy_number||"",preliminary_diagnosis:v.preliminary_diagnosis||"",history:v.history||"",care_plan:v.care_plan||""};Object.keys(L).forEach(V=>L[V]===void 0&&delete L[V]);const{data:F}=await kde(L);A({kind:"success",title:"Admission created",message:`Admission ADM-${String(F.id).padStart(6,"0")} has been created successfully.`});try{const V=await Nl();s(V.data||[])}catch{}b(null),w(V=>({...V,expected_discharge_at:"",preliminary_diagnosis:"",history:"",care_plan:"",package_id:"",payor_type:"cash",insurer_name:"",policy_number:""}))}catch(B){const L=(M=B==null?void 0:B.response)==null?void 0:M.data,F=Array.isArray(L==null?void 0:L.detail)?L.detail.map($=>$==null?void 0:$.msg).filter(Boolean).join(", "):(L==null?void 0:L.detail)||B.message||"Failed to create admission",V=/Bed not found/i.test(F)?"Please select a valid bed.":/Bed not available/i.test(F)?"That bed is not available. Pick another one.":F;A({kind:"error",title:"Admission failed",message:V})}finally{l(!1)}};return r.jsxs("div",{className:"min-h-screen bg-slate-50 px-4 py-4 md:px-6 md:py-6 text-black",children:[_&&r.jsx("div",{className:"fixed inset-x-0 top-16 z-50 flex justify-center px-4 sm:justify-end sm:px-6",children:r.jsx(ehe,{kind:_.kind,title:_.title,message:_.message,onClose:()=>S(null)})}),r.jsxs("div",{className:"mx-auto flex max-w-6xl flex-col gap-3 md:flex-row md:items-center md:justify-between mb-4",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl font-semibold tracking-tight text-slate-900",children:"IPD Admission"}),r.jsx("p",{className:"mt-1 max-w-2xl text-sm text-slate-600",children:"Use this screen to admit an in-patient. Select the patient, assign a primary doctor and bed, and capture admission details and payer information. The system will automatically prevent duplicate active admissions for the same patient."})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[r.jsx(rn,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{className:"leading-tight",children:[r.jsx("span",{className:"font-medium text-slate-800",children:"Step 1"}),r.jsx("br",{}),"Pick patient"]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[r.jsx(yr,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{className:"leading-tight",children:[r.jsx("span",{className:"font-medium text-slate-800",children:"Step 2"}),r.jsx("br",{}),"Doctor & details"]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[r.jsx(kn,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{className:"leading-tight",children:[r.jsx("span",{className:"font-medium text-slate-800",children:"Step 3"}),r.jsx("br",{}),"Assign bed"]})]})]})]}),r.jsx("div",{className:"mx-auto max-w-6xl",children:r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm",children:[r.jsx("div",{className:"border-b border-slate-200 px-4 py-3",children:r.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:items-center sm:justify-between",children:[r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"New Admission"}),r.jsx("span",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:"IPD  Admission Management"})]})}),r.jsx(Cn,{anyOf:["ipd.manage"],fallback:r.jsxs("div",{className:"p-4 text-xs text-amber-700 bg-amber-50 border-t border-amber-200 rounded-b-2xl",children:["You do not have permission to create admissions. Please contact the administrator to enable ",r.jsx("span",{className:"font-semibold",children:"IPD Manage"})," access."]}),children:r.jsxs("form",{onSubmit:O,className:"space-y-6 p-4 md:p-6 text-sm",children:[r.jsxs("section",{className:"space-y-2",children:[r.jsx(Jue,{value:o??void 0,onChange:c}),No(o)&&r.jsx("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-600",children:"Tip: If this patient already has an active admission, you will see a warning and the system will block duplicate admission."})]}),r.jsx("section",{className:"space-y-2",children:r.jsx(wl,{label:"Primary doctor  Department  Role  User",value:h??void 0,onChange:(D,I)=>{f(D||null),u((I==null?void 0:I.department_id)||null)}})}),r.jsxs("section",{className:"space-y-2",children:[r.jsx(VB,{value:x??"",onChange:D=>b(No(D)?Number(D):null)}),T&&r.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-700",children:[r.jsx("span",{className:"text-slate-500",children:"Selected bed: "}),r.jsx("span",{className:"font-medium text-slate-900",children:T.code}),r.jsx("span",{className:"mx-1 text-slate-400",children:""}),r.jsx("span",{className:"text-slate-500",children:"State: "}),r.jsx("span",{className:["inline-flex items-center rounded-md border px-1.5 py-0.5 text-[11px]",T.state==="vacant"?"border-emerald-200 bg-emerald-50 text-emerald-700":T.state==="reserved"?"border-amber-200 bg-amber-50 text-amber-700":"border-slate-200 bg-slate-100 text-slate-700"].join(" "),children:T.state}),T.reserved_until&&r.jsxs("span",{className:"ml-2 text-slate-500",children:["until"," ",new Date(T.reserved_until).toLocaleString()]})]})]}),r.jsxs("section",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Admission details"}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"Choose admission type, expected discharge and payer details."})]}),(()=>{const D=["insurance","tpa"].includes(v.payor_type);return r.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs text-slate-500",children:"Admission type"}),r.jsx("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:v.admission_type,onChange:I=>w(M=>({...M,admission_type:I.target.value})),children:["planned","emergency","daycare"].map(I=>r.jsx("option",{value:I,children:I},I))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs text-slate-500",children:"Expected discharge"}),r.jsx("input",{type:"datetime-local",className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:v.expected_discharge_at,onChange:I=>w(M=>({...M,expected_discharge_at:I.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs text-slate-500",children:"Package"}),r.jsxs("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:v.package_id,onChange:I=>w(M=>({...M,package_id:I.target.value})),children:[r.jsx("option",{value:"",children:""}),n.map(I=>r.jsx("option",{value:I.id,children:I.name},I.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs text-slate-500",children:"Payor type"}),r.jsx("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:v.payor_type,onChange:I=>w(M=>({...M,payor_type:I.target.value})),children:["cash","insurance","tpa"].map(I=>r.jsx("option",{value:I,children:I},I))})]}),D&&r.jsxs(r.Fragment,{children:[r.jsx("input",{className:"input md:col-span-2 rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Insurer name",value:v.insurer_name,onChange:I=>w(M=>({...M,insurer_name:I.target.value}))}),r.jsx("input",{className:"input rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Policy number",value:v.policy_number,onChange:I=>w(M=>({...M,policy_number:I.target.value}))})]}),r.jsx("input",{className:"input md:col-span-2 rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Preliminary diagnosis",value:v.preliminary_diagnosis,onChange:I=>w(M=>({...M,preliminary_diagnosis:I.target.value}))}),r.jsx("input",{className:"input rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"History",value:v.history,onChange:I=>w(M=>({...M,history:I.target.value}))}),r.jsx("input",{className:"input md:col-span-3 rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Care plan",value:v.care_plan,onChange:I=>w(M=>({...M,care_plan:I.target.value}))})]})})()]}),r.jsxs("div",{className:"flex flex-col gap-2 border-t border-slate-100 pt-4 sm:flex-row sm:items-center sm:justify-end",children:[r.jsx("p",{className:"text-[11px] text-slate-500",children:"Once admitted, you can manage vitals, nursing notes and discharge from the Admission Detail screen."}),r.jsx("button",{type:"submit",className:"btn sm:min-w-[140px]",disabled:i||!No(o)||!No(x),children:i?"Admitting":"Admit patient"})]})]})})]})})]})}function nt(t){const s=cr(o=>o.user),n=cr(o=>o.modules)||{};if(!t||!s)return!1;if(s.is_admin||(s.roles||[]).some(o=>o.name==="Admin"||o.code==="admin"))return!0;const[i]=t.split(".");return(n[i]||[]).some(o=>o.code===t)}const Yl=y.forwardRef(({className:t,...s},n)=>r.jsx("textarea",{className:Ft("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:n,...s}));Yl.displayName="Textarea";function Zt(t,s,{checkForDefaultPrevented:n=!0}={}){return function(i){if(t==null||t(i),n===!1||!i.defaultPrevented)return s==null?void 0:s(i)}}function nhe(t,s){const n=y.createContext(s),a=l=>{const{children:o,...c}=l,d=y.useMemo(()=>c,Object.values(c));return r.jsx(n.Provider,{value:d,children:o})};a.displayName=t+"Provider";function i(l){const o=y.useContext(n);if(o)return o;if(s!==void 0)return s;throw new Error(`\`${l}\` must be used within \`${t}\``)}return[a,i]}function Wu(t,s=[]){let n=[];function a(l,o){const c=y.createContext(o),d=n.length;n=[...n,o];const u=f=>{var S;const{scope:x,children:b,...v}=f,w=((S=x==null?void 0:x[t])==null?void 0:S[d])||c,_=y.useMemo(()=>v,Object.values(v));return r.jsx(w.Provider,{value:_,children:b})};u.displayName=l+"Provider";function h(f,x){var w;const b=((w=x==null?void 0:x[t])==null?void 0:w[d])||c,v=y.useContext(b);if(v)return v;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${l}\``)}return[u,h]}const i=()=>{const l=n.map(o=>y.createContext(o));return function(c){const d=(c==null?void 0:c[t])||l;return y.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return i.scopeName=t,[a,rhe(i,...s)]}function rhe(...t){const s=t[0];if(t.length===1)return s;const n=()=>{const a=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(l){const o=a.reduce((c,{useScope:d,scopeName:u})=>{const f=d(l)[`__scope${u}`];return{...c,...f}},{});return y.useMemo(()=>({[`__scope${s.scopeName}`]:o}),[o])}};return n.scopeName=s.scopeName,n}function HB(t){const s=t+"CollectionProvider",[n,a]=Wu(s),[i,l]=n(s,{collectionRef:{current:null},itemMap:new Map}),o=w=>{const{scope:_,children:S}=w,k=tt.useRef(null),A=tt.useRef(new Map).current;return r.jsx(i,{scope:_,itemMap:A,collectionRef:k,children:S})};o.displayName=s;const c=t+"CollectionSlot",d=mm(c),u=tt.forwardRef((w,_)=>{const{scope:S,children:k}=w,A=l(c,S),T=Ts(_,A.collectionRef);return r.jsx(d,{ref:T,children:k})});u.displayName=c;const h=t+"CollectionItemSlot",f="data-radix-collection-item",x=mm(h),b=tt.forwardRef((w,_)=>{const{scope:S,children:k,...A}=w,T=tt.useRef(null),P=Ts(_,T),O=l(h,S);return tt.useEffect(()=>(O.itemMap.set(T,{ref:T,...A}),()=>void O.itemMap.delete(T))),r.jsx(x,{[f]:"",ref:P,children:k})});b.displayName=h;function v(w){const _=l(t+"CollectionConsumer",w);return tt.useCallback(()=>{const k=_.collectionRef.current;if(!k)return[];const A=Array.from(k.querySelectorAll(`[${f}]`));return Array.from(_.itemMap.values()).sort((O,D)=>A.indexOf(O.ref.current)-A.indexOf(D.ref.current))},[_.collectionRef,_.itemMap])}return[{Provider:o,Slot:u,ItemSlot:b},v,a]}var zr=globalThis!=null&&globalThis.document?y.useLayoutEffect:()=>{},ahe=Cb[" useId ".trim().toString()]||(()=>{}),ihe=0;function Zc(t){const[s,n]=y.useState(ahe());return zr(()=>{n(a=>a??String(ihe++))},[t]),s?`radix-${s}`:""}var lhe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],rs=lhe.reduce((t,s)=>{const n=mm(`Primitive.${s}`),a=y.forwardRef((i,l)=>{const{asChild:o,...c}=i,d=o?n:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),r.jsx(d,{...c,ref:l})});return a.displayName=`Primitive.${s}`,{...t,[s]:a}},{});function ohe(t,s){t&&pd.flushSync(()=>t.dispatchEvent(s))}function da(t){const s=y.useRef(t);return y.useEffect(()=>{s.current=t}),y.useMemo(()=>(...n)=>{var a;return(a=s.current)==null?void 0:a.call(s,...n)},[])}var che=Cb[" useInsertionEffect ".trim().toString()]||zr;function sx({prop:t,defaultProp:s,onChange:n=()=>{},caller:a}){const[i,l,o]=dhe({defaultProp:s,onChange:n}),c=t!==void 0,d=c?t:i;{const h=y.useRef(t!==void 0);y.useEffect(()=>{const f=h.current;f!==c&&console.warn(`${a} is changing from ${f?"controlled":"uncontrolled"} to ${c?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),h.current=c},[c,a])}const u=y.useCallback(h=>{var f;if(c){const x=uhe(h)?h(t):h;x!==t&&((f=o.current)==null||f.call(o,x))}else l(h)},[c,t,l,o]);return[d,u]}function dhe({defaultProp:t,onChange:s}){const[n,a]=y.useState(t),i=y.useRef(n),l=y.useRef(s);return che(()=>{l.current=s},[s]),y.useEffect(()=>{var o;i.current!==n&&((o=l.current)==null||o.call(l,n),i.current=n)},[n,i]),[n,a,l]}function uhe(t){return typeof t=="function"}var hhe=y.createContext(void 0);function cv(t){const s=y.useContext(hhe);return t||s||"ltr"}var sj="rovingFocusGroup.onEntryFocus",mhe={bubbles:!1,cancelable:!0},Kx="RovingFocusGroup",[aS,WB,fhe]=HB(Kx),[phe,qB]=Wu(Kx,[fhe]),[xhe,ghe]=phe(Kx),GB=y.forwardRef((t,s)=>r.jsx(aS.Provider,{scope:t.__scopeRovingFocusGroup,children:r.jsx(aS.Slot,{scope:t.__scopeRovingFocusGroup,children:r.jsx(yhe,{...t,ref:s})})}));GB.displayName=Kx;var yhe=y.forwardRef((t,s)=>{const{__scopeRovingFocusGroup:n,orientation:a,loop:i=!1,dir:l,currentTabStopId:o,defaultCurrentTabStopId:c,onCurrentTabStopIdChange:d,onEntryFocus:u,preventScrollOnEntryFocus:h=!1,...f}=t,x=y.useRef(null),b=Ts(s,x),v=cv(l),[w,_]=sx({prop:o,defaultProp:c??null,onChange:d,caller:Kx}),[S,k]=y.useState(!1),A=da(u),T=WB(n),P=y.useRef(!1),[O,D]=y.useState(0);return y.useEffect(()=>{const I=x.current;if(I)return I.addEventListener(sj,A),()=>I.removeEventListener(sj,A)},[A]),r.jsx(xhe,{scope:n,orientation:a,dir:v,loop:i,currentTabStopId:w,onItemFocus:y.useCallback(I=>_(I),[_]),onItemShiftTab:y.useCallback(()=>k(!0),[]),onFocusableItemAdd:y.useCallback(()=>D(I=>I+1),[]),onFocusableItemRemove:y.useCallback(()=>D(I=>I-1),[]),children:r.jsx(rs.div,{tabIndex:S||O===0?-1:0,"data-orientation":a,...f,ref:b,style:{outline:"none",...t.style},onMouseDown:Zt(t.onMouseDown,()=>{P.current=!0}),onFocus:Zt(t.onFocus,I=>{const M=!P.current;if(I.target===I.currentTarget&&M&&!S){const B=new CustomEvent(sj,mhe);if(I.currentTarget.dispatchEvent(B),!B.defaultPrevented){const L=T().filter(H=>H.focusable),F=L.find(H=>H.active),V=L.find(H=>H.id===w),z=[F,V,...L].filter(Boolean).map(H=>H.ref.current);XB(z,h)}}P.current=!1}),onBlur:Zt(t.onBlur,()=>k(!1))})})}),KB="RovingFocusGroupItem",YB=y.forwardRef((t,s)=>{const{__scopeRovingFocusGroup:n,focusable:a=!0,active:i=!1,tabStopId:l,children:o,...c}=t,d=Zc(),u=l||d,h=ghe(KB,n),f=h.currentTabStopId===u,x=WB(n),{onFocusableItemAdd:b,onFocusableItemRemove:v,currentTabStopId:w}=h;return y.useEffect(()=>{if(a)return b(),()=>v()},[a,b,v]),r.jsx(aS.ItemSlot,{scope:n,id:u,focusable:a,active:i,children:r.jsx(rs.span,{tabIndex:f?0:-1,"data-orientation":h.orientation,...c,ref:s,onMouseDown:Zt(t.onMouseDown,_=>{a?h.onItemFocus(u):_.preventDefault()}),onFocus:Zt(t.onFocus,()=>h.onItemFocus(u)),onKeyDown:Zt(t.onKeyDown,_=>{if(_.key==="Tab"&&_.shiftKey){h.onItemShiftTab();return}if(_.target!==_.currentTarget)return;const S=Nhe(_,h.orientation,h.dir);if(S!==void 0){if(_.metaKey||_.ctrlKey||_.altKey||_.shiftKey)return;_.preventDefault();let A=x().filter(T=>T.focusable).map(T=>T.ref.current);if(S==="last")A.reverse();else if(S==="prev"||S==="next"){S==="prev"&&A.reverse();const T=A.indexOf(_.currentTarget);A=h.loop?whe(A,T+1):A.slice(T+1)}setTimeout(()=>XB(A))}}),children:typeof o=="function"?o({isCurrentTabStop:f,hasTabStop:w!=null}):o})})});YB.displayName=KB;var bhe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function vhe(t,s){return s!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function Nhe(t,s,n){const a=vhe(t.key,n);if(!(s==="vertical"&&["ArrowLeft","ArrowRight"].includes(a))&&!(s==="horizontal"&&["ArrowUp","ArrowDown"].includes(a)))return bhe[a]}function XB(t,s=!1){const n=document.activeElement;for(const a of t)if(a===n||(a.focus({preventScroll:s}),document.activeElement!==n))return}function whe(t,s){return t.map((n,a)=>t[(s+a)%t.length])}var jhe=GB,_he=YB;function She(t,s){return y.useReducer((n,a)=>s[n][a]??n,t)}var sc=t=>{const{present:s,children:n}=t,a=Che(s),i=typeof n=="function"?n({present:a.isPresent}):y.Children.only(n),l=Ts(a.ref,khe(i));return typeof n=="function"||a.isPresent?y.cloneElement(i,{ref:l}):null};sc.displayName="Presence";function Che(t){const[s,n]=y.useState(),a=y.useRef(null),i=y.useRef(t),l=y.useRef("none"),o=t?"mounted":"unmounted",[c,d]=She(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return y.useEffect(()=>{const u=eg(a.current);l.current=c==="mounted"?u:"none"},[c]),zr(()=>{const u=a.current,h=i.current;if(h!==t){const x=l.current,b=eg(u);t?d("MOUNT"):b==="none"||(u==null?void 0:u.display)==="none"?d("UNMOUNT"):d(h&&x!==b?"ANIMATION_OUT":"UNMOUNT"),i.current=t}},[t,d]),zr(()=>{if(s){let u;const h=s.ownerDocument.defaultView??window,f=b=>{const w=eg(a.current).includes(CSS.escape(b.animationName));if(b.target===s&&w&&(d("ANIMATION_END"),!i.current)){const _=s.style.animationFillMode;s.style.animationFillMode="forwards",u=h.setTimeout(()=>{s.style.animationFillMode==="forwards"&&(s.style.animationFillMode=_)})}},x=b=>{b.target===s&&(l.current=eg(a.current))};return s.addEventListener("animationstart",x),s.addEventListener("animationcancel",f),s.addEventListener("animationend",f),()=>{h.clearTimeout(u),s.removeEventListener("animationstart",x),s.removeEventListener("animationcancel",f),s.removeEventListener("animationend",f)}}else d("ANIMATION_END")},[s,d]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:y.useCallback(u=>{a.current=u?getComputedStyle(u):null,n(u)},[])}}function eg(t){return(t==null?void 0:t.animationName)||"none"}function khe(t){var a,i;let s=(a=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:a.get,n=s&&"isReactWarning"in s&&s.isReactWarning;return n?t.ref:(s=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=s&&"isReactWarning"in s&&s.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var dv="Tabs",[Ahe]=Wu(dv,[qB]),QB=qB(),[Ehe,_k]=Ahe(dv),ZB=y.forwardRef((t,s)=>{const{__scopeTabs:n,value:a,onValueChange:i,defaultValue:l,orientation:o="horizontal",dir:c,activationMode:d="automatic",...u}=t,h=cv(c),[f,x]=sx({prop:a,onChange:i,defaultProp:l??"",caller:dv});return r.jsx(Ehe,{scope:n,baseId:Zc(),value:f,onValueChange:x,orientation:o,dir:h,activationMode:d,children:r.jsx(rs.div,{dir:h,"data-orientation":o,...u,ref:s})})});ZB.displayName=dv;var JB="TabsList",eF=y.forwardRef((t,s)=>{const{__scopeTabs:n,loop:a=!0,...i}=t,l=_k(JB,n),o=QB(n);return r.jsx(jhe,{asChild:!0,...o,orientation:l.orientation,dir:l.dir,loop:a,children:r.jsx(rs.div,{role:"tablist","aria-orientation":l.orientation,...i,ref:s})})});eF.displayName=JB;var tF="TabsTrigger",sF=y.forwardRef((t,s)=>{const{__scopeTabs:n,value:a,disabled:i=!1,...l}=t,o=_k(tF,n),c=QB(n),d=aF(o.baseId,a),u=iF(o.baseId,a),h=a===o.value;return r.jsx(_he,{asChild:!0,...c,focusable:!i,active:h,children:r.jsx(rs.button,{type:"button",role:"tab","aria-selected":h,"aria-controls":u,"data-state":h?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:d,...l,ref:s,onMouseDown:Zt(t.onMouseDown,f=>{!i&&f.button===0&&f.ctrlKey===!1?o.onValueChange(a):f.preventDefault()}),onKeyDown:Zt(t.onKeyDown,f=>{[" ","Enter"].includes(f.key)&&o.onValueChange(a)}),onFocus:Zt(t.onFocus,()=>{const f=o.activationMode!=="manual";!h&&!i&&f&&o.onValueChange(a)})})})});sF.displayName=tF;var nF="TabsContent",rF=y.forwardRef((t,s)=>{const{__scopeTabs:n,value:a,forceMount:i,children:l,...o}=t,c=_k(nF,n),d=aF(c.baseId,a),u=iF(c.baseId,a),h=a===c.value,f=y.useRef(h);return y.useEffect(()=>{const x=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(x)},[]),r.jsx(sc,{present:i||h,children:({present:x})=>r.jsx(rs.div,{"data-state":h?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":d,hidden:!x,id:u,tabIndex:0,...o,ref:s,style:{...t.style,animationDuration:f.current?"0s":void 0},children:x&&l})})});rF.displayName=nF;function aF(t,s){return`${t}-trigger-${s}`}function iF(t,s){return`${t}-content-${s}`}var The=ZB,lF=eF,oF=sF,cF=rF;const jl=The,Wi=y.forwardRef(({className:t,...s},n)=>r.jsx(lF,{ref:n,className:Ft("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",t),...s}));Wi.displayName=lF.displayName;const ms=y.forwardRef(({className:t,...s},n)=>r.jsx(oF,{ref:n,className:Ft("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",t),...s}));ms.displayName=oF.displayName;const us=y.forwardRef(({className:t,...s},n)=>r.jsx(cF,{ref:n,className:Ft("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...s}));us.displayName=cF.displayName;function iS(t,[s,n]){return Math.min(n,Math.max(s,t))}function Phe(t,s){return y.useReducer((n,a)=>s[n][a]??n,t)}var Sk="ScrollArea",[dF]=Wu(Sk),[Ihe,Qi]=dF(Sk),uF=y.forwardRef((t,s)=>{const{__scopeScrollArea:n,type:a="hover",dir:i,scrollHideDelay:l=600,...o}=t,[c,d]=y.useState(null),[u,h]=y.useState(null),[f,x]=y.useState(null),[b,v]=y.useState(null),[w,_]=y.useState(null),[S,k]=y.useState(0),[A,T]=y.useState(0),[P,O]=y.useState(!1),[D,I]=y.useState(!1),M=Ts(s,L=>d(L)),B=cv(i);return r.jsx(Ihe,{scope:n,type:a,dir:B,scrollHideDelay:l,scrollArea:c,viewport:u,onViewportChange:h,content:f,onContentChange:x,scrollbarX:b,onScrollbarXChange:v,scrollbarXEnabled:P,onScrollbarXEnabledChange:O,scrollbarY:w,onScrollbarYChange:_,scrollbarYEnabled:D,onScrollbarYEnabledChange:I,onCornerWidthChange:k,onCornerHeightChange:T,children:r.jsx(rs.div,{dir:B,...o,ref:M,style:{position:"relative","--radix-scroll-area-corner-width":S+"px","--radix-scroll-area-corner-height":A+"px",...t.style}})})});uF.displayName=Sk;var hF="ScrollAreaViewport",mF=y.forwardRef((t,s)=>{const{__scopeScrollArea:n,children:a,nonce:i,...l}=t,o=Qi(hF,n),c=y.useRef(null),d=Ts(s,c,o.onViewportChange);return r.jsxs(r.Fragment,{children:[r.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),r.jsx(rs.div,{"data-radix-scroll-area-viewport":"",...l,ref:d,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...t.style},children:r.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:a})})]})});mF.displayName=hF;var po="ScrollAreaScrollbar",Ck=y.forwardRef((t,s)=>{const{forceMount:n,...a}=t,i=Qi(po,t.__scopeScrollArea),{onScrollbarXEnabledChange:l,onScrollbarYEnabledChange:o}=i,c=t.orientation==="horizontal";return y.useEffect(()=>(c?l(!0):o(!0),()=>{c?l(!1):o(!1)}),[c,l,o]),i.type==="hover"?r.jsx(Mhe,{...a,ref:s,forceMount:n}):i.type==="scroll"?r.jsx(Dhe,{...a,ref:s,forceMount:n}):i.type==="auto"?r.jsx(fF,{...a,ref:s,forceMount:n}):i.type==="always"?r.jsx(kk,{...a,ref:s}):null});Ck.displayName=po;var Mhe=y.forwardRef((t,s)=>{const{forceMount:n,...a}=t,i=Qi(po,t.__scopeScrollArea),[l,o]=y.useState(!1);return y.useEffect(()=>{const c=i.scrollArea;let d=0;if(c){const u=()=>{window.clearTimeout(d),o(!0)},h=()=>{d=window.setTimeout(()=>o(!1),i.scrollHideDelay)};return c.addEventListener("pointerenter",u),c.addEventListener("pointerleave",h),()=>{window.clearTimeout(d),c.removeEventListener("pointerenter",u),c.removeEventListener("pointerleave",h)}}},[i.scrollArea,i.scrollHideDelay]),r.jsx(sc,{present:n||l,children:r.jsx(fF,{"data-state":l?"visible":"hidden",...a,ref:s})})}),Dhe=y.forwardRef((t,s)=>{const{forceMount:n,...a}=t,i=Qi(po,t.__scopeScrollArea),l=t.orientation==="horizontal",o=hv(()=>d("SCROLL_END"),100),[c,d]=Phe("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return y.useEffect(()=>{if(c==="idle"){const u=window.setTimeout(()=>d("HIDE"),i.scrollHideDelay);return()=>window.clearTimeout(u)}},[c,i.scrollHideDelay,d]),y.useEffect(()=>{const u=i.viewport,h=l?"scrollLeft":"scrollTop";if(u){let f=u[h];const x=()=>{const b=u[h];f!==b&&(d("SCROLL"),o()),f=b};return u.addEventListener("scroll",x),()=>u.removeEventListener("scroll",x)}},[i.viewport,l,d,o]),r.jsx(sc,{present:n||c!=="hidden",children:r.jsx(kk,{"data-state":c==="hidden"?"hidden":"visible",...a,ref:s,onPointerEnter:Zt(t.onPointerEnter,()=>d("POINTER_ENTER")),onPointerLeave:Zt(t.onPointerLeave,()=>d("POINTER_LEAVE"))})})}),fF=y.forwardRef((t,s)=>{const n=Qi(po,t.__scopeScrollArea),{forceMount:a,...i}=t,[l,o]=y.useState(!1),c=t.orientation==="horizontal",d=hv(()=>{if(n.viewport){const u=n.viewport.offsetWidth<n.viewport.scrollWidth,h=n.viewport.offsetHeight<n.viewport.scrollHeight;o(c?u:h)}},10);return fm(n.viewport,d),fm(n.content,d),r.jsx(sc,{present:a||l,children:r.jsx(kk,{"data-state":l?"visible":"hidden",...i,ref:s})})}),kk=y.forwardRef((t,s)=>{const{orientation:n="vertical",...a}=t,i=Qi(po,t.__scopeScrollArea),l=y.useRef(null),o=y.useRef(0),[c,d]=y.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=bF(c.viewport,c.content),h={...a,sizes:c,onSizesChange:d,hasThumb:u>0&&u<1,onThumbChange:x=>l.current=x,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:x=>o.current=x};function f(x,b){return $he(x,o.current,c,b)}return n==="horizontal"?r.jsx(Ohe,{...h,ref:s,onThumbPositionChange:()=>{if(i.viewport&&l.current){const x=i.viewport.scrollLeft,b=dI(x,c,i.dir);l.current.style.transform=`translate3d(${b}px, 0, 0)`}},onWheelScroll:x=>{i.viewport&&(i.viewport.scrollLeft=x)},onDragScroll:x=>{i.viewport&&(i.viewport.scrollLeft=f(x,i.dir))}}):n==="vertical"?r.jsx(Rhe,{...h,ref:s,onThumbPositionChange:()=>{if(i.viewport&&l.current){const x=i.viewport.scrollTop,b=dI(x,c);l.current.style.transform=`translate3d(0, ${b}px, 0)`}},onWheelScroll:x=>{i.viewport&&(i.viewport.scrollTop=x)},onDragScroll:x=>{i.viewport&&(i.viewport.scrollTop=f(x))}}):null}),Ohe=y.forwardRef((t,s)=>{const{sizes:n,onSizesChange:a,...i}=t,l=Qi(po,t.__scopeScrollArea),[o,c]=y.useState(),d=y.useRef(null),u=Ts(s,d,l.onScrollbarXChange);return y.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),r.jsx(xF,{"data-orientation":"horizontal",...i,ref:u,sizes:n,style:{bottom:0,left:l.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:l.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":uv(n)+"px",...t.style},onThumbPointerDown:h=>t.onThumbPointerDown(h.x),onDragScroll:h=>t.onDragScroll(h.x),onWheelScroll:(h,f)=>{if(l.viewport){const x=l.viewport.scrollLeft+h.deltaX;t.onWheelScroll(x),NF(x,f)&&h.preventDefault()}},onResize:()=>{d.current&&l.viewport&&o&&a({content:l.viewport.scrollWidth,viewport:l.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:d1(o.paddingLeft),paddingEnd:d1(o.paddingRight)}})}})}),Rhe=y.forwardRef((t,s)=>{const{sizes:n,onSizesChange:a,...i}=t,l=Qi(po,t.__scopeScrollArea),[o,c]=y.useState(),d=y.useRef(null),u=Ts(s,d,l.onScrollbarYChange);return y.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),r.jsx(xF,{"data-orientation":"vertical",...i,ref:u,sizes:n,style:{top:0,right:l.dir==="ltr"?0:void 0,left:l.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":uv(n)+"px",...t.style},onThumbPointerDown:h=>t.onThumbPointerDown(h.y),onDragScroll:h=>t.onDragScroll(h.y),onWheelScroll:(h,f)=>{if(l.viewport){const x=l.viewport.scrollTop+h.deltaY;t.onWheelScroll(x),NF(x,f)&&h.preventDefault()}},onResize:()=>{d.current&&l.viewport&&o&&a({content:l.viewport.scrollHeight,viewport:l.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:d1(o.paddingTop),paddingEnd:d1(o.paddingBottom)}})}})}),[Lhe,pF]=dF(po),xF=y.forwardRef((t,s)=>{const{__scopeScrollArea:n,sizes:a,hasThumb:i,onThumbChange:l,onThumbPointerUp:o,onThumbPointerDown:c,onThumbPositionChange:d,onDragScroll:u,onWheelScroll:h,onResize:f,...x}=t,b=Qi(po,n),[v,w]=y.useState(null),_=Ts(s,M=>w(M)),S=y.useRef(null),k=y.useRef(""),A=b.viewport,T=a.content-a.viewport,P=da(h),O=da(d),D=hv(f,10);function I(M){if(S.current){const B=M.clientX-S.current.left,L=M.clientY-S.current.top;u({x:B,y:L})}}return y.useEffect(()=>{const M=B=>{const L=B.target;(v==null?void 0:v.contains(L))&&P(B,T)};return document.addEventListener("wheel",M,{passive:!1}),()=>document.removeEventListener("wheel",M,{passive:!1})},[A,v,T,P]),y.useEffect(O,[a,O]),fm(v,D),fm(b.content,D),r.jsx(Lhe,{scope:n,scrollbar:v,hasThumb:i,onThumbChange:da(l),onThumbPointerUp:da(o),onThumbPositionChange:O,onThumbPointerDown:da(c),children:r.jsx(rs.div,{...x,ref:_,style:{position:"absolute",...x.style},onPointerDown:Zt(t.onPointerDown,M=>{M.button===0&&(M.target.setPointerCapture(M.pointerId),S.current=v.getBoundingClientRect(),k.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",b.viewport&&(b.viewport.style.scrollBehavior="auto"),I(M))}),onPointerMove:Zt(t.onPointerMove,I),onPointerUp:Zt(t.onPointerUp,M=>{const B=M.target;B.hasPointerCapture(M.pointerId)&&B.releasePointerCapture(M.pointerId),document.body.style.webkitUserSelect=k.current,b.viewport&&(b.viewport.style.scrollBehavior=""),S.current=null})})})}),c1="ScrollAreaThumb",gF=y.forwardRef((t,s)=>{const{forceMount:n,...a}=t,i=pF(c1,t.__scopeScrollArea);return r.jsx(sc,{present:n||i.hasThumb,children:r.jsx(Bhe,{ref:s,...a})})}),Bhe=y.forwardRef((t,s)=>{const{__scopeScrollArea:n,style:a,...i}=t,l=Qi(c1,n),o=pF(c1,n),{onThumbPositionChange:c}=o,d=Ts(s,f=>o.onThumbChange(f)),u=y.useRef(void 0),h=hv(()=>{u.current&&(u.current(),u.current=void 0)},100);return y.useEffect(()=>{const f=l.viewport;if(f){const x=()=>{if(h(),!u.current){const b=zhe(f,c);u.current=b,c()}};return c(),f.addEventListener("scroll",x),()=>f.removeEventListener("scroll",x)}},[l.viewport,h,c]),r.jsx(rs.div,{"data-state":o.hasThumb?"visible":"hidden",...i,ref:d,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...a},onPointerDownCapture:Zt(t.onPointerDownCapture,f=>{const b=f.target.getBoundingClientRect(),v=f.clientX-b.left,w=f.clientY-b.top;o.onThumbPointerDown({x:v,y:w})}),onPointerUp:Zt(t.onPointerUp,o.onThumbPointerUp)})});gF.displayName=c1;var Ak="ScrollAreaCorner",yF=y.forwardRef((t,s)=>{const n=Qi(Ak,t.__scopeScrollArea),a=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&a?r.jsx(Fhe,{...t,ref:s}):null});yF.displayName=Ak;var Fhe=y.forwardRef((t,s)=>{const{__scopeScrollArea:n,...a}=t,i=Qi(Ak,n),[l,o]=y.useState(0),[c,d]=y.useState(0),u=!!(l&&c);return fm(i.scrollbarX,()=>{var f;const h=((f=i.scrollbarX)==null?void 0:f.offsetHeight)||0;i.onCornerHeightChange(h),d(h)}),fm(i.scrollbarY,()=>{var f;const h=((f=i.scrollbarY)==null?void 0:f.offsetWidth)||0;i.onCornerWidthChange(h),o(h)}),u?r.jsx(rs.div,{...a,ref:s,style:{width:l,height:c,position:"absolute",right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function d1(t){return t?parseInt(t,10):0}function bF(t,s){const n=t/s;return isNaN(n)?0:n}function uv(t){const s=bF(t.viewport,t.content),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,a=(t.scrollbar.size-n)*s;return Math.max(a,18)}function $he(t,s,n,a="ltr"){const i=uv(n),l=i/2,o=s||l,c=i-o,d=n.scrollbar.paddingStart+o,u=n.scrollbar.size-n.scrollbar.paddingEnd-c,h=n.content-n.viewport,f=a==="ltr"?[0,h]:[h*-1,0];return vF([d,u],f)(t)}function dI(t,s,n="ltr"){const a=uv(s),i=s.scrollbar.paddingStart+s.scrollbar.paddingEnd,l=s.scrollbar.size-i,o=s.content-s.viewport,c=l-a,d=n==="ltr"?[0,o]:[o*-1,0],u=iS(t,d);return vF([0,o],[0,c])(u)}function vF(t,s){return n=>{if(t[0]===t[1]||s[0]===s[1])return s[0];const a=(s[1]-s[0])/(t[1]-t[0]);return s[0]+a*(n-t[0])}}function NF(t,s){return t>0&&t<s}var zhe=(t,s=()=>{})=>{let n={left:t.scrollLeft,top:t.scrollTop},a=0;return function i(){const l={left:t.scrollLeft,top:t.scrollTop},o=n.left!==l.left,c=n.top!==l.top;(o||c)&&s(),n=l,a=window.requestAnimationFrame(i)}(),()=>window.cancelAnimationFrame(a)};function hv(t,s){const n=da(t),a=y.useRef(0);return y.useEffect(()=>()=>window.clearTimeout(a.current),[]),y.useCallback(()=>{window.clearTimeout(a.current),a.current=window.setTimeout(n,s)},[n,s])}function fm(t,s){const n=da(s);zr(()=>{let a=0;if(t){const i=new ResizeObserver(()=>{cancelAnimationFrame(a),a=window.requestAnimationFrame(n)});return i.observe(t),()=>{window.cancelAnimationFrame(a),i.unobserve(t)}}},[t,n])}var wF=uF,Uhe=mF,Vhe=yF;const Or=y.forwardRef(({className:t,children:s,...n},a)=>r.jsxs(wF,{ref:a,className:Ft("relative overflow-hidden",t),...n,children:[r.jsx(Uhe,{className:"h-full w-full rounded-[inherit]",children:s}),r.jsx(jF,{}),r.jsx(Vhe,{})]}));Or.displayName=wF.displayName;const jF=y.forwardRef(({className:t,orientation:s="vertical",...n},a)=>r.jsx(Ck,{ref:a,orientation:s,className:Ft("flex touch-none select-none transition-colors",s==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",s==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...n,children:r.jsx(gF,{className:"relative flex-1 rounded-full bg-border"})}));jF.displayName=Ck.displayName;function Hhe(t,s=globalThis==null?void 0:globalThis.document){const n=da(t);y.useEffect(()=>{const a=i=>{i.key==="Escape"&&n(i)};return s.addEventListener("keydown",a,{capture:!0}),()=>s.removeEventListener("keydown",a,{capture:!0})},[n,s])}var Whe="DismissableLayer",lS="dismissableLayer.update",qhe="dismissableLayer.pointerDownOutside",Ghe="dismissableLayer.focusOutside",uI,_F=y.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Ek=y.forwardRef((t,s)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:a,onPointerDownOutside:i,onFocusOutside:l,onInteractOutside:o,onDismiss:c,...d}=t,u=y.useContext(_F),[h,f]=y.useState(null),x=(h==null?void 0:h.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,b]=y.useState({}),v=Ts(s,D=>f(D)),w=Array.from(u.layers),[_]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),S=w.indexOf(_),k=h?w.indexOf(h):-1,A=u.layersWithOutsidePointerEventsDisabled.size>0,T=k>=S,P=Xhe(D=>{const I=D.target,M=[...u.branches].some(B=>B.contains(I));!T||M||(i==null||i(D),o==null||o(D),D.defaultPrevented||c==null||c())},x),O=Qhe(D=>{const I=D.target;[...u.branches].some(B=>B.contains(I))||(l==null||l(D),o==null||o(D),D.defaultPrevented||c==null||c())},x);return Hhe(D=>{k===u.layers.size-1&&(a==null||a(D),!D.defaultPrevented&&c&&(D.preventDefault(),c()))},x),y.useEffect(()=>{if(h)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(uI=x.body.style.pointerEvents,x.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(h)),u.layers.add(h),hI(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(x.body.style.pointerEvents=uI)}},[h,x,n,u]),y.useEffect(()=>()=>{h&&(u.layers.delete(h),u.layersWithOutsidePointerEventsDisabled.delete(h),hI())},[h,u]),y.useEffect(()=>{const D=()=>b({});return document.addEventListener(lS,D),()=>document.removeEventListener(lS,D)},[]),r.jsx(rs.div,{...d,ref:v,style:{pointerEvents:A?T?"auto":"none":void 0,...t.style},onFocusCapture:Zt(t.onFocusCapture,O.onFocusCapture),onBlurCapture:Zt(t.onBlurCapture,O.onBlurCapture),onPointerDownCapture:Zt(t.onPointerDownCapture,P.onPointerDownCapture)})});Ek.displayName=Whe;var Khe="DismissableLayerBranch",Yhe=y.forwardRef((t,s)=>{const n=y.useContext(_F),a=y.useRef(null),i=Ts(s,a);return y.useEffect(()=>{const l=a.current;if(l)return n.branches.add(l),()=>{n.branches.delete(l)}},[n.branches]),r.jsx(rs.div,{...t,ref:i})});Yhe.displayName=Khe;function Xhe(t,s=globalThis==null?void 0:globalThis.document){const n=da(t),a=y.useRef(!1),i=y.useRef(()=>{});return y.useEffect(()=>{const l=c=>{if(c.target&&!a.current){let d=function(){SF(qhe,n,u,{discrete:!0})};const u={originalEvent:c};c.pointerType==="touch"?(s.removeEventListener("click",i.current),i.current=d,s.addEventListener("click",i.current,{once:!0})):d()}else s.removeEventListener("click",i.current);a.current=!1},o=window.setTimeout(()=>{s.addEventListener("pointerdown",l)},0);return()=>{window.clearTimeout(o),s.removeEventListener("pointerdown",l),s.removeEventListener("click",i.current)}},[s,n]),{onPointerDownCapture:()=>a.current=!0}}function Qhe(t,s=globalThis==null?void 0:globalThis.document){const n=da(t),a=y.useRef(!1);return y.useEffect(()=>{const i=l=>{l.target&&!a.current&&SF(Ghe,n,{originalEvent:l},{discrete:!1})};return s.addEventListener("focusin",i),()=>s.removeEventListener("focusin",i)},[s,n]),{onFocusCapture:()=>a.current=!0,onBlurCapture:()=>a.current=!1}}function hI(){const t=new CustomEvent(lS);document.dispatchEvent(t)}function SF(t,s,n,{discrete:a}){const i=n.originalEvent.target,l=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});s&&i.addEventListener(t,s,{once:!0}),a?ohe(i,l):i.dispatchEvent(l)}var nj="focusScope.autoFocusOnMount",rj="focusScope.autoFocusOnUnmount",mI={bubbles:!1,cancelable:!0},Zhe="FocusScope",Tk=y.forwardRef((t,s)=>{const{loop:n=!1,trapped:a=!1,onMountAutoFocus:i,onUnmountAutoFocus:l,...o}=t,[c,d]=y.useState(null),u=da(i),h=da(l),f=y.useRef(null),x=Ts(s,w=>d(w)),b=y.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;y.useEffect(()=>{if(a){let w=function(A){if(b.paused||!c)return;const T=A.target;c.contains(T)?f.current=T:Nc(f.current,{select:!0})},_=function(A){if(b.paused||!c)return;const T=A.relatedTarget;T!==null&&(c.contains(T)||Nc(f.current,{select:!0}))},S=function(A){if(document.activeElement===document.body)for(const P of A)P.removedNodes.length>0&&Nc(c)};document.addEventListener("focusin",w),document.addEventListener("focusout",_);const k=new MutationObserver(S);return c&&k.observe(c,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",w),document.removeEventListener("focusout",_),k.disconnect()}}},[a,c,b.paused]),y.useEffect(()=>{if(c){pI.add(b);const w=document.activeElement;if(!c.contains(w)){const S=new CustomEvent(nj,mI);c.addEventListener(nj,u),c.dispatchEvent(S),S.defaultPrevented||(Jhe(rme(CF(c)),{select:!0}),document.activeElement===w&&Nc(c))}return()=>{c.removeEventListener(nj,u),setTimeout(()=>{const S=new CustomEvent(rj,mI);c.addEventListener(rj,h),c.dispatchEvent(S),S.defaultPrevented||Nc(w??document.body,{select:!0}),c.removeEventListener(rj,h),pI.remove(b)},0)}}},[c,u,h,b]);const v=y.useCallback(w=>{if(!n&&!a||b.paused)return;const _=w.key==="Tab"&&!w.altKey&&!w.ctrlKey&&!w.metaKey,S=document.activeElement;if(_&&S){const k=w.currentTarget,[A,T]=eme(k);A&&T?!w.shiftKey&&S===T?(w.preventDefault(),n&&Nc(A,{select:!0})):w.shiftKey&&S===A&&(w.preventDefault(),n&&Nc(T,{select:!0})):S===k&&w.preventDefault()}},[n,a,b.paused]);return r.jsx(rs.div,{tabIndex:-1,...o,ref:x,onKeyDown:v})});Tk.displayName=Zhe;function Jhe(t,{select:s=!1}={}){const n=document.activeElement;for(const a of t)if(Nc(a,{select:s}),document.activeElement!==n)return}function eme(t){const s=CF(t),n=fI(s,t),a=fI(s.reverse(),t);return[n,a]}function CF(t){const s=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:a=>{const i=a.tagName==="INPUT"&&a.type==="hidden";return a.disabled||a.hidden||i?NodeFilter.FILTER_SKIP:a.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)s.push(n.currentNode);return s}function fI(t,s){for(const n of t)if(!tme(n,{upTo:s}))return n}function tme(t,{upTo:s}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(s!==void 0&&t===s)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function sme(t){return t instanceof HTMLInputElement&&"select"in t}function Nc(t,{select:s=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&sme(t)&&s&&t.select()}}var pI=nme();function nme(){let t=[];return{add(s){const n=t[0];s!==n&&(n==null||n.pause()),t=xI(t,s),t.unshift(s)},remove(s){var n;t=xI(t,s),(n=t[0])==null||n.resume()}}}function xI(t,s){const n=[...t],a=n.indexOf(s);return a!==-1&&n.splice(a,1),n}function rme(t){return t.filter(s=>s.tagName!=="A")}var ame="Portal",Pk=y.forwardRef((t,s)=>{var c;const{container:n,...a}=t,[i,l]=y.useState(!1);zr(()=>l(!0),[]);const o=n||i&&((c=globalThis==null?void 0:globalThis.document)==null?void 0:c.body);return o?VL.createPortal(r.jsx(rs.div,{...a,ref:s}),o):null});Pk.displayName=ame;var aj=0;function kF(){y.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??gI()),document.body.insertAdjacentElement("beforeend",t[1]??gI()),aj++,()=>{aj===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(s=>s.remove()),aj--}},[])}function gI(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Gl=function(){return Gl=Object.assign||function(s){for(var n,a=1,i=arguments.length;a<i;a++){n=arguments[a];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(s[l]=n[l])}return s},Gl.apply(this,arguments)};function AF(t,s){var n={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&s.indexOf(a)<0&&(n[a]=t[a]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,a=Object.getOwnPropertySymbols(t);i<a.length;i++)s.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(t,a[i])&&(n[a[i]]=t[a[i]]);return n}function ime(t,s,n){if(n||arguments.length===2)for(var a=0,i=s.length,l;a<i;a++)(l||!(a in s))&&(l||(l=Array.prototype.slice.call(s,0,a)),l[a]=s[a]);return t.concat(l||Array.prototype.slice.call(s))}var dy="right-scroll-bar-position",uy="width-before-scroll-bar",lme="with-scroll-bars-hidden",ome="--removed-body-scroll-bar-size";function ij(t,s){return typeof t=="function"?t(s):t&&(t.current=s),t}function cme(t,s){var n=y.useState(function(){return{value:t,callback:s,facade:{get current(){return n.value},set current(a){var i=n.value;i!==a&&(n.value=a,n.callback(a,i))}}}})[0];return n.callback=s,n.facade}var dme=typeof window<"u"?y.useLayoutEffect:y.useEffect,yI=new WeakMap;function ume(t,s){var n=cme(null,function(a){return t.forEach(function(i){return ij(i,a)})});return dme(function(){var a=yI.get(n);if(a){var i=new Set(a),l=new Set(t),o=n.current;i.forEach(function(c){l.has(c)||ij(c,null)}),l.forEach(function(c){i.has(c)||ij(c,o)})}yI.set(n,t)},[t]),n}function hme(t){return t}function mme(t,s){s===void 0&&(s=hme);var n=[],a=!1,i={read:function(){if(a)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(l){var o=s(l,a);return n.push(o),function(){n=n.filter(function(c){return c!==o})}},assignSyncMedium:function(l){for(a=!0;n.length;){var o=n;n=[],o.forEach(l)}n={push:function(c){return l(c)},filter:function(){return n}}},assignMedium:function(l){a=!0;var o=[];if(n.length){var c=n;n=[],c.forEach(l),o=n}var d=function(){var h=o;o=[],h.forEach(l)},u=function(){return Promise.resolve().then(d)};u(),n={push:function(h){o.push(h),u()},filter:function(h){return o=o.filter(h),n}}}};return i}function fme(t){t===void 0&&(t={});var s=mme(null);return s.options=Gl({async:!0,ssr:!1},t),s}var EF=function(t){var s=t.sideCar,n=AF(t,["sideCar"]);if(!s)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var a=s.read();if(!a)throw new Error("Sidecar medium not found");return y.createElement(a,Gl({},n))};EF.isSideCarExport=!0;function pme(t,s){return t.useMedium(s),EF}var TF=fme(),lj=function(){},mv=y.forwardRef(function(t,s){var n=y.useRef(null),a=y.useState({onScrollCapture:lj,onWheelCapture:lj,onTouchMoveCapture:lj}),i=a[0],l=a[1],o=t.forwardProps,c=t.children,d=t.className,u=t.removeScrollBar,h=t.enabled,f=t.shards,x=t.sideCar,b=t.noRelative,v=t.noIsolation,w=t.inert,_=t.allowPinchZoom,S=t.as,k=S===void 0?"div":S,A=t.gapMode,T=AF(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),P=x,O=ume([n,s]),D=Gl(Gl({},T),i);return y.createElement(y.Fragment,null,h&&y.createElement(P,{sideCar:TF,removeScrollBar:u,shards:f,noRelative:b,noIsolation:v,inert:w,setCallbacks:l,allowPinchZoom:!!_,lockRef:n,gapMode:A}),o?y.cloneElement(y.Children.only(c),Gl(Gl({},D),{ref:O})):y.createElement(k,Gl({},D,{className:d,ref:O}),c))});mv.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};mv.classNames={fullWidth:uy,zeroRight:dy};var xme=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function gme(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var s=xme();return s&&t.setAttribute("nonce",s),t}function yme(t,s){t.styleSheet?t.styleSheet.cssText=s:t.appendChild(document.createTextNode(s))}function bme(t){var s=document.head||document.getElementsByTagName("head")[0];s.appendChild(t)}var vme=function(){var t=0,s=null;return{add:function(n){t==0&&(s=gme())&&(yme(s,n),bme(s)),t++},remove:function(){t--,!t&&s&&(s.parentNode&&s.parentNode.removeChild(s),s=null)}}},Nme=function(){var t=vme();return function(s,n){y.useEffect(function(){return t.add(s),function(){t.remove()}},[s&&n])}},PF=function(){var t=Nme(),s=function(n){var a=n.styles,i=n.dynamic;return t(a,i),null};return s},wme={left:0,top:0,right:0,gap:0},oj=function(t){return parseInt(t||"",10)||0},jme=function(t){var s=window.getComputedStyle(document.body),n=s[t==="padding"?"paddingLeft":"marginLeft"],a=s[t==="padding"?"paddingTop":"marginTop"],i=s[t==="padding"?"paddingRight":"marginRight"];return[oj(n),oj(a),oj(i)]},_me=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return wme;var s=jme(t),n=document.documentElement.clientWidth,a=window.innerWidth;return{left:s[0],top:s[1],right:s[2],gap:Math.max(0,a-n+s[2]-s[0])}},Sme=PF(),Gh="data-scroll-locked",Cme=function(t,s,n,a){var i=t.left,l=t.top,o=t.right,c=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(lme,` {
   overflow: hidden `).concat(a,`;
   padding-right: `).concat(c,"px ").concat(a,`;
  }
  body[`).concat(Gh,`] {
    overflow: hidden `).concat(a,`;
    overscroll-behavior: contain;
    `).concat([s&&"position: relative ".concat(a,";"),n==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(l,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(c,"px ").concat(a,`;
    `),n==="padding"&&"padding-right: ".concat(c,"px ").concat(a,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(dy,` {
    right: `).concat(c,"px ").concat(a,`;
  }
  
  .`).concat(uy,` {
    margin-right: `).concat(c,"px ").concat(a,`;
  }
  
  .`).concat(dy," .").concat(dy,` {
    right: 0 `).concat(a,`;
  }
  
  .`).concat(uy," .").concat(uy,` {
    margin-right: 0 `).concat(a,`;
  }
  
  body[`).concat(Gh,`] {
    `).concat(ome,": ").concat(c,`px;
  }
`)},bI=function(){var t=parseInt(document.body.getAttribute(Gh)||"0",10);return isFinite(t)?t:0},kme=function(){y.useEffect(function(){return document.body.setAttribute(Gh,(bI()+1).toString()),function(){var t=bI()-1;t<=0?document.body.removeAttribute(Gh):document.body.setAttribute(Gh,t.toString())}},[])},Ame=function(t){var s=t.noRelative,n=t.noImportant,a=t.gapMode,i=a===void 0?"margin":a;kme();var l=y.useMemo(function(){return _me(i)},[i]);return y.createElement(Sme,{styles:Cme(l,!s,i,n?"":"!important")})},oS=!1;if(typeof window<"u")try{var tg=Object.defineProperty({},"passive",{get:function(){return oS=!0,!0}});window.addEventListener("test",tg,tg),window.removeEventListener("test",tg,tg)}catch{oS=!1}var oh=oS?{passive:!1}:!1,Eme=function(t){return t.tagName==="TEXTAREA"},IF=function(t,s){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[s]!=="hidden"&&!(n.overflowY===n.overflowX&&!Eme(t)&&n[s]==="visible")},Tme=function(t){return IF(t,"overflowY")},Pme=function(t){return IF(t,"overflowX")},vI=function(t,s){var n=s.ownerDocument,a=s;do{typeof ShadowRoot<"u"&&a instanceof ShadowRoot&&(a=a.host);var i=MF(t,a);if(i){var l=DF(t,a),o=l[1],c=l[2];if(o>c)return!0}a=a.parentNode}while(a&&a!==n.body);return!1},Ime=function(t){var s=t.scrollTop,n=t.scrollHeight,a=t.clientHeight;return[s,n,a]},Mme=function(t){var s=t.scrollLeft,n=t.scrollWidth,a=t.clientWidth;return[s,n,a]},MF=function(t,s){return t==="v"?Tme(s):Pme(s)},DF=function(t,s){return t==="v"?Ime(s):Mme(s)},Dme=function(t,s){return t==="h"&&s==="rtl"?-1:1},Ome=function(t,s,n,a,i){var l=Dme(t,window.getComputedStyle(s).direction),o=l*a,c=n.target,d=s.contains(c),u=!1,h=o>0,f=0,x=0;do{if(!c)break;var b=DF(t,c),v=b[0],w=b[1],_=b[2],S=w-_-l*v;(v||S)&&MF(t,c)&&(f+=S,x+=v);var k=c.parentNode;c=k&&k.nodeType===Node.DOCUMENT_FRAGMENT_NODE?k.host:k}while(!d&&c!==document.body||d&&(s.contains(c)||s===c));return(h&&Math.abs(f)<1||!h&&Math.abs(x)<1)&&(u=!0),u},sg=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},NI=function(t){return[t.deltaX,t.deltaY]},wI=function(t){return t&&"current"in t?t.current:t},Rme=function(t,s){return t[0]===s[0]&&t[1]===s[1]},Lme=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},Bme=0,ch=[];function Fme(t){var s=y.useRef([]),n=y.useRef([0,0]),a=y.useRef(),i=y.useState(Bme++)[0],l=y.useState(PF)[0],o=y.useRef(t);y.useEffect(function(){o.current=t},[t]),y.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(i));var w=ime([t.lockRef.current],(t.shards||[]).map(wI),!0).filter(Boolean);return w.forEach(function(_){return _.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),w.forEach(function(_){return _.classList.remove("allow-interactivity-".concat(i))})}}},[t.inert,t.lockRef.current,t.shards]);var c=y.useCallback(function(w,_){if("touches"in w&&w.touches.length===2||w.type==="wheel"&&w.ctrlKey)return!o.current.allowPinchZoom;var S=sg(w),k=n.current,A="deltaX"in w?w.deltaX:k[0]-S[0],T="deltaY"in w?w.deltaY:k[1]-S[1],P,O=w.target,D=Math.abs(A)>Math.abs(T)?"h":"v";if("touches"in w&&D==="h"&&O.type==="range")return!1;var I=vI(D,O);if(!I)return!0;if(I?P=D:(P=D==="v"?"h":"v",I=vI(D,O)),!I)return!1;if(!a.current&&"changedTouches"in w&&(A||T)&&(a.current=P),!P)return!0;var M=a.current||P;return Ome(M,_,w,M==="h"?A:T)},[]),d=y.useCallback(function(w){var _=w;if(!(!ch.length||ch[ch.length-1]!==l)){var S="deltaY"in _?NI(_):sg(_),k=s.current.filter(function(P){return P.name===_.type&&(P.target===_.target||_.target===P.shadowParent)&&Rme(P.delta,S)})[0];if(k&&k.should){_.cancelable&&_.preventDefault();return}if(!k){var A=(o.current.shards||[]).map(wI).filter(Boolean).filter(function(P){return P.contains(_.target)}),T=A.length>0?c(_,A[0]):!o.current.noIsolation;T&&_.cancelable&&_.preventDefault()}}},[]),u=y.useCallback(function(w,_,S,k){var A={name:w,delta:_,target:S,should:k,shadowParent:$me(S)};s.current.push(A),setTimeout(function(){s.current=s.current.filter(function(T){return T!==A})},1)},[]),h=y.useCallback(function(w){n.current=sg(w),a.current=void 0},[]),f=y.useCallback(function(w){u(w.type,NI(w),w.target,c(w,t.lockRef.current))},[]),x=y.useCallback(function(w){u(w.type,sg(w),w.target,c(w,t.lockRef.current))},[]);y.useEffect(function(){return ch.push(l),t.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:x}),document.addEventListener("wheel",d,oh),document.addEventListener("touchmove",d,oh),document.addEventListener("touchstart",h,oh),function(){ch=ch.filter(function(w){return w!==l}),document.removeEventListener("wheel",d,oh),document.removeEventListener("touchmove",d,oh),document.removeEventListener("touchstart",h,oh)}},[]);var b=t.removeScrollBar,v=t.inert;return y.createElement(y.Fragment,null,v?y.createElement(l,{styles:Lme(i)}):null,b?y.createElement(Ame,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function $me(t){for(var s=null;t!==null;)t instanceof ShadowRoot&&(s=t.host,t=t.host),t=t.parentNode;return s}const zme=pme(TF,Fme);var Ik=y.forwardRef(function(t,s){return y.createElement(mv,Gl({},t,{ref:s,sideCar:zme}))});Ik.classNames=mv.classNames;var Ume=function(t){if(typeof document>"u")return null;var s=Array.isArray(t)?t[0]:t;return s.ownerDocument.body},dh=new WeakMap,ng=new WeakMap,rg={},cj=0,OF=function(t){return t&&(t.host||OF(t.parentNode))},Vme=function(t,s){return s.map(function(n){if(t.contains(n))return n;var a=OF(n);return a&&t.contains(a)?a:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},Hme=function(t,s,n,a){var i=Vme(s,Array.isArray(t)?t:[t]);rg[n]||(rg[n]=new WeakMap);var l=rg[n],o=[],c=new Set,d=new Set(i),u=function(f){!f||c.has(f)||(c.add(f),u(f.parentNode))};i.forEach(u);var h=function(f){!f||d.has(f)||Array.prototype.forEach.call(f.children,function(x){if(c.has(x))h(x);else try{var b=x.getAttribute(a),v=b!==null&&b!=="false",w=(dh.get(x)||0)+1,_=(l.get(x)||0)+1;dh.set(x,w),l.set(x,_),o.push(x),w===1&&v&&ng.set(x,!0),_===1&&x.setAttribute(n,"true"),v||x.setAttribute(a,"true")}catch(S){console.error("aria-hidden: cannot operate on ",x,S)}})};return h(s),c.clear(),cj++,function(){o.forEach(function(f){var x=dh.get(f)-1,b=l.get(f)-1;dh.set(f,x),l.set(f,b),x||(ng.has(f)||f.removeAttribute(a),ng.delete(f)),b||f.removeAttribute(n)}),cj--,cj||(dh=new WeakMap,dh=new WeakMap,ng=new WeakMap,rg={})}},RF=function(t,s,n){n===void 0&&(n="data-aria-hidden");var a=Array.from(Array.isArray(t)?t:[t]),i=Ume(t);return i?(a.push.apply(a,Array.from(i.querySelectorAll("[aria-live], script"))),Hme(a,i,n,"aria-hidden")):function(){return null}},fv="Dialog",[LF]=Wu(fv),[Wme,kl]=LF(fv),BF=t=>{const{__scopeDialog:s,children:n,open:a,defaultOpen:i,onOpenChange:l,modal:o=!0}=t,c=y.useRef(null),d=y.useRef(null),[u,h]=sx({prop:a,defaultProp:i??!1,onChange:l,caller:fv});return r.jsx(Wme,{scope:s,triggerRef:c,contentRef:d,contentId:Zc(),titleId:Zc(),descriptionId:Zc(),open:u,onOpenChange:h,onOpenToggle:y.useCallback(()=>h(f=>!f),[h]),modal:o,children:n})};BF.displayName=fv;var FF="DialogTrigger",qme=y.forwardRef((t,s)=>{const{__scopeDialog:n,...a}=t,i=kl(FF,n),l=Ts(s,i.triggerRef);return r.jsx(rs.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":Ok(i.open),...a,ref:l,onClick:Zt(t.onClick,i.onOpenToggle)})});qme.displayName=FF;var Mk="DialogPortal",[Gme,$F]=LF(Mk,{forceMount:void 0}),zF=t=>{const{__scopeDialog:s,forceMount:n,children:a,container:i}=t,l=kl(Mk,s);return r.jsx(Gme,{scope:s,forceMount:n,children:y.Children.map(a,o=>r.jsx(sc,{present:n||l.open,children:r.jsx(Pk,{asChild:!0,container:i,children:o})}))})};zF.displayName=Mk;var u1="DialogOverlay",UF=y.forwardRef((t,s)=>{const n=$F(u1,t.__scopeDialog),{forceMount:a=n.forceMount,...i}=t,l=kl(u1,t.__scopeDialog);return l.modal?r.jsx(sc,{present:a||l.open,children:r.jsx(Yme,{...i,ref:s})}):null});UF.displayName=u1;var Kme=mm("DialogOverlay.RemoveScroll"),Yme=y.forwardRef((t,s)=>{const{__scopeDialog:n,...a}=t,i=kl(u1,n);return r.jsx(Ik,{as:Kme,allowPinchZoom:!0,shards:[i.contentRef],children:r.jsx(rs.div,{"data-state":Ok(i.open),...a,ref:s,style:{pointerEvents:"auto",...a.style}})})}),Su="DialogContent",VF=y.forwardRef((t,s)=>{const n=$F(Su,t.__scopeDialog),{forceMount:a=n.forceMount,...i}=t,l=kl(Su,t.__scopeDialog);return r.jsx(sc,{present:a||l.open,children:l.modal?r.jsx(Xme,{...i,ref:s}):r.jsx(Qme,{...i,ref:s})})});VF.displayName=Su;var Xme=y.forwardRef((t,s)=>{const n=kl(Su,t.__scopeDialog),a=y.useRef(null),i=Ts(s,n.contentRef,a);return y.useEffect(()=>{const l=a.current;if(l)return RF(l)},[]),r.jsx(HF,{...t,ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Zt(t.onCloseAutoFocus,l=>{var o;l.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Zt(t.onPointerDownOutside,l=>{const o=l.detail.originalEvent,c=o.button===0&&o.ctrlKey===!0;(o.button===2||c)&&l.preventDefault()}),onFocusOutside:Zt(t.onFocusOutside,l=>l.preventDefault())})}),Qme=y.forwardRef((t,s)=>{const n=kl(Su,t.__scopeDialog),a=y.useRef(!1),i=y.useRef(!1);return r.jsx(HF,{...t,ref:s,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{var o,c;(o=t.onCloseAutoFocus)==null||o.call(t,l),l.defaultPrevented||(a.current||(c=n.triggerRef.current)==null||c.focus(),l.preventDefault()),a.current=!1,i.current=!1},onInteractOutside:l=>{var d,u;(d=t.onInteractOutside)==null||d.call(t,l),l.defaultPrevented||(a.current=!0,l.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const o=l.target;((u=n.triggerRef.current)==null?void 0:u.contains(o))&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&i.current&&l.preventDefault()}})}),HF=y.forwardRef((t,s)=>{const{__scopeDialog:n,trapFocus:a,onOpenAutoFocus:i,onCloseAutoFocus:l,...o}=t,c=kl(Su,n),d=y.useRef(null),u=Ts(s,d);return kF(),r.jsxs(r.Fragment,{children:[r.jsx(Tk,{asChild:!0,loop:!0,trapped:a,onMountAutoFocus:i,onUnmountAutoFocus:l,children:r.jsx(Ek,{role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":Ok(c.open),...o,ref:u,onDismiss:()=>c.onOpenChange(!1)})}),r.jsxs(r.Fragment,{children:[r.jsx(Zme,{titleId:c.titleId}),r.jsx(efe,{contentRef:d,descriptionId:c.descriptionId})]})]})}),Dk="DialogTitle",WF=y.forwardRef((t,s)=>{const{__scopeDialog:n,...a}=t,i=kl(Dk,n);return r.jsx(rs.h2,{id:i.titleId,...a,ref:s})});WF.displayName=Dk;var qF="DialogDescription",GF=y.forwardRef((t,s)=>{const{__scopeDialog:n,...a}=t,i=kl(qF,n);return r.jsx(rs.p,{id:i.descriptionId,...a,ref:s})});GF.displayName=qF;var KF="DialogClose",YF=y.forwardRef((t,s)=>{const{__scopeDialog:n,...a}=t,i=kl(KF,n);return r.jsx(rs.button,{type:"button",...a,ref:s,onClick:Zt(t.onClick,()=>i.onOpenChange(!1))})});YF.displayName=KF;function Ok(t){return t?"open":"closed"}var XF="DialogTitleWarning",[pBe,QF]=nhe(XF,{contentName:Su,titleName:Dk,docsSlug:"dialog"}),Zme=({titleId:t})=>{const s=QF(XF),n=`\`${s.contentName}\` requires a \`${s.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${s.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${s.docsSlug}`;return y.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},Jme="DialogDescriptionWarning",efe=({contentRef:t,descriptionId:s})=>{const a=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${QF(Jme).contentName}}.`;return y.useEffect(()=>{var l;const i=(l=t.current)==null?void 0:l.getAttribute("aria-describedby");s&&i&&(document.getElementById(s)||console.warn(a))},[a,t,s]),null},ZF=BF,JF=zF,pv=UF,xv=VF,gv=WF,yv=GF,e$=YF;const hy=ZF,tfe=JF,t$=y.forwardRef(({className:t,...s},n)=>r.jsx(pv,{className:Ft("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s,ref:n}));t$.displayName=pv.displayName;const sfe=rv("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),yp=y.forwardRef(({side:t="right",className:s,children:n,...a},i)=>r.jsxs(tfe,{children:[r.jsx(t$,{}),r.jsxs(xv,{ref:i,className:Ft(sfe({side:t}),s),...a,children:[r.jsxs(e$,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[r.jsx(Kn,{className:"h-4 w-4"}),r.jsx("span",{className:"sr-only",children:"Close"})]}),n]})]}));yp.displayName=xv.displayName;const bp=({className:t,...s})=>r.jsx("div",{className:Ft("flex flex-col space-y-2 text-center sm:text-left",t),...s});bp.displayName="SheetHeader";const vp=y.forwardRef(({className:t,...s},n)=>r.jsx(gv,{ref:n,className:Ft("text-lg font-semibold text-foreground",t),...s}));vp.displayName=gv.displayName;const Np=y.forwardRef(({className:t,...s},n)=>r.jsx(yv,{ref:n,className:Ft("text-sm text-muted-foreground",t),...s}));Np.displayName=yv.displayName;const Rk=({q:t="",active:s,page:n=1,page_size:a=50}={})=>J.get("/masters/lab-tests",{params:{q:t,active:s,page:n,page_size:a}}),nfe=t=>J.post("/masters/lab-tests",t),rfe=(t,s)=>J.put(`/masters/lab-tests/${t}`,s),afe=t=>J.delete(`/masters/lab-tests/${t}`),s$=({patient_id:t,context_type:s=null,context_id:n=null,priority:a="routine",test_ids:i=[]})=>{const l=(i||[]).map(o=>({test_id:o}));return J.post("/lab/orders",{patient_id:t,context_type:s,context_id:n,priority:a,items:l})},n$=(t={})=>J.get("/lab/orders",{params:t}),ife=t=>J.get(`/lab/orders/${t}`),lfe=t=>J.post(`/lab/orders/${t}/finalize`);function ofe(t={}){return J.get("/lis/masters/departments",{params:t})}function cfe(t,{department_id:s,sub_department_id:n}={}){const a={department_id:s};return n&&(a.sub_department_id=n),J.get(`/lab/orders/${t}/panel`,{params:a})}function dfe(t,s){return J.post(`/lab/orders/${t}/panel/results`,s)}function ufe(t){return J.get(`/lab/orders/${t}/report-data`)}const Lk=({q:t="",active:s,page:n=1,page_size:a=50}={})=>J.get("/ris/masters/tests",{params:{q:t,active:s,page:n,page_size:a}}),hfe=t=>J.post("/ris/masters/tests",t),mfe=(t,s)=>J.put(`/ris/masters/tests/${t}`,s),ffe=t=>J.delete(`/ris/masters/tests/${t}`),r$=({patient_id:t,test_id:s,context_type:n=null,context_id:a=null,ordering_user_id:i=null,priority:l="routine"})=>J.post("/ris/orders",{patient_id:t,test_id:s,context_type:n,context_id:a,ordering_user_id:i,priority:l}),a$=(t={})=>J.get("/ris/orders",{params:t}),pfe=t=>J.get(`/ris/orders/${t}`),xfe=(t,{scheduled_at:s})=>J.post(`/ris/orders/${t}/schedule`,{scheduled_at:s}),gfe=t=>J.post(`/ris/orders/${t}/scan`),yfe=(t,{report_text:s})=>J.post(`/ris/orders/${t}/report`,{report_text:s}),bfe=(t,{report_text:s})=>J.put(`/ris/orders/${t}/report`,{report_text:s}),vfe=t=>J.post(`/ris/orders/${t}/approve`),Nfe=(t,s,n="")=>J.post(`/ris/attachments/${t}`,{file_url:s,note:n}),wfe=(t,s)=>{const n=new FormData;return n.append("file",s),J.post(`/ris/orders/${t}/upload`,n,{headers:{"Content-Type":"multipart/form-data"}})};function bv(){return J.get("/inventory/locations")}function jfe(t){return J.post("/inventory/locations",t)}function _fe(t,s){return J.put(`/inventory/locations/${t}`,s)}function Sfe(t=""){const s=t?{q:t}:{};return J.get("/inventory/suppliers",{params:s})}function Cfe(t){return J.post("/inventory/suppliers",t)}function kfe(t,s){return J.put(`/inventory/suppliers/${t}`,s)}function vv(t={}){return J.get("/inventory/items",{params:t})}function Afe(t){return J.post("/inventory/items",t)}function Efe(t,s){return J.put(`/inventory/items/${t}`,s)}function Tfe(){return J.get("/inventory/items/sample-csv",{responseType:"blob"})}function Pfe(t){const s=new FormData;return s.append("file",t),J.post("/inventory/items/bulk-upload",s,{headers:{"Content-Type":"multipart/form-data"}})}function Ife(t={}){return J.get("/inventory/stock",{params:t})}function Mfe(t={}){return J.get("/inventory/alerts/expiry",{params:t})}function Dfe(t={}){return J.get("/inventory/alerts/expired",{params:t})}function Ofe(t={}){return J.get("/inventory/stock/quarantine",{params:t})}function Rfe(t={}){return J.get("/inventory/alerts/low-stock",{params:t})}function Lfe(t={}){return J.get("/inventory/alerts/max-stock",{params:t})}function Bfe(t){return J.post("/inventory/purchase-orders",t)}function Ffe(t={}){return J.get("/inventory/purchase-orders",{params:t})}function $fe(t,s){return J.post(`/inventory/purchase-orders/${t}/status`,null,{params:{status:s}})}function zfe(t){return J.get(`/inventory/purchase-orders/${t}/pdf`,{responseType:"blob"})}function Ufe(t,s){return J.post(`/inventory/purchase-orders/${t}/mark-sent`,null,{params:{email_to:s}})}function Vfe(t){return J.post("/inventory/grn",t)}function Hfe(t={}){return J.get("/inventory/grn",{params:t})}function Wfe(t){return J.post(`/inventory/grn/${t}/post`)}function qfe(t){return J.post("/inventory/returns",t)}function Gfe(t={}){return J.get("/inventory/returns",{params:t})}function Kfe(t){return J.post(`/inventory/returns/${t}/post`)}function Yfe(t={}){return J.get("/inventory/transactions",{params:t})}function Xfe(t){return J.get(`/inventory/items/by-qr/${encodeURIComponent(t)}`)}function Qfe(t){return J.get("/inventory/items/by-qr-number",{params:{qr_number:t}})}function jI(t){return J.get(`/inventory/items/${t}/qr`,{responseType:"blob"})}function i$(t){return J.post("/pharmacy/prescriptions",t)}function l$(t={}){return J.get("/pharmacy/prescriptions",{params:t})}function Zfe(t,s){return J.post(`/pharmacy/prescriptions/${t}/dispense`,s)}function Jfe(t){return J.post(`/pharmacy/prescriptions/${t}/bill`)}async function o$({q:t="",type:s="all",limit:n=50}={}){const a={is_active:!0};t&&(a.q=t),s==="drug"&&(a.type="drug"),s==="consumable"&&(a.type="consumable"),n&&(a.limit=n);const i=await vv(a);return{data:(Array.isArray(i==null?void 0:i.data)?i.data:[]).slice(0,n).map(c=>({id:c.id,code:c.code,name:c.name,generic_name:c.generic_name,strength:c.strength,form:c.form,unit:c.unit,pack_size:c.pack_size,is_consumable:!!c.is_consumable,type:c.is_consumable?"consumable":"drug"}))}}function epe(t={}){return J.get("/pharmacy/billing",{params:t})}function tpe(t={}){return J.get("/pharmacy/billing/returns/list",{params:t})}const Vm=(t={})=>{const s={};return Object.entries(t).forEach(([n,a])=>{a!=null&&a!==""&&(s[n]=a)}),s};function c$({active:t,search:s}={}){const n=Vm({active:t,search:s});return J.get("/ot/specialities",{params:n})}function spe(t){return J.post("/ot/specialities",t)}function npe(t,s){return J.put(`/ot/specialities/${t}`,s)}function rpe(t){return J.delete(`/ot/specialities/${t}`)}function Bk({search:t,specialityId:s,isActive:n,limit:a}={}){const i=Vm({search:t,speciality_id:s,is_active:typeof n=="boolean"?n:void 0,limit:a});return J.get("/ot/procedures",{params:i})}function ape(t){return J.post("/ot/procedures",t)}function ipe(t,s){return J.put(`/ot/procedures/${t}`,s)}function lpe(t){return J.delete(`/ot/procedures/${t}`)}function ope({active:t,search:s,specialityId:n}={}){const a=Vm({active:t,search:s,speciality_id:n});return J.get("/ot/theatres",{params:a})}function d$({date:t,bedId:s,surgeonUserId:n,patientId:a,status:i}={}){const l=Vm({date:t,bed_id:s,surgeon_user_id:n,patient_id:a,status:i});return J.get("/ot/schedule",{params:l})}function u$(t){return J.post("/ot/schedules",t)}function cpe(t,s){return J.put(`/ot/schedules/${t}`,s)}function dpe(t,s){return J.post(`/ot/cases/${t}/close`,s)}function upe(t){return J.get(`/ot/cases/${t}`)}function hpe(t){return J.get(`/ot/cases/${t}/preop-checklist`).then(s=>s.data)}function mpe(t,s){return J.post(`/ot/cases/${t}/preop-checklist`,s).then(n=>n.data)}function fpe(t,s){return J.put(`/ot/cases/${t}/preop-checklist`,s).then(n=>n.data)}function ppe(t){return J.get(`/ot/cases/${t}/safety-checklist`)}function xpe(t,s){return J.post(`/ot/cases/${t}/safety-checklist`,{...s,case_id:t})}function gpe(t,s){return J.put(`/ot/cases/${t}/safety-checklist`,s)}const ype=t=>J.get(`/ot/cases/${t}/anaesthesia-record`),bpe=(t,s)=>J.post(`/ot/cases/${t}/anaesthesia-record`,s),vpe=(t,s)=>J.put(`/ot/cases/${t}/anaesthesia-record`,s),Npe=t=>J.get(`/ot/anaesthesia-records/${t}/vitals`),wpe=(t,s)=>J.post(`/ot/anaesthesia-records/${t}/vitals`,s),jpe=t=>J.delete(`/ot/anaesthesia-vitals/${t}`),_pe=t=>J.get(`/ot/anaesthesia-records/${t}/drugs`),Spe=(t,s)=>J.post(`/ot/anaesthesia-records/${t}/drugs`,s),Cpe=t=>J.delete(`/ot/anaesthesia-drugs/${t}`);function kpe(t){return J.get(`/ot/cases/${t}/nursing-record`)}function Ape(t,s){return J.post(`/ot/cases/${t}/nursing-record`,{...s,case_id:t,primary_nurse_id:s.primary_nurse_id??null})}function _I(t,s){return J.put(`/ot/cases/${t}/nursing-record`,{...s,case_id:t,primary_nurse_id:s.primary_nurse_id??null})}function Epe(t){return J.get(`/ot/cases/${t}/counts`)}function Tpe(t,s){return J.post(`/ot/cases/${t}/counts`,s)}function Ppe(t,s){return J.put(`/ot/cases/${t}/counts`,s)}function Ipe(t){return J.get(`/ot/cases/${t}/operation-note`)}function Mpe(t,s){return J.post(`/ot/cases/${t}/operation-note`,{...s,case_id:t})}function Dpe(t,s){return J.put(`/ot/cases/${t}/operation-note`,s)}function Ope(t){return J.get(`/ot/cases/${t}/blood-transfusions`)}function Rpe(t,s){return J.post(`/ot/cases/${t}/blood-transfusions`,{...s,case_id:t})}function Lpe(t){return J.delete(`/ot/blood-transfusions/${t}`)}function Bpe(t){return J.get(`/ot/cases/${t}/pacu`)}function Fpe(t,s){return J.post(`/ot/cases/${t}/pacu`,{...s,case_id:t})}function $pe(t,s){return J.put(`/ot/cases/${t}/pacu`,s)}function zpe({theatreId:t,caseId:s,date:n,fromDate:a,toDate:i,session:l}={}){const o=Vm({theatre_id:t,case_id:s,date:n,from_date:a,to_date:i,session:l});return J.get("/ot/cleaning-logs",{params:o})}function Upe(t){return J.post("/ot/cleaning-logs",t)}function Vpe(t,s){return J.put(`/ot/cleaning-logs/${t}`,s)}function Hpe(t){return J.delete(`/ot/cleaning-logs/${t}`)}function Wpe({theatreId:t,date:s,fromDate:n,toDate:a}={}){const i=Vm({theatre_id:t,date:s,from_date:n,to_date:a});return J.get("/ot/environment-logs",{params:i})}function qpe(t){return J.post("/ot/environment-logs",t)}function Gpe(t,s){return J.put(`/ot/environment-logs/${t}`,s)}function Kpe(t){return J.delete(`/ot/environment-logs/${t}`)}function Ype(t,s={}){return J.post(`/ot/schedule/${t}/open-case`,s)}function Hm(t){if(!t)return null;const s=String(t).toLowerCase();return s==="op"||s==="opd"?"opd":s==="ip"||s==="ipd"?"ipd":s}async function Xpe({patientId:t,contextType:s,contextId:n,limit:a=10}){if(!t)return[];const i=Hm(s),l=await n$({patient_id:t});return(Array.isArray(l==null?void 0:l.data)?l.data:[]).filter(d=>!(i&&d.context_type&&d.context_type!==i||n&&d.context_id&&d.context_id!==n)).slice(0,a)}async function Qpe({patientId:t,contextType:s,contextId:n,limit:a=10}){if(!t)return[];const i=Hm(s),l=await a$({patient_id:t});return(Array.isArray(l==null?void 0:l.data)?l.data:[]).filter(d=>!(i&&d.context_type&&d.context_type!==i||n&&d.context_id&&d.context_id!==n)).slice(0,a)}async function Zpe({patientId:t,contextType:s,contextId:n,doctorUserId:a,locationId:i,notes:l,lines:o=[]}){var x;const c=Hm(s);if(!t||!c||!n)throw new Error("Missing patient / context for prescription");const d=c==="ipd"?"IPD":"OPD",u=[];for(const b of o){const v=(b.item_name||"").trim();if(v)try{const w=await o$({q:v,type:"drug",limit:1}),_=(x=w==null?void 0:w.data)==null?void 0:x[0];if(!_)continue;u.push({item_id:_.id,requested_qty:b.requested_qty||1,dose_text:b.dose_text||null,frequency_code:b.frequency_code||null,timing:b.timing||null,duration_days:b.duration_days||null,instructions:b.instructions||null})}catch(w){console.error("Pharmacy master lookup failed for",v,w)}}if(!u.length)throw new Error("No medicines found in inventory master");return(await i$({type:d,patient_id:t,visit_id:c==="opd"?n:null,ipd_admission_id:c==="ipd"?n:null,location_id:i??null,doctor_user_id:a??null,notes:l||null,lines:u})).data}async function Jpe({patientId:t,contextType:s,contextId:n,limit:a=10}){if(!t)return[];const i=Hm(s),o=await l$({patient_id:t,type:i==="ipd"?"IPD":"OPD",visit_id:i==="opd"?n:void 0,ipd_admission_id:i==="ipd"?n:void 0});return(Array.isArray(o==null?void 0:o.data)?o.data:[]).slice(0,a)}function exe({patientId:t,contextType:s,admissionId:n,bedId:a,surgeonUserId:i,anaesthetistUserId:l,date:o,plannedStartTime:c,plannedEndTime:d,priority:u,side:h,procedureName:f,primaryProcedureId:x,additionalProcedureIds:b=[],notes:v}){const w=Hm(s);if(!o||!c)throw new Error("OT date and start time are required");if(!i)throw new Error("Surgeon is required for OT schedule");const _=(f||"").trim();if(!_)throw new Error("Procedure name is required for OT schedule");const S={date:o,planned_start_time:c,planned_end_time:d||null,patient_id:t?Number(t):null,admission_id:w==="ipd"&&n?Number(n):null,bed_id:a?Number(a):null,surgeon_user_id:Number(i),anaesthetist_user_id:l?Number(l):null,procedure_name:_,side:h||null,priority:u||"Elective",notes:v||null,primary_procedure_id:x?Number(x):null,additional_procedure_ids:Array.isArray(b)?b.map(k=>Number(k)):[]};return u$(S)}async function txe({patientId:t,contextType:s,contextId:n,limit:a=10}){if(!t)return[];const i=Hm(s),l=await d$({});return(Array.isArray(l==null?void 0:l.data)?l.data:[]).filter(d=>!(i==="ipd"&&n&&d.admission_id&&d.admission_id!==n)).slice(0,a)}function Fk({value:t,onChange:s}){const[n,a]=y.useState([]),[i,l]=y.useState(""),[o,c]=y.useState([]),[d,u]=y.useState(""),[h,f]=y.useState([]);return y.useEffect(()=>{av().then(x=>a(x.data||[]))},[]),y.useEffect(()=>{c([]),u(""),f([]),i&&Gx({ward_id:i}).then(x=>c(x.data||[]))},[i]),y.useEffect(()=>{f([]),d&&Nl({room_id:d}).then(x=>f(x.data||[]))},[d]),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:"Allocate Bed (Ward  Room  Bed)"}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("select",{className:"input",value:i,onChange:x=>l(x.target.value),children:[r.jsx("option",{value:"",children:"Select ward"}),n.map(x=>r.jsxs("option",{value:x.id,children:[x.code,"  ",x.name]},x.id))]}),r.jsxs("select",{className:"input",value:d,onChange:x=>u(x.target.value),disabled:!i,children:[r.jsx("option",{value:"",children:"Select room"}),o.map(x=>r.jsxs("option",{value:x.id,children:[x.number,"  ",x.type]},x.id))]}),r.jsxs("select",{className:"input",value:t||"",onChange:x=>s(Number(x.target.value)),disabled:!d,children:[r.jsx("option",{value:"",children:"Select bed"}),h.map(x=>r.jsxs("option",{value:x.id,children:[x.code," ",x.state!=="vacant"?` ${x.state}`:""]},x.id))]})]}),!!t&&(()=>{const x=h.find(b=>b.id===t);return x?r.jsxs("div",{className:"text-xs text-gray-500",children:["Selected: ",r.jsx("span",{className:"font-medium",children:x.code})," (",x.state,")"]}):null})()]})}const sxe={initial:{opacity:0,y:4},animate:{opacity:1,y:0},transition:{duration:.16}};function SI(t){return t?t.full_name||t.name||`${t.first_name||""} ${t.last_name||""}`.trim():"Unknown patient"}function nxe(t){if(!t)return"";const s=t.gender||t.sex||"",n=t.age_display||t.age||"";return`${s}  ${n}`}function ag({children:t,tone:s="default"}){const n={default:"bg-slate-100 text-slate-700",lab:"bg-sky-50 text-sky-700",ris:"bg-indigo-50 text-indigo-700",rx:"bg-emerald-50 text-emerald-700",ot:"bg-amber-50 text-amber-700"};return r.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-0.5 text-[11px] font-semibold ${n[s]}`,children:t})}function uh(t){if(!t)return"";try{return new Date(t).toLocaleString()}catch{return String(t)}}function rxe(t,s="Something went wrong"){var a,i;const n=(i=(a=t==null?void 0:t.response)==null?void 0:a.data)==null?void 0:i.detail;if(typeof n=="string")return n;if(n&&!Array.isArray(n)&&typeof n=="object"){if(n.msg)return n.msg;try{return JSON.stringify(n)}catch{return s}}if(Array.isArray(n)){const l=n.map(o=>o==null?void 0:o.msg).filter(Boolean);if(l.length)return l.join(", ");try{return JSON.stringify(n)}catch{return s}}return t!=null&&t.message?t.message:s}function h$({patient:t,contextType:s,contextId:n,opNumber:a,ipNumber:i,bedLabel:l,currentUser:o,defaultLocationId:c}){var ia,Tt,Bs,cf,g0,eh,Pd,th,y0,En,uc,tl,Lt;const[d,u]=y.useState("lab"),[h,f]=y.useState(!1),[x,b]=y.useState({lab:[],ris:[],rx:[],ot:[]}),[v,w]=y.useState(""),[_,S]=y.useState([]),[k,A]=y.useState(!1),[T,P]=y.useState(!1),[O,D]=y.useState([]),[I,M]=y.useState("routine"),[B,L]=y.useState(""),[F,V]=y.useState(!1),$=y.useMemo(()=>O.map(me=>me.id),[O]),[z,H]=y.useState(""),[q,G]=y.useState([]),[re,ye]=y.useState(!1),[Ee,ee]=y.useState(!1),[te,ce]=y.useState([]),[ge,X]=y.useState("routine"),[de,Ce]=y.useState(""),[ue,fe]=y.useState(!1),pe=y.useMemo(()=>te.map(me=>me.id),[te]),[oe,qe]=y.useState(""),[Xe,jt]=y.useState([]),[ft,it]=y.useState(!1),[_t,ve]=y.useState(!1),[ae,xe]=y.useState(null),[je,Fe]=y.useState([]),[Ct,vt]=y.useState(""),[pt,Ns]=y.useState("BD"),[ds,ie]=y.useState("5"),[Ie,he]=y.useState("10"),[Me,Ge]=y.useState("oral"),[Be,Ot]=y.useState("BF"),[Rt,Jt]=y.useState(""),[ys,Qs]=y.useState(!1),[na,qt]=y.useState(""),[Gt,ra]=y.useState(""),[Mt,we]=y.useState(""),[lt,ht]=y.useState(""),[Kt,Wt]=y.useState([]),[Ht,Ls]=y.useState(!1),[bs,on]=y.useState(!1),[ws,yn]=y.useState(null),[bn,dt]=y.useState("Elective"),[va,Wa]=y.useState(""),[Xn,Ji]=y.useState(""),[Ad,cc]=y.useState(null),[qa,x0]=y.useState([]),[Ed,aa]=y.useState(null),[An,ks]=y.useState((o==null?void 0:o.id)||null),[el,Ga]=y.useState(null),[dc,Ue]=y.useState(!1),[af,Ps]=y.useState(!1),[Fn,Il]=y.useState(null),[ut,ls]=y.useState(null),Yt=(me,Ke)=>{Il(me),ls(Ke),Ps(!0)},Td=()=>{Ps(!1),Il(null),ls(null)},Ws=y.useMemo(()=>{if(!s)return null;const me=String(s).toLowerCase();return me==="op"||me==="opd"?"opd":me==="ip"||me==="ipd"?"ipd":me},[s]),Ml=Ws==="ipd"?"IPD Admission":"OPD Visit",cn=Ws==="ipd"?i?`IP No: ${i}`:"IP Number not set":a?`OP No: ${a}`:"OP Number not set",Na=Ws==="ipd"&&l?`Bed: ${l}`:null,lf=o==null?void 0:o.id,as=y.useCallback(async()=>{if(!(!(t!=null&&t.id)||!Ws||!n)){f(!0);try{const[me,Ke,St,Ka]=await Promise.all([Xpe({patientId:t.id,contextType:Ws,contextId:n,limit:10}),Qpe({patientId:t.id,contextType:Ws,contextId:n,limit:10}),Jpe({patientId:t.id,contextType:Ws,contextId:n,limit:10}),Ws==="ipd"?txe({patientId:t.id,admissionId:n,limit:10}):Promise.resolve([])]);b({lab:me,ris:Ke,rx:St,ot:Ka})}catch(me){console.error("Failed to load quick orders summary",me),se.error("Unable to load recent orders for this patient.")}finally{f(!1)}}},[t==null?void 0:t.id,Ws,n]);y.useEffect(()=>{as()},[as]),y.useEffect(()=>{if(!v||v.trim().length<2){S([]);return}let me=!1;return(async()=>{try{A(!0);const{data:Ke}=await Rk({q:v.trim()});if(me)return;const St=Array.isArray(Ke)?Ke:(Ke==null?void 0:Ke.items)||[];S(St),P(!0)}catch(Ke){console.error(Ke),se.error("Failed to fetch lab tests.")}finally{me||A(!1)}})(),()=>{me=!0}},[v]);function Q(me){me!=null&&me.id&&(D(Ke=>Ke.some(St=>St.id===me.id)?Ke:[...Ke,{id:me.id,code:me.code||me.short_code||"",name:me.name||me.test_name||""}]),w(me.name||me.test_name||me.code||""),P(!1))}function ke(me){D(Ke=>Ke.filter(St=>St.id!==me))}async function Le(){var me,Ke;if(!$.length){se.error("Add at least one lab test.");return}if(!(t!=null&&t.id)){se.error("Patient missing for lab order.");return}V(!0);try{await s$({patient_id:t.id,priority:I,test_ids:$}),se.success("Lab order created"),D([]),L(""),w(""),as()}catch(St){console.error(St);const Ka=((Ke=(me=St==null?void 0:St.response)==null?void 0:me.data)==null?void 0:Ke.detail)||"Failed to create lab order";se.error(Ka)}finally{V(!1)}}y.useEffect(()=>{if(!z||z.trim().length<2){G([]);return}let me=!1;return(async()=>{try{ye(!0);const{data:Ke}=await Lk({q:z.trim()});if(me)return;const St=Array.isArray(Ke)?Ke:(Ke==null?void 0:Ke.items)||[];G(St),ee(!0)}catch(Ke){console.error(Ke),se.error("Failed to fetch radiology tests.")}finally{me||ye(!1)}})(),()=>{me=!0}},[z]);function mt(me){me!=null&&me.id&&(ce(Ke=>Ke.some(St=>St.id===me.id)?Ke:[...Ke,{id:me.id,code:me.code||"",name:me.name||me.test_name||"",modality:me.modality||me.modality_code||""}]),H(me.name||me.test_name||me.code||""),ee(!1))}function Ut(me){ce(Ke=>Ke.filter(St=>St.id!==me))}async function _e(){var me,Ke;if(!pe.length){se.error("Add at least one radiology test.");return}if(!(t!=null&&t.id)){se.error("Patient missing for radiology order.");return}fe(!0);try{await Promise.all(pe.map(St=>r$({patient_id:t.id,test_id:Number(St),priority:ge}))),se.success("Radiology order(s) created"),ce([]),Ce(""),H(""),as()}catch(St){console.error(St);const Ka=((Ke=(me=St==null?void 0:St.response)==null?void 0:me.data)==null?void 0:Ke.detail)||"Failed to create radiology order(s)";se.error(Ka)}finally{fe(!1)}}y.useEffect(()=>{if(!oe||oe.trim().length<2){jt([]);return}let me=!1;return(async()=>{try{it(!0);const Ke=await o$({q:oe.trim(),type:"drug",limit:20});if(me)return;const St=Array.isArray(Ke==null?void 0:Ke.data)?Ke.data:[];jt(St),ve(!0)}catch(Ke){console.error(Ke),se.error("Failed to search medicines from inventory.")}finally{me||it(!1)}})(),()=>{me=!0}},[oe]);function ne(me){xe(me),qe(me.name||""),ve(!1)}function At(){if(!ae){se.error("Select a medicine from inventory.");return}const me=parseFloat(Ie||"0")||0,Ke=parseInt(ds||"0",10)||null;if(!me){se.error("Enter a valid quantity.");return}Fe(St=>[...St,{item_id:ae.id,item_name:ae.name,requested_qty:me,dose_text:Ct||null,frequency_code:pt||null,duration_days:Ke,route:Me||null,timing:Be||null,instructions:null}]),xe(null),qe(""),he("10"),vt("")}async function $n(){if(!je.length){se.error("Add at least one medicine.");return}if(!(t!=null&&t.id)||!Ws||!n){se.error("Missing patient or context for prescription.");return}Qs(!0);try{await Zpe({patientId:t.id,contextType:Ws,contextId:n,doctorUserId:lf,locationId:c,notes:Rt,lines:je}),se.success("Prescription created & sent to Pharmacy."),Fe([]),Jt(""),qe(""),xe(null),as()}catch(me){console.error(me),se.error("Failed to create prescription.")}finally{Qs(!1)}}function wa(me){Fe(Ke=>Ke.filter((St,Ka)=>Ka!==me))}y.useEffect(()=>{if(!lt||lt.trim().length<2){Wt([]);return}let me=!1;return(async()=>{var Ke;try{Ls(!0);const St=await Bk({search:lt.trim(),isActive:!0,limit:20});if(me)return;const Ka=Array.isArray((Ke=St==null?void 0:St.data)==null?void 0:Ke.items)?St.data.items:Array.isArray(St==null?void 0:St.data)?St.data:[];Wt(Ka),on(!0)}catch(St){console.error(St),se.error("Failed to fetch OT procedures.")}finally{me||Ls(!1)}})(),()=>{me=!0}},[lt]);function UN(me){yn(me),cc(me.id||null),ht(me.name||me.procedure_name||""),on(!1)}async function of(){if(Ws!=="ipd"){se.warning("OT booking via quick orders is only for IPD.");return}if(!na||!Gt){se.warning("Please select OT date and start time.");return}if(!(t!=null&&t.id)||!n){se.error("Missing patient or admission for OT schedule.");return}const me=An||(o==null?void 0:o.id);if(!me){se.error("Please select a surgeon for this OT booking.");return}const Ke=ws?ws.name||ws.procedure_name:lt==null?void 0:lt.trim();if(!Ke){se.error("Please enter a procedure name.");return}Ue(!0);try{await exe({patientId:t.id,contextType:Ws,admissionId:n,bedId:Ed,surgeonUserId:me,anaesthetistUserId:el,date:na,plannedStartTime:Gt,plannedEndTime:Mt||null,priority:bn,side:va||null,procedureName:Ke,primaryProcedureId:(ws==null?void 0:ws.id)||null,additionalProcedureIds:[],notes:Xn}),se.success("OT schedule created."),qt(""),ra(""),we(""),aa(null),ht(""),yn(null),Wa(""),dt("Elective"),Ga(null),Ji(""),as==null||as()}catch(St){console.error("Failed to create OT schedule",St);const Ka=rxe(St,"Failed to create OT schedule.");se.error(Ka)}finally{Ue(!1)}}return r.jsxs(r.Fragment,{children:[r.jsx(at.div,{className:"w-full",...sxe,children:r.jsxs(Ve,{className:"border-slate-200 shadow-sm bg-white/90 backdrop-blur-sm",children:[r.jsxs(rt,{className:"flex flex-col gap-2 border-b border-slate-100 pb-3",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Vs,{className:"h-5 w-5 text-sky-600"}),r.jsxs("div",{children:[r.jsx(ot,{className:"text-base sm:text-lg font-semibold text-slate-900",children:"Quick Orders"}),r.jsxs("p",{className:"text-xs text-slate-500 mt-0.5",children:["Create Lab, Radiology, Pharmacy & OT orders directly from this ",Ml.toLowerCase(),"."]})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[r.jsx(Ze,{className:"bg-slate-900 text-slate-50 px-2.5 py-1 rounded-full",children:Ml}),r.jsxs(Ze,{variant:"outline",className:"flex items-center gap-1.5 border-slate-300 bg-slate-50/80",children:[r.jsx(qp,{className:"h-3 w-3 text-slate-500"}),r.jsx("span",{className:"font-medium text-slate-800",children:cn})]}),Na&&r.jsxs(Ze,{variant:"outline",className:"flex items-center gap-1.5 border-emerald-300 bg-emerald-50/90",children:[r.jsx(kn,{className:"h-3 w-3 text-emerald-600"}),r.jsx("span",{className:"font-medium text-emerald-700",children:Na})]})]})]}),r.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2 text-xs",children:[r.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full bg-slate-100 px-2.5 py-1",children:[r.jsx(rn,{className:"h-3.5 w-3.5 text-slate-600"}),r.jsx("span",{className:"font-semibold text-slate-900",children:SI(t)})]}),r.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full bg-slate-50 px-2.5 py-1 text-slate-600",children:[r.jsx(Ba,{className:"h-3.5 w-3.5"}),nxe(t)]})]})]}),r.jsxs(He,{className:"p-3 sm:p-4",children:[r.jsxs("div",{className:"grid gap-3 lg:grid-cols-[minmax(0,1.2fr)_minmax(0,1fr)]",children:[r.jsx("div",{className:"space-y-3",children:r.jsxs(jl,{value:d,onValueChange:u,className:"w-full",children:[r.jsxs(Wi,{className:"w-full justify-start overflow-x-auto rounded-xl bg-slate-50 p-1",children:[r.jsxs(ms,{value:"lab",className:"flex items-center gap-1.5 text-xs sm:text-[13px]",children:[r.jsx(Li,{className:"h-3.5 w-3.5"}),"Lab"]}),r.jsxs(ms,{value:"ris",className:"flex items-center gap-1.5 text-xs sm:text-[13px]",children:[r.jsx(Pw,{className:"h-3.5 w-3.5"}),"Radiology"]}),r.jsxs(ms,{value:"rx",className:"flex items-center gap-1.5 text-xs sm:text-[13px]",children:[r.jsx(dr,{className:"h-3.5 w-3.5"}),"Pharmacy"]}),r.jsxs(ms,{value:"ot",className:"flex items-center gap-1.5 text-xs sm:text-[13px]",children:[r.jsx(Mw,{className:"h-3.5 w-3.5"}),"OT"]})]}),r.jsx(us,{value:"lab",className:"mt-3",children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"grid sm:grid-cols-[2fr_minmax(0,1fr)] gap-3",children:[r.jsxs("div",{className:"space-y-1.5 relative",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Lab test (from Master)"}),r.jsxs("div",{className:"relative",children:[r.jsx(es,{className:"h-3.5 w-3.5 text-slate-400 absolute left-2 top-2.5"}),r.jsx(Se,{value:v,onChange:me=>{w(me.target.value),P(!0)},placeholder:"Search test code / name",className:"h-9 text-xs pl-7"})]}),T&&(_.length>0||k)&&r.jsxs("div",{className:"absolute z-20 mt-1 w-full rounded-xl border border-slate-200 bg-white shadow-lg max-h-52 overflow-auto text-xs",children:[k&&r.jsxs("div",{className:"px-3 py-2 flex items-center gap-2 text-slate-500",children:[r.jsx(ns,{className:"h-3.5 w-3.5 animate-spin"}),"Searching"]}),!k&&!_.length&&r.jsx("div",{className:"px-3 py-2 text-slate-500",children:"No tests found."}),!k&&_.map(me=>r.jsxs("button",{type:"button",onClick:()=>Q(me),className:"w-full text-left px-3 py-1.5 hover:bg-slate-50 flex flex-col gap-0.5",children:[r.jsx("span",{className:"font-medium text-slate-900",children:me.name||me.test_name}),r.jsx("span",{className:"text-[11px] text-slate-500",children:me.code||me.short_code||""})]},me.id))]}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"Pulling from Lab Test Masters (LIS)."})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Priority"}),r.jsx("div",{className:"flex gap-1.5",children:["routine","urgent","stat"].map(me=>r.jsx(Te,{type:"button",size:"sm",variant:I===me?"default":"outline",className:`flex-1 h-8 text-xs font-semibold ${I===me?"bg-sky-600 hover:bg-sky-700 text-white":"border-slate-300 text-slate-700"}`,onClick:()=>M(me),children:me==="routine"?"Routine":me==="urgent"?"Urgent":"STAT"},me))})]})]}),O.length>0&&r.jsx(Or,{className:"max-h-32 rounded-md border border-slate-200 bg-slate-50/60 p-2",children:r.jsx("ul",{className:"space-y-1.5 text-xs",children:O.map(me=>r.jsxs("li",{className:"flex items-center justify-between gap-2 rounded-md bg-white px-2 py-1.5 shadow-xs border border-slate-100",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"font-semibold text-slate-900",children:me.name||"Lab test"}),r.jsxs("span",{className:"text-[11px] text-slate-500",children:["Code: ",me.code||""]})]}),r.jsx(Te,{type:"button",size:"icon",variant:"ghost",className:"h-7 w-7 text-slate-400 hover:text-red-500",onClick:()=>ke(me.id),children:""})]},me.id))})}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Note (optional)"}),r.jsx(Yl,{rows:2,value:B,onChange:me=>L(me.target.value),placeholder:"Any special instructions for sample collection / processing.",className:"resize-none text-xs"})]}),r.jsx("div",{className:"flex justify-end",children:r.jsx(Te,{type:"button",size:"sm",disabled:F,onClick:Le,className:"h-9 px-4 text-xs font-semibold bg-sky-600 hover:bg-sky-700 text-white shadow-sm",children:F?"Placing Lab Order":"Place Lab Order"})})]})}),r.jsx(us,{value:"ris",className:"mt-3",children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"grid sm:grid-cols-[2fr_minmax(0,1fr)] gap-3",children:[r.jsxs("div",{className:"space-y-1.5 relative",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Radiology test (from RIS Masters)"}),r.jsxs("div",{className:"relative",children:[r.jsx(es,{className:"h-3.5 w-3.5 text-slate-400 absolute left-2 top-2.5"}),r.jsx(Se,{value:z,onChange:me=>{H(me.target.value),ee(!0)},placeholder:"Search X-Ray / CT / MRI / USG",className:"h-9 text-xs pl-7"})]}),Ee&&(q.length>0||re)&&r.jsxs("div",{className:"absolute z-20 mt-1 w-full rounded-xl border border-slate-200 bg-white shadow-lg max-h-52 overflow-auto text-xs",children:[re&&r.jsxs("div",{className:"px-3 py-2 flex items-center gap-2 text-slate-500",children:[r.jsx(ns,{className:"h-3.5 w-3.5 animate-spin"}),"Searching"]}),!re&&!q.length&&r.jsx("div",{className:"px-3 py-2 text-slate-500",children:"No tests found."}),!re&&q.map(me=>r.jsxs("button",{type:"button",onClick:()=>mt(me),className:"w-full text-left px-3 py-1.5 hover:bg-slate-50 flex flex-col gap-0.5",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"font-medium text-slate-900",children:me.name||me.test_name}),r.jsx("span",{className:"text-[10px] text-slate-500",children:me.modality||me.modality_code||""})]}),r.jsx("span",{className:"text-[11px] text-slate-500",children:me.code||""})]},me.id))]}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"Linked to Radiology Test & Modality masters."})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Priority"}),r.jsx("div",{className:"flex gap-1.5",children:["routine","urgent","stat"].map(me=>r.jsx(Te,{type:"button",size:"sm",variant:ge===me?"default":"outline",className:`flex-1 h-8 text-xs font-semibold ${ge===me?"bg-indigo-600 hover:bg-indigo-700 text-white":"border-slate-300 text-slate-700"}`,onClick:()=>X(me),children:me==="routine"?"Routine":me==="urgent"?"Urgent":"STAT"},me))})]})]}),te.length>0&&r.jsx(Or,{className:"max-h-32 rounded-md border border-slate-200 bg-slate-50/60 p-2",children:r.jsx("ul",{className:"space-y-1.5 text-xs",children:te.map(me=>r.jsxs("li",{className:"flex items-center justify-between gap-2 rounded-md bg-white px-2 py-1.5 shadow-xs border border-slate-100",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"font-semibold text-slate-900",children:me.name||"Radiology test"}),r.jsxs("span",{className:"text-[11px] text-slate-500",children:[me.modality||"RIS","  Code: ",me.code||""]})]}),r.jsx(Te,{type:"button",size:"icon",variant:"ghost",className:"h-7 w-7 text-slate-400 hover:text-red-500",onClick:()=>Ut(me.id),children:""})]},me.id))})}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Note (optional)"}),r.jsx(Yl,{rows:2,value:de,onChange:me=>Ce(me.target.value),placeholder:"Side / position / contrast / clinical history etc.",className:"resize-none text-xs"})]}),r.jsx("div",{className:"flex justify-end",children:r.jsx(Te,{type:"button",size:"sm",disabled:ue,onClick:_e,className:"h-9 px-4 text-xs font-semibold bg-indigo-600 hover:bg-indigo-700 text-white shadow-sm",children:ue?"Placing Radiology Order":"Place Radiology Order"})})]})}),r.jsx(us,{value:"rx",className:"mt-3",children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"space-y-1.5 relative",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Search medicine (linked to Pharmacy Inventory)"}),r.jsxs("div",{className:"relative",children:[r.jsx(es,{className:"h-3.5 w-3.5 text-slate-400 absolute left-2 top-2.5"}),r.jsx(Se,{value:oe,onChange:me=>{qe(me.target.value),ve(!0)},placeholder:"Search drug name / brand / generic",className:"h-9 text-xs pl-7"})]}),_t&&(Xe.length>0||ft)&&r.jsxs("div",{className:"absolute z-20 mt-1 w-full rounded-xl border border-slate-200 bg-white shadow-lg max-h-52 overflow-auto text-xs",children:[ft&&r.jsxs("div",{className:"px-3 py-2 flex items-center gap-2 text-slate-500",children:[r.jsx(ns,{className:"h-3.5 w-3.5 animate-spin"}),"Searching"]}),!ft&&!Xe.length&&r.jsx("div",{className:"px-3 py-2 text-slate-500",children:"No items found."}),!ft&&Xe.map(me=>r.jsxs("button",{type:"button",onClick:()=>ne(me),className:"w-full text-left px-3 py-1.5 hover:bg-slate-50 flex flex-col gap-0.5",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"font-medium text-slate-900",children:me.name}),me.code&&r.jsx("span",{className:"text-[10px] text-slate-500",children:me.code})]}),r.jsx("span",{className:"text-[11px] text-slate-500",children:me.strength||me.form||""})]},me.id))]})]}),r.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Dose"}),r.jsx(Se,{value:Ct,onChange:me=>vt(me.target.value),placeholder:"e.g. 500 mg",className:"h-8 text-[11px]"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Freq"}),r.jsx(Se,{value:pt,onChange:me=>Ns(me.target.value),placeholder:"BD / TID / 1-0-1",className:"h-8 text-[11px]"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Days"}),r.jsx(Se,{value:ds,onChange:me=>ie(me.target.value),placeholder:"5",className:"h-8 text-[11px]"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Qty"}),r.jsx(Se,{value:Ie,onChange:me=>he(me.target.value),placeholder:"10",className:"h-8 text-[11px]"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Route"}),r.jsx(Se,{value:Me,onChange:me=>Ge(me.target.value),placeholder:"oral / IV / IM",className:"h-8 text-[11px]"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Timing"}),r.jsx(Se,{value:Be,onChange:me=>Ot(me.target.value),placeholder:"BF / AF",className:"h-8 text-[11px]"})]}),r.jsx("div",{className:"flex items-end justify-end",children:r.jsx(Te,{type:"button",size:"sm",className:"h-8 px-3 text-[11px] rounded-full",onClick:At,children:"Add line"})})]}),je.length>0&&r.jsx("div",{className:"border border-slate-200 rounded-xl bg-slate-50/60 overflow-hidden",children:r.jsx(Or,{className:"max-h-40",children:r.jsxs("table",{className:"w-full text-[11px]",children:[r.jsx("thead",{className:"bg-slate-100 text-slate-600",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-2 py-1 text-left font-medium",children:"#"}),r.jsx("th",{className:"px-2 py-1 text-left font-medium",children:"Medicine"}),r.jsx("th",{className:"px-2 py-1 text-left font-medium",children:"Dose / Freq / Days"}),r.jsx("th",{className:"px-2 py-1 text-right font-medium",children:"Qty"}),r.jsx("th",{className:"px-2 py-1 text-right font-medium",children:"Actions"})]})}),r.jsx("tbody",{children:je.map((me,Ke)=>r.jsxs("tr",{className:"border-t border-slate-100",children:[r.jsx("td",{className:"px-2 py-1 align-top text-slate-500",children:Ke+1}),r.jsx("td",{className:"px-2 py-1 align-top",children:r.jsx("div",{className:"text-[11px] font-medium text-slate-900",children:me.item_name})}),r.jsxs("td",{className:"px-2 py-1 align-top text-[11px] text-slate-700",children:[me.dose_text||Ct||""," "," ",me.frequency_code||pt||""," "," ",me.duration_days||ds||""," d"]}),r.jsx("td",{className:"px-2 py-1 align-top text-right text-[11px] text-slate-700",children:me.requested_qty}),r.jsx("td",{className:"px-2 py-1 align-top text-right",children:r.jsx(Te,{type:"button",size:"icon",variant:"ghost",className:"h-7 w-7 text-slate-400 hover:text-red-500",onClick:()=>wa(Ke),children:""})})]},Ke))})]})})}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Clinical notes / Rx note (optional)"}),r.jsx(Yl,{rows:2,value:Rt,onChange:me=>Jt(me.target.value),className:"resize-none text-xs"})]}),r.jsx("div",{className:"flex justify-end",children:r.jsx(Te,{type:"button",size:"sm",disabled:ys,onClick:$n,className:"h-9 px-4 text-xs font-semibold",children:ys?"Saving Rx":"Save & Send to Pharmacy"})})]})}),r.jsx(us,{value:"ot",className:"mt-3",children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"grid sm:grid-cols-3 gap-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("label",{className:"text-xs font-medium text-slate-600",children:["OT Date ",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx(Se,{type:"date",value:na,onChange:me=>qt(me.target.value),className:"h-9 text-xs"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("label",{className:"text-xs font-medium text-slate-600",children:["Start time ",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx(Se,{type:"time",value:Gt,onChange:me=>ra(me.target.value),className:"h-9 text-xs"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"End time (optional)"}),r.jsx(Se,{type:"time",value:Mt,onChange:me=>we(me.target.value),className:"h-9 text-xs"})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"OT Location / Bed"}),r.jsx(Fk,{value:Ed?Number(Ed):null,onChange:me=>aa(me||null)}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"Uses the same Ward  Room  Bed mapping as main OT Schedule page."})]}),r.jsxs("div",{className:"space-y-1.5 relative",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Procedure (from OT Master or free text)"}),r.jsxs("div",{className:"relative",children:[r.jsx(es,{className:"h-3.5 w-3.5 text-slate-400 absolute left-2 top-2.5"}),r.jsx(Se,{value:lt,onChange:me=>{ht(me.target.value),on(!0)},placeholder:"Search procedure name / code",className:"h-9 text-xs pl-7"})]}),bs&&(Kt.length>0||Ht)&&r.jsxs("div",{className:"absolute z-20 mt-1 w-full rounded-xl border border-slate-200 bg-white shadow-lg max-h-52 overflow-auto text-xs",children:[Ht&&r.jsxs("div",{className:"px-3 py-2 flex items-center gap-2 text-slate-500",children:[r.jsx(ns,{className:"h-3.5 w-3.5 animate-spin"}),"Searching"]}),!Ht&&!Kt.length&&r.jsx("div",{className:"px-3 py-2 text-slate-500",children:"No procedures found."}),!Ht&&Kt.map(me=>r.jsxs("button",{type:"button",onClick:()=>UN(me),className:"w-full text-left px-3 py-1.5 hover:bg-slate-50 flex flex-col gap-0.5",children:[r.jsx("span",{className:"font-medium text-slate-900",children:me.name||me.procedure_name}),r.jsx("span",{className:"text-[11px] text-slate-500",children:me.code||""})]},me.id))]}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"If you just type and don't pick from list, it will save as free-text procedure name."})]}),r.jsxs("div",{className:"grid sm:grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Side"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:va,onChange:me=>Wa(me.target.value),children:[r.jsx("option",{value:"",children:"Not applicable"}),r.jsx("option",{value:"Right",children:"Right"}),r.jsx("option",{value:"Left",children:"Left"}),r.jsx("option",{value:"Bilateral",children:"Bilateral"}),r.jsx("option",{value:"Midline",children:"Midline"})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Priority"}),r.jsx("div",{className:"flex gap-1.5",children:["Elective","Emergency"].map(me=>r.jsx(Te,{type:"button",size:"sm",variant:bn===me?"default":"outline",className:`flex-1 h-8 text-xs font-semibold ${bn===me?"bg-amber-600 hover:bg-amber-700 text-white":"border-slate-300 text-slate-700"}`,onClick:()=>dt(me),children:me},me))})]})]}),r.jsxs("div",{className:"grid sm:grid-cols-2 gap-3",children:[r.jsx(wl,{label:"Surgeon",value:An?Number(An):null,onChange:me=>ks(me||null)}),r.jsx(wl,{label:"Anaesthetist",value:el?Number(el):null,onChange:me=>Ga(me||null)})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Notes / anaesthesia plan (optional)"}),r.jsx(Yl,{rows:2,value:Xn,onChange:me=>Ji(me.target.value),className:"resize-none text-xs"})]}),r.jsx("div",{className:"flex justify-end",children:r.jsx(Te,{type:"button",size:"sm",disabled:dc,onClick:of,className:"h-9 px-4 text-xs font-semibold bg-amber-600 hover:bg-amber-700 text-white shadow-sm",children:dc?"Creating OT schedule":"Create OT schedule"})})]})})]})}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("h3",{className:"text-xs font-semibold text-slate-700 uppercase tracking-wide",children:["Recent orders for this ",Ml.toLowerCase()]}),h&&r.jsxs("span",{className:"text-[11px] text-slate-500 flex items-center gap-1",children:[r.jsx(ns,{className:"h-3 w-3 animate-spin"}),"Loading"]})]}),r.jsxs(Ve,{className:"border-slate-200 bg-slate-50/70",children:[r.jsxs(rt,{className:"py-2.5 px-3 flex flex-row items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Li,{className:"h-4 w-4 text-sky-600"}),r.jsx(ot,{className:"text-xs font-semibold",children:"Lab Orders"})]}),r.jsxs(ag,{tone:"lab",children:[((ia=x.lab)==null?void 0:ia.length)||0," orders"]})]}),r.jsx(He,{className:"px-3 pb-3 pt-0",children:r.jsxs("div",{className:"space-y-1.5 max-h-32 overflow-auto text-[11px]",children:[!((Tt=x.lab)!=null&&Tt.length)&&!h&&r.jsx("div",{className:"text-slate-500 text-[11px]",children:"No lab orders for this context yet."}),(Bs=x.lab)==null?void 0:Bs.map(me=>r.jsxs("button",{type:"button",onClick:()=>Yt("lab",me),className:"w-full text-left flex items-center justify-between gap-2 px-2 py-1 rounded-lg bg-white/80 border border-slate-100 hover:bg-slate-50",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"font-semibold text-slate-900",children:me.order_no||`LAB-${String(me.id).padStart(6,"0")}`}),r.jsx("span",{className:"text-[10px] text-slate-500",children:uh(me.created_at||me.order_datetime)})]}),r.jsx("span",{className:"text-[10px] text-slate-600 capitalize",children:me.status||"ordered"})]},me.id))]})})]}),r.jsxs(Ve,{className:"border-slate-200 bg-slate-50/70",children:[r.jsxs(rt,{className:"py-2.5 px-3 flex flex-row items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Pw,{className:"h-4 w-4 text-indigo-600"}),r.jsx(ot,{className:"text-xs font-semibold",children:"Radiology Orders"})]}),r.jsxs(ag,{tone:"ris",children:[((cf=x.ris)==null?void 0:cf.length)||0," orders"]})]}),r.jsx(He,{className:"px-3 pb-3 pt-0",children:r.jsxs("div",{className:"space-y-1.5 max-h-32 overflow-auto text-[11px]",children:[!((g0=x.ris)!=null&&g0.length)&&!h&&r.jsx("div",{className:"text-slate-500 text-[11px]",children:"No radiology orders for this context yet."}),(eh=x.ris)==null?void 0:eh.map(me=>r.jsxs("button",{type:"button",onClick:()=>Yt("ris",me),className:"w-full text-left flex items-center justify-between gap-2 px-2 py-1 rounded-lg bg-white/80 border border-slate-100 hover:bg-slate-50",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"font-semibold text-slate-900",children:me.order_no||`RIS-${String(me.id).padStart(6,"0")}`}),r.jsx("span",{className:"text-[10px] text-slate-500",children:uh(me.created_at||me.order_datetime)})]}),r.jsx("span",{className:"text-[10px] text-slate-600 capitalize",children:me.status||"ordered"})]},me.id))]})})]}),r.jsxs(Ve,{className:"border-slate-200 bg-slate-50/70",children:[r.jsxs(rt,{className:"py-2.5 px-3 flex flex-row items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(dr,{className:"h-4 w-4 text-emerald-600"}),r.jsx(ot,{className:"text-xs font-semibold",children:"Pharmacy Rx"})]}),r.jsxs(ag,{tone:"rx",children:[((Pd=x.rx)==null?void 0:Pd.length)||0," Rx"]})]}),r.jsx(He,{className:"px-3 pb-3 pt-0",children:r.jsxs("div",{className:"space-y-1.5 max-h-32 overflow-auto text-[11px]",children:[!((th=x.rx)!=null&&th.length)&&!h&&r.jsx("div",{className:"text-slate-500 text-[11px]",children:"No prescriptions for this context yet."}),(y0=x.rx)==null?void 0:y0.map(me=>r.jsxs("button",{type:"button",onClick:()=>Yt("rx",me),className:"w-full text-left flex items-center justify-between gap-2 px-2 py-1 rounded-lg bg-white/80 border border-slate-100 hover:bg-slate-50",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"font-semibold text-slate-900",children:me.rx_number||`RX-${String(me.id).padStart(6,"0")}`}),r.jsx("span",{className:"text-[10px] text-slate-500",children:uh(me.rx_datetime||me.created_at)})]}),r.jsx("span",{className:"text-[10px] text-slate-600 capitalize",children:me.status||"pending"})]},me.id))]})})]}),Ws==="ipd"&&r.jsxs(Ve,{className:"border-slate-200 bg-slate-50/70",children:[r.jsxs(rt,{className:"py-2.5 px-3 flex flex-row items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Mw,{className:"h-4 w-4 text-amber-600"}),r.jsx(ot,{className:"text-xs font-semibold",children:"OT Schedules"})]}),r.jsxs(ag,{tone:"ot",children:[((En=x.ot)==null?void 0:En.length)||0," cases"]})]}),r.jsx(He,{className:"px-3 pb-3 pt-0",children:r.jsxs("div",{className:"space-y-1.5 max-h-32 overflow-auto text-[11px]",children:[!((uc=x.ot)!=null&&uc.length)&&!h&&r.jsx("div",{className:"text-slate-500 text-[11px]",children:"No OT schedules for this admission yet."}),(tl=x.ot)==null?void 0:tl.map(me=>r.jsxs("button",{type:"button",onClick:()=>Yt("ot",me),className:"w-full text-left flex items-center justify-between gap-2 px-2 py-1 rounded-lg bg-white/80 border border-slate-100 hover:bg-slate-50",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"font-semibold text-slate-900",children:me.schedule_no||`OT-${String(me.id).padStart(6,"0")}`}),r.jsxs("span",{className:"text-[10px] text-slate-500",children:[me.date," ",me.planned_start_time||""]})]}),r.jsx("span",{className:"text-[10px] text-slate-600",children:me.priority||"Elective"})]},me.id))]})})]})]})]}),!Ws&&r.jsxs("div",{className:"mt-3 flex items-center gap-2 rounded-lg border border-amber-200 bg-amber-50 px-3 py-2 text-[11px] text-amber-700",children:[r.jsx(za,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:"Context (OPD / IPD) is not set. Orders will be created but may not be linked to this visit/admission."})]})]})]})}),r.jsx(hy,{open:af,onOpenChange:me=>!me&&Td(),children:r.jsxs(yp,{side:"right",className:"w-full sm:max-w-md",children:[r.jsxs(bp,{children:[r.jsxs(vp,{className:"flex items-center gap-2 text-sm",children:[Fn==="lab"&&r.jsxs(r.Fragment,{children:[r.jsx(Li,{className:"h-4 w-4 text-sky-600"}),"Lab Order Details"]}),Fn==="ris"&&r.jsxs(r.Fragment,{children:[r.jsx(Pw,{className:"h-4 w-4 text-indigo-600"}),"Radiology Order Details"]}),Fn==="rx"&&r.jsxs(r.Fragment,{children:[r.jsx(dr,{className:"h-4 w-4 text-emerald-600"}),"Prescription Details"]}),Fn==="ot"&&r.jsxs(r.Fragment,{children:[r.jsx(Mw,{className:"h-4 w-4 text-amber-600"}),"OT Schedule Details"]})]}),r.jsx(Np,{className:"text-xs text-slate-500",children:"Snapshot of the selected order for this patient."})]}),r.jsxs("div",{className:"mt-4 space-y-3 text-xs text-slate-700",children:[!ut&&r.jsx("p",{className:"text-slate-500",children:"Select an order from the right panel to view details."}),ut&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"grid grid-cols-2 gap-2 rounded-xl border border-slate-100 bg-slate-50/80 p-2",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] text-slate-500",children:"Patient"}),r.jsx("div",{className:"font-semibold text-slate-900",children:SI(t)})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] text-slate-500",children:"Context"}),r.jsxs("div",{className:"font-medium text-slate-900",children:[Ml,"  ",Ws==="ipd"?i||"":a||""]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] text-slate-500",children:"Created"}),r.jsx("div",{className:"text-slate-900",children:uh(Fn==="rx"?ut.rx_datetime||ut.created_at:Fn==="ot"?ut.created_at||ut.date:ut.created_at||ut.order_datetime)})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] text-slate-500",children:"Status"}),r.jsx("div",{className:"capitalize",children:ut.status||(Fn==="rx"?"pending":"ordered")})]})]}),Fn==="lab"&&r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("div",{className:"text-[11px] text-slate-500",children:"Order Number"}),r.jsx("div",{className:"font-semibold text-slate-900",children:ut.order_no||`LAB-${String(ut.id).padStart(6,"0")}`}),ut.tests&&ut.tests.length>0&&r.jsxs("div",{className:"mt-2",children:[r.jsx("div",{className:"text-[11px] text-slate-500 mb-1",children:"Tests"}),r.jsx("ul",{className:"space-y-1",children:ut.tests.map(me=>r.jsxs("li",{className:"flex justify-between rounded-md bg-white px-2 py-1 border border-slate-100",children:[r.jsx("span",{className:"font-medium",children:me.name||me.test_name||"Test"}),r.jsx("span",{className:"text-[11px] text-slate-500",children:me.code||""})]},me.id||me.test_id))})]})]}),Fn==="ris"&&r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("div",{className:"text-[11px] text-slate-500",children:"Order Number"}),r.jsx("div",{className:"font-semibold text-slate-900",children:ut.order_no||`RIS-${String(ut.id).padStart(6,"0")}`}),ut.test&&r.jsxs("div",{className:"mt-2 space-y-1",children:[r.jsx("div",{className:"text-[11px] text-slate-500",children:"Test & Modality"}),r.jsxs("div",{className:"rounded-md bg-white px-2 py-1 border border-slate-100",children:[r.jsx("div",{className:"font-medium",children:ut.test.name||ut.test.test_name}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:[ut.test.modality||ut.test.modality_code||"","  Code:"," ",ut.test.code||""]})]})]})]}),Fn==="rx"&&r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("div",{className:"text-[11px] text-slate-500",children:"Rx Number"}),r.jsx("div",{className:"font-semibold text-slate-900",children:ut.rx_number||`RX-${String(ut.id).padStart(6,"0")}`}),ut.lines&&ut.lines.length>0&&r.jsxs("div",{className:"mt-2",children:[r.jsx("div",{className:"text-[11px] text-slate-500 mb-1",children:"Medicines"}),r.jsx("ul",{className:"space-y-1",children:ut.lines.map((me,Ke)=>r.jsxs("li",{className:"rounded-md bg-white px-2 py-1 border border-slate-100",children:[r.jsx("div",{className:"font-medium",children:me.item_name}),r.jsxs("div",{className:"text-[11px] text-slate-600",children:[me.dose_text||"","  ",me.frequency_code||""," "," ",me.duration_days||""," d  Qty ",me.requested_qty]})]},Ke))})]}),ut.notes&&r.jsxs("div",{className:"mt-2",children:[r.jsx("div",{className:"text-[11px] text-slate-500 mb-1",children:"Notes"}),r.jsx("div",{className:"rounded-md bg-white px-2 py-1 border border-slate-100 text-[11px]",children:ut.notes})]})]}),Fn==="ot"&&r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("div",{className:"text-[11px] text-slate-500",children:"Schedule"}),r.jsx("div",{className:"font-semibold text-slate-900",children:ut.schedule_no||`OT-${String(ut.id).padStart(6,"0")}`}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] text-slate-500",children:"Date"}),r.jsx("div",{children:ut.date||""})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] text-slate-500",children:"Time"}),r.jsxs("div",{children:[ut.planned_start_time||"",ut.planned_end_time?`  ${ut.planned_end_time}`:""]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] text-slate-500",children:"Priority"}),r.jsx("div",{children:ut.priority||"Elective"})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] text-slate-500",children:"Side"}),r.jsx("div",{children:ut.side||"N/A"})]})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("div",{className:"text-[11px] text-slate-500 mb-1",children:"Procedure"}),r.jsx("div",{className:"rounded-md bg-white px-2 py-1 border border-slate-100 text-[11px]",children:((Lt=ut.primary_procedure)==null?void 0:Lt.name)||ut.procedure_name||""})]}),ut.notes&&r.jsxs("div",{className:"mt-2",children:[r.jsx("div",{className:"text-[11px] text-slate-500 mb-1",children:"Notes"}),r.jsx("div",{className:"rounded-md bg-white px-2 py-1 border border-slate-100 text-[11px]",children:ut.notes})]})]})]})]})]})})]})}function cS(t){const s=cr(l=>l.user),n=cr(l=>l.modules)||{};if(!t||!s)return!1;if(s.is_admin)return!0;const[a]=t.split(".");return(n[a]||[]).some(l=>l.code===t)}const axe=["Conscious, oriented, stable","Conscious, disoriented","Drowsy but arousable","Unconscious","Restless / agitated","Breathless / tachypnoeic","Post-op stable","Critical, on ventilator"],ixe=["Dressing clean, dry, intact","Dressing slightly soaked","Dressing soaked  change required","Oozing serous discharge","Oozing blood","Redness / swelling around wound","Signs of infection  pus / foul smell"],lxe=["Room air","Nasal cannula 2 L/min","Nasal cannula 4 L/min","Simple face mask 5 L/min","NRBM 10 L/min","HFNC","BiPAP","Ventilator  pressure mode","Ventilator  volume mode"],oxe=["None","Foley catheter in situ","Ryles tube in situ","Intercostal drain (ICD) in situ","Wound drain in situ","Central line in situ","Multiple drains / tubes present"],cxe=[{value:"routine",label:"Routine note"},{value:"incident",label:"Incident note"},{value:"shift_handover",label:"Shift handover note"}];function dxe({admissionId:t,canWrite:s}){const n=cS("ipd.nursing.create"),a=(s??!0)&&n,[i,l]=y.useState([]),[o,c]=y.useState(null),[d,u]=y.useState({entry_time:"",note_type:"routine",patient_condition:"",wound_status:"",oxygen_support:"",urine_output:"",drains_tubes:"",pain_score:"",other_findings:"",significant_events:"",nursing_interventions:"",response_progress:"",handover_note:"",shift:"",is_icu:!1,vital_signs_summary:"",todays_procedures:"",current_condition:"",recent_changes:"",ongoing_treatment:"",watch_next_shift:""}),[h,f]=y.useState(!1),[x,b]=y.useState(!1),[v,w]=y.useState(""),_=d.note_type==="shift_handover",S=()=>u({entry_time:"",note_type:"routine",patient_condition:"",wound_status:"",oxygen_support:"",urine_output:"",drains_tubes:"",pain_score:"",other_findings:"",significant_events:"",nursing_interventions:"",response_progress:"",handover_note:"",shift:"",is_icu:!1,vital_signs_summary:"",todays_procedures:"",current_condition:"",recent_changes:"",ongoing_treatment:"",watch_next_shift:""}),k=I=>{if(!I)return"";const M=new Date(I);return Number.isNaN(M.getTime())?"":M.toLocaleString()},A=y.useMemo(()=>!!(o&&(o.bp_systolic||o.temp_c||o.pulse)),[o]),T=async()=>{var I,M,B;if(t){f(!0),w("");try{const[L,F]=await Promise.allSettled([Tde(t),Ide(t)]);L.status==="fulfilled"?l(L.value.data||[]):w(((B=(M=(I=L.reason)==null?void 0:I.response)==null?void 0:M.data)==null?void 0:B.detail)||"Failed to load nursing notes"),F.status==="fulfilled"&&c(F.value.data||null)}finally{f(!1)}}};y.useEffect(()=>{T()},[t]);const P=I=>M=>{const B=M.target.type==="checkbox"?M.target.checked:M.target.value;u(L=>({...L,[I]:B}))},O=async I=>{var M,B;I.preventDefault(),w(""),b(!0);try{const L={entry_time:d.entry_time?new Date(d.entry_time).toISOString():void 0,note_type:d.note_type||"routine",patient_condition:d.patient_condition||"",wound_status:d.wound_status||"",oxygen_support:d.oxygen_support||"",urine_output:d.urine_output||"",drains_tubes:d.drains_tubes||"",pain_score:d.pain_score||"",other_findings:d.other_findings||"",significant_events:d.significant_events||"",nursing_interventions:d.nursing_interventions||"",response_progress:d.response_progress||"",handover_note:d.handover_note||"",shift:d.shift||null,is_icu:!!d.is_icu,vital_signs_summary:d.vital_signs_summary||"",todays_procedures:d.todays_procedures||"",current_condition:d.current_condition||"",recent_changes:d.recent_changes||"",ongoing_treatment:d.ongoing_treatment||"",watch_next_shift:d.watch_next_shift||"",linked_vital_id:(o==null?void 0:o.id)||void 0};await Pde(t,L),S(),await T()}catch(L){w(((B=(M=L==null?void 0:L.response)==null?void 0:M.data)==null?void 0:B.detail)||"Failed to save nursing note")}finally{b(!1)}},D=I=>{const M=I.note_type||"routine";return M==="incident"?r.jsx("span",{className:"inline-flex items-center rounded-full bg-rose-50 px-2 py-0.5 text-[10px] font-medium uppercase tracking-wide text-rose-700",children:"Incident"}):M==="shift_handover"?r.jsx("span",{className:"inline-flex items-center rounded-full bg-amber-50 px-2 py-0.5 text-[10px] font-medium uppercase tracking-wide text-amber-700",children:"Shift Handover"}):r.jsx("span",{className:"inline-flex items-center rounded-full bg-emerald-50 px-2 py-0.5 text-[10px] font-medium uppercase tracking-wide text-emerald-700",children:"Routine"})};return r.jsxs("div",{className:"space-y-4",children:[!a&&r.jsxs("div",{className:"flex items-start gap-2 rounded-xl border border-amber-200 bg-amber-50 p-3 text-xs text-amber-800",children:[r.jsx(za,{className:"mt-0.5 h-4 w-4"}),r.jsxs("div",{children:[r.jsx("div",{className:"font-semibold",children:"View-only access"}),r.jsx("div",{children:"You dont have permission to add nursing notes."})]})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/80 p-3 md:p-4",children:[r.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(cm,{className:"h-4 w-4 text-slate-700"}),r.jsx("span",{className:"text-sm font-semibold text-slate-800",children:"Latest Vitals Snapshot"})]}),r.jsxs("div",{className:"flex items-center gap-1 text-xs text-slate-500",children:[r.jsx(Ba,{className:"h-3 w-3"}),r.jsx("span",{children:o!=null&&o.recorded_at?k(o.recorded_at):"No recent vitals"})]})]}),A?r.jsxs("div",{className:"grid gap-2 text-xs md:grid-cols-5",children:[r.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-white px-2 py-1.5 shadow-sm",children:[r.jsx(Vs,{className:"h-3.5 w-3.5 text-slate-700"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[10px] uppercase tracking-wide text-slate-400",children:"BP"}),r.jsxs("div",{className:"font-semibold text-slate-800",children:[o.bp_systolic??"","/",o.bp_diastolic??""," mmHg"]})]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-white px-2 py-1.5 shadow-sm",children:[r.jsx(Kp,{className:"h-3.5 w-3.5 text-slate-700"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[10px] uppercase tracking-wide text-slate-400",children:"Temp"}),r.jsxs("div",{className:"font-semibold text-slate-800",children:[o.temp_c??""," C"]})]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-white px-2 py-1.5 shadow-sm",children:[r.jsx(fre,{className:"h-3.5 w-3.5 text-slate-700"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[10px] uppercase tracking-wide text-slate-400",children:"RR"}),r.jsxs("div",{className:"font-semibold text-slate-800",children:[o.rr??"","/min"]})]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-white px-2 py-1.5 shadow-sm",children:[r.jsx(T_,{className:"h-3.5 w-3.5 text-slate-700"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[10px] uppercase tracking-wide text-slate-400",children:"SpO"}),r.jsxs("div",{className:"font-semibold text-slate-800",children:[o.spo2??""," %"]})]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-white px-2 py-1.5 shadow-sm",children:[r.jsx(Vs,{className:"h-3.5 w-3.5 text-slate-700"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[10px] uppercase tracking-wide text-slate-400",children:"Pulse"}),r.jsxs("div",{className:"font-semibold text-slate-800",children:[o.pulse??"","/min"]})]})]})]}):r.jsx("div",{className:"rounded-lg border border-dashed border-slate-200 bg-white px-3 py-2 text-xs text-slate-500",children:"No vitals recorded yet for this admission. Vitals should be entered in the Vitals tab  nursing notes will automatically link to the latest record."})]}),a&&r.jsxs("form",{onSubmit:O,className:"rounded-2xl border border-slate-200 bg-white p-3 shadow-sm md:p-4",children:[r.jsxs("div",{className:"mb-3 flex flex-wrap items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(yr,{className:"h-4 w-4 text-slate-700"}),r.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Add Nursing Note"})]}),r.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-500",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-600",children:"Note type"}),r.jsx("select",{className:"rounded-full border border-slate-200 bg-slate-50 px-2 py-1 text-[11px] text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",value:d.note_type,onChange:P("note_type"),children:cxe.map(I=>r.jsx("option",{value:I.value,children:I.label},I.value))})]}),r.jsxs("label",{className:"flex items-center gap-1",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300",checked:d.is_icu,onChange:P("is_icu")}),r.jsx("span",{children:"ICU note"})]})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Entry time"}),r.jsx("input",{type:"datetime-local",className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",value:d.entry_time,onChange:P("entry_time")}),r.jsx("p",{className:"text-[10px] text-slate-400",children:"Leave blank to use current date & time."})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Patient condition"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",value:d.patient_condition,onChange:P("patient_condition"),children:[r.jsx("option",{value:"",children:"Select condition"}),axe.map(I=>r.jsx("option",{value:I,children:I},I))]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Wound status"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",value:d.wound_status,onChange:P("wound_status"),children:[r.jsx("option",{value:"",children:"Select wound status"}),ixe.map(I=>r.jsx("option",{value:I,children:I},I))]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Oxygen support"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",value:d.oxygen_support,onChange:P("oxygen_support"),children:[r.jsx("option",{value:"",children:"Select oxygen support"}),lxe.map(I=>r.jsx("option",{value:I,children:I},I))]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Urine output"}),r.jsx("input",{className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",placeholder:"E.g. 200 ml clear in last 4 hrs; catheter in situ",value:d.urine_output,onChange:P("urine_output")})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Drains / Tubes"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",value:d.drains_tubes,onChange:P("drains_tubes"),children:[r.jsx("option",{value:"",children:"Select drains / tubes"}),oxe.map(I=>r.jsx("option",{value:I,children:I},I))]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Pain score"}),r.jsx("input",{className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",placeholder:"E.g. 3/10 on VAS",value:d.pain_score,onChange:P("pain_score")})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Shift"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",value:d.shift,onChange:P("shift"),children:[r.jsx("option",{value:"",children:"Select shift"}),r.jsx("option",{value:"Morning",children:"Morning"}),r.jsx("option",{value:"Evening",children:"Evening"}),r.jsx("option",{value:"Night",children:"Night"})]})]}),r.jsxs("div",{className:"md:col-span-2 space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Significant events"}),r.jsx("textarea",{className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",rows:2,placeholder:"Shifting, fall, vomiting, seizure, desaturation, transfusion",value:d.significant_events,onChange:P("significant_events")})]}),r.jsxs("div",{className:"md:col-span-2 space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Nursing interventions"}),r.jsx("textarea",{className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",rows:2,placeholder:"Medications given, oxygen started, IV fluids, dressing, catheter care",value:d.nursing_interventions,onChange:P("nursing_interventions")})]}),r.jsxs("div",{className:"md:col-span-2 space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Patient response / progress"}),r.jsx("textarea",{className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",rows:2,placeholder:"Improved / no change / worsened, tolerance to interventions",value:d.response_progress,onChange:P("response_progress")})]}),r.jsxs("div",{className:"md:col-span-2 space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Handover note"}),r.jsx("textarea",{className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",rows:2,placeholder:"What next nurse must watch / continue",value:d.handover_note,onChange:P("handover_note")})]}),r.jsxs("div",{className:"md:col-span-2 space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Other findings"}),r.jsx("textarea",{className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-300",rows:2,placeholder:"Any other clinical observations",value:d.other_findings,onChange:P("other_findings")})]})]}),_&&r.jsxs("div",{className:"mt-4 rounded-2xl border border-amber-200 bg-amber-50/60 p-3 md:p-4",children:[r.jsx("div",{className:"mb-2 text-xs font-semibold uppercase tracking-wide text-amber-700",children:"Shift Handover Details"}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"md:col-span-2 space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Vital signs summary"}),r.jsx("textarea",{className:"w-full rounded-lg border border-amber-200 bg-white px-2 py-1.5 text-xs text-slate-800 focus:border-amber-400 focus:outline-none focus:ring-1 focus:ring-amber-300",rows:2,placeholder:"E.g. Vitals stable, BP 120/80, HR 80/min, SpO 98% on room air",value:d.vital_signs_summary,onChange:P("vital_signs_summary")})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Todays procedures"}),r.jsx("textarea",{className:"w-full rounded-lg border border-amber-200 bg-white px-2 py-1.5 text-xs text-slate-800 focus:border-amber-400 focus:outline-none focus:ring-1 focus:ring-amber-300",rows:2,placeholder:"Dressings, transfusions, physiotherapy, procedures done this shift",value:d.todays_procedures,onChange:P("todays_procedures")})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Current condition"}),r.jsx("textarea",{className:"w-full rounded-lg border border-amber-200 bg-white px-2 py-1.5 text-xs text-slate-800 focus:border-amber-400 focus:outline-none focus:ring-1 focus:ring-amber-300",rows:2,placeholder:"Short summary: stable / critical / pain level / oxygen support",value:d.current_condition,onChange:P("current_condition")})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Recent changes"}),r.jsx("textarea",{className:"w-full rounded-lg border border-amber-200 bg-white px-2 py-1.5 text-xs text-slate-800 focus:border-amber-400 focus:outline-none focus:ring-1 focus:ring-amber-300",rows:2,placeholder:"New symptoms, change in vitals, changes in orders this shift",value:d.recent_changes,onChange:P("recent_changes")})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Ongoing treatment"}),r.jsx("textarea",{className:"w-full rounded-lg border border-amber-200 bg-white px-2 py-1.5 text-xs text-slate-800 focus:border-amber-400 focus:outline-none focus:ring-1 focus:ring-amber-300",rows:2,placeholder:"IV fluids, antibiotics, oxygen therapy, infusions",value:d.ongoing_treatment,onChange:P("ongoing_treatment")})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"To be watched next shift"}),r.jsx("textarea",{className:"w-full rounded-lg border border-amber-200 bg-white px-2 py-1.5 text-xs text-slate-800 focus:border-amber-400 focus:outline-none focus:ring-1 focus:ring-amber-300",rows:2,placeholder:"Risks, observations, next dose timings, lab results to follow up",value:d.watch_next_shift,onChange:P("watch_next_shift")})]})]})]}),r.jsxs("div",{className:"mt-4 flex items-center justify-between gap-2",children:[v&&r.jsx("div",{className:"text-xs text-rose-600",children:v}),r.jsx("button",{type:"submit",disabled:x,className:"ml-auto inline-flex items-center gap-1 rounded-full bg-sky-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-sky-700 disabled:cursor-not-allowed disabled:bg-sky-300",children:x?"Saving":"Add Nursing Note"})]})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm",children:[r.jsxs("div",{className:"flex items-center justify-between px-3 py-2 md:px-4",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(yr,{className:"h-4 w-4 text-slate-700"}),r.jsx("span",{className:"text-sm font-semibold text-slate-800",children:"Recent Nursing Notes"})]}),h&&r.jsx("span",{className:"text-xs text-slate-500",children:"Loading"})]}),!h&&(!i||i.length===0)&&r.jsx("div",{className:"px-3 py-4 text-sm text-slate-500 md:px-4",children:"No nursing notes recorded yet."}),!h&&i&&i.length>0&&r.jsx("div",{className:"divide-y divide-slate-100",children:i.map(I=>r.jsxs("div",{className:"px-3 py-3 text-xs text-slate-800 md:px-4",children:[r.jsxs("div",{className:"mb-1 flex flex-wrap items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-100 px-2 py-0.5 text-[11px] font-medium text-slate-700",children:[r.jsx(Ba,{className:"h-3 w-3"}),k(I.entry_time)]}),D(I),I.shift&&r.jsx("span",{className:"inline-flex items-center rounded-full bg-sky-50 px-2 py-0.5 text-[10px] font-medium uppercase tracking-wide text-sky-700",children:I.shift}),I.is_icu&&r.jsx("span",{className:"inline-flex items-center rounded-full bg-rose-50 px-2 py-0.5 text-[10px] font-medium uppercase tracking-wide text-rose-700",children:"ICU"})]}),I.nurse&&r.jsxs("div",{className:"flex items-center gap-1 text-[11px] text-slate-500",children:[r.jsx(rn,{className:"h-3 w-3"}),r.jsx("span",{children:I.nurse.full_name})]})]}),I.vitals&&r.jsxs("div",{className:"mb-2 flex flex-wrap gap-1.5 text-[11px] text-slate-600",children:[r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-50 px-1.5 py-0.5",children:[r.jsx(Vs,{className:"h-3 w-3"}),"BP:"," ",I.vitals.bp_systolic??"","/",I.vitals.bp_diastolic??""]}),r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-50 px-1.5 py-0.5",children:[r.jsx(Kp,{className:"h-3 w-3"}),"Temp: ",I.vitals.temp_c??""," C"]}),r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-50 px-1.5 py-0.5",children:[r.jsx(Vs,{className:"h-3 w-3"}),"Pulse: ",I.vitals.pulse??"","/min"]}),r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-50 px-1.5 py-0.5",children:[r.jsx(T_,{className:"h-3 w-3"}),"SpO: ",I.vitals.spo2??""," %"]})]}),r.jsxs("div",{className:"space-y-0.5",children:[I.patient_condition&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Condition: "}),r.jsx("span",{children:I.patient_condition})]}),I.wound_status&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Wound: "}),r.jsx("span",{children:I.wound_status})]}),I.oxygen_support&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Oxygen: "}),r.jsx("span",{children:I.oxygen_support})]}),I.urine_output&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Urine: "}),r.jsx("span",{children:I.urine_output})]}),I.drains_tubes&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Drains/Tubes: "}),r.jsx("span",{children:I.drains_tubes})]}),I.pain_score&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Pain: "}),r.jsx("span",{children:I.pain_score})]}),I.significant_events&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Events: "}),r.jsx("span",{children:I.significant_events})]}),I.nursing_interventions&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Interventions: "}),r.jsx("span",{children:I.nursing_interventions})]}),I.response_progress&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Response: "}),r.jsx("span",{children:I.response_progress})]}),I.handover_note&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Handover: "}),r.jsx("span",{children:I.handover_note})]}),I.other_findings&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Other: "}),r.jsx("span",{children:I.other_findings})]}),I.note_type==="shift_handover"&&r.jsxs("div",{className:"mt-2 rounded-xl border border-amber-100 bg-amber-50/60 p-2 space-y-0.5",children:[I.vital_signs_summary&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Vital signs summary: "}),r.jsx("span",{children:I.vital_signs_summary})]}),I.todays_procedures&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Todays procedures: "}),r.jsx("span",{children:I.todays_procedures})]}),I.current_condition&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Current condition: "}),r.jsx("span",{children:I.current_condition})]}),I.recent_changes&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Recent changes: "}),r.jsx("span",{children:I.recent_changes})]}),I.ongoing_treatment&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Ongoing treatment: "}),r.jsx("span",{children:I.ongoing_treatment})]}),I.watch_next_shift&&r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"To be watched next shift: "}),r.jsx("span",{children:I.watch_next_shift})]})]})]})]},I.id))})]}),v&&!a&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 p-2 text-xs text-rose-700",children:v})]})}function uxe({admissionId:t,canWrite:s}){const n=nt("ipd.nursing"),a=typeof s=="boolean"?s:n,[i,l]=y.useState([]),[o,c]=y.useState({recorded_at:"",bp_systolic:"",bp_diastolic:"",temp_c:"",rr:"",spo2:"",pulse:""}),[d,u]=y.useState(""),[h,f]=y.useState(!1),[x,b]=y.useState(!1),v=y.useMemo(()=>i&&i.length>0?i[0]:null,[i]),w=async()=>{var A,T;if(t){f(!0),u("");try{const{data:P}=await Mde(t),O=Array.isArray(P)?P:[];O.sort((D,I)=>new Date(I.recorded_at||0)-new Date(D.recorded_at||0)),l(O)}catch(P){console.error("Vitals load error:",P),u(((T=(A=P==null?void 0:P.response)==null?void 0:A.data)==null?void 0:T.detail)||"Failed to load vitals"),l([])}finally{f(!1)}}};y.useEffect(()=>{w()},[t]);const _=(A,T)=>{c(P=>({...P,[A]:T}))},S=async A=>{var P,O;if(A.preventDefault(),u(""),!(o.recorded_at||o.bp_systolic||o.bp_diastolic||o.temp_c||o.rr||o.spo2||o.pulse)){u("Please enter at least one vital value before saving.");return}try{b(!0);const D={recorded_at:o.recorded_at?new Date(o.recorded_at).toISOString():void 0,bp_systolic:o.bp_systolic?Number(o.bp_systolic):void 0,bp_diastolic:o.bp_diastolic?Number(o.bp_diastolic):void 0,temp_c:o.temp_c?Number(o.temp_c):void 0,rr:o.rr?Number(o.rr):void 0,spo2:o.spo2?Number(o.spo2):void 0,pulse:o.pulse?Number(o.pulse):void 0};await wue(t,D),c({recorded_at:"",bp_systolic:"",bp_diastolic:"",temp_c:"",rr:"",spo2:"",pulse:""}),await w()}catch(D){console.error("Vitals save error:",D),u(((O=(P=D==null?void 0:D.response)==null?void 0:P.data)==null?void 0:O.detail)||"Failed to save vitals")}finally{b(!1)}},k=A=>{if(!A)return"";try{const T=new Date(A);return Number.isNaN(T.getTime())?"":T.toLocaleString(void 0,{dateStyle:"short",timeStyle:"short"})}catch{return""}};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-base font-semibold text-slate-900",children:"Vitals"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Track blood pressure, temperature, pulse, SpO and respiratory rate."})]}),v&&r.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-700",children:[r.jsx("div",{className:"font-medium text-[11px] uppercase tracking-wide text-slate-500",children:"Last recorded"}),r.jsx("div",{className:"mt-0.5 text-[13px]",children:k(v.recorded_at)}),r.jsxs("div",{className:"mt-1 flex flex-wrap gap-2 text-[11px]",children:[r.jsxs("span",{className:"rounded-full bg-white px-2 py-0.5 border border-slate-200",children:["BP:"," ",[v.bp_systolic,v.bp_diastolic].filter(Boolean).join("/")||""]}),r.jsxs("span",{className:"rounded-full bg-white px-2 py-0.5 border border-slate-200",children:["Temp: ",v.temp_c??""," C"]}),r.jsxs("span",{className:"rounded-full bg-white px-2 py-0.5 border border-slate-200",children:["SpO: ",v.spo2??""," %"]}),r.jsxs("span",{className:"rounded-full bg-white px-2 py-0.5 border border-slate-200",children:["Pulse: ",v.pulse??""," /min"]})]})]})]}),!a&&r.jsx("div",{className:"rounded-lg border border-amber-200 bg-amber-50 px-3 py-2 text-xs text-amber-700",children:"View only. You dont have permission to record vitals."}),a&&r.jsxs("form",{onSubmit:S,className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("h3",{className:"text-sm font-medium text-slate-900",children:"Record new vitals"}),r.jsx("span",{className:"text-[11px] text-slate-500",children:"Fields are optional  fill what is measured."})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-4 lg:grid-cols-6",children:[r.jsxs("div",{className:"md:col-span-2 lg:col-span-2",children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"Recorded at"}),r.jsx("input",{type:"datetime-local",className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2.5 py-1.5 text-xs text-slate-900 outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",value:o.recorded_at,onChange:A=>_("recorded_at",A.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"BP (Systolic)"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",placeholder:"mmHg",value:o.bp_systolic,onChange:A=>_("bp_systolic",A.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"BP (Diastolic)"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",placeholder:"mmHg",value:o.bp_diastolic,onChange:A=>_("bp_diastolic",A.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"Temp (C)"}),r.jsx("input",{type:"number",step:"0.1",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",placeholder:"C",value:o.temp_c,onChange:A=>_("temp_c",A.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"RR (/min)"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",placeholder:"breaths/min",value:o.rr,onChange:A=>_("rr",A.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"SpO (%)"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",placeholder:"%",value:o.spo2,onChange:A=>_("spo2",A.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"Pulse (/min)"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",placeholder:"/min",value:o.pulse,onChange:A=>_("pulse",A.target.value)})]})]}),r.jsxs("div",{className:"flex items-center justify-between pt-1",children:[d&&r.jsx("div",{className:"text-xs text-rose-600",children:d}),r.jsxs("button",{type:"submit",disabled:x,className:"inline-flex items-center gap-1 rounded-lg bg-sky-600 px-4 py-1.5 text-xs font-medium text-white shadow-sm hover:bg-sky-700 disabled:cursor-not-allowed disabled:opacity-60",children:[x&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border border-white border-t-transparent"}),r.jsx("span",{children:x?"Saving":"Record vitals"})]})]})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between border-b border-slate-100 px-3 py-2",children:[r.jsx("div",{className:"text-xs font-medium text-slate-700",children:"Vitals history"}),r.jsx("div",{className:"text-[11px] text-slate-500",children:h?"Loading":`${(i==null?void 0:i.length)||0} record${((i==null?void 0:i.length)||0)===1?"":"s"}`})]}),r.jsx("div",{className:"max-h-[320px] overflow-auto text-xs",children:r.jsxs("table",{className:"min-w-full border-collapse",children:[r.jsx("thead",{className:"sticky top-0 bg-slate-50 text-[11px] uppercase tracking-wide text-slate-500",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Time"}),r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"BP (mmHg)"}),r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Temp (C)"}),r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"RR (/min)"}),r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"SpO (%)"}),r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Pulse (/min)"})]})}),r.jsxs("tbody",{children:[!h&&i&&i.map(A=>r.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:k(A.recorded_at)}),r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:[A.bp_systolic,A.bp_diastolic].filter(Boolean).join("/")||""}),r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:A.temp_c??""}),r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:A.rr??""}),r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:A.spo2??""}),r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:A.pulse??""})]},A.id)),!h&&(!i||i.length===0)&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-3 py-4 text-center text-slate-400",children:"No vitals recorded yet."})}),h&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-3 py-4 text-center text-slate-400",children:"Loading vitals"})})]})]})})]})]})}function hxe({admissionId:t}){const[s,n]=y.useState([]),[a,i]=y.useState(""),[l,o]=y.useState(!1),[c,d]=y.useState(!1),[u,h]=y.useState({recorded_at:"",intake_ml:"",urine_ml:"",drains_ml:"",stools_count:"",remarks:""}),f=(T,P)=>{h(O=>({...O,[T]:P}))},x=T=>{if(T)return T.length===16?`${T}:00`:T},b=async()=>{var T,P;if(t){i(""),o(!0);try{const{data:O}=await Ode(t),D=(O||[]).slice().sort((I,M)=>new Date(M.recorded_at||0)-new Date(I.recorded_at||0));n(D)}catch(O){console.error("I/O load error:",O),i(((P=(T=O==null?void 0:O.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to load intake / output"),n([])}finally{o(!1)}}};y.useEffect(()=>{b()},[t]);const v=async T=>{var O,D;if(T.preventDefault(),i(""),!(u.intake_ml||u.urine_ml||u.drains_ml||u.stools_count)){i("Enter at least one value (Intake / Urine / Drains / Stools).");return}try{d(!0);const I={recorded_at:x(u.recorded_at),intake_ml:u.intake_ml?Number(u.intake_ml):0,urine_ml:u.urine_ml?Number(u.urine_ml):0,drains_ml:u.drains_ml?Number(u.drains_ml):0,stools_count:u.stools_count?Number(u.stools_count):0,remarks:u.remarks||""};await Rde(t,I),h({recorded_at:"",intake_ml:"",urine_ml:"",drains_ml:"",stools_count:"",remarks:""}),await b()}catch(I){console.error("I/O save error:",I),i(((D=(O=I==null?void 0:I.response)==null?void 0:O.data)==null?void 0:D.detail)||"Failed to add intake / output")}finally{d(!1)}},w=T=>{if(!T)return"";try{const P=new Date(T);return Number.isNaN(P.getTime())?"":P.toLocaleString(void 0,{dateStyle:"short",timeStyle:"short"})}catch{return""}},_=T=>{if(!T)return"Night";const P=new Date(T);if(Number.isNaN(P.getTime()))return"Night";const O=P.getHours();return O>=6&&O<14?"Morning":O>=14&&O<22?"Evening":"Night"},S=y.useMemo(()=>{if(!s||s.length===0)return null;const T=new Date,P=new Date(T);P.setHours(0,0,0,0);const O=new Date(P);O.setDate(O.getDate()+1);const D={Morning:{intake:0,output:0},Evening:{intake:0,output:0},Night:{intake:0,output:0}};let I=0,M=0;return s.forEach(B=>{const L=new Date(B.recorded_at);if(Number.isNaN(L.getTime())||L<P||L>=O)return;const F=Number(B.intake_ml||0),V=Number(B.urine_ml||0)+Number(B.drains_ml||0);I+=F,M+=V;const $=_(B.recorded_at);D[$].intake+=F,D[$].output+=V}),{date:P,intake:I,output:M,net:I-M,shifts:D}},[s]),k=T=>!T||Number(T)===0?"":`${Number(T)} ml`,A=T=>T===0?"0 ml":`${T>0?"+":""}${T} ml`;return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-base font-semibold text-slate-900",children:"Intake / Output Chart"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Track fluids over 24 hours. Automatically shows total intake, total output, and net balance for today."})]}),r.jsxs("div",{className:"flex flex-col gap-2 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-800",children:[r.jsxs("div",{className:"flex items-center justify-between gap-3",children:[r.jsx("span",{className:"font-medium text-[11px] uppercase tracking-wide text-slate-500",children:"Today's 24-hr balance"}),r.jsx("span",{className:"text-[11px] text-slate-500",children:S?S.date.toLocaleDateString():"No data"})]}),r.jsxs("div",{className:"mt-1 grid grid-cols-3 gap-2",children:[r.jsxs("div",{className:"rounded-xl bg-white px-2 py-1.5 text-center shadow-sm",children:[r.jsx("div",{className:"text-[10px] font-medium text-slate-500",children:"Total Intake"}),r.jsx("div",{className:"text-xs font-semibold text-sky-700",children:S?`${S.intake} ml`:"0 ml"})]}),r.jsxs("div",{className:"rounded-xl bg-white px-2 py-1.5 text-center shadow-sm",children:[r.jsx("div",{className:"text-[10px] font-medium text-slate-500",children:"Total Output"}),r.jsx("div",{className:"text-xs font-semibold text-emerald-700",children:S?`${S.output} ml`:"0 ml"})]}),r.jsxs("div",{className:"rounded-xl bg-white px-2 py-1.5 text-center shadow-sm",children:[r.jsx("div",{className:"text-[10px] font-medium text-slate-500",children:"Net Balance"}),r.jsx("div",{className:`text-xs font-semibold ${S?S.net>=0?"text-sky-800":"text-rose-700":"text-slate-400"}`,children:S?A(S.net):"0 ml"})]})]}),S&&r.jsx("div",{className:"mt-1 grid grid-cols-3 gap-1 text-[10px] text-slate-600",children:["Morning","Evening","Night"].map(T=>r.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white px-1.5 py-1",children:[r.jsx("div",{className:"font-medium text-[10px]",children:T}),r.jsxs("div",{className:"mt-0.5 flex flex-col gap-0.5",children:[r.jsxs("span",{children:["In:"," ",S.shifts[T].intake||S.shifts[T].output?`${S.shifts[T].intake} ml`:""]}),r.jsxs("span",{children:["Out:"," ",S.shifts[T].output||S.shifts[T].intake?`${S.shifts[T].output} ml`:""]})]})]},T))})]})]}),r.jsx(Cn,{anyOf:["ipd.nursing"],children:r.jsxs("form",{onSubmit:v,className:"space-y-3 rounded-2xl border border-slate-200 bg-white p-4 shadow-sm",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("h3",{className:"text-sm font-medium text-slate-900",children:"Record Intake / Output"}),r.jsx("span",{className:"text-[11px] text-slate-500",children:"Enter what is measured; others can be left blank."})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-6",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"Date & Time"}),r.jsx("input",{type:"datetime-local",className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-2.5 py-1.5 text-xs text-slate-900 outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",value:u.recorded_at,onChange:T=>f("recorded_at",T.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"Intake (ml)"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",placeholder:"Oral / IV / Blood",value:u.intake_ml,onChange:T=>f("intake_ml",T.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"Urine (ml)"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",placeholder:"Foley / voided",value:u.urine_ml,onChange:T=>f("urine_ml",T.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"Drains (ml)"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",placeholder:"Abdominal / chest",value:u.drains_ml,onChange:T=>f("drains_ml",T.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"Stools (count)"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",placeholder:"Number of times",value:u.stools_count,onChange:T=>f("stools_count",T.target.value)})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-600",children:"Remarks / Description"}),r.jsx("input",{className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",placeholder:"RL, NS, Water, Urine via Foley, Abdominal drain...",value:u.remarks,onChange:T=>f("remarks",T.target.value)})]})]}),r.jsxs("div",{className:"flex items-center justify-between pt-1",children:[a&&r.jsx("div",{className:"text-xs text-rose-600",children:a}),r.jsxs("button",{type:"submit",disabled:c,className:"inline-flex items-center gap-1 rounded-lg bg-sky-600 px-4 py-1.5 text-xs font-medium text-white shadow-sm hover:bg-sky-700 disabled:cursor-not-allowed disabled:opacity-60",children:[c&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border border-white border-t-transparent"}),r.jsx("span",{children:c?"Saving":"Save entry"})]})]})]})}),r.jsxs("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm",children:[r.jsxs("div",{className:"flex items-center justify-between border-b border-slate-100 px-3 py-2 text-xs",children:[r.jsx("div",{className:"font-medium text-slate-700",children:"I/O history"}),r.jsx("div",{className:"text-[11px] text-slate-500",children:l?"Loading":`${(s==null?void 0:s.length)||0} record${((s==null?void 0:s.length)||0)===1?"":"s"}`})]}),r.jsx("div",{className:"max-h-[320px] overflow-auto text-xs",children:r.jsxs("table",{className:"min-w-[680px] w-full border-collapse",children:[r.jsx("thead",{className:"sticky top-0 bg-slate-50 text-[11px] uppercase tracking-wide text-slate-500",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Time"}),r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Intake (ml)"}),r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Urine (ml)"}),r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Drains (ml)"}),r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Stools (count)"}),r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Shift"}),r.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Remarks"})]})}),r.jsxs("tbody",{children:[!l&&s&&s.map(T=>r.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:w(T.recorded_at)}),r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:k(T.intake_ml)}),r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:k(T.urine_ml)}),r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:k(T.drains_ml)}),r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:T.stools_count||""}),r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:_(T.recorded_at)}),r.jsx("td",{className:"px-3 py-2 align-top text-slate-700",children:T.remarks||""})]},T.id)),!l&&(!s||s.length===0)&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"px-3 py-4 text-center text-slate-400",children:"No intake / output entries yet."})}),l&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"px-3 py-4 text-center text-slate-400",children:"Loading intake / output"})})]})]})})]})]})}function mxe({admissionId:t}){const[s,n]=y.useState([]),[a,i]=y.useState(""),[l,o]=y.useState({vital_signs:"",procedure_undergone:"",todays_diagnostics:"",current_condition:"",recent_changes:"",ongoing_treatment:"",possible_changes:"",other_info:""}),c=async()=>{var u,h;i("");try{const{data:f}=await Lde(t);n((f||[]).sort((x,b)=>new Date(b.created_at)-new Date(x.created_at)))}catch(f){i(((h=(u=f==null?void 0:f.response)==null?void 0:u.data)==null?void 0:h.detail)||"Failed to load handovers")}};y.useEffect(()=>{c()},[t]);const d=async u=>{var h,f;u.preventDefault(),i("");try{await Bde(t,{...l}),o({vital_signs:"",procedure_undergone:"",todays_diagnostics:"",current_condition:"",recent_changes:"",ongoing_treatment:"",possible_changes:"",other_info:""}),await c()}catch(x){i(((f=(h=x==null?void 0:x.response)==null?void 0:h.data)==null?void 0:f.detail)||"Failed to add handover")}};return r.jsxs("div",{className:"space-y-3",children:[r.jsx(Cn,{anyOf:["ipd.nursing"],children:r.jsxs("form",{onSubmit:d,className:"rounded-xl border bg-white p-3 grid gap-3 md:grid-cols-2 text-sm",children:[r.jsx("div",{className:"md:col-span-2 font-medium",children:"Shift Handover"}),r.jsx("input",{className:"input",placeholder:"Vital signs",value:l.vital_signs,onChange:u=>o(h=>({...h,vital_signs:u.target.value}))}),r.jsx("input",{className:"input",placeholder:"Procedure undergone",value:l.procedure_undergone,onChange:u=>o(h=>({...h,procedure_undergone:u.target.value}))}),r.jsx("input",{className:"input md:col-span-2",placeholder:"Today's diagnostics/procedures",value:l.todays_diagnostics,onChange:u=>o(h=>({...h,todays_diagnostics:u.target.value}))}),r.jsx("input",{className:"input",placeholder:"Current condition",value:l.current_condition,onChange:u=>o(h=>({...h,current_condition:u.target.value}))}),r.jsx("input",{className:"input",placeholder:"Recent changes",value:l.recent_changes,onChange:u=>o(h=>({...h,recent_changes:u.target.value}))}),r.jsx("input",{className:"input",placeholder:"Ongoing treatment",value:l.ongoing_treatment,onChange:u=>o(h=>({...h,ongoing_treatment:u.target.value}))}),r.jsx("input",{className:"input",placeholder:"Possible changes/complications",value:l.possible_changes,onChange:u=>o(h=>({...h,possible_changes:u.target.value}))}),r.jsx("input",{className:"input md:col-span-2",placeholder:"Other info",value:l.other_info,onChange:u=>o(h=>({...h,other_info:u.target.value}))}),r.jsx("div",{className:"md:col-span-2 flex justify-end",children:r.jsx("button",{className:"btn",children:"Save"})}),a&&r.jsx("div",{className:"md:col-span-2 rounded-xl border border-rose-200 bg-rose-50 p-2 text-rose-700",children:a})]})}),r.jsx("div",{className:"rounded-xl border overflow-hidden",children:r.jsxs("table",{className:"w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"text-left text-xs text-gray-500 bg-gray-50",children:[r.jsx("th",{className:"px-3 py-2",children:"Time"}),r.jsx("th",{className:"px-3 py-2",children:"Vitals"}),r.jsx("th",{className:"px-3 py-2",children:"Procedure"}),r.jsx("th",{className:"px-3 py-2",children:"Diagnostics"}),r.jsx("th",{className:"px-3 py-2",children:"Condition"})]})}),r.jsxs("tbody",{children:[(s||[]).map(u=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-3 py-2",children:new Date(u.created_at).toLocaleString()}),r.jsx("td",{className:"px-3 py-2",children:u.vital_signs||""}),r.jsx("td",{className:"px-3 py-2",children:u.procedure_undergone||""}),r.jsx("td",{className:"px-3 py-2",children:u.todays_diagnostics||""}),r.jsx("td",{className:"px-3 py-2",children:u.current_condition||""})]},u.id)),!(s!=null&&s.length)&&r.jsx("tr",{children:r.jsx("td",{className:"p-3 text-sm text-gray-500",colSpan:5,children:"No handovers"})})]})]})})]})}function fxe({admissionId:t}){const[s,n]=y.useState([]),[a,i]=y.useState(""),[l,o]=y.useState(""),c=async()=>{var u,h;i("");try{const{data:f}=await Fde(t);n((f||[]).sort((x,b)=>new Date(b.created_at)-new Date(x.created_at)))}catch(f){i(((h=(u=f==null?void 0:f.response)==null?void 0:u.data)==null?void 0:h.detail)||"Failed to load rounds")}};y.useEffect(()=>{c()},[t]);const d=async u=>{var h,f;u.preventDefault(),i("");try{await $de(t,{notes:l||""}),o(""),await c()}catch(x){i(((f=(h=x==null?void 0:x.response)==null?void 0:h.data)==null?void 0:f.detail)||"Failed to add round")}};return r.jsxs("div",{className:"space-y-3",children:[r.jsx(Cn,{anyOf:["ipd.doctor"],children:r.jsxs("form",{onSubmit:d,className:"rounded-xl border bg-white p-3 text-sm space-y-2",children:[r.jsx("div",{className:"font-medium",children:"Add Round Note"}),r.jsx("textarea",{className:"input",rows:3,placeholder:"Notes",value:l,onChange:u=>o(u.target.value)}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{className:"btn",children:"Save"})}),a&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 p-2 text-rose-700",children:a})]})}),r.jsx("div",{className:"rounded-xl border overflow-hidden",children:r.jsxs("table",{className:"w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"text-left text-xs text-gray-500 bg-gray-50",children:[r.jsx("th",{className:"px-3 py-2",children:"Time"}),r.jsx("th",{className:"px-3 py-2",children:"Notes"})]})}),r.jsxs("tbody",{children:[(s||[]).map(u=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-3 py-2",children:new Date(u.created_at).toLocaleString()}),r.jsx("td",{className:"px-3 py-2",children:u.notes||""})]},u.id)),!(s!=null&&s.length)&&r.jsx("tr",{children:r.jsx("td",{className:"p-3 text-sm text-gray-500",colSpan:2,children:"No rounds"})})]})]})})]})}function pxe({admissionId:t}){const[s,n]=y.useState([]),[a,i]=y.useState(""),[l,o]=y.useState({observation:"",plan:""}),c=async()=>{var u,h;i("");try{const{data:f}=await zde(t);n((f||[]).sort((x,b)=>new Date(b.created_at)-new Date(x.created_at)))}catch(f){i(((h=(u=f==null?void 0:f.response)==null?void 0:u.data)==null?void 0:h.detail)||"Failed to load progress notes")}};y.useEffect(()=>{c()},[t]);const d=async u=>{var h,f;u.preventDefault(),i("");try{await Ude(t,{observation:l.observation||"",plan:l.plan||""}),o({observation:"",plan:""}),await c()}catch(x){i(((f=(h=x==null?void 0:x.response)==null?void 0:h.data)==null?void 0:f.detail)||"Failed to add progress note")}};return r.jsxs("div",{className:"space-y-3",children:[r.jsx(Cn,{anyOf:["ipd.doctor"],children:r.jsxs("form",{onSubmit:d,className:"rounded-xl border bg-white p-3 grid gap-3 md:grid-cols-2 text-sm",children:[r.jsx("div",{className:"md:col-span-2 font-medium",children:"New Progress Note"}),r.jsx("textarea",{className:"input",rows:3,placeholder:"Observation",value:l.observation,onChange:u=>o(h=>({...h,observation:u.target.value}))}),r.jsx("textarea",{className:"input",rows:3,placeholder:"Plan",value:l.plan,onChange:u=>o(h=>({...h,plan:u.target.value}))}),r.jsx("div",{className:"md:col-span-2 flex justify-end",children:r.jsx("button",{className:"btn",children:"Save"})}),a&&r.jsx("div",{className:"md:col-span-2 rounded-xl border border-rose-200 bg-rose-50 p-2 text-rose-700",children:a})]})}),r.jsx("div",{className:"rounded-xl border overflow-hidden",children:r.jsxs("table",{className:"w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"text-left text-xs text-gray-500 bg-gray-50",children:[r.jsx("th",{className:"px-3 py-2",children:"Time"}),r.jsx("th",{className:"px-3 py-2",children:"Observation"}),r.jsx("th",{className:"px-3 py-2",children:"Plan"})]})}),r.jsxs("tbody",{children:[(s||[]).map(u=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-3 py-2",children:new Date(u.created_at).toLocaleString()}),r.jsx("td",{className:"px-3 py-2",children:u.observation||""}),r.jsx("td",{className:"px-3 py-2",children:u.plan||""})]},u.id)),!(s!=null&&s.length)&&r.jsx("tr",{children:r.jsx("td",{className:"p-3 text-sm text-gray-500",colSpan:3,children:"No progress notes"})})]})]})})]})}function xxe({label:t="Department  Doctor",value:s,onChange:n}){const[a,i]=y.useState([]),[l,o]=y.useState([]),[c,d]=y.useState(null),[u,h]=y.useState(null),[f,x]=y.useState(!1),[b,v]=y.useState("");y.useEffect(()=>{let S=!0;return(async()=>{var k,A;x(!0),v("");try{const{data:T}=await BB();if(!S)return;i(T||[])}catch(T){if(!S)return;v(((A=(k=T==null?void 0:T.response)==null?void 0:k.data)==null?void 0:A.detail)||"Failed to load departments")}finally{S&&x(!1)}})(),()=>{S=!1}},[]),y.useEffect(()=>{if(!c){o([]);return}let S=!0;return(async()=>{var k,A;x(!0),v("");try{const{data:T}=await FB({departmentId:c,isDoctor:!0});if(!S)return;o(T||[])}catch(T){if(!S)return;v(((A=(k=T==null?void 0:T.response)==null?void 0:k.data)==null?void 0:A.detail)||"Failed to load doctors")}finally{S&&x(!1)}})(),()=>{S=!1}},[c]),y.useEffect(()=>{if(s==null||s===""){h(null);return}const S=Number(s);Number.isFinite(S)&&h(k=>k===S?k:S)},[s]),y.useMemo(()=>l.find(S=>S.id===u)||null,[l,u]);const w=y.useCallback(S=>{const k=S.target.value,A=k?Number(k):null;d(A),h(null),n&&n(null,{department_id:A})},[n]),_=y.useCallback(S=>{const k=S.target.value,A=k?Number(k):null;if(h(A),n){const T={department_id:c,user:l.find(P=>P.id===A)||null};n(A,T)}},[n,c,l]);return r.jsxs("div",{className:"space-y-1 text-sm",children:[t&&r.jsx("label",{className:"block text-xs font-medium text-gray-600",children:t}),r.jsxs("div",{className:"grid gap-2 md:grid-cols-2",children:[r.jsxs("select",{className:"input",value:c??"",onChange:w,children:[r.jsx("option",{value:"",children:"Select department"}),a.map(S=>r.jsx("option",{value:S.id,children:S.name},S.id))]}),r.jsxs("select",{className:"input",value:u??"",onChange:_,disabled:!c||f,children:[r.jsx("option",{value:"",children:c?f?"Loading doctors":"Select doctor":"Select department first"}),l.map(S=>r.jsx("option",{value:S.id,children:S.full_name||S.name||`User #${S.id}`},S.id))]})]}),b&&r.jsx("div",{className:"rounded-md border border-rose-200 bg-rose-50 px-2 py-1 text-xs text-rose-700",children:b})]})}function gxe({admissionId:t}){const[s,n]=y.useState([]),[a,i]=y.useState(""),[l,o]=y.useState(null),[c,d]=y.useState(null),[u,h]=y.useState({type:"internal",to_department:"",external_org:"",reason:""}),f=async()=>{var b,v;i("");try{const{data:w}=await Vde(t);n(w||[])}catch(w){i(((v=(b=w==null?void 0:w.response)==null?void 0:b.data)==null?void 0:v.detail)||"Failed to load referrals")}};y.useEffect(()=>{f()},[t]);const x=async b=>{var v,w;b.preventDefault();try{const _={type:u.type,to_department:u.to_department||"",to_user_id:l||void 0,external_org:u.external_org||"",reason:u.reason||""};await Hde(t,_),h({type:"internal",to_department:"",external_org:"",reason:""}),o(null),d(null),await f()}catch(_){i(((w=(v=_==null?void 0:_.response)==null?void 0:v.data)==null?void 0:w.detail)||"Failed to create referral")}};return r.jsxs("div",{className:"space-y-3",children:[r.jsxs("form",{onSubmit:x,className:"rounded-xl border bg-white p-3 text-sm space-y-3",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Type"}),r.jsxs("select",{className:"input",value:u.type,onChange:b=>h(v=>({...v,type:b.target.value})),children:[r.jsx("option",{value:"internal",children:"Internal"}),r.jsx("option",{value:"external",children:"External"})]})]}),u.type==="internal"?r.jsx("div",{className:"md:col-span-2",children:r.jsx(xxe,{label:"Department  Role  User",value:l||void 0,onChange:(b,v)=>{o(b||null),d((v==null?void 0:v.department_id)||null),h(w=>({...w,to_department:v!=null&&v.department_id?String(v.department_id):""}))}})}):r.jsx("input",{className:"input md:col-span-2",placeholder:"External organization",value:u.external_org,onChange:b=>h(v=>({...v,external_org:b.target.value}))})]}),r.jsx("input",{className:"input",placeholder:"Reason",value:u.reason,onChange:b=>h(v=>({...v,reason:b.target.value}))}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{className:"btn",children:"Save"})}),a&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 p-2 text-rose-700 text-sm",children:a})]}),r.jsx("div",{className:"rounded-xl border overflow-hidden",children:r.jsxs("table",{className:"w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"text-left text-xs text-gray-500 bg-gray-50",children:[r.jsx("th",{className:"px-3 py-2",children:"Type"}),r.jsx("th",{className:"px-3 py-2",children:"To"}),r.jsx("th",{className:"px-3 py-2",children:"Status"})]})}),r.jsxs("tbody",{children:[(s||[]).map(b=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-3 py-2",children:b.type}),r.jsx("td",{className:"px-3 py-2",children:b.type==="internal"?b.to_user_id?`User#${b.to_user_id}`:`Dept ${b.to_department}`:b.external_org||""}),r.jsx("td",{className:"px-3 py-2",children:b.status})]},b.id)),!(s!=null&&s.length)&&r.jsx("tr",{children:r.jsx("td",{className:"p-3 text-sm text-gray-500",colSpan:3,children:"No referrals"})})]})]})})]})}const CI=t=>{if(!t)return"";const s=new Date(t);if(Number.isNaN(s.getTime()))return"";const n=d=>String(d).padStart(2,"0"),a=s.getFullYear(),i=n(s.getMonth()+1),l=n(s.getDate()),o=n(s.getHours()),c=n(s.getMinutes());return`${a}-${i}-${l}T${o}:${c}`},kI=t=>t?t.length===16?`${t}:00`:t:null,dj=[{code:"A90",name:"Dengue fever"},{code:"I10",name:"Essential (primary) hypertension"},{code:"E11",name:"Type 2 diabetes mellitus"},{code:"J45",name:"Asthma"},{code:"K35",name:"Acute appendicitis"}];function yxe({admissionId:t,admission:s,patient:n,canWrite:a=!0,followupOptions:i=[]}){const[l,o]=y.useState(null),[c,d]=y.useState(null),[u,h]=y.useState(""),[f,x]=y.useState(!1),[b,v]=y.useState(!1),[w]=y.useState(!1),[_,S]=y.useState(""),[k,A]=y.useState(dj),T=Array.isArray(i)&&i.length>0,[P,O]=y.useState(!1),[D,I]=y.useState({medical_history:"",treatment_summary:"",medications:"",follow_up:"",icd10_codes:"",final_diagnosis_primary:"",final_diagnosis_secondary:"",hospital_course:"",discharge_condition:"stable",discharge_type:"routine",allergies:"",procedures:"",investigations:"",diet_instructions:"",activity_instructions:"",warning_signs:"",referral_details:"",insurance_details:"",stay_summary:"",patient_ack_name:"",patient_ack_datetime:"",prepared_by_name:"",reviewed_by_name:"",reviewed_by_regno:"",discharge_datetime:"",implants:"",pending_reports:"",patient_education:"",followup_appointment_ref:"",finalize:!1}),[M,B]=y.useState({financial_clearance:!1,clinical_clearance:!1,delay_reason:"",submit:!1}),[L,F]=y.useState([]),V=!!(l!=null&&l.finalized),$=V||a===!1,z=y.useMemo(()=>{if(!(l!=null&&l.finalized_at))return"";try{return new Date(l.finalized_at).toLocaleString()}catch{return String(l.finalized_at)}},[l]),H=y.useMemo(()=>{if(!(c!=null&&c.submitted_at))return"";try{return new Date(c.submitted_at).toLocaleString()}catch{return String(c.submitted_at)}},[c]),q=(s==null?void 0:s.display_code)||(s==null?void 0:s.admission_code)||(l==null?void 0:l.admission_no)||(l==null?void 0:l.admission_code)||"",G=(n==null?void 0:n.uhid)||(n==null?void 0:n.patient_code)||(l==null?void 0:l.patient_code)||(l==null?void 0:l.uhid)||"",re=(s==null?void 0:s.bed_label)||(s==null?void 0:s.bed_code)||(l==null?void 0:l.bed_label)||(l==null?void 0:l.bed_code)||"",ye=n?[n.prefix,n.first_name,n.last_name].filter(Boolean).join(" "):"",Ee=(n==null?void 0:n.age_years)??(n==null?void 0:n.age)??null,ee=(n==null?void 0:n.gender)||(n==null?void 0:n.sex)||"",te=[Ee!=null?`${Ee} yrs`:null,ee].filter(Boolean).join(" / "),ce=(s==null?void 0:s.ward_name)||(s==null?void 0:s.ward)||(s==null?void 0:s.ward_display)||"";function ge(ve){if(!ve)return"";const ae=ve.drug_name||ve.medicine_name||ve.item_name||"",xe=ve.strength||"",je=ve.dose!=null&&ve.dose!==""?`${ve.dose}${ve.dose_unit?` ${ve.dose_unit}`:""}`:"",Fe=ve.frequency_label||ve.frequency||ve.freq||"",Ct=ve.route||"",vt=ve.duration_days!=null&&ve.duration_days!==""?`${ve.duration_days} days`:ve.duration||"";return[ae,xe&&`(${xe})`,je&&`Dose: ${je}`,Fe&&`Freq: ${Fe}`,Ct&&`Route: ${Ct}`,vt&&`For ${vt}`].filter(Boolean).join("  ")}const X=y.useMemo(()=>Array.isArray(L)&&L.length?L.map(ge).filter(Boolean).join(`
`):"",[L]),de=()=>{if(!$){if(!X){se.info("No active medications found for this admission.");return}I(ve=>({...ve,medications:X})),se.success("Discharge medications auto-filled from IPD medication chart.")}},Ce=async()=>{var ve,ae;if(t){h("");try{const[xe,je]=await Promise.all([fue(t),xue(t)]),Fe=(xe==null?void 0:xe.data)||null;o(Fe),Fe?(O(!!(Fe.follow_up&&Fe.follow_up.trim())),I(vt=>({...vt,medical_history:Fe.medical_history||"",treatment_summary:Fe.treatment_summary||"",medications:Fe.medications||"",follow_up:Fe.follow_up||"",icd10_codes:Fe.icd10_codes||"",final_diagnosis_primary:Fe.final_diagnosis_primary||"",final_diagnosis_secondary:Fe.final_diagnosis_secondary||"",hospital_course:Fe.hospital_course||"",discharge_condition:Fe.discharge_condition||"stable",discharge_type:Fe.discharge_type||"routine",allergies:Fe.allergies||"",procedures:Fe.procedures||"",investigations:Fe.investigations||"",diet_instructions:Fe.diet_instructions||"",activity_instructions:Fe.activity_instructions||"",warning_signs:Fe.warning_signs||"",referral_details:Fe.referral_details||"",insurance_details:Fe.insurance_details||"",stay_summary:Fe.stay_summary||"",implants:Fe.implants||"",pending_reports:Fe.pending_reports||"",patient_education:Fe.patient_education||"",followup_appointment_ref:Fe.followup_appointment_ref||"",prepared_by_name:Fe.prepared_by_name||"",reviewed_by_name:Fe.reviewed_by_name||"",reviewed_by_regno:Fe.reviewed_by_regno||"",discharge_datetime:CI(Fe.discharge_datetime),patient_ack_name:Fe.patient_ack_name||"",patient_ack_datetime:CI(Fe.patient_ack_datetime),finalize:!1}))):O(!1);const Ct=(je==null?void 0:je.data)||null;d(Ct),Ct&&B({financial_clearance:!!Ct.financial_clearance,clinical_clearance:!!Ct.clinical_clearance,delay_reason:Ct.delay_reason||"",submit:!1});try{const vt=await LB(t);console.log("``````````````````````````````````````````"),console.log(vt),console.log("``````````````````````````````````````````");const pt=Array.isArray(vt==null?void 0:vt.data)?vt.data:[];F(pt)}catch(vt){console.error("Failed to load IPD medications for discharge",vt)}}catch(xe){const je=((ae=(ve=xe==null?void 0:xe.response)==null?void 0:ve.data)==null?void 0:ae.detail)||(xe==null?void 0:xe.message)||"Failed to load discharge data";h(je),se.error(je)}}};y.useEffect(()=>{Ce()},[t]);const ue=async ve=>{var ae,xe;if(ve.preventDefault(),!!t&&!(D.finalize&&!V&&!window.confirm("Once finalized, this discharge summary cannot be edited. Do you want to continue?"))){x(!0),h("");try{const je={...D,discharge_datetime:kI(D.discharge_datetime),patient_ack_datetime:kI(D.patient_ack_datetime)};await pue(t,je),await Ce(),D.finalize&&!V?se.success("Discharge summary finalized successfully. You can now print and hand over to the patient."):se.success("Discharge draft saved successfully.")}catch(je){const Fe=((xe=(ae=je==null?void 0:je.response)==null?void 0:ae.data)==null?void 0:xe.detail)||(je==null?void 0:je.message)||"Failed to save discharge summary";h(Fe),se.error(Fe)}finally{x(!1)}}},fe=async ve=>{var ae,xe;if(ve.preventDefault(),!!t){v(!0),h("");try{await gue(t,{...M}),await Ce(),se.success("Discharge checklist submitted successfully.")}catch(je){const Fe=((xe=(ae=je==null?void 0:je.response)==null?void 0:ae.data)==null?void 0:xe.detail)||(je==null?void 0:je.message)||"Failed to save checklist";h(Fe),se.error(Fe)}finally{v(!1)}}},pe=ve=>ae=>{var je;const xe=((je=ae==null?void 0:ae.target)==null?void 0:je.type)==="checkbox"?ae.target.checked:ae.target.value;ve==="follow_up"&&O(!1),I(Fe=>({...Fe,[ve]:xe}))},oe=ve=>ae=>{var je;const xe=((je=ae==null?void 0:ae.target)==null?void 0:je.type)==="checkbox"?ae.target.checked:ae.target.value;B(Fe=>({...Fe,[ve]:xe}))},qe=async()=>{var ve,ae,xe;if(t)try{const je=await J.get(`/ipd/admissions/${t}/discharge-summary/pdf`,{responseType:"blob"}),Fe=new Blob([je.data],{type:"application/pdf"}),Ct=window.URL.createObjectURL(Fe),vt=document.createElement("a");vt.href=Ct,vt.download=`discharge-summary-${t}.pdf`,document.body.appendChild(vt),vt.click(),vt.remove(),window.URL.revokeObjectURL(Ct)}catch(je){console.error("PDF download error:",je);const Fe=((ae=(ve=je==null?void 0:je.response)==null?void 0:ve.data)==null?void 0:ae.detail)||(((xe=je==null?void 0:je.response)==null?void 0:xe.status)===401?"Session expired. Please login again.":"Failed to download discharge summary PDF.");alert(Fe)}},Xe=ve=>{const ae=ve.trim().toLowerCase();if(!ae){A(dj);return}A(dj.filter(xe=>xe.code.toLowerCase().includes(ae)||xe.name.toLowerCase().includes(ae)))},jt=ve=>{const ae=ve.target.value;S(ae),Xe(ae)},ft=ve=>{if(!ve)return;const ae=(D.icd10_codes||"").split(`
`).map(je=>je.trim()).filter(Boolean),xe=`${ve.code}  ${ve.name}`;ae.includes(xe)||ae.push(xe),I(je=>({...je,icd10_codes:ae.join(`
`)})),se.success(`Added ICD-10: ${xe}`)},it=ve=>{const xe=(D.icd10_codes||"").split(`
`).map(je=>je.trim()).filter(Boolean).filter(je=>je!==ve);I(je=>({...je,icd10_codes:xe.join(`
`)}))},_t=V?r.jsxs("span",{className:"rounded-full bg-emerald-100 px-3 py-1 font-medium text-emerald-800",children:["Finalized ",z&&` ${z}`]}):r.jsx("span",{className:"rounded-full bg-amber-100 px-3 py-1 font-medium text-amber-800",children:"Draft  Not yet finalized"});return r.jsxs("div",{className:"space-y-4 text-sm text-black",children:[r.jsxs("div",{className:"flex flex-col gap-2 rounded-2xl border bg-gradient-to-r from-sky-50 to-emerald-50 p-3 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-xs font-semibold text-sky-900",children:"Discharge  Medico-Legal Summary"}),r.jsx("div",{className:"text-[11px] text-slate-600",children:"Capture final diagnosis, hospital course, instructions & clearances as per NABH / medico-legal best practice."})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-[11px]",children:[_t,r.jsx("button",{type:"button",onClick:qe,className:"btn btn-sm whitespace-nowrap",children:"Download Discharge PDF"})]})]}),r.jsxs("div",{className:"grid gap-2 md:grid-cols-3",children:[r.jsx(Cn,{anyOf:["ipd.doctor"],children:r.jsxs("div",{className:"rounded-xl border bg-white p-2.5 text-[11px] text-slate-700",children:[r.jsx("div",{className:"mb-0.5 font-semibold",children:"Doctor view"}),r.jsxs("div",{children:["Please complete ",r.jsx("strong",{children:"diagnosis"}),","," ",r.jsx("strong",{children:"hospital course"}),","," ",r.jsx("strong",{children:"discharge medications"}),", and approve discharge."]})]})}),r.jsx(Cn,{anyOf:["ipd.nurse"],children:r.jsxs("div",{className:"rounded-xl border bg-white p-2.5 text-[11px] text-slate-700",children:[r.jsx("div",{className:"mb-0.5 font-semibold",children:"Nurse view"}),r.jsx("div",{children:"Please complete nursing checklist, education, vitals & pending reports before discharge."})]})}),r.jsx(Cn,{anyOf:["billing.manage","billing.view"],children:r.jsxs("div",{className:"rounded-xl border bg-white p-2.5 text-[11px] text-slate-700",children:[r.jsx("div",{className:"mb-0.5 font-semibold",children:"Billing view"}),r.jsx("div",{children:"Confirm all bills and insurance claims are settled to enable final discharge."})]})})]}),r.jsxs("div",{className:"flex flex-wrap gap-x-6 gap-y-1 rounded-2xl border bg-white px-3 py-2 text-[11px] md:text-xs",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-slate-700",children:"Admission:"})," ",r.jsx("span",{className:"text-slate-800",children:q||t||""})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-slate-700",children:"Patient:"})," ",r.jsx("span",{className:"text-slate-800",children:ye||G||""})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-slate-700",children:"UHID:"})," ",r.jsx("span",{className:"text-slate-800",children:G||""})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-slate-700",children:"Age / Sex:"})," ",r.jsx("span",{className:"text-slate-800",children:te||""})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-slate-700",children:"Ward / Bed:"})," ",r.jsx("span",{className:"text-slate-800",children:[ce,re].filter(Boolean).join(" / ")||""})]}),r.jsx("div",{className:"mt-1 w-full text-[10px] text-slate-500 md:mt-0 md:w-auto",children:"Patient demographics are auto-filled from IPD admission. Editing not allowed in this screen."})]}),u&&r.jsx("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:u}),r.jsx(Cn,{anyOf:["ipd.manage","ipd.doctor"],children:r.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[r.jsxs("form",{onSubmit:ue,className:"lg:col-span-2 space-y-4 rounded-2xl border bg-white p-3 md:p-4",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:"Discharge Summary  Clinical Details"}),f&&r.jsx("span",{className:"text-[11px] text-gray-500",children:"Saving"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Medical history"}),r.jsx("span",{className:"text-[10px] text-gray-400",children:"Select known conditions or type to add new history (Diabetes, HTN, Asthma, Surgery, Smoking, Alcohol, etc.)"})]}),r.jsx("textarea",{className:"input min-h-[60px]",placeholder:"Known diabetes, hypertension, CAD, past surgeries, addictions",value:D.medical_history,onChange:pe("medical_history"),disabled:$})]}),r.jsxs("div",{className:"space-y-3 rounded-xl border bg-slate-50/80 p-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-xs font-semibold text-slate-700",children:"A. Final Diagnosis & Hospital Course"}),r.jsx("span",{className:"text-[10px] text-slate-500",children:"Core medico-legal section"})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Final primary diagnosis"}),r.jsx("input",{className:"input",placeholder:"Search diagnosis by name or ICD-10 code (e.g., Dengue, A90)",value:D.final_diagnosis_primary,onChange:pe("final_diagnosis_primary"),disabled:$})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Secondary / comorbid diagnoses"}),r.jsx("input",{className:"input",placeholder:"Add comorbid conditions (optional)",value:D.final_diagnosis_secondary,onChange:pe("final_diagnosis_secondary"),disabled:$})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Hospital course / clinical summary"}),r.jsx("textarea",{className:"input min-h-[90px]",placeholder:"Brief day-wise summary of treatment, response & complications (if any)",value:D.hospital_course,onChange:pe("hospital_course"),disabled:$})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Discharge condition"}),r.jsxs("select",{className:"input",value:D.discharge_condition,onChange:pe("discharge_condition"),disabled:$,children:[r.jsx("option",{value:"stable",children:"Stable"}),r.jsx("option",{value:"improved",children:"Improved"}),r.jsx("option",{value:"unchanged",children:"Unchanged"}),r.jsx("option",{value:"dama",children:"DAMA"}),r.jsx("option",{value:"expired",children:"Expired"})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Discharge type"}),r.jsxs("select",{className:"input",value:D.discharge_type,onChange:pe("discharge_type"),disabled:$,children:[r.jsx("option",{value:"routine",children:"Routine"}),r.jsx("option",{value:"dama",children:"DAMA"}),r.jsx("option",{value:"lama",children:"LAMA"}),r.jsx("option",{value:"referred",children:"Referred"}),r.jsx("option",{value:"absconded",children:"Absconded"})]})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Allergies"}),r.jsx("textarea",{className:"input min-h-[60px]",placeholder:"Search allergy or select NKDA if no known allergies",value:D.allergies,onChange:pe("allergies"),disabled:$}),r.jsx("div",{className:"flex flex-wrap gap-2 pt-1 text-[10px]",children:r.jsx("button",{type:"button",className:"rounded-full border px-2 py-0.5 text-[10px]",onClick:()=>!$&&I(ve=>({...ve,allergies:"No known drug allergy (NKDA)"})),children:" Set NKDA"})})]})]}),r.jsxs("div",{className:"space-y-3 rounded-xl border bg-slate-50/40 p-3",children:[r.jsx("div",{className:"text-xs font-semibold text-slate-700",children:"B. Procedures, Investigations & Instructions"}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Procedures / surgeries performed"}),r.jsx("textarea",{className:"input min-h-[70px]",placeholder:"Search and select performed procedures, then summarise (procedure, date, surgeon)",value:D.procedures,onChange:pe("procedures"),disabled:$})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Investigation highlights"}),r.jsx("textarea",{className:"input min-h-[70px]",placeholder:"Select key abnormal reports to display (labs, imaging) and summarise here",value:D.investigations,onChange:pe("investigations"),disabled:$})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Diet instructions"}),r.jsxs("select",{className:"input",value:D.diet_instructions,onChange:pe("diet_instructions"),disabled:$,children:[r.jsx("option",{value:"",children:"Select diet"}),r.jsx("option",{value:"normal",children:"Normal diet"}),r.jsx("option",{value:"soft",children:"Soft diet"}),r.jsx("option",{value:"diabetic",children:"Diabetic diet"}),r.jsx("option",{value:"renal",children:"Renal diet"}),r.jsx("option",{value:"cardiac",children:"Cardiac diet"}),r.jsx("option",{value:"other",children:"Other / see notes"})]}),r.jsx("div",{className:"text-[10px] text-gray-400",children:"Select recommended discharge diet; details will appear in the summary."})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Activity instructions"}),r.jsxs("select",{className:"input",value:D.activity_instructions,onChange:pe("activity_instructions"),disabled:$,children:[r.jsx("option",{value:"",children:"Select activity"}),r.jsx("option",{value:"bed_rest",children:"Bed rest"}),r.jsx("option",{value:"assisted_walk",children:"Assisted walking / short walks"}),r.jsx("option",{value:"normal_activity",children:"Normal activity as tolerated"}),r.jsx("option",{value:"avoid_heavy_lifting",children:"Avoid heavy lifting / strenuous activity"}),r.jsx("option",{value:"other",children:"Other / see notes"})]})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Warning / red-flag symptoms"}),r.jsx("textarea",{className:"input min-h-[60px]",placeholder:"Select symptoms that require immediate hospital visit and list here",value:D.warning_signs,onChange:pe("warning_signs"),disabled:$})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Referral / transfer details (if referred)"}),r.jsx("textarea",{className:"input min-h-[60px]",placeholder:"Search referred hospital / doctor and note reason for transfer",value:D.referral_details,onChange:pe("referral_details"),disabled:$})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Discharge medications"}),!$&&r.jsx("button",{type:"button",onClick:de,className:"rounded-full border px-2 py-0.5 text-[10px] text-sky-700 hover:bg-sky-50",children:"Use IPD medication chart"})]}),r.jsx("textarea",{className:"input min-h-[70px]",placeholder:"Search drug name to auto-fill dose & frequency, then summarise (name, dose, frequency, duration)",value:D.medications,onChange:pe("medications"),disabled:$}),Array.isArray(L)&&L.length>0&&r.jsxs("div",{className:"mt-1 rounded-lg border bg-slate-50 p-2",children:[r.jsx("div",{className:"mb-1 text-[10px] text-slate-500",children:"IPD medication chart (preview):"}),r.jsx("ul",{className:"max-h-32 space-y-0.5 overflow-auto text-[11px] text-slate-700",children:L.slice(0,10).map((ve,ae)=>r.jsx("li",{children:ge(ve)},ve.id||ae))})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Follow-up advice"}),r.jsxs("div",{className:"flex flex-col items-end",children:[r.jsx("span",{className:"text-[10px] text-gray-400",children:"Follow-up auto-linked from OPD appointment (backend)."}),P&&!V&&r.jsx("span",{className:"text-[10px] text-emerald-600",children:"Auto-filled from records  editable"})]})]}),r.jsx("textarea",{className:"input min-h-[70px]",placeholder:"Follow-up date, department, OPD number, additional instructions",value:D.follow_up,onChange:pe("follow_up"),disabled:$})]})]}),r.jsxs("div",{className:"space-y-3 rounded-xl border bg-slate-50/60 p-3",children:[r.jsx("div",{className:"text-xs font-semibold text-slate-700",children:"E. Safety & Quality"}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Implants used (if any)"}),r.jsx("textarea",{className:"input min-h-[50px]",placeholder:"Search implant by name or serial number (optional), then record details here",value:D.implants,onChange:pe("implants"),disabled:$})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Pending reports"}),r.jsx("textarea",{className:"input min-h-[50px]",placeholder:"Select pending test reports and note how / when patient will receive them",value:D.pending_reports,onChange:pe("pending_reports"),disabled:$})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Patient education provided"}),r.jsx("textarea",{className:"input min-h-[60px]",placeholder:"Select education provided (wound care, insulin injection, physiotherapy, lifestyle advice) and summarise here",value:D.patient_education,onChange:pe("patient_education"),disabled:$})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Follow-up appointment ID / token"}),T?r.jsxs("select",{className:"input",value:D.followup_appointment_ref,onChange:pe("followup_appointment_ref"),disabled:$||w,children:[r.jsx("option",{value:"",children:w?"Loading follow-ups":"Select linked OPD follow-up"}),i.map(ve=>r.jsx("option",{value:ve.value,children:ve.label},ve.value))]}):r.jsx("input",{className:"input",placeholder:"Linked OPD appointment ID / token",value:D.followup_appointment_ref,onChange:pe("followup_appointment_ref"),disabled:$}),r.jsx("div",{className:"text-[10px] text-gray-400",children:"Dropdown will show OPD follow-ups for this patient (to be wired from OPD module)."})]})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600",children:"ICD-10 codes"}),r.jsxs("div",{className:"space-y-1 rounded-lg border bg-slate-50/70 p-2",children:[r.jsx("div",{className:"mb-1 text-[11px] text-slate-600",children:'Search ICD-10 by diagnosis name or code (e.g., "Dengue"  A90). Start typing to see suggestions.'}),r.jsx("input",{className:"input h-8 text-[12px]",placeholder:'Type to search (e.g., "dengue", "A90")',value:_,onChange:jt,disabled:$}),!$&&r.jsxs("div",{className:"mt-1 flex flex-wrap gap-1",children:[k.length===0&&r.jsx("span",{className:"text-[10px] text-slate-400",children:"No matches. Try a different spelling."}),k.map(ve=>r.jsxs("button",{type:"button",className:"rounded-full border px-2 py-0.5 text-[10px] hover:bg-slate-100",onClick:()=>ft(ve),children:[ve.code,"  ",ve.name]},ve.code))]})]}),r.jsx("textarea",{className:"input mt-2 min-h-[70px] text-[12px]",placeholder:"Selected ICD-10 codes will appear here, one per line (e.g., A90  Dengue fever).",value:D.icd10_codes,onChange:pe("icd10_codes"),disabled:$}),!$&&D.icd10_codes&&r.jsx("div",{className:"mt-1 flex flex-wrap gap-1 text-[10px] text-slate-500",children:(D.icd10_codes||"").split(`
`).map(ve=>ve.trim()).filter(Boolean).map(ve=>r.jsxs("button",{type:"button",className:"rounded-full border px-2 py-0.5 hover:bg-rose-50",onClick:()=>it(ve),children:[" ",ve]},ve))})]}),r.jsxs("div",{className:"flex flex-col gap-2 border-t pt-2 text-xs text-gray-600 md:flex-row md:items-center md:justify-between",children:[r.jsx("div",{children:V?r.jsxs("span",{children:["Finalized at"," ",r.jsx("span",{className:"font-medium text-emerald-700",children:z})]}):r.jsx("span",{children:"Fill mandatory details before finalizing. Once finalized, this summary cannot be edited."})}),r.jsxs("div",{className:"flex items-center gap-3",children:[!V&&r.jsxs("label",{className:"inline-flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:D.finalize,onChange:pe("finalize"),disabled:$}),r.jsx("span",{className:"text-xs",children:"Mark as finalized"})]}),r.jsx("button",{className:"btn",disabled:f||V||!a,children:f?"Saving":"Save summary"})]})]})]})]}),r.jsx("div",{className:"space-y-4",children:r.jsxs("form",{onSubmit:fe,className:"space-y-4 rounded-2xl border bg-white p-3 md:p-4",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:"Discharge Checklist & Clearance"}),b&&r.jsx("span",{className:"text-[11px] text-gray-500",children:"Saving"})]}),r.jsxs("div",{className:"space-y-2 rounded-xl bg-slate-50/80 p-3",children:[r.jsx("div",{className:"text-[11px] font-medium text-slate-700",children:"Financial & clinical clearance"}),r.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[r.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:M.financial_clearance,onChange:oe("financial_clearance")}),r.jsx("span",{children:"Financial clearance completed  confirm all bills and insurance claims are settled."})]}),r.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[r.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:M.clinical_clearance,onChange:oe("clinical_clearance")}),r.jsx("span",{children:"Clinical discharge clearance given by doctor."})]}),r.jsx("input",{className:"input mt-1",placeholder:"Delay reason (if any)",value:M.delay_reason,onChange:oe("delay_reason")})]}),r.jsxs("div",{className:"space-y-3 rounded-xl bg-slate-50/80 p-3",children:[r.jsx("div",{className:"text-[11px] font-medium text-slate-700",children:"Insurance / TPA & stay summary"}),r.jsx("textarea",{className:"input min-h-[70px]",placeholder:"Payer name, claim number, pre-auth number, claim status",value:D.insurance_details,onChange:pe("insurance_details"),disabled:$}),r.jsx("textarea",{className:"input min-h-[60px]",placeholder:"Total days admitted, ICU days (if any), ward type (general / semi-private / private)",value:D.stay_summary,onChange:pe("stay_summary"),disabled:$})]}),r.jsxs("div",{className:"space-y-3 rounded-xl bg-slate-50/80 p-3",children:[r.jsx("div",{className:"text-[11px] font-medium text-slate-700",children:"Patient acknowledgement"}),r.jsx("input",{className:"input",placeholder:"Patient / attendant name",value:D.patient_ack_name,onChange:pe("patient_ack_name"),disabled:$}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-gray-600",children:"Acknowledgement date & time"}),r.jsx("input",{type:"datetime-local",className:"input",value:D.patient_ack_datetime,onChange:pe("patient_ack_datetime"),disabled:$})]})]}),r.jsxs("div",{className:"space-y-3 rounded-xl bg-slate-50/80 p-3",children:[r.jsx("div",{className:"text-[11px] font-medium text-slate-700",children:"Doctor & system validation"}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-gray-600",children:"Prepared by (nurse / junior doctor)"}),r.jsx("input",{className:"input",placeholder:"Name of nurse / intern",value:D.prepared_by_name,onChange:pe("prepared_by_name"),disabled:$})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-gray-600",children:"Reviewed & approved by"}),r.jsx("input",{className:"input mb-1",placeholder:"Consultant doctor name",value:D.reviewed_by_name,onChange:pe("reviewed_by_name"),disabled:$}),r.jsx("input",{className:"input",placeholder:"Registration number",value:D.reviewed_by_regno,onChange:pe("reviewed_by_regno"),disabled:$})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-gray-600",children:"Discharge date & time"}),r.jsx("input",{type:"datetime-local",className:"input",value:D.discharge_datetime,onChange:pe("discharge_datetime"),disabled:$})]}),r.jsx("div",{className:"text-[10px] text-slate-500",children:"Clinical clearance confirms the patient is medically fit for discharge."})]}),r.jsxs("div",{className:"flex items-center justify-between border-t pt-2 text-xs",children:[r.jsxs("label",{className:"inline-flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:M.submit,onChange:oe("submit")}),r.jsx("span",{children:"Submit discharge checklist"})]}),r.jsx("button",{className:"btn",disabled:b,children:b?"Saving":"Save checklist"})]}),(c==null?void 0:c.submitted)&&r.jsxs("div",{className:"text-[11px] text-emerald-700",children:["Checklist submitted at"," ",r.jsx("span",{className:"font-medium",children:H})]})]})})]})})]})}function bxe({admissionId:t}){const s=cS("ipd.view")||cS("ipd.manage"),[n,a]=y.useState(""),[i,l]=y.useState(""),[o,c]=y.useState(null),[d,u]=y.useState(""),[h,f]=y.useState([]),x=y.useMemo(()=>{const v=new Map;for(const w of h||[])v.set(w.id,w.code);return v},[h]);y.useEffect(()=>{let v=!0;return(async()=>{try{const w=await Nl();v&&f((w==null?void 0:w.data)||[])}catch{}try{const{data:w}=await RB(t);if(!v)return;const _=w!=null&&w.admitted_at?new Date(w.admitted_at).toISOString().slice(0,10):"",S=new Date().toISOString().slice(0,10);a(_),l(S)}catch{}})(),()=>{v=!1}},[t]);const b=async()=>{var v,w;u(""),c(null);try{const{data:_}=await bue(t,{...n?{from_date:n}:{},...i?{to_date:i}:{}});c(_)}catch(_){u(((w=(v=_==null?void 0:_.response)==null?void 0:v.data)==null?void 0:w.detail)||"Failed to preview charges")}};return s?r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"rounded-xl border bg-white p-3 grid gap-3 md:grid-cols-5 text-sm",children:[r.jsx("div",{className:"md:col-span-5 font-medium",children:"Bed Charge Preview"}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"From"}),r.jsx("input",{type:"date",className:"input",value:n,onChange:v=>a(v.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"To"}),r.jsx("input",{type:"date",className:"input",value:i,onChange:v=>l(v.target.value)})]}),r.jsx("div",{className:"md:col-span-3 flex items-end justify-end",children:r.jsx("button",{className:"btn",onClick:b,children:"Preview"})}),d&&r.jsx("div",{className:"md:col-span-5 rounded-xl border border-rose-200 bg-rose-50 p-2 text-rose-700",children:d})]}),o&&r.jsxs("div",{className:"rounded-xl border overflow-hidden bg-white",children:[r.jsxs("table",{className:"w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"text-left text-xs text-gray-500 bg-gray-50",children:[r.jsx("th",{className:"px-3 py-2",children:"Date"}),r.jsx("th",{className:"px-3 py-2",children:"Room Type"}),r.jsx("th",{className:"px-3 py-2",children:"Bed"}),r.jsx("th",{className:"px-3 py-2",children:"Rate"})]})}),r.jsxs("tbody",{children:[(o.days||[]).map((v,w)=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-3 py-2",children:new Date(v.date).toLocaleDateString()}),r.jsx("td",{className:"px-3 py-2",children:v.room_type||""}),r.jsx("td",{className:"px-3 py-2",children:v.bed_id&&x.get(v.bed_id)||""}),r.jsx("td",{className:"px-3 py-2",children:Number(v.rate).toFixed(2)})]},w)),r.jsxs("tr",{className:"bg-gray-50 font-medium",children:[r.jsx("td",{className:"px-3 py-2",colSpan:3,children:"Total"}),r.jsx("td",{className:"px-3 py-2",children:Number(o.total_amount||0).toFixed(2)})]})]})]}),!!o.missing_rate_days&&r.jsxs("div",{className:"px-3 py-2 text-xs text-amber-700 bg-amber-50 border-t",children:["Note: ",o.missing_rate_days," day(s) had no bed rate set for the room type."]})]})]}):r.jsx("div",{className:"rounded-lg border border-rose-200 bg-rose-50 p-2 text-sm text-rose-700",children:"Access denied (need ipd.view)."})}const vxe=["top","right","bottom","left"],id=Math.min,ri=Math.max,h1=Math.round,ig=Math.floor,ro=t=>({x:t,y:t}),Nxe={left:"right",right:"left",bottom:"top",top:"bottom"},wxe={start:"end",end:"start"};function dS(t,s,n){return ri(t,id(s,n))}function Wo(t,s){return typeof t=="function"?t(s):t}function qo(t){return t.split("-")[0]}function Wm(t){return t.split("-")[1]}function $k(t){return t==="x"?"y":"x"}function zk(t){return t==="y"?"height":"width"}const jxe=new Set(["top","bottom"]);function Xl(t){return jxe.has(qo(t))?"y":"x"}function Uk(t){return $k(Xl(t))}function _xe(t,s,n){n===void 0&&(n=!1);const a=Wm(t),i=Uk(t),l=zk(i);let o=i==="x"?a===(n?"end":"start")?"right":"left":a==="start"?"bottom":"top";return s.reference[l]>s.floating[l]&&(o=m1(o)),[o,m1(o)]}function Sxe(t){const s=m1(t);return[uS(t),s,uS(s)]}function uS(t){return t.replace(/start|end/g,s=>wxe[s])}const AI=["left","right"],EI=["right","left"],Cxe=["top","bottom"],kxe=["bottom","top"];function Axe(t,s,n){switch(t){case"top":case"bottom":return n?s?EI:AI:s?AI:EI;case"left":case"right":return s?Cxe:kxe;default:return[]}}function Exe(t,s,n,a){const i=Wm(t);let l=Axe(qo(t),n==="start",a);return i&&(l=l.map(o=>o+"-"+i),s&&(l=l.concat(l.map(uS)))),l}function m1(t){return t.replace(/left|right|bottom|top/g,s=>Nxe[s])}function Txe(t){return{top:0,right:0,bottom:0,left:0,...t}}function m$(t){return typeof t!="number"?Txe(t):{top:t,right:t,bottom:t,left:t}}function f1(t){const{x:s,y:n,width:a,height:i}=t;return{width:a,height:i,top:n,left:s,right:s+a,bottom:n+i,x:s,y:n}}function TI(t,s,n){let{reference:a,floating:i}=t;const l=Xl(s),o=Uk(s),c=zk(o),d=qo(s),u=l==="y",h=a.x+a.width/2-i.width/2,f=a.y+a.height/2-i.height/2,x=a[c]/2-i[c]/2;let b;switch(d){case"top":b={x:h,y:a.y-i.height};break;case"bottom":b={x:h,y:a.y+a.height};break;case"right":b={x:a.x+a.width,y:f};break;case"left":b={x:a.x-i.width,y:f};break;default:b={x:a.x,y:a.y}}switch(Wm(s)){case"start":b[o]-=x*(n&&u?-1:1);break;case"end":b[o]+=x*(n&&u?-1:1);break}return b}const Pxe=async(t,s,n)=>{const{placement:a="bottom",strategy:i="absolute",middleware:l=[],platform:o}=n,c=l.filter(Boolean),d=await(o.isRTL==null?void 0:o.isRTL(s));let u=await o.getElementRects({reference:t,floating:s,strategy:i}),{x:h,y:f}=TI(u,a,d),x=a,b={},v=0;for(let w=0;w<c.length;w++){const{name:_,fn:S}=c[w],{x:k,y:A,data:T,reset:P}=await S({x:h,y:f,initialPlacement:a,placement:x,strategy:i,middlewareData:b,rects:u,platform:o,elements:{reference:t,floating:s}});h=k??h,f=A??f,b={...b,[_]:{...b[_],...T}},P&&v<=50&&(v++,typeof P=="object"&&(P.placement&&(x=P.placement),P.rects&&(u=P.rects===!0?await o.getElementRects({reference:t,floating:s,strategy:i}):P.rects),{x:h,y:f}=TI(u,x,d)),w=-1)}return{x:h,y:f,placement:x,strategy:i,middlewareData:b}};async function nx(t,s){var n;s===void 0&&(s={});const{x:a,y:i,platform:l,rects:o,elements:c,strategy:d}=t,{boundary:u="clippingAncestors",rootBoundary:h="viewport",elementContext:f="floating",altBoundary:x=!1,padding:b=0}=Wo(s,t),v=m$(b),_=c[x?f==="floating"?"reference":"floating":f],S=f1(await l.getClippingRect({element:(n=await(l.isElement==null?void 0:l.isElement(_)))==null||n?_:_.contextElement||await(l.getDocumentElement==null?void 0:l.getDocumentElement(c.floating)),boundary:u,rootBoundary:h,strategy:d})),k=f==="floating"?{x:a,y:i,width:o.floating.width,height:o.floating.height}:o.reference,A=await(l.getOffsetParent==null?void 0:l.getOffsetParent(c.floating)),T=await(l.isElement==null?void 0:l.isElement(A))?await(l.getScale==null?void 0:l.getScale(A))||{x:1,y:1}:{x:1,y:1},P=f1(l.convertOffsetParentRelativeRectToViewportRelativeRect?await l.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:k,offsetParent:A,strategy:d}):k);return{top:(S.top-P.top+v.top)/T.y,bottom:(P.bottom-S.bottom+v.bottom)/T.y,left:(S.left-P.left+v.left)/T.x,right:(P.right-S.right+v.right)/T.x}}const Ixe=t=>({name:"arrow",options:t,async fn(s){const{x:n,y:a,placement:i,rects:l,platform:o,elements:c,middlewareData:d}=s,{element:u,padding:h=0}=Wo(t,s)||{};if(u==null)return{};const f=m$(h),x={x:n,y:a},b=Uk(i),v=zk(b),w=await o.getDimensions(u),_=b==="y",S=_?"top":"left",k=_?"bottom":"right",A=_?"clientHeight":"clientWidth",T=l.reference[v]+l.reference[b]-x[b]-l.floating[v],P=x[b]-l.reference[b],O=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let D=O?O[A]:0;(!D||!await(o.isElement==null?void 0:o.isElement(O)))&&(D=c.floating[A]||l.floating[v]);const I=T/2-P/2,M=D/2-w[v]/2-1,B=id(f[S],M),L=id(f[k],M),F=B,V=D-w[v]-L,$=D/2-w[v]/2+I,z=dS(F,$,V),H=!d.arrow&&Wm(i)!=null&&$!==z&&l.reference[v]/2-($<F?B:L)-w[v]/2<0,q=H?$<F?$-F:$-V:0;return{[b]:x[b]+q,data:{[b]:z,centerOffset:$-z-q,...H&&{alignmentOffset:q}},reset:H}}}),Mxe=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(s){var n,a;const{placement:i,middlewareData:l,rects:o,initialPlacement:c,platform:d,elements:u}=s,{mainAxis:h=!0,crossAxis:f=!0,fallbackPlacements:x,fallbackStrategy:b="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:w=!0,..._}=Wo(t,s);if((n=l.arrow)!=null&&n.alignmentOffset)return{};const S=qo(i),k=Xl(c),A=qo(c)===c,T=await(d.isRTL==null?void 0:d.isRTL(u.floating)),P=x||(A||!w?[m1(c)]:Sxe(c)),O=v!=="none";!x&&O&&P.push(...Exe(c,w,v,T));const D=[c,...P],I=await nx(s,_),M=[];let B=((a=l.flip)==null?void 0:a.overflows)||[];if(h&&M.push(I[S]),f){const $=_xe(i,o,T);M.push(I[$[0]],I[$[1]])}if(B=[...B,{placement:i,overflows:M}],!M.every($=>$<=0)){var L,F;const $=(((L=l.flip)==null?void 0:L.index)||0)+1,z=D[$];if(z&&(!(f==="alignment"?k!==Xl(z):!1)||B.every(G=>Xl(G.placement)===k?G.overflows[0]>0:!0)))return{data:{index:$,overflows:B},reset:{placement:z}};let H=(F=B.filter(q=>q.overflows[0]<=0).sort((q,G)=>q.overflows[1]-G.overflows[1])[0])==null?void 0:F.placement;if(!H)switch(b){case"bestFit":{var V;const q=(V=B.filter(G=>{if(O){const re=Xl(G.placement);return re===k||re==="y"}return!0}).map(G=>[G.placement,G.overflows.filter(re=>re>0).reduce((re,ye)=>re+ye,0)]).sort((G,re)=>G[1]-re[1])[0])==null?void 0:V[0];q&&(H=q);break}case"initialPlacement":H=c;break}if(i!==H)return{reset:{placement:H}}}return{}}}};function PI(t,s){return{top:t.top-s.height,right:t.right-s.width,bottom:t.bottom-s.height,left:t.left-s.width}}function II(t){return vxe.some(s=>t[s]>=0)}const Dxe=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(s){const{rects:n}=s,{strategy:a="referenceHidden",...i}=Wo(t,s);switch(a){case"referenceHidden":{const l=await nx(s,{...i,elementContext:"reference"}),o=PI(l,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:II(o)}}}case"escaped":{const l=await nx(s,{...i,altBoundary:!0}),o=PI(l,n.floating);return{data:{escapedOffsets:o,escaped:II(o)}}}default:return{}}}}},f$=new Set(["left","top"]);async function Oxe(t,s){const{placement:n,platform:a,elements:i}=t,l=await(a.isRTL==null?void 0:a.isRTL(i.floating)),o=qo(n),c=Wm(n),d=Xl(n)==="y",u=f$.has(o)?-1:1,h=l&&d?-1:1,f=Wo(s,t);let{mainAxis:x,crossAxis:b,alignmentAxis:v}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return c&&typeof v=="number"&&(b=c==="end"?v*-1:v),d?{x:b*h,y:x*u}:{x:x*u,y:b*h}}const Rxe=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(s){var n,a;const{x:i,y:l,placement:o,middlewareData:c}=s,d=await Oxe(s,t);return o===((n=c.offset)==null?void 0:n.placement)&&(a=c.arrow)!=null&&a.alignmentOffset?{}:{x:i+d.x,y:l+d.y,data:{...d,placement:o}}}}},Lxe=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(s){const{x:n,y:a,placement:i}=s,{mainAxis:l=!0,crossAxis:o=!1,limiter:c={fn:_=>{let{x:S,y:k}=_;return{x:S,y:k}}},...d}=Wo(t,s),u={x:n,y:a},h=await nx(s,d),f=Xl(qo(i)),x=$k(f);let b=u[x],v=u[f];if(l){const _=x==="y"?"top":"left",S=x==="y"?"bottom":"right",k=b+h[_],A=b-h[S];b=dS(k,b,A)}if(o){const _=f==="y"?"top":"left",S=f==="y"?"bottom":"right",k=v+h[_],A=v-h[S];v=dS(k,v,A)}const w=c.fn({...s,[x]:b,[f]:v});return{...w,data:{x:w.x-n,y:w.y-a,enabled:{[x]:l,[f]:o}}}}}},Bxe=function(t){return t===void 0&&(t={}),{options:t,fn(s){const{x:n,y:a,placement:i,rects:l,middlewareData:o}=s,{offset:c=0,mainAxis:d=!0,crossAxis:u=!0}=Wo(t,s),h={x:n,y:a},f=Xl(i),x=$k(f);let b=h[x],v=h[f];const w=Wo(c,s),_=typeof w=="number"?{mainAxis:w,crossAxis:0}:{mainAxis:0,crossAxis:0,...w};if(d){const A=x==="y"?"height":"width",T=l.reference[x]-l.floating[A]+_.mainAxis,P=l.reference[x]+l.reference[A]-_.mainAxis;b<T?b=T:b>P&&(b=P)}if(u){var S,k;const A=x==="y"?"width":"height",T=f$.has(qo(i)),P=l.reference[f]-l.floating[A]+(T&&((S=o.offset)==null?void 0:S[f])||0)+(T?0:_.crossAxis),O=l.reference[f]+l.reference[A]+(T?0:((k=o.offset)==null?void 0:k[f])||0)-(T?_.crossAxis:0);v<P?v=P:v>O&&(v=O)}return{[x]:b,[f]:v}}}},Fxe=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(s){var n,a;const{placement:i,rects:l,platform:o,elements:c}=s,{apply:d=()=>{},...u}=Wo(t,s),h=await nx(s,u),f=qo(i),x=Wm(i),b=Xl(i)==="y",{width:v,height:w}=l.floating;let _,S;f==="top"||f==="bottom"?(_=f,S=x===(await(o.isRTL==null?void 0:o.isRTL(c.floating))?"start":"end")?"left":"right"):(S=f,_=x==="end"?"top":"bottom");const k=w-h.top-h.bottom,A=v-h.left-h.right,T=id(w-h[_],k),P=id(v-h[S],A),O=!s.middlewareData.shift;let D=T,I=P;if((n=s.middlewareData.shift)!=null&&n.enabled.x&&(I=A),(a=s.middlewareData.shift)!=null&&a.enabled.y&&(D=k),O&&!x){const B=ri(h.left,0),L=ri(h.right,0),F=ri(h.top,0),V=ri(h.bottom,0);b?I=v-2*(B!==0||L!==0?B+L:ri(h.left,h.right)):D=w-2*(F!==0||V!==0?F+V:ri(h.top,h.bottom))}await d({...s,availableWidth:I,availableHeight:D});const M=await o.getDimensions(c.floating);return v!==M.width||w!==M.height?{reset:{rects:!0}}:{}}}};function Nv(){return typeof window<"u"}function qm(t){return p$(t)?(t.nodeName||"").toLowerCase():"#document"}function hi(t){var s;return(t==null||(s=t.ownerDocument)==null?void 0:s.defaultView)||window}function xo(t){var s;return(s=(p$(t)?t.ownerDocument:t.document)||window.document)==null?void 0:s.documentElement}function p$(t){return Nv()?t instanceof Node||t instanceof hi(t).Node:!1}function _l(t){return Nv()?t instanceof Element||t instanceof hi(t).Element:!1}function lo(t){return Nv()?t instanceof HTMLElement||t instanceof hi(t).HTMLElement:!1}function MI(t){return!Nv()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof hi(t).ShadowRoot}const $xe=new Set(["inline","contents"]);function Yx(t){const{overflow:s,overflowX:n,overflowY:a,display:i}=Sl(t);return/auto|scroll|overlay|hidden|clip/.test(s+a+n)&&!$xe.has(i)}const zxe=new Set(["table","td","th"]);function Uxe(t){return zxe.has(qm(t))}const Vxe=[":popover-open",":modal"];function wv(t){return Vxe.some(s=>{try{return t.matches(s)}catch{return!1}})}const Hxe=["transform","translate","scale","rotate","perspective"],Wxe=["transform","translate","scale","rotate","perspective","filter"],qxe=["paint","layout","strict","content"];function Vk(t){const s=Hk(),n=_l(t)?Sl(t):t;return Hxe.some(a=>n[a]?n[a]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!s&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!s&&(n.filter?n.filter!=="none":!1)||Wxe.some(a=>(n.willChange||"").includes(a))||qxe.some(a=>(n.contain||"").includes(a))}function Gxe(t){let s=ld(t);for(;lo(s)&&!pm(s);){if(Vk(s))return s;if(wv(s))return null;s=ld(s)}return null}function Hk(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Kxe=new Set(["html","body","#document"]);function pm(t){return Kxe.has(qm(t))}function Sl(t){return hi(t).getComputedStyle(t)}function jv(t){return _l(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function ld(t){if(qm(t)==="html")return t;const s=t.assignedSlot||t.parentNode||MI(t)&&t.host||xo(t);return MI(s)?s.host:s}function x$(t){const s=ld(t);return pm(s)?t.ownerDocument?t.ownerDocument.body:t.body:lo(s)&&Yx(s)?s:x$(s)}function rx(t,s,n){var a;s===void 0&&(s=[]),n===void 0&&(n=!0);const i=x$(t),l=i===((a=t.ownerDocument)==null?void 0:a.body),o=hi(i);if(l){const c=hS(o);return s.concat(o,o.visualViewport||[],Yx(i)?i:[],c&&n?rx(c):[])}return s.concat(i,rx(i,[],n))}function hS(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function g$(t){const s=Sl(t);let n=parseFloat(s.width)||0,a=parseFloat(s.height)||0;const i=lo(t),l=i?t.offsetWidth:n,o=i?t.offsetHeight:a,c=h1(n)!==l||h1(a)!==o;return c&&(n=l,a=o),{width:n,height:a,$:c}}function Wk(t){return _l(t)?t:t.contextElement}function Kh(t){const s=Wk(t);if(!lo(s))return ro(1);const n=s.getBoundingClientRect(),{width:a,height:i,$:l}=g$(s);let o=(l?h1(n.width):n.width)/a,c=(l?h1(n.height):n.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!c||!Number.isFinite(c))&&(c=1),{x:o,y:c}}const Yxe=ro(0);function y$(t){const s=hi(t);return!Hk()||!s.visualViewport?Yxe:{x:s.visualViewport.offsetLeft,y:s.visualViewport.offsetTop}}function Xxe(t,s,n){return s===void 0&&(s=!1),!n||s&&n!==hi(t)?!1:s}function Cu(t,s,n,a){s===void 0&&(s=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),l=Wk(t);let o=ro(1);s&&(a?_l(a)&&(o=Kh(a)):o=Kh(t));const c=Xxe(l,n,a)?y$(l):ro(0);let d=(i.left+c.x)/o.x,u=(i.top+c.y)/o.y,h=i.width/o.x,f=i.height/o.y;if(l){const x=hi(l),b=a&&_l(a)?hi(a):a;let v=x,w=hS(v);for(;w&&a&&b!==v;){const _=Kh(w),S=w.getBoundingClientRect(),k=Sl(w),A=S.left+(w.clientLeft+parseFloat(k.paddingLeft))*_.x,T=S.top+(w.clientTop+parseFloat(k.paddingTop))*_.y;d*=_.x,u*=_.y,h*=_.x,f*=_.y,d+=A,u+=T,v=hi(w),w=hS(v)}}return f1({width:h,height:f,x:d,y:u})}function _v(t,s){const n=jv(t).scrollLeft;return s?s.left+n:Cu(xo(t)).left+n}function b$(t,s){const n=t.getBoundingClientRect(),a=n.left+s.scrollLeft-_v(t,n),i=n.top+s.scrollTop;return{x:a,y:i}}function Qxe(t){let{elements:s,rect:n,offsetParent:a,strategy:i}=t;const l=i==="fixed",o=xo(a),c=s?wv(s.floating):!1;if(a===o||c&&l)return n;let d={scrollLeft:0,scrollTop:0},u=ro(1);const h=ro(0),f=lo(a);if((f||!f&&!l)&&((qm(a)!=="body"||Yx(o))&&(d=jv(a)),lo(a))){const b=Cu(a);u=Kh(a),h.x=b.x+a.clientLeft,h.y=b.y+a.clientTop}const x=o&&!f&&!l?b$(o,d):ro(0);return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-d.scrollLeft*u.x+h.x+x.x,y:n.y*u.y-d.scrollTop*u.y+h.y+x.y}}function Zxe(t){return Array.from(t.getClientRects())}function Jxe(t){const s=xo(t),n=jv(t),a=t.ownerDocument.body,i=ri(s.scrollWidth,s.clientWidth,a.scrollWidth,a.clientWidth),l=ri(s.scrollHeight,s.clientHeight,a.scrollHeight,a.clientHeight);let o=-n.scrollLeft+_v(t);const c=-n.scrollTop;return Sl(a).direction==="rtl"&&(o+=ri(s.clientWidth,a.clientWidth)-i),{width:i,height:l,x:o,y:c}}const DI=25;function e0e(t,s){const n=hi(t),a=xo(t),i=n.visualViewport;let l=a.clientWidth,o=a.clientHeight,c=0,d=0;if(i){l=i.width,o=i.height;const h=Hk();(!h||h&&s==="fixed")&&(c=i.offsetLeft,d=i.offsetTop)}const u=_v(a);if(u<=0){const h=a.ownerDocument,f=h.body,x=getComputedStyle(f),b=h.compatMode==="CSS1Compat"&&parseFloat(x.marginLeft)+parseFloat(x.marginRight)||0,v=Math.abs(a.clientWidth-f.clientWidth-b);v<=DI&&(l-=v)}else u<=DI&&(l+=u);return{width:l,height:o,x:c,y:d}}const t0e=new Set(["absolute","fixed"]);function s0e(t,s){const n=Cu(t,!0,s==="fixed"),a=n.top+t.clientTop,i=n.left+t.clientLeft,l=lo(t)?Kh(t):ro(1),o=t.clientWidth*l.x,c=t.clientHeight*l.y,d=i*l.x,u=a*l.y;return{width:o,height:c,x:d,y:u}}function OI(t,s,n){let a;if(s==="viewport")a=e0e(t,n);else if(s==="document")a=Jxe(xo(t));else if(_l(s))a=s0e(s,n);else{const i=y$(t);a={x:s.x-i.x,y:s.y-i.y,width:s.width,height:s.height}}return f1(a)}function v$(t,s){const n=ld(t);return n===s||!_l(n)||pm(n)?!1:Sl(n).position==="fixed"||v$(n,s)}function n0e(t,s){const n=s.get(t);if(n)return n;let a=rx(t,[],!1).filter(c=>_l(c)&&qm(c)!=="body"),i=null;const l=Sl(t).position==="fixed";let o=l?ld(t):t;for(;_l(o)&&!pm(o);){const c=Sl(o),d=Vk(o);!d&&c.position==="fixed"&&(i=null),(l?!d&&!i:!d&&c.position==="static"&&!!i&&t0e.has(i.position)||Yx(o)&&!d&&v$(t,o))?a=a.filter(h=>h!==o):i=c,o=ld(o)}return s.set(t,a),a}function r0e(t){let{element:s,boundary:n,rootBoundary:a,strategy:i}=t;const o=[...n==="clippingAncestors"?wv(s)?[]:n0e(s,this._c):[].concat(n),a],c=o[0],d=o.reduce((u,h)=>{const f=OI(s,h,i);return u.top=ri(f.top,u.top),u.right=id(f.right,u.right),u.bottom=id(f.bottom,u.bottom),u.left=ri(f.left,u.left),u},OI(s,c,i));return{width:d.right-d.left,height:d.bottom-d.top,x:d.left,y:d.top}}function a0e(t){const{width:s,height:n}=g$(t);return{width:s,height:n}}function i0e(t,s,n){const a=lo(s),i=xo(s),l=n==="fixed",o=Cu(t,!0,l,s);let c={scrollLeft:0,scrollTop:0};const d=ro(0);function u(){d.x=_v(i)}if(a||!a&&!l)if((qm(s)!=="body"||Yx(i))&&(c=jv(s)),a){const b=Cu(s,!0,l,s);d.x=b.x+s.clientLeft,d.y=b.y+s.clientTop}else i&&u();l&&!a&&i&&u();const h=i&&!a&&!l?b$(i,c):ro(0),f=o.left+c.scrollLeft-d.x-h.x,x=o.top+c.scrollTop-d.y-h.y;return{x:f,y:x,width:o.width,height:o.height}}function uj(t){return Sl(t).position==="static"}function RI(t,s){if(!lo(t)||Sl(t).position==="fixed")return null;if(s)return s(t);let n=t.offsetParent;return xo(t)===n&&(n=n.ownerDocument.body),n}function N$(t,s){const n=hi(t);if(wv(t))return n;if(!lo(t)){let i=ld(t);for(;i&&!pm(i);){if(_l(i)&&!uj(i))return i;i=ld(i)}return n}let a=RI(t,s);for(;a&&Uxe(a)&&uj(a);)a=RI(a,s);return a&&pm(a)&&uj(a)&&!Vk(a)?n:a||Gxe(t)||n}const l0e=async function(t){const s=this.getOffsetParent||N$,n=this.getDimensions,a=await n(t.floating);return{reference:i0e(t.reference,await s(t.floating),t.strategy),floating:{x:0,y:0,width:a.width,height:a.height}}};function o0e(t){return Sl(t).direction==="rtl"}const c0e={convertOffsetParentRelativeRectToViewportRelativeRect:Qxe,getDocumentElement:xo,getClippingRect:r0e,getOffsetParent:N$,getElementRects:l0e,getClientRects:Zxe,getDimensions:a0e,getScale:Kh,isElement:_l,isRTL:o0e};function w$(t,s){return t.x===s.x&&t.y===s.y&&t.width===s.width&&t.height===s.height}function d0e(t,s){let n=null,a;const i=xo(t);function l(){var c;clearTimeout(a),(c=n)==null||c.disconnect(),n=null}function o(c,d){c===void 0&&(c=!1),d===void 0&&(d=1),l();const u=t.getBoundingClientRect(),{left:h,top:f,width:x,height:b}=u;if(c||s(),!x||!b)return;const v=ig(f),w=ig(i.clientWidth-(h+x)),_=ig(i.clientHeight-(f+b)),S=ig(h),A={rootMargin:-v+"px "+-w+"px "+-_+"px "+-S+"px",threshold:ri(0,id(1,d))||1};let T=!0;function P(O){const D=O[0].intersectionRatio;if(D!==d){if(!T)return o();D?o(!1,D):a=setTimeout(()=>{o(!1,1e-7)},1e3)}D===1&&!w$(u,t.getBoundingClientRect())&&o(),T=!1}try{n=new IntersectionObserver(P,{...A,root:i.ownerDocument})}catch{n=new IntersectionObserver(P,A)}n.observe(t)}return o(!0),l}function u0e(t,s,n,a){a===void 0&&(a={});const{ancestorScroll:i=!0,ancestorResize:l=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:d=!1}=a,u=Wk(t),h=i||l?[...u?rx(u):[],...rx(s)]:[];h.forEach(S=>{i&&S.addEventListener("scroll",n,{passive:!0}),l&&S.addEventListener("resize",n)});const f=u&&c?d0e(u,n):null;let x=-1,b=null;o&&(b=new ResizeObserver(S=>{let[k]=S;k&&k.target===u&&b&&(b.unobserve(s),cancelAnimationFrame(x),x=requestAnimationFrame(()=>{var A;(A=b)==null||A.observe(s)})),n()}),u&&!d&&b.observe(u),b.observe(s));let v,w=d?Cu(t):null;d&&_();function _(){const S=Cu(t);w&&!w$(w,S)&&n(),w=S,v=requestAnimationFrame(_)}return n(),()=>{var S;h.forEach(k=>{i&&k.removeEventListener("scroll",n),l&&k.removeEventListener("resize",n)}),f==null||f(),(S=b)==null||S.disconnect(),b=null,d&&cancelAnimationFrame(v)}}const h0e=Rxe,m0e=Lxe,f0e=Mxe,p0e=Fxe,x0e=Dxe,LI=Ixe,g0e=Bxe,y0e=(t,s,n)=>{const a=new Map,i={platform:c0e,...n},l={...i.platform,_c:a};return Pxe(t,s,{...i,platform:l})};var b0e=typeof document<"u",v0e=function(){},my=b0e?y.useLayoutEffect:v0e;function p1(t,s){if(t===s)return!0;if(typeof t!=typeof s)return!1;if(typeof t=="function"&&t.toString()===s.toString())return!0;let n,a,i;if(t&&s&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==s.length)return!1;for(a=n;a--!==0;)if(!p1(t[a],s[a]))return!1;return!0}if(i=Object.keys(t),n=i.length,n!==Object.keys(s).length)return!1;for(a=n;a--!==0;)if(!{}.hasOwnProperty.call(s,i[a]))return!1;for(a=n;a--!==0;){const l=i[a];if(!(l==="_owner"&&t.$$typeof)&&!p1(t[l],s[l]))return!1}return!0}return t!==t&&s!==s}function j$(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function BI(t,s){const n=j$(t);return Math.round(s*n)/n}function hj(t){const s=y.useRef(t);return my(()=>{s.current=t}),s}function N0e(t){t===void 0&&(t={});const{placement:s="bottom",strategy:n="absolute",middleware:a=[],platform:i,elements:{reference:l,floating:o}={},transform:c=!0,whileElementsMounted:d,open:u}=t,[h,f]=y.useState({x:0,y:0,strategy:n,placement:s,middlewareData:{},isPositioned:!1}),[x,b]=y.useState(a);p1(x,a)||b(a);const[v,w]=y.useState(null),[_,S]=y.useState(null),k=y.useCallback(G=>{G!==O.current&&(O.current=G,w(G))},[]),A=y.useCallback(G=>{G!==D.current&&(D.current=G,S(G))},[]),T=l||v,P=o||_,O=y.useRef(null),D=y.useRef(null),I=y.useRef(h),M=d!=null,B=hj(d),L=hj(i),F=hj(u),V=y.useCallback(()=>{if(!O.current||!D.current)return;const G={placement:s,strategy:n,middleware:x};L.current&&(G.platform=L.current),y0e(O.current,D.current,G).then(re=>{const ye={...re,isPositioned:F.current!==!1};$.current&&!p1(I.current,ye)&&(I.current=ye,pd.flushSync(()=>{f(ye)}))})},[x,s,n,L,F]);my(()=>{u===!1&&I.current.isPositioned&&(I.current.isPositioned=!1,f(G=>({...G,isPositioned:!1})))},[u]);const $=y.useRef(!1);my(()=>($.current=!0,()=>{$.current=!1}),[]),my(()=>{if(T&&(O.current=T),P&&(D.current=P),T&&P){if(B.current)return B.current(T,P,V);V()}},[T,P,V,B,M]);const z=y.useMemo(()=>({reference:O,floating:D,setReference:k,setFloating:A}),[k,A]),H=y.useMemo(()=>({reference:T,floating:P}),[T,P]),q=y.useMemo(()=>{const G={position:n,left:0,top:0};if(!H.floating)return G;const re=BI(H.floating,h.x),ye=BI(H.floating,h.y);return c?{...G,transform:"translate("+re+"px, "+ye+"px)",...j$(H.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:re,top:ye}},[n,c,H.floating,h.x,h.y]);return y.useMemo(()=>({...h,update:V,refs:z,elements:H,floatingStyles:q}),[h,V,z,H,q])}const w0e=t=>{function s(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:a,padding:i}=typeof t=="function"?t(n):t;return a&&s(a)?a.current!=null?LI({element:a.current,padding:i}).fn(n):{}:a?LI({element:a,padding:i}).fn(n):{}}}},j0e=(t,s)=>({...h0e(t),options:[t,s]}),_0e=(t,s)=>({...m0e(t),options:[t,s]}),S0e=(t,s)=>({...g0e(t),options:[t,s]}),C0e=(t,s)=>({...f0e(t),options:[t,s]}),k0e=(t,s)=>({...p0e(t),options:[t,s]}),A0e=(t,s)=>({...x0e(t),options:[t,s]}),E0e=(t,s)=>({...w0e(t),options:[t,s]});var T0e="Arrow",_$=y.forwardRef((t,s)=>{const{children:n,width:a=10,height:i=5,...l}=t;return r.jsx(rs.svg,{...l,ref:s,width:a,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:r.jsx("polygon",{points:"0,0 30,0 15,10"})})});_$.displayName=T0e;var P0e=_$;function I0e(t){const[s,n]=y.useState(void 0);return zr(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const a=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const l=i[0];let o,c;if("borderBoxSize"in l){const d=l.borderBoxSize,u=Array.isArray(d)?d[0]:d;o=u.inlineSize,c=u.blockSize}else o=t.offsetWidth,c=t.offsetHeight;n({width:o,height:c})});return a.observe(t,{box:"border-box"}),()=>a.unobserve(t)}else n(void 0)},[t]),s}var qk="Popper",[S$,C$]=Wu(qk),[M0e,k$]=S$(qk),A$=t=>{const{__scopePopper:s,children:n}=t,[a,i]=y.useState(null);return r.jsx(M0e,{scope:s,anchor:a,onAnchorChange:i,children:n})};A$.displayName=qk;var E$="PopperAnchor",T$=y.forwardRef((t,s)=>{const{__scopePopper:n,virtualRef:a,...i}=t,l=k$(E$,n),o=y.useRef(null),c=Ts(s,o),d=y.useRef(null);return y.useEffect(()=>{const u=d.current;d.current=(a==null?void 0:a.current)||o.current,u!==d.current&&l.onAnchorChange(d.current)}),a?null:r.jsx(rs.div,{...i,ref:c})});T$.displayName=E$;var Gk="PopperContent",[D0e,O0e]=S$(Gk),P$=y.forwardRef((t,s)=>{var de,Ce,ue,fe,pe,oe;const{__scopePopper:n,side:a="bottom",sideOffset:i=0,align:l="center",alignOffset:o=0,arrowPadding:c=0,avoidCollisions:d=!0,collisionBoundary:u=[],collisionPadding:h=0,sticky:f="partial",hideWhenDetached:x=!1,updatePositionStrategy:b="optimized",onPlaced:v,...w}=t,_=k$(Gk,n),[S,k]=y.useState(null),A=Ts(s,qe=>k(qe)),[T,P]=y.useState(null),O=I0e(T),D=(O==null?void 0:O.width)??0,I=(O==null?void 0:O.height)??0,M=a+(l!=="center"?"-"+l:""),B=typeof h=="number"?h:{top:0,right:0,bottom:0,left:0,...h},L=Array.isArray(u)?u:[u],F=L.length>0,V={padding:B,boundary:L.filter(L0e),altBoundary:F},{refs:$,floatingStyles:z,placement:H,isPositioned:q,middlewareData:G}=N0e({strategy:"fixed",placement:M,whileElementsMounted:(...qe)=>u0e(...qe,{animationFrame:b==="always"}),elements:{reference:_.anchor},middleware:[j0e({mainAxis:i+I,alignmentAxis:o}),d&&_0e({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?S0e():void 0,...V}),d&&C0e({...V}),k0e({...V,apply:({elements:qe,rects:Xe,availableWidth:jt,availableHeight:ft})=>{const{width:it,height:_t}=Xe.reference,ve=qe.floating.style;ve.setProperty("--radix-popper-available-width",`${jt}px`),ve.setProperty("--radix-popper-available-height",`${ft}px`),ve.setProperty("--radix-popper-anchor-width",`${it}px`),ve.setProperty("--radix-popper-anchor-height",`${_t}px`)}}),T&&E0e({element:T,padding:c}),B0e({arrowWidth:D,arrowHeight:I}),x&&A0e({strategy:"referenceHidden",...V})]}),[re,ye]=D$(H),Ee=da(v);zr(()=>{q&&(Ee==null||Ee())},[q,Ee]);const ee=(de=G.arrow)==null?void 0:de.x,te=(Ce=G.arrow)==null?void 0:Ce.y,ce=((ue=G.arrow)==null?void 0:ue.centerOffset)!==0,[ge,X]=y.useState();return zr(()=>{S&&X(window.getComputedStyle(S).zIndex)},[S]),r.jsx("div",{ref:$.setFloating,"data-radix-popper-content-wrapper":"",style:{...z,transform:q?z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ge,"--radix-popper-transform-origin":[(fe=G.transformOrigin)==null?void 0:fe.x,(pe=G.transformOrigin)==null?void 0:pe.y].join(" "),...((oe=G.hide)==null?void 0:oe.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:r.jsx(D0e,{scope:n,placedSide:re,onArrowChange:P,arrowX:ee,arrowY:te,shouldHideArrow:ce,children:r.jsx(rs.div,{"data-side":re,"data-align":ye,...w,ref:A,style:{...w.style,animation:q?void 0:"none"}})})})});P$.displayName=Gk;var I$="PopperArrow",R0e={top:"bottom",right:"left",bottom:"top",left:"right"},M$=y.forwardRef(function(s,n){const{__scopePopper:a,...i}=s,l=O0e(I$,a),o=R0e[l.placedSide];return r.jsx("span",{ref:l.onArrowChange,style:{position:"absolute",left:l.arrowX,top:l.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[l.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[l.placedSide],visibility:l.shouldHideArrow?"hidden":void 0},children:r.jsx(P0e,{...i,ref:n,style:{...i.style,display:"block"}})})});M$.displayName=I$;function L0e(t){return t!==null}var B0e=t=>({name:"transformOrigin",options:t,fn(s){var _,S,k;const{placement:n,rects:a,middlewareData:i}=s,o=((_=i.arrow)==null?void 0:_.centerOffset)!==0,c=o?0:t.arrowWidth,d=o?0:t.arrowHeight,[u,h]=D$(n),f={start:"0%",center:"50%",end:"100%"}[h],x=(((S=i.arrow)==null?void 0:S.x)??0)+c/2,b=(((k=i.arrow)==null?void 0:k.y)??0)+d/2;let v="",w="";return u==="bottom"?(v=o?f:`${x}px`,w=`${-d}px`):u==="top"?(v=o?f:`${x}px`,w=`${a.floating.height+d}px`):u==="right"?(v=`${-d}px`,w=o?f:`${b}px`):u==="left"&&(v=`${a.floating.width+d}px`,w=o?f:`${b}px`),{data:{x:v,y:w}}}});function D$(t){const[s,n="center"]=t.split("-");return[s,n]}var F0e=A$,$0e=T$,z0e=P$,U0e=M$;function V0e(t){const s=y.useRef({value:t,previous:t});return y.useMemo(()=>(s.current.value!==t&&(s.current.previous=s.current.value,s.current.value=t),s.current.previous),[t])}var O$=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),H0e="VisuallyHidden",W0e=y.forwardRef((t,s)=>r.jsx(rs.span,{...t,ref:s,style:{...O$,...t.style}}));W0e.displayName=H0e;var q0e=[" ","Enter","ArrowUp","ArrowDown"],G0e=[" ","Enter"],ku="Select",[Sv,Cv,K0e]=HB(ku),[Gm]=Wu(ku,[K0e,C$]),kv=C$(),[Y0e,yd]=Gm(ku),[X0e,Q0e]=Gm(ku),R$=t=>{const{__scopeSelect:s,children:n,open:a,defaultOpen:i,onOpenChange:l,value:o,defaultValue:c,onValueChange:d,dir:u,name:h,autoComplete:f,disabled:x,required:b,form:v}=t,w=kv(s),[_,S]=y.useState(null),[k,A]=y.useState(null),[T,P]=y.useState(!1),O=cv(u),[D,I]=sx({prop:a,defaultProp:i??!1,onChange:l,caller:ku}),[M,B]=sx({prop:o,defaultProp:c,onChange:d,caller:ku}),L=y.useRef(null),F=_?v||!!_.closest("form"):!0,[V,$]=y.useState(new Set),z=Array.from(V).map(H=>H.props.value).join(";");return r.jsx(F0e,{...w,children:r.jsxs(Y0e,{required:b,scope:s,trigger:_,onTriggerChange:S,valueNode:k,onValueNodeChange:A,valueNodeHasChildren:T,onValueNodeHasChildrenChange:P,contentId:Zc(),value:M,onValueChange:B,open:D,onOpenChange:I,dir:O,triggerPointerDownPosRef:L,disabled:x,children:[r.jsx(Sv.Provider,{scope:s,children:r.jsx(X0e,{scope:t.__scopeSelect,onNativeOptionAdd:y.useCallback(H=>{$(q=>new Set(q).add(H))},[]),onNativeOptionRemove:y.useCallback(H=>{$(q=>{const G=new Set(q);return G.delete(H),G})},[]),children:n})}),F?r.jsxs(iz,{"aria-hidden":!0,required:b,tabIndex:-1,name:h,autoComplete:f,value:M,onChange:H=>B(H.target.value),disabled:x,form:v,children:[M===void 0?r.jsx("option",{value:""}):null,Array.from(V)]},z):null]})})};R$.displayName=ku;var L$="SelectTrigger",B$=y.forwardRef((t,s)=>{const{__scopeSelect:n,disabled:a=!1,...i}=t,l=kv(n),o=yd(L$,n),c=o.disabled||a,d=Ts(s,o.onTriggerChange),u=Cv(n),h=y.useRef("touch"),[f,x,b]=oz(w=>{const _=u().filter(A=>!A.disabled),S=_.find(A=>A.value===o.value),k=cz(_,w,S);k!==void 0&&o.onValueChange(k.value)}),v=w=>{c||(o.onOpenChange(!0),b()),w&&(o.triggerPointerDownPosRef.current={x:Math.round(w.pageX),y:Math.round(w.pageY)})};return r.jsx($0e,{asChild:!0,...l,children:r.jsx(rs.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:c,"data-disabled":c?"":void 0,"data-placeholder":lz(o.value)?"":void 0,...i,ref:d,onClick:Zt(i.onClick,w=>{w.currentTarget.focus(),h.current!=="mouse"&&v(w)}),onPointerDown:Zt(i.onPointerDown,w=>{h.current=w.pointerType;const _=w.target;_.hasPointerCapture(w.pointerId)&&_.releasePointerCapture(w.pointerId),w.button===0&&w.ctrlKey===!1&&w.pointerType==="mouse"&&(v(w),w.preventDefault())}),onKeyDown:Zt(i.onKeyDown,w=>{const _=f.current!=="";!(w.ctrlKey||w.altKey||w.metaKey)&&w.key.length===1&&x(w.key),!(_&&w.key===" ")&&q0e.includes(w.key)&&(v(),w.preventDefault())})})})});B$.displayName=L$;var F$="SelectValue",$$=y.forwardRef((t,s)=>{const{__scopeSelect:n,className:a,style:i,children:l,placeholder:o="",...c}=t,d=yd(F$,n),{onValueNodeHasChildrenChange:u}=d,h=l!==void 0,f=Ts(s,d.onValueNodeChange);return zr(()=>{u(h)},[u,h]),r.jsx(rs.span,{...c,ref:f,style:{pointerEvents:"none"},children:lz(d.value)?r.jsx(r.Fragment,{children:o}):l})});$$.displayName=F$;var Z0e="SelectIcon",z$=y.forwardRef((t,s)=>{const{__scopeSelect:n,children:a,...i}=t;return r.jsx(rs.span,{"aria-hidden":!0,...i,ref:s,children:a||""})});z$.displayName=Z0e;var J0e="SelectPortal",U$=t=>r.jsx(Pk,{asChild:!0,...t});U$.displayName=J0e;var Au="SelectContent",V$=y.forwardRef((t,s)=>{const n=yd(Au,t.__scopeSelect),[a,i]=y.useState();if(zr(()=>{i(new DocumentFragment)},[]),!n.open){const l=a;return l?pd.createPortal(r.jsx(H$,{scope:t.__scopeSelect,children:r.jsx(Sv.Slot,{scope:t.__scopeSelect,children:r.jsx("div",{children:t.children})})}),l):null}return r.jsx(W$,{...t,ref:s})});V$.displayName=Au;var il=10,[H$,bd]=Gm(Au),ege="SelectContentImpl",tge=mm("SelectContent.RemoveScroll"),W$=y.forwardRef((t,s)=>{const{__scopeSelect:n,position:a="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:l,onPointerDownOutside:o,side:c,sideOffset:d,align:u,alignOffset:h,arrowPadding:f,collisionBoundary:x,collisionPadding:b,sticky:v,hideWhenDetached:w,avoidCollisions:_,...S}=t,k=yd(Au,n),[A,T]=y.useState(null),[P,O]=y.useState(null),D=Ts(s,de=>T(de)),[I,M]=y.useState(null),[B,L]=y.useState(null),F=Cv(n),[V,$]=y.useState(!1),z=y.useRef(!1);y.useEffect(()=>{if(A)return RF(A)},[A]),kF();const H=y.useCallback(de=>{const[Ce,...ue]=F().map(oe=>oe.ref.current),[fe]=ue.slice(-1),pe=document.activeElement;for(const oe of de)if(oe===pe||(oe==null||oe.scrollIntoView({block:"nearest"}),oe===Ce&&P&&(P.scrollTop=0),oe===fe&&P&&(P.scrollTop=P.scrollHeight),oe==null||oe.focus(),document.activeElement!==pe))return},[F,P]),q=y.useCallback(()=>H([I,A]),[H,I,A]);y.useEffect(()=>{V&&q()},[V,q]);const{onOpenChange:G,triggerPointerDownPosRef:re}=k;y.useEffect(()=>{if(A){let de={x:0,y:0};const Ce=fe=>{var pe,oe;de={x:Math.abs(Math.round(fe.pageX)-(((pe=re.current)==null?void 0:pe.x)??0)),y:Math.abs(Math.round(fe.pageY)-(((oe=re.current)==null?void 0:oe.y)??0))}},ue=fe=>{de.x<=10&&de.y<=10?fe.preventDefault():A.contains(fe.target)||G(!1),document.removeEventListener("pointermove",Ce),re.current=null};return re.current!==null&&(document.addEventListener("pointermove",Ce),document.addEventListener("pointerup",ue,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Ce),document.removeEventListener("pointerup",ue,{capture:!0})}}},[A,G,re]),y.useEffect(()=>{const de=()=>G(!1);return window.addEventListener("blur",de),window.addEventListener("resize",de),()=>{window.removeEventListener("blur",de),window.removeEventListener("resize",de)}},[G]);const[ye,Ee]=oz(de=>{const Ce=F().filter(pe=>!pe.disabled),ue=Ce.find(pe=>pe.ref.current===document.activeElement),fe=cz(Ce,de,ue);fe&&setTimeout(()=>fe.ref.current.focus())}),ee=y.useCallback((de,Ce,ue)=>{const fe=!z.current&&!ue;(k.value!==void 0&&k.value===Ce||fe)&&(M(de),fe&&(z.current=!0))},[k.value]),te=y.useCallback(()=>A==null?void 0:A.focus(),[A]),ce=y.useCallback((de,Ce,ue)=>{const fe=!z.current&&!ue;(k.value!==void 0&&k.value===Ce||fe)&&L(de)},[k.value]),ge=a==="popper"?mS:q$,X=ge===mS?{side:c,sideOffset:d,align:u,alignOffset:h,arrowPadding:f,collisionBoundary:x,collisionPadding:b,sticky:v,hideWhenDetached:w,avoidCollisions:_}:{};return r.jsx(H$,{scope:n,content:A,viewport:P,onViewportChange:O,itemRefCallback:ee,selectedItem:I,onItemLeave:te,itemTextRefCallback:ce,focusSelectedItem:q,selectedItemText:B,position:a,isPositioned:V,searchRef:ye,children:r.jsx(Ik,{as:tge,allowPinchZoom:!0,children:r.jsx(Tk,{asChild:!0,trapped:k.open,onMountAutoFocus:de=>{de.preventDefault()},onUnmountAutoFocus:Zt(i,de=>{var Ce;(Ce=k.trigger)==null||Ce.focus({preventScroll:!0}),de.preventDefault()}),children:r.jsx(Ek,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:l,onPointerDownOutside:o,onFocusOutside:de=>de.preventDefault(),onDismiss:()=>k.onOpenChange(!1),children:r.jsx(ge,{role:"listbox",id:k.contentId,"data-state":k.open?"open":"closed",dir:k.dir,onContextMenu:de=>de.preventDefault(),...S,...X,onPlaced:()=>$(!0),ref:D,style:{display:"flex",flexDirection:"column",outline:"none",...S.style},onKeyDown:Zt(S.onKeyDown,de=>{const Ce=de.ctrlKey||de.altKey||de.metaKey;if(de.key==="Tab"&&de.preventDefault(),!Ce&&de.key.length===1&&Ee(de.key),["ArrowUp","ArrowDown","Home","End"].includes(de.key)){let fe=F().filter(pe=>!pe.disabled).map(pe=>pe.ref.current);if(["ArrowUp","End"].includes(de.key)&&(fe=fe.slice().reverse()),["ArrowUp","ArrowDown"].includes(de.key)){const pe=de.target,oe=fe.indexOf(pe);fe=fe.slice(oe+1)}setTimeout(()=>H(fe)),de.preventDefault()}})})})})})})});W$.displayName=ege;var sge="SelectItemAlignedPosition",q$=y.forwardRef((t,s)=>{const{__scopeSelect:n,onPlaced:a,...i}=t,l=yd(Au,n),o=bd(Au,n),[c,d]=y.useState(null),[u,h]=y.useState(null),f=Ts(s,D=>h(D)),x=Cv(n),b=y.useRef(!1),v=y.useRef(!0),{viewport:w,selectedItem:_,selectedItemText:S,focusSelectedItem:k}=o,A=y.useCallback(()=>{if(l.trigger&&l.valueNode&&c&&u&&w&&_&&S){const D=l.trigger.getBoundingClientRect(),I=u.getBoundingClientRect(),M=l.valueNode.getBoundingClientRect(),B=S.getBoundingClientRect();if(l.dir!=="rtl"){const pe=B.left-I.left,oe=M.left-pe,qe=D.left-oe,Xe=D.width+qe,jt=Math.max(Xe,I.width),ft=window.innerWidth-il,it=iS(oe,[il,Math.max(il,ft-jt)]);c.style.minWidth=Xe+"px",c.style.left=it+"px"}else{const pe=I.right-B.right,oe=window.innerWidth-M.right-pe,qe=window.innerWidth-D.right-oe,Xe=D.width+qe,jt=Math.max(Xe,I.width),ft=window.innerWidth-il,it=iS(oe,[il,Math.max(il,ft-jt)]);c.style.minWidth=Xe+"px",c.style.right=it+"px"}const L=x(),F=window.innerHeight-il*2,V=w.scrollHeight,$=window.getComputedStyle(u),z=parseInt($.borderTopWidth,10),H=parseInt($.paddingTop,10),q=parseInt($.borderBottomWidth,10),G=parseInt($.paddingBottom,10),re=z+H+V+G+q,ye=Math.min(_.offsetHeight*5,re),Ee=window.getComputedStyle(w),ee=parseInt(Ee.paddingTop,10),te=parseInt(Ee.paddingBottom,10),ce=D.top+D.height/2-il,ge=F-ce,X=_.offsetHeight/2,de=_.offsetTop+X,Ce=z+H+de,ue=re-Ce;if(Ce<=ce){const pe=L.length>0&&_===L[L.length-1].ref.current;c.style.bottom="0px";const oe=u.clientHeight-w.offsetTop-w.offsetHeight,qe=Math.max(ge,X+(pe?te:0)+oe+q),Xe=Ce+qe;c.style.height=Xe+"px"}else{const pe=L.length>0&&_===L[0].ref.current;c.style.top="0px";const qe=Math.max(ce,z+w.offsetTop+(pe?ee:0)+X)+ue;c.style.height=qe+"px",w.scrollTop=Ce-ce+w.offsetTop}c.style.margin=`${il}px 0`,c.style.minHeight=ye+"px",c.style.maxHeight=F+"px",a==null||a(),requestAnimationFrame(()=>b.current=!0)}},[x,l.trigger,l.valueNode,c,u,w,_,S,l.dir,a]);zr(()=>A(),[A]);const[T,P]=y.useState();zr(()=>{u&&P(window.getComputedStyle(u).zIndex)},[u]);const O=y.useCallback(D=>{D&&v.current===!0&&(A(),k==null||k(),v.current=!1)},[A,k]);return r.jsx(rge,{scope:n,contentWrapper:c,shouldExpandOnScrollRef:b,onScrollButtonChange:O,children:r.jsx("div",{ref:d,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:T},children:r.jsx(rs.div,{...i,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});q$.displayName=sge;var nge="SelectPopperPosition",mS=y.forwardRef((t,s)=>{const{__scopeSelect:n,align:a="start",collisionPadding:i=il,...l}=t,o=kv(n);return r.jsx(z0e,{...o,...l,ref:s,align:a,collisionPadding:i,style:{boxSizing:"border-box",...l.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});mS.displayName=nge;var[rge,Kk]=Gm(Au,{}),fS="SelectViewport",G$=y.forwardRef((t,s)=>{const{__scopeSelect:n,nonce:a,...i}=t,l=bd(fS,n),o=Kk(fS,n),c=Ts(s,l.onViewportChange),d=y.useRef(0);return r.jsxs(r.Fragment,{children:[r.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),r.jsx(Sv.Slot,{scope:n,children:r.jsx(rs.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:c,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:Zt(i.onScroll,u=>{const h=u.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:x}=o;if(x!=null&&x.current&&f){const b=Math.abs(d.current-h.scrollTop);if(b>0){const v=window.innerHeight-il*2,w=parseFloat(f.style.minHeight),_=parseFloat(f.style.height),S=Math.max(w,_);if(S<v){const k=S+b,A=Math.min(v,k),T=k-A;f.style.height=A+"px",f.style.bottom==="0px"&&(h.scrollTop=T>0?T:0,f.style.justifyContent="flex-end")}}}d.current=h.scrollTop})})})]})});G$.displayName=fS;var K$="SelectGroup",[age,ige]=Gm(K$),lge=y.forwardRef((t,s)=>{const{__scopeSelect:n,...a}=t,i=Zc();return r.jsx(age,{scope:n,id:i,children:r.jsx(rs.div,{role:"group","aria-labelledby":i,...a,ref:s})})});lge.displayName=K$;var Y$="SelectLabel",X$=y.forwardRef((t,s)=>{const{__scopeSelect:n,...a}=t,i=ige(Y$,n);return r.jsx(rs.div,{id:i.id,...a,ref:s})});X$.displayName=Y$;var x1="SelectItem",[oge,Q$]=Gm(x1),Z$=y.forwardRef((t,s)=>{const{__scopeSelect:n,value:a,disabled:i=!1,textValue:l,...o}=t,c=yd(x1,n),d=bd(x1,n),u=c.value===a,[h,f]=y.useState(l??""),[x,b]=y.useState(!1),v=Ts(s,k=>{var A;return(A=d.itemRefCallback)==null?void 0:A.call(d,k,a,i)}),w=Zc(),_=y.useRef("touch"),S=()=>{i||(c.onValueChange(a),c.onOpenChange(!1))};if(a==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return r.jsx(oge,{scope:n,value:a,disabled:i,textId:w,isSelected:u,onItemTextChange:y.useCallback(k=>{f(A=>A||((k==null?void 0:k.textContent)??"").trim())},[]),children:r.jsx(Sv.ItemSlot,{scope:n,value:a,disabled:i,textValue:h,children:r.jsx(rs.div,{role:"option","aria-labelledby":w,"data-highlighted":x?"":void 0,"aria-selected":u&&x,"data-state":u?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...o,ref:v,onFocus:Zt(o.onFocus,()=>b(!0)),onBlur:Zt(o.onBlur,()=>b(!1)),onClick:Zt(o.onClick,()=>{_.current!=="mouse"&&S()}),onPointerUp:Zt(o.onPointerUp,()=>{_.current==="mouse"&&S()}),onPointerDown:Zt(o.onPointerDown,k=>{_.current=k.pointerType}),onPointerMove:Zt(o.onPointerMove,k=>{var A;_.current=k.pointerType,i?(A=d.onItemLeave)==null||A.call(d):_.current==="mouse"&&k.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Zt(o.onPointerLeave,k=>{var A;k.currentTarget===document.activeElement&&((A=d.onItemLeave)==null||A.call(d))}),onKeyDown:Zt(o.onKeyDown,k=>{var T;((T=d.searchRef)==null?void 0:T.current)!==""&&k.key===" "||(G0e.includes(k.key)&&S(),k.key===" "&&k.preventDefault())})})})})});Z$.displayName=x1;var Qf="SelectItemText",J$=y.forwardRef((t,s)=>{const{__scopeSelect:n,className:a,style:i,...l}=t,o=yd(Qf,n),c=bd(Qf,n),d=Q$(Qf,n),u=Q0e(Qf,n),[h,f]=y.useState(null),x=Ts(s,S=>f(S),d.onItemTextChange,S=>{var k;return(k=c.itemTextRefCallback)==null?void 0:k.call(c,S,d.value,d.disabled)}),b=h==null?void 0:h.textContent,v=y.useMemo(()=>r.jsx("option",{value:d.value,disabled:d.disabled,children:b},d.value),[d.disabled,d.value,b]),{onNativeOptionAdd:w,onNativeOptionRemove:_}=u;return zr(()=>(w(v),()=>_(v)),[w,_,v]),r.jsxs(r.Fragment,{children:[r.jsx(rs.span,{id:d.textId,...l,ref:x}),d.isSelected&&o.valueNode&&!o.valueNodeHasChildren?pd.createPortal(l.children,o.valueNode):null]})});J$.displayName=Qf;var ez="SelectItemIndicator",tz=y.forwardRef((t,s)=>{const{__scopeSelect:n,...a}=t;return Q$(ez,n).isSelected?r.jsx(rs.span,{"aria-hidden":!0,...a,ref:s}):null});tz.displayName=ez;var pS="SelectScrollUpButton",sz=y.forwardRef((t,s)=>{const n=bd(pS,t.__scopeSelect),a=Kk(pS,t.__scopeSelect),[i,l]=y.useState(!1),o=Ts(s,a.onScrollButtonChange);return zr(()=>{if(n.viewport&&n.isPositioned){let c=function(){const u=d.scrollTop>0;l(u)};const d=n.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),i?r.jsx(rz,{...t,ref:o,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=n;c&&d&&(c.scrollTop=c.scrollTop-d.offsetHeight)}}):null});sz.displayName=pS;var xS="SelectScrollDownButton",nz=y.forwardRef((t,s)=>{const n=bd(xS,t.__scopeSelect),a=Kk(xS,t.__scopeSelect),[i,l]=y.useState(!1),o=Ts(s,a.onScrollButtonChange);return zr(()=>{if(n.viewport&&n.isPositioned){let c=function(){const u=d.scrollHeight-d.clientHeight,h=Math.ceil(d.scrollTop)<u;l(h)};const d=n.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),i?r.jsx(rz,{...t,ref:o,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=n;c&&d&&(c.scrollTop=c.scrollTop+d.offsetHeight)}}):null});nz.displayName=xS;var rz=y.forwardRef((t,s)=>{const{__scopeSelect:n,onAutoScroll:a,...i}=t,l=bd("SelectScrollButton",n),o=y.useRef(null),c=Cv(n),d=y.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return y.useEffect(()=>()=>d(),[d]),zr(()=>{var h;const u=c().find(f=>f.ref.current===document.activeElement);(h=u==null?void 0:u.ref.current)==null||h.scrollIntoView({block:"nearest"})},[c]),r.jsx(rs.div,{"aria-hidden":!0,...i,ref:s,style:{flexShrink:0,...i.style},onPointerDown:Zt(i.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(a,50))}),onPointerMove:Zt(i.onPointerMove,()=>{var u;(u=l.onItemLeave)==null||u.call(l),o.current===null&&(o.current=window.setInterval(a,50))}),onPointerLeave:Zt(i.onPointerLeave,()=>{d()})})}),cge="SelectSeparator",az=y.forwardRef((t,s)=>{const{__scopeSelect:n,...a}=t;return r.jsx(rs.div,{"aria-hidden":!0,...a,ref:s})});az.displayName=cge;var gS="SelectArrow",dge=y.forwardRef((t,s)=>{const{__scopeSelect:n,...a}=t,i=kv(n),l=yd(gS,n),o=bd(gS,n);return l.open&&o.position==="popper"?r.jsx(U0e,{...i,...a,ref:s}):null});dge.displayName=gS;var uge="SelectBubbleInput",iz=y.forwardRef(({__scopeSelect:t,value:s,...n},a)=>{const i=y.useRef(null),l=Ts(a,i),o=V0e(s);return y.useEffect(()=>{const c=i.current;if(!c)return;const d=window.HTMLSelectElement.prototype,h=Object.getOwnPropertyDescriptor(d,"value").set;if(o!==s&&h){const f=new Event("change",{bubbles:!0});h.call(c,s),c.dispatchEvent(f)}},[o,s]),r.jsx(rs.select,{...n,style:{...O$,...n.style},ref:l,defaultValue:s})});iz.displayName=uge;function lz(t){return t===""||t===void 0}function oz(t){const s=da(t),n=y.useRef(""),a=y.useRef(0),i=y.useCallback(o=>{const c=n.current+o;s(c),function d(u){n.current=u,window.clearTimeout(a.current),u!==""&&(a.current=window.setTimeout(()=>d(""),1e3))}(c)},[s]),l=y.useCallback(()=>{n.current="",window.clearTimeout(a.current)},[]);return y.useEffect(()=>()=>window.clearTimeout(a.current),[]),[n,i,l]}function cz(t,s,n){const i=s.length>1&&Array.from(s).every(u=>u===s[0])?s[0]:s,l=n?t.indexOf(n):-1;let o=hge(t,Math.max(l,0));i.length===1&&(o=o.filter(u=>u!==n));const d=o.find(u=>u.textValue.toLowerCase().startsWith(i.toLowerCase()));return d!==n?d:void 0}function hge(t,s){return t.map((n,a)=>t[(s+a)%t.length])}var mge=R$,dz=B$,fge=$$,pge=z$,xge=U$,uz=V$,gge=G$,hz=X$,mz=Z$,yge=J$,bge=tz,fz=sz,pz=nz,xz=az;const Fs=mge,$s=fge,Ds=y.forwardRef(({className:t,children:s,...n},a)=>r.jsxs(dz,{ref:a,className:Ft("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[s,r.jsx(pge,{asChild:!0,children:r.jsx($x,{className:"h-4 w-4 opacity-50"})})]}));Ds.displayName=dz.displayName;const gz=y.forwardRef(({className:t,...s},n)=>r.jsx(fz,{ref:n,className:Ft("flex cursor-default items-center justify-center py-1",t),...s,children:r.jsx(ise,{className:"h-4 w-4"})}));gz.displayName=fz.displayName;const yz=y.forwardRef(({className:t,...s},n)=>r.jsx(pz,{ref:n,className:Ft("flex cursor-default items-center justify-center py-1",t),...s,children:r.jsx($x,{className:"h-4 w-4"})}));yz.displayName=pz.displayName;const Os=y.forwardRef(({className:t,children:s,position:n="popper",...a},i)=>r.jsx(xge,{children:r.jsxs(uz,{ref:i,className:Ft("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...a,children:[r.jsx(gz,{}),r.jsx(gge,{className:Ft("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),r.jsx(yz,{})]})}));Os.displayName=uz.displayName;const vge=y.forwardRef(({className:t,...s},n)=>r.jsx(hz,{ref:n,className:Ft("px-2 py-1.5 text-sm font-semibold",t),...s}));vge.displayName=hz.displayName;const zt=y.forwardRef(({className:t,children:s,...n},a)=>r.jsxs(mz,{ref:a,className:Ft("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[r.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:r.jsx(bge,{children:r.jsx(B3,{className:"h-4 w-4"})})}),r.jsx(yge,{children:s})]}));zt.displayName=mz.displayName;const Nge=y.forwardRef(({className:t,...s},n)=>r.jsx(xz,{ref:n,className:Ft("-mx-1 my-1 h-px bg-muted",t),...s}));Nge.displayName=xz.displayName;const lg=t=>t?t.length===16?`${t}:00`:t:null;function wge({admissionId:t,canWrite:s}){const[n,a]=y.useState("pain"),[i,l]=y.useState(!1),[o,c]=y.useState(""),[d,u]=y.useState([]),[h,f]=y.useState([]),[x,b]=y.useState([]),[v,w]=y.useState([]),[_,S]=y.useState({recorded_at:"",scale_type:"",score:"",location:"",character:"",intervention:"",post_intervention_score:""}),[k,A]=y.useState({recorded_at:"",tool:"",score:"",risk_level:"",precautions:""}),[T,P]=y.useState({recorded_at:"",tool:"",score:"",risk_level:"",existing_ulcer:!1,site:"",stage:"",management_plan:""}),[O,D]=y.useState({recorded_at:"",bmi:"",weight_kg:"",height_cm:"",screening_tool:"",score:"",risk_level:"",dietician_referral:!1}),I=async()=>{var $,z;if(t){l(!0),c("");try{const[H,q,G,re]=await Promise.all([Wde(t),Gde(t),Yde(t),Qde(t)]);u(H.data||[]),f(q.data||[]),b(G.data||[]),w(re.data||[])}catch(H){c(((z=($=H==null?void 0:H.response)==null?void 0:$.data)==null?void 0:z.detail)||"Failed to load assessments")}finally{l(!1)}}};y.useEffect(()=>{I()},[t]);const M=async $=>{var z,H;if($.preventDefault(),!(!s||!t))try{const q={recorded_at:lg(_.recorded_at),scale_type:_.scale_type||"",score:_.score!==""?Number(_.score):null,location:_.location||"",character:_.character||"",intervention:_.intervention||"",post_intervention_score:_.post_intervention_score!==""?Number(_.post_intervention_score):null};await qde(t,q),S({recorded_at:"",scale_type:"",score:"",location:"",character:"",intervention:"",post_intervention_score:""}),await I()}catch(q){alert(((H=(z=q==null?void 0:q.response)==null?void 0:z.data)==null?void 0:H.detail)||"Failed to add pain assessment")}},B=async $=>{var z,H;if($.preventDefault(),!(!s||!t))try{const q={recorded_at:lg(k.recorded_at),tool:k.tool||"",score:k.score!==""?Number(k.score):null,risk_level:k.risk_level||"",precautions:k.precautions||""};await Kde(t,q),A({recorded_at:"",tool:"",score:"",risk_level:"",precautions:""}),await I()}catch(q){alert(((H=(z=q==null?void 0:q.response)==null?void 0:z.data)==null?void 0:H.detail)||"Failed to add fall risk assessment")}},L=async $=>{var z,H;if($.preventDefault(),!(!s||!t))try{const q={recorded_at:lg(T.recorded_at),tool:T.tool||"",score:T.score!==""?Number(T.score):null,risk_level:T.risk_level||"",existing_ulcer:!!T.existing_ulcer,site:T.site||"",stage:T.stage||"",management_plan:T.management_plan||""};await Xde(t,q),P({recorded_at:"",tool:"",score:"",risk_level:"",existing_ulcer:!1,site:"",stage:"",management_plan:""}),await I()}catch(q){alert(((H=(z=q==null?void 0:q.response)==null?void 0:z.data)==null?void 0:H.detail)||"Failed to add pressure-ulcer assessment")}},F=async $=>{var z,H;if($.preventDefault(),!(!s||!t))try{const q={recorded_at:lg(O.recorded_at),bmi:O.bmi!==""?Number(O.bmi):null,weight_kg:O.weight_kg!==""?Number(O.weight_kg):null,height_cm:O.height_cm!==""?Number(O.height_cm):null,screening_tool:O.screening_tool||"",score:O.score!==""?Number(O.score):null,risk_level:O.risk_level||"",dietician_referral:!!O.dietician_referral};await Zde(t,q),D({recorded_at:"",bmi:"",weight_kg:"",height_cm:"",screening_tool:"",score:"",risk_level:"",dietician_referral:!1}),await I()}catch(q){alert(((H=(z=q==null?void 0:q.response)==null?void 0:z.data)==null?void 0:H.detail)||"Failed to add nutrition assessment")}},V=[{key:"pain",label:"Pain"},{key:"fall",label:"Fall Risk"},{key:"pressure",label:"Pressure Ulcer"},{key:"nutrition",label:"Nutrition"}];return r.jsxs("div",{className:"space-y-4 text-sm text-black",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsx("h2",{className:"font-semibold",children:"Risk & Clinical Assessments"})}),o&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:o}),r.jsx("div",{className:"flex flex-wrap gap-2",children:V.map($=>r.jsx("button",{type:"button",onClick:()=>a($.key),className:["rounded-full px-3 py-1 text-xs md:text-sm border",n===$.key?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-200 hover:bg-slate-50"].join(" "),children:$.label},$.key))}),i&&r.jsx("div",{className:"text-xs text-gray-500",children:"Loading assessments"}),n==="pain"&&r.jsxs("section",{className:"space-y-3",children:[s&&r.jsxs("form",{onSubmit:M,className:"rounded-xl border bg-gray-50 p-3 space-y-3",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Recorded at"}),r.jsx("input",{type:"datetime-local",className:"input",value:_.recorded_at,onChange:$=>S(z=>({...z,recorded_at:$.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Scale"}),r.jsx("input",{className:"input",placeholder:"NRS / VAS / Wong-Baker",value:_.scale_type,onChange:$=>S(z=>({...z,scale_type:$.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Score"}),r.jsx("input",{className:"input",type:"number",min:"0",max:"10",value:_.score,onChange:$=>S(z=>({...z,score:$.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Location"}),r.jsx("input",{className:"input",placeholder:"Site",value:_.location,onChange:$=>S(z=>({...z,location:$.target.value}))})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Character"}),r.jsx("input",{className:"input",placeholder:"sharp / dull / throbbing",value:_.character,onChange:$=>S(z=>({...z,character:$.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Post-intervention score"}),r.jsx("input",{className:"input",type:"number",min:"0",max:"10",value:_.post_intervention_score,onChange:$=>S(z=>({...z,post_intervention_score:$.target.value}))})]})]}),r.jsx("textarea",{className:"input min-h-[70px]",placeholder:"Interventions / remarks",value:_.intervention,onChange:$=>S(z=>({...z,intervention:$.target.value}))}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{className:"btn",children:"Save pain assessment"})})]}),r.jsx("div",{className:"rounded-xl border bg-white overflow-hidden",children:r.jsxs("table",{className:"w-full text-xs md:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 text-gray-500 text-[11px] md:text-xs",children:[r.jsx("th",{className:"px-2 md:px-3 py-2",children:"When"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Scale"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Score"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Location / Character"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Intervention"})]})}),r.jsxs("tbody",{children:[d.map($=>r.jsxs("tr",{className:"border-t align-top",children:[r.jsx("td",{className:"px-2 md:px-3 py-2",children:$.recorded_at?new Date($.recorded_at).toLocaleString():""}),r.jsx("td",{className:"px-2 md:px-3 py-2",children:$.scale_type||""}),r.jsx("td",{className:"px-2 md:px-3 py-2",children:$.score??""}),r.jsxs("td",{className:"px-2 md:px-3 py-2 whitespace-pre-wrap",children:[$.location||"",$.character?` (${$.character})`:""]}),r.jsx("td",{className:"px-2 md:px-3 py-2 whitespace-pre-wrap",children:$.intervention||""})]},$.id)),!d.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-3 py-3 text-gray-500 text-xs",children:"No pain assessments recorded."})})]})]})})]}),n==="fall"&&r.jsxs("section",{className:"space-y-3",children:[s&&r.jsxs("form",{onSubmit:B,className:"rounded-xl border bg-gray-50 p-3 space-y-3",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Recorded at"}),r.jsx("input",{type:"datetime-local",className:"input",value:k.recorded_at,onChange:$=>A(z=>({...z,recorded_at:$.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Tool"}),r.jsx("input",{className:"input",placeholder:"Morse, etc.",value:k.tool,onChange:$=>A(z=>({...z,tool:$.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Score"}),r.jsx("input",{className:"input",type:"number",value:k.score,onChange:$=>A(z=>({...z,score:$.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Risk level"}),r.jsx("input",{className:"input",placeholder:"low / moderate / high",value:k.risk_level,onChange:$=>A(z=>({...z,risk_level:$.target.value}))})]})]}),r.jsx("textarea",{className:"input min-h-[70px]",placeholder:"Precautions / instructions",value:k.precautions,onChange:$=>A(z=>({...z,precautions:$.target.value}))}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{className:"btn",children:"Save fall risk assessment"})})]}),r.jsx("div",{className:"rounded-xl border bg-white overflow-hidden",children:r.jsxs("table",{className:"w-full text-xs md:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 text-gray-500 text-[11px] md:text-xs",children:[r.jsx("th",{className:"px-2 md:px-3 py-2",children:"When"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Tool"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Score"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Risk"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Precautions"})]})}),r.jsxs("tbody",{children:[h.map($=>r.jsxs("tr",{className:"border-t align-top",children:[r.jsx("td",{className:"px-2 md:px-3 py-2",children:$.recorded_at?new Date($.recorded_at).toLocaleString():""}),r.jsx("td",{className:"px-2 md:px-3 py-2",children:$.tool||""}),r.jsx("td",{className:"px-2 md:px-3 py-2",children:$.score??""}),r.jsx("td",{className:"px-2 md:px-3 py-2",children:$.risk_level||""}),r.jsx("td",{className:"px-2 md:px-3 py-2 whitespace-pre-wrap",children:$.precautions||""})]},$.id)),!h.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-3 py-3 text-gray-500 text-xs",children:"No fall risk assessments recorded."})})]})]})})]}),n==="pressure"&&r.jsxs("section",{className:"space-y-3",children:[s&&r.jsxs("form",{onSubmit:L,className:"rounded-xl border bg-gray-50 p-3 space-y-3",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Recorded at"}),r.jsx("input",{type:"datetime-local",className:"input",value:T.recorded_at,onChange:$=>P(z=>({...z,recorded_at:$.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Tool"}),r.jsx("input",{className:"input",placeholder:"Braden, etc.",value:T.tool,onChange:$=>P(z=>({...z,tool:$.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Score"}),r.jsx("input",{className:"input",type:"number",value:T.score,onChange:$=>P(z=>({...z,score:$.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Risk level"}),r.jsx("input",{className:"input",placeholder:"low / moderate / high",value:T.risk_level,onChange:$=>P(z=>({...z,risk_level:$.target.value}))})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-700",children:[r.jsx("input",{type:"checkbox",className:"h-3 w-3",checked:!!T.existing_ulcer,onChange:$=>P(z=>({...z,existing_ulcer:$.target.checked}))}),"Existing ulcer"]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Site"}),r.jsx("input",{className:"input",value:T.site,onChange:$=>P(z=>({...z,site:$.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Stage"}),r.jsx("input",{className:"input",placeholder:"Stage IIV",value:T.stage,onChange:$=>P(z=>({...z,stage:$.target.value}))})]})]}),r.jsx("textarea",{className:"input min-h-[70px]",placeholder:"Management plan",value:T.management_plan,onChange:$=>P(z=>({...z,management_plan:$.target.value}))}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{className:"btn",children:"Save pressure-ulcer assessment"})})]}),r.jsx("div",{className:"rounded-xl border bg-white overflow-hidden",children:r.jsxs("table",{className:"w-full text-xs md:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 text-gray-500 text-[11px] md:text-xs",children:[r.jsx("th",{className:"px-2 md:px-3 py-2",children:"When"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Tool"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Score"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Risk / Site / Stage"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Management plan"})]})}),r.jsxs("tbody",{children:[x.map($=>r.jsxs("tr",{className:"border-t align-top",children:[r.jsx("td",{className:"px-2 md:px-3 py-2",children:$.recorded_at?new Date($.recorded_at).toLocaleString():""}),r.jsx("td",{className:"px-2 md:px-3 py-2",children:$.tool||""}),r.jsx("td",{className:"px-2 md:px-3 py-2",children:$.score??""}),r.jsxs("td",{className:"px-2 md:px-3 py-2 whitespace-pre-wrap",children:[$.risk_level||"",$.site?`  ${$.site}`:"",$.stage?` (Stage ${$.stage})`:"",$.existing_ulcer?"  Existing":""]}),r.jsx("td",{className:"px-2 md:px-3 py-2 whitespace-pre-wrap",children:$.management_plan||""})]},$.id)),!x.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-3 py-3 text-gray-500 text-xs",children:"No pressure-ulcer assessments recorded."})})]})]})})]}),n==="nutrition"&&r.jsxs("section",{className:"space-y-3",children:[s&&r.jsxs("form",{onSubmit:F,className:"rounded-xl border bg-gray-50 p-3 space-y-3",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Recorded at"}),r.jsx("input",{type:"datetime-local",className:"input",value:O.recorded_at,onChange:$=>D(z=>({...z,recorded_at:$.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"BMI"}),r.jsx("input",{className:"input",type:"number",step:"0.1",value:O.bmi,onChange:$=>D(z=>({...z,bmi:$.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Weight (kg)"}),r.jsx("input",{className:"input",type:"number",step:"0.1",value:O.weight_kg,onChange:$=>D(z=>({...z,weight_kg:$.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Height (cm)"}),r.jsx("input",{className:"input",type:"number",step:"0.1",value:O.height_cm,onChange:$=>D(z=>({...z,height_cm:$.target.value}))})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Screening tool"}),r.jsx("input",{className:"input",placeholder:"MUST, etc.",value:O.screening_tool,onChange:$=>D(z=>({...z,screening_tool:$.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Score"}),r.jsx("input",{className:"input",type:"number",value:O.score,onChange:$=>D(z=>({...z,score:$.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Risk level"}),r.jsx("input",{className:"input",placeholder:"low / moderate / high",value:O.risk_level,onChange:$=>D(z=>({...z,risk_level:$.target.value}))})]})]}),r.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-700",children:[r.jsx("input",{type:"checkbox",className:"h-3 w-3",checked:!!O.dietician_referral,onChange:$=>D(z=>({...z,dietician_referral:$.target.checked}))}),"Dietician referral required"]}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{className:"btn",children:"Save nutrition assessment"})})]}),r.jsx("div",{className:"rounded-xl border bg-white overflow-hidden",children:r.jsxs("table",{className:"w-full text-xs md:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 text-gray-500 text-[11px] md:text-xs",children:[r.jsx("th",{className:"px-2 md:px-3 py-2",children:"When"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"BMI"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Wt / Ht"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Tool / Score / Risk"}),r.jsx("th",{className:"px-2 md:px-3 py-2",children:"Dietician referral"})]})}),r.jsxs("tbody",{children:[v.map($=>r.jsxs("tr",{className:"border-t align-top",children:[r.jsx("td",{className:"px-2 md:px-3 py-2",children:$.recorded_at?new Date($.recorded_at).toLocaleString():""}),r.jsx("td",{className:"px-2 md:px-3 py-2",children:$.bmi!=null?String($.bmi):""}),r.jsxs("td",{className:"px-2 md:px-3 py-2",children:[$.weight_kg!=null?`${$.weight_kg} kg`:"",$.height_cm!=null?` / ${$.height_cm} cm`:""]}),r.jsxs("td",{className:"px-2 md:px-3 py-2 whitespace-pre-wrap",children:[$.screening_tool||"",$.score!=null?`  Score ${$.score}`:"",$.risk_level?`  ${$.risk_level}`:""]}),r.jsx("td",{className:"px-2 md:px-3 py-2",children:$.dietician_referral?"Yes":"No"})]},$.id)),!v.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-3 py-3 text-gray-500 text-xs",children:"No nutrition assessments recorded."})})]})]})})]})]})}const jge=["po","iv","im","sc","topical","nebulisation"],_ge=["od","bd","tds","qid","stat","prn"],Sge=["mg","g","ml","units","drops","puffs","tab","cap","sachet"],FI=[{value:"regular",label:"Regular"},{value:"sos",label:"SOS"},{value:"stat_premed",label:"STAT / Premed"}];function Cge({admissionId:t,canWrite:s=!0}){const[n,a]=y.useState(!1),[i,l]=y.useState(!1),[o,c]=y.useState({allergies:"",diagnosis:"",weight_kg:"",height_cm:"",blood_group:"",bsa:"",bmi:"",diet_oral_fluid_per_day:"",diet_salt_gm_per_day:"",diet_calorie_per_day:"",diet_protein_gm_per_day:"",diet_remarks:""}),[d,u]=y.useState([]),[h,f]=y.useState({date:"",fluid:"",additive:"",dose:"",rate_ml_per_hr:"",start_time:"",stop_time:"",remarks:""}),[x,b]=y.useState(!1),[v,w]=y.useState([]),[_,S]=y.useState({name:"",specimen:"",emp_no:""}),[k,A]=y.useState(!1),[T,P]=y.useState([]),[O,D]=y.useState({date:"",remarks:""}),[I,M]=y.useState(!1),[B,L]=y.useState([]),[F,V]=y.useState(""),[$,z]=y.useState(!1),[H,q]=y.useState(!1),[G,re]=y.useState(!0),[ye,Ee]=y.useState("all"),[ee,te]=y.useState({drug_name:"",order_type:"regular",route:"iv",frequency:"bd",dose_value:"",dose_unit:"mg",start_date:"",end_date:"",duration_days:"",instructions:""});y.useMemo(()=>Array.isArray(B)&&B.length>0,[B]);const ce=y.useMemo(()=>{let he=B;return G&&(he=he.filter(Me=>(Me.order_status||"active")!=="stopped")),ye!=="all"&&(he=he.filter(Me=>(Me.order_type||"regular")===ye)),he},[B,G,ye]),ge=he=>{if(!he)return"";const Me=new Date(he);return Number.isNaN(Me.getTime())?"":Me.toLocaleDateString()},X=he=>he.dose==null&&!he.dose_unit?"":he.dose==null?he.dose_unit||"":`${he.dose} ${he.dose_unit||""}`.trim(),de=he=>{const Me=he||"active";return Me==="stopped"?"inline-flex rounded-full bg-slate-100 px-2 py-0.5 text-[11px] text-slate-600":Me==="completed"?"inline-flex rounded-full bg-blue-50 px-2 py-0.5 text-[11px] text-blue-700":"inline-flex rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] text-emerald-700"};y.useEffect(()=>{const he=Number(o.weight_kg),Me=Number(o.height_cm);if(!he||!Me||Number.isNaN(he)||Number.isNaN(Me)){c(Ot=>({...Ot,bmi:""}));return}const Ge=Me/100;if(!Ge){c(Ot=>({...Ot,bmi:""}));return}const Be=he/(Ge*Ge);c(Ot=>({...Ot,bmi:Be.toFixed(1)}))},[o.weight_kg,o.height_cm]);const Ce=async()=>{if(t)try{const{data:he}=await sue(t);he&&c({allergies:he.allergies||"",diagnosis:he.diagnosis||"",weight_kg:he.weight_kg??"",height_cm:he.height_cm??"",blood_group:he.blood_group||"",bsa:he.bsa??"",bmi:he.bmi??"",diet_oral_fluid_per_day:he.diet_oral_fluid_per_day??"",diet_salt_gm_per_day:he.diet_salt_gm_per_day??"",diet_calorie_per_day:he.diet_calorie_per_day??"",diet_protein_gm_per_day:he.diet_protein_gm_per_day??"",diet_remarks:he.diet_remarks||""})}catch(he){const Me=Xa(he,"Failed to load medications");se.error(Me)}},ue=async()=>{if(t)try{const{data:he}=await rue(t);u(Array.isArray(he)?he:[])}catch(he){const Me=Xa(he,"Failed to load medications");se.error(Me)}},fe=async()=>{if(t)try{const{data:he}=await lue(t);w(Array.isArray(he)?he:[])}catch{}},pe=async()=>{if(t)try{const{data:he}=await due(t);P(Array.isArray(he)?he:[])}catch(he){const Me=Xa(he,"Failed to load medications");se.error(Me)}},oe=async()=>{if(t){z(!0),V("");try{const{data:he}=await Jde(t);L(Array.isArray(he)?he:[])}catch(he){const Me=Xa(he,"Failed to load medications");V(Me),se.error(Me)}finally{z(!1)}}},qe=async()=>{t&&(a(!0),await Promise.all([Ce(),ue(),fe(),pe(),oe()]),a(!1))};y.useEffect(()=>{qe()},[t]);const Xe=he=>Me=>{const Ge=Me.target.value;c(Be=>({...Be,[he]:Ge}))},jt=async()=>{if(t)try{const he={allergies:o.allergies||"",diagnosis:o.diagnosis||"",weight_kg:o.weight_kg!==""&&!Number.isNaN(Number(o.weight_kg))?Number(o.weight_kg):ft(o.weight_kg),height_cm:o.height_cm!==""&&!Number.isNaN(Number(o.height_cm))?Number(o.height_cm):ft(o.height_cm),blood_group:o.blood_group||"",bsa:o.bsa!==""&&!Number.isNaN(Number(o.bsa))?Number(o.bsa):ft(o.bsa),bmi:o.bmi!==""&&!Number.isNaN(Number(o.bmi))?Number(o.bmi):ft(o.bmi),diet_oral_fluid_per_day:o.diet_oral_fluid_per_day!==""&&!Number.isNaN(Number(o.diet_oral_fluid_per_day))?Number(o.diet_oral_fluid_per_day):ft(o.diet_oral_fluid_per_day),diet_salt_gm_per_day:o.diet_salt_gm_per_day!==""&&!Number.isNaN(Number(o.diet_salt_gm_per_day))?Number(o.diet_salt_gm_per_day):ft(o.diet_salt_gm_per_day),diet_calorie_per_day:o.diet_calorie_per_day!==""&&!Number.isNaN(Number(o.diet_calorie_per_day))?Number(o.diet_calorie_per_day):ft(o.diet_calorie_per_day),diet_protein_gm_per_day:o.diet_protein_gm_per_day!==""&&!Number.isNaN(Number(o.diet_protein_gm_per_day))?Number(o.diet_protein_gm_per_day):ft(o.diet_protein_gm_per_day),diet_remarks:o.diet_remarks||""};await nue(t,he),se.success("Drug chart header details updated")}catch(he){const Me=Xa(he,"Failed to load medications");se.error(Me)}},ft=he=>he===""||he==null?null:he,it=he=>Me=>{const Ge=Me.target.value;f(Be=>({...Be,[he]:Ge}))},_t=async he=>{if(he.preventDefault(),!(!s||!t)){if(!h.fluid.trim()){se.error("Please enter IV fluid");return}try{b(!0);const Me={date:h.date||null,fluid:h.fluid.trim(),additive:h.additive||"",dose:h.dose||"",rate_ml_per_hr:h.rate_ml_per_hr&&!Number.isNaN(Number(h.rate_ml_per_hr))?Number(h.rate_ml_per_hr):null,start_time:h.start_time||null,stop_time:h.stop_time||null,remarks:h.remarks||""};await aue(t,Me),f({date:"",fluid:"",additive:"",dose:"",rate_ml_per_hr:"",start_time:"",stop_time:"",remarks:""}),await ue(),se.success("IV fluid order added")}catch(Me){const Ge=Xa(Me,"Failed to load medications");se.error(Ge)}finally{b(!1)}}},ve=async he=>{if(!(!s||!window.confirm(`Remove IV fluid "${he.fluid}"?`)))try{await iue(he.id),await ue(),se.success("IV fluid deleted")}catch(Ge){const Be=Xa(Ge,"Failed to load medications");se.error(Be)}},ae=he=>Me=>{const Ge=Me.target.value;S(Be=>({...Be,[he]:Ge}))},xe=async he=>{if(he.preventDefault(),!(!s||!t)){if(!_.name.trim()){se.error("Please enter nurse name");return}try{A(!0);const Me={name:_.name.trim(),specimen:_.specimen||"",emp_no:_.emp_no||""};await oue(t,Me),S({name:"",specimen:"",emp_no:""}),await fe(),se.success("Nurse row added")}catch(Me){const Ge=Xa(Me,"Failed to load medications");se.error(Ge)}finally{A(!1)}}},je=async he=>{if(!(!s||!window.confirm(`Remove nurse "${he.name}"?`)))try{await cue(he.id),await fe(),se.success("Nurse row deleted")}catch(Ge){const Be=Xa(Ge,"Failed to load medications");se.error(Be)}},Fe=he=>Me=>{const Ge=Me.target.value;D(Be=>({...Be,[he]:Ge}))},Ct=async he=>{if(he.preventDefault(),!(!s||!t)){if(!O.date){se.error("Please select date");return}try{M(!0);const Me={date:O.date,remarks:O.remarks||""};await uue(t,Me),D({date:"",remarks:""}),await pe(),se.success("Doctor's daily authorization added")}catch(Me){const Ge=Xa(Me,"Failed to load medications");se.error(Ge)}finally{M(!1)}}},vt=async he=>{if(!(!s||!window.confirm(`Remove authorization entry for ${ge(he.date)}?`)))try{await hue(he.id),await pe(),se.success("Authorization entry deleted")}catch(Ge){const Be=Xa(Ge,"Failed to load medications");se.error(Be)}},pt=he=>Me=>{const Ge=Me.target.value;te(Be=>({...Be,[he]:Ge}))},Ns=()=>te({drug_name:"",order_type:"regular",route:"iv",frequency:"bd",dose_value:"",dose_unit:"mg",start_date:"",end_date:"",duration_days:"",instructions:""}),ds=async he=>{if(he.preventDefault(),!s||!t)return;const Me=ee.drug_name.trim();if(!Me){se.error("Please enter a drug name");return}const Ge=ee.dose_value&&String(ee.dose_value).trim()!==""?String(ee.dose_value).trim():"",Be=ee.dose_value.trim()?Number(ee.dose_value):null;if(ee.dose_value&&Number.isNaN(Be)){se.error("Dose must be a number (e.g. 500)");return}const Ot=ee.duration_days.trim()?Number(ee.duration_days):null;if(ee.duration_days&&(Number.isNaN(Ot)||!Number.isInteger(Ot))){se.error("Duration must be whole days (e.g. 5)");return}const Rt=ee.start_date?`${ee.start_date}T00:00:00`:null,Jt=ee.end_date?`${ee.end_date}T00:00:00`:null,ys={drug_id:null,drug_name:Me,order_type:ee.order_type||"regular",route:ee.route||"iv",frequency:ee.frequency||"bd",dose:Ge,dose_unit:ee.dose_unit||"",duration_days:Ot,start_datetime:Rt,stop_datetime:Jt,special_instructions:ee.instructions||"",order_status:"active"};try{q(!0),await eue(t,ys),se.success("Medication order added"),Ns(),await oe()}catch(Qs){const na=Xa(Qs,"Failed to add medication");se.error(na)}finally{q(!1)}},ie=async he=>{if(!(!s||(he.order_status||"active")==="stopped"||!window.confirm(`Stop "${he.drug_name}" for this admission?`)))try{const Ge=new Date().toISOString();await tue(he.id,{order_status:"stopped",stop_datetime:he.stop_datetime||Ge}),se.success("Medication stopped"),await oe()}catch(Ge){const Be=Xa(Ge,"Failed to load medications");se.error(Be)}},Ie=async()=>{var he,Me;if(t)try{l(!0);const Ge=await mue(t),Be=new Blob([Ge.data],{type:"application/pdf"}),Ot=window.URL.createObjectURL(Be),Rt=document.createElement("a");Rt.href=Ot,Rt.download=`drug-chart-${t}.pdf`,document.body.appendChild(Rt),Rt.click(),Rt.remove(),window.URL.revokeObjectURL(Ot)}catch(Ge){const Be=((Me=(he=Ge==null?void 0:Ge.response)==null?void 0:he.data)==null?void 0:Me.detail)||"Failed to download drug chart PDF";se.error(Be)}finally{l(!1)}};return r.jsxs("div",{className:"space-y-4 text-sm text-slate-900",children:[r.jsxs("div",{className:"flex flex-col gap-2 rounded-2xl border bg-gradient-to-r from-sky-50 via-indigo-50 to-emerald-50 p-3 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wide text-sky-900",children:"IPD Drug Chart  NABH Format"}),r.jsxs("p",{className:"text-[11px] text-slate-700 leading-snug",children:["This page captures the complete ",r.jsx("strong",{children:"inpatient medication and drug chart"})," ","as per NABH style: patient details, allergies, diagnosis, IV fluids, main drug grid with hours/sign, SOS & STAT orders, nurse signatures and daily doctor authorisation. All entries can be used for the ",r.jsx("strong",{children:"official Drug Chart PDF"}),"."]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx("button",{type:"button",onClick:qe,className:"rounded-full border border-slate-300 bg-white px-3 py-1 text-[11px] text-slate-700 shadow-sm hover:bg-slate-50",disabled:n,children:n?"Refreshing":"Refresh"}),r.jsx("button",{type:"button",onClick:Ie,className:"rounded-full border border-slate-300 bg-white px-3 py-1 text-[11px] font-semibold text-slate-800 shadow-sm hover:bg-slate-50",disabled:i,children:i?"Preparing PDF":"Download Drug Chart PDF"})]})]}),r.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-3 shadow-sm",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsx("h3",{className:"text-xs font-semibold text-slate-800",children:"Patient details & clinical header"})}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Allergic to"}),r.jsx("input",{className:"input h-9 text-sm",placeholder:"e.g. Penicillin, NSAIDs",value:o.allergies,onChange:Xe("allergies"),disabled:!s})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Diagnosis"}),r.jsx("textarea",{className:"input min-h-[48px] text-sm",placeholder:"Primary / secondary diagnosis",value:o.diagnosis,onChange:Xe("diagnosis"),disabled:!s})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Weight (kg)"}),r.jsx("input",{type:"text",inputMode:"decimal",className:"input h-9 text-sm",value:o.weight_kg,onChange:Xe("weight_kg"),disabled:!s})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Height (cm)"}),r.jsx("input",{type:"text",inputMode:"decimal",className:"input h-9 text-sm",value:o.height_cm,onChange:Xe("height_cm"),disabled:!s})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Blood group"}),r.jsx("input",{className:"input h-9 text-sm uppercase",placeholder:"e.g. B+",value:o.blood_group,onChange:Xe("blood_group"),disabled:!s})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"BSA (m)"}),r.jsx("input",{type:"text",inputMode:"decimal",className:"input h-9 text-sm",value:o.bsa,onChange:Xe("bsa"),disabled:!s})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"BMI (kg/m)"}),r.jsx("input",{className:"input h-9 text-sm bg-slate-50",value:o.bmi,readOnly:!0}),r.jsx("p",{className:"mt-1 text-[10px] text-slate-400",children:"Auto-calculated from weight & height."})]})]}),s&&r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{type:"button",onClick:jt,className:"btn",children:"Save header"})})]}),r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-3 shadow-sm",children:[r.jsx("h3",{className:"text-xs font-semibold text-slate-800",children:"Dietary advice (per day)"}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Oral fluid (ml/day)"}),r.jsx("input",{type:"text",inputMode:"decimal",className:"input h-9 text-sm",value:o.diet_oral_fluid_per_day,onChange:Xe("diet_oral_fluid_per_day"),disabled:!s})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Salt (gm/day)"}),r.jsx("input",{type:"text",inputMode:"decimal",className:"input h-9 text-sm",value:o.diet_salt_gm_per_day,onChange:Xe("diet_salt_gm_per_day"),disabled:!s})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Calories (kcal/day)"}),r.jsx("input",{type:"text",inputMode:"decimal",className:"input h-9 text-sm",value:o.diet_calorie_per_day,onChange:Xe("diet_calorie_per_day"),disabled:!s})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Protein (gm/day)"}),r.jsx("input",{type:"text",inputMode:"decimal",className:"input h-9 text-sm",value:o.diet_protein_gm_per_day,onChange:Xe("diet_protein_gm_per_day"),disabled:!s})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Dietary remarks"}),r.jsx("textarea",{className:"input min-h-[48px] text-sm",placeholder:"Any additional diet advice / restrictions",value:o.diet_remarks,onChange:Xe("diet_remarks"),disabled:!s})]}),s&&r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{type:"button",onClick:jt,className:"rounded-full border border-slate-200 px-3 py-1 text-xs text-slate-700 hover:bg-slate-50",children:"Save diet"})})]})]}),r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-3 shadow-sm",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsx("h3",{className:"text-xs font-semibold text-slate-800",children:"Intravenous fluids"})}),s&&r.jsxs("form",{onSubmit:_t,className:"grid gap-2 md:grid-cols-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Date"}),r.jsx("input",{type:"date",className:"input h-9 text-sm",value:h.date,onChange:it("date")})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Fluid"}),r.jsx("input",{className:"input h-9 text-sm",placeholder:"e.g. DNS 500 ml",value:h.fluid,onChange:it("fluid")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Additive (if any)"}),r.jsx("input",{className:"input h-9 text-sm",value:h.additive,onChange:it("additive")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Dose"}),r.jsx("input",{className:"input h-9 text-sm",placeholder:"e.g. 1 amp",value:h.dose,onChange:it("dose")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Rate (ml/hr)"}),r.jsx("input",{type:"text",inputMode:"decimal",className:"input h-9 text-sm",value:h.rate_ml_per_hr,onChange:it("rate_ml_per_hr")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Start time (hrs)"}),r.jsx("input",{type:"time",className:"input h-9 text-sm",value:h.start_time,onChange:it("start_time")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Stop time (hrs)"}),r.jsx("input",{type:"time",className:"input h-9 text-sm",value:h.stop_time,onChange:it("stop_time")})]}),r.jsxs("div",{className:"md:col-span-3",children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Remarks"}),r.jsx("input",{className:"input h-9 text-sm",placeholder:"Doctor sign / notes",value:h.remarks,onChange:it("remarks")})]}),r.jsx("div",{className:"flex items-end justify-end",children:r.jsx("button",{type:"submit",className:"btn w-full md:w-auto",disabled:x,children:x?"Saving":"Add IV fluid"})})]}),r.jsx("div",{className:"overflow-auto rounded-xl border bg-slate-50",children:r.jsxs("table",{className:"w-full text-[11px] md:text-xs",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-slate-100 text-slate-600",children:[r.jsx("th",{className:"px-2 py-2 text-left",children:"Date"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Fluid"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Additive"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Dose"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Rate (ml/hr)"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Start"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Stop"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Remarks"}),s&&r.jsx("th",{className:"px-2 py-2"})]})}),r.jsx("tbody",{children:d.length?d.map(he=>r.jsxs("tr",{className:"border-t bg-white",children:[r.jsx("td",{className:"px-2 py-1",children:ge(he.date)}),r.jsx("td",{className:"px-2 py-1",children:he.fluid||""}),r.jsx("td",{className:"px-2 py-1",children:he.additive||""}),r.jsx("td",{className:"px-2 py-1",children:he.dose||""}),r.jsx("td",{className:"px-2 py-1",children:he.rate_ml_per_hr!=null?he.rate_ml_per_hr:""}),r.jsx("td",{className:"px-2 py-1",children:he.start_time||""}),r.jsx("td",{className:"px-2 py-1",children:he.stop_time||""}),r.jsx("td",{className:"px-2 py-1",children:he.remarks||""}),s&&r.jsx("td",{className:"px-2 py-1 text-right",children:r.jsx("button",{type:"button",onClick:()=>ve(he),className:"text-[10px] text-rose-600 underline hover:text-rose-700",children:"Remove"})})]},he.id)):r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-3 text-center text-[11px] text-slate-500",colSpan:s?9:8,children:"No IV fluids recorded."})})})]})})]}),r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-3 shadow-sm",children:[r.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[r.jsx("h3",{className:"text-xs font-semibold text-slate-800",children:"Drug orders (Regular / SOS / STAT & Premed)"}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx("button",{type:"button",onClick:()=>re(he=>!he),className:`rounded-full border px-3 py-1 text-[11px] ${G?"border-emerald-500 bg-emerald-50 text-emerald-700":"border-slate-300 bg-white text-slate-600"}`,children:G?"Showing active only":"Showing all orders"}),r.jsxs("div",{className:"flex gap-1 rounded-full bg-slate-50 p-1 text-[11px]",children:[r.jsx("button",{type:"button",onClick:()=>Ee("all"),className:`rounded-full px-2 py-0.5 ${ye==="all"?"bg-white text-slate-900 shadow-sm":"text-slate-600"}`,children:"All"}),FI.map(he=>r.jsx("button",{type:"button",onClick:()=>Ee(he.value),className:`rounded-full px-2 py-0.5 ${ye===he.value?"bg-white text-slate-900 shadow-sm":"text-slate-600"}`,children:he.label},he.value))]})]})]}),F&&r.jsx("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:F}),s&&r.jsxs("form",{onSubmit:ds,className:"space-y-3 rounded-2xl border bg-slate-50 p-3 md:p-4",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-6",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:["Drug name ",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx("input",{className:"input h-9 text-sm",placeholder:"e.g. Tab. Paracetamol",value:ee.drug_name,onChange:pt("drug_name")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Order type"}),r.jsx("select",{className:"input h-9 text-sm",value:ee.order_type,onChange:pt("order_type"),children:FI.map(he=>r.jsx("option",{value:he.value,children:he.label},he.value))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Route"}),r.jsx("select",{className:"input h-9 text-sm",value:ee.route,onChange:pt("route"),children:jge.map(he=>r.jsx("option",{value:he,children:he.toUpperCase()},he))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Frequency"}),r.jsx("select",{className:"input h-9 text-sm",value:ee.frequency,onChange:pt("frequency"),children:_ge.map(he=>r.jsx("option",{value:he,children:he.toUpperCase()},he))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Dose"}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("input",{className:"input h-9 w-1/2 text-sm",type:"text",inputMode:"decimal",placeholder:"e.g. 500",value:ee.dose_value,onChange:pt("dose_value")}),r.jsx("select",{className:"input h-9 w-1/2 text-sm",value:ee.dose_unit,onChange:pt("dose_unit"),children:Sge.map(he=>r.jsx("option",{value:he,children:he},he))})]})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-5",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Start date"}),r.jsx("input",{type:"date",className:"input h-9 text-sm",value:ee.start_date,onChange:pt("start_date")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Planned end date"}),r.jsx("input",{type:"date",className:"input h-9 text-sm",value:ee.end_date,onChange:pt("end_date")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Duration (days)"}),r.jsx("input",{className:"input h-9 text-sm",type:"text",inputMode:"numeric",placeholder:"e.g. 5",value:ee.duration_days,onChange:pt("duration_days")})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Special instructions"}),r.jsx("textarea",{className:"input min-h-[48px] text-sm",placeholder:"e.g. Before food, monitor BP, tapering etc.",value:ee.instructions,onChange:pt("instructions")})]})]}),r.jsxs("div",{className:"flex items-center justify-end gap-2",children:[r.jsx("button",{type:"button",onClick:Ns,className:"rounded-full border border-slate-200 px-3 py-1 text-xs text-slate-600 hover:bg-slate-50",children:"Clear"}),r.jsx("button",{type:"submit",className:"btn",disabled:H||!s,children:H?"Saving":"Add medication"})]})]}),r.jsx("div",{className:"overflow-auto rounded-2xl border bg-white",children:r.jsxs("table",{className:"w-full text-[11px] md:text-xs",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-slate-50 text-slate-500",children:[r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Type"}),r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Drug"}),r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Route"}),r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Freq"}),r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Dose"}),r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Start"}),r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"End"}),r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Instructions"}),r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Status"}),s&&r.jsx("th",{className:"px-2 py-2 md:px-3"})]})}),r.jsx("tbody",{children:ce.length?ce.map(he=>r.jsxs("tr",{className:"border-t align-top text-slate-800",children:[r.jsx("td",{className:"px-2 py-2 md:px-3",children:he.order_type==="sos"&&"SOS"||he.order_type==="stat_premed"&&"STAT / Premed"||"Regular"}),r.jsx("td",{className:"px-2 py-2 md:px-3",children:he.drug_name||""}),r.jsx("td",{className:"px-2 py-2 uppercase md:px-3",children:he.route||""}),r.jsx("td",{className:"px-2 py-2 uppercase md:px-3",children:he.frequency||""}),r.jsx("td",{className:"px-2 py-2 md:px-3",children:X(he)}),r.jsx("td",{className:"px-2 py-2 md:px-3",children:ge(he.start_datetime)}),r.jsx("td",{className:"px-2 py-2 md:px-3",children:ge(he.stop_datetime)}),r.jsx("td",{className:"whitespace-pre-wrap px-2 py-2 md:px-3",children:he.special_instructions||""}),r.jsx("td",{className:"px-2 py-2 md:px-3",children:r.jsx("span",{className:de(he.order_status),children:he.order_status||"active"})}),s&&r.jsx("td",{className:"px-2 py-2 text-right md:px-3",children:(he.order_status||"active")!=="stopped"&&r.jsx("button",{type:"button",onClick:()=>ie(he),className:"text-[10px] text-rose-600 underline hover:text-rose-700",children:"Stop"})})]},he.id)):r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-3 text-center text-xs text-slate-500",colSpan:s?10:9,children:$?"Loading medication orders":"No medications recorded for this admission."})})})]})}),r.jsxs("p",{className:"text-[10px] text-slate-500",children:[r.jsx("strong",{children:"Note:"})," If medicines are not administered, indicate as"," ",r.jsx("strong",{children:"NOT GIVEN"})," in the drug chart and document the reason in nurses notes. Verbal orders should be clearly marked (e.g. 'V') and read-back practiced for all orders. Verbal orders are"," ",r.jsx("strong",{children:"not accepted for high-risk drugs"})," and must be signed by the ordering doctor within 24 hours."]})]}),r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-3 shadow-sm",children:[r.jsx("h3",{className:"text-xs font-semibold text-slate-800",children:"Nurse signature register"}),s&&r.jsxs("form",{onSubmit:xe,className:"grid gap-2 md:grid-cols-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Name of nurse"}),r.jsx("input",{className:"input h-9 text-sm",value:_.name,onChange:ae("name")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Specimen sign"}),r.jsx("input",{className:"input h-9 text-sm",value:_.specimen,onChange:ae("specimen")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Emp. no"}),r.jsx("input",{className:"input h-9 text-sm",value:_.emp_no,onChange:ae("emp_no")})]}),r.jsx("div",{className:"flex items-end justify-end",children:r.jsx("button",{type:"submit",className:"btn w-full md:w-auto",disabled:k,children:k?"Saving":"Add nurse"})})]}),r.jsx("div",{className:"overflow-auto rounded-xl border bg-slate-50",children:r.jsxs("table",{className:"w-full text-[11px] md:text-xs",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-slate-100 text-slate-600",children:[r.jsx("th",{className:"px-2 py-2 text-left",children:"S. No"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Name"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Specimen sign"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Emp. no"}),s&&r.jsx("th",{className:"px-2 py-2"})]})}),r.jsx("tbody",{children:v.length?v.map((he,Me)=>r.jsxs("tr",{className:"border-t bg-white",children:[r.jsx("td",{className:"px-2 py-1",children:Me+1}),r.jsx("td",{className:"px-2 py-1",children:he.name||""}),r.jsx("td",{className:"px-2 py-1",children:he.specimen||""}),r.jsx("td",{className:"px-2 py-1",children:he.emp_no||""}),s&&r.jsx("td",{className:"px-2 py-1 text-right",children:r.jsx("button",{type:"button",onClick:()=>je(he),className:"text-[10px] text-rose-600 underline hover:text-rose-700",children:"Remove"})})]},he.id)):r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-3 text-center text-xs text-slate-500",colSpan:s?5:4,children:"No nurse entries recorded."})})})]})})]}),r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-3 shadow-sm",children:[r.jsx("h3",{className:"text-xs font-semibold text-slate-800",children:"Doctor's daily authorisation"}),s&&r.jsxs("form",{onSubmit:Ct,className:"grid gap-2 md:grid-cols-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Date"}),r.jsx("input",{type:"date",className:"input h-9 text-sm",value:O.date,onChange:Fe("date")})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Remarks / authorisation notes"}),r.jsx("input",{className:"input h-9 text-sm",placeholder:"e.g. continue same drug chart, modify doses etc.",value:O.remarks,onChange:Fe("remarks")})]}),r.jsx("div",{className:"flex items-end justify-end",children:r.jsx("button",{type:"submit",className:"btn w-full md:w-auto",disabled:I,children:I?"Saving":"Add authorisation"})})]}),r.jsx("div",{className:"overflow-auto rounded-xl border bg-slate-50",children:r.jsxs("table",{className:"w-full text-[11px] md:text-xs",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-slate-100 text-slate-600",children:[r.jsx("th",{className:"px-2 py-2 text-left",children:"Date"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Remarks"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Doctor"}),r.jsx("th",{className:"px-2 py-2 text-left",children:"Sign"}),s&&r.jsx("th",{className:"px-2 py-2"})]})}),r.jsx("tbody",{children:T.length?T.map(he=>r.jsxs("tr",{className:"border-t bg-white",children:[r.jsx("td",{className:"px-2 py-1",children:ge(he.date)}),r.jsx("td",{className:"px-2 py-1",children:he.remarks||""}),r.jsx("td",{className:"px-2 py-1",children:he.doctor_name||""}),r.jsx("td",{className:"px-2 py-1",children:he.doctor_sign||""}),s&&r.jsx("td",{className:"px-2 py-1 text-right",children:r.jsx("button",{type:"button",onClick:()=>vt(he),className:"text-[10px] text-rose-600 underline hover:text-rose-700",children:"Remove"})})]},he.id)):r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-3 text-center text-xs text-slate-500",colSpan:s?5:4,children:"No daily authorisation entries recorded."})})})]})})]})]})}function Xa(t,s="Something went wrong"){var a,i;const n=(i=(a=t==null?void 0:t.response)==null?void 0:a.data)==null?void 0:i.detail;if(!n)return s;if(typeof n=="string")return n;if(Array.isArray(n)){const l=n.map(o=>(o==null?void 0:o.msg)||(typeof o=="string"?o:"")).filter(Boolean);if(l.length)return l.join("; ")}return typeof n=="object"&&n.msg?n.msg:s}function kge({admissionId:t,canWrite:s}){const[n,a]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(""),[d,u]=y.useState(!1),[h,f]=y.useState({entry_type:"dressing",done_at:"",site:"",product:"",volume:"",notes:""}),x=async()=>{var S,k;if(t){l(!0),c("");try{const{data:A}=await _ue(t);a(A||[])}catch(A){c(((k=(S=A==null?void 0:A.response)==null?void 0:S.data)==null?void 0:k.detail)||"Failed to load dressing / transfusion entries")}finally{l(!1)}}};y.useEffect(()=>{x()},[t]);const b=S=>S?S.length===16?`${S}:00`:S:null,v=S=>k=>{const A=k.target.value;f(T=>({...T,[S]:A}))},w=async S=>{var k,A;if(S.preventDefault(),!(!s||!t)){if(!h.entry_type){alert("Please select type (Dressing / Transfusion)");return}u(!0);try{const T={entry_type:h.entry_type||"dressing",done_at:b(h.done_at)||new Date().toISOString(),site:h.site||"",product:h.entry_type==="transfusion"&&h.product||"",volume:h.entry_type==="transfusion"&&h.volume||"",notes:h.notes||""};await jue(t,T),f(P=>({entry_type:P.entry_type,done_at:"",site:"",product:"",volume:"",notes:""})),await x()}catch(T){alert(((A=(k=T==null?void 0:T.response)==null?void 0:k.data)==null?void 0:A.detail)||"Failed to save entry")}finally{u(!1)}}},_=h.entry_type==="transfusion";return r.jsxs("div",{className:"space-y-4 text-sm text-black",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("h2",{className:"font-semibold",children:"Dressing / Transfusion"}),i&&r.jsx("span",{className:"text-[11px] text-gray-500",children:"Loading entries"})]}),o&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:o}),s&&r.jsxs("form",{onSubmit:w,className:"rounded-xl border bg-gray-50 p-3 space-y-3",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Type"}),r.jsxs("select",{className:"input",value:h.entry_type,onChange:v("entry_type"),children:[r.jsx("option",{value:"dressing",children:"Dressing"}),r.jsx("option",{value:"transfusion",children:"Transfusion"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Date & time"}),r.jsx("input",{type:"datetime-local",className:"input",value:h.done_at,onChange:v("done_at")})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Site"}),r.jsx("input",{className:"input",placeholder:_?"e.g. IV line / central line":"e.g. abdominal wound",value:h.site,onChange:v("site")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Product / bag"}),r.jsx("input",{className:"input",placeholder:"e.g. PRBC, FFP",value:h.product,onChange:v("product"),disabled:!_})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:"Volume"}),r.jsx("input",{className:"input",placeholder:"e.g. 1 unit / 300 ml",value:h.volume,onChange:v("volume"),disabled:!_})]})]}),r.jsx("textarea",{className:"input min-h-[60px]",placeholder:_?"Notes (vitals, reaction, transfusion details)":"Notes (wound status, exudate, dressing type)",value:h.notes,onChange:v("notes")}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{className:"btn",disabled:d,children:d?"Saving":"Save entry"})})]}),r.jsx("div",{className:"rounded-xl border bg-white overflow-auto",children:r.jsxs("table",{className:"w-full text-xs md:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 text-gray-500 text-[11px] md:text-xs",children:[r.jsx("th",{className:"px-2 md:px-3 py-2 text-left",children:"When"}),r.jsx("th",{className:"px-2 md:px-3 py-2 text-left",children:"Type"}),r.jsx("th",{className:"px-2 md:px-3 py-2 text-left",children:"Site"}),r.jsx("th",{className:"px-2 md:px-3 py-2 text-left",children:"Product"}),r.jsx("th",{className:"px-2 md:px-3 py-2 text-left",children:"Volume"}),r.jsx("th",{className:"px-2 md:px-3 py-2 text-left",children:"Notes"})]})}),r.jsxs("tbody",{children:[n.map(S=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-2 md:px-3 py-2 align-top",children:S.done_at?new Date(S.done_at).toLocaleString():""}),r.jsx("td",{className:"px-2 md:px-3 py-2 align-top capitalize",children:S.entry_type||""}),r.jsx("td",{className:"px-2 md:px-3 py-2 align-top",children:S.site||""}),r.jsx("td",{className:"px-2 md:px-3 py-2 align-top",children:S.product||(S.entry_type==="transfusion"?"":"")}),r.jsx("td",{className:"px-2 md:px-3 py-2 align-top",children:S.volume||(S.entry_type==="transfusion"?"":"")}),r.jsx("td",{className:"px-2 md:px-3 py-2 align-top whitespace-pre-wrap",children:S.notes||""})]},S.id)),!n.length&&!i&&r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-3 text-gray-500 text-xs",colSpan:6,children:"No dressing / transfusion entries yet."})})]})]})})]})}const Age=["mg","g","ml","units","drops","puff","tab","cap","sachet"],Ege=["OD","BD","TDS","QID","HS","SOS","PRN"],Tge=[3,5,7,10,14];function Pge({admissionId:t,canWrite:s=!0}){const[n,a]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(""),[d,u]=y.useState({drugName:"",doseValue:"",doseUnit:"mg",frequency:"",durationDays:"",instructions:""}),[h,f]=y.useState(!1),x=y.useMemo(()=>Array.isArray(n)&&n.length>0,[n]),b=async()=>{var P,O;if(t){l(!0),c("");try{const{data:D}=await LB(t);console.log("======================================================"),console.log(t,"dcbjdbgjdsbcjbsd"),console.log(D,"data"),console.log("======================================================"),a(Array.isArray(D)?D:[])}catch(D){const I=((O=(P=D==null?void 0:D.response)==null?void 0:P.data)==null?void 0:O.detail)||"Failed to load discharge medicines";c(I),se.error(I)}finally{l(!1)}}};y.useEffect(()=>{b()},[t]);const v=P=>O=>{const D=O.target.value;u(I=>({...I,[P]:D}))},w=P=>{u(O=>({...O,frequency:P}))},_=P=>{u(O=>({...O,durationDays:String(P)}))},S=()=>u({drugName:"",doseValue:"",doseUnit:"mg",frequency:"",durationDays:"",instructions:""}),k=async P=>{var B,L;if(P.preventDefault(),!s||!t)return;const O=d.drugName.trim();if(!O){se.error("Please enter a drug name");return}const D=d.doseValue.trim()?Number(d.doseValue):null;if(d.doseValue&&Number.isNaN(D)){se.error("Dose must be a number (e.g. 500)");return}const I=d.durationDays.trim()?Number(d.durationDays):null;if(d.durationDays&&(Number.isNaN(I)||!Number.isInteger(I))){se.error("Duration must be a whole number of days");return}const M={drug_name:O,dose:D,dose_unit:d.doseUnit||"",route:"",frequency:d.frequency.trim(),duration_days:I,advice_text:d.instructions.trim()};try{f(!0),await yue(t,M),se.success("Discharge medicine added"),S(),await b()}catch(F){const V=((L=(B=F==null?void 0:F.response)==null?void 0:B.data)==null?void 0:L.detail)||"Failed to save discharge medicine";se.error(V)}finally{f(!1)}},A=P=>P.dose==null&&!P.dose_unit?"":P.dose==null?P.dose_unit||"":`${P.dose} ${P.dose_unit||""}`.trim(),T=P=>P.duration_days==null?"":P.duration_days===0?"0 days":`${P.duration_days} days`;return r.jsxs("div",{className:"space-y-4 text-sm text-slate-900",children:[r.jsxs("div",{className:"flex flex-col gap-2 rounded-2xl border bg-gradient-to-r from-sky-50 via-indigo-50 to-emerald-50 p-3 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wide text-sky-900",children:"Discharge Medications"}),r.jsx("p",{className:"text-[11px] text-slate-600",children:"Define clear post-discharge prescriptions. These lines can be merged into the discharge summary PDF."})]}),x&&r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Total medicines:"," ",r.jsx("span",{className:"font-semibold text-slate-800",children:n.length})]})]}),o&&r.jsx("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:o}),s&&r.jsxs("form",{onSubmit:k,className:"space-y-3 rounded-2xl border bg-white p-3 shadow-sm md:p-4",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("div",{className:"text-xs font-semibold text-slate-800",children:"Add / edit discharge prescription line"}),h&&r.jsx("div",{className:"text-[11px] text-slate-500",children:"Saving"})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:["Drug / formulation ",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx("input",{className:"input h-9 text-sm",placeholder:"e.g. Tab. Paracetamol",value:d.drugName,onChange:v("drugName")}),r.jsx("p",{className:"mt-1 text-[10px] text-slate-400",children:"Include form (tab / cap / syrup) for clarity."})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Dose"}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("input",{className:"input h-9 w-1/2 text-sm",type:"text",inputMode:"decimal",placeholder:"e.g. 500",value:d.doseValue,onChange:v("doseValue")}),r.jsx("select",{className:"input h-9 w-1/2 text-sm",value:d.doseUnit,onChange:v("doseUnit"),children:Age.map(P=>r.jsx("option",{value:P,children:P},P))})]}),r.jsx("p",{className:"mt-1 text-[10px] text-slate-400",children:"Number in dose box, unit separately (mg / ml / units)."})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Frequency"}),r.jsx("input",{className:"input h-9 text-sm",placeholder:"e.g. BD, TDS, HS",value:d.frequency,onChange:v("frequency")}),r.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:Ege.map(P=>r.jsx("button",{type:"button",onClick:()=>w(P),className:"rounded-full border border-slate-200 px-2 py-[1px] text-[10px] text-slate-600 hover:bg-slate-100",children:P},P))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Duration (days)"}),r.jsx("input",{className:"input h-9 text-sm",type:"text",inputMode:"numeric",placeholder:"e.g. 5",value:d.durationDays,onChange:v("durationDays")}),r.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:Tge.map(P=>r.jsxs("button",{type:"button",onClick:()=>_(P),className:"rounded-full border border-slate-200 px-2 py-[1px] text-[10px] text-slate-600 hover:bg-slate-100",children:[P,"d"]},P))})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-600",children:"Instructions"}),r.jsx("textarea",{className:"input min-h-[60px] text-sm",placeholder:"e.g. After food; stop if rash / vomiting; avoid alcohol",value:d.instructions,onChange:v("instructions")})]}),r.jsxs("div",{className:"flex items-center justify-end gap-2",children:[r.jsx("button",{type:"button",onClick:S,className:"rounded-full border border-slate-200 px-3 py-1 text-xs text-slate-600 hover:bg-slate-50",children:"Clear"}),r.jsx("button",{type:"submit",className:"btn",disabled:h||!s,children:h?"Saving":"Add discharge med"})]})]}),r.jsx("div",{className:"overflow-auto rounded-2xl border bg-white shadow-sm",children:r.jsxs("table",{className:"w-full text-xs md:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-slate-50 text-[11px] text-slate-500 md:text-xs",children:[r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Drug"}),r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Dose"}),r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Frequency"}),r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Duration"}),r.jsx("th",{className:"px-2 py-2 text-left md:px-3",children:"Instructions"})]})}),r.jsx("tbody",{children:x?n.map(P=>r.jsxs("tr",{className:"border-t text-slate-800",children:[r.jsx("td",{className:"px-2 py-2 md:px-3",children:P.drug_name||""}),r.jsx("td",{className:"px-2 py-2 md:px-3",children:A(P)}),r.jsx("td",{className:"px-2 py-2 md:px-3",children:P.frequency||""}),r.jsx("td",{className:"px-2 py-2 md:px-3",children:T(P)}),r.jsx("td",{className:"whitespace-pre-wrap px-2 py-2 md:px-3",children:P.advice_text||""})]},P.id)):r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-3 text-center text-xs text-slate-500",colSpan:5,children:i?"Loading discharge medicines":"No discharge medicines added yet."})})})]})})]})}function Ige({admissionId:t,canWrite:s}){const[n,a]=y.useState(null),[i,l]=y.useState(!1),[o,c]=y.useState(""),[d,u]=y.useState({rating_nursing:5,rating_doctor:5,rating_cleanliness:5,comments:"",suggestions:""}),h=async()=>{var v,w,_;if(t){l(!0),c("");try{const{data:S}=await vue(t);a(S||null),S&&u({rating_nursing:S.rating_nursing??5,rating_doctor:S.rating_doctor??5,rating_cleanliness:S.rating_cleanliness??5,comments:S.comments||"",suggestions:S.suggestions||""})}catch(S){const k=(v=S==null?void 0:S.response)==null?void 0:v.status;k&&k!==404&&c(((_=(w=S==null?void 0:S.response)==null?void 0:w.data)==null?void 0:_.detail)||"Failed to load feedback")}finally{l(!1)}}};y.useEffect(()=>{h()},[t]);const f=async v=>{var w,_;if(v.preventDefault(),!(!s||!t))try{const S={rating_nursing:Number(d.rating_nursing)||0,rating_doctor:Number(d.rating_doctor)||0,rating_cleanliness:Number(d.rating_cleanliness)||0,comments:d.comments||"",suggestions:d.suggestions||""},{data:k}=await Nue(t,S);a(k||S),alert("Feedback saved")}catch(S){alert(((_=(w=S==null?void 0:S.response)==null?void 0:w.data)==null?void 0:_.detail)||"Failed to save feedback")}},x=({label:v,value:w,onChange:_,disabled:S})=>r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-500",children:v}),r.jsx("select",{className:"input",value:w,disabled:S,onChange:k=>_(Number(k.target.value)),children:[1,2,3,4,5].map(k=>r.jsxs("option",{value:k,children:[k," / 5"]},k))})]}),b=!s;return r.jsxs("div",{className:"space-y-4 text-sm text-black",children:[r.jsx("h2",{className:"font-semibold",children:"Patient Feedback"}),r.jsx("p",{className:"text-xs text-gray-600",children:"Capture patient or attendant feedback for this admission (NABH requirement  patient satisfaction)."}),i&&r.jsx("div",{className:"text-xs text-gray-500",children:"Loading"}),o&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:o}),r.jsxs("form",{onSubmit:f,className:"rounded-xl border bg-gray-50 p-3 space-y-3",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsx(x,{label:"Nursing care",value:d.rating_nursing,disabled:b,onChange:v=>u(w=>({...w,rating_nursing:v}))}),r.jsx(x,{label:"Doctor communication",value:d.rating_doctor,disabled:b,onChange:v=>u(w=>({...w,rating_doctor:v}))}),r.jsx(x,{label:"Cleanliness / facilities",value:d.rating_cleanliness,disabled:b,onChange:v=>u(w=>({...w,rating_cleanliness:v}))})]}),r.jsx("textarea",{className:"input min-h-[80px]",placeholder:"Comments",value:d.comments,disabled:b,onChange:v=>u(w=>({...w,comments:v.target.value}))}),r.jsx("textarea",{className:"input min-h-[60px]",placeholder:"Suggestions for improvement",value:d.suggestions,disabled:b,onChange:v=>u(w=>({...w,suggestions:v.target.value}))}),s&&r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{className:"btn",children:"Save feedback"})})]}),n&&r.jsxs("div",{className:"rounded-xl border bg-white p-3 text-xs text-gray-700",children:[r.jsx("div",{className:"font-semibold mb-1",children:"Snapshot"}),r.jsxs("div",{children:["Nursing care: ",r.jsxs("b",{children:[n.rating_nursing,"/5"]}),", Doctor:"," ",r.jsxs("b",{children:[n.rating_doctor,"/5"]}),", Cleanliness:"," ",r.jsxs("b",{children:[n.rating_cleanliness,"/5"]})]}),n.comments&&r.jsxs("div",{className:"mt-1",children:[r.jsx("span",{className:"font-semibold",children:"Comments:"})," ",n.comments]}),n.suggestions&&r.jsxs("div",{className:"mt-1",children:[r.jsx("span",{className:"font-semibold",children:"Suggestions:"})," ",n.suggestions]})]})]})}function Mge({admission:t,beds:s,canWrite:n,onTransfer:a}){const i=(t==null?void 0:t.current_bed_id)&&s.find(l=>l.id===t.current_bed_id);return r.jsxs("div",{className:"space-y-4 text-sm text-slate-900",children:[r.jsxs("div",{className:"flex flex-col gap-1 rounded-2xl border bg-gradient-to-r from-sky-50 via-slate-50 to-emerald-50 p-3 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wide text-sky-900",children:"Bed / Transfer"}),r.jsx("p",{className:"text-[11px] text-slate-600",children:"View current bed and transfer the patient to another available bed with proper tracking. This action affects IPD bed occupancy and billing."})]}),i?r.jsxs("div",{className:"text-[11px] text-slate-600",children:["Current bed:"," ",r.jsx("span",{className:"font-semibold text-slate-900",children:i.code}),i.ward_name&&r.jsxs("span",{className:"ml-1 text-slate-500",children:["(",i.ward_name,")"]})]}):r.jsx("div",{className:"text-[11px] text-slate-500",children:"No active bed mapped for this admission."})]}),r.jsxs("div",{className:"rounded-2xl border bg-white p-3 shadow-sm md:p-4",children:[r.jsx("div",{className:"mb-2 text-xs font-semibold text-slate-800",children:"Transfer to another bed"}),!n&&r.jsx("div",{className:"mb-3 rounded-lg border border-amber-100 bg-amber-50 px-3 py-2 text-[11px] text-amber-700",children:"You have view-only access. Contact an IPD incharge / Admin to perform transfers."}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-[minmax(0,320px)_1fr]",children:[r.jsx("div",{children:r.jsx(VB,{value:"",onChange:l=>{!n||!l||a(l)}})}),r.jsx("div",{className:"text-[11px] text-slate-500",children:r.jsxs("ul",{className:"list-disc space-y-1 pl-4",children:[r.jsx("li",{children:"Only vacant beds can be selected for transfer."}),r.jsx("li",{children:"Bed transfer will automatically update bed occupancy and subsequent bed charges."}),r.jsx("li",{children:"Ensure the new bed type is clinically appropriate for the patient's condition (ICU / HDU / Ward etc.)."})]})})]})]})]})}const $I=[{key:"nursing",label:"Nursing Notes",el:dxe,writePerm:"ipd.nursing"},{key:"vitals",label:"Vitals",el:uxe,writePerm:"ipd.nursing"},{key:"io",label:"Intake/Output",el:hxe,writePerm:"ipd.nursing"},{key:"handover",label:"Shift Handover",el:mxe,writePerm:"ipd.nursing"},{key:"rounds",label:"Doctor Rounds",el:fxe,writePerm:"ipd.doctor"},{key:"progress",label:"Progress Notes",el:pxe,writePerm:"ipd.doctor"},{key:"assessments",label:"Assessments",el:wge,writePerm:"ipd.nursing"},{key:"medications",label:"Medications / Drug Chart",el:Cge,writePerm:"ipd.doctor"},{key:"dressing",label:"Dressing / Transfusion",el:kge,writePerm:"ipd.nursing"},{key:"discharge-meds",label:"Discharge Meds",el:Pge,writePerm:"ipd.doctor"},{key:"bed-transfer",label:"Bed / Transfer",el:Mge,writePerm:"ipd.manage"},{key:"referrals",label:"Referrals",el:gxe,writePerm:"ipd.manage"},{key:"discharge",label:"Discharge Summary",el:yxe,writePerm:"ipd.manage"},{key:"charges",label:"Bed Charges",el:bxe,writePerm:"ipd.manage"},{key:"feedback",label:"Feedback",el:Ige,writePerm:"ipd.manage"}];function Dge(){var F;const{id:t}=xd(),s=Xi(),n=((F=s==null?void 0:s.state)==null?void 0:F.admission)||null,[a,i]=y.useState(n),[l,o]=y.useState([]),[c,d]=y.useState("nursing"),[u,h]=y.useState(""),[f,x]=y.useState(!1),[b,v]=y.useState(null),w=nt("ipd.view"),_=nt("ipd.manage"),S=nt("ipd.nursing"),k=nt("ipd.doctor"),A={"ipd.nursing":S,"ipd.doctor":k,"ipd.manage":_},T=V=>`ADM-${String(V).padStart(6,"0")}`,P=async()=>{var V,$,z;x(!0),h("");try{const[{data:H},q]=await Promise.all([RB(Number(t)),Nl()]),G=H||n||null;if(i(G),o(q.data||[]),G!=null&&G.patient_id)try{const{data:re}=await lv(G.patient_id);v(re)}catch{}}catch(H){((H==null?void 0:H.status)||((V=H==null?void 0:H.response)==null?void 0:V.status))===404&&n?i(n):h(((z=($=H==null?void 0:H.response)==null?void 0:$.data)==null?void 0:z.detail)||"Failed to load admission details")}finally{x(!1)}};y.useEffect(()=>{P()},[t]);const O=async()=>{var V,$;if(a&&window.confirm("Are you sure you want to cancel this admission? This will mark the admission as cancelled."))try{await Ade(a.id),window.location.assign("/ipd/tracking")}catch(z){h((($=(V=z==null?void 0:z.response)==null?void 0:V.data)==null?void 0:$.detail)||"Cancel failed")}},D=async V=>{var $,z;if(!(!a||!V))try{await Ede(a.id,{to_bed_id:Number(V),reason:"Transfer"}),await P()}catch(H){h(((z=($=H==null?void 0:H.response)==null?void 0:$.data)==null?void 0:z.detail)||"Transfer failed")}};if(!w&&!_)return r.jsx("div",{className:"p-4 text-sm text-rose-700",children:"Access denied (need ipd.view)."});if(f&&!a)return r.jsx("div",{className:"p-4 text-sm",children:"Loading"});if(!a)return r.jsx("div",{className:"p-4 text-sm",children:"No data"});const I=a.current_bed_id&&l.find(V=>V.id===a.current_bed_id),M=a.ip_number||a.ipNo||null,B=(I==null?void 0:I.code)||null,L=()=>r.jsxs("div",{className:"grid gap-3 rounded-2xl border bg-white p-3 text-xs text-slate-800 md:grid-cols-4 md:p-4",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] uppercase tracking-wide text-slate-400",children:"Admission"}),r.jsx("div",{className:"font-semibold text-slate-900",children:T(a.id)}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Admitted on:"," ",a.admitted_at?new Date(a.admitted_at).toLocaleString():""]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] uppercase tracking-wide text-slate-400",children:"Patient"}),r.jsx("div",{className:"font-semibold text-slate-900",children:(b==null?void 0:b.full_name)||(b==null?void 0:b.name)||""}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID:"," ",r.jsx("span",{className:"font-medium",children:(b==null?void 0:b.uhid)||`P-${a.patient_id}`})]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] uppercase tracking-wide text-slate-400",children:"Bed / Ward"}),r.jsx("div",{className:"font-semibold text-slate-900",children:(I==null?void 0:I.code)||""}),(I==null?void 0:I.ward_name)&&r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Ward: ",I.ward_name]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] uppercase tracking-wide text-slate-400",children:"Status"}),r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-slate-100 px-3 py-1 text-[11px] font-medium capitalize text-slate-800",children:[r.jsx("span",{className:a.status==="active"?"h-2 w-2 rounded-full bg-emerald-500":"h-2 w-2 rounded-full bg-slate-400"}),a.status||""]}),a.practitioner_name&&r.jsxs("div",{className:"mt-1 text-[11px] text-slate-500",children:["Primary doctor:"," ",r.jsx("span",{className:"font-medium",children:a.practitioner_name})]})]})]});return r.jsxs("div",{className:"space-y-4 p-3 md:p-4",children:[r.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-base font-semibold text-slate-900 md:text-lg",children:"IPD Admission  Patient Tracking"}),r.jsx("p",{className:"text-xs text-slate-500 md:text-[13px]",children:"View and manage all in-patient clinical documentation for this admission  nursing notes, vitals, drug chart, handovers, discharge summary and more."})]}),r.jsx("div",{className:"flex flex-wrap items-center gap-2",children:_&&r.jsx("button",{type:"button",onClick:O,className:"rounded-full bg-rose-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-rose-700",children:"Cancel Admission"})})]}),u&&r.jsx("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700 md:text-sm",children:u}),r.jsx(L,{}),r.jsx(h$,{patient:b,contextType:"ipd",contextId:a.id,ipNumber:M,bedLabel:B}),r.jsx("div",{className:"rounded-2xl border bg-white shadow-sm",children:r.jsxs(jl,{value:c,onValueChange:d,className:"w-full",children:[r.jsx("div",{className:"border-b px-2 py-2 md:px-3",children:r.jsx(Wi,{className:"h-auto flex flex-wrap gap-1 bg-transparent p-0 md:gap-2",children:$I.map(V=>{const $=A[V.writePerm]??!1;return r.jsxs(ms,{value:V.key,className:"rounded-full px-3 py-1 text-[11px] text-slate-700 data-[state=active]:bg-slate-900 data-[state=active]:text-white md:text-xs",children:[V.label,!$&&r.jsx("span",{className:"ml-2 rounded-full bg-slate-200 px-1.5 py-[1px] text-[9px] uppercase tracking-wide text-slate-700",children:"view"})]},V.key)})})}),r.jsx("div",{className:"p-2 md:p-3",children:$I.map(V=>{const $=V.el,z=A[V.writePerm]??!1;return r.jsx(us,{value:V.key,className:"mt-2",children:r.jsx($,{admissionId:a.id,admission:a,patient:b,canWrite:z,beds:l,onTransfer:D})},V.key)})})]})})]})}const mj=10;function Oge(){const[t,s]=y.useState([]),[n,a]=y.useState({}),[i,l]=y.useState({}),[o,c]=y.useState(!1),[d,u]=y.useState(""),[h,f]=y.useState(""),[x,b]=y.useState(1),v=B=>`ADM-${String(B).padStart(6,"0")}`,w=B=>B?B==="vacant"?"bg-emerald-50 text-emerald-700 border-emerald-200":B==="occupied"?"bg-rose-50 text-rose-700 border-rose-200":B==="reserved"?"bg-amber-50 text-amber-700 border-amber-200":B==="preoccupied"?"bg-sky-50 text-sky-700 border-sky-200":"bg-slate-50 text-slate-700 border-slate-200":"bg-slate-50 text-slate-700 border-slate-200",_=async()=>{var B,L;c(!0),u("");try{const[F,V]=await Promise.all([iv({status:"admitted"}),Nl()]),$=F.data||[],z=V.data||[];$.sort((re,ye)=>new Date(ye.admitted_at||0)-new Date(re.admitted_at||0)),s($);const H={};for(const re of z)H[re.id]=re;a(H);const q=[...new Set($.map(re=>re.patient_id))].slice(0,100),G={};await Promise.all(q.map(async re=>{try{const{data:ye}=await lv(re);G[re]=(ye==null?void 0:ye.uhid)||`P-${re}`}catch{G[re]=`P-${re}`}})),l(G),b(1)}catch(F){console.error("TrackingAdmissions loadData error",F),u(((L=(B=F==null?void 0:F.response)==null?void 0:B.data)==null?void 0:L.detail)||"Failed to load active admissions. Please try again."),s([]),a({}),l({})}finally{c(!1)}};y.useEffect(()=>{let B=!0;return(async()=>await _())(),()=>{B=!1}},[]);const S=y.useMemo(()=>{const B=h.trim().toLowerCase();return B?t.filter(L=>{var z;const F=v(L.id).toLowerCase(),V=(i[L.patient_id]||`P-${L.patient_id}`).toLowerCase(),$=(((z=n[L.current_bed_id])==null?void 0:z.code)||"").toLowerCase();return F.includes(B)||V.includes(B)||$.includes(B)}):t},[t,h,i,n]),k=Math.max(1,Math.ceil(S.length/mj));y.useEffect(()=>{b(1)},[h,t]);const A=(x-1)*mj,T=S.slice(A,A+mj),P=()=>b(B=>Math.max(1,B-1)),O=()=>b(B=>Math.min(k,B+1)),D=x<=1||o,I=x>=k||o,M=t.length;return r.jsxs("div",{className:"min-h-screen bg-slate-50 px-4 py-4 text-black md:px-6 md:py-6",children:[r.jsxs("div",{className:"mx-auto mb-4 flex max-w-6xl flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl font-semibold tracking-tight text-slate-900",children:"Tracking Admissions"}),r.jsx("p",{className:"mt-1 max-w-2xl text-sm text-slate-600",children:"View all currently admitted in-patients, along with their admission number, UHID and allocated bed. Use the search box to quickly find a patient or admission, and open the admission detail screen for nursing, vitals, orders and discharge."})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[r.jsx(rn,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{className:"leading-tight",children:[r.jsx("span",{className:"font-medium text-slate-800",children:"Active patients"}),r.jsx("br",{}),"Track IP stays"]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[r.jsx(kn,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{className:"leading-tight",children:[r.jsx("span",{className:"font-medium text-slate-800",children:"Bed position"}),r.jsx("br",{}),"Ward / room / bed"]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[r.jsx(lr,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{className:"leading-tight",children:[r.jsx("span",{className:"font-medium text-slate-800",children:"Admitted since"}),r.jsx("br",{}),"Monitor length of stay"]})]})]})]}),r.jsxs("div",{className:"mx-auto max-w-6xl space-y-3",children:[r.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white p-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"w-full md:max-w-md",children:[r.jsxs("div",{className:"relative",children:[r.jsx(es,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),r.jsx("input",{className:"w-full rounded-2xl border border-slate-200 bg-white px-9 py-2 text-sm text-slate-900 placeholder:text-slate-400 outline-none transition focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Search by Admission no, UHID, Bed code",value:h,onChange:B=>f(B.target.value)})]}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Tip: Try typing admission number (ADM-000123), UHID or bed code."})]}),r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 md:justify-end",children:[r.jsxs("div",{className:"text-xs text-slate-600",children:[r.jsx("span",{className:"font-semibold text-slate-900",children:S.length})," ","of ",M," active admissions"]}),r.jsxs("button",{type:"button",onClick:_,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-60",disabled:o,children:[o?r.jsx(ns,{className:"h-3.5 w-3.5 animate-spin"}):r.jsx(Bi,{className:"h-3.5 w-3.5"}),"Refresh"]})]})]}),d&&r.jsxs("div",{className:"flex items-start gap-2 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[r.jsx(nn,{className:"mt-0.5 h-4 w-4"}),r.jsx("span",{children:d})]}),o&&!t.length&&r.jsx("div",{className:"flex items-center justify-center rounded-2xl border border-slate-200 bg-white px-4 py-10 text-sm text-slate-600 shadow-sm",children:r.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 px-3 py-1.5 text-xs",children:[r.jsx(ns,{className:"h-4 w-4 animate-spin text-slate-500"}),"Loading active admissions"]})}),!o&&T.length===0&&r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-4 py-8 text-center text-sm text-slate-500 shadow-sm",children:"No active admissions found."}),!o&&T.length>0&&r.jsxs("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm",children:[r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-slate-50 text-xs text-slate-500",children:[r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Admission"}),r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Patient (UHID)"}),r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Bed"}),r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Admitted at"}),r.jsx("th",{className:"px-4 py-2 text-right font-medium",children:"Action"})]})}),r.jsx("tbody",{children:T.map(B=>{const L=n[B.current_bed_id],F=(L==null?void 0:L.code)||"",V=i[B.patient_id]||`P-${B.patient_id}`;return r.jsxs("tr",{className:"border-t text-sm hover:bg-slate-50",children:[r.jsx("td",{className:"px-4 py-2 align-middle text-slate-900",children:r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2.5 py-0.5 text-[11px] font-semibold tracking-wide text-slate-800",children:v(B.id)})}),r.jsx("td",{className:"px-4 py-2 align-middle text-slate-800",children:V}),r.jsxs("td",{className:"px-4 py-2 align-middle text-slate-800",children:[F,(L==null?void 0:L.state)&&r.jsx("span",{className:`ml-1 inline-flex items-center rounded-full border px-1.5 py-0.5 text-[10px] ${w(L.state)}`,children:L.state})]}),r.jsx("td",{className:"px-4 py-2 align-middle text-slate-700",children:B.admitted_at?new Date(B.admitted_at).toLocaleString():""}),r.jsx("td",{className:"px-4 py-2 align-middle text-right",children:r.jsx(bl,{to:`/ipd/admission/${B.id}`,state:{admission:B},className:"inline-flex items-center rounded-full bg-slate-900 px-3 py-1.5 text-xs font-semibold text-white shadow-sm transition hover:bg-slate-800",children:"Open"})})]},B.id)})})]})}),r.jsx("div",{className:"space-y-2 p-3 md:hidden",children:T.map(B=>{const L=n[B.current_bed_id],F=(L==null?void 0:L.code)||"",V=i[B.patient_id]||`P-${B.patient_id}`;return r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs shadow-sm",children:[r.jsxs("div",{className:"mb-1 flex items-center justify-between gap-2",children:[r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-900 px-2.5 py-0.5 text-[11px] font-semibold tracking-wide text-white",children:v(B.id)}),r.jsx(bl,{to:`/ipd/admission/${B.id}`,state:{admission:B},className:"inline-flex items-center rounded-full bg-slate-900 px-3 py-1 text-[11px] font-semibold text-white shadow-sm transition hover:bg-slate-800",children:"Open"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2 text-slate-800",children:[r.jsx(rn,{className:"h-3.5 w-3.5 text-slate-500"}),r.jsx("span",{className:"font-medium",children:V})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-slate-800",children:[r.jsx(kn,{className:"h-3.5 w-3.5 text-slate-500"}),r.jsx("span",{className:"font-medium",children:F}),(L==null?void 0:L.state)&&r.jsx("span",{className:`inline-flex items-center rounded-full border px-1.5 py-0.5 text-[10px] ${w(L.state)}`,children:L.state})]}),r.jsxs("div",{className:"flex items-start gap-2 text-slate-700",children:[r.jsx(lr,{className:"mt-0.5 h-3.5 w-3.5 text-slate-500"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] text-slate-500",children:"Admitted at"}),r.jsx("div",{className:"text-[11px]",children:B.admitted_at?new Date(B.admitted_at).toLocaleString():""})]})]})]})]},B.id)})}),S.length>0&&r.jsxs("div",{className:"flex flex-col items-center justify-between gap-3 border-t border-slate-100 px-4 py-3 text-xs text-slate-600 sm:flex-row",children:[r.jsxs("button",{type:"button",onClick:P,disabled:D,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 font-medium shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",children:[r.jsx(zx,{className:"h-4 w-4"}),"Prev"]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Page"," ",r.jsx("span",{className:"font-medium text-slate-900",children:x})," ","of ",k]}),r.jsxs("button",{type:"button",onClick:O,disabled:I,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 font-medium shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",children:["Next",r.jsx(Om,{className:"h-4 w-4"})]})]})]})]})]})}const fj=10;function Rge(){const t=cr(F=>F.user),[s,n]=y.useState([]),[a,i]=y.useState({}),[l,o]=y.useState({}),[c,d]=y.useState(!1),[u,h]=y.useState(""),[f,x]=y.useState(""),[b,v]=y.useState(1),w=F=>`ADM-${String(F).padStart(6,"0")}`,_=F=>F?F==="vacant"?"bg-emerald-50 text-emerald-700 border-emerald-200":F==="occupied"?"bg-rose-50 text-rose-700 border-rose-200":F==="reserved"?"bg-amber-50 text-amber-700 border-amber-200":F==="preoccupied"?"bg-sky-50 text-sky-700 border-sky-200":"bg-slate-50 text-slate-700 border-slate-200":"bg-slate-50 text-slate-700 border-slate-200",S=async()=>{var F,V;if(t!=null&&t.id){d(!0),h("");try{const[$,z]=await Promise.all([iv({status:"admitted",practitioner_user_id:t.id}),Nl()]),H=$.data||[],q=z.data||[];H.sort((Ee,ee)=>new Date(ee.admitted_at||0)-new Date(Ee.admitted_at||0)),n(H);const G={};for(const Ee of q)G[Ee.id]=Ee;i(G);const re=[...new Set(H.map(Ee=>Ee.patient_id))].slice(0,100),ye={};await Promise.all(re.map(async Ee=>{try{const{data:ee}=await lv(Ee);ye[Ee]=(ee==null?void 0:ee.uhid)||`P-${Ee}`}catch{ye[Ee]=`P-${Ee}`}})),o(ye),v(1)}catch($){console.error("MyAdmissions loadData error",$),h(((V=(F=$==null?void 0:$.response)==null?void 0:F.data)==null?void 0:V.detail)||"Failed to load your admissions. Please try again."),n([]),i({}),o({})}finally{d(!1)}}};y.useEffect(()=>{if(!(t!=null&&t.id))return;let F=!0;return(async()=>await S())(),()=>{F=!1}},[t==null?void 0:t.id]);const k=y.useMemo(()=>{const F=f.trim().toLowerCase();return F?s.filter(V=>{var q;const $=w(V.id).toLowerCase(),z=(l[V.patient_id]||`P-${V.patient_id}`).toLowerCase(),H=(((q=a[V.current_bed_id])==null?void 0:q.code)||"").toLowerCase();return $.includes(F)||z.includes(F)||H.includes(F)}):s},[s,f,l,a]),A=Math.max(1,Math.ceil(k.length/fj));y.useEffect(()=>{v(1)},[f,s]);const T=(b-1)*fj,P=k.slice(T,T+fj),O=()=>v(F=>Math.max(1,F-1)),D=()=>v(F=>Math.min(A,F+1)),I=b<=1||c,M=b>=A||c,B=s.length;if(!(t!=null&&t.id))return r.jsx("div",{className:"min-h-screen bg-slate-50 px-4 py-6 text-sm text-slate-700 md:px-6",children:r.jsx("div",{className:"mx-auto max-w-3xl rounded-2xl border border-slate-200 bg-white p-4 shadow-sm",children:"You are not logged in or your user information is missing. Please log in again to view your admissions."})});const L=(t==null?void 0:t.full_name)||(t==null?void 0:t.name)||(t==null?void 0:t.username)||(t==null?void 0:t.email)||"you";return r.jsxs("div",{className:"min-h-screen bg-slate-50 px-4 py-4 text-black md:px-6 md:py-6",children:[r.jsxs("div",{className:"mx-auto mb-4 flex max-w-6xl flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl font-semibold tracking-tight text-slate-900",children:"My Admissions"}),r.jsxs("p",{className:"mt-1 max-w-2xl text-sm text-slate-600",children:["This view shows all"," ",r.jsx("span",{className:"font-semibold",children:"active in-patient admissions"})," ","where ",r.jsx("span",{className:"font-semibold",children:L})," is set as the primary doctor / practitioner. Use it to quickly jump into your patients' admission detail screens for orders, notes, vitals and discharge planning."]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[r.jsx(rn,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{className:"leading-tight",children:[r.jsx("span",{className:"font-medium text-slate-800",children:"Your in-patients"}),r.jsx("br",{}),"Assigned to you"]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[r.jsx(kn,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{className:"leading-tight",children:[r.jsx("span",{className:"font-medium text-slate-800",children:"Bed overview"}),r.jsx("br",{}),"Ward / room / bed"]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[r.jsx(lr,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{className:"leading-tight",children:[r.jsx("span",{className:"font-medium text-slate-800",children:"Admitted since"}),r.jsx("br",{}),"Length of stay"]})]})]})]}),r.jsxs("div",{className:"mx-auto max-w-6xl space-y-3",children:[r.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white p-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"w-full md:max-w-md",children:[r.jsxs("div",{className:"relative",children:[r.jsx(es,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),r.jsx("input",{className:"w-full rounded-2xl border border-slate-200 bg-white px-9 py-2 text-sm text-slate-900 placeholder:text-slate-400 outline-none transition focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Search by Admission no, UHID, Bed code",value:f,onChange:F=>x(F.target.value)})]}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Tip: Type an admission number (ADM-000123), UHID or bed code to quickly find a patient."})]}),r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 md:justify-end",children:[r.jsxs("div",{className:"text-xs text-slate-600",children:[r.jsx("span",{className:"font-semibold text-slate-900",children:k.length})," ","of ",B," active admissions assigned to you"]}),r.jsxs("button",{type:"button",onClick:S,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-60",disabled:c,children:[c?r.jsx(ns,{className:"h-3.5 w-3.5 animate-spin"}):r.jsx(Bi,{className:"h-3.5 w-3.5"}),"Refresh"]})]})]}),u&&r.jsxs("div",{className:"flex items-start gap-2 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[r.jsx(nn,{className:"mt-0.5 h-4 w-4"}),r.jsx("span",{children:u})]}),c&&!s.length&&r.jsx("div",{className:"flex items-center justify-center rounded-2xl border border-slate-200 bg-white px-4 py-10 text-sm text-slate-600 shadow-sm",children:r.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 px-3 py-1.5 text-xs",children:[r.jsx(ns,{className:"h-4 w-4 animate-spin text-slate-500"}),"Loading your admissions"]})}),!c&&P.length===0&&r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-4 py-8 text-center text-sm text-slate-500 shadow-sm",children:"No active admissions assigned to you."}),!c&&P.length>0&&r.jsxs("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm",children:[r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-slate-50 text-xs text-slate-500",children:[r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Admission"}),r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Patient (UHID)"}),r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Bed"}),r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Admitted at"}),r.jsx("th",{className:"px-4 py-2 text-right font-medium",children:"Action"})]})}),r.jsx("tbody",{children:P.map(F=>{const V=a[F.current_bed_id],$=(V==null?void 0:V.code)||"",z=l[F.patient_id]||`P-${F.patient_id}`;return r.jsxs("tr",{className:"border-t text-sm hover:bg-slate-50",children:[r.jsx("td",{className:"px-4 py-2 align-middle text-slate-900",children:r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2.5 py-0.5 text-[11px] font-semibold tracking-wide text-slate-800",children:w(F.id)})}),r.jsx("td",{className:"px-4 py-2 align-middle text-slate-800",children:z}),r.jsxs("td",{className:"px-4 py-2 align-middle text-slate-800",children:[$,(V==null?void 0:V.state)&&r.jsx("span",{className:`ml-1 inline-flex items-center rounded-full border px-1.5 py-0.5 text-[10px] ${_(V.state)}`,children:V.state})]}),r.jsx("td",{className:"px-4 py-2 align-middle text-slate-700",children:F.admitted_at?new Date(F.admitted_at).toLocaleString():""}),r.jsx("td",{className:"px-4 py-2 align-middle text-right",children:r.jsx(bl,{to:`/ipd/admission/${F.id}`,state:{admission:F},className:"inline-flex items-center rounded-full bg-slate-900 px-3 py-1.5 text-xs font-semibold text-white shadow-sm transition hover:bg-slate-800",children:"Open"})})]},F.id)})})]})}),r.jsx("div",{className:"space-y-2 p-3 md:hidden",children:P.map(F=>{const V=a[F.current_bed_id],$=(V==null?void 0:V.code)||"",z=l[F.patient_id]||`P-${F.patient_id}`;return r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs shadow-sm",children:[r.jsxs("div",{className:"mb-1 flex items-center justify-between gap-2",children:[r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-900 px-2.5 py-0.5 text-[11px] font-semibold tracking-wide text-white",children:w(F.id)}),r.jsx(bl,{to:`/ipd/admission/${F.id}`,state:{admission:F},className:"inline-flex items-center rounded-full bg-slate-900 px-3 py-1 text-[11px] font-semibold text-white shadow-sm transition hover:bg-slate-800",children:"Open"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2 text-slate-800",children:[r.jsx(rn,{className:"h-3.5 w-3.5 text-slate-500"}),r.jsx("span",{className:"font-medium",children:z})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-slate-800",children:[r.jsx(kn,{className:"h-3.5 w-3.5 text-slate-500"}),r.jsx("span",{className:"font-medium",children:$}),(V==null?void 0:V.state)&&r.jsx("span",{className:`inline-flex items-center rounded-full border px-1.5 py-0.5 text-[10px] ${_(V.state)}`,children:V.state})]}),r.jsxs("div",{className:"flex items-start gap-2 text-slate-700",children:[r.jsx(lr,{className:"mt-0.5 h-3.5 w-3.5 text-slate-500"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] text-slate-500",children:"Admitted at"}),r.jsx("div",{className:"text-[11px]",children:F.admitted_at?new Date(F.admitted_at).toLocaleString():""})]})]})]})]},F.id)})}),k.length>0&&r.jsxs("div",{className:"flex flex-col items-center justify-between gap-3 border-t border-slate-100 px-4 py-3 text-xs text-slate-600 sm:flex-row",children:[r.jsxs("button",{type:"button",onClick:O,disabled:I,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 font-medium shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",children:[r.jsx(zx,{className:"h-4 w-4"}),"Prev"]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Page"," ",r.jsx("span",{className:"font-medium text-slate-900",children:b})," ","of ",A]}),r.jsxs("button",{type:"button",onClick:D,disabled:M,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 font-medium shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",children:["Next",r.jsx(Om,{className:"h-4 w-4"})]})]})]})]})]})}const pj=10;function Lge(){const[t,s]=y.useState([]),[n,a]=y.useState({}),[i,l]=y.useState({}),[o,c]=y.useState(!1),[d,u]=y.useState(""),[h,f]=y.useState(""),[x,b]=y.useState(1),v=B=>`ADM-${String(B).padStart(6,"0")}`,w=async()=>{var B,L;c(!0),u("");try{const[F,V]=await Promise.all([iv({status:"discharged"}),Nl()]),$=F.data||[],z=V.data||[];$.sort((re,ye)=>new Date(ye.discharged_at||ye.admitted_at||0)-new Date(re.discharged_at||re.admitted_at||0)),s($);const H={};for(const re of z)H[re.id]=re;a(H);const q=[...new Set($.map(re=>re.patient_id))].slice(0,100),G={};await Promise.all(q.map(async re=>{try{const{data:ye}=await lv(re);G[re]=(ye==null?void 0:ye.uhid)||`P-${re}`}catch{G[re]=`P-${re}`}})),l(G),b(1)}catch(F){console.error("DischargedList loadData error",F),u(((L=(B=F==null?void 0:F.response)==null?void 0:B.data)==null?void 0:L.detail)||"Failed to load discharged admissions. Please try again."),s([]),a({}),l({})}finally{c(!1)}};y.useEffect(()=>{let B=!0;return(async()=>await w())(),()=>{B=!1}},[]);const _=y.useMemo(()=>{const B=h.trim().toLowerCase();return B?t.filter(L=>{var z;const F=v(L.id).toLowerCase(),V=(i[L.patient_id]||`P-${L.patient_id}`).toLowerCase(),$=(((z=n[L.current_bed_id])==null?void 0:z.code)||"").toLowerCase();return F.includes(B)||V.includes(B)||$.includes(B)}):t},[t,h,i,n]),S=Math.max(1,Math.ceil(_.length/pj));y.useEffect(()=>{b(1)},[h,t]);const k=(x-1)*pj,A=_.slice(k,k+pj),T=()=>b(B=>Math.max(1,B-1)),P=()=>b(B=>Math.min(S,B+1)),O=x<=1||o,D=x>=S||o,I=t.length,M=B=>B?B==="vacant"?"bg-emerald-50 text-emerald-700 border-emerald-200":B==="occupied"?"bg-rose-50 text-rose-700 border-rose-200":B==="reserved"?"bg-amber-50 text-amber-700 border-amber-200":B==="preoccupied"?"bg-sky-50 text-sky-700 border-sky-200":"bg-slate-50 text-slate-700 border-slate-200":"bg-slate-50 text-slate-700 border-slate-200";return r.jsxs("div",{className:"min-h-screen bg-slate-50 px-4 py-4 text-black md:px-6 md:py-6",children:[r.jsxs("div",{className:"mx-auto mb-4 flex max-w-6xl flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl font-semibold tracking-tight text-slate-900",children:"Discharged Patients"}),r.jsxs("p",{className:"mt-1 max-w-2xl text-sm text-slate-600",children:["This list shows all"," ",r.jsx("span",{className:"font-semibold",children:"completed in-patient admissions"})," ","that have been discharged. Use it for audit, reporting, medical record review, and follow-up planning. Search by admission number, patient UHID or bed code to quickly find a case."]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[r.jsx(rn,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{className:"leading-tight",children:[r.jsx("span",{className:"font-medium text-slate-800",children:"Discharged IP"}),r.jsx("br",{}),"Completed stays"]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[r.jsx(kn,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{className:"leading-tight",children:[r.jsx("span",{className:"font-medium text-slate-800",children:"Last bed"}),r.jsx("br",{}),"Ward / room / bed"]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[r.jsx(lr,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{className:"leading-tight",children:[r.jsx("span",{className:"font-medium text-slate-800",children:"LOS view"}),r.jsx("br",{}),"Admit vs discharge"]})]})]})]}),r.jsxs("div",{className:"mx-auto max-w-6xl space-y-3",children:[r.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white p-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"w-full md:max-w-md",children:[r.jsxs("div",{className:"relative",children:[r.jsx(es,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),r.jsx("input",{className:"w-full rounded-2xl border border-slate-200 bg-white px-9 py-2 text-sm text-slate-900 placeholder:text-slate-400 outline-none transition focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Search by Admission no, UHID, Bed code",value:h,onChange:B=>f(B.target.value)})]}),r.jsxs("p",{className:"mt-1 text-[11px] text-slate-500",children:["Tip: Example search  ",r.jsx("span",{className:"font-mono",children:"ADM-000245"}),","," ","a UHID, or a bed code like"," ",r.jsx("span",{className:"font-mono",children:"IP-2B-05"}),"."]})]}),r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 md:justify-end",children:[r.jsxs("div",{className:"text-xs text-slate-600",children:[r.jsx("span",{className:"font-semibold text-slate-900",children:_.length})," ","of ",I," discharged admissions"]}),r.jsxs("button",{type:"button",onClick:w,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-60",disabled:o,children:[o?r.jsx(ns,{className:"h-3.5 w-3.5 animate-spin"}):r.jsx(Bi,{className:"h-3.5 w-3.5"}),"Refresh"]})]})]}),d&&r.jsxs("div",{className:"flex items-start gap-2 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[r.jsx(nn,{className:"mt-0.5 h-4 w-4"}),r.jsx("span",{children:d})]}),o&&!t.length&&r.jsx("div",{className:"flex items-center justify-center rounded-2xl border border-slate-200 bg-white px-4 py-10 text-sm text-slate-600 shadow-sm",children:r.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 px-3 py-1.5 text-xs",children:[r.jsx(ns,{className:"h-4 w-4 animate-spin text-slate-500"}),"Loading discharged admissions"]})}),!o&&A.length===0&&r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-4 py-8 text-center text-sm text-slate-500 shadow-sm",children:"No discharged records found."}),!o&&A.length>0&&r.jsxs("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm",children:[r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-slate-50 text-xs text-slate-500",children:[r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Admission"}),r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Patient (UHID)"}),r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Bed"}),r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Admitted at"}),r.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Status"})]})}),r.jsx("tbody",{children:A.map(B=>{const L=n[B.current_bed_id],F=(L==null?void 0:L.code)||"",V=i[B.patient_id]||`P-${B.patient_id}`;return r.jsxs("tr",{className:"border-t text-sm hover:bg-slate-50",children:[r.jsx("td",{className:"px-4 py-2 align-middle text-slate-900",children:r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2.5 py-0.5 text-[11px] font-semibold tracking-wide text-slate-800",children:v(B.id)})}),r.jsx("td",{className:"px-4 py-2 align-middle text-slate-800",children:V}),r.jsxs("td",{className:"px-4 py-2 align-middle text-slate-800",children:[F,(L==null?void 0:L.state)&&r.jsx("span",{className:`ml-1 inline-flex items-center rounded-full border px-1.5 py-0.5 text-[10px] ${M(L.state)}`,children:L.state})]}),r.jsx("td",{className:"px-4 py-2 align-middle text-slate-700",children:B.admitted_at?new Date(B.admitted_at).toLocaleString():""}),r.jsx("td",{className:"px-4 py-2 align-middle text-slate-700",children:r.jsx("span",{className:"inline-flex items-center rounded-full bg-emerald-50 px-2.5 py-0.5 text-[11px] font-semibold text-emerald-700",children:B.status||"discharged"})})]},B.id)})})]})}),r.jsx("div",{className:"space-y-2 p-3 md:hidden",children:A.map(B=>{const L=n[B.current_bed_id],F=(L==null?void 0:L.code)||"",V=i[B.patient_id]||`P-${B.patient_id}`;return r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs shadow-sm",children:[r.jsxs("div",{className:"mb-1 flex items-center justify-between gap-2",children:[r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-900 px-2.5 py-0.5 text-[11px] font-semibold tracking-wide text-white",children:v(B.id)}),r.jsx("span",{className:"inline-flex items-center rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] font-semibold text-emerald-700",children:B.status||"discharged"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2 text-slate-800",children:[r.jsx(rn,{className:"h-3.5 w-3.5 text-slate-500"}),r.jsx("span",{className:"font-medium",children:V})]}),r.jsxs("div",{className:"flex items-center gap-2 text-slate-800",children:[r.jsx(kn,{className:"h-3.5 w-3.5 text-slate-500"}),r.jsx("span",{className:"font-medium",children:F}),(L==null?void 0:L.state)&&r.jsx("span",{className:`inline-flex items-center rounded-full border px-1.5 py-0.5 text-[10px] ${M(L.state)}`,children:L.state})]}),r.jsxs("div",{className:"flex items-start gap-2 text-slate-700",children:[r.jsx(lr,{className:"mt-0.5 h-3.5 w-3.5 text-slate-500"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] text-slate-500",children:"Admitted at"}),r.jsx("div",{className:"text-[11px]",children:B.admitted_at?new Date(B.admitted_at).toLocaleString():""})]})]})]})]},B.id)})}),_.length>0&&r.jsxs("div",{className:"flex flex-col items-center justify-between gap-3 border-t border-slate-100 px-4 py-3 text-xs text-slate-600 sm:flex-row",children:[r.jsxs("button",{type:"button",onClick:T,disabled:O,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 font-medium shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",children:[r.jsx(zx,{className:"h-4 w-4"}),"Prev"]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Page"," ",r.jsx("span",{className:"font-medium text-slate-900",children:x})," ","of ",S]}),r.jsxs("button",{type:"button",onClick:P,disabled:D,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 font-medium shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",children:["Next",r.jsx(Om,{className:"h-4 w-4"})]})]})]})]})]})}function Bge(){const[t,s]=y.useState([]),[n,a]=y.useState([]),[i,l]=y.useState([]),[o,c]=y.useState(!1),[d,u]=y.useState(""),[h,f]=y.useState(null),[x,b]=y.useState(""),[v,w]=y.useState(!1),[_,S]=y.useState(""),k=async()=>{var L,F;c(!0),u("");try{const[V,$,z]=await Promise.all([av(),Gx(),Nl()]);s(V.data||[]),a($.data||[]),l(z.data||[])}catch(V){u(((F=(L=V==null?void 0:V.response)==null?void 0:L.data)==null?void 0:F.detail)||"Failed to load bedboard.")}finally{c(!1)}};y.useEffect(()=>{k()},[]);const A=y.useMemo(()=>{const L={};return n.forEach(F=>{var V;(L[V=F.ward_id]||(L[V]=[])).push(F)}),L},[n]),T=y.useMemo(()=>{const L={};return i.forEach(F=>{var V;(L[V=F.room_id]||(L[V]=[])).push(F)}),L},[i]),P=({s:L})=>{const F=L==="vacant"?"bg-emerald-50 text-emerald-700 border-emerald-200":L==="occupied"?"bg-rose-50 text-rose-700 border-rose-200":L==="reserved"?"bg-amber-50 text-amber-700 border-amber-200":L==="preoccupied"?"bg-sky-50 text-sky-700 border-sky-200":"bg-slate-50 text-slate-700 border-slate-200";return r.jsx("span",{className:`inline-flex items-center rounded-full border px-2 py-0.5 text-[11px] capitalize ${F}`,children:L||"unknown"})},O=L=>L==="vacant"?"border-emerald-200 bg-emerald-50/60":L==="occupied"?"border-rose-200 bg-rose-50/70":L==="reserved"?"border-amber-200 bg-amber-50/70":L==="preoccupied"?"border-sky-200 bg-sky-50/70":"border-slate-200 bg-white",D=(L,F,V)=>{f({id:L,code:F,action:V,dt:"",note:""}),S("")},I=async()=>{var L,F;if(h){if(S(""),h.action==="reserved"&&!h.dt){S('Please select a "Reserved until" date & time.');return}try{w(!0);const V={state:h.action};h.action==="reserved"&&(V.reserved_until=h.dt?h.dt.length===16?`${h.dt}:00`:h.dt:null),h.note&&(V.note=h.note),await Nde(h.id,V),f(null),await k()}catch(V){S(((F=(L=V==null?void 0:V.response)==null?void 0:L.data)==null?void 0:F.detail)||"Failed to update bed state.")}finally{w(!1)}}},M=x.trim().toLowerCase(),B=y.useMemo(()=>{if(!M)return t.map(F=>F.id);const L=new Set;return t.forEach(F=>{var H,q;const V=((H=F.code)==null?void 0:H.toLowerCase().includes(M))||((q=F.name)==null?void 0:q.toLowerCase().includes(M)),$=A[F.id]||[];let z=V;$.forEach(G=>{const re=String(G.number||"").toLowerCase().includes(M)||String(G.type||"").toLowerCase().includes(M),Ee=(T[G.id]||[]).some(ee=>{var ce;const te=(ee.state||"").toLowerCase();return((ce=ee.code)==null?void 0:ce.toLowerCase().includes(M))||te.includes(M)});(re||Ee)&&(z=!0)}),z&&L.add(F.id)}),Array.from(L)},[M,t,A,T]);return r.jsxs("div",{className:"min-h-screen bg-slate-50 px-4 py-4 text-black md:px-6 md:py-6",children:[r.jsxs("div",{className:"mx-auto mb-4 flex max-w-6xl flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl font-semibold tracking-tight text-slate-900",children:"Bedboard"}),r.jsxs("p",{className:"mt-1 max-w-2xl text-sm text-slate-600",children:["Live overview of ",r.jsx("span",{className:"font-semibold",children:"IPD bed occupancy"})," ","by ward and room. Colours help you quickly spot which beds are vacant, occupied, reserved or preoccupied. Use the quick actions to reserve or vacate beds in real time."]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[11px] md:grid-cols-4",children:[r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-emerald-200 bg-emerald-50 px-2.5 py-1.5 shadow-sm",children:[r.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-500"}),r.jsxs("span",{className:"leading-tight text-emerald-800",children:[r.jsx("span",{className:"font-semibold",children:"Vacant"}),r.jsx("br",{}),"Ready to allocate"]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-rose-200 bg-rose-50 px-2.5 py-1.5 shadow-sm",children:[r.jsx("span",{className:"h-2 w-2 rounded-full bg-rose-500"}),r.jsxs("span",{className:"leading-tight text-rose-800",children:[r.jsx("span",{className:"font-semibold",children:"Occupied"}),r.jsx("br",{}),"Patient in bed"]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-amber-200 bg-amber-50 px-2.5 py-1.5 shadow-sm",children:[r.jsx("span",{className:"h-2 w-2 rounded-full bg-amber-500"}),r.jsxs("span",{className:"leading-tight text-amber-800",children:[r.jsx("span",{className:"font-semibold",children:"Reserved"}),r.jsx("br",{}),"Booked for patient"]})]}),r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-sky-200 bg-sky-50 px-2.5 py-1.5 shadow-sm",children:[r.jsx("span",{className:"h-2 w-2 rounded-full bg-sky-500"}),r.jsxs("span",{className:"leading-tight text-sky-800",children:[r.jsx("span",{className:"font-semibold",children:"Preoccupied"}),r.jsx("br",{}),"Pending admission"]})]})]})]}),r.jsxs("div",{className:"mx-auto max-w-6xl space-y-4",children:[r.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white p-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"w-full md:max-w-md",children:[r.jsxs("div",{className:"relative",children:[r.jsx(es,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),r.jsx("input",{className:"w-full rounded-2xl border border-slate-200 bg-white px-9 py-2 text-sm text-slate-900 placeholder:text-slate-400 outline-none transition focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Search by ward, room, bed code or state (vacant, occupied, reserved)",value:x,onChange:L=>b(L.target.value)})]}),r.jsxs("p",{className:"mt-1 text-[11px] text-slate-500",children:["Example: type ",r.jsx("span",{className:"font-mono",children:"VACANT"}),", ward code like"," ",r.jsx("span",{className:"font-mono",children:"W1"}),", or bed code like"," ",r.jsx("span",{className:"font-mono",children:"B-102"}),"."]})]}),r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 md:justify-end",children:[r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-slate-50 px-3 py-1.5 text-[11px] text-slate-700",children:[r.jsx(kn,{className:"h-3.5 w-3.5 text-slate-500"}),r.jsxs("span",{children:["Total beds:"," ",r.jsx("span",{className:"font-semibold text-slate-900",children:i.length})]})]}),r.jsxs("button",{type:"button",onClick:k,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-60",disabled:o,children:[o?r.jsx(ns,{className:"h-3.5 w-3.5 animate-spin"}):r.jsx(Bi,{className:"h-3.5 w-3.5"}),"Refresh"]})]})]}),d&&r.jsxs("div",{className:"flex items-start gap-2 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[r.jsx(nn,{className:"mt-0.5 h-4 w-4"}),r.jsx("span",{children:d})]}),o&&!i.length&&r.jsx("div",{className:"flex items-center justify-center rounded-2xl border border-slate-200 bg-white px-4 py-10 text-sm text-slate-600 shadow-sm",children:r.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 px-3 py-1.5 text-xs",children:[r.jsx(ns,{className:"h-4 w-4 animate-spin text-slate-500"}),"Loading bedboard"]})}),!o&&r.jsxs("div",{className:"space-y-4",children:[t.filter(L=>B.includes(L.id)).map(L=>r.jsxs("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm",children:[r.jsxs("div",{className:"flex items-center gap-2 border-b border-slate-100 bg-slate-50 px-3 py-2 text-sm font-semibold text-slate-900",children:[r.jsx(fa,{className:"h-4 w-4 text-slate-500"}),r.jsxs("span",{children:[L.code,"  ",L.name]})]}),(A[L.id]||[]).length===0?r.jsx("div",{className:"px-3 py-3 text-sm text-slate-500",children:"No rooms configured for this ward."}):(A[L.id]||[]).map(F=>{var $;const V=(T[F.id]||[]).filter(z=>{var q;if(!M)return!0;const H=(z.state||"").toLowerCase();return((q=z.code)==null?void 0:q.toLowerCase().includes(M))||H.includes(M)});return!V.length&&M&&!(String(F.number||"").toLowerCase().includes(M)||String(F.type||"").toLowerCase().includes(M))?null:r.jsxs("div",{className:"border-t border-slate-100 px-3 py-3",children:[r.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2 text-xs text-slate-600",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(R7,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsxs("span",{className:"font-medium",children:["Room ",F.number]}),r.jsxs("span",{className:"text-[11px] text-slate-500",children:[" ",F.type]})]}),r.jsxs("span",{className:"text-[11px] text-slate-500",children:["Beds: ",(($=T[F.id])==null?void 0:$.length)||0]})]}),V.length===0?r.jsx("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 px-3 py-3 text-xs text-slate-500",children:"No beds match your search in this room."}):r.jsx("div",{className:"flex flex-wrap gap-2",children:V.map(z=>r.jsxs("div",{className:`flex w-full flex-col justify-between rounded-2xl border px-3 py-2 text-xs shadow-sm transition hover:-translate-y-0.5 hover:shadow-md sm:w-[calc(50%-0.25rem)] lg:w-[calc(25%-0.375rem)] ${O(z.state)}`,children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("div",{className:"font-semibold text-slate-900",children:z.code}),r.jsx(P,{s:z.state})]}),z.note&&r.jsx("div",{className:"mt-1 text-[11px] text-slate-600 line-clamp-2",children:z.note}),z.reserved_until&&r.jsxs("div",{className:"mt-1 text-[11px] text-slate-500",children:["Reserved until:"," ",new Date(z.reserved_until).toLocaleString()]}),r.jsxs("div",{className:"mt-2 flex flex-wrap gap-1.5",children:[r.jsx("button",{type:"button",className:"inline-flex flex-1 items-center justify-center rounded-full bg-amber-50 px-2 py-1 text-[11px] font-medium text-amber-800 ring-1 ring-amber-200 hover:bg-amber-100",onClick:()=>D(z.id,z.code,"reserved"),children:"Reserve"}),r.jsx("button",{type:"button",className:"inline-flex flex-1 items-center justify-center rounded-full bg-sky-50 px-2 py-1 text-[11px] font-medium text-sky-800 ring-1 ring-sky-200 hover:bg-sky-100",onClick:()=>D(z.id,z.code,"preoccupied"),children:"Preoccupy"}),r.jsx("button",{type:"button",className:"inline-flex flex-1 items-center justify-center rounded-full bg-emerald-50 px-2 py-1 text-[11px] font-medium text-emerald-800 ring-1 ring-emerald-200 hover:bg-emerald-100",onClick:()=>D(z.id,z.code,"vacant"),children:"Vacate"})]})]},z.id))})]},F.id)})]},L.id)),!o&&B.length===0&&r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-4 py-8 text-center text-sm text-slate-500 shadow-sm",children:"No beds match your search. Try clearing the filter or searching with a different ward, room or bed code."})]})]}),h&&r.jsx("div",{className:"fixed inset-0 z-50 grid place-items-center bg-black/40 px-4",children:r.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white p-4 text-sm shadow-xl",children:[r.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Update bed state"}),r.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:[h.code,"  ",h.action]})]}),r.jsx(P,{s:h.action})]}),h.action==="reserved"&&r.jsxs("div",{className:"mt-2 space-y-1",children:[r.jsx("label",{className:"text-xs text-slate-500",children:"Reserved until"}),r.jsx("input",{type:"datetime-local",className:"input w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:h.dt,onChange:L=>f(F=>({...F,dt:L.target.value}))})]}),r.jsxs("div",{className:"mt-3 space-y-1",children:[r.jsx("label",{className:"text-xs text-slate-500",children:"Note (optional)"}),r.jsx("input",{className:"input w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Reason for change, patient reference, etc.",value:h.note,onChange:L=>f(F=>({...F,note:L.target.value}))})]}),_&&r.jsxs("div",{className:"mt-2 flex items-start gap-2 rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[r.jsx(nn,{className:"mt-0.5 h-4 w-4"}),r.jsx("span",{children:_})]}),r.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[r.jsx("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full bg-slate-100 px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-200",onClick:()=>f(null),disabled:v,children:"Cancel"}),r.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full bg-slate-900 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-slate-800 disabled:cursor-not-allowed disabled:opacity-60",onClick:I,disabled:v,children:[v?r.jsx(ns,{className:"h-3.5 w-3.5 animate-spin"}):r.jsx(Dn,{className:"h-3.5 w-3.5"}),"Save"]})]})]})})]})}function ax({patient:t,patientId:s,className:n=""}){const[a,i]=y.useState(t||null);y.useEffect(()=>{let u=!1;return!t&&s&&(async()=>{try{const{data:h}=await J.get(`/patients/${s}`);u||i(h)}catch{}})(),()=>{u=!0}},[t,s]);const l=(a==null?void 0:a.uhid)||"",o=(a==null?void 0:a.name)||(a!=null&&a.first_name?`${a.first_name} ${a.last_name||""}`.trim():""),c=a!=null&&a.id?`/patients?focus=${a.id}`:void 0,d=r.jsxs("span",{className:["inline-flex items-center gap-2 rounded-md border px-2 py-0.5 text-xs","bg-gray-50 border-gray-200 text-gray-700","max-w-[18rem]",n].join(" "),title:o!==""?o:void 0,children:[r.jsx("span",{className:"font-medium",children:l}),r.jsx("span",{className:"text-gray-400",children:""}),r.jsx("span",{className:"truncate",children:o})]});return c?r.jsx(bl,{to:c,children:d}):d}const Fge=t=>t?new Date(t).toLocaleString():"",$ge=t=>t?`LAB-${String(t).padStart(6,"0")}`:"";function zge(){const{id:t}=xd(),s=Va(),[n,a]=y.useState(!1),[i,l]=y.useState(null),[o,c]=y.useState([]),[d,u]=y.useState([]),[h,f]=y.useState([]),[x,b]=y.useState(!1),v=y.useMemo(()=>i?$ge(i.id):"",[i]),w=async()=>{a(!0);try{const{data:B}=await ife(t);l(B)}catch(B){console.error(B),se.error("Failed to load order")}finally{a(!1)}},_=async()=>{try{const{data:B}=await ofe({active_only:!0}),L=Array.isArray(B)?B:(B==null?void 0:B.items)||[];c(L)}catch(B){console.error(B),se.error("Failed to load lab departments")}};y.useEffect(()=>{w(),_()},[t]);const S=y.useMemo(()=>{const B=o.filter(F=>!F.parent_id),L={};return o.forEach(F=>{F.parent_id&&(L[F.parent_id]||(L[F.parent_id]=[]),L[F.parent_id].push(F))}),B.map(F=>({...F,children:L[F.id]||[]}))},[o]),k=y.useMemo(()=>i?(i.status||"").toLowerCase()!=="reported":!1,[i]),A=async()=>{var B,L;try{await lfe(t),se.success("Report finalized"),w()}catch(F){console.error(F),se.error(((L=(B=F==null?void 0:F.response)==null?void 0:B.data)==null?void 0:L.detail)||"Finalize failed")}},T=()=>{s(`/lab/orders/${t}/print`)},P=(B,L=null)=>{const F=`${B}::${L||"root"}`;return d.some(V=>V.key===F)},O=(B,L=null,F="",V=null)=>{const $=`${B}::${L||"root"}`;u(z=>z.some(q=>q.key===$)?z.filter(q=>q.key!==$):[...z,{key:$,department_id:B,department_name:F,sub_department_id:L,sub_department_name:V}])},D=async()=>{var B,L;if(!d.length){se.error("Select at least one Department / Panel");return}b(!0);try{const F=d.map(z=>cfe(t,{department_id:z.department_id,sub_department_id:z.sub_department_id||void 0}).then(H=>({panel:z,rows:Array.isArray(H.data)?H.data:[]}))),$=(await Promise.all(F)).map(({panel:z,rows:H})=>({key:z.key,department_id:z.department_id,department_name:z.department_name,sub_department_id:z.sub_department_id,sub_department_name:z.sub_department_name,rows:H.map(q=>({...q,result_value:q.result_value??"",flag:q.flag??"",comments:q.comments??""}))}));f($)}catch(F){console.error(F),se.error(((L=(B=F==null?void 0:F.response)==null?void 0:B.data)==null?void 0:L.detail)||"Failed to load panel services")}finally{b(!1)}},I=(B,L,F)=>{f(V=>V.map($=>$.key!==B?$:{...$,rows:$.rows.map((z,H)=>H===L?{...z,...F}:z)}))},M=async()=>{var B,L;if(!h.length){se.error("No panel rows loaded");return}try{for(const F of h){if(!F.rows.length)continue;const V={department_id:Number(F.department_id),sub_department_id:F.sub_department_id?Number(F.sub_department_id):null,results:F.rows.map($=>({service_id:$.service_id,result_value:$.result_value??"",flag:$.flag||null,comments:$.comments||null}))};await dfe(Number(t),V)}se.success("Panel results saved"),w()}catch(F){console.error(F),se.error(((L=(B=F==null?void 0:F.response)==null?void 0:B.data)==null?void 0:L.detail)||"Failed to save panel results")}};return n&&!i?r.jsx("div",{className:"p-6",children:"Loading"}):i?r.jsxs("div",{className:"p-3 md:p-6 space-y-6 text-black",children:[r.jsxs("header",{className:"flex flex-wrap items-start justify-between gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("h1",{className:"text-lg md:text-xl font-semibold",children:["Lab Order ",v]}),r.jsxs("div",{className:"text-xs text-gray-500 flex flex-wrap items-center gap-2",children:[r.jsx(ax,{patient:i==null?void 0:i.patient,patientId:i==null?void 0:i.patient_id,className:"border-blue-100 bg-blue-50"}),r.jsxs("span",{children:[" Created: ",Fge(i.created_at||i.createdAt)]})]}),r.jsxs("div",{className:"text-xs text-gray-500",children:["Priority:"," ",r.jsx("span",{className:"capitalize font-medium",children:i.priority||"routine"})," "," Status:"," ",r.jsx("span",{className:"uppercase font-semibold",children:i.status||"ORDERED"})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("button",{className:"btn-ghost flex items-center gap-1 text-xs md:text-sm",onClick:T,children:[r.jsx(gl,{className:"h-4 w-4"}),"View / Print Report"]}),r.jsx(Cn,{anyOf:["lab.results.report","lab.results.enter","lab.results.approve"],children:r.jsxs("button",{className:"btn",disabled:!k,onClick:A,children:[r.jsx(B3,{className:"h-4 w-4 mr-2"})," Finalize"]})})]})]}),r.jsxs("section",{className:"rounded-xl border bg-white overflow-hidden",children:[r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 p-4 border-b",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(L7,{className:"h-4 w-4 text-gray-500"}),r.jsxs("div",{children:[r.jsx("h2",{className:"font-semibold text-sm md:text-base",children:"Result Entry (Multi Department / Panel)"}),r.jsx("p",{className:"text-[11px] text-gray-500",children:"Select department/panel, enter all values, save, then finalize."})]})]}),r.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[r.jsxs("button",{className:"btn-ghost flex items-center gap-1",onClick:D,children:[r.jsx(dse,{className:"h-4 w-4"}),"Start Entry"]}),r.jsx(Cn,{anyOf:["lab.results.enter"],children:r.jsx("button",{className:"btn",onClick:M,disabled:!h.length,children:"Save Panel Results"})})]})]}),r.jsxs("div",{className:"p-4 border-b bg-slate-50",children:[r.jsx("h3",{className:"text-sm font-medium mb-1",children:"Select Departments & Panels"}),r.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Tick one or more Departments / Sub-Departments. All selected tests will appear below, grouped heading-wise."}),r.jsxs("div",{className:"max-h-64 overflow-y-auto rounded-lg border bg-white p-3 space-y-2",children:[S.length===0&&r.jsx("div",{className:"text-xs text-gray-400",children:"No lab departments configured."}),S.map(B=>r.jsxs("div",{className:"border rounded-lg p-2 bg-slate-50/60",children:[r.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:[r.jsx("input",{type:"checkbox",checked:P(B.id,null),onChange:()=>O(B.id,null,B.name,null)}),r.jsx("span",{children:B.name}),r.jsx("span",{className:"text-[11px] text-gray-400",children:"(All tests in this department)"})]}),!!B.children.length&&r.jsx("div",{className:"mt-2 pl-4 space-y-1",children:B.children.map(L=>r.jsxs("label",{className:"flex items-center gap-2 text-xs text-slate-700",children:[r.jsx("input",{type:"checkbox",checked:P(B.id,L.id),onChange:()=>O(B.id,L.id,B.name,L.name)}),r.jsx("span",{children:L.name})]},L.id))})]},B.id))]}),r.jsxs("div",{className:"mt-2 text-[11px] text-gray-500",children:["Selected panels:"," ",r.jsx("span",{className:"font-semibold",children:d.length||0})]})]}),x&&r.jsx("div",{className:"px-4 py-6 text-center text-sm text-gray-500",children:"Loading selected panels"}),!x&&h.length===0&&r.jsxs("div",{className:"px-4 py-6 text-center text-xs text-gray-400",children:["Select one or more Departments / Panels above and click"," ",r.jsx("span",{className:"font-medium",children:"Start Entry"})," to load tests."]}),!x&&h.map(B=>r.jsxs("div",{className:"border-t",children:[r.jsxs("div",{className:"bg-slate-100 px-3 py-2 text-xs font-semibold text-slate-700",children:[B.department_name,B.sub_department_name?` / ${B.sub_department_name}`:""]}),r.jsxs("div",{className:"md:hidden p-3 space-y-2",children:[B.rows.length===0&&r.jsx("div",{className:"text-xs text-gray-400",children:"No services configured for this panel."}),B.rows.map((L,F)=>r.jsxs("div",{className:"border rounded-lg p-2 space-y-1 bg-white",children:[r.jsx("div",{className:"text-xs font-semibold",children:L.service_name}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[11px] text-gray-600",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-[10px] uppercase text-gray-400",children:"Result"}),r.jsx("input",{className:"input h-7 text-xs",value:L.result_value,onChange:V=>I(B.key,F,{result_value:V.target.value})})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[10px] uppercase text-gray-400",children:"Flag"}),r.jsx("input",{className:"input h-7 text-xs",placeholder:"H/L/N",value:L.flag||"",onChange:V=>I(B.key,F,{flag:V.target.value.toUpperCase()})})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-[10px] uppercase text-gray-400",children:"Unit"}),r.jsx("div",{className:"text-[11px]",children:L.unit||""})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[10px] uppercase text-gray-400",children:"Normal Range"}),r.jsx("div",{className:"text-[11px]",children:L.normal_range||""})]})]})]}),r.jsxs("div",{className:"mt-1",children:[r.jsx("div",{className:"text-[10px] uppercase text-gray-400",children:"Comments"}),r.jsx("input",{className:"input h-7 text-xs",placeholder:"Comments",value:L.comments||"",onChange:V=>I(B.key,F,{comments:V.target.value})})]})]},L.service_id))]}),r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-gray-50 text-gray-600",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left",children:"Service"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Result"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Unit"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Normal Range"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Flag"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Comments"})]})}),r.jsxs("tbody",{children:[B.rows.map((L,F)=>r.jsxs("tr",{className:"border-t hover:bg-slate-50/80",children:[r.jsx("td",{className:"px-3 py-2",children:r.jsx("div",{className:"font-medium",children:L.service_name})}),r.jsx("td",{className:"px-3 py-2",children:r.jsx("input",{className:"input",value:L.result_value,onChange:V=>I(B.key,F,{result_value:V.target.value})})}),r.jsx("td",{className:"px-3 py-2 text-xs text-gray-600",children:L.unit||""}),r.jsx("td",{className:"px-3 py-2 text-xs text-gray-600",children:L.normal_range||""}),r.jsx("td",{className:"px-3 py-2",children:r.jsx("input",{className:"input",placeholder:"Flag (H/L/N)",value:L.flag||"",onChange:V=>I(B.key,F,{flag:V.target.value.toUpperCase()})})}),r.jsx("td",{className:"px-3 py-2",children:r.jsx("input",{className:"input",placeholder:"Comments",value:L.comments||"",onChange:V=>I(B.key,F,{comments:V.target.value})})})]},L.service_id)),B.rows.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-3 py-4 text-center text-xs text-gray-400",children:"No services configured for this panel."})})]})]})})]},B.key))]})]}):r.jsx("div",{className:"p-6",children:"Order not found"})}function Uge(){const[t,s]=y.useState(""),[n,a]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(null),[d,u]=y.useState(!1),h=async()=>{l(!0);try{const{data:_}=await Rk({q:t,page_size:200});a(_||[])}catch{se.error("Failed to load tests")}finally{l(!1)}};y.useEffect(()=>{h()},[t]);const f=()=>{c({code:"",name:"",price:0,is_active:!0}),u(!0)},x=_=>{c({..._}),u(!0)},b=async()=>{var _,S;try{o!=null&&o.id?(await rfe(o.id,o),se.success("Updated")):(await nfe(o),se.success("Created")),u(!1),h()}catch(k){se.error(((S=(_=k==null?void 0:k.response)==null?void 0:_.data)==null?void 0:S.detail)||"Save failed")}},v=async _=>{if(confirm("Delete this test?"))try{await afe(_),se.success("Deleted"),h()}catch{se.error("Delete failed")}},w=y.useMemo(()=>n.length,[n]);return r.jsxs("div",{className:"p-4 md:p-6 text-black",children:[r.jsxs("header",{className:"mb-4 flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl font-semibold",children:"Lab Masters"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Manage NABL-friendly test catalogue"})]}),r.jsx(Cn,{anyOf:["lab.masters.manage","masters.lab.manage"],children:r.jsxs("button",{className:"btn-primary",onClick:f,children:[r.jsx(ps,{className:"h-4 w-4 mr-2"})," New Test"]})})]}),r.jsx("div",{className:"mb-3",children:r.jsxs("div",{className:"relative max-w-md",children:[r.jsx(es,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),r.jsx("input",{className:"input pl-9",placeholder:"Search code/name",value:t,onChange:_=>s(_.target.value)})]})}),r.jsx("div",{className:"rounded-xl border bg-white",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-gray-50 text-gray-600",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left",children:"Code"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Name"}),r.jsx("th",{className:"px-3 py-2 text-right",children:"Price"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Active"}),r.jsx("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[i&&r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-3",colSpan:5,children:"Loading"})}),!i&&n.map(_=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-3 py-2",children:_.code}),r.jsx("td",{className:"px-3 py-2",children:_.name}),r.jsxs("td",{className:"px-3 py-2 text-right",children:["",Number(_.price||0).toFixed(2)]}),r.jsx("td",{className:"px-3 py-2",children:_.is_active?"Yes":"No"}),r.jsx("td",{className:"px-3 py-2 text-right",children:r.jsxs(Cn,{anyOf:["lab.masters.manage","masters.lab.manage"],children:[r.jsx("button",{className:"btn-ghost mr-2",onClick:()=>x(_),children:r.jsx(Fa,{className:"h-4 w-4"})}),r.jsx("button",{className:"btn-ghost text-red-600",onClick:()=>v(_.id),children:r.jsx(wr,{className:"h-4 w-4"})})]})})]},_.id)),!i&&n.length===0&&r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-6 text-center text-gray-500",colSpan:5,children:"No tests"})})]}),r.jsx("tfoot",{children:r.jsx("tr",{children:r.jsxs("td",{className:"px-3 py-2 text-xs text-gray-500",colSpan:5,children:["Total: ",w]})})})]})}),d&&r.jsxs("div",{className:"fixed inset-0 z-40",children:[r.jsx("div",{className:"absolute inset-0 bg-black/30",onClick:()=>u(!1)}),r.jsxs("div",{className:"absolute right-0 top-0 h-full w-full max-w-md bg-white shadow-xl p-4 overflow-y-auto",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4",children:o!=null&&o.id?"Edit Test":"New Test"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-sm",children:"Code"}),r.jsx("input",{className:"input",value:(o==null?void 0:o.code)||"",onChange:_=>c(S=>({...S,code:_.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm",children:"Name"}),r.jsx("input",{className:"input",value:(o==null?void 0:o.name)||"",onChange:_=>c(S=>({...S,name:_.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm",children:"Price"}),r.jsx("input",{type:"number",step:"0.01",className:"input",value:(o==null?void 0:o.price)??0,onChange:_=>c(S=>({...S,price:parseFloat(_.target.value||0)}))})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{id:"active",type:"checkbox",checked:!!(o!=null&&o.is_active),onChange:_=>c(S=>({...S,is_active:_.target.checked}))}),r.jsx("label",{htmlFor:"active",className:"text-sm",children:"Active"})]}),r.jsxs("div",{className:"flex justify-end gap-2 pt-3",children:[r.jsx("button",{className:"btn-ghost",onClick:()=>u(!1),children:"Cancel"}),r.jsx("button",{className:"btn-primary",onClick:b,children:"Save"})]})]})]})]})]})}function Yk({order:t,to:s,className:n="",prefix:a="LAB"}){const i=new Date((t==null?void 0:t.created_at)||(t==null?void 0:t.createdAt)||Date.now()),l=i.toISOString().slice(2,7).replace("-",""),o=Number((t==null?void 0:t.id)||0).toString(36).toUpperCase().padStart(3,"0"),c=`${a}-${l}-${o}`,d=(t==null?void 0:t.accession_no)||c,u=r.jsx("span",{className:["inline-flex items-center rounded-md border px-2 py-0.5 text-xs font-medium","bg-blue-50 border-blue-200 text-blue-700",n].join(" "),title:`Created ${i.toLocaleString()}`,children:d});return s?r.jsx(bl,{to:s,children:u}):u}function g1({status:t}){const s=String(t||"ordered").toLowerCase(),a={ordered:"bg-amber-50 text-amber-700 border-amber-200",collected:"bg-blue-50 text-blue-700 border-blue-200",validated:"bg-purple-50 text-purple-700 border-purple-200",reported:"bg-emerald-50 text-emerald-700 border-emerald-200",cancelled:"bg-rose-50 text-rose-700 border-rose-200"}[s]||"bg-gray-50 text-gray-700 border-gray-200";return r.jsx("span",{className:`inline-flex items-center rounded-md border px-2 py-0.5 text-xs font-medium ${a}`,children:s.charAt(0).toUpperCase()+s.slice(1)})}function bz({modality:t}){const s=String(t||"").toUpperCase(),a={XR:"bg-sky-50 text-sky-700 border-sky-200",CT:"bg-purple-50 text-purple-700 border-purple-200",MRI:"bg-indigo-50 text-indigo-700 border-indigo-200",USG:"bg-emerald-50 text-emerald-700 border-emerald-200",MAMMO:"bg-rose-50 text-rose-700 border-rose-200"}[s]||"bg-gray-50 text-gray-700 border-gray-200";return r.jsx("span",{className:`inline-flex items-center rounded-md border px-2 py-0.5 text-xs font-medium ${a}`,children:s||""})}function Av({value:t,onChange:s,label:n="Patient"}){const[a,i]=y.useState(""),[l,o]=y.useState([]),[c,d]=y.useState(!1),[u,h]=y.useState(null);y.useEffect(()=>{let x=!0;if(!a){o([]);return}return d(!0),jk(a).then(b=>{x&&o(b.data||[])}).catch(()=>{x&&o([])}).finally(()=>{x&&d(!1)}),()=>{x=!1}},[a]),y.useEffect(()=>{if(!t){h(null);return}const x=l.find(b=>b.id===t);x&&h(x)},[t,l]);const f=x=>{h(x),i(""),o([]),s==null||s(x.id,x)};return r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:n}),r.jsx("input",{className:"input",placeholder:"Search by name / UHID / phone",value:a,onChange:x=>i(x.target.value)}),c&&r.jsx("div",{className:"text-xs text-slate-500",children:"Searching"}),l.length>0&&r.jsx("div",{className:"max-h-48 overflow-auto rounded-xl border bg-white text-sm",children:l.map(x=>r.jsx("button",{type:"button",onClick:()=>f(x),className:"flex w-full items-center justify-between px-3 py-2 text-left hover:bg-slate-50",children:r.jsxs("div",{children:[r.jsxs("div",{className:"font-medium",children:[x.first_name," ",x.last_name]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID: ",x.uhid,"  ",x.phone]})]})},x.id))}),u&&r.jsxs("div",{className:"rounded-xl border bg-slate-50 px-3 py-2 text-xs text-slate-700",children:["Selected:"," ",r.jsxs("span",{className:"font-semibold",children:[u.first_name," ",u.last_name]})," "," UHID ",u.uhid,"  ",u.phone]})]})}function Vge({onClose:t,onCreated:s}){const[n,a]=y.useState(null),[i,l]=y.useState([]),[o,c]=y.useState(""),[d,u]=y.useState(!1),[h,f]=y.useState("routine"),[x,b]=y.useState("");y.useEffect(()=>{let w=!1;return(async()=>{const{data:S}=await Lk({q:o});w||l(Array.isArray(S)?S:(S==null?void 0:S.items)||[])})(),()=>{w=!0}},[o]);const v=async()=>{var w,_;if(!n)return se.error("Select a patient");if(!x)return se.error("Select a test");u(!0);try{const{data:S}=await r$({patient_id:n,test_id:Number(x),priority:h});se.success(`Order #${S==null?void 0:S.id} created`),s==null||s(S),t==null||t()}catch(S){se.error(((_=(w=S==null?void 0:S.response)==null?void 0:w.data)==null?void 0:_.detail)||"Failed to create order")}finally{u(!1)}};return r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Create Radiology Order"}),r.jsx(Av,{value:n,onChange:a}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"md:col-span-2 space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:"Test"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{className:"input",placeholder:"Search tests",value:o,onChange:w=>c(w.target.value)}),r.jsxs("select",{className:"input",value:x,onChange:w=>b(w.target.value),children:[r.jsx("option",{value:"",children:"Select"}),i.map(w=>r.jsxs("option",{value:w.id,children:[w.code,"  ",w.name," ",w.modality?`(${w.modality})`:""]},w.id))]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:"Priority"}),r.jsxs("select",{className:"input",value:h,onChange:w=>f(w.target.value),children:[r.jsx("option",{value:"routine",children:"Routine"}),r.jsx("option",{value:"urgent",children:"Urgent"}),r.jsx("option",{value:"stat",children:"STAT"})]})]})]}),r.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[r.jsx("button",{className:"btn-ghost",onClick:t,children:"Cancel"}),r.jsx("button",{className:"btn",onClick:v,disabled:d,children:d?"Creating":"Create Order"})]})]})}function Hge({open:t,onClose:s,children:n}){return t?r.jsxs("div",{className:"fixed inset-0 z-[100] grid place-items-center bg-black/40 p-4",children:[r.jsx("div",{className:"w-full max-w-3xl rounded-2xl bg-white p-4 shadow-2xl",children:n}),r.jsx("button",{className:"absolute inset-0 -z-10",onClick:s,"aria-label":"Close"})]}):null}function Wge(){const[t,s]=y.useState([]),[n,a]=y.useState(!0),[i,l]=y.useState(""),[o,c]=y.useState(!1);return y.useEffect(()=>{let d=!1;return(async()=>{var h,f;a(!0);try{const{data:x}=await a$({q:i});d||s(Array.isArray(x)?x:[])}catch(x){se.error(((f=(h=x==null?void 0:x.response)==null?void 0:h.data)==null?void 0:f.detail)||"Failed to load orders")}finally{d||a(!1)}})(),()=>{d=!0}},[i]),r.jsxs("div",{className:"space-y-5 text-black",children:[r.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl font-semibold",children:"Radiology Orders"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Book, track, scan and report."})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{className:"input w-60",placeholder:"Search test, UHID or name",value:i,onChange:d=>l(d.target.value)}),r.jsx(Cn,{anyOf:["orders.ris.create","radiology.orders.create"],children:r.jsxs("button",{className:"btn",onClick:()=>c(!0),children:[r.jsx(ps,{className:"h-4 w-4 mr-2"})," New Order"]})})]})]}),r.jsx("div",{className:"rounded-xl border bg-white",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-gray-50 text-gray-600",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left",children:"Order"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Patient"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Modality"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Priority"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Status"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Created"}),r.jsx("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[n&&r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-3",colSpan:7,children:"Loading"})}),!n&&t.map(d=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-3 py-2",children:r.jsx(Yk,{order:d,to:`/ris/orders/${d.id}`,prefix:"RAD"})}),r.jsx("td",{className:"px-3 py-2",children:r.jsx(ax,{patientId:d.patient_id})}),r.jsx("td",{className:"px-3 py-2",children:r.jsx(bz,{modality:d.modality})}),r.jsx("td",{className:"px-3 py-2 capitalize",children:d.priority||"routine"}),r.jsx("td",{className:"px-3 py-2",children:r.jsx(g1,{status:d.status})}),r.jsx("td",{className:"px-3 py-2",children:new Date(d.created_at).toLocaleString()}),r.jsx("td",{className:"px-3 py-2 text-right",children:r.jsx(bl,{to:`/ris/orders/${d.id}`,className:"btn-ghost",children:"View"})})]},d.id)),!n&&t.length===0&&r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-6 text-center text-gray-500",colSpan:7,children:"No orders"})})]})]})}),r.jsx(Hge,{open:o,onClose:()=>c(!1),children:r.jsx(Vge,{onClose:()=>c(!1),onCreated:()=>c(!1)})})]})}function qge({t,onEdit:s,onDelete:n}){return r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-3 py-2",children:t.code}),r.jsx("td",{className:"px-3 py-2",children:t.name}),r.jsx("td",{className:"px-3 py-2",children:t.modality||""}),r.jsx("td",{className:"px-3 py-2",children:Number(t.price||0).toFixed(2)}),r.jsx("td",{className:"px-3 py-2 text-right",children:r.jsxs(Cn,{anyOf:["radiology.masters.manage","masters.ris.manage"],children:[r.jsx("button",{className:"btn-ghost mr-2",onClick:()=>s(t),children:"Edit"}),r.jsx("button",{className:"btn-ghost text-rose-600",onClick:()=>n(t),children:"Delete"})]})})]})}function Gge(){const[t,s]=y.useState([]),[n,a]=y.useState(!0),[i,l]=y.useState(""),[o,c]=y.useState({code:"",name:"",modality:"",price:0}),[d,u]=y.useState(null),h=async()=>{var v,w;a(!0);try{const{data:_}=await Lk({q:i,page_size:100});s(Array.isArray(_)?_:(_==null?void 0:_.items)||[])}catch(_){se.error(((w=(v=_==null?void 0:_.response)==null?void 0:v.data)==null?void 0:w.detail)||"Failed to load")}finally{a(!1)}};y.useEffect(()=>{h()},[i]);const f=async()=>{var v,w;try{d?(await mfe(d,o),se.success("Updated")):(await hfe(o),se.success("Created")),c({code:"",name:"",modality:"",price:0}),u(null),h()}catch(_){se.error(((w=(v=_==null?void 0:_.response)==null?void 0:v.data)==null?void 0:w.detail)||"Save failed")}},x=v=>{u(v.id),c({code:v.code,name:v.name,modality:v.modality||"",price:v.price||0})},b=async v=>{var w,_;if(window.confirm(`Delete ${v.code}?`))try{await ffe(v.id),se.success("Deleted"),h()}catch(S){se.error(((_=(w=S==null?void 0:S.response)==null?void 0:w.data)==null?void 0:_.detail)||"Delete failed")}};return r.jsxs("div",{className:"space-y-5 text-black",children:[r.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl font-semibold",children:"RIS Masters"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Manage radiology tests & modalities."})]}),r.jsx("input",{className:"input w-60",placeholder:"Search code/name",value:i,onChange:v=>l(v.target.value)})]}),r.jsx(Cn,{anyOf:["radiology.masters.manage","masters.ris.manage"],children:r.jsxs("div",{className:"rounded-2xl border bg-white p-4",children:[r.jsx("h3",{className:"text-sm font-semibold mb-3",children:d?"Edit Test":"New Test"}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[r.jsx("input",{className:"input",placeholder:"Code",value:o.code,onChange:v=>c(w=>({...w,code:v.target.value}))}),r.jsx("input",{className:"input",placeholder:"Name",value:o.name,onChange:v=>c(w=>({...w,name:v.target.value}))}),r.jsx("input",{className:"input",placeholder:"Modality (XR/CT/MRI/USG)",value:o.modality,onChange:v=>c(w=>({...w,modality:v.target.value}))}),r.jsx("input",{className:"input",placeholder:"Price",type:"number",step:"0.01",value:o.price,onChange:v=>c(w=>({...w,price:v.target.value}))})]}),r.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[r.jsx("button",{className:"btn",onClick:f,children:d?"Update":"Create"}),d&&r.jsx("button",{className:"btn-ghost",onClick:()=>{u(null),c({code:"",name:"",modality:"",price:0})},children:"Cancel"})]})]})}),r.jsx("div",{className:"rounded-xl border bg-white",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-gray-50 text-gray-600",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left",children:"Code"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Name"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Modality"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Price"}),r.jsx("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[n&&r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-3",colSpan:5,children:"Loading"})}),!n&&t.map(v=>r.jsx(qge,{t:v,onEdit:x,onDelete:b},v.id)),!n&&t.length===0&&r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-6 text-center text-gray-500",colSpan:5,children:"No tests"})})]})]})})]})}const xc=t=>t?new Date(t).toLocaleString():"";function Kge(){const{id:t}=xd(),[s,n]=y.useState(null),[a,i]=y.useState(!0),[l,o]=y.useState(""),[c,d]=y.useState(""),[u,h]=y.useState(!1),[f,x]=y.useState([]),b=async()=>{var T,P;i(!0);try{const{data:O}=await pfe(t);n(O),d((O==null?void 0:O.report_text)||"")}catch(O){se.error(((P=(T=O==null?void 0:O.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to load order")}finally{i(!1)}};y.useEffect(()=>{b()},[t]);const v=async()=>{var T,P;if(!l)return se.error("Pick a date & time");try{await xfe(s.id,{scheduled_at:l}),se.success("Scheduled"),b()}catch(O){se.error(((P=(T=O==null?void 0:O.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to schedule")}},w=async()=>{var T,P;try{await gfe(s.id),se.success("Marked scanned"),b()}catch(O){se.error(((P=(T=O==null?void 0:O.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to mark scanned")}},_=async()=>{var T,P;h(!0);try{s.status==="reported"||s.status==="approved"?await bfe(s.id,{report_text:c}):await yfe(s.id,{report_text:c}),se.success("Report saved"),b()}catch(O){se.error(((P=(T=O==null?void 0:O.response)==null?void 0:T.data)==null?void 0:P.detail)||"Failed to save report")}finally{h(!1)}},S=async()=>{var T,P;try{await vfe(s.id),se.success("Report approved"),b()}catch(O){se.error(((P=(T=O==null?void 0:O.response)==null?void 0:T.data)==null?void 0:P.detail)||"Approval failed")}},k=async T=>{var O,D,I;const P=(O=T.target.files)==null?void 0:O[0];if(P)try{const{data:M}=await wfe(s.id,P);x(B=>[{file_url:M==null?void 0:M.file_url,note:P.name},...B]),se.success("Attachment uploaded")}catch(M){se.error(((I=(D=M==null?void 0:M.response)==null?void 0:D.data)==null?void 0:I.detail)||"Upload failed")}finally{T.target.value=""}},A=async()=>{var P,O;const T=prompt("Paste file URL");if(T)try{const{data:D}=await Nfe(s.id,T,"Link");x(I=>[{file_url:(D==null?void 0:D.file_url)||T,note:"Link"},...I]),se.success("Attachment linked")}catch(D){se.error(((O=(P=D==null?void 0:D.response)==null?void 0:P.data)==null?void 0:O.detail)||"Link failed")}};return a?r.jsx("div",{children:"Loading"}):s?r.jsxs("div",{className:"space-y-6 text-black",children:[r.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs("h1",{className:"text-xl font-semibold",children:["Radiology Order ",r.jsx(Yk,{order:s,prefix:"RAD"})]}),r.jsxs("div",{className:"text-xs text-gray-500",children:["Patient: ",r.jsx(ax,{patientId:s.patient_id}),"  Created: ",xc(s.created_at)]}),r.jsxs("div",{className:"text-xs text-gray-500",children:["Modality: ",r.jsx(bz,{modality:s.modality}),"  Status: ",r.jsx(g1,{status:s.status})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Cn,{anyOf:["radiology.report.create"],children:r.jsx("button",{className:"btn",onClick:_,disabled:u,children:u?"Saving":"Save Report"})}),r.jsx(Cn,{anyOf:["radiology.report.approve"],children:r.jsxs("button",{className:"btn",onClick:S,children:[r.jsx(B3,{className:"h-4 w-4 mr-2"})," Approve"]})})]})]}),r.jsxs("section",{className:"rounded-2xl border bg-white p-4 space-y-4",children:[r.jsx("h2",{className:"text-sm font-semibold",children:"Workflow"}),r.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[r.jsxs("div",{className:"rounded-xl border p-3",children:[r.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[r.jsx(Ba,{className:"h-4 w-4"})," Schedule"]}),r.jsxs("div",{className:"mt-2 space-y-2",children:[r.jsx("input",{type:"datetime-local",className:"input w-full",value:l,onChange:T=>o(T.target.value)}),r.jsx(Cn,{anyOf:["radiology.schedule.manage"],children:r.jsx("button",{className:"btn w-full",onClick:v,children:"Book Slot"})}),r.jsxs("div",{className:"text-xs text-gray-500",children:["Current: ",xc(s.scheduled_at)]})]})]}),r.jsxs("div",{className:"rounded-xl border p-3",children:[r.jsx("div",{className:"flex items-center gap-2 font-medium",children:"Scan"}),r.jsxs("div",{className:"mt-2 grid gap-2",children:[r.jsx(Cn,{anyOf:["radiology.scan.update"],children:r.jsx("button",{className:"btn w-full",onClick:w,children:"Mark Scanned"})}),r.jsxs("div",{className:"text-xs text-gray-500",children:["Scanned: ",xc(s.scanned_at)]})]})]}),r.jsxs("div",{className:"rounded-xl border p-3",children:[r.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[r.jsx(I_,{className:"h-4 w-4"})," Attachments"]}),r.jsxs("div",{className:"mt-2 grid gap-2",children:[r.jsx("input",{type:"file",onChange:k}),r.jsx("button",{className:"btn-ghost text-left",onClick:A,children:"Add link"}),r.jsxs("div",{className:"mt-2 space-y-1",children:[f.map((T,P)=>r.jsx("a",{href:T.file_url,className:"text-xs text-blue-700 underline",target:"_blank",rel:"noreferrer",children:T.note||T.file_url},P)),f.length===0&&r.jsx("div",{className:"text-xs text-gray-500",children:"No attachments (local list)"})]})]})]})]})]}),r.jsxs("section",{className:"rounded-2xl border bg-white p-4 space-y-3",children:[r.jsx("h2",{className:"text-sm font-semibold",children:"Report"}),r.jsx("textarea",{className:"input min-h-[200px]",placeholder:"Enter radiology report text",value:c,onChange:T=>d(T.target.value)}),r.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs text-gray-600",children:[r.jsxs("div",{children:["Ordered: ",xc(s.created_at)]}),r.jsxs("div",{children:["Scheduled: ",xc(s.scheduled_at)]}),r.jsxs("div",{children:["Scanned: ",xc(s.scanned_at)]}),r.jsxs("div",{children:["Reported: ",xc(s.reported_at)]}),r.jsxs("div",{children:["Approved: ",xc(s.approved_at)]})]})]})]}):r.jsx("div",{className:"text-sm text-gray-500",children:"Order not found"})}function Yge(t){return J.post("/billing/invoices",t)}function Xge(t){return J.get(`/billing/invoices/${t}`)}function Qge(t={}){return J.get("/billing/invoices",{params:t})}function Zge(t,s){return J.put(`/billing/invoices/${t}`,s)}function Jge(t){return J.post(`/billing/invoices/${t}/finalize`)}function eye(t){return J.post(`/billing/invoices/${t}/cancel`)}function zI(t,s){return J.post(`/billing/invoices/${t}/items/manual`,s)}function tye(t,s,n){return J.put(`/billing/invoices/${t}/items/${s}`,n)}function sye(t,s,n){return J.post(`/billing/invoices/${t}/items/${s}/void`,n)}function nye(t,s){return J.post(`/billing/invoices/${t}/payments`,s)}function rye(t,s){return J.delete(`/billing/invoices/${t}/payments/${s}`)}function aye(t,s={}){return J.post(`/billing/invoices/${t}/apply-advances`,s)}function Xk(){return J.get("/billing/masters")}function iye(t){return J.get(`/billing/patients/${t}/summary`)}function lye(t){return J.get(`/billing/invoices/${t}/print`,{responseType:"blob"})}function oye(t){return J.get(`/billing/patients/${t}/print-summary`,{responseType:"blob"})}function Jn(t){return Number(t||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}function cye(){var Ns,ds;const{invoiceId:t}=xd(),s=Va(),[n,a]=y.useState(null),[i,l]=y.useState({doctors:[],credit_providers:[],packages:[],payers:[],tpas:[],credit_plans:[]}),[o,c]=y.useState(!0),[d,u]=y.useState(!1),[h,f]=y.useState({}),[x,b]=y.useState(!1),[v,w]=y.useState({description:"",quantity:1,unit_price:"",tax_rate:0,discount_percent:0,discount_amount:""}),[_,S]=y.useState(null),[k,A]=y.useState({description:"",quantity:1,unit_price:"",tax_rate:0,discount_percent:0,discount_amount:""}),[T,P]=y.useState(!1),[O,D]=y.useState({amount:"",mode:"cash",reference_no:"",notes:""}),[I,M]=y.useState(!1),[B,L]=y.useState(""),[F,V]=y.useState(""),[$,z]=y.useState(null),[H,q]=y.useState(!1),G=(n==null?void 0:n.status)==="finalized"||(n==null?void 0:n.status)==="cancelled";y.useEffect(()=>{re()},[]),y.useEffect(()=>{t&&Ee()},[t]);async function re(){try{const{data:ie}=await Xk();l({doctors:(ie==null?void 0:ie.doctors)||[],credit_providers:(ie==null?void 0:ie.credit_providers)||[],packages:(ie==null?void 0:ie.packages)||[],payers:(ie==null?void 0:ie.payers)||[],tpas:(ie==null?void 0:ie.tpas)||[],credit_plans:(ie==null?void 0:ie.credit_plans)||[]})}catch(ie){console.error("Failed to load masters",ie)}}async function ye(ie){if(ie){q(!0);try{const{data:Ie}=await iye(ie);z(Ie)}catch(Ie){console.error("Failed to load patient billing summary",Ie)}finally{q(!1)}}}async function Ee(){c(!0),V("");try{const{data:ie}=await Xge(t);a(ie),f({billing_type:ie.billing_type||"general",consultant_id:ie.consultant_id||"",provider_id:ie.provider_id||"",visit_no:ie.visit_no||"",remarks:ie.remarks||"",header_discount_percent:ie.header_discount_percent??"",header_discount_amount:ie.header_discount_amount??"",discount_remarks:ie.discount_remarks||""}),await ye(ie.patient_id)}catch(ie){console.error("Failed to load invoice",ie),V("Unable to load invoice. Please go back and try again.")}finally{c(!1)}}function ee(ie){const{name:Ie,value:he}=ie.target;f(Me=>({...Me,[Ie]:he}))}async function te(){if(n){u(!0),V("");try{const ie={billing_type:h.billing_type||null,consultant_id:h.consultant_id?Number(h.consultant_id):null,provider_id:h.provider_id?Number(h.provider_id):null,visit_no:h.visit_no||null,remarks:h.remarks||null,header_discount_percent:h.header_discount_percent!==""&&h.header_discount_percent!==null?Number(h.header_discount_percent):null,header_discount_amount:h.header_discount_amount!==""&&h.header_discount_amount!==null?Number(h.header_discount_amount):null,discount_remarks:h.discount_remarks||null},{data:Ie}=await Zge(n.id,ie);a(Ie),f(he=>({...he,header_discount_percent:Ie.header_discount_percent??"",header_discount_amount:Ie.header_discount_amount??""}))}catch(ie){console.error("Save header failed",ie),V("Unable to save header details.")}finally{u(!1)}}}function ce(ie){const{name:Ie,value:he}=ie.target;w(Me=>({...Me,[Ie]:Ie==="quantity"||Ie==="tax_rate"||Ie==="discount_percent"?Number(he):he}))}async function ge(ie){if(ie.preventDefault(),!!n){V("");try{const Ie={description:v.description||"",quantity:v.quantity||1,unit_price:Number(v.unit_price||0),tax_rate:Number(v.tax_rate||0),discount_percent:Number(v.discount_percent||0),discount_amount:v.discount_amount!==""?Number(v.discount_amount||0):void 0},{data:he}=await zI(n.id,Ie);a(he),b(!1),w({description:"",quantity:1,unit_price:"",tax_rate:0,discount_percent:0,discount_amount:""})}catch(Ie){console.error("Add manual item failed",Ie),V("Unable to add manual item. Please check values.")}}}function X(ie){S(ie.id),A({description:ie.description||"",quantity:ie.quantity||1,unit_price:String(ie.unit_price||""),tax_rate:Number(ie.tax_rate||0),discount_percent:Number(ie.discount_percent||0),discount_amount:ie.discount_amount!==null&&ie.discount_amount!==void 0?String(ie.discount_amount):""})}function de(ie){const{name:Ie,value:he}=ie.target;A(Me=>({...Me,[Ie]:Ie==="quantity"||Ie==="tax_rate"||Ie==="discount_percent"?Number(he):he}))}async function Ce(ie){if(ie.preventDefault(),!(!n||!_))try{const Ie={description:k.description||"",quantity:k.quantity||1,unit_price:Number(k.unit_price||0),tax_rate:Number(k.tax_rate||0),discount_percent:Number(k.discount_percent||0),discount_amount:k.discount_amount!==""?Number(k.discount_amount||0):void 0},{data:he}=await tye(n.id,_,Ie);a(he),S(null)}catch(Ie){console.error("Update item failed",Ie),V("Unable to update item.")}}async function ue(ie){if(!(!n||!window.confirm("Void this line item?")))try{const{data:he}=await sye(n.id,ie.id,{reason:"Voided from UI"});a(he)}catch(he){console.error("Void item failed",he),V("Unable to void item.")}}function fe(ie){const{name:Ie,value:he}=ie.target;D(Me=>({...Me,[Ie]:he}))}async function pe(ie){if(ie.preventDefault(),!!n){V("");try{let Ie=Number(O.amount||0);I&&(Ie=-Math.abs(Ie));const he={amount:Ie,mode:I?"refund":O.mode,reference_no:O.reference_no||null,notes:O.notes||null},{data:Me}=await nye(n.id,he);a(Me),P(!1),M(!1),D({amount:"",mode:"cash",reference_no:"",notes:""})}catch(Ie){console.error("Add payment/refund failed",Ie),V("Unable to save payment / refund.")}}}async function oe(ie){if(!(!n||!window.confirm("Delete this payment?")))try{const{data:he}=await rye(n.id,ie.id);a(he)}catch(he){console.error("Delete payment failed",he),V("Unable to delete payment.")}}async function qe(){if(n){L("advance"),V("");try{const{data:ie}=await aye(n.id,{});a(ie)}catch(ie){console.error("Apply advances failed",ie),V("Unable to apply advances.")}finally{L("")}}}async function Xe(){if(!(!n||!window.confirm("Finalize this invoice? You cannot edit items later."))){L("finalize"),V("");try{const{data:Ie}=await Jge(n.id);a(Ie)}catch(Ie){console.error("Finalize failed",Ie),V("Unable to finalize invoice.")}finally{L("")}}}async function jt(){if(!(!n||!window.confirm("Cancel this invoice?"))){L("cancel"),V("");try{await eye(n.id),await Ee()}catch(Ie){console.error("Cancel failed",Ie),V("Unable to cancel invoice.")}finally{L("")}}}async function ft(){if(n)try{const ie=await lye(n.id),Ie=new Blob([ie.data],{type:ie.headers["content-type"]||"application/pdf"}),he=URL.createObjectURL(Ie);window.open(he,"_blank","noopener")}catch(ie){console.error("Print failed",ie),V("Unable to open invoice print view.")}}async function it(){if(n)try{const ie=await oye(n.patient_id),Ie=new Blob([ie.data],{type:ie.headers["content-type"]||"application/pdf"}),he=URL.createObjectURL(Ie);window.open(he,"_blank","noopener")}catch(ie){console.error("Patient summary print failed",ie),V("Unable to open patient billing summary.")}}function _t(){M(!0),P(!0)}function ve(){M(!1),P(!0)}function ae(ie){if(!n||!ie)return;const Ie=i.packages.find(Me=>String(Me.id)===String(ie));if(!Ie)return;const he={description:`Package: ${Ie.name}`,quantity:1,unit_price:Number(Ie.charges||0),tax_rate:0,discount_percent:0};zI(n.id,he).then(({data:Me})=>a(Me)).catch(Me=>{console.error("Add package charge failed",Me),V("Unable to add package charge.")})}const xe=i.packages||[],je=(n==null?void 0:n.status)==="finalized"?"bg-green-100 text-green-800":(n==null?void 0:n.status)==="cancelled"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800",Fe=(n==null?void 0:n.payments)||[],Ct=(n==null?void 0:n.items)||[],vt=y.useMemo(()=>Fe.filter(ie=>Number(ie.amount||0)>=0),[Fe]),pt=y.useMemo(()=>Fe.filter(ie=>Number(ie.amount||0)<0),[Fe]);return o?r.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 md:px-6 py-4",children:r.jsx("div",{className:"max-w-5xl mx-auto text-xs text-slate-500",children:"Loading invoice..."})}):n?r.jsxs("div",{className:"min-h-[calc(100vh-4rem)] bg-gradient-to-b from-slate-50 via-slate-100 to-slate-50 px-3 md:px-6 pb-20 md:pb-4 pt-4",children:[r.jsxs("div",{className:"max-w-5xl mx-auto space-y-4",children:[r.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{type:"button",onClick:()=>s("/billing"),className:"text-xs text-slate-500 hover:text-slate-700",children:" Billing Console"}),r.jsx("span",{className:"text-xs text-slate-400",children:"/"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("h1",{className:"text-sm md:text-base font-semibold text-slate-900",children:["Invoice #",n.invoice_number||n.id]}),r.jsx("span",{className:`inline-flex rounded-full px-2.5 py-0.5 text-[10px] font-medium ${je}`,children:n.status})]})]}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsx("button",{type:"button",onClick:ft,className:"text-xs rounded-full border border-slate-300 px-3 py-1.5 text-slate-700 bg-white hover:bg-slate-50 shadow-sm",children:"Print Invoice"})})]}),F&&r.jsx("div",{className:"rounded-md bg-red-50 px-3 py-2 text-xs text-red-700",children:F}),r.jsxs("div",{className:"rounded-2xl border border-indigo-100 bg-gradient-to-r from-indigo-50 via-sky-50 to-purple-50 p-3 md:p-4 shadow-sm flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("div",{className:"text-xs font-semibold text-slate-800",children:"Patient Credit Overview"}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Patient ID: ",r.jsxs("span",{className:"font-medium",children:["#",n.patient_id]})]}),($==null?void 0:$.patient)&&r.jsxs("div",{className:"text-[11px] text-slate-600",children:[$.patient.uhid&&r.jsxs(r.Fragment,{children:["UHID:"," ",r.jsx("span",{className:"font-medium",children:$.patient.uhid})," ",""," "]}),($.patient.first_name||$.patient.last_name)&&r.jsxs(r.Fragment,{children:[$.patient.first_name," ",$.patient.last_name," "," "]}),$.patient.phone&&r.jsxs(r.Fragment,{children:[" ",$.patient.phone]})]})]}),r.jsxs("div",{className:"flex flex-wrap gap-2 text-[11px]",children:[r.jsxs("div",{className:"rounded-full bg-white/80 border border-indigo-100 px-3 py-1 shadow-sm",children:[r.jsx("span",{className:"text-slate-500 mr-1",children:"Total Outstanding:"}),r.jsxs("span",{className:"font-semibold text-red-700",children:[""," ",Jn(($==null?void 0:$.total_outstanding)??n.balance_due??0)]})]}),r.jsxs("div",{className:"rounded-full bg-white/80 border border-emerald-100 px-3 py-1 shadow-sm",children:[r.jsx("span",{className:"text-slate-500 mr-1",children:"Advance Balance:"}),r.jsxs("span",{className:"font-semibold text-emerald-700",children:[" ",Jn(($==null?void 0:$.advance_balance)??0)]})]}),r.jsx("button",{type:"button",onClick:it,disabled:H,className:"rounded-full bg-slate-900 px-3 py-1 text-[11px] font-medium text-white shadow-sm hover:bg-slate-800 disabled:opacity-60",children:H?"Loading...":"Credit Summary PDF"})]})]}),r.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[r.jsxs("div",{className:"w-full md:w-2/5 space-y-4",children:[r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 md:p-4 shadow-sm space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("h2",{className:"text-xs font-semibold text-slate-800",children:"Invoice Header"}),r.jsxs("span",{className:"text-[11px] text-slate-400",children:["Patient #",n.patient_id]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Billing Type"}),r.jsxs("select",{name:"billing_type",value:h.billing_type,onChange:ee,disabled:G,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50",children:[r.jsx("option",{value:"op_billing",children:"OP Billing"}),r.jsx("option",{value:"ip_billing",children:"IP Billing"}),r.jsx("option",{value:"lab",children:"Lab"}),r.jsx("option",{value:"pharmacy",children:"Pharmacy"}),r.jsx("option",{value:"radiology",children:"Radiology"}),r.jsx("option",{value:"general",children:"General"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Consultant"}),r.jsxs("select",{name:"consultant_id",value:h.consultant_id,onChange:ee,disabled:G,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50",children:[r.jsx("option",{value:"",children:"None"}),(Ns=i.doctors)==null?void 0:Ns.map(ie=>r.jsx("option",{value:ie.id,children:ie.name||`Doctor #${ie.id}`},ie.id))]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Credit Provider"}),r.jsxs("select",{name:"provider_id",value:h.provider_id,onChange:ee,disabled:G,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50",children:[r.jsx("option",{value:"",children:"Self pay"}),(ds=i.credit_providers)==null?void 0:ds.map(ie=>r.jsx("option",{value:ie.id,children:ie.display_name||ie.name||ie.code||`Provider #${ie.id}`},ie.id))]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Visit No (optional)"}),r.jsx("input",{type:"text",name:"visit_no",value:h.visit_no,onChange:ee,disabled:G,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Remarks"}),r.jsx("input",{type:"text",name:"remarks",value:h.remarks,onChange:ee,disabled:G,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50"})]})]}),r.jsxs("div",{className:"mt-2 border-t border-slate-100 pt-2 space-y-2",children:[r.jsx("div",{className:"text-[11px] font-semibold text-slate-700",children:"Header Discount"}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Discount %"}),r.jsx("input",{type:"number",name:"header_discount_percent",value:h.header_discount_percent,onChange:ee,disabled:G,step:"0.1",className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Discount Amount"}),r.jsx("input",{type:"number",name:"header_discount_amount",value:h.header_discount_amount,onChange:ee,disabled:G,step:"0.01",className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50"})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Discount Remarks"}),r.jsx("input",{type:"text",name:"discount_remarks",value:h.discount_remarks,onChange:ee,disabled:G,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50"})]})]}),!G&&r.jsx("div",{className:"pt-1 flex justify-end",children:r.jsx("button",{type:"button",onClick:te,disabled:d,className:"px-3 py-1.5 rounded-full bg-slate-900 text-xs font-medium text-white hover:bg-slate-800 disabled:opacity-60",children:d?"Saving...":"Save Header"})})]})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 md:p-4 shadow-sm space-y-2 text-xs",children:[r.jsx("h2",{className:"text-xs font-semibold text-slate-800",children:"Totals"}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-slate-500",children:"Gross Amount"}),r.jsxs("span",{className:"font-medium text-slate-900",children:[" ",Jn(n.gross_total)]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-slate-500",children:"Tax Total"}),r.jsxs("span",{className:"font-medium text-slate-900",children:[" ",Jn(n.tax_total)]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-slate-500",children:"Header Discount"}),r.jsxs("span",{className:"font-medium text-orange-700",children:[" ",Jn(n.header_discount_amount||0)," ",n.header_discount_percent?`(${n.header_discount_percent}%)`:""]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-slate-500",children:"Net Amount"}),r.jsxs("span",{className:"font-semibold text-slate-900",children:[" ",Jn(n.net_total)]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-slate-500",children:"Amount Received"}),r.jsxs("span",{className:"font-medium text-emerald-700",children:[" ",Jn(n.amount_paid)]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-slate-500",children:"Advance Adjusted"}),r.jsxs("span",{className:"font-medium text-slate-900",children:[" ",Jn(n.advance_adjusted)]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-slate-500",children:"Previous Balance"}),r.jsxs("span",{className:"font-medium text-slate-900",children:[" ",Jn(n.previous_balance_snapshot)]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-slate-500",children:"Balance Due"}),r.jsxs("span",{className:"font-semibold text-red-700",children:[" ",Jn(n.balance_due)]})]})]})]}),xe.length>0&&r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 md:p-4 shadow-sm space-y-2 text-xs",children:[r.jsx("div",{className:"flex items-center justify-between gap-2",children:r.jsx("h2",{className:"text-xs font-semibold text-slate-800",children:"Package Billing (IPD)"})}),r.jsx("p",{className:"text-[11px] text-slate-500 mb-1",children:"Quickly post a package charge to this invoice."}),r.jsxs("select",{onChange:ie=>ae(ie.target.value),disabled:G,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50",defaultValue:"",children:[r.jsx("option",{value:"",children:"Select package to add..."}),xe.map(ie=>r.jsxs("option",{value:ie.id,children:[ie.name,"   ",Jn(ie.charges)]},ie.id))]})]})]}),r.jsxs("div",{className:"w-full md:w-3/5 space-y-4",children:[r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 md:p-4 shadow-sm space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("h2",{className:"text-xs font-semibold text-slate-800",children:"Items"}),!G&&r.jsx("button",{type:"button",onClick:()=>b(!0),className:"text-[11px] rounded-full border border-slate-300 px-3 py-1 text-slate-700 hover:bg-slate-50 shadow-sm",children:"+ Add Manual Item"})]}),Ct.length===0?r.jsx("p",{className:"text-xs text-slate-500",children:"No items added yet."}):r.jsx("div",{className:"overflow-x-auto text-xs",children:r.jsxs("table",{className:"min-w-full divide-y divide-slate-100",children:[r.jsx("thead",{className:"bg-slate-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"#"}),r.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Description"}),r.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"Qty"}),r.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"Price"}),r.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"GST%"}),r.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"Disc"}),r.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"Total"}),r.jsx("th",{className:"px-2 py-1.5"})]})}),r.jsx("tbody",{className:"divide-y divide-slate-100",children:Ct.map((ie,Ie)=>r.jsxs("tr",{className:"align-top",children:[r.jsx("td",{className:"px-2 py-1.5 whitespace-nowrap text-slate-500",children:Ie+1}),r.jsx("td",{className:"px-2 py-1.5 text-slate-800",children:r.jsxs("div",{className:"max-w-xs",children:[r.jsx("div",{className:"truncate",children:ie.description}),r.jsxs("div",{className:"text-[10px] text-slate-400",children:[ie.service_type," #",ie.service_ref_id]})]})}),r.jsx("td",{className:"px-2 py-1.5 text-right text-slate-700",children:ie.quantity}),r.jsx("td",{className:"px-2 py-1.5 text-right text-slate-700",children:Jn(ie.unit_price)}),r.jsxs("td",{className:"px-2 py-1.5 text-right text-slate-700",children:[Number(ie.tax_rate||0),"%"]}),r.jsxs("td",{className:"px-2 py-1.5 text-right text-slate-700",children:[ie.discount_percent?`${Number(ie.discount_percent)}%`:"",ie.discount_amount?` /  ${Jn(ie.discount_amount)}`:""]}),r.jsx("td",{className:"px-2 py-1.5 text-right text-slate-800",children:Jn(ie.line_total)}),r.jsx("td",{className:"px-2 py-1.5 text-right whitespace-nowrap",children:!G&&r.jsxs("div",{className:"flex justify-end gap-1",children:[r.jsx("button",{type:"button",onClick:()=>X(ie),className:"text-[10px] text-indigo-600 hover:text-indigo-800",children:"Edit"}),r.jsx("span",{className:"text-slate-300",children:"|"}),r.jsx("button",{type:"button",onClick:()=>ue(ie),className:"text-[10px] text-red-600 hover:text-red-800",children:"Void"})]})})]},ie.id))})]})})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 md:p-4 shadow-sm space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("h2",{className:"text-xs font-semibold text-slate-800",children:"Payments & Refunds"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{type:"button",onClick:qe,disabled:B==="advance",className:"text-[11px] rounded-full border border-slate-300 px-3 py-1 text-slate-700 hover:bg-slate-50 disabled:opacity-60",children:B==="advance"?"Applying...":"Apply Advances"}),!G&&r.jsxs(r.Fragment,{children:[r.jsx("button",{type:"button",onClick:_t,className:"text-[11px] rounded-full border border-red-200 bg-red-50 px-3 py-1 text-red-700 hover:bg-red-100",children:"+ Add Refund"}),r.jsx("button",{type:"button",onClick:ve,className:"text-[11px] rounded-full border border-slate-300 px-3 py-1 text-slate-700 hover:bg-slate-50",children:"+ Add Payment"})]})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("div",{className:"text-[11px] font-semibold text-slate-700",children:"Payments"}),vt.length===0?r.jsx("p",{className:"text-[11px] text-slate-500",children:"No payments recorded."}):r.jsx("div",{className:"overflow-x-auto text-xs",children:r.jsxs("table",{className:"min-w-full divide-y divide-slate-100",children:[r.jsx("thead",{className:"bg-slate-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Mode"}),r.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Reference"}),r.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Notes"}),r.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Paid At"}),r.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"Amount"}),r.jsx("th",{className:"px-2 py-1.5"})]})}),r.jsx("tbody",{className:"divide-y divide-slate-100",children:vt.map(ie=>r.jsxs("tr",{children:[r.jsx("td",{className:"px-2 py-1.5 text-slate-800",children:ie.mode}),r.jsx("td",{className:"px-2 py-1.5 text-slate-600",children:ie.reference_no||""}),r.jsx("td",{className:"px-2 py-1.5 text-slate-600",children:ie.notes||""}),r.jsx("td",{className:"px-2 py-1.5 text-slate-500",children:ie.paid_at?new Date(ie.paid_at).toLocaleString():""}),r.jsxs("td",{className:"px-2 py-1.5 text-right text-emerald-700 font-medium",children:[" ",Jn(ie.amount)]}),r.jsx("td",{className:"px-2 py-1.5 text-right",children:!G&&r.jsx("button",{type:"button",onClick:()=>oe(ie),className:"text-[10px] text-red-600 hover:text-red-800",children:"Delete"})})]},ie.id))})]})})]}),r.jsxs("div",{className:"space-y-1 border-t border-slate-100 pt-2",children:[r.jsx("div",{className:"text-[11px] font-semibold text-slate-700",children:"Refunds"}),pt.length===0?r.jsx("p",{className:"text-[11px] text-slate-500",children:"No refunds recorded."}):r.jsx("div",{className:"overflow-x-auto text-xs",children:r.jsxs("table",{className:"min-w-full divide-y divide-slate-100",children:[r.jsx("thead",{className:"bg-slate-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Mode"}),r.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Reference"}),r.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Notes"}),r.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Time"}),r.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"Amount"}),r.jsx("th",{className:"px-2 py-1.5"})]})}),r.jsx("tbody",{className:"divide-y divide-slate-100",children:pt.map(ie=>r.jsxs("tr",{children:[r.jsx("td",{className:"px-2 py-1.5 text-slate-800",children:ie.mode}),r.jsx("td",{className:"px-2 py-1.5 text-slate-600",children:ie.reference_no||""}),r.jsx("td",{className:"px-2 py-1.5 text-slate-600",children:ie.notes||""}),r.jsx("td",{className:"px-2 py-1.5 text-slate-500",children:ie.paid_at?new Date(ie.paid_at).toLocaleString():""}),r.jsxs("td",{className:"px-2 py-1.5 text-right text-red-700 font-medium",children:[" ",Jn(ie.amount)]}),r.jsx("td",{className:"px-2 py-1.5 text-right",children:!G&&r.jsx("button",{type:"button",onClick:()=>oe(ie),className:"text-[10px] text-red-600 hover:text-red-800",children:"Delete"})})]},ie.id))})]})})]})]})]})]}),r.jsx("div",{className:"fixed inset-x-0 bottom-0 z-20 bg-white border-t border-slate-200 px-3 py-2 md:static md:border-none md:px-0 md:py-0 mt-3",children:r.jsxs("div",{className:"max-w-5xl mx-auto flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between text-xs",children:[r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsxs("span",{className:"rounded-full bg-slate-100 px-2.5 py-1 text-[11px] text-slate-700",children:["Net:  ",Jn(n.net_total)]}),r.jsxs("span",{className:"rounded-full bg-emerald-50 px-2.5 py-1 text-[11px] text-emerald-700",children:["Paid:  ",Jn(n.amount_paid)]}),r.jsxs("span",{className:"rounded-full bg-red-50 px-2.5 py-1 text-[11px] text-red-700",children:["Balance:  ",Jn(n.balance_due)]})]}),r.jsx("div",{className:"flex gap-2 justify-end",children:!G&&r.jsxs(r.Fragment,{children:[r.jsx("button",{type:"button",onClick:jt,disabled:B==="cancel",className:"rounded-full border border-slate-300 px-3 py-1.5 text-xs text-slate-700 bg-white hover:bg-slate-50 disabled:opacity-60",children:B==="cancel"?"Cancelling...":"Cancel Invoice"}),r.jsx("button",{type:"button",onClick:Xe,disabled:B==="finalize",className:"rounded-full bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-500 px-4 py-1.5 text-xs font-medium text-white shadow-md hover:shadow-lg disabled:opacity-60",children:B==="finalize"?"Finalizing...":"Finalize"})]})})]})})]}),x&&!G&&r.jsx("div",{className:"fixed inset-0 z-30 flex items-end sm:items-center justify-center bg-black/40",children:r.jsxs("div",{className:"w-full sm:max-w-md bg-white rounded-t-2xl sm:rounded-2xl shadow-lg p-4 space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Add Manual Item"}),r.jsx("button",{type:"button",onClick:()=>b(!1),className:"text-xs text-slate-400 hover:text-slate-600",children:""})]}),r.jsxs("form",{className:"space-y-3",onSubmit:ge,children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Description"}),r.jsx("input",{type:"text",name:"description",value:v.description,onChange:ce,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",required:!0})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Qty"}),r.jsx("input",{type:"number",name:"quantity",value:v.quantity,min:1,onChange:ce,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Unit Price"}),r.jsx("input",{type:"number",name:"unit_price",value:v.unit_price,step:"0.01",onChange:ce,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",required:!0})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Tax %"}),r.jsx("input",{type:"number",name:"tax_rate",value:v.tax_rate,step:"0.1",onChange:ce,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Disc %"}),r.jsx("input",{type:"number",name:"discount_percent",value:v.discount_percent,step:"0.1",onChange:ce,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Disc Amount"}),r.jsx("input",{type:"number",name:"discount_amount",value:v.discount_amount,step:"0.01",onChange:ce,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]})]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx("button",{type:"button",onClick:()=>b(!1),className:"rounded-md border border-slate-300 px-3 py-1.5 text-xs text-slate-700",children:"Cancel"}),r.jsx("button",{type:"submit",className:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-indigo-700",children:"Add Item"})]})]})]})}),_&&!G&&r.jsx("div",{className:"fixed inset-0 z-30 flex items-end sm:items-center justify-center bg-black/40",children:r.jsxs("div",{className:"w-full sm:max-w-md bg-white rounded-t-2xl sm:rounded-2xl shadow-lg p-4 space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Edit Item"}),r.jsx("button",{type:"button",onClick:()=>S(null),className:"text-xs text-slate-400 hover:text-slate-600",children:""})]}),r.jsxs("form",{className:"space-y-3",onSubmit:Ce,children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Description"}),r.jsx("input",{type:"text",name:"description",value:k.description,onChange:de,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",required:!0})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Qty"}),r.jsx("input",{type:"number",name:"quantity",value:k.quantity,min:1,onChange:de,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Unit Price"}),r.jsx("input",{type:"number",name:"unit_price",value:k.unit_price,step:"0.01",onChange:de,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",required:!0})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Tax %"}),r.jsx("input",{type:"number",name:"tax_rate",value:k.tax_rate,step:"0.1",onChange:de,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Disc %"}),r.jsx("input",{type:"number",name:"discount_percent",value:k.discount_percent,step:"0.1",onChange:de,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Disc Amount"}),r.jsx("input",{type:"number",name:"discount_amount",value:k.discount_amount,step:"0.01",onChange:de,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]})]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx("button",{type:"button",onClick:()=>S(null),className:"rounded-md border border-slate-300 px-3 py-1.5 text-xs text-slate-700",children:"Cancel"}),r.jsx("button",{type:"submit",className:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-indigo-700",children:"Save Changes"})]})]})]})}),T&&!G&&r.jsx("div",{className:"fixed inset-0 z-30 flex items-end sm:items-center justify-center bg-black/40",children:r.jsxs("div",{className:"w-full sm:max-w-md bg-white rounded-t-2xl sm:rounded-2xl shadow-lg p-4 space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:I?"Add Refund":"Add Payment"}),r.jsx("button",{type:"button",onClick:()=>{P(!1),M(!1)},className:"text-xs text-slate-400 hover:text-slate-600",children:""})]}),r.jsxs("form",{className:"space-y-3",onSubmit:pe,children:[r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Amount"}),r.jsx("input",{type:"number",name:"amount",value:O.amount,onChange:fe,step:"0.01",className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",required:!0})]}),!I&&r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Mode"}),r.jsxs("select",{name:"mode",value:O.mode,onChange:fe,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",children:[r.jsx("option",{value:"cash",children:"Cash"}),r.jsx("option",{value:"card",children:"Card"}),r.jsx("option",{value:"upi",children:"UPI"}),r.jsx("option",{value:"credit",children:"Credit"}),r.jsx("option",{value:"cheque",children:"Cheque"}),r.jsx("option",{value:"neft",children:"NEFT"}),r.jsx("option",{value:"rtgs",children:"RTGS"}),r.jsx("option",{value:"wallet",children:"Wallet"}),r.jsx("option",{value:"other",children:"Other"})]})]}),I&&r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Mode (optional)"}),r.jsx("input",{type:"text",name:"mode",value:O.mode,onChange:fe,placeholder:"refund / bank / cash",className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Reference No (optional)"}),r.jsx("input",{type:"text",name:"reference_no",value:O.reference_no,onChange:fe,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Notes (optional)"}),r.jsx("input",{type:"text",name:"notes",value:O.notes,onChange:fe,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx("button",{type:"button",onClick:()=>{P(!1),M(!1)},className:"rounded-md border border-slate-300 px-3 py-1.5 text-xs text-slate-700",children:"Cancel"}),r.jsx("button",{type:"submit",className:`rounded-md px-3 py-1.5 text-xs font-medium text-white ${I?"bg-red-600 hover:bg-red-700":"bg-indigo-600 hover:bg-indigo-700"}`,children:I?"Save Refund":"Save Payment"})]})]})]})})]}):r.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 md:px-6 py-4",children:r.jsxs("div",{className:"max-w-5xl mx-auto",children:[r.jsx("p",{className:"text-xs text-red-600 mb-2",children:F||"Invoice not found."}),r.jsx("button",{type:"button",onClick:()=>s("/billing"),className:"text-xs text-indigo-600 hover:text-indigo-800",children:" Back to Billing Console"})]})})}function vz(t){return J.get("/emr/patients/lookup",{params:{q:t}})}function dye({patient_id:t,uhid:s,date_from:n,date_to:a,types:i}={}){let l;return Array.isArray(i)?l=i.length?i.join(","):void 0:typeof i=="string"?l=i||void 0:l=void 0,J.get("/emr/timeline",{params:{patient_id:t,uhid:s,date_from:n||void 0,date_to:a||void 0,types:l}})}function uye(t){return J.post("/emr/export/pdf-json",t,{responseType:"blob"})}function hye(t,s,n){return J.get(`/emr/fhir/${t}`,{params:{date_from:s,date_to:n}})}function mye({onPick:t,placeholder:s="UHID, name, phone, email"}){const[n,a]=y.useState(""),[i,l]=y.useState([]),[o,c]=y.useState(!1);y.useEffect(()=>{let u=!0;const f=setTimeout(async()=>{if(!n||!n.trim()){l([]);return}try{c(!0);const{data:x}=await vz(n.trim());if(!u)return;l((x==null?void 0:x.results)||[])}finally{c(!1)}},250);return()=>{u=!1,clearTimeout(f)}},[n]);const d=y.useMemo(()=>i.slice(0,8),[i]);return r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:"Find Patient"}),r.jsxs("div",{className:"relative",children:[r.jsx(es,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),r.jsx("input",{className:"w-full rounded-xl border border-gray-200 bg-white px-9 py-2 text-sm outline-none ring-blue-200 focus:ring-2",placeholder:s,value:n,onChange:u=>a(u.target.value)})]}),o&&r.jsx("div",{className:"text-xs text-gray-500",children:"Searching"}),!o&&d.length>0&&r.jsx("div",{className:"grid gap-2 sm:grid-cols-2",children:d.map(u=>{var h;return r.jsxs("button",{onClick:()=>t(u),className:"rounded-xl border p-3 text-left transition hover:bg-gray-50",children:[r.jsxs("div",{className:"font-medium",children:[u.uhid,"  ",u.name]}),r.jsxs("div",{className:"text-xs text-gray-500",children:[(h=u.gender)==null?void 0:h.toUpperCase()," ",u.dob?` ${u.dob}`:""," ",u.phone?` ${u.phone}`:""]})]},u.uhid)})}),!o&&n&&d.length===0&&r.jsx("div",{className:"text-xs text-gray-500",children:"No matches."})]})}const Pf=[{code:"opd_visit",label:"OPD Visit",icon:Es},{code:"opd_vitals",label:"Vitals",icon:Vs},{code:"rx",label:"Prescription",icon:gl},{code:"lab",label:"Lab",icon:Li},{code:"radiology",label:"Radiology",icon:ay},{code:"pharmacy",label:"Pharmacy",icon:s1},{code:"ipd_admission",label:"IPD Admit",icon:kn},{code:"ipd_transfer",label:"IPD Transfer",icon:Dte},{code:"ipd_discharge",label:"IPD Discharge",icon:dne},{code:"ot",label:"OT",icon:z7},{code:"billing",label:"Billing",icon:P_},{code:"attachment",label:"Attachment",icon:vne},{code:"consent",label:"Consent",icon:$a}];function Rh(t){return t<10?"0"+t:""+t}function fye(t){const s=new Date(t);return isNaN(s)?String(t||""):`${s.getFullYear()}-${Rh(s.getMonth()+1)}-${Rh(s.getDate())} ${Rh(s.getHours())}:${Rh(s.getMinutes())}`}function pye(t){const s=new Date(t);return isNaN(s)?"":`${s.getFullYear()}-${Rh(s.getMonth()+1)}-${Rh(s.getDate())}`}function xye(t){const s=new Map;return t.forEach(n=>{const a=pye(n.ts);s.has(a)||s.set(a,[]),s.get(a).push(n)}),Array.from(s.entries()).sort((n,a)=>n[0]<a[0]?1:-1)}function gye(t,s){const n=URL.createObjectURL(t),a=document.createElement("a");a.href=n,a.download=s,a.click(),URL.revokeObjectURL(n)}function og(t,s){const n=document.createElement("a");n.href=t,n.download=s||"download",n.target="_blank",n.rel="noopener",n.click()}const yye="inline-flex items-center gap-1 rounded-full border px-3 py-1 text-[11px] font-medium transition",bye={new:"border-slate-200 bg-slate-50 text-slate-700",in_progress:"border-slate-200 bg-slate-50 text-slate-700",dispensed:"border-emerald-200 bg-emerald-50 text-emerald-700",completed:"border-emerald-200 bg-emerald-50 text-emerald-700",cancelled:"border-rose-200 bg-rose-50 text-rose-700"};function UI(t){const s=(t.content_type||"").toLowerCase(),n=String(t.url||"").toLowerCase();return s.startsWith("image/")?"image":s==="application/pdf"?"pdf":n.endsWith(".png")||n.endsWith(".jpg")||n.endsWith(".jpeg")||n.endsWith(".webp")||n.endsWith(".gif")?"image":n.endsWith(".pdf")?"pdf":"other"}function vye(){const[t,s]=y.useState(null),[n,a]=y.useState({date_from:"",date_to:"",types:Pf.map(z=>z.code),consent_required:!1}),[i,l]=y.useState(!1),[o,c]=y.useState([]),[d,u]=y.useState(0),h=y.useMemo(()=>new Set(n.types||[]),[n.types]),[f,x]=y.useState(null),[b,v]=y.useState(!1),[w,_]=y.useState(null);y.useEffect(()=>()=>{f&&URL.revokeObjectURL(f)},[f]);const S=z=>{a(H=>{const q=new Set(H.types);return q.has(z)?q.delete(z):q.add(z),{...H,types:Array.from(q)}})},k=()=>a(z=>({...z,types:Pf.map(H=>H.code)})),A=()=>a(z=>({...z,types:[]}));y.useEffect(()=>{let z=!0;return(async()=>{var q,G;if(!(!(t!=null&&t.uhid)&&!(t!=null&&t.id)))try{l(!0);const re={uhid:t.uhid,patient_id:t.id,date_from:n.date_from||void 0,date_to:n.date_to||void 0};n.types&&n.types.length&&n.types.length!==Pf.length&&(re.types=n.types.join(","));const{data:ye}=await dye(re);if(!z)return;c(ye||[])}catch(re){console.error(re),se.error(((G=(q=re==null?void 0:re.response)==null?void 0:q.data)==null?void 0:G.detail)||"Failed to load EMR timeline"),c([])}finally{l(!1)}})(),()=>{z=!1}},[t==null?void 0:t.uhid,t==null?void 0:t.id,n.date_from,n.date_to,JSON.stringify(n.types),d]);const T=y.useMemo(()=>xye(o),[o]),P=(o==null?void 0:o.length)||0,O=n.date_from||n.date_to?`${n.date_from||""}  ${n.date_to||"Today"}`:"All available records",D=async()=>{var z,H,q;if(!t){se.info("Select a patient first.");return}try{const re={...t!=null&&t.id?{patient_id:t.id}:{uhid:t==null?void 0:t.uhid},date_from:n.date_from||null,date_to:n.date_to||null,sections:{opd:h.has("opd_visit")||h.has("opd_vitals")||h.has("rx"),ipd:h.has("ipd_admission")||h.has("ipd_transfer")||h.has("ipd_discharge"),vitals:h.has("opd_vitals"),prescriptions:h.has("rx"),lab:h.has("lab"),radiology:h.has("radiology"),pharmacy:h.has("pharmacy"),ot:h.has("ot"),billing:h.has("billing"),attachments:h.has("attachment"),consents:h.has("consent")},consent_required:!!n.consent_required},Ee=(await uye(re)).data;if(!(Ee instanceof Blob)){se.error("PDF export failed: invalid response");return}x(ee=>(ee&&URL.revokeObjectURL(ee),URL.createObjectURL(Ee))),v(!0),se.success("EMR PDF ready for preview")}catch(G){((z=G==null?void 0:G.response)==null?void 0:z.status)===412?se.error("Consent required. Enable consent capture or uncheck the Require consent box."):se.error(((q=(H=G==null?void 0:G.response)==null?void 0:H.data)==null?void 0:q.detail)||"PDF export failed")}},I=async()=>{if(!(t!=null&&t.id)){se.info("Patient id required; please pick from the search list.");return}try{const{data:z}=await hye(t.id,n.date_from||void 0,n.date_to||void 0),H=new Blob([JSON.stringify(z,null,2)],{type:"application/json"});gye(H,`FHIR_${t.uhid||"patient"}.json`),se.success("FHIR bundle downloaded")}catch{se.error("FHIR export failed")}};function M({k:z,v:H}){return H==null||H===""?null:r.jsxs("div",{className:"text-xs text-slate-700",children:[r.jsxs("span",{className:"font-medium",children:[z,":"]})," ",String(H)]})}function B(z){const H=z.data||{};switch(z.type){case"opd_visit":return r.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[r.jsx(M,{k:"Chief Complaint",v:H.chief_complaint}),r.jsx(M,{k:"Symptoms",v:H.symptoms}),r.jsx(M,{k:"Subjective",v:H.subjective}),r.jsx(M,{k:"Objective",v:H.objective}),r.jsx(M,{k:"Assessment",v:H.assessment}),r.jsx(M,{k:"Plan",v:H.plan}),r.jsx(M,{k:"Episode",v:H.episode_id}),H.appointment&&r.jsxs("div",{className:"text-xs text-slate-700",children:[r.jsx("span",{className:"font-medium",children:"Appointment:"})," ",H.appointment.date,"  ",H.appointment.slot_start,"",H.appointment.slot_end,"  ",H.appointment.purpose]})]});case"opd_vitals":return r.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-sm text-slate-800 md:grid-cols-3",children:[r.jsx(M,{k:"Recorded at",v:H.recorded_at}),r.jsx(M,{k:"Height (cm)",v:H.height_cm}),r.jsx(M,{k:"Weight (kg)",v:H.weight_kg}),r.jsx(M,{k:"BMI",v:H.bmi}),r.jsx(M,{k:"BP",v:H.bp_systolic!=null&&H.bp_diastolic!=null?`${H.bp_systolic}/${H.bp_diastolic} mmHg`:""}),r.jsx(M,{k:"Pulse",v:H.pulse}),r.jsx(M,{k:"RR",v:H.rr}),r.jsx(M,{k:"Temp (C)",v:H.temp_c}),r.jsx(M,{k:"SpO (%)",v:H.spo2}),r.jsx("div",{className:"col-span-2 md:col-span-3",children:r.jsx(M,{k:"Notes",v:H.notes})})]});case"rx":return r.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[r.jsx(M,{k:"Notes",v:H.notes}),r.jsx(M,{k:"Signed at",v:H.signed_at}),r.jsx(M,{k:"Signed by",v:H.signed_by}),Array.isArray(H.items)&&H.items.length>0&&r.jsxs("div",{className:"mt-2",children:[r.jsx("div",{className:"text-[11px] font-medium text-slate-600 uppercase tracking-wide",children:"Items"}),r.jsx("div",{className:"mt-1 divide-y rounded-2xl border border-slate-200 bg-slate-50",children:H.items.map((q,G)=>r.jsxs("div",{className:"grid gap-2 p-2.5 md:grid-cols-5",children:[r.jsxs("div",{className:"md:col-span-2 text-xs",children:[r.jsx("span",{className:"font-medium text-slate-900",children:q.drug_name})," ",q.strength?r.jsxs("span",{className:"text-slate-500",children:[" ",q.strength]}):null]}),r.jsxs("div",{className:"text-xs text-slate-600",children:["Freq: ",q.frequency||""]}),r.jsxs("div",{className:"text-xs text-slate-600",children:["Dur: ",q.duration_days,"d"]}),r.jsxs("div",{className:"text-xs text-slate-600",children:["Qty: ",q.quantity]})]},G))})]})]});case"lab":{const q=H.item||{};return r.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[r.jsx(M,{k:"Order ID",v:H.order_id}),r.jsx(M,{k:"Priority",v:H.priority}),r.jsx(M,{k:"Collected at",v:H.collected_at}),r.jsx(M,{k:"Reported at",v:H.reported_at}),r.jsx(M,{k:"Test",v:`${q.test_name} (${q.test_code})`}),r.jsx(M,{k:"Unit",v:q.unit}),r.jsx(M,{k:"Normal range",v:q.normal_range}),r.jsx(M,{k:"Specimen",v:q.specimen_type}),r.jsx(M,{k:"Status",v:q.status}),r.jsx(M,{k:"Result",v:q.result_value}),r.jsx(M,{k:"Critical",v:q.is_critical?"Yes":q.is_critical===!1?"No":""}),r.jsx(M,{k:"Result at",v:q.result_at})]})}case"radiology":return r.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[r.jsx(M,{k:"Test",v:`${H.test_name} (${H.test_code})`}),r.jsx(M,{k:"Modality",v:H.modality}),r.jsx(M,{k:"Status",v:H.status}),r.jsx(M,{k:"Scheduled at",v:H.scheduled_at}),r.jsx(M,{k:"Scanned at",v:H.scanned_at}),r.jsx(M,{k:"Reported at",v:H.reported_at}),r.jsx(M,{k:"Approved at",v:H.approved_at}),r.jsx(M,{k:"Report",v:H.report_text})]});case"pharmacy":return r.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[r.jsx(M,{k:"Sale ID",v:H.sale_id}),r.jsx(M,{k:"Context",v:H.context_type}),r.jsx(M,{k:"Payment",v:H.payment_mode}),r.jsx(M,{k:"Total",v:H.total_amount}),Array.isArray(H.items)&&H.items.length>0&&r.jsxs("div",{className:"mt-2",children:[r.jsx("div",{className:"text-[11px] font-medium text-slate-600 uppercase tracking-wide",children:"Items"}),r.jsx("div",{className:"mt-1 divide-y rounded-2xl border border-slate-200 bg-slate-50",children:H.items.map((q,G)=>r.jsxs("div",{className:"grid gap-2 p-2.5 md:grid-cols-4",children:[r.jsx("div",{className:"md:col-span-2 text-xs text-slate-800",children:q.medicine_name||`#${q.medicine_id}`}),r.jsxs("div",{className:"text-xs text-slate-600",children:["Qty: ",q.qty]}),r.jsxs("div",{className:"text-xs text-slate-600",children:["",q.amount]})]},G))})]})]});case"ipd_admission":return r.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-sm text-slate-800 md:grid-cols-3",children:[r.jsx(M,{k:"Admission Code",v:H.admission_code}),r.jsx(M,{k:"Type",v:H.admission_type}),r.jsx(M,{k:"Admitted at",v:H.admitted_at}),r.jsx(M,{k:"Expected Discharge",v:H.expected_discharge_at}),r.jsx(M,{k:"Bed",v:H.current_bed_code}),r.jsx("div",{className:"col-span-2 md:col-span-3",children:r.jsx(M,{k:"Preliminary Diagnosis",v:H.preliminary_diagnosis})}),r.jsx("div",{className:"col-span-2 md:col-span-3",children:r.jsx(M,{k:"History",v:H.history})}),r.jsx("div",{className:"col-span-2 md:col-span-3",children:r.jsx(M,{k:"Care Plan",v:H.care_plan})})]});case"ipd_transfer":return r.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[r.jsx(M,{k:"Admission",v:H.admission_id}),r.jsx(M,{k:"From Bed",v:H.from_bed_id}),r.jsx(M,{k:"To Bed",v:H.to_bed_id}),r.jsx(M,{k:"Reason",v:H.reason}),r.jsx(M,{k:"Transferred at",v:H.transferred_at})]});case"ipd_discharge":return r.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[r.jsx(M,{k:"Finalized",v:H.finalized?"Yes":"No"}),r.jsx(M,{k:"Finalized at",v:H.finalized_at}),r.jsx(M,{k:"Demographics",v:H.demographics}),r.jsx(M,{k:"Medical History",v:H.medical_history}),r.jsx(M,{k:"Treatment Summary",v:H.treatment_summary}),r.jsx(M,{k:"Medications",v:H.medications}),r.jsx(M,{k:"Follow Up",v:H.follow_up}),r.jsx(M,{k:"ICD-10 Codes",v:H.icd10_codes})]});case"ot":return r.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[r.jsx(M,{k:"Surgery",v:H.surgery_name}),r.jsx(M,{k:"Code",v:H.surgery_code}),r.jsx(M,{k:"Estimated Cost",v:H.estimated_cost}),r.jsx(M,{k:"Scheduled",v:`${H.scheduled_start||""}  ${H.scheduled_end||""}`}),r.jsx(M,{k:"Actual",v:`${H.actual_start||""}  ${H.actual_end||""}`}),r.jsx(M,{k:"Status",v:H.status}),r.jsx(M,{k:"Pre-op Notes",v:H.preop_notes}),r.jsx(M,{k:"Post-op Notes",v:H.postop_notes})]});case"billing":return r.jsxs("div",{className:"mt-2 space-y-2 text-sm text-slate-800",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-2 md:grid-cols-4",children:[r.jsx(M,{k:"Invoice ID",v:H.invoice_id}),r.jsx(M,{k:"Status",v:H.status}),r.jsx(M,{k:"Net Total",v:H.net_total}),r.jsx(M,{k:"Balance",v:H.balance_due})]}),Array.isArray(H.items)&&H.items.length>0&&r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] font-medium text-slate-600 uppercase tracking-wide",children:"Items"}),r.jsx("div",{className:"mt-1 divide-y rounded-2xl border border-slate-200 bg-slate-50",children:H.items.map((q,G)=>r.jsxs("div",{className:"grid gap-2 p-2.5 md:grid-cols-6",children:[r.jsx("div",{className:"md:col-span-2 text-xs text-slate-800",children:q.description}),r.jsx("div",{className:"text-xs text-slate-600",children:q.service_type}),r.jsxs("div",{className:"text-xs text-slate-600",children:["Qty: ",q.quantity]}),r.jsxs("div",{className:"text-xs text-slate-600",children:["Unit: ",q.unit_price]}),r.jsxs("div",{className:"text-xs text-slate-600",children:["Total: ",q.line_total]})]},G))})]}),Array.isArray(H.payments)&&H.payments.length>0&&r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] font-medium text-slate-600 uppercase tracking-wide",children:"Payments"}),r.jsx("div",{className:"mt-1 divide-y rounded-2xl border border-slate-200 bg-slate-50",children:H.payments.map((q,G)=>r.jsxs("div",{className:"grid gap-2 p-2.5 md:grid-cols-4",children:[r.jsxs("div",{className:"text-xs text-slate-600",children:["Mode: ",q.mode]}),r.jsxs("div",{className:"text-xs text-slate-600",children:["Ref: ",q.reference_no||""]}),r.jsxs("div",{className:"text-xs text-slate-600",children:["",q.amount]}),r.jsx("div",{className:"text-xs text-slate-600",children:q.paid_at})]},G))})]})]});case"attachment":return null;case"consent":return r.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[r.jsx(M,{k:"Type",v:H.type}),r.jsx(M,{k:"Captured at",v:H.captured_at}),r.jsx(M,{k:"Text",v:H.text})]});default:return null}}const L=z=>{const H=UI(z);if(H==="other"){window.open(z.url,"_blank","noopener,noreferrer");return}_({url:z.url,label:z.label||"Attachment",kind:H})},F=()=>{_(null)},V=()=>{if(!f)return;const z=window.open(f);z&&z.addEventListener("load",()=>{z.focus(),z.print()})},$=()=>{!f||!t||og(f,`EMR_${t.uhid||"patient"}.pdf`)};return r.jsxs("div",{className:"min-h-screen bg-slate-50",children:[r.jsxs("div",{className:"mx-auto max-w-6xl px-3 py-4 md:px-6 md:py-6 lg:px-8",children:[r.jsxs("div",{className:"mb-3 flex items-center justify-between gap-2",children:[r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1 text-[10px] font-medium uppercase tracking-wide text-slate-500",children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 animate-pulse"}),"EMR  Patient record & timeline"]}),r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1 text-[10px] font-medium text-slate-500",children:[r.jsx(ene,{className:"h-3 w-3"}),"Desktop workspace"]})]}),r.jsx(at.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2},children:r.jsxs(Ve,{className:"mb-5 rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsxs(rt,{className:"flex flex-col gap-4 border-b border-slate-100 pb-4 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-3xl bg-slate-900 text-slate-50",children:r.jsx(Es,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx(ot,{className:"text-xl font-semibold text-slate-900",children:"Patient EMR Timeline"}),r.jsx(vr,{className:"text-sm text-slate-600",children:"Unified view of OPD, IPD, lab, radiology, pharmacy, billing, attachments and consents  ready to export as a clean EMR PDF."})]})]}),r.jsxs("div",{className:"grid gap-2 text-xs text-slate-600 sm:grid-cols-3 sm:text-right",children:[r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[r.jsx("div",{className:"text-[10px] font-medium uppercase tracking-wide text-slate-500",children:"Selected patient"}),r.jsx("div",{className:"mt-1 text-[13px] font-semibold text-slate-900",children:t?t.uhid:"None"}),r.jsx("div",{className:"truncate text-[11px] text-slate-500",children:t?t.name:"Use search to pick a patient"})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[r.jsx("div",{className:"text-[10px] font-medium uppercase tracking-wide text-slate-500",children:"Total events"}),r.jsx("div",{className:"mt-1 text-[13px] font-semibold text-slate-900",children:P}),r.jsx("div",{className:"text-[11px] text-slate-500",children:"Across visits, orders & billing"})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[r.jsx("div",{className:"text-[10px] font-medium uppercase tracking-wide text-slate-500",children:"Date range"}),r.jsx("div",{className:"mt-1 text-[13px] font-semibold text-slate-900",children:O}),r.jsx("div",{className:"text-[11px] text-slate-500",children:"Filter scope for EMR export"})]})]})]}),r.jsx(He,{className:"pt-4",children:r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-500",children:[r.jsx(Ze,{variant:"outline",className:"rounded-full border-slate-200 bg-white px-2.5 py-1 text-[10px] font-medium uppercase tracking-wide text-slate-500",children:"EMR Viewer"}),r.jsx("span",{className:"hidden text-[11px] text-slate-500 sm:inline",children:"Apply filters, review visits and export a print-aligned EMR PDF."})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs(Te,{variant:"outline",size:"sm",className:"inline-flex items-center gap-1 rounded-full border-slate-200 bg-white text-xs text-slate-700 hover:bg-slate-100",onClick:()=>u(z=>z+1),children:[r.jsx(Bi,{className:"h-3.5 w-3.5"}),"Refresh"]}),r.jsxs(Te,{size:"sm",className:"inline-flex items-center gap-1 rounded-full bg-slate-900 px-3 py-2 text-xs font-medium text-white hover:bg-slate-800",onClick:D,children:[r.jsx(e1,{className:"h-3.5 w-3.5"}),"Preview / Print EMR PDF"]}),r.jsxs(Te,{variant:"outline",size:"sm",className:"inline-flex items-center gap-1 rounded-full border-slate-200 bg-white text-xs text-slate-700 hover:bg-slate-100",onClick:I,children:[r.jsx(gl,{className:"h-3.5 w-3.5"}),"Export FHIR (JSON)"]})]})]})})]})}),r.jsxs("div",{className:"mt-4 lg:grid lg:grid-cols-[280px,minmax(0,1fr)] lg:gap-6",children:[r.jsxs("div",{className:"mb-4 space-y-4 lg:mb-0 lg:sticky lg:top-24",children:[r.jsx(at.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2,delay:.05},children:r.jsxs(Ve,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsxs(rt,{className:"pb-3",children:[r.jsx(ot,{className:"text-sm font-semibold text-slate-900",children:"Patient"}),r.jsx(vr,{className:"text-xs text-slate-500",children:"Search and select a patient to view their EMR timeline."})]}),r.jsxs(He,{className:"space-y-3",children:[r.jsx(mye,{onPick:z=>{s(z),se.success(`Selected ${z.uhid}  ${z.name}`)}}),t&&r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-700",children:r.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[r.jsx(Yp,{className:"h-3.5 w-3.5 text-slate-500"}),r.jsx("span",{className:"font-medium text-slate-900",children:t.uhid}),r.jsx(V0,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsx("span",{className:"truncate",children:t.name}),t.gender&&r.jsxs(r.Fragment,{children:[r.jsx(V0,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsx("span",{className:"uppercase text-slate-500",children:t.gender})]}),t.dob&&r.jsxs(r.Fragment,{children:[r.jsx(V0,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsxs("span",{className:"text-slate-500",children:["DOB ",t.dob]})]}),t.phone&&r.jsxs(r.Fragment,{children:[r.jsx(V0,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsx("span",{className:"text-slate-500",children:t.phone})]})]})})]})]})}),r.jsx(at.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2,delay:.1},children:r.jsxs(Ve,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsx(rt,{className:"pb-3",children:r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{children:[r.jsx(ot,{className:"text-sm font-semibold text-slate-900",children:"Filters"}),r.jsx(vr,{className:"text-xs text-slate-500",children:"Date range, data types and consent requirement."})]})})}),r.jsxs(He,{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"mb-1.5 flex items-center gap-2 text-xs font-semibold text-slate-900",children:[r.jsx(Th,{className:"h-3.5 w-3.5 text-slate-500"}),"Date range"]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx(Th,{className:"pointer-events-none absolute left-2.5 top-1/2 h-3.5 w-3.5 -translate-y-1/2 text-slate-400"}),r.jsx(Se,{type:"date",className:"h-8 rounded-2xl border-slate-200 bg-slate-50 pl-8 pr-2 text-xs text-slate-700",value:n.date_from,onChange:z=>a(H=>({...H,date_from:z.target.value}))})]}),r.jsxs("div",{className:"relative",children:[r.jsx(Th,{className:"pointer-events-none absolute left-2.5 top-1/2 h-3.5 w-3.5 -translate-y-1/2 text-slate-400"}),r.jsx(Se,{type:"date",className:"h-8 rounded-2xl border-slate-200 bg-slate-50 pl-8 pr-2 text-xs text-slate-700",value:n.date_to,onChange:z=>a(H=>({...H,date_to:z.target.value}))})]})]}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Leave blank for full EMR history."})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"mb-1.5 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold text-slate-900",children:[r.jsx($r,{className:"h-3.5 w-3.5 text-slate-500"}),"Types"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{type:"button",onClick:k,className:"text-[10px] font-medium text-slate-600 hover:text-slate-900",children:"All"}),r.jsx("button",{type:"button",onClick:A,className:"text-[10px] font-medium text-slate-500 hover:text-slate-900",children:"Clear"})]})]}),r.jsx("div",{className:"flex flex-wrap gap-1.5",children:Pf.map(z=>{const H=z.icon,q=h.has(z.code);return r.jsxs("button",{type:"button",onClick:()=>S(z.code),className:["inline-flex items-center gap-1 rounded-full border px-2.5 py-1 text-[10px] font-medium transition",q?"border-slate-900 bg-slate-900 text-white shadow-sm":"border-slate-200 bg-white text-slate-600 hover:bg-slate-50"].join(" "),children:[r.jsx(H,{className:"h-3 w-3"}),z.label]},z.code)})})]}),r.jsxs("div",{className:"flex items-start gap-2 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[r.jsx("input",{id:"consentReq",type:"checkbox",checked:!!n.consent_required,onChange:z=>a(H=>({...H,consent_required:z.target.checked})),className:"mt-0.5 h-3.5 w-3.5 rounded border-slate-300 text-slate-900"}),r.jsxs("div",{className:"space-y-0.5",children:[r.jsx("label",{htmlFor:"consentReq",className:"block text-xs font-medium text-slate-900",children:"Require active consent for export"}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"When enabled, EMR PDF export is blocked unless a valid patient consent record exists."})]})]})]})]})})]}),r.jsx(at.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2,delay:.08},className:"space-y-4",children:r.jsxs(Ve,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsx(rt,{className:"pb-3",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Es,{className:"h-4 w-4 text-slate-500"}),r.jsx(ot,{className:"text-sm font-semibold text-slate-900",children:"Timeline"})]}),r.jsx("span",{className:"text-[11px] text-slate-500",children:"Sorted newest to oldest"})]})}),r.jsxs(He,{children:[i&&r.jsx("div",{className:"space-y-3",children:Array.from({length:5}).map((z,H)=>r.jsx(We,{className:"h-16 w-full rounded-2xl bg-slate-100"},H))}),!i&&(!o||o.length===0)&&r.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-6 py-8 text-center",children:[r.jsx("div",{className:"mx-auto mb-2 flex h-8 w-8 items-center justify-center rounded-full border border-slate-200 bg-white text-slate-500",children:r.jsx(Es,{className:"h-4 w-4"})}),r.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"No EMR events to display"}),r.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Pick a patient and adjust the date range or type filters to load their EMR timeline."})]}),!i&&o&&o.length>0&&r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute left-4 top-0 bottom-0 w-px bg-gradient-to-b from-slate-200 via-slate-200/70 to-transparent"}),r.jsx("div",{className:"space-y-6",children:T.map(([z,H])=>r.jsxs("div",{className:"relative pl-10",children:[r.jsxs("div",{className:"mb-2 inline-flex items-center gap-2 rounded-full border border-slate-200 bg-slate-50 px-3 py-1 text-[11px] font-medium text-slate-700",children:[r.jsx(Th,{className:"h-3.5 w-3.5 text-slate-500"}),z]}),r.jsx("div",{className:"space-y-3",children:H.map((q,G)=>{var ee,te;const re=[q.doctor_name?`Dr. ${q.doctor_name}`:null,q.department_name||null,q.location_name||null].filter(Boolean).join("  "),ye=((ee=Pf.find(ce=>ce.code===q.type))==null?void 0:ee.icon)||gl,Ee=q.status&&(bye[q.status]||"border-slate-200 bg-slate-50 text-slate-600");return r.jsxs(at.div,{initial:{opacity:0,y:4},animate:{opacity:1,y:0},transition:{duration:.15},className:"relative",children:[r.jsx("div",{className:"absolute -left-[9px] top-4 h-2.5 w-2.5 rounded-full border border-slate-200 bg-white"}),r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3.5 hover:shadow-[0_4px_12px_rgba(15,23,42,0.06)]",children:r.jsx("div",{className:"flex items-start justify-between gap-3",children:r.jsxs("div",{className:"flex min-w-0 items-start gap-3",children:[r.jsx("div",{className:"mt-0.5 flex h-8 w-8 items-center justify-center rounded-2xl bg-slate-900 text-slate-50",children:r.jsx(ye,{className:"h-4 w-4"})}),r.jsxs("div",{className:"min-w-0",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:q.title||"Event"}),r.jsx("div",{className:"text-[11px] text-slate-500",children:fye(q.ts)}),q.status&&r.jsx("span",{className:`${yye} ${Ee}`,children:q.status})]}),re&&r.jsx("div",{className:"mt-0.5 text-[11px] text-slate-500",children:re}),B(q),((te=q.attachments)==null?void 0:te.length)>0&&r.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:q.attachments.map((ce,ge)=>{const X=UI(ce);return r.jsxs("div",{className:"inline-flex items-center gap-1.5 rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-[10px]",children:[r.jsxs("button",{type:"button",onClick:()=>L(ce),className:"inline-flex items-center gap-1 text-slate-700 hover:text-slate-900",children:[r.jsx(up,{className:"h-3 w-3"}),ce.label||"attachment"]}),r.jsxs("button",{type:"button",onClick:()=>og(ce.url,ce.label||"attachment"),className:"inline-flex items-center gap-1 text-slate-400 hover:text-slate-700",children:[r.jsx(to,{className:"h-3 w-3"}),r.jsx("span",{className:"hidden sm:inline",children:"Download"})]}),r.jsx("span",{className:"text-[9px] uppercase text-slate-400",children:X})]},ge)})})]})]})})})]},`${q.type}-${String(q.ts)}-${G}`)})})]},z))})]})]})]})})]})]}),b&&f&&r.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/60",children:r.jsxs("div",{className:"relative flex h-[90vh] w-[95vw] max-w-6xl flex-col overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-2xl",children:[r.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 px-4 py-2.5",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"EMR PDF Preview"}),t&&r.jsxs("div",{className:"text-[11px] text-slate-500",children:[t.uhid,"  ",t.name]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs(Te,{variant:"outline",size:"sm",className:"inline-flex items-center gap-1 rounded-full border-slate-200 bg-white text-[11px] text-slate-700 hover:bg-slate-100",onClick:$,children:[r.jsx(to,{className:"h-3 w-3"}),"Download"]}),r.jsxs(Te,{size:"sm",className:"inline-flex items-center gap-1 rounded-full bg-slate-900 px-3 py-1.5 text-[11px] text-white hover:bg-slate-800",onClick:V,children:[r.jsx(e1,{className:"h-3 w-3"}),"Print"]}),r.jsx("button",{type:"button",onClick:()=>v(!1),className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-slate-100 text-slate-600 hover:bg-slate-200",children:r.jsx(Kn,{className:"h-4 w-4"})})]})]}),r.jsx("div",{className:"flex-1 bg-slate-100",children:r.jsx("iframe",{src:f,title:"EMR PDF",className:"h-full w-full"})})]})}),w&&r.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/60",children:r.jsxs("div",{className:"relative flex h-[90vh] w-[95vw] max-w-4xl flex-col overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-2xl",children:[r.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 px-4 py-2.5",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-semibold text-slate-900",children:w.label}),r.jsxs("div",{className:"text-[11px] uppercase text-slate-400",children:[w.kind," preview"]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs(Te,{variant:"outline",size:"sm",className:"inline-flex items-center gap-1 rounded-full border-slate-200 bg-white text-[11px] text-slate-700 hover:bg-slate-100",onClick:()=>og(w.url,w.label),children:[r.jsx(to,{className:"h-3 w-3"}),"Download"]}),r.jsx("button",{type:"button",onClick:F,className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-slate-100 text-slate-600 hover:bg-slate-200",children:r.jsx(Kn,{className:"h-4 w-4"})})]})]}),r.jsxs("div",{className:"flex-1 bg-slate-100",children:[w.kind==="image"&&r.jsx("div",{className:"flex h-full w-full items-center justify-center overflow-auto bg-black",children:r.jsx("img",{src:w.url,alt:w.label,className:"max-h-full max-w-full object-contain"})}),w.kind==="pdf"&&r.jsx("iframe",{src:w.url,title:w.label,className:"h-full w-full"}),w.kind==="other"&&r.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-3 p-6 text-center text-sm text-slate-600",children:[r.jsx("p",{children:"This file type cant be previewed here. You can open it in a new tab or download it."}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(Te,{size:"sm",className:"rounded-full bg-slate-900 px-4 py-1 text-[11px] text-white hover:bg-slate-800",onClick:()=>window.open(w.url,"_blank","noopener,noreferrer"),children:"Open in new tab"}),r.jsx(Te,{variant:"outline",size:"sm",className:"rounded-full border-slate-200 bg-white px-4 py-1 text-[11px] text-slate-700 hover:bg-slate-100",onClick:()=>og(w.url,w.label),children:"Download"})]})]})]})]})})]})}const Qk=(t={})=>J.get("/templates/templates",{params:t}),Nye=t=>J.get(`/templates/templates/${t}`),wye=t=>J.post("/templates/templates",t),jye=(t,s)=>J.patch(`/templates/templates/${t}`,s),_ye=t=>J.delete(`/templates/templates/${t}`),Nz=(t,s,n=null)=>J.post(`/templates/templates/${t}/render-html`,n?{data:n}:{},{params:{patient_id:s}}),Sye=async(t,s)=>(await J.get(`/templates/templates/${t}/pdf`,{params:{patient_id:s,inline:!1},responseType:"blob"})).data,Cye=async(t,s)=>(await J.post(`/templates/templates/${t}/pdf`,s,{responseType:"blob"})).data,kye=(t,s)=>J.post(`/templates/patients/${t}/consents`,s),Aye=t=>J.get(`/templates/patients/${t}/consents`),Eye=async t=>{const s=new FormData;return s.append("file",t),(await J.post("/files/upload",s,{headers:{"Content-Type":"multipart/form-data"}})).data};function Tye(){const[t,s]=y.useState([]),[n,a]=y.useState(""),[i,l]=y.useState(""),[o,c]=y.useState(!1),d=async()=>{c(!0);try{const f=await Qk({q:n,category:i||void 0});s(f.data||[])}finally{c(!1)}};y.useEffect(()=>{d()},[]);const u=async f=>{f.preventDefault(),d()},h=async f=>{if(confirm("Delete this template?"))try{await _ye(f),se.success("Deleted"),d()}catch{}};return r.jsxs("div",{className:"p-4",children:[r.jsxs("div",{className:"mb-4 flex items-center justify-between gap-2",children:[r.jsx("h1",{className:"text-xl font-semibold",children:"Templates"}),r.jsx(bl,{to:"/templates/new",className:"bg-blue-600 text-white px-3 py-2 rounded-lg text-sm",children:"New Template"})]}),r.jsxs("form",{onSubmit:u,className:"mb-3 flex flex-wrap gap-2",children:[r.jsx("input",{value:n,onChange:f=>a(f.target.value),placeholder:"Search name/code...",className:"border rounded px-3 py-2 text-sm"}),r.jsxs("select",{value:i,onChange:f=>l(f.target.value),className:"border rounded px-3 py-2 text-sm",children:[r.jsx("option",{value:"",children:"All"}),r.jsx("option",{value:"report",children:"Report"}),r.jsx("option",{value:"consent",children:"Consent"})]}),r.jsx("button",{className:"px-3 py-2 border rounded text-sm",children:"Filter"})]}),r.jsx("div",{className:"overflow-x-auto bg-white border rounded-lg",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left",children:"#"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Name"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Code"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Category"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Version"}),r.jsx("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[t.map(f=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-3 py-2",children:f.id}),r.jsx("td",{className:"px-3 py-2",children:f.name}),r.jsx("td",{className:"px-3 py-2",children:f.code}),r.jsx("td",{className:"px-3 py-2 capitalize",children:f.category}),r.jsx("td",{className:"px-3 py-2",children:f.version}),r.jsxs("td",{className:"px-3 py-2 text-right",children:[r.jsx(bl,{to:`/templates/${f.id}/edit`,className:"px-2 py-1 text-blue-700 hover:underline",children:"Edit"}),r.jsx("button",{onClick:()=>h(f.id),className:"px-2 py-1 text-red-600 hover:underline",children:"Delete"})]})]},f.id)),t.length===0&&!o&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-3 py-6 text-center text-gray-500",children:"No templates"})})]})]})})]})}const VI=["system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif","Arial, Helvetica, sans-serif","'Times New Roman', Times, serif","'Georgia', serif","'Courier New', Courier, monospace","'Inter', system-ui, -apple-system, sans-serif"],HI=["#000000","#444444","#666666","#999999","#CCCCCC","#EEEEEE","#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB"];function xj({value:t,onChange:s}){const n=y.useRef(null),a=y.useRef(null),[i,l]=y.useState(VI[0]);y.useEffect(()=>{n.current&&n.current.innerHTML!==(t||"")&&(n.current.innerHTML=t||"")},[t]);const o=()=>{var D;return((D=n.current)==null?void 0:D.innerHTML)||""},c=()=>s&&s(o()),d=D=>{document.execCommand("styleWithCSS",!1,!0);const I=window.getSelection();if(!I||I.rangeCount===0)return;const M=I.getRangeAt(0),B=document.createElement("span");Object.entries(D).forEach(([L,F])=>B.style[L]=F),M.surroundContents(B),c()},u=(D,I=null)=>{document.execCommand("styleWithCSS",!1,!0),document.execCommand(D,!1,I),c()},h=(D,I="",M=null)=>{const B=window.getSelection();if(!B||B.rangeCount===0)return;const L=B.getRangeAt(0),F=document.createElement(D);I&&(F.className=I),M&&Object.entries(M).forEach(([V,$])=>F.style[V]=$),L.surroundContents(F),c()},f=()=>{var D;return(D=a.current)==null?void 0:D.click()},x=async D=>{var M,B;const I=(M=D.target.files)==null?void 0:M[0];if(I)try{const L=await Eye(I),F="".replace(/\/$/,""),V=L.file_url_abs?L.file_url_abs:(B=L.file_url)!=null&&B.startsWith("http")?L.file_url:`${F}${L.file_url}`;b(`<img src="${V}" alt="${L.original_name||""}" style="max-width:100%;">`)}catch{se.error("Upload failed")}finally{D.target.value=""}},b=D=>{var I;(I=n.current)==null||I.focus(),document.execCommand("insertHTML",!1,D),c()},v=()=>{var F;const D=window.getSelection();if(!D||D.rangeCount===0)return null;const I=D.getRangeAt(0),M=I.commonAncestorContainer.nodeType===1?I.commonAncestorContainer:I.commonAncestorContainer.parentNode;if(!M)return null;const B=M.querySelectorAll?M.querySelectorAll("img"):[],L=(F=D.anchorNode)==null?void 0:F.parentNode;if(L&&L.tagName==="IMG")return L;if(L!=null&&L.closest){const V=L.closest("img");if(V)return V}return B.length?B[0]:null},w=D=>{const I=v();if(!I)return se.info("Select an image first");I.style.width=D,D==="100%"&&(I.style.maxWidth="100%"),c()},_=D=>{const I=v();if(!I)return se.info("Select an image first");I.classList.remove("float-left","float-right","img-center"),I.style.removeProperty("float"),I.style.removeProperty("display"),I.style.removeProperty("margin-left"),I.style.removeProperty("margin-right"),D==="left"&&I.classList.add("float-left"),D==="right"&&I.classList.add("float-right"),D==="center"&&I.classList.add("img-center"),c()},S=D=>{var B,L;const I=window.getSelection();if(!I||I.rangeCount===0)return null;let M=((B=I.anchorNode)==null?void 0:B.nodeType)===1?I.anchorNode:(L=I.anchorNode)==null?void 0:L.parentNode;for(;M;){if(M.tagName&&D.includes(M.tagName))return M;M=M.parentNode}return null},k=D=>{var M;const I=S(["TABLE"])||((M=S(["TD","TH"]))==null?void 0:M.closest("TABLE"));if(!I)return se.info("Place caret inside a table");I.classList.remove("tbl-border-all","tbl-border-h","tbl-border-v","tbl-border-none"),I.removeAttribute("border"),I.style.borderCollapse="collapse",I.querySelectorAll("th,td").forEach(B=>{B.style.border="",B.style.borderTop="",B.style.borderBottom="",B.style.borderLeft="",B.style.borderRight=""}),D==="all"&&I.classList.add("tbl-border-all"),D==="h"&&I.classList.add("tbl-border-h"),D==="v"&&I.classList.add("tbl-border-v"),D==="none"&&I.classList.add("tbl-border-none"),c()},A=()=>{const D=S(["TD","TH"]);if(!D)return se.info("Place caret inside a row");D.closest("tr").classList.toggle("tr-shade"),c()},T=D=>{h("div",D===2?"cols-2":"cols-3")},P=D=>{D.preventDefault();const I=D.clipboardData.getData("text/plain");document.execCommand("insertText",!1,I),c()},O=D=>{D.preventDefault();const I=D.dataTransfer.getData("text/x-token")||D.dataTransfer.getData("text/plain");if(I){b(I);return}const M=D.dataTransfer.getData("text");M&&document.execCommand("insertText",!1,M),c()};return r.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2 p-2 border-b bg-gray-50",children:[r.jsx("select",{className:"text-sm border rounded px-2 py-1",value:i,onChange:D=>{l(D.target.value),d({fontFamily:D.target.value})},title:"Font family",children:VI.map(D=>r.jsx("option",{value:D,children:D.split(",")[0].replace(/['"]/g,"")},D))}),r.jsx("select",{className:"text-sm border rounded px-2 py-1",onChange:D=>d({fontSize:D.target.value}),children:["10px","12px","14px","16px","18px","20px","24px"].map(D=>r.jsx("option",{value:D,children:D},D))}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("bold"),children:r.jsx("b",{children:"B"})}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("italic"),children:r.jsx("i",{children:"I"})}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("underline"),children:r.jsx("u",{children:"U"})}),r.jsx("span",{className:"mx-1 w-px h-5 bg-gray-200"}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("justifyLeft"),children:"Left"}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("justifyCenter"),children:"Center"}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("justifyRight"),children:"Right"}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>h("span","text-justify"),children:"Justify"}),r.jsx("span",{className:"mx-1 w-px h-5 bg-gray-200"}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"text-xs text-gray-500 mr-1",children:"Text"}),HI.map(D=>r.jsx("button",{className:"w-4 h-4 rounded border",style:{background:D},onClick:()=>u("foreColor",D)},"fg"+D))]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"text-xs text-gray-500 ml-2 mr-1",children:"Highlight"}),HI.map(D=>r.jsx("button",{className:"w-4 h-4 rounded border",style:{background:D},onClick:()=>u("hiliteColor",D)},"bg"+D))]}),r.jsx("span",{className:"mx-1 w-px h-5 bg-gray-200"}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("insertUnorderedList"),children:" List"}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("insertOrderedList"),children:"1. List"}),r.jsx("span",{className:"mx-1 w-px h-5 bg-gray-200"}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:f,children:"Image"}),r.jsx("input",{ref:a,type:"file",accept:"image/*",className:"hidden",onChange:x}),r.jsxs("select",{className:"text-sm border rounded px-2 py-1",onChange:D=>w(D.target.value),defaultValue:"",children:[r.jsx("option",{value:"",disabled:!0,children:"Img Width"}),r.jsx("option",{value:"25%",children:"25%"}),r.jsx("option",{value:"33%",children:"33%"}),r.jsx("option",{value:"50%",children:"50%"}),r.jsx("option",{value:"75%",children:"75%"}),r.jsx("option",{value:"100%",children:"100%"})]}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>_("left"),children:"Img Left"}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>_("center"),children:"Img Center"}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>_("right"),children:"Img Right"}),r.jsx("span",{className:"mx-1 w-px h-5 bg-gray-200"}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>T(2),children:"2 Columns"}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>T(3),children:"3 Columns"}),r.jsx("span",{className:"mx-1 w-px h-5 bg-gray-200"}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>b("<table><tr><th>Header</th><th>Header</th></tr><tr><td>Cell</td><td>Cell</td></tr></table>"),children:"Insert Table"}),r.jsxs("select",{className:"text-sm border rounded px-2 py-1",onChange:D=>k(D.target.value),defaultValue:"",children:[r.jsx("option",{value:"",disabled:!0,children:"Borders"}),r.jsx("option",{value:"all",children:"All borders"}),r.jsx("option",{value:"h",children:"Horizontal only"}),r.jsx("option",{value:"v",children:"Vertical only"}),r.jsx("option",{value:"none",children:"No borders"})]}),r.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:A,children:"Shade Row"})]}),r.jsx("div",{ref:n,className:"min-h-[320px] p-3 prose max-w-none focus:outline-none",contentEditable:!0,onInput:c,onPaste:P,suppressContentEditableWarning:!0,spellCheck:!1}),r.jsx("div",{ref:n,className:"min-h-[320px] p-3 prose max-w-none focus:outline-none",contentEditable:!0,onInput:c,onPaste:P,onDragOver:D=>D.preventDefault(),onDrop:O,suppressContentEditableWarning:!0,spellCheck:!1}),r.jsx("div",{className:"px-3 py-1 text-[10px] text-gray-500 border-t bg-gray-50",children:"Tip: select an image to resize/align; use columns for magazine-style layouts."})]})}function Mr(t){this.content=t}Mr.prototype={constructor:Mr,find:function(t){for(var s=0;s<this.content.length;s+=2)if(this.content[s]===t)return s;return-1},get:function(t){var s=this.find(t);return s==-1?void 0:this.content[s+1]},update:function(t,s,n){var a=n&&n!=t?this.remove(n):this,i=a.find(t),l=a.content.slice();return i==-1?l.push(n||t,s):(l[i+1]=s,n&&(l[i]=n)),new Mr(l)},remove:function(t){var s=this.find(t);if(s==-1)return this;var n=this.content.slice();return n.splice(s,2),new Mr(n)},addToStart:function(t,s){return new Mr([t,s].concat(this.remove(t).content))},addToEnd:function(t,s){var n=this.remove(t).content.slice();return n.push(t,s),new Mr(n)},addBefore:function(t,s,n){var a=this.remove(s),i=a.content.slice(),l=a.find(t);return i.splice(l==-1?i.length:l,0,s,n),new Mr(i)},forEach:function(t){for(var s=0;s<this.content.length;s+=2)t(this.content[s],this.content[s+1])},prepend:function(t){return t=Mr.from(t),t.size?new Mr(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=Mr.from(t),t.size?new Mr(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var s=this;t=Mr.from(t);for(var n=0;n<t.content.length;n+=2)s=s.remove(t.content[n]);return s},toObject:function(){var t={};return this.forEach(function(s,n){t[s]=n}),t},get size(){return this.content.length>>1}};Mr.from=function(t){if(t instanceof Mr)return t;var s=[];if(t)for(var n in t)s.push(n,t[n]);return new Mr(s)};function wz(t,s,n){for(let a=0;;a++){if(a==t.childCount||a==s.childCount)return t.childCount==s.childCount?null:n;let i=t.child(a),l=s.child(a);if(i==l){n+=i.nodeSize;continue}if(!i.sameMarkup(l))return n;if(i.isText&&i.text!=l.text){for(let o=0;i.text[o]==l.text[o];o++)n++;return n}if(i.content.size||l.content.size){let o=wz(i.content,l.content,n+1);if(o!=null)return o}n+=i.nodeSize}}function jz(t,s,n,a){for(let i=t.childCount,l=s.childCount;;){if(i==0||l==0)return i==l?null:{a:n,b:a};let o=t.child(--i),c=s.child(--l),d=o.nodeSize;if(o==c){n-=d,a-=d;continue}if(!o.sameMarkup(c))return{a:n,b:a};if(o.isText&&o.text!=c.text){let u=0,h=Math.min(o.text.length,c.text.length);for(;u<h&&o.text[o.text.length-u-1]==c.text[c.text.length-u-1];)u++,n--,a--;return{a:n,b:a}}if(o.content.size||c.content.size){let u=jz(o.content,c.content,n-1,a-1);if(u)return u}n-=d,a-=d}}class ze{constructor(s,n){if(this.content=s,this.size=n||0,n==null)for(let a=0;a<s.length;a++)this.size+=s[a].nodeSize}nodesBetween(s,n,a,i=0,l){for(let o=0,c=0;c<n;o++){let d=this.content[o],u=c+d.nodeSize;if(u>s&&a(d,i+c,l||null,o)!==!1&&d.content.size){let h=c+1;d.nodesBetween(Math.max(0,s-h),Math.min(d.content.size,n-h),a,i+h)}c=u}}descendants(s){this.nodesBetween(0,this.size,s)}textBetween(s,n,a,i){let l="",o=!0;return this.nodesBetween(s,n,(c,d)=>{let u=c.isText?c.text.slice(Math.max(s,d)-d,n-d):c.isLeaf?i?typeof i=="function"?i(c):i:c.type.spec.leafText?c.type.spec.leafText(c):"":"";c.isBlock&&(c.isLeaf&&u||c.isTextblock)&&a&&(o?o=!1:l+=a),l+=u},0),l}append(s){if(!s.size)return this;if(!this.size)return s;let n=this.lastChild,a=s.firstChild,i=this.content.slice(),l=0;for(n.isText&&n.sameMarkup(a)&&(i[i.length-1]=n.withText(n.text+a.text),l=1);l<s.content.length;l++)i.push(s.content[l]);return new ze(i,this.size+s.size)}cut(s,n=this.size){if(s==0&&n==this.size)return this;let a=[],i=0;if(n>s)for(let l=0,o=0;o<n;l++){let c=this.content[l],d=o+c.nodeSize;d>s&&((o<s||d>n)&&(c.isText?c=c.cut(Math.max(0,s-o),Math.min(c.text.length,n-o)):c=c.cut(Math.max(0,s-o-1),Math.min(c.content.size,n-o-1))),a.push(c),i+=c.nodeSize),o=d}return new ze(a,i)}cutByIndex(s,n){return s==n?ze.empty:s==0&&n==this.content.length?this:new ze(this.content.slice(s,n))}replaceChild(s,n){let a=this.content[s];if(a==n)return this;let i=this.content.slice(),l=this.size+n.nodeSize-a.nodeSize;return i[s]=n,new ze(i,l)}addToStart(s){return new ze([s].concat(this.content),this.size+s.nodeSize)}addToEnd(s){return new ze(this.content.concat(s),this.size+s.nodeSize)}eq(s){if(this.content.length!=s.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(s.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(s){let n=this.content[s];if(!n)throw new RangeError("Index "+s+" out of range for "+this);return n}maybeChild(s){return this.content[s]||null}forEach(s){for(let n=0,a=0;n<this.content.length;n++){let i=this.content[n];s(i,a,n),a+=i.nodeSize}}findDiffStart(s,n=0){return wz(this,s,n)}findDiffEnd(s,n=this.size,a=s.size){return jz(this,s,n,a)}findIndex(s){if(s==0)return cg(0,s);if(s==this.size)return cg(this.content.length,s);if(s>this.size||s<0)throw new RangeError(`Position ${s} outside of fragment (${this})`);for(let n=0,a=0;;n++){let i=this.child(n),l=a+i.nodeSize;if(l>=s)return l==s?cg(n+1,l):cg(n,a);a=l}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(s=>s.toJSON()):null}static fromJSON(s,n){if(!n)return ze.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new ze(n.map(s.nodeFromJSON))}static fromArray(s){if(!s.length)return ze.empty;let n,a=0;for(let i=0;i<s.length;i++){let l=s[i];a+=l.nodeSize,i&&l.isText&&s[i-1].sameMarkup(l)?(n||(n=s.slice(0,i)),n[n.length-1]=l.withText(n[n.length-1].text+l.text)):n&&n.push(l)}return new ze(n||s,a)}static from(s){if(!s)return ze.empty;if(s instanceof ze)return s;if(Array.isArray(s))return this.fromArray(s);if(s.attrs)return new ze([s],s.nodeSize);throw new RangeError("Can not convert "+s+" to a Fragment"+(s.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}ze.empty=new ze([],0);const gj={index:0,offset:0};function cg(t,s){return gj.index=t,gj.offset=s,gj}function y1(t,s){if(t===s)return!0;if(!(t&&typeof t=="object")||!(s&&typeof s=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(s)!=n)return!1;if(n){if(t.length!=s.length)return!1;for(let a=0;a<t.length;a++)if(!y1(t[a],s[a]))return!1}else{for(let a in t)if(!(a in s)||!y1(t[a],s[a]))return!1;for(let a in s)if(!(a in t))return!1}return!0}let en=class yS{constructor(s,n){this.type=s,this.attrs=n}addToSet(s){let n,a=!1;for(let i=0;i<s.length;i++){let l=s[i];if(this.eq(l))return s;if(this.type.excludes(l.type))n||(n=s.slice(0,i));else{if(l.type.excludes(this.type))return s;!a&&l.type.rank>this.type.rank&&(n||(n=s.slice(0,i)),n.push(this),a=!0),n&&n.push(l)}}return n||(n=s.slice()),a||n.push(this),n}removeFromSet(s){for(let n=0;n<s.length;n++)if(this.eq(s[n]))return s.slice(0,n).concat(s.slice(n+1));return s}isInSet(s){for(let n=0;n<s.length;n++)if(this.eq(s[n]))return!0;return!1}eq(s){return this==s||this.type==s.type&&y1(this.attrs,s.attrs)}toJSON(){let s={type:this.type.name};for(let n in this.attrs){s.attrs=this.attrs;break}return s}static fromJSON(s,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let a=s.marks[n.type];if(!a)throw new RangeError(`There is no mark type ${n.type} in this schema`);let i=a.create(n.attrs);return a.checkAttrs(i.attrs),i}static sameSet(s,n){if(s==n)return!0;if(s.length!=n.length)return!1;for(let a=0;a<s.length;a++)if(!s[a].eq(n[a]))return!1;return!0}static setFrom(s){if(!s||Array.isArray(s)&&s.length==0)return yS.none;if(s instanceof yS)return[s];let n=s.slice();return n.sort((a,i)=>a.type.rank-i.type.rank),n}};en.none=[];class b1 extends Error{}class ct{constructor(s,n,a){this.content=s,this.openStart=n,this.openEnd=a}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(s,n){let a=Sz(this.content,s+this.openStart,n);return a&&new ct(a,this.openStart,this.openEnd)}removeBetween(s,n){return new ct(_z(this.content,s+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(s){return this.content.eq(s.content)&&this.openStart==s.openStart&&this.openEnd==s.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let s={content:this.content.toJSON()};return this.openStart>0&&(s.openStart=this.openStart),this.openEnd>0&&(s.openEnd=this.openEnd),s}static fromJSON(s,n){if(!n)return ct.empty;let a=n.openStart||0,i=n.openEnd||0;if(typeof a!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new ct(ze.fromJSON(s,n.content),a,i)}static maxOpen(s,n=!0){let a=0,i=0;for(let l=s.firstChild;l&&!l.isLeaf&&(n||!l.type.spec.isolating);l=l.firstChild)a++;for(let l=s.lastChild;l&&!l.isLeaf&&(n||!l.type.spec.isolating);l=l.lastChild)i++;return new ct(s,a,i)}}ct.empty=new ct(ze.empty,0,0);function _z(t,s,n){let{index:a,offset:i}=t.findIndex(s),l=t.maybeChild(a),{index:o,offset:c}=t.findIndex(n);if(i==s||l.isText){if(c!=n&&!t.child(o).isText)throw new RangeError("Removing non-flat range");return t.cut(0,s).append(t.cut(n))}if(a!=o)throw new RangeError("Removing non-flat range");return t.replaceChild(a,l.copy(_z(l.content,s-i-1,n-i-1)))}function Sz(t,s,n,a){let{index:i,offset:l}=t.findIndex(s),o=t.maybeChild(i);if(l==s||o.isText)return a&&!a.canReplace(i,i,n)?null:t.cut(0,s).append(n).append(t.cut(s));let c=Sz(o.content,s-l-1,n,o);return c&&t.replaceChild(i,o.copy(c))}function Pye(t,s,n){if(n.openStart>t.depth)throw new b1("Inserted content deeper than insertion position");if(t.depth-n.openStart!=s.depth-n.openEnd)throw new b1("Inconsistent open depths");return Cz(t,s,n,0)}function Cz(t,s,n,a){let i=t.index(a),l=t.node(a);if(i==s.index(a)&&a<t.depth-n.openStart){let o=Cz(t,s,n,a+1);return l.copy(l.content.replaceChild(i,o))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==a&&s.depth==a){let o=t.parent,c=o.content;return du(o,c.cut(0,t.parentOffset).append(n.content).append(c.cut(s.parentOffset)))}else{let{start:o,end:c}=Iye(n,t);return du(l,Az(t,o,c,s,a))}else return du(l,v1(t,s,a))}function kz(t,s){if(!s.type.compatibleContent(t.type))throw new b1("Cannot join "+s.type.name+" onto "+t.type.name)}function bS(t,s,n){let a=t.node(n);return kz(a,s.node(n)),a}function cu(t,s){let n=s.length-1;n>=0&&t.isText&&t.sameMarkup(s[n])?s[n]=t.withText(s[n].text+t.text):s.push(t)}function wp(t,s,n,a){let i=(s||t).node(n),l=0,o=s?s.index(n):i.childCount;t&&(l=t.index(n),t.depth>n?l++:t.textOffset&&(cu(t.nodeAfter,a),l++));for(let c=l;c<o;c++)cu(i.child(c),a);s&&s.depth==n&&s.textOffset&&cu(s.nodeBefore,a)}function du(t,s){return t.type.checkContent(s),t.copy(s)}function Az(t,s,n,a,i){let l=t.depth>i&&bS(t,s,i+1),o=a.depth>i&&bS(n,a,i+1),c=[];return wp(null,t,i,c),l&&o&&s.index(i)==n.index(i)?(kz(l,o),cu(du(l,Az(t,s,n,a,i+1)),c)):(l&&cu(du(l,v1(t,s,i+1)),c),wp(s,n,i,c),o&&cu(du(o,v1(n,a,i+1)),c)),wp(a,null,i,c),new ze(c)}function v1(t,s,n){let a=[];if(wp(null,t,n,a),t.depth>n){let i=bS(t,s,n+1);cu(du(i,v1(t,s,n+1)),a)}return wp(s,null,n,a),new ze(a)}function Iye(t,s){let n=s.depth-t.openStart,i=s.node(n).copy(t.content);for(let l=n-1;l>=0;l--)i=s.node(l).copy(ze.from(i));return{start:i.resolveNoCache(t.openStart+n),end:i.resolveNoCache(i.content.size-t.openEnd-n)}}class ix{constructor(s,n,a){this.pos=s,this.path=n,this.parentOffset=a,this.depth=n.length/3-1}resolveDepth(s){return s==null?this.depth:s<0?this.depth+s:s}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(s){return this.path[this.resolveDepth(s)*3]}index(s){return this.path[this.resolveDepth(s)*3+1]}indexAfter(s){return s=this.resolveDepth(s),this.index(s)+(s==this.depth&&!this.textOffset?0:1)}start(s){return s=this.resolveDepth(s),s==0?0:this.path[s*3-1]+1}end(s){return s=this.resolveDepth(s),this.start(s)+this.node(s).content.size}before(s){if(s=this.resolveDepth(s),!s)throw new RangeError("There is no position before the top-level node");return s==this.depth+1?this.pos:this.path[s*3-1]}after(s){if(s=this.resolveDepth(s),!s)throw new RangeError("There is no position after the top-level node");return s==this.depth+1?this.pos:this.path[s*3-1]+this.path[s*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let s=this.parent,n=this.index(this.depth);if(n==s.childCount)return null;let a=this.pos-this.path[this.path.length-1],i=s.child(n);return a?s.child(n).cut(a):i}get nodeBefore(){let s=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(s).cut(0,n):s==0?null:this.parent.child(s-1)}posAtIndex(s,n){n=this.resolveDepth(n);let a=this.path[n*3],i=n==0?0:this.path[n*3-1]+1;for(let l=0;l<s;l++)i+=a.child(l).nodeSize;return i}marks(){let s=this.parent,n=this.index();if(s.content.size==0)return en.none;if(this.textOffset)return s.child(n).marks;let a=s.maybeChild(n-1),i=s.maybeChild(n);if(!a){let c=a;a=i,i=c}let l=a.marks;for(var o=0;o<l.length;o++)l[o].type.spec.inclusive===!1&&(!i||!l[o].isInSet(i.marks))&&(l=l[o--].removeFromSet(l));return l}marksAcross(s){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let a=n.marks,i=s.parent.maybeChild(s.index());for(var l=0;l<a.length;l++)a[l].type.spec.inclusive===!1&&(!i||!a[l].isInSet(i.marks))&&(a=a[l--].removeFromSet(a));return a}sharedDepth(s){for(let n=this.depth;n>0;n--)if(this.start(n)<=s&&this.end(n)>=s)return n;return 0}blockRange(s=this,n){if(s.pos<this.pos)return s.blockRange(this);for(let a=this.depth-(this.parent.inlineContent||this.pos==s.pos?1:0);a>=0;a--)if(s.pos<=this.end(a)&&(!n||n(this.node(a))))return new N1(this,s,a);return null}sameParent(s){return this.pos-this.parentOffset==s.pos-s.parentOffset}max(s){return s.pos>this.pos?s:this}min(s){return s.pos<this.pos?s:this}toString(){let s="";for(let n=1;n<=this.depth;n++)s+=(s?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return s+":"+this.parentOffset}static resolve(s,n){if(!(n>=0&&n<=s.content.size))throw new RangeError("Position "+n+" out of range");let a=[],i=0,l=n;for(let o=s;;){let{index:c,offset:d}=o.content.findIndex(l),u=l-d;if(a.push(o,c,i+d),!u||(o=o.child(c),o.isText))break;l=u-1,i+=d+1}return new ix(n,a,l)}static resolveCached(s,n){let a=WI.get(s);if(a)for(let l=0;l<a.elts.length;l++){let o=a.elts[l];if(o.pos==n)return o}else WI.set(s,a=new Mye);let i=a.elts[a.i]=ix.resolve(s,n);return a.i=(a.i+1)%Dye,i}}class Mye{constructor(){this.elts=[],this.i=0}}const Dye=12,WI=new WeakMap;class N1{constructor(s,n,a){this.$from=s,this.$to=n,this.depth=a}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const Oye=Object.create(null);let Jc=class vS{constructor(s,n,a,i=en.none){this.type=s,this.attrs=n,this.marks=i,this.content=a||ze.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(s){return this.content.child(s)}maybeChild(s){return this.content.maybeChild(s)}forEach(s){this.content.forEach(s)}nodesBetween(s,n,a,i=0){this.content.nodesBetween(s,n,a,i,this)}descendants(s){this.nodesBetween(0,this.content.size,s)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(s,n,a,i){return this.content.textBetween(s,n,a,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(s){return this==s||this.sameMarkup(s)&&this.content.eq(s.content)}sameMarkup(s){return this.hasMarkup(s.type,s.attrs,s.marks)}hasMarkup(s,n,a){return this.type==s&&y1(this.attrs,n||s.defaultAttrs||Oye)&&en.sameSet(this.marks,a||en.none)}copy(s=null){return s==this.content?this:new vS(this.type,this.attrs,s,this.marks)}mark(s){return s==this.marks?this:new vS(this.type,this.attrs,this.content,s)}cut(s,n=this.content.size){return s==0&&n==this.content.size?this:this.copy(this.content.cut(s,n))}slice(s,n=this.content.size,a=!1){if(s==n)return ct.empty;let i=this.resolve(s),l=this.resolve(n),o=a?0:i.sharedDepth(n),c=i.start(o),u=i.node(o).content.cut(i.pos-c,l.pos-c);return new ct(u,i.depth-o,l.depth-o)}replace(s,n,a){return Pye(this.resolve(s),this.resolve(n),a)}nodeAt(s){for(let n=this;;){let{index:a,offset:i}=n.content.findIndex(s);if(n=n.maybeChild(a),!n)return null;if(i==s||n.isText)return n;s-=i+1}}childAfter(s){let{index:n,offset:a}=this.content.findIndex(s);return{node:this.content.maybeChild(n),index:n,offset:a}}childBefore(s){if(s==0)return{node:null,index:0,offset:0};let{index:n,offset:a}=this.content.findIndex(s);if(a<s)return{node:this.content.child(n),index:n,offset:a};let i=this.content.child(n-1);return{node:i,index:n-1,offset:a-i.nodeSize}}resolve(s){return ix.resolveCached(this,s)}resolveNoCache(s){return ix.resolve(this,s)}rangeHasMark(s,n,a){let i=!1;return n>s&&this.nodesBetween(s,n,l=>(a.isInSet(l.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let s=this.type.name;return this.content.size&&(s+="("+this.content.toStringInner()+")"),Ez(this.marks,s)}contentMatchAt(s){let n=this.type.contentMatch.matchFragment(this.content,0,s);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(s,n,a=ze.empty,i=0,l=a.childCount){let o=this.contentMatchAt(s).matchFragment(a,i,l),c=o&&o.matchFragment(this.content,n);if(!c||!c.validEnd)return!1;for(let d=i;d<l;d++)if(!this.type.allowsMarks(a.child(d).marks))return!1;return!0}canReplaceWith(s,n,a,i){if(i&&!this.type.allowsMarks(i))return!1;let l=this.contentMatchAt(s).matchType(a),o=l&&l.matchFragment(this.content,n);return o?o.validEnd:!1}canAppend(s){return s.content.size?this.canReplace(this.childCount,this.childCount,s.content):this.type.compatibleContent(s.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let s=en.none;for(let n=0;n<this.marks.length;n++){let a=this.marks[n];a.type.checkAttrs(a.attrs),s=a.addToSet(s)}if(!en.sameSet(s,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let s={type:this.type.name};for(let n in this.attrs){s.attrs=this.attrs;break}return this.content.size&&(s.content=this.content.toJSON()),this.marks.length&&(s.marks=this.marks.map(n=>n.toJSON())),s}static fromJSON(s,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let a;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");a=n.marks.map(s.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return s.text(n.text,a)}let i=ze.fromJSON(s,n.content),l=s.nodeType(n.type).create(n.attrs,i,a);return l.type.checkAttrs(l.attrs),l}};Jc.prototype.text=void 0;class w1 extends Jc{constructor(s,n,a,i){if(super(s,n,null,i),!a)throw new RangeError("Empty text nodes are not allowed");this.text=a}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Ez(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(s,n){return this.text.slice(s,n)}get nodeSize(){return this.text.length}mark(s){return s==this.marks?this:new w1(this.type,this.attrs,this.text,s)}withText(s){return s==this.text?this:new w1(this.type,this.attrs,s,this.marks)}cut(s=0,n=this.text.length){return s==0&&n==this.text.length?this:this.withText(this.text.slice(s,n))}eq(s){return this.sameMarkup(s)&&this.text==s.text}toJSON(){let s=super.toJSON();return s.text=this.text,s}}function Ez(t,s){for(let n=t.length-1;n>=0;n--)s=t[n].type.name+"("+s+")";return s}class Eu{constructor(s){this.validEnd=s,this.next=[],this.wrapCache=[]}static parse(s,n){let a=new Rye(s,n);if(a.next==null)return Eu.empty;let i=Tz(a);a.next&&a.err("Unexpected trailing text");let l=Vye(Uye(i));return Hye(l,a),l}matchType(s){for(let n=0;n<this.next.length;n++)if(this.next[n].type==s)return this.next[n].next;return null}matchFragment(s,n=0,a=s.childCount){let i=this;for(let l=n;i&&l<a;l++)i=i.matchType(s.child(l).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let s=0;s<this.next.length;s++){let{type:n}=this.next[s];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(s){for(let n=0;n<this.next.length;n++)for(let a=0;a<s.next.length;a++)if(this.next[n].type==s.next[a].type)return!0;return!1}fillBefore(s,n=!1,a=0){let i=[this];function l(o,c){let d=o.matchFragment(s,a);if(d&&(!n||d.validEnd))return ze.from(c.map(u=>u.createAndFill()));for(let u=0;u<o.next.length;u++){let{type:h,next:f}=o.next[u];if(!(h.isText||h.hasRequiredAttrs())&&i.indexOf(f)==-1){i.push(f);let x=l(f,c.concat(h));if(x)return x}}return null}return l(this,[])}findWrapping(s){for(let a=0;a<this.wrapCache.length;a+=2)if(this.wrapCache[a]==s)return this.wrapCache[a+1];let n=this.computeWrapping(s);return this.wrapCache.push(s,n),n}computeWrapping(s){let n=Object.create(null),a=[{match:this,type:null,via:null}];for(;a.length;){let i=a.shift(),l=i.match;if(l.matchType(s)){let o=[];for(let c=i;c.type;c=c.via)o.push(c.type);return o.reverse()}for(let o=0;o<l.next.length;o++){let{type:c,next:d}=l.next[o];!c.isLeaf&&!c.hasRequiredAttrs()&&!(c.name in n)&&(!i.type||d.validEnd)&&(a.push({match:c.contentMatch,type:c,via:i}),n[c.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(s){if(s>=this.next.length)throw new RangeError(`There's no ${s}th edge in this content match`);return this.next[s]}toString(){let s=[];function n(a){s.push(a);for(let i=0;i<a.next.length;i++)s.indexOf(a.next[i].next)==-1&&n(a.next[i].next)}return n(this),s.map((a,i)=>{let l=i+(a.validEnd?"*":" ")+" ";for(let o=0;o<a.next.length;o++)l+=(o?", ":"")+a.next[o].type.name+"->"+s.indexOf(a.next[o].next);return l}).join(`
`)}}Eu.empty=new Eu(!0);class Rye{constructor(s,n){this.string=s,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=s.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(s){return this.next==s&&(this.pos++||!0)}err(s){throw new SyntaxError(s+" (in content expression '"+this.string+"')")}}function Tz(t){let s=[];do s.push(Lye(t));while(t.eat("|"));return s.length==1?s[0]:{type:"choice",exprs:s}}function Lye(t){let s=[];do s.push(Bye(t));while(t.next&&t.next!=")"&&t.next!="|");return s.length==1?s[0]:{type:"seq",exprs:s}}function Bye(t){let s=zye(t);for(;;)if(t.eat("+"))s={type:"plus",expr:s};else if(t.eat("*"))s={type:"star",expr:s};else if(t.eat("?"))s={type:"opt",expr:s};else if(t.eat("{"))s=Fye(t,s);else break;return s}function qI(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let s=Number(t.next);return t.pos++,s}function Fye(t,s){let n=qI(t),a=n;return t.eat(",")&&(t.next!="}"?a=qI(t):a=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:a,expr:s}}function $ye(t,s){let n=t.nodeTypes,a=n[s];if(a)return[a];let i=[];for(let l in n){let o=n[l];o.isInGroup(s)&&i.push(o)}return i.length==0&&t.err("No node type or group '"+s+"' found"),i}function zye(t){if(t.eat("(")){let s=Tz(t);return t.eat(")")||t.err("Missing closing paren"),s}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let s=$ye(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,s.length==1?s[0]:{type:"choice",exprs:s}}}function Uye(t){let s=[[]];return i(l(t,0),n()),s;function n(){return s.push([])-1}function a(o,c,d){let u={term:d,to:c};return s[o].push(u),u}function i(o,c){o.forEach(d=>d.to=c)}function l(o,c){if(o.type=="choice")return o.exprs.reduce((d,u)=>d.concat(l(u,c)),[]);if(o.type=="seq")for(let d=0;;d++){let u=l(o.exprs[d],c);if(d==o.exprs.length-1)return u;i(u,c=n())}else if(o.type=="star"){let d=n();return a(c,d),i(l(o.expr,d),d),[a(d)]}else if(o.type=="plus"){let d=n();return i(l(o.expr,c),d),i(l(o.expr,d),d),[a(d)]}else{if(o.type=="opt")return[a(c)].concat(l(o.expr,c));if(o.type=="range"){let d=c;for(let u=0;u<o.min;u++){let h=n();i(l(o.expr,d),h),d=h}if(o.max==-1)i(l(o.expr,d),d);else for(let u=o.min;u<o.max;u++){let h=n();a(d,h),i(l(o.expr,d),h),d=h}return[a(d)]}else{if(o.type=="name")return[a(c,void 0,o.value)];throw new Error("Unknown expr type")}}}}function Pz(t,s){return s-t}function GI(t,s){let n=[];return a(s),n.sort(Pz);function a(i){let l=t[i];if(l.length==1&&!l[0].term)return a(l[0].to);n.push(i);for(let o=0;o<l.length;o++){let{term:c,to:d}=l[o];!c&&n.indexOf(d)==-1&&a(d)}}}function Vye(t){let s=Object.create(null);return n(GI(t,0));function n(a){let i=[];a.forEach(o=>{t[o].forEach(({term:c,to:d})=>{if(!c)return;let u;for(let h=0;h<i.length;h++)i[h][0]==c&&(u=i[h][1]);GI(t,d).forEach(h=>{u||i.push([c,u=[]]),u.indexOf(h)==-1&&u.push(h)})})});let l=s[a.join(",")]=new Eu(a.indexOf(t.length-1)>-1);for(let o=0;o<i.length;o++){let c=i[o][1].sort(Pz);l.next.push({type:i[o][0],next:s[c.join(",")]||n(c)})}return l}}function Hye(t,s){for(let n=0,a=[t];n<a.length;n++){let i=a[n],l=!i.validEnd,o=[];for(let c=0;c<i.next.length;c++){let{type:d,next:u}=i.next[c];o.push(d.name),l&&!(d.isText||d.hasRequiredAttrs())&&(l=!1),a.indexOf(u)==-1&&a.push(u)}l&&s.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Iz(t){let s=Object.create(null);for(let n in t){let a=t[n];if(!a.hasDefault)return null;s[n]=a.default}return s}function Mz(t,s){let n=Object.create(null);for(let a in t){let i=s&&s[a];if(i===void 0){let l=t[a];if(l.hasDefault)i=l.default;else throw new RangeError("No value supplied for attribute "+a)}n[a]=i}return n}function Dz(t,s,n,a){for(let i in s)if(!(i in t))throw new RangeError(`Unsupported attribute ${i} for ${n} of type ${i}`);for(let i in t){let l=t[i];l.validate&&l.validate(s[i])}}function Oz(t,s){let n=Object.create(null);if(s)for(let a in s)n[a]=new qye(t,a,s[a]);return n}let KI=class Rz{constructor(s,n,a){this.name=s,this.schema=n,this.spec=a,this.markSet=null,this.groups=a.group?a.group.split(" "):[],this.attrs=Oz(s,a.attrs),this.defaultAttrs=Iz(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(a.inline||s=="text"),this.isText=s=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Eu.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(s){return this.groups.indexOf(s)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let s in this.attrs)if(this.attrs[s].isRequired)return!0;return!1}compatibleContent(s){return this==s||this.contentMatch.compatible(s.contentMatch)}computeAttrs(s){return!s&&this.defaultAttrs?this.defaultAttrs:Mz(this.attrs,s)}create(s=null,n,a){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Jc(this,this.computeAttrs(s),ze.from(n),en.setFrom(a))}createChecked(s=null,n,a){return n=ze.from(n),this.checkContent(n),new Jc(this,this.computeAttrs(s),n,en.setFrom(a))}createAndFill(s=null,n,a){if(s=this.computeAttrs(s),n=ze.from(n),n.size){let o=this.contentMatch.fillBefore(n);if(!o)return null;n=o.append(n)}let i=this.contentMatch.matchFragment(n),l=i&&i.fillBefore(ze.empty,!0);return l?new Jc(this,s,n.append(l),en.setFrom(a)):null}validContent(s){let n=this.contentMatch.matchFragment(s);if(!n||!n.validEnd)return!1;for(let a=0;a<s.childCount;a++)if(!this.allowsMarks(s.child(a).marks))return!1;return!0}checkContent(s){if(!this.validContent(s))throw new RangeError(`Invalid content for node ${this.name}: ${s.toString().slice(0,50)}`)}checkAttrs(s){Dz(this.attrs,s,"node",this.name)}allowsMarkType(s){return this.markSet==null||this.markSet.indexOf(s)>-1}allowsMarks(s){if(this.markSet==null)return!0;for(let n=0;n<s.length;n++)if(!this.allowsMarkType(s[n].type))return!1;return!0}allowedMarks(s){if(this.markSet==null)return s;let n;for(let a=0;a<s.length;a++)this.allowsMarkType(s[a].type)?n&&n.push(s[a]):n||(n=s.slice(0,a));return n?n.length?n:en.none:s}static compile(s,n){let a=Object.create(null);s.forEach((l,o)=>a[l]=new Rz(l,n,o));let i=n.spec.topNode||"doc";if(!a[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!a.text)throw new RangeError("Every schema needs a 'text' type");for(let l in a.text.attrs)throw new RangeError("The text node type should not have attributes");return a}};function Wye(t,s,n){let a=n.split("|");return i=>{let l=i===null?"null":typeof i;if(a.indexOf(l)<0)throw new RangeError(`Expected value of type ${a} for attribute ${s} on type ${t}, got ${l}`)}}class qye{constructor(s,n,a){this.hasDefault=Object.prototype.hasOwnProperty.call(a,"default"),this.default=a.default,this.validate=typeof a.validate=="string"?Wye(s,n,a.validate):a.validate}get isRequired(){return!this.hasDefault}}class Ev{constructor(s,n,a,i){this.name=s,this.rank=n,this.schema=a,this.spec=i,this.attrs=Oz(s,i.attrs),this.excluded=null;let l=Iz(this.attrs);this.instance=l?new en(this,l):null}create(s=null){return!s&&this.instance?this.instance:new en(this,Mz(this.attrs,s))}static compile(s,n){let a=Object.create(null),i=0;return s.forEach((l,o)=>a[l]=new Ev(l,i++,n,o)),a}removeFromSet(s){for(var n=0;n<s.length;n++)s[n].type==this&&(s=s.slice(0,n).concat(s.slice(n+1)),n--);return s}isInSet(s){for(let n=0;n<s.length;n++)if(s[n].type==this)return s[n]}checkAttrs(s){Dz(this.attrs,s,"mark",this.name)}excludes(s){return this.excluded.indexOf(s)>-1}}class Lz{constructor(s){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let i in s)n[i]=s[i];n.nodes=Mr.from(s.nodes),n.marks=Mr.from(s.marks||{}),this.nodes=KI.compile(this.spec.nodes,this),this.marks=Ev.compile(this.spec.marks,this);let a=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let l=this.nodes[i],o=l.spec.content||"",c=l.spec.marks;if(l.contentMatch=a[o]||(a[o]=Eu.parse(o,this.nodes)),l.inlineContent=l.contentMatch.inlineContent,l.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!l.isInline||!l.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=l}l.markSet=c=="_"?null:c?YI(this,c.split(" ")):c==""||!l.inlineContent?[]:null}for(let i in this.marks){let l=this.marks[i],o=l.spec.excludes;l.excluded=o==null?[l]:o==""?[]:YI(this,o.split(" "))}this.nodeFromJSON=i=>Jc.fromJSON(this,i),this.markFromJSON=i=>en.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(s,n=null,a,i){if(typeof s=="string")s=this.nodeType(s);else if(s instanceof KI){if(s.schema!=this)throw new RangeError("Node type from different schema used ("+s.name+")")}else throw new RangeError("Invalid node type: "+s);return s.createChecked(n,a,i)}text(s,n){let a=this.nodes.text;return new w1(a,a.defaultAttrs,s,en.setFrom(n))}mark(s,n){return typeof s=="string"&&(s=this.marks[s]),s.create(n)}nodeType(s){let n=this.nodes[s];if(!n)throw new RangeError("Unknown node type: "+s);return n}}function YI(t,s){let n=[];for(let a=0;a<s.length;a++){let i=s[a],l=t.marks[i],o=l;if(l)n.push(l);else for(let c in t.marks){let d=t.marks[c];(i=="_"||d.spec.group&&d.spec.group.split(" ").indexOf(i)>-1)&&n.push(o=d)}if(!o)throw new SyntaxError("Unknown mark type: '"+s[a]+"'")}return n}function Gye(t){return t.tag!=null}function Kye(t){return t.style!=null}class ao{constructor(s,n){this.schema=s,this.rules=n,this.tags=[],this.styles=[];let a=this.matchedStyles=[];n.forEach(i=>{if(Gye(i))this.tags.push(i);else if(Kye(i)){let l=/[^=]*/.exec(i.style)[0];a.indexOf(l)<0&&a.push(l),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let l=s.nodes[i.node];return l.contentMatch.matchType(l)})}parse(s,n={}){let a=new QI(this,n,!1);return a.addAll(s,en.none,n.from,n.to),a.finish()}parseSlice(s,n={}){let a=new QI(this,n,!0);return a.addAll(s,en.none,n.from,n.to),ct.maxOpen(a.finish())}matchTag(s,n,a){for(let i=a?this.tags.indexOf(a)+1:0;i<this.tags.length;i++){let l=this.tags[i];if(Qye(s,l.tag)&&(l.namespace===void 0||s.namespaceURI==l.namespace)&&(!l.context||n.matchesContext(l.context))){if(l.getAttrs){let o=l.getAttrs(s);if(o===!1)continue;l.attrs=o||void 0}return l}}}matchStyle(s,n,a,i){for(let l=i?this.styles.indexOf(i)+1:0;l<this.styles.length;l++){let o=this.styles[l],c=o.style;if(!(c.indexOf(s)!=0||o.context&&!a.matchesContext(o.context)||c.length>s.length&&(c.charCodeAt(s.length)!=61||c.slice(s.length+1)!=n))){if(o.getAttrs){let d=o.getAttrs(n);if(d===!1)continue;o.attrs=d||void 0}return o}}}static schemaRules(s){let n=[];function a(i){let l=i.priority==null?50:i.priority,o=0;for(;o<n.length;o++){let c=n[o];if((c.priority==null?50:c.priority)<l)break}n.splice(o,0,i)}for(let i in s.marks){let l=s.marks[i].spec.parseDOM;l&&l.forEach(o=>{a(o=ZI(o)),o.mark||o.ignore||o.clearMark||(o.mark=i)})}for(let i in s.nodes){let l=s.nodes[i].spec.parseDOM;l&&l.forEach(o=>{a(o=ZI(o)),o.node||o.ignore||o.mark||(o.node=i)})}return n}static fromSchema(s){return s.cached.domParser||(s.cached.domParser=new ao(s,ao.schemaRules(s)))}}const Bz={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Yye={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Fz={ol:!0,ul:!0},lx=1,NS=2,jp=4;function XI(t,s,n){return s!=null?(s?lx:0)|(s==="full"?NS:0):t&&t.whitespace=="pre"?lx|NS:n&~jp}class dg{constructor(s,n,a,i,l,o){this.type=s,this.attrs=n,this.marks=a,this.solid=i,this.options=o,this.content=[],this.activeMarks=en.none,this.match=l||(o&jp?null:s.contentMatch)}findWrapping(s){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(ze.from(s));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let a=this.type.contentMatch,i;return(i=a.findWrapping(s.type))?(this.match=a,i):null}}return this.match.findWrapping(s.type)}finish(s){if(!(this.options&lx)){let a=this.content[this.content.length-1],i;if(a&&a.isText&&(i=/[ \t\r\n\u000c]+$/.exec(a.text))){let l=a;a.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=l.withText(l.text.slice(0,l.text.length-i[0].length))}}let n=ze.from(this.content);return!s&&this.match&&(n=n.append(this.match.fillBefore(ze.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(s){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:s.parentNode&&!Bz.hasOwnProperty(s.parentNode.nodeName.toLowerCase())}}class QI{constructor(s,n,a){this.parser=s,this.options=n,this.isOpen=a,this.open=0,this.localPreserveWS=!1;let i=n.topNode,l,o=XI(null,n.preserveWhitespace,0)|(a?jp:0);i?l=new dg(i.type,i.attrs,en.none,!0,n.topMatch||i.type.contentMatch,o):a?l=new dg(null,null,en.none,!0,null,o):l=new dg(s.schema.topNodeType,null,en.none,!0,null,o),this.nodes=[l],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(s,n){s.nodeType==3?this.addTextNode(s,n):s.nodeType==1&&this.addElement(s,n)}addTextNode(s,n){let a=s.nodeValue,i=this.top,l=i.options&NS?"full":this.localPreserveWS||(i.options&lx)>0,{schema:o}=this.parser;if(l==="full"||i.inlineContext(s)||/[^ \t\r\n\u000c]/.test(a)){if(l)if(l==="full")a=a.replace(/\r\n?/g,`
`);else if(o.linebreakReplacement&&/[\r\n]/.test(a)&&this.top.findWrapping(o.linebreakReplacement.create())){let c=a.split(/\r?\n|\r/);for(let d=0;d<c.length;d++)d&&this.insertNode(o.linebreakReplacement.create(),n,!0),c[d]&&this.insertNode(o.text(c[d]),n,!/\S/.test(c[d]));a=""}else a=a.replace(/\r?\n|\r/g," ");else if(a=a.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(a)&&this.open==this.nodes.length-1){let c=i.content[i.content.length-1],d=s.previousSibling;(!c||d&&d.nodeName=="BR"||c.isText&&/[ \t\r\n\u000c]$/.test(c.text))&&(a=a.slice(1))}a&&this.insertNode(o.text(a),n,!/\S/.test(a)),this.findInText(s)}else this.findInside(s)}addElement(s,n,a){let i=this.localPreserveWS,l=this.top;(s.tagName=="PRE"||/pre/.test(s.style&&s.style.whiteSpace))&&(this.localPreserveWS=!0);let o=s.nodeName.toLowerCase(),c;Fz.hasOwnProperty(o)&&this.parser.normalizeLists&&Xye(s);let d=this.options.ruleFromNode&&this.options.ruleFromNode(s)||(c=this.parser.matchTag(s,this,a));e:if(d?d.ignore:Yye.hasOwnProperty(o))this.findInside(s),this.ignoreFallback(s,n);else if(!d||d.skip||d.closeParent){d&&d.closeParent?this.open=Math.max(0,this.open-1):d&&d.skip.nodeType&&(s=d.skip);let u,h=this.needsBlock;if(Bz.hasOwnProperty(o))l.content.length&&l.content[0].isInline&&this.open&&(this.open--,l=this.top),u=!0,l.type||(this.needsBlock=!0);else if(!s.firstChild){this.leafFallback(s,n);break e}let f=d&&d.skip?n:this.readStyles(s,n);f&&this.addAll(s,f),u&&this.sync(l),this.needsBlock=h}else{let u=this.readStyles(s,n);u&&this.addElementByRule(s,d,u,d.consuming===!1?c:void 0)}this.localPreserveWS=i}leafFallback(s,n){s.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(s.ownerDocument.createTextNode(`
`),n)}ignoreFallback(s,n){s.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n,!0)}readStyles(s,n){let a=s.style;if(a&&a.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let l=this.parser.matchedStyles[i],o=a.getPropertyValue(l);if(o)for(let c=void 0;;){let d=this.parser.matchStyle(l,o,this,c);if(!d)break;if(d.ignore)return null;if(d.clearMark?n=n.filter(u=>!d.clearMark(u)):n=n.concat(this.parser.schema.marks[d.mark].create(d.attrs)),d.consuming===!1)c=d;else break}}return n}addElementByRule(s,n,a,i){let l,o;if(n.node)if(o=this.parser.schema.nodes[n.node],o.isLeaf)this.insertNode(o.create(n.attrs),a,s.nodeName=="BR")||this.leafFallback(s,a);else{let d=this.enter(o,n.attrs||null,a,n.preserveWhitespace);d&&(l=!0,a=d)}else{let d=this.parser.schema.marks[n.mark];a=a.concat(d.create(n.attrs))}let c=this.top;if(o&&o.isLeaf)this.findInside(s);else if(i)this.addElement(s,a,i);else if(n.getContent)this.findInside(s),n.getContent(s,this.parser.schema).forEach(d=>this.insertNode(d,a,!1));else{let d=s;typeof n.contentElement=="string"?d=s.querySelector(n.contentElement):typeof n.contentElement=="function"?d=n.contentElement(s):n.contentElement&&(d=n.contentElement),this.findAround(s,d,!0),this.addAll(d,a),this.findAround(s,d,!1)}l&&this.sync(c)&&this.open--}addAll(s,n,a,i){let l=a||0;for(let o=a?s.childNodes[a]:s.firstChild,c=i==null?null:s.childNodes[i];o!=c;o=o.nextSibling,++l)this.findAtPoint(s,l),this.addDOM(o,n);this.findAtPoint(s,l)}findPlace(s,n,a){let i,l;for(let o=this.open,c=0;o>=0;o--){let d=this.nodes[o],u=d.findWrapping(s);if(u&&(!i||i.length>u.length+c)&&(i=u,l=d,!u.length))break;if(d.solid){if(a)break;c+=2}}if(!i)return null;this.sync(l);for(let o=0;o<i.length;o++)n=this.enterInner(i[o],null,n,!1);return n}insertNode(s,n,a){if(s.isInline&&this.needsBlock&&!this.top.type){let l=this.textblockFromContext();l&&(n=this.enterInner(l,null,n))}let i=this.findPlace(s,n,a);if(i){this.closeExtra();let l=this.top;l.match&&(l.match=l.match.matchType(s.type));let o=en.none;for(let c of i.concat(s.marks))(l.type?l.type.allowsMarkType(c.type):JI(c.type,s.type))&&(o=c.addToSet(o));return l.content.push(s.mark(o)),!0}return!1}enter(s,n,a,i){let l=this.findPlace(s.create(n),a,!1);return l&&(l=this.enterInner(s,n,a,!0,i)),l}enterInner(s,n,a,i=!1,l){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(s);let c=XI(s,l,o.options);o.options&jp&&o.content.length==0&&(c|=jp);let d=en.none;return a=a.filter(u=>(o.type?o.type.allowsMarkType(u.type):JI(u.type,s))?(d=u.addToSet(d),!1):!0),this.nodes.push(new dg(s,n,d,i,null,c)),this.open++,a}closeExtra(s=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(s));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(s){for(let n=this.open;n>=0;n--){if(this.nodes[n]==s)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=lx)}return!1}get currentPos(){this.closeExtra();let s=0;for(let n=this.open;n>=0;n--){let a=this.nodes[n].content;for(let i=a.length-1;i>=0;i--)s+=a[i].nodeSize;n&&s++}return s}findAtPoint(s,n){if(this.find)for(let a=0;a<this.find.length;a++)this.find[a].node==s&&this.find[a].offset==n&&(this.find[a].pos=this.currentPos)}findInside(s){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&s.nodeType==1&&s.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(s,n,a){if(s!=n&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&s.nodeType==1&&s.contains(this.find[i].node)&&n.compareDocumentPosition(this.find[i].node)&(a?2:4)&&(this.find[i].pos=this.currentPos)}findInText(s){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==s&&(this.find[n].pos=this.currentPos-(s.nodeValue.length-this.find[n].offset))}matchesContext(s){if(s.indexOf("|")>-1)return s.split(/\s*\|\s*/).some(this.matchesContext,this);let n=s.split("/"),a=this.options.context,i=!this.isOpen&&(!a||a.parent.type==this.nodes[0].type),l=-(a?a.depth+1:0)+(i?0:1),o=(c,d)=>{for(;c>=0;c--){let u=n[c];if(u==""){if(c==n.length-1||c==0)continue;for(;d>=l;d--)if(o(c-1,d))return!0;return!1}else{let h=d>0||d==0&&i?this.nodes[d].type:a&&d>=l?a.node(d-l).type:null;if(!h||h.name!=u&&!h.isInGroup(u))return!1;d--}}return!0};return o(n.length-1,this.open)}textblockFromContext(){let s=this.options.context;if(s)for(let n=s.depth;n>=0;n--){let a=s.node(n).contentMatchAt(s.indexAfter(n)).defaultType;if(a&&a.isTextblock&&a.defaultAttrs)return a}for(let n in this.parser.schema.nodes){let a=this.parser.schema.nodes[n];if(a.isTextblock&&a.defaultAttrs)return a}}}function Xye(t){for(let s=t.firstChild,n=null;s;s=s.nextSibling){let a=s.nodeType==1?s.nodeName.toLowerCase():null;a&&Fz.hasOwnProperty(a)&&n?(n.appendChild(s),s=n):a=="li"?n=s:a&&(n=null)}}function Qye(t,s){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,s)}function ZI(t){let s={};for(let n in t)s[n]=t[n];return s}function JI(t,s){let n=s.schema.nodes;for(let a in n){let i=n[a];if(!i.allowsMarkType(t))continue;let l=[],o=c=>{l.push(c);for(let d=0;d<c.edgeCount;d++){let{type:u,next:h}=c.edge(d);if(u==s||l.indexOf(h)<0&&o(h))return!0}};if(o(i.contentMatch))return!0}}class Tv{constructor(s,n){this.nodes=s,this.marks=n}serializeFragment(s,n={},a){a||(a=yj(n).createDocumentFragment());let i=a,l=[];return s.forEach(o=>{if(l.length||o.marks.length){let c=0,d=0;for(;c<l.length&&d<o.marks.length;){let u=o.marks[d];if(!this.marks[u.type.name]){d++;continue}if(!u.eq(l[c][0])||u.type.spec.spanning===!1)break;c++,d++}for(;c<l.length;)i=l.pop()[1];for(;d<o.marks.length;){let u=o.marks[d++],h=this.serializeMark(u,o.isInline,n);h&&(l.push([u,i]),i.appendChild(h.dom),i=h.contentDOM||h.dom)}}i.appendChild(this.serializeNodeInner(o,n))}),a}serializeNodeInner(s,n){let{dom:a,contentDOM:i}=fy(yj(n),this.nodes[s.type.name](s),null,s.attrs);if(i){if(s.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(s.content,n,i)}return a}serializeNode(s,n={}){let a=this.serializeNodeInner(s,n);for(let i=s.marks.length-1;i>=0;i--){let l=this.serializeMark(s.marks[i],s.isInline,n);l&&((l.contentDOM||l.dom).appendChild(a),a=l.dom)}return a}serializeMark(s,n,a={}){let i=this.marks[s.type.name];return i&&fy(yj(a),i(s,n),null,s.attrs)}static renderSpec(s,n,a=null,i){return fy(s,n,a,i)}static fromSchema(s){return s.cached.domSerializer||(s.cached.domSerializer=new Tv(this.nodesFromSchema(s),this.marksFromSchema(s)))}static nodesFromSchema(s){let n=eM(s.nodes);return n.text||(n.text=a=>a.text),n}static marksFromSchema(s){return eM(s.marks)}}function eM(t){let s={};for(let n in t){let a=t[n].spec.toDOM;a&&(s[n]=a)}return s}function yj(t){return t.document||window.document}const tM=new WeakMap;function Zye(t){let s=tM.get(t);return s===void 0&&tM.set(t,s=Jye(t)),s}function Jye(t){let s=null;function n(a){if(a&&typeof a=="object")if(Array.isArray(a))if(typeof a[0]=="string")s||(s=[]),s.push(a);else for(let i=0;i<a.length;i++)n(a[i]);else for(let i in a)n(a[i])}return n(t),s}function fy(t,s,n,a){if(typeof s=="string")return{dom:t.createTextNode(s)};if(s.nodeType!=null)return{dom:s};if(s.dom&&s.dom.nodeType!=null)return s;let i=s[0],l;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(a&&(l=Zye(a))&&l.indexOf(s)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=i.indexOf(" ");o>0&&(n=i.slice(0,o),i=i.slice(o+1));let c,d=n?t.createElementNS(n,i):t.createElement(i),u=s[1],h=1;if(u&&typeof u=="object"&&u.nodeType==null&&!Array.isArray(u)){h=2;for(let f in u)if(u[f]!=null){let x=f.indexOf(" ");x>0?d.setAttributeNS(f.slice(0,x),f.slice(x+1),u[f]):f=="style"&&d.style?d.style.cssText=u[f]:d.setAttribute(f,u[f])}}for(let f=h;f<s.length;f++){let x=s[f];if(x===0){if(f<s.length-1||f>h)throw new RangeError("Content hole must be the only child of its parent node");return{dom:d,contentDOM:d}}else{let{dom:b,contentDOM:v}=fy(t,x,n,a);if(d.appendChild(b),v){if(c)throw new RangeError("Multiple content holes");c=v}}}return{dom:d,contentDOM:c}}const $z=65535,zz=Math.pow(2,16);function e1e(t,s){return t+s*zz}function sM(t){return t&$z}function t1e(t){return(t-(t&$z))/zz}const Uz=1,Vz=2,py=4,Hz=8;class wS{constructor(s,n,a){this.pos=s,this.delInfo=n,this.recover=a}get deleted(){return(this.delInfo&Hz)>0}get deletedBefore(){return(this.delInfo&(Uz|py))>0}get deletedAfter(){return(this.delInfo&(Vz|py))>0}get deletedAcross(){return(this.delInfo&py)>0}}class ai{constructor(s,n=!1){if(this.ranges=s,this.inverted=n,!s.length&&ai.empty)return ai.empty}recover(s){let n=0,a=sM(s);if(!this.inverted)for(let i=0;i<a;i++)n+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[a*3]+n+t1e(s)}mapResult(s,n=1){return this._map(s,n,!1)}map(s,n=1){return this._map(s,n,!0)}_map(s,n,a){let i=0,l=this.inverted?2:1,o=this.inverted?1:2;for(let c=0;c<this.ranges.length;c+=3){let d=this.ranges[c]-(this.inverted?i:0);if(d>s)break;let u=this.ranges[c+l],h=this.ranges[c+o],f=d+u;if(s<=f){let x=u?s==d?-1:s==f?1:n:n,b=d+i+(x<0?0:h);if(a)return b;let v=s==(n<0?d:f)?null:e1e(c/3,s-d),w=s==d?Vz:s==f?Uz:py;return(n<0?s!=d:s!=f)&&(w|=Hz),new wS(b,w,v)}i+=h-u}return a?s+i:new wS(s+i,0,null)}touches(s,n){let a=0,i=sM(n),l=this.inverted?2:1,o=this.inverted?1:2;for(let c=0;c<this.ranges.length;c+=3){let d=this.ranges[c]-(this.inverted?a:0);if(d>s)break;let u=this.ranges[c+l],h=d+u;if(s<=h&&c==i*3)return!0;a+=this.ranges[c+o]-u}return!1}forEach(s){let n=this.inverted?2:1,a=this.inverted?1:2;for(let i=0,l=0;i<this.ranges.length;i+=3){let o=this.ranges[i],c=o-(this.inverted?l:0),d=o+(this.inverted?0:l),u=this.ranges[i+n],h=this.ranges[i+a];s(c,c+u,d,d+h),l+=h-u}}invert(){return new ai(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(s){return s==0?ai.empty:new ai(s<0?[0,-s,0]:[0,0,s])}}ai.empty=new ai([]);class ox{constructor(s,n,a=0,i=s?s.length:0){this.mirror=n,this.from=a,this.to=i,this._maps=s||[],this.ownData=!(s||n)}get maps(){return this._maps}slice(s=0,n=this.maps.length){return new ox(this._maps,this.mirror,s,n)}appendMap(s,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(s),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(s){for(let n=0,a=this._maps.length;n<s._maps.length;n++){let i=s.getMirror(n);this.appendMap(s._maps[n],i!=null&&i<n?a+i:void 0)}}getMirror(s){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==s)return this.mirror[n+(n%2?-1:1)]}}setMirror(s,n){this.mirror||(this.mirror=[]),this.mirror.push(s,n)}appendMappingInverted(s){for(let n=s.maps.length-1,a=this._maps.length+s._maps.length;n>=0;n--){let i=s.getMirror(n);this.appendMap(s._maps[n].invert(),i!=null&&i>n?a-i-1:void 0)}}invert(){let s=new ox;return s.appendMappingInverted(this),s}map(s,n=1){if(this.mirror)return this._map(s,n,!0);for(let a=this.from;a<this.to;a++)s=this._maps[a].map(s,n);return s}mapResult(s,n=1){return this._map(s,n,!1)}_map(s,n,a){let i=0;for(let l=this.from;l<this.to;l++){let o=this._maps[l],c=o.mapResult(s,n);if(c.recover!=null){let d=this.getMirror(l);if(d!=null&&d>l&&d<this.to){l=d,s=this._maps[d].recover(c.recover);continue}}i|=c.delInfo,s=c.pos}return a?s:new wS(s,i,null)}}const bj=Object.create(null);let sa=class{getMap(){return ai.empty}merge(s){return null}static fromJSON(s,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let a=bj[n.stepType];if(!a)throw new RangeError(`No step type ${n.stepType} defined`);return a.fromJSON(s,n)}static jsonID(s,n){if(s in bj)throw new RangeError("Duplicate use of step JSON ID "+s);return bj[s]=n,n.prototype.jsonID=s,n}};class qn{constructor(s,n){this.doc=s,this.failed=n}static ok(s){return new qn(s,null)}static fail(s){return new qn(null,s)}static fromReplace(s,n,a,i){try{return qn.ok(s.replace(n,a,i))}catch(l){if(l instanceof b1)return qn.fail(l.message);throw l}}}function Zk(t,s,n){let a=[];for(let i=0;i<t.childCount;i++){let l=t.child(i);l.content.size&&(l=l.copy(Zk(l.content,s,l))),l.isInline&&(l=s(l,n,i)),a.push(l)}return ze.fromArray(a)}class $c extends sa{constructor(s,n,a){super(),this.from=s,this.to=n,this.mark=a}apply(s){let n=s.slice(this.from,this.to),a=s.resolve(this.from),i=a.node(a.sharedDepth(this.to)),l=new ct(Zk(n.content,(o,c)=>!o.isAtom||!c.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),n.openStart,n.openEnd);return qn.fromReplace(s,this.from,this.to,l)}invert(){return new fl(this.from,this.to,this.mark)}map(s){let n=s.mapResult(this.from,1),a=s.mapResult(this.to,-1);return n.deleted&&a.deleted||n.pos>=a.pos?null:new $c(n.pos,a.pos,this.mark)}merge(s){return s instanceof $c&&s.mark.eq(this.mark)&&this.from<=s.to&&this.to>=s.from?new $c(Math.min(this.from,s.from),Math.max(this.to,s.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(s,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new $c(n.from,n.to,s.markFromJSON(n.mark))}}sa.jsonID("addMark",$c);class fl extends sa{constructor(s,n,a){super(),this.from=s,this.to=n,this.mark=a}apply(s){let n=s.slice(this.from,this.to),a=new ct(Zk(n.content,i=>i.mark(this.mark.removeFromSet(i.marks)),s),n.openStart,n.openEnd);return qn.fromReplace(s,this.from,this.to,a)}invert(){return new $c(this.from,this.to,this.mark)}map(s){let n=s.mapResult(this.from,1),a=s.mapResult(this.to,-1);return n.deleted&&a.deleted||n.pos>=a.pos?null:new fl(n.pos,a.pos,this.mark)}merge(s){return s instanceof fl&&s.mark.eq(this.mark)&&this.from<=s.to&&this.to>=s.from?new fl(Math.min(this.from,s.from),Math.max(this.to,s.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(s,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new fl(n.from,n.to,s.markFromJSON(n.mark))}}sa.jsonID("removeMark",fl);class zc extends sa{constructor(s,n){super(),this.pos=s,this.mark=n}apply(s){let n=s.nodeAt(this.pos);if(!n)return qn.fail("No node at mark step's position");let a=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return qn.fromReplace(s,this.pos,this.pos+1,new ct(ze.from(a),0,n.isLeaf?0:1))}invert(s){let n=s.nodeAt(this.pos);if(n){let a=this.mark.addToSet(n.marks);if(a.length==n.marks.length){for(let i=0;i<n.marks.length;i++)if(!n.marks[i].isInSet(a))return new zc(this.pos,n.marks[i]);return new zc(this.pos,this.mark)}}return new Tu(this.pos,this.mark)}map(s){let n=s.mapResult(this.pos,1);return n.deletedAfter?null:new zc(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(s,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new zc(n.pos,s.markFromJSON(n.mark))}}sa.jsonID("addNodeMark",zc);class Tu extends sa{constructor(s,n){super(),this.pos=s,this.mark=n}apply(s){let n=s.nodeAt(this.pos);if(!n)return qn.fail("No node at mark step's position");let a=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return qn.fromReplace(s,this.pos,this.pos+1,new ct(ze.from(a),0,n.isLeaf?0:1))}invert(s){let n=s.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new zc(this.pos,this.mark)}map(s){let n=s.mapResult(this.pos,1);return n.deletedAfter?null:new Tu(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(s,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Tu(n.pos,s.markFromJSON(n.mark))}}sa.jsonID("removeNodeMark",Tu);class nr extends sa{constructor(s,n,a,i=!1){super(),this.from=s,this.to=n,this.slice=a,this.structure=i}apply(s){return this.structure&&jS(s,this.from,this.to)?qn.fail("Structure replace would overwrite content"):qn.fromReplace(s,this.from,this.to,this.slice)}getMap(){return new ai([this.from,this.to-this.from,this.slice.size])}invert(s){return new nr(this.from,this.from+this.slice.size,s.slice(this.from,this.to))}map(s){let n=s.mapResult(this.from,1),a=s.mapResult(this.to,-1);return n.deletedAcross&&a.deletedAcross?null:new nr(n.pos,Math.max(n.pos,a.pos),this.slice,this.structure)}merge(s){if(!(s instanceof nr)||s.structure||this.structure)return null;if(this.from+this.slice.size==s.from&&!this.slice.openEnd&&!s.slice.openStart){let n=this.slice.size+s.slice.size==0?ct.empty:new ct(this.slice.content.append(s.slice.content),this.slice.openStart,s.slice.openEnd);return new nr(this.from,this.to+(s.to-s.from),n,this.structure)}else if(s.to==this.from&&!this.slice.openStart&&!s.slice.openEnd){let n=this.slice.size+s.slice.size==0?ct.empty:new ct(s.slice.content.append(this.slice.content),s.slice.openStart,this.slice.openEnd);return new nr(s.from,this.to,n,this.structure)}else return null}toJSON(){let s={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(s.slice=this.slice.toJSON()),this.structure&&(s.structure=!0),s}static fromJSON(s,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new nr(n.from,n.to,ct.fromJSON(s,n.slice),!!n.structure)}}sa.jsonID("replace",nr);class ur extends sa{constructor(s,n,a,i,l,o,c=!1){super(),this.from=s,this.to=n,this.gapFrom=a,this.gapTo=i,this.slice=l,this.insert=o,this.structure=c}apply(s){if(this.structure&&(jS(s,this.from,this.gapFrom)||jS(s,this.gapTo,this.to)))return qn.fail("Structure gap-replace would overwrite content");let n=s.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return qn.fail("Gap is not a flat range");let a=this.slice.insertAt(this.insert,n.content);return a?qn.fromReplace(s,this.from,this.to,a):qn.fail("Content does not fit in gap")}getMap(){return new ai([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(s){let n=this.gapTo-this.gapFrom;return new ur(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,s.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(s){let n=s.mapResult(this.from,1),a=s.mapResult(this.to,-1),i=this.from==this.gapFrom?n.pos:s.map(this.gapFrom,-1),l=this.to==this.gapTo?a.pos:s.map(this.gapTo,1);return n.deletedAcross&&a.deletedAcross||i<n.pos||l>a.pos?null:new ur(n.pos,a.pos,i,l,this.slice,this.insert,this.structure)}toJSON(){let s={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(s.slice=this.slice.toJSON()),this.structure&&(s.structure=!0),s}static fromJSON(s,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ur(n.from,n.to,n.gapFrom,n.gapTo,ct.fromJSON(s,n.slice),n.insert,!!n.structure)}}sa.jsonID("replaceAround",ur);function jS(t,s,n){let a=t.resolve(s),i=n-s,l=a.depth;for(;i>0&&l>0&&a.indexAfter(l)==a.node(l).childCount;)l--,i--;if(i>0){let o=a.node(l).maybeChild(a.indexAfter(l));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function s1e(t,s,n,a){let i=[],l=[],o,c;t.doc.nodesBetween(s,n,(d,u,h)=>{if(!d.isInline)return;let f=d.marks;if(!a.isInSet(f)&&h.type.allowsMarkType(a.type)){let x=Math.max(u,s),b=Math.min(u+d.nodeSize,n),v=a.addToSet(f);for(let w=0;w<f.length;w++)f[w].isInSet(v)||(o&&o.to==x&&o.mark.eq(f[w])?o.to=b:i.push(o=new fl(x,b,f[w])));c&&c.to==x?c.to=b:l.push(c=new $c(x,b,a))}}),i.forEach(d=>t.step(d)),l.forEach(d=>t.step(d))}function n1e(t,s,n,a){let i=[],l=0;t.doc.nodesBetween(s,n,(o,c)=>{if(!o.isInline)return;l++;let d=null;if(a instanceof Ev){let u=o.marks,h;for(;h=a.isInSet(u);)(d||(d=[])).push(h),u=h.removeFromSet(u)}else a?a.isInSet(o.marks)&&(d=[a]):d=o.marks;if(d&&d.length){let u=Math.min(c+o.nodeSize,n);for(let h=0;h<d.length;h++){let f=d[h],x;for(let b=0;b<i.length;b++){let v=i[b];v.step==l-1&&f.eq(i[b].style)&&(x=v)}x?(x.to=u,x.step=l):i.push({style:f,from:Math.max(c,s),to:u,step:l})}}}),i.forEach(o=>t.step(new fl(o.from,o.to,o.style)))}function Jk(t,s,n,a=n.contentMatch,i=!0){let l=t.doc.nodeAt(s),o=[],c=s+1;for(let d=0;d<l.childCount;d++){let u=l.child(d),h=c+u.nodeSize,f=a.matchType(u.type);if(!f)o.push(new nr(c,h,ct.empty));else{a=f;for(let x=0;x<u.marks.length;x++)n.allowsMarkType(u.marks[x].type)||t.step(new fl(c,h,u.marks[x]));if(i&&u.isText&&n.whitespace!="pre"){let x,b=/\r?\n|\r/g,v;for(;x=b.exec(u.text);)v||(v=new ct(ze.from(n.schema.text(" ",n.allowedMarks(u.marks))),0,0)),o.push(new nr(c+x.index,c+x.index+x[0].length,v))}}c=h}if(!a.validEnd){let d=a.fillBefore(ze.empty,!0);t.replace(c,c,new ct(d,0,0))}for(let d=o.length-1;d>=0;d--)t.step(o[d])}function r1e(t,s,n){return(s==0||t.canReplace(s,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function qu(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let a=t.depth;;--a){let i=t.$from.node(a),l=t.$from.index(a),o=t.$to.indexAfter(a);if(a<t.depth&&i.canReplace(l,o,n))return a;if(a==0||i.type.spec.isolating||!r1e(i,l,o))break}return null}function a1e(t,s,n){let{$from:a,$to:i,depth:l}=s,o=a.before(l+1),c=i.after(l+1),d=o,u=c,h=ze.empty,f=0;for(let v=l,w=!1;v>n;v--)w||a.index(v)>0?(w=!0,h=ze.from(a.node(v).copy(h)),f++):d--;let x=ze.empty,b=0;for(let v=l,w=!1;v>n;v--)w||i.after(v+1)<i.end(v)?(w=!0,x=ze.from(i.node(v).copy(x)),b++):u++;t.step(new ur(d,u,o,c,new ct(h.append(x),f,b),h.size-f,!0))}function e5(t,s,n=null,a=t){let i=i1e(t,s),l=i&&l1e(a,s);return l?i.map(nM).concat({type:s,attrs:n}).concat(l.map(nM)):null}function nM(t){return{type:t,attrs:null}}function i1e(t,s){let{parent:n,startIndex:a,endIndex:i}=t,l=n.contentMatchAt(a).findWrapping(s);if(!l)return null;let o=l.length?l[0]:s;return n.canReplaceWith(a,i,o)?l:null}function l1e(t,s){let{parent:n,startIndex:a,endIndex:i}=t,l=n.child(a),o=s.contentMatch.findWrapping(l.type);if(!o)return null;let d=(o.length?o[o.length-1]:s).contentMatch;for(let u=a;d&&u<i;u++)d=d.matchType(n.child(u).type);return!d||!d.validEnd?null:o}function o1e(t,s,n){let a=ze.empty;for(let o=n.length-1;o>=0;o--){if(a.size){let c=n[o].type.contentMatch.matchFragment(a);if(!c||!c.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}a=ze.from(n[o].type.create(n[o].attrs,a))}let i=s.start,l=s.end;t.step(new ur(i,l,i,l,new ct(a,0,0),n.length,!0))}function c1e(t,s,n,a,i){if(!a.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let l=t.steps.length;t.doc.nodesBetween(s,n,(o,c)=>{let d=typeof i=="function"?i(o):i;if(o.isTextblock&&!o.hasMarkup(a,d)&&d1e(t.doc,t.mapping.slice(l).map(c),a)){let u=null;if(a.schema.linebreakReplacement){let b=a.whitespace=="pre",v=!!a.contentMatch.matchType(a.schema.linebreakReplacement);b&&!v?u=!1:!b&&v&&(u=!0)}u===!1&&qz(t,o,c,l),Jk(t,t.mapping.slice(l).map(c,1),a,void 0,u===null);let h=t.mapping.slice(l),f=h.map(c,1),x=h.map(c+o.nodeSize,1);return t.step(new ur(f,x,f+1,x-1,new ct(ze.from(a.create(d,null,o.marks)),0,0),1,!0)),u===!0&&Wz(t,o,c,l),!1}})}function Wz(t,s,n,a){s.forEach((i,l)=>{if(i.isText){let o,c=/\r?\n|\r/g;for(;o=c.exec(i.text);){let d=t.mapping.slice(a).map(n+1+l+o.index);t.replaceWith(d,d+1,s.type.schema.linebreakReplacement.create())}}})}function qz(t,s,n,a){s.forEach((i,l)=>{if(i.type==i.type.schema.linebreakReplacement){let o=t.mapping.slice(a).map(n+1+l);t.replaceWith(o,o+1,s.type.schema.text(`
`))}})}function d1e(t,s,n){let a=t.resolve(s),i=a.index();return a.parent.canReplaceWith(i,i+1,n)}function u1e(t,s,n,a,i){let l=t.doc.nodeAt(s);if(!l)throw new RangeError("No node at given position");n||(n=l.type);let o=n.create(a,null,i||l.marks);if(l.isLeaf)return t.replaceWith(s,s+l.nodeSize,o);if(!n.validContent(l.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new ur(s,s+l.nodeSize,s+1,s+l.nodeSize-1,new ct(ze.from(o),0,0),1,!0))}function mi(t,s,n=1,a){let i=t.resolve(s),l=i.depth-n,o=a&&a[a.length-1]||i.parent;if(l<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let u=i.depth-1,h=n-2;u>l;u--,h--){let f=i.node(u),x=i.index(u);if(f.type.spec.isolating)return!1;let b=f.content.cutByIndex(x,f.childCount),v=a&&a[h+1];v&&(b=b.replaceChild(0,v.type.create(v.attrs)));let w=a&&a[h]||f;if(!f.canReplace(x+1,f.childCount)||!w.type.validContent(b))return!1}let c=i.indexAfter(l),d=a&&a[0];return i.node(l).canReplaceWith(c,c,d?d.type:i.node(l+1).type)}function h1e(t,s,n=1,a){let i=t.doc.resolve(s),l=ze.empty,o=ze.empty;for(let c=i.depth,d=i.depth-n,u=n-1;c>d;c--,u--){l=ze.from(i.node(c).copy(l));let h=a&&a[u];o=ze.from(h?h.type.create(h.attrs,o):i.node(c).copy(o))}t.step(new nr(s,s,new ct(l.append(o),n,n),!0))}function go(t,s){let n=t.resolve(s),a=n.index();return Gz(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(a,a+1)}function m1e(t,s){s.content.size||t.type.compatibleContent(s.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:a}=t.type.schema;for(let i=0;i<s.childCount;i++){let l=s.child(i),o=l.type==a?t.type.schema.nodes.text:l.type;if(n=n.matchType(o),!n||!t.type.allowsMarks(l.marks))return!1}return n.validEnd}function Gz(t,s){return!!(t&&s&&!t.isLeaf&&m1e(t,s))}function Km(t,s,n=-1){let a=t.resolve(s);for(let i=a.depth;;i--){let l,o,c=a.index(i);if(i==a.depth?(l=a.nodeBefore,o=a.nodeAfter):n>0?(l=a.node(i+1),c++,o=a.node(i).maybeChild(c)):(l=a.node(i).maybeChild(c-1),o=a.node(i+1)),l&&!l.isTextblock&&Gz(l,o)&&a.node(i).canReplace(c,c+1))return s;if(i==0)break;s=n<0?a.before(i):a.after(i)}}function f1e(t,s,n){let a=null,{linebreakReplacement:i}=t.doc.type.schema,l=t.doc.resolve(s-n),o=l.node().type;if(i&&o.inlineContent){let h=o.whitespace=="pre",f=!!o.contentMatch.matchType(i);h&&!f?a=!1:!h&&f&&(a=!0)}let c=t.steps.length;if(a===!1){let h=t.doc.resolve(s+n);qz(t,h.node(),h.before(),c)}o.inlineContent&&Jk(t,s+n-1,o,l.node().contentMatchAt(l.index()),a==null);let d=t.mapping.slice(c),u=d.map(s-n);if(t.step(new nr(u,d.map(s+n,-1),ct.empty,!0)),a===!0){let h=t.doc.resolve(u);Wz(t,h.node(),h.before(),t.steps.length)}return t}function p1e(t,s,n){let a=t.resolve(s);if(a.parent.canReplaceWith(a.index(),a.index(),n))return s;if(a.parentOffset==0)for(let i=a.depth-1;i>=0;i--){let l=a.index(i);if(a.node(i).canReplaceWith(l,l,n))return a.before(i+1);if(l>0)return null}if(a.parentOffset==a.parent.content.size)for(let i=a.depth-1;i>=0;i--){let l=a.indexAfter(i);if(a.node(i).canReplaceWith(l,l,n))return a.after(i+1);if(l<a.node(i).childCount)return null}return null}function Kz(t,s,n){let a=t.resolve(s);if(!n.content.size)return s;let i=n.content;for(let l=0;l<n.openStart;l++)i=i.firstChild.content;for(let l=1;l<=(n.openStart==0&&n.size?2:1);l++)for(let o=a.depth;o>=0;o--){let c=o==a.depth?0:a.pos<=(a.start(o+1)+a.end(o+1))/2?-1:1,d=a.index(o)+(c>0?1:0),u=a.node(o),h=!1;if(l==1)h=u.canReplace(d,d,i);else{let f=u.contentMatchAt(d).findWrapping(i.firstChild.type);h=f&&u.canReplaceWith(d,d,f[0])}if(h)return c==0?a.pos:c<0?a.before(o+1):a.after(o+1)}return null}function Pv(t,s,n=s,a=ct.empty){if(s==n&&!a.size)return null;let i=t.resolve(s),l=t.resolve(n);return Yz(i,l,a)?new nr(s,n,a):new x1e(i,l,a).fit()}function Yz(t,s,n){return!n.openStart&&!n.openEnd&&t.start()==s.start()&&t.parent.canReplace(t.index(),s.index(),n.content)}class x1e{constructor(s,n,a){this.$from=s,this.$to=n,this.unplaced=a,this.frontier=[],this.placed=ze.empty;for(let i=0;i<=s.depth;i++){let l=s.node(i);this.frontier.push({type:l.type,match:l.contentMatchAt(s.indexAfter(i))})}for(let i=s.depth;i>0;i--)this.placed=ze.from(s.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let s=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,a=this.$from,i=this.close(s<0?this.$to:a.doc.resolve(s));if(!i)return null;let l=this.placed,o=a.depth,c=i.depth;for(;o&&c&&l.childCount==1;)l=l.firstChild.content,o--,c--;let d=new ct(l,o,c);return s>-1?new ur(a.pos,s,this.$to.pos,this.$to.end(),d,n):d.size||a.pos!=this.$to.pos?new nr(a.pos,i.pos,d):null}findFittable(){let s=this.unplaced.openStart;for(let n=this.unplaced.content,a=0,i=this.unplaced.openEnd;a<s;a++){let l=n.firstChild;if(n.childCount>1&&(i=0),l.type.spec.isolating&&i<=a){s=a;break}n=l.content}for(let n=1;n<=2;n++)for(let a=n==1?s:this.unplaced.openStart;a>=0;a--){let i,l=null;a?(l=vj(this.unplaced.content,a-1).firstChild,i=l.content):i=this.unplaced.content;let o=i.firstChild;for(let c=this.depth;c>=0;c--){let{type:d,match:u}=this.frontier[c],h,f=null;if(n==1&&(o?u.matchType(o.type)||(f=u.fillBefore(ze.from(o),!1)):l&&d.compatibleContent(l.type)))return{sliceDepth:a,frontierDepth:c,parent:l,inject:f};if(n==2&&o&&(h=u.findWrapping(o.type)))return{sliceDepth:a,frontierDepth:c,parent:l,wrap:h};if(l&&u.matchType(l.type))break}}}openMore(){let{content:s,openStart:n,openEnd:a}=this.unplaced,i=vj(s,n);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new ct(s,n+1,Math.max(a,i.size+n>=s.size-a?n+1:0)),!0)}dropNode(){let{content:s,openStart:n,openEnd:a}=this.unplaced,i=vj(s,n);if(i.childCount<=1&&n>0){let l=s.size-n<=n+i.size;this.unplaced=new ct(Zf(s,n-1,1),n-1,l?n-1:a)}else this.unplaced=new ct(Zf(s,n,1),n,a)}placeNodes({sliceDepth:s,frontierDepth:n,parent:a,inject:i,wrap:l}){for(;this.depth>n;)this.closeFrontierNode();if(l)for(let w=0;w<l.length;w++)this.openFrontierNode(l[w]);let o=this.unplaced,c=a?a.content:o.content,d=o.openStart-s,u=0,h=[],{match:f,type:x}=this.frontier[n];if(i){for(let w=0;w<i.childCount;w++)h.push(i.child(w));f=f.matchFragment(i)}let b=c.size+s-(o.content.size-o.openEnd);for(;u<c.childCount;){let w=c.child(u),_=f.matchType(w.type);if(!_)break;u++,(u>1||d==0||w.content.size)&&(f=_,h.push(Xz(w.mark(x.allowedMarks(w.marks)),u==1?d:0,u==c.childCount?b:-1)))}let v=u==c.childCount;v||(b=-1),this.placed=Jf(this.placed,n,ze.from(h)),this.frontier[n].match=f,v&&b<0&&a&&a.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let w=0,_=c;w<b;w++){let S=_.lastChild;this.frontier.push({type:S.type,match:S.contentMatchAt(S.childCount)}),_=S.content}this.unplaced=v?s==0?ct.empty:new ct(Zf(o.content,s-1,1),s-1,b<0?o.openEnd:s-1):new ct(Zf(o.content,s,u),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let s=this.frontier[this.depth],n;if(!s.type.isTextblock||!Nj(this.$to,this.$to.depth,s.type,s.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:a}=this.$to,i=this.$to.after(a);for(;a>1&&i==this.$to.end(--a);)++i;return i}findCloseLevel(s){e:for(let n=Math.min(this.depth,s.depth);n>=0;n--){let{match:a,type:i}=this.frontier[n],l=n<s.depth&&s.end(n+1)==s.pos+(s.depth-(n+1)),o=Nj(s,n,i,a,l);if(o){for(let c=n-1;c>=0;c--){let{match:d,type:u}=this.frontier[c],h=Nj(s,c,u,d,!0);if(!h||h.childCount)continue e}return{depth:n,fit:o,move:l?s.doc.resolve(s.after(n+1)):s}}}}close(s){let n=this.findCloseLevel(s);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=Jf(this.placed,n.depth,n.fit)),s=n.move;for(let a=n.depth+1;a<=s.depth;a++){let i=s.node(a),l=i.type.contentMatch.fillBefore(i.content,!0,s.index(a));this.openFrontierNode(i.type,i.attrs,l)}return s}openFrontierNode(s,n=null,a){let i=this.frontier[this.depth];i.match=i.match.matchType(s),this.placed=Jf(this.placed,this.depth,ze.from(s.create(n,a))),this.frontier.push({type:s,match:s.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(ze.empty,!0);n.childCount&&(this.placed=Jf(this.placed,this.frontier.length,n))}}function Zf(t,s,n){return s==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(Zf(t.firstChild.content,s-1,n)))}function Jf(t,s,n){return s==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(Jf(t.lastChild.content,s-1,n)))}function vj(t,s){for(let n=0;n<s;n++)t=t.firstChild.content;return t}function Xz(t,s,n){if(s<=0)return t;let a=t.content;return s>1&&(a=a.replaceChild(0,Xz(a.firstChild,s-1,a.childCount==1?n-1:0))),s>0&&(a=t.type.contentMatch.fillBefore(a).append(a),n<=0&&(a=a.append(t.type.contentMatch.matchFragment(a).fillBefore(ze.empty,!0)))),t.copy(a)}function Nj(t,s,n,a,i){let l=t.node(s),o=i?t.indexAfter(s):t.index(s);if(o==l.childCount&&!n.compatibleContent(l.type))return null;let c=a.fillBefore(l.content,!0,o);return c&&!g1e(n,l.content,o)?c:null}function g1e(t,s,n){for(let a=n;a<s.childCount;a++)if(!t.allowsMarks(s.child(a).marks))return!0;return!1}function y1e(t){return t.spec.defining||t.spec.definingForContent}function b1e(t,s,n,a){if(!a.size)return t.deleteRange(s,n);let i=t.doc.resolve(s),l=t.doc.resolve(n);if(Yz(i,l,a))return t.step(new nr(s,n,a));let o=Zz(i,t.doc.resolve(n));o[o.length-1]==0&&o.pop();let c=-(i.depth+1);o.unshift(c);for(let x=i.depth,b=i.pos-1;x>0;x--,b--){let v=i.node(x).type.spec;if(v.defining||v.definingAsContext||v.isolating)break;o.indexOf(x)>-1?c=x:i.before(x)==b&&o.splice(1,0,-x)}let d=o.indexOf(c),u=[],h=a.openStart;for(let x=a.content,b=0;;b++){let v=x.firstChild;if(u.push(v),b==a.openStart)break;x=v.content}for(let x=h-1;x>=0;x--){let b=u[x],v=y1e(b.type);if(v&&!b.sameMarkup(i.node(Math.abs(c)-1)))h=x;else if(v||!b.type.isTextblock)break}for(let x=a.openStart;x>=0;x--){let b=(x+h+1)%(a.openStart+1),v=u[b];if(v)for(let w=0;w<o.length;w++){let _=o[(w+d)%o.length],S=!0;_<0&&(S=!1,_=-_);let k=i.node(_-1),A=i.index(_-1);if(k.canReplaceWith(A,A,v.type,v.marks))return t.replace(i.before(_),S?l.after(_):n,new ct(Qz(a.content,0,a.openStart,b),b,a.openEnd))}}let f=t.steps.length;for(let x=o.length-1;x>=0&&(t.replace(s,n,a),!(t.steps.length>f));x--){let b=o[x];b<0||(s=i.before(b),n=l.after(b))}}function Qz(t,s,n,a,i){if(s<n){let l=t.firstChild;t=t.replaceChild(0,l.copy(Qz(l.content,s+1,n,a,l)))}if(s>a){let l=i.contentMatchAt(0),o=l.fillBefore(t).append(t);t=o.append(l.matchFragment(o).fillBefore(ze.empty,!0))}return t}function v1e(t,s,n,a){if(!a.isInline&&s==n&&t.doc.resolve(s).parent.content.size){let i=p1e(t.doc,s,a.type);i!=null&&(s=n=i)}t.replaceRange(s,n,new ct(ze.from(a),0,0))}function N1e(t,s,n){let a=t.doc.resolve(s),i=t.doc.resolve(n),l=Zz(a,i);for(let o=0;o<l.length;o++){let c=l[o],d=o==l.length-1;if(d&&c==0||a.node(c).type.contentMatch.validEnd)return t.delete(a.start(c),i.end(c));if(c>0&&(d||a.node(c-1).canReplace(a.index(c-1),i.indexAfter(c-1))))return t.delete(a.before(c),i.after(c))}for(let o=1;o<=a.depth&&o<=i.depth;o++)if(s-a.start(o)==a.depth-o&&n>a.end(o)&&i.end(o)-n!=i.depth-o&&a.start(o-1)==i.start(o-1)&&a.node(o-1).canReplace(a.index(o-1),i.index(o-1)))return t.delete(a.before(o),n);t.delete(s,n)}function Zz(t,s){let n=[],a=Math.min(t.depth,s.depth);for(let i=a;i>=0;i--){let l=t.start(i);if(l<t.pos-(t.depth-i)||s.end(i)>s.pos+(s.depth-i)||t.node(i).type.spec.isolating||s.node(i).type.spec.isolating)break;(l==s.start(i)||i==t.depth&&i==s.depth&&t.parent.inlineContent&&s.parent.inlineContent&&i&&s.start(i-1)==l-1)&&n.push(i)}return n}class Yh extends sa{constructor(s,n,a){super(),this.pos=s,this.attr=n,this.value=a}apply(s){let n=s.nodeAt(this.pos);if(!n)return qn.fail("No node at attribute step's position");let a=Object.create(null);for(let l in n.attrs)a[l]=n.attrs[l];a[this.attr]=this.value;let i=n.type.create(a,null,n.marks);return qn.fromReplace(s,this.pos,this.pos+1,new ct(ze.from(i),0,n.isLeaf?0:1))}getMap(){return ai.empty}invert(s){return new Yh(this.pos,this.attr,s.nodeAt(this.pos).attrs[this.attr])}map(s){let n=s.mapResult(this.pos,1);return n.deletedAfter?null:new Yh(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(s,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Yh(n.pos,n.attr,n.value)}}sa.jsonID("attr",Yh);class cx extends sa{constructor(s,n){super(),this.attr=s,this.value=n}apply(s){let n=Object.create(null);for(let i in s.attrs)n[i]=s.attrs[i];n[this.attr]=this.value;let a=s.type.create(n,s.content,s.marks);return qn.ok(a)}getMap(){return ai.empty}invert(s){return new cx(this.attr,s.attrs[this.attr])}map(s){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(s,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new cx(n.attr,n.value)}}sa.jsonID("docAttr",cx);let xm=class extends Error{};xm=function t(s){let n=Error.call(this,s);return n.__proto__=t.prototype,n};xm.prototype=Object.create(Error.prototype);xm.prototype.constructor=xm;xm.prototype.name="TransformError";class Jz{constructor(s){this.doc=s,this.steps=[],this.docs=[],this.mapping=new ox}get before(){return this.docs.length?this.docs[0]:this.doc}step(s){let n=this.maybeStep(s);if(n.failed)throw new xm(n.failed);return this}maybeStep(s){let n=s.apply(this.doc);return n.failed||this.addStep(s,n.doc),n}get docChanged(){return this.steps.length>0}addStep(s,n){this.docs.push(this.doc),this.steps.push(s),this.mapping.appendMap(s.getMap()),this.doc=n}replace(s,n=s,a=ct.empty){let i=Pv(this.doc,s,n,a);return i&&this.step(i),this}replaceWith(s,n,a){return this.replace(s,n,new ct(ze.from(a),0,0))}delete(s,n){return this.replace(s,n,ct.empty)}insert(s,n){return this.replaceWith(s,s,n)}replaceRange(s,n,a){return b1e(this,s,n,a),this}replaceRangeWith(s,n,a){return v1e(this,s,n,a),this}deleteRange(s,n){return N1e(this,s,n),this}lift(s,n){return a1e(this,s,n),this}join(s,n=1){return f1e(this,s,n),this}wrap(s,n){return o1e(this,s,n),this}setBlockType(s,n=s,a,i=null){return c1e(this,s,n,a,i),this}setNodeMarkup(s,n,a=null,i){return u1e(this,s,n,a,i),this}setNodeAttribute(s,n,a){return this.step(new Yh(s,n,a)),this}setDocAttribute(s,n){return this.step(new cx(s,n)),this}addNodeMark(s,n){return this.step(new zc(s,n)),this}removeNodeMark(s,n){let a=this.doc.nodeAt(s);if(!a)throw new RangeError("No node at position "+s);if(n instanceof en)n.isInSet(a.marks)&&this.step(new Tu(s,n));else{let i=a.marks,l,o=[];for(;l=n.isInSet(i);)o.push(new Tu(s,l)),i=l.removeFromSet(i);for(let c=o.length-1;c>=0;c--)this.step(o[c])}return this}split(s,n=1,a){return h1e(this,s,n,a),this}addMark(s,n,a){return s1e(this,s,n,a),this}removeMark(s,n,a){return n1e(this,s,n,a),this}clearIncompatible(s,n,a){return Jk(this,s,n,a),this}}const wj=Object.create(null);class Bt{constructor(s,n,a){this.$anchor=s,this.$head=n,this.ranges=a||[new eU(s.min(n),s.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let s=this.ranges;for(let n=0;n<s.length;n++)if(s[n].$from.pos!=s[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(s,n=ct.empty){let a=n.content.lastChild,i=null;for(let c=0;c<n.openEnd;c++)i=a,a=a.lastChild;let l=s.steps.length,o=this.ranges;for(let c=0;c<o.length;c++){let{$from:d,$to:u}=o[c],h=s.mapping.slice(l);s.replaceRange(h.map(d.pos),h.map(u.pos),c?ct.empty:n),c==0&&iM(s,l,(a?a.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(s,n){let a=s.steps.length,i=this.ranges;for(let l=0;l<i.length;l++){let{$from:o,$to:c}=i[l],d=s.mapping.slice(a),u=d.map(o.pos),h=d.map(c.pos);l?s.deleteRange(u,h):(s.replaceRangeWith(u,h,n),iM(s,a,n.isInline?-1:1))}}static findFrom(s,n,a=!1){let i=s.parent.inlineContent?new kt(s):xh(s.node(0),s.parent,s.pos,s.index(),n,a);if(i)return i;for(let l=s.depth-1;l>=0;l--){let o=n<0?xh(s.node(0),s.node(l),s.before(l+1),s.index(l),n,a):xh(s.node(0),s.node(l),s.after(l+1),s.index(l)+1,n,a);if(o)return o}return null}static near(s,n=1){return this.findFrom(s,n)||this.findFrom(s,-n)||new La(s.node(0))}static atStart(s){return xh(s,s,0,0,1)||new La(s)}static atEnd(s){return xh(s,s,s.content.size,s.childCount,-1)||new La(s)}static fromJSON(s,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let a=wj[n.type];if(!a)throw new RangeError(`No selection type ${n.type} defined`);return a.fromJSON(s,n)}static jsonID(s,n){if(s in wj)throw new RangeError("Duplicate use of selection JSON ID "+s);return wj[s]=n,n.prototype.jsonID=s,n}getBookmark(){return kt.between(this.$anchor,this.$head).getBookmark()}}Bt.prototype.visible=!0;class eU{constructor(s,n){this.$from=s,this.$to=n}}let rM=!1;function aM(t){!rM&&!t.parent.inlineContent&&(rM=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class kt extends Bt{constructor(s,n=s){aM(s),aM(n),super(s,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(s,n){let a=s.resolve(n.map(this.head));if(!a.parent.inlineContent)return Bt.near(a);let i=s.resolve(n.map(this.anchor));return new kt(i.parent.inlineContent?i:a,a)}replace(s,n=ct.empty){if(super.replace(s,n),n==ct.empty){let a=this.$from.marksAcross(this.$to);a&&s.ensureMarks(a)}}eq(s){return s instanceof kt&&s.anchor==this.anchor&&s.head==this.head}getBookmark(){return new Iv(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(s,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new kt(s.resolve(n.anchor),s.resolve(n.head))}static create(s,n,a=n){let i=s.resolve(n);return new this(i,a==n?i:s.resolve(a))}static between(s,n,a){let i=s.pos-n.pos;if((!a||i)&&(a=i>=0?1:-1),!n.parent.inlineContent){let l=Bt.findFrom(n,a,!0)||Bt.findFrom(n,-a,!0);if(l)n=l.$head;else return Bt.near(n,a)}return s.parent.inlineContent||(i==0?s=n:(s=(Bt.findFrom(s,-a,!0)||Bt.findFrom(s,a,!0)).$anchor,s.pos<n.pos!=i<0&&(s=n))),new kt(s,n)}}Bt.jsonID("text",kt);class Iv{constructor(s,n){this.anchor=s,this.head=n}map(s){return new Iv(s.map(this.anchor),s.map(this.head))}resolve(s){return kt.between(s.resolve(this.anchor),s.resolve(this.head))}}class Pt extends Bt{constructor(s){let n=s.nodeAfter,a=s.node(0).resolve(s.pos+n.nodeSize);super(s,a),this.node=n}map(s,n){let{deleted:a,pos:i}=n.mapResult(this.anchor),l=s.resolve(i);return a?Bt.near(l):new Pt(l)}content(){return new ct(ze.from(this.node),0,0)}eq(s){return s instanceof Pt&&s.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new t5(this.anchor)}static fromJSON(s,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Pt(s.resolve(n.anchor))}static create(s,n){return new Pt(s.resolve(n))}static isSelectable(s){return!s.isText&&s.type.spec.selectable!==!1}}Pt.prototype.visible=!1;Bt.jsonID("node",Pt);class t5{constructor(s){this.anchor=s}map(s){let{deleted:n,pos:a}=s.mapResult(this.anchor);return n?new Iv(a,a):new t5(a)}resolve(s){let n=s.resolve(this.anchor),a=n.nodeAfter;return a&&Pt.isSelectable(a)?new Pt(n):Bt.near(n)}}class La extends Bt{constructor(s){super(s.resolve(0),s.resolve(s.content.size))}replace(s,n=ct.empty){if(n==ct.empty){s.delete(0,s.doc.content.size);let a=Bt.atStart(s.doc);a.eq(s.selection)||s.setSelection(a)}else super.replace(s,n)}toJSON(){return{type:"all"}}static fromJSON(s){return new La(s)}map(s){return new La(s)}eq(s){return s instanceof La}getBookmark(){return w1e}}Bt.jsonID("all",La);const w1e={map(){return this},resolve(t){return new La(t)}};function xh(t,s,n,a,i,l=!1){if(s.inlineContent)return kt.create(t,n);for(let o=a-(i>0?0:1);i>0?o<s.childCount:o>=0;o+=i){let c=s.child(o);if(c.isAtom){if(!l&&Pt.isSelectable(c))return Pt.create(t,n-(i<0?c.nodeSize:0))}else{let d=xh(t,c,n+i,i<0?c.childCount:0,i,l);if(d)return d}n+=c.nodeSize*i}return null}function iM(t,s,n){let a=t.steps.length-1;if(a<s)return;let i=t.steps[a];if(!(i instanceof nr||i instanceof ur))return;let l=t.mapping.maps[a],o;l.forEach((c,d,u,h)=>{o==null&&(o=h)}),t.setSelection(Bt.near(t.doc.resolve(o),n))}function lM(t,s){return!s||!t?t:t.bind(s)}class ug{constructor(s,n,a){this.name=s,this.init=lM(n.init,a),this.apply=lM(n.apply,a)}}new ug("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new ug("selection",{init(t,s){return t.selection||Bt.atStart(s.doc)},apply(t){return t.selection}}),new ug("storedMarks",{init(t){return t.storedMarks||null},apply(t,s,n,a){return a.selection.$cursor?t.storedMarks:null}}),new ug("scrollToSelection",{init(){return 0},apply(t,s){return t.scrolledIntoView?s+1:s}});function tU(t,s,n){for(let a in t){let i=t[a];i instanceof Function?i=i.bind(s):a=="handleDOMEvents"&&(i=tU(i,s,{})),n[a]=i}return n}class Ln{constructor(s){this.spec=s,this.props={},s.props&&tU(s.props,this,this.props),this.key=s.key?s.key.key:sU("plugin")}getState(s){return s[this.key]}}const jj=Object.create(null);function sU(t){return t in jj?t+"$"+ ++jj[t]:(jj[t]=0,t+"$")}class Bn{constructor(s="key"){this.key=sU(s)}get(s){return s.config.pluginsByKey[this.key]}getState(s){return s[this.key]}}const Mv=(t,s)=>t.selection.empty?!1:(s&&s(t.tr.deleteSelection().scrollIntoView()),!0);function nU(t,s){let{$cursor:n}=t.selection;return!n||(s?!s.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const s5=(t,s,n)=>{let a=nU(t,n);if(!a)return!1;let i=r5(a);if(!i){let o=a.blockRange(),c=o&&qu(o);return c==null?!1:(s&&s(t.tr.lift(o,c).scrollIntoView()),!0)}let l=i.nodeBefore;if(mU(t,i,s,-1))return!0;if(a.parent.content.size==0&&(gm(l,"end")||Pt.isSelectable(l)))for(let o=a.depth;;o--){let c=Pv(t.doc,a.before(o),a.after(o),ct.empty);if(c&&c.slice.size<c.to-c.from){if(s){let d=t.tr.step(c);d.setSelection(gm(l,"end")?Bt.findFrom(d.doc.resolve(d.mapping.map(i.pos,-1)),-1):Pt.create(d.doc,i.pos-l.nodeSize)),s(d.scrollIntoView())}return!0}if(o==1||a.node(o-1).childCount>1)break}return l.isAtom&&i.depth==a.depth-1?(s&&s(t.tr.delete(i.pos-l.nodeSize,i.pos).scrollIntoView()),!0):!1},rU=(t,s,n)=>{let a=nU(t,n);if(!a)return!1;let i=r5(a);return i?iU(t,i,s):!1},aU=(t,s,n)=>{let a=lU(t,n);if(!a)return!1;let i=l5(a);return i?iU(t,i,s):!1};function iU(t,s,n){let a=s.nodeBefore,i=a,l=s.pos-1;for(;!i.isTextblock;l--){if(i.type.spec.isolating)return!1;let h=i.lastChild;if(!h)return!1;i=h}let o=s.nodeAfter,c=o,d=s.pos+1;for(;!c.isTextblock;d++){if(c.type.spec.isolating)return!1;let h=c.firstChild;if(!h)return!1;c=h}let u=Pv(t.doc,l,d,ct.empty);if(!u||u.from!=l||u instanceof nr&&u.slice.size>=d-l)return!1;if(n){let h=t.tr.step(u);h.setSelection(kt.create(h.doc,l)),n(h.scrollIntoView())}return!0}function gm(t,s,n=!1){for(let a=t;a;a=s=="start"?a.firstChild:a.lastChild){if(a.isTextblock)return!0;if(n&&a.childCount!=1)return!1}return!1}const n5=(t,s,n)=>{let{$head:a,empty:i}=t.selection,l=a;if(!i)return!1;if(a.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):a.parentOffset>0)return!1;l=r5(a)}let o=l&&l.nodeBefore;return!o||!Pt.isSelectable(o)?!1:(s&&s(t.tr.setSelection(Pt.create(t.doc,l.pos-o.nodeSize)).scrollIntoView()),!0)};function r5(t){if(!t.parent.type.spec.isolating)for(let s=t.depth-1;s>=0;s--){if(t.index(s)>0)return t.doc.resolve(t.before(s+1));if(t.node(s).type.spec.isolating)break}return null}function lU(t,s){let{$cursor:n}=t.selection;return!n||(s?!s.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const a5=(t,s,n)=>{let a=lU(t,n);if(!a)return!1;let i=l5(a);if(!i)return!1;let l=i.nodeAfter;if(mU(t,i,s,1))return!0;if(a.parent.content.size==0&&(gm(l,"start")||Pt.isSelectable(l))){let o=Pv(t.doc,a.before(),a.after(),ct.empty);if(o&&o.slice.size<o.to-o.from){if(s){let c=t.tr.step(o);c.setSelection(gm(l,"start")?Bt.findFrom(c.doc.resolve(c.mapping.map(i.pos)),1):Pt.create(c.doc,c.mapping.map(i.pos))),s(c.scrollIntoView())}return!0}}return l.isAtom&&i.depth==a.depth-1?(s&&s(t.tr.delete(i.pos,i.pos+l.nodeSize).scrollIntoView()),!0):!1},i5=(t,s,n)=>{let{$head:a,empty:i}=t.selection,l=a;if(!i)return!1;if(a.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):a.parentOffset<a.parent.content.size)return!1;l=l5(a)}let o=l&&l.nodeAfter;return!o||!Pt.isSelectable(o)?!1:(s&&s(t.tr.setSelection(Pt.create(t.doc,l.pos)).scrollIntoView()),!0)};function l5(t){if(!t.parent.type.spec.isolating)for(let s=t.depth-1;s>=0;s--){let n=t.node(s);if(t.index(s)+1<n.childCount)return t.doc.resolve(t.after(s+1));if(n.type.spec.isolating)break}return null}const oU=(t,s)=>{let n=t.selection,a=n instanceof Pt,i;if(a){if(n.node.isTextblock||!go(t.doc,n.from))return!1;i=n.from}else if(i=Km(t.doc,n.from,-1),i==null)return!1;if(s){let l=t.tr.join(i);a&&l.setSelection(Pt.create(l.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),s(l.scrollIntoView())}return!0},cU=(t,s)=>{let n=t.selection,a;if(n instanceof Pt){if(n.node.isTextblock||!go(t.doc,n.to))return!1;a=n.to}else if(a=Km(t.doc,n.to,1),a==null)return!1;return s&&s(t.tr.join(a).scrollIntoView()),!0},dU=(t,s)=>{let{$from:n,$to:a}=t.selection,i=n.blockRange(a),l=i&&qu(i);return l==null?!1:(s&&s(t.tr.lift(i,l).scrollIntoView()),!0)},o5=(t,s)=>{let{$head:n,$anchor:a}=t.selection;return!n.parent.type.spec.code||!n.sameParent(a)?!1:(s&&s(t.tr.insertText(`
`).scrollIntoView()),!0)};function c5(t){for(let s=0;s<t.edgeCount;s++){let{type:n}=t.edge(s);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const uU=(t,s)=>{let{$head:n,$anchor:a}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(a))return!1;let i=n.node(-1),l=n.indexAfter(-1),o=c5(i.contentMatchAt(l));if(!o||!i.canReplaceWith(l,l,o))return!1;if(s){let c=n.after(),d=t.tr.replaceWith(c,c,o.createAndFill());d.setSelection(Bt.near(d.doc.resolve(c),1)),s(d.scrollIntoView())}return!0},d5=(t,s)=>{let n=t.selection,{$from:a,$to:i}=n;if(n instanceof La||a.parent.inlineContent||i.parent.inlineContent)return!1;let l=c5(i.parent.contentMatchAt(i.indexAfter()));if(!l||!l.isTextblock)return!1;if(s){let o=(!a.parentOffset&&i.index()<i.parent.childCount?a:i).pos,c=t.tr.insert(o,l.createAndFill());c.setSelection(kt.create(c.doc,o+1)),s(c.scrollIntoView())}return!0},u5=(t,s)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let l=n.before();if(mi(t.doc,l))return s&&s(t.tr.split(l).scrollIntoView()),!0}let a=n.blockRange(),i=a&&qu(a);return i==null?!1:(s&&s(t.tr.lift(a,i).scrollIntoView()),!0)};function j1e(t){return(s,n)=>{let{$from:a,$to:i}=s.selection;if(s.selection instanceof Pt&&s.selection.node.isBlock)return!a.parentOffset||!mi(s.doc,a.pos)?!1:(n&&n(s.tr.split(a.pos).scrollIntoView()),!0);if(!a.depth)return!1;let l=[],o,c,d=!1,u=!1;for(let b=a.depth;;b--)if(a.node(b).isBlock){d=a.end(b)==a.pos+(a.depth-b),u=a.start(b)==a.pos-(a.depth-b),c=c5(a.node(b-1).contentMatchAt(a.indexAfter(b-1))),l.unshift(d&&c?{type:c}:null),o=b;break}else{if(b==1)return!1;l.unshift(null)}let h=s.tr;(s.selection instanceof kt||s.selection instanceof La)&&h.deleteSelection();let f=h.mapping.map(a.pos),x=mi(h.doc,f,l.length,l);if(x||(l[0]=c?{type:c}:null,x=mi(h.doc,f,l.length,l)),!x)return!1;if(h.split(f,l.length,l),!d&&u&&a.node(o).type!=c){let b=h.mapping.map(a.before(o)),v=h.doc.resolve(b);c&&a.node(o-1).canReplaceWith(v.index(),v.index()+1,c)&&h.setNodeMarkup(h.mapping.map(a.before(o)),c)}return n&&n(h.scrollIntoView()),!0}}const _1e=j1e(),hU=(t,s)=>{let{$from:n,to:a}=t.selection,i,l=n.sharedDepth(a);return l==0?!1:(i=n.before(l),s&&s(t.tr.setSelection(Pt.create(t.doc,i))),!0)};function S1e(t,s,n){let a=s.nodeBefore,i=s.nodeAfter,l=s.index();return!a||!i||!a.type.compatibleContent(i.type)?!1:!a.content.size&&s.parent.canReplace(l-1,l)?(n&&n(t.tr.delete(s.pos-a.nodeSize,s.pos).scrollIntoView()),!0):!s.parent.canReplace(l,l+1)||!(i.isTextblock||go(t.doc,s.pos))?!1:(n&&n(t.tr.join(s.pos).scrollIntoView()),!0)}function mU(t,s,n,a){let i=s.nodeBefore,l=s.nodeAfter,o,c,d=i.type.spec.isolating||l.type.spec.isolating;if(!d&&S1e(t,s,n))return!0;let u=!d&&s.parent.canReplace(s.index(),s.index()+1);if(u&&(o=(c=i.contentMatchAt(i.childCount)).findWrapping(l.type))&&c.matchType(o[0]||l.type).validEnd){if(n){let b=s.pos+l.nodeSize,v=ze.empty;for(let S=o.length-1;S>=0;S--)v=ze.from(o[S].create(null,v));v=ze.from(i.copy(v));let w=t.tr.step(new ur(s.pos-1,b,s.pos,b,new ct(v,1,0),o.length,!0)),_=w.doc.resolve(b+2*o.length);_.nodeAfter&&_.nodeAfter.type==i.type&&go(w.doc,_.pos)&&w.join(_.pos),n(w.scrollIntoView())}return!0}let h=l.type.spec.isolating||a>0&&d?null:Bt.findFrom(s,1),f=h&&h.$from.blockRange(h.$to),x=f&&qu(f);if(x!=null&&x>=s.depth)return n&&n(t.tr.lift(f,x).scrollIntoView()),!0;if(u&&gm(l,"start",!0)&&gm(i,"end")){let b=i,v=[];for(;v.push(b),!b.isTextblock;)b=b.lastChild;let w=l,_=1;for(;!w.isTextblock;w=w.firstChild)_++;if(b.canReplace(b.childCount,b.childCount,w.content)){if(n){let S=ze.empty;for(let A=v.length-1;A>=0;A--)S=ze.from(v[A].copy(S));let k=t.tr.step(new ur(s.pos-v.length,s.pos+l.nodeSize,s.pos+_,s.pos+l.nodeSize-_,new ct(S,v.length,0),0,!0));n(k.scrollIntoView())}return!0}}return!1}function fU(t){return function(s,n){let a=s.selection,i=t<0?a.$from:a.$to,l=i.depth;for(;i.node(l).isInline;){if(!l)return!1;l--}return i.node(l).isTextblock?(n&&n(s.tr.setSelection(kt.create(s.doc,t<0?i.start(l):i.end(l)))),!0):!1}}const pU=fU(-1),xU=fU(1);function gU(t,s=null){return function(n,a){let{$from:i,$to:l}=n.selection,o=i.blockRange(l),c=o&&e5(o,t,s);return c?(a&&a(n.tr.wrap(o,c).scrollIntoView()),!0):!1}}function j1(t,s=null){return function(n,a){let i=!1;for(let l=0;l<n.selection.ranges.length&&!i;l++){let{$from:{pos:o},$to:{pos:c}}=n.selection.ranges[l];n.doc.nodesBetween(o,c,(d,u)=>{if(i)return!1;if(!(!d.isTextblock||d.hasMarkup(t,s)))if(d.type==t)i=!0;else{let h=n.doc.resolve(u),f=h.index();i=h.parent.canReplaceWith(f,f+1,t)}})}if(!i)return!1;if(a){let l=n.tr;for(let o=0;o<n.selection.ranges.length;o++){let{$from:{pos:c},$to:{pos:d}}=n.selection.ranges[o];l.setBlockType(c,d,t,s)}a(l.scrollIntoView())}return!0}}function h5(...t){return function(s,n,a){for(let i=0;i<t.length;i++)if(t[i](s,n,a))return!0;return!1}}h5(Mv,s5,n5);h5(Mv,a5,i5);h5(o5,d5,u5,_1e);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function yU(t,s=null){return function(n,a){let{$from:i,$to:l}=n.selection,o=i.blockRange(l);if(!o)return!1;let c=a?n.tr:null;return C1e(c,o,t,s)?(a&&a(c.scrollIntoView()),!0):!1}}function C1e(t,s,n,a=null){let i=!1,l=s,o=s.$from.doc;if(s.depth>=2&&s.$from.node(s.depth-1).type.compatibleContent(n)&&s.startIndex==0){if(s.$from.index(s.depth-1)==0)return!1;let d=o.resolve(s.start-2);l=new N1(d,d,s.depth),s.endIndex<s.parent.childCount&&(s=new N1(s.$from,o.resolve(s.$to.end(s.depth)),s.depth)),i=!0}let c=e5(l,n,a,s);return c?(t&&k1e(t,s,c,i,n),!0):!1}function k1e(t,s,n,a,i){let l=ze.empty;for(let h=n.length-1;h>=0;h--)l=ze.from(n[h].type.create(n[h].attrs,l));t.step(new ur(s.start-(a?2:0),s.end,s.start,s.end,new ct(l,0,0),n.length,!0));let o=0;for(let h=0;h<n.length;h++)n[h].type==i&&(o=h+1);let c=n.length-o,d=s.start+n.length-(a?2:0),u=s.parent;for(let h=s.startIndex,f=s.endIndex,x=!0;h<f;h++,x=!1)!x&&mi(t.doc,d,c)&&(t.split(d,c),d+=2*c),d+=u.child(h).nodeSize;return t}function bU(t){return function(s,n){let{$from:a,$to:i}=s.selection,l=a.blockRange(i,o=>o.childCount>0&&o.firstChild.type==t);return l?n?a.node(l.depth-1).type==t?A1e(s,n,t,l):E1e(s,n,l):!0:!1}}function A1e(t,s,n,a){let i=t.tr,l=a.end,o=a.$to.end(a.depth);l<o&&(i.step(new ur(l-1,o,l,o,new ct(ze.from(n.create(null,a.parent.copy())),1,0),1,!0)),a=new N1(i.doc.resolve(a.$from.pos),i.doc.resolve(o),a.depth));const c=qu(a);if(c==null)return!1;i.lift(a,c);let d=i.doc.resolve(i.mapping.map(l,-1)-1);return go(i.doc,d.pos)&&d.nodeBefore.type==d.nodeAfter.type&&i.join(d.pos),s(i.scrollIntoView()),!0}function E1e(t,s,n){let a=t.tr,i=n.parent;for(let b=n.end,v=n.endIndex-1,w=n.startIndex;v>w;v--)b-=i.child(v).nodeSize,a.delete(b-1,b+1);let l=a.doc.resolve(n.start),o=l.nodeAfter;if(a.mapping.map(n.end)!=n.start+l.nodeAfter.nodeSize)return!1;let c=n.startIndex==0,d=n.endIndex==i.childCount,u=l.node(-1),h=l.index(-1);if(!u.canReplace(h+(c?0:1),h+1,o.content.append(d?ze.empty:ze.from(i))))return!1;let f=l.pos,x=f+o.nodeSize;return a.step(new ur(f-(c?1:0),x+(d?1:0),f+1,x-1,new ct((c?ze.empty:ze.from(i.copy(ze.empty))).append(d?ze.empty:ze.from(i.copy(ze.empty))),c?0:1,d?0:1),c?0:1)),s(a.scrollIntoView()),!0}function vU(t){return function(s,n){let{$from:a,$to:i}=s.selection,l=a.blockRange(i,u=>u.childCount>0&&u.firstChild.type==t);if(!l)return!1;let o=l.startIndex;if(o==0)return!1;let c=l.parent,d=c.child(o-1);if(d.type!=t)return!1;if(n){let u=d.lastChild&&d.lastChild.type==c.type,h=ze.from(u?t.create():null),f=new ct(ze.from(t.create(null,ze.from(c.type.create(null,h)))),u?3:1,0),x=l.start,b=l.end;n(s.tr.step(new ur(x-(u?3:1),b,x,b,f,1,!0)).scrollIntoView())}return!0}}const Gu=function(t){for(var s=0;;s++)if(t=t.previousSibling,!t)return s},NU=function(t,s,n,a){return n&&(oM(t,s,n,a,-1)||oM(t,s,n,a,1))},T1e=/^(img|br|input|textarea|hr)$/i;function oM(t,s,n,a,i){for(var l;;){if(t==n&&s==a)return!0;if(s==(i<0?0:_1(t))){let o=t.parentNode;if(!o||o.nodeType!=1||m5(t)||T1e.test(t.nodeName)||t.contentEditable=="false")return!1;s=Gu(t)+(i<0?0:1),t=o}else if(t.nodeType==1){let o=t.childNodes[s+(i<0?-1:0)];if(o.nodeType==1&&o.contentEditable=="false")if(!((l=o.pmViewDesc)===null||l===void 0)&&l.ignoreForSelection)s+=i;else return!1;else t=o,s=i<0?_1(t):0}else return!1}}function _1(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function P1e(t,s,n){for(let a=s==0,i=s==_1(t);a||i;){if(t==n)return!0;let l=Gu(t);if(t=t.parentNode,!t)return!1;a=a&&l==0,i=i&&l==_1(t)}}function m5(t){let s;for(let n=t;n&&!(s=n.pmViewDesc);n=n.parentNode);return s&&s.node&&s.node.isBlock&&(s.dom==t||s.contentDOM==t)}const wU=function(t){return t.focusNode&&NU(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function jU(t,s){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=s,n}const oo=typeof navigator<"u"?navigator:null,cM=typeof document<"u"?document:null,vd=oo&&oo.userAgent||"",_S=/Edge\/(\d+)/.exec(vd),_U=/MSIE \d/.exec(vd),SS=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(vd),Xx=!!(_U||SS||_S),SU=_U?document.documentMode:SS?+SS[1]:_S?+_S[1]:0,Dv=!Xx&&/gecko\/(\d+)/i.test(vd);Dv&&+(/Firefox\/(\d+)/.exec(vd)||[0,0])[1];const CS=!Xx&&/Chrome\/(\d+)/.exec(vd),Nd=!!CS,CU=CS?+CS[1]:0,Ku=!Xx&&!!oo&&/Apple Computer/.test(oo.vendor),f5=Ku&&(/Mobile\/\w+/.test(vd)||!!oo&&oo.maxTouchPoints>2),Ti=f5||(oo?/Mac/.test(oo.platform):!1),I1e=oo?/Win/.test(oo.platform):!1,Qx=/Android \d/.test(vd),p5=!!cM&&"webkitFontSmoothing"in cM.documentElement.style,M1e=p5?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function D1e(t,s=null){let n=t.domSelectionRange(),a=t.state.doc;if(!n.focusNode)return null;let i=t.docView.nearestDesc(n.focusNode),l=i&&i.size==0,o=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(o<0)return null;let c=a.resolve(o),d,u;if(wU(n)){for(d=o;i&&!i.node;)i=i.parent;let f=i.node;if(i&&f.isAtom&&Pt.isSelectable(f)&&i.parent&&!(f.isInline&&P1e(n.focusNode,n.focusOffset,i.dom))){let x=i.posBefore;u=new Pt(o==x?c:a.resolve(x))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let f=o,x=o;for(let b=0;b<n.rangeCount;b++){let v=n.getRangeAt(b);f=Math.min(f,t.docView.posFromDOM(v.startContainer,v.startOffset,1)),x=Math.max(x,t.docView.posFromDOM(v.endContainer,v.endOffset,-1))}if(f<0)return null;[d,o]=x==t.state.selection.anchor?[x,f]:[f,x],c=a.resolve(o)}else d=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(d<0)return null}let h=a.resolve(d);if(!u){let f=s=="pointer"||t.state.selection.head<c.pos&&!l?1:-1;u=AU(t,h,c,f)}return u}function kU(t){return t.editable?t.hasFocus():B1e(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function x5(t,s=!1){let n=t.state.selection;if(L1e(t,n),!!kU(t)){if(!s&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&Nd){let a=t.domSelectionRange(),i=t.domObserver.currentSelection;if(a.anchorNode&&i.anchorNode&&NU(a.anchorNode,a.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)R1e(t);else{let{anchor:a,head:i}=n,l,o;dM&&!(n instanceof kt)&&(n.$from.parent.inlineContent||(l=uM(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(o=uM(t,n.to))),t.docView.setSelection(a,i,t,s),dM&&(l&&hM(l),o&&hM(o)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&O1e(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const dM=Ku||Nd&&CU<63;function uM(t,s){let{node:n,offset:a}=t.docView.domFromPos(s,0),i=a<n.childNodes.length?n.childNodes[a]:null,l=a?n.childNodes[a-1]:null;if(Ku&&i&&i.contentEditable=="false")return _j(i);if((!i||i.contentEditable=="false")&&(!l||l.contentEditable=="false")){if(i)return _j(i);if(l)return _j(l)}}function _j(t){return t.contentEditable="true",Ku&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function hM(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function O1e(t){let s=t.dom.ownerDocument;s.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),a=n.anchorNode,i=n.anchorOffset;s.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=a||n.anchorOffset!=i)&&(s.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!kU(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function R1e(t){let s=t.domSelection();if(!s)return;let n=t.cursorWrapper.dom,a=n.nodeName=="IMG";a?s.collapse(n.parentNode,Gu(n)+1):s.collapse(n,0),!a&&!t.state.selection.visible&&Xx&&SU<=11&&(n.disabled=!0,n.disabled=!1)}function L1e(t,s){if(s instanceof Pt){let n=t.docView.descAt(s.from);n!=t.lastSelectedViewDesc&&(mM(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else mM(t)}function mM(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function AU(t,s,n,a){return t.someProp("createSelectionBetween",i=>i(t,s,n))||kt.between(s,n,a)}function B1e(t){let s=t.domSelectionRange();if(!s.anchorNode)return!1;try{return t.dom.contains(s.anchorNode.nodeType==3?s.anchorNode.parentNode:s.anchorNode)&&(t.editable||t.dom.contains(s.focusNode.nodeType==3?s.focusNode.parentNode:s.focusNode))}catch{return!1}}function kS(t,s){let{$anchor:n,$head:a}=t.selection,i=s>0?n.max(a):n.min(a),l=i.parent.inlineContent?i.depth?t.doc.resolve(s>0?i.after():i.before()):null:i;return l&&Bt.findFrom(l,s)}function _c(t,s){return t.dispatch(t.state.tr.setSelection(s).scrollIntoView()),!0}function fM(t,s,n){let a=t.state.selection;if(a instanceof kt)if(n.indexOf("s")>-1){let{$head:i}=a,l=i.textOffset?null:s<0?i.nodeBefore:i.nodeAfter;if(!l||l.isText||!l.isLeaf)return!1;let o=t.state.doc.resolve(i.pos+l.nodeSize*(s<0?-1:1));return _c(t,new kt(a.$anchor,o))}else if(a.empty){if(t.endOfTextblock(s>0?"forward":"backward")){let i=kS(t.state,s);return i&&i instanceof Pt?_c(t,i):!1}else if(!(Ti&&n.indexOf("m")>-1)){let i=a.$head,l=i.textOffset?null:s<0?i.nodeBefore:i.nodeAfter,o;if(!l||l.isText)return!1;let c=s<0?i.pos-l.nodeSize:i.pos;return l.isAtom||(o=t.docView.descAt(c))&&!o.contentDOM?Pt.isSelectable(l)?_c(t,new Pt(s<0?t.state.doc.resolve(i.pos-l.nodeSize):i)):p5?_c(t,new kt(t.state.doc.resolve(s<0?c:c+l.nodeSize))):!1:!1}}else return!1;else{if(a instanceof Pt&&a.node.isInline)return _c(t,new kt(s>0?a.$to:a.$from));{let i=kS(t.state,s);return i?_c(t,i):!1}}}function S1(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function _p(t,s){let n=t.pmViewDesc;return n&&n.size==0&&(s<0||t.nextSibling||t.nodeName!="BR")}function hh(t,s){return s<0?F1e(t):$1e(t)}function F1e(t){let s=t.domSelectionRange(),n=s.focusNode,a=s.focusOffset;if(!n)return;let i,l,o=!1;for(Dv&&n.nodeType==1&&a<S1(n)&&_p(n.childNodes[a],-1)&&(o=!0);;)if(a>0){if(n.nodeType!=1)break;{let c=n.childNodes[a-1];if(_p(c,-1))i=n,l=--a;else if(c.nodeType==3)n=c,a=n.nodeValue.length;else break}}else{if(EU(n))break;{let c=n.previousSibling;for(;c&&_p(c,-1);)i=n.parentNode,l=Gu(c),c=c.previousSibling;if(c)n=c,a=S1(n);else{if(n=n.parentNode,n==t.dom)break;a=0}}}o?AS(t,n,a):i&&AS(t,i,l)}function $1e(t){let s=t.domSelectionRange(),n=s.focusNode,a=s.focusOffset;if(!n)return;let i=S1(n),l,o;for(;;)if(a<i){if(n.nodeType!=1)break;let c=n.childNodes[a];if(_p(c,1))l=n,o=++a;else break}else{if(EU(n))break;{let c=n.nextSibling;for(;c&&_p(c,1);)l=c.parentNode,o=Gu(c)+1,c=c.nextSibling;if(c)n=c,a=0,i=S1(n);else{if(n=n.parentNode,n==t.dom)break;a=i=0}}}l&&AS(t,l,o)}function EU(t){let s=t.pmViewDesc;return s&&s.node&&s.node.isBlock}function z1e(t,s){for(;t&&s==t.childNodes.length&&!m5(t);)s=Gu(t)+1,t=t.parentNode;for(;t&&s<t.childNodes.length;){let n=t.childNodes[s];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,s=0}}function U1e(t,s){for(;t&&!s&&!m5(t);)s=Gu(t),t=t.parentNode;for(;t&&s;){let n=t.childNodes[s-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,s=t.childNodes.length}}function AS(t,s,n){if(s.nodeType!=3){let l,o;(o=z1e(s,n))?(s=o,n=0):(l=U1e(s,n))&&(s=l,n=l.nodeValue.length)}let a=t.domSelection();if(!a)return;if(wU(a)){let l=document.createRange();l.setEnd(s,n),l.setStart(s,n),a.removeAllRanges(),a.addRange(l)}else a.extend&&a.extend(s,n);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&x5(t)},50)}function pM(t,s){let n=t.state.doc.resolve(s);if(!(Nd||I1e)&&n.parent.inlineContent){let i=t.coordsAtPos(s);if(s>n.start()){let l=t.coordsAtPos(s-1),o=(l.top+l.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(l.left-i.left)>1)return l.left<i.left?"ltr":"rtl"}if(s<n.end()){let l=t.coordsAtPos(s+1),o=(l.top+l.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(l.left-i.left)>1)return l.left>i.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function xM(t,s,n){let a=t.state.selection;if(a instanceof kt&&!a.empty||n.indexOf("s")>-1||Ti&&n.indexOf("m")>-1)return!1;let{$from:i,$to:l}=a;if(!i.parent.inlineContent||t.endOfTextblock(s<0?"up":"down")){let o=kS(t.state,s);if(o&&o instanceof Pt)return _c(t,o)}if(!i.parent.inlineContent){let o=s<0?i:l,c=a instanceof La?Bt.near(o,s):Bt.findFrom(o,s);return c?_c(t,c):!1}return!1}function gM(t,s){if(!(t.state.selection instanceof kt))return!0;let{$head:n,$anchor:a,empty:i}=t.state.selection;if(!n.sameParent(a))return!0;if(!i)return!1;if(t.endOfTextblock(s>0?"forward":"backward"))return!0;let l=!n.textOffset&&(s<0?n.nodeBefore:n.nodeAfter);if(l&&!l.isText){let o=t.state.tr;return s<0?o.delete(n.pos-l.nodeSize,n.pos):o.delete(n.pos,n.pos+l.nodeSize),t.dispatch(o),!0}return!1}function yM(t,s,n){t.domObserver.stop(),s.contentEditable=n,t.domObserver.start()}function V1e(t){if(!Ku||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:s,focusOffset:n}=t.domSelectionRange();if(s&&s.nodeType==1&&n==0&&s.firstChild&&s.firstChild.contentEditable=="false"){let a=s.firstChild;yM(t,a,"true"),setTimeout(()=>yM(t,a,"false"),20)}return!1}function H1e(t){let s="";return t.ctrlKey&&(s+="c"),t.metaKey&&(s+="m"),t.altKey&&(s+="a"),t.shiftKey&&(s+="s"),s}function W1e(t,s){let n=s.keyCode,a=H1e(s);if(n==8||Ti&&n==72&&a=="c")return gM(t,-1)||hh(t,-1);if(n==46&&!s.shiftKey||Ti&&n==68&&a=="c")return gM(t,1)||hh(t,1);if(n==13||n==27)return!0;if(n==37||Ti&&n==66&&a=="c"){let i=n==37?pM(t,t.state.selection.from)=="ltr"?-1:1:-1;return fM(t,i,a)||hh(t,i)}else if(n==39||Ti&&n==70&&a=="c"){let i=n==39?pM(t,t.state.selection.from)=="ltr"?1:-1:1;return fM(t,i,a)||hh(t,i)}else{if(n==38||Ti&&n==80&&a=="c")return xM(t,-1,a)||hh(t,-1);if(n==40||Ti&&n==78&&a=="c")return V1e(t)||xM(t,1,a)||hh(t,1);if(a==(Ti?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function TU(t,s){t.someProp("transformCopied",b=>{s=b(s,t)});let n=[],{content:a,openStart:i,openEnd:l}=s;for(;i>1&&l>1&&a.childCount==1&&a.firstChild.childCount==1;){i--,l--;let b=a.firstChild;n.push(b.type.name,b.attrs!=b.type.defaultAttrs?b.attrs:null),a=b.content}let o=t.someProp("clipboardSerializer")||Tv.fromSchema(t.state.schema),c=RU(),d=c.createElement("div");d.appendChild(o.serializeFragment(a,{document:c}));let u=d.firstChild,h,f=0;for(;u&&u.nodeType==1&&(h=OU[u.nodeName.toLowerCase()]);){for(let b=h.length-1;b>=0;b--){let v=c.createElement(h[b]);for(;d.firstChild;)v.appendChild(d.firstChild);d.appendChild(v),f++}u=d.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${i} ${l}${f?` -${f}`:""} ${JSON.stringify(n)}`);let x=t.someProp("clipboardTextSerializer",b=>b(s,t))||s.content.textBetween(0,s.content.size,`

`);return{dom:d,text:x,slice:s}}function PU(t,s,n,a,i){let l=i.parent.type.spec.code,o,c;if(!n&&!s)return null;let d=!!s&&(a||l||!n);if(d){if(t.someProp("transformPastedText",x=>{s=x(s,l||a,t)}),l)return c=new ct(ze.from(t.state.schema.text(s.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",x=>{c=x(c,t,!0)}),c;let f=t.someProp("clipboardTextParser",x=>x(s,i,a,t));if(f)c=f;else{let x=i.marks(),{schema:b}=t.state,v=Tv.fromSchema(b);o=document.createElement("div"),s.split(/(?:\r\n?|\n)+/).forEach(w=>{let _=o.appendChild(document.createElement("p"));w&&_.appendChild(v.serializeNode(b.text(w,x)))})}}else t.someProp("transformPastedHTML",f=>{n=f(n,t)}),o=Y1e(n),p5&&X1e(o);let u=o&&o.querySelector("[data-pm-slice]"),h=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(h&&h[3])for(let f=+h[3];f>0;f--){let x=o.firstChild;for(;x&&x.nodeType!=1;)x=x.nextSibling;if(!x)break;o=x}if(c||(c=(t.someProp("clipboardParser")||t.someProp("domParser")||ao.fromSchema(t.state.schema)).parseSlice(o,{preserveWhitespace:!!(d||h),context:i,ruleFromNode(x){return x.nodeName=="BR"&&!x.nextSibling&&x.parentNode&&!q1e.test(x.parentNode.nodeName)?{ignore:!0}:null}})),h)c=Q1e(bM(c,+h[1],+h[2]),h[4]);else if(c=ct.maxOpen(G1e(c.content,i),!0),c.openStart||c.openEnd){let f=0,x=0;for(let b=c.content.firstChild;f<c.openStart&&!b.type.spec.isolating;f++,b=b.firstChild);for(let b=c.content.lastChild;x<c.openEnd&&!b.type.spec.isolating;x++,b=b.lastChild);c=bM(c,f,x)}return t.someProp("transformPasted",f=>{c=f(c,t,d)}),c}const q1e=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function G1e(t,s){if(t.childCount<2)return t;for(let n=s.depth;n>=0;n--){let i=s.node(n).contentMatchAt(s.index(n)),l,o=[];if(t.forEach(c=>{if(!o)return;let d=i.findWrapping(c.type),u;if(!d)return o=null;if(u=o.length&&l.length&&MU(d,l,c,o[o.length-1],0))o[o.length-1]=u;else{o.length&&(o[o.length-1]=DU(o[o.length-1],l.length));let h=IU(c,d);o.push(h),i=i.matchType(h.type),l=d}}),o)return ze.from(o)}return t}function IU(t,s,n=0){for(let a=s.length-1;a>=n;a--)t=s[a].create(null,ze.from(t));return t}function MU(t,s,n,a,i){if(i<t.length&&i<s.length&&t[i]==s[i]){let l=MU(t,s,n,a.lastChild,i+1);if(l)return a.copy(a.content.replaceChild(a.childCount-1,l));if(a.contentMatchAt(a.childCount).matchType(i==t.length-1?n.type:t[i+1]))return a.copy(a.content.append(ze.from(IU(n,t,i+1))))}}function DU(t,s){if(s==0)return t;let n=t.content.replaceChild(t.childCount-1,DU(t.lastChild,s-1)),a=t.contentMatchAt(t.childCount).fillBefore(ze.empty,!0);return t.copy(n.append(a))}function ES(t,s,n,a,i,l){let o=s<0?t.firstChild:t.lastChild,c=o.content;return t.childCount>1&&(l=0),i<a-1&&(c=ES(c,s,n,a,i+1,l)),i>=n&&(c=s<0?o.contentMatchAt(0).fillBefore(c,l<=i).append(c):c.append(o.contentMatchAt(o.childCount).fillBefore(ze.empty,!0))),t.replaceChild(s<0?0:t.childCount-1,o.copy(c))}function bM(t,s,n){return s<t.openStart&&(t=new ct(ES(t.content,-1,s,t.openStart,0,t.openEnd),s,t.openEnd)),n<t.openEnd&&(t=new ct(ES(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const OU={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let vM=null;function RU(){return vM||(vM=document.implementation.createHTMLDocument("title"))}let Sj=null;function K1e(t){let s=window.trustedTypes;return s?(Sj||(Sj=s.defaultPolicy||s.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),Sj.createHTML(t)):t}function Y1e(t){let s=/^(\s*<meta [^>]*>)*/.exec(t);s&&(t=t.slice(s[0].length));let n=RU().createElement("div"),a=/<([a-z][^>\s]+)/i.exec(t),i;if((i=a&&OU[a[1].toLowerCase()])&&(t=i.map(l=>"<"+l+">").join("")+t+i.map(l=>"</"+l+">").reverse().join("")),n.innerHTML=K1e(t),i)for(let l=0;l<i.length;l++)n=n.querySelector(i[l])||n;return n}function X1e(t){let s=t.querySelectorAll(Nd?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<s.length;n++){let a=s[n];a.childNodes.length==1&&a.textContent==""&&a.parentNode&&a.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),a)}}function Q1e(t,s){if(!t.size)return t;let n=t.content.firstChild.type.schema,a;try{a=JSON.parse(s)}catch{return t}let{content:i,openStart:l,openEnd:o}=t;for(let c=a.length-2;c>=0;c-=2){let d=n.nodes[a[c]];if(!d||d.hasRequiredAttrs())break;i=ze.from(d.create(a[c+1],i)),l++,o++}return new ct(i,l,o)}const Al={},xi={};function Uc(t,s){t.input.lastSelectionOrigin=s,t.input.lastSelectionTime=Date.now()}xi.keydown=(t,s)=>{let n=s;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!BU(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(Qx&&Nd&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),f5&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let a=Date.now();t.input.lastIOSEnter=a,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==a&&(t.someProp("handleKeyDown",i=>i(t,jU(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",a=>a(t,n))||W1e(t,n)?n.preventDefault():Uc(t,"key")};xi.keyup=(t,s)=>{s.keyCode==16&&(t.input.shiftKey=!1)};xi.keypress=(t,s)=>{let n=s;if(BU(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||Ti&&n.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,n))){n.preventDefault();return}let a=t.state.selection;if(!(a instanceof kt)||!a.$from.sameParent(a.$to)){let i=String.fromCharCode(n.charCode),l=()=>t.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",o=>o(t,a.$from.pos,a.$to.pos,i,l))&&t.dispatch(l()),n.preventDefault()}};function Ov(t){return{left:t.clientX,top:t.clientY}}function Z1e(t,s){let n=s.x-t.clientX,a=s.y-t.clientY;return n*n+a*a<100}function g5(t,s,n,a,i){if(a==-1)return!1;let l=t.state.doc.resolve(a);for(let o=l.depth+1;o>0;o--)if(t.someProp(s,c=>o>l.depth?c(t,n,l.nodeAfter,l.before(o),i,!0):c(t,n,l.node(o),l.before(o),i,!1)))return!0;return!1}function Xh(t,s,n){if(t.focused||t.focus(),t.state.selection.eq(s))return;let a=t.state.tr.setSelection(s);a.setMeta("pointer",!0),t.dispatch(a)}function J1e(t,s){if(s==-1)return!1;let n=t.state.doc.resolve(s),a=n.nodeAfter;return a&&a.isAtom&&Pt.isSelectable(a)?(Xh(t,new Pt(n)),!0):!1}function ebe(t,s){if(s==-1)return!1;let n=t.state.selection,a,i;n instanceof Pt&&(a=n.node);let l=t.state.doc.resolve(s);for(let o=l.depth+1;o>0;o--){let c=o>l.depth?l.nodeAfter:l.node(o);if(Pt.isSelectable(c)){a&&n.$from.depth>0&&o>=n.$from.depth&&l.before(n.$from.depth+1)==n.$from.pos?i=l.before(n.$from.depth):i=l.before(o);break}}return i!=null?(Xh(t,Pt.create(t.state.doc,i)),!0):!1}function tbe(t,s,n,a,i){return g5(t,"handleClickOn",s,n,a)||t.someProp("handleClick",l=>l(t,s,a))||(i?ebe(t,n):J1e(t,n))}function sbe(t,s,n,a){return g5(t,"handleDoubleClickOn",s,n,a)||t.someProp("handleDoubleClick",i=>i(t,s,a))}function nbe(t,s,n,a){return g5(t,"handleTripleClickOn",s,n,a)||t.someProp("handleTripleClick",i=>i(t,s,a))||rbe(t,n,a)}function rbe(t,s,n){if(n.button!=0)return!1;let a=t.state.doc;if(s==-1)return a.inlineContent?(Xh(t,kt.create(a,0,a.content.size)),!0):!1;let i=a.resolve(s);for(let l=i.depth+1;l>0;l--){let o=l>i.depth?i.nodeAfter:i.node(l),c=i.before(l);if(o.inlineContent)Xh(t,kt.create(a,c+1,c+1+o.content.size));else if(Pt.isSelectable(o))Xh(t,Pt.create(a,c));else continue;return!0}}function y5(t){return C1(t)}const LU=Ti?"metaKey":"ctrlKey";Al.mousedown=(t,s)=>{let n=s;t.input.shiftKey=n.shiftKey;let a=y5(t),i=Date.now(),l="singleClick";i-t.input.lastClick.time<500&&Z1e(n,t.input.lastClick)&&!n[LU]&&t.input.lastClick.button==n.button&&(t.input.lastClick.type=="singleClick"?l="doubleClick":t.input.lastClick.type=="doubleClick"&&(l="tripleClick")),t.input.lastClick={time:i,x:n.clientX,y:n.clientY,type:l,button:n.button};let o=t.posAtCoords(Ov(n));o&&(l=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new abe(t,o,n,!!a)):(l=="doubleClick"?sbe:nbe)(t,o.pos,o.inside,n)?n.preventDefault():Uc(t,"pointer"))};class abe{constructor(s,n,a,i){this.view=s,this.pos=n,this.event=a,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=s.state.doc,this.selectNode=!!a[LU],this.allowDefault=a.shiftKey;let l,o;if(n.inside>-1)l=s.state.doc.nodeAt(n.inside),o=n.inside;else{let h=s.state.doc.resolve(n.pos);l=h.parent,o=h.depth?h.before():0}const c=i?null:a.target,d=c?s.docView.nearestDesc(c,!0):null;this.target=d&&d.nodeDOM.nodeType==1?d.nodeDOM:null;let{selection:u}=s.state;(a.button==0&&l.type.spec.draggable&&l.type.spec.selectable!==!1||u instanceof Pt&&u.from<=o&&u.to>o)&&(this.mightDrag={node:l,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Dv&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),s.root.addEventListener("mouseup",this.up=this.up.bind(this)),s.root.addEventListener("mousemove",this.move=this.move.bind(this)),Uc(s,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>x5(this.view)),this.view.input.mouseDown=null}up(s){if(this.done(),!this.view.dom.contains(s.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(Ov(s))),this.updateAllowDefault(s),this.allowDefault||!n?Uc(this.view,"pointer"):tbe(this.view,n.pos,n.inside,s,this.selectNode)?s.preventDefault():s.button==0&&(this.flushed||Ku&&this.mightDrag&&!this.mightDrag.node.isAtom||Nd&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(Xh(this.view,Bt.near(this.view.state.doc.resolve(n.pos))),s.preventDefault()):Uc(this.view,"pointer")}move(s){this.updateAllowDefault(s),Uc(this.view,"pointer"),s.buttons==0&&this.done()}updateAllowDefault(s){!this.allowDefault&&(Math.abs(this.event.x-s.clientX)>4||Math.abs(this.event.y-s.clientY)>4)&&(this.allowDefault=!0)}}Al.touchstart=t=>{t.input.lastTouch=Date.now(),y5(t),Uc(t,"pointer")};Al.touchmove=t=>{t.input.lastTouch=Date.now(),Uc(t,"pointer")};Al.contextmenu=t=>y5(t);function BU(t,s){return t.composing?!0:Ku&&Math.abs(s.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const ibe=Qx?5e3:-1;xi.compositionstart=xi.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:s}=t,n=s.selection.$to;if(s.selection instanceof kt&&(s.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(a=>a.type.spec.inclusive===!1)))t.markCursor=t.state.storedMarks||n.marks(),C1(t,!0),t.markCursor=null;else if(C1(t,!s.selection.empty),Dv&&s.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let a=t.domSelectionRange();for(let i=a.focusNode,l=a.focusOffset;i&&i.nodeType==1&&l!=0;){let o=l<0?i.lastChild:i.childNodes[l-1];if(!o)break;if(o.nodeType==3){let c=t.domSelection();c&&c.collapse(o,o.nodeValue.length);break}else i=o,l=-1}}t.input.composing=!0}FU(t,ibe)};xi.compositionend=(t,s)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=s.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,FU(t,20))};function FU(t,s){clearTimeout(t.input.composingTimeout),s>-1&&(t.input.composingTimeout=setTimeout(()=>C1(t),s))}function lbe(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=obe());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function obe(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function C1(t,s=!1){if(!(Qx&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),lbe(t),s||t.docView&&t.docView.dirty){let n=D1e(t),a=t.state.selection;return n&&!n.eq(a)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||s)&&!a.$from.node(a.$from.sharedDepth(a.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function cbe(t,s){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(s),n.style.cssText="position: fixed; left: -10000px; top: 10px";let a=getSelection(),i=document.createRange();i.selectNodeContents(s),t.dom.blur(),a.removeAllRanges(),a.addRange(i),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const dx=Xx&&SU<15||f5&&M1e<604;Al.copy=xi.cut=(t,s)=>{let n=s,a=t.state.selection,i=n.type=="cut";if(a.empty)return;let l=dx?null:n.clipboardData,o=a.content(),{dom:c,text:d}=TU(t,o);l?(n.preventDefault(),l.clearData(),l.setData("text/html",c.innerHTML),l.setData("text/plain",d)):cbe(t,c),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function dbe(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function ube(t,s){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,a=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(a.contentEditable="true"),a.style.cssText="position: fixed; left: -10000px; top: 10px",a.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),a.parentNode&&a.parentNode.removeChild(a),n?TS(t,a.value,null,i,s):TS(t,a.textContent,a.innerHTML,i,s)},50)}function TS(t,s,n,a,i){let l=PU(t,s,n,a,t.state.selection.$from);if(t.someProp("handlePaste",d=>d(t,i,l||ct.empty)))return!0;if(!l)return!1;let o=dbe(l),c=o?t.state.tr.replaceSelectionWith(o,a):t.state.tr.replaceSelection(l);return t.dispatch(c.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function $U(t){let s=t.getData("text/plain")||t.getData("Text");if(s)return s;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}xi.paste=(t,s)=>{let n=s;if(t.composing&&!Qx)return;let a=dx?null:n.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;a&&TS(t,$U(a),a.getData("text/html"),i,n)?n.preventDefault():ube(t,n)};class hbe{constructor(s,n,a){this.slice=s,this.move=n,this.node=a}}const mbe=Ti?"altKey":"ctrlKey";function zU(t,s){let n=t.someProp("dragCopies",a=>!a(s));return n??!s[mbe]}Al.dragstart=(t,s)=>{let n=s,a=t.input.mouseDown;if(a&&a.done(),!n.dataTransfer)return;let i=t.state.selection,l=i.empty?null:t.posAtCoords(Ov(n)),o;if(!(l&&l.pos>=i.from&&l.pos<=(i instanceof Pt?i.to-1:i.to))){if(a&&a.mightDrag)o=Pt.create(t.state.doc,a.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let f=t.docView.nearestDesc(n.target,!0);f&&f.node.type.spec.draggable&&f!=t.docView&&(o=Pt.create(t.state.doc,f.posBefore))}}let c=(o||t.state.selection).content(),{dom:d,text:u,slice:h}=TU(t,c);(!n.dataTransfer.files.length||!Nd||CU>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(dx?"Text":"text/html",d.innerHTML),n.dataTransfer.effectAllowed="copyMove",dx||n.dataTransfer.setData("text/plain",u),t.dragging=new hbe(h,zU(t,n),o)};Al.dragend=t=>{let s=t.dragging;window.setTimeout(()=>{t.dragging==s&&(t.dragging=null)},50)};xi.dragover=xi.dragenter=(t,s)=>s.preventDefault();xi.drop=(t,s)=>{let n=s,a=t.dragging;if(t.dragging=null,!n.dataTransfer)return;let i=t.posAtCoords(Ov(n));if(!i)return;let l=t.state.doc.resolve(i.pos),o=a&&a.slice;o?t.someProp("transformPasted",v=>{o=v(o,t,!1)}):o=PU(t,$U(n.dataTransfer),dx?null:n.dataTransfer.getData("text/html"),!1,l);let c=!!(a&&zU(t,n));if(t.someProp("handleDrop",v=>v(t,n,o||ct.empty,c))){n.preventDefault();return}if(!o)return;n.preventDefault();let d=o?Kz(t.state.doc,l.pos,o):l.pos;d==null&&(d=l.pos);let u=t.state.tr;if(c){let{node:v}=a;v?v.replace(u):u.deleteSelection()}let h=u.mapping.map(d),f=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,x=u.doc;if(f?u.replaceRangeWith(h,h,o.content.firstChild):u.replaceRange(h,h,o),u.doc.eq(x))return;let b=u.doc.resolve(h);if(f&&Pt.isSelectable(o.content.firstChild)&&b.nodeAfter&&b.nodeAfter.sameMarkup(o.content.firstChild))u.setSelection(new Pt(b));else{let v=u.mapping.map(d);u.mapping.maps[u.mapping.maps.length-1].forEach((w,_,S,k)=>v=k),u.setSelection(AU(t,b,u.doc.resolve(v)))}t.focus(),t.dispatch(u.setMeta("uiEvent","drop"))};Al.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&x5(t)},20))};Al.blur=(t,s)=>{let n=s;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};Al.beforeinput=(t,s)=>{if(Nd&&Qx&&s.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:a}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=a||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",l=>l(t,jU(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in xi)Al[t]=xi[t];function ux(t,s){if(t==s)return!0;for(let n in t)if(t[n]!==s[n])return!1;for(let n in s)if(!(n in t))return!1;return!0}class k1{constructor(s,n){this.toDOM=s,this.spec=n||uu,this.side=this.spec.side||0}map(s,n,a,i){let{pos:l,deleted:o}=s.mapResult(n.from+i,this.side<0?-1:1);return o?null:new di(l-a,l-a,this)}valid(){return!0}eq(s){return this==s||s instanceof k1&&(this.spec.key&&this.spec.key==s.spec.key||this.toDOM==s.toDOM&&ux(this.spec,s.spec))}destroy(s){this.spec.destroy&&this.spec.destroy(s)}}class ed{constructor(s,n){this.attrs=s,this.spec=n||uu}map(s,n,a,i){let l=s.map(n.from+i,this.spec.inclusiveStart?-1:1)-a,o=s.map(n.to+i,this.spec.inclusiveEnd?1:-1)-a;return l>=o?null:new di(l,o,this)}valid(s,n){return n.from<n.to}eq(s){return this==s||s instanceof ed&&ux(this.attrs,s.attrs)&&ux(this.spec,s.spec)}static is(s){return s.type instanceof ed}destroy(){}}class b5{constructor(s,n){this.attrs=s,this.spec=n||uu}map(s,n,a,i){let l=s.mapResult(n.from+i,1);if(l.deleted)return null;let o=s.mapResult(n.to+i,-1);return o.deleted||o.pos<=l.pos?null:new di(l.pos-a,o.pos-a,this)}valid(s,n){let{index:a,offset:i}=s.content.findIndex(n.from),l;return i==n.from&&!(l=s.child(a)).isText&&i+l.nodeSize==n.to}eq(s){return this==s||s instanceof b5&&ux(this.attrs,s.attrs)&&ux(this.spec,s.spec)}destroy(){}}class di{constructor(s,n,a){this.from=s,this.to=n,this.type=a}copy(s,n){return new di(s,n,this.type)}eq(s,n=0){return this.type.eq(s.type)&&this.from+n==s.from&&this.to+n==s.to}map(s,n,a){return this.type.map(s,this,n,a)}static widget(s,n,a){return new di(s,s,new k1(n,a))}static inline(s,n,a,i){return new di(s,n,new ed(a,i))}static node(s,n,a,i){return new di(s,n,new b5(a,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof ed}get widget(){return this.type instanceof k1}}const gh=[],uu={};class In{constructor(s,n){this.local=s.length?s:gh,this.children=n.length?n:gh}static create(s,n){return n.length?A1(n,s,0,uu):la}find(s,n,a){let i=[];return this.findInner(s??0,n??1e9,i,0,a),i}findInner(s,n,a,i,l){for(let o=0;o<this.local.length;o++){let c=this.local[o];c.from<=n&&c.to>=s&&(!l||l(c.spec))&&a.push(c.copy(c.from+i,c.to+i))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<n&&this.children[o+1]>s){let c=this.children[o]+1;this.children[o+2].findInner(s-c,n-c,a,i+c,l)}}map(s,n,a){return this==la||s.maps.length==0?this:this.mapInner(s,n,0,0,a||uu)}mapInner(s,n,a,i,l){let o;for(let c=0;c<this.local.length;c++){let d=this.local[c].map(s,a,i);d&&d.type.valid(n,d)?(o||(o=[])).push(d):l.onRemove&&l.onRemove(this.local[c].spec)}return this.children.length?fbe(this.children,o||[],s,n,a,i,l):o?new In(o.sort(hu),gh):la}add(s,n){return n.length?this==la?In.create(s,n):this.addInner(s,n,0):this}addInner(s,n,a){let i,l=0;s.forEach((c,d)=>{let u=d+a,h;if(h=VU(n,c,u)){for(i||(i=this.children.slice());l<i.length&&i[l]<d;)l+=3;i[l]==d?i[l+2]=i[l+2].addInner(c,h,u+1):i.splice(l,0,d,d+c.nodeSize,A1(h,c,u+1,uu)),l+=3}});let o=UU(l?HU(n):n,-a);for(let c=0;c<o.length;c++)o[c].type.valid(s,o[c])||o.splice(c--,1);return new In(o.length?this.local.concat(o).sort(hu):this.local,i||this.children)}remove(s){return s.length==0||this==la?this:this.removeInner(s,0)}removeInner(s,n){let a=this.children,i=this.local;for(let l=0;l<a.length;l+=3){let o,c=a[l]+n,d=a[l+1]+n;for(let h=0,f;h<s.length;h++)(f=s[h])&&f.from>c&&f.to<d&&(s[h]=null,(o||(o=[])).push(f));if(!o)continue;a==this.children&&(a=this.children.slice());let u=a[l+2].removeInner(o,c+1);u!=la?a[l+2]=u:(a.splice(l,3),l-=3)}if(i.length){for(let l=0,o;l<s.length;l++)if(o=s[l])for(let c=0;c<i.length;c++)i[c].eq(o,n)&&(i==this.local&&(i=this.local.slice()),i.splice(c--,1))}return a==this.children&&i==this.local?this:i.length||a.length?new In(i,a):la}forChild(s,n){if(this==la)return this;if(n.isLeaf)return In.empty;let a,i;for(let c=0;c<this.children.length;c+=3)if(this.children[c]>=s){this.children[c]==s&&(a=this.children[c+2]);break}let l=s+1,o=l+n.content.size;for(let c=0;c<this.local.length;c++){let d=this.local[c];if(d.from<o&&d.to>l&&d.type instanceof ed){let u=Math.max(l,d.from)-l,h=Math.min(o,d.to)-l;u<h&&(i||(i=[])).push(d.copy(u,h))}}if(i){let c=new In(i.sort(hu),gh);return a?new Hd([c,a]):c}return a||la}eq(s){if(this==s)return!0;if(!(s instanceof In)||this.local.length!=s.local.length||this.children.length!=s.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(s.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=s.children[n]||this.children[n+1]!=s.children[n+1]||!this.children[n+2].eq(s.children[n+2]))return!1;return!0}locals(s){return v5(this.localsInner(s))}localsInner(s){if(this==la)return gh;if(s.inlineContent||!this.local.some(ed.is))return this.local;let n=[];for(let a=0;a<this.local.length;a++)this.local[a].type instanceof ed||n.push(this.local[a]);return n}forEachSet(s){s(this)}}In.empty=new In([],[]);In.removeOverlap=v5;const la=In.empty;class Hd{constructor(s){this.members=s}map(s,n){const a=this.members.map(i=>i.map(s,n,uu));return Hd.from(a)}forChild(s,n){if(n.isLeaf)return In.empty;let a=[];for(let i=0;i<this.members.length;i++){let l=this.members[i].forChild(s,n);l!=la&&(l instanceof Hd?a=a.concat(l.members):a.push(l))}return Hd.from(a)}eq(s){if(!(s instanceof Hd)||s.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(s.members[n]))return!1;return!0}locals(s){let n,a=!0;for(let i=0;i<this.members.length;i++){let l=this.members[i].localsInner(s);if(l.length)if(!n)n=l;else{a&&(n=n.slice(),a=!1);for(let o=0;o<l.length;o++)n.push(l[o])}}return n?v5(a?n:n.sort(hu)):gh}static from(s){switch(s.length){case 0:return la;case 1:return s[0];default:return new Hd(s.every(n=>n instanceof In)?s:s.reduce((n,a)=>n.concat(a instanceof In?a:a.members),[]))}}forEachSet(s){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(s)}}function fbe(t,s,n,a,i,l,o){let c=t.slice();for(let u=0,h=l;u<n.maps.length;u++){let f=0;n.maps[u].forEach((x,b,v,w)=>{let _=w-v-(b-x);for(let S=0;S<c.length;S+=3){let k=c[S+1];if(k<0||x>k+h-f)continue;let A=c[S]+h-f;b>=A?c[S+1]=x<=A?-2:-1:x>=h&&_&&(c[S]+=_,c[S+1]+=_)}f+=_}),h=n.maps[u].map(h,-1)}let d=!1;for(let u=0;u<c.length;u+=3)if(c[u+1]<0){if(c[u+1]==-2){d=!0,c[u+1]=-1;continue}let h=n.map(t[u]+l),f=h-i;if(f<0||f>=a.content.size){d=!0;continue}let x=n.map(t[u+1]+l,-1),b=x-i,{index:v,offset:w}=a.content.findIndex(f),_=a.maybeChild(v);if(_&&w==f&&w+_.nodeSize==b){let S=c[u+2].mapInner(n,_,h+1,t[u]+l+1,o);S!=la?(c[u]=f,c[u+1]=b,c[u+2]=S):(c[u+1]=-2,d=!0)}else d=!0}if(d){let u=pbe(c,t,s,n,i,l,o),h=A1(u,a,0,o);s=h.local;for(let f=0;f<c.length;f+=3)c[f+1]<0&&(c.splice(f,3),f-=3);for(let f=0,x=0;f<h.children.length;f+=3){let b=h.children[f];for(;x<c.length&&c[x]<b;)x+=3;c.splice(x,0,h.children[f],h.children[f+1],h.children[f+2])}}return new In(s.sort(hu),c)}function UU(t,s){if(!s||!t.length)return t;let n=[];for(let a=0;a<t.length;a++){let i=t[a];n.push(new di(i.from+s,i.to+s,i.type))}return n}function pbe(t,s,n,a,i,l,o){function c(d,u){for(let h=0;h<d.local.length;h++){let f=d.local[h].map(a,i,u);f?n.push(f):o.onRemove&&o.onRemove(d.local[h].spec)}for(let h=0;h<d.children.length;h+=3)c(d.children[h+2],d.children[h]+u+1)}for(let d=0;d<t.length;d+=3)t[d+1]==-1&&c(t[d+2],s[d]+l+1);return n}function VU(t,s,n){if(s.isLeaf)return null;let a=n+s.nodeSize,i=null;for(let l=0,o;l<t.length;l++)(o=t[l])&&o.from>n&&o.to<a&&((i||(i=[])).push(o),t[l]=null);return i}function HU(t){let s=[];for(let n=0;n<t.length;n++)t[n]!=null&&s.push(t[n]);return s}function A1(t,s,n,a){let i=[],l=!1;s.forEach((c,d)=>{let u=VU(t,c,d+n);if(u){l=!0;let h=A1(u,c,n+d+1,a);h!=la&&i.push(d,d+c.nodeSize,h)}});let o=UU(l?HU(t):t,-n).sort(hu);for(let c=0;c<o.length;c++)o[c].type.valid(s,o[c])||(a.onRemove&&a.onRemove(o[c].spec),o.splice(c--,1));return o.length||i.length?new In(o,i):la}function hu(t,s){return t.from-s.from||t.to-s.to}function v5(t){let s=t;for(let n=0;n<s.length-1;n++){let a=s[n];if(a.from!=a.to)for(let i=n+1;i<s.length;i++){let l=s[i];if(l.from==a.from){l.to!=a.to&&(s==t&&(s=t.slice()),s[i]=l.copy(l.from,a.to),NM(s,i+1,l.copy(a.to,l.to)));continue}else{l.from<a.to&&(s==t&&(s=t.slice()),s[n]=a.copy(a.from,l.from),NM(s,i,a.copy(l.from,a.to)));break}}}return s}function NM(t,s,n){for(;s<t.length&&hu(n,t[s])>0;)s++;t.splice(s,0,n)}var od={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},E1={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},xbe=typeof navigator<"u"&&/Mac/.test(navigator.platform),gbe=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Rr=0;Rr<10;Rr++)od[48+Rr]=od[96+Rr]=String(Rr);for(var Rr=1;Rr<=24;Rr++)od[Rr+111]="F"+Rr;for(var Rr=65;Rr<=90;Rr++)od[Rr]=String.fromCharCode(Rr+32),E1[Rr]=String.fromCharCode(Rr);for(var Cj in od)E1.hasOwnProperty(Cj)||(E1[Cj]=od[Cj]);function ybe(t){var s=xbe&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||gbe&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!s&&t.key||(t.shiftKey?E1:od)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const bbe=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),vbe=typeof navigator<"u"&&/Win/.test(navigator.platform);function Nbe(t){let s=t.split(/-(?!$)/),n=s[s.length-1];n=="Space"&&(n=" ");let a,i,l,o;for(let c=0;c<s.length-1;c++){let d=s[c];if(/^(cmd|meta|m)$/i.test(d))o=!0;else if(/^a(lt)?$/i.test(d))a=!0;else if(/^(c|ctrl|control)$/i.test(d))i=!0;else if(/^s(hift)?$/i.test(d))l=!0;else if(/^mod$/i.test(d))bbe?o=!0:i=!0;else throw new Error("Unrecognized modifier name: "+d)}return a&&(n="Alt-"+n),i&&(n="Ctrl-"+n),o&&(n="Meta-"+n),l&&(n="Shift-"+n),n}function wbe(t){let s=Object.create(null);for(let n in t)s[Nbe(n)]=t[n];return s}function kj(t,s,n=!0){return s.altKey&&(t="Alt-"+t),s.ctrlKey&&(t="Ctrl-"+t),s.metaKey&&(t="Meta-"+t),n&&s.shiftKey&&(t="Shift-"+t),t}function WU(t){let s=wbe(t);return function(n,a){let i=ybe(a),l,o=s[kj(i,a)];if(o&&o(n.state,n.dispatch,n))return!0;if(i.length==1&&i!=" "){if(a.shiftKey){let c=s[kj(i,a,!1)];if(c&&c(n.state,n.dispatch,n))return!0}if((a.altKey||a.metaKey||a.ctrlKey)&&!(vbe&&a.ctrlKey&&a.altKey)&&(l=od[a.keyCode])&&l!=i){let c=s[kj(l,a)];if(c&&c(n.state,n.dispatch,n))return!0}}return!1}}var jbe=Object.defineProperty,N5=(t,s)=>{for(var n in s)jbe(t,n,{get:s[n],enumerable:!0})};function qU(t){const{state:s,transaction:n}=t;let{selection:a}=n,{doc:i}=n,{storedMarks:l}=n;return{...s,apply:s.apply.bind(s),applyTransaction:s.applyTransaction.bind(s),plugins:s.plugins,schema:s.schema,reconfigure:s.reconfigure.bind(s),toJSON:s.toJSON.bind(s),get storedMarks(){return l},get selection(){return a},get doc(){return i},get tr(){return a=n.selection,i=n.doc,l=n.storedMarks,n}}}var _be=class{constructor(s){this.editor=s.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=s.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:s,editor:n,state:a}=this,{view:i}=n,{tr:l}=a,o=this.buildProps(l);return Object.fromEntries(Object.entries(s).map(([c,d])=>[c,(...h)=>{const f=d(...h)(o);return!l.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(l),f}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(s,n=!0){const{rawCommands:a,editor:i,state:l}=this,{view:o}=i,c=[],d=!!s,u=s||l.tr,h=()=>(!d&&n&&!u.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(u),c.every(x=>x===!0)),f={...Object.fromEntries(Object.entries(a).map(([x,b])=>[x,(...w)=>{const _=this.buildProps(u,n),S=b(...w)(_);return c.push(S),f}])),run:h};return f}createCan(s){const{rawCommands:n,state:a}=this,i=!1,l=s||a.tr,o=this.buildProps(l,i);return{...Object.fromEntries(Object.entries(n).map(([d,u])=>[d,(...h)=>u(...h)({...o,dispatch:void 0})])),chain:()=>this.createChain(l,i)}}buildProps(s,n=!0){const{rawCommands:a,editor:i,state:l}=this,{view:o}=i,c={tr:s,editor:i,view:o,state:qU({state:l,transaction:s}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(s,n),can:()=>this.createCan(s),get commands(){return Object.fromEntries(Object.entries(a).map(([d,u])=>[d,(...h)=>u(...h)(c)]))}};return c}},GU={};N5(GU,{blur:()=>Sbe,clearContent:()=>Cbe,clearNodes:()=>kbe,command:()=>Abe,createParagraphNear:()=>Ebe,cut:()=>Tbe,deleteCurrentNode:()=>Pbe,deleteNode:()=>Ibe,deleteRange:()=>Mbe,deleteSelection:()=>Dbe,enter:()=>Obe,exitCode:()=>Rbe,extendMarkRange:()=>Bbe,first:()=>Fbe,focus:()=>Ube,forEach:()=>Vbe,insertContent:()=>Hbe,insertContentAt:()=>Gbe,joinBackward:()=>Xbe,joinDown:()=>Ybe,joinForward:()=>Qbe,joinItemBackward:()=>Zbe,joinItemForward:()=>Jbe,joinTextblockBackward:()=>eve,joinTextblockForward:()=>tve,joinUp:()=>Kbe,keyboardShortcut:()=>nve,lift:()=>rve,liftEmptyBlock:()=>ave,liftListItem:()=>ive,newlineInCode:()=>lve,resetAttributes:()=>ove,scrollIntoView:()=>cve,selectAll:()=>dve,selectNodeBackward:()=>uve,selectNodeForward:()=>hve,selectParentNode:()=>mve,selectTextblockEnd:()=>fve,selectTextblockStart:()=>pve,setContent:()=>gve,setMark:()=>Eve,setMeta:()=>Tve,setNode:()=>Pve,setNodeSelection:()=>Ive,setTextDirection:()=>Mve,setTextSelection:()=>Dve,sinkListItem:()=>Ove,splitBlock:()=>Rve,splitListItem:()=>Lve,toggleList:()=>Bve,toggleMark:()=>Fve,toggleNode:()=>$ve,toggleWrap:()=>zve,undoInputRule:()=>Uve,unsetAllMarks:()=>Vve,unsetMark:()=>Hve,unsetTextDirection:()=>Wve,updateAttributes:()=>qve,wrapIn:()=>Gve,wrapInList:()=>Kve});var Sbe=()=>({editor:t,view:s})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(s.dom.blur(),(n=window==null?void 0:window.getSelection())==null||n.removeAllRanges())}),!0),Cbe=(t=!0)=>({commands:s})=>s.setContent("",{emitUpdate:t}),kbe=()=>({state:t,tr:s,dispatch:n})=>{const{selection:a}=s,{ranges:i}=a;return n&&i.forEach(({$from:l,$to:o})=>{t.doc.nodesBetween(l.pos,o.pos,(c,d)=>{if(c.type.isText)return;const{doc:u,mapping:h}=s,f=u.resolve(h.map(d)),x=u.resolve(h.map(d+c.nodeSize)),b=f.blockRange(x);if(!b)return;const v=qu(b);if(c.type.isTextblock){const{defaultType:w}=f.parent.contentMatchAt(f.index());s.setNodeMarkup(b.start,w)}(v||v===0)&&s.lift(b,v)})}),!0},Abe=t=>s=>t(s),Ebe=()=>({state:t,dispatch:s})=>d5(t,s),Tbe=(t,s)=>({editor:n,tr:a})=>{const{state:i}=n,l=i.doc.slice(t.from,t.to);a.deleteRange(t.from,t.to);const o=a.mapping.map(s);return a.insert(o,l.content),a.setSelection(new kt(a.doc.resolve(Math.max(o-1,0)))),!0},Pbe=()=>({tr:t,dispatch:s})=>{const{selection:n}=t,a=n.$anchor.node();if(a.content.size>0)return!1;const i=t.selection.$anchor;for(let l=i.depth;l>0;l-=1)if(i.node(l).type===a.type){if(s){const c=i.before(l),d=i.after(l);t.delete(c,d).scrollIntoView()}return!0}return!1};function Jr(t,s){if(typeof t=="string"){if(!s.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return s.nodes[t]}return t}var Ibe=t=>({tr:s,state:n,dispatch:a})=>{const i=Jr(t,n.schema),l=s.selection.$anchor;for(let o=l.depth;o>0;o-=1)if(l.node(o).type===i){if(a){const d=l.before(o),u=l.after(o);s.delete(d,u).scrollIntoView()}return!0}return!1},Mbe=t=>({tr:s,dispatch:n})=>{const{from:a,to:i}=t;return n&&s.delete(a,i),!0},Dbe=()=>({state:t,dispatch:s})=>Mv(t,s),Obe=()=>({commands:t})=>t.keyboardShortcut("Enter"),Rbe=()=>({state:t,dispatch:s})=>uU(t,s);function Lbe(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function T1(t,s,n={strict:!0}){const a=Object.keys(s);return a.length?a.every(i=>n.strict?s[i]===t[i]:Lbe(s[i])?s[i].test(t[i]):s[i]===t[i]):!0}function KU(t,s,n={}){return t.find(a=>a.type===s&&T1(Object.fromEntries(Object.keys(n).map(i=>[i,a.attrs[i]])),n))}function wM(t,s,n={}){return!!KU(t,s,n)}function w5(t,s,n){var a;if(!t||!s)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(h=>h.type===s))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(h=>h.type===s)||(n=n||((a=i.node.marks[0])==null?void 0:a.attrs),!KU([...i.node.marks],s,n)))return;let o=i.index,c=t.start()+i.offset,d=o+1,u=c+i.node.nodeSize;for(;o>0&&wM([...t.parent.child(o-1).marks],s,n);)o-=1,c-=t.parent.child(o).nodeSize;for(;d<t.parent.childCount&&wM([...t.parent.child(d).marks],s,n);)u+=t.parent.child(d).nodeSize,d+=1;return{from:c,to:u}}function wd(t,s){if(typeof t=="string"){if(!s.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return s.marks[t]}return t}var Bbe=(t,s={})=>({tr:n,state:a,dispatch:i})=>{const l=wd(t,a.schema),{doc:o,selection:c}=n,{$from:d,from:u,to:h}=c;if(i){const f=w5(d,l,s);if(f&&f.from<=u&&f.to>=h){const x=kt.create(o,f.from,f.to);n.setSelection(x)}}return!0},Fbe=t=>s=>{const n=typeof t=="function"?t(s):t;for(let a=0;a<n.length;a+=1)if(n[a](s))return!0;return!1};function YU(t){return t instanceof kt}function Zd(t=0,s=0,n=0){return Math.min(Math.max(t,s),n)}function $be(t,s=null){if(!s)return null;const n=Bt.atStart(t),a=Bt.atEnd(t);if(s==="start"||s===!0)return n;if(s==="end")return a;const i=n.from,l=a.to;return s==="all"?kt.create(t,Zd(0,i,l),Zd(t.content.size,i,l)):kt.create(t,Zd(s,i,l),Zd(s,i,l))}function zbe(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function j5(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var Ube=(t=null,s={})=>({editor:n,view:a,tr:i,dispatch:l})=>{s={scrollIntoView:!0,...s};const o=()=>{(j5()||zbe())&&a.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(a.focus(),s!=null&&s.scrollIntoView&&n.commands.scrollIntoView())})};if(a.hasFocus()&&t===null||t===!1)return!0;if(l&&t===null&&!YU(n.state.selection))return o(),!0;const c=$be(i.doc,t)||n.state.selection,d=n.state.selection.eq(c);return l&&(d||i.setSelection(c),d&&i.storedMarks&&i.setStoredMarks(i.storedMarks),o()),!0},Vbe=(t,s)=>n=>t.every((a,i)=>s(a,{...n,index:i})),Hbe=(t,s)=>({tr:n,commands:a})=>a.insertContentAt({from:n.selection.from,to:n.selection.to},t,s),XU=t=>{const s=t.childNodes;for(let n=s.length-1;n>=0;n-=1){const a=s[n];a.nodeType===3&&a.nodeValue&&/^(\n\s\s|\n)$/.test(a.nodeValue)?t.removeChild(a):a.nodeType===1&&XU(a)}return t};function hg(t){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const s=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(s,"text/html").body;return XU(n)}function hx(t,s,n){if(t instanceof Jc||t instanceof ze)return t;n={slice:!0,parseOptions:{},...n};const a=typeof t=="object"&&t!==null,i=typeof t=="string";if(a)try{if(Array.isArray(t)&&t.length>0)return ze.fromArray(t.map(c=>s.nodeFromJSON(c)));const o=s.nodeFromJSON(t);return n.errorOnInvalidContent&&o.check(),o}catch(l){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:l});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",l),hx("",s,n)}if(i){if(n.errorOnInvalidContent){let o=!1,c="";const d=new Lz({topNode:s.spec.topNode,marks:s.spec.marks,nodes:s.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(o=!0,c=typeof u=="string"?u:u.outerHTML,null)}]}})});if(n.slice?ao.fromSchema(d).parseSlice(hg(t),n.parseOptions):ao.fromSchema(d).parse(hg(t),n.parseOptions),n.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${c}`)})}const l=ao.fromSchema(s);return n.slice?l.parseSlice(hg(t),n.parseOptions).content:l.parse(hg(t),n.parseOptions)}return hx("",s,n)}function Wbe(t,s,n){const a=t.steps.length-1;if(a<s)return;const i=t.steps[a];if(!(i instanceof nr||i instanceof ur))return;const l=t.mapping.maps[a];let o=0;l.forEach((c,d,u,h)=>{o===0&&(o=h)}),t.setSelection(Bt.near(t.doc.resolve(o),n))}var qbe=t=>!("type"in t),Gbe=(t,s,n)=>({tr:a,dispatch:i,editor:l})=>{var o;if(i){n={parseOptions:l.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let c;const d=_=>{l.emit("contentError",{editor:l,error:_,disableCollaboration:()=>{"collaboration"in l.storage&&typeof l.storage.collaboration=="object"&&l.storage.collaboration&&(l.storage.collaboration.isDisabled=!0)}})},u={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!l.options.enableContentCheck&&l.options.emitContentError)try{hx(s,l.schema,{parseOptions:u,errorOnInvalidContent:!0})}catch(_){d(_)}try{c=hx(s,l.schema,{parseOptions:u,errorOnInvalidContent:(o=n.errorOnInvalidContent)!=null?o:l.options.enableContentCheck})}catch(_){return d(_),!1}let{from:h,to:f}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},x=!0,b=!0;if((qbe(c)?c:[c]).forEach(_=>{_.check(),x=x?_.isText&&_.marks.length===0:!1,b=b?_.isBlock:!1}),h===f&&b){const{parent:_}=a.doc.resolve(h);_.isTextblock&&!_.type.spec.code&&!_.childCount&&(h-=1,f+=1)}let w;if(x){if(Array.isArray(s))w=s.map(_=>_.text||"").join("");else if(s instanceof ze){let _="";s.forEach(S=>{S.text&&(_+=S.text)}),w=_}else typeof s=="object"&&s&&s.text?w=s.text:w=s;a.insertText(w,h,f)}else{w=c;const _=a.doc.resolve(h),S=_.node(),k=_.parentOffset===0,A=S.isText||S.isTextblock,T=S.content.size>0;k&&A&&T&&(h=Math.max(0,h-1)),a.replaceWith(h,f,w)}n.updateSelection&&Wbe(a,a.steps.length-1,-1),n.applyInputRules&&a.setMeta("applyInputRules",{from:h,text:w}),n.applyPasteRules&&a.setMeta("applyPasteRules",{from:h,text:w})}return!0},Kbe=()=>({state:t,dispatch:s})=>oU(t,s),Ybe=()=>({state:t,dispatch:s})=>cU(t,s),Xbe=()=>({state:t,dispatch:s})=>s5(t,s),Qbe=()=>({state:t,dispatch:s})=>a5(t,s),Zbe=()=>({state:t,dispatch:s,tr:n})=>{try{const a=Km(t.doc,t.selection.$from.pos,-1);return a==null?!1:(n.join(a,2),s&&s(n),!0)}catch{return!1}},Jbe=()=>({state:t,dispatch:s,tr:n})=>{try{const a=Km(t.doc,t.selection.$from.pos,1);return a==null?!1:(n.join(a,2),s&&s(n),!0)}catch{return!1}},eve=()=>({state:t,dispatch:s})=>rU(t,s),tve=()=>({state:t,dispatch:s})=>aU(t,s);function QU(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function sve(t){const s=t.split(/-(?!$)/);let n=s[s.length-1];n==="Space"&&(n=" ");let a,i,l,o;for(let c=0;c<s.length-1;c+=1){const d=s[c];if(/^(cmd|meta|m)$/i.test(d))o=!0;else if(/^a(lt)?$/i.test(d))a=!0;else if(/^(c|ctrl|control)$/i.test(d))i=!0;else if(/^s(hift)?$/i.test(d))l=!0;else if(/^mod$/i.test(d))j5()||QU()?o=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${d}`)}return a&&(n=`Alt-${n}`),i&&(n=`Ctrl-${n}`),o&&(n=`Meta-${n}`),l&&(n=`Shift-${n}`),n}var nve=t=>({editor:s,view:n,tr:a,dispatch:i})=>{const l=sve(t).split(/-(?!$)/),o=l.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),c=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:l.includes("Alt"),ctrlKey:l.includes("Ctrl"),metaKey:l.includes("Meta"),shiftKey:l.includes("Shift"),bubbles:!0,cancelable:!0}),d=s.captureTransaction(()=>{n.someProp("handleKeyDown",u=>u(n,c))});return d==null||d.steps.forEach(u=>{const h=u.map(a.mapping);h&&i&&a.maybeStep(h)}),!0};function _5(t,s,n={}){const{from:a,to:i,empty:l}=t.selection,o=s?Jr(s,t.schema):null,c=[];t.doc.nodesBetween(a,i,(f,x)=>{if(f.isText)return;const b=Math.max(a,x),v=Math.min(i,x+f.nodeSize);c.push({node:f,from:b,to:v})});const d=i-a,u=c.filter(f=>o?o.name===f.node.type.name:!0).filter(f=>T1(f.node.attrs,n,{strict:!1}));return l?!!u.length:u.reduce((f,x)=>f+x.to-x.from,0)>=d}var rve=(t,s={})=>({state:n,dispatch:a})=>{const i=Jr(t,n.schema);return _5(n,i,s)?dU(n,a):!1},ave=()=>({state:t,dispatch:s})=>u5(t,s),ive=t=>({state:s,dispatch:n})=>{const a=Jr(t,s.schema);return bU(a)(s,n)},lve=()=>({state:t,dispatch:s})=>o5(t,s);function ZU(t,s){return s.nodes[t]?"node":s.marks[t]?"mark":null}function jM(t,s){const n=typeof s=="string"?[s]:s;return Object.keys(t).reduce((a,i)=>(n.includes(i)||(a[i]=t[i]),a),{})}var ove=(t,s)=>({tr:n,state:a,dispatch:i})=>{let l=null,o=null;const c=ZU(typeof t=="string"?t:t.name,a.schema);if(!c)return!1;c==="node"&&(l=Jr(t,a.schema)),c==="mark"&&(o=wd(t,a.schema));let d=!1;return n.selection.ranges.forEach(u=>{a.doc.nodesBetween(u.$from.pos,u.$to.pos,(h,f)=>{l&&l===h.type&&(d=!0,i&&n.setNodeMarkup(f,void 0,jM(h.attrs,s))),o&&h.marks.length&&h.marks.forEach(x=>{o===x.type&&(d=!0,i&&n.addMark(f,f+h.nodeSize,o.create(jM(x.attrs,s))))})})}),d},cve=()=>({tr:t,dispatch:s})=>(s&&t.scrollIntoView(),!0),dve=()=>({tr:t,dispatch:s})=>{if(s){const n=new La(t.doc);t.setSelection(n)}return!0},uve=()=>({state:t,dispatch:s})=>n5(t,s),hve=()=>({state:t,dispatch:s})=>i5(t,s),mve=()=>({state:t,dispatch:s})=>hU(t,s),fve=()=>({state:t,dispatch:s})=>xU(t,s),pve=()=>({state:t,dispatch:s})=>pU(t,s);function xve(t,s,n={},a={}){return hx(t,s,{slice:!1,parseOptions:n,errorOnInvalidContent:a.errorOnInvalidContent})}var gve=(t,{errorOnInvalidContent:s,emitUpdate:n=!0,parseOptions:a={}}={})=>({editor:i,tr:l,dispatch:o,commands:c})=>{const{doc:d}=l;if(a.preserveWhitespace!=="full"){const u=xve(t,i.schema,a,{errorOnInvalidContent:s??i.options.enableContentCheck});return o&&l.replaceWith(0,d.content.size,u).setMeta("preventUpdate",!n),!0}return o&&l.setMeta("preventUpdate",!n),c.insertContentAt({from:0,to:d.content.size},t,{parseOptions:a,errorOnInvalidContent:s??i.options.enableContentCheck})};function yve(t,s){const n=wd(s,t.schema),{from:a,to:i,empty:l}=t.selection,o=[];l?(t.storedMarks&&o.push(...t.storedMarks),o.push(...t.selection.$head.marks())):t.doc.nodesBetween(a,i,d=>{o.push(...d.marks)});const c=o.find(d=>d.type.name===n.name);return c?{...c.attrs}:{}}function bve(t,s){const n=new Jz(t);return s.forEach(a=>{a.steps.forEach(i=>{n.step(i)})}),n}function vve(t){for(let s=0;s<t.edgeCount;s+=1){const{type:n}=t.edge(s);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function JU(t,s){for(let n=t.depth;n>0;n-=1){const a=t.node(n);if(s(a))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:a}}}function S5(t){return s=>JU(s.$from,t)}function ym(t,s,n){return t.config[s]===void 0&&t.parent?ym(t.parent,s,n):typeof t.config[s]=="function"?t.config[s].bind({...n,parent:t.parent?ym(t.parent,s,n):null}):t.config[s]}function Nve(t){return typeof t=="function"}function Pu(t,s=void 0,...n){return Nve(t)?s?t.bind(s)(...n):t(...n):t}function eV(t){const s=t.filter(i=>i.type==="extension"),n=t.filter(i=>i.type==="node"),a=t.filter(i=>i.type==="mark");return{baseExtensions:s,nodeExtensions:n,markExtensions:a}}function jd(...t){return t.filter(s=>!!s).reduce((s,n)=>{const a={...s};return Object.entries(n).forEach(([i,l])=>{if(!a[i]){a[i]=l;return}if(i==="class"){const c=l?String(l).split(" "):[],d=a[i]?a[i].split(" "):[],u=c.filter(h=>!d.includes(h));a[i]=[...d,...u].join(" ")}else if(i==="style"){const c=l?l.split(";").map(h=>h.trim()).filter(Boolean):[],d=a[i]?a[i].split(";").map(h=>h.trim()).filter(Boolean):[],u=new Map;d.forEach(h=>{const[f,x]=h.split(":").map(b=>b.trim());u.set(f,x)}),c.forEach(h=>{const[f,x]=h.split(":").map(b=>b.trim());u.set(f,x)}),a[i]=Array.from(u.entries()).map(([h,f])=>`${h}: ${f}`).join("; ")}else a[i]=l}),a},{})}function wve(t,s,n){const{from:a,to:i}=s,{blockSeparator:l=`

`,textSerializers:o={}}=n||{};let c="";return t.nodesBetween(a,i,(d,u,h,f)=>{var x;d.isBlock&&u>a&&(c+=l);const b=o==null?void 0:o[d.type.name];if(b)return h&&(c+=b({node:d,pos:u,parent:h,index:f,range:s})),!1;d.isText&&(c+=(x=d==null?void 0:d.text)==null?void 0:x.slice(Math.max(a,u)-u,i-u))}),c}function jve(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,s])=>s.spec.toText).map(([s,n])=>[s,n.spec.toText]))}function _ve(t,s=JSON.stringify){const n={};return t.filter(a=>{const i=s(a);return Object.prototype.hasOwnProperty.call(n,i)?!1:n[i]=!0})}function Sve(t){const s=_ve(t);return s.length===1?s:s.filter((n,a)=>!s.filter((l,o)=>o!==a).some(l=>n.oldRange.from>=l.oldRange.from&&n.oldRange.to<=l.oldRange.to&&n.newRange.from>=l.newRange.from&&n.newRange.to<=l.newRange.to))}function Cve(t){const{mapping:s,steps:n}=t,a=[];return s.maps.forEach((i,l)=>{const o=[];if(i.ranges.length)i.forEach((c,d)=>{o.push({from:c,to:d})});else{const{from:c,to:d}=n[l];if(c===void 0||d===void 0)return;o.push({from:c,to:d})}o.forEach(({from:c,to:d})=>{const u=s.slice(l).map(c,-1),h=s.slice(l).map(d),f=s.invert().map(u,-1),x=s.invert().map(h);a.push({oldRange:{from:f,to:x},newRange:{from:u,to:h}})})}),Sve(a)}function tV(t,s,n){const a=[];return t===s?n.resolve(t).marks().forEach(i=>{const l=n.resolve(t),o=w5(l,i.type);o&&a.push({mark:i,...o})}):n.nodesBetween(t,s,(i,l)=>{!i||(i==null?void 0:i.nodeSize)===void 0||a.push(...i.marks.map(o=>({from:l,to:l+i.nodeSize,mark:o})))}),a}function xy(t,s,n){return Object.fromEntries(Object.entries(n).filter(([a])=>{const i=t.find(l=>l.type===s&&l.name===a);return i?i.attribute.keepOnSplit:!1}))}function kve(t,s,n={}){const{empty:a,ranges:i}=t.selection,l=s?wd(s,t.schema):null;if(a)return!!(t.storedMarks||t.selection.$from.marks()).filter(f=>l?l.name===f.type.name:!0).find(f=>T1(f.attrs,n,{strict:!1}));let o=0;const c=[];if(i.forEach(({$from:f,$to:x})=>{const b=f.pos,v=x.pos;t.doc.nodesBetween(b,v,(w,_)=>{if(!w.isText&&!w.marks.length)return;const S=Math.max(b,_),k=Math.min(v,_+w.nodeSize),A=k-S;o+=A,c.push(...w.marks.map(T=>({mark:T,from:S,to:k})))})}),o===0)return!1;const d=c.filter(f=>l?l.name===f.mark.type.name:!0).filter(f=>T1(f.mark.attrs,n,{strict:!1})).reduce((f,x)=>f+x.to-x.from,0),u=c.filter(f=>l?f.mark.type!==l&&f.mark.type.excludes(l):!0).reduce((f,x)=>f+x.to-x.from,0);return(d>0?d+u:d)>=o}function _M(t,s){const{nodeExtensions:n}=eV(s),a=n.find(o=>o.name===t);if(!a)return!1;const i={name:a.name,options:a.options,storage:a.storage},l=Pu(ym(a,"group",i));return typeof l!="string"?!1:l.split(" ").includes("list")}function sV(t,{checkChildren:s=!0,ignoreWhitespace:n=!1}={}){var a;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((a=t.text)!=null?a:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(s){let i=!0;return t.content.forEach(l=>{i!==!1&&(sV(l,{ignoreWhitespace:n,checkChildren:s})||(i=!1))}),i}return!1}function Ave(t,s,n){var a;const{selection:i}=s;let l=null;if(YU(i)&&(l=i.$cursor),l){const c=(a=t.storedMarks)!=null?a:l.marks();return l.parent.type.allowsMarkType(n)&&(!!n.isInSet(c)||!c.some(u=>u.type.excludes(n)))}const{ranges:o}=i;return o.some(({$from:c,$to:d})=>{let u=c.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(c.pos,d.pos,(h,f,x)=>{if(u)return!1;if(h.isInline){const b=!x||x.type.allowsMarkType(n),v=!!n.isInSet(h.marks)||!h.marks.some(w=>w.type.excludes(n));u=b&&v}return!u}),u})}var Eve=(t,s={})=>({tr:n,state:a,dispatch:i})=>{const{selection:l}=n,{empty:o,ranges:c}=l,d=wd(t,a.schema);if(i)if(o){const u=yve(a,d);n.addStoredMark(d.create({...u,...s}))}else c.forEach(u=>{const h=u.$from.pos,f=u.$to.pos;a.doc.nodesBetween(h,f,(x,b)=>{const v=Math.max(b,h),w=Math.min(b+x.nodeSize,f);x.marks.find(S=>S.type===d)?x.marks.forEach(S=>{d===S.type&&n.addMark(v,w,d.create({...S.attrs,...s}))}):n.addMark(v,w,d.create(s))})});return Ave(a,n,d)},Tve=(t,s)=>({tr:n})=>(n.setMeta(t,s),!0),Pve=(t,s={})=>({state:n,dispatch:a,chain:i})=>{const l=Jr(t,n.schema);let o;return n.selection.$anchor.sameParent(n.selection.$head)&&(o=n.selection.$anchor.parent.attrs),l.isTextblock?i().command(({commands:c})=>j1(l,{...o,...s})(n)?!0:c.clearNodes()).command(({state:c})=>j1(l,{...o,...s})(c,a)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Ive=t=>({tr:s,dispatch:n})=>{if(n){const{doc:a}=s,i=Zd(t,0,a.content.size),l=Pt.create(a,i);s.setSelection(l)}return!0},Mve=(t,s)=>({tr:n,state:a,dispatch:i})=>{const{selection:l}=a;let o,c;return typeof s=="number"?(o=s,c=s):s&&"from"in s&&"to"in s?(o=s.from,c=s.to):(o=l.from,c=l.to),i&&n.doc.nodesBetween(o,c,(d,u)=>{d.isText||n.setNodeMarkup(u,void 0,{...d.attrs,dir:t})}),!0},Dve=t=>({tr:s,dispatch:n})=>{if(n){const{doc:a}=s,{from:i,to:l}=typeof t=="number"?{from:t,to:t}:t,o=kt.atStart(a).from,c=kt.atEnd(a).to,d=Zd(i,o,c),u=Zd(l,o,c),h=kt.create(a,d,u);s.setSelection(h)}return!0},Ove=t=>({state:s,dispatch:n})=>{const a=Jr(t,s.schema);return vU(a)(s,n)};function SM(t,s){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const a=n.filter(i=>s==null?void 0:s.includes(i.type.name));t.tr.ensureMarks(a)}}var Rve=({keepMarks:t=!0}={})=>({tr:s,state:n,dispatch:a,editor:i})=>{const{selection:l,doc:o}=s,{$from:c,$to:d}=l,u=i.extensionManager.attributes,h=xy(u,c.node().type.name,c.node().attrs);if(l instanceof Pt&&l.node.isBlock)return!c.parentOffset||!mi(o,c.pos)?!1:(a&&(t&&SM(n,i.extensionManager.splittableMarks),s.split(c.pos).scrollIntoView()),!0);if(!c.parent.isBlock)return!1;const f=d.parentOffset===d.parent.content.size,x=c.depth===0?void 0:vve(c.node(-1).contentMatchAt(c.indexAfter(-1)));let b=f&&x?[{type:x,attrs:h}]:void 0,v=mi(s.doc,s.mapping.map(c.pos),1,b);if(!b&&!v&&mi(s.doc,s.mapping.map(c.pos),1,x?[{type:x}]:void 0)&&(v=!0,b=x?[{type:x,attrs:h}]:void 0),a){if(v&&(l instanceof kt&&s.deleteSelection(),s.split(s.mapping.map(c.pos),1,b),x&&!f&&!c.parentOffset&&c.parent.type!==x)){const w=s.mapping.map(c.before()),_=s.doc.resolve(w);c.node(-1).canReplaceWith(_.index(),_.index()+1,x)&&s.setNodeMarkup(s.mapping.map(c.before()),x)}t&&SM(n,i.extensionManager.splittableMarks),s.scrollIntoView()}return v},Lve=(t,s={})=>({tr:n,state:a,dispatch:i,editor:l})=>{var o;const c=Jr(t,a.schema),{$from:d,$to:u}=a.selection,h=a.selection.node;if(h&&h.isBlock||d.depth<2||!d.sameParent(u))return!1;const f=d.node(-1);if(f.type!==c)return!1;const x=l.extensionManager.attributes;if(d.parent.content.size===0&&d.node(-1).childCount===d.indexAfter(-1)){if(d.depth===2||d.node(-3).type!==c||d.index(-2)!==d.node(-2).childCount-1)return!1;if(i){let S=ze.empty;const k=d.index(-1)?1:d.index(-2)?2:3;for(let I=d.depth-k;I>=d.depth-3;I-=1)S=ze.from(d.node(I).copy(S));const A=d.indexAfter(-1)<d.node(-2).childCount?1:d.indexAfter(-2)<d.node(-3).childCount?2:3,T={...xy(x,d.node().type.name,d.node().attrs),...s},P=((o=c.contentMatch.defaultType)==null?void 0:o.createAndFill(T))||void 0;S=S.append(ze.from(c.createAndFill(null,P)||void 0));const O=d.before(d.depth-(k-1));n.replace(O,d.after(-A),new ct(S,4-k,0));let D=-1;n.doc.nodesBetween(O,n.doc.content.size,(I,M)=>{if(D>-1)return!1;I.isTextblock&&I.content.size===0&&(D=M+1)}),D>-1&&n.setSelection(kt.near(n.doc.resolve(D))),n.scrollIntoView()}return!0}const b=u.pos===d.end()?f.contentMatchAt(0).defaultType:null,v={...xy(x,f.type.name,f.attrs),...s},w={...xy(x,d.node().type.name,d.node().attrs),...s};n.delete(d.pos,u.pos);const _=b?[{type:c,attrs:v},{type:b,attrs:w}]:[{type:c,attrs:v}];if(!mi(n.doc,d.pos,2))return!1;if(i){const{selection:S,storedMarks:k}=a,{splittableMarks:A}=l.extensionManager,T=k||S.$to.parentOffset&&S.$from.marks();if(n.split(d.pos,2,_).scrollIntoView(),!T||!i)return!0;const P=T.filter(O=>A.includes(O.type.name));n.ensureMarks(P)}return!0},Aj=(t,s)=>{const n=S5(o=>o.type===s)(t.selection);if(!n)return!0;const a=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(a===void 0)return!0;const i=t.doc.nodeAt(a);return n.node.type===(i==null?void 0:i.type)&&go(t.doc,n.pos)&&t.join(n.pos),!0},Ej=(t,s)=>{const n=S5(o=>o.type===s)(t.selection);if(!n)return!0;const a=t.doc.resolve(n.start).after(n.depth);if(a===void 0)return!0;const i=t.doc.nodeAt(a);return n.node.type===(i==null?void 0:i.type)&&go(t.doc,a)&&t.join(a),!0},Bve=(t,s,n,a={})=>({editor:i,tr:l,state:o,dispatch:c,chain:d,commands:u,can:h})=>{const{extensions:f,splittableMarks:x}=i.extensionManager,b=Jr(t,o.schema),v=Jr(s,o.schema),{selection:w,storedMarks:_}=o,{$from:S,$to:k}=w,A=S.blockRange(k),T=_||w.$to.parentOffset&&w.$from.marks();if(!A)return!1;const P=S5(O=>_M(O.type.name,f))(w);if(A.depth>=1&&P&&A.depth-P.depth<=1){if(P.node.type===b)return u.liftListItem(v);if(_M(P.node.type.name,f)&&b.validContent(P.node.content)&&c)return d().command(()=>(l.setNodeMarkup(P.pos,b),!0)).command(()=>Aj(l,b)).command(()=>Ej(l,b)).run()}return!n||!T||!c?d().command(()=>h().wrapInList(b,a)?!0:u.clearNodes()).wrapInList(b,a).command(()=>Aj(l,b)).command(()=>Ej(l,b)).run():d().command(()=>{const O=h().wrapInList(b,a),D=T.filter(I=>x.includes(I.type.name));return l.ensureMarks(D),O?!0:u.clearNodes()}).wrapInList(b,a).command(()=>Aj(l,b)).command(()=>Ej(l,b)).run()},Fve=(t,s={},n={})=>({state:a,commands:i})=>{const{extendEmptyMarkRange:l=!1}=n,o=wd(t,a.schema);return kve(a,o,s)?i.unsetMark(o,{extendEmptyMarkRange:l}):i.setMark(o,s)},$ve=(t,s,n={})=>({state:a,commands:i})=>{const l=Jr(t,a.schema),o=Jr(s,a.schema),c=_5(a,l,n);let d;return a.selection.$anchor.sameParent(a.selection.$head)&&(d=a.selection.$anchor.parent.attrs),c?i.setNode(o,d):i.setNode(l,{...d,...n})},zve=(t,s={})=>({state:n,commands:a})=>{const i=Jr(t,n.schema);return _5(n,i,s)?a.lift(i):a.wrapIn(i,s)},Uve=()=>({state:t,dispatch:s})=>{const n=t.plugins;for(let a=0;a<n.length;a+=1){const i=n[a];let l;if(i.spec.isInputRules&&(l=i.getState(t))){if(s){const o=t.tr,c=l.transform;for(let d=c.steps.length-1;d>=0;d-=1)o.step(c.steps[d].invert(c.docs[d]));if(l.text){const d=o.doc.resolve(l.from).marks();o.replaceWith(l.from,l.to,t.schema.text(l.text,d))}else o.delete(l.from,l.to)}return!0}}return!1},Vve=()=>({tr:t,dispatch:s})=>{const{selection:n}=t,{empty:a,ranges:i}=n;return a||s&&i.forEach(l=>{t.removeMark(l.$from.pos,l.$to.pos)}),!0},Hve=(t,s={})=>({tr:n,state:a,dispatch:i})=>{var l;const{extendEmptyMarkRange:o=!1}=s,{selection:c}=n,d=wd(t,a.schema),{$from:u,empty:h,ranges:f}=c;if(!i)return!0;if(h&&o){let{from:x,to:b}=c;const v=(l=u.marks().find(_=>_.type===d))==null?void 0:l.attrs,w=w5(u,d,v);w&&(x=w.from,b=w.to),n.removeMark(x,b,d)}else f.forEach(x=>{n.removeMark(x.$from.pos,x.$to.pos,d)});return n.removeStoredMark(d),!0},Wve=t=>({tr:s,state:n,dispatch:a})=>{const{selection:i}=n;let l,o;return typeof t=="number"?(l=t,o=t):t&&"from"in t&&"to"in t?(l=t.from,o=t.to):(l=i.from,o=i.to),a&&s.doc.nodesBetween(l,o,(c,d)=>{if(c.isText)return;const u={...c.attrs};delete u.dir,s.setNodeMarkup(d,void 0,u)}),!0},qve=(t,s={})=>({tr:n,state:a,dispatch:i})=>{let l=null,o=null;const c=ZU(typeof t=="string"?t:t.name,a.schema);if(!c)return!1;c==="node"&&(l=Jr(t,a.schema)),c==="mark"&&(o=wd(t,a.schema));let d=!1;return n.selection.ranges.forEach(u=>{const h=u.$from.pos,f=u.$to.pos;let x,b,v,w;n.selection.empty?a.doc.nodesBetween(h,f,(_,S)=>{l&&l===_.type&&(d=!0,v=Math.max(S,h),w=Math.min(S+_.nodeSize,f),x=S,b=_)}):a.doc.nodesBetween(h,f,(_,S)=>{S<h&&l&&l===_.type&&(d=!0,v=Math.max(S,h),w=Math.min(S+_.nodeSize,f),x=S,b=_),S>=h&&S<=f&&(l&&l===_.type&&(d=!0,i&&n.setNodeMarkup(S,void 0,{..._.attrs,...s})),o&&_.marks.length&&_.marks.forEach(k=>{if(o===k.type&&(d=!0,i)){const A=Math.max(S,h),T=Math.min(S+_.nodeSize,f);n.addMark(A,T,o.create({...k.attrs,...s}))}}))}),b&&(x!==void 0&&i&&n.setNodeMarkup(x,void 0,{...b.attrs,...s}),o&&b.marks.length&&b.marks.forEach(_=>{o===_.type&&i&&n.addMark(v,w,o.create({..._.attrs,...s}))}))}),d},Gve=(t,s={})=>({state:n,dispatch:a})=>{const i=Jr(t,n.schema);return gU(i,s)(n,a)},Kve=(t,s={})=>({state:n,dispatch:a})=>{const i=Jr(t,n.schema);return yU(i,s)(n,a)},nV=class{constructor(s){var n;this.find=s.find,this.handler=s.handler,this.undoable=(n=s.undoable)!=null?n:!0}};function Yve(t){return Object.prototype.toString.call(t).slice(8,-1)}function mg(t){return Yve(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function rV(t,s){const n={...t};return mg(t)&&mg(s)&&Object.keys(s).forEach(a=>{mg(s[a])&&mg(t[a])?n[a]=rV(t[a],s[a]):n[a]=s[a]}),n}var C5=class{constructor(t={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...t},this.name=this.config.name}get options(){return{...Pu(ym(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...Pu(ym(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(t={}){const s=this.extend({...this.config,addOptions:()=>rV(this.options,t)});return s.name=this.name,s.parent=this.parent,s}extend(t={}){const s=new this.constructor({...this.config,...t});return s.parent=this,this.child=s,s.name="name"in t?t.name:s.parent.name,s}},k5=class aV extends C5{constructor(){super(...arguments),this.type="mark"}static create(s={}){const n=typeof s=="function"?s():s;return new aV(n)}static handleExit({editor:s,mark:n}){const{tr:a}=s.state,i=s.state.selection.$from;if(i.pos===i.end()){const o=i.marks();if(!!!o.find(u=>(u==null?void 0:u.type.name)===n.name))return!1;const d=o.find(u=>(u==null?void 0:u.type.name)===n.name);return d&&a.removeStoredMark(d),a.insertText(" ",i.pos),s.view.dispatch(a),!0}return!1}configure(s){return super.configure(s)}extend(s){const n=typeof s=="function"?s():s;return super.extend(n)}},Xve=class{constructor(s){this.find=s.find,this.handler=s.handler}},Qve={};N5(Qve,{ClipboardTextSerializer:()=>Zve,Commands:()=>Jve,Delete:()=>eNe,Drop:()=>tNe,Editable:()=>sNe,FocusEvents:()=>nNe,Keymap:()=>rNe,Paste:()=>aNe,Tabindex:()=>iNe,TextDirection:()=>lNe,focusEventsPluginKey:()=>lV});var _r=class iV extends C5{constructor(){super(...arguments),this.type="extension"}static create(s={}){const n=typeof s=="function"?s():s;return new iV(n)}configure(s){return super.configure(s)}extend(s){const n=typeof s=="function"?s():s;return super.extend(n)}},Zve=_r.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Ln({key:new Bn("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:s,schema:n}=t,{doc:a,selection:i}=s,{ranges:l}=i,o=Math.min(...l.map(h=>h.$from.pos)),c=Math.max(...l.map(h=>h.$to.pos)),d=jve(n);return wve(a,{from:o,to:c},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:d})}}})]}}),Jve=_r.create({name:"commands",addCommands(){return{...GU}}}),eNe=_r.create({name:"delete",onUpdate({transaction:t,appendedTransactions:s}){var n,a,i;const l=()=>{var o,c,d,u;if((u=(d=(c=(o=this.editor.options.coreExtensionOptions)==null?void 0:o.delete)==null?void 0:c.filterTransaction)==null?void 0:d.call(c,t))!=null?u:t.getMeta("y-sync$"))return;const h=bve(t.before,[t,...s]);Cve(h).forEach(b=>{h.mapping.mapResult(b.oldRange.from).deletedAfter&&h.mapping.mapResult(b.oldRange.to).deletedBefore&&h.before.nodesBetween(b.oldRange.from,b.oldRange.to,(v,w)=>{const _=w+v.nodeSize-2,S=b.oldRange.from<=w&&_<=b.oldRange.to;this.editor.emit("delete",{type:"node",node:v,from:w,to:_,newFrom:h.mapping.map(w),newTo:h.mapping.map(_),deletedRange:b.oldRange,newRange:b.newRange,partial:!S,editor:this.editor,transaction:t,combinedTransform:h})})});const x=h.mapping;h.steps.forEach((b,v)=>{var w,_;if(b instanceof fl){const S=x.slice(v).map(b.from,-1),k=x.slice(v).map(b.to),A=x.invert().map(S,-1),T=x.invert().map(k),P=(w=h.doc.nodeAt(S-1))==null?void 0:w.marks.some(D=>D.eq(b.mark)),O=(_=h.doc.nodeAt(k))==null?void 0:_.marks.some(D=>D.eq(b.mark));this.editor.emit("delete",{type:"mark",mark:b.mark,from:b.from,to:b.to,deletedRange:{from:A,to:T},newRange:{from:S,to:k},partial:!!(O||P),editor:this.editor,transaction:t,combinedTransform:h})}})};(i=(a=(n=this.editor.options.coreExtensionOptions)==null?void 0:n.delete)==null?void 0:a.async)==null||i?setTimeout(l,0):l()}}),tNe=_r.create({name:"drop",addProseMirrorPlugins(){return[new Ln({key:new Bn("tiptapDrop"),props:{handleDrop:(t,s,n,a)=>{this.editor.emit("drop",{editor:this.editor,event:s,slice:n,moved:a})}}})]}}),sNe=_r.create({name:"editable",addProseMirrorPlugins(){return[new Ln({key:new Bn("editable"),props:{editable:()=>this.editor.options.editable}})]}}),lV=new Bn("focusEvents"),nNe=_r.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new Ln({key:lV,props:{handleDOMEvents:{focus:(s,n)=>{t.isFocused=!0;const a=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return s.dispatch(a),!1},blur:(s,n)=>{t.isFocused=!1;const a=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return s.dispatch(a),!1}}}})]}}),rNe=_r.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:c})=>{const{selection:d,doc:u}=c,{empty:h,$anchor:f}=d,{pos:x,parent:b}=f,v=f.parent.isTextblock&&x>0?c.doc.resolve(x-1):f,w=v.parent.type.spec.isolating,_=f.pos-f.parentOffset,S=w&&v.parent.childCount===1?_===f.pos:Bt.atStart(u).from===x;return!h||!b.type.isTextblock||b.textContent.length||!S||S&&f.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),s=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),a={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:s,"Mod-Delete":s,"Mod-a":()=>this.editor.commands.selectAll()},i={...a},l={...a,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":s,"Ctrl-Alt-Backspace":s,"Alt-Delete":s,"Alt-d":s,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return j5()||QU()?l:i},addProseMirrorPlugins(){return[new Ln({key:new Bn("clearDocument"),appendTransaction:(t,s,n)=>{if(t.some(w=>w.getMeta("composition")))return;const a=t.some(w=>w.docChanged)&&!s.doc.eq(n.doc),i=t.some(w=>w.getMeta("preventClearDocument"));if(!a||i)return;const{empty:l,from:o,to:c}=s.selection,d=Bt.atStart(s.doc).from,u=Bt.atEnd(s.doc).to;if(l||!(o===d&&c===u)||!sV(n.doc))return;const x=n.tr,b=qU({state:n,transaction:x}),{commands:v}=new _be({editor:this.editor,state:b});if(v.clearNodes(),!!x.steps.length)return x}})]}}),aNe=_r.create({name:"paste",addProseMirrorPlugins(){return[new Ln({key:new Bn("tiptapPaste"),props:{handlePaste:(t,s,n)=>{this.editor.emit("paste",{editor:this.editor,event:s,slice:n})}}})]}}),iNe=_r.create({name:"tabindex",addProseMirrorPlugins(){return[new Ln({key:new Bn("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),lNe=_r.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:t}=eV(this.extensions);return[{types:t.filter(s=>s.name!=="text").map(s=>s.name),attributes:{dir:{default:this.options.direction,parseHTML:s=>{const n=s.getAttribute("dir");return n&&(n==="ltr"||n==="rtl"||n==="auto")?n:this.options.direction},renderHTML:s=>s.dir?{dir:s.dir}:{}}}}]},addProseMirrorPlugins(){return[new Ln({key:new Bn("textDirection"),props:{attributes:()=>{const t=this.options.direction;return t?{dir:t}:{}}}})]}});function oNe(t){return new nV({find:t.find,handler:({state:s,range:n,match:a})=>{const i=Pu(t.getAttributes,void 0,a);if(i===!1||i===null)return null;const{tr:l}=s,o=a[a.length-1],c=a[0];if(o){const d=c.search(/\S/),u=n.from+c.indexOf(o),h=u+o.length;if(tV(n.from,n.to,s.doc).filter(b=>b.mark.type.excluded.find(w=>w===t.type&&w!==b.mark.type)).filter(b=>b.to>u).length)return null;h<n.to&&l.delete(h,n.to),u>n.from&&l.delete(n.from+d,u);const x=n.from+d+o.length;l.addMark(n.from+d,x,t.type.create(i||{})),l.removeStoredMark(t.type)}},undoable:t.undoable})}function cNe(t){return new nV({find:t.find,handler:({state:s,range:n,match:a})=>{const i=Pu(t.getAttributes,void 0,a)||{},{tr:l}=s,o=n.from;let c=n.to;const d=t.type.create(i);if(a[1]){const u=a[0].lastIndexOf(a[1]);let h=o+u;h>c?h=c:c=h+a[1].length;const f=a[0][a[0].length-1];l.insertText(f,o+a[0].length-1),l.replaceWith(h,c,d)}else if(a[0]){const u=t.type.isInline?o:o-1;l.insert(u,t.type.create(i)).delete(l.mapping.map(o),l.mapping.map(c))}l.scrollIntoView()},undoable:t.undoable})}var dNe=t=>"touches"in t,uNe=class{constructor(t){this.directions=["bottom-left","bottom-right","top-left","top-right"],this.minSize={height:8,width:8},this.preserveAspectRatio=!1,this.classNames={container:"",wrapper:"",handle:"",resizing:""},this.initialWidth=0,this.initialHeight=0,this.aspectRatio=1,this.isResizing=!1,this.activeHandle=null,this.startX=0,this.startY=0,this.startWidth=0,this.startHeight=0,this.isShiftKeyPressed=!1,this.lastEditableState=void 0,this.handleMap=new Map,this.handleMouseMove=c=>{if(!this.isResizing||!this.activeHandle)return;const d=c.clientX-this.startX,u=c.clientY-this.startY;this.handleResize(d,u)},this.handleTouchMove=c=>{if(!this.isResizing||!this.activeHandle)return;const d=c.touches[0];if(!d)return;const u=d.clientX-this.startX,h=d.clientY-this.startY;this.handleResize(u,h)},this.handleMouseUp=()=>{if(!this.isResizing)return;const c=this.element.offsetWidth,d=this.element.offsetHeight;this.onCommit(c,d),this.isResizing=!1,this.activeHandle=null,this.container.dataset.resizeState="false",this.classNames.resizing&&this.container.classList.remove(this.classNames.resizing),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp)},this.handleKeyDown=c=>{c.key==="Shift"&&(this.isShiftKeyPressed=!0)},this.handleKeyUp=c=>{c.key==="Shift"&&(this.isShiftKeyPressed=!1)};var s,n,a,i,l,o;this.node=t.node,this.editor=t.editor,this.element=t.element,this.contentElement=t.contentElement,this.getPos=t.getPos,this.onResize=t.onResize,this.onCommit=t.onCommit,this.onUpdate=t.onUpdate,(s=t.options)!=null&&s.min&&(this.minSize={...this.minSize,...t.options.min}),(n=t.options)!=null&&n.max&&(this.maxSize=t.options.max),(a=t==null?void 0:t.options)!=null&&a.directions&&(this.directions=t.options.directions),(i=t.options)!=null&&i.preserveAspectRatio&&(this.preserveAspectRatio=t.options.preserveAspectRatio),(l=t.options)!=null&&l.className&&(this.classNames={container:t.options.className.container||"",wrapper:t.options.className.wrapper||"",handle:t.options.className.handle||"",resizing:t.options.className.resizing||""}),(o=t.options)!=null&&o.createCustomHandle&&(this.createCustomHandle=t.options.createCustomHandle),this.wrapper=this.createWrapper(),this.container=this.createContainer(),this.applyInitialSize(),this.attachHandles(),this.editor.on("update",this.handleEditorUpdate.bind(this))}get dom(){return this.container}get contentDOM(){return this.contentElement}handleEditorUpdate(){const t=this.editor.isEditable;t!==this.lastEditableState&&(this.lastEditableState=t,t?t&&this.handleMap.size===0&&this.attachHandles():this.removeHandles())}update(t,s,n){return t.type!==this.node.type?!1:(this.node=t,this.onUpdate?this.onUpdate(t,s,n):!0)}destroy(){this.isResizing&&(this.container.dataset.resizeState="false",this.classNames.resizing&&this.container.classList.remove(this.classNames.resizing),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp),this.isResizing=!1,this.activeHandle=null),this.editor.off("update",this.handleEditorUpdate.bind(this)),this.container.remove()}createContainer(){const t=document.createElement("div");return t.dataset.resizeContainer="",t.dataset.node=this.node.type.name,t.style.display="flex",this.classNames.container&&(t.className=this.classNames.container),t.appendChild(this.wrapper),t}createWrapper(){const t=document.createElement("div");return t.style.position="relative",t.style.display="block",t.dataset.resizeWrapper="",this.classNames.wrapper&&(t.className=this.classNames.wrapper),t.appendChild(this.element),t}createHandle(t){const s=document.createElement("div");return s.dataset.resizeHandle=t,s.style.position="absolute",this.classNames.handle&&(s.className=this.classNames.handle),s}positionHandle(t,s){const n=s.includes("top"),a=s.includes("bottom"),i=s.includes("left"),l=s.includes("right");n&&(t.style.top="0"),a&&(t.style.bottom="0"),i&&(t.style.left="0"),l&&(t.style.right="0"),(s==="top"||s==="bottom")&&(t.style.left="0",t.style.right="0"),(s==="left"||s==="right")&&(t.style.top="0",t.style.bottom="0")}attachHandles(){this.directions.forEach(t=>{let s;this.createCustomHandle?s=this.createCustomHandle(t):s=this.createHandle(t),s instanceof HTMLElement||(console.warn(`[ResizableNodeView] createCustomHandle("${t}") did not return an HTMLElement. Falling back to default handle.`),s=this.createHandle(t)),this.createCustomHandle||this.positionHandle(s,t),s.addEventListener("mousedown",n=>this.handleResizeStart(n,t)),s.addEventListener("touchstart",n=>this.handleResizeStart(n,t)),this.handleMap.set(t,s),this.wrapper.appendChild(s)})}removeHandles(){this.handleMap.forEach(t=>t.remove()),this.handleMap.clear()}applyInitialSize(){const t=this.node.attrs.width,s=this.node.attrs.height;t?(this.element.style.width=`${t}px`,this.initialWidth=t):this.initialWidth=this.element.offsetWidth,s?(this.element.style.height=`${s}px`,this.initialHeight=s):this.initialHeight=this.element.offsetHeight,this.initialWidth>0&&this.initialHeight>0&&(this.aspectRatio=this.initialWidth/this.initialHeight)}handleResizeStart(t,s){t.preventDefault(),t.stopPropagation(),this.isResizing=!0,this.activeHandle=s,dNe(t)?(this.startX=t.touches[0].clientX,this.startY=t.touches[0].clientY):(this.startX=t.clientX,this.startY=t.clientY),this.startWidth=this.element.offsetWidth,this.startHeight=this.element.offsetHeight,this.startWidth>0&&this.startHeight>0&&(this.aspectRatio=this.startWidth/this.startHeight),this.getPos(),this.container.dataset.resizeState="true",this.classNames.resizing&&this.container.classList.add(this.classNames.resizing),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("touchmove",this.handleTouchMove),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}handleResize(t,s){if(!this.activeHandle)return;const n=this.preserveAspectRatio||this.isShiftKeyPressed,{width:a,height:i}=this.calculateNewDimensions(this.activeHandle,t,s),l=this.applyConstraints(a,i,n);this.element.style.width=`${l.width}px`,this.element.style.height=`${l.height}px`,this.onResize&&this.onResize(l.width,l.height)}calculateNewDimensions(t,s,n){let a=this.startWidth,i=this.startHeight;const l=t.includes("right"),o=t.includes("left"),c=t.includes("bottom"),d=t.includes("top");return l?a=this.startWidth+s:o&&(a=this.startWidth-s),c?i=this.startHeight+n:d&&(i=this.startHeight-n),(t==="right"||t==="left")&&(a=this.startWidth+(l?s:-s)),(t==="top"||t==="bottom")&&(i=this.startHeight+(c?n:-n)),this.preserveAspectRatio||this.isShiftKeyPressed?this.applyAspectRatio(a,i,t):{width:a,height:i}}applyConstraints(t,s,n){var a,i,l,o;if(!n){let u=Math.max(this.minSize.width,t),h=Math.max(this.minSize.height,s);return(a=this.maxSize)!=null&&a.width&&(u=Math.min(this.maxSize.width,u)),(i=this.maxSize)!=null&&i.height&&(h=Math.min(this.maxSize.height,h)),{width:u,height:h}}let c=t,d=s;return c<this.minSize.width&&(c=this.minSize.width,d=c/this.aspectRatio),d<this.minSize.height&&(d=this.minSize.height,c=d*this.aspectRatio),(l=this.maxSize)!=null&&l.width&&c>this.maxSize.width&&(c=this.maxSize.width,d=c/this.aspectRatio),(o=this.maxSize)!=null&&o.height&&d>this.maxSize.height&&(d=this.maxSize.height,c=d*this.aspectRatio),{width:c,height:d}}applyAspectRatio(t,s,n){const a=n==="left"||n==="right",i=n==="top"||n==="bottom";return a?{width:t,height:t/this.aspectRatio}:i?{width:s*this.aspectRatio,height:s}:{width:t,height:t/this.aspectRatio}}},hNe={};N5(hNe,{createAtomBlockMarkdownSpec:()=>mNe,createBlockMarkdownSpec:()=>fNe,createInlineMarkdownSpec:()=>gNe,parseAttributes:()=>A5,parseIndentedBlocks:()=>yNe,renderNestedMarkdownContent:()=>bNe,serializeAttributes:()=>E5});function A5(t){if(!(t!=null&&t.trim()))return{};const s={},n=[],a=t.replace(/["']([^"']*)["']/g,u=>(n.push(u),`__QUOTED_${n.length-1}__`)),i=a.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(i){const u=i.map(h=>h.trim().slice(1));s.class=u.join(" ")}const l=a.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);l&&(s.id=l[1]);const o=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(a.matchAll(o)).forEach(([,u,h])=>{var f;const x=parseInt(((f=h.match(/__QUOTED_(\d+)__/))==null?void 0:f[1])||"0",10),b=n[x];b&&(s[u]=b.slice(1,-1))});const d=a.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return d&&d.split(/\s+/).filter(Boolean).forEach(h=>{h.match(/^[a-zA-Z][\w-]*$/)&&(s[h]=!0)}),s}function E5(t){if(!t||Object.keys(t).length===0)return"";const s=[];return t.class&&String(t.class).split(/\s+/).filter(Boolean).forEach(a=>s.push(`.${a}`)),t.id&&s.push(`#${t.id}`),Object.entries(t).forEach(([n,a])=>{n==="class"||n==="id"||(a===!0?s.push(n):a!==!1&&a!=null&&s.push(`${n}="${String(a)}"`))}),s.join(" ")}function mNe(t){const{nodeName:s,name:n,parseAttributes:a=A5,serializeAttributes:i=E5,defaultAttributes:l={},requiredAttributes:o=[],allowedAttributes:c}=t,d=n||s,u=h=>{if(!c)return h;const f={};return c.forEach(x=>{x in h&&(f[x]=h[x])}),f};return{parseMarkdown:(h,f)=>{const x={...l,...h.attributes};return f.createNode(s,x,[])},markdownTokenizer:{name:s,level:"block",start(h){var f;const x=new RegExp(`^:::${d}(?:\\s|$)`,"m"),b=(f=h.match(x))==null?void 0:f.index;return b!==void 0?b:-1},tokenize(h,f,x){const b=new RegExp(`^:::${d}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),v=h.match(b);if(!v)return;const w=v[1]||"",_=a(w);if(!o.find(k=>!(k in _)))return{type:s,raw:v[0],attributes:_}}},renderMarkdown:h=>{const f=u(h.attrs||{}),x=i(f),b=x?` {${x}}`:"";return`:::${d}${b} :::`}}}function fNe(t){const{nodeName:s,name:n,getContent:a,parseAttributes:i=A5,serializeAttributes:l=E5,defaultAttributes:o={},content:c="block",allowedAttributes:d}=t,u=n||s,h=f=>{if(!d)return f;const x={};return d.forEach(b=>{b in f&&(x[b]=f[b])}),x};return{parseMarkdown:(f,x)=>{let b;if(a){const w=a(f);b=typeof w=="string"?[{type:"text",text:w}]:w}else c==="block"?b=x.parseChildren(f.tokens||[]):b=x.parseInline(f.tokens||[]);const v={...o,...f.attributes};return x.createNode(s,v,b)},markdownTokenizer:{name:s,level:"block",start(f){var x;const b=new RegExp(`^:::${u}`,"m"),v=(x=f.match(b))==null?void 0:x.index;return v!==void 0?v:-1},tokenize(f,x,b){var v;const w=new RegExp(`^:::${u}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),_=f.match(w);if(!_)return;const[S,k=""]=_,A=i(k);let T=1;const P=S.length;let O="";const D=/^:::([\w-]*)(\s.*)?/gm,I=f.slice(P);for(D.lastIndex=0;;){const M=D.exec(I);if(M===null)break;const B=M.index,L=M[1];if(!((v=M[2])!=null&&v.endsWith(":::"))){if(L)T+=1;else if(T-=1,T===0){const F=I.slice(0,B);O=F.trim();const V=f.slice(0,P+B+M[0].length);let $=[];if(O)if(c==="block")for($=b.blockTokens(F),$.forEach(z=>{z.text&&(!z.tokens||z.tokens.length===0)&&(z.tokens=b.inlineTokens(z.text))});$.length>0;){const z=$[$.length-1];if(z.type==="paragraph"&&(!z.text||z.text.trim()===""))$.pop();else break}else $=b.inlineTokens(O);return{type:s,raw:V,attributes:A,content:O,tokens:$}}}}}},renderMarkdown:(f,x)=>{const b=h(f.attrs||{}),v=l(b),w=v?` {${v}}`:"",_=x.renderChildren(f.content||[],`

`);return`:::${u}${w}

${_}

:::`}}}function pNe(t){if(!t.trim())return{};const s={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let a=n.exec(t);for(;a!==null;){const[,i,l,o]=a;s[i]=l||o,a=n.exec(t)}return s}function xNe(t){return Object.entries(t).filter(([,s])=>s!=null).map(([s,n])=>`${s}="${n}"`).join(" ")}function gNe(t){const{nodeName:s,name:n,getContent:a,parseAttributes:i=pNe,serializeAttributes:l=xNe,defaultAttributes:o={},selfClosing:c=!1,allowedAttributes:d}=t,u=n||s,h=x=>{if(!d)return x;const b={};return d.forEach(v=>{const w=typeof v=="string"?v:v.name,_=typeof v=="string"?void 0:v.skipIfDefault;if(w in x){const S=x[w];if(_!==void 0&&S===_)return;b[w]=S}}),b},f=u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(x,b)=>{const v={...o,...x.attributes};if(c)return b.createNode(s,v);const w=a?a(x):x.content||"";return w?b.createNode(s,v,[b.createTextNode(w)]):b.createNode(s,v,[])},markdownTokenizer:{name:s,level:"inline",start(x){const b=c?new RegExp(`\\[${f}\\s*[^\\]]*\\]`):new RegExp(`\\[${f}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${f}\\]`),v=x.match(b),w=v==null?void 0:v.index;return w!==void 0?w:-1},tokenize(x,b,v){const w=c?new RegExp(`^\\[${f}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${f}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${f}\\]`),_=x.match(w);if(!_)return;let S="",k="";if(c){const[,T]=_;k=T}else{const[,T,P]=_;k=T,S=P||""}const A=i(k.trim());return{type:s,raw:_[0],content:S.trim(),attributes:A}}},renderMarkdown:x=>{let b="";a?b=a(x):x.content&&x.content.length>0&&(b=x.content.filter(S=>S.type==="text").map(S=>S.text).join(""));const v=h(x.attrs||{}),w=l(v),_=w?` ${w}`:"";return c?`[${u}${_}]`:`[${u}${_}]${b}[/${u}]`}}}function yNe(t,s,n){var a,i,l,o;const c=t.split(`
`),d=[];let u="",h=0;const f=s.baseIndentSize||2;for(;h<c.length;){const x=c[h],b=x.match(s.itemPattern);if(!b){if(d.length>0)break;if(x.trim()===""){h+=1,u=`${u}${x}
`;continue}else return}const v=s.extractItemData(b),{indentLevel:w,mainContent:_}=v;u=`${u}${x}
`;const S=[_];for(h+=1;h<c.length;){const P=c[h];if(P.trim()===""){const D=c.slice(h+1).findIndex(B=>B.trim()!=="");if(D===-1)break;if((((i=(a=c[h+1+D].match(/^(\s*)/))==null?void 0:a[1])==null?void 0:i.length)||0)>w){S.push(P),u=`${u}${P}
`,h+=1;continue}else break}if((((o=(l=P.match(/^(\s*)/))==null?void 0:l[1])==null?void 0:o.length)||0)>w)S.push(P),u=`${u}${P}
`,h+=1;else break}let k;const A=S.slice(1);if(A.length>0){const P=A.map(O=>O.slice(w+f)).join(`
`);P.trim()&&(s.customNestedParser?k=s.customNestedParser(P):k=n.blockTokens(P))}const T=s.createToken(v,k);d.push(T)}if(d.length!==0)return{items:d,raw:u}}function bNe(t,s,n,a){if(!t||!Array.isArray(t.content))return"";const i=typeof n=="function"?n(a):n,[l,...o]=t.content,c=s.renderChildren([l]),d=[`${i}${c}`];return o&&o.length>0&&o.forEach(u=>{const h=s.renderChildren([u]);if(h){const f=h.split(`
`).map(x=>x?s.indent(x):"").join(`
`);d.push(f)}}),d.join(`
`)}var Zx=class oV extends C5{constructor(){super(...arguments),this.type="node"}static create(s={}){const n=typeof s=="function"?s():s;return new oV(n)}configure(s){return super.configure(s)}extend(s){const n=typeof s=="function"?s():s;return super.extend(n)}};function vNe(t){return new Xve({find:t.find,handler:({state:s,range:n,match:a,pasteEvent:i})=>{const l=Pu(t.getAttributes,void 0,a,i);if(l===!1||l===null)return null;const{tr:o}=s,c=a[a.length-1],d=a[0];let u=n.to;if(c){const h=d.search(/\S/),f=n.from+d.indexOf(c),x=f+c.length;if(tV(n.from,n.to,s.doc).filter(v=>v.mark.type.excluded.find(_=>_===t.type&&_!==v.mark.type)).filter(v=>v.to>f).length)return null;x<n.to&&o.delete(x,n.to),f>n.from&&o.delete(n.from+h,f),u=n.from+h+c.length,o.addMark(n.from+h,u,t.type.create(l||{})),o.removeStoredMark(t.type)}}})}function cV(t){const{state:s,transaction:n}=t;let{selection:a}=n,{doc:i}=n,{storedMarks:l}=n;return{...s,apply:s.apply.bind(s),applyTransaction:s.applyTransaction.bind(s),plugins:s.plugins,schema:s.schema,reconfigure:s.reconfigure.bind(s),toJSON:s.toJSON.bind(s),get storedMarks(){return l},get selection(){return a},get doc(){return i},get tr(){return a=n.selection,i=n.doc,l=n.storedMarks,n}}}class NNe{constructor(s){this.editor=s.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=s.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:s,editor:n,state:a}=this,{view:i}=n,{tr:l}=a,o=this.buildProps(l);return Object.fromEntries(Object.entries(s).map(([c,d])=>[c,(...h)=>{const f=d(...h)(o);return!l.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(l),f}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(s,n=!0){const{rawCommands:a,editor:i,state:l}=this,{view:o}=i,c=[],d=!!s,u=s||l.tr,h=()=>(!d&&n&&!u.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(u),c.every(x=>x===!0)),f={...Object.fromEntries(Object.entries(a).map(([x,b])=>[x,(...w)=>{const _=this.buildProps(u,n),S=b(...w)(_);return c.push(S),f}])),run:h};return f}createCan(s){const{rawCommands:n,state:a}=this,i=!1,l=s||a.tr,o=this.buildProps(l,i);return{...Object.fromEntries(Object.entries(n).map(([d,u])=>[d,(...h)=>u(...h)({...o,dispatch:void 0})])),chain:()=>this.createChain(l,i)}}buildProps(s,n=!0){const{rawCommands:a,editor:i,state:l}=this,{view:o}=i,c={tr:s,editor:i,view:o,state:cV({state:l,transaction:s}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(s,n),can:()=>this.createCan(s),get commands(){return Object.fromEntries(Object.entries(a).map(([d,u])=>[d,(...h)=>u(...h)(c)]))}};return c}}function Yr(t,s,n){return t.config[s]===void 0&&t.parent?Yr(t.parent,s,n):typeof t.config[s]=="function"?t.config[s].bind({...n,parent:t.parent?Yr(t.parent,s,n):null}):t.config[s]}function wNe(t){const s=t.filter(i=>i.type==="extension"),n=t.filter(i=>i.type==="node"),a=t.filter(i=>i.type==="mark");return{baseExtensions:s,nodeExtensions:n,markExtensions:a}}function ea(t,s){if(typeof t=="string"){if(!s.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return s.nodes[t]}return t}function Ua(...t){return t.filter(s=>!!s).reduce((s,n)=>{const a={...s};return Object.entries(n).forEach(([i,l])=>{if(!a[i]){a[i]=l;return}if(i==="class"){const c=l?String(l).split(" "):[],d=a[i]?a[i].split(" "):[],u=c.filter(h=>!d.includes(h));a[i]=[...d,...u].join(" ")}else if(i==="style"){const c=l?l.split(";").map(h=>h.trim()).filter(Boolean):[],d=a[i]?a[i].split(";").map(h=>h.trim()).filter(Boolean):[],u=new Map;d.forEach(h=>{const[f,x]=h.split(":").map(b=>b.trim());u.set(f,x)}),c.forEach(h=>{const[f,x]=h.split(":").map(b=>b.trim());u.set(f,x)}),a[i]=Array.from(u.entries()).map(([h,f])=>`${h}: ${f}`).join("; ")}else a[i]=l}),a},{})}function jNe(t){return typeof t=="function"}function or(t,s=void 0,...n){return jNe(t)?s?t.bind(s)(...n):t(...n):t}function _Ne(t){return Object.prototype.toString.call(t)==="[object RegExp]"}class Rv{constructor(s){this.find=s.find,this.handler=s.handler}}function SNe(t){return Object.prototype.toString.call(t).slice(8,-1)}function fg(t){return SNe(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function Lv(t,s){const n={...t};return fg(t)&&fg(s)&&Object.keys(s).forEach(a=>{fg(s[a])&&fg(t[a])?n[a]=Lv(t[a],s[a]):n[a]=s[a]}),n}class Iu{constructor(s={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...s},this.name=this.config.name,s.defaultOptions&&Object.keys(s.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=or(Yr(this,"addOptions",{name:this.name}))),this.storage=or(Yr(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(s={}){return new Iu(s)}configure(s={}){const n=this.extend({...this.config,addOptions:()=>Lv(this.options,s)});return n.name=this.name,n.parent=this.parent,n}extend(s={}){const n=new Iu(s);return n.parent=this,this.child=n,n.name=s.name?s.name:n.parent.name,s.defaultOptions&&Object.keys(s.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=or(Yr(n,"addOptions",{name:n.name})),n.storage=or(Yr(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:s,mark:n}){const{tr:a}=s.state,i=s.state.selection.$from;if(i.pos===i.end()){const o=i.marks();if(!!!o.find(u=>(u==null?void 0:u.type.name)===n.name))return!1;const d=o.find(u=>(u==null?void 0:u.type.name)===n.name);return d&&a.removeStoredMark(d),a.insertText(" ",i.pos),s.view.dispatch(a),!0}return!1}}class CNe{constructor(s){this.find=s.find,this.handler=s.handler}}class pa{constructor(s={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...s},this.name=this.config.name,s.defaultOptions&&Object.keys(s.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=or(Yr(this,"addOptions",{name:this.name}))),this.storage=or(Yr(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(s={}){return new pa(s)}configure(s={}){const n=this.extend({...this.config,addOptions:()=>Lv(this.options,s)});return n.name=this.name,n.parent=this.parent,n}extend(s={}){const n=new pa({...this.config,...s});return n.parent=this,this.child=n,n.name=s.name?s.name:n.parent.name,s.defaultOptions&&Object.keys(s.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=or(Yr(n,"addOptions",{name:n.name})),n.storage=or(Yr(n,"addStorage",{name:n.name,options:n.options})),n}}function kNe(t,s,n){const{from:a,to:i}=s,{blockSeparator:l=`

`,textSerializers:o={}}=n||{};let c="";return t.nodesBetween(a,i,(d,u,h,f)=>{var x;d.isBlock&&u>a&&(c+=l);const b=o==null?void 0:o[d.type.name];if(b)return h&&(c+=b({node:d,pos:u,parent:h,index:f,range:s})),!1;d.isText&&(c+=(x=d==null?void 0:d.text)===null||x===void 0?void 0:x.slice(Math.max(a,u)-u,i-u))}),c}function ANe(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,s])=>s.spec.toText).map(([s,n])=>[s,n.spec.toText]))}pa.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Ln({key:new Bn("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:s,schema:n}=t,{doc:a,selection:i}=s,{ranges:l}=i,o=Math.min(...l.map(h=>h.$from.pos)),c=Math.max(...l.map(h=>h.$to.pos)),d=ANe(n);return kNe(a,{from:o,to:c},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:d})}}})]}});const ENe=()=>({editor:t,view:s})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(s.dom.blur(),(n=window==null?void 0:window.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),TNe=(t=!1)=>({commands:s})=>s.setContent("",t),PNe=()=>({state:t,tr:s,dispatch:n})=>{const{selection:a}=s,{ranges:i}=a;return n&&i.forEach(({$from:l,$to:o})=>{t.doc.nodesBetween(l.pos,o.pos,(c,d)=>{if(c.type.isText)return;const{doc:u,mapping:h}=s,f=u.resolve(h.map(d)),x=u.resolve(h.map(d+c.nodeSize)),b=f.blockRange(x);if(!b)return;const v=qu(b);if(c.type.isTextblock){const{defaultType:w}=f.parent.contentMatchAt(f.index());s.setNodeMarkup(b.start,w)}(v||v===0)&&s.lift(b,v)})}),!0},INe=t=>s=>t(s),MNe=()=>({state:t,dispatch:s})=>d5(t,s),DNe=(t,s)=>({editor:n,tr:a})=>{const{state:i}=n,l=i.doc.slice(t.from,t.to);a.deleteRange(t.from,t.to);const o=a.mapping.map(s);return a.insert(o,l.content),a.setSelection(new kt(a.doc.resolve(Math.max(o-1,0)))),!0},ONe=()=>({tr:t,dispatch:s})=>{const{selection:n}=t,a=n.$anchor.node();if(a.content.size>0)return!1;const i=t.selection.$anchor;for(let l=i.depth;l>0;l-=1)if(i.node(l).type===a.type){if(s){const c=i.before(l),d=i.after(l);t.delete(c,d).scrollIntoView()}return!0}return!1},RNe=t=>({tr:s,state:n,dispatch:a})=>{const i=ea(t,n.schema),l=s.selection.$anchor;for(let o=l.depth;o>0;o-=1)if(l.node(o).type===i){if(a){const d=l.before(o),u=l.after(o);s.delete(d,u).scrollIntoView()}return!0}return!1},LNe=t=>({tr:s,dispatch:n})=>{const{from:a,to:i}=t;return n&&s.delete(a,i),!0},BNe=()=>({state:t,dispatch:s})=>Mv(t,s),FNe=()=>({commands:t})=>t.keyboardShortcut("Enter"),$Ne=()=>({state:t,dispatch:s})=>uU(t,s);function P1(t,s,n={strict:!0}){const a=Object.keys(s);return a.length?a.every(i=>n.strict?s[i]===t[i]:_Ne(s[i])?s[i].test(t[i]):s[i]===t[i]):!0}function dV(t,s,n={}){return t.find(a=>a.type===s&&P1(Object.fromEntries(Object.keys(n).map(i=>[i,a.attrs[i]])),n))}function CM(t,s,n={}){return!!dV(t,s,n)}function T5(t,s,n){var a;if(!t||!s)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(h=>h.type===s))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(h=>h.type===s)||(n=n||((a=i.node.marks[0])===null||a===void 0?void 0:a.attrs),!dV([...i.node.marks],s,n)))return;let o=i.index,c=t.start()+i.offset,d=o+1,u=c+i.node.nodeSize;for(;o>0&&CM([...t.parent.child(o-1).marks],s,n);)o-=1,c-=t.parent.child(o).nodeSize;for(;d<t.parent.childCount&&CM([...t.parent.child(d).marks],s,n);)u+=t.parent.child(d).nodeSize,d+=1;return{from:c,to:u}}function _d(t,s){if(typeof t=="string"){if(!s.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return s.marks[t]}return t}const zNe=(t,s={})=>({tr:n,state:a,dispatch:i})=>{const l=_d(t,a.schema),{doc:o,selection:c}=n,{$from:d,from:u,to:h}=c;if(i){const f=T5(d,l,s);if(f&&f.from<=u&&f.to>=h){const x=kt.create(o,f.from,f.to);n.setSelection(x)}}return!0},UNe=t=>s=>{const n=typeof t=="function"?t(s):t;for(let a=0;a<n.length;a+=1)if(n[a](s))return!0;return!1};function uV(t){return t instanceof kt}function Jd(t=0,s=0,n=0){return Math.min(Math.max(t,s),n)}function VNe(t,s=null){if(!s)return null;const n=Bt.atStart(t),a=Bt.atEnd(t);if(s==="start"||s===!0)return n;if(s==="end")return a;const i=n.from,l=a.to;return s==="all"?kt.create(t,Jd(0,i,l),Jd(t.content.size,i,l)):kt.create(t,Jd(s,i,l),Jd(s,i,l))}function HNe(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function P5(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const WNe=(t=null,s={})=>({editor:n,view:a,tr:i,dispatch:l})=>{s={scrollIntoView:!0,...s};const o=()=>{(P5()||HNe())&&a.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(a.focus(),s!=null&&s.scrollIntoView&&n.commands.scrollIntoView())})};if(a.hasFocus()&&t===null||t===!1)return!0;if(l&&t===null&&!uV(n.state.selection))return o(),!0;const c=VNe(i.doc,t)||n.state.selection,d=n.state.selection.eq(c);return l&&(d||i.setSelection(c),d&&i.storedMarks&&i.setStoredMarks(i.storedMarks),o()),!0},qNe=(t,s)=>n=>t.every((a,i)=>s(a,{...n,index:i})),GNe=(t,s)=>({tr:n,commands:a})=>a.insertContentAt({from:n.selection.from,to:n.selection.to},t,s),hV=t=>{const s=t.childNodes;for(let n=s.length-1;n>=0;n-=1){const a=s[n];a.nodeType===3&&a.nodeValue&&/^(\n\s\s|\n)$/.test(a.nodeValue)?t.removeChild(a):a.nodeType===1&&hV(a)}return t};function pg(t){const s=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(s,"text/html").body;return hV(n)}function mx(t,s,n){if(t instanceof Jc||t instanceof ze)return t;n={slice:!0,parseOptions:{},...n};const a=typeof t=="object"&&t!==null,i=typeof t=="string";if(a)try{if(Array.isArray(t)&&t.length>0)return ze.fromArray(t.map(c=>s.nodeFromJSON(c)));const o=s.nodeFromJSON(t);return n.errorOnInvalidContent&&o.check(),o}catch(l){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:l});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",l),mx("",s,n)}if(i){if(n.errorOnInvalidContent){let o=!1,c="";const d=new Lz({topNode:s.spec.topNode,marks:s.spec.marks,nodes:s.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(o=!0,c=typeof u=="string"?u:u.outerHTML,null)}]}})});if(n.slice?ao.fromSchema(d).parseSlice(pg(t),n.parseOptions):ao.fromSchema(d).parse(pg(t),n.parseOptions),n.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${c}`)})}const l=ao.fromSchema(s);return n.slice?l.parseSlice(pg(t),n.parseOptions).content:l.parse(pg(t),n.parseOptions)}return mx("",s,n)}function KNe(t,s,n){const a=t.steps.length-1;if(a<s)return;const i=t.steps[a];if(!(i instanceof nr||i instanceof ur))return;const l=t.mapping.maps[a];let o=0;l.forEach((c,d,u,h)=>{o===0&&(o=h)}),t.setSelection(Bt.near(t.doc.resolve(o),n))}const YNe=t=>!("type"in t),XNe=(t,s,n)=>({tr:a,dispatch:i,editor:l})=>{var o;if(i){n={parseOptions:l.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let c;const d=_=>{l.emit("contentError",{editor:l,error:_,disableCollaboration:()=>{l.storage.collaboration&&(l.storage.collaboration.isDisabled=!0)}})},u={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!l.options.enableContentCheck&&l.options.emitContentError)try{mx(s,l.schema,{parseOptions:u,errorOnInvalidContent:!0})}catch(_){d(_)}try{c=mx(s,l.schema,{parseOptions:u,errorOnInvalidContent:(o=n.errorOnInvalidContent)!==null&&o!==void 0?o:l.options.enableContentCheck})}catch(_){return d(_),!1}let{from:h,to:f}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},x=!0,b=!0;if((YNe(c)?c:[c]).forEach(_=>{_.check(),x=x?_.isText&&_.marks.length===0:!1,b=b?_.isBlock:!1}),h===f&&b){const{parent:_}=a.doc.resolve(h);_.isTextblock&&!_.type.spec.code&&!_.childCount&&(h-=1,f+=1)}let w;if(x){if(Array.isArray(s))w=s.map(_=>_.text||"").join("");else if(s instanceof ze){let _="";s.forEach(S=>{S.text&&(_+=S.text)}),w=_}else typeof s=="object"&&s&&s.text?w=s.text:w=s;a.insertText(w,h,f)}else w=c,a.replaceWith(h,f,w);n.updateSelection&&KNe(a,a.steps.length-1,-1),n.applyInputRules&&a.setMeta("applyInputRules",{from:h,text:w}),n.applyPasteRules&&a.setMeta("applyPasteRules",{from:h,text:w})}return!0},QNe=()=>({state:t,dispatch:s})=>oU(t,s),ZNe=()=>({state:t,dispatch:s})=>cU(t,s),JNe=()=>({state:t,dispatch:s})=>s5(t,s),ewe=()=>({state:t,dispatch:s})=>a5(t,s),twe=()=>({state:t,dispatch:s,tr:n})=>{try{const a=Km(t.doc,t.selection.$from.pos,-1);return a==null?!1:(n.join(a,2),s&&s(n),!0)}catch{return!1}},swe=()=>({state:t,dispatch:s,tr:n})=>{try{const a=Km(t.doc,t.selection.$from.pos,1);return a==null?!1:(n.join(a,2),s&&s(n),!0)}catch{return!1}},nwe=()=>({state:t,dispatch:s})=>rU(t,s),rwe=()=>({state:t,dispatch:s})=>aU(t,s);function mV(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function awe(t){const s=t.split(/-(?!$)/);let n=s[s.length-1];n==="Space"&&(n=" ");let a,i,l,o;for(let c=0;c<s.length-1;c+=1){const d=s[c];if(/^(cmd|meta|m)$/i.test(d))o=!0;else if(/^a(lt)?$/i.test(d))a=!0;else if(/^(c|ctrl|control)$/i.test(d))i=!0;else if(/^s(hift)?$/i.test(d))l=!0;else if(/^mod$/i.test(d))P5()||mV()?o=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${d}`)}return a&&(n=`Alt-${n}`),i&&(n=`Ctrl-${n}`),o&&(n=`Meta-${n}`),l&&(n=`Shift-${n}`),n}const iwe=t=>({editor:s,view:n,tr:a,dispatch:i})=>{const l=awe(t).split(/-(?!$)/),o=l.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),c=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:l.includes("Alt"),ctrlKey:l.includes("Ctrl"),metaKey:l.includes("Meta"),shiftKey:l.includes("Shift"),bubbles:!0,cancelable:!0}),d=s.captureTransaction(()=>{n.someProp("handleKeyDown",u=>u(n,c))});return d==null||d.steps.forEach(u=>{const h=u.map(a.mapping);h&&i&&a.maybeStep(h)}),!0};function I5(t,s,n={}){const{from:a,to:i,empty:l}=t.selection,o=s?ea(s,t.schema):null,c=[];t.doc.nodesBetween(a,i,(f,x)=>{if(f.isText)return;const b=Math.max(a,x),v=Math.min(i,x+f.nodeSize);c.push({node:f,from:b,to:v})});const d=i-a,u=c.filter(f=>o?o.name===f.node.type.name:!0).filter(f=>P1(f.node.attrs,n,{strict:!1}));return l?!!u.length:u.reduce((f,x)=>f+x.to-x.from,0)>=d}const lwe=(t,s={})=>({state:n,dispatch:a})=>{const i=ea(t,n.schema);return I5(n,i,s)?dU(n,a):!1},owe=()=>({state:t,dispatch:s})=>u5(t,s),cwe=t=>({state:s,dispatch:n})=>{const a=ea(t,s.schema);return bU(a)(s,n)},dwe=()=>({state:t,dispatch:s})=>o5(t,s);function fV(t,s){return s.nodes[t]?"node":s.marks[t]?"mark":null}function kM(t,s){const n=typeof s=="string"?[s]:s;return Object.keys(t).reduce((a,i)=>(n.includes(i)||(a[i]=t[i]),a),{})}const uwe=(t,s)=>({tr:n,state:a,dispatch:i})=>{let l=null,o=null;const c=fV(typeof t=="string"?t:t.name,a.schema);return c?(c==="node"&&(l=ea(t,a.schema)),c==="mark"&&(o=_d(t,a.schema)),i&&n.selection.ranges.forEach(d=>{a.doc.nodesBetween(d.$from.pos,d.$to.pos,(u,h)=>{l&&l===u.type&&n.setNodeMarkup(h,void 0,kM(u.attrs,s)),o&&u.marks.length&&u.marks.forEach(f=>{o===f.type&&n.addMark(h,h+u.nodeSize,o.create(kM(f.attrs,s)))})})}),!0):!1},hwe=()=>({tr:t,dispatch:s})=>(s&&t.scrollIntoView(),!0),mwe=()=>({tr:t,dispatch:s})=>{if(s){const n=new La(t.doc);t.setSelection(n)}return!0},fwe=()=>({state:t,dispatch:s})=>n5(t,s),pwe=()=>({state:t,dispatch:s})=>i5(t,s),xwe=()=>({state:t,dispatch:s})=>hU(t,s),gwe=()=>({state:t,dispatch:s})=>xU(t,s),ywe=()=>({state:t,dispatch:s})=>pU(t,s);function bwe(t,s,n={},a={}){return mx(t,s,{slice:!1,parseOptions:n,errorOnInvalidContent:a.errorOnInvalidContent})}const vwe=(t,s=!1,n={},a={})=>({editor:i,tr:l,dispatch:o,commands:c})=>{var d,u;const{doc:h}=l;if(n.preserveWhitespace!=="full"){const f=bwe(t,i.schema,n,{errorOnInvalidContent:(d=a.errorOnInvalidContent)!==null&&d!==void 0?d:i.options.enableContentCheck});return o&&l.replaceWith(0,h.content.size,f).setMeta("preventUpdate",!s),!0}return o&&l.setMeta("preventUpdate",!s),c.insertContentAt({from:0,to:h.content.size},t,{parseOptions:n,errorOnInvalidContent:(u=a.errorOnInvalidContent)!==null&&u!==void 0?u:i.options.enableContentCheck})};function Nwe(t,s){const n=_d(s,t.schema),{from:a,to:i,empty:l}=t.selection,o=[];l?(t.storedMarks&&o.push(...t.storedMarks),o.push(...t.selection.$head.marks())):t.doc.nodesBetween(a,i,d=>{o.push(...d.marks)});const c=o.find(d=>d.type.name===n.name);return c?{...c.attrs}:{}}function wwe(t){for(let s=0;s<t.edgeCount;s+=1){const{type:n}=t.edge(s);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function jwe(t,s){for(let n=t.depth;n>0;n-=1){const a=t.node(n);if(s(a))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:a}}}function M5(t){return s=>jwe(s.$from,t)}function pV(t,s,n){const a=[];return t===s?n.resolve(t).marks().forEach(i=>{const l=n.resolve(t),o=T5(l,i.type);o&&a.push({mark:i,...o})}):n.nodesBetween(t,s,(i,l)=>{!i||(i==null?void 0:i.nodeSize)===void 0||a.push(...i.marks.map(o=>({from:l,to:l+i.nodeSize,mark:o})))}),a}function gy(t,s,n){return Object.fromEntries(Object.entries(n).filter(([a])=>{const i=t.find(l=>l.type===s&&l.name===a);return i?i.attribute.keepOnSplit:!1}))}function _we(t,s,n={}){const{empty:a,ranges:i}=t.selection,l=s?_d(s,t.schema):null;if(a)return!!(t.storedMarks||t.selection.$from.marks()).filter(f=>l?l.name===f.type.name:!0).find(f=>P1(f.attrs,n,{strict:!1}));let o=0;const c=[];if(i.forEach(({$from:f,$to:x})=>{const b=f.pos,v=x.pos;t.doc.nodesBetween(b,v,(w,_)=>{if(!w.isText&&!w.marks.length)return;const S=Math.max(b,_),k=Math.min(v,_+w.nodeSize),A=k-S;o+=A,c.push(...w.marks.map(T=>({mark:T,from:S,to:k})))})}),o===0)return!1;const d=c.filter(f=>l?l.name===f.mark.type.name:!0).filter(f=>P1(f.mark.attrs,n,{strict:!1})).reduce((f,x)=>f+x.to-x.from,0),u=c.filter(f=>l?f.mark.type!==l&&f.mark.type.excludes(l):!0).reduce((f,x)=>f+x.to-x.from,0);return(d>0?d+u:d)>=o}function AM(t,s){const{nodeExtensions:n}=wNe(s),a=n.find(o=>o.name===t);if(!a)return!1;const i={name:a.name,options:a.options,storage:a.storage},l=or(Yr(a,"group",i));return typeof l!="string"?!1:l.split(" ").includes("list")}function xV(t,{checkChildren:s=!0,ignoreWhitespace:n=!1}={}){var a;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((a=t.text)!==null&&a!==void 0?a:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(s){let i=!0;return t.content.forEach(l=>{i!==!1&&(xV(l,{ignoreWhitespace:n,checkChildren:s})||(i=!1))}),i}return!1}function Swe(t){return t instanceof Pt}function Cwe(t,s,n){var a;const{selection:i}=s;let l=null;if(uV(i)&&(l=i.$cursor),l){const c=(a=t.storedMarks)!==null&&a!==void 0?a:l.marks();return!!n.isInSet(c)||!c.some(d=>d.type.excludes(n))}const{ranges:o}=i;return o.some(({$from:c,$to:d})=>{let u=c.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(c.pos,d.pos,(h,f,x)=>{if(u)return!1;if(h.isInline){const b=!x||x.type.allowsMarkType(n),v=!!n.isInSet(h.marks)||!h.marks.some(w=>w.type.excludes(n));u=b&&v}return!u}),u})}const kwe=(t,s={})=>({tr:n,state:a,dispatch:i})=>{const{selection:l}=n,{empty:o,ranges:c}=l,d=_d(t,a.schema);if(i)if(o){const u=Nwe(a,d);n.addStoredMark(d.create({...u,...s}))}else c.forEach(u=>{const h=u.$from.pos,f=u.$to.pos;a.doc.nodesBetween(h,f,(x,b)=>{const v=Math.max(b,h),w=Math.min(b+x.nodeSize,f);x.marks.find(S=>S.type===d)?x.marks.forEach(S=>{d===S.type&&n.addMark(v,w,d.create({...S.attrs,...s}))}):n.addMark(v,w,d.create(s))})});return Cwe(a,n,d)},Awe=(t,s)=>({tr:n})=>(n.setMeta(t,s),!0),Ewe=(t,s={})=>({state:n,dispatch:a,chain:i})=>{const l=ea(t,n.schema);let o;return n.selection.$anchor.sameParent(n.selection.$head)&&(o=n.selection.$anchor.parent.attrs),l.isTextblock?i().command(({commands:c})=>j1(l,{...o,...s})(n)?!0:c.clearNodes()).command(({state:c})=>j1(l,{...o,...s})(c,a)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Twe=t=>({tr:s,dispatch:n})=>{if(n){const{doc:a}=s,i=Jd(t,0,a.content.size),l=Pt.create(a,i);s.setSelection(l)}return!0},Pwe=t=>({tr:s,dispatch:n})=>{if(n){const{doc:a}=s,{from:i,to:l}=typeof t=="number"?{from:t,to:t}:t,o=kt.atStart(a).from,c=kt.atEnd(a).to,d=Jd(i,o,c),u=Jd(l,o,c),h=kt.create(a,d,u);s.setSelection(h)}return!0},Iwe=t=>({state:s,dispatch:n})=>{const a=ea(t,s.schema);return vU(a)(s,n)};function EM(t,s){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const a=n.filter(i=>s==null?void 0:s.includes(i.type.name));t.tr.ensureMarks(a)}}const Mwe=({keepMarks:t=!0}={})=>({tr:s,state:n,dispatch:a,editor:i})=>{const{selection:l,doc:o}=s,{$from:c,$to:d}=l,u=i.extensionManager.attributes,h=gy(u,c.node().type.name,c.node().attrs);if(l instanceof Pt&&l.node.isBlock)return!c.parentOffset||!mi(o,c.pos)?!1:(a&&(t&&EM(n,i.extensionManager.splittableMarks),s.split(c.pos).scrollIntoView()),!0);if(!c.parent.isBlock)return!1;const f=d.parentOffset===d.parent.content.size,x=c.depth===0?void 0:wwe(c.node(-1).contentMatchAt(c.indexAfter(-1)));let b=f&&x?[{type:x,attrs:h}]:void 0,v=mi(s.doc,s.mapping.map(c.pos),1,b);if(!b&&!v&&mi(s.doc,s.mapping.map(c.pos),1,x?[{type:x}]:void 0)&&(v=!0,b=x?[{type:x,attrs:h}]:void 0),a){if(v&&(l instanceof kt&&s.deleteSelection(),s.split(s.mapping.map(c.pos),1,b),x&&!f&&!c.parentOffset&&c.parent.type!==x)){const w=s.mapping.map(c.before()),_=s.doc.resolve(w);c.node(-1).canReplaceWith(_.index(),_.index()+1,x)&&s.setNodeMarkup(s.mapping.map(c.before()),x)}t&&EM(n,i.extensionManager.splittableMarks),s.scrollIntoView()}return v},Dwe=(t,s={})=>({tr:n,state:a,dispatch:i,editor:l})=>{var o;const c=ea(t,a.schema),{$from:d,$to:u}=a.selection,h=a.selection.node;if(h&&h.isBlock||d.depth<2||!d.sameParent(u))return!1;const f=d.node(-1);if(f.type!==c)return!1;const x=l.extensionManager.attributes;if(d.parent.content.size===0&&d.node(-1).childCount===d.indexAfter(-1)){if(d.depth===2||d.node(-3).type!==c||d.index(-2)!==d.node(-2).childCount-1)return!1;if(i){let S=ze.empty;const k=d.index(-1)?1:d.index(-2)?2:3;for(let I=d.depth-k;I>=d.depth-3;I-=1)S=ze.from(d.node(I).copy(S));const A=d.indexAfter(-1)<d.node(-2).childCount?1:d.indexAfter(-2)<d.node(-3).childCount?2:3,T={...gy(x,d.node().type.name,d.node().attrs),...s},P=((o=c.contentMatch.defaultType)===null||o===void 0?void 0:o.createAndFill(T))||void 0;S=S.append(ze.from(c.createAndFill(null,P)||void 0));const O=d.before(d.depth-(k-1));n.replace(O,d.after(-A),new ct(S,4-k,0));let D=-1;n.doc.nodesBetween(O,n.doc.content.size,(I,M)=>{if(D>-1)return!1;I.isTextblock&&I.content.size===0&&(D=M+1)}),D>-1&&n.setSelection(kt.near(n.doc.resolve(D))),n.scrollIntoView()}return!0}const b=u.pos===d.end()?f.contentMatchAt(0).defaultType:null,v={...gy(x,f.type.name,f.attrs),...s},w={...gy(x,d.node().type.name,d.node().attrs),...s};n.delete(d.pos,u.pos);const _=b?[{type:c,attrs:v},{type:b,attrs:w}]:[{type:c,attrs:v}];if(!mi(n.doc,d.pos,2))return!1;if(i){const{selection:S,storedMarks:k}=a,{splittableMarks:A}=l.extensionManager,T=k||S.$to.parentOffset&&S.$from.marks();if(n.split(d.pos,2,_).scrollIntoView(),!T||!i)return!0;const P=T.filter(O=>A.includes(O.type.name));n.ensureMarks(P)}return!0},Tj=(t,s)=>{const n=M5(o=>o.type===s)(t.selection);if(!n)return!0;const a=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(a===void 0)return!0;const i=t.doc.nodeAt(a);return n.node.type===(i==null?void 0:i.type)&&go(t.doc,n.pos)&&t.join(n.pos),!0},Pj=(t,s)=>{const n=M5(o=>o.type===s)(t.selection);if(!n)return!0;const a=t.doc.resolve(n.start).after(n.depth);if(a===void 0)return!0;const i=t.doc.nodeAt(a);return n.node.type===(i==null?void 0:i.type)&&go(t.doc,a)&&t.join(a),!0},Owe=(t,s,n,a={})=>({editor:i,tr:l,state:o,dispatch:c,chain:d,commands:u,can:h})=>{const{extensions:f,splittableMarks:x}=i.extensionManager,b=ea(t,o.schema),v=ea(s,o.schema),{selection:w,storedMarks:_}=o,{$from:S,$to:k}=w,A=S.blockRange(k),T=_||w.$to.parentOffset&&w.$from.marks();if(!A)return!1;const P=M5(O=>AM(O.type.name,f))(w);if(A.depth>=1&&P&&A.depth-P.depth<=1){if(P.node.type===b)return u.liftListItem(v);if(AM(P.node.type.name,f)&&b.validContent(P.node.content)&&c)return d().command(()=>(l.setNodeMarkup(P.pos,b),!0)).command(()=>Tj(l,b)).command(()=>Pj(l,b)).run()}return!n||!T||!c?d().command(()=>h().wrapInList(b,a)?!0:u.clearNodes()).wrapInList(b,a).command(()=>Tj(l,b)).command(()=>Pj(l,b)).run():d().command(()=>{const O=h().wrapInList(b,a),D=T.filter(I=>x.includes(I.type.name));return l.ensureMarks(D),O?!0:u.clearNodes()}).wrapInList(b,a).command(()=>Tj(l,b)).command(()=>Pj(l,b)).run()},Rwe=(t,s={},n={})=>({state:a,commands:i})=>{const{extendEmptyMarkRange:l=!1}=n,o=_d(t,a.schema);return _we(a,o,s)?i.unsetMark(o,{extendEmptyMarkRange:l}):i.setMark(o,s)},Lwe=(t,s,n={})=>({state:a,commands:i})=>{const l=ea(t,a.schema),o=ea(s,a.schema),c=I5(a,l,n);let d;return a.selection.$anchor.sameParent(a.selection.$head)&&(d=a.selection.$anchor.parent.attrs),c?i.setNode(o,d):i.setNode(l,{...d,...n})},Bwe=(t,s={})=>({state:n,commands:a})=>{const i=ea(t,n.schema);return I5(n,i,s)?a.lift(i):a.wrapIn(i,s)},Fwe=()=>({state:t,dispatch:s})=>{const n=t.plugins;for(let a=0;a<n.length;a+=1){const i=n[a];let l;if(i.spec.isInputRules&&(l=i.getState(t))){if(s){const o=t.tr,c=l.transform;for(let d=c.steps.length-1;d>=0;d-=1)o.step(c.steps[d].invert(c.docs[d]));if(l.text){const d=o.doc.resolve(l.from).marks();o.replaceWith(l.from,l.to,t.schema.text(l.text,d))}else o.delete(l.from,l.to)}return!0}}return!1},$we=()=>({tr:t,dispatch:s})=>{const{selection:n}=t,{empty:a,ranges:i}=n;return a||s&&i.forEach(l=>{t.removeMark(l.$from.pos,l.$to.pos)}),!0},zwe=(t,s={})=>({tr:n,state:a,dispatch:i})=>{var l;const{extendEmptyMarkRange:o=!1}=s,{selection:c}=n,d=_d(t,a.schema),{$from:u,empty:h,ranges:f}=c;if(!i)return!0;if(h&&o){let{from:x,to:b}=c;const v=(l=u.marks().find(_=>_.type===d))===null||l===void 0?void 0:l.attrs,w=T5(u,d,v);w&&(x=w.from,b=w.to),n.removeMark(x,b,d)}else f.forEach(x=>{n.removeMark(x.$from.pos,x.$to.pos,d)});return n.removeStoredMark(d),!0},Uwe=(t,s={})=>({tr:n,state:a,dispatch:i})=>{let l=null,o=null;const c=fV(typeof t=="string"?t:t.name,a.schema);return c?(c==="node"&&(l=ea(t,a.schema)),c==="mark"&&(o=_d(t,a.schema)),i&&n.selection.ranges.forEach(d=>{const u=d.$from.pos,h=d.$to.pos;let f,x,b,v;n.selection.empty?a.doc.nodesBetween(u,h,(w,_)=>{l&&l===w.type&&(b=Math.max(_,u),v=Math.min(_+w.nodeSize,h),f=_,x=w)}):a.doc.nodesBetween(u,h,(w,_)=>{_<u&&l&&l===w.type&&(b=Math.max(_,u),v=Math.min(_+w.nodeSize,h),f=_,x=w),_>=u&&_<=h&&(l&&l===w.type&&n.setNodeMarkup(_,void 0,{...w.attrs,...s}),o&&w.marks.length&&w.marks.forEach(S=>{if(o===S.type){const k=Math.max(_,u),A=Math.min(_+w.nodeSize,h);n.addMark(k,A,o.create({...S.attrs,...s}))}}))}),x&&(f!==void 0&&n.setNodeMarkup(f,void 0,{...x.attrs,...s}),o&&x.marks.length&&x.marks.forEach(w=>{o===w.type&&n.addMark(b,v,o.create({...w.attrs,...s}))}))}),!0):!1},Vwe=(t,s={})=>({state:n,dispatch:a})=>{const i=ea(t,n.schema);return gU(i,s)(n,a)},Hwe=(t,s={})=>({state:n,dispatch:a})=>{const i=ea(t,n.schema);return yU(i,s)(n,a)};var Wwe=Object.freeze({__proto__:null,blur:ENe,clearContent:TNe,clearNodes:PNe,command:INe,createParagraphNear:MNe,cut:DNe,deleteCurrentNode:ONe,deleteNode:RNe,deleteRange:LNe,deleteSelection:BNe,enter:FNe,exitCode:$Ne,extendMarkRange:zNe,first:UNe,focus:WNe,forEach:qNe,insertContent:GNe,insertContentAt:XNe,joinBackward:JNe,joinDown:ZNe,joinForward:ewe,joinItemBackward:twe,joinItemForward:swe,joinTextblockBackward:nwe,joinTextblockForward:rwe,joinUp:QNe,keyboardShortcut:iwe,lift:lwe,liftEmptyBlock:owe,liftListItem:cwe,newlineInCode:dwe,resetAttributes:uwe,scrollIntoView:hwe,selectAll:mwe,selectNodeBackward:fwe,selectNodeForward:pwe,selectParentNode:xwe,selectTextblockEnd:gwe,selectTextblockStart:ywe,setContent:vwe,setMark:kwe,setMeta:Awe,setNode:Ewe,setNodeSelection:Twe,setTextSelection:Pwe,sinkListItem:Iwe,splitBlock:Mwe,splitListItem:Dwe,toggleList:Owe,toggleMark:Rwe,toggleNode:Lwe,toggleWrap:Bwe,undoInputRule:Fwe,unsetAllMarks:$we,unsetMark:zwe,updateAttributes:Uwe,wrapIn:Vwe,wrapInList:Hwe});pa.create({name:"commands",addCommands(){return{...Wwe}}});pa.create({name:"drop",addProseMirrorPlugins(){return[new Ln({key:new Bn("tiptapDrop"),props:{handleDrop:(t,s,n,a)=>{this.editor.emit("drop",{editor:this.editor,event:s,slice:n,moved:a})}}})]}});pa.create({name:"editable",addProseMirrorPlugins(){return[new Ln({key:new Bn("editable"),props:{editable:()=>this.editor.options.editable}})]}});const qwe=new Bn("focusEvents");pa.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new Ln({key:qwe,props:{handleDOMEvents:{focus:(s,n)=>{t.isFocused=!0;const a=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return s.dispatch(a),!1},blur:(s,n)=>{t.isFocused=!1;const a=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return s.dispatch(a),!1}}}})]}});pa.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:c})=>{const{selection:d,doc:u}=c,{empty:h,$anchor:f}=d,{pos:x,parent:b}=f,v=f.parent.isTextblock&&x>0?c.doc.resolve(x-1):f,w=v.parent.type.spec.isolating,_=f.pos-f.parentOffset,S=w&&v.parent.childCount===1?_===f.pos:Bt.atStart(u).from===x;return!h||!b.type.isTextblock||b.textContent.length||!S||S&&f.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),s=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),a={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:s,"Mod-Delete":s,"Mod-a":()=>this.editor.commands.selectAll()},i={...a},l={...a,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":s,"Ctrl-Alt-Backspace":s,"Alt-Delete":s,"Alt-d":s,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return P5()||mV()?l:i},addProseMirrorPlugins(){return[new Ln({key:new Bn("clearDocument"),appendTransaction:(t,s,n)=>{if(t.some(w=>w.getMeta("composition")))return;const a=t.some(w=>w.docChanged)&&!s.doc.eq(n.doc),i=t.some(w=>w.getMeta("preventClearDocument"));if(!a||i)return;const{empty:l,from:o,to:c}=s.selection,d=Bt.atStart(s.doc).from,u=Bt.atEnd(s.doc).to;if(l||!(o===d&&c===u)||!xV(n.doc))return;const x=n.tr,b=cV({state:n,transaction:x}),{commands:v}=new NNe({editor:this.editor,state:b});if(v.clearNodes(),!!x.steps.length)return x}})]}});pa.create({name:"paste",addProseMirrorPlugins(){return[new Ln({key:new Bn("tiptapPaste"),props:{handlePaste:(t,s,n)=>{this.editor.emit("paste",{editor:this.editor,event:s,slice:n})}}})]}});pa.create({name:"tabindex",addProseMirrorPlugins(){return[new Ln({key:new Bn("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});function bm(t){return new Rv({find:t.find,handler:({state:s,range:n,match:a})=>{const i=or(t.getAttributes,void 0,a);if(i===!1||i===null)return null;const{tr:l}=s,o=a[a.length-1],c=a[0];if(o){const d=c.search(/\S/),u=n.from+c.indexOf(o),h=u+o.length;if(pV(n.from,n.to,s.doc).filter(b=>b.mark.type.excluded.find(w=>w===t.type&&w!==b.mark.type)).filter(b=>b.to>u).length)return null;h<n.to&&l.delete(h,n.to),u>n.from&&l.delete(n.from+d,u);const x=n.from+d+o.length;l.addMark(n.from+d,x,t.type.create(i||{})),l.removeStoredMark(t.type)}}})}function Gwe(t){return new Rv({find:t.find,handler:({state:s,range:n,match:a})=>{const i=or(t.getAttributes,void 0,a)||{},{tr:l}=s,o=n.from;let c=n.to;const d=t.type.create(i);if(a[1]){const u=a[0].lastIndexOf(a[1]);let h=o+u;h>c?h=c:c=h+a[1].length;const f=a[0][a[0].length-1];l.insertText(f,o+a[0].length-1),l.replaceWith(h,c,d)}else if(a[0]){const u=t.type.isInline?o:o-1;l.insert(u,t.type.create(i)).delete(l.mapping.map(o),l.mapping.map(c))}l.scrollIntoView()}})}function PS(t){return new Rv({find:t.find,handler:({state:s,range:n,match:a})=>{const i=s.doc.resolve(n.from),l=or(t.getAttributes,void 0,a)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;s.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,l)}})}function fx(t){return new Rv({find:t.find,handler:({state:s,range:n,match:a,chain:i})=>{const l=or(t.getAttributes,void 0,a)||{},o=s.tr.delete(n.from,n.to),d=o.doc.resolve(n.from).blockRange(),u=d&&e5(d,t.type,l);if(!u)return null;if(o.wrap(d,u),t.keepMarks&&t.editor){const{selection:f,storedMarks:x}=s,{splittableMarks:b}=t.editor.extensionManager,v=x||f.$to.parentOffset&&f.$from.marks();if(v){const w=v.filter(_=>b.includes(_.type.name));o.ensureMarks(w)}}if(t.keepAttributes){const f=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(f,l).run()}const h=o.doc.resolve(n.from-1).nodeBefore;h&&h.type===t.type&&go(o.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(a,h))&&o.join(n.from-1)}})}let El=class IS{constructor(s={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...s},this.name=this.config.name,s.defaultOptions&&Object.keys(s.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=or(Yr(this,"addOptions",{name:this.name}))),this.storage=or(Yr(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(s={}){return new IS(s)}configure(s={}){const n=this.extend({...this.config,addOptions:()=>Lv(this.options,s)});return n.name=this.name,n.parent=this.parent,n}extend(s={}){const n=new IS(s);return n.parent=this,this.child=n,n.name=s.name?s.name:n.parent.name,s.defaultOptions&&Object.keys(s.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=or(Yr(n,"addOptions",{name:n.name})),n.storage=or(Yr(n,"addStorage",{name:n.name,options:n.options})),n}};function vm(t){return new CNe({find:t.find,handler:({state:s,range:n,match:a,pasteEvent:i})=>{const l=or(t.getAttributes,void 0,a,i);if(l===!1||l===null)return null;const{tr:o}=s,c=a[a.length-1],d=a[0];let u=n.to;if(c){const h=d.search(/\S/),f=n.from+d.indexOf(c),x=f+c.length;if(pV(n.from,n.to,s.doc).filter(v=>v.mark.type.excluded.find(_=>_===t.type&&_!==v.mark.type)).filter(v=>v.to>f).length)return null;x<n.to&&o.delete(x,n.to),f>n.from&&o.delete(n.from+h,f),u=n.from+h+c.length,o.addMark(n.from+h,u,t.type.create(l||{})),o.removeStoredMark(t.type)}}})}function Kwe(t,s){const{selection:n}=t,{$from:a}=n;if(n instanceof Pt){const l=a.index();return a.parent.canReplaceWith(l,l+1,s)}let i=a.depth;for(;i>=0;){const l=a.index(i);if(a.node(i).contentMatchAt(l).matchType(s))return!0;i-=1}return!1}const Ywe=/^\s*>\s$/,Xwe=El.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return["blockquote",Ua(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[fx({find:Ywe,type:this.type})]}}),Qwe=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,Zwe=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,Jwe=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,eje=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,tje=Iu.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",Ua(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[bm({find:Qwe,type:this.type}),bm({find:Jwe,type:this.type})]},addPasteRules(){return[vm({find:Zwe,type:this.type}),vm({find:eje,type:this.type})]}}),sje="listItem",TM="textStyle",PM=/^\s*([-+*])\s$/,nje=El.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",Ua(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t,chain:s})=>this.options.keepAttributes?s().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(sje,this.editor.getAttributes(TM)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=fx({find:PM,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=fx({find:PM,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(TM),editor:this.editor})),[t]}}),rje=/(^|[^`])`([^`]+)`(?!`)/,aje=/(^|[^`])`([^`]+)`(?!`)/g,ije=Iu.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",Ua(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[bm({find:rje,type:this.type})]},addPasteRules(){return[vm({find:aje,type:this.type})]}}),lje=/^```([a-z]+)?[\s\n]$/,oje=/^~~~([a-z]+)?[\s\n]$/,cje=El.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var s;const{languageClassPrefix:n}=this.options,l=[...((s=t.firstElementChild)===null||s===void 0?void 0:s.classList)||[]].filter(o=>o.startsWith(n)).map(o=>o.replace(n,""))[0];return l||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:s}){return["pre",Ua(this.options.HTMLAttributes,s),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:s})=>s.setNode(this.name,t),toggleCodeBlock:t=>({commands:s})=>s.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:s}=this.editor.state.selection,n=s.pos===1;return!t||s.parent.type.name!==this.name?!1:n||!s.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:s}=t,{selection:n}=s,{$from:a,empty:i}=n;if(!i||a.parent.type!==this.type)return!1;const l=a.parentOffset===a.parent.nodeSize-2,o=a.parent.textContent.endsWith(`

`);return!l||!o?!1:t.chain().command(({tr:c})=>(c.delete(a.pos-2,a.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:s}=t,{selection:n,doc:a}=s,{$from:i,empty:l}=n;if(!l||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const c=i.after();return c===void 0?!1:a.nodeAt(c)?t.commands.command(({tr:u})=>(u.setSelection(Bt.near(a.resolve(c))),!0)):t.commands.exitCode()}}},addInputRules(){return[PS({find:lje,type:this.type,getAttributes:t=>({language:t[1]})}),PS({find:oje,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new Ln({key:new Bn("codeBlockVSCodeHandler"),props:{handlePaste:(t,s)=>{if(!s.clipboardData||this.editor.isActive(this.type.name))return!1;const n=s.clipboardData.getData("text/plain"),a=s.clipboardData.getData("vscode-editor-data"),i=a?JSON.parse(a):void 0,l=i==null?void 0:i.mode;if(!n||!l)return!1;const{tr:o,schema:c}=t.state,d=c.text(n.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:l},d)),o.selection.$from.parent.type!==this.type&&o.setSelection(kt.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),t.dispatch(o),!0}}})]}}),dje=El.create({name:"doc",topNode:!0,content:"block+"});function uje(t={}){return new Ln({view(s){return new hje(s,t)}})}class hje{constructor(s,n){var a;this.editorView=s,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(a=n.width)!==null&&a!==void 0?a:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let l=o=>{this[i](o)};return s.dom.addEventListener(i,l),{name:i,handler:l}})}destroy(){this.handlers.forEach(({name:s,handler:n})=>this.editorView.dom.removeEventListener(s,n))}update(s,n){this.cursorPos!=null&&n.doc!=s.state.doc&&(this.cursorPos>s.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(s){s!=this.cursorPos&&(this.cursorPos=s,s==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let s=this.editorView.state.doc.resolve(this.cursorPos),n=!s.parent.inlineContent,a,i=this.editorView.dom,l=i.getBoundingClientRect(),o=l.width/i.offsetWidth,c=l.height/i.offsetHeight;if(n){let f=s.nodeBefore,x=s.nodeAfter;if(f||x){let b=this.editorView.nodeDOM(this.cursorPos-(f?f.nodeSize:0));if(b){let v=b.getBoundingClientRect(),w=f?v.bottom:v.top;f&&x&&(w=(w+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let _=this.width/2*c;a={left:v.left,right:v.right,top:w-_,bottom:w+_}}}}if(!a){let f=this.editorView.coordsAtPos(this.cursorPos),x=this.width/2*o;a={left:f.left-x,right:f.left+x,top:f.top,bottom:f.bottom}}let d=this.editorView.dom.offsetParent;this.element||(this.element=d.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let u,h;if(!d||d==document.body&&getComputedStyle(d).position=="static")u=-pageXOffset,h=-pageYOffset;else{let f=d.getBoundingClientRect(),x=f.width/d.offsetWidth,b=f.height/d.offsetHeight;u=f.left-d.scrollLeft*x,h=f.top-d.scrollTop*b}this.element.style.left=(a.left-u)/o+"px",this.element.style.top=(a.top-h)/c+"px",this.element.style.width=(a.right-a.left)/o+"px",this.element.style.height=(a.bottom-a.top)/c+"px"}scheduleRemoval(s){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),s)}dragover(s){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:s.clientX,top:s.clientY}),a=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),i=a&&a.type.spec.disableDropCursor,l=typeof i=="function"?i(this.editorView,n,s):i;if(n&&!l){let o=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let c=Kz(this.editorView.state.doc,o,this.editorView.dragging.slice);c!=null&&(o=c)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(s){this.editorView.dom.contains(s.relatedTarget)||this.setCursor(null)}}const mje=pa.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[uje(this.options)]}});class _n extends Bt{constructor(s){super(s,s)}map(s,n){let a=s.resolve(n.map(this.head));return _n.valid(a)?new _n(a):Bt.near(a)}content(){return ct.empty}eq(s){return s instanceof _n&&s.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(s,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new _n(s.resolve(n.pos))}getBookmark(){return new D5(this.anchor)}static valid(s){let n=s.parent;if(n.isTextblock||!fje(s)||!pje(s))return!1;let a=n.type.spec.allowGapCursor;if(a!=null)return a;let i=n.contentMatchAt(s.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(s,n,a=!1){e:for(;;){if(!a&&_n.valid(s))return s;let i=s.pos,l=null;for(let o=s.depth;;o--){let c=s.node(o);if(n>0?s.indexAfter(o)<c.childCount:s.index(o)>0){l=c.child(n>0?s.indexAfter(o):s.index(o)-1);break}else if(o==0)return null;i+=n;let d=s.doc.resolve(i);if(_n.valid(d))return d}for(;;){let o=n>0?l.firstChild:l.lastChild;if(!o){if(l.isAtom&&!l.isText&&!Pt.isSelectable(l)){s=s.doc.resolve(i+l.nodeSize*n),a=!1;continue e}break}l=o,i+=n;let c=s.doc.resolve(i);if(_n.valid(c))return c}return null}}}_n.prototype.visible=!1;_n.findFrom=_n.findGapCursorFrom;Bt.jsonID("gapcursor",_n);class D5{constructor(s){this.pos=s}map(s){return new D5(s.map(this.pos))}resolve(s){let n=s.resolve(this.pos);return _n.valid(n)?new _n(n):Bt.near(n)}}function gV(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}function fje(t){for(let s=t.depth;s>=0;s--){let n=t.index(s),a=t.node(s);if(n==0){if(a.type.spec.isolating)return!0;continue}for(let i=a.child(n-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||gV(i.type))return!0;if(i.inlineContent)return!1}}return!0}function pje(t){for(let s=t.depth;s>=0;s--){let n=t.indexAfter(s),a=t.node(s);if(n==a.childCount){if(a.type.spec.isolating)return!0;continue}for(let i=a.child(n);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||gV(i.type))return!0;if(i.inlineContent)return!1}}return!0}function xje(){return new Ln({props:{decorations:vje,createSelectionBetween(t,s,n){return s.pos==n.pos&&_n.valid(n)?new _n(n):null},handleClick:yje,handleKeyDown:gje,handleDOMEvents:{beforeinput:bje}}})}const gje=WU({ArrowLeft:xg("horiz",-1),ArrowRight:xg("horiz",1),ArrowUp:xg("vert",-1),ArrowDown:xg("vert",1)});function xg(t,s){const n=t=="vert"?s>0?"down":"up":s>0?"right":"left";return function(a,i,l){let o=a.selection,c=s>0?o.$to:o.$from,d=o.empty;if(o instanceof kt){if(!l.endOfTextblock(n)||c.depth==0)return!1;d=!1,c=a.doc.resolve(s>0?c.after():c.before())}let u=_n.findGapCursorFrom(c,s,d);return u?(i&&i(a.tr.setSelection(new _n(u))),!0):!1}}function yje(t,s,n){if(!t||!t.editable)return!1;let a=t.state.doc.resolve(s);if(!_n.valid(a))return!1;let i=t.posAtCoords({left:n.clientX,top:n.clientY});return i&&i.inside>-1&&Pt.isSelectable(t.state.doc.nodeAt(i.inside))?!1:(t.dispatch(t.state.tr.setSelection(new _n(a))),!0)}function bje(t,s){if(s.inputType!="insertCompositionText"||!(t.state.selection instanceof _n))return!1;let{$from:n}=t.state.selection,a=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!a)return!1;let i=ze.empty;for(let o=a.length-1;o>=0;o--)i=ze.from(a[o].createAndFill(null,i));let l=t.state.tr.replace(n.pos,n.pos,new ct(i,0,0));return l.setSelection(kt.near(l.doc.resolve(n.pos+1))),t.dispatch(l),!1}function vje(t){if(!(t.selection instanceof _n))return null;let s=document.createElement("div");return s.className="ProseMirror-gapcursor",In.create(t.doc,[di.widget(t.selection.head,s,{key:"gapcursor"})])}const Nje=pa.create({name:"gapCursor",addProseMirrorPlugins(){return[xje()]},extendNodeSchema(t){var s;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(s=or(Yr(t,"allowGapCursor",n)))!==null&&s!==void 0?s:null}}}),wje=El.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",Ua(this.options.HTMLAttributes,t)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:t,chain:s,state:n,editor:a})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:i,storedMarks:l}=n;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:c}=a.extensionManager,d=l||i.$to.parentOffset&&i.$from.marks();return s().insertContent({type:this.name}).command(({tr:u,dispatch:h})=>{if(h&&d&&o){const f=d.filter(x=>c.includes(x.type.name));u.ensureMarks(f)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),jje=El.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:s}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,Ua(this.options.HTMLAttributes,s),0]},addCommands(){return{setHeading:t=>({commands:s})=>this.options.levels.includes(t.level)?s.setNode(this.name,t):!1,toggleHeading:t=>({commands:s})=>this.options.levels.includes(t.level)?s.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,s)=>({...t,[`Mod-Alt-${s}`]:()=>this.editor.commands.toggleHeading({level:s})}),{})},addInputRules(){return this.options.levels.map(t=>PS({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}});var I1=200,Nr=function(){};Nr.prototype.append=function(s){return s.length?(s=Nr.from(s),!this.length&&s||s.length<I1&&this.leafAppend(s)||this.length<I1&&s.leafPrepend(this)||this.appendInner(s)):this};Nr.prototype.prepend=function(s){return s.length?Nr.from(s).append(this):this};Nr.prototype.appendInner=function(s){return new _je(this,s)};Nr.prototype.slice=function(s,n){return s===void 0&&(s=0),n===void 0&&(n=this.length),s>=n?Nr.empty:this.sliceInner(Math.max(0,s),Math.min(this.length,n))};Nr.prototype.get=function(s){if(!(s<0||s>=this.length))return this.getInner(s)};Nr.prototype.forEach=function(s,n,a){n===void 0&&(n=0),a===void 0&&(a=this.length),n<=a?this.forEachInner(s,n,a,0):this.forEachInvertedInner(s,n,a,0)};Nr.prototype.map=function(s,n,a){n===void 0&&(n=0),a===void 0&&(a=this.length);var i=[];return this.forEach(function(l,o){return i.push(s(l,o))},n,a),i};Nr.from=function(s){return s instanceof Nr?s:s&&s.length?new yV(s):Nr.empty};var yV=function(t){function s(a){t.call(this),this.values=a}t&&(s.__proto__=t),s.prototype=Object.create(t&&t.prototype),s.prototype.constructor=s;var n={length:{configurable:!0},depth:{configurable:!0}};return s.prototype.flatten=function(){return this.values},s.prototype.sliceInner=function(i,l){return i==0&&l==this.length?this:new s(this.values.slice(i,l))},s.prototype.getInner=function(i){return this.values[i]},s.prototype.forEachInner=function(i,l,o,c){for(var d=l;d<o;d++)if(i(this.values[d],c+d)===!1)return!1},s.prototype.forEachInvertedInner=function(i,l,o,c){for(var d=l-1;d>=o;d--)if(i(this.values[d],c+d)===!1)return!1},s.prototype.leafAppend=function(i){if(this.length+i.length<=I1)return new s(this.values.concat(i.flatten()))},s.prototype.leafPrepend=function(i){if(this.length+i.length<=I1)return new s(i.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(s.prototype,n),s}(Nr);Nr.empty=new yV([]);var _je=function(t){function s(n,a){t.call(this),this.left=n,this.right=a,this.length=n.length+a.length,this.depth=Math.max(n.depth,a.depth)+1}return t&&(s.__proto__=t),s.prototype=Object.create(t&&t.prototype),s.prototype.constructor=s,s.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},s.prototype.getInner=function(a){return a<this.left.length?this.left.get(a):this.right.get(a-this.left.length)},s.prototype.forEachInner=function(a,i,l,o){var c=this.left.length;if(i<c&&this.left.forEachInner(a,i,Math.min(l,c),o)===!1||l>c&&this.right.forEachInner(a,Math.max(i-c,0),Math.min(this.length,l)-c,o+c)===!1)return!1},s.prototype.forEachInvertedInner=function(a,i,l,o){var c=this.left.length;if(i>c&&this.right.forEachInvertedInner(a,i-c,Math.max(l,c)-c,o+c)===!1||l<c&&this.left.forEachInvertedInner(a,Math.min(i,c),l,o)===!1)return!1},s.prototype.sliceInner=function(a,i){if(a==0&&i==this.length)return this;var l=this.left.length;return i<=l?this.left.slice(a,i):a>=l?this.right.slice(a-l,i-l):this.left.slice(a,l).append(this.right.slice(0,i-l))},s.prototype.leafAppend=function(a){var i=this.right.leafAppend(a);if(i)return new s(this.left,i)},s.prototype.leafPrepend=function(a){var i=this.left.leafPrepend(a);if(i)return new s(i,this.right)},s.prototype.appendInner=function(a){return this.left.depth>=Math.max(this.right.depth,a.depth)+1?new s(this.left,new s(this.right,a)):new s(this,a)},s}(Nr);const Sje=500;class ul{constructor(s,n){this.items=s,this.eventCount=n}popEvent(s,n){if(this.eventCount==0)return null;let a=this.items.length;for(;;a--)if(this.items.get(a-1).selection){--a;break}let i,l;n&&(i=this.remapping(a,this.items.length),l=i.maps.length);let o=s.tr,c,d,u=[],h=[];return this.items.forEach((f,x)=>{if(!f.step){i||(i=this.remapping(a,x+1),l=i.maps.length),l--,h.push(f);return}if(i){h.push(new Hl(f.map));let b=f.step.map(i.slice(l)),v;b&&o.maybeStep(b).doc&&(v=o.mapping.maps[o.mapping.maps.length-1],u.push(new Hl(v,void 0,void 0,u.length+h.length))),l--,v&&i.appendMap(v,l)}else o.maybeStep(f.step);if(f.selection)return c=i?f.selection.map(i.slice(l)):f.selection,d=new ul(this.items.slice(0,a).append(h.reverse().concat(u)),this.eventCount-1),!1},this.items.length,0),{remaining:d,transform:o,selection:c}}addTransform(s,n,a,i){let l=[],o=this.eventCount,c=this.items,d=!i&&c.length?c.get(c.length-1):null;for(let h=0;h<s.steps.length;h++){let f=s.steps[h].invert(s.docs[h]),x=new Hl(s.mapping.maps[h],f,n),b;(b=d&&d.merge(x))&&(x=b,h?l.pop():c=c.slice(0,c.length-1)),l.push(x),n&&(o++,n=void 0),i||(d=x)}let u=o-a.depth;return u>kje&&(c=Cje(c,u),o-=u),new ul(c.append(l),o)}remapping(s,n){let a=new ox;return this.items.forEach((i,l)=>{let o=i.mirrorOffset!=null&&l-i.mirrorOffset>=s?a.maps.length-i.mirrorOffset:void 0;a.appendMap(i.map,o)},s,n),a}addMaps(s){return this.eventCount==0?this:new ul(this.items.append(s.map(n=>new Hl(n))),this.eventCount)}rebased(s,n){if(!this.eventCount)return this;let a=[],i=Math.max(0,this.items.length-n),l=s.mapping,o=s.steps.length,c=this.eventCount;this.items.forEach(x=>{x.selection&&c--},i);let d=n;this.items.forEach(x=>{let b=l.getMirror(--d);if(b==null)return;o=Math.min(o,b);let v=l.maps[b];if(x.step){let w=s.steps[b].invert(s.docs[b]),_=x.selection&&x.selection.map(l.slice(d+1,b));_&&c++,a.push(new Hl(v,w,_))}else a.push(new Hl(v))},i);let u=[];for(let x=n;x<o;x++)u.push(new Hl(l.maps[x]));let h=this.items.slice(0,i).append(u).append(a),f=new ul(h,c);return f.emptyItemCount()>Sje&&(f=f.compress(this.items.length-a.length)),f}emptyItemCount(){let s=0;return this.items.forEach(n=>{n.step||s++}),s}compress(s=this.items.length){let n=this.remapping(0,s),a=n.maps.length,i=[],l=0;return this.items.forEach((o,c)=>{if(c>=s)i.push(o),o.selection&&l++;else if(o.step){let d=o.step.map(n.slice(a)),u=d&&d.getMap();if(a--,u&&n.appendMap(u,a),d){let h=o.selection&&o.selection.map(n.slice(a));h&&l++;let f=new Hl(u.invert(),d,h),x,b=i.length-1;(x=i.length&&i[b].merge(f))?i[b]=x:i.push(f)}}else o.map&&a--},this.items.length,0),new ul(Nr.from(i.reverse()),l)}}ul.empty=new ul(Nr.empty,0);function Cje(t,s){let n;return t.forEach((a,i)=>{if(a.selection&&s--==0)return n=i,!1}),t.slice(n)}class Hl{constructor(s,n,a,i){this.map=s,this.step=n,this.selection=a,this.mirrorOffset=i}merge(s){if(this.step&&s.step&&!s.selection){let n=s.step.merge(this.step);if(n)return new Hl(n.getMap().invert(),n,this.selection)}}}class Sc{constructor(s,n,a,i,l){this.done=s,this.undone=n,this.prevRanges=a,this.prevTime=i,this.prevComposition=l}}const kje=20;function Aje(t,s,n,a){let i=n.getMeta(mu),l;if(i)return i.historyState;n.getMeta(Pje)&&(t=new Sc(t.done,t.undone,null,0,-1));let o=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(o&&o.getMeta(mu))return o.getMeta(mu).redo?new Sc(t.done.addTransform(n,void 0,a,yy(s)),t.undone,IM(n.mapping.maps),t.prevTime,t.prevComposition):new Sc(t.done,t.undone.addTransform(n,void 0,a,yy(s)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let c=n.getMeta("composition"),d=t.prevTime==0||!o&&t.prevComposition!=c&&(t.prevTime<(n.time||0)-a.newGroupDelay||!Eje(n,t.prevRanges)),u=o?Ij(t.prevRanges,n.mapping):IM(n.mapping.maps);return new Sc(t.done.addTransform(n,d?s.selection.getBookmark():void 0,a,yy(s)),ul.empty,u,n.time,c??t.prevComposition)}else return(l=n.getMeta("rebased"))?new Sc(t.done.rebased(n,l),t.undone.rebased(n,l),Ij(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new Sc(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),Ij(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function Eje(t,s){if(!s)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((a,i)=>{for(let l=0;l<s.length;l+=2)a<=s[l+1]&&i>=s[l]&&(n=!0)}),n}function IM(t){let s=[];for(let n=t.length-1;n>=0&&s.length==0;n--)t[n].forEach((a,i,l,o)=>s.push(l,o));return s}function Ij(t,s){if(!t)return null;let n=[];for(let a=0;a<t.length;a+=2){let i=s.map(t[a],1),l=s.map(t[a+1],-1);i<=l&&n.push(i,l)}return n}function Tje(t,s,n){let a=yy(s),i=mu.get(s).spec.config,l=(n?t.undone:t.done).popEvent(s,a);if(!l)return null;let o=l.selection.resolve(l.transform.doc),c=(n?t.done:t.undone).addTransform(l.transform,s.selection.getBookmark(),i,a),d=new Sc(n?c:l.remaining,n?l.remaining:c,null,0,-1);return l.transform.setSelection(o).setMeta(mu,{redo:n,historyState:d})}let Mj=!1,MM=null;function yy(t){let s=t.plugins;if(MM!=s){Mj=!1,MM=s;for(let n=0;n<s.length;n++)if(s[n].spec.historyPreserveItems){Mj=!0;break}}return Mj}const mu=new Bn("history"),Pje=new Bn("closeHistory");function Ije(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new Ln({key:mu,state:{init(){return new Sc(ul.empty,ul.empty,null,0,-1)},apply(s,n,a){return Aje(n,a,s,t)}},config:t,props:{handleDOMEvents:{beforeinput(s,n){let a=n.inputType,i=a=="historyUndo"?vV:a=="historyRedo"?NV:null;return i?(n.preventDefault(),i(s.state,s.dispatch)):!1}}}})}function bV(t,s){return(n,a)=>{let i=mu.getState(n);if(!i||(t?i.undone:i.done).eventCount==0)return!1;if(a){let l=Tje(i,n,t);l&&a(s?l.scrollIntoView():l)}return!0}}const vV=bV(!1,!0),NV=bV(!0,!0),Mje=pa.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:s})=>vV(t,s),redo:()=>({state:t,dispatch:s})=>NV(t,s)}},addProseMirrorPlugins(){return[Ije(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),Dje=El.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",Ua(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t,state:s})=>{if(!Kwe(s,s.schema.nodes[this.name]))return!1;const{selection:n}=s,{$from:a,$to:i}=n,l=t();return a.parentOffset===0?l.insertContentAt({from:Math.max(a.pos-1,0),to:i.pos},{type:this.name}):Swe(n)?l.insertContentAt(i.pos,{type:this.name}):l.insertContent({type:this.name}),l.command(({tr:o,dispatch:c})=>{var d;if(c){const{$to:u}=o.selection,h=u.end();if(u.nodeAfter)u.nodeAfter.isTextblock?o.setSelection(kt.create(o.doc,u.pos+1)):u.nodeAfter.isBlock?o.setSelection(Pt.create(o.doc,u.pos)):o.setSelection(kt.create(o.doc,u.pos));else{const f=(d=u.parent.type.contentMatch.defaultType)===null||d===void 0?void 0:d.create();f&&(o.insert(h,f),o.setSelection(kt.create(o.doc,h+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[Gwe({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),Oje=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,Rje=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,Lje=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,Bje=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,Fje=Iu.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",Ua(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[bm({find:Oje,type:this.type}),bm({find:Lje,type:this.type})]},addPasteRules(){return[vm({find:Rje,type:this.type}),vm({find:Bje,type:this.type})]}}),$je=El.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",Ua(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),zje="listItem",DM="textStyle",OM=/^(\d+)\.\s$/,Uje=El.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:s,...n}=t;return s===1?["ol",Ua(this.options.HTMLAttributes,n),0]:["ol",Ua(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:s})=>this.options.keepAttributes?s().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(zje,this.editor.getAttributes(DM)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=fx({find:OM,type:this.type,getAttributes:s=>({start:+s[1]}),joinPredicate:(s,n)=>n.childCount+n.attrs.start===+s[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=fx({find:OM,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:s=>({start:+s[1],...this.editor.getAttributes(DM)}),joinPredicate:(s,n)=>n.childCount+n.attrs.start===+s[1],editor:this.editor})),[t]}}),Vje=El.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",Ua(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Hje=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,Wje=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,qje=Iu.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",Ua(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[bm({find:Hje,type:this.type})]},addPasteRules(){return[vm({find:Wje,type:this.type})]}}),Gje=El.create({name:"text",group:"inline"});pa.create({name:"starterKit",addExtensions(){const t=[];return this.options.bold!==!1&&t.push(tje.configure(this.options.bold)),this.options.blockquote!==!1&&t.push(Xwe.configure(this.options.blockquote)),this.options.bulletList!==!1&&t.push(nje.configure(this.options.bulletList)),this.options.code!==!1&&t.push(ije.configure(this.options.code)),this.options.codeBlock!==!1&&t.push(cje.configure(this.options.codeBlock)),this.options.document!==!1&&t.push(dje.configure(this.options.document)),this.options.dropcursor!==!1&&t.push(mje.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&t.push(Nje.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&t.push(wje.configure(this.options.hardBreak)),this.options.heading!==!1&&t.push(jje.configure(this.options.heading)),this.options.history!==!1&&t.push(Mje.configure(this.options.history)),this.options.horizontalRule!==!1&&t.push(Dje.configure(this.options.horizontalRule)),this.options.italic!==!1&&t.push(Fje.configure(this.options.italic)),this.options.listItem!==!1&&t.push($je.configure(this.options.listItem)),this.options.orderedList!==!1&&t.push(Uje.configure(this.options.orderedList)),this.options.paragraph!==!1&&t.push(Vje.configure(this.options.paragraph)),this.options.strike!==!1&&t.push(qje.configure(this.options.strike)),this.options.text!==!1&&t.push(Gje.configure(this.options.text)),t}});var Kje=20,wV=(t,s=0)=>{const n=[];return!t.children.length||s>Kje||Array.from(t.children).forEach(a=>{a.tagName==="SPAN"?n.push(a):a.children.length&&n.push(...wV(a,s+1))}),n},Yje=t=>{if(!t.children.length)return;const s=wV(t);s&&s.forEach(n=>{var a,i;const l=n.getAttribute("style"),o=(i=(a=n.parentElement)==null?void 0:a.closest("span"))==null?void 0:i.getAttribute("style");n.setAttribute("style",`${o};${l}`)})},Xje=k5.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!0}},parseHTML(){return[{tag:"span",consuming:!1,getAttrs:t=>t.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&Yje(t),{}):!1}]},renderHTML({HTMLAttributes:t}){return["span",jd(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleTextStyle:t=>({commands:s})=>s.toggleMark(this.name,t),removeEmptyTextStyle:()=>({tr:t})=>{const{selection:s}=t;return t.doc.nodesBetween(s.from,s.to,(n,a)=>{if(n.isTextblock)return!0;n.marks.filter(i=>i.type===this.type).some(i=>Object.values(i.attrs).some(l=>!!l))||t.removeMark(a,a+n.nodeSize,this.type)}),!0}}}}),Qje=_r.create({name:"backgroundColor",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,parseHTML:t=>{var s;const n=t.getAttribute("style");if(n){const a=n.split(";").map(i=>i.trim()).filter(Boolean);for(let i=a.length-1;i>=0;i-=1){const l=a[i].split(":");if(l.length>=2){const o=l[0].trim().toLowerCase(),c=l.slice(1).join(":").trim();if(o==="background-color")return c.replace(/['"]+/g,"")}}}return(s=t.style.backgroundColor)==null?void 0:s.replace(/['"]+/g,"")},renderHTML:t=>t.backgroundColor?{style:`background-color: ${t.backgroundColor}`}:{}}}}]},addCommands(){return{setBackgroundColor:t=>({chain:s})=>s().setMark("textStyle",{backgroundColor:t}).run(),unsetBackgroundColor:()=>({chain:t})=>t().setMark("textStyle",{backgroundColor:null}).removeEmptyTextStyle().run()}}}),Zje=_r.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:t=>{var s;const n=t.getAttribute("style");if(n){const a=n.split(";").map(i=>i.trim()).filter(Boolean);for(let i=a.length-1;i>=0;i-=1){const l=a[i].split(":");if(l.length>=2){const o=l[0].trim().toLowerCase(),c=l.slice(1).join(":").trim();if(o==="color")return c.replace(/['"]+/g,"")}}}return(s=t.style.color)==null?void 0:s.replace(/['"]+/g,"")},renderHTML:t=>t.color?{style:`color: ${t.color}`}:{}}}}]},addCommands(){return{setColor:t=>({chain:s})=>s().setMark("textStyle",{color:t}).run(),unsetColor:()=>({chain:t})=>t().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),Jje=_r.create({name:"fontFamily",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:t=>t.style.fontFamily,renderHTML:t=>t.fontFamily?{style:`font-family: ${t.fontFamily}`}:{}}}}]},addCommands(){return{setFontFamily:t=>({chain:s})=>s().setMark("textStyle",{fontFamily:t}).run(),unsetFontFamily:()=>({chain:t})=>t().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}}}),e2e=_r.create({name:"fontSize",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:t=>t.style.fontSize,renderHTML:t=>t.fontSize?{style:`font-size: ${t.fontSize}`}:{}}}}]},addCommands(){return{setFontSize:t=>({chain:s})=>s().setMark("textStyle",{fontSize:t}).run(),unsetFontSize:()=>({chain:t})=>t().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()}}}),t2e=_r.create({name:"lineHeight",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{lineHeight:{default:null,parseHTML:t=>t.style.lineHeight,renderHTML:t=>t.lineHeight?{style:`line-height: ${t.lineHeight}`}:{}}}}]},addCommands(){return{setLineHeight:t=>({chain:s})=>s().setMark("textStyle",{lineHeight:t}).run(),unsetLineHeight:()=>({chain:t})=>t().setMark("textStyle",{lineHeight:null}).removeEmptyTextStyle().run()}}});_r.create({name:"textStyleKit",addExtensions(){const t=[];return this.options.backgroundColor!==!1&&t.push(Qje.configure(this.options.backgroundColor)),this.options.color!==!1&&t.push(Zje.configure(this.options.color)),this.options.fontFamily!==!1&&t.push(Jje.configure(this.options.fontFamily)),this.options.fontSize!==!1&&t.push(e2e.configure(this.options.fontSize)),this.options.lineHeight!==!1&&t.push(t2e.configure(this.options.lineHeight)),this.options.textStyle!==!1&&t.push(Xje.configure(this.options.textStyle)),t}});k5.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",jd(this.options.HTMLAttributes,t),0]},parseMarkdown(t,s){return s.applyMark(this.name||"underline",s.parseInline(t.tokens||[]))},renderMarkdown(t,s){return`++${s.renderChildren(t)}++`},markdownTokenizer:{name:"underline",level:"inline",start(t){return t.indexOf("++")},tokenize(t,s,n){const i=/^(\+\+)([\s\S]+?)(\+\+)/.exec(t);if(!i)return;const l=i[2].trim();return{type:"underline",raw:i[0],text:l,tokens:n.inlineTokens(l)}}},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});var s2e=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,n2e=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g;k5.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:t=>t.getAttribute("data-color")||t.style.backgroundColor,renderHTML:t=>t.color?{"data-color":t.color,style:`background-color: ${t.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:t}){return["mark",jd(this.options.HTMLAttributes,t),0]},renderMarkdown:(t,s)=>`==${s.renderChildren(t)}==`,parseMarkdown:(t,s)=>s.applyMark("highlight",s.parseInline(t.tokens||[])),markdownTokenizer:{name:"highlight",level:"inline",start:t=>t.indexOf("=="),tokenize(t,s,n){const i=/^(==)([^=]+)(==)/.exec(t);if(i){const l=i[2].trim(),o=n.inlineTokens(l);return{type:"highlight",raw:i[0],text:l,tokens:o}}}},addCommands(){return{setHighlight:t=>({commands:s})=>s.setMark(this.name,t),toggleHighlight:t=>({commands:s})=>s.toggleMark(this.name,t),unsetHighlight:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[oNe({find:s2e,type:this.type})]},addPasteRules(){return[vNe({find:n2e,type:this.type})]}});_r.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:null}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:t=>{const s=t.style.textAlign;return this.options.alignments.includes(s)?s:this.options.defaultAlignment},renderHTML:t=>t.textAlign?{style:`text-align: ${t.textAlign}`}:{}}}}]},addCommands(){return{setTextAlign:t=>({commands:s})=>this.options.alignments.includes(t)?this.options.types.map(n=>s.updateAttributes(n,{textAlign:t})).every(n=>n):!1,unsetTextAlign:()=>({commands:t})=>this.options.types.map(s=>t.resetAttributes(s,"textAlign")).every(s=>s),toggleTextAlign:t=>({editor:s,commands:n})=>this.options.alignments.includes(t)?s.isActive({textAlign:t})?n.unsetTextAlign():n.setTextAlign(t):!1}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}});var r2e=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/;Zx.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{},resize:!1}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null},width:{default:null},height:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:t}){return["img",jd(this.options.HTMLAttributes,t)]},parseMarkdown:(t,s)=>s.createNode("image",{src:t.href,title:t.title,alt:t.text}),renderMarkdown:t=>{var s,n,a,i,l,o;const c=(n=(s=t.attrs)==null?void 0:s.src)!=null?n:"",d=(i=(a=t.attrs)==null?void 0:a.alt)!=null?i:"",u=(o=(l=t.attrs)==null?void 0:l.title)!=null?o:"";return u?`![${d}](${c} "${u}")`:`![${d}](${c})`},addNodeView(){if(!this.options.resize||!this.options.resize.enabled||typeof document>"u")return null;const{directions:t,minWidth:s,minHeight:n,alwaysPreserveAspectRatio:a}=this.options.resize;return({node:i,getPos:l,HTMLAttributes:o,editor:c})=>{const d=document.createElement("img");Object.entries(o).forEach(([f,x])=>{if(x!=null)switch(f){case"width":case"height":break;default:d.setAttribute(f,x);break}}),d.src=o.src;const u=new uNe({element:d,editor:c,node:i,getPos:l,onResize:(f,x)=>{d.style.width=`${f}px`,d.style.height=`${x}px`},onCommit:(f,x)=>{const b=l();b!==void 0&&this.editor.chain().setNodeSelection(b).updateAttributes(this.name,{width:f,height:x}).run()},onUpdate:(f,x,b)=>f.type===i.type,options:{directions:t,min:{width:s,height:n},preserveAspectRatio:a===!0}}),h=u.dom;return h.style.visibility="hidden",h.style.pointerEvents="none",d.onload=()=>{h.style.visibility="",h.style.pointerEvents=""},u}},addCommands(){return{setImage:t=>({commands:s})=>s.insertContent({type:this.name,attrs:t})}},addInputRules(){return[cNe({find:r2e,type:this.type,getAttributes:t=>{const[,,s,n,a]=t;return{src:n,alt:s,title:a}}})]}});var MS,DS;if(typeof WeakMap<"u"){let t=new WeakMap;MS=s=>t.get(s),DS=(s,n)=>(t.set(s,n),n)}else{const t=[];let n=0;MS=a=>{for(let i=0;i<t.length;i+=2)if(t[i]==a)return t[i+1]},DS=(a,i)=>(n==10&&(n=0),t[n++]=a,t[n++]=i)}var Sn=class{constructor(t,s,n,a){this.width=t,this.height=s,this.map=n,this.problems=a}findCell(t){for(let s=0;s<this.map.length;s++){const n=this.map[s];if(n!=t)continue;const a=s%this.width,i=s/this.width|0;let l=a+1,o=i+1;for(let c=1;l<this.width&&this.map[s+c]==n;c++)l++;for(let c=1;o<this.height&&this.map[s+this.width*c]==n;c++)o++;return{left:a,top:i,right:l,bottom:o}}throw new RangeError(`No cell with offset ${t} found`)}colCount(t){for(let s=0;s<this.map.length;s++)if(this.map[s]==t)return s%this.width;throw new RangeError(`No cell with offset ${t} found`)}nextCell(t,s,n){const{left:a,right:i,top:l,bottom:o}=this.findCell(t);return s=="horiz"?(n<0?a==0:i==this.width)?null:this.map[l*this.width+(n<0?a-1:i)]:(n<0?l==0:o==this.height)?null:this.map[a+this.width*(n<0?l-1:o)]}rectBetween(t,s){const{left:n,right:a,top:i,bottom:l}=this.findCell(t),{left:o,right:c,top:d,bottom:u}=this.findCell(s);return{left:Math.min(n,o),top:Math.min(i,d),right:Math.max(a,c),bottom:Math.max(l,u)}}cellsInRect(t){const s=[],n={};for(let a=t.top;a<t.bottom;a++)for(let i=t.left;i<t.right;i++){const l=a*this.width+i,o=this.map[l];n[o]||(n[o]=!0,!(i==t.left&&i&&this.map[l-1]==o||a==t.top&&a&&this.map[l-this.width]==o)&&s.push(o))}return s}positionAt(t,s,n){for(let a=0,i=0;;a++){const l=i+n.child(a).nodeSize;if(a==t){let o=s+t*this.width;const c=(t+1)*this.width;for(;o<c&&this.map[o]<i;)o++;return o==c?l-1:this.map[o]}i=l}}static get(t){return MS(t)||DS(t,a2e(t))}};function a2e(t){if(t.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+t.type.name);const s=i2e(t),n=t.childCount,a=[];let i=0,l=null;const o=[];for(let u=0,h=s*n;u<h;u++)a[u]=0;for(let u=0,h=0;u<n;u++){const f=t.child(u);h++;for(let v=0;;v++){for(;i<a.length&&a[i]!=0;)i++;if(v==f.childCount)break;const w=f.child(v),{colspan:_,rowspan:S,colwidth:k}=w.attrs;for(let A=0;A<S;A++){if(A+u>=n){(l||(l=[])).push({type:"overlong_rowspan",pos:h,n:S-A});break}const T=i+A*s;for(let P=0;P<_;P++){a[T+P]==0?a[T+P]=h:(l||(l=[])).push({type:"collision",row:u,pos:h,n:_-P});const O=k&&k[P];if(O){const D=(T+P)%s*2,I=o[D];I==null||I!=O&&o[D+1]==1?(o[D]=O,o[D+1]=1):I==O&&o[D+1]++}}}i+=_,h+=w.nodeSize}const x=(u+1)*s;let b=0;for(;i<x;)a[i++]==0&&b++;b&&(l||(l=[])).push({type:"missing",row:u,n:b}),h++}(s===0||n===0)&&(l||(l=[])).push({type:"zero_sized"});const c=new Sn(s,n,a,l);let d=!1;for(let u=0;!d&&u<o.length;u+=2)o[u]!=null&&o[u+1]<n&&(d=!0);return d&&l2e(c,o,t),c}function i2e(t){let s=-1,n=!1;for(let a=0;a<t.childCount;a++){const i=t.child(a);let l=0;if(n)for(let o=0;o<a;o++){const c=t.child(o);for(let d=0;d<c.childCount;d++){const u=c.child(d);o+u.attrs.rowspan>a&&(l+=u.attrs.colspan)}}for(let o=0;o<i.childCount;o++){const c=i.child(o);l+=c.attrs.colspan,c.attrs.rowspan>1&&(n=!0)}s==-1?s=l:s!=l&&(s=Math.max(s,l))}return s}function l2e(t,s,n){t.problems||(t.problems=[]);const a={};for(let i=0;i<t.map.length;i++){const l=t.map[i];if(a[l])continue;a[l]=!0;const o=n.nodeAt(l);if(!o)throw new RangeError(`No cell with offset ${l} found`);let c=null;const d=o.attrs;for(let u=0;u<d.colspan;u++){const h=(i+u)%t.width,f=s[h*2];f!=null&&(!d.colwidth||d.colwidth[u]!=f)&&((c||(c=o2e(d)))[u]=f)}c&&t.problems.unshift({type:"colwidth mismatch",pos:l,colwidth:c})}}function o2e(t){if(t.colwidth)return t.colwidth.slice();const s=[];for(let n=0;n<t.colspan;n++)s.push(0);return s}function ta(t){let s=t.cached.tableNodeTypes;if(!s){s=t.cached.tableNodeTypes={};for(const n in t.nodes){const a=t.nodes[n],i=a.spec.tableRole;i&&(s[i]=a)}}return s}var Tc=new Bn("selectingCells");function Ym(t){for(let s=t.depth-1;s>0;s--)if(t.node(s).type.spec.tableRole=="row")return t.node(0).resolve(t.before(s+1));return null}function c2e(t){for(let s=t.depth;s>0;s--){const n=t.node(s).type.spec.tableRole;if(n==="cell"||n==="header_cell")return t.node(s)}return null}function Tl(t){const s=t.selection.$head;for(let n=s.depth;n>0;n--)if(s.node(n).type.spec.tableRole=="row")return!0;return!1}function Bv(t){const s=t.selection;if("$anchorCell"in s&&s.$anchorCell)return s.$anchorCell.pos>s.$headCell.pos?s.$anchorCell:s.$headCell;if("node"in s&&s.node&&s.node.type.spec.tableRole=="cell")return s.$anchor;const n=Ym(s.$head)||d2e(s.$head);if(n)return n;throw new RangeError(`No cell found around position ${s.head}`)}function d2e(t){for(let s=t.nodeAfter,n=t.pos;s;s=s.firstChild,n++){const a=s.type.spec.tableRole;if(a=="cell"||a=="header_cell")return t.doc.resolve(n)}for(let s=t.nodeBefore,n=t.pos;s;s=s.lastChild,n--){const a=s.type.spec.tableRole;if(a=="cell"||a=="header_cell")return t.doc.resolve(n-s.nodeSize)}}function OS(t){return t.parent.type.spec.tableRole=="row"&&!!t.nodeAfter}function u2e(t){return t.node(0).resolve(t.pos+t.nodeAfter.nodeSize)}function O5(t,s){return t.depth==s.depth&&t.pos>=s.start(-1)&&t.pos<=s.end(-1)}function jV(t,s,n){const a=t.node(-1),i=Sn.get(a),l=t.start(-1),o=i.nextCell(t.pos-l,s,n);return o==null?null:t.node(0).resolve(l+o)}function Mu(t,s,n=1){const a={...t,colspan:t.colspan-n};return a.colwidth&&(a.colwidth=a.colwidth.slice(),a.colwidth.splice(s,n),a.colwidth.some(i=>i>0)||(a.colwidth=null)),a}function _V(t,s,n=1){const a={...t,colspan:t.colspan+n};if(a.colwidth){a.colwidth=a.colwidth.slice();for(let i=0;i<n;i++)a.colwidth.splice(s,0,0)}return a}function h2e(t,s,n){const a=ta(s.type.schema).header_cell;for(let i=0;i<t.height;i++)if(s.nodeAt(t.map[n+i*t.width]).type!=a)return!1;return!0}var Hs=class So extends Bt{constructor(s,n=s){const a=s.node(-1),i=Sn.get(a),l=s.start(-1),o=i.rectBetween(s.pos-l,n.pos-l),c=s.node(0),d=i.cellsInRect(o).filter(h=>h!=n.pos-l);d.unshift(n.pos-l);const u=d.map(h=>{const f=a.nodeAt(h);if(!f)throw RangeError(`No cell with offset ${h} found`);const x=l+h+1;return new eU(c.resolve(x),c.resolve(x+f.content.size))});super(u[0].$from,u[0].$to,u),this.$anchorCell=s,this.$headCell=n}map(s,n){const a=s.resolve(n.map(this.$anchorCell.pos)),i=s.resolve(n.map(this.$headCell.pos));if(OS(a)&&OS(i)&&O5(a,i)){const l=this.$anchorCell.node(-1)!=a.node(-1);return l&&this.isRowSelection()?So.rowSelection(a,i):l&&this.isColSelection()?So.colSelection(a,i):new So(a,i)}return kt.between(a,i)}content(){const s=this.$anchorCell.node(-1),n=Sn.get(s),a=this.$anchorCell.start(-1),i=n.rectBetween(this.$anchorCell.pos-a,this.$headCell.pos-a),l={},o=[];for(let d=i.top;d<i.bottom;d++){const u=[];for(let h=d*n.width+i.left,f=i.left;f<i.right;f++,h++){const x=n.map[h];if(l[x])continue;l[x]=!0;const b=n.findCell(x);let v=s.nodeAt(x);if(!v)throw RangeError(`No cell with offset ${x} found`);const w=i.left-b.left,_=b.right-i.right;if(w>0||_>0){let S=v.attrs;if(w>0&&(S=Mu(S,0,w)),_>0&&(S=Mu(S,S.colspan-_,_)),b.left<i.left){if(v=v.type.createAndFill(S),!v)throw RangeError(`Could not create cell with attrs ${JSON.stringify(S)}`)}else v=v.type.create(S,v.content)}if(b.top<i.top||b.bottom>i.bottom){const S={...v.attrs,rowspan:Math.min(b.bottom,i.bottom)-Math.max(b.top,i.top)};b.top<i.top?v=v.type.createAndFill(S):v=v.type.create(S,v.content)}u.push(v)}o.push(s.child(d).copy(ze.from(u)))}const c=this.isColSelection()&&this.isRowSelection()?s:o;return new ct(ze.from(c),1,1)}replace(s,n=ct.empty){const a=s.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){const{$from:c,$to:d}=i[o],u=s.mapping.slice(a);s.replace(u.map(c.pos),u.map(d.pos),o?ct.empty:n)}const l=Bt.findFrom(s.doc.resolve(s.mapping.slice(a).map(this.to)),-1);l&&s.setSelection(l)}replaceWith(s,n){this.replace(s,new ct(ze.from(n),0,0))}forEachCell(s){const n=this.$anchorCell.node(-1),a=Sn.get(n),i=this.$anchorCell.start(-1),l=a.cellsInRect(a.rectBetween(this.$anchorCell.pos-i,this.$headCell.pos-i));for(let o=0;o<l.length;o++)s(n.nodeAt(l[o]),i+l[o])}isColSelection(){const s=this.$anchorCell.index(-1),n=this.$headCell.index(-1);if(Math.min(s,n)>0)return!1;const a=s+this.$anchorCell.nodeAfter.attrs.rowspan,i=n+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(a,i)==this.$headCell.node(-1).childCount}static colSelection(s,n=s){const a=s.node(-1),i=Sn.get(a),l=s.start(-1),o=i.findCell(s.pos-l),c=i.findCell(n.pos-l),d=s.node(0);return o.top<=c.top?(o.top>0&&(s=d.resolve(l+i.map[o.left])),c.bottom<i.height&&(n=d.resolve(l+i.map[i.width*(i.height-1)+c.right-1]))):(c.top>0&&(n=d.resolve(l+i.map[c.left])),o.bottom<i.height&&(s=d.resolve(l+i.map[i.width*(i.height-1)+o.right-1]))),new So(s,n)}isRowSelection(){const s=this.$anchorCell.node(-1),n=Sn.get(s),a=this.$anchorCell.start(-1),i=n.colCount(this.$anchorCell.pos-a),l=n.colCount(this.$headCell.pos-a);if(Math.min(i,l)>0)return!1;const o=i+this.$anchorCell.nodeAfter.attrs.colspan,c=l+this.$headCell.nodeAfter.attrs.colspan;return Math.max(o,c)==n.width}eq(s){return s instanceof So&&s.$anchorCell.pos==this.$anchorCell.pos&&s.$headCell.pos==this.$headCell.pos}static rowSelection(s,n=s){const a=s.node(-1),i=Sn.get(a),l=s.start(-1),o=i.findCell(s.pos-l),c=i.findCell(n.pos-l),d=s.node(0);return o.left<=c.left?(o.left>0&&(s=d.resolve(l+i.map[o.top*i.width])),c.right<i.width&&(n=d.resolve(l+i.map[i.width*(c.top+1)-1]))):(c.left>0&&(n=d.resolve(l+i.map[c.top*i.width])),o.right<i.width&&(s=d.resolve(l+i.map[i.width*(o.top+1)-1]))),new So(s,n)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(s,n){return new So(s.resolve(n.anchor),s.resolve(n.head))}static create(s,n,a=n){return new So(s.resolve(n),s.resolve(a))}getBookmark(){return new m2e(this.$anchorCell.pos,this.$headCell.pos)}};Hs.prototype.visible=!1;Bt.jsonID("cell",Hs);var m2e=class SV{constructor(s,n){this.anchor=s,this.head=n}map(s){return new SV(s.map(this.anchor),s.map(this.head))}resolve(s){const n=s.resolve(this.anchor),a=s.resolve(this.head);return n.parent.type.spec.tableRole=="row"&&a.parent.type.spec.tableRole=="row"&&n.index()<n.parent.childCount&&a.index()<a.parent.childCount&&O5(n,a)?new Hs(n,a):Bt.near(a,1)}};function f2e(t){if(!(t.selection instanceof Hs))return null;const s=[];return t.selection.forEachCell((n,a)=>{s.push(di.node(a,a+n.nodeSize,{class:"selectedCell"}))}),In.create(t.doc,s)}function p2e({$from:t,$to:s}){if(t.pos==s.pos||t.pos<s.pos-6)return!1;let n=t.pos,a=s.pos,i=t.depth;for(;i>=0&&!(t.after(i+1)<t.end(i));i--,n++);for(let l=s.depth;l>=0&&!(s.before(l+1)>s.start(l));l--,a--);return n==a&&/row|table/.test(t.node(i).type.spec.tableRole)}function x2e({$from:t,$to:s}){let n,a;for(let i=t.depth;i>0;i--){const l=t.node(i);if(l.type.spec.tableRole==="cell"||l.type.spec.tableRole==="header_cell"){n=l;break}}for(let i=s.depth;i>0;i--){const l=s.node(i);if(l.type.spec.tableRole==="cell"||l.type.spec.tableRole==="header_cell"){a=l;break}}return n!==a&&s.parentOffset===0}function g2e(t,s,n){const a=(s||t).selection,i=(s||t).doc;let l,o;if(a instanceof Pt&&(o=a.node.type.spec.tableRole)){if(o=="cell"||o=="header_cell")l=Hs.create(i,a.from);else if(o=="row"){const c=i.resolve(a.from+1);l=Hs.rowSelection(c,c)}else if(!n){const c=Sn.get(a.node),d=a.from+1,u=d+c.map[c.width*c.height-1];l=Hs.create(i,d+1,u)}}else a instanceof kt&&p2e(a)?l=kt.create(i,a.from):a instanceof kt&&x2e(a)&&(l=kt.create(i,a.$from.start(),a.$from.end()));return l&&(s||(s=t.tr)).setSelection(l),s}var y2e=new Bn("fix-tables");function CV(t,s,n,a){const i=t.childCount,l=s.childCount;e:for(let o=0,c=0;o<l;o++){const d=s.child(o);for(let u=c,h=Math.min(i,o+3);u<h;u++)if(t.child(u)==d){c=u+1,n+=d.nodeSize;continue e}a(d,n),c<i&&t.child(c).sameMarkup(d)?CV(t.child(c),d,n+1,a):d.nodesBetween(0,d.content.size,a,n+1),n+=d.nodeSize}}function kV(t,s){let n;const a=(i,l)=>{i.type.spec.tableRole=="table"&&(n=b2e(t,i,l,n))};return s?s.doc!=t.doc&&CV(s.doc,t.doc,0,a):t.doc.descendants(a),n}function b2e(t,s,n,a){const i=Sn.get(s);if(!i.problems)return a;a||(a=t.tr);const l=[];for(let d=0;d<i.height;d++)l.push(0);for(let d=0;d<i.problems.length;d++){const u=i.problems[d];if(u.type=="collision"){const h=s.nodeAt(u.pos);if(!h)continue;const f=h.attrs;for(let x=0;x<f.rowspan;x++)l[u.row+x]+=u.n;a.setNodeMarkup(a.mapping.map(n+1+u.pos),null,Mu(f,f.colspan-u.n,u.n))}else if(u.type=="missing")l[u.row]+=u.n;else if(u.type=="overlong_rowspan"){const h=s.nodeAt(u.pos);if(!h)continue;a.setNodeMarkup(a.mapping.map(n+1+u.pos),null,{...h.attrs,rowspan:h.attrs.rowspan-u.n})}else if(u.type=="colwidth mismatch"){const h=s.nodeAt(u.pos);if(!h)continue;a.setNodeMarkup(a.mapping.map(n+1+u.pos),null,{...h.attrs,colwidth:u.colwidth})}else if(u.type=="zero_sized"){const h=a.mapping.map(n);a.delete(h,h+s.nodeSize)}}let o,c;for(let d=0;d<l.length;d++)l[d]&&(o==null&&(o=d),c=d);for(let d=0,u=n+1;d<i.height;d++){const h=s.child(d),f=u+h.nodeSize,x=l[d];if(x>0){let b="cell";h.firstChild&&(b=h.firstChild.type.spec.tableRole);const v=[];for(let _=0;_<x;_++){const S=ta(t.schema)[b].createAndFill();S&&v.push(S)}const w=(d==0||o==d-1)&&c==d?u+1:f-1;a.insert(a.mapping.map(w),v)}u=f}return a.setMeta(y2e,{fixTables:!0})}function yo(t){const s=t.selection,n=Bv(t),a=n.node(-1),i=n.start(-1),l=Sn.get(a);return{...s instanceof Hs?l.rectBetween(s.$anchorCell.pos-i,s.$headCell.pos-i):l.findCell(n.pos-i),tableStart:i,map:l,table:a}}function AV(t,{map:s,tableStart:n,table:a},i){let l=i>0?-1:0;h2e(s,a,i+l)&&(l=i==0||i==s.width?null:0);for(let o=0;o<s.height;o++){const c=o*s.width+i;if(i>0&&i<s.width&&s.map[c-1]==s.map[c]){const d=s.map[c],u=a.nodeAt(d);t.setNodeMarkup(t.mapping.map(n+d),null,_V(u.attrs,i-s.colCount(d))),o+=u.attrs.rowspan-1}else{const d=l==null?ta(a.type.schema).cell:a.nodeAt(s.map[c+l]).type,u=s.positionAt(o,i,a);t.insert(t.mapping.map(n+u),d.createAndFill())}}return t}function v2e(t,s){if(!Tl(t))return!1;if(s){const n=yo(t);s(AV(t.tr,n,n.left))}return!0}function N2e(t,s){if(!Tl(t))return!1;if(s){const n=yo(t);s(AV(t.tr,n,n.right))}return!0}function w2e(t,{map:s,table:n,tableStart:a},i){const l=t.mapping.maps.length;for(let o=0;o<s.height;){const c=o*s.width+i,d=s.map[c],u=n.nodeAt(d),h=u.attrs;if(i>0&&s.map[c-1]==d||i<s.width-1&&s.map[c+1]==d)t.setNodeMarkup(t.mapping.slice(l).map(a+d),null,Mu(h,i-s.colCount(d)));else{const f=t.mapping.slice(l).map(a+d);t.delete(f,f+u.nodeSize)}o+=h.rowspan}}function j2e(t,s){if(!Tl(t))return!1;if(s){const n=yo(t),a=t.tr;if(n.left==0&&n.right==n.map.width)return!1;for(let i=n.right-1;w2e(a,n,i),i!=n.left;i--){const l=n.tableStart?a.doc.nodeAt(n.tableStart-1):a.doc;if(!l)throw RangeError("No table found");n.table=l,n.map=Sn.get(l)}s(a)}return!0}function _2e(t,s,n){var a;const i=ta(s.type.schema).header_cell;for(let l=0;l<t.width;l++)if(((a=s.nodeAt(t.map[l+n*t.width]))==null?void 0:a.type)!=i)return!1;return!0}function EV(t,{map:s,tableStart:n,table:a},i){var l;let o=n;for(let u=0;u<i;u++)o+=a.child(u).nodeSize;const c=[];let d=i>0?-1:0;_2e(s,a,i+d)&&(d=i==0||i==s.height?null:0);for(let u=0,h=s.width*i;u<s.width;u++,h++)if(i>0&&i<s.height&&s.map[h]==s.map[h-s.width]){const f=s.map[h],x=a.nodeAt(f).attrs;t.setNodeMarkup(n+f,null,{...x,rowspan:x.rowspan+1}),u+=x.colspan-1}else{const f=d==null?ta(a.type.schema).cell:(l=a.nodeAt(s.map[h+d*s.width]))==null?void 0:l.type,x=f==null?void 0:f.createAndFill();x&&c.push(x)}return t.insert(o,ta(a.type.schema).row.create(null,c)),t}function S2e(t,s){if(!Tl(t))return!1;if(s){const n=yo(t);s(EV(t.tr,n,n.top))}return!0}function C2e(t,s){if(!Tl(t))return!1;if(s){const n=yo(t);s(EV(t.tr,n,n.bottom))}return!0}function k2e(t,{map:s,table:n,tableStart:a},i){let l=0;for(let u=0;u<i;u++)l+=n.child(u).nodeSize;const o=l+n.child(i).nodeSize,c=t.mapping.maps.length;t.delete(l+a,o+a);const d=new Set;for(let u=0,h=i*s.width;u<s.width;u++,h++){const f=s.map[h];if(!d.has(f)){if(d.add(f),i>0&&f==s.map[h-s.width]){const x=n.nodeAt(f).attrs;t.setNodeMarkup(t.mapping.slice(c).map(f+a),null,{...x,rowspan:x.rowspan-1}),u+=x.colspan-1}else if(i<s.height&&f==s.map[h+s.width]){const x=n.nodeAt(f),b=x.attrs,v=x.type.create({...b,rowspan:x.attrs.rowspan-1},x.content),w=s.positionAt(i+1,u,n);t.insert(t.mapping.slice(c).map(a+w),v),u+=b.colspan-1}}}}function A2e(t,s){if(!Tl(t))return!1;if(s){const n=yo(t),a=t.tr;if(n.top==0&&n.bottom==n.map.height)return!1;for(let i=n.bottom-1;k2e(a,n,i),i!=n.top;i--){const l=n.tableStart?a.doc.nodeAt(n.tableStart-1):a.doc;if(!l)throw RangeError("No table found");n.table=l,n.map=Sn.get(n.table)}s(a)}return!0}function RM(t){const s=t.content;return s.childCount==1&&s.child(0).isTextblock&&s.child(0).childCount==0}function E2e({width:t,height:s,map:n},a){let i=a.top*t+a.left,l=i,o=(a.bottom-1)*t+a.left,c=i+(a.right-a.left-1);for(let d=a.top;d<a.bottom;d++){if(a.left>0&&n[l]==n[l-1]||a.right<t&&n[c]==n[c+1])return!0;l+=t,c+=t}for(let d=a.left;d<a.right;d++){if(a.top>0&&n[i]==n[i-t]||a.bottom<s&&n[o]==n[o+t])return!0;i++,o++}return!1}function LM(t,s){const n=t.selection;if(!(n instanceof Hs)||n.$anchorCell.pos==n.$headCell.pos)return!1;const a=yo(t),{map:i}=a;if(E2e(i,a))return!1;if(s){const l=t.tr,o={};let c=ze.empty,d,u;for(let h=a.top;h<a.bottom;h++)for(let f=a.left;f<a.right;f++){const x=i.map[h*i.width+f],b=a.table.nodeAt(x);if(!(o[x]||!b))if(o[x]=!0,d==null)d=x,u=b;else{RM(b)||(c=c.append(b.content));const v=l.mapping.map(x+a.tableStart);l.delete(v,v+b.nodeSize)}}if(d==null||u==null)return!0;if(l.setNodeMarkup(d+a.tableStart,null,{..._V(u.attrs,u.attrs.colspan,a.right-a.left-u.attrs.colspan),rowspan:a.bottom-a.top}),c.size){const h=d+1+u.content.size,f=RM(u)?d+1:h;l.replaceWith(f+a.tableStart,h+a.tableStart,c)}l.setSelection(new Hs(l.doc.resolve(d+a.tableStart))),s(l)}return!0}function BM(t,s){const n=ta(t.schema);return T2e(({node:a})=>n[a.type.spec.tableRole])(t,s)}function T2e(t){return(s,n)=>{var a;const i=s.selection;let l,o;if(i instanceof Hs){if(i.$anchorCell.pos!=i.$headCell.pos)return!1;l=i.$anchorCell.nodeAfter,o=i.$anchorCell.pos}else{if(l=c2e(i.$from),!l)return!1;o=(a=Ym(i.$from))==null?void 0:a.pos}if(l==null||o==null||l.attrs.colspan==1&&l.attrs.rowspan==1)return!1;if(n){let c=l.attrs;const d=[],u=c.colwidth;c.rowspan>1&&(c={...c,rowspan:1}),c.colspan>1&&(c={...c,colspan:1});const h=yo(s),f=s.tr;for(let b=0;b<h.right-h.left;b++)d.push(u?{...c,colwidth:u&&u[b]?[u[b]]:null}:c);let x;for(let b=h.top;b<h.bottom;b++){let v=h.map.positionAt(b,h.left,h.table);b==h.top&&(v+=l.nodeSize);for(let w=h.left,_=0;w<h.right;w++,_++)w==h.left&&b==h.top||f.insert(x=f.mapping.map(v+h.tableStart,1),t({node:l,row:b,col:w}).createAndFill(d[_]))}f.setNodeMarkup(o,t({node:l,row:h.top,col:h.left}),d[0]),i instanceof Hs&&f.setSelection(new Hs(f.doc.resolve(i.$anchorCell.pos),x?f.doc.resolve(x):void 0)),n(f)}return!0}}function P2e(t,s){return function(n,a){if(!Tl(n))return!1;const i=Bv(n);if(i.nodeAfter.attrs[t]===s)return!1;if(a){const l=n.tr;n.selection instanceof Hs?n.selection.forEachCell((o,c)=>{o.attrs[t]!==s&&l.setNodeMarkup(c,null,{...o.attrs,[t]:s})}):l.setNodeMarkup(i.pos,null,{...i.nodeAfter.attrs,[t]:s}),a(l)}return!0}}function I2e(t){return function(s,n){if(!Tl(s))return!1;if(n){const a=ta(s.schema),i=yo(s),l=s.tr,o=i.map.cellsInRect(t=="column"?{left:i.left,top:0,right:i.right,bottom:i.map.height}:t=="row"?{left:0,top:i.top,right:i.map.width,bottom:i.bottom}:i),c=o.map(d=>i.table.nodeAt(d));for(let d=0;d<o.length;d++)c[d].type==a.header_cell&&l.setNodeMarkup(i.tableStart+o[d],a.cell,c[d].attrs);if(l.steps.length==0)for(let d=0;d<o.length;d++)l.setNodeMarkup(i.tableStart+o[d],a.header_cell,c[d].attrs);n(l)}return!0}}function FM(t,s,n){const a=s.map.cellsInRect({left:0,top:0,right:t=="row"?s.map.width:1,bottom:t=="column"?s.map.height:1});for(let i=0;i<a.length;i++){const l=s.table.nodeAt(a[i]);if(l&&l.type!==n.header_cell)return!1}return!0}function px(t,s){return s=s||{useDeprecatedLogic:!1},s.useDeprecatedLogic?I2e(t):function(n,a){if(!Tl(n))return!1;if(a){const i=ta(n.schema),l=yo(n),o=n.tr,c=FM("row",l,i),d=FM("column",l,i),h=(t==="column"?c:t==="row"?d:!1)?1:0,f=t=="column"?{left:0,top:h,right:1,bottom:l.map.height}:t=="row"?{left:h,top:0,right:l.map.width,bottom:1}:l,x=t=="column"?d?i.cell:i.header_cell:t=="row"?c?i.cell:i.header_cell:i.cell;l.map.cellsInRect(f).forEach(b=>{const v=b+l.tableStart,w=o.doc.nodeAt(v);w&&o.setNodeMarkup(v,x,w.attrs)}),a(o)}return!0}}px("row",{useDeprecatedLogic:!0});px("column",{useDeprecatedLogic:!0});var M2e=px("cell",{useDeprecatedLogic:!0});function D2e(t,s){if(s<0){const n=t.nodeBefore;if(n)return t.pos-n.nodeSize;for(let a=t.index(-1)-1,i=t.before();a>=0;a--){const l=t.node(-1).child(a),o=l.lastChild;if(o)return i-1-o.nodeSize;i-=l.nodeSize}}else{if(t.index()<t.parent.childCount-1)return t.pos+t.nodeAfter.nodeSize;const n=t.node(-1);for(let a=t.indexAfter(-1),i=t.after();a<n.childCount;a++){const l=n.child(a);if(l.childCount)return i+1;i+=l.nodeSize}}return null}function $M(t){return function(s,n){if(!Tl(s))return!1;const a=D2e(Bv(s),t);if(a==null)return!1;if(n){const i=s.doc.resolve(a);n(s.tr.setSelection(kt.between(i,u2e(i))).scrollIntoView())}return!0}}function O2e(t,s){const n=t.selection.$anchor;for(let a=n.depth;a>0;a--)if(n.node(a).type.spec.tableRole=="table")return s&&s(t.tr.delete(n.before(a),n.after(a)).scrollIntoView()),!0;return!1}function gg(t,s){const n=t.selection;if(!(n instanceof Hs))return!1;if(s){const a=t.tr,i=ta(t.schema).cell.createAndFill().content;n.forEachCell((l,o)=>{l.content.eq(i)||a.replace(a.mapping.map(o+1),a.mapping.map(o+l.nodeSize-1),new ct(i,0,0))}),a.docChanged&&s(a)}return!0}function R2e(t){if(!t.size)return null;let{content:s,openStart:n,openEnd:a}=t;for(;s.childCount==1&&(n>0&&a>0||s.child(0).type.spec.tableRole=="table");)n--,a--,s=s.child(0).content;const i=s.child(0),l=i.type.spec.tableRole,o=i.type.schema,c=[];if(l=="row")for(let d=0;d<s.childCount;d++){let u=s.child(d).content;const h=d?0:Math.max(0,n-1),f=d<s.childCount-1?0:Math.max(0,a-1);(h||f)&&(u=RS(ta(o).row,new ct(u,h,f)).content),c.push(u)}else if(l=="cell"||l=="header_cell")c.push(n||a?RS(ta(o).row,new ct(s,n,a)).content:s);else return null;return L2e(o,c)}function L2e(t,s){const n=[];for(let i=0;i<s.length;i++){const l=s[i];for(let o=l.childCount-1;o>=0;o--){const{rowspan:c,colspan:d}=l.child(o).attrs;for(let u=i;u<i+c;u++)n[u]=(n[u]||0)+d}}let a=0;for(let i=0;i<n.length;i++)a=Math.max(a,n[i]);for(let i=0;i<n.length;i++)if(i>=s.length&&s.push(ze.empty),n[i]<a){const l=ta(t).cell.createAndFill(),o=[];for(let c=n[i];c<a;c++)o.push(l);s[i]=s[i].append(ze.from(o))}return{height:s.length,width:a,rows:s}}function RS(t,s){const n=t.createAndFill();return new Jz(n).replace(0,n.content.size,s).doc}function B2e({width:t,height:s,rows:n},a,i){if(t!=a){const l=[],o=[];for(let c=0;c<n.length;c++){const d=n[c],u=[];for(let h=l[c]||0,f=0;h<a;f++){let x=d.child(f%d.childCount);h+x.attrs.colspan>a&&(x=x.type.createChecked(Mu(x.attrs,x.attrs.colspan,h+x.attrs.colspan-a),x.content)),u.push(x),h+=x.attrs.colspan;for(let b=1;b<x.attrs.rowspan;b++)l[c+b]=(l[c+b]||0)+x.attrs.colspan}o.push(ze.from(u))}n=o,t=a}if(s!=i){const l=[];for(let o=0,c=0;o<i;o++,c++){const d=[],u=n[c%s];for(let h=0;h<u.childCount;h++){let f=u.child(h);o+f.attrs.rowspan>i&&(f=f.type.create({...f.attrs,rowspan:Math.max(1,i-f.attrs.rowspan)},f.content)),d.push(f)}l.push(ze.from(d))}n=l,s=i}return{width:t,height:s,rows:n}}function F2e(t,s,n,a,i,l,o){const c=t.doc.type.schema,d=ta(c);let u,h;if(i>s.width)for(let f=0,x=0;f<s.height;f++){const b=n.child(f);x+=b.nodeSize;const v=[];let w;b.lastChild==null||b.lastChild.type==d.cell?w=u||(u=d.cell.createAndFill()):w=h||(h=d.header_cell.createAndFill());for(let _=s.width;_<i;_++)v.push(w);t.insert(t.mapping.slice(o).map(x-1+a),v)}if(l>s.height){const f=[];for(let v=0,w=(s.height-1)*s.width;v<Math.max(s.width,i);v++){const _=v>=s.width?!1:n.nodeAt(s.map[w+v]).type==d.header_cell;f.push(_?h||(h=d.header_cell.createAndFill()):u||(u=d.cell.createAndFill()))}const x=d.row.create(null,ze.from(f)),b=[];for(let v=s.height;v<l;v++)b.push(x);t.insert(t.mapping.slice(o).map(a+n.nodeSize-2),b)}return!!(u||h)}function zM(t,s,n,a,i,l,o,c){if(o==0||o==s.height)return!1;let d=!1;for(let u=i;u<l;u++){const h=o*s.width+u,f=s.map[h];if(s.map[h-s.width]==f){d=!0;const x=n.nodeAt(f),{top:b,left:v}=s.findCell(f);t.setNodeMarkup(t.mapping.slice(c).map(f+a),null,{...x.attrs,rowspan:o-b}),t.insert(t.mapping.slice(c).map(s.positionAt(o,v,n)),x.type.createAndFill({...x.attrs,rowspan:b+x.attrs.rowspan-o})),u+=x.attrs.colspan-1}}return d}function UM(t,s,n,a,i,l,o,c){if(o==0||o==s.width)return!1;let d=!1;for(let u=i;u<l;u++){const h=u*s.width+o,f=s.map[h];if(s.map[h-1]==f){d=!0;const x=n.nodeAt(f),b=s.colCount(f),v=t.mapping.slice(c).map(f+a);t.setNodeMarkup(v,null,Mu(x.attrs,o-b,x.attrs.colspan-(o-b))),t.insert(v+x.nodeSize,x.type.createAndFill(Mu(x.attrs,0,o-b))),u+=x.attrs.rowspan-1}}return d}function VM(t,s,n,a,i){let l=n?t.doc.nodeAt(n-1):t.doc;if(!l)throw new Error("No table found");let o=Sn.get(l);const{top:c,left:d}=a,u=d+i.width,h=c+i.height,f=t.tr;let x=0;function b(){if(l=n?f.doc.nodeAt(n-1):f.doc,!l)throw new Error("No table found");o=Sn.get(l),x=f.mapping.maps.length}F2e(f,o,l,n,u,h,x)&&b(),zM(f,o,l,n,d,u,c,x)&&b(),zM(f,o,l,n,d,u,h,x)&&b(),UM(f,o,l,n,c,h,d,x)&&b(),UM(f,o,l,n,c,h,u,x)&&b();for(let v=c;v<h;v++){const w=o.positionAt(v,d,l),_=o.positionAt(v,u,l);f.replace(f.mapping.slice(x).map(w+n),f.mapping.slice(x).map(_+n),new ct(i.rows[v-c],0,0))}b(),f.setSelection(new Hs(f.doc.resolve(n+o.positionAt(c,d,l)),f.doc.resolve(n+o.positionAt(h-1,u-1,l)))),s(f)}var $2e=WU({ArrowLeft:yg("horiz",-1),ArrowRight:yg("horiz",1),ArrowUp:yg("vert",-1),ArrowDown:yg("vert",1),"Shift-ArrowLeft":bg("horiz",-1),"Shift-ArrowRight":bg("horiz",1),"Shift-ArrowUp":bg("vert",-1),"Shift-ArrowDown":bg("vert",1),Backspace:gg,"Mod-Backspace":gg,Delete:gg,"Mod-Delete":gg});function by(t,s,n){return n.eq(t.selection)?!1:(s&&s(t.tr.setSelection(n).scrollIntoView()),!0)}function yg(t,s){return(n,a,i)=>{if(!i)return!1;const l=n.selection;if(l instanceof Hs)return by(n,a,Bt.near(l.$headCell,s));if(t!="horiz"&&!l.empty)return!1;const o=TV(i,t,s);if(o==null)return!1;if(t=="horiz")return by(n,a,Bt.near(n.doc.resolve(l.head+s),s));{const c=n.doc.resolve(o),d=jV(c,t,s);let u;return d?u=Bt.near(d,1):s<0?u=Bt.near(n.doc.resolve(c.before(-1)),-1):u=Bt.near(n.doc.resolve(c.after(-1)),1),by(n,a,u)}}}function bg(t,s){return(n,a,i)=>{if(!i)return!1;const l=n.selection;let o;if(l instanceof Hs)o=l;else{const d=TV(i,t,s);if(d==null)return!1;o=new Hs(n.doc.resolve(d))}const c=jV(o.$headCell,t,s);return c?by(n,a,new Hs(o.$anchorCell,c)):!1}}function z2e(t,s){const n=t.state.doc,a=Ym(n.resolve(s));return a?(t.dispatch(t.state.tr.setSelection(new Hs(a))),!0):!1}function U2e(t,s,n){if(!Tl(t.state))return!1;let a=R2e(n);const i=t.state.selection;if(i instanceof Hs){a||(a={width:1,height:1,rows:[ze.from(RS(ta(t.state.schema).cell,n))]});const l=i.$anchorCell.node(-1),o=i.$anchorCell.start(-1),c=Sn.get(l).rectBetween(i.$anchorCell.pos-o,i.$headCell.pos-o);return a=B2e(a,c.right-c.left,c.bottom-c.top),VM(t.state,t.dispatch,o,c,a),!0}else if(a){const l=Bv(t.state),o=l.start(-1);return VM(t.state,t.dispatch,o,Sn.get(l.node(-1)).findCell(l.pos-o),a),!0}else return!1}function V2e(t,s){var n;if(s.ctrlKey||s.metaKey)return;const a=HM(t,s.target);let i;if(s.shiftKey&&t.state.selection instanceof Hs)l(t.state.selection.$anchorCell,s),s.preventDefault();else if(s.shiftKey&&a&&(i=Ym(t.state.selection.$anchor))!=null&&((n=Dj(t,s))==null?void 0:n.pos)!=i.pos)l(i,s),s.preventDefault();else if(!a)return;function l(d,u){let h=Dj(t,u);const f=Tc.getState(t.state)==null;if(!h||!O5(d,h))if(f)h=d;else return;const x=new Hs(d,h);if(f||!t.state.selection.eq(x)){const b=t.state.tr.setSelection(x);f&&b.setMeta(Tc,d.pos),t.dispatch(b)}}function o(){t.root.removeEventListener("mouseup",o),t.root.removeEventListener("dragstart",o),t.root.removeEventListener("mousemove",c),Tc.getState(t.state)!=null&&t.dispatch(t.state.tr.setMeta(Tc,-1))}function c(d){const u=d,h=Tc.getState(t.state);let f;if(h!=null)f=t.state.doc.resolve(h);else if(HM(t,u.target)!=a&&(f=Dj(t,s),!f))return o();f&&l(f,u)}t.root.addEventListener("mouseup",o),t.root.addEventListener("dragstart",o),t.root.addEventListener("mousemove",c)}function TV(t,s,n){if(!(t.state.selection instanceof kt))return null;const{$head:a}=t.state.selection;for(let i=a.depth-1;i>=0;i--){const l=a.node(i);if((n<0?a.index(i):a.indexAfter(i))!=(n<0?0:l.childCount))return null;if(l.type.spec.tableRole=="cell"||l.type.spec.tableRole=="header_cell"){const c=a.before(i),d=s=="vert"?n>0?"down":"up":n>0?"right":"left";return t.endOfTextblock(d)?c:null}}return null}function HM(t,s){for(;s&&s!=t.dom;s=s.parentNode)if(s.nodeName=="TD"||s.nodeName=="TH")return s;return null}function Dj(t,s){const n=t.posAtCoords({left:s.clientX,top:s.clientY});return n&&n?Ym(t.state.doc.resolve(n.pos)):null}var H2e=class{constructor(s,n){this.node=s,this.defaultCellMinWidth=n,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width",`${n}px`),this.colgroup=this.table.appendChild(document.createElement("colgroup")),LS(s,this.colgroup,this.table,n),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(s){return s.type!=this.node.type?!1:(this.node=s,LS(s,this.colgroup,this.table,this.defaultCellMinWidth),!0)}ignoreMutation(s){return s.type=="attributes"&&(s.target==this.table||this.colgroup.contains(s.target))}};function LS(t,s,n,a,i,l){var o;let c=0,d=!0,u=s.firstChild;const h=t.firstChild;if(h){for(let f=0,x=0;f<h.childCount;f++){const{colspan:b,colwidth:v}=h.child(f).attrs;for(let w=0;w<b;w++,x++){const _=i==x?l:v&&v[w],S=_?_+"px":"";if(c+=_||a,_||(d=!1),u)u.style.width!=S&&(u.style.width=S),u=u.nextSibling;else{const k=document.createElement("col");k.style.width=S,s.appendChild(k)}}}for(;u;){const f=u.nextSibling;(o=u.parentNode)==null||o.removeChild(u),u=f}d?(n.style.width=c+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=c+"px")}}var ii=new Bn("tableColumnResizing");function W2e({handleWidth:t=5,cellMinWidth:s=25,defaultCellMinWidth:n=100,View:a=H2e,lastColumnResizable:i=!0}={}){const l=new Ln({key:ii,state:{init(o,c){var d,u;const h=(u=(d=l.spec)==null?void 0:d.props)==null?void 0:u.nodeViews,f=ta(c.schema).table.name;return a&&h&&(h[f]=(x,b)=>new a(x,n,b)),new q2e(-1,!1)},apply(o,c){return c.apply(o)}},props:{attributes:o=>{const c=ii.getState(o);return c&&c.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(o,c)=>{G2e(o,c,t,i)},mouseleave:o=>{K2e(o)},mousedown:(o,c)=>{Y2e(o,c,s,n)}},decorations:o=>{const c=ii.getState(o);if(c&&c.activeHandle>-1)return e_e(o,c.activeHandle)},nodeViews:{}}});return l}var q2e=class vy{constructor(s,n){this.activeHandle=s,this.dragging=n}apply(s){const n=this,a=s.getMeta(ii);if(a&&a.setHandle!=null)return new vy(a.setHandle,!1);if(a&&a.setDragging!==void 0)return new vy(n.activeHandle,a.setDragging);if(n.activeHandle>-1&&s.docChanged){let i=s.mapping.map(n.activeHandle,-1);return OS(s.doc.resolve(i))||(i=-1),new vy(i,n.dragging)}return n}};function G2e(t,s,n,a){if(!t.editable)return;const i=ii.getState(t.state);if(i&&!i.dragging){const l=Q2e(s.target);let o=-1;if(l){const{left:c,right:d}=l.getBoundingClientRect();s.clientX-c<=n?o=WM(t,s,"left",n):d-s.clientX<=n&&(o=WM(t,s,"right",n))}if(o!=i.activeHandle){if(!a&&o!==-1){const c=t.state.doc.resolve(o),d=c.node(-1),u=Sn.get(d),h=c.start(-1);if(u.colCount(c.pos-h)+c.nodeAfter.attrs.colspan-1==u.width-1)return}PV(t,o)}}}function K2e(t){if(!t.editable)return;const s=ii.getState(t.state);s&&s.activeHandle>-1&&!s.dragging&&PV(t,-1)}function Y2e(t,s,n,a){var i;if(!t.editable)return!1;const l=(i=t.dom.ownerDocument.defaultView)!=null?i:window,o=ii.getState(t.state);if(!o||o.activeHandle==-1||o.dragging)return!1;const c=t.state.doc.nodeAt(o.activeHandle),d=X2e(t,o.activeHandle,c.attrs);t.dispatch(t.state.tr.setMeta(ii,{setDragging:{startX:s.clientX,startWidth:d}}));function u(f){l.removeEventListener("mouseup",u),l.removeEventListener("mousemove",h);const x=ii.getState(t.state);x!=null&&x.dragging&&(Z2e(t,x.activeHandle,qM(x.dragging,f,n)),t.dispatch(t.state.tr.setMeta(ii,{setDragging:null})))}function h(f){if(!f.which)return u(f);const x=ii.getState(t.state);if(x&&x.dragging){const b=qM(x.dragging,f,n);GM(t,x.activeHandle,b,a)}}return GM(t,o.activeHandle,d,a),l.addEventListener("mouseup",u),l.addEventListener("mousemove",h),s.preventDefault(),!0}function X2e(t,s,{colspan:n,colwidth:a}){const i=a&&a[a.length-1];if(i)return i;const l=t.domAtPos(s);let c=l.node.childNodes[l.offset].offsetWidth,d=n;if(a)for(let u=0;u<n;u++)a[u]&&(c-=a[u],d--);return c/d}function Q2e(t){for(;t&&t.nodeName!="TD"&&t.nodeName!="TH";)t=t.classList&&t.classList.contains("ProseMirror")?null:t.parentNode;return t}function WM(t,s,n,a){const i=n=="right"?-a:a,l=t.posAtCoords({left:s.clientX+i,top:s.clientY});if(!l)return-1;const{pos:o}=l,c=Ym(t.state.doc.resolve(o));if(!c)return-1;if(n=="right")return c.pos;const d=Sn.get(c.node(-1)),u=c.start(-1),h=d.map.indexOf(c.pos-u);return h%d.width==0?-1:u+d.map[h-1]}function qM(t,s,n){const a=s.clientX-t.startX;return Math.max(n,t.startWidth+a)}function PV(t,s){t.dispatch(t.state.tr.setMeta(ii,{setHandle:s}))}function Z2e(t,s,n){const a=t.state.doc.resolve(s),i=a.node(-1),l=Sn.get(i),o=a.start(-1),c=l.colCount(a.pos-o)+a.nodeAfter.attrs.colspan-1,d=t.state.tr;for(let u=0;u<l.height;u++){const h=u*l.width+c;if(u&&l.map[h]==l.map[h-l.width])continue;const f=l.map[h],x=i.nodeAt(f).attrs,b=x.colspan==1?0:c-l.colCount(f);if(x.colwidth&&x.colwidth[b]==n)continue;const v=x.colwidth?x.colwidth.slice():J2e(x.colspan);v[b]=n,d.setNodeMarkup(o+f,null,{...x,colwidth:v})}d.docChanged&&t.dispatch(d)}function GM(t,s,n,a){const i=t.state.doc.resolve(s),l=i.node(-1),o=i.start(-1),c=Sn.get(l).colCount(i.pos-o)+i.nodeAfter.attrs.colspan-1;let d=t.domAtPos(i.start(-1)).node;for(;d&&d.nodeName!="TABLE";)d=d.parentNode;d&&LS(l,d.firstChild,d,a,c,n)}function J2e(t){return Array(t).fill(0)}function e_e(t,s){var n;const a=[],i=t.doc.resolve(s),l=i.node(-1);if(!l)return In.empty;const o=Sn.get(l),c=i.start(-1),d=o.colCount(i.pos-c)+i.nodeAfter.attrs.colspan-1;for(let u=0;u<o.height;u++){const h=d+u*o.width;if((d==o.width-1||o.map[h]!=o.map[h+1])&&(u==0||o.map[h]!=o.map[h-o.width])){const f=o.map[h],x=c+f+l.nodeAt(f).nodeSize-1,b=document.createElement("div");b.className="column-resize-handle",(n=ii.getState(t))!=null&&n.dragging&&a.push(di.node(c+f,c+f+l.nodeAt(f).nodeSize,{class:"column-resize-dragging"})),a.push(di.widget(x,b))}}return In.create(t.doc,a)}function t_e({allowTableNodeSelection:t=!1}={}){return new Ln({key:Tc,state:{init(){return null},apply(s,n){const a=s.getMeta(Tc);if(a!=null)return a==-1?null:a;if(n==null||!s.docChanged)return n;const{deleted:i,pos:l}=s.mapping.mapResult(n);return i?null:l}},props:{decorations:f2e,handleDOMEvents:{mousedown:V2e},createSelectionBetween(s){return Tc.getState(s.state)!=null?s.state.selection:null},handleTripleClick:z2e,handleKeyDown:$2e,handlePaste:U2e},appendTransaction(s,n,a){return g2e(a,kV(a,n),t)}})}var IV=Zx.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{var s,n;const a=t.getAttribute("colwidth"),i=a?a.split(",").map(l=>parseInt(l,10)):null;if(!i){const l=(s=t.closest("table"))==null?void 0:s.querySelectorAll("colgroup > col"),o=Array.from(((n=t.parentElement)==null?void 0:n.children)||[]).indexOf(t);if(o&&o>-1&&l&&l[o]){const c=l[o].getAttribute("width");return c?[parseInt(c,10)]:null}}return i}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:t}){return["td",jd(this.options.HTMLAttributes,t),0]}}),s_e=Zx.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{const s=t.getAttribute("colwidth");return s?s.split(",").map(a=>parseInt(a,10)):null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:t}){return["th",jd(this.options.HTMLAttributes,t),0]}}),n_e=Zx.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:t}){return["tr",jd(this.options.HTMLAttributes,t),0]}});function BS(t,s){return s?["width",`${Math.max(s,t)}px`]:["min-width",`${t}px`]}function KM(t,s,n,a,i,l){var o;let c=0,d=!0,u=s.firstChild;const h=t.firstChild;if(h!==null)for(let x=0,b=0;x<h.childCount;x+=1){const{colspan:v,colwidth:w}=h.child(x).attrs;for(let _=0;_<v;_+=1,b+=1){const S=i===b?l:w&&w[_],k=S?`${S}px`:"";if(c+=S||a,S||(d=!1),u){if(u.style.width!==k){const[A,T]=BS(a,S);u.style.setProperty(A,T)}u=u.nextSibling}else{const A=document.createElement("col"),[T,P]=BS(a,S);A.style.setProperty(T,P),s.appendChild(A)}}}for(;u;){const x=u.nextSibling;(o=u.parentNode)==null||o.removeChild(u),u=x}const f=t.attrs.style&&typeof t.attrs.style=="string"&&/\bwidth\s*:/i.test(t.attrs.style);d&&!f?(n.style.width=`${c}px`,n.style.minWidth=""):(n.style.width="",n.style.minWidth=`${c}px`)}var r_e=class{constructor(t,s){this.node=t,this.cellMinWidth=s,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),t.attrs.style&&(this.table.style.cssText=t.attrs.style),this.colgroup=this.table.appendChild(document.createElement("colgroup")),KM(t,this.colgroup,this.table,s),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(t){return t.type!==this.node.type?!1:(this.node=t,KM(t,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(t){const s=t.target,n=this.dom.contains(s),a=this.contentDOM.contains(s);return!!(n&&!a&&(t.type==="attributes"||t.type==="childList"||t.type==="characterData"))}};function a_e(t,s,n,a){let i=0,l=!0;const o=[],c=t.firstChild;if(!c)return{};for(let f=0,x=0;f<c.childCount;f+=1){const{colspan:b,colwidth:v}=c.child(f).attrs;for(let w=0;w<b;w+=1,x+=1){const _=n===x?a:v&&v[w];i+=_||s,_||(l=!1);const[S,k]=BS(s,_);o.push(["col",{style:`${S}: ${k}`}])}}const d=l?`${i}px`:"",u=l?"":`${i}px`;return{colgroup:["colgroup",{},...o],tableWidth:d,tableMinWidth:u}}function YM(t,s){return t.createAndFill()}function i_e(t){if(t.cached.tableNodeTypes)return t.cached.tableNodeTypes;const s={};return Object.keys(t.nodes).forEach(n=>{const a=t.nodes[n];a.spec.tableRole&&(s[a.spec.tableRole]=a)}),t.cached.tableNodeTypes=s,s}function l_e(t,s,n,a,i){const l=i_e(t),o=[],c=[];for(let u=0;u<n;u+=1){const h=YM(l.cell);if(h&&c.push(h),a){const f=YM(l.header_cell);f&&o.push(f)}}const d=[];for(let u=0;u<s;u+=1)d.push(l.row.createChecked(null,a&&u===0?o:c));return l.table.createChecked(null,d)}function o_e(t){return t instanceof Hs}var vg=({editor:t})=>{const{selection:s}=t.state;if(!o_e(s))return!1;let n=0;const a=JU(s.ranges[0].$from,l=>l.type.name==="table");return a==null||a.node.descendants(l=>{if(l.type.name==="table")return!1;["tableCell","tableHeader"].includes(l.type.name)&&(n+=1)}),n===s.ranges.length?(t.commands.deleteTable(),!0):!1},c_e="";function d_e(t){return(t||"").replace(/\s+/g," ").trim()}function u_e(t,s,n={}){var a;const i=(a=n.cellLineSeparator)!=null?a:c_e;if(!t||!t.content||t.content.length===0)return"";const l=[];t.content.forEach(v=>{const w=[];v.content&&v.content.forEach(_=>{let S="";_.content&&Array.isArray(_.content)&&_.content.length>1?S=_.content.map(P=>s.renderChildren(P)).join(i):S=_.content?s.renderChildren(_.content):"";const k=d_e(S),A=_.type==="tableHeader";w.push({text:k,isHeader:A})}),l.push(w)});const o=l.reduce((v,w)=>Math.max(v,w.length),0);if(o===0)return"";const c=new Array(o).fill(0);l.forEach(v=>{var w;for(let _=0;_<o;_+=1){const k=(((w=v[_])==null?void 0:w.text)||"").length;k>c[_]&&(c[_]=k),c[_]<3&&(c[_]=3)}});const d=(v,w)=>v+" ".repeat(Math.max(0,w-v.length)),u=l[0],h=u.some(v=>v.isHeader);let f=`
`;const x=new Array(o).fill(0).map((v,w)=>h&&u[w]&&u[w].text||"");return f+=`| ${x.map((v,w)=>d(v,c[w])).join(" | ")} |
`,f+=`| ${c.map(v=>"-".repeat(Math.max(3,v))).join(" | ")} |
`,(h?l.slice(1):l).forEach(v=>{f+=`| ${new Array(o).fill(0).map((w,_)=>d(v[_]&&v[_].text||"",c[_])).join(" | ")} |
`}),f}var h_e=u_e,MV=Zx.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,renderWrapper:!1,handleWidth:5,cellMinWidth:25,View:r_e,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({node:t,HTMLAttributes:s}){const{colgroup:n,tableWidth:a,tableMinWidth:i}=a_e(t,this.options.cellMinWidth),l=s.style;function o(){return l||(a?`width: ${a}`:`min-width: ${i}`)}const c=["table",jd(this.options.HTMLAttributes,s,{style:o()}),n,["tbody",0]];return this.options.renderWrapper?["div",{class:"tableWrapper"},c]:c},parseMarkdown:(t,s)=>{const n=[];if(t.header){const a=[];t.header.forEach(i=>{a.push(s.createNode("tableHeader",{},[{type:"paragraph",content:s.parseInline(i.tokens)}]))}),n.push(s.createNode("tableRow",{},a))}return t.rows&&t.rows.forEach(a=>{const i=[];a.forEach(l=>{i.push(s.createNode("tableCell",{},[{type:"paragraph",content:s.parseInline(l.tokens)}]))}),n.push(s.createNode("tableRow",{},i))}),s.createNode("table",void 0,n)},renderMarkdown:(t,s)=>h_e(t,s),addCommands(){return{insertTable:({rows:t=3,cols:s=3,withHeaderRow:n=!0}={})=>({tr:a,dispatch:i,editor:l})=>{const o=l_e(l.schema,t,s,n);if(i){const c=a.selection.from+1;a.replaceSelectionWith(o).scrollIntoView().setSelection(kt.near(a.doc.resolve(c)))}return!0},addColumnBefore:()=>({state:t,dispatch:s})=>v2e(t,s),addColumnAfter:()=>({state:t,dispatch:s})=>N2e(t,s),deleteColumn:()=>({state:t,dispatch:s})=>j2e(t,s),addRowBefore:()=>({state:t,dispatch:s})=>S2e(t,s),addRowAfter:()=>({state:t,dispatch:s})=>C2e(t,s),deleteRow:()=>({state:t,dispatch:s})=>A2e(t,s),deleteTable:()=>({state:t,dispatch:s})=>O2e(t,s),mergeCells:()=>({state:t,dispatch:s})=>LM(t,s),splitCell:()=>({state:t,dispatch:s})=>BM(t,s),toggleHeaderColumn:()=>({state:t,dispatch:s})=>px("column")(t,s),toggleHeaderRow:()=>({state:t,dispatch:s})=>px("row")(t,s),toggleHeaderCell:()=>({state:t,dispatch:s})=>M2e(t,s),mergeOrSplit:()=>({state:t,dispatch:s})=>LM(t,s)?!0:BM(t,s),setCellAttribute:(t,s)=>({state:n,dispatch:a})=>P2e(t,s)(n,a),goToNextCell:()=>({state:t,dispatch:s})=>$M(1)(t,s),goToPreviousCell:()=>({state:t,dispatch:s})=>$M(-1)(t,s),fixTables:()=>({state:t,dispatch:s})=>(s&&kV(t),!0),setCellSelection:t=>({tr:s,dispatch:n})=>{if(n){const a=Hs.create(s.doc,t.anchorCell,t.headCell);s.setSelection(a)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:vg,"Mod-Backspace":vg,Delete:vg,"Mod-Delete":vg}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[W2e({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,defaultCellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],t_e({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(t){const s={name:t.name,options:t.options,storage:t.storage};return{tableRole:Pu(ym(t,"tableRole",s))}}});_r.create({name:"tableKit",addExtensions(){const t=[];return this.options.table!==!1&&t.push(MV.configure(this.options.table)),this.options.tableCell!==!1&&t.push(IV.configure(this.options.tableCell)),this.options.tableHeader!==!1&&t.push(s_e.configure(this.options.tableHeader)),this.options.tableRow!==!1&&t.push(n_e.configure(this.options.tableRow)),t}});MV.extend({addAttributes(){var t;return{...(t=this.parent)==null?void 0:t.call(this),borderPreset:{default:null,parseHTML:s=>{const n=s.getAttribute("class")||"";return/\btbl-border-all\b/.test(n)?"all":/\btbl-border-h\b/.test(n)?"h":/\btbl-border-v\b/.test(n)?"v":/\btbl-border-none\b/.test(n)?"none":null},renderHTML:s=>({class:s.borderPreset?`tbl-border-${s.borderPreset}`:null,style:"border-collapse:collapse;"})}}}}).configure({resizable:!0});IV.extend({addAttributes(){var t;return{...(t=this.parent)==null?void 0:t.call(this),backgroundColor:{default:null,parseHTML:s=>s.style.backgroundColor||s.getAttribute("data-bg")||null,renderHTML:s=>{const n={};return s.backgroundColor&&(n.style=`background-color:${s.backgroundColor}`),{...n,"data-bg":s.backgroundColor||null}}}}}});const Oj={Patient:[{label:"UHID",token:"{{ patient.uhid }}"},{label:"Name",token:"{{ patient.name }}"},{label:"Gender",token:"{{ patient.gender }}"},{label:"DOB",token:'{{ patient.dob | datefmt("%d-%b-%Y") }}'},{label:"Phone",token:"{{ patient.phone }}"},{label:"Email",token:"{{ patient.email }}"},{label:"Address",token:"{{ patient.address }}"}],"Clinical  Last Visit":[{label:"Visit Date",token:'{{ clinical.last_visit.date | datefmt("%d-%b-%Y") }}'},{label:"Doctor",token:"{{ clinical.last_visit.doctor }}"},{label:"Department",token:"{{ clinical.last_visit.department }}"},{label:"Chief Complaints",token:"{{ clinical.last_visit.chief_complaints }}"},{label:"Diagnosis",token:"{{ clinical.last_visit.diagnosis }}"}],"Clinical  Lab Results (loop)":[{label:"Lab Results Table",token:`<table border="1" cellspacing="0" cellpadding="6">
  <tr><th>Test</th><th>Code</th><th>Status</th><th>Result</th><th>Units</th></tr>
  {% for r in clinical.lab_results %}
    <tr>
      <td>{{ r.test }}</td><td>{{ r.code }}</td>
      <td>{{ r.status }}</td><td>{{ r.result }}</td><td>{{ r.units }}</td>
    </tr>
  {% endfor %}
</table>`}],Billing:[{label:"Invoices Count",token:"{{ billing.summary.invoices_count }}"},{label:"Total",token:"{{ billing.summary.total_net }}"},{label:"Paid",token:"{{ billing.summary.total_paid }}"},{label:"Balance",token:"{{ billing.summary.balance }}"}]};function m_e({onInsert:t}){const[s,n]=y.useState(()=>new Set(Object.keys(Oj))),[a,i]=y.useState(""),l=y.useMemo(()=>{const d=a.trim().toLowerCase();return Object.entries(Oj).filter(([h])=>s.has(h)).map(([h,f])=>{const x=d?f.filter(b=>b.label.toLowerCase().includes(d)||b.token.toLowerCase().includes(d)):f;return{group:h,items:x}}).filter(h=>h.items.length>0)},[s,a]),o=d=>{const u=new Set(s);u.has(d)?u.delete(d):u.add(d),n(u)},c=(d,u)=>{d.dataTransfer.setData("text/x-token",u),d.dataTransfer.setData("text/plain",u)};return r.jsxs("div",{className:"border rounded-lg p-3 bg-white space-y-3",children:[r.jsx("div",{className:"text-sm font-semibold",children:"Field Catalog"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:Object.keys(Oj).map(d=>r.jsxs("label",{className:"inline-flex items-center gap-1 text-xs border rounded px-2 py-1 bg-gray-50",children:[r.jsx("input",{type:"checkbox",checked:s.has(d),onChange:()=>o(d)}),d]},d))}),r.jsx("input",{value:a,onChange:d=>i(d.target.value),placeholder:"Search fields",className:"w-full border rounded px-2 py-1 text-sm"}),r.jsx("div",{className:"space-y-4",children:l.map(({group:d,items:u})=>r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] font-semibold text-gray-600 mb-1",children:d}),r.jsx("div",{className:"flex flex-wrap gap-2",children:u.map((h,f)=>r.jsx("div",{draggable:!0,onDragStart:x=>c(x,h.token),onDoubleClick:()=>t&&t(h.token),className:"cursor-grab active:cursor-grabbing text-[11px] px-2 py-1 rounded-md bg-gray-50 hover:bg-gray-100 border",title:"Drag into editor or double-click to insert",children:h.label},f))})]},d))}),r.jsxs("div",{className:"pt-2 border-t",children:[r.jsx("div",{className:"text-[11px] text-gray-600 mb-1",children:"Custom token"}),r.jsxs("form",{onSubmit:d=>{d.preventDefault();const u=d.target.elements.token.value.trim();u&&(t&&t(u),d.target.reset())},children:[r.jsx("input",{name:"token",placeholder:"e.g. {{ my.custom }}",className:"border rounded px-2 py-1 text-sm w-full"}),r.jsx("button",{className:"mt-2 w-full px-2 py-1 border rounded text-sm",children:"Insert"})]})]})]})}const Ny=`@page {
  size: A4;
  margin: 18mm 16mm 18mm 16mm;
}
header.tpl-header { position: running(doc-header); }
footer.tpl-footer { position: running(doc-footer); }
@page {
  @top-center { content: element(doc-header); }
  @bottom-center { content: element(doc-footer); }
}
body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; font-size: 12px; }
h1,h2,h3 { margin: 0 0 8px 0; }
table { width: 100%; border-collapse: collapse; }
th, td { padding: 6px; }`,Ai={HeaderMinimal:`
<header class="tpl-header" style="font-size:12px;border-bottom:1px solid #ccc;padding-bottom:6px;display:flex;justify-content:space-between;align-items:center;">
  <div>
    <div style="font-weight:700">Hospital Name</div>
    <div style="font-size:11px;">Address line 1, City</div>
  </div>
  <img src="/media/uploads/sample/hospital_logo.png" alt="Logo" style="height:28px"/>
</header>`.trim(),FooterMinimal:`
<footer class="tpl-footer" style="font-size:11px;border-top:1px solid #ccc;padding-top:6px;display:flex;justify-content:space-between;">
  <div>UHID: {{ patient.uhid }} | {{ patient.name }}</div>
  <div>Page: counter(page) / counter(pages)</div>
</footer>`.trim(),SignatureBlock:`
<div style="margin-top:60px;display:flex;gap:40px;">
  <div>Patient/Guardian Signature: __________________</div>
  <div>Doctor: __________________</div>
  <div>Witness: __________________</div>
</div>`.trim(),CoverPage:`
<section style="display:flex;flex-direction:column;min-height:240mm;justify-content:center;align-items:center;text-align:center;gap:8px;">
  <img src="/media/uploads/sample/hospital_logo.png" alt="Logo" style="height:64px;opacity:0.8"/>
  <h1 style="font-size:28px;">Patient Clinical Summary</h1>
  <div style="font-size:14px">UHID: {{ patient.uhid }} &nbsp; | &nbsp; {{ patient.name }}</div>
  <div style="margin-top:40px;font-size:12px;color:#666">Generated on {{ now }}</div>
</section>`.trim()},f_e=[{key:"clinical_summary_v2",title:"Clinical Summary  Header/Footer + Tables",category:"report",html:`
<h1>Clinical Summary</h1>
<p><b>UHID:</b> {{ patient.uhid }}<br/>
<b>Name:</b> {{ patient.name }}<br/>
<b>Gender:</b> {{ patient.gender }}<br/>
<b>DOB:</b> {{ patient.dob | datefmt("%d-%b-%Y") }}</p>

{% if clinical.last_visit.date %}
<h3>Last Visit</h3>
<p><b>Date:</b> {{ clinical.last_visit.date | datefmt("%d-%b-%Y") }}<br/>
<b>Doctor:</b> {{ clinical.last_visit.doctor }}<br/>
<b>Department:</b> {{ clinical.last_visit.department }}<br/>
<b>Chief Complaints:</b> {{ clinical.last_visit.chief_complaints }}<br/>
<b>Diagnosis:</b> {{ clinical.last_visit.diagnosis }}</p>
{% endif %}

{% if clinical.lab_results %}
<h3>Recent Lab Results</h3>
<table border="1" cellspacing="0" cellpadding="6">
  <tr><th>Test</th><th>Code</th><th>Status</th><th>Result</th><th>Units</th></tr>
  {% for r in clinical.lab_results %}
    <tr>
      <td>{{ r.test }}</td><td>{{ r.code }}</td><td>{{ r.status }}</td><td>{{ r.result }}</td><td>{{ r.units }}</td>
    </tr>
  {% endfor %}
</table>
{% endif %}

{% if billing.summary %}
<h3>Billing Summary</h3>
<p>
<b>Invoices:</b> {{ billing.summary.invoices_count }} |
<b>Total:</b> {{ billing.summary.total_net }} |
<b>Paid:</b> {{ billing.summary.total_paid }} |
<b>Balance:</b> {{ billing.summary.balance }}
</p>
{% endif %}
`.trim(),css:Ny,header:Ai.HeaderMinimal,footer:Ai.FooterMinimal},{key:"general_consent_v2",title:"General Consent  with Signature",category:"consent",html:`
<h2 style="text-align:center;">General Consent for Treatment</h2>
<p><b>UHID:</b> {{ patient.uhid }}<br/>
<b>Patient Name:</b> {{ patient.name }}<br/>
<b>Date:</b> {{ now }}</p>

<p>
I, {{ patient.name }}, hereby give consent for the proposed {{ data.procedure_name }}
under the care of {{ data.doctor_name }}.
</p>

<p><b>Risks explained:</b> {{ data.risks_text }}</p>

${Ai.SignatureBlock}
`.trim(),css:Ny,header:Ai.HeaderMinimal,footer:Ai.FooterMinimal},{key:"cover_plus_clinical",title:"Cover Page + Clinical",category:"report",html:`${Ai.CoverPage}
<div style="page-break-before:always;"></div>
<h1>Clinical Details</h1>
<p><b>UHID:</b> {{ patient.uhid }} &nbsp; <b>Name:</b> {{ patient.name }}</p>
{% if clinical.last_visit.date %}
<p><b>Last Visit:</b> {{ clinical.last_visit.date | datefmt("%d-%b-%Y") }}  {{ clinical.last_visit.doctor }}</p>
{% endif %}
`.trim(),css:Ny,header:Ai.HeaderMinimal,footer:Ai.FooterMinimal}];function p_e({onUseLayout:t,onInsertBlock:s}){const n=y.useMemo(()=>[{key:"HeaderMinimal",title:"Header  Minimal",html:Ai.HeaderMinimal},{key:"FooterMinimal",title:"Footer  Minimal",html:Ai.FooterMinimal},{key:"SignatureBlock",title:"Signature Block",html:Ai.SignatureBlock},{key:"CoverPage",title:"Cover Page",html:Ai.CoverPage}],[]);return r.jsxs("div",{className:"border rounded-lg p-3 bg-white space-y-3",children:[r.jsx("div",{className:"text-sm font-semibold",children:"Template Gallery"}),r.jsx("div",{className:"space-y-2",children:f_e.map(a=>r.jsxs("div",{className:"border rounded p-2",children:[r.jsx("div",{className:"text-sm font-medium",children:a.title}),r.jsxs("div",{className:"text-[11px] text-gray-500 mb-2",children:["Category: ",a.category]}),r.jsx("div",{className:"flex gap-2",children:r.jsx("button",{className:"px-2 py-1 rounded text-sm border",onClick:()=>t&&t(a),children:"Use Layout"})})]},a.key))}),r.jsxs("div",{className:"pt-2 border-t",children:[r.jsx("div",{className:"text-sm font-semibold mb-2",children:"Blocks"}),r.jsx("div",{className:"grid grid-cols-2 gap-2",children:n.map(a=>r.jsxs("button",{className:"border rounded p-2 text-left hover:bg-gray-50",onClick:()=>s&&s(a.html),title:"Insert into current editor",children:[r.jsx("div",{className:"text-xs font-medium",children:a.title}),r.jsx("div",{className:"text-[10px] text-gray-500",children:"Click to insert"})]},a.key))})]})]})}const x_e=[{key:"A4",label:"A4 (210297 mm)"},{key:"A5",label:"A5 (148210 mm)"},{key:"Letter",label:"Letter (8.511 in)"},{key:"Legal",label:"Legal (8.514 in)"}];function g_e({css:t="",onApply:s,onClose:n}){const[a,i]=y.useState("A4"),[l,o]=y.useState("portrait"),[c,d]=y.useState(18),[u,h]=y.useState(16),[f,x]=y.useState(18),[b,v]=y.useState(16),[w,_]=y.useState(!0);y.useEffect(()=>{const k=t.match(/@page\s*{([\s\S]*?)}/);if(!k)return;const A=k[1],T=D=>(A.match(D)||[,""])[1],P=T(/size:\s*([^;]+);/i);if(P){const D=P.trim().split(/\s+/);i(D[0]),D[1]&&o(D[1])}const O=(D,I)=>{const M=T(D);return M?parseInt(M,10):I};d(O(/margin-top:\s*([0-9]+)mm/i,c)),h(O(/margin-right:\s*([0-9]+)mm/i,u)),x(O(/margin-bottom:\s*([0-9]+)mm/i,f)),v(O(/margin-left:\s*([0-9]+)mm/i,b))},[]);const S=()=>`@page {
  size: ${a} ${l};
  margin-top: ${c}mm;
  margin-right: ${u}mm;
  margin-bottom: ${f}mm;
  margin-left: ${b}mm;
  ${w?'@bottom-right { content: "Page " counter(page) " of " counter(pages); font-size:10px; }':""}
}`;return r.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:r.jsxs("div",{className:"bg-white rounded-lg w-full max-w-xl",children:[r.jsx("div",{className:"px-4 py-3 border-b font-semibold",children:"Page Setup"}),r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("label",{className:"text-sm",children:["Size",r.jsx("select",{className:"w-full border rounded px-2 py-1",value:a,onChange:k=>i(k.target.value),children:x_e.map(k=>r.jsx("option",{value:k.key,children:k.label},k.key))})]}),r.jsxs("label",{className:"text-sm",children:["Orientation",r.jsxs("select",{className:"w-full border rounded px-2 py-1",value:l,onChange:k=>o(k.target.value),children:[r.jsx("option",{value:"portrait",children:"Portrait"}),r.jsx("option",{value:"landscape",children:"Landscape"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[r.jsxs("label",{className:"text-sm",children:["Top (mm)",r.jsx("input",{type:"number",className:"w-full border rounded px-2 py-1",value:c,onChange:k=>d(+k.target.value)})]}),r.jsxs("label",{className:"text-sm",children:["Right (mm)",r.jsx("input",{type:"number",className:"w-full border rounded px-2 py-1",value:u,onChange:k=>h(+k.target.value)})]}),r.jsxs("label",{className:"text-sm",children:["Bottom (mm)",r.jsx("input",{type:"number",className:"w-full border rounded px-2 py-1",value:f,onChange:k=>x(+k.target.value)})]}),r.jsxs("label",{className:"text-sm",children:["Left (mm)",r.jsx("input",{type:"number",className:"w-full border rounded px-2 py-1",value:b,onChange:k=>v(+k.target.value)})]})]}),r.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[r.jsx("input",{type:"checkbox",checked:w,onChange:k=>_(k.target.checked)}),"Show page numbers (WeasyPrint)"]}),r.jsx("pre",{className:"text-xs bg-gray-50 border rounded p-2 overflow-auto",children:S()})]}),r.jsxs("div",{className:"px-4 py-3 border-t flex justify-end gap-2",children:[r.jsx("button",{className:"px-3 py-2 border rounded",onClick:n,children:"Cancel"}),r.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white",onClick:()=>s&&s(S()),children:"Apply"})]})]})})}const Rj=Ny;function XM({mode:t="create"}){var I;const{id:s}=xd(),n=Va(),i=((I=Xi().state)==null?void 0:I.preset)||null,[l,o]=y.useState({name:"",code:"",category:"report",subcategory:"",description:"",css:Rj,is_active:!0}),[c,d]=y.useState(""),[u,h]=y.useState("<h1>New Template</h1><p>Use the Field Catalog or Gallery.</p>"),[f,x]=y.useState(""),[b,v]=y.useState("body"),w=t==="edit";y.useEffect(()=>{!w||!s||(async()=>{const B=(await Nye(s)).data;o({name:B.name,code:B.code,category:B.category,subcategory:B.subcategory||"",description:B.description||"",css:B.css||Rj,is_active:!!B.is_active});const L=B.html||"",F=L.match(/<header[^>]*class="[^"]*tpl-header[^"]*"[^>]*>[\s\S]*?<\/header>/i),V=L.match(/<footer[^>]*class="[^"]*tpl-footer[^"]*"[^>]*>[\s\S]*?<\/footer>/i);d(F?F[0]:""),x(V?V[0]:"");let $=L;F&&($=$.replace(F[0],"")),V&&($=$.replace(V[0],"")),h($.trim()||"")})()},[w,s]),y.useEffect(()=>{!i||w||(o(M=>({...M,category:i.category||"report",name:M.name||i.title||"Untitled",code:M.code||(i.key?`${i.key}-${Date.now()}`:""),css:i.css||Rj})),d(i.header||""),x(i.footer||""),h(i.html||""))},[i,w]);const _=y.useMemo(()=>[c,u,f].filter(Boolean).join(`
`),[c,u,f]),S=async()=>{if(!l.name.trim()||!l.code.trim()){se.error("Name and unique code are required");return}const M={...l,html:_,placeholders:{header:!!c,footer:!!f}};try{w?(await jye(s,M),se.success("Template updated")):(await wye(M),se.success("Template created")),n("/templates")}catch{}},k=M=>{o(B=>({...B,category:M.category||B.category,css:M.css||B.css,name:B.name||M.title,code:B.code||(M.key?`${M.key}-${Date.now()}`:"")})),d(M.header||""),x(M.footer||""),h(M.html||""),se.success("Layout applied")},A=M=>{b==="header"?d(B=>`${B}
${M}`):b==="footer"?x(B=>`${B}
${M}`):h(B=>`${B}
${M}`)},T=M=>{A(M)},[P,O]=y.useState(!1),D=M=>{o(B=>{const L=/@page\s*{[\s\S]*?}/.test(B.css||"");return{...B,css:L?B.css.replace(/@page\s*{[\s\S]*?}/,M):M+`
`+(B.css||"")}}),O(!1)};return r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>O(!0),className:"px-3 py-2 rounded border",children:"Page Setup"}),r.jsx("button",{onClick:S,className:"px-3 py-2 rounded bg-blue-600 text-white",children:"Save"}),P&&r.jsx(g_e,{css:l.css,onApply:D,onClose:()=>O(!1)})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h1",{className:"text-xl font-semibold",children:w?"Edit Template":"Create Template"}),r.jsx("div",{className:"flex gap-2",children:r.jsx("button",{onClick:S,className:"px-3 py-2 rounded bg-blue-600 text-white",children:"Save"})})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[r.jsx("input",{value:l.name,onChange:M=>o({...l,name:M.target.value}),className:"border rounded px-3 py-2",placeholder:"Template Name"}),r.jsx("input",{value:l.code,onChange:M=>o({...l,code:M.target.value}),className:"border rounded px-3 py-2",placeholder:"Unique Code (e.g., clinical_summary_v2)",disabled:w}),r.jsxs("select",{value:l.category,onChange:M=>o({...l,category:M.target.value}),className:"border rounded px-3 py-2",children:[r.jsx("option",{value:"report",children:"Report"}),r.jsx("option",{value:"consent",children:"Consent"})]}),r.jsx("input",{value:l.subcategory,onChange:M=>o({...l,subcategory:M.target.value}),className:"border rounded px-3 py-2",placeholder:"Subcategory (optional)"}),r.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[r.jsx("input",{type:"checkbox",checked:l.is_active,onChange:M=>o({...l,is_active:M.target.checked})}),"Active"]})]}),r.jsx("textarea",{value:l.description,onChange:M=>o({...l,description:M.target.value}),placeholder:"Description (optional)",className:"border rounded px-3 py-2 w-full min-h-[80px]"}),r.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[r.jsxs("div",{className:"col-span-12 lg:col-span-8 space-y-3",children:[r.jsx("div",{className:"flex gap-2",children:["header","body","footer"].map(M=>r.jsx("button",{onClick:()=>v(M),className:["px-3 py-1 rounded border text-sm",b===M?"bg-blue-600 text-white border-blue-600":"bg-white"].join(" "),children:M.toUpperCase()},M))}),b==="header"&&r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium mb-1",children:"Header (running top)"}),r.jsx(xj,{value:c,onChange:d})]}),b==="body"&&r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium mb-1",children:"Body"}),r.jsx(xj,{value:u,onChange:h})]}),b==="footer"&&r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium mb-1",children:"Footer (running bottom)"}),r.jsx(xj,{value:f,onChange:x})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium mb-1",children:"CSS (print styles)"}),r.jsx("textarea",{value:l.css,onChange:M=>o({...l,css:M.target.value}),className:"border rounded px-3 py-2 w-full min-h-[160px] font-mono text-xs"})]})]}),r.jsxs("div",{className:"col-span-12 lg:col-span-4 space-y-3",children:[r.jsx(m_e,{onInsert:T}),r.jsx(p_e,{onUseLayout:k,onInsertBlock:A}),r.jsxs("div",{className:"text-[11px] text-gray-500",children:[r.jsx("b",{children:"Note:"})," Save the template to use server-side merged preview & PDF."]})]})]})]})}function y_e(t,s){const n=window.URL.createObjectURL(t),a=document.createElement("a");a.href=n,a.download=s||"download",document.body.appendChild(a),a.click(),a.remove(),window.URL.revokeObjectURL(n)}function DV({value:t,onChange:s,onSelect:n}){const[a,i]=y.useState(""),[l,o]=y.useState([]),[c,d]=y.useState(!1);y.useEffect(()=>{const f=setTimeout(async()=>{const x=(a||"").trim();if(x.length<2){o([]);return}d(!0);try{const{data:b}=await vz(x),v=(b==null?void 0:b.results)||(b==null?void 0:b.items)||b||[];o(v)}catch(b){console.error("lookupPatients failed",b),o([])}finally{d(!1)}},300);return()=>clearTimeout(f)},[a]);function u(h){const f=s||n;f&&f(h.id,h)}return r.jsxs("div",{className:"space-y-1",children:[r.jsx("input",{value:a,onChange:h=>i(h.target.value),placeholder:"Search patient (UHID / Name / Phone)",className:"w-full rounded-md border border-slate-300 px-2.5 py-1.5 text-xs md:text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500"}),r.jsxs("div",{className:"mt-1 max-h-56 overflow-auto rounded-xl border border-slate-200 bg-white shadow-sm",children:[c&&r.jsx("div",{className:"px-3 py-2 text-[11px] text-slate-400",children:"Searching"}),!c&&l.length===0&&r.jsx("div",{className:"px-3 py-2 text-[11px] text-slate-400",children:"Type at least 2 characters to search."}),l.map(h=>{const f=h.uhid||`NH-${String(h.id??"").toString().padStart(6,"0")}`,x=h.name||[h.first_name,h.last_name].filter(Boolean).join(" ")||"Unnamed";return r.jsxs("button",{type:"button",onClick:()=>u(h),className:"w-full text-left px-3 py-2 text-xs md:text-sm hover:bg-indigo-50 flex flex-col gap-0.5",children:[r.jsxs("span",{className:"font-medium text-slate-800",children:[f,"  ",x]}),r.jsxs("span",{className:"text-[11px] text-slate-500",children:[h.gender?`${h.gender}  `:"",h.phone||"No phone"]})]},h.id)})]}),t&&r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Selected patient ID:"," ",r.jsx("span",{className:"font-semibold text-slate-800",children:t})]})]})}function b_e(){const[t,s]=y.useState("saved"),[n,a]=y.useState(null),[i,l]=y.useState([]),[o,c]=y.useState(""),[d,u]=y.useState(""),[h,f]=y.useState(1),[x,b]=y.useState("");y.useEffect(()=>{(async()=>{const _=await Qk({category:"report",active:!0});l(_.data||[])})()},[]);const v=async()=>{if(!n||!o)return se.info("Select template and patient");try{const _=await Nz(Number(o),Number(n));u(_.data.html||"")}catch{}},w=async()=>{if(!n||!o)return se.info("Select template and patient");try{const _=x?await Cye(Number(o),{patient_id:Number(n),inline:!1,engine:x}):await Sye(Number(o),Number(n));y_e(_,`patient-${n}.pdf`)}catch{}};return r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsx("h1",{className:"text-xl font-semibold",children:"Generate Patient Reports"}),r.jsx("div",{className:"flex gap-2",children:["saved","predefined","customized"].map(_=>r.jsx("button",{onClick:()=>s(_),className:["px-3 py-1 rounded border text-sm",t===_?"bg-blue-600 text-white border-blue-600":"bg-white"].join(" "),children:_==="saved"?"Saved Formats":_==="predefined"?"Predefined":"Customized"},_))}),t==="saved"&&r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"md:col-span-1 border rounded-lg p-3 bg-white space-y-3",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-semibold mb-2",children:"1) Select Template"}),r.jsxs("select",{value:o,onChange:_=>c(_.target.value),className:"border rounded px-3 py-2 w-full",children:[r.jsx("option",{value:"",children:"-- choose report template --"}),i.map(_=>r.jsxs("option",{value:_.id,children:[_.name," (",_.code,")"]},_.id))]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-semibold mb-2",children:"2) Choose Patient"}),r.jsx(DV,{value:n,onSelect:a})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("label",{className:"text-sm",children:"Engine"}),r.jsxs("select",{value:x,onChange:_=>b(_.target.value),className:"border rounded px-2 py-1 text-sm",children:[r.jsx("option",{value:"",children:"Auto"}),r.jsx("option",{value:"weasyprint",children:"WeasyPrint"}),r.jsx("option",{value:"xhtml2pdf",children:"xhtml2pdf (fallback)"})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:v,className:"px-3 py-2 border rounded",children:"Preview"}),r.jsx("button",{onClick:w,className:"px-3 py-2 rounded bg-blue-600 text-white",children:"Download PDF"})]})]})]}),r.jsxs("div",{className:"md:col-span-2 border rounded-lg overflow-hidden bg-white",children:[r.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",children:[r.jsx("div",{className:"text-sm text-gray-600",children:"Preview"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{className:"px-2 py-1 border rounded text-sm",onClick:()=>f(_=>Math.max(.5,+(_-.1).toFixed(2))),children:""}),r.jsxs("div",{className:"text-xs w-12 text-center",children:[Math.round(h*100),"%"]}),r.jsx("button",{className:"px-2 py-1 border rounded text-sm",onClick:()=>f(_=>Math.min(2,+(_+.1).toFixed(2))),children:"+"})]})]}),r.jsx("div",{className:"w-full",style:{transform:`scale(${h})`,transformOrigin:"0 0"},children:r.jsx("iframe",{title:"report-preview",className:"w-full min-h-[900px]",srcDoc:d||""})})]})]}),t==="predefined"&&r.jsxs("div",{className:"grid md:grid-cols-3 gap-3",children:[r.jsx("div",{className:"md:col-span-1",children:r.jsx(TemplateGallery,{onUseLayout:_=>window.location.assign("/templates/new"),onInsertBlock:()=>{}})}),r.jsx("div",{className:"md:col-span-2 border rounded-lg p-4 bg-white text-sm text-gray-600",children:'Pick a layout from the left to open the editor pre-filled. Save it, then return to "Saved Formats".'})]}),t==="customized"&&r.jsxs("div",{className:"border rounded-lg p-4 bg-white",children:[r.jsx("div",{className:"text-sm mb-2",children:"Create your own template with header/footer, drag-drop fields and blocks."}),r.jsx("a",{href:"/templates/new",className:"px-3 py-2 rounded bg-blue-600 text-white inline-block",children:"Open Template Builder"})]})]})}function v_e(){const[t,s]=y.useState(""),[n,a]=y.useState([]),[i,l]=y.useState(""),[o,c]=y.useState({procedure_name:"",doctor_name:"",risks_text:"",witness_name:""}),[d,u]=y.useState(""),[h,f]=y.useState([]),x=async w=>{if(!w){f([]);return}try{const _=await Aye(Number(w));f(_.data||[])}catch{}};y.useEffect(()=>{(async()=>{const w=await Qk({category:"consent",active:!0});a(w.data||[])})()},[]);const b=async()=>{if(!t||!i){se.info("Select consent template and enter Patient ID");return}const w={data:{...o}},_=await Nz(Number(i),Number(t),w);u(_.data.html||"")},v=async()=>{if(!t||!i){se.info("Select consent template and enter Patient ID");return}try{await kye(Number(t),{template_id:Number(i),data:{...o},finalize:!0,signed_by:o.doctor_name||void 0,witness_name:o.witness_name||void 0}),se.success("Consent saved"),x(t)}catch{}};return r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsx("h1",{className:"text-xl font-semibold",children:"Patient Consents"}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"md:col-span-1 border rounded-lg p-3 bg-white",children:[r.jsx("div",{className:"text-sm font-semibold mb-2",children:"Consent Template"}),r.jsxs("select",{value:i,onChange:w=>l(w.target.value),className:"border rounded px-3 py-2 w-full",children:[r.jsx("option",{value:"",children:"-- choose consent template --"}),n.map(w=>r.jsxs("option",{value:w.id,children:[w.name," (",w.code,")"]},w.id))]}),r.jsx("div",{className:"mt-3 text-sm font-semibold",children:"Patient"}),r.jsx("input",{value:t,onChange:w=>s(w.target.value),className:"border rounded px-3 py-2 w-full",placeholder:"Patient ID",onBlur:()=>x(e.target.value)}),r.jsx("div",{className:"mt-3 text-sm font-semibold",children:"Extra Fields"}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("input",{value:o.procedure_name,onChange:w=>c({...o,procedure_name:w.target.value}),className:"border rounded px-3 py-2 w-full",placeholder:"Procedure name"}),r.jsx("input",{value:o.doctor_name,onChange:w=>c({...o,doctor_name:w.target.value}),className:"border rounded px-3 py-2 w-full",placeholder:"Doctor name"}),r.jsx("textarea",{value:o.risks_text,onChange:w=>c({...o,risks_text:w.target.value}),className:"border rounded px-3 py-2 w-full min-h-[80px]",placeholder:"Risks explained..."}),r.jsx("input",{value:o.witness_name,onChange:w=>c({...o,witness_name:w.target.value}),className:"border rounded px-3 py-2 w-full",placeholder:"Witness name"})]}),r.jsxs("div",{className:"mt-3 flex gap-2",children:[r.jsx("button",{onClick:b,className:"px-3 py-2 border rounded",children:"Preview"}),r.jsx("button",{onClick:v,className:"px-3 py-2 rounded bg-blue-600 text-white",children:"Save PDF"})]})]}),r.jsxs("div",{className:"md:col-span-2 space-y-3",children:[r.jsx("div",{className:"border rounded-lg overflow-hidden bg-white",children:r.jsx("iframe",{title:"consent-preview",className:"w-full min-h-[400px]",srcDoc:d||""})}),r.jsxs("div",{className:"border rounded-lg bg-white",children:[r.jsxs("div",{className:"px-3 py-2 border-b text-sm font-semibold",children:["Existing Consents (Patient #",t||"-",")"]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left",children:"#"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Template"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"Status"}),r.jsx("th",{className:"px-3 py-2 text-left",children:"PDF"})]})}),r.jsxs("tbody",{children:[h.map(w=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-3 py-2",children:w.id}),r.jsx("td",{className:"px-3 py-2",children:w.template_id}),r.jsx("td",{className:"px-3 py-2",children:w.status}),r.jsx("td",{className:"px-3 py-2",children:w.pdf_path?r.jsx("a",{href:w.pdf_path,target:"_blank",rel:"noreferrer",className:"text-blue-700 underline",children:"Open"}):r.jsx("span",{className:"text-gray-400",children:"-"})})]},w.id)),h.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:4,className:"px-3 py-6 text-center text-gray-500",children:"No consents"})})]})]})})]})]})]})]})}function N_e(t={}){return J.get("/dashboard/data",{params:t})}var w_e=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function R5(t){if(typeof t!="string")return!1;var s=w_e;return s.includes(t)}var j_e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function OV(t){if(typeof t!="string")return!1;var s=j_e;return s.includes(t)}function RV(t){return typeof t=="string"&&t.startsWith("data-")}function co(t){var s=Object.entries(t).filter(n=>{var[a]=n;return OV(a)||RV(a)});return Object.fromEntries(s)}function xx(t){if(t==null)return null;if(y.isValidElement(t)&&typeof t.props=="object"&&t.props!==null){var s=t.props;return co(s)}return typeof t=="object"&&!Array.isArray(t)?co(t):null}function qi(t){var s=Object.entries(t).filter(n=>{var[a]=n;return OV(a)||RV(a)||R5(a)});return Object.fromEntries(s)}var __e=["children","width","height","viewBox","className","style","title","desc"];function FS(){return FS=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},FS.apply(null,arguments)}function S_e(t,s){if(t==null)return{};var n,a,i=C_e(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function C_e(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}var LV=y.forwardRef((t,s)=>{var{children:n,width:a,height:i,viewBox:l,className:o,style:c,title:d,desc:u}=t,h=S_e(t,__e),f=l||{width:a,height:i,x:0,y:0},x=vs("recharts-surface",o);return y.createElement("svg",FS({},qi(h),{className:x,width:a,height:i,style:c,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:s}),y.createElement("title",null,d),y.createElement("desc",null,u),n)}),k_e=["children","className"];function $S(){return $S=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},$S.apply(null,arguments)}function A_e(t,s){if(t==null)return{};var n,a,i=E_e(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function E_e(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}var xa=y.forwardRef((t,s)=>{var{children:n,className:a}=t,i=A_e(t,k_e),l=vs("recharts-layer",a);return y.createElement("g",$S({className:l},qi(i),{ref:s}),n)}),T_e=y.createContext(null);function zs(t){return function(){return t}}const BV=Math.cos,M1=Math.sin,Pl=Math.sqrt,D1=Math.PI,Fv=2*D1,zS=Math.PI,US=2*zS,zd=1e-6,P_e=US-zd;function FV(t){this._+=t[0];for(let s=1,n=t.length;s<n;++s)this._+=arguments[s]+t[s]}function I_e(t){let s=Math.floor(t);if(!(s>=0))throw new Error(`invalid digits: ${t}`);if(s>15)return FV;const n=10**s;return function(a){this._+=a[0];for(let i=1,l=a.length;i<l;++i)this._+=Math.round(arguments[i]*n)/n+a[i]}}class M_e{constructor(s){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=s==null?FV:I_e(s)}moveTo(s,n){this._append`M${this._x0=this._x1=+s},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(s,n){this._append`L${this._x1=+s},${this._y1=+n}`}quadraticCurveTo(s,n,a,i){this._append`Q${+s},${+n},${this._x1=+a},${this._y1=+i}`}bezierCurveTo(s,n,a,i,l,o){this._append`C${+s},${+n},${+a},${+i},${this._x1=+l},${this._y1=+o}`}arcTo(s,n,a,i,l){if(s=+s,n=+n,a=+a,i=+i,l=+l,l<0)throw new Error(`negative radius: ${l}`);let o=this._x1,c=this._y1,d=a-s,u=i-n,h=o-s,f=c-n,x=h*h+f*f;if(this._x1===null)this._append`M${this._x1=s},${this._y1=n}`;else if(x>zd)if(!(Math.abs(f*d-u*h)>zd)||!l)this._append`L${this._x1=s},${this._y1=n}`;else{let b=a-o,v=i-c,w=d*d+u*u,_=b*b+v*v,S=Math.sqrt(w),k=Math.sqrt(x),A=l*Math.tan((zS-Math.acos((w+x-_)/(2*S*k)))/2),T=A/k,P=A/S;Math.abs(T-1)>zd&&this._append`L${s+T*h},${n+T*f}`,this._append`A${l},${l},0,0,${+(f*b>h*v)},${this._x1=s+P*d},${this._y1=n+P*u}`}}arc(s,n,a,i,l,o){if(s=+s,n=+n,a=+a,o=!!o,a<0)throw new Error(`negative radius: ${a}`);let c=a*Math.cos(i),d=a*Math.sin(i),u=s+c,h=n+d,f=1^o,x=o?i-l:l-i;this._x1===null?this._append`M${u},${h}`:(Math.abs(this._x1-u)>zd||Math.abs(this._y1-h)>zd)&&this._append`L${u},${h}`,a&&(x<0&&(x=x%US+US),x>P_e?this._append`A${a},${a},0,1,${f},${s-c},${n-d}A${a},${a},0,1,${f},${this._x1=u},${this._y1=h}`:x>zd&&this._append`A${a},${a},0,${+(x>=zS)},${f},${this._x1=s+a*Math.cos(l)},${this._y1=n+a*Math.sin(l)}`)}rect(s,n,a,i){this._append`M${this._x0=this._x1=+s},${this._y0=this._y1=+n}h${a=+a}v${+i}h${-a}Z`}toString(){return this._}}function L5(t){let s=3;return t.digits=function(n){if(!arguments.length)return s;if(n==null)s=null;else{const a=Math.floor(n);if(!(a>=0))throw new RangeError(`invalid digits: ${n}`);s=a}return t},()=>new M_e(s)}function B5(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function $V(t){this._context=t}$V.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,s){switch(t=+t,s=+s,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,s):this._context.moveTo(t,s);break;case 1:this._point=2;default:this._context.lineTo(t,s);break}}};function $v(t){return new $V(t)}function zV(t){return t[0]}function UV(t){return t[1]}function VV(t,s){var n=zs(!0),a=null,i=$v,l=null,o=L5(c);t=typeof t=="function"?t:t===void 0?zV:zs(t),s=typeof s=="function"?s:s===void 0?UV:zs(s);function c(d){var u,h=(d=B5(d)).length,f,x=!1,b;for(a==null&&(l=i(b=o())),u=0;u<=h;++u)!(u<h&&n(f=d[u],u,d))===x&&((x=!x)?l.lineStart():l.lineEnd()),x&&l.point(+t(f,u,d),+s(f,u,d));if(b)return l=null,b+""||null}return c.x=function(d){return arguments.length?(t=typeof d=="function"?d:zs(+d),c):t},c.y=function(d){return arguments.length?(s=typeof d=="function"?d:zs(+d),c):s},c.defined=function(d){return arguments.length?(n=typeof d=="function"?d:zs(!!d),c):n},c.curve=function(d){return arguments.length?(i=d,a!=null&&(l=i(a)),c):i},c.context=function(d){return arguments.length?(d==null?a=l=null:l=i(a=d),c):a},c}function Ng(t,s,n){var a=null,i=zs(!0),l=null,o=$v,c=null,d=L5(u);t=typeof t=="function"?t:t===void 0?zV:zs(+t),s=typeof s=="function"?s:zs(s===void 0?0:+s),n=typeof n=="function"?n:n===void 0?UV:zs(+n);function u(f){var x,b,v,w=(f=B5(f)).length,_,S=!1,k,A=new Array(w),T=new Array(w);for(l==null&&(c=o(k=d())),x=0;x<=w;++x){if(!(x<w&&i(_=f[x],x,f))===S)if(S=!S)b=x,c.areaStart(),c.lineStart();else{for(c.lineEnd(),c.lineStart(),v=x-1;v>=b;--v)c.point(A[v],T[v]);c.lineEnd(),c.areaEnd()}S&&(A[x]=+t(_,x,f),T[x]=+s(_,x,f),c.point(a?+a(_,x,f):A[x],n?+n(_,x,f):T[x]))}if(k)return c=null,k+""||null}function h(){return VV().defined(i).curve(o).context(l)}return u.x=function(f){return arguments.length?(t=typeof f=="function"?f:zs(+f),a=null,u):t},u.x0=function(f){return arguments.length?(t=typeof f=="function"?f:zs(+f),u):t},u.x1=function(f){return arguments.length?(a=f==null?null:typeof f=="function"?f:zs(+f),u):a},u.y=function(f){return arguments.length?(s=typeof f=="function"?f:zs(+f),n=null,u):s},u.y0=function(f){return arguments.length?(s=typeof f=="function"?f:zs(+f),u):s},u.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:zs(+f),u):n},u.lineX0=u.lineY0=function(){return h().x(t).y(s)},u.lineY1=function(){return h().x(t).y(n)},u.lineX1=function(){return h().x(a).y(s)},u.defined=function(f){return arguments.length?(i=typeof f=="function"?f:zs(!!f),u):i},u.curve=function(f){return arguments.length?(o=f,l!=null&&(c=o(l)),u):o},u.context=function(f){return arguments.length?(f==null?l=c=null:c=o(l=f),u):l},u}class HV{constructor(s,n){this._context=s,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(s,n){switch(s=+s,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(s,n):this._context.moveTo(s,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+s)/2,this._y0,this._x0,n,s,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,s,this._y0,s,n);break}}this._x0=s,this._y0=n}}function D_e(t){return new HV(t,!0)}function O_e(t){return new HV(t,!1)}const F5={draw(t,s){const n=Pl(s/D1);t.moveTo(n,0),t.arc(0,0,n,0,Fv)}},R_e={draw(t,s){const n=Pl(s/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},WV=Pl(1/3),L_e=WV*2,B_e={draw(t,s){const n=Pl(s/L_e),a=n*WV;t.moveTo(0,-n),t.lineTo(a,0),t.lineTo(0,n),t.lineTo(-a,0),t.closePath()}},F_e={draw(t,s){const n=Pl(s),a=-n/2;t.rect(a,a,n,n)}},$_e=.8908130915292852,qV=M1(D1/10)/M1(7*D1/10),z_e=M1(Fv/10)*qV,U_e=-BV(Fv/10)*qV,V_e={draw(t,s){const n=Pl(s*$_e),a=z_e*n,i=U_e*n;t.moveTo(0,-n),t.lineTo(a,i);for(let l=1;l<5;++l){const o=Fv*l/5,c=BV(o),d=M1(o);t.lineTo(d*n,-c*n),t.lineTo(c*a-d*i,d*a+c*i)}t.closePath()}},Lj=Pl(3),H_e={draw(t,s){const n=-Pl(s/(Lj*3));t.moveTo(0,n*2),t.lineTo(-Lj*n,-n),t.lineTo(Lj*n,-n),t.closePath()}},_i=-.5,Si=Pl(3)/2,VS=1/Pl(12),W_e=(VS/2+1)*3,q_e={draw(t,s){const n=Pl(s/W_e),a=n/2,i=n*VS,l=a,o=n*VS+n,c=-l,d=o;t.moveTo(a,i),t.lineTo(l,o),t.lineTo(c,d),t.lineTo(_i*a-Si*i,Si*a+_i*i),t.lineTo(_i*l-Si*o,Si*l+_i*o),t.lineTo(_i*c-Si*d,Si*c+_i*d),t.lineTo(_i*a+Si*i,_i*i-Si*a),t.lineTo(_i*l+Si*o,_i*o-Si*l),t.lineTo(_i*c+Si*d,_i*d-Si*c),t.closePath()}};function G_e(t,s){let n=null,a=L5(i);t=typeof t=="function"?t:zs(t||F5),s=typeof s=="function"?s:zs(s===void 0?64:+s);function i(){let l;if(n||(n=l=a()),t.apply(this,arguments).draw(n,+s.apply(this,arguments)),l)return n=null,l+""||null}return i.type=function(l){return arguments.length?(t=typeof l=="function"?l:zs(l),i):t},i.size=function(l){return arguments.length?(s=typeof l=="function"?l:zs(+l),i):s},i.context=function(l){return arguments.length?(n=l??null,i):n},i}function O1(){}function R1(t,s,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+s)/6,(t._y0+4*t._y1+n)/6)}function GV(t){this._context=t}GV.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:R1(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,s){switch(t=+t,s=+s,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,s):this._context.moveTo(t,s);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:R1(this,t,s);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=s}};function K_e(t){return new GV(t)}function KV(t){this._context=t}KV.prototype={areaStart:O1,areaEnd:O1,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,s){switch(t=+t,s=+s,this._point){case 0:this._point=1,this._x2=t,this._y2=s;break;case 1:this._point=2,this._x3=t,this._y3=s;break;case 2:this._point=3,this._x4=t,this._y4=s,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+s)/6);break;default:R1(this,t,s);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=s}};function Y_e(t){return new KV(t)}function YV(t){this._context=t}YV.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,s){switch(t=+t,s=+s,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,a=(this._y0+4*this._y1+s)/6;this._line?this._context.lineTo(n,a):this._context.moveTo(n,a);break;case 3:this._point=4;default:R1(this,t,s);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=s}};function X_e(t){return new YV(t)}function XV(t){this._context=t}XV.prototype={areaStart:O1,areaEnd:O1,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,s){t=+t,s=+s,this._point?this._context.lineTo(t,s):(this._point=1,this._context.moveTo(t,s))}};function Q_e(t){return new XV(t)}function QM(t){return t<0?-1:1}function ZM(t,s,n){var a=t._x1-t._x0,i=s-t._x1,l=(t._y1-t._y0)/(a||i<0&&-0),o=(n-t._y1)/(i||a<0&&-0),c=(l*i+o*a)/(a+i);return(QM(l)+QM(o))*Math.min(Math.abs(l),Math.abs(o),.5*Math.abs(c))||0}function JM(t,s){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-s)/2:s}function Bj(t,s,n){var a=t._x0,i=t._y0,l=t._x1,o=t._y1,c=(l-a)/3;t._context.bezierCurveTo(a+c,i+c*s,l-c,o-c*n,l,o)}function L1(t){this._context=t}L1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Bj(this,this._t0,JM(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,s){var n=NaN;if(t=+t,s=+s,!(t===this._x1&&s===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,s):this._context.moveTo(t,s);break;case 1:this._point=2;break;case 2:this._point=3,Bj(this,JM(this,n=ZM(this,t,s)),n);break;default:Bj(this,this._t0,n=ZM(this,t,s));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=s,this._t0=n}}};function QV(t){this._context=new ZV(t)}(QV.prototype=Object.create(L1.prototype)).point=function(t,s){L1.prototype.point.call(this,s,t)};function ZV(t){this._context=t}ZV.prototype={moveTo:function(t,s){this._context.moveTo(s,t)},closePath:function(){this._context.closePath()},lineTo:function(t,s){this._context.lineTo(s,t)},bezierCurveTo:function(t,s,n,a,i,l){this._context.bezierCurveTo(s,t,a,n,l,i)}};function Z_e(t){return new L1(t)}function J_e(t){return new QV(t)}function JV(t){this._context=t}JV.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,s=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],s[0]):this._context.moveTo(t[0],s[0]),n===2)this._context.lineTo(t[1],s[1]);else for(var a=eD(t),i=eD(s),l=0,o=1;o<n;++l,++o)this._context.bezierCurveTo(a[0][l],i[0][l],a[1][l],i[1][l],t[o],s[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,s){this._x.push(+t),this._y.push(+s)}};function eD(t){var s,n=t.length-1,a,i=new Array(n),l=new Array(n),o=new Array(n);for(i[0]=0,l[0]=2,o[0]=t[0]+2*t[1],s=1;s<n-1;++s)i[s]=1,l[s]=4,o[s]=4*t[s]+2*t[s+1];for(i[n-1]=2,l[n-1]=7,o[n-1]=8*t[n-1]+t[n],s=1;s<n;++s)a=i[s]/l[s-1],l[s]-=a,o[s]-=a*o[s-1];for(i[n-1]=o[n-1]/l[n-1],s=n-2;s>=0;--s)i[s]=(o[s]-i[s+1])/l[s];for(l[n-1]=(t[n]+i[n-1])/2,s=0;s<n-1;++s)l[s]=2*t[s+1]-i[s+1];return[i,l]}function eSe(t){return new JV(t)}function zv(t,s){this._context=t,this._t=s}zv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,s){switch(t=+t,s=+s,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,s):this._context.moveTo(t,s);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,s),this._context.lineTo(t,s);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,s)}break}}this._x=t,this._y=s}};function tSe(t){return new zv(t,.5)}function sSe(t){return new zv(t,0)}function nSe(t){return new zv(t,1)}function Nm(t,s){if((o=t.length)>1)for(var n=1,a,i,l=t[s[0]],o,c=l.length;n<o;++n)for(i=l,l=t[s[n]],a=0;a<c;++a)l[a][1]+=l[a][0]=isNaN(i[a][1])?i[a][0]:i[a][1]}function HS(t){for(var s=t.length,n=new Array(s);--s>=0;)n[s]=s;return n}function rSe(t,s){return t[s]}function aSe(t){const s=[];return s.key=t,s}function iSe(){var t=zs([]),s=HS,n=Nm,a=rSe;function i(l){var o=Array.from(t.apply(this,arguments),aSe),c,d=o.length,u=-1,h;for(const f of l)for(c=0,++u;c<d;++c)(o[c][u]=[0,+a(f,o[c].key,u,l)]).data=f;for(c=0,h=B5(s(o));c<d;++c)o[h[c]].index=c;return n(o,h),o}return i.keys=function(l){return arguments.length?(t=typeof l=="function"?l:zs(Array.from(l)),i):t},i.value=function(l){return arguments.length?(a=typeof l=="function"?l:zs(+l),i):a},i.order=function(l){return arguments.length?(s=l==null?HS:typeof l=="function"?l:zs(Array.from(l)),i):s},i.offset=function(l){return arguments.length?(n=l??Nm,i):n},i}function lSe(t,s){if((a=t.length)>0){for(var n,a,i=0,l=t[0].length,o;i<l;++i){for(o=n=0;n<a;++n)o+=t[n][i][1]||0;if(o)for(n=0;n<a;++n)t[n][i][1]/=o}Nm(t,s)}}function oSe(t,s){if((i=t.length)>0){for(var n=0,a=t[s[0]],i,l=a.length;n<l;++n){for(var o=0,c=0;o<i;++o)c+=t[o][n][1]||0;a[n][1]+=a[n][0]=-c/2}Nm(t,s)}}function cSe(t,s){if(!(!((o=t.length)>0)||!((l=(i=t[s[0]]).length)>0))){for(var n=0,a=1,i,l,o;a<l;++a){for(var c=0,d=0,u=0;c<o;++c){for(var h=t[s[c]],f=h[a][1]||0,x=h[a-1][1]||0,b=(f-x)/2,v=0;v<c;++v){var w=t[s[v]],_=w[a][1]||0,S=w[a-1][1]||0;b+=_-S}d+=f,u+=b*f}i[a-1][1]+=i[a-1][0]=n,d&&(n-=u/d)}i[a-1][1]+=i[a-1][0]=n,Nm(t,s)}}var Uv={},eH={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){return n==="__proto__"}t.isUnsafeProperty=s})(eH);var $5={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){switch(typeof n){case"number":case"symbol":return!1;case"string":return n.includes(".")||n.includes("[")||n.includes("]")}}t.isDeepKey=s})($5);var Vv={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){var a;return typeof n=="string"||typeof n=="symbol"?n:Object.is((a=n==null?void 0:n.valueOf)==null?void 0:a.call(n),-0)?"-0":String(n)}t.toKey=s})(Vv);var Hv={},tH={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){if(n==null)return"";if(typeof n=="string")return n;if(Array.isArray(n))return n.map(s).join(",");const a=String(n);return a==="0"&&Object.is(Number(n),-0)?"-0":a}t.toString=s})(tH);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=tH,n=Vv;function a(i){if(Array.isArray(i))return i.map(n.toKey);if(typeof i=="symbol")return[i];i=s.toString(i);const l=[],o=i.length;if(o===0)return l;let c=0,d="",u="",h=!1;for(i.charCodeAt(0)===46&&(l.push(""),c++);c<o;){const f=i[c];u?f==="\\"&&c+1<o?(c++,d+=i[c]):f===u?u="":d+=f:h?f==='"'||f==="'"?u=f:f==="]"?(h=!1,l.push(d),d=""):d+=f:f==="["?(h=!0,d&&(l.push(d),d="")):f==="."?d&&(l.push(d),d=""):d+=f,c++}return d&&l.push(d),l}t.toPath=a})(Hv);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=eH,n=$5,a=Vv,i=Hv;function l(c,d,u){if(c==null)return u;switch(typeof d){case"string":{if(s.isUnsafeProperty(d))return u;const h=c[d];return h===void 0?n.isDeepKey(d)?l(c,i.toPath(d),u):u:h}case"number":case"symbol":{typeof d=="number"&&(d=a.toKey(d));const h=c[d];return h===void 0?u:h}default:{if(Array.isArray(d))return o(c,d,u);if(Object.is(d==null?void 0:d.valueOf(),-0)?d="-0":d=String(d),s.isUnsafeProperty(d))return u;const h=c[d];return h===void 0?u:h}}}function o(c,d,u){if(d.length===0)return u;let h=c;for(let f=0;f<d.length;f++){if(h==null||s.isUnsafeProperty(d[f]))return u;h=h[d[f]]}return h===void 0?u:h}t.get=l})(Uv);var dSe=Uv.get;const Du=Yi(dSe);var Lr=t=>t===0?0:t>0?1:-1,uo=t=>typeof t=="number"&&t!=+t,Go=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,Dt=t=>(typeof t=="number"||t instanceof Number)&&!uo(t),ho=t=>Dt(t)||typeof t=="string",uSe=0,gx=t=>{var s=++uSe;return"".concat(t||"").concat(s)},Qr=function(s,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Dt(s)&&typeof s!="string")return a;var l;if(Go(s)){if(n==null)return a;var o=s.indexOf("%");l=n*parseFloat(s.slice(0,o))/100}else l=+s;return uo(l)&&(l=a),i&&n!=null&&l>n&&(l=n),l},sH=t=>{if(!Array.isArray(t))return!1;for(var s=t.length,n={},a=0;a<s;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1};function tr(t,s,n){return Dt(t)&&Dt(s)?t+n*(s-t):s}function hSe(t,s,n){if(!(!t||!t.length))return t.find(a=>a&&(typeof s=="function"?s(a):Du(a,s))===n)}var jr=t=>t===null||typeof t>"u",Jx=t=>jr(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1));function mSe(t){return t!=null}function Yu(){}var fSe=["type","size","sizeType"];function WS(){return WS=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},WS.apply(null,arguments)}function tD(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function sD(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?tD(Object(n),!0).forEach(function(a){pSe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tD(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function pSe(t,s,n){return(s=xSe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function xSe(t){var s=gSe(t,"string");return typeof s=="symbol"?s:s+""}function gSe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function ySe(t,s){if(t==null)return{};var n,a,i=bSe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function bSe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}var nH={symbolCircle:F5,symbolCross:R_e,symbolDiamond:B_e,symbolSquare:F_e,symbolStar:V_e,symbolTriangle:H_e,symbolWye:q_e},vSe=Math.PI/180,NSe=t=>{var s="symbol".concat(Jx(t));return nH[s]||F5},wSe=(t,s,n)=>{if(s==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*vSe;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.tan(a)**2)}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},jSe=(t,s)=>{nH["symbol".concat(Jx(t))]=s},rH=t=>{var{type:s="circle",size:n=64,sizeType:a="area"}=t,i=ySe(t,fSe),l=sD(sD({},i),{},{type:s,size:n,sizeType:a}),o="circle";typeof s=="string"&&(o=s);var c=()=>{var x=NSe(o),b=G_e().type(x).size(wSe(n,a,o)),v=b();if(v!==null)return v},{className:d,cx:u,cy:h}=l,f=qi(l);return Dt(u)&&Dt(h)&&Dt(n)?y.createElement("path",WS({},f,{className:vs("recharts-symbols",d),transform:"translate(".concat(u,", ").concat(h,")"),d:c()})):null};rH.registerSymbol=jSe;var aH=t=>"radius"in t&&"startAngle"in t&&"endAngle"in t,_Se=(t,s)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(y.isValidElement(t)&&(n=t.props),typeof n!="object"&&typeof n!="function")return null;var a={};return Object.keys(n).forEach(i=>{R5(i)&&(a[i]=l=>n[i](n,l))}),a},SSe=(t,s,n)=>a=>(t(s,n,a),null),Wv=(t,s,n)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var a=null;return Object.keys(t).forEach(i=>{var l=t[i];R5(i)&&typeof l=="function"&&(a||(a={}),a[i]=SSe(l,s,n))}),a};function nD(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function CSe(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?nD(Object(n),!0).forEach(function(a){kSe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nD(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function kSe(t,s,n){return(s=ASe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function ASe(t){var s=ESe(t,"string");return typeof s=="symbol"?s:s+""}function ESe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function ba(t,s){var n=CSe({},t),a=s,i=Object.keys(s),l=i.reduce((o,c)=>(o[c]===void 0&&a[c]!==void 0&&(o[c]=a[c]),o),n);return l}var iH={},lH={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n,a){const i=new Map;for(let l=0;l<n.length;l++){const o=n[l],c=a(o);i.has(c)||i.set(c,o)}return Array.from(i.values())}t.uniqBy=s})(lH);var z5={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){return n}t.identity=s})(z5);var oH={},qv={},cH={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){return Number.isSafeInteger(n)&&n>=0}t.isLength=s})(cH);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=cH;function n(a){return a!=null&&typeof a!="function"&&s.isLength(a.length)}t.isArrayLike=n})(qv);var dH={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){return typeof n=="object"&&n!==null}t.isObjectLike=s})(dH);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=qv,n=dH;function a(i){return n.isObjectLike(i)&&s.isArrayLike(i)}t.isArrayLikeObject=a})(oH);var uH={},hH={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=Uv;function n(a){return function(i){return s.get(i,a)}}t.property=n})(hH);var mH={},U5={},fH={},V5={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){return n!==null&&(typeof n=="object"||typeof n=="function")}t.isObject=s})(V5);var H5={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){return n==null||typeof n!="object"&&typeof n!="function"}t.isPrimitive=s})(H5);var W5={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n,a){return n===a||Number.isNaN(n)&&Number.isNaN(a)}t.eq=s})(W5);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=V5,n=H5,a=W5;function i(h,f,x){return typeof x!="function"?i(h,f,()=>{}):l(h,f,function b(v,w,_,S,k,A){const T=x(v,w,_,S,k,A);return T!==void 0?!!T:l(v,w,b,A)},new Map)}function l(h,f,x,b){if(f===h)return!0;switch(typeof f){case"object":return o(h,f,x,b);case"function":return Object.keys(f).length>0?l(h,{...f},x,b):a.eq(h,f);default:return s.isObject(h)?typeof f=="string"?f==="":!0:a.eq(h,f)}}function o(h,f,x,b){if(f==null)return!0;if(Array.isArray(f))return d(h,f,x,b);if(f instanceof Map)return c(h,f,x,b);if(f instanceof Set)return u(h,f,x,b);const v=Object.keys(f);if(h==null)return v.length===0;if(v.length===0)return!0;if(b!=null&&b.has(f))return b.get(f)===h;b==null||b.set(f,h);try{for(let w=0;w<v.length;w++){const _=v[w];if(!n.isPrimitive(h)&&!(_ in h)||f[_]===void 0&&h[_]!==void 0||f[_]===null&&h[_]!==null||!x(h[_],f[_],_,h,f,b))return!1}return!0}finally{b==null||b.delete(f)}}function c(h,f,x,b){if(f.size===0)return!0;if(!(h instanceof Map))return!1;for(const[v,w]of f.entries()){const _=h.get(v);if(x(_,w,v,h,f,b)===!1)return!1}return!0}function d(h,f,x,b){if(f.length===0)return!0;if(!Array.isArray(h))return!1;const v=new Set;for(let w=0;w<f.length;w++){const _=f[w];let S=!1;for(let k=0;k<h.length;k++){if(v.has(k))continue;const A=h[k];let T=!1;if(x(A,_,w,h,f,b)&&(T=!0),T){v.add(k),S=!0;break}}if(!S)return!1}return!0}function u(h,f,x,b){return f.size===0?!0:h instanceof Set?d([...h],[...f],x,b):!1}t.isMatchWith=i,t.isSetMatch=u})(fH);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=fH;function n(a,i){return s.isMatchWith(a,i,()=>{})}t.isMatch=n})(U5);var pH={},q5={},xH={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){return Object.getOwnPropertySymbols(n).filter(a=>Object.prototype.propertyIsEnumerable.call(n,a))}t.getSymbols=s})(xH);var G5={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}t.getTag=s})(G5);var K5={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s="[object RegExp]",n="[object String]",a="[object Number]",i="[object Boolean]",l="[object Arguments]",o="[object Symbol]",c="[object Date]",d="[object Map]",u="[object Set]",h="[object Array]",f="[object Function]",x="[object ArrayBuffer]",b="[object Object]",v="[object Error]",w="[object DataView]",_="[object Uint8Array]",S="[object Uint8ClampedArray]",k="[object Uint16Array]",A="[object Uint32Array]",T="[object BigUint64Array]",P="[object Int8Array]",O="[object Int16Array]",D="[object Int32Array]",I="[object BigInt64Array]",M="[object Float32Array]",B="[object Float64Array]";t.argumentsTag=l,t.arrayBufferTag=x,t.arrayTag=h,t.bigInt64ArrayTag=I,t.bigUint64ArrayTag=T,t.booleanTag=i,t.dataViewTag=w,t.dateTag=c,t.errorTag=v,t.float32ArrayTag=M,t.float64ArrayTag=B,t.functionTag=f,t.int16ArrayTag=O,t.int32ArrayTag=D,t.int8ArrayTag=P,t.mapTag=d,t.numberTag=a,t.objectTag=b,t.regexpTag=s,t.setTag=u,t.stringTag=n,t.symbolTag=o,t.uint16ArrayTag=k,t.uint32ArrayTag=A,t.uint8ArrayTag=_,t.uint8ClampedArrayTag=S})(K5);var gH={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}t.isTypedArray=s})(gH);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=xH,n=G5,a=K5,i=H5,l=gH;function o(h,f){return c(h,void 0,h,new Map,f)}function c(h,f,x,b=new Map,v=void 0){const w=v==null?void 0:v(h,f,x,b);if(w!==void 0)return w;if(i.isPrimitive(h))return h;if(b.has(h))return b.get(h);if(Array.isArray(h)){const _=new Array(h.length);b.set(h,_);for(let S=0;S<h.length;S++)_[S]=c(h[S],S,x,b,v);return Object.hasOwn(h,"index")&&(_.index=h.index),Object.hasOwn(h,"input")&&(_.input=h.input),_}if(h instanceof Date)return new Date(h.getTime());if(h instanceof RegExp){const _=new RegExp(h.source,h.flags);return _.lastIndex=h.lastIndex,_}if(h instanceof Map){const _=new Map;b.set(h,_);for(const[S,k]of h)_.set(S,c(k,S,x,b,v));return _}if(h instanceof Set){const _=new Set;b.set(h,_);for(const S of h)_.add(c(S,void 0,x,b,v));return _}if(typeof Buffer<"u"&&Buffer.isBuffer(h))return h.subarray();if(l.isTypedArray(h)){const _=new(Object.getPrototypeOf(h)).constructor(h.length);b.set(h,_);for(let S=0;S<h.length;S++)_[S]=c(h[S],S,x,b,v);return _}if(h instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&h instanceof SharedArrayBuffer)return h.slice(0);if(h instanceof DataView){const _=new DataView(h.buffer.slice(0),h.byteOffset,h.byteLength);return b.set(h,_),d(_,h,x,b,v),_}if(typeof File<"u"&&h instanceof File){const _=new File([h],h.name,{type:h.type});return b.set(h,_),d(_,h,x,b,v),_}if(typeof Blob<"u"&&h instanceof Blob){const _=new Blob([h],{type:h.type});return b.set(h,_),d(_,h,x,b,v),_}if(h instanceof Error){const _=new h.constructor;return b.set(h,_),_.message=h.message,_.name=h.name,_.stack=h.stack,_.cause=h.cause,d(_,h,x,b,v),_}if(h instanceof Boolean){const _=new Boolean(h.valueOf());return b.set(h,_),d(_,h,x,b,v),_}if(h instanceof Number){const _=new Number(h.valueOf());return b.set(h,_),d(_,h,x,b,v),_}if(h instanceof String){const _=new String(h.valueOf());return b.set(h,_),d(_,h,x,b,v),_}if(typeof h=="object"&&u(h)){const _=Object.create(Object.getPrototypeOf(h));return b.set(h,_),d(_,h,x,b,v),_}return h}function d(h,f,x=h,b,v){const w=[...Object.keys(f),...s.getSymbols(f)];for(let _=0;_<w.length;_++){const S=w[_],k=Object.getOwnPropertyDescriptor(h,S);(k==null||k.writable)&&(h[S]=c(f[S],S,x,b,v))}}function u(h){switch(n.getTag(h)){case a.argumentsTag:case a.arrayTag:case a.arrayBufferTag:case a.dataViewTag:case a.booleanTag:case a.dateTag:case a.float32ArrayTag:case a.float64ArrayTag:case a.int8ArrayTag:case a.int16ArrayTag:case a.int32ArrayTag:case a.mapTag:case a.numberTag:case a.objectTag:case a.regexpTag:case a.setTag:case a.stringTag:case a.symbolTag:case a.uint8ArrayTag:case a.uint8ClampedArrayTag:case a.uint16ArrayTag:case a.uint32ArrayTag:return!0;default:return!1}}t.cloneDeepWith=o,t.cloneDeepWithImpl=c,t.copyProperties=d})(q5);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=q5;function n(a){return s.cloneDeepWithImpl(a,void 0,a,new Map,void 0)}t.cloneDeep=n})(pH);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=U5,n=pH;function a(i){return i=n.cloneDeep(i),l=>s.isMatch(l,i)}t.matches=a})(mH);var yH={},bH={},vH={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=q5,n=K5;function a(i,l){return s.cloneDeepWith(i,(o,c,d,u)=>{const h=l==null?void 0:l(o,c,d,u);if(h!==void 0)return h;if(typeof i=="object")switch(Object.prototype.toString.call(i)){case n.numberTag:case n.stringTag:case n.booleanTag:{const f=new i.constructor(i==null?void 0:i.valueOf());return s.copyProperties(f,i),f}case n.argumentsTag:{const f={};return s.copyProperties(f,i),f.length=i.length,f[Symbol.iterator]=i[Symbol.iterator],f}default:return}})}t.cloneDeepWith=a})(vH);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=vH;function n(a){return s.cloneDeepWith(a)}t.cloneDeep=n})(bH);var NH={},Y5={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=/^(?:0|[1-9]\d*)$/;function n(a,i=Number.MAX_SAFE_INTEGER){switch(typeof a){case"number":return Number.isInteger(a)&&a>=0&&a<i;case"symbol":return!1;case"string":return s.test(a)}}t.isIndex=n})(Y5);var wH={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=G5;function n(a){return a!==null&&typeof a=="object"&&s.getTag(a)==="[object Arguments]"}t.isArguments=n})(wH);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=$5,n=Y5,a=wH,i=Hv;function l(o,c){let d;if(Array.isArray(c)?d=c:typeof c=="string"&&s.isDeepKey(c)&&(o==null?void 0:o[c])==null?d=i.toPath(c):d=[c],d.length===0)return!1;let u=o;for(let h=0;h<d.length;h++){const f=d[h];if((u==null||!Object.hasOwn(u,f))&&!((Array.isArray(u)||a.isArguments(u))&&n.isIndex(f)&&f<u.length))return!1;u=u[f]}return!0}t.has=l})(NH);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=U5,n=Vv,a=bH,i=Uv,l=NH;function o(c,d){switch(typeof c){case"object":{Object.is(c==null?void 0:c.valueOf(),-0)&&(c="-0");break}case"number":{c=n.toKey(c);break}}return d=a.cloneDeep(d),function(u){const h=i.get(u,c);return h===void 0?l.has(u,c):d===void 0?h===void 0:s.isMatch(h,d)}}t.matchesProperty=o})(yH);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=z5,n=hH,a=mH,i=yH;function l(o){if(o==null)return s.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?i.matchesProperty(o[0],o[1]):a.matches(o);case"string":case"symbol":case"number":return n.property(o)}}t.iteratee=l})(uH);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=lH,n=z5,a=oH,i=uH;function l(o,c=n.identity){return a.isArrayLikeObject(o)?s.uniqBy(Array.from(o),i.iteratee(c)):[]}t.uniqBy=l})(iH);var TSe=iH.uniqBy;const rD=Yi(TSe);function PSe(t,s,n){return s===!0?rD(t,n):typeof s=="function"?rD(t,s):t}var X5=y.createContext(null),ISe=t=>t,an=()=>{var t=y.useContext(X5);return t?t.store.dispatch:ISe},wy=()=>{},MSe=()=>wy,DSe=(t,s)=>t===s;function Et(t){var s=y.useContext(X5);return I7.useSyncExternalStoreWithSelector(s?s.subscription.addNestedSub:MSe,s?s.store.getState:wy,s?s.store.getState:wy,s?t:wy,DSe)}function OSe(t,s=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(s)}function RSe(t,s=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(s)}function LSe(t,s="expected all items to be functions, instead received the following types: "){if(!t.every(n=>typeof n=="function")){const n=t.map(a=>typeof a=="function"?`function ${a.name||"unnamed"}()`:typeof a).join(", ");throw new TypeError(`${s}[${n}]`)}}var aD=t=>Array.isArray(t)?t:[t];function BSe(t){const s=Array.isArray(t[0])?t[0]:t;return LSe(s,"createSelector expects all input-selectors to be functions, but received the following types: "),s}function FSe(t,s){const n=[],{length:a}=t;for(let i=0;i<a;i++)n.push(t[i].apply(null,s));return n}var $Se=class{constructor(t){this.value=t}deref(){return this.value}},zSe=typeof WeakRef<"u"?WeakRef:$Se,USe=0,iD=1;function wg(){return{s:USe,v:void 0,o:null,p:null}}function jH(t,s={}){let n=wg();const{resultEqualityCheck:a}=s;let i,l=0;function o(){var f;let c=n;const{length:d}=arguments;for(let x=0,b=d;x<b;x++){const v=arguments[x];if(typeof v=="function"||typeof v=="object"&&v!==null){let w=c.o;w===null&&(c.o=w=new WeakMap);const _=w.get(v);_===void 0?(c=wg(),w.set(v,c)):c=_}else{let w=c.p;w===null&&(c.p=w=new Map);const _=w.get(v);_===void 0?(c=wg(),w.set(v,c)):c=_}}const u=c;let h;if(c.s===iD)h=c.v;else if(h=t.apply(null,arguments),l++,a){const x=((f=i==null?void 0:i.deref)==null?void 0:f.call(i))??i;x!=null&&a(x,h)&&(h=x,l!==0&&l--),i=typeof h=="object"&&h!==null||typeof h=="function"?new zSe(h):h}return u.s=iD,u.v=h,h}return o.clearCache=()=>{n=wg(),o.resetResultsCount()},o.resultsCount=()=>l,o.resetResultsCount=()=>{l=0},o}function VSe(t,...s){const n=typeof t=="function"?{memoize:t,memoizeOptions:s}:t,a=(...i)=>{let l=0,o=0,c,d={},u=i.pop();typeof u=="object"&&(d=u,u=i.pop()),OSe(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const h={...n,...d},{memoize:f,memoizeOptions:x=[],argsMemoize:b=jH,argsMemoizeOptions:v=[]}=h,w=aD(x),_=aD(v),S=BSe(i),k=f(function(){return l++,u.apply(null,arguments)},...w),A=b(function(){o++;const P=FSe(S,arguments);return c=k.apply(null,P),c},..._);return Object.assign(A,{resultFunc:u,memoizedResultFunc:k,dependencies:S,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>c,recomputations:()=>l,resetRecomputations:()=>{l=0},memoize:f,argsMemoize:b})};return Object.assign(a,{withTypes:()=>a}),a}var Pe=VSe(jH),HSe=Object.assign((t,s=Pe)=>{RSe(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const n=Object.keys(t),a=n.map(l=>t[l]);return s(a,(...l)=>l.reduce((o,c,d)=>(o[n[d]]=c,o),{}))},{withTypes:()=>HSe}),_H={},SH={},CH={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(a){return typeof a=="symbol"?1:a===null?2:a===void 0?3:a!==a?4:0}const n=(a,i,l)=>{if(a!==i){const o=s(a),c=s(i);if(o===c&&o===0){if(a<i)return l==="desc"?1:-1;if(a>i)return l==="desc"?-1:1}return l==="desc"?c-o:o-c}return 0};t.compareValues=n})(CH);var kH={},Q5={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){return typeof n=="symbol"||n instanceof Symbol}t.isSymbol=s})(Q5);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=Q5,n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;function i(l,o){return Array.isArray(l)?!1:typeof l=="number"||typeof l=="boolean"||l==null||s.isSymbol(l)?!0:typeof l=="string"&&(a.test(l)||!n.test(l))||o!=null&&Object.hasOwn(o,l)}t.isKey=i})(kH);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=CH,n=kH,a=Hv;function i(l,o,c,d){if(l==null)return[];c=d?void 0:c,Array.isArray(l)||(l=Object.values(l)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(c)||(c=c==null?[]:[c]),c=c.map(b=>String(b));const u=(b,v)=>{let w=b;for(let _=0;_<v.length&&w!=null;++_)w=w[v[_]];return w},h=(b,v)=>v==null||b==null?v:typeof b=="object"&&"key"in b?Object.hasOwn(v,b.key)?v[b.key]:u(v,b.path):typeof b=="function"?b(v):Array.isArray(b)?u(v,b):typeof v=="object"?v[b]:v,f=o.map(b=>(Array.isArray(b)&&b.length===1&&(b=b[0]),b==null||typeof b=="function"||Array.isArray(b)||n.isKey(b)?b:{key:b,path:a.toPath(b)}));return l.map(b=>({original:b,criteria:f.map(v=>h(v,b))})).slice().sort((b,v)=>{for(let w=0;w<f.length;w++){const _=s.compareValues(b.criteria[w],v.criteria[w],c[w]);if(_!==0)return _}return 0}).map(b=>b.original)}t.orderBy=i})(SH);var AH={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n,a=1){const i=[],l=Math.floor(a),o=(c,d)=>{for(let u=0;u<c.length;u++){const h=c[u];Array.isArray(h)&&d<l?o(h,d+1):i.push(h)}};return o(n,0),i}t.flatten=s})(AH);var Z5={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=Y5,n=qv,a=V5,i=W5;function l(o,c,d){return a.isObject(d)&&(typeof c=="number"&&n.isArrayLike(d)&&s.isIndex(c)&&c<d.length||typeof c=="string"&&c in d)?i.eq(d[c],o):!1}t.isIterateeCall=l})(Z5);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=SH,n=AH,a=Z5;function i(l,...o){const c=o.length;return c>1&&a.isIterateeCall(l,o[0],o[1])?o=[]:c>2&&a.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),s.orderBy(l,n.flatten(o),["asc"])}t.sortBy=i})(_H);var WSe=_H.sortBy;const Gv=Yi(WSe);var EH=t=>t.legend.settings,qSe=t=>t.legend.size,GSe=t=>t.legend.payload;Pe([GSe,EH],(t,s)=>{var{itemSorter:n}=s,a=t.flat(1);return n?Gv(a,n):a});var jg=1;function KSe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[s,n]=y.useState({height:0,left:0,top:0,width:0}),a=y.useCallback(i=>{if(i!=null){var l=i.getBoundingClientRect(),o={height:l.height,left:l.left,top:l.top,width:l.width};(Math.abs(o.height-s.height)>jg||Math.abs(o.left-s.left)>jg||Math.abs(o.top-s.top)>jg||Math.abs(o.width-s.width)>jg)&&n({height:o.height,left:o.left,top:o.top,width:o.width})}},[s.width,s.height,s.top,s.left,...t]);return[s,a]}function Pr(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var YSe=typeof Symbol=="function"&&Symbol.observable||"@@observable",lD=YSe,Fj=()=>Math.random().toString(36).substring(7).split("").join("."),XSe={INIT:`@@redux/INIT${Fj()}`,REPLACE:`@@redux/REPLACE${Fj()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Fj()}`},B1=XSe;function J5(t){if(typeof t!="object"||t===null)return!1;let s=t;for(;Object.getPrototypeOf(s)!==null;)s=Object.getPrototypeOf(s);return Object.getPrototypeOf(t)===s||Object.getPrototypeOf(t)===null}function TH(t,s,n){if(typeof t!="function")throw new Error(Pr(2));if(typeof s=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(Pr(0));if(typeof s=="function"&&typeof n>"u"&&(n=s,s=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(Pr(1));return n(TH)(t,s)}let a=t,i=s,l=new Map,o=l,c=0,d=!1;function u(){o===l&&(o=new Map,l.forEach((_,S)=>{o.set(S,_)}))}function h(){if(d)throw new Error(Pr(3));return i}function f(_){if(typeof _!="function")throw new Error(Pr(4));if(d)throw new Error(Pr(5));let S=!0;u();const k=c++;return o.set(k,_),function(){if(S){if(d)throw new Error(Pr(6));S=!1,u(),o.delete(k),l=null}}}function x(_){if(!J5(_))throw new Error(Pr(7));if(typeof _.type>"u")throw new Error(Pr(8));if(typeof _.type!="string")throw new Error(Pr(17));if(d)throw new Error(Pr(9));try{d=!0,i=a(i,_)}finally{d=!1}return(l=o).forEach(k=>{k()}),_}function b(_){if(typeof _!="function")throw new Error(Pr(10));a=_,x({type:B1.REPLACE})}function v(){const _=f;return{subscribe(S){if(typeof S!="object"||S===null)throw new Error(Pr(11));function k(){const T=S;T.next&&T.next(h())}return k(),{unsubscribe:_(k)}},[lD](){return this}}}return x({type:B1.INIT}),{dispatch:x,subscribe:f,getState:h,replaceReducer:b,[lD]:v}}function QSe(t){Object.keys(t).forEach(s=>{const n=t[s];if(typeof n(void 0,{type:B1.INIT})>"u")throw new Error(Pr(12));if(typeof n(void 0,{type:B1.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Pr(13))})}function PH(t){const s=Object.keys(t),n={};for(let l=0;l<s.length;l++){const o=s[l];typeof t[o]=="function"&&(n[o]=t[o])}const a=Object.keys(n);let i;try{QSe(n)}catch(l){i=l}return function(o={},c){if(i)throw i;let d=!1;const u={};for(let h=0;h<a.length;h++){const f=a[h],x=n[f],b=o[f],v=x(b,c);if(typeof v>"u")throw c&&c.type,new Error(Pr(14));u[f]=v,d=d||v!==b}return d=d||a.length!==Object.keys(o).length,d?u:o}}function F1(...t){return t.length===0?s=>s:t.length===1?t[0]:t.reduce((s,n)=>(...a)=>s(n(...a)))}function ZSe(...t){return s=>(n,a)=>{const i=s(n,a);let l=()=>{throw new Error(Pr(15))};const o={getState:i.getState,dispatch:(d,...u)=>l(d,...u)},c=t.map(d=>d(o));return l=F1(...c)(i.dispatch),{...i,dispatch:l}}}function IH(t){return J5(t)&&"type"in t&&typeof t.type=="string"}var MH=Symbol.for("immer-nothing"),oD=Symbol.for("immer-draftable"),gi=Symbol.for("immer-state");function hl(t,...s){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var yx=Object.getPrototypeOf;function Ou(t){return!!t&&!!t[gi]}function Ko(t){var s;return t?DH(t)||Array.isArray(t)||!!t[oD]||!!((s=t.constructor)!=null&&s[oD])||e0(t)||Yv(t):!1}var JSe=Object.prototype.constructor.toString(),cD=new WeakMap;function DH(t){if(!t||typeof t!="object")return!1;const s=Object.getPrototypeOf(t);if(s===null||s===Object.prototype)return!0;const n=Object.hasOwnProperty.call(s,"constructor")&&s.constructor;if(n===Object)return!0;if(typeof n!="function")return!1;let a=cD.get(n);return a===void 0&&(a=Function.toString.call(n),cD.set(n,a)),a===JSe}function $1(t,s,n=!0){Kv(t)===0?(n?Reflect.ownKeys(t):Object.keys(t)).forEach(i=>{s(i,t[i],t)}):t.forEach((a,i)=>s(i,a,t))}function Kv(t){const s=t[gi];return s?s.type_:Array.isArray(t)?1:e0(t)?2:Yv(t)?3:0}function qS(t,s){return Kv(t)===2?t.has(s):Object.prototype.hasOwnProperty.call(t,s)}function OH(t,s,n){const a=Kv(t);a===2?t.set(s,n):a===3?t.add(n):t[s]=n}function eCe(t,s){return t===s?t!==0||1/t===1/s:t!==t&&s!==s}function e0(t){return t instanceof Map}function Yv(t){return t instanceof Set}function Ud(t){return t.copy_||t.base_}function GS(t,s){if(e0(t))return new Map(t);if(Yv(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const n=DH(t);if(s===!0||s==="class_only"&&!n){const a=Object.getOwnPropertyDescriptors(t);delete a[gi];let i=Reflect.ownKeys(a);for(let l=0;l<i.length;l++){const o=i[l],c=a[o];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(a[o]={configurable:!0,writable:!0,enumerable:c.enumerable,value:t[o]})}return Object.create(yx(t),a)}else{const a=yx(t);if(a!==null&&n)return{...t};const i=Object.create(a);return Object.assign(i,t)}}function eA(t,s=!1){return Xv(t)||Ou(t)||!Ko(t)||(Kv(t)>1&&Object.defineProperties(t,{set:_g,add:_g,clear:_g,delete:_g}),Object.freeze(t),s&&Object.values(t).forEach(n=>eA(n,!0))),t}function tCe(){hl(2)}var _g={value:tCe};function Xv(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var sCe={};function Ru(t){const s=sCe[t];return s||hl(0,t),s}var bx;function RH(){return bx}function nCe(t,s){return{drafts_:[],parent_:t,immer_:s,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function dD(t,s){s&&(Ru("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=s)}function KS(t){YS(t),t.drafts_.forEach(rCe),t.drafts_=null}function YS(t){t===bx&&(bx=t.parent_)}function uD(t){return bx=nCe(bx,t)}function rCe(t){const s=t[gi];s.type_===0||s.type_===1?s.revoke_():s.revoked_=!0}function hD(t,s){s.unfinalizedDrafts_=s.drafts_.length;const n=s.drafts_[0];return t!==void 0&&t!==n?(n[gi].modified_&&(KS(s),hl(4)),Ko(t)&&(t=z1(s,t),s.parent_||U1(s,t)),s.patches_&&Ru("Patches").generateReplacementPatches_(n[gi].base_,t,s.patches_,s.inversePatches_)):t=z1(s,n,[]),KS(s),s.patches_&&s.patchListener_(s.patches_,s.inversePatches_),t!==MH?t:void 0}function z1(t,s,n){if(Xv(s))return s;const a=t.immer_.shouldUseStrictIteration(),i=s[gi];if(!i)return $1(s,(l,o)=>mD(t,i,s,l,o,n),a),s;if(i.scope_!==t)return s;if(!i.modified_)return U1(t,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const l=i.copy_;let o=l,c=!1;i.type_===3&&(o=new Set(l),l.clear(),c=!0),$1(o,(d,u)=>mD(t,i,l,d,u,n,c),a),U1(t,l,!1),n&&t.patches_&&Ru("Patches").generatePatches_(i,n,t.patches_,t.inversePatches_)}return i.copy_}function mD(t,s,n,a,i,l,o){if(i==null||typeof i!="object"&&!o)return;const c=Xv(i);if(!(c&&!o)){if(Ou(i)){const d=l&&s&&s.type_!==3&&!qS(s.assigned_,a)?l.concat(a):void 0,u=z1(t,i,d);if(OH(n,a,u),Ou(u))t.canAutoFreeze_=!1;else return}else o&&n.add(i);if(Ko(i)&&!c){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||s&&s.base_&&s.base_[a]===i&&c)return;z1(t,i),(!s||!s.scope_.parent_)&&typeof a!="symbol"&&(e0(n)?n.has(a):Object.prototype.propertyIsEnumerable.call(n,a))&&U1(t,i)}}}function U1(t,s,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&eA(s,n)}function aCe(t,s){const n=Array.isArray(t),a={type_:n?1:0,scope_:s?s.scope_:RH(),modified_:!1,finalized_:!1,assigned_:{},parent_:s,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=a,l=tA;n&&(i=[a],l=vx);const{revoke:o,proxy:c}=Proxy.revocable(i,l);return a.draft_=c,a.revoke_=o,c}var tA={get(t,s){if(s===gi)return t;const n=Ud(t);if(!qS(n,s))return iCe(t,n,s);const a=n[s];return t.finalized_||!Ko(a)?a:a===$j(t.base_,s)?(zj(t),t.copy_[s]=QS(a,t)):a},has(t,s){return s in Ud(t)},ownKeys(t){return Reflect.ownKeys(Ud(t))},set(t,s,n){const a=LH(Ud(t),s);if(a!=null&&a.set)return a.set.call(t.draft_,n),!0;if(!t.modified_){const i=$j(Ud(t),s),l=i==null?void 0:i[gi];if(l&&l.base_===n)return t.copy_[s]=n,t.assigned_[s]=!1,!0;if(eCe(n,i)&&(n!==void 0||qS(t.base_,s)))return!0;zj(t),XS(t)}return t.copy_[s]===n&&(n!==void 0||s in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[s])||(t.copy_[s]=n,t.assigned_[s]=!0),!0},deleteProperty(t,s){return $j(t.base_,s)!==void 0||s in t.base_?(t.assigned_[s]=!1,zj(t),XS(t)):delete t.assigned_[s],t.copy_&&delete t.copy_[s],!0},getOwnPropertyDescriptor(t,s){const n=Ud(t),a=Reflect.getOwnPropertyDescriptor(n,s);return a&&{writable:!0,configurable:t.type_!==1||s!=="length",enumerable:a.enumerable,value:n[s]}},defineProperty(){hl(11)},getPrototypeOf(t){return yx(t.base_)},setPrototypeOf(){hl(12)}},vx={};$1(tA,(t,s)=>{vx[t]=function(){return arguments[0]=arguments[0][0],s.apply(this,arguments)}});vx.deleteProperty=function(t,s){return vx.set.call(this,t,s,void 0)};vx.set=function(t,s,n){return tA.set.call(this,t[0],s,n,t[0])};function $j(t,s){const n=t[gi];return(n?Ud(n):t)[s]}function iCe(t,s,n){var i;const a=LH(s,n);return a?"value"in a?a.value:(i=a.get)==null?void 0:i.call(t.draft_):void 0}function LH(t,s){if(!(s in t))return;let n=yx(t);for(;n;){const a=Object.getOwnPropertyDescriptor(n,s);if(a)return a;n=yx(n)}}function XS(t){t.modified_||(t.modified_=!0,t.parent_&&XS(t.parent_))}function zj(t){t.copy_||(t.copy_=GS(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var lCe=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(s,n,a)=>{if(typeof s=="function"&&typeof n!="function"){const l=n;n=s;const o=this;return function(d=l,...u){return o.produce(d,h=>n.call(this,h,...u))}}typeof n!="function"&&hl(6),a!==void 0&&typeof a!="function"&&hl(7);let i;if(Ko(s)){const l=uD(this),o=QS(s,void 0);let c=!0;try{i=n(o),c=!1}finally{c?KS(l):YS(l)}return dD(l,a),hD(i,l)}else if(!s||typeof s!="object"){if(i=n(s),i===void 0&&(i=s),i===MH&&(i=void 0),this.autoFreeze_&&eA(i,!0),a){const l=[],o=[];Ru("Patches").generateReplacementPatches_(s,i,l,o),a(l,o)}return i}else hl(1,s)},this.produceWithPatches=(s,n)=>{if(typeof s=="function")return(o,...c)=>this.produceWithPatches(o,d=>s(d,...c));let a,i;return[this.produce(s,n,(o,c)=>{a=o,i=c}),a,i]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof(t==null?void 0:t.useStrictIteration)=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){Ko(t)||hl(8),Ou(t)&&(t=Ro(t));const s=uD(this),n=QS(t,void 0);return n[gi].isManual_=!0,YS(s),n}finishDraft(t,s){const n=t&&t[gi];(!n||!n.isManual_)&&hl(9);const{scope_:a}=n;return dD(a,s),hD(void 0,a)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,s){let n;for(n=s.length-1;n>=0;n--){const i=s[n];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}n>-1&&(s=s.slice(n+1));const a=Ru("Patches").applyPatches_;return Ou(t)?a(t,s):this.produce(t,i=>a(i,s))}};function QS(t,s){const n=e0(t)?Ru("MapSet").proxyMap_(t,s):Yv(t)?Ru("MapSet").proxySet_(t,s):aCe(t,s);return(s?s.scope_:RH()).drafts_.push(n),n}function Ro(t){return Ou(t)||hl(10,t),BH(t)}function BH(t){if(!Ko(t)||Xv(t))return t;const s=t[gi];let n,a=!0;if(s){if(!s.modified_)return s.base_;s.finalized_=!0,n=GS(t,s.scope_.immer_.useStrictShallowCopy_),a=s.scope_.immer_.shouldUseStrictIteration()}else n=GS(t,!0);return $1(n,(i,l)=>{OH(n,i,BH(l))},a),s&&(s.finalized_=!1),n}var ZS=new lCe,FH=ZS.produce,oCe=ZS.setUseStrictIteration.bind(ZS);function $H(t){return({dispatch:n,getState:a})=>i=>l=>typeof l=="function"?l(n,a,t):i(l)}var cCe=$H(),dCe=$H,uCe=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?F1:F1.apply(null,arguments)};function Gi(t,s){function n(...a){if(s){let i=s(...a);if(!i)throw new Error(fi(0));return{type:t,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:t,payload:a[0]}}return n.toString=()=>`${t}`,n.type=t,n.match=a=>IH(a)&&a.type===t,n}var zH=class ep extends Array{constructor(...s){super(...s),Object.setPrototypeOf(this,ep.prototype)}static get[Symbol.species](){return ep}concat(...s){return super.concat.apply(this,s)}prepend(...s){return s.length===1&&Array.isArray(s[0])?new ep(...s[0].concat(this)):new ep(...s.concat(this))}};function fD(t){return Ko(t)?FH(t,()=>{}):t}function Sg(t,s,n){return t.has(s)?t.get(s):t.set(s,n(s)).get(s)}function hCe(t){return typeof t=="boolean"}var mCe=()=>function(s){const{thunk:n=!0,immutableCheck:a=!0,serializableCheck:i=!0,actionCreatorCheck:l=!0}=s??{};let o=new zH;return n&&(hCe(n)?o.push(cCe):o.push(dCe(n.extraArgument))),o},UH="RTK_autoBatch",rr=()=>t=>({payload:t,meta:{[UH]:!0}}),pD=t=>s=>{setTimeout(s,t)},VH=(t={type:"raf"})=>s=>(...n)=>{const a=s(...n);let i=!0,l=!1,o=!1;const c=new Set,d=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:pD(10):t.type==="callback"?t.queueNotification:pD(t.timeout),u=()=>{o=!1,l&&(l=!1,c.forEach(h=>h()))};return Object.assign({},a,{subscribe(h){const f=()=>i&&h(),x=a.subscribe(f);return c.add(h),()=>{x(),c.delete(h)}},dispatch(h){var f;try{return i=!((f=h==null?void 0:h.meta)!=null&&f[UH]),l=!i,l&&(o||(o=!0,d(u))),a.dispatch(h)}finally{i=!0}}})},fCe=t=>function(n){const{autoBatch:a=!0}=n??{};let i=new zH(t);return a&&i.push(VH(typeof a=="object"?a:void 0)),i};function pCe(t){const s=mCe(),{reducer:n=void 0,middleware:a,devTools:i=!0,preloadedState:l=void 0,enhancers:o=void 0}=t||{};let c;if(typeof n=="function")c=n;else if(J5(n))c=PH(n);else throw new Error(fi(1));let d;typeof a=="function"?d=a(s):d=s();let u=F1;i&&(u=uCe({trace:!1,...typeof i=="object"&&i}));const h=ZSe(...d),f=fCe(h);let x=typeof o=="function"?o(f):f();const b=u(...x);return TH(c,l,b)}function HH(t){const s={},n=[];let a;const i={addCase(l,o){const c=typeof l=="string"?l:l.type;if(!c)throw new Error(fi(28));if(c in s)throw new Error(fi(29));return s[c]=o,i},addAsyncThunk(l,o){return o.pending&&(s[l.pending.type]=o.pending),o.rejected&&(s[l.rejected.type]=o.rejected),o.fulfilled&&(s[l.fulfilled.type]=o.fulfilled),o.settled&&n.push({matcher:l.settled,reducer:o.settled}),i},addMatcher(l,o){return n.push({matcher:l,reducer:o}),i},addDefaultCase(l){return a=l,i}};return t(i),[s,n,a]}oCe(!1);function xCe(t){return typeof t=="function"}function gCe(t,s){let[n,a,i]=HH(s),l;if(xCe(t))l=()=>fD(t());else{const c=fD(t);l=()=>c}function o(c=l(),d){let u=[n[d.type],...a.filter(({matcher:h})=>h(d)).map(({reducer:h})=>h)];return u.filter(h=>!!h).length===0&&(u=[i]),u.reduce((h,f)=>{if(f)if(Ou(h)){const b=f(h,d);return b===void 0?h:b}else{if(Ko(h))return FH(h,x=>f(x,d));{const x=f(h,d);if(x===void 0){if(h===null)return h;throw Error("A case reducer on a non-draftable value must not return undefined")}return x}}return h},c)}return o.getInitialState=l,o}var yCe="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",bCe=(t=21)=>{let s="",n=t;for(;n--;)s+=yCe[Math.random()*64|0];return s},vCe=Symbol.for("rtk-slice-createasyncthunk");function NCe(t,s){return`${t}/${s}`}function wCe({creators:t}={}){var n;const s=(n=t==null?void 0:t.asyncThunk)==null?void 0:n[vCe];return function(i){const{name:l,reducerPath:o=l}=i;if(!l)throw new Error(fi(11));const c=(typeof i.reducers=="function"?i.reducers(_Ce()):i.reducers)||{},d=Object.keys(c),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},h={addCase(T,P){const O=typeof T=="string"?T:T.type;if(!O)throw new Error(fi(12));if(O in u.sliceCaseReducersByType)throw new Error(fi(13));return u.sliceCaseReducersByType[O]=P,h},addMatcher(T,P){return u.sliceMatchers.push({matcher:T,reducer:P}),h},exposeAction(T,P){return u.actionCreators[T]=P,h},exposeCaseReducer(T,P){return u.sliceCaseReducersByName[T]=P,h}};d.forEach(T=>{const P=c[T],O={reducerName:T,type:NCe(l,T),createNotation:typeof i.reducers=="function"};CCe(P)?ACe(O,P,h,s):SCe(O,P,h)});function f(){const[T={},P=[],O=void 0]=typeof i.extraReducers=="function"?HH(i.extraReducers):[i.extraReducers],D={...T,...u.sliceCaseReducersByType};return gCe(i.initialState,I=>{for(let M in D)I.addCase(M,D[M]);for(let M of u.sliceMatchers)I.addMatcher(M.matcher,M.reducer);for(let M of P)I.addMatcher(M.matcher,M.reducer);O&&I.addDefaultCase(O)})}const x=T=>T,b=new Map,v=new WeakMap;let w;function _(T,P){return w||(w=f()),w(T,P)}function S(){return w||(w=f()),w.getInitialState()}function k(T,P=!1){function O(I){let M=I[T];return typeof M>"u"&&P&&(M=Sg(v,O,S)),M}function D(I=x){const M=Sg(b,P,()=>new WeakMap);return Sg(M,I,()=>{const B={};for(const[L,F]of Object.entries(i.selectors??{}))B[L]=jCe(F,I,()=>Sg(v,I,S),P);return B})}return{reducerPath:T,getSelectors:D,get selectors(){return D(O)},selectSlice:O}}const A={name:l,reducer:_,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:S,...k(o),injectInto(T,{reducerPath:P,...O}={}){const D=P??o;return T.inject({reducerPath:D,reducer:_},O),{...A,...k(D,!0)}}};return A}}function jCe(t,s,n,a){function i(l,...o){let c=s(l);return typeof c>"u"&&a&&(c=n()),t(c,...o)}return i.unwrapped=t,i}var Ha=wCe();function _Ce(){function t(s,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:s,...n}}return t.withTypes=()=>t,{reducer(s){return Object.assign({[s.name](...n){return s(...n)}}[s.name],{_reducerDefinitionType:"reducer"})},preparedReducer(s,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:s,reducer:n}},asyncThunk:t}}function SCe({type:t,reducerName:s,createNotation:n},a,i){let l,o;if("reducer"in a){if(n&&!kCe(a))throw new Error(fi(17));l=a.reducer,o=a.prepare}else l=a;i.addCase(t,l).exposeCaseReducer(s,l).exposeAction(s,o?Gi(t,o):Gi(t))}function CCe(t){return t._reducerDefinitionType==="asyncThunk"}function kCe(t){return t._reducerDefinitionType==="reducerWithPrepare"}function ACe({type:t,reducerName:s},n,a,i){if(!i)throw new Error(fi(18));const{payloadCreator:l,fulfilled:o,pending:c,rejected:d,settled:u,options:h}=n,f=i(t,l,h);a.exposeAction(s,f),o&&a.addCase(f.fulfilled,o),c&&a.addCase(f.pending,c),d&&a.addCase(f.rejected,d),u&&a.addMatcher(f.settled,u),a.exposeCaseReducer(s,{fulfilled:o||Cg,pending:c||Cg,rejected:d||Cg,settled:u||Cg})}function Cg(){}var ECe="task",WH="listener",qH="completed",sA="cancelled",TCe=`task-${sA}`,PCe=`task-${qH}`,JS=`${WH}-${sA}`,ICe=`${WH}-${qH}`,Qv=class{constructor(t){QN(this,"name","TaskAbortError");QN(this,"message");this.code=t,this.message=`${ECe} ${sA} (reason: ${t})`}},nA=(t,s)=>{if(typeof t!="function")throw new TypeError(fi(32))},V1=()=>{},GH=(t,s=V1)=>(t.catch(s),t),KH=(t,s)=>(t.addEventListener("abort",s,{once:!0}),()=>t.removeEventListener("abort",s)),fu=(t,s)=>{const n=t.signal;n.aborted||("reason"in n||Object.defineProperty(n,"reason",{enumerable:!0,value:s,configurable:!0,writable:!0}),t.abort(s))},pu=t=>{if(t.aborted){const{reason:s}=t;throw new Qv(s)}};function YH(t,s){let n=V1;return new Promise((a,i)=>{const l=()=>i(new Qv(t.reason));if(t.aborted){l();return}n=KH(t,l),s.finally(()=>n()).then(a,i)}).finally(()=>{n=V1})}var MCe=async(t,s)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(n){return{status:n instanceof Qv?"cancelled":"rejected",error:n}}finally{s==null||s()}},H1=t=>s=>GH(YH(t,s).then(n=>(pu(t),n))),XH=t=>{const s=H1(t);return n=>s(new Promise(a=>setTimeout(a,n)))},{assign:Qh}=Object,xD={},Zv="listenerMiddleware",DCe=(t,s)=>{const n=a=>KH(t,()=>fu(a,t.reason));return(a,i)=>{nA(a);const l=new AbortController;n(l);const o=MCe(async()=>{pu(t),pu(l.signal);const c=await a({pause:H1(l.signal),delay:XH(l.signal),signal:l.signal});return pu(l.signal),c},()=>fu(l,PCe));return i!=null&&i.autoJoin&&s.push(o.catch(V1)),{result:H1(t)(o),cancel(){fu(l,TCe)}}}},OCe=(t,s)=>{const n=async(a,i)=>{pu(s);let l=()=>{};const c=[new Promise((d,u)=>{let h=t({predicate:a,effect:(f,x)=>{x.unsubscribe(),d([f,x.getState(),x.getOriginalState()])}});l=()=>{h(),u()}})];i!=null&&c.push(new Promise(d=>setTimeout(d,i,null)));try{const d=await YH(s,Promise.race(c));return pu(s),d}finally{l()}};return(a,i)=>GH(n(a,i))},QH=t=>{let{type:s,actionCreator:n,matcher:a,predicate:i,effect:l}=t;if(s)i=Gi(s).match;else if(n)s=n.type,i=n.match;else if(a)i=a;else if(!i)throw new Error(fi(21));return nA(l),{predicate:i,type:s,effect:l}},ZH=Qh(t=>{const{type:s,predicate:n,effect:a}=QH(t);return{id:bCe(),effect:a,type:s,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error(fi(22))}}},{withTypes:()=>ZH}),gD=(t,s)=>{const{type:n,effect:a,predicate:i}=QH(s);return Array.from(t.values()).find(l=>(typeof n=="string"?l.type===n:l.predicate===i)&&l.effect===a)},eC=t=>{t.pending.forEach(s=>{fu(s,JS)})},RCe=(t,s)=>()=>{for(const n of s.keys())eC(n);t.clear()},yD=(t,s,n)=>{try{t(s,n)}catch(a){setTimeout(()=>{throw a},0)}},JH=Qh(Gi(`${Zv}/add`),{withTypes:()=>JH}),LCe=Gi(`${Zv}/removeAll`),eW=Qh(Gi(`${Zv}/remove`),{withTypes:()=>eW}),BCe=(...t)=>{console.error(`${Zv}/error`,...t)},t0=(t={})=>{const s=new Map,n=new Map,a=b=>{const v=n.get(b)??0;n.set(b,v+1)},i=b=>{const v=n.get(b)??1;v===1?n.delete(b):n.set(b,v-1)},{extra:l,onError:o=BCe}=t;nA(o);const c=b=>(b.unsubscribe=()=>s.delete(b.id),s.set(b.id,b),v=>{b.unsubscribe(),v!=null&&v.cancelActive&&eC(b)}),d=b=>{const v=gD(s,b)??ZH(b);return c(v)};Qh(d,{withTypes:()=>d});const u=b=>{const v=gD(s,b);return v&&(v.unsubscribe(),b.cancelActive&&eC(v)),!!v};Qh(u,{withTypes:()=>u});const h=async(b,v,w,_)=>{const S=new AbortController,k=OCe(d,S.signal),A=[];try{b.pending.add(S),a(b),await Promise.resolve(b.effect(v,Qh({},w,{getOriginalState:_,condition:(T,P)=>k(T,P).then(Boolean),take:k,delay:XH(S.signal),pause:H1(S.signal),extra:l,signal:S.signal,fork:DCe(S.signal,A),unsubscribe:b.unsubscribe,subscribe:()=>{s.set(b.id,b)},cancelActiveListeners:()=>{b.pending.forEach((T,P,O)=>{T!==S&&(fu(T,JS),O.delete(T))})},cancel:()=>{fu(S,JS),b.pending.delete(S)},throwIfCancelled:()=>{pu(S.signal)}})))}catch(T){T instanceof Qv||yD(o,T,{raisedBy:"effect"})}finally{await Promise.all(A),fu(S,ICe),i(b),b.pending.delete(S)}},f=RCe(s,n);return{middleware:b=>v=>w=>{if(!IH(w))return v(w);if(JH.match(w))return d(w.payload);if(LCe.match(w)){f();return}if(eW.match(w))return u(w.payload);let _=b.getState();const S=()=>{if(_===xD)throw new Error(fi(23));return _};let k;try{if(k=v(w),s.size>0){const A=b.getState(),T=Array.from(s.values());for(const P of T){let O=!1;try{O=P.predicate(w,A,_)}catch(D){O=!1,yD(o,D,{raisedBy:"predicate"})}O&&h(P,w,b,S)}}}finally{_=xD}return k},startListening:d,stopListening:u,clearListeners:f}};function fi(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var FCe={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},tW=Ha({name:"chartLayout",initialState:FCe,reducers:{setLayout(t,s){t.layoutType=s.payload},setChartSize(t,s){t.width=s.payload.width,t.height=s.payload.height},setMargin(t,s){var n,a,i,l;t.margin.top=(n=s.payload.top)!==null&&n!==void 0?n:0,t.margin.right=(a=s.payload.right)!==null&&a!==void 0?a:0,t.margin.bottom=(i=s.payload.bottom)!==null&&i!==void 0?i:0,t.margin.left=(l=s.payload.left)!==null&&l!==void 0?l:0},setScale(t,s){t.scale=s.payload}}}),{setMargin:$Ce,setLayout:zCe,setChartSize:UCe,setScale:VCe}=tW.actions,HCe=tW.reducer;function sW(t,s,n){return Array.isArray(t)&&t&&s+n!==0?t.slice(s,n+1):t}function bD(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function Lh(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?bD(Object(n),!0).forEach(function(a){WCe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bD(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function WCe(t,s,n){return(s=qCe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function qCe(t){var s=GCe(t,"string");return typeof s=="symbol"?s:s+""}function GCe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function mn(t,s,n){return jr(t)||jr(s)?n:ho(s)?Du(t,s,n):typeof s=="function"?s(t):n}var KCe=(t,s,n)=>{if(s&&n){var{width:a,height:i}=n,{align:l,verticalAlign:o,layout:c}=s;if((c==="vertical"||c==="horizontal"&&o==="middle")&&l!=="center"&&Dt(t[l]))return Lh(Lh({},t),{},{[l]:t[l]+(a||0)});if((c==="horizontal"||c==="vertical"&&l==="center")&&o!=="middle"&&Dt(t[o]))return Lh(Lh({},t),{},{[o]:t[o]+(i||0)})}return t},Xu=(t,s)=>t==="horizontal"&&s==="xAxis"||t==="vertical"&&s==="yAxis"||t==="centric"&&s==="angleAxis"||t==="radial"&&s==="radiusAxis",vD=1e-4,YCe=t=>{var s=t.domain();if(!(!s||s.length<=2)){var n=s.length,a=t.range(),i=Math.min(a[0],a[1])-vD,l=Math.max(a[0],a[1])+vD,o=t(s[0]),c=t(s[n-1]);(o<i||o>l||c<i||c>l)&&t.domain([s[0],s[n-1]])}},XCe=(t,s)=>{if(!s||s.length!==2||!Dt(s[0])||!Dt(s[1]))return t;var n=Math.min(s[0],s[1]),a=Math.max(s[0],s[1]),i=[t[0],t[1]];return(!Dt(t[0])||t[0]<n)&&(i[0]=n),(!Dt(t[1])||t[1]>a)&&(i[1]=a),i[0]>a&&(i[0]=a),i[1]<n&&(i[1]=n),i},QCe=t=>{var s=t.length;if(!(s<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,l=0,o=0;o<s;++o){var c=uo(t[o][n][1])?t[o][n][0]:t[o][n][1];c>=0?(t[o][n][0]=i,t[o][n][1]=i+c,i=t[o][n][1]):(t[o][n][0]=l,t[o][n][1]=l+c,l=t[o][n][1])}},ZCe=t=>{var s=t.length;if(!(s<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,l=0;l<s;++l){var o=uo(t[l][n][1])?t[l][n][0]:t[l][n][1];o>=0?(t[l][n][0]=i,t[l][n][1]=i+o,i=t[l][n][1]):(t[l][n][0]=0,t[l][n][1]=0)}},JCe={sign:QCe,expand:lSe,none:Nm,silhouette:oSe,wiggle:cSe,positive:ZCe},e3e=(t,s,n)=>{var a=JCe[n],i=iSe().keys(s).value((l,o)=>Number(mn(l,o,0))).order(HS).offset(a);return i(t)};function t3e(t){return t==null?void 0:String(t)}var ND=t=>{var{axis:s,ticks:n,offset:a,bandSize:i,entry:l,index:o}=t;if(s.type==="category")return n[o]?n[o].coordinate+a:null;var c=mn(l,s.dataKey,s.scale.domain()[o]);return jr(c)?null:s.scale(c)-i/2+a},s3e=t=>{var{numericAxis:s}=t,n=s.scale.domain();if(s.type==="number"){var a=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]);return a<=0&&i>=0?0:i<0?i:a}return n[0]},n3e=t=>{var s=t.flat(2).filter(Dt);return[Math.min(...s),Math.max(...s)]},r3e=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],a3e=(t,s,n)=>{if(t!=null)return r3e(Object.keys(t).reduce((a,i)=>{var l=t[i],{stackedData:o}=l,c=o.reduce((d,u)=>{var h=sW(u,s,n),f=n3e(h);return[Math.min(d[0],f[0]),Math.max(d[1],f[1])]},[1/0,-1/0]);return[Math.min(c[0],a[0]),Math.max(c[1],a[1])]},[1/0,-1/0]))},wD=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,jD=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,W1=(t,s,n)=>{if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&s&&s.length>=2){for(var i=Gv(s,h=>h.coordinate),l=1/0,o=1,c=i.length;o<c;o++){var d=i[o],u=i[o-1];l=Math.min((d.coordinate||0)-(u.coordinate||0),l)}return l===1/0?0:l}return n?void 0:0};function _D(t){var{tooltipEntrySettings:s,dataKey:n,payload:a,value:i,name:l}=t;return Lh(Lh({},s),{},{dataKey:n,payload:a,value:i,name:l})}function Jv(t,s){if(t)return String(t);if(typeof s=="string")return s}var i3e=(t,s)=>{if(s==="horizontal")return t.chartX;if(s==="vertical")return t.chartY},l3e=(t,s)=>s==="centric"?t.angle:t.radius,nc=t=>t.layout.width,rc=t=>t.layout.height,o3e=t=>t.layout.scale,nW=t=>t.layout.margin,eN=Pe(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),tN=Pe(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),rW="data-recharts-item-index",aW="data-recharts-item-data-key",s0=60;function SD(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function kg(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?SD(Object(n),!0).forEach(function(a){c3e(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):SD(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function c3e(t,s,n){return(s=d3e(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function d3e(t){var s=u3e(t,"string");return typeof s=="symbol"?s:s+""}function u3e(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var h3e=t=>t.brush.height;function m3e(t){var s=tN(t);return s.reduce((n,a)=>{if(a.orientation==="left"&&!a.mirror&&!a.hide){var i=typeof a.width=="number"?a.width:s0;return n+i}return n},0)}function f3e(t){var s=tN(t);return s.reduce((n,a)=>{if(a.orientation==="right"&&!a.mirror&&!a.hide){var i=typeof a.width=="number"?a.width:s0;return n+i}return n},0)}function p3e(t){var s=eN(t);return s.reduce((n,a)=>a.orientation==="top"&&!a.mirror&&!a.hide?n+a.height:n,0)}function x3e(t){var s=eN(t);return s.reduce((n,a)=>a.orientation==="bottom"&&!a.mirror&&!a.hide?n+a.height:n,0)}var hr=Pe([nc,rc,nW,h3e,m3e,f3e,p3e,x3e,EH,qSe],(t,s,n,a,i,l,o,c,d,u)=>{var h={left:(n.left||0)+i,right:(n.right||0)+l},f={top:(n.top||0)+o,bottom:(n.bottom||0)+c},x=kg(kg({},f),h),b=x.bottom;x.bottom+=a,x=KCe(x,d,u);var v=t-x.left-x.right,w=s-x.top-x.bottom;return kg(kg({brushBottom:b},x),{},{width:Math.max(v,0),height:Math.max(w,0)})}),g3e=Pe(hr,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),rA=Pe(nc,rc,(t,s)=>({x:0,y:0,width:t,height:s})),y3e=y.createContext(null),vi=()=>y.useContext(y3e)!=null,sN=t=>t.brush,nN=Pe([sN,hr,nW],(t,s,n)=>({height:t.height,x:Dt(t.x)?t.x:s.left,y:Dt(t.y)?t.y:s.top+s.height+s.brushBottom-((n==null?void 0:n.bottom)||0),width:Dt(t.width)?t.width:s.width})),iW={},lW={},oW={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n,a,{signal:i,edges:l}={}){let o,c=null;const d=l!=null&&l.includes("leading"),u=l==null||l.includes("trailing"),h=()=>{c!==null&&(n.apply(o,c),o=void 0,c=null)},f=()=>{u&&h(),w()};let x=null;const b=()=>{x!=null&&clearTimeout(x),x=setTimeout(()=>{x=null,f()},a)},v=()=>{x!==null&&(clearTimeout(x),x=null)},w=()=>{v(),o=void 0,c=null},_=()=>{h()},S=function(...k){if(i!=null&&i.aborted)return;o=this,c=k;const A=x==null;b(),d&&A&&h()};return S.schedule=b,S.cancel=w,S.flush=_,i==null||i.addEventListener("abort",w,{once:!0}),S}t.debounce=s})(oW);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=oW;function n(a,i=0,l={}){typeof l!="object"&&(l={});const{leading:o=!1,trailing:c=!0,maxWait:d}=l,u=Array(2);o&&(u[0]="leading"),c&&(u[1]="trailing");let h,f=null;const x=s.debounce(function(...w){h=a.apply(this,w),f=null},i,{edges:u}),b=function(...w){return d!=null&&(f===null&&(f=Date.now()),Date.now()-f>=d)?(h=a.apply(this,w),f=Date.now(),x.cancel(),x.schedule(),h):(x.apply(this,w),h)},v=()=>(x.flush(),h);return b.cancel=x.cancel,b.flush=v,b}t.debounce=n})(lW);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=lW;function n(a,i=0,l={}){const{leading:o=!0,trailing:c=!0}=l;return s.debounce(a,i,{leading:o,maxWait:i,trailing:c})}t.throttle=n})(iW);var b3e=iW.throttle;const v3e=Yi(b3e);var CD=function(s,n){for(var a=arguments.length,i=new Array(a>2?a-2:0),l=2;l<a;l++)i[l-2]=arguments[l]},cW=(t,s,n)=>{var{width:a="100%",height:i="100%",aspect:l,maxHeight:o}=n,c=Go(a)?t:Number(a),d=Go(i)?s:Number(i);return l&&l>0&&(c?d=c/l:d&&(c=d*l),o&&d!=null&&d>o&&(d=o)),{calculatedWidth:c,calculatedHeight:d}},N3e={width:0,height:0,overflow:"visible"},w3e={width:0,overflowX:"visible"},j3e={height:0,overflowY:"visible"},_3e={},S3e=t=>{var{width:s,height:n}=t,a=Go(s),i=Go(n);return a&&i?N3e:a?w3e:i?j3e:_3e};function C3e(t){var{width:s,height:n,aspect:a}=t,i=s,l=n;return i===void 0&&l===void 0?(i="100%",l="100%"):i===void 0?i=a&&a>0?void 0:"100%":l===void 0&&(l=a&&a>0?void 0:"100%"),{width:i,height:l}}function Rn(t){return Number.isFinite(t)}function cd(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function tC(){return tC=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},tC.apply(null,arguments)}function kD(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function AD(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?kD(Object(n),!0).forEach(function(a){k3e(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kD(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function k3e(t,s,n){return(s=A3e(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function A3e(t){var s=E3e(t,"string");return typeof s=="symbol"?s:s+""}function E3e(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var dW=y.createContext({width:-1,height:-1});function T3e(t){return cd(t.width)&&cd(t.height)}function uW(t){var{children:s,width:n,height:a}=t,i=y.useMemo(()=>({width:n,height:a}),[n,a]);return T3e(i)?y.createElement(dW.Provider,{value:i},s):null}var aA=()=>y.useContext(dW),P3e=y.forwardRef((t,s)=>{var{aspect:n,initialDimension:a={width:-1,height:-1},width:i,height:l,minWidth:o=0,minHeight:c,maxHeight:d,children:u,debounce:h=0,id:f,className:x,onResize:b,style:v={}}=t,w=y.useRef(null),_=y.useRef();_.current=b,y.useImperativeHandle(s,()=>w.current);var[S,k]=y.useState({containerWidth:a.width,containerHeight:a.height}),A=y.useCallback((I,M)=>{k(B=>{var L=Math.round(I),F=Math.round(M);return B.containerWidth===L&&B.containerHeight===F?B:{containerWidth:L,containerHeight:F}})},[]);y.useEffect(()=>{if(w.current==null||typeof ResizeObserver>"u")return Yu;var I=F=>{var V,{width:$,height:z}=F[0].contentRect;A($,z),(V=_.current)===null||V===void 0||V.call(_,$,z)};h>0&&(I=v3e(I,h,{trailing:!0,leading:!1}));var M=new ResizeObserver(I),{width:B,height:L}=w.current.getBoundingClientRect();return A(B,L),M.observe(w.current),()=>{M.disconnect()}},[A,h]);var{containerWidth:T,containerHeight:P}=S;CD(!n||n>0,"The aspect(%s) must be greater than zero.",n);var{calculatedWidth:O,calculatedHeight:D}=cW(T,P,{width:i,height:l,aspect:n,maxHeight:d});return CD(O!=null&&O>0||D!=null&&D>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,O,D,i,l,o,c,n),y.createElement("div",{id:f?"".concat(f):void 0,className:vs("recharts-responsive-container",x),style:AD(AD({},v),{},{width:i,height:l,minWidth:o,minHeight:c,maxHeight:d}),ref:w},y.createElement("div",{style:S3e({width:i,height:l})},y.createElement(uW,{width:O,height:D},u)))}),eu=y.forwardRef((t,s)=>{var n=aA();if(cd(n.width)&&cd(n.height))return t.children;var{width:a,height:i}=C3e({width:t.width,height:t.height,aspect:t.aspect}),{calculatedWidth:l,calculatedHeight:o}=cW(void 0,void 0,{width:a,height:i,aspect:t.aspect,maxHeight:t.maxHeight});return Dt(l)&&Dt(o)?y.createElement(uW,{width:l,height:o},t.children):y.createElement(P3e,tC({},t,{width:a,height:i,ref:s}))});function hW(t){if(t)return{x:t.x,y:t.y,upperWidth:"upperWidth"in t?t.upperWidth:t.width,lowerWidth:"lowerWidth"in t?t.lowerWidth:t.width,width:t.width,height:t.height}}var rN=()=>{var t,s=vi(),n=Et(g3e),a=Et(nN),i=(t=Et(sN))===null||t===void 0?void 0:t.padding;return!s||!a||!i?n:{width:a.width-i.left-i.right,height:a.height-i.top-i.bottom,x:i.left,y:i.top}},I3e={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},M3e=()=>{var t;return(t=Et(hr))!==null&&t!==void 0?t:I3e},D3e=()=>Et(nc),O3e=()=>Et(rc),gs=t=>t.layout.layoutType,aN=()=>Et(gs),R3e=()=>{var t=aN();return t!==void 0},iN=t=>{var s=an(),n=vi(),{width:a,height:i}=t,l=aA(),o=a,c=i;return l&&(o=l.width>0?l.width:a,c=l.height>0?l.height:i),y.useEffect(()=>{!n&&cd(o)&&cd(c)&&s(UCe({width:o,height:c}))},[s,n,o,c]),null},L3e={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},mW=Ha({name:"legend",initialState:L3e,reducers:{setLegendSize(t,s){t.size.width=s.payload.width,t.size.height=s.payload.height},setLegendSettings(t,s){t.settings.align=s.payload.align,t.settings.layout=s.payload.layout,t.settings.verticalAlign=s.payload.verticalAlign,t.settings.itemSorter=s.payload.itemSorter},addLegendPayload:{reducer(t,s){t.payload.push(s.payload)},prepare:rr()},removeLegendPayload:{reducer(t,s){var n=Ro(t).payload.indexOf(s.payload);n>-1&&t.payload.splice(n,1)},prepare:rr()}}}),{setLegendSize:NBe,setLegendSettings:wBe,addLegendPayload:fW,removeLegendPayload:pW}=mW.actions,B3e=mW.reducer;function sC(){return sC=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},sC.apply(null,arguments)}function ED(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function Uj(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?ED(Object(n),!0).forEach(function(a){F3e(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ED(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function F3e(t,s,n){return(s=$3e(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function $3e(t){var s=z3e(t,"string");return typeof s=="symbol"?s:s+""}function z3e(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function U3e(t){return Array.isArray(t)&&ho(t[0])&&ho(t[1])?t.join(" ~ "):t}var V3e=t=>{var{separator:s=" : ",contentStyle:n={},itemStyle:a={},labelStyle:i={},payload:l,formatter:o,itemSorter:c,wrapperClassName:d,labelClassName:u,label:h,labelFormatter:f,accessibilityLayer:x=!1}=t,b=()=>{if(l&&l.length){var P={padding:0,margin:0},O=(c?Gv(l,c):l).map((D,I)=>{if(D.type==="none")return null;var M=D.formatter||o||U3e,{value:B,name:L}=D,F=B,V=L;if(M){var $=M(B,L,D,I,l);if(Array.isArray($))[F,V]=$;else if($!=null)F=$;else return null}var z=Uj({display:"block",paddingTop:4,paddingBottom:4,color:D.color||"#000"},a);return y.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(I),style:z},ho(V)?y.createElement("span",{className:"recharts-tooltip-item-name"},V):null,ho(V)?y.createElement("span",{className:"recharts-tooltip-item-separator"},s):null,y.createElement("span",{className:"recharts-tooltip-item-value"},F),y.createElement("span",{className:"recharts-tooltip-item-unit"},D.unit||""))});return y.createElement("ul",{className:"recharts-tooltip-item-list",style:P},O)}return null},v=Uj({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},n),w=Uj({margin:0},i),_=!jr(h),S=_?h:"",k=vs("recharts-default-tooltip",d),A=vs("recharts-tooltip-label",u);_&&f&&l!==void 0&&l!==null&&(S=f(h,l));var T=x?{role:"status","aria-live":"assertive"}:{};return y.createElement("div",sC({className:k,style:v},T),y.createElement("p",{className:A,style:w},y.isValidElement(S)?S:"".concat(S)),b())},If="recharts-tooltip-wrapper",H3e={visibility:"hidden"};function W3e(t){var{coordinate:s,translateX:n,translateY:a}=t;return vs(If,{["".concat(If,"-right")]:Dt(n)&&s&&Dt(s.x)&&n>=s.x,["".concat(If,"-left")]:Dt(n)&&s&&Dt(s.x)&&n<s.x,["".concat(If,"-bottom")]:Dt(a)&&s&&Dt(s.y)&&a>=s.y,["".concat(If,"-top")]:Dt(a)&&s&&Dt(s.y)&&a<s.y})}function TD(t){var{allowEscapeViewBox:s,coordinate:n,key:a,offsetTopLeft:i,position:l,reverseDirection:o,tooltipDimension:c,viewBox:d,viewBoxDimension:u}=t;if(l&&Dt(l[a]))return l[a];var h=n[a]-c-(i>0?i:0),f=n[a]+i;if(s[a])return o[a]?h:f;var x=d[a];if(x==null)return 0;if(o[a]){var b=h,v=x;return b<v?Math.max(f,x):Math.max(h,x)}if(u==null)return 0;var w=f+c,_=x+u;return w>_?Math.max(h,x):Math.max(f,x)}function q3e(t){var{translateX:s,translateY:n,useTranslate3d:a}=t;return{transform:a?"translate3d(".concat(s,"px, ").concat(n,"px, 0)"):"translate(".concat(s,"px, ").concat(n,"px)")}}function G3e(t){var{allowEscapeViewBox:s,coordinate:n,offsetTopLeft:a,position:i,reverseDirection:l,tooltipBox:o,useTranslate3d:c,viewBox:d}=t,u,h,f;return o.height>0&&o.width>0&&n?(h=TD({allowEscapeViewBox:s,coordinate:n,key:"x",offsetTopLeft:a,position:i,reverseDirection:l,tooltipDimension:o.width,viewBox:d,viewBoxDimension:d.width}),f=TD({allowEscapeViewBox:s,coordinate:n,key:"y",offsetTopLeft:a,position:i,reverseDirection:l,tooltipDimension:o.height,viewBox:d,viewBoxDimension:d.height}),u=q3e({translateX:h,translateY:f,useTranslate3d:c})):u=H3e,{cssProperties:u,cssClasses:W3e({translateX:h,translateY:f,coordinate:n})}}function PD(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function Ag(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?PD(Object(n),!0).forEach(function(a){nC(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):PD(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function nC(t,s,n){return(s=K3e(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function K3e(t){var s=Y3e(t,"string");return typeof s=="symbol"?s:s+""}function Y3e(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}class X3e extends y.PureComponent{constructor(){super(...arguments),nC(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),nC(this,"handleKeyDown",s=>{if(s.key==="Escape"){var n,a,i,l;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(n=(a=this.props.coordinate)===null||a===void 0?void 0:a.x)!==null&&n!==void 0?n:0,y:(i=(l=this.props.coordinate)===null||l===void 0?void 0:l.y)!==null&&i!==void 0?i:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var s,n;this.state.dismissed&&(((s=this.props.coordinate)===null||s===void 0?void 0:s.x)!==this.state.dismissedAtCoordinate.x||((n=this.props.coordinate)===null||n===void 0?void 0:n.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:s,allowEscapeViewBox:n,animationDuration:a,animationEasing:i,children:l,coordinate:o,hasPayload:c,isAnimationActive:d,offset:u,position:h,reverseDirection:f,useTranslate3d:x,viewBox:b,wrapperStyle:v,lastBoundingBox:w,innerRef:_,hasPortalFromProps:S}=this.props,{cssClasses:k,cssProperties:A}=G3e({allowEscapeViewBox:n,coordinate:o,offsetTopLeft:u,position:h,reverseDirection:f,tooltipBox:{height:w.height,width:w.width},useTranslate3d:x,viewBox:b}),T=S?{}:Ag(Ag({transition:d&&s?"transform ".concat(a,"ms ").concat(i):void 0},A),{},{pointerEvents:"none",visibility:!this.state.dismissed&&s&&c?"visible":"hidden",position:"absolute",top:0,left:0}),P=Ag(Ag({},T),{},{visibility:!this.state.dismissed&&s&&c?"visible":"hidden"},v);return y.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:k,style:P,ref:_},l)}}var Q3e=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Qu={devToolsEnabled:!1,isSsr:Q3e()},xW=()=>{var t;return(t=Et(s=>s.rootProps.accessibilityLayer))!==null&&t!==void 0?t:!0};function rC(){return rC=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},rC.apply(null,arguments)}function ID(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function MD(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?ID(Object(n),!0).forEach(function(a){Z3e(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ID(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function Z3e(t,s,n){return(s=J3e(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function J3e(t){var s=eke(t,"string");return typeof s=="symbol"?s:s+""}function eke(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var DD={curveBasisClosed:Y_e,curveBasisOpen:X_e,curveBasis:K_e,curveBumpX:D_e,curveBumpY:O_e,curveLinearClosed:Q_e,curveLinear:$v,curveMonotoneX:Z_e,curveMonotoneY:J_e,curveNatural:eSe,curveStep:tSe,curveStepAfter:nSe,curveStepBefore:sSe},q1=t=>Rn(t.x)&&Rn(t.y),OD=t=>t.base!=null&&q1(t.base)&&q1(t),Mf=t=>t.x,Df=t=>t.y,tke=(t,s)=>{if(typeof t=="function")return t;var n="curve".concat(Jx(t));return(n==="curveMonotone"||n==="curveBump")&&s?DD["".concat(n).concat(s==="vertical"?"Y":"X")]:DD[n]||$v},ske=t=>{var{type:s="linear",points:n=[],baseLine:a,layout:i,connectNulls:l=!1}=t,o=tke(s,i),c=l?n.filter(q1):n,d;if(Array.isArray(a)){var u=n.map((b,v)=>MD(MD({},b),{},{base:a[v]}));i==="vertical"?d=Ng().y(Df).x1(Mf).x0(b=>b.base.x):d=Ng().x(Mf).y1(Df).y0(b=>b.base.y);var h=d.defined(OD).curve(o),f=l?u.filter(OD):u;return h(f)}i==="vertical"&&Dt(a)?d=Ng().y(Df).x1(Mf).x0(a):Dt(a)?d=Ng().x(Mf).y1(Df).y0(a):d=VV().x(Mf).y(Df);var x=d.defined(q1).curve(o);return x(c)},iA=t=>{var{className:s,points:n,path:a,pathRef:i}=t;if((!n||!n.length)&&!a)return null;var l=n&&n.length?ske(t):a;return y.createElement("path",rC({},co(t),_Se(t),{className:vs("recharts-curve",s),d:l===null?void 0:l,ref:i}))},nke=["x","y","top","left","width","height","className"];function aC(){return aC=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},aC.apply(null,arguments)}function RD(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function rke(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?RD(Object(n),!0).forEach(function(a){ake(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):RD(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function ake(t,s,n){return(s=ike(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function ike(t){var s=lke(t,"string");return typeof s=="symbol"?s:s+""}function lke(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function oke(t,s){if(t==null)return{};var n,a,i=cke(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function cke(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}var dke=(t,s,n,a,i,l)=>"M".concat(t,",").concat(i,"v").concat(a,"M").concat(l,",").concat(s,"h").concat(n),uke=t=>{var{x:s=0,y:n=0,top:a=0,left:i=0,width:l=0,height:o=0,className:c}=t,d=oke(t,nke),u=rke({x:s,y:n,top:a,left:i,width:l,height:o},d);return!Dt(s)||!Dt(n)||!Dt(l)||!Dt(o)||!Dt(a)||!Dt(i)?null:y.createElement("path",aC({},qi(u),{className:vs("recharts-cross",c),d:dke(s,n,l,o,a,i)}))};function hke(t,s,n,a){var i=a/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?s.x-i:n.left+.5,y:t==="horizontal"?n.top+.5:s.y-i,width:t==="horizontal"?a:n.width-1,height:t==="horizontal"?n.height-1:a}}function LD(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function BD(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?LD(Object(n),!0).forEach(function(a){mke(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):LD(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function mke(t,s,n){return(s=fke(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function fke(t){var s=pke(t,"string");return typeof s=="symbol"?s:s+""}function pke(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var xke=t=>t.replace(/([A-Z])/g,s=>"-".concat(s.toLowerCase())),gW=(t,s,n)=>t.map(a=>"".concat(xke(a)," ").concat(s,"ms ").concat(n)).join(","),gke=(t,s)=>[Object.keys(t),Object.keys(s)].reduce((n,a)=>n.filter(i=>a.includes(i))),Nx=(t,s)=>Object.keys(s).reduce((n,a)=>BD(BD({},n),{},{[a]:t(a,s[a])}),{});function FD(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function sr(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?FD(Object(n),!0).forEach(function(a){yke(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):FD(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function yke(t,s,n){return(s=bke(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function bke(t){var s=vke(t,"string");return typeof s=="symbol"?s:s+""}function vke(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var G1=(t,s,n)=>t+(s-t)*n,iC=t=>{var{from:s,to:n}=t;return s!==n},yW=(t,s,n)=>{var a=Nx((i,l)=>{if(iC(l)){var[o,c]=t(l.from,l.to,l.velocity);return sr(sr({},l),{},{from:o,velocity:c})}return l},s);return n<1?Nx((i,l)=>iC(l)?sr(sr({},l),{},{velocity:G1(l.velocity,a[i].velocity,n),from:G1(l.from,a[i].from,n)}):l,s):yW(t,a,n-1)};function Nke(t,s,n,a,i,l){var o,c=a.reduce((x,b)=>sr(sr({},x),{},{[b]:{from:t[b],velocity:0,to:s[b]}}),{}),d=()=>Nx((x,b)=>b.from,c),u=()=>!Object.values(c).filter(iC).length,h=null,f=x=>{o||(o=x);var b=x-o,v=b/n.dt;c=yW(n,c,v),i(sr(sr(sr({},t),s),d())),o=x,u()||(h=l.setTimeout(f))};return()=>(h=l.setTimeout(f),()=>{var x;(x=h)===null||x===void 0||x()})}function wke(t,s,n,a,i,l,o){var c=null,d=i.reduce((f,x)=>sr(sr({},f),{},{[x]:[t[x],s[x]]}),{}),u,h=f=>{u||(u=f);var x=(f-u)/a,b=Nx((w,_)=>G1(..._,n(x)),d);if(l(sr(sr(sr({},t),s),b)),x<1)c=o.setTimeout(h);else{var v=Nx((w,_)=>G1(..._,n(1)),d);l(sr(sr(sr({},t),s),v))}};return()=>(c=o.setTimeout(h),()=>{var f;(f=c)===null||f===void 0||f()})}const jke=(t,s,n,a,i,l)=>{var o=gke(t,s);return n==null?()=>(i(sr(sr({},t),s)),()=>{}):n.isStepper===!0?Nke(t,s,n,o,i,l):wke(t,s,n,a,o,i,l)};var K1=1e-4,bW=(t,s)=>[0,3*t,3*s-6*t,3*t-3*s+1],vW=(t,s)=>t.map((n,a)=>n*s**a).reduce((n,a)=>n+a),$D=(t,s)=>n=>{var a=bW(t,s);return vW(a,n)},_ke=(t,s)=>n=>{var a=bW(t,s),i=[...a.map((l,o)=>l*o).slice(1),0];return vW(i,n)},Ske=function(){for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];if(n.length===1)switch(n[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var i,l=n[0].split("(");if(l[0]==="cubic-bezier"&&((i=l[1])===null||i===void 0?void 0:i.split(")")[0].split(",").length)===4){var o=l[1].split(")")[0].split(",").map(c=>parseFloat(c));return[o[0],o[1],o[2],o[3]]}}}return n.length===4?n:[0,0,1,1]},Cke=(t,s,n,a)=>{var i=$D(t,n),l=$D(s,a),o=_ke(t,n),c=u=>u>1?1:u<0?0:u,d=u=>{for(var h=u>1?1:u,f=h,x=0;x<8;++x){var b=i(f)-h,v=o(f);if(Math.abs(b-h)<K1||v<K1)return l(f);f=c(f-b/v)}return l(f)};return d.isStepper=!1,d},zD=function(){return Cke(...Ske(...arguments))},kke=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:n=100,damping:a=8,dt:i=17}=s,l=(o,c,d)=>{var u=-(o-c)*n,h=d*a,f=d+(u-h)*i/1e3,x=d*i/1e3+o;return Math.abs(x-c)<K1&&Math.abs(f)<K1?[c,0]:[x,f]};return l.isStepper=!0,l.dt=i,l},Ake=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return zD(t);case"spring":return kke();default:if(t.split("(")[0]==="cubic-bezier")return zD(t)}return typeof t=="function"?t:null};function Eke(t){var s,n=()=>null,a=!1,i=null,l=o=>{if(!a){if(Array.isArray(o)){if(!o.length)return;var c=o,[d,...u]=c;if(typeof d=="number"){i=t.setTimeout(l.bind(null,u),d);return}l(d),i=t.setTimeout(l.bind(null,u));return}typeof o=="string"&&(s=o,n(s)),typeof o=="object"&&(s=o,n(s)),typeof o=="function"&&o()}};return{stop:()=>{a=!0},start:o=>{a=!1,i&&(i(),i=null),l(o)},subscribe:o=>(n=o,()=>{n=()=>null}),getTimeoutController:()=>t}}class Tke{setTimeout(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=performance.now(),i=null,l=o=>{o-a>=n?s(o):typeof requestAnimationFrame=="function"&&(i=requestAnimationFrame(l))};return i=requestAnimationFrame(l),()=>{i!=null&&cancelAnimationFrame(i)}}}function Pke(){return Eke(new Tke)}var Ike=y.createContext(Pke);function Mke(t,s){var n=y.useContext(Ike);return y.useMemo(()=>s??n(t),[t,s,n])}var Dke={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},UD={t:0},Vj={t:1};function lN(t){var s=ba(t,Dke),{isActive:n,canBegin:a,duration:i,easing:l,begin:o,onAnimationEnd:c,onAnimationStart:d,children:u}=s,h=Mke(s.animationId,s.animationManager),[f,x]=y.useState(n?UD:Vj),b=y.useRef(null);return y.useEffect(()=>{n||x(Vj)},[n]),y.useEffect(()=>{if(!n||!a)return Yu;var v=jke(UD,Vj,Ake(l),i,x,h.getTimeoutController()),w=()=>{b.current=v()};return h.start([d,o,w,i,c]),()=>{h.stop(),b.current&&b.current(),c()}},[n,a,i,l,o,d,c,h]),u(f.t)}function oN(t){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",n=y.useRef(gx(s)),a=y.useRef(t);return a.current!==t&&(n.current=gx(s),a.current=t),n.current}var Oke=["radius"],Rke=["radius"];function VD(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function HD(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?VD(Object(n),!0).forEach(function(a){Lke(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):VD(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function Lke(t,s,n){return(s=Bke(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function Bke(t){var s=Fke(t,"string");return typeof s=="symbol"?s:s+""}function Fke(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function Y1(){return Y1=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Y1.apply(null,arguments)}function WD(t,s){if(t==null)return{};var n,a,i=$ke(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function $ke(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}var qD=(t,s,n,a,i)=>{var l=Math.min(Math.abs(n)/2,Math.abs(a)/2),o=a>=0?1:-1,c=n>=0?1:-1,d=a>=0&&n>=0||a<0&&n<0?1:0,u;if(l>0&&i instanceof Array){for(var h=[0,0,0,0],f=0,x=4;f<x;f++)h[f]=i[f]>l?l:i[f];u="M".concat(t,",").concat(s+o*h[0]),h[0]>0&&(u+="A ".concat(h[0],",").concat(h[0],",0,0,").concat(d,",").concat(t+c*h[0],",").concat(s)),u+="L ".concat(t+n-c*h[1],",").concat(s),h[1]>0&&(u+="A ".concat(h[1],",").concat(h[1],",0,0,").concat(d,`,
        `).concat(t+n,",").concat(s+o*h[1])),u+="L ".concat(t+n,",").concat(s+a-o*h[2]),h[2]>0&&(u+="A ".concat(h[2],",").concat(h[2],",0,0,").concat(d,`,
        `).concat(t+n-c*h[2],",").concat(s+a)),u+="L ".concat(t+c*h[3],",").concat(s+a),h[3]>0&&(u+="A ".concat(h[3],",").concat(h[3],",0,0,").concat(d,`,
        `).concat(t,",").concat(s+a-o*h[3])),u+="Z"}else if(l>0&&i===+i&&i>0){var b=Math.min(l,i);u="M ".concat(t,",").concat(s+o*b,`
            A `).concat(b,",").concat(b,",0,0,").concat(d,",").concat(t+c*b,",").concat(s,`
            L `).concat(t+n-c*b,",").concat(s,`
            A `).concat(b,",").concat(b,",0,0,").concat(d,",").concat(t+n,",").concat(s+o*b,`
            L `).concat(t+n,",").concat(s+a-o*b,`
            A `).concat(b,",").concat(b,",0,0,").concat(d,",").concat(t+n-c*b,",").concat(s+a,`
            L `).concat(t+c*b,",").concat(s+a,`
            A `).concat(b,",").concat(b,",0,0,").concat(d,",").concat(t,",").concat(s+a-o*b," Z")}else u="M ".concat(t,",").concat(s," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return u},GD={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},NW=t=>{var s=ba(t,GD),n=y.useRef(null),[a,i]=y.useState(-1);y.useEffect(()=>{if(n.current&&n.current.getTotalLength)try{var q=n.current.getTotalLength();q&&i(q)}catch{}},[]);var{x:l,y:o,width:c,height:d,radius:u,className:h}=s,{animationEasing:f,animationDuration:x,animationBegin:b,isAnimationActive:v,isUpdateAnimationActive:w}=s,_=y.useRef(c),S=y.useRef(d),k=y.useRef(l),A=y.useRef(o),T=y.useMemo(()=>({x:l,y:o,width:c,height:d,radius:u}),[l,o,c,d,u]),P=oN(T,"rectangle-");if(l!==+l||o!==+o||c!==+c||d!==+d||c===0||d===0)return null;var O=vs("recharts-rectangle",h);if(!w){var D=qi(s),{radius:I}=D,M=WD(D,Oke);return y.createElement("path",Y1({},M,{radius:typeof u=="number"?u:void 0,className:O,d:qD(l,o,c,d,u)}))}var B=_.current,L=S.current,F=k.current,V=A.current,$="0px ".concat(a===-1?1:a,"px"),z="".concat(a,"px 0px"),H=gW(["strokeDasharray"],x,typeof f=="string"?f:GD.animationEasing);return y.createElement(lN,{animationId:P,key:P,canBegin:a>0,duration:x,easing:f,isActive:w,begin:b},q=>{var G=tr(B,c,q),re=tr(L,d,q),ye=tr(F,l,q),Ee=tr(V,o,q);n.current&&(_.current=G,S.current=re,k.current=ye,A.current=Ee);var ee;v?q>0?ee={transition:H,strokeDasharray:z}:ee={strokeDasharray:$}:ee={strokeDasharray:z};var te=qi(s),{radius:ce}=te,ge=WD(te,Rke);return y.createElement("path",Y1({},ge,{radius:typeof u=="number"?u:void 0,className:O,d:qD(ye,Ee,G,re,u),ref:n,style:HD(HD({},ee),s.style)}))})};function KD(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function YD(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?KD(Object(n),!0).forEach(function(a){zke(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):KD(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function zke(t,s,n){return(s=Uke(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function Uke(t){var s=Vke(t,"string");return typeof s=="symbol"?s:s+""}function Vke(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var X1=Math.PI/180,Hke=t=>t*180/Math.PI,Gn=(t,s,n,a)=>({x:t+Math.cos(-X1*a)*n,y:s+Math.sin(-X1*a)*n}),wW=function(s,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(s-(a.left||0)-(a.right||0)),Math.abs(n-(a.top||0)-(a.bottom||0)))/2},Wke=(t,s)=>{var{x:n,y:a}=t,{x:i,y:l}=s;return Math.sqrt((n-i)**2+(a-l)**2)},qke=(t,s)=>{var{x:n,y:a}=t,{cx:i,cy:l}=s,o=Wke({x:n,y:a},{x:i,y:l});if(o<=0)return{radius:o,angle:0};var c=(n-i)/o,d=Math.acos(c);return a>l&&(d=2*Math.PI-d),{radius:o,angle:Hke(d),angleInRadian:d}},Gke=t=>{var{startAngle:s,endAngle:n}=t,a=Math.floor(s/360),i=Math.floor(n/360),l=Math.min(a,i);return{startAngle:s-l*360,endAngle:n-l*360}},Kke=(t,s)=>{var{startAngle:n,endAngle:a}=s,i=Math.floor(n/360),l=Math.floor(a/360),o=Math.min(i,l);return t+o*360},Yke=(t,s)=>{var{chartX:n,chartY:a}=t,{radius:i,angle:l}=qke({x:n,y:a},s),{innerRadius:o,outerRadius:c}=s;if(i<o||i>c||i===0)return null;var{startAngle:d,endAngle:u}=Gke(s),h=l,f;if(d<=u){for(;h>u;)h-=360;for(;h<d;)h+=360;f=h>=d&&h<=u}else{for(;h>d;)h-=360;for(;h<u;)h+=360;f=h>=u&&h<=d}return f?YD(YD({},s),{},{radius:i,angle:Kke(h,s)}):null};function jW(t){var{cx:s,cy:n,radius:a,startAngle:i,endAngle:l}=t,o=Gn(s,n,a,i),c=Gn(s,n,a,l);return{points:[o,c],cx:s,cy:n,radius:a,startAngle:i,endAngle:l}}function lC(){return lC=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},lC.apply(null,arguments)}var Xke=(t,s)=>{var n=Lr(s-t),a=Math.min(Math.abs(s-t),359.999);return n*a},Eg=t=>{var{cx:s,cy:n,radius:a,angle:i,sign:l,isExternal:o,cornerRadius:c,cornerIsExternal:d}=t,u=c*(o?1:-1)+a,h=Math.asin(c/u)/X1,f=d?i:i+l*h,x=Gn(s,n,u,f),b=Gn(s,n,a,f),v=d?i-l*h:i,w=Gn(s,n,u*Math.cos(h*X1),v);return{center:x,circleTangency:b,lineTangency:w,theta:h}},_W=t=>{var{cx:s,cy:n,innerRadius:a,outerRadius:i,startAngle:l,endAngle:o}=t,c=Xke(l,o),d=l+c,u=Gn(s,n,i,l),h=Gn(s,n,i,d),f="M ".concat(u.x,",").concat(u.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(l>d),`,
    `).concat(h.x,",").concat(h.y,`
  `);if(a>0){var x=Gn(s,n,a,l),b=Gn(s,n,a,d);f+="L ".concat(b.x,",").concat(b.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(l<=d),`,
            `).concat(x.x,",").concat(x.y," Z")}else f+="L ".concat(s,",").concat(n," Z");return f},Qke=t=>{var{cx:s,cy:n,innerRadius:a,outerRadius:i,cornerRadius:l,forceCornerRadius:o,cornerIsExternal:c,startAngle:d,endAngle:u}=t,h=Lr(u-d),{circleTangency:f,lineTangency:x,theta:b}=Eg({cx:s,cy:n,radius:i,angle:d,sign:h,cornerRadius:l,cornerIsExternal:c}),{circleTangency:v,lineTangency:w,theta:_}=Eg({cx:s,cy:n,radius:i,angle:u,sign:-h,cornerRadius:l,cornerIsExternal:c}),S=c?Math.abs(d-u):Math.abs(d-u)-b-_;if(S<0)return o?"M ".concat(x.x,",").concat(x.y,`
        a`).concat(l,",").concat(l,",0,0,1,").concat(l*2,`,0
        a`).concat(l,",").concat(l,",0,0,1,").concat(-l*2,`,0
      `):_W({cx:s,cy:n,innerRadius:a,outerRadius:i,startAngle:d,endAngle:u});var k="M ".concat(x.x,",").concat(x.y,`
    A`).concat(l,",").concat(l,",0,0,").concat(+(h<0),",").concat(f.x,",").concat(f.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(S>180),",").concat(+(h<0),",").concat(v.x,",").concat(v.y,`
    A`).concat(l,",").concat(l,",0,0,").concat(+(h<0),",").concat(w.x,",").concat(w.y,`
  `);if(a>0){var{circleTangency:A,lineTangency:T,theta:P}=Eg({cx:s,cy:n,radius:a,angle:d,sign:h,isExternal:!0,cornerRadius:l,cornerIsExternal:c}),{circleTangency:O,lineTangency:D,theta:I}=Eg({cx:s,cy:n,radius:a,angle:u,sign:-h,isExternal:!0,cornerRadius:l,cornerIsExternal:c}),M=c?Math.abs(d-u):Math.abs(d-u)-P-I;if(M<0&&l===0)return"".concat(k,"L").concat(s,",").concat(n,"Z");k+="L".concat(D.x,",").concat(D.y,`
      A`).concat(l,",").concat(l,",0,0,").concat(+(h<0),",").concat(O.x,",").concat(O.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(M>180),",").concat(+(h>0),",").concat(A.x,",").concat(A.y,`
      A`).concat(l,",").concat(l,",0,0,").concat(+(h<0),",").concat(T.x,",").concat(T.y,"Z")}else k+="L".concat(s,",").concat(n,"Z");return k},Zke={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},SW=t=>{var s=ba(t,Zke),{cx:n,cy:a,innerRadius:i,outerRadius:l,cornerRadius:o,forceCornerRadius:c,cornerIsExternal:d,startAngle:u,endAngle:h,className:f}=s;if(l<i||u===h)return null;var x=vs("recharts-sector",f),b=l-i,v=Qr(o,b,0,!0),w;return v>0&&Math.abs(u-h)<360?w=Qke({cx:n,cy:a,innerRadius:i,outerRadius:l,cornerRadius:Math.min(v,b/2),forceCornerRadius:c,cornerIsExternal:d,startAngle:u,endAngle:h}):w=_W({cx:n,cy:a,innerRadius:i,outerRadius:l,startAngle:u,endAngle:h}),y.createElement("path",lC({},qi(s),{className:x,d:w}))};function Jke(t,s,n){if(t==="horizontal")return[{x:s.x,y:n.top},{x:s.x,y:n.top+n.height}];if(t==="vertical")return[{x:n.left,y:s.y},{x:n.left+n.width,y:s.y}];if(aH(s)){if(t==="centric"){var{cx:a,cy:i,innerRadius:l,outerRadius:o,angle:c}=s,d=Gn(a,i,l,c),u=Gn(a,i,o,c);return[{x:d.x,y:d.y},{x:u.x,y:u.y}]}return jW(s)}}var CW={},kW={},AW={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=Q5;function n(a){return s.isSymbol(a)?NaN:Number(a)}t.toNumber=n})(AW);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=AW;function n(a){return a?(a=s.toNumber(a),a===1/0||a===-1/0?(a<0?-1:1)*Number.MAX_VALUE:a===a?a:0):a===0?a:0}t.toFinite=n})(kW);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=Z5,n=kW;function a(i,l,o){o&&typeof o!="number"&&s.isIterateeCall(i,l,o)&&(l=o=void 0),i=n.toFinite(i),l===void 0?(l=i,i=0):l=n.toFinite(l),o=o===void 0?i<l?1:-1:n.toFinite(o);const c=Math.max(Math.ceil((l-i)/(o||1)),0),d=new Array(c);for(let u=0;u<c;u++)d[u]=i,i+=o;return d}t.range=a})(CW);var e5e=CW.range;const EW=Yi(e5e);function td(t,s){return t==null||s==null?NaN:t<s?-1:t>s?1:t>=s?0:NaN}function t5e(t,s){return t==null||s==null?NaN:s<t?-1:s>t?1:s>=t?0:NaN}function lA(t){let s,n,a;t.length!==2?(s=td,n=(c,d)=>td(t(c),d),a=(c,d)=>t(c)-d):(s=t===td||t===t5e?t:s5e,n=t,a=t);function i(c,d,u=0,h=c.length){if(u<h){if(s(d,d)!==0)return h;do{const f=u+h>>>1;n(c[f],d)<0?u=f+1:h=f}while(u<h)}return u}function l(c,d,u=0,h=c.length){if(u<h){if(s(d,d)!==0)return h;do{const f=u+h>>>1;n(c[f],d)<=0?u=f+1:h=f}while(u<h)}return u}function o(c,d,u=0,h=c.length){const f=i(c,d,u,h-1);return f>u&&a(c[f-1],d)>-a(c[f],d)?f-1:f}return{left:i,center:o,right:l}}function s5e(){return 0}function TW(t){return t===null?NaN:+t}function*n5e(t,s){for(let n of t)n!=null&&(n=+n)>=n&&(yield n)}const r5e=lA(td),n0=r5e.right;lA(TW).center;class XD extends Map{constructor(s,n=l5e){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),s!=null)for(const[a,i]of s)this.set(a,i)}get(s){return super.get(QD(this,s))}has(s){return super.has(QD(this,s))}set(s,n){return super.set(a5e(this,s),n)}delete(s){return super.delete(i5e(this,s))}}function QD({_intern:t,_key:s},n){const a=s(n);return t.has(a)?t.get(a):n}function a5e({_intern:t,_key:s},n){const a=s(n);return t.has(a)?t.get(a):(t.set(a,n),n)}function i5e({_intern:t,_key:s},n){const a=s(n);return t.has(a)&&(n=t.get(a),t.delete(a)),n}function l5e(t){return t!==null&&typeof t=="object"?t.valueOf():t}function o5e(t=td){if(t===td)return PW;if(typeof t!="function")throw new TypeError("compare is not a function");return(s,n)=>{const a=t(s,n);return a||a===0?a:(t(n,n)===0)-(t(s,s)===0)}}function PW(t,s){return(t==null||!(t>=t))-(s==null||!(s>=s))||(t<s?-1:t>s?1:0)}const c5e=Math.sqrt(50),d5e=Math.sqrt(10),u5e=Math.sqrt(2);function Q1(t,s,n){const a=(s-t)/Math.max(0,n),i=Math.floor(Math.log10(a)),l=a/Math.pow(10,i),o=l>=c5e?10:l>=d5e?5:l>=u5e?2:1;let c,d,u;return i<0?(u=Math.pow(10,-i)/o,c=Math.round(t*u),d=Math.round(s*u),c/u<t&&++c,d/u>s&&--d,u=-u):(u=Math.pow(10,i)*o,c=Math.round(t/u),d=Math.round(s/u),c*u<t&&++c,d*u>s&&--d),d<c&&.5<=n&&n<2?Q1(t,s,n*2):[c,d,u]}function oC(t,s,n){if(s=+s,t=+t,n=+n,!(n>0))return[];if(t===s)return[t];const a=s<t,[i,l,o]=a?Q1(s,t,n):Q1(t,s,n);if(!(l>=i))return[];const c=l-i+1,d=new Array(c);if(a)if(o<0)for(let u=0;u<c;++u)d[u]=(l-u)/-o;else for(let u=0;u<c;++u)d[u]=(l-u)*o;else if(o<0)for(let u=0;u<c;++u)d[u]=(i+u)/-o;else for(let u=0;u<c;++u)d[u]=(i+u)*o;return d}function cC(t,s,n){return s=+s,t=+t,n=+n,Q1(t,s,n)[2]}function dC(t,s,n){s=+s,t=+t,n=+n;const a=s<t,i=a?cC(s,t,n):cC(t,s,n);return(a?-1:1)*(i<0?1/-i:i)}function ZD(t,s){let n;for(const a of t)a!=null&&(n<a||n===void 0&&a>=a)&&(n=a);return n}function JD(t,s){let n;for(const a of t)a!=null&&(n>a||n===void 0&&a>=a)&&(n=a);return n}function IW(t,s,n=0,a=1/0,i){if(s=Math.floor(s),n=Math.floor(Math.max(0,n)),a=Math.floor(Math.min(t.length-1,a)),!(n<=s&&s<=a))return t;for(i=i===void 0?PW:o5e(i);a>n;){if(a-n>600){const d=a-n+1,u=s-n+1,h=Math.log(d),f=.5*Math.exp(2*h/3),x=.5*Math.sqrt(h*f*(d-f)/d)*(u-d/2<0?-1:1),b=Math.max(n,Math.floor(s-u*f/d+x)),v=Math.min(a,Math.floor(s+(d-u)*f/d+x));IW(t,s,b,v,i)}const l=t[s];let o=n,c=a;for(Of(t,n,s),i(t[a],l)>0&&Of(t,n,a);o<c;){for(Of(t,o,c),++o,--c;i(t[o],l)<0;)++o;for(;i(t[c],l)>0;)--c}i(t[n],l)===0?Of(t,n,c):(++c,Of(t,c,a)),c<=s&&(n=c+1),s<=c&&(a=c-1)}return t}function Of(t,s,n){const a=t[s];t[s]=t[n],t[n]=a}function h5e(t,s,n){if(t=Float64Array.from(n5e(t)),!(!(a=t.length)||isNaN(s=+s))){if(s<=0||a<2)return JD(t);if(s>=1)return ZD(t);var a,i=(a-1)*s,l=Math.floor(i),o=ZD(IW(t,l).subarray(0,l+1)),c=JD(t.subarray(l+1));return o+(c-o)*(i-l)}}function m5e(t,s,n=TW){if(!(!(a=t.length)||isNaN(s=+s))){if(s<=0||a<2)return+n(t[0],0,t);if(s>=1)return+n(t[a-1],a-1,t);var a,i=(a-1)*s,l=Math.floor(i),o=+n(t[l],l,t),c=+n(t[l+1],l+1,t);return o+(c-o)*(i-l)}}function f5e(t,s,n){t=+t,s=+s,n=(i=arguments.length)<2?(s=t,t=0,1):i<3?1:+n;for(var a=-1,i=Math.max(0,Math.ceil((s-t)/n))|0,l=new Array(i);++a<i;)l[a]=t+a*n;return l}function Zi(t,s){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(s).domain(t);break}return this}function ac(t,s){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof s=="function"?this.interpolator(s):this.range(s);break}}return this}const uC=Symbol("implicit");function oA(){var t=new XD,s=[],n=[],a=uC;function i(l){let o=t.get(l);if(o===void 0){if(a!==uC)return a;t.set(l,o=s.push(l)-1)}return n[o%n.length]}return i.domain=function(l){if(!arguments.length)return s.slice();s=[],t=new XD;for(const o of l)t.has(o)||t.set(o,s.push(o)-1);return i},i.range=function(l){return arguments.length?(n=Array.from(l),i):n.slice()},i.unknown=function(l){return arguments.length?(a=l,i):a},i.copy=function(){return oA(s,n).unknown(a)},Zi.apply(i,arguments),i}function cA(){var t=oA().unknown(void 0),s=t.domain,n=t.range,a=0,i=1,l,o,c=!1,d=0,u=0,h=.5;delete t.unknown;function f(){var x=s().length,b=i<a,v=b?i:a,w=b?a:i;l=(w-v)/Math.max(1,x-d+u*2),c&&(l=Math.floor(l)),v+=(w-v-l*(x-d))*h,o=l*(1-d),c&&(v=Math.round(v),o=Math.round(o));var _=f5e(x).map(function(S){return v+l*S});return n(b?_.reverse():_)}return t.domain=function(x){return arguments.length?(s(x),f()):s()},t.range=function(x){return arguments.length?([a,i]=x,a=+a,i=+i,f()):[a,i]},t.rangeRound=function(x){return[a,i]=x,a=+a,i=+i,c=!0,f()},t.bandwidth=function(){return o},t.step=function(){return l},t.round=function(x){return arguments.length?(c=!!x,f()):c},t.padding=function(x){return arguments.length?(d=Math.min(1,u=+x),f()):d},t.paddingInner=function(x){return arguments.length?(d=Math.min(1,x),f()):d},t.paddingOuter=function(x){return arguments.length?(u=+x,f()):u},t.align=function(x){return arguments.length?(h=Math.max(0,Math.min(1,x)),f()):h},t.copy=function(){return cA(s(),[a,i]).round(c).paddingInner(d).paddingOuter(u).align(h)},Zi.apply(f(),arguments)}function MW(t){var s=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return MW(s())},t}function p5e(){return MW(cA.apply(null,arguments).paddingInner(1))}function dA(t,s,n){t.prototype=s.prototype=n,n.constructor=t}function DW(t,s){var n=Object.create(t.prototype);for(var a in s)n[a]=s[a];return n}function r0(){}var wx=.7,Z1=1/wx,Zh="\\s*([+-]?\\d+)\\s*",jx="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",io="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",x5e=/^#([0-9a-f]{3,8})$/,g5e=new RegExp(`^rgb\\(${Zh},${Zh},${Zh}\\)$`),y5e=new RegExp(`^rgb\\(${io},${io},${io}\\)$`),b5e=new RegExp(`^rgba\\(${Zh},${Zh},${Zh},${jx}\\)$`),v5e=new RegExp(`^rgba\\(${io},${io},${io},${jx}\\)$`),N5e=new RegExp(`^hsl\\(${jx},${io},${io}\\)$`),w5e=new RegExp(`^hsla\\(${jx},${io},${io},${jx}\\)$`),eO={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};dA(r0,_x,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:tO,formatHex:tO,formatHex8:j5e,formatHsl:_5e,formatRgb:sO,toString:sO});function tO(){return this.rgb().formatHex()}function j5e(){return this.rgb().formatHex8()}function _5e(){return OW(this).formatHsl()}function sO(){return this.rgb().formatRgb()}function _x(t){var s,n;return t=(t+"").trim().toLowerCase(),(s=x5e.exec(t))?(n=s[1].length,s=parseInt(s[1],16),n===6?nO(s):n===3?new Pa(s>>8&15|s>>4&240,s>>4&15|s&240,(s&15)<<4|s&15,1):n===8?Tg(s>>24&255,s>>16&255,s>>8&255,(s&255)/255):n===4?Tg(s>>12&15|s>>8&240,s>>8&15|s>>4&240,s>>4&15|s&240,((s&15)<<4|s&15)/255):null):(s=g5e.exec(t))?new Pa(s[1],s[2],s[3],1):(s=y5e.exec(t))?new Pa(s[1]*255/100,s[2]*255/100,s[3]*255/100,1):(s=b5e.exec(t))?Tg(s[1],s[2],s[3],s[4]):(s=v5e.exec(t))?Tg(s[1]*255/100,s[2]*255/100,s[3]*255/100,s[4]):(s=N5e.exec(t))?iO(s[1],s[2]/100,s[3]/100,1):(s=w5e.exec(t))?iO(s[1],s[2]/100,s[3]/100,s[4]):eO.hasOwnProperty(t)?nO(eO[t]):t==="transparent"?new Pa(NaN,NaN,NaN,0):null}function nO(t){return new Pa(t>>16&255,t>>8&255,t&255,1)}function Tg(t,s,n,a){return a<=0&&(t=s=n=NaN),new Pa(t,s,n,a)}function S5e(t){return t instanceof r0||(t=_x(t)),t?(t=t.rgb(),new Pa(t.r,t.g,t.b,t.opacity)):new Pa}function hC(t,s,n,a){return arguments.length===1?S5e(t):new Pa(t,s,n,a??1)}function Pa(t,s,n,a){this.r=+t,this.g=+s,this.b=+n,this.opacity=+a}dA(Pa,hC,DW(r0,{brighter(t){return t=t==null?Z1:Math.pow(Z1,t),new Pa(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?wx:Math.pow(wx,t),new Pa(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Pa(xu(this.r),xu(this.g),xu(this.b),J1(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rO,formatHex:rO,formatHex8:C5e,formatRgb:aO,toString:aO}));function rO(){return`#${tu(this.r)}${tu(this.g)}${tu(this.b)}`}function C5e(){return`#${tu(this.r)}${tu(this.g)}${tu(this.b)}${tu((isNaN(this.opacity)?1:this.opacity)*255)}`}function aO(){const t=J1(this.opacity);return`${t===1?"rgb(":"rgba("}${xu(this.r)}, ${xu(this.g)}, ${xu(this.b)}${t===1?")":`, ${t})`}`}function J1(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function xu(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function tu(t){return t=xu(t),(t<16?"0":"")+t.toString(16)}function iO(t,s,n,a){return a<=0?t=s=n=NaN:n<=0||n>=1?t=s=NaN:s<=0&&(t=NaN),new ml(t,s,n,a)}function OW(t){if(t instanceof ml)return new ml(t.h,t.s,t.l,t.opacity);if(t instanceof r0||(t=_x(t)),!t)return new ml;if(t instanceof ml)return t;t=t.rgb();var s=t.r/255,n=t.g/255,a=t.b/255,i=Math.min(s,n,a),l=Math.max(s,n,a),o=NaN,c=l-i,d=(l+i)/2;return c?(s===l?o=(n-a)/c+(n<a)*6:n===l?o=(a-s)/c+2:o=(s-n)/c+4,c/=d<.5?l+i:2-l-i,o*=60):c=d>0&&d<1?0:o,new ml(o,c,d,t.opacity)}function k5e(t,s,n,a){return arguments.length===1?OW(t):new ml(t,s,n,a??1)}function ml(t,s,n,a){this.h=+t,this.s=+s,this.l=+n,this.opacity=+a}dA(ml,k5e,DW(r0,{brighter(t){return t=t==null?Z1:Math.pow(Z1,t),new ml(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?wx:Math.pow(wx,t),new ml(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,s=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,a=n+(n<.5?n:1-n)*s,i=2*n-a;return new Pa(Hj(t>=240?t-240:t+120,i,a),Hj(t,i,a),Hj(t<120?t+240:t-120,i,a),this.opacity)},clamp(){return new ml(lO(this.h),Pg(this.s),Pg(this.l),J1(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=J1(this.opacity);return`${t===1?"hsl(":"hsla("}${lO(this.h)}, ${Pg(this.s)*100}%, ${Pg(this.l)*100}%${t===1?")":`, ${t})`}`}}));function lO(t){return t=(t||0)%360,t<0?t+360:t}function Pg(t){return Math.max(0,Math.min(1,t||0))}function Hj(t,s,n){return(t<60?s+(n-s)*t/60:t<180?n:t<240?s+(n-s)*(240-t)/60:s)*255}const uA=t=>()=>t;function A5e(t,s){return function(n){return t+n*s}}function E5e(t,s,n){return t=Math.pow(t,n),s=Math.pow(s,n)-t,n=1/n,function(a){return Math.pow(t+a*s,n)}}function T5e(t){return(t=+t)==1?RW:function(s,n){return n-s?E5e(s,n,t):uA(isNaN(s)?n:s)}}function RW(t,s){var n=s-t;return n?A5e(t,n):uA(isNaN(t)?s:t)}const oO=function t(s){var n=T5e(s);function a(i,l){var o=n((i=hC(i)).r,(l=hC(l)).r),c=n(i.g,l.g),d=n(i.b,l.b),u=RW(i.opacity,l.opacity);return function(h){return i.r=o(h),i.g=c(h),i.b=d(h),i.opacity=u(h),i+""}}return a.gamma=t,a}(1);function P5e(t,s){s||(s=[]);var n=t?Math.min(s.length,t.length):0,a=s.slice(),i;return function(l){for(i=0;i<n;++i)a[i]=t[i]*(1-l)+s[i]*l;return a}}function I5e(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function M5e(t,s){var n=s?s.length:0,a=t?Math.min(n,t.length):0,i=new Array(a),l=new Array(n),o;for(o=0;o<a;++o)i[o]=Xm(t[o],s[o]);for(;o<n;++o)l[o]=s[o];return function(c){for(o=0;o<a;++o)l[o]=i[o](c);return l}}function D5e(t,s){var n=new Date;return t=+t,s=+s,function(a){return n.setTime(t*(1-a)+s*a),n}}function eb(t,s){return t=+t,s=+s,function(n){return t*(1-n)+s*n}}function O5e(t,s){var n={},a={},i;(t===null||typeof t!="object")&&(t={}),(s===null||typeof s!="object")&&(s={});for(i in s)i in t?n[i]=Xm(t[i],s[i]):a[i]=s[i];return function(l){for(i in n)a[i]=n[i](l);return a}}var mC=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Wj=new RegExp(mC.source,"g");function R5e(t){return function(){return t}}function L5e(t){return function(s){return t(s)+""}}function B5e(t,s){var n=mC.lastIndex=Wj.lastIndex=0,a,i,l,o=-1,c=[],d=[];for(t=t+"",s=s+"";(a=mC.exec(t))&&(i=Wj.exec(s));)(l=i.index)>n&&(l=s.slice(n,l),c[o]?c[o]+=l:c[++o]=l),(a=a[0])===(i=i[0])?c[o]?c[o]+=i:c[++o]=i:(c[++o]=null,d.push({i:o,x:eb(a,i)})),n=Wj.lastIndex;return n<s.length&&(l=s.slice(n),c[o]?c[o]+=l:c[++o]=l),c.length<2?d[0]?L5e(d[0].x):R5e(s):(s=d.length,function(u){for(var h=0,f;h<s;++h)c[(f=d[h]).i]=f.x(u);return c.join("")})}function Xm(t,s){var n=typeof s,a;return s==null||n==="boolean"?uA(s):(n==="number"?eb:n==="string"?(a=_x(s))?(s=a,oO):B5e:s instanceof _x?oO:s instanceof Date?D5e:I5e(s)?P5e:Array.isArray(s)?M5e:typeof s.valueOf!="function"&&typeof s.toString!="function"||isNaN(s)?O5e:eb)(t,s)}function hA(t,s){return t=+t,s=+s,function(n){return Math.round(t*(1-n)+s*n)}}function F5e(t,s){s===void 0&&(s=t,t=Xm);for(var n=0,a=s.length-1,i=s[0],l=new Array(a<0?0:a);n<a;)l[n]=t(i,i=s[++n]);return function(o){var c=Math.max(0,Math.min(a-1,Math.floor(o*=a)));return l[c](o-c)}}function $5e(t){return function(){return t}}function tb(t){return+t}var cO=[0,1];function ha(t){return t}function fC(t,s){return(s-=t=+t)?function(n){return(n-t)/s}:$5e(isNaN(s)?NaN:.5)}function z5e(t,s){var n;return t>s&&(n=t,t=s,s=n),function(a){return Math.max(t,Math.min(s,a))}}function U5e(t,s,n){var a=t[0],i=t[1],l=s[0],o=s[1];return i<a?(a=fC(i,a),l=n(o,l)):(a=fC(a,i),l=n(l,o)),function(c){return l(a(c))}}function V5e(t,s,n){var a=Math.min(t.length,s.length)-1,i=new Array(a),l=new Array(a),o=-1;for(t[a]<t[0]&&(t=t.slice().reverse(),s=s.slice().reverse());++o<a;)i[o]=fC(t[o],t[o+1]),l[o]=n(s[o],s[o+1]);return function(c){var d=n0(t,c,1,a)-1;return l[d](i[d](c))}}function a0(t,s){return s.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function cN(){var t=cO,s=cO,n=Xm,a,i,l,o=ha,c,d,u;function h(){var x=Math.min(t.length,s.length);return o!==ha&&(o=z5e(t[0],t[x-1])),c=x>2?V5e:U5e,d=u=null,f}function f(x){return x==null||isNaN(x=+x)?l:(d||(d=c(t.map(a),s,n)))(a(o(x)))}return f.invert=function(x){return o(i((u||(u=c(s,t.map(a),eb)))(x)))},f.domain=function(x){return arguments.length?(t=Array.from(x,tb),h()):t.slice()},f.range=function(x){return arguments.length?(s=Array.from(x),h()):s.slice()},f.rangeRound=function(x){return s=Array.from(x),n=hA,h()},f.clamp=function(x){return arguments.length?(o=x?!0:ha,h()):o!==ha},f.interpolate=function(x){return arguments.length?(n=x,h()):n},f.unknown=function(x){return arguments.length?(l=x,f):l},function(x,b){return a=x,i=b,h()}}function mA(){return cN()(ha,ha)}function H5e(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function sb(t,s){if((n=(t=s?t.toExponential(s-1):t.toExponential()).indexOf("e"))<0)return null;var n,a=t.slice(0,n);return[a.length>1?a[0]+a.slice(2):a,+t.slice(n+1)]}function wm(t){return t=sb(Math.abs(t)),t?t[1]:NaN}function W5e(t,s){return function(n,a){for(var i=n.length,l=[],o=0,c=t[0],d=0;i>0&&c>0&&(d+c+1>a&&(c=Math.max(1,a-d)),l.push(n.substring(i-=c,i+c)),!((d+=c+1)>a));)c=t[o=(o+1)%t.length];return l.reverse().join(s)}}function q5e(t){return function(s){return s.replace(/[0-9]/g,function(n){return t[+n]})}}var G5e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Sx(t){if(!(s=G5e.exec(t)))throw new Error("invalid format: "+t);var s;return new fA({fill:s[1],align:s[2],sign:s[3],symbol:s[4],zero:s[5],width:s[6],comma:s[7],precision:s[8]&&s[8].slice(1),trim:s[9],type:s[10]})}Sx.prototype=fA.prototype;function fA(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}fA.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function K5e(t){e:for(var s=t.length,n=1,a=-1,i;n<s;++n)switch(t[n]){case".":a=i=n;break;case"0":a===0&&(a=n),i=n;break;default:if(!+t[n])break e;a>0&&(a=0);break}return a>0?t.slice(0,a)+t.slice(i+1):t}var LW;function Y5e(t,s){var n=sb(t,s);if(!n)return t+"";var a=n[0],i=n[1],l=i-(LW=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=a.length;return l===o?a:l>o?a+new Array(l-o+1).join("0"):l>0?a.slice(0,l)+"."+a.slice(l):"0."+new Array(1-l).join("0")+sb(t,Math.max(0,s+l-1))[0]}function dO(t,s){var n=sb(t,s);if(!n)return t+"";var a=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+a:a.length>i+1?a.slice(0,i+1)+"."+a.slice(i+1):a+new Array(i-a.length+2).join("0")}const uO={"%":(t,s)=>(t*100).toFixed(s),b:t=>Math.round(t).toString(2),c:t=>t+"",d:H5e,e:(t,s)=>t.toExponential(s),f:(t,s)=>t.toFixed(s),g:(t,s)=>t.toPrecision(s),o:t=>Math.round(t).toString(8),p:(t,s)=>dO(t*100,s),r:dO,s:Y5e,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function hO(t){return t}var mO=Array.prototype.map,fO=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function X5e(t){var s=t.grouping===void 0||t.thousands===void 0?hO:W5e(mO.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",a=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",l=t.numerals===void 0?hO:q5e(mO.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",c=t.minus===void 0?"":t.minus+"",d=t.nan===void 0?"NaN":t.nan+"";function u(f){f=Sx(f);var x=f.fill,b=f.align,v=f.sign,w=f.symbol,_=f.zero,S=f.width,k=f.comma,A=f.precision,T=f.trim,P=f.type;P==="n"?(k=!0,P="g"):uO[P]||(A===void 0&&(A=12),T=!0,P="g"),(_||x==="0"&&b==="=")&&(_=!0,x="0",b="=");var O=w==="$"?n:w==="#"&&/[boxX]/.test(P)?"0"+P.toLowerCase():"",D=w==="$"?a:/[%p]/.test(P)?o:"",I=uO[P],M=/[defgprs%]/.test(P);A=A===void 0?6:/[gprs]/.test(P)?Math.max(1,Math.min(21,A)):Math.max(0,Math.min(20,A));function B(L){var F=O,V=D,$,z,H;if(P==="c")V=I(L)+V,L="";else{L=+L;var q=L<0||1/L<0;if(L=isNaN(L)?d:I(Math.abs(L),A),T&&(L=K5e(L)),q&&+L==0&&v!=="+"&&(q=!1),F=(q?v==="("?v:c:v==="-"||v==="("?"":v)+F,V=(P==="s"?fO[8+LW/3]:"")+V+(q&&v==="("?")":""),M){for($=-1,z=L.length;++$<z;)if(H=L.charCodeAt($),48>H||H>57){V=(H===46?i+L.slice($+1):L.slice($))+V,L=L.slice(0,$);break}}}k&&!_&&(L=s(L,1/0));var G=F.length+L.length+V.length,re=G<S?new Array(S-G+1).join(x):"";switch(k&&_&&(L=s(re+L,re.length?S-V.length:1/0),re=""),b){case"<":L=F+L+V+re;break;case"=":L=F+re+L+V;break;case"^":L=re.slice(0,G=re.length>>1)+F+L+V+re.slice(G);break;default:L=re+F+L+V;break}return l(L)}return B.toString=function(){return f+""},B}function h(f,x){var b=u((f=Sx(f),f.type="f",f)),v=Math.max(-8,Math.min(8,Math.floor(wm(x)/3)))*3,w=Math.pow(10,-v),_=fO[8+v/3];return function(S){return b(w*S)+_}}return{format:u,formatPrefix:h}}var Ig,pA,BW;Q5e({thousands:",",grouping:[3],currency:["$",""]});function Q5e(t){return Ig=X5e(t),pA=Ig.format,BW=Ig.formatPrefix,Ig}function Z5e(t){return Math.max(0,-wm(Math.abs(t)))}function J5e(t,s){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(wm(s)/3)))*3-wm(Math.abs(t)))}function eAe(t,s){return t=Math.abs(t),s=Math.abs(s)-t,Math.max(0,wm(s)-wm(t))+1}function FW(t,s,n,a){var i=dC(t,s,n),l;switch(a=Sx(a??",f"),a.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(s));return a.precision==null&&!isNaN(l=J5e(i,o))&&(a.precision=l),BW(a,o)}case"":case"e":case"g":case"p":case"r":{a.precision==null&&!isNaN(l=eAe(i,Math.max(Math.abs(t),Math.abs(s))))&&(a.precision=l-(a.type==="e"));break}case"f":case"%":{a.precision==null&&!isNaN(l=Z5e(i))&&(a.precision=l-(a.type==="%")*2);break}}return pA(a)}function Sd(t){var s=t.domain;return t.ticks=function(n){var a=s();return oC(a[0],a[a.length-1],n??10)},t.tickFormat=function(n,a){var i=s();return FW(i[0],i[i.length-1],n??10,a)},t.nice=function(n){n==null&&(n=10);var a=s(),i=0,l=a.length-1,o=a[i],c=a[l],d,u,h=10;for(c<o&&(u=o,o=c,c=u,u=i,i=l,l=u);h-- >0;){if(u=cC(o,c,n),u===d)return a[i]=o,a[l]=c,s(a);if(u>0)o=Math.floor(o/u)*u,c=Math.ceil(c/u)*u;else if(u<0)o=Math.ceil(o*u)/u,c=Math.floor(c*u)/u;else break;d=u}return t},t}function $W(){var t=mA();return t.copy=function(){return a0(t,$W())},Zi.apply(t,arguments),Sd(t)}function zW(t){var s;function n(a){return a==null||isNaN(a=+a)?s:a}return n.invert=n,n.domain=n.range=function(a){return arguments.length?(t=Array.from(a,tb),n):t.slice()},n.unknown=function(a){return arguments.length?(s=a,n):s},n.copy=function(){return zW(t).unknown(s)},t=arguments.length?Array.from(t,tb):[0,1],Sd(n)}function UW(t,s){t=t.slice();var n=0,a=t.length-1,i=t[n],l=t[a],o;return l<i&&(o=n,n=a,a=o,o=i,i=l,l=o),t[n]=s.floor(i),t[a]=s.ceil(l),t}function pO(t){return Math.log(t)}function xO(t){return Math.exp(t)}function tAe(t){return-Math.log(-t)}function sAe(t){return-Math.exp(-t)}function nAe(t){return isFinite(t)?+("1e"+t):t<0?0:t}function rAe(t){return t===10?nAe:t===Math.E?Math.exp:s=>Math.pow(t,s)}function aAe(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),s=>Math.log(s)/t)}function gO(t){return(s,n)=>-t(-s,n)}function xA(t){const s=t(pO,xO),n=s.domain;let a=10,i,l;function o(){return i=aAe(a),l=rAe(a),n()[0]<0?(i=gO(i),l=gO(l),t(tAe,sAe)):t(pO,xO),s}return s.base=function(c){return arguments.length?(a=+c,o()):a},s.domain=function(c){return arguments.length?(n(c),o()):n()},s.ticks=c=>{const d=n();let u=d[0],h=d[d.length-1];const f=h<u;f&&([u,h]=[h,u]);let x=i(u),b=i(h),v,w;const _=c==null?10:+c;let S=[];if(!(a%1)&&b-x<_){if(x=Math.floor(x),b=Math.ceil(b),u>0){for(;x<=b;++x)for(v=1;v<a;++v)if(w=x<0?v/l(-x):v*l(x),!(w<u)){if(w>h)break;S.push(w)}}else for(;x<=b;++x)for(v=a-1;v>=1;--v)if(w=x>0?v/l(-x):v*l(x),!(w<u)){if(w>h)break;S.push(w)}S.length*2<_&&(S=oC(u,h,_))}else S=oC(x,b,Math.min(b-x,_)).map(l);return f?S.reverse():S},s.tickFormat=(c,d)=>{if(c==null&&(c=10),d==null&&(d=a===10?"s":","),typeof d!="function"&&(!(a%1)&&(d=Sx(d)).precision==null&&(d.trim=!0),d=pA(d)),c===1/0)return d;const u=Math.max(1,a*c/s.ticks().length);return h=>{let f=h/l(Math.round(i(h)));return f*a<a-.5&&(f*=a),f<=u?d(h):""}},s.nice=()=>n(UW(n(),{floor:c=>l(Math.floor(i(c))),ceil:c=>l(Math.ceil(i(c)))})),s}function VW(){const t=xA(cN()).domain([1,10]);return t.copy=()=>a0(t,VW()).base(t.base()),Zi.apply(t,arguments),t}function yO(t){return function(s){return Math.sign(s)*Math.log1p(Math.abs(s/t))}}function bO(t){return function(s){return Math.sign(s)*Math.expm1(Math.abs(s))*t}}function gA(t){var s=1,n=t(yO(s),bO(s));return n.constant=function(a){return arguments.length?t(yO(s=+a),bO(s)):s},Sd(n)}function HW(){var t=gA(cN());return t.copy=function(){return a0(t,HW()).constant(t.constant())},Zi.apply(t,arguments)}function vO(t){return function(s){return s<0?-Math.pow(-s,t):Math.pow(s,t)}}function iAe(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function lAe(t){return t<0?-t*t:t*t}function yA(t){var s=t(ha,ha),n=1;function a(){return n===1?t(ha,ha):n===.5?t(iAe,lAe):t(vO(n),vO(1/n))}return s.exponent=function(i){return arguments.length?(n=+i,a()):n},Sd(s)}function bA(){var t=yA(cN());return t.copy=function(){return a0(t,bA()).exponent(t.exponent())},Zi.apply(t,arguments),t}function oAe(){return bA.apply(null,arguments).exponent(.5)}function NO(t){return Math.sign(t)*t*t}function cAe(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function WW(){var t=mA(),s=[0,1],n=!1,a;function i(l){var o=cAe(t(l));return isNaN(o)?a:n?Math.round(o):o}return i.invert=function(l){return t.invert(NO(l))},i.domain=function(l){return arguments.length?(t.domain(l),i):t.domain()},i.range=function(l){return arguments.length?(t.range((s=Array.from(l,tb)).map(NO)),i):s.slice()},i.rangeRound=function(l){return i.range(l).round(!0)},i.round=function(l){return arguments.length?(n=!!l,i):n},i.clamp=function(l){return arguments.length?(t.clamp(l),i):t.clamp()},i.unknown=function(l){return arguments.length?(a=l,i):a},i.copy=function(){return WW(t.domain(),s).round(n).clamp(t.clamp()).unknown(a)},Zi.apply(i,arguments),Sd(i)}function qW(){var t=[],s=[],n=[],a;function i(){var o=0,c=Math.max(1,s.length);for(n=new Array(c-1);++o<c;)n[o-1]=m5e(t,o/c);return l}function l(o){return o==null||isNaN(o=+o)?a:s[n0(n,o)]}return l.invertExtent=function(o){var c=s.indexOf(o);return c<0?[NaN,NaN]:[c>0?n[c-1]:t[0],c<n.length?n[c]:t[t.length-1]]},l.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let c of o)c!=null&&!isNaN(c=+c)&&t.push(c);return t.sort(td),i()},l.range=function(o){return arguments.length?(s=Array.from(o),i()):s.slice()},l.unknown=function(o){return arguments.length?(a=o,l):a},l.quantiles=function(){return n.slice()},l.copy=function(){return qW().domain(t).range(s).unknown(a)},Zi.apply(l,arguments)}function GW(){var t=0,s=1,n=1,a=[.5],i=[0,1],l;function o(d){return d!=null&&d<=d?i[n0(a,d,0,n)]:l}function c(){var d=-1;for(a=new Array(n);++d<n;)a[d]=((d+1)*s-(d-n)*t)/(n+1);return o}return o.domain=function(d){return arguments.length?([t,s]=d,t=+t,s=+s,c()):[t,s]},o.range=function(d){return arguments.length?(n=(i=Array.from(d)).length-1,c()):i.slice()},o.invertExtent=function(d){var u=i.indexOf(d);return u<0?[NaN,NaN]:u<1?[t,a[0]]:u>=n?[a[n-1],s]:[a[u-1],a[u]]},o.unknown=function(d){return arguments.length&&(l=d),o},o.thresholds=function(){return a.slice()},o.copy=function(){return GW().domain([t,s]).range(i).unknown(l)},Zi.apply(Sd(o),arguments)}function KW(){var t=[.5],s=[0,1],n,a=1;function i(l){return l!=null&&l<=l?s[n0(t,l,0,a)]:n}return i.domain=function(l){return arguments.length?(t=Array.from(l),a=Math.min(t.length,s.length-1),i):t.slice()},i.range=function(l){return arguments.length?(s=Array.from(l),a=Math.min(t.length,s.length-1),i):s.slice()},i.invertExtent=function(l){var o=s.indexOf(l);return[t[o-1],t[o]]},i.unknown=function(l){return arguments.length?(n=l,i):n},i.copy=function(){return KW().domain(t).range(s).unknown(n)},Zi.apply(i,arguments)}const qj=new Date,Gj=new Date;function mr(t,s,n,a){function i(l){return t(l=arguments.length===0?new Date:new Date(+l)),l}return i.floor=l=>(t(l=new Date(+l)),l),i.ceil=l=>(t(l=new Date(l-1)),s(l,1),t(l),l),i.round=l=>{const o=i(l),c=i.ceil(l);return l-o<c-l?o:c},i.offset=(l,o)=>(s(l=new Date(+l),o==null?1:Math.floor(o)),l),i.range=(l,o,c)=>{const d=[];if(l=i.ceil(l),c=c==null?1:Math.floor(c),!(l<o)||!(c>0))return d;let u;do d.push(u=new Date(+l)),s(l,c),t(l);while(u<l&&l<o);return d},i.filter=l=>mr(o=>{if(o>=o)for(;t(o),!l(o);)o.setTime(o-1)},(o,c)=>{if(o>=o)if(c<0)for(;++c<=0;)for(;s(o,-1),!l(o););else for(;--c>=0;)for(;s(o,1),!l(o););}),n&&(i.count=(l,o)=>(qj.setTime(+l),Gj.setTime(+o),t(qj),t(Gj),Math.floor(n(qj,Gj))),i.every=l=>(l=Math.floor(l),!isFinite(l)||!(l>0)?null:l>1?i.filter(a?o=>a(o)%l===0:o=>i.count(0,o)%l===0):i)),i}const nb=mr(()=>{},(t,s)=>{t.setTime(+t+s)},(t,s)=>s-t);nb.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?mr(s=>{s.setTime(Math.floor(s/t)*t)},(s,n)=>{s.setTime(+s+n*t)},(s,n)=>(n-s)/t):nb);nb.range;const Io=1e3,Oi=Io*60,Mo=Oi*60,Yo=Mo*24,vA=Yo*7,wO=Yo*30,Kj=Yo*365,su=mr(t=>{t.setTime(t-t.getMilliseconds())},(t,s)=>{t.setTime(+t+s*Io)},(t,s)=>(s-t)/Io,t=>t.getUTCSeconds());su.range;const NA=mr(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Io)},(t,s)=>{t.setTime(+t+s*Oi)},(t,s)=>(s-t)/Oi,t=>t.getMinutes());NA.range;const wA=mr(t=>{t.setUTCSeconds(0,0)},(t,s)=>{t.setTime(+t+s*Oi)},(t,s)=>(s-t)/Oi,t=>t.getUTCMinutes());wA.range;const jA=mr(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Io-t.getMinutes()*Oi)},(t,s)=>{t.setTime(+t+s*Mo)},(t,s)=>(s-t)/Mo,t=>t.getHours());jA.range;const _A=mr(t=>{t.setUTCMinutes(0,0,0)},(t,s)=>{t.setTime(+t+s*Mo)},(t,s)=>(s-t)/Mo,t=>t.getUTCHours());_A.range;const i0=mr(t=>t.setHours(0,0,0,0),(t,s)=>t.setDate(t.getDate()+s),(t,s)=>(s-t-(s.getTimezoneOffset()-t.getTimezoneOffset())*Oi)/Yo,t=>t.getDate()-1);i0.range;const dN=mr(t=>{t.setUTCHours(0,0,0,0)},(t,s)=>{t.setUTCDate(t.getUTCDate()+s)},(t,s)=>(s-t)/Yo,t=>t.getUTCDate()-1);dN.range;const YW=mr(t=>{t.setUTCHours(0,0,0,0)},(t,s)=>{t.setUTCDate(t.getUTCDate()+s)},(t,s)=>(s-t)/Yo,t=>Math.floor(t/Yo));YW.range;function Zu(t){return mr(s=>{s.setDate(s.getDate()-(s.getDay()+7-t)%7),s.setHours(0,0,0,0)},(s,n)=>{s.setDate(s.getDate()+n*7)},(s,n)=>(n-s-(n.getTimezoneOffset()-s.getTimezoneOffset())*Oi)/vA)}const uN=Zu(0),rb=Zu(1),dAe=Zu(2),uAe=Zu(3),jm=Zu(4),hAe=Zu(5),mAe=Zu(6);uN.range;rb.range;dAe.range;uAe.range;jm.range;hAe.range;mAe.range;function Ju(t){return mr(s=>{s.setUTCDate(s.getUTCDate()-(s.getUTCDay()+7-t)%7),s.setUTCHours(0,0,0,0)},(s,n)=>{s.setUTCDate(s.getUTCDate()+n*7)},(s,n)=>(n-s)/vA)}const hN=Ju(0),ab=Ju(1),fAe=Ju(2),pAe=Ju(3),_m=Ju(4),xAe=Ju(5),gAe=Ju(6);hN.range;ab.range;fAe.range;pAe.range;_m.range;xAe.range;gAe.range;const SA=mr(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,s)=>{t.setMonth(t.getMonth()+s)},(t,s)=>s.getMonth()-t.getMonth()+(s.getFullYear()-t.getFullYear())*12,t=>t.getMonth());SA.range;const CA=mr(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,s)=>{t.setUTCMonth(t.getUTCMonth()+s)},(t,s)=>s.getUTCMonth()-t.getUTCMonth()+(s.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());CA.range;const Xo=mr(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,s)=>{t.setFullYear(t.getFullYear()+s)},(t,s)=>s.getFullYear()-t.getFullYear(),t=>t.getFullYear());Xo.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:mr(s=>{s.setFullYear(Math.floor(s.getFullYear()/t)*t),s.setMonth(0,1),s.setHours(0,0,0,0)},(s,n)=>{s.setFullYear(s.getFullYear()+n*t)});Xo.range;const Qo=mr(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,s)=>{t.setUTCFullYear(t.getUTCFullYear()+s)},(t,s)=>s.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());Qo.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:mr(s=>{s.setUTCFullYear(Math.floor(s.getUTCFullYear()/t)*t),s.setUTCMonth(0,1),s.setUTCHours(0,0,0,0)},(s,n)=>{s.setUTCFullYear(s.getUTCFullYear()+n*t)});Qo.range;function XW(t,s,n,a,i,l){const o=[[su,1,Io],[su,5,5*Io],[su,15,15*Io],[su,30,30*Io],[l,1,Oi],[l,5,5*Oi],[l,15,15*Oi],[l,30,30*Oi],[i,1,Mo],[i,3,3*Mo],[i,6,6*Mo],[i,12,12*Mo],[a,1,Yo],[a,2,2*Yo],[n,1,vA],[s,1,wO],[s,3,3*wO],[t,1,Kj]];function c(u,h,f){const x=h<u;x&&([u,h]=[h,u]);const b=f&&typeof f.range=="function"?f:d(u,h,f),v=b?b.range(u,+h+1):[];return x?v.reverse():v}function d(u,h,f){const x=Math.abs(h-u)/f,b=lA(([,,_])=>_).right(o,x);if(b===o.length)return t.every(dC(u/Kj,h/Kj,f));if(b===0)return nb.every(Math.max(dC(u,h,f),1));const[v,w]=o[x/o[b-1][2]<o[b][2]/x?b-1:b];return v.every(w)}return[c,d]}const[yAe,bAe]=XW(Qo,CA,hN,YW,_A,wA),[vAe,NAe]=XW(Xo,SA,uN,i0,jA,NA);function Yj(t){if(0<=t.y&&t.y<100){var s=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return s.setFullYear(t.y),s}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Xj(t){if(0<=t.y&&t.y<100){var s=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return s.setUTCFullYear(t.y),s}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Rf(t,s,n){return{y:t,m:s,d:n,H:0,M:0,S:0,L:0}}function wAe(t){var s=t.dateTime,n=t.date,a=t.time,i=t.periods,l=t.days,o=t.shortDays,c=t.months,d=t.shortMonths,u=Lf(i),h=Bf(i),f=Lf(l),x=Bf(l),b=Lf(o),v=Bf(o),w=Lf(c),_=Bf(c),S=Lf(d),k=Bf(d),A={a:q,A:G,b:re,B:ye,c:null,d:AO,e:AO,f:WAe,g:tEe,G:nEe,H:UAe,I:VAe,j:HAe,L:QW,m:qAe,M:GAe,p:Ee,q:ee,Q:PO,s:IO,S:KAe,u:YAe,U:XAe,V:QAe,w:ZAe,W:JAe,x:null,X:null,y:eEe,Y:sEe,Z:rEe,"%":TO},T={a:te,A:ce,b:ge,B:X,c:null,d:EO,e:EO,f:oEe,g:yEe,G:vEe,H:aEe,I:iEe,j:lEe,L:JW,m:cEe,M:dEe,p:de,q:Ce,Q:PO,s:IO,S:uEe,u:hEe,U:mEe,V:fEe,w:pEe,W:xEe,x:null,X:null,y:gEe,Y:bEe,Z:NEe,"%":TO},P={a:B,A:L,b:F,B:V,c:$,d:CO,e:CO,f:BAe,g:SO,G:_O,H:kO,I:kO,j:DAe,L:LAe,m:MAe,M:OAe,p:M,q:IAe,Q:$Ae,s:zAe,S:RAe,u:kAe,U:AAe,V:EAe,w:CAe,W:TAe,x:z,X:H,y:SO,Y:_O,Z:PAe,"%":FAe};A.x=O(n,A),A.X=O(a,A),A.c=O(s,A),T.x=O(n,T),T.X=O(a,T),T.c=O(s,T);function O(ue,fe){return function(pe){var oe=[],qe=-1,Xe=0,jt=ue.length,ft,it,_t;for(pe instanceof Date||(pe=new Date(+pe));++qe<jt;)ue.charCodeAt(qe)===37&&(oe.push(ue.slice(Xe,qe)),(it=jO[ft=ue.charAt(++qe)])!=null?ft=ue.charAt(++qe):it=ft==="e"?" ":"0",(_t=fe[ft])&&(ft=_t(pe,it)),oe.push(ft),Xe=qe+1);return oe.push(ue.slice(Xe,qe)),oe.join("")}}function D(ue,fe){return function(pe){var oe=Rf(1900,void 0,1),qe=I(oe,ue,pe+="",0),Xe,jt;if(qe!=pe.length)return null;if("Q"in oe)return new Date(oe.Q);if("s"in oe)return new Date(oe.s*1e3+("L"in oe?oe.L:0));if(fe&&!("Z"in oe)&&(oe.Z=0),"p"in oe&&(oe.H=oe.H%12+oe.p*12),oe.m===void 0&&(oe.m="q"in oe?oe.q:0),"V"in oe){if(oe.V<1||oe.V>53)return null;"w"in oe||(oe.w=1),"Z"in oe?(Xe=Xj(Rf(oe.y,0,1)),jt=Xe.getUTCDay(),Xe=jt>4||jt===0?ab.ceil(Xe):ab(Xe),Xe=dN.offset(Xe,(oe.V-1)*7),oe.y=Xe.getUTCFullYear(),oe.m=Xe.getUTCMonth(),oe.d=Xe.getUTCDate()+(oe.w+6)%7):(Xe=Yj(Rf(oe.y,0,1)),jt=Xe.getDay(),Xe=jt>4||jt===0?rb.ceil(Xe):rb(Xe),Xe=i0.offset(Xe,(oe.V-1)*7),oe.y=Xe.getFullYear(),oe.m=Xe.getMonth(),oe.d=Xe.getDate()+(oe.w+6)%7)}else("W"in oe||"U"in oe)&&("w"in oe||(oe.w="u"in oe?oe.u%7:"W"in oe?1:0),jt="Z"in oe?Xj(Rf(oe.y,0,1)).getUTCDay():Yj(Rf(oe.y,0,1)).getDay(),oe.m=0,oe.d="W"in oe?(oe.w+6)%7+oe.W*7-(jt+5)%7:oe.w+oe.U*7-(jt+6)%7);return"Z"in oe?(oe.H+=oe.Z/100|0,oe.M+=oe.Z%100,Xj(oe)):Yj(oe)}}function I(ue,fe,pe,oe){for(var qe=0,Xe=fe.length,jt=pe.length,ft,it;qe<Xe;){if(oe>=jt)return-1;if(ft=fe.charCodeAt(qe++),ft===37){if(ft=fe.charAt(qe++),it=P[ft in jO?fe.charAt(qe++):ft],!it||(oe=it(ue,pe,oe))<0)return-1}else if(ft!=pe.charCodeAt(oe++))return-1}return oe}function M(ue,fe,pe){var oe=u.exec(fe.slice(pe));return oe?(ue.p=h.get(oe[0].toLowerCase()),pe+oe[0].length):-1}function B(ue,fe,pe){var oe=b.exec(fe.slice(pe));return oe?(ue.w=v.get(oe[0].toLowerCase()),pe+oe[0].length):-1}function L(ue,fe,pe){var oe=f.exec(fe.slice(pe));return oe?(ue.w=x.get(oe[0].toLowerCase()),pe+oe[0].length):-1}function F(ue,fe,pe){var oe=S.exec(fe.slice(pe));return oe?(ue.m=k.get(oe[0].toLowerCase()),pe+oe[0].length):-1}function V(ue,fe,pe){var oe=w.exec(fe.slice(pe));return oe?(ue.m=_.get(oe[0].toLowerCase()),pe+oe[0].length):-1}function $(ue,fe,pe){return I(ue,s,fe,pe)}function z(ue,fe,pe){return I(ue,n,fe,pe)}function H(ue,fe,pe){return I(ue,a,fe,pe)}function q(ue){return o[ue.getDay()]}function G(ue){return l[ue.getDay()]}function re(ue){return d[ue.getMonth()]}function ye(ue){return c[ue.getMonth()]}function Ee(ue){return i[+(ue.getHours()>=12)]}function ee(ue){return 1+~~(ue.getMonth()/3)}function te(ue){return o[ue.getUTCDay()]}function ce(ue){return l[ue.getUTCDay()]}function ge(ue){return d[ue.getUTCMonth()]}function X(ue){return c[ue.getUTCMonth()]}function de(ue){return i[+(ue.getUTCHours()>=12)]}function Ce(ue){return 1+~~(ue.getUTCMonth()/3)}return{format:function(ue){var fe=O(ue+="",A);return fe.toString=function(){return ue},fe},parse:function(ue){var fe=D(ue+="",!1);return fe.toString=function(){return ue},fe},utcFormat:function(ue){var fe=O(ue+="",T);return fe.toString=function(){return ue},fe},utcParse:function(ue){var fe=D(ue+="",!0);return fe.toString=function(){return ue},fe}}}var jO={"-":"",_:" ",0:"0"},Sr=/^\s*\d+/,jAe=/^%/,_Ae=/[\\^$*+?|[\]().{}]/g;function xs(t,s,n){var a=t<0?"-":"",i=(a?-t:t)+"",l=i.length;return a+(l<n?new Array(n-l+1).join(s)+i:i)}function SAe(t){return t.replace(_Ae,"\\$&")}function Lf(t){return new RegExp("^(?:"+t.map(SAe).join("|")+")","i")}function Bf(t){return new Map(t.map((s,n)=>[s.toLowerCase(),n]))}function CAe(t,s,n){var a=Sr.exec(s.slice(n,n+1));return a?(t.w=+a[0],n+a[0].length):-1}function kAe(t,s,n){var a=Sr.exec(s.slice(n,n+1));return a?(t.u=+a[0],n+a[0].length):-1}function AAe(t,s,n){var a=Sr.exec(s.slice(n,n+2));return a?(t.U=+a[0],n+a[0].length):-1}function EAe(t,s,n){var a=Sr.exec(s.slice(n,n+2));return a?(t.V=+a[0],n+a[0].length):-1}function TAe(t,s,n){var a=Sr.exec(s.slice(n,n+2));return a?(t.W=+a[0],n+a[0].length):-1}function _O(t,s,n){var a=Sr.exec(s.slice(n,n+4));return a?(t.y=+a[0],n+a[0].length):-1}function SO(t,s,n){var a=Sr.exec(s.slice(n,n+2));return a?(t.y=+a[0]+(+a[0]>68?1900:2e3),n+a[0].length):-1}function PAe(t,s,n){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(s.slice(n,n+6));return a?(t.Z=a[1]?0:-(a[2]+(a[3]||"00")),n+a[0].length):-1}function IAe(t,s,n){var a=Sr.exec(s.slice(n,n+1));return a?(t.q=a[0]*3-3,n+a[0].length):-1}function MAe(t,s,n){var a=Sr.exec(s.slice(n,n+2));return a?(t.m=a[0]-1,n+a[0].length):-1}function CO(t,s,n){var a=Sr.exec(s.slice(n,n+2));return a?(t.d=+a[0],n+a[0].length):-1}function DAe(t,s,n){var a=Sr.exec(s.slice(n,n+3));return a?(t.m=0,t.d=+a[0],n+a[0].length):-1}function kO(t,s,n){var a=Sr.exec(s.slice(n,n+2));return a?(t.H=+a[0],n+a[0].length):-1}function OAe(t,s,n){var a=Sr.exec(s.slice(n,n+2));return a?(t.M=+a[0],n+a[0].length):-1}function RAe(t,s,n){var a=Sr.exec(s.slice(n,n+2));return a?(t.S=+a[0],n+a[0].length):-1}function LAe(t,s,n){var a=Sr.exec(s.slice(n,n+3));return a?(t.L=+a[0],n+a[0].length):-1}function BAe(t,s,n){var a=Sr.exec(s.slice(n,n+6));return a?(t.L=Math.floor(a[0]/1e3),n+a[0].length):-1}function FAe(t,s,n){var a=jAe.exec(s.slice(n,n+1));return a?n+a[0].length:-1}function $Ae(t,s,n){var a=Sr.exec(s.slice(n));return a?(t.Q=+a[0],n+a[0].length):-1}function zAe(t,s,n){var a=Sr.exec(s.slice(n));return a?(t.s=+a[0],n+a[0].length):-1}function AO(t,s){return xs(t.getDate(),s,2)}function UAe(t,s){return xs(t.getHours(),s,2)}function VAe(t,s){return xs(t.getHours()%12||12,s,2)}function HAe(t,s){return xs(1+i0.count(Xo(t),t),s,3)}function QW(t,s){return xs(t.getMilliseconds(),s,3)}function WAe(t,s){return QW(t,s)+"000"}function qAe(t,s){return xs(t.getMonth()+1,s,2)}function GAe(t,s){return xs(t.getMinutes(),s,2)}function KAe(t,s){return xs(t.getSeconds(),s,2)}function YAe(t){var s=t.getDay();return s===0?7:s}function XAe(t,s){return xs(uN.count(Xo(t)-1,t),s,2)}function ZW(t){var s=t.getDay();return s>=4||s===0?jm(t):jm.ceil(t)}function QAe(t,s){return t=ZW(t),xs(jm.count(Xo(t),t)+(Xo(t).getDay()===4),s,2)}function ZAe(t){return t.getDay()}function JAe(t,s){return xs(rb.count(Xo(t)-1,t),s,2)}function eEe(t,s){return xs(t.getFullYear()%100,s,2)}function tEe(t,s){return t=ZW(t),xs(t.getFullYear()%100,s,2)}function sEe(t,s){return xs(t.getFullYear()%1e4,s,4)}function nEe(t,s){var n=t.getDay();return t=n>=4||n===0?jm(t):jm.ceil(t),xs(t.getFullYear()%1e4,s,4)}function rEe(t){var s=t.getTimezoneOffset();return(s>0?"-":(s*=-1,"+"))+xs(s/60|0,"0",2)+xs(s%60,"0",2)}function EO(t,s){return xs(t.getUTCDate(),s,2)}function aEe(t,s){return xs(t.getUTCHours(),s,2)}function iEe(t,s){return xs(t.getUTCHours()%12||12,s,2)}function lEe(t,s){return xs(1+dN.count(Qo(t),t),s,3)}function JW(t,s){return xs(t.getUTCMilliseconds(),s,3)}function oEe(t,s){return JW(t,s)+"000"}function cEe(t,s){return xs(t.getUTCMonth()+1,s,2)}function dEe(t,s){return xs(t.getUTCMinutes(),s,2)}function uEe(t,s){return xs(t.getUTCSeconds(),s,2)}function hEe(t){var s=t.getUTCDay();return s===0?7:s}function mEe(t,s){return xs(hN.count(Qo(t)-1,t),s,2)}function eq(t){var s=t.getUTCDay();return s>=4||s===0?_m(t):_m.ceil(t)}function fEe(t,s){return t=eq(t),xs(_m.count(Qo(t),t)+(Qo(t).getUTCDay()===4),s,2)}function pEe(t){return t.getUTCDay()}function xEe(t,s){return xs(ab.count(Qo(t)-1,t),s,2)}function gEe(t,s){return xs(t.getUTCFullYear()%100,s,2)}function yEe(t,s){return t=eq(t),xs(t.getUTCFullYear()%100,s,2)}function bEe(t,s){return xs(t.getUTCFullYear()%1e4,s,4)}function vEe(t,s){var n=t.getUTCDay();return t=n>=4||n===0?_m(t):_m.ceil(t),xs(t.getUTCFullYear()%1e4,s,4)}function NEe(){return"+0000"}function TO(){return"%"}function PO(t){return+t}function IO(t){return Math.floor(+t/1e3)}var mh,tq,sq;wEe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function wEe(t){return mh=wAe(t),tq=mh.format,mh.parse,sq=mh.utcFormat,mh.utcParse,mh}function jEe(t){return new Date(t)}function _Ee(t){return t instanceof Date?+t:+new Date(+t)}function kA(t,s,n,a,i,l,o,c,d,u){var h=mA(),f=h.invert,x=h.domain,b=u(".%L"),v=u(":%S"),w=u("%I:%M"),_=u("%I %p"),S=u("%a %d"),k=u("%b %d"),A=u("%B"),T=u("%Y");function P(O){return(d(O)<O?b:c(O)<O?v:o(O)<O?w:l(O)<O?_:a(O)<O?i(O)<O?S:k:n(O)<O?A:T)(O)}return h.invert=function(O){return new Date(f(O))},h.domain=function(O){return arguments.length?x(Array.from(O,_Ee)):x().map(jEe)},h.ticks=function(O){var D=x();return t(D[0],D[D.length-1],O??10)},h.tickFormat=function(O,D){return D==null?P:u(D)},h.nice=function(O){var D=x();return(!O||typeof O.range!="function")&&(O=s(D[0],D[D.length-1],O??10)),O?x(UW(D,O)):h},h.copy=function(){return a0(h,kA(t,s,n,a,i,l,o,c,d,u))},h}function SEe(){return Zi.apply(kA(vAe,NAe,Xo,SA,uN,i0,jA,NA,su,tq).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function CEe(){return Zi.apply(kA(yAe,bAe,Qo,CA,hN,dN,_A,wA,su,sq).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function mN(){var t=0,s=1,n,a,i,l,o=ha,c=!1,d;function u(f){return f==null||isNaN(f=+f)?d:o(i===0?.5:(f=(l(f)-n)*i,c?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([t,s]=f,n=l(t=+t),a=l(s=+s),i=n===a?0:1/(a-n),u):[t,s]},u.clamp=function(f){return arguments.length?(c=!!f,u):c},u.interpolator=function(f){return arguments.length?(o=f,u):o};function h(f){return function(x){var b,v;return arguments.length?([b,v]=x,o=f(b,v),u):[o(0),o(1)]}}return u.range=h(Xm),u.rangeRound=h(hA),u.unknown=function(f){return arguments.length?(d=f,u):d},function(f){return l=f,n=f(t),a=f(s),i=n===a?0:1/(a-n),u}}function Cd(t,s){return s.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function nq(){var t=Sd(mN()(ha));return t.copy=function(){return Cd(t,nq())},ac.apply(t,arguments)}function rq(){var t=xA(mN()).domain([1,10]);return t.copy=function(){return Cd(t,rq()).base(t.base())},ac.apply(t,arguments)}function aq(){var t=gA(mN());return t.copy=function(){return Cd(t,aq()).constant(t.constant())},ac.apply(t,arguments)}function AA(){var t=yA(mN());return t.copy=function(){return Cd(t,AA()).exponent(t.exponent())},ac.apply(t,arguments)}function kEe(){return AA.apply(null,arguments).exponent(.5)}function iq(){var t=[],s=ha;function n(a){if(a!=null&&!isNaN(a=+a))return s((n0(t,a,1)-1)/(t.length-1))}return n.domain=function(a){if(!arguments.length)return t.slice();t=[];for(let i of a)i!=null&&!isNaN(i=+i)&&t.push(i);return t.sort(td),n},n.interpolator=function(a){return arguments.length?(s=a,n):s},n.range=function(){return t.map((a,i)=>s(i/(t.length-1)))},n.quantiles=function(a){return Array.from({length:a+1},(i,l)=>h5e(t,l/a))},n.copy=function(){return iq(s).domain(t)},ac.apply(n,arguments)}function fN(){var t=0,s=.5,n=1,a=1,i,l,o,c,d,u=ha,h,f=!1,x;function b(w){return isNaN(w=+w)?x:(w=.5+((w=+h(w))-l)*(a*w<a*l?c:d),u(f?Math.max(0,Math.min(1,w)):w))}b.domain=function(w){return arguments.length?([t,s,n]=w,i=h(t=+t),l=h(s=+s),o=h(n=+n),c=i===l?0:.5/(l-i),d=l===o?0:.5/(o-l),a=l<i?-1:1,b):[t,s,n]},b.clamp=function(w){return arguments.length?(f=!!w,b):f},b.interpolator=function(w){return arguments.length?(u=w,b):u};function v(w){return function(_){var S,k,A;return arguments.length?([S,k,A]=_,u=F5e(w,[S,k,A]),b):[u(0),u(.5),u(1)]}}return b.range=v(Xm),b.rangeRound=v(hA),b.unknown=function(w){return arguments.length?(x=w,b):x},function(w){return h=w,i=w(t),l=w(s),o=w(n),c=i===l?0:.5/(l-i),d=l===o?0:.5/(o-l),a=l<i?-1:1,b}}function lq(){var t=Sd(fN()(ha));return t.copy=function(){return Cd(t,lq())},ac.apply(t,arguments)}function oq(){var t=xA(fN()).domain([.1,1,10]);return t.copy=function(){return Cd(t,oq()).base(t.base())},ac.apply(t,arguments)}function cq(){var t=gA(fN());return t.copy=function(){return Cd(t,cq()).constant(t.constant())},ac.apply(t,arguments)}function EA(){var t=yA(fN());return t.copy=function(){return Cd(t,EA()).exponent(t.exponent())},ac.apply(t,arguments)}function AEe(){return EA.apply(null,arguments).exponent(.5)}const tp=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:cA,scaleDiverging:lq,scaleDivergingLog:oq,scaleDivergingPow:EA,scaleDivergingSqrt:AEe,scaleDivergingSymlog:cq,scaleIdentity:zW,scaleImplicit:uC,scaleLinear:$W,scaleLog:VW,scaleOrdinal:oA,scalePoint:p5e,scalePow:bA,scaleQuantile:qW,scaleQuantize:GW,scaleRadial:WW,scaleSequential:nq,scaleSequentialLog:rq,scaleSequentialPow:AA,scaleSequentialQuantile:iq,scaleSequentialSqrt:kEe,scaleSequentialSymlog:aq,scaleSqrt:oAe,scaleSymlog:HW,scaleThreshold:KW,scaleTime:SEe,scaleUtc:CEe,tickFormat:FW},Symbol.toStringTag,{value:"Module"}));var kd=t=>t.chartData,TA=Pe([kd],t=>{var s=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:s,dataStartIndex:0}}),PA=(t,s,n,a)=>a?TA(t):kd(t);function Lu(t){if(Array.isArray(t)&&t.length===2){var[s,n]=t;if(Rn(s)&&Rn(n))return!0}return!1}function MO(t,s,n){return n?t:[Math.min(t[0],s[0]),Math.max(t[1],s[1])]}function dq(t,s){if(s&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[n,a]=t,i,l;if(Rn(n))i=n;else if(typeof n=="function")return;if(Rn(a))l=a;else if(typeof a=="function")return;var o=[i,l];if(Lu(o))return o}}function EEe(t,s,n){if(!(!n&&s==null)){if(typeof t=="function"&&s!=null)try{var a=t(s,n);if(Lu(a))return MO(a,s,n)}catch{}if(Array.isArray(t)&&t.length===2){var[i,l]=t,o,c;if(i==="auto")s!=null&&(o=Math.min(...s));else if(Dt(i))o=i;else if(typeof i=="function")try{s!=null&&(o=i(s==null?void 0:s[0]))}catch{}else if(typeof i=="string"&&wD.test(i)){var d=wD.exec(i);if(d==null||s==null)o=void 0;else{var u=+d[1];o=s[0]-u}}else o=s==null?void 0:s[0];if(l==="auto")s!=null&&(c=Math.max(...s));else if(Dt(l))c=l;else if(typeof l=="function")try{s!=null&&(c=l(s==null?void 0:s[1]))}catch{}else if(typeof l=="string"&&jD.test(l)){var h=jD.exec(l);if(h==null||s==null)c=void 0;else{var f=+h[1];c=s[1]+f}}else c=s==null?void 0:s[1];var x=[o,c];if(Lu(x))return s==null?x:MO(x,s,n)}}}var Qm=1e9,TEe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},MA,sn=!0,Ki="[DecimalError] ",gu=Ki+"Invalid argument: ",IA=Ki+"Exponent out of range: ",Zm=Math.floor,Vd=Math.pow,PEe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,li,xr=1e7,Ys=7,uq=9007199254740991,ib=Zm(uq/Ys),bt={};bt.absoluteValue=bt.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};bt.comparedTo=bt.cmp=function(t){var s,n,a,i,l=this;if(t=new l.constructor(t),l.s!==t.s)return l.s||-t.s;if(l.e!==t.e)return l.e>t.e^l.s<0?1:-1;for(a=l.d.length,i=t.d.length,s=0,n=a<i?a:i;s<n;++s)if(l.d[s]!==t.d[s])return l.d[s]>t.d[s]^l.s<0?1:-1;return a===i?0:a>i^l.s<0?1:-1};bt.decimalPlaces=bt.dp=function(){var t=this,s=t.d.length-1,n=(s-t.e)*Ys;if(s=t.d[s],s)for(;s%10==0;s/=10)n--;return n<0?0:n};bt.dividedBy=bt.div=function(t){return Lo(this,new this.constructor(t))};bt.dividedToIntegerBy=bt.idiv=function(t){var s=this,n=s.constructor;return Rs(Lo(s,new n(t),0,1),n.precision)};bt.equals=bt.eq=function(t){return!this.cmp(t)};bt.exponent=function(){return Yn(this)};bt.greaterThan=bt.gt=function(t){return this.cmp(t)>0};bt.greaterThanOrEqualTo=bt.gte=function(t){return this.cmp(t)>=0};bt.isInteger=bt.isint=function(){return this.e>this.d.length-2};bt.isNegative=bt.isneg=function(){return this.s<0};bt.isPositive=bt.ispos=function(){return this.s>0};bt.isZero=function(){return this.s===0};bt.lessThan=bt.lt=function(t){return this.cmp(t)<0};bt.lessThanOrEqualTo=bt.lte=function(t){return this.cmp(t)<1};bt.logarithm=bt.log=function(t){var s,n=this,a=n.constructor,i=a.precision,l=i+5;if(t===void 0)t=new a(10);else if(t=new a(t),t.s<1||t.eq(li))throw Error(Ki+"NaN");if(n.s<1)throw Error(Ki+(n.s?"NaN":"-Infinity"));return n.eq(li)?new a(0):(sn=!1,s=Lo(Cx(n,l),Cx(t,l),l),sn=!0,Rs(s,i))};bt.minus=bt.sub=function(t){var s=this;return t=new s.constructor(t),s.s==t.s?fq(s,t):hq(s,(t.s=-t.s,t))};bt.modulo=bt.mod=function(t){var s,n=this,a=n.constructor,i=a.precision;if(t=new a(t),!t.s)throw Error(Ki+"NaN");return n.s?(sn=!1,s=Lo(n,t,0,1).times(t),sn=!0,n.minus(s)):Rs(new a(n),i)};bt.naturalExponential=bt.exp=function(){return mq(this)};bt.naturalLogarithm=bt.ln=function(){return Cx(this)};bt.negated=bt.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};bt.plus=bt.add=function(t){var s=this;return t=new s.constructor(t),s.s==t.s?hq(s,t):fq(s,(t.s=-t.s,t))};bt.precision=bt.sd=function(t){var s,n,a,i=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(gu+t);if(s=Yn(i)+1,a=i.d.length-1,n=a*Ys+1,a=i.d[a],a){for(;a%10==0;a/=10)n--;for(a=i.d[0];a>=10;a/=10)n++}return t&&s>n?s:n};bt.squareRoot=bt.sqrt=function(){var t,s,n,a,i,l,o,c=this,d=c.constructor;if(c.s<1){if(!c.s)return new d(0);throw Error(Ki+"NaN")}for(t=Yn(c),sn=!1,i=Math.sqrt(+c),i==0||i==1/0?(s=Ql(c.d),(s.length+t)%2==0&&(s+="0"),i=Math.sqrt(s),t=Zm((t+1)/2)-(t<0||t%2),i==1/0?s="5e"+t:(s=i.toExponential(),s=s.slice(0,s.indexOf("e")+1)+t),a=new d(s)):a=new d(i.toString()),n=d.precision,i=o=n+3;;)if(l=a,a=l.plus(Lo(c,l,o+2)).times(.5),Ql(l.d).slice(0,o)===(s=Ql(a.d)).slice(0,o)){if(s=s.slice(o-3,o+1),i==o&&s=="4999"){if(Rs(l,n+1,0),l.times(l).eq(c)){a=l;break}}else if(s!="9999")break;o+=4}return sn=!0,Rs(a,n)};bt.times=bt.mul=function(t){var s,n,a,i,l,o,c,d,u,h=this,f=h.constructor,x=h.d,b=(t=new f(t)).d;if(!h.s||!t.s)return new f(0);for(t.s*=h.s,n=h.e+t.e,d=x.length,u=b.length,d<u&&(l=x,x=b,b=l,o=d,d=u,u=o),l=[],o=d+u,a=o;a--;)l.push(0);for(a=u;--a>=0;){for(s=0,i=d+a;i>a;)c=l[i]+b[a]*x[i-a-1]+s,l[i--]=c%xr|0,s=c/xr|0;l[i]=(l[i]+s)%xr|0}for(;!l[--o];)l.pop();return s?++n:l.shift(),t.d=l,t.e=n,sn?Rs(t,f.precision):t};bt.toDecimalPlaces=bt.todp=function(t,s){var n=this,a=n.constructor;return n=new a(n),t===void 0?n:(mo(t,0,Qm),s===void 0?s=a.rounding:mo(s,0,8),Rs(n,t+Yn(n)+1,s))};bt.toExponential=function(t,s){var n,a=this,i=a.constructor;return t===void 0?n=Bu(a,!0):(mo(t,0,Qm),s===void 0?s=i.rounding:mo(s,0,8),a=Rs(new i(a),t+1,s),n=Bu(a,!0,t+1)),n};bt.toFixed=function(t,s){var n,a,i=this,l=i.constructor;return t===void 0?Bu(i):(mo(t,0,Qm),s===void 0?s=l.rounding:mo(s,0,8),a=Rs(new l(i),t+Yn(i)+1,s),n=Bu(a.abs(),!1,t+Yn(a)+1),i.isneg()&&!i.isZero()?"-"+n:n)};bt.toInteger=bt.toint=function(){var t=this,s=t.constructor;return Rs(new s(t),Yn(t)+1,s.rounding)};bt.toNumber=function(){return+this};bt.toPower=bt.pow=function(t){var s,n,a,i,l,o,c=this,d=c.constructor,u=12,h=+(t=new d(t));if(!t.s)return new d(li);if(c=new d(c),!c.s){if(t.s<1)throw Error(Ki+"Infinity");return c}if(c.eq(li))return c;if(a=d.precision,t.eq(li))return Rs(c,a);if(s=t.e,n=t.d.length-1,o=s>=n,l=c.s,o){if((n=h<0?-h:h)<=uq){for(i=new d(li),s=Math.ceil(a/Ys+4),sn=!1;n%2&&(i=i.times(c),OO(i.d,s)),n=Zm(n/2),n!==0;)c=c.times(c),OO(c.d,s);return sn=!0,t.s<0?new d(li).div(i):Rs(i,a)}}else if(l<0)throw Error(Ki+"NaN");return l=l<0&&t.d[Math.max(s,n)]&1?-1:1,c.s=1,sn=!1,i=t.times(Cx(c,a+u)),sn=!0,i=mq(i),i.s=l,i};bt.toPrecision=function(t,s){var n,a,i=this,l=i.constructor;return t===void 0?(n=Yn(i),a=Bu(i,n<=l.toExpNeg||n>=l.toExpPos)):(mo(t,1,Qm),s===void 0?s=l.rounding:mo(s,0,8),i=Rs(new l(i),t,s),n=Yn(i),a=Bu(i,t<=n||n<=l.toExpNeg,t)),a};bt.toSignificantDigits=bt.tosd=function(t,s){var n=this,a=n.constructor;return t===void 0?(t=a.precision,s=a.rounding):(mo(t,1,Qm),s===void 0?s=a.rounding:mo(s,0,8)),Rs(new a(n),t,s)};bt.toString=bt.valueOf=bt.val=bt.toJSON=bt[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,s=Yn(t),n=t.constructor;return Bu(t,s<=n.toExpNeg||s>=n.toExpPos)};function hq(t,s){var n,a,i,l,o,c,d,u,h=t.constructor,f=h.precision;if(!t.s||!s.s)return s.s||(s=new h(t)),sn?Rs(s,f):s;if(d=t.d,u=s.d,o=t.e,i=s.e,d=d.slice(),l=o-i,l){for(l<0?(a=d,l=-l,c=u.length):(a=u,i=o,c=d.length),o=Math.ceil(f/Ys),c=o>c?o+1:c+1,l>c&&(l=c,a.length=1),a.reverse();l--;)a.push(0);a.reverse()}for(c=d.length,l=u.length,c-l<0&&(l=c,a=u,u=d,d=a),n=0;l;)n=(d[--l]=d[l]+u[l]+n)/xr|0,d[l]%=xr;for(n&&(d.unshift(n),++i),c=d.length;d[--c]==0;)d.pop();return s.d=d,s.e=i,sn?Rs(s,f):s}function mo(t,s,n){if(t!==~~t||t<s||t>n)throw Error(gu+t)}function Ql(t){var s,n,a,i=t.length-1,l="",o=t[0];if(i>0){for(l+=o,s=1;s<i;s++)a=t[s]+"",n=Ys-a.length,n&&(l+=Cc(n)),l+=a;o=t[s],a=o+"",n=Ys-a.length,n&&(l+=Cc(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return l+o}var Lo=function(){function t(a,i){var l,o=0,c=a.length;for(a=a.slice();c--;)l=a[c]*i+o,a[c]=l%xr|0,o=l/xr|0;return o&&a.unshift(o),a}function s(a,i,l,o){var c,d;if(l!=o)d=l>o?1:-1;else for(c=d=0;c<l;c++)if(a[c]!=i[c]){d=a[c]>i[c]?1:-1;break}return d}function n(a,i,l){for(var o=0;l--;)a[l]-=o,o=a[l]<i[l]?1:0,a[l]=o*xr+a[l]-i[l];for(;!a[0]&&a.length>1;)a.shift()}return function(a,i,l,o){var c,d,u,h,f,x,b,v,w,_,S,k,A,T,P,O,D,I,M=a.constructor,B=a.s==i.s?1:-1,L=a.d,F=i.d;if(!a.s)return new M(a);if(!i.s)throw Error(Ki+"Division by zero");for(d=a.e-i.e,D=F.length,P=L.length,b=new M(B),v=b.d=[],u=0;F[u]==(L[u]||0);)++u;if(F[u]>(L[u]||0)&&--d,l==null?k=l=M.precision:o?k=l+(Yn(a)-Yn(i))+1:k=l,k<0)return new M(0);if(k=k/Ys+2|0,u=0,D==1)for(h=0,F=F[0],k++;(u<P||h)&&k--;u++)A=h*xr+(L[u]||0),v[u]=A/F|0,h=A%F|0;else{for(h=xr/(F[0]+1)|0,h>1&&(F=t(F,h),L=t(L,h),D=F.length,P=L.length),T=D,w=L.slice(0,D),_=w.length;_<D;)w[_++]=0;I=F.slice(),I.unshift(0),O=F[0],F[1]>=xr/2&&++O;do h=0,c=s(F,w,D,_),c<0?(S=w[0],D!=_&&(S=S*xr+(w[1]||0)),h=S/O|0,h>1?(h>=xr&&(h=xr-1),f=t(F,h),x=f.length,_=w.length,c=s(f,w,x,_),c==1&&(h--,n(f,D<x?I:F,x))):(h==0&&(c=h=1),f=F.slice()),x=f.length,x<_&&f.unshift(0),n(w,f,_),c==-1&&(_=w.length,c=s(F,w,D,_),c<1&&(h++,n(w,D<_?I:F,_))),_=w.length):c===0&&(h++,w=[0]),v[u++]=h,c&&w[0]?w[_++]=L[T]||0:(w=[L[T]],_=1);while((T++<P||w[0]!==void 0)&&k--)}return v[0]||v.shift(),b.e=d,Rs(b,o?l+Yn(b)+1:l)}}();function mq(t,s){var n,a,i,l,o,c,d=0,u=0,h=t.constructor,f=h.precision;if(Yn(t)>16)throw Error(IA+Yn(t));if(!t.s)return new h(li);for(sn=!1,c=f,o=new h(.03125);t.abs().gte(.1);)t=t.times(o),u+=5;for(a=Math.log(Vd(2,u))/Math.LN10*2+5|0,c+=a,n=i=l=new h(li),h.precision=c;;){if(i=Rs(i.times(t),c),n=n.times(++d),o=l.plus(Lo(i,n,c)),Ql(o.d).slice(0,c)===Ql(l.d).slice(0,c)){for(;u--;)l=Rs(l.times(l),c);return h.precision=f,s==null?(sn=!0,Rs(l,f)):l}l=o}}function Yn(t){for(var s=t.e*Ys,n=t.d[0];n>=10;n/=10)s++;return s}function Qj(t,s,n){if(s>t.LN10.sd())throw sn=!0,n&&(t.precision=n),Error(Ki+"LN10 precision limit exceeded");return Rs(new t(t.LN10),s)}function Cc(t){for(var s="";t--;)s+="0";return s}function Cx(t,s){var n,a,i,l,o,c,d,u,h,f=1,x=10,b=t,v=b.d,w=b.constructor,_=w.precision;if(b.s<1)throw Error(Ki+(b.s?"NaN":"-Infinity"));if(b.eq(li))return new w(0);if(s==null?(sn=!1,u=_):u=s,b.eq(10))return s==null&&(sn=!0),Qj(w,u);if(u+=x,w.precision=u,n=Ql(v),a=n.charAt(0),l=Yn(b),Math.abs(l)<15e14){for(;a<7&&a!=1||a==1&&n.charAt(1)>3;)b=b.times(t),n=Ql(b.d),a=n.charAt(0),f++;l=Yn(b),a>1?(b=new w("0."+n),l++):b=new w(a+"."+n.slice(1))}else return d=Qj(w,u+2,_).times(l+""),b=Cx(new w(a+"."+n.slice(1)),u-x).plus(d),w.precision=_,s==null?(sn=!0,Rs(b,_)):b;for(c=o=b=Lo(b.minus(li),b.plus(li),u),h=Rs(b.times(b),u),i=3;;){if(o=Rs(o.times(h),u),d=c.plus(Lo(o,new w(i),u)),Ql(d.d).slice(0,u)===Ql(c.d).slice(0,u))return c=c.times(2),l!==0&&(c=c.plus(Qj(w,u+2,_).times(l+""))),c=Lo(c,new w(f),u),w.precision=_,s==null?(sn=!0,Rs(c,_)):c;c=d,i+=2}}function DO(t,s){var n,a,i;for((n=s.indexOf("."))>-1&&(s=s.replace(".","")),(a=s.search(/e/i))>0?(n<0&&(n=a),n+=+s.slice(a+1),s=s.substring(0,a)):n<0&&(n=s.length),a=0;s.charCodeAt(a)===48;)++a;for(i=s.length;s.charCodeAt(i-1)===48;)--i;if(s=s.slice(a,i),s){if(i-=a,n=n-a-1,t.e=Zm(n/Ys),t.d=[],a=(n+1)%Ys,n<0&&(a+=Ys),a<i){for(a&&t.d.push(+s.slice(0,a)),i-=Ys;a<i;)t.d.push(+s.slice(a,a+=Ys));s=s.slice(a),a=Ys-s.length}else a-=i;for(;a--;)s+="0";if(t.d.push(+s),sn&&(t.e>ib||t.e<-ib))throw Error(IA+n)}else t.s=0,t.e=0,t.d=[0];return t}function Rs(t,s,n){var a,i,l,o,c,d,u,h,f=t.d;for(o=1,l=f[0];l>=10;l/=10)o++;if(a=s-o,a<0)a+=Ys,i=s,u=f[h=0];else{if(h=Math.ceil((a+1)/Ys),l=f.length,h>=l)return t;for(u=l=f[h],o=1;l>=10;l/=10)o++;a%=Ys,i=a-Ys+o}if(n!==void 0&&(l=Vd(10,o-i-1),c=u/l%10|0,d=s<0||f[h+1]!==void 0||u%l,d=n<4?(c||d)&&(n==0||n==(t.s<0?3:2)):c>5||c==5&&(n==4||d||n==6&&(a>0?i>0?u/Vd(10,o-i):0:f[h-1])%10&1||n==(t.s<0?8:7))),s<1||!f[0])return d?(l=Yn(t),f.length=1,s=s-l-1,f[0]=Vd(10,(Ys-s%Ys)%Ys),t.e=Zm(-s/Ys)||0):(f.length=1,f[0]=t.e=t.s=0),t;if(a==0?(f.length=h,l=1,h--):(f.length=h+1,l=Vd(10,Ys-a),f[h]=i>0?(u/Vd(10,o-i)%Vd(10,i)|0)*l:0),d)for(;;)if(h==0){(f[0]+=l)==xr&&(f[0]=1,++t.e);break}else{if(f[h]+=l,f[h]!=xr)break;f[h--]=0,l=1}for(a=f.length;f[--a]===0;)f.pop();if(sn&&(t.e>ib||t.e<-ib))throw Error(IA+Yn(t));return t}function fq(t,s){var n,a,i,l,o,c,d,u,h,f,x=t.constructor,b=x.precision;if(!t.s||!s.s)return s.s?s.s=-s.s:s=new x(t),sn?Rs(s,b):s;if(d=t.d,f=s.d,a=s.e,u=t.e,d=d.slice(),o=u-a,o){for(h=o<0,h?(n=d,o=-o,c=f.length):(n=f,a=u,c=d.length),i=Math.max(Math.ceil(b/Ys),c)+2,o>i&&(o=i,n.length=1),n.reverse(),i=o;i--;)n.push(0);n.reverse()}else{for(i=d.length,c=f.length,h=i<c,h&&(c=i),i=0;i<c;i++)if(d[i]!=f[i]){h=d[i]<f[i];break}o=0}for(h&&(n=d,d=f,f=n,s.s=-s.s),c=d.length,i=f.length-c;i>0;--i)d[c++]=0;for(i=f.length;i>o;){if(d[--i]<f[i]){for(l=i;l&&d[--l]===0;)d[l]=xr-1;--d[l],d[i]+=xr}d[i]-=f[i]}for(;d[--c]===0;)d.pop();for(;d[0]===0;d.shift())--a;return d[0]?(s.d=d,s.e=a,sn?Rs(s,b):s):new x(0)}function Bu(t,s,n){var a,i=Yn(t),l=Ql(t.d),o=l.length;return s?(n&&(a=n-o)>0?l=l.charAt(0)+"."+l.slice(1)+Cc(a):o>1&&(l=l.charAt(0)+"."+l.slice(1)),l=l+(i<0?"e":"e+")+i):i<0?(l="0."+Cc(-i-1)+l,n&&(a=n-o)>0&&(l+=Cc(a))):i>=o?(l+=Cc(i+1-o),n&&(a=n-i-1)>0&&(l=l+"."+Cc(a))):((a=i+1)<o&&(l=l.slice(0,a)+"."+l.slice(a)),n&&(a=n-o)>0&&(i+1===o&&(l+="."),l+=Cc(a))),t.s<0?"-"+l:l}function OO(t,s){if(t.length>s)return t.length=s,!0}function pq(t){var s,n,a;function i(l){var o=this;if(!(o instanceof i))return new i(l);if(o.constructor=i,l instanceof i){o.s=l.s,o.e=l.e,o.d=(l=l.d)?l.slice():l;return}if(typeof l=="number"){if(l*0!==0)throw Error(gu+l);if(l>0)o.s=1;else if(l<0)l=-l,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(l===~~l&&l<1e7){o.e=0,o.d=[l];return}return DO(o,l.toString())}else if(typeof l!="string")throw Error(gu+l);if(l.charCodeAt(0)===45?(l=l.slice(1),o.s=-1):o.s=1,PEe.test(l))DO(o,l);else throw Error(gu+l)}if(i.prototype=bt,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=pq,i.config=i.set=IEe,t===void 0&&(t={}),t)for(a=["precision","rounding","toExpNeg","toExpPos","LN10"],s=0;s<a.length;)t.hasOwnProperty(n=a[s++])||(t[n]=this[n]);return i.config(t),i}function IEe(t){if(!t||typeof t!="object")throw Error(Ki+"Object expected");var s,n,a,i=["precision",1,Qm,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(s=0;s<i.length;s+=3)if((a=t[n=i[s]])!==void 0)if(Zm(a)===a&&a>=i[s+1]&&a<=i[s+2])this[n]=a;else throw Error(gu+n+": "+a);if((a=t[n="LN10"])!==void 0)if(a==Math.LN10)this[n]=new this(a);else throw Error(gu+n+": "+a);return this}var MA=pq(TEe);li=new MA(1);const _s=MA;var MEe=t=>t,xq={},gq=t=>t===xq,RO=t=>function s(){return arguments.length===0||arguments.length===1&&gq(arguments.length<=0?void 0:arguments[0])?s:t(...arguments)},yq=(t,s)=>t===1?s:RO(function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var l=a.filter(o=>o!==xq).length;return l>=t?s(...a):yq(t-l,RO(function(){for(var o=arguments.length,c=new Array(o),d=0;d<o;d++)c[d]=arguments[d];var u=a.map(h=>gq(h)?c.shift():h);return s(...u,...c)}))}),pN=t=>yq(t.length,t),pC=(t,s)=>{for(var n=[],a=t;a<s;++a)n[a-t]=a;return n},DEe=pN((t,s)=>Array.isArray(s)?s.map(t):Object.keys(s).map(n=>s[n]).map(t)),OEe=function(){for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];if(!n.length)return MEe;var i=n.reverse(),l=i[0],o=i.slice(1);return function(){return o.reduce((c,d)=>d(c),l(...arguments))}},xC=t=>Array.isArray(t)?t.reverse():t.split("").reverse().join(""),bq=t=>{var s=null,n=null;return function(){for(var a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return s&&i.every((o,c)=>{var d;return o===((d=s)===null||d===void 0?void 0:d[c])})||(s=i,n=t(...i)),n}};function vq(t){var s;return t===0?s=1:s=Math.floor(new _s(t).abs().log(10).toNumber())+1,s}function Nq(t,s,n){for(var a=new _s(t),i=0,l=[];a.lt(s)&&i<1e5;)l.push(a.toNumber()),a=a.add(n),i++;return l}pN((t,s,n)=>{var a=+t,i=+s;return a+n*(i-a)});pN((t,s,n)=>{var a=s-+t;return a=a||1/0,(n-t)/a});pN((t,s,n)=>{var a=s-+t;return a=a||1/0,Math.max(0,Math.min(1,(n-t)/a))});var wq=t=>{var[s,n]=t,[a,i]=[s,n];return s>n&&([a,i]=[n,s]),[a,i]},jq=(t,s,n)=>{if(t.lte(0))return new _s(0);var a=vq(t.toNumber()),i=new _s(10).pow(a),l=t.div(i),o=a!==1?.05:.1,c=new _s(Math.ceil(l.div(o).toNumber())).add(n).mul(o),d=c.mul(i);return s?new _s(d.toNumber()):new _s(Math.ceil(d.toNumber()))},REe=(t,s,n)=>{var a=new _s(1),i=new _s(t);if(!i.isint()&&n){var l=Math.abs(t);l<1?(a=new _s(10).pow(vq(t)-1),i=new _s(Math.floor(i.div(a).toNumber())).mul(a)):l>1&&(i=new _s(Math.floor(t)))}else t===0?i=new _s(Math.floor((s-1)/2)):n||(i=new _s(Math.floor(t)));var o=Math.floor((s-1)/2),c=OEe(DEe(d=>i.add(new _s(d-o).mul(a)).toNumber()),pC);return c(0,s)},_q=function(s,n,a,i){var l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((n-s)/(a-1)))return{step:new _s(0),tickMin:new _s(0),tickMax:new _s(0)};var o=jq(new _s(n).sub(s).div(a-1),i,l),c;s<=0&&n>=0?c=new _s(0):(c=new _s(s).add(n).div(2),c=c.sub(new _s(c).mod(o)));var d=Math.ceil(c.sub(s).div(o).toNumber()),u=Math.ceil(new _s(n).sub(c).div(o).toNumber()),h=d+u+1;return h>a?_q(s,n,a,i,l+1):(h<a&&(u=n>0?u+(a-h):u,d=n>0?d:d+(a-h)),{step:o,tickMin:c.sub(new _s(d).mul(o)),tickMax:c.add(new _s(u).mul(o))})};function LEe(t){var[s,n]=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=Math.max(a,2),[o,c]=wq([s,n]);if(o===-1/0||c===1/0){var d=c===1/0?[o,...pC(0,a-1).map(()=>1/0)]:[...pC(0,a-1).map(()=>-1/0),c];return s>n?xC(d):d}if(o===c)return REe(o,a,i);var{step:u,tickMin:h,tickMax:f}=_q(o,c,l,i,0),x=Nq(h,f.add(new _s(.1).mul(u)),u);return s>n?xC(x):x}function BEe(t,s){var[n,a]=t,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[l,o]=wq([n,a]);if(l===-1/0||o===1/0)return[n,a];if(l===o)return[l];var c=Math.max(s,2),d=jq(new _s(o).sub(l).div(c-1),i,0),u=[...Nq(new _s(l),new _s(o),d),o];return i===!1&&(u=u.map(h=>Math.round(h))),n>a?xC(u):u}var FEe=bq(LEe),$Ee=bq(BEe),Sq=t=>t.rootProps.maxBarSize,zEe=t=>t.rootProps.barGap,Cq=t=>t.rootProps.barCategoryGap,UEe=t=>t.rootProps.barSize,l0=t=>t.rootProps.stackOffset,DA=t=>t.options.chartName,OA=t=>t.rootProps.syncId,kq=t=>t.rootProps.syncMethod,RA=t=>t.options.eventEmitter,Xr={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Ao={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},ni={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},xN=(t,s)=>{if(!(!t||!s))return t!=null&&t.reversed?[s[1],s[0]]:s},VEe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Ao.angleAxisId,includeHidden:!1,name:void 0,reversed:Ao.reversed,scale:Ao.scale,tick:Ao.tick,tickCount:void 0,ticks:void 0,type:Ao.type,unit:void 0},HEe={allowDataOverflow:ni.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:ni.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ni.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ni.scale,tick:ni.tick,tickCount:ni.tickCount,ticks:void 0,type:ni.type,unit:void 0},WEe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Ao.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Ao.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Ao.scale,tick:Ao.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},qEe={allowDataOverflow:ni.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:ni.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ni.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ni.scale,tick:ni.tick,tickCount:ni.tickCount,ticks:void 0,type:"category",unit:void 0},LA=(t,s)=>t.polarAxis.angleAxis[s]!=null?t.polarAxis.angleAxis[s]:t.layout.layoutType==="radial"?WEe:VEe,BA=(t,s)=>t.polarAxis.radiusAxis[s]!=null?t.polarAxis.radiusAxis[s]:t.layout.layoutType==="radial"?qEe:HEe,gN=t=>t.polarOptions,FA=Pe([nc,rc,hr],wW),Aq=Pe([gN,FA],(t,s)=>{if(t!=null)return Qr(t.innerRadius,s,0)}),Eq=Pe([gN,FA],(t,s)=>{if(t!=null)return Qr(t.outerRadius,s,s*.8)}),GEe=t=>{if(t==null)return[0,0];var{startAngle:s,endAngle:n}=t;return[s,n]},Tq=Pe([gN],GEe);Pe([LA,Tq],xN);var Pq=Pe([FA,Aq,Eq],(t,s,n)=>{if(!(t==null||s==null||n==null))return[s,n]});Pe([BA,Pq],xN);var Iq=Pe([gs,gN,Aq,Eq,nc,rc],(t,s,n,a,i,l)=>{if(!(t!=="centric"&&t!=="radial"||s==null||n==null||a==null)){var{cx:o,cy:c,startAngle:d,endAngle:u}=s;return{cx:Qr(o,i,i/2),cy:Qr(c,l,l/2),innerRadius:n,outerRadius:a,startAngle:d,endAngle:u,clockWise:!1}}}),ln=(t,s)=>s,o0=(t,s,n)=>n;function $A(t){return t==null?void 0:t.id}function Mq(t,s,n){var{chartData:a=[]}=s,{allowDuplicatedCategory:i,dataKey:l}=n,o=new Map;return t.forEach(c=>{var d,u=(d=c.data)!==null&&d!==void 0?d:a;if(!(u==null||u.length===0)){var h=$A(c);u.forEach((f,x)=>{var b=l==null||i?x:String(mn(f,l,null)),v=mn(f,c.dataKey,0),w;o.has(b)?w=o.get(b):w={},Object.assign(w,{[h]:v}),o.set(b,w)})}}),Array.from(o.values())}function yN(t){return t.stackId!=null&&t.dataKey!=null}var bN=(t,s)=>t===s?!0:t==null||s==null?!1:t[0]===s[0]&&t[1]===s[1];function vN(t,s){return Array.isArray(t)&&Array.isArray(s)&&t.length===0&&s.length===0?!0:t===s}function KEe(t,s){if(t.length===s.length){for(var n=0;n<t.length;n++)if(t[n]!==s[n])return!1;return!0}return!1}var fr=t=>{var s=gs(t);return s==="horizontal"?"xAxis":s==="vertical"?"yAxis":s==="centric"?"angleAxis":"radiusAxis"},Jm=t=>t.tooltip.settings.axisId;function LO(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function lb(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?LO(Object(n),!0).forEach(function(a){YEe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):LO(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function YEe(t,s,n){return(s=XEe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function XEe(t){var s=QEe(t,"string");return typeof s=="symbol"?s:s+""}function QEe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var gC=[0,"auto"],Za={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},Dq=(t,s)=>t.cartesianAxis.xAxis[s],ic=(t,s)=>{var n=Dq(t,s);return n??Za},Ja={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:gC,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:s0},Oq=(t,s)=>t.cartesianAxis.yAxis[s],lc=(t,s)=>{var n=Oq(t,s);return n??Ja},ZEe={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},zA=(t,s)=>{var n=t.cartesianAxis.zAxis[s];return n??ZEe},gn=(t,s,n)=>{switch(s){case"xAxis":return ic(t,n);case"yAxis":return lc(t,n);case"zAxis":return zA(t,n);case"angleAxis":return LA(t,n);case"radiusAxis":return BA(t,n);default:throw new Error("Unexpected axis type: ".concat(s))}},JEe=(t,s,n)=>{switch(s){case"xAxis":return ic(t,n);case"yAxis":return lc(t,n);default:throw new Error("Unexpected axis type: ".concat(s))}},c0=(t,s,n)=>{switch(s){case"xAxis":return ic(t,n);case"yAxis":return lc(t,n);case"angleAxis":return LA(t,n);case"radiusAxis":return BA(t,n);default:throw new Error("Unexpected axis type: ".concat(s))}},Rq=t=>t.graphicalItems.cartesianItems.some(s=>s.type==="bar")||t.graphicalItems.polarItems.some(s=>s.type==="radialBar");function UA(t,s){return n=>{switch(t){case"xAxis":return"xAxisId"in n&&n.xAxisId===s;case"yAxis":return"yAxisId"in n&&n.yAxisId===s;case"zAxis":return"zAxisId"in n&&n.zAxisId===s;case"angleAxis":return"angleAxisId"in n&&n.angleAxisId===s;case"radiusAxis":return"radiusAxisId"in n&&n.radiusAxisId===s;default:return!1}}}var VA=t=>t.graphicalItems.cartesianItems,eTe=Pe([ln,o0],UA),HA=(t,s,n)=>t.filter(n).filter(a=>(s==null?void 0:s.includeHidden)===!0?!0:!a.hide),d0=Pe([VA,gn,eTe],HA,{memoizeOptions:{resultEqualityCheck:vN}}),Lq=Pe([d0],t=>t.filter(s=>s.type==="area"||s.type==="bar").filter(yN)),Bq=t=>t.filter(s=>!("stackId"in s)||s.stackId===void 0),tTe=Pe([d0],Bq),WA=t=>t.map(s=>s.data).filter(Boolean).flat(1),sTe=Pe([d0],WA,{memoizeOptions:{resultEqualityCheck:vN}}),qA=(t,s)=>{var{chartData:n=[],dataStartIndex:a,dataEndIndex:i}=s;return t.length>0?t:n.slice(a,i+1)},GA=Pe([sTe,PA],qA),KA=(t,s,n)=>(s==null?void 0:s.dataKey)!=null?t.map(a=>({value:mn(a,s.dataKey)})):n.length>0?n.map(a=>a.dataKey).flatMap(a=>t.map(i=>({value:mn(i,a)}))):t.map(a=>({value:a})),NN=Pe([GA,gn,d0],KA);function Fq(t,s){switch(t){case"xAxis":return s.direction==="x";case"yAxis":return s.direction==="y";default:return!1}}function jy(t){if(ho(t)||t instanceof Date){var s=Number(t);if(Rn(s))return s}}function BO(t){if(Array.isArray(t)){var s=[jy(t[0]),jy(t[1])];return Lu(s)?s:void 0}var n=jy(t);if(n!=null)return[n,n]}function Zo(t){return t.map(jy).filter(mSe)}function nTe(t,s,n){return!n||typeof s!="number"||uo(s)?[]:n.length?Zo(n.flatMap(a=>{var i=mn(t,a.dataKey),l,o;if(Array.isArray(i)?[l,o]=i:l=o=i,!(!Rn(l)||!Rn(o)))return[s-l,s+o]})):[]}var pr=t=>{var s=fr(t),n=Jm(t);return c0(t,s,n)},$q=Pe([pr],t=>t==null?void 0:t.dataKey),rTe=Pe([Lq,PA,pr],Mq),zq=(t,s,n)=>{var a={},i=s.reduce((l,o)=>(o.stackId==null||(l[o.stackId]==null&&(l[o.stackId]=[]),l[o.stackId].push(o)),l),a);return Object.fromEntries(Object.entries(i).map(l=>{var[o,c]=l,d=c.map($A);return[o,{stackedData:e3e(t,d,n),graphicalItems:c}]}))},yC=Pe([rTe,Lq,l0],zq),Uq=(t,s,n,a)=>{var{dataStartIndex:i,dataEndIndex:l}=s;if(a==null&&n!=="zAxis"){var o=a3e(t,i,l);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},aTe=Pe([gn],t=>t.allowDataOverflow),YA=t=>{var s;if(t==null||!("domain"in t))return gC;if(t.domain!=null)return t.domain;if(t.ticks!=null){if(t.type==="number"){var n=Zo(t.ticks);return[Math.min(...n),Math.max(...n)]}if(t.type==="category")return t.ticks.map(String)}return(s=t==null?void 0:t.domain)!==null&&s!==void 0?s:gC},XA=Pe([gn],YA),QA=Pe([XA,aTe],dq),iTe=Pe([yC,kd,ln,QA],Uq,{memoizeOptions:{resultEqualityCheck:bN}}),wN=t=>t.errorBars,lTe=(t,s,n)=>t.flatMap(a=>s[a.id]).filter(Boolean).filter(a=>Fq(n,a)),ob=function(){for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];var i=n.filter(Boolean);if(i.length!==0){var l=i.flat(),o=Math.min(...l),c=Math.max(...l);return[o,c]}},ZA=(t,s,n,a,i)=>{var l,o;if(n.length>0&&t.forEach(c=>{n.forEach(d=>{var u,h,f=(u=a[d.id])===null||u===void 0?void 0:u.filter(S=>Fq(i,S)),x=mn(c,(h=s.dataKey)!==null&&h!==void 0?h:d.dataKey),b=nTe(c,x,f);if(b.length>=2){var v=Math.min(...b),w=Math.max(...b);(l==null||v<l)&&(l=v),(o==null||w>o)&&(o=w)}var _=BO(x);_!=null&&(l=l==null?_[0]:Math.min(l,_[0]),o=o==null?_[1]:Math.max(o,_[1]))})}),(s==null?void 0:s.dataKey)!=null&&t.forEach(c=>{var d=BO(mn(c,s.dataKey));d!=null&&(l=l==null?d[0]:Math.min(l,d[0]),o=o==null?d[1]:Math.max(o,d[1]))}),Rn(l)&&Rn(o))return[l,o]},oTe=Pe([GA,gn,tTe,wN,ln],ZA,{memoizeOptions:{resultEqualityCheck:bN}});function cTe(t){var{value:s}=t;if(ho(s)||s instanceof Date)return s}var dTe=(t,s,n)=>{var a=t.map(cTe).filter(i=>i!=null);return n&&(s.dataKey==null||s.allowDuplicatedCategory&&sH(a))?EW(0,t.length):s.allowDuplicatedCategory?a:Array.from(new Set(a))},Vq=t=>t.referenceElements.dots,ef=(t,s,n)=>t.filter(a=>a.ifOverflow==="extendDomain").filter(a=>s==="xAxis"?a.xAxisId===n:a.yAxisId===n),uTe=Pe([Vq,ln,o0],ef),Hq=t=>t.referenceElements.areas,hTe=Pe([Hq,ln,o0],ef),Wq=t=>t.referenceElements.lines,mTe=Pe([Wq,ln,o0],ef),qq=(t,s)=>{var n=Zo(t.map(a=>s==="xAxis"?a.x:a.y));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},fTe=Pe(uTe,ln,qq),Gq=(t,s)=>{var n=Zo(t.flatMap(a=>[s==="xAxis"?a.x1:a.y1,s==="xAxis"?a.x2:a.y2]));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},pTe=Pe([hTe,ln],Gq);function xTe(t){var s;if(t.x!=null)return Zo([t.x]);var n=(s=t.segment)===null||s===void 0?void 0:s.map(a=>a.x);return n==null||n.length===0?[]:Zo(n)}function gTe(t){var s;if(t.y!=null)return Zo([t.y]);var n=(s=t.segment)===null||s===void 0?void 0:s.map(a=>a.y);return n==null||n.length===0?[]:Zo(n)}var Kq=(t,s)=>{var n=t.flatMap(a=>s==="xAxis"?xTe(a):gTe(a));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},yTe=Pe([mTe,ln],Kq),bTe=Pe(fTe,yTe,pTe,(t,s,n)=>ob(t,n,s)),JA=(t,s,n,a,i,l,o,c)=>{if(n!=null)return n;var d=o==="vertical"&&c==="xAxis"||o==="horizontal"&&c==="yAxis",u=d?ob(a,l,i):ob(l,i);return EEe(s,u,t.allowDataOverflow)},vTe=Pe([gn,XA,QA,iTe,oTe,bTe,gs,ln],JA,{memoizeOptions:{resultEqualityCheck:bN}}),NTe=[0,1],eE=(t,s,n,a,i,l,o)=>{if(!((t==null||n==null||n.length===0)&&o===void 0)){var{dataKey:c,type:d}=t,u=Xu(s,l);if(u&&c==null){var h;return EW(0,(h=n==null?void 0:n.length)!==null&&h!==void 0?h:0)}return d==="category"?dTe(a,t,u):i==="expand"?NTe:o}},tE=Pe([gn,gs,GA,NN,l0,ln,vTe],eE),Yq=(t,s,n,a,i)=>{if(t!=null){var{scale:l,type:o}=t;if(l==="auto")return s==="radial"&&i==="radiusAxis"?"band":s==="radial"&&i==="angleAxis"?"linear":o==="category"&&a&&(a.indexOf("LineChart")>=0||a.indexOf("AreaChart")>=0||a.indexOf("ComposedChart")>=0&&!n)?"point":o==="category"?"band":"linear";if(typeof l=="string"){var c="scale".concat(Jx(l));return c in tp?c:"point"}}},tf=Pe([gn,gs,Rq,DA,ln],Yq);function wTe(t){if(t!=null){if(t in tp)return tp[t]();var s="scale".concat(Jx(t));if(s in tp)return tp[s]()}}function sE(t,s,n,a){if(!(n==null||a==null)){if(typeof t.scale=="function")return t.scale.copy().domain(n).range(a);var i=wTe(s);if(i!=null){var l=i.domain(n).range(a);return YCe(l),l}}}var nE=(t,s,n)=>{var a=YA(s);if(!(n!=="auto"&&n!=="linear")){if(s!=null&&s.tickCount&&Array.isArray(a)&&(a[0]==="auto"||a[1]==="auto")&&Lu(t))return FEe(t,s.tickCount,s.allowDecimals);if(s!=null&&s.tickCount&&s.type==="number"&&Lu(t))return $Ee(t,s.tickCount,s.allowDecimals)}},rE=Pe([tE,c0,tf],nE),aE=(t,s,n,a)=>{if(a!=="angleAxis"&&(t==null?void 0:t.type)==="number"&&Lu(s)&&Array.isArray(n)&&n.length>0){var i=s[0],l=n[0],o=s[1],c=n[n.length-1];return[Math.min(i,l),Math.max(o,c)]}return s},jTe=Pe([gn,tE,rE,ln],aE),_Te=Pe(NN,gn,(t,s)=>{if(!(!s||s.type!=="number")){var n=1/0,a=Array.from(Zo(t.map(c=>c.value))).sort((c,d)=>c-d);if(a.length<2)return 1/0;var i=a[a.length-1]-a[0];if(i===0)return 1/0;for(var l=0;l<a.length-1;l++){var o=a[l+1]-a[l];n=Math.min(n,o)}return n/i}}),Xq=Pe(_Te,gs,Cq,hr,(t,s,n,a)=>a,(t,s,n,a,i)=>{if(!Rn(t))return 0;var l=s==="vertical"?a.height:a.width;if(i==="gap")return t*l/2;if(i==="no-gap"){var o=Qr(n,t*l),c=t*l/2;return c-o-(c-o)/l*o}return 0}),STe=(t,s)=>{var n=ic(t,s);return n==null||typeof n.padding!="string"?0:Xq(t,"xAxis",s,n.padding)},CTe=(t,s)=>{var n=lc(t,s);return n==null||typeof n.padding!="string"?0:Xq(t,"yAxis",s,n.padding)},kTe=Pe(ic,STe,(t,s)=>{var n,a;if(t==null)return{left:0,right:0};var{padding:i}=t;return typeof i=="string"?{left:s,right:s}:{left:((n=i.left)!==null&&n!==void 0?n:0)+s,right:((a=i.right)!==null&&a!==void 0?a:0)+s}}),ATe=Pe(lc,CTe,(t,s)=>{var n,a;if(t==null)return{top:0,bottom:0};var{padding:i}=t;return typeof i=="string"?{top:s,bottom:s}:{top:((n=i.top)!==null&&n!==void 0?n:0)+s,bottom:((a=i.bottom)!==null&&a!==void 0?a:0)+s}}),ETe=Pe([hr,kTe,nN,sN,(t,s,n)=>n],(t,s,n,a,i)=>{var{padding:l}=a;return i?[l.left,n.width-l.right]:[t.left+s.left,t.left+t.width-s.right]}),TTe=Pe([hr,gs,ATe,nN,sN,(t,s,n)=>n],(t,s,n,a,i,l)=>{var{padding:o}=i;return l?[a.height-o.bottom,o.top]:s==="horizontal"?[t.top+t.height-n.bottom,t.top+n.top]:[t.top+n.top,t.top+t.height-n.bottom]}),u0=(t,s,n,a)=>{var i;switch(s){case"xAxis":return ETe(t,n,a);case"yAxis":return TTe(t,n,a);case"zAxis":return(i=zA(t,n))===null||i===void 0?void 0:i.range;case"angleAxis":return Tq(t);case"radiusAxis":return Pq(t,n);default:return}},Qq=Pe([gn,u0],xN),sf=Pe([gn,tf,jTe,Qq],sE);Pe([d0,wN,ln],lTe);function Zq(t,s){return t.id<s.id?-1:t.id>s.id?1:0}var jN=(t,s)=>s,_N=(t,s,n)=>n,PTe=Pe(eN,jN,_N,(t,s,n)=>t.filter(a=>a.orientation===s).filter(a=>a.mirror===n).sort(Zq)),ITe=Pe(tN,jN,_N,(t,s,n)=>t.filter(a=>a.orientation===s).filter(a=>a.mirror===n).sort(Zq)),Jq=(t,s)=>({width:t.width,height:s.height}),MTe=(t,s)=>{var n=typeof s.width=="number"?s.width:s0;return{width:n,height:t.height}},eG=Pe(hr,ic,Jq),DTe=(t,s,n)=>{switch(s){case"top":return t.top;case"bottom":return n-t.bottom;default:return 0}},OTe=(t,s,n)=>{switch(s){case"left":return t.left;case"right":return n-t.right;default:return 0}},RTe=Pe(rc,hr,PTe,jN,_N,(t,s,n,a,i)=>{var l={},o;return n.forEach(c=>{var d=Jq(s,c);o==null&&(o=DTe(s,a,t));var u=a==="top"&&!i||a==="bottom"&&i;l[c.id]=o-Number(u)*d.height,o+=(u?-1:1)*d.height}),l}),LTe=Pe(nc,hr,ITe,jN,_N,(t,s,n,a,i)=>{var l={},o;return n.forEach(c=>{var d=MTe(s,c);o==null&&(o=OTe(s,a,t));var u=a==="left"&&!i||a==="right"&&i;l[c.id]=o-Number(u)*d.width,o+=(u?-1:1)*d.width}),l}),BTe=(t,s)=>{var n=ic(t,s);if(n!=null)return RTe(t,n.orientation,n.mirror)},FTe=Pe([hr,ic,BTe,(t,s)=>s],(t,s,n,a)=>{if(s!=null){var i=n==null?void 0:n[a];return i==null?{x:t.left,y:0}:{x:t.left,y:i}}}),$Te=(t,s)=>{var n=lc(t,s);if(n!=null)return LTe(t,n.orientation,n.mirror)},zTe=Pe([hr,lc,$Te,(t,s)=>s],(t,s,n,a)=>{if(s!=null){var i=n==null?void 0:n[a];return i==null?{x:0,y:t.top}:{x:i,y:t.top}}}),tG=Pe(hr,lc,(t,s)=>{var n=typeof s.width=="number"?s.width:s0;return{width:n,height:t.height}}),FO=(t,s,n)=>{switch(s){case"xAxis":return eG(t,n).width;case"yAxis":return tG(t,n).height;default:return}},sG=(t,s,n,a)=>{if(n!=null){var{allowDuplicatedCategory:i,type:l,dataKey:o}=n,c=Xu(t,a),d=s.map(u=>u.value);if(o&&c&&l==="category"&&i&&sH(d))return d}},iE=Pe([gs,NN,gn,ln],sG),nG=(t,s,n,a)=>{if(!(n==null||n.dataKey==null)){var{type:i,scale:l}=n,o=Xu(t,a);if(o&&(i==="number"||l!=="auto"))return s.map(c=>c.value)}},lE=Pe([gs,NN,c0,ln],nG);Pe([gs,JEe,tf,sf,iE,lE,u0,rE,ln],(t,s,n,a,i,l,o,c,d)=>{if(s!=null){var u=Xu(t,d);return{angle:s.angle,interval:s.interval,minTickGap:s.minTickGap,orientation:s.orientation,tick:s.tick,tickCount:s.tickCount,tickFormatter:s.tickFormatter,ticks:s.ticks,type:s.type,unit:s.unit,axisType:d,categoricalDomain:l,duplicateDomain:i,isCategorical:u,niceTicks:c,range:o,realScaleType:n,scale:a}}});var UTe=(t,s,n,a,i,l,o,c,d)=>{if(!(s==null||a==null)){var u=Xu(t,d),{type:h,ticks:f,tickCount:x}=s,b=n==="scaleBand"&&typeof a.bandwidth=="function"?a.bandwidth()/2:2,v=h==="category"&&a.bandwidth?a.bandwidth()/b:0;v=d==="angleAxis"&&l!=null&&l.length>=2?Lr(l[0]-l[1])*2*v:v;var w=f||i;if(w){var _=w.map((S,k)=>{var A=o?o.indexOf(S):S;return{index:k,coordinate:a(A)+v,value:S,offset:v}});return _.filter(S=>Rn(S.coordinate))}return u&&c?c.map((S,k)=>({coordinate:a(S)+v,value:S,index:k,offset:v})).filter(S=>Rn(S.coordinate)):a.ticks?a.ticks(x).map(S=>({coordinate:a(S)+v,value:S,offset:v})):a.domain().map((S,k)=>({coordinate:a(S)+v,value:o?o[S]:S,index:k,offset:v}))}},rG=Pe([gs,c0,tf,sf,rE,u0,iE,lE,ln],UTe),VTe=(t,s,n,a,i,l,o)=>{if(!(s==null||n==null||a==null||a[0]===a[1])){var c=Xu(t,o),{tickCount:d}=s,u=0;return u=o==="angleAxis"&&(a==null?void 0:a.length)>=2?Lr(a[0]-a[1])*2*u:u,c&&l?l.map((h,f)=>({coordinate:n(h)+u,value:h,index:f,offset:u})):n.ticks?n.ticks(d).map(h=>({coordinate:n(h)+u,value:h,offset:u})):n.domain().map((h,f)=>({coordinate:n(h)+u,value:i?i[h]:h,index:f,offset:u}))}},Sm=Pe([gs,c0,sf,u0,iE,lE,ln],VTe),Cm=Pe(gn,sf,(t,s)=>{if(!(t==null||s==null))return lb(lb({},t),{},{scale:s})}),HTe=Pe([gn,tf,tE,Qq],sE);Pe((t,s,n)=>zA(t,n),HTe,(t,s)=>{if(!(t==null||s==null))return lb(lb({},t),{},{scale:s})});var WTe=Pe([gs,eN,tN],(t,s,n)=>{switch(t){case"horizontal":return s.some(a=>a.reversed)?"right-to-left":"left-to-right";case"vertical":return n.some(a=>a.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),aG=t=>t.options.defaultTooltipEventType,iG=t=>t.options.validateTooltipEventTypes;function lG(t,s,n){if(t==null)return s;var a=t?"axis":"item";return n==null?s:n.includes(a)?a:s}function oE(t,s){var n=aG(t),a=iG(t);return lG(s,n,a)}function qTe(t){return Et(s=>oE(s,t))}var oG=(t,s)=>{var n,a=Number(s);if(!(uo(a)||s==null))return a>=0?t==null||(n=t[a])===null||n===void 0?void 0:n.value:void 0},GTe=t=>t.tooltip.settings,Pc={active:!1,index:null,dataKey:void 0,coordinate:void 0},KTe={itemInteraction:{click:Pc,hover:Pc},axisInteraction:{click:Pc,hover:Pc},keyboardInteraction:Pc,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},cG=Ha({name:"tooltip",initialState:KTe,reducers:{addTooltipEntrySettings:{reducer(t,s){t.tooltipItemPayloads.push(s.payload)},prepare:rr()},removeTooltipEntrySettings:{reducer(t,s){var n=Ro(t).tooltipItemPayloads.indexOf(s.payload);n>-1&&t.tooltipItemPayloads.splice(n,1)},prepare:rr()},setTooltipSettingsState(t,s){t.settings=s.payload},setActiveMouseOverItemIndex(t,s){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=s.payload.activeIndex,t.itemInteraction.hover.dataKey=s.payload.activeDataKey,t.itemInteraction.hover.coordinate=s.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,s){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=s.payload.activeIndex,t.itemInteraction.click.dataKey=s.payload.activeDataKey,t.itemInteraction.click.coordinate=s.payload.activeCoordinate},setMouseOverAxisIndex(t,s){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=s.payload.activeIndex,t.axisInteraction.hover.dataKey=s.payload.activeDataKey,t.axisInteraction.hover.coordinate=s.payload.activeCoordinate},setMouseClickAxisIndex(t,s){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=s.payload.activeIndex,t.axisInteraction.click.dataKey=s.payload.activeDataKey,t.axisInteraction.click.coordinate=s.payload.activeCoordinate},setSyncInteraction(t,s){t.syncInteraction=s.payload},setKeyboardInteraction(t,s){t.keyboardInteraction.active=s.payload.active,t.keyboardInteraction.index=s.payload.activeIndex,t.keyboardInteraction.coordinate=s.payload.activeCoordinate,t.keyboardInteraction.dataKey=s.payload.activeDataKey}}}),{addTooltipEntrySettings:YTe,removeTooltipEntrySettings:XTe,setTooltipSettingsState:QTe,setActiveMouseOverItemIndex:dG,mouseLeaveItem:ZTe,mouseLeaveChart:uG,setActiveClickItemIndex:JTe,setMouseOverAxisIndex:hG,setMouseClickAxisIndex:e4e,setSyncInteraction:bC,setKeyboardInteraction:vC}=cG.actions,t4e=cG.reducer;function $O(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function Mg(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?$O(Object(n),!0).forEach(function(a){s4e(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$O(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function s4e(t,s,n){return(s=n4e(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function n4e(t){var s=r4e(t,"string");return typeof s=="symbol"?s:s+""}function r4e(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function a4e(t,s,n){return s==="axis"?n==="click"?t.axisInteraction.click:t.axisInteraction.hover:n==="click"?t.itemInteraction.click:t.itemInteraction.hover}function i4e(t){return t.index!=null}var mG=(t,s,n,a)=>{if(s==null)return Pc;var i=a4e(t,s,n);if(i==null)return Pc;if(i.active)return i;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var l=t.settings.active===!0;if(i4e(i)){if(l)return Mg(Mg({},i),{},{active:!0})}else if(a!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:a};return Mg(Mg({},Pc),{},{coordinate:i.coordinate})},cE=(t,s)=>{var n=t==null?void 0:t.index;if(n==null)return null;var a=Number(n);if(!Rn(a))return n;var i=0,l=1/0;return s.length>0&&(l=s.length-1),String(Math.max(i,Math.min(a,l)))},fG=(t,s,n,a,i,l,o,c)=>{if(!(l==null||c==null)){var d=o[0],u=d==null?void 0:c(d.positions,l);if(u!=null)return u;var h=i==null?void 0:i[Number(l)];if(h)switch(n){case"horizontal":return{x:h.coordinate,y:(a.top+s)/2};default:return{x:(a.left+t)/2,y:h.coordinate}}}},pG=(t,s,n,a)=>{if(s==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var i;return n==="hover"?i=t.itemInteraction.hover.dataKey:i=t.itemInteraction.click.dataKey,i==null&&a!=null?[t.tooltipItemPayloads[0]]:t.tooltipItemPayloads.filter(l=>{var o;return((o=l.settings)===null||o===void 0?void 0:o.dataKey)===i})},h0=t=>t.options.tooltipPayloadSearcher,nf=t=>t.tooltip;function zO(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function UO(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?zO(Object(n),!0).forEach(function(a){l4e(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zO(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function l4e(t,s,n){return(s=o4e(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function o4e(t){var s=c4e(t,"string");return typeof s=="symbol"?s:s+""}function c4e(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function d4e(t,s){return t??s}var xG=(t,s,n,a,i,l,o)=>{if(!(s==null||l==null)){var{chartData:c,computedData:d,dataStartIndex:u,dataEndIndex:h}=n,f=[];return t.reduce((x,b)=>{var v,{dataDefinedOnItem:w,settings:_}=b,S=d4e(w,c),k=Array.isArray(S)?sW(S,u,h):S,A=(v=_==null?void 0:_.dataKey)!==null&&v!==void 0?v:a,T=_==null?void 0:_.nameKey,P;if(a&&Array.isArray(k)&&!Array.isArray(k[0])&&o==="axis"?P=hSe(k,a,i):P=l(k,s,d,T),Array.isArray(P))P.forEach(D=>{var I=UO(UO({},_),{},{name:D.name,unit:D.unit,color:void 0,fill:void 0});x.push(_D({tooltipEntrySettings:I,dataKey:D.dataKey,payload:D.payload,value:mn(D.payload,D.dataKey),name:D.name}))});else{var O;x.push(_D({tooltipEntrySettings:_,dataKey:A,payload:P,value:mn(P,A),name:(O=mn(P,T))!==null&&O!==void 0?O:_==null?void 0:_.name}))}return x},f)}},dE=Pe([pr,gs,Rq,DA,fr],Yq),u4e=Pe([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,s)=>[...t,...s]),h4e=Pe([fr,Jm],UA),m0=Pe([u4e,pr,h4e],HA,{memoizeOptions:{resultEqualityCheck:vN}}),m4e=Pe([m0],t=>t.filter(yN)),f4e=Pe([m0],WA,{memoizeOptions:{resultEqualityCheck:vN}}),rf=Pe([f4e,kd],qA),p4e=Pe([m4e,kd,pr],Mq),uE=Pe([rf,pr,m0],KA),gG=Pe([pr],YA),x4e=Pe([pr],t=>t.allowDataOverflow),yG=Pe([gG,x4e],dq),g4e=Pe([m0],t=>t.filter(yN)),y4e=Pe([p4e,g4e,l0],zq),b4e=Pe([y4e,kd,fr,yG],Uq),v4e=Pe([m0],Bq),N4e=Pe([rf,pr,v4e,wN,fr],ZA,{memoizeOptions:{resultEqualityCheck:bN}}),w4e=Pe([Vq,fr,Jm],ef),j4e=Pe([w4e,fr],qq),_4e=Pe([Hq,fr,Jm],ef),S4e=Pe([_4e,fr],Gq),C4e=Pe([Wq,fr,Jm],ef),k4e=Pe([C4e,fr],Kq),A4e=Pe([j4e,k4e,S4e],ob),E4e=Pe([pr,gG,yG,b4e,N4e,A4e,gs,fr],JA),bG=Pe([pr,gs,rf,uE,l0,fr,E4e],eE),T4e=Pe([bG,pr,dE],nE),P4e=Pe([pr,bG,T4e,fr],aE),vG=t=>{var s=fr(t),n=Jm(t),a=!1;return u0(t,s,n,a)},NG=Pe([pr,vG],xN),wG=Pe([pr,dE,P4e,NG],sE),I4e=Pe([gs,uE,pr,fr],sG),M4e=Pe([gs,uE,pr,fr],nG),D4e=(t,s,n,a,i,l,o,c)=>{if(s){var{type:d}=s,u=Xu(t,c);if(a){var h=n==="scaleBand"&&a.bandwidth?a.bandwidth()/2:2,f=d==="category"&&a.bandwidth?a.bandwidth()/h:0;return f=c==="angleAxis"&&i!=null&&(i==null?void 0:i.length)>=2?Lr(i[0]-i[1])*2*f:f,u&&o?o.map((x,b)=>({coordinate:a(x)+f,value:x,index:b,offset:f})):a.domain().map((x,b)=>({coordinate:a(x)+f,value:l?l[x]:x,index:b,offset:f}))}}},oc=Pe([gs,pr,dE,wG,vG,I4e,M4e,fr],D4e),hE=Pe([aG,iG,GTe],(t,s,n)=>lG(n.shared,t,s)),jG=t=>t.tooltip.settings.trigger,mE=t=>t.tooltip.settings.defaultIndex,SN=Pe([nf,hE,jG,mE],mG),Fu=Pe([SN,rf],cE),_G=Pe([oc,Fu],oG),SG=Pe([SN],t=>{if(t)return t.dataKey}),CG=Pe([nf,hE,jG,mE],pG),O4e=Pe([nc,rc,gs,hr,oc,mE,CG,h0],fG),R4e=Pe([SN,O4e],(t,s)=>t!=null&&t.coordinate?t.coordinate:s),L4e=Pe([SN],t=>t.active),B4e=Pe([CG,Fu,kd,$q,_G,h0,hE],xG);Pe([B4e],t=>{if(t!=null){var s=t.map(n=>n.payload).filter(n=>n!=null);return Array.from(new Set(s))}});function VO(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function HO(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?VO(Object(n),!0).forEach(function(a){F4e(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):VO(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function F4e(t,s,n){return(s=$4e(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function $4e(t){var s=z4e(t,"string");return typeof s=="symbol"?s:s+""}function z4e(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var U4e=()=>Et(pr),V4e=()=>{var t=U4e(),s=Et(oc),n=Et(wG);return W1(!t||!n?void 0:HO(HO({},t),{},{scale:n}),s)};function WO(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function fh(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?WO(Object(n),!0).forEach(function(a){H4e(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):WO(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function H4e(t,s,n){return(s=W4e(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function W4e(t){var s=q4e(t,"string");return typeof s=="symbol"?s:s+""}function q4e(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var G4e=(t,s,n,a)=>{var i=s.find(l=>l&&l.index===n);if(i){if(t==="horizontal")return{x:i.coordinate,y:a.chartY};if(t==="vertical")return{x:a.chartX,y:i.coordinate}}return{x:0,y:0}},K4e=(t,s,n,a)=>{var i=s.find(u=>u&&u.index===n);if(i){if(t==="centric"){var l=i.coordinate,{radius:o}=a;return fh(fh(fh({},a),Gn(a.cx,a.cy,o,l)),{},{angle:l,radius:o})}var c=i.coordinate,{angle:d}=a;return fh(fh(fh({},a),Gn(a.cx,a.cy,c,d)),{},{angle:d,radius:c})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function Y4e(t,s){var{chartX:n,chartY:a}=t;return n>=s.left&&n<=s.left+s.width&&a>=s.top&&a<=s.top+s.height}var kG=(t,s,n,a,i)=>{var l,o=-1,c=(l=s==null?void 0:s.length)!==null&&l!==void 0?l:0;if(c<=1||t==null)return 0;if(a==="angleAxis"&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var d=0;d<c;d++){var u=d>0?n[d-1].coordinate:n[c-1].coordinate,h=n[d].coordinate,f=d>=c-1?n[0].coordinate:n[d+1].coordinate,x=void 0;if(Lr(h-u)!==Lr(f-h)){var b=[];if(Lr(f-h)===Lr(i[1]-i[0])){x=f;var v=h+i[1]-i[0];b[0]=Math.min(v,(v+u)/2),b[1]=Math.max(v,(v+u)/2)}else{x=u;var w=f+i[1]-i[0];b[0]=Math.min(h,(w+h)/2),b[1]=Math.max(h,(w+h)/2)}var _=[Math.min(h,(x+h)/2),Math.max(h,(x+h)/2)];if(t>_[0]&&t<=_[1]||t>=b[0]&&t<=b[1]){({index:o}=n[d]);break}}else{var S=Math.min(u,f),k=Math.max(u,f);if(t>(S+h)/2&&t<=(k+h)/2){({index:o}=n[d]);break}}}else if(s){for(var A=0;A<c;A++)if(A===0&&t<=(s[A].coordinate+s[A+1].coordinate)/2||A>0&&A<c-1&&t>(s[A].coordinate+s[A-1].coordinate)/2&&t<=(s[A].coordinate+s[A+1].coordinate)/2||A===c-1&&t>(s[A].coordinate+s[A-1].coordinate)/2){({index:o}=s[A]);break}}return o},X4e=()=>Et(DA),fE=(t,s)=>s,AG=(t,s,n)=>n,pE=(t,s,n,a)=>a,Q4e=Pe(oc,t=>Gv(t,s=>s.coordinate)),xE=Pe([nf,fE,AG,pE],mG),EG=Pe([xE,rf],cE),Z4e=(t,s,n)=>{if(s!=null){var a=nf(t);return s==="axis"?n==="hover"?a.axisInteraction.hover.dataKey:a.axisInteraction.click.dataKey:n==="hover"?a.itemInteraction.hover.dataKey:a.itemInteraction.click.dataKey}},TG=Pe([nf,fE,AG,pE],pG),cb=Pe([nc,rc,gs,hr,oc,pE,TG,h0],fG),J4e=Pe([xE,cb],(t,s)=>{var n;return(n=t.coordinate)!==null&&n!==void 0?n:s}),PG=Pe([oc,EG],oG),ePe=Pe([TG,EG,kd,$q,PG,h0,fE],xG),tPe=Pe([xE],t=>({isActive:t.active,activeIndex:t.index})),sPe=(t,s,n,a,i,l,o)=>{if(!(!t||!n||!a||!i)&&Y4e(t,o)){var c=i3e(t,s),d=kG(c,l,i,n,a),u=G4e(s,i,d,t);return{activeIndex:String(d),activeCoordinate:u}}},nPe=(t,s,n,a,i,l,o)=>{if(!(!t||!a||!i||!l||!n)){var c=Yke(t,n);if(c){var d=l3e(c,s),u=kG(d,o,l,a,i),h=K4e(s,l,u,c);return{activeIndex:String(u),activeCoordinate:h}}}},rPe=(t,s,n,a,i,l,o,c)=>{if(!(!t||!s||!a||!i||!l))return s==="horizontal"||s==="vertical"?sPe(t,s,a,i,l,o,c):nPe(t,s,n,a,i,l,o)},aPe=Pe(t=>t.zIndex.zIndexMap,(t,s)=>s,(t,s,n)=>n,(t,s,n)=>{if(s!=null){var a=t[s];if(a!=null)return n?a.panoramaElementId:a.elementId}}),iPe=Pe(t=>t.zIndex.zIndexMap,t=>{var s=Object.keys(t).map(a=>parseInt(a,10)).concat(Object.values(Xr)),n=Array.from(new Set(s));return n.sort((a,i)=>a-i)},{memoizeOptions:{resultEqualityCheck:KEe}});function qO(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function GO(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?qO(Object(n),!0).forEach(function(a){lPe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qO(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function lPe(t,s,n){return(s=oPe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function oPe(t){var s=cPe(t,"string");return typeof s=="symbol"?s:s+""}function cPe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var dPe={},uPe={zIndexMap:Object.values(Xr).reduce((t,s)=>GO(GO({},t),{},{[s]:{elementId:void 0,panoramaElementId:void 0,consumers:0}}),dPe)},hPe=new Set(Object.values(Xr));function mPe(t){return hPe.has(t)}var IG=Ha({name:"zIndex",initialState:uPe,reducers:{registerZIndexPortal:{reducer:(t,s)=>{var{zIndex:n}=s.payload;t.zIndexMap[n]?t.zIndexMap[n].consumers+=1:t.zIndexMap[n]={consumers:1,elementId:void 0,panoramaElementId:void 0}},prepare:rr()},unregisterZIndexPortal:{reducer:(t,s)=>{var{zIndex:n}=s.payload;t.zIndexMap[n]&&(t.zIndexMap[n].consumers-=1,t.zIndexMap[n].consumers<=0&&!mPe(n)&&delete t.zIndexMap[n])},prepare:rr()},registerZIndexPortalId:{reducer:(t,s)=>{var{zIndex:n,elementId:a,isPanorama:i}=s.payload;t.zIndexMap[n]?i?t.zIndexMap[n].panoramaElementId=a:t.zIndexMap[n].elementId=a:t.zIndexMap[n]={consumers:0,elementId:i?void 0:a,panoramaElementId:i?a:void 0}},prepare:rr()},unregisterZIndexPortalId:{reducer:(t,s)=>{var{zIndex:n}=s.payload;t.zIndexMap[n]&&(s.payload.isPanorama?t.zIndexMap[n].panoramaElementId=void 0:t.zIndexMap[n].elementId=void 0)},prepare:rr()}}}),{registerZIndexPortal:fPe,unregisterZIndexPortal:pPe,registerZIndexPortalId:xPe,unregisterZIndexPortalId:gPe}=IG.actions,yPe=IG.reducer;function bo(t){var{zIndex:s,children:n}=t,a=R3e(),i=a&&s!==void 0&&s!==0,l=vi(),o=an();y.useLayoutEffect(()=>i?(o(fPe({zIndex:s})),()=>{o(pPe({zIndex:s}))}):Yu,[o,s,i]);var c=Et(u=>aPe(u,s,l));if(!i)return n;if(!c)return null;var d=document.getElementById(c);return d?pd.createPortal(n,d):null}function NC(){return NC=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},NC.apply(null,arguments)}function KO(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function Dg(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?KO(Object(n),!0).forEach(function(a){bPe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):KO(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function bPe(t,s,n){return(s=vPe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function vPe(t){var s=NPe(t,"string");return typeof s=="symbol"?s:s+""}function NPe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function wPe(t){var{cursor:s,cursorComp:n,cursorProps:a}=t;return y.isValidElement(s)?y.cloneElement(s,a):y.createElement(n,a)}function jPe(t){var s,{coordinate:n,payload:a,index:i,offset:l,tooltipAxisBandSize:o,layout:c,cursor:d,tooltipEventType:u,chartName:h}=t,f=n,x=a,b=i;if(!d||!f||h!=="ScatterChart"&&u!=="axis")return null;var v,w,_;if(h==="ScatterChart")v=f,w=uke,_=Xr.cursorLine;else if(h==="BarChart")v=hke(c,f,l,o),w=NW,_=Xr.cursorRectangle;else if(c==="radial"&&aH(f)){var{cx:S,cy:k,radius:A,startAngle:T,endAngle:P}=jW(f);v={cx:S,cy:k,startAngle:T,endAngle:P,innerRadius:A,outerRadius:A},w=SW,_=Xr.cursorLine}else v={points:Jke(c,f,l)},w=iA,_=Xr.cursorLine;var O=typeof d=="object"&&"className"in d?d.className:void 0,D=Dg(Dg(Dg(Dg({stroke:"#ccc",pointerEvents:"none"},l),v),xx(d)),{},{payload:x,payloadIndex:b,className:vs("recharts-tooltip-cursor",O)});return y.createElement(bo,{zIndex:(s=t.zIndex)!==null&&s!==void 0?s:_},y.createElement(wPe,{cursor:d,cursorComp:w,cursorProps:D}))}function _Pe(t){var s=V4e(),n=M3e(),a=aN(),i=X4e();return s==null||n==null||a==null||i==null?null:y.createElement(jPe,NC({},t,{offset:n,layout:a,tooltipAxisBandSize:s,chartName:i}))}var MG=y.createContext(null),SPe=()=>y.useContext(MG),DG={exports:{}};(function(t){var s=Object.prototype.hasOwnProperty,n="~";function a(){}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(n=!1));function i(d,u,h){this.fn=d,this.context=u,this.once=h||!1}function l(d,u,h,f,x){if(typeof h!="function")throw new TypeError("The listener must be a function");var b=new i(h,f||d,x),v=n?n+u:u;return d._events[v]?d._events[v].fn?d._events[v]=[d._events[v],b]:d._events[v].push(b):(d._events[v]=b,d._eventsCount++),d}function o(d,u){--d._eventsCount===0?d._events=new a:delete d._events[u]}function c(){this._events=new a,this._eventsCount=0}c.prototype.eventNames=function(){var u=[],h,f;if(this._eventsCount===0)return u;for(f in h=this._events)s.call(h,f)&&u.push(n?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(h)):u},c.prototype.listeners=function(u){var h=n?n+u:u,f=this._events[h];if(!f)return[];if(f.fn)return[f.fn];for(var x=0,b=f.length,v=new Array(b);x<b;x++)v[x]=f[x].fn;return v},c.prototype.listenerCount=function(u){var h=n?n+u:u,f=this._events[h];return f?f.fn?1:f.length:0},c.prototype.emit=function(u,h,f,x,b,v){var w=n?n+u:u;if(!this._events[w])return!1;var _=this._events[w],S=arguments.length,k,A;if(_.fn){switch(_.once&&this.removeListener(u,_.fn,void 0,!0),S){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,h),!0;case 3:return _.fn.call(_.context,h,f),!0;case 4:return _.fn.call(_.context,h,f,x),!0;case 5:return _.fn.call(_.context,h,f,x,b),!0;case 6:return _.fn.call(_.context,h,f,x,b,v),!0}for(A=1,k=new Array(S-1);A<S;A++)k[A-1]=arguments[A];_.fn.apply(_.context,k)}else{var T=_.length,P;for(A=0;A<T;A++)switch(_[A].once&&this.removeListener(u,_[A].fn,void 0,!0),S){case 1:_[A].fn.call(_[A].context);break;case 2:_[A].fn.call(_[A].context,h);break;case 3:_[A].fn.call(_[A].context,h,f);break;case 4:_[A].fn.call(_[A].context,h,f,x);break;default:if(!k)for(P=1,k=new Array(S-1);P<S;P++)k[P-1]=arguments[P];_[A].fn.apply(_[A].context,k)}}return!0},c.prototype.on=function(u,h,f){return l(this,u,h,f,!1)},c.prototype.once=function(u,h,f){return l(this,u,h,f,!0)},c.prototype.removeListener=function(u,h,f,x){var b=n?n+u:u;if(!this._events[b])return this;if(!h)return o(this,b),this;var v=this._events[b];if(v.fn)v.fn===h&&(!x||v.once)&&(!f||v.context===f)&&o(this,b);else{for(var w=0,_=[],S=v.length;w<S;w++)(v[w].fn!==h||x&&!v[w].once||f&&v[w].context!==f)&&_.push(v[w]);_.length?this._events[b]=_.length===1?_[0]:_:o(this,b)}return this},c.prototype.removeAllListeners=function(u){var h;return u?(h=n?n+u:u,this._events[h]&&o(this,h)):(this._events=new a,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=n,c.EventEmitter=c,t.exports=c})(DG);var CPe=DG.exports;const kPe=Yi(CPe);var kx=new kPe,wC="recharts.syncEvent.tooltip",YO="recharts.syncEvent.brush";function OG(t,s){if(s){var n=Number.parseInt(s,10);if(!uo(n))return t==null?void 0:t[n]}}var APe={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},RG=Ha({name:"options",initialState:APe,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),EPe=RG.reducer,{createEventEmitter:TPe}=RG.actions;function PPe(t){return t.tooltip.syncInteraction}var IPe={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},LG=Ha({name:"chartData",initialState:IPe,reducers:{setChartData(t,s){if(t.chartData=s.payload,s.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}s.payload.length>0&&t.dataEndIndex!==s.payload.length-1&&(t.dataEndIndex=s.payload.length-1)},setComputedData(t,s){t.computedData=s.payload},setDataStartEndIndexes(t,s){var{startIndex:n,endIndex:a}=s.payload;n!=null&&(t.dataStartIndex=n),a!=null&&(t.dataEndIndex=a)}}}),{setChartData:XO,setDataStartEndIndexes:MPe,setComputedData:jBe}=LG.actions,DPe=LG.reducer,OPe=["x","y"];function QO(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function ph(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?QO(Object(n),!0).forEach(function(a){RPe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):QO(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function RPe(t,s,n){return(s=LPe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function LPe(t){var s=BPe(t,"string");return typeof s=="symbol"?s:s+""}function BPe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function FPe(t,s){if(t==null)return{};var n,a,i=$Pe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function $Pe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}function zPe(){var t=Et(OA),s=Et(RA),n=an(),a=Et(kq),i=Et(oc),l=aN(),o=rN(),c=Et(d=>d.rootProps.className);y.useEffect(()=>{if(t==null)return Yu;var d=(u,h,f)=>{if(s!==f&&t===u){if(a==="index"){var x;if(o&&h!==null&&h!==void 0&&(x=h.payload)!==null&&x!==void 0&&x.coordinate&&h.payload.sourceViewBox){var b=h.payload.coordinate,{x:v,y:w}=b,_=FPe(b,OPe),{x:S,y:k,width:A,height:T}=h.payload.sourceViewBox,P=ph(ph({},_),{},{x:o.x+(A?(v-S)/A:0)*o.width,y:o.y+(T?(w-k)/T:0)*o.height});n(ph(ph({},h),{},{payload:ph(ph({},h.payload),{},{coordinate:P})}))}else n(h);return}if(i!=null){var O;if(typeof a=="function"){var D={activeTooltipIndex:h.payload.index==null?void 0:Number(h.payload.index),isTooltipActive:h.payload.active,activeIndex:h.payload.index==null?void 0:Number(h.payload.index),activeLabel:h.payload.label,activeDataKey:h.payload.dataKey,activeCoordinate:h.payload.coordinate},I=a(i,D);O=i[I]}else a==="value"&&(O=i.find(H=>String(H.value)===h.payload.label));var{coordinate:M}=h.payload;if(O==null||h.payload.active===!1||M==null||o==null){n(bC({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0}));return}var{x:B,y:L}=M,F=Math.min(B,o.x+o.width),V=Math.min(L,o.y+o.height),$={x:l==="horizontal"?O.coordinate:F,y:l==="horizontal"?V:O.coordinate},z=bC({active:h.payload.active,coordinate:$,dataKey:h.payload.dataKey,index:String(O.index),label:h.payload.label,sourceViewBox:h.payload.sourceViewBox});n(z)}}};return kx.on(wC,d),()=>{kx.off(wC,d)}},[c,n,s,t,a,i,l,o])}function UPe(){var t=Et(OA),s=Et(RA),n=an();y.useEffect(()=>{if(t==null)return Yu;var a=(i,l,o)=>{s!==o&&t===i&&n(MPe(l))};return kx.on(YO,a),()=>{kx.off(YO,a)}},[n,s,t])}function VPe(){var t=an();y.useEffect(()=>{t(TPe())},[t]),zPe(),UPe()}function HPe(t,s,n,a,i,l){var o=Et(b=>Z4e(b,t,s)),c=Et(RA),d=Et(OA),u=Et(kq),h=Et(PPe),f=h==null?void 0:h.active,x=rN();y.useEffect(()=>{if(!f&&d!=null&&c!=null){var b=bC({active:l,coordinate:n,dataKey:o,index:i,label:typeof a=="number"?String(a):a,sourceViewBox:x});kx.emit(wC,d,b,c)}},[f,n,o,i,a,c,d,u,l,x])}function ZO(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function JO(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?ZO(Object(n),!0).forEach(function(a){WPe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ZO(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function WPe(t,s,n){return(s=qPe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function qPe(t){var s=GPe(t,"string");return typeof s=="symbol"?s:s+""}function GPe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function KPe(t){return t.dataKey}function YPe(t,s){return y.isValidElement(t)?y.cloneElement(t,s):typeof t=="function"?y.createElement(t,s):y.createElement(V3e,s)}var eR=[],XPe={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Qu.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function nu(t){var s,n,a=ba(t,XPe),{active:i,allowEscapeViewBox:l,animationDuration:o,animationEasing:c,content:d,filterNull:u,isAnimationActive:h,offset:f,payloadUniqBy:x,position:b,reverseDirection:v,useTranslate3d:w,wrapperStyle:_,cursor:S,shared:k,trigger:A,defaultIndex:T,portal:P,axisId:O}=a,D=an(),I=typeof T=="number"?String(T):T;y.useEffect(()=>{D(QTe({shared:k,trigger:A,axisId:O,active:i,defaultIndex:I}))},[D,k,A,O,i,I]);var M=rN(),B=xW(),L=qTe(k),{activeIndex:F,isActive:V}=(s=Et(de=>tPe(de,L,A,I)))!==null&&s!==void 0?s:{},$=Et(de=>ePe(de,L,A,I)),z=Et(de=>PG(de,L,A,I)),H=Et(de=>J4e(de,L,A,I)),q=$,G=SPe(),re=(n=i??V)!==null&&n!==void 0?n:!1,[ye,Ee]=KSe([q,re]),ee=L==="axis"?z:void 0;HPe(L,A,H,ee,F,re);var te=P??G;if(te==null||M==null||L==null)return null;var ce=q??eR;re||(ce=eR),u&&ce.length&&(ce=PSe(ce.filter(de=>de.value!=null&&(de.hide!==!0||a.includeHidden)),x,KPe));var ge=ce.length>0,X=y.createElement(X3e,{allowEscapeViewBox:l,animationDuration:o,animationEasing:c,isAnimationActive:h,active:re,coordinate:H,hasPayload:ge,offset:f,position:b,reverseDirection:v,useTranslate3d:w,viewBox:M,wrapperStyle:_,lastBoundingBox:ye,innerRef:Ee,hasPortalFromProps:!!P},YPe(d,JO(JO({},a),{},{payload:ce,label:ee,active:re,activeIndex:F,coordinate:H,accessibilityLayer:B})));return y.createElement(y.Fragment,null,pd.createPortal(X,te),re&&y.createElement(_Pe,{cursor:S,tooltipEventType:L,coordinate:H,payload:ce,index:F}))}var Zl=t=>null;Zl.displayName="Cell";function QPe(t,s,n){return(s=ZPe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function ZPe(t){var s=JPe(t,"string");return typeof s=="symbol"?s:s+""}function JPe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}class eIe{constructor(s){QPe(this,"cache",new Map),this.maxSize=s}get(s){var n=this.cache.get(s);return n!==void 0&&(this.cache.delete(s),this.cache.set(s,n)),n}set(s,n){if(this.cache.has(s))this.cache.delete(s);else if(this.cache.size>=this.maxSize){var a=this.cache.keys().next().value;this.cache.delete(a)}this.cache.set(s,n)}clear(){this.cache.clear()}size(){return this.cache.size}}function tR(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function tIe(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?tR(Object(n),!0).forEach(function(a){sIe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tR(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function sIe(t,s,n){return(s=nIe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function nIe(t){var s=rIe(t,"string");return typeof s=="symbol"?s:s+""}function rIe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var aIe={cacheSize:2e3,enableCache:!0},BG=tIe({},aIe),sR=new eIe(BG.cacheSize),iIe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},nR="recharts_measurement_span";function lIe(t,s){var n=s.fontSize||"",a=s.fontFamily||"",i=s.fontWeight||"",l=s.fontStyle||"",o=s.letterSpacing||"",c=s.textTransform||"";return"".concat(t,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(l,"|").concat(o,"|").concat(c)}var rR=(t,s)=>{try{var n=document.getElementById(nR);n||(n=document.createElement("span"),n.setAttribute("id",nR),n.setAttribute("aria-hidden","true"),document.body.appendChild(n)),Object.assign(n.style,iIe,s),n.textContent="".concat(t);var a=n.getBoundingClientRect();return{width:a.width,height:a.height}}catch{return{width:0,height:0}}},Sp=function(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(s==null||Qu.isSsr)return{width:0,height:0};if(!BG.enableCache)return rR(s,n);var a=lIe(s,n),i=sR.get(a);if(i)return i;var l=rR(s,n);return sR.set(a,l),l},aR=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,iR=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,oIe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,cIe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,FG={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},dIe=Object.keys(FG),Bh="NaN";function uIe(t,s){return t*FG[s]}class ka{static parse(s){var n,[,a,i]=(n=cIe.exec(s))!==null&&n!==void 0?n:[];return new ka(parseFloat(a),i??"")}constructor(s,n){this.num=s,this.unit=n,this.num=s,this.unit=n,uo(s)&&(this.unit=""),n!==""&&!oIe.test(n)&&(this.num=NaN,this.unit=""),dIe.includes(n)&&(this.num=uIe(s,n),this.unit="px")}add(s){return this.unit!==s.unit?new ka(NaN,""):new ka(this.num+s.num,this.unit)}subtract(s){return this.unit!==s.unit?new ka(NaN,""):new ka(this.num-s.num,this.unit)}multiply(s){return this.unit!==""&&s.unit!==""&&this.unit!==s.unit?new ka(NaN,""):new ka(this.num*s.num,this.unit||s.unit)}divide(s){return this.unit!==""&&s.unit!==""&&this.unit!==s.unit?new ka(NaN,""):new ka(this.num/s.num,this.unit||s.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return uo(this.num)}}function $G(t){if(t.includes(Bh))return Bh;for(var s=t;s.includes("*")||s.includes("/");){var n,[,a,i,l]=(n=aR.exec(s))!==null&&n!==void 0?n:[],o=ka.parse(a??""),c=ka.parse(l??""),d=i==="*"?o.multiply(c):o.divide(c);if(d.isNaN())return Bh;s=s.replace(aR,d.toString())}for(;s.includes("+")||/.-\d+(?:\.\d+)?/.test(s);){var u,[,h,f,x]=(u=iR.exec(s))!==null&&u!==void 0?u:[],b=ka.parse(h??""),v=ka.parse(x??""),w=f==="+"?b.add(v):b.subtract(v);if(w.isNaN())return Bh;s=s.replace(iR,w.toString())}return s}var lR=/\(([^()]*)\)/;function hIe(t){for(var s=t,n;(n=lR.exec(s))!=null;){var[,a]=n;s=s.replace(lR,$G(a))}return s}function mIe(t){var s=t.replace(/\s+/g,"");return s=hIe(s),s=$G(s),s}function fIe(t){try{return mIe(t)}catch{return Bh}}function Zj(t){var s=fIe(t.slice(5,-1));return s===Bh?"":s}var pIe=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],xIe=["dx","dy","angle","className","breakAll"];function jC(){return jC=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},jC.apply(null,arguments)}function oR(t,s){if(t==null)return{};var n,a,i=gIe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function gIe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}var zG=/[ \f\n\r\t\v\u2028\u2029]+/,UG=t=>{var{children:s,breakAll:n,style:a}=t;try{var i=[];jr(s)||(n?i=s.toString().split(""):i=s.toString().split(zG));var l=i.map(c=>({word:c,width:Sp(c,a).width})),o=n?0:Sp("",a).width;return{wordsWithComputedWidth:l,spaceWidth:o}}catch{return null}};function yIe(t){return t==="start"||t==="middle"||t==="end"||t==="inherit"}var VG=(t,s,n,a)=>t.reduce((i,l)=>{var{word:o,width:c}=l,d=i[i.length-1];if(d&&c!=null&&(s==null||a||d.width+c+n<Number(s)))d.words.push(o),d.width+=c+n;else{var u={words:[o],width:c};i.push(u)}return i},[]),HG=t=>t.reduce((s,n)=>s.width>n.width?s:n),bIe="",cR=(t,s,n,a,i,l,o,c)=>{var d=t.slice(0,s),u=UG({breakAll:n,style:a,children:d+bIe});if(!u)return[!1,[]];var h=VG(u.wordsWithComputedWidth,l,o,c),f=h.length>i||HG(h).width>Number(l);return[f,h]},vIe=(t,s,n,a,i)=>{var{maxLines:l,children:o,style:c,breakAll:d}=t,u=Dt(l),h=String(o),f=VG(s,a,n,i);if(!u||i)return f;var x=f.length>l||HG(f).width>Number(a);if(!x)return f;for(var b=0,v=h.length-1,w=0,_;b<=v&&w<=h.length-1;){var S=Math.floor((b+v)/2),k=S-1,[A,T]=cR(h,k,d,c,l,a,n,i),[P]=cR(h,S,d,c,l,a,n,i);if(!A&&!P&&(b=S+1),A&&P&&(v=S-1),!A&&P){_=T;break}w++}return _||f},dR=t=>{var s=jr(t)?[]:t.toString().split(zG);return[{words:s,width:void 0}]},NIe=t=>{var{width:s,scaleToFit:n,children:a,style:i,breakAll:l,maxLines:o}=t;if((s||n)&&!Qu.isSsr){var c,d,u=UG({breakAll:l,children:a,style:i});if(u){var{wordsWithComputedWidth:h,spaceWidth:f}=u;c=h,d=f}else return dR(a);return vIe({breakAll:l,children:a,maxLines:o,style:i},c,d,s,!!n)}return dR(a)},WG="#808080",wIe={breakAll:!1,capHeight:"0.71em",fill:WG,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},CN=y.forwardRef((t,s)=>{var n=ba(t,wIe),{x:a,y:i,lineHeight:l,capHeight:o,fill:c,scaleToFit:d,textAnchor:u,verticalAnchor:h}=n,f=oR(n,pIe),x=y.useMemo(()=>NIe({breakAll:f.breakAll,children:f.children,maxLines:f.maxLines,scaleToFit:d,style:f.style,width:f.width}),[f.breakAll,f.children,f.maxLines,d,f.style,f.width]),{dx:b,dy:v,angle:w,className:_,breakAll:S}=f,k=oR(f,xIe);if(!ho(a)||!ho(i)||x.length===0)return null;var A=Number(a)+(Dt(b)?b:0),T=Number(i)+(Dt(v)?v:0);if(!Rn(A)||!Rn(T))return null;var P;switch(h){case"start":P=Zj("calc(".concat(o,")"));break;case"middle":P=Zj("calc(".concat((x.length-1)/2," * -").concat(l," + (").concat(o," / 2))"));break;default:P=Zj("calc(".concat(x.length-1," * -").concat(l,")"));break}var O=[];if(d){var D=x[0].width,{width:I}=f;O.push("scale(".concat(Dt(I)&&Dt(D)?I/D:1,")"))}return w&&O.push("rotate(".concat(w,", ").concat(A,", ").concat(T,")")),O.length&&(k.transform=O.join(" ")),y.createElement("text",jC({},qi(k),{ref:s,x:A,y:T,className:vs("recharts-text",_),textAnchor:u,fill:c.includes("url")?WG:c}),x.map((M,B)=>{var L=M.words.join(S?"":" ");return y.createElement("tspan",{x:A,dy:B===0?P:l,key:"".concat(L,"-").concat(B)},L)}))});CN.displayName="Text";var jIe=["labelRef"];function _Ie(t,s){if(t==null)return{};var n,a,i=SIe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function SIe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}function uR(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function Tn(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?uR(Object(n),!0).forEach(function(a){CIe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):uR(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function CIe(t,s,n){return(s=kIe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function kIe(t){var s=AIe(t,"string");return typeof s=="symbol"?s:s+""}function AIe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function Eo(){return Eo=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Eo.apply(null,arguments)}var qG=y.createContext(null),EIe=t=>{var{x:s,y:n,upperWidth:a,lowerWidth:i,width:l,height:o,children:c}=t,d=y.useMemo(()=>({x:s,y:n,upperWidth:a,lowerWidth:i,width:l,height:o}),[s,n,a,i,l,o]);return y.createElement(qG.Provider,{value:d},c)},GG=()=>{var t=y.useContext(qG),s=rN();return t||hW(s)},TIe=y.createContext(null),PIe=()=>{var t=y.useContext(TIe),s=Et(Iq);return t||s},IIe=t=>{var{value:s,formatter:n}=t,a=jr(t.children)?s:t.children;return typeof n=="function"?n(a):a},gE=t=>t!=null&&typeof t=="function",MIe=(t,s)=>{var n=Lr(s-t),a=Math.min(Math.abs(s-t),360);return n*a},DIe=(t,s,n,a,i)=>{var{offset:l,className:o}=t,{cx:c,cy:d,innerRadius:u,outerRadius:h,startAngle:f,endAngle:x,clockWise:b}=i,v=(u+h)/2,w=MIe(f,x),_=w>=0?1:-1,S,k;switch(s){case"insideStart":S=f+_*l,k=b;break;case"insideEnd":S=x-_*l,k=!b;break;case"end":S=x+_*l,k=b;break;default:throw new Error("Unsupported position ".concat(s))}k=w<=0?k:!k;var A=Gn(c,d,v,S),T=Gn(c,d,v,S+(k?1:-1)*359),P="M".concat(A.x,",").concat(A.y,`
    A`).concat(v,",").concat(v,",0,1,").concat(k?0:1,`,
    `).concat(T.x,",").concat(T.y),O=jr(t.id)?gx("recharts-radial-line-"):t.id;return y.createElement("text",Eo({},a,{dominantBaseline:"central",className:vs("recharts-radial-bar-label",o)}),y.createElement("defs",null,y.createElement("path",{id:O,d:P})),y.createElement("textPath",{xlinkHref:"#".concat(O)},n))},OIe=(t,s,n)=>{var{cx:a,cy:i,innerRadius:l,outerRadius:o,startAngle:c,endAngle:d}=t,u=(c+d)/2;if(n==="outside"){var{x:h,y:f}=Gn(a,i,o+s,u);return{x:h,y:f,textAnchor:h>=a?"start":"end",verticalAnchor:"middle"}}if(n==="center")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(n==="centerTop")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"start"};if(n==="centerBottom")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"end"};var x=(l+o)/2,{x:b,y:v}=Gn(a,i,x,u);return{x:b,y:v,textAnchor:"middle",verticalAnchor:"middle"}},_C=t=>"cx"in t&&Dt(t.cx),RIe=(t,s)=>{var{parentViewBox:n,offset:a,position:i}=t,l;n!=null&&!_C(n)&&(l=n);var{x:o,y:c,upperWidth:d,lowerWidth:u,height:h}=s,f=o,x=o+(d-u)/2,b=(f+x)/2,v=(d+u)/2,w=f+d/2,_=h>=0?1:-1,S=_*a,k=_>0?"end":"start",A=_>0?"start":"end",T=d>=0?1:-1,P=T*a,O=T>0?"end":"start",D=T>0?"start":"end";if(i==="top"){var I={x:f+d/2,y:c-S,textAnchor:"middle",verticalAnchor:k};return Tn(Tn({},I),l?{height:Math.max(c-l.y,0),width:d}:{})}if(i==="bottom"){var M={x:x+u/2,y:c+h+S,textAnchor:"middle",verticalAnchor:A};return Tn(Tn({},M),l?{height:Math.max(l.y+l.height-(c+h),0),width:u}:{})}if(i==="left"){var B={x:b-P,y:c+h/2,textAnchor:O,verticalAnchor:"middle"};return Tn(Tn({},B),l?{width:Math.max(B.x-l.x,0),height:h}:{})}if(i==="right"){var L={x:b+v+P,y:c+h/2,textAnchor:D,verticalAnchor:"middle"};return Tn(Tn({},L),l?{width:Math.max(l.x+l.width-L.x,0),height:h}:{})}var F=l?{width:v,height:h}:{};return i==="insideLeft"?Tn({x:b+P,y:c+h/2,textAnchor:D,verticalAnchor:"middle"},F):i==="insideRight"?Tn({x:b+v-P,y:c+h/2,textAnchor:O,verticalAnchor:"middle"},F):i==="insideTop"?Tn({x:f+d/2,y:c+S,textAnchor:"middle",verticalAnchor:A},F):i==="insideBottom"?Tn({x:x+u/2,y:c+h-S,textAnchor:"middle",verticalAnchor:k},F):i==="insideTopLeft"?Tn({x:f+P,y:c+S,textAnchor:D,verticalAnchor:A},F):i==="insideTopRight"?Tn({x:f+d-P,y:c+S,textAnchor:O,verticalAnchor:A},F):i==="insideBottomLeft"?Tn({x:x+P,y:c+h-S,textAnchor:D,verticalAnchor:k},F):i==="insideBottomRight"?Tn({x:x+u-P,y:c+h-S,textAnchor:O,verticalAnchor:k},F):i&&typeof i=="object"&&(Dt(i.x)||Go(i.x))&&(Dt(i.y)||Go(i.y))?Tn({x:o+Qr(i.x,v),y:c+Qr(i.y,h),textAnchor:"end",verticalAnchor:"end"},F):Tn({x:w,y:c+h/2,textAnchor:"middle",verticalAnchor:"middle"},F)},LIe={offset:5,zIndex:Xr.label};function kc(t){var s=ba(t,LIe),{viewBox:n,position:a,value:i,children:l,content:o,className:c="",textBreakAll:d,labelRef:u}=s,h=PIe(),f=GG(),x=a==="center"?f:h??f,b,v,w;if(n==null?b=x:_C(n)?b=n:b=hW(n),!b||jr(i)&&jr(l)&&!y.isValidElement(o)&&typeof o!="function")return null;var _=Tn(Tn({},s),{},{viewBox:b});if(y.isValidElement(o)){var{labelRef:S}=_,k=_Ie(_,jIe);return y.cloneElement(o,k)}if(typeof o=="function"){if(v=y.createElement(o,_),y.isValidElement(v))return v}else v=IIe(s);var A=qi(s);if(_C(b)){if(a==="insideStart"||a==="insideEnd"||a==="end")return DIe(s,a,v,A,b);w=OIe(b,s.offset,s.position)}else w=RIe(s,b);return y.createElement(bo,{zIndex:s.zIndex},y.createElement(CN,Eo({ref:u,className:vs("recharts-label",c)},A,w,{textAnchor:yIe(A.textAnchor)?A.textAnchor:w.textAnchor,breakAll:d}),v))}kc.displayName="Label";var BIe=(t,s,n)=>{if(!t)return null;var a={viewBox:s,labelRef:n};return t===!0?y.createElement(kc,Eo({key:"label-implicit"},a)):ho(t)?y.createElement(kc,Eo({key:"label-implicit",value:t},a)):y.isValidElement(t)?t.type===kc?y.cloneElement(t,Tn({key:"label-implicit"},a)):y.createElement(kc,Eo({key:"label-implicit",content:t},a)):gE(t)?y.createElement(kc,Eo({key:"label-implicit",content:t},a)):t&&typeof t=="object"?y.createElement(kc,Eo({},t,{key:"label-implicit"},a)):null};function FIe(t){var{label:s,labelRef:n}=t,a=GG();return BIe(s,a,n)||null}var KG={},YG={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){return n[n.length-1]}t.last=s})(YG);var XG={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){return Array.isArray(n)?n:Array.from(n)}t.toArray=s})(XG);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=YG,n=XG,a=qv;function i(l){if(a.isArrayLike(l))return s.last(n.toArray(l))}t.last=i})(KG);var $Ie=KG.last;const zIe=Yi($Ie);var UIe=["valueAccessor"],VIe=["dataKey","clockWise","id","textBreakAll","zIndex"];function db(){return db=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},db.apply(null,arguments)}function hR(t,s){if(t==null)return{};var n,a,i=HIe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function HIe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}var WIe=t=>Array.isArray(t.value)?zIe(t.value):t.value,QG=y.createContext(void 0),qIe=QG.Provider,ZG=y.createContext(void 0),GIe=ZG.Provider;function KIe(){return y.useContext(QG)}function YIe(){return y.useContext(ZG)}function _y(t){var{valueAccessor:s=WIe}=t,n=hR(t,UIe),{dataKey:a,clockWise:i,id:l,textBreakAll:o,zIndex:c}=n,d=hR(n,VIe),u=KIe(),h=YIe(),f=u||h;return!f||!f.length?null:y.createElement(bo,{zIndex:c??Xr.label},y.createElement(xa,{className:"recharts-label-list"},f.map((x,b)=>{var v,w=jr(a)?s(x,b):mn(x&&x.payload,a),_=jr(l)?{}:{id:"".concat(l,"-").concat(b)};return y.createElement(kc,db({key:"label-".concat(b)},qi(x),d,_,{fill:(v=n.fill)!==null&&v!==void 0?v:x.fill,parentViewBox:x.parentViewBox,value:w,textBreakAll:o,viewBox:x.viewBox,index:b,zIndex:0}))})))}_y.displayName="LabelList";function JG(t){var{label:s}=t;return s?s===!0?y.createElement(_y,{key:"labelList-implicit"}):y.isValidElement(s)||gE(s)?y.createElement(_y,{key:"labelList-implicit",content:s}):typeof s=="object"?y.createElement(_y,db({key:"labelList-implicit"},s,{type:String(s.type)})):null:null}var eK=t=>t.graphicalItems.polarItems,XIe=Pe([ln,o0],UA),kN=Pe([eK,gn,XIe],HA),QIe=Pe([kN],WA),AN=Pe([QIe,TA],qA),ZIe=Pe([AN,gn,kN],KA);Pe([AN,gn,kN],(t,s,n)=>n.length>0?t.flatMap(a=>n.flatMap(i=>{var l,o=mn(a,(l=s.dataKey)!==null&&l!==void 0?l:i.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):(s==null?void 0:s.dataKey)!=null?t.map(a=>({value:mn(a,s.dataKey),errorDomain:[]})):t.map(a=>({value:a,errorDomain:[]})));var mR=()=>{},JIe=Pe([AN,gn,kN,wN,ln],ZA),eMe=Pe([gn,XA,QA,mR,JIe,mR,gs,ln],JA),tK=Pe([gn,gs,AN,ZIe,l0,ln,eMe],eE),tMe=Pe([tK,gn,tf],nE);Pe([gn,tK,tMe,ln],aE);var sMe={radiusAxis:{},angleAxis:{}},sK=Ha({name:"polarAxis",initialState:sMe,reducers:{addRadiusAxis(t,s){t.radiusAxis[s.payload.id]=s.payload},removeRadiusAxis(t,s){delete t.radiusAxis[s.payload.id]},addAngleAxis(t,s){t.angleAxis[s.payload.id]=s.payload},removeAngleAxis(t,s){delete t.angleAxis[s.payload.id]}}}),{addRadiusAxis:_Be,removeRadiusAxis:SBe,addAngleAxis:CBe,removeAngleAxis:kBe}=sK.actions,nMe=sK.reducer;function fR(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function pR(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?fR(Object(n),!0).forEach(function(a){rMe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):fR(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function rMe(t,s,n){return(s=aMe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function aMe(t){var s=iMe(t,"string");return typeof s=="symbol"?s:s+""}function iMe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var lMe=(t,s)=>s,yE=Pe([eK,lMe],(t,s)=>t.filter(n=>n.type==="pie").find(n=>n.id===s)),oMe=[],bE=(t,s,n)=>(n==null?void 0:n.length)===0?oMe:n,nK=Pe([TA,yE,bE],(t,s,n)=>{var{chartData:a}=t;if(s!=null){var i;if((s==null?void 0:s.data)!=null&&s.data.length>0?i=s.data:i=a,(!i||!i.length)&&n!=null&&(i=n.map(l=>pR(pR({},s.presentationProps),l.props))),i!=null)return i}}),cMe=Pe([nK,yE,bE],(t,s,n)=>{if(!(t==null||s==null))return t.map((a,i)=>{var l,o=mn(a,s.nameKey,s.name),c;return n!=null&&(l=n[i])!==null&&l!==void 0&&(l=l.props)!==null&&l!==void 0&&l.fill?c=n[i].props.fill:typeof a=="object"&&a!=null&&"fill"in a?c=a.fill:c=s.fill,{value:Jv(o,s.dataKey),color:c,payload:a,type:s.legendType}})}),dMe=Pe([nK,yE,bE,hr],(t,s,n,a)=>{if(!(s==null||t==null))return hDe({offset:a,pieSettings:s,displayedData:t,cells:n})}),rK={exports:{}},Cs={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cr=typeof Symbol=="function"&&Symbol.for,vE=Cr?Symbol.for("react.element"):60103,NE=Cr?Symbol.for("react.portal"):60106,EN=Cr?Symbol.for("react.fragment"):60107,TN=Cr?Symbol.for("react.strict_mode"):60108,PN=Cr?Symbol.for("react.profiler"):60114,IN=Cr?Symbol.for("react.provider"):60109,MN=Cr?Symbol.for("react.context"):60110,wE=Cr?Symbol.for("react.async_mode"):60111,DN=Cr?Symbol.for("react.concurrent_mode"):60111,ON=Cr?Symbol.for("react.forward_ref"):60112,RN=Cr?Symbol.for("react.suspense"):60113,uMe=Cr?Symbol.for("react.suspense_list"):60120,LN=Cr?Symbol.for("react.memo"):60115,BN=Cr?Symbol.for("react.lazy"):60116,hMe=Cr?Symbol.for("react.block"):60121,mMe=Cr?Symbol.for("react.fundamental"):60117,fMe=Cr?Symbol.for("react.responder"):60118,pMe=Cr?Symbol.for("react.scope"):60119;function Ni(t){if(typeof t=="object"&&t!==null){var s=t.$$typeof;switch(s){case vE:switch(t=t.type,t){case wE:case DN:case EN:case PN:case TN:case RN:return t;default:switch(t=t&&t.$$typeof,t){case MN:case ON:case BN:case LN:case IN:return t;default:return s}}case NE:return s}}}function aK(t){return Ni(t)===DN}Cs.AsyncMode=wE;Cs.ConcurrentMode=DN;Cs.ContextConsumer=MN;Cs.ContextProvider=IN;Cs.Element=vE;Cs.ForwardRef=ON;Cs.Fragment=EN;Cs.Lazy=BN;Cs.Memo=LN;Cs.Portal=NE;Cs.Profiler=PN;Cs.StrictMode=TN;Cs.Suspense=RN;Cs.isAsyncMode=function(t){return aK(t)||Ni(t)===wE};Cs.isConcurrentMode=aK;Cs.isContextConsumer=function(t){return Ni(t)===MN};Cs.isContextProvider=function(t){return Ni(t)===IN};Cs.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===vE};Cs.isForwardRef=function(t){return Ni(t)===ON};Cs.isFragment=function(t){return Ni(t)===EN};Cs.isLazy=function(t){return Ni(t)===BN};Cs.isMemo=function(t){return Ni(t)===LN};Cs.isPortal=function(t){return Ni(t)===NE};Cs.isProfiler=function(t){return Ni(t)===PN};Cs.isStrictMode=function(t){return Ni(t)===TN};Cs.isSuspense=function(t){return Ni(t)===RN};Cs.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===EN||t===DN||t===PN||t===TN||t===RN||t===uMe||typeof t=="object"&&t!==null&&(t.$$typeof===BN||t.$$typeof===LN||t.$$typeof===IN||t.$$typeof===MN||t.$$typeof===ON||t.$$typeof===mMe||t.$$typeof===fMe||t.$$typeof===pMe||t.$$typeof===hMe)};Cs.typeOf=Ni;rK.exports=Cs;var xMe=rK.exports,xR=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",gR=null,Jj=null,iK=t=>{if(t===gR&&Array.isArray(Jj))return Jj;var s=[];return y.Children.forEach(t,n=>{jr(n)||(xMe.isFragment(n)?s=s.concat(iK(n.props.children)):s.push(n))}),Jj=s,gR=t,s};function jE(t,s){var n=[],a=[];return Array.isArray(s)?a=s.map(i=>xR(i)):a=[xR(s)],iK(t).forEach(i=>{var l=Du(i,"type.displayName")||Du(i,"type.name");l&&a.indexOf(l)!==-1&&n.push(i)}),n}var lK={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(n){var i;if(typeof n!="object"||n==null)return!1;if(Object.getPrototypeOf(n)===null)return!0;if(Object.prototype.toString.call(n)!=="[object Object]"){const l=n[Symbol.toStringTag];return l==null||!((i=Object.getOwnPropertyDescriptor(n,Symbol.toStringTag))!=null&&i.writable)?!1:n.toString()===`[object ${l}]`}let a=n;for(;Object.getPrototypeOf(a)!==null;)a=Object.getPrototypeOf(a);return Object.getPrototypeOf(n)===a}t.isPlainObject=s})(lK);var gMe=lK.isPlainObject;const yMe=Yi(gMe);function yR(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function bR(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?yR(Object(n),!0).forEach(function(a){bMe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yR(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function bMe(t,s,n){return(s=vMe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function vMe(t){var s=NMe(t,"string");return typeof s=="symbol"?s:s+""}function NMe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function ub(){return ub=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},ub.apply(null,arguments)}var vR=(t,s,n,a,i)=>{var l=n-a,o;return o="M ".concat(t,",").concat(s),o+="L ".concat(t+n,",").concat(s),o+="L ".concat(t+n-l/2,",").concat(s+i),o+="L ".concat(t+n-l/2-a,",").concat(s+i),o+="L ".concat(t,",").concat(s," Z"),o},wMe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},jMe=t=>{var s=ba(t,wMe),{x:n,y:a,upperWidth:i,lowerWidth:l,height:o,className:c}=s,{animationEasing:d,animationDuration:u,animationBegin:h,isUpdateAnimationActive:f}=s,x=y.useRef(null),[b,v]=y.useState(-1),w=y.useRef(i),_=y.useRef(l),S=y.useRef(o),k=y.useRef(n),A=y.useRef(a),T=oN(t,"trapezoid-");if(y.useEffect(()=>{if(x.current&&x.current.getTotalLength)try{var $=x.current.getTotalLength();$&&v($)}catch{}},[]),n!==+n||a!==+a||i!==+i||l!==+l||o!==+o||i===0&&l===0||o===0)return null;var P=vs("recharts-trapezoid",c);if(!f)return y.createElement("g",null,y.createElement("path",ub({},qi(s),{className:P,d:vR(n,a,i,l,o)})));var O=w.current,D=_.current,I=S.current,M=k.current,B=A.current,L="0px ".concat(b===-1?1:b,"px"),F="".concat(b,"px 0px"),V=gW(["strokeDasharray"],u,d);return y.createElement(lN,{animationId:T,key:T,canBegin:b>0,duration:u,easing:d,isActive:f,begin:h},$=>{var z=tr(O,i,$),H=tr(D,l,$),q=tr(I,o,$),G=tr(M,n,$),re=tr(B,a,$);x.current&&(w.current=z,_.current=H,S.current=q,k.current=G,A.current=re);var ye=$>0?{transition:V,strokeDasharray:F}:{strokeDasharray:L};return y.createElement("path",ub({},qi(s),{className:P,d:vR(G,re,z,H,q),ref:x,style:bR(bR({},ye),s.style)}))})},_Me=["option","shapeType","propTransformer","activeClassName","isActive"];function SMe(t,s){if(t==null)return{};var n,a,i=CMe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function CMe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}function NR(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function hb(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?NR(Object(n),!0).forEach(function(a){kMe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):NR(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function kMe(t,s,n){return(s=AMe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function AMe(t){var s=EMe(t,"string");return typeof s=="symbol"?s:s+""}function EMe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function TMe(t,s){return hb(hb({},s),t)}function PMe(t,s){return t==="symbols"}function wR(t){var{shapeType:s,elementProps:n}=t;switch(s){case"rectangle":return y.createElement(NW,n);case"trapezoid":return y.createElement(jMe,n);case"sector":return y.createElement(SW,n);case"symbols":if(PMe(s))return y.createElement(rH,n);break;case"curve":return y.createElement(iA,n);default:return null}}function IMe(t){return y.isValidElement(t)?t.props:t}function oK(t){var{option:s,shapeType:n,propTransformer:a=TMe,activeClassName:i="recharts-active-shape",isActive:l}=t,o=SMe(t,_Me),c;if(y.isValidElement(s))c=y.cloneElement(s,hb(hb({},o),IMe(s)));else if(typeof s=="function")c=s(o);else if(yMe(s)&&typeof s!="boolean"){var d=a(s,o);c=y.createElement(wR,{shapeType:n,elementProps:d})}else{var u=o;c=y.createElement(wR,{shapeType:n,elementProps:u})}return l?y.createElement(xa,{className:i},c):c}var _E=(t,s)=>{var n=an();return(a,i)=>l=>{t==null||t(a,i,l),n(dG({activeIndex:String(i),activeDataKey:s,activeCoordinate:a.tooltipPosition}))}},SE=t=>{var s=an();return(n,a)=>i=>{t==null||t(n,a,i),s(ZTe())}},CE=(t,s)=>{var n=an();return(a,i)=>l=>{t==null||t(a,i,l),n(JTe({activeIndex:String(i),activeDataKey:s,activeCoordinate:a.tooltipPosition}))}};function cK(t){var{fn:s,args:n}=t,a=an(),i=vi();return y.useLayoutEffect(()=>{if(!i){var l=s(n);return a(YTe(l)),()=>{a(XTe(l))}}},[s,n,a,i]),null}function MMe(t){var{legendPayload:s}=t,n=an(),a=vi();return y.useLayoutEffect(()=>a?Yu:(n(fW(s)),()=>{n(pW(s))}),[n,a,s]),null}function DMe(t){var{legendPayload:s}=t,n=an(),a=Et(gs);return y.useLayoutEffect(()=>a!=="centric"&&a!=="radial"?Yu:(n(fW(s)),()=>{n(pW(s))}),[n,a,s]),null}var e2,OMe=()=>{var[t]=y.useState(()=>gx("uid-"));return t},RMe=(e2=Cb.useId)!==null&&e2!==void 0?e2:OMe;function dK(t,s){var n=RMe();return s||(t?"".concat(t,"-").concat(n):n)}var LMe=y.createContext(void 0),uK=t=>{var{id:s,type:n,children:a}=t,i=dK("recharts-".concat(n),s);return y.createElement(LMe.Provider,{value:i},a(i))},BMe={cartesianItems:[],polarItems:[]},hK=Ha({name:"graphicalItems",initialState:BMe,reducers:{addCartesianGraphicalItem:{reducer(t,s){t.cartesianItems.push(s.payload)},prepare:rr()},replaceCartesianGraphicalItem:{reducer(t,s){var{prev:n,next:a}=s.payload,i=Ro(t).cartesianItems.indexOf(n);i>-1&&(t.cartesianItems[i]=a)},prepare:rr()},removeCartesianGraphicalItem:{reducer(t,s){var n=Ro(t).cartesianItems.indexOf(s.payload);n>-1&&t.cartesianItems.splice(n,1)},prepare:rr()},addPolarGraphicalItem:{reducer(t,s){t.polarItems.push(s.payload)},prepare:rr()},removePolarGraphicalItem:{reducer(t,s){var n=Ro(t).polarItems.indexOf(s.payload);n>-1&&t.polarItems.splice(n,1)},prepare:rr()}}}),{addCartesianGraphicalItem:FMe,replaceCartesianGraphicalItem:$Me,removeCartesianGraphicalItem:zMe,addPolarGraphicalItem:UMe,removePolarGraphicalItem:VMe}=hK.actions,HMe=hK.reducer;function WMe(t){var s=an(),n=y.useRef(null);return y.useLayoutEffect(()=>{n.current===null?s(FMe(t)):n.current!==t&&s($Me({prev:n.current,next:t})),n.current=t},[s,t]),y.useLayoutEffect(()=>()=>{n.current&&(s(zMe(n.current)),n.current=null)},[s]),null}function qMe(t){var s=an();return y.useLayoutEffect(()=>(s(UMe(t)),()=>{s(VMe(t))}),[s,t]),null}var GMe=["onMouseEnter","onClick","onMouseLeave"],KMe=["id"],YMe=["id"];function kE(t,s){if(t==null)return{};var n,a,i=XMe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function XMe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}function jR(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function Zs(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?jR(Object(n),!0).forEach(function(a){QMe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):jR(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function QMe(t,s,n){return(s=ZMe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function ZMe(t){var s=JMe(t,"string");return typeof s=="symbol"?s:s+""}function JMe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function dd(){return dd=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},dd.apply(null,arguments)}function eDe(t){var s=y.useMemo(()=>jE(t.children,Zl),[t.children]),n=Et(a=>cMe(a,t.id,s));return n==null?null:y.createElement(DMe,{legendPayload:n})}function tDe(t){var{dataKey:s,nameKey:n,sectors:a,stroke:i,strokeWidth:l,fill:o,name:c,hide:d,tooltipType:u}=t;return{dataDefinedOnItem:a.map(h=>h.tooltipPayload),positions:a.map(h=>h.tooltipPosition),settings:{stroke:i,strokeWidth:l,fill:o,dataKey:s,nameKey:n,name:Jv(c,s),hide:d,type:u,color:o,unit:""}}}var sDe=(t,s)=>t>s?"start":t<s?"end":"middle",nDe=(t,s,n)=>Qr(typeof s=="function"?s(t):s,n,n*.8),rDe=(t,s,n)=>{var{top:a,left:i,width:l,height:o}=s,c=wW(l,o),d=i+Qr(t.cx,l,l/2),u=a+Qr(t.cy,o,o/2),h=Qr(t.innerRadius,c,0),f=nDe(n,t.outerRadius,c),x=t.maxRadius||Math.sqrt(l*l+o*o)/2;return{cx:d,cy:u,innerRadius:h,outerRadius:f,maxRadius:x}},aDe=(t,s)=>{var n=Lr(s-t),a=Math.min(Math.abs(s-t),360);return n*a};function iDe(t){return t&&typeof t=="object"&&"className"in t&&typeof t.className=="string"?t.className:""}var lDe=(t,s)=>{if(y.isValidElement(t))return y.cloneElement(t,s);if(typeof t=="function")return t(s);var n=vs("recharts-pie-label-line",typeof t!="boolean"?t.className:"");return y.createElement(iA,dd({},s,{type:"linear",className:n}))},oDe=(t,s,n)=>{if(y.isValidElement(t))return y.cloneElement(t,s);var a=n;if(typeof t=="function"&&(a=t(s),y.isValidElement(a)))return a;var i=vs("recharts-pie-label-text",iDe(t));return y.createElement(CN,dd({},s,{alignmentBaseline:"middle",className:i}),a)};function cDe(t){var{sectors:s,props:n,showLabels:a}=t,{label:i,labelLine:l,dataKey:o}=n;if(!a||!i||!s)return null;var c=co(n),d=xx(i),u=xx(l),h=typeof i=="object"&&"offsetRadius"in i&&typeof i.offsetRadius=="number"&&i.offsetRadius||20,f=s.map((x,b)=>{var v=(x.startAngle+x.endAngle)/2,w=Gn(x.cx,x.cy,x.outerRadius+h,v),_=Zs(Zs(Zs(Zs({},c),x),{},{stroke:"none"},d),{},{index:b,textAnchor:sDe(w.x,x.cx)},w),S=Zs(Zs(Zs(Zs({},c),x),{},{fill:"none",stroke:x.fill},u),{},{index:b,points:[Gn(x.cx,x.cy,x.outerRadius,v),w],key:"line"});return y.createElement(bo,{zIndex:Xr.label,key:"label-".concat(x.startAngle,"-").concat(x.endAngle,"-").concat(x.midAngle,"-").concat(b)},y.createElement(xa,null,l&&lDe(l,S),oDe(i,_,mn(x,o))))});return y.createElement(xa,{className:"recharts-pie-labels"},f)}function dDe(t){var{sectors:s,props:n,showLabels:a}=t,{label:i}=n;return typeof i=="object"&&i!=null&&"position"in i?y.createElement(JG,{label:i}):y.createElement(cDe,{sectors:s,props:n,showLabels:a})}function uDe(t){var{sectors:s,activeShape:n,inactiveShape:a,allOtherPieProps:i}=t,l=Et(Fu),{onMouseEnter:o,onClick:c,onMouseLeave:d}=i,u=kE(i,GMe),h=_E(o,i.dataKey),f=SE(d),x=CE(c,i.dataKey);return s==null||s.length===0?null:y.createElement(y.Fragment,null,s.map((b,v)=>{if((b==null?void 0:b.startAngle)===0&&(b==null?void 0:b.endAngle)===0&&s.length!==1)return null;var w=n&&String(v)===l,_=l?a:null,S=w?n:_,k=Zs(Zs({},b),{},{stroke:b.stroke,tabIndex:-1,[rW]:v,[aW]:i.dataKey});return y.createElement(xa,dd({key:"sector-".concat(b==null?void 0:b.startAngle,"-").concat(b==null?void 0:b.endAngle,"-").concat(b.midAngle,"-").concat(v),tabIndex:-1,className:"recharts-pie-sector"},Wv(u,b,v),{onMouseEnter:h(b,v),onMouseLeave:f(b,v),onClick:x(b,v)}),y.createElement(oK,dd({option:S,isActive:w,shapeType:"sector"},k)))}))}function hDe(t){var s,{pieSettings:n,displayedData:a,cells:i,offset:l}=t,{cornerRadius:o,startAngle:c,endAngle:d,dataKey:u,nameKey:h,tooltipType:f}=n,x=Math.abs(n.minAngle),b=aDe(c,d),v=Math.abs(b),w=a.length<=1?0:(s=n.paddingAngle)!==null&&s!==void 0?s:0,_=a.filter(O=>mn(O,u,0)!==0).length,S=(v>=360?_:_-1)*w,k=v-_*x-S,A=a.reduce((O,D)=>{var I=mn(D,u,0);return O+(Dt(I)?I:0)},0),T;if(A>0){var P;T=a.map((O,D)=>{var I=mn(O,u,0),M=mn(O,h,D),B=rDe(n,l,O),L=(Dt(I)?I:0)/A,F,V=Zs(Zs({},O),i&&i[D]&&i[D].props);D?F=P.endAngle+Lr(b)*w*(I!==0?1:0):F=c;var $=F+Lr(b)*((I!==0?x:0)+L*k),z=(F+$)/2,H=(B.innerRadius+B.outerRadius)/2,q=[{name:M,value:I,payload:V,dataKey:u,type:f}],G=Gn(B.cx,B.cy,H,z);return P=Zs(Zs(Zs(Zs({},n.presentationProps),{},{percent:L,cornerRadius:typeof o=="string"?parseFloat(o):o,name:M,tooltipPayload:q,midAngle:z,middleRadius:H,tooltipPosition:G},V),B),{},{value:I,startAngle:F,endAngle:$,payload:V,paddingAngle:Lr(b)*w}),P})}return T}function mDe(t){var{showLabels:s,sectors:n,children:a}=t,i=y.useMemo(()=>!s||!n?[]:n.map(l=>({value:l.value,payload:l.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:l.cx,cy:l.cy,innerRadius:l.innerRadius,outerRadius:l.outerRadius,startAngle:l.startAngle,endAngle:l.endAngle,clockWise:!1},fill:l.fill})),[n,s]);return y.createElement(GIe,{value:s?i:void 0},a)}function fDe(t){var{props:s,previousSectorsRef:n}=t,{sectors:a,isAnimationActive:i,animationBegin:l,animationDuration:o,animationEasing:c,activeShape:d,inactiveShape:u,onAnimationStart:h,onAnimationEnd:f}=s,x=oN(s,"recharts-pie-"),b=n.current,[v,w]=y.useState(!1),_=y.useCallback(()=>{typeof f=="function"&&f(),w(!1)},[f]),S=y.useCallback(()=>{typeof h=="function"&&h(),w(!0)},[h]);return y.createElement(mDe,{showLabels:!v,sectors:a},y.createElement(lN,{animationId:x,begin:l,duration:o,isActive:i,easing:c,onAnimationStart:S,onAnimationEnd:_,key:x},k=>{var A=[],T=a&&a[0],P=T==null?void 0:T.startAngle;return a==null||a.forEach((O,D)=>{var I=b&&b[D],M=D>0?Du(O,"paddingAngle",0):0;if(I){var B=tr(I.endAngle-I.startAngle,O.endAngle-O.startAngle,k),L=Zs(Zs({},O),{},{startAngle:P+M,endAngle:P+B+M});A.push(L),P=L.endAngle}else{var{endAngle:F,startAngle:V}=O,$=tr(0,F-V,k),z=Zs(Zs({},O),{},{startAngle:P+M,endAngle:P+$+M});A.push(z),P=z.endAngle}}),n.current=A,y.createElement(xa,null,y.createElement(uDe,{sectors:A,activeShape:d,inactiveShape:u,allOtherPieProps:s}))}),y.createElement(dDe,{showLabels:!v,sectors:a,props:s}),s.children)}var pDe={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!Qu.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:Xr.area};function xDe(t){var{id:s}=t,n=kE(t,KMe),{hide:a,className:i,rootTabIndex:l}=t,o=y.useMemo(()=>jE(t.children,Zl),[t.children]),c=Et(h=>dMe(h,s,o)),d=y.useRef(null),u=vs("recharts-pie",i);return a||c==null?(d.current=null,y.createElement(xa,{tabIndex:l,className:u})):y.createElement(bo,{zIndex:t.zIndex},y.createElement(cK,{fn:tDe,args:Zs(Zs({},t),{},{sectors:c})}),y.createElement(xa,{tabIndex:l,className:u},y.createElement(fDe,{props:Zs(Zs({},n),{},{sectors:c}),previousSectorsRef:d})))}function mb(t){var s=ba(t,pDe),{id:n}=s,a=kE(s,YMe),i=co(a);return y.createElement(uK,{id:n,type:"pie"},l=>y.createElement(y.Fragment,null,y.createElement(qMe,{type:"pie",id:l,data:a.data,dataKey:a.dataKey,hide:a.hide,angleAxisId:0,radiusAxisId:0,name:a.name,nameKey:a.nameKey,tooltipType:a.tooltipType,legendType:a.legendType,fill:a.fill,cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,paddingAngle:a.paddingAngle,minAngle:a.minAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius,cornerRadius:a.cornerRadius,presentationProps:i,maxRadius:s.maxRadius}),y.createElement(eDe,dd({},a,{id:l})),y.createElement(xDe,dd({},a,{id:l}))))}mb.displayName="Pie";function _R(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function SR(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?_R(Object(n),!0).forEach(function(a){gDe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_R(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function gDe(t,s,n){return(s=yDe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function yDe(t){var s=bDe(t,"string");return typeof s=="symbol"?s:s+""}function bDe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var vDe={xAxis:{},yAxis:{},zAxis:{}},mK=Ha({name:"cartesianAxis",initialState:vDe,reducers:{addXAxis:{reducer(t,s){t.xAxis[s.payload.id]=s.payload},prepare:rr()},removeXAxis:{reducer(t,s){delete t.xAxis[s.payload.id]},prepare:rr()},addYAxis:{reducer(t,s){t.yAxis[s.payload.id]=s.payload},prepare:rr()},removeYAxis:{reducer(t,s){delete t.yAxis[s.payload.id]},prepare:rr()},addZAxis:{reducer(t,s){t.zAxis[s.payload.id]=s.payload},prepare:rr()},removeZAxis:{reducer(t,s){delete t.zAxis[s.payload.id]},prepare:rr()},updateYAxisWidth(t,s){var{id:n,width:a}=s.payload,i=t.yAxis[n];if(i){var l=i.widthHistory||[];if(l.length===3&&l[0]===l[2]&&a===l[1]&&a!==i.width&&Math.abs(a-l[0])<=1)return;var o=[...l,a].slice(-3);t.yAxis[n]=SR(SR({},t.yAxis[n]),{},{width:a,widthHistory:o})}}}}),{addXAxis:NDe,removeXAxis:wDe,addYAxis:jDe,removeYAxis:_De,addZAxis:ABe,removeZAxis:EBe,updateYAxisWidth:SDe}=mK.actions,CDe=mK.reducer,kDe=Pe([hr],t=>({top:t.top,bottom:t.bottom,left:t.left,right:t.right})),ADe=Pe([kDe,nc,rc],(t,s,n)=>{if(!(!t||s==null||n==null))return{x:t.left,y:t.top,width:Math.max(0,s-t.left-t.right),height:Math.max(0,n-t.top-t.bottom)}}),fK=()=>Et(ADe),EDe="Invariant failed";function TDe(t,s){throw new Error(EDe)}var PDe=["x","y"];function SC(){return SC=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},SC.apply(null,arguments)}function CR(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function Ff(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?CR(Object(n),!0).forEach(function(a){IDe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):CR(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function IDe(t,s,n){return(s=MDe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function MDe(t){var s=DDe(t,"string");return typeof s=="symbol"?s:s+""}function DDe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function ODe(t,s){if(t==null)return{};var n,a,i=RDe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function RDe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}function LDe(t,s){var{x:n,y:a}=t,i=ODe(t,PDe),l="".concat(n),o=parseInt(l,10),c="".concat(a),d=parseInt(c,10),u="".concat(s.height||i.height),h=parseInt(u,10),f="".concat(s.width||i.width),x=parseInt(f,10);return Ff(Ff(Ff(Ff(Ff({},s),i),o?{x:o}:{}),d?{y:d}:{}),{},{height:h,width:x,name:s.name,radius:s.radius})}function fb(t){return y.createElement(oK,SC({shapeType:"rectangle",propTransformer:LDe,activeClassName:"recharts-active-bar"},t))}var BDe=function(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(a,i)=>{if(Dt(s))return s;var l=Dt(a)||jr(a);return l?s(a,i):(l||TDe(),n)}},FDe={},pK=Ha({name:"errorBars",initialState:FDe,reducers:{addErrorBar:(t,s)=>{var{itemId:n,errorBar:a}=s.payload;t[n]||(t[n]=[]),t[n].push(a)},replaceErrorBar:(t,s)=>{var{itemId:n,prev:a,next:i}=s.payload;t[n]&&(t[n]=t[n].map(l=>l.dataKey===a.dataKey&&l.direction===a.direction?i:l))},removeErrorBar:(t,s)=>{var{itemId:n,errorBar:a}=s.payload;t[n]&&(t[n]=t[n].filter(i=>i.dataKey!==a.dataKey||i.direction!==a.direction))}}}),{addErrorBar:TBe,replaceErrorBar:PBe,removeErrorBar:IBe}=pK.actions,$De=pK.reducer,zDe=["children"];function UDe(t,s){if(t==null)return{};var n,a,i=VDe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function VDe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}var HDe={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},WDe=y.createContext(HDe);function qDe(t){var{children:s}=t,n=UDe(t,zDe);return y.createElement(WDe.Provider,{value:n},s)}function xK(t,s){var n,a,i=Et(u=>ic(u,t)),l=Et(u=>lc(u,s)),o=(n=i==null?void 0:i.allowDataOverflow)!==null&&n!==void 0?n:Za.allowDataOverflow,c=(a=l==null?void 0:l.allowDataOverflow)!==null&&a!==void 0?a:Ja.allowDataOverflow,d=o||c;return{needClip:d,needClipX:o,needClipY:c}}function GDe(t){var{xAxisId:s,yAxisId:n,clipPathId:a}=t,i=fK(),{needClipX:l,needClipY:o,needClip:c}=xK(s,n);if(!c||!i)return null;var{x:d,y:u,width:h,height:f}=i;return y.createElement("clipPath",{id:"clipPath-".concat(a)},y.createElement("rect",{x:l?d:d-h/2,y:o?u:u-f/2,width:l?h:h*2,height:o?f:f*2}))}function KDe(t,s){return t&&typeof t=="object"&&"zIndex"in t&&typeof t.zIndex=="number"&&Rn(t.zIndex)?t.zIndex:s}var YDe=["onMouseEnter","onMouseLeave","onClick"],XDe=["value","background","tooltipPosition"],QDe=["id"],ZDe=["onMouseEnter","onClick","onMouseLeave"];function Jo(){return Jo=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Jo.apply(null,arguments)}function kR(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function ca(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?kR(Object(n),!0).forEach(function(a){JDe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kR(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function JDe(t,s,n){return(s=eOe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function eOe(t){var s=tOe(t,"string");return typeof s=="symbol"?s:s+""}function tOe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function pb(t,s){if(t==null)return{};var n,a,i=sOe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function sOe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}var nOe=t=>{var{dataKey:s,name:n,fill:a,legendType:i,hide:l}=t;return[{inactive:l,dataKey:s,type:i,color:a,value:Jv(n,s),payload:t}]};function rOe(t){var{dataKey:s,stroke:n,strokeWidth:a,fill:i,name:l,hide:o,unit:c}=t;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:n,strokeWidth:a,fill:i,dataKey:s,nameKey:void 0,name:Jv(l,s),hide:o,type:t.tooltipType,color:t.fill,unit:c}}}function aOe(t){var s=Et(Fu),{data:n,dataKey:a,background:i,allOtherBarProps:l}=t,{onMouseEnter:o,onMouseLeave:c,onClick:d}=l,u=pb(l,YDe),h=_E(o,a),f=SE(c),x=CE(d,a);if(!i||n==null)return null;var b=xx(i);return y.createElement(bo,{zIndex:KDe(i,Xr.barBackground)},n.map((v,w)=>{var{value:_,background:S,tooltipPosition:k}=v,A=pb(v,XDe);if(!S)return null;var T=h(v,w),P=f(v,w),O=x(v,w),D=ca(ca(ca(ca(ca({option:i,isActive:String(w)===s},A),{},{fill:"#eee"},S),b),Wv(u,v,w)),{},{onMouseEnter:T,onMouseLeave:P,onClick:O,dataKey:a,index:w,className:"recharts-bar-background-rectangle"});return y.createElement(fb,Jo({key:"background-bar-".concat(w)},D))}))}function iOe(t){var{showLabels:s,children:n,rects:a}=t,i=a==null?void 0:a.map(l=>{var o={x:l.x,y:l.y,width:l.width,lowerWidth:l.width,upperWidth:l.width,height:l.height};return ca(ca({},o),{},{value:l.value,payload:l.payload,parentViewBox:l.parentViewBox,viewBox:o,fill:l.fill})});return y.createElement(qIe,{value:s?i:void 0},n)}function lOe(t){var{shape:s,activeBar:n,baseProps:a,entry:i,index:l,dataKey:o}=t,c=Et(Fu),d=Et(SG),u=n&&String(l)===c&&(d==null||o===d),h=u?n:s;return u?y.createElement(bo,{zIndex:Xr.activeBar},y.createElement(fb,Jo({},a,{name:String(a.name)},i,{isActive:u,option:h,index:l,dataKey:o}))):y.createElement(fb,Jo({},a,{name:String(a.name)},i,{isActive:u,option:h,index:l,dataKey:o}))}function oOe(t){var{shape:s,baseProps:n,entry:a,index:i,dataKey:l}=t;return y.createElement(fb,Jo({},n,{name:String(n.name)},a,{isActive:!1,option:s,index:i,dataKey:l}))}function cOe(t){var s,{data:n,props:a}=t,i=(s=co(a))!==null&&s!==void 0?s:{},{id:l}=i,o=pb(i,QDe),{shape:c,dataKey:d,activeBar:u}=a,{onMouseEnter:h,onClick:f,onMouseLeave:x}=a,b=pb(a,ZDe),v=_E(h,d),w=SE(x),_=CE(f,d);return n?y.createElement(y.Fragment,null,n.map((S,k)=>y.createElement(xa,Jo({key:"rectangle-".concat(S==null?void 0:S.x,"-").concat(S==null?void 0:S.y,"-").concat(S==null?void 0:S.value,"-").concat(k),className:"recharts-bar-rectangle"},Wv(b,S,k),{onMouseEnter:v(S,k),onMouseLeave:w(S,k),onClick:_(S,k)}),u?y.createElement(lOe,{shape:c,activeBar:u,baseProps:o,entry:S,index:k,dataKey:d}):y.createElement(oOe,{shape:c,baseProps:o,entry:S,index:k,dataKey:d})))):null}function dOe(t){var{props:s,previousRectanglesRef:n}=t,{data:a,layout:i,isAnimationActive:l,animationBegin:o,animationDuration:c,animationEasing:d,onAnimationEnd:u,onAnimationStart:h}=s,f=n.current,x=oN(s,"recharts-bar-"),[b,v]=y.useState(!1),w=!b,_=y.useCallback(()=>{typeof u=="function"&&u(),v(!1)},[u]),S=y.useCallback(()=>{typeof h=="function"&&h(),v(!0)},[h]);return y.createElement(iOe,{showLabels:w,rects:a},y.createElement(lN,{animationId:x,begin:o,duration:c,isActive:l,easing:d,onAnimationEnd:_,onAnimationStart:S,key:x},k=>{var A=k===1?a:a==null?void 0:a.map((T,P)=>{var O=f&&f[P];if(O)return ca(ca({},T),{},{x:tr(O.x,T.x,k),y:tr(O.y,T.y,k),width:tr(O.width,T.width,k),height:tr(O.height,T.height,k)});if(i==="horizontal"){var D=tr(0,T.height,k),I=tr(T.stackedBarStart,T.y,k);return ca(ca({},T),{},{y:I,height:D})}var M=tr(0,T.width,k),B=tr(T.stackedBarStart,T.x,k);return ca(ca({},T),{},{width:M,x:B})});return k>0&&(n.current=A??null),A==null?null:y.createElement(xa,null,y.createElement(cOe,{props:s,data:A}))}),y.createElement(JG,{label:s.label}),s.children)}function uOe(t){var s=y.useRef(null);return y.createElement(dOe,{previousRectanglesRef:s,props:t})}var gK=0,hOe=(t,s)=>{var n=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:n,errorVal:mn(t,s)}};class mOe extends y.PureComponent{render(){var{hide:s,data:n,dataKey:a,className:i,xAxisId:l,yAxisId:o,needClip:c,background:d,id:u}=this.props;if(s||n==null)return null;var h=vs("recharts-bar",i),f=u;return y.createElement(xa,{className:h,id:u},c&&y.createElement("defs",null,y.createElement(GDe,{clipPathId:f,xAxisId:l,yAxisId:o})),y.createElement(xa,{className:"recharts-bar-rectangles",clipPath:c?"url(#clipPath-".concat(f,")"):void 0},y.createElement(aOe,{data:n,dataKey:a,background:d,allOtherBarProps:this.props}),y.createElement(uOe,this.props)))}}var fOe={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!Qu.isSsr,legendType:"rect",minPointSize:gK,xAxisId:0,yAxisId:0,zIndex:Xr.bar};function pOe(t){var{xAxisId:s,yAxisId:n,hide:a,legendType:i,minPointSize:l,activeBar:o,animationBegin:c,animationDuration:d,animationEasing:u,isAnimationActive:h}=t,{needClip:f}=xK(s,n),x=aN(),b=vi(),v=jE(t.children,Zl),w=Et(k=>VOe(k,s,n,b,t.id,v));if(x!=="vertical"&&x!=="horizontal")return null;var _,S=w==null?void 0:w[0];return S==null||S.height==null||S.width==null?_=0:_=x==="vertical"?S.height/2:S.width/2,y.createElement(qDe,{xAxisId:s,yAxisId:n,data:w,dataPointFormatter:hOe,errorBarOffset:_},y.createElement(mOe,Jo({},t,{layout:x,needClip:f,data:w,xAxisId:s,yAxisId:n,hide:a,legendType:i,minPointSize:l,activeBar:o,animationBegin:c,animationDuration:d,animationEasing:u,isAnimationActive:h})))}function xOe(t){var{layout:s,barSettings:{dataKey:n,minPointSize:a},pos:i,bandSize:l,xAxis:o,yAxis:c,xAxisTicks:d,yAxisTicks:u,stackedData:h,displayedData:f,offset:x,cells:b,parentViewBox:v,dataStartIndex:w}=t,_=s==="horizontal"?c:o,S=h?_.scale.domain():null,k=s3e({numericAxis:_}),A=_.scale(k);return f.map((T,P)=>{var O,D,I,M,B,L;h?O=XCe(h[P+w],S):(O=mn(T,n),Array.isArray(O)||(O=[k,O]));var F=BDe(a,gK)(O[1],P);if(s==="horizontal"){var V,[$,z]=[c.scale(O[0]),c.scale(O[1])];D=ND({axis:o,ticks:d,bandSize:l,offset:i.offset,entry:T,index:P}),I=(V=z??$)!==null&&V!==void 0?V:void 0,M=i.size;var H=$-z;if(B=uo(H)?0:H,L={x:D,y:x.top,width:M,height:x.height},Math.abs(F)>0&&Math.abs(B)<Math.abs(F)){var q=Lr(B||F)*(Math.abs(F)-Math.abs(B));I-=q,B+=q}}else{var[G,re]=[o.scale(O[0]),o.scale(O[1])];if(D=G,I=ND({axis:c,ticks:u,bandSize:l,offset:i.offset,entry:T,index:P}),M=re-G,B=i.size,L={x:x.left,y:I,width:x.width,height:B},Math.abs(F)>0&&Math.abs(M)<Math.abs(F)){var ye=Lr(M||F)*(Math.abs(F)-Math.abs(M));M+=ye}}if(D==null||I==null||M==null||B==null)return null;var Ee=ca(ca({},T),{},{stackedBarStart:A,x:D,y:I,width:M,height:B,value:h?O:O[1],payload:T,background:L,tooltipPosition:{x:D+M/2,y:I+B/2},parentViewBox:v},b&&b[P]&&b[P].props);return Ee}).filter(Boolean)}function gOe(t){var s=ba(t,fOe),n=vi();return y.createElement(uK,{id:s.id,type:"bar"},a=>y.createElement(y.Fragment,null,y.createElement(MMe,{legendPayload:nOe(s)}),y.createElement(cK,{fn:rOe,args:s}),y.createElement(WMe,{type:"bar",id:a,data:void 0,xAxisId:s.xAxisId,yAxisId:s.yAxisId,zAxisId:0,dataKey:s.dataKey,stackId:t3e(s.stackId),hide:s.hide,barSize:s.barSize,minPointSize:s.minPointSize,maxBarSize:s.maxBarSize,isPanorama:n}),y.createElement(bo,{zIndex:s.zIndex},y.createElement(pOe,Jo({},s,{id:a})))))}var Ax=y.memo(gOe);Ax.displayName="Bar";function AR(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function Og(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?AR(Object(n),!0).forEach(function(a){yOe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):AR(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function yOe(t,s,n){return(s=bOe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function bOe(t){var s=vOe(t,"string");return typeof s=="symbol"?s:s+""}function vOe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var NOe=(t,s)=>s,wOe=(t,s,n)=>n,jOe=(t,s,n,a)=>a,_Oe=(t,s,n,a,i)=>i,f0=Pe([VA,_Oe],(t,s)=>t.filter(n=>n.type==="bar").find(n=>n.id===s)),SOe=Pe([f0],t=>t==null?void 0:t.maxBarSize),COe=(t,s,n,a,i,l)=>l,ER=(t,s,n)=>{var a=n??t;if(!jr(a))return Qr(a,s,0)},kOe=Pe([gs,VA,NOe,wOe,jOe],(t,s,n,a,i)=>s.filter(l=>t==="horizontal"?l.xAxisId===n:l.yAxisId===a).filter(l=>l.isPanorama===i).filter(l=>l.hide===!1).filter(l=>l.type==="bar")),AOe=(t,s,n,a)=>{var i=gs(t);return i==="horizontal"?yC(t,"yAxis",n,a):yC(t,"xAxis",s,a)},EOe=(t,s,n)=>{var a=gs(t);return a==="horizontal"?FO(t,"xAxis",s):FO(t,"yAxis",n)},TOe=(t,s,n)=>{var a={},i=t.filter(yN),l=t.filter(u=>u.stackId==null),o=i.reduce((u,h)=>(u[h.stackId]||(u[h.stackId]=[]),u[h.stackId].push(h),u),a),c=Object.entries(o).map(u=>{var[h,f]=u,x=f.map(v=>v.dataKey),b=ER(s,n,f[0].barSize);return{stackId:h,dataKeys:x,barSize:b}}),d=l.map(u=>{var h=[u.dataKey].filter(x=>x!=null),f=ER(s,n,u.barSize);return{stackId:void 0,dataKeys:h,barSize:f}});return[...c,...d]},POe=Pe([kOe,UEe,EOe],TOe),IOe=(t,s,n,a,i)=>{var l,o,c=f0(t,s,n,a,i);if(c!=null){var d=gs(t),u=Sq(t),{maxBarSize:h}=c,f=jr(h)?u:h,x,b;return d==="horizontal"?(x=Cm(t,"xAxis",s,a),b=Sm(t,"xAxis",s,a)):(x=Cm(t,"yAxis",n,a),b=Sm(t,"yAxis",n,a)),(l=(o=W1(x,b,!0))!==null&&o!==void 0?o:f)!==null&&l!==void 0?l:0}},yK=(t,s,n,a)=>{var i=gs(t),l,o;return i==="horizontal"?(l=Cm(t,"xAxis",s,a),o=Sm(t,"xAxis",s,a)):(l=Cm(t,"yAxis",n,a),o=Sm(t,"yAxis",n,a)),W1(l,o)};function MOe(t,s,n,a,i){var l=a.length;if(!(l<1)){var o=Qr(t,n,0,!0),c,d=[];if(Rn(a[0].barSize)){var u=!1,h=n/l,f=a.reduce((S,k)=>S+(k.barSize||0),0);f+=(l-1)*o,f>=n&&(f-=(l-1)*o,o=0),f>=n&&h>0&&(u=!0,h*=.9,f=l*h);var x=(n-f)/2>>0,b={offset:x-o,size:0};c=a.reduce((S,k)=>{var A,T={stackId:k.stackId,dataKeys:k.dataKeys,position:{offset:b.offset+b.size+o,size:u?h:(A=k.barSize)!==null&&A!==void 0?A:0}},P=[...S,T];return b=P[P.length-1].position,P},d)}else{var v=Qr(s,n,0,!0);n-2*v-(l-1)*o<=0&&(o=0);var w=(n-2*v-(l-1)*o)/l;w>1&&(w>>=0);var _=Rn(i)?Math.min(w,i):w;c=a.reduce((S,k,A)=>[...S,{stackId:k.stackId,dataKeys:k.dataKeys,position:{offset:v+(w+o)*A+(w-_)/2,size:_}}],d)}return c}}var DOe=(t,s,n,a,i,l,o)=>{var c=jr(o)?s:o,d=MOe(n,a,i!==l?i:l,t,c);return i!==l&&d!=null&&(d=d.map(u=>Og(Og({},u),{},{position:Og(Og({},u.position),{},{offset:u.position.offset-i/2})}))),d},OOe=Pe([POe,Sq,zEe,Cq,IOe,yK,SOe],DOe),ROe=(t,s,n,a)=>Cm(t,"xAxis",s,a),LOe=(t,s,n,a)=>Cm(t,"yAxis",n,a),BOe=(t,s,n,a)=>Sm(t,"xAxis",s,a),FOe=(t,s,n,a)=>Sm(t,"yAxis",n,a),$Oe=Pe([OOe,f0],(t,s)=>{if(!(t==null||s==null)){var n=t.find(a=>a.stackId===s.stackId&&s.dataKey!=null&&a.dataKeys.includes(s.dataKey));if(n!=null)return n.position}}),zOe=(t,s)=>{var n=$A(s);if(!(!t||n==null||s==null)){var{stackId:a}=s;if(a!=null){var i=t[a];if(i){var{stackedData:l}=i;if(l)return l.find(o=>o.key===n)}}}},UOe=Pe([AOe,f0],zOe),VOe=Pe([hr,rA,ROe,LOe,BOe,FOe,$Oe,gs,PA,yK,UOe,f0,COe],(t,s,n,a,i,l,o,c,d,u,h,f,x)=>{var{chartData:b,dataStartIndex:v,dataEndIndex:w}=d;if(!(f==null||o==null||s==null||c!=="horizontal"&&c!=="vertical"||n==null||a==null||i==null||l==null||u==null)){var{data:_}=f,S;if(_!=null&&_.length>0?S=_:S=b==null?void 0:b.slice(v,w+1),S!=null)return xOe({layout:c,barSettings:f,pos:o,parentViewBox:s,bandSize:u,xAxis:n,yAxis:a,xAxisTicks:i,yAxisTicks:l,stackedData:h,displayedData:S,offset:t,cells:x,dataStartIndex:v})}}),bK=t=>{var{chartData:s}=t,n=an(),a=vi();return y.useEffect(()=>a?()=>{}:(n(XO(s)),()=>{n(XO(void 0))}),[s,n,a]),null},TR={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},vK=Ha({name:"brush",initialState:TR,reducers:{setBrushSettings(t,s){return s.payload==null?TR:s.payload}}}),{setBrushSettings:MBe}=vK.actions,HOe=vK.reducer;function WOe(t,s,n){return(s=qOe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function qOe(t){var s=GOe(t,"string");return typeof s=="symbol"?s:s+""}function GOe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}class AE{static create(s){return new AE(s)}constructor(s){this.scale=s}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(s){var{bandAware:n,position:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(s!==void 0){if(a)switch(a){case"start":return this.scale(s);case"middle":{var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(s)+i}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(s)+l}default:return this.scale(s)}if(n){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(s)+o}return this.scale(s)}}isInRange(s){var n=this.range(),a=n[0],i=n[n.length-1];return a<=i?s>=a&&s<=i:s>=i&&s<=a}}WOe(AE,"EPS",1e-4);function KOe(t){return(t%180+180)%180}var YOe=function(s){var{width:n,height:a}=s,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,l=KOe(i),o=l*Math.PI/180,c=Math.atan(a/n),d=o>c&&o<Math.PI-c?a/Math.sin(o):n/Math.cos(o);return Math.abs(d)},XOe={dots:[],areas:[],lines:[]},NK=Ha({name:"referenceElements",initialState:XOe,reducers:{addDot:(t,s)=>{t.dots.push(s.payload)},removeDot:(t,s)=>{var n=Ro(t).dots.findIndex(a=>a===s.payload);n!==-1&&t.dots.splice(n,1)},addArea:(t,s)=>{t.areas.push(s.payload)},removeArea:(t,s)=>{var n=Ro(t).areas.findIndex(a=>a===s.payload);n!==-1&&t.areas.splice(n,1)},addLine:(t,s)=>{t.lines.push(s.payload)},removeLine:(t,s)=>{var n=Ro(t).lines.findIndex(a=>a===s.payload);n!==-1&&t.lines.splice(n,1)}}}),{addDot:DBe,removeDot:OBe,addArea:RBe,removeArea:LBe,addLine:BBe,removeLine:FBe}=NK.actions,QOe=NK.reducer,ZOe=y.createContext(void 0),JOe=t=>{var{children:s}=t,[n]=y.useState("".concat(gx("recharts"),"-clip")),a=fK();if(a==null)return null;var{x:i,y:l,width:o,height:c}=a;return y.createElement(ZOe.Provider,{value:n},y.createElement("defs",null,y.createElement("clipPath",{id:n},y.createElement("rect",{x:i,y:l,height:c,width:o}))),s)};function km(t,s){for(var n in t)if({}.hasOwnProperty.call(t,n)&&(!{}.hasOwnProperty.call(s,n)||t[n]!==s[n]))return!1;for(var a in s)if({}.hasOwnProperty.call(s,a)&&!{}.hasOwnProperty.call(t,a))return!1;return!0}function wK(t,s){if(s<1)return[];if(s===1)return t;for(var n=[],a=0;a<t.length;a+=s)n.push(t[a]);return n}function eRe(t,s,n){var a={width:t.width+s.width,height:t.height+s.height};return YOe(a,n)}function tRe(t,s,n){var a=n==="width",{x:i,y:l,width:o,height:c}=t;return s===1?{start:a?i:l,end:a?i+o:l+c}:{start:a?i+o:l+c,end:a?i:l}}function xb(t,s,n,a,i){if(t*s<t*a||t*s>t*i)return!1;var l=n();return t*(s-t*l/2-a)>=0&&t*(s+t*l/2-i)<=0}function sRe(t,s){return wK(t,s+1)}function nRe(t,s,n,a,i){for(var l=(a||[]).slice(),{start:o,end:c}=s,d=0,u=1,h=o,f=function(){var v=a==null?void 0:a[d];if(v===void 0)return{v:wK(a,u)};var w=d,_,S=()=>(_===void 0&&(_=n(v,w)),_),k=v.coordinate,A=d===0||xb(t,k,S,h,c);A||(d=0,h=o,u+=1),A&&(h=k+t*(S()/2+i),d+=u)},x;u<=l.length;)if(x=f(),x)return x.v;return[]}function PR(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function Wr(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?PR(Object(n),!0).forEach(function(a){rRe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):PR(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function rRe(t,s,n){return(s=aRe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function aRe(t){var s=iRe(t,"string");return typeof s=="symbol"?s:s+""}function iRe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function lRe(t,s,n,a,i){for(var l=(a||[]).slice(),o=l.length,{start:c}=s,{end:d}=s,u=function(x){var b=l[x],v,w=()=>(v===void 0&&(v=n(b,x)),v);if(x===o-1){var _=t*(b.coordinate+t*w()/2-d);l[x]=b=Wr(Wr({},b),{},{tickCoord:_>0?b.coordinate-_*t:b.coordinate})}else l[x]=b=Wr(Wr({},b),{},{tickCoord:b.coordinate});if(b.tickCoord!=null){var S=xb(t,b.tickCoord,w,c,d);S&&(d=b.tickCoord-t*(w()/2+i),l[x]=Wr(Wr({},b),{},{isShow:!0}))}},h=o-1;h>=0;h--)u(h);return l}function oRe(t,s,n,a,i,l){var o=(a||[]).slice(),c=o.length,{start:d,end:u}=s;if(l){var h=a[c-1],f=n(h,c-1),x=t*(h.coordinate+t*f/2-u);if(o[c-1]=h=Wr(Wr({},h),{},{tickCoord:x>0?h.coordinate-x*t:h.coordinate}),h.tickCoord!=null){var b=xb(t,h.tickCoord,()=>f,d,u);b&&(u=h.tickCoord-t*(f/2+i),o[c-1]=Wr(Wr({},h),{},{isShow:!0}))}}for(var v=l?c-1:c,w=function(k){var A=o[k],T,P=()=>(T===void 0&&(T=n(A,k)),T);if(k===0){var O=t*(A.coordinate-t*P()/2-d);o[k]=A=Wr(Wr({},A),{},{tickCoord:O<0?A.coordinate-O*t:A.coordinate})}else o[k]=A=Wr(Wr({},A),{},{tickCoord:A.coordinate});if(A.tickCoord!=null){var D=xb(t,A.tickCoord,P,d,u);D&&(d=A.tickCoord+t*(P()/2+i),o[k]=Wr(Wr({},A),{},{isShow:!0}))}},_=0;_<v;_++)w(_);return o}function cRe(t,s,n){var{tick:a,ticks:i,viewBox:l,minTickGap:o,orientation:c,interval:d,tickFormatter:u,unit:h,angle:f}=t;if(!i||!i.length||!a)return[];if(Dt(d)||Qu.isSsr){var x;return(x=sRe(i,Dt(d)?d:0))!==null&&x!==void 0?x:[]}var b=[],v=c==="top"||c==="bottom"?"width":"height",w=h&&v==="width"?Sp(h,{fontSize:s,letterSpacing:n}):{width:0,height:0},_=(A,T)=>{var P=typeof u=="function"?u(A.value,T):A.value;return v==="width"?eRe(Sp(P,{fontSize:s,letterSpacing:n}),w,f):Sp(P,{fontSize:s,letterSpacing:n})[v]},S=i.length>=2?Lr(i[1].coordinate-i[0].coordinate):1,k=tRe(l,S,v);return d==="equidistantPreserveStart"?nRe(S,k,_,i,o):(d==="preserveStart"||d==="preserveStartEnd"?b=oRe(S,k,_,i,o,d==="preserveStartEnd"):b=lRe(S,k,_,i,o),b.filter(A=>A.isShow))}var dRe=t=>{var{ticks:s,label:n,labelGapWithTick:a=5,tickSize:i=0,tickMargin:l=0}=t,o=0;if(s){Array.from(s).forEach(h=>{if(h){var f=h.getBoundingClientRect();f.width>o&&(o=f.width)}});var c=n?n.getBoundingClientRect().width:0,d=i+l,u=o+d+c+(n?a:0);return Math.round(u)}return 0},uRe=["axisLine","width","height","className","hide","ticks","axisType"],hRe=["viewBox"],mRe=["viewBox"];function CC(t,s){if(t==null)return{};var n,a,i=fRe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function fRe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}function $u(){return $u=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},$u.apply(null,arguments)}function IR(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function Hn(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?IR(Object(n),!0).forEach(function(a){pRe(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):IR(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function pRe(t,s,n){return(s=xRe(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function xRe(t){var s=gRe(t,"string");return typeof s=="symbol"?s:s+""}function gRe(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var yRe={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:Xr.axis};function bRe(t){var{x:s,y:n,width:a,height:i,orientation:l,mirror:o,axisLine:c,otherSvgProps:d}=t;if(!c)return null;var u=Hn(Hn(Hn({},d),co(c)),{},{fill:"none"});if(l==="top"||l==="bottom"){var h=+(l==="top"&&!o||l==="bottom"&&o);u=Hn(Hn({},u),{},{x1:s,y1:n+h*i,x2:s+a,y2:n+h*i})}else{var f=+(l==="left"&&!o||l==="right"&&o);u=Hn(Hn({},u),{},{x1:s+f*a,y1:n,x2:s+f*a,y2:n+i})}return y.createElement("line",$u({},u,{className:vs("recharts-cartesian-axis-line",Du(c,"className"))}))}function vRe(t,s,n,a,i,l,o,c,d){var u,h,f,x,b,v,w=c?-1:1,_=t.tickSize||o,S=Dt(t.tickCoord)?t.tickCoord:t.coordinate;switch(l){case"top":u=h=t.coordinate,x=n+ +!c*i,f=x-w*_,v=f-w*d,b=S;break;case"left":f=x=t.coordinate,h=s+ +!c*a,u=h-w*_,b=u-w*d,v=S;break;case"right":f=x=t.coordinate,h=s+ +c*a,u=h+w*_,b=u+w*d,v=S;break;default:u=h=t.coordinate,x=n+ +c*i,f=x+w*_,v=f+w*d,b=S;break}return{line:{x1:u,y1:f,x2:h,y2:x},tick:{x:b,y:v}}}function NRe(t,s){switch(t){case"left":return s?"start":"end";case"right":return s?"end":"start";default:return"middle"}}function wRe(t,s){switch(t){case"left":case"right":return"middle";case"top":return s?"start":"end";default:return s?"end":"start"}}function jRe(t){var{option:s,tickProps:n,value:a}=t,i,l=vs(n.className,"recharts-cartesian-axis-tick-value");if(y.isValidElement(s))i=y.cloneElement(s,Hn(Hn({},n),{},{className:l}));else if(typeof s=="function")i=s(Hn(Hn({},n),{},{className:l}));else{var o="recharts-cartesian-axis-tick-value";typeof s!="boolean"&&(o=vs(o,s==null?void 0:s.className)),i=y.createElement(CN,$u({},n,{className:o}),a)}return i}var _Re=y.forwardRef((t,s)=>{var{ticks:n=[],tick:a,tickLine:i,stroke:l,tickFormatter:o,unit:c,padding:d,tickTextProps:u,orientation:h,mirror:f,x,y:b,width:v,height:w,tickSize:_,tickMargin:S,fontSize:k,letterSpacing:A,getTicksConfig:T,events:P,axisType:O}=t,D=cRe(Hn(Hn({},T),{},{ticks:n}),k,A),I=NRe(h,f),M=wRe(h,f),B=co(T),L=xx(a),F={};typeof i=="object"&&(F=i);var V=Hn(Hn({},B),{},{fill:"none"},F),$=D.map(q=>Hn({entry:q},vRe(q,x,b,v,w,h,_,f,S))),z=$.map(q=>{var{entry:G,line:re}=q;return y.createElement(xa,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(G.value,"-").concat(G.coordinate,"-").concat(G.tickCoord)},i&&y.createElement("line",$u({},V,re,{className:vs("recharts-cartesian-axis-tick-line",Du(i,"className"))})))}),H=$.map((q,G)=>{var{entry:re,tick:ye}=q,Ee=Hn(Hn(Hn(Hn({textAnchor:I,verticalAnchor:M},B),{},{stroke:"none",fill:l},L),ye),{},{index:G,payload:re,visibleTicksCount:D.length,tickFormatter:o,padding:d},u);return y.createElement(xa,$u({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(re.value,"-").concat(re.coordinate,"-").concat(re.tickCoord)},Wv(P,re,G)),a&&y.createElement(jRe,{option:a,tickProps:Ee,value:"".concat(typeof o=="function"?o(re.value,G):re.value).concat(c||"")}))});return y.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(O,"-ticks")},H.length>0&&y.createElement(bo,{zIndex:Xr.label},y.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(O,"-tick-labels"),ref:s},H)),z.length>0&&y.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(O,"-tick-lines")},z))}),SRe=y.forwardRef((t,s)=>{var{axisLine:n,width:a,height:i,className:l,hide:o,ticks:c,axisType:d}=t,u=CC(t,uRe),[h,f]=y.useState(""),[x,b]=y.useState(""),v=y.useRef(null);y.useImperativeHandle(s,()=>({getCalculatedWidth:()=>{var _;return dRe({ticks:v.current,label:(_=t.labelRef)===null||_===void 0?void 0:_.current,labelGapWithTick:5,tickSize:t.tickSize,tickMargin:t.tickMargin})}}));var w=y.useCallback(_=>{if(_){var S=_.getElementsByClassName("recharts-cartesian-axis-tick-value");v.current=S;var k=S[0];if(k){var A=window.getComputedStyle(k),T=A.fontSize,P=A.letterSpacing;(T!==h||P!==x)&&(f(T),b(P))}}},[h,x]);return o||a!=null&&a<=0||i!=null&&i<=0?null:y.createElement(bo,{zIndex:t.zIndex},y.createElement(xa,{className:vs("recharts-cartesian-axis",l)},y.createElement(bRe,{x:t.x,y:t.y,width:a,height:i,orientation:t.orientation,mirror:t.mirror,axisLine:n,otherSvgProps:co(t)}),y.createElement(_Re,{ref:w,axisType:d,events:u,fontSize:h,getTicksConfig:t,height:t.height,letterSpacing:x,mirror:t.mirror,orientation:t.orientation,padding:t.padding,stroke:t.stroke,tick:t.tick,tickFormatter:t.tickFormatter,tickLine:t.tickLine,tickMargin:t.tickMargin,tickSize:t.tickSize,tickTextProps:t.tickTextProps,ticks:c,unit:t.unit,width:t.width,x:t.x,y:t.y}),y.createElement(EIe,{x:t.x,y:t.y,width:t.width,height:t.height,lowerWidth:t.width,upperWidth:t.width},y.createElement(FIe,{label:t.label,labelRef:t.labelRef}),t.children)))}),CRe=y.memo(SRe,(t,s)=>{var{viewBox:n}=t,a=CC(t,hRe),{viewBox:i}=s,l=CC(s,mRe);return km(n,i)&&km(a,l)}),EE=y.forwardRef((t,s)=>{var n=ba(t,yRe);return y.createElement(CRe,$u({},n,{ref:s}))});EE.displayName="CartesianAxis";var kRe=["dangerouslySetInnerHTML","ticks"],ARe=["id"],ERe=["domain"],TRe=["domain"];function kC(){return kC=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},kC.apply(null,arguments)}function gb(t,s){if(t==null)return{};var n,a,i=PRe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function PRe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}function IRe(t){var s=an();return y.useLayoutEffect(()=>(s(NDe(t)),()=>{s(wDe(t))}),[t,s]),null}var MRe=t=>{var{xAxisId:s,className:n}=t,a=Et(rA),i=vi(),l="xAxis",o=Et(_=>sf(_,l,s,i)),c=Et(_=>rG(_,l,s,i)),d=Et(_=>eG(_,s)),u=Et(_=>FTe(_,s)),h=Et(_=>Dq(_,s));if(d==null||u==null||h==null)return null;var{dangerouslySetInnerHTML:f,ticks:x}=t,b=gb(t,kRe),{id:v}=h,w=gb(h,ARe);return y.createElement(EE,kC({},b,w,{scale:o,x:u.x,y:u.y,width:d.width,height:d.height,className:vs("recharts-".concat(l," ").concat(l),n),viewBox:a,ticks:c,axisType:l}))},DRe={allowDataOverflow:Za.allowDataOverflow,allowDecimals:Za.allowDecimals,allowDuplicatedCategory:Za.allowDuplicatedCategory,height:Za.height,hide:!1,mirror:Za.mirror,orientation:Za.orientation,padding:Za.padding,reversed:Za.reversed,scale:Za.scale,tickCount:Za.tickCount,type:Za.type,xAxisId:0},ORe=t=>{var s,n,a,i,l,o=ba(t,DRe);return y.createElement(y.Fragment,null,y.createElement(IRe,{interval:(s=o.interval)!==null&&s!==void 0?s:"preserveEnd",id:o.xAxisId,scale:o.scale,type:o.type,padding:o.padding,allowDataOverflow:o.allowDataOverflow,domain:o.domain,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,includeHidden:(n=o.includeHidden)!==null&&n!==void 0?n:!1,reversed:o.reversed,ticks:o.ticks,height:o.height,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(a=o.angle)!==null&&a!==void 0?a:0,minTickGap:(i=o.minTickGap)!==null&&i!==void 0?i:5,tick:(l=o.tick)!==null&&l!==void 0?l:!0,tickFormatter:o.tickFormatter}),y.createElement(MRe,o))},RRe=(t,s)=>{var{domain:n}=t,a=gb(t,ERe),{domain:i}=s,l=gb(s,TRe);return km(a,l)?Array.isArray(n)&&n.length===2&&Array.isArray(i)&&i.length===2?n[0]===i[0]&&n[1]===i[1]:km({domain:n},{domain:i}):!1},Ex=y.memo(ORe,RRe);Ex.displayName="XAxis";var LRe=["dangerouslySetInnerHTML","ticks"],BRe=["id"],FRe=["domain"],$Re=["domain"];function AC(){return AC=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},AC.apply(null,arguments)}function yb(t,s){if(t==null)return{};var n,a,i=zRe(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function zRe(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}function URe(t){var s=an();return y.useLayoutEffect(()=>(s(jDe(t)),()=>{s(_De(t))}),[t,s]),null}var VRe=t=>{var{yAxisId:s,className:n,width:a,label:i}=t,l=y.useRef(null),o=y.useRef(null),c=Et(rA),d=vi(),u=an(),h="yAxis",f=Et(P=>sf(P,h,s,d)),x=Et(P=>tG(P,s)),b=Et(P=>zTe(P,s)),v=Et(P=>rG(P,h,s,d)),w=Et(P=>Oq(P,s));if(y.useLayoutEffect(()=>{if(!(a!=="auto"||!x||gE(i)||y.isValidElement(i)||w==null)){var P=l.current;if(P){var O=P.getCalculatedWidth();Math.round(x.width)!==Math.round(O)&&u(SDe({id:s,width:O}))}}},[v,x,u,i,s,a,w]),x==null||b==null||w==null)return null;var{dangerouslySetInnerHTML:_,ticks:S}=t,k=yb(t,LRe),{id:A}=w,T=yb(w,BRe);return y.createElement(EE,AC({},k,T,{ref:l,labelRef:o,scale:f,x:b.x,y:b.y,tickTextProps:a==="auto"?{width:void 0}:{width:a},width:x.width,height:x.height,className:vs("recharts-".concat(h," ").concat(h),n),viewBox:c,ticks:v,axisType:h}))},HRe={allowDataOverflow:Ja.allowDataOverflow,allowDecimals:Ja.allowDecimals,allowDuplicatedCategory:Ja.allowDuplicatedCategory,hide:!1,mirror:Ja.mirror,orientation:Ja.orientation,padding:Ja.padding,reversed:Ja.reversed,scale:Ja.scale,tickCount:Ja.tickCount,type:Ja.type,width:Ja.width,yAxisId:0},WRe=t=>{var s,n,a,i,l,o=ba(t,HRe);return y.createElement(y.Fragment,null,y.createElement(URe,{interval:(s=o.interval)!==null&&s!==void 0?s:"preserveEnd",id:o.yAxisId,scale:o.scale,type:o.type,domain:o.domain,allowDataOverflow:o.allowDataOverflow,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,padding:o.padding,includeHidden:(n=o.includeHidden)!==null&&n!==void 0?n:!1,reversed:o.reversed,ticks:o.ticks,width:o.width,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(a=o.angle)!==null&&a!==void 0?a:0,minTickGap:(i=o.minTickGap)!==null&&i!==void 0?i:5,tick:(l=o.tick)!==null&&l!==void 0?l:!0,tickFormatter:o.tickFormatter}),y.createElement(VRe,o))},qRe=(t,s)=>{var{domain:n}=t,a=yb(t,FRe),{domain:i}=s,l=yb(s,$Re);return km(a,l)?Array.isArray(n)&&n.length===2&&Array.isArray(i)&&i.length===2?n[0]===i[0]&&n[1]===i[1]:km({domain:n},{domain:i}):!1},Tx=y.memo(WRe,qRe);Tx.displayName="YAxis";var GRe={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var p0=y;function KRe(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var YRe=typeof Object.is=="function"?Object.is:KRe,XRe=p0.useSyncExternalStore,QRe=p0.useRef,ZRe=p0.useEffect,JRe=p0.useMemo,e6e=p0.useDebugValue;GRe.useSyncExternalStoreWithSelector=function(t,s,n,a,i){var l=QRe(null);if(l.current===null){var o={hasValue:!1,value:null};l.current=o}else o=l.current;l=JRe(function(){function d(b){if(!u){if(u=!0,h=b,b=a(b),i!==void 0&&o.hasValue){var v=o.value;if(i(v,b))return f=v}return f=b}if(v=f,YRe(h,b))return v;var w=a(b);return i!==void 0&&i(v,w)?(h=b,v):(h=b,f=w)}var u=!1,h,f,x=n===void 0?null:n;return[function(){return d(s())},x===null?void 0:function(){return d(x())}]},[s,n,a,i]);var c=XRe(t,l[0],l[1]);return ZRe(function(){o.hasValue=!0,o.value=c},[c]),e6e(c),c};function t6e(t){t()}function s6e(){let t=null,s=null;return{clear(){t=null,s=null},notify(){t6e(()=>{let n=t;for(;n;)n.callback(),n=n.next})},get(){const n=[];let a=t;for(;a;)n.push(a),a=a.next;return n},subscribe(n){let a=!0;const i=s={callback:n,next:null,prev:s};return i.prev?i.prev.next=i:t=i,function(){!a||t===null||(a=!1,i.next?i.next.prev=i.prev:s=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}var MR={notify(){},get:()=>[]};function n6e(t,s){let n,a=MR,i=0,l=!1;function o(w){h();const _=a.subscribe(w);let S=!1;return()=>{S||(S=!0,_(),f())}}function c(){a.notify()}function d(){v.onStateChange&&v.onStateChange()}function u(){return l}function h(){i++,n||(n=t.subscribe(d),a=s6e())}function f(){i--,n&&i===0&&(n(),n=void 0,a.clear(),a=MR)}function x(){l||(l=!0,h())}function b(){l&&(l=!1,f())}const v={addNestedSub:o,notifyNestedSubs:c,handleChangeWrapper:d,isSubscribed:u,trySubscribe:x,tryUnsubscribe:b,getListeners:()=>a};return v}var r6e=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",a6e=r6e(),i6e=()=>typeof navigator<"u"&&navigator.product==="ReactNative",l6e=i6e(),o6e=()=>a6e||l6e?y.useLayoutEffect:y.useEffect,c6e=o6e(),t2=Symbol.for("react-redux-context"),s2=typeof globalThis<"u"?globalThis:{};function d6e(){if(!y.createContext)return{};const t=s2[t2]??(s2[t2]=new Map);let s=t.get(y.createContext);return s||(s=y.createContext(null),t.set(y.createContext,s)),s}var u6e=d6e();function h6e(t){const{children:s,context:n,serverState:a,store:i}=t,l=y.useMemo(()=>{const d=n6e(i);return{store:i,subscription:d,getServerState:a?()=>a:void 0}},[i,a]),o=y.useMemo(()=>i.getState(),[i]);c6e(()=>{const{subscription:d}=l;return d.onStateChange=d.notifyNestedSubs,d.trySubscribe(),o!==i.getState()&&d.notifyNestedSubs(),()=>{d.tryUnsubscribe(),d.onStateChange=void 0}},[l,o]);const c=n||u6e;return y.createElement(c.Provider,{value:l},s)}var m6e=h6e,f6e=(t,s)=>s,TE=Pe([f6e,gs,Iq,fr,NG,oc,Q4e,hr],rPe),PE=t=>{var s=t.currentTarget.getBoundingClientRect(),n=s.width/t.currentTarget.offsetWidth,a=s.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-s.left)/n),chartY:Math.round((t.clientY-s.top)/a)}},jK=Gi("mouseClick"),_K=t0();_K.startListening({actionCreator:jK,effect:(t,s)=>{var n=t.payload,a=TE(s.getState(),PE(n));(a==null?void 0:a.activeIndex)!=null&&s.dispatch(e4e({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}});var EC=Gi("mouseMove"),SK=t0();SK.startListening({actionCreator:EC,effect:(t,s)=>{var n=t.payload,a=s.getState(),i=oE(a,a.tooltip.settings.shared),l=TE(a,PE(n));i==="axis"&&((l==null?void 0:l.activeIndex)!=null?s.dispatch(hG({activeIndex:l.activeIndex,activeDataKey:void 0,activeCoordinate:l.activeCoordinate})):s.dispatch(uG()))}});var DR={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0},CK=Ha({name:"rootProps",initialState:DR,reducers:{updateOptions:(t,s)=>{var n;t.accessibilityLayer=s.payload.accessibilityLayer,t.barCategoryGap=s.payload.barCategoryGap,t.barGap=(n=s.payload.barGap)!==null&&n!==void 0?n:DR.barGap,t.barSize=s.payload.barSize,t.maxBarSize=s.payload.maxBarSize,t.stackOffset=s.payload.stackOffset,t.syncId=s.payload.syncId,t.syncMethod=s.payload.syncMethod,t.className=s.payload.className,t.baseValue=s.payload.baseValue}}}),p6e=CK.reducer,{updateOptions:x6e}=CK.actions,kK=Ha({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(t,s)=>s.payload}}),{updatePolarOptions:g6e}=kK.actions,y6e=kK.reducer,AK=Gi("keyDown"),EK=Gi("focus"),IE=t0();IE.startListening({actionCreator:AK,effect:(t,s)=>{var n=s.getState(),a=n.rootProps.accessibilityLayer!==!1;if(a){var{keyboardInteraction:i}=n.tooltip,l=t.payload;if(!(l!=="ArrowRight"&&l!=="ArrowLeft"&&l!=="Enter")){var o=Number(cE(i,rf(n))),c=oc(n);if(l==="Enter"){var d=cb(n,"axis","hover",String(i.index));s.dispatch(vC({active:!i.active,activeIndex:i.index,activeDataKey:i.dataKey,activeCoordinate:d}));return}var u=WTe(n),h=u==="left-to-right"?1:-1,f=l==="ArrowRight"?1:-1,x=o+f*h;if(!(c==null||x>=c.length||x<0)){var b=cb(n,"axis","hover",String(x));s.dispatch(vC({active:!0,activeIndex:x.toString(),activeDataKey:void 0,activeCoordinate:b}))}}}}});IE.startListening({actionCreator:EK,effect:(t,s)=>{var n=s.getState(),a=n.rootProps.accessibilityLayer!==!1;if(a){var{keyboardInteraction:i}=n.tooltip;if(!i.active&&i.index==null){var l="0",o=cb(n,"axis","hover",String(l));s.dispatch(vC({activeDataKey:void 0,active:!0,activeIndex:l,activeCoordinate:o}))}}}});var Ci=Gi("externalEvent"),TK=t0();TK.startListening({actionCreator:Ci,effect:(t,s)=>{if(t.payload.handler!=null){var n=s.getState(),a={activeCoordinate:R4e(n),activeDataKey:SG(n),activeIndex:Fu(n),activeLabel:_G(n),activeTooltipIndex:Fu(n),isTooltipActive:L4e(n)};t.payload.handler(a,t.payload.reactEvent)}}});var b6e=Pe([nf],t=>t.tooltipItemPayloads),v6e=Pe([b6e,h0,(t,s,n)=>s,(t,s,n)=>n],(t,s,n,a)=>{var i=t.find(c=>c.settings.dataKey===a);if(i!=null){var{positions:l}=i;if(l!=null){var o=s(l,n);return o}}}),PK=Gi("touchMove"),IK=t0();IK.startListening({actionCreator:PK,effect:(t,s)=>{var n=t.payload;if(!(n.touches==null||n.touches.length===0)){var a=s.getState(),i=oE(a,a.tooltip.settings.shared);if(i==="axis"){var l=TE(a,PE({clientX:n.touches[0].clientX,clientY:n.touches[0].clientY,currentTarget:n.currentTarget}));(l==null?void 0:l.activeIndex)!=null&&s.dispatch(hG({activeIndex:l.activeIndex,activeDataKey:void 0,activeCoordinate:l.activeCoordinate}))}else if(i==="item"){var o,c=n.touches[0];if(document.elementFromPoint==null)return;var d=document.elementFromPoint(c.clientX,c.clientY);if(!d||!d.getAttribute)return;var u=d.getAttribute(rW),h=(o=d.getAttribute(aW))!==null&&o!==void 0?o:void 0,f=v6e(s.getState(),u,h);s.dispatch(dG({activeDataKey:h,activeIndex:u,activeCoordinate:f}))}}}});var N6e=PH({brush:HOe,cartesianAxis:CDe,chartData:DPe,errorBars:$De,graphicalItems:HMe,layout:HCe,legend:B3e,options:EPe,polarAxis:nMe,polarOptions:y6e,referenceElements:QOe,rootProps:p6e,tooltip:t4e,zIndex:yPe}),w6e=function(s){return pCe({reducer:N6e,preloadedState:s,middleware:n=>n({serializableCheck:!1}).concat([_K.middleware,SK.middleware,IE.middleware,TK.middleware,IK.middleware]),enhancers:n=>{var a=n;return typeof n=="function"&&(a=n()),a.concat(VH({type:"raf"}))},devTools:Qu.devToolsEnabled})};function MK(t){var{preloadedState:s,children:n,reduxStoreName:a}=t,i=vi(),l=y.useRef(null);if(i)return n;l.current==null&&(l.current=w6e(s));var o=X5;return y.createElement(m6e,{context:o,store:l.current},n)}function DK(t){var{layout:s,margin:n}=t,a=an(),i=vi();return y.useEffect(()=>{i||(a(zCe(s)),a($Ce(n)))},[a,i,s,n]),null}function OK(t){var s=an();return y.useEffect(()=>{s(x6e(t))},[s,t]),null}function OR(t){var{zIndex:s,isPanorama:n}=t,a=n?"recharts-zindex-panorama-":"recharts-zindex-",i=dK("".concat(a).concat(s)),l=an();return y.useLayoutEffect(()=>(l(xPe({zIndex:s,elementId:i,isPanorama:n})),()=>{l(gPe({zIndex:s,isPanorama:n}))}),[l,s,i,n]),y.createElement("g",{id:i})}function RR(t){var{children:s,isPanorama:n}=t,a=Et(iPe);if(!a||a.length===0)return s;var i=a.filter(o=>o<0),l=a.filter(o=>o>0);return y.createElement(y.Fragment,null,i.map(o=>y.createElement(OR,{key:o,zIndex:o,isPanorama:n})),s,l.map(o=>y.createElement(OR,{key:o,zIndex:o,isPanorama:n})))}var j6e=["children"];function _6e(t,s){if(t==null)return{};var n,a,i=S6e(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function S6e(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}function bb(){return bb=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},bb.apply(null,arguments)}var C6e={width:"100%",height:"100%",display:"block"},k6e=y.forwardRef((t,s)=>{var n=D3e(),a=O3e(),i=xW();if(!cd(n)||!cd(a))return null;var{children:l,otherAttributes:o,title:c,desc:d}=t,u,h;return o!=null&&(typeof o.tabIndex=="number"?u=o.tabIndex:u=i?0:void 0,typeof o.role=="string"?h=o.role:h=i?"application":void 0),y.createElement(LV,bb({},o,{title:c,desc:d,role:h,tabIndex:u,width:n,height:a,style:C6e,ref:s}),l)}),A6e=t=>{var{children:s}=t,n=Et(nN);if(!n)return null;var{width:a,height:i,y:l,x:o}=n;return y.createElement(LV,{width:a,height:i,x:o,y:l},s)},LR=y.forwardRef((t,s)=>{var{children:n}=t,a=_6e(t,j6e),i=vi();return i?y.createElement(A6e,null,y.createElement(RR,{isPanorama:!0},n)):y.createElement(k6e,bb({ref:s},a),y.createElement(RR,{isPanorama:!1},n))});function E6e(){var t=an(),[s,n]=y.useState(null),a=Et(o3e);return y.useEffect(()=>{if(s!=null){var i=s.getBoundingClientRect(),l=i.width/s.offsetWidth;Rn(l)&&l!==a&&t(VCe(l))}},[s,t,a]),n}function BR(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function T6e(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?BR(Object(n),!0).forEach(function(a){P6e(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):BR(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function P6e(t,s,n){return(s=I6e(s))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function I6e(t){var s=M6e(t,"string");return typeof s=="symbol"?s:s+""}function M6e(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function zu(){return zu=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},zu.apply(null,arguments)}var D6e=()=>(VPe(),null);function vb(t){if(typeof t=="number")return t;if(typeof t=="string"){var s=parseFloat(t);if(!Number.isNaN(s))return s}return 0}var O6e=y.forwardRef((t,s)=>{var n,a,i=y.useRef(null),[l,o]=y.useState({containerWidth:vb((n=t.style)===null||n===void 0?void 0:n.width),containerHeight:vb((a=t.style)===null||a===void 0?void 0:a.height)}),c=y.useCallback((u,h)=>{o(f=>{var x=Math.round(u),b=Math.round(h);return f.containerWidth===x&&f.containerHeight===b?f:{containerWidth:x,containerHeight:b}})},[]),d=y.useCallback(u=>{if(typeof s=="function"&&s(u),u!=null&&typeof ResizeObserver<"u"){var{width:h,height:f}=u.getBoundingClientRect();c(h,f);var x=v=>{var{width:w,height:_}=v[0].contentRect;c(w,_)},b=new ResizeObserver(x);b.observe(u),i.current=b}},[s,c]);return y.useEffect(()=>()=>{var u=i.current;u!=null&&u.disconnect()},[c]),y.createElement(y.Fragment,null,y.createElement(iN,{width:l.containerWidth,height:l.containerHeight}),y.createElement("div",zu({ref:d},t)))}),R6e=y.forwardRef((t,s)=>{var{width:n,height:a}=t,[i,l]=y.useState({containerWidth:vb(n),containerHeight:vb(a)}),o=y.useCallback((d,u)=>{l(h=>{var f=Math.round(d),x=Math.round(u);return h.containerWidth===f&&h.containerHeight===x?h:{containerWidth:f,containerHeight:x}})},[]),c=y.useCallback(d=>{if(typeof s=="function"&&s(d),d!=null){var{width:u,height:h}=d.getBoundingClientRect();o(u,h)}},[s,o]);return y.createElement(y.Fragment,null,y.createElement(iN,{width:i.containerWidth,height:i.containerHeight}),y.createElement("div",zu({ref:c},t)))}),L6e=y.forwardRef((t,s)=>{var{width:n,height:a}=t;return y.createElement(y.Fragment,null,y.createElement(iN,{width:n,height:a}),y.createElement("div",zu({ref:s},t)))}),B6e=y.forwardRef((t,s)=>{var{width:n,height:a}=t;return Go(n)||Go(a)?y.createElement(R6e,zu({},t,{ref:s})):y.createElement(L6e,zu({},t,{ref:s}))});function F6e(t){return t===!0?O6e:B6e}var $6e=y.forwardRef((t,s)=>{var{children:n,className:a,height:i,onClick:l,onContextMenu:o,onDoubleClick:c,onMouseDown:d,onMouseEnter:u,onMouseLeave:h,onMouseMove:f,onMouseUp:x,onTouchEnd:b,onTouchMove:v,onTouchStart:w,style:_,width:S,responsive:k,dispatchTouchEvents:A=!0}=t,T=y.useRef(null),P=an(),[O,D]=y.useState(null),[I,M]=y.useState(null),B=E6e(),L=aA(),F=(L==null?void 0:L.width)>0?L.width:S,V=(L==null?void 0:L.height)>0?L.height:i,$=y.useCallback(ue=>{B(ue),typeof s=="function"&&s(ue),D(ue),M(ue),ue!=null&&(T.current=ue)},[B,s,D,M]),z=y.useCallback(ue=>{P(jK(ue)),P(Ci({handler:l,reactEvent:ue}))},[P,l]),H=y.useCallback(ue=>{P(EC(ue)),P(Ci({handler:u,reactEvent:ue}))},[P,u]),q=y.useCallback(ue=>{P(uG()),P(Ci({handler:h,reactEvent:ue}))},[P,h]),G=y.useCallback(ue=>{P(EC(ue)),P(Ci({handler:f,reactEvent:ue}))},[P,f]),re=y.useCallback(()=>{P(EK())},[P]),ye=y.useCallback(ue=>{P(AK(ue.key))},[P]),Ee=y.useCallback(ue=>{P(Ci({handler:o,reactEvent:ue}))},[P,o]),ee=y.useCallback(ue=>{P(Ci({handler:c,reactEvent:ue}))},[P,c]),te=y.useCallback(ue=>{P(Ci({handler:d,reactEvent:ue}))},[P,d]),ce=y.useCallback(ue=>{P(Ci({handler:x,reactEvent:ue}))},[P,x]),ge=y.useCallback(ue=>{P(Ci({handler:w,reactEvent:ue}))},[P,w]),X=y.useCallback(ue=>{A&&P(PK(ue)),P(Ci({handler:v,reactEvent:ue}))},[P,A,v]),de=y.useCallback(ue=>{P(Ci({handler:b,reactEvent:ue}))},[P,b]),Ce=F6e(k);return y.createElement(MG.Provider,{value:O},y.createElement(T_e.Provider,{value:I},y.createElement(Ce,{width:F??(_==null?void 0:_.width),height:V??(_==null?void 0:_.height),className:vs("recharts-wrapper",a),style:T6e({position:"relative",cursor:"default",width:F,height:V},_),onClick:z,onContextMenu:Ee,onDoubleClick:ee,onFocus:re,onKeyDown:ye,onMouseDown:te,onMouseEnter:H,onMouseLeave:q,onMouseMove:G,onMouseUp:ce,onTouchEnd:de,onTouchMove:X,onTouchStart:ge,ref:$},y.createElement(D6e,null),n)))}),z6e=["width","height","responsive","children","className","style","compact","title","desc"];function U6e(t,s){if(t==null)return{};var n,a,i=V6e(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function V6e(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}var RK=y.forwardRef((t,s)=>{var{width:n,height:a,responsive:i,children:l,className:o,style:c,compact:d,title:u,desc:h}=t,f=U6e(t,z6e),x=co(f);return d?y.createElement(y.Fragment,null,y.createElement(iN,{width:n,height:a}),y.createElement(LR,{otherAttributes:x,title:u,desc:h},l)):y.createElement($6e,{className:o,style:c,width:n,height:a,responsive:i??!1,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},y.createElement(LR,{otherAttributes:x,title:u,desc:h,ref:s},y.createElement(JOe,null,l)))});function TC(){return TC=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},TC.apply(null,arguments)}var H6e={top:5,right:5,bottom:5,left:5},W6e={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:H6e,reverseStackOrder:!1,syncMethod:"index",responsive:!1},q6e=y.forwardRef(function(s,n){var a,i=ba(s.categoricalChartProps,W6e),{chartName:l,defaultTooltipEventType:o,validateTooltipEventTypes:c,tooltipPayloadSearcher:d,categoricalChartProps:u}=s,h={chartName:l,defaultTooltipEventType:o,validateTooltipEventTypes:c,tooltipPayloadSearcher:d,eventEmitter:void 0};return y.createElement(MK,{preloadedState:{options:h},reduxStoreName:(a=u.id)!==null&&a!==void 0?a:l},y.createElement(bK,{chartData:u.data}),y.createElement(DK,{layout:i.layout,margin:i.margin}),y.createElement(OK,{baseValue:i.baseValue,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className}),y.createElement(RK,TC({},i,{ref:n})))}),G6e=["axis","item"],Nb=y.forwardRef((t,s)=>y.createElement(q6e,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:G6e,tooltipPayloadSearcher:OG,categoricalChartProps:t,ref:s}));function K6e(t){var s=an();return y.useEffect(()=>{s(g6e(t))},[s,t]),null}var Y6e=["layout"];function PC(){return PC=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},PC.apply(null,arguments)}function X6e(t,s){if(t==null)return{};var n,a,i=Q6e(t,s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],s.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function Q6e(t,s){if(t==null)return{};var n={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(s.indexOf(a)!==-1)continue;n[a]=t[a]}return n}var Z6e={top:5,right:5,bottom:5,left:5},J6e={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Z6e,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1},e8e=y.forwardRef(function(s,n){var a,i=ba(s.categoricalChartProps,J6e),{layout:l}=i,o=X6e(i,Y6e),{chartName:c,defaultTooltipEventType:d,validateTooltipEventTypes:u,tooltipPayloadSearcher:h}=s,f={chartName:c,defaultTooltipEventType:d,validateTooltipEventTypes:u,tooltipPayloadSearcher:h,eventEmitter:void 0};return y.createElement(MK,{preloadedState:{options:f},reduxStoreName:(a=i.id)!==null&&a!==void 0?a:c},y.createElement(bK,{chartData:i.data}),y.createElement(DK,{layout:l,margin:i.margin}),y.createElement(OK,{baseValue:void 0,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className}),y.createElement(K6e,{cx:i.cx,cy:i.cy,startAngle:i.startAngle,endAngle:i.endAngle,innerRadius:i.innerRadius,outerRadius:i.outerRadius}),y.createElement(RK,PC({},o,{ref:n})))}),t8e=["item"],s8e={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},IC=y.forwardRef((t,s)=>{var n=ba(t,s8e);return y.createElement(e8e,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:t8e,tooltipPayloadSearcher:OG,categoricalChartProps:n,ref:s})});const gc=["#0f172a","#0284c7","#22c55e","#e11d48","#6366f1"];function wo(t){return t.toISOString().slice(0,10)}function FR(t,s){const n=new Date(t);return n.setDate(n.getDate()+s),n}const n8e={hidden:{opacity:0,y:8},visible:{opacity:1,y:0,transition:{duration:.3,ease:"easeOut"}}},n2={hidden:{},visible:{transition:{staggerChildren:.08,delayChildren:.05}}},r2={hidden:{opacity:0,y:10,scale:.97},visible:{opacity:1,y:0,scale:1,transition:{duration:.25,ease:"easeOut"}}},$R={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{duration:.25,ease:"easeOut"}}};function zR(){var Ce;const t=new Date,[s,n]=y.useState(()=>wo(t)),[a,i]=y.useState(()=>wo(t)),[l,o]=y.useState("today"),[c,d]=y.useState("overview"),[u,h]=y.useState(null),[f,x]=y.useState(null),[b,v]=y.useState(!0),[w,_]=y.useState(""),[S,k]=y.useState(0),A=!!(s&&a);y.useEffect(()=>{if(!A){v(!1),_(""),h(null);return}(async()=>{var fe,pe;v(!0),_("");try{const qe=await N_e({date_from:s,date_to:a});console.log("DASHBOARD DATA >>>",qe.data),h(qe.data),x(new Date)}catch(oe){console.error(oe),_(((pe=(fe=oe==null?void 0:oe.response)==null?void 0:fe.data)==null?void 0:pe.detail)||"Failed to load dashboard data. Please try again."),h(null)}finally{v(!1)}})()},[s,a,S,A]);const T=((Ce=u==null?void 0:u.filters)==null?void 0:Ce.caps)||{},P=Object.keys(T).length>0,O=y.useMemo(()=>{if(!P)return[];const ue=[];return T.can_patients&&ue.push({key:"patients",label:"Patients",icon:Vs}),T.can_opd&&ue.push({key:"opd",label:"OPD",icon:Es}),T.can_ipd&&ue.push({key:"ipd",label:"IPD / Beds",icon:kn}),T.can_lab&&ue.push({key:"lab",label:"Lab",icon:Li}),T.can_radiology&&ue.push({key:"radiology",label:"Radiology",icon:t1}),T.can_pharmacy&&ue.push({key:"pharmacy",label:"Pharmacy",icon:dr}),T.can_billing&&ue.push({key:"billing",label:"Billing",icon:Kl}),T.can_ot&&ue.push({key:"ot",label:"OT",icon:Vs}),ue},[P,T]),D=y.useMemo(()=>{var ue;return((ue=u==null?void 0:u.widgets)==null?void 0:ue.filter(fe=>fe.widget_type==="metric"))||[]},[u]),I=y.useMemo(()=>{var ue;return((ue=u==null?void 0:u.widgets)==null?void 0:ue.filter(fe=>fe.widget_type==="table"))||[]},[u]),M=y.useMemo(()=>{var ue;return((ue=u==null?void 0:u.widgets)==null?void 0:ue.filter(fe=>fe.widget_type==="chart"))||[]},[u]),B=M.find(ue=>ue.code==="patient_flow"),L=M.find(ue=>ue.code==="ipd_bed_occupancy"),F=M.find(ue=>ue.code==="revenue_by_stream"),V=M.find(ue=>ue.code==="appointment_status"),$=M.find(ue=>ue.code==="ipd_status"),z=M.find(ue=>ue.code==="payment_modes"),H=M.find(ue=>ue.code==="top_lab_tests"),q=M.find(ue=>ue.code==="top_radiology_tests"),G=M.find(ue=>ue.code==="billing_summary"),re=M.find(ue=>ue.code==="top_medicines"),ye=I.find(ue=>ue.code==="recent_ipd_admissions"),Ee=D.filter(ue=>ue.code.startsWith("revenue_")),ee=D.filter(ue=>!ue.code.startsWith("revenue_")),te=()=>k(ue=>ue+1),ce=ue=>{o(ue);const fe=new Date;if(ue==="today"){const pe=wo(fe);n(pe),i(pe)}else if(ue==="7d"){const pe=wo(FR(fe,-6)),oe=wo(fe);n(pe),i(oe)}else if(ue==="30d"){const pe=wo(FR(fe,-29)),oe=wo(fe);n(pe),i(oe)}else if(ue==="month"){const pe=new Date(fe.getFullYear(),fe.getMonth(),1),oe=wo(pe),qe=wo(fe);n(oe),i(qe)}},ge=ue=>fe=>{o("custom"),ue(fe.target.value)},X=y.useMemo(()=>{if(!u)return[];const ue=_t=>{var ve;return((ve=D.find(ae=>ae.code===_t))==null?void 0:ve.data)??0},fe=Number(ue("metric_new_patients"))||0,pe=Number(ue("metric_opd_visits"))||0,oe=Number(ue("metric_ipd_admissions"))||0,Xe=((L==null?void 0:L.data)||{}).occupancy_pct??0,jt=(F==null?void 0:F.data)||[],ft=Array.isArray(jt)&&jt.length?[...jt].sort((_t,ve)=>(ve.value||0)-(_t.value||0))[0]:null,it=[];return T.can_patients&&D.length&&it.push({key:"patients",label:"New Patients",value:fe,helper:"Registered in period",icon:Vs,tone:"sky"}),T.can_opd&&D.length&&it.push({key:"opd",label:"OPD Visits",value:pe,helper:"Completed consults",icon:Es,tone:"emerald"}),T.can_ipd&&D.length&&it.push({key:"ipd",label:"IPD Admissions",value:oe,helper:"Admitted cases",icon:kn,tone:"violet"}),T.can_ipd&&L&&it.push({key:"beds",label:"Bed Occupancy",value:Xe,suffix:"%",helper:"Across all wards",icon:kn,tone:"amber"}),ft&&(T.can_billing||T.can_pharmacy||T.can_lab||T.can_radiology)&&it.push({key:"revenue",label:"Top Revenue Stream",value:ft.value||0,helper:ft.label||"",icon:ft.label==="Pharmacy"?dr:ft.label==="Lab"?Li:ft.label==="Radiology"?t1:Kl,tone:"rose"}),it.filter(Boolean)},[u,D,L,F,T.can_patients,T.can_opd,T.can_ipd,T.can_billing,T.can_pharmacy,T.can_lab,T.can_radiology]),de=y.useMemo(()=>[{key:"overview",label:"Overview",show:!0},{key:"clinical",label:"Clinical",show:T.can_patients||T.can_opd||T.can_ipd},{key:"revenue",label:"Revenue",show:T.can_billing||T.can_pharmacy||T.can_lab||T.can_radiology},{key:"operations",label:"Operations",show:T.can_ipd||T.can_pharmacy||T.can_lab||T.can_radiology}].filter(fe=>fe.show),[T]);return y.useEffect(()=>{de.find(ue=>ue.key===c)||de.length>0&&d(de[0].key)},[de,c]),r.jsxs(at.div,{className:"relative min-h-[calc(100vh-4rem)]  px-3 py-3 md:px-6 md:py-6 rounded",variants:n8e,initial:"hidden",animate:"visible",children:[r.jsxs("div",{className:"pointer-events-none absolute inset-0 -z-10",children:[r.jsx("div",{className:"absolute -top-24 right-0 h-40 w-40 rounded-full bg-sky-200/40 blur-3xl"}),r.jsx("div",{className:"absolute -bottom-24 left-4 h-40 w-40 rounded-full bg-emerald-200/40 blur-3xl"})]}),r.jsxs("div",{className:"mx-auto w-full max-w-6xl space-y-4",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsxs(at.div,{className:Ft("flex flex-col md:flex-row md:items-start md:justify-between gap-3","rounded-2xl border border-slate-200/70 bg-white/90 backdrop-blur-sm p-3 md:p-5 shadow-sm"),children:[r.jsxs("div",{className:"space-y-2 md:max-w-md",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-sky-200 bg-sky-50 px-3 py-1 text-[10px] md:text-[11px] font-medium text-sky-700",children:[r.jsxs("span",{className:"relative flex h-2 w-2",children:[r.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-emerald-400 opacity-75"}),r.jsx("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-emerald-500"})]}),"Live operations & clinical overview"]}),r.jsxs("h1",{className:"text-xl md:text-3xl font-semibold tracking-tight text-slate-900 flex items-center gap-2",children:[r.jsx("span",{className:"inline-flex h-8 w-8 md:h-9 md:w-9 items-center justify-center rounded-xl bg-sky-100 text-sky-600 border border-sky-200",children:r.jsx(Kf,{className:"w-4 h-4 md:w-5 md:h-5"})}),"Dashboard"]}),r.jsx("p",{className:"text-xs md:text-sm text-slate-600",children:"Monitor patients, beds, diagnostics, pharmacy and revenue in one live dashboard designed for hospital admins & clinical teams."}),P&&O.length>0&&r.jsx("div",{className:"flex flex-wrap gap-1.5 mt-2",children:O.map(ue=>r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-100 border border-slate-200 px-2 py-0.5 text-[10px] text-slate-700",children:[r.jsx("span",{className:"flex h-4 w-4 items-center justify-center rounded-full bg-white shadow-inner",children:r.jsx(ue.icon,{className:"w-3 h-3"})}),r.jsx("span",{className:"font-medium",children:ue.label})]},ue.key))}),f&&r.jsxs("div",{className:"inline-flex items-center gap-1.5 rounded-full bg-slate-100 px-2.5 py-1 mt-1 text-[10px] text-slate-600",children:[r.jsx(lr,{className:"w-3 h-3"}),r.jsx("span",{className:"font-medium",children:"Last updated:"}),r.jsx("span",{children:f.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"})})]})]}),r.jsxs("div",{className:"flex flex-col gap-2 w-full md:w-auto",children:[r.jsx("div",{className:"flex flex-wrap gap-1.5",children:[{key:"today",label:"Today"},{key:"7d",label:"Last 7 days"},{key:"30d",label:"Last 30 days"},{key:"month",label:"This month"},{key:"custom",label:"Custom"}].map(ue=>r.jsx("button",{type:"button",onClick:()=>ce(ue.key),className:Ft("px-2.5 py-1 rounded-full text-[10px] font-medium border transition-colors",l===ue.key?"bg-sky-600 text-white border-sky-600 shadow-sm":"bg-white text-slate-700 border-slate-200 hover:bg-slate-50"),children:ue.label},ue.key))}),r.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[r.jsxs("div",{className:"flex flex-1 items-center gap-2 rounded-xl border border-slate-200 bg-white px-2.5 py-2 shadow-inner",children:[r.jsx(E_,{className:"w-4 h-4 text-slate-500 shrink-0"}),r.jsxs("div",{className:"flex flex-col gap-1 w-full text-[11px] text-slate-700 sm:flex-row sm:items-center",children:[r.jsxs("div",{className:"flex items-center gap-1 w-full",children:[r.jsx("span",{className:"hidden sm:inline",children:"From"}),r.jsx("input",{type:"date",value:s,onChange:ge(n),className:"w-full border border-slate-200 bg-slate-50 rounded px-1.5 py-0.5 text-[11px] text-slate-800 focus:outline-none focus:ring-1 focus:ring-sky-500"})]}),r.jsxs("div",{className:"flex items-center gap-1 w-full",children:[r.jsx("span",{className:"hidden sm:inline",children:"To"}),r.jsx("input",{type:"date",value:a,onChange:ge(i),className:"w-full border border-slate-200 bg-slate-50 rounded px-1.5 py-0.5 text-[11px] text-slate-800 focus:outline-none focus:ring-1 focus:ring-sky-500"})]})]})]}),r.jsxs(at.button,{onClick:te,whileTap:{scale:.96},className:Ft("inline-flex items-center justify-center gap-2 rounded-xl","border border-sky-600 bg-sky-600 text-white shadow-sm","px-3 py-2 text-xs sm:text-sm font-medium w-full sm:w-auto","hover:bg-sky-500 hover:border-sky-500 transition-colors"),children:[r.jsx(_u,{className:"w-4 h-4"}),"Refresh"]})]})]})]}),r.jsx(vl,{children:w&&r.jsx(at.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},children:r.jsxs(Ui,{variant:"destructive",children:[r.jsx(nn,{className:"h-4 w-4 mt-0.5"}),r.jsxs("div",{children:[r.jsx(Vi,{children:"Dashboard error"}),r.jsx(Hi,{children:w})]})]})})}),!b&&u&&X.length>0&&r.jsxs(at.div,{className:"rounded-2xl border border-slate-200 bg-white px-2.5 py-3 shadow-sm",variants:$R,initial:"hidden",animate:"visible",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2 px-1",children:[r.jsx("h2",{className:"text-xs font-semibold text-slate-700",children:"At a glance"}),r.jsx("span",{className:"h-px flex-1 bg-slate-200"})]}),r.jsx("div",{className:"flex flex-wrap gap-2",children:X.map(ue=>r.jsx(r8e,{pill:ue},ue.key))})]})]}),!A&&!b&&!w&&r.jsx(Ve,{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50/70",children:r.jsxs(He,{className:"py-6 flex flex-col items-center text-center gap-2",children:[r.jsx(E_,{className:"w-8 h-8 text-slate-400 mb-1"}),r.jsx("p",{className:"text-sm font-medium text-slate-700",children:"Select a date range to see live dashboard data."}),r.jsxs("p",{className:"text-xs text-slate-500 max-w-xs",children:["Choose both ",r.jsx("span",{className:"font-semibold",children:"From"})," and"," ",r.jsx("span",{className:"font-semibold",children:"To"})," dates above. Well show patient, revenue, pharmacy and diagnostics insights."]})]})}),b&&A&&!u&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4",children:[r.jsx(We,{className:"h-20 rounded-2xl"}),r.jsx(We,{className:"h-20 rounded-2xl"}),r.jsx(We,{className:"h-20 rounded-2xl"}),r.jsx(We,{className:"h-20 rounded-2xl"})]}),r.jsx(We,{className:"h-56 rounded-2xl"}),r.jsx(We,{className:"h-56 rounded-2xl"})]}),!b&&A&&u&&r.jsx(at.div,{variants:$R,initial:"hidden",animate:"visible",className:"pb-4",children:r.jsxs(jl,{value:c,onValueChange:d,className:"w-full",children:[r.jsx("div",{className:"flex justify-between items-center mb-2",children:r.jsx(Wi,{className:"flex flex-nowrap overflow-x-auto gap-1 rounded-full bg-slate-100/80 p-1",children:de.map(ue=>r.jsx(ms,{value:ue.key,className:"px-3 py-1.5 text-xs sm:text-sm rounded-full data-[state=active]:bg-white data-[state=active]:shadow-sm",children:ue.label},ue.key))})}),r.jsxs(us,{value:"overview",className:"space-y-4 mt-2",children:[D.length>0&&r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Key metrics"}),r.jsx(at.div,{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4",variants:n2,initial:"hidden",animate:"visible",children:D.map(ue=>r.jsx(at.div,{variants:r2,whileHover:{y:-2,scale:1.01,boxShadow:"0 18px 35px rgba(15, 23, 42, 0.12)"},transition:{type:"spring",stiffness:220,damping:20},children:r.jsx(a2,{widget:ue})},ue.code))})]}),r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Activity & revenue mix"}),r.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-3 md:gap-4",children:[B&&r.jsx(Er,{widget:B}),F&&r.jsx(Er,{widget:F})]})]})]}),r.jsxs(us,{value:"clinical",className:"space-y-4 mt-2",children:[ee.length>0&&r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Clinical metrics"}),r.jsx(at.div,{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-4",variants:n2,initial:"hidden",animate:"visible",children:ee.map(ue=>r.jsx(at.div,{variants:r2,whileHover:{y:-2,scale:1.01,boxShadow:"0 18px 35px rgba(15, 23, 42, 0.12)"},transition:{type:"spring",stiffness:220,damping:20},children:r.jsx(a2,{widget:ue})},ue.code))})]}),r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Patient flow & statuses"}),r.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-3 md:gap-4",children:[B&&r.jsx(Er,{widget:B}),V&&r.jsx(Er,{widget:V})]})]}),r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"IPD beds & admissions"}),r.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-3 md:gap-4",children:[L&&r.jsx(Er,{widget:L}),$&&r.jsx(Er,{widget:$})]})]}),ye&&r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Recent IPD admissions"}),r.jsx(UR,{widget:ye})]})]}),r.jsxs(us,{value:"revenue",className:"space-y-4 mt-2",children:[Ee.length>0&&r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Revenue KPIs"}),r.jsx(at.div,{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-4",variants:n2,initial:"hidden",animate:"visible",children:Ee.map(ue=>r.jsx(at.div,{variants:r2,whileHover:{y:-2,scale:1.01,boxShadow:"0 18px 35px rgba(15, 23, 42, 0.12)"},transition:{type:"spring",stiffness:220,damping:20},children:r.jsx(a2,{widget:ue})},ue.code))})]}),r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Revenue & payment mix"}),r.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-3 md:gap-4",children:[F&&r.jsx(Er,{widget:F}),z&&r.jsx(Er,{widget:z})]})]}),r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Billed vs pending & top tests"}),r.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-3 md:gap-4",children:[G&&r.jsx(Er,{widget:G}),H&&r.jsx(Er,{widget:H}),q&&r.jsx(Er,{widget:q})]})]}),re&&r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Top 10 medicines (by quantity)"}),r.jsx(Er,{widget:re})]})]}),r.jsxs(us,{value:"operations",className:"space-y-4 mt-2",children:[r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Capacity & utilization"}),r.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-3 md:gap-4",children:[L&&r.jsx(Er,{widget:L}),B&&r.jsx(Er,{widget:B})]})]}),r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Pharmacy & diagnostics focus"}),r.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-3 md:gap-4",children:[re&&r.jsx(Er,{widget:re}),H&&r.jsx(Er,{widget:H}),q&&r.jsx(Er,{widget:q})]})]}),ye&&r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Latest IPD activity"}),r.jsx(UR,{widget:ye})]})]})]})})]})]})}function r8e({pill:t}){const{label:s,value:n,helper:a,icon:i,tone:l,suffix:o}=t,c={sky:"bg-sky-50 border-sky-100 text-sky-800",emerald:"bg-emerald-50 border-emerald-100 text-emerald-800",violet:"bg-violet-50 border-violet-100 text-violet-800",amber:"bg-amber-50 border-amber-100 text-amber-800",rose:"bg-rose-50 border-rose-100 text-rose-800"}[l||"sky"];return r.jsxs(at.div,{whileHover:{y:-2,scale:1.01},transition:{type:"spring",stiffness:260,damping:18},className:Ft("flex-1 min-w-[140px] sm:min-w-[160px] rounded-2xl border px-2.5 py-2","flex items-center gap-2 sm:gap-3 shadow-[0_8px_18px_rgba(15,23,42,0.04)]",c),children:[r.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-xl bg-white/70 text-slate-700 shadow-sm shrink-0",children:i&&r.jsx(i,{className:"w-4 h-4"})}),r.jsxs("div",{className:"space-y-0.5",children:[r.jsx("div",{className:"text-[10px] uppercase tracking-wide font-semibold opacity-90",children:s}),r.jsxs("div",{className:"text-base sm:text-lg font-semibold leading-tight",children:[typeof n=="number"?n.toLocaleString("en-IN",{maximumFractionDigits:o==="%"?1:0}):n,o&&r.jsx("span",{className:"ml-0.5 text-[10px]",children:o})]}),a&&r.jsx("div",{className:"text-[10px] leading-tight opacity-80",children:a})]})]})}function a2({widget:t}){const s=t.data,n=typeof s=="number"||typeof s=="string"?s:typeof s=="object"&&s!==null?s.value??s.total??s.amount??0:0,a=typeof n=="number"?n.toLocaleString("en-IN",{maximumFractionDigits:(t.code.includes("revenue"),0)}):n;return r.jsxs(Ve,{className:Ft("rounded-2xl shadow-sm overflow-hidden border border-slate-200 bg-white","hover:border-sky-200 transition-colors"),children:[r.jsxs(rt,{className:"flex flex-row items-start justify-between space-y-0 pb-1",children:[r.jsxs(ot,{className:"text-sm font-medium text-slate-800 flex items-center gap-1.5",children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-400 shadow-[0_0_0_3px_rgba(52,211,153,0.35)]"}),t.title]}),r.jsx(Ze,{variant:"outline",className:"text-[9px] uppercase tracking-wide border-slate-200 text-slate-500",children:t.code})]}),r.jsxs(He,{className:"pt-0",children:[r.jsx("div",{className:"text-2xl md:text-3xl font-semibold tracking-tight mt-1 text-slate-900",children:a}),t.description&&r.jsx("p",{className:"text-[11px] text-slate-500 mt-1",children:t.description})]})]})}function Er({widget:t}){var i,l,o;const s=((i=t.config)==null?void 0:i.chart_type)||"bar";if(s==="donut"){const c=t.data||{},d=[{label:"Occupied",value:c.occupied||0},{label:"Available",value:c.available||0}];return r.jsxs(Ve,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[r.jsxs(rt,{className:"pb-2 flex flex-row items-center justify-between",children:[r.jsx(ot,{className:"text-base font-semibold text-slate-800",children:t.title}),r.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-500",children:"Snapshot"})]}),r.jsxs(He,{className:"h-56 sm:h-64",children:[r.jsx(eu,{width:"100%",height:"100%",children:r.jsxs(IC,{children:[r.jsx(mb,{dataKey:"value",data:d,innerRadius:50,outerRadius:80,paddingAngle:3,children:d.map((u,h)=>r.jsx(Zl,{fill:gc[h%gc.length]},`cell-${h}`))}),r.jsx(nu,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12}})]})}),typeof c.occupancy_pct=="number"&&r.jsxs("p",{className:"text-xs text-slate-600 text-center mt-2",children:["Occupancy:"," ",r.jsxs("span",{className:"font-medium text-emerald-600",children:[c.occupancy_pct,"%"]})," ",r.jsxs("span",{className:"opacity-80",children:["(",c.occupied,"/",c.total," beds)"]})]})]})]})}if(s==="pie"){const c=Array.isArray(t.data)?t.data:[];return r.jsxs(Ve,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[r.jsxs(rt,{className:"pb-2 flex flex-row items-center justify-between",children:[r.jsx(ot,{className:"text-base font-semibold text-slate-800",children:t.title}),r.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-500",children:"Distribution"})]}),r.jsx(He,{className:"h-56 sm:h-64",children:c.length===0?r.jsx("p",{className:"text-sm text-slate-500 mt-4",children:"No data to display."}):r.jsx(eu,{width:"100%",height:"100%",children:r.jsxs(IC,{children:[r.jsx(mb,{data:c,dataKey:"value",nameKey:"label",outerRadius:80,paddingAngle:3,labelLine:!1,label:d=>`${d.label}: ${d.value??0}`,children:c.map((d,u)=>r.jsx(Zl,{fill:gc[u%gc.length]},`cell-${u}`))}),r.jsx(nu,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12}})]})})})]})}if(s==="multi_bar"){const c=Array.isArray(t.data)?t.data:[],d=((l=t.config)==null?void 0:l.series)||[],u=((o=t.config)==null?void 0:o.x_key)||"label";return r.jsxs(Ve,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[r.jsx(rt,{className:"pb-2",children:r.jsx(ot,{className:"text-base font-semibold text-slate-800",children:t.title})}),r.jsx(He,{className:"h-56 sm:h-64",children:c.length===0?r.jsx("p",{className:"text-sm text-slate-500 mt-4",children:"No data to display."}):r.jsx(eu,{width:"100%",height:"100%",children:r.jsxs(Nb,{data:c,margin:{left:8,right:8,top:8,bottom:8},children:[r.jsx(Ex,{dataKey:u,stroke:"#6b7280",fontSize:11}),r.jsx(Tx,{stroke:"#6b7280",fontSize:11}),r.jsx(nu,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12}}),d.map((h,f)=>r.jsx(Ax,{dataKey:h.key,name:h.label,radius:[4,4,0,0],children:c.map((x,b)=>r.jsx(Zl,{fill:gc[(f+b)%gc.length]},`cell-${h.key}-${b}`))},h.key))]})})})]})}const n=Array.isArray(t.data)?t.data:[],a=n.length>0?n.map((c,d)=>({label:c.label??c.name??`Item ${d+1}`,value:c.value??c.amount??0})):[];return r.jsxs(Ve,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[r.jsxs(rt,{className:"pb-2 flex flex-row items-center justify-between",children:[r.jsx(ot,{className:"text-base font-semibold text-slate-800",children:t.title}),r.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-500",children:t.description?"Insight":"Summary"})]}),r.jsx(He,{className:"h-56 sm:h-64",children:a.length===0?r.jsx("p",{className:"text-sm text-slate-500 mt-4",children:"No data to display."}):r.jsx(eu,{width:"100%",height:"100%",children:r.jsxs(Nb,{data:a,margin:{left:8,right:8,top:8,bottom:8},children:[r.jsx(Ex,{dataKey:"label",stroke:"#6b7280",fontSize:11}),r.jsx(Tx,{stroke:"#6b7280",fontSize:11}),r.jsx(nu,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12}}),r.jsx(Ax,{dataKey:"value",radius:[4,4,0,0],children:a.map((c,d)=>r.jsx(Zl,{fill:gc[d%gc.length]},`cell-${d}`))})]})})})]})}function UR({widget:t}){var a;const s=Array.isArray(t.data)?t.data:[],n=((a=t.config)==null?void 0:a.columns)||(s[0]?Object.keys(s[0]):[]);return r.jsxs(Ve,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[r.jsxs(rt,{className:"pb-2 flex flex-row items-center justify-between",children:[r.jsx(ot,{className:"text-base font-semibold text-slate-800",children:t.title}),r.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-500",children:"Latest records"})]}),r.jsx(He,{className:"space-y-2",children:s.length===0?r.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"No records found."}):r.jsx("div",{className:"flex flex-col gap-2",children:s.map((i,l)=>r.jsx("div",{className:Ft("rounded-xl border border-slate-200 bg-slate-50/60 px-3 py-2.5","flex flex-col gap-1 text-xs md:text-sm"),children:n.map((o,c)=>r.jsxs("div",{className:Ft("flex justify-between gap-2",c===0?"font-semibold text-slate-900":"text-slate-700"),children:[r.jsx("span",{className:"text-[10px] uppercase tracking-wide text-slate-500",children:o.replace(/_/g," ")}),r.jsx("span",{className:"text-right",children:a8e(i[o])})]},o))},l))})})]})}function a8e(t){return t==null?"-":typeof t=="number"?t.toLocaleString("en-IN",{maximumFractionDigits:1}):typeof t=="string"&&t.length>40?t.slice(0,40)+"":String(t)}function i8e(){return J.get("/mis/definitions")}function l8e(t,s){return J.post(`/mis/reports/${t}`,s)}const Rg=["#0f172a","#0f766e","#1e293b","#475569","#64748b"];function jo(t){return t.toISOString().slice(0,10)}function VR(t,s){const n=new Date(t);return n.setDate(n.getDate()+s),n}function o8e(t){if(!t)return"";const s=t.value!==null&&t.value!==void 0?t.value:0;return`${t.label}: ${s}`}const c8e={hidden:{opacity:0,y:12},visible:{opacity:1,y:0,transition:{duration:.35,ease:"easeOut"}}},$f={hidden:{opacity:0,y:8},visible:(t=0)=>({opacity:1,y:0,transition:{duration:.3,ease:"easeOut",delay:t}})},HR={hidden:{},visible:{transition:{staggerChildren:.06}}},i2={hidden:{opacity:0,y:6,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{duration:.25,ease:"easeOut"}}};function d8e(){const t=new Date,[s,n]=y.useState(()=>jo(t)),[a,i]=y.useState(()=>jo(t)),[l,o]=y.useState([]),[c,d]=y.useState(!0),[u,h]=y.useState(""),[f,x]=y.useState({}),[b,v]=y.useState("today"),[w,_]=y.useState(null),[S,k]=y.useState(!1),[A,T]=y.useState(""),[P,O]=y.useState("summary"),D=!!(s&&a);y.useEffect(()=>{let ee=!0;return(async()=>{var ce,ge;d(!0),T("");try{const X=await i8e();if(!ee)return;const de=(X==null?void 0:X.data)||[];o(de),de.length>0&&h(de[0].code)}catch(X){if(console.error(X),!ee)return;T(((ge=(ce=X==null?void 0:X.response)==null?void 0:ce.data)==null?void 0:ge.detail)||"Failed to load MIS report definitions.")}finally{ee&&d(!1)}})(),()=>{ee=!1}},[]);const I=y.useMemo(()=>l.find(ee=>ee.code===u)||null,[l,u]),M=ee=>{v(ee);const te=new Date;if(ee==="today"){const ce=jo(te);n(ce),i(ce)}else if(ee==="7d")n(jo(VR(te,-6))),i(jo(te));else if(ee==="30d")n(jo(VR(te,-29))),i(jo(te));else if(ee==="month"){const ce=new Date(te.getFullYear(),te.getMonth(),1);n(jo(ce)),i(jo(te))}else ee==="custom"&&v("custom")},B=ee=>te=>{v("custom"),ee(te.target.value)},L=(ee,te)=>{x(ce=>({...ce,[ee]:te}))},F=async()=>{var ee,te;if(!u||!D){T("Please select a report and valid date range.");return}k(!0),T(""),_(null);try{const ge=await l8e(u,{date_from:s,date_to:a,filters:f});_((ge==null?void 0:ge.data)||null)}catch(ce){console.error(ce),T(((te=(ee=ce==null?void 0:ce.response)==null?void 0:ee.data)==null?void 0:te.detail)||"Failed to run MIS report. Please check filters and try again.")}finally{k(!1)}},V=y.useMemo(()=>w!=null&&w.cards&&Array.isArray(w.cards)?w.cards:[],[w]),$=y.useMemo(()=>w!=null&&w.charts&&Array.isArray(w.charts)?w.charts:[],[w]),z=(I==null?void 0:I.category)||"MIS",H=$.filter(ee=>ee.type==="bar"),q=$.filter(ee=>ee.type==="pie"),G=(I==null?void 0:I.name)||"No report selected",re=D?`${s}  ${a}`:"Select a date range",ye=S?"Running report":w?"Showing latest results":"Awaiting first run",Ee=[{value:"summary",label:"Summary"},{value:"charts",label:"Charts"}];return w!=null&&w.table&&Ee.push({value:"details",label:"Detailed view"}),r.jsx(at.div,{className:"relative min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-3 sm:px-4 sm:py-4 md:px-6 md:py-6 lg:px-8",variants:c8e,initial:"hidden",animate:"visible",children:r.jsxs("div",{className:"mx-auto w-full max-w-6xl space-y-4 md:space-y-5 lg:space-y-6",children:[r.jsxs(at.div,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-xs md:text-sm",custom:0,variants:$f,initial:"hidden",animate:"visible",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white px-3 py-1.5 text-slate-800 shadow-sm",children:[r.jsx(Rse,{className:"w-4 h-4"}),r.jsx("span",{className:"font-medium",children:"MIS  Management Information System"})]}),r.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500 text-[11px]",children:[r.jsx("span",{className:"inline-flex h-1.5 w-1.5 rounded-full bg-emerald-500 animate-pulse"}),r.jsx("span",{className:"inline-flex md:hidden rounded-full bg-white px-2 py-0.5 uppercase tracking-wide border border-slate-200",children:"Mobile view"}),r.jsx("span",{className:"hidden md:inline-flex lg:hidden rounded-full bg-white px-2 py-0.5 uppercase tracking-wide border border-slate-200",children:"Tablet / Laptop"}),r.jsx("span",{className:"hidden lg:inline-flex rounded-full bg-white px-2 py-0.5 uppercase tracking-wide border border-slate-200",children:"Desktop workspace"})]})]}),r.jsx(at.div,{variants:$f,custom:.05,initial:"hidden",animate:"visible",children:r.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-r from-teal-700 via-teal-600 to-blue-600 text-white shadow-md",children:[r.jsx("div",{className:"absolute inset-0 opacity-20 pointer-events-none bg-[radial-gradient(circle_at_top,_#e0f2fe,_transparent_55%)]"}),r.jsxs("div",{className:"relative flex flex-col gap-4 md:flex-row md:items-center md:justify-between px-4 py-5 sm:px-6 sm:py-6 md:px-8 md:py-7 lg:px-10 lg:py-8",children:[r.jsxs("div",{className:"space-y-3 max-w-xl",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-white/10 px-3 py-1 text-xs font-medium backdrop-blur-sm border border-white/20",children:[r.jsx("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-white/20 text-[11px]",children:"MIS"}),"Clean, focused analytics for your hospital"]}),r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"inline-flex h-11 w-11 md:h-12 md:w-12 items-center justify-center rounded-3xl bg-white/10 text-white shadow-sm border border-white/20",children:r.jsx(Kf,{className:"w-6 h-6"})}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("h1",{className:"text-xl md:text-2xl lg:text-3xl font-semibold tracking-tight",children:"MIS Reports Console"}),r.jsxs("p",{className:"text-sm md:text-base text-teal-50/90 leading-relaxed",children:["Generate"," ",r.jsx("span",{className:"font-semibold",children:"clinical, operational and financial"})," ","MIS reports in a light, distraction-free workspace."]})]})]}),(I==null?void 0:I.description)&&r.jsx("p",{className:"text-xs sm:text-sm text-teal-50/90",children:I.description})]}),r.jsxs("div",{className:"w-full md:w-auto space-y-3",children:[r.jsxs("div",{className:"flex flex-wrap gap-2 justify-start md:justify-end",children:[r.jsx(Ze,{className:"bg-white/15 text-xs font-semibold border border-white/25 text-white rounded-full px-3 py-1",children:"IPD / OPD Ready"}),r.jsx(Ze,{className:"bg-white/10 text-xs border border-white/20 text-teal-50 rounded-full px-3 py-1",children:"NABH-aligned KPIs"}),r.jsx(Ze,{className:"bg-white/10 text-xs border border-white/20 text-teal-50 rounded-full px-3 py-1",children:z})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 text-xs",children:[r.jsxs("div",{className:"rounded-2xl bg-white/10 px-3 py-2.5 flex flex-col gap-1 border border-white/15",children:[r.jsx("span",{className:"text-[11px] font-medium text-teal-50/80 uppercase tracking-wide",children:"Active report"}),r.jsx("span",{className:"text-sm font-semibold line-clamp-2",children:G})]}),r.jsxs("div",{className:"rounded-2xl bg-white/10 px-3 py-2.5 flex flex-col gap-1 border border-white/15",children:[r.jsx("span",{className:"text-[11px] font-medium text-teal-50/80 uppercase tracking-wide",children:"Date range"}),r.jsx("span",{className:"text-sm font-semibold",children:re})]}),r.jsxs("div",{className:"rounded-2xl bg-white/10 px-3 py-2.5 flex flex-col gap-1 border border-white/15",children:[r.jsx("span",{className:"text-[11px] font-medium text-teal-50/80 uppercase tracking-wide",children:"Status"}),r.jsxs("span",{className:"text-sm font-semibold flex items-center gap-1.5",children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-300 animate-pulse"}),ye]})]})]})]})]})]})}),r.jsx(vl,{children:A&&r.jsx(at.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},children:r.jsxs(Ui,{className:"bg-red-50 border-red-200 text-red-800 rounded-2xl",children:[r.jsx(nn,{className:"h-4 w-4 mt-0.5"}),r.jsxs("div",{children:[r.jsx(Vi,{className:"text-red-900 font-semibold",children:"MIS error"}),r.jsx(Hi,{className:"text-red-800/90 text-sm",children:A})]})]})})}),r.jsxs(at.div,{variants:$f,custom:.1,initial:"hidden",animate:"visible",className:"grid gap-4 lg:gap-5 lg:grid-cols-[minmax(0,320px)_minmax(0,1fr)] xl:grid-cols-[minmax(0,340px)_minmax(0,1fr)]",children:[r.jsxs("div",{className:"space-y-3 lg:space-y-4 lg:sticky lg:top-24 self-start",children:[r.jsxs(Ve,{className:"rounded-2xl border border-slate-200 bg-white shadow-sm",children:[r.jsx(rt,{className:"pb-2 flex flex-row items-center justify-between gap-2",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"h-8 w-8 rounded-xl bg-teal-600 text-white flex items-center justify-center",children:r.jsx(Kf,{className:"w-4 h-4"})}),r.jsxs("div",{children:[r.jsx(ot,{className:"text-sm font-semibold text-slate-900",children:"Report & Date"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Choose MIS view and time window"})]})]})}),r.jsxs(He,{className:"space-y-3 pb-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("span",{className:"text-xs font-medium text-slate-800",children:"Report"}),r.jsxs("span",{className:"text-[11px] text-slate-500 flex items-center gap-1",children:[r.jsx($r,{className:"w-3 h-3"}),"MIS group"]})]}),c?r.jsx(We,{className:"h-9 rounded-xl bg-slate-100"}):r.jsxs(Fs,{value:u,onValueChange:ee=>{h(ee),_(null)},children:[r.jsx(Ds,{className:"h-9 rounded-xl border-slate-200 bg-white text-xs text-slate-900 focus:ring-teal-200",children:r.jsx($s,{placeholder:"Select report"})}),r.jsx(Os,{className:"bg-white border-slate-200 text-slate-900 max-h-72",children:l.map(ee=>r.jsx(zt,{value:String(ee.code),className:"text-xs",children:ee.name},ee.code))})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs font-medium text-slate-800",children:"Quick ranges"}),r.jsx("div",{className:"flex flex-wrap gap-1.5",children:[{key:"today",label:"Today"},{key:"7d",label:"Last 7 days"},{key:"30d",label:"Last 30 days"},{key:"month",label:"This month"},{key:"custom",label:"Custom"}].map(ee=>r.jsx("button",{type:"button",onClick:()=>M(ee.key),className:Ft("px-3 py-1 rounded-full text-[11px] font-medium border transition-colors",b===ee.key?"bg-blue-600 text-white border-blue-600":"bg-white text-slate-700 border-slate-200 hover:bg-slate-50"),children:ee.label},ee.key))})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("span",{className:"text-xs font-medium text-slate-800",children:"Custom date range"}),r.jsx("div",{className:"flex flex-col gap-2",children:r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-2.5 py-2",children:[r.jsx(E_,{className:"w-4 h-4 text-slate-500 shrink-0"}),r.jsxs("div",{className:"flex flex-col gap-2 w-full text-xs text-slate-800",children:[r.jsxs("div",{className:"flex items-center gap-2 w-full",children:[r.jsx("span",{className:"w-10 text-[11px] text-slate-500",children:"From"}),r.jsx(Se,{type:"date",value:s,onChange:B(n),className:"h-8 w-full rounded-lg border-slate-200 bg-slate-50 text-xs text-slate-900"})]}),r.jsxs("div",{className:"flex items-center gap-2 w-full",children:[r.jsx("span",{className:"w-10 text-[11px] text-slate-500",children:"To"}),r.jsx(Se,{type:"date",value:a,onChange:B(i),className:"h-8 w-full rounded-lg border-slate-200 bg-slate-50 text-xs text-slate-900"})]})]})]})})]}),r.jsx("div",{className:"pt-1",children:r.jsx(Te,{size:"sm",className:"h-9 w-full rounded-full inline-flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold text-sm",onClick:F,disabled:S||!u||!D,children:S?r.jsxs(r.Fragment,{children:[r.jsx(_u,{className:"w-4 h-4 animate-spin"}),"Running report"]}):r.jsxs(r.Fragment,{children:[r.jsx(_u,{className:"w-4 h-4"}),"Run MIS report"]})})})]})]}),I&&Array.isArray(I.filters)&&I.filters.length>0&&r.jsxs(Ve,{className:"rounded-2xl border border-slate-200 bg-white shadow-sm",children:[r.jsxs(rt,{className:"pb-2 flex flex-row items-center justify-between gap-2",children:[r.jsxs(ot,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:[r.jsx($r,{className:"w-4 h-4 text-slate-500"}),"Advanced filters"]}),r.jsx("span",{className:"text-[11px] text-slate-500",children:"Tailor output for this report"})]}),r.jsx(He,{className:"pb-3",children:r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:I.filters.map(ee=>ee.type==="select"&&Array.isArray(ee.options)?r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("span",{className:"text-xs font-medium text-slate-800",children:ee.label}),ee.required&&r.jsx("span",{className:"text-[11px] text-rose-500",children:"*"})]}),r.jsxs(Fs,{value:f[ee.key]!==void 0?String(f[ee.key]):"",onValueChange:te=>L(ee.key,te),children:[r.jsx(Ds,{className:"h-9 rounded-xl border-slate-200 bg-slate-50 text-xs text-slate-900",children:r.jsx($s,{placeholder:`All ${ee.label.toLowerCase()}`})}),r.jsxs(Os,{className:"bg-white border-slate-200 text-slate-900 max-h-64",children:[r.jsx(zt,{value:"__ALL__",className:"text-xs text-slate-500",children:"All"}),ee.options.map(te=>r.jsx(zt,{value:String(te.value),className:"text-xs",children:te.label},te.value))]})]})]},ee.key):r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("span",{className:"text-xs font-medium text-slate-800",children:ee.label}),ee.required&&r.jsx("span",{className:"text-[11px] text-rose-500",children:"*"})]}),r.jsx(Se,{value:f[ee.key]??"",onChange:te=>L(ee.key,te.target.value),placeholder:`Filter by ${ee.label.toLowerCase()}`,className:"h-9 rounded-xl border-slate-200 bg-slate-50 text-xs text-slate-900 placeholder:text-slate-400"})]},ee.key))})})]})]}),r.jsxs("div",{className:"space-y-3 lg:space-y-4",children:[!S&&!w&&r.jsx(Ve,{className:"rounded-2xl border border-dashed border-slate-300 bg-white shadow-none",children:r.jsxs(He,{className:"py-10 px-4 sm:px-8 flex flex-col items-center justify-center text-center gap-3",children:[r.jsx("div",{className:"h-12 w-12 rounded-full bg-slate-100 flex items-center justify-center border border-slate-200 mb-1",children:r.jsx(Kf,{className:"w-6 h-6 text-slate-700"})}),r.jsx("h2",{className:"text-base md:text-lg font-semibold text-slate-900",children:"Run your first MIS report"}),r.jsxs("p",{className:"text-sm text-slate-600 max-w-md",children:["Select a report on the left, choose a date range, add filters if needed and click"," ",r.jsx("span",{className:"font-semibold text-slate-900",children:"Run MIS report"})," ","to see KPIs, charts and detailed records."]})]})}),S&&r.jsxs(at.div,{className:"space-y-4",variants:$f,custom:.15,initial:"hidden",animate:"visible",children:[r.jsx(We,{className:"h-16 rounded-2xl bg-white/80"}),r.jsx(We,{className:"h-64 rounded-2xl bg-white/80"}),r.jsx(We,{className:"h-64 rounded-2xl bg-white/80"})]}),!S&&w&&r.jsx(at.div,{variants:$f,custom:.15,initial:"hidden",animate:"visible",children:r.jsxs(jl,{value:P,onValueChange:O,className:"w-full",children:[r.jsx("div",{className:"sticky top-[4.25rem] z-10 mb-2 bg-slate-50/95 backdrop-blur-sm border-b border-slate-200/80 pb-2 md:hidden",children:r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("span",{className:"text-[11px] text-slate-600 font-medium",children:"Section"}),r.jsx("div",{className:"relative",children:r.jsx("select",{className:"w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500",value:P,onChange:ee=>O(ee.target.value),children:Ee.map(ee=>r.jsx("option",{value:ee.value,children:ee.label},ee.value))})})]})}),r.jsxs("div",{className:"hidden md:flex md:flex-row md:items-center md:justify-between gap-2 mb-2",children:[r.jsx(Wi,{className:"flex flex-nowrap overflow-x-auto gap-1 rounded-full bg-slate-100 p-1 border border-slate-200",children:Ee.map(ee=>r.jsx(ms,{value:ee.value,className:"px-3 py-1.5 text-xs sm:text-sm rounded-full data-[state=active]:bg-white data-[state=active]:text-slate-900 data-[state=active]:shadow-sm",children:ee.label},ee.value))}),r.jsxs("div",{className:"hidden md:flex items-center gap-2 text-xs text-slate-500",children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 animate-pulse"}),r.jsxs("span",{children:["Generated for"," ",r.jsx("span",{className:"font-semibold text-slate-800",children:w.name})]})]})]}),r.jsxs(us,{value:"summary",className:"space-y-4 mt-2",children:[V.length>0&&r.jsxs("section",{className:"space-y-2",children:[r.jsxs("h2",{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:[r.jsx("span",{className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-slate-100 text-slate-700 border border-slate-200",children:r.jsx(Kf,{className:"w-3 h-3"})}),"Key indicators"]}),r.jsx(at.div,{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 md:gap-4",variants:HR,initial:"hidden",animate:"visible",children:V.map((ee,te)=>r.jsx(at.div,{variants:i2,children:r.jsx(u8e,{card:ee})},te))})]}),H[0]&&r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"Primary trend"}),r.jsx(l2,{chart:H[0]})]})]}),r.jsx(us,{value:"charts",className:"space-y-4 mt-2",children:r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"Chart views"}),r.jsxs(at.div,{className:"grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-3 md:gap-4",variants:HR,initial:"hidden",animate:"visible",children:[H.map(ee=>r.jsx(at.div,{variants:i2,children:r.jsx(l2,{chart:ee})},ee.code)),q.map(ee=>r.jsx(at.div,{variants:i2,children:r.jsx(l2,{chart:ee})},ee.code))]})]})}),w.table&&r.jsx(us,{value:"details",className:"space-y-4 mt-2",children:r.jsxs("section",{className:"space-y-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"Detailed records"}),r.jsx(h8e,{table:w.table})]})})]})})]})]})]})})}function u8e({card:t}){return r.jsxs(at.div,{whileHover:{y:-2,scale:1.01},transition:{type:"spring",stiffness:240,damping:22},className:Ft("rounded-2xl border border-slate-200 bg-white px-4 py-3 shadow-sm","flex flex-col gap-1.5"),children:[r.jsx("div",{className:"text-[11px] uppercase tracking-wide font-semibold text-slate-500",children:t.label}),r.jsx("div",{className:"text-xl md:text-2xl font-semibold leading-tight text-slate-900",children:typeof t.value=="number"?t.value.toLocaleString("en-IN",{maximumFractionDigits:1}):t.value}),t.helper&&r.jsx("div",{className:"text-xs text-slate-500",children:t.helper})]})}function l2({chart:t}){const s=t.type||"bar",n=Array.isArray(t.data)?t.data:[],a=t.config||{};if(s==="pie"){const l=n.length>0?n.map((o,c)=>({label:o.label??o.name??`Item ${c+1}`,value:o.value??o.amount??0})):[];return r.jsxs(Ve,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[r.jsxs(rt,{className:"pb-2 flex flex-row items-center justify-between",children:[r.jsx(ot,{className:"text-base font-semibold text-slate-900",children:t.title}),r.jsx("span",{className:"rounded-full bg-slate-50 px-2 py-0.5 text-[11px] text-slate-600 border border-slate-200",children:"Distribution"})]}),r.jsx(He,{className:"h-56 sm:h-64",children:l.length===0?r.jsx("p",{className:"text-sm text-slate-500 mt-4",children:"No data to display."}):r.jsx(eu,{width:"100%",height:"100%",children:r.jsxs(IC,{children:[r.jsx(mb,{data:l,dataKey:"value",nameKey:"label",outerRadius:80,paddingAngle:3,labelLine:!1,label:o8e,children:l.map((o,c)=>r.jsx(Zl,{fill:Rg[c%Rg.length]},`cell-${c}`))}),r.jsx(nu,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12,color:"#111827"}})]})})})]})}const i=n.length>0?n.map((l,o)=>({label:l.label??l.name??`Item ${o+1}`,value:l.value??l.amount??0})):[];return r.jsxs(Ve,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[r.jsxs(rt,{className:"pb-2 flex flex-row items-center justify-between",children:[r.jsx(ot,{className:"text-base font-semibold text-slate-900",children:t.title}),r.jsx("span",{className:"rounded-full bg-slate-50 px-2 py-0.5 text-[11px] text-slate-600 border border-slate-200",children:(a==null?void 0:a.label)||"Trend"})]}),r.jsx(He,{className:"h-56 sm:h-64",children:i.length===0?r.jsx("p",{className:"text-sm text-slate-500 mt-4",children:"No data to display."}):r.jsx(eu,{width:"100%",height:"100%",children:r.jsxs(Nb,{data:i,margin:{left:8,right:8,top:8,bottom:8},children:[r.jsx(Ex,{dataKey:"label",stroke:"#9ca3af",fontSize:11,tickLine:!1,axisLine:{stroke:"#e5e7eb"}}),r.jsx(Tx,{stroke:"#9ca3af",fontSize:11,tickLine:!1,axisLine:{stroke:"#e5e7eb"}}),r.jsx(nu,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12,color:"#111827"}}),r.jsx(Ax,{dataKey:"value",radius:[4,4,0,0],children:i.map((l,o)=>r.jsx(Zl,{fill:Rg[o%Rg.length]},`cell-${o}`))})]})})})]})}function h8e({table:t}){const s=Array.isArray(t.rows)?t.rows:[],n=t.columns&&t.columns.length>0?t.columns:s[0]?Object.keys(s[0]):[],[a,i]=y.useState(""),[l,o]=y.useState("all");if(s.length===0)return r.jsx(Ve,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:r.jsx(He,{className:"py-6 flex items-center justify-center",children:r.jsx("p",{className:"text-sm text-slate-500",children:"No records found."})})});const c=[{key:"all",label:"All"},{key:"nonZero",label:"Non-zero values"}],d=s.filter(h=>!(a&&!Object.values(h).map(x=>x==null?"":String(x)).join(" ").toLowerCase().includes(a.toLowerCase())||l==="nonZero"&&!Object.values(h).some(x=>typeof x=="number"&&x>0))),u=()=>{const h=n.join(","),f=d.map(w=>n.map(_=>{const S=w[_],k=S==null?"":String(S);return k.includes(",")||k.includes('"')||k.includes(`
`)?`"${k.replace(/"/g,'""')}"`:k}).join(",")).join(`
`),x=new Blob([h+`
`+f],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(x),v=document.createElement("a");v.href=b,v.download="mis-report.csv",v.click(),URL.revokeObjectURL(b)};return r.jsx(Ve,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:r.jsxs(He,{className:"py-3 flex flex-col gap-3 max-h-[520px] md:max-h-[560px] overflow-hidden",children:[r.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"relative w-full sm:w-64",children:[r.jsx(es,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),r.jsx("input",{type:"text",value:a,onChange:h=>i(h.target.value),placeholder:"Search in records",className:"w-full rounded-xl border border-slate-200 bg-white pl-9 pr-3 py-2 text-sm text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500"})]}),r.jsx("div",{className:"flex flex-wrap gap-1.5",children:c.map(h=>r.jsx("button",{type:"button",onClick:()=>o(h.key),className:Ft("inline-flex items-center rounded-full px-3 py-1 text-xs sm:text-sm transition",l===h.key?"bg-blue-600 text-white shadow-sm":"bg-slate-100 text-slate-600 hover:bg-slate-200"),children:h.label},h.key))})]}),r.jsx("div",{className:"flex justify-start sm:justify-end",children:r.jsxs(Te,{type:"button",onClick:u,className:"inline-flex items-center gap-2 rounded-full bg-blue-600 px-4 py-2 text-xs sm:text-sm font-semibold text-white hover:bg-blue-700 active:scale-95 transition",children:[r.jsx(to,{className:"w-4 h-4"}),"Export CSV"]})})]}),r.jsxs("div",{className:"mt-1 flex-1 overflow-y-auto pr-1.5",children:[r.jsx("div",{className:"hidden md:block",children:r.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200",children:r.jsxs("table",{className:"min-w-full text-xs md:text-sm bg-white",children:[r.jsx("thead",{className:"bg-slate-50 sticky top-0 z-10",children:r.jsx("tr",{children:n.map(h=>r.jsx("th",{className:"px-3 py-2 text-left text-[11px] font-medium uppercase tracking-wide text-slate-600 border-b border-slate-200",children:h.replace(/_/g," ")},h))})}),r.jsx("tbody",{children:d.map((h,f)=>r.jsx("tr",{className:"border-t border-slate-100 hover:bg-slate-50/80 transition-colors",children:n.map((x,b)=>r.jsx("td",{className:Ft("px-3 py-2 text-[11px] md:text-sm text-slate-800 align-top",b===0&&"font-semibold text-slate-900"),children:r.jsx("span",{className:"line-clamp-2",children:WR(h[x])})},x))},f))})]})})}),r.jsx("div",{className:"grid gap-3 md:hidden mt-1",children:r.jsx(vl,{children:d.map((h,f)=>r.jsx(at.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},transition:{duration:.2,ease:"easeOut"},className:"rounded-2xl border border-slate-200 bg-white px-3 py-2.5 shadow-sm flex flex-col gap-1",children:n.map((x,b)=>r.jsxs("div",{className:Ft("flex justify-between gap-2",b===0?"font-semibold text-slate-900":"text-slate-700"),children:[r.jsx("span",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:x.replace(/_/g," ")}),r.jsx("span",{className:"text-xs text-right truncate max-w-[60%]",children:WR(h[x])})]},x))},f))})})]})]})})}function WR(t){return t==null?"":typeof t=="number"?t.toLocaleString("en-IN",{maximumFractionDigits:1}):typeof t=="string"&&t.length>80?t.slice(0,80)+"":String(t)}const LK=t=>{let s={};return typeof t=="string"?t&&(s.q=t):t&&typeof t=="object"&&(s=t),J.get("/patients",{params:s})};function m8e(t){return J.get(`/patients/${t}`)}function f8e(t){return J.post("/patients",t)}function p8e(t,s){return J.put(`/patients/${t}`,s)}function x8e(t){return J.patch(`/patients/${t}/deactivate`)}function g8e(t,{type:s,file:n}){const a=new FormData;return a.append("type",s||"other"),a.append("file",n),J.post(`/patients/${t}/documents`,a,{headers:{"Content-Type":"multipart/form-data"}})}function y8e(t){return J.get(`/patients/${t}/documents`)}function b8e(t){return J.get(`/patients/${t}/consents`)}function v8e(t,s){return J.post(`/patients/${t}/consents`,s)}async function N8e(t){const s=await J.get(`/patients/${t}/print-info`,{responseType:"blob"}),n=s.headers["content-type"]||"application/octet-stream",a=new Blob([s.data],{type:n}),i=URL.createObjectURL(a);window.open(i,"_blank")}function w8e(){return J.get("/patient-masters/all")}function j8e(t){return J.get("/patients/export",{params:t,responseType:"blob"})}function _8e(t,s={}){const n={table_name:"patients",record_id:t,...s};return J.get("/audit-logs",{params:n})}const S8e=["","A+","A-","B+","B-","O+","O-","AB+","AB-"],C8e=["","Single","Married","Widowed","Divorced"],k8e=["","Mr","Ms","Mrs","Dr","Baby","Master"],A8e=[{code:"OPD",name:"OPD"},{code:"IPD",name:"IPD"},{code:"EMERGENCY",name:"Emergency"},{code:"HEALTH_CHECK",name:"Health Check"},{code:"CAMP",name:"Camp"},{code:"CORPORATE",name:"Corporate"},{code:"INSURANCE",name:"Insurance"}],E8e=["","insurance","corporate","govt","other"],T8e={prefix:"",first_name:"",last_name:"",gender:"",dob:"",phone:"",email:"",blood_group:"",marital_status:"",ref_source:"",ref_doctor_id:"",ref_details:"",id_proof_type:"",id_proof_no:"",guardian_name:"",guardian_phone:"",guardian_relation:"",patient_type:"",tag:"",religion:"",occupation:"",file_number:"",file_location:"",credit_type:"",credit_payer_id:"",credit_tpa_id:"",credit_plan_id:"",principal_member_name:"",principal_member_address:"",policy_number:"",policy_name:"",family_id:"",address:{type:"current",line1:"",line2:"",city:"",state:"",pincode:"",country:"India"}};function MC(){return JSON.parse(JSON.stringify(T8e))}function P8e(t){if(!t)return MC();const s=t.addresses&&t.addresses[0]||null;return{prefix:t.prefix||"",first_name:t.first_name||"",last_name:t.last_name||"",gender:t.gender||"",dob:t.dob||"",phone:t.phone||"",email:t.email||"",blood_group:t.blood_group||"",marital_status:t.marital_status||"",ref_source:t.ref_source||"",ref_doctor_id:t.ref_doctor_id||"",ref_details:t.ref_details||"",id_proof_type:t.id_proof_type||"",id_proof_no:t.id_proof_no||"",guardian_name:t.guardian_name||"",guardian_phone:t.guardian_phone||"",guardian_relation:t.guardian_relation||"",patient_type:t.patient_type||"",tag:t.tag||"",religion:t.religion||"",occupation:t.occupation||"",file_number:t.file_number||"",file_location:t.file_location||"",credit_type:t.credit_type||"",credit_payer_id:t.credit_payer_id||"",credit_tpa_id:t.credit_tpa_id||"",credit_plan_id:t.credit_plan_id||"",principal_member_name:t.principal_member_name||"",principal_member_address:t.principal_member_address||"",policy_number:t.policy_number||"",policy_name:t.policy_name||"",family_id:t.family_id||"",address:{type:(s==null?void 0:s.type)||"current",line1:(s==null?void 0:s.line1)||"",line2:(s==null?void 0:s.line2)||"",city:(s==null?void 0:s.city)||"",state:(s==null?void 0:s.state)||"",pincode:(s==null?void 0:s.pincode)||"",country:(s==null?void 0:s.country)||"India"}}}function zf(t){if(t==null||t==="")return null;const s=Number(t);return Number.isNaN(s)?null:s}function I8e(t){var i,l,o;let s="Failed to save patient";const n={},a=(l=(i=t==null?void 0:t.response)==null?void 0:i.data)==null?void 0:l.detail;if(Array.isArray(a)){s="Please correct the highlighted fields.";for(const c of a){const d=c.loc||[],u=c.msg||"Invalid value";if(d[0]==="body"&&d.length>=2)if(d[1]==="address"&&d[2]){const h=`address.${d[2]}`;n[h]=n[h]?`${n[h]}; ${u}`:u}else{const h=d[1];n[h]=n[h]?`${n[h]}; ${u}`:u}}!Object.keys(n).length&&((o=a[0])!=null&&o.msg)&&(s=a[0].msg)}else typeof a=="string"?s=a:a&&typeof a=="object"&&a.msg?s=a.msg:t!=null&&t.message&&(s=t.message);return{generalMessage:s,fieldErrors:n}}function M8e({open:t,onClose:s,onSaved:n,initialPatient:a,lookups:i}){const[l,o]=y.useState(MC),[c,d]=y.useState(!1),[u,h]=y.useState(""),[f,x]=y.useState({}),b=y.useMemo(()=>a?"edit":"create",[a]);if(y.useEffect(()=>{t&&(h(""),x({}),o(a?P8e(a):MC()))},[t,a]),!t)return null;const v=L=>F=>{let V=F.target.value;L==="phone"&&(V=V.replace(/\D/g,"").slice(0,10)),o($=>({...$,[L]:V})),x($=>{const z={...$};return delete z[L],z})},w=L=>F=>{const V=F.target.value;o($=>({...$,address:{...$.address,[L]:V}})),x($=>{const z=`address.${L}`,H={...$};return delete H[z],H})},_=async L=>{var F;L.preventDefault(),h(""),x({}),d(!0);try{const V={...l,ref_doctor_id:zf(l.ref_doctor_id),credit_payer_id:zf(l.credit_payer_id),credit_tpa_id:zf(l.credit_tpa_id),credit_plan_id:zf(l.credit_plan_id),family_id:zf(l.family_id),credit_type:l.credit_type||null,patient_type:l.patient_type||null};let $;b==="create"?$=await f8e(V):$=await p8e(a.id,V),n&&n($.data),s&&s()}catch(V){console.error("Patient save error:",((F=V==null?void 0:V.response)==null?void 0:F.data)||V);const{generalMessage:$,fieldErrors:z}=I8e(V);h($),x(z)}finally{d(!1)}},{refSources:S,doctors:k,payers:A,tpas:T,creditPlans:P,patientTypes:O}=i||{},D=O&&O.length?O:A8e,I=L=>!!f[L],M=L=>f[L]?r.jsx("p",{className:"mt-0.5 text-[11px] text-red-600",children:f[L]}):null,B="w-full rounded-xl border px-3 py-2 text-sm text-slate-800 bg-white focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500";return r.jsx("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black/40 backdrop-blur-sm",onClick:s,children:r.jsxs("div",{className:"w-full bg-white rounded-t-3xl sm:rounded-3xl shadow-2xl max-h-[90vh] sm:max-h-[90vh] sm:max-w-5xl mx-auto overflow-hidden flex flex-col",onClick:L=>L.stopPropagation(),children:[r.jsxs("div",{className:"px-4 sm:px-6 py-3 border-b border-slate-200 flex items-center justify-between",children:[r.jsxs("div",{className:"space-y-0.5",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("h2",{className:"text-base sm:text-lg font-semibold text-slate-900",children:b==="create"?"New Patient":"Edit Patient"}),r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-900/5 px-2 py-0.5 text-[11px] font-medium text-slate-700",children:b==="create"?"Create":"Update"}),(a==null?void 0:a.uhid)&&r.jsxs("span",{className:"inline-flex items-center rounded-full bg-slate-50 px-2 py-0.5 text-[11px] font-mono text-slate-700 border border-slate-200",children:["UHID: ",a.uhid]})]}),r.jsx("p",{className:"text-xs text-slate-500",children:"Fill basic details, address and credit / insurance information."})]}),r.jsx("button",{type:"button",onClick:s,className:"h-8 w-8 flex items-center justify-center rounded-full hover:bg-slate-100 text-slate-500 hover:text-slate-900 text-lg leading-none",children:""})]}),r.jsxs("form",{onSubmit:_,className:"flex-1 flex flex-col overflow-hidden bg-slate-50/80",children:[r.jsxs("div",{className:"flex-1 overflow-y-auto px-4 sm:px-6 py-4 space-y-5",children:[u&&r.jsx("div",{className:"rounded-2xl border border-red-200 bg-red-50/80 px-3 py-2 text-xs sm:text-sm text-red-700",children:u}),r.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-3",children:[r.jsx("div",{className:"flex items-center justify-between gap-2",children:r.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Basic Information"})}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:["Prefix",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("select",{className:`${B} ${I("prefix")?"border-red-300":"border-slate-200"}`,value:l.prefix,onChange:v("prefix"),required:!0,children:k8e.map(L=>r.jsx("option",{value:L,children:L||"Select"},L))}),M("prefix")]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:["First Name",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{className:`${B} ${I("first_name")?"border-red-300":"border-slate-200"}`,value:l.first_name,onChange:v("first_name"),required:!0}),M("first_name")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Last Name"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.last_name,onChange:v("last_name")})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:["Gender",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{className:`${B} ${I("gender")?"border-red-300":"border-slate-200"}`,value:l.gender,onChange:v("gender"),required:!0,children:[r.jsx("option",{value:"",children:"Select"}),r.jsx("option",{value:"male",children:"Male"}),r.jsx("option",{value:"female",children:"Female"}),r.jsx("option",{value:"other",children:"Other"})]}),M("gender")]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:["Date of Birth",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"date",className:`${B} ${I("dob")?"border-red-300":"border-slate-200"}`,value:l.dob||"",onChange:v("dob"),required:!0}),M("dob")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Blood Group"}),r.jsx("select",{className:`${B} border-slate-200`,value:l.blood_group,onChange:v("blood_group"),children:S8e.map(L=>r.jsx("option",{value:L,children:L||"Select"},L))})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:["Marital Status",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("select",{className:`${B} ${I("marital_status")?"border-red-300":"border-slate-200"}`,value:l.marital_status,onChange:v("marital_status"),required:!0,children:C8e.map(L=>r.jsx("option",{value:L,children:L||"Select"},L))}),M("marital_status")]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:["Mobile",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{className:`${B} ${I("phone")?"border-red-300":"border-slate-200"}`,value:l.phone,onChange:v("phone"),required:!0}),r.jsx("p",{className:"mt-0.5 text-[11px] text-slate-400",children:"10 digit mobile number"}),M("phone")]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:["Email",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"email",className:`${B} ${I("email")?"border-red-300":"border-slate-200"}`,value:l.email,onChange:v("email"),required:!0}),M("email")]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:["Patient Type",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{className:`${B} ${I("patient_type")?"border-red-300":"border-slate-200"}`,value:l.patient_type||"",onChange:v("patient_type"),required:!0,children:[r.jsx("option",{value:"",children:"Select"}),D.map(L=>r.jsx("option",{value:L.code||L.name,children:L.name||L.code},L.code||L.name))]}),M("patient_type")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Tag"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.tag,onChange:v("tag")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Religion"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.religion,onChange:v("religion")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Occupation"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.occupation,onChange:v("occupation")})]})]})]}),r.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-3",children:[r.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Reference & Guardian"}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Reference Source"}),r.jsxs("select",{className:`${B} border-slate-200`,value:l.ref_source,onChange:v("ref_source"),children:[r.jsx("option",{value:"",children:"Select"}),S==null?void 0:S.map(L=>r.jsx("option",{value:L.code,children:L.label},L.code))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Referring Doctor"}),r.jsxs("select",{className:`${B} border-slate-200`,value:l.ref_doctor_id||"",onChange:v("ref_doctor_id"),children:[r.jsx("option",{value:"",children:"Select"}),k==null?void 0:k.map(L=>r.jsxs("option",{value:L.id,children:[L.name,L.department_name?` (${L.department_name})`:""]},L.id))]})]}),r.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Reference Details"}),r.jsx("textarea",{rows:2,className:`${B} border-slate-200 min-h-[72px]`,value:l.ref_details,onChange:v("ref_details")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Guardian Name"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.guardian_name,onChange:v("guardian_name")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Guardian Phone"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.guardian_phone,onChange:v("guardian_phone")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Guardian Relation"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.guardian_relation,onChange:v("guardian_relation")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"ID Proof Type"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.id_proof_type,onChange:v("id_proof_type")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"ID Proof No"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.id_proof_no,onChange:v("id_proof_no")})]})]})]}),r.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-3",children:[r.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Address"}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[r.jsxs("div",{className:"sm:col-span-2",children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Address Line 1"}),r.jsx("input",{className:`${B} ${I("address.line1")?"border-red-300":"border-slate-200"}`,value:l.address.line1,onChange:w("line1")}),M("address.line1")]}),r.jsxs("div",{className:"sm:col-span-2",children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Address Line 2"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.address.line2,onChange:w("line2")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"City"}),r.jsx("input",{className:`${B} ${I("address.city")?"border-red-300":"border-slate-200"}`,value:l.address.city,onChange:w("city")}),M("address.city")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"State"}),r.jsx("input",{className:`${B} ${I("address.state")?"border-red-300":"border-slate-200"}`,value:l.address.state,onChange:w("state")}),M("address.state")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Pincode"}),r.jsx("input",{className:`${B} ${I("address.pincode")?"border-red-300":"border-slate-200"}`,value:l.address.pincode,onChange:w("pincode")}),M("address.pincode")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Country"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.address.country,onChange:w("country")})]})]})]}),r.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-3",children:[r.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"File & Credit / Insurance"}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"File Number"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.file_number,onChange:v("file_number")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"File Location"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.file_location,onChange:v("file_location")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Credit Type"}),r.jsx("select",{className:`${B} border-slate-200`,value:l.credit_type,onChange:v("credit_type"),children:E8e.map(L=>r.jsx("option",{value:L,children:L||"Select"},L))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Payer"}),r.jsxs("select",{className:`${B} border-slate-200`,value:l.credit_payer_id||"",onChange:v("credit_payer_id"),children:[r.jsx("option",{value:"",children:"Select"}),A==null?void 0:A.map(L=>r.jsx("option",{value:L.id,children:L.display_name||L.name},L.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"TPA"}),r.jsxs("select",{className:`${B} border-slate-200`,value:l.credit_tpa_id||"",onChange:v("credit_tpa_id"),children:[r.jsx("option",{value:"",children:"Select"}),T==null?void 0:T.map(L=>r.jsx("option",{value:L.id,children:L.display_name||L.name},L.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Credit Plan"}),r.jsxs("select",{className:`${B} border-slate-200`,value:l.credit_plan_id||"",onChange:v("credit_plan_id"),children:[r.jsx("option",{value:"",children:"Select"}),P==null?void 0:P.map(L=>r.jsx("option",{value:L.id,children:L.name},L.id))]})]}),r.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Principal Member Name"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.principal_member_name,onChange:v("principal_member_name")})]}),r.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Principal Member Address"}),r.jsx("textarea",{rows:2,className:`${B} border-slate-200 min-h-[72px]`,value:l.principal_member_address,onChange:v("principal_member_address")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Policy Number"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.policy_number,onChange:v("policy_number")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Policy Name"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.policy_name,onChange:v("policy_name")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-800 mb-1",children:"Family ID"}),r.jsx("input",{className:`${B} border-slate-200`,value:l.family_id,onChange:v("family_id")})]})]})]})]}),r.jsxs("div",{className:"border-t border-slate-200 px-4 sm:px-6 py-3 bg-white flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-2",children:[r.jsxs("p",{className:"text-[11px] text-slate-500",children:["Fields marked with ",r.jsx("span",{className:"text-red-500",children:"*"})," are mandatory."]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx("button",{type:"button",onClick:s,className:"inline-flex items-center justify-center rounded-full border border-slate-200 px-3 py-1.5 text-sm font-semibold text-slate-700 hover:bg-slate-50 transition disabled:opacity-60",disabled:c,children:"Cancel"}),r.jsx("button",{type:"submit",className:"inline-flex items-center justify-center rounded-full bg-blue-600 px-4 py-1.5 text-sm font-semibold text-white shadow-sm hover:bg-blue-700 active:scale-95 transition disabled:opacity-60",disabled:c,children:c?b==="create"?"Creating...":"Saving...":b==="create"?"Create Patient":"Save Changes"})]})]})]})]})})}function dn(t){return t||""}function D8e(t){return t?{doctor:"Doctor",google:"Google",social_media:"Social Media",ads:"Advertisements",other:"Other"}[t]||t:""}function qR(t){if(t==null)return"";if(typeof t=="string"){const s=t.trim();return s?s.length>24?`${s.slice(0,24)}`:s:""}if(typeof t=="number"||typeof t=="boolean")return String(t);try{const s=JSON.stringify(t);return s.length>24?`${s.slice(0,24)}`:s}catch{return""}}function O8e(t){const s=(t==null?void 0:t.old_values)||{},n=(t==null?void 0:t.new_values)||{},a=Array.from(new Set([...Object.keys(s||{}),...Object.keys(n||{})])),i=[];for(const l of a){const o=s?s[l]:void 0,c=n?n[l]:void 0,d=o===void 0?void 0:JSON.stringify(o),u=c===void 0?void 0:JSON.stringify(c);d!==u&&i.push({field:l,before:o,after:c})}return i}function R8e({open:t,onClose:s,patient:n,onUpdated:a}){const[i,l]=y.useState(null),[o,c]=y.useState([]),[d,u]=y.useState([]),[h,f]=y.useState([]),[x,b]=y.useState(!1),[v,w]=y.useState(!1),[_,S]=y.useState(!1),[k,A]=y.useState(!1),[T,P]=y.useState(""),[O,D]=y.useState(null),[I,M]=y.useState("other"),[B,L]=y.useState(""),[F,V]=y.useState(""),[$,z]=y.useState(""),[H,q]=y.useState(""),[G,re]=y.useState("idle"),[ye,Ee]=y.useState(null),[ee,te]=y.useState(""),[ce,ge]=y.useState("");y.useEffect(()=>{t&&n&&X(n.id)},[t,n==null?void 0:n.id]);const X=async ve=>{var ae,xe;b(!0),P("");try{const[je,Fe,Ct]=await Promise.all([m8e(ve),y8e(ve),b8e(ve)]);l(je.data),c(Fe.data||[]),u(Ct.data||[]),a&&a(je.data)}catch(je){const Fe=((xe=(ae=je==null?void 0:je.response)==null?void 0:ae.data)==null?void 0:xe.detail)||(je==null?void 0:je.message)||"Failed to load patient details";P(Fe)}finally{b(!1)}A(!0);try{const je=await _8e(ve,{limit:30});f(je.data||[])}catch{}finally{A(!1)}};if(!t||!n)return null;const de=i||n,Ce=de.addresses&&de.addresses[0]||null,ue=de.age_text||"",fe=async ve=>{var ae,xe;if(ve.preventDefault(),!!O){w(!0),P("");try{const je=await g8e(de.id,{type:I,file:O});c(Fe=>[je.data,...Fe]),D(null),M("other")}catch(je){const Fe=((xe=(ae=je==null?void 0:je.response)==null?void 0:ae.data)==null?void 0:xe.detail)||(je==null?void 0:je.message)||"Failed to upload document";P(Fe)}finally{w(!1)}}},pe=async ve=>{var ae,xe;if(ve.preventDefault(),!(!B||!F)){S(!0),P("");try{const je=await v8e(de.id,{type:B,text:F});u(Fe=>[je.data,...Fe]),L(""),V("")}catch(je){const Fe=((xe=(ae=je==null?void 0:je.response)==null?void 0:ae.data)==null?void 0:xe.detail)||(je==null?void 0:je.message)||"Failed to save consent";P(Fe)}finally{S(!1)}}},oe=async()=>{var ve,ae;P("");try{await N8e(de.id)}catch(xe){const je=((ae=(ve=xe==null?void 0:xe.response)==null?void 0:ve.data)==null?void 0:ae.detail)||(xe==null?void 0:xe.message)||"Failed to open print view";P(je)}},qe=async ve=>{var ae,xe;P("");try{const je=await J.get(`/patients/documents/${ve.id}/file`,{responseType:"blob"}),Fe=je.data,Ct=je.headers["content-type"]||ve.mime||ve.content_type||ve.mime_type||"",vt=URL.createObjectURL(Ct?new Blob([Fe],{type:Ct}):Fe);Ee(ve),te(vt),ge(Ct)}catch(je){const Fe=((xe=(ae=je==null?void 0:je.response)==null?void 0:ae.data)==null?void 0:xe.detail)||(je==null?void 0:je.message)||"Failed to load attachment for preview";P(Fe)}},Xe=()=>{ee&&URL.revokeObjectURL(ee),Ee(null),te(""),ge("")},jt=async ve=>{var ae,xe;P("");try{const je=await J.get(`/patients/documents/${ve.id}/file`,{responseType:"blob"}),Fe=je.data,Ct=je.headers["content-type"]||ve.mime||ve.content_type||ve.mime_type||"application/octet-stream",vt=URL.createObjectURL(Ct?new Blob([Fe],{type:Ct}):Fe),pt=document.createElement("a");pt.href=vt,pt.download=ve.filename||"document",document.body.appendChild(pt),pt.click(),pt.remove(),URL.revokeObjectURL(vt)}catch(je){const Fe=((xe=(ae=je==null?void 0:je.response)==null?void 0:ae.data)==null?void 0:xe.detail)||(je==null?void 0:je.message)||"Failed to download attachment";P(Fe)}},ft=ye&&((ce==null?void 0:ce.startsWith("image/"))||/\.(png|jpe?g|gif|webp|bmp)$/i.test(ye.filename||"")),it=ye&&(ce==="application/pdf"||/\.pdf$/i.test(ye.filename||"")),_t="inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium";return r.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black/40 backdrop-blur-sm",onClick:s,children:[r.jsxs("div",{className:"w-full bg-white rounded-t-3xl sm:rounded-3xl shadow-2xl max-h-[90vh] sm:max-h-[90vh] sm:max-w-5xl mx-auto overflow-hidden flex flex-col",onClick:ve=>ve.stopPropagation(),children:[r.jsxs("div",{className:"px-4 sm:px-6 py-3 border-b border-slate-200 flex items-center justify-between",children:[r.jsx("div",{className:"space-y-0.5",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"h-8 w-8 rounded-full bg-teal-600 text-white flex items-center justify-center shadow-sm",children:r.jsx(rn,{className:"h-4 w-4"})}),r.jsxs("div",{children:[r.jsxs("h2",{className:"text-base sm:text-lg font-semibold text-slate-900",children:[de.first_name," ",de.last_name||""]}),r.jsxs("p",{className:"text-[11px] sm:text-xs text-slate-500",children:["UHID: ",de.uhid,"  Age: ",ue||""]})]})]})}),r.jsxs("div",{className:"flex items-center gap-2",children:[de.patient_type&&r.jsx("span",{className:`${_t} bg-slate-900/5 text-slate-800 border border-slate-200`,children:de.patient_type}),de.tag&&r.jsx("span",{className:`${_t} bg-emerald-50 text-emerald-700 border border-emerald-100`,children:de.tag}),r.jsx("button",{type:"button",onClick:s,className:"h-8 w-8 flex items-center justify-center rounded-full hover:bg-slate-100 text-slate-500 hover:text-slate-900 text-lg leading-none",children:""})]})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto px-4 sm:px-6 py-4 space-y-4 bg-slate-50/80",children:[x&&r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-3 text-xs sm:text-sm text-slate-500 shadow-sm",children:"Loading patient details"}),T&&r.jsx("div",{className:"rounded-2xl border border-red-200 bg-red-50/80 px-3 py-2 text-xs sm:text-sm text-red-700",children:T}),r.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-3 flex flex-wrap gap-2 items-center",children:[r.jsxs("button",{type:"button",onClick:oe,className:"inline-flex items-center gap-1.5 rounded-full bg-blue-600 px-4 py-1.5 text-xs sm:text-sm font-semibold text-white shadow-sm hover:bg-blue-700 active:scale-95 transition",children:[r.jsx(e1,{className:"h-4 w-4"}),r.jsx("span",{children:"Print Info / PDF"})]}),r.jsxs("span",{className:"text-[11px] text-slate-500 flex items-center gap-1",children:[r.jsx($a,{className:"h-3.5 w-3.5 text-emerald-500"}),"Patient profile & audit-ready."]})]}),r.jsxs("section",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[r.jsx(gl,{className:"h-4 w-4 text-slate-500"}),r.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Patient Info"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-1.5 text-[11px] sm:text-xs",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-slate-600",children:"Gender: "}),r.jsx("span",{className:"font-semibold text-slate-800",children:dn(de.gender)})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-slate-600",children:"DOB: "}),r.jsx("span",{className:"font-semibold text-slate-800",children:de.dob||""})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-slate-600",children:"Age: "}),r.jsx("span",{className:"font-semibold text-slate-800",children:ue||""})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Blood Group:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:dn(de.blood_group)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Marital Status:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:dn(de.marital_status)})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-slate-600",children:"Mobile: "}),r.jsx("span",{className:"font-semibold text-slate-800",children:dn(de.phone)})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsx("span",{className:"font-medium text-slate-600",children:"Email: "}),r.jsx("span",{className:"font-semibold text-slate-800",children:dn(de.email)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Patient Type:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:dn(de.patient_type)})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-slate-600",children:"Tag: "}),r.jsx("span",{className:"font-semibold text-slate-800",children:dn(de.tag)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Religion:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:dn(de.religion)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Occupation:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:dn(de.occupation)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["File No:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:dn(de.file_number)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["File Location:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:dn(de.file_location)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Guardian:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:dn(de.guardian_name)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Guardian Phone:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:dn(de.guardian_phone)})]})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[r.jsx($a,{className:"h-4 w-4 text-slate-500"}),r.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Reference & Credit / Insurance"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-1.5 text-[11px] sm:text-xs",children:[r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Reference Source:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:D8e(de.ref_source)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Referring Doctor:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:dn(de.ref_doctor_name)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Credit Type:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:dn(de.credit_type)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Payer:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:dn(de.credit_payer_name)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["TPA:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:dn(de.credit_tpa_name)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Credit Plan:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:dn(de.credit_plan_name)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Policy Number:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:dn(de.policy_number)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Policy Name:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:dn(de.policy_name)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Principal Member:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:dn(de.principal_member_name)})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Family ID:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:dn(de.family_id)})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsxs("span",{className:"font-medium text-slate-600",children:["Principal Member Address:"," "]}),r.jsx("span",{className:"font-semibold text-slate-800",children:dn(de.principal_member_address)})]})]})]}),r.jsxs("div",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[r.jsx(gl,{className:"h-4 w-4 text-slate-500"}),r.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Address"})]}),r.jsx("p",{className:"text-xs sm:text-sm text-slate-700",children:Ce?r.jsxs(r.Fragment,{children:[Ce.line1,r.jsx("br",{}),Ce.line2&&r.jsxs(r.Fragment,{children:[Ce.line2,r.jsx("br",{})]}),[Ce.city,Ce.state,Ce.pincode].filter(Boolean).join(", "),r.jsx("br",{}),Ce.country]}):""})]})]})]}),r.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-3",children:[r.jsx("div",{className:"flex items-center justify-between gap-2",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Kse,{className:"h-4 w-4 text-slate-500"}),r.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Attachments"})]})}),r.jsxs("form",{onSubmit:fe,className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 text-xs",children:[r.jsxs("select",{className:"rounded-xl border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500",value:I,onChange:ve=>M(ve.target.value),children:[r.jsx("option",{value:"other",children:"Other"}),r.jsx("option",{value:"id_proof",children:"ID Proof"}),r.jsx("option",{value:"report",children:"Report"}),r.jsx("option",{value:"photo",children:"Photo"})]}),r.jsx("input",{type:"file",className:"flex-1 text-xs text-slate-700 file:mr-2 file:rounded-full file:border-0 file:bg-slate-900 file:px-3 file:py-1.5 file:text-xs file:font-semibold file:text-white hover:file:bg-slate-800",onChange:ve=>D(ve.target.files[0]||null)}),r.jsxs("button",{type:"submit",disabled:v||!O,className:"inline-flex items-center justify-center gap-1.5 rounded-full bg-blue-600 px-3 py-1.5 text-[11px] font-semibold text-white shadow-sm hover:bg-blue-700 disabled:opacity-60 active:scale-95 transition",children:[r.jsx(Fse,{className:"h-3.5 w-3.5"}),v?"Uploading":"Upload"]})]}),r.jsxs("ul",{className:"divide-y border border-slate-200 rounded-2xl bg-slate-50/80",children:[o.length===0&&r.jsxs("li",{className:"text-xs text-slate-500 px-3 py-3 flex items-center gap-2",children:[r.jsx(ny,{className:"h-4 w-4 text-slate-300"}),r.jsx("span",{children:"No attachments yet."})]}),o.map(ve=>r.jsxs("li",{className:"px-3 py-2 text-xs flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"min-w-0",children:[r.jsx("div",{className:"font-medium text-slate-800 truncate",children:ve.filename}),r.jsxs("div",{className:"text-[10px] text-slate-500",children:[ve.type||"other"," "," ",ve.size?`${(ve.size/1024).toFixed(1)} KB`:""]})]}),r.jsxs("div",{className:"flex items-center gap-1.5 shrink-0",children:[r.jsx("button",{type:"button",onClick:()=>qe(ve),className:"inline-flex items-center rounded-full border border-slate-200 bg-white px-2.5 py-1 text-[11px] font-semibold text-slate-700 hover:bg-slate-50 transition",children:"Preview"}),r.jsxs("button",{type:"button",onClick:()=>jt(ve),className:"inline-flex items-center gap-1 rounded-full bg-slate-900 px-2.5 py-1 text-[11px] font-semibold text-white hover:bg-slate-800 transition",children:[r.jsx(to,{className:"h-3.5 w-3.5"}),"Download"]})]})]},ve.id))]})]}),r.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(gl,{className:"h-4 w-4 text-slate-500"}),r.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Consents"})]}),r.jsxs("form",{onSubmit:pe,className:"space-y-2 text-xs",children:[r.jsx("div",{className:"flex flex-col sm:flex-row gap-2",children:r.jsx("input",{className:"flex-1 rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-800 focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500",placeholder:"Consent type (e.g. General, Surgery)",value:B,onChange:ve=>L(ve.target.value)})}),r.jsx("textarea",{rows:2,className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-800 focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500",placeholder:"Consent text",value:F,onChange:ve=>V(ve.target.value)}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{type:"submit",disabled:_||!B||!F,className:"inline-flex items-center justify-center rounded-full bg-blue-600 px-4 py-1.5 text-xs sm:text-sm font-semibold text-white shadow-sm hover:bg-blue-700 disabled:opacity-60 active:scale-95 transition",children:_?"Saving":"Add Consent"})})]}),r.jsxs("ul",{className:"divide-y border border-slate-200 rounded-2xl bg-slate-50/80",children:[d.length===0&&r.jsxs("li",{className:"text-xs text-slate-500 px-3 py-3 flex items-center gap-2",children:[r.jsx(ny,{className:"h-4 w-4 text-slate-300"}),r.jsx("span",{children:"No consents captured yet."})]}),d.map(ve=>r.jsxs("li",{className:"px-3 py-2 text-xs",children:[r.jsx("div",{className:"font-semibold text-slate-800",children:ve.type}),r.jsx("div",{className:"text-[11px] text-slate-500 mb-0.5",children:new Date(ve.captured_at).toLocaleString()}),r.jsx("div",{className:"text-xs text-slate-800 whitespace-pre-line",children:ve.text})]},ve.id))]})]}),r.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Vs,{className:"h-4 w-4 text-slate-500"}),r.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Activity / Audit Trail"})]}),r.jsx("div",{className:"text-[11px] text-slate-500",children:k?"Loading":h.length?`Latest ${h.length} change${h.length>1?"s":""}`:"No history yet"})]}),h.length===0&&!k&&r.jsxs("div",{className:"rounded-xl border border-slate-100 bg-slate-50 px-3 py-2 text-[11px] text-slate-500 flex items-center gap-2",children:[r.jsx(ny,{className:"h-4 w-4 text-slate-300"}),r.jsx("span",{children:"No change history captured yet for this patient."})]}),h.length>0&&r.jsx("ol",{className:"space-y-2",children:h.map(ve=>{const ae=O8e(ve),xe=ae.length>3?ae.length-3:0,je=ve.user_name||ve.user_email||(ve.user_id?`User #${ve.user_id}`:"System"),Fe=ve.created_at?new Date(ve.created_at).toLocaleString():"";return r.jsxs("li",{className:"flex gap-2",children:[r.jsxs("div",{className:"flex flex-col items-center pt-1",children:[r.jsx("div",{className:"h-2 w-2 rounded-full bg-teal-600"}),r.jsx("div",{className:"mt-1 flex-1 w-px bg-slate-200"})]}),r.jsxs("div",{className:"flex-1 rounded-2xl border border-slate-200 bg-slate-50/80 px-2.5 py-2",children:[r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-1",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 text-[11px]",children:[r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-900 text-white px-1.5 py-0.5 text-[10px] tracking-wide",children:ve.action||"UPDATE"}),r.jsx("span",{className:"text-slate-700",children:je})]}),Fe&&r.jsx("div",{className:"text-[10px] text-slate-500",children:Fe})]}),ae.length>0&&r.jsxs("ul",{className:"mt-1.5 space-y-0.5 text-[11px] text-slate-700",children:[ae.slice(0,3).map(Ct=>r.jsxs("li",{className:"flex flex-wrap gap-1",children:[r.jsx("span",{className:"font-medium",children:Ct.field}),r.jsx("span",{className:"text-slate-500",children:"changed"}),r.jsx("span",{className:"line-through text-slate-400",children:qR(Ct.before)}),r.jsx("span",{className:"mx-1 text-slate-400",children:""}),r.jsx("span",{className:"font-medium",children:qR(Ct.after)})]},Ct.field)),xe>0&&r.jsxs("li",{className:"text-[10px] text-slate-500",children:["+",xe," more field",xe>1?"s":""," updated"]})]}),ae.length===0&&(ve.old_values||ve.new_values)&&r.jsx("p",{className:"mt-1.5 text-[11px] text-slate-600",children:"Multiple fields updated."}),(ve.ip_address||ve.user_agent)&&r.jsxs("p",{className:"mt-1 text-[10px] text-slate-400",children:[ve.ip_address&&r.jsxs("span",{children:["IP: ",ve.ip_address]}),ve.ip_address&&ve.user_agent&&r.jsx("span",{className:"mx-1",children:""}),ve.user_agent&&r.jsx("span",{className:"line-clamp-1",children:ve.user_agent})]})]})]},ve.id)})})]})]})]}),ye&&r.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm",onClick:Xe,children:r.jsxs("div",{className:"relative w-full max-w-3xl h-[80vh] bg-white rounded-2xl shadow-2xl flex flex-col overflow-hidden",onClick:ve=>ve.stopPropagation(),children:[r.jsxs("div",{className:"px-4 py-2 border-b border-slate-200 flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"text-sm font-semibold text-slate-900",children:["Preview  ",ye.filename]}),r.jsx("p",{className:"text-[11px] text-slate-500",children:ce||"Unknown type"})]}),r.jsx("button",{type:"button",onClick:Xe,className:"h-8 w-8 flex items-center justify-center rounded-full hover:bg-slate-100 text-slate-500 hover:text-slate-900 text-lg leading-none",children:""})]}),r.jsxs("div",{className:"flex-1 bg-slate-50 flex items-center justify-center",children:[ft&&r.jsx("img",{src:ee,alt:ye.filename,className:"max-h-full max-w-full object-contain"}),it&&r.jsx("iframe",{src:ee,title:ye.filename,className:"w-full h-full"}),!ft&&!it&&r.jsxs("div",{className:"text-xs text-slate-600 px-4 text-center space-y-2",children:[r.jsx("p",{children:"This file type cannot be previewed inline."}),r.jsxs("button",{type:"button",onClick:()=>jt(ye),className:"inline-flex items-center gap-1 rounded-full bg-slate-900 px-3 py-1.5 text-xs font-semibold text-white hover:bg-slate-800",children:[r.jsx(to,{className:"h-3.5 w-3.5"}),"Download file"]})]})]})]})})]})}function L8e(){const[t,s]=y.useState([]),[n,a]=y.useState(!1),[i,l]=y.useState(""),[o,c]=y.useState(!1),[d,u]=y.useState(!1),[h,f]=y.useState(null),[x,b]=y.useState(null),[v,w]=y.useState({refSources:[],doctors:[],payers:[],tpas:[],creditPlans:[],patientTypes:[]}),[_,S]=y.useState(""),[k,A]=y.useState(""),[T,P]=y.useState(""),[O,D]=y.useState(""),[I,M]=y.useState(!1);y.useEffect(()=>{B(),L()},[]);const B=async(ee=i,te=k)=>{var ce,ge;a(!0),S("");try{const X={};ee&&(X.q=ee),te&&(X.patient_type=te);const de=await LK(X);s(de.data||[])}catch(X){const de=((ge=(ce=X==null?void 0:X.response)==null?void 0:ce.data)==null?void 0:ge.detail)||(X==null?void 0:X.message)||"Failed to load patients";S(de),se.error("Failed to load patients",{description:de})}finally{a(!1)}},L=async()=>{try{const te=(await w8e()).data||{};w({refSources:te.reference_sources||[],doctors:te.doctors||[],payers:te.payers||[],tpas:te.tpas||[],creditPlans:te.credit_plans||[],patientTypes:te.patient_types||[]})}catch{}},F=ee=>{ee.preventDefault(),B(i)},V=ee=>{A(ee),B(i,ee)},$=()=>{A(""),l(""),B("","")},z=()=>{b(null),c(!0)},H=ee=>{b(ee),c(!0)},q=ee=>{f(ee),u(!0)},G=async ee=>{var te,ce;if(window.confirm(`Deactivate patient ${ee.first_name}?`))try{await x8e(ee.id),se.success("Patient deactivated successfully."),await B()}catch(ge){const X=((ce=(te=ge==null?void 0:ge.response)==null?void 0:te.data)==null?void 0:ce.detail)||(ge==null?void 0:ge.message)||"Failed to deactivate patient";se.error("Failed to deactivate patient",{description:X})}},re=ee=>{s(te=>{const ce=te.findIndex(X=>X.id===ee.id);if(ce===-1)return te;const ge=[...te];return ge[ce]=ee,ge})},ye=async()=>{var ee,te;if(!T||!O){se.warning("Please select From and To date for Excel export.");return}if(O<T){se.warning("To Date must be on or after From Date.");return}M(!0);try{const ce={from_date:T,to_date:O};k&&(ce.patient_type=k);const ge=await j8e(ce),X=new Blob([ge.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),de=window.URL.createObjectURL(X),Ce=document.createElement("a");Ce.href=de,Ce.download=`patients_${T}_to_${O}.xlsx`,document.body.appendChild(Ce),Ce.click(),Ce.remove(),window.URL.revokeObjectURL(de),se.success("Patient Excel report downloaded.")}catch(ce){const ge=((te=(ee=ce==null?void 0:ce.response)==null?void 0:ee.data)==null?void 0:te.detail)||(ce==null?void 0:ce.message)||"Failed to export Excel.";se.error("Failed to export Excel.",{description:ge})}finally{M(!1)}},Ee=y.useMemo(()=>v.patientTypes||[],[v.patientTypes]);return r.jsxs("div",{className:"h-full w-full flex flex-col gap-4 lg:gap-5 px-3 py-3 sm:px-5 sm:py-4 bg-slate-50/80",children:[r.jsx("div",{className:"rounded-3xl bg-gradient-to-r from-teal-700 via-teal-600 to-teal-500 text-white shadow-md px-4 py-4 sm:px-6 sm:py-5",children:r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-white/10 px-2.5 py-1 text-xs",children:[r.jsx(Uo,{className:"w-4 h-4"}),r.jsx("span",{className:"font-medium tracking-tight",children:"Patient Registry"})]}),r.jsx("h1",{className:"text-lg sm:text-xl font-semibold tracking-tight",children:"Patient Management"}),r.jsx("p",{className:"text-xs sm:text-sm text-teal-100/90 max-w-xl",children:"Register new patients, manage demographics, consents, and credit/insurance details in a single unified profile."})]}),r.jsxs("div",{className:"flex flex-wrap gap-2 sm:justify-end",children:[r.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full bg-white/10 px-2.5 py-1 text-[11px]",children:[r.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-300"}),"IPD / OPD ready"]}),r.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full bg-white/10 px-2.5 py-1 text-[11px]",children:[r.jsx("span",{className:"h-2 w-2 rounded-full bg-sky-300"}),"NABH-aligned registry"]})]})]})}),r.jsxs("div",{className:"flex flex-col gap-3 rounded-3xl bg-white shadow-sm border border-slate-200 px-3 py-3 sm:px-4 sm:py-3",children:[r.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("form",{onSubmit:F,className:"w-full flex items-center gap-2",children:[r.jsxs("div",{className:"relative w-full sm:w-64",children:[r.jsx(es,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),r.jsx("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-8 py-2 text-sm text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500",placeholder:"Search by UHID, name, mobile, email...",value:i,onChange:ee=>l(ee.target.value)})]}),r.jsx("button",{type:"submit",className:"hidden sm:inline-flex items-center justify-center rounded-full border border-slate-200 bg-slate-50 px-3 py-1.5 text-xs font-semibold text-slate-700 hover:bg-slate-100 transition duration-150",children:"Search"})]}),r.jsxs("div",{className:"flex items-center justify-between sm:justify-end gap-2",children:[r.jsx("button",{type:"button",onClick:$,className:"inline-flex items-center justify-center rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs font-semibold text-slate-600 hover:bg-slate-50 transition",children:"Reset"}),r.jsxs("button",{type:"button",onClick:z,className:"inline-flex items-center justify-center gap-1.5 rounded-full bg-blue-600 px-4 py-1.5 text-xs sm:text-sm font-semibold text-white shadow-sm hover:bg-blue-700 active:scale-95 transition duration-150",children:[r.jsx(ps,{className:"h-4 w-4"}),r.jsx("span",{children:"New Patient"})]})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-500",children:"Filter by patient type:"}),r.jsx("button",{type:"button",onClick:()=>V(""),className:["inline-flex items-center rounded-full px-3 py-1 text-xs sm:text-sm transition",k===""?"bg-blue-600 text-white shadow-sm":"bg-slate-100 text-slate-600 hover:bg-slate-200"].join(" "),children:"All"}),Ee.map(ee=>{const te=ee.code||ee.name,ce=ee.name||ee.code;return r.jsx("button",{type:"button",onClick:()=>V(te),className:["inline-flex items-center rounded-full px-3 py-1 text-xs sm:text-sm transition",k===te?"bg-blue-600 text-white shadow-sm":"bg-slate-100 text-slate-600 hover:bg-slate-200"].join(" "),children:ce},te)})]})]}),r.jsx("div",{className:"flex flex-col lg:flex-row gap-3 lg:items-center lg:justify-between",children:r.jsxs("div",{className:"rounded-3xl bg-white shadow-sm border border-slate-200 px-3 py-3 sm:px-4 sm:py-3 flex flex-col sm:flex-row sm:items-end gap-3",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700 mb-1",children:"From Date"}),r.jsx("input",{type:"date",className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500",value:T,onChange:ee=>P(ee.target.value)})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700 mb-1",children:"To Date"}),r.jsx("input",{type:"date",className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-500",value:O,onChange:ee=>D(ee.target.value)})]}),r.jsxs("button",{type:"button",onClick:ye,disabled:I,className:"inline-flex items-center justify-center gap-1.5 rounded-full bg-emerald-600 px-4 py-2 text-xs sm:text-sm font-semibold text-white shadow-sm hover:bg-emerald-700 disabled:opacity-60 disabled:cursor-not-allowed transition",children:[r.jsx(Tse,{className:"h-4 w-4"}),I?"Exporting":"Export Excel"]})]})}),_&&r.jsxs("div",{className:"rounded-2xl border border-red-200 bg-red-50/80 px-3 py-2 sm:px-4 sm:py-3 text-xs sm:text-sm text-red-700 flex items-start gap-2",children:[r.jsx(nn,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("div",{className:"font-semibold",children:"Unable to load patients"}),r.jsx("div",{className:"text-[11px] sm:text-xs",children:_})]})]}),r.jsx("div",{className:"hidden md:flex flex-1",children:r.jsx("div",{className:"w-full rounded-3xl border border-slate-200 bg-white shadow-sm overflow-hidden",children:r.jsx("div",{className:"overflow-auto max-h-[calc(100vh-280px)]",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-slate-50 border-b border-slate-200 sticky top-0 z-10",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left text-[11px] font-medium text-slate-600 uppercase",children:"UHID / Name"}),r.jsx("th",{className:"px-3 py-2 text-left text-[11px] font-medium text-slate-600 uppercase",children:"Demographics"}),r.jsx("th",{className:"px-3 py-2 text-left text-[11px] font-medium text-slate-600 uppercase",children:"Contact"}),r.jsx("th",{className:"px-3 py-2 text-left text-[11px] font-medium text-slate-600 uppercase",children:"Tags"}),r.jsx("th",{className:"px-3 py-2 text-right text-[11px] font-medium text-slate-600 uppercase",children:"Actions"})]})}),r.jsxs("tbody",{children:[n&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-3 py-6 text-center text-sm text-slate-500",children:"Loading patients"})}),!n&&t.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-3 py-6 text-center text-sm text-slate-500",children:r.jsxs("div",{className:"flex flex-col items-center gap-1.5",children:[r.jsx(ny,{className:"h-6 w-6 text-slate-300"}),r.jsx("div",{className:"font-medium text-slate-600",children:"No patients found."}),r.jsx("p",{className:"text-[11px] text-slate-400",children:"Adjust search or filters, or click New Patient to create the first record."})]})})}),!n&&t.map((ee,te)=>r.jsxs("tr",{className:`border-t border-slate-100 hover:bg-slate-50/70 transition ${te%2===1?"bg-slate-50/30":""}`,children:[r.jsxs("td",{className:"px-3 py-2 align-top",children:[r.jsxs("div",{className:"font-semibold text-slate-900",children:[ee.first_name," ",ee.last_name||""]}),r.jsxs("div",{className:"flex items-center gap-1 text-[11px] text-slate-500",children:[r.jsx("span",{className:"font-mono bg-slate-100 px-1.5 py-0.5 rounded-full border border-slate-200",children:ee.uhid}),r.jsx("span",{className:"text-slate-400",children:""}),r.jsxs("span",{children:["Age: ",ee.age_text||""]})]})]}),r.jsxs("td",{className:"px-3 py-2 align-top text-xs text-slate-700",children:[r.jsxs("div",{children:["Gender: ",ee.gender]}),r.jsxs("div",{children:["Blood group: ",ee.blood_group||""]}),r.jsxs("div",{children:["Marital status: ",ee.marital_status||""]})]}),r.jsxs("td",{className:"px-3 py-2 align-top text-xs text-slate-700",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(R4,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsx("span",{children:ee.phone||""})]}),r.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[r.jsx(dm,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsx("span",{className:"truncate max-w-[180px] text-[11px]",children:ee.email||""})]})]}),r.jsx("td",{className:"px-3 py-2 align-top text-xs text-slate-700",children:r.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[ee.patient_type&&r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-100 border border-slate-200 px-2 py-0.5 text-[11px] text-slate-800",children:[r.jsx(Yf,{className:"h-3 w-3 text-slate-400"}),ee.patient_type]}),ee.tag&&r.jsx("span",{className:"inline-flex items-center gap-1 rounded-full bg-emerald-50 border border-emerald-100 px-2 py-0.5 text-[11px] text-emerald-700",children:ee.tag})]})}),r.jsx("td",{className:"px-3 py-2 align-top text-right text-xs",children:r.jsxs("div",{className:"flex justify-end gap-1.5",children:[r.jsx("button",{type:"button",onClick:()=>q(ee),className:"inline-flex items-center rounded-full border border-slate-200 px-2.5 py-1 text-[11px] font-semibold text-slate-700 hover:bg-slate-50 transition",children:"View"}),r.jsx("button",{type:"button",onClick:()=>H(ee),className:"inline-flex items-center rounded-full border border-slate-200 px-2.5 py-1 text-[11px] font-semibold text-slate-700 hover:bg-slate-50 transition",children:"Edit"}),r.jsx("button",{type:"button",onClick:()=>G(ee),className:"inline-flex items-center rounded-full border border-rose-200 px-2.5 py-1 text-[11px] font-semibold text-rose-700 hover:bg-rose-50 transition",children:"Deactivate"})]})})]},ee.id))]})]})})})}),r.jsxs("div",{className:"md:hidden flex-1",children:[n&&r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-4 text-center text-sm text-slate-500 shadow-sm",children:"Loading patients"}),!n&&t.length===0&&r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-4 py-5 text-center text-sm text-slate-500 shadow-sm flex flex-col items-center gap-1.5",children:[r.jsx(Dse,{className:"h-6 w-6 text-slate-300"}),r.jsx("div",{className:"font-medium text-slate-700",children:"No patients found."}),r.jsx("p",{className:"text-[11px] text-slate-400",children:"Use the search bar or tap New Patient to add a record."})]}),r.jsx("div",{className:"mt-2 grid gap-3",children:t.map(ee=>r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm hover:shadow-md transition",children:[r.jsxs("div",{className:"flex items-start justify-between gap-2",children:[r.jsxs("div",{className:"space-y-0.5",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:[ee.first_name," ",ee.last_name||""]}),ee.patient_type&&r.jsx("span",{className:"ml-1 inline-flex items-center rounded-full bg-slate-100 px-2 py-0.5 text-[10px] font-medium text-slate-800",children:ee.patient_type})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-1 text-[11px] text-slate-500",children:[r.jsx("span",{className:"font-mono bg-slate-100 px-1.5 py-0.5 rounded-full border border-slate-200",children:ee.uhid}),r.jsxs("span",{children:[" Age: ",ee.age_text||""]}),r.jsxs("span",{children:[" ",ee.gender]})]}),r.jsxs("div",{className:"mt-1 text-[11px] text-slate-600",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(R4,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsx("span",{children:ee.phone||"No mobile"})]}),ee.email&&r.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[r.jsx(dm,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsx("span",{className:"truncate max-w-[180px]",children:ee.email})]})]})]}),r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("button",{type:"button",onClick:()=>q(ee),className:"px-2 py-1 text-[11px] rounded-full border border-slate-200 text-slate-700 font-semibold",children:"View"}),r.jsx("button",{type:"button",onClick:()=>H(ee),className:"px-2 py-1 text-[11px] rounded-full border border-slate-200 text-slate-700 font-semibold",children:"Edit"}),r.jsx("button",{type:"button",onClick:()=>G(ee),className:"px-2 py-1 text-[11px] rounded-full border border-rose-200 text-rose-700 font-semibold",children:"Deactivate"})]})]}),r.jsx("div",{className:"mt-2 flex flex-wrap gap-1 text-[10px] text-slate-600",children:ee.tag&&r.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-50 text-emerald-700 border border-emerald-100",children:ee.tag})})]},ee.id))})]}),r.jsx(M8e,{open:o,onClose:()=>c(!1),onSaved:()=>B(),initialPatient:x,lookups:v}),r.jsx(R8e,{open:d,onClose:()=>u(!1),patient:h,onUpdated:re})]})}const BK=[{value:"insurance",label:"Insurance"},{value:"corporate",label:"Corporate"},{value:"govt",label:"Govt Scheme"},{value:"other",label:"Other"}];function Cp({label:t,active:s,onClick:n}){return r.jsx("button",{type:"button",onClick:n,className:["inline-flex items-center rounded-full px-3 py-1 text-xs sm:text-sm transition-all",s?"bg-blue-600 text-white shadow-sm":"bg-slate-100 text-slate-600 hover:bg-slate-200"].join(" "),children:t})}function B8e({title:t,subtitle:s,onClose:n,children:a}){return r.jsx("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black/40 backdrop-blur-sm p-0 sm:p-4",children:r.jsxs("div",{className:`w-full max-w-xl max-h-[90vh] overflow-y-auto\r
                            rounded-t-3xl sm:rounded-2xl bg-white shadow-2xl\r
                            px-4 py-4 sm:px-5 sm:py-5\r
                            transform transition-transform duration-200 ease-out translate-y-0`,children:[r.jsxs("div",{className:"mb-4 flex items-center justify-between gap-2",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-base sm:text-lg font-semibold text-slate-900",children:t}),s&&r.jsx("p",{className:"mt-1 text-xs sm:text-sm text-slate-500",children:s})]}),r.jsx("button",{onClick:n,type:"button",className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:r.jsx(Kn,{className:"h-4 w-4"})})]}),a]})})}function F8e(){const[t,s]=y.useState("payers"),n=nt("patients.masters.view"),a=nt("patients.view");return n||a?r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"rounded-3xl bg-gradient-to-b from-teal-700 to-teal-600 text-white p-5 pb-6 shadow-sm",children:[r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-xl sm:text-2xl font-semibold",children:"Hello!"}),r.jsxs("div",{className:"mt-1 text-sm sm:text-base text-teal-50",children:["Welcome to ",r.jsx("span",{className:"font-semibold",children:"Patient Masters"})]}),r.jsx("p",{className:"mt-2 max-w-xl text-xs sm:text-sm text-teal-50/90",children:"Configure patient types, payers, TPAs & credit plans that drive registration and billing workflows."})]}),r.jsxs("div",{className:"flex gap-2 text-[11px] sm:text-xs justify-start sm:justify-end",children:[r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-white/10 px-3 py-1",children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-400"}),"IPD / OPD ready"]}),r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-white/10 px-3 py-1",children:[r.jsx($a,{className:"h-3 w-3"}),"NABH aligned"]})]})]}),r.jsxs("div",{className:"mt-4 hidden sm:flex gap-2",children:[r.jsx(Lg,{label:"Patient Types",icon:Uo,active:t==="types",onClick:()=>s("types")}),r.jsx(Lg,{label:"Payers",icon:fa,active:t==="payers",onClick:()=>s("payers")}),r.jsx(Lg,{label:"TPAs",icon:U7,active:t==="tpas",onClick:()=>s("tpas")}),r.jsx(Lg,{label:"Credit Plans",icon:bse,active:t==="plans",onClick:()=>s("plans")})]})]}),r.jsxs("div",{className:"sm:hidden sticky top-0 z-20 -mt-3 -mx-3 mb-2 bg-slate-50/95 backdrop-blur px-3 pt-3 pb-2",children:[r.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Section"}),r.jsxs("select",{value:t,onChange:l=>s(l.target.value),className:"w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-800 shadow-sm outline-none focus:border-teal-500 focus:ring-2 focus:ring-teal-100",children:[r.jsx("option",{value:"types",children:"Patient Types"}),r.jsx("option",{value:"payers",children:"Payers"}),r.jsx("option",{value:"tpas",children:"TPAs"}),r.jsx("option",{value:"plans",children:"Credit Plans"})]})]}),r.jsxs("div",{className:"rounded-3xl border border-slate-100 bg-white/95 p-3 sm:p-4 shadow-sm",children:[t==="types"&&r.jsx($8e,{}),t==="payers"&&r.jsx(U8e,{}),t==="tpas"&&r.jsx(H8e,{}),t==="plans"&&r.jsx(q8e,{})]})]}):r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50/80 p-4 text-sm text-amber-800 shadow-sm",children:"You do not have permission to view patient masters."})}function Lg({label:t,active:s,onClick:n,icon:a}){return r.jsxs("button",{onClick:n,className:["inline-flex items-center gap-1 rounded-full px-3 py-1.5 transition-all duration-150","border text-xs sm:text-[13px]",s?"border-blue-600 bg-blue-600 text-white shadow-sm":"border-slate-200 bg-white text-slate-600 hover:border-blue-200 hover:bg-blue-50"].join(" "),children:[a&&r.jsx(a,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:t})]})}function $8e(){const t=nt("patients.view")||nt("patients.masters.view"),s=nt("patients.update")||nt("patients.masters.manage"),[n,a]=y.useState("all"),[i,l]=y.useState([]),[o,c]=y.useState(!1),[d,u]=y.useState(""),[h,f]=y.useState(""),[x,b]=y.useState(!1),[v,w]=y.useState(null),_=y.useCallback(async()=>{var O,D;if(t){c(!0),u("");try{const{data:I}=await J.get("/patient-types",{params:{include_inactive:!0}});l(I||[])}catch(I){const M=((D=(O=I==null?void 0:I.response)==null?void 0:O.data)==null?void 0:D.detail)||"Failed to load patient types";u(M),se.error(M)}finally{c(!1)}}},[t]);y.useEffect(()=>{_()},[_]);const S=y.useMemo(()=>{let O=[...i];if(n==="active"?O=O.filter(I=>I.is_active):n==="inactive"&&(O=O.filter(I=>!I.is_active)),!h)return O;const D=h.toLowerCase();return O.filter(I=>{var M,B,L;return((M=I.name)==null?void 0:M.toLowerCase().includes(D))||((B=I.code)==null?void 0:B.toLowerCase().includes(D))||((L=I.description)==null?void 0:L.toLowerCase().includes(D))})},[i,h,n]),k=()=>{w(null),b(!0)},A=O=>{s&&(w(O),b(!0))},T=O=>{b(!1),w(null),_(),se.success(O==="update"?"Patient type updated successfully":"Patient type created successfully")},P=()=>{_(),se.success("Patient type deactivated successfully")};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2 text-xs sm:text-sm",children:[r.jsx("span",{className:"text-[11px] sm:text-xs text-slate-500 mr-1",children:"Status:"}),r.jsx(Cp,{label:"All",active:n==="all",onClick:()=>a("all")}),r.jsx(Cp,{label:"Active",active:n==="active",onClick:()=>a("active")}),r.jsx(Cp,{label:"Inactive",active:n==="inactive",onClick:()=>a("inactive")})]}),r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"flex items-start gap-2 text-xs text-slate-600 sm:text-sm",children:[r.jsx($a,{className:"mt-0.5 h-4 w-4 text-blue-600"}),r.jsxs("span",{children:["Define patient visit types like"," ",r.jsx("span",{className:"font-medium text-slate-800",children:"Emergency, OPD, IPD, Health Checkup"})," ","used in registration & triage."]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx("input",{value:h,onChange:O=>f(O.target.value),placeholder:"Search code, name, description",className:"w-60 max-w-full rounded-2xl border border-slate-200 bg-slate-50 px-8 py-1.5 text-xs text-slate-800 outline-none ring-0 transition focus:border-blue-500 focus:bg-white focus:ring-2 focus:ring-blue-100"}),r.jsx(es,{className:"pointer-events-none absolute left-2 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"})]}),s&&r.jsxs("button",{onClick:k,className:"inline-flex items-center gap-2 rounded-full bg-blue-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm transition hover:bg-blue-700 hover:shadow-md active:scale-95 sm:text-sm",children:[r.jsx(ps,{className:"h-4 w-4"}),"New Patient Type"]})]})]}),d&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50/80 p-3 text-xs text-rose-700 sm:text-sm",children:d}),r.jsxs("div",{className:"grid gap-3 sm:hidden",children:[o&&r.jsx("div",{className:"rounded-2xl border border-slate-100 bg-slate-50 p-4 text-center text-xs text-slate-500 shadow-sm",children:"Loading patient types"}),!o&&S.map(O=>r.jsxs("div",{className:"group rounded-2xl border border-slate-100 bg-white p-3 shadow-sm transition hover:-translate-y-0.5 hover:shadow-md",children:[r.jsxs("div",{className:"flex items-start justify-between gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:O.name}),O.code&&r.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[11px] font-mono text-slate-600",children:O.code})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-[11px] text-slate-500",children:[r.jsxs("span",{className:["inline-flex items-center rounded-full border px-2 py-0.5",O.is_active?"border-emerald-100 bg-emerald-50 text-emerald-700":"border-slate-200 bg-slate-100 text-slate-500"].join(" "),children:[r.jsx("span",{className:["mr-1 h-1.5 w-1.5 rounded-full",O.is_active?"bg-emerald-500":"bg-slate-400"].join(" ")}),O.is_active?"Active":"Inactive"]}),r.jsxs("span",{className:"text-[11px] text-slate-400",children:["Sort: ",O.sort_order??0]})]})]}),s&&r.jsxs("button",{onClick:()=>A(O),className:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-2 py-1 text-[11px] font-semibold text-slate-700 transition hover:bg-slate-50",children:[r.jsx(Fa,{className:"h-3.5 w-3.5"}),"Edit"]})]}),O.description&&r.jsx("div",{className:"mt-2 text-[11px] text-slate-600",children:O.description})]},O.id)),!o&&S.length===0&&r.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 p-4 text-center text-xs text-slate-500",children:["No patient types found. ",s&&"Click New Patient Type to add one."]})]}),r.jsx("div",{className:"hidden overflow-x-auto rounded-2xl border border-slate-100 bg-white sm:block",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-slate-50/80",children:r.jsxs("tr",{className:"text-left text-[11px] font-medium uppercase tracking-wide text-slate-500",children:[r.jsx("th",{className:"p-2",children:"#"}),r.jsx("th",{className:"p-2",children:"Code"}),r.jsx("th",{className:"p-2",children:"Name"}),r.jsx("th",{className:"p-2",children:"Description"}),r.jsx("th",{className:"p-2",children:"Sort"}),r.jsx("th",{className:"p-2",children:"Status"}),r.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[o&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"p-4 text-center text-xs text-slate-500 sm:text-sm",children:"Loading patient types"})}),!o&&S.map((O,D)=>r.jsxs("tr",{className:["border-t border-slate-100 text-xs transition",O.is_active?"bg-white":"bg-slate-50/70 text-slate-400","hover:bg-slate-50"].join(" "),children:[r.jsx("td",{className:"p-2 text-slate-600",children:D+1}),r.jsx("td",{className:"p-2 font-mono text-[11px] text-slate-700",children:O.code}),r.jsx("td",{className:"p-2 text-slate-900",children:O.name}),r.jsx("td",{className:"p-2 max-w-xs",children:r.jsx("div",{className:"line-clamp-2 text-[11px] text-slate-600",children:O.description||""})}),r.jsx("td",{className:"p-2 text-slate-700",children:O.sort_order??0}),r.jsx("td",{className:"p-2",children:r.jsxs("span",{className:["inline-flex items-center rounded-full border px-2 py-0.5 text-[11px]",O.is_active?"border-emerald-100 bg-emerald-50 text-emerald-700":"border-slate-200 bg-slate-100 text-slate-500"].join(" "),children:[r.jsx("span",{className:["mr-1 h-1.5 w-1.5 rounded-full",O.is_active?"bg-emerald-500":"bg-slate-400"].join(" ")}),O.is_active?"Active":"Inactive"]})}),r.jsx("td",{className:"p-2 text-right",children:s&&r.jsxs("button",{onClick:()=>A(O),className:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-2 py-1 text-[11px] font-semibold text-slate-700 transition hover:bg-slate-50",children:[r.jsx(Fa,{className:"h-3.5 w-3.5"}),"Edit"]})})]},O.id)),!o&&S.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"p-6 text-center text-xs text-slate-500 sm:text-sm",children:"No patient types found."})})]})]})}),x&&r.jsx(z8e,{existing:v,onClose:()=>{b(!1),w(null)},onSaved:T,onDeleted:P})]})}function z8e({existing:t,onClose:s,onSaved:n,onDeleted:a}){const i=nt("patients.update")||nt("patients.masters.manage"),[l,o]=y.useState(()=>({code:(t==null?void 0:t.code)||"",name:(t==null?void 0:t.name)||"",description:(t==null?void 0:t.description)||"",is_active:(t==null?void 0:t.is_active)??!0,sort_order:(t==null?void 0:t.sort_order)??0})),[c,d]=y.useState(!1),[u,h]=y.useState(""),f=async b=>{var v,w;if(b.preventDefault(),!!i){d(!0),h("");try{const _={...l,sort_order:Number(l.sort_order)||0};t?(await J.put(`/patient-types/${t.id}`,_),n&&n("update")):(await J.post("/patient-types",_),n&&n("create"))}catch(_){const S=((w=(v=_==null?void 0:_.response)==null?void 0:v.data)==null?void 0:w.detail)||"Failed to save patient type";h(S),se.error(S)}finally{d(!1)}}},x=async()=>{var b,v;if(!(!t||!i)&&window.confirm("Deactivate this patient type?")){d(!0),h("");try{await J.delete(`/patient-types/${t.id}`),a&&a(),s&&s()}catch(w){const _=((v=(b=w==null?void 0:w.response)==null?void 0:b.data)==null?void 0:v.detail)||"Failed to deactivate patient type";h(_),se.error(_)}finally{d(!1)}}};return r.jsxs(B8e,{title:t?"Edit Patient Type":"New Patient Type",subtitle:"Define master types like Emergency, OPD, IPD, Health Checkup, etc.",onClose:s,children:[u&&r.jsx("div",{className:"mb-3 rounded-xl border border-rose-200 bg-rose-50/80 p-3 text-xs sm:text-sm text-rose-700",children:u}),r.jsxs("form",{onSubmit:f,className:"space-y-3 text-sm",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-800",children:"Code"}),r.jsx("input",{className:"input text-slate-800",value:l.code,onChange:b=>o({...l,code:b.target.value.toUpperCase()}),required:!0}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-400",children:"Example: EMERGENCY, OPD, IPD, HC"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-800",children:"Name"}),r.jsx("input",{className:"input text-slate-800",value:l.name,onChange:b=>o({...l,name:b.target.value}),required:!0})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-800",children:"Description (optional)"}),r.jsx("textarea",{className:"input min-h-[80px] text-slate-800",value:l.description,onChange:b=>o({...l,description:b.target.value})})]}),r.jsxs("div",{className:"grid items-center gap-3 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-xs font-medium text-slate-800",children:"Sort Order"}),r.jsx("input",{className:"input text-slate-800",type:"number",value:l.sort_order,onChange:b=>o({...l,sort_order:b.target.value})}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-400",children:"Lower number shows earlier in dropdowns."})]}),r.jsxs("div",{className:"mt-2 flex items-center gap-2 md:mt-7",children:[r.jsx("input",{id:"pt-active",type:"checkbox",className:"h-4 w-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500",checked:l.is_active,onChange:b=>o({...l,is_active:b.target.checked})}),r.jsx("label",{htmlFor:"pt-active",className:"text-xs font-medium text-slate-800",children:"Active"})]})]}),r.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3",children:[t&&r.jsxs("button",{type:"button",onClick:x,className:"inline-flex items-center gap-2 rounded-full border border-rose-200 px-3 py-1.5 text-xs font-medium text-rose-700 hover:bg-rose-50",children:[r.jsx(wr,{className:"h-3.5 w-3.5"}),"Deactivate"]}),r.jsxs("div",{className:"ml-auto flex gap-2",children:[r.jsx("button",{type:"button",onClick:s,className:"rounded-full border border-slate-200 px-4 py-1.5 text-xs text-slate-700 hover:bg-slate-50",children:"Cancel"}),r.jsx("button",{className:"btn rounded-full px-4 py-1.5 text-xs",disabled:c||!i,children:c?"Saving":"Save"})]})]})]})]})}function U8e(){const t=nt("patients.masters.view"),s=nt("patients.masters.view"),n=nt("patients.masters.manage"),a=s||n,[i,l]=y.useState("all"),[o,c]=y.useState([]),[d,u]=y.useState(!1),[h,f]=y.useState(""),[x,b]=y.useState(""),[v,w]=y.useState(!1),[_,S]=y.useState(null),k=y.useCallback(async()=>{var I,M;if(t){u(!0),f("");try{const{data:B}=await J.get("/patient-masters/payers");c(B||[])}catch(B){const L=((M=(I=B==null?void 0:B.response)==null?void 0:I.data)==null?void 0:M.detail)||"Failed to load payers";f(L),se.error(L)}finally{u(!1)}}},[t]);y.useEffect(()=>{k()},[k]);const A=y.useMemo(()=>{let I=[...o];if(i!=="all"&&(I=I.filter(B=>B.payer_type===i)),!x)return I;const M=x.toLowerCase();return I.filter(B=>{var L,F,V;return((L=B.name)==null?void 0:L.toLowerCase().includes(M))||((F=B.code)==null?void 0:F.toLowerCase().includes(M))||((V=B.payer_type)==null?void 0:V.toLowerCase().includes(M))})},[o,x,i]),T=()=>{S(null),w(!0)},P=I=>{a&&(S(I),w(!0))},O=I=>{w(!1),S(null),k(),se.success(I==="update"?"Payer updated successfully":"Payer created successfully")},D=()=>{k(),se.success("Payer deactivated successfully")};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2 text-xs sm:text-sm",children:[r.jsx("span",{className:"text-[11px] sm:text-xs text-slate-500 mr-1",children:"Payer type:"}),r.jsx(Cp,{label:"All",active:i==="all",onClick:()=>l("all")}),BK.map(I=>r.jsx(Cp,{label:I.label,active:i===I.value,onClick:()=>l(I.value)},I.value))]}),r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"flex items-start gap-2 text-xs text-slate-600 sm:text-sm",children:[r.jsx($a,{className:"mt-0.5 h-4 w-4 text-blue-600"}),r.jsxs("span",{children:["Payers used for"," ",r.jsx("span",{className:"font-medium text-slate-800",children:"insurance, corporate and government schemes"})," ","in OPD/IPD billing."]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx("input",{value:x,onChange:I=>b(I.target.value),placeholder:"Search code, name, type",className:"w-52 max-w-full rounded-2xl border border-slate-200 bg-slate-50 px-8 py-1.5 text-xs text-slate-800 outline-none ring-0 transition focus:border-blue-500 focus:bg-white focus:ring-2 focus:ring-blue-100"}),r.jsx(es,{className:"pointer-events-none absolute left-2 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"})]}),a&&r.jsxs("button",{onClick:T,className:"inline-flex items-center gap-2 rounded-full bg-blue-600 px-3 py-1.5 text-xs font-medium text-white shadow-sm transition hover:bg-blue-700 hover:shadow-md active:scale-95 sm:text-sm",children:[r.jsx(ps,{className:"h-4 w-4"}),"New Payer"]})]})]}),h&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50/80 p-3 text-xs text-rose-700 sm:text-sm",children:h}),r.jsxs("div",{className:"grid gap-3 sm:hidden",children:[d&&r.jsx("div",{className:"rounded-2xl border border-slate-100 bg-slate-50 p-4 text-center text-xs text-slate-500 shadow-sm",children:"Loading payers"}),!d&&A.map(I=>r.jsxs("div",{className:"group rounded-2xl border border-slate-100 bg-white p-3 shadow-sm transition hover:-translate-y-0.5 hover:shadow-md",children:[r.jsxs("div",{className:"flex items-start justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:I.name}),I.code&&r.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[11px] font-mono text-slate-600",children:I.code})]}),r.jsx("div",{className:"mt-1 text-[11px] capitalize text-slate-500",children:I.payer_type||""})]}),a&&r.jsxs("button",{onClick:()=>P(I),className:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-2 py-1 text-[13px] font-bold text-slate-700 transition hover:bg-slate-50",children:[r.jsx(Fa,{className:"h-3.5 w-3.5"}),"Edit"]})]}),r.jsxs("div",{className:"mt-2 space-y-1 text-[11px] text-slate-600",children:[I.contact_person&&r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-slate-700",children:"Contact:"})," ",I.contact_person]}),I.phone&&r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-slate-700",children:"Phone:"})," ",I.phone]}),I.email&&r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-slate-700",children:"Email:"})," ",I.email]}),I.address&&r.jsxs("div",{className:"line-clamp-2",children:[r.jsx("span",{className:"font-medium text-slate-700",children:"Address:"})," ",I.address]})]})]},I.id)),!d&&A.length===0&&r.jsx("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 p-4 text-center text-xs text-slate-500",children:"No payers found."})]}),r.jsx("div",{className:"hidden overflow-x-auto rounded-2xl border border-slate-100 bg-white sm:block",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-slate-50/80",children:r.jsxs("tr",{className:"text-left text-[11px] font-medium uppercase tracking-wide text-slate-500",children:[r.jsx("th",{className:"p-2",children:"#"}),r.jsx("th",{className:"p-2",children:"Code"}),r.jsx("th",{className:"p-2",children:"Name"}),r.jsx("th",{className:"p-2",children:"Type"}),r.jsx("th",{className:"p-2",children:"Contact"}),r.jsx("th",{className:"p-2",children:"Phone / Email"}),r.jsx("th",{className:"p-2",children:"Address"}),r.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[d&&r.jsx("tr",{children:r.jsx("td",{colSpan:8,className:"p-4 text-center text-xs text-slate-500 sm:text-sm",children:"Loading payers"})}),!d&&A.map((I,M)=>r.jsxs("tr",{className:"border-t border-slate-100 text-xs text-slate-800 transition hover:bg-slate-50",children:[r.jsx("td",{className:"p-2",children:M+1}),r.jsx("td",{className:"p-2 font-mono text-[11px] text-slate-700",children:I.code}),r.jsx("td",{className:"p-2",children:I.name}),r.jsx("td",{className:"p-2 capitalize text-slate-700",children:I.payer_type||""}),r.jsx("td",{className:"p-2 text-slate-700",children:I.contact_person||""}),r.jsxs("td",{className:"p-2",children:[r.jsx("div",{children:I.phone||""}),r.jsx("div",{className:"text-[11px] text-slate-500",children:I.email||""})]}),r.jsx("td",{className:"p-2 max-w-xs",children:r.jsx("div",{className:"line-clamp-2 text-[11px] text-slate-600",children:I.address||""})}),r.jsx("td",{className:"p-2 text-right",children:a&&r.jsxs("button",{onClick:()=>P(I),className:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-2 py-1 text-[11px] text-slate-700 transition hover:bg-slate-50",children:[r.jsx(Fa,{className:"h-3.5 w-3.5"}),"Edit"]})})]},I.id)),!d&&A.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:8,className:"p-6 text-center text-xs text-slate-500 sm:text-sm",children:"No payers found."})})]})]})}),v&&r.jsx(V8e,{onClose:()=>{w(!1),S(null)},existing:_,onSaved:O,onDeleted:D})]})}function V8e({existing:t,onClose:s,onSaved:n,onDeleted:a}){const i=nt("patients.masters.manage"),[l,o]=y.useState(()=>({code:(t==null?void 0:t.code)||"",name:(t==null?void 0:t.name)||"",payer_type:(t==null?void 0:t.payer_type)||"insurance",contact_person:(t==null?void 0:t.contact_person)||"",phone:(t==null?void 0:t.phone)||"",email:(t==null?void 0:t.email)||"",address:(t==null?void 0:t.address)||""})),[c,d]=y.useState(!1),[u,h]=y.useState(""),f=async b=>{var v,w;if(b.preventDefault(),!!i){d(!0),h("");try{t?(await J.put(`/patient-masters/payers/${t.id}`,l),n&&n("update")):(await J.post("/patient-masters/payers",l),n&&n("create"))}catch(_){const S=((w=(v=_==null?void 0:_.response)==null?void 0:v.data)==null?void 0:w.detail)||"Failed to save payer";h(S),se.error(S)}finally{d(!1)}}},x=async()=>{var b,v;if(!(!t||!i)&&window.confirm("Deactivate this payer?")){d(!0),h("");try{await J.delete(`/patient-masters/payers/${t.id}`),a&&a(),s&&s()}catch(w){const _=((v=(b=w==null?void 0:w.response)==null?void 0:b.data)==null?void 0:v.detail)||"Failed to deactivate payer";h(_),se.error(_)}finally{d(!1)}}};return r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm p-3 sm:p-4",children:r.jsxs("div",{className:"max-h-[90vh] w-full max-w-xl overflow-y-auto rounded-2xl bg-white p-4 shadow-2xl sm:p-5",children:[r.jsxs("div",{className:"mb-4 flex items-center justify-between gap-2",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-base font-semibold text-slate-900 sm:text-lg",children:t?"Edit Payer":"New Payer"}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-500 sm:text-xs",children:"Master record used for credit / insurance patients."})]}),r.jsx("button",{onClick:s,type:"button",className:"rounded-full p-2 text-slate-500 transition hover:bg-slate-100 hover:text-slate-700",children:r.jsx(Kn,{className:"h-4 w-4"})})]}),u&&r.jsx("div",{className:"mb-3 rounded-xl border border-rose-200 bg-rose-50/80 p-3 text-xs text-rose-700 sm:text-sm",children:u}),r.jsxs("form",{onSubmit:f,className:"space-y-3 text-xs sm:text-sm",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Code"}),r.jsx("input",{className:"input text-slate-800",value:l.code,onChange:b=>o({...l,code:b.target.value.toUpperCase()}),required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Name"}),r.jsx("input",{className:"input text-slate-800",value:l.name,onChange:b=>o({...l,name:b.target.value}),required:!0})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Type"}),r.jsx("select",{className:"input text-slate-800",value:l.payer_type,onChange:b=>o({...l,payer_type:b.target.value}),children:BK.map(b=>r.jsx("option",{value:b.value,children:b.label},b.value))})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Contact Person"}),r.jsx("input",{className:"input text-slate-800",value:l.contact_person,onChange:b=>o({...l,contact_person:b.target.value})})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Phone"}),r.jsx("input",{className:"input text-slate-800",value:l.phone,onChange:b=>o({...l,phone:b.target.value})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Email"}),r.jsx("input",{className:"input text-slate-800",type:"email",value:l.email,onChange:b=>o({...l,email:b.target.value})})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Address"}),r.jsx("textarea",{className:"input min-h-[80px] text-slate-800",value:l.address,onChange:b=>o({...l,address:b.target.value})})]}),r.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3",children:[t&&r.jsxs("button",{type:"button",onClick:x,className:"inline-flex items-center gap-2 rounded-full border border-rose-200 px-3 py-1.5 text-[11px] font-medium text-rose-700 transition hover:bg-rose-50",children:[r.jsx(wr,{className:"h-3.5 w-3.5"}),"Deactivate"]}),r.jsxs("div",{className:"ml-auto flex gap-2",children:[r.jsx("button",{type:"button",onClick:s,className:"rounded-full border border-slate-200 px-4 py-1.5 text-[11px] text-slate-700 transition hover:bg-slate-50",children:"Cancel"}),r.jsx("button",{className:"btn rounded-full px-4 py-1.5 text-[11px]",disabled:c||!i,children:c?"Saving":"Save"})]})]})]})]})})}function H8e(){const t=nt("patients.masters.view"),s=nt("patients.masters.manage"),[n,a]=y.useState([]),[i,l]=y.useState([]),[o,c]=y.useState(!1),[d,u]=y.useState(""),[h,f]=y.useState(""),[x,b]=y.useState(!1),[v,w]=y.useState(null),_=y.useCallback(async()=>{var D,I;if(t){c(!0),u("");try{const[M,B]=await Promise.all([J.get("/patient-masters/tpas"),J.get("/patient-masters/payers")]);a(M.data||[]),l(B.data||[])}catch(M){const B=((I=(D=M==null?void 0:M.response)==null?void 0:D.data)==null?void 0:I.detail)||"Failed to load TPAs";u(B),se.error(B)}finally{c(!1)}}},[t]);y.useEffect(()=>{_()},[_]);const S=y.useMemo(()=>{const D={};for(const I of i)D[I.id]=I;return D},[i]),k=y.useMemo(()=>{if(!h)return n;const D=h.toLowerCase();return n.filter(I=>{var M,B,L,F;return((M=I.name)==null?void 0:M.toLowerCase().includes(D))||((B=I.code)==null?void 0:B.toLowerCase().includes(D))||((F=(L=S[I.payer_id])==null?void 0:L.name)==null?void 0:F.toLowerCase().includes(D))})},[n,h,S]),A=()=>{w(null),b(!0)},T=D=>{s&&(w(D),b(!0))},P=D=>{b(!1),w(null),_(),se.success(D==="update"?"TPA updated successfully":"TPA created successfully")},O=()=>{_(),se.success("TPA deactivated successfully")};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"flex items-start gap-2 text-xs text-slate-600 sm:text-sm",children:[r.jsx(U7,{className:"mt-0.5 h-4 w-4 text-blue-600"}),r.jsx("span",{children:"Third-party administrators (TPAs) linked to payers."})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx("input",{value:h,onChange:D=>f(D.target.value),placeholder:"Search code, name, payer",className:"w-52 max-w-full rounded-2xl border border-slate-200 bg-slate-50 px-8 py-1.5 text-xs text-slate-800 outline-none ring-0 transition focus:border-blue-500 focus:bg-white focus:ring-2 focus:ring-blue-100"}),r.jsx(es,{className:"pointer-events-none absolute left-2 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"})]}),s&&r.jsxs("button",{onClick:A,className:"inline-flex items-center gap-2 rounded-full bg-blue-600 px-3 py-1.5 text-xs font-medium text-white shadow-sm transition hover:bg-blue-700 hover:shadow-md active:scale-95 sm:text-sm",children:[r.jsx(ps,{className:"h-4 w-4"}),"New TPA"]})]})]}),d&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50/80 p-3 text-xs text-rose-700 sm:text-sm",children:d}),r.jsxs("div",{className:"grid gap-3 sm:hidden",children:[o&&r.jsx("div",{className:"rounded-2xl border border-slate-100 bg-slate-50 p-4 text-center text-xs text-slate-500 shadow-sm",children:"Loading TPAs"}),!o&&k.map(D=>{var I;return r.jsxs("div",{className:"group rounded-2xl border border-slate-100 bg-white p-3 shadow-sm transition hover:-translate-y-0.5 hover:shadow-md",children:[r.jsxs("div",{className:"flex items-start justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:D.name}),D.code&&r.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[11px] font-mono text-slate-600",children:D.code})]}),r.jsxs("div",{className:"mt-1 text-[11px] text-slate-500",children:["Payer: ",((I=S[D.payer_id])==null?void 0:I.name)||""]})]}),s&&r.jsxs("button",{onClick:()=>T(D),className:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-2 py-1 text-[11px] text-slate-700 hover:bg-slate-50",children:[r.jsx(Fa,{className:"h-3.5 w-3.5"}),"Edit"]})]}),r.jsxs("div",{className:"mt-2 space-y-1 text-[11px] text-slate-600",children:[D.contact_person&&r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-slate-700",children:"Contact:"})," ",D.contact_person]}),D.phone&&r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-slate-700",children:"Phone:"})," ",D.phone]}),D.email&&r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-slate-700",children:"Email:"})," ",D.email]})]})]},D.id)}),!o&&k.length===0&&r.jsx("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 p-4 text-center text-xs text-slate-500",children:"No TPAs found."})]}),r.jsx("div",{className:"hidden overflow-x-auto rounded-2xl border border-slate-100 bg-white sm:block",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-slate-50/80",children:r.jsxs("tr",{className:"text-left text-[11px] font-medium uppercase tracking-wide text-slate-500",children:[r.jsx("th",{className:"p-2",children:"#"}),r.jsx("th",{className:"p-2",children:"Code"}),r.jsx("th",{className:"p-2",children:"Name"}),r.jsx("th",{className:"p-2",children:"Payer"}),r.jsx("th",{className:"p-2",children:"Contact"}),r.jsx("th",{className:"p-2",children:"Phone / Email"}),r.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[o&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"p-4 text-center text-xs text-slate-500 sm:text-sm",children:"Loading TPAs"})}),!o&&k.map((D,I)=>{var M;return r.jsxs("tr",{className:"border-t border-slate-100 text-xs text-slate-800 transition hover:bg-slate-50",children:[r.jsx("td",{className:"p-2 text-slate-800",children:I+1}),r.jsx("td",{className:"p-2 font-mono text-[11px] text-slate-700",children:D.code}),r.jsx("td",{className:"p-2 text-slate-900",children:D.name}),r.jsx("td",{className:"p-2 text-slate-800",children:((M=S[D.payer_id])==null?void 0:M.name)||""}),r.jsx("td",{className:"p-2 text-slate-800",children:D.contact_person||""}),r.jsxs("td",{className:"p-2 text-slate-800",children:[r.jsx("div",{children:D.phone||""}),r.jsx("div",{className:"text-[11px] text-slate-500",children:D.email||""})]}),r.jsx("td",{className:"p-2 text-right",children:s&&r.jsxs("button",{onClick:()=>T(D),className:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-2 py-1 text-[11px] text-slate-700 transition hover:bg-slate-50",children:[r.jsx(Fa,{className:"h-3.5 w-3.5"}),"Edit"]})})]},D.id)}),!o&&k.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"p-6 text-center text-xs text-slate-500 sm:text-sm",children:"No TPAs found."})})]})]})}),x&&r.jsx(W8e,{existing:v,onClose:()=>{b(!1),w(null)},payers:i,onSaved:P,onDeleted:O})]})}function W8e({existing:t,payers:s,onClose:n,onSaved:a,onDeleted:i}){const l=nt("patients.masters.manage"),[o,c]=y.useState(()=>({code:(t==null?void 0:t.code)||"",name:(t==null?void 0:t.name)||"",payer_id:(t==null?void 0:t.payer_id)||"",contact_person:(t==null?void 0:t.contact_person)||"",phone:(t==null?void 0:t.phone)||"",email:(t==null?void 0:t.email)||""})),[d,u]=y.useState(!1),[h,f]=y.useState(""),x=async v=>{var w,_;if(v.preventDefault(),!!l){u(!0),f("");try{const S={...o,payer_id:o.payer_id?Number(o.payer_id):null};t?(await J.put(`/patient-masters/tpas/${t.id}`,S),a&&a("update")):(await J.post("/patient-masters/tpas",S),a&&a("create"))}catch(S){const k=((_=(w=S==null?void 0:S.response)==null?void 0:w.data)==null?void 0:_.detail)||"Failed to save TPA";f(k),se.error(k)}finally{u(!1)}}},b=async()=>{var v,w;if(!(!t||!l)&&window.confirm("Deactivate this TPA?")){u(!0),f("");try{await J.delete(`/patient-masters/tpas/${t.id}`),i&&i(),n&&n()}catch(_){const S=((w=(v=_==null?void 0:_.response)==null?void 0:v.data)==null?void 0:w.detail)||"Failed to deactivate TPA";f(S),se.error(S)}finally{u(!1)}}};return r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm p-3 sm:p-4",children:r.jsxs("div",{className:"max-h-[90vh] w-full max-w-xl overflow-y-auto rounded-2xl bg-white p-4 shadow-2xl sm:p-5",children:[r.jsxs("div",{className:"mb-4 flex items-center justify-between gap-2",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-base font-semibold text-slate-900 sm:text-lg",children:t?"Edit TPA":"New TPA"}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-500 sm:text-xs",children:"Third-party administrator master, mapped to payer."})]}),r.jsx("button",{onClick:n,type:"button",className:"rounded-full p-2 text-slate-500 transition hover:bg-slate-100 hover:text-slate-700",children:r.jsx(Kn,{className:"h-4 w-4"})})]}),h&&r.jsx("div",{className:"mb-3 rounded-xl border border-rose-200 bg-rose-50/80 p-3 text-xs text-rose-700 sm:text-sm",children:h}),r.jsxs("form",{onSubmit:x,className:"space-y-3 text-xs sm:text-sm",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Code"}),r.jsx("input",{className:"input text-slate-800",value:o.code,onChange:v=>c({...o,code:v.target.value.toUpperCase()}),required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Name"}),r.jsx("input",{className:"input text-slate-800",value:o.name,onChange:v=>c({...o,name:v.target.value}),required:!0})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Payer"}),r.jsxs("select",{className:"input text-slate-800",value:o.payer_id||"",onChange:v=>c({...o,payer_id:v.target.value||""}),required:!0,children:[r.jsx("option",{value:"",children:"Select payer"}),s.map(v=>r.jsx("option",{value:v.id,children:v.name},v.id))]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Contact Person"}),r.jsx("input",{className:"input text-slate-800",value:o.contact_person,onChange:v=>c({...o,contact_person:v.target.value})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Phone"}),r.jsx("input",{className:"input text-slate-800",value:o.phone,onChange:v=>c({...o,phone:v.target.value})})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Email"}),r.jsx("input",{className:"input text-slate-800",type:"email",value:o.email,onChange:v=>c({...o,email:v.target.value})})]}),r.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3",children:[t&&r.jsxs("button",{type:"button",onClick:b,className:"inline-flex items-center gap-2 rounded-full border border-rose-200 px-3 py-1.5 text-[11px] font-medium text-rose-700 transition hover:bg-rose-50",children:[r.jsx(wr,{className:"h-3.5 w-3.5"}),"Deactivate"]}),r.jsxs("div",{className:"ml-auto flex gap-2",children:[r.jsx("button",{type:"button",onClick:n,className:"rounded-full border border-slate-200 px-4 py-1.5 text-[11px] text-slate-700 transition hover:bg-slate-50",children:"Cancel"}),r.jsx("button",{className:"btn rounded-full px-4 py-1.5 text-[11px]",disabled:d||!l,children:d?"Saving":"Save"})]})]})]})]})})}function q8e(){const t=nt("patients.masters.view"),s=nt("patients.masters.manage"),[n,a]=y.useState([]),[i,l]=y.useState([]),[o,c]=y.useState([]),[d,u]=y.useState(!1),[h,f]=y.useState(""),[x,b]=y.useState(""),[v,w]=y.useState(!1),[_,S]=y.useState(null),k=y.useCallback(async()=>{var B,L;if(t){u(!0),f("");try{const[F,V,$]=await Promise.all([J.get("/patient-masters/credit-plans"),J.get("/patient-masters/payers"),J.get("/patient-masters/tpas")]);a(F.data||[]),l(V.data||[]),c($.data||[])}catch(F){const V=((L=(B=F==null?void 0:F.response)==null?void 0:B.data)==null?void 0:L.detail)||"Failed to load credit plans";f(V),se.error(V)}finally{u(!1)}}},[t]);y.useEffect(()=>{k()},[k]);const A=y.useMemo(()=>{const B={};for(const L of i)B[L.id]=L;return B},[i]),T=y.useMemo(()=>{const B={};for(const L of o)B[L.id]=L;return B},[o]),P=y.useMemo(()=>{if(!x)return n;const B=x.toLowerCase();return n.filter(L=>{var F,V,$,z,H,q;return((F=L.name)==null?void 0:F.toLowerCase().includes(B))||((V=L.code)==null?void 0:V.toLowerCase().includes(B))||((z=($=A[L.payer_id])==null?void 0:$.name)==null?void 0:z.toLowerCase().includes(B))||((q=(H=T[L.tpa_id])==null?void 0:H.name)==null?void 0:q.toLowerCase().includes(B))})},[n,x,A,T]),O=()=>{S(null),w(!0)},D=B=>{s&&(S(B),w(!0))},I=B=>{w(!1),S(null),k(),se.success(B==="update"?"Credit plan updated successfully":"Credit plan created successfully")},M=()=>{k(),se.success("Credit plan deactivated successfully")};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"flex items-start gap-2 text-xs text-slate-600 sm:text-sm",children:[r.jsx(L7,{className:"mt-0.5 h-4 w-4 text-blue-600"}),r.jsx("span",{children:"Credit / insurance plans used for IPD/OPD billing & authorization."})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx("input",{value:x,onChange:B=>b(B.target.value),placeholder:"Search code, name, payer, TPA",className:"w-60 max-w-full rounded-2xl border border-slate-200 bg-slate-50 px-8 py-1.5 text-xs text-slate-800 outline-none ring-0 transition focus:border-blue-500 focus:bg-white focus:ring-2 focus:ring-blue-100"}),r.jsx(es,{className:"pointer-events-none absolute left-2 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"})]}),s&&r.jsxs("button",{onClick:O,className:"inline-flex items-center gap-2 rounded-full bg-blue-600 px-3 py-1.5 text-xs font-medium text-white shadow-sm transition hover:bg-blue-700 hover:shadow-md active:scale-95 sm:text-sm",children:[r.jsx(ps,{className:"h-4 w-4"}),"New Plan"]})]})]}),h&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50/80 p-3 text-xs text-rose-700 sm:text-sm",children:h}),r.jsxs("div",{className:"grid gap-3 sm:hidden",children:[d&&r.jsx("div",{className:"rounded-2xl border border-slate-100 bg-slate-50 p-4 text-center text-xs text-slate-500 shadow-sm",children:"Loading credit plans"}),!d&&P.map(B=>{var L,F;return r.jsxs("div",{className:"group rounded-2xl border border-slate-100 bg-white p-3 shadow-sm transition hover:-translate-y-0.5 hover:shadow-md",children:[r.jsxs("div",{className:"flex items-start justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:B.name}),B.code&&r.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[11px] font-mono text-slate-600",children:B.code})]}),r.jsxs("div",{className:"mt-1 text-[11px] text-slate-500",children:["Payer: ",((L=A[B.payer_id])==null?void 0:L.name)||""]}),r.jsxs("div",{className:"mt-0.5 text-[11px] text-slate-500",children:["TPA: ",((F=T[B.tpa_id])==null?void 0:F.name)||""]})]}),s&&r.jsxs("button",{onClick:()=>D(B),className:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-2 py-1 text-[11px] text-slate-700 hover:bg-slate-50",children:[r.jsx(Fa,{className:"h-3.5 w-3.5"}),"Edit"]})]}),B.description&&r.jsx("div",{className:"mt-2 text-[11px] text-slate-600",children:B.description})]},B.id)}),!d&&P.length===0&&r.jsx("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 p-4 text-center text-xs text-slate-500",children:"No credit plans found."})]}),r.jsx("div",{className:"hidden overflow-x-auto rounded-2xl border border-slate-100 bg-white sm:block",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-slate-50/80",children:r.jsxs("tr",{className:"text-left text-[11px] font-medium uppercase tracking-wide text-slate-500",children:[r.jsx("th",{className:"p-2",children:"#"}),r.jsx("th",{className:"p-2",children:"Code"}),r.jsx("th",{className:"p-2",children:"Name"}),r.jsx("th",{className:"p-2",children:"Payer"}),r.jsx("th",{className:"p-2",children:"TPA"}),r.jsx("th",{className:"p-2",children:"Description"}),r.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[d&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"p-4 text-center text-xs text-slate-500 sm:text-sm",children:"Loading credit plans"})}),!d&&P.map((B,L)=>{var F,V;return r.jsxs("tr",{className:"border-t border-slate-100 text-xs text-slate-800 transition hover:bg-slate-50",children:[r.jsx("td",{className:"p-2",children:L+1}),r.jsx("td",{className:"p-2 font-mono text-[11px] text-slate-700",children:B.code}),r.jsx("td",{className:"p-2",children:B.name}),r.jsx("td",{className:"p-2",children:((F=A[B.payer_id])==null?void 0:F.name)||""}),r.jsx("td",{className:"p-2",children:((V=T[B.tpa_id])==null?void 0:V.name)||""}),r.jsx("td",{className:"p-2 max-w-xs",children:r.jsx("div",{className:"line-clamp-2 text-[11px] text-slate-600",children:B.description||""})}),r.jsx("td",{className:"p-2 text-right",children:s&&r.jsxs("button",{onClick:()=>D(B),className:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-2 py-1 text-[11px] text-slate-700 transition hover:bg-slate-50",children:[r.jsx(Fa,{className:"h-3.5 w-3.5"}),"Edit"]})})]},B.id)}),!d&&P.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"p-6 text-center text-xs text-slate-500 sm:text-sm",children:"No credit plans found."})})]})]})}),v&&r.jsx(G8e,{existing:_,payers:i,tpas:o,onClose:()=>{w(!1),S(null)},onSaved:I,onDeleted:M})]})}function G8e({existing:t,payers:s,tpas:n,onClose:a,onSaved:i,onDeleted:l}){const o=nt("patients.masters.manage"),[c,d]=y.useState(()=>({code:(t==null?void 0:t.code)||"",name:(t==null?void 0:t.name)||"",payer_id:(t==null?void 0:t.payer_id)||"",tpa_id:(t==null?void 0:t.tpa_id)||"",description:(t==null?void 0:t.description)||""})),[u,h]=y.useState(!1),[f,x]=y.useState(""),b=async w=>{var _,S;if(w.preventDefault(),!!o){h(!0),x("");try{const k={...c,payer_id:c.payer_id?Number(c.payer_id):null,tpa_id:c.tpa_id?Number(c.tpa_id):null};t?(await J.put(`/patient-masters/credit-plans/${t.id}`,k),i&&i("update")):(await J.post("/patient-masters/credit-plans",k),i&&i("create"))}catch(k){const A=((S=(_=k==null?void 0:k.response)==null?void 0:_.data)==null?void 0:S.detail)||"Failed to save credit plan";x(A),se.error(A)}finally{h(!1)}}},v=async()=>{var w,_;if(!(!t||!o)&&window.confirm("Deactivate this credit plan?")){h(!0),x("");try{await J.delete(`/patient-masters/credit-plans/${t.id}`),l&&l(),a&&a()}catch(S){const k=((_=(w=S==null?void 0:S.response)==null?void 0:w.data)==null?void 0:_.detail)||"Failed to deactivate credit plan";x(k),se.error(k)}finally{h(!1)}}};return r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm p-3 sm:p-4",children:r.jsxs("div",{className:"max-h-[90vh] w-full max-w-xl overflow-y-auto rounded-2xl bg-white p-4 shadow-2xl sm:p-5",children:[r.jsxs("div",{className:"mb-4 flex items-center justify-between gap-2",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-base font-semibold text-slate-900 sm:text-lg",children:t?"Edit Credit Plan":"New Credit Plan"}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-500 sm:text-xs",children:"Map plan to payer & optional TPA for billing workflows."})]}),r.jsx("button",{onClick:a,type:"button",className:"rounded-full p-2 text-slate-500 transition hover:bg-slate-100 hover:text-slate-700",children:r.jsx(Kn,{className:"h-4 w-4"})})]}),f&&r.jsx("div",{className:"mb-3 rounded-xl border border-rose-200 bg-rose-50/80 p-3 text-xs text-rose-700 sm:text-sm",children:f}),r.jsxs("form",{onSubmit:b,className:"space-y-3 text-xs sm:text-sm",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Code"}),r.jsx("input",{className:"input text-slate-800",value:c.code,onChange:w=>d({...c,code:w.target.value.toUpperCase()}),required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Name"}),r.jsx("input",{className:"input text-slate-800",value:c.name,onChange:w=>d({...c,name:w.target.value}),required:!0})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Payer"}),r.jsxs("select",{className:"input text-slate-800",value:c.payer_id||"",onChange:w=>d({...c,payer_id:w.target.value||""}),required:!0,children:[r.jsx("option",{value:"",children:"Select payer"}),s.map(w=>r.jsx("option",{value:w.id,children:w.name},w.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"TPA (optional)"}),r.jsxs("select",{className:"input text-slate-800",value:c.tpa_id||"",onChange:w=>d({...c,tpa_id:w.target.value||""}),children:[r.jsx("option",{value:"",children:"No TPA"}),n.map(w=>r.jsx("option",{value:w.id,children:w.name},w.id))]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-[11px] font-medium text-slate-800",children:"Description / Notes"}),r.jsx("textarea",{className:"input min-h-[80px] text-slate-800",value:c.description,onChange:w=>d({...c,description:w.target.value})})]}),r.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3",children:[t&&r.jsxs("button",{type:"button",onClick:v,className:"inline-flex items-center gap-2 rounded-full border border-rose-200 px-3 py-1.5 text-[11px] font-medium text-rose-700 transition hover:bg-rose-50",children:[r.jsx(wr,{className:"h-3.5 w-3.5"}),"Deactivate"]}),r.jsxs("div",{className:"ml-auto flex gap-2",children:[r.jsx("button",{type:"button",onClick:a,className:"rounded-full border border-slate-200 px-4 py-1.5 text-[11px] text-slate-700 transition hover:bg-slate-50",children:"Cancel"}),r.jsx("button",{className:"btn rounded-full px-4 py-1.5 text-[11px]",disabled:u||!o,children:u?"Saving":"Save"})]})]})]})]})})}const GR=[{key:"all",label:"All"},{key:"op_billing",label:"OP Billing"},{key:"ip_billing",label:"IP Billing"},{key:"lab",label:"Lab"},{key:"pharmacy",label:"Pharmacy"},{key:"radiology",label:"Radiology"},{key:"general",label:"General"}],K8e={draft:"bg-yellow-100 text-yellow-800",finalized:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"},Uf=10;function o2(t){return Number(t||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}function Y8e(){var $;const[t,s]=y.useState("all"),[n,a]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState({doctors:[],credit_providers:[],packages:[],payers:[],tpas:[],credit_plans:[]}),[d,u]=y.useState(!1),[h,f]=y.useState(""),[x,b]=y.useState(1),[v,w]=y.useState({patient_id:null,billing_type:"op_billing",context_type:"opd",context_id:"",remarks:""}),_=Va();y.useEffect(()=>{S()},[]),y.useEffect(()=>{k()},[t]);async function S(){try{const{data:z}=await Xk();c({doctors:(z==null?void 0:z.doctors)||[],credit_providers:(z==null?void 0:z.credit_providers)||[],packages:(z==null?void 0:z.packages)||[],payers:(z==null?void 0:z.payers)||[],tpas:(z==null?void 0:z.tpas)||[],credit_plans:(z==null?void 0:z.credit_plans)||[]})}catch(z){console.error("Failed to load billing masters",z)}}async function k(){l(!0),f("");try{const z={};t!=="all"&&(z.billing_type=t);const{data:H}=await Qge(z);a(H||[]),b(1)}catch(z){console.error("Failed to load invoices",z),f("Unable to load invoices. Please try again.")}finally{l(!1)}}function A(z){_(`/billing/invoices/${z}`)}function T(z){s(z)}function P(z){const{name:H,value:q}=z.target;w(G=>({...G,[H]:q}))}function O(z){w(typeof z=="number"?H=>({...H,patient_id:z}):z&&typeof z=="object"?H=>({...H,patient_id:z.id}):H=>({...H,patient_id:null}))}async function D(z){if(z.preventDefault(),f(""),!v.patient_id){f("Please select a patient to create an invoice.");return}try{const H={patient_id:Number(v.patient_id),billing_type:v.billing_type||null,context_type:v.context_type||null,context_id:v.context_id?Number(v.context_id):null,remarks:v.remarks||null},{data:q}=await Yge(H);u(!1),w({patient_id:null,billing_type:"op_billing",context_type:"opd",context_id:"",remarks:""}),_(`/billing/invoices/${q.id}`)}catch(H){console.error("Create invoice failed",H),f("Unable to create invoice. Please check details and try again.")}}const I=y.useMemo(()=>Math.max(1,Math.ceil(n.length/Uf)),[n.length]),M=y.useMemo(()=>{const z=(x-1)*Uf;return n.slice(z,z+Uf)},[n,x]);function B(){b(z=>Math.max(1,z-1))}function L(){b(z=>Math.min(I,z+1))}const F=n.length===0?0:(x-1)*Uf+1,V=n.length===0?0:Math.min(x*Uf,n.length);return r.jsxs("div",{className:"min-h-[calc(100vh-4rem)] bg-gradient-to-b from-slate-50 via-slate-100 to-slate-50 py-4 px-3 md:px-6",children:[r.jsxs("div",{className:"max-w-6xl mx-auto space-y-4",children:[r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-slate-900",children:"Billing Console"}),r.jsx("p",{className:"text-xs md:text-sm text-slate-500",children:"One place to manage OP / IP / Lab / Pharmacy billing, refunds and credit tracking."})]}),r.jsx("button",{type:"button",onClick:()=>u(!0),className:"inline-flex items-center justify-center rounded-full bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-500 px-4 py-2 text-xs md:text-sm font-medium text-white shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:"+ New Invoice"})]}),r.jsx("div",{className:"rounded-2xl bg-gradient-to-r from-indigo-50 via-sky-50 to-purple-50 p-2 shadow-sm border border-slate-100",children:r.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1",children:GR.map(z=>{const H=t===z.key;return r.jsx("button",{type:"button",onClick:()=>T(z.key),className:`whitespace-nowrap rounded-full px-3.5 py-1.5 text-xs md:text-[13px] font-medium transition-all ${H?"bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-500 text-white shadow-md":"bg-white/70 text-slate-700 hover:bg-white hover:text-slate-900 border border-slate-200"}`,children:z.label},z.key)})})}),r.jsxs("div",{className:"rounded-2xl bg-white shadow-sm border border-slate-200 overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between px-3 md:px-4 py-2 border-b border-slate-100",children:[r.jsxs("div",{className:"flex flex-col gap-0.5",children:[r.jsx("span",{className:"text-xs font-semibold text-slate-800",children:"Invoices"}),r.jsx("span",{className:"text-[11px] text-slate-400",children:t==="all"?"All billing types":`Filtered by ${(($=GR.find(z=>z.key===t))==null?void 0:$.label)||""}`})]}),r.jsx("button",{type:"button",onClick:k,className:"text-[11px] text-indigo-600 hover:text-indigo-800",children:"Refresh"})]}),h&&r.jsx("div",{className:"px-3 md:px-4 py-2 bg-red-50 text-[11px] text-red-700",children:h}),i?r.jsx("div",{className:"px-3 md:px-4 py-8 text-center text-xs text-slate-500",children:"Loading invoices..."}):n.length===0?r.jsx("div",{className:"px-3 md:px-4 py-8 text-center text-xs text-slate-500",children:"No invoices found for this filter."}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"overflow-x-auto text-xs",children:r.jsxs("table",{className:"min-w-full divide-y divide-slate-100",children:[r.jsx("thead",{className:"bg-slate-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 md:px-4 py-2 text-left font-medium text-slate-500",children:"Inv #"}),r.jsx("th",{className:"px-3 md:px-4 py-2 text-left font-medium text-slate-500",children:"Billing Type"}),r.jsx("th",{className:"px-3 md:px-4 py-2 text-left font-medium text-slate-500",children:"Patient"}),r.jsx("th",{className:"px-3 md:px-4 py-2 text-right font-medium text-slate-500",children:"Net"}),r.jsx("th",{className:"px-3 md:px-4 py-2 text-right font-medium text-slate-500",children:"Paid"}),r.jsx("th",{className:"px-3 md:px-4 py-2 text-right font-medium text-slate-500",children:"Balance"}),r.jsx("th",{className:"px-3 md:px-4 py-2 text-left font-medium text-slate-500",children:"Status"}),r.jsx("th",{className:"px-3 md:px-4 py-2"})]})}),r.jsx("tbody",{className:"divide-y divide-slate-100",children:M.map(z=>r.jsxs("tr",{className:"hover:bg-slate-50 cursor-pointer",onClick:()=>A(z.id),children:[r.jsx("td",{className:"px-3 md:px-4 py-2 text-slate-800 whitespace-nowrap",children:z.invoice_number||z.id}),r.jsx("td",{className:"px-3 md:px-4 py-2 text-slate-600 whitespace-nowrap",children:z.billing_type||"general"}),r.jsxs("td",{className:"px-3 md:px-4 py-2 text-slate-500 whitespace-nowrap",children:["#",z.patient_id]}),r.jsxs("td",{className:"px-3 md:px-4 py-2 text-right text-slate-800 whitespace-nowrap",children:[" ",o2(z.net_total)]}),r.jsxs("td",{className:"px-3 md:px-4 py-2 text-right text-slate-600 whitespace-nowrap",children:[" ",o2(z.amount_paid)]}),r.jsxs("td",{className:"px-3 md:px-4 py-2 text-right text-slate-800 whitespace-nowrap",children:[" ",o2(z.balance_due)]}),r.jsx("td",{className:"px-3 md:px-4 py-2 whitespace-nowrap",children:r.jsx("span",{className:`inline-flex rounded-full px-2.5 py-0.5 text-[10px] font-medium ${K8e[z.status]||"bg-slate-100 text-slate-700"}`,children:z.status})}),r.jsx("td",{className:"px-3 md:px-4 py-2 text-right whitespace-nowrap",children:r.jsx("span",{className:"text-[11px] text-indigo-600 hover:text-indigo-800",children:"Open "})})]},z.id))})]})}),r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2 px-3 md:px-4 py-3 border-t border-slate-100 text-[11px]",children:[r.jsxs("div",{className:"text-slate-500",children:["Showing ",r.jsx("span",{className:"font-medium",children:F}),"",r.jsx("span",{className:"font-medium",children:V})," of"," ",r.jsx("span",{className:"font-medium",children:n.length})," ","invoices"]}),r.jsxs("div",{className:"flex items-center justify-end gap-2",children:[r.jsx("button",{type:"button",onClick:B,disabled:x===1,className:`px-2.5 py-1 rounded-md border text-[11px] ${x===1?"border-slate-200 text-slate-300 cursor-not-allowed":"border-slate-300 text-slate-700 hover:bg-slate-50"}`,children:"Prev"}),r.jsxs("span",{className:"text-slate-500",children:["Page"," ",r.jsx("span",{className:"font-semibold text-slate-800",children:x})," ","/ ",I]}),r.jsx("button",{type:"button",onClick:L,disabled:x===I,className:`px-2.5 py-1 rounded-md border text-[11px] ${x===I?"border-slate-200 text-slate-300 cursor-not-allowed":"border-slate-300 text-slate-700 hover:bg-slate-50"}`,children:"Next"})]})]})]})]})]}),d&&r.jsx("div",{className:"fixed inset-0 z-30 flex items-end sm:items-center justify-center bg-black/40",children:r.jsxs("div",{className:"w-full sm:max-w-md bg-white rounded-t-2xl sm:rounded-2xl shadow-lg p-4 space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"New Invoice"}),r.jsx("button",{type:"button",onClick:()=>u(!1),className:"text-xs text-slate-400 hover:text-slate-600",children:""})]}),r.jsxs("form",{className:"space-y-3",onSubmit:D,children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Patient"}),r.jsx(DV,{value:v.patient_id,onChange:O}),r.jsx("p",{className:"text-[10px] text-slate-400",children:"Search by name / UHID / phone and pick the patient for billing."})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Billing Type"}),r.jsxs("select",{name:"billing_type",value:v.billing_type,onChange:P,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",children:[r.jsx("option",{value:"op_billing",children:"OP Billing"}),r.jsx("option",{value:"ip_billing",children:"IP Billing"}),r.jsx("option",{value:"lab",children:"Lab"}),r.jsx("option",{value:"pharmacy",children:"Pharmacy"}),r.jsx("option",{value:"radiology",children:"Radiology"}),r.jsx("option",{value:"general",children:"General"})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Context Type (optional)"}),r.jsxs("select",{name:"context_type",value:v.context_type,onChange:P,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",children:[r.jsx("option",{value:"",children:"None"}),r.jsx("option",{value:"opd",children:"OPD"}),r.jsx("option",{value:"ipd",children:"IPD"}),r.jsx("option",{value:"lab",children:"Lab"}),r.jsx("option",{value:"radiology",children:"Radiology"}),r.jsx("option",{value:"pharmacy",children:"Pharmacy"}),r.jsx("option",{value:"other",children:"Other"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Context ID (optional)"}),r.jsx("input",{type:"number",name:"context_id",value:v.context_id,onChange:P,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",placeholder:"Visit / admission / order id"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Remarks (optional)"}),r.jsx("input",{type:"text",name:"remarks",value:v.remarks,onChange:P,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",placeholder:"Any note for this invoice"})]})]}),h&&r.jsx("p",{className:"text-[11px] text-red-600",children:h}),r.jsxs("div",{className:"flex gap-2 justify-end pt-1",children:[r.jsx("button",{type:"button",onClick:()=>u(!1),className:"px-3 py-1.5 rounded-md border border-slate-300 text-xs text-slate-700",children:"Cancel"}),r.jsx("button",{type:"submit",className:"px-3 py-1.5 rounded-md bg-indigo-600 text-xs font-medium text-white hover:bg-indigo-700",children:"Create & Open"})]})]})]})})]})}var X8e="Label",FK=y.forwardRef((t,s)=>r.jsx(rs.label,{...t,ref:s,onMouseDown:n=>{var i;n.target.closest("button, input, select, textarea")||((i=t.onMouseDown)==null||i.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));FK.displayName=X8e;var $K=FK;const Q8e=rv("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Qe=y.forwardRef(({className:t,...s},n)=>r.jsx($K,{ref:n,className:Ft(Q8e(),t),...s}));Qe.displayName=$K.displayName;function zl({label:t,name:s,value:n,onChange:a}){return r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{className:"text-xs font-medium text-slate-600",children:t}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Se,{type:"color",value:n||"#ffffff",onChange:i=>a(s,i.target.value),className:"w-12 h-9 p-1 cursor-pointer"}),r.jsx(Se,{type:"text",value:n||"",onChange:i=>a(s,i.target.value),placeholder:"#0f172a",className:"flex-1"})]})]})}function Z8e(){const{branding:t,setBranding:s,loading:n}=zm()||{},[a,i]=y.useState({}),[l,o]=y.useState(!1),[c,d]=y.useState(!1),[u,h]=y.useState(null),[f,x]=y.useState(null),[b,v]=y.useState(null),[w,_]=y.useState(null),[S,k]=y.useState(null),[A,T]=y.useState(null),[P,O]=y.useState("background");y.useEffect(()=>{t&&(O(t.letterhead_position||"background"),i({org_name:t.org_name||"",org_tagline:t.org_tagline||"",org_address:t.org_address||"",org_phone:t.org_phone||"",org_email:t.org_email||"",org_website:t.org_website||"",org_gstin:t.org_gstin||"",primary_color:t.primary_color||"",primary_color_dark:t.primary_color_dark||"",sidebar_bg_color:t.sidebar_bg_color||"",content_bg_color:t.content_bg_color||"",card_bg_color:t.card_bg_color||"",border_color:t.border_color||"",text_color:t.text_color||"",text_muted_color:t.text_muted_color||"",icon_color:t.icon_color||"",icon_bg_color:t.icon_bg_color||"",pdf_header_height_mm:typeof t.pdf_header_height_mm=="number"?t.pdf_header_height_mm:"",pdf_footer_height_mm:typeof t.pdf_footer_height_mm=="number"?t.pdf_footer_height_mm:"",pdf_show_page_number:typeof t.pdf_show_page_number=="boolean"?t.pdf_show_page_number:!0}))},[t]);const D=(q,G)=>{i(re=>({...re,[q]:G}))},I=q=>G=>{D(q,G.target.value)},M=q=>G=>{const re=G.target.value;D(q,re===""?"":Number(re))},B=q=>G=>{D(q,!!G.target.checked)},L=(q,G)=>{D(q,G)},F=async()=>{var q,G,re,ye;o(!0);try{const Ee={...a,pdf_header_height_mm:a.pdf_header_height_mm===""?null:Number(a.pdf_header_height_mm),pdf_footer_height_mm:a.pdf_footer_height_mm===""?null:Number(a.pdf_footer_height_mm)},{data:ee}=await Jce(Ee);s==null||s(ee),se.success("Branding settings updated")}catch(Ee){console.error("Failed to update branding settings",Ee);const ee=((G=(q=Ee==null?void 0:Ee.response)==null?void 0:q.data)==null?void 0:G.detail)||((ye=(re=Ee==null?void 0:Ee.response)==null?void 0:re.data)==null?void 0:ye.message)||(Ee==null?void 0:Ee.message)||"Could not save branding settings";se.error(ee)}finally{o(!1)}},V=async q=>{q.preventDefault(),await F()},$=async q=>{q.preventDefault(),await F()},z=async()=>{var G,re,ye,Ee;if(!A){se.warning("Select a letterhead file first");return}const q=new FormData;q.append("file",A),q.append("position",P);try{const{data:ee}=await tde(q);s==null||s(ee),se.success("Letterhead updated successfully"),T(null)}catch(ee){console.error("Failed to upload letterhead",ee);const te=((re=(G=ee==null?void 0:ee.response)==null?void 0:G.data)==null?void 0:re.detail)||((Ee=(ye=ee==null?void 0:ee.response)==null?void 0:ye.data)==null?void 0:Ee.message)||(ee==null?void 0:ee.message)||"Could not upload letterhead";se.error(te)}},H=async q=>{var re,ye,Ee,ee;if(q.preventDefault(),!u&&!f&&!b&&!w&&!S){se.warning("Select at least one file to upload");return}const G=new FormData;u&&G.append("logo",u),f&&G.append("login_logo",f),b&&G.append("favicon",b),w&&G.append("pdf_header",w),S&&G.append("pdf_footer",S),d(!0);try{const{data:te}=await ede(G);s==null||s(te),se.success("Branding files uploaded"),h(null),x(null),v(null),_(null),k(null)}catch(te){console.error("Failed to upload branding files",te);const ce=((ye=(re=te==null?void 0:te.response)==null?void 0:re.data)==null?void 0:ye.detail)||((ee=(Ee=te==null?void 0:te.response)==null?void 0:Ee.data)==null?void 0:ee.message)||(te==null?void 0:te.message)||"Could not upload branding files";se.error(ce)}finally{d(!1)}};return n||!t?r.jsxs("div",{className:"p-6",children:[r.jsx(We,{className:"h-7 w-64 mb-3"}),r.jsx(We,{className:"h-64 w-full"})]}):r.jsxs(at.div,{className:"p-6 space-y-4",initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2},children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl font-semibold text-slate-900",children:"Customization & Templates"}),r.jsx("p",{className:"text-sm text-slate-500",children:"Configure organisation identity, logo, UI colors, and global PDF header/footer for all NABH HIMS documents."})]})}),r.jsxs(Ve,{className:"border border-slate-200 rounded-2xl shadow-sm bg-white",children:[r.jsx(rt,{className:"pb-2",children:r.jsx(ot,{className:"text-sm font-semibold text-slate-900",children:"Global Branding & PDF Settings"})}),r.jsx(He,{children:r.jsxs(jl,{defaultValue:"branding",children:[r.jsxs(Wi,{className:"mb-4",children:[r.jsx(ms,{value:"branding",children:"Branding & Organisation"}),r.jsx(ms,{value:"pdf",children:"PDF Header / Footer & Behaviour"})]}),r.jsx(us,{value:"branding",className:"space-y-6",children:r.jsxs("form",{onSubmit:V,className:"space-y-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:"Organisation details"}),r.jsx("p",{className:"text-xs text-slate-500",children:"These values appear on letterheads, EMR PDFs, discharge summaries and other NABH documents."}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{className:"text-xs text-slate-600",children:"Organisation name"}),r.jsx(Se,{value:a.org_name||"",onChange:I("org_name"),placeholder:"Hospital / Clinic name"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{className:"text-xs text-slate-600",children:"Tagline"}),r.jsx(Se,{value:a.org_tagline||"",onChange:I("org_tagline"),placeholder:"Smart  Secure  NABH-Standard"})]}),r.jsxs("div",{className:"space-y-1.5 md:col-span-2",children:[r.jsx(Qe,{className:"text-xs text-slate-600",children:"Address"}),r.jsx(Se,{value:a.org_address||"",onChange:I("org_address"),placeholder:"Address line for letterhead & PDFs"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{className:"text-xs text-slate-600",children:"Phone"}),r.jsx(Se,{value:a.org_phone||"",onChange:I("org_phone"),placeholder:"+91-XXXXXXXXXX"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{className:"text-xs text-slate-600",children:"Email"}),r.jsx(Se,{type:"email",value:a.org_email||"",onChange:I("org_email"),placeholder:"info@example.com"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{className:"text-xs text-slate-600",children:"Website"}),r.jsx(Se,{value:a.org_website||"",onChange:I("org_website"),placeholder:"https://your-hospital.com"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{className:"text-xs text-slate-600",children:"GSTIN"}),r.jsx(Se,{value:a.org_gstin||"",onChange:I("org_gstin"),placeholder:"GSTIN (optional, for bills)"})]})]})]}),r.jsx("div",{className:"border-t border-slate-100"}),r.jsxs("div",{className:"space-y-3",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:"Color palette"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Tune application colors. These drive sidebar, primary buttons and card backgrounds."}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(zl,{label:"Primary color (buttons, highlights)",name:"primary_color",value:a.primary_color,onChange:L}),r.jsx(zl,{label:"Primary dark (topbar / hover)",name:"primary_color_dark",value:a.primary_color_dark,onChange:L}),r.jsx(zl,{label:"Sidebar background color",name:"sidebar_bg_color",value:a.sidebar_bg_color,onChange:L}),r.jsx(zl,{label:"Content background color",name:"content_bg_color",value:a.content_bg_color,onChange:L}),r.jsx(zl,{label:"Card background color",name:"card_bg_color",value:a.card_bg_color,onChange:L}),r.jsx(zl,{label:"Border color",name:"border_color",value:a.border_color,onChange:L}),r.jsx(zl,{label:"Text color",name:"text_color",value:a.text_color,onChange:L}),r.jsx(zl,{label:"Muted text color",name:"text_muted_color",value:a.text_muted_color,onChange:L}),r.jsx(zl,{label:"Icon color",name:"icon_color",value:a.icon_color,onChange:L}),r.jsx(zl,{label:"Icon background color",name:"icon_bg_color",value:a.icon_bg_color,onChange:L})]})]}),r.jsxs("div",{className:"flex items-center justify-between pt-2",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[(t==null?void 0:t.logo_url)&&r.jsx("img",{src:t.logo_url,alt:"Logo preview",className:"h-8 w-auto rounded-sm border border-slate-200 bg-white"}),r.jsxs("span",{className:"text-xs text-slate-500",children:["Logos & PDF artwork are managed in the"," ",r.jsx("span",{className:"font-medium",children:"PDF Header / Footer"})," tab."]})]}),r.jsx(Te,{type:"submit",disabled:l,className:"min-w-[140px]",children:l?"Saving":"Save branding"})]})]})}),r.jsxs(us,{value:"pdf",className:"space-y-6",children:[r.jsxs("form",{onSubmit:H,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Qe,{className:"text-xs font-medium text-slate-600",children:"Application logo (sidebar / topbar)"}),r.jsxs("div",{className:"border border-dashed border-slate-300 rounded-2xl p-3 flex flex-col items-center gap-2",children:[(t==null?void 0:t.logo_url)&&r.jsx("img",{src:t.logo_url,alt:"Logo",className:"h-8 w-auto rounded-sm border border-slate-200 bg-white mb-1"}),r.jsxs("label",{className:"w-full",children:[r.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs cursor-pointer",children:[r.jsx(Af,{className:"h-4 w-4"}),r.jsx("span",{children:"Choose logo (PNG / JPG)"})]}),r.jsx(Se,{type:"file",accept:"image/*",className:"hidden",onChange:q=>{var G;return h(((G=q.target.files)==null?void 0:G[0])||null)}})]}),u&&r.jsx("p",{className:"text-[11px] text-slate-500 truncate w-full text-center",children:u.name})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Qe,{className:"text-xs font-medium text-slate-600",children:"Login-page logo (optional)"}),r.jsxs("div",{className:"border border-dashed border-slate-300 rounded-2xl p-3 flex flex-col items-center gap-2",children:[(t==null?void 0:t.login_logo_url)&&r.jsx("img",{src:t.login_logo_url,alt:"Login logo",className:"h-8 w-auto rounded-sm border border-slate-200 bg-white mb-1"}),r.jsxs("label",{className:"w-full",children:[r.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs cursor-pointer",children:[r.jsx(Af,{className:"h-4 w-4"}),r.jsx("span",{children:"Choose login logo"})]}),r.jsx(Se,{type:"file",accept:"image/*",className:"hidden",onChange:q=>{var G;return x(((G=q.target.files)==null?void 0:G[0])||null)}})]}),f&&r.jsx("p",{className:"text-[11px] text-slate-500 truncate w-full text-center",children:f.name})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Qe,{className:"text-xs font-medium text-slate-600",children:"Favicon (browser tab icon)"}),r.jsxs("div",{className:"border border-dashed border-slate-300 rounded-2xl p-3 flex flex-col items-center gap-2",children:[(t==null?void 0:t.favicon_url)&&r.jsx("img",{src:t.favicon_url,alt:"Favicon",className:"h-6 w-6 rounded-sm border border-slate-200 bg-white mb-1"}),r.jsxs("label",{className:"w-full",children:[r.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs cursor-pointer",children:[r.jsx(Af,{className:"h-4 w-4"}),r.jsx("span",{children:"Choose favicon (PNG / ICO)"})]}),r.jsx(Se,{type:"file",accept:"image/*,.ico",className:"hidden",onChange:q=>{var G;return v(((G=q.target.files)==null?void 0:G[0])||null)}})]}),b&&r.jsx("p",{className:"text-[11px] text-slate-500 truncate w-full text-center",children:b.name})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Qe,{className:"text-xs font-medium text-slate-600",children:"PDF header template (all documents)"}),r.jsxs("div",{className:"border border-dashed border-slate-300 rounded-2xl p-3 flex flex-col items-center gap-2",children:[(t==null?void 0:t.pdf_header_url)&&r.jsx("img",{src:t.pdf_header_url,alt:"PDF header",className:"h-12 w-auto rounded-sm border border-slate-200 bg-white mb-1"}),r.jsxs("label",{className:"w-full",children:[r.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs cursor-pointer",children:[r.jsx(Af,{className:"h-4 w-4"}),r.jsx("span",{children:"Choose header image"})]}),r.jsx(Se,{type:"file",accept:"image/*",className:"hidden",onChange:q=>{var G;return _(((G=q.target.files)==null?void 0:G[0])||null)}})]}),w&&r.jsx("p",{className:"text-[11px] text-slate-500 truncate w-full text-center",children:w.name})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Qe,{className:"text-xs font-medium text-slate-600",children:"PDF footer template (all documents)"}),r.jsxs("div",{className:"border border-dashed border-slate-300 rounded-2xl p-3 flex flex-col items-center gap-2",children:[(t==null?void 0:t.pdf_footer_url)&&r.jsx("img",{src:t.pdf_footer_url,alt:"PDF footer",className:"h-12 w-auto rounded-sm border border-slate-200 bg-white mb-1"}),r.jsxs("label",{className:"w-full",children:[r.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs cursor-pointer",children:[r.jsx(Af,{className:"h-4 w-4"}),r.jsx("span",{children:"Choose footer image"})]}),r.jsx(Se,{type:"file",accept:"image/*",className:"hidden",onChange:q=>{var G;return k(((G=q.target.files)==null?void 0:G[0])||null)}})]}),S&&r.jsx("p",{className:"text-[11px] text-slate-500 truncate w-full text-center",children:S.name})]})]})]}),r.jsxs("div",{className:"flex items-center justify-between pt-2",children:[r.jsx("p",{className:"text-[11px] text-slate-500 max-w-xl",children:"These logo/header/footer templates will be applied to all PDF downloads (EMR, discharge summary, lab reports, invoices, etc.) to keep NABH-compliant formatting."}),r.jsx(Te,{type:"submit",disabled:c,className:"min-w-[160px]",children:c?"Uploading":"Upload artwork"})]})]}),r.jsxs("form",{onSubmit:$,className:"space-y-4",children:[r.jsx("div",{className:"border-t border-slate-100 pt-4"}),r.jsxs("div",{className:"space-y-3",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:"PDF layout behaviour"}),r.jsx("p",{className:"text-xs text-slate-500",children:'Control reserved space for header/footer and whether to show "Page X of Y" in the footer.'}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{className:"text-xs text-slate-600",children:"Header height (mm)"}),r.jsx(Se,{type:"number",min:0,value:a.pdf_header_height_mm===""?"":a.pdf_header_height_mm,onChange:M("pdf_header_height_mm"),placeholder:"Auto"}),r.jsx("p",{className:"text-[11px] text-slate-400",children:"Leave blank to auto-calc based on header image."})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{className:"text-xs text-slate-600",children:"Footer height (mm)"}),r.jsx(Se,{type:"number",min:0,value:a.pdf_footer_height_mm===""?"":a.pdf_footer_height_mm,onChange:M("pdf_footer_height_mm"),placeholder:"Auto"}),r.jsx("p",{className:"text-[11px] text-slate-400",children:"Leave blank to auto-calc based on footer image."})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{className:"text-xs text-slate-600",children:"Page number in footer"}),r.jsxs("label",{className:"inline-flex items-center gap-2 text-xs text-slate-600",children:[r.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300",checked:!!a.pdf_show_page_number,onChange:B("pdf_show_page_number")}),r.jsx("span",{children:'Show "Page X of Y" on all PDFs'})]})]})]})]}),r.jsx("div",{className:"flex items-center justify-end pt-1",children:r.jsx(Te,{type:"submit",disabled:l,className:"min-w-[160px]",children:l?"Saving":"Save PDF settings"})})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Qe,{className:"text-xs font-medium text-slate-600",children:"Upload Letterhead (PDF / JPG / PNG / DOCX)"}),r.jsxs("div",{className:"border border-dashed p-3 rounded-xl space-y-3",children:[(t==null?void 0:t.letterhead_url)&&r.jsxs("p",{className:"text-xs text-slate-600",children:["Current file:"," ",r.jsx("span",{className:"font-medium",children:t.letterhead_url.split("/").pop()})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-xs text-slate-600",children:[r.jsxs("label",{className:"inline-flex items-center gap-1",children:[r.jsx("input",{type:"radio",className:"h-3 w-3",value:"background",checked:P==="background",onChange:q=>O(q.target.value)}),r.jsx("span",{children:"Full-page background"})]}),r.jsxs("label",{className:"inline-flex items-center gap-1",children:[r.jsx("input",{type:"radio",className:"h-3 w-3",value:"none",checked:P==="none",onChange:q=>O(q.target.value)}),r.jsx("span",{children:"Disable letterhead background (use header/footer only)"})]})]}),r.jsx(Se,{type:"file",accept:"image/*,application/pdf,.doc,.docx",onChange:q=>{var G;return T(((G=q.target.files)==null?void 0:G[0])||null)}}),A&&r.jsx("p",{className:"text-xs mt-1 text-slate-600",children:A.name}),r.jsx(Te,{disabled:!A,onClick:z,className:"mt-2",children:"Upload Letterhead"})]})]})]})]})})]})]})}const KR=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];function J8e(){const[t,s]=y.useState(null),[n,a]=y.useState("0"),[i,l]=y.useState("09:00"),[o,c]=y.useState("13:00"),[d,u]=y.useState("15"),[h,f]=y.useState([]),[x,b]=y.useState(!1),[v,w]=y.useState(!1),[_,S]=y.useState(null),k=y.useCallback(I=>{s(I)},[]),A=y.useCallback(async()=>{if(!t){f([]);return}try{b(!0);const{data:I}=await Due(t);f(I||[])}catch(I){console.error(I),se.error("Failed to load schedules")}finally{b(!1)}},[t]);y.useEffect(()=>{A()},[A]);const T=async I=>{var B,L,F;if((B=I==null?void 0:I.preventDefault)==null||B.call(I),!t){se.error("Select doctor first");return}const M=Number(n);if(h.some(V=>V.weekday===M)){se.error("Schedule for this weekday already exists. Edit / delete existing slot instead.");return}try{w(!0),await Oue({doctor_user_id:t,weekday:M,start_time:i,end_time:o,slot_minutes:Number(d)||15}),se.success("Schedule saved"),A()}catch(V){console.error(V),se.error(((F=(L=V==null?void 0:V.response)==null?void 0:L.data)==null?void 0:F.detail)||"Failed to save schedule")}finally{w(!1)}},P=async I=>{var M,B;if(window.confirm("Delete this schedule slot?"))try{S(I),await Rue(I),se.success("Schedule deleted"),f(L=>L.filter(F=>F.id!==I))}catch(L){console.error(L),se.error(((B=(M=L==null?void 0:L.response)==null?void 0:M.data)==null?void 0:B.detail)||"Failed to delete schedule")}finally{S(null)}},O=!!t,D=y.useMemo(()=>`${h.length} weekday slot${h.length===1?"":"s"} configured`,[h.length]);return r.jsx("div",{className:"min-h-[calc(100vh-5rem)] bg-slate-50 px-4 py-6 md:px-6",children:r.jsxs("div",{className:"mx-auto max-w-5xl space-y-6",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.2em] text-sky-700",children:"OPD Scheduling"}),r.jsx("h1",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"Doctor OPD Schedules"}),r.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Configure weekday-wise OPD timings for each doctor. Duplicate weekday entries are blocked to keep the roster clean."})]}),r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsx(rt,{className:"border-b border-slate-100 pb-4",children:r.jsxs(ot,{className:"flex items-center justify-between text-base font-semibold text-slate-900",children:[r.jsx("span",{children:"Schedule Setup"}),r.jsx("span",{className:"text-xs font-normal text-slate-500",children:D})]})}),r.jsxs(He,{className:"pt-4 space-y-4",children:[r.jsxs("div",{className:"grid gap-4 md:grid-cols-[2fr,1.5fr]",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:"Doctor"}),r.jsx(wl,{value:t,onChange:k}),!t&&r.jsx("p",{className:"mt-1 text-[11px] text-amber-600",children:"Select a doctor to view and update OPD schedules."})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(ar,{className:"h-3 w-3"}),"Weekday"]}),r.jsxs(Fs,{value:n,onValueChange:a,children:[r.jsx(Ds,{className:"h-9 text-sm",children:r.jsx($s,{placeholder:"Select weekday"})}),r.jsx(Os,{children:KR.map((I,M)=>r.jsx(zt,{value:String(M),children:I},M))})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(Ba,{className:"h-3 w-3"}),"Start"]}),r.jsx(Se,{type:"time",value:i,onChange:I=>l(I.target.value),className:"h-9 text-sm"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(Ba,{className:"h-3 w-3"}),"End"]}),r.jsx(Se,{type:"time",value:o,onChange:I=>c(I.target.value),className:"h-9 text-sm"})]})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-[1fr,auto] md:items-end",children:[r.jsxs("div",{className:"space-y-1.5 max-w-xs",children:[r.jsx("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:"Slot duration (minutes)"}),r.jsx(Se,{type:"number",min:5,step:5,value:d,onChange:I=>u(I.target.value),className:"h-9 text-sm"}),r.jsx("p",{className:"mt-1 text-[11px] text-slate-400",children:"Used when generating appointment slots (e.g., 10 / 15 / 20)."})]}),r.jsx("div",{className:"flex justify-end",children:r.jsx(Te,{type:"button",className:"px-5",disabled:!O||v,onClick:T,children:v?"Saving":"Add Weekday Slot"})})]})]})]}),r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsx(rt,{className:"border-b border-slate-100 pb-3",children:r.jsx(ot,{className:"text-sm font-semibold text-slate-900",children:"Existing Schedules"})}),r.jsxs(He,{className:"pt-4",children:[x&&r.jsx("div",{className:"space-y-2",children:[1,2,3].map(I=>r.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-100 bg-slate-50 px-3 py-3",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(We,{className:"h-4 w-40"}),r.jsx(We,{className:"h-3 w-24"})]}),r.jsx(We,{className:"h-8 w-8 rounded-full"})]},I))}),!x&&(!h||h.length===0)&&r.jsx("p",{className:"py-6 text-sm text-slate-500",children:"No schedules configured yet for this doctor."}),!x&&h&&h.length>0&&r.jsx("div",{className:"grid gap-2 sm:grid-cols-2",children:h.map(I=>{var M,B;return r.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-3 text-sm shadow-sm",children:[r.jsxs("div",{className:"space-y-0.5",children:[r.jsx("div",{className:"flex flex-wrap items-center gap-1.5",children:r.jsxs("span",{className:"font-semibold text-slate-900",children:[KR[I.weekday]," "," ",(M=I.start_time)==null?void 0:M.slice(0,5),"",(B=I.end_time)==null?void 0:B.slice(0,5)]})}),r.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-slate-500",children:[r.jsxs(Ze,{variant:"outline",className:"border-slate-200 bg-slate-50 px-2 py-0.5 text-[11px]",children:["Slot: ",I.slot_minutes||15," min"]}),I.location&&r.jsx(Ze,{variant:"outline",className:"border-slate-200 bg-slate-50 px-2 py-0.5 text-[11px]",children:I.location})]})]}),r.jsx(Te,{variant:"ghost",size:"icon",className:"h-8 w-8 text-slate-400 hover:text-rose-600",onClick:()=>P(I.id),disabled:_===I.id,children:r.jsx(wr,{className:"h-4 w-4"})})]},I.id)})})]})]})]})})}var eLe="Separator",YR="horizontal",tLe=["horizontal","vertical"],zK=y.forwardRef((t,s)=>{const{decorative:n,orientation:a=YR,...i}=t,l=sLe(a)?a:YR,c=n?{role:"none"}:{"aria-orientation":l==="vertical"?l:void 0,role:"separator"};return r.jsx(rs.div,{"data-orientation":l,...c,...i,ref:s})});zK.displayName=eLe;function sLe(t){return tLe.includes(t)}var UK=zK;const wb=y.forwardRef(({className:t,orientation:s="horizontal",decorative:n=!0,...a},i)=>r.jsx(UK,{ref:i,decorative:n,orientation:s,className:Ft("shrink-0 bg-border",s==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...a}));wb.displayName=UK.displayName;const nLe=()=>new Date().toISOString().slice(0,10);function rLe(){const[t,s]=y.useState(nLe()),[n,a]=y.useState(null),[i,l]=y.useState(null),[o,c]=y.useState(null),[d,u]=y.useState("Consultation"),[h,f]=y.useState([]),[x,b]=y.useState(""),[v,w]=y.useState(!1),[_,S]=y.useState([]),[k,A]=y.useState(!1),T=(M,B)=>{a(M),l((B==null?void 0:B.department_id)||null),b("")},P=M=>{c(M)};y.useEffect(()=>{(async()=>{if(!n||!t){f([]),S([]);return}try{w(!0);const{data:B}=await lI({doctorUserId:Number(n),date:t,detailed:!0}),L=Array.isArray(B)?B:(B==null?void 0:B.slots)||[];f(L)}catch{f([])}finally{w(!1)}try{A(!0);const{data:B}=await oI({date:t,doctor_id:Number(n)});S(B||[])}catch{S([])}finally{A(!1)}})()},[n,t]);const O=y.useMemo(()=>h.filter(M=>M.status==="free"||!M.status),[h]),D=y.useMemo(()=>{var F;const M=_.length,B=O.length,L=x||((F=O[0])!=null&&F.start?`Earliest ${O[0].start}`:"Not selected");return{total:M,free:B,selected:L}},[_,O,x]),I=async M=>{if(M.preventDefault(),!o){se.error("Please select a patient");return}if(!n||!i){se.error("Please select department & doctor");return}if(!x){se.error("Please choose a time slot");return}try{await Lue({patient_id:o,department_id:i,doctor_user_id:n,date:t,slot_start:x,purpose:d||"Consultation"}),se.success("Appointment booked"),b("");const{data:B}=await oI({date:t,doctor_id:Number(n)});S(B||[]);const{data:L}=await lI({doctorUserId:Number(n),date:t,detailed:!0}),F=Array.isArray(L)?L:(L==null?void 0:L.slots)||[];f(F)}catch{}};return r.jsx("div",{className:"h-full w-full bg-[#eee] rounded",children:r.jsxs("div",{className:"mx-auto flex max-w-6xl flex-col gap-4 px-3 py-4 sm:px-4 lg:px-6 lg:py-6",children:[r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white px-3 py-1 text-xs text-slate-500 shadow-sm",children:[r.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-500 animate-pulse"}),r.jsx("span",{children:"Live OPD  Booking & Queue"})]}),r.jsx("h1",{className:"text-xl font-semibold text-slate-900 sm:text-2xl",children:"OPD Appointment Booking"}),r.jsx("p",{className:"text-xs text-slate-500 sm:text-sm",children:"Quickly book patient appointments, view doctor schedule, and monitor today's queue."})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:justify-end",children:[r.jsxs(Ze,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-white px-3 py-1 text-[11px] font-normal text-slate-700 shadow-sm",children:[r.jsx(ar,{className:"h-3 w-3"}),t]}),n&&r.jsxs(Ze,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-white px-3 py-1 text-[11px] font-normal text-slate-700 shadow-sm",children:[r.jsx(Es,{className:"h-3 w-3"}),"Doctor ID ",n]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-3",children:[r.jsx(Ve,{className:"rounded-2xl border-slate-200 shadow-sm",children:r.jsxs(He,{className:"flex items-center justify-between gap-3 py-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Today's appointments"}),r.jsx("p",{className:"text-xl font-semibold text-slate-900",children:D.total})]}),r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-2",children:r.jsx(Yp,{className:"h-5 w-5 text-slate-700"})})]})}),r.jsx(Ve,{className:"rounded-2xl border-slate-200 shadow-sm",children:r.jsxs(He,{className:"flex items-center justify-between gap-3 py-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Free slots"}),r.jsx("p",{className:"text-xl font-semibold text-slate-900",children:D.free})]}),r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-2",children:r.jsx(Ba,{className:"h-5 w-5 text-slate-700"})})]})}),r.jsx(Ve,{className:"rounded-2xl border-slate-200 shadow-sm",children:r.jsxs(He,{className:"flex items-center justify-between gap-3 py-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Selected time"}),r.jsx("p",{className:"text-sm font-semibold text-slate-900",children:D.selected})]}),r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-2",children:r.jsx(Vs,{className:"h-5 w-5 text-slate-700"})})]})})]}),r.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.6fr),minmax(0,1.4fr)] lg:gap-6",children:[r.jsx(at.div,{layout:!0,initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.18},children:r.jsxs(Ve,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsxs(rt,{className:"pb-3",children:[r.jsxs(ot,{className:"flex items-center gap-2 text-base font-semibold text-slate-900 sm:text-lg",children:[r.jsx("span",{className:"inline-flex h-7 w-7 items-center justify-center rounded-2xl bg-slate-900 text-xs text-white",children:"1"}),"Book a new appointment"]}),r.jsx(vr,{className:"text-xs text-slate-500 sm:text-sm",children:"Choose patient, doctor, date and slot. All fields are optimized for quick keyboard + mouse workflow."})]}),r.jsx(He,{className:"space-y-4",children:r.jsxs("form",{onSubmit:I,className:"space-y-4",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/60 p-3 sm:p-4",children:[r.jsxs("div",{className:"flex items-center gap-2 pb-2",children:[r.jsx("span",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-white text-[11px] font-semibold text-slate-900 shadow-sm",children:r.jsx(Yp,{className:"h-3 w-3"})}),r.jsx("span",{className:"text-xs font-medium uppercase tracking-wide text-slate-500",children:"Patient details"})]}),r.jsx("div",{className:"space-y-2 sm:space-y-3",children:r.jsx(Av,{value:o,onChange:P})})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/60 p-3 sm:p-4",children:[r.jsxs("div",{className:"flex items-center gap-2 pb-2",children:[r.jsx("span",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-white text-[11px] font-semibold text-slate-900 shadow-sm",children:r.jsx(Es,{className:"h-3 w-3"})}),r.jsx("span",{className:"text-xs font-medium uppercase tracking-wide text-slate-500",children:"Department & doctor"})]}),r.jsx(wl,{value:n,onChange:T})]})]}),r.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Date"}),r.jsx(Se,{type:"date",value:t,onChange:M=>s(M.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Purpose"}),r.jsx(Se,{value:d,onChange:M=>u(M.target.value),placeholder:"Consultation / Review / Procedure",className:"h-9 rounded-2xl border-slate-200 text-sm"})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Time slot"}),r.jsxs("span",{className:"text-[11px] text-slate-400",children:[O.length," free slot(s) available"]})]}),v?r.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from({length:5}).map((M,B)=>r.jsx(We,{className:"h-7 w-16 rounded-full bg-slate-100"},B))}):O.length===0?r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-3 py-2 text-xs text-amber-800",children:"No free slots for this date / doctor. Choose another date or doctor."}):r.jsx(Or,{className:"max-h-40 rounded-2xl border border-slate-100 bg-slate-50/80 px-2 py-2",children:r.jsx("div",{className:"flex flex-wrap gap-2",children:O.map(M=>r.jsxs("button",{type:"button",onClick:()=>b(M.start),className:["inline-flex items-center gap-1 rounded-full border px-3 py-1 text-[11px] font-medium transition",x===M.start?"border-slate-900 bg-slate-900 text-white":"border-slate-200 bg-white text-slate-700 hover:bg-slate-100"].join(" "),children:[r.jsx(Ba,{className:"h-3 w-3"}),M.start,"",M.end]},M.start))})})]}),r.jsx(wb,{className:"my-1"}),r.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[r.jsx("p",{className:"text-[11px] text-slate-400",children:"Booking will immediately reflect in OPD queue & doctor view."}),r.jsx(Te,{type:"submit",className:"h-9 rounded-2xl bg-slate-900 px-4 text-xs font-semibold uppercase tracking-wide text-white hover:bg-slate-800 disabled:opacity-50",disabled:!o||!n||!x,children:"Book appointment"})]})]})})]})}),r.jsx(at.div,{layout:!0,initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2,delay:.05},className:"lg:sticky lg:top-24",children:r.jsxs(Ve,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsx(rt,{className:"pb-3",children:r.jsxs("div",{className:"flex items-start justify-between gap-2",children:[r.jsxs("div",{children:[r.jsxs(ot,{className:"flex items-center gap-2 text-base font-semibold text-slate-900 sm:text-lg",children:[r.jsx(ar,{className:"h-4 w-4 text-slate-600"}),"Appointments for the day"]}),r.jsx(vr,{className:"text-xs text-slate-500 sm:text-sm",children:"See all appointments for the selected doctor and date."})]}),(k||v)&&r.jsxs(Ze,{variant:"outline",className:"inline-flex items-center gap-1 rounded-full border-slate-200 bg-slate-50 px-2 py-1 text-[11px] text-slate-500",children:[r.jsx(ns,{className:"h-3 w-3 animate-spin"}),"Syncing"]})]})}),r.jsxs(He,{className:"pb-3",children:[r.jsxs("div",{className:"mb-2 flex items-center justify-between text-[11px] text-slate-400",children:[r.jsxs("span",{children:[t," ",n?` Doctor ID ${n}`:""]}),r.jsxs("span",{children:[_.length," appointment(s)"]})]}),k?r.jsx("div",{className:"space-y-2",children:Array.from({length:4}).map((M,B)=>r.jsx(We,{className:"h-14 w-full rounded-2xl bg-slate-100"},B))}):_.length===0?r.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 px-3 py-4 text-center text-xs text-slate-500",children:["No appointments for this filter yet.",r.jsx("div",{className:"mt-1 text-[11px] text-slate-400",children:"Start by booking a new appointment on the left."})]}):r.jsx(Or,{className:"max-h-[380px] pr-1",children:r.jsx("div",{className:"space-y-2 text-sm",children:r.jsx(vl,{initial:!1,children:_.map(M=>r.jsxs(at.div,{initial:{opacity:0,y:4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},transition:{duration:.15},className:"flex flex-col gap-1 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-800 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"space-y-0.5",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-1",children:[r.jsxs("span",{className:"rounded-full bg-white px-2 py-0.5 text-[11px] font-medium text-slate-800 border border-slate-200",children:[M.slot_start,"",M.slot_end]}),r.jsx("span",{className:"font-medium",children:M.patient_name}),r.jsxs("span",{className:"text-[11px] text-slate-500",children:["(UHID ",M.uhid,")"]})]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:[M.department_name,"  ",M.doctor_name," ",r.jsx("span",{className:"ml-1 inline-flex items-center rounded-full bg-slate-900 px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide text-white",children:M.status})]})]}),r.jsx("div",{className:"text-[11px] text-slate-500 sm:text-right",children:M.vitals_registered?r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2 py-0.5 text-[10px] font-medium text-emerald-700 border border-emerald-100",children:[r.jsx(Vs,{className:"h-3 w-3"}),"Vitals done"]}):r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-100 px-2 py-0.5 text-[10px] font-medium text-slate-600 border border-slate-200",children:[r.jsx(Vs,{className:"h-3 w-3"}),"No vitals yet"]})})]},M.id))})})})]})]})})]})]})})}const aLe=()=>new Date().toISOString().slice(0,10),iLe={booked:"Booked",checked_in:"Checked-in",in_progress:"In progress",completed:"Completed",no_show:"No-show",cancelled:"Cancelled"},lLe={booked:"bg-slate-100 text-slate-700",checked_in:"bg-blue-100 text-blue-700",in_progress:"bg-amber-100 text-amber-700",completed:"bg-emerald-100 text-emerald-700",no_show:"bg-rose-100 text-rose-700",cancelled:"bg-slate-200 text-slate-600"};function oLe(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-IN",{weekday:"short",day:"2-digit",month:"short",year:"numeric"})}catch{return t}}function cLe(t,s){if(!(t!=null&&t.time)||!["booked","checked_in","in_progress"].includes(t.status))return null;try{const n=new Date;if(!(s===n.toISOString().slice(0,10)))return null;const i=new Date(`${s}T${t.time}:00`),l=n.getTime()-i.getTime(),o=Math.floor(l/(1e3*60));if(o<=0)return"0 min";if(o<60)return`${o} min`;const c=Math.floor(o/60),d=o%60;return c>=5?`${c} hrs+`:d===0?`${c} hr${c>1?"s":""}`:`${c}h ${d}m`}catch{return null}}const dLe={initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.18}};function uLe(){const{user:t}=cr()||{},[s,n]=y.useState(null),[a,i]=y.useState(aLe()),[l,o]=y.useState([]),[c,d]=y.useState(!1),[u,h]=y.useState("active"),[f,x]=y.useState(""),b=Va();y.useEffect(()=>{t!=null&&t.is_doctor&&!s&&n(t.id)},[t,s]);const v=!!(s&&a),w=y.useCallback(async()=>{if(!s||!a){o([]);return}try{d(!0);const O={doctor_user_id:Number(s),for_date:a};t!=null&&t.department_id&&(O.department_id=t.department_id);const{data:D}=await $B(O);o(D||[])}catch(O){console.error(O),o([])}finally{d(!1)}},[s,a,t]);y.useEffect(()=>{w()},[w]);const _=async(O,D,I={})=>{try{const{data:M}=await Bue(O.appointment_id,D);se.success(`Status updated to ${M.status.toUpperCase()}`),I.goToVisit&&M.visit_id?b(`/opd/visit/${M.visit_id}`):w()}catch{}},S=O=>{n(O)},k=y.useMemo(()=>{const O={total:l.length,booked:0,checked_in:0,in_progress:0,completed:0,no_show:0,cancelled:0};for(const D of l)O[D.status]!==void 0&&(O[D.status]+=1);return O},[l]),A=y.useMemo(()=>u==="all"?l:u==="active"?l.filter(O=>["booked","checked_in","in_progress"].includes(O.status)):l.filter(O=>O.status===u),[l,u]),T=y.useMemo(()=>{const O=A;if(!f.trim())return O;const D=f.toLowerCase();return O.filter(I=>{var F,V,$;const M=((F=I.patient)==null?void 0:F.name)||"",B=((V=I.patient)==null?void 0:V.uhid)||"",L=(($=I.patient)==null?void 0:$.phone)||"";return M.toLowerCase().includes(D)||String(B).toLowerCase().includes(D)||String(L).toLowerCase().includes(D)})},[A,f]),P=k.booked+k.checked_in+k.in_progress;return r.jsxs("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-3 md:px-6 md:py-6",children:[r.jsxs(at.div,{...dLe,className:"mx-auto flex max-w-5xl flex-col gap-2 rounded-2xl border border-slate-200 bg-white/90 px-3 py-3 shadow-sm md:px-4 md:py-4",children:[r.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"relative flex h-2.5 w-2.5",children:[r.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-emerald-500 opacity-75"}),r.jsx("span",{className:"relative inline-flex h-2.5 w-2.5 rounded-full bg-emerald-500"})]}),r.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-emerald-700",children:"Live OPD Queue"})]}),r.jsx("h1",{className:"mt-1 text-lg font-semibold text-slate-900 md:text-2xl",children:"OPD Queue Management"}),r.jsx("p",{className:"mt-1 text-xs text-slate-500 md:text-sm",children:"Track today's appointments, check-in patients and start / complete visits in real-time."})]}),r.jsxs("div",{className:"flex items-end justify-between gap-3 md:flex-col md:items-end md:text-right",children:[r.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-slate-900 px-3 py-1 text-[11px] text-slate-50",children:[r.jsx(Vs,{className:"h-3 w-3"}),r.jsx("span",{children:"Doctor OPD"})]}),r.jsxs("div",{className:"flex items-center gap-1 text-[11px] text-slate-500",children:[r.jsx(ar,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:oLe(a)})]})]})]}),r.jsxs("div",{className:"mt-2 grid gap-2 text-[11px] md:grid-cols-4",children:[r.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-slate-100 bg-slate-900 px-3 py-2 text-slate-50 md:col-span-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Uo,{className:"h-4 w-4"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] uppercase tracking-wide text-slate-200/80",children:"Total appointments"}),r.jsx("div",{className:"text-sm font-semibold",children:k.total})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("div",{className:"text-[10px] text-slate-200/80",children:"Active (booked / checked-in / in progress)"}),r.jsx("div",{className:"text-sm font-semibold text-emerald-300",children:P})]})]}),r.jsx(Vf,{label:"Booked",value:k.booked,tone:"slate"}),r.jsx(Vf,{label:"Checked-in",value:k.checked_in,tone:"blue"}),r.jsx(Vf,{label:"In progress",value:k.in_progress,tone:"amber"}),r.jsx(Vf,{label:"Completed",value:k.completed,tone:"emerald"}),r.jsx(Vf,{label:"No-show",value:k.no_show,tone:"rose"})]})]}),r.jsx("div",{className:"mx-auto mt-4 max-w-5xl",children:r.jsxs(Ve,{className:"rounded-3xl border-slate-200 bg-white/95 shadow-sm",children:[r.jsxs(rt,{className:"border-b border-slate-100 pb-4",children:[r.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-end md:justify-between",children:[r.jsxs("div",{className:"grid w-full gap-3 md:grid-cols-[2fr,1.1fr] md:items-end",children:[r.jsxs("div",{children:[r.jsx(wl,{value:s,onChange:S,autoSelectCurrentDoctor:!0}),(t==null?void 0:t.is_doctor)&&r.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Defaulted to your OPD queue."})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(ar,{className:"h-3 w-3"}),"Date"]}),r.jsx(Se,{type:"date",value:a,onChange:O=>i(O.target.value),className:"h-9 rounded-xl border-slate-200"})]})]}),r.jsx("div",{className:"flex w-full flex-col gap-2 md:w-auto md:items-end",children:r.jsxs("div",{className:"flex w-full items-center gap-2 md:w-auto",children:[r.jsxs("div",{className:"flex flex-1 items-center rounded-full border border-slate-200 bg-slate-50 px-2 text-[11px] md:w-56",children:[r.jsx(es,{className:"mr-1 h-3.5 w-3.5 text-slate-400"}),r.jsx("input",{className:"h-7 flex-1 bg-transparent text-[11px] text-slate-800 outline-none placeholder:text-slate-400",placeholder:"Search name / UHID / phone",value:f,onChange:O=>x(O.target.value)})]}),r.jsxs(Te,{type:"button",size:"sm",variant:"outline",className:"gap-1 rounded-full border-slate-300",onClick:w,disabled:c||!v,children:[r.jsx(_u,{className:"h-3 w-3"}),r.jsx("span",{className:"text-[11px]",children:"Refresh"})]})]})})]}),r.jsx("div",{className:"mt-4 flex flex-wrap gap-1.5 text-xs",children:[{key:"active",label:"Active (Booked / Checked-in / In progress)"},{key:"all",label:"All"},{key:"booked",label:"Booked"},{key:"checked_in",label:"Checked-in"},{key:"in_progress",label:"In progress"},{key:"completed",label:"Completed"},{key:"no_show",label:"No-show"},{key:"cancelled",label:"Cancelled"}].map(O=>r.jsx("button",{type:"button",onClick:()=>h(O.key),className:["rounded-full border px-3 py-1 text-[11px] transition",u===O.key?"border-slate-900 bg-slate-900 text-white shadow-sm":"border-slate-200 bg-slate-50 text-slate-600 hover:bg-white"].join(" "),children:O.label},O.key))})]}),r.jsxs(He,{className:"pt-4",children:[!v&&r.jsxs("div",{className:"flex flex-col items-center gap-2 py-10 text-center text-sm text-slate-500",children:[r.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-100",children:r.jsx(Es,{className:"h-5 w-5 text-slate-500"})}),r.jsx("div",{className:"font-medium text-slate-700",children:"Select doctor & date to view queue"}),r.jsx("p",{className:"max-w-md text-xs text-slate-500",children:"Choose a consultant and date above to see the live OPD queue, update statuses and open visits."})]}),v&&c&&r.jsx("div",{className:"space-y-3 py-4",children:[1,2,3].map(O=>r.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-100 bg-slate-50/80 px-3 py-3",children:[r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsx(We,{className:"h-4 w-40"}),r.jsx(We,{className:"h-3 w-64"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(We,{className:"h-7 w-16 rounded-full"}),r.jsx(We,{className:"h-7 w-20 rounded-full"})]})]},O))}),v&&!c&&T.length===0&&r.jsxs("div",{className:"flex flex-col items-center gap-2 py-10 text-center text-sm text-slate-500",children:[r.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-100",children:r.jsx(Ba,{className:"h-5 w-5 text-slate-500"})}),r.jsx("div",{className:"font-medium text-slate-700",children:"No appointments for this doctor / date"}),r.jsx("p",{className:"max-w-md text-xs text-slate-500",children:"Try changing the status filter above, clearing the search, or pick a different date to see previous or upcoming OPD queues."})]}),v&&!c&&T.length>0&&r.jsx("div",{className:"space-y-2 pt-1 text-sm",children:T.map(O=>{var M,B,L;const D=lLe[O.status]||"bg-slate-100 text-slate-700",I=cLe(O,a);return r.jsxs(at.div,{initial:{opacity:0,y:4},animate:{opacity:1,y:0},transition:{duration:.12},className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[r.jsx("span",{className:"rounded-full bg-slate-900 px-2 py-0.5 text-[10px] font-semibold text-slate-50",children:O.time}),r.jsx("span",{className:"mx-0.5 text-slate-400",children:""}),r.jsxs("span",{className:"flex items-center gap-1 text-sm font-semibold text-slate-900",children:[r.jsx(rn,{className:"h-3.5 w-3.5 text-slate-500"}),((M=O.patient)==null?void 0:M.name)||""]}),r.jsx("span",{className:"mx-0.5 text-slate-400",children:""}),r.jsxs("span",{className:"text-[11px] text-slate-500",children:["UHID"," ",((B=O.patient)==null?void 0:B.uhid)||""," ",""," ",((L=O.patient)==null?void 0:L.phone)||""]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-1 text-[11px] text-slate-500",children:[r.jsx("span",{children:"Status:"}),r.jsx(Ze,{className:`border-none px-2 py-0.5 text-[11px] font-semibold uppercase ${D}`,children:iLe[O.status]||O.status}),r.jsx("span",{className:"mx-1 text-slate-300",children:""}),r.jsxs("span",{children:["Purpose:"," ",r.jsx("span",{className:"font-medium text-slate-700",children:O.visit_purpose||"Consultation"})]}),r.jsx("span",{className:"mx-1 text-slate-300",children:""}),r.jsxs("span",{className:"inline-flex items-center gap-1",children:[r.jsx(cm,{className:"h-3 w-3"}),"Vitals:"," ",r.jsx("span",{className:"font-medium",children:O.has_vitals?"Yes":"No"})]}),I&&r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mx-1 text-slate-300",children:""}),r.jsxs("span",{className:"inline-flex items-center gap-1",children:[r.jsx(Ba,{className:"h-3 w-3"}),"Waiting:"," ",r.jsx("span",{className:"font-medium",children:I})]})]})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-2 text-xs",children:[O.status==="booked"&&r.jsxs(r.Fragment,{children:[r.jsx(Te,{size:"sm",className:"rounded-full px-3 font-semibold",onClick:()=>_(O,"checked_in"),children:"Check-in"}),r.jsx(Te,{size:"sm",variant:"outline",className:"rounded-full px-3 font-semibold",onClick:()=>_(O,"no_show"),children:"Mark No-show"})]}),O.status==="checked_in"&&r.jsx(Te,{size:"sm",className:"rounded-full px-3 font-semibold",onClick:()=>_(O,"in_progress",{goToVisit:!0}),children:"Start Visit"}),O.status==="in_progress"&&r.jsx(Te,{size:"sm",className:"rounded-full px-3 font-semibold",onClick:()=>_(O,"completed"),children:"Complete Visit"}),O.visit_id&&r.jsx(Te,{size:"sm",variant:"outline",className:"rounded-full px-3 font-semibold",onClick:()=>b(`/opd/visit/${O.visit_id}`),children:"Open Visit"})]})]},O.appointment_id)})})]})]})})]})}function Vf({label:t,value:s,tone:n="slate"}){const a={slate:"bg-slate-50 text-slate-800 border-slate-200",blue:"bg-blue-50 text-blue-800 border-blue-200",amber:"bg-amber-50 text-amber-800 border-amber-200",emerald:"bg-emerald-50 text-emerald-800 border-emerald-200",rose:"bg-rose-50 text-rose-800 border-rose-200"},i=a[n]||a.slate;return r.jsxs("div",{className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-[11px] ${i}`,children:[r.jsx("span",{children:t}),r.jsx("span",{className:"text-sm font-semibold",children:s})]})}const hLe=()=>new Date().toISOString().slice(0,10);function mLe(){const[t,s]=y.useState(null),[n,a]=y.useState(hLe()),[i,l]=y.useState([]),[o,c]=y.useState(!1),[d,u]=y.useState(null),[h,f]=y.useState({height_cm:"",weight_kg:"",temp_c:"",pulse:"",resp_rate:"",spo2:"",bp_sys:"",bp_dia:"",notes:""}),[x,b]=y.useState(!1),v=async()=>{if(!t||!n){l([]);return}try{c(!0);const{data:D}=await $B({doctor_user_id:Number(t),for_date:n});l(D||[])}catch{l([])}finally{c(!1)}};y.useEffect(()=>{v()},[t,n]);const w=D=>{s(D)},_=()=>({height_cm:"",weight_kg:"",temp_c:"",pulse:"",resp_rate:"",spo2:"",bp_sys:"",bp_dia:"",notes:""}),S=D=>{u(D),f(_()),setTimeout(()=>{const I=document.getElementById("triage-vitals-form");I&&I.scrollIntoView({behavior:"smooth",block:"start"})},80)},k=async D=>{if(D.preventDefault(),!!d)try{b(!0);const I={appointment_id:d.appointment_id,height_cm:h.height_cm?Number(h.height_cm):void 0,weight_kg:h.weight_kg?Number(h.weight_kg):void 0,temp_c:h.temp_c?Number(h.temp_c):void 0,pulse:h.pulse?Number(h.pulse):void 0,resp_rate:h.resp_rate?Number(h.resp_rate):void 0,spo2:h.spo2?Number(h.spo2):void 0,bp_sys:h.bp_sys?Number(h.bp_sys):void 0,bp_dia:h.bp_dia?Number(h.bp_dia):void 0,notes:h.notes||void 0};await Vue(I),se.success("Vitals recorded"),u(null),await v()}catch{}finally{b(!1)}},A=(D,I)=>f(M=>({...M,[D]:I})),T=i.length,P=i.filter(D=>D.has_vitals).length,O=T-P;return r.jsx("div",{className:"h-full w-full bg-slate-50",children:r.jsxs("div",{className:"mx-auto flex max-w-6xl flex-col gap-4 px-3 py-4 sm:px-4 lg:px-6 lg:py-6",children:[r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white px-3 py-1 text-xs text-slate-500 shadow-sm",children:[r.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-500 animate-pulse"}),r.jsx("span",{children:"Live OPD  Triage & Vitals"})]}),r.jsx("h1",{className:"text-xl font-semibold text-slate-900 sm:text-2xl",children:"OPD Triage (Vitals)"}),r.jsx("p",{className:"text-xs text-slate-500 sm:text-sm",children:"Nursing staff can quickly capture vitals for patients waiting in the doctor's queue."})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:justify-end",children:[r.jsxs(Ze,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-white px-3 py-1 text-[11px] font-normal text-slate-700 shadow-sm",children:[r.jsx(ar,{className:"h-3 w-3"}),n]}),t&&r.jsxs(Ze,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-white px-3 py-1 text-[11px] font-normal text-slate-700 shadow-sm",children:[r.jsx(Es,{className:"h-3 w-3"}),"Doctor ID ",t]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-3",children:[r.jsx(Ve,{className:"rounded-2xl border-slate-200 shadow-sm",children:r.jsxs(He,{className:"flex items-center justify-between gap-3 py-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Queue size"}),r.jsx("p",{className:"text-xl font-semibold text-slate-900",children:T})]}),r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-2",children:r.jsx(Yp,{className:"h-5 w-5 text-slate-700"})})]})}),r.jsx(Ve,{className:"rounded-2xl border-slate-200 shadow-sm",children:r.jsxs(He,{className:"flex items-center justify-between gap-3 py-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Vitals completed"}),r.jsx("p",{className:"text-xl font-semibold text-slate-900",children:P})]}),r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-2",children:r.jsx(Vs,{className:"h-5 w-5 text-slate-700"})})]})}),r.jsx(Ve,{className:"rounded-2xl border-slate-200 shadow-sm",children:r.jsxs(He,{className:"flex items-center justify-between gap-3 py-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Pending vitals"}),r.jsx("p",{className:"text-xl font-semibold text-slate-900",children:O})]}),r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-2",children:r.jsx(cm,{className:"h-5 w-5 text-slate-700"})})]})})]}),r.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.4fr),minmax(0,1.6fr)] lg:gap-6",children:[r.jsx(at.div,{layout:!0,initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.18},children:r.jsxs(Ve,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsxs(rt,{className:"pb-3",children:[r.jsxs(ot,{className:"flex items-center gap-2 text-base font-semibold text-slate-900 sm:text-lg",children:[r.jsx("span",{className:"inline-flex h-7 w-7 items-center justify-center rounded-2xl bg-slate-900 text-xs text-white",children:"1"}),"Select doctor & view queue"]}),r.jsx(vr,{className:"text-xs text-slate-500 sm:text-sm",children:"Pick the doctor and date to load today's OPD queue for triage."})]}),r.jsxs(He,{className:"space-y-4",children:[r.jsxs("div",{className:"grid items-end gap-3 md:grid-cols-[2fr,1.3fr]",children:[r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/70 p-3 sm:p-4",children:[r.jsxs("div",{className:"flex items-center gap-2 pb-2",children:[r.jsx("span",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-white text-[11px] font-semibold text-slate-900 shadow-sm",children:r.jsx(Es,{className:"h-3 w-3"})}),r.jsx("span",{className:"text-xs font-medium uppercase tracking-wide text-slate-500",children:"Doctor"})]}),r.jsx(wl,{value:t,onChange:w})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Date"}),r.jsx(Se,{type:"date",value:n,onChange:D=>a(D.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]})]}),r.jsx(wb,{}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between text-[11px] text-slate-400",children:[r.jsx("span",{children:t?"Queue for selected doctor":"Select a doctor to load queue"}),r.jsxs("span",{children:[T," patient(s)"]})]}),o?r.jsx("div",{className:"space-y-2 mt-1",children:Array.from({length:4}).map((D,I)=>r.jsx(We,{className:"h-14 w-full rounded-2xl bg-slate-100"},I))}):i.length===0?r.jsxs("div",{className:"mt-2 rounded-2xl border border-dashed border-slate-200 bg-slate-50 px-3 py-4 text-center text-xs text-slate-500",children:["No appointments for this doctor / date.",r.jsx("div",{className:"mt-1 text-[11px] text-slate-400",children:"Use the Appointment Booking screen to add new patients."})]}):r.jsx(Or,{className:"mt-1 max-h-[380px] pr-1",children:r.jsx("div",{className:"space-y-2 text-sm",children:r.jsx(vl,{initial:!1,children:i.map(D=>r.jsxs(at.div,{initial:{opacity:0,y:4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},transition:{duration:.15},className:"flex flex-col gap-2 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-800 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"space-y-0.5",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-1",children:[r.jsx("span",{className:"rounded-full bg-white px-2 py-0.5 text-[11px] font-medium text-slate-800 border border-slate-200",children:D.time}),r.jsx("span",{className:"font-medium",children:D.patient.name}),r.jsxs("span",{className:"text-[11px] text-slate-500",children:["(UHID ",D.patient.uhid,")"]})]}),r.jsxs("div",{className:"text-[11px] text-slate-500 flex flex-wrap items-center gap-2",children:[r.jsx("span",{children:"Vitals:"}),D.has_vitals?r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2 py-0.5 text-[10px] font-medium text-emerald-700 border border-emerald-100",children:[r.jsx(Vs,{className:"h-3 w-3"}),"Already recorded"]}):r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-100 px-2 py-0.5 text-[10px] font-medium text-slate-600 border border-slate-200",children:[r.jsx(Vs,{className:"h-3 w-3"}),"Not recorded"]})]})]}),r.jsx("div",{className:"flex items-center justify-end",children:r.jsx(Te,{type:"button",variant:D.has_vitals?"outline":"default",size:"sm",className:`rounded-2xl text-[11px] px-3 ${D.has_vitals?"bg-white text-slate-800 border-slate-300":"bg-slate-900 text-white hover:bg-slate-800"}`,onClick:()=>S(D),children:"Record vitals"})})]},D.appointment_id))})})})]})]})]})}),r.jsx(at.div,{id:"triage-vitals-form",layout:!0,initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2,delay:.05},className:"lg:sticky lg:top-24",children:r.jsxs(Ve,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsx(rt,{className:"pb-3",children:r.jsxs("div",{className:"flex items-start justify-between gap-2",children:[r.jsxs("div",{children:[r.jsxs(ot,{className:"flex items-center gap-2 text-base font-semibold text-slate-900 sm:text-lg",children:[r.jsx(cm,{className:"h-4 w-4 text-slate-700"}),"Record patient vitals"]}),r.jsx(vr,{className:"text-xs text-slate-500 sm:text-sm",children:"Select a patient from the queue to start capturing vitals."})]}),(x||o)&&r.jsxs(Ze,{variant:"outline",className:"inline-flex items-center gap-1 rounded-full border-slate-200 bg-slate-50 px-2 py-1 text-[11px] text-slate-500",children:[r.jsx(ns,{className:"h-3 w-3 animate-spin"}),"Syncing"]})]})}),r.jsx(He,{className:"pb-4",children:d?r.jsxs("form",{onSubmit:k,className:"space-y-4",children:[r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/80 px-3 py-2 text-xs text-slate-700",children:r.jsxs("div",{className:"flex flex-wrap items-center gap-1 sm:gap-2",children:[r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-white px-2 py-0.5 text-[11px] font-medium text-slate-800 border border-slate-200",children:[r.jsx(Yp,{className:"h-3 w-3"}),d.patient.name]}),r.jsxs("span",{className:"text-[11px] text-slate-500",children:["UHID ",d.patient.uhid]}),r.jsxs("span",{className:"text-[11px] text-slate-500",children:[" Time ",d.time]})]})}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Height (cm)"}),r.jsx(Se,{value:h.height_cm,onChange:D=>A("height_cm",D.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Weight (kg)"}),r.jsx(Se,{value:h.weight_kg,onChange:D=>A("weight_kg",D.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium text-slate-600",children:["Temperature (C)",r.jsx(Kp,{className:"h-3 w-3 text-slate-500"})]}),r.jsx(Se,{value:h.temp_c,onChange:D=>A("temp_c",D.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Pulse (bpm)"}),r.jsx(Se,{value:h.pulse,onChange:D=>A("pulse",D.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Resp. rate"}),r.jsx(Se,{value:h.resp_rate,onChange:D=>A("resp_rate",D.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"SpO (%)"}),r.jsx(Se,{value:h.spo2,onChange:D=>A("spo2",D.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"BP (sys / dia)"}),r.jsxs("div",{className:"flex gap-1.5",children:[r.jsx(Se,{value:h.bp_sys,onChange:D=>A("bp_sys",D.target.value),placeholder:"Sys",className:"h-9 rounded-2xl border-slate-200 text-sm"}),r.jsx(Se,{value:h.bp_dia,onChange:D=>A("bp_dia",D.target.value),placeholder:"Dia",className:"h-9 rounded-2xl border-slate-200 text-sm"})]})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Notes"}),r.jsx(Yl,{value:h.notes,onChange:D=>A("notes",D.target.value),className:"min-h-[70px] rounded-2xl border-slate-200 text-sm",placeholder:"Enter any triage notes, pain score, alerts"})]}),r.jsx(wb,{}),r.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[r.jsx("p",{className:"text-[11px] text-slate-400",children:"Saved vitals will be visible in the doctor's EMR view for this visit."}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Te,{type:"button",variant:"outline",size:"sm",className:"h-9 rounded-2xl border-slate-300 bg-white text-[11px]",onClick:()=>u(null),disabled:x,children:"Cancel"}),r.jsx(Te,{type:"submit",size:"sm",className:"h-9 rounded-2xl bg-slate-900 px-4 text-[11px] font-semibold uppercase tracking-wide text-white hover:bg-slate-800 disabled:opacity-50",disabled:x,children:x?"Saving":"Save vitals"})]})]})]}):r.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 px-3 py-4 text-center text-xs text-slate-500",children:["No patient selected.",r.jsxs("div",{className:"mt-1 text-[11px] text-slate-400",children:["Click ",r.jsx("span",{className:"font-medium",children:"Record vitals"})," on any patient in the queue to begin."]})]})})]})})]})]})})}function fLe({currentUser:t}){const{id:s}=xd(),n=Number(s),[a,i]=y.useState(!0),[l,o]=y.useState(!1),[c,d]=y.useState(null),[u,h]=y.useState({chief_complaint:"",symptoms:"",soap_subjective:"",soap_objective:"",soap_assessment:"",plan:""}),[f,x]=y.useState(""),[b,v]=y.useState(""),[w,_]=y.useState(!1),S=async()=>{try{i(!0);const{data:I}=await zue(n);d(I),h({chief_complaint:I.chief_complaint||"",symptoms:I.symptoms||"",soap_subjective:I.soap_subjective||"",soap_objective:I.soap_objective||"",soap_assessment:I.soap_assessment||"",plan:I.plan||""})}catch{d(null)}finally{i(!1)}};y.useEffect(()=>{n&&S()},[n]);const k=(I,M)=>h(B=>({...B,[I]:M})),A=async()=>{try{o(!0),await Uue(n,u),se.success("Visit updated"),await S()}catch{}finally{o(!1)}},T=I=>{if(!I)return"";const M=new Date(I);return Number.isNaN(M.getTime())?I:M.toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})},P=async()=>{if(!f){se.error("Select follow-up date");return}try{_(!0),await Hue(n,{due_date:f,note:b||void 0}),se.success("Follow-up created"),x(""),v(""),await S()}catch{}finally{_(!1)}},O=y.useMemo(()=>c?{id:c.patient_id,full_name:c.patient_name,uhid:c.uhid}:null,[c]),D=y.useMemo(()=>{if(c)return c.episode_id},[c]);return n?a?r.jsx("div",{className:"p-4 text-sm text-slate-500",children:"Loading visit"}):c?r.jsxs("div",{className:"space-y-4 p-4",children:[r.jsx("h1",{className:"text-xl font-semibold",children:"OPD Visit"}),r.jsx(h$,{patient:O,contextType:"opd",contextId:n,opNumber:D,currentUser:t,defaultLocationId:void 0}),r.jsxs("div",{className:"rounded-2xl border bg-white p-4 space-y-3 text-sm",children:[r.jsxs("div",{className:"flex flex-wrap justify-between gap-2",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"font-semibold",children:[c.patient_name," ",r.jsxs("span",{className:"text-[11px] text-slate-500",children:["(UHID ",c.uhid,")"]})]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:[c.department_name,"  Dr. ",c.doctor_name]})]}),r.jsxs("div",{className:"text-[11px] text-slate-500 text-right",children:["Episode: ",c.episode_id," ",r.jsx("br",{}),"Visit at: ",T(c.visit_at)]})]}),c.current_vitals&&r.jsxs("div",{className:"rounded-2xl border bg-slate-50 px-3 py-2 text-[11px] text-slate-700",children:[r.jsx("div",{className:"font-semibold mb-1",children:"Latest vitals"}),r.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1",children:[c.current_vitals.height_cm&&r.jsxs("span",{children:["Ht: ",c.current_vitals.height_cm," cm"]}),c.current_vitals.weight_kg&&r.jsxs("span",{children:["Wt: ",c.current_vitals.weight_kg," kg"]}),c.current_vitals.temp_c&&r.jsxs("span",{children:["Temp: ",c.current_vitals.temp_c," C"]}),c.current_vitals.bp_systolic&&r.jsxs("span",{children:["BP: ",c.current_vitals.bp_systolic,"/",c.current_vitals.bp_diastolic," mmHg"]}),c.current_vitals.pulse&&r.jsxs("span",{children:["Pulse: ",c.current_vitals.pulse]}),c.current_vitals.rr&&r.jsxs("span",{children:["RR: ",c.current_vitals.rr]}),c.current_vitals.spo2&&r.jsxs("span",{children:["SpO: ",c.current_vitals.spo2,"%"]})]})]})]}),r.jsxs("div",{className:"rounded-2xl border bg-white p-4 space-y-3",children:[r.jsx("h3",{className:"font-medium text-sm",children:"Clinical notes (SOAP)"}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium",children:"Chief Complaint"}),r.jsx("textarea",{className:"input min-h-[60px]",value:u.chief_complaint,onChange:I=>k("chief_complaint",I.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium",children:"Symptoms"}),r.jsx("textarea",{className:"input min-h-[60px]",value:u.symptoms,onChange:I=>k("symptoms",I.target.value)})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium",children:"Subjective"}),r.jsx("textarea",{className:"input min-h-[80px]",value:u.soap_subjective,onChange:I=>k("soap_subjective",I.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium",children:"Objective"}),r.jsx("textarea",{className:"input min-h-[80px]",value:u.soap_objective,onChange:I=>k("soap_objective",I.target.value)})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium",children:"Assessment"}),r.jsx("textarea",{className:"input min-h-[80px]",value:u.soap_assessment,onChange:I=>k("soap_assessment",I.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium",children:"Plan"}),r.jsx("textarea",{className:"input min-h-[80px]",value:u.plan,onChange:I=>k("plan",I.target.value)})]})]}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{className:"btn",onClick:A,disabled:l,children:l?"Saving":"Save notes"})})]}),r.jsxs("div",{className:"rounded-2xl border bg-white p-4 space-y-3",children:[r.jsx("h3",{className:"font-medium text-sm",children:"Follow-up"}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-[1fr,2fr,auto] items-end",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium",children:"Follow-up date"}),r.jsx("input",{type:"date",className:"input",value:f,onChange:I=>x(I.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium",children:"Note (optional)"}),r.jsx("input",{className:"input",value:b,onChange:I=>v(I.target.value),placeholder:"Review in 2 weeks / discuss reports"})]}),r.jsx("button",{className:"btn",onClick:P,disabled:w,children:w?"Creating":"Create Follow-up"})]})]})]}):r.jsx("div",{className:"p-4 text-sm text-red-600",children:"Visit not found."}):r.jsx("div",{className:"p-4 text-sm",children:"Invalid visit ID."})}const XR=()=>new Date().toISOString().slice(0,10),pLe={waiting:"Waiting",scheduled:"Scheduled",completed:"Completed",cancelled:"Cancelled","*":"All"},xLe={waiting:"bg-amber-50 text-amber-700",scheduled:"bg-blue-50 text-blue-700",completed:"bg-emerald-50 text-emerald-700",cancelled:"bg-slate-100 text-slate-700"};function c2(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-IN",{weekday:"short",day:"2-digit",month:"short",year:"numeric"})}catch{return t}}function gLe(){const[t,s]=y.useState("waiting"),[n,a]=y.useState(null),[i,l]=y.useState(XR()),[o,c]=y.useState(XR()),[d,u]=y.useState([]),[h,f]=y.useState(!1),[x,b]=y.useState(null),[v,w]=y.useState(""),[_,S]=y.useState(""),[k,A]=y.useState(!1),[T,P]=y.useState(null),[O,D]=y.useState(""),[I,M]=y.useState(""),[B,L]=y.useState([]),[F,V]=y.useState(!1),[$,z]=y.useState(!1),H=async()=>{try{f(!0);const ge={status:t,doctor_id:n||void 0,date_from:i||void 0,date_to:o||void 0},{data:X}=await Wue(ge);u(X||[])}catch{u([])}finally{f(!1)}};y.useEffect(()=>{H()},[t,n,i,o]);const q=ge=>{a(ge)},G=ge=>{b(ge),w(ge.due_date),S(ge.note||"")},re=async ge=>{if(ge.preventDefault(),!!x)try{A(!0),await que(x.id,{due_date:v,note:_||void 0}),se.success("Follow-up updated"),b(null),await H()}catch{}finally{A(!1)}},ye=async(ge,X)=>{if(!(ge!=null&&ge.doctor_id)||!X){L([]);return}try{z(!0);const{data:de}=await Mue({doctorUserId:ge.doctor_id,date:X});L(de||[])}catch{L([])}finally{z(!1)}},Ee=async ge=>{P(ge);const X=ge.due_date;D(X),M(""),await ye(ge,X)},ee=async ge=>{const X=ge.target.value;D(X),T&&await ye(T,X)},te=async ge=>{if(ge.preventDefault(),!!T){if(!I){se.error("Select a time slot");return}try{V(!0),await Gue(T.id,{date:O||void 0,slot_start:I}),se.success("Follow-up scheduled"),P(null),L([]),await H()}catch{}finally{V(!1)}}},ce=y.useMemo(()=>{const ge={total:d.length,waiting:0,scheduled:0,completed:0,cancelled:0};for(const X of d)ge[X.status]!==void 0&&(ge[X.status]+=1);return ge},[d]);return r.jsx("div",{className:"min-h-[calc(100vh-5rem)] bg-slate-50 px-4 py-6 md:px-6",children:r.jsxs("div",{className:"mx-auto max-w-5xl space-y-6",children:[r.jsxs("div",{className:"flex items-start justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"relative flex h-2 w-2",children:[r.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-sky-500 opacity-75"}),r.jsx("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-sky-500"})]}),r.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.2em] text-sky-700",children:"Follow-up Tracker"})]}),r.jsx("h1",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"OPD Follow-ups"}),r.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"View pending follow-ups, reschedule due dates, and confirm them into real OPD appointments."})]}),r.jsxs("div",{className:"hidden text-right text-xs text-slate-500 md:block",children:[r.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1",children:[r.jsx(yr,{className:"h-3 w-3"}),r.jsx("span",{children:"Continuity of care"})]}),r.jsxs("div",{className:"mt-1 flex items-center justify-end gap-1",children:[r.jsx(ar,{className:"h-3 w-3"}),r.jsxs("span",{children:[c2(i),"  ",c2(o)]})]})]})]}),r.jsxs(Ve,{className:"border-slate-200 shadow-sm rounded-3xl",children:[r.jsxs(rt,{className:"border-b border-slate-100 pb-4",children:[r.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-end md:justify-between",children:[r.jsxs("div",{className:"grid w-full gap-3 md:grid-cols-[2fr,1.3fr,1fr,1fr] md:items-end",children:[r.jsx(wl,{value:n,onChange:q}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(Fte,{className:"h-3 w-3"}),"Status"]}),r.jsxs(Fs,{value:t,onValueChange:ge=>s(ge),children:[r.jsx(Ds,{className:"h-9 text-xs",children:r.jsx($s,{placeholder:"Select status"})}),r.jsxs(Os,{children:[r.jsx(zt,{value:"waiting",children:"Waiting"}),r.jsx(zt,{value:"scheduled",children:"Scheduled"}),r.jsx(zt,{value:"completed",children:"Completed"}),r.jsx(zt,{value:"cancelled",children:"Cancelled"}),r.jsx(zt,{value:"*",children:"All"})]})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(ar,{className:"h-3 w-3"}),"From"]}),r.jsx(Se,{type:"date",className:"h-9",value:i,onChange:ge=>l(ge.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(ar,{className:"h-3 w-3"}),"To"]}),r.jsx(Se,{type:"date",className:"h-9",value:o,onChange:ge=>c(ge.target.value)})]})]}),r.jsx("div",{className:"flex items-center gap-2 md:w-auto",children:r.jsxs(Te,{type:"button",size:"sm",variant:"outline",onClick:H,disabled:h,className:"gap-1",children:[r.jsx(Ba,{className:"h-3 w-3"}),"Refresh"]})})]}),r.jsxs("div",{className:"mt-4 flex flex-wrap gap-2 text-xs",children:[r.jsxs(Ze,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-slate-50",children:[r.jsx(yr,{className:"h-3 w-3"}),r.jsx("span",{children:"Total"}),r.jsx("span",{className:"font-semibold",children:ce.total})]}),r.jsxs(Ze,{variant:"outline",className:"rounded-full border-slate-200 bg-amber-50 text-amber-700",children:["Waiting: ",ce.waiting]}),r.jsxs(Ze,{variant:"outline",className:"rounded-full border-slate-200 bg-blue-50 text-blue-700",children:["Scheduled: ",ce.scheduled]}),r.jsxs(Ze,{variant:"outline",className:"rounded-full border-slate-200 bg-emerald-50 text-emerald-700",children:["Completed: ",ce.completed]}),r.jsxs(Ze,{variant:"outline",className:"rounded-full border-slate-200 bg-slate-100 text-slate-700",children:["Cancelled: ",ce.cancelled]})]})]}),r.jsx(He,{className:"pt-4",children:h?r.jsx("div",{className:"space-y-3 py-4",children:[1,2,3].map(ge=>r.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-100 bg-slate-50/80 px-3 py-3",children:[r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsx(We,{className:"h-4 w-52"}),r.jsx(We,{className:"h-3 w-64"})]}),r.jsx(We,{className:"h-7 w-20"})]},ge))}):d.length===0?r.jsxs("div",{className:"flex flex-col items-center gap-2 py-10 text-center text-sm text-slate-500",children:[r.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-100",children:r.jsx(nn,{className:"h-5 w-5 text-slate-500"})}),r.jsx("div",{className:"font-medium text-slate-700",children:"No follow-ups for this filter"}),r.jsx("p",{className:"max-w-md text-xs text-slate-500",children:"Adjust status, doctor, or date range above to see past and upcoming follow-ups."})]}):r.jsx("div",{className:"space-y-2 pt-1 text-sm",children:d.map(ge=>{const X=xLe[ge.status]||"bg-slate-100 text-slate-700";return r.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[r.jsx("span",{className:"text-xs font-semibold text-slate-900",children:c2(ge.due_date)}),r.jsx("span",{className:"mx-0.5 text-slate-400",children:""}),r.jsxs("span",{className:"flex items-center gap-1 text-sm font-medium text-slate-900",children:[r.jsx(rn,{className:"h-3.5 w-3.5 text-slate-500"}),ge.patient_name]}),r.jsx("span",{className:"mx-0.5 text-slate-400",children:""}),r.jsxs("span",{className:"text-[11px] text-slate-500",children:["UHID ",ge.patient_uhid]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-1 text-[11px] text-slate-500",children:[r.jsxs("span",{children:["Dr. ",ge.doctor_name,"  ",ge.department_name]}),r.jsx("span",{className:"mx-1 text-slate-300",children:""}),r.jsx("span",{children:"Status:"}),r.jsx(Ze,{className:`border-none px-2 py-0.5 text-[11px] font-semibold uppercase ${X}`,children:pLe[ge.status]||ge.status})]}),ge.note&&r.jsxs("div",{className:"text-[11px] text-slate-600",children:["Note: ",ge.note]}),ge.status==="scheduled"&&ge.appointment_id&&r.jsxs("div",{className:"text-[11px] text-emerald-700",children:["Linked to appointment # ",ge.appointment_id]})]}),r.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2 text-xs",children:ge.status==="waiting"&&r.jsxs(r.Fragment,{children:[r.jsx(Te,{size:"sm",variant:"outline",onClick:()=>G(ge),children:"Edit"}),r.jsx(Te,{size:"sm",onClick:()=>Ee(ge),children:"Schedule"})]})})]},ge.id)})})})]}),x&&r.jsxs(Ve,{className:"border-slate-200 shadow-sm rounded-3xl",children:[r.jsx(rt,{className:"pb-3",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx(ot,{className:"text-base",children:"Edit Follow-up Date & Note"}),r.jsxs(vr,{className:"text-xs",children:[x.patient_name,"  UHID ",x.patient_uhid]})]}),r.jsx(Te,{variant:"ghost",size:"sm",className:"text-xs text-slate-500",type:"button",onClick:()=>b(null),children:"Close"})]})}),r.jsx(He,{children:r.jsxs("form",{onSubmit:re,className:"grid gap-3 md:grid-cols-[1fr,2fr,auto] md:items-end",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(ar,{className:"h-3 w-3"}),"Due date"]}),r.jsx(Se,{type:"date",value:v,onChange:ge=>w(ge.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(Es,{className:"h-3 w-3"}),"Note"]}),r.jsx(Se,{value:_,onChange:ge=>S(ge.target.value),placeholder:"Short instruction for next visit"})]}),r.jsx(Te,{type:"submit",disabled:k,children:k?"Saving":"Save changes"})]})})]}),T&&r.jsxs(Ve,{className:"border-slate-200 shadow-sm rounded-3xl",children:[r.jsx(rt,{className:"pb-3",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx(ot,{className:"text-base",children:"Schedule Follow-up Appointment"}),r.jsxs(vr,{className:"text-xs",children:[T.patient_name,"  UHID ",T.patient_uhid,"  Dr. ",T.doctor_name]})]}),r.jsx(Te,{variant:"ghost",size:"sm",className:"text-xs text-slate-500",type:"button",onClick:()=>{P(null),L([])},children:"Close"})]})}),r.jsx(He,{children:r.jsxs("form",{onSubmit:te,className:"space-y-4 text-sm",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-[1fr,2fr] md:items-start",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(ar,{className:"h-3 w-3"}),"Date"]}),r.jsx(Se,{type:"date",value:O,onChange:ee})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(Ba,{className:"h-3 w-3"}),"Time slot"]}),$?r.jsx("div",{className:"text-[11px] text-slate-500",children:"Loading slots"}):B.length===0?r.jsxs("div",{className:"flex items-start gap-2 rounded-xl border border-amber-200 bg-amber-50 px-3 py-2 text-[11px] text-amber-800",children:[r.jsx(nn,{className:"mt-[1px] h-3 w-3"}),r.jsx("span",{children:"No free slots found for this date. You can still type a custom time below."})]}):r.jsx("div",{className:"flex flex-wrap gap-2",children:B.map(ge=>r.jsx("button",{type:"button",onClick:()=>M(ge),className:["rounded-full border px-3 py-1 text-[11px] transition",I===ge?"border-slate-900 bg-slate-900 text-white":"border-slate-200 bg-slate-50 hover:bg-slate-100"].join(" "),children:ge},ge))}),r.jsx(Se,{type:"time",className:"mt-2",value:I,onChange:ge=>M(ge.target.value)})]})]}),r.jsx("div",{className:"flex justify-end",children:r.jsx(Te,{type:"submit",disabled:F,children:F?"Scheduling":"Confirm schedule"})})]})})]})]})})}const yLe=()=>new Date().toISOString().slice(0,10);function QR(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-IN",{weekday:"short",day:"2-digit",month:"short",year:"numeric"})}catch{return t}}function bLe(){const[t,s]=y.useState(null),[n,a]=y.useState(yLe()),[i,l]=y.useState([]),[o,c]=y.useState(!1),[d,u]=y.useState(null),[h,f]=y.useState(""),[x,b]=y.useState(""),[v,w]=y.useState(!1),_=async()=>{try{c(!0);const P={for_date:n,doctor_id:t||void 0},{data:O}=await $ue(P);l(O||[])}catch{l([])}finally{c(!1)}};y.useEffect(()=>{_()},[t,n]);const S=P=>{s(P)},k=P=>{u(P),f(P.date),b(P.slot_start)},A=async P=>{if(P.preventDefault(),!!d){if(!h||!x){se.error("Select date and time");return}try{w(!0),await Fue(d.id,{date:h,slot_start:x,create_new:!0}),se.success("No-show rescheduled as new appointment"),u(null),await _()}catch{}finally{w(!1)}}},T=y.useMemo(()=>i.length,[i]);return r.jsx("div",{className:"min-h-[calc(100vh-5rem)] bg-slate-50 px-4 py-6 md:px-6",children:r.jsxs("div",{className:"mx-auto max-w-5xl space-y-6",children:[r.jsxs("div",{className:"flex items-start justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"relative flex h-2 w-2",children:[r.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-rose-500 opacity-75"}),r.jsx("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-rose-500"})]}),r.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.2em] text-rose-700",children:"No-Show Recovery"})]}),r.jsx("h1",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"No-show Appointments"}),r.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Track patients who missed their appointment and quickly reschedule them into the OPD calendar."})]}),r.jsxs("div",{className:"hidden text-right text-xs text-slate-500 md:block",children:[r.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1",children:[r.jsx(Bi,{className:"h-3 w-3"}),r.jsx("span",{children:"Improve utilisation"})]}),r.jsxs("div",{className:"mt-1 flex items-center justify-end gap-1",children:[r.jsx(ar,{className:"h-3 w-3"}),r.jsx("span",{children:QR(n)})]})]})]}),r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(rt,{className:"border-b border-slate-100 pb-4",children:[r.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-end md:justify-between",children:[r.jsxs("div",{className:"grid w-full gap-3 md:grid-cols-[2fr,1fr] md:items-end",children:[r.jsx(wl,{value:t,onChange:S}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(ar,{className:"h-3 w-3"}),"For date"]}),r.jsx(Se,{type:"date",className:"h-9",value:n,onChange:P=>a(P.target.value)})]})]}),r.jsx("div",{className:"flex items-center gap-2 md:w-auto",children:r.jsxs(Te,{type:"button",size:"sm",variant:"outline",onClick:_,disabled:o,className:"gap-1",children:[r.jsx(Ba,{className:"h-3 w-3"}),"Refresh"]})})]}),r.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2 text-xs",children:[r.jsxs(Ze,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-slate-50",children:[r.jsx(nn,{className:"h-3 w-3 text-rose-600"}),r.jsx("span",{children:"Total no-shows"}),r.jsx("span",{className:"font-semibold",children:T})]}),r.jsx("span",{className:"text-[11px] text-slate-500",children:"Recover missed visits by creating a fresh appointment."})]})]}),r.jsx(He,{className:"pt-4",children:o?r.jsx("div",{className:"space-y-3 py-4",children:[1,2,3].map(P=>r.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-100 bg-slate-50/80 px-3 py-3",children:[r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsx(We,{className:"h-4 w-52"}),r.jsx(We,{className:"h-3 w-64"})]}),r.jsx(We,{className:"h-7 w-28"})]},P))}):i.length===0?r.jsxs("div",{className:"flex flex-col items-center gap-2 py-10 text-center text-sm text-slate-500",children:[r.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-100",children:r.jsx(nn,{className:"h-5 w-5 text-slate-500"})}),r.jsx("div",{className:"font-medium text-slate-700",children:"No no-show appointments for this filter"}),r.jsx("p",{className:"max-w-md text-xs text-slate-500",children:"Change the doctor or date above to check other days."})]}):r.jsx("div",{className:"space-y-2 pt-1 text-sm",children:i.map(P=>r.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[r.jsxs("span",{className:"text-xs font-semibold text-slate-900",children:[QR(P.date),"  ",P.slot_start]}),r.jsx("span",{className:"mx-0.5 text-slate-300",children:""}),r.jsxs("span",{className:"flex items-center gap-1 text-sm font-medium text-slate-900",children:[r.jsx(rn,{className:"h-3.5 w-3.5 text-slate-500"}),P.patient_name]}),r.jsx("span",{className:"mx-0.5 text-slate-400",children:""}),r.jsxs("span",{className:"text-[11px] text-slate-500",children:["UHID ",P.uhid]})]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:[P.department_name,"  Dr. ",P.doctor_name,"  Purpose:"," ",P.purpose||"Consultation"]})]}),r.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2 text-xs",children:r.jsxs(Te,{size:"sm",className:"gap-1",onClick:()=>k(P),children:[r.jsx(Bi,{className:"h-3 w-3"}),"Reschedule"]})})]},P.id))})})]}),d&&r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsx(rt,{className:"pb-3",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx(ot,{className:"text-base",children:"Reschedule No-show"}),r.jsxs(vr,{className:"text-xs",children:[d.patient_name,"  UHID ",d.uhid,"  Dr."," ",d.doctor_name]})]}),r.jsx(Te,{type:"button",variant:"ghost",size:"sm",className:"text-xs text-slate-500",onClick:()=>u(null),children:"Close"})]})}),r.jsx(He,{children:r.jsxs("form",{onSubmit:A,className:"grid gap-3 md:grid-cols-[1fr,1fr,auto] md:items-end text-sm",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(ar,{className:"h-3 w-3"}),"New date"]}),r.jsx(Se,{type:"date",value:h,onChange:P=>f(P.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[r.jsx(Ba,{className:"h-3 w-3"}),"New time"]}),r.jsx(Se,{type:"time",value:x,onChange:P=>b(P.target.value)})]}),r.jsx(Te,{type:"submit",disabled:v,children:v?"Rescheduling":"Create new appointment"})]})})]})]})})}function ZR(){return new Date().toISOString().slice(0,10)}function JR(t,s){const n=new Date(t);return n.setDate(n.getDate()+s),n.toISOString().slice(0,10)}function e6(t,s){if(!t||!s)return"";try{const n=new Date(t),a=new Date(s),l={day:"2-digit",month:"short",...n.getFullYear()===a.getFullYear()?{}:{year:"numeric"}},o={day:"2-digit",month:"short",year:"numeric"};return`${n.toLocaleDateString("en-IN",l)}  ${a.toLocaleDateString("en-IN",o)}`}catch{return`${t}  ${s}`}}function vLe(){const[t,s]=y.useState(""),[n,a]=y.useState(""),[i,l]=y.useState(null),[o,c]=y.useState(!1),[d,u]=y.useState(null);y.useEffect(()=>{const P=ZR(),O=JR(P,-6);s(O),a(P)},[]);const h=y.useCallback(async(P={})=>{var I,M;const O=P.dateFrom||t,D=P.dateTo||n;if(!(!O||!D))try{c(!0);const{data:B}=await Zue({dateFrom:O,dateTo:D,doctorId:i||void 0});u(B)}catch(B){console.error(B),se.error(((M=(I=B==null?void 0:B.response)==null?void 0:I.data)==null?void 0:M.detail)||"Failed to load OPD dashboard")}finally{c(!1)}},[t,n,i]);y.useEffect(()=>{t&&n&&h()},[t,n,i,h]);const f=P=>{l(P)},x=d||{},b=x.appointments||{},v=x.followups||{},w=x.doctor_stats||[],_=y.useMemo(()=>(w||[]).map(P=>({name:P.doctor_name||`#${P.doctor_id}`,total:P.total_appointments||0,completed:P.completed||0,no_show:P.no_show||0})),[w]),S=x.range||{},k=S.date_from&&S.date_to?e6(S.date_from,S.date_to):e6(t,n),A=b.total??0,T=o&&!d;return r.jsx("div",{className:"min-h-[calc(100vh-5rem)] bg-slate-50 px-4 py-6 md:px-6",children:r.jsxs("div",{className:"mx-auto max-w-6xl space-y-6",children:[r.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"relative flex h-2 w-2",children:[r.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-emerald-500 opacity-75"}),r.jsx("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-emerald-500"})]}),r.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-emerald-700",children:"OPD Analytics"})]}),r.jsx("h1",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"OPD Dashboard"}),r.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Quick view of OPD appointments, follow-ups and doctor workload for the selected date range."})]}),r.jsxs("div",{className:"flex flex-col items-start gap-2 text-xs text-slate-500 md:items-end",children:[r.jsxs(Ze,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-white px-3 py-1",children:[r.jsx(Th,{className:"h-3 w-3"}),r.jsx("span",{children:k})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx(Ze,{variant:"outline",className:"rounded-full border-slate-200 bg-slate-50 text-[11px]",children:i?"Filtered by specific doctor":"All doctors in OPD"}),r.jsx("span",{className:"text-[11px] text-slate-400",children:o?"Refreshing":"Live clinical summary"})]})]})]}),r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(rt,{className:"border-b border-slate-100 pb-3",children:[r.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:[r.jsx(Th,{className:"h-4 w-4"}),"Date & Doctor Filters"]}),r.jsx(Te,{type:"button",variant:"outline",size:"sm",onClick:()=>{const P=ZR(),O=JR(P,-6);s(O),a(P),l(null)},children:"Last 7 days"})]}),r.jsx(vr,{className:"mt-1 text-xs text-slate-500",children:"Use this view daily for clinical huddle, OPD utilisation review and doctor-wise load balancing."})]}),r.jsxs(He,{className:"space-y-4 pt-4",children:[r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:"From date"}),r.jsx(Se,{type:"date",value:t,onChange:P=>s(P.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:"To date"}),r.jsx(Se,{type:"date",value:n,onChange:P=>a(P.target.value)})]}),r.jsx("div",{className:"flex items-end",children:r.jsx(Te,{type:"button",className:"w-full",variant:"outline",onClick:()=>h({dateFrom:t,dateTo:n}),disabled:o,children:o?"Refreshing":"Refresh"})})]}),r.jsx(wl,{value:i,onChange:f,label:"Filter by doctor (optional)"})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsx(rt,{className:"pb-1",children:r.jsxs(ot,{className:"flex items-center justify-between text-xs font-medium text-slate-500",children:["Total appointments",r.jsx(Vs,{className:"h-4 w-4 text-slate-400"})]})}),r.jsx(He,{children:T?r.jsxs(r.Fragment,{children:[r.jsx(We,{className:"mb-1 h-7 w-16"}),r.jsx(We,{className:"h-3 w-32"})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:b.total??""}),r.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["Unique patients:"," ",r.jsx("span",{className:"font-semibold",children:b.unique_patients??""})]})]})})]}),r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsx(rt,{className:"pb-1",children:r.jsxs(ot,{className:"flex items-center justify-between text-xs font-medium text-slate-500",children:["Completed visits",r.jsx(Dn,{className:"h-4 w-4 text-emerald-500"})]})}),r.jsx(He,{children:T?r.jsxs(r.Fragment,{children:[r.jsx(We,{className:"mb-1 h-7 w-16"}),r.jsx(We,{className:"h-3 w-40"})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:b.completed??""}),r.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["In progress:"," ",r.jsx("span",{className:"font-semibold",children:b.in_progress??0})," "," Checked-in:"," ",r.jsx("span",{className:"font-semibold",children:b.checked_in??0})]})]})})]}),r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsx(rt,{className:"pb-1",children:r.jsxs(ot,{className:"flex items-center justify-between text-xs font-medium text-slate-500",children:["No-show & cancellations",r.jsx(za,{className:"h-4 w-4 text-amber-500"})]})}),r.jsx(He,{children:T?r.jsxs(r.Fragment,{children:[r.jsx(We,{className:"mb-1 h-7 w-16"}),r.jsx(We,{className:"h-3 w-32"})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:b.no_show??""}),r.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["Cancelled:"," ",r.jsx("span",{className:"font-semibold",children:b.cancelled??0})]})]})})]}),r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsx(rt,{className:"pb-1",children:r.jsxs(ot,{className:"flex items-center justify-between text-xs font-medium text-slate-500",children:["Follow-ups",r.jsx(Es,{className:"h-4 w-4 text-sky-500"})]})}),r.jsx(He,{children:T?r.jsxs(r.Fragment,{children:[r.jsx(We,{className:"mb-1 h-7 w-16"}),r.jsx(We,{className:"h-3 w-44"})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:v.total??""}),r.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["Waiting:"," ",r.jsx("span",{className:"font-semibold",children:v.waiting??0})," "," Scheduled:"," ",r.jsx("span",{className:"font-semibold",children:v.scheduled??0})]})]})})]})]}),r.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm lg:col-span-2",children:[r.jsxs(rt,{className:"pb-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs(ot,{className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:["Doctor-wise OPD load",r.jsx(Uo,{className:"h-4 w-4 text-slate-400"})]}),A>0&&r.jsxs(Ze,{className:"rounded-full bg-slate-900 text-[11px] font-normal text-white",children:["Total: ",A]})]}),r.jsx(vr,{className:"mt-1 text-xs text-slate-500",children:"Each bar represents total appointments per doctor in the chosen period."})]}),r.jsx(He,{className:"h-72 pt-2",children:_.length===0?r.jsx("div",{className:"flex h-full items-center justify-center text-sm text-slate-500",children:o?"Loading":"No data in selected range"}):r.jsx(eu,{width:"100%",height:"100%",children:r.jsxs(Nb,{data:_,children:[r.jsx(Ex,{dataKey:"name",tick:{fontSize:11},interval:0,height:40}),r.jsx(Tx,{}),r.jsx(nu,{}),r.jsx(Ax,{dataKey:"total"})]})})})]}),r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsx(rt,{className:"pb-2",children:r.jsxs(ot,{className:"flex items-center justify-between text-sm font-medium text-slate-700",children:["Highlights",r.jsx(rre,{className:"h-4 w-4 text-slate-400"})]})}),r.jsxs(He,{className:"space-y-4 pt-1 text-xs",children:[r.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-slate-50/60 px-3 py-2",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("span",{className:"font-semibold text-slate-800",children:"Top by appointments"}),r.jsx(Ze,{variant:"outline",className:"rounded-full border-emerald-200 bg-emerald-50 text-[10px] text-emerald-700",children:"Volume"})]}),x.top_doctor_by_appointments?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"mt-1 text-[13px] font-medium text-slate-900",children:x.top_doctor_by_appointments.doctor_name}),r.jsxs("p",{className:"mt-0.5 text-[11px] text-slate-500",children:["Dept:"," ",x.top_doctor_by_appointments.department_name||""]}),r.jsxs("p",{className:"mt-1 text-[11px] text-slate-500",children:["Total appointments:"," ",r.jsx("span",{className:"font-semibold",children:x.top_doctor_by_appointments.total_appointments}),r.jsx("br",{}),"No-show:"," ",r.jsx("span",{className:"font-semibold",children:x.top_doctor_by_appointments.no_show}),r.jsx("br",{}),"Follow-ups in range:"," ",r.jsx("span",{className:"font-semibold",children:x.top_doctor_by_appointments.followups_in_range})]})]}):r.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:o?"Calculating":"No doctor data in this range."})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-white px-3 py-2",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("span",{className:"font-semibold text-slate-800",children:"Top by completed visits"}),r.jsx(Ze,{variant:"outline",className:"rounded-full border-sky-200 bg-sky-50 text-[10px] text-sky-700",children:"Quality"})]}),x.top_doctor_by_completed?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"mt-1 text-[13px] font-medium text-slate-900",children:x.top_doctor_by_completed.doctor_name}),r.jsxs("p",{className:"mt-0.5 text-[11px] text-slate-500",children:["Dept:"," ",x.top_doctor_by_completed.department_name||""]}),r.jsxs("p",{className:"mt-1 text-[11px] text-slate-500",children:["Completed visits:"," ",r.jsx("span",{className:"font-semibold",children:x.top_doctor_by_completed.completed})]})]}):r.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:o?"Calculating":"Waiting for enough completed visits."})]}),r.jsx("p",{className:"text-[10px] leading-relaxed text-slate-500",children:"Use these insights for scheduling next weeks OPD, balancing high-load doctors and monitoring no-show trends."})]})]})]}),r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(rt,{className:"pb-2",children:[r.jsxs(ot,{className:"flex items-center justify-between text-sm font-medium text-slate-700",children:["Doctor-wise breakdown",r.jsx(Uo,{className:"h-4 w-4 text-slate-400"})]}),r.jsx(vr,{className:"mt-1 text-xs text-slate-500",children:"Each row shows total load, outcomes and follow-ups for a doctor in the selected range."})]}),r.jsx(He,{className:"overflow-x-auto pt-2",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b text-xs text-slate-500",children:[r.jsx("th",{className:"py-2 pr-2 text-left",children:"Doctor"}),r.jsx("th",{className:"py-2 px-2 text-left",children:"Department"}),r.jsx("th",{className:"py-2 px-2 text-right",children:"Total"}),r.jsx("th",{className:"py-2 px-2 text-right",children:"Completed"}),r.jsx("th",{className:"py-2 px-2 text-right",children:"No-show"}),r.jsx("th",{className:"py-2 px-2 text-right",children:"Cancelled"}),r.jsx("th",{className:"py-2 pl-2 text-right",children:"Follow-ups"})]})}),r.jsxs("tbody",{children:[w.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"py-4 text-center text-xs text-slate-500",children:o?"Loading":"No data to show"})}),w.map(P=>r.jsxs("tr",{className:"border-b last:border-0 hover:bg-slate-50/70",children:[r.jsx("td",{className:"py-2 pr-2 text-slate-800",children:P.doctor_name}),r.jsx("td",{className:"py-2 px-2 text-slate-600",children:P.department_name||""}),r.jsx("td",{className:"py-2 px-2 text-right",children:P.total_appointments}),r.jsx("td",{className:"py-2 px-2 text-right",children:P.completed}),r.jsx("td",{className:"py-2 px-2 text-right",children:P.no_show}),r.jsx("td",{className:"py-2 px-2 text-right",children:P.cancelled}),r.jsx("td",{className:"py-2 pl-2 text-right",children:P.followups_in_range})]},P.doctor_id))]})]})})]})]})})}const Wd=ZF,NLe=JF,VK=y.forwardRef(({className:t,...s},n)=>r.jsx(pv,{ref:n,className:Ft("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s}));VK.displayName=pv.displayName;const Ic=y.forwardRef(({className:t,children:s,...n},a)=>r.jsxs(NLe,{children:[r.jsx(VK,{}),r.jsxs(xv,{ref:a,className:Ft("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[s,r.jsxs(e$,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[r.jsx(Kn,{className:"h-4 w-4"}),r.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Ic.displayName=xv.displayName;const Mc=({className:t,...s})=>r.jsx("div",{className:Ft("flex flex-col space-y-1.5 text-center sm:text-left",t),...s});Mc.displayName="DialogHeader";const Dc=({className:t,...s})=>r.jsx("div",{className:Ft("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s});Dc.displayName="DialogFooter";const Oc=y.forwardRef(({className:t,...s},n)=>r.jsx(gv,{ref:n,className:Ft("text-lg font-semibold leading-none tracking-tight",t),...s}));Oc.displayName=gv.displayName;const Rc=y.forwardRef(({className:t,...s},n)=>r.jsx(yv,{ref:n,className:Ft("text-sm text-muted-foreground",t),...s}));Rc.displayName=yv.displayName;function rl(t){if(!t)return"";try{return new Date(t).toLocaleDateString()}catch{return t}}function Hr(t){return t==null?"0":Number(t).toLocaleString(void 0,{maximumFractionDigits:2})}function wLe(){const[t,s]=y.useState("dashboard"),[n,a]=y.useState([]),[i,l]=y.useState([]),[o,c]=y.useState([]),[d,u]=y.useState(!1),[h,f]=y.useState([]),[x,b]=y.useState([]),[v,w]=y.useState([]),[_,S]=y.useState([]),[k,A]=y.useState([]),[T,P]=y.useState([]),[O,D]=y.useState(!1),[I,M]=y.useState([]),[B,L]=y.useState(!1),[F,V]=y.useState([]),[$,z]=y.useState(!1),[H,q]=y.useState([]),[G,re]=y.useState(!1),[ye,Ee]=y.useState([]),[ee,te]=y.useState(!1),[ce,ge]=y.useState("ALL"),[X,de]=y.useState(""),[Ce,ue]=y.useState("saleable"),[fe,pe]=y.useState(!1),[oe,qe]=y.useState(null),[Xe,jt]=y.useState(!1),[ft,it]=y.useState(!1),[_t,ve]=y.useState([]),[ae,xe]=y.useState({supplier_id:"",location_id:"",expected_date:"",notes:""}),[je,Fe]=y.useState({open:!1,poId:null,email:""}),[Ct,vt]=y.useState(!1),[pt,Ns]=y.useState({supplier_id:"",location_id:"",invoice_number:"",invoice_date:"",notes:""}),[ds,ie]=y.useState([]),[Ie,he]=y.useState(!1),[Me,Ge]=y.useState({type:"TO_SUPPLIER",supplier_id:"",location_id:"",reason:""}),[Be,Ot]=y.useState([]),[Rt,Jt]=y.useState(!1),[ys,Qs]=y.useState(null),[na,qt]=y.useState(!1),[Gt,ra]=y.useState(null);y.useEffect(()=>{we(),Mt()},[]);function Mt(){lt(),ht(),Kt(),Wt(),Ht(),Ls()}async function we(){try{const[Q,ke]=await Promise.all([bv(),Sfe()]);a(Q.data||[]),l(ke.data||[])}catch(Q){console.error(Q)}}async function lt(){u(!0);try{const Q=await vv({q:X||void 0,is_active:!0});c(Q.data||[])}catch(Q){console.error(Q)}finally{u(!1)}}async function ht(){D(!0);const Q=ce&&ce!=="ALL"?{location_id:ce}:{};try{const[ke,Le,mt,Ut,_e,ne]=await Promise.all([Ife(Q),Mfe(Q),Dfe(Q),Ofe(Q),Rfe(Q),Lfe(Q)]);f(ke.data||[]),b(Le.data||[]),w(mt.data||[]),S(Ut.data||[]),A(_e.data||[]),P(ne.data||[])}catch(ke){console.error(ke)}finally{D(!1)}}async function Kt(){L(!0);try{const Q=await Ffe({});M(Q.data||[])}catch(Q){console.error(Q)}finally{L(!1)}}async function Wt(){z(!0);try{const Q=await Hfe({});V(Q.data||[])}catch(Q){console.error(Q)}finally{z(!1)}}async function Ht(){re(!0);try{const Q=await Gfe({});q(Q.data||[])}catch(Q){console.error(Q)}finally{re(!1)}}async function Ls(){te(!0);try{const Q=await Yfe({});Ee(Q.data||[])}catch(Q){console.error(Q)}finally{te(!1)}}const bs=y.useMemo(()=>o.length,[o]),on=y.useMemo(()=>x.length,[x]),ws=y.useMemo(()=>k.length,[k]),yn=y.useMemo(()=>v.length,[v]),bn=y.useMemo(()=>_.length,[_]),dt=y.useMemo(()=>I.filter(Q=>Q.status!=="COMPLETED"&&Q.status!=="CANCELLED"&&Q.status!=="CLOSED").length,[I]);function va(){qe(null),pe(!0)}function Wa(Q){qe(Q),pe(!0)}const Xn=async Q=>{var Ut,_e;Q.preventDefault();const ke=Q.currentTarget,Le={code:ke.code.value.trim(),name:ke.name.value.trim(),generic_name:ke.generic_name.value.trim()||null,form:ke.form.value.trim()||null,strength:ke.strength.value.trim()||null,unit:ke.unit.value.trim()||"tablet",pack_size:ke.pack_size.value||"10",manufacturer:ke.manufacturer.value.trim()||null,default_price:ke.default_price.value||null,default_mrp:ke.default_mrp.value||null,default_tax_percent:ke.default_tax_percent.value||null,reorder_level:ke.reorder_level.value||null,max_level:ke.max_level.value||null,class_name:ke.class_name.value.trim()||null,atc_code:ke.atc_code.value.trim()||null,hsn_code:ke.hsn_code.value.trim()||null,is_consumable:ke.is_consumable.checked,lasa_flag:ke.lasa_flag.checked},mt=(_e=(Ut=ke.qr_number)==null?void 0:Ut.value)==null?void 0:_e.trim();mt&&(Le.qr_number=mt);try{oe!=null&&oe.id?(await Efe(oe.id,Le),se.success("Item updated")):(await Afe(Le),se.success("Item created")),pe(!1),ke.reset(),await Promise.all([lt(),ht()])}catch(ne){console.error("Failed to save item",ne)}};function Ji(){Qs(null),Jt(!0)}function Ad(Q){Qs(Q),Jt(!0)}async function cc(Q){Q.preventDefault();const ke=new FormData(Q.target),Le={code:ke.get("code")||"",name:ke.get("name")||"",description:ke.get("description")||"",is_active:!0};if(!Le.name){se.error("Location name is required");return}try{ys?(await _fe(ys.id,Le),se.success("Location updated")):(await jfe(Le),se.success("Location created")),Jt(!1),Qs(null),await we(),await ht()}catch(mt){console.error(mt)}}function qa(){ra(null),qt(!0)}function x0(Q){ra(Q),qt(!0)}async function Ed(Q){Q.preventDefault();const ke=new FormData(Q.target),Le={code:ke.get("code")||"",name:ke.get("name")||"",contact_person:ke.get("contact_person")||"",phone:ke.get("phone")||"",email:ke.get("email")||"",gst_number:ke.get("gst_number")||"",address:ke.get("address")||"",is_active:!0};if(!Le.name){se.error("Supplier name is required");return}try{Gt?(await kfe(Gt.id,Le),se.success("Supplier updated")):(await Cfe(Le),se.success("Supplier created")),qt(!1),ra(null),await we(),await Kt(),await Wt(),await Ht()}catch(mt){console.error(mt)}}async function aa(){try{const Q=await Tfe(),ke=new Blob([Q.data],{type:"text/csv"}),Le=URL.createObjectURL(ke),mt=document.createElement("a");mt.href=Le,mt.download="pharmacy_items_sample.csv",mt.click(),URL.revokeObjectURL(Le)}catch(Q){console.error(Q)}}async function An(Q){var Le,mt;Q.preventDefault();const ke=(mt=(Le=Q.target.file)==null?void 0:Le.files)==null?void 0:mt[0];if(!ke){se.error("Please choose a CSV file");return}try{const Ut=await Pfe(ke);se.success(`Items uploaded  created: ${Ut.data.created}, updated: ${Ut.data.updated}`),jt(!1),lt(),ht()}catch(Ut){console.error(Ut)}}function ks(){ve(Q=>[...Q,{item_id:"",ordered_qty:1,unit_cost:0,tax_percent:0,mrp:0}])}function el(Q,ke,Le){ve(mt=>mt.map((Ut,_e)=>_e===Q?{...Ut,[ke]:Le}:Ut))}function Ga(Q){ve(ke=>ke.filter((Le,mt)=>mt!==Q))}async function dc(Q){if(Q.preventDefault(),!ae.supplier_id||!ae.location_id||_t.length===0){se.error("Supplier, location and at least one line are required");return}const ke={supplier_id:Number(ae.supplier_id),location_id:Number(ae.location_id),order_date:new Date().toISOString().slice(0,10),expected_date:ae.expected_date||null,notes:ae.notes||"",items:_t.filter(Le=>Le.item_id).map(Le=>({item_id:Number(Le.item_id),ordered_qty:Number(Le.ordered_qty||0),unit_cost:Number(Le.unit_cost||0),tax_percent:Number(Le.tax_percent||0),mrp:Number(Le.mrp||0)}))};if(ke.items.length===0){se.error("Add at least one valid line");return}try{await Bfe(ke),se.success("Purchase order created"),it(!1),ve([]),xe({supplier_id:"",location_id:"",expected_date:"",notes:""}),Kt()}catch(Le){console.error(Le)}}async function Ue(Q,ke){try{await $fe(Q,ke),se.success(`PO marked as ${ke}`),Kt()}catch(Le){console.error(Le)}}async function af(Q){try{const ke=await zfe(Q),Le=new Blob([ke.data],{type:"application/pdf"}),mt=URL.createObjectURL(Le);window.open(mt,"_blank"),setTimeout(()=>URL.revokeObjectURL(mt),1e4)}catch(ke){console.error(ke)}}async function Ps(Q){Q.preventDefault();const{poId:ke,email:Le}=je;if(!Le){se.error("Email is required");return}try{await Ufe(ke,Le),se.success("PO marked as SENT"),Fe({open:!1,poId:null,email:""}),Kt()}catch(mt){console.error(mt)}}function Fn(){ie(Q=>[...Q,{item_id:"",po_item_id:null,batch_no:"",expiry_date:"",quantity:0,free_quantity:0,unit_cost:0,tax_percent:0,mrp:0}])}function Il(Q,ke,Le){ie(mt=>mt.map((Ut,_e)=>_e===Q?{...Ut,[ke]:Le}:Ut))}function ut(Q){ie(ke=>ke.filter((Le,mt)=>mt!==Q))}async function ls(Q){if(Q.preventDefault(),!pt.supplier_id||!pt.location_id||ds.length===0){se.error("Supplier, location and at least one line are required");return}const ke={po_id:null,supplier_id:Number(pt.supplier_id),location_id:Number(pt.location_id),received_date:new Date().toISOString().slice(0,10),invoice_number:pt.invoice_number||"",invoice_date:pt.invoice_date||null,notes:pt.notes||"",items:ds.filter(Le=>Le.item_id&&Le.batch_no).map(Le=>({item_id:Number(Le.item_id),po_item_id:Le.po_item_id?Number(Le.po_item_id):null,batch_no:Le.batch_no,expiry_date:Le.expiry_date||null,quantity:Number(Le.quantity||0),free_quantity:Number(Le.free_quantity||0),unit_cost:Number(Le.unit_cost||0),tax_percent:Number(Le.tax_percent||0),mrp:Number(Le.mrp||0)}))};if(ke.items.length===0){se.error("Add at least one valid GRN line");return}try{await Vfe(ke),se.success("GRN created in DRAFT"),vt(!1),ie([]),Ns({supplier_id:"",location_id:"",invoice_number:"",invoice_date:"",notes:""}),Wt(),ht()}catch(Le){console.error(Le)}}async function Yt(Q){try{await Wfe(Q),se.success("GRN posted & stock updated"),Wt(),ht(),Kt()}catch(ke){console.error(ke)}}function Td(){Ot(Q=>[...Q,{item_id:"",batch_id:"",batch_no:"",quantity:0,reason:""}])}function Ws(Q,ke,Le){Ot(mt=>mt.map((Ut,_e)=>_e===Q?{...Ut,[ke]:Le}:Ut))}function Ml(Q){Ot(ke=>ke.filter((Le,mt)=>mt!==Q))}async function cn(Q){if(Q.preventDefault(),!Me.location_id||Be.length===0){se.error("Location and at least one line are required");return}const ke={type:Me.type,supplier_id:Me.supplier_id?Number(Me.supplier_id):null,location_id:Number(Me.location_id),return_date:new Date().toISOString().slice(0,10),reason:Me.reason||"",items:Be.filter(Le=>Le.item_id&&Le.quantity).map(Le=>({item_id:Number(Le.item_id),batch_id:Le.batch_id?Number(Le.batch_id):null,batch_no:Le.batch_no?Le.batch_no.trim():null,quantity:Number(Le.quantity||0),reason:Le.reason||""}))};if(ke.items.length===0){se.error("Add at least one valid return line");return}try{await qfe(ke),se.success("Return created in DRAFT"),he(!1),Ot([]),Ge({type:"TO_SUPPLIER",supplier_id:"",location_id:"",reason:""}),Ht(),ht()}catch(Le){console.error(Le)}}function Na(Q,ke="EXPIRED"){var Ut;if(!Q)return;const Le=((Ut=Q.item)==null?void 0:Ut.name)||Q.name||Q.item_name||`Item #${Q.item_id??""}`,mt=ke==="EXPIRED"?`Expired batch ${Q.batch_no||""} (${Le})`:`Quarantine batch ${Q.batch_no||""} (${Le})`;he(!0),Ge(_e=>({..._e,type:ke==="EXPIRED"?"INTERNAL":_e.type,location_id:Q.location_id?String(Q.location_id):_e.location_id,reason:mt})),Ot([{item_id:String(Q.item_id),batch_id:String(Q.id),batch_no:Q.batch_no||"",quantity:Number(Q.current_qty??0),reason:ke==="EXPIRED"?"Expired":"Quarantine / quality issue"}])}async function lf(Q){try{await Kfe(Q),se.success("Return posted & stock updated"),Ht(),ht()}catch(ke){console.error(ke)}}const as=n.find(Q=>String(Q.id)===String(ce));return r.jsxs(at.div,{className:"p-4 sm:p-6 lg:p-8 bg-slate-50 min-h-screen",initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.18},children:[r.jsxs("div",{className:"mb-6 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-semibold tracking-tight text-slate-900",children:"Pharmacy Inventory"}),r.jsx("p",{className:"text-sm text-slate-500",children:"Batch-wise stock, purchase  GRN  returns, and full transaction audit for NABH-compliant pharmacy management."})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[r.jsxs(Fs,{value:ce,onValueChange:Q=>{ge(Q),setTimeout(ht,0)},children:[r.jsx(Ds,{className:"w-48 bg-white",children:r.jsx($s,{placeholder:"All locations","aria-label":"Location filter"})}),r.jsxs(Os,{children:[r.jsx(zt,{value:"ALL",children:"All locations"}),n.map(Q=>r.jsx(zt,{value:String(Q.id),children:Q.code?`${Q.code}  ${Q.name}`:Q.name},Q.id))]})]}),r.jsx(Te,{variant:"outline",size:"icon",className:"rounded-full",onClick:Mt,children:r.jsx(_u,{className:"w-4 h-4"})})]})]}),r.jsxs("div",{className:"grid gap-4 mb-6 md:grid-cols-4",children:[r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(rt,{className:"pb-2 flex flex-row items-center justify-between",children:[r.jsx(ot,{className:"text-xs font-medium text-slate-500",children:"Active items"}),r.jsx(dr,{className:"w-4 h-4 text-slate-400"})]}),r.jsxs(He,{children:[r.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:bs}),r.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Medicines & consumables in catalogue"})]})]}),r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(rt,{className:"pb-2 flex flex-row items-center justify-between",children:[r.jsx(ot,{className:"text-xs font-medium text-slate-500",children:"Near-expiry batches"}),r.jsx(za,{className:"w-4 h-4 text-amber-500"})]}),r.jsxs(He,{children:[r.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:on}),r.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Within alert window  Expired on shelf: ",yn]})]})]}),r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(rt,{className:"pb-2 flex flex-row items-center justify-between",children:[r.jsx(ot,{className:"text-xs font-medium text-slate-500",children:"Low-stock items"}),r.jsx(gne,{className:"w-4 h-4 text-sky-500"})]}),r.jsxs(He,{children:[r.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:ws}),r.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Below reorder threshold  Quarantine: ",bn]})]})]}),r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(rt,{className:"pb-2 flex flex-row items-center justify-between",children:[r.jsx(ot,{className:"text-xs font-medium text-slate-500",children:"Open purchase orders"}),r.jsx(lre,{className:"w-4 h-4 text-emerald-500"})]}),r.jsxs(He,{children:[r.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:dt}),r.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Draft / sent / partially received"})]})]})]}),r.jsxs(jl,{value:t,onValueChange:s,className:"space-y-4",children:[r.jsxs(Wi,{className:"bg-slate-100 rounded-full p-1 flex flex-wrap gap-1",children:[r.jsx(ms,{value:"dashboard",children:"Dashboard"}),r.jsx(ms,{value:"items",children:"Items"}),r.jsx(ms,{value:"locations",children:"Locations"}),r.jsx(ms,{value:"suppliers",children:"Suppliers"}),r.jsx(ms,{value:"stock",children:"Stock & Alerts"}),r.jsx(ms,{value:"po",children:"Purchase Orders"}),r.jsx(ms,{value:"grn",children:"GRN"}),r.jsx(ms,{value:"returns",children:"Returns"}),r.jsx(ms,{value:"txns",children:"Transactions"})]}),r.jsx(us,{value:"dashboard",children:r.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(rt,{className:"flex flex-row items-center justify-between pb-2",children:[r.jsxs(ot,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Expiry alerts",r.jsx(Ze,{variant:"outline",className:"text-xs",children:x.length})]}),r.jsx(za,{className:"w-4 h-4 text-amber-500"})]}),r.jsx(He,{className:"space-y-3 max-h-[320px] overflow-auto",children:O?r.jsxs("div",{className:"space-y-2",children:[r.jsx(We,{className:"h-8 w-full"}),r.jsx(We,{className:"h-8 w-full"}),r.jsx(We,{className:"h-8 w-full"})]}):x.length===0&&v.length===0?r.jsxs("p",{className:"text-sm text-slate-500",children:["No batches approaching expiry or expired on shelf for"," ",as?as.name:"all locations","."]}):r.jsxs(r.Fragment,{children:[v.length>0&&r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-xs font-semibold text-rose-600 uppercase tracking-wide",children:"Expired on shelf"}),r.jsx("div",{className:"space-y-1.5",children:v.map(Q=>{var ke;return r.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-rose-200 bg-rose-50 px-3 py-2",children:[r.jsxs("div",{className:"space-y-0.5",children:[r.jsxs("p",{className:"text-sm font-medium text-slate-900",children:[((ke=Q.item)==null?void 0:ke.name)||Q.name||Q.item_name||`Item #${Q.item_id??""}`,Q.batch_no&&r.jsxs("span",{className:"text-xs text-slate-500",children:[" ","(",Q.batch_no,")"]})]}),r.jsxs("p",{className:"text-xs text-slate-500",children:["Qty:"," ",Hr(Q.current_qty)," "," Expired:"," ",rl(Q.expiry_date)]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs(Ze,{variant:"outline",className:"text-xs border-rose-300 text-rose-700",children:["Exp:"," ",rl(Q.expiry_date)]}),r.jsx(Te,{type:"button",variant:"outline",size:"sm",className:"h-7 px-2 text-[11px]",onClick:()=>Na(Q,"EXPIRED"),children:"Create return"})]})]},`expired-${Q.id}`)})})]}),x.length>0&&r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-xs font-semibold text-amber-600 uppercase tracking-wide",children:"Near expiry"}),r.jsx("div",{className:"space-y-1.5",children:x.map(Q=>{var ke;return r.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-slate-200 px-3 py-2 bg-slate-50",children:[r.jsxs("div",{className:"space-y-0.5",children:[r.jsxs("p",{className:"text-sm font-medium text-slate-900",children:[((ke=Q.item)==null?void 0:ke.name)||Q.name||Q.item_name||`Item #${Q.item_id??""}`,Q.batch_no&&r.jsxs("span",{className:"text-xs text-slate-500",children:[" ","(",Q.batch_no,")"]})]}),r.jsxs("p",{className:"text-xs text-slate-500",children:["Qty:"," ",Hr(Q.current_qty)," "," Exp:"," ",rl(Q.expiry_date)]})]}),r.jsxs(Ze,{variant:"outline",className:"text-xs",children:["Exp:"," ",rl(Q.expiry_date)]})]},`near-${Q.id}`)})})]})]})})]}),r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(rt,{className:"flex flex-row items-center justify-between pb-2",children:[r.jsxs(ot,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Stock alerts",r.jsx(Ze,{variant:"outline",className:"text-xs",children:k.length+T.length})]}),r.jsx(Vs,{className:"w-4 h-4 text-sky-500"})]}),r.jsx(He,{className:"space-y-2 max-h-[320px] overflow-auto",children:O?r.jsxs("div",{className:"space-y-2",children:[r.jsx(We,{className:"h-8 w-full"}),r.jsx(We,{className:"h-8 w-full"}),r.jsx(We,{className:"h-8 w-full"})]}):k.length===0&&T.length===0?r.jsxs("p",{className:"text-sm text-slate-500",children:["No low / max stock issues for"," ",as?as.name:"all locations","."]}):r.jsxs(r.Fragment,{children:[k.map(Q=>r.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-amber-200 bg-amber-50 px-3 py-2",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-slate-900",children:Q.name}),r.jsxs("p",{className:"text-xs text-slate-600",children:["Qty: ",Hr(Q.total_qty)," / Reorder:"," ",Hr(Q.reorder_level)]})]}),r.jsx(Ze,{variant:"outline",className:"text-xs border-amber-300 text-amber-700",children:"Low stock"})]},`low-${Q.item_id}-${Q.location_id||"all"}`)),T.map(Q=>r.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-sky-200 bg-sky-50 px-3 py-2",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-slate-900",children:Q.name}),r.jsxs("p",{className:"text-xs text-slate-600",children:["Qty: ",Hr(Q.total_qty)," / Max:"," ",Hr(Q.max_level)]})]}),r.jsx(Ze,{variant:"outline",className:"text-xs border-sky-300 text-sky-700",children:"Over-stock"})]},`max-${Q.item_id}-${Q.location_id||"all"}`))]})})]})]})}),r.jsx(us,{value:"items",children:r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(rt,{className:"flex flex-row items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs(ot,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Pharmacy items",r.jsx(Ze,{variant:"outline",className:"text-xs",children:o.length})]}),r.jsx("p",{className:"text-xs text-slate-500",children:"Medicines & consumables master  supports manual and CSV bulk upload."})]}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsxs(Te,{variant:"outline",size:"sm",className:"gap-1",onClick:()=>jt(!0),children:[r.jsx(I_,{className:"w-3 h-3"}),"CSV upload"]}),r.jsxs(Te,{variant:"outline",size:"sm",className:"gap-1",onClick:aa,children:[r.jsx(to,{className:"w-3 h-3"}),"Sample CSV"]}),r.jsxs(Te,{size:"sm",className:"gap-1",onClick:va,children:[r.jsx(ps,{className:"w-3 h-3"}),"New item"]})]})]}),r.jsxs(He,{className:"space-y-3",children:[r.jsx("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:r.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[r.jsx(Se,{placeholder:"Search by name / code / generic...",className:"w-full sm:w-80 bg-white",value:X,onChange:Q=>de(Q.target.value),onKeyDown:Q=>{Q.key==="Enter"&&lt()}}),r.jsx(Te,{variant:"outline",size:"icon",className:"rounded-full",onClick:lt,children:r.jsx($r,{className:"w-4 h-4"})})]})}),r.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[r.jsxs("div",{className:"grid grid-cols-[2fr,1.2fr,1fr,1fr,0.6fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[r.jsx("span",{children:"Name / code"}),r.jsx("span",{children:"Generic / form"}),r.jsx("span",{children:"Default price / MRP"}),r.jsx("span",{children:"Reorder / Max"}),r.jsx("span",{className:"text-right",children:"Actions"})]}),r.jsx("div",{className:"max-h-[420px] overflow-auto divide-y divide-slate-100",children:d?r.jsxs("div",{className:"p-3 space-y-2",children:[r.jsx(We,{className:"h-7 w-full"}),r.jsx(We,{className:"h-7 w-full"}),r.jsx(We,{className:"h-7 w-full"})]}):o.length===0?r.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No items found. Use New item or CSV upload to add catalogue."}):o.map(Q=>r.jsxs("div",{className:"grid grid-cols-[2fr,1.2fr,1fr,1fr,0.6fr] items-center px-3 py-2 text-xs",children:[r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-slate-900",children:Q.name}),r.jsxs("div",{className:"text-slate-500 flex flex-wrap items-center gap-1",children:[r.jsx("span",{children:Q.code}),Q.is_consumable&&r.jsx(Ze,{variant:"outline",className:"text-[10px]",children:"Consumable"}),Q.lasa_flag&&r.jsx(Ze,{variant:"outline",className:"text-[10px] border-rose-300 text-rose-600",children:"LASA"})]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-slate-700",children:Q.generic_name||""}),r.jsxs("div",{className:"text-slate-500",children:[Q.form||""," ",Q.strength&&` ${Q.strength}`]})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"text-slate-700",children:["Price: ",Hr(Q.default_price)]}),r.jsxs("div",{className:"text-slate-500",children:["MRP: ",Hr(Q.default_mrp),"  Tax:"," ",Hr(Q.default_tax_percent),"%"]})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"text-slate-700",children:["Reorder: ",Hr(Q.reorder_level)]}),r.jsxs("div",{className:"text-slate-500",children:["Max: ",Hr(Q.max_level)]})]}),r.jsx("div",{className:"flex items-center justify-end gap-2",children:r.jsx(Te,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>Wa(Q),children:r.jsx(up,{className:"w-3 h-3"})})})]},Q.id))})]})]})]})}),r.jsx(us,{value:"locations",children:r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(rt,{className:"flex flex-row items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs(ot,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Inventory locations",r.jsx(Ze,{variant:"outline",className:"text-xs",children:n.length})]}),r.jsx("p",{className:"text-xs text-slate-500",children:"Define pharmacy / store locations for stock segregation and reporting."})]}),r.jsxs(Te,{size:"sm",className:"gap-1",onClick:Ji,children:[r.jsx(ps,{className:"w-3 h-3"}),"New location"]})]}),r.jsx(He,{children:r.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[r.jsxs("div",{className:"grid grid-cols-[0.6fr,1.4fr,1fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[r.jsx("span",{children:"Code"}),r.jsx("span",{children:"Name"}),r.jsx("span",{className:"text-right",children:"Actions"})]}),r.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:n.length===0?r.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No locations defined yet. Click New location to add."}):n.map(Q=>r.jsxs("div",{className:"grid grid-cols-[0.6fr,1.4fr,1fr] items-center px-3 py-2 text-xs",children:[r.jsx("div",{className:"text-slate-900 font-medium",children:Q.code||""}),r.jsxs("div",{className:"text-slate-900",children:[Q.name,Q.description&&r.jsx("div",{className:"text-[11px] text-slate-500",children:Q.description})]}),r.jsx("div",{className:"flex items-center justify-end gap-2",children:r.jsx(Te,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>Ad(Q),children:r.jsx(up,{className:"w-3 h-3"})})})]},Q.id))})]})})]})}),r.jsx(us,{value:"suppliers",children:r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(rt,{className:"flex flex-row items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs(ot,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Suppliers",r.jsx(Ze,{variant:"outline",className:"text-xs",children:i.length})]}),r.jsx("p",{className:"text-xs text-slate-500",children:"Maintain vendor master for purchase orders, GRN, and returns."})]}),r.jsxs(Te,{size:"sm",className:"gap-1",onClick:qa,children:[r.jsx(ps,{className:"w-3 h-3"}),"New supplier"]})]}),r.jsx(He,{children:r.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[r.jsxs("div",{className:"grid grid-cols-[0.8fr,1.4fr,1.4fr,0.8fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[r.jsx("span",{children:"Code"}),r.jsx("span",{children:"Name / contact"}),r.jsx("span",{children:"Contact details"}),r.jsx("span",{className:"text-right",children:"Actions"})]}),r.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:i.length===0?r.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No suppliers defined yet. Click New supplier to add."}):i.map(Q=>r.jsxs("div",{className:"grid grid-cols-[0.8fr,1.4fr,1.4fr,0.8fr] items-center px-3 py-2 text-xs",children:[r.jsx("div",{className:"text-slate-900 font-medium",children:Q.code||""}),r.jsxs("div",{className:"text-slate-900",children:[Q.name,Q.contact_person&&r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Contact: ",Q.contact_person]})]}),r.jsxs("div",{className:"text-slate-700 text-[11px] space-y-0.5",children:[Q.phone&&r.jsxs("div",{children:[" ",Q.phone]}),Q.email&&r.jsxs("div",{children:[" ",Q.email]}),Q.gst_number&&r.jsxs("div",{className:"text-slate-500",children:["GST: ",Q.gst_number]})]}),r.jsx("div",{className:"flex items-center justify-end gap-2",children:r.jsx(Te,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>x0(Q),children:r.jsx(up,{className:"w-3 h-3"})})})]},Q.id))})]})})]})}),r.jsx(us,{value:"stock",children:r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(rt,{className:"flex flex-row items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs(ot,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Stock summary",r.jsx(Ze,{variant:"outline",className:"text-xs",children:h.length})]}),r.jsx("p",{className:"text-xs text-slate-500",children:"Location-wise quantities with low / max level indicators."})]}),r.jsx(Wne,{className:"w-4 h-4 text-slate-400"})]}),r.jsx(He,{className:"space-y-4",children:r.jsxs(jl,{value:Ce,onValueChange:ue,className:"space-y-3",children:[r.jsxs(Wi,{className:"bg-slate-100 rounded-full p-1 inline-flex gap-1",children:[r.jsx(ms,{value:"saleable",children:"Saleable stock"}),r.jsx(ms,{value:"quarantine",children:"Expired & quarantine"})]}),r.jsx(us,{value:"saleable",className:"space-y-3",children:r.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[r.jsxs("div",{className:"grid grid-cols-[2fr,1.2fr,1fr,0.8fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[r.jsx("span",{children:"Item"}),r.jsx("span",{children:"Location"}),r.jsx("span",{children:"Qty"}),r.jsx("span",{children:"Status"})]}),r.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:O?r.jsxs("div",{className:"p-3 space-y-2",children:[r.jsx(We,{className:"h-7 w-full"}),r.jsx(We,{className:"h-7 w-full"}),r.jsx(We,{className:"h-7 w-full"})]}):h.length===0?r.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No stock summary yet."}):h.map(Q=>{const ke=[];return Q.is_low&&ke.push(r.jsx(Ze,{variant:"outline",className:"border-amber-300 text-amber-700 text-[10px]",children:"Low"},"low")),Q.is_over&&ke.push(r.jsx(Ze,{variant:"outline",className:"border-sky-300 text-sky-700 text-[10px]",children:"Max"},"max")),ke.length||ke.push(r.jsx(Ze,{variant:"outline",className:"text-[10px]",children:"OK"},"ok")),r.jsxs("div",{className:"grid grid-cols-[2fr,1.2fr,1fr,0.8fr] items-center px-3 py-2 text-xs",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-slate-900",children:Q.name}),r.jsx("p",{className:"text-slate-500",children:Q.code})]}),r.jsx("div",{className:"text-slate-700",children:Q.location_name||"All locations"}),r.jsx("div",{className:"text-slate-700",children:Hr(Q.total_qty)}),r.jsx("div",{className:"flex gap-1 flex-wrap",children:ke})]},`${Q.item_id}-${Q.location_id||"all"}`)})})]})}),r.jsx(us,{value:"quarantine",className:"space-y-3",children:r.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[r.jsxs("div",{className:"grid grid-cols-[2fr,1.2fr,1fr,1fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[r.jsx("span",{children:"Item / batch"}),r.jsx("span",{children:"Location"}),r.jsx("span",{children:"Qty / expiry"}),r.jsx("span",{className:"text-right",children:"Status / actions"})]}),r.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:O?r.jsxs("div",{className:"p-3 space-y-2",children:[r.jsx(We,{className:"h-7 w-full"}),r.jsx(We,{className:"h-7 w-full"}),r.jsx(We,{className:"h-7 w-full"})]}):_.length===0?r.jsxs("div",{className:"p-4 text-sm text-slate-500",children:["No quarantine / written-off / returned batches for"," ",as?as.name:"all locations","."]}):_.map(Q=>{var mt,Ut,_e;const ke=(Q.status||"").toUpperCase();let Le="text-[10px]";return ke==="EXPIRED"||ke==="WRITTEN_OFF"?Le+=" border-rose-300 text-rose-700":ke==="QUARANTINE"?Le+=" border-amber-300 text-amber-700":ke==="RETURNED"&&(Le+=" border-slate-300 text-slate-600"),r.jsxs("div",{className:"grid grid-cols-[2fr,1.2fr,1fr,1fr] items-center px-3 py-2 text-xs",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-slate-900",children:((mt=Q.item)==null?void 0:mt.name)||Q.name||Q.item_name||`Item #${Q.item_id??""}`}),r.jsxs("p",{className:"text-[11px] text-slate-500",children:["Batch:"," ",Q.batch_no||"","  Code:"," ",((Ut=Q.item)==null?void 0:Ut.code)||""]})]}),r.jsx("div",{className:"text-slate-700",children:((_e=Q.location)==null?void 0:_e.name)||""}),r.jsxs("div",{children:[r.jsxs("p",{className:"text-slate-700",children:["Qty:"," ",Hr(Q.current_qty)]}),r.jsxs("p",{className:"text-[11px] text-slate-500",children:["Exp:"," ",rl(Q.expiry_date)||""]})]}),r.jsxs("div",{className:"flex items-center justify-end gap-2",children:[r.jsx(Ze,{variant:"outline",className:Le,children:ke||"UNKNOWN"}),ke!=="RETURNED"&&r.jsx(Te,{type:"button",variant:"outline",size:"sm",className:"h-7 px-2 text-[11px]",onClick:()=>Na(Q,"QUARANTINE"),children:"Create return"})]})]},`q-${Q.id}`)})})]})})]})})]})}),r.jsx(us,{value:"po",children:r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(rt,{className:"flex flex-row items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs(ot,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Purchase orders",r.jsx(Ze,{variant:"outline",className:"text-xs",children:I.length})]}),r.jsx("p",{className:"text-xs text-slate-500",children:"Create POs, print PDF, mark sent, and track status."})]}),r.jsxs(Te,{size:"sm",className:"gap-1",onClick:()=>it(!0),children:[r.jsx(ps,{className:"w-3 h-3"}),"New PO"]})]}),r.jsx(He,{children:r.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[r.jsxs("div",{className:"grid grid-cols-[1.1fr,1.2fr,1.2fr,0.9fr,0.9fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[r.jsx("span",{children:"PO number"}),r.jsx("span",{children:"Supplier"}),r.jsx("span",{children:"Location / dates"}),r.jsx("span",{children:"Status"}),r.jsx("span",{className:"text-right",children:"Actions"})]}),r.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:B?r.jsxs("div",{className:"p-3 space-y-2",children:[r.jsx(We,{className:"h-7 w-full"}),r.jsx(We,{className:"h-7 w-full"}),r.jsx(We,{className:"h-7 w-full"})]}):I.length===0?r.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No purchase orders created yet."}):I.map(Q=>{var ke,Le,mt,Ut;return r.jsxs("div",{className:"grid grid-cols-[1.1fr,1.2fr,1.2fr,0.9fr,0.9fr] items-center px-3 py-2 text-xs",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-slate-900",children:Q.po_number}),r.jsxs("p",{className:"text-slate-500",children:["Created: ",rl(Q.order_date)]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-slate-900",children:(ke=Q.supplier)==null?void 0:ke.name}),r.jsx("p",{className:"text-slate-500 text-[11px]",children:((Le=Q.supplier)==null?void 0:Le.phone)||((mt=Q.supplier)==null?void 0:mt.email)||""})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-slate-900",children:(Ut=Q.location)==null?void 0:Ut.name}),r.jsxs("p",{className:"text-slate-500 text-[11px]",children:["Exp:"," ",Q.expected_date?rl(Q.expected_date):""]})]}),r.jsx("div",{children:r.jsx(Ze,{variant:"outline",className:"text-[10px] capitalize",children:Q.status.toLowerCase()})}),r.jsxs("div",{className:"flex items-center justify-end gap-2",children:[r.jsx(Te,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>af(Q.id),children:r.jsx(e1,{className:"w-3 h-3"})}),r.jsx(Te,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>Fe({open:!0,poId:Q.id,email:Q.email_sent_to||""}),children:r.jsx(dm,{className:"w-3 h-3"})}),Q.status==="DRAFT"||Q.status==="SENT"?r.jsxs(Fs,{defaultValue:Q.status,onValueChange:_e=>Ue(Q.id,_e),children:[r.jsx(Ds,{className:"h-7 w-24 text-[11px] bg-white",children:r.jsx($s,{})}),r.jsxs(Os,{children:[r.jsx(zt,{value:"DRAFT",children:"DRAFT"}),r.jsx(zt,{value:"SENT",children:"SENT"}),r.jsx(zt,{value:"PARTIALLY_RECEIVED",children:"PARTIAL"}),r.jsx(zt,{value:"COMPLETED",children:"COMPLETED"}),r.jsx(zt,{value:"CANCELLED",children:"CANCELLED"}),r.jsx(zt,{value:"CLOSED",children:"CLOSED"})]})]}):r.jsx(Ze,{variant:"outline",className:"text-[10px] capitalize",children:Q.status.toLowerCase()})]})]},Q.id)})})]})})]})}),r.jsx(us,{value:"grn",children:r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(rt,{className:"flex flex-row items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs(ot,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Goods Receipt Notes",r.jsx(Ze,{variant:"outline",className:"text-xs",children:F.length})]}),r.jsx("p",{className:"text-xs text-slate-500",children:"Post GRNs to create batches and update stock (GRN  Stock transactions)."})]}),r.jsxs(Te,{size:"sm",className:"gap-1",onClick:()=>vt(!0),children:[r.jsx(ps,{className:"w-3 h-3"}),"New GRN"]})]}),r.jsx(He,{children:r.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[r.jsxs("div",{className:"grid grid-cols-[1.1fr,1.2fr,1.2fr,0.9fr,0.9fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[r.jsx("span",{children:"GRN number"}),r.jsx("span",{children:"Supplier"}),r.jsx("span",{children:"Location / invoice"}),r.jsx("span",{children:"Status"}),r.jsx("span",{className:"text-right",children:"Actions"})]}),r.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:$?r.jsxs("div",{className:"p-3 space-y-2",children:[r.jsx(We,{className:"h-7 w-full"}),r.jsx(We,{className:"h-7 w-full"}),r.jsx(We,{className:"h-7 w-full"})]}):F.length===0?r.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No GRNs created yet."}):F.map(Q=>{var ke,Le,mt,Ut;return r.jsxs("div",{className:"grid grid-cols-[1.1fr,1.2fr,1.2fr,0.9fr,0.9fr] items-center px-3 py-2 text-xs",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-slate-900",children:Q.grn_number}),r.jsxs("p",{className:"text-slate-500",children:["Received: ",rl(Q.received_date)]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-slate-900",children:(ke=Q.supplier)==null?void 0:ke.name}),r.jsx("p",{className:"text-slate-500 text-[11px]",children:((Le=Q.supplier)==null?void 0:Le.phone)||((mt=Q.supplier)==null?void 0:mt.email)||""})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-slate-900",children:(Ut=Q.location)==null?void 0:Ut.name}),r.jsxs("p",{className:"text-slate-500 text-[11px]",children:["Inv: ",Q.invoice_number||""," ",Q.invoice_date&&` ${rl(Q.invoice_date)}`]})]}),r.jsx("div",{children:r.jsx(Ze,{variant:"outline",className:"text-[10px] capitalize",children:Q.status.toLowerCase()})}),r.jsxs("div",{className:"flex items-center justify-end gap-2",children:[r.jsx(Te,{variant:"ghost",size:"icon",className:"h-7 w-7",children:r.jsx(yr,{className:"w-3 h-3"})}),Q.status==="DRAFT"&&r.jsx(Te,{variant:"outline",size:"sm",className:"h-7 px-2 text-[11px]",onClick:()=>Yt(Q.id),children:"Post GRN"})]})]},Q.id)})})]})})]})}),r.jsx(us,{value:"returns",children:r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsxs(rt,{className:"flex flex-row items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsxs(ot,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Returns",r.jsx(Ze,{variant:"outline",className:"text-xs",children:H.length})]}),r.jsx("p",{className:"text-xs text-slate-500",children:"Manage returns to suppliers, from customers, and internal adjustments."})]}),r.jsxs(Te,{size:"sm",className:"gap-1",onClick:()=>he(!0),children:[r.jsx(ps,{className:"w-3 h-3"}),"New return"]})]}),r.jsx(He,{children:r.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[r.jsxs("div",{className:"grid grid-cols-[1.1fr,1.2fr,1.2fr,0.9fr,0.9fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[r.jsx("span",{children:"Return no."}),r.jsx("span",{children:"Type / supplier"}),r.jsx("span",{children:"Location / reason"}),r.jsx("span",{children:"Status"}),r.jsx("span",{className:"text-right",children:"Actions"})]}),r.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:G?r.jsxs("div",{className:"p-3 space-y-2",children:[r.jsx(We,{className:"h-7 w-full"}),r.jsx(We,{className:"h-7 w-full"}),r.jsx(We,{className:"h-7 w-full"})]}):H.length===0?r.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No returns recorded yet."}):H.map(Q=>{var ke,Le;return r.jsxs("div",{className:"grid grid-cols-[1.1fr,1.2fr,1.2fr,0.9fr,0.9fr] items-center px-3 py-2 text-xs",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-slate-900",children:Q.return_number}),r.jsxs("p",{className:"text-slate-500",children:["Date: ",rl(Q.return_date)]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-slate-900",children:Q.type.replace("_"," ")}),r.jsx("p",{className:"text-slate-500 text-[11px]",children:((ke=Q.supplier)==null?void 0:ke.name)||""})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-slate-900",children:(Le=Q.location)==null?void 0:Le.name}),r.jsx("p",{className:"text-slate-500 text-[11px]",children:Q.reason||""})]}),r.jsx("div",{children:r.jsx(Ze,{variant:"outline",className:"text-[10px] capitalize",children:Q.status.toLowerCase()})}),r.jsx("div",{className:"flex items-center justify-end gap-2",children:Q.status==="DRAFT"&&r.jsx(Te,{variant:"outline",size:"sm",className:"h-7 px-2 text-[11px]",onClick:()=>lf(Q.id),children:"Post return"})})]},Q.id)})})]})})]})}),r.jsx(us,{value:"txns",children:r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsx(rt,{className:"flex flex-row items-center justify-between",children:r.jsxs("div",{children:[r.jsxs(ot,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Stock transactions",r.jsx(Ze,{variant:"outline",className:"text-xs",children:ye.length})]}),r.jsx("p",{className:"text-xs text-slate-500",children:"Full audit trail of every stock movement (GRN, dispense, returns, adjustments)."})]})}),r.jsx(He,{children:r.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[r.jsxs("div",{className:"grid grid-cols-[1.1fr,1.4fr,1fr,1.1fr,0.9fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[r.jsx("span",{children:"Date / type"}),r.jsx("span",{children:"Item / batch"}),r.jsx("span",{children:"Location"}),r.jsx("span",{children:"Qty / cost"}),r.jsx("span",{children:"User / ref"})]}),r.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:ee?r.jsxs("div",{className:"p-3 space-y-2",children:[r.jsx(We,{className:"h-7 w-full"}),r.jsx(We,{className:"h-7 w-full"}),r.jsx(We,{className:"h-7 w-full"})]}):ye.length===0?r.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No stock transactions yet."}):ye.map(Q=>r.jsxs("div",{className:"grid grid-cols-[1.1fr,1.4fr,1fr,1.1fr,0.9fr] items-center px-3 py-2 text-xs",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-slate-900",children:rl(Q.txn_time)}),r.jsxs("p",{className:"text-slate-500",children:[Q.txn_type," ",Q.ref_display?` ${Q.ref_display}`:Q.ref_type&&Q.ref_id?` ${Q.ref_type} #${Q.ref_id}`:""]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-slate-900",children:Q.item_name||`Item #${Q.item_id}`}),r.jsxs("p",{className:"text-slate-500 text-[11px]",children:[Q.item_code&&r.jsxs("span",{children:["Code: ",Q.item_code,"  "]}),"Batch:"," ",Q.batch_no?Q.batch_no:Q.batch_id?`#${Q.batch_id}`:""]})]}),r.jsx("div",{className:"text-slate-700",children:Q.location_name||(Q.location_id?`Location #${Q.location_id}`:"")}),r.jsxs("div",{children:[r.jsxs("p",{className:"text-slate-900",children:["Qty: ",Hr(Q.quantity_change)]}),r.jsxs("p",{className:"text-slate-500 text-[11px]",children:["Rate: ",Hr(Q.unit_cost),"  MRP: ",Hr(Q.mrp)]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-slate-900 text-[11px]",children:Q.user_name||(Q.user_id?`User #${Q.user_id}`:"System")}),r.jsx("p",{className:"text-slate-500 text-[11px]",children:Q.ref_display||(Q.ref_type&&Q.ref_id?`${Q.ref_type} #${Q.ref_id}`:"")})]})]},Q.id))})]})})]})})]}),r.jsx(Wd,{open:fe,onOpenChange:pe,children:r.jsxs(Ic,{className:"max-w-2xl",children:[r.jsxs(Mc,{children:[r.jsx(Oc,{className:"text-base font-semibold",children:oe?"Edit item":"New item"}),r.jsx(Rc,{className:"text-xs",children:"Maintain medicine / consumable master details, including LASA flag and stock thresholds."})]}),r.jsxs("form",{onSubmit:Xn,className:"space-y-4",children:[r.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"code",children:"Code"}),r.jsx(Se,{id:"code",name:"code",defaultValue:(oe==null?void 0:oe.code)||"",required:!0})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"qr_number",children:"Barcode number (scan code)"}),r.jsx(Se,{id:"qr_number",name:"qr_number",placeholder:"Leave blank to auto-generate",defaultValue:(oe==null?void 0:oe.qr_number)||""}),r.jsx("p",{className:"text-[11px] text-slate-400 mt-0.5",children:"Optional. Empty =system will create MD_XXXX."})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"name",children:"Name (brand)"}),r.jsx(Se,{id:"name",name:"name",defaultValue:(oe==null?void 0:oe.name)||"",required:!0})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"generic_name",children:"Generic name"}),r.jsx(Se,{id:"generic_name",name:"generic_name",defaultValue:(oe==null?void 0:oe.generic_name)||""})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"form",children:"Form"}),r.jsx(Se,{id:"form",name:"form",placeholder:"tablet / capsule / syrup...",defaultValue:(oe==null?void 0:oe.form)||""})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"strength",children:"Strength"}),r.jsx(Se,{id:"strength",name:"strength",placeholder:"500 mg / 5 mg/ml",defaultValue:(oe==null?void 0:oe.strength)||""})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"unit",children:"Unit"}),r.jsx(Se,{id:"unit",name:"unit",placeholder:"tablet / ml / vial",defaultValue:(oe==null?void 0:oe.unit)||"tablet"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"pack_size",children:"Pack size"}),r.jsx(Se,{id:"pack_size",name:"pack_size",defaultValue:(oe==null?void 0:oe.pack_size)||"10"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"manufacturer",children:"Manufacturer"}),r.jsx(Se,{id:"manufacturer",name:"manufacturer",defaultValue:(oe==null?void 0:oe.manufacturer)||""})]})]}),r.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"default_price",children:"Default price"}),r.jsx(Se,{id:"default_price",name:"default_price",type:"number",step:"0.01",defaultValue:(oe==null?void 0:oe.default_price)||""})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"default_mrp",children:"Default MRP"}),r.jsx(Se,{id:"default_mrp",name:"default_mrp",type:"number",step:"0.01",defaultValue:(oe==null?void 0:oe.default_mrp)||""})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"default_tax_percent",children:"Tax %"}),r.jsx(Se,{id:"default_tax_percent",name:"default_tax_percent",type:"number",step:"0.01",defaultValue:(oe==null?void 0:oe.default_tax_percent)||""})]})]}),r.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"reorder_level",children:"Reorder level"}),r.jsx(Se,{id:"reorder_level",name:"reorder_level",type:"number",step:"0.01",defaultValue:(oe==null?void 0:oe.reorder_level)||""})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"max_level",children:"Max level"}),r.jsx(Se,{id:"max_level",name:"max_level",type:"number",step:"0.01",defaultValue:(oe==null?void 0:oe.max_level)||""})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"class_name",children:"Therapeutic class"}),r.jsx(Se,{id:"class_name",name:"class_name",defaultValue:(oe==null?void 0:oe.class_name)||""})]})]}),r.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"atc_code",children:"ATC code"}),r.jsx(Se,{id:"atc_code",name:"atc_code",defaultValue:(oe==null?void 0:oe.atc_code)||""})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"hsn_code",children:"HSN code"}),r.jsx(Se,{id:"hsn_code",name:"hsn_code",defaultValue:(oe==null?void 0:oe.hsn_code)||""})]}),r.jsxs("div",{className:"flex items-center gap-4 mt-6 text-xs",children:[r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",name:"is_consumable",defaultChecked:oe==null?void 0:oe.is_consumable,className:"rounded border-slate-300"}),"Consumable"]}),r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",name:"lasa_flag",defaultChecked:oe==null?void 0:oe.lasa_flag,className:"rounded border-slate-300"}),"LASA (Look-alike / Sound-alike)"]})]})]}),r.jsxs(Dc,{className:"flex justify-between",children:[r.jsx(Te,{type:"button",variant:"outline",onClick:()=>pe(!1),children:"Cancel"}),r.jsx(Te,{type:"submit",children:oe?"Save changes":"Create item"})]})]})]})}),r.jsx(Wd,{open:Xe,onOpenChange:jt,children:r.jsxs(Ic,{children:[r.jsxs(Mc,{children:[r.jsx(Oc,{className:"text-base font-semibold",children:"Bulk upload items (CSV)"}),r.jsx(Rc,{className:"text-xs",children:"Download the sample template, fill with medicines / consumables, then upload here. Existing codes will be updated."})]}),r.jsxs("form",{onSubmit:An,className:"space-y-4",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"file",children:"CSV file"}),r.jsx(Se,{id:"file",name:"file",type:"file",accept:".csv",required:!0,className:"bg-white"})]}),r.jsxs(Dc,{className:"flex justify-between",children:[r.jsx(Te,{type:"button",variant:"outline",onClick:()=>jt(!1),children:"Cancel"}),r.jsxs(Te,{type:"submit",className:"gap-1",children:[r.jsx(I_,{className:"w-3 h-3"}),"Upload CSV"]})]})]})]})}),r.jsx(Wd,{open:Rt,onOpenChange:Jt,children:r.jsxs(Ic,{className:"max-w-md",children:[r.jsxs(Mc,{children:[r.jsx(Oc,{className:"text-base font-semibold",children:ys?"Edit location":"New location"}),r.jsx(Rc,{className:"text-xs",children:"Define pharmacy / store location used for stock and GRN posting."})]}),r.jsxs("form",{onSubmit:cc,className:"space-y-4",children:[r.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"loc_code",children:"Code"}),r.jsx(Se,{id:"loc_code",name:"code",defaultValue:(ys==null?void 0:ys.code)||"",placeholder:"PHARM1 / MAIN"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"loc_name",children:"Name"}),r.jsx(Se,{id:"loc_name",name:"name",required:!0,defaultValue:(ys==null?void 0:ys.name)||"",placeholder:"Main Pharmacy"})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"loc_desc",children:"Description"}),r.jsx(Se,{id:"loc_desc",name:"description",defaultValue:(ys==null?void 0:ys.description)||"",placeholder:"Optional description"})]}),r.jsxs(Dc,{className:"flex justify-between",children:[r.jsx(Te,{type:"button",variant:"outline",onClick:()=>Jt(!1),children:"Cancel"}),r.jsx(Te,{type:"submit",children:ys?"Save changes":"Create location"})]})]})]})}),r.jsx(Wd,{open:na,onOpenChange:qt,children:r.jsxs(Ic,{className:"max-w-xl",children:[r.jsxs(Mc,{children:[r.jsx(Oc,{className:"text-base font-semibold",children:Gt?"Edit supplier":"New supplier"}),r.jsx(Rc,{className:"text-xs",children:"Vendor details used for purchase orders, GRNs, and returns."})]}),r.jsxs("form",{onSubmit:Ed,className:"space-y-4",children:[r.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"sup_code",children:"Code"}),r.jsx(Se,{id:"sup_code",name:"code",defaultValue:(Gt==null?void 0:Gt.code)||"",placeholder:"SUPP001"})]}),r.jsxs("div",{className:"space-y-1.5 sm:col-span-2",children:[r.jsx(Qe,{htmlFor:"sup_name",children:"Name"}),r.jsx(Se,{id:"sup_name",name:"name",required:!0,defaultValue:(Gt==null?void 0:Gt.name)||"",placeholder:"ABC Pharma Distributors"})]})]}),r.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"sup_contact_person",children:"Contact person"}),r.jsx(Se,{id:"sup_contact_person",name:"contact_person",defaultValue:(Gt==null?void 0:Gt.contact_person)||""})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"sup_phone",children:"Phone"}),r.jsx(Se,{id:"sup_phone",name:"phone",defaultValue:(Gt==null?void 0:Gt.phone)||""})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"sup_email",children:"Email"}),r.jsx(Se,{id:"sup_email",type:"email",name:"email",defaultValue:(Gt==null?void 0:Gt.email)||""})]})]}),r.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"sup_gst",children:"GST number"}),r.jsx(Se,{id:"sup_gst",name:"gst_number",defaultValue:(Gt==null?void 0:Gt.gst_number)||""})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{htmlFor:"sup_address",children:"Address"}),r.jsx(Se,{id:"sup_address",name:"address",defaultValue:(Gt==null?void 0:Gt.address)||"",placeholder:"City / area / address"})]})]}),r.jsxs(Dc,{className:"flex justify-between",children:[r.jsx(Te,{type:"button",variant:"outline",onClick:()=>qt(!1),children:"Cancel"}),r.jsx(Te,{type:"submit",children:Gt?"Save changes":"Create supplier"})]})]})]})}),r.jsx(hy,{open:ft,onOpenChange:it,children:r.jsxs(yp,{className:"w-full sm:max-w-xl overflow-y-auto",children:[r.jsxs(bp,{className:"mb-4",children:[r.jsx(vp,{className:"text-base font-semibold",children:"New Purchase Order"}),r.jsx(Np,{className:"text-xs",children:"Select supplier & location, then add items with quantities and pricing."})]}),r.jsxs("form",{onSubmit:dc,className:"space-y-4 pb-6",children:[r.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{children:"Supplier"}),r.jsxs(Fs,{value:ae.supplier_id,onValueChange:Q=>xe(ke=>({...ke,supplier_id:Q})),children:[r.jsx(Ds,{className:"bg-white",children:r.jsx($s,{placeholder:"Select supplier"})}),r.jsx(Os,{children:i.map(Q=>r.jsx(zt,{value:String(Q.id),children:Q.name},Q.id))})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{children:"Location"}),r.jsxs(Fs,{value:ae.location_id,onValueChange:Q=>xe(ke=>({...ke,location_id:Q})),children:[r.jsx(Ds,{className:"bg-white",children:r.jsx($s,{placeholder:"Select location"})}),r.jsx(Os,{children:n.map(Q=>r.jsx(zt,{value:String(Q.id),children:Q.name},Q.id))})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{children:"Expected date"}),r.jsx(Se,{type:"date",value:ae.expected_date,onChange:Q=>xe(ke=>({...ke,expected_date:Q.target.value}))})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{children:"Notes"}),r.jsx(Se,{placeholder:"Any special instructions",value:ae.notes,onChange:Q=>xe(ke=>({...ke,notes:Q.target.value}))})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(Qe,{children:"Line items"}),r.jsxs(Te,{type:"button",size:"sm",variant:"outline",className:"gap-1",onClick:ks,children:[r.jsx(ps,{className:"w-3 h-3"}),"Add line"]})]}),_t.length===0?r.jsx("p",{className:"text-xs text-slate-500",children:"No lines yet. Click Add line to start."}):r.jsx("div",{className:"space-y-2 max-h-[260px] overflow-auto pr-1",children:_t.map((Q,ke)=>r.jsxs("div",{className:"grid gap-2 rounded-xl border border-slate-200 p-2 sm:grid-cols-[1.6fr,0.8fr,0.8fr,0.8fr,0.4fr]",children:[r.jsxs(Fs,{value:Q.item_id?String(Q.item_id):"",onValueChange:Le=>el(ke,"item_id",Le),children:[r.jsx(Ds,{className:"bg-white h-8",children:r.jsx($s,{placeholder:"Item"})}),r.jsx(Os,{children:o.map(Le=>r.jsx(zt,{value:String(Le.id),children:Le.name},Le.id))})]}),r.jsx(Se,{type:"number",min:"0",step:"0.01",className:"h-8",placeholder:"Qty",value:Q.ordered_qty,onChange:Le=>el(ke,"ordered_qty",Le.target.value)}),r.jsx(Se,{type:"number",min:"0",step:"0.01",className:"h-8",placeholder:"Rate",value:Q.unit_cost,onChange:Le=>el(ke,"unit_cost",Le.target.value)}),r.jsx(Se,{type:"number",min:"0",step:"0.01",className:"h-8",placeholder:"Tax %",value:Q.tax_percent,onChange:Le=>el(ke,"tax_percent",Le.target.value)}),r.jsx(Te,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>Ga(ke),children:""})]},ke))})]}),r.jsxs("div",{className:"flex justify-between pt-2",children:[r.jsx(Te,{type:"button",variant:"outline",onClick:()=>it(!1),children:"Cancel"}),r.jsx(Te,{type:"submit",children:"Create PO"})]})]})]})}),r.jsx(Wd,{open:je.open,onOpenChange:Q=>Fe(ke=>({...ke,open:Q})),children:r.jsxs(Ic,{children:[r.jsxs(Mc,{children:[r.jsx(Oc,{className:"text-base font-semibold",children:"Mark PO as sent"}),r.jsx(Rc,{className:"text-xs",children:"Enter supplier email used to send PO PDF. This will be stored in PO history."})]}),r.jsxs("form",{onSubmit:Ps,className:"space-y-4",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{children:"Email"}),r.jsx(Se,{type:"email",value:je.email,onChange:Q=>Fe(ke=>({...ke,email:Q.target.value})),required:!0})]}),r.jsxs(Dc,{className:"flex justify-between",children:[r.jsx(Te,{type:"button",variant:"outline",onClick:()=>Fe({open:!1,poId:null,email:""}),children:"Cancel"}),r.jsxs(Te,{type:"submit",className:"gap-1",children:[r.jsx(dm,{className:"w-3 h-3"}),"Mark as sent"]})]})]})]})}),r.jsx(hy,{open:Ct,onOpenChange:vt,children:r.jsxs(yp,{className:"w-full sm:max-w-xl overflow-y-auto",children:[r.jsxs(bp,{className:"mb-4",children:[r.jsx(vp,{className:"text-base font-semibold",children:"New GRN (DRAFT)"}),r.jsx(Np,{className:"text-xs",children:"Capture invoice details, batch numbers, and quantities. Post later to update stock."})]}),r.jsxs("form",{onSubmit:ls,className:"space-y-4 pb-6",children:[r.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{children:"Supplier"}),r.jsxs(Fs,{value:pt.supplier_id,onValueChange:Q=>Ns(ke=>({...ke,supplier_id:Q})),children:[r.jsx(Ds,{className:"bg-white",children:r.jsx($s,{placeholder:"Select supplier"})}),r.jsx(Os,{children:i.map(Q=>r.jsx(zt,{value:String(Q.id),children:Q.name},Q.id))})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{children:"Location"}),r.jsxs(Fs,{value:pt.location_id,onValueChange:Q=>Ns(ke=>({...ke,location_id:Q})),children:[r.jsx(Ds,{className:"bg-white",children:r.jsx($s,{placeholder:"Select location"})}),r.jsx(Os,{children:n.map(Q=>r.jsx(zt,{value:String(Q.id),children:Q.name},Q.id))})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{children:"Invoice number"}),r.jsx(Se,{value:pt.invoice_number,onChange:Q=>Ns(ke=>({...ke,invoice_number:Q.target.value}))})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{children:"Invoice date"}),r.jsx(Se,{type:"date",value:pt.invoice_date,onChange:Q=>Ns(ke=>({...ke,invoice_date:Q.target.value}))})]}),r.jsxs("div",{className:"sm:col-span-2 space-y-1.5",children:[r.jsx(Qe,{children:"Notes"}),r.jsx(Se,{value:pt.notes,onChange:Q=>Ns(ke=>({...ke,notes:Q.target.value}))})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(Qe,{children:"Line items"}),r.jsxs(Te,{type:"button",size:"sm",variant:"outline",className:"gap-1",onClick:Fn,children:[r.jsx(ps,{className:"w-3 h-3"}),"Add line"]})]}),ds.length===0?r.jsx("p",{className:"text-xs text-slate-500",children:"No lines yet. Click Add line to add received batches."}):r.jsx("div",{className:"space-y-2 max-h-[260px] overflow-auto pr-1",children:ds.map((Q,ke)=>r.jsxs("div",{className:"grid gap-2 rounded-xl border border-slate-200 p-2 sm:grid-cols-[1.6fr,1fr,0.8fr,0.8fr,0.8fr,0.4fr]",children:[r.jsxs(Fs,{value:Q.item_id?String(Q.item_id):"",onValueChange:Le=>Il(ke,"item_id",Le),children:[r.jsx(Ds,{className:"bg-white h-8",children:r.jsx($s,{placeholder:"Item"})}),r.jsx(Os,{children:o.map(Le=>r.jsx(zt,{value:String(Le.id),children:Le.name},Le.id))})]}),r.jsx(Se,{className:"h-8",placeholder:"Batch no.",value:Q.batch_no,onChange:Le=>Il(ke,"batch_no",Le.target.value)}),r.jsx(Se,{type:"date",className:"h-8",value:Q.expiry_date,onChange:Le=>Il(ke,"expiry_date",Le.target.value)}),r.jsx(Se,{type:"number",min:"0",step:"0.01",className:"h-8",placeholder:"Qty",value:Q.quantity,onChange:Le=>Il(ke,"quantity",Le.target.value)}),r.jsx(Se,{type:"number",min:"0",step:"0.01",className:"h-8",placeholder:"Rate",value:Q.unit_cost,onChange:Le=>Il(ke,"unit_cost",Le.target.value)}),r.jsx(Te,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>ut(ke),children:""})]},ke))})]}),r.jsxs("div",{className:"flex justify-between pt-2",children:[r.jsx(Te,{type:"button",variant:"outline",onClick:()=>vt(!1),children:"Cancel"}),r.jsx(Te,{type:"submit",children:"Create GRN (DRAFT)"})]})]})]})}),r.jsx(hy,{open:Ie,onOpenChange:he,children:r.jsxs(yp,{className:"w-full sm:max-w-xl overflow-y-auto",children:[r.jsxs(bp,{className:"mb-4",children:[r.jsx(vp,{className:"text-base font-semibold",children:"New Return (DRAFT)"}),r.jsx(Np,{className:"text-xs",children:"Choose return type (to supplier / from customer / internal), and specify items & quantities."})]}),r.jsxs("form",{onSubmit:cn,className:"space-y-4 pb-6",children:[r.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{children:"Return type"}),r.jsxs(Fs,{value:Me.type,onValueChange:Q=>Ge(ke=>({...ke,type:Q})),children:[r.jsx(Ds,{className:"bg-white",children:r.jsx($s,{})}),r.jsxs(Os,{children:[r.jsx(zt,{value:"TO_SUPPLIER",children:"To Supplier"}),r.jsx(zt,{value:"FROM_CUSTOMER",children:"From Customer"}),r.jsx(zt,{value:"INTERNAL",children:"Internal"})]})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{children:"Location"}),r.jsxs(Fs,{value:Me.location_id,onValueChange:Q=>Ge(ke=>({...ke,location_id:Q})),children:[r.jsx(Ds,{className:"bg-white",children:r.jsx($s,{placeholder:"Select location"})}),r.jsx(Os,{children:n.map(Q=>r.jsx(zt,{value:String(Q.id),children:Q.name},Q.id))})]})]}),Me.type==="TO_SUPPLIER"&&r.jsxs("div",{className:"space-y-1.5 sm:col-span-2",children:[r.jsx(Qe,{children:"Supplier (for return)"}),r.jsxs(Fs,{value:Me.supplier_id,onValueChange:Q=>Ge(ke=>({...ke,supplier_id:Q})),children:[r.jsx(Ds,{className:"bg-white",children:r.jsx($s,{placeholder:"Select supplier"})}),r.jsx(Os,{children:i.map(Q=>r.jsx(zt,{value:String(Q.id),children:Q.name},Q.id))})]})]}),r.jsxs("div",{className:"space-y-1.5 sm:col-span-2",children:[r.jsx(Qe,{children:"Reason"}),r.jsx(Se,{value:Me.reason,onChange:Q=>Ge(ke=>({...ke,reason:Q.target.value}))})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(Qe,{children:"Line items"}),r.jsxs(Te,{type:"button",size:"sm",variant:"outline",className:"gap-1",onClick:Td,children:[r.jsx(ps,{className:"w-3 h-3"}),"Add line"]})]}),Be.length===0?r.jsx("p",{className:"text-xs text-slate-500",children:"No lines yet. Click Add line or use Create return from Expired / Quarantine batches."}):r.jsx("div",{className:"space-y-2 max-h-[260px] overflow-auto pr-1",children:Be.map((Q,ke)=>r.jsxs("div",{className:"grid gap-2 rounded-xl border border-slate-200 p-2 sm:grid-cols-[1.6fr,1fr,0.8fr,0.8fr,0.4fr]",children:[r.jsxs(Fs,{value:Q.item_id?String(Q.item_id):"",onValueChange:Le=>Ws(ke,"item_id",Le),children:[r.jsx(Ds,{className:"bg-white h-8",children:r.jsx($s,{placeholder:"Item"})}),r.jsx(Os,{children:o.map(Le=>r.jsx(zt,{value:String(Le.id),children:Le.name},Le.id))})]}),r.jsx(Se,{className:"h-8",placeholder:"Batch no.",value:Q.batch_no||"",onChange:Le=>Ws(ke,"batch_no",Le.target.value)}),r.jsx(Se,{type:"number",min:"0",step:"0.01",className:"h-8",placeholder:"Qty",value:Q.quantity,onChange:Le=>Ws(ke,"quantity",Le.target.value)}),r.jsx(Se,{className:"h-8",placeholder:"Reason",value:Q.reason,onChange:Le=>Ws(ke,"reason",Le.target.value)}),r.jsx(Te,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>Ml(ke),children:""})]},ke))})]}),r.jsxs("div",{className:"flex justify-between pt-2",children:[r.jsx(Te,{type:"button",variant:"outline",onClick:()=>he(!1),children:"Cancel"}),r.jsx(Te,{type:"submit",children:"Create Return (DRAFT)"})]})]})]})})]})}var gt;(function(t){t[t.QR_CODE=0]="QR_CODE",t[t.AZTEC=1]="AZTEC",t[t.CODABAR=2]="CODABAR",t[t.CODE_39=3]="CODE_39",t[t.CODE_93=4]="CODE_93",t[t.CODE_128=5]="CODE_128",t[t.DATA_MATRIX=6]="DATA_MATRIX",t[t.MAXICODE=7]="MAXICODE",t[t.ITF=8]="ITF",t[t.EAN_13=9]="EAN_13",t[t.EAN_8=10]="EAN_8",t[t.PDF_417=11]="PDF_417",t[t.RSS_14=12]="RSS_14",t[t.RSS_EXPANDED=13]="RSS_EXPANDED",t[t.UPC_A=14]="UPC_A",t[t.UPC_E=15]="UPC_E",t[t.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(gt||(gt={}));var t6=new Map([[gt.QR_CODE,"QR_CODE"],[gt.AZTEC,"AZTEC"],[gt.CODABAR,"CODABAR"],[gt.CODE_39,"CODE_39"],[gt.CODE_93,"CODE_93"],[gt.CODE_128,"CODE_128"],[gt.DATA_MATRIX,"DATA_MATRIX"],[gt.MAXICODE,"MAXICODE"],[gt.ITF,"ITF"],[gt.EAN_13,"EAN_13"],[gt.EAN_8,"EAN_8"],[gt.PDF_417,"PDF_417"],[gt.RSS_14,"RSS_14"],[gt.RSS_EXPANDED,"RSS_EXPANDED"],[gt.UPC_A,"UPC_A"],[gt.UPC_E,"UPC_E"],[gt.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),s6;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.URL=1]="URL"})(s6||(s6={}));function jLe(t){return Object.values(gt).includes(t)}var ud;(function(t){t[t.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",t[t.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(ud||(ud={}));var cl=function(){function t(){}return t.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",t.SCAN_DEFAULT_FPS=2,t.DEFAULT_DISABLE_FLIP=!1,t.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,t.DEFAULT_SUPPORTED_SCAN_TYPE=[ud.SCAN_TYPE_CAMERA,ud.SCAN_TYPE_FILE],t}(),HK=function(){function t(s,n){this.format=s,this.formatName=n}return t.prototype.toString=function(){return this.formatName},t.create=function(s){if(!t6.has(s))throw"".concat(s," not in html5QrcodeSupportedFormatsTextMap");return new t(s,t6.get(s))},t}(),n6=function(){function t(){}return t.createFromText=function(s){var n={text:s};return{decodedText:s,result:n}},t.createFromQrcodeResult=function(s){return{decodedText:s.text,result:s}},t}(),DC;(function(t){t[t.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",t[t.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",t[t.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(DC||(DC={}));var WK=function(){function t(){}return t.createFrom=function(s){return{errorMessage:s,type:DC.UNKWOWN_ERROR}},t}(),qK=function(){function t(s){this.verbose=s}return t.prototype.log=function(s){this.verbose&&console.log(s)},t.prototype.warn=function(s){this.verbose&&console.warn(s)},t.prototype.logError=function(s,n){(this.verbose||n===!0)&&console.error(s)},t.prototype.logErrors=function(s){if(s.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(s)},t}();function Wl(t){return typeof t>"u"||t===null}function _Le(t,s,n){return t>n?n:t<s?s:t}var Fh=function(){function t(){}return t.codeParseError=function(s){return"QR code parse error, error = ".concat(s)},t.errorGettingUserMedia=function(s){return"Error getting userMedia, error = ".concat(s)},t.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},t.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},t.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},t.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},t.scannerPaused=function(){return"Scanner paused"},t}(),js=function(){function t(){}return t.scanningStatus=function(){return"Scanning"},t.idleStatus=function(){return"Idle"},t.errorStatus=function(){return"Error"},t.permissionStatus=function(){return"Permission"},t.noCameraFoundErrorStatus=function(){return"No Cameras"},t.lastMatch=function(s){return"Last Match: ".concat(s)},t.codeScannerTitle=function(){return"Code Scanner"},t.cameraPermissionTitle=function(){return"Request Camera Permissions"},t.cameraPermissionRequesting=function(){return"Requesting camera permissions..."},t.noCameraFound=function(){return"No camera found"},t.scanButtonStopScanningText=function(){return"Stop Scanning"},t.scanButtonStartScanningText=function(){return"Start Scanning"},t.torchOnButton=function(){return"Switch On Torch"},t.torchOffButton=function(){return"Switch Off Torch"},t.torchOnFailedMessage=function(){return"Failed to turn on torch"},t.torchOffFailedMessage=function(){return"Failed to turn off torch"},t.scanButtonScanningStarting=function(){return"Launching Camera..."},t.textIfCameraScanSelected=function(){return"Scan an Image File"},t.textIfFileScanSelected=function(){return"Scan using camera directly"},t.selectCamera=function(){return"Select Camera"},t.fileSelectionChooseImage=function(){return"Choose Image"},t.fileSelectionChooseAnother=function(){return"Choose Another"},t.fileSelectionNoImageSelected=function(){return"No image choosen"},t.anonymousCameraPrefix=function(){return"Anonymous Camera"},t.dragAndDropMessage=function(){return"Or drop an image to scan"},t.dragAndDropMessageOnlyImages=function(){return"Or drop an image to scan (other files not supported)"},t.zoom=function(){return"zoom"},t.loadingImage=function(){return"Loading image..."},t.cameraScanAltText=function(){return"Camera based scan"},t.fileScanAltText=function(){return"Fule based scan"},t}(),r6=function(){function t(){}return t.poweredBy=function(){return"Powered by "},t.reportIssues=function(){return"Report issues"},t}(),GK=function(){function t(){}return t.isMediaStreamConstraintsValid=function(s,n){if(typeof s!="object"){var a=typeof s;return n.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(a,"."),!0),!1}for(var i=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],l=new Set(i),o=Object.keys(s),c=0,d=o;c<d.length;c++){var u=d[c];if(l.has(u))return n.logError("".concat(u," is not supported videoConstaints."),!0),!1}return!0},t}(),OC={exports:{}};(function(t,s){(function(n,a){a(s)})(gf,function(n){function a(K){return K==null}var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(K,m){K.__proto__=m}||function(K,m){for(var p in m)m.hasOwnProperty(p)&&(K[p]=m[p])};function l(K,m){i(K,m);function p(){this.constructor=K}K.prototype=m===null?Object.create(m):(p.prototype=m.prototype,new p)}function o(K,m){var p=Object.setPrototypeOf;p?p(K,m):K.__proto__=m}function c(K,m){m===void 0&&(m=K.constructor);var p=Error.captureStackTrace;p&&p(K,m)}var d=function(K){l(m,K);function m(p){var g=this.constructor,N=K.call(this,p)||this;return Object.defineProperty(N,"name",{value:g.name,enumerable:!1}),o(N,g.prototype),c(N),N}return m}(Error);class u extends d{constructor(m=void 0){super(m),this.message=m}getKind(){return this.constructor.kind}}u.kind="Exception";class h extends u{}h.kind="ArgumentException";class f extends u{}f.kind="IllegalArgumentException";class x{constructor(m){if(this.binarizer=m,m===null)throw new f("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(m,p){return this.binarizer.getBlackRow(m,p)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(m,p,g,N){const j=this.binarizer.getLuminanceSource().crop(m,p,g,N);return new x(this.binarizer.createBinarizer(j))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const m=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new x(this.binarizer.createBinarizer(m))}rotateCounterClockwise45(){const m=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new x(this.binarizer.createBinarizer(m))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class b extends u{static getChecksumInstance(){return new b}}b.kind="ChecksumException";class v{constructor(m){this.source=m}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class w{static arraycopy(m,p,g,N,j){for(;j--;)g[N++]=m[p++]}static currentTimeMillis(){return Date.now()}}class _ extends u{}_.kind="IndexOutOfBoundsException";class S extends _{constructor(m=void 0,p=void 0){super(p),this.index=m,this.message=p}}S.kind="ArrayIndexOutOfBoundsException";class k{static fill(m,p){for(let g=0,N=m.length;g<N;g++)m[g]=p}static fillWithin(m,p,g,N){k.rangeCheck(m.length,p,g);for(let j=p;j<g;j++)m[j]=N}static rangeCheck(m,p,g){if(p>g)throw new f("fromIndex("+p+") > toIndex("+g+")");if(p<0)throw new S(p);if(g>m)throw new S(g)}static asList(...m){return m}static create(m,p,g){return Array.from({length:m}).map(j=>Array.from({length:p}).fill(g))}static createInt32Array(m,p,g){return Array.from({length:m}).map(j=>Int32Array.from({length:p}).fill(g))}static equals(m,p){if(!m||!p||!m.length||!p.length||m.length!==p.length)return!1;for(let g=0,N=m.length;g<N;g++)if(m[g]!==p[g])return!1;return!0}static hashCode(m){if(m===null)return 0;let p=1;for(const g of m)p=31*p+g;return p}static fillUint8Array(m,p){for(let g=0;g!==m.length;g++)m[g]=p}static copyOf(m,p){return m.slice(0,p)}static copyOfUint8Array(m,p){if(m.length<=p){const g=new Uint8Array(p);return g.set(m),g}return m.slice(0,p)}static copyOfRange(m,p,g){const N=g-p,j=new Int32Array(N);return w.arraycopy(m,p,j,0,N),j}static binarySearch(m,p,g){g===void 0&&(g=k.numberComparator);let N=0,j=m.length-1;for(;N<=j;){const C=j+N>>1,E=g(p,m[C]);if(E>0)N=C+1;else if(E<0)j=C-1;else return C}return-N-1}static numberComparator(m,p){return m-p}}class A{static numberOfTrailingZeros(m){let p;if(m===0)return 32;let g=31;return p=m<<16,p!==0&&(g-=16,m=p),p=m<<8,p!==0&&(g-=8,m=p),p=m<<4,p!==0&&(g-=4,m=p),p=m<<2,p!==0&&(g-=2,m=p),g-(m<<1>>>31)}static numberOfLeadingZeros(m){if(m===0)return 32;let p=1;return m>>>16||(p+=16,m<<=16),m>>>24||(p+=8,m<<=8),m>>>28||(p+=4,m<<=4),m>>>30||(p+=2,m<<=2),p-=m>>>31,p}static toHexString(m){return m.toString(16)}static toBinaryString(m){return String(parseInt(String(m),2))}static bitCount(m){return m=m-(m>>>1&1431655765),m=(m&858993459)+(m>>>2&858993459),m=m+(m>>>4)&252645135,m=m+(m>>>8),m=m+(m>>>16),m&63}static truncDivision(m,p){return Math.trunc(m/p)}static parseInt(m,p=void 0){return parseInt(m,p)}}A.MIN_VALUE_32_BITS=-2147483648,A.MAX_VALUE=Number.MAX_SAFE_INTEGER;class T{constructor(m,p){m===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=m,p==null?this.bits=T.makeArray(m):this.bits=p)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(m){if(m>this.bits.length*32){const p=T.makeArray(m);w.arraycopy(this.bits,0,p,0,this.bits.length),this.bits=p}}get(m){return(this.bits[Math.floor(m/32)]&1<<(m&31))!==0}set(m){this.bits[Math.floor(m/32)]|=1<<(m&31)}flip(m){this.bits[Math.floor(m/32)]^=1<<(m&31)}getNextSet(m){const p=this.size;if(m>=p)return p;const g=this.bits;let N=Math.floor(m/32),j=g[N];j&=~((1<<(m&31))-1);const C=g.length;for(;j===0;){if(++N===C)return p;j=g[N]}const E=N*32+A.numberOfTrailingZeros(j);return E>p?p:E}getNextUnset(m){const p=this.size;if(m>=p)return p;const g=this.bits;let N=Math.floor(m/32),j=~g[N];j&=~((1<<(m&31))-1);const C=g.length;for(;j===0;){if(++N===C)return p;j=~g[N]}const E=N*32+A.numberOfTrailingZeros(j);return E>p?p:E}setBulk(m,p){this.bits[Math.floor(m/32)]=p}setRange(m,p){if(p<m||m<0||p>this.size)throw new f;if(p===m)return;p--;const g=Math.floor(m/32),N=Math.floor(p/32),j=this.bits;for(let C=g;C<=N;C++){const E=C>g?0:m&31,U=(2<<(C<N?31:p&31))-(1<<E);j[C]|=U}}clear(){const m=this.bits.length,p=this.bits;for(let g=0;g<m;g++)p[g]=0}isRange(m,p,g){if(p<m||m<0||p>this.size)throw new f;if(p===m)return!0;p--;const N=Math.floor(m/32),j=Math.floor(p/32),C=this.bits;for(let E=N;E<=j;E++){const R=E>N?0:m&31,W=(2<<(E<j?31:p&31))-(1<<R)&4294967295;if((C[E]&W)!==(g?W:0))return!1}return!0}appendBit(m){this.ensureCapacity(this.size+1),m&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(m,p){if(p<0||p>32)throw new f("Num bits must be between 0 and 32");this.ensureCapacity(this.size+p);for(let g=p;g>0;g--)this.appendBit((m>>g-1&1)===1)}appendBitArray(m){const p=m.size;this.ensureCapacity(this.size+p);for(let g=0;g<p;g++)this.appendBit(m.get(g))}xor(m){if(this.size!==m.size)throw new f("Sizes don't match");const p=this.bits;for(let g=0,N=p.length;g<N;g++)p[g]^=m.bits[g]}toBytes(m,p,g,N){for(let j=0;j<N;j++){let C=0;for(let E=0;E<8;E++)this.get(m)&&(C|=1<<7-E),m++;p[g+j]=C}}getBitArray(){return this.bits}reverse(){const m=new Int32Array(this.bits.length),p=Math.floor((this.size-1)/32),g=p+1,N=this.bits;for(let j=0;j<g;j++){let C=N[j];C=C>>1&1431655765|(C&1431655765)<<1,C=C>>2&858993459|(C&858993459)<<2,C=C>>4&252645135|(C&252645135)<<4,C=C>>8&16711935|(C&16711935)<<8,C=C>>16&65535|(C&65535)<<16,m[p-j]=C}if(this.size!==g*32){const j=g*32-this.size;let C=m[0]>>>j;for(let E=1;E<g;E++){const R=m[E];C|=R<<32-j,m[E-1]=C,C=R>>>j}m[g-1]=C}this.bits=m}static makeArray(m){return new Int32Array(Math.floor((m+31)/32))}equals(m){if(!(m instanceof T))return!1;const p=m;return this.size===p.size&&k.equals(this.bits,p.bits)}hashCode(){return 31*this.size+k.hashCode(this.bits)}toString(){let m="";for(let p=0,g=this.size;p<g;p++)p&7||(m+=" "),m+=this.get(p)?"X":".";return m}clone(){return new T(this.size,this.bits.slice())}}var P;(function(K){K[K.OTHER=0]="OTHER",K[K.PURE_BARCODE=1]="PURE_BARCODE",K[K.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",K[K.TRY_HARDER=3]="TRY_HARDER",K[K.CHARACTER_SET=4]="CHARACTER_SET",K[K.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",K[K.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",K[K.ASSUME_GS1=7]="ASSUME_GS1",K[K.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",K[K.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",K[K.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(P||(P={}));var O=P;class D extends u{static getFormatInstance(){return new D}}D.kind="FormatException";var I;(function(K){K[K.Cp437=0]="Cp437",K[K.ISO8859_1=1]="ISO8859_1",K[K.ISO8859_2=2]="ISO8859_2",K[K.ISO8859_3=3]="ISO8859_3",K[K.ISO8859_4=4]="ISO8859_4",K[K.ISO8859_5=5]="ISO8859_5",K[K.ISO8859_6=6]="ISO8859_6",K[K.ISO8859_7=7]="ISO8859_7",K[K.ISO8859_8=8]="ISO8859_8",K[K.ISO8859_9=9]="ISO8859_9",K[K.ISO8859_10=10]="ISO8859_10",K[K.ISO8859_11=11]="ISO8859_11",K[K.ISO8859_13=12]="ISO8859_13",K[K.ISO8859_14=13]="ISO8859_14",K[K.ISO8859_15=14]="ISO8859_15",K[K.ISO8859_16=15]="ISO8859_16",K[K.SJIS=16]="SJIS",K[K.Cp1250=17]="Cp1250",K[K.Cp1251=18]="Cp1251",K[K.Cp1252=19]="Cp1252",K[K.Cp1256=20]="Cp1256",K[K.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",K[K.UTF8=22]="UTF8",K[K.ASCII=23]="ASCII",K[K.Big5=24]="Big5",K[K.GB18030=25]="GB18030",K[K.EUC_KR=26]="EUC_KR"})(I||(I={}));class M{constructor(m,p,g,...N){this.valueIdentifier=m,this.name=g,typeof p=="number"?this.values=Int32Array.from([p]):this.values=p,this.otherEncodingNames=N,M.VALUE_IDENTIFIER_TO_ECI.set(m,this),M.NAME_TO_ECI.set(g,this);const j=this.values;for(let C=0,E=j.length;C!==E;C++){const R=j[C];M.VALUES_TO_ECI.set(R,this)}for(const C of N)M.NAME_TO_ECI.set(C,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(m){if(m<0||m>=900)throw new D("incorect value");const p=M.VALUES_TO_ECI.get(m);if(p===void 0)throw new D("incorect value");return p}static getCharacterSetECIByName(m){const p=M.NAME_TO_ECI.get(m);if(p===void 0)throw new D("incorect value");return p}equals(m){if(!(m instanceof M))return!1;const p=m;return this.getName()===p.getName()}}M.VALUE_IDENTIFIER_TO_ECI=new Map,M.VALUES_TO_ECI=new Map,M.NAME_TO_ECI=new Map,M.Cp437=new M(I.Cp437,Int32Array.from([0,2]),"Cp437"),M.ISO8859_1=new M(I.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),M.ISO8859_2=new M(I.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),M.ISO8859_3=new M(I.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),M.ISO8859_4=new M(I.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),M.ISO8859_5=new M(I.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),M.ISO8859_6=new M(I.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),M.ISO8859_7=new M(I.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),M.ISO8859_8=new M(I.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),M.ISO8859_9=new M(I.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),M.ISO8859_10=new M(I.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),M.ISO8859_11=new M(I.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),M.ISO8859_13=new M(I.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),M.ISO8859_14=new M(I.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),M.ISO8859_15=new M(I.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),M.ISO8859_16=new M(I.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),M.SJIS=new M(I.SJIS,20,"SJIS","Shift_JIS"),M.Cp1250=new M(I.Cp1250,21,"Cp1250","windows-1250"),M.Cp1251=new M(I.Cp1251,22,"Cp1251","windows-1251"),M.Cp1252=new M(I.Cp1252,23,"Cp1252","windows-1252"),M.Cp1256=new M(I.Cp1256,24,"Cp1256","windows-1256"),M.UnicodeBigUnmarked=new M(I.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),M.UTF8=new M(I.UTF8,26,"UTF8","UTF-8"),M.ASCII=new M(I.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),M.Big5=new M(I.Big5,28,"Big5"),M.GB18030=new M(I.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),M.EUC_KR=new M(I.EUC_KR,30,"EUC_KR","EUC-KR");class B extends u{}B.kind="UnsupportedOperationException";class L{static decode(m,p){const g=this.encodingName(p);return this.customDecoder?this.customDecoder(m,g):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(g)?this.decodeFallback(m,g):new TextDecoder(g).decode(m)}static shouldDecodeOnFallback(m){return!L.isBrowser()&&m==="ISO-8859-1"}static encode(m,p){const g=this.encodingName(p);return this.customEncoder?this.customEncoder(m,g):typeof TextEncoder>"u"?this.encodeFallback(m):new TextEncoder().encode(m)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(m){return typeof m=="string"?m:m.getName()}static encodingCharacterSet(m){return m instanceof M?m:M.getCharacterSetECIByName(m)}static decodeFallback(m,p){const g=this.encodingCharacterSet(p);if(L.isDecodeFallbackSupported(g)){let N="";for(let j=0,C=m.length;j<C;j++){let E=m[j].toString(16);E.length<2&&(E="0"+E),N+="%"+E}return decodeURIComponent(N)}if(g.equals(M.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(m.buffer));throw new B(`Encoding ${this.encodingName(p)} not supported by fallback.`)}static isDecodeFallbackSupported(m){return m.equals(M.UTF8)||m.equals(M.ISO8859_1)||m.equals(M.ASCII)}static encodeFallback(m){const g=btoa(unescape(encodeURIComponent(m))).split(""),N=[];for(let j=0;j<g.length;j++)N.push(g[j].charCodeAt(0));return new Uint8Array(N)}}class F{static castAsNonUtf8Char(m,p=null){const g=p?p.getName():this.ISO88591;return L.decode(new Uint8Array([m]),g)}static guessEncoding(m,p){if(p!=null&&p.get(O.CHARACTER_SET)!==void 0)return p.get(O.CHARACTER_SET).toString();const g=m.length;let N=!0,j=!0,C=!0,E=0,R=0,U=0,W=0,Y=0,Z=0,le=0,be=0,Ne=0,Ae=0,Oe=0;const et=m.length>3&&m[0]===239&&m[1]===187&&m[2]===191;for(let st=0;st<g&&(N||j||C);st++){const Ye=m[st]&255;C&&(E>0?Ye&128?E--:C=!1:Ye&128&&(Ye&64?(E++,Ye&32?(E++,Ye&16?(E++,Ye&8?C=!1:W++):U++):R++):C=!1)),N&&(Ye>127&&Ye<160?N=!1:Ye>159&&(Ye<192||Ye===215||Ye===247)&&Oe++),j&&(Y>0?Ye<64||Ye===127||Ye>252?j=!1:Y--:Ye===128||Ye===160||Ye>239?j=!1:Ye>160&&Ye<224?(Z++,be=0,le++,le>Ne&&(Ne=le)):Ye>127?(Y++,le=0,be++,be>Ae&&(Ae=be)):(le=0,be=0))}return C&&E>0&&(C=!1),j&&Y>0&&(j=!1),C&&(et||R+U+W>0)?F.UTF8:j&&(F.ASSUME_SHIFT_JIS||Ne>=3||Ae>=3)?F.SHIFT_JIS:N&&j?Ne===2&&Z===2||Oe*10>=g?F.SHIFT_JIS:F.ISO88591:N?F.ISO88591:j?F.SHIFT_JIS:C?F.UTF8:F.PLATFORM_DEFAULT_ENCODING}static format(m,...p){let g=-1;function N(C,E,R,U,W,Y){if(C==="%%")return"%";if(p[++g]===void 0)return;C=U?parseInt(U.substr(1)):void 0;let Z=W?parseInt(W.substr(1)):void 0,le;switch(Y){case"s":le=p[g];break;case"c":le=p[g][0];break;case"f":le=parseFloat(p[g]).toFixed(C);break;case"p":le=parseFloat(p[g]).toPrecision(C);break;case"e":le=parseFloat(p[g]).toExponential(C);break;case"x":le=parseInt(p[g]).toString(Z||16);break;case"d":le=parseFloat(parseInt(p[g],Z||10).toPrecision(C)).toFixed(0);break}le=typeof le=="object"?JSON.stringify(le):(+le).toString(Z);let be=parseInt(R),Ne=R&&R[0]+""=="0"?"0":" ";for(;le.length<be;)le=E!==void 0?le+Ne:Ne+le;return le}let j=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return m.replace(j,N)}static getBytes(m,p){return L.encode(m,p)}static getCharCode(m,p=0){return m.charCodeAt(p)}static getCharAt(m){return String.fromCharCode(m)}}F.SHIFT_JIS=M.SJIS.getName(),F.GB2312="GB2312",F.ISO88591=M.ISO8859_1.getName(),F.EUC_JP="EUC_JP",F.UTF8=M.UTF8.getName(),F.PLATFORM_DEFAULT_ENCODING=F.UTF8,F.ASSUME_SHIFT_JIS=!1;class V{constructor(m=""){this.value=m}enableDecoding(m){return this.encoding=m,this}append(m){return typeof m=="string"?this.value+=m.toString():this.encoding?this.value+=F.castAsNonUtf8Char(m,this.encoding):this.value+=String.fromCharCode(m),this}appendChars(m,p,g){for(let N=p;p<p+g;N++)this.append(m[N]);return this}length(){return this.value.length}charAt(m){return this.value.charAt(m)}deleteCharAt(m){this.value=this.value.substr(0,m)+this.value.substring(m+1)}setCharAt(m,p){this.value=this.value.substr(0,m)+p+this.value.substr(m+1)}substring(m,p){return this.value.substring(m,p)}setLengthToZero(){this.value=""}toString(){return this.value}insert(m,p){this.value=this.value.substr(0,m)+p+this.value.substr(m+p.length)}}class ${constructor(m,p,g,N){if(this.width=m,this.height=p,this.rowSize=g,this.bits=N,p==null&&(p=m),this.height=p,m<1||p<1)throw new f("Both dimensions must be greater than 0");g==null&&(g=Math.floor((m+31)/32)),this.rowSize=g,N==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(m){const p=m.length,g=m[0].length,N=new $(g,p);for(let j=0;j<p;j++){const C=m[j];for(let E=0;E<g;E++)C[E]&&N.set(E,j)}return N}static parseFromString(m,p,g){if(m===null)throw new f("stringRepresentation cannot be null");const N=new Array(m.length);let j=0,C=0,E=-1,R=0,U=0;for(;U<m.length;)if(m.charAt(U)===`
`||m.charAt(U)==="\r"){if(j>C){if(E===-1)E=j-C;else if(j-C!==E)throw new f("row lengths do not match");C=j,R++}U++}else if(m.substring(U,U+p.length)===p)U+=p.length,N[j]=!0,j++;else if(m.substring(U,U+g.length)===g)U+=g.length,N[j]=!1,j++;else throw new f("illegal character encountered: "+m.substring(U));if(j>C){if(E===-1)E=j-C;else if(j-C!==E)throw new f("row lengths do not match");R++}const W=new $(E,R);for(let Y=0;Y<j;Y++)N[Y]&&W.set(Math.floor(Y%E),Math.floor(Y/E));return W}get(m,p){const g=p*this.rowSize+Math.floor(m/32);return(this.bits[g]>>>(m&31)&1)!==0}set(m,p){const g=p*this.rowSize+Math.floor(m/32);this.bits[g]|=1<<(m&31)&4294967295}unset(m,p){const g=p*this.rowSize+Math.floor(m/32);this.bits[g]&=~(1<<(m&31)&4294967295)}flip(m,p){const g=p*this.rowSize+Math.floor(m/32);this.bits[g]^=1<<(m&31)&4294967295}xor(m){if(this.width!==m.getWidth()||this.height!==m.getHeight()||this.rowSize!==m.getRowSize())throw new f("input matrix dimensions do not match");const p=new T(Math.floor(this.width/32)+1),g=this.rowSize,N=this.bits;for(let j=0,C=this.height;j<C;j++){const E=j*g,R=m.getRow(j,p).getBitArray();for(let U=0;U<g;U++)N[E+U]^=R[U]}}clear(){const m=this.bits,p=m.length;for(let g=0;g<p;g++)m[g]=0}setRegion(m,p,g,N){if(p<0||m<0)throw new f("Left and top must be nonnegative");if(N<1||g<1)throw new f("Height and width must be at least 1");const j=m+g,C=p+N;if(C>this.height||j>this.width)throw new f("The region must fit inside the matrix");const E=this.rowSize,R=this.bits;for(let U=p;U<C;U++){const W=U*E;for(let Y=m;Y<j;Y++)R[W+Math.floor(Y/32)]|=1<<(Y&31)&4294967295}}getRow(m,p){p==null||p.getSize()<this.width?p=new T(this.width):p.clear();const g=this.rowSize,N=this.bits,j=m*g;for(let C=0;C<g;C++)p.setBulk(C*32,N[j+C]);return p}setRow(m,p){w.arraycopy(p.getBitArray(),0,this.bits,m*this.rowSize,this.rowSize)}rotate180(){const m=this.getWidth(),p=this.getHeight();let g=new T(m),N=new T(m);for(let j=0,C=Math.floor((p+1)/2);j<C;j++)g=this.getRow(j,g),N=this.getRow(p-1-j,N),g.reverse(),N.reverse(),this.setRow(j,N),this.setRow(p-1-j,g)}getEnclosingRectangle(){const m=this.width,p=this.height,g=this.rowSize,N=this.bits;let j=m,C=p,E=-1,R=-1;for(let U=0;U<p;U++)for(let W=0;W<g;W++){const Y=N[U*g+W];if(Y!==0){if(U<C&&(C=U),U>R&&(R=U),W*32<j){let Z=0;for(;!(Y<<31-Z&4294967295);)Z++;W*32+Z<j&&(j=W*32+Z)}if(W*32+31>E){let Z=31;for(;!(Y>>>Z);)Z--;W*32+Z>E&&(E=W*32+Z)}}}return E<j||R<C?null:Int32Array.from([j,C,E-j+1,R-C+1])}getTopLeftOnBit(){const m=this.rowSize,p=this.bits;let g=0;for(;g<p.length&&p[g]===0;)g++;if(g===p.length)return null;const N=g/m;let j=g%m*32;const C=p[g];let E=0;for(;!(C<<31-E&4294967295);)E++;return j+=E,Int32Array.from([j,N])}getBottomRightOnBit(){const m=this.rowSize,p=this.bits;let g=p.length-1;for(;g>=0&&p[g]===0;)g--;if(g<0)return null;const N=Math.floor(g/m);let j=Math.floor(g%m)*32;const C=p[g];let E=31;for(;!(C>>>E);)E--;return j+=E,Int32Array.from([j,N])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(m){if(!(m instanceof $))return!1;const p=m;return this.width===p.width&&this.height===p.height&&this.rowSize===p.rowSize&&k.equals(this.bits,p.bits)}hashCode(){let m=this.width;return m=31*m+this.width,m=31*m+this.height,m=31*m+this.rowSize,m=31*m+k.hashCode(this.bits),m}toString(m="X ",p="  ",g=`
`){return this.buildToString(m,p,g)}buildToString(m,p,g){let N=new V;for(let j=0,C=this.height;j<C;j++){for(let E=0,R=this.width;E<R;E++)N.append(this.get(E,j)?m:p);N.append(g)}return N.toString()}clone(){return new $(this.width,this.height,this.rowSize,this.bits.slice())}}class z extends u{static getNotFoundInstance(){return new z}}z.kind="NotFoundException";class H extends v{constructor(m){super(m),this.luminances=H.EMPTY,this.buckets=new Int32Array(H.LUMINANCE_BUCKETS)}getBlackRow(m,p){const g=this.getLuminanceSource(),N=g.getWidth();p==null||p.getSize()<N?p=new T(N):p.clear(),this.initArrays(N);const j=g.getRow(m,this.luminances),C=this.buckets;for(let R=0;R<N;R++)C[(j[R]&255)>>H.LUMINANCE_SHIFT]++;const E=H.estimateBlackPoint(C);if(N<3)for(let R=0;R<N;R++)(j[R]&255)<E&&p.set(R);else{let R=j[0]&255,U=j[1]&255;for(let W=1;W<N-1;W++){const Y=j[W+1]&255;(U*4-R-Y)/2<E&&p.set(W),R=U,U=Y}}return p}getBlackMatrix(){const m=this.getLuminanceSource(),p=m.getWidth(),g=m.getHeight(),N=new $(p,g);this.initArrays(p);const j=this.buckets;for(let R=1;R<5;R++){const U=Math.floor(g*R/5),W=m.getRow(U,this.luminances),Y=Math.floor(p*4/5);for(let Z=Math.floor(p/5);Z<Y;Z++){const le=W[Z]&255;j[le>>H.LUMINANCE_SHIFT]++}}const C=H.estimateBlackPoint(j),E=m.getMatrix();for(let R=0;R<g;R++){const U=R*p;for(let W=0;W<p;W++)(E[U+W]&255)<C&&N.set(W,R)}return N}createBinarizer(m){return new H(m)}initArrays(m){this.luminances.length<m&&(this.luminances=new Uint8ClampedArray(m));const p=this.buckets;for(let g=0;g<H.LUMINANCE_BUCKETS;g++)p[g]=0}static estimateBlackPoint(m){const p=m.length;let g=0,N=0,j=0;for(let W=0;W<p;W++)m[W]>j&&(N=W,j=m[W]),m[W]>g&&(g=m[W]);let C=0,E=0;for(let W=0;W<p;W++){const Y=W-N,Z=m[W]*Y*Y;Z>E&&(C=W,E=Z)}if(N>C){const W=N;N=C,C=W}if(C-N<=p/16)throw new z;let R=C-1,U=-1;for(let W=C-1;W>N;W--){const Y=W-N,Z=Y*Y*(C-W)*(g-m[W]);Z>U&&(R=W,U=Z)}return R<<H.LUMINANCE_SHIFT}}H.LUMINANCE_BITS=5,H.LUMINANCE_SHIFT=8-H.LUMINANCE_BITS,H.LUMINANCE_BUCKETS=1<<H.LUMINANCE_BITS,H.EMPTY=Uint8ClampedArray.from([0]);class q extends H{constructor(m){super(m),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const m=this.getLuminanceSource(),p=m.getWidth(),g=m.getHeight();if(p>=q.MINIMUM_DIMENSION&&g>=q.MINIMUM_DIMENSION){const N=m.getMatrix();let j=p>>q.BLOCK_SIZE_POWER;p&q.BLOCK_SIZE_MASK&&j++;let C=g>>q.BLOCK_SIZE_POWER;g&q.BLOCK_SIZE_MASK&&C++;const E=q.calculateBlackPoints(N,j,C,p,g),R=new $(p,g);q.calculateThresholdForBlock(N,j,C,p,g,E,R),this.matrix=R}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(m){return new q(m)}static calculateThresholdForBlock(m,p,g,N,j,C,E){const R=j-q.BLOCK_SIZE,U=N-q.BLOCK_SIZE;for(let W=0;W<g;W++){let Y=W<<q.BLOCK_SIZE_POWER;Y>R&&(Y=R);const Z=q.cap(W,2,g-3);for(let le=0;le<p;le++){let be=le<<q.BLOCK_SIZE_POWER;be>U&&(be=U);const Ne=q.cap(le,2,p-3);let Ae=0;for(let et=-2;et<=2;et++){const st=C[Z+et];Ae+=st[Ne-2]+st[Ne-1]+st[Ne]+st[Ne+1]+st[Ne+2]}const Oe=Ae/25;q.thresholdBlock(m,be,Y,Oe,N,E)}}}static cap(m,p,g){return m<p?p:m>g?g:m}static thresholdBlock(m,p,g,N,j,C){for(let E=0,R=g*j+p;E<q.BLOCK_SIZE;E++,R+=j)for(let U=0;U<q.BLOCK_SIZE;U++)(m[R+U]&255)<=N&&C.set(p+U,g+E)}static calculateBlackPoints(m,p,g,N,j){const C=j-q.BLOCK_SIZE,E=N-q.BLOCK_SIZE,R=new Array(g);for(let U=0;U<g;U++){R[U]=new Int32Array(p);let W=U<<q.BLOCK_SIZE_POWER;W>C&&(W=C);for(let Y=0;Y<p;Y++){let Z=Y<<q.BLOCK_SIZE_POWER;Z>E&&(Z=E);let le=0,be=255,Ne=0;for(let Oe=0,et=W*N+Z;Oe<q.BLOCK_SIZE;Oe++,et+=N){for(let st=0;st<q.BLOCK_SIZE;st++){const Ye=m[et+st]&255;le+=Ye,Ye<be&&(be=Ye),Ye>Ne&&(Ne=Ye)}if(Ne-be>q.MIN_DYNAMIC_RANGE)for(Oe++,et+=N;Oe<q.BLOCK_SIZE;Oe++,et+=N)for(let st=0;st<q.BLOCK_SIZE;st++)le+=m[et+st]&255}let Ae=le>>q.BLOCK_SIZE_POWER*2;if(Ne-be<=q.MIN_DYNAMIC_RANGE&&(Ae=be/2,U>0&&Y>0)){const Oe=(R[U-1][Y]+2*R[U][Y-1]+R[U-1][Y-1])/4;be<Oe&&(Ae=Oe)}R[U][Y]=Ae}}return R}}q.BLOCK_SIZE_POWER=3,q.BLOCK_SIZE=1<<q.BLOCK_SIZE_POWER,q.BLOCK_SIZE_MASK=q.BLOCK_SIZE-1,q.MINIMUM_DIMENSION=q.BLOCK_SIZE*5,q.MIN_DYNAMIC_RANGE=24;class G{constructor(m,p){this.width=m,this.height=p}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(m,p,g,N){throw new B("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new B("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new B("This luminance source does not support rotation by 45 degrees.")}toString(){const m=new Uint8ClampedArray(this.width);let p=new V;for(let g=0;g<this.height;g++){const N=this.getRow(g,m);for(let j=0;j<this.width;j++){const C=N[j]&255;let E;C<64?E="#":C<128?E="+":C<192?E=".":E=" ",p.append(E)}p.append(`
`)}return p.toString()}}class re extends G{constructor(m){super(m.getWidth(),m.getHeight()),this.delegate=m}getRow(m,p){const g=this.delegate.getRow(m,p),N=this.getWidth();for(let j=0;j<N;j++)g[j]=255-(g[j]&255);return g}getMatrix(){const m=this.delegate.getMatrix(),p=this.getWidth()*this.getHeight(),g=new Uint8ClampedArray(p);for(let N=0;N<p;N++)g[N]=255-(m[N]&255);return g}isCropSupported(){return this.delegate.isCropSupported()}crop(m,p,g,N){return new re(this.delegate.crop(m,p,g,N))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new re(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new re(this.delegate.rotateCounterClockwise45())}}class ye extends G{constructor(m){super(m.width,m.height),this.canvas=m,this.tempCanvasElement=null,this.buffer=ye.makeBufferFromCanvasImageData(m)}static makeBufferFromCanvasImageData(m){const p=m.getContext("2d").getImageData(0,0,m.width,m.height);return ye.toGrayscaleBuffer(p.data,m.width,m.height)}static toGrayscaleBuffer(m,p,g){const N=new Uint8ClampedArray(p*g);for(let j=0,C=0,E=m.length;j<E;j+=4,C++){let R;if(m[j+3]===0)R=255;else{const W=m[j],Y=m[j+1],Z=m[j+2];R=306*W+601*Y+117*Z+512>>10}N[C]=R}return N}getRow(m,p){if(m<0||m>=this.getHeight())throw new f("Requested row is outside the image: "+m);const g=this.getWidth(),N=m*g;return p===null?p=this.buffer.slice(N,N+g):(p.length<g&&(p=new Uint8ClampedArray(g)),p.set(this.buffer.slice(N,N+g))),p}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(m,p,g,N){return super.crop(m,p,g,N),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const m=this.canvas.ownerDocument.createElement("canvas");m.width=this.canvas.width,m.height=this.canvas.height,this.tempCanvasElement=m}return this.tempCanvasElement}rotate(m){const p=this.getTempCanvasElement(),g=p.getContext("2d"),N=m*ye.DEGREE_TO_RADIANS,j=this.canvas.width,C=this.canvas.height,E=Math.ceil(Math.abs(Math.cos(N))*j+Math.abs(Math.sin(N))*C),R=Math.ceil(Math.abs(Math.sin(N))*j+Math.abs(Math.cos(N))*C);return p.width=E,p.height=R,g.translate(E/2,R/2),g.rotate(N),g.drawImage(this.canvas,j/-2,C/-2),this.buffer=ye.makeBufferFromCanvasImageData(p),this}invert(){return new re(this)}}ye.DEGREE_TO_RADIANS=Math.PI/180;class Ee{constructor(m,p,g){this.deviceId=m,this.label=p,this.kind="videoinput",this.groupId=g||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var ee=(globalThis||gf||self||window||void 0)&&(globalThis||gf||self||window||void 0).__awaiter||function(K,m,p,g){function N(j){return j instanceof p?j:new p(function(C){C(j)})}return new(p||(p=Promise))(function(j,C){function E(W){try{U(g.next(W))}catch(Y){C(Y)}}function R(W){try{U(g.throw(W))}catch(Y){C(Y)}}function U(W){W.done?j(W.value):N(W.value).then(E,R)}U((g=g.apply(K,m||[])).next())})};class te{constructor(m,p=500,g){this.reader=m,this.timeBetweenScansMillis=p,this._hints=g,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(m){this._timeBetweenDecodingAttempts=m<0?0:m}set hints(m){this._hints=m||null}get hints(){return this._hints}listVideoInputDevices(){return ee(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const m=yield navigator.mediaDevices.enumerateDevices(),p=[];for(const g of m){const N=g.kind==="video"?"videoinput":g.kind;if(N!=="videoinput")continue;const j=g.deviceId||g.id,C=g.label||`Video device ${p.length+1}`,E=g.groupId,R={deviceId:j,label:C,kind:N,groupId:E};p.push(R)}return p})}getVideoInputDevices(){return ee(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(p=>new Ee(p.deviceId,p.label))})}findDeviceById(m){return ee(this,void 0,void 0,function*(){const p=yield this.listVideoInputDevices();return p?p.find(g=>g.deviceId===m):null})}decodeFromInputVideoDevice(m,p){return ee(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(m,p)})}decodeOnceFromVideoDevice(m,p){return ee(this,void 0,void 0,function*(){this.reset();let g;m?g={deviceId:{exact:m}}:g={facingMode:"environment"};const N={video:g};return yield this.decodeOnceFromConstraints(N,p)})}decodeOnceFromConstraints(m,p){return ee(this,void 0,void 0,function*(){const g=yield navigator.mediaDevices.getUserMedia(m);return yield this.decodeOnceFromStream(g,p)})}decodeOnceFromStream(m,p){return ee(this,void 0,void 0,function*(){this.reset();const g=yield this.attachStreamToVideo(m,p);return yield this.decodeOnce(g)})}decodeFromInputVideoDeviceContinuously(m,p,g){return ee(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(m,p,g)})}decodeFromVideoDevice(m,p,g){return ee(this,void 0,void 0,function*(){let N;m?N={deviceId:{exact:m}}:N={facingMode:"environment"};const j={video:N};return yield this.decodeFromConstraints(j,p,g)})}decodeFromConstraints(m,p,g){return ee(this,void 0,void 0,function*(){const N=yield navigator.mediaDevices.getUserMedia(m);return yield this.decodeFromStream(N,p,g)})}decodeFromStream(m,p,g){return ee(this,void 0,void 0,function*(){this.reset();const N=yield this.attachStreamToVideo(m,p);return yield this.decodeContinuously(N,g)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(m,p){return ee(this,void 0,void 0,function*(){const g=this.prepareVideoElement(p);return this.addVideoSource(g,m),this.videoElement=g,this.stream=m,yield this.playVideoOnLoadAsync(g),g})}playVideoOnLoadAsync(m){return new Promise((p,g)=>this.playVideoOnLoad(m,()=>p()))}playVideoOnLoad(m,p){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(m),m.addEventListener("ended",this.videoEndedListener),m.addEventListener("canplay",this.videoCanPlayListener),m.addEventListener("playing",p),this.tryPlayVideo(m)}isVideoPlaying(m){return m.currentTime>0&&!m.paused&&!m.ended&&m.readyState>2}tryPlayVideo(m){return ee(this,void 0,void 0,function*(){if(this.isVideoPlaying(m)){console.warn("Trying to play video that is already playing.");return}try{yield m.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(m,p){const g=document.getElementById(m);if(!g)throw new h(`element with id '${m}' not found`);if(g.nodeName.toLowerCase()!==p.toLowerCase())throw new h(`element with id '${m}' must be an ${p} element`);return g}decodeFromImage(m,p){if(!m&&!p)throw new h("either imageElement with a src set or an url must be provided");return p&&!m?this.decodeFromImageUrl(p):this.decodeFromImageElement(m)}decodeFromVideo(m,p){if(!m&&!p)throw new h("Either an element with a src set or an URL must be provided");return p&&!m?this.decodeFromVideoUrl(p):this.decodeFromVideoElement(m)}decodeFromVideoContinuously(m,p,g){if(m===void 0&&p===void 0)throw new h("Either an element with a src set or an URL must be provided");return p&&!m?this.decodeFromVideoUrlContinuously(p,g):this.decodeFromVideoElementContinuously(m,g)}decodeFromImageElement(m){if(!m)throw new h("An image element must be provided.");this.reset();const p=this.prepareImageElement(m);this.imageElement=p;let g;return this.isImageLoaded(p)?g=this.decodeOnce(p,!1,!0):g=this._decodeOnLoadImage(p),g}decodeFromVideoElement(m){const p=this._decodeFromVideoElementSetup(m);return this._decodeOnLoadVideo(p)}decodeFromVideoElementContinuously(m,p){const g=this._decodeFromVideoElementSetup(m);return this._decodeOnLoadVideoContinuously(g,p)}_decodeFromVideoElementSetup(m){if(!m)throw new h("A video element must be provided.");this.reset();const p=this.prepareVideoElement(m);return this.videoElement=p,p}decodeFromImageUrl(m){if(!m)throw new h("An URL must be provided.");this.reset();const p=this.prepareImageElement();this.imageElement=p;const g=this._decodeOnLoadImage(p);return p.src=m,g}decodeFromVideoUrl(m){if(!m)throw new h("An URL must be provided.");this.reset();const p=this.prepareVideoElement(),g=this.decodeFromVideoElement(p);return p.src=m,g}decodeFromVideoUrlContinuously(m,p){if(!m)throw new h("An URL must be provided.");this.reset();const g=this.prepareVideoElement(),N=this.decodeFromVideoElementContinuously(g,p);return g.src=m,N}_decodeOnLoadImage(m){return new Promise((p,g)=>{this.imageLoadedListener=()=>this.decodeOnce(m,!1,!0).then(p,g),m.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(m){return ee(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(m),yield this.decodeOnce(m)})}_decodeOnLoadVideoContinuously(m,p){return ee(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(m),this.decodeContinuously(m,p)})}isImageLoaded(m){return!(!m.complete||m.naturalWidth===0)}prepareImageElement(m){let p;return typeof m>"u"&&(p=document.createElement("img"),p.width=200,p.height=200),typeof m=="string"&&(p=this.getMediaElement(m,"img")),m instanceof HTMLImageElement&&(p=m),p}prepareVideoElement(m){let p;return!m&&typeof document<"u"&&(p=document.createElement("video"),p.width=200,p.height=200),typeof m=="string"&&(p=this.getMediaElement(m,"video")),m instanceof HTMLVideoElement&&(p=m),p.setAttribute("autoplay","true"),p.setAttribute("muted","true"),p.setAttribute("playsinline","true"),p}decodeOnce(m,p=!0,g=!0){this._stopAsyncDecode=!1;const N=(j,C)=>{if(this._stopAsyncDecode){C(new z("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const E=this.decode(m);j(E)}catch(E){const R=p&&E instanceof z,W=(E instanceof b||E instanceof D)&&g;if(R||W)return setTimeout(N,this._timeBetweenDecodingAttempts,j,C);C(E)}};return new Promise((j,C)=>N(j,C))}decodeContinuously(m,p){this._stopContinuousDecode=!1;const g=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const N=this.decode(m);p(N,null),setTimeout(g,this.timeBetweenScansMillis)}catch(N){p(null,N);const j=N instanceof b||N instanceof D,C=N instanceof z;(j||C)&&setTimeout(g,this._timeBetweenDecodingAttempts)}};g()}decode(m){const p=this.createBinaryBitmap(m);return this.decodeBitmap(p)}_isHTMLVideoElement(m){return m.videoWidth!==0}drawFrameOnCanvas(m,p,g){p||(p={sx:0,sy:0,sWidth:m.videoWidth,sHeight:m.videoHeight,dx:0,dy:0,dWidth:m.videoWidth,dHeight:m.videoHeight}),g||(g=this.captureCanvasContext),g.drawImage(m,p.sx,p.sy,p.sWidth,p.sHeight,p.dx,p.dy,p.dWidth,p.dHeight)}drawImageOnCanvas(m,p,g=this.captureCanvasContext){p||(p={sx:0,sy:0,sWidth:m.naturalWidth,sHeight:m.naturalHeight,dx:0,dy:0,dWidth:m.naturalWidth,dHeight:m.naturalHeight}),g||(g=this.captureCanvasContext),g.drawImage(m,p.sx,p.sy,p.sWidth,p.sHeight,p.dx,p.dy,p.dWidth,p.dHeight)}createBinaryBitmap(m){this.getCaptureCanvasContext(m),this._isHTMLVideoElement(m)?this.drawFrameOnCanvas(m):this.drawImageOnCanvas(m);const p=this.getCaptureCanvas(m),g=new ye(p),N=new q(g);return new x(N)}getCaptureCanvasContext(m){if(!this.captureCanvasContext){const g=this.getCaptureCanvas(m).getContext("2d");this.captureCanvasContext=g}return this.captureCanvasContext}getCaptureCanvas(m){if(!this.captureCanvas){const p=this.createCaptureCanvas(m);this.captureCanvas=p}return this.captureCanvas}decodeBitmap(m){return this.reader.decode(m,this._hints)}createCaptureCanvas(m){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const p=document.createElement("canvas");let g,N;return typeof m<"u"&&(m instanceof HTMLVideoElement?(g=m.videoWidth,N=m.videoHeight):m instanceof HTMLImageElement&&(g=m.naturalWidth||m.width,N=m.naturalHeight||m.height)),p.style.width=g+"px",p.style.height=N+"px",p.width=g,p.height=N,p}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(m=>m.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(m,p){try{m.srcObject=p}catch{m.src=URL.createObjectURL(p)}}cleanVideoSource(m){try{m.srcObject=null}catch{m.src=""}this.videoElement.removeAttribute("src")}}class ce{constructor(m,p,g=p==null?0:8*p.length,N,j,C=w.currentTimeMillis()){this.text=m,this.rawBytes=p,this.numBits=g,this.resultPoints=N,this.format=j,this.timestamp=C,this.text=m,this.rawBytes=p,g==null?this.numBits=p==null?0:8*p.length:this.numBits=g,this.resultPoints=N,this.format=j,this.resultMetadata=null,C==null?this.timestamp=w.currentTimeMillis():this.timestamp=C}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(m,p){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(m,p)}putAllMetadata(m){m!==null&&(this.resultMetadata===null?this.resultMetadata=m:this.resultMetadata=new Map(m))}addResultPoints(m){const p=this.resultPoints;if(p===null)this.resultPoints=m;else if(m!==null&&m.length>0){const g=new Array(p.length+m.length);w.arraycopy(p,0,g,0,p.length),w.arraycopy(m,0,g,p.length,m.length),this.resultPoints=g}}getTimestamp(){return this.timestamp}toString(){return this.text}}var ge;(function(K){K[K.AZTEC=0]="AZTEC",K[K.CODABAR=1]="CODABAR",K[K.CODE_39=2]="CODE_39",K[K.CODE_93=3]="CODE_93",K[K.CODE_128=4]="CODE_128",K[K.DATA_MATRIX=5]="DATA_MATRIX",K[K.EAN_8=6]="EAN_8",K[K.EAN_13=7]="EAN_13",K[K.ITF=8]="ITF",K[K.MAXICODE=9]="MAXICODE",K[K.PDF_417=10]="PDF_417",K[K.QR_CODE=11]="QR_CODE",K[K.RSS_14=12]="RSS_14",K[K.RSS_EXPANDED=13]="RSS_EXPANDED",K[K.UPC_A=14]="UPC_A",K[K.UPC_E=15]="UPC_E",K[K.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(ge||(ge={}));var X=ge,de;(function(K){K[K.OTHER=0]="OTHER",K[K.ORIENTATION=1]="ORIENTATION",K[K.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",K[K.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",K[K.ISSUE_NUMBER=4]="ISSUE_NUMBER",K[K.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",K[K.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",K[K.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",K[K.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",K[K.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",K[K.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(de||(de={}));var Ce=de;class ue{constructor(m,p,g,N,j=-1,C=-1){this.rawBytes=m,this.text=p,this.byteSegments=g,this.ecLevel=N,this.structuredAppendSequenceNumber=j,this.structuredAppendParity=C,this.numBits=m==null?0:8*m.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(m){this.numBits=m}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(m){this.errorsCorrected=m}getErasures(){return this.erasures}setErasures(m){this.erasures=m}getOther(){return this.other}setOther(m){this.other=m}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class fe{exp(m){return this.expTable[m]}log(m){if(m===0)throw new f;return this.logTable[m]}static addOrSubtract(m,p){return m^p}}class pe{constructor(m,p){if(p.length===0)throw new f;this.field=m;const g=p.length;if(g>1&&p[0]===0){let N=1;for(;N<g&&p[N]===0;)N++;N===g?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(g-N),w.arraycopy(p,N,this.coefficients,0,this.coefficients.length))}else this.coefficients=p}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(m){return this.coefficients[this.coefficients.length-1-m]}evaluateAt(m){if(m===0)return this.getCoefficient(0);const p=this.coefficients;let g;if(m===1){g=0;for(let C=0,E=p.length;C!==E;C++){const R=p[C];g=fe.addOrSubtract(g,R)}return g}g=p[0];const N=p.length,j=this.field;for(let C=1;C<N;C++)g=fe.addOrSubtract(j.multiply(m,g),p[C]);return g}addOrSubtract(m){if(!this.field.equals(m.field))throw new f("GenericGFPolys do not have same GenericGF field");if(this.isZero())return m;if(m.isZero())return this;let p=this.coefficients,g=m.coefficients;if(p.length>g.length){const C=p;p=g,g=C}let N=new Int32Array(g.length);const j=g.length-p.length;w.arraycopy(g,0,N,0,j);for(let C=j;C<g.length;C++)N[C]=fe.addOrSubtract(p[C-j],g[C]);return new pe(this.field,N)}multiply(m){if(!this.field.equals(m.field))throw new f("GenericGFPolys do not have same GenericGF field");if(this.isZero()||m.isZero())return this.field.getZero();const p=this.coefficients,g=p.length,N=m.coefficients,j=N.length,C=new Int32Array(g+j-1),E=this.field;for(let R=0;R<g;R++){const U=p[R];for(let W=0;W<j;W++)C[R+W]=fe.addOrSubtract(C[R+W],E.multiply(U,N[W]))}return new pe(E,C)}multiplyScalar(m){if(m===0)return this.field.getZero();if(m===1)return this;const p=this.coefficients.length,g=this.field,N=new Int32Array(p),j=this.coefficients;for(let C=0;C<p;C++)N[C]=g.multiply(j[C],m);return new pe(g,N)}multiplyByMonomial(m,p){if(m<0)throw new f;if(p===0)return this.field.getZero();const g=this.coefficients,N=g.length,j=new Int32Array(N+m),C=this.field;for(let E=0;E<N;E++)j[E]=C.multiply(g[E],p);return new pe(C,j)}divide(m){if(!this.field.equals(m.field))throw new f("GenericGFPolys do not have same GenericGF field");if(m.isZero())throw new f("Divide by 0");const p=this.field;let g=p.getZero(),N=this;const j=m.getCoefficient(m.getDegree()),C=p.inverse(j);for(;N.getDegree()>=m.getDegree()&&!N.isZero();){const E=N.getDegree()-m.getDegree(),R=p.multiply(N.getCoefficient(N.getDegree()),C),U=m.multiplyByMonomial(E,R),W=p.buildMonomial(E,R);g=g.addOrSubtract(W),N=N.addOrSubtract(U)}return[g,N]}toString(){let m="";for(let p=this.getDegree();p>=0;p--){let g=this.getCoefficient(p);if(g!==0){if(g<0?(m+=" - ",g=-g):m.length>0&&(m+=" + "),p===0||g!==1){const N=this.field.log(g);N===0?m+="1":N===1?m+="a":(m+="a^",m+=N)}p!==0&&(p===1?m+="x":(m+="x^",m+=p))}}return m}}class oe extends u{}oe.kind="ArithmeticException";class qe extends fe{constructor(m,p,g){super(),this.primitive=m,this.size=p,this.generatorBase=g;const N=new Int32Array(p);let j=1;for(let E=0;E<p;E++)N[E]=j,j*=2,j>=p&&(j^=m,j&=p-1);this.expTable=N;const C=new Int32Array(p);for(let E=0;E<p-1;E++)C[N[E]]=E;this.logTable=C,this.zero=new pe(this,Int32Array.from([0])),this.one=new pe(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(m,p){if(m<0)throw new f;if(p===0)return this.zero;const g=new Int32Array(m+1);return g[0]=p,new pe(this,g)}inverse(m){if(m===0)throw new oe;return this.expTable[this.size-this.logTable[m]-1]}multiply(m,p){return m===0||p===0?0:this.expTable[(this.logTable[m]+this.logTable[p])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+A.toHexString(this.primitive)+","+this.size+")"}equals(m){return m===this}}qe.AZTEC_DATA_12=new qe(4201,4096,1),qe.AZTEC_DATA_10=new qe(1033,1024,1),qe.AZTEC_DATA_6=new qe(67,64,1),qe.AZTEC_PARAM=new qe(19,16,1),qe.QR_CODE_FIELD_256=new qe(285,256,0),qe.DATA_MATRIX_FIELD_256=new qe(301,256,1),qe.AZTEC_DATA_8=qe.DATA_MATRIX_FIELD_256,qe.MAXICODE_FIELD_64=qe.AZTEC_DATA_6;class Xe extends u{}Xe.kind="ReedSolomonException";class jt extends u{}jt.kind="IllegalStateException";class ft{constructor(m){this.field=m}decode(m,p){const g=this.field,N=new pe(g,m),j=new Int32Array(p);let C=!0;for(let le=0;le<p;le++){const be=N.evaluateAt(g.exp(le+g.getGeneratorBase()));j[j.length-1-le]=be,be!==0&&(C=!1)}if(C)return;const E=new pe(g,j),R=this.runEuclideanAlgorithm(g.buildMonomial(p,1),E,p),U=R[0],W=R[1],Y=this.findErrorLocations(U),Z=this.findErrorMagnitudes(W,Y);for(let le=0;le<Y.length;le++){const be=m.length-1-g.log(Y[le]);if(be<0)throw new Xe("Bad error location");m[be]=qe.addOrSubtract(m[be],Z[le])}}runEuclideanAlgorithm(m,p,g){if(m.getDegree()<p.getDegree()){const le=m;m=p,p=le}const N=this.field;let j=m,C=p,E=N.getZero(),R=N.getOne();for(;C.getDegree()>=(g/2|0);){let le=j,be=E;if(j=C,E=R,j.isZero())throw new Xe("r_{i-1} was zero");C=le;let Ne=N.getZero();const Ae=j.getCoefficient(j.getDegree()),Oe=N.inverse(Ae);for(;C.getDegree()>=j.getDegree()&&!C.isZero();){const et=C.getDegree()-j.getDegree(),st=N.multiply(C.getCoefficient(C.getDegree()),Oe);Ne=Ne.addOrSubtract(N.buildMonomial(et,st)),C=C.addOrSubtract(j.multiplyByMonomial(et,st))}if(R=Ne.multiply(E).addOrSubtract(be),C.getDegree()>=j.getDegree())throw new jt("Division algorithm failed to reduce polynomial?")}const U=R.getCoefficient(0);if(U===0)throw new Xe("sigmaTilde(0) was zero");const W=N.inverse(U),Y=R.multiplyScalar(W),Z=C.multiplyScalar(W);return[Y,Z]}findErrorLocations(m){const p=m.getDegree();if(p===1)return Int32Array.from([m.getCoefficient(1)]);const g=new Int32Array(p);let N=0;const j=this.field;for(let C=1;C<j.getSize()&&N<p;C++)m.evaluateAt(C)===0&&(g[N]=j.inverse(C),N++);if(N!==p)throw new Xe("Error locator degree does not match number of roots");return g}findErrorMagnitudes(m,p){const g=p.length,N=new Int32Array(g),j=this.field;for(let C=0;C<g;C++){const E=j.inverse(p[C]);let R=1;for(let U=0;U<g;U++)if(C!==U){const W=j.multiply(p[U],E),Y=W&1?W&-2:W|1;R=j.multiply(R,Y)}N[C]=j.multiply(m.evaluateAt(E),j.inverse(R)),j.getGeneratorBase()!==0&&(N[C]=j.multiply(N[C],E))}return N}}var it;(function(K){K[K.UPPER=0]="UPPER",K[K.LOWER=1]="LOWER",K[K.MIXED=2]="MIXED",K[K.DIGIT=3]="DIGIT",K[K.PUNCT=4]="PUNCT",K[K.BINARY=5]="BINARY"})(it||(it={}));class _t{decode(m){this.ddata=m;let p=m.getBits(),g=this.extractBits(p),N=this.correctBits(g),j=_t.convertBoolArrayToByteArray(N),C=_t.getEncodedData(N),E=new ue(j,C,null,null);return E.setNumBits(N.length),E}static highLevelDecode(m){return this.getEncodedData(m)}static getEncodedData(m){let p=m.length,g=it.UPPER,N=it.UPPER,j="",C=0;for(;C<p;)if(N===it.BINARY){if(p-C<5)break;let E=_t.readCode(m,C,5);if(C+=5,E===0){if(p-C<11)break;E=_t.readCode(m,C,11)+31,C+=11}for(let R=0;R<E;R++){if(p-C<8){C=p;break}const U=_t.readCode(m,C,8);j+=F.castAsNonUtf8Char(U),C+=8}N=g}else{let E=N===it.DIGIT?4:5;if(p-C<E)break;let R=_t.readCode(m,C,E);C+=E;let U=_t.getCharacter(N,R);U.startsWith("CTRL_")?(g=N,N=_t.getTable(U.charAt(5)),U.charAt(6)==="L"&&(g=N)):(j+=U,N=g)}return j}static getTable(m){switch(m){case"L":return it.LOWER;case"P":return it.PUNCT;case"M":return it.MIXED;case"D":return it.DIGIT;case"B":return it.BINARY;case"U":default:return it.UPPER}}static getCharacter(m,p){switch(m){case it.UPPER:return _t.UPPER_TABLE[p];case it.LOWER:return _t.LOWER_TABLE[p];case it.MIXED:return _t.MIXED_TABLE[p];case it.PUNCT:return _t.PUNCT_TABLE[p];case it.DIGIT:return _t.DIGIT_TABLE[p];default:throw new jt("Bad table")}}correctBits(m){let p,g;this.ddata.getNbLayers()<=2?(g=6,p=qe.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(g=8,p=qe.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(g=10,p=qe.AZTEC_DATA_10):(g=12,p=qe.AZTEC_DATA_12);let N=this.ddata.getNbDatablocks(),j=m.length/g;if(j<N)throw new D;let C=m.length%g,E=new Int32Array(j);for(let Z=0;Z<j;Z++,C+=g)E[Z]=_t.readCode(m,C,g);try{new ft(p).decode(E,j-N)}catch(Z){throw new D(Z)}let R=(1<<g)-1,U=0;for(let Z=0;Z<N;Z++){let le=E[Z];if(le===0||le===R)throw new D;(le===1||le===R-1)&&U++}let W=new Array(N*g-U),Y=0;for(let Z=0;Z<N;Z++){let le=E[Z];if(le===1||le===R-1)W.fill(le>1,Y,Y+g-1),Y+=g-1;else for(let be=g-1;be>=0;--be)W[Y++]=(le&1<<be)!==0}return W}extractBits(m){let p=this.ddata.isCompact(),g=this.ddata.getNbLayers(),N=(p?11:14)+g*4,j=new Int32Array(N),C=new Array(this.totalBitsInLayer(g,p));if(p)for(let E=0;E<j.length;E++)j[E]=E;else{let E=N+1+2*A.truncDivision(A.truncDivision(N,2)-1,15),R=N/2,U=A.truncDivision(E,2);for(let W=0;W<R;W++){let Y=W+A.truncDivision(W,15);j[R-W-1]=U-Y-1,j[R+W]=U+Y+1}}for(let E=0,R=0;E<g;E++){let U=(g-E)*4+(p?9:12),W=E*2,Y=N-1-W;for(let Z=0;Z<U;Z++){let le=Z*2;for(let be=0;be<2;be++)C[R+le+be]=m.get(j[W+be],j[W+Z]),C[R+2*U+le+be]=m.get(j[W+Z],j[Y-be]),C[R+4*U+le+be]=m.get(j[Y-be],j[Y-Z]),C[R+6*U+le+be]=m.get(j[Y-Z],j[W+be])}R+=U*8}return C}static readCode(m,p,g){let N=0;for(let j=p;j<p+g;j++)N<<=1,m[j]&&(N|=1);return N}static readByte(m,p){let g=m.length-p;return g>=8?_t.readCode(m,p,8):_t.readCode(m,p,g)<<8-g}static convertBoolArrayToByteArray(m){let p=new Uint8Array((m.length+7)/8);for(let g=0;g<p.length;g++)p[g]=_t.readByte(m,8*g);return p}totalBitsInLayer(m,p){return((p?88:112)+16*m)*m}}_t.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],_t.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],_t.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],_t.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],_t.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class ve{constructor(){}static round(m){return m===NaN?0:m<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:m>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:m+(m<0?-.5:.5)|0}static distance(m,p,g,N){const j=m-g,C=p-N;return Math.sqrt(j*j+C*C)}static sum(m){let p=0;for(let g=0,N=m.length;g!==N;g++){const j=m[g];p+=j}return p}}class ae{static floatToIntBits(m){return m}}ae.MAX_VALUE=Number.MAX_SAFE_INTEGER;class xe{constructor(m,p){this.x=m,this.y=p}getX(){return this.x}getY(){return this.y}equals(m){if(m instanceof xe){const p=m;return this.x===p.x&&this.y===p.y}return!1}hashCode(){return 31*ae.floatToIntBits(this.x)+ae.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(m){const p=this.distance(m[0],m[1]),g=this.distance(m[1],m[2]),N=this.distance(m[0],m[2]);let j,C,E;if(g>=p&&g>=N?(C=m[0],j=m[1],E=m[2]):N>=g&&N>=p?(C=m[1],j=m[0],E=m[2]):(C=m[2],j=m[0],E=m[1]),this.crossProductZ(j,C,E)<0){const R=j;j=E,E=R}m[0]=j,m[1]=C,m[2]=E}static distance(m,p){return ve.distance(m.x,m.y,p.x,p.y)}static crossProductZ(m,p,g){const N=p.x,j=p.y;return(g.x-N)*(m.y-j)-(g.y-j)*(m.x-N)}}class je{constructor(m,p){this.bits=m,this.points=p}getBits(){return this.bits}getPoints(){return this.points}}class Fe extends je{constructor(m,p,g,N,j){super(m,p),this.compact=g,this.nbDatablocks=N,this.nbLayers=j}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class Ct{constructor(m,p,g,N){this.image=m,this.height=m.getHeight(),this.width=m.getWidth(),p==null&&(p=Ct.INIT_SIZE),g==null&&(g=m.getWidth()/2|0),N==null&&(N=m.getHeight()/2|0);const j=p/2|0;if(this.leftInit=g-j,this.rightInit=g+j,this.upInit=N-j,this.downInit=N+j,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new z}detect(){let m=this.leftInit,p=this.rightInit,g=this.upInit,N=this.downInit,j=!1,C=!0,E=!1,R=!1,U=!1,W=!1,Y=!1;const Z=this.width,le=this.height;for(;C;){C=!1;let be=!0;for(;(be||!R)&&p<Z;)be=this.containsBlackPoint(g,N,p,!1),be?(p++,C=!0,R=!0):R||p++;if(p>=Z){j=!0;break}let Ne=!0;for(;(Ne||!U)&&N<le;)Ne=this.containsBlackPoint(m,p,N,!0),Ne?(N++,C=!0,U=!0):U||N++;if(N>=le){j=!0;break}let Ae=!0;for(;(Ae||!W)&&m>=0;)Ae=this.containsBlackPoint(g,N,m,!1),Ae?(m--,C=!0,W=!0):W||m--;if(m<0){j=!0;break}let Oe=!0;for(;(Oe||!Y)&&g>=0;)Oe=this.containsBlackPoint(m,p,g,!0),Oe?(g--,C=!0,Y=!0):Y||g--;if(g<0){j=!0;break}C&&(E=!0)}if(!j&&E){const be=p-m;let Ne=null;for(let st=1;Ne===null&&st<be;st++)Ne=this.getBlackPointOnSegment(m,N-st,m+st,N);if(Ne==null)throw new z;let Ae=null;for(let st=1;Ae===null&&st<be;st++)Ae=this.getBlackPointOnSegment(m,g+st,m+st,g);if(Ae==null)throw new z;let Oe=null;for(let st=1;Oe===null&&st<be;st++)Oe=this.getBlackPointOnSegment(p,g+st,p-st,g);if(Oe==null)throw new z;let et=null;for(let st=1;et===null&&st<be;st++)et=this.getBlackPointOnSegment(p,N-st,p-st,N);if(et==null)throw new z;return this.centerEdges(et,Ne,Oe,Ae)}else throw new z}getBlackPointOnSegment(m,p,g,N){const j=ve.round(ve.distance(m,p,g,N)),C=(g-m)/j,E=(N-p)/j,R=this.image;for(let U=0;U<j;U++){const W=ve.round(m+U*C),Y=ve.round(p+U*E);if(R.get(W,Y))return new xe(W,Y)}return null}centerEdges(m,p,g,N){const j=m.getX(),C=m.getY(),E=p.getX(),R=p.getY(),U=g.getX(),W=g.getY(),Y=N.getX(),Z=N.getY(),le=Ct.CORR;return j<this.width/2?[new xe(Y-le,Z+le),new xe(E+le,R+le),new xe(U-le,W-le),new xe(j+le,C-le)]:[new xe(Y+le,Z+le),new xe(E+le,R-le),new xe(U-le,W+le),new xe(j-le,C-le)]}containsBlackPoint(m,p,g,N){const j=this.image;if(N){for(let C=m;C<=p;C++)if(j.get(C,g))return!0}else for(let C=m;C<=p;C++)if(j.get(g,C))return!0;return!1}}Ct.INIT_SIZE=10,Ct.CORR=1;class vt{static checkAndNudgePoints(m,p){const g=m.getWidth(),N=m.getHeight();let j=!0;for(let C=0;C<p.length&&j;C+=2){const E=Math.floor(p[C]),R=Math.floor(p[C+1]);if(E<-1||E>g||R<-1||R>N)throw new z;j=!1,E===-1?(p[C]=0,j=!0):E===g&&(p[C]=g-1,j=!0),R===-1?(p[C+1]=0,j=!0):R===N&&(p[C+1]=N-1,j=!0)}j=!0;for(let C=p.length-2;C>=0&&j;C-=2){const E=Math.floor(p[C]),R=Math.floor(p[C+1]);if(E<-1||E>g||R<-1||R>N)throw new z;j=!1,E===-1?(p[C]=0,j=!0):E===g&&(p[C]=g-1,j=!0),R===-1?(p[C+1]=0,j=!0):R===N&&(p[C+1]=N-1,j=!0)}}}class pt{constructor(m,p,g,N,j,C,E,R,U){this.a11=m,this.a21=p,this.a31=g,this.a12=N,this.a22=j,this.a32=C,this.a13=E,this.a23=R,this.a33=U}static quadrilateralToQuadrilateral(m,p,g,N,j,C,E,R,U,W,Y,Z,le,be,Ne,Ae){const Oe=pt.quadrilateralToSquare(m,p,g,N,j,C,E,R);return pt.squareToQuadrilateral(U,W,Y,Z,le,be,Ne,Ae).times(Oe)}transformPoints(m){const p=m.length,g=this.a11,N=this.a12,j=this.a13,C=this.a21,E=this.a22,R=this.a23,U=this.a31,W=this.a32,Y=this.a33;for(let Z=0;Z<p;Z+=2){const le=m[Z],be=m[Z+1],Ne=j*le+R*be+Y;m[Z]=(g*le+C*be+U)/Ne,m[Z+1]=(N*le+E*be+W)/Ne}}transformPointsWithValues(m,p){const g=this.a11,N=this.a12,j=this.a13,C=this.a21,E=this.a22,R=this.a23,U=this.a31,W=this.a32,Y=this.a33,Z=m.length;for(let le=0;le<Z;le++){const be=m[le],Ne=p[le],Ae=j*be+R*Ne+Y;m[le]=(g*be+C*Ne+U)/Ae,p[le]=(N*be+E*Ne+W)/Ae}}static squareToQuadrilateral(m,p,g,N,j,C,E,R){const U=m-g+j-E,W=p-N+C-R;if(U===0&&W===0)return new pt(g-m,j-g,m,N-p,C-N,p,0,0,1);{const Y=g-j,Z=E-j,le=N-C,be=R-C,Ne=Y*be-Z*le,Ae=(U*be-Z*W)/Ne,Oe=(Y*W-U*le)/Ne;return new pt(g-m+Ae*g,E-m+Oe*E,m,N-p+Ae*N,R-p+Oe*R,p,Ae,Oe,1)}}static quadrilateralToSquare(m,p,g,N,j,C,E,R){return pt.squareToQuadrilateral(m,p,g,N,j,C,E,R).buildAdjoint()}buildAdjoint(){return new pt(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(m){return new pt(this.a11*m.a11+this.a21*m.a12+this.a31*m.a13,this.a11*m.a21+this.a21*m.a22+this.a31*m.a23,this.a11*m.a31+this.a21*m.a32+this.a31*m.a33,this.a12*m.a11+this.a22*m.a12+this.a32*m.a13,this.a12*m.a21+this.a22*m.a22+this.a32*m.a23,this.a12*m.a31+this.a22*m.a32+this.a32*m.a33,this.a13*m.a11+this.a23*m.a12+this.a33*m.a13,this.a13*m.a21+this.a23*m.a22+this.a33*m.a23,this.a13*m.a31+this.a23*m.a32+this.a33*m.a33)}}class Ns extends vt{sampleGrid(m,p,g,N,j,C,E,R,U,W,Y,Z,le,be,Ne,Ae,Oe,et,st){const Ye=pt.quadrilateralToQuadrilateral(N,j,C,E,R,U,W,Y,Z,le,be,Ne,Ae,Oe,et,st);return this.sampleGridWithTransform(m,p,g,Ye)}sampleGridWithTransform(m,p,g,N){if(p<=0||g<=0)throw new z;const j=new $(p,g),C=new Float32Array(2*p);for(let E=0;E<g;E++){const R=C.length,U=E+.5;for(let W=0;W<R;W+=2)C[W]=W/2+.5,C[W+1]=U;N.transformPoints(C),vt.checkAndNudgePoints(m,C);try{for(let W=0;W<R;W+=2)m.get(Math.floor(C[W]),Math.floor(C[W+1]))&&j.set(W/2,E)}catch{throw new z}}return j}}class ds{static setGridSampler(m){ds.gridSampler=m}static getInstance(){return ds.gridSampler}}ds.gridSampler=new Ns;class ie{constructor(m,p){this.x=m,this.y=p}toResultPoint(){return new xe(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class Ie{constructor(m){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=m}detect(){return this.detectMirror(!1)}detectMirror(m){let p=this.getMatrixCenter(),g=this.getBullsEyeCorners(p);if(m){let C=g[0];g[0]=g[2],g[2]=C}this.extractParameters(g);let N=this.sampleGrid(this.image,g[this.shift%4],g[(this.shift+1)%4],g[(this.shift+2)%4],g[(this.shift+3)%4]),j=this.getMatrixCornerPoints(g);return new Fe(N,j,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(m){if(!this.isValidPoint(m[0])||!this.isValidPoint(m[1])||!this.isValidPoint(m[2])||!this.isValidPoint(m[3]))throw new z;let p=2*this.nbCenterLayers,g=new Int32Array([this.sampleLine(m[0],m[1],p),this.sampleLine(m[1],m[2],p),this.sampleLine(m[2],m[3],p),this.sampleLine(m[3],m[0],p)]);this.shift=this.getRotation(g,p);let N=0;for(let C=0;C<4;C++){let E=g[(this.shift+C)%4];this.compact?(N<<=7,N+=E>>1&127):(N<<=10,N+=(E>>2&992)+(E>>1&31))}let j=this.getCorrectedParameterData(N,this.compact);this.compact?(this.nbLayers=(j>>6)+1,this.nbDataBlocks=(j&63)+1):(this.nbLayers=(j>>11)+1,this.nbDataBlocks=(j&2047)+1)}getRotation(m,p){let g=0;m.forEach((N,j,C)=>{let E=(N>>p-2<<1)+(N&1);g=(g<<3)+E}),g=((g&1)<<11)+(g>>1);for(let N=0;N<4;N++)if(A.bitCount(g^this.EXPECTED_CORNER_BITS[N])<=2)return N;throw new z}getCorrectedParameterData(m,p){let g,N;p?(g=7,N=2):(g=10,N=4);let j=g-N,C=new Int32Array(g);for(let R=g-1;R>=0;--R)C[R]=m&15,m>>=4;try{new ft(qe.AZTEC_PARAM).decode(C,j)}catch{throw new z}let E=0;for(let R=0;R<N;R++)E=(E<<4)+C[R];return E}getBullsEyeCorners(m){let p=m,g=m,N=m,j=m,C=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let Y=this.getFirstDifferent(p,C,1,-1),Z=this.getFirstDifferent(g,C,1,1),le=this.getFirstDifferent(N,C,-1,1),be=this.getFirstDifferent(j,C,-1,-1);if(this.nbCenterLayers>2){let Ne=this.distancePoint(be,Y)*this.nbCenterLayers/(this.distancePoint(j,p)*(this.nbCenterLayers+2));if(Ne<.75||Ne>1.25||!this.isWhiteOrBlackRectangle(Y,Z,le,be))break}p=Y,g=Z,N=le,j=be,C=!C}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new z;this.compact=this.nbCenterLayers===5;let E=new xe(p.getX()+.5,p.getY()-.5),R=new xe(g.getX()+.5,g.getY()+.5),U=new xe(N.getX()-.5,N.getY()+.5),W=new xe(j.getX()-.5,j.getY()-.5);return this.expandSquare([E,R,U,W],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let m,p,g,N;try{let E=new Ct(this.image).detect();m=E[0],p=E[1],g=E[2],N=E[3]}catch{let R=this.image.getWidth()/2,U=this.image.getHeight()/2;m=this.getFirstDifferent(new ie(R+7,U-7),!1,1,-1).toResultPoint(),p=this.getFirstDifferent(new ie(R+7,U+7),!1,1,1).toResultPoint(),g=this.getFirstDifferent(new ie(R-7,U+7),!1,-1,1).toResultPoint(),N=this.getFirstDifferent(new ie(R-7,U-7),!1,-1,-1).toResultPoint()}let j=ve.round((m.getX()+N.getX()+p.getX()+g.getX())/4),C=ve.round((m.getY()+N.getY()+p.getY()+g.getY())/4);try{let E=new Ct(this.image,15,j,C).detect();m=E[0],p=E[1],g=E[2],N=E[3]}catch{m=this.getFirstDifferent(new ie(j+7,C-7),!1,1,-1).toResultPoint(),p=this.getFirstDifferent(new ie(j+7,C+7),!1,1,1).toResultPoint(),g=this.getFirstDifferent(new ie(j-7,C+7),!1,-1,1).toResultPoint(),N=this.getFirstDifferent(new ie(j-7,C-7),!1,-1,-1).toResultPoint()}return j=ve.round((m.getX()+N.getX()+p.getX()+g.getX())/4),C=ve.round((m.getY()+N.getY()+p.getY()+g.getY())/4),new ie(j,C)}getMatrixCornerPoints(m){return this.expandSquare(m,2*this.nbCenterLayers,this.getDimension())}sampleGrid(m,p,g,N,j){let C=ds.getInstance(),E=this.getDimension(),R=E/2-this.nbCenterLayers,U=E/2+this.nbCenterLayers;return C.sampleGrid(m,E,E,R,R,U,R,U,U,R,U,p.getX(),p.getY(),g.getX(),g.getY(),N.getX(),N.getY(),j.getX(),j.getY())}sampleLine(m,p,g){let N=0,j=this.distanceResultPoint(m,p),C=j/g,E=m.getX(),R=m.getY(),U=C*(p.getX()-m.getX())/j,W=C*(p.getY()-m.getY())/j;for(let Y=0;Y<g;Y++)this.image.get(ve.round(E+Y*U),ve.round(R+Y*W))&&(N|=1<<g-Y-1);return N}isWhiteOrBlackRectangle(m,p,g,N){let j=3;m=new ie(m.getX()-j,m.getY()+j),p=new ie(p.getX()-j,p.getY()-j),g=new ie(g.getX()+j,g.getY()-j),N=new ie(N.getX()+j,N.getY()+j);let C=this.getColor(N,m);if(C===0)return!1;let E=this.getColor(m,p);return E!==C||(E=this.getColor(p,g),E!==C)?!1:(E=this.getColor(g,N),E===C)}getColor(m,p){let g=this.distancePoint(m,p),N=(p.getX()-m.getX())/g,j=(p.getY()-m.getY())/g,C=0,E=m.getX(),R=m.getY(),U=this.image.get(m.getX(),m.getY()),W=Math.ceil(g);for(let Z=0;Z<W;Z++)E+=N,R+=j,this.image.get(ve.round(E),ve.round(R))!==U&&C++;let Y=C/g;return Y>.1&&Y<.9?0:Y<=.1===U?1:-1}getFirstDifferent(m,p,g,N){let j=m.getX()+g,C=m.getY()+N;for(;this.isValid(j,C)&&this.image.get(j,C)===p;)j+=g,C+=N;for(j-=g,C-=N;this.isValid(j,C)&&this.image.get(j,C)===p;)j+=g;for(j-=g;this.isValid(j,C)&&this.image.get(j,C)===p;)C+=N;return C-=N,new ie(j,C)}expandSquare(m,p,g){let N=g/(2*p),j=m[0].getX()-m[2].getX(),C=m[0].getY()-m[2].getY(),E=(m[0].getX()+m[2].getX())/2,R=(m[0].getY()+m[2].getY())/2,U=new xe(E+N*j,R+N*C),W=new xe(E-N*j,R-N*C);j=m[1].getX()-m[3].getX(),C=m[1].getY()-m[3].getY(),E=(m[1].getX()+m[3].getX())/2,R=(m[1].getY()+m[3].getY())/2;let Y=new xe(E+N*j,R+N*C),Z=new xe(E-N*j,R-N*C);return[U,Y,W,Z]}isValid(m,p){return m>=0&&m<this.image.getWidth()&&p>0&&p<this.image.getHeight()}isValidPoint(m){let p=ve.round(m.getX()),g=ve.round(m.getY());return this.isValid(p,g)}distancePoint(m,p){return ve.distance(m.getX(),m.getY(),p.getX(),p.getY())}distanceResultPoint(m,p){return ve.distance(m.getX(),m.getY(),p.getX(),p.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(A.truncDivision(this.nbLayers-4,8)+1)+15}}class he{decode(m,p=null){let g=null,N=new Ie(m.getBlackMatrix()),j=null,C=null;try{let W=N.detectMirror(!1);j=W.getPoints(),this.reportFoundResultPoints(p,j),C=new _t().decode(W)}catch(W){g=W}if(C==null)try{let W=N.detectMirror(!0);j=W.getPoints(),this.reportFoundResultPoints(p,j),C=new _t().decode(W)}catch(W){throw g??W}let E=new ce(C.getText(),C.getRawBytes(),C.getNumBits(),j,X.AZTEC,w.currentTimeMillis()),R=C.getByteSegments();R!=null&&E.putMetadata(Ce.BYTE_SEGMENTS,R);let U=C.getECLevel();return U!=null&&E.putMetadata(Ce.ERROR_CORRECTION_LEVEL,U),E}reportFoundResultPoints(m,p){if(m!=null){let g=m.get(O.NEED_RESULT_POINT_CALLBACK);g!=null&&p.forEach((N,j,C)=>{g.foundPossibleResultPoint(N)})}}reset(){}}class Me extends te{constructor(m=500){super(new he,m)}}class Ge{decode(m,p){try{return this.doDecode(m,p)}catch{if(p&&p.get(O.TRY_HARDER)===!0&&m.isRotateSupported()){const j=m.rotateCounterClockwise(),C=this.doDecode(j,p),E=C.getResultMetadata();let R=270;E!==null&&E.get(Ce.ORIENTATION)===!0&&(R=R+E.get(Ce.ORIENTATION)%360),C.putMetadata(Ce.ORIENTATION,R);const U=C.getResultPoints();if(U!==null){const W=j.getHeight();for(let Y=0;Y<U.length;Y++)U[Y]=new xe(W-U[Y].getY()-1,U[Y].getX())}return C}else throw new z}}reset(){}doDecode(m,p){const g=m.getWidth(),N=m.getHeight();let j=new T(g);const C=p&&p.get(O.TRY_HARDER)===!0,E=Math.max(1,N>>(C?8:5));let R;C?R=N:R=15;const U=Math.trunc(N/2);for(let W=0;W<R;W++){const Y=Math.trunc((W+1)/2),Z=(W&1)===0,le=U+E*(Z?Y:-Y);if(le<0||le>=N)break;try{j=m.getBlackRow(le,j)}catch{continue}for(let be=0;be<2;be++){if(be===1&&(j.reverse(),p&&p.get(O.NEED_RESULT_POINT_CALLBACK)===!0)){const Ne=new Map;p.forEach((Ae,Oe)=>Ne.set(Oe,Ae)),Ne.delete(O.NEED_RESULT_POINT_CALLBACK),p=Ne}try{const Ne=this.decodeRow(le,j,p);if(be===1){Ne.putMetadata(Ce.ORIENTATION,180);const Ae=Ne.getResultPoints();Ae!==null&&(Ae[0]=new xe(g-Ae[0].getX()-1,Ae[0].getY()),Ae[1]=new xe(g-Ae[1].getX()-1,Ae[1].getY()))}return Ne}catch{}}}throw new z}static recordPattern(m,p,g){const N=g.length;for(let U=0;U<N;U++)g[U]=0;const j=m.getSize();if(p>=j)throw new z;let C=!m.get(p),E=0,R=p;for(;R<j;){if(m.get(R)!==C)g[E]++;else{if(++E===N)break;g[E]=1,C=!C}R++}if(!(E===N||E===N-1&&R===j))throw new z}static recordPatternInReverse(m,p,g){let N=g.length,j=m.get(p);for(;p>0&&N>=0;)m.get(--p)!==j&&(N--,j=!j);if(N>=0)throw new z;Ge.recordPattern(m,p+1,g)}static patternMatchVariance(m,p,g){const N=m.length;let j=0,C=0;for(let U=0;U<N;U++)j+=m[U],C+=p[U];if(j<C)return Number.POSITIVE_INFINITY;const E=j/C;g*=E;let R=0;for(let U=0;U<N;U++){const W=m[U],Y=p[U]*E,Z=W>Y?W-Y:Y-W;if(Z>g)return Number.POSITIVE_INFINITY;R+=Z}return R/j}}class Be extends Ge{static findStartPattern(m){const p=m.getSize(),g=m.getNextSet(0);let N=0,j=Int32Array.from([0,0,0,0,0,0]),C=g,E=!1;const R=6;for(let U=g;U<p;U++)if(m.get(U)!==E)j[N]++;else{if(N===R-1){let W=Be.MAX_AVG_VARIANCE,Y=-1;for(let Z=Be.CODE_START_A;Z<=Be.CODE_START_C;Z++){const le=Ge.patternMatchVariance(j,Be.CODE_PATTERNS[Z],Be.MAX_INDIVIDUAL_VARIANCE);le<W&&(W=le,Y=Z)}if(Y>=0&&m.isRange(Math.max(0,C-(U-C)/2),C,!1))return Int32Array.from([C,U,Y]);C+=j[0]+j[1],j=j.slice(2,j.length-1),j[N-1]=0,j[N]=0,N--}else N++;j[N]=1,E=!E}throw new z}static decodeCode(m,p,g){Ge.recordPattern(m,g,p);let N=Be.MAX_AVG_VARIANCE,j=-1;for(let C=0;C<Be.CODE_PATTERNS.length;C++){const E=Be.CODE_PATTERNS[C],R=this.patternMatchVariance(p,E,Be.MAX_INDIVIDUAL_VARIANCE);R<N&&(N=R,j=C)}if(j>=0)return j;throw new z}decodeRow(m,p,g){const N=g&&g.get(O.ASSUME_GS1)===!0,j=Be.findStartPattern(p),C=j[2];let E=0;const R=new Uint8Array(20);R[E++]=C;let U;switch(C){case Be.CODE_START_A:U=Be.CODE_CODE_A;break;case Be.CODE_START_B:U=Be.CODE_CODE_B;break;case Be.CODE_START_C:U=Be.CODE_CODE_C;break;default:throw new D}let W=!1,Y=!1,Z="",le=j[0],be=j[1];const Ne=Int32Array.from([0,0,0,0,0,0]);let Ae=0,Oe=0,et=C,st=0,Ye=!0,cs=!1,Xt=!1;for(;!W;){const ah=Y;switch(Y=!1,Ae=Oe,Oe=Be.decodeCode(p,Ne,be),R[E++]=Oe,Oe!==Be.CODE_STOP&&(Ye=!0),Oe!==Be.CODE_STOP&&(st++,et+=st*Oe),le=be,be+=Ne.reduce((NY,wY)=>NY+wY,0),Oe){case Be.CODE_START_A:case Be.CODE_START_B:case Be.CODE_START_C:throw new D}switch(U){case Be.CODE_CODE_A:if(Oe<64)Xt===cs?Z+=String.fromCharCode(32+Oe):Z+=String.fromCharCode(32+Oe+128),Xt=!1;else if(Oe<96)Xt===cs?Z+=String.fromCharCode(Oe-64):Z+=String.fromCharCode(Oe+64),Xt=!1;else switch(Oe!==Be.CODE_STOP&&(Ye=!1),Oe){case Be.CODE_FNC_1:N&&(Z.length===0?Z+="]C1":Z+="");break;case Be.CODE_FNC_2:case Be.CODE_FNC_3:break;case Be.CODE_FNC_4_A:!cs&&Xt?(cs=!0,Xt=!1):cs&&Xt?(cs=!1,Xt=!1):Xt=!0;break;case Be.CODE_SHIFT:Y=!0,U=Be.CODE_CODE_B;break;case Be.CODE_CODE_B:U=Be.CODE_CODE_B;break;case Be.CODE_CODE_C:U=Be.CODE_CODE_C;break;case Be.CODE_STOP:W=!0;break}break;case Be.CODE_CODE_B:if(Oe<96)Xt===cs?Z+=String.fromCharCode(32+Oe):Z+=String.fromCharCode(32+Oe+128),Xt=!1;else switch(Oe!==Be.CODE_STOP&&(Ye=!1),Oe){case Be.CODE_FNC_1:N&&(Z.length===0?Z+="]C1":Z+="");break;case Be.CODE_FNC_2:case Be.CODE_FNC_3:break;case Be.CODE_FNC_4_B:!cs&&Xt?(cs=!0,Xt=!1):cs&&Xt?(cs=!1,Xt=!1):Xt=!0;break;case Be.CODE_SHIFT:Y=!0,U=Be.CODE_CODE_A;break;case Be.CODE_CODE_A:U=Be.CODE_CODE_A;break;case Be.CODE_CODE_C:U=Be.CODE_CODE_C;break;case Be.CODE_STOP:W=!0;break}break;case Be.CODE_CODE_C:if(Oe<100)Oe<10&&(Z+="0"),Z+=Oe;else switch(Oe!==Be.CODE_STOP&&(Ye=!1),Oe){case Be.CODE_FNC_1:N&&(Z.length===0?Z+="]C1":Z+="");break;case Be.CODE_CODE_A:U=Be.CODE_CODE_A;break;case Be.CODE_CODE_B:U=Be.CODE_CODE_B;break;case Be.CODE_STOP:W=!0;break}break}ah&&(U=U===Be.CODE_CODE_A?Be.CODE_CODE_B:Be.CODE_CODE_A)}const _a=be-le;if(be=p.getNextUnset(be),!p.isRange(be,Math.min(p.getSize(),be+(be-le)/2),!1))throw new z;if(et-=st*Ae,et%103!==Ae)throw new b;const sl=Z.length;if(sl===0)throw new z;sl>0&&Ye&&(U===Be.CODE_CODE_C?Z=Z.substring(0,sl-2):Z=Z.substring(0,sl-1));const Sa=(j[1]+j[0])/2,Ms=le+_a/2,Ar=R.length,Ya=new Uint8Array(Ar);for(let ah=0;ah<Ar;ah++)Ya[ah]=R[ah];const rh=[new xe(Sa,m),new xe(Ms,m)];return new ce(Z,Ya,0,rh,X.CODE_128,new Date().getTime())}}Be.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Be.MAX_AVG_VARIANCE=.25,Be.MAX_INDIVIDUAL_VARIANCE=.7,Be.CODE_SHIFT=98,Be.CODE_CODE_C=99,Be.CODE_CODE_B=100,Be.CODE_CODE_A=101,Be.CODE_FNC_1=102,Be.CODE_FNC_2=97,Be.CODE_FNC_3=96,Be.CODE_FNC_4_A=101,Be.CODE_FNC_4_B=100,Be.CODE_START_A=103,Be.CODE_START_B=104,Be.CODE_START_C=105,Be.CODE_STOP=106;class Ot extends Ge{constructor(m=!1,p=!1){super(),this.usingCheckDigit=m,this.extendedMode=p,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(m,p,g){let N=this.counters;N.fill(0),this.decodeRowResult="";let j=Ot.findAsteriskPattern(p,N),C=p.getNextSet(j[1]),E=p.getSize(),R,U;do{Ot.recordPattern(p,C,N);let Ne=Ot.toNarrowWidePattern(N);if(Ne<0)throw new z;R=Ot.patternToChar(Ne),this.decodeRowResult+=R,U=C;for(let Ae of N)C+=Ae;C=p.getNextSet(C)}while(R!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let W=0;for(let Ne of N)W+=Ne;let Y=C-U-W;if(C!==E&&Y*2<W)throw new z;if(this.usingCheckDigit){let Ne=this.decodeRowResult.length-1,Ae=0;for(let Oe=0;Oe<Ne;Oe++)Ae+=Ot.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(Oe));if(this.decodeRowResult.charAt(Ne)!==Ot.ALPHABET_STRING.charAt(Ae%43))throw new b;this.decodeRowResult=this.decodeRowResult.substring(0,Ne)}if(this.decodeRowResult.length===0)throw new z;let Z;this.extendedMode?Z=Ot.decodeExtended(this.decodeRowResult):Z=this.decodeRowResult;let le=(j[1]+j[0])/2,be=U+W/2;return new ce(Z,null,0,[new xe(le,m),new xe(be,m)],X.CODE_39,new Date().getTime())}static findAsteriskPattern(m,p){let g=m.getSize(),N=m.getNextSet(0),j=0,C=N,E=!1,R=p.length;for(let U=N;U<g;U++)if(m.get(U)!==E)p[j]++;else{if(j===R-1){if(this.toNarrowWidePattern(p)===Ot.ASTERISK_ENCODING&&m.isRange(Math.max(0,C-Math.floor((U-C)/2)),C,!1))return[C,U];C+=p[0]+p[1],p.copyWithin(0,2,2+j-1),p[j-1]=0,p[j]=0,j--}else j++;p[j]=1,E=!E}throw new z}static toNarrowWidePattern(m){let p=m.length,g=0,N;do{let j=2147483647;for(let R of m)R<j&&R>g&&(j=R);g=j,N=0;let C=0,E=0;for(let R=0;R<p;R++){let U=m[R];U>g&&(E|=1<<p-1-R,N++,C+=U)}if(N===3){for(let R=0;R<p&&N>0;R++){let U=m[R];if(U>g&&(N--,U*2>=C))return-1}return E}}while(N>3);return-1}static patternToChar(m){for(let p=0;p<Ot.CHARACTER_ENCODINGS.length;p++)if(Ot.CHARACTER_ENCODINGS[p]===m)return Ot.ALPHABET_STRING.charAt(p);if(m===Ot.ASTERISK_ENCODING)return"*";throw new z}static decodeExtended(m){let p=m.length,g="";for(let N=0;N<p;N++){let j=m.charAt(N);if(j==="+"||j==="$"||j==="%"||j==="/"){let C=m.charAt(N+1),E="\0";switch(j){case"+":if(C>="A"&&C<="Z")E=String.fromCharCode(C.charCodeAt(0)+32);else throw new D;break;case"$":if(C>="A"&&C<="Z")E=String.fromCharCode(C.charCodeAt(0)-64);else throw new D;break;case"%":if(C>="A"&&C<="E")E=String.fromCharCode(C.charCodeAt(0)-38);else if(C>="F"&&C<="J")E=String.fromCharCode(C.charCodeAt(0)-11);else if(C>="K"&&C<="O")E=String.fromCharCode(C.charCodeAt(0)+16);else if(C>="P"&&C<="T")E=String.fromCharCode(C.charCodeAt(0)+43);else if(C==="U")E="\0";else if(C==="V")E="@";else if(C==="W")E="`";else if(C==="X"||C==="Y"||C==="Z")E="";else throw new D;break;case"/":if(C>="A"&&C<="O")E=String.fromCharCode(C.charCodeAt(0)-32);else if(C==="Z")E=":";else throw new D;break}g+=E,N++}else g+=j}return g}}Ot.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",Ot.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],Ot.ASTERISK_ENCODING=148;class Rt extends Ge{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(m,p,g){let N=this.decodeStart(p),j=this.decodeEnd(p),C=new V;Rt.decodeMiddle(p,N[1],j[0],C);let E=C.toString(),R=null;g!=null&&(R=g.get(O.ALLOWED_LENGTHS)),R==null&&(R=Rt.DEFAULT_ALLOWED_LENGTHS);let U=E.length,W=!1,Y=0;for(let be of R){if(U===be){W=!0;break}be>Y&&(Y=be)}if(!W&&U>Y&&(W=!0),!W)throw new D;const Z=[new xe(N[1],m),new xe(j[0],m)];return new ce(E,null,0,Z,X.ITF,new Date().getTime())}static decodeMiddle(m,p,g,N){let j=new Int32Array(10),C=new Int32Array(5),E=new Int32Array(5);for(j.fill(0),C.fill(0),E.fill(0);p<g;){Ge.recordPattern(m,p,j);for(let U=0;U<5;U++){let W=2*U;C[U]=j[W],E[U]=j[W+1]}let R=Rt.decodeDigit(C);N.append(R.toString()),R=this.decodeDigit(E),N.append(R.toString()),j.forEach(function(U){p+=U})}}decodeStart(m){let p=Rt.skipWhiteSpace(m),g=Rt.findGuardPattern(m,p,Rt.START_PATTERN);return this.narrowLineWidth=(g[1]-g[0])/4,this.validateQuietZone(m,g[0]),g}validateQuietZone(m,p){let g=this.narrowLineWidth*10;g=g<p?g:p;for(let N=p-1;g>0&&N>=0&&!m.get(N);N--)g--;if(g!==0)throw new z}static skipWhiteSpace(m){const p=m.getSize(),g=m.getNextSet(0);if(g===p)throw new z;return g}decodeEnd(m){m.reverse();try{let p=Rt.skipWhiteSpace(m),g;try{g=Rt.findGuardPattern(m,p,Rt.END_PATTERN_REVERSED[0])}catch(j){j instanceof z&&(g=Rt.findGuardPattern(m,p,Rt.END_PATTERN_REVERSED[1]))}this.validateQuietZone(m,g[0]);let N=g[0];return g[0]=m.getSize()-g[1],g[1]=m.getSize()-N,g}finally{m.reverse()}}static findGuardPattern(m,p,g){let N=g.length,j=new Int32Array(N),C=m.getSize(),E=!1,R=0,U=p;j.fill(0);for(let W=p;W<C;W++)if(m.get(W)!==E)j[R]++;else{if(R===N-1){if(Ge.patternMatchVariance(j,g,Rt.MAX_INDIVIDUAL_VARIANCE)<Rt.MAX_AVG_VARIANCE)return[U,W];U+=j[0]+j[1],w.arraycopy(j,2,j,0,R-1),j[R-1]=0,j[R]=0,R--}else R++;j[R]=1,E=!E}throw new z}static decodeDigit(m){let p=Rt.MAX_AVG_VARIANCE,g=-1,N=Rt.PATTERNS.length;for(let j=0;j<N;j++){let C=Rt.PATTERNS[j],E=Ge.patternMatchVariance(m,C,Rt.MAX_INDIVIDUAL_VARIANCE);E<p?(p=E,g=j):E===p&&(g=-1)}if(g>=0)return g%10;throw new z}}Rt.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Rt.MAX_AVG_VARIANCE=.38,Rt.MAX_INDIVIDUAL_VARIANCE=.5,Rt.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Rt.START_PATTERN=Int32Array.from([1,1,1,1]),Rt.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Jt extends Ge{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(m){let p=!1,g,N=0,j=Int32Array.from([0,0,0]);for(;!p;){j=Int32Array.from([0,0,0]),g=Jt.findGuardPattern(m,N,!1,this.START_END_PATTERN,j);let C=g[0];N=g[1];let E=C-(N-C);E>=0&&(p=m.isRange(E,C,!1))}return g}static checkChecksum(m){return Jt.checkStandardUPCEANChecksum(m)}static checkStandardUPCEANChecksum(m){let p=m.length;if(p===0)return!1;let g=parseInt(m.charAt(p-1),10);return Jt.getStandardUPCEANChecksum(m.substring(0,p-1))===g}static getStandardUPCEANChecksum(m){let p=m.length,g=0;for(let N=p-1;N>=0;N-=2){let j=m.charAt(N).charCodeAt(0)-48;if(j<0||j>9)throw new D;g+=j}g*=3;for(let N=p-2;N>=0;N-=2){let j=m.charAt(N).charCodeAt(0)-48;if(j<0||j>9)throw new D;g+=j}return(1e3-g)%10}static decodeEnd(m,p){return Jt.findGuardPattern(m,p,!1,Jt.START_END_PATTERN,new Int32Array(Jt.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(m,p,g,N){return this.findGuardPattern(m,p,g,N,new Int32Array(N.length))}static findGuardPattern(m,p,g,N,j){let C=m.getSize();p=g?m.getNextUnset(p):m.getNextSet(p);let E=0,R=p,U=N.length,W=g;for(let Y=p;Y<C;Y++)if(m.get(Y)!==W)j[E]++;else{if(E===U-1){if(Ge.patternMatchVariance(j,N,Jt.MAX_INDIVIDUAL_VARIANCE)<Jt.MAX_AVG_VARIANCE)return Int32Array.from([R,Y]);R+=j[0]+j[1];let Z=j.slice(2,j.length-1);for(let le=0;le<E-1;le++)j[le]=Z[le];j[E-1]=0,j[E]=0,E--}else E++;j[E]=1,W=!W}throw new z}static decodeDigit(m,p,g,N){this.recordPattern(m,g,p);let j=this.MAX_AVG_VARIANCE,C=-1,E=N.length;for(let R=0;R<E;R++){let U=N[R],W=Ge.patternMatchVariance(p,U,Jt.MAX_INDIVIDUAL_VARIANCE);W<j&&(j=W,C=R)}if(C>=0)return C;throw new z}}Jt.MAX_AVG_VARIANCE=.48,Jt.MAX_INDIVIDUAL_VARIANCE=.7,Jt.START_END_PATTERN=Int32Array.from([1,1,1]),Jt.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Jt.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Jt.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class ys{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(m,p,g){let N=this.decodeRowStringBuffer,j=this.decodeMiddle(p,g,N),C=N.toString(),E=ys.parseExtensionString(C),R=[new xe((g[0]+g[1])/2,m),new xe(j,m)],U=new ce(C,null,0,R,X.UPC_EAN_EXTENSION,new Date().getTime());return E!=null&&U.putAllMetadata(E),U}decodeMiddle(m,p,g){let N=this.decodeMiddleCounters;N[0]=0,N[1]=0,N[2]=0,N[3]=0;let j=m.getSize(),C=p[1],E=0;for(let U=0;U<5&&C<j;U++){let W=Jt.decodeDigit(m,N,C,Jt.L_AND_G_PATTERNS);g+=String.fromCharCode(48+W%10);for(let Y of N)C+=Y;W>=10&&(E|=1<<4-U),U!==4&&(C=m.getNextSet(C),C=m.getNextUnset(C))}if(g.length!==5)throw new z;let R=this.determineCheckDigit(E);if(ys.extensionChecksum(g.toString())!==R)throw new z;return C}static extensionChecksum(m){let p=m.length,g=0;for(let N=p-2;N>=0;N-=2)g+=m.charAt(N).charCodeAt(0)-48;g*=3;for(let N=p-1;N>=0;N-=2)g+=m.charAt(N).charCodeAt(0)-48;return g*=3,g%10}determineCheckDigit(m){for(let p=0;p<10;p++)if(m===this.CHECK_DIGIT_ENCODINGS[p])return p;throw new z}static parseExtensionString(m){if(m.length!==5)return null;let p=ys.parseExtension5String(m);return p==null?null:new Map([[Ce.SUGGESTED_PRICE,p]])}static parseExtension5String(m){let p;switch(m.charAt(0)){case"0":p="";break;case"5":p="$";break;case"9":switch(m){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}p="";break;default:p="";break}let g=parseInt(m.substring(1)),N=(g/100).toString(),j=g%100,C=j<10?"0"+j:j.toString();return p+N+"."+C}}class Qs{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(m,p,g){let N=this.decodeRowStringBuffer,j=this.decodeMiddle(p,g,N),C=N.toString(),E=Qs.parseExtensionString(C),R=[new xe((g[0]+g[1])/2,m),new xe(j,m)],U=new ce(C,null,0,R,X.UPC_EAN_EXTENSION,new Date().getTime());return E!=null&&U.putAllMetadata(E),U}decodeMiddle(m,p,g){let N=this.decodeMiddleCounters;N[0]=0,N[1]=0,N[2]=0,N[3]=0;let j=m.getSize(),C=p[1],E=0;for(let R=0;R<2&&C<j;R++){let U=Jt.decodeDigit(m,N,C,Jt.L_AND_G_PATTERNS);g+=String.fromCharCode(48+U%10);for(let W of N)C+=W;U>=10&&(E|=1<<1-R),R!==1&&(C=m.getNextSet(C),C=m.getNextUnset(C))}if(g.length!==2)throw new z;if(parseInt(g.toString())%4!==E)throw new z;return C}static parseExtensionString(m){return m.length!==2?null:new Map([[Ce.ISSUE_NUMBER,parseInt(m)]])}}class na{static decodeRow(m,p,g){let N=Jt.findGuardPattern(p,g,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new ys().decodeRow(m,p,N)}catch{return new Qs().decodeRow(m,p,N)}}}na.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class qt extends Jt{constructor(){super(),this.decodeRowStringBuffer="",qt.L_AND_G_PATTERNS=qt.L_PATTERNS.map(m=>Int32Array.from(m));for(let m=10;m<20;m++){let p=qt.L_PATTERNS[m-10],g=new Int32Array(p.length);for(let N=0;N<p.length;N++)g[N]=p[p.length-N-1];qt.L_AND_G_PATTERNS[m]=g}}decodeRow(m,p,g){let N=qt.findStartGuardPattern(p),j=g==null?null:g.get(O.NEED_RESULT_POINT_CALLBACK);if(j!=null){const Ye=new xe((N[0]+N[1])/2,m);j.foundPossibleResultPoint(Ye)}let C=this.decodeMiddle(p,N,this.decodeRowStringBuffer),E=C.rowOffset,R=C.resultString;if(j!=null){const Ye=new xe(E,m);j.foundPossibleResultPoint(Ye)}let U=this.decodeEnd(p,E);if(j!=null){const Ye=new xe((U[0]+U[1])/2,m);j.foundPossibleResultPoint(Ye)}let W=U[1],Y=W+(W-U[0]);if(Y>=p.getSize()||!p.isRange(W,Y,!1))throw new z;let Z=R.toString();if(Z.length<8)throw new D;if(!qt.checkChecksum(Z))throw new b;let le=(N[1]+N[0])/2,be=(U[1]+U[0])/2,Ne=this.getBarcodeFormat(),Ae=[new xe(le,m),new xe(be,m)],Oe=new ce(Z,null,0,Ae,Ne,new Date().getTime()),et=0;try{let Ye=na.decodeRow(m,p,U[1]);Oe.putMetadata(Ce.UPC_EAN_EXTENSION,Ye.getText()),Oe.putAllMetadata(Ye.getResultMetadata()),Oe.addResultPoints(Ye.getResultPoints()),et=Ye.getText().length}catch{}let st=g==null?null:g.get(O.ALLOWED_EAN_EXTENSIONS);if(st!=null){let Ye=!1;for(let cs in st)if(et.toString()===cs){Ye=!0;break}if(!Ye)throw new z}return Oe}decodeEnd(m,p){return qt.findGuardPattern(m,p,!1,qt.START_END_PATTERN,new Int32Array(qt.START_END_PATTERN.length).fill(0))}static checkChecksum(m){return qt.checkStandardUPCEANChecksum(m)}static checkStandardUPCEANChecksum(m){let p=m.length;if(p===0)return!1;let g=parseInt(m.charAt(p-1),10);return qt.getStandardUPCEANChecksum(m.substring(0,p-1))===g}static getStandardUPCEANChecksum(m){let p=m.length,g=0;for(let N=p-1;N>=0;N-=2){let j=m.charAt(N).charCodeAt(0)-48;if(j<0||j>9)throw new D;g+=j}g*=3;for(let N=p-2;N>=0;N-=2){let j=m.charAt(N).charCodeAt(0)-48;if(j<0||j>9)throw new D;g+=j}return(1e3-g)%10}}class Gt extends qt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(m,p,g){let N=this.decodeMiddleCounters;N[0]=0,N[1]=0,N[2]=0,N[3]=0;let j=m.getSize(),C=p[1],E=0;for(let U=0;U<6&&C<j;U++){let W=qt.decodeDigit(m,N,C,qt.L_AND_G_PATTERNS);g+=String.fromCharCode(48+W%10);for(let Y of N)C+=Y;W>=10&&(E|=1<<5-U)}g=Gt.determineFirstDigit(g,E),C=qt.findGuardPattern(m,C,!0,qt.MIDDLE_PATTERN,new Int32Array(qt.MIDDLE_PATTERN.length).fill(0))[1];for(let U=0;U<6&&C<j;U++){let W=qt.decodeDigit(m,N,C,qt.L_PATTERNS);g+=String.fromCharCode(48+W);for(let Y of N)C+=Y}return{rowOffset:C,resultString:g}}getBarcodeFormat(){return X.EAN_13}static determineFirstDigit(m,p){for(let g=0;g<10;g++)if(p===this.FIRST_DIGIT_ENCODINGS[g])return m=String.fromCharCode(48+g)+m,m;throw new z}}Gt.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class ra extends qt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(m,p,g){const N=this.decodeMiddleCounters;N[0]=0,N[1]=0,N[2]=0,N[3]=0;let j=m.getSize(),C=p[1];for(let R=0;R<4&&C<j;R++){let U=qt.decodeDigit(m,N,C,qt.L_PATTERNS);g+=String.fromCharCode(48+U);for(let W of N)C+=W}C=qt.findGuardPattern(m,C,!0,qt.MIDDLE_PATTERN,new Int32Array(qt.MIDDLE_PATTERN.length).fill(0))[1];for(let R=0;R<4&&C<j;R++){let U=qt.decodeDigit(m,N,C,qt.L_PATTERNS);g+=String.fromCharCode(48+U);for(let W of N)C+=W}return{rowOffset:C,resultString:g}}getBarcodeFormat(){return X.EAN_8}}class Mt extends qt{constructor(){super(...arguments),this.ean13Reader=new Gt}getBarcodeFormat(){return X.UPC_A}decode(m,p){return this.maybeReturnResult(this.ean13Reader.decode(m))}decodeRow(m,p,g){return this.maybeReturnResult(this.ean13Reader.decodeRow(m,p,g))}decodeMiddle(m,p,g){return this.ean13Reader.decodeMiddle(m,p,g)}maybeReturnResult(m){let p=m.getText();if(p.charAt(0)==="0"){let g=new ce(p.substring(1),null,null,m.getResultPoints(),X.UPC_A);return m.getResultMetadata()!=null&&g.putAllMetadata(m.getResultMetadata()),g}else throw new z}reset(){this.ean13Reader.reset()}}class we extends qt{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(m,p,g){const N=this.decodeMiddleCounters.map(U=>U);N[0]=0,N[1]=0,N[2]=0,N[3]=0;const j=m.getSize();let C=p[1],E=0;for(let U=0;U<6&&C<j;U++){const W=we.decodeDigit(m,N,C,we.L_AND_G_PATTERNS);g+=String.fromCharCode(48+W%10);for(let Y of N)C+=Y;W>=10&&(E|=1<<5-U)}let R=we.determineNumSysAndCheckDigit(g,E);return{rowOffset:C,resultString:R}}decodeEnd(m,p){return we.findGuardPatternWithoutCounters(m,p,!0,we.MIDDLE_END_PATTERN)}checkChecksum(m){return qt.checkChecksum(we.convertUPCEtoUPCA(m))}static determineNumSysAndCheckDigit(m,p){for(let g=0;g<=1;g++)for(let N=0;N<10;N++)if(p===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[g][N]){let j=String.fromCharCode(48+g),C=String.fromCharCode(48+N);return j+m+C}throw z.getNotFoundInstance()}getBarcodeFormat(){return X.UPC_E}static convertUPCEtoUPCA(m){const p=m.slice(1,7).split("").map(j=>j.charCodeAt(0)),g=new V;g.append(m.charAt(0));let N=p[5];switch(N){case 0:case 1:case 2:g.appendChars(p,0,2),g.append(N),g.append("0000"),g.appendChars(p,2,3);break;case 3:g.appendChars(p,0,3),g.append("00000"),g.appendChars(p,3,2);break;case 4:g.appendChars(p,0,4),g.append("00000"),g.append(p[4]);break;default:g.appendChars(p,0,5),g.append("0000"),g.append(N);break}return m.length>=8&&g.append(m.charAt(7)),g.toString()}}we.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),we.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class lt extends Ge{constructor(m){super();let p=m==null?null:m.get(O.POSSIBLE_FORMATS),g=[];a(p)?(g.push(new Gt),g.push(new Mt),g.push(new ra),g.push(new we)):(p.indexOf(X.EAN_13)>-1&&g.push(new Gt),p.indexOf(X.UPC_A)>-1&&g.push(new Mt),p.indexOf(X.EAN_8)>-1&&g.push(new ra),p.indexOf(X.UPC_E)>-1&&g.push(new we)),this.readers=g}decodeRow(m,p,g){for(let N of this.readers)try{const j=N.decodeRow(m,p,g),C=j.getBarcodeFormat()===X.EAN_13&&j.getText().charAt(0)==="0",E=g==null?null:g.get(O.POSSIBLE_FORMATS),R=E==null||E.includes(X.UPC_A);if(C&&R){const U=j.getRawBytes(),W=new ce(j.getText().substring(1),U,U?U.length:null,j.getResultPoints(),X.UPC_A);return W.putAllMetadata(j.getResultMetadata()),W}return j}catch{}throw new z}reset(){for(let m of this.readers)m.reset()}}class ht extends Ge{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(m,p){for(let g=0;g<p.length;g++)if(Ge.patternMatchVariance(m,p[g],ht.MAX_INDIVIDUAL_VARIANCE)<ht.MAX_AVG_VARIANCE)return g;throw new z}static count(m){return ve.sum(new Int32Array(m))}static increment(m,p){let g=0,N=p[0];for(let j=1;j<m.length;j++)p[j]>N&&(N=p[j],g=j);m[g]++}static decrement(m,p){let g=0,N=p[0];for(let j=1;j<m.length;j++)p[j]<N&&(N=p[j],g=j);m[g]--}static isFinderPattern(m){let p=m[0]+m[1],g=p+m[2]+m[3],N=p/g;if(N>=ht.MIN_FINDER_PATTERN_RATIO&&N<=ht.MAX_FINDER_PATTERN_RATIO){let j=Number.MAX_SAFE_INTEGER,C=Number.MIN_SAFE_INTEGER;for(let E of m)E>C&&(C=E),E<j&&(j=E);return C<10*j}return!1}}ht.MAX_AVG_VARIANCE=.2,ht.MAX_INDIVIDUAL_VARIANCE=.45,ht.MIN_FINDER_PATTERN_RATIO=9.5/12,ht.MAX_FINDER_PATTERN_RATIO=12.5/14;class Kt{constructor(m,p){this.value=m,this.checksumPortion=p}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(m){if(!(m instanceof Kt))return!1;const p=m;return this.value===p.value&&this.checksumPortion===p.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class Wt{constructor(m,p,g,N,j){this.value=m,this.startEnd=p,this.value=m,this.startEnd=p,this.resultPoints=new Array,this.resultPoints.push(new xe(g,j)),this.resultPoints.push(new xe(N,j))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(m){if(!(m instanceof Wt))return!1;const p=m;return this.value===p.value}hashCode(){return this.value}}class Ht{constructor(){}static getRSSvalue(m,p,g){let N=0;for(let R of m)N+=R;let j=0,C=0,E=m.length;for(let R=0;R<E-1;R++){let U;for(U=1,C|=1<<R;U<m[R];U++,C&=~(1<<R)){let W=Ht.combins(N-U-1,E-R-2);if(g&&C===0&&N-U-(E-R-1)>=E-R-1&&(W-=Ht.combins(N-U-(E-R),E-R-2)),E-R-1>1){let Y=0;for(let Z=N-U-(E-R-2);Z>p;Z--)Y+=Ht.combins(N-U-Z-1,E-R-3);W-=Y*(E-1-R)}else N-U>p&&W--;j+=W}N-=U}return j}static combins(m,p){let g,N;m-p>p?(N=p,g=m-p):(N=m-p,g=p);let j=1,C=1;for(let E=m;E>g;E--)j*=E,C<=N&&(j/=C,C++);for(;C<=N;)j/=C,C++;return j}}class Ls{static buildBitArray(m){let p=m.length*2-1;m[m.length-1].getRightChar()==null&&(p-=1);let g=12*p,N=new T(g),j=0,E=m[0].getRightChar().getValue();for(let R=11;R>=0;--R)E&1<<R&&N.set(j),j++;for(let R=1;R<m.length;++R){let U=m[R],W=U.getLeftChar().getValue();for(let Y=11;Y>=0;--Y)W&1<<Y&&N.set(j),j++;if(U.getRightChar()!=null){let Y=U.getRightChar().getValue();for(let Z=11;Z>=0;--Z)Y&1<<Z&&N.set(j),j++}}return N}}class bs{constructor(m,p){p?this.decodedInformation=null:(this.finished=m,this.decodedInformation=p)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class on{constructor(m){this.newPosition=m}getNewPosition(){return this.newPosition}}class ws extends on{constructor(m,p){super(m),this.value=p}getValue(){return this.value}isFNC1(){return this.value===ws.FNC1}}ws.FNC1="$";class yn extends on{constructor(m,p,g){super(m),g?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=p}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class bn extends on{constructor(m,p,g){if(super(m),p<0||p>10||g<0||g>10)throw new D;this.firstDigit=p,this.secondDigit=g}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===bn.FNC1}isSecondDigitFNC1(){return this.secondDigit===bn.FNC1}isAnyFNC1(){return this.firstDigit===bn.FNC1||this.secondDigit===bn.FNC1}}bn.FNC1=10;class dt{constructor(){}static parseFieldsInGeneralPurpose(m){if(!m)return null;if(m.length<2)throw new z;let p=m.substring(0,2);for(let j of dt.TWO_DIGIT_DATA_LENGTH)if(j[0]===p)return j[1]===dt.VARIABLE_LENGTH?dt.processVariableAI(2,j[2],m):dt.processFixedAI(2,j[1],m);if(m.length<3)throw new z;let g=m.substring(0,3);for(let j of dt.THREE_DIGIT_DATA_LENGTH)if(j[0]===g)return j[1]===dt.VARIABLE_LENGTH?dt.processVariableAI(3,j[2],m):dt.processFixedAI(3,j[1],m);for(let j of dt.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(j[0]===g)return j[1]===dt.VARIABLE_LENGTH?dt.processVariableAI(4,j[2],m):dt.processFixedAI(4,j[1],m);if(m.length<4)throw new z;let N=m.substring(0,4);for(let j of dt.FOUR_DIGIT_DATA_LENGTH)if(j[0]===N)return j[1]===dt.VARIABLE_LENGTH?dt.processVariableAI(4,j[2],m):dt.processFixedAI(4,j[1],m);throw new z}static processFixedAI(m,p,g){if(g.length<m)throw new z;let N=g.substring(0,m);if(g.length<m+p)throw new z;let j=g.substring(m,m+p),C=g.substring(m+p),E="("+N+")"+j,R=dt.parseFieldsInGeneralPurpose(C);return R==null?E:E+R}static processVariableAI(m,p,g){let N=g.substring(0,m),j;g.length<m+p?j=g.length:j=m+p;let C=g.substring(m,j),E=g.substring(j),R="("+N+")"+C,U=dt.parseFieldsInGeneralPurpose(E);return U==null?R:R+U}}dt.VARIABLE_LENGTH=[],dt.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",dt.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",dt.VARIABLE_LENGTH,20],["22",dt.VARIABLE_LENGTH,29],["30",dt.VARIABLE_LENGTH,8],["37",dt.VARIABLE_LENGTH,8],["90",dt.VARIABLE_LENGTH,30],["91",dt.VARIABLE_LENGTH,30],["92",dt.VARIABLE_LENGTH,30],["93",dt.VARIABLE_LENGTH,30],["94",dt.VARIABLE_LENGTH,30],["95",dt.VARIABLE_LENGTH,30],["96",dt.VARIABLE_LENGTH,30],["97",dt.VARIABLE_LENGTH,3],["98",dt.VARIABLE_LENGTH,30],["99",dt.VARIABLE_LENGTH,30]],dt.THREE_DIGIT_DATA_LENGTH=[["240",dt.VARIABLE_LENGTH,30],["241",dt.VARIABLE_LENGTH,30],["242",dt.VARIABLE_LENGTH,6],["250",dt.VARIABLE_LENGTH,30],["251",dt.VARIABLE_LENGTH,30],["253",dt.VARIABLE_LENGTH,17],["254",dt.VARIABLE_LENGTH,20],["400",dt.VARIABLE_LENGTH,30],["401",dt.VARIABLE_LENGTH,30],["402",17],["403",dt.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",dt.VARIABLE_LENGTH,20],["421",dt.VARIABLE_LENGTH,15],["422",3],["423",dt.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],dt.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",dt.VARIABLE_LENGTH,15],["391",dt.VARIABLE_LENGTH,18],["392",dt.VARIABLE_LENGTH,15],["393",dt.VARIABLE_LENGTH,18],["703",dt.VARIABLE_LENGTH,30]],dt.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",dt.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",dt.VARIABLE_LENGTH,20],["8003",dt.VARIABLE_LENGTH,30],["8004",dt.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",dt.VARIABLE_LENGTH,30],["8008",dt.VARIABLE_LENGTH,12],["8018",18],["8020",dt.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",dt.VARIABLE_LENGTH,70],["8200",dt.VARIABLE_LENGTH,70]];class va{constructor(m){this.buffer=new V,this.information=m}decodeAllCodes(m,p){let g=p,N=null;do{let j=this.decodeGeneralPurposeField(g,N),C=dt.parseFieldsInGeneralPurpose(j.getNewString());if(C!=null&&m.append(C),j.isRemaining()?N=""+j.getRemainingValue():N=null,g===j.getNewPosition())break;g=j.getNewPosition()}while(!0);return m.toString()}isStillNumeric(m){if(m+7>this.information.getSize())return m+4<=this.information.getSize();for(let p=m;p<m+3;++p)if(this.information.get(p))return!0;return this.information.get(m+3)}decodeNumeric(m){if(m+7>this.information.getSize()){let j=this.extractNumericValueFromBitArray(m,4);return j===0?new bn(this.information.getSize(),bn.FNC1,bn.FNC1):new bn(this.information.getSize(),j-1,bn.FNC1)}let p=this.extractNumericValueFromBitArray(m,7),g=(p-8)/11,N=(p-8)%11;return new bn(m+7,g,N)}extractNumericValueFromBitArray(m,p){return va.extractNumericValueFromBitArray(this.information,m,p)}static extractNumericValueFromBitArray(m,p,g){let N=0;for(let j=0;j<g;++j)m.get(p+j)&&(N|=1<<g-j-1);return N}decodeGeneralPurposeField(m,p){this.buffer.setLengthToZero(),p!=null&&this.buffer.append(p),this.current.setPosition(m);let g=this.parseBlocks();return g!=null&&g.isRemaining()?new yn(this.current.getPosition(),this.buffer.toString(),g.getRemainingValue()):new yn(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let m,p;do{let g=this.current.getPosition();if(this.current.isAlpha()?(p=this.parseAlphaBlock(),m=p.isFinished()):this.current.isIsoIec646()?(p=this.parseIsoIec646Block(),m=p.isFinished()):(p=this.parseNumericBlock(),m=p.isFinished()),!(g!==this.current.getPosition())&&!m)break}while(!m);return p.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let m=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(m.getNewPosition()),m.isFirstDigitFNC1()){let p;return m.isSecondDigitFNC1()?p=new yn(this.current.getPosition(),this.buffer.toString()):p=new yn(this.current.getPosition(),this.buffer.toString(),m.getSecondDigit()),new bs(!0,p)}if(this.buffer.append(m.getFirstDigit()),m.isSecondDigitFNC1()){let p=new yn(this.current.getPosition(),this.buffer.toString());return new bs(!0,p)}this.buffer.append(m.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new bs(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let m=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(m.getNewPosition()),m.isFNC1()){let p=new yn(this.current.getPosition(),this.buffer.toString());return new bs(!0,p)}this.buffer.append(m.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new bs(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let m=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(m.getNewPosition()),m.isFNC1()){let p=new yn(this.current.getPosition(),this.buffer.toString());return new bs(!0,p)}this.buffer.append(m.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new bs(!1)}isStillIsoIec646(m){if(m+5>this.information.getSize())return!1;let p=this.extractNumericValueFromBitArray(m,5);if(p>=5&&p<16)return!0;if(m+7>this.information.getSize())return!1;let g=this.extractNumericValueFromBitArray(m,7);if(g>=64&&g<116)return!0;if(m+8>this.information.getSize())return!1;let N=this.extractNumericValueFromBitArray(m,8);return N>=232&&N<253}decodeIsoIec646(m){let p=this.extractNumericValueFromBitArray(m,5);if(p===15)return new ws(m+5,ws.FNC1);if(p>=5&&p<15)return new ws(m+5,"0"+(p-5));let g=this.extractNumericValueFromBitArray(m,7);if(g>=64&&g<90)return new ws(m+7,""+(g+1));if(g>=90&&g<116)return new ws(m+7,""+(g+7));let N=this.extractNumericValueFromBitArray(m,8),j;switch(N){case 232:j="!";break;case 233:j='"';break;case 234:j="%";break;case 235:j="&";break;case 236:j="'";break;case 237:j="(";break;case 238:j=")";break;case 239:j="*";break;case 240:j="+";break;case 241:j=",";break;case 242:j="-";break;case 243:j=".";break;case 244:j="/";break;case 245:j=":";break;case 246:j=";";break;case 247:j="<";break;case 248:j="=";break;case 249:j=">";break;case 250:j="?";break;case 251:j="_";break;case 252:j=" ";break;default:throw new D}return new ws(m+8,j)}isStillAlpha(m){if(m+5>this.information.getSize())return!1;let p=this.extractNumericValueFromBitArray(m,5);if(p>=5&&p<16)return!0;if(m+6>this.information.getSize())return!1;let g=this.extractNumericValueFromBitArray(m,6);return g>=16&&g<63}decodeAlphanumeric(m){let p=this.extractNumericValueFromBitArray(m,5);if(p===15)return new ws(m+5,ws.FNC1);if(p>=5&&p<15)return new ws(m+5,"0"+(p-5));let g=this.extractNumericValueFromBitArray(m,6);if(g>=32&&g<58)return new ws(m+6,""+(g+33));let N;switch(g){case 58:N="*";break;case 59:N=",";break;case 60:N="-";break;case 61:N=".";break;case 62:N="/";break;default:throw new jt("Decoding invalid alphanumeric value: "+g)}return new ws(m+6,N)}isAlphaTo646ToAlphaLatch(m){if(m+1>this.information.getSize())return!1;for(let p=0;p<5&&p+m<this.information.getSize();++p)if(p===2){if(!this.information.get(m+2))return!1}else if(this.information.get(m+p))return!1;return!0}isAlphaOr646ToNumericLatch(m){if(m+3>this.information.getSize())return!1;for(let p=m;p<m+3;++p)if(this.information.get(p))return!1;return!0}isNumericToAlphaNumericLatch(m){if(m+1>this.information.getSize())return!1;for(let p=0;p<4&&p+m<this.information.getSize();++p)if(this.information.get(m+p))return!1;return!0}}class Wa{constructor(m){this.information=m,this.generalDecoder=new va(m)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class Xn extends Wa{constructor(m){super(m)}encodeCompressedGtin(m,p){m.append("(01)");let g=m.length();m.append("9"),this.encodeCompressedGtinWithoutAI(m,p,g)}encodeCompressedGtinWithoutAI(m,p,g){for(let N=0;N<4;++N){let j=this.getGeneralDecoder().extractNumericValueFromBitArray(p+10*N,10);j/100===0&&m.append("0"),j/10===0&&m.append("0"),m.append(j)}Xn.appendCheckDigit(m,g)}static appendCheckDigit(m,p){let g=0;for(let N=0;N<13;N++){let j=m.charAt(N+p).charCodeAt(0)-48;g+=N&1?j:3*j}g=10-g%10,g===10&&(g=0),m.append(g)}}Xn.GTIN_SIZE=40;class Ji extends Xn{constructor(m){super(m)}parseInformation(){let m=new V;m.append("(01)");let p=m.length(),g=this.getGeneralDecoder().extractNumericValueFromBitArray(Ji.HEADER_SIZE,4);return m.append(g),this.encodeCompressedGtinWithoutAI(m,Ji.HEADER_SIZE+4,p),this.getGeneralDecoder().decodeAllCodes(m,Ji.HEADER_SIZE+44)}}Ji.HEADER_SIZE=4;class Ad extends Wa{constructor(m){super(m)}parseInformation(){let m=new V;return this.getGeneralDecoder().decodeAllCodes(m,Ad.HEADER_SIZE)}}Ad.HEADER_SIZE=5;class cc extends Xn{constructor(m){super(m)}encodeCompressedWeight(m,p,g){let N=this.getGeneralDecoder().extractNumericValueFromBitArray(p,g);this.addWeightCode(m,N);let j=this.checkWeight(N),C=1e5;for(let E=0;E<5;++E)j/C===0&&m.append("0"),C/=10;m.append(j)}}class qa extends cc{constructor(m){super(m)}parseInformation(){if(this.getInformation().getSize()!=qa.HEADER_SIZE+cc.GTIN_SIZE+qa.WEIGHT_SIZE)throw new z;let m=new V;return this.encodeCompressedGtin(m,qa.HEADER_SIZE),this.encodeCompressedWeight(m,qa.HEADER_SIZE+cc.GTIN_SIZE,qa.WEIGHT_SIZE),m.toString()}}qa.HEADER_SIZE=5,qa.WEIGHT_SIZE=15;class x0 extends qa{constructor(m){super(m)}addWeightCode(m,p){m.append("(3103)")}checkWeight(m){return m}}class Ed extends qa{constructor(m){super(m)}addWeightCode(m,p){p<1e4?m.append("(3202)"):m.append("(3203)")}checkWeight(m){return m<1e4?m:m-1e4}}class aa extends Xn{constructor(m){super(m)}parseInformation(){if(this.getInformation().getSize()<aa.HEADER_SIZE+Xn.GTIN_SIZE)throw new z;let m=new V;this.encodeCompressedGtin(m,aa.HEADER_SIZE);let p=this.getGeneralDecoder().extractNumericValueFromBitArray(aa.HEADER_SIZE+Xn.GTIN_SIZE,aa.LAST_DIGIT_SIZE);m.append("(392"),m.append(p),m.append(")");let g=this.getGeneralDecoder().decodeGeneralPurposeField(aa.HEADER_SIZE+Xn.GTIN_SIZE+aa.LAST_DIGIT_SIZE,null);return m.append(g.getNewString()),m.toString()}}aa.HEADER_SIZE=8,aa.LAST_DIGIT_SIZE=2;class An extends Xn{constructor(m){super(m)}parseInformation(){if(this.getInformation().getSize()<An.HEADER_SIZE+Xn.GTIN_SIZE)throw new z;let m=new V;this.encodeCompressedGtin(m,An.HEADER_SIZE);let p=this.getGeneralDecoder().extractNumericValueFromBitArray(An.HEADER_SIZE+Xn.GTIN_SIZE,An.LAST_DIGIT_SIZE);m.append("(393"),m.append(p),m.append(")");let g=this.getGeneralDecoder().extractNumericValueFromBitArray(An.HEADER_SIZE+Xn.GTIN_SIZE+An.LAST_DIGIT_SIZE,An.FIRST_THREE_DIGITS_SIZE);g/100==0&&m.append("0"),g/10==0&&m.append("0"),m.append(g);let N=this.getGeneralDecoder().decodeGeneralPurposeField(An.HEADER_SIZE+Xn.GTIN_SIZE+An.LAST_DIGIT_SIZE+An.FIRST_THREE_DIGITS_SIZE,null);return m.append(N.getNewString()),m.toString()}}An.HEADER_SIZE=8,An.LAST_DIGIT_SIZE=2,An.FIRST_THREE_DIGITS_SIZE=10;class ks extends cc{constructor(m,p,g){super(m),this.dateCode=g,this.firstAIdigits=p}parseInformation(){if(this.getInformation().getSize()!=ks.HEADER_SIZE+ks.GTIN_SIZE+ks.WEIGHT_SIZE+ks.DATE_SIZE)throw new z;let m=new V;return this.encodeCompressedGtin(m,ks.HEADER_SIZE),this.encodeCompressedWeight(m,ks.HEADER_SIZE+ks.GTIN_SIZE,ks.WEIGHT_SIZE),this.encodeCompressedDate(m,ks.HEADER_SIZE+ks.GTIN_SIZE+ks.WEIGHT_SIZE),m.toString()}encodeCompressedDate(m,p){let g=this.getGeneralDecoder().extractNumericValueFromBitArray(p,ks.DATE_SIZE);if(g==38400)return;m.append("("),m.append(this.dateCode),m.append(")");let N=g%32;g/=32;let j=g%12+1;g/=12;let C=g;C/10==0&&m.append("0"),m.append(C),j/10==0&&m.append("0"),m.append(j),N/10==0&&m.append("0"),m.append(N)}addWeightCode(m,p){m.append("("),m.append(this.firstAIdigits),m.append(p/1e5),m.append(")")}checkWeight(m){return m%1e5}}ks.HEADER_SIZE=8,ks.WEIGHT_SIZE=20,ks.DATE_SIZE=16;function el(K){try{if(K.get(1))return new Ji(K);if(!K.get(2))return new Ad(K);switch(va.extractNumericValueFromBitArray(K,1,4)){case 4:return new x0(K);case 5:return new Ed(K)}switch(va.extractNumericValueFromBitArray(K,1,5)){case 12:return new aa(K);case 13:return new An(K)}switch(va.extractNumericValueFromBitArray(K,1,7)){case 56:return new ks(K,"310","11");case 57:return new ks(K,"320","11");case 58:return new ks(K,"310","13");case 59:return new ks(K,"320","13");case 60:return new ks(K,"310","15");case 61:return new ks(K,"320","15");case 62:return new ks(K,"310","17");case 63:return new ks(K,"320","17")}}catch(m){throw console.log(m),new jt("unknown decoder: "+K)}}class Ga{constructor(m,p,g,N){this.leftchar=m,this.rightchar=p,this.finderpattern=g,this.maybeLast=N}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(m,p){return m instanceof Ga?Ga.equalsOrNull(m.leftchar,p.leftchar)&&Ga.equalsOrNull(m.rightchar,p.rightchar)&&Ga.equalsOrNull(m.finderpattern,p.finderpattern):!1}static equalsOrNull(m,p){return m===null?p===null:Ga.equals(m,p)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class dc{constructor(m,p,g){this.pairs=m,this.rowNumber=p,this.wasReversed=g}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(m){return this.checkEqualitity(this,m)}toString(){return"{ "+this.pairs+" }"}equals(m,p){return m instanceof dc?this.checkEqualitity(m,p)&&m.wasReversed===p.wasReversed:!1}checkEqualitity(m,p){if(!m||!p)return;let g;return m.forEach((N,j)=>{p.forEach(C=>{N.getLeftChar().getValue()===C.getLeftChar().getValue()&&N.getRightChar().getValue()===C.getRightChar().getValue()&&N.getFinderPatter().getValue()===C.getFinderPatter().getValue()&&(g=!0)})}),g}}class Ue extends ht{constructor(m){super(...arguments),this.pairs=new Array(Ue.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=m===!0}decodeRow(m,p,g){this.pairs.length=0,this.startFromEven=!1;try{return Ue.constructResult(this.decodeRow2pairs(m,p))}catch(N){this.verbose&&console.log(N)}return this.pairs.length=0,this.startFromEven=!0,Ue.constructResult(this.decodeRow2pairs(m,p))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(m,p){let g=!1;for(;!g;)try{this.pairs.push(this.retrieveNextPair(p,this.pairs,m))}catch(j){if(j instanceof z){if(!this.pairs.length)throw new z;g=!0}}if(this.checkChecksum())return this.pairs;let N;if(this.rows.length?N=!0:N=!1,this.storeRow(m,!1),N){let j=this.checkRowsBoolean(!1);if(j!=null||(j=this.checkRowsBoolean(!0),j!=null))return j}throw new z}checkRowsBoolean(m){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,m&&(this.rows=this.rows.reverse());let p=null;try{p=this.checkRows(new Array,0)}catch(g){this.verbose&&console.log(g)}return m&&(this.rows=this.rows.reverse()),p}checkRows(m,p){for(let g=p;g<this.rows.length;g++){let N=this.rows[g];this.pairs.length=0;for(let C of m)this.pairs.push(C.getPairs());if(this.pairs.push(N.getPairs()),!Ue.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let j=new Array(m);j.push(N);try{return this.checkRows(j,g+1)}catch(C){this.verbose&&console.log(C)}}throw new z}static isValidSequence(m){for(let p of Ue.FINDER_PATTERN_SEQUENCES){if(m.length>p.length)continue;let g=!0;for(let N=0;N<m.length;N++)if(m[N].getFinderPattern().getValue()!=p[N]){g=!1;break}if(g)return!0}return!1}storeRow(m,p){let g=0,N=!1,j=!1;for(;g<this.rows.length;){let C=this.rows[g];if(C.getRowNumber()>m){j=C.isEquivalent(this.pairs);break}N=C.isEquivalent(this.pairs),g++}j||N||Ue.isPartialRow(this.pairs,this.rows)||(this.rows.push(g,new dc(this.pairs,m,p)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(m,p){for(let g of p)if(g.getPairs().length!==m.length){for(let N of g.getPairs())for(let j of m)if(Ga.equals(N,j))break}}static isPartialRow(m,p){for(let g of p){let N=!0;for(let j of m){let C=!1;for(let E of g.getPairs())if(j.equals(E)){C=!0;break}if(!C){N=!1;break}}if(N)return!0}return!1}getRows(){return this.rows}static constructResult(m){let p=Ls.buildBitArray(m),N=el(p).parseInformation(),j=m[0].getFinderPattern().getResultPoints(),C=m[m.length-1].getFinderPattern().getResultPoints(),E=[j[0],j[1],C[0],C[1]];return new ce(N,null,null,E,X.RSS_EXPANDED,null)}checkChecksum(){let m=this.pairs.get(0),p=m.getLeftChar(),g=m.getRightChar();if(g==null)return!1;let N=g.getChecksumPortion(),j=2;for(let E=1;E<this.pairs.size();++E){let R=this.pairs.get(E);N+=R.getLeftChar().getChecksumPortion(),j++;let U=R.getRightChar();U!=null&&(N+=U.getChecksumPortion(),j++)}return N%=211,211*(j-4)+N==p.getValue()}static getNextSecondBar(m,p){let g;return m.get(p)?(g=m.getNextUnset(p),g=m.getNextSet(g)):(g=m.getNextSet(p),g=m.getNextUnset(g)),g}retrieveNextPair(m,p,g){let N=p.length%2==0;this.startFromEven&&(N=!N);let j,C=!0,E=-1;do this.findNextPair(m,p,E),j=this.parseFoundFinderPattern(m,g,N),j==null?E=Ue.getNextSecondBar(m,this.startEnd[0]):C=!1;while(C);let R=this.decodeDataCharacter(m,j,N,!0);if(!this.isEmptyPair(p)&&p[p.length-1].mustBeLast())throw new z;let U;try{U=this.decodeDataCharacter(m,j,N,!1)}catch(W){U=null,this.verbose&&console.log(W)}return new Ga(R,U,j,!0)}isEmptyPair(m){return m.length===0}findNextPair(m,p,g){let N=this.getDecodeFinderCounters();N[0]=0,N[1]=0,N[2]=0,N[3]=0;let j=m.getSize(),C;g>=0?C=g:this.isEmptyPair(p)?C=0:C=p[p.length-1].getFinderPattern().getStartEnd()[1];let E=p.length%2!=0;this.startFromEven&&(E=!E);let R=!1;for(;C<j&&(R=!m.get(C),!!R);)C++;let U=0,W=C;for(let Y=C;Y<j;Y++)if(m.get(Y)!=R)N[U]++;else{if(U==3){if(E&&Ue.reverseCounters(N),Ue.isFinderPattern(N)){this.startEnd[0]=W,this.startEnd[1]=Y;return}E&&Ue.reverseCounters(N),W+=N[0]+N[1],N[0]=N[2],N[1]=N[3],N[2]=0,N[3]=0,U--}else U++;N[U]=1,R=!R}throw new z}static reverseCounters(m){let p=m.length;for(let g=0;g<p/2;++g){let N=m[g];m[g]=m[p-g-1],m[p-g-1]=N}}parseFoundFinderPattern(m,p,g){let N,j,C;if(g){let U=this.startEnd[0]-1;for(;U>=0&&!m.get(U);)U--;U++,N=this.startEnd[0]-U,j=U,C=this.startEnd[1]}else j=this.startEnd[0],C=m.getNextUnset(this.startEnd[1]+1),N=C-this.startEnd[1];let E=this.getDecodeFinderCounters();w.arraycopy(E,0,E,1,E.length-1),E[0]=N;let R;try{R=this.parseFinderValue(E,Ue.FINDER_PATTERNS)}catch{return null}return new Wt(R,[j,C],j,C,p)}decodeDataCharacter(m,p,g,N){let j=this.getDataCharacterCounters();for(let Ms=0;Ms<j.length;Ms++)j[Ms]=0;if(N)Ue.recordPatternInReverse(m,p.getStartEnd()[0],j);else{Ue.recordPattern(m,p.getStartEnd()[1],j);for(let Ms=0,Ar=j.length-1;Ms<Ar;Ms++,Ar--){let Ya=j[Ms];j[Ms]=j[Ar],j[Ar]=Ya}}let C=17,E=ve.sum(new Int32Array(j))/C,R=(p.getStartEnd()[1]-p.getStartEnd()[0])/15;if(Math.abs(E-R)/R>.3)throw new z;let U=this.getOddCounts(),W=this.getEvenCounts(),Y=this.getOddRoundingErrors(),Z=this.getEvenRoundingErrors();for(let Ms=0;Ms<j.length;Ms++){let Ar=1*j[Ms]/E,Ya=Ar+.5;if(Ya<1){if(Ar<.3)throw new z;Ya=1}else if(Ya>8){if(Ar>8.7)throw new z;Ya=8}let rh=Ms/2;Ms&1?(W[rh]=Ya,Z[rh]=Ar-Ya):(U[rh]=Ya,Y[rh]=Ar-Ya)}this.adjustOddEvenCounts(C);let le=4*p.getValue()+(g?0:2)+(N?0:1)-1,be=0,Ne=0;for(let Ms=U.length-1;Ms>=0;Ms--){if(Ue.isNotA1left(p,g,N)){let Ar=Ue.WEIGHTS[le][2*Ms];Ne+=U[Ms]*Ar}be+=U[Ms]}let Ae=0;for(let Ms=W.length-1;Ms>=0;Ms--)if(Ue.isNotA1left(p,g,N)){let Ar=Ue.WEIGHTS[le][2*Ms+1];Ae+=W[Ms]*Ar}let Oe=Ne+Ae;if(be&1||be>13||be<4)throw new z;let et=(13-be)/2,st=Ue.SYMBOL_WIDEST[et],Ye=9-st,cs=Ht.getRSSvalue(U,st,!0),Xt=Ht.getRSSvalue(W,Ye,!1),_a=Ue.EVEN_TOTAL_SUBSET[et],sl=Ue.GSUM[et],Sa=cs*_a+Xt+sl;return new Kt(Sa,Oe)}static isNotA1left(m,p,g){return!(m.getValue()==0&&p&&g)}adjustOddEvenCounts(m){let p=ve.sum(new Int32Array(this.getOddCounts())),g=ve.sum(new Int32Array(this.getEvenCounts())),N=!1,j=!1;p>13?j=!0:p<4&&(N=!0);let C=!1,E=!1;g>13?E=!0:g<4&&(C=!0);let R=p+g-m,U=(p&1)==1,W=(g&1)==0;if(R==1)if(U){if(W)throw new z;j=!0}else{if(!W)throw new z;E=!0}else if(R==-1)if(U){if(W)throw new z;N=!0}else{if(!W)throw new z;C=!0}else if(R==0){if(U){if(!W)throw new z;p<g?(N=!0,E=!0):(j=!0,C=!0)}else if(W)throw new z}else throw new z;if(N){if(j)throw new z;Ue.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(j&&Ue.decrement(this.getOddCounts(),this.getOddRoundingErrors()),C){if(E)throw new z;Ue.increment(this.getEvenCounts(),this.getOddRoundingErrors())}E&&Ue.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Ue.SYMBOL_WIDEST=[7,5,4,3,1],Ue.EVEN_TOTAL_SUBSET=[4,20,52,104,204],Ue.GSUM=[0,348,1388,2948,3988],Ue.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],Ue.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],Ue.FINDER_PAT_A=0,Ue.FINDER_PAT_B=1,Ue.FINDER_PAT_C=2,Ue.FINDER_PAT_D=3,Ue.FINDER_PAT_E=4,Ue.FINDER_PAT_F=5,Ue.FINDER_PATTERN_SEQUENCES=[[Ue.FINDER_PAT_A,Ue.FINDER_PAT_A],[Ue.FINDER_PAT_A,Ue.FINDER_PAT_B,Ue.FINDER_PAT_B],[Ue.FINDER_PAT_A,Ue.FINDER_PAT_C,Ue.FINDER_PAT_B,Ue.FINDER_PAT_D],[Ue.FINDER_PAT_A,Ue.FINDER_PAT_E,Ue.FINDER_PAT_B,Ue.FINDER_PAT_D,Ue.FINDER_PAT_C],[Ue.FINDER_PAT_A,Ue.FINDER_PAT_E,Ue.FINDER_PAT_B,Ue.FINDER_PAT_D,Ue.FINDER_PAT_D,Ue.FINDER_PAT_F],[Ue.FINDER_PAT_A,Ue.FINDER_PAT_E,Ue.FINDER_PAT_B,Ue.FINDER_PAT_D,Ue.FINDER_PAT_E,Ue.FINDER_PAT_F,Ue.FINDER_PAT_F],[Ue.FINDER_PAT_A,Ue.FINDER_PAT_A,Ue.FINDER_PAT_B,Ue.FINDER_PAT_B,Ue.FINDER_PAT_C,Ue.FINDER_PAT_C,Ue.FINDER_PAT_D,Ue.FINDER_PAT_D],[Ue.FINDER_PAT_A,Ue.FINDER_PAT_A,Ue.FINDER_PAT_B,Ue.FINDER_PAT_B,Ue.FINDER_PAT_C,Ue.FINDER_PAT_C,Ue.FINDER_PAT_D,Ue.FINDER_PAT_E,Ue.FINDER_PAT_E],[Ue.FINDER_PAT_A,Ue.FINDER_PAT_A,Ue.FINDER_PAT_B,Ue.FINDER_PAT_B,Ue.FINDER_PAT_C,Ue.FINDER_PAT_C,Ue.FINDER_PAT_D,Ue.FINDER_PAT_E,Ue.FINDER_PAT_F,Ue.FINDER_PAT_F],[Ue.FINDER_PAT_A,Ue.FINDER_PAT_A,Ue.FINDER_PAT_B,Ue.FINDER_PAT_B,Ue.FINDER_PAT_C,Ue.FINDER_PAT_D,Ue.FINDER_PAT_D,Ue.FINDER_PAT_E,Ue.FINDER_PAT_E,Ue.FINDER_PAT_F,Ue.FINDER_PAT_F]],Ue.MAX_PAIRS=11;class af extends Kt{constructor(m,p,g){super(m,p),this.count=0,this.finderPattern=g}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Ps extends ht{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(m,p,g){const N=this.decodePair(p,!1,m,g);Ps.addOrTally(this.possibleLeftPairs,N),p.reverse();let j=this.decodePair(p,!0,m,g);Ps.addOrTally(this.possibleRightPairs,j),p.reverse();for(let C of this.possibleLeftPairs)if(C.getCount()>1){for(let E of this.possibleRightPairs)if(E.getCount()>1&&Ps.checkChecksum(C,E))return Ps.constructResult(C,E)}throw new z}static addOrTally(m,p){if(p==null)return;let g=!1;for(let N of m)if(N.getValue()===p.getValue()){N.incrementCount(),g=!0;break}g||m.push(p)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(m,p){let g=4537077*m.getValue()+p.getValue(),N=new String(g).toString(),j=new V;for(let U=13-N.length;U>0;U--)j.append("0");j.append(N);let C=0;for(let U=0;U<13;U++){let W=j.charAt(U).charCodeAt(0)-48;C+=U&1?W:3*W}C=10-C%10,C===10&&(C=0),j.append(C.toString());let E=m.getFinderPattern().getResultPoints(),R=p.getFinderPattern().getResultPoints();return new ce(j.toString(),null,0,[E[0],E[1],R[0],R[1]],X.RSS_14,new Date().getTime())}static checkChecksum(m,p){let g=(m.getChecksumPortion()+16*p.getChecksumPortion())%79,N=9*m.getFinderPattern().getValue()+p.getFinderPattern().getValue();return N>72&&N--,N>8&&N--,g===N}decodePair(m,p,g,N){try{let j=this.findFinderPattern(m,p),C=this.parseFoundFinderPattern(m,g,p,j),E=N==null?null:N.get(O.NEED_RESULT_POINT_CALLBACK);if(E!=null){let W=(j[0]+j[1])/2;p&&(W=m.getSize()-1-W),E.foundPossibleResultPoint(new xe(W,g))}let R=this.decodeDataCharacter(m,C,!0),U=this.decodeDataCharacter(m,C,!1);return new af(1597*R.getValue()+U.getValue(),R.getChecksumPortion()+4*U.getChecksumPortion(),C)}catch{return null}}decodeDataCharacter(m,p,g){let N=this.getDataCharacterCounters();for(let Ae=0;Ae<N.length;Ae++)N[Ae]=0;if(g)Ge.recordPatternInReverse(m,p.getStartEnd()[0],N);else{Ge.recordPattern(m,p.getStartEnd()[1]+1,N);for(let Ae=0,Oe=N.length-1;Ae<Oe;Ae++,Oe--){let et=N[Ae];N[Ae]=N[Oe],N[Oe]=et}}let j=g?16:15,C=ve.sum(new Int32Array(N))/j,E=this.getOddCounts(),R=this.getEvenCounts(),U=this.getOddRoundingErrors(),W=this.getEvenRoundingErrors();for(let Ae=0;Ae<N.length;Ae++){let Oe=N[Ae]/C,et=Math.floor(Oe+.5);et<1?et=1:et>8&&(et=8);let st=Math.floor(Ae/2);Ae&1?(R[st]=et,W[st]=Oe-et):(E[st]=et,U[st]=Oe-et)}this.adjustOddEvenCounts(g,j);let Y=0,Z=0;for(let Ae=E.length-1;Ae>=0;Ae--)Z*=9,Z+=E[Ae],Y+=E[Ae];let le=0,be=0;for(let Ae=R.length-1;Ae>=0;Ae--)le*=9,le+=R[Ae],be+=R[Ae];let Ne=Z+3*le;if(g){if(Y&1||Y>12||Y<4)throw new z;let Ae=(12-Y)/2,Oe=Ps.OUTSIDE_ODD_WIDEST[Ae],et=9-Oe,st=Ht.getRSSvalue(E,Oe,!1),Ye=Ht.getRSSvalue(R,et,!0),cs=Ps.OUTSIDE_EVEN_TOTAL_SUBSET[Ae],Xt=Ps.OUTSIDE_GSUM[Ae];return new Kt(st*cs+Ye+Xt,Ne)}else{if(be&1||be>10||be<4)throw new z;let Ae=(10-be)/2,Oe=Ps.INSIDE_ODD_WIDEST[Ae],et=9-Oe,st=Ht.getRSSvalue(E,Oe,!0),Ye=Ht.getRSSvalue(R,et,!1),cs=Ps.INSIDE_ODD_TOTAL_SUBSET[Ae],Xt=Ps.INSIDE_GSUM[Ae];return new Kt(Ye*cs+st+Xt,Ne)}}findFinderPattern(m,p){let g=this.getDecodeFinderCounters();g[0]=0,g[1]=0,g[2]=0,g[3]=0;let N=m.getSize(),j=!1,C=0;for(;C<N&&(j=!m.get(C),p!==j);)C++;let E=0,R=C;for(let U=C;U<N;U++)if(m.get(U)!==j)g[E]++;else{if(E===3){if(ht.isFinderPattern(g))return[R,U];R+=g[0]+g[1],g[0]=g[2],g[1]=g[3],g[2]=0,g[3]=0,E--}else E++;g[E]=1,j=!j}throw new z}parseFoundFinderPattern(m,p,g,N){let j=m.get(N[0]),C=N[0]-1;for(;C>=0&&j!==m.get(C);)C--;C++;const E=N[0]-C,R=this.getDecodeFinderCounters(),U=new Int32Array(R.length);w.arraycopy(R,0,U,1,R.length-1),U[0]=E;const W=this.parseFinderValue(U,Ps.FINDER_PATTERNS);let Y=C,Z=N[1];return g&&(Y=m.getSize()-1-Y,Z=m.getSize()-1-Z),new Wt(W,[C,N[1]],Y,Z,p)}adjustOddEvenCounts(m,p){let g=ve.sum(new Int32Array(this.getOddCounts())),N=ve.sum(new Int32Array(this.getEvenCounts())),j=!1,C=!1,E=!1,R=!1;m?(g>12?C=!0:g<4&&(j=!0),N>12?R=!0:N<4&&(E=!0)):(g>11?C=!0:g<5&&(j=!0),N>10?R=!0:N<4&&(E=!0));let U=g+N-p,W=(g&1)===(m?1:0),Y=(N&1)===1;if(U===1)if(W){if(Y)throw new z;C=!0}else{if(!Y)throw new z;R=!0}else if(U===-1)if(W){if(Y)throw new z;j=!0}else{if(!Y)throw new z;E=!0}else if(U===0){if(W){if(!Y)throw new z;g<N?(j=!0,R=!0):(C=!0,E=!0)}else if(Y)throw new z}else throw new z;if(j){if(C)throw new z;ht.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(C&&ht.decrement(this.getOddCounts(),this.getOddRoundingErrors()),E){if(R)throw new z;ht.increment(this.getEvenCounts(),this.getOddRoundingErrors())}R&&ht.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Ps.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Ps.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Ps.OUTSIDE_GSUM=[0,161,961,2015,2715],Ps.INSIDE_GSUM=[0,336,1036,1516],Ps.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Ps.INSIDE_ODD_WIDEST=[2,4,6,8],Ps.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Fn extends Ge{constructor(m,p){super(),this.readers=[],this.verbose=p===!0;const g=m?m.get(O.POSSIBLE_FORMATS):null,N=m&&m.get(O.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;g?((g.includes(X.EAN_13)||g.includes(X.UPC_A)||g.includes(X.EAN_8)||g.includes(X.UPC_E))&&this.readers.push(new lt(m)),g.includes(X.CODE_39)&&this.readers.push(new Ot(N)),g.includes(X.CODE_128)&&this.readers.push(new Be),g.includes(X.ITF)&&this.readers.push(new Rt),g.includes(X.RSS_14)&&this.readers.push(new Ps),g.includes(X.RSS_EXPANDED)&&this.readers.push(new Ue(this.verbose))):(this.readers.push(new lt(m)),this.readers.push(new Ot),this.readers.push(new lt(m)),this.readers.push(new Be),this.readers.push(new Rt),this.readers.push(new Ps),this.readers.push(new Ue(this.verbose)))}decodeRow(m,p,g){for(let N=0;N<this.readers.length;N++)try{return this.readers[N].decodeRow(m,p,g)}catch{}throw new z}reset(){this.readers.forEach(m=>m.reset())}}class Il extends te{constructor(m=500,p){super(new Fn(p),m,p)}}class ut{constructor(m,p,g){this.ecCodewords=m,this.ecBlocks=[p],g&&this.ecBlocks.push(g)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class ls{constructor(m,p){this.count=m,this.dataCodewords=p}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Yt{constructor(m,p,g,N,j,C){this.versionNumber=m,this.symbolSizeRows=p,this.symbolSizeColumns=g,this.dataRegionSizeRows=N,this.dataRegionSizeColumns=j,this.ecBlocks=C;let E=0;const R=C.getECCodewords(),U=C.getECBlocks();for(let W of U)E+=W.getCount()*(W.getDataCodewords()+R);this.totalCodewords=E}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(m,p){if(m&1||p&1)throw new D;for(let g of Yt.VERSIONS)if(g.symbolSizeRows===m&&g.symbolSizeColumns===p)return g;throw new D}toString(){return""+this.versionNumber}static buildVersions(){return[new Yt(1,10,10,8,8,new ut(5,new ls(1,3))),new Yt(2,12,12,10,10,new ut(7,new ls(1,5))),new Yt(3,14,14,12,12,new ut(10,new ls(1,8))),new Yt(4,16,16,14,14,new ut(12,new ls(1,12))),new Yt(5,18,18,16,16,new ut(14,new ls(1,18))),new Yt(6,20,20,18,18,new ut(18,new ls(1,22))),new Yt(7,22,22,20,20,new ut(20,new ls(1,30))),new Yt(8,24,24,22,22,new ut(24,new ls(1,36))),new Yt(9,26,26,24,24,new ut(28,new ls(1,44))),new Yt(10,32,32,14,14,new ut(36,new ls(1,62))),new Yt(11,36,36,16,16,new ut(42,new ls(1,86))),new Yt(12,40,40,18,18,new ut(48,new ls(1,114))),new Yt(13,44,44,20,20,new ut(56,new ls(1,144))),new Yt(14,48,48,22,22,new ut(68,new ls(1,174))),new Yt(15,52,52,24,24,new ut(42,new ls(2,102))),new Yt(16,64,64,14,14,new ut(56,new ls(2,140))),new Yt(17,72,72,16,16,new ut(36,new ls(4,92))),new Yt(18,80,80,18,18,new ut(48,new ls(4,114))),new Yt(19,88,88,20,20,new ut(56,new ls(4,144))),new Yt(20,96,96,22,22,new ut(68,new ls(4,174))),new Yt(21,104,104,24,24,new ut(56,new ls(6,136))),new Yt(22,120,120,18,18,new ut(68,new ls(6,175))),new Yt(23,132,132,20,20,new ut(62,new ls(8,163))),new Yt(24,144,144,22,22,new ut(62,new ls(8,156),new ls(2,155))),new Yt(25,8,18,6,16,new ut(7,new ls(1,5))),new Yt(26,8,32,6,14,new ut(11,new ls(1,10))),new Yt(27,12,26,10,24,new ut(14,new ls(1,16))),new Yt(28,12,36,10,16,new ut(18,new ls(1,22))),new Yt(29,16,36,14,16,new ut(24,new ls(1,32))),new Yt(30,16,48,14,22,new ut(28,new ls(1,49)))]}}Yt.VERSIONS=Yt.buildVersions();class Td{constructor(m){const p=m.getHeight();if(p<8||p>144||p&1)throw new D;this.version=Td.readVersion(m),this.mappingBitMatrix=this.extractDataRegion(m),this.readMappingMatrix=new $(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(m){const p=m.getHeight(),g=m.getWidth();return Yt.getVersionForDimensions(p,g)}readCodewords(){const m=new Int8Array(this.version.getTotalCodewords());let p=0,g=4,N=0;const j=this.mappingBitMatrix.getHeight(),C=this.mappingBitMatrix.getWidth();let E=!1,R=!1,U=!1,W=!1;do if(g===j&&N===0&&!E)m[p++]=this.readCorner1(j,C)&255,g-=2,N+=2,E=!0;else if(g===j-2&&N===0&&C&3&&!R)m[p++]=this.readCorner2(j,C)&255,g-=2,N+=2,R=!0;else if(g===j+4&&N===2&&!(C&7)&&!U)m[p++]=this.readCorner3(j,C)&255,g-=2,N+=2,U=!0;else if(g===j-2&&N===0&&(C&7)===4&&!W)m[p++]=this.readCorner4(j,C)&255,g-=2,N+=2,W=!0;else{do g<j&&N>=0&&!this.readMappingMatrix.get(N,g)&&(m[p++]=this.readUtah(g,N,j,C)&255),g-=2,N+=2;while(g>=0&&N<C);g+=1,N+=3;do g>=0&&N<C&&!this.readMappingMatrix.get(N,g)&&(m[p++]=this.readUtah(g,N,j,C)&255),g+=2,N-=2;while(g<j&&N>=0);g+=3,N+=1}while(g<j||N<C);if(p!==this.version.getTotalCodewords())throw new D;return m}readModule(m,p,g,N){return m<0&&(m+=g,p+=4-(g+4&7)),p<0&&(p+=N,m+=4-(N+4&7)),this.readMappingMatrix.set(p,m),this.mappingBitMatrix.get(p,m)}readUtah(m,p,g,N){let j=0;return this.readModule(m-2,p-2,g,N)&&(j|=1),j<<=1,this.readModule(m-2,p-1,g,N)&&(j|=1),j<<=1,this.readModule(m-1,p-2,g,N)&&(j|=1),j<<=1,this.readModule(m-1,p-1,g,N)&&(j|=1),j<<=1,this.readModule(m-1,p,g,N)&&(j|=1),j<<=1,this.readModule(m,p-2,g,N)&&(j|=1),j<<=1,this.readModule(m,p-1,g,N)&&(j|=1),j<<=1,this.readModule(m,p,g,N)&&(j|=1),j}readCorner1(m,p){let g=0;return this.readModule(m-1,0,m,p)&&(g|=1),g<<=1,this.readModule(m-1,1,m,p)&&(g|=1),g<<=1,this.readModule(m-1,2,m,p)&&(g|=1),g<<=1,this.readModule(0,p-2,m,p)&&(g|=1),g<<=1,this.readModule(0,p-1,m,p)&&(g|=1),g<<=1,this.readModule(1,p-1,m,p)&&(g|=1),g<<=1,this.readModule(2,p-1,m,p)&&(g|=1),g<<=1,this.readModule(3,p-1,m,p)&&(g|=1),g}readCorner2(m,p){let g=0;return this.readModule(m-3,0,m,p)&&(g|=1),g<<=1,this.readModule(m-2,0,m,p)&&(g|=1),g<<=1,this.readModule(m-1,0,m,p)&&(g|=1),g<<=1,this.readModule(0,p-4,m,p)&&(g|=1),g<<=1,this.readModule(0,p-3,m,p)&&(g|=1),g<<=1,this.readModule(0,p-2,m,p)&&(g|=1),g<<=1,this.readModule(0,p-1,m,p)&&(g|=1),g<<=1,this.readModule(1,p-1,m,p)&&(g|=1),g}readCorner3(m,p){let g=0;return this.readModule(m-1,0,m,p)&&(g|=1),g<<=1,this.readModule(m-1,p-1,m,p)&&(g|=1),g<<=1,this.readModule(0,p-3,m,p)&&(g|=1),g<<=1,this.readModule(0,p-2,m,p)&&(g|=1),g<<=1,this.readModule(0,p-1,m,p)&&(g|=1),g<<=1,this.readModule(1,p-3,m,p)&&(g|=1),g<<=1,this.readModule(1,p-2,m,p)&&(g|=1),g<<=1,this.readModule(1,p-1,m,p)&&(g|=1),g}readCorner4(m,p){let g=0;return this.readModule(m-3,0,m,p)&&(g|=1),g<<=1,this.readModule(m-2,0,m,p)&&(g|=1),g<<=1,this.readModule(m-1,0,m,p)&&(g|=1),g<<=1,this.readModule(0,p-2,m,p)&&(g|=1),g<<=1,this.readModule(0,p-1,m,p)&&(g|=1),g<<=1,this.readModule(1,p-1,m,p)&&(g|=1),g<<=1,this.readModule(2,p-1,m,p)&&(g|=1),g<<=1,this.readModule(3,p-1,m,p)&&(g|=1),g}extractDataRegion(m){const p=this.version.getSymbolSizeRows(),g=this.version.getSymbolSizeColumns();if(m.getHeight()!==p)throw new f("Dimension of bitMatrix must match the version size");const N=this.version.getDataRegionSizeRows(),j=this.version.getDataRegionSizeColumns(),C=p/N|0,E=g/j|0,R=C*N,U=E*j,W=new $(U,R);for(let Y=0;Y<C;++Y){const Z=Y*N;for(let le=0;le<E;++le){const be=le*j;for(let Ne=0;Ne<N;++Ne){const Ae=Y*(N+2)+1+Ne,Oe=Z+Ne;for(let et=0;et<j;++et){const st=le*(j+2)+1+et;if(m.get(st,Ae)){const Ye=be+et;W.set(Ye,Oe)}}}}}return W}}class Ws{constructor(m,p){this.numDataCodewords=m,this.codewords=p}static getDataBlocks(m,p){const g=p.getECBlocks();let N=0;const j=g.getECBlocks();for(let Ne of j)N+=Ne.getCount();const C=new Array(N);let E=0;for(let Ne of j)for(let Ae=0;Ae<Ne.getCount();Ae++){const Oe=Ne.getDataCodewords(),et=g.getECCodewords()+Oe;C[E++]=new Ws(Oe,new Uint8Array(et))}const U=C[0].codewords.length-g.getECCodewords(),W=U-1;let Y=0;for(let Ne=0;Ne<W;Ne++)for(let Ae=0;Ae<E;Ae++)C[Ae].codewords[Ne]=m[Y++];const Z=p.getVersionNumber()===24,le=Z?8:E;for(let Ne=0;Ne<le;Ne++)C[Ne].codewords[U-1]=m[Y++];const be=C[0].codewords.length;for(let Ne=U;Ne<be;Ne++)for(let Ae=0;Ae<E;Ae++){const Oe=Z?(Ae+8)%E:Ae,et=Z&&Oe>7?Ne-1:Ne;C[Oe].codewords[et]=m[Y++]}if(Y!==m.length)throw new f;return C}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class Ml{constructor(m){this.bytes=m,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(m){if(m<1||m>32||m>this.available())throw new f(""+m);let p=0,g=this.bitOffset,N=this.byteOffset;const j=this.bytes;if(g>0){const C=8-g,E=m<C?m:C,R=C-E,U=255>>8-E<<R;p=(j[N]&U)>>R,m-=E,g+=E,g===8&&(g=0,N++)}if(m>0){for(;m>=8;)p=p<<8|j[N]&255,N++,m-=8;if(m>0){const C=8-m,E=255>>C<<C;p=p<<m|(j[N]&E)>>C,g+=m}}return this.bitOffset=g,this.byteOffset=N,p}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var cn;(function(K){K[K.PAD_ENCODE=0]="PAD_ENCODE",K[K.ASCII_ENCODE=1]="ASCII_ENCODE",K[K.C40_ENCODE=2]="C40_ENCODE",K[K.TEXT_ENCODE=3]="TEXT_ENCODE",K[K.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",K[K.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",K[K.BASE256_ENCODE=6]="BASE256_ENCODE"})(cn||(cn={}));class Na{static decode(m){const p=new Ml(m),g=new V,N=new V,j=new Array;let C=cn.ASCII_ENCODE;do if(C===cn.ASCII_ENCODE)C=this.decodeAsciiSegment(p,g,N);else{switch(C){case cn.C40_ENCODE:this.decodeC40Segment(p,g);break;case cn.TEXT_ENCODE:this.decodeTextSegment(p,g);break;case cn.ANSIX12_ENCODE:this.decodeAnsiX12Segment(p,g);break;case cn.EDIFACT_ENCODE:this.decodeEdifactSegment(p,g);break;case cn.BASE256_ENCODE:this.decodeBase256Segment(p,g,j);break;default:throw new D}C=cn.ASCII_ENCODE}while(C!==cn.PAD_ENCODE&&p.available()>0);return N.length()>0&&g.append(N.toString()),new ue(m,g.toString(),j.length===0?null:j,null)}static decodeAsciiSegment(m,p,g){let N=!1;do{let j=m.readBits(8);if(j===0)throw new D;if(j<=128)return N&&(j+=128),p.append(String.fromCharCode(j-1)),cn.ASCII_ENCODE;if(j===129)return cn.PAD_ENCODE;if(j<=229){const C=j-130;C<10&&p.append("0"),p.append(""+C)}else switch(j){case 230:return cn.C40_ENCODE;case 231:return cn.BASE256_ENCODE;case 232:p.append("");break;case 233:case 234:break;case 235:N=!0;break;case 236:p.append("[)>05"),g.insert(0,"");break;case 237:p.append("[)>06"),g.insert(0,"");break;case 238:return cn.ANSIX12_ENCODE;case 239:return cn.TEXT_ENCODE;case 240:return cn.EDIFACT_ENCODE;case 241:break;default:if(j!==254||m.available()!==0)throw new D;break}}while(m.available()>0);return cn.ASCII_ENCODE}static decodeC40Segment(m,p){let g=!1;const N=[];let j=0;do{if(m.available()===8)return;const C=m.readBits(8);if(C===254)return;this.parseTwoBytes(C,m.readBits(8),N);for(let E=0;E<3;E++){const R=N[E];switch(j){case 0:if(R<3)j=R+1;else if(R<this.C40_BASIC_SET_CHARS.length){const U=this.C40_BASIC_SET_CHARS[R];g?(p.append(String.fromCharCode(U.charCodeAt(0)+128)),g=!1):p.append(U)}else throw new D;break;case 1:g?(p.append(String.fromCharCode(R+128)),g=!1):p.append(String.fromCharCode(R)),j=0;break;case 2:if(R<this.C40_SHIFT2_SET_CHARS.length){const U=this.C40_SHIFT2_SET_CHARS[R];g?(p.append(String.fromCharCode(U.charCodeAt(0)+128)),g=!1):p.append(U)}else switch(R){case 27:p.append("");break;case 30:g=!0;break;default:throw new D}j=0;break;case 3:g?(p.append(String.fromCharCode(R+224)),g=!1):p.append(String.fromCharCode(R+96)),j=0;break;default:throw new D}}}while(m.available()>0)}static decodeTextSegment(m,p){let g=!1,N=[],j=0;do{if(m.available()===8)return;const C=m.readBits(8);if(C===254)return;this.parseTwoBytes(C,m.readBits(8),N);for(let E=0;E<3;E++){const R=N[E];switch(j){case 0:if(R<3)j=R+1;else if(R<this.TEXT_BASIC_SET_CHARS.length){const U=this.TEXT_BASIC_SET_CHARS[R];g?(p.append(String.fromCharCode(U.charCodeAt(0)+128)),g=!1):p.append(U)}else throw new D;break;case 1:g?(p.append(String.fromCharCode(R+128)),g=!1):p.append(String.fromCharCode(R)),j=0;break;case 2:if(R<this.TEXT_SHIFT2_SET_CHARS.length){const U=this.TEXT_SHIFT2_SET_CHARS[R];g?(p.append(String.fromCharCode(U.charCodeAt(0)+128)),g=!1):p.append(U)}else switch(R){case 27:p.append("");break;case 30:g=!0;break;default:throw new D}j=0;break;case 3:if(R<this.TEXT_SHIFT3_SET_CHARS.length){const U=this.TEXT_SHIFT3_SET_CHARS[R];g?(p.append(String.fromCharCode(U.charCodeAt(0)+128)),g=!1):p.append(U),j=0}else throw new D;break;default:throw new D}}}while(m.available()>0)}static decodeAnsiX12Segment(m,p){const g=[];do{if(m.available()===8)return;const N=m.readBits(8);if(N===254)return;this.parseTwoBytes(N,m.readBits(8),g);for(let j=0;j<3;j++){const C=g[j];switch(C){case 0:p.append("\r");break;case 1:p.append("*");break;case 2:p.append(">");break;case 3:p.append(" ");break;default:if(C<14)p.append(String.fromCharCode(C+44));else if(C<40)p.append(String.fromCharCode(C+51));else throw new D;break}}}while(m.available()>0)}static parseTwoBytes(m,p,g){let N=(m<<8)+p-1,j=Math.floor(N/1600);g[0]=j,N-=j*1600,j=Math.floor(N/40),g[1]=j,g[2]=N-j*40}static decodeEdifactSegment(m,p){do{if(m.available()<=16)return;for(let g=0;g<4;g++){let N=m.readBits(6);if(N===31){const j=8-m.getBitOffset();j!==8&&m.readBits(j);return}N&32||(N|=64),p.append(String.fromCharCode(N))}}while(m.available()>0)}static decodeBase256Segment(m,p,g){let N=1+m.getByteOffset();const j=this.unrandomize255State(m.readBits(8),N++);let C;if(j===0?C=m.available()/8|0:j<250?C=j:C=250*(j-249)+this.unrandomize255State(m.readBits(8),N++),C<0)throw new D;const E=new Uint8Array(C);for(let R=0;R<C;R++){if(m.available()<8)throw new D;E[R]=this.unrandomize255State(m.readBits(8),N++)}g.push(E);try{p.append(L.decode(E,F.ISO88591))}catch(R){throw new jt("Platform does not support required encoding: "+R.message)}}static unrandomize255State(m,p){const g=149*p%255+1,N=m-g;return N>=0?N:N+256}}Na.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Na.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Na.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Na.TEXT_SHIFT2_SET_CHARS=Na.C40_SHIFT2_SET_CHARS,Na.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class lf{constructor(){this.rsDecoder=new ft(qe.DATA_MATRIX_FIELD_256)}decode(m){const p=new Td(m),g=p.getVersion(),N=p.readCodewords(),j=Ws.getDataBlocks(N,g);let C=0;for(let U of j)C+=U.getNumDataCodewords();const E=new Uint8Array(C),R=j.length;for(let U=0;U<R;U++){const W=j[U],Y=W.getCodewords(),Z=W.getNumDataCodewords();this.correctErrors(Y,Z);for(let le=0;le<Z;le++)E[le*R+U]=Y[le]}return Na.decode(E)}correctErrors(m,p){const g=new Int32Array(m);try{this.rsDecoder.decode(g,m.length-p)}catch{throw new b}for(let N=0;N<p;N++)m[N]=g[N]}}class as{constructor(m){this.image=m,this.rectangleDetector=new Ct(this.image)}detect(){const m=this.rectangleDetector.detect();let p=this.detectSolid1(m);if(p=this.detectSolid2(p),p[3]=this.correctTopRight(p),!p[3])throw new z;p=this.shiftToModuleCenter(p);const g=p[0],N=p[1],j=p[2],C=p[3];let E=this.transitionsBetween(g,C)+1,R=this.transitionsBetween(j,C)+1;(E&1)===1&&(E+=1),(R&1)===1&&(R+=1),4*E<7*R&&4*R<7*E&&(E=R=Math.max(E,R));let U=as.sampleGrid(this.image,g,N,j,C,E,R);return new je(U,[g,N,j,C])}static shiftPoint(m,p,g){let N=(p.getX()-m.getX())/(g+1),j=(p.getY()-m.getY())/(g+1);return new xe(m.getX()+N,m.getY()+j)}static moveAway(m,p,g){let N=m.getX(),j=m.getY();return N<p?N-=1:N+=1,j<g?j-=1:j+=1,new xe(N,j)}detectSolid1(m){let p=m[0],g=m[1],N=m[3],j=m[2],C=this.transitionsBetween(p,g),E=this.transitionsBetween(g,N),R=this.transitionsBetween(N,j),U=this.transitionsBetween(j,p),W=C,Y=[j,p,g,N];return W>E&&(W=E,Y[0]=p,Y[1]=g,Y[2]=N,Y[3]=j),W>R&&(W=R,Y[0]=g,Y[1]=N,Y[2]=j,Y[3]=p),W>U&&(Y[0]=N,Y[1]=j,Y[2]=p,Y[3]=g),Y}detectSolid2(m){let p=m[0],g=m[1],N=m[2],j=m[3],C=this.transitionsBetween(p,j),E=as.shiftPoint(g,N,(C+1)*4),R=as.shiftPoint(N,g,(C+1)*4),U=this.transitionsBetween(E,p),W=this.transitionsBetween(R,j);return U<W?(m[0]=p,m[1]=g,m[2]=N,m[3]=j):(m[0]=g,m[1]=N,m[2]=j,m[3]=p),m}correctTopRight(m){let p=m[0],g=m[1],N=m[2],j=m[3],C=this.transitionsBetween(p,j),E=this.transitionsBetween(g,j),R=as.shiftPoint(p,g,(E+1)*4),U=as.shiftPoint(N,g,(C+1)*4);C=this.transitionsBetween(R,j),E=this.transitionsBetween(U,j);let W=new xe(j.getX()+(N.getX()-g.getX())/(C+1),j.getY()+(N.getY()-g.getY())/(C+1)),Y=new xe(j.getX()+(p.getX()-g.getX())/(E+1),j.getY()+(p.getY()-g.getY())/(E+1));if(!this.isValid(W))return this.isValid(Y)?Y:null;if(!this.isValid(Y))return W;let Z=this.transitionsBetween(R,W)+this.transitionsBetween(U,W),le=this.transitionsBetween(R,Y)+this.transitionsBetween(U,Y);return Z>le?W:Y}shiftToModuleCenter(m){let p=m[0],g=m[1],N=m[2],j=m[3],C=this.transitionsBetween(p,j)+1,E=this.transitionsBetween(N,j)+1,R=as.shiftPoint(p,g,E*4),U=as.shiftPoint(N,g,C*4);C=this.transitionsBetween(R,j)+1,E=this.transitionsBetween(U,j)+1,(C&1)===1&&(C+=1),(E&1)===1&&(E+=1);let W=(p.getX()+g.getX()+N.getX()+j.getX())/4,Y=(p.getY()+g.getY()+N.getY()+j.getY())/4;p=as.moveAway(p,W,Y),g=as.moveAway(g,W,Y),N=as.moveAway(N,W,Y),j=as.moveAway(j,W,Y);let Z,le;return R=as.shiftPoint(p,g,E*4),R=as.shiftPoint(R,j,C*4),Z=as.shiftPoint(g,p,E*4),Z=as.shiftPoint(Z,N,C*4),U=as.shiftPoint(N,j,E*4),U=as.shiftPoint(U,g,C*4),le=as.shiftPoint(j,N,E*4),le=as.shiftPoint(le,p,C*4),[R,Z,U,le]}isValid(m){return m.getX()>=0&&m.getX()<this.image.getWidth()&&m.getY()>0&&m.getY()<this.image.getHeight()}static sampleGrid(m,p,g,N,j,C,E){return ds.getInstance().sampleGrid(m,C,E,.5,.5,C-.5,.5,C-.5,E-.5,.5,E-.5,p.getX(),p.getY(),j.getX(),j.getY(),N.getX(),N.getY(),g.getX(),g.getY())}transitionsBetween(m,p){let g=Math.trunc(m.getX()),N=Math.trunc(m.getY()),j=Math.trunc(p.getX()),C=Math.trunc(p.getY()),E=Math.abs(C-N)>Math.abs(j-g);if(E){let Ne=g;g=N,N=Ne,Ne=j,j=C,C=Ne}let R=Math.abs(j-g),U=Math.abs(C-N),W=-R/2,Y=N<C?1:-1,Z=g<j?1:-1,le=0,be=this.image.get(E?N:g,E?g:N);for(let Ne=g,Ae=N;Ne!==j;Ne+=Z){let Oe=this.image.get(E?Ae:Ne,E?Ne:Ae);if(Oe!==be&&(le++,be=Oe),W+=U,W>0){if(Ae===C)break;Ae+=Y,W-=R}}return le}}class Q{constructor(){this.decoder=new lf}decode(m,p=null){let g,N;if(p!=null&&p.has(O.PURE_BARCODE)){const U=Q.extractPureBits(m.getBlackMatrix());g=this.decoder.decode(U),N=Q.NO_POINTS}else{const U=new as(m.getBlackMatrix()).detect();g=this.decoder.decode(U.getBits()),N=U.getPoints()}const j=g.getRawBytes(),C=new ce(g.getText(),j,8*j.length,N,X.DATA_MATRIX,w.currentTimeMillis()),E=g.getByteSegments();E!=null&&C.putMetadata(Ce.BYTE_SEGMENTS,E);const R=g.getECLevel();return R!=null&&C.putMetadata(Ce.ERROR_CORRECTION_LEVEL,R),C}reset(){}static extractPureBits(m){const p=m.getTopLeftOnBit(),g=m.getBottomRightOnBit();if(p==null||g==null)throw new z;const N=this.moduleSize(p,m);let j=p[1];const C=g[1];let E=p[0];const U=(g[0]-E+1)/N,W=(C-j+1)/N;if(U<=0||W<=0)throw new z;const Y=N/2;j+=Y,E+=Y;const Z=new $(U,W);for(let le=0;le<W;le++){const be=j+le*N;for(let Ne=0;Ne<U;Ne++)m.get(E+Ne*N,be)&&Z.set(Ne,le)}return Z}static moduleSize(m,p){const g=p.getWidth();let N=m[0];const j=m[1];for(;N<g&&p.get(N,j);)N++;if(N===g)throw new z;const C=N-m[0];if(C===0)throw new z;return C}}Q.NO_POINTS=[];class ke extends te{constructor(m=500){super(new Q,m)}}var Le;(function(K){K[K.L=0]="L",K[K.M=1]="M",K[K.Q=2]="Q",K[K.H=3]="H"})(Le||(Le={}));class mt{constructor(m,p,g){this.value=m,this.stringValue=p,this.bits=g,mt.FOR_BITS.set(g,this),mt.FOR_VALUE.set(m,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(m){switch(m){case"L":return mt.L;case"M":return mt.M;case"Q":return mt.Q;case"H":return mt.H;default:throw new h(m+"not available")}}toString(){return this.stringValue}equals(m){if(!(m instanceof mt))return!1;const p=m;return this.value===p.value}static forBits(m){if(m<0||m>=mt.FOR_BITS.size)throw new f;return mt.FOR_BITS.get(m)}}mt.FOR_BITS=new Map,mt.FOR_VALUE=new Map,mt.L=new mt(Le.L,"L",1),mt.M=new mt(Le.M,"M",0),mt.Q=new mt(Le.Q,"Q",3),mt.H=new mt(Le.H,"H",2);class Ut{constructor(m){this.errorCorrectionLevel=mt.forBits(m>>3&3),this.dataMask=m&7}static numBitsDiffering(m,p){return A.bitCount(m^p)}static decodeFormatInformation(m,p){const g=Ut.doDecodeFormatInformation(m,p);return g!==null?g:Ut.doDecodeFormatInformation(m^Ut.FORMAT_INFO_MASK_QR,p^Ut.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(m,p){let g=Number.MAX_SAFE_INTEGER,N=0;for(const j of Ut.FORMAT_INFO_DECODE_LOOKUP){const C=j[0];if(C===m||C===p)return new Ut(j[1]);let E=Ut.numBitsDiffering(m,C);E<g&&(N=j[1],g=E),m!==p&&(E=Ut.numBitsDiffering(p,C),E<g&&(N=j[1],g=E))}return g<=3?new Ut(N):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(m){if(!(m instanceof Ut))return!1;const p=m;return this.errorCorrectionLevel===p.errorCorrectionLevel&&this.dataMask===p.dataMask}}Ut.FORMAT_INFO_MASK_QR=21522,Ut.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class _e{constructor(m,...p){this.ecCodewordsPerBlock=m,this.ecBlocks=p}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let m=0;const p=this.ecBlocks;for(const g of p)m+=g.getCount();return m}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class ne{constructor(m,p){this.count=m,this.dataCodewords=p}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class At{constructor(m,p,...g){this.versionNumber=m,this.alignmentPatternCenters=p,this.ecBlocks=g;let N=0;const j=g[0].getECCodewordsPerBlock(),C=g[0].getECBlocks();for(const E of C)N+=E.getCount()*(E.getDataCodewords()+j);this.totalCodewords=N}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(m){return this.ecBlocks[m.getValue()]}static getProvisionalVersionForDimension(m){if(m%4!==1)throw new D;try{return this.getVersionForNumber((m-17)/4)}catch{throw new D}}static getVersionForNumber(m){if(m<1||m>40)throw new f;return At.VERSIONS[m-1]}static decodeVersionInformation(m){let p=Number.MAX_SAFE_INTEGER,g=0;for(let N=0;N<At.VERSION_DECODE_INFO.length;N++){const j=At.VERSION_DECODE_INFO[N];if(j===m)return At.getVersionForNumber(N+7);const C=Ut.numBitsDiffering(m,j);C<p&&(g=N+7,p=C)}return p<=3?At.getVersionForNumber(g):null}buildFunctionPattern(){const m=this.getDimensionForVersion(),p=new $(m);p.setRegion(0,0,9,9),p.setRegion(m-8,0,8,9),p.setRegion(0,m-8,9,8);const g=this.alignmentPatternCenters.length;for(let N=0;N<g;N++){const j=this.alignmentPatternCenters[N]-2;for(let C=0;C<g;C++)N===0&&(C===0||C===g-1)||N===g-1&&C===0||p.setRegion(this.alignmentPatternCenters[C]-2,j,5,5)}return p.setRegion(6,9,1,m-17),p.setRegion(9,6,m-17,1),this.versionNumber>6&&(p.setRegion(m-11,0,3,6),p.setRegion(0,m-11,6,3)),p}toString(){return""+this.versionNumber}}At.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),At.VERSIONS=[new At(1,new Int32Array(0),new _e(7,new ne(1,19)),new _e(10,new ne(1,16)),new _e(13,new ne(1,13)),new _e(17,new ne(1,9))),new At(2,Int32Array.from([6,18]),new _e(10,new ne(1,34)),new _e(16,new ne(1,28)),new _e(22,new ne(1,22)),new _e(28,new ne(1,16))),new At(3,Int32Array.from([6,22]),new _e(15,new ne(1,55)),new _e(26,new ne(1,44)),new _e(18,new ne(2,17)),new _e(22,new ne(2,13))),new At(4,Int32Array.from([6,26]),new _e(20,new ne(1,80)),new _e(18,new ne(2,32)),new _e(26,new ne(2,24)),new _e(16,new ne(4,9))),new At(5,Int32Array.from([6,30]),new _e(26,new ne(1,108)),new _e(24,new ne(2,43)),new _e(18,new ne(2,15),new ne(2,16)),new _e(22,new ne(2,11),new ne(2,12))),new At(6,Int32Array.from([6,34]),new _e(18,new ne(2,68)),new _e(16,new ne(4,27)),new _e(24,new ne(4,19)),new _e(28,new ne(4,15))),new At(7,Int32Array.from([6,22,38]),new _e(20,new ne(2,78)),new _e(18,new ne(4,31)),new _e(18,new ne(2,14),new ne(4,15)),new _e(26,new ne(4,13),new ne(1,14))),new At(8,Int32Array.from([6,24,42]),new _e(24,new ne(2,97)),new _e(22,new ne(2,38),new ne(2,39)),new _e(22,new ne(4,18),new ne(2,19)),new _e(26,new ne(4,14),new ne(2,15))),new At(9,Int32Array.from([6,26,46]),new _e(30,new ne(2,116)),new _e(22,new ne(3,36),new ne(2,37)),new _e(20,new ne(4,16),new ne(4,17)),new _e(24,new ne(4,12),new ne(4,13))),new At(10,Int32Array.from([6,28,50]),new _e(18,new ne(2,68),new ne(2,69)),new _e(26,new ne(4,43),new ne(1,44)),new _e(24,new ne(6,19),new ne(2,20)),new _e(28,new ne(6,15),new ne(2,16))),new At(11,Int32Array.from([6,30,54]),new _e(20,new ne(4,81)),new _e(30,new ne(1,50),new ne(4,51)),new _e(28,new ne(4,22),new ne(4,23)),new _e(24,new ne(3,12),new ne(8,13))),new At(12,Int32Array.from([6,32,58]),new _e(24,new ne(2,92),new ne(2,93)),new _e(22,new ne(6,36),new ne(2,37)),new _e(26,new ne(4,20),new ne(6,21)),new _e(28,new ne(7,14),new ne(4,15))),new At(13,Int32Array.from([6,34,62]),new _e(26,new ne(4,107)),new _e(22,new ne(8,37),new ne(1,38)),new _e(24,new ne(8,20),new ne(4,21)),new _e(22,new ne(12,11),new ne(4,12))),new At(14,Int32Array.from([6,26,46,66]),new _e(30,new ne(3,115),new ne(1,116)),new _e(24,new ne(4,40),new ne(5,41)),new _e(20,new ne(11,16),new ne(5,17)),new _e(24,new ne(11,12),new ne(5,13))),new At(15,Int32Array.from([6,26,48,70]),new _e(22,new ne(5,87),new ne(1,88)),new _e(24,new ne(5,41),new ne(5,42)),new _e(30,new ne(5,24),new ne(7,25)),new _e(24,new ne(11,12),new ne(7,13))),new At(16,Int32Array.from([6,26,50,74]),new _e(24,new ne(5,98),new ne(1,99)),new _e(28,new ne(7,45),new ne(3,46)),new _e(24,new ne(15,19),new ne(2,20)),new _e(30,new ne(3,15),new ne(13,16))),new At(17,Int32Array.from([6,30,54,78]),new _e(28,new ne(1,107),new ne(5,108)),new _e(28,new ne(10,46),new ne(1,47)),new _e(28,new ne(1,22),new ne(15,23)),new _e(28,new ne(2,14),new ne(17,15))),new At(18,Int32Array.from([6,30,56,82]),new _e(30,new ne(5,120),new ne(1,121)),new _e(26,new ne(9,43),new ne(4,44)),new _e(28,new ne(17,22),new ne(1,23)),new _e(28,new ne(2,14),new ne(19,15))),new At(19,Int32Array.from([6,30,58,86]),new _e(28,new ne(3,113),new ne(4,114)),new _e(26,new ne(3,44),new ne(11,45)),new _e(26,new ne(17,21),new ne(4,22)),new _e(26,new ne(9,13),new ne(16,14))),new At(20,Int32Array.from([6,34,62,90]),new _e(28,new ne(3,107),new ne(5,108)),new _e(26,new ne(3,41),new ne(13,42)),new _e(30,new ne(15,24),new ne(5,25)),new _e(28,new ne(15,15),new ne(10,16))),new At(21,Int32Array.from([6,28,50,72,94]),new _e(28,new ne(4,116),new ne(4,117)),new _e(26,new ne(17,42)),new _e(28,new ne(17,22),new ne(6,23)),new _e(30,new ne(19,16),new ne(6,17))),new At(22,Int32Array.from([6,26,50,74,98]),new _e(28,new ne(2,111),new ne(7,112)),new _e(28,new ne(17,46)),new _e(30,new ne(7,24),new ne(16,25)),new _e(24,new ne(34,13))),new At(23,Int32Array.from([6,30,54,78,102]),new _e(30,new ne(4,121),new ne(5,122)),new _e(28,new ne(4,47),new ne(14,48)),new _e(30,new ne(11,24),new ne(14,25)),new _e(30,new ne(16,15),new ne(14,16))),new At(24,Int32Array.from([6,28,54,80,106]),new _e(30,new ne(6,117),new ne(4,118)),new _e(28,new ne(6,45),new ne(14,46)),new _e(30,new ne(11,24),new ne(16,25)),new _e(30,new ne(30,16),new ne(2,17))),new At(25,Int32Array.from([6,32,58,84,110]),new _e(26,new ne(8,106),new ne(4,107)),new _e(28,new ne(8,47),new ne(13,48)),new _e(30,new ne(7,24),new ne(22,25)),new _e(30,new ne(22,15),new ne(13,16))),new At(26,Int32Array.from([6,30,58,86,114]),new _e(28,new ne(10,114),new ne(2,115)),new _e(28,new ne(19,46),new ne(4,47)),new _e(28,new ne(28,22),new ne(6,23)),new _e(30,new ne(33,16),new ne(4,17))),new At(27,Int32Array.from([6,34,62,90,118]),new _e(30,new ne(8,122),new ne(4,123)),new _e(28,new ne(22,45),new ne(3,46)),new _e(30,new ne(8,23),new ne(26,24)),new _e(30,new ne(12,15),new ne(28,16))),new At(28,Int32Array.from([6,26,50,74,98,122]),new _e(30,new ne(3,117),new ne(10,118)),new _e(28,new ne(3,45),new ne(23,46)),new _e(30,new ne(4,24),new ne(31,25)),new _e(30,new ne(11,15),new ne(31,16))),new At(29,Int32Array.from([6,30,54,78,102,126]),new _e(30,new ne(7,116),new ne(7,117)),new _e(28,new ne(21,45),new ne(7,46)),new _e(30,new ne(1,23),new ne(37,24)),new _e(30,new ne(19,15),new ne(26,16))),new At(30,Int32Array.from([6,26,52,78,104,130]),new _e(30,new ne(5,115),new ne(10,116)),new _e(28,new ne(19,47),new ne(10,48)),new _e(30,new ne(15,24),new ne(25,25)),new _e(30,new ne(23,15),new ne(25,16))),new At(31,Int32Array.from([6,30,56,82,108,134]),new _e(30,new ne(13,115),new ne(3,116)),new _e(28,new ne(2,46),new ne(29,47)),new _e(30,new ne(42,24),new ne(1,25)),new _e(30,new ne(23,15),new ne(28,16))),new At(32,Int32Array.from([6,34,60,86,112,138]),new _e(30,new ne(17,115)),new _e(28,new ne(10,46),new ne(23,47)),new _e(30,new ne(10,24),new ne(35,25)),new _e(30,new ne(19,15),new ne(35,16))),new At(33,Int32Array.from([6,30,58,86,114,142]),new _e(30,new ne(17,115),new ne(1,116)),new _e(28,new ne(14,46),new ne(21,47)),new _e(30,new ne(29,24),new ne(19,25)),new _e(30,new ne(11,15),new ne(46,16))),new At(34,Int32Array.from([6,34,62,90,118,146]),new _e(30,new ne(13,115),new ne(6,116)),new _e(28,new ne(14,46),new ne(23,47)),new _e(30,new ne(44,24),new ne(7,25)),new _e(30,new ne(59,16),new ne(1,17))),new At(35,Int32Array.from([6,30,54,78,102,126,150]),new _e(30,new ne(12,121),new ne(7,122)),new _e(28,new ne(12,47),new ne(26,48)),new _e(30,new ne(39,24),new ne(14,25)),new _e(30,new ne(22,15),new ne(41,16))),new At(36,Int32Array.from([6,24,50,76,102,128,154]),new _e(30,new ne(6,121),new ne(14,122)),new _e(28,new ne(6,47),new ne(34,48)),new _e(30,new ne(46,24),new ne(10,25)),new _e(30,new ne(2,15),new ne(64,16))),new At(37,Int32Array.from([6,28,54,80,106,132,158]),new _e(30,new ne(17,122),new ne(4,123)),new _e(28,new ne(29,46),new ne(14,47)),new _e(30,new ne(49,24),new ne(10,25)),new _e(30,new ne(24,15),new ne(46,16))),new At(38,Int32Array.from([6,32,58,84,110,136,162]),new _e(30,new ne(4,122),new ne(18,123)),new _e(28,new ne(13,46),new ne(32,47)),new _e(30,new ne(48,24),new ne(14,25)),new _e(30,new ne(42,15),new ne(32,16))),new At(39,Int32Array.from([6,26,54,82,110,138,166]),new _e(30,new ne(20,117),new ne(4,118)),new _e(28,new ne(40,47),new ne(7,48)),new _e(30,new ne(43,24),new ne(22,25)),new _e(30,new ne(10,15),new ne(67,16))),new At(40,Int32Array.from([6,30,58,86,114,142,170]),new _e(30,new ne(19,118),new ne(6,119)),new _e(28,new ne(18,47),new ne(31,48)),new _e(30,new ne(34,24),new ne(34,25)),new _e(30,new ne(20,15),new ne(61,16)))];var $n;(function(K){K[K.DATA_MASK_000=0]="DATA_MASK_000",K[K.DATA_MASK_001=1]="DATA_MASK_001",K[K.DATA_MASK_010=2]="DATA_MASK_010",K[K.DATA_MASK_011=3]="DATA_MASK_011",K[K.DATA_MASK_100=4]="DATA_MASK_100",K[K.DATA_MASK_101=5]="DATA_MASK_101",K[K.DATA_MASK_110=6]="DATA_MASK_110",K[K.DATA_MASK_111=7]="DATA_MASK_111"})($n||($n={}));class wa{constructor(m,p){this.value=m,this.isMasked=p}unmaskBitMatrix(m,p){for(let g=0;g<p;g++)for(let N=0;N<p;N++)this.isMasked(g,N)&&m.flip(N,g)}}wa.values=new Map([[$n.DATA_MASK_000,new wa($n.DATA_MASK_000,(K,m)=>(K+m&1)===0)],[$n.DATA_MASK_001,new wa($n.DATA_MASK_001,(K,m)=>(K&1)===0)],[$n.DATA_MASK_010,new wa($n.DATA_MASK_010,(K,m)=>m%3===0)],[$n.DATA_MASK_011,new wa($n.DATA_MASK_011,(K,m)=>(K+m)%3===0)],[$n.DATA_MASK_100,new wa($n.DATA_MASK_100,(K,m)=>(Math.floor(K/2)+Math.floor(m/3)&1)===0)],[$n.DATA_MASK_101,new wa($n.DATA_MASK_101,(K,m)=>K*m%6===0)],[$n.DATA_MASK_110,new wa($n.DATA_MASK_110,(K,m)=>K*m%6<3)],[$n.DATA_MASK_111,new wa($n.DATA_MASK_111,(K,m)=>(K+m+K*m%3&1)===0)]]);class UN{constructor(m){const p=m.getHeight();if(p<21||(p&3)!==1)throw new D;this.bitMatrix=m}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let m=0;for(let j=0;j<6;j++)m=this.copyBit(j,8,m);m=this.copyBit(7,8,m),m=this.copyBit(8,8,m),m=this.copyBit(8,7,m);for(let j=5;j>=0;j--)m=this.copyBit(8,j,m);const p=this.bitMatrix.getHeight();let g=0;const N=p-7;for(let j=p-1;j>=N;j--)g=this.copyBit(8,j,g);for(let j=p-8;j<p;j++)g=this.copyBit(j,8,g);if(this.parsedFormatInfo=Ut.decodeFormatInformation(m,g),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new D}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const m=this.bitMatrix.getHeight(),p=Math.floor((m-17)/4);if(p<=6)return At.getVersionForNumber(p);let g=0;const N=m-11;for(let C=5;C>=0;C--)for(let E=m-9;E>=N;E--)g=this.copyBit(E,C,g);let j=At.decodeVersionInformation(g);if(j!==null&&j.getDimensionForVersion()===m)return this.parsedVersion=j,j;g=0;for(let C=5;C>=0;C--)for(let E=m-9;E>=N;E--)g=this.copyBit(C,E,g);if(j=At.decodeVersionInformation(g),j!==null&&j.getDimensionForVersion()===m)return this.parsedVersion=j,j;throw new D}copyBit(m,p,g){return(this.isMirror?this.bitMatrix.get(p,m):this.bitMatrix.get(m,p))?g<<1|1:g<<1}readCodewords(){const m=this.readFormatInformation(),p=this.readVersion(),g=wa.values.get(m.getDataMask()),N=this.bitMatrix.getHeight();g.unmaskBitMatrix(this.bitMatrix,N);const j=p.buildFunctionPattern();let C=!0;const E=new Uint8Array(p.getTotalCodewords());let R=0,U=0,W=0;for(let Y=N-1;Y>0;Y-=2){Y===6&&Y--;for(let Z=0;Z<N;Z++){const le=C?N-1-Z:Z;for(let be=0;be<2;be++)j.get(Y-be,le)||(W++,U<<=1,this.bitMatrix.get(Y-be,le)&&(U|=1),W===8&&(E[R++]=U,W=0,U=0))}C=!C}if(R!==p.getTotalCodewords())throw new D;return E}remask(){if(this.parsedFormatInfo===null)return;const m=wa.values[this.parsedFormatInfo.getDataMask()],p=this.bitMatrix.getHeight();m.unmaskBitMatrix(this.bitMatrix,p)}setMirror(m){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=m}mirror(){const m=this.bitMatrix;for(let p=0,g=m.getWidth();p<g;p++)for(let N=p+1,j=m.getHeight();N<j;N++)m.get(p,N)!==m.get(N,p)&&(m.flip(N,p),m.flip(p,N))}}class of{constructor(m,p){this.numDataCodewords=m,this.codewords=p}static getDataBlocks(m,p,g){if(m.length!==p.getTotalCodewords())throw new f;const N=p.getECBlocksForLevel(g);let j=0;const C=N.getECBlocks();for(const be of C)j+=be.getCount();const E=new Array(j);let R=0;for(const be of C)for(let Ne=0;Ne<be.getCount();Ne++){const Ae=be.getDataCodewords(),Oe=N.getECCodewordsPerBlock()+Ae;E[R++]=new of(Ae,new Uint8Array(Oe))}const U=E[0].codewords.length;let W=E.length-1;for(;W>=0&&E[W].codewords.length!==U;)W--;W++;const Y=U-N.getECCodewordsPerBlock();let Z=0;for(let be=0;be<Y;be++)for(let Ne=0;Ne<R;Ne++)E[Ne].codewords[be]=m[Z++];for(let be=W;be<R;be++)E[be].codewords[Y]=m[Z++];const le=E[0].codewords.length;for(let be=Y;be<le;be++)for(let Ne=0;Ne<R;Ne++){const Ae=Ne<W?be:be+1;E[Ne].codewords[Ae]=m[Z++]}return E}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var ia;(function(K){K[K.TERMINATOR=0]="TERMINATOR",K[K.NUMERIC=1]="NUMERIC",K[K.ALPHANUMERIC=2]="ALPHANUMERIC",K[K.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",K[K.BYTE=4]="BYTE",K[K.ECI=5]="ECI",K[K.KANJI=6]="KANJI",K[K.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",K[K.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",K[K.HANZI=9]="HANZI"})(ia||(ia={}));class Tt{constructor(m,p,g,N){this.value=m,this.stringValue=p,this.characterCountBitsForVersions=g,this.bits=N,Tt.FOR_BITS.set(N,this),Tt.FOR_VALUE.set(m,this)}static forBits(m){const p=Tt.FOR_BITS.get(m);if(p===void 0)throw new f;return p}getCharacterCountBits(m){const p=m.getVersionNumber();let g;return p<=9?g=0:p<=26?g=1:g=2,this.characterCountBitsForVersions[g]}getValue(){return this.value}getBits(){return this.bits}equals(m){if(!(m instanceof Tt))return!1;const p=m;return this.value===p.value}toString(){return this.stringValue}}Tt.FOR_BITS=new Map,Tt.FOR_VALUE=new Map,Tt.TERMINATOR=new Tt(ia.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),Tt.NUMERIC=new Tt(ia.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),Tt.ALPHANUMERIC=new Tt(ia.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),Tt.STRUCTURED_APPEND=new Tt(ia.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),Tt.BYTE=new Tt(ia.BYTE,"BYTE",Int32Array.from([8,16,16]),4),Tt.ECI=new Tt(ia.ECI,"ECI",Int32Array.from([0,0,0]),7),Tt.KANJI=new Tt(ia.KANJI,"KANJI",Int32Array.from([8,10,12]),8),Tt.FNC1_FIRST_POSITION=new Tt(ia.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),Tt.FNC1_SECOND_POSITION=new Tt(ia.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),Tt.HANZI=new Tt(ia.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class Bs{static decode(m,p,g,N){const j=new Ml(m);let C=new V;const E=new Array;let R=-1,U=-1;try{let W=null,Y=!1,Z;do{if(j.available()<4)Z=Tt.TERMINATOR;else{const le=j.readBits(4);Z=Tt.forBits(le)}switch(Z){case Tt.TERMINATOR:break;case Tt.FNC1_FIRST_POSITION:case Tt.FNC1_SECOND_POSITION:Y=!0;break;case Tt.STRUCTURED_APPEND:if(j.available()<16)throw new D;R=j.readBits(8),U=j.readBits(8);break;case Tt.ECI:const le=Bs.parseECIValue(j);if(W=M.getCharacterSetECIByValue(le),W===null)throw new D;break;case Tt.HANZI:const be=j.readBits(4),Ne=j.readBits(Z.getCharacterCountBits(p));be===Bs.GB2312_SUBSET&&Bs.decodeHanziSegment(j,C,Ne);break;default:const Ae=j.readBits(Z.getCharacterCountBits(p));switch(Z){case Tt.NUMERIC:Bs.decodeNumericSegment(j,C,Ae);break;case Tt.ALPHANUMERIC:Bs.decodeAlphanumericSegment(j,C,Ae,Y);break;case Tt.BYTE:Bs.decodeByteSegment(j,C,Ae,W,E,N);break;case Tt.KANJI:Bs.decodeKanjiSegment(j,C,Ae);break;default:throw new D}break}}while(Z!==Tt.TERMINATOR)}catch{throw new D}return new ue(m,C.toString(),E.length===0?null:E,g===null?null:g.toString(),R,U)}static decodeHanziSegment(m,p,g){if(g*13>m.available())throw new D;const N=new Uint8Array(2*g);let j=0;for(;g>0;){const C=m.readBits(13);let E=C/96<<8&4294967295|C%96;E<959?E+=41377:E+=42657,N[j]=E>>8&255,N[j+1]=E&255,j+=2,g--}try{p.append(L.decode(N,F.GB2312))}catch(C){throw new D(C)}}static decodeKanjiSegment(m,p,g){if(g*13>m.available())throw new D;const N=new Uint8Array(2*g);let j=0;for(;g>0;){const C=m.readBits(13);let E=C/192<<8&4294967295|C%192;E<7936?E+=33088:E+=49472,N[j]=E>>8,N[j+1]=E,j+=2,g--}try{p.append(L.decode(N,F.SHIFT_JIS))}catch(C){throw new D(C)}}static decodeByteSegment(m,p,g,N,j,C){if(8*g>m.available())throw new D;const E=new Uint8Array(g);for(let U=0;U<g;U++)E[U]=m.readBits(8);let R;N===null?R=F.guessEncoding(E,C):R=N.getName();try{p.append(L.decode(E,R))}catch(U){throw new D(U)}j.push(E)}static toAlphaNumericChar(m){if(m>=Bs.ALPHANUMERIC_CHARS.length)throw new D;return Bs.ALPHANUMERIC_CHARS[m]}static decodeAlphanumericSegment(m,p,g,N){const j=p.length();for(;g>1;){if(m.available()<11)throw new D;const C=m.readBits(11);p.append(Bs.toAlphaNumericChar(Math.floor(C/45))),p.append(Bs.toAlphaNumericChar(C%45)),g-=2}if(g===1){if(m.available()<6)throw new D;p.append(Bs.toAlphaNumericChar(m.readBits(6)))}if(N)for(let C=j;C<p.length();C++)p.charAt(C)==="%"&&(C<p.length()-1&&p.charAt(C+1)==="%"?p.deleteCharAt(C+1):p.setCharAt(C,""))}static decodeNumericSegment(m,p,g){for(;g>=3;){if(m.available()<10)throw new D;const N=m.readBits(10);if(N>=1e3)throw new D;p.append(Bs.toAlphaNumericChar(Math.floor(N/100))),p.append(Bs.toAlphaNumericChar(Math.floor(N/10)%10)),p.append(Bs.toAlphaNumericChar(N%10)),g-=3}if(g===2){if(m.available()<7)throw new D;const N=m.readBits(7);if(N>=100)throw new D;p.append(Bs.toAlphaNumericChar(Math.floor(N/10))),p.append(Bs.toAlphaNumericChar(N%10))}else if(g===1){if(m.available()<4)throw new D;const N=m.readBits(4);if(N>=10)throw new D;p.append(Bs.toAlphaNumericChar(N))}}static parseECIValue(m){const p=m.readBits(8);if(!(p&128))return p&127;if((p&192)===128){const g=m.readBits(8);return(p&63)<<8&4294967295|g}if((p&224)===192){const g=m.readBits(16);return(p&31)<<16&4294967295|g}throw new D}}Bs.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",Bs.GB2312_SUBSET=1;class cf{constructor(m){this.mirrored=m}isMirrored(){return this.mirrored}applyMirroredCorrection(m){if(!this.mirrored||m===null||m.length<3)return;const p=m[0];m[0]=m[2],m[2]=p}}class g0{constructor(){this.rsDecoder=new ft(qe.QR_CODE_FIELD_256)}decodeBooleanArray(m,p){return this.decodeBitMatrix($.parseFromBooleanArray(m),p)}decodeBitMatrix(m,p){const g=new UN(m);let N=null;try{return this.decodeBitMatrixParser(g,p)}catch(j){N=j}try{g.remask(),g.setMirror(!0),g.readVersion(),g.readFormatInformation(),g.mirror();const j=this.decodeBitMatrixParser(g,p);return j.setOther(new cf(!0)),j}catch(j){throw N!==null?N:j}}decodeBitMatrixParser(m,p){const g=m.readVersion(),N=m.readFormatInformation().getErrorCorrectionLevel(),j=m.readCodewords(),C=of.getDataBlocks(j,g,N);let E=0;for(const W of C)E+=W.getNumDataCodewords();const R=new Uint8Array(E);let U=0;for(const W of C){const Y=W.getCodewords(),Z=W.getNumDataCodewords();this.correctErrors(Y,Z);for(let le=0;le<Z;le++)R[U++]=Y[le]}return Bs.decode(R,g,N,p)}correctErrors(m,p){const g=new Int32Array(m);try{this.rsDecoder.decode(g,m.length-p)}catch{throw new b}for(let N=0;N<p;N++)m[N]=g[N]}}class eh extends xe{constructor(m,p,g){super(m,p),this.estimatedModuleSize=g}aboutEquals(m,p,g){if(Math.abs(p-this.getY())<=m&&Math.abs(g-this.getX())<=m){const N=Math.abs(m-this.estimatedModuleSize);return N<=1||N<=this.estimatedModuleSize}return!1}combineEstimate(m,p,g){const N=(this.getX()+p)/2,j=(this.getY()+m)/2,C=(this.estimatedModuleSize+g)/2;return new eh(N,j,C)}}class Pd{constructor(m,p,g,N,j,C,E){this.image=m,this.startX=p,this.startY=g,this.width=N,this.height=j,this.moduleSize=C,this.resultPointCallback=E,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const m=this.startX,p=this.height,g=this.width,N=m+g,j=this.startY+p/2,C=new Int32Array(3),E=this.image;for(let R=0;R<p;R++){const U=j+(R&1?-Math.floor((R+1)/2):Math.floor((R+1)/2));C[0]=0,C[1]=0,C[2]=0;let W=m;for(;W<N&&!E.get(W,U);)W++;let Y=0;for(;W<N;){if(E.get(W,U))if(Y===1)C[1]++;else if(Y===2){if(this.foundPatternCross(C)){const Z=this.handlePossibleCenter(C,U,W);if(Z!==null)return Z}C[0]=C[2],C[1]=1,C[2]=0,Y=1}else C[++Y]++;else Y===1&&Y++,C[Y]++;W++}if(this.foundPatternCross(C)){const Z=this.handlePossibleCenter(C,U,N);if(Z!==null)return Z}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new z}static centerFromEnd(m,p){return p-m[2]-m[1]/2}foundPatternCross(m){const p=this.moduleSize,g=p/2;for(let N=0;N<3;N++)if(Math.abs(p-m[N])>=g)return!1;return!0}crossCheckVertical(m,p,g,N){const j=this.image,C=j.getHeight(),E=this.crossCheckStateCount;E[0]=0,E[1]=0,E[2]=0;let R=m;for(;R>=0&&j.get(p,R)&&E[1]<=g;)E[1]++,R--;if(R<0||E[1]>g)return NaN;for(;R>=0&&!j.get(p,R)&&E[0]<=g;)E[0]++,R--;if(E[0]>g)return NaN;for(R=m+1;R<C&&j.get(p,R)&&E[1]<=g;)E[1]++,R++;if(R===C||E[1]>g)return NaN;for(;R<C&&!j.get(p,R)&&E[2]<=g;)E[2]++,R++;if(E[2]>g)return NaN;const U=E[0]+E[1]+E[2];return 5*Math.abs(U-N)>=2*N?NaN:this.foundPatternCross(E)?Pd.centerFromEnd(E,R):NaN}handlePossibleCenter(m,p,g){const N=m[0]+m[1]+m[2],j=Pd.centerFromEnd(m,g),C=this.crossCheckVertical(p,j,2*m[1],N);if(!isNaN(C)){const E=(m[0]+m[1]+m[2])/3;for(const U of this.possibleCenters)if(U.aboutEquals(E,C,j))return U.combineEstimate(C,j,E);const R=new eh(j,C,E);this.possibleCenters.push(R),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(R)}return null}}class th extends xe{constructor(m,p,g,N){super(m,p),this.estimatedModuleSize=g,this.count=N,N===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(m,p,g){if(Math.abs(p-this.getY())<=m&&Math.abs(g-this.getX())<=m){const N=Math.abs(m-this.estimatedModuleSize);return N<=1||N<=this.estimatedModuleSize}return!1}combineEstimate(m,p,g){const N=this.count+1,j=(this.count*this.getX()+p)/N,C=(this.count*this.getY()+m)/N,E=(this.count*this.estimatedModuleSize+g)/N;return new th(j,C,E,N)}}class y0{constructor(m){this.bottomLeft=m[0],this.topLeft=m[1],this.topRight=m[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class En{constructor(m,p){this.image=m,this.resultPointCallback=p,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=p}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(m){const p=m!=null&&m.get(O.TRY_HARDER)!==void 0,g=m!=null&&m.get(O.PURE_BARCODE)!==void 0,N=this.image,j=N.getHeight(),C=N.getWidth();let E=Math.floor(3*j/(4*En.MAX_MODULES));(E<En.MIN_SKIP||p)&&(E=En.MIN_SKIP);let R=!1;const U=new Int32Array(5);for(let Y=E-1;Y<j&&!R;Y+=E){U[0]=0,U[1]=0,U[2]=0,U[3]=0,U[4]=0;let Z=0;for(let le=0;le<C;le++)if(N.get(le,Y))(Z&1)===1&&Z++,U[Z]++;else if(Z&1)U[Z]++;else if(Z===4)if(En.foundPatternCross(U)){if(this.handlePossibleCenter(U,Y,le,g)===!0)if(E=2,this.hasSkipped===!0)R=this.haveMultiplyConfirmedCenters();else{const Ne=this.findRowSkip();Ne>U[2]&&(Y+=Ne-U[2]-E,le=C-1)}else{U[0]=U[2],U[1]=U[3],U[2]=U[4],U[3]=1,U[4]=0,Z=3;continue}Z=0,U[0]=0,U[1]=0,U[2]=0,U[3]=0,U[4]=0}else U[0]=U[2],U[1]=U[3],U[2]=U[4],U[3]=1,U[4]=0,Z=3;else U[++Z]++;En.foundPatternCross(U)&&this.handlePossibleCenter(U,Y,C,g)===!0&&(E=U[0],this.hasSkipped&&(R=this.haveMultiplyConfirmedCenters()))}const W=this.selectBestPatterns();return xe.orderBestPatterns(W),new y0(W)}static centerFromEnd(m,p){return p-m[4]-m[3]-m[2]/2}static foundPatternCross(m){let p=0;for(let j=0;j<5;j++){const C=m[j];if(C===0)return!1;p+=C}if(p<7)return!1;const g=p/7,N=g/2;return Math.abs(g-m[0])<N&&Math.abs(g-m[1])<N&&Math.abs(3*g-m[2])<3*N&&Math.abs(g-m[3])<N&&Math.abs(g-m[4])<N}getCrossCheckStateCount(){const m=this.crossCheckStateCount;return m[0]=0,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m}crossCheckDiagonal(m,p,g,N){const j=this.getCrossCheckStateCount();let C=0;const E=this.image;for(;m>=C&&p>=C&&E.get(p-C,m-C);)j[2]++,C++;if(m<C||p<C)return!1;for(;m>=C&&p>=C&&!E.get(p-C,m-C)&&j[1]<=g;)j[1]++,C++;if(m<C||p<C||j[1]>g)return!1;for(;m>=C&&p>=C&&E.get(p-C,m-C)&&j[0]<=g;)j[0]++,C++;if(j[0]>g)return!1;const R=E.getHeight(),U=E.getWidth();for(C=1;m+C<R&&p+C<U&&E.get(p+C,m+C);)j[2]++,C++;if(m+C>=R||p+C>=U)return!1;for(;m+C<R&&p+C<U&&!E.get(p+C,m+C)&&j[3]<g;)j[3]++,C++;if(m+C>=R||p+C>=U||j[3]>=g)return!1;for(;m+C<R&&p+C<U&&E.get(p+C,m+C)&&j[4]<g;)j[4]++,C++;if(j[4]>=g)return!1;const W=j[0]+j[1]+j[2]+j[3]+j[4];return Math.abs(W-N)<2*N&&En.foundPatternCross(j)}crossCheckVertical(m,p,g,N){const j=this.image,C=j.getHeight(),E=this.getCrossCheckStateCount();let R=m;for(;R>=0&&j.get(p,R);)E[2]++,R--;if(R<0)return NaN;for(;R>=0&&!j.get(p,R)&&E[1]<=g;)E[1]++,R--;if(R<0||E[1]>g)return NaN;for(;R>=0&&j.get(p,R)&&E[0]<=g;)E[0]++,R--;if(E[0]>g)return NaN;for(R=m+1;R<C&&j.get(p,R);)E[2]++,R++;if(R===C)return NaN;for(;R<C&&!j.get(p,R)&&E[3]<g;)E[3]++,R++;if(R===C||E[3]>=g)return NaN;for(;R<C&&j.get(p,R)&&E[4]<g;)E[4]++,R++;if(E[4]>=g)return NaN;const U=E[0]+E[1]+E[2]+E[3]+E[4];return 5*Math.abs(U-N)>=2*N?NaN:En.foundPatternCross(E)?En.centerFromEnd(E,R):NaN}crossCheckHorizontal(m,p,g,N){const j=this.image,C=j.getWidth(),E=this.getCrossCheckStateCount();let R=m;for(;R>=0&&j.get(R,p);)E[2]++,R--;if(R<0)return NaN;for(;R>=0&&!j.get(R,p)&&E[1]<=g;)E[1]++,R--;if(R<0||E[1]>g)return NaN;for(;R>=0&&j.get(R,p)&&E[0]<=g;)E[0]++,R--;if(E[0]>g)return NaN;for(R=m+1;R<C&&j.get(R,p);)E[2]++,R++;if(R===C)return NaN;for(;R<C&&!j.get(R,p)&&E[3]<g;)E[3]++,R++;if(R===C||E[3]>=g)return NaN;for(;R<C&&j.get(R,p)&&E[4]<g;)E[4]++,R++;if(E[4]>=g)return NaN;const U=E[0]+E[1]+E[2]+E[3]+E[4];return 5*Math.abs(U-N)>=N?NaN:En.foundPatternCross(E)?En.centerFromEnd(E,R):NaN}handlePossibleCenter(m,p,g,N){const j=m[0]+m[1]+m[2]+m[3]+m[4];let C=En.centerFromEnd(m,g),E=this.crossCheckVertical(p,Math.floor(C),m[2],j);if(!isNaN(E)&&(C=this.crossCheckHorizontal(Math.floor(C),Math.floor(E),m[2],j),!isNaN(C)&&(!N||this.crossCheckDiagonal(Math.floor(E),Math.floor(C),m[2],j)))){const R=j/7;let U=!1;const W=this.possibleCenters;for(let Y=0,Z=W.length;Y<Z;Y++){const le=W[Y];if(le.aboutEquals(R,E,C)){W[Y]=le.combineEstimate(E,C,R),U=!0;break}}if(!U){const Y=new th(C,E,R);W.push(Y),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(Y)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let p=null;for(const g of this.possibleCenters)if(g.getCount()>=En.CENTER_QUORUM)if(p==null)p=g;else return this.hasSkipped=!0,Math.floor((Math.abs(p.getX()-g.getX())-Math.abs(p.getY()-g.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let m=0,p=0;const g=this.possibleCenters.length;for(const C of this.possibleCenters)C.getCount()>=En.CENTER_QUORUM&&(m++,p+=C.getEstimatedModuleSize());if(m<3)return!1;const N=p/g;let j=0;for(const C of this.possibleCenters)j+=Math.abs(C.getEstimatedModuleSize()-N);return j<=.05*p}selectBestPatterns(){const m=this.possibleCenters.length;if(m<3)throw new z;const p=this.possibleCenters;let g;if(m>3){let N=0,j=0;for(const R of this.possibleCenters){const U=R.getEstimatedModuleSize();N+=U,j+=U*U}g=N/m;let C=Math.sqrt(j/m-g*g);p.sort((R,U)=>{const W=Math.abs(U.getEstimatedModuleSize()-g),Y=Math.abs(R.getEstimatedModuleSize()-g);return W<Y?-1:W>Y?1:0});const E=Math.max(.2*g,C);for(let R=0;R<p.length&&p.length>3;R++){const U=p[R];Math.abs(U.getEstimatedModuleSize()-g)>E&&(p.splice(R,1),R--)}}if(p.length>3){let N=0;for(const j of p)N+=j.getEstimatedModuleSize();g=N/p.length,p.sort((j,C)=>{if(C.getCount()===j.getCount()){const E=Math.abs(C.getEstimatedModuleSize()-g),R=Math.abs(j.getEstimatedModuleSize()-g);return E<R?1:E>R?-1:0}else return C.getCount()-j.getCount()}),p.splice(3)}return[p[0],p[1],p[2]]}}En.CENTER_QUORUM=2,En.MIN_SKIP=3,En.MAX_MODULES=57;class uc{constructor(m){this.image=m}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(m){this.resultPointCallback=m==null?null:m.get(O.NEED_RESULT_POINT_CALLBACK);const g=new En(this.image,this.resultPointCallback).find(m);return this.processFinderPatternInfo(g)}processFinderPatternInfo(m){const p=m.getTopLeft(),g=m.getTopRight(),N=m.getBottomLeft(),j=this.calculateModuleSize(p,g,N);if(j<1)throw new z("No pattern found in proccess finder.");const C=uc.computeDimension(p,g,N,j),E=At.getProvisionalVersionForDimension(C),R=E.getDimensionForVersion()-7;let U=null;if(E.getAlignmentPatternCenters().length>0){const le=g.getX()-p.getX()+N.getX(),be=g.getY()-p.getY()+N.getY(),Ne=1-3/R,Ae=Math.floor(p.getX()+Ne*(le-p.getX())),Oe=Math.floor(p.getY()+Ne*(be-p.getY()));for(let et=4;et<=16;et<<=1)try{U=this.findAlignmentInRegion(j,Ae,Oe,et);break}catch(st){if(!(st instanceof z))throw st}}const W=uc.createTransform(p,g,N,U,C),Y=uc.sampleGrid(this.image,W,C);let Z;return U===null?Z=[N,p,g]:Z=[N,p,g,U],new je(Y,Z)}static createTransform(m,p,g,N,j){const C=j-3.5;let E,R,U,W;return N!==null?(E=N.getX(),R=N.getY(),U=C-3,W=U):(E=p.getX()-m.getX()+g.getX(),R=p.getY()-m.getY()+g.getY(),U=C,W=C),pt.quadrilateralToQuadrilateral(3.5,3.5,C,3.5,U,W,3.5,C,m.getX(),m.getY(),p.getX(),p.getY(),E,R,g.getX(),g.getY())}static sampleGrid(m,p,g){return ds.getInstance().sampleGridWithTransform(m,g,g,p)}static computeDimension(m,p,g,N){const j=ve.round(xe.distance(m,p)/N),C=ve.round(xe.distance(m,g)/N);let E=Math.floor((j+C)/2)+7;switch(E&3){case 0:E++;break;case 2:E--;break;case 3:throw new z("Dimensions could be not found.")}return E}calculateModuleSize(m,p,g){return(this.calculateModuleSizeOneWay(m,p)+this.calculateModuleSizeOneWay(m,g))/2}calculateModuleSizeOneWay(m,p){const g=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(m.getX()),Math.floor(m.getY()),Math.floor(p.getX()),Math.floor(p.getY())),N=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(p.getX()),Math.floor(p.getY()),Math.floor(m.getX()),Math.floor(m.getY()));return isNaN(g)?N/7:isNaN(N)?g/7:(g+N)/14}sizeOfBlackWhiteBlackRunBothWays(m,p,g,N){let j=this.sizeOfBlackWhiteBlackRun(m,p,g,N),C=1,E=m-(g-m);E<0?(C=m/(m-E),E=0):E>=this.image.getWidth()&&(C=(this.image.getWidth()-1-m)/(E-m),E=this.image.getWidth()-1);let R=Math.floor(p-(N-p)*C);return C=1,R<0?(C=p/(p-R),R=0):R>=this.image.getHeight()&&(C=(this.image.getHeight()-1-p)/(R-p),R=this.image.getHeight()-1),E=Math.floor(m+(E-m)*C),j+=this.sizeOfBlackWhiteBlackRun(m,p,E,R),j-1}sizeOfBlackWhiteBlackRun(m,p,g,N){const j=Math.abs(N-p)>Math.abs(g-m);if(j){let le=m;m=p,p=le,le=g,g=N,N=le}const C=Math.abs(g-m),E=Math.abs(N-p);let R=-C/2;const U=m<g?1:-1,W=p<N?1:-1;let Y=0;const Z=g+U;for(let le=m,be=p;le!==Z;le+=U){const Ne=j?be:le,Ae=j?le:be;if(Y===1===this.image.get(Ne,Ae)){if(Y===2)return ve.distance(le,be,m,p);Y++}if(R+=E,R>0){if(be===N)break;be+=W,R-=C}}return Y===2?ve.distance(g+U,N,m,p):NaN}findAlignmentInRegion(m,p,g,N){const j=Math.floor(N*m),C=Math.max(0,p-j),E=Math.min(this.image.getWidth()-1,p+j);if(E-C<m*3)throw new z("Alignment top exceeds estimated module size.");const R=Math.max(0,g-j),U=Math.min(this.image.getHeight()-1,g+j);if(U-R<m*3)throw new z("Alignment bottom exceeds estimated module size.");return new Pd(this.image,C,R,E-C,U-R,m,this.resultPointCallback).find()}}class tl{constructor(){this.decoder=new g0}getDecoder(){return this.decoder}decode(m,p){let g,N;if(p!=null&&p.get(O.PURE_BARCODE)!==void 0){const R=tl.extractPureBits(m.getBlackMatrix());g=this.decoder.decodeBitMatrix(R,p),N=tl.NO_POINTS}else{const R=new uc(m.getBlackMatrix()).detect(p);g=this.decoder.decodeBitMatrix(R.getBits(),p),N=R.getPoints()}g.getOther()instanceof cf&&g.getOther().applyMirroredCorrection(N);const j=new ce(g.getText(),g.getRawBytes(),void 0,N,X.QR_CODE,void 0),C=g.getByteSegments();C!==null&&j.putMetadata(Ce.BYTE_SEGMENTS,C);const E=g.getECLevel();return E!==null&&j.putMetadata(Ce.ERROR_CORRECTION_LEVEL,E),g.hasStructuredAppend()&&(j.putMetadata(Ce.STRUCTURED_APPEND_SEQUENCE,g.getStructuredAppendSequenceNumber()),j.putMetadata(Ce.STRUCTURED_APPEND_PARITY,g.getStructuredAppendParity())),j}reset(){}static extractPureBits(m){const p=m.getTopLeftOnBit(),g=m.getBottomRightOnBit();if(p===null||g===null)throw new z;const N=this.moduleSize(p,m);let j=p[1],C=g[1],E=p[0],R=g[0];if(E>=R||j>=C)throw new z;if(C-j!==R-E&&(R=E+(C-j),R>=m.getWidth()))throw new z;const U=Math.round((R-E+1)/N),W=Math.round((C-j+1)/N);if(U<=0||W<=0)throw new z;if(W!==U)throw new z;const Y=Math.floor(N/2);j+=Y,E+=Y;const Z=E+Math.floor((U-1)*N)-R;if(Z>0){if(Z>Y)throw new z;E-=Z}const le=j+Math.floor((W-1)*N)-C;if(le>0){if(le>Y)throw new z;j-=le}const be=new $(U,W);for(let Ne=0;Ne<W;Ne++){const Ae=j+Math.floor(Ne*N);for(let Oe=0;Oe<U;Oe++)m.get(E+Math.floor(Oe*N),Ae)&&be.set(Oe,Ne)}return be}static moduleSize(m,p){const g=p.getHeight(),N=p.getWidth();let j=m[0],C=m[1],E=!0,R=0;for(;j<N&&C<g;){if(E!==p.get(j,C)){if(++R===5)break;E=!E}j++,C++}if(j===N||C===g)throw new z;return(j-m[0])/7}}tl.NO_POINTS=new Array;class Lt{PDF417Common(){}static getBitCountSum(m){return ve.sum(m)}static toIntArray(m){if(m==null||!m.length)return Lt.EMPTY_INT_ARRAY;const p=new Int32Array(m.length);let g=0;for(const N of m)p[g++]=N;return p}static getCodeword(m){const p=k.binarySearch(Lt.SYMBOL_TABLE,m&262143);return p<0?-1:(Lt.CODEWORD_TABLE[p]-1)%Lt.NUMBER_OF_CODEWORDS}}Lt.NUMBER_OF_CODEWORDS=929,Lt.MAX_CODEWORDS_IN_BARCODE=Lt.NUMBER_OF_CODEWORDS-1,Lt.MIN_ROWS_IN_BARCODE=3,Lt.MAX_ROWS_IN_BARCODE=90,Lt.MODULES_IN_CODEWORD=17,Lt.MODULES_IN_STOP_PATTERN=18,Lt.BARS_IN_MODULE=8,Lt.EMPTY_INT_ARRAY=new Int32Array([]),Lt.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),Lt.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class me{constructor(m,p){this.bits=m,this.points=p}getBits(){return this.bits}getPoints(){return this.points}}class Ke{static detectMultiple(m,p,g){let N=m.getBlackMatrix(),j=Ke.detect(g,N);return j.length||(N=N.clone(),N.rotate180(),j=Ke.detect(g,N)),new me(N,j)}static detect(m,p){const g=new Array;let N=0,j=0,C=!1;for(;N<p.getHeight();){const E=Ke.findVertices(p,N,j);if(E[0]==null&&E[3]==null){if(!C)break;C=!1,j=0;for(const R of g)R[1]!=null&&(N=Math.trunc(Math.max(N,R[1].getY()))),R[3]!=null&&(N=Math.max(N,Math.trunc(R[3].getY())));N+=Ke.ROW_STEP;continue}if(C=!0,g.push(E),!m)break;E[2]!=null?(j=Math.trunc(E[2].getX()),N=Math.trunc(E[2].getY())):(j=Math.trunc(E[4].getX()),N=Math.trunc(E[4].getY()))}return g}static findVertices(m,p,g){const N=m.getHeight(),j=m.getWidth(),C=new Array(8);return Ke.copyToResult(C,Ke.findRowsWithPattern(m,N,j,p,g,Ke.START_PATTERN),Ke.INDEXES_START_PATTERN),C[4]!=null&&(g=Math.trunc(C[4].getX()),p=Math.trunc(C[4].getY())),Ke.copyToResult(C,Ke.findRowsWithPattern(m,N,j,p,g,Ke.STOP_PATTERN),Ke.INDEXES_STOP_PATTERN),C}static copyToResult(m,p,g){for(let N=0;N<g.length;N++)m[g[N]]=p[N]}static findRowsWithPattern(m,p,g,N,j,C){const E=new Array(4);let R=!1;const U=new Int32Array(C.length);for(;N<p;N+=Ke.ROW_STEP){let Y=Ke.findGuardPattern(m,j,N,g,!1,C,U);if(Y!=null){for(;N>0;){const Z=Ke.findGuardPattern(m,j,--N,g,!1,C,U);if(Z!=null)Y=Z;else{N++;break}}E[0]=new xe(Y[0],N),E[1]=new xe(Y[1],N),R=!0;break}}let W=N+1;if(R){let Y=0,Z=Int32Array.from([Math.trunc(E[0].getX()),Math.trunc(E[1].getX())]);for(;W<p;W++){const le=Ke.findGuardPattern(m,Z[0],W,g,!1,C,U);if(le!=null&&Math.abs(Z[0]-le[0])<Ke.MAX_PATTERN_DRIFT&&Math.abs(Z[1]-le[1])<Ke.MAX_PATTERN_DRIFT)Z=le,Y=0;else{if(Y>Ke.SKIPPED_ROW_COUNT_MAX)break;Y++}}W-=Y+1,E[2]=new xe(Z[0],W),E[3]=new xe(Z[1],W)}return W-N<Ke.BARCODE_MIN_HEIGHT&&k.fill(E,null),E}static findGuardPattern(m,p,g,N,j,C,E){k.fillWithin(E,0,E.length,0);let R=p,U=0;for(;m.get(R,g)&&R>0&&U++<Ke.MAX_PIXEL_DRIFT;)R--;let W=R,Y=0,Z=C.length;for(let le=j;W<N;W++)if(m.get(W,g)!==le)E[Y]++;else{if(Y===Z-1){if(Ke.patternMatchVariance(E,C,Ke.MAX_INDIVIDUAL_VARIANCE)<Ke.MAX_AVG_VARIANCE)return new Int32Array([R,W]);R+=E[0]+E[1],w.arraycopy(E,2,E,0,Y-1),E[Y-1]=0,E[Y]=0,Y--}else Y++;E[Y]=1,le=!le}return Y===Z-1&&Ke.patternMatchVariance(E,C,Ke.MAX_INDIVIDUAL_VARIANCE)<Ke.MAX_AVG_VARIANCE?new Int32Array([R,W-1]):null}static patternMatchVariance(m,p,g){let N=m.length,j=0,C=0;for(let U=0;U<N;U++)j+=m[U],C+=p[U];if(j<C)return 1/0;let E=j/C;g*=E;let R=0;for(let U=0;U<N;U++){let W=m[U],Y=p[U]*E,Z=W>Y?W-Y:Y-W;if(Z>g)return 1/0;R+=Z}return R/j}}Ke.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Ke.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Ke.MAX_AVG_VARIANCE=.42,Ke.MAX_INDIVIDUAL_VARIANCE=.8,Ke.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Ke.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Ke.MAX_PIXEL_DRIFT=3,Ke.MAX_PATTERN_DRIFT=5,Ke.SKIPPED_ROW_COUNT_MAX=25,Ke.ROW_STEP=5,Ke.BARCODE_MIN_HEIGHT=10;class St{constructor(m,p){if(p.length===0)throw new f;this.field=m;let g=p.length;if(g>1&&p[0]===0){let N=1;for(;N<g&&p[N]===0;)N++;N===g?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(g-N),w.arraycopy(p,N,this.coefficients,0,this.coefficients.length))}else this.coefficients=p}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(m){return this.coefficients[this.coefficients.length-1-m]}evaluateAt(m){if(m===0)return this.getCoefficient(0);if(m===1){let N=0;for(let j of this.coefficients)N=this.field.add(N,j);return N}let p=this.coefficients[0],g=this.coefficients.length;for(let N=1;N<g;N++)p=this.field.add(this.field.multiply(m,p),this.coefficients[N]);return p}add(m){if(!this.field.equals(m.field))throw new f("ModulusPolys do not have same ModulusGF field");if(this.isZero())return m;if(m.isZero())return this;let p=this.coefficients,g=m.coefficients;if(p.length>g.length){let C=p;p=g,g=C}let N=new Int32Array(g.length),j=g.length-p.length;w.arraycopy(g,0,N,0,j);for(let C=j;C<g.length;C++)N[C]=this.field.add(p[C-j],g[C]);return new St(this.field,N)}subtract(m){if(!this.field.equals(m.field))throw new f("ModulusPolys do not have same ModulusGF field");return m.isZero()?this:this.add(m.negative())}multiply(m){return m instanceof St?this.multiplyOther(m):this.multiplyScalar(m)}multiplyOther(m){if(!this.field.equals(m.field))throw new f("ModulusPolys do not have same ModulusGF field");if(this.isZero()||m.isZero())return new St(this.field,new Int32Array([0]));let p=this.coefficients,g=p.length,N=m.coefficients,j=N.length,C=new Int32Array(g+j-1);for(let E=0;E<g;E++){let R=p[E];for(let U=0;U<j;U++)C[E+U]=this.field.add(C[E+U],this.field.multiply(R,N[U]))}return new St(this.field,C)}negative(){let m=this.coefficients.length,p=new Int32Array(m);for(let g=0;g<m;g++)p[g]=this.field.subtract(0,this.coefficients[g]);return new St(this.field,p)}multiplyScalar(m){if(m===0)return new St(this.field,new Int32Array([0]));if(m===1)return this;let p=this.coefficients.length,g=new Int32Array(p);for(let N=0;N<p;N++)g[N]=this.field.multiply(this.coefficients[N],m);return new St(this.field,g)}multiplyByMonomial(m,p){if(m<0)throw new f;if(p===0)return new St(this.field,new Int32Array([0]));let g=this.coefficients.length,N=new Int32Array(g+m);for(let j=0;j<g;j++)N[j]=this.field.multiply(this.coefficients[j],p);return new St(this.field,N)}toString(){let m=new V;for(let p=this.getDegree();p>=0;p--){let g=this.getCoefficient(p);g!==0&&(g<0?(m.append(" - "),g=-g):m.length()>0&&m.append(" + "),(p===0||g!==1)&&m.append(g),p!==0&&(p===1?m.append("x"):(m.append("x^"),m.append(p))))}return m.toString()}}class Ka{add(m,p){return(m+p)%this.modulus}subtract(m,p){return(this.modulus+m-p)%this.modulus}exp(m){return this.expTable[m]}log(m){if(m===0)throw new f;return this.logTable[m]}inverse(m){if(m===0)throw new oe;return this.expTable[this.modulus-this.logTable[m]-1]}multiply(m,p){return m===0||p===0?0:this.expTable[(this.logTable[m]+this.logTable[p])%(this.modulus-1)]}getSize(){return this.modulus}equals(m){return m===this}}class VN extends Ka{constructor(m,p){super(),this.modulus=m,this.expTable=new Int32Array(m),this.logTable=new Int32Array(m);let g=1;for(let N=0;N<m;N++)this.expTable[N]=g,g=g*p%m;for(let N=0;N<m-1;N++)this.logTable[this.expTable[N]]=N;this.zero=new St(this,new Int32Array([0])),this.one=new St(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(m,p){if(m<0)throw new f;if(p===0)return this.zero;let g=new Int32Array(m+1);return g[0]=p,new St(this,g)}}VN.PDF417_GF=new VN(Lt.NUMBER_OF_CODEWORDS,3);class OE{constructor(){this.field=VN.PDF417_GF}decode(m,p,g){let N=new St(this.field,m),j=new Int32Array(p),C=!1;for(let be=p;be>0;be--){let Ne=N.evaluateAt(this.field.exp(be));j[p-be]=Ne,Ne!==0&&(C=!0)}if(!C)return 0;let E=this.field.getOne();if(g!=null)for(const be of g){let Ne=this.field.exp(m.length-1-be),Ae=new St(this.field,new Int32Array([this.field.subtract(0,Ne),1]));E=E.multiply(Ae)}let R=new St(this.field,j),U=this.runEuclideanAlgorithm(this.field.buildMonomial(p,1),R,p),W=U[0],Y=U[1],Z=this.findErrorLocations(W),le=this.findErrorMagnitudes(Y,W,Z);for(let be=0;be<Z.length;be++){let Ne=m.length-1-this.field.log(Z[be]);if(Ne<0)throw b.getChecksumInstance();m[Ne]=this.field.subtract(m[Ne],le[be])}return Z.length}runEuclideanAlgorithm(m,p,g){if(m.getDegree()<p.getDegree()){let Z=m;m=p,p=Z}let N=m,j=p,C=this.field.getZero(),E=this.field.getOne();for(;j.getDegree()>=Math.round(g/2);){let Z=N,le=C;if(N=j,C=E,N.isZero())throw b.getChecksumInstance();j=Z;let be=this.field.getZero(),Ne=N.getCoefficient(N.getDegree()),Ae=this.field.inverse(Ne);for(;j.getDegree()>=N.getDegree()&&!j.isZero();){let Oe=j.getDegree()-N.getDegree(),et=this.field.multiply(j.getCoefficient(j.getDegree()),Ae);be=be.add(this.field.buildMonomial(Oe,et)),j=j.subtract(N.multiplyByMonomial(Oe,et))}E=be.multiply(C).subtract(le).negative()}let R=E.getCoefficient(0);if(R===0)throw b.getChecksumInstance();let U=this.field.inverse(R),W=E.multiply(U),Y=j.multiply(U);return[W,Y]}findErrorLocations(m){let p=m.getDegree(),g=new Int32Array(p),N=0;for(let j=1;j<this.field.getSize()&&N<p;j++)m.evaluateAt(j)===0&&(g[N]=this.field.inverse(j),N++);if(N!==p)throw b.getChecksumInstance();return g}findErrorMagnitudes(m,p,g){let N=p.getDegree(),j=new Int32Array(N);for(let U=1;U<=N;U++)j[N-U]=this.field.multiply(U,p.getCoefficient(U));let C=new St(this.field,j),E=g.length,R=new Int32Array(E);for(let U=0;U<E;U++){let W=this.field.inverse(g[U]),Y=this.field.subtract(0,m.evaluateAt(W)),Z=this.field.inverse(C.evaluateAt(W));R[U]=this.field.multiply(Y,Z)}return R}}class Id{constructor(m,p,g,N,j){m instanceof Id?this.constructor_2(m):this.constructor_1(m,p,g,N,j)}constructor_1(m,p,g,N,j){const C=p==null||g==null,E=N==null||j==null;if(C&&E)throw new z;C?(p=new xe(0,N.getY()),g=new xe(0,j.getY())):E&&(N=new xe(m.getWidth()-1,p.getY()),j=new xe(m.getWidth()-1,g.getY())),this.image=m,this.topLeft=p,this.bottomLeft=g,this.topRight=N,this.bottomRight=j,this.minX=Math.trunc(Math.min(p.getX(),g.getX())),this.maxX=Math.trunc(Math.max(N.getX(),j.getX())),this.minY=Math.trunc(Math.min(p.getY(),N.getY())),this.maxY=Math.trunc(Math.max(g.getY(),j.getY()))}constructor_2(m){this.image=m.image,this.topLeft=m.getTopLeft(),this.bottomLeft=m.getBottomLeft(),this.topRight=m.getTopRight(),this.bottomRight=m.getBottomRight(),this.minX=m.getMinX(),this.maxX=m.getMaxX(),this.minY=m.getMinY(),this.maxY=m.getMaxY()}static merge(m,p){return m==null?p:p==null?m:new Id(m.image,m.topLeft,m.bottomLeft,p.topRight,p.bottomRight)}addMissingRows(m,p,g){let N=this.topLeft,j=this.bottomLeft,C=this.topRight,E=this.bottomRight;if(m>0){let R=g?this.topLeft:this.topRight,U=Math.trunc(R.getY()-m);U<0&&(U=0);let W=new xe(R.getX(),U);g?N=W:C=W}if(p>0){let R=g?this.bottomLeft:this.bottomRight,U=Math.trunc(R.getY()+p);U>=this.image.getHeight()&&(U=this.image.getHeight()-1);let W=new xe(R.getX(),U);g?j=W:E=W}return new Id(this.image,N,j,C,E)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class aY{constructor(m,p,g,N){this.columnCount=m,this.errorCorrectionLevel=N,this.rowCountUpperPart=p,this.rowCountLowerPart=g,this.rowCount=p+g}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class df{constructor(){this.buffer=""}static form(m,p){let g=-1;function N(C,E,R,U,W,Y){if(C==="%%")return"%";if(p[++g]===void 0)return;C=U?parseInt(U.substr(1)):void 0;let Z=W?parseInt(W.substr(1)):void 0,le;switch(Y){case"s":le=p[g];break;case"c":le=p[g][0];break;case"f":le=parseFloat(p[g]).toFixed(C);break;case"p":le=parseFloat(p[g]).toPrecision(C);break;case"e":le=parseFloat(p[g]).toExponential(C);break;case"x":le=parseInt(p[g]).toString(Z||16);break;case"d":le=parseFloat(parseInt(p[g],Z||10).toPrecision(C)).toFixed(0);break}le=typeof le=="object"?JSON.stringify(le):(+le).toString(Z);let be=parseInt(R),Ne=R&&R[0]+""=="0"?"0":" ";for(;le.length<be;)le=E!==void 0?le+Ne:Ne+le;return le}let j=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return m.replace(j,N)}format(m,...p){this.buffer+=df.form(m,p)}toString(){return this.buffer}}class uf{constructor(m){this.boundingBox=new Id(m),this.codewords=new Array(m.getMaxY()-m.getMinY()+1)}getCodewordNearby(m){let p=this.getCodeword(m);if(p!=null)return p;for(let g=1;g<uf.MAX_NEARBY_DISTANCE;g++){let N=this.imageRowToCodewordIndex(m)-g;if(N>=0&&(p=this.codewords[N],p!=null)||(N=this.imageRowToCodewordIndex(m)+g,N<this.codewords.length&&(p=this.codewords[N],p!=null)))return p}return null}imageRowToCodewordIndex(m){return m-this.boundingBox.getMinY()}setCodeword(m,p){this.codewords[this.imageRowToCodewordIndex(m)]=p}getCodeword(m){return this.codewords[this.imageRowToCodewordIndex(m)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const m=new df;let p=0;for(const g of this.codewords){if(g==null){m.format("%3d:    |   %n",p++);continue}m.format("%3d: %3d|%3d%n",p++,g.getRowNumber(),g.getValue())}return m.toString()}}uf.MAX_NEARBY_DISTANCE=5;class hf{constructor(){this.values=new Map}setValue(m){m=Math.trunc(m);let p=this.values.get(m);p==null&&(p=0),p++,this.values.set(m,p)}getValue(){let m=-1,p=new Array;for(const[g,N]of this.values.entries()){const j={getKey:()=>g,getValue:()=>N};j.getValue()>m?(m=j.getValue(),p=[],p.push(j.getKey())):j.getValue()===m&&p.push(j.getKey())}return Lt.toIntArray(p)}getConfidence(m){return this.values.get(m)}}class RE extends uf{constructor(m,p){super(m),this._isLeft=p}setRowNumbers(){for(let m of this.getCodewords())m!=null&&m.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(m){let p=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(p,m);let g=this.getBoundingBox(),N=this._isLeft?g.getTopLeft():g.getTopRight(),j=this._isLeft?g.getBottomLeft():g.getBottomRight(),C=this.imageRowToCodewordIndex(Math.trunc(N.getY())),E=this.imageRowToCodewordIndex(Math.trunc(j.getY())),R=-1,U=1,W=0;for(let Y=C;Y<E;Y++){if(p[Y]==null)continue;let Z=p[Y],le=Z.getRowNumber()-R;if(le===0)W++;else if(le===1)U=Math.max(U,W),W=1,R=Z.getRowNumber();else if(le<0||Z.getRowNumber()>=m.getRowCount()||le>Y)p[Y]=null;else{let be;U>2?be=(U-2)*le:be=le;let Ne=be>=Y;for(let Ae=1;Ae<=be&&!Ne;Ae++)Ne=p[Y-Ae]!=null;Ne?p[Y]=null:(R=Z.getRowNumber(),W=1)}}}getRowHeights(){let m=this.getBarcodeMetadata();if(m==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(m);let p=new Int32Array(m.getRowCount());for(let g of this.getCodewords())if(g!=null){let N=g.getRowNumber();if(N>=p.length)continue;p[N]++}return p}adjustIncompleteIndicatorColumnRowNumbers(m){let p=this.getBoundingBox(),g=this._isLeft?p.getTopLeft():p.getTopRight(),N=this._isLeft?p.getBottomLeft():p.getBottomRight(),j=this.imageRowToCodewordIndex(Math.trunc(g.getY())),C=this.imageRowToCodewordIndex(Math.trunc(N.getY())),E=this.getCodewords(),R=-1;for(let U=j;U<C;U++){if(E[U]==null)continue;let W=E[U];W.setRowNumberAsRowIndicatorColumn();let Y=W.getRowNumber()-R;Y===0||(Y===1?R=W.getRowNumber():W.getRowNumber()>=m.getRowCount()?E[U]=null:R=W.getRowNumber())}}getBarcodeMetadata(){let m=this.getCodewords(),p=new hf,g=new hf,N=new hf,j=new hf;for(let E of m){if(E==null)continue;E.setRowNumberAsRowIndicatorColumn();let R=E.getValue()%30,U=E.getRowNumber();switch(this._isLeft||(U+=2),U%3){case 0:g.setValue(R*3+1);break;case 1:j.setValue(R/3),N.setValue(R%3);break;case 2:p.setValue(R+1);break}}if(p.getValue().length===0||g.getValue().length===0||N.getValue().length===0||j.getValue().length===0||p.getValue()[0]<1||g.getValue()[0]+N.getValue()[0]<Lt.MIN_ROWS_IN_BARCODE||g.getValue()[0]+N.getValue()[0]>Lt.MAX_ROWS_IN_BARCODE)return null;let C=new aY(p.getValue()[0],g.getValue()[0],N.getValue()[0],j.getValue()[0]);return this.removeIncorrectCodewords(m,C),C}removeIncorrectCodewords(m,p){for(let g=0;g<m.length;g++){let N=m[g];if(m[g]==null)continue;let j=N.getValue()%30,C=N.getRowNumber();if(C>p.getRowCount()){m[g]=null;continue}switch(this._isLeft||(C+=2),C%3){case 0:j*3+1!==p.getRowCountUpperPart()&&(m[g]=null);break;case 1:(Math.trunc(j/3)!==p.getErrorCorrectionLevel()||j%3!==p.getRowCountLowerPart())&&(m[g]=null);break;case 2:j+1!==p.getColumnCount()&&(m[g]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class mf{constructor(m,p){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=m,this.barcodeColumnCount=m.getColumnCount(),this.boundingBox=p,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let m=Lt.MAX_CODEWORDS_IN_BARCODE,p;do p=m,m=this.adjustRowNumbersAndGetCount();while(m>0&&m<p);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(m){m!=null&&m.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let m=this.adjustRowNumbersByRow();if(m===0)return 0;for(let p=1;p<this.barcodeColumnCount+1;p++){let g=this.detectionResultColumns[p].getCodewords();for(let N=0;N<g.length;N++)g[N]!=null&&(g[N].hasValidRowNumber()||this.adjustRowNumbers(p,N,g))}return m}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let m=this.detectionResultColumns[0].getCodewords(),p=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let g=0;g<m.length;g++)if(m[g]!=null&&p[g]!=null&&m[g].getRowNumber()===p[g].getRowNumber())for(let N=1;N<=this.barcodeColumnCount;N++){let j=this.detectionResultColumns[N].getCodewords()[g];j!=null&&(j.setRowNumber(m[g].getRowNumber()),j.hasValidRowNumber()||(this.detectionResultColumns[N].getCodewords()[g]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let m=0,p=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let g=0;g<p.length;g++){if(p[g]==null)continue;let N=p[g].getRowNumber(),j=0;for(let C=this.barcodeColumnCount+1;C>0&&j<this.ADJUST_ROW_NUMBER_SKIP;C--){let E=this.detectionResultColumns[C].getCodewords()[g];E!=null&&(j=mf.adjustRowNumberIfValid(N,j,E),E.hasValidRowNumber()||m++)}}return m}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let m=0,p=this.detectionResultColumns[0].getCodewords();for(let g=0;g<p.length;g++){if(p[g]==null)continue;let N=p[g].getRowNumber(),j=0;for(let C=1;C<this.barcodeColumnCount+1&&j<this.ADJUST_ROW_NUMBER_SKIP;C++){let E=this.detectionResultColumns[C].getCodewords()[g];E!=null&&(j=mf.adjustRowNumberIfValid(N,j,E),E.hasValidRowNumber()||m++)}}return m}static adjustRowNumberIfValid(m,p,g){return g==null||g.hasValidRowNumber()||(g.isValidRowNumber(m)?(g.setRowNumber(m),p=0):++p),p}adjustRowNumbers(m,p,g){if(!this.detectionResultColumns[m-1])return;let N=g[p],j=this.detectionResultColumns[m-1].getCodewords(),C=j;this.detectionResultColumns[m+1]!=null&&(C=this.detectionResultColumns[m+1].getCodewords());let E=new Array(14);E[2]=j[p],E[3]=C[p],p>0&&(E[0]=g[p-1],E[4]=j[p-1],E[5]=C[p-1]),p>1&&(E[8]=g[p-2],E[10]=j[p-2],E[11]=C[p-2]),p<g.length-1&&(E[1]=g[p+1],E[6]=j[p+1],E[7]=C[p+1]),p<g.length-2&&(E[9]=g[p+2],E[12]=j[p+2],E[13]=C[p+2]);for(let R of E)if(mf.adjustRowNumber(N,R))return}static adjustRowNumber(m,p){return p==null?!1:p.hasValidRowNumber()&&p.getBucket()===m.getBucket()?(m.setRowNumber(p.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(m){this.boundingBox=m}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(m,p){this.detectionResultColumns[m]=p}getDetectionResultColumn(m){return this.detectionResultColumns[m]}toString(){let m=this.detectionResultColumns[0];m==null&&(m=this.detectionResultColumns[this.barcodeColumnCount+1]);let p=new df;for(let g=0;g<m.getCodewords().length;g++){p.format("CW %3d:",g);for(let N=0;N<this.barcodeColumnCount+2;N++){if(this.detectionResultColumns[N]==null){p.format("    |   ");continue}let j=this.detectionResultColumns[N].getCodewords()[g];if(j==null){p.format("    |   ");continue}p.format(" %3d|%3d",j.getRowNumber(),j.getValue())}p.format("%n")}return p.toString()}}class ff{constructor(m,p,g,N){this.rowNumber=ff.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(m),this.endX=Math.trunc(p),this.bucket=Math.trunc(g),this.value=Math.trunc(N)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(m){return m!==ff.BARCODE_ROW_UNKNOWN&&this.bucket===m%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(m){this.rowNumber=m}toString(){return this.rowNumber+"|"+this.value}}ff.BARCODE_ROW_UNKNOWN=-1;class ja{static initialize(){for(let m=0;m<Lt.SYMBOL_TABLE.length;m++){let p=Lt.SYMBOL_TABLE[m],g=p&1;for(let N=0;N<Lt.BARS_IN_MODULE;N++){let j=0;for(;(p&1)===g;)j+=1,p>>=1;g=p&1,ja.RATIOS_TABLE[m]||(ja.RATIOS_TABLE[m]=new Array(Lt.BARS_IN_MODULE)),ja.RATIOS_TABLE[m][Lt.BARS_IN_MODULE-N-1]=Math.fround(j/Lt.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(m){let p=ja.getDecodedCodewordValue(ja.sampleBitCounts(m));return p!==-1?p:ja.getClosestDecodedValue(m)}static sampleBitCounts(m){let p=ve.sum(m),g=new Int32Array(Lt.BARS_IN_MODULE),N=0,j=0;for(let C=0;C<Lt.MODULES_IN_CODEWORD;C++){let E=p/(2*Lt.MODULES_IN_CODEWORD)+C*p/Lt.MODULES_IN_CODEWORD;j+m[N]<=E&&(j+=m[N],N++),g[N]++}return g}static getDecodedCodewordValue(m){let p=ja.getBitValue(m);return Lt.getCodeword(p)===-1?-1:p}static getBitValue(m){let p=0;for(let g=0;g<m.length;g++)for(let N=0;N<m[g];N++)p=p<<1|(g%2===0?1:0);return Math.trunc(p)}static getClosestDecodedValue(m){let p=ve.sum(m),g=new Array(Lt.BARS_IN_MODULE);if(p>1)for(let C=0;C<g.length;C++)g[C]=Math.fround(m[C]/p);let N=ae.MAX_VALUE,j=-1;this.bSymbolTableReady||ja.initialize();for(let C=0;C<ja.RATIOS_TABLE.length;C++){let E=0,R=ja.RATIOS_TABLE[C];for(let U=0;U<Lt.BARS_IN_MODULE;U++){let W=Math.fround(R[U]-g[U]);if(E+=Math.fround(W*W),E>=N)break}E<N&&(N=E,j=Lt.SYMBOL_TABLE[C])}return j}}ja.bSymbolTableReady=!1,ja.RATIOS_TABLE=new Array(Lt.SYMBOL_TABLE.length).map(K=>new Array(Lt.BARS_IN_MODULE));class LE{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(m){this.segmentIndex=m}getFileId(){return this.fileId}setFileId(m){this.fileId=m}getOptionalData(){return this.optionalData}setOptionalData(m){this.optionalData=m}isLastSegment(){return this.lastSegment}setLastSegment(m){this.lastSegment=m}getSegmentCount(){return this.segmentCount}setSegmentCount(m){this.segmentCount=m}getSender(){return this.sender||null}setSender(m){this.sender=m}getAddressee(){return this.addressee||null}setAddressee(m){this.addressee=m}getFileName(){return this.fileName}setFileName(m){this.fileName=m}getFileSize(){return this.fileSize}setFileSize(m){this.fileSize=m}getChecksum(){return this.checksum}setChecksum(m){this.checksum=m}getTimestamp(){return this.timestamp}setTimestamp(m){this.timestamp=m}}class BE{static parseLong(m,p=void 0){return parseInt(m,p)}}class FE extends u{}FE.kind="NullPointerException";class iY{writeBytes(m){this.writeBytesOffset(m,0,m.length)}writeBytesOffset(m,p,g){if(m==null)throw new FE;if(p<0||p>m.length||g<0||p+g>m.length||p+g<0)throw new _;if(g===0)return;for(let N=0;N<g;N++)this.write(m[p+N])}flush(){}close(){}}class lY extends u{}class oY extends iY{constructor(m=32){if(super(),this.count=0,m<0)throw new f("Negative initial size: "+m);this.buf=new Uint8Array(m)}ensureCapacity(m){m-this.buf.length>0&&this.grow(m)}grow(m){let g=this.buf.length<<1;if(g-m<0&&(g=m),g<0){if(m<0)throw new lY;g=A.MAX_VALUE}this.buf=k.copyOfUint8Array(this.buf,g)}write(m){this.ensureCapacity(this.count+1),this.buf[this.count]=m,this.count+=1}writeBytesOffset(m,p,g){if(p<0||p>m.length||g<0||p+g-m.length>0)throw new _;this.ensureCapacity(this.count+g),w.arraycopy(m,p,this.buf,this.count,g),this.count+=g}writeTo(m){m.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return k.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(m){return m?typeof m=="string"?this.toString_string(m):this.toString_number(m):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(m){return new String(this.buf).toString()}toString_number(m){return new String(this.buf).toString()}close(){}}var As;(function(K){K[K.ALPHA=0]="ALPHA",K[K.LOWER=1]="LOWER",K[K.MIXED=2]="MIXED",K[K.PUNCT=3]="PUNCT",K[K.ALPHA_SHIFT=4]="ALPHA_SHIFT",K[K.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(As||(As={}));function $E(){if(typeof window<"u")return window.BigInt||null;if(typeof gf<"u")return gf.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let b0;function hc(K){if(typeof b0>"u"&&(b0=$E()),b0===null)throw new Error("BigInt is not supported!");return b0(K)}function cY(){let K=[];K[0]=hc(1);let m=hc(900);K[1]=m;for(let p=2;p<16;p++)K[p]=K[p-1]*m;return K}class De{static decode(m,p){let g=new V(""),N=M.ISO8859_1;g.enableDecoding(N);let j=1,C=m[j++],E=new LE;for(;j<m[0];){switch(C){case De.TEXT_COMPACTION_MODE_LATCH:j=De.textCompaction(m,j,g);break;case De.BYTE_COMPACTION_MODE_LATCH:case De.BYTE_COMPACTION_MODE_LATCH_6:j=De.byteCompaction(C,m,N,j,g);break;case De.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:g.append(m[j++]);break;case De.NUMERIC_COMPACTION_MODE_LATCH:j=De.numericCompaction(m,j,g);break;case De.ECI_CHARSET:M.getCharacterSetECIByValue(m[j++]);break;case De.ECI_GENERAL_PURPOSE:j+=2;break;case De.ECI_USER_DEFINED:j++;break;case De.BEGIN_MACRO_PDF417_CONTROL_BLOCK:j=De.decodeMacroBlock(m,j,E);break;case De.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case De.MACRO_PDF417_TERMINATOR:throw new D;default:j--,j=De.textCompaction(m,j,g);break}if(j<m.length)C=m[j++];else throw D.getFormatInstance()}if(g.length()===0)throw D.getFormatInstance();let R=new ue(null,g.toString(),null,p);return R.setOther(E),R}static decodeMacroBlock(m,p,g){if(p+De.NUMBER_OF_SEQUENCE_CODEWORDS>m[0])throw D.getFormatInstance();let N=new Int32Array(De.NUMBER_OF_SEQUENCE_CODEWORDS);for(let E=0;E<De.NUMBER_OF_SEQUENCE_CODEWORDS;E++,p++)N[E]=m[p];g.setSegmentIndex(A.parseInt(De.decodeBase900toBase10(N,De.NUMBER_OF_SEQUENCE_CODEWORDS)));let j=new V;p=De.textCompaction(m,p,j),g.setFileId(j.toString());let C=-1;for(m[p]===De.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(C=p+1);p<m[0];)switch(m[p]){case De.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(p++,m[p]){case De.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let E=new V;p=De.textCompaction(m,p+1,E),g.setFileName(E.toString());break;case De.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let R=new V;p=De.textCompaction(m,p+1,R),g.setSender(R.toString());break;case De.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let U=new V;p=De.textCompaction(m,p+1,U),g.setAddressee(U.toString());break;case De.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let W=new V;p=De.numericCompaction(m,p+1,W),g.setSegmentCount(A.parseInt(W.toString()));break;case De.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let Y=new V;p=De.numericCompaction(m,p+1,Y),g.setTimestamp(BE.parseLong(Y.toString()));break;case De.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let Z=new V;p=De.numericCompaction(m,p+1,Z),g.setChecksum(A.parseInt(Z.toString()));break;case De.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let le=new V;p=De.numericCompaction(m,p+1,le),g.setFileSize(BE.parseLong(le.toString()));break;default:throw D.getFormatInstance()}break;case De.MACRO_PDF417_TERMINATOR:p++,g.setLastSegment(!0);break;default:throw D.getFormatInstance()}if(C!==-1){let E=p-C;g.isLastSegment()&&E--,g.setOptionalData(k.copyOfRange(m,C,C+E))}return p}static textCompaction(m,p,g){let N=new Int32Array((m[0]-p)*2),j=new Int32Array((m[0]-p)*2),C=0,E=!1;for(;p<m[0]&&!E;){let R=m[p++];if(R<De.TEXT_COMPACTION_MODE_LATCH)N[C]=R/30,N[C+1]=R%30,C+=2;else switch(R){case De.TEXT_COMPACTION_MODE_LATCH:N[C++]=De.TEXT_COMPACTION_MODE_LATCH;break;case De.BYTE_COMPACTION_MODE_LATCH:case De.BYTE_COMPACTION_MODE_LATCH_6:case De.NUMERIC_COMPACTION_MODE_LATCH:case De.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case De.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case De.MACRO_PDF417_TERMINATOR:p--,E=!0;break;case De.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:N[C]=De.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,R=m[p++],j[C]=R,C++;break}}return De.decodeTextCompaction(N,j,C,g),p}static decodeTextCompaction(m,p,g,N){let j=As.ALPHA,C=As.ALPHA,E=0;for(;E<g;){let R=m[E],U="";switch(j){case As.ALPHA:if(R<26)U=String.fromCharCode(65+R);else switch(R){case 26:U=" ";break;case De.LL:j=As.LOWER;break;case De.ML:j=As.MIXED;break;case De.PS:C=j,j=As.PUNCT_SHIFT;break;case De.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:N.append(p[E]);break;case De.TEXT_COMPACTION_MODE_LATCH:j=As.ALPHA;break}break;case As.LOWER:if(R<26)U=String.fromCharCode(97+R);else switch(R){case 26:U=" ";break;case De.AS:C=j,j=As.ALPHA_SHIFT;break;case De.ML:j=As.MIXED;break;case De.PS:C=j,j=As.PUNCT_SHIFT;break;case De.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:N.append(p[E]);break;case De.TEXT_COMPACTION_MODE_LATCH:j=As.ALPHA;break}break;case As.MIXED:if(R<De.PL)U=De.MIXED_CHARS[R];else switch(R){case De.PL:j=As.PUNCT;break;case 26:U=" ";break;case De.LL:j=As.LOWER;break;case De.AL:j=As.ALPHA;break;case De.PS:C=j,j=As.PUNCT_SHIFT;break;case De.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:N.append(p[E]);break;case De.TEXT_COMPACTION_MODE_LATCH:j=As.ALPHA;break}break;case As.PUNCT:if(R<De.PAL)U=De.PUNCT_CHARS[R];else switch(R){case De.PAL:j=As.ALPHA;break;case De.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:N.append(p[E]);break;case De.TEXT_COMPACTION_MODE_LATCH:j=As.ALPHA;break}break;case As.ALPHA_SHIFT:if(j=C,R<26)U=String.fromCharCode(65+R);else switch(R){case 26:U=" ";break;case De.TEXT_COMPACTION_MODE_LATCH:j=As.ALPHA;break}break;case As.PUNCT_SHIFT:if(j=C,R<De.PAL)U=De.PUNCT_CHARS[R];else switch(R){case De.PAL:j=As.ALPHA;break;case De.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:N.append(p[E]);break;case De.TEXT_COMPACTION_MODE_LATCH:j=As.ALPHA;break}break}U!==""&&N.append(U),E++}}static byteCompaction(m,p,g,N,j){let C=new oY,E=0,R=0,U=!1;switch(m){case De.BYTE_COMPACTION_MODE_LATCH:let W=new Int32Array(6),Y=p[N++];for(;N<p[0]&&!U;)switch(W[E++]=Y,R=900*R+Y,Y=p[N++],Y){case De.TEXT_COMPACTION_MODE_LATCH:case De.BYTE_COMPACTION_MODE_LATCH:case De.NUMERIC_COMPACTION_MODE_LATCH:case De.BYTE_COMPACTION_MODE_LATCH_6:case De.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case De.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case De.MACRO_PDF417_TERMINATOR:N--,U=!0;break;default:if(E%5===0&&E>0){for(let Z=0;Z<6;++Z)C.write(Number(hc(R)>>hc(8*(5-Z))));R=0,E=0}break}N===p[0]&&Y<De.TEXT_COMPACTION_MODE_LATCH&&(W[E++]=Y);for(let Z=0;Z<E;Z++)C.write(W[Z]);break;case De.BYTE_COMPACTION_MODE_LATCH_6:for(;N<p[0]&&!U;){let Z=p[N++];if(Z<De.TEXT_COMPACTION_MODE_LATCH)E++,R=900*R+Z;else switch(Z){case De.TEXT_COMPACTION_MODE_LATCH:case De.BYTE_COMPACTION_MODE_LATCH:case De.NUMERIC_COMPACTION_MODE_LATCH:case De.BYTE_COMPACTION_MODE_LATCH_6:case De.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case De.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case De.MACRO_PDF417_TERMINATOR:N--,U=!0;break}if(E%5===0&&E>0){for(let le=0;le<6;++le)C.write(Number(hc(R)>>hc(8*(5-le))));R=0,E=0}}break}return j.append(L.decode(C.toByteArray(),g)),N}static numericCompaction(m,p,g){let N=0,j=!1,C=new Int32Array(De.MAX_NUMERIC_CODEWORDS);for(;p<m[0]&&!j;){let E=m[p++];if(p===m[0]&&(j=!0),E<De.TEXT_COMPACTION_MODE_LATCH)C[N]=E,N++;else switch(E){case De.TEXT_COMPACTION_MODE_LATCH:case De.BYTE_COMPACTION_MODE_LATCH:case De.BYTE_COMPACTION_MODE_LATCH_6:case De.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case De.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case De.MACRO_PDF417_TERMINATOR:p--,j=!0;break}(N%De.MAX_NUMERIC_CODEWORDS===0||E===De.NUMERIC_COMPACTION_MODE_LATCH||j)&&N>0&&(g.append(De.decodeBase900toBase10(C,N)),N=0)}return p}static decodeBase900toBase10(m,p){let g=hc(0);for(let j=0;j<p;j++)g+=De.EXP900[p-j-1]*hc(m[j]);let N=g.toString();if(N.charAt(0)!=="1")throw new D;return N.substring(1)}}De.TEXT_COMPACTION_MODE_LATCH=900,De.BYTE_COMPACTION_MODE_LATCH=901,De.NUMERIC_COMPACTION_MODE_LATCH=902,De.BYTE_COMPACTION_MODE_LATCH_6=924,De.ECI_USER_DEFINED=925,De.ECI_GENERAL_PURPOSE=926,De.ECI_CHARSET=927,De.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,De.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,De.MACRO_PDF417_TERMINATOR=922,De.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,De.MAX_NUMERIC_CODEWORDS=15,De.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,De.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,De.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,De.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,De.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,De.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,De.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,De.PL=25,De.LL=27,De.AS=27,De.ML=28,De.AL=28,De.PS=29,De.PAL=29,De.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,De.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",De.EXP900=$E()?cY():[],De.NUMBER_OF_SEQUENCE_CODEWORDS=2;class ts{constructor(){}static decode(m,p,g,N,j,C,E){let R=new Id(m,p,g,N,j),U=null,W=null,Y;for(let be=!0;;be=!1){if(p!=null&&(U=ts.getRowIndicatorColumn(m,R,p,!0,C,E)),N!=null&&(W=ts.getRowIndicatorColumn(m,R,N,!1,C,E)),Y=ts.merge(U,W),Y==null)throw z.getNotFoundInstance();let Ne=Y.getBoundingBox();if(be&&Ne!=null&&(Ne.getMinY()<R.getMinY()||Ne.getMaxY()>R.getMaxY()))R=Ne;else break}Y.setBoundingBox(R);let Z=Y.getBarcodeColumnCount()+1;Y.setDetectionResultColumn(0,U),Y.setDetectionResultColumn(Z,W);let le=U!=null;for(let be=1;be<=Z;be++){let Ne=le?be:Z-be;if(Y.getDetectionResultColumn(Ne)!==void 0)continue;let Ae;Ne===0||Ne===Z?Ae=new RE(R,Ne===0):Ae=new uf(R),Y.setDetectionResultColumn(Ne,Ae);let Oe=-1,et=Oe;for(let st=R.getMinY();st<=R.getMaxY();st++){if(Oe=ts.getStartColumn(Y,Ne,st,le),Oe<0||Oe>R.getMaxX()){if(et===-1)continue;Oe=et}let Ye=ts.detectCodeword(m,R.getMinX(),R.getMaxX(),le,Oe,st,C,E);Ye!=null&&(Ae.setCodeword(st,Ye),et=Oe,C=Math.min(C,Ye.getWidth()),E=Math.max(E,Ye.getWidth()))}}return ts.createDecoderResult(Y)}static merge(m,p){if(m==null&&p==null)return null;let g=ts.getBarcodeMetadata(m,p);if(g==null)return null;let N=Id.merge(ts.adjustBoundingBox(m),ts.adjustBoundingBox(p));return new mf(g,N)}static adjustBoundingBox(m){if(m==null)return null;let p=m.getRowHeights();if(p==null)return null;let g=ts.getMax(p),N=0;for(let E of p)if(N+=g-E,E>0)break;let j=m.getCodewords();for(let E=0;N>0&&j[E]==null;E++)N--;let C=0;for(let E=p.length-1;E>=0&&(C+=g-p[E],!(p[E]>0));E--);for(let E=j.length-1;C>0&&j[E]==null;E--)C--;return m.getBoundingBox().addMissingRows(N,C,m.isLeft())}static getMax(m){let p=-1;for(let g of m)p=Math.max(p,g);return p}static getBarcodeMetadata(m,p){let g;if(m==null||(g=m.getBarcodeMetadata())==null)return p==null?null:p.getBarcodeMetadata();let N;return p==null||(N=p.getBarcodeMetadata())==null?g:g.getColumnCount()!==N.getColumnCount()&&g.getErrorCorrectionLevel()!==N.getErrorCorrectionLevel()&&g.getRowCount()!==N.getRowCount()?null:g}static getRowIndicatorColumn(m,p,g,N,j,C){let E=new RE(p,N);for(let R=0;R<2;R++){let U=R===0?1:-1,W=Math.trunc(Math.trunc(g.getX()));for(let Y=Math.trunc(Math.trunc(g.getY()));Y<=p.getMaxY()&&Y>=p.getMinY();Y+=U){let Z=ts.detectCodeword(m,0,m.getWidth(),N,W,Y,j,C);Z!=null&&(E.setCodeword(Y,Z),N?W=Z.getStartX():W=Z.getEndX())}}return E}static adjustCodewordCount(m,p){let g=p[0][1],N=g.getValue(),j=m.getBarcodeColumnCount()*m.getBarcodeRowCount()-ts.getNumberOfECCodeWords(m.getBarcodeECLevel());if(N.length===0){if(j<1||j>Lt.MAX_CODEWORDS_IN_BARCODE)throw z.getNotFoundInstance();g.setValue(j)}else N[0]!==j&&g.setValue(j)}static createDecoderResult(m){let p=ts.createBarcodeMatrix(m);ts.adjustCodewordCount(m,p);let g=new Array,N=new Int32Array(m.getBarcodeRowCount()*m.getBarcodeColumnCount()),j=[],C=new Array;for(let R=0;R<m.getBarcodeRowCount();R++)for(let U=0;U<m.getBarcodeColumnCount();U++){let W=p[R][U+1].getValue(),Y=R*m.getBarcodeColumnCount()+U;W.length===0?g.push(Y):W.length===1?N[Y]=W[0]:(C.push(Y),j.push(W))}let E=new Array(j.length);for(let R=0;R<E.length;R++)E[R]=j[R];return ts.createDecoderResultFromAmbiguousValues(m.getBarcodeECLevel(),N,Lt.toIntArray(g),Lt.toIntArray(C),E)}static createDecoderResultFromAmbiguousValues(m,p,g,N,j){let C=new Int32Array(N.length),E=100;for(;E-- >0;){for(let R=0;R<C.length;R++)p[N[R]]=j[R][C[R]];try{return ts.decodeCodewords(p,m,g)}catch(R){if(!(R instanceof b))throw R}if(C.length===0)throw b.getChecksumInstance();for(let R=0;R<C.length;R++)if(C[R]<j[R].length-1){C[R]++;break}else if(C[R]=0,R===C.length-1)throw b.getChecksumInstance()}throw b.getChecksumInstance()}static createBarcodeMatrix(m){let p=Array.from({length:m.getBarcodeRowCount()},()=>new Array(m.getBarcodeColumnCount()+2));for(let N=0;N<p.length;N++)for(let j=0;j<p[N].length;j++)p[N][j]=new hf;let g=0;for(let N of m.getDetectionResultColumns()){if(N!=null){for(let j of N.getCodewords())if(j!=null){let C=j.getRowNumber();if(C>=0){if(C>=p.length)continue;p[C][g].setValue(j.getValue())}}}g++}return p}static isValidBarcodeColumn(m,p){return p>=0&&p<=m.getBarcodeColumnCount()+1}static getStartColumn(m,p,g,N){let j=N?1:-1,C=null;if(ts.isValidBarcodeColumn(m,p-j)&&(C=m.getDetectionResultColumn(p-j).getCodeword(g)),C!=null)return N?C.getEndX():C.getStartX();if(C=m.getDetectionResultColumn(p).getCodewordNearby(g),C!=null)return N?C.getStartX():C.getEndX();if(ts.isValidBarcodeColumn(m,p-j)&&(C=m.getDetectionResultColumn(p-j).getCodewordNearby(g)),C!=null)return N?C.getEndX():C.getStartX();let E=0;for(;ts.isValidBarcodeColumn(m,p-j);){p-=j;for(let R of m.getDetectionResultColumn(p).getCodewords())if(R!=null)return(N?R.getEndX():R.getStartX())+j*E*(R.getEndX()-R.getStartX());E++}return N?m.getBoundingBox().getMinX():m.getBoundingBox().getMaxX()}static detectCodeword(m,p,g,N,j,C,E,R){j=ts.adjustCodewordStartColumn(m,p,g,N,j,C);let U=ts.getModuleBitCount(m,p,g,N,j,C);if(U==null)return null;let W,Y=ve.sum(U);if(N)W=j+Y;else{for(let be=0;be<U.length/2;be++){let Ne=U[be];U[be]=U[U.length-1-be],U[U.length-1-be]=Ne}W=j,j=W-Y}if(!ts.checkCodewordSkew(Y,E,R))return null;let Z=ja.getDecodedValue(U),le=Lt.getCodeword(Z);return le===-1?null:new ff(j,W,ts.getCodewordBucketNumber(Z),le)}static getModuleBitCount(m,p,g,N,j,C){let E=j,R=new Int32Array(8),U=0,W=N?1:-1,Y=N;for(;(N?E<g:E>=p)&&U<R.length;)m.get(E,C)===Y?(R[U]++,E+=W):(U++,Y=!Y);return U===R.length||E===(N?g:p)&&U===R.length-1?R:null}static getNumberOfECCodeWords(m){return 2<<m}static adjustCodewordStartColumn(m,p,g,N,j,C){let E=j,R=N?-1:1;for(let U=0;U<2;U++){for(;(N?E>=p:E<g)&&N===m.get(E,C);){if(Math.abs(j-E)>ts.CODEWORD_SKEW_SIZE)return j;E+=R}R=-R,N=!N}return E}static checkCodewordSkew(m,p,g){return p-ts.CODEWORD_SKEW_SIZE<=m&&m<=g+ts.CODEWORD_SKEW_SIZE}static decodeCodewords(m,p,g){if(m.length===0)throw D.getFormatInstance();let N=1<<p+1,j=ts.correctErrors(m,g,N);ts.verifyCodewordCount(m,N);let C=De.decode(m,""+p);return C.setErrorsCorrected(j),C.setErasures(g.length),C}static correctErrors(m,p,g){if(p!=null&&p.length>g/2+ts.MAX_ERRORS||g<0||g>ts.MAX_EC_CODEWORDS)throw b.getChecksumInstance();return ts.errorCorrection.decode(m,g,p)}static verifyCodewordCount(m,p){if(m.length<4)throw D.getFormatInstance();let g=m[0];if(g>m.length)throw D.getFormatInstance();if(g===0)if(p<m.length)m[0]=m.length-p;else throw D.getFormatInstance()}static getBitCountForCodeword(m){let p=new Int32Array(8),g=0,N=p.length-1;for(;!((m&1)!==g&&(g=m&1,N--,N<0));)p[N]++,m>>=1;return p}static getCodewordBucketNumber(m){return m instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(m):this.getCodewordBucketNumber_number(m)}static getCodewordBucketNumber_number(m){return ts.getCodewordBucketNumber(ts.getBitCountForCodeword(m))}static getCodewordBucketNumber_Int32Array(m){return(m[0]-m[2]+m[4]-m[6]+9)%9}static toString(m){let p=new df;for(let g=0;g<m.length;g++){p.format("Row %2d: ",g);for(let N=0;N<m[g].length;N++){let j=m[g][N];j.getValue().length===0?p.format("        ",null):p.format("%4d(%2d)",j.getValue()[0],j.getConfidence(j.getValue()[0]))}p.format("%n")}return p.toString()}}ts.CODEWORD_SKEW_SIZE=2,ts.MAX_ERRORS=3,ts.MAX_EC_CODEWORDS=512,ts.errorCorrection=new OE;class kr{decode(m,p=null){let g=kr.decode(m,p,!1);if(g==null||g.length===0||g[0]==null)throw z.getNotFoundInstance();return g[0]}decodeMultiple(m,p=null){try{return kr.decode(m,p,!0)}catch(g){throw g instanceof D||g instanceof b?z.getNotFoundInstance():g}}static decode(m,p,g){const N=new Array,j=Ke.detectMultiple(m,p,g);for(const C of j.getPoints()){const E=ts.decode(j.getBits(),C[4],C[5],C[6],C[7],kr.getMinCodewordWidth(C),kr.getMaxCodewordWidth(C)),R=new ce(E.getText(),E.getRawBytes(),void 0,C,X.PDF_417);R.putMetadata(Ce.ERROR_CORRECTION_LEVEL,E.getECLevel());const U=E.getOther();U!=null&&R.putMetadata(Ce.PDF417_EXTRA_METADATA,U),N.push(R)}return N.map(C=>C)}static getMaxWidth(m,p){return m==null||p==null?0:Math.trunc(Math.abs(m.getX()-p.getX()))}static getMinWidth(m,p){return m==null||p==null?A.MAX_VALUE:Math.trunc(Math.abs(m.getX()-p.getX()))}static getMaxCodewordWidth(m){return Math.floor(Math.max(Math.max(kr.getMaxWidth(m[0],m[4]),kr.getMaxWidth(m[6],m[2])*Lt.MODULES_IN_CODEWORD/Lt.MODULES_IN_STOP_PATTERN),Math.max(kr.getMaxWidth(m[1],m[5]),kr.getMaxWidth(m[7],m[3])*Lt.MODULES_IN_CODEWORD/Lt.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(m){return Math.floor(Math.min(Math.min(kr.getMinWidth(m[0],m[4]),kr.getMinWidth(m[6],m[2])*Lt.MODULES_IN_CODEWORD/Lt.MODULES_IN_STOP_PATTERN),Math.min(kr.getMinWidth(m[1],m[5]),kr.getMinWidth(m[7],m[3])*Lt.MODULES_IN_CODEWORD/Lt.MODULES_IN_STOP_PATTERN)))}reset(){}}class v0 extends u{}v0.kind="ReaderException";class zE{constructor(m,p){this.verbose=m===!0,p&&this.setHints(p)}decode(m,p){return p&&this.setHints(p),this.decodeInternal(m)}decodeWithState(m){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(m)}setHints(m){this.hints=m;const p=!a(m)&&m.get(O.TRY_HARDER)===!0,g=a(m)?null:m.get(O.POSSIBLE_FORMATS),N=new Array;if(!a(g)){const j=g.some(C=>C===X.UPC_A||C===X.UPC_E||C===X.EAN_13||C===X.EAN_8||C===X.CODABAR||C===X.CODE_39||C===X.CODE_93||C===X.CODE_128||C===X.ITF||C===X.RSS_14||C===X.RSS_EXPANDED);j&&!p&&N.push(new Fn(m,this.verbose)),g.includes(X.QR_CODE)&&N.push(new tl),g.includes(X.DATA_MATRIX)&&N.push(new Q),g.includes(X.AZTEC)&&N.push(new he),g.includes(X.PDF_417)&&N.push(new kr),j&&p&&N.push(new Fn(m,this.verbose))}N.length===0&&(p||N.push(new Fn(m,this.verbose)),N.push(new tl),N.push(new Q),N.push(new he),N.push(new kr),p&&N.push(new Fn(m,this.verbose))),this.readers=N}reset(){if(this.readers!==null)for(const m of this.readers)m.reset()}decodeInternal(m){if(this.readers===null)throw new v0("No readers where selected, nothing can be read.");for(const p of this.readers)try{return p.decode(m,this.hints)}catch(g){if(g instanceof v0)continue}throw new z("No MultiFormat Readers were able to detect the code.")}}class dY extends te{constructor(m=null,p=500){const g=new zE;g.setHints(m),super(g,p)}decodeBitmap(m){return this.reader.decodeWithState(m)}}class uY extends te{constructor(m=500){super(new kr,m)}}class hY extends te{constructor(m=500){super(new tl,m)}}var HN;(function(K){K[K.ERROR_CORRECTION=0]="ERROR_CORRECTION",K[K.CHARACTER_SET=1]="CHARACTER_SET",K[K.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",K[K.MIN_SIZE=3]="MIN_SIZE",K[K.MAX_SIZE=4]="MAX_SIZE",K[K.MARGIN=5]="MARGIN",K[K.PDF417_COMPACT=6]="PDF417_COMPACT",K[K.PDF417_COMPACTION=7]="PDF417_COMPACTION",K[K.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",K[K.AZTEC_LAYERS=9]="AZTEC_LAYERS",K[K.QR_VERSION=10]="QR_VERSION"})(HN||(HN={}));var Qn=HN;class WN{constructor(m){this.field=m,this.cachedGenerators=[],this.cachedGenerators.push(new pe(m,Int32Array.from([1])))}buildGenerator(m){const p=this.cachedGenerators;if(m>=p.length){let g=p[p.length-1];const N=this.field;for(let j=p.length;j<=m;j++){const C=g.multiply(new pe(N,Int32Array.from([1,N.exp(j-1+N.getGeneratorBase())])));p.push(C),g=C}}return p[m]}encode(m,p){if(p===0)throw new f("No error correction bytes");const g=m.length-p;if(g<=0)throw new f("No data bytes provided");const N=this.buildGenerator(p),j=new Int32Array(g);w.arraycopy(m,0,j,0,g);let C=new pe(this.field,j);C=C.multiplyByMonomial(p,1);const R=C.divide(N)[1].getCoefficients(),U=p-R.length;for(let W=0;W<U;W++)m[g+W]=0;w.arraycopy(R,0,m,g+U,R.length)}}class vn{constructor(){}static applyMaskPenaltyRule1(m){return vn.applyMaskPenaltyRule1Internal(m,!0)+vn.applyMaskPenaltyRule1Internal(m,!1)}static applyMaskPenaltyRule2(m){let p=0;const g=m.getArray(),N=m.getWidth(),j=m.getHeight();for(let C=0;C<j-1;C++){const E=g[C];for(let R=0;R<N-1;R++){const U=E[R];U===E[R+1]&&U===g[C+1][R]&&U===g[C+1][R+1]&&p++}}return vn.N2*p}static applyMaskPenaltyRule3(m){let p=0;const g=m.getArray(),N=m.getWidth(),j=m.getHeight();for(let C=0;C<j;C++)for(let E=0;E<N;E++){const R=g[C];E+6<N&&R[E]===1&&R[E+1]===0&&R[E+2]===1&&R[E+3]===1&&R[E+4]===1&&R[E+5]===0&&R[E+6]===1&&(vn.isWhiteHorizontal(R,E-4,E)||vn.isWhiteHorizontal(R,E+7,E+11))&&p++,C+6<j&&g[C][E]===1&&g[C+1][E]===0&&g[C+2][E]===1&&g[C+3][E]===1&&g[C+4][E]===1&&g[C+5][E]===0&&g[C+6][E]===1&&(vn.isWhiteVertical(g,E,C-4,C)||vn.isWhiteVertical(g,E,C+7,C+11))&&p++}return p*vn.N3}static isWhiteHorizontal(m,p,g){p=Math.max(p,0),g=Math.min(g,m.length);for(let N=p;N<g;N++)if(m[N]===1)return!1;return!0}static isWhiteVertical(m,p,g,N){g=Math.max(g,0),N=Math.min(N,m.length);for(let j=g;j<N;j++)if(m[j][p]===1)return!1;return!0}static applyMaskPenaltyRule4(m){let p=0;const g=m.getArray(),N=m.getWidth(),j=m.getHeight();for(let R=0;R<j;R++){const U=g[R];for(let W=0;W<N;W++)U[W]===1&&p++}const C=m.getHeight()*m.getWidth();return Math.floor(Math.abs(p*2-C)*10/C)*vn.N4}static getDataMaskBit(m,p,g){let N,j;switch(m){case 0:N=g+p&1;break;case 1:N=g&1;break;case 2:N=p%3;break;case 3:N=(g+p)%3;break;case 4:N=Math.floor(g/2)+Math.floor(p/3)&1;break;case 5:j=g*p,N=(j&1)+j%3;break;case 6:j=g*p,N=(j&1)+j%3&1;break;case 7:j=g*p,N=j%3+(g+p&1)&1;break;default:throw new f("Invalid mask pattern: "+m)}return N===0}static applyMaskPenaltyRule1Internal(m,p){let g=0;const N=p?m.getHeight():m.getWidth(),j=p?m.getWidth():m.getHeight(),C=m.getArray();for(let E=0;E<N;E++){let R=0,U=-1;for(let W=0;W<j;W++){const Y=p?C[E][W]:C[W][E];Y===U?R++:(R>=5&&(g+=vn.N1+(R-5)),R=1,U=Y)}R>=5&&(g+=vn.N1+(R-5))}return g}}vn.N1=3,vn.N2=3,vn.N3=40,vn.N4=10;class N0{constructor(m,p){this.width=m,this.height=p;const g=new Array(p);for(let N=0;N!==p;N++)g[N]=new Uint8Array(m);this.bytes=g}getHeight(){return this.height}getWidth(){return this.width}get(m,p){return this.bytes[p][m]}getArray(){return this.bytes}setNumber(m,p,g){this.bytes[p][m]=g}setBoolean(m,p,g){this.bytes[p][m]=g?1:0}clear(m){for(const p of this.bytes)k.fill(p,m)}equals(m){if(!(m instanceof N0))return!1;const p=m;if(this.width!==p.width||this.height!==p.height)return!1;for(let g=0,N=this.height;g<N;++g){const j=this.bytes[g],C=p.bytes[g];for(let E=0,R=this.width;E<R;++E)if(j[E]!==C[E])return!1}return!0}toString(){const m=new V;for(let p=0,g=this.height;p<g;++p){const N=this.bytes[p];for(let j=0,C=this.width;j<C;++j)switch(N[j]){case 0:m.append(" 0");break;case 1:m.append(" 1");break;default:m.append("  ");break}m.append(`
`)}return m.toString()}}class Md{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const m=new V;return m.append(`<<
`),m.append(" mode: "),m.append(this.mode?this.mode.toString():"null"),m.append(`
 ecLevel: `),m.append(this.ecLevel?this.ecLevel.toString():"null"),m.append(`
 version: `),m.append(this.version?this.version.toString():"null"),m.append(`
 maskPattern: `),m.append(this.maskPattern.toString()),this.matrix?(m.append(`
 matrix:
`),m.append(this.matrix.toString())):m.append(`
 matrix: null
`),m.append(`>>
`),m.toString()}setMode(m){this.mode=m}setECLevel(m){this.ecLevel=m}setVersion(m){this.version=m}setMaskPattern(m){this.maskPattern=m}setMatrix(m){this.matrix=m}static isValidMaskPattern(m){return m>=0&&m<Md.NUM_MASK_PATTERNS}}Md.NUM_MASK_PATTERNS=8;class Is extends u{}Is.kind="WriterException";class $t{constructor(){}static clearMatrix(m){m.clear(255)}static buildMatrix(m,p,g,N,j){$t.clearMatrix(j),$t.embedBasicPatterns(g,j),$t.embedTypeInfo(p,N,j),$t.maybeEmbedVersionInfo(g,j),$t.embedDataBits(m,N,j)}static embedBasicPatterns(m,p){$t.embedPositionDetectionPatternsAndSeparators(p),$t.embedDarkDotAtLeftBottomCorner(p),$t.maybeEmbedPositionAdjustmentPatterns(m,p),$t.embedTimingPatterns(p)}static embedTypeInfo(m,p,g){const N=new T;$t.makeTypeInfoBits(m,p,N);for(let j=0,C=N.getSize();j<C;++j){const E=N.get(N.getSize()-1-j),R=$t.TYPE_INFO_COORDINATES[j],U=R[0],W=R[1];if(g.setBoolean(U,W,E),j<8){const Y=g.getWidth()-j-1;g.setBoolean(Y,8,E)}else{const Z=g.getHeight()-7+(j-8);g.setBoolean(8,Z,E)}}}static maybeEmbedVersionInfo(m,p){if(m.getVersionNumber()<7)return;const g=new T;$t.makeVersionInfoBits(m,g);let N=6*3-1;for(let j=0;j<6;++j)for(let C=0;C<3;++C){const E=g.get(N);N--,p.setBoolean(j,p.getHeight()-11+C,E),p.setBoolean(p.getHeight()-11+C,j,E)}}static embedDataBits(m,p,g){let N=0,j=-1,C=g.getWidth()-1,E=g.getHeight()-1;for(;C>0;){for(C===6&&(C-=1);E>=0&&E<g.getHeight();){for(let R=0;R<2;++R){const U=C-R;if(!$t.isEmpty(g.get(U,E)))continue;let W;N<m.getSize()?(W=m.get(N),++N):W=!1,p!==255&&vn.getDataMaskBit(p,U,E)&&(W=!W),g.setBoolean(U,E,W)}E+=j}j=-j,E+=j,C-=2}if(N!==m.getSize())throw new Is("Not all bits consumed: "+N+"/"+m.getSize())}static findMSBSet(m){return 32-A.numberOfLeadingZeros(m)}static calculateBCHCode(m,p){if(p===0)throw new f("0 polynomial");const g=$t.findMSBSet(p);for(m<<=g-1;$t.findMSBSet(m)>=g;)m^=p<<$t.findMSBSet(m)-g;return m}static makeTypeInfoBits(m,p,g){if(!Md.isValidMaskPattern(p))throw new Is("Invalid mask pattern");const N=m.getBits()<<3|p;g.appendBits(N,5);const j=$t.calculateBCHCode(N,$t.TYPE_INFO_POLY);g.appendBits(j,10);const C=new T;if(C.appendBits($t.TYPE_INFO_MASK_PATTERN,15),g.xor(C),g.getSize()!==15)throw new Is("should not happen but we got: "+g.getSize())}static makeVersionInfoBits(m,p){p.appendBits(m.getVersionNumber(),6);const g=$t.calculateBCHCode(m.getVersionNumber(),$t.VERSION_INFO_POLY);if(p.appendBits(g,12),p.getSize()!==18)throw new Is("should not happen but we got: "+p.getSize())}static isEmpty(m){return m===255}static embedTimingPatterns(m){for(let p=8;p<m.getWidth()-8;++p){const g=(p+1)%2;$t.isEmpty(m.get(p,6))&&m.setNumber(p,6,g),$t.isEmpty(m.get(6,p))&&m.setNumber(6,p,g)}}static embedDarkDotAtLeftBottomCorner(m){if(m.get(8,m.getHeight()-8)===0)throw new Is;m.setNumber(8,m.getHeight()-8,1)}static embedHorizontalSeparationPattern(m,p,g){for(let N=0;N<8;++N){if(!$t.isEmpty(g.get(m+N,p)))throw new Is;g.setNumber(m+N,p,0)}}static embedVerticalSeparationPattern(m,p,g){for(let N=0;N<7;++N){if(!$t.isEmpty(g.get(m,p+N)))throw new Is;g.setNumber(m,p+N,0)}}static embedPositionAdjustmentPattern(m,p,g){for(let N=0;N<5;++N){const j=$t.POSITION_ADJUSTMENT_PATTERN[N];for(let C=0;C<5;++C)g.setNumber(m+C,p+N,j[C])}}static embedPositionDetectionPattern(m,p,g){for(let N=0;N<7;++N){const j=$t.POSITION_DETECTION_PATTERN[N];for(let C=0;C<7;++C)g.setNumber(m+C,p+N,j[C])}}static embedPositionDetectionPatternsAndSeparators(m){const p=$t.POSITION_DETECTION_PATTERN[0].length;$t.embedPositionDetectionPattern(0,0,m),$t.embedPositionDetectionPattern(m.getWidth()-p,0,m),$t.embedPositionDetectionPattern(0,m.getWidth()-p,m);const g=8;$t.embedHorizontalSeparationPattern(0,g-1,m),$t.embedHorizontalSeparationPattern(m.getWidth()-g,g-1,m),$t.embedHorizontalSeparationPattern(0,m.getWidth()-g,m);const N=7;$t.embedVerticalSeparationPattern(N,0,m),$t.embedVerticalSeparationPattern(m.getHeight()-N-1,0,m),$t.embedVerticalSeparationPattern(N,m.getHeight()-N,m)}static maybeEmbedPositionAdjustmentPatterns(m,p){if(m.getVersionNumber()<2)return;const g=m.getVersionNumber()-1,N=$t.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[g];for(let j=0,C=N.length;j!==C;j++){const E=N[j];if(E>=0)for(let R=0;R!==C;R++){const U=N[R];U>=0&&$t.isEmpty(p.get(U,E))&&$t.embedPositionAdjustmentPattern(U-2,E-2,p)}}}}$t.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),$t.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),$t.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),$t.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),$t.VERSION_INFO_POLY=7973,$t.TYPE_INFO_POLY=1335,$t.TYPE_INFO_MASK_PATTERN=21522;class mY{constructor(m,p){this.dataBytes=m,this.errorCorrectionBytes=p}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class qs{constructor(){}static calculateMaskPenalty(m){return vn.applyMaskPenaltyRule1(m)+vn.applyMaskPenaltyRule2(m)+vn.applyMaskPenaltyRule3(m)+vn.applyMaskPenaltyRule4(m)}static encode(m,p,g=null){let N=qs.DEFAULT_BYTE_MODE_ENCODING;const j=g!==null&&g.get(Qn.CHARACTER_SET)!==void 0;j&&(N=g.get(Qn.CHARACTER_SET).toString());const C=this.chooseMode(m,N),E=new T;if(C===Tt.BYTE&&(j||qs.DEFAULT_BYTE_MODE_ENCODING!==N)){const st=M.getCharacterSetECIByName(N);st!==void 0&&this.appendECI(st,E)}this.appendModeInfo(C,E);const R=new T;this.appendBytes(m,C,R,N);let U;if(g!==null&&g.get(Qn.QR_VERSION)!==void 0){const st=Number.parseInt(g.get(Qn.QR_VERSION).toString(),10);U=At.getVersionForNumber(st);const Ye=this.calculateBitsNeeded(C,E,R,U);if(!this.willFit(Ye,U,p))throw new Is("Data too big for requested version")}else U=this.recommendVersion(p,C,E,R);const W=new T;W.appendBitArray(E);const Y=C===Tt.BYTE?R.getSizeInBytes():m.length;this.appendLengthInfo(Y,U,C,W),W.appendBitArray(R);const Z=U.getECBlocksForLevel(p),le=U.getTotalCodewords()-Z.getTotalECCodewords();this.terminateBits(le,W);const be=this.interleaveWithECBytes(W,U.getTotalCodewords(),le,Z.getNumBlocks()),Ne=new Md;Ne.setECLevel(p),Ne.setMode(C),Ne.setVersion(U);const Ae=U.getDimensionForVersion(),Oe=new N0(Ae,Ae),et=this.chooseMaskPattern(be,p,U,Oe);return Ne.setMaskPattern(et),$t.buildMatrix(be,p,U,et,Oe),Ne.setMatrix(Oe),Ne}static recommendVersion(m,p,g,N){const j=this.calculateBitsNeeded(p,g,N,At.getVersionForNumber(1)),C=this.chooseVersion(j,m),E=this.calculateBitsNeeded(p,g,N,C);return this.chooseVersion(E,m)}static calculateBitsNeeded(m,p,g,N){return p.getSize()+m.getCharacterCountBits(N)+g.getSize()}static getAlphanumericCode(m){return m<qs.ALPHANUMERIC_TABLE.length?qs.ALPHANUMERIC_TABLE[m]:-1}static chooseMode(m,p=null){if(M.SJIS.getName()===p&&this.isOnlyDoubleByteKanji(m))return Tt.KANJI;let g=!1,N=!1;for(let j=0,C=m.length;j<C;++j){const E=m.charAt(j);if(qs.isDigit(E))g=!0;else if(this.getAlphanumericCode(E.charCodeAt(0))!==-1)N=!0;else return Tt.BYTE}return N?Tt.ALPHANUMERIC:g?Tt.NUMERIC:Tt.BYTE}static isOnlyDoubleByteKanji(m){let p;try{p=L.encode(m,M.SJIS)}catch{return!1}const g=p.length;if(g%2!==0)return!1;for(let N=0;N<g;N+=2){const j=p[N]&255;if((j<129||j>159)&&(j<224||j>235))return!1}return!0}static chooseMaskPattern(m,p,g,N){let j=Number.MAX_SAFE_INTEGER,C=-1;for(let E=0;E<Md.NUM_MASK_PATTERNS;E++){$t.buildMatrix(m,p,g,E,N);let R=this.calculateMaskPenalty(N);R<j&&(j=R,C=E)}return C}static chooseVersion(m,p){for(let g=1;g<=40;g++){const N=At.getVersionForNumber(g);if(qs.willFit(m,N,p))return N}throw new Is("Data too big")}static willFit(m,p,g){const N=p.getTotalCodewords(),C=p.getECBlocksForLevel(g).getTotalECCodewords(),E=N-C,R=(m+7)/8;return E>=R}static terminateBits(m,p){const g=m*8;if(p.getSize()>g)throw new Is("data bits cannot fit in the QR Code"+p.getSize()+" > "+g);for(let C=0;C<4&&p.getSize()<g;++C)p.appendBit(!1);const N=p.getSize()&7;if(N>0)for(let C=N;C<8;C++)p.appendBit(!1);const j=m-p.getSizeInBytes();for(let C=0;C<j;++C)p.appendBits(C&1?17:236,8);if(p.getSize()!==g)throw new Is("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(m,p,g,N,j,C){if(N>=g)throw new Is("Block ID too large");const E=m%g,R=g-E,U=Math.floor(m/g),W=U+1,Y=Math.floor(p/g),Z=Y+1,le=U-Y,be=W-Z;if(le!==be)throw new Is("EC bytes mismatch");if(g!==R+E)throw new Is("RS blocks mismatch");if(m!==(Y+le)*R+(Z+be)*E)throw new Is("Total bytes mismatch");N<R?(j[0]=Y,C[0]=le):(j[0]=Z,C[0]=be)}static interleaveWithECBytes(m,p,g,N){if(m.getSizeInBytes()!==g)throw new Is("Number of bits and data bytes does not match");let j=0,C=0,E=0;const R=new Array;for(let W=0;W<N;++W){const Y=new Int32Array(1),Z=new Int32Array(1);qs.getNumDataBytesAndNumECBytesForBlockID(p,g,N,W,Y,Z);const le=Y[0],be=new Uint8Array(le);m.toBytes(8*j,be,0,le);const Ne=qs.generateECBytes(be,Z[0]);R.push(new mY(be,Ne)),C=Math.max(C,le),E=Math.max(E,Ne.length),j+=Y[0]}if(g!==j)throw new Is("Data bytes does not match offset");const U=new T;for(let W=0;W<C;++W)for(const Y of R){const Z=Y.getDataBytes();W<Z.length&&U.appendBits(Z[W],8)}for(let W=0;W<E;++W)for(const Y of R){const Z=Y.getErrorCorrectionBytes();W<Z.length&&U.appendBits(Z[W],8)}if(p!==U.getSizeInBytes())throw new Is("Interleaving error: "+p+" and "+U.getSizeInBytes()+" differ.");return U}static generateECBytes(m,p){const g=m.length,N=new Int32Array(g+p);for(let C=0;C<g;C++)N[C]=m[C]&255;new WN(qe.QR_CODE_FIELD_256).encode(N,p);const j=new Uint8Array(p);for(let C=0;C<p;C++)j[C]=N[g+C];return j}static appendModeInfo(m,p){p.appendBits(m.getBits(),4)}static appendLengthInfo(m,p,g,N){const j=g.getCharacterCountBits(p);if(m>=1<<j)throw new Is(m+" is bigger than "+((1<<j)-1));N.appendBits(m,j)}static appendBytes(m,p,g,N){switch(p){case Tt.NUMERIC:qs.appendNumericBytes(m,g);break;case Tt.ALPHANUMERIC:qs.appendAlphanumericBytes(m,g);break;case Tt.BYTE:qs.append8BitBytes(m,g,N);break;case Tt.KANJI:qs.appendKanjiBytes(m,g);break;default:throw new Is("Invalid mode: "+p)}}static getDigit(m){return m.charCodeAt(0)-48}static isDigit(m){const p=qs.getDigit(m);return p>=0&&p<=9}static appendNumericBytes(m,p){const g=m.length;let N=0;for(;N<g;){const j=qs.getDigit(m.charAt(N));if(N+2<g){const C=qs.getDigit(m.charAt(N+1)),E=qs.getDigit(m.charAt(N+2));p.appendBits(j*100+C*10+E,10),N+=3}else if(N+1<g){const C=qs.getDigit(m.charAt(N+1));p.appendBits(j*10+C,7),N+=2}else p.appendBits(j,4),N++}}static appendAlphanumericBytes(m,p){const g=m.length;let N=0;for(;N<g;){const j=qs.getAlphanumericCode(m.charCodeAt(N));if(j===-1)throw new Is;if(N+1<g){const C=qs.getAlphanumericCode(m.charCodeAt(N+1));if(C===-1)throw new Is;p.appendBits(j*45+C,11),N+=2}else p.appendBits(j,6),N++}}static append8BitBytes(m,p,g){let N;try{N=L.encode(m,g)}catch(j){throw new Is(j)}for(let j=0,C=N.length;j!==C;j++){const E=N[j];p.appendBits(E,8)}}static appendKanjiBytes(m,p){let g;try{g=L.encode(m,M.SJIS)}catch(j){throw new Is(j)}const N=g.length;for(let j=0;j<N;j+=2){const C=g[j]&255,E=g[j+1]&255,R=C<<8&4294967295|E;let U=-1;if(R>=33088&&R<=40956?U=R-33088:R>=57408&&R<=60351&&(U=R-49472),U===-1)throw new Is("Invalid byte sequence");const W=(U>>8)*192+(U&255);p.appendBits(W,13)}}static appendECI(m,p){p.appendBits(Tt.ECI.getBits(),4),p.appendBits(m.getValue(),8)}}qs.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),qs.DEFAULT_BYTE_MODE_ENCODING=M.UTF8.getName();class Dd{write(m,p,g,N=null){if(m.length===0)throw new f("Found empty contents");if(p<0||g<0)throw new f("Requested dimensions are too small: "+p+"x"+g);let j=mt.L,C=Dd.QUIET_ZONE_SIZE;N!==null&&(N.get(Qn.ERROR_CORRECTION)!==void 0&&(j=mt.fromString(N.get(Qn.ERROR_CORRECTION).toString())),N.get(Qn.MARGIN)!==void 0&&(C=Number.parseInt(N.get(Qn.MARGIN).toString(),10)));const E=qs.encode(m,j,N);return this.renderResult(E,p,g,C)}writeToDom(m,p,g,N,j=null){typeof m=="string"&&(m=document.querySelector(m));const C=this.write(p,g,N,j);m&&m.appendChild(C)}renderResult(m,p,g,N){const j=m.getMatrix();if(j===null)throw new jt;const C=j.getWidth(),E=j.getHeight(),R=C+N*2,U=E+N*2,W=Math.max(p,R),Y=Math.max(g,U),Z=Math.min(Math.floor(W/R),Math.floor(Y/U)),le=Math.floor((W-C*Z)/2),be=Math.floor((Y-E*Z)/2),Ne=this.createSVGElement(W,Y);for(let Ae=0,Oe=be;Ae<E;Ae++,Oe+=Z)for(let et=0,st=le;et<C;et++,st+=Z)if(j.get(et,Ae)===1){const Ye=this.createSvgRectElement(st,Oe,Z,Z);Ne.appendChild(Ye)}return Ne}createSVGElement(m,p){const g=document.createElementNS(Dd.SVG_NS,"svg");return g.setAttributeNS(null,"height",m.toString()),g.setAttributeNS(null,"width",p.toString()),g}createSvgRectElement(m,p,g,N){const j=document.createElementNS(Dd.SVG_NS,"rect");return j.setAttributeNS(null,"x",m.toString()),j.setAttributeNS(null,"y",p.toString()),j.setAttributeNS(null,"height",g.toString()),j.setAttributeNS(null,"width",N.toString()),j.setAttributeNS(null,"fill","#000000"),j}}Dd.QUIET_ZONE_SIZE=4,Dd.SVG_NS="http://www.w3.org/2000/svg";class sh{encode(m,p,g,N,j){if(m.length===0)throw new f("Found empty contents");if(p!==X.QR_CODE)throw new f("Can only encode QR_CODE, but got "+p);if(g<0||N<0)throw new f(`Requested dimensions are too small: ${g}x${N}`);let C=mt.L,E=sh.QUIET_ZONE_SIZE;j!==null&&(j.get(Qn.ERROR_CORRECTION)!==void 0&&(C=mt.fromString(j.get(Qn.ERROR_CORRECTION).toString())),j.get(Qn.MARGIN)!==void 0&&(E=Number.parseInt(j.get(Qn.MARGIN).toString(),10)));const R=qs.encode(m,C,j);return sh.renderResult(R,g,N,E)}static renderResult(m,p,g,N){const j=m.getMatrix();if(j===null)throw new jt;const C=j.getWidth(),E=j.getHeight(),R=C+N*2,U=E+N*2,W=Math.max(p,R),Y=Math.max(g,U),Z=Math.min(Math.floor(W/R),Math.floor(Y/U)),le=Math.floor((W-C*Z)/2),be=Math.floor((Y-E*Z)/2),Ne=new $(W,Y);for(let Ae=0,Oe=be;Ae<E;Ae++,Oe+=Z)for(let et=0,st=le;et<C;et++,st+=Z)j.get(et,Ae)===1&&Ne.setRegion(st,Oe,Z,Z);return Ne}}sh.QUIET_ZONE_SIZE=4;class fY{encode(m,p,g,N,j){let C;switch(p){case X.QR_CODE:C=new sh;break;default:throw new f("No encoder available for format "+p)}return C.encode(m,p,g,N,j)}}class Dl extends G{constructor(m,p,g,N,j,C,E,R){if(super(C,E),this.yuvData=m,this.dataWidth=p,this.dataHeight=g,this.left=N,this.top=j,N+C>p||j+E>g)throw new f("Crop rectangle does not fit within image data.");R&&this.reverseHorizontal(C,E)}getRow(m,p){if(m<0||m>=this.getHeight())throw new f("Requested row is outside the image: "+m);const g=this.getWidth();(p==null||p.length<g)&&(p=new Uint8ClampedArray(g));const N=(m+this.top)*this.dataWidth+this.left;return w.arraycopy(this.yuvData,N,p,0,g),p}getMatrix(){const m=this.getWidth(),p=this.getHeight();if(m===this.dataWidth&&p===this.dataHeight)return this.yuvData;const g=m*p,N=new Uint8ClampedArray(g);let j=this.top*this.dataWidth+this.left;if(m===this.dataWidth)return w.arraycopy(this.yuvData,j,N,0,g),N;for(let C=0;C<p;C++){const E=C*m;w.arraycopy(this.yuvData,j,N,E,m),j+=this.dataWidth}return N}isCropSupported(){return!0}crop(m,p,g,N){return new Dl(this.yuvData,this.dataWidth,this.dataHeight,this.left+m,this.top+p,g,N,!1)}renderThumbnail(){const m=this.getWidth()/Dl.THUMBNAIL_SCALE_FACTOR,p=this.getHeight()/Dl.THUMBNAIL_SCALE_FACTOR,g=new Int32Array(m*p),N=this.yuvData;let j=this.top*this.dataWidth+this.left;for(let C=0;C<p;C++){const E=C*m;for(let R=0;R<m;R++){const U=N[j+R*Dl.THUMBNAIL_SCALE_FACTOR]&255;g[E+R]=4278190080|U*65793}j+=this.dataWidth*Dl.THUMBNAIL_SCALE_FACTOR}return g}getThumbnailWidth(){return this.getWidth()/Dl.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Dl.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(m,p){const g=this.yuvData;for(let N=0,j=this.top*this.dataWidth+this.left;N<p;N++,j+=this.dataWidth){const C=j+m/2;for(let E=j,R=j+m-1;E<C;E++,R--){const U=g[E];g[E]=g[R],g[R]=U}}}invert(){return new re(this)}}Dl.THUMBNAIL_SCALE_FACTOR=2;class qN extends G{constructor(m,p,g,N,j,C,E){if(super(p,g),this.dataWidth=N,this.dataHeight=j,this.left=C,this.top=E,m.BYTES_PER_ELEMENT===4){const R=p*g,U=new Uint8ClampedArray(R);for(let W=0;W<R;W++){const Y=m[W],Z=Y>>16&255,le=Y>>7&510,be=Y&255;U[W]=(Z+le+be)/4&255}this.luminances=U}else this.luminances=m;if(N===void 0&&(this.dataWidth=p),j===void 0&&(this.dataHeight=g),C===void 0&&(this.left=0),E===void 0&&(this.top=0),this.left+p>this.dataWidth||this.top+g>this.dataHeight)throw new f("Crop rectangle does not fit within image data.")}getRow(m,p){if(m<0||m>=this.getHeight())throw new f("Requested row is outside the image: "+m);const g=this.getWidth();(p==null||p.length<g)&&(p=new Uint8ClampedArray(g));const N=(m+this.top)*this.dataWidth+this.left;return w.arraycopy(this.luminances,N,p,0,g),p}getMatrix(){const m=this.getWidth(),p=this.getHeight();if(m===this.dataWidth&&p===this.dataHeight)return this.luminances;const g=m*p,N=new Uint8ClampedArray(g);let j=this.top*this.dataWidth+this.left;if(m===this.dataWidth)return w.arraycopy(this.luminances,j,N,0,g),N;for(let C=0;C<p;C++){const E=C*m;w.arraycopy(this.luminances,j,N,E,m),j+=this.dataWidth}return N}isCropSupported(){return!0}crop(m,p,g,N){return new qN(this.luminances,g,N,this.dataWidth,this.dataHeight,this.left+m,this.top+p)}invert(){return new re(this)}}class UE extends M{static forName(m){return this.getCharacterSetECIByName(m)}}class GN{}GN.ISO_8859_1=M.ISO8859_1;class VE{isCompact(){return this.compact}setCompact(m){this.compact=m}getSize(){return this.size}setSize(m){this.size=m}getLayers(){return this.layers}setLayers(m){this.layers=m}getCodeWords(){return this.codeWords}setCodeWords(m){this.codeWords=m}getMatrix(){return this.matrix}setMatrix(m){this.matrix=m}}class HE{static singletonList(m){return[m]}static min(m,p){return m.sort(p)[0]}}class pY{constructor(m){this.previous=m}getPrevious(){return this.previous}}class nh extends pY{constructor(m,p,g){super(m),this.value=p,this.bitCount=g}appendTo(m,p){m.appendBits(this.value,this.bitCount)}add(m,p){return new nh(this,m,p)}addBinaryShift(m,p){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new nh(this,m,p)}toString(){let m=this.value&(1<<this.bitCount)-1;return m|=1<<this.bitCount,"<"+A.toBinaryString(m|1<<this.bitCount).substring(1)+">"}}class KN extends nh{constructor(m,p,g){super(m,0,0),this.binaryShiftStart=p,this.binaryShiftByteCount=g}appendTo(m,p){for(let g=0;g<this.binaryShiftByteCount;g++)(g===0||g===31&&this.binaryShiftByteCount<=62)&&(m.appendBits(31,5),this.binaryShiftByteCount>62?m.appendBits(this.binaryShiftByteCount-31,16):g===0?m.appendBits(Math.min(this.binaryShiftByteCount,31),5):m.appendBits(this.binaryShiftByteCount-31,5)),m.appendBits(p[this.binaryShiftStart+g],8)}addBinaryShift(m,p){return new KN(this,m,p)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function xY(K,m,p){return new KN(K,m,p)}function pf(K,m,p){return new nh(K,m,p)}const gY=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],mc=0,w0=1,wi=2,WE=3,Ol=4,yY=new nh(null,0,0),YN=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function bY(K){for(let m of K)k.fill(m,-1);return K[mc][Ol]=0,K[w0][Ol]=0,K[w0][mc]=28,K[WE][Ol]=0,K[wi][Ol]=0,K[wi][mc]=15,K}const qE=bY(k.createInt32Array(6,6));class Rl{constructor(m,p,g,N){this.token=m,this.mode=p,this.binaryShiftByteCount=g,this.bitCount=N}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(m,p){let g=this.bitCount,N=this.token;if(m!==this.mode){let C=YN[this.mode][m];N=pf(N,C&65535,C>>16),g+=C>>16}let j=m===wi?4:5;return N=pf(N,p,j),new Rl(N,m,0,g+j)}shiftAndAppend(m,p){let g=this.token,N=this.mode===wi?4:5;return g=pf(g,qE[this.mode][m],N),g=pf(g,p,5),new Rl(g,this.mode,0,this.bitCount+N+5)}addBinaryShiftChar(m){let p=this.token,g=this.mode,N=this.bitCount;if(this.mode===Ol||this.mode===wi){let E=YN[g][mc];p=pf(p,E&65535,E>>16),N+=E>>16,g=mc}let j=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,C=new Rl(p,g,this.binaryShiftByteCount+1,N+j);return C.binaryShiftByteCount===2078&&(C=C.endBinaryShift(m+1)),C}endBinaryShift(m){if(this.binaryShiftByteCount===0)return this;let p=this.token;return p=xY(p,m-this.binaryShiftByteCount,this.binaryShiftByteCount),new Rl(p,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(m){let p=this.bitCount+(YN[this.mode][m.mode]>>16);return this.binaryShiftByteCount<m.binaryShiftByteCount?p+=Rl.calculateBinaryShiftCost(m)-Rl.calculateBinaryShiftCost(this):this.binaryShiftByteCount>m.binaryShiftByteCount&&m.binaryShiftByteCount>0&&(p+=10),p<=m.bitCount}toBitArray(m){let p=[];for(let N=this.endBinaryShift(m.length).token;N!==null;N=N.getPrevious())p.unshift(N);let g=new T;for(const N of p)N.appendTo(g,m);return g}toString(){return F.format("%s bits=%d bytes=%d",gY[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(m){return m.binaryShiftByteCount>62?21:m.binaryShiftByteCount>31?20:m.binaryShiftByteCount>0?10:0}}Rl.INITIAL_STATE=new Rl(yY,mc,0,0);function vY(K){const m=F.getCharCode(" "),p=F.getCharCode("."),g=F.getCharCode(",");K[mc][m]=1;const N=F.getCharCode("Z"),j=F.getCharCode("A");for(let Z=j;Z<=N;Z++)K[mc][Z]=Z-j+2;K[w0][m]=1;const C=F.getCharCode("z"),E=F.getCharCode("a");for(let Z=E;Z<=C;Z++)K[w0][Z]=Z-E+2;K[wi][m]=1;const R=F.getCharCode("9"),U=F.getCharCode("0");for(let Z=U;Z<=R;Z++)K[wi][Z]=Z-U+2;K[wi][g]=12,K[wi][p]=13;const W=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let Z=0;Z<W.length;Z++)K[WE][F.getCharCode(W[Z])]=Z;const Y=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let Z=0;Z<Y.length;Z++)F.getCharCode(Y[Z])>0&&(K[Ol][F.getCharCode(Y[Z])]=Z);return K}const XN=vY(k.createInt32Array(5,256));class xf{constructor(m){this.text=m}encode(){const m=F.getCharCode(" "),p=F.getCharCode(`
`);let g=HE.singletonList(Rl.INITIAL_STATE);for(let j=0;j<this.text.length;j++){let C,E=j+1<this.text.length?this.text[j+1]:0;switch(this.text[j]){case F.getCharCode("\r"):C=E===p?2:0;break;case F.getCharCode("."):C=E===m?3:0;break;case F.getCharCode(","):C=E===m?4:0;break;case F.getCharCode(":"):C=E===m?5:0;break;default:C=0}C>0?(g=xf.updateStateListForPair(g,j,C),j++):g=this.updateStateListForChar(g,j)}return HE.min(g,(j,C)=>j.getBitCount()-C.getBitCount()).toBitArray(this.text)}updateStateListForChar(m,p){const g=[];for(let N of m)this.updateStateForChar(N,p,g);return xf.simplifyStates(g)}updateStateForChar(m,p,g){let N=this.text[p]&255,j=XN[m.getMode()][N]>0,C=null;for(let E=0;E<=Ol;E++){let R=XN[E][N];if(R>0){if(C==null&&(C=m.endBinaryShift(p)),!j||E===m.getMode()||E===wi){const U=C.latchAndAppend(E,R);g.push(U)}if(!j&&qE[m.getMode()][E]>=0){const U=C.shiftAndAppend(E,R);g.push(U)}}}if(m.getBinaryShiftByteCount()>0||XN[m.getMode()][N]===0){let E=m.addBinaryShiftChar(p);g.push(E)}}static updateStateListForPair(m,p,g){const N=[];for(let j of m)this.updateStateForPair(j,p,g,N);return this.simplifyStates(N)}static updateStateForPair(m,p,g,N){let j=m.endBinaryShift(p);if(N.push(j.latchAndAppend(Ol,g)),m.getMode()!==Ol&&N.push(j.shiftAndAppend(Ol,g)),g===3||g===4){let C=j.latchAndAppend(wi,16-g).latchAndAppend(wi,1);N.push(C)}if(m.getBinaryShiftByteCount()>0){let C=m.addBinaryShiftChar(p).addBinaryShiftChar(p+1);N.push(C)}}static simplifyStates(m){let p=[];for(const g of m){let N=!0;for(const j of p){if(j.isBetterThanOrEqualTo(g)){N=!1;break}g.isBetterThanOrEqualTo(j)&&(p=p.filter(C=>C!==j))}N&&p.push(g)}return p}}class hs{constructor(){}static encodeBytes(m){return hs.encode(m,hs.DEFAULT_EC_PERCENT,hs.DEFAULT_AZTEC_LAYERS)}static encode(m,p,g){let N=new xf(m).encode(),j=A.truncDivision(N.getSize()*p,100)+11,C=N.getSize()+j,E,R,U,W,Y;if(g!==hs.DEFAULT_AZTEC_LAYERS){if(E=g<0,R=Math.abs(g),R>(E?hs.MAX_NB_BITS_COMPACT:hs.MAX_NB_BITS))throw new f(F.format("Illegal value %s for layers",g));U=hs.totalBitsInLayer(R,E),W=hs.WORD_SIZE[R];let Ye=U-U%W;if(Y=hs.stuffBits(N,W),Y.getSize()+j>Ye)throw new f("Data to large for user specified layer");if(E&&Y.getSize()>W*64)throw new f("Data to large for user specified layer")}else{W=0,Y=null;for(let Ye=0;;Ye++){if(Ye>hs.MAX_NB_BITS)throw new f("Data too large for an Aztec code");if(E=Ye<=3,R=E?Ye+1:Ye,U=hs.totalBitsInLayer(R,E),C>U)continue;(Y==null||W!==hs.WORD_SIZE[R])&&(W=hs.WORD_SIZE[R],Y=hs.stuffBits(N,W));let cs=U-U%W;if(!(E&&Y.getSize()>W*64)&&Y.getSize()+j<=cs)break}}let Z=hs.generateCheckWords(Y,U,W),le=Y.getSize()/W,be=hs.generateModeMessage(E,R,le),Ne=(E?11:14)+R*4,Ae=new Int32Array(Ne),Oe;if(E){Oe=Ne;for(let Ye=0;Ye<Ae.length;Ye++)Ae[Ye]=Ye}else{Oe=Ne+1+2*A.truncDivision(A.truncDivision(Ne,2)-1,15);let Ye=A.truncDivision(Ne,2),cs=A.truncDivision(Oe,2);for(let Xt=0;Xt<Ye;Xt++){let _a=Xt+A.truncDivision(Xt,15);Ae[Ye-Xt-1]=cs-_a-1,Ae[Ye+Xt]=cs+_a+1}}let et=new $(Oe);for(let Ye=0,cs=0;Ye<R;Ye++){let Xt=(R-Ye)*4+(E?9:12);for(let _a=0;_a<Xt;_a++){let sl=_a*2;for(let Sa=0;Sa<2;Sa++)Z.get(cs+sl+Sa)&&et.set(Ae[Ye*2+Sa],Ae[Ye*2+_a]),Z.get(cs+Xt*2+sl+Sa)&&et.set(Ae[Ye*2+_a],Ae[Ne-1-Ye*2-Sa]),Z.get(cs+Xt*4+sl+Sa)&&et.set(Ae[Ne-1-Ye*2-Sa],Ae[Ne-1-Ye*2-_a]),Z.get(cs+Xt*6+sl+Sa)&&et.set(Ae[Ne-1-Ye*2-_a],Ae[Ye*2+Sa])}cs+=Xt*8}if(hs.drawModeMessage(et,E,Oe,be),E)hs.drawBullsEye(et,A.truncDivision(Oe,2),5);else{hs.drawBullsEye(et,A.truncDivision(Oe,2),7);for(let Ye=0,cs=0;Ye<A.truncDivision(Ne,2)-1;Ye+=15,cs+=16)for(let Xt=A.truncDivision(Oe,2)&1;Xt<Oe;Xt+=2)et.set(A.truncDivision(Oe,2)-cs,Xt),et.set(A.truncDivision(Oe,2)+cs,Xt),et.set(Xt,A.truncDivision(Oe,2)-cs),et.set(Xt,A.truncDivision(Oe,2)+cs)}let st=new VE;return st.setCompact(E),st.setSize(Oe),st.setLayers(R),st.setCodeWords(le),st.setMatrix(et),st}static drawBullsEye(m,p,g){for(let N=0;N<g;N+=2)for(let j=p-N;j<=p+N;j++)m.set(j,p-N),m.set(j,p+N),m.set(p-N,j),m.set(p+N,j);m.set(p-g,p-g),m.set(p-g+1,p-g),m.set(p-g,p-g+1),m.set(p+g,p-g),m.set(p+g,p-g+1),m.set(p+g,p+g-1)}static generateModeMessage(m,p,g){let N=new T;return m?(N.appendBits(p-1,2),N.appendBits(g-1,6),N=hs.generateCheckWords(N,28,4)):(N.appendBits(p-1,5),N.appendBits(g-1,11),N=hs.generateCheckWords(N,40,4)),N}static drawModeMessage(m,p,g,N){let j=A.truncDivision(g,2);if(p)for(let C=0;C<7;C++){let E=j-3+C;N.get(C)&&m.set(E,j-5),N.get(C+7)&&m.set(j+5,E),N.get(20-C)&&m.set(E,j+5),N.get(27-C)&&m.set(j-5,E)}else for(let C=0;C<10;C++){let E=j-5+C+A.truncDivision(C,5);N.get(C)&&m.set(E,j-7),N.get(C+10)&&m.set(j+7,E),N.get(29-C)&&m.set(E,j+7),N.get(39-C)&&m.set(j-7,E)}}static generateCheckWords(m,p,g){let N=m.getSize()/g,j=new WN(hs.getGF(g)),C=A.truncDivision(p,g),E=hs.bitsToWords(m,g,C);j.encode(E,C-N);let R=p%g,U=new T;U.appendBits(0,R);for(const W of Array.from(E))U.appendBits(W,g);return U}static bitsToWords(m,p,g){let N=new Int32Array(g),j,C;for(j=0,C=m.getSize()/p;j<C;j++){let E=0;for(let R=0;R<p;R++)E|=m.get(j*p+R)?1<<p-R-1:0;N[j]=E}return N}static getGF(m){switch(m){case 4:return qe.AZTEC_PARAM;case 6:return qe.AZTEC_DATA_6;case 8:return qe.AZTEC_DATA_8;case 10:return qe.AZTEC_DATA_10;case 12:return qe.AZTEC_DATA_12;default:throw new f("Unsupported word size "+m)}}static stuffBits(m,p){let g=new T,N=m.getSize(),j=(1<<p)-2;for(let C=0;C<N;C+=p){let E=0;for(let R=0;R<p;R++)(C+R>=N||m.get(C+R))&&(E|=1<<p-1-R);(E&j)===j?(g.appendBits(E&j,p),C--):E&j?g.appendBits(E,p):(g.appendBits(E|1,p),C--)}return g}static totalBitsInLayer(m,p){return((p?88:112)+16*m)*m}}hs.DEFAULT_EC_PERCENT=33,hs.DEFAULT_AZTEC_LAYERS=0,hs.MAX_NB_BITS=32,hs.MAX_NB_BITS_COMPACT=4,hs.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class j0{encode(m,p,g,N){return this.encodeWithHints(m,p,g,N,null)}encodeWithHints(m,p,g,N,j){let C=GN.ISO_8859_1,E=hs.DEFAULT_EC_PERCENT,R=hs.DEFAULT_AZTEC_LAYERS;return j!=null&&(j.has(Qn.CHARACTER_SET)&&(C=UE.forName(j.get(Qn.CHARACTER_SET).toString())),j.has(Qn.ERROR_CORRECTION)&&(E=A.parseInt(j.get(Qn.ERROR_CORRECTION).toString())),j.has(Qn.AZTEC_LAYERS)&&(R=A.parseInt(j.get(Qn.AZTEC_LAYERS).toString()))),j0.encodeLayers(m,p,g,N,C,E,R)}static encodeLayers(m,p,g,N,j,C,E){if(p!==X.AZTEC)throw new f("Can only encode AZTEC, but got "+p);let R=hs.encode(F.getBytes(m,j),C,E);return j0.renderResult(R,g,N)}static renderResult(m,p,g){let N=m.getMatrix();if(N==null)throw new jt;let j=N.getWidth(),C=N.getHeight(),E=Math.max(p,j),R=Math.max(g,C),U=Math.min(E/j,R/C),W=(E-j*U)/2,Y=(R-C*U)/2,Z=new $(E,R);for(let le=0,be=Y;le<C;le++,be+=U)for(let Ne=0,Ae=W;Ne<j;Ne++,Ae+=U)N.get(Ne,le)&&Z.setRegion(Ae,be,U,U);return Z}}n.AbstractExpandedDecoder=Wa,n.ArgumentException=h,n.ArithmeticException=oe,n.AztecCode=VE,n.AztecCodeReader=he,n.AztecCodeWriter=j0,n.AztecDecoder=_t,n.AztecDetector=Ie,n.AztecDetectorResult=Fe,n.AztecEncoder=hs,n.AztecHighLevelEncoder=xf,n.AztecPoint=ie,n.BarcodeFormat=X,n.Binarizer=v,n.BinaryBitmap=x,n.BitArray=T,n.BitMatrix=$,n.BitSource=Ml,n.BrowserAztecCodeReader=Me,n.BrowserBarcodeReader=Il,n.BrowserCodeReader=te,n.BrowserDatamatrixCodeReader=ke,n.BrowserMultiFormatReader=dY,n.BrowserPDF417Reader=uY,n.BrowserQRCodeReader=hY,n.BrowserQRCodeSvgWriter=Dd,n.CharacterSetECI=M,n.ChecksumException=b,n.Code128Reader=Be,n.Code39Reader=Ot,n.DataMatrixDecodedBitStreamParser=Na,n.DataMatrixReader=Q,n.DecodeHintType=O,n.DecoderResult=ue,n.DefaultGridSampler=Ns,n.DetectorResult=je,n.EAN13Reader=Gt,n.EncodeHintType=Qn,n.Exception=u,n.FormatException=D,n.GenericGF=qe,n.GenericGFPoly=pe,n.GlobalHistogramBinarizer=H,n.GridSampler=vt,n.GridSamplerInstance=ds,n.HTMLCanvasElementLuminanceSource=ye,n.HybridBinarizer=q,n.ITFReader=Rt,n.IllegalArgumentException=f,n.IllegalStateException=jt,n.InvertedLuminanceSource=re,n.LuminanceSource=G,n.MathUtils=ve,n.MultiFormatOneDReader=Fn,n.MultiFormatReader=zE,n.MultiFormatWriter=fY,n.NotFoundException=z,n.OneDReader=Ge,n.PDF417DecodedBitStreamParser=De,n.PDF417DecoderErrorCorrection=OE,n.PDF417Reader=kr,n.PDF417ResultMetadata=LE,n.PerspectiveTransform=pt,n.PlanarYUVLuminanceSource=Dl,n.QRCodeByteMatrix=N0,n.QRCodeDataMask=wa,n.QRCodeDecodedBitStreamParser=Bs,n.QRCodeDecoderErrorCorrectionLevel=mt,n.QRCodeDecoderFormatInformation=Ut,n.QRCodeEncoder=qs,n.QRCodeEncoderQRCode=Md,n.QRCodeMaskUtil=vn,n.QRCodeMatrixUtil=$t,n.QRCodeMode=Tt,n.QRCodeReader=tl,n.QRCodeVersion=At,n.QRCodeWriter=sh,n.RGBLuminanceSource=qN,n.RSS14Reader=Ps,n.RSSExpandedReader=Ue,n.ReaderException=v0,n.ReedSolomonDecoder=ft,n.ReedSolomonEncoder=WN,n.ReedSolomonException=Xe,n.Result=ce,n.ResultMetadataType=Ce,n.ResultPoint=xe,n.StringUtils=F,n.UnsupportedOperationException=B,n.VideoInputDevice=Ee,n.WhiteRectangleDetector=Ct,n.WriterException=Is,n.ZXingArrays=k,n.ZXingCharset=UE,n.ZXingInteger=A,n.ZXingStandardCharsets=GN,n.ZXingStringBuilder=V,n.ZXingStringEncoding=L,n.ZXingSystem=w,n.createAbstractExpandedDecoder=el,Object.defineProperty(n,"__esModule",{value:!0})})})(OC,OC.exports);var Ks=OC.exports;const SLe=Yi(Ks),CLe=T6({__proto__:null,default:SLe},[Ks]);var a6=function(){function t(s,n,a){if(this.formatMap=new Map([[gt.QR_CODE,Ks.BarcodeFormat.QR_CODE],[gt.AZTEC,Ks.BarcodeFormat.AZTEC],[gt.CODABAR,Ks.BarcodeFormat.CODABAR],[gt.CODE_39,Ks.BarcodeFormat.CODE_39],[gt.CODE_93,Ks.BarcodeFormat.CODE_93],[gt.CODE_128,Ks.BarcodeFormat.CODE_128],[gt.DATA_MATRIX,Ks.BarcodeFormat.DATA_MATRIX],[gt.MAXICODE,Ks.BarcodeFormat.MAXICODE],[gt.ITF,Ks.BarcodeFormat.ITF],[gt.EAN_13,Ks.BarcodeFormat.EAN_13],[gt.EAN_8,Ks.BarcodeFormat.EAN_8],[gt.PDF_417,Ks.BarcodeFormat.PDF_417],[gt.RSS_14,Ks.BarcodeFormat.RSS_14],[gt.RSS_EXPANDED,Ks.BarcodeFormat.RSS_EXPANDED],[gt.UPC_A,Ks.BarcodeFormat.UPC_A],[gt.UPC_E,Ks.BarcodeFormat.UPC_E],[gt.UPC_EAN_EXTENSION,Ks.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!CLe)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=n,this.logger=a;var i=this.createZXingFormats(s),l=new Map;l.set(Ks.DecodeHintType.POSSIBLE_FORMATS,i),l.set(Ks.DecodeHintType.TRY_HARDER,!1),this.hints=l}return t.prototype.decodeAsync=function(s){var n=this;return new Promise(function(a,i){try{a(n.decode(s))}catch(l){i(l)}})},t.prototype.decode=function(s){var n=new Ks.MultiFormatReader(this.verbose,this.hints),a=new Ks.HTMLCanvasElementLuminanceSource(s),i=new Ks.BinaryBitmap(new Ks.HybridBinarizer(a)),l=n.decode(i);return{text:l.text,format:HK.create(this.toHtml5QrcodeSupportedFormats(l.format)),debugData:this.createDebugData()}},t.prototype.createReverseFormatMap=function(){var s=new Map;return this.formatMap.forEach(function(n,a,i){s.set(n,a)}),s},t.prototype.toHtml5QrcodeSupportedFormats=function(s){if(!this.reverseFormatMap.has(s))throw"reverseFormatMap doesn't have ".concat(s);return this.reverseFormatMap.get(s)},t.prototype.createZXingFormats=function(s){for(var n=[],a=0,i=s;a<i.length;a++){var l=i[a];this.formatMap.has(l)?n.push(this.formatMap.get(l)):this.logger.logError("".concat(l," is not supported by")+"ZXingHtml5QrcodeShim")}return n},t.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},t}(),kLe=function(t,s,n,a){function i(l){return l instanceof n?l:new n(function(o){o(l)})}return new(n||(n=Promise))(function(l,o){function c(h){try{u(a.next(h))}catch(f){o(f)}}function d(h){try{u(a.throw(h))}catch(f){o(f)}}function u(h){h.done?l(h.value):i(h.value).then(c,d)}u((a=a.apply(t,s||[])).next())})},ALe=function(t,s){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,i,l,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(h){return d([u,h])}}function d(u){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(n=0)),n;)try{if(a=1,i&&(l=u[0]&2?i.return:u[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,u[1])).done)return l;switch(i=0,l&&(u=[u[0]&2,l.value]),u[0]){case 0:case 1:l=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,i=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!l||u[1]>l[0]&&u[1]<l[3])){n.label=u[1];break}if(u[0]===6&&n.label<l[1]){n.label=l[1],l=u;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(u);break}l[2]&&n.ops.pop(),n.trys.pop();continue}u=s.call(t,n)}catch(h){u=[6,h],i=0}finally{a=l=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},i6=function(){function t(s,n,a){if(this.formatMap=new Map([[gt.QR_CODE,"qr_code"],[gt.AZTEC,"aztec"],[gt.CODABAR,"codabar"],[gt.CODE_39,"code_39"],[gt.CODE_93,"code_93"],[gt.CODE_128,"code_128"],[gt.DATA_MATRIX,"data_matrix"],[gt.ITF,"itf"],[gt.EAN_13,"ean_13"],[gt.EAN_8,"ean_8"],[gt.PDF_417,"pdf417"],[gt.UPC_A,"upc_a"],[gt.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!t.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=n,this.logger=a;var i=this.createBarcodeDetectorFormats(s);if(this.detector=new BarcodeDetector(i),!this.detector)throw"BarcodeDetector detector not supported"}return t.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var s=new BarcodeDetector({formats:["qr_code"]});return typeof s<"u"},t.prototype.decodeAsync=function(s){return kLe(this,void 0,void 0,function(){var n,a;return ALe(this,function(i){switch(i.label){case 0:return[4,this.detector.detect(s)];case 1:if(n=i.sent(),!n||n.length===0)throw"No barcode or QR code detected.";return a=this.selectLargestBarcode(n),[2,{text:a.rawValue,format:HK.create(this.toHtml5QrcodeSupportedFormats(a.format)),debugData:this.createDebugData()}]}})})},t.prototype.selectLargestBarcode=function(s){for(var n=null,a=0,i=0,l=s;i<l.length;i++){var o=l[i],c=o.boundingBox.width*o.boundingBox.height;c>a&&(a=c,n=o)}if(!n)throw"No largest barcode found";return n},t.prototype.createBarcodeDetectorFormats=function(s){for(var n=[],a=0,i=s;a<i.length;a++){var l=i[a];this.formatMap.has(l)?n.push(this.formatMap.get(l)):this.logger.warn("".concat(l," is not supported by")+"BarcodeDetectorDelegate")}return{formats:n}},t.prototype.toHtml5QrcodeSupportedFormats=function(s){if(!this.reverseFormatMap.has(s))throw"reverseFormatMap doesn't have ".concat(s);return this.reverseFormatMap.get(s)},t.prototype.createReverseFormatMap=function(){var s=new Map;return this.formatMap.forEach(function(n,a,i){s.set(n,a)}),s},t.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},t}(),l6=function(t,s,n,a){function i(l){return l instanceof n?l:new n(function(o){o(l)})}return new(n||(n=Promise))(function(l,o){function c(h){try{u(a.next(h))}catch(f){o(f)}}function d(h){try{u(a.throw(h))}catch(f){o(f)}}function u(h){h.done?l(h.value):i(h.value).then(c,d)}u((a=a.apply(t,s||[])).next())})},o6=function(t,s){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,i,l,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(h){return d([u,h])}}function d(u){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(n=0)),n;)try{if(a=1,i&&(l=u[0]&2?i.return:u[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,u[1])).done)return l;switch(i=0,l&&(u=[u[0]&2,l.value]),u[0]){case 0:case 1:l=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,i=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!l||u[1]>l[0]&&u[1]<l[3])){n.label=u[1];break}if(u[0]===6&&n.label<l[1]){n.label=l[1],l=u;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(u);break}l[2]&&n.ops.pop(),n.trys.pop();continue}u=s.call(t,n)}catch(h){u=[6,h],i=0}finally{a=l=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},ELe=function(){function t(s,n,a,i){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=a,n&&i6.isSupported()?(this.primaryDecoder=new i6(s,a,i),this.secondaryDecoder=new a6(s,a,i)):this.primaryDecoder=new a6(s,a,i)}return t.prototype.decodeAsync=function(s){return l6(this,void 0,void 0,function(){var n;return o6(this,function(a){switch(a.label){case 0:n=performance.now(),a.label=1;case 1:return a.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(s)];case 2:return[2,a.sent()];case 3:return this.possiblyLogPerformance(n),[7];case 4:return[2]}})})},t.prototype.decodeRobustlyAsync=function(s){return l6(this,void 0,void 0,function(){var n,a;return o6(this,function(i){switch(i.label){case 0:n=performance.now(),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(s)];case 2:return[2,i.sent()];case 3:if(a=i.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(s)];throw a;case 4:return this.possiblyLogPerformance(n),[7];case 5:return[2]}})})},t.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},t.prototype.possiblyLogPerformance=function(s){if(this.verbose){var n=performance.now()-s;this.executionResults.push(n),this.executions++,this.possiblyFlushPerformanceReport()}},t.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var s=0,n=0,a=this.executionResults;n<a.length;n++){var i=a[n];s+=i}var l=s/this.executionResults.length;console.log("".concat(l," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},t}(),ME=function(){var t=function(s,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,i){a.__proto__=i}||function(a,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(a[l]=i[l])},t(s,n)};return function(s,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(s,n);function a(){this.constructor=s}s.prototype=n===null?Object.create(n):(a.prototype=n.prototype,new a)}}(),jb=function(t,s,n,a){function i(l){return l instanceof n?l:new n(function(o){o(l)})}return new(n||(n=Promise))(function(l,o){function c(h){try{u(a.next(h))}catch(f){o(f)}}function d(h){try{u(a.throw(h))}catch(f){o(f)}}function u(h){h.done?l(h.value):i(h.value).then(c,d)}u((a=a.apply(t,s||[])).next())})},_b=function(t,s){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,i,l,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(h){return d([u,h])}}function d(u){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(n=0)),n;)try{if(a=1,i&&(l=u[0]&2?i.return:u[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,u[1])).done)return l;switch(i=0,l&&(u=[u[0]&2,l.value]),u[0]){case 0:case 1:l=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,i=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!l||u[1]>l[0]&&u[1]<l[3])){n.label=u[1];break}if(u[0]===6&&n.label<l[1]){n.label=l[1],l=u;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(u);break}l[2]&&n.ops.pop(),n.trys.pop();continue}u=s.call(t,n)}catch(h){u=[6,h],i=0}finally{a=l=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},KK=function(){function t(s,n){this.name=s,this.track=n}return t.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},t.prototype.apply=function(s){var n={};n[this.name]=s;var a={advanced:[n]};return this.track.applyConstraints(a)},t.prototype.value=function(){var s=this.track.getSettings();if(this.name in s){var n=s[this.name];return n}return null},t}(),TLe=function(t){ME(s,t);function s(n,a){return t.call(this,n,a)||this}return s.prototype.min=function(){return this.getCapabilities().min},s.prototype.max=function(){return this.getCapabilities().max},s.prototype.step=function(){return this.getCapabilities().step},s.prototype.apply=function(n){var a={};a[this.name]=n;var i={advanced:[a]};return this.track.applyConstraints(i)},s.prototype.getCapabilities=function(){this.failIfNotSupported();var n=this.track.getCapabilities(),a=n[this.name];return{min:a.min,max:a.max,step:a.step}},s.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},s}(KK),PLe=function(t){ME(s,t);function s(n){return t.call(this,"zoom",n)||this}return s}(TLe),ILe=function(t){ME(s,t);function s(n){return t.call(this,"torch",n)||this}return s}(KK),MLe=function(){function t(s){this.track=s}return t.prototype.zoomFeature=function(){return new PLe(this.track)},t.prototype.torchFeature=function(){return new ILe(this.track)},t}(),DLe=function(){function t(s,n,a){this.isClosed=!1,this.parentElement=s,this.mediaStream=n,this.callbacks=a,this.surface=this.createVideoElement(this.parentElement.clientWidth),s.append(this.surface)}return t.prototype.createVideoElement=function(s){var n=document.createElement("video");return n.style.width="".concat(s,"px"),n.style.display="block",n.muted=!0,n.setAttribute("muted","true"),n.playsInline=!0,n},t.prototype.setupSurface=function(){var s=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var n=function(){var a=s.surface.clientWidth,i=s.surface.clientHeight;s.callbacks.onRenderSurfaceReady(a,i),s.surface.removeEventListener("playing",n)};this.surface.addEventListener("playing",n),this.surface.srcObject=this.mediaStream,this.surface.play()},t.create=function(s,n,a,i){return jb(this,void 0,void 0,function(){var l,o;return _b(this,function(c){switch(c.label){case 0:return l=new t(s,n,i),a.aspectRatio?(o={aspectRatio:a.aspectRatio},[4,l.getFirstTrackOrFail().applyConstraints(o)]):[3,2];case 1:c.sent(),c.label=2;case 2:return l.setupSurface(),[2,l]}})})},t.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},t.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},t.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},t.prototype.resume=function(s){this.failIfClosed();var n=this,a=function(){setTimeout(s,200),n.surface.removeEventListener("playing",a)};this.surface.addEventListener("playing",a),this.surface.play()},t.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},t.prototype.getSurface=function(){return this.failIfClosed(),this.surface},t.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},t.prototype.applyVideoConstraints=function(s){return jb(this,void 0,void 0,function(){return _b(this,function(n){if("aspectRatio"in s)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(s)]})})},t.prototype.close=function(){if(this.isClosed)return Promise.resolve();var s=this;return new Promise(function(n,a){var i=s.mediaStream.getVideoTracks(),l=i.length,o=0;s.mediaStream.getVideoTracks().forEach(function(c){s.mediaStream.removeTrack(c),c.stop(),++o,o>=l&&(s.isClosed=!0,s.parentElement.removeChild(s.surface),n())})})},t.prototype.getCapabilities=function(){return new MLe(this.getFirstTrackOrFail())},t}(),OLe=function(){function t(s){this.mediaStream=s}return t.prototype.render=function(s,n,a){return jb(this,void 0,void 0,function(){return _b(this,function(i){return[2,DLe.create(s,this.mediaStream,n,a)]})})},t.create=function(s){return jb(this,void 0,void 0,function(){var n,a;return _b(this,function(i){switch(i.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return n={audio:!1,video:s},[4,navigator.mediaDevices.getUserMedia(n)];case 1:return a=i.sent(),[2,new t(a)]}})})},t}(),c6=function(t,s,n,a){function i(l){return l instanceof n?l:new n(function(o){o(l)})}return new(n||(n=Promise))(function(l,o){function c(h){try{u(a.next(h))}catch(f){o(f)}}function d(h){try{u(a.throw(h))}catch(f){o(f)}}function u(h){h.done?l(h.value):i(h.value).then(c,d)}u((a=a.apply(t,s||[])).next())})},d6=function(t,s){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,i,l,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(h){return d([u,h])}}function d(u){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(n=0)),n;)try{if(a=1,i&&(l=u[0]&2?i.return:u[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,u[1])).done)return l;switch(i=0,l&&(u=[u[0]&2,l.value]),u[0]){case 0:case 1:l=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,i=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!l||u[1]>l[0]&&u[1]<l[3])){n.label=u[1];break}if(u[0]===6&&n.label<l[1]){n.label=l[1],l=u;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(u);break}l[2]&&n.ops.pop(),n.trys.pop();continue}u=s.call(t,n)}catch(h){u=[6,h],i=0}finally{a=l=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},RLe=function(){function t(){}return t.failIfNotSupported=function(){return c6(this,void 0,void 0,function(){return d6(this,function(s){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new t]})})},t.prototype.create=function(s){return c6(this,void 0,void 0,function(){return d6(this,function(n){return[2,OLe.create(s)]})})},t}(),LLe=function(t,s,n,a){function i(l){return l instanceof n?l:new n(function(o){o(l)})}return new(n||(n=Promise))(function(l,o){function c(h){try{u(a.next(h))}catch(f){o(f)}}function d(h){try{u(a.throw(h))}catch(f){o(f)}}function u(h){h.done?l(h.value):i(h.value).then(c,d)}u((a=a.apply(t,s||[])).next())})},BLe=function(t,s){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,i,l,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(h){return d([u,h])}}function d(u){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(n=0)),n;)try{if(a=1,i&&(l=u[0]&2?i.return:u[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,u[1])).done)return l;switch(i=0,l&&(u=[u[0]&2,l.value]),u[0]){case 0:case 1:l=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,i=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!l||u[1]>l[0]&&u[1]<l[3])){n.label=u[1];break}if(u[0]===6&&n.label<l[1]){n.label=l[1],l=u;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(u);break}l[2]&&n.ops.pop(),n.trys.pop();continue}u=s.call(t,n)}catch(h){u=[6,h],i=0}finally{a=l=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},FLe=function(){function t(){}return t.retrieve=function(){if(navigator.mediaDevices)return t.getCamerasFromMediaDevices();var s=MediaStreamTrack;return MediaStreamTrack&&s.getSources?t.getCamerasFromMediaStreamTrack():t.rejectWithError()},t.rejectWithError=function(){var s=Fh.unableToQuerySupportedDevices();return t.isHttpsOrLocalhost()||(s=Fh.insecureContextCameraQueryError()),Promise.reject(s)},t.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var s=location.host.split(":")[0];return s==="127.0.0.1"||s==="localhost"},t.getCamerasFromMediaDevices=function(){return LLe(this,void 0,void 0,function(){var s,n,a,i,l,o,c;return BLe(this,function(d){switch(d.label){case 0:return s=function(u){for(var h=u.getVideoTracks(),f=0,x=h;f<x.length;f++){var b=x[f];b.enabled=!1,b.stop(),u.removeTrack(b)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return n=d.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(a=d.sent(),i=[],l=0,o=a;l<o.length;l++)c=o[l],c.kind==="videoinput"&&i.push({id:c.deviceId,label:c.label});return s(n),[2,i]}})})},t.getCamerasFromMediaStreamTrack=function(){return new Promise(function(s,n){var a=function(l){for(var o=[],c=0,d=l;c<d.length;c++){var u=d[c];u.kind==="video"&&o.push({id:u.id,label:u.label})}s(o)},i=MediaStreamTrack;i.getSources(a)})},t}(),Nn;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.NOT_STARTED=1]="NOT_STARTED",t[t.SCANNING=2]="SCANNING",t[t.PAUSED=3]="PAUSED"})(Nn||(Nn={}));var $Le=function(){function t(){this.state=Nn.NOT_STARTED,this.onGoingTransactionNewState=Nn.UNKNOWN}return t.prototype.directTransition=function(s){this.failIfTransitionOngoing(),this.validateTransition(s),this.state=s},t.prototype.startTransition=function(s){return this.failIfTransitionOngoing(),this.validateTransition(s),this.onGoingTransactionNewState=s,this},t.prototype.execute=function(){if(this.onGoingTransactionNewState===Nn.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var s=this.onGoingTransactionNewState;this.onGoingTransactionNewState=Nn.UNKNOWN,this.directTransition(s)},t.prototype.cancel=function(){if(this.onGoingTransactionNewState===Nn.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=Nn.UNKNOWN},t.prototype.getState=function(){return this.state},t.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==Nn.UNKNOWN)throw"Cannot transition to a new state, already under transition"},t.prototype.validateTransition=function(s){switch(this.state){case Nn.UNKNOWN:throw"Transition from unknown is not allowed";case Nn.NOT_STARTED:this.failIfNewStateIs(s,[Nn.PAUSED]);break;case Nn.SCANNING:break;case Nn.PAUSED:break}},t.prototype.failIfNewStateIs=function(s,n){for(var a=0,i=n;a<i.length;a++){var l=i[a];if(s===l)throw"Cannot transition from ".concat(this.state," to ").concat(s)}},t}(),zLe=function(){function t(s){this.stateManager=s}return t.prototype.startTransition=function(s){return this.stateManager.startTransition(s)},t.prototype.directTransition=function(s){this.stateManager.directTransition(s)},t.prototype.getState=function(){return this.stateManager.getState()},t.prototype.canScanFile=function(){return this.stateManager.getState()===Nn.NOT_STARTED},t.prototype.isScanning=function(){return this.stateManager.getState()!==Nn.NOT_STARTED},t.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===Nn.SCANNING},t.prototype.isPaused=function(){return this.stateManager.getState()===Nn.PAUSED},t}(),ULe=function(){function t(){}return t.create=function(){return new zLe(new $Le)},t}(),VLe=function(){var t=function(s,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,i){a.__proto__=i}||function(a,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(a[l]=i[l])},t(s,n)};return function(s,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(s,n);function a(){this.constructor=s}s.prototype=n===null?Object.create(n):(a.prototype=n.prototype,new a)}}(),ei=function(t){VLe(s,t);function s(){return t!==null&&t.apply(this,arguments)||this}return s.DEFAULT_WIDTH=300,s.DEFAULT_WIDTH_OFFSET=2,s.FILE_SCAN_MIN_HEIGHT=300,s.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,s.MIN_QR_BOX_SIZE=50,s.SHADED_LEFT=1,s.SHADED_RIGHT=2,s.SHADED_TOP=3,s.SHADED_BOTTOM=4,s.SHADED_REGION_ELEMENT_ID="qr-shaded-region",s.VERBOSE=!1,s.BORDER_SHADER_DEFAULT_COLOR="#ffffff",s.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",s}(cl),HLe=function(){function t(s,n){this.logger=n,this.fps=ei.SCAN_DEFAULT_FPS,s?(s.fps&&(this.fps=s.fps),this.disableFlip=s.disableFlip===!0,this.qrbox=s.qrbox,this.aspectRatio=s.aspectRatio,this.videoConstraints=s.videoConstraints):this.disableFlip=ei.DEFAULT_DISABLE_FLIP}return t.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?GK.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},t.prototype.isShadedBoxEnabled=function(){return!Wl(this.qrbox)},t.create=function(s,n){return new t(s,n)},t}(),u6=function(){function t(s,n){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(s))throw"HTML Element with id=".concat(s," not found");this.elementId=s,this.verbose=!1;var a;typeof n=="boolean"?this.verbose=n===!0:n&&(a=n,this.verbose=a.verbose===!0,a.experimentalFeatures),this.logger=new qK(this.verbose),this.qrcode=new ELe(this.getSupportedFormats(n),this.getUseBarCodeDetectorIfSupported(a),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=ULe.create()}return t.prototype.start=function(s,n,a,i){var l=this;if(!s)throw"cameraIdOrConfig is required";if(!a||typeof a!="function")throw"qrCodeSuccessCallback is required and should be a function.";var o;i?o=i:o=this.verbose?this.logger.log:function(){};var c=HLe.create(n,this.logger);this.clearElement();var d=!1;c.videoConstraints&&(c.isMediaStreamConstraintsValid()?d=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var u=d,h=document.getElementById(this.elementId);h.clientWidth?h.clientWidth:ei.DEFAULT_WIDTH,h.style.position="relative",this.shouldScan=!0,this.element=h;var f=this,x=this.stateManagerProxy.startTransition(Nn.SCANNING);return new Promise(function(b,v){var w=u?c.videoConstraints:f.createVideoConstraints(s);if(!w){x.cancel(),v("videoConstraints should be defined");return}var _={};(!u||c.aspectRatio)&&(_.aspectRatio=c.aspectRatio);var S={onRenderSurfaceReady:function(k,A){f.setupUi(k,A,c),f.isScanning=!0,f.foreverScan(c,a,o)}};RLe.failIfNotSupported().then(function(k){k.create(w).then(function(A){return A.render(l.element,_,S).then(function(T){f.renderedCamera=T,x.execute(),b(null)}).catch(function(T){x.cancel(),v(T)})}).catch(function(A){x.cancel(),v(Fh.errorGettingUserMedia(A))})}).catch(function(k){x.cancel(),v(Fh.cameraStreamingNotSupported())})})},t.prototype.pause=function(s){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(Nn.PAUSED),this.showPausedState(),(Wl(s)||s!==!0)&&(s=!1),s&&this.renderedCamera&&this.renderedCamera.pause()},t.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var s=this,n=function(){s.stateManagerProxy.directTransition(Nn.SCANNING),s.hidePausedState()};if(!this.renderedCamera.isPaused()){n();return}this.renderedCamera.resume(function(){n()})},t.prototype.getState=function(){return this.stateManagerProxy.getState()},t.prototype.stop=function(){var s=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var n=this.stateManagerProxy.startTransition(Nn.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var a=function(){if(s.element){var l=document.getElementById(ei.SHADED_REGION_ELEMENT_ID);l&&s.element.removeChild(l)}},i=this;return this.renderedCamera.close().then(function(){return i.renderedCamera=null,i.element&&(i.element.removeChild(i.canvasElement),i.canvasElement=null),a(),i.qrRegion&&(i.qrRegion=null),i.context&&(i.context=null),n.execute(),i.hidePausedState(),i.isScanning=!1,Promise.resolve()})},t.prototype.scanFile=function(s,n){return this.scanFileV2(s,n).then(function(a){return a.decodedText})},t.prototype.scanFileV2=function(s,n){var a=this;if(!s||!(s instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(Wl(n)&&(n=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(i,l){a.possiblyCloseLastScanImageFile(),a.clearElement(),a.lastScanImageFile=URL.createObjectURL(s);var o=new Image;o.onload=function(){var c=o.width,d=o.height,u=document.getElementById(a.elementId),h=u.clientWidth?u.clientWidth:ei.DEFAULT_WIDTH,f=Math.max(u.clientHeight?u.clientHeight:d,ei.FILE_SCAN_MIN_HEIGHT),x=a.computeCanvasDrawConfig(c,d,h,f);if(n){var b=a.createCanvasElement(h,f,"qr-canvas-visible");b.style.display="inline-block",u.appendChild(b);var v=b.getContext("2d");if(!v)throw"Unable to get 2d context from canvas";v.canvas.width=h,v.canvas.height=f,v.drawImage(o,0,0,c,d,x.x,x.y,x.width,x.height)}var w=ei.FILE_SCAN_HIDDEN_CANVAS_PADDING,_=Math.max(o.width,x.width),S=Math.max(o.height,x.height),k=_+2*w,A=S+2*w,T=a.createCanvasElement(k,A);u.appendChild(T);var P=T.getContext("2d");if(!P)throw"Unable to get 2d context from canvas";P.canvas.width=k,P.canvas.height=A,P.drawImage(o,0,0,c,d,w,w,_,S);try{a.qrcode.decodeRobustlyAsync(T).then(function(O){i(n6.createFromQrcodeResult(O))}).catch(l)}catch(O){l("QR code parse error, error = ".concat(O))}},o.onerror=l,o.onabort=l,o.onstalled=l,o.onsuspend=l,o.src=URL.createObjectURL(s)})},t.prototype.clear=function(){this.clearElement()},t.getCameras=function(){return FLe.retrieve()},t.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},t.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},t.prototype.applyVideoConstraints=function(s){if(s){if(!GK.isMediaStreamConstraintsValid(s,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(s)},t.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},t.prototype.getSupportedFormats=function(s){var n=[gt.QR_CODE,gt.AZTEC,gt.CODABAR,gt.CODE_39,gt.CODE_93,gt.CODE_128,gt.DATA_MATRIX,gt.MAXICODE,gt.ITF,gt.EAN_13,gt.EAN_8,gt.PDF_417,gt.RSS_14,gt.RSS_EXPANDED,gt.UPC_A,gt.UPC_E,gt.UPC_EAN_EXTENSION];if(!s||typeof s=="boolean"||!s.formatsToSupport)return n;if(!Array.isArray(s.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(s.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var a=[],i=0,l=s.formatsToSupport;i<l.length;i++){var o=l[i];jLe(o)?a.push(o):this.logger.warn("Invalid format: ".concat(o," passed in config, ignoring."))}if(a.length===0)throw"None of formatsToSupport match supported values.";return a},t.prototype.getUseBarCodeDetectorIfSupported=function(s){if(Wl(s))return!0;if(!Wl(s.useBarCodeDetectorIfSupported))return s.useBarCodeDetectorIfSupported!==!1;if(Wl(s.experimentalFeatures))return!0;var n=s.experimentalFeatures;return Wl(n.useBarCodeDetectorIfSupported)?!0:n.useBarCodeDetectorIfSupported!==!1},t.prototype.validateQrboxSize=function(s,n,a){var i=this,l=a.qrbox;this.validateQrboxConfig(l);var o=this.toQrdimensions(s,n,l),c=function(u){if(u<ei.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(ei.MIN_QR_BOX_SIZE,"px.")},d=function(u){return u>s&&(i.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),u=s),u};c(o.width),c(o.height),o.width=d(o.width)},t.prototype.validateQrboxConfig=function(s){if(typeof s!="number"&&typeof s!="function"&&(s.width===void 0||s.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},t.prototype.toQrdimensions=function(s,n,a){if(typeof a=="number")return{width:a,height:a};if(typeof a=="function")try{return a(s,n)}catch(i){throw new Error("qrbox config was passed as a function but it failed with unknown error"+i)}return a},t.prototype.setupUi=function(s,n,a){a.isShadedBoxEnabled()&&this.validateQrboxSize(s,n,a);var i=Wl(a.qrbox)?{width:s,height:n}:a.qrbox;this.validateQrboxConfig(i);var l=this.toQrdimensions(s,n,i);l.height>n&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var o=a.isShadedBoxEnabled()&&l.height<=n,c={x:0,y:0,width:s,height:n},d=o?this.getShadedRegionBounds(s,n,l):c,u=this.createCanvasElement(d.width,d.height),h={willReadFrequently:!0},f=u.getContext("2d",h);f.canvas.width=d.width,f.canvas.height=d.height,this.element.append(u),o&&this.possiblyInsertShadingElement(this.element,s,n,l),this.createScannerPausedUiElement(this.element),this.qrRegion=d,this.context=f,this.canvasElement=u},t.prototype.createScannerPausedUiElement=function(s){var n=document.createElement("div");n.innerText=Fh.scannerPaused(),n.style.display="none",n.style.position="absolute",n.style.top="0px",n.style.zIndex="1",n.style.background="rgba(9, 9, 9, 0.46)",n.style.color="#FFECEC",n.style.textAlign="center",n.style.width="100%",s.appendChild(n),this.scannerPausedUiElement=n},t.prototype.scanContext=function(s,n){var a=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(i){return s(i.text,n6.createFromQrcodeResult(i)),a.possiblyUpdateShaders(!0),!0}).catch(function(i){a.possiblyUpdateShaders(!1);var l=Fh.codeParseError(i);return n(l,WK.createFrom(l)),!1})},t.prototype.foreverScan=function(s,n,a){var i=this;if(this.shouldScan&&this.renderedCamera){var l=this.renderedCamera.getSurface(),o=l.videoWidth/l.clientWidth,c=l.videoHeight/l.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var d=this.qrRegion.width*o,u=this.qrRegion.height*c,h=this.qrRegion.x*o,f=this.qrRegion.y*c;this.context.drawImage(l,h,f,d,u,0,0,this.qrRegion.width,this.qrRegion.height);var x=function(){i.foreverScanTimeout=setTimeout(function(){i.foreverScan(s,n,a)},i.getTimeoutFps(s.fps))};this.scanContext(n,a).then(function(b){!b&&s.disableFlip!==!0?(i.context.translate(i.context.canvas.width,0),i.context.scale(-1,1),i.scanContext(n,a).finally(function(){x()})):x()}).catch(function(b){i.logger.logError("Error happend while scanning context",b),x()})}},t.prototype.createVideoConstraints=function(s){if(typeof s=="string")return{deviceId:{exact:s}};if(typeof s=="object"){var n="facingMode",a="deviceId",i={user:!0,environment:!0},l="exact",o=function(v){if(v in i)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(v,"'")},c=Object.keys(s);if(c.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(c.length," keys");var d=Object.keys(s)[0];if(d!==n&&d!==a)throw"Only '".concat(n,"' and '").concat(a,"' ")+" are supported for 'cameraIdOrConfig'";if(d===n){var u=s.facingMode;if(typeof u=="string"){if(o(u))return{facingMode:u}}else if(typeof u=="object")if(l in u){if(o(u["".concat(l)]))return{facingMode:{exact:u["".concat(l)]}}}else throw"'facingMode' should be string or object with"+" ".concat(l," as key.");else{var h=typeof u;throw"Invalid type of 'facingMode' = ".concat(h)}}else{var f=s.deviceId;if(typeof f=="string")return{deviceId:f};if(typeof f=="object"){if(l in f)return{deviceId:{exact:f["".concat(l)]}};throw"'deviceId' should be string or object with"+" ".concat(l," as key.")}else{var x=typeof f;throw"Invalid type of 'deviceId' = ".concat(x)}}}var b=typeof s;throw"Invalid type of 'cameraIdOrConfig' = ".concat(b)},t.prototype.computeCanvasDrawConfig=function(s,n,a,i){if(s<=a&&n<=i){var l=(a-s)/2,o=(i-n)/2;return{x:l,y:o,width:s,height:n}}else{var c=s,d=n;return s>a&&(n=a/s*n,s=a),n>i&&(s=i/n*s,n=i),this.logger.log("Image downsampled from "+"".concat(c,"X").concat(d)+" to ".concat(s,"X").concat(n,".")),this.computeCanvasDrawConfig(s,n,a,i)}},t.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var s=document.getElementById(this.elementId);s&&(s.innerHTML="")},t.prototype.possiblyUpdateShaders=function(s){this.qrMatch!==s&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(n){n.style.backgroundColor=s?ei.BORDER_SHADER_MATCH_COLOR:ei.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=s)},t.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},t.prototype.createCanvasElement=function(s,n,a){var i=s,l=n,o=document.createElement("canvas");return o.style.width="".concat(i,"px"),o.style.height="".concat(l,"px"),o.style.display="none",o.id=Wl(a)?"qr-canvas":a,o},t.prototype.getShadedRegionBounds=function(s,n,a){if(a.width>s||a.height>n)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(s-a.width)/2,y:(n-a.height)/2,width:a.width,height:a.height}},t.prototype.possiblyInsertShadingElement=function(s,n,a,i){if(!(n-i.width<1||a-i.height<1)){var l=document.createElement("div");l.style.position="absolute";var o=(n-i.width)/2,c=(a-i.height)/2;if(l.style.borderLeft="".concat(o,"px solid rgba(0, 0, 0, 0.48)"),l.style.borderRight="".concat(o,"px solid rgba(0, 0, 0, 0.48)"),l.style.borderTop="".concat(c,"px solid rgba(0, 0, 0, 0.48)"),l.style.borderBottom="".concat(c,"px solid rgba(0, 0, 0, 0.48)"),l.style.boxSizing="border-box",l.style.top="0px",l.style.bottom="0px",l.style.left="0px",l.style.right="0px",l.id="".concat(ei.SHADED_REGION_ELEMENT_ID),n-i.width<11||a-i.height<11)this.hasBorderShaders=!1;else{var d=5,u=40;this.insertShaderBorders(l,u,d,-d,null,0,!0),this.insertShaderBorders(l,u,d,-d,null,0,!1),this.insertShaderBorders(l,u,d,null,-d,0,!0),this.insertShaderBorders(l,u,d,null,-d,0,!1),this.insertShaderBorders(l,d,u+d,-d,null,-d,!0),this.insertShaderBorders(l,d,u+d,null,-d,-d,!0),this.insertShaderBorders(l,d,u+d,-d,null,-d,!1),this.insertShaderBorders(l,d,u+d,null,-d,-d,!1),this.hasBorderShaders=!0}s.append(l)}},t.prototype.insertShaderBorders=function(s,n,a,i,l,o,c){var d=document.createElement("div");d.style.position="absolute",d.style.backgroundColor=ei.BORDER_SHADER_DEFAULT_COLOR,d.style.width="".concat(n,"px"),d.style.height="".concat(a,"px"),i!==null&&(d.style.top="".concat(i,"px")),l!==null&&(d.style.bottom="".concat(l,"px")),c?d.style.left="".concat(o,"px"):d.style.right="".concat(o,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(d),s.appendChild(d)},t.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},t.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},t.prototype.getTimeoutFps=function(s){return 1e3/s},t}(),DE="data:image/svg+xml;base64,",WLe=DE+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNzEuNjQzIDM3MS42NDMiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDM3MS42NDMgMzcxLjY0MyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZD0iTTEwNS4wODQgMzguMjcxaDE2My43Njh2MjBIMTA1LjA4NHoiLz48cGF0aCBkPSJNMzExLjU5NiAxOTAuMTg5Yy03LjQ0MS05LjM0Ny0xOC40MDMtMTYuMjA2LTMyLjc0My0yMC41MjJWMzBjMC0xNi41NDItMTMuNDU4LTMwLTMwLTMwSDEyNS4wODRjLTE2LjU0MiAwLTMwIDEzLjQ1OC0zMCAzMHYxMjAuMTQzaC04LjI5NmMtMTYuNTQyIDAtMzAgMTMuNDU4LTMwIDMwdjEuMzMzYTI5LjgwNCAyOS44MDQgMCAwIDAgNC42MDMgMTUuOTM5Yy03LjM0IDUuNDc0LTEyLjEwMyAxNC4yMjEtMTIuMTAzIDI0LjA2MXYxLjMzM2MwIDkuODQgNC43NjMgMTguNTg3IDEyLjEwMyAyNC4wNjJhMjkuODEgMjkuODEgMCAwIDAtNC42MDMgMTUuOTM4djEuMzMzYzAgMTYuNTQyIDEzLjQ1OCAzMCAzMCAzMGg4LjMyNGMuNDI3IDExLjYzMSA3LjUwMyAyMS41ODcgMTcuNTM0IDI2LjE3Ny45MzEgMTAuNTAzIDQuMDg0IDMwLjE4NyAxNC43NjggNDUuNTM3YTkuOTg4IDkuOTg4IDAgMCAwIDguMjE2IDQuMjg4IDkuOTU4IDkuOTU4IDAgMCAwIDUuNzA0LTEuNzkzYzQuNTMzLTMuMTU1IDUuNjUtOS4zODggMi40OTUtMTMuOTIxLTYuNzk4LTkuNzY3LTkuNjAyLTIyLjYwOC0xMC43Ni0zMS40aDgyLjY4NWMuMjcyLjQxNC41NDUuODE4LjgxNSAxLjIxIDMuMTQyIDQuNTQxIDkuMzcyIDUuNjc5IDEzLjkxMyAyLjUzNCA0LjU0Mi0zLjE0MiA1LjY3Ny05LjM3MSAyLjUzNS0xMy45MTMtMTEuOTE5LTE3LjIyOS04Ljc4Ny0zNS44ODQgOS41ODEtNTcuMDEyIDMuMDY3LTIuNjUyIDEyLjMwNy0xMS43MzIgMTEuMjE3LTI0LjAzMy0uODI4LTkuMzQzLTcuMTA5LTE3LjE5NC0xOC42NjktMjMuMzM3YTkuODU3IDkuODU3IDAgMCAwLTEuMDYxLS40ODZjLS40NjYtLjE4Mi0xMS40MDMtNC41NzktOS43NDEtMTUuNzA2IDEuMDA3LTYuNzM3IDE0Ljc2OC04LjI3MyAyMy43NjYtNy42NjYgMjMuMTU2IDEuNTY5IDM5LjY5OCA3LjgwMyA0Ny44MzYgMTguMDI2IDUuNzUyIDcuMjI1IDcuNjA3IDE2LjYyMyA1LjY3MyAyOC43MzMtLjQxMyAyLjU4NS0uODI0IDUuMjQxLTEuMjQ1IDcuOTU5LTUuNzU2IDM3LjE5NC0xMi45MTkgODMuNDgzLTQ5Ljg3IDExNC42NjEtNC4yMjEgMy41NjEtNC43NTYgOS44Ny0xLjE5NCAxNC4wOTJhOS45OCA5Ljk4IDAgMCAwIDcuNjQ4IDMuNTUxIDkuOTU1IDkuOTU1IDAgMCAwIDYuNDQ0LTIuMzU4YzQyLjY3Mi0zNi4wMDUgNTAuODAyLTg4LjUzMyA1Ni43MzctMTI2Ljg4OC40MTUtMi42ODQuODIxLTUuMzA5IDEuMjI5LTcuODYzIDIuODM0LTE3LjcyMS0uNDU1LTMyLjY0MS05Ljc3Mi00NC4zNDV6bS0yMzIuMzA4IDQyLjYyYy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM2MwLTUuNTE0IDQuNDg2LTEwIDEwLTEwaDE1djIxLjMzM2gtMTV6bS0yLjUtNTIuNjY2YzAtNS41MTQgNC40ODYtMTAgMTAtMTBoNy41djIxLjMzM2gtNy41Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM3ptMTcuNSA5My45OTloLTcuNWMtNS41MTQgMC0xMC00LjQ4Ni0xMC0xMHYtMS4zMzNjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGg3LjV2MjEuMzMzem0zMC43OTYgMjguODg3Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi04LjI3MWg5MS40NTdjLS44NTEgNi42NjgtLjQzNyAxMi43ODcuNzMxIDE4LjI3MWgtODIuMTg4em03OS40ODItMTEzLjY5OGMtMy4xMjQgMjAuOTA2IDEyLjQyNyAzMy4xODQgMjEuNjI1IDM3LjA0IDUuNDQxIDIuOTY4IDcuNTUxIDUuNjQ3IDcuNzAxIDcuMTg4LjIxIDIuMTUtMi41NTMgNS42ODQtNC40NzcgNy4yNTEtLjQ4Mi4zNzgtLjkyOS44LTEuMzM1IDEuMjYxLTYuOTg3IDcuOTM2LTExLjk4MiAxNS41Mi0xNS40MzIgMjIuNjg4aC05Ny41NjRWMzBjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGgxMjMuNzY5YzUuNTE0IDAgMTAgNC40ODYgMTAgMTB2MTM1LjU3OWMtMy4wMzItLjM4MS02LjE1LS42OTQtOS4zODktLjkxNC0yNS4xNTktMS42OTQtNDIuMzcgNy43NDgtNDQuODk4IDI0LjY2NnoiLz48cGF0aCBkPSJNMTc5LjEyOSA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXpNMTcyLjYyOSAxNDIuODZoLTEyLjU2VjEzMC44YTUgNSAwIDEgMC0xMCAwdjE3LjA2MWE1IDUgMCAwIDAgNSA1aDE3LjU2YTUgNSAwIDEgMCAwLTEwLjAwMXpNMjE2LjU2OCA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXptLTUgMjQuMDYxaC0xNC4wNlY5My4xNjdoMTQuMDZ2MTQuMDYxek0yMTEuNjY5IDEyNS45MzZIMTk3LjQxYTUgNSAwIDAgMC01IDV2MTQuMjU3YTUgNSAwIDAgMCA1IDVoMTQuMjU5YTUgNSAwIDAgMCA1LTV2LTE0LjI1N2E1IDUgMCAwIDAtNS01eiIvPjwvc3ZnPg==",qLe=DE+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1OS4wMTggNTkuMDE4IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1OS4wMTggNTkuMDE4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJtNTguNzQxIDU0LjgwOS01Ljk2OS02LjI0NGExMC43NCAxMC43NCAwIDAgMCAyLjgyLTcuMjVjMC01Ljk1My00Ljg0My0xMC43OTYtMTAuNzk2LTEwLjc5NlMzNCAzNS4zNjEgMzQgNDEuMzE0IDM4Ljg0MyA1Mi4xMSA0NC43OTYgNTIuMTFjMi40NDEgMCA0LjY4OC0uODI0IDYuNDk5LTIuMTk2bDYuMDAxIDYuMjc3YS45OTguOTk4IDAgMCAwIDEuNDE0LjAzMiAxIDEgMCAwIDAgLjAzMS0xLjQxNHpNMzYgNDEuMzE0YzAtNC44NSAzLjk0Ni04Ljc5NiA4Ljc5Ni04Ljc5NnM4Ljc5NiAzLjk0NiA4Ljc5NiA4Ljc5Ni0zLjk0NiA4Ljc5Ni04Ljc5NiA4Ljc5NlMzNiA0Ni4xNjQgMzYgNDEuMzE0ek0xMC40MzEgMTYuMDg4YzAgMy4wNyAyLjQ5OCA1LjU2OCA1LjU2OSA1LjU2OHM1LjU2OS0yLjQ5OCA1LjU2OS01LjU2OGMwLTMuMDcxLTIuNDk4LTUuNTY5LTUuNTY5LTUuNTY5cy01LjU2OSAyLjQ5OC01LjU2OSA1LjU2OXptOS4xMzggMGMwIDEuOTY4LTEuNjAyIDMuNTY4LTMuNTY5IDMuNTY4cy0zLjU2OS0xLjYwMS0zLjU2OS0zLjU2OCAxLjYwMi0zLjU2OSAzLjU2OS0zLjU2OSAzLjU2OSAxLjYwMSAzLjU2OSAzLjU2OXoiLz48cGF0aCBkPSJtMzAuODgyIDI4Ljk4NyA5LjE4LTEwLjA1NCAxMS4yNjIgMTAuMzIzYTEgMSAwIDAgMCAxLjM1MS0xLjQ3NWwtMTItMTFhMSAxIDAgMCAwLTEuNDE0LjA2M2wtOS43OTQgMTAuNzI3LTQuNzQzLTQuNzQzYTEuMDAzIDEuMDAzIDAgMCAwLTEuMzY4LS4wNDRMNi4zMzkgMzcuNzY4YTEgMSAwIDEgMCAxLjMyMiAxLjUwMWwxNi4zMTMtMTQuMzYyIDcuMzE5IDcuMzE4YS45OTkuOTk5IDAgMSAwIDEuNDE0LTEuNDE0bC0xLjgyNS0xLjgyNHoiLz48cGF0aCBkPSJNMzAgNDYuNTE4SDJ2LTQyaDU0djI4YTEgMSAwIDEgMCAyIDB2LTI5YTEgMSAwIDAgMC0xLTFIMWExIDEgMCAwIDAtMSAxdjQ0YTEgMSAwIDAgMCAxIDFoMjlhMSAxIDAgMSAwIDAtMnoiLz48L3N2Zz4=",h6=DE+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NjAgNDYwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0NjAgNDYwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJNMjMwIDBDMTAyLjk3NSAwIDAgMTAyLjk3NSAwIDIzMHMxMDIuOTc1IDIzMCAyMzAgMjMwIDIzMC0xMDIuOTc0IDIzMC0yMzBTMzU3LjAyNSAwIDIzMCAwem0zOC4zMzMgMzc3LjM2YzAgOC42NzYtNy4wMzQgMTUuNzEtMTUuNzEgMTUuNzFoLTQzLjEwMWMtOC42NzYgMC0xNS43MS03LjAzNC0xNS43MS0xNS43MVYyMDIuNDc3YzAtOC42NzYgNy4wMzMtMTUuNzEgMTUuNzEtMTUuNzFoNDMuMTAxYzguNjc2IDAgMTUuNzEgNy4wMzMgMTUuNzEgMTUuNzFWMzc3LjM2ek0yMzAgMTU3Yy0yMS41MzkgMC0zOS0xNy40NjEtMzktMzlzMTcuNDYxLTM5IDM5LTM5IDM5IDE3LjQ2MSAzOSAzOS0xNy40NjEgMzktMzkgMzl6Ii8+PC9zdmc+",GLe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAQgAAAEIBarqQRAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAE1SURBVDiNfdI7S0NBEAXgLya1otFgpbYSbISAgpXYi6CmiH9KCAiChaVga6OiWPgfRDQ+0itaGVNosXtluWwcuMzePfM4M3sq8lbHBubwg1dc4m1E/J/N4ghDPOIsfk/4xiEao5KX0McFljN4C9d4QTPXuY99jP3DsIoDPGM6BY5i5yI5R7O4q+ImFkJY2DCh3cAH2klyB+9J1xUMMAG7eCh1a+Mr+k48b5diXrFVwwLuS+BJ9MfR7+G0FHOHhTHhnXNWS87VDF4pcnfQK4Ep7XScNLmPTZgURNKKYENYWDpzW1BhscS1WHS8CDgURFJQrWcoF3c13KKbgg1BYQfy8xZWEzTTw1QZbAoKu8FqJnktdu5hcVSHmchiILzzuaDQvjBzV2m8yohCE1jHfPx/xhU+y4G/D75ELlRJsSYAAAAASUVORK5CYII=",m6=function(){function t(){}return t.createDefault=function(){return{hasPermission:!1,lastUsedCameraId:null}},t}(),KLe=function(){function t(){this.data=m6.createDefault();var s=localStorage.getItem(t.LOCAL_STORAGE_KEY);s?this.data=JSON.parse(s):this.reset()}return t.prototype.hasCameraPermissions=function(){return this.data.hasPermission},t.prototype.getLastUsedCameraId=function(){return this.data.lastUsedCameraId},t.prototype.setHasPermission=function(s){this.data.hasPermission=s,this.flush()},t.prototype.setLastUsedCameraId=function(s){this.data.lastUsedCameraId=s,this.flush()},t.prototype.resetLastUsedCameraId=function(){this.data.lastUsedCameraId=null,this.flush()},t.prototype.reset=function(){this.data=m6.createDefault(),this.flush()},t.prototype.flush=function(){localStorage.setItem(t.LOCAL_STORAGE_KEY,JSON.stringify(this.data))},t.LOCAL_STORAGE_KEY="HTML5_QRCODE_DATA",t}(),YLe=function(){function t(){this.infoDiv=document.createElement("div")}return t.prototype.renderInto=function(s){this.infoDiv.style.position="absolute",this.infoDiv.style.top="10px",this.infoDiv.style.right="10px",this.infoDiv.style.zIndex="2",this.infoDiv.style.display="none",this.infoDiv.style.padding="5pt",this.infoDiv.style.border="1px solid #171717",this.infoDiv.style.fontSize="10pt",this.infoDiv.style.background="rgb(0 0 0 / 69%)",this.infoDiv.style.borderRadius="5px",this.infoDiv.style.textAlign="center",this.infoDiv.style.fontWeight="400",this.infoDiv.style.color="white",this.infoDiv.innerText=r6.poweredBy();var n=document.createElement("a");n.innerText="ScanApp",n.href="https://scanapp.org",n.target="new",n.style.color="white",this.infoDiv.appendChild(n);var a=document.createElement("br"),i=document.createElement("br");this.infoDiv.appendChild(a),this.infoDiv.appendChild(i);var l=document.createElement("a");l.innerText=r6.reportIssues(),l.href="https://github.com/mebjas/html5-qrcode/issues",l.target="new",l.style.color="white",this.infoDiv.appendChild(l),s.appendChild(this.infoDiv)},t.prototype.show=function(){this.infoDiv.style.display="block"},t.prototype.hide=function(){this.infoDiv.style.display="none"},t}(),XLe=function(){function t(s,n){this.isShowingInfoIcon=!0,this.onTapIn=s,this.onTapOut=n,this.infoIcon=document.createElement("img")}return t.prototype.renderInto=function(s){var n=this;this.infoIcon.alt="Info icon",this.infoIcon.src=h6,this.infoIcon.style.position="absolute",this.infoIcon.style.top="4px",this.infoIcon.style.right="4px",this.infoIcon.style.opacity="0.6",this.infoIcon.style.cursor="pointer",this.infoIcon.style.zIndex="2",this.infoIcon.style.width="16px",this.infoIcon.style.height="16px",this.infoIcon.onmouseover=function(a){return n.onHoverIn()},this.infoIcon.onmouseout=function(a){return n.onHoverOut()},this.infoIcon.onclick=function(a){return n.onClick()},s.appendChild(this.infoIcon)},t.prototype.onHoverIn=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="1")},t.prototype.onHoverOut=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="0.6")},t.prototype.onClick=function(){this.isShowingInfoIcon?(this.isShowingInfoIcon=!1,this.onTapIn(),this.infoIcon.src=GLe,this.infoIcon.style.opacity="1"):(this.isShowingInfoIcon=!0,this.onTapOut(),this.infoIcon.src=h6,this.infoIcon.style.opacity="0.6")},t}(),QLe=function(){function t(){var s=this;this.infoDiv=new YLe,this.infoIcon=new XLe(function(){s.infoDiv.show()},function(){s.infoDiv.hide()})}return t.prototype.renderInto=function(s){this.infoDiv.renderInto(s),this.infoIcon.renderInto(s)},t}(),ZLe=function(t,s,n,a){function i(l){return l instanceof n?l:new n(function(o){o(l)})}return new(n||(n=Promise))(function(l,o){function c(h){try{u(a.next(h))}catch(f){o(f)}}function d(h){try{u(a.throw(h))}catch(f){o(f)}}function u(h){h.done?l(h.value):i(h.value).then(c,d)}u((a=a.apply(t,s||[])).next())})},JLe=function(t,s){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,i,l,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(h){return d([u,h])}}function d(u){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(n=0)),n;)try{if(a=1,i&&(l=u[0]&2?i.return:u[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,u[1])).done)return l;switch(i=0,l&&(u=[u[0]&2,l.value]),u[0]){case 0:case 1:l=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,i=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!l||u[1]>l[0]&&u[1]<l[3])){n.label=u[1];break}if(u[0]===6&&n.label<l[1]){n.label=l[1],l=u;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(u);break}l[2]&&n.ops.pop(),n.trys.pop();continue}u=s.call(t,n)}catch(h){u=[6,h],i=0}finally{a=l=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},f6=function(){function t(){}return t.hasPermissions=function(){return ZLe(this,void 0,void 0,function(){var s,n,a,i;return JLe(this,function(l){switch(l.label){case 0:return[4,navigator.mediaDevices.enumerateDevices()];case 1:for(s=l.sent(),n=0,a=s;n<a.length;n++)if(i=a[n],i.kind==="videoinput"&&i.label)return[2,!0];return[2,!1]}})})},t}(),yc=function(){function t(s){this.supportedScanTypes=this.validateAndReturnScanTypes(s)}return t.prototype.getDefaultScanType=function(){return this.supportedScanTypes[0]},t.prototype.hasMoreThanOneScanType=function(){return this.supportedScanTypes.length>1},t.prototype.isCameraScanRequired=function(){for(var s=0,n=this.supportedScanTypes;s<n.length;s++){var a=n[s];if(t.isCameraScanType(a))return!0}return!1},t.isCameraScanType=function(s){return s===ud.SCAN_TYPE_CAMERA},t.isFileScanType=function(s){return s===ud.SCAN_TYPE_FILE},t.prototype.validateAndReturnScanTypes=function(s){if(!s||s.length===0)return cl.DEFAULT_SUPPORTED_SCAN_TYPE;var n=cl.DEFAULT_SUPPORTED_SCAN_TYPE.length;if(s.length>n)throw"Max ".concat(n," values expected for ")+"supportedScanTypes";for(var a=0,i=s;a<i.length;a++){var l=i[a];if(!cl.DEFAULT_SUPPORTED_SCAN_TYPE.includes(l))throw"Unsupported scan type ".concat(l)}return s},t}(),oi=function(){function t(){}return t.ALL_ELEMENT_CLASS="html5-qrcode-element",t.CAMERA_PERMISSION_BUTTON_ID="html5-qrcode-button-camera-permission",t.CAMERA_START_BUTTON_ID="html5-qrcode-button-camera-start",t.CAMERA_STOP_BUTTON_ID="html5-qrcode-button-camera-stop",t.TORCH_BUTTON_ID="html5-qrcode-button-torch",t.CAMERA_SELECTION_SELECT_ID="html5-qrcode-select-camera",t.FILE_SELECTION_BUTTON_ID="html5-qrcode-button-file-selection",t.ZOOM_SLIDER_ID="html5-qrcode-input-range-zoom",t.SCAN_TYPE_CHANGE_ANCHOR_ID="html5-qrcode-anchor-scan-type-change",t.TORCH_BUTTON_CLASS_TORCH_ON="html5-qrcode-button-torch-on",t.TORCH_BUTTON_CLASS_TORCH_OFF="html5-qrcode-button-torch-off",t}(),Do=function(){function t(){}return t.createElement=function(s,n){var a=document.createElement(s);return a.id=n,a.classList.add(oi.ALL_ELEMENT_CLASS),s==="button"&&a.setAttribute("type","button"),a},t}(),YK=function(t,s,n,a){function i(l){return l instanceof n?l:new n(function(o){o(l)})}return new(n||(n=Promise))(function(l,o){function c(h){try{u(a.next(h))}catch(f){o(f)}}function d(h){try{u(a.throw(h))}catch(f){o(f)}}function u(h){h.done?l(h.value):i(h.value).then(c,d)}u((a=a.apply(t,s||[])).next())})},XK=function(t,s){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,i,l,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(h){return d([u,h])}}function d(u){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(n=0)),n;)try{if(a=1,i&&(l=u[0]&2?i.return:u[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,u[1])).done)return l;switch(i=0,l&&(u=[u[0]&2,l.value]),u[0]){case 0:case 1:l=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,i=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!l||u[1]>l[0]&&u[1]<l[3])){n.label=u[1];break}if(u[0]===6&&n.label<l[1]){n.label=l[1],l=u;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(u);break}l[2]&&n.ops.pop(),n.trys.pop();continue}u=s.call(t,n)}catch(h){u=[6,h],i=0}finally{a=l=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},p6=function(){function t(s,n,a){this.isTorchOn=!1,this.torchCapability=s,this.buttonController=n,this.onTorchActionFailureCallback=a}return t.prototype.isTorchEnabled=function(){return this.isTorchOn},t.prototype.flipState=function(){return YK(this,void 0,void 0,function(){var s,n;return XK(this,function(a){switch(a.label){case 0:this.buttonController.disable(),s=!this.isTorchOn,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.torchCapability.apply(s)];case 2:return a.sent(),this.updateUiBasedOnLatestSettings(this.torchCapability.value(),s),[3,4];case 3:return n=a.sent(),this.propagateFailure(s,n),this.buttonController.enable(),[3,4];case 4:return[2]}})})},t.prototype.updateUiBasedOnLatestSettings=function(s,n){s===n?(this.buttonController.setText(n?js.torchOffButton():js.torchOnButton()),this.isTorchOn=n):this.propagateFailure(n),this.buttonController.enable()},t.prototype.propagateFailure=function(s,n){var a=s?js.torchOnFailedMessage():js.torchOffFailedMessage();n&&(a+="; Error = "+n),this.onTorchActionFailureCallback(a)},t.prototype.reset=function(){this.isTorchOn=!1},t}(),e7e=function(){function t(s,n){this.onTorchActionFailureCallback=n,this.torchButton=Do.createElement("button",oi.TORCH_BUTTON_ID),this.torchController=new p6(s,this,n)}return t.prototype.render=function(s,n){var a=this;this.torchButton.innerText=js.torchOnButton(),this.torchButton.style.display=n.display,this.torchButton.style.marginLeft=n.marginLeft;var i=this;this.torchButton.addEventListener("click",function(l){return YK(a,void 0,void 0,function(){return XK(this,function(o){switch(o.label){case 0:return[4,i.torchController.flipState()];case 1:return o.sent(),i.torchController.isTorchEnabled()?(i.torchButton.classList.remove(oi.TORCH_BUTTON_CLASS_TORCH_OFF),i.torchButton.classList.add(oi.TORCH_BUTTON_CLASS_TORCH_ON)):(i.torchButton.classList.remove(oi.TORCH_BUTTON_CLASS_TORCH_ON),i.torchButton.classList.add(oi.TORCH_BUTTON_CLASS_TORCH_OFF)),[2]}})})}),s.appendChild(this.torchButton)},t.prototype.updateTorchCapability=function(s){this.torchController=new p6(s,this,this.onTorchActionFailureCallback)},t.prototype.getTorchButton=function(){return this.torchButton},t.prototype.hide=function(){this.torchButton.style.display="none"},t.prototype.show=function(){this.torchButton.style.display="inline-block"},t.prototype.disable=function(){this.torchButton.disabled=!0},t.prototype.enable=function(){this.torchButton.disabled=!1},t.prototype.setText=function(s){this.torchButton.innerText=s},t.prototype.reset=function(){this.torchButton.innerText=js.torchOnButton(),this.torchController.reset()},t.create=function(s,n,a,i){var l=new t(n,i);return l.render(s,a),l},t}(),t7e=function(){function t(s,n,a){this.fileBasedScanRegion=this.createFileBasedScanRegion(),this.fileBasedScanRegion.style.display=n?"block":"none",s.appendChild(this.fileBasedScanRegion);var i=document.createElement("label");i.setAttribute("for",this.getFileScanInputId()),i.style.display="inline-block",this.fileBasedScanRegion.appendChild(i),this.fileSelectionButton=Do.createElement("button",oi.FILE_SELECTION_BUTTON_ID),this.setInitialValueToButton(),this.fileSelectionButton.addEventListener("click",function(c){i.click()}),i.append(this.fileSelectionButton),this.fileScanInput=Do.createElement("input",this.getFileScanInputId()),this.fileScanInput.type="file",this.fileScanInput.accept="image/*",this.fileScanInput.style.display="none",i.appendChild(this.fileScanInput);var l=this;this.fileScanInput.addEventListener("change",function(c){if(!(c==null||c.target==null)){var d=c.target;if(!(d.files&&d.files.length===0)){var u=d.files,h=u[0],f=h.name;l.setImageNameToButton(f),a(h)}}});var o=this.createDragAndDropMessage();this.fileBasedScanRegion.appendChild(o),this.fileBasedScanRegion.addEventListener("dragenter",function(c){l.fileBasedScanRegion.style.border=l.fileBasedScanRegionActiveBorder(),c.stopPropagation(),c.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragleave",function(c){l.fileBasedScanRegion.style.border=l.fileBasedScanRegionDefaultBorder(),c.stopPropagation(),c.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragover",function(c){l.fileBasedScanRegion.style.border=l.fileBasedScanRegionActiveBorder(),c.stopPropagation(),c.preventDefault()}),this.fileBasedScanRegion.addEventListener("drop",function(c){c.stopPropagation(),c.preventDefault(),l.fileBasedScanRegion.style.border=l.fileBasedScanRegionDefaultBorder();var d=c.dataTransfer;if(d){var u=d.files;if(!u||u.length===0)return;for(var h=!1,f=0;f<u.length;++f){var x=u.item(f);if(x){var b=/image.*/;if(x.type.match(b)){h=!0;var v=x.name;l.setImageNameToButton(v),a(x),o.innerText=js.dragAndDropMessage();break}}}h||(o.innerText=js.dragAndDropMessageOnlyImages())}})}return t.prototype.hide=function(){this.fileBasedScanRegion.style.display="none",this.fileScanInput.disabled=!0},t.prototype.show=function(){this.fileBasedScanRegion.style.display="block",this.fileScanInput.disabled=!1},t.prototype.isShowing=function(){return this.fileBasedScanRegion.style.display==="block"},t.prototype.resetValue=function(){this.fileScanInput.value="",this.setInitialValueToButton()},t.prototype.createFileBasedScanRegion=function(){var s=document.createElement("div");return s.style.textAlign="center",s.style.margin="auto",s.style.width="80%",s.style.maxWidth="600px",s.style.border=this.fileBasedScanRegionDefaultBorder(),s.style.padding="10px",s.style.marginBottom="10px",s},t.prototype.fileBasedScanRegionDefaultBorder=function(){return"6px dashed #ebebeb"},t.prototype.fileBasedScanRegionActiveBorder=function(){return"6px dashed rgb(153 151 151)"},t.prototype.createDragAndDropMessage=function(){var s=document.createElement("div");return s.innerText=js.dragAndDropMessage(),s.style.fontWeight="400",s},t.prototype.setImageNameToButton=function(s){var n=20;if(s.length>n){var a=s.substring(0,8),i=s.length,l=s.substring(i-8,i);s="".concat(a,"....").concat(l)}var o=js.fileSelectionChooseAnother()+" - "+s;this.fileSelectionButton.innerText=o},t.prototype.setInitialValueToButton=function(){var s=js.fileSelectionChooseImage()+" - "+js.fileSelectionNoImageSelected();this.fileSelectionButton.innerText=s},t.prototype.getFileScanInputId=function(){return"html5-qrcode-private-filescan-input"},t.create=function(s,n,a){var i=new t(s,n,a);return i},t}(),s7e=function(){function t(s){this.selectElement=Do.createElement("select",oi.CAMERA_SELECTION_SELECT_ID),this.cameras=s,this.options=[]}return t.prototype.render=function(s){var n=document.createElement("span");n.style.marginRight="10px";var a=this.cameras.length;if(a===0)throw new Error("No cameras found");if(a===1)n.style.display="none";else{var i=js.selectCamera();n.innerText="".concat(i," (").concat(this.cameras.length,")  ")}for(var l=1,o=0,c=this.cameras;o<c.length;o++){var d=c[o],u=d.id,h=d.label==null?u:d.label;(!h||h==="")&&(h=[js.anonymousCameraPrefix(),l++].join(" "));var f=document.createElement("option");f.value=u,f.innerText=h,this.options.push(f),this.selectElement.appendChild(f)}n.appendChild(this.selectElement),s.appendChild(n)},t.prototype.disable=function(){this.selectElement.disabled=!0},t.prototype.isDisabled=function(){return this.selectElement.disabled===!0},t.prototype.enable=function(){this.selectElement.disabled=!1},t.prototype.getValue=function(){return this.selectElement.value},t.prototype.hasValue=function(s){for(var n=0,a=this.options;n<a.length;n++){var i=a[n];if(i.value===s)return!0}return!1},t.prototype.setValue=function(s){if(!this.hasValue(s))throw new Error("".concat(s," is not present in the camera list."));this.selectElement.value=s},t.prototype.hasSingleItem=function(){return this.cameras.length===1},t.prototype.numCameras=function(){return this.cameras.length},t.create=function(s,n){var a=new t(n);return a.render(s),a},t}(),n7e=function(){function t(){this.onChangeCallback=null,this.zoomElementContainer=document.createElement("div"),this.rangeInput=Do.createElement("input",oi.ZOOM_SLIDER_ID),this.rangeInput.type="range",this.rangeText=document.createElement("span"),this.rangeInput.min="1",this.rangeInput.max="5",this.rangeInput.value="1",this.rangeInput.step="0.1"}return t.prototype.render=function(s,n){this.zoomElementContainer.style.display=n?"block":"none",this.zoomElementContainer.style.padding="5px 10px",this.zoomElementContainer.style.textAlign="center",s.appendChild(this.zoomElementContainer),this.rangeInput.style.display="inline-block",this.rangeInput.style.width="50%",this.rangeInput.style.height="5px",this.rangeInput.style.background="#d3d3d3",this.rangeInput.style.outline="none",this.rangeInput.style.opacity="0.7";var a=js.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(a),this.rangeText.style.marginRight="10px";var i=this;this.rangeInput.addEventListener("input",function(){return i.onValueChange()}),this.rangeInput.addEventListener("change",function(){return i.onValueChange()}),this.zoomElementContainer.appendChild(this.rangeInput),this.zoomElementContainer.appendChild(this.rangeText)},t.prototype.onValueChange=function(){var s=js.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(s),this.onChangeCallback&&this.onChangeCallback(parseFloat(this.rangeInput.value))},t.prototype.setValues=function(s,n,a,i){this.rangeInput.min=s.toString(),this.rangeInput.max=n.toString(),this.rangeInput.step=i.toString(),this.rangeInput.value=a.toString(),this.onValueChange()},t.prototype.show=function(){this.zoomElementContainer.style.display="block"},t.prototype.hide=function(){this.zoomElementContainer.style.display="none"},t.prototype.setOnCameraZoomValueChangeCallback=function(s){this.onChangeCallback=s},t.prototype.removeOnCameraZoomValueChangeCallback=function(){this.onChangeCallback=null},t.create=function(s,n){var a=new t;return a.render(s,n),a},t}(),ti;(function(t){t[t.STATUS_DEFAULT=0]="STATUS_DEFAULT",t[t.STATUS_SUCCESS=1]="STATUS_SUCCESS",t[t.STATUS_WARNING=2]="STATUS_WARNING",t[t.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(ti||(ti={}));function r7e(t){return{fps:t.fps,qrbox:t.qrbox,aspectRatio:t.aspectRatio,disableFlip:t.disableFlip,videoConstraints:t.videoConstraints}}function a7e(t,s){return{formatsToSupport:t.formatsToSupport,useBarCodeDetectorIfSupported:t.useBarCodeDetectorIfSupported,experimentalFeatures:t.experimentalFeatures,verbose:s}}var i7e=function(){function t(s,n,a){if(this.lastMatchFound=null,this.cameraScanImage=null,this.fileScanImage=null,this.fileSelectionUi=null,this.elementId=s,this.config=this.createConfig(n),this.verbose=a===!0,!document.getElementById(s))throw"HTML Element with id=".concat(s," not found");this.scanTypeSelector=new yc(this.config.supportedScanTypes),this.currentScanType=this.scanTypeSelector.getDefaultScanType(),this.sectionSwapAllowed=!0,this.logger=new qK(this.verbose),this.persistedDataManager=new KLe,n.rememberLastUsedCamera!==!0&&this.persistedDataManager.reset()}return t.prototype.render=function(s,n){var a=this;this.lastMatchFound=null,this.qrCodeSuccessCallback=function(l,o){if(s)s(l,o);else{if(a.lastMatchFound===l)return;a.lastMatchFound=l,a.setHeaderMessage(js.lastMatch(l),ti.STATUS_SUCCESS)}},this.qrCodeErrorCallback=function(l,o){n&&n(l,o)};var i=document.getElementById(this.elementId);if(!i)throw"HTML Element with id=".concat(this.elementId," not found");i.innerHTML="",this.createBasicLayout(i),this.html5Qrcode=new u6(this.getScanRegionId(),a7e(this.config,this.verbose))},t.prototype.pause=function(s){(Wl(s)||s!==!0)&&(s=!1),this.getHtml5QrcodeOrFail().pause(s)},t.prototype.resume=function(){this.getHtml5QrcodeOrFail().resume()},t.prototype.getState=function(){return this.getHtml5QrcodeOrFail().getState()},t.prototype.clear=function(){var s=this,n=function(){var a=document.getElementById(s.elementId);a&&(a.innerHTML="",s.resetBasicLayout(a))};return this.html5Qrcode?new Promise(function(a,i){if(!s.html5Qrcode){a();return}s.html5Qrcode.isScanning?s.html5Qrcode.stop().then(function(l){if(!s.html5Qrcode){a();return}s.html5Qrcode.clear(),n(),a()}).catch(function(l){s.verbose&&s.logger.logError("Unable to stop qrcode scanner",l),i(l)}):(s.html5Qrcode.clear(),n(),a())}):Promise.resolve()},t.prototype.getRunningTrackCapabilities=function(){return this.getHtml5QrcodeOrFail().getRunningTrackCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getHtml5QrcodeOrFail().getRunningTrackSettings()},t.prototype.applyVideoConstraints=function(s){return this.getHtml5QrcodeOrFail().applyVideoConstraints(s)},t.prototype.getHtml5QrcodeOrFail=function(){if(!this.html5Qrcode)throw"Code scanner not initialized.";return this.html5Qrcode},t.prototype.createConfig=function(s){return s?(s.fps||(s.fps=cl.SCAN_DEFAULT_FPS),s.rememberLastUsedCamera!==!cl.DEFAULT_REMEMBER_LAST_CAMERA_USED&&(s.rememberLastUsedCamera=cl.DEFAULT_REMEMBER_LAST_CAMERA_USED),s.supportedScanTypes||(s.supportedScanTypes=cl.DEFAULT_SUPPORTED_SCAN_TYPE),s):{fps:cl.SCAN_DEFAULT_FPS,rememberLastUsedCamera:cl.DEFAULT_REMEMBER_LAST_CAMERA_USED,supportedScanTypes:cl.DEFAULT_SUPPORTED_SCAN_TYPE}},t.prototype.createBasicLayout=function(s){s.style.position="relative",s.style.padding="0px",s.style.border="1px solid silver",this.createHeader(s);var n=document.createElement("div"),a=this.getScanRegionId();n.id=a,n.style.width="100%",n.style.minHeight="100px",n.style.textAlign="center",s.appendChild(n),yc.isCameraScanType(this.currentScanType)?this.insertCameraScanImageToScanRegion():this.insertFileScanImageToScanRegion();var i=document.createElement("div"),l=this.getDashboardId();i.id=l,i.style.width="100%",s.appendChild(i),this.setupInitialDashboard(i)},t.prototype.resetBasicLayout=function(s){s.style.border="none"},t.prototype.setupInitialDashboard=function(s){this.createSection(s),this.createSectionControlPanel(),this.scanTypeSelector.hasMoreThanOneScanType()&&this.createSectionSwap()},t.prototype.createHeader=function(s){var n=document.createElement("div");n.style.textAlign="left",n.style.margin="0px",s.appendChild(n);var a=new QLe;a.renderInto(n);var i=document.createElement("div");i.id=this.getHeaderMessageContainerId(),i.style.display="none",i.style.textAlign="center",i.style.fontSize="14px",i.style.padding="2px 10px",i.style.margin="4px",i.style.borderTop="1px solid #f6f6f6",n.appendChild(i)},t.prototype.createSection=function(s){var n=document.createElement("div");n.id=this.getDashboardSectionId(),n.style.width="100%",n.style.padding="10px 0px 10px 0px",n.style.textAlign="left",s.appendChild(n)},t.prototype.createCameraListUi=function(s,n,a){var i=this;i.showHideScanTypeSwapLink(!1),i.setHeaderMessage(js.cameraPermissionRequesting());var l=function(){a||i.createPermissionButton(s,n)};u6.getCameras().then(function(o){i.persistedDataManager.setHasPermission(!0),i.showHideScanTypeSwapLink(!0),i.resetHeaderMessage(),o&&o.length>0?(s.removeChild(n),i.renderCameraSelection(o)):(i.setHeaderMessage(js.noCameraFound(),ti.STATUS_WARNING),l())}).catch(function(o){i.persistedDataManager.setHasPermission(!1),a?a.disabled=!1:l(),i.setHeaderMessage(o,ti.STATUS_WARNING),i.showHideScanTypeSwapLink(!0)})},t.prototype.createPermissionButton=function(s,n){var a=this,i=Do.createElement("button",this.getCameraPermissionButtonId());i.innerText=js.cameraPermissionTitle(),i.addEventListener("click",function(){i.disabled=!0,a.createCameraListUi(s,n,i)}),n.appendChild(i)},t.prototype.createPermissionsUi=function(s,n){var a=this;if(yc.isCameraScanType(this.currentScanType)&&this.persistedDataManager.hasCameraPermissions()){f6.hasPermissions().then(function(i){i?a.createCameraListUi(s,n):(a.persistedDataManager.setHasPermission(!1),a.createPermissionButton(s,n))}).catch(function(i){a.persistedDataManager.setHasPermission(!1),a.createPermissionButton(s,n)});return}this.createPermissionButton(s,n)},t.prototype.createSectionControlPanel=function(){var s=document.getElementById(this.getDashboardSectionId()),n=document.createElement("div");s.appendChild(n);var a=document.createElement("div");a.id=this.getDashboardSectionCameraScanRegionId(),a.style.display=yc.isCameraScanType(this.currentScanType)?"block":"none",n.appendChild(a);var i=document.createElement("div");i.style.textAlign="center",a.appendChild(i),this.scanTypeSelector.isCameraScanRequired()&&this.createPermissionsUi(a,i),this.renderFileScanUi(n)},t.prototype.renderFileScanUi=function(s){var n=yc.isFileScanType(this.currentScanType),a=this,i=function(l){if(!a.html5Qrcode)throw"html5Qrcode not defined";yc.isFileScanType(a.currentScanType)&&(a.setHeaderMessage(js.loadingImage()),a.html5Qrcode.scanFileV2(l,!0).then(function(o){a.resetHeaderMessage(),a.qrCodeSuccessCallback(o.decodedText,o)}).catch(function(o){a.setHeaderMessage(o,ti.STATUS_WARNING),a.qrCodeErrorCallback(o,WK.createFrom(o))}))};this.fileSelectionUi=t7e.create(s,n,i)},t.prototype.renderCameraSelection=function(s){var n=this,a=this,i=document.getElementById(this.getDashboardSectionCameraScanRegionId());i.style.textAlign="center";var l=n7e.create(i,!1),o=function(w){var _=w.zoomFeature();if(_.isSupported()){l.setOnCameraZoomValueChangeCallback(function(k){_.apply(k)});var S=1;n.config.defaultZoomValueIfSupported&&(S=n.config.defaultZoomValueIfSupported),S=_Le(S,_.min(),_.max()),l.setValues(_.min(),_.max(),S,_.step()),l.show()}},c=s7e.create(i,s),d=document.createElement("span"),u=Do.createElement("button",oi.CAMERA_START_BUTTON_ID);u.innerText=js.scanButtonStartScanningText(),d.appendChild(u);var h=Do.createElement("button",oi.CAMERA_STOP_BUTTON_ID);h.innerText=js.scanButtonStopScanningText(),h.style.display="none",h.disabled=!0,d.appendChild(h);var f,x=function(w){if(!w.torchFeature().isSupported()){f&&f.hide();return}f?f.updateTorchCapability(w.torchFeature()):f=e7e.create(d,w.torchFeature(),{display:"none",marginLeft:"5px"},function(_){a.setHeaderMessage(_,ti.STATUS_WARNING)}),f.show()};i.appendChild(d);var b=function(w){w||(u.style.display="none"),u.innerText=js.scanButtonStartScanningText(),u.style.opacity="1",u.disabled=!1,w&&(u.style.display="inline-block")};if(u.addEventListener("click",function(w){u.innerText=js.scanButtonScanningStarting(),c.disable(),u.disabled=!0,u.style.opacity="0.5",n.scanTypeSelector.hasMoreThanOneScanType()&&a.showHideScanTypeSwapLink(!1),a.resetHeaderMessage();var _=c.getValue();a.persistedDataManager.setLastUsedCameraId(_),a.html5Qrcode.start(_,r7e(a.config),a.qrCodeSuccessCallback,a.qrCodeErrorCallback).then(function(S){h.disabled=!1,h.style.display="inline-block",b(!1);var k=a.html5Qrcode.getRunningTrackCameraCapabilities();n.config.showTorchButtonIfSupported===!0&&x(k),n.config.showZoomSliderIfSupported===!0&&o(k)}).catch(function(S){a.showHideScanTypeSwapLink(!0),c.enable(),b(!0),a.setHeaderMessage(S,ti.STATUS_WARNING)})}),c.hasSingleItem()&&u.click(),h.addEventListener("click",function(w){if(!a.html5Qrcode)throw"html5Qrcode not defined";h.disabled=!0,a.html5Qrcode.stop().then(function(_){n.scanTypeSelector.hasMoreThanOneScanType()&&a.showHideScanTypeSwapLink(!0),c.enable(),u.disabled=!1,h.style.display="none",u.style.display="inline-block",f&&(f.reset(),f.hide()),l.removeOnCameraZoomValueChangeCallback(),l.hide(),a.insertCameraScanImageToScanRegion()}).catch(function(_){h.disabled=!1,a.setHeaderMessage(_,ti.STATUS_WARNING)})}),a.persistedDataManager.getLastUsedCameraId()){var v=a.persistedDataManager.getLastUsedCameraId();c.hasValue(v)?(c.setValue(v),u.click()):a.persistedDataManager.resetLastUsedCameraId()}},t.prototype.createSectionSwap=function(){var s=this,n=js.textIfCameraScanSelected(),a=js.textIfFileScanSelected(),i=document.getElementById(this.getDashboardSectionId()),l=document.createElement("div");l.style.textAlign="center";var o=Do.createElement("span",this.getDashboardSectionSwapLinkId());o.style.textDecoration="underline",o.style.cursor="pointer",o.innerText=yc.isCameraScanType(this.currentScanType)?n:a,o.addEventListener("click",function(){if(!s.sectionSwapAllowed){s.verbose&&s.logger.logError("Section swap called when not allowed");return}s.resetHeaderMessage(),s.fileSelectionUi.resetValue(),s.sectionSwapAllowed=!1,yc.isCameraScanType(s.currentScanType)?(s.clearScanRegion(),s.getCameraScanRegion().style.display="none",s.fileSelectionUi.show(),o.innerText=a,s.currentScanType=ud.SCAN_TYPE_FILE,s.insertFileScanImageToScanRegion()):(s.clearScanRegion(),s.getCameraScanRegion().style.display="block",s.fileSelectionUi.hide(),o.innerText=n,s.currentScanType=ud.SCAN_TYPE_CAMERA,s.insertCameraScanImageToScanRegion(),s.startCameraScanIfPermissionExistsOnSwap()),s.sectionSwapAllowed=!0}),l.appendChild(o),i.appendChild(l)},t.prototype.startCameraScanIfPermissionExistsOnSwap=function(){var s=this,n=this;if(this.persistedDataManager.hasCameraPermissions()){f6.hasPermissions().then(function(a){if(a){var i=document.getElementById(n.getCameraPermissionButtonId());if(!i)throw s.logger.logError("Permission button not found, fail;"),"Permission button not found";i.click()}else n.persistedDataManager.setHasPermission(!1)}).catch(function(a){n.persistedDataManager.setHasPermission(!1)});return}},t.prototype.resetHeaderMessage=function(){var s=document.getElementById(this.getHeaderMessageContainerId());s.style.display="none"},t.prototype.setHeaderMessage=function(s,n){n||(n=ti.STATUS_DEFAULT);var a=this.getHeaderMessageDiv();switch(a.innerText=s,a.style.display="block",n){case ti.STATUS_SUCCESS:a.style.background="rgba(106, 175, 80, 0.26)",a.style.color="#477735";break;case ti.STATUS_WARNING:a.style.background="rgba(203, 36, 49, 0.14)",a.style.color="#cb2431";break;case ti.STATUS_DEFAULT:default:a.style.background="rgba(0, 0, 0, 0)",a.style.color="rgb(17, 17, 17)";break}},t.prototype.showHideScanTypeSwapLink=function(s){this.scanTypeSelector.hasMoreThanOneScanType()&&(s!==!0&&(s=!1),this.sectionSwapAllowed=s,this.getDashboardSectionSwapLink().style.display=s?"inline-block":"none")},t.prototype.insertCameraScanImageToScanRegion=function(){var s=this,n=document.getElementById(this.getScanRegionId());if(this.cameraScanImage){n.innerHTML="<br>",n.appendChild(this.cameraScanImage);return}this.cameraScanImage=new Image,this.cameraScanImage.onload=function(a){n.innerHTML="<br>",n.appendChild(s.cameraScanImage)},this.cameraScanImage.width=64,this.cameraScanImage.style.opacity="0.8",this.cameraScanImage.src=WLe,this.cameraScanImage.alt=js.cameraScanAltText()},t.prototype.insertFileScanImageToScanRegion=function(){var s=this,n=document.getElementById(this.getScanRegionId());if(this.fileScanImage){n.innerHTML="<br>",n.appendChild(this.fileScanImage);return}this.fileScanImage=new Image,this.fileScanImage.onload=function(a){n.innerHTML="<br>",n.appendChild(s.fileScanImage)},this.fileScanImage.width=64,this.fileScanImage.style.opacity="0.8",this.fileScanImage.src=qLe,this.fileScanImage.alt=js.fileScanAltText()},t.prototype.clearScanRegion=function(){var s=document.getElementById(this.getScanRegionId());s.innerHTML=""},t.prototype.getDashboardSectionId=function(){return"".concat(this.elementId,"__dashboard_section")},t.prototype.getDashboardSectionCameraScanRegionId=function(){return"".concat(this.elementId,"__dashboard_section_csr")},t.prototype.getDashboardSectionSwapLinkId=function(){return oi.SCAN_TYPE_CHANGE_ANCHOR_ID},t.prototype.getScanRegionId=function(){return"".concat(this.elementId,"__scan_region")},t.prototype.getDashboardId=function(){return"".concat(this.elementId,"__dashboard")},t.prototype.getHeaderMessageContainerId=function(){return"".concat(this.elementId,"__header_message")},t.prototype.getCameraPermissionButtonId=function(){return oi.CAMERA_PERMISSION_BUTTON_ID},t.prototype.getCameraScanRegion=function(){return document.getElementById(this.getDashboardSectionCameraScanRegionId())},t.prototype.getDashboardSectionSwapLink=function(){return document.getElementById(this.getDashboardSectionSwapLinkId())},t.prototype.getHeaderMessageDiv=function(){return document.getElementById(this.getHeaderMessageContainerId())},t}();function l7e(){const[t,s]=y.useState(""),[n,a]=y.useState(!1),[i,l]=y.useState(null),[o,c]=y.useState(""),[d,u]=y.useState(null),[h,f]=y.useState(!1),x=y.useRef(null),b=y.useCallback(async A=>{if(!A){u(null);return}try{const T=await J.get(`/inventory/items/${A.id}/qr`,{responseType:"blob"}),P=URL.createObjectURL(T.data);u(O=>(O&&URL.revokeObjectURL(O),P))}catch(T){console.error(T),u(null),se.error("Unable to load QR image")}},[]),v=y.useCallback(async A=>{var P,O;const T=(A||"").trim();if(c(""),l(null),u(null),!T){c("Please scan or enter a QR number.");return}try{a(!0);const D=await Xfe(T);l(D.data),await b(D.data)}catch(D){const I=((O=(P=D==null?void 0:D.response)==null?void 0:P.data)==null?void 0:O.detail)||(D==null?void 0:D.message)||"No medicine found for this QR";c(I),se.error(I)}finally{a(!1)}},[b]),w=y.useCallback(async A=>{A.preventDefault(),await v(t)},[t,v]),_=y.useCallback(async A=>{s(A),se.success(`QR scanned: ${A}`),f(!1),await v(A)},[v]),S=y.useCallback(()=>{},[]);y.useEffect(()=>{if(!h){x.current&&(x.current.clear().catch(()=>{}),x.current=null);return}const A=new i7e("qr-reader",{fps:10,qrbox:250},!1);return x.current=A,A.render(_,S),()=>{x.current&&(x.current.clear().catch(()=>{}),x.current=null)}},[h,_,S]);const k=y.useCallback(async()=>{if(i)try{const T=(await J.get(`/inventory/items/${i.id}/qr`,{responseType:"blob"})).data,P=URL.createObjectURL(T),O=document.createElement("a");O.href=P,O.download=`${i.code||"medicine"}_qr.png`,document.body.appendChild(O),O.click(),O.remove(),URL.revokeObjectURL(P)}catch(A){const T=(A==null?void 0:A.message)||"Unable to download QR image";se.error(T)}},[i]);return y.useEffect(()=>()=>{d&&URL.revokeObjectURL(d)},[d]),r.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-4 py-6 lg:px-8",children:r.jsxs("div",{className:"mx-auto flex max-w-5xl flex-col gap-6",children:[r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{children:[r.jsxs("h1",{className:"flex items-center gap-2 text-2xl font-semibold tracking-tight text-slate-900",children:[r.jsx(Tw,{className:"h-6 w-6 text-slate-700"}),"Medicine QR Lookup"]}),r.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Scan medicine QR code with camera / scanner or enter QR number to instantly fetch medicine details."})]}),r.jsxs(Ze,{className:"flex items-center gap-1 rounded-full bg-slate-900 px-3 py-1 text-xs font-medium text-white",children:[r.jsx(t1,{className:"h-3 w-3"}),"Live QR search"]})]}),r.jsxs(Ve,{className:"rounded-2xl border-slate-200 shadow-sm",children:[r.jsxs(rt,{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{children:[r.jsx(ot,{className:"text-base font-semibold text-slate-900",children:"Scan or Enter QR Number"}),r.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Keep the cursor inside the QR box and scan with your scanner or use the camera scanner below."})]}),r.jsx(Te,{type:"button",variant:h?"outline":"default",size:"sm",onClick:()=>f(A=>!A),className:"inline-flex items-center gap-2",children:h?r.jsxs(r.Fragment,{children:[r.jsx(Qte,{className:"h-4 w-4"}),"Stop Camera"]}):r.jsxs(r.Fragment,{children:[r.jsx(M4,{className:"h-4 w-4"}),"Use Camera Scanner"]})})]}),r.jsxs(He,{className:"space-y-4",children:[r.jsxs("form",{onSubmit:w,className:"space-y-3",children:[r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsx("label",{className:"text-xs font-medium text-slate-600",children:"QR Number"}),r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx(Tw,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),r.jsx(Se,{autoFocus:!0,value:t,onChange:A=>s(A.target.value),placeholder:"e.g., MED-000123 or scan with your QR scanner...",className:"pl-9 text-sm"})]}),r.jsx(Te,{type:"submit",className:"w-full sm:w-auto",disabled:n,children:n?r.jsxs("span",{className:"inline-flex items-center gap-2",children:[r.jsx(ns,{className:"h-4 w-4 animate-spin"}),"Searching..."]}):r.jsxs("span",{className:"inline-flex items-center gap-2",children:[r.jsx(o7e,{}),"Search"]})})]})]}),r.jsxs("div",{className:"flex items-start gap-2 text-xs text-slate-500",children:[r.jsx(Gp,{className:"mt-0.5 h-3 w-3"}),r.jsxs("p",{children:["For USB QR scanners: focus the box and scan. Most scanners type the code and press",r.jsx("span",{className:"mx-1 rounded bg-slate-100 px-1 py-0.5 font-semibold",children:"Enter"}),"automatically."]})]})]}),h&&r.jsxs("div",{className:"mt-3 rounded-2xl border border-dashed border-slate-200 bg-slate-100/60 px-3 py-3",children:[r.jsxs("p",{className:"mb-2 flex items-center gap-2 text-xs text-slate-600",children:[r.jsx(M4,{className:"h-3 w-3"}),"Point your medicine QR code at the camera. Once decoded, the medicine will load automatically."]}),r.jsx("div",{id:"qr-reader",className:"h-[280px] w-full overflow-hidden rounded-xl bg-black/90"})]}),o&&r.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-red-100 bg-red-50 px-3 py-2 text-xs text-red-700",children:[r.jsx(Gp,{className:"h-3 w-3"}),o]})]})]}),i&&r.jsxs(Ve,{className:"rounded-2xl border-slate-200 shadow-sm",children:[r.jsxs(rt,{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs(ot,{className:"flex items-center gap-2 text-lg",children:[r.jsx(dr,{className:"h-5 w-5 text-slate-700"}),r.jsx("span",{children:i.name})]}),r.jsxs("p",{className:"text-xs text-slate-500",children:["Code:"," ",r.jsx("span",{className:"font-mono text-slate-700",children:i.code}),i.qr_number&&r.jsxs(r.Fragment,{children:["  ","QR:"," ",r.jsx("span",{className:"font-mono text-slate-700",children:i.qr_number})]})]}),i.generic_name&&r.jsxs("p",{className:"text-xs text-slate-500",children:["Generic: ",i.generic_name]})]}),d&&r.jsxs("div",{className:"flex flex-col items-center gap-2",children:[r.jsx("div",{className:"rounded-xl border border-slate-200 bg-white p-2",children:r.jsx("img",{src:d,alt:`QR for ${i.name}`,className:"h-28 w-28 object-contain"})}),r.jsxs(Te,{type:"button",variant:"outline",size:"sm",className:"text-xs",onClick:k,children:[r.jsx(Tw,{className:"mr-1 h-3 w-3"}),"Download QR"]})]})]}),r.jsxs(He,{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[r.jsx(_o,{label:"FORM / STRENGTH",value:`${i.form||"-"}${i.strength?`  ${i.strength}`:""}`}),r.jsx(_o,{label:"PACK",value:`${i.pack_size||"-"} ${i.unit||""}`}),r.jsx(_o,{label:"MANUFACTURER",value:i.manufacturer||"-"}),r.jsx(_o,{label:"THERAPEUTIC CLASS",value:i.class_name||"-"}),r.jsx(_o,{label:"ATC CODE",value:i.atc_code||"-"}),r.jsx(_o,{label:"HSN CODE",value:i.hsn_code||"-"}),r.jsx(_o,{label:"MRP / PRICE",value:`${i.default_mrp||0} MRP  ${i.default_price||0} Price`}),r.jsx(_o,{label:"TAX %",value:`${i.default_tax_percent||0}%`}),r.jsx(_o,{label:"REORDER / MAX LEVEL",value:`${i.reorder_level||0} / ${i.max_level||0}`})]})]})]})})}function _o({label:t,value:s}){return r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2.5",children:[r.jsx("p",{className:"text-[11px] font-medium uppercase tracking-wide text-slate-500",children:t}),r.jsx("p",{className:"mt-1 truncate text-sm text-slate-800",title:s,children:s||"-"})]})}function o7e(){return r.jsx(t1,{className:"h-4 w-4"})}function c7e(){const[t,s]=y.useState(""),[n,a]=y.useState(!1),[i,l]=y.useState(null),[o,c]=y.useState(""),[d,u]=y.useState(!1),[h,f]=y.useState(!1);y.useEffect(()=>()=>{o&&URL.revokeObjectURL(o)},[o]);const x=async()=>{const S=t.trim();if(!S){se.error("Please enter or scan a barcode number");return}a(!0),f(!0),l(null),c("");try{const A=(await Qfe(S)).data;if(!A){l(null);return}l(A),await b(A.id)}catch(k){console.error("Failed to lookup item by barcode",k),l(null)}finally{a(!1)}},b=async S=>{u(!0);try{const k=await jI(S),A=URL.createObjectURL(k.data);c(A)}catch(k){console.error("Failed to fetch barcode image",k)}finally{u(!1)}},v=S=>{S.key==="Enter"&&(S.preventDefault(),x())},w=async()=>{if(i)try{const S=await jI(i.id),k=new Blob([S.data],{type:"image/png"}),A=URL.createObjectURL(k),T=document.createElement("a");T.href=A,T.download=`${i.code||"medicine"}_barcode.png`,document.body.appendChild(T),T.click(),T.remove(),URL.revokeObjectURL(A)}catch(S){console.error("Failed to download barcode image",S)}},_=!n&&h&&!i;return r.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-3 sm:px-4 sm:py-4 md:px-6 md:py-6",children:r.jsxs("div",{className:"max-w-4xl mx-auto space-y-4 md:space-y-5 lg:space-y-6",children:[r.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-r from-teal-700 via-teal-600 to-blue-600 text-white shadow-md",children:[r.jsx("div",{className:"absolute inset-0 opacity-25 pointer-events-none bg-[radial-gradient(circle_at_top,_#e0f2fe,_transparent_55%)]"}),r.jsxs("div",{className:"relative px-4 py-5 sm:px-6 sm:py-6 md:px-8 md:py-7 lg:px-10 lg:py-8 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"space-y-3 max-w-xl",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-white/10 px-3 py-1 text-xs font-medium backdrop-blur-sm border border-white/20",children:[r.jsx("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-white/20 text-[11px]",children:r.jsx(W0,{className:"w-3.5 h-3.5"})}),"Scan & verify pharmacy items instantly"]}),r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"inline-flex h-11 w-11 md:h-12 md:w-12 items-center justify-center rounded-3xl bg-white/10 text-white shadow-sm border border-white/20",children:r.jsx(W0,{className:"w-6 h-6"})}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("h1",{className:"text-xl md:text-2xl lg:text-3xl font-semibold tracking-tight",children:"Medicine Barcode Lookup"}),r.jsxs("p",{className:"text-sm md:text-base text-teal-50/90 leading-relaxed",children:["Point your barcode / QR scanner at any"," ",r.jsx("span",{className:"font-semibold",children:"pharmacy item"})," and instantly fetch the mapped medicine, pricing and stock configuration from"," ",r.jsx("span",{className:"font-semibold",children:"Nutryah HIMS"}),"."]})]})]})]}),r.jsxs("div",{className:"w-full md:w-auto space-y-3",children:[r.jsxs("div",{className:"flex flex-wrap gap-2 justify-start md:justify-end",children:[r.jsx(Ze,{className:"bg-white/15 text-xs font-semibold border border-white/25 text-white rounded-full px-3 py-1",children:"Pharmacy Inventory"}),r.jsx(Ze,{className:"bg-white/10 text-xs border border-white/20 text-teal-50 rounded-full px-3 py-1",children:"Scan-ready"})]}),r.jsxs("div",{className:"rounded-2xl bg-white/10 px-3 py-2.5 border border-white/15 text-xs text-teal-50/90",children:[r.jsx("span",{className:"font-semibold",children:"Tip:"})," Keep the cursor inside the barcode box. Most hardware scanners type the code and press"," ",r.jsx("span",{className:"inline-flex items-center rounded-md border border-white/40 bg-white/10 px-1.5 py-0.5 text-[11px] font-semibold",children:"Enter"})," ","automatically."]})]})]})]}),r.jsxs(Ve,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[r.jsx(rt,{className:"pb-3",children:r.jsx(ot,{className:"flex flex-col gap-1 sm:flex-row sm:items-center sm:justify-between text-slate-900",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"inline-flex h-9 w-9 items-center justify-center rounded-2xl bg-slate-900 text-white",children:r.jsx(W0,{className:"w-4 h-4"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-semibold",children:"Scan or enter barcode / QR number"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Works with both hardware scanners and manual entry."})]})]})})}),r.jsxs(He,{className:"space-y-3",children:[r.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[r.jsx("div",{className:"flex-1",children:r.jsxs("div",{className:"relative flex items-center",children:[r.jsx("div",{className:"pointer-events-none absolute left-3 flex items-center text-slate-400",children:r.jsx(W0,{className:"w-4 h-4"})}),r.jsx(Se,{value:t,onChange:S=>s(S.target.value),onKeyDown:v,placeholder:"Scan or type the barcode / QR number (e.g. MD_1001)",className:"w-full rounded-2xl border border-slate-200 bg-slate-50 pl-9 pr-3 py-2 text-sm text-slate-800 shadow-none focus-visible:ring-2 focus-visible:ring-teal-100 focus-visible:border-teal-500",autoFocus:!0})]})}),r.jsxs(Te,{onClick:x,className:"shrink-0 rounded-full bg-blue-600 px-5 py-2 text-sm font-semibold text-white hover:bg-blue-700 active:scale-95 flex items-center gap-2",disabled:n,children:[r.jsx(es,{className:"w-4 h-4"}),n?"Searching":"Search"]})]}),r.jsxs("p",{className:"text-xs md:text-sm text-slate-500 flex items-center gap-1.5",children:[r.jsx(nn,{className:"w-3.5 h-3.5"}),"If your scanner is configured as a keyboard wedge, just keep the focus here and scan. No extra clicks needed."]})]})]}),n&&r.jsx(Ve,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:r.jsxs(He,{className:"p-4 md:p-6 space-y-4",children:[r.jsx(We,{className:"h-6 w-2/3 rounded-xl"}),r.jsx(We,{className:"h-4 w-1/3 rounded-xl"}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.jsx(We,{className:"h-20 rounded-2xl"}),r.jsx(We,{className:"h-20 rounded-2xl"}),r.jsx(We,{className:"h-20 rounded-2xl"})]})]})}),_&&r.jsx(Ve,{className:"rounded-3xl border-dashed border-slate-300 bg-white shadow-none",children:r.jsxs(He,{className:"p-6 flex flex-col items-center justify-center text-center gap-3",children:[r.jsx("div",{className:"h-12 w-12 rounded-full bg-slate-100 flex items-center justify-center border border-slate-200",children:r.jsx(nn,{className:"w-6 h-6 text-slate-600"})}),r.jsx("h2",{className:"text-sm md:text-base font-semibold text-slate-900",children:"No item found for this barcode"}),r.jsxs("p",{className:"text-xs md:text-sm text-slate-600 max-w-md",children:["Check if the code is correct or try scanning again. If this is a new medicine, map the barcode in"," ",r.jsx("span",{className:"font-semibold text-slate-900",children:"Pharmacy Inventory > Items"}),"."]})]})}),!n&&i&&r.jsx(Ve,{className:"rounded-3xl border-slate-200 bg-white shadow-sm overflow-hidden",children:r.jsxs(He,{className:"p-4 md:p-6 space-y-4",children:[r.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:gap-8",children:[r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx("span",{className:"inline-flex h-9 w-9 items-center justify-center rounded-full bg-slate-100",children:r.jsx(dr,{className:"w-4 h-4 text-slate-600"})}),r.jsx("h2",{className:"text-xl md:text-2xl font-semibold text-slate-900",children:i.name}),i.is_active===!1&&r.jsx(Ze,{variant:"outline",className:"border-amber-300 text-amber-800 bg-amber-50 text-xs rounded-full",children:"Inactive"})]}),r.jsxs("div",{className:"text-sm text-slate-600 flex flex-wrap items-center gap-2",children:[r.jsxs("span",{children:[r.jsx("span",{className:"font-medium text-slate-700",children:"Code:"})," ",i.code||""]}),r.jsx("span",{className:"text-slate-300",children:""}),r.jsxs("span",{children:[r.jsx("span",{className:"font-medium text-slate-700",children:"Barcode / QR:"})," ",i.qr_number||""]})]}),i.generic_name&&r.jsxs("p",{className:"text-sm text-slate-600",children:[r.jsx("span",{className:"font-medium text-slate-700",children:"Generic:"})," ",i.generic_name]})]}),r.jsxs("div",{className:"w-full md:w-64 lg:w-72 flex flex-col items-center gap-3",children:[r.jsxs("div",{className:"w-full h-32 md:h-36 rounded-2xl border border-dashed border-slate-200 bg-slate-50 flex items-center justify-center",children:[d&&r.jsx(We,{className:"w-40 h-20 rounded-md"}),!d&&o&&r.jsx("img",{src:o,alt:`Barcode for ${i.name}`,className:"max-h-full max-w-full object-contain"}),!d&&!o&&r.jsx("span",{className:"text-xs text-slate-400",children:"No barcode image"})]}),r.jsxs(Te,{type:"button",variant:"outline",className:"w-full rounded-full text-sm font-semibold border-slate-200",onClick:w,children:[r.jsx(to,{className:"w-4 h-4 mr-2"}),"Download barcode"]})]})]}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-3 lg:grid-cols-4 mt-3",children:[r.jsx(bc,{label:"Form / Strength",icon:r.jsx(dr,{className:"w-4 h-4"}),value:`${i.form||"-"}${i.strength?`  ${i.strength}`:""}`}),r.jsx(bc,{label:"Pack",icon:r.jsx(F7,{className:"w-4 h-4"}),value:`${i.pack_size||1} ${i.unit||"unit"}`}),r.jsx(bc,{label:"Manufacturer",icon:r.jsx(Yf,{className:"w-4 h-4"}),value:i.manufacturer||""}),r.jsx(bc,{label:"Therapeutic class",icon:r.jsx(Yf,{className:"w-4 h-4"}),value:i.class_name||""}),r.jsx(bc,{label:"ATC code",icon:r.jsx(Yf,{className:"w-4 h-4"}),value:i.atc_code||""}),r.jsx(bc,{label:"HSN code",icon:r.jsx(Yf,{className:"w-4 h-4"}),value:i.hsn_code||""}),r.jsx(bc,{label:"MRP / Price",icon:r.jsx(Kl,{className:"w-4 h-4"}),value:`${Number(i.default_mrp||0).toFixed(2)} MRP  ${Number(i.default_price||0).toFixed(2)} Price`}),r.jsx(bc,{label:"Reorder / Max level",icon:r.jsx(nn,{className:"w-4 h-4"}),value:`${Number(i.reorder_level||0).toFixed(2)} / ${Number(i.max_level||0).toFixed(2)}`})]})]})})]})})}function bc({label:t,icon:s,value:n}){return r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-4 py-3 flex flex-col gap-1",children:[r.jsxs("div",{className:"flex items-center gap-2 text-[11px] font-medium text-slate-500 uppercase tracking-wide",children:[r.jsx("span",{className:"inline-flex h-5 w-5 items-center justify-center rounded-full bg-slate-100 text-slate-600",children:s}),t]}),r.jsx("div",{className:"text-sm text-slate-800 truncate",title:n?String(n):"",children:n||""})]})}function d7e(t={}){return J.get("/pharmacy/rx",{params:t})}function QK(t){return J.get(`/pharmacy/prescriptions/${t}`)}function u7e(t){return J.post("/pharmacy/prescriptions",t)}function h7e(t,s){return J.post(`/pharmacy/prescriptions/${t}/dispense`,s)}function m7e(t={}){return J.get("/pharmacy/rx-queue",{params:t})}const d2=[{value:"OPD",label:"OPD"},{value:"IPD",label:"IPD"},{value:"OT",label:"OT"},{value:"COUNTER",label:"Counter"}],f7e=[{value:"ROUTINE",label:"Routine"},{value:"STAT",label:"STAT / Urgent"},{value:"PRN",label:"PRN / As needed"}];function ZK(){const t=new Date,s=t.getTimezoneOffset();return new Date(t.getTime()-s*60*1e3).toISOString().slice(0,16)}const u2={type:"OPD",priority:"ROUTINE",datetime:ZK(),patient:null,doctorId:"",visitNo:"",admissionNo:"",otCaseNo:"",notes:""},Bg={item:null,item_name:"",strength:"",route:"PO",dose:"",frequency:"",duration_days:"",total_qty:"",instructions:"",is_prn:!1,is_stat:!1,requested_qty:""};function p7e(){var it,_t,ve;const[t,s]=y.useState("list"),[n,a]=y.useState("ALL"),[i,l]=y.useState("ALL"),[o,c]=y.useState(""),[d,u]=y.useState(!1),[h,f]=y.useState([]),[x,b]=y.useState(null),[v,w]=y.useState(u2),[_,S]=y.useState([]),[k,A]=y.useState(Bg),[T,P]=y.useState(!1),[O,D]=y.useState(""),[I,M]=y.useState([]),[B,L]=y.useState(!1),[F,V]=y.useState(!1),[$,z]=y.useState([]),[H,q]=y.useState(!1),[G,re]=y.useState(""),[ye,Ee]=y.useState([]),[ee,te]=y.useState(!1),[ce,ge]=y.useState(!1);y.useEffect(()=>{(async()=>{var ae;try{q(!0);const xe=await Xk(),je=((ae=xe==null?void 0:xe.data)==null?void 0:ae.doctors)||[];z(je)}catch{}finally{q(!1)}})()},[]),y.useEffect(()=>{X()},[n,i]);async function X(){try{u(!0);const ae={};n!=="ALL"&&(ae.type=n),i!=="ALL"&&(ae.status=i),o!=null&&o.trim()&&(ae.q=o.trim()),ae.limit=100;const xe=await d7e(ae);f((xe==null?void 0:xe.data)||[])}catch{}finally{u(!1)}}y.useEffect(()=>{if(!O||O.trim().length<2){M([]);return}let ae=!1;return(async()=>{var xe;try{L(!0);const je=await LK(O.trim());if(ae)return;M(((xe=je==null?void 0:je.data)==null?void 0:xe.items)||(je==null?void 0:je.data)||[]),V(!0)}catch{}finally{ae||L(!1)}})(),()=>{ae=!0}},[O]);function de(ae){w(xe=>({...xe,patient:ae})),D(`${ae.uhid?`${ae.uhid}  `:""}${ae.first_name||""} ${ae.last_name||""}`.trim()),V(!1)}y.useEffect(()=>{if(!G||G.trim().length<2){Ee([]);return}let ae=!1;return(async()=>{var xe;try{te(!0);const je=await vv({q:G.trim(),kind:"MEDICINE",limit:15});if(ae)return;const Fe=((xe=je==null?void 0:je.data)==null?void 0:xe.items)||(je==null?void 0:je.data)||[];Ee(Fe),ge(!0)}catch{}finally{ae||te(!1)}})(),()=>{ae=!0}},[G]);function Ce(ae){A(xe=>({...xe,item:ae,item_name:ae.name||ae.item_name||""})),re(ae.name||ae.item_name||""),ge(!1)}function ue(){w({...u2,type:v.type||"OPD"}),S([]),A(Bg),D("")}function fe(ae){const xe=ae;w(je=>({...u2,type:xe,datetime:ZK()})),S([]),A(Bg),D(""),b(null),s("new")}function pe(ae){const xe=Number(ae.duration_days||0),je=(ae.frequency||"").trim();if(!xe||!je)return"";const Ct=je.split("-").map(vt=>Number(vt||0)).reduce((vt,pt)=>vt+(Number.isFinite(pt)?pt:0),0);return Ct?String(Ct*xe):""}function oe(){if(!k.item&&!k.item_name){se.error("Select a medicine first");return}const ae=pe(k),xe=k.total_qty||ae;if(!xe){se.error("Enter Total Qty or proper Frequency + Days");return}const je={...k,total_qty:xe,requested_qty:k.requested_qty||xe};S(Fe=>[...Fe,je]),A(Bg),re(""),ge(!1)}function qe(ae){S(xe=>xe.filter((je,Fe)=>Fe!==ae))}async function Xe(){var xe;if(!v.patient&&v.type!=="COUNTER"){se.error("Select a patient");return}if(!v.doctorId&&v.type!=="COUNTER"){se.error("Select a doctor");return}if(!_.length){se.error("Add at least one medicine");return}const ae={type:v.type,priority:v.priority,rx_datetime:v.datetime,patient_id:((xe=v.patient)==null?void 0:xe.id)||null,doctor_user_id:v.doctorId||null,visit_id:v.type==="OPD"&&v.visitNo||null,ipd_admission_id:v.type==="IPD"&&v.admissionNo||null,ot_case_id:v.type==="OT"&&v.otCaseNo||null,notes:v.notes||"",lines:_.map(je=>{var pt,Ns;const Fe=pe(je),Ct=je.total_qty||je.requested_qty||Fe||"",vt=Ct?Number(Ct):null;return{item_id:((pt=je.item)==null?void 0:pt.id)||je.item_id||null,item_name:((Ns=je.item)==null?void 0:Ns.name)||je.item_name||"",strength:je.strength||null,route:je.route||null,dose:je.dose||null,frequency:je.frequency||null,duration_days:je.duration_days?Number(je.duration_days):null,requested_qty:vt,total_qty:vt,instructions:je.instructions||null,is_prn:!!je.is_prn,is_stat:!!je.is_stat}})};try{P(!0);const je=await u7e(ae);se.success("Prescription created & sent to Pharmacy"),ue(),s("list"),X(),je!=null&&je.data&&b(je.data)}catch{}finally{P(!1)}}async function jt(ae){try{const xe=await QK(ae.id),je=(xe==null?void 0:xe.data)||ae;b(je),s("detail")}catch{}}const ft=y.useMemo(()=>x?x.lines||x.items||[]:[],[x]);return r.jsxs("div",{className:"p-4 md:p-6 space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-slate-900",children:"Pharmacy Prescriptions"}),r.jsx("p",{className:"text-sm text-slate-500",children:"Create and manage OPD, IPD, OT and Counter prescriptions linked to inventory & billing."})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs(Fs,{value:v.type,onValueChange:ae=>w(xe=>({...xe,type:ae})),children:[r.jsx(Ds,{className:"w-[140px] bg-white border-slate-200 rounded-full",children:r.jsx($s,{placeholder:"Rx Type"})}),r.jsx(Os,{children:d2.map(ae=>r.jsx(zt,{value:ae.value,children:ae.label},ae.value))})]}),r.jsxs(Te,{className:"rounded-full",onClick:()=>fe(v.type||"OPD"),children:[r.jsx(ps,{className:"w-4 h-4 mr-2"}),"New Prescription"]})]})]}),r.jsxs(jl,{value:t,onValueChange:s,children:[r.jsxs(Wi,{className:"mb-4",children:[r.jsx(ms,{value:"list",children:"Queue / History"}),r.jsx(ms,{value:"new",children:"New Rx"}),r.jsx(ms,{value:"detail",disabled:!x,children:"Selected Rx"})]}),r.jsx(us,{value:"list",className:"space-y-3",children:r.jsxs(Ve,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(rt,{className:"pb-3",children:r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[r.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[r.jsx("span",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Filter by"}),r.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[r.jsx("button",{type:"button",onClick:()=>a("ALL"),className:`px-2.5 py-1 rounded-full text-xs border ${n==="ALL"?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-200"}`,children:"All Types"}),d2.map(ae=>r.jsxs("button",{type:"button",onClick:()=>a(ae.value),className:`px-2.5 py-1 rounded-full text-xs border flex items-center gap-1.5 ${n===ae.value?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-200"}`,children:[r.jsx(dr,{className:"w-3 h-3"}),ae.label]},ae.value))]})]}),r.jsxs("div",{className:"flex items-center gap-2 w-full md:w-auto",children:[r.jsxs("div",{className:"relative flex-1 md:w-64",children:[r.jsx(es,{className:"w-4 h-4 text-slate-400 absolute left-2.5 top-2.5"}),r.jsx(Se,{value:o,onChange:ae=>c(ae.target.value),placeholder:"Search UHID / name / Rx no...",className:"pl-8 text-sm bg-white border-slate-200 rounded-full",onKeyDown:ae=>{ae.key==="Enter"&&X()}})]}),r.jsxs(Fs,{value:i,onValueChange:l,children:[r.jsx(Ds,{className:"w-[130px] bg-white border-slate-200 rounded-full text-xs",children:r.jsx($s,{placeholder:"Status"})}),r.jsxs(Os,{children:[r.jsx(zt,{value:"ALL",children:"All status"}),r.jsx(zt,{value:"DRAFT",children:"Draft"}),r.jsx(zt,{value:"PENDING",children:"Pending"}),r.jsx(zt,{value:"PARTIAL",children:"Partial"}),r.jsx(zt,{value:"DISPENSED",children:"Dispensed"}),r.jsx(zt,{value:"CANCELLED",children:"Cancelled"})]})]}),r.jsx(Te,{variant:"outline",size:"icon",className:"rounded-full border-slate-200",onClick:X,children:r.jsx($r,{className:"w-4 h-4"})})]})]})}),r.jsx(He,{className:"pt-0",children:r.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:r.jsx("div",{className:"max-h-[420px] overflow-auto",children:r.jsxs("table",{className:"w-full text-sm",children:[r.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:r.jsxs("tr",{className:"text-xs text-slate-500",children:[r.jsx("th",{className:"text-left px-3 py-2.5 font-medium",children:"Rx No"}),r.jsx("th",{className:"text-left px-3 py-2.5 font-medium",children:"Patient"}),r.jsx("th",{className:"text-left px-3 py-2.5 font-medium",children:"Type / Doctor"}),r.jsx("th",{className:"text-left px-3 py-2.5 font-medium",children:"Items"}),r.jsx("th",{className:"text-left px-3 py-2.5 font-medium",children:"Created"}),r.jsx("th",{className:"text-left px-3 py-2.5 font-medium",children:"Status"}),r.jsx("th",{className:"text-right px-3 py-2.5 font-medium",children:"Actions"})]})}),r.jsxs("tbody",{children:[d&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"px-3 py-6 text-center text-xs text-slate-500",children:"Loading prescriptions..."})}),!d&&!h.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"px-3 py-6 text-center text-xs text-slate-500",children:"No prescriptions found for the selected filters."})}),!d&&h.map(ae=>{var ie,Ie;const xe=(ae.status||"").toUpperCase()||"PENDING",je=ae.type||ae.rx_type||"OPD",Fe=ae.created_at||ae.rx_datetime||ae.bill_date||null,Ct=Fe?String(Fe).slice(0,16).replace("T"," "):"",vt=ae.patient||ae.patient_name||ae.patient_uhid||"",pt=typeof vt=="string"?vt:`${vt.first_name||""} ${vt.last_name||""}`.trim(),Ns=((ie=ae.items)==null?void 0:ie.length)||((Ie=ae.lines)==null?void 0:Ie.length)||ae.item_count||"",ds=ae.doctor_name||ae.doctor||ae.doctor_display||"";return r.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60 transition-colors",children:[r.jsx("td",{className:"px-3 py-2.5 align-middle",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-xs font-medium text-slate-900",children:ae.rx_number||`RX-${ae.id}`}),ae.uhid&&r.jsxs("span",{className:"text-[11px] text-slate-500",children:["UHID: ",ae.uhid]})]})}),r.jsx("td",{className:"px-3 py-2.5 align-middle",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-7 h-7 rounded-full bg-slate-100 flex items-center justify-center text-[11px] font-medium text-slate-700",children:r.jsx(rn,{className:"w-3 h-3"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-slate-900",children:pt||""}),ae.patient_uhid&&r.jsx("div",{className:"text-[11px] text-slate-500",children:ae.patient_uhid})]})]})}),r.jsx("td",{className:"px-3 py-2.5 align-middle",children:r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(Ze,{variant:"outline",className:"border-slate-200 text-[11px] px-1.5 py-0.5",children:je}),ds&&r.jsxs("span",{className:"text-[11px] text-slate-600 flex items-center gap-1",children:[r.jsx(Es,{className:"w-3 h-3"}),ds]})]}),ae.context_label&&r.jsx("span",{className:"text-[11px] text-slate-500",children:ae.context_label})]})}),r.jsx("td",{className:"px-3 py-2.5 align-middle text-xs text-slate-700",children:Ns}),r.jsx("td",{className:"px-3 py-2.5 align-middle text-xs text-slate-700",children:r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(lr,{className:"w-3 h-3 text-slate-400"}),r.jsx("span",{children:Ct})]})}),r.jsx("td",{className:"px-3 py-2.5 align-middle",children:r.jsx(x7e,{status:xe})}),r.jsx("td",{className:"px-3 py-2.5 align-middle text-right",children:r.jsxs(Te,{variant:"outline",size:"sm",className:"h-7 px-2 text-xs rounded-full border-slate-200",onClick:()=>jt(ae),children:[r.jsx(yr,{className:"w-3 h-3 mr-1"}),"View"]})})]},ae.id)})]})]})})})})]})}),r.jsx(us,{value:"new",children:r.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.5fr)_minmax(0,2fr)]",children:[r.jsxs(Ve,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(rt,{className:"pb-3",children:r.jsxs(ot,{className:"flex items-center gap-2 text-sm font-semibold",children:[r.jsx(dr,{className:"w-4 h-4 text-slate-500"}),"Prescription Details"]})}),r.jsxs(He,{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{className:"text-xs text-slate-600",children:"Prescription Type"}),r.jsx("div",{className:"flex flex-wrap gap-1.5",children:d2.map(ae=>r.jsxs("button",{type:"button",onClick:()=>w(xe=>({...xe,type:ae.value})),className:`px-2.5 py-1 rounded-full text-xs border flex items-center gap-1.5 ${v.type===ae.value?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-200"}`,children:[r.jsx(dr,{className:"w-3 h-3"}),ae.label]},ae.value))})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{className:"text-xs text-slate-600",children:"Priority"}),r.jsxs(Fs,{value:v.priority,onValueChange:ae=>w(xe=>({...xe,priority:ae})),children:[r.jsx(Ds,{className:"w-full bg-white border-slate-200 rounded-full h-9 text-xs",children:r.jsx($s,{placeholder:"Select priority"})}),r.jsx(Os,{children:f7e.map(ae=>r.jsx(zt,{value:ae.value,children:ae.label},ae.value))})]})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{className:"text-xs text-slate-600",children:"Date & Time"}),r.jsx(Se,{type:"datetime-local",value:v.datetime,onChange:ae=>w(xe=>({...xe,datetime:ae.target.value})),className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]}),r.jsxs("div",{className:"space-y-1.5 relative",children:[r.jsxs(Qe,{className:"text-xs text-slate-600 flex items-center gap-1.5",children:[r.jsx(rn,{className:"w-3 h-3"}),"Patient (UHID / name / phone)"]}),r.jsxs("div",{className:"relative",children:[r.jsx(es,{className:"w-3.5 h-3.5 text-slate-400 absolute left-2.5 top-2.5"}),r.jsx(Se,{value:O,onChange:ae=>{D(ae.target.value),V(!0)},placeholder:v.type==="COUNTER"?"Optional for counter sale":"Search patient...",className:"pl-7 h-9 text-xs bg-white border-slate-200 rounded-full"})]}),r.jsx(vl,{children:F&&(I.length>0||B)&&r.jsxs(at.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},className:"absolute z-20 mt-1 w-full bg-white border border-slate-200 rounded-xl shadow-lg max-h-52 overflow-auto text-xs",children:[B&&r.jsx("div",{className:"px-3 py-2 text-slate-500",children:"Searching..."}),!B&&!I.length&&r.jsx("div",{className:"px-3 py-2 text-slate-500",children:"No patients found"}),!B&&I.map(ae=>r.jsxs("button",{type:"button",onClick:()=>de(ae),className:"w-full text-left px-3 py-1.5 hover:bg-slate-50 flex flex-col gap-0.5",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"font-medium text-slate-900",children:`${ae.first_name||""} ${ae.last_name||""}`.trim()||ae.name||`Patient #${ae.id}`}),ae.uhid&&r.jsxs("span",{className:"text-[10px] text-slate-500",children:["UHID: ",ae.uhid]})]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:[ae.age?`${ae.age}y  `:"",ae.gender?`${ae.gender}  `:"",ae.phone||""]})]},ae.id))]})})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[v.type==="OPD"&&r.jsx(r.Fragment,{children:r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{className:"text-xs text-slate-600",children:"OPD Visit No (optional)"}),r.jsx(Se,{value:v.visitNo,onChange:ae=>w(xe=>({...xe,visitNo:ae.target.value})),placeholder:"e.g., OPD-2025-0001",className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]})}),v.type==="IPD"&&r.jsx(r.Fragment,{children:r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{className:"text-xs text-slate-600",children:"Admission No"}),r.jsx(Se,{value:v.admissionNo,onChange:ae=>w(xe=>({...xe,admissionNo:ae.target.value})),placeholder:"IPD admission number",className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]})}),v.type==="OT"&&r.jsx(r.Fragment,{children:r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{className:"text-xs text-slate-600",children:"OT Case No"}),r.jsx(Se,{value:v.otCaseNo,onChange:ae=>w(xe=>({...xe,otCaseNo:ae.target.value})),placeholder:"OT / procedure case ID",className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]})}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs(Qe,{className:"text-xs text-slate-600 flex items-center gap-1",children:[r.jsx(Es,{className:"w-3 h-3"}),"Consultant / Prescriber"]}),r.jsxs(Fs,{value:v.doctorId||"",onValueChange:ae=>w(xe=>({...xe,doctorId:ae})),children:[r.jsx(Ds,{className:"w-full bg-white border-slate-200 rounded-full h-9 text-xs",children:r.jsx($s,{placeholder:"Select doctor"})}),r.jsxs(Os,{children:[H&&r.jsx(zt,{value:"__loading",disabled:!0,children:"Loading..."}),!H&&(!$||!$.length)&&r.jsx(zt,{value:"__none",disabled:!0,children:"No doctors configured"}),!H&&($==null?void 0:$.map(ae=>r.jsx(zt,{value:String(ae.id),children:ae.name||ae.full_name||ae.email},ae.id)))]})]})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{className:"text-xs text-slate-600",children:"Clinical notes / instructions to pharmacist (optional)"}),r.jsx(Yl,{value:v.notes,onChange:ae=>w(xe=>({...xe,notes:ae.target.value})),rows:3,className:"text-xs bg-white border-slate-200 resize-none rounded-xl",placeholder:"Eg: Allergic to penicillin, avoid NSAIDs, taper dose after 5 days, etc."})]})]})]}),r.jsxs(Ve,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsxs(rt,{className:"pb-3 flex flex-row items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(yr,{className:"w-4 h-4 text-slate-500"}),r.jsx(ot,{className:"text-sm font-semibold",children:"Medicines & Instructions"})]}),r.jsx("div",{className:"text-[11px] text-slate-500",children:_.length?`${_.length} lines`:"No lines added yet"})]}),r.jsxs(He,{className:"space-y-3",children:[r.jsx("div",{className:"border border-dashed border-slate-200 rounded-xl p-3 bg-slate-50/60",children:r.jsxs("div",{className:"grid md:grid-cols-[minmax(0,2.3fr)_minmax(0,1.1fr)] gap-3",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"space-y-1 relative",children:[r.jsxs(Qe,{className:"text-[11px] text-slate-600 flex items-center gap-1.5",children:["Medicine",r.jsx("span",{className:"text-[10px] text-slate-400",children:"(linked to Inventory)"})]}),r.jsxs("div",{className:"relative",children:[r.jsx(es,{className:"w-3.5 h-3.5 text-slate-400 absolute left-2 top-2.5"}),r.jsx(Se,{value:G,onChange:ae=>{re(ae.target.value),ge(!0)},placeholder:"Search drug name, brand, generic...",className:"pl-7 h-9 text-xs bg-white border-slate-200 rounded-full"})]}),r.jsx(vl,{children:ce&&(ye.length>0||ee)&&r.jsxs(at.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},className:"absolute z-20 mt-1 w-full bg-white border border-slate-200 rounded-xl shadow-lg max-h-52 overflow-auto text-xs",children:[ee&&r.jsx("div",{className:"px-3 py-2 text-slate-500",children:"Searching medicines..."}),!ee&&!ye.length&&r.jsx("div",{className:"px-3 py-2 text-slate-500",children:"No items found"}),!ee&&ye.map(ae=>r.jsxs("button",{type:"button",onClick:()=>Ce(ae),className:"w-full text-left px-3 py-1.5 hover:bg-slate-50 flex flex-col gap-0.5",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"font-medium text-slate-900",children:ae.name||ae.item_name}),ae.code&&r.jsx("span",{className:"text-[10px] text-slate-500",children:ae.code})]}),r.jsx("div",{className:"text-[11px] text-slate-500",children:ae.strength||ae.form||""})]},ae.id))]})})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx(Qe,{className:"text-[11px] text-slate-600",children:"Dose"}),r.jsx(Se,{value:k.dose,onChange:ae=>A(xe=>({...xe,dose:ae.target.value})),placeholder:"e.g. 500 mg",className:"h-8 text-[11px] bg-white border-slate-200 rounded-full"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx(Qe,{className:"text-[11px] text-slate-600",children:"Frequency"}),r.jsx(Se,{value:k.frequency,onChange:ae=>A(xe=>({...xe,frequency:ae.target.value})),placeholder:"e.g. 1-0-1",className:"h-8 text-[11px] bg-white border-slate-200 rounded-full"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx(Qe,{className:"text-[11px] text-slate-600",children:"Days"}),r.jsx(Se,{value:k.duration_days,onChange:ae=>A(xe=>({...xe,duration_days:ae.target.value,total_qty:xe.total_qty||pe({...xe,duration_days:ae.target.value})})),placeholder:"e.g. 5",className:"h-8 text-[11px] bg-white border-slate-200 rounded-full"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx(Qe,{className:"text-[11px] text-slate-600",children:"Route"}),r.jsx(Se,{value:k.route,onChange:ae=>A(xe=>({...xe,route:ae.target.value})),placeholder:"PO / IV / IM / etc",className:"h-8 text-[11px] bg-white border-slate-200 rounded-full"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx(Qe,{className:"text-[11px] text-slate-600",children:"Total Qty"}),r.jsx(Se,{value:k.total_qty,onChange:ae=>A(xe=>({...xe,total_qty:ae.target.value})),placeholder:pe(k)?`Suggested: ${pe(k)}`:"eg. 10",className:"h-8 text-[11px] bg-white border-slate-200 rounded-full"})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx(Qe,{className:"text-[11px] text-slate-600",children:"Instructions to patient"}),r.jsx(Se,{value:k.instructions,onChange:ae=>A(xe=>({...xe,instructions:ae.target.value})),placeholder:"After food, morning & night, etc.",className:"h-8 text-[11px] bg-white border-slate-200 rounded-full"})]})]}),r.jsxs("div",{className:"flex flex-col justify-between gap-2",children:[r.jsx("div",{className:"text-[11px] text-slate-500",children:r.jsx("p",{children:"Add medicine to this prescription. Quantity can be auto-estimated from frequency & days."})}),r.jsx("div",{className:"flex justify-end",children:r.jsxs(Te,{type:"button",size:"sm",className:"h-9 px-3 rounded-full",onClick:oe,children:[r.jsx(ps,{className:"w-3.5 h-3.5 mr-1"}),"Add line"]})})]})]})}),r.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:r.jsx(Or,{className:"max-h-[280px]",children:r.jsxs("table",{className:"w-full text-[11px]",children:[r.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:r.jsxs("tr",{className:"text-[11px] text-slate-500",children:[r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"#"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Medicine"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Dose / Freq / Days"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Route"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Qty"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Actions"})]})}),r.jsxs("tbody",{children:[!_.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-3 py-4 text-center text-[11px] text-slate-500",children:"No lines added. Use the panel above to add medicines to this prescription."})}),_.map((ae,xe)=>{var je,Fe;return r.jsxs("tr",{className:"border-t border-slate-100",children:[r.jsx("td",{className:"px-3 py-2 align-top text-slate-500",children:xe+1}),r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:((je=ae.item)==null?void 0:je.name)||ae.item_name||"Unnamed medicine"}),ae.strength&&r.jsx("span",{className:"text-[10px] text-slate-500",children:ae.strength})]})}),r.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsxs("span",{children:[ae.dose||""," "," ",ae.frequency||""," "," ",ae.duration_days?`${ae.duration_days} days`:""]}),ae.instructions&&r.jsx("span",{className:"text-[10px] text-slate-500",children:ae.instructions})]})}),r.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:ae.route||""}),r.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:ae.total_qty||pe(ae)||""}),r.jsx("td",{className:"px-3 py-2 align-top text-right",children:r.jsx(Te,{variant:"ghost",size:"sm",className:"h-7 px-2 text-[11px] text-slate-500 hover:text-red-600",onClick:()=>qe(xe),children:"Remove"})})]},`${ae.item_id||((Fe=ae.item)==null?void 0:Fe.id)||xe}-${xe}`)})]})]})})}),r.jsxs("div",{className:"flex justify-between items-center pt-1",children:[r.jsxs(Te,{type:"button",variant:"ghost",size:"sm",className:"h-8 px-2 text-xs text-slate-500",onClick:()=>{ue(),s("list")},children:[r.jsx(Qb,{className:"w-3 h-3 mr-1"}),"Back to queue"]}),r.jsx(Te,{type:"button",size:"sm",className:"h-9 px-4 rounded-full",onClick:Xe,disabled:T,children:T?"Saving...":r.jsxs(r.Fragment,{children:[r.jsx(yr,{className:"w-3.5 h-3.5 mr-1"}),"Save & Send to Pharmacy"]})})]})]})]})]})}),r.jsx(us,{value:"detail",children:x?r.jsxs(Ve,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsxs(rt,{className:"pb-3 flex flex-row items-center justify-between gap-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs(ot,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx(yr,{className:"w-4 h-4 text-slate-500"}),"Prescription #",x.rx_number||x.id]}),r.jsxs("div",{className:"flex flex-wrap gap-2 text-[11px] text-slate-500",children:[r.jsxs("span",{children:["Type:"," ",r.jsx(Ze,{variant:"outline",className:"px-1.5 py-0.5",children:x.type||x.rx_type||"OPD"})]}),x.priority&&r.jsxs("span",{children:["Priority: ",x.priority]}),x.doctor_name&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(Es,{className:"w-3 h-3"}),x.doctor_name]})]})]}),r.jsxs("div",{className:"text-right text-[11px] text-slate-500",children:[r.jsxs("div",{children:["UHID:"," ",x.patient_uhid||((it=x.patient)==null?void 0:it.uhid)||""]}),r.jsxs("div",{children:["Patient:"," ",x.patient_name||`${((_t=x.patient)==null?void 0:_t.first_name)||""} ${((ve=x.patient)==null?void 0:ve.last_name)||""}`.trim()||""]})]})]}),r.jsx(He,{className:"space-y-3",children:r.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:r.jsx(Or,{className:"max-h-[380px]",children:r.jsxs("table",{className:"w-full text-[11px]",children:[r.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:r.jsxs("tr",{className:"text-[11px] text-slate-500",children:[r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"#"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Medicine"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Dose / Freq / Days"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Route"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Qty"})]})}),r.jsxs("tbody",{children:[!ft.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-3 py-4 text-center text-[11px] text-slate-500",children:"No lines found for this prescription."})}),ft.map((ae,xe)=>r.jsxs("tr",{className:"border-t border-slate-100",children:[r.jsx("td",{className:"px-3 py-2 align-top text-slate-500",children:xe+1}),r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:ae.item_name||ae.medicine_name||"Unnamed medicine"}),ae.strength&&r.jsx("span",{className:"text-[10px] text-slate-500",children:ae.strength})]})}),r.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsxs("span",{children:[ae.dose||""," "," ",ae.frequency||""," "," ",ae.duration_days?`${ae.duration_days} days`:""]}),ae.instructions&&r.jsx("span",{className:"text-[10px] text-slate-500",children:ae.instructions})]})}),r.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:ae.route||""}),r.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:ae.total_qty||ae.qty||ae.quantity||pe(ae)||""})]},ae.id||xe))]})]})})})})]}):r.jsx(Ve,{className:"border-slate-200 rounded-2xl shadow-sm",children:r.jsx(He,{className:"py-8 text-center text-sm text-slate-500",children:"Select a prescription from the queue to view details."})})})]})]})}function x7e({status:t}){const s=(t||"").toUpperCase();let n=s,a="bg-slate-50 text-slate-700 border border-slate-200";return s==="PENDING"||s==="NEW"?(n="Pending",a="bg-amber-50 text-amber-700 border border-amber-200"):s==="PARTIAL"?(n="Partial",a="bg-blue-50 text-blue-700 border border-blue-200"):s==="DISPENSED"||s==="COMPLETED"?(n="Dispensed",a="bg-emerald-50 text-emerald-700 border border-emerald-200"):s==="CANCELLED"&&(n="Cancelled",a="bg-rose-50 text-rose-700 border border-rose-200"),r.jsx("span",{className:`inline-flex items-center px-2 py-0.5 text-[11px] rounded-full ${a}`,children:n})}function h2(t={}){return J.get("/pharmacy/billing",{params:t})}function m2(t){return J.get(`/pharmacy/billing/${t}`)}function g7e(t,s){return J.post(`/pharmacy/billing/${t}/status`,s)}function y7e(t={}){return J.get("/pharmacy/billing/returns/list",{params:t})}function b7e(t){return J.post("/pharmacy/billing/returns",t)}function v7e(t){return J.post("/pharmacy/billing/ipd/consolidated",t)}async function f2(t){try{const s=await J.get(`/pharmacy/billing/${t}/pdf`,{responseType:"blob"}),n=new Blob([s.data],{type:"application/pdf"}),a=window.URL.createObjectURL(n);window.open(a,"_blank","noopener,noreferrer")}catch(s){console.error("Failed to open pharmacy bill PDF",s)}}const N7e=[{value:"ALL",label:"All types"},{value:"OPD",label:"OPD"},{value:"IPD",label:"IPD"},{value:"OT",label:"OT"},{value:"COUNTER",label:"Counter"}],w7e=[{value:"ALL",label:"All"},{value:"UNPAID",label:"Unpaid"},{value:"PARTIAL",label:"Partial"},{value:"PAID",label:"Paid"},{value:"CANCELLED",label:"Cancelled"}],j7e=[{value:"CASH",label:"Cash"},{value:"CARD",label:"Card"},{value:"UPI",label:"UPI"},{value:"NET_BANKING",label:"Net Banking"},{value:"OTHER",label:"Other"}];function Tr(t){const s=Number(t??0);return Number.isFinite(s)?`${s.toFixed(2)}`:"0.00"}function Fg(t={}){const s=(t.type||t.bill_type||"").toUpperCase();if(s==="OPD"||s==="IPD"||s==="OT"||s==="COUNTER")return s;const n=(t.context_type||"").toUpperCase();return n==="OPD"?"OPD":n==="IPD"?"IPD":n==="PHARM_COUNTER"||n==="COUNTER"?"COUNTER":"OPD"}function p2(t){const s=(t||"").toUpperCase();return s?s==="PARTIALLY_PAID"?"PARTIAL":s==="DRAFT"?"UNPAID":s:"UNPAID"}function _7e(){var ds,ie,Ie,he,Me,Ge,Be,Ot,Rt,Jt,ys,Qs,na,qt,Gt,ra,Mt;const[t,s]=y.useState("bills"),[n,a]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState("ALL"),[d,u]=y.useState("ALL"),[h,f]=y.useState(""),[x,b]=y.useState(""),[v,w]=y.useState(""),[_,S]=y.useState(null),[k,A]=y.useState(!1),[T,P]=y.useState(null),[O,D]=y.useState("CASH"),[I,M]=y.useState(""),[B,L]=y.useState(!1),[F,V]=y.useState([]),[$,z]=y.useState(!1),[H,q]=y.useState(""),[G,re]=y.useState(null),[ye,Ee]=y.useState([]),[ee,te]=y.useState(""),[ce,ge]=y.useState(!1),[X,de]=y.useState(""),[Ce,ue]=y.useState(""),[fe,pe]=y.useState(!1),[oe,qe]=y.useState([]),[Xe,jt]=y.useState(null);y.useEffect(()=>{ft()},[d]),y.useEffect(()=>{t==="returns"&&_t(),t==="ipd"&&ve()},[t]);async function ft(){try{l(!0);const we={limit:100};d!=="ALL"&&(we.status=d),h.trim()&&(we.q=h.trim()),x&&(we.date_from=x),v&&(we.date_to=v);const lt=await h2(we);a((lt==null?void 0:lt.data)||[])}catch{}finally{l(!1)}}async function it(we){try{const lt=await m2(we.id);S((lt==null?void 0:lt.data)||we)}catch{}}async function _t(){try{z(!0);const we=await y7e({limit:50});V((we==null?void 0:we.data)||[])}catch{}finally{z(!1)}}async function ve(){try{const we=await h2({limit:100}),ht=((we==null?void 0:we.data)||[]).filter(Kt=>Fg(Kt)==="IPD");qe(ht)}catch{}}const ae=y.useMemo(()=>n!=null&&n.length?o==="ALL"?n:n.filter(we=>Fg(we)===o):[],[n,o]);function xe(we){const lt=Number(we.total_amount??we.gross_total??we.net_amount??0),ht=Number(we.paid_amount??0),Kt=Number(we.balance_amount??lt-ht)||0;P(we),M(Kt>0?String(Kt.toFixed(2)):String(lt.toFixed(2))),D("CASH"),A(!0)}async function je(){if(!T)return;const we=Number(I);if(!we||we<=0){se.error("Enter a valid payment amount");return}const lt=Number(T.total_amount??T.gross_total??T.net_amount??0),Kt=Number(T.paid_amount??0)+we,Wt=Math.max(lt-Kt,0);let Ht="PARTIAL";Wt<=.01?Ht="PAID":Kt<=.01&&(Ht="UNPAID");try{if(L(!0),await g7e(T.id,{payment_status:Ht,paid_amount:we,note:null}),se.success("Payment recorded successfully"),A(!1),P(null),M(""),await ft(),_&&_.id===T.id){const Ls=await m2(_.id);S((Ls==null?void 0:Ls.data)||_)}}catch{}finally{L(!1)}}async function Fe(){if(!H.trim()){se.error("Enter bill no / patient / UHID to search");return}try{const we=await h2({q:H.trim(),limit:1}),lt=(we==null?void 0:we.data)||[];if(!lt.length){se.error("No matching pharmacy bill found");return}const ht=lt[0],Kt=await m2(ht.id),Wt=(Kt==null?void 0:Kt.data)||ht,Ls=(Wt.items||Wt.lines||[]).map(bs=>({...bs,return_qty:""}));re(Wt),Ee(Ls)}catch{}}function Ct(we,lt){Ee(ht=>ht.map((Kt,Wt)=>Wt===we?{...Kt,return_qty:lt}:Kt))}async function vt(){if(!G){se.error("Select a source bill first");return}const we=ye.filter(ht=>Number(ht.return_qty||0)>0);if(!we.length){se.error("Enter return quantity for at least one item");return}const lt={source_invoice_id:G.id,reason:ee||null,lines:we.map(ht=>({bill_line_id:ht.id,qty_to_return:Number(ht.return_qty||0)}))};try{ge(!0),await b7e(lt),se.success("Return note created successfully"),te(""),re(null),Ee([]),q(""),_t()}catch{}finally{ge(!1)}}async function pt(){if(!X&&!Ce){se.error("Enter Patient ID or Admission ID");return}const we={};X&&(we.patient_id=Number(X)),Ce&&(we.admission_id=Number(Ce));try{pe(!0);const lt=await v7e(we),ht=(lt==null?void 0:lt.data)||lt||null;if(!ht){se.error("No consolidated data returned");return}jt(ht),se.success("IPD consolidated pharmacy summary generated")}catch{}finally{pe(!1)}}const Ns=y.useMemo(()=>_?_.items||_.lines||[]:[],[_]);return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"p-4 md:p-6 space-y-4",children:[r.jsx("div",{className:"flex items-center justify-between gap-3",children:r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-slate-900",children:"Pharmacy Billing Console"}),r.jsx("p",{className:"text-sm text-slate-500",children:"Manage pharmacy invoices, payments, returns & IPD consolidated bills."})]})}),r.jsxs(jl,{value:t,onValueChange:s,children:[r.jsxs(Wi,{className:"mb-4",children:[r.jsx(ms,{value:"bills",children:"Bills"}),r.jsx(ms,{value:"returns",children:"Returns"}),r.jsx(ms,{value:"ipd",children:"IPD Consolidated"})]}),r.jsx(us,{value:"bills",className:"space-y-3",children:r.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.7fr)_minmax(0,1.3fr)]",children:[r.jsxs(Ve,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(rt,{className:"pb-3",children:r.jsxs("div",{className:"flex flex-col gap-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs(ot,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx(Iw,{className:"w-4 h-4 text-slate-500"}),"Pharmacy Bills"]}),r.jsx(Te,{variant:"outline",size:"icon",className:"h-8 w-8 rounded-full border-slate-200",onClick:ft,children:r.jsx($r,{className:"w-4 h-4"})})]}),r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"relative flex-1 min-w-[180px]",children:[r.jsx(es,{className:"w-4 h-4 text-slate-400 absolute left-2.5 top-2.5"}),r.jsx(Se,{value:h,onChange:we=>f(we.target.value),onKeyDown:we=>{we.key==="Enter"&&ft()},placeholder:"Search bill no / UHID / patient / phone",className:"pl-8 h-9 text-xs bg-white border-slate-200 rounded-full"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Se,{type:"date",value:x,onChange:we=>b(we.target.value),className:"h-9 text-[11px] bg-white border-slate-200 rounded-full w-[130px]"}),r.jsx(Se,{type:"date",value:v,onChange:we=>w(we.target.value),className:"h-9 text-[11px] bg-white border-slate-200 rounded-full w-[130px]"}),r.jsx(Te,{variant:"outline",size:"sm",className:"h-8 px-3 rounded-full text-[11px]",onClick:ft,children:"Apply"})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs(Fs,{value:o,onValueChange:c,children:[r.jsx(Ds,{className:"w-[140px] bg-white border-slate-200 rounded-full h-8 text-[11px]",children:r.jsx($s,{placeholder:"Bill type"})}),r.jsx(Os,{children:N7e.map(we=>r.jsx(zt,{value:we.value,children:we.label},we.value))})]}),r.jsxs(Fs,{value:d,onValueChange:u,children:[r.jsx(Ds,{className:"w-[130px] bg-white border-slate-200 rounded-full h-8 text-[11px]",children:r.jsx($s,{placeholder:"Status"})}),r.jsx(Os,{children:w7e.map(we=>r.jsx(zt,{value:we.value,children:we.label},we.value))})]})]})]})]})}),r.jsx(He,{className:"pt-0",children:r.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:r.jsx(Or,{className:"max-h-[480px]",children:r.jsxs("table",{className:"w-full text-xs",children:[r.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:r.jsxs("tr",{className:"text-[11px] text-slate-500",children:[r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Bill"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Patient"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Type"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Amount"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Paid / Balance"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Date"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Actions"})]})}),r.jsxs("tbody",{children:[i&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"px-3 py-6 text-center text-[11px] text-slate-500",children:"Loading bills..."})}),!i&&!ae.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"px-3 py-6 text-center text-[11px] text-slate-500",children:"No pharmacy bills found for selected filters."})}),!i&&ae.map(we=>{var bn,dt,va;const lt=Number(we.total_amount??we.gross_total??we.net_amount??0),ht=Number(we.paid_amount??0),Kt=Number(we.balance_amount??lt-ht)||0,Wt=p2(we.status),Ht=we.bill_date||we.created_at||we.invoice_date||null,Ls=Ht?String(Ht).slice(0,16).replace("T"," "):"",bs=Fg(we),on=we.patient_name||`${((bn=we.patient)==null?void 0:bn.first_name)||""} ${((dt=we.patient)==null?void 0:dt.last_name)||""}`.trim()||"",ws=we.patient_uhid||((va=we.patient)==null?void 0:va.uhid),yn=Wt!=="PAID"&&Wt!=="CANCELLED"&&lt>0;return r.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/70 cursor-pointer",onClick:()=>it(we),children:[r.jsx("td",{className:"px-3 py-2 align-middle",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:we.bill_number||we.invoice_number||`PB-${we.id}`}),we.rx_number&&r.jsxs("span",{className:"text-[10px] text-slate-500",children:["Rx: ",we.rx_number]})]})}),r.jsx("td",{className:"px-3 py-2 align-middle",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-7 h-7 rounded-full bg-slate-100 flex items-center justify-center text-[11px] text-slate-700",children:r.jsx(rn,{className:"w-3 h-3"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] text-slate-900",children:on}),ws&&r.jsxs("div",{className:"text-[10px] text-slate-500",children:["UHID: ",ws]})]})]})}),r.jsx("td",{className:"px-3 py-2 align-middle",children:r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx(Ze,{variant:"outline",className:"border-slate-200 text-[10px] px-1.5 py-0.5 w-max",children:bs}),r.jsx(x2,{status:Wt})]})}),r.jsx("td",{className:"px-3 py-2 align-middle text-right",children:r.jsx("div",{className:"text-[11px] text-slate-900",children:Tr(lt)})}),r.jsx("td",{className:"px-3 py-2 align-middle text-right",children:r.jsxs("div",{className:"flex flex-col items-end gap-0.5",children:[r.jsxs("span",{className:"text-[11px] text-emerald-700",children:["Paid: ",Tr(ht)]}),r.jsxs("span",{className:"text-[11px] text-rose-700",children:["Bal: ",Tr(Kt)]})]})}),r.jsx("td",{className:"px-3 py-2 align-middle text-[11px] text-slate-700",children:r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(lr,{className:"w-3 h-3 text-slate-400"}),r.jsx("span",{children:Ls})]})}),r.jsx("td",{className:"px-3 py-2 align-middle text-right",onClick:Wa=>Wa.stopPropagation(),children:r.jsxs("div",{className:"flex justify-end gap-1.5",children:[r.jsx(Te,{variant:"outline",size:"icon",className:"h-7 w-7 rounded-full border-slate-200",onClick:()=>{const Wa=we.id||we.invoice_id;Wa&&f2(Wa)},children:r.jsx(to,{className:"w-3 h-3"})}),yn&&r.jsxs(Te,{size:"sm",className:"h-7 px-3 rounded-full text-[11px]",onClick:()=>xe(we),children:[r.jsx(Kl,{className:"w-3 h-3 mr-1"}),"Collect"]})]})})]},we.id)})]})]})})})})]}),r.jsxs(Ve,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(rt,{className:"pb-3",children:r.jsxs(ot,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx(Iw,{className:"w-4 h-4 text-slate-500"}),"Bill Details"]})}),r.jsx(He,{className:"space-y-3 text-xs",children:_?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-start justify-between gap-3",children:[r.jsxs("div",{className:"space-y-0.5",children:[r.jsx("div",{className:"text-[11px] font-semibold text-slate-900",children:_.patient_name||`${((ds=_.patient)==null?void 0:ds.first_name)||""} ${((ie=_.patient)==null?void 0:ie.last_name)||""}`.trim()||""}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID:"," ",_.patient_uhid||((Ie=_.patient)==null?void 0:Ie.uhid)||""]}),r.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[r.jsx(Ze,{variant:"outline",className:"border-slate-200 text-[10px] px-1.5 py-0.5",children:Fg(_)}),_.location&&r.jsxs("span",{className:"text-[10px] text-slate-500 flex items-center gap-1",children:[r.jsx(Ew,{className:"w-3 h-3"}),_.location]})]})]}),r.jsxs("div",{className:"text-right text-[11px] text-slate-500",children:[r.jsxs("div",{children:["Bill:"," ",_.bill_number||_.invoice_number||`PB-${_.id}`]}),r.jsxs("div",{children:["Date:"," ",((Me=(he=_.bill_date||_.created_at||"")==null?void 0:he.toString())==null?void 0:Me.slice(0,10))||""]}),r.jsx("div",{className:"mt-1",children:r.jsx(x2,{status:p2(_.status)})})]})]}),r.jsxs("div",{className:"border border-slate-100 rounded-xl px-3 py-2.5 flex flex-col gap-1.5 bg-slate-50/60",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-[11px] text-slate-600",children:"Total"}),r.jsx("span",{className:"text-[12px] font-semibold text-slate-900",children:Tr(_.total_amount??_.gross_total??_.net_amount)})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-[11px] text-slate-600",children:"Paid"}),r.jsx("span",{className:"text-[11px] text-emerald-700",children:Tr(_.paid_amount)})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-[11px] text-slate-600",children:"Balance"}),r.jsx("span",{className:"text-[11px] text-rose-700",children:Tr(_.balance_amount??Number(_.total_amount??_.gross_total??_.net_amount??0)-Number(_.paid_amount??0))})]})]}),r.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:r.jsx(Or,{className:"max-h-[260px]",children:r.jsxs("table",{className:"w-full text-[11px]",children:[r.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:r.jsxs("tr",{className:"text-[11px] text-slate-500",children:[r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"#"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Medicine"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Qty"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Rate"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Amount"})]})}),r.jsxs("tbody",{children:[!Ns.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-3 py-4 text-center text-[11px] text-slate-500",children:"No items found for this bill."})}),Ns.map((we,lt)=>r.jsxs("tr",{className:"border-t border-slate-100",children:[r.jsx("td",{className:"px-3 py-2 align-top text-slate-500",children:lt+1}),r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:we.item_name||we.medicine_name||""}),we.batch_no&&r.jsxs("span",{className:"text-[10px] text-slate-500",children:["Batch: ",we.batch_no]})]})}),r.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:we.qty||we.quantity||""}),r.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:Tr(we.rate||we.unit_price)}),r.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:Tr(we.amount||we.line_total)})]},we.id||lt))]})]})})}),r.jsxs("div",{className:"flex items-center justify-between pt-1",children:[r.jsxs(Te,{variant:"outline",size:"sm",className:"h-8 px-3 rounded-full text-[11px]",onClick:()=>{const we=_.id||_.invoice_id;we&&f2(we)},children:[r.jsx(to,{className:"w-3 h-3 mr-1"}),"Download PDF"]}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsxs(Te,{variant:"outline",size:"sm",className:"h-8 px-3 rounded-full text-[11px]",onClick:()=>xe(_),children:[r.jsx(Kl,{className:"w-3 h-3 mr-1"}),"Add Payment"]})})]})]}):r.jsx("div",{className:"py-10 text-center text-[11px] text-slate-500",children:"Select a pharmacy bill from the list to view details."})})]})]})}),r.jsx(us,{value:"returns",className:"space-y-3",children:r.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.4fr)_minmax(0,1.6fr)]",children:[r.jsxs(Ve,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(rt,{className:"pb-3",children:r.jsxs(ot,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx(Bi,{className:"w-4 h-4 text-slate-500"}),"New Pharmacy Return"]})}),r.jsxs(He,{className:"space-y-3 text-xs",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{className:"text-[11px] text-slate-600",children:"Source bill (search by bill no / UHID / patient)"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx(es,{className:"w-4 h-4 text-slate-400 absolute left-2.5 top-2.5"}),r.jsx(Se,{value:H,onChange:we=>q(we.target.value),placeholder:"Eg. PB-0001, UHID, patient name",className:"pl-8 h-9 text-xs bg-white border-slate-200 rounded-full"})]}),r.jsx(Te,{size:"sm",className:"h-9 px-3 rounded-full text-[11px]",onClick:Fe,children:"Search"})]})]}),G&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"border border-slate-100 rounded-xl p-3 bg-slate-50/60 space-y-1.5",children:r.jsxs("div",{className:"flex items-start justify-between gap-2",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] font-semibold text-slate-900",children:G.patient_name||`${((Ge=G.patient)==null?void 0:Ge.first_name)||""} ${((Be=G.patient)==null?void 0:Be.last_name)||""}`.trim()||""}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID:"," ",G.patient_uhid||((Ot=G.patient)==null?void 0:Ot.uhid)||""]})]}),r.jsxs("div",{className:"text-right text-[11px] text-slate-500",children:["Bill:"," ",G.bill_number||G.invoice_number||`PB-${G.id}`,r.jsx("br",{}),"Date:"," ",((Jt=(Rt=G.bill_date||G.created_at||"")==null?void 0:Rt.toString())==null?void 0:Jt.slice(0,10))||""]})]})}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{className:"text-[11px] text-slate-600",children:"Items & return quantity"}),r.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:r.jsx(Or,{className:"max-h-[250px]",children:r.jsxs("table",{className:"w-full text-[11px]",children:[r.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:r.jsxs("tr",{className:"text-[11px] text-slate-500",children:[r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"#"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Medicine"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Sold Qty"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Return Qty"})]})}),r.jsxs("tbody",{children:[!ye.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:4,className:"px-3 py-4 text-center text-[11px] text-slate-500",children:"No items found for this bill."})}),ye.map((we,lt)=>r.jsxs("tr",{className:"border-t border-slate-100",children:[r.jsx("td",{className:"px-3 py-2 align-top text-slate-500",children:lt+1}),r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:we.item_name||we.medicine_name||""}),we.batch_no&&r.jsxs("span",{className:"text-[10px] text-slate-500",children:["Batch: ",we.batch_no]})]})}),r.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:we.qty||we.quantity||""}),r.jsx("td",{className:"px-3 py-2 align-top text-right",children:r.jsx(Se,{type:"number",min:"0",value:we.return_qty??"",onChange:ht=>Ct(lt,ht.target.value),className:"h-8 w-20 ml-auto text-[11px] text-right bg-white border-slate-200 rounded-full"})})]},we.id||lt))]})]})})})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{className:"text-[11px] text-slate-600",children:"Reason for return"}),r.jsx(Yl,{value:ee,onChange:we=>te(we.target.value),rows:3,className:"text-[11px] bg-white border-slate-200 rounded-xl resize-none",placeholder:"Eg. Patient mismatch, wrong strength, expiry, doctor changed prescription, etc."})]}),r.jsx("div",{className:"flex justify-end pt-1",children:r.jsx(Te,{size:"sm",className:"h-9 px-4 rounded-full text-[11px]",onClick:vt,disabled:ce,children:ce?"Creating return...":r.jsxs(r.Fragment,{children:[r.jsx(Bi,{className:"w-3.5 h-3.5 mr-1"}),"Create Return Note"]})})})]})]})]}),r.jsxs(Ve,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(rt,{className:"pb-3",children:r.jsxs(ot,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx(Bi,{className:"w-4 h-4 text-slate-500"}),"Recent Pharmacy Returns"]})}),r.jsx(He,{className:"pt-0",children:r.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:r.jsx(Or,{className:"max-h-[420px]",children:r.jsxs("table",{className:"w-full text-[11px]",children:[r.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:r.jsxs("tr",{className:"text-[11px] text-slate-500",children:[r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Return"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Patient"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Source bill"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Refund"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Date"})]})}),r.jsxs("tbody",{children:[$&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-3 py-6 text-center text-[11px] text-slate-500",children:"Loading returns..."})}),!$&&!F.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-3 py-6 text-center text-[11px] text-slate-500",children:"No pharmacy returns found."})}),!$&&F.map(we=>{var Ht,Ls;const lt=Math.abs(Number(we.net_amount??we.total_amount??0)),ht=(we.created_at||"").toString().slice(0,16).replace("T"," "),Kt=we.patient_name||`${((Ht=we.patient)==null?void 0:Ht.first_name)||""} ${((Ls=we.patient)==null?void 0:Ls.last_name)||""}`.trim()||"",Wt=we.source_bill_number||we.source_invoice_number||"";return r.jsxs("tr",{className:"border-t border-slate-100",children:[r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:we.return_number||we.bill_number||`PR-${we.id}`}),we.reason&&r.jsx("span",{className:"text-[10px] text-slate-500",children:we.reason})]})}),r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsx("div",{className:"text-[11px] text-slate-900",children:Kt})}),r.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:Wt}),r.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:Tr(lt)}),r.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:ht||""})]},we.id)})]})]})})})})]})]})}),r.jsx(us,{value:"ipd",className:"space-y-3",children:r.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.3fr)_minmax(0,1.7fr)]",children:[r.jsxs(Ve,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(rt,{className:"pb-3",children:r.jsxs(ot,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx(Ew,{className:"w-4 h-4 text-slate-500"}),"Generate IPD Pharmacy Summary"]})}),r.jsxs(He,{className:"space-y-3 text-xs",children:[r.jsx("p",{className:"text-[11px] text-slate-500",children:"Generate consolidated pharmacy summary for all UNPAID / PARTIALLY_PAID IPD pharmacy invoices for a given admission. Use this for final IPD discharge billing."}),r.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{className:"text-[11px] text-slate-600",children:"Patient ID (internal PK)"}),r.jsx(Se,{value:X,onChange:we=>de(we.target.value),placeholder:"Eg. 123 (required)",className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{className:"text-[11px] text-slate-600",children:"IPD Admission ID (optional filter)"}),r.jsx(Se,{value:Ce,onChange:we=>ue(we.target.value),placeholder:"Eg. 45  IPD admission table ID",className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]})]}),r.jsx("div",{className:"flex justify-end pt-2",children:r.jsx(Te,{size:"sm",className:"h-9 px-4 rounded-full text-[11px]",onClick:pt,disabled:fe,children:fe?"Generating...":r.jsxs(r.Fragment,{children:[r.jsx(Iw,{className:"w-3.5 h-3.5 mr-1"}),"Generate Summary"]})})}),Xe&&r.jsxs("div",{className:"mt-3 border border-slate-100 rounded-xl p-3 bg-slate-50/60 space-y-2",children:[r.jsx("div",{className:"flex items-start justify-between gap-3",children:r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] font-semibold text-slate-900",children:Xe.patient_name||""}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID:"," ",Xe.patient_uhid||""]}),Xe.admission_id&&r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Admission ID: ",Xe.admission_id]})]})}),r.jsxs("div",{className:"border border-slate-100 rounded-lg px-3 py-2 bg-white space-y-1.5",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-[11px] text-slate-600",children:"Gross Total"}),r.jsx("span",{className:"text-[11px] font-semibold text-slate-900",children:Tr(Xe.total_amount)})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-[11px] text-slate-600",children:"Tax"}),r.jsx("span",{className:"text-[11px] text-slate-900",children:Tr(Xe.total_tax)})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-[11px] text-slate-600",children:"Net Amount"}),r.jsx("span",{className:"text-[11px] font-semibold text-slate-900",children:Tr(Xe.net_amount)})]})]}),r.jsx("div",{className:"border border-slate-100 rounded-lg overflow-hidden bg-white",children:r.jsx(Or,{className:"max-h-[220px]",children:r.jsxs("table",{className:"w-full text-[11px]",children:[r.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:r.jsxs("tr",{className:"text-[11px] text-slate-500",children:[r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Medicine"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Qty"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Amount"})]})}),r.jsxs("tbody",{children:[!((ys=Xe.items)!=null&&ys.length)&&r.jsx("tr",{children:r.jsx("td",{colSpan:3,className:"px-3 py-4 text-center text-[11px] text-slate-500",children:"No pharmacy items found in this summary."})}),(Qs=Xe.items)==null?void 0:Qs.map((we,lt)=>r.jsxs("tr",{className:"border-t border-slate-100",children:[r.jsx("td",{className:"px-3 py-2 align-top text-slate-900",children:we.medicine_name||""}),r.jsx("td",{className:"px-3 py-2 align-top text-right text-slate-700",children:we.qty}),r.jsx("td",{className:"px-3 py-2 align-top text-right text-slate-700",children:Tr(we.amount)})]},lt))]})]})})}),r.jsxs("p",{className:"text-[10px] text-slate-500",children:["Use this summary while generating the final IPD discharge invoice in the main Billing module. Each contributing pharmacy bill ID is available in ",r.jsx("code",{children:"sale_ids"})," if needed."]})]})]})]}),r.jsxs(Ve,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(rt,{className:"pb-3",children:r.jsxs(ot,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx(Ew,{className:"w-4 h-4 text-slate-500"}),"Recent IPD Pharmacy Bills"]})}),r.jsx(He,{className:"pt-0",children:r.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:r.jsx(Or,{className:"max-h-[420px]",children:r.jsxs("table",{className:"w-full text-[11px]",children:[r.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:r.jsxs("tr",{className:"text-[11px] text-slate-500",children:[r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Bill"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Patient"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Status"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Amount"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Date"})]})}),r.jsxs("tbody",{children:[!oe.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-3 py-6 text-center text-[11px] text-slate-500",children:"No IPD pharmacy bills found."})}),oe.map(we=>{var Ht,Ls;const lt=Number(we.total_amount??we.gross_total??we.net_amount??0),ht=p2(we.status),Kt=(we.bill_date||we.created_at||"").toString().slice(0,16).replace("T"," "),Wt=we.patient_name||`${((Ht=we.patient)==null?void 0:Ht.first_name)||""} ${((Ls=we.patient)==null?void 0:Ls.last_name)||""}`.trim()||"";return r.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60 cursor-pointer",onClick:()=>{const bs=we.id||we.invoice_id;bs&&f2(bs)},children:[r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsx("div",{className:"flex flex-col",children:r.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:we.bill_number||we.invoice_number||`PB-${we.id}`})})}),r.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:Wt}),r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsx(x2,{status:ht})}),r.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:Tr(lt)}),r.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:Kt||""})]},we.id)})]})]})})})})]})]})})]})]}),r.jsx(Wd,{open:k,onOpenChange:A,children:r.jsxs(Ic,{className:"max-w-md rounded-2xl",children:[r.jsxs(Mc,{children:[r.jsxs(Oc,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx(Kl,{className:"w-4 h-4 text-slate-600"}),"Collect Pharmacy Payment"]}),r.jsx(Rc,{className:"text-xs text-slate-500",children:"Record payment for this pharmacy invoice. You can add multiple payments later (partial payments supported)."})]}),T&&r.jsxs("div",{className:"space-y-3 text-xs",children:[r.jsxs("div",{className:"border border-slate-100 rounded-xl p-3 bg-slate-50/60 space-y-1",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] font-semibold text-slate-900",children:T.patient_name||`${((na=T.patient)==null?void 0:na.first_name)||""} ${((qt=T.patient)==null?void 0:qt.last_name)||""}`.trim()||""}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID:"," ",T.patient_uhid||((Gt=T.patient)==null?void 0:Gt.uhid)||""]})]}),r.jsxs("div",{className:"text-right text-[11px] text-slate-500",children:["Bill:"," ",T.bill_number||T.invoice_number||`PB-${T.id}`,r.jsx("br",{}),"Date:"," ",((Mt=(ra=T.bill_date||T.created_at||"")==null?void 0:ra.toString())==null?void 0:Mt.slice(0,10))||""]})]}),r.jsxs("div",{className:"flex items-center justify-between mt-1 pt-1 border-t border-dashed border-slate-200",children:[r.jsx("div",{className:"text-[11px] text-slate-600",children:"Total / Paid / Balance"}),r.jsxs("div",{className:"text-right text-[11px]",children:[r.jsx("div",{className:"text-slate-900",children:Tr(T.total_amount??T.gross_total??T.net_amount)}),r.jsx("div",{className:"text-emerald-700",children:Tr(T.paid_amount)}),r.jsx("div",{className:"text-rose-700",children:Tr(T.balance_amount??Number(T.total_amount??T.gross_total??T.net_amount??0)-Number(T.paid_amount??0))})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{className:"text-[11px] text-slate-600",children:"Payment mode"}),r.jsxs(Fs,{value:O,onValueChange:D,children:[r.jsx(Ds,{className:"w-full h-9 bg-white border-slate-200 rounded-full text-[11px]",children:r.jsx($s,{placeholder:"Select mode"})}),r.jsx(Os,{children:j7e.map(we=>r.jsx(zt,{value:we.value,children:we.label},we.value))})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(Qe,{className:"text-[11px] text-slate-600",children:"Amount"}),r.jsx(Se,{type:"number",min:"0",value:I,onChange:we=>M(we.target.value),className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]})]})]}),r.jsxs(Dc,{className:"mt-3",children:[r.jsx(Te,{variant:"outline",size:"sm",className:"h-8 px-3 rounded-full text-[11px]",onClick:()=>A(!1),children:"Cancel"}),r.jsx(Te,{size:"sm",className:"h-8 px-4 rounded-full text-[11px]",onClick:je,disabled:B,children:B?"Saving...":r.jsxs(r.Fragment,{children:[r.jsx(Dn,{className:"w-3 h-3 mr-1"}),"Save Payment"]})})]})]})})]})}function x2({status:t}){const s=(t||"").toUpperCase();let n=s||"",a="bg-slate-50 text-slate-700 border border-slate-200";return s==="UNPAID"||s==="PENDING"||s==="DRAFT"?(n="Unpaid",a="bg-amber-50 text-amber-700 border border-amber-200"):s==="PARTIAL"||s==="PARTIALLY_PAID"?(n="Partially paid",a="bg-blue-50 text-blue-700 border border-blue-200"):s==="PAID"?(n="Paid",a="bg-emerald-50 text-emerald-700 border border-emerald-200"):s==="CANCELLED"?(n="Cancelled",a="bg-rose-50 text-rose-700 border border-rose-200"):s==="FINALIZED"&&(n="Finalized",a="bg-slate-50 text-slate-700 border border-slate-300"),r.jsx("span",{className:`inline-flex items-center px-2 py-0.5 text-[10px] rounded-full ${a}`,children:n})}function S7e(t){if(!t)return"";const s=new Date(t);return`${s.toLocaleDateString()} ${s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`}function C7e(){const[t,s]=y.useState(""),[n,a]=y.useState(""),[i,l]=y.useState(""),[o,c]=y.useState([]),[d,u]=y.useState(!1),h=async()=>{try{u(!0);const x={context_type:"pharmacy"};t&&(x.q=t),n&&(x.date_from=n),i&&(x.date_to=i);const b=await epe(x);c(b.data||[])}catch{}finally{u(!1)}};y.useEffect(()=>{h()},[]);const f=o.reduce((x,b)=>x+(b.total_amount||0),0);return r.jsxs("div",{className:"p-3 sm:p-4 lg:p-6 space-y-3 sm:space-y-4",children:[r.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[r.jsx("div",{className:"inline-flex h-9 w-9 items-center justify-center rounded-2xl bg-slate-900 text-white",children:r.jsx(s1,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-base sm:text-lg font-semibold tracking-tight text-slate-900",children:"Pharmacy Counter Sales (OTC)"}),r.jsx("p",{className:"text-xs sm:text-sm text-slate-500",children:"View Pharmacy counter / OTC sales. (Future: add direct sale screen here.)"})]})]}),r.jsxs(Ve,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(rt,{className:"pb-2",children:r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx(es,{className:"absolute left-2 top-2.5 h-4 w-4 text-slate-400"}),r.jsx(Se,{placeholder:"UHID / Name / Phone",className:"pl-7 h-9 w-40 sm:w-52",value:t,onChange:x=>s(x.target.value)})]}),r.jsx(Se,{type:"date",className:"h-9 w-32",value:n,onChange:x=>a(x.target.value)}),r.jsx(Se,{type:"date",className:"h-9 w-32",value:i,onChange:x=>l(x.target.value)}),r.jsxs(Te,{size:"sm",variant:"outline",className:"h-9 text-xs",onClick:h,disabled:d,children:[d?r.jsx(ns,{className:"mr-1 h-3.5 w-3.5 animate-spin"}):null,"Apply"]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-1 text-right",children:[r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Sales in view"," ",r.jsx(Ze,{variant:"secondary",className:"ml-1 h-5 px-2 text-[10px]",children:o.length})]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Net amount"," ",r.jsxs("span",{className:"font-semibold text-slate-900",children:["",f.toFixed(2)]})]})]})]})}),r.jsxs(He,{className:"pt-0",children:[r.jsx("div",{className:"border-t border-slate-100 mt-2 mb-2"}),r.jsx("div",{className:"overflow-x-auto -mx-2 sm:mx-0",children:r.jsxs("table",{className:"min-w-full text-xs sm:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b border-slate-100 text-[11px] uppercase tracking-wide text-slate-500",children:[r.jsx("th",{className:"py-2 pl-3 pr-2 text-left font-medium",children:"Sale"}),r.jsx("th",{className:"py-2 px-2 text-left font-medium",children:"Patient"}),r.jsx("th",{className:"py-2 px-2 text-right font-medium",children:"Amount"})]})}),r.jsxs("tbody",{children:[o.length===0&&!d&&r.jsx("tr",{children:r.jsx("td",{colSpan:3,className:"py-10 text-center text-xs text-slate-500",children:"No counter sales found."})}),d&&r.jsx("tr",{children:r.jsx("td",{colSpan:3,className:"py-8 text-center",children:r.jsx(ns,{className:"mx-auto h-4 w-4 animate-spin text-slate-400"})})}),!d&&o.map(x=>r.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[r.jsx("td",{className:"py-2.5 pl-3 pr-2 align-top",children:r.jsxs("div",{className:"flex flex-col gap-0.5",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(s1,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsxs("span",{className:"font-medium text-[11px] text-slate-800",children:["Sale #",x.id]})]}),r.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-500",children:[r.jsx(lr,{className:"h-3 w-3"}),r.jsx("span",{children:S7e(x.created_at)})]})]})}),r.jsxs("td",{className:"py-2.5 px-2 align-top",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(rn,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:x.patient_name||""})]}),r.jsxs("div",{className:"mt-0.5 text-[10px] text-slate-500 flex flex-wrap gap-1",children:[x.patient_uhid&&r.jsx(Ze,{variant:"outline",className:"h-4 px-1.5 text-[9px]",children:x.patient_uhid}),x.payment_mode&&r.jsx("span",{className:"capitalize",children:x.payment_mode})]})]}),r.jsx("td",{className:"py-2.5 px-2 align-top text-right",children:r.jsxs("div",{className:"text-[11px] font-semibold text-slate-900",children:["",(x.total_amount||0).toFixed(2)]})})]},x.id))]})]})})]})]})]})}function k7e(t){if(!t)return"";const s=new Date(t);return`${s.toLocaleDateString()} ${s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`}function A7e(){const[t,s]=y.useState(""),[n,a]=y.useState(""),[i,l]=y.useState(""),[o,c]=y.useState([]),[d,u]=y.useState(!1),h=async()=>{try{u(!0);const x={};t&&(x.q=t),n&&(x.date_from=n),i&&(x.date_to=i);const b=await tpe(x);c(b.data||[])}catch{}finally{u(!1)}};y.useEffect(()=>{h()},[]);const f=o.reduce((x,b)=>x+(b.total_amount||0),0);return r.jsxs("div",{className:"p-3 sm:p-4 lg:p-6 space-y-3 sm:space-y-4",children:[r.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[r.jsx("div",{className:"inline-flex h-9 w-9 items-center justify-center rounded-2xl bg-slate-900 text-white",children:r.jsx(Bi,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-base sm:text-lg font-semibold tracking-tight text-slate-900",children:"Pharmacy Returns"}),r.jsx("p",{className:"text-xs sm:text-sm text-slate-500",children:"Shows Pharmacy bills treated as returns (negative amounts). Later you can connect this to a dedicated return workflow."})]})]}),r.jsxs(Ve,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(rt,{className:"pb-2",children:r.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx(es,{className:"absolute left-2 top-2.5 h-4 w-4 text-slate-400"}),r.jsx(Se,{placeholder:"UHID / Name / Phone",className:"pl-7 h-9 w-40 sm:w-52",value:t,onChange:x=>s(x.target.value)})]}),r.jsx(Se,{type:"date",className:"h-9 w-32",value:n,onChange:x=>a(x.target.value)}),r.jsx(Se,{type:"date",className:"h-9 w-32",value:i,onChange:x=>l(x.target.value)}),r.jsxs(Te,{size:"sm",variant:"outline",className:"h-9 text-xs",onClick:h,disabled:d,children:[d?r.jsx(ns,{className:"mr-1 h-3.5 w-3.5 animate-spin"}):null,"Apply"]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-1 text-right",children:[r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Returns in view"," ",r.jsx(Ze,{variant:"secondary",className:"ml-1 h-5 px-2 text-[10px]",children:o.length})]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Total refund"," ",r.jsxs("span",{className:"font-semibold text-slate-900",children:["",f.toFixed(2)]})]})]})]})}),r.jsxs(He,{className:"pt-0",children:[r.jsx("div",{className:"border-t border-slate-100 mt-2 mb-2"}),r.jsx("div",{className:"overflow-x-auto -mx-2 sm:mx-0",children:r.jsxs("table",{className:"min-w-full text-xs sm:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b border-slate-100 text-[11px] uppercase tracking-wide text-slate-500",children:[r.jsx("th",{className:"py-2 pl-3 pr-2 text-left font-medium",children:"Return"}),r.jsx("th",{className:"py-2 px-2 text-left font-medium",children:"Patient"}),r.jsx("th",{className:"py-2 px-2 text-right font-medium",children:"Amount"})]})}),r.jsxs("tbody",{children:[o.length===0&&!d&&r.jsx("tr",{children:r.jsx("td",{colSpan:3,className:"py-10 text-center text-xs text-slate-500",children:"No Pharmacy returns detected (no negative Pharmacy bills)."})}),d&&r.jsx("tr",{children:r.jsx("td",{colSpan:3,className:"py-8 text-center",children:r.jsx(ns,{className:"mx-auto h-4 w-4 animate-spin text-slate-400"})})}),!d&&o.map(x=>r.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[r.jsx("td",{className:"py-2.5 pl-3 pr-2 align-top",children:r.jsxs("div",{className:"flex flex-col gap-0.5",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(Bi,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsxs("span",{className:"font-medium text-[11px] text-slate-800",children:["Return #",x.id]})]}),r.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-500",children:[r.jsx(lr,{className:"h-3 w-3"}),r.jsx("span",{children:k7e(x.created_at)})]})]})}),r.jsxs("td",{className:"py-2.5 px-2 align-top",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(rn,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:x.patient_name||""})]}),r.jsx("div",{className:"mt-0.5 text-[10px] text-slate-500 flex flex-wrap gap-1",children:x.patient_uhid&&r.jsx(Ze,{variant:"outline",className:"h-4 px-1.5 text-[9px]",children:x.patient_uhid})})]}),r.jsx("td",{className:"py-2.5 px-2 align-top text-right",children:r.jsxs("div",{className:"text-[11px] font-semibold text-red-600",children:["",(x.total_amount||0).toFixed(2)]})})]},x.id))]})]})})]})]})]})}const E7e=[{value:"ALL",label:"All types"},{value:"OPD",label:"OPD"},{value:"IPD",label:"IPD"},{value:"OT",label:"OT"},{value:"COUNTER",label:"Counter"}],Ld="ALL_LOC";function T7e(t){const s=Number(t.requested_qty??t.total_qty??t.qty??t.quantity??0),n=Number(t.dispensed_qty??0),a=Math.max(s-n,0);return{requested:s,remaining:a}}function g2(t){const s=Number(t.duration_days||0),n=(t.frequency_code||t.frequency||"").trim();if(!s||!n)return"";const i=n.split("-").map(l=>Number(l||0)).reduce((l,o)=>l+(Number.isFinite(o)?o:0),0);return i?i*s:""}function P7e(){const[t,s]=y.useState("queue"),[n,a]=y.useState("ALL"),[i,l]=y.useState("PENDING"),[o,c]=y.useState(""),[d,u]=y.useState(!1),[h,f]=y.useState([]),[x,b]=y.useState(null),[v,w]=y.useState([]),[_,S]=y.useState(!1),[k,A]=y.useState([]),[T,P]=y.useState(Ld);y.useEffect(()=>{async function F(){try{const V=await bv(),$=(V==null?void 0:V.data)||[];A($),T||P(Ld)}catch{}}F()},[]),y.useEffect(()=>{O()},[n,i,T]);async function O(){try{u(!0);const F={status:i==="ALL"?void 0:i,type:n==="ALL"?void 0:n,limit:100};o.trim()&&(F.q=o.trim()),T&&T!==Ld&&(F.location_id=Number(T));const V=await m7e(F);f((V==null?void 0:V.data)||[])}catch{}finally{u(!1)}}async function D(F){try{const V=await QK(F.id),$=(V==null?void 0:V.data)||F;b($);const z=($.lines||$.items||[]).map(H=>{const{requested:q,remaining:G}=T7e(H);return{...H,requested_qty:q,remaining_qty:G||g2(H)||q,dispense_qty:G||g2(H)||q||""}});w(z),s("dispense")}catch{}}function I(F,V){w($=>$.map((z,H)=>H===F?{...z,dispense_qty:V}:z))}async function M(){var z,H;if(!x)return;const F=v.filter(q=>Number(q.dispense_qty||0)>0);if(!F.length){se.error("Enter quantity to dispense for at least one line");return}let V=x.location_id||null;if(T&&T!==Ld&&(V=Number(T)),!V){se.error("Select a pharmacy location before dispensing.");return}const $={lines:F.map(q=>({line_id:q.id,dispense_qty:Number(q.dispense_qty||0)})),location_id:V,create_sale:!0,context_type:(x.type||x.rx_type||"OPD").toUpperCase()};try{S(!0);const q=await h7e(x.id,$),G=(q==null?void 0:q.data)||{};G.sale_id||((z=G.sale)==null?void 0:z.id)||((H=G.pharmacy_sale)==null?void 0:H.id)||G.saleId||null?se.success("Medicines dispensed and pharmacy bill created"):se.success("Dispense recorded (no bill returned from server)"),await O(),b(null),w([]),s("queue")}catch(q){console.error("Dispense error",q)}finally{S(!1)}}const B=y.useMemo(()=>v||[],[v]),L=y.useMemo(()=>{if(!(k!=null&&k.length))return"No locations configured";if(!T||T===Ld)return"All / Not linked";const F=Number(T),V=k.find($=>$.id===F);return V?V.name||V.code||`Location #${V.id}`:`Location #${F}`},[k,T]);return r.jsxs("div",{className:"p-4 md:p-6 space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-slate-900",children:"Pharmacy Dispense"}),r.jsx("p",{className:"text-sm text-slate-500",children:"Convert prescriptions to pharmacy sales with FEFO-linked inventory and billing."})]}),r.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[r.jsx(B7,{className:"w-4 h-4 text-slate-500"}),r.jsx("span",{className:"text-slate-500",children:"Location"}),r.jsxs(Fs,{value:T,onValueChange:F=>P(F||Ld),children:[r.jsx(Ds,{className:"w-[200px] bg-white border-slate-200 rounded-full h-8 text-[11px]",children:r.jsx($s,{placeholder:"Select location"})}),r.jsxs(Os,{children:[r.jsx(zt,{value:Ld,children:"All / Not linked"}),k.map(F=>r.jsx(zt,{value:String(F.id),children:F.name||F.code||`Location #${F.id}`},F.id))]})]})]})]}),r.jsxs(jl,{value:t,onValueChange:s,children:[r.jsxs(Wi,{className:"mb-4",children:[r.jsx(ms,{value:"queue",children:"Dispense Queue"}),r.jsx(ms,{value:"dispense",disabled:!x,children:"Selected Rx"})]}),r.jsx(us,{value:"queue",className:"space-y-3",children:r.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.3fr)_minmax(0,1.7fr)]",children:[r.jsxs(Ve,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(rt,{className:"pb-3",children:r.jsxs("div",{className:"flex flex-col gap-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs(ot,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx(yr,{className:"w-4 h-4 text-slate-500"}),"Pending Prescriptions"]}),r.jsx(Te,{variant:"outline",size:"icon",className:"h-8 w-8 rounded-full border-slate-200",onClick:O,children:r.jsx($r,{className:"w-4 h-4"})})]}),r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsx("div",{className:"flex items-center gap-2",children:r.jsxs("div",{className:"relative flex-1",children:[r.jsx(es,{className:"w-4 h-4 text-slate-400 absolute left-2.5 top-2.5"}),r.jsx(Se,{value:o,onChange:F=>c(F.target.value),onKeyDown:F=>{F.key==="Enter"&&O()},placeholder:"Search UHID / patient / Rx no...",className:"pl-8 h-9 text-xs bg-white border-slate-200 rounded-full"})]})}),r.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[r.jsxs(Fs,{value:n,onValueChange:a,children:[r.jsx(Ds,{className:"w-[140px] bg-white border-slate-200 rounded-full h-8 text-[11px]",children:r.jsx($s,{placeholder:"Type"})}),r.jsx(Os,{children:E7e.map(F=>r.jsx(zt,{value:F.value,children:F.label},F.value))})]}),r.jsxs(Fs,{value:i,onValueChange:l,children:[r.jsx(Ds,{className:"w-[130px] bg-white border-slate-200 rounded-full h-8 text-[11px]",children:r.jsx($s,{placeholder:"Status"})}),r.jsxs(Os,{children:[r.jsx(zt,{value:"PENDING",children:"Pending only"}),r.jsx(zt,{value:"ALL",children:"All status"}),r.jsx(zt,{value:"PARTIAL",children:"Partial"}),r.jsx(zt,{value:"DISPENSED",children:"Dispensed"})]})]})]})]})]})}),r.jsx(He,{className:"pt-0",children:r.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:r.jsx(Or,{className:"max-h-[460px]",children:r.jsxs("table",{className:"w-full text-xs",children:[r.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:r.jsxs("tr",{className:"text-[11px] text-slate-500",children:[r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Rx"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Patient"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Type / Doctor"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Items"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Time"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Action"})]})}),r.jsxs("tbody",{children:[d&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-3 py-5 text-center text-[11px] text-slate-500",children:"Loading queue..."})}),!d&&!h.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-3 py-5 text-center text-[11px] text-slate-500",children:"No prescriptions waiting for dispense."})}),!d&&h.map(F=>{var Ee,ee,te;const V=F.type||F.rx_type||"OPD",$=(F.status||"").toUpperCase()||"PENDING",z=F.created_at||F.rx_datetime||F.bill_date||null,H=z?String(z).slice(0,16).replace("T"," "):"",q=F.patient_name||F.patient_full_name||F.patient_display||F.patient&&`${F.patient.first_name||""} ${F.patient.last_name||""}`.trim()||F.patient||"",G=F.patient_uhid||F.uhid||((Ee=F.patient)==null?void 0:Ee.uhid)||"",re=F.doctor_name||F.doctor||F.doctor_display||"",ye=((ee=F.items)==null?void 0:ee.length)||((te=F.lines)==null?void 0:te.length)||F.item_count||"";return r.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60 cursor-pointer",onClick:()=>D(F),children:[r.jsx("td",{className:"px-3 py-2 align-middle",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:F.rx_number||F.prescription_number||`RX-${F.id}`}),G&&r.jsxs("span",{className:"text-[10px] text-slate-500",children:["UHID:"," ",G]})]})}),r.jsx("td",{className:"px-3 py-2 align-middle",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-7 h-7 rounded-full bg-slate-100 flex items-center justify-center text-[11px] text-slate-700",children:r.jsx(rn,{className:"w-3 h-3"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] text-slate-900",children:q||""}),G&&r.jsx("div",{className:"text-[10px] text-slate-500",children:G})]})]})}),r.jsx("td",{className:"px-3 py-2 align-middle",children:r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx(Ze,{variant:"outline",className:"border-slate-200 text-[10px] px-1.5 py-0.5 w-max",children:V}),re&&r.jsxs("span",{className:"text-[10px] text-slate-500 flex items-center gap-1",children:[r.jsx(Es,{className:"w-3 h-3"}),re]})]})}),r.jsx("td",{className:"px-3 py-2 align-middle text-[11px] text-slate-700",children:ye}),r.jsx("td",{className:"px-3 py-2 align-middle text-[11px] text-slate-700",children:r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(lr,{className:"w-3 h-3 text-slate-400"}),r.jsx("span",{children:H})]})}),r.jsx("td",{className:"px-3 py-2 align-middle text-right",children:r.jsx(I7e,{status:$})})]},F.id)})]})]})})})})]}),r.jsxs(Ve,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(rt,{className:"pb-3",children:r.jsxs(ot,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx(dr,{className:"w-4 h-4 text-slate-500"}),"Selected Prescription"]})}),r.jsx(He,{className:"space-y-3",children:x?r.jsx("div",{className:"space-y-3 text-xs",children:(()=>{var $;const F=x.patient_name||x.patient_full_name||x.patient_display||x.patient&&`${x.patient.first_name||""} ${x.patient.last_name||""}`.trim()||"",V=x.patient_uhid||x.uhid||(($=x.patient)==null?void 0:$.uhid)||"";return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-slate-900",children:F}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID:"," ",V]})]}),r.jsxs("div",{className:"text-right text-[11px] text-slate-500",children:["Rx No:"," ",x.rx_number||x.prescription_number||`RX-${x.id}`,r.jsx("br",{}),"Type:"," ",x.type||x.rx_type||"OPD"]})]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Items:"," ",(x.lines||x.items||[]).length||""]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Queue filter:"," ",r.jsx("span",{className:"font-medium text-slate-700",children:L})]}),r.jsxs(Te,{size:"sm",variant:"outline",className:"h-8 px-3 rounded-full text-[11px]",onClick:()=>s("dispense"),children:[r.jsx(Dn,{className:"w-3 h-3 mr-1"}),"Open for dispensing"]})]})})()}):r.jsx("div",{className:"py-8 text-center text-xs text-slate-500",children:"Click a prescription from the queue to start dispensing."})})]})]})}),r.jsx(us,{value:"dispense",children:x?r.jsxs(Ve,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsxs(rt,{className:"pb-3 flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs(ot,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx(Dn,{className:"w-4 h-4 text-emerald-500"}),"Dispense Medicines"]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Rx:"," ",x.rx_number||x.prescription_number||`RX-${x.id}`," ",""," ",x.type||x.rx_type||"OPD"," ",""," ",x.patient_name||x.patient_full_name||x.patient_display||x.patient&&`${x.patient.first_name||""} ${x.patient.last_name||""}`.trim()||"",r.jsx("br",{}),"Queue filter:"," ",r.jsx("span",{className:"font-medium text-slate-700",children:L})]})]}),r.jsx(Te,{variant:"ghost",size:"sm",className:"h-8 px-3 text-[11px]",onClick:()=>s("queue"),children:"Back to queue"})]}),r.jsxs(He,{className:"space-y-3",children:[r.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:r.jsx(Or,{className:"max-h-[420px]",children:r.jsxs("table",{className:"w-full text-[11px]",children:[r.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:r.jsxs("tr",{className:"text-[11px] text-slate-500",children:[r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"#"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Medicine"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Instructions"}),r.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Prescribed Qty"}),r.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Dispense Qty"})]})}),r.jsxs("tbody",{children:[!B.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-3 py-4 text-center text-[11px] text-slate-500",children:"No lines found in this prescription."})}),B.map((F,V)=>{const $=F.dose_text||F.dose||"",z=F.frequency_code||F.frequency||(Number.isFinite(F.times_per_day)?`${F.times_per_day} times/day`:""),H=F.duration_days?`${F.duration_days} days`:F.duration||"",q=[$,z,H].filter(Boolean).join("  ")||"",G=[F.route,F.timing,F.instructions].filter(Boolean).join("  "),re=F.requested_qty??F.total_qty??F.qty??F.quantity??g2(F)??"";return r.jsxs("tr",{className:"border-t border-slate-100",children:[r.jsx("td",{className:"px-3 py-2 align-top text-slate-500",children:V+1}),r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:F.item_name||F.medicine_name||"Unnamed medicine"}),(F.item_strength||F.strength)&&r.jsx("span",{className:"text-[10px] text-slate-500",children:F.item_strength||F.strength})]})}),r.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{children:q}),G&&r.jsx("span",{className:"text-[10px] text-slate-500",children:G})]})}),r.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:re}),r.jsx("td",{className:"px-3 py-2 align-top text-right",children:r.jsx(Se,{type:"number",min:"0",value:F.dispense_qty??"",onChange:ye=>I(V,ye.target.value),className:"h-8 w-20 ml-auto text-[11px] text-right bg-white border-slate-200 rounded-full"})})]},F.id||V)})]})]})})}),r.jsxs("div",{className:"flex items-center justify-between pt-1",children:[r.jsx("div",{className:"text-[11px] text-slate-500",children:"Only lines with a positive Dispense Qty will create sale items."}),r.jsx(Te,{size:"sm",className:"h-9 px-4 rounded-full",onClick:M,disabled:_,children:_?"Dispensing...":r.jsxs(r.Fragment,{children:[r.jsx(Dn,{className:"w-3.5 h-3.5 mr-1"}),"Confirm Dispense & Generate Bill"]})})]})]})]}):r.jsx(Ve,{className:"border-slate-200 rounded-2xl shadow-sm",children:r.jsx(He,{className:"py-8 text-center text-sm text-slate-500",children:"Select a prescription from the queue to dispense."})})})]})]})}function I7e({status:t}){const s=(t||"").toUpperCase();let n=s,a="bg-slate-50 text-slate-700 border border-slate-200";return s==="PENDING"||s==="NEW"||s==="DRAFT"?(n=s==="DRAFT"?"Draft":"Pending",a="bg-amber-50 text-amber-700 border border-amber-200"):s==="PARTIAL"||s==="PARTIALLY_DISPENSED"?(n="Partial",a="bg-blue-50 text-blue-700 border border-blue-200"):s==="DISPENSED"||s==="COMPLETED"?(n="Dispensed",a="bg-emerald-50 text-emerald-700 border border-emerald-200"):s==="CANCELLED"&&(n="Cancelled",a="bg-rose-50 text-rose-700 border border-rose-200"),r.jsx("span",{className:`inline-flex items-center px-2 py-0.5 text-[10px] rounded-full ${a}`,children:n})}function y2(t){if(!t)return"";const s=new Date(t);return`${s.toLocaleDateString()} ${s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`}function M7e(t){switch(t){case"ISSUED":return{label:"Issued",className:"bg-amber-50 text-amber-700 border border-amber-100",icon:nn};case"PARTIALLY_DISPENSED":return{label:"Partial",className:"bg-blue-50 text-blue-700 border border-blue-100",icon:nn};case"DISPENSED":return{label:"Dispensed",className:"bg-emerald-50 text-emerald-700 border border-emerald-100",icon:Dn};case"CANCELLED":return{label:"Cancelled",className:"bg-red-50 text-red-700 border border-red-100",icon:Ux};default:return{label:t||"Unknown",className:"bg-slate-50 text-slate-700 border border-slate-100",icon:nn}}}function D7e(){const[t,s]=y.useState("ALL"),[n,a]=y.useState("ACTIVE"),[i,l]=y.useState("all"),[o,c]=y.useState(""),[d,u]=y.useState(""),[h,f]=y.useState(""),[x,b]=y.useState([]),[v,w]=y.useState([]),[_,S]=y.useState(!1),[k,A]=y.useState(null),[T,P]=y.useState(null),[O,D]=y.useState(null);y.useEffect(()=>{bv().then($=>{const z=$.data||[];b(z)}).catch(()=>{b([])})},[]);const I=async()=>{try{S(!0);const $={};t!=="ALL"&&($.type=t),(n==="ISSUED"||n==="PARTIALLY_DISPENSED"||n==="DISPENSED"||n==="CANCELLED")&&($.status=n),o.trim()&&($.patient_id=o.trim()),d&&($.from_date=d),h&&($.to_date=h);const z=await l$($);w(z.data||[])}catch{}finally{S(!1)}};y.useEffect(()=>{I()},[t,n]);const M=y.useMemo(()=>{let $=v||[];return n==="ACTIVE"&&($=$.filter(z=>z.status==="ISSUED"||z.status==="PARTIALLY_DISPENSED")),i!=="all"&&($=$.filter(z=>String(z.location_id)===String(i))),$},[v,n,i]);y.useEffect(()=>{if(!M.length){A(null);return}(!k||!M.some($=>$.id===k))&&A(M[0].id)},[M,k]);const B=y.useMemo(()=>M.find($=>$.id===k)||null,[M,k]),L=y.useMemo(()=>{const $=M.length,z=M.filter(q=>q.status==="ISSUED"||q.status==="PARTIALLY_DISPENSED").length,H=M.filter(q=>q.status==="DISPENSED").length;return{total:$,active:z,completed:H}},[M]),F=async $=>{if(!$)return;const H=($.lines||[]).filter(q=>q.status==="WAITING"||q.status==="PARTIAL"||q.status==="PARTIALLY_DISPENSED").map(q=>{const G=Number(q.requested_qty||0),re=Number(q.dispensed_qty||0),ye=G-re;return{line_id:q.id,quantity:ye}}).filter(q=>q.quantity>0);if(!H.length){se.info("No pending quantity to dispense for this prescription");return}if(window.confirm(`Dispense all remaining quantities (${H.length} line(s)) for Rx #${$.prescription_number||$.id}?`))try{P($.id),await Zfe($.id,{lines:H,remark:"Quick dispense all remaining from Rx Explorer"}),se.success("Prescription dispensed (remaining quantities)"),await I()}catch{}finally{P(null)}},V=async $=>{if($&&window.confirm(`Generate Pharmacy bill from dispensed lines for Rx #${$.prescription_number||$.id}?`))try{D($.id);const H=(await Jfe($.id)).data;se.success(`Pharmacy bill created: ${H.bill_number} (Net ${H.net_amount})`)}catch{}finally{D(null)}};return r.jsxs("div",{className:"p-3 sm:p-4 lg:p-6 space-y-3 sm:space-y-4",children:[r.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[r.jsx("div",{className:"inline-flex h-9 w-9 items-center justify-center rounded-2xl bg-slate-900 text-white",children:r.jsx(dr,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-base sm:text-lg font-semibold tracking-tight text-slate-900",children:"Pharmacy Rx Explorer (Inventory)"}),r.jsx("p",{className:"text-xs sm:text-sm text-slate-500",children:"View, filter, and dispense inventory-integrated prescriptions across OPD/IPD/Counter. Uses FEFO batches and auto-billing."})]})]}),r.jsxs(Ve,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(rt,{className:"pb-2",children:r.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4",children:[r.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx(es,{className:"absolute left-2 top-2.5 h-4 w-4 text-slate-400"}),r.jsx(Se,{placeholder:"Patient ID (optional)",className:"pl-7 h-9 w-36 sm:w-40",value:o,onChange:$=>c($.target.value)})]}),r.jsx(Se,{type:"date",className:"h-9 w-32",value:d,onChange:$=>u($.target.value)}),r.jsx(Se,{type:"date",className:"h-9 w-32",value:h,onChange:$=>f($.target.value)}),r.jsxs(Te,{size:"sm",variant:"outline",className:"h-9 text-xs",onClick:I,disabled:_,children:[_?r.jsx(ns,{className:"mr-1 h-3.5 w-3.5 animate-spin"}):r.jsx(_u,{className:"mr-1 h-3.5 w-3.5"}),"Apply"]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 justify-end text-[11px] text-slate-500",children:[r.jsxs("div",{children:["Total"," ",r.jsx(Ze,{variant:"secondary",className:"h-5 px-2 text-[10px]",children:L.total})]}),r.jsxs("div",{children:["Active"," ",r.jsx(Ze,{variant:"outline",className:"h-5 px-2 text-[10px]",children:L.active})]}),r.jsxs("div",{children:["Dispensed"," ",r.jsx(Ze,{variant:"outline",className:"h-5 px-2 text-[10px]",children:L.completed})]})]})]}),r.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(jl,{value:t,onValueChange:s,className:"hidden sm:block",children:r.jsxs(Wi,{className:"h-8",children:[r.jsx(ms,{value:"ALL",className:"text-[11px]",children:"All"}),r.jsx(ms,{value:"OPD",className:"text-[11px]",children:"OPD"}),r.jsx(ms,{value:"IPD",className:"text-[11px]",children:"IPD"}),r.jsx(ms,{value:"GENERAL",className:"text-[11px]",children:"General"})]})}),r.jsx("div",{className:"sm:hidden flex gap-1 text-[11px]",children:["ALL","OPD","IPD","GENERAL"].map($=>r.jsx(Ze,{variant:t===$?"default":"outline",className:"cursor-pointer",onClick:()=>s($),children:$},$))}),r.jsxs("div",{className:"flex flex-wrap items-center gap-1 text-[11px]",children:[r.jsx(Ze,{variant:n==="ACTIVE"?"default":"outline",className:"cursor-pointer",onClick:()=>a("ACTIVE"),children:"Active"}),r.jsx(Ze,{variant:n==="ALL"?"default":"outline",className:"cursor-pointer",onClick:()=>a("ALL"),children:"All"}),r.jsx(Ze,{variant:n==="ISSUED"?"default":"outline",className:"cursor-pointer",onClick:()=>a("ISSUED"),children:"Issued"}),r.jsx(Ze,{variant:n==="PARTIALLY_DISPENSED"?"default":"outline",className:"cursor-pointer",onClick:()=>a("PARTIALLY_DISPENSED"),children:"Partial"}),r.jsx(Ze,{variant:n==="DISPENSED"?"default":"outline",className:"cursor-pointer",onClick:()=>a("DISPENSED"),children:"Dispensed"}),r.jsx(Ze,{variant:n==="CANCELLED"?"default":"outline",className:"cursor-pointer",onClick:()=>a("CANCELLED"),children:"Cancelled"})]})]}),r.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[r.jsxs("span",{className:"text-[11px] text-slate-500 flex items-center gap-1",children:[r.jsx(B7,{className:"h-3 w-3"}),"Location"]}),r.jsxs("select",{className:"h-8 rounded-xl border border-slate-200 bg-white px-2 text-[11px] text-slate-700",value:i,onChange:$=>l($.target.value),children:[r.jsx("option",{value:"all",children:"All locations"}),x.map($=>r.jsx("option",{value:$.id,children:$.name},$.id))]})]})]})]})}),r.jsxs(He,{className:"pt-0",children:[r.jsx("div",{className:"border-t border-slate-100 mt-2 mb-2"}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[minmax(0,1.3fr)_minmax(0,2fr)] gap-3 lg:gap-4",children:[r.jsxs("div",{className:"border border-slate-100 rounded-2xl bg-slate-50/60 overflow-hidden flex flex-col",children:[r.jsxs("div",{className:"px-3 py-2 border-b border-slate-100 flex items-center justify-between",children:[r.jsxs("span",{className:"text-[11px] font-semibold text-slate-700 flex items-center gap-1",children:[r.jsx(dr,{className:"h-3.5 w-3.5 text-slate-500"}),"Prescriptions"]}),r.jsxs("span",{className:"text-[11px] text-slate-500",children:[M.length," in view"]})]}),_&&r.jsx("div",{className:"flex-1 flex items-center justify-center py-10",children:r.jsx(ns,{className:"h-5 w-5 animate-spin text-slate-400"})}),!_&&M.length===0&&r.jsx("div",{className:"flex-1 flex items-center justify-center py-10",children:r.jsx("p",{className:"text-xs text-slate-500",children:"No prescriptions found for this filter."})}),!_&&M.length>0&&r.jsx("div",{className:"flex-1 overflow-y-auto max-h-[520px]",children:M.map($=>{var G;const z=M7e($.status),H=$.id===k,q=$.status==="ISSUED"||$.status==="PARTIALLY_DISPENSED";return r.jsxs("button",{type:"button",onClick:()=>A($.id),className:["w-full text-left px-3 py-2.5 border-b border-slate-100","flex flex-col gap-1.5 hover:bg-slate-100/70",H?"bg-slate-100/80":""].filter(Boolean).join(" "),children:[r.jsxs("div",{className:"flex items-start justify-between gap-2",children:[r.jsxs("div",{className:"space-y-0.5",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx("span",{className:"text-[11px] font-semibold text-slate-900",children:$.prescription_number||`Rx #${$.id}`}),r.jsx(Ze,{variant:"outline",className:"h-4 px-1.5 text-[9px]",children:$.type||""}),q&&r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 animate-pulse"})]}),r.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-500",children:[r.jsx(lr,{className:"h-3 w-3"}),r.jsx("span",{children:y2($.created_at)})]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-1",children:[r.jsxs("div",{className:["inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-[10px]",z.className].join(" "),children:[r.jsx(z.icon,{className:"h-3 w-3"}),r.jsx("span",{children:z.label})]}),r.jsxs("div",{className:"text-[10px] text-slate-500 flex items-center gap-1",children:[r.jsx(fa,{className:"h-3 w-3"}),r.jsx("span",{children:$.location_name||""})]})]})]}),r.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-700",children:[r.jsx(rn,{className:"h-3 w-3 text-slate-400"}),r.jsx("span",{children:$.patient_name||""})]}),$.doctor_name&&r.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-500",children:[r.jsx(Es,{className:"h-3 w-3 text-slate-400"}),r.jsx("span",{children:$.doctor_name})]})]}),r.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2 text-[10px] text-slate-500",children:[r.jsxs("span",{children:[((G=$.lines)==null?void 0:G.length)||0," item(s)"]}),$.status==="DISPENSED"&&r.jsx("span",{children:" Fully dispensed"})]})]},$.id)})})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-white p-3 sm:p-4 flex flex-col min-h-[260px]",children:[!B&&r.jsx("div",{className:"flex-1 flex items-center justify-center",children:r.jsx("p",{className:"text-xs text-slate-500",children:"Select a prescription from the left to view details."})}),B&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-2 mb-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"text-sm font-semibold text-slate-900",children:["Rx ",B.prescription_number||`#${B.id}`]}),r.jsx(Ze,{variant:"outline",className:"h-5 px-2 text-[10px]",children:B.type||""})]}),r.jsxs("div",{className:"text-[11px] text-slate-600 flex flex-wrap items-center gap-1",children:[r.jsx(rn,{className:"h-3 w-3 text-slate-400"}),r.jsx("span",{children:B.patient_name||""}),r.jsx("span",{className:"mx-1",children:""}),r.jsx(Es,{className:"h-3 w-3 text-slate-400"}),r.jsx("span",{children:B.doctor_name||""}),r.jsx("span",{className:"mx-1",children:""}),r.jsx(fa,{className:"h-3 w-3 text-slate-400"}),r.jsx("span",{children:B.location_name||""})]}),r.jsxs("div",{className:"text-[10px] text-slate-500 flex flex-wrap items-center gap-2",children:[r.jsxs("span",{children:["Created: ",y2(B.created_at)]}),r.jsx("span",{children:""}),r.jsxs("span",{children:["Updated: ",y2(B.updated_at)]})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-2",children:[r.jsxs(Te,{size:"sm",variant:"outline",className:"h-8 text-[11px]",disabled:T===B.id||B.status==="DISPENSED"||B.status==="CANCELLED",onClick:()=>F(B),children:[T===B.id?r.jsx(ns,{className:"mr-1 h-3.5 w-3.5 animate-spin"}):r.jsx(Dn,{className:"mr-1 h-3.5 w-3.5"}),"Quick dispense remaining"]}),r.jsxs(Te,{size:"sm",className:"h-8 text-[11px]",disabled:O===B.id,onClick:()=>V(B),children:[O===B.id?r.jsx(ns,{className:"mr-1 h-3.5 w-3.5 animate-spin"}):r.jsx(O7e,{className:"mr-1 h-3.5 w-3.5"}),"Generate bill"]})]})]}),r.jsx("div",{className:"flex-1 rounded-2xl border border-slate-100 bg-slate-50/60 p-2 sm:p-3 overflow-y-auto max-h-[360px]",children:r.jsxs("table",{className:"w-full text-[11px]",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b border-slate-200 text-[10px] uppercase tracking-wide text-slate-500",children:[r.jsx("th",{className:"py-1.5 pr-2 text-left font-medium",children:"Item"}),r.jsx("th",{className:"py-1.5 px-2 text-right font-medium",children:"Req"}),r.jsx("th",{className:"py-1.5 px-2 text-right font-medium",children:"Disp"}),r.jsx("th",{className:"py-1.5 px-2 text-right font-medium",children:"Rem"}),r.jsx("th",{className:"py-1.5 pl-2 text-left font-medium",children:"Status"})]})}),r.jsxs("tbody",{children:[(B.lines||[]).map($=>{const z=Number($.requested_qty||0),H=Number($.dispensed_qty||0),q=z-H;return r.jsxs("tr",{className:"border-b border-slate-100",children:[r.jsxs("td",{className:"py-1.5 pr-2 align-top",children:[r.jsx("div",{className:"font-medium text-[11px] text-slate-900",children:$.item_name||""}),r.jsxs("div",{className:"text-[10px] text-slate-500",children:[$.item_strength&&r.jsxs("span",{children:[$.item_strength,"  "]}),$.frequency_code||""," ",$.duration_days?` ${$.duration_days} day(s)`:""]})]}),r.jsx("td",{className:"py-1.5 px-2 align-top text-right text-[10px] text-slate-700",children:z}),r.jsx("td",{className:"py-1.5 px-2 align-top text-right text-[10px] text-slate-700",children:H}),r.jsx("td",{className:"py-1.5 px-2 align-top text-right text-[10px] text-slate-700",children:q}),r.jsx("td",{className:"py-1.5 pl-2 align-top text-[10px]",children:r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-white px-2 py-0.5 border border-slate-200 text-slate-700",children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-slate-400"}),$.status]})})]},$.id)}),(!B.lines||B.lines.length===0)&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"py-4 text-center text-[11px] text-slate-500",children:"No items found in this prescription."})})]})]})}),B.notes&&r.jsxs("div",{className:"mt-2 text-[11px] text-slate-600",children:[r.jsx("span",{className:"font-semibold",children:"Notes:"})," ",B.notes]})]})]})]})]})]})]})}function O7e(t){return r.jsxs("svg",{viewBox:"0 0 24 24",...t,children:[r.jsx("path",{d:"M6 6h15l-1.5 9h-12z",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"}),r.jsx("circle",{cx:"9",cy:"19",r:"1",fill:"currentColor"}),r.jsx("circle",{cx:"17",cy:"19",r:"1",fill:"currentColor"})]})}const b2=()=>({_id:Math.random().toString(36).slice(2),item:null,requestedQty:"",doseText:"",frequency:"",timing:"",durationDays:"",instructions:"",searchQ:"",searchResults:[],searching:!1,showDropdown:!1});function v2(t){return t?t.name||t.item_name||t.brand_name||t.code||`#${t.id}`:""}function x6(t){if(!t)return"";const s=[];return t.code&&s.push(t.code),t.generic_name&&s.push(t.generic_name),t.form&&s.push(t.form),t.strength&&s.push(t.strength),t.pack_size&&s.push(`Pack: ${t.pack_size}`),t.manufacturer&&s.push(t.manufacturer),s.join("  ")}function FN({orderType:t,title:s,subtitle:n,variant:a="page",initialPatientId:i=null,initialPatient:l=null,lockPatient:o=!1,initialLocationId:c="",initialDoctorUserId:d="",initialVisitId:u="",initialIpdAdmissionId:h="",initialContextRef:f=""}){const x=y.useMemo(()=>{switch(t){case"OPD":return"OPD";case"IPD":return"IPD Ward";case"COUNTER":return"Counter / OTC";case"OT_CONSUMABLE":return"OT Consumables";default:return t||"Pharmacy"}},[t]),[b,v]=y.useState([]),[w,_]=y.useState(c||""),[S,k]=y.useState(i),[A,T]=y.useState(l),[P,O]=y.useState(d||""),[D,I]=y.useState(u||""),[M,B]=y.useState(h||""),[L,F]=y.useState(f||""),[V,$]=y.useState(""),[z,H]=y.useState([b2()]),[q,G]=y.useState(!1);y.useEffect(()=>{i&&!S&&k(i)},[i,S]),y.useEffect(()=>{l&&!A&&T(l)},[l,A]),y.useEffect(()=>{let fe=!0;return(async()=>{try{const pe=await bv();if(!fe)return;const oe=pe.data||[];v(oe),!w&&oe.length===1&&_(String(oe[0].id))}catch{if(!fe)return;v([])}})(),()=>{fe=!1}},[]);const re=(fe,pe)=>{H(oe=>oe.map(qe=>qe._id===fe?{...qe,...pe}:qe))},ye=()=>H(fe=>[...fe,b2()]),Ee=fe=>{H(pe=>pe.length===1?pe:pe.filter(oe=>oe._id!==fe))},ee=async(fe,pe)=>{var oe;if(re(fe,{searchQ:pe,item:null}),!pe||pe.length<2){re(fe,{searchResults:[],showDropdown:!1});return}re(fe,{searching:!0,showDropdown:!0});try{const qe=await vv({q:pe,page_size:10}),Xe=((oe=qe.data)==null?void 0:oe.items)||qe.data||[];re(fe,{searchResults:Xe})}catch{re(fe,{searchResults:[]})}finally{re(fe,{searching:!1})}},te=(fe,pe)=>{re(fe,{item:pe,searchQ:"",showDropdown:!1,searchResults:[]})},ce=fe=>{setTimeout(()=>{re(fe,{showDropdown:!1})},150)},ge=y.useMemo(()=>{const fe=Number(w),pe=b.find(oe=>oe.id===fe);return(pe==null?void 0:pe.name)||""},[b,w]),X=y.useMemo(()=>z.filter(fe=>fe.item&&fe.item.id&&Number(fe.requestedQty||0)>0).map(fe=>{const pe=Number(fe.requestedQty||0),oe=fe.durationDays?Number(fe.durationDays):null;return{item_id:fe.item.id,requested_qty:pe,dose_text:fe.doseText||null,frequency_code:fe.frequency||null,timing:fe.timing||null,duration_days:oe,instructions:fe.instructions||null}}),[z]),de=X.length>0,Ce=async()=>{if(!S){se.error("Please select a patient");return}if(!w){se.error("Please select Pharmacy location");return}if(!de){se.error("Add at least one item with quantity");return}const fe=[];V.trim()&&fe.push(V.trim()),t==="COUNTER"&&L.trim()&&fe.push(`Counter ref: ${L.trim()}`),t==="OT_CONSUMABLE"&&L.trim()&&fe.push(`OT case: ${L.trim()}`);const pe={type:t,patient_id:S,location_id:Number(w),lines:X};if(P.trim()){const oe=Number(P.trim());Number.isNaN(oe)||(pe.doctor_user_id=oe)}if(fe.length>0&&(pe.notes=fe.join(" | ")),t==="OPD"&&D.trim()){const oe=Number(D.trim());Number.isNaN(oe)||(pe.visit_id=oe)}if((t==="IPD"||t==="OT_CONSUMABLE")&&M.trim()){const oe=Number(M.trim());Number.isNaN(oe)||(pe.ipd_admission_id=oe)}try{G(!0);const qe=(await i$(pe)).data||{},Xe=qe.prescription_number||qe.id||"created";se.success(`Pharmacy order created (Rx ${Xe})`),H([b2()]),$(""),F(f||""),u||I(""),h||B("")}catch{}finally{G(!1)}},ue=r.jsxs(Ve,{className:"border-slate-200 rounded-2xl shadow-sm",children:[r.jsx(rt,{className:"pb-3",children:r.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Ze,{variant:"outline",className:"h-6 px-2 text-[10px] uppercase tracking-wide",children:x}),r.jsx("span",{className:"text-xs text-slate-500",children:"Creates a PharmacyPrescription visible in the Pharmacy Rx Explorer."})]}),r.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-slate-500",children:[r.jsx(fa,{className:"h-3.5 w-3.5 text-slate-400"}),r.jsx("span",{children:"Location:"}),r.jsxs("select",{className:"h-7 rounded-xl border border-slate-200 bg-white px-2 text-[11px] text-slate-700",value:w,onChange:fe=>_(fe.target.value),children:[r.jsx("option",{value:"",children:"Select"}),b.map(fe=>r.jsx("option",{value:fe.id,children:fe.name},fe.id))]})]})]})}),r.jsxs(He,{className:"space-y-4",children:[r.jsxs("div",{className:"grid gap-3 lg:grid-cols-[minmax(0,1.6fr)_minmax(0,1.4fr)]",children:[r.jsx("div",{children:r.jsx(Ve,{className:"border-slate-200 rounded-2xl bg-slate-50/70",children:r.jsxs(He,{className:"p-3 sm:p-4 space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(rn,{className:"h-4 w-4 text-slate-500"}),r.jsx("span",{className:"text-xs font-semibold text-slate-800",children:"Patient"})]}),!o&&r.jsx(Av,{value:S,onChange:(fe,pe)=>{k(fe),T(pe)},label:"Select patient"}),o&&A&&r.jsxs("div",{className:"rounded-xl border bg-white px-3 py-2 text-xs text-slate-700",children:[r.jsxs("div",{className:"font-semibold text-slate-900",children:[A.first_name," ",A.last_name]}),r.jsxs("div",{className:"mt-0.5 text-[11px] text-slate-500 flex flex-wrap gap-1",children:[A.uhid&&r.jsxs(Ze,{variant:"outline",className:"h-4 px-1.5 text-[9px]",children:["UHID ",A.uhid]}),A.phone&&r.jsxs("span",{children:[" ",A.phone]}),r.jsx("span",{children:" Patient fixed from context"})]})]}),!o&&A&&r.jsxs("div",{className:"rounded-xl border bg-slate-50 px-3 py-2 text-[11px] text-slate-700",children:["Selected:"," ",r.jsxs("span",{className:"font-semibold",children:[A.first_name," ",A.last_name]})," ",A.uhid&&r.jsxs(r.Fragment,{children:[" UHID ",A.uhid]}),A.phone&&r.jsxs(r.Fragment,{children:["  ",A.phone]})]})]})})}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ve,{className:"border-slate-200 rounded-2xl bg-slate-50/70",children:r.jsxs(He,{className:"p-3 sm:p-4 space-y-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Es,{className:"h-4 w-4 text-slate-500"}),r.jsx("span",{className:"text-xs font-semibold text-slate-800",children:"Clinical context"})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[t==="OPD"&&r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"OPD Visit ID (optional)"}),r.jsx(Se,{placeholder:"e.g., 1234",className:"h-8 text-xs",value:D,onChange:fe=>I(fe.target.value)})]}),(t==="IPD"||t==="OT_CONSUMABLE")&&r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"IPD Admission ID (optional)"}),r.jsx(Se,{placeholder:"e.g., 5678",className:"h-8 text-xs",value:M,onChange:fe=>B(fe.target.value)})]}),t==="COUNTER"&&r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Counter ref / token (optional)"}),r.jsx(Se,{placeholder:"e.g., Token #15",className:"h-8 text-xs",value:L,onChange:fe=>F(fe.target.value)})]}),t==="OT_CONSUMABLE"&&r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"OT case ref (optional)"}),r.jsx(Se,{placeholder:"e.g., OT-2025-001",className:"h-8 text-xs",value:L,onChange:fe=>F(fe.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Doctor user ID (optional)"}),r.jsx(Se,{placeholder:"e.g., 10",className:"h-8 text-xs",value:P,onChange:fe=>O(fe.target.value)}),r.jsx("p",{className:"text-[10px] text-slate-500",children:"Later you can auto-fill from logged-in doctor / visit."})]})]})]})}),A&&r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2 text-[11px] text-slate-700 flex flex-wrap items-center gap-2",children:[r.jsxs("span",{className:"font-semibold",children:[A.first_name," ",A.last_name]}),A.uhid&&r.jsxs(Ze,{variant:"outline",className:"h-4 px-1.5 text-[9px]",children:["UHID ",A.uhid]}),A.phone&&r.jsxs("span",{children:[" ",A.phone]})]})]})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/70 p-2 sm:p-3 space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between mb-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(dr,{className:"h-4 w-4 text-slate-500"}),r.jsx("span",{className:"text-xs font-semibold text-slate-800",children:"Order lines (medicines / consumables)"})]}),r.jsxs(Te,{size:"sm",variant:"outline",className:"h-7 text-[11px]",onClick:ye,children:[r.jsx(ps,{className:"mr-1 h-3.5 w-3.5"}),"Add line"]})]}),r.jsx("div",{className:"overflow-x-auto -mx-1 sm:mx-0",children:r.jsxs("table",{className:"min-w-full text-[11px]",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b border-slate-200 text-[10px] uppercase tracking-wide text-slate-500",children:[r.jsx("th",{className:"py-1.5 pr-2 text-left font-medium",children:"Item"}),r.jsx("th",{className:"py-1.5 px-2 text-left font-medium",children:"Dose / Frequency"}),r.jsx("th",{className:"py-1.5 px-2 text-left font-medium",children:"Duration"}),r.jsx("th",{className:"py-1.5 px-2 text-right font-medium",children:"Qty"}),r.jsx("th",{className:"py-1.5 pl-2 text-right font-medium w-10"})]})}),r.jsx("tbody",{children:z.map(fe=>r.jsxs("tr",{className:"border-b border-slate-100 align-top",children:[r.jsx("td",{className:"py-2 pr-2 min-w-[220px]",children:r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"relative",children:[r.jsx(es,{className:"absolute left-2 top-2 h-3.5 w-3.5 text-slate-400"}),r.jsx(Se,{className:"pl-6 h-8 text-xs",placeholder:fe.item?v2(fe.item):"Search item (name / code / generic)",value:fe.item?v2(fe.item):fe.searchQ,onChange:pe=>ee(fe._id,pe.target.value),onFocus:()=>{var pe;return((pe=fe.searchQ)==null?void 0:pe.length)>=2&&re(fe._id,{showDropdown:!0})},onBlur:()=>ce(fe._id)}),fe.showDropdown&&(fe.searching||fe.searchResults.length>0)&&r.jsxs("div",{className:"absolute z-30 mt-1 max-h-60 w-full overflow-auto rounded-xl border border-slate-200 bg-white shadow-lg",children:[fe.searching&&r.jsxs("div",{className:"px-3 py-2 text-[11px] text-slate-500 flex items-center gap-2",children:[r.jsx(ns,{className:"h-3.5 w-3.5 animate-spin text-slate-400"}),"Searching"]}),!fe.searching&&fe.searchResults.length===0&&r.jsx("div",{className:"px-3 py-2 text-[11px] text-slate-500",children:"No items found."}),!fe.searching&&fe.searchResults.map(pe=>r.jsxs("button",{type:"button",className:"w-full px-3 py-1.5 text-left hover:bg-slate-50",onMouseDown:oe=>oe.preventDefault(),onClick:()=>te(fe._id,pe),children:[r.jsx("div",{className:"font-medium text-[11px] text-slate-900",children:v2(pe)}),r.jsx("div",{className:"text-[10px] text-slate-500",children:x6(pe)})]},pe.id))]})]}),fe.item&&r.jsx("div",{className:"rounded-xl bg-white border border-slate-200 px-2 py-1 text-[10px] text-slate-600",children:x6(fe.item)||"Selected from inventory"}),r.jsx(Yl,{className:"h-14 text-[11px]",placeholder:"Special instructions (optional)",value:fe.instructions,onChange:pe=>re(fe._id,{instructions:pe.target.value})})]})}),r.jsx("td",{className:"py-2 px-2 min-w-[190px]",children:r.jsxs("div",{className:"space-y-1",children:[r.jsx(Se,{className:"h-8 text-xs",placeholder:"Dose text (e.g., 1-0-1)",value:fe.doseText,onChange:pe=>re(fe._id,{doseText:pe.target.value})}),r.jsx(Se,{className:"h-8 text-xs",placeholder:"Frequency (e.g., TDS, BD, HS)",value:fe.frequency,onChange:pe=>re(fe._id,{frequency:pe.target.value})}),r.jsx(Se,{className:"h-8 text-xs",placeholder:"Timing (e.g., after food)",value:fe.timing,onChange:pe=>re(fe._id,{timing:pe.target.value})})]})}),r.jsxs("td",{className:"py-2 px-2 min-w-[120px]",children:[r.jsx(Se,{className:"h-8 text-xs",type:"number",min:0,placeholder:"Days",value:fe.durationDays,onChange:pe=>re(fe._id,{durationDays:pe.target.value})}),r.jsx("p",{className:"mt-1 text-[10px] text-slate-500",children:"Later you can auto-calc qty from dose  days."})]}),r.jsx("td",{className:"py-2 px-2 text-right align-top min-w-[80px]",children:r.jsx(Se,{className:"h-8 text-xs text-right",type:"number",min:0,placeholder:"Qty",value:fe.requestedQty,onChange:pe=>re(fe._id,{requestedQty:pe.target.value})})}),r.jsx("td",{className:"py-2 pl-2 pr-1 align-top text-right",children:r.jsx(Te,{size:"icon",variant:"ghost",className:"h-7 w-7 text-slate-400 hover:text-red-600",onClick:()=>Ee(fe._id),children:r.jsx(wr,{className:"h-4 w-4"})})})]},fe._id))})]})}),r.jsxs("div",{className:"mt-1 text-[11px] text-slate-500 flex flex-wrap items-center gap-2",children:[r.jsxs("span",{children:["Valid lines:"," ",r.jsx("span",{className:"font-semibold",children:X.length})]}),r.jsx("span",{children:""}),r.jsxs("span",{children:["Location:"," ",r.jsx("span",{className:"font-semibold",children:ge})]})]})]}),r.jsxs("div",{className:"grid gap-3 sm:grid-cols-[minmax(0,1.7fr)_minmax(0,1fr)] items-start",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Overall notes (optional)"}),r.jsx(Yl,{className:"min-h-[60px] text-[11px]",placeholder:"Any clinical notes for Pharmacy",value:V,onChange:fe=>$(fe.target.value)})]}),r.jsxs("div",{className:"flex flex-col sm:items-end gap-2",children:[r.jsxs("div",{className:"text-[11px] text-slate-500",children:["This will create a"," ",r.jsx("span",{className:"font-semibold",children:"PharmacyPrescription"})," which appears in the Pharmacy Rx Explorer for dispensing & billing."]}),r.jsxs(Te,{className:"h-9 px-4 text-[11px]",disabled:q,onClick:Ce,children:[q?r.jsx(ns,{className:"mr-1 h-4 w-4 animate-spin"}):r.jsx(dr,{className:"mr-1 h-4 w-4"}),"Save ",x," order"]})]})]})]})]});return a==="embedded"?ue:r.jsxs("div",{className:"p-3 sm:p-4 lg:p-6 space-y-3 sm:space-y-4",children:[r.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[r.jsx("div",{className:"inline-flex h-9 w-9 items-center justify-center rounded-2xl bg-slate-900 text-white",children:r.jsx(dr,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-base sm:text-lg font-semibold tracking-tight text-slate-900",children:s}),r.jsx("p",{className:"text-xs sm:text-sm text-slate-500",children:n})]})]}),ue]})}function R7e(){return r.jsx(FN,{orderType:"IPD",title:"IPD Ward Medication Orders",subtitle:"Raise IPD ward medication orders linked to IPD admission. Orders flow to Pharmacy Rx Explorer with ward context."})}function L7e(){return r.jsx(FN,{orderType:"COUNTER",title:"Pharmacy Counter / OTC Orders",subtitle:"Create counter / OTC orders from Inventory medicines. Ideal for walk-in and quick sales via Rx  dispense  bill."})}function B7e(){return r.jsx(FN,{orderType:"OT_CONSUMABLE",title:"OT Consumables Orders",subtitle:"Order OT consumables (sutures, implants, disposables) against IPD admission / OT case. Orders go to Pharmacy / OT store via Rx queue."})}function F7e(){return r.jsx(FN,{orderType:"OPD",title:"OPD Medication Orders",subtitle:"Prescribe medicines for OPD visits from Inventory items. Orders appear in the Pharmacy Rx queue for dispensing and billing."})}function $7e(){const[t,s]=y.useState(null),[n,a]=y.useState(""),[i,l]=y.useState(""),[o]=y.useState("INR"),[c,d]=y.useState(null),[u,h]=y.useState([]),[f,x]=y.useState(!1),[b,v]=y.useState(!1),[w,_]=y.useState(null),S=y.useCallback(O=>{s(O||null)},[]),k=y.useCallback(async()=>{if(!t){h([]),d(null),a(""),l("");return}try{x(!0);const{data:O}=await Kue({doctor_user_id:t}),D=O||[];h(D);const I=D[0]||null;d(I||null),I?(a(I.base_fee!==null&&I.base_fee!==void 0?String(I.base_fee):""),l(I.followup_fee!==null&&I.followup_fee!==void 0?String(I.followup_fee):"")):(a(""),l(""))}catch(O){console.error(O),se.error("Failed to load consultation fees")}finally{x(!1)}},[t]);y.useEffect(()=>{k()},[k]);const A=async O=>{var D,I,M;if((D=O==null?void 0:O.preventDefault)==null||D.call(O),!t){se.error("Select doctor first");return}if(!n||Number(n)<=0){se.error("Enter a valid base consultation fee");return}try{v(!0);const B={doctor_user_id:t,base_fee:Number(n),currency:o};if(i&&Number(i)>0&&(B.followup_fee=Number(i)),c!=null&&c.id)await cI({...B,id:c.id}),se.success("Consultation fee updated");else{const{data:L}=await cI(B);se.success("Consultation fee created"),d(L)}k()}catch(B){console.error(B),se.error(((M=(I=B==null?void 0:B.response)==null?void 0:I.data)==null?void 0:M.detail)||"Failed to save fee")}finally{v(!1)}},T=async O=>{var D,I;if(window.confirm("Delete this consultation fee?"))try{_(O.id),await Que(O.id),se.success("Fee deleted"),h(M=>M.filter(B=>B.id!==O.id)),(c==null?void 0:c.id)===O.id&&(d(null),a(""),l(""))}catch(M){console.error(M),se.error(((I=(D=M==null?void 0:M.response)==null?void 0:D.data)==null?void 0:I.detail)||"Failed to delete fee")}finally{_(null)}},P=!!t;return r.jsx("div",{className:"min-h-[calc(100vh-5rem)] bg-slate-50 px-4 py-6 md:px-6",children:r.jsxs("div",{className:"mx-auto max-w-5xl space-y-6",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.2em] text-emerald-700",children:"Billing Masters"}),r.jsx("h1",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"Doctor Consultation Fees"}),r.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Configure standard consultation and follow-up fees for each doctor. These values can be reused during OPD billing and auto-pricing."})]}),r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsx(rt,{className:"border-b border-slate-100 pb-4",children:r.jsx(ot,{className:"text-sm font-semibold text-slate-900",children:"Configure Fee"})}),r.jsxs(He,{className:"space-y-4 pt-4",children:[r.jsxs("div",{className:"grid gap-4 md:grid-cols-[2fr,1.2fr,1.2fr] md:items-end",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:"Doctor"}),r.jsx(wl,{value:t,onChange:S}),!t&&r.jsx("p",{className:"mt-1 text-[11px] text-amber-600",children:"Select a doctor to manage consultation fees."})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:["Base consultation fee (",o,")"]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg border border-slate-200 bg-slate-50",children:r.jsx(Kl,{className:"h-4 w-4 text-slate-500"})}),r.jsx(Se,{type:"number",min:0,step:"50",value:n,onChange:O=>a(O.target.value),className:"h-9 text-sm"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:["Follow-up fee (",o,") (optional)"]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg border border-slate-200 bg-slate-50",children:r.jsx(Kl,{className:"h-4 w-4 text-slate-500"})}),r.jsx(Se,{type:"number",min:0,step:"50",value:i,onChange:O=>l(O.target.value),className:"h-9 text-sm"})]}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"Used when visit is marked as a follow-up (if supported by billing rules)."})]})]}),r.jsx("div",{className:"flex justify-end",children:r.jsx(Te,{type:"button",onClick:A,disabled:!P||b,className:"px-5",children:b?"Saving":c?"Update Fee":"Save Fee"})})]})]}),r.jsxs(Ve,{className:"rounded-3xl border-slate-200 shadow-sm",children:[r.jsx(rt,{className:"border-b border-slate-100 pb-3",children:r.jsx(ot,{className:"text-sm font-semibold text-slate-900",children:"Existing Fees"})}),r.jsxs(He,{className:"pt-4",children:[f&&r.jsx("div",{className:"space-y-2",children:[1,2].map(O=>r.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-100 bg-slate-50 px-3 py-3",children:[r.jsx(We,{className:"h-4 w-32"}),r.jsx(We,{className:"h-4 w-24"})]},O))}),!f&&(!u||u.length===0)&&r.jsx("p",{className:"py-6 text-sm text-slate-500",children:"No consultation fee configured yet for this doctor."}),!f&&u&&u.length>0&&r.jsx("div",{className:"space-y-2 text-sm",children:u.map(O=>r.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx("span",{className:"font-semibold text-slate-900",children:O.doctor_name||"Selected doctor"}),r.jsx(Ze,{variant:"outline",className:"border-slate-200 bg-slate-50 px-2 py-0.5 text-[11px]",children:O.is_active?"Active":"Inactive"})]}),r.jsx("p",{className:"text-xs text-slate-500",children:"Standard OPD consultation pricing used during billing."})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"text-right text-xs text-slate-600",children:[r.jsxs("div",{className:"font-semibold text-slate-900",children:["Base:",r.jsxs("span",{className:"inline-flex items-center gap-1",children:[r.jsx(Kl,{className:"h-3.5 w-3.5 text-slate-500"}),r.jsx("span",{children:O.base_fee})]})]}),r.jsxs("div",{children:["Follow-up:",O.followup_fee!=null?r.jsxs("span",{className:"inline-flex items-center gap-1",children:[r.jsx(Kl,{className:"h-3.5 w-3.5 text-slate-500"}),r.jsx("span",{children:O.followup_fee})]}):r.jsx("span",{className:"text-slate-400",children:"Not set"})]})]}),r.jsx(Te,{variant:"ghost",size:"icon",className:"h-8 w-8 text-slate-400 hover:text-rose-600",onClick:()=>T(O),disabled:w===O.id,children:r.jsx(wr,{className:"h-4 w-4"})})]})]},O.id))})]})]})]})})}function z7e({active_only:t=!0}={}){const s={active_only:t};return J.get("/lis/masters/departments",{params:s})}function U7e(t){return J.post("/lis/masters/departments",t)}function V7e(t,s){return J.put(`/lis/masters/departments/${t}`,s)}function H7e(t){return J.delete(`/lis/masters/departments/${t}`)}function W7e({department_id:t,search:s,active_only:n=!0}={}){const a={};return t&&(a.department_id=t),s&&(a.search=s),a.active_only=n,J.get("/lis/masters/services",{params:a})}function q7e(t){return J.post("/lis/masters/services/bulk",{items:t})}function G7e(t,s){return J.put(`/lis/masters/services/${t}`,s)}function K7e(t){return J.delete(`/lis/masters/services/${t}`)}const Y7e="#2563eb",N2={name:"",code:"",description:"",parent_id:"",is_active:!0},X7e={name:"",code:"",unit:"",normal_range:"",sample_type:"",method:"",comments_template:"",display_order:""};function Q7e(){const{branding:t}=zm()||{},s=(t==null?void 0:t.primary_color)||Y7e,n=nt("lis.masters.departments.view"),a=nt("lis.masters.departments.create"),i=nt("lis.masters.departments.update"),l=nt("lis.masters.departments.delete"),o=nt("lis.masters.services.view"),c=nt("lis.masters.services.create"),d=nt("lis.masters.services.update"),u=nt("lis.masters.services.delete"),[h,f]=y.useState([]),[x,b]=y.useState(!1),[v,w]=y.useState(""),[_,S]=y.useState(null),[k,A]=y.useState(!1),[T,P]=y.useState(null),[O,D]=y.useState(N2),[I,M]=y.useState(!1),[B,L]=y.useState([]),[F,V]=y.useState([]),[$,z]=y.useState(!1),[H,q]=y.useState(""),[G,re]=y.useState(!1),[ye,Ee]=y.useState(null),[ee,te]=y.useState(null),[ce,ge]=y.useState(null),[X,de]=y.useState(!1),Ce=y.useMemo(()=>h.filter(ie=>!ie.parent_id),[h]),ue=y.useMemo(()=>{const ie={};return h.forEach(Ie=>{Ie.parent_id&&(ie[Ie.parent_id]||(ie[Ie.parent_id]=[]),ie[Ie.parent_id].push(Ie))}),ie},[h]),fe=y.useMemo(()=>{const ie=v.trim().toLowerCase();return ie?Ce.filter(Ie=>[Ie.name,Ie.code].some(he=>(he||"").toString().toLowerCase().includes(ie))):Ce},[v,Ce]),pe=y.useMemo(()=>h.find(ie=>ie.id===_)||null,[h,_]),oe=y.useMemo(()=>{const ie=H.trim().toLowerCase();return B.filter(Ie=>!G&&!Ie.is_active?!1:ie?[Ie.name,Ie.code,Ie.sample_type,Ie.method].some(he=>(he||"").toString().toLowerCase().includes(ie)):!0)},[B,H,G]);y.useEffect(()=>{n&&qe()},[n]),y.useEffect(()=>{if(!pe||!o){L([]),V([]);return}Xe(pe.id)},[_,o]);async function qe(){var ie;try{b(!0);const Ie=await z7e({active_only:!0});f(Ie.data||[]),!_&&((ie=Ie.data)!=null&&ie.length)&&S(Ie.data[0].id)}catch(Ie){console.error("Failed to load lab departments",Ie),se.error("Failed to load lab departments")}finally{b(!1)}}async function Xe(ie){try{z(!0);const Ie=await W7e({department_id:ie,active_only:!G});L(Ie.data||[]),V([]),Ee(null),te(null)}catch(Ie){console.error("Failed to load lab services",Ie),se.error("Failed to load lab services")}finally{z(!1)}}function jt(ie=null){P(null),D({...N2,parent_id:ie||""}),A(!0)}function ft(ie){P(ie),D({name:ie.name||"",code:ie.code||"",description:ie.description||"",parent_id:ie.parent_id||"",is_active:ie.is_active,display_order:ie.display_order||""}),A(!0)}function it(ie){const{name:Ie,value:he,type:Me,checked:Ge}=ie.target;D(Be=>({...Be,[Ie]:Me==="checkbox"?Ge:he}))}async function _t(ie){var he,Me;if(ie==null||ie.preventDefault(),!O.name.trim()){se.error("Department name is required");return}const Ie={name:O.name.trim(),code:((he=O.code)==null?void 0:he.trim())||null,description:((Me=O.description)==null?void 0:Me.trim())||null,parent_id:O.parent_id||null,is_active:O.is_active,display_order:O.display_order?Number(O.display_order):null};try{M(!0),T?(await V7e(T.id,Ie),se.success("Department updated")):(await U7e(Ie),se.success("Department created")),A(!1),P(null),D(N2),await qe()}catch(Ge){console.error("Failed to save department",Ge),se.error("Failed to save department")}finally{M(!1)}}async function ve(ie){if(window.confirm(`Delete department "${ie.name}"?`))try{await H7e(ie.id),se.success("Department deleted"),ie.id===_&&S(null),await qe()}catch(Ie){console.error("Failed to delete department",Ie),se.error("Failed to delete department")}}function ae(){if(!pe){se.error("Select a department first");return}V(ie=>[...ie,{...X7e}])}function xe(ie,Ie,he){V(Me=>{const Ge=[...Me];return Ge[ie]={...Ge[ie],[Ie]:he},Ge})}async function je(){if(!pe)return;const ie=F.map(Ie=>{var he,Me,Ge,Be,Ot,Rt;return{...Ie,name:(Ie.name||"").trim(),department_id:pe.id,code:((he=Ie.code)==null?void 0:he.trim())||null,unit:((Me=Ie.unit)==null?void 0:Me.trim())||"",normal_range:((Ge=Ie.normal_range)==null?void 0:Ge.trim())||"",sample_type:((Be=Ie.sample_type)==null?void 0:Be.trim())||null,method:((Ot=Ie.method)==null?void 0:Ot.trim())||null,comments_template:((Rt=Ie.comments_template)==null?void 0:Rt.trim())||null,display_order:Ie.display_order?Number(Ie.display_order):null}}).filter(Ie=>Ie.name);if(!ie.length){se.error("Add at least one service row with a name");return}try{de(!0),await q7e(ie),se.success("Services saved"),await Xe(pe.id)}catch(Ie){console.error("Failed to bulk-create services",Ie),se.error("Failed to save services")}finally{de(!1)}}function Fe(ie){Ee(ie.id),te({...ie,display_order:ie.display_order??""})}function Ct(){Ee(null),te(null)}function vt(ie,Ie){te(he=>({...he,[ie]:Ie}))}async function pt(){var Ie,he,Me,Ge,Be,Ot,Rt;if(!ye||!ee)return;const ie={name:((Ie=ee.name)==null?void 0:Ie.trim())||"",code:((he=ee.code)==null?void 0:he.trim())||null,unit:((Me=ee.unit)==null?void 0:Me.trim())||"",normal_range:((Ge=ee.normal_range)==null?void 0:Ge.trim())||"",sample_type:((Be=ee.sample_type)==null?void 0:Be.trim())||null,method:((Ot=ee.method)==null?void 0:Ot.trim())||null,comments_template:((Rt=ee.comments_template)==null?void 0:Rt.trim())||null,is_active:!!ee.is_active,display_order:ee.display_order?Number(ee.display_order):null};if(!ie.name){se.error("Service name is required");return}try{ge(ye),await G7e(ye,ie),se.success("Service updated"),await Xe(pe.id),Ct()}catch(Jt){console.error("Failed to update service",Jt),se.error("Failed to update service")}finally{ge(null)}}async function Ns(ie){if(window.confirm(`Delete service "${ie.name}"?`))try{await K7e(ie.id),se.success("Service deleted"),await Xe(pe.id)}catch(Ie){console.error("Failed to delete service",Ie),se.error("Failed to delete service")}}function ds(ie){const Ie=ue[ie.id]||[],he=ie.id===_;return r.jsxs("div",{className:"mb-1",children:[r.jsxs("div",{className:`group flex items-center justify-between rounded-xl px-3 py-2 text-sm cursor-pointer border transition-all ${he?"border-transparent":"border-transparent hover:border-slate-200"}`,style:{backgroundColor:he?`${s}12`:"transparent"},onClick:()=>S(ie.id),children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Om,{className:`h-3 w-3 text-slate-400 transition-transform ${Ie.length?"group-hover:translate-x-0.5":"opacity-0"}`}),r.jsxs("div",{children:[r.jsxs("div",{className:"font-medium text-slate-800 flex items-center gap-1",children:[ie.name,!ie.is_active&&r.jsx("span",{className:"rounded-full bg-amber-50 px-2 py-0.5 text-[10px] font-semibold text-amber-700",children:"Inactive"})]}),ie.code&&r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Code: ",ie.code]})]})]}),(i||l)&&r.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[i&&r.jsx("button",{type:"button",onClick:Me=>{Me.stopPropagation(),ft(ie)},className:"inline-flex h-7 w-7 items-center justify-center rounded-full border border-slate-200 bg-white text-xs text-slate-600 hover:bg-slate-50",title:"Edit department",children:r.jsx(Fa,{className:"h-3 w-3"})}),l&&r.jsx("button",{type:"button",onClick:Me=>{Me.stopPropagation(),ve(ie)},className:"inline-flex h-7 w-7 items-center justify-center rounded-full border border-rose-100 bg-white text-xs text-rose-600 hover:bg-rose-50",title:"Delete department",children:r.jsx(wr,{className:"h-3 w-3"})})]})]}),Ie.length>0&&r.jsx("div",{className:"ml-4 border-l border-dashed border-slate-200 pl-3",children:Ie.map(Me=>ds(Me))})]},ie.id)}return!n&&!o?r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 p-4 text-sm text-amber-800",children:"You do not have permission to view LIS Masters."}):r.jsxs("div",{className:"flex h-full flex-col gap-4",children:[r.jsxs("div",{className:"flex items-center justify-between gap-3",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl",style:{backgroundColor:`${s}10`},children:r.jsx(Li,{className:"h-5 w-5",style:{color:s}})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-semibold text-slate-900",children:"Laboratory Report Masters"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Configure LIS departments, sub-departments and test master services for NABH-compliant lab reports."})]})]}),r.jsx("div",{className:"flex items-center gap-2 text-[11px] text-slate-500",children:r.jsxs("div",{className:"hidden items-center gap-1 rounded-full bg-slate-50 px-3 py-1 md:flex",children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500"}),"Auto-sets ",r.jsx("span",{className:"font-semibold",children:"Unit"})," &",r.jsx("span",{className:"font-semibold",children:"Normal Range"})," to - when empty"]})})]}),r.jsxs("div",{className:"grid flex-1 gap-4 xl:grid-cols-[320px,1fr] lg:grid-cols-[280px,1fr]",children:[r.jsxs("div",{className:"flex flex-col rounded-2xl border border-slate-100 bg-white p-3 shadow-sm",children:[r.jsxs("div",{className:"mb-3 flex items-center justify-between gap-2",children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:"Departments & Sub-departments"}),a&&r.jsxs("button",{type:"button",onClick:()=>jt(null),className:"inline-flex items-center gap-1 rounded-full bg-slate-900 px-2.5 py-1 text-[11px] font-medium text-white shadow-sm hover:bg-slate-800",children:[r.jsx(ps,{className:"h-3 w-3"}),"Add"]})]}),r.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx(es,{className:"pointer-events-none absolute left-2.5 top-2.5 h-3.5 w-3.5 text-slate-400"}),r.jsx("input",{type:"text",className:"h-8 w-full rounded-full border border-slate-200 bg-slate-50 pl-8 pr-3 text-xs text-slate-700 placeholder:text-slate-400 focus:border-slate-300 focus:bg-white focus:outline-none focus:ring-2 focus:ring-slate-100",placeholder:"Search departments...",value:v,onChange:ie=>w(ie.target.value)})]}),r.jsx("button",{type:"button",onClick:qe,className:"inline-flex h-8 w-8 items-center justify-center rounded-full border border-slate-200 bg-white text-slate-500 hover:bg-slate-50",title:"Refresh",children:r.jsx(ry,{className:"h-3.5 w-3.5"})})]}),r.jsx("div",{className:"scrollbar-thin flex-1 overflow-y-auto rounded-2xl bg-slate-50/60 p-2",children:x?r.jsx("div",{className:"flex h-full items-center justify-center text-xs text-slate-500",children:"Loading departments"}):fe.length?fe.map(ie=>ds(ie)):r.jsxs("div",{className:"flex flex-col items-center justify-center gap-1 py-8 text-center text-xs text-slate-500",children:[r.jsx(Li,{className:"h-4 w-4 text-slate-300"}),r.jsx("p",{children:"No departments yet."}),a&&r.jsxs("button",{type:"button",onClick:()=>jt(null),className:"mt-2 inline-flex items-center gap-1 rounded-full bg-slate-900 px-3 py-1.5 text-[11px] font-medium text-white hover:bg-slate-800",children:[r.jsx(ps,{className:"h-3 w-3"}),"Add first department"]})]})}),pe&&a&&r.jsxs("button",{type:"button",onClick:()=>jt(pe.id),className:"mt-3 inline-flex w-full items-center justify-center gap-1 rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-3 py-1.5 text-[11px] font-medium text-slate-700 hover:bg-white",children:[r.jsx(ps,{className:"h-3 w-3"}),"Add sub-department under ",r.jsx("span",{className:"font-semibold",children:pe.name})]})]}),r.jsxs("div",{className:"flex flex-col rounded-2xl border border-slate-100 bg-white p-3 shadow-sm",children:[r.jsxs("div",{className:"mb-3 flex flex-wrap items-center justify-between gap-2",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:pe?`Services for ${pe.name}`:"Select a department"}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"Add department-wise test master with units, normal ranges and method details."})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx($r,{className:"pointer-events-none absolute left-2.5 top-2 h-3 w-3 text-slate-400"}),r.jsx("input",{type:"text",className:"h-8 w-40 rounded-full border border-slate-200 bg-slate-50 pl-7 pr-3 text-xs text-slate-700 placeholder:text-slate-400 focus:border-slate-300 focus:bg-white focus:outline-none focus:ring-2 focus:ring-slate-100",placeholder:"Filter services",value:H,onChange:ie=>q(ie.target.value),disabled:!pe||!o})]}),r.jsxs("button",{type:"button",className:`inline-flex items-center gap-1 rounded-full border px-3 py-1.5 text-[11px] font-medium ${G?"border-slate-800 bg-slate-900 text-white":"border-slate-200 bg-white text-slate-600"}`,onClick:()=>re(ie=>!ie),disabled:!pe||!o,children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-amber-400"}),"Inactive"]}),c&&r.jsxs(r.Fragment,{children:[r.jsxs("button",{type:"button",onClick:ae,disabled:!pe,className:"inline-flex items-center gap-1 rounded-full bg-slate-900 px-3 py-1.5 text-[11px] font-medium text-white shadow-sm hover:bg-slate-800 disabled:cursor-not-allowed disabled:bg-slate-400",children:[r.jsx(ps,{className:"h-3 w-3"}),"Add Row"]}),r.jsxs("button",{type:"button",onClick:je,disabled:!pe||!F.length||X,className:"inline-flex items-center gap-1 rounded-full border border-emerald-600 bg-emerald-600 px-3 py-1.5 text-[11px] font-medium text-white shadow-sm hover:bg-emerald-700 disabled:cursor-not-allowed disabled:border-emerald-400 disabled:bg-emerald-400",children:[X?r.jsx(ry,{className:"h-3 w-3 animate-spin"}):r.jsx(L4,{className:"h-3 w-3"}),"Save All"]})]})]})]}),r.jsx("div",{className:"scrollbar-thin flex-1 overflow-auto rounded-2xl border border-slate-100",children:pe?$?r.jsx("div",{className:"flex h-full items-center justify-center text-xs text-slate-500",children:"Loading services"}):r.jsxs("table",{className:"min-w-full border-separate border-spacing-0 text-xs",children:[r.jsx("thead",{className:"sticky top-0 z-10 bg-slate-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"#"}),r.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"Service Name"}),r.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"Code"}),r.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"Unit"}),r.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"Normal Range"}),r.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"Sample Type"}),r.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"Method"}),r.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"Comments Template"}),r.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"Active"}),r.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-right font-medium text-slate-600",children:"Actions"})]})}),r.jsxs("tbody",{children:[oe.map((ie,Ie)=>{const he=ye===ie.id,Me=he?ee:ie;return r.jsxs("tr",{className:Ie%2?"bg-slate-50/40":"bg-white",children:[r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5 text-[11px] text-slate-500",children:Ie+1}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-md border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-1 focus:ring-slate-200 disabled:bg-slate-50",value:(Me==null?void 0:Me.name)||"",onChange:Ge=>vt("name",Ge.target.value),disabled:!d||!he})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-md border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-1 focus:ring-slate-200 disabled:bg-slate-50",value:(Me==null?void 0:Me.code)||"",onChange:Ge=>vt("code",Ge.target.value),disabled:!d||!he})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-md border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-1 focus:ring-slate-200 disabled:bg-slate-50",placeholder:"-",value:(Me==null?void 0:Me.unit)||"",onChange:Ge=>vt("unit",Ge.target.value),disabled:!d||!he})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-md border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-1 focus:ring-slate-200 disabled:bg-slate-50",placeholder:"-",value:(Me==null?void 0:Me.normal_range)||"",onChange:Ge=>vt("normal_range",Ge.target.value),disabled:!d||!he})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-md border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-1 focus:ring-slate-200 disabled:bg-slate-50",value:(Me==null?void 0:Me.sample_type)||"",onChange:Ge=>vt("sample_type",Ge.target.value),disabled:!d||!he})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-md border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-1 focus:ring-slate-200 disabled:bg-slate-50",value:(Me==null?void 0:Me.method)||"",onChange:Ge=>vt("method",Ge.target.value),disabled:!d||!he})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("textarea",{rows:1,className:"w-full rounded-md border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-1 focus:ring-slate-200 disabled:bg-slate-50",value:(Me==null?void 0:Me.comments_template)||"",onChange:Ge=>vt("comments_template",Ge.target.value),disabled:!d||!he})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-slate-900 focus:ring-slate-200",checked:!!(Me!=null&&Me.is_active),onChange:Ge=>vt("is_active",Ge.target.checked),disabled:!d||!he})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5 text-right",children:r.jsxs("div",{className:"flex justify-end gap-1",children:[d&&r.jsx(r.Fragment,{children:he?r.jsxs(r.Fragment,{children:[r.jsx("button",{type:"button",onClick:pt,disabled:ce===ie.id,className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-emerald-600 text-white hover:bg-emerald-700 disabled:cursor-not-allowed disabled:bg-emerald-400",title:"Save",children:r.jsx(L4,{className:"h-3 w-3"})}),r.jsx("button",{type:"button",onClick:Ct,className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-slate-100 text-slate-500 hover:bg-slate-200",title:"Cancel",children:r.jsx(Kn,{className:"h-3 w-3"})})]}):r.jsx("button",{type:"button",onClick:()=>Fe(ie),className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-slate-100 text-slate-600 hover:bg-slate-200",title:"Edit",children:r.jsx(Fa,{className:"h-3 w-3"})})}),u&&r.jsx("button",{type:"button",onClick:()=>Ns(ie),className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-rose-50 text-rose-600 hover:bg-rose-100",title:"Delete",children:r.jsx(wr,{className:"h-3 w-3"})})]})})]},ie.id)}),F.map((ie,Ie)=>r.jsxs("tr",{className:"bg-emerald-50/40 text-[11px]",children:[r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5 text-[11px] text-slate-500",children:oe.length+Ie+1}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-md border border-emerald-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-emerald-300 focus:outline-none focus:ring-1 focus:ring-emerald-200",placeholder:"Service name*",value:ie.name,onChange:he=>xe(Ie,"name",he.target.value)})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-md border border-emerald-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-emerald-300 focus:outline-none focus:ring-1 focus:ring-emerald-200",placeholder:"Code",value:ie.code,onChange:he=>xe(Ie,"code",he.target.value)})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-md border border-emerald-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-emerald-300 focus:outline-none focus:ring-1 focus:ring-emerald-200",placeholder:"-",value:ie.unit,onChange:he=>xe(Ie,"unit",he.target.value)})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-md border border-emerald-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-emerald-300 focus:outline-none focus:ring-1 focus:ring-emerald-200",placeholder:"-",value:ie.normal_range,onChange:he=>xe(Ie,"normal_range",he.target.value)})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-md border border-emerald-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-emerald-300 focus:outline-none focus:ring-1 focus:ring-emerald-200",placeholder:"Serum / Plasma...",value:ie.sample_type,onChange:he=>xe(Ie,"sample_type",he.target.value)})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("input",{type:"text",className:"w-full rounded-md border border-emerald-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-emerald-300 focus:outline-none focus:ring-1 focus:ring-emerald-200",placeholder:"Method",value:ie.method,onChange:he=>xe(Ie,"method",he.target.value)})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:r.jsx("textarea",{rows:1,className:"w-full rounded-md border border-emerald-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-emerald-300 focus:outline-none focus:ring-1 focus:ring-emerald-200",placeholder:"Default comments",value:ie.comments_template,onChange:he=>xe(Ie,"comments_template",he.target.value)})}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5 text-center text-[11px] text-slate-500",children:"Yes"}),r.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5 text-right",children:r.jsx("button",{type:"button",onClick:()=>V(he=>he.filter((Me,Ge)=>Ge!==Ie)),className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-emerald-50 text-emerald-700 hover:bg-emerald-100",title:"Remove row",children:r.jsx(Kn,{className:"h-3 w-3"})})})]},`draft-${Ie}`)),!oe.length&&!F.length&&r.jsx("tr",{children:r.jsxs("td",{colSpan:10,className:"px-3 py-5 text-center text-[11px] text-slate-500",children:["No services found for this department.",c&&r.jsxs(r.Fragment,{children:[" ","Click"," ",r.jsx("span",{className:"font-semibold",children:"Add Row"})," to start adding tests."]})]})})]})]}):r.jsx("div",{className:"flex h-full items-center justify-center text-xs text-slate-500",children:"Select a department on the left to view / add services."})})]})]}),k&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/40 p-4",children:r.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white shadow-xl",children:[r.jsxs("div",{className:"flex items-center justify-between border-b border-slate-100 px-4 py-3",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:T?"Edit Department":"Add Department"}),r.jsx("p",{className:"text-[11px] text-slate-500",children:O.parent_id?"This will be created as a sub-department.":"Top level department."})]}),r.jsx("button",{type:"button",onClick:()=>{A(!1),P(null)},className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-slate-100 text-slate-500 hover:bg-slate-200",children:r.jsx(Kn,{className:"h-3 w-3"})})]}),r.jsxs("form",{onSubmit:_t,className:"space-y-3 px-4 py-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"text-[11px] font-medium text-slate-700",children:["Department name ",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx("input",{name:"name",type:"text",className:"w-full rounded-lg border border-slate-200 px-2.5 py-1.5 text-xs text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-100",value:O.name,onChange:it,required:!0})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Code"}),r.jsx("input",{name:"code",type:"text",className:"w-full rounded-lg border border-slate-200 px-2.5 py-1.5 text-xs text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-100",value:O.code,onChange:it})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Display Order"}),r.jsx("input",{name:"display_order",type:"number",className:"w-full rounded-lg border border-slate-200 px-2.5 py-1.5 text-xs text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-100",value:O.display_order||"",onChange:it})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Parent Department (for sub-department)"}),r.jsxs("select",{name:"parent_id",className:"w-full rounded-lg border border-slate-200 px-2.5 py-1.5 text-xs text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-100",value:O.parent_id||"",onChange:it,children:[r.jsx("option",{value:"",children:"None (Top level)"}),Ce.map(ie=>r.jsx("option",{value:ie.id,children:ie.name},ie.id))]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Description"}),r.jsx("textarea",{name:"description",rows:2,className:"w-full rounded-lg border border-slate-200 px-2.5 py-1.5 text-xs text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-100",value:O.description,onChange:it})]}),r.jsxs("div",{className:"flex items-center justify-between pt-1",children:[r.jsxs("label",{className:"flex items-center gap-2 text-[11px] text-slate-700",children:[r.jsx("input",{type:"checkbox",name:"is_active",className:"h-3.5 w-3.5 rounded border-slate-300 text-slate-900 focus:ring-slate-200",checked:O.is_active,onChange:it}),"Active department"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{type:"button",onClick:()=>{A(!1),P(null)},className:"inline-flex items-center rounded-full border border-slate-200 bg-white px-3 py-1.5 text-[11px] font-medium text-slate-600 hover:bg-slate-50",children:"Cancel"}),r.jsxs("button",{type:"submit",disabled:I,className:"inline-flex items-center gap-1 rounded-full bg-slate-900 px-3 py-1.5 text-[11px] font-medium text-white hover:bg-slate-800 disabled:cursor-not-allowed disabled:bg-slate-400",children:[I&&r.jsx(ry,{className:"h-3 w-3 animate-spin"}),T?"Update":"Save"]})]})]})]})]})})]})}const g6=t=>t?new Date(t).toLocaleString():"",y6=t=>t?`LAB-${String(t).padStart(6,"0")}`:"";function Z7e(){const{id:t}=xd(),s=Va(),[n,a]=y.useState(!1),[i,l]=y.useState(null);y.useEffect(()=>{(async()=>{var h,f;a(!0);try{const{data:x}=await ufe(t);l(x)}catch(x){console.error(x),se.error(((f=(h=x==null?void 0:x.response)==null?void 0:h.data)==null?void 0:f.detail)||"Failed to load report")}finally{a(!1)}})()},[t]);const o=y.useMemo(()=>{if(!(i!=null&&i.sections))return[];const u=[];return i.sections.forEach(h=>{h.rows.forEach(f=>{u.push({department_name:h.department_name||"",sub_department_name:h.sub_department_name||"",...f})})}),u},[i]),c=async()=>{var u,h,f;try{const x=await J.get(`/lab/orders/${t}/report-pdf`,{responseType:"blob"}),b=new Blob([x.data],{type:"application/pdf"}),v=URL.createObjectURL(b);window.open(v,"_blank")}catch(x){console.error("PDF download error",x);const b=(u=x==null?void 0:x.response)==null?void 0:u.status;b===401?se.error("Session expired. Please login again."):b===403?se.error("You do not have permission to view this report."):se.error(((f=(h=x==null?void 0:x.response)==null?void 0:h.data)==null?void 0:f.detail)||"Failed to download PDF")}};if(n&&!i)return r.jsx("div",{className:"p-6",children:"Loading report"});if(!i)return r.jsx("div",{className:"p-6",children:"Report not found"});const d=i.lab_no?y6(i.lab_no):y6(i.order_id);return r.jsxs("div",{className:"min-h-screen text-black print:bg-white bg-slate-50",children:[r.jsxs("div",{className:"border-b bg-white px-3 md:px-4 py-2 flex items-center justify-between print:hidden",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("button",{className:"btn-ghost flex items-center gap-1 text-xs md:text-sm",onClick:()=>s(-1),children:[r.jsx(Qb,{className:"h-4 w-4"}),"Back"]}),r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:gap-2 text-xs md:text-sm font-medium",children:[r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(gl,{className:"h-4 w-4 text-slate-600"}),r.jsx("span",{children:"Lab Report"})]}),r.jsxs("span",{className:"text-[11px] text-gray-500",children:[i.patient_name,"  ",d]})]})]}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsxs("button",{className:"btn flex items-center gap-2 text-xs md:text-sm",onClick:c,children:[r.jsx(gl,{className:"h-4 w-4"}),"Download"]})})]}),r.jsxs("div",{className:"max-w-4xl mx-auto bg-white shadow-sm print:shadow-none my-3 md:my-4 print:my-0 px-3 md:px-6 py-4 md:py-6 print:p-4",children:[r.jsx("header",{className:"border-b pb-3 md:pb-4 mb-3 md:mb-4",children:r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[r.jsx("div",{children:r.jsx("h1",{className:"text-lg md:text-xl font-semibold tracking-wide",children:"LABORATORY REPORT"})}),r.jsxs("div",{className:"text-right text-[11px] md:text-xs",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Lab No:"})," ",d]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Patient:"})," ",i.patient_name||""]})]})]})}),r.jsx("section",{className:"mb-3 md:mb-4",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-[11px] md:text-xs",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Patient Name: "}),r.jsx("span",{children:i.patient_name||""})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"UHID: "}),r.jsx("span",{children:i.patient_uhid||""})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Gender: "}),r.jsx("span",{children:i.patient_gender||""})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Age: "}),r.jsx("span",{children:i.patient_age_text||""})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Patient Type: "}),r.jsx("span",{children:i.patient_type||""})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Received On: "}),r.jsx("span",{children:g6(i.received_on)})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Reported On: "}),r.jsx("span",{children:g6(i.reported_on)})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold",children:"Referred By: "}),r.jsx("span",{children:i.referred_by||""})]})]})]})}),r.jsx("section",{className:"space-y-4",children:i.sections&&i.sections.length>0?i.sections.map((u,h)=>r.jsxs("div",{children:[r.jsx("div",{className:"bg-slate-100 border px-3 py-2 mb-1",children:r.jsxs("div",{className:"text-[11px] font-semibold text-slate-700",children:[u.department_name||"Department",u.sub_department_name?` / ${u.sub_department_name}`:""]})}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-[11px] border",children:[r.jsx("thead",{className:"bg-slate-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"border px-2 py-1 text-left",children:"Test"}),r.jsx("th",{className:"border px-2 py-1 text-left",children:"Result"}),r.jsx("th",{className:"border px-2 py-1 text-left",children:"Unit"}),r.jsx("th",{className:"border px-2 py-1 text-left",children:"Normal Range"}),r.jsx("th",{className:"border px-2 py-1 text-left",children:"Flag"}),r.jsx("th",{className:"border px-2 py-1 text-left",children:"Comments"})]})}),r.jsx("tbody",{children:u.rows.map((f,x)=>r.jsxs("tr",{children:[r.jsx("td",{className:"border px-2 py-1",children:f.service_name||""}),r.jsxs("td",{className:"border px-2 py-1",children:[f.result_value||"",f.flag?` (${f.flag})`:""]}),r.jsx("td",{className:"border px-2 py-1",children:f.unit||""}),r.jsx("td",{className:"border px-2 py-1",children:f.normal_range||""}),r.jsx("td",{className:"border px-2 py-1",children:f.flag||""}),r.jsx("td",{className:"border px-2 py-1",children:f.comments||""})]},x))})]})})]},`${u.department_id}-${u.sub_department_id}-${h}`)):r.jsx("div",{className:"text-xs text-gray-500",children:"No results available for this order."})}),r.jsxs("section",{className:"mt-5 md:mt-6",children:[r.jsx("h3",{className:"text-xs md:text-sm font-semibold mb-1",children:"Latest Results Summary"}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-[11px] border",children:[r.jsx("thead",{className:"bg-slate-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"border px-2 py-1 text-left",children:"Department"}),r.jsx("th",{className:"border px-2 py-1 text-left",children:"Sub-Department"}),r.jsx("th",{className:"border px-2 py-1 text-left",children:"Test"}),r.jsx("th",{className:"border px-2 py-1 text-left",children:"Result"}),r.jsx("th",{className:"border px-2 py-1 text-left",children:"Unit"}),r.jsx("th",{className:"border px-2 py-1 text-left",children:"Normal Range"}),r.jsx("th",{className:"border px-2 py-1 text-left",children:"Flag"})]})}),r.jsx("tbody",{children:o.length>0?o.map((u,h)=>r.jsxs("tr",{children:[r.jsx("td",{className:"border px-2 py-1",children:u.department_name||""}),r.jsx("td",{className:"border px-2 py-1",children:u.sub_department_name||""}),r.jsx("td",{className:"border px-2 py-1",children:u.service_name||""}),r.jsx("td",{className:"border px-2 py-1",children:u.result_value||""}),r.jsx("td",{className:"border px-2 py-1",children:u.unit||""}),r.jsx("td",{className:"border px-2 py-1",children:u.normal_range||""}),r.jsx("td",{className:"border px-2 py-1",children:u.flag||""})]},h)):r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"border px-2 py-2 text-center text-gray-400",children:"No results to summarise."})})})]})})]}),r.jsxs("section",{className:"mt-6 md:mt-8 grid grid-cols-2 gap-6 text-[11px]",children:[r.jsx("div",{children:r.jsx("div",{className:"border-t pt-4 text-center",children:"Technician / Lab In-charge"})}),r.jsx("div",{children:r.jsx("div",{className:"border-t pt-4 text-center",children:"Pathologist / Authorized Signatory"})})]})]})]})}function J7e({value:t=[],onChange:s}){const[n,a]=y.useState(""),[i,l]=y.useState(!1),[o,c]=y.useState([]);y.useEffect(()=>{let f=!0;return l(!0),Rk({q:n,active:!0,page_size:50}).then(x=>{f&&c(x.data||[])}).finally(()=>f&&l(!1)),()=>{f=!1}},[n]);const d=y.useMemo(()=>new Set(t||[]),[t]),u=y.useMemo(()=>o.filter(f=>d.has(f.id)),[o,d]),h=f=>{const x=new Set(d);x.has(f)?x.delete(f):x.add(f),s==null||s([...x])};return r.jsxs("div",{className:"space-y-2 text-black",children:[r.jsx("label",{className:"text-sm font-medium",children:"Select Tests"}),r.jsxs("div",{className:"relative",children:[r.jsx(es,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),r.jsx("input",{className:"input pl-9",placeholder:"Search by code/name",value:n,onChange:f=>a(f.target.value)})]}),r.jsx("div",{className:"grid gap-2 md:grid-cols-2",children:(o||[]).slice(0,10).map(f=>{const x=d.has(f.id);return r.jsxs("button",{type:"button",onClick:()=>h(f.id),className:["rounded-xl border p-3 text-left transition",x?"border-blue-500 bg-blue-50":"hover:bg-gray-50"].join(" "),children:[r.jsxs("div",{className:"font-medium",children:[f.code,"  ",f.name]}),r.jsxs("div",{className:"text-xs text-gray-500",children:["",Number(f.price||0).toFixed(2)]})]},f.id)})}),u.length>0&&r.jsxs("div",{className:"rounded-xl border p-3",children:[r.jsx("div",{className:"text-xs font-medium mb-2",children:"Selected"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:u.map(f=>r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-blue-50 px-3 py-1 text-xs",children:[f.code,r.jsx("button",{onClick:()=>h(f.id),className:"ml-1 rounded-full p-0.5 hover:bg-blue-100",children:r.jsx(Kn,{className:"h-3 w-3"})})]},f.id))})]}),i&&r.jsx("div",{className:"text-xs text-gray-500",children:"Loading"})]})}const b6=t=>t?new Date(t).toLocaleString():"",w2=t=>t?`LAB-${String(t).padStart(6,"0")}`:"";function e9e(){const[t,s]=y.useState(""),[n,a]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(!1),[d,u]=y.useState(null),[h,f]=y.useState([]),[x,b]=y.useState("routine"),[v,w]=y.useState("all"),[_,S]=y.useState("all"),[k,A]=y.useState(""),[T,P]=y.useState(""),O=Va(),D=async()=>{l(!0);try{const{data:L}=await n$({page_size:200});a(Array.isArray(L)?L:(L==null?void 0:L.items)||[])}catch(L){console.error(L),se.error("Failed to load orders")}finally{l(!1)}};y.useEffect(()=>{D()},[]);const I=async()=>{var L,F;if(!d||h.length===0){se.error("Select patient and at least one test");return}try{const{data:V}=await s$({patient_id:d,priority:x,test_ids:h});se.success("Order created"),c(!1),u(null),f([]),b("routine");const $=(V==null?void 0:V.id)||(V==null?void 0:V.order_id);$?O(`/lab/orders/${$}`):D()}catch(V){console.error(V),se.error(((F=(L=V==null?void 0:V.response)==null?void 0:L.data)==null?void 0:F.detail)||"Create failed")}},M=y.useMemo(()=>n.filter(L=>{var V,$,z,H;const F=(t||"").trim().toLowerCase();if(F){const q=((V=L.patient)==null?void 0:V.full_name)||(($=L.patient)==null?void 0:$.first_name)||""+((z=L.patient)==null?void 0:z.last_name)||"",G=((H=L.patient)==null?void 0:H.uhid)||"",re=w2(L.id);if(!`${q} ${G} ${re}`.toLowerCase().includes(F))return!1}if(v!=="all"&&(L.status||"").toLowerCase()!==v||_!=="all"&&(L.priority||"").toLowerCase()!==_)return!1;if(k||T){const q=L.created_at||L.createdAt;if(!q)return!1;const G=new Date(q).setHours(0,0,0,0);if(k){const re=new Date(k).setHours(0,0,0,0);if(G<re)return!1}if(T){const re=new Date(T).setHours(0,0,0,0);if(G>re)return!1}}return!0}),[n,t,v,_,k,T]),B=M.length;return r.jsxs("div",{className:"p-3 md:p-6 text-black space-y-4",children:[r.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Li,{className:"h-5 w-5 text-sky-600"}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg md:text-xl font-semibold",children:"Lab Orders"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Create, track, and finalize LIS orders (NABH aligned)"})]})]}),r.jsx(Cn,{anyOf:["lab.orders.create","orders.lab.create"],children:r.jsxs("button",{className:"btn-primary flex items-center gap-1 text-sm",onClick:()=>c(!0),children:[r.jsx(ps,{className:"h-4 w-4"}),r.jsx("span",{className:"hidden sm:inline",children:"New Lab Order"}),r.jsx("span",{className:"sm:hidden",children:"New"})]})})]}),r.jsxs("section",{className:"rounded-xl border bg-white p-3 md:p-4 space-y-3",children:[r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3",children:[r.jsxs("div",{className:"relative flex-1 max-w-xl",children:[r.jsx(es,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),r.jsx("input",{className:"input pl-9 text-sm",placeholder:"Search by UHID, patient name, or Lab No (e.g., LAB-000123)",value:t,onChange:L=>s(L.target.value)})]}),r.jsxs("button",{type:"button",onClick:D,className:"text-xs text-gray-500 hover:text-gray-700 flex items-center gap-1",children:[r.jsx($r,{className:"h-4 w-4"}),"Refresh"]})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-2 md:gap-3 text-xs",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] text-gray-500 mb-1",children:"Status"}),r.jsxs("select",{className:"input h-8 text-xs",value:v,onChange:L=>w(L.target.value),children:[r.jsx("option",{value:"all",children:"All"}),r.jsx("option",{value:"ordered",children:"Ordered"}),r.jsx("option",{value:"collected",children:"Collected"}),r.jsx("option",{value:"in_progress",children:"In Progress"}),r.jsx("option",{value:"validated",children:"Validated"}),r.jsx("option",{value:"reported",children:"Reported"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] text-gray-500 mb-1",children:"Priority"}),r.jsxs("select",{className:"input h-8 text-xs",value:_,onChange:L=>S(L.target.value),children:[r.jsx("option",{value:"all",children:"All"}),r.jsx("option",{value:"routine",children:"Routine"}),r.jsx("option",{value:"urgent",children:"Urgent"}),r.jsx("option",{value:"stat",children:"STAT"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] text-gray-500 mb-1",children:"From Date"}),r.jsx("input",{type:"date",className:"input h-8 text-xs",value:k,onChange:L=>A(L.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] text-gray-500 mb-1",children:"To Date"}),r.jsx("input",{type:"date",className:"input h-8 text-xs",value:T,onChange:L=>P(L.target.value)})]}),r.jsx("div",{className:"flex items-end",children:r.jsx("button",{type:"button",className:"text-[11px] text-gray-500 underline",onClick:()=>{w("all"),S("all"),A(""),P("")},children:"Clear filters"})})]})]}),r.jsxs("section",{className:"rounded-xl border bg-white p-2 md:p-0",children:[r.jsxs("div",{className:"space-y-2 md:hidden",children:[i&&r.jsx("div",{className:"px-3 py-4 text-xs text-gray-500",children:"Loading"}),!i&&M.length===0&&r.jsx("div",{className:"px-3 py-6 text-xs text-gray-500 text-center",children:"No lab orders found."}),!i&&M.map(L=>r.jsxs("div",{className:"border rounded-xl p-3 flex flex-col gap-2 bg-slate-50/60",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("div",{className:"text-xs font-semibold text-slate-800",children:w2(L.id)}),r.jsx(g1,{status:L.status})]}),r.jsx("div",{className:"text-xs",children:r.jsx(ax,{patient:L.patient,patientId:L.patient_id})}),r.jsxs("div",{className:"flex justify-between text-[11px] text-gray-600",children:[r.jsxs("div",{children:[r.jsxs("div",{children:["Priority:"," ",r.jsx("span",{className:"font-medium capitalize",children:L.priority||"routine"})]}),r.jsxs("div",{children:["Created:"," ",r.jsx("span",{children:b6(L.created_at||L.createdAt)})]})]}),r.jsx("div",{className:"text-right",children:r.jsx("button",{className:"btn-ghost text-xs px-2 py-1",onClick:()=>O(`/lab/orders/${L.id}`),children:"Open"})})]})]},L.id))]}),r.jsx("div",{className:"hidden md:block",children:r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-gray-50 text-gray-600",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left text-xs",children:"Lab No"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs",children:"Patient"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs",children:"Priority"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs",children:"Status"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs",children:"Created"}),r.jsx("th",{className:"px-3 py-2 text-right text-xs",children:"Actions"})]})}),r.jsxs("tbody",{children:[i&&r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-3 text-sm text-gray-500",colSpan:6,children:"Loading"})}),!i&&M.map(L=>r.jsxs("tr",{className:"border-t hover:bg-slate-50/80",children:[r.jsx("td",{className:"px-3 py-2",children:r.jsx(Yk,{order:{...L,display_no:w2(L.id)},to:`/lab/orders/${L.id}`})}),r.jsx("td",{className:"px-3 py-2",children:r.jsx(ax,{patient:L.patient,patientId:L.patient_id})}),r.jsx("td",{className:"px-3 py-2 capitalize text-xs",children:L.priority||"routine"}),r.jsx("td",{className:"px-3 py-2",children:r.jsx(g1,{status:L.status})}),r.jsx("td",{className:"px-3 py-2 text-xs",children:b6(L.created_at||L.createdAt)}),r.jsx("td",{className:"px-3 py-2 text-right",children:r.jsx(bl,{to:`/lab/orders/${L.id}`,className:"btn-ghost text-xs",children:"View"})})]},L.id)),!i&&M.length===0&&r.jsx("tr",{children:r.jsx("td",{className:"px-3 py-6 text-center text-gray-500",colSpan:6,children:"No orders"})})]}),r.jsx("tfoot",{children:r.jsx("tr",{children:r.jsxs("td",{className:"px-3 py-2 text-xs text-gray-500",colSpan:6,children:["Total: ",B]})})})]})})]}),o&&r.jsxs("div",{className:"fixed inset-0 z-40",children:[r.jsx("div",{className:"absolute inset-0 bg-black/30",onClick:()=>c(!1)}),r.jsxs("div",{className:"absolute right-0 top-0 h-full w-full max-w-xl bg-white shadow-xl p-4 overflow-y-auto",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4",children:"New Lab Order"}),r.jsxs("div",{className:"space-y-4 text-sm",children:[r.jsx(Av,{value:d,onChange:u}),r.jsx(J7e,{value:h,onChange:f}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm block mb-1",children:"Priority"}),r.jsxs("select",{className:"input",value:x,onChange:L=>b(L.target.value),children:[r.jsx("option",{value:"routine",children:"Routine"}),r.jsx("option",{value:"urgent",children:"Urgent"}),r.jsx("option",{value:"stat",children:"STAT"})]})]}),r.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[r.jsx("button",{className:"btn-ghost",onClick:()=>c(!1),children:"Cancel"}),r.jsx("button",{className:"btn-primary",onClick:I,children:"Create"})]})]})]})]})]})}function t9e({value:t,onChange:s,label:n="Patient",initialPatient:a=null,disabled:i=!1}){const[l,o]=y.useState(""),[c,d]=y.useState([]),[u,h]=y.useState(!1),[f,x]=y.useState(a||null);y.useEffect(()=>{a&&x(a)},[a]),y.useEffect(()=>{let w=!0;if(!l){d([]);return}return h(!0),jk(l).then(_=>{w&&d(_.data||[])}).catch(()=>{w&&d([])}).finally(()=>{w&&h(!1)}),()=>{w=!1}},[l]),y.useEffect(()=>{if(!t){x(null);return}const w=c.find(_=>_.id===t);w&&x(w)},[t,c]);const b=w=>{x(w),o(""),d([]),s==null||s(w.id,w)},v=()=>{x(null),s==null||s(null,null)};return r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:n}),!f&&r.jsxs(r.Fragment,{children:[r.jsx("input",{className:"input",placeholder:"Search by name / UHID / phone",value:l,disabled:i,onChange:w=>o(w.target.value)}),u&&r.jsx("div",{className:"text-xs text-slate-500",children:"Searching"}),c.length>0&&r.jsx("div",{className:"max-h-48 overflow-auto rounded-xl border bg-white text-sm",children:c.map(w=>r.jsx("button",{type:"button",onClick:()=>b(w),className:"flex w-full items-center justify-between px-3 py-2 text-left hover:bg-slate-50",children:r.jsxs("div",{children:[r.jsxs("div",{className:"font-medium",children:[w.first_name," ",w.last_name]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID: ",w.uhid,"  ",w.phone]})]})},w.id))})]}),f&&r.jsxs("div",{className:"flex items-start justify-between gap-3 rounded-xl border bg-slate-50 px-3 py-2 text-xs text-slate-700",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"font-semibold",children:[f.first_name," ",f.last_name]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID: ",f.uhid,"  ",f.phone]})]}),!i&&r.jsx("button",{type:"button",onClick:v,className:"text-[11px] font-medium text-sky-700 hover:underline",children:"Change"})]})]})}function v6({value:t,onChange:s,label:n="Department  Doctor",initialDepartmentId:a=null,disabled:i=!1}){const[l,o]=y.useState([]),[c,d]=y.useState(""),[u,h]=y.useState([]),[f,x]=y.useState(!1),[b,v]=y.useState(!1),[w,_]=y.useState("");y.useEffect(()=>{let T=!0;return v(!0),zB().then(P=>{T&&o(P.data||[])}).catch(P=>{T&&(console.error("fetchDepartments error",P),se.error("Failed to load departments"),o([]))}).finally(()=>{T&&v(!1)}),()=>{T=!1}},[]),y.useEffect(()=>{a&&!c&&d(String(a))},[a]),y.useEffect(()=>{let T=!0;if(_(""),h([]),!c)return;const P=Number(c);return x(!0),UB({departmentId:P,isDoctor:!0}).then(O=>{T&&h(O.data||[])}).catch(O=>{var I,M;if(!T)return;console.error("fetchDepartmentUsers error",O);const D=((M=(I=O==null?void 0:O.response)==null?void 0:I.data)==null?void 0:M.detail)||"Failed to load doctors";_(D),se.error(D),h([])}).finally(()=>{T&&x(!1)}),()=>{T=!1}},[c]);const S=y.useMemo(()=>u.find(T=>T.id===t)||null,[u,t]),k=T=>{const P=T.target.value;d(P);const O=P?Number(P):null;s==null||s(null,{department_id:O})},A=T=>{const P=T.target.value,O=P?Number(P):null,D=c?Number(c):null;s==null||s(O,{department_id:D})};return r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:n}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[r.jsxs("select",{className:"input",value:c,onChange:k,disabled:b||i,children:[r.jsx("option",{value:"",children:b?"Loading departments":"Select department"}),l.map(T=>r.jsx("option",{value:T.id,children:T.name},T.id))]}),r.jsxs("select",{className:"input",value:t||"",onChange:A,disabled:i||!c||f||u.length===0,children:[r.jsx("option",{value:"",children:f?"Loading doctors":c?u.length===0?"No doctors in this department":"Select doctor":"Select department first"}),u.map(T=>r.jsxs("option",{value:T.id,children:[T.name,T.email?` (${T.email})`:""]},T.id))]})]}),S&&r.jsxs("div",{className:"rounded-xl border bg-emerald-50 px-3 py-2 text-sm",children:["Selected:"," ",r.jsx("span",{className:"font-medium",children:S.name})]}),w&&r.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-2 text-sm text-red-700",children:w})]})}const s9e=t=>t?(typeof t=="string"?new Date(t):t).toISOString().slice(0,10):"",N6=t=>t?String(t).slice(0,5):"",n9e={planned:"bg-blue-50 text-blue-700 border-blue-200",in_progress:"bg-amber-50 text-amber-700 border-amber-200",completed:"bg-emerald-50 text-emerald-700 border-emerald-200",cancelled:"bg-rose-50 text-rose-700 border-rose-200"},r9e={Elective:"bg-slate-50 text-slate-700 border-slate-200",Emergency:"bg-red-50 text-red-700 border-red-200"};function a9e({status:t}){if(!t)return null;const s=n9e[t]||"bg-slate-50 text-slate-700 border-slate-200",n=t.replace("_"," ").replace(/\b\w/g,a=>a.toUpperCase());return r.jsxs("span",{className:`inline-flex items-center rounded-full border px-2.5 py-0.5 text-[11px] font-semibold ${s}`,children:[r.jsx("span",{className:"mr-1.5 h-1.5 w-1.5 rounded-full bg-current"}),n]})}function i9e({priority:t}){if(!t)return null;const s=r9e[t]||"bg-slate-50 text-slate-700 border-slate-200";return r.jsx("span",{className:`inline-flex items-center rounded-full border px-2 py-0.5 text-[11px] font-semibold uppercase tracking-wide ${s}`,children:t})}function l9e({selectedBedId:t,onSelectBed:s}){return r.jsxs(at.div,{layout:!0,className:"flex h-full flex-col rounded-2xl border border-slate-200 bg-white/90 p-3 shadow-sm backdrop-blur-sm md:p-4",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2 border-b border-slate-100 pb-3",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"OT Location / Bed"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Filter cases by ward & bed, or leave blank to view all."})]}),r.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-sky-50 text-sky-600",children:r.jsx(kn,{className:"h-4 w-4"})})]}),r.jsxs("div",{className:"mt-3 flex-1 space-y-3",children:[r.jsx(Fk,{value:t?Number(t):null,onChange:n=>s(n||null)}),r.jsx("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50/80 px-3 py-2.5 text-xs text-slate-600",children:t?r.jsxs(r.Fragment,{children:["Showing OT cases for"," ",r.jsxs("span",{className:"font-semibold text-slate-900",children:["Bed #",t]}),"."]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"font-semibold text-slate-900",children:"All OT beds"})," ","are visible for the selected day."]})})]})]})}function o9e({schedules:t,loading:s,date:n,bedId:a,onEdit:i,onOpenCase:l,onMarkSuccess:o}){const c=a?`Bed #${a}  ${n}`:`All OT locations  ${n}`;return r.jsxs(at.div,{layout:!0,className:"flex h-full flex-col rounded-2xl border border-slate-200 bg-slate-50/60 shadow-sm backdrop-blur-sm",children:[r.jsx("div",{className:"flex items-center justify-between gap-3 border-b border-slate-100 px-3 py-3 md:px-4",children:r.jsxs("div",{children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"OT Day Schedule"}),r.jsx("p",{className:"text-xs text-slate-500",children:c})]})}),r.jsxs("div",{className:"flex-1 space-y-3 overflow-y-auto px-2 py-3 md:px-3 md:py-4",children:[s&&r.jsx(r.Fragment,{children:Array.from({length:4}).map((d,u)=>r.jsx(at.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.18,delay:u*.05},className:"animate-pulse rounded-2xl border border-slate-100 bg-white/80 p-3 shadow-sm md:p-4",children:r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("div",{className:"h-4 w-24 rounded bg-slate-100"}),r.jsx("div",{className:"h-4 w-20 rounded bg-slate-100"})]}),r.jsx("div",{className:"h-4 w-40 rounded bg-slate-100"}),r.jsx("div",{className:"h-4 w-48 rounded bg-slate-100"}),r.jsxs("div",{className:"mt-2 flex gap-2",children:[r.jsx("div",{className:"h-8 flex-1 rounded-full bg-slate-100"}),r.jsx("div",{className:"h-8 flex-1 rounded-full bg-slate-100"})]})]})},u))}),!s&&t.length===0&&r.jsxs(at.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},className:"mt-6 flex flex-col items-center justify-center gap-2 rounded-2xl border border-dashed border-slate-200 bg-white/70 px-4 py-8 text-center",children:[r.jsx(ar,{className:"h-6 w-6 text-slate-400"}),r.jsx("p",{className:"text-sm font-medium text-slate-700",children:"No OT cases scheduled for this day."}),r.jsxs("p",{className:"text-xs text-slate-500",children:["Use ",r.jsx("span",{className:"font-semibold",children:"New Schedule"})," to add an OT booking."]})]}),r.jsx(vl,{initial:!1,children:!s&&t.map(d=>{var T,P,O,D,I,M,B,L,F,V,$,z,H;const u=[d.planned_start_time,d.planned_end_time].filter(Boolean).join("  "),h=((T=d.patient)==null?void 0:T.full_name)||[(P=d.patient)==null?void 0:P.first_name,(O=d.patient)==null?void 0:O.last_name].filter(Boolean).join(" "),f=((D=d.patient)==null?void 0:D.uhid)||d.patient_uhid,x=((I=d.surgeon)==null?void 0:I.full_name)||d.surgeon_name||null,b=((M=d.anaesthetist)==null?void 0:M.full_name)||d.anaesthetist_name||null,v=((B=d.primary_procedure)==null?void 0:B.name)||d.procedure_name,w=(d.procedures||[]).filter(q=>!q.is_primary).length,_=(V=(F=(L=d.bed)==null?void 0:L.room)==null?void 0:F.ward)==null?void 0:V.name,S=(z=($=d.bed)==null?void 0:$.room)==null?void 0:z.number,k=(H=d.bed)==null?void 0:H.code,A=d.bed_id?[_&&`Ward: ${_}`,S&&`Room: ${S}`,k&&`Bed: ${k}`].filter(Boolean).join("  ")||`Bed #${d.bed_id}`:"No bed assigned";return r.jsxs(at.div,{layout:!0,initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.2},className:"group rounded-2xl border border-slate-200 bg-white px-3 py-3 text-sm shadow-sm ring-1 ring-transparent transition hover:border-sky-200 hover:shadow-md hover:ring-sky-100 md:px-4 md:py-4",children:[r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[r.jsxs("div",{className:"inline-flex items-center gap-1.5 text-xs font-medium text-slate-700",children:[r.jsx(lr,{className:"h-4 w-4 text-slate-500"}),r.jsx("span",{children:u||"Time not set"})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[r.jsx(i9e,{priority:d.priority}),r.jsx(a9e,{status:d.status})]})]}),r.jsxs("div",{className:"mt-2 flex flex-col gap-2 md:mt-3 md:flex-row md:items-start md:justify-between",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("div",{className:"flex items-center gap-1.5 text-sm font-semibold text-slate-900",children:[r.jsx(rn,{className:"h-4 w-4 text-slate-500"}),r.jsx("span",{children:h||(f?`UHID ${f}`:`UHID #${d.patient_id}`)})]}),r.jsxs("div",{className:"flex flex-wrap gap-2 text-[11px] text-slate-500",children:[f&&r.jsxs("span",{className:"rounded-full bg-slate-50 px-2 py-0.5",children:["UHID ",f]}),d.admission_id&&r.jsxs("span",{className:"rounded-full bg-slate-50 px-2 py-0.5",children:["IP #",d.admission_id]})]})]}),r.jsxs("div",{className:"space-y-1.5 text-right md:text-left",children:[r.jsxs("div",{className:"flex items-center justify-end gap-1.5 text-sm font-semibold text-slate-900 md:justify-start",children:[r.jsx(Es,{className:"h-4 w-4 text-slate-500"}),r.jsx("span",{children:x||`Dr #${d.surgeon_user_id}`})]}),(b||d.anaesthetist_user_id)&&r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Anaes"," ",b||`#${d.anaesthetist_user_id}`]})]})]}),r.jsxs("div",{className:"mt-3 flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Location"}),r.jsx("div",{className:"text-sm font-medium text-slate-900",children:A})]}),r.jsxs("div",{className:"space-y-1 md:max-w-sm",children:[r.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Procedure"}),r.jsx("div",{className:"text-sm font-semibold text-slate-900",children:v||""}),r.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-1",children:[d.side&&r.jsx("span",{className:"rounded-full bg-slate-50 px-2 py-0.5 text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:d.side}),w>0&&r.jsxs("span",{className:"rounded-full bg-sky-50 px-2 py-0.5 text-[11px] font-semibold text-sky-700",children:["+",w," more"]})]})]})]}),r.jsx("div",{className:"mt-3 flex flex-col gap-2 border-t border-slate-100 pt-3 md:mt-4 md:flex-row md:items-center md:justify-end",children:r.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:gap-2",children:[r.jsx("button",{type:"button",className:"inline-flex items-center justify-center gap-1.5 rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs font-semibold text-slate-800 hover:border-sky-400 hover:text-sky-800",onClick:()=>i(d),children:"Edit"}),r.jsxs("button",{type:"button",onClick:()=>l(d),className:`inline-flex items-center justify-center gap-1.5 rounded-full border px-3.5 py-1.5 text-xs font-semibold transition ${d.case_id?"border-slate-200 bg-white text-slate-900 hover:border-sky-400 hover:text-sky-800":"border-emerald-600 bg-emerald-600 text-white hover:bg-emerald-700"}`,children:[r.jsx(Vs,{className:"h-4 w-4"}),d.case_id?"View Case":"Open Case"]}),o&&d.case_id&&d.status!=="completed"&&r.jsxs("button",{type:"button",onClick:()=>o(d),className:"inline-flex items-center justify-center gap-1.5 rounded-full border border-emerald-600 bg-emerald-50 px-3.5 py-1.5 text-xs font-semibold text-emerald-700 hover:bg-emerald-100",title:"Mark OT as completed (success) for billing",children:[r.jsx(Dn,{className:"h-4 w-4"}),"Success"]})]})})]},d.id)})})]})]})}function c9e({open:t,mode:s,onClose:n,onSaved:a,defaultDate:i,defaultBedId:l,editingSchedule:o}){const c=s==="edit",[d,u]=y.useState({date:i||"",planned_start_time:"",planned_end_time:"",patient_id:"",admission_id:"",bed_id:l||"",surgeon_user_id:"",anaesthetist_user_id:"",procedure_name:"",side:"",priority:"Elective",notes:"",primary_procedure_id:"",additional_procedure_ids:[]}),[h,f]=y.useState(!1),[x,b]=y.useState(null);y.useEffect(()=>{var A,T;t&&(u(c&&o?{date:o.date||i||"",planned_start_time:N6(o.planned_start_time),planned_end_time:N6(o.planned_end_time),patient_id:o.patient_id||"",admission_id:o.admission_id||"",bed_id:o.bed_id||l||"",surgeon_user_id:o.surgeon_user_id||"",anaesthetist_user_id:o.anaesthetist_user_id||"",procedure_name:o.procedure_name||((A=o.primary_procedure)==null?void 0:A.name)||"",side:o.side||"",priority:o.priority||"Elective",notes:o.notes||"",primary_procedure_id:o.primary_procedure_id||"",additional_procedure_ids:((T=o.procedures)==null?void 0:T.filter(P=>!P.is_primary).map(P=>P.procedure_id))||[]}:{date:i||"",planned_start_time:"",planned_end_time:"",patient_id:"",admission_id:"",bed_id:l||"",surgeon_user_id:"",anaesthetist_user_id:"",procedure_name:"",side:"",priority:"Elective",notes:"",primary_procedure_id:"",additional_procedure_ids:[]}),b(null),f(!1))},[t,c,o,l,i]);const v=(A,T)=>{u(P=>({...P,[A]:T}))},w=()=>d.date?d.planned_start_time?d.procedure_name?d.surgeon_user_id?null:"Please select surgeon":"Please enter procedure name":"Please enter start time":"Please select a date",_=async A=>{var P,O,D,I;A.preventDefault();const T=w();if(T){b(T);return}f(!0),b(null);try{const M={date:d.date,planned_start_time:d.planned_start_time,planned_end_time:d.planned_end_time||null,patient_id:d.patient_id?Number(d.patient_id):null,admission_id:d.admission_id?Number(d.admission_id):null,bed_id:d.bed_id?Number(d.bed_id):null,surgeon_user_id:d.surgeon_user_id?Number(d.surgeon_user_id):null,anaesthetist_user_id:d.anaesthetist_user_id?Number(d.anaesthetist_user_id):null,procedure_name:d.procedure_name,side:d.side||null,priority:d.priority||"Elective",notes:d.notes||null,primary_procedure_id:d.primary_procedure_id?Number(d.primary_procedure_id):null,additional_procedure_ids:(d.additional_procedure_ids||[]).map(B=>Number(B))};c&&(o!=null&&o.id)?(await cpe(o.id,M),(P=se.success)==null||P.call(se,"OT schedule updated")):(await u$(M),(O=se.success)==null||O.call(se,"OT schedule created")),a==null||a(),n()}catch(M){console.error("Failed to save OT schedule",M);const B=((I=(D=M==null?void 0:M.response)==null?void 0:D.data)==null?void 0:I.detail)||(M==null?void 0:M.message)||"Failed to save OT schedule";b(B)}finally{f(!1)}},S=c?"Edit OT Schedule":"New OT Schedule",k=c?"Update timing and details of this OT booking.":"Create a new OT booking for the selected day.";return r.jsx(vl,{children:t&&r.jsx(at.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-40 flex items-end justify-center bg-slate-900/40 backdrop-blur-sm md:items-center",onMouseDown:n,children:r.jsxs(at.div,{initial:{y:32,opacity:0},animate:{y:0,opacity:1},exit:{y:32,opacity:0},transition:{type:"spring",stiffness:260,damping:22},className:"w-full max-h-[95vh] rounded-t-3xl bg-white shadow-2xl md:max-w-3xl md:rounded-2xl",onMouseDown:A=>A.stopPropagation(),children:[r.jsxs("div",{className:"flex items-start justify-between border-b border-slate-100 px-5 py-4",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-base font-semibold text-slate-900",children:S}),r.jsx("p",{className:"text-xs text-slate-500",children:k})]}),r.jsx("button",{type:"button",onClick:n,className:"rounded-full p-1.5 text-slate-400 hover:bg-slate-100 hover:text-slate-700",children:r.jsx(Kn,{className:"h-4 w-4"})})]}),r.jsxs("form",{onSubmit:_,className:"flex max-h-[calc(95vh-46px)] flex-col",children:[r.jsxs("div",{className:"grid flex-1 grid-cols-1 gap-4 overflow-y-auto px-5 py-4 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("label",{className:"text-xs font-semibold text-slate-700",children:["Date ",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-sm text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:d.date,onChange:A=>v("date",A.target.value)})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-semibold text-slate-700",children:"Priority"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-sm text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:d.priority,onChange:A=>v("priority",A.target.value),children:[r.jsx("option",{value:"Elective",children:"Elective"}),r.jsx("option",{value:"Emergency",children:"Emergency"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("label",{className:"text-xs font-semibold text-slate-700",children:["Start time"," ",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-sm text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:d.planned_start_time,onChange:A=>v("planned_start_time",A.target.value)})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-semibold text-slate-700",children:"End time"}),r.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-sm text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:d.planned_end_time,onChange:A=>v("planned_end_time",A.target.value)})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsx(t9e,{label:"Patient",value:d.patient_id?Number(d.patient_id):null,onChange:A=>u(T=>({...T,patient_id:A||""}))}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-semibold text-slate-700",children:"Admission ID (IP)"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-sm text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:d.admission_id,onChange:A=>v("admission_id",A.target.value),placeholder:"Optional"})]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-semibold text-slate-700",children:"Ward / Room / Bed"}),r.jsx(Fk,{value:d.bed_id?Number(d.bed_id):null,onChange:A=>u(T=>({...T,bed_id:A||""}))})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsx(d9e,{primaryId:d.primary_procedure_id?Number(d.primary_procedure_id):null,additionalIds:d.additional_procedure_ids||[],onChange:A=>{u(T=>({...T,primary_procedure_id:A.primary_procedure_id??T.primary_procedure_id,additional_procedure_ids:A.additional_procedure_ids??T.additional_procedure_ids,procedure_name:A.primary_procedure_name&&!T.procedure_name?A.primary_procedure_name:T.procedure_name}))}}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("label",{className:"text-xs font-semibold text-slate-700",children:["Procedure name (display)"," ",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-sm text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:d.procedure_name,onChange:A=>v("procedure_name",A.target.value),placeholder:"E.g., Laparoscopic cholecystectomy"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-xs font-semibold text-slate-700",children:"Side"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-sm text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:d.side,onChange:A=>v("side",A.target.value),children:[r.jsx("option",{value:"",children:"Not applicable"}),r.jsx("option",{value:"Right",children:"Right"}),r.jsx("option",{value:"Left",children:"Left"}),r.jsx("option",{value:"Bilateral",children:"Bilateral"}),r.jsx("option",{value:"Midline",children:"Midline"})]})]}),r.jsx(v6,{label:"Surgeon",value:d.surgeon_user_id?Number(d.surgeon_user_id):null,onChange:A=>u(T=>({...T,surgeon_user_id:A||""}))})]}),r.jsx(v6,{label:"Anaesthetist",value:d.anaesthetist_user_id?Number(d.anaesthetist_user_id):null,onChange:A=>u(T=>({...T,anaesthetist_user_id:A||""}))}),r.jsxs("div",{className:"space-y-1.5 pb-1",children:[r.jsx("label",{className:"text-xs font-semibold text-slate-700",children:"Notes"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-sm text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:d.notes,onChange:A=>v("notes",A.target.value),placeholder:"Any special requirements / remarks"})]})]})]}),x&&r.jsx("div",{className:"px-5 pb-2",children:r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:x})}),r.jsxs("div",{className:"flex items-center justify-end gap-2 border-t border-slate-100 px-5 py-3",children:[r.jsx("button",{type:"button",onClick:n,className:"inline-flex items-center justify-center gap-1.5 rounded-full border border-slate-200 bg-white px-3.5 py-1.5 text-xs font-semibold text-slate-800 hover:bg-slate-50",disabled:h,children:"Cancel"}),r.jsxs("button",{type:"submit",className:"inline-flex items-center justify-center gap-1.5 rounded-full border border-sky-600 bg-sky-600 px-3.5 py-1.5 text-xs font-semibold text-white hover:bg-sky-700 disabled:opacity-60",disabled:h,children:[h&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),c?"Update Schedule":"Create Schedule"]})]})]})]})},"ot-schedule-modal")})}function d9e({primaryId:t,additionalIds:s,onChange:n}){const[a,i]=y.useState([]),[l,o]=y.useState(!1),[c,d]=y.useState("");y.useEffect(()=>{(async()=>{var b;try{o(!0);const v=await Bk({limit:500}),w=Array.isArray((b=v==null?void 0:v.data)==null?void 0:b.items)?v.data.items:Array.isArray(v==null?void 0:v.data)?v.data:[];i(w)}catch(v){console.error("Failed to load OT procedures",v)}finally{o(!1)}})()},[]);const u=y.useMemo(()=>{const x=c.trim().toLowerCase();return x?a.filter(b=>{const v=(b.name||"").toLowerCase(),w=(b.code||"").toLowerCase();return v.includes(x)||w.includes(x)}):a},[a,c]),h=x=>{var v;const b=x?Number(x):null;n({primary_procedure_id:b,additional_procedure_ids:s||[],primary_procedure_name:b&&((v=a.find(w=>w.id===b))==null?void 0:v.name)||""})},f=x=>{const b=new Set(s||[]);b.has(x)?b.delete(x):b.add(x),n({primary_procedure_id:t||null,additional_procedure_ids:Array.from(b)})};return r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("label",{className:"text-xs font-semibold text-slate-700",children:"Procedures (from master)"}),r.jsxs("div",{className:"relative w-40",children:[r.jsx(es,{className:"pointer-events-none absolute left-2 top-1.5 h-3.5 w-3.5 text-slate-400"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white pl-7 pr-1.5 py-1.5 text-[11px] text-slate-800 placeholder:text-slate-400 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",placeholder:"Search...",value:c,onChange:x=>d(x.target.value)})]})]}),r.jsxs("div",{className:"space-y-2 rounded-xl border border-slate-200 bg-slate-50/80 p-2",children:[l&&r.jsx("div",{className:"text-[11px] text-slate-500",children:"Loading procedures..."}),!l&&u.length===0&&r.jsx("div",{className:"text-[11px] text-slate-500",children:"No procedures found."}),!l&&u.length>0&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("div",{className:"flex items-center gap-1.5 text-[11px] font-semibold text-slate-600",children:[r.jsx(Zb,{className:"h-3 w-3"}),"Primary procedure"]}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:t||"",onChange:x=>h(x.target.value),children:[r.jsx("option",{value:"",children:"Not selected"}),u.map(x=>r.jsx("option",{value:x.id,children:(x.code?x.code+"  ":"")+x.name},x.id))]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("div",{className:"text-[11px] font-semibold text-slate-600",children:"Additional procedures"}),r.jsx("div",{className:"max-h-32 space-y-1 overflow-auto rounded-lg border border-slate-100 bg-white p-1.5 text-[11px]",children:u.map(x=>{const b=(s||[]).includes(x.id);return r.jsxs("label",{className:"flex cursor-pointer items-center gap-1.5 rounded-md px-1 py-0.5 hover:bg-slate-50",children:[r.jsx("input",{type:"checkbox",className:"h-3 w-3 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:b,onChange:()=>f(x.id)}),r.jsx("span",{className:"truncate",children:(x.code?x.code+"  ":"")+x.name})]},x.id)})})]})]})]})]})}function u9e(){const t=nt("ot.schedule.view"),s=nt("ot.schedule.create"),n=nt("ot.schedule.update"),a=nt("ot.cases.close")||nt("ot.cases.update"),[i,l]=y.useState(s9e(new Date)),[o,c]=y.useState(null),[d,u]=y.useState([]),[h,f]=y.useState(!1),[x,b]=y.useState(null),[v,w]=y.useState(!1),[_,S]=y.useState("create"),[k,A]=y.useState(null),T=Va(),P=async()=>{if(i)try{f(!0),b(null);const B=await d$({date:i,bedId:o||void 0});u(B.data||[])}catch(B){console.error("Failed to load OT schedule",B),b("Failed to load OT schedule")}finally{f(!1)}},O=async B=>{var L,F,V,$;try{if(B.case_id){T(`/ot/cases/${B.case_id}`);return}const z=await Ype(B.id),H=(L=z==null?void 0:z.data)==null?void 0:L.id;await P(),H?T(`/ot/cases/${H}`):console.warn("No case id returned from open-case response",z)}catch(z){console.error("Failed to open OT case",z);const H=((V=(F=z==null?void 0:z.response)==null?void 0:F.data)==null?void 0:V.detail)||(z==null?void 0:z.message)||"Failed to open OT case";($=se.error)==null||$.call(se,H)}},D=async B=>{var L,F,V,$,z;if(!B.case_id){(L=se.error)==null||L.call(se,"No OT case opened for this schedule yet.");return}try{await dpe(B.case_id,{outcome:"Completed"}),(F=se.success)==null||F.call(se,"OT case marked as Completed"),await P()}catch(H){console.error("Failed to mark OT case as completed",H);const q=(($=(V=H==null?void 0:H.response)==null?void 0:V.data)==null?void 0:$.detail)||(H==null?void 0:H.message)||"Failed to update OT status";(z=se.error)==null||z.call(se,q)}},I=()=>{s&&(S("create"),A(null),w(!0))},M=B=>{n&&(S("edit"),A(B),w(!0))};return y.useEffect(()=>{t&&P()},[i,o,t]),t?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex h-full flex-col gap-3 p-3 pb-4 md:p-4",children:[r.jsxs(at.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.18},className:"flex flex-wrap items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-white/90 px-3 py-3 shadow-sm md:px-4 md:py-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("h1",{className:"text-base font-semibold text-slate-900 md:text-lg",children:"OT Schedule (Beds)"}),r.jsx("p",{className:"text-xs text-slate-500 md:text-[13px]",children:"View and manage OT bookings by date and OT bed / location in line with NABH OT records."})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2 rounded-full border border-slate-200 bg-slate-50/80 px-3 py-1.5",children:[r.jsx(ar,{className:"h-4 w-4 text-slate-500"}),r.jsx("input",{type:"date",className:"border-none bg-transparent text-xs font-medium text-slate-800 focus:outline-none",value:i,onChange:B=>l(B.target.value)})]}),r.jsxs("button",{type:"button",onClick:P,className:"inline-flex items-center justify-center gap-1.5 rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs font-semibold text-slate-800 hover:border-sky-400 hover:text-sky-800",children:[r.jsx(_u,{className:"h-3.5 w-3.5"}),"Refresh"]}),s&&r.jsxs("button",{type:"button",onClick:I,className:"inline-flex items-center justify-center gap-1.5 rounded-full border border-sky-600 bg-sky-600 px-3.5 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-sky-700",children:[r.jsx(ps,{className:"h-3.5 w-3.5"}),"New Schedule"]})]})]}),x&&r.jsx("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-2 text-xs text-rose-700",children:x}),r.jsxs("div",{className:"grid min-h-[calc(100vh-170px)] grid-cols-1 gap-3 md:grid-cols-[minmax(260px,0.34fr)_minmax(0,0.66fr)]",children:[r.jsx(l9e,{selectedBedId:o,onSelectBed:c}),r.jsx(o9e,{schedules:d,loading:h,date:i,bedId:o,onEdit:M,onOpenCase:O,onMarkSuccess:a?D:void 0})]})]}),r.jsx(c9e,{open:v,mode:_,onClose:()=>w(!1),onSaved:P,defaultDate:i,defaultBedId:o,editingSchedule:k})]}):r.jsx("div",{className:"p-4",children:r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-sm text-amber-800",children:"You do not have permission to view OT schedules."})})}const h9e=t=>t===!0||t==="true"||t===1||t==="1";function JK({open:t,title:s,subtitle:n,onClose:a,children:i}){return t?r.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-slate-900/40 backdrop-blur-sm",children:r.jsxs("div",{className:"relative w-full max-w-2xl rounded-2xl bg-white shadow-xl",children:[r.jsxs("div",{className:"flex items-start justify-between border-b px-5 py-3.5",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:s}),n&&r.jsx("p",{className:"text-xs text-slate-500",children:n})]}),r.jsx("button",{type:"button",onClick:a,className:"rounded-full p-1 text-slate-400 hover:bg-slate-100 hover:text-slate-600",children:r.jsx(Kn,{className:"h-4 w-4"})})]}),i]})}):null}function m9e(){const t=nt("ot.masters.view")||nt("ot.specialities.view"),s=nt("ot.masters.manage")||nt("ot.specialities.create")||nt("ot.specialities.update"),[n,a]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(null),[d,u]=y.useState(""),[h,f]=y.useState(!1),[x,b]=y.useState(null),[v,w]=y.useState(!1),[_,S]=y.useState(null),[k,A]=y.useState({name:"",code:"",description:"",is_active:!0}),T=y.useMemo(()=>{const B=d.trim().toLowerCase();return B?n.filter(L=>(L.name||"").toLowerCase().includes(B)||(L.code||"").toLowerCase().includes(B)):n},[n,d]),P=async()=>{if(t)try{l(!0),c(null);const B=await c$({});a(B.data||[])}catch(B){console.error("Failed to load OT specialities",B),c("Failed to load OT specialities")}finally{l(!1)}};y.useEffect(()=>{P()},[t]);const O=()=>{b(null),A({name:"",code:"",description:"",is_active:!0}),S(null),f(!0)},D=B=>{b(B),A({name:B.name||"",code:B.code||"",description:B.description||"",is_active:h9e(B.is_active)}),S(null),f(!0)},I=async B=>{var L,F;if(B.preventDefault(),!k.name){S("Please enter speciality name");return}if(!k.code){S("Please enter code");return}w(!0),S(null);try{const V={name:k.name,code:k.code,description:k.description||null,is_active:!!k.is_active};x?await npe(x.id,V):await spe(V),f(!1),b(null),P()}catch(V){console.error("Failed to save OT speciality",V);const $=((F=(L=V==null?void 0:V.response)==null?void 0:L.data)==null?void 0:F.detail)||(V==null?void 0:V.message)||"Failed to save speciality";S($)}finally{w(!1)}},M=async B=>{if(window.confirm(`Delete speciality "${B.name}"?`))try{await rpe(B.id),P()}catch(L){console.error("Failed to delete OT speciality",L),alert("Failed to delete")}};return t?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex flex-col gap-3",children:[r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-slate-700",children:[r.jsx(L3,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-semibold",children:"OT Specialities"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx(es,{className:"absolute left-2 top-2 h-3.5 w-3.5 text-slate-400"}),r.jsx("input",{type:"text",className:"w-44 rounded-lg border border-slate-200 bg-white pl-7 pr-2 py-1.5 text-xs text-slate-800 placeholder:text-slate-400 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",placeholder:"Search...",value:d,onChange:B=>u(B.target.value)})]}),s&&r.jsxs("button",{type:"button",onClick:O,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700",children:[r.jsx(ps,{className:"h-3.5 w-3.5"}),"New"]})]})]}),o&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:o}),r.jsx("div",{className:"overflow-hidden rounded-2xl border bg-white",children:r.jsxs("table",{className:"min-w-full text-left text-xs text-slate-700",children:[r.jsx("thead",{className:"bg-slate-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Code"}),r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Name"}),r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Description"}),r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Active"}),r.jsx("th",{className:"px-4 py-2 text-right text-[11px] font-semibold text-slate-500",children:"Actions"})]})}),r.jsxs("tbody",{children:[i&&r.jsx(r.Fragment,{children:Array.from({length:4}).map((B,L)=>r.jsx("tr",{className:"animate-pulse border-t",children:Array.from({length:5}).map((F,V)=>r.jsx("td",{className:"px-4 py-2",children:r.jsx("div",{className:"h-3 w-3/4 rounded bg-slate-100"})},V))},L))}),!i&&T.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-4 py-6 text-center text-xs text-slate-500",children:r.jsxs("div",{className:"flex flex-col items-center justify-center gap-1",children:[r.jsx(za,{className:"h-4 w-4 text-amber-500"}),r.jsx("span",{children:"No OT specialities found."})]})})}),!i&&T.map(B=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-4 py-2 text-xs font-medium text-slate-800",children:B.code}),r.jsx("td",{className:"px-4 py-2 text-xs text-slate-800",children:B.name}),r.jsx("td",{className:"px-4 py-2 text-xs text-slate-600",children:B.description||""}),r.jsx("td",{className:"px-4 py-2 text-xs",children:r.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium ${B.is_active?"bg-emerald-50 text-emerald-700":"bg-slate-100 text-slate-500"}`,children:B.is_active?"Active":"Inactive"})}),r.jsx("td",{className:"px-4 py-2 text-right text-xs",children:s&&r.jsxs("div",{className:"inline-flex items-center gap-1.5",children:[r.jsxs("button",{type:"button",onClick:()=>D(B),className:"inline-flex items-center gap-1 rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-700 hover:border-sky-400 hover:text-sky-700",children:[r.jsx(Fa,{className:"h-3 w-3"}),"Edit"]}),r.jsxs("button",{type:"button",onClick:()=>M(B),className:"inline-flex items-center gap-1 rounded-lg border border-rose-200 bg-white px-2 py-1 text-[11px] text-rose-600 hover:bg-rose-50",children:[r.jsx(wr,{className:"h-3 w-3"}),"Delete"]})]})})]},B.id))]})]})})]}),r.jsx(JK,{open:h,title:x?"Edit OT Speciality":"New OT Speciality",subtitle:"Map OT workload by speciality for scheduling and reporting.",onClose:()=>f(!1),children:r.jsxs("form",{onSubmit:I,children:[r.jsxs("div",{className:"grid grid-cols-1 gap-3 px-5 py-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"text-xs font-medium text-slate-700",children:["Code ",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:k.code,onChange:B=>A(L=>({...L,code:B.target.value}))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"text-xs font-medium text-slate-700",children:["Name ",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:k.name,onChange:B=>A(L=>({...L,name:B.target.value}))})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Description"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:k.description,onChange:B=>A(L=>({...L,description:B.target.value}))})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{id:"ot_spec_active",type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!k.is_active,onChange:B=>A(L=>({...L,is_active:B.target.checked}))}),r.jsx("label",{htmlFor:"ot_spec_active",className:"text-xs text-slate-700",children:"Active"})]}),_&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:_})]}),r.jsxs("div",{className:"flex items-center justify-end gap-2 border-t px-5 py-3",children:[r.jsx("button",{type:"button",onClick:()=>f(!1),className:"inline-flex items-center gap-1.5 rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-50",disabled:v,children:"Cancel"}),r.jsxs("button",{type:"submit",className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",disabled:v,children:[v&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save"]})]})]})})]}):r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view OT specialities."})}function f9e(){const t=nt("ot.masters.view")||nt("ot.procedures.view"),s=nt("ot.masters.manage")||nt("ot.procedures.create")||nt("ot.procedures.update"),[n,a]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(null),[d,u]=y.useState(""),[h,f]=y.useState([]),[x,b]=y.useState(!1),[v,w]=y.useState(!1),[_,S]=y.useState(null),[k,A]=y.useState(!1),[T,P]=y.useState(null),[O,D]=y.useState({code:"",name:"",speciality_id:"",duration_hours:"",duration_minutes:"",rate_per_hour:"",description:"",is_active:!0}),I=y.useMemo(()=>{const z=d.trim().toLowerCase();return z?n.filter(H=>{var ye;const q=(H.name||"").toLowerCase(),G=(H.code||"").toLowerCase(),re=(((ye=H.speciality)==null?void 0:ye.name)||"").toLowerCase();return q.includes(z)||G.includes(z)||re.includes(z)}):n},[n,d]),M=async()=>{if(t)try{l(!0),c(null);const z=await Bk({});a(z.data||[])}catch(z){console.error("Failed to load OT procedures",z),c("Failed to load OT procedures")}finally{l(!1)}},B=async()=>{try{b(!0);const z=await c$({});f(z.data||[])}catch(z){console.error("Failed to load OT specialities for procedures",z)}finally{b(!1)}};y.useEffect(()=>{t&&(M(),B())},[t]);const L=()=>{S(null),D({code:"",name:"",speciality_id:"",duration_hours:"",duration_minutes:"",rate_per_hour:"",description:"",is_active:!0}),P(null),w(!0)},F=z=>{const H=z.default_duration_min??null,q=H!=null?Math.floor(H/60):"",G=H!=null?H%60:"";S(z),D({code:z.code||"",name:z.name||"",speciality_id:z.speciality_id||"",duration_hours:q===0&&G===0?"":String(q||""),duration_minutes:G===0&&q===0?"":String(G||""),rate_per_hour:z.rate_per_hour!=null?String(z.rate_per_hour):"",description:z.description||"",is_active:!!z.is_active}),P(null),w(!0)},V=async z=>{var Ee,ee;if(z.preventDefault(),!O.code)return P("Please enter procedure code");if(!O.name)return P("Please enter procedure name");const H=O.duration_hours?Number(O.duration_hours):0,q=O.duration_minutes?Number(O.duration_minutes):0,G=H*60+q,re=G>0?G:null,ye=O.rate_per_hour===""||O.rate_per_hour===null?null:Number(O.rate_per_hour);A(!0),P(null);try{const te={code:O.code,name:O.name,speciality_id:O.speciality_id?Number(O.speciality_id):null,default_duration_min:re,rate_per_hour:ye,description:O.description||null,is_active:!!O.is_active};_?await ipe(_.id,te):await ape(te),w(!1),S(null),M()}catch(te){console.error("Failed to save OT procedure",te);const ce=((ee=(Ee=te==null?void 0:te.response)==null?void 0:Ee.data)==null?void 0:ee.detail)||(te==null?void 0:te.message)||"Failed to save procedure";P(ce)}finally{A(!1)}},$=async z=>{if(window.confirm(`Delete procedure "${z.name}"?`))try{await lpe(z.id),M()}catch(H){console.error("Failed to delete OT procedure",H),alert("Failed to delete procedure")}};return t?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex flex-col gap-3",children:[r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-slate-700",children:[r.jsx(Zb,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-semibold",children:"OT Procedures"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx(es,{className:"absolute left-2 top-2 h-3.5 w-3.5 text-slate-400"}),r.jsx("input",{type:"text",className:"w-56 rounded-lg border border-slate-200 bg-white pl-7 pr-2 py-1.5 text-xs text-slate-800 placeholder:text-slate-400 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",placeholder:"Search by code, name, speciality...",value:d,onChange:z=>u(z.target.value)})]}),s&&r.jsxs("button",{type:"button",onClick:L,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700",children:[r.jsx(ps,{className:"h-3.5 w-3.5"}),"New"]})]})]}),o&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:o}),r.jsx("div",{className:"overflow-x-auto rounded-2xl border bg-white",children:r.jsxs("table",{className:"min-w-full text-left text-xs text-slate-700",children:[r.jsx("thead",{className:"bg-slate-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Code"}),r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Name"}),r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Speciality"}),r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Default Duration"}),r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Rate / hour"}),r.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Active"}),r.jsx("th",{className:"px-4 py-2 text-right text-[11px] font-semibold text-slate-500",children:"Actions"})]})}),r.jsxs("tbody",{children:[i&&r.jsx(r.Fragment,{children:Array.from({length:4}).map((z,H)=>r.jsx("tr",{className:"animate-pulse border-t",children:Array.from({length:7}).map((q,G)=>r.jsx("td",{className:"px-4 py-2",children:r.jsx("div",{className:"h-3 w-3/4 rounded bg-slate-100"})},G))},H))}),!i&&I.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"px-4 py-6 text-center text-xs text-slate-500",children:r.jsxs("div",{className:"flex flex-col items-center justify-center gap-1",children:[r.jsx(za,{className:"h-4 w-4 text-amber-500"}),r.jsx("span",{children:"No OT procedures found."})]})})}),!i&&I.map(z=>{var G;const H=z.default_duration_min??null;let q="";if(H!=null&&H>0){const re=Math.floor(H/60),ye=H%60;q=re>0&&ye>0?`${re}h ${ye}min`:re>0?`${re}h`:`${ye}min`}return r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"px-4 py-2 text-xs font-medium text-slate-800",children:z.code}),r.jsx("td",{className:"px-4 py-2 text-xs text-slate-800",children:z.name}),r.jsx("td",{className:"px-4 py-2 text-xs text-slate-600",children:((G=z.speciality)==null?void 0:G.name)||z.speciality_id&&`#${z.speciality_id}`||""}),r.jsx("td",{className:"px-4 py-2 text-xs text-slate-600",children:q}),r.jsx("td",{className:"px-4 py-2 text-xs text-slate-600",children:z.rate_per_hour!=null?` ${Number(z.rate_per_hour).toFixed(2)}`:""}),r.jsx("td",{className:"px-4 py-2 text-xs",children:r.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium ${z.is_active?"bg-emerald-50 text-emerald-700":"bg-slate-100 text-slate-500"}`,children:z.is_active?"Active":"Inactive"})}),r.jsx("td",{className:"px-4 py-2 text-right text-xs",children:s&&r.jsxs("div",{className:"inline-flex items-center gap-1.5",children:[r.jsxs("button",{type:"button",onClick:()=>F(z),className:"inline-flex items-center gap-1 rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-700 hover:border-sky-400 hover:text-sky-700",children:[r.jsx(Fa,{className:"h-3 w-3"}),"Edit"]}),r.jsxs("button",{type:"button",onClick:()=>$(z),className:"inline-flex items-center gap-1 rounded-lg border border-rose-200 bg-white px-2 py-1 text-[11px] text-rose-600 hover:bg-rose-50",children:[r.jsx(wr,{className:"h-3 w-3"}),"Delete"]})]})})]},z.id)})]})]})})]}),r.jsx(JK,{open:v,title:_?"Edit OT Procedure":"New OT Procedure",subtitle:"Define procedures with default duration and hour-based rate for billing.",onClose:()=>w(!1),children:r.jsxs("form",{onSubmit:V,children:[r.jsxs("div",{className:"grid grid-cols-1 gap-3 px-5 py-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"text-xs font-medium text-slate-700",children:["Code ",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:O.code,onChange:z=>D(H=>({...H,code:z.target.value}))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"text-xs font-medium text-slate-700",children:["Name ",r.jsx("span",{className:"text-rose-500",children:"*"})]}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:O.name,onChange:z=>D(H=>({...H,name:z.target.value}))})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Default speciality (optional)"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:O.speciality_id,onChange:z=>D(H=>({...H,speciality_id:z.target.value})),children:[r.jsx("option",{value:"",children:"Not mapped"}),h.map(z=>r.jsx("option",{value:z.id,children:(z.code?`${z.code}  `:"")+z.name},z.id))]}),x&&r.jsx("p",{className:"mt-0.5 text-[10px] text-slate-400",children:"Loading specialities..."})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Default duration  hours"}),r.jsx("input",{type:"number",min:"0",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:O.duration_hours,onChange:z=>D(H=>({...H,duration_hours:z.target.value})),placeholder:"e.g., 2"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Default duration  minutes"}),r.jsx("input",{type:"number",min:"0",max:"59",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:O.duration_minutes,onChange:z=>D(H=>({...H,duration_minutes:z.target.value})),placeholder:"e.g., 30"})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Rate per hour ()"}),r.jsx("input",{type:"number",step:"0.01",min:"0",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:O.rate_per_hour,onChange:z=>D(H=>({...H,rate_per_hour:z.target.value})),placeholder:"e.g., 5000"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Description / notes"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:O.description,onChange:z=>D(H=>({...H,description:z.target.value})),placeholder:"E.g., Includes surgeon charges only; anaesthesia separate."})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{id:"ot_proc_active",type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!O.is_active,onChange:z=>D(H=>({...H,is_active:z.target.checked}))}),r.jsx("label",{htmlFor:"ot_proc_active",className:"text-xs text-slate-700",children:"Active"})]}),T&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:T})]}),r.jsxs("div",{className:"flex items-center justify-end gap-2 border-t px-5 py-3",children:[r.jsx("button",{type:"button",onClick:()=>w(!1),className:"inline-flex items-center gap-1.5 rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-50",disabled:k,children:"Cancel"}),r.jsxs("button",{type:"submit",className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",disabled:k,children:[k&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save"]})]})]})})]}):r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view OT procedure masters."})}const p9e=[{id:"specialities",label:"Specialities"},{id:"procedures",label:"Procedures"}];function x9e(){const[t,s]=y.useState("specialities");return r.jsxs("div",{className:"flex h-full flex-col gap-3 p-4",children:[r.jsx("div",{className:"flex flex-wrap items-center justify-between gap-3",children:r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-semibold text-slate-900",children:"OT Masters"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Configure OT specialities, theatres, equipment, and environment settings as per NABH."})]})}),r.jsx("div",{className:"flex gap-2 border-b border-slate-200",children:p9e.map(n=>{const a=n.id===t;return r.jsxs("button",{type:"button",onClick:()=>s(n.id),className:`relative px-3 py-1.5 text-xs font-medium transition-colors ${a?"text-sky-700":"text-slate-500 hover:text-slate-800"}`,children:[n.label,a&&r.jsx("span",{className:"absolute inset-x-0 bottom-0 h-0.5 rounded-full bg-sky-600"})]},n.id)})}),r.jsxs("div",{className:"flex-1 overflow-auto pt-2",children:[t==="specialities"&&r.jsx(m9e,{}),t==="procedures"&&r.jsx(f9e,{})]})]})}const eY=[{value:"",label:"All sessions"},{value:"pre-list",label:"Pre-list"},{value:"between-cases",label:"Between cases"},{value:"end-of-day",label:"End of day"}],$N=t=>t?t.slice(0,10):"";function g9e(){const[t,s]=y.useState("cleaning"),[n,a]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(null);return y.useEffect(()=>{(async()=>{try{l(!0),c(null);const u=await ope({});a(u.data||[])}catch(u){console.error("Failed to load OT theatres for logs",u),c("Failed to load OT theatres (for dropdowns)"),a([])}finally{l(!1)}})()},[]),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-semibold text-slate-900",children:"OT Logs  Cleaning & Environment"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Statutory OT cleaning / turnover and environment monitoring logs (NABH)."}),o&&r.jsxs("p",{className:"mt-1 text-[11px] text-amber-600",children:[o,"  theatre names may not show."]})]}),r.jsxs("div",{className:"inline-flex rounded-full border border-slate-200 bg-slate-50 p-1 text-xs",children:[r.jsx("button",{type:"button",onClick:()=>s("cleaning"),className:`rounded-full px-3 py-1 font-medium transition ${t==="cleaning"?"bg-white text-sky-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Cleaning / Sterility"}),r.jsx("button",{type:"button",onClick:()=>s("environment"),className:`rounded-full px-3 py-1 font-medium transition ${t==="environment"?"bg-white text-sky-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Environment (T/H/P)"})]})]}),t==="cleaning"?r.jsx(y9e,{theatreOptions:n,theatresLoading:i}):r.jsx(v9e,{theatreOptions:n,theatresLoading:i})]})}function y9e({theatreOptions:t,theatresLoading:s}){const n=nt("ot.logs.cleaning.view")||nt("ot.logs.view")||nt("ot.case.view"),a=nt("ot.logs.cleaning.manage")||nt("ot.logs.manage"),[i,l]=y.useState({theatreId:"",caseId:"",date:"",fromDate:"",toDate:"",session:""}),[o,c]=y.useState([]),[d,u]=y.useState(!1),[h,f]=y.useState(null),[x,b]=y.useState(!1),[v,w]=y.useState(null),[_,S]=y.useState(!1),k=y.useCallback(M=>{if(!M)return"";const B=t==null?void 0:t.find(F=>F.id===M);return B?`${B.code||`TH-${B.id}`}  ${B.name||""}`.trim():`#${M}`},[t]),A=y.useCallback(async()=>{if(n)try{u(!0),f(null);const M=await zpe({theatreId:i.theatreId||void 0,caseId:i.caseId||void 0,date:i.date||void 0,fromDate:i.fromDate||void 0,toDate:i.toDate||void 0,session:i.session||void 0});c(M.data||[])}catch(M){console.error("Failed to load cleaning logs",M),f("Failed to load cleaning logs"),c([])}finally{u(!1)}},[n,i]);y.useEffect(()=>{A()},[A]);const T=()=>{w(null),b(!1)},P=M=>{w(M),b(!0)},O=()=>{w(null),b(!0)},D=async M=>{if(a&&window.confirm("Delete this cleaning log entry?"))try{await Hpe(M.id),await A()}catch(B){console.error("Failed to delete cleaning log",B),alert("Failed to delete cleaning log entry")}},I=async M=>{var B,L;if(a){S(!0);try{const F={theatre_id:M.theatre_id?Number(M.theatre_id):null,date:M.date||null,session:M.session||null,case_id:M.case_id?Number(M.case_id):null,method:M.method||null,done_by_user_id:M.done_by_user_id?Number(M.done_by_user_id):null,remarks:M.remarks||null};v!=null&&v.id?await Vpe(v.id,F):await Upe(F),await A(),T()}catch(F){console.error("Failed to save cleaning log",F),alert(((L=(B=F==null?void 0:F.response)==null?void 0:B.data)==null?void 0:L.detail)||"Failed to save cleaning log. Please check required fields.")}finally{S(!1)}}};return n?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 text-xs",children:[r.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-slate-800",children:[r.jsx(Zb,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-semibold",children:"OT Cleaning / Sterility Logs"})]}),a&&r.jsxs("button",{type:"button",onClick:O,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700",children:[r.jsx(ps,{className:"h-3 w-3"}),"New cleaning log"]})]}),r.jsxs("div",{className:"mb-3 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[r.jsxs("div",{className:"mb-1 flex items-center gap-2 text-[11px] font-medium text-slate-600",children:[r.jsx($r,{className:"h-3 w-3"}),"Filters"]}),r.jsxs("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-5",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Theatre"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.theatreId,onChange:M=>l(B=>({...B,theatreId:M.target.value})),children:[r.jsx("option",{value:"",children:"All theatres"}),t==null?void 0:t.map(M=>r.jsx("option",{value:M.id,children:(M.code||`TH-${M.id}`)+(M.name?`  ${M.name}`:"")},M.id))]}),s&&r.jsx("p",{className:"mt-0.5 text-[10px] text-slate-400",children:"Loading theatres..."})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Case ID"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.caseId,onChange:M=>l(B=>({...B,caseId:M.target.value}))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Date"}),r.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.date,onChange:M=>l(B=>({...B,date:M.target.value}))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"From"}),r.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.fromDate,onChange:M=>l(B=>({...B,fromDate:M.target.value}))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"To"}),r.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.toDate,onChange:M=>l(B=>({...B,toDate:M.target.value}))})]})]}),r.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[r.jsx("select",{className:"w-full max-w-xs rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.session,onChange:M=>l(B=>({...B,session:M.target.value})),children:eY.map(M=>r.jsx("option",{value:M.value,children:M.label},M.value))}),r.jsx("button",{type:"button",onClick:A,className:"rounded-lg border border-slate-300 bg-white px-3 py-1 text-[11px] font-medium text-slate-700 hover:bg-slate-100",children:"Apply"}),r.jsx("button",{type:"button",onClick:()=>l({theatreId:"",caseId:"",date:"",fromDate:"",toDate:"",session:""}),className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-1 text-[11px] text-slate-500 hover:bg-slate-100",children:"Clear"})]})]}),d&&r.jsx("div",{className:"text-xs text-slate-500",children:"Loading cleaning logs..."}),h&&r.jsx("div",{className:"mb-2 rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:h}),r.jsx("div",{className:"max-h-80 overflow-auto rounded-xl border bg-slate-50",children:r.jsxs("table",{className:"min-w-full text-left text-[11px] text-slate-700",children:[r.jsx("thead",{className:"bg-slate-100",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-1.5",children:"Date"}),r.jsx("th",{className:"px-3 py-1.5",children:"Theatre"}),r.jsx("th",{className:"px-3 py-1.5",children:"Session"}),r.jsx("th",{className:"px-3 py-1.5",children:"Case ID"}),r.jsx("th",{className:"px-3 py-1.5",children:"Method"}),r.jsx("th",{className:"px-3 py-1.5",children:"Done by (user id)"}),r.jsx("th",{className:"px-3 py-1.5",children:"Remarks"}),a&&r.jsx("th",{className:"px-3 py-1.5 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[!d&&o.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:a?8:7,className:"px-3 py-2 text-center text-[11px] text-slate-500",children:"No cleaning logs found for the selected filters."})}),!d&&o.map(M=>r.jsxs("tr",{className:"border-t border-slate-100",children:[r.jsx("td",{className:"px-3 py-1.5",children:$N(M.date)||""}),r.jsx("td",{className:"px-3 py-1.5",children:k(M.theatre_id)||""}),r.jsx("td",{className:"px-3 py-1.5",children:M.session||""}),r.jsx("td",{className:"px-3 py-1.5",children:M.case_id||""}),r.jsx("td",{className:"px-3 py-1.5",children:M.method||""}),r.jsx("td",{className:"px-3 py-1.5",children:M.done_by_user_id||""}),r.jsx("td",{className:"px-3 py-1.5",children:M.remarks||""}),a&&r.jsx("td",{className:"px-3 py-1.5 text-right",children:r.jsxs("div",{className:"inline-flex gap-1",children:[r.jsxs("button",{type:"button",onClick:()=>P(M),className:"inline-flex items-center gap-1 rounded-lg border border-slate-300 bg-white px-2 py-0.5 text-[10px] text-slate-700 hover:bg-slate-100",children:[r.jsx($7,{className:"h-3 w-3"}),"Edit"]}),r.jsxs("button",{type:"button",onClick:()=>D(M),className:"inline-flex items-center gap-1 rounded-lg border border-rose-200 bg-white px-2 py-0.5 text-[10px] text-rose-600 hover:bg-rose-50",children:[r.jsx(wr,{className:"h-3 w-3"}),"Delete"]})]})})]},M.id))]})]})})]}),x&&r.jsx(b9e,{initial:v,onClose:T,onSave:I,saving:_,theatreOptions:t})]}):r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view OT cleaning logs."})}function b9e({initial:t,onClose:s,onSave:n,saving:a,theatreOptions:i}){const[l,o]=y.useState({theatre_id:(t==null?void 0:t.theatre_id)??"",date:t!=null&&t.date?$N(t.date):"",session:(t==null?void 0:t.session)??"",case_id:(t==null?void 0:t.case_id)??"",method:(t==null?void 0:t.method)??"",done_by_user_id:(t==null?void 0:t.done_by_user_id)??"",remarks:(t==null?void 0:t.remarks)??""}),c=(u,h)=>{o(f=>({...f,[u]:h}))},d=u=>{u.preventDefault(),n(l)};return r.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-slate-900/40 p-2",children:r.jsxs("div",{className:"w-full max-w-lg rounded-2xl bg-white p-4 text-xs shadow-xl",children:[r.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Zb,{className:"h-4 w-4 text-sky-600"}),r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:t?"Edit cleaning log":"New cleaning log"})]}),r.jsx("button",{type:"button",onClick:s,className:"rounded-full p-1 text-slate-400 hover:bg-slate-100 hover:text-slate-700",children:r.jsx(Kn,{className:"h-4 w-4"})})]}),r.jsxs("form",{onSubmit:d,className:"space-y-2",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Theatre *"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.theatre_id,required:!0,onChange:u=>c("theatre_id",u.target.value),children:[r.jsx("option",{value:"",children:"Select theatre"}),i==null?void 0:i.map(u=>r.jsx("option",{value:u.id,children:(u.code||`TH-${u.id}`)+(u.name?`  ${u.name}`:"")},u.id))]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Date *"}),r.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.date,required:!0,onChange:u=>c("date",u.target.value)})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Session"}),r.jsx("select",{className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.session,onChange:u=>c("session",u.target.value),children:eY.map(u=>r.jsx("option",{value:u.value,children:u.label||""},u.value))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Case ID (optional)"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.case_id,onChange:u=>c("case_id",u.target.value)})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Method / Type *"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",placeholder:"Mopping, fumigation, UV, etc.",value:l.method,required:!0,onChange:u=>c("method",u.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Done by (User ID) *"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.done_by_user_id,required:!0,onChange:u=>c("done_by_user_id",u.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Remarks"}),r.jsx("textarea",{rows:2,className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.remarks,onChange:u=>c("remarks",u.target.value)})]}),r.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[r.jsx("button",{type:"button",onClick:s,className:"rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-[11px] text-slate-600 hover:bg-slate-50",children:"Cancel"}),r.jsxs("button",{type:"submit",disabled:a,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-[11px] font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[a&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save"]})]})]})]})})}function v9e({theatreOptions:t,theatresLoading:s}){const n=nt("ot.logs.environment.view")||nt("ot.logs.view")||nt("ot.case.view"),a=nt("ot.logs.environment.manage")||nt("ot.logs.manage"),[i,l]=y.useState({theatreId:"",date:"",fromDate:"",toDate:""}),[o,c]=y.useState([]),[d,u]=y.useState(!1),[h,f]=y.useState(null),[x,b]=y.useState(!1),[v,w]=y.useState(null),[_,S]=y.useState(!1),k=y.useCallback(M=>{if(!M)return"";const B=t==null?void 0:t.find(F=>F.id===M);return B?`${B.code||`TH-${B.id}`}  ${B.name||""}`.trim():`#${M}`},[t]),A=y.useCallback(async()=>{if(n)try{u(!0),f(null);const M=await Wpe({theatreId:i.theatreId||void 0,date:i.date||void 0,fromDate:i.fromDate||void 0,toDate:i.toDate||void 0});c(M.data||[])}catch(M){console.error("Failed to load environment logs",M),f("Failed to load environment logs"),c([])}finally{u(!1)}},[n,i]);y.useEffect(()=>{A()},[A]);const T=()=>{w(null),b(!1)},P=()=>{w(null),b(!0)},O=M=>{w(M),b(!0)},D=async M=>{if(a&&window.confirm("Delete this environment log entry?"))try{await Kpe(M.id),await A()}catch(B){console.error("Failed to delete environment log",B),alert("Failed to delete environment log entry")}},I=async M=>{var B,L;if(a){S(!0);try{const F={theatre_id:M.theatre_id?Number(M.theatre_id):null,date:M.date||null,time:M.time||null,temperature_c:M.temperature_c===""?null:Number(M.temperature_c),humidity_percent:M.humidity_percent===""?null:Number(M.humidity_percent),pressure_diff_pa:M.pressure_diff_pa===""?null:Number(M.pressure_diff_pa),logged_by_user_id:M.logged_by_user_id?Number(M.logged_by_user_id):null};v!=null&&v.id?await Gpe(v.id,F):await qpe(F),await A(),T()}catch(F){console.error("Failed to save environment log",F),alert(((L=(B=F==null?void 0:F.response)==null?void 0:B.data)==null?void 0:L.detail)||"Failed to save environment log. Please check required fields.")}finally{S(!1)}}};return n?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 text-xs",children:[r.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-slate-800",children:[r.jsx(Kp,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-semibold",children:"OT Environment Logs (Temperature / Humidity / Pressure)"})]}),a&&r.jsxs("button",{type:"button",onClick:P,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700",children:[r.jsx(ps,{className:"h-3 w-3"}),"New environment log"]})]}),r.jsxs("div",{className:"mb-3 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[r.jsxs("div",{className:"mb-1 flex items-center gap-2 text-[11px] font-medium text-slate-600",children:[r.jsx($r,{className:"h-3 w-3"}),"Filters"]}),r.jsxs("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Theatre"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.theatreId,onChange:M=>l(B=>({...B,theatreId:M.target.value})),children:[r.jsx("option",{value:"",children:"All theatres"}),t==null?void 0:t.map(M=>r.jsx("option",{value:M.id,children:(M.code||`TH-${M.id}`)+(M.name?`  ${M.name}`:"")},M.id))]}),s&&r.jsx("p",{className:"mt-0.5 text-[10px] text-slate-400",children:"Loading theatres..."})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Date"}),r.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.date,onChange:M=>l(B=>({...B,date:M.target.value}))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"From"}),r.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.fromDate,onChange:M=>l(B=>({...B,fromDate:M.target.value}))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"To"}),r.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.toDate,onChange:M=>l(B=>({...B,toDate:M.target.value}))})]})]}),r.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[r.jsx("button",{type:"button",onClick:A,className:"rounded-lg border border-slate-300 bg-white px-3 py-1 text-[11px] font-medium text-slate-700 hover:bg-slate-100",children:"Apply"}),r.jsx("button",{type:"button",onClick:()=>l({theatreId:"",date:"",fromDate:"",toDate:""}),className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-1 text-[11px] text-slate-500 hover:bg-slate-100",children:"Clear"})]})]}),d&&r.jsx("div",{className:"text-xs text-slate-500",children:"Loading environment logs..."}),h&&r.jsx("div",{className:"mb-2 rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:h}),r.jsx("div",{className:"max-h-80 overflow-auto rounded-xl border bg-slate-50",children:r.jsxs("table",{className:"min-w-full text-left text-[11px] text-slate-700",children:[r.jsx("thead",{className:"bg-slate-100",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-1.5",children:"Date"}),r.jsx("th",{className:"px-3 py-1.5",children:"Time"}),r.jsx("th",{className:"px-3 py-1.5",children:"Theatre"}),r.jsx("th",{className:"px-3 py-1.5",children:"Temp (C)"}),r.jsx("th",{className:"px-3 py-1.5",children:"Humidity (%)"}),r.jsx("th",{className:"px-3 py-1.5",children:"Pressure (Pa)"}),r.jsx("th",{className:"px-3 py-1.5",children:"Logged by (user id)"}),a&&r.jsx("th",{className:"px-3 py-1.5 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[!d&&o.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:a?8:7,className:"px-3 py-2 text-center text-[11px] text-slate-500",children:"No environment logs found for the selected filters."})}),!d&&o.map(M=>r.jsxs("tr",{className:"border-t border-slate-100",children:[r.jsx("td",{className:"px-3 py-1.5",children:$N(M.date)||""}),r.jsx("td",{className:"px-3 py-1.5",children:M.time?M.time.slice(0,5):""}),r.jsx("td",{className:"px-3 py-1.5",children:k(M.theatre_id)||""}),r.jsx("td",{className:"px-3 py-1.5",children:M.temperature_c!==null&&M.temperature_c!==void 0?M.temperature_c:""}),r.jsx("td",{className:"px-3 py-1.5",children:M.humidity_percent!==null&&M.humidity_percent!==void 0?M.humidity_percent:""}),r.jsx("td",{className:"px-3 py-1.5",children:M.pressure_diff_pa!==null&&M.pressure_diff_pa!==void 0?M.pressure_diff_pa:""}),r.jsx("td",{className:"px-3 py-1.5",children:M.logged_by_user_id||""}),a&&r.jsx("td",{className:"px-3 py-1.5 text-right",children:r.jsxs("div",{className:"inline-flex gap-1",children:[r.jsxs("button",{type:"button",onClick:()=>O(M),className:"inline-flex items-center gap-1 rounded-lg border border-slate-300 bg-white px-2 py-0.5 text-[10px] text-slate-700 hover:bg-slate-100",children:[r.jsx($7,{className:"h-3 w-3"}),"Edit"]}),r.jsxs("button",{type:"button",onClick:()=>D(M),className:"inline-flex items-center gap-1 rounded-lg border border-rose-200 bg-white px-2 py-0.5 text-[10px] text-rose-600 hover:bg-rose-50",children:[r.jsx(wr,{className:"h-3 w-3"}),"Delete"]})]})})]},M.id))]})]})})]}),x&&r.jsx(N9e,{initial:v,onClose:T,onSave:I,saving:_,theatreOptions:t})]}):r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view environment logs."})}function N9e({initial:t,onClose:s,onSave:n,saving:a,theatreOptions:i}){const[l,o]=y.useState({theatre_id:(t==null?void 0:t.theatre_id)??"",date:t!=null&&t.date?$N(t.date):"",time:(t==null?void 0:t.time)??"",temperature_c:(t==null?void 0:t.temperature_c)!==null&&(t==null?void 0:t.temperature_c)!==void 0?String(t.temperature_c):"",humidity_percent:(t==null?void 0:t.humidity_percent)!==null&&(t==null?void 0:t.humidity_percent)!==void 0?String(t.humidity_percent):"",pressure_diff_pa:(t==null?void 0:t.pressure_diff_pa)!==null&&(t==null?void 0:t.pressure_diff_pa)!==void 0?String(t.pressure_diff_pa):"",logged_by_user_id:(t==null?void 0:t.logged_by_user_id)??""}),c=(u,h)=>{o(f=>({...f,[u]:h}))},d=u=>{u.preventDefault(),n(l)};return r.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-slate-900/40 p-2",children:r.jsxs("div",{className:"w-full max-w-lg rounded-2xl bg-white p-4 text-xs shadow-xl",children:[r.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Kp,{className:"h-4 w-4 text-sky-600"}),r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:t?"Edit environment log":"New environment log"})]}),r.jsx("button",{type:"button",onClick:s,className:"rounded-full p-1 text-slate-400 hover:bg-slate-100 hover:text-slate-700",children:r.jsx(Kn,{className:"h-4 w-4"})})]}),r.jsxs("form",{onSubmit:d,className:"space-y-2",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Theatre *"}),r.jsxs("select",{className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.theatre_id,required:!0,onChange:u=>c("theatre_id",u.target.value),children:[r.jsx("option",{value:"",children:"Select theatre"}),i==null?void 0:i.map(u=>r.jsx("option",{value:u.id,children:(u.code||`TH-${u.id}`)+(u.name?`  ${u.name}`:"")},u.id))]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Date *"}),r.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.date,required:!0,onChange:u=>c("date",u.target.value)})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Time *"}),r.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.time,required:!0,onChange:u=>c("time",u.target.value)})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Temp (C)"}),r.jsx("input",{type:"number",step:"0.1",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.temperature_c,onChange:u=>c("temperature_c",u.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Humidity (%)"}),r.jsx("input",{type:"number",step:"0.1",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.humidity_percent,onChange:u=>c("humidity_percent",u.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Pressure (Pa)"}),r.jsx("input",{type:"number",step:"0.01",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.pressure_diff_pa,onChange:u=>c("pressure_diff_pa",u.target.value)})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Logged by (User ID) *"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.logged_by_user_id,required:!0,onChange:u=>c("logged_by_user_id",u.target.value)})]}),r.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[r.jsx("button",{type:"button",onClick:s,className:"rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-[11px] text-slate-600 hover:bg-slate-50",children:"Cancel"}),r.jsxs("button",{type:"submit",disabled:a,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-[11px] font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[a&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save"]})]})]})]})})}const tY=[{key:"allergy",label:"Allergy"},{key:"consent_form_signed",label:"Consent form signed"},{key:"written_high_risk_signed",label:"Written high risk form signed"},{key:"identity_bands_checked",label:"Identity bands checked"},{key:"npo",label:"Nill per mouth (NPO)"},{key:"pre_medication_given",label:"Pre-medication given"},{key:"test_dose_given",label:"Test dose given"},{key:"bowel_preparation",label:"Bowel preparation"},{key:"bladder_empty_time",label:"Bladder empty time"},{key:"serology_results",label:"Serology results"},{key:"blood_grouping",label:"Blood grouping"},{key:"blood_reservation",label:"Blood reservation"},{key:"patient_files_with_records",label:"Patient IP/OP files, ECG / X-ray with old records"},{key:"pre_anaesthetic_evaluation",label:"Pre-anaesthetic evaluation"},{key:"jewellery_nailpolish_removed",label:"Jewellery, nail polish, make-up removed"},{key:"prosthesis_dentures_wig_contactlens_removed",label:"Prosthesis / dentures / wig / contact lens removed"},{key:"sterile_preparation_done",label:"Sterile preparation done"}],Sy=()=>({checklist:tY.reduce((t,s)=>(t[s.key]={handover:!1,receiving:!1,comments:""},t),{}),investigations:{hb:"",platelet:"",urea:"",creatinine:"",potassium:"",rbs:"",other:""},vitals:{temp:"",pulse:"",resp:"",bp:"",spo2:"",height:"",weight:""},shave_completed:null,nurse_signature:""}),w9e=t=>{const s=Sy();if(!t||typeof t!="object")return s;const n={...s};return t.checklist&&typeof t.checklist=="object"&&(n.checklist={...s.checklist,...t.checklist}),"patient_identity_confirmed"in t&&(n.checklist.identity_bands_checked={...n.checklist.identity_bands_checked,handover:!!t.patient_identity_confirmed}),"consent_checked"in t&&(n.checklist.consent_form_signed={...n.checklist.consent_form_signed,handover:!!t.consent_checked}),"investigations_checked"in t&&(n.checklist.patient_files_with_records={...n.checklist.patient_files_with_records,handover:!!t.investigations_checked}),"blood_products_arranged"in t&&(n.checklist.blood_reservation={...n.checklist.blood_reservation,handover:!!t.blood_products_arranged}),"implants_available"in t&&(n.checklist.prosthesis_dentures_wig_contactlens_removed={...n.checklist.prosthesis_dentures_wig_contactlens_removed,handover:!!t.implants_available}),"site_marked"in t&&(n.checklist.pre_anaesthetic_evaluation={...n.checklist.pre_anaesthetic_evaluation,handover:!!t.site_marked}),t.fasting_status&&(n.checklist.npo={...n.checklist.npo,comments:t.fasting_status}),t.device_checks&&(n.checklist.pre_anaesthetic_evaluation={...n.checklist.pre_anaesthetic_evaluation,comments:t.device_checks}),t.notes&&(n.checklist.sterile_preparation_done={...n.checklist.sterile_preparation_done,comments:t.notes}),t.investigations&&(n.investigations={...s.investigations,...t.investigations}),t.vitals&&(n.vitals={...s.vitals,...t.vitals}),"shave_completed"in t&&(n.shave_completed=t.shave_completed),"nurse_signature"in t&&(n.nurse_signature=t.nurse_signature||""),n};function j9e({caseId:t}){const s=nt("ot.cases.view")||nt("ot.preop_checklist.view"),n=nt("ot.preop_checklist.update")||nt("ot.preop_checklist.create")||nt("ot.cases.update"),[a,i]=y.useState(null),[l,o]=y.useState(Sy),[c,d]=y.useState(!1),[u,h]=y.useState(!1),[f,x]=y.useState(null),b=async()=>{var A;if(s)try{d(!0),x(null);const T=await hpe(t);if(console.log("[PreOp] loaded record",T),!T){i(null),o(Sy());return}i(T),o(w9e(T))}catch(T){((A=T==null?void 0:T.response)==null?void 0:A.status)===404?(i(null),o(Sy())):(console.error("Failed to load Pre-op checklist",T),x("Failed to load Pre-op checklist"))}finally{d(!1)}};if(y.useEffect(()=>{b()},[t,s]),!s)return r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view pre-operative checklists."});const v=(A,T,P)=>{o(O=>({...O,checklist:{...O.checklist,[A]:{...O.checklist[A],[T]:P}}}))},w=(A,T)=>{o(P=>({...P,investigations:{...P.investigations,[A]:T}}))},_=(A,T)=>{o(P=>({...P,vitals:{...P.vitals,[A]:T}}))},S=async A=>{var T,P;if(A.preventDefault(),!!n){h(!0),x(null);try{const O={checklist:l.checklist,investigations:{...l.investigations},vitals:{...l.vitals},shave_completed:l.shave_completed,nurse_signature:l.nurse_signature||null,patient_identity_confirmed:!!l.checklist.identity_bands_checked.handover,consent_checked:!!l.checklist.consent_form_signed.handover,investigations_checked:!!l.checklist.patient_files_with_records.handover,blood_products_arranged:!!l.checklist.blood_reservation.handover,implants_available:!!l.checklist.prosthesis_dentures_wig_contactlens_removed.handover,site_marked:!!l.checklist.pre_anaesthetic_evaluation.handover,fasting_status:l.checklist.npo.comments||null,device_checks:l.checklist.pre_anaesthetic_evaluation.comments||null,notes:l.checklist.sterile_preparation_done.comments||null,completed:!1};a?await fpe(t,O):await mpe(t,O),await b()}catch(O){console.error("Failed to save Pre-op checklist",O);const D=((P=(T=O==null?void 0:O.response)==null?void 0:T.data)==null?void 0:P.detail)||(O==null?void 0:O.message)||"Failed to save Pre-op checklist";x(D)}finally{h(!1)}}},k=(a==null?void 0:a.completed_at)||(a==null?void 0:a.updated_at)||(a==null?void 0:a.created_at);return r.jsxs("form",{onSubmit:S,className:"space-y-4 rounded-2xl border border-slate-200 bg-white/90 px-3 py-3 shadow-sm md:px-4 md:py-4",children:[r.jsxs(at.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},className:"flex flex-wrap items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sky-800",children:[r.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-sky-50 text-sky-700",children:r.jsx(mse,{className:"h-4 w-4"})}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-sm font-semibold md:text-base",children:"Pre-operative checklist"}),r.jsx("span",{className:"text-[11px] text-slate-500",children:"Aligns with OT pre-op safety form (handover & receiving)."})]})]}),k&&r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2.5 py-1 text-[11px] font-medium text-emerald-700",children:[r.jsx(Dn,{className:"h-3.5 w-3.5"}),"Last saved: ",new Date(k).toLocaleString()]})]}),c&&r.jsxs("div",{className:"space-y-2",children:[r.jsx("div",{className:"h-10 w-full animate-pulse rounded-xl bg-slate-100"}),r.jsx("div",{className:"h-10 w-full animate-pulse rounded-xl bg-slate-100"}),r.jsx("div",{className:"h-10 w-full animate-pulse rounded-xl bg-slate-100"})]}),f&&r.jsxs("div",{className:"flex items-start gap-2 rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[r.jsx(nn,{className:"mt-0.5 h-3.5 w-3.5"}),r.jsx("span",{children:f})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:[r.jsx("span",{children:"Checklist items"}),r.jsxs("span",{className:"hidden gap-4 md:flex",children:[r.jsx("span",{children:"Handover"}),r.jsx("span",{children:"Receiving"})]})]}),r.jsx(vl,{initial:!1,children:tY.map((A,T)=>{const P=l.checklist[A.key],O=P.handover||P.receiving;return r.jsxs(at.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},transition:{duration:.16,delay:T*.01},className:`rounded-2xl border px-3 py-2.5 text-xs md:px-3.5 md:py-3 ${O?"border-sky-200 bg-sky-50/80":"border-slate-200 bg-slate-50/60"}`,children:[r.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[r.jsx("div",{className:"flex-1",children:r.jsx("div",{className:"text-[13px] font-semibold text-slate-900",children:A.label})}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-[11px] md:gap-4",children:[r.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!P.handover,disabled:!n,onChange:D=>v(A.key,"handover",D.target.checked)}),r.jsx("span",{className:"font-medium text-slate-700",children:"Handover"})]}),r.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!P.receiving,disabled:!n,onChange:D=>v(A.key,"receiving",D.target.checked)}),r.jsx("span",{className:"font-medium text-slate-700",children:"Receiving"})]})]})]}),r.jsx("div",{className:"mt-2",children:r.jsx("input",{type:"text",className:"w-full rounded-xl border border-slate-200 bg-white px-2.5 py-1.5 text-[11px] text-slate-800 placeholder:text-slate-400 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",placeholder:"Comments / remarks",value:P.comments||"",disabled:!n,onChange:D=>v(A.key,"comments",D.target.value)})})]},A.key)})})]}),r.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[r.jsxs(at.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},className:"space-y-2 rounded-2xl border border-slate-200 bg-slate-50/80 p-3",children:[r.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Investigations"}),[["hb","HB"],["platelet","Platelet"],["urea","Urea"],["creatinine","Creatinine"],["potassium","Potassium"],["rbs","RBS"],["other","Others"]].map(([A,T])=>r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"w-24 text-[11px] font-medium text-slate-700",children:[T," :"]}),r.jsx("input",{type:"text",className:"flex-1 rounded-xl border border-slate-200 bg-white px-2.5 py-1.5 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.investigations[A],disabled:!n,onChange:P=>w(A,P.target.value)})]},A))]}),r.jsxs(at.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},className:"space-y-2 rounded-2xl border border-slate-200 bg-slate-50/80 p-3",children:[r.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Vitals"}),[["temp","Temp"],["pulse","Pulse"],["resp","Resp"],["bp","BP"],["spo2","SpO"],["height","Height"],["weight","Weight"]].map(([A,T])=>r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"w-24 text-[11px] font-medium text-slate-700",children:[T," :"]}),r.jsx("input",{type:"text",className:"flex-1 rounded-xl border border-slate-200 bg-white px-2.5 py-1.5 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.vitals[A],disabled:!n,onChange:P=>_(A,P.target.value)})]},A))]})]}),r.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[r.jsxs(at.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},className:"space-y-2 rounded-2xl border border-slate-200 bg-slate-50/80 p-3",children:[r.jsx("div",{className:"text-xs font-semibold text-slate-700",children:"Shave completed"}),r.jsxs("div",{className:"flex gap-4 text-xs",children:[r.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[r.jsx("input",{type:"radio",className:"h-3.5 w-3.5 border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.shave_completed==="yes",disabled:!n,onChange:()=>o(A=>({...A,shave_completed:"yes"}))}),r.jsx("span",{children:"Yes"})]}),r.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[r.jsx("input",{type:"radio",className:"h-3.5 w-3.5 border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.shave_completed==="no",disabled:!n,onChange:()=>o(A=>({...A,shave_completed:"no"}))}),r.jsx("span",{children:"No"})]})]}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"(Body diagram marking can be handled at PDF / print level.)"})]}),r.jsxs(at.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},className:"space-y-2 rounded-2xl border border-slate-200 bg-slate-50/80 p-3",children:[r.jsx("label",{className:"text-xs font-semibold text-slate-700",children:"Signature with name (nurse)"}),r.jsx("input",{type:"text",className:"w-full rounded-xl border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",placeholder:"Name & signature",value:l.nurse_signature,disabled:!n,onChange:A=>o(T=>({...T,nurse_signature:A.target.value}))})]})]}),n&&r.jsx("div",{className:"flex justify-end pt-1",children:r.jsxs("button",{type:"submit",disabled:u,className:"inline-flex items-center justify-center gap-1.5 rounded-full border border-sky-600 bg-sky-600 px-3.5 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-sky-700 disabled:opacity-60",children:[u&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save Pre-op checklist"]})})]})}function _9e(t){if(!t)return null;const s=new Date(t);return Number.isNaN(s.getTime())?null:s}function S9e(t){const s=_9e(t);return s?s.toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):""}function j2(t){if(!t)return"";if(/^\d{2}:\d{2}$/.test(t))return t;const s=new Date(t);return Number.isNaN(s.getTime())?"":s.toISOString().slice(11,16)}const sY={identity_site_procedure_consent_confirmed:!1,site_marked:"",machine_and_medication_check_complete:!1,known_allergy:"",difficult_airway_or_aspiration_risk:"",blood_loss_risk_gt500ml_or_7mlkg:"",equipment_assistance_available:!1,iv_central_access_and_fluids_planned:!1},nY={team_members_introduced:!1,patient_name_procedure_incision_site_confirmed:!1,antibiotic_prophylaxis_given:"",surgeon_critical_steps:"",surgeon_case_duration_estimate:"",surgeon_anticipated_blood_loss:"",anaesthetist_patient_specific_concerns:"",sterility_confirmed:!1,equipment_issues_or_concerns:!1,essential_imaging_displayed:""},rY={procedure_name_confirmed:!1,counts_complete:!1,specimens_labelled_correctly:!1,equipment_problems_to_be_addressed:"",key_concerns_for_recovery_and_management:""},_2=()=>({sign_in_done:!1,sign_in_time:"",time_out_done:!1,time_out_time:"",sign_out_done:!1,sign_out_time:"",sign_in:{...sY},time_out:{...nY},sign_out:{...rY}});function C9e({caseId:t}){const s=nt("ot.cases.view")||nt("ot.safety.view"),n=nt("ot.safety.manage")||nt("ot.cases.update"),[a,i]=y.useState(null),[l,o]=y.useState(_2),[c,d]=y.useState(!1),[u,h]=y.useState(!1),[f,x]=y.useState(null),b=async()=>{var k;if(s)try{d(!0),x(null);const A=await ppe(t),T=(A==null?void 0:A.data)??A;if(!T){i(null),o(_2());return}i(T),o({sign_in_done:!!T.sign_in_done,sign_in_time:j2(T.sign_in_time),time_out_done:!!T.time_out_done,time_out_time:j2(T.time_out_time),sign_out_done:!!T.sign_out_done,sign_out_time:j2(T.sign_out_time),sign_in:{...sY,...T.sign_in||{}},time_out:{...nY,...T.time_out||{}},sign_out:{...rY,...T.sign_out||{}}})}catch(A){((k=A==null?void 0:A.response)==null?void 0:k.status)===404?(i(null),o(_2())):(console.error("Failed to load Surgical Safety checklist",A),x("Failed to load Surgical Safety checklist"))}finally{d(!1)}};if(y.useEffect(()=>{b()},[t,s]),!s)return r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view Surgical Safety Checklist."});const v=(k,A)=>{o(T=>({...T,[k]:A}))},w=(k,A,T)=>{o(P=>({...P,[k]:{...P[k],[A]:T}}))},_=async k=>{var A,T;if(k.preventDefault(),!!n){h(!0),x(null);try{const P={sign_in_done:!!l.sign_in_done,sign_in_time:l.sign_in_time||null,time_out_done:!!l.time_out_done,time_out_time:l.time_out_time||null,sign_out_done:!!l.sign_out_done,sign_out_time:l.sign_out_time||null,sign_in:l.sign_in,time_out:l.time_out,sign_out:l.sign_out};a?await gpe(t,P):await xpe(t,P),await b()}catch(P){console.error("Failed to save Surgical Safety checklist",P);const O=((T=(A=P==null?void 0:P.response)==null?void 0:A.data)==null?void 0:T.detail)||(P==null?void 0:P.message)||"Failed to save Surgical Safety checklist";x(O)}finally{h(!1)}}},S=(a==null?void 0:a.updated_at)||(a==null?void 0:a.created_at);return r.jsxs("form",{onSubmit:_,className:"space-y-4 rounded-2xl border border-slate-200 bg-white/90 px-3 py-3 shadow-sm md:px-4 md:py-4",children:[r.jsxs(at.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},className:"flex flex-wrap items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sky-800",children:[r.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-sky-50 text-sky-700",children:r.jsx($a,{className:"h-4 w-4"})}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-sm font-semibold md:text-base",children:"WHO Surgical Safety Checklist"}),r.jsx("span",{className:"text-[11px] text-slate-500",children:"Sign-in  Time-out  Sign-out  mapped to WHO & NABH formats."})]})]}),S&&r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2.5 py-1 text-[11px] font-medium text-emerald-700",children:[r.jsx(Dn,{className:"h-3.5 w-3.5"}),"Updated: ",S9e(S)]})]}),c&&r.jsxs("div",{className:"space-y-2",children:[r.jsx("div",{className:"h-10 w-full animate-pulse rounded-xl bg-slate-100"}),r.jsx("div",{className:"h-10 w-full animate-pulse rounded-xl bg-slate-100"}),r.jsx("div",{className:"h-10 w-full animate-pulse rounded-xl bg-slate-100"})]}),f&&r.jsxs("div",{className:"flex items-start gap-2 rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[r.jsx(nn,{className:"mt-0.5 h-3.5 w-3.5"}),r.jsx("span",{children:f})]}),r.jsxs(at.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},className:"grid gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/80 px-3 py-2.5 text-xs",children:[r.jsxs("div",{className:"mb-1 text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:["Sign in ",r.jsx("span",{className:"font-normal",children:"(before induction)"})]}),r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!l.sign_in_done,disabled:!n,onChange:k=>v("sign_in_done",k.target.checked)}),r.jsx("span",{className:"text-[11px] text-slate-800",children:"Checklist completed"})]}),r.jsxs("div",{className:"mt-2 space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Time"}),r.jsx("input",{type:"time",className:"w-full rounded-xl border border-slate-200 bg-white px-2.5 py-1.5 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.sign_in_time,disabled:!n,onChange:k=>v("sign_in_time",k.target.value)})]})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/80 px-3 py-2.5 text-xs",children:[r.jsxs("div",{className:"mb-1 text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:["Time out"," ",r.jsx("span",{className:"font-normal",children:"(before skin incision)"})]}),r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!l.time_out_done,disabled:!n,onChange:k=>v("time_out_done",k.target.checked)}),r.jsx("span",{className:"text-[11px] text-slate-800",children:"Checklist completed"})]}),r.jsxs("div",{className:"mt-2 space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Time"}),r.jsx("input",{type:"time",className:"w-full rounded-xl border border-slate-200 bg-white px-2.5 py-1.5 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.time_out_time,disabled:!n,onChange:k=>v("time_out_time",k.target.value)})]})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/80 px-3 py-2.5 text-xs",children:[r.jsxs("div",{className:"mb-1 text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:["Sign out"," ",r.jsx("span",{className:"font-normal",children:"(before patient leaves OT)"})]}),r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!l.sign_out_done,disabled:!n,onChange:k=>v("sign_out_done",k.target.checked)}),r.jsx("span",{className:"text-[11px] text-slate-800",children:"Checklist completed"})]}),r.jsxs("div",{className:"mt-2 space-y-1",children:[r.jsx("label",{className:"text-[11px] text-slate-600",children:"Time"}),r.jsx("input",{type:"time",className:"w-full rounded-xl border border-slate-200 bg-white px-2.5 py-1.5 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.sign_out_time,disabled:!n,onChange:k=>v("sign_out_time",k.target.value)})]})]})]}),r.jsxs(at.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},className:"space-y-3 rounded-2xl border border-slate-200 bg-slate-50/70 p-3 text-xs",children:[r.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Before induction of anaesthesia"}),r.jsxs("label",{className:"flex items-start gap-2",children:[r.jsx("input",{type:"checkbox",className:"mt-0.5 h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_in.identity_site_procedure_consent_confirmed,disabled:!n,onChange:k=>w("sign_in","identity_site_procedure_consent_confirmed",k.target.checked)}),r.jsx("span",{className:"text-[11px] text-slate-800",children:"Patient confirmed identity, site, procedure and consent"})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:"Is the site marked?"}),["yes","no","na"].map(k=>r.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[r.jsx("input",{type:"radio",className:"h-3.5 w-3.5 border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_in.site_marked===k,disabled:!n,onChange:()=>w("sign_in","site_marked",k)}),r.jsx("span",{className:"capitalize text-[11px] text-slate-700",children:k==="na"?"Not applicable":k})]},k))]}),r.jsxs("label",{className:"flex items-start gap-2",children:[r.jsx("input",{type:"checkbox",className:"mt-0.5 h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_in.machine_and_medication_check_complete,disabled:!n,onChange:k=>w("sign_in","machine_and_medication_check_complete",k.target.checked)}),r.jsx("span",{className:"text-[11px] text-slate-800",children:"Anaesthesia machine and medication check complete"})]}),r.jsxs("div",{className:"flex flex-wrap gap-4",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:"Does the patient have a known allergy?"}),["yes","no"].map(k=>r.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[r.jsx("input",{type:"radio",className:"h-3.5 w-3.5 border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_in.known_allergy===k,disabled:!n,onChange:()=>w("sign_in","known_allergy",k)}),r.jsx("span",{className:"capitalize text-[11px] text-slate-700",children:k})]},k))]}),r.jsxs("div",{className:"flex flex-wrap gap-4",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:"Difficult airway or aspiration risk?"}),["yes","no"].map(k=>r.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[r.jsx("input",{type:"radio",className:"h-3.5 w-3.5 border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_in.difficult_airway_or_aspiration_risk===k,disabled:!n,onChange:()=>w("sign_in","difficult_airway_or_aspiration_risk",k)}),r.jsx("span",{className:"capitalize text-[11px] text-slate-700",children:k})]},k))]}),r.jsxs("div",{className:"flex flex-wrap gap-4",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:"Risk of > 500 ml blood loss (7 ml/kg in children)?"}),["yes","no"].map(k=>r.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[r.jsx("input",{type:"radio",className:"h-3.5 w-3.5 border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_in.blood_loss_risk_gt500ml_or_7mlkg===k,disabled:!n,onChange:()=>w("sign_in","blood_loss_risk_gt500ml_or_7mlkg",k)}),r.jsx("span",{className:"capitalize text-[11px] text-slate-700",children:k})]},k))]}),r.jsxs("label",{className:"flex items-start gap-2",children:[r.jsx("input",{type:"checkbox",className:"mt-0.5 h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_in.equipment_assistance_available,disabled:!n,onChange:k=>w("sign_in","equipment_assistance_available",k.target.checked)}),r.jsx("span",{className:"text-[11px] text-slate-800",children:"Yes, and equipment / assistance available"})]}),r.jsxs("label",{className:"flex items-start gap-2",children:[r.jsx("input",{type:"checkbox",className:"mt-0.5 h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_in.iv_central_access_and_fluids_planned,disabled:!n,onChange:k=>w("sign_in","iv_central_access_and_fluids_planned",k.target.checked)}),r.jsx("span",{className:"text-[11px] text-slate-800",children:"Yes, and two IV / central access and fluids planned"})]})]}),r.jsxs(at.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},className:"space-y-3 rounded-2xl border border-slate-200 bg-slate-50/70 p-3 text-xs",children:[r.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Before skin incision"}),r.jsxs("label",{className:"flex items-start gap-2",children:[r.jsx("input",{type:"checkbox",className:"mt-0.5 h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.time_out.team_members_introduced,disabled:!n,onChange:k=>w("time_out","team_members_introduced",k.target.checked)}),r.jsx("span",{className:"text-[11px] text-slate-800",children:"All team members (nurse, anaesthetist, surgeon) have introduced themselves by name and role"})]}),r.jsxs("label",{className:"flex items-start gap-2",children:[r.jsx("input",{type:"checkbox",className:"mt-0.5 h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.time_out.patient_name_procedure_incision_site_confirmed,disabled:!n,onChange:k=>w("time_out","patient_name_procedure_incision_site_confirmed",k.target.checked)}),r.jsx("span",{className:"text-[11px] text-slate-800",children:"Patient name, procedure, and incision site confirmed aloud"})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:"Has antibiotic prophylaxis been given in last 60 minutes?"}),["yes","no","na"].map(k=>r.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[r.jsx("input",{type:"radio",className:"h-3.5 w-3.5 border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.time_out.antibiotic_prophylaxis_given===k,disabled:!n,onChange:()=>w("time_out","antibiotic_prophylaxis_given",k)}),r.jsx("span",{className:"capitalize text-[11px] text-slate-700",children:k==="na"?"Not applicable":k})]},k))]}),r.jsxs("div",{className:"mt-1 grid gap-2 md:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:"To Surgeon  critical / non-routine steps"}),r.jsx("input",{type:"text",className:"w-full rounded-xl border border-slate-200 bg-white px-2.5 py-1.5 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.time_out.surgeon_critical_steps,disabled:!n,onChange:k=>w("time_out","surgeon_critical_steps",k.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:"To Surgeon  expected case duration"}),r.jsx("input",{type:"text",className:"w-full rounded-xl border border-slate-200 bg-white px-2.5 py-1.5 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.time_out.surgeon_case_duration_estimate,disabled:!n,onChange:k=>w("time_out","surgeon_case_duration_estimate",k.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:"To Surgeon  anticipated blood loss"}),r.jsx("input",{type:"text",className:"w-full rounded-xl border border-slate-200 bg-white px-2.5 py-1.5 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.time_out.surgeon_anticipated_blood_loss,disabled:!n,onChange:k=>w("time_out","surgeon_anticipated_blood_loss",k.target.value)})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:"To Anaesthetist  patient-specific concerns"}),r.jsx("input",{type:"text",className:"w-full rounded-xl border border-slate-200 bg-white px-2.5 py-1.5 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.time_out.anaesthetist_patient_specific_concerns,disabled:!n,onChange:k=>w("time_out","anaesthetist_patient_specific_concerns",k.target.value)})]}),r.jsxs("div",{className:"grid gap-2 md:grid-cols-3",children:[r.jsxs("label",{className:"flex items-start gap-2",children:[r.jsx("input",{type:"checkbox",className:"mt-0.5 h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.time_out.sterility_confirmed,disabled:!n,onChange:k=>w("time_out","sterility_confirmed",k.target.checked)}),r.jsx("span",{className:"text-[11px] text-slate-800",children:"Sterility (including indicators) confirmed"})]}),r.jsxs("label",{className:"flex items-start gap-2",children:[r.jsx("input",{type:"checkbox",className:"mt-0.5 h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.time_out.equipment_issues_or_concerns,disabled:!n,onChange:k=>w("time_out","equipment_issues_or_concerns",k.target.checked)}),r.jsx("span",{className:"text-[11px] text-slate-800",children:"Any equipment issues or concerns"})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:"Essential imaging displayed?"}),["yes","no","na"].map(k=>r.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[r.jsx("input",{type:"radio",className:"h-3.5 w-3.5 border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.time_out.essential_imaging_displayed===k,disabled:!n,onChange:()=>w("time_out","essential_imaging_displayed",k)}),r.jsx("span",{className:"capitalize text-[11px] text-slate-700",children:k==="na"?"Not applicable":k})]},k))]})]})]}),r.jsxs(at.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},className:"space-y-3 rounded-2xl border border-slate-200 bg-slate-50/70 p-3 text-xs",children:[r.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Before patient leaves operating room"}),r.jsxs("label",{className:"flex items-start gap-2",children:[r.jsx("input",{type:"checkbox",className:"mt-0.5 h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_out.procedure_name_confirmed,disabled:!n,onChange:k=>w("sign_out","procedure_name_confirmed",k.target.checked)}),r.jsx("span",{className:"text-[11px] text-slate-800",children:"Nurse verbally confirms the name of the procedure"})]}),r.jsxs("label",{className:"flex items-start gap-2",children:[r.jsx("input",{type:"checkbox",className:"mt-0.5 h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_out.counts_complete,disabled:!n,onChange:k=>w("sign_out","counts_complete",k.target.checked)}),r.jsx("span",{className:"text-[11px] text-slate-800",children:"Completion of instrument, sponge and needle counts"})]}),r.jsxs("label",{className:"flex items-start gap-2",children:[r.jsx("input",{type:"checkbox",className:"mt-0.5 h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_out.specimens_labelled_correctly,disabled:!n,onChange:k=>w("sign_out","specimens_labelled_correctly",k.target.checked)}),r.jsx("span",{className:"text-[11px] text-slate-800",children:"Specimen labelling / read specimen labels aloud (including patient name)"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:"Whether there are any equipment problems to be addressed"}),r.jsx("input",{type:"text",className:"w-full rounded-xl border border-slate-200 bg-white px-2.5 py-1.5 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.sign_out.equipment_problems_to_be_addressed||"",disabled:!n,onChange:k=>w("sign_out","equipment_problems_to_be_addressed",k.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:"To Surgeon, Anaesthetist and Nurse  key concerns for recovery and management of this patient"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-xl border border-slate-200 bg-white px-2.5 py-1.5 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.sign_out.key_concerns_for_recovery_and_management||"",disabled:!n,onChange:k=>w("sign_out","key_concerns_for_recovery_and_management",k.target.value)})]})]}),n&&r.jsx("div",{className:"flex justify-end",children:r.jsxs("button",{type:"submit",disabled:u,className:"inline-flex items-center gap-1.5 rounded-full border border-sky-600 bg-sky-600 px-3.5 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-sky-700 disabled:opacity-60",children:[u&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save Safety checklist"]})})]})}const w6={anaesthesia_type:"",asa_grade:"",airway_assessment:"",comorbidities:"",allergies:"",preop_pulse:"",preop_bp:"",preop_rr:"",preop_temp_c:"",preop_cvs:"",preop_rs:"",preop_cns:"",preop_pa:"",preop_veins:"",preop_spine:"",airway_teeth_status:"",airway_denture:"",airway_neck_movements:"",airway_mallampati_class:"",difficult_airway_anticipated:!1,risk_factors:"",anaesthetic_plan_detail:"",preop_instructions:"",preoxygenation:!1,cricoid_pressure:!1,induction_route:"",intubation_done:!1,intubation_route:"",intubation_state:"",intubation_technique:"",tube_type:"",tube_size:"",tube_fixed_at:"",cuff_used:!1,cuff_medium:"",bilateral_breath_sounds:"",added_sounds:"",laryngoscopy_grade:"",airway_devices:[],ventilation_mode_baseline:"",ventilator_vt:"",ventilator_rate:"",ventilator_peep:"",breathing_system:"",monitors:{},lines:{},tourniquet_used:!1,patient_position:"",eyes_taped:!1,eyes_covered_with_foil:!1,pressure_points_padded:!1,iv_fluids_plan:"",blood_components_plan:"",regional_block_type:"",regional_position:"",regional_approach:"",regional_space_depth:"",regional_needle_type:"",regional_drug_dose:"",regional_level:"",regional_complications:"",block_adequacy:"",sedation_needed:!1,conversion_to_ga:!1,notes:""},j6={time:"",hr:"",bp:"",spo2:"",rr:"",temp_c:"",etco2:"",ventilation_mode:"",peak_airway_pressure:"",cvp_pcwp:"",st_segment:"",urine_output_ml:"",blood_loss_ml:"",comments:""},_6={time:"",drug_name:"",dose:"",route:"",remarks:""};function S2(t){if(t==null)return null;const s=String(t).trim();if(!s)return null;const n=parseInt(s,10);return Number.isNaN(n)?null:n}function k9e({caseId:t}){const[s,n]=y.useState("preop"),[a,i]=y.useState(w6),[l,o]=y.useState({id:null,created_at:null}),[c,d]=y.useState(!0),[u,h]=y.useState(!1),[f,x]=y.useState(null),[b,v]=y.useState(null),[w,_]=y.useState([]),[S,k]=y.useState(j6),[A,T]=y.useState(!1),[P,O]=y.useState([]),[D,I]=y.useState(_6),[M,B]=y.useState(!1);y.useEffect(()=>{let X=!0;return(async()=>{var Ce;d(!0),x(null);try{const fe=(await ype(t)).data;if(!X)return;if(i(pe=>({...pe,...fe,monitors:fe.monitors||{},lines:fe.lines||{},airway_devices:fe.airway_devices||[]})),o({id:fe.id,created_at:fe.created_at}),fe.id){const[pe,oe]=await Promise.all([Npe(fe.id),_pe(fe.id)]);if(!X)return;_(pe.data||[]),O(oe.data||[])}}catch(ue){((Ce=ue==null?void 0:ue.response)==null?void 0:Ce.status)===404?(i(w6),o({id:null,created_at:null}),_([]),O([])):(console.error("Anaesthesia load error",ue),x("Unable to load anaesthesia record. Please try again."))}finally{X&&d(!1)}})(),()=>{X=!1}},[t]);const L=y.useMemo(()=>f?r.jsxs("div",{className:"mb-3 flex items-center gap-2 rounded-xl border border-red-200 bg-red-50 px-3 py-2 text-[13px] text-red-700",children:[r.jsx(nn,{className:"h-4 w-4"}),r.jsx("span",{children:f})]}):b?r.jsxs("div",{className:"mb-3 flex items-center gap-2 rounded-xl border border-emerald-200 bg-emerald-50 px-3 py-2 text-[13px] text-emerald-700",children:[r.jsx(Dn,{className:"h-4 w-4"}),r.jsx("span",{children:b})]}):null,[f,b]),F=(X,de)=>{i(Ce=>({...Ce,[X]:de}))},V=X=>{i(de=>({...de,[X]:!de[X]}))},$=X=>{i(de=>{var Ce;return{...de,monitors:{...de.monitors||{},[X]:!((Ce=de.monitors)!=null&&Ce[X])}}})},z=X=>{i(de=>{var Ce;return{...de,lines:{...de.lines||{},[X]:!((Ce=de.lines)!=null&&Ce[X])}}})},H=X=>{i(de=>{const Ce=de.airway_devices||[];return Ce.includes(X)?{...de,airway_devices:Ce.filter(ue=>ue!==X)}:{...de,airway_devices:[...Ce,X]}})},q=async()=>{h(!0),x(null),v(null);try{const X={...a,ventilator_vt:S2(a.ventilator_vt),ventilator_rate:S2(a.ventilator_rate),ventilator_peep:S2(a.ventilator_peep)};if(l.id)await vpe(t,X);else{const de=await bpe(t,X);o({id:de.data.id,created_at:de.data.created_at})}v("Anaesthesia record saved.")}catch(X){console.error("Save anaesthesia record error",X),x("Unable to save anaesthesia record.")}finally{h(!1)}},G=async()=>{if(!l.id){x("Save the anaesthesia record before adding vitals.");return}if(!S.time){x("Time is required for vitals (HH:MM).");return}T(!0),x(null),v(null);try{const X={...S,hr:S.hr?Number(S.hr):null,spo2:S.spo2?Number(S.spo2):null,rr:S.rr?Number(S.rr):null,temp_c:S.temp_c?Number(S.temp_c):null,etco2:S.etco2?Number(S.etco2):null,peak_airway_pressure:S.peak_airway_pressure?Number(S.peak_airway_pressure):null,cvp_pcwp:S.cvp_pcwp?Number(S.cvp_pcwp):null,urine_output_ml:S.urine_output_ml?Number(S.urine_output_ml):null,blood_loss_ml:S.blood_loss_ml?Number(S.blood_loss_ml):null},de=await wpe(l.id,X);_(Ce=>[...Ce,de.data]),k(j6),v("Vitals entry added.")}catch(X){console.error("Add vital error",X),x("Unable to add vitals entry.")}finally{T(!1)}},re=async X=>{if(window.confirm("Delete this vitals entry?")){T(!0),x(null),v(null);try{await jpe(X),_(de=>de.filter(Ce=>Ce.id!==X)),v("Vitals entry deleted.")}catch(de){console.error("Delete vital error",de),x("Unable to delete vitals entry.")}finally{T(!1)}}},ye=async()=>{if(!l.id){x("Save the anaesthesia record before adding drug log.");return}if(!D.time||!D.drug_name){x("Drug time and name are required.");return}B(!0),x(null),v(null);try{const X=await Spe(l.id,D);O(de=>[...de,X.data]),I(_6),v("Drug log entry added.")}catch(X){console.error("Add drug error",X),x("Unable to add drug log entry.")}finally{B(!1)}},Ee=async X=>{if(window.confirm("Delete this drug entry?")){B(!0),x(null),v(null);try{await Cpe(X),O(de=>de.filter(Ce=>Ce.id!==X)),v("Drug log entry deleted.")}catch(de){console.error("Delete drug error",de),x("Unable to delete drug entry.")}finally{B(!1)}}},ee=()=>r.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 shadow-sm",children:[r.jsxs("h3",{className:"mb-1 flex items-center gap-2 text-sm font-semibold text-slate-900",children:[r.jsx(yr,{className:"h-4 w-4"}),"Pre-anaesthetic assessment"]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 text-[12px] sm:grid-cols-2",children:[r.jsx(It,{label:"ASA Grade",value:a.asa_grade,onChange:X=>F("asa_grade",X)}),r.jsx(It,{label:"Anaesthesia type",value:a.anaesthesia_type,onChange:X=>F("anaesthesia_type",X)}),r.jsx(It,{label:"Co-morbidities",value:a.comorbidities,onChange:X=>F("comorbidities",X)}),r.jsx(It,{label:"Allergies",value:a.allergies,onChange:X=>F("allergies",X)})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3 text-[12px] md:grid-cols-4",children:[r.jsx(It,{label:"Pulse",value:a.preop_pulse,onChange:X=>F("preop_pulse",X)}),r.jsx(It,{label:"BP",value:a.preop_bp,onChange:X=>F("preop_bp",X)}),r.jsx(It,{label:"RR",value:a.preop_rr,onChange:X=>F("preop_rr",X)}),r.jsx(It,{label:"Temp (C)",value:a.preop_temp_c,onChange:X=>F("preop_temp_c",X)})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 text-[12px] sm:grid-cols-2",children:[r.jsx(It,{label:"CVS",value:a.preop_cvs,onChange:X=>F("preop_cvs",X)}),r.jsx(It,{label:"RS",value:a.preop_rs,onChange:X=>F("preop_rs",X)}),r.jsx(It,{label:"CNS",value:a.preop_cns,onChange:X=>F("preop_cns",X)}),r.jsx(It,{label:"PA",value:a.preop_pa,onChange:X=>F("preop_pa",X)}),r.jsx(It,{label:"Veins",value:a.preop_veins,onChange:X=>F("preop_veins",X)}),r.jsx(It,{label:"Spine",value:a.preop_spine,onChange:X=>F("preop_spine",X)})]})]}),r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 shadow-sm",children:[r.jsxs("h3",{className:"mb-1 flex items-center gap-2 text-sm font-semibold text-slate-900",children:[r.jsx(Vs,{className:"h-4 w-4"}),"Airway & risk"]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 text-[12px] sm:grid-cols-2",children:[r.jsx(It,{label:"Teeth",placeholder:"Intact / Loose",value:a.airway_teeth_status,onChange:X=>F("airway_teeth_status",X)}),r.jsx(It,{label:"Denture",placeholder:"Present / Absent",value:a.airway_denture,onChange:X=>F("airway_denture",X)}),r.jsx(It,{label:"Neck movements",value:a.airway_neck_movements,onChange:X=>F("airway_neck_movements",X)}),r.jsx(It,{label:"Mallampati class",placeholder:"Class 1 / 2 / 3 / 4",value:a.airway_mallampati_class,onChange:X=>F("airway_mallampati_class",X)})]}),r.jsx("div",{className:"flex items-center gap-2 text-[12px]",children:r.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300",checked:a.difficult_airway_anticipated||!1,onChange:()=>V("difficult_airway_anticipated")}),r.jsx("span",{className:"text-slate-700",children:"Difficult airway anticipated"})]})}),r.jsx(zg,{label:"Risk factors",value:a.risk_factors,onChange:X=>F("risk_factors",X)}),r.jsx(zg,{label:"Anaesthetic plan",value:a.anaesthetic_plan_detail,onChange:X=>F("anaesthetic_plan_detail",X)}),r.jsx(zg,{label:"Pre-op instructions",value:a.preop_instructions,onChange:X=>F("preop_instructions",X)})]})]}),te=()=>r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 text-[12px] shadow-sm",children:[r.jsx("h3",{className:"mb-1 text-sm font-semibold text-slate-900",children:"Induction & intubation"}),r.jsxs("div",{className:"flex flex-wrap gap-3",children:[r.jsx(Qa,{label:"Preoxygenation",checked:a.preoxygenation,onChange:()=>V("preoxygenation")}),r.jsx(Qa,{label:"Cricoid pressure",checked:a.cricoid_pressure,onChange:()=>V("cricoid_pressure")})]}),r.jsx(Ul,{label:"Induction",value:a.induction_route,onChange:X=>F("induction_route",X),options:["","Intravenous","Inhalational","Rapid sequence"]}),r.jsx(Qa,{label:"Intubation done",checked:a.intubation_done,onChange:()=>V("intubation_done")}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[r.jsx(Ul,{label:"Route",value:a.intubation_route,onChange:X=>F("intubation_route",X),options:["","Oral","Nasal"]}),r.jsx(Ul,{label:"State",value:a.intubation_state,onChange:X=>F("intubation_state",X),options:["","Awake","Anaesthetised"]}),r.jsx(Ul,{label:"Technique",value:a.intubation_technique,onChange:X=>F("intubation_technique",X),options:["","Visual","Blind","Fibreoptic","Retrograde"]}),r.jsx(It,{label:"Laryngoscopy grade",placeholder:"I / II / III / IV",value:a.laryngoscopy_grade,onChange:X=>F("laryngoscopy_grade",X)})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[r.jsx(It,{label:"Tube type",value:a.tube_type,onChange:X=>F("tube_type",X)}),r.jsx(It,{label:"Size",value:a.tube_size,onChange:X=>F("tube_size",X)}),r.jsx(It,{label:"Fixed at",value:a.tube_fixed_at,onChange:X=>F("tube_fixed_at",X)}),r.jsx(Ul,{label:"Cuff medium",value:a.cuff_medium,onChange:X=>F("cuff_medium",X),options:["","Air","Saline","Not inflated"]})]}),r.jsx(Qa,{label:"Cuff used",checked:a.cuff_used,onChange:()=>V("cuff_used")}),r.jsx(It,{label:"Bilateral breath sounds",value:a.bilateral_breath_sounds,onChange:X=>F("bilateral_breath_sounds",X)}),r.jsx(It,{label:"Added sounds",value:a.added_sounds,onChange:X=>F("added_sounds",X)})]}),r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 text-[12px] shadow-sm",children:[r.jsx("h3",{className:"mb-1 text-sm font-semibold text-slate-900",children:"Airway devices & monitors"}),r.jsx("div",{className:"mb-2 text-[11px] font-semibold text-slate-600",children:"Airway devices"}),r.jsx("div",{className:"grid grid-cols-2 gap-1",children:["Face mask","LMA/ILMA","Oral airway","Throat pack","NG tube","Other"].map(X=>r.jsx(Qa,{label:X,checked:(a.airway_devices||[]).includes(X),onChange:()=>H(X)},X))}),r.jsx("div",{className:"mt-3 text-[11px] font-semibold text-slate-600",children:"Monitors"}),r.jsx("div",{className:"grid grid-cols-2 gap-1",children:[["ecg","ECG"],["nibp","NIBP"],["pulse_oximeter","Pulse oximeter"],["capnograph","Capnograph"],["agent_monitor","Agent monitor"],["pns","PNS"],["temperature","Temperature"],["urinary_catheter","Urinary catheter"],["ibp","IBP"],["cvp","CVP"],["precordial_steth","Precordial steth"],["oesophageal_steth","Oesophageal steth"]].map(([X,de])=>{var Ce;return r.jsx(Qa,{label:de,checked:((Ce=a.monitors)==null?void 0:Ce[X])||!1,onChange:()=>$(X)},X)})})]}),r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 text-[12px] shadow-sm",children:[r.jsx("h3",{className:"mb-1 text-sm font-semibold text-slate-900",children:"Ventilation & block"}),r.jsx(Ul,{label:"Ventilation mode",value:a.ventilation_mode_baseline,onChange:X=>F("ventilation_mode_baseline",X),options:["","Spontaneous","Controlled","Manual","Ventilator"]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-3",children:[r.jsx(It,{label:"Vt (ml)",value:a.ventilator_vt,onChange:X=>F("ventilator_vt",X)}),r.jsx(It,{label:"Rate (f)",value:a.ventilator_rate,onChange:X=>F("ventilator_rate",X)}),r.jsx(It,{label:"PEEP (cmHO)",value:a.ventilator_peep,onChange:X=>F("ventilator_peep",X)})]}),r.jsx(Ul,{label:"Breathing system",value:a.breathing_system,onChange:X=>F("breathing_system",X),options:["","Mapleson A","Mapleson D","Mapleson F","Circle system","Other"]}),r.jsx("div",{className:"mt-2 text-[11px] font-semibold text-slate-600",children:"Position & protection"}),r.jsx(Ul,{label:"Patient position",value:a.patient_position,onChange:X=>F("patient_position",X),options:["","Supine","Lateral","Prone","Lithotomy","Other"]}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsx(Qa,{label:"Eyes taped",checked:a.eyes_taped,onChange:()=>V("eyes_taped")}),r.jsx(Qa,{label:"Eyes covered with foil",checked:a.eyes_covered_with_foil,onChange:()=>V("eyes_covered_with_foil")}),r.jsx(Qa,{label:"Pressure points padded",checked:a.pressure_points_padded,onChange:()=>V("pressure_points_padded")})]}),r.jsx("div",{className:"mt-2 text-[11px] font-semibold text-slate-600",children:"Lines & tourniquet"}),r.jsx("div",{className:"grid grid-cols-2 gap-1",children:[["peripheral_iv","Peripheral IV"],["central_line","Central line"],["arterial_line","Arterial line"]].map(([X,de])=>{var Ce;return r.jsx(Qa,{label:de,checked:((Ce=a.lines)==null?void 0:Ce[X])||!1,onChange:()=>z(X)},X)})}),r.jsx(Qa,{label:"Tourniquet used",checked:a.tourniquet_used,onChange:()=>V("tourniquet_used")}),r.jsx(It,{label:"IV fluids plan",value:a.iv_fluids_plan,onChange:X=>F("iv_fluids_plan",X)}),r.jsx(It,{label:"Blood & components plan",value:a.blood_components_plan,onChange:X=>F("blood_components_plan",X)}),r.jsx("div",{className:"mt-2 text-[11px] font-semibold text-slate-600",children:"Regional block"}),r.jsx(Ul,{label:"Type",value:a.regional_block_type,onChange:X=>F("regional_block_type",X),options:["","Spinal","Epidural","Nerve block","Combined","None"]}),r.jsx(It,{label:"Position",value:a.regional_position,onChange:X=>F("regional_position",X)}),r.jsx(It,{label:"Approach",value:a.regional_approach,onChange:X=>F("regional_approach",X)}),r.jsx(It,{label:"Space & depth",value:a.regional_space_depth,onChange:X=>F("regional_space_depth",X)}),r.jsx(It,{label:"Needle type",value:a.regional_needle_type,onChange:X=>F("regional_needle_type",X)}),r.jsx(It,{label:"Drug injected / dose",value:a.regional_drug_dose,onChange:X=>F("regional_drug_dose",X)}),r.jsx(It,{label:"Level of anaesthesia",value:a.regional_level,onChange:X=>F("regional_level",X)}),r.jsx(It,{label:"Complications",value:a.regional_complications,onChange:X=>F("regional_complications",X)}),r.jsx(Ul,{label:"Adequacy of block",value:a.block_adequacy,onChange:X=>F("block_adequacy",X),options:["","Excellent","Adequate","Poor"]}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsx(Qa,{label:"Sedation needed",checked:a.sedation_needed,onChange:()=>V("sedation_needed")}),r.jsx(Qa,{label:"Conversion to GA",checked:a.conversion_to_ga,onChange:()=>V("conversion_to_ga")})]})]})]}),r.jsx(zg,{label:"Intra-op summary / notes",value:a.notes||"",onChange:X=>F("notes",X)})]}),ce=()=>r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 text-[12px] shadow-sm",children:[r.jsxs("h3",{className:"mb-2 flex items-center gap-2 text-sm font-semibold text-slate-900",children:[r.jsx(Vs,{className:"h-4 w-4"}),"Intra-op vitals log"]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-6",children:[r.jsx(It,{label:"Time (HH:MM)",value:S.time,onChange:X=>k(de=>({...de,time:X}))}),r.jsx(It,{label:"HR",value:S.hr,onChange:X=>k(de=>({...de,hr:X}))}),r.jsx(It,{label:"BP",value:S.bp,onChange:X=>k(de=>({...de,bp:X}))}),r.jsx(It,{label:"SpO",value:S.spo2,onChange:X=>k(de=>({...de,spo2:X}))}),r.jsx(It,{label:"RR",value:S.rr,onChange:X=>k(de=>({...de,rr:X}))}),r.jsx(It,{label:"Temp C",value:S.temp_c,onChange:X=>k(de=>({...de,temp_c:X}))})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-6",children:[r.jsx(It,{label:"ETCO",value:S.etco2,onChange:X=>k(de=>({...de,etco2:X}))}),r.jsx(It,{label:"Vent mode",value:S.ventilation_mode,onChange:X=>k(de=>({...de,ventilation_mode:X}))}),r.jsx(It,{label:"Peak P (cmHO)",value:S.peak_airway_pressure,onChange:X=>k(de=>({...de,peak_airway_pressure:X}))}),r.jsx(It,{label:"CVP / PCWP",value:S.cvp_pcwp,onChange:X=>k(de=>({...de,cvp_pcwp:X}))}),r.jsx(It,{label:"Urine (ml)",value:S.urine_output_ml,onChange:X=>k(de=>({...de,urine_output_ml:X}))}),r.jsx(It,{label:"Blood loss (ml)",value:S.blood_loss_ml,onChange:X=>k(de=>({...de,blood_loss_ml:X}))})]}),r.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-end",children:[r.jsx("div",{className:"flex-1",children:r.jsx(It,{label:"ST segment / comments",value:S.st_segment||S.comments,onChange:X=>k(de=>({...de,st_segment:X,comments:X}))})}),r.jsx("button",{type:"button",onClick:G,disabled:A,className:"inline-flex items-center justify-center rounded-full bg-slate-900 px-4 py-2 text-[12px] font-semibold text-white shadow hover:bg-slate-800 disabled:cursor-not-allowed disabled:opacity-60",children:A?"Adding":"Add vitals"})]}),r.jsx("div",{className:"mt-3 overflow-x-auto",children:r.jsxs("table",{className:"min-w-full text-[11px]",children:[r.jsx("thead",{className:"bg-slate-50 text-slate-600",children:r.jsxs("tr",{children:[r.jsx(zn,{children:"Time"}),r.jsx(zn,{children:"HR"}),r.jsx(zn,{children:"BP"}),r.jsx(zn,{children:"SpO"}),r.jsx(zn,{children:"RR"}),r.jsx(zn,{children:"Temp"}),r.jsx(zn,{children:"ETCO"}),r.jsx(zn,{children:"Vent"}),r.jsx(zn,{children:"Peak P"}),r.jsx(zn,{children:"CVP/PCWP"}),r.jsx(zn,{children:"Urine"}),r.jsx(zn,{children:"Blood loss"}),r.jsx(zn,{children:"Comments"}),r.jsx(zn,{})]})}),r.jsx("tbody",{children:w.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:14,className:"py-3 text-center text-slate-500",children:"No vitals logged yet."})}):w.map(X=>r.jsxs("tr",{className:"border-t",children:[r.jsx(Un,{children:X.time}),r.jsx(Un,{children:X.hr}),r.jsx(Un,{children:X.bp}),r.jsx(Un,{children:X.spo2}),r.jsx(Un,{children:X.rr}),r.jsx(Un,{children:X.temp_c}),r.jsx(Un,{children:X.etco2}),r.jsx(Un,{children:X.ventilation_mode}),r.jsx(Un,{children:X.peak_airway_pressure}),r.jsx(Un,{children:X.cvp_pcwp}),r.jsx(Un,{children:X.urine_output_ml}),r.jsx(Un,{children:X.blood_loss_ml}),r.jsx(Un,{children:X.comments}),r.jsx(Un,{children:r.jsx("button",{onClick:()=>re(X.id),className:"text-xs font-semibold text-red-500 hover:underline",children:"Delete"})})]},X.id))})]})})]}),ge=()=>r.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 text-[12px] shadow-sm",children:[r.jsxs("h3",{className:"mb-2 flex items-center gap-2 text-sm font-semibold text-slate-900",children:[r.jsx(B4,{className:"h-4 w-4"}),"Anaesthesia drug log"]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-5",children:[r.jsx(It,{label:"Time (HH:MM)",value:D.time,onChange:X=>I(de=>({...de,time:X}))}),r.jsx(It,{label:"Drug name",value:D.drug_name,onChange:X=>I(de=>({...de,drug_name:X}))}),r.jsx(It,{label:"Dose",value:D.dose,onChange:X=>I(de=>({...de,dose:X}))}),r.jsx(It,{label:"Route",value:D.route,onChange:X=>I(de=>({...de,route:X}))}),r.jsx(It,{label:"Remarks",value:D.remarks,onChange:X=>I(de=>({...de,remarks:X}))})]}),r.jsx("button",{type:"button",onClick:ye,disabled:M,className:"inline-flex items-center justify-center rounded-full bg-slate-900 px-4 py-2 text-[12px] font-semibold text-white shadow hover:bg-slate-800 disabled:cursor-not-allowed disabled:opacity-60",children:M?"Adding":"Add drug"}),r.jsx("div",{className:"mt-3 overflow-x-auto",children:r.jsxs("table",{className:"min-w-full text-[11px]",children:[r.jsx("thead",{className:"bg-slate-50 text-slate-600",children:r.jsxs("tr",{children:[r.jsx(zn,{children:"Time"}),r.jsx(zn,{children:"Drug"}),r.jsx(zn,{children:"Dose"}),r.jsx(zn,{children:"Route"}),r.jsx(zn,{children:"Remarks"}),r.jsx(zn,{})]})}),r.jsx("tbody",{children:P.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"py-3 text-center text-slate-500",children:"No drugs logged yet."})}):P.map(X=>r.jsxs("tr",{className:"border-t",children:[r.jsx(Un,{children:X.time}),r.jsx(Un,{children:X.drug_name}),r.jsx(Un,{children:X.dose}),r.jsx(Un,{children:X.route}),r.jsx(Un,{children:X.remarks}),r.jsx(Un,{children:r.jsx("button",{onClick:()=>Ee(X.id),className:"text-xs font-semibold text-red-500 hover:underline",children:"Delete"})})]},X.id))})]})})]});return c?r.jsx("div",{className:"rounded-2xl border bg-white p-6 text-sm text-slate-600",children:"Loading anaesthesia record"}):r.jsxs("div",{className:"space-y-4 text-[13px]",children:[L,r.jsxs("div",{className:"flex flex-wrap items-center gap-2 rounded-full bg-slate-100 p-1 text-[12px]",children:[r.jsxs("div",{className:"flex flex-1 flex-wrap gap-1 overflow-x-auto",children:[r.jsx($g,{active:s==="preop",onClick:()=>n("preop"),icon:yr,children:"Pre-op record"}),r.jsx($g,{active:s==="intra",onClick:()=>n("intra"),icon:_se,children:"Intra-op setup"}),r.jsx($g,{active:s==="vitals",onClick:()=>n("vitals"),icon:Vs,children:"Vitals log"}),r.jsx($g,{active:s==="drugs",onClick:()=>n("drugs"),icon:B4,children:"Drug log"})]}),r.jsx("div",{className:"ml-auto flex items-center text-[11px] font-medium text-slate-500",children:l.id?"Record created":"No record yet"})]}),s==="preop"&&ee(),s==="intra"&&te(),s==="vitals"&&ce(),s==="drugs"&&ge(),r.jsx("div",{className:"sticky bottom-0 mt-4 flex justify-end border-t bg-slate-50/90 px-2 py-3 backdrop-blur",children:r.jsx("button",{type:"button",onClick:q,disabled:u,className:"inline-flex items-center rounded-full bg-slate-900 px-5 py-2 text-[13px] font-semibold text-white shadow-md hover:bg-slate-800 disabled:cursor-not-allowed disabled:opacity-60",children:u?"Saving":"Save anaesthesia record"})})]})}function $g({active:t,onClick:s,children:n,icon:a}){return r.jsxs("button",{type:"button",onClick:s,className:"inline-flex items-center gap-1.5 rounded-full px-3 py-1.5 text-[12px] font-medium transition "+(t?"bg-white text-slate-900 shadow-sm":"text-slate-600 hover:bg-white/70"),children:[a&&r.jsx(a,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:n})]})}function It({label:t,value:s,onChange:n,placeholder:a}){return r.jsxs("label",{className:"flex flex-col gap-1",children:[r.jsx("span",{className:"text-[11px] font-semibold text-slate-600",children:t}),r.jsx("input",{className:"h-9 rounded-md border border-slate-200 bg-slate-50 px-3 text-[12px] text-slate-900 outline-none ring-0 transition focus:border-slate-400 focus:bg-white",value:s??"",placeholder:a,onChange:i=>n(i.target.value)})]})}function zg({label:t,value:s,onChange:n,placeholder:a}){return r.jsxs("label",{className:"flex flex-col gap-1",children:[r.jsx("span",{className:"text-[11px] font-semibold text-slate-600",children:t}),r.jsx("textarea",{className:"min-h-[70px] rounded-md border border-slate-200 bg-slate-50 px-3 py-2 text-[12px] text-slate-900 outline-none ring-0 transition focus:border-slate-400 focus:bg-white",value:s??"",placeholder:a,onChange:i=>n(i.target.value)})]})}function Qa({label:t,checked:s,onChange:n}){return r.jsxs("label",{className:"inline-flex items-center gap-1.5 text-[11px] text-slate-700",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-slate-900 focus:ring-0",checked:!!s,onChange:n}),r.jsx("span",{children:t})]})}function Ul({label:t,value:s,onChange:n,options:a}){return r.jsxs("label",{className:"flex flex-col gap-1",children:[r.jsx("span",{className:"text-[11px] font-semibold text-slate-600",children:t}),r.jsx("select",{className:"h-9 rounded-md border border-slate-200 bg-slate-50 px-3 text-[12px] text-slate-900 outline-none ring-0 transition focus:border-slate-400 focus:bg-white",value:s??"",onChange:i=>n(i.target.value),children:a.map(i=>r.jsx("option",{value:i,children:i||""},i||"empty"))})]})}function zn({children:t}){return r.jsx("th",{className:"px-2 py-1 text-left text-[11px] font-semibold uppercase tracking-wide",children:t})}function Un({children:t}){return r.jsx("td",{className:"px-2 py-1 align-top text-[11px] text-slate-700",children:t})}function A9e({caseId:t}){const s=nt("ot.case.view")||nt("ot.operation_notes.view"),n=nt("ot.operation_notes.manage")||nt("ot.case.update"),[a,i]=y.useState(null),[l,o]=y.useState(!1),[c,d]=y.useState(!1),[u,h]=y.useState(null),[f,x]=y.useState({diagnosis_pre:"",diagnosis_post:"",procedure_performed:"",findings:"",steps:"",complications:"",drains:"",blood_loss_ml:"",post_op_orders:""}),b=async()=>{var _;if(s)try{o(!0),h(null);const S=await Ipe(t);if(S.data){const k=S.data;i(k),x({diagnosis_pre:k.preop_diagnosis||"",diagnosis_post:k.postop_diagnosis||"",procedure_performed:k.indication||"",findings:k.findings||"",steps:k.procedure_steps||"",complications:k.complications||"",drains:k.drains_details||"",blood_loss_ml:k.blood_loss_ml??"",post_op_orders:k.postop_instructions||""})}else i(null)}catch(S){((_=S==null?void 0:S.response)==null?void 0:_.status)===404?i(null):(console.error("Failed to load Operation note",S),h("Failed to load Operation note"))}finally{o(!1)}};if(y.useEffect(()=>{b()},[t,s]),!s)return r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view Operation notes."});const v=(_,S)=>{x(k=>({...k,[_]:S}))},w=async _=>{var S,k;if(_.preventDefault(),!!n){d(!0),h(null);try{const A={surgeon_user_id:null,preop_diagnosis:f.diagnosis_pre||null,postop_diagnosis:f.diagnosis_post||null,indication:f.procedure_performed||null,findings:f.findings||null,procedure_steps:f.steps||null,blood_loss_ml:f.blood_loss_ml===""?null:Number(f.blood_loss_ml),complications:f.complications||null,drains_details:f.drains||null,postop_instructions:f.post_op_orders||null};a?await Dpe(t,A):await Mpe(t,A),await b()}catch(A){console.error("Failed to save Operation note",A);const T=((k=(S=A==null?void 0:A.response)==null?void 0:S.data)==null?void 0:k.detail)||(A==null?void 0:A.message)||"Failed to save Operation note";h(T)}finally{d(!1)}}};return r.jsxs("form",{onSubmit:w,className:"space-y-3 rounded-2xl border bg-white px-4 py-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sky-800",children:[r.jsx(gl,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-semibold",children:"Operation notes"})]}),a&&r.jsxs("span",{className:"rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] text-emerald-700",children:["Last updated: ",(a==null?void 0:a.updated_at)||(a==null?void 0:a.created_at)||""]})]}),l&&r.jsx("div",{className:"text-xs text-slate-500",children:"Loading Operation notes..."}),u&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:u}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Pre-op diagnosis"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.diagnosis_pre,disabled:!n,onChange:_=>v("diagnosis_pre",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Post-op diagnosis"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.diagnosis_post,disabled:!n,onChange:_=>v("diagnosis_post",_.target.value)})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Procedure performed / indication"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.procedure_performed,disabled:!n,onChange:_=>v("procedure_performed",_.target.value)})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Findings"}),r.jsx("textarea",{rows:3,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.findings,disabled:!n,onChange:_=>v("findings",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Steps / technique"}),r.jsx("textarea",{rows:3,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.steps,disabled:!n,onChange:_=>v("steps",_.target.value)})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Complications"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.complications,disabled:!n,onChange:_=>v("complications",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Drains / tubes"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.drains,disabled:!n,onChange:_=>v("drains",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Approx. blood loss (ml)"}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.blood_loss_ml,disabled:!n,onChange:_=>v("blood_loss_ml",_.target.value)})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Immediate post-op orders"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.post_op_orders,disabled:!n,onChange:_=>v("post_op_orders",_.target.value)})]}),n&&r.jsx("div",{className:"flex justify-end",children:r.jsxs("button",{type:"submit",disabled:c,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[c&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save Operation note"]})})]})}function S6(t){if(!t)return"";if(/^\d{2}:\d{2}$/.test(t))return t;const s=new Date(t);return isNaN(s.getTime())?"":s.toISOString().slice(11,16)}function E9e({caseId:t}){const s=nt("ot.cases.view")||nt("ot.pacu.view"),n=nt("ot.pacu.manage")||nt("ot.case.update"),[a,i]=y.useState(null),[l,o]=y.useState(!1),[c,d]=y.useState(!1),[u,h]=y.useState(null),[f,x]=y.useState({arrival_time:"",departure_time:"",pain_score:"",nausea_vomiting:"",airway_status:"",vitals_summary:"",complications:"",discharge_criteria_met:!1,notes:""}),b=async()=>{var _;if(s)try{o(!0),h(null);const S=await Bpe(t);if(S.data){const k=S.data;i(k),x({arrival_time:S6(k.arrival_time),departure_time:S6(k.departure_time),pain_score:k.pain_score||"",nausea_vomiting:k.nausea_vomiting||"",airway_status:k.airway_status||"",vitals_summary:k.vitals_summary||"",complications:k.complications||"",discharge_criteria_met:!!k.discharge_criteria_met,notes:k.notes||""})}else i(null)}catch(S){((_=S==null?void 0:S.response)==null?void 0:_.status)===404?i(null):(console.error("Failed to load PACU record",S),h("Failed to load PACU record"))}finally{o(!1)}};if(y.useEffect(()=>{b()},[t,s]),!s)return r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view PACU records."});const v=(_,S)=>{x(k=>({...k,[_]:S}))},w=async _=>{var S,k;if(_.preventDefault(),!!n){d(!0),h(null);try{const A={arrival_time:f.arrival_time||null,departure_time:f.departure_time||null,pain_score:f.pain_score||null,nausea_vomiting:f.nausea_vomiting||null,airway_status:f.airway_status||null,vitals_summary:f.vitals_summary||null,complications:f.complications||null,discharge_criteria_met:!!f.discharge_criteria_met,notes:f.notes||null};a?await $pe(t,A):await Fpe(t,A),await b()}catch(A){console.error("Failed to save PACU record",A);let T="Failed to save PACU record";const P=(k=(S=A==null?void 0:A.response)==null?void 0:S.data)==null?void 0:k.detail;Array.isArray(P)?T=P.map(O=>O.msg).join(", "):typeof P=="string"?T=P:A!=null&&A.message&&(T=A.message),h(T)}finally{d(!1)}}};return r.jsxs("form",{onSubmit:w,className:"space-y-3 rounded-2xl border bg-white px-4 py-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sky-800",children:[r.jsx(kn,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-semibold",children:"PACU / Post-anaesthesia recovery"})]}),a&&r.jsxs("span",{className:"rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] text-emerald-700",children:["Last updated: ",(a==null?void 0:a.updated_at)||(a==null?void 0:a.created_at)||""]})]}),l&&r.jsx("div",{className:"text-xs text-slate-500",children:"Loading PACU record..."}),u&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:u}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Arrival time"}),r.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:f.arrival_time,disabled:!n,onChange:_=>v("arrival_time",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Departure time"}),r.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:f.departure_time,disabled:!n,onChange:_=>v("departure_time",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Pain score"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",placeholder:"e.g., 3/10",value:f.pain_score,disabled:!n,onChange:_=>v("pain_score",_.target.value)})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Nausea / vomiting"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:f.nausea_vomiting,disabled:!n,onChange:_=>v("nausea_vomiting",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Airway status"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:f.airway_status,disabled:!n,onChange:_=>v("airway_status",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Vitals summary"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:f.vitals_summary,disabled:!n,onChange:_=>v("vitals_summary",_.target.value)})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"PACU complications"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:f.complications,disabled:!n,onChange:_=>v("complications",_.target.value)})]}),r.jsxs("label",{className:"flex cursor-pointer items-center gap-2 rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-800 hover:border-sky-400",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!f.discharge_criteria_met,disabled:!n,onChange:_=>v("discharge_criteria_met",_.target.checked)}),r.jsx("span",{children:"PACU discharge criteria met; patient shifted as per orders"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Notes"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:f.notes,disabled:!n,onChange:_=>v("notes",_.target.value)})]}),n&&r.jsx("div",{className:"flex justify-end",children:r.jsxs("button",{type:"submit",disabled:c,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[c&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save PACU record"]})})]})}function T9e(t){if(!t)return"";if(/^\d{2}:\d{2}$/.test(t))return t;const s=new Date(t);return isNaN(s.getTime())?"":s.toISOString().slice(11,16)}function P9e({caseId:t}){const s=nt("ot.case.view")||nt("ot.nursing.view"),n=nt("ot.nursing.manage")||nt("ot.case.update"),[a,i]=y.useState(null),[l,o]=y.useState(!1),[c,d]=y.useState(!1),[u,h]=y.useState(null),[f,x]=y.useState({scrub_nurse_name:"",circulating_nurse_name:"",positioning:"",skin_prep:"",catheterisation:"",diathermy_plate_site:"",counts_initial_done:!1,counts_closure_done:!1,antibiotics_time:"",warming_measures:"",notes:""}),b=async()=>{var _;if(s)try{o(!0),h(null);const S=await kpe(t);if(S.data){const k=S.data;i(k),x({scrub_nurse_name:k.scrub_nurse_name||"",circulating_nurse_name:k.circulating_nurse_name||"",positioning:k.positioning||"",skin_prep:k.skin_prep||"",catheterisation:k.catheterisation||"",diathermy_plate_site:k.diathermy_plate_site||"",counts_initial_done:!!k.counts_initial_done,counts_closure_done:!!k.counts_closure_done,antibiotics_time:T9e(k.antibiotics_time),warming_measures:k.warming_measures||"",notes:k.notes||""})}else i(null)}catch(S){((_=S==null?void 0:S.response)==null?void 0:_.status)===404?i(null):(console.error("Failed to load intra-op nursing record",S),h("Failed to load intra-op nursing record"))}finally{o(!1)}};if(y.useEffect(()=>{b()},[t,s]),!s)return r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view intra-op nursing records."});const v=(_,S)=>{x(k=>({...k,[_]:S}))},w=async _=>{var k,A,T,P,O;if(_.preventDefault(),!n)return;d(!0),h(null);const S={primary_nurse_id:null,scrub_nurse_name:f.scrub_nurse_name||null,circulating_nurse_name:f.circulating_nurse_name||null,positioning:f.positioning||null,skin_prep:f.skin_prep||null,catheterisation:f.catheterisation||null,diathermy_plate_site:f.diathermy_plate_site||null,counts_initial_done:!!f.counts_initial_done,counts_closure_done:!!f.counts_closure_done,antibiotics_time:f.antibiotics_time||null,warming_measures:f.warming_measures||null,notes:f.notes||null};try{if(a)await _I(t,S);else try{await Ape(t,S)}catch(D){const I=(k=D==null?void 0:D.response)==null?void 0:k.status,M=(T=(A=D==null?void 0:D.response)==null?void 0:A.data)==null?void 0:T.detail;if(I===400&&typeof M=="string"&&M.toLowerCase().includes("already exists"))await _I(t,S);else throw D}await b()}catch(D){console.error("Failed to save intra-op nursing record",D);const I=((O=(P=D==null?void 0:D.response)==null?void 0:P.data)==null?void 0:O.detail)||(D==null?void 0:D.message)||"Failed to save intra-op nursing record";h(I)}finally{d(!1)}};return r.jsxs("form",{onSubmit:w,className:"space-y-3 rounded-2xl border bg-white px-4 py-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sky-800",children:[r.jsx(yr,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-semibold",children:"Intra-op nursing record"})]}),r.jsx("div",{className:"flex items-center gap-2",children:a&&r.jsxs("span",{className:"rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] text-emerald-700",children:["Last updated: ",(a==null?void 0:a.updated_at)||(a==null?void 0:a.created_at)||""]})})]}),l&&r.jsx("div",{className:"text-xs text-slate-500",children:"Loading intra-op nursing record..."}),u&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:u}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Scrub nurse"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.scrub_nurse_name,disabled:!n,onChange:_=>v("scrub_nurse_name",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Circulating nurse"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.circulating_nurse_name,disabled:!n,onChange:_=>v("circulating_nurse_name",_.target.value)})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Patient positioning"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.positioning,disabled:!n,onChange:_=>v("positioning",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Skin preparation"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.skin_prep,disabled:!n,onChange:_=>v("skin_prep",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Catheterisation"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.catheterisation,disabled:!n,onChange:_=>v("catheterisation",_.target.value)})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Diathermy plate site"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.diathermy_plate_site,disabled:!n,onChange:_=>v("diathermy_plate_site",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Prophylactic antibiotics time"}),r.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.antibiotics_time,disabled:!n,onChange:_=>v("antibiotics_time",_.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Warming measures"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.warming_measures,disabled:!n,onChange:_=>v("warming_measures",_.target.value)})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[r.jsxs("label",{className:"flex cursor-pointer items-center gap-2 rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!f.counts_initial_done,disabled:!n,onChange:_=>v("counts_initial_done",_.target.checked)}),r.jsx("span",{children:"Initial sponge / instrument counts completed"})]}),r.jsxs("label",{className:"flex cursor-pointer items-center gap-2 rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!f.counts_closure_done,disabled:!n,onChange:_=>v("counts_closure_done",_.target.checked)}),r.jsx("span",{children:"Final counts completed at closure"})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Notes"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.notes,disabled:!n,onChange:_=>v("notes",_.target.value)})]}),n&&r.jsx("div",{className:"flex justify-end",children:r.jsxs("button",{type:"submit",disabled:c,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[c&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save intra-op nursing record"]})})]})}function I9e({caseId:t}){const s=nt("ot.case.view")||nt("ot.counts.view"),n=nt("ot.counts.manage")||nt("ot.case.update"),[a,i]=y.useState(null),[l,o]=y.useState(!1),[c,d]=y.useState(!1),[u,h]=y.useState(null),[f,x]=y.useState({sponges_initial:"",sponges_added:"",sponges_final:"",instruments_initial:"",instruments_final:"",needles_initial:"",needles_final:"",discrepancy_text:"",xray_done:!1,resolved_by:"",notes:""}),b=A=>A===""||A===null||A===void 0?null:Number(A),v=async()=>{var A;if(s)try{o(!0),h(null);const P=(await Epe(t)).data;console.log("Counts record API data:",P),i(P),x({sponges_initial:P.sponges_initial??"",sponges_added:P.sponges_added??"",sponges_final:P.sponges_final??"",instruments_initial:P.instruments_initial??"",instruments_final:P.instruments_final??"",needles_initial:P.needles_initial??"",needles_final:P.needles_final??"",discrepancy_text:P.discrepancy_text||"",xray_done:!!P.xray_done,resolved_by:P.resolved_by||"",notes:P.notes||""})}catch(T){((A=T==null?void 0:T.response)==null?void 0:A.status)===404?(i(null),x(P=>({...P,sponges_initial:"",sponges_added:"",sponges_final:"",instruments_initial:"",instruments_final:"",needles_initial:"",needles_final:"",discrepancy_text:"",xray_done:!1,resolved_by:"",notes:""}))):(console.error("Failed to load counts record",T),h("Failed to load counts record"))}finally{o(!1)}};y.useEffect(()=>{i(null),v()},[t,s]);const w=(A,T)=>{x(P=>({...P,[A]:T}))},_=()=>({sponges_initial:b(f.sponges_initial),sponges_added:b(f.sponges_added),sponges_final:b(f.sponges_final),instruments_initial:b(f.instruments_initial),instruments_final:b(f.instruments_final),needles_initial:b(f.needles_initial),needles_final:b(f.needles_final),discrepancy_text:f.discrepancy_text||null,xray_done:!!f.xray_done,resolved_by:f.resolved_by||null,notes:f.notes||null}),S=async A=>{var P,O;if(A.preventDefault(),!n)return;d(!0),h(null);const T=_();try{if(a!=null&&a.id)await Ppe(t,T);else{const D=await Tpe(t,T);i(D.data)}await v()}catch(D){console.error("Failed to save counts record",D);const I=((O=(P=D==null?void 0:D.response)==null?void 0:P.data)==null?void 0:O.detail)||(D==null?void 0:D.message)||"Failed to save counts record";h(I)}finally{d(!1)}},k=(A,T)=>r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:T}),r.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f[A],disabled:!n,onChange:P=>w(A,P.target.value)})]},A);return r.jsxs("form",{onSubmit:S,className:"space-y-3 rounded-2xl border bg-white px-4 py-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sky-800",children:[r.jsx(za,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-semibold",children:"Sponge / instrument / needle count"})]}),a&&r.jsxs("span",{className:"rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] text-emerald-700",children:["Last updated: ",(a==null?void 0:a.updated_at)||(a==null?void 0:a.created_at)||""]})]}),l&&r.jsx("div",{className:"text-xs text-slate-500",children:"Loading counts record..."}),u&&r.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:u}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[k("sponges_initial","Sponges - initial"),k("sponges_added","Sponges - added during case"),k("sponges_final","Sponges - final count")]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[k("instruments_initial","Instruments - initial"),k("instruments_final","Instruments - final")]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[k("needles_initial","Needles - initial"),k("needles_final","Needles - final")]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Discrepancy (if any)"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.discrepancy_text,disabled:!n,onChange:A=>w("discrepancy_text",A.target.value)})]}),r.jsxs("label",{className:"flex cursor-pointer items-center gap-2 rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!f.xray_done,disabled:!n,onChange:A=>w("xray_done",A.target.checked)}),r.jsx("span",{children:"Intra-op / post-op X-ray done for suspected retained item"})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Discrepancy resolved by"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.resolved_by,disabled:!n,onChange:A=>w("resolved_by",A.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Notes / corrective action"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.notes,disabled:!n,onChange:A=>w("notes",A.target.value)})]})]}),n&&r.jsx("div",{className:"flex justify-end",children:r.jsxs("button",{type:"submit",disabled:c,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[c&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save counts record"]})})]})}function M9e({caseId:t}){const s=nt("ot.case.view")||nt("ot.blood_transfusion.view"),n=nt("ot.blood_transfusion.manage")||nt("ot.case.update"),[a,i]=y.useState([]),[l,o]=y.useState(!1),[c,d]=y.useState(null),[u,h]=y.useState(!1),[f,x]=y.useState({component:"",units:"1",blood_group:"",bag_no:"",start_time:"",end_time:"",reaction:"",reaction_action:"",notes:""}),b=async()=>{if(s)try{o(!0),d(null);const S=await Ope(t);console.log("Blood transfusion API data:",S.data),i(S.data||[])}catch(S){console.error("Failed to load blood transfusions",S),d("Failed to load blood transfusion records")}finally{o(!1)}};if(y.useEffect(()=>{b()},[t,s]),!s)return r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view OT blood transfusions."});const v=(S,k)=>{x(A=>({...A,[S]:k}))},w=async S=>{var k,A;if(S.preventDefault(),!!n){h(!0);try{const T={component:f.component||null,units:f.units===""?null:Number(f.units||1),start_time:null,end_time:null,reaction:f.reaction||null,notes:f.notes||null};await Rpe(t,T),x({component:"",units:"1",blood_group:"",bag_no:"",start_time:"",end_time:"",reaction:"",reaction_action:"",notes:""}),await b()}catch(T){console.error("Failed to add transfusion",T),alert(((A=(k=T==null?void 0:T.response)==null?void 0:k.data)==null?void 0:A.detail)||"Failed to add transfusion entry")}finally{h(!1)}}},_=async S=>{if(n&&window.confirm("Delete this transfusion record?"))try{await Lpe(S),await b()}catch(k){console.error("Failed to delete transfusion",k),alert("Failed to delete transfusion entry")}};return r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"rounded-2xl border bg-white px-4 py-3 text-xs",children:[r.jsx("div",{className:"mb-2 flex items-center justify-between gap-2",children:r.jsxs("div",{className:"flex items-center gap-2 text-slate-800",children:[r.jsx(T_,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-semibold",children:"OT blood transfusion record"})]})}),l&&r.jsx("div",{className:"text-xs text-slate-500",children:"Loading transfusion records..."}),c&&r.jsx("div",{className:"mb-2 rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:c}),r.jsx("div",{className:"max-h-64 overflow-auto rounded-xl border bg-slate-50",children:r.jsxs("table",{className:"min-w-full text-left text-[11px] text-slate-700",children:[r.jsx("thead",{className:"bg-slate-100",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-1.5",children:"Component"}),r.jsx("th",{className:"px-3 py-1.5",children:"Units"}),r.jsx("th",{className:"px-3 py-1.5",children:"Start"}),r.jsx("th",{className:"px-3 py-1.5",children:"End"}),r.jsx("th",{className:"px-3 py-1.5",children:"Reaction"}),r.jsx("th",{className:"px-3 py-1.5 text-right",children:"Actions"})]})}),r.jsxs("tbody",{children:[!l&&a.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-3 py-2 text-center text-[11px] text-slate-500",children:"No transfusions recorded for this case."})}),!l&&a.map(S=>r.jsxs("tr",{className:"border-t border-slate-100",children:[r.jsx("td",{className:"px-3 py-1.5",children:S.component||""}),r.jsx("td",{className:"px-3 py-1.5",children:S.units??""}),r.jsx("td",{className:"px-3 py-1.5",children:S.start_time||""}),r.jsx("td",{className:"px-3 py-1.5",children:S.end_time||""}),r.jsx("td",{className:"px-3 py-1.5",children:S.reaction||"None"}),r.jsx("td",{className:"px-3 py-1.5 text-right",children:n&&r.jsxs("button",{type:"button",onClick:()=>_(S.id),className:"inline-flex items-center gap-1 rounded-lg border border-rose-200 bg-white px-2 py-0.5 text-[10px] text-rose-600 hover:bg-rose-50",children:[r.jsx(wr,{className:"h-3 w-3"}),"Delete"]})})]},S.id))]})]})})]}),n&&r.jsxs("form",{onSubmit:w,className:"space-y-2 rounded-2xl border bg-white px-4 py-3 text-xs",children:[r.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:"Add transfusion entry"}),r.jsxs("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Component"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.component,onChange:S=>v("component",S.target.value),placeholder:"PRBC / FFP / Platelets...",required:!0})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Units"}),r.jsx("input",{type:"number",min:"1",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.units,onChange:S=>v("units",S.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Blood group"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.blood_group,onChange:S=>v("blood_group",S.target.value),placeholder:"e.g., O+"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Bag number"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.bag_no,onChange:S=>v("bag_no",S.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Start time"}),r.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.start_time,onChange:S=>v("start_time",S.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"End time"}),r.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.end_time,onChange:S=>v("end_time",S.target.value)})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Reaction"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.reaction,onChange:S=>v("reaction",S.target.value),placeholder:"None / chills / rash / etc."})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Action taken"}),r.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.reaction_action,onChange:S=>v("reaction_action",S.target.value)})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Notes"}),r.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:f.notes,onChange:S=>v("notes",S.target.value)})]}),r.jsx("div",{className:"flex justify-end",children:r.jsxs("button",{type:"submit",disabled:u,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[u&&r.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Add transfusion"]})})]})]})}const D9e=[{id:"preop",label:"Pre-op Checklist"},{id:"safety",label:"WHO Safety Checklist"},{id:"anaesthesia",label:"Anaesthesia"},{id:"nursing",label:"Nursing Notes"},{id:"counts",label:"Instrument & Sponge Counts"},{id:"blood",label:"Blood & Fluids"},{id:"notes",label:"Operation Notes"},{id:"pacu",label:"PACU / Recovery"}];function zN(t){if(!t)return null;const s=new Date(t);return Number.isNaN(s.getTime())?null:s}function Cy(t){const s=zN(t);return s?s.toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):""}function RC(t){if(!t)return"";if(typeof t=="string"){const n=t.match(/^(\d{2}):(\d{2})/);if(n)return`${n[1]}:${n[2]}`}const s=zN(t);return s?s.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"}):""}function C6(t){return zN(t)?`${Cy(t)}  ${RC(t)}`:""}function O9e(...t){return t.filter(Boolean).join("  ")}function R9e(t){if(!t)return"";const s=t.prefix||t.title,n=t.first_name||t.given_name,a=t.last_name||t.family_name;return[s,n,a].filter(Boolean).join(" ")||t.full_name||t.display_name||""}function L9e(t){if(!t)return null;const s=t.sex||t.gender||t.sex_label||null;let n=t.age_display||t.age||null;if(!n&&(t.age_years!=null||t.age_months!=null)){const a=t.age_years,i=t.age_months;a!=null&&i!=null?n=`${a}y ${i}m`:a!=null?n=`${a}y`:i!=null&&(n=`${i}m`)}if(!n&&t.dob){const a=zN(t.dob);if(a){const i=new Date;let l=i.getFullYear()-a.getFullYear();const o=i.getMonth()-a.getMonth();(o<0||o===0&&i.getDate()<a.getDate())&&l--,n=`${l}y`}}return n&&s?`${n} / ${s}`:n||s||null}function B9e(){var G,re,ye,Ee,ee;const{caseId:t}=xd(),s=Va(),n=nt("ot.cases.view"),[a,i]=y.useState("preop"),[l,o]=y.useState(null),[c,d]=y.useState(!1),[u,h]=y.useState(null),f=async()=>{var te;if(!(!n||!t))try{d(!0),h(null);const ce=await upe(t);o(ce.data||null)}catch(ce){console.error("Failed to load OT case",ce);const ge=(te=ce==null?void 0:ce.response)==null?void 0:te.status;h(ge===404?"OT case not found. It may have been deleted or the reference is invalid.":ge===403?"You do not have permission to view this OT case.":"Failed to load OT case. Please try again.")}finally{d(!1)}};y.useEffect(()=>{f()},[t,n]);const x=l==null?void 0:l.schedule,b=x==null?void 0:x.patient,v=(x==null?void 0:x.admission)||null,w=(x==null?void 0:x.bed)||null,_=(v==null?void 0:v.current_bed)||null,S=w||_,k=R9e(b),A=L9e(b),T=(x==null?void 0:x.reg_no)||(x==null?void 0:x.display_number)||(x==null?void 0:x.ot_number)||(x==null?void 0:x.schedule_code)||null,P=(b==null?void 0:b.uhid)||(b==null?void 0:b.uhid_number)||(x==null?void 0:x.patient_uhid)||null,O=(v==null?void 0:v.display_code)||(v==null?void 0:v.admission_code)||null,D=(x==null?void 0:x.op_no)||null,I=(v==null?void 0:v.admitted_at)||(v==null?void 0:v.admission_date)||null,M=S?O9e(S.ward_name,S.room_name,S.code):null,B=(l==null?void 0:l.final_procedure_name)||(x==null?void 0:x.procedure_name)||(x==null?void 0:x.primary_procedure_name)||"",L=(G=x==null?void 0:x.additional_procedures)!=null&&G.length?x.additional_procedures.map(te=>te.name||te.procedure_name).filter(Boolean).join(", "):null,F=(x==null?void 0:x.planned_start_time)||(x==null?void 0:x.planned_start)||null,V=(x==null?void 0:x.planned_end_time)||(x==null?void 0:x.planned_end)||null,$=l==null?void 0:l.actual_start_time,z=l==null?void 0:l.actual_end_time,H=(x==null?void 0:x.date)||F||V||null,q=y.useMemo(()=>{if(!l)return null;const te=(x==null?void 0:x.status)||(l.outcome?"closed":"open"),ce=String(te).toLowerCase(),ge={planned:"bg-slate-100 text-slate-700",in_progress:"bg-sky-50 text-sky-700",completed:"bg-emerald-50 text-emerald-700",cancelled:"bg-rose-50 text-rose-700",open:"bg-emerald-50 text-emerald-700",closed:"bg-slate-100 text-slate-700"};return r.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2.5 py-0.5 text-[11px] font-medium ${ge[ce]||"bg-slate-100 text-slate-700"}`,children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-current opacity-70"}),String(te).toUpperCase()]})},[l,x]);return n?r.jsxs("div",{className:"flex h-full flex-col gap-3 p-4",children:[r.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("button",{type:"button",onClick:()=>s(-1),className:"inline-flex h-8 w-8 items-center justify-center rounded-full border border-slate-200 bg-white text-slate-600 shadow-sm hover:border-sky-400 hover:text-sky-700",children:r.jsx(Qb,{className:"h-4 w-4"})}),r.jsxs("div",{children:[r.jsxs("div",{className:"mb-0.5 flex flex-wrap items-center gap-2",children:[r.jsx("h1",{className:"text-base font-semibold text-slate-900",children:"OT Case"}),q,T&&r.jsxs("span",{className:"inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2 py-0.5 text-[11px] font-medium text-slate-700",children:[r.jsx(qp,{className:"mr-1 h-3 w-3"}),"OT Reg No: ",T]})]}),r.jsx("p",{className:"text-xs text-slate-500",children:"All OT documentation, checklists and notes for this procedure are linked to this case as per NABH OT standards."})]})]}),r.jsx("div",{className:"flex flex-col items-end gap-1 text-right",children:H&&r.jsxs("div",{className:"inline-flex items-center gap-1.5 rounded-full bg-slate-900 px-3 py-1 text-[11px] font-medium text-slate-50",children:[r.jsx(ar,{className:"h-3.5 w-3.5"}),"OT Date: ",Cy(H)]})})]}),u&&r.jsx("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-2 text-xs text-rose-700",children:u}),r.jsxs("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-4",children:[r.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-white p-4 text-xs shadow-sm",children:[r.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[r.jsx("div",{className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-sky-50 text-sky-700",children:r.jsx(rn,{className:"h-4 w-4"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:"Patient"}),r.jsx("div",{className:"text-sm font-semibold text-slate-900",children:k})]})]}),r.jsxs("dl",{className:"space-y-1.5",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[r.jsx(qp,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:"UHID"})]}),r.jsx("dd",{className:"text-[11px] font-medium text-slate-900",children:P||""})]}),r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[r.jsx(cm,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:"Age / Sex"})]}),r.jsx("dd",{className:"text-[11px] text-slate-900",children:A||""})]})]})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-white p-4 text-xs shadow-sm",children:[r.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[r.jsx("div",{className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-emerald-50 text-emerald-700",children:r.jsx(kn,{className:"h-4 w-4"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:"Admission / Visit"}),r.jsx("div",{className:"text-[11px] text-slate-500",children:"IP or OP details (if available)"})]})]}),r.jsxs("dl",{className:"space-y-1.5",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[r.jsx(yr,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:"IP No"})]}),r.jsx("dd",{className:"text-[11px] font-medium text-slate-900",children:O||""})]}),r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[r.jsx(yr,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:"OP No"})]}),r.jsx("dd",{className:"text-[11px] font-medium text-slate-900",children:D||""})]}),r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[r.jsx(ar,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:"Date of Admission"})]}),r.jsx("dd",{className:"text-[11px] text-slate-900",children:I?Cy(I):""})]}),r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[r.jsx(kn,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:"Bed Details"})]}),r.jsx("dd",{className:"text-[11px] text-right text-slate-900",children:M||""})]})]})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-white p-4 text-xs shadow-sm",children:[r.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[r.jsx("div",{className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-indigo-50 text-indigo-700",children:r.jsx(Es,{className:"h-4 w-4"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:"Procedure & Team"}),r.jsx("div",{className:"text-sm font-semibold text-slate-900",children:B})]})]}),L&&r.jsxs("div",{className:"mb-1 text-[11px] text-slate-500",children:["Additional: ",L]}),r.jsxs("dl",{className:"space-y-1.5",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[r.jsx(Es,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:"Surgeon"})]}),r.jsxs("dd",{className:"text-[11px] text-right text-slate-900",children:["Dr. ",((re=x==null?void 0:x.surgeon)==null?void 0:re.full_name)||((ye=x==null?void 0:x.surgeon)==null?void 0:ye.name)||(x==null?void 0:x.surgeon_name)||(x!=null&&x.surgeon_user_id?`Doctor #${x.surgeon_user_id}`:"")]})]}),r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[r.jsx(cm,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:"Anaesthetist"})]}),r.jsxs("dd",{className:"text-[11px] text-right text-slate-900",children:["Dr. ",((Ee=x==null?void 0:x.anaesthetist)==null?void 0:Ee.full_name)||((ee=x==null?void 0:x.anaesthetist)==null?void 0:ee.name)||(x==null?void 0:x.anaesthetist_name)||(x!=null&&x.anaesthetist_user_id?`Doctor #${x.anaesthetist_user_id}`:"")]})]})]})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-white p-4 text-xs shadow-sm",children:[r.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[r.jsx("div",{className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-amber-50 text-amber-700",children:r.jsx(lr,{className:"h-4 w-4"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:"Theatre & Timings"}),r.jsx("div",{className:"text-sm font-semibold text-slate-900",children:M||""})]})]}),r.jsxs("dl",{className:"space-y-1.5",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[r.jsx(lr,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:"Planned"})]}),r.jsx("dd",{className:"text-[11px] text-right text-slate-900",children:F||V?r.jsxs(r.Fragment,{children:[H&&r.jsx("span",{className:"block",children:Cy(H)}),r.jsxs("span",{children:[F?RC(F):""," ",""," ",V?RC(V):""]})]}):""})]}),r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[r.jsx(lr,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:"Actual Start"})]}),r.jsx("dd",{className:"text-[11px] text-right text-slate-900",children:$?C6($):""})]}),r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[r.jsx(lr,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:"Actual End"})]}),r.jsx("dd",{className:"text-[11px] text-right text-slate-900",children:z?C6(z):""})]})]})]})]}),r.jsx("div",{className:"mt-1 flex gap-2 border-b border-slate-200 pt-1",children:D9e.map(te=>{const ce=te.id===a;return r.jsxs("button",{type:"button",onClick:()=>i(te.id),className:`relative px-3 py-1.5 text-xs font-medium transition-colors ${ce?"text-sky-700":"text-slate-500 hover:text-slate-800"}`,children:[te.label,ce&&r.jsx("span",{className:"absolute inset-x-0 bottom-0 h-0.5 rounded-full bg-sky-600"})]},te.id)})}),r.jsxs("div",{className:"flex-1 overflow-auto pt-2 pb-4",children:[c&&!l&&r.jsx("div",{className:"rounded-2xl border bg-white px-4 py-4 text-xs text-slate-500",children:"Loading OT case..."}),!c&&!l&&!u&&r.jsx("div",{className:"rounded-2xl border bg-white px-4 py-4 text-xs text-slate-500",children:"OT case not loaded."}),l&&r.jsxs("div",{className:"space-y-3",children:[a==="preop"&&r.jsx(j9e,{caseId:t}),a==="safety"&&r.jsx(C9e,{caseId:t}),a==="anaesthesia"&&r.jsx(k9e,{caseId:t}),a==="nursing"&&r.jsx(P9e,{caseId:t}),a==="counts"&&r.jsx(I9e,{caseId:t}),a==="blood"&&r.jsx(M9e,{caseId:t}),a==="notes"&&r.jsx(A9e,{caseId:t}),a==="pacu"&&r.jsx(E9e,{caseId:t})]})]})]}):r.jsx("div",{className:"p-4",children:r.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-sm text-amber-800",children:"You do not have permission to view OT cases."})})}function F9e({kind:t="success",title:s,message:n,onClose:a}){const i={success:{bg:"bg-emerald-50",border:"border-emerald-200",text:"text-emerald-900",icon:r.jsx(Dn,{className:"w-4 h-4 text-emerald-600"})},error:{bg:"bg-red-50",border:"border-red-200",text:"text-red-900",icon:r.jsx(Ux,{className:"w-4 h-4 text-red-600"})},info:{bg:"bg-sky-50",border:"border-sky-200",text:"text-sky-900",icon:r.jsx(Vs,{className:"w-4 h-4 text-sky-600"})}},l=i[t]??i.info;return r.jsx("div",{className:"fixed top-4 right-4 z-40",children:r.jsxs("div",{className:`flex items-start gap-3 rounded-xl border shadow-sm px-4 py-3 ${l.bg} ${l.border} ${l.text}`,children:[r.jsx("div",{className:"mt-0.5",children:l.icon}),r.jsxs("div",{className:"space-y-0.5",children:[s&&r.jsx("div",{className:"font-semibold text-sm",children:s}),n&&r.jsx("div",{className:"text-xs leading-snug text-slate-700",children:n})]}),r.jsx("button",{onClick:a,className:"ml-2 text-xs text-slate-500 hover:text-slate-700",children:""})]})})}function k6({status:t}){const n={staging:{label:"Staging",className:"bg-amber-50 text-amber-800 border border-amber-200 dark:bg-amber-950/40 dark:text-amber-200"},mapped:{label:"Mapped",className:"bg-sky-50 text-sky-800 border border-sky-200 dark:bg-sky-950/40 dark:text-sky-200"},posted:{label:"Posted",className:"bg-emerald-50 text-emerald-800 border border-emerald-200 dark:bg-emerald-950/40 dark:text-emerald-200"},error:{label:"Error",className:"bg-red-50 text-red-800 border border-red-200 dark:bg-red-950/40 dark:text-red-200"}}[t]??{label:t||"Unknown",className:"bg-slate-50 text-slate-800 border border-slate-200 dark:bg-slate-900 dark:text-slate-200"};return r.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${n.className}`,children:n.label})}function A6({message:t}){return t?r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-red-50 text-red-700 border border-red-200 px-2 py-0.5 text-[11px] font-medium",title:t,children:[r.jsx(Vte,{className:"w-3 h-3"}),"Error"]}):null}function $9e(){const[t,s]=y.useState([]),[n,a]=y.useState(null),[i,l]=y.useState([]),[o,c]=y.useState("all"),[d,u]=y.useState(""),[h,f]=y.useState(!1),[x,b]=y.useState(!1),[v,w]=y.useState(!1),[_,S]=y.useState(null),[k,A]=y.useState(null),T=nt("lab.results.map"),P=nt("lab.devices.view"),O=y.useCallback(($,z,H)=>{A({kind:$,title:z,message:H}),setTimeout(()=>A(null),3500)},[]);y.useEffect(()=>{if(!P)return;(async()=>{f(!0),S(null);try{const z=await J.get("/api/lis/devices");s(z.data||[]),z.data&&z.data.length>0&&a(z.data[0].id)}catch(z){console.error(z),S("Failed to load devices"),O("error","Load failed","Unable to load analyzer devices.")}finally{f(!1)}})()},[P,O]);const D=y.useCallback(async $=>{if($){b(!0),S(null);try{const z=await J.get(`/api/lis/devices/${$}/results/staging`,{params:{limit:200}});l(z.data||[])}catch(z){console.error(z),S("Failed to load staging results"),O("error","Load failed","Unable to load staging results for this device.")}finally{b(!1)}}},[O]);y.useEffect(()=>{n&&D(n)},[n,D]);const I=y.useMemo(()=>{let $=i||[];o!=="all"&&($=$.filter(H=>H.status===o));const z=d.trim();if(z){const H=z.toLowerCase();$=$.filter(q=>(q.sample_id||"").toLowerCase().includes(H))}return $},[i,o,d]),M=y.useMemo(()=>t.find($=>$.id===n)||null,[t,n]),B=async()=>{if(!(!n||!T)){w(!0);try{await J.post(`/api/lis/mapping/devices/${n}/auto-map`,null,{params:{limit:500}}),O("success","Mapping complete","Auto mapping for this device is completed."),await D(n)}catch($){console.error($),O("error","Mapping failed","Something went wrong while mapping results.")}finally{w(!1)}}},L=async()=>{const $=d.trim();if(!(!$||!T)){w(!0);try{await J.post(`/api/lis/mapping/samples/${encodeURIComponent($)}/auto-map`),O("success","Sample mapped",`Auto mapping completed for sample ${$}.`),n&&await D(n)}catch(z){console.error(z),O("error","Mapping failed","Unable to map this sample. Check if staging rows exist.")}finally{w(!1)}}},F=async $=>{if(T){w(!0);try{const H=(await J.post(`/api/lis/mapping/staging/${$}/map`)).data;l(q=>q.map(G=>G.id===$?H:G)),O("success","Row mapped","Result mapped to lab order.")}catch(z){console.error(z),O("error","Mapping failed","Unable to map this result row. Check logs for details.")}finally{w(!1)}}},V=async()=>{n&&(await D(n),O("info","Refreshed","Staging results reloaded."))};return P?r.jsxs("div",{className:"px-4 py-6 sm:px-6 lg:px-8 space-y-4",children:[k&&r.jsx(F9e,{kind:k.kind,title:k.title,message:k.message,onClose:()=>A(null)}),r.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-sky-50 px-3 py-1 border border-sky-100 text-xs font-semibold text-sky-700",children:[r.jsx(Li,{className:"w-3.5 h-3.5"}),"Analyzer Integration"]}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsx("h1",{className:"text-xl font-semibold text-slate-900 md:text-2xl",children:"Analyzer Staging Results"})}),r.jsxs("p",{className:"text-xs md:text-sm text-slate-600",children:["Review incoming results from lab analyzers before they are attached to orders. Use ",r.jsx("span",{className:"font-semibold",children:"Auto Map"})," to link results to Lab Orders."]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs(Te,{variant:"outline",size:"sm",className:"gap-1 text-xs font-semibold",onClick:V,disabled:x,children:[r.jsx(ry,{className:"w-3.5 h-3.5"}),"Refresh"]}),r.jsxs(Te,{size:"sm",className:"gap-1 text-xs font-semibold",onClick:B,disabled:!T||!n||v,children:[r.jsx(Dn,{className:"w-3.5 h-3.5"}),"Auto Map Device"]})]})]}),r.jsxs(Ve,{className:"border-slate-200 shadow-sm",children:[r.jsx(rt,{className:"pb-3",children:r.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{children:[r.jsxs(ot,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx($r,{className:"w-4 h-4 text-slate-500"}),"Filters"]}),r.jsx(vr,{className:"text-xs",children:"Choose analyzer, filter by sample ID and staging status."})]}),M&&r.jsxs("div",{className:"flex flex-wrap items-center gap-2 justify-end text-xs",children:[r.jsxs(Ze,{variant:"outline",className:"gap-1 px-2 py-1",children:[r.jsx(L3,{className:"w-3.5 h-3.5"}),"Device: ",r.jsx("span",{className:"font-semibold",children:M.name})]}),r.jsxs(Ze,{variant:"outline",className:"text-[11px] px-2 py-1 text-slate-600",children:["Code: ",M.code]})]})]})}),r.jsxs(He,{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-semibold text-slate-700",children:"Analyzer Device"}),h?r.jsx(We,{className:"h-9 w-full rounded-lg"}):r.jsxs("div",{className:"relative",children:[r.jsxs("select",{className:"block w-full rounded-lg border border-slate-200 bg-white px-3 py-2.5 text-xs md:text-sm font-medium text-slate-800 shadow-sm focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500 appearance-none pr-8",value:n||"",onChange:$=>a($.target.value?Number($.target.value):null),children:[t.length===0&&r.jsx("option",{value:"",children:"No devices configured"}),t.length>0&&t.map($=>r.jsxs("option",{value:$.id,children:[$.name," (",$.code,")"]},$.id))]}),r.jsx($x,{className:"pointer-events-none absolute right-2.5 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-semibold text-slate-700",children:"Sample / Barcode"}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx(Se,{placeholder:"Search by sample ID / barcode",className:"text-xs md:text-sm",value:d,onChange:$=>u($.target.value)}),r.jsx(Te,{variant:"outline",size:"icon",className:"shrink-0",onClick:L,disabled:!T||!d.trim()||v,title:"Auto map all results for this sample",children:r.jsx(es,{className:"w-3.5 h-3.5"})})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-semibold text-slate-700",children:"Status"}),r.jsx("div",{className:"flex flex-wrap gap-1.5",children:[{id:"all",label:"All"},{id:"staging",label:"Staging"},{id:"mapped",label:"Mapped"},{id:"posted",label:"Posted"},{id:"error",label:"Error"}].map($=>r.jsx(Te,{type:"button",variant:o===$.id?"default":"outline",size:"xs",className:`text-[11px] font-semibold px-2.5 py-1 ${o===$.id?"bg-sky-600 hover:bg-sky-700":"bg-white"}`,onClick:()=>c($.id),children:$.label},$.id))})]})]}),_&&r.jsxs(Ui,{variant:"destructive",className:"mt-2",children:[r.jsx(za,{className:"w-4 h-4"}),r.jsx(Vi,{children:"Error"}),r.jsx(Hi,{className:"text-xs",children:_})]})]})]}),r.jsxs(Ve,{className:"border-slate-200 shadow-sm",children:[r.jsxs(rt,{className:"pb-2 flex flex-col gap-1 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{children:[r.jsxs(ot,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx(Vs,{className:"w-4 h-4 text-slate-500"}),"Staging Results"]}),r.jsx(vr,{className:"text-xs",children:x?"Loading staging results":`Showing ${I.length} row(s)${i.length!==I.length?` of ${i.length}`:""}`})]}),r.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-slate-500",children:[r.jsxs("span",{className:"inline-flex items-center gap-1",children:[r.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-amber-400"}),"Staging"]}),r.jsxs("span",{className:"inline-flex items-center gap-1",children:[r.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-emerald-500"}),"Posted"]}),r.jsxs("span",{className:"inline-flex items-center gap-1",children:[r.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-red-500"}),"Error"]})]})]}),r.jsxs(He,{className:"pt-0",children:[r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"min-w-full text-xs border-collapse",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b border-slate-200 bg-slate-50",children:[r.jsx("th",{className:"px-3 py-2 text-left font-semibold text-slate-700",children:"Sample ID"}),r.jsx("th",{className:"px-3 py-2 text-left font-semibold text-slate-700",children:"Test Code"}),r.jsx("th",{className:"px-3 py-2 text-left font-semibold text-slate-700",children:"Result"}),r.jsx("th",{className:"px-3 py-2 text-left font-semibold text-slate-700",children:"Flags / Range"}),r.jsx("th",{className:"px-3 py-2 text-left font-semibold text-slate-700",children:"Status"}),r.jsx("th",{className:"px-3 py-2 text-left font-semibold text-slate-700",children:"Linked To"}),r.jsx("th",{className:"px-3 py-2 text-right font-semibold text-slate-700",children:"Actions"})]})}),r.jsxs("tbody",{children:[x&&Array.from({length:6}).map(($,z)=>r.jsxs("tr",{className:"border-b border-slate-100",children:[r.jsx("td",{className:"px-3 py-2",children:r.jsx(We,{className:"h-4 w-24"})}),r.jsx("td",{className:"px-3 py-2",children:r.jsx(We,{className:"h-4 w-16"})}),r.jsx("td",{className:"px-3 py-2",children:r.jsx(We,{className:"h-4 w-20"})}),r.jsx("td",{className:"px-3 py-2",children:r.jsx(We,{className:"h-4 w-28"})}),r.jsx("td",{className:"px-3 py-2",children:r.jsx(We,{className:"h-4 w-16"})}),r.jsx("td",{className:"px-3 py-2",children:r.jsx(We,{className:"h-4 w-24"})}),r.jsx("td",{className:"px-3 py-2 text-right",children:r.jsx(We,{className:"h-7 w-20 ml-auto"})})]},z)),!x&&I.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"px-3 py-8 text-center text-xs text-slate-500",children:"No staging results found for current filters."})}),!x&&I.map($=>r.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50/80",children:[r.jsxs("td",{className:"px-3 py-2 align-top",children:[r.jsx("div",{className:"font-semibold text-slate-800 text-xs",children:$.sample_id||""}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:["Received:"," ",$.received_at?new Date($.received_at).toLocaleString():""]})]}),r.jsxs("td",{className:"px-3 py-2 align-top",children:[r.jsx("div",{className:"font-semibold text-xs text-slate-800",children:$.external_test_code||""}),r.jsx("div",{className:"text-[11px] text-slate-500",children:$.external_test_name||""})]}),r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsxs("div",{className:"font-semibold text-xs text-slate-900",children:[$.result_value,$.unit&&r.jsx("span",{className:"ml-1 text-[11px] text-slate-600",children:$.unit})]})}),r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsxs("div",{className:"flex flex-col gap-1",children:[$.flag&&r.jsx("span",{className:"inline-flex items-center rounded-full bg-red-50 px-2 py-0.5 text-[11px] font-semibold text-red-700 border border-red-100",children:$.flag}),$.reference_range&&r.jsxs("span",{className:"text-[11px] text-slate-600",children:["Range: ",$.reference_range]}),r.jsx(A6,{message:$.error_message})]})}),r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsx(k6,{status:$.status})}),r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsxs("div",{className:"space-y-0.5 text-[11px] text-slate-600",children:[r.jsxs("div",{children:["Order ID:"," ",r.jsx("span",{className:"font-semibold",children:$.lis_order_id||""})]}),r.jsxs("div",{children:["Test ID:"," ",r.jsx("span",{className:"font-semibold",children:$.lis_test_id||""})]}),r.jsxs("div",{children:["Patient:"," ",r.jsx("span",{className:"font-semibold",children:$.patient_id||""})]})]})}),r.jsx("td",{className:"px-3 py-2 align-top text-right",children:r.jsx(Te,{size:"xs",className:"text-[11px] font-semibold",variant:"outline",onClick:()=>F($.id),disabled:!T||v||$.status==="posted",children:"Map row"})})]},$.id))]})]})}),r.jsxs("div",{className:"md:hidden space-y-3",children:[x&&Array.from({length:4}).map(($,z)=>r.jsx(Ve,{className:"border-slate-200 shadow-sm rounded-xl",children:r.jsxs(He,{className:"p-3 space-y-2",children:[r.jsx(We,{className:"h-4 w-32"}),r.jsx(We,{className:"h-4 w-20"}),r.jsx(We,{className:"h-5 w-full"})]})},z)),!x&&I.length===0&&r.jsx("div",{className:"py-8 text-center text-xs text-slate-500",children:"No staging results found."}),!x&&I.map($=>r.jsx(Ve,{className:"border-slate-200 shadow-sm rounded-xl",children:r.jsxs(He,{className:"p-3 space-y-2",children:[r.jsxs("div",{className:"flex items-start justify-between gap-2",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"text-xs font-semibold text-slate-900",children:["Sample: ",$.sample_id||""]}),r.jsxs("div",{className:"text-[11px] text-slate-500",children:[$.external_test_code," ",$.external_test_name&&r.jsxs(r.Fragment,{children:[" ",$.external_test_name]})]})]}),r.jsx(k6,{status:$.status})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"text-xs font-semibold text-slate-900",children:[$.result_value,$.unit&&r.jsx("span",{className:"ml-1 text-[11px] text-slate-600",children:$.unit})]}),r.jsx(Te,{size:"xs",variant:"outline",className:"text-[11px] font-semibold",onClick:()=>F($.id),disabled:!T||v||$.status==="posted",children:"Map"})]}),r.jsxs("div",{className:"flex flex-wrap gap-1 items-center",children:[$.flag&&r.jsx("span",{className:"inline-flex items-center rounded-full bg-red-50 px-2 py-0.5 text-[11px] font-semibold text-red-700 border border-red-100",children:$.flag}),$.reference_range&&r.jsxs("span",{className:"text-[11px] text-slate-600",children:["Range: ",$.reference_range]}),r.jsx(A6,{message:$.error_message})]}),r.jsxs("div",{className:"flex flex-wrap gap-2 text-[11px] text-slate-500",children:[r.jsxs("span",{children:["Order:"," ",r.jsx("span",{className:"font-semibold",children:$.lis_order_id||""})]}),r.jsxs("span",{children:["Test:"," ",r.jsx("span",{className:"font-semibold",children:$.lis_test_id||""})]}),r.jsxs("span",{children:["Patient:"," ",r.jsx("span",{className:"font-semibold",children:$.patient_id||""})]})]})]})},$.id))]})]})]})]}):r.jsx("div",{className:"px-4 py-6 sm:px-6 lg:px-8",children:r.jsxs(Ui,{variant:"destructive",children:[r.jsx(za,{className:"w-4 h-4"}),r.jsx(Vi,{children:"Access denied"}),r.jsx(Hi,{children:"You dont have permission to view analyzer devices. Contact admin."})]})})}function z9e({kind:t="success",title:s,message:n,onClose:a}){const i={success:{bg:"bg-emerald-50",border:"border-emerald-200",text:"text-emerald-900",icon:r.jsx(Dn,{className:"w-4 h-4 text-emerald-600"})},error:{bg:"bg-red-50",border:"border-red-200",text:"text-red-900",icon:r.jsx(Ux,{className:"w-4 h-4 text-red-600"})},info:{bg:"bg-sky-50",border:"border-sky-200",text:"text-sky-900",icon:r.jsx(F3,{className:"w-4 h-4 text-sky-600"})}},l=i[t]??i.info;return r.jsx("div",{className:"fixed top-4 right-4 z-40",children:r.jsxs("div",{className:`flex items-start gap-3 rounded-xl border shadow-sm px-4 py-3 ${l.bg} ${l.border} ${l.text}`,children:[r.jsx("div",{className:"mt-0.5",children:l.icon}),r.jsxs("div",{className:"space-y-0.5",children:[s&&r.jsx("div",{className:"font-semibold text-sm",children:s}),n&&r.jsx("div",{className:"text-xs leading-snug text-slate-700",children:n})]}),r.jsx("button",{onClick:a,className:"ml-2 text-xs text-slate-500 hover:text-slate-700",children:""})]})})}function U9e({checked:t,onChange:s}){return r.jsx("button",{type:"button",onClick:()=>s(!t),className:`relative inline-flex h-6 w-11 items-center rounded-full border transition-colors ${t?"bg-emerald-500 border-emerald-500":"bg-slate-200 border-slate-300"}`,children:r.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow transition-transform ${t?"translate-x-5":"translate-x-1"}`})})}function E6({active:t}){return t?r.jsx("span",{className:"inline-flex items-center rounded-full bg-emerald-50 text-emerald-700 border border-emerald-200 px-2 py-0.5 text-[11px] font-semibold",children:"Active"}):r.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-50 text-slate-600 border border-slate-200 px-2 py-0.5 text-[11px] font-semibold",children:"Inactive"})}function V9e({value:t,onChange:s}){const[n,a]=y.useState(""),[i,l]=y.useState(!1),[o,c]=y.useState([]),d=y.useCallback(async h=>{if(a(h),!h||h.trim().length<2){c([]);return}l(!0);try{const f=await J.get("/api/lab/tests",{params:{search:h.trim(),limit:10}});c(f.data||[])}catch(f){console.error("Failed to search tests",f)}finally{l(!1)}},[]),u=y.useMemo(()=>{if(!t)return"Not mapped";const h=o.find(f=>f.id===t);return h?`${h.code||h.id}  ${h.name||""}`:`Test ID: ${t}`},[t,o]);return r.jsxs("div",{className:"space-y-1",children:[r.jsx(Qe,{className:"text-xs font-semibold text-slate-700",children:"LIS Test Mapping"}),r.jsxs("div",{className:"space-y-1",children:[r.jsx(Se,{placeholder:"Search LIS test (code / name)",className:"text-xs",value:n,onChange:h=>d(h.target.value)}),r.jsxs("div",{className:"border border-slate-200 rounded-lg bg-slate-50/60 px-2 py-1 text-[11px] text-slate-600",children:["Current: ",r.jsx("span",{className:"font-semibold",children:u})]})]}),i&&r.jsx("div",{className:"mt-1 text-[11px] text-slate-500",children:"Searching"}),!i&&o.length>0&&r.jsx("div",{className:"mt-1 max-h-40 overflow-auto rounded-lg border border-slate-200 bg-white shadow-sm",children:o.map(h=>r.jsxs("button",{type:"button",className:`w-full text-left px-2 py-1.5 text-[11px] hover:bg-sky-50 ${t===h.id?"bg-sky-50/70":""}`,onClick:()=>s(h.id),children:[r.jsxs("div",{className:"font-semibold text-slate-800",children:[h.code||h.id," ",h.name&&r.jsxs("span",{className:"font-normal text-slate-600",children:[" ",h.name]})]}),h.category&&r.jsx("div",{className:"text-[10px] text-slate-500",children:h.category})]},h.id))}),r.jsxs("div",{className:"pt-2 border-t border-dashed border-slate-200 mt-2",children:[r.jsx(Qe,{className:"text-[11px] font-medium text-slate-600",children:"Or manual LIS Test ID"}),r.jsx(Se,{type:"number",placeholder:"Enter test ID",className:"mt-1 h-8 text-xs",value:t||"",onChange:h=>s(h.target.value?Number(h.target.value):null)})]})]})}function H9e(){const[t,s]=y.useState([]),[n,a]=y.useState(null),[i,l]=y.useState([]),[o,c]=y.useState(""),[d,u]=y.useState("all"),[h,f]=y.useState(!1),[x,b]=y.useState(!1),[v,w]=y.useState(null),[_,S]=y.useState(null),[k,A]=y.useState(!1),[T,P]=y.useState(null),[O,D]=y.useState({external_test_code:"",external_test_name:"",lis_test_id:null,default_unit:"",reference_range:"",is_active:!0}),[I,M]=y.useState(!1),[B,L]=y.useState(null),F=nt("lab.devices.view"),V=nt("lab.devices.manage"),$=y.useCallback((te,ce,ge)=>{S({kind:te,title:ce,message:ge}),setTimeout(()=>S(null),3500)},[]);y.useEffect(()=>{if(!F)return;(async()=>{f(!0),w(null);try{const ce=await J.get("/api/lis/devices");s(ce.data||[]),ce.data&&ce.data.length>0&&a(ce.data[0].id)}catch(ce){console.error(ce),w("Failed to load analyzer devices"),$("error","Load failed","Unable to fetch devices. Please try again.")}finally{f(!1)}})()},[F,$]);const z=y.useCallback(async te=>{if(te){b(!0),w(null);try{const ce=await J.get(`/api/lis/devices/${te}/channels`);l(ce.data||[])}catch(ce){console.error(ce),w("Failed to load channel mappings"),$("error","Load failed","Unable to load device channels. Check backend.")}finally{b(!1)}}},[$]);y.useEffect(()=>{n&&z(n)},[n,z]);const H=y.useMemo(()=>{let te=i||[];d==="active"?te=te.filter(ge=>ge.is_active):d==="inactive"&&(te=te.filter(ge=>!ge.is_active));const ce=o.trim().toLowerCase();return ce&&(te=te.filter(ge=>{const X=(ge.external_test_code||"").toLowerCase(),de=(ge.external_test_name||"").toLowerCase();return X.includes(ce)||de.includes(ce)})),te},[i,d,o]),q=y.useMemo(()=>t.find(te=>te.id===n)||null,[t,n]),G=()=>{P(null),D({external_test_code:"",external_test_name:"",lis_test_id:null,default_unit:"",reference_range:"",is_active:!0}),A(!0)},re=te=>{P(te),D({external_test_code:te.external_test_code||"",external_test_name:te.external_test_name||"",lis_test_id:te.lis_test_id||null,default_unit:te.default_unit||"",reference_range:te.reference_range||"",is_active:te.is_active??!0}),A(!0)},ye=(te,ce)=>{D(ge=>({...ge,[te]:ce}))},Ee=async()=>{if(n){if(!O.external_test_code.trim()){$("error","Validation","External test code is required.");return}M(!0);try{T?(await J.put(`/api/lis/channels/${T.id}`,{external_test_name:O.external_test_name||null,lis_test_id:O.lis_test_id||null,default_unit:O.default_unit||null,reference_range:O.reference_range||null,is_active:O.is_active}),$("success","Updated","Mapping updated successfully.")):(await J.post(`/api/lis/devices/${n}/channels`,{device_id:n,external_test_code:O.external_test_code.trim(),external_test_name:O.external_test_name||null,lis_test_id:O.lis_test_id||null,default_unit:O.default_unit||null,reference_range:O.reference_range||null,is_active:O.is_active}),$("success","Created","New mapping added successfully.")),A(!1),await z(n)}catch(te){console.error(te),$("error","Save failed","Unable to save mapping. Please check and try again.")}finally{M(!1)}}},ee=async te=>{if(window.confirm(`Delete mapping ${te.external_test_code}?`)){L(te.id);try{await J.delete(`/api/lis/channels/${te.id}`),$("success","Deleted","Mapping removed."),l(ce=>ce.filter(ge=>ge.id!==te.id))}catch(ce){console.error(ce),$("error","Delete failed","Unable to delete mapping. Please try again.")}finally{L(null)}}};return F?r.jsxs("div",{className:"px-4 py-6 sm:px-6 lg:px-8 space-y-4",children:[_&&r.jsx(z9e,{kind:_.kind,title:_.title,message:_.message,onClose:()=>S(null)}),r.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-slate-50 px-3 py-1 border border-slate-200 text-xs font-semibold text-slate-700",children:[r.jsx(F3,{className:"w-3.5 h-3.5"}),"Analyzer Device Mapping"]}),r.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-slate-900",children:"Device Test Code Mapping"}),r.jsx("p",{className:"text-xs md:text-sm text-slate-600",children:"Map analyzer test codes to LIS tests. This ensures incoming results are correctly attached to Lab Orders."})]}),r.jsx("div",{className:"flex flex-wrap items-center gap-2",children:V&&r.jsxs(Te,{size:"sm",className:"gap-1 text-xs font-semibold",onClick:G,disabled:!n,children:[r.jsx(ps,{className:"w-3.5 h-3.5"}),"New Mapping"]})})]}),r.jsxs(Ve,{className:"border-slate-200 shadow-sm",children:[r.jsx(rt,{className:"pb-3",children:r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[r.jsxs("div",{children:[r.jsxs(ot,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx($r,{className:"w-4 h-4 text-slate-500"}),"Filters"]}),r.jsx(vr,{className:"text-xs",children:"Choose analyzer device and filter channel mappings by code / name / status."})]}),q&&r.jsxs("div",{className:"flex flex-wrap items-center gap-2 justify-end text-xs",children:[r.jsxs(Ze,{variant:"outline",className:"gap-1 px-2 py-1",children:[r.jsx(L3,{className:"w-3.5 h-3.5"}),"Device: ",r.jsx("span",{className:"font-semibold",children:q.name})]}),r.jsxs(Ze,{variant:"outline",className:"text-[11px] px-2 py-1 text-slate-600",children:["Code: ",q.code]})]})]})}),r.jsxs(He,{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx(Qe,{className:"text-xs font-semibold text-slate-700",children:"Analyzer Device"}),h?r.jsx(We,{className:"h-9 w-full rounded-lg"}):r.jsxs("div",{className:"relative",children:[r.jsxs("select",{className:"block w-full rounded-lg border border-slate-200 bg-white px-3 py-2.5 text-xs md:text-sm font-medium text-slate-800 shadow-sm focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500 appearance-none pr-8",value:n||"",onChange:te=>a(te.target.value?Number(te.target.value):null),children:[t.length===0&&r.jsx("option",{value:"",children:"No devices configured"}),t.length>0&&t.map(te=>r.jsxs("option",{value:te.id,children:[te.name," (",te.code,")"]},te.id))]}),r.jsx($x,{className:"pointer-events-none absolute right-2.5 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx(Qe,{className:"text-xs font-semibold text-slate-700",children:"Search Code / Name"}),r.jsxs("div",{className:"relative",children:[r.jsx(es,{className:"w-3.5 h-3.5 text-slate-400 absolute left-2.5 top-1/2 -translate-y-1/2"}),r.jsx(Se,{placeholder:"e.g. WBC, GLU, HB",className:"pl-8 text-xs md:text-sm",value:o,onChange:te=>c(te.target.value)})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx(Qe,{className:"text-xs font-semibold text-slate-700",children:"Status"}),r.jsx("div",{className:"flex flex-wrap gap-1.5",children:[{id:"all",label:"All"},{id:"active",label:"Active"},{id:"inactive",label:"Inactive"}].map(te=>r.jsx(Te,{type:"button",variant:d===te.id?"default":"outline",size:"xs",className:`text-[11px] font-semibold px-2.5 py-1 ${d===te.id?"bg-sky-600 hover:bg-sky-700":"bg-white"}`,onClick:()=>u(te.id),children:te.label},te.id))})]})]}),v&&r.jsxs(Ui,{variant:"destructive",className:"mt-2",children:[r.jsx(za,{className:"w-4 h-4"}),r.jsx(Vi,{children:"Error"}),r.jsx(Hi,{className:"text-xs",children:v})]})]})]}),r.jsxs(Ve,{className:"border-slate-200 shadow-sm",children:[r.jsx(rt,{className:"pb-2 flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:r.jsxs("div",{children:[r.jsxs(ot,{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx(D4,{className:"w-4 h-4 text-slate-500"}),"Device Test Code Mapping"]}),r.jsx(vr,{className:"text-xs",children:x?"Loading mappings":`Showing ${H.length} mapping(s)${i.length!==H.length?` of ${i.length}`:""}`})]})}),r.jsxs(He,{className:"pt-0",children:[r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"min-w-full text-xs border-collapse",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b border-slate-200 bg-slate-50",children:[r.jsx("th",{className:"px-3 py-2 text-left font-semibold text-slate-700",children:"Device Test Code"}),r.jsx("th",{className:"px-3 py-2 text-left font-semibold text-slate-700",children:"Device Test Name"}),r.jsx("th",{className:"px-3 py-2 text-left font-semibold text-slate-700",children:"LIS Test"}),r.jsx("th",{className:"px-3 py-2 text-left font-semibold text-slate-700",children:"Default Unit / Range"}),r.jsx("th",{className:"px-3 py-2 text-left font-semibold text-slate-700",children:"Status"}),r.jsx("th",{className:"px-3 py-2 text-right font-semibold text-slate-700",children:"Actions"})]})}),r.jsxs("tbody",{children:[x&&Array.from({length:6}).map((te,ce)=>r.jsxs("tr",{className:"border-b border-slate-100",children:[r.jsx("td",{className:"px-3 py-2",children:r.jsx(We,{className:"h-4 w-24"})}),r.jsx("td",{className:"px-3 py-2",children:r.jsx(We,{className:"h-4 w-40"})}),r.jsx("td",{className:"px-3 py-2",children:r.jsx(We,{className:"h-4 w-32"})}),r.jsx("td",{className:"px-3 py-2",children:r.jsx(We,{className:"h-4 w-32"})}),r.jsx("td",{className:"px-3 py-2",children:r.jsx(We,{className:"h-4 w-16"})}),r.jsx("td",{className:"px-3 py-2 text-right",children:r.jsx(We,{className:"h-7 w-20 ml-auto"})})]},ce)),!x&&H.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-3 py-8 text-center text-xs text-slate-500",children:"No mappings found for current filters."})}),!x&&H.map(te=>r.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50/70",children:[r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(qp,{className:"w-3.5 h-3.5 text-slate-400"}),r.jsx("span",{className:"font-semibold text-xs text-slate-900",children:te.external_test_code||""})]})}),r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsx("div",{className:"text-xs text-slate-800",children:te.external_test_name||""})}),r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsxs("div",{className:"space-y-0.5 text-[11px] text-slate-600",children:[r.jsxs("div",{children:["LIS Test ID:"," ",r.jsx("span",{className:"font-semibold",children:te.lis_test_id||"Not mapped"})]}),r.jsx("div",{className:"text-[10px] text-slate-500",children:"(Mapping used by auto-mapper)"})]})}),r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsxs("div",{className:"space-y-0.5 text-[11px] text-slate-600",children:[te.default_unit&&r.jsxs("div",{children:["Unit:"," ",r.jsx("span",{className:"font-semibold",children:te.default_unit})]}),te.reference_range&&r.jsxs("div",{children:["Range:"," ",r.jsx("span",{className:"font-semibold",children:te.reference_range})]})]})}),r.jsx("td",{className:"px-3 py-2 align-top",children:r.jsx(E6,{active:te.is_active})}),r.jsx("td",{className:"px-3 py-2 align-top text-right",children:r.jsx("div",{className:"inline-flex items-center gap-1",children:V&&r.jsxs(r.Fragment,{children:[r.jsxs(Te,{size:"xs",variant:"outline",className:"text-[11px] font-semibold",onClick:()=>re(te),children:[r.jsx(Fa,{className:"w-3.5 h-3.5 mr-1"}),"Edit"]}),r.jsxs(Te,{size:"xs",variant:"outline",className:"text-[11px] font-semibold text-red-600 border-red-200 hover:bg-red-50",onClick:()=>ee(te),disabled:B===te.id,children:[r.jsx(wr,{className:"w-3.5 h-3.5 mr-1"}),B===te.id?"Deleting":"Delete"]})]})})})]},te.id))]})]})}),r.jsxs("div",{className:"md:hidden space-y-3",children:[x&&Array.from({length:4}).map((te,ce)=>r.jsx(Ve,{className:"border-slate-200 shadow-sm rounded-xl",children:r.jsxs(He,{className:"p-3 space-y-2",children:[r.jsx(We,{className:"h-4 w-32"}),r.jsx(We,{className:"h-4 w-24"}),r.jsx(We,{className:"h-5 w-full"})]})},ce)),!x&&H.length===0&&r.jsx("div",{className:"py-8 text-center text-xs text-slate-500",children:"No mappings found."}),!x&&H.map(te=>r.jsx(Ve,{className:"border-slate-200 shadow-sm rounded-xl",children:r.jsxs(He,{className:"p-3 space-y-2",children:[r.jsxs("div",{className:"flex items-start justify-between gap-2",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(qp,{className:"w-3.5 h-3.5 text-slate-400"}),r.jsx("span",{className:"text-xs font-semibold text-slate-900",children:te.external_test_code||""})]}),te.external_test_name&&r.jsx("div",{className:"text-[11px] text-slate-600",children:te.external_test_name})]}),r.jsx(E6,{active:te.is_active})]}),r.jsxs("div",{className:"text-[11px] text-slate-600 space-y-0.5",children:[r.jsxs("div",{children:["LIS Test:"," ",r.jsx("span",{className:"font-semibold",children:te.lis_test_id||"Not mapped"})]}),te.default_unit&&r.jsxs("div",{children:["Unit:"," ",r.jsx("span",{className:"font-semibold",children:te.default_unit})]}),te.reference_range&&r.jsxs("div",{children:["Range:"," ",r.jsx("span",{className:"font-semibold",children:te.reference_range})]})]}),V&&r.jsxs("div",{className:"flex justify-end gap-1 pt-1",children:[r.jsx(Te,{size:"xs",variant:"outline",className:"text-[11px] font-semibold",onClick:()=>re(te),children:"Edit"}),r.jsx(Te,{size:"xs",variant:"outline",className:"text-[11px] font-semibold text-red-600 border-red-200 hover:bg-red-50",onClick:()=>ee(te),disabled:B===te.id,children:B===te.id?"...":"Del"})]})]})},te.id))]})]})]}),r.jsx(Wd,{open:k,onOpenChange:A,children:r.jsxs(Ic,{className:"max-w-lg",children:[r.jsxs(Mc,{children:[r.jsxs(Oc,{className:"flex items-center gap-2 text-sm md:text-base",children:[r.jsx(D4,{className:"w-4 h-4 text-sky-600"}),T?"Edit Mapping":"New Mapping"]}),r.jsx(Rc,{className:"text-xs",children:"Map analyzer test code to LIS test. Auto-mapper will use this configuration when linking results."})]}),r.jsxs("div",{className:"space-y-3 py-2",children:[!T&&r.jsxs("div",{className:"space-y-1",children:[r.jsx(Qe,{className:"text-xs font-semibold text-slate-700",children:"Device Test Code *"}),r.jsx(Se,{placeholder:"e.g. WBC, GLU, HB",className:"text-xs",value:O.external_test_code,onChange:te=>ye("external_test_code",te.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx(Qe,{className:"text-xs font-semibold text-slate-700",children:"Device Test Name"}),r.jsx(Se,{placeholder:"e.g. White Blood Cell Count",className:"text-xs",value:O.external_test_name,onChange:te=>ye("external_test_name",te.target.value)})]}),r.jsx(V9e,{value:O.lis_test_id,onChange:te=>ye("lis_test_id",te)}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx(Qe,{className:"text-xs font-semibold text-slate-700",children:"Default Unit"}),r.jsx(Se,{placeholder:"e.g. 10^3/uL, mmol/L",className:"text-xs",value:O.default_unit,onChange:te=>ye("default_unit",te.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx(Qe,{className:"text-xs font-semibold text-slate-700",children:"Reference Range"}),r.jsx(Se,{placeholder:"e.g. 4.0-11.0",className:"text-xs",value:O.reference_range,onChange:te=>ye("reference_range",te.target.value)})]})]}),r.jsxs("div",{className:"flex items-center justify-between pt-1",children:[r.jsxs("div",{className:"space-y-0.5",children:[r.jsx(Qe,{className:"text-xs font-semibold text-slate-700",children:"Active"}),r.jsx("p",{className:"text-[11px] text-slate-500",children:"Inactive mappings are ignored by auto-mapper."})]}),r.jsx(U9e,{checked:O.is_active,onChange:te=>ye("is_active",te)})]})]}),r.jsxs(Dc,{className:"gap-2",children:[r.jsx(Te,{variant:"outline",size:"sm",className:"text-xs",onClick:()=>A(!1),children:"Cancel"}),r.jsx(Te,{size:"sm",className:"text-xs font-semibold",onClick:Ee,disabled:I,children:I?"Saving":"Save"})]})]})})]}):r.jsx("div",{className:"px-4 py-6 sm:px-6 lg:px-8",children:r.jsxs(Ui,{variant:"destructive",children:[r.jsx(za,{className:"w-4 h-4"}),r.jsx(Vi,{children:"Access denied"}),r.jsx(Hi,{className:"text-xs",children:"You dont have permission to view analyzer mapping. Contact admin."})]})})}function W9e(){return y.useEffect(()=>{const s=async()=>{if(localStorage.getItem("access_token"))try{await k7()}catch(i){console.error("Auto token refresh failed",i)}};s();const n=setInterval(s,174e4);return()=>clearInterval(n)},[]),r.jsxs(r.Fragment,{children:[r.jsxs($Z,{children:[r.jsx(xt,{path:"/auth/login",element:r.jsx(xre,{})}),r.jsx(xt,{path:"/auth/register-admin",element:r.jsx(gre,{})}),r.jsx(xt,{path:"/auth/verify",element:r.jsx(yre,{})}),r.jsx(xt,{element:r.jsx(fde,{}),children:r.jsxs(xt,{element:r.jsx(rde,{children:r.jsx(mde,{})}),children:[r.jsx(xt,{path:"/admin",element:r.jsx(zR,{})}),r.jsx(xt,{path:"/dashboard",element:r.jsx(zR,{})}),r.jsx(xt,{path:"/admin/roles",element:r.jsx(Hce,{})}),r.jsx(xt,{path:"/admin/permissions",element:r.jsx(Wce,{})}),r.jsx(xt,{path:"/admin/users",element:r.jsx(qce,{})}),r.jsx(xt,{path:"/admin/departments",element:r.jsx(Uce,{})}),r.jsx(xt,{path:"/patients",element:r.jsx(L8e,{})}),r.jsx(xt,{path:"/patients/masters",element:r.jsx(F8e,{})}),r.jsx(xt,{path:"/opd/dashboard",element:r.jsx(vLe,{})}),r.jsx(xt,{path:"/opd/schedules",element:r.jsx(J8e,{})}),r.jsx(xt,{path:"/opd/appointments",element:r.jsx(rLe,{})}),r.jsx(xt,{path:"/opd/queue",element:r.jsx(uLe,{})}),r.jsx(xt,{path:"/opd/triage",element:r.jsx(mLe,{})}),r.jsx(xt,{path:"/opd/visit/:id",element:r.jsx(fLe,{})}),r.jsx(xt,{path:"/opd/followups",element:r.jsx(gLe,{})}),r.jsx(xt,{path:"/opd/no-shows",element:r.jsx(bLe,{})}),r.jsx(xt,{path:"/opd/doctor-fees",element:r.jsx($7e,{})}),r.jsx(xt,{path:"/ipd/admissions",element:r.jsx(she,{})}),r.jsx(xt,{path:"/ipd/admission/:id",element:r.jsx(Dge,{})}),r.jsx(xt,{path:"/ipd/tracking",element:r.jsx(Oge,{})}),r.jsx(xt,{path:"/ipd/my",element:r.jsx(Rge,{})}),r.jsx(xt,{path:"/ipd/discharged",element:r.jsx(Lge,{})}),r.jsx(xt,{path:"/ipd/bedboard",element:r.jsx(Bge,{})}),r.jsx(xt,{path:"/ipd/masters",element:r.jsx(Sue,{})}),r.jsx(xt,{path:"/lab/orders",element:r.jsx(e9e,{})}),r.jsx(xt,{path:"/lab/orders/:id",element:r.jsx(zge,{})}),r.jsx(xt,{path:"/lab/masters",element:r.jsx(Uge,{})}),r.jsx(xt,{path:"/lab/service/masters",element:r.jsx(Q7e,{})}),r.jsx(xt,{path:"/lab/orders/:id/print",element:r.jsx(Z7e,{})}),r.jsx(xt,{path:"/lis/analyzer-staging",element:r.jsx($9e,{})}),r.jsx(xt,{path:"/lis/device-mapping",element:r.jsx(H9e,{})}),r.jsx(xt,{path:"/ris/orders",element:r.jsx(Wge,{})}),r.jsx(xt,{path:"/ris/orders/:id",element:r.jsx(Kge,{})}),r.jsx(xt,{path:"/ris/masters",element:r.jsx(Gge,{})}),r.jsx(xt,{path:"/ot/schedule",element:r.jsx(u9e,{})}),r.jsx(xt,{path:"/ot/masters",element:r.jsx(x9e,{})}),r.jsx(xt,{path:"/ot/cases/:caseId",element:r.jsx(B9e,{})}),r.jsx(xt,{path:"/ot/logs",element:r.jsx(g9e,{})}),r.jsx(xt,{path:"/billing",element:r.jsx(Y8e,{})}),r.jsx(xt,{path:"/billing/invoices/:invoiceId",element:r.jsx(cye,{})}),r.jsx(xt,{path:"/emr",element:r.jsx(vye,{})}),r.jsx(xt,{path:"/templates",element:r.jsx(Tye,{})}),r.jsx(xt,{path:"/templates/new",element:r.jsx(XM,{mode:"create"})}),r.jsx(xt,{path:"/templates/:id/edit",element:r.jsx(XM,{mode:"edit"})}),r.jsx(xt,{path:"/templates/generate",element:r.jsx(b_e,{})}),r.jsx(xt,{path:"/templates/consents",element:r.jsx(v_e,{})}),r.jsx(xt,{path:"/settings/branding",element:r.jsx(Z8e,{})}),r.jsx(xt,{path:"/mis",element:r.jsx(d8e,{})}),r.jsx(xt,{path:"/pharmacy/inventory",element:r.jsx(wLe,{})}),r.jsx(xt,{path:"/pharmacy/qr-lookup",element:r.jsx(l7e,{})}),r.jsx(xt,{path:"/inventory/barcode-lookup",element:r.jsx(c7e,{})}),r.jsx(xt,{path:"/pharmacy/rx",element:r.jsx(p7e,{})}),r.jsx(xt,{path:"/pharmacy/dispense",element:r.jsx(P7e,{})}),r.jsx(xt,{path:"/pharmacy/billing",element:r.jsx(_7e,{})}),r.jsx(xt,{path:"/pharmacy/sales",element:r.jsx(C7e,{})}),r.jsx(xt,{path:"/pharmacy/returns",element:r.jsx(A7e,{})}),r.jsx(xt,{path:"/pharmacy/rx-explorer",element:r.jsx(D7e,{})}),r.jsx(xt,{path:"/opd/phramacy",element:r.jsx(F7e,{})}),r.jsx(xt,{path:"/ipd/phramacy",element:r.jsx(R7e,{})}),r.jsx(xt,{path:"/counter/phramacy",element:r.jsx(L7e,{})}),r.jsx(xt,{path:"/ot/phramacy",element:r.jsx(B7e,{})})]})}),r.jsx(xt,{path:"*",element:r.jsx(e7,{to:"/auth/login",replace:!0})})]}),r.jsx(ete,{position:"top-right",richColors:!0,closeButton:!0})]})}const q9e=y.createContext(null);function G9e({children:t,duration:s=3500}){const[n,a]=y.useState([]),i=y.useCallback(c=>{a(d=>d.filter(u=>u.id!==c))},[]),l=y.useCallback((c,d,u={})=>{const h=crypto.randomUUID(),f=u.duration??s;return a(x=>[...x,{id:h,type:c,message:d,duration:f}]),h},[s]),o=y.useMemo(()=>({success:(c,d)=>l("success",c,d),error:(c,d)=>l("error",c,d),warn:(c,d)=>l("warn",c,d),info:(c,d)=>l("info",c,d)}),[l]);return r.jsxs(q9e.Provider,{value:o,children:[t,r.jsx("div",{className:"fixed right-4 top-4 z-[9999] flex w-[min(92vw,380px)] flex-col gap-2",children:n.map(c=>r.jsx(K9e,{toast:c,onClose:()=>i(c.id)},c.id))})]})}function K9e({toast:t,onClose:s}){y.useEffect(()=>{const i=setTimeout(s,t.duration);return()=>clearTimeout(i)},[t.duration,s]);const n={success:"border-emerald-200 bg-emerald-50 text-emerald-800",error:"border-rose-200 bg-rose-50 text-rose-800",warn:"border-amber-200 bg-amber-50 text-amber-800",info:"border-blue-200 bg-blue-50 text-blue-800"}[t.type]??"border-gray-200 bg-white text-gray-800",a={success:Dn,error:Ux,warn:za,info:Gp}[t.type]??Gp;return r.jsxs("div",{className:`flex items-start gap-3 rounded-xl border p-3 shadow-sm ${n}`,role:"status","aria-live":"polite",children:[r.jsx(a,{className:"mt-0.5 h-5 w-5"}),r.jsx("div",{className:"flex-1 text-sm",children:t.message}),r.jsx("button",{onClick:s,className:"opacity-70 hover:opacity-100","aria-label":"Close",children:r.jsx(Kn,{className:"h-4 w-4"})})]})}C2.createRoot(document.getElementById("root")).render(r.jsx(tt.StrictMode,{children:r.jsx(G9e,{children:r.jsx(KZ,{children:r.jsx(W9e,{})})})}));
